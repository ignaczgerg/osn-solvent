Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/MeOH_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/MeOH_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/MeOH_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 695 | train size = 556 | val size = 139 | test size = 337
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.0346e-01, PNorm = 34.0212, GNorm = 1.3215, lr_0 = 5.5000e-04
Validation rmse = 0.313022
Epoch 1
Loss = 6.6487e-01, PNorm = 34.0699, GNorm = 1.2499, lr_0 = 1.0000e-03
Validation rmse = 0.253697
Epoch 2
Loss = 5.7739e-01, PNorm = 34.1458, GNorm = 17.5463, lr_0 = 9.6108e-04
Validation rmse = 0.226493
Epoch 3
Loss = 5.2523e-01, PNorm = 34.2068, GNorm = 3.3234, lr_0 = 9.2367e-04
Validation rmse = 0.212533
Epoch 4
Loss = 4.4967e-01, PNorm = 34.2710, GNorm = 5.6494, lr_0 = 8.8772e-04
Validation rmse = 0.222369
Epoch 5
Loss = 3.6427e-01, PNorm = 34.3203, GNorm = 2.2256, lr_0 = 8.5317e-04
Validation rmse = 0.262525
Epoch 6
Loss = 4.2386e-01, PNorm = 34.3683, GNorm = 2.7362, lr_0 = 8.1996e-04
Validation rmse = 0.221213
Epoch 7
Loss = 3.4285e-01, PNorm = 34.4202, GNorm = 1.1943, lr_0 = 7.8805e-04
Validation rmse = 0.203649
Epoch 8
Loss = 2.8321e-01, PNorm = 34.4733, GNorm = 2.7081, lr_0 = 7.5737e-04
Loss = 2.4116e-01, PNorm = 34.5084, GNorm = 2.7992, lr_0 = 7.3053e-04
Validation rmse = 0.175942
Epoch 9
Loss = 2.1958e-01, PNorm = 34.5430, GNorm = 2.8639, lr_0 = 7.0463e-04
Validation rmse = 0.171681
Epoch 10
Loss = 1.8521e-01, PNorm = 34.5839, GNorm = 0.8139, lr_0 = 6.7721e-04
Validation rmse = 0.160329
Epoch 11
Loss = 1.8984e-01, PNorm = 34.6236, GNorm = 4.7267, lr_0 = 6.5085e-04
Validation rmse = 0.156050
Epoch 12
Loss = 1.6278e-01, PNorm = 34.6477, GNorm = 1.4463, lr_0 = 6.2552e-04
Validation rmse = 0.158743
Epoch 13
Loss = 1.7853e-01, PNorm = 34.6816, GNorm = 3.1695, lr_0 = 6.0117e-04
Validation rmse = 0.180528
Epoch 14
Loss = 1.5973e-01, PNorm = 34.7086, GNorm = 3.2435, lr_0 = 5.7777e-04
Validation rmse = 0.146764
Epoch 15
Loss = 1.2881e-01, PNorm = 34.7376, GNorm = 0.5475, lr_0 = 5.5528e-04
Validation rmse = 0.151068
Epoch 16
Loss = 1.6132e-01, PNorm = 34.7593, GNorm = 0.7133, lr_0 = 5.3367e-04
Validation rmse = 0.141373
Epoch 17
Loss = 1.5555e-01, PNorm = 34.7786, GNorm = 1.1634, lr_0 = 5.1475e-04
Loss = 1.2483e-01, PNorm = 34.7956, GNorm = 1.2549, lr_0 = 4.9651e-04
Loss = 1.2681e-01, PNorm = 34.7980, GNorm = 1.9207, lr_0 = 4.9472e-04
Validation rmse = 0.149170
Epoch 18
Loss = 1.2300e-01, PNorm = 34.8171, GNorm = 2.3556, lr_0 = 4.7718e-04
Validation rmse = 0.143150
Epoch 19
Loss = 1.2036e-01, PNorm = 34.8284, GNorm = 1.0743, lr_0 = 4.5861e-04
Validation rmse = 0.138898
Epoch 20
Loss = 1.2206e-01, PNorm = 34.8421, GNorm = 1.1131, lr_0 = 4.4076e-04
Validation rmse = 0.156082
Epoch 21
Loss = 1.2170e-01, PNorm = 34.8585, GNorm = 1.2765, lr_0 = 4.2360e-04
Validation rmse = 0.135398
Epoch 22
Loss = 1.1537e-01, PNorm = 34.8681, GNorm = 2.0109, lr_0 = 4.0712e-04
Validation rmse = 0.139585
Epoch 23
Loss = 1.1790e-01, PNorm = 34.8819, GNorm = 2.8424, lr_0 = 3.9127e-04
Validation rmse = 0.137669
Epoch 24
Loss = 1.1464e-01, PNorm = 34.8938, GNorm = 1.2493, lr_0 = 3.7604e-04
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/MeOH_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/MeOH_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/MeOH_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 695 | train size = 556 | val size = 139 | test size = 337
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.0346e-01, PNorm = 34.0212, GNorm = 1.3215, lr_0 = 5.5000e-04
Validation rmse = 0.313022
Epoch 1
Loss = 6.6487e-01, PNorm = 34.0699, GNorm = 1.2499, lr_0 = 1.0000e-03
Validation rmse = 0.253697
Epoch 2
Loss = 5.7739e-01, PNorm = 34.1458, GNorm = 17.5463, lr_0 = 9.6108e-04
Validation rmse = 0.226493
Epoch 3
Loss = 5.2523e-01, PNorm = 34.2068, GNorm = 3.3234, lr_0 = 9.2367e-04
Validation rmse = 0.212533
Epoch 4
Loss = 4.4967e-01, PNorm = 34.2710, GNorm = 5.6494, lr_0 = 8.8772e-04
Validation rmse = 0.222369
Epoch 5
Loss = 3.6427e-01, PNorm = 34.3203, GNorm = 2.2256, lr_0 = 8.5317e-04
Validation rmse = 0.262525
Epoch 6
Loss = 4.2386e-01, PNorm = 34.3683, GNorm = 2.7362, lr_0 = 8.1996e-04
Validation rmse = 0.221213
Epoch 7
Loss = 3.4285e-01, PNorm = 34.4202, GNorm = 1.1943, lr_0 = 7.8805e-04
Validation rmse = 0.203649
Epoch 8
Loss = 2.8321e-01, PNorm = 34.4733, GNorm = 2.7081, lr_0 = 7.5737e-04
Loss = 2.4116e-01, PNorm = 34.5084, GNorm = 2.7992, lr_0 = 7.3053e-04
Validation rmse = 0.175942
Epoch 9
Loss = 2.1958e-01, PNorm = 34.5430, GNorm = 2.8639, lr_0 = 7.0463e-04
Validation rmse = 0.171681
Epoch 10
Loss = 1.8521e-01, PNorm = 34.5839, GNorm = 0.8139, lr_0 = 6.7721e-04
Validation rmse = 0.160329
Epoch 11
Loss = 1.8984e-01, PNorm = 34.6236, GNorm = 4.7267, lr_0 = 6.5085e-04
Validation rmse = 0.156050
Epoch 12
Loss = 1.6278e-01, PNorm = 34.6477, GNorm = 1.4463, lr_0 = 6.2552e-04
Validation rmse = 0.158743
Epoch 13
Loss = 1.7853e-01, PNorm = 34.6816, GNorm = 3.1695, lr_0 = 6.0117e-04
Validation rmse = 0.180528
Epoch 14
Loss = 1.5973e-01, PNorm = 34.7086, GNorm = 3.2435, lr_0 = 5.7777e-04
Validation rmse = 0.146764
Epoch 15
Loss = 1.2881e-01, PNorm = 34.7376, GNorm = 0.5475, lr_0 = 5.5528e-04
Validation rmse = 0.151068
Epoch 16
Loss = 1.6132e-01, PNorm = 34.7593, GNorm = 0.7133, lr_0 = 5.3367e-04
Validation rmse = 0.141373
Epoch 17
Loss = 1.5555e-01, PNorm = 34.7786, GNorm = 1.1634, lr_0 = 5.1475e-04
Loss = 1.2483e-01, PNorm = 34.7956, GNorm = 1.2549, lr_0 = 4.9651e-04
Loss = 1.2681e-01, PNorm = 34.7980, GNorm = 1.9207, lr_0 = 4.9472e-04
Validation rmse = 0.149170
Epoch 18
Loss = 1.2300e-01, PNorm = 34.8171, GNorm = 2.3556, lr_0 = 4.7718e-04
Validation rmse = 0.143150
Epoch 19
Loss = 1.2036e-01, PNorm = 34.8284, GNorm = 1.0743, lr_0 = 4.5861e-04
Validation rmse = 0.138898
Epoch 20
Loss = 1.2206e-01, PNorm = 34.8421, GNorm = 1.1131, lr_0 = 4.4076e-04
Validation rmse = 0.156082
Epoch 21
Loss = 1.2170e-01, PNorm = 34.8585, GNorm = 1.2765, lr_0 = 4.2360e-04
Validation rmse = 0.135398
Epoch 22
Loss = 1.1537e-01, PNorm = 34.8681, GNorm = 2.0109, lr_0 = 4.0712e-04
Validation rmse = 0.139585
Epoch 23
Loss = 1.1790e-01, PNorm = 34.8819, GNorm = 2.8424, lr_0 = 3.9127e-04
Validation rmse = 0.137669
Epoch 24
Loss = 1.1464e-01, PNorm = 34.8938, GNorm = 1.2493, lr_0 = 3.7604e-04
Validation rmse = 0.140407
Epoch 25
Loss = 1.6211e-01, PNorm = 34.9048, GNorm = 1.5027, lr_0 = 3.6271e-04
Validation rmse = 0.150690
Epoch 26
Loss = 1.5006e-01, PNorm = 34.9158, GNorm = 2.6332, lr_0 = 3.4859e-04
Loss = 1.1387e-01, PNorm = 34.9267, GNorm = 2.5315, lr_0 = 3.3624e-04
Loss = 5.5880e-02, PNorm = 34.9277, GNorm = 1.7257, lr_0 = 3.3503e-04
Validation rmse = 0.135915
Epoch 27
Loss = 9.9765e-02, PNorm = 34.9378, GNorm = 0.6349, lr_0 = 3.2315e-04
Validation rmse = 0.133147
Epoch 28
Loss = 1.0785e-01, PNorm = 34.9472, GNorm = 2.9742, lr_0 = 3.1057e-04
Validation rmse = 0.140610
Epoch 29
Loss = 1.0136e-01, PNorm = 34.9558, GNorm = 2.0827, lr_0 = 2.9848e-04
Validation rmse = 0.133619
Epoch 30
Loss = 1.0156e-01, PNorm = 34.9659, GNorm = 0.5227, lr_0 = 2.8687e-04
Validation rmse = 0.131712
Epoch 31
Loss = 1.0347e-01, PNorm = 34.9754, GNorm = 1.4154, lr_0 = 2.7570e-04
Validation rmse = 0.139425
Epoch 32
Loss = 1.0381e-01, PNorm = 34.9841, GNorm = 2.4474, lr_0 = 2.6497e-04
Validation rmse = 0.170964
Epoch 33
Loss = 1.1740e-01, PNorm = 34.9916, GNorm = 0.6511, lr_0 = 2.5466e-04
Validation rmse = 0.143140
Epoch 34
Loss = 1.0984e-01, PNorm = 34.9978, GNorm = 0.4879, lr_0 = 2.4563e-04
Validation rmse = 0.130844
Epoch 35
Loss = 7.7586e-02, PNorm = 35.0045, GNorm = 1.7331, lr_0 = 2.3607e-04
Loss = 1.0592e-01, PNorm = 35.0115, GNorm = 2.3742, lr_0 = 2.2770e-04
Loss = 2.0466e-01, PNorm = 35.0120, GNorm = 2.9569, lr_0 = 2.2688e-04
Validation rmse = 0.136047
Epoch 36
Loss = 1.0350e-01, PNorm = 35.0180, GNorm = 0.4878, lr_0 = 2.1884e-04
Validation rmse = 0.139936
Epoch 37
Loss = 1.0220e-01, PNorm = 35.0250, GNorm = 1.2552, lr_0 = 2.1032e-04
Validation rmse = 0.134338
Epoch 38
Loss = 9.4091e-02, PNorm = 35.0322, GNorm = 0.6563, lr_0 = 2.0214e-04
Validation rmse = 0.131351
Epoch 39
Loss = 9.2748e-02, PNorm = 35.0393, GNorm = 1.5854, lr_0 = 1.9427e-04
Validation rmse = 0.133116
Epoch 40
Loss = 7.5192e-02, PNorm = 35.0454, GNorm = 1.4644, lr_0 = 1.8671e-04
Validation rmse = 0.132539
Epoch 41
Loss = 9.0916e-02, PNorm = 35.0508, GNorm = 1.0339, lr_0 = 1.7944e-04
Validation rmse = 0.130470
Epoch 42
Loss = 8.9544e-02, PNorm = 35.0560, GNorm = 0.7847, lr_0 = 1.7308e-04
Validation rmse = 0.128210
Epoch 43
Loss = 8.5512e-02, PNorm = 35.0613, GNorm = 0.5838, lr_0 = 1.6634e-04
Validation rmse = 0.128005
Epoch 44
Loss = 4.8912e-02, PNorm = 35.0663, GNorm = 0.8605, lr_0 = 1.5987e-04
Loss = 9.7353e-02, PNorm = 35.0707, GNorm = 0.9422, lr_0 = 1.5420e-04
Loss = 2.3344e-01, PNorm = 35.0712, GNorm = 7.2403, lr_0 = 1.5365e-04
Validation rmse = 0.130668
Epoch 45
Loss = 1.0297e-01, PNorm = 35.0796, GNorm = 2.7838, lr_0 = 1.4820e-04
Validation rmse = 0.137238
Epoch 46
Loss = 8.9487e-02, PNorm = 35.0833, GNorm = 1.0039, lr_0 = 1.4243e-04
Validation rmse = 0.131255
Epoch 47
Loss = 8.9622e-02, PNorm = 35.0879, GNorm = 0.8725, lr_0 = 1.3689e-04
Validation rmse = 0.128300
Epoch 48
Loss = 7.9038e-02, PNorm = 35.0912, GNorm = 1.0943, lr_0 = 1.3156e-04
Validation rmse = 0.126476
Epoch 49
Loss = 9.2447e-02, PNorm = 35.0954, GNorm = 0.7784, lr_0 = 1.2644e-04
Validation rmse = 0.135089
Epoch 50
Loss = 1.0443e-01, PNorm = 35.0999, GNorm = 2.5795, lr_0 = 1.2196e-04
Validation rmse = 0.129492
Epoch 51
Loss = 8.1876e-02, PNorm = 35.1033, GNorm = 1.2193, lr_0 = 1.1721e-04
Validation rmse = 0.127176
Epoch 52
Loss = 1.1761e-01, PNorm = 35.1061, GNorm = 0.9981, lr_0 = 1.1265e-04
Validation rmse = 0.128450
Epoch 53
Loss = 7.3307e-02, PNorm = 35.1101, GNorm = 1.4509, lr_0 = 1.0826e-04
Loss = 8.9812e-02, PNorm = 35.1126, GNorm = 2.4074, lr_0 = 1.0443e-04
Loss = 7.0352e-02, PNorm = 35.1129, GNorm = 1.5360, lr_0 = 1.0405e-04
Validation rmse = 0.127656
Epoch 54
Loss = 8.9324e-02, PNorm = 35.1165, GNorm = 1.2239, lr_0 = 1.0036e-04
Validation rmse = 0.131063
Epoch 55
Loss = 8.7108e-02, PNorm = 35.1193, GNorm = 0.8767, lr_0 = 1.0000e-04
Validation rmse = 0.126346
Epoch 56
Loss = 9.8122e-02, PNorm = 35.1228, GNorm = 0.5316, lr_0 = 1.0000e-04
Validation rmse = 0.130642
Epoch 57
Loss = 1.0374e-01, PNorm = 35.1266, GNorm = 1.1492, lr_0 = 1.0000e-04
Validation rmse = 0.128711
Epoch 58
Loss = 8.6572e-02, PNorm = 35.1297, GNorm = 0.6499, lr_0 = 1.0000e-04
Validation rmse = 0.131091
Epoch 59
Loss = 8.3925e-02, PNorm = 35.1326, GNorm = 1.7997, lr_0 = 1.0000e-04
Validation rmse = 0.128634
Model 0 best validation rmse = 0.126346 on epoch 55
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.172333
Ensemble test rmse = 0.172333
1-fold cross validation
	Seed 0 ==> test rmse = 0.172333
Overall test rmse = 0.172333 +/- 0.000000
Elapsed time = 0:00:31
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/EtOH_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/EtOH_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/EtOH_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 976 | train size = 780 | val size = 196 | test size = 56
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.3943e-01, PNorm = 34.0174, GNorm = 1.5897, lr_0 = 4.3000e-04
Validation rmse = 0.296917
Epoch 1
Loss = 8.4995e-01, PNorm = 34.0481, GNorm = 11.3260, lr_0 = 7.6000e-04
Loss = 6.3914e-01, PNorm = 34.1004, GNorm = 7.6501, lr_0 = 9.9472e-04
Validation rmse = 0.255837
Epoch 2
Loss = 4.9744e-01, PNorm = 34.1807, GNorm = 7.9487, lr_0 = 9.6874e-04
Validation rmse = 0.275308
Epoch 3
Loss = 4.1755e-01, PNorm = 34.2661, GNorm = 4.4715, lr_0 = 9.4094e-04
Loss = 3.0876e-01, PNorm = 34.3339, GNorm = 3.8862, lr_0 = 9.1637e-04
Validation rmse = 0.215384
Epoch 4
Loss = 3.1413e-01, PNorm = 34.3979, GNorm = 6.3542, lr_0 = 8.9243e-04
Validation rmse = 0.229391
Epoch 5
Loss = 3.2039e-01, PNorm = 34.4512, GNorm = 1.4805, lr_0 = 8.6912e-04
Loss = 2.5517e-01, PNorm = 34.4984, GNorm = 4.4571, lr_0 = 8.4642e-04
Validation rmse = 0.193342
Epoch 6
Loss = 2.5364e-01, PNorm = 34.5458, GNorm = 5.4321, lr_0 = 8.2213e-04
Validation rmse = 0.184087
Epoch 7
Loss = 1.3215e-01, PNorm = 34.5921, GNorm = 2.1256, lr_0 = 8.0066e-04
Loss = 1.6861e-01, PNorm = 34.6276, GNorm = 0.7448, lr_0 = 7.7975e-04
Validation rmse = 0.193839
Epoch 8
Loss = 1.6087e-01, PNorm = 34.6700, GNorm = 2.3807, lr_0 = 7.5737e-04
Loss = 1.7980e-01, PNorm = 34.7023, GNorm = 3.0051, lr_0 = 7.3759e-04
Validation rmse = 0.174023
Epoch 9
Loss = 1.5027e-01, PNorm = 34.7340, GNorm = 4.9768, lr_0 = 7.1833e-04
Validation rmse = 0.170160
Epoch 10
Loss = 1.4189e-01, PNorm = 34.7701, GNorm = 1.9746, lr_0 = 6.9956e-04
Loss = 1.5579e-01, PNorm = 34.7968, GNorm = 4.9380, lr_0 = 6.8129e-04
Validation rmse = 0.180012
Epoch 11
Loss = 1.5457e-01, PNorm = 34.8252, GNorm = 1.8010, lr_0 = 6.6174e-04
Validation rmse = 0.168240
Epoch 12
Loss = 1.1562e-01, PNorm = 34.8505, GNorm = 0.6084, lr_0 = 6.4446e-04
Loss = 1.1534e-01, PNorm = 34.8777, GNorm = 0.3950, lr_0 = 6.2763e-04
Validation rmse = 0.163066
Epoch 13
Loss = 1.2106e-01, PNorm = 34.8974, GNorm = 2.4045, lr_0 = 6.0962e-04
Validation rmse = 0.162519
Epoch 14
Loss = 1.1040e-01, PNorm = 34.9150, GNorm = 1.3739, lr_0 = 5.9369e-04
Loss = 1.0759e-01, PNorm = 34.9347, GNorm = 0.6258, lr_0 = 5.7819e-04
Validation rmse = 0.159051
Epoch 15
Loss = 9.7854e-02, PNorm = 34.9513, GNorm = 0.6654, lr_0 = 5.6309e-04
Validation rmse = 0.160421
Epoch 16
Loss = 9.4908e-02, PNorm = 34.9707, GNorm = 1.8795, lr_0 = 5.4693e-04
Loss = 1.1257e-01, PNorm = 34.9877, GNorm = 0.9050, lr_0 = 5.3264e-04
Validation rmse = 0.163931
Epoch 17
Loss = 1.1981e-01, PNorm = 35.0047, GNorm = 0.8598, lr_0 = 5.1873e-04
Loss = 1.0430e-01, PNorm = 35.0212, GNorm = 2.2114, lr_0 = 5.0518e-04
Loss = 1.3673e-01, PNorm = 35.0232, GNorm = 2.7588, lr_0 = 5.0385e-04
Validation rmse = 0.160732
Epoch 18
Loss = 1.0797e-01, PNorm = 35.0400, GNorm = 3.1070, lr_0 = 4.9069e-04
Validation rmse = 0.160719
Epoch 19
Loss = 1.1476e-01, PNorm = 35.0560, GNorm = 1.1240, lr_0 = 4.7787e-04
Loss = 9.8131e-02, PNorm = 35.0725, GNorm = 0.7055, lr_0 = 4.6539e-04
Validation rmse = 0.160687
Epoch 20
Loss = 9.6235e-02, PNorm = 35.0862, GNorm = 0.9948, lr_0 = 4.5323e-04
Validation rmse = 0.154689
Epoch 21
Loss = 1.0697e-01, PNorm = 35.1007, GNorm = 0.6763, lr_0 = 4.4023e-04
Loss = 9.2424e-02, PNorm = 35.1151, GNorm = 1.5841, lr_0 = 4.2873e-04
Validation rmse = 0.166026
Epoch 22
Loss = 9.4104e-02, PNorm = 35.1277, GNorm = 1.0019, lr_0 = 4.1753e-04
Validation rmse = 0.157454
Epoch 23
Loss = 8.2283e-02, PNorm = 35.1426, GNorm = 1.2831, lr_0 = 4.0555e-04
Loss = 1.2247e-01, PNorm = 35.1549, GNorm = 1.7793, lr_0 = 3.9496e-04
Validation rmse = 0.158337
Epoch 24
Loss = 9.9489e-02, PNorm = 35.1695, GNorm = 0.7638, lr_0 = 3.8464e-04
Loss = 9.0107e-02, PNorm = 35.1799, GNorm = 0.9696, lr_0 = 3.7460e-04
Validation rmse = 0.155199
Epoch 25
Loss = 9.0242e-02, PNorm = 35.1930, GNorm = 1.2062, lr_0 = 3.6481e-04
Validation rmse = 0.154565
Epoch 26
Loss = 9.0953e-02, PNorm = 35.2061, GNorm = 0.5206, lr_0 = 3.5434e-04
Loss = 9.5116e-02, PNorm = 35.2206, GNorm = 1.0141, lr_0 = 3.4509e-04
Validation rmse = 0.160000
Epoch 27
Loss = 8.9292e-02, PNorm = 35.2321, GNorm = 1.5085, lr_0 = 3.3608e-04
Validation rmse = 0.160363
Epoch 28
Loss = 8.6458e-02, PNorm = 35.2445, GNorm = 1.2383, lr_0 = 3.2643e-04
Loss = 9.4251e-02, PNorm = 35.2543, GNorm = 0.9528, lr_0 = 3.1791e-04
Validation rmse = 0.156147
Epoch 29
Loss = 7.9188e-02, PNorm = 35.2653, GNorm = 1.8861, lr_0 = 3.0960e-04
Validation rmse = 0.160366
Epoch 30
Loss = 7.8039e-02, PNorm = 35.2752, GNorm = 2.0275, lr_0 = 3.0152e-04
Loss = 9.5804e-02, PNorm = 35.2845, GNorm = 1.6780, lr_0 = 2.9364e-04
Validation rmse = 0.162136
Epoch 31
Loss = 8.4485e-02, PNorm = 35.2954, GNorm = 0.8245, lr_0 = 2.8522e-04
Validation rmse = 0.160144
Epoch 32
Loss = 8.0913e-02, PNorm = 35.3057, GNorm = 1.3563, lr_0 = 2.7777e-04
Loss = 8.6088e-02, PNorm = 35.3148, GNorm = 1.3847, lr_0 = 2.7051e-04
Validation rmse = 0.156880
Epoch 33
Loss = 7.9727e-02, PNorm = 35.3248, GNorm = 2.0164, lr_0 = 2.6275e-04
Loss = 8.9662e-02, PNorm = 35.3331, GNorm = 0.8891, lr_0 = 2.5589e-04
Validation rmse = 0.158015
Epoch 34
Loss = 7.5824e-02, PNorm = 35.3436, GNorm = 0.5485, lr_0 = 2.4920e-04
Validation rmse = 0.155907
Epoch 35
Loss = 8.2533e-02, PNorm = 35.3509, GNorm = 2.1122, lr_0 = 2.4269e-04
Loss = 8.2121e-02, PNorm = 35.3595, GNorm = 1.0809, lr_0 = 2.3635e-04
Validation rmse = 0.154457
Epoch 36
Loss = 7.9511e-02, PNorm = 35.3686, GNorm = 0.5034, lr_0 = 2.2957e-04
Validation rmse = 0.156267
Epoch 37
Loss = 5.3044e-02, PNorm = 35.3751, GNorm = 0.4607, lr_0 = 2.2358e-04
Loss = 8.6018e-02, PNorm = 35.3821, GNorm = 0.9393, lr_0 = 2.1774e-04
Validation rmse = 0.158183
Epoch 38
Loss = 7.0175e-02, PNorm = 35.3893, GNorm = 0.8147, lr_0 = 2.1149e-04
Validation rmse = 0.154858
Epoch 39
Loss = 6.5985e-02, PNorm = 35.3963, GNorm = 0.8017, lr_0 = 2.0596e-04
Loss = 8.1436e-02, PNorm = 35.4027, GNorm = 1.6745, lr_0 = 2.0059e-04
Validation rmse = 0.158965
Epoch 40
Loss = 7.4529e-02, PNorm = 35.4097, GNorm = 1.2902, lr_0 = 1.9535e-04
Validation rmse = 0.155946
Epoch 41
Loss = 8.1541e-02, PNorm = 35.4175, GNorm = 1.1762, lr_0 = 1.8974e-04
Loss = 7.4160e-02, PNorm = 35.4232, GNorm = 1.8484, lr_0 = 1.8478e-04
Validation rmse = 0.154805
Epoch 42
Loss = 7.7391e-02, PNorm = 35.4298, GNorm = 1.3175, lr_0 = 1.7996e-04
Loss = 7.3307e-02, PNorm = 35.4360, GNorm = 2.0823, lr_0 = 1.7526e-04
Loss = 4.9791e-02, PNorm = 35.4363, GNorm = 1.1622, lr_0 = 1.7479e-04
Validation rmse = 0.154574
Epoch 43
Loss = 6.8337e-02, PNorm = 35.4423, GNorm = 0.4816, lr_0 = 1.7023e-04
Validation rmse = 0.154400
Epoch 44
Loss = 7.5009e-02, PNorm = 35.4478, GNorm = 1.8629, lr_0 = 1.6578e-04
Loss = 7.3726e-02, PNorm = 35.4541, GNorm = 0.7047, lr_0 = 1.6145e-04
Validation rmse = 0.157389
Epoch 45
Loss = 7.5326e-02, PNorm = 35.4591, GNorm = 1.3526, lr_0 = 1.5724e-04
Validation rmse = 0.154478
Epoch 46
Loss = 5.6361e-02, PNorm = 35.4652, GNorm = 0.6354, lr_0 = 1.5272e-04
Loss = 7.8204e-02, PNorm = 35.4699, GNorm = 0.5789, lr_0 = 1.4874e-04
Validation rmse = 0.154888
Epoch 47
Loss = 6.5567e-02, PNorm = 35.4745, GNorm = 0.8515, lr_0 = 1.4485e-04
Validation rmse = 0.154768
Epoch 48
Loss = 7.4535e-02, PNorm = 35.4793, GNorm = 0.7333, lr_0 = 1.4069e-04
Loss = 7.1310e-02, PNorm = 35.4838, GNorm = 2.5466, lr_0 = 1.3702e-04
Validation rmse = 0.157952
Epoch 49
Loss = 6.8753e-02, PNorm = 35.4893, GNorm = 1.8225, lr_0 = 1.3344e-04
Loss = 7.3682e-02, PNorm = 35.4943, GNorm = 1.1777, lr_0 = 1.2996e-04
Validation rmse = 0.152962
Epoch 50
Loss = 7.3623e-02, PNorm = 35.4987, GNorm = 1.0420, lr_0 = 1.2656e-04
Validation rmse = 0.154368
Epoch 51
Loss = 6.3136e-02, PNorm = 35.5036, GNorm = 1.1281, lr_0 = 1.2293e-04
Loss = 7.7665e-02, PNorm = 35.5071, GNorm = 2.3824, lr_0 = 1.1972e-04
Validation rmse = 0.155232
Epoch 52
Loss = 7.0755e-02, PNorm = 35.5117, GNorm = 2.1572, lr_0 = 1.1659e-04
Validation rmse = 0.156842
Epoch 53
Loss = 6.9755e-02, PNorm = 35.5168, GNorm = 1.9690, lr_0 = 1.1325e-04
Loss = 6.8586e-02, PNorm = 35.5210, GNorm = 0.5087, lr_0 = 1.1029e-04
Validation rmse = 0.154179
Epoch 54
Loss = 6.4099e-02, PNorm = 35.5248, GNorm = 1.1744, lr_0 = 1.0741e-04
Validation rmse = 0.156151
Epoch 55
Loss = 7.9195e-02, PNorm = 35.5284, GNorm = 0.9720, lr_0 = 1.0460e-04
Loss = 6.8183e-02, PNorm = 35.5324, GNorm = 0.6946, lr_0 = 1.0187e-04
Validation rmse = 0.153270
Epoch 56
Loss = 6.6474e-02, PNorm = 35.5358, GNorm = 0.5328, lr_0 = 1.0000e-04
Validation rmse = 0.153235
Epoch 57
Loss = 7.6565e-02, PNorm = 35.5393, GNorm = 1.5549, lr_0 = 1.0000e-04
Loss = 6.5309e-02, PNorm = 35.5430, GNorm = 1.8125, lr_0 = 1.0000e-04
Validation rmse = 0.156705
Epoch 58
Loss = 6.6345e-02, PNorm = 35.5463, GNorm = 1.1893, lr_0 = 1.0000e-04
Loss = 7.0445e-02, PNorm = 35.5502, GNorm = 1.0967, lr_0 = 1.0000e-04
Validation rmse = 0.154804
Epoch 59
Loss = 7.0983e-02, PNorm = 35.5539, GNorm = 1.2585, lr_0 = 1.0000e-04
Validation rmse = 0.154523
Model 0 best validation rmse = 0.152962 on epoch 49
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.145239
Ensemble test rmse = 0.145239
1-fold cross validation
	Seed 0 ==> test rmse = 0.145239
Overall test rmse = 0.145239 +/- 0.000000
Elapsed time = 0:00:41
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/IPA_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/IPA_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/IPA_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 975 | train size = 780 | val size = 195 | test size = 57
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.4870e-01, PNorm = 34.0153, GNorm = 4.4102, lr_0 = 4.3000e-04
Validation rmse = 0.335690
Epoch 1
Loss = 7.7220e-01, PNorm = 34.0458, GNorm = 2.9579, lr_0 = 7.6000e-04
Loss = 6.0635e-01, PNorm = 34.1069, GNorm = 0.9949, lr_0 = 9.9472e-04
Validation rmse = 0.271043
Epoch 2
Loss = 5.3074e-01, PNorm = 34.1839, GNorm = 5.6635, lr_0 = 9.6874e-04
Validation rmse = 0.253465
Epoch 3
Loss = 3.3604e-01, PNorm = 34.2677, GNorm = 4.0302, lr_0 = 9.4094e-04
Loss = 3.7789e-01, PNorm = 34.3343, GNorm = 6.4801, lr_0 = 9.1637e-04
Validation rmse = 0.233587
Epoch 4
Loss = 3.4454e-01, PNorm = 34.3980, GNorm = 1.5795, lr_0 = 8.9243e-04
Validation rmse = 0.219257
Epoch 5
Loss = 2.8379e-01, PNorm = 34.4547, GNorm = 1.7424, lr_0 = 8.6912e-04
Loss = 2.2336e-01, PNorm = 34.5030, GNorm = 0.6180, lr_0 = 8.4642e-04
Validation rmse = 0.192335
Epoch 6
Loss = 2.2993e-01, PNorm = 34.5497, GNorm = 5.3653, lr_0 = 8.2213e-04
Validation rmse = 0.202992
Epoch 7
Loss = 2.3754e-01, PNorm = 34.5917, GNorm = 6.5195, lr_0 = 8.0066e-04
Loss = 1.8765e-01, PNorm = 34.6261, GNorm = 1.7054, lr_0 = 7.7975e-04
Validation rmse = 0.173137
Epoch 8
Loss = 1.6201e-01, PNorm = 34.6600, GNorm = 2.5902, lr_0 = 7.5737e-04
Loss = 1.3842e-01, PNorm = 34.6935, GNorm = 2.8203, lr_0 = 7.3759e-04
Validation rmse = 0.160531
Epoch 9
Loss = 1.4616e-01, PNorm = 34.7241, GNorm = 3.3790, lr_0 = 7.1833e-04
Validation rmse = 0.153222
Epoch 10
Loss = 1.1661e-01, PNorm = 34.7543, GNorm = 3.3655, lr_0 = 6.9956e-04
Loss = 1.4941e-01, PNorm = 34.7807, GNorm = 2.6288, lr_0 = 6.8129e-04
Validation rmse = 0.152811
Epoch 11
Loss = 1.2668e-01, PNorm = 34.8066, GNorm = 1.1626, lr_0 = 6.6174e-04
Validation rmse = 0.154074
Epoch 12
Loss = 1.1581e-01, PNorm = 34.8309, GNorm = 1.2699, lr_0 = 6.4446e-04
Loss = 1.3794e-01, PNorm = 34.8526, GNorm = 1.9758, lr_0 = 6.2763e-04
Validation rmse = 0.151590
Epoch 13
Loss = 1.2592e-01, PNorm = 34.8746, GNorm = 2.6217, lr_0 = 6.0962e-04
Validation rmse = 0.151029
Epoch 14
Loss = 1.5535e-01, PNorm = 34.8927, GNorm = 4.9650, lr_0 = 5.9369e-04
Loss = 1.1711e-01, PNorm = 34.9119, GNorm = 1.8845, lr_0 = 5.7819e-04
Validation rmse = 0.147546
Epoch 15
Loss = 1.0827e-01, PNorm = 34.9242, GNorm = 3.4816, lr_0 = 5.6309e-04
Validation rmse = 0.156778
Epoch 16
Loss = 1.9974e-01, PNorm = 34.9382, GNorm = 4.0340, lr_0 = 5.4693e-04
Loss = 1.2314e-01, PNorm = 34.9584, GNorm = 3.2476, lr_0 = 5.3264e-04
Validation rmse = 0.152843
Epoch 17
Loss = 1.1565e-01, PNorm = 34.9749, GNorm = 2.1687, lr_0 = 5.1873e-04
Loss = 1.0430e-01, PNorm = 34.9897, GNorm = 2.5473, lr_0 = 5.0518e-04
Loss = 1.8096e-01, PNorm = 34.9910, GNorm = 2.9543, lr_0 = 5.0385e-04
Validation rmse = 0.148412
Epoch 18
Loss = 1.0925e-01, PNorm = 35.0062, GNorm = 1.8936, lr_0 = 4.9069e-04
Validation rmse = 0.142575
Epoch 19
Loss = 1.1068e-01, PNorm = 35.0198, GNorm = 2.4300, lr_0 = 4.7787e-04
Loss = 9.9245e-02, PNorm = 35.0326, GNorm = 2.5750, lr_0 = 4.6539e-04
Validation rmse = 0.152077
Epoch 20
Loss = 1.0920e-01, PNorm = 35.0462, GNorm = 1.2435, lr_0 = 4.5323e-04
Validation rmse = 0.148007
Epoch 21
Loss = 1.2221e-01, PNorm = 35.0630, GNorm = 3.9869, lr_0 = 4.4023e-04
Loss = 1.1988e-01, PNorm = 35.0747, GNorm = 1.1455, lr_0 = 4.2873e-04
Validation rmse = 0.143198
Epoch 22
Loss = 9.9950e-02, PNorm = 35.0898, GNorm = 2.6222, lr_0 = 4.1753e-04
Validation rmse = 0.155581
Epoch 23
Loss = 8.2098e-02, PNorm = 35.1011, GNorm = 1.9470, lr_0 = 4.0555e-04
Loss = 9.7992e-02, PNorm = 35.1109, GNorm = 2.5649, lr_0 = 3.9496e-04
Validation rmse = 0.160547
Epoch 24
Loss = 1.0739e-01, PNorm = 35.1233, GNorm = 4.4916, lr_0 = 3.8464e-04
Loss = 1.0068e-01, PNorm = 35.1352, GNorm = 1.8501, lr_0 = 3.7460e-04
Validation rmse = 0.167728
Epoch 25
Loss = 1.1496e-01, PNorm = 35.1456, GNorm = 3.9755, lr_0 = 3.6481e-04
Validation rmse = 0.150498
Epoch 26
Loss = 1.1900e-01, PNorm = 35.1572, GNorm = 1.3046, lr_0 = 3.5434e-04
Loss = 8.6264e-02, PNorm = 35.1695, GNorm = 0.6302, lr_0 = 3.4509e-04
Validation rmse = 0.144343
Epoch 27
Loss = 8.8726e-02, PNorm = 35.1780, GNorm = 0.8509, lr_0 = 3.3608e-04
Validation rmse = 0.143090
Epoch 28
Loss = 9.4295e-02, PNorm = 35.1916, GNorm = 1.0451, lr_0 = 3.2643e-04
Loss = 8.6979e-02, PNorm = 35.2001, GNorm = 0.4738, lr_0 = 3.1791e-04
Validation rmse = 0.144187
Epoch 29
Loss = 9.2552e-02, PNorm = 35.2093, GNorm = 1.2455, lr_0 = 3.0960e-04
Validation rmse = 0.147799
Epoch 30
Loss = 9.6492e-02, PNorm = 35.2182, GNorm = 1.5294, lr_0 = 3.0152e-04
Loss = 9.4843e-02, PNorm = 35.2250, GNorm = 1.8962, lr_0 = 2.9364e-04
Validation rmse = 0.143148
Epoch 31
Loss = 8.6712e-02, PNorm = 35.2353, GNorm = 0.9047, lr_0 = 2.8522e-04
Validation rmse = 0.144283
Epoch 32
Loss = 7.8120e-02, PNorm = 35.2437, GNorm = 1.5474, lr_0 = 2.7777e-04
Loss = 7.9520e-02, PNorm = 35.2509, GNorm = 2.0126, lr_0 = 2.7051e-04
Validation rmse = 0.142408
Epoch 33
Loss = 8.1777e-02, PNorm = 35.2597, GNorm = 0.8348, lr_0 = 2.6275e-04
Loss = 8.8582e-02, PNorm = 35.2668, GNorm = 0.9106, lr_0 = 2.5589e-04
Validation rmse = 0.149377
Epoch 34
Loss = 7.8872e-02, PNorm = 35.2740, GNorm = 2.8559, lr_0 = 2.4920e-04
Validation rmse = 0.152664
Epoch 35
Loss = 7.2127e-02, PNorm = 35.2823, GNorm = 0.9683, lr_0 = 2.4269e-04
Loss = 8.8501e-02, PNorm = 35.2892, GNorm = 1.0909, lr_0 = 2.3635e-04
Validation rmse = 0.144386
Epoch 36
Loss = 8.3630e-02, PNorm = 35.2986, GNorm = 2.1074, lr_0 = 2.2957e-04
Validation rmse = 0.143799
Epoch 37
Loss = 8.6104e-02, PNorm = 35.3042, GNorm = 2.1053, lr_0 = 2.2358e-04
Loss = 8.7860e-02, PNorm = 35.3117, GNorm = 1.0312, lr_0 = 2.1774e-04
Validation rmse = 0.145228
Epoch 38
Loss = 7.9291e-02, PNorm = 35.3162, GNorm = 2.1099, lr_0 = 2.1149e-04
Validation rmse = 0.143666
Epoch 39
Loss = 8.1767e-02, PNorm = 35.3229, GNorm = 1.5995, lr_0 = 2.0596e-04
Loss = 8.2484e-02, PNorm = 35.3299, GNorm = 1.4769, lr_0 = 2.0059e-04
Validation rmse = 0.146633
Epoch 40
Loss = 7.4909e-02, PNorm = 35.3351, GNorm = 0.6707, lr_0 = 1.9535e-04
Validation rmse = 0.144729
Epoch 41
Loss = 6.8500e-02, PNorm = 35.3405, GNorm = 0.7682, lr_0 = 1.8974e-04
Loss = 7.4218e-02, PNorm = 35.3479, GNorm = 1.8987, lr_0 = 1.8478e-04
Validation rmse = 0.144922
Epoch 42
Loss = 7.2319e-02, PNorm = 35.3529, GNorm = 1.6225, lr_0 = 1.7996e-04
Loss = 7.9478e-02, PNorm = 35.3585, GNorm = 0.5134, lr_0 = 1.7526e-04
Loss = 9.5854e-02, PNorm = 35.3590, GNorm = 1.4355, lr_0 = 1.7479e-04
Validation rmse = 0.145212
Epoch 43
Loss = 8.1781e-02, PNorm = 35.3644, GNorm = 1.1827, lr_0 = 1.7023e-04
Validation rmse = 0.145995
Epoch 44
Loss = 8.8803e-02, PNorm = 35.3700, GNorm = 0.7280, lr_0 = 1.6578e-04
Loss = 7.1976e-02, PNorm = 35.3745, GNorm = 1.5866, lr_0 = 1.6145e-04
Validation rmse = 0.142724
Epoch 45
Loss = 8.2171e-02, PNorm = 35.3794, GNorm = 2.2379, lr_0 = 1.5724e-04
Validation rmse = 0.144539
Epoch 46
Loss = 5.9942e-02, PNorm = 35.3839, GNorm = 0.3850, lr_0 = 1.5272e-04
Loss = 8.1281e-02, PNorm = 35.3889, GNorm = 0.8176, lr_0 = 1.4874e-04
Validation rmse = 0.144505
Epoch 47
Loss = 7.1592e-02, PNorm = 35.3930, GNorm = 1.4927, lr_0 = 1.4485e-04
Validation rmse = 0.146084
Epoch 48
Loss = 7.2460e-02, PNorm = 35.3980, GNorm = 2.4048, lr_0 = 1.4069e-04
Loss = 7.1181e-02, PNorm = 35.4018, GNorm = 0.6158, lr_0 = 1.3702e-04
Validation rmse = 0.143455
Epoch 49
Loss = 7.5317e-02, PNorm = 35.4060, GNorm = 1.1963, lr_0 = 1.3344e-04
Loss = 7.2949e-02, PNorm = 35.4108, GNorm = 2.3976, lr_0 = 1.2996e-04
Validation rmse = 0.147884
Epoch 50
Loss = 7.4828e-02, PNorm = 35.4148, GNorm = 0.4592, lr_0 = 1.2656e-04
Validation rmse = 0.143035
Epoch 51
Loss = 8.1654e-02, PNorm = 35.4179, GNorm = 0.8507, lr_0 = 1.2293e-04
Loss = 6.9220e-02, PNorm = 35.4211, GNorm = 1.2850, lr_0 = 1.1972e-04
Validation rmse = 0.144483
Epoch 52
Loss = 6.8010e-02, PNorm = 35.4257, GNorm = 0.9738, lr_0 = 1.1659e-04
Validation rmse = 0.145531
Epoch 53
Loss = 7.1021e-02, PNorm = 35.4297, GNorm = 0.6161, lr_0 = 1.1325e-04
Loss = 7.2466e-02, PNorm = 35.4331, GNorm = 1.0347, lr_0 = 1.1029e-04
Validation rmse = 0.143720
Epoch 54
Loss = 7.9078e-02, PNorm = 35.4364, GNorm = 0.8187, lr_0 = 1.0741e-04
Validation rmse = 0.146125
Epoch 55
Loss = 6.9643e-02, PNorm = 35.4402, GNorm = 1.7163, lr_0 = 1.0460e-04
Loss = 7.2443e-02, PNorm = 35.4435, GNorm = 0.9847, lr_0 = 1.0187e-04
Validation rmse = 0.144401
Epoch 56
Loss = 7.7351e-02, PNorm = 35.4465, GNorm = 0.8858, lr_0 = 1.0000e-04
Validation rmse = 0.145282
Epoch 57
Loss = 5.0510e-02, PNorm = 35.4497, GNorm = 0.4130, lr_0 = 1.0000e-04
Loss = 6.5424e-02, PNorm = 35.4523, GNorm = 0.8360, lr_0 = 1.0000e-04
Validation rmse = 0.150210
Epoch 58
Loss = 8.0512e-02, PNorm = 35.4552, GNorm = 2.0640, lr_0 = 1.0000e-04
Loss = 6.9311e-02, PNorm = 35.4586, GNorm = 1.4328, lr_0 = 1.0000e-04
Validation rmse = 0.144180
Epoch 59
Loss = 7.4136e-02, PNorm = 35.4620, GNorm = 1.7946, lr_0 = 1.0000e-04
Validation rmse = 0.143205
Model 0 best validation rmse = 0.142408 on epoch 32
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.206417
Ensemble test rmse = 0.206417
1-fold cross validation
	Seed 0 ==> test rmse = 0.206417
Overall test rmse = 0.206417 +/- 0.000000
Elapsed time = 0:00:41
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/Tol_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/Tol_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/Tol_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 984 | train size = 787 | val size = 197 | test size = 48
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.6217e-01, PNorm = 34.0157, GNorm = 4.8902, lr_0 = 4.3000e-04
Validation rmse = 0.289945
Epoch 1
Loss = 6.9185e-01, PNorm = 34.0505, GNorm = 1.8296, lr_0 = 7.6000e-04
Loss = 5.0956e-01, PNorm = 34.1226, GNorm = 15.7675, lr_0 = 9.9472e-04
Validation rmse = 0.260058
Epoch 2
Loss = 4.7692e-01, PNorm = 34.1803, GNorm = 1.6346, lr_0 = 9.6874e-04
Validation rmse = 0.221942
Epoch 3
Loss = 3.0665e-01, PNorm = 34.2420, GNorm = 9.8611, lr_0 = 9.4344e-04
Loss = 3.3777e-01, PNorm = 34.2907, GNorm = 4.4834, lr_0 = 9.1879e-04
Validation rmse = 0.216924
Epoch 4
Loss = 3.0359e-01, PNorm = 34.3427, GNorm = 4.8868, lr_0 = 8.9243e-04
Validation rmse = 0.175861
Epoch 5
Loss = 1.4364e-01, PNorm = 34.3887, GNorm = 0.8503, lr_0 = 8.6912e-04
Loss = 1.8782e-01, PNorm = 34.4298, GNorm = 2.3738, lr_0 = 8.4642e-04
Validation rmse = 0.163239
Epoch 6
Loss = 2.2706e-01, PNorm = 34.4667, GNorm = 2.4623, lr_0 = 8.2431e-04
Loss = 1.5891e-01, PNorm = 34.5007, GNorm = 1.5985, lr_0 = 8.0278e-04
Validation rmse = 0.164575
Epoch 7
Loss = 1.7569e-01, PNorm = 34.5282, GNorm = 2.4778, lr_0 = 7.8181e-04
Validation rmse = 0.166282
Epoch 8
Loss = 1.9166e-01, PNorm = 34.5623, GNorm = 4.4228, lr_0 = 7.5938e-04
Loss = 1.5313e-01, PNorm = 34.5887, GNorm = 3.7475, lr_0 = 7.3955e-04
Validation rmse = 0.161240
Epoch 9
Loss = 1.6052e-01, PNorm = 34.6125, GNorm = 2.3897, lr_0 = 7.2023e-04
Validation rmse = 0.160685
Epoch 10
Loss = 1.3864e-01, PNorm = 34.6424, GNorm = 1.3295, lr_0 = 7.0142e-04
Loss = 1.2724e-01, PNorm = 34.6687, GNorm = 0.8268, lr_0 = 6.8310e-04
Validation rmse = 0.155663
Epoch 11
Loss = 1.1998e-01, PNorm = 34.6928, GNorm = 1.6650, lr_0 = 6.6526e-04
Validation rmse = 0.154742
Epoch 12
Loss = 7.7719e-02, PNorm = 34.7147, GNorm = 1.2684, lr_0 = 6.4617e-04
Loss = 1.5410e-01, PNorm = 34.7358, GNorm = 1.6761, lr_0 = 6.2929e-04
Validation rmse = 0.162511
Epoch 13
Loss = 1.2196e-01, PNorm = 34.7539, GNorm = 1.3975, lr_0 = 6.1285e-04
Loss = 1.2109e-01, PNorm = 34.7776, GNorm = 3.5036, lr_0 = 5.9685e-04
Validation rmse = 0.152629
Epoch 14
Loss = 1.2075e-01, PNorm = 34.7953, GNorm = 2.9564, lr_0 = 5.8126e-04
Validation rmse = 0.151607
Epoch 15
Loss = 1.3541e-01, PNorm = 34.8132, GNorm = 1.1018, lr_0 = 5.6607e-04
Loss = 1.1105e-01, PNorm = 34.8308, GNorm = 1.6835, lr_0 = 5.5129e-04
Validation rmse = 0.154765
Epoch 16
Loss = 1.0210e-01, PNorm = 34.8514, GNorm = 2.1654, lr_0 = 5.3547e-04
Validation rmse = 0.164149
Epoch 17
Loss = 1.0991e-01, PNorm = 34.8687, GNorm = 0.9877, lr_0 = 5.2148e-04
Loss = 1.1444e-01, PNorm = 34.8863, GNorm = 2.2169, lr_0 = 5.0786e-04
Validation rmse = 0.152140
Epoch 18
Loss = 1.0136e-01, PNorm = 34.9046, GNorm = 0.9189, lr_0 = 4.9460e-04
Validation rmse = 0.151031
Epoch 19
Loss = 9.5058e-02, PNorm = 34.9197, GNorm = 2.0071, lr_0 = 4.8168e-04
Loss = 9.0224e-02, PNorm = 34.9338, GNorm = 0.5370, lr_0 = 4.6910e-04
Validation rmse = 0.148675
Epoch 20
Loss = 1.0143e-01, PNorm = 34.9515, GNorm = 3.0281, lr_0 = 4.5564e-04
Loss = 9.6891e-02, PNorm = 34.9640, GNorm = 1.9538, lr_0 = 4.4374e-04
Validation rmse = 0.148328
Epoch 21
Loss = 1.0310e-01, PNorm = 34.9797, GNorm = 1.9706, lr_0 = 4.3215e-04
Validation rmse = 0.148461
Epoch 22
Loss = 8.7330e-02, PNorm = 34.9920, GNorm = 0.7972, lr_0 = 4.2086e-04
Loss = 8.6662e-02, PNorm = 35.0073, GNorm = 1.0139, lr_0 = 4.0987e-04
Validation rmse = 0.148254
Epoch 23
Loss = 1.0687e-01, PNorm = 35.0219, GNorm = 3.5121, lr_0 = 3.9916e-04
Validation rmse = 0.173033
Epoch 24
Loss = 1.1227e-01, PNorm = 35.0358, GNorm = 1.1625, lr_0 = 3.8771e-04
Loss = 1.1333e-01, PNorm = 35.0489, GNorm = 1.5589, lr_0 = 3.7758e-04
Validation rmse = 0.146721
Epoch 25
Loss = 8.7150e-02, PNorm = 35.0613, GNorm = 0.4731, lr_0 = 3.6772e-04
Validation rmse = 0.145238
Epoch 26
Loss = 7.5660e-02, PNorm = 35.0740, GNorm = 0.7762, lr_0 = 3.5812e-04
Loss = 9.8421e-02, PNorm = 35.0855, GNorm = 0.6334, lr_0 = 3.4876e-04
Validation rmse = 0.148520
Epoch 27
Loss = 9.7953e-02, PNorm = 35.0992, GNorm = 1.1120, lr_0 = 3.3875e-04
Loss = 9.3997e-02, PNorm = 35.1115, GNorm = 0.6395, lr_0 = 3.2991e-04
Validation rmse = 0.148286
Epoch 28
Loss = 8.3531e-02, PNorm = 35.1240, GNorm = 0.7227, lr_0 = 3.2129e-04
Validation rmse = 0.154200
Epoch 29
Loss = 9.3185e-02, PNorm = 35.1349, GNorm = 1.1088, lr_0 = 3.1290e-04
Loss = 8.8019e-02, PNorm = 35.1448, GNorm = 0.9334, lr_0 = 3.0472e-04
Validation rmse = 0.149079
Epoch 30
Loss = 8.7546e-02, PNorm = 35.1545, GNorm = 0.5713, lr_0 = 2.9677e-04
Validation rmse = 0.147050
Epoch 31
Loss = 7.5547e-02, PNorm = 35.1652, GNorm = 0.8632, lr_0 = 2.8825e-04
Loss = 8.8658e-02, PNorm = 35.1728, GNorm = 1.2330, lr_0 = 2.8072e-04
Validation rmse = 0.144946
Epoch 32
Loss = 8.2751e-02, PNorm = 35.1838, GNorm = 0.9824, lr_0 = 2.7339e-04
Validation rmse = 0.144663
Epoch 33
Loss = 5.5263e-02, PNorm = 35.1926, GNorm = 2.1430, lr_0 = 2.6625e-04
Loss = 8.0750e-02, PNorm = 35.2019, GNorm = 0.8095, lr_0 = 2.5929e-04
Validation rmse = 0.149770
Epoch 34
Loss = 1.0214e-01, PNorm = 35.2104, GNorm = 1.5052, lr_0 = 2.5252e-04
Loss = 7.0703e-02, PNorm = 35.2201, GNorm = 0.6920, lr_0 = 2.4593e-04
Loss = 7.1099e-02, PNorm = 35.2211, GNorm = 1.4360, lr_0 = 2.4528e-04
Validation rmse = 0.146676
Epoch 35
Loss = 7.2348e-02, PNorm = 35.2281, GNorm = 0.5740, lr_0 = 2.3887e-04
Validation rmse = 0.144820
Epoch 36
Loss = 8.5512e-02, PNorm = 35.2362, GNorm = 1.1215, lr_0 = 2.3263e-04
Loss = 7.6524e-02, PNorm = 35.2444, GNorm = 0.5963, lr_0 = 2.2655e-04
Validation rmse = 0.147766
Epoch 37
Loss = 7.9719e-02, PNorm = 35.2524, GNorm = 0.9848, lr_0 = 2.2064e-04
Validation rmse = 0.144119
Epoch 38
Loss = 7.6926e-02, PNorm = 35.2604, GNorm = 0.5562, lr_0 = 2.1487e-04
Loss = 7.2621e-02, PNorm = 35.2691, GNorm = 0.4189, lr_0 = 2.0926e-04
Validation rmse = 0.145976
Epoch 39
Loss = 7.6381e-02, PNorm = 35.2760, GNorm = 0.4438, lr_0 = 2.0326e-04
Validation rmse = 0.150015
Epoch 40
Loss = 9.4280e-02, PNorm = 35.2834, GNorm = 1.4980, lr_0 = 1.9795e-04
Loss = 7.6528e-02, PNorm = 35.2898, GNorm = 0.7904, lr_0 = 1.9278e-04
Validation rmse = 0.145505
Epoch 41
Loss = 7.2511e-02, PNorm = 35.2967, GNorm = 1.2822, lr_0 = 1.8774e-04
Loss = 7.6268e-02, PNorm = 35.3033, GNorm = 2.2740, lr_0 = 1.8284e-04
Validation rmse = 0.144874
Epoch 42
Loss = 7.7227e-02, PNorm = 35.3109, GNorm = 0.7715, lr_0 = 1.7806e-04
Validation rmse = 0.145479
Epoch 43
Loss = 6.9613e-02, PNorm = 35.3184, GNorm = 0.4580, lr_0 = 1.7295e-04
Loss = 6.9452e-02, PNorm = 35.3239, GNorm = 1.5192, lr_0 = 1.6844e-04
Validation rmse = 0.147229
Epoch 44
Loss = 7.2415e-02, PNorm = 35.3302, GNorm = 1.2996, lr_0 = 1.6404e-04
Validation rmse = 0.145844
Epoch 45
Loss = 8.0238e-02, PNorm = 35.3366, GNorm = 1.1993, lr_0 = 1.5975e-04
Loss = 6.4856e-02, PNorm = 35.3427, GNorm = 1.1716, lr_0 = 1.5558e-04
Validation rmse = 0.144848
Epoch 46
Loss = 6.1816e-02, PNorm = 35.3474, GNorm = 0.5281, lr_0 = 1.5152e-04
Validation rmse = 0.144146
Epoch 47
Loss = 3.1461e-02, PNorm = 35.3537, GNorm = 0.3873, lr_0 = 1.4717e-04
Loss = 6.7921e-02, PNorm = 35.3597, GNorm = 0.8831, lr_0 = 1.4332e-04
Validation rmse = 0.144778
Epoch 48
Loss = 7.9135e-02, PNorm = 35.3649, GNorm = 1.0073, lr_0 = 1.3958e-04
Loss = 6.3534e-02, PNorm = 35.3701, GNorm = 2.0843, lr_0 = 1.3594e-04
Validation rmse = 0.145835
Epoch 49
Loss = 6.9438e-02, PNorm = 35.3749, GNorm = 2.2852, lr_0 = 1.3239e-04
Validation rmse = 0.143535
Epoch 50
Loss = 6.5400e-02, PNorm = 35.3802, GNorm = 0.5211, lr_0 = 1.2893e-04
Loss = 7.1445e-02, PNorm = 35.3850, GNorm = 1.2100, lr_0 = 1.2556e-04
Validation rmse = 0.144382
Epoch 51
Loss = 6.8444e-02, PNorm = 35.3907, GNorm = 0.8379, lr_0 = 1.2196e-04
Validation rmse = 0.144797
Epoch 52
Loss = 4.4976e-02, PNorm = 35.3955, GNorm = 0.4822, lr_0 = 1.1877e-04
Loss = 7.2054e-02, PNorm = 35.4001, GNorm = 1.0596, lr_0 = 1.1567e-04
Validation rmse = 0.145483
Epoch 53
Loss = 7.4417e-02, PNorm = 35.4046, GNorm = 2.0282, lr_0 = 1.1265e-04
Validation rmse = 0.144808
Epoch 54
Loss = 3.8243e-02, PNorm = 35.4093, GNorm = 0.8928, lr_0 = 1.0942e-04
Loss = 6.3950e-02, PNorm = 35.4133, GNorm = 0.8395, lr_0 = 1.0656e-04
Validation rmse = 0.144718
Epoch 55
Loss = 5.0359e-02, PNorm = 35.4174, GNorm = 1.1409, lr_0 = 1.0377e-04
Loss = 7.4010e-02, PNorm = 35.4217, GNorm = 0.8022, lr_0 = 1.0106e-04
Validation rmse = 0.143833
Epoch 56
Loss = 6.1415e-02, PNorm = 35.4255, GNorm = 1.0924, lr_0 = 1.0000e-04
Validation rmse = 0.143708
Epoch 57
Loss = 6.5071e-02, PNorm = 35.4292, GNorm = 1.0796, lr_0 = 1.0000e-04
Loss = 6.5703e-02, PNorm = 35.4333, GNorm = 0.4788, lr_0 = 1.0000e-04
Validation rmse = 0.144151
Epoch 58
Loss = 6.4482e-02, PNorm = 35.4371, GNorm = 0.4927, lr_0 = 1.0000e-04
Validation rmse = 0.144750
Epoch 59
Loss = 7.4154e-02, PNorm = 35.4412, GNorm = 0.9909, lr_0 = 1.0000e-04
Loss = 5.3858e-02, PNorm = 35.4453, GNorm = 0.4957, lr_0 = 1.0000e-04
Validation rmse = 0.143931
Model 0 best validation rmse = 0.143535 on epoch 49
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.546436
Ensemble test rmse = 0.546436
1-fold cross validation
	Seed 0 ==> test rmse = 0.546436
Overall test rmse = 0.546436 +/- 0.000000
Elapsed time = 0:00:41
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/Hept_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/Hept_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/Hept_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 983 | train size = 786 | val size = 197 | test size = 49
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.9228e-01, PNorm = 34.0159, GNorm = 2.3371, lr_0 = 4.3000e-04
Validation rmse = 0.264551
Epoch 1
Loss = 7.7340e-01, PNorm = 34.0538, GNorm = 7.5141, lr_0 = 7.6000e-04
Loss = 5.5996e-01, PNorm = 34.1194, GNorm = 13.8660, lr_0 = 9.9472e-04
Validation rmse = 0.243167
Epoch 2
Loss = 5.1418e-01, PNorm = 34.1906, GNorm = 2.5523, lr_0 = 9.6874e-04
Validation rmse = 0.199709
Epoch 3
Loss = 3.5382e-01, PNorm = 34.2662, GNorm = 3.5426, lr_0 = 9.4344e-04
Loss = 3.6703e-01, PNorm = 34.3309, GNorm = 4.4495, lr_0 = 9.1879e-04
Validation rmse = 0.179516
Epoch 4
Loss = 3.6682e-01, PNorm = 34.3862, GNorm = 1.3021, lr_0 = 8.9243e-04
Validation rmse = 0.189125
Epoch 5
Loss = 3.3349e-01, PNorm = 34.4366, GNorm = 4.0654, lr_0 = 8.6912e-04
Loss = 2.9223e-01, PNorm = 34.4868, GNorm = 2.2698, lr_0 = 8.4642e-04
Validation rmse = 0.161159
Epoch 6
Loss = 2.3047e-01, PNorm = 34.5373, GNorm = 2.9520, lr_0 = 8.2431e-04
Loss = 2.4936e-01, PNorm = 34.5805, GNorm = 3.9727, lr_0 = 8.0278e-04
Validation rmse = 0.152088
Epoch 7
Loss = 2.2906e-01, PNorm = 34.6155, GNorm = 5.2414, lr_0 = 7.8181e-04
Validation rmse = 0.197766
Epoch 8
Loss = 2.7161e-01, PNorm = 34.6445, GNorm = 9.2639, lr_0 = 7.5938e-04
Loss = 2.4150e-01, PNorm = 34.6793, GNorm = 0.8571, lr_0 = 7.3955e-04
Validation rmse = 0.161670
Epoch 9
Loss = 1.8143e-01, PNorm = 34.7037, GNorm = 5.2927, lr_0 = 7.2023e-04
Validation rmse = 0.147650
Epoch 10
Loss = 2.0177e-01, PNorm = 34.7315, GNorm = 1.4027, lr_0 = 7.0142e-04
Loss = 1.7824e-01, PNorm = 34.7525, GNorm = 3.0462, lr_0 = 6.8310e-04
Validation rmse = 0.143054
Epoch 11
Loss = 1.6937e-01, PNorm = 34.7777, GNorm = 0.6985, lr_0 = 6.6350e-04
Validation rmse = 0.137268
Epoch 12
Loss = 1.5532e-01, PNorm = 34.7987, GNorm = 1.2983, lr_0 = 6.4617e-04
Loss = 1.7375e-01, PNorm = 34.8198, GNorm = 1.9060, lr_0 = 6.2929e-04
Validation rmse = 0.148008
Epoch 13
Loss = 1.6125e-01, PNorm = 34.8421, GNorm = 1.9128, lr_0 = 6.1285e-04
Loss = 1.5289e-01, PNorm = 34.8571, GNorm = 0.7757, lr_0 = 5.9685e-04
Validation rmse = 0.140961
Epoch 14
Loss = 1.5680e-01, PNorm = 34.8788, GNorm = 2.4444, lr_0 = 5.8126e-04
Validation rmse = 0.135350
Epoch 15
Loss = 1.6934e-01, PNorm = 34.8977, GNorm = 2.1668, lr_0 = 5.6458e-04
Loss = 1.4292e-01, PNorm = 34.9126, GNorm = 0.7318, lr_0 = 5.4983e-04
Validation rmse = 0.141584
Epoch 16
Loss = 1.4910e-01, PNorm = 34.9307, GNorm = 7.4138, lr_0 = 5.3547e-04
Validation rmse = 0.138433
Epoch 17
Loss = 1.3372e-01, PNorm = 34.9472, GNorm = 1.6167, lr_0 = 5.2148e-04
Loss = 1.2955e-01, PNorm = 34.9637, GNorm = 0.9100, lr_0 = 5.0786e-04
Validation rmse = 0.132012
Epoch 18
Loss = 1.2077e-01, PNorm = 34.9815, GNorm = 1.0891, lr_0 = 4.9329e-04
Validation rmse = 0.131932
Epoch 19
Loss = 1.2109e-01, PNorm = 34.9977, GNorm = 1.6165, lr_0 = 4.8041e-04
Loss = 1.3405e-01, PNorm = 35.0119, GNorm = 2.2798, lr_0 = 4.6786e-04
Validation rmse = 0.133488
Epoch 20
Loss = 1.1475e-01, PNorm = 35.0254, GNorm = 1.0686, lr_0 = 4.5564e-04
Loss = 1.5090e-01, PNorm = 35.0383, GNorm = 2.3155, lr_0 = 4.4374e-04
Validation rmse = 0.132167
Epoch 21
Loss = 1.2609e-01, PNorm = 35.0554, GNorm = 4.2610, lr_0 = 4.3215e-04
Validation rmse = 0.132302
Epoch 22
Loss = 1.3986e-01, PNorm = 35.0671, GNorm = 0.7848, lr_0 = 4.1975e-04
Loss = 1.2575e-01, PNorm = 35.0818, GNorm = 0.6946, lr_0 = 4.0878e-04
Validation rmse = 0.132314
Epoch 23
Loss = 1.2839e-01, PNorm = 35.0945, GNorm = 2.4248, lr_0 = 3.9811e-04
Validation rmse = 0.130935
Epoch 24
Loss = 1.1622e-01, PNorm = 35.1076, GNorm = 0.7836, lr_0 = 3.8771e-04
Loss = 1.2219e-01, PNorm = 35.1182, GNorm = 1.7202, lr_0 = 3.7758e-04
Validation rmse = 0.134120
Epoch 25
Loss = 1.1200e-01, PNorm = 35.1292, GNorm = 0.4726, lr_0 = 3.6772e-04
Validation rmse = 0.128835
Epoch 26
Loss = 1.1814e-01, PNorm = 35.1413, GNorm = 1.7247, lr_0 = 3.5717e-04
Loss = 1.1713e-01, PNorm = 35.1527, GNorm = 0.9365, lr_0 = 3.4784e-04
Validation rmse = 0.130235
Epoch 27
Loss = 1.0445e-01, PNorm = 35.1633, GNorm = 1.0895, lr_0 = 3.3875e-04
Loss = 1.2103e-01, PNorm = 35.1736, GNorm = 2.0211, lr_0 = 3.2991e-04
Validation rmse = 0.131679
Epoch 28
Loss = 1.1023e-01, PNorm = 35.1843, GNorm = 1.4596, lr_0 = 3.2129e-04
Validation rmse = 0.129891
Epoch 29
Loss = 1.0535e-01, PNorm = 35.1937, GNorm = 1.4201, lr_0 = 3.1207e-04
Loss = 1.0781e-01, PNorm = 35.2036, GNorm = 0.8507, lr_0 = 3.0392e-04
Validation rmse = 0.128979
Epoch 30
Loss = 1.1759e-01, PNorm = 35.2144, GNorm = 2.2487, lr_0 = 2.9598e-04
Validation rmse = 0.128661
Epoch 31
Loss = 8.3105e-02, PNorm = 35.2245, GNorm = 1.7828, lr_0 = 2.8825e-04
Loss = 1.2542e-01, PNorm = 35.2335, GNorm = 2.7788, lr_0 = 2.8072e-04
Validation rmse = 0.132021
Epoch 32
Loss = 1.2451e-01, PNorm = 35.2440, GNorm = 2.2104, lr_0 = 2.7339e-04
Validation rmse = 0.129758
Epoch 33
Loss = 1.6283e-01, PNorm = 35.2551, GNorm = 1.8050, lr_0 = 2.6554e-04
Loss = 1.0394e-01, PNorm = 35.2633, GNorm = 3.8992, lr_0 = 2.5861e-04
Validation rmse = 0.132504
Epoch 34
Loss = 1.0195e-01, PNorm = 35.2728, GNorm = 1.9902, lr_0 = 2.5185e-04
Loss = 1.1224e-01, PNorm = 35.2809, GNorm = 2.1688, lr_0 = 2.4528e-04
Validation rmse = 0.127289
Epoch 35
Loss = 1.0198e-01, PNorm = 35.2900, GNorm = 0.9375, lr_0 = 2.3887e-04
Validation rmse = 0.129537
Epoch 36
Loss = 1.0556e-01, PNorm = 35.2975, GNorm = 0.8954, lr_0 = 2.3202e-04
Loss = 9.8847e-02, PNorm = 35.3041, GNorm = 1.0113, lr_0 = 2.2596e-04
Validation rmse = 0.128077
Epoch 37
Loss = 1.1046e-01, PNorm = 35.3141, GNorm = 0.6335, lr_0 = 2.2005e-04
Validation rmse = 0.128501
Epoch 38
Loss = 1.0645e-01, PNorm = 35.3206, GNorm = 1.6740, lr_0 = 2.1431e-04
Loss = 1.0007e-01, PNorm = 35.3274, GNorm = 0.5572, lr_0 = 2.0871e-04
Validation rmse = 0.127325
Epoch 39
Loss = 9.8457e-02, PNorm = 35.3348, GNorm = 1.4761, lr_0 = 2.0326e-04
Validation rmse = 0.128343
Epoch 40
Loss = 1.0187e-01, PNorm = 35.3423, GNorm = 2.0283, lr_0 = 1.9743e-04
Loss = 1.0849e-01, PNorm = 35.3507, GNorm = 1.2012, lr_0 = 1.9227e-04
Validation rmse = 0.127677
Epoch 41
Loss = 9.8309e-02, PNorm = 35.3563, GNorm = 0.7105, lr_0 = 1.8725e-04
Loss = 1.0231e-01, PNorm = 35.3616, GNorm = 2.5908, lr_0 = 1.8236e-04
Validation rmse = 0.128620
Epoch 42
Loss = 8.7407e-02, PNorm = 35.3679, GNorm = 1.2240, lr_0 = 1.7759e-04
Validation rmse = 0.128980
Epoch 43
Loss = 7.4968e-02, PNorm = 35.3742, GNorm = 1.0694, lr_0 = 1.7250e-04
Loss = 1.1214e-01, PNorm = 35.3811, GNorm = 1.1113, lr_0 = 1.6799e-04
Validation rmse = 0.128540
Epoch 44
Loss = 9.3336e-02, PNorm = 35.3857, GNorm = 1.3181, lr_0 = 1.6360e-04
Validation rmse = 0.128516
Epoch 45
Loss = 1.0971e-01, PNorm = 35.3914, GNorm = 1.6952, lr_0 = 1.5933e-04
Loss = 9.5390e-02, PNorm = 35.3981, GNorm = 2.2719, lr_0 = 1.5517e-04
Validation rmse = 0.128018
Epoch 46
Loss = 1.0147e-01, PNorm = 35.4022, GNorm = 2.2875, lr_0 = 1.5112e-04
Validation rmse = 0.131900
Epoch 47
Loss = 6.5007e-02, PNorm = 35.4092, GNorm = 1.3835, lr_0 = 1.4678e-04
Loss = 1.1103e-01, PNorm = 35.4147, GNorm = 0.8290, lr_0 = 1.4295e-04
Validation rmse = 0.130272
Epoch 48
Loss = 9.6634e-02, PNorm = 35.4179, GNorm = 1.2558, lr_0 = 1.3921e-04
Loss = 9.9525e-02, PNorm = 35.4242, GNorm = 1.5684, lr_0 = 1.3558e-04
Validation rmse = 0.128608
Epoch 49
Loss = 8.9241e-02, PNorm = 35.4287, GNorm = 0.8625, lr_0 = 1.3204e-04
Validation rmse = 0.131094
Epoch 50
Loss = 1.0270e-01, PNorm = 35.4332, GNorm = 1.1716, lr_0 = 1.2859e-04
Loss = 1.0023e-01, PNorm = 35.4369, GNorm = 2.3007, lr_0 = 1.2523e-04
Validation rmse = 0.127745
Epoch 51
Loss = 8.0949e-02, PNorm = 35.4418, GNorm = 0.5259, lr_0 = 1.2163e-04
Validation rmse = 0.127949
Epoch 52
Loss = 9.4284e-02, PNorm = 35.4469, GNorm = 0.7287, lr_0 = 1.1846e-04
Loss = 9.1600e-02, PNorm = 35.4508, GNorm = 2.6430, lr_0 = 1.1536e-04
Validation rmse = 0.128360
Epoch 53
Loss = 8.9170e-02, PNorm = 35.4547, GNorm = 0.9903, lr_0 = 1.1235e-04
Validation rmse = 0.127842
Epoch 54
Loss = 1.0757e-01, PNorm = 35.4596, GNorm = 0.6072, lr_0 = 1.0913e-04
Loss = 8.2251e-02, PNorm = 35.4632, GNorm = 1.4123, lr_0 = 1.0628e-04
Validation rmse = 0.128795
Epoch 55
Loss = 9.3727e-02, PNorm = 35.4672, GNorm = 0.4024, lr_0 = 1.0350e-04
Loss = 9.5094e-02, PNorm = 35.4707, GNorm = 0.8319, lr_0 = 1.0080e-04
Validation rmse = 0.126922
Epoch 56
Loss = 9.3383e-02, PNorm = 35.4743, GNorm = 0.5835, lr_0 = 1.0000e-04
Validation rmse = 0.127289
Epoch 57
Loss = 1.1095e-01, PNorm = 35.4782, GNorm = 0.9271, lr_0 = 1.0000e-04
Loss = 8.4057e-02, PNorm = 35.4825, GNorm = 1.1873, lr_0 = 1.0000e-04
Validation rmse = 0.130772
Epoch 58
Loss = 8.3998e-02, PNorm = 35.4859, GNorm = 0.7913, lr_0 = 1.0000e-04
Validation rmse = 0.128546
Epoch 59
Loss = 9.2354e-02, PNorm = 35.4891, GNorm = 2.6726, lr_0 = 1.0000e-04
Loss = 9.1711e-02, PNorm = 35.4933, GNorm = 0.8883, lr_0 = 1.0000e-04
Validation rmse = 0.127298
Model 0 best validation rmse = 0.126922 on epoch 55
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.694082
Ensemble test rmse = 0.694082
1-fold cross validation
	Seed 0 ==> test rmse = 0.694082
Overall test rmse = 0.694082 +/- 0.000000
Elapsed time = 0:00:41
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/Acet_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/Acet_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/Acet_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 936 | train size = 748 | val size = 188 | test size = 96
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1374e-01, PNorm = 34.0194, GNorm = 5.8969, lr_0 = 4.5357e-04
Validation rmse = 0.289632
Epoch 1
Loss = 6.0251e-01, PNorm = 34.0641, GNorm = 10.4085, lr_0 = 8.0714e-04
Validation rmse = 0.305579
Epoch 2
Loss = 5.7720e-01, PNorm = 34.1308, GNorm = 13.9780, lr_0 = 9.8872e-04
Loss = 4.7785e-01, PNorm = 34.1961, GNorm = 4.8383, lr_0 = 9.6108e-04
Validation rmse = 0.254494
Epoch 3
Loss = 4.1067e-01, PNorm = 34.2540, GNorm = 4.9512, lr_0 = 9.3421e-04
Validation rmse = 0.203209
Epoch 4
Loss = 3.7336e-01, PNorm = 34.3138, GNorm = 5.0424, lr_0 = 9.0809e-04
Loss = 2.7892e-01, PNorm = 34.3735, GNorm = 1.2603, lr_0 = 8.8270e-04
Validation rmse = 0.176492
Epoch 5
Loss = 2.5466e-01, PNorm = 34.4240, GNorm = 4.9642, lr_0 = 8.5802e-04
Validation rmse = 0.189792
Epoch 6
Loss = 3.3246e-01, PNorm = 34.4707, GNorm = 4.8934, lr_0 = 8.3403e-04
Loss = 2.4502e-01, PNorm = 34.5190, GNorm = 6.8517, lr_0 = 8.1071e-04
Validation rmse = 0.180957
Epoch 7
Loss = 2.6930e-01, PNorm = 34.5560, GNorm = 5.7980, lr_0 = 7.8805e-04
Validation rmse = 0.151804
Epoch 8
Loss = 1.0431e-01, PNorm = 34.5958, GNorm = 1.6196, lr_0 = 7.6601e-04
Loss = 1.6266e-01, PNorm = 34.6356, GNorm = 2.9807, lr_0 = 7.4460e-04
Validation rmse = 0.148283
Epoch 9
Loss = 1.5737e-01, PNorm = 34.6771, GNorm = 1.1695, lr_0 = 7.2378e-04
Validation rmse = 0.140644
Epoch 10
Loss = 1.7091e-01, PNorm = 34.7169, GNorm = 1.6783, lr_0 = 7.0354e-04
Loss = 1.3926e-01, PNorm = 34.7504, GNorm = 5.4753, lr_0 = 6.8387e-04
Validation rmse = 0.149982
Epoch 11
Loss = 1.3056e-01, PNorm = 34.7823, GNorm = 2.5321, lr_0 = 6.6475e-04
Validation rmse = 0.140002
Epoch 12
Loss = 1.2278e-01, PNorm = 34.8097, GNorm = 0.9957, lr_0 = 6.4617e-04
Loss = 1.3849e-01, PNorm = 34.8380, GNorm = 2.9045, lr_0 = 6.2810e-04
Validation rmse = 0.142901
Epoch 13
Loss = 1.3680e-01, PNorm = 34.8625, GNorm = 1.1106, lr_0 = 6.1054e-04
Validation rmse = 0.133600
Epoch 14
Loss = 8.1132e-02, PNorm = 34.8824, GNorm = 1.9502, lr_0 = 5.9347e-04
Loss = 1.2774e-01, PNorm = 34.9044, GNorm = 4.2544, lr_0 = 5.7688e-04
Validation rmse = 0.133138
Epoch 15
Loss = 1.0144e-01, PNorm = 34.9209, GNorm = 1.8374, lr_0 = 5.6075e-04
Validation rmse = 0.140484
Epoch 16
Loss = 9.4796e-02, PNorm = 34.9415, GNorm = 1.1435, lr_0 = 5.4507e-04
Loss = 1.1259e-01, PNorm = 34.9618, GNorm = 0.8844, lr_0 = 5.2983e-04
Validation rmse = 0.136009
Epoch 17
Loss = 1.0541e-01, PNorm = 34.9762, GNorm = 2.9892, lr_0 = 5.1502e-04
Validation rmse = 0.134792
Epoch 18
Loss = 9.7407e-02, PNorm = 34.9922, GNorm = 1.9331, lr_0 = 5.0062e-04
Loss = 9.9644e-02, PNorm = 35.0074, GNorm = 2.6517, lr_0 = 4.8662e-04
Validation rmse = 0.132678
Epoch 19
Loss = 9.1841e-02, PNorm = 35.0222, GNorm = 1.1188, lr_0 = 4.7302e-04
Validation rmse = 0.131332
Epoch 20
Loss = 1.2315e-01, PNorm = 35.0362, GNorm = 1.2169, lr_0 = 4.5979e-04
Loss = 9.8547e-02, PNorm = 35.0508, GNorm = 0.7521, lr_0 = 4.4694e-04
Validation rmse = 0.132437
Epoch 21
Loss = 1.0749e-01, PNorm = 35.0596, GNorm = 2.8071, lr_0 = 4.3444e-04
Validation rmse = 0.131773
Epoch 22
Loss = 6.1434e-02, PNorm = 35.0759, GNorm = 0.5739, lr_0 = 4.2229e-04
Loss = 9.8505e-02, PNorm = 35.0902, GNorm = 1.2221, lr_0 = 4.1049e-04
Validation rmse = 0.136712
Epoch 23
Loss = 1.0470e-01, PNorm = 35.1044, GNorm = 2.7464, lr_0 = 3.9901e-04
Validation rmse = 0.131653
Epoch 24
Loss = 7.5011e-02, PNorm = 35.1155, GNorm = 1.7804, lr_0 = 3.8786e-04
Loss = 9.2349e-02, PNorm = 35.1286, GNorm = 0.7855, lr_0 = 3.7701e-04
Validation rmse = 0.132701
Epoch 25
Loss = 8.3636e-02, PNorm = 35.1345, GNorm = 0.6499, lr_0 = 3.6647e-04
Validation rmse = 0.131583
Epoch 26
Loss = 1.2081e-01, PNorm = 35.1473, GNorm = 2.3179, lr_0 = 3.5522e-04
Loss = 8.6744e-02, PNorm = 35.1575, GNorm = 2.1634, lr_0 = 3.4528e-04
Validation rmse = 0.131905
Epoch 27
Loss = 9.1743e-02, PNorm = 35.1696, GNorm = 0.8937, lr_0 = 3.3563e-04
Validation rmse = 0.130077
Epoch 28
Loss = 7.3618e-02, PNorm = 35.1794, GNorm = 1.2679, lr_0 = 3.2625e-04
Loss = 8.9384e-02, PNorm = 35.1868, GNorm = 2.2596, lr_0 = 3.1713e-04
Validation rmse = 0.146632
Epoch 29
Loss = 1.1070e-01, PNorm = 35.1973, GNorm = 2.0249, lr_0 = 3.0826e-04
Validation rmse = 0.134073
Epoch 30
Loss = 7.3507e-02, PNorm = 35.2082, GNorm = 0.5839, lr_0 = 2.9964e-04
Loss = 9.9194e-02, PNorm = 35.2154, GNorm = 3.2328, lr_0 = 2.9126e-04
Validation rmse = 0.128677
Epoch 31
Loss = 8.0557e-02, PNorm = 35.2262, GNorm = 2.1174, lr_0 = 2.8312e-04
Validation rmse = 0.131842
Epoch 32
Loss = 6.3933e-02, PNorm = 35.2347, GNorm = 1.6586, lr_0 = 2.7520e-04
Loss = 9.0005e-02, PNorm = 35.2427, GNorm = 2.1889, lr_0 = 2.6751e-04
Validation rmse = 0.130716
Epoch 33
Loss = 7.1480e-02, PNorm = 35.2489, GNorm = 0.3614, lr_0 = 2.6003e-04
Validation rmse = 0.129063
Epoch 34
Loss = 9.0485e-02, PNorm = 35.2558, GNorm = 0.9712, lr_0 = 2.5276e-04
Loss = 7.7118e-02, PNorm = 35.2638, GNorm = 2.8289, lr_0 = 2.4569e-04
Validation rmse = 0.133843
Epoch 35
Loss = 9.4752e-02, PNorm = 35.2708, GNorm = 2.4112, lr_0 = 2.3882e-04
Validation rmse = 0.128800
Epoch 36
Loss = 7.3297e-02, PNorm = 35.2779, GNorm = 0.8542, lr_0 = 2.3215e-04
Loss = 8.7407e-02, PNorm = 35.2854, GNorm = 1.8695, lr_0 = 2.2566e-04
Validation rmse = 0.132470
Epoch 37
Loss = 7.3607e-02, PNorm = 35.2914, GNorm = 2.1509, lr_0 = 2.1935e-04
Validation rmse = 0.134068
Epoch 38
Loss = 7.5189e-02, PNorm = 35.2975, GNorm = 2.7816, lr_0 = 2.1321e-04
Loss = 8.2411e-02, PNorm = 35.3043, GNorm = 3.7138, lr_0 = 2.0725e-04
Validation rmse = 0.131088
Epoch 39
Loss = 7.0425e-02, PNorm = 35.3097, GNorm = 1.4097, lr_0 = 2.0146e-04
Validation rmse = 0.128962
Epoch 40
Loss = 8.8865e-02, PNorm = 35.3158, GNorm = 0.8114, lr_0 = 1.9583e-04
Loss = 7.8247e-02, PNorm = 35.3210, GNorm = 2.8509, lr_0 = 1.9035e-04
Validation rmse = 0.128878
Epoch 41
Loss = 7.6053e-02, PNorm = 35.3260, GNorm = 0.7383, lr_0 = 1.8503e-04
Validation rmse = 0.128471
Epoch 42
Loss = 1.1622e-01, PNorm = 35.3321, GNorm = 1.0429, lr_0 = 1.7986e-04
Loss = 7.3568e-02, PNorm = 35.3376, GNorm = 0.9244, lr_0 = 1.7483e-04
Validation rmse = 0.131074
Epoch 43
Loss = 8.1545e-02, PNorm = 35.3424, GNorm = 2.6211, lr_0 = 1.6994e-04
Validation rmse = 0.127371
Epoch 44
Loss = 8.6179e-02, PNorm = 35.3477, GNorm = 1.0650, lr_0 = 1.6519e-04
Loss = 7.4555e-02, PNorm = 35.3527, GNorm = 0.6024, lr_0 = 1.6057e-04
Validation rmse = 0.128173
Epoch 45
Loss = 7.3606e-02, PNorm = 35.3571, GNorm = 1.4030, lr_0 = 1.5608e-04
Validation rmse = 0.128588
Epoch 46
Loss = 9.6849e-02, PNorm = 35.3617, GNorm = 0.8722, lr_0 = 1.5172e-04
Loss = 7.4592e-02, PNorm = 35.3668, GNorm = 1.6381, lr_0 = 1.4748e-04
Validation rmse = 0.129916
Epoch 47
Loss = 7.9843e-02, PNorm = 35.3712, GNorm = 1.5839, lr_0 = 1.4335e-04
Validation rmse = 0.130020
Epoch 48
Loss = 6.5103e-02, PNorm = 35.3751, GNorm = 0.4571, lr_0 = 1.3934e-04
Loss = 7.6654e-02, PNorm = 35.3791, GNorm = 3.6494, lr_0 = 1.3545e-04
Validation rmse = 0.136863
Epoch 49
Loss = 8.1151e-02, PNorm = 35.3842, GNorm = 2.4494, lr_0 = 1.3166e-04
Validation rmse = 0.129816
Epoch 50
Loss = 6.9569e-02, PNorm = 35.3875, GNorm = 1.7483, lr_0 = 1.2798e-04
Loss = 8.1356e-02, PNorm = 35.3917, GNorm = 1.9096, lr_0 = 1.2440e-04
Validation rmse = 0.130896
Epoch 51
Loss = 7.0322e-02, PNorm = 35.3964, GNorm = 2.4421, lr_0 = 1.2058e-04
Validation rmse = 0.127845
Epoch 52
Loss = 8.2071e-02, PNorm = 35.3996, GNorm = 0.8215, lr_0 = 1.1721e-04
Loss = 6.6843e-02, PNorm = 35.4030, GNorm = 1.8726, lr_0 = 1.1393e-04
Validation rmse = 0.128580
Epoch 53
Loss = 7.4522e-02, PNorm = 35.4068, GNorm = 1.1058, lr_0 = 1.1075e-04
Validation rmse = 0.128007
Epoch 54
Loss = 6.6867e-02, PNorm = 35.4103, GNorm = 0.5782, lr_0 = 1.0765e-04
Loss = 6.2222e-02, PNorm = 35.4137, GNorm = 0.8769, lr_0 = 1.0464e-04
Validation rmse = 0.128001
Epoch 55
Loss = 5.8826e-02, PNorm = 35.4161, GNorm = 1.2254, lr_0 = 1.0172e-04
Validation rmse = 0.127694
Epoch 56
Loss = 8.0226e-02, PNorm = 35.4191, GNorm = 1.3110, lr_0 = 1.0000e-04
Loss = 6.7407e-02, PNorm = 35.4226, GNorm = 0.6313, lr_0 = 1.0000e-04
Validation rmse = 0.128474
Epoch 57
Loss = 7.2067e-02, PNorm = 35.4249, GNorm = 1.0039, lr_0 = 1.0000e-04
Validation rmse = 0.128235
Epoch 58
Loss = 6.0206e-02, PNorm = 35.4286, GNorm = 0.5823, lr_0 = 1.0000e-04
Loss = 6.7594e-02, PNorm = 35.4313, GNorm = 0.8649, lr_0 = 1.0000e-04
Validation rmse = 0.127487
Epoch 59
Loss = 7.2413e-02, PNorm = 35.4350, GNorm = 2.5404, lr_0 = 1.0000e-04
Validation rmse = 0.132476
Model 0 best validation rmse = 0.127371 on epoch 43
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.265629
Ensemble test rmse = 0.265629
1-fold cross validation
	Seed 0 ==> test rmse = 0.265629
Overall test rmse = 0.265629 +/- 0.000000
Elapsed time = 0:00:39
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/MeCN_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/MeCN_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/MeCN_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 916 | train size = 732 | val size = 184 | test size = 116
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1503e-01, PNorm = 34.0187, GNorm = 5.3462, lr_0 = 4.5357e-04
Validation rmse = 0.314898
Epoch 1
Loss = 6.2095e-01, PNorm = 34.0650, GNorm = 14.0791, lr_0 = 8.0714e-04
Validation rmse = 0.335121
Epoch 2
Loss = 7.0381e-01, PNorm = 34.1121, GNorm = 12.3984, lr_0 = 9.8872e-04
Loss = 5.6252e-01, PNorm = 34.1746, GNorm = 0.8192, lr_0 = 9.6108e-04
Validation rmse = 0.242451
Epoch 3
Loss = 4.6118e-01, PNorm = 34.2497, GNorm = 7.9945, lr_0 = 9.3156e-04
Validation rmse = 0.215441
Epoch 4
Loss = 2.7293e-01, PNorm = 34.3147, GNorm = 5.7174, lr_0 = 9.0552e-04
Loss = 3.2098e-01, PNorm = 34.3718, GNorm = 6.0730, lr_0 = 8.8020e-04
Validation rmse = 0.208125
Epoch 5
Loss = 2.1750e-01, PNorm = 34.4303, GNorm = 2.0666, lr_0 = 8.5559e-04
Validation rmse = 0.191003
Epoch 6
Loss = 1.5636e-01, PNorm = 34.4853, GNorm = 2.5834, lr_0 = 8.2931e-04
Loss = 2.7488e-01, PNorm = 34.5321, GNorm = 5.4988, lr_0 = 8.0613e-04
Validation rmse = 0.173325
Epoch 7
Loss = 1.8869e-01, PNorm = 34.5751, GNorm = 3.4938, lr_0 = 7.8359e-04
Validation rmse = 0.212678
Epoch 8
Loss = 2.5118e-01, PNorm = 34.6179, GNorm = 1.5453, lr_0 = 7.6168e-04
Loss = 2.6158e-01, PNorm = 34.6558, GNorm = 5.3934, lr_0 = 7.4039e-04
Validation rmse = 0.181298
Epoch 9
Loss = 1.9084e-01, PNorm = 34.6920, GNorm = 5.3922, lr_0 = 7.1765e-04
Validation rmse = 0.159801
Epoch 10
Loss = 2.0347e-01, PNorm = 34.7217, GNorm = 1.1389, lr_0 = 6.9758e-04
Loss = 1.8857e-01, PNorm = 34.7496, GNorm = 4.0763, lr_0 = 6.7808e-04
Validation rmse = 0.155179
Epoch 11
Loss = 1.5408e-01, PNorm = 34.7789, GNorm = 1.6391, lr_0 = 6.5912e-04
Validation rmse = 0.150890
Epoch 12
Loss = 1.3899e-01, PNorm = 34.8003, GNorm = 3.3196, lr_0 = 6.3888e-04
Loss = 1.5568e-01, PNorm = 34.8191, GNorm = 2.7632, lr_0 = 6.2102e-04
Validation rmse = 0.146196
Epoch 13
Loss = 1.3513e-01, PNorm = 34.8354, GNorm = 2.6143, lr_0 = 6.0365e-04
Validation rmse = 0.144914
Epoch 14
Loss = 1.6682e-01, PNorm = 34.8563, GNorm = 4.7387, lr_0 = 5.8512e-04
Validation rmse = 0.148283
Epoch 15
Loss = 1.6565e-01, PNorm = 34.8733, GNorm = 3.3854, lr_0 = 5.6876e-04
Loss = 1.4434e-01, PNorm = 34.8905, GNorm = 2.9021, lr_0 = 5.5285e-04
Validation rmse = 0.149386
Epoch 16
Loss = 1.5658e-01, PNorm = 34.9031, GNorm = 1.9797, lr_0 = 5.3740e-04
Validation rmse = 0.143859
Epoch 17
Loss = 1.1609e-01, PNorm = 34.9193, GNorm = 1.2371, lr_0 = 5.2089e-04
Loss = 1.3112e-01, PNorm = 34.9343, GNorm = 0.5402, lr_0 = 5.0633e-04
Validation rmse = 0.139346
Epoch 18
Loss = 1.1600e-01, PNorm = 34.9478, GNorm = 2.1349, lr_0 = 4.9217e-04
Validation rmse = 0.142932
Epoch 19
Loss = 1.1970e-01, PNorm = 34.9629, GNorm = 1.1030, lr_0 = 4.7841e-04
Loss = 1.2761e-01, PNorm = 34.9763, GNorm = 1.8498, lr_0 = 4.6504e-04
Validation rmse = 0.135933
Epoch 20
Loss = 1.1613e-01, PNorm = 34.9889, GNorm = 1.9119, lr_0 = 4.5076e-04
Validation rmse = 0.137664
Epoch 21
Loss = 1.0018e-01, PNorm = 35.0007, GNorm = 1.1496, lr_0 = 4.3815e-04
Loss = 1.3161e-01, PNorm = 35.0134, GNorm = 1.5301, lr_0 = 4.2590e-04
Validation rmse = 0.137609
Epoch 22
Loss = 1.2593e-01, PNorm = 35.0260, GNorm = 3.0620, lr_0 = 4.1399e-04
Validation rmse = 0.136614
Epoch 23
Loss = 1.3270e-01, PNorm = 35.0363, GNorm = 3.4654, lr_0 = 4.0128e-04
Loss = 1.2774e-01, PNorm = 35.0475, GNorm = 2.2604, lr_0 = 3.9006e-04
Validation rmse = 0.151630
Epoch 24
Loss = 1.1583e-01, PNorm = 35.0584, GNorm = 1.2683, lr_0 = 3.7916e-04
Validation rmse = 0.134304
Epoch 25
Loss = 1.0399e-01, PNorm = 35.0687, GNorm = 1.1920, lr_0 = 3.6856e-04
Loss = 1.2241e-01, PNorm = 35.0798, GNorm = 1.7505, lr_0 = 3.5825e-04
Loss = 7.2840e-02, PNorm = 35.0806, GNorm = 2.5526, lr_0 = 3.5724e-04
Validation rmse = 0.135607
Epoch 26
Loss = 1.2347e-01, PNorm = 35.0896, GNorm = 1.7963, lr_0 = 3.4725e-04
Validation rmse = 0.136043
Epoch 27
Loss = 1.1631e-01, PNorm = 35.1005, GNorm = 0.3960, lr_0 = 3.3754e-04
Validation rmse = 0.133644
Epoch 28
Loss = 1.1755e-01, PNorm = 35.1122, GNorm = 0.5621, lr_0 = 3.2717e-04
Loss = 1.2021e-01, PNorm = 35.1216, GNorm = 2.3091, lr_0 = 3.1803e-04
Validation rmse = 0.134199
Epoch 29
Loss = 1.1590e-01, PNorm = 35.1304, GNorm = 2.1013, lr_0 = 3.0913e-04
Validation rmse = 0.138173
Epoch 30
Loss = 1.1495e-01, PNorm = 35.1412, GNorm = 3.3968, lr_0 = 3.0049e-04
Loss = 1.0220e-01, PNorm = 35.1497, GNorm = 1.2664, lr_0 = 2.9209e-04
Validation rmse = 0.132808
Epoch 31
Loss = 1.2314e-01, PNorm = 35.1598, GNorm = 2.3463, lr_0 = 2.8312e-04
Validation rmse = 0.135817
Epoch 32
Loss = 1.1925e-01, PNorm = 35.1687, GNorm = 1.3557, lr_0 = 2.7520e-04
Loss = 1.0285e-01, PNorm = 35.1790, GNorm = 0.5292, lr_0 = 2.6751e-04
Validation rmse = 0.132988
Epoch 33
Loss = 1.1707e-01, PNorm = 35.1866, GNorm = 0.4239, lr_0 = 2.6003e-04
Validation rmse = 0.139449
Epoch 34
Loss = 1.1694e-01, PNorm = 35.1952, GNorm = 1.4656, lr_0 = 2.5204e-04
Loss = 1.1519e-01, PNorm = 35.2031, GNorm = 2.4191, lr_0 = 2.4500e-04
Validation rmse = 0.134495
Epoch 35
Loss = 1.0875e-01, PNorm = 35.2105, GNorm = 0.5720, lr_0 = 2.3815e-04
Validation rmse = 0.133374
Epoch 36
Loss = 9.8772e-02, PNorm = 35.2172, GNorm = 0.8631, lr_0 = 2.3149e-04
Loss = 1.0758e-01, PNorm = 35.2226, GNorm = 1.8886, lr_0 = 2.2502e-04
Validation rmse = 0.136716
Epoch 37
Loss = 1.1298e-01, PNorm = 35.2298, GNorm = 0.7632, lr_0 = 2.1811e-04
Validation rmse = 0.131077
Epoch 38
Loss = 9.5536e-02, PNorm = 35.2357, GNorm = 0.4834, lr_0 = 2.1201e-04
Loss = 1.0137e-01, PNorm = 35.2418, GNorm = 2.1673, lr_0 = 2.0608e-04
Loss = 1.1913e-01, PNorm = 35.2425, GNorm = 1.6047, lr_0 = 2.0550e-04
Validation rmse = 0.131412
Epoch 39
Loss = 1.0003e-01, PNorm = 35.2487, GNorm = 1.2029, lr_0 = 1.9975e-04
Validation rmse = 0.131755
Epoch 40
Loss = 1.0110e-01, PNorm = 35.2550, GNorm = 0.6292, lr_0 = 1.9417e-04
Loss = 9.7135e-02, PNorm = 35.2606, GNorm = 2.3463, lr_0 = 1.8874e-04
Validation rmse = 0.130733
Epoch 41
Loss = 9.3869e-02, PNorm = 35.2671, GNorm = 1.2923, lr_0 = 1.8346e-04
Validation rmse = 0.131021
Epoch 42
Loss = 9.0742e-02, PNorm = 35.2730, GNorm = 0.6329, lr_0 = 1.7783e-04
Validation rmse = 0.130950
Epoch 43
Loss = 6.1553e-02, PNorm = 35.2779, GNorm = 1.5689, lr_0 = 1.7286e-04
Loss = 9.9811e-02, PNorm = 35.2841, GNorm = 1.9353, lr_0 = 1.6802e-04
Validation rmse = 0.130034
Epoch 44
Loss = 9.2213e-02, PNorm = 35.2887, GNorm = 0.9234, lr_0 = 1.6333e-04
Validation rmse = 0.132148
Epoch 45
Loss = 9.6664e-02, PNorm = 35.2930, GNorm = 1.3919, lr_0 = 1.5831e-04
Loss = 9.7414e-02, PNorm = 35.2986, GNorm = 0.5422, lr_0 = 1.5388e-04
Validation rmse = 0.134063
Epoch 46
Loss = 1.0693e-01, PNorm = 35.3037, GNorm = 1.7443, lr_0 = 1.4958e-04
Validation rmse = 0.130082
Epoch 47
Loss = 8.6711e-02, PNorm = 35.3091, GNorm = 1.4954, lr_0 = 1.4540e-04
Loss = 9.1509e-02, PNorm = 35.3135, GNorm = 1.1916, lr_0 = 1.4133e-04
Validation rmse = 0.130576
Epoch 48
Loss = 9.5227e-02, PNorm = 35.3172, GNorm = 0.8665, lr_0 = 1.3699e-04
Validation rmse = 0.130657
Epoch 49
Loss = 9.2930e-02, PNorm = 35.3219, GNorm = 1.0265, lr_0 = 1.3316e-04
Loss = 9.8618e-02, PNorm = 35.3270, GNorm = 2.0838, lr_0 = 1.2944e-04
Validation rmse = 0.130277
Epoch 50
Loss = 8.9246e-02, PNorm = 35.3298, GNorm = 0.6309, lr_0 = 1.2582e-04
Validation rmse = 0.129319
Epoch 51
Loss = 1.0047e-01, PNorm = 35.3331, GNorm = 2.8456, lr_0 = 1.2196e-04
Loss = 8.8491e-02, PNorm = 35.3367, GNorm = 1.2032, lr_0 = 1.1855e-04
Validation rmse = 0.130077
Epoch 52
Loss = 9.3438e-02, PNorm = 35.3408, GNorm = 1.3070, lr_0 = 1.1523e-04
Validation rmse = 0.128665
Epoch 53
Loss = 8.5542e-02, PNorm = 35.3451, GNorm = 0.4357, lr_0 = 1.1169e-04
Loss = 9.0689e-02, PNorm = 35.3488, GNorm = 0.5935, lr_0 = 1.0857e-04
Validation rmse = 0.130316
Epoch 54
Loss = 8.8171e-02, PNorm = 35.3513, GNorm = 1.4933, lr_0 = 1.0554e-04
Validation rmse = 0.130468
Epoch 55
Loss = 1.1191e-01, PNorm = 35.3546, GNorm = 1.4512, lr_0 = 1.0258e-04
Validation rmse = 0.129822
Epoch 56
Loss = 7.6085e-02, PNorm = 35.3589, GNorm = 1.2309, lr_0 = 1.0000e-04
Loss = 9.6837e-02, PNorm = 35.3617, GNorm = 0.7166, lr_0 = 1.0000e-04
Validation rmse = 0.130661
Epoch 57
Loss = 7.7367e-02, PNorm = 35.3644, GNorm = 1.1072, lr_0 = 1.0000e-04
Validation rmse = 0.129224
Epoch 58
Loss = 1.1854e-01, PNorm = 35.3676, GNorm = 1.7769, lr_0 = 1.0000e-04
Loss = 9.1507e-02, PNorm = 35.3714, GNorm = 0.8516, lr_0 = 1.0000e-04
Validation rmse = 0.128761
Epoch 59
Loss = 9.6342e-02, PNorm = 35.3747, GNorm = 0.7398, lr_0 = 1.0000e-04
Validation rmse = 0.128425
Model 0 best validation rmse = 0.128425 on epoch 59
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.213239
Ensemble test rmse = 0.213239
1-fold cross validation
	Seed 0 ==> test rmse = 0.213239
Overall test rmse = 0.213239 +/- 0.000000
Elapsed time = 0:00:39
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/MTBE_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/MTBE_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/MTBE_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 981 | train size = 784 | val size = 197 | test size = 51
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.2161e-01, PNorm = 34.0175, GNorm = 5.2459, lr_0 = 4.3000e-04
Validation rmse = 0.275664
Epoch 1
Loss = 6.5400e-01, PNorm = 34.0520, GNorm = 6.2599, lr_0 = 7.6000e-04
Loss = 5.2468e-01, PNorm = 34.1136, GNorm = 2.4984, lr_0 = 9.9472e-04
Validation rmse = 0.259389
Epoch 2
Loss = 5.2553e-01, PNorm = 34.1800, GNorm = 1.1446, lr_0 = 9.6874e-04
Validation rmse = 0.193164
Epoch 3
Loss = 3.5361e-01, PNorm = 34.2441, GNorm = 4.1911, lr_0 = 9.4344e-04
Loss = 4.2290e-01, PNorm = 34.3084, GNorm = 8.8950, lr_0 = 9.1879e-04
Validation rmse = 0.204442
Epoch 4
Loss = 4.2225e-01, PNorm = 34.3633, GNorm = 7.9896, lr_0 = 8.9243e-04
Validation rmse = 0.161463
Epoch 5
Loss = 3.2755e-01, PNorm = 34.4172, GNorm = 2.8671, lr_0 = 8.6912e-04
Loss = 2.6363e-01, PNorm = 34.4686, GNorm = 6.6098, lr_0 = 8.4642e-04
Validation rmse = 0.167207
Epoch 6
Loss = 2.7445e-01, PNorm = 34.5128, GNorm = 3.4056, lr_0 = 8.2431e-04
Validation rmse = 0.141271
Epoch 7
Loss = 1.4624e-01, PNorm = 34.5659, GNorm = 1.3542, lr_0 = 8.0066e-04
Loss = 2.2029e-01, PNorm = 34.6051, GNorm = 1.9639, lr_0 = 7.7975e-04
Validation rmse = 0.139632
Epoch 8
Loss = 2.5010e-01, PNorm = 34.6436, GNorm = 5.3934, lr_0 = 7.5938e-04
Loss = 2.8456e-01, PNorm = 34.6829, GNorm = 1.2194, lr_0 = 7.3955e-04
Validation rmse = 0.138676
Epoch 9
Loss = 1.8534e-01, PNorm = 34.7143, GNorm = 0.9728, lr_0 = 7.2023e-04
Validation rmse = 0.140530
Epoch 10
Loss = 1.4211e-01, PNorm = 34.7517, GNorm = 0.8235, lr_0 = 6.9956e-04
Loss = 1.8956e-01, PNorm = 34.7820, GNorm = 3.2330, lr_0 = 6.8129e-04
Validation rmse = 0.129611
Epoch 11
Loss = 1.6225e-01, PNorm = 34.8097, GNorm = 3.1357, lr_0 = 6.6350e-04
Validation rmse = 0.139121
Epoch 12
Loss = 1.1723e-01, PNorm = 34.8364, GNorm = 3.3097, lr_0 = 6.4617e-04
Loss = 1.7354e-01, PNorm = 34.8644, GNorm = 4.2721, lr_0 = 6.2929e-04
Validation rmse = 0.126242
Epoch 13
Loss = 1.4625e-01, PNorm = 34.8902, GNorm = 3.2678, lr_0 = 6.1123e-04
Validation rmse = 0.125487
Epoch 14
Loss = 1.6920e-01, PNorm = 34.9130, GNorm = 0.8123, lr_0 = 5.9527e-04
Loss = 1.5146e-01, PNorm = 34.9392, GNorm = 4.3582, lr_0 = 5.7972e-04
Validation rmse = 0.127273
Epoch 15
Loss = 1.6804e-01, PNorm = 34.9628, GNorm = 2.4949, lr_0 = 5.6458e-04
Loss = 1.4133e-01, PNorm = 34.9852, GNorm = 3.7850, lr_0 = 5.4983e-04
Loss = 5.5361e-02, PNorm = 34.9874, GNorm = 0.8903, lr_0 = 5.4838e-04
Validation rmse = 0.134562
Epoch 16
Loss = 1.5232e-01, PNorm = 35.0082, GNorm = 1.9826, lr_0 = 5.3406e-04
Validation rmse = 0.123422
Epoch 17
Loss = 1.2970e-01, PNorm = 35.0274, GNorm = 1.1094, lr_0 = 5.2011e-04
Loss = 1.3385e-01, PNorm = 35.0458, GNorm = 2.3585, lr_0 = 5.0652e-04
Validation rmse = 0.133000
Epoch 18
Loss = 1.4341e-01, PNorm = 35.0655, GNorm = 1.8284, lr_0 = 4.9329e-04
Validation rmse = 0.123204
Epoch 19
Loss = 1.2614e-01, PNorm = 35.0900, GNorm = 2.2315, lr_0 = 4.7914e-04
Loss = 1.2508e-01, PNorm = 35.1064, GNorm = 2.2559, lr_0 = 4.6662e-04
Validation rmse = 0.122463
Epoch 20
Loss = 1.1837e-01, PNorm = 35.1232, GNorm = 0.6800, lr_0 = 4.5443e-04
Validation rmse = 0.120805
Epoch 21
Loss = 9.7658e-02, PNorm = 35.1412, GNorm = 0.8348, lr_0 = 4.4256e-04
Loss = 1.0811e-01, PNorm = 35.1599, GNorm = 0.8989, lr_0 = 4.3101e-04
Validation rmse = 0.132183
Epoch 22
Loss = 1.1667e-01, PNorm = 35.1767, GNorm = 0.5164, lr_0 = 4.1864e-04
Loss = 1.2289e-01, PNorm = 35.1922, GNorm = 1.8860, lr_0 = 4.0770e-04
Validation rmse = 0.122173
Epoch 23
Loss = 1.1972e-01, PNorm = 35.2091, GNorm = 1.0855, lr_0 = 3.9705e-04
Validation rmse = 0.120484
Epoch 24
Loss = 1.1176e-01, PNorm = 35.2237, GNorm = 1.2238, lr_0 = 3.8668e-04
Loss = 1.0911e-01, PNorm = 35.2353, GNorm = 1.5206, lr_0 = 3.7658e-04
Validation rmse = 0.127320
Epoch 25
Loss = 1.2475e-01, PNorm = 35.2495, GNorm = 1.3726, lr_0 = 3.6675e-04
Validation rmse = 0.121719
Epoch 26
Loss = 1.2587e-01, PNorm = 35.2654, GNorm = 2.0548, lr_0 = 3.5622e-04
Loss = 1.0505e-01, PNorm = 35.2766, GNorm = 3.7709, lr_0 = 3.4692e-04
Validation rmse = 0.127741
Epoch 27
Loss = 1.2154e-01, PNorm = 35.2896, GNorm = 1.2310, lr_0 = 3.3786e-04
Validation rmse = 0.122900
Epoch 28
Loss = 9.2515e-02, PNorm = 35.3024, GNorm = 0.7502, lr_0 = 3.2903e-04
Loss = 1.0800e-01, PNorm = 35.3135, GNorm = 1.4149, lr_0 = 3.2044e-04
Validation rmse = 0.121317
Epoch 29
Loss = 1.1138e-01, PNorm = 35.3285, GNorm = 0.5991, lr_0 = 3.1125e-04
Loss = 1.0008e-01, PNorm = 35.3408, GNorm = 4.1396, lr_0 = 3.0312e-04
Validation rmse = 0.124790
Epoch 30
Loss = 1.0806e-01, PNorm = 35.3514, GNorm = 0.6679, lr_0 = 2.9520e-04
Validation rmse = 0.126186
Epoch 31
Loss = 1.1918e-01, PNorm = 35.3628, GNorm = 1.5504, lr_0 = 2.8749e-04
Loss = 1.0035e-01, PNorm = 35.3732, GNorm = 2.8359, lr_0 = 2.7998e-04
Validation rmse = 0.121674
Epoch 32
Loss = 9.7147e-02, PNorm = 35.3843, GNorm = 1.7566, lr_0 = 2.7195e-04
Validation rmse = 0.123005
Epoch 33
Loss = 1.0152e-01, PNorm = 35.3954, GNorm = 0.8291, lr_0 = 2.6484e-04
Loss = 9.9260e-02, PNorm = 35.4055, GNorm = 2.6907, lr_0 = 2.5793e-04
Validation rmse = 0.127715
Epoch 34
Loss = 9.7685e-02, PNorm = 35.4154, GNorm = 2.3181, lr_0 = 2.5119e-04
Validation rmse = 0.124554
Epoch 35
Loss = 7.4113e-02, PNorm = 35.4265, GNorm = 0.8615, lr_0 = 2.4398e-04
Loss = 1.0422e-01, PNorm = 35.4332, GNorm = 0.7527, lr_0 = 2.3761e-04
Validation rmse = 0.119907
Epoch 36
Loss = 9.1824e-02, PNorm = 35.4423, GNorm = 2.8699, lr_0 = 2.3140e-04
Loss = 1.0653e-01, PNorm = 35.4516, GNorm = 3.1775, lr_0 = 2.2536e-04
Validation rmse = 0.119804
Epoch 37
Loss = 1.0220e-01, PNorm = 35.4598, GNorm = 0.6311, lr_0 = 2.1947e-04
Validation rmse = 0.119640
Epoch 38
Loss = 1.0898e-01, PNorm = 35.4692, GNorm = 3.0231, lr_0 = 2.1317e-04
Loss = 8.8831e-02, PNorm = 35.4772, GNorm = 0.9681, lr_0 = 2.0761e-04
Validation rmse = 0.119160
Epoch 39
Loss = 8.7213e-02, PNorm = 35.4845, GNorm = 2.1263, lr_0 = 2.0218e-04
Validation rmse = 0.126476
Epoch 40
Loss = 8.7925e-02, PNorm = 35.4913, GNorm = 0.7153, lr_0 = 1.9690e-04
Loss = 9.2067e-02, PNorm = 35.4991, GNorm = 3.6843, lr_0 = 1.9176e-04
Validation rmse = 0.120458
Epoch 41
Loss = 9.7575e-02, PNorm = 35.5066, GNorm = 3.0776, lr_0 = 1.8626e-04
Validation rmse = 0.129534
Epoch 42
Loss = 1.1715e-01, PNorm = 35.5146, GNorm = 2.6771, lr_0 = 1.8139e-04
Loss = 9.7565e-02, PNorm = 35.5212, GNorm = 2.1313, lr_0 = 1.7666e-04
Validation rmse = 0.118554
Epoch 43
Loss = 1.0497e-01, PNorm = 35.5280, GNorm = 2.5860, lr_0 = 1.7204e-04
Validation rmse = 0.117897
Epoch 44
Loss = 7.4689e-02, PNorm = 35.5352, GNorm = 1.0946, lr_0 = 1.6710e-04
Loss = 8.4297e-02, PNorm = 35.5421, GNorm = 0.9642, lr_0 = 1.6274e-04
Validation rmse = 0.118732
Epoch 45
Loss = 7.7479e-02, PNorm = 35.5481, GNorm = 1.3483, lr_0 = 1.5849e-04
Loss = 9.2503e-02, PNorm = 35.5531, GNorm = 0.9883, lr_0 = 1.5435e-04
Validation rmse = 0.119265
Epoch 46
Loss = 9.8412e-02, PNorm = 35.5589, GNorm = 3.2182, lr_0 = 1.5032e-04
Validation rmse = 0.120635
Epoch 47
Loss = 8.8710e-02, PNorm = 35.5648, GNorm = 1.9535, lr_0 = 1.4601e-04
Loss = 8.4739e-02, PNorm = 35.5702, GNorm = 1.2982, lr_0 = 1.4219e-04
Validation rmse = 0.118872
Epoch 48
Loss = 8.6947e-02, PNorm = 35.5762, GNorm = 2.1484, lr_0 = 1.3848e-04
Validation rmse = 0.119019
Epoch 49
Loss = 8.4152e-02, PNorm = 35.5803, GNorm = 1.0753, lr_0 = 1.3486e-04
Loss = 8.8333e-02, PNorm = 35.5864, GNorm = 2.4313, lr_0 = 1.3134e-04
Validation rmse = 0.123246
Epoch 50
Loss = 8.8622e-02, PNorm = 35.5908, GNorm = 0.5127, lr_0 = 1.2791e-04
Validation rmse = 0.119826
Epoch 51
Loss = 7.2727e-02, PNorm = 35.5959, GNorm = 0.7168, lr_0 = 1.2424e-04
Loss = 8.8540e-02, PNorm = 35.5999, GNorm = 0.4696, lr_0 = 1.2099e-04
Validation rmse = 0.119737
Epoch 52
Loss = 8.3951e-02, PNorm = 35.6044, GNorm = 0.8409, lr_0 = 1.1783e-04
Loss = 8.5455e-02, PNorm = 35.6084, GNorm = 0.7904, lr_0 = 1.1475e-04
Validation rmse = 0.121624
Epoch 53
Loss = 8.4723e-02, PNorm = 35.6118, GNorm = 0.9862, lr_0 = 1.1176e-04
Validation rmse = 0.123185
Epoch 54
Loss = 9.6569e-02, PNorm = 35.6168, GNorm = 0.6685, lr_0 = 1.0855e-04
Loss = 8.5119e-02, PNorm = 35.6210, GNorm = 1.9171, lr_0 = 1.0572e-04
Validation rmse = 0.120518
Epoch 55
Loss = 8.3926e-02, PNorm = 35.6241, GNorm = 0.8924, lr_0 = 1.0295e-04
Validation rmse = 0.118784
Epoch 56
Loss = 8.1203e-02, PNorm = 35.6280, GNorm = 1.3413, lr_0 = 1.0027e-04
Loss = 8.6382e-02, PNorm = 35.6318, GNorm = 2.0979, lr_0 = 1.0000e-04
Validation rmse = 0.118665
Epoch 57
Loss = 8.2173e-02, PNorm = 35.6355, GNorm = 1.7975, lr_0 = 1.0000e-04
Validation rmse = 0.123598
Epoch 58
Loss = 8.5756e-02, PNorm = 35.6393, GNorm = 2.2084, lr_0 = 1.0000e-04
Loss = 8.3655e-02, PNorm = 35.6423, GNorm = 2.0490, lr_0 = 1.0000e-04
Validation rmse = 0.118508
Epoch 59
Loss = 8.0228e-02, PNorm = 35.6461, GNorm = 1.3514, lr_0 = 1.0000e-04
Loss = 9.1273e-02, PNorm = 35.6498, GNorm = 2.6484, lr_0 = 1.0000e-04
Loss = 7.2669e-02, PNorm = 35.6503, GNorm = 0.9590, lr_0 = 1.0000e-04
Validation rmse = 0.118193
Model 0 best validation rmse = 0.117897 on epoch 43
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.399113
Ensemble test rmse = 0.399113
1-fold cross validation
	Seed 0 ==> test rmse = 0.399113
Overall test rmse = 0.399113 +/- 0.000000
Elapsed time = 0:00:40
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/MeTHF_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/MeTHF_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/MeTHF_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 973 | train size = 778 | val size = 195 | test size = 59
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.7844e-01, PNorm = 34.0182, GNorm = 5.1238, lr_0 = 4.3000e-04
Validation rmse = 0.308439
Epoch 1
Loss = 6.6470e-01, PNorm = 34.0559, GNorm = 2.1101, lr_0 = 7.6000e-04
Loss = 5.3316e-01, PNorm = 34.1295, GNorm = 4.8212, lr_0 = 9.9472e-04
Validation rmse = 0.258635
Epoch 2
Loss = 4.6233e-01, PNorm = 34.2097, GNorm = 4.1415, lr_0 = 9.6874e-04
Validation rmse = 0.216783
Epoch 3
Loss = 3.1188e-01, PNorm = 34.2791, GNorm = 4.3001, lr_0 = 9.4094e-04
Loss = 3.8690e-01, PNorm = 34.3342, GNorm = 7.2130, lr_0 = 9.1637e-04
Validation rmse = 0.220501
Epoch 4
Loss = 3.7849e-01, PNorm = 34.3865, GNorm = 3.2691, lr_0 = 8.9243e-04
Validation rmse = 0.198205
Epoch 5
Loss = 2.8595e-01, PNorm = 34.4388, GNorm = 5.3263, lr_0 = 8.6682e-04
Loss = 2.9500e-01, PNorm = 34.4891, GNorm = 1.1215, lr_0 = 8.4418e-04
Validation rmse = 0.179412
Epoch 6
Loss = 2.1252e-01, PNorm = 34.5303, GNorm = 2.3354, lr_0 = 8.2213e-04
Validation rmse = 0.173705
Epoch 7
Loss = 1.7951e-01, PNorm = 34.5831, GNorm = 1.2135, lr_0 = 7.9854e-04
Loss = 1.8846e-01, PNorm = 34.6205, GNorm = 1.9771, lr_0 = 7.7769e-04
Validation rmse = 0.151086
Epoch 8
Loss = 1.5249e-01, PNorm = 34.6547, GNorm = 1.0967, lr_0 = 7.5737e-04
Loss = 1.6408e-01, PNorm = 34.6893, GNorm = 0.9926, lr_0 = 7.3759e-04
Validation rmse = 0.187344
Epoch 9
Loss = 1.7998e-01, PNorm = 34.7172, GNorm = 6.5529, lr_0 = 7.1833e-04
Validation rmse = 0.182592
Epoch 10
Loss = 2.1776e-01, PNorm = 34.7576, GNorm = 4.5050, lr_0 = 6.9772e-04
Loss = 1.9077e-01, PNorm = 34.7904, GNorm = 2.1991, lr_0 = 6.7949e-04
Validation rmse = 0.146650
Epoch 11
Loss = 1.2609e-01, PNorm = 34.8197, GNorm = 2.4325, lr_0 = 6.6174e-04
Validation rmse = 0.145406
Epoch 12
Loss = 1.4679e-01, PNorm = 34.8456, GNorm = 2.3930, lr_0 = 6.4276e-04
Loss = 1.4592e-01, PNorm = 34.8677, GNorm = 4.2969, lr_0 = 6.2597e-04
Validation rmse = 0.151305
Epoch 13
Loss = 1.4055e-01, PNorm = 34.8897, GNorm = 1.7279, lr_0 = 6.0962e-04
Validation rmse = 0.143241
Epoch 14
Loss = 1.2071e-01, PNorm = 34.9132, GNorm = 3.4940, lr_0 = 5.9213e-04
Loss = 1.2300e-01, PNorm = 34.9365, GNorm = 1.5686, lr_0 = 5.7666e-04
Validation rmse = 0.144171
Epoch 15
Loss = 1.2741e-01, PNorm = 34.9515, GNorm = 4.3359, lr_0 = 5.6160e-04
Validation rmse = 0.139270
Epoch 16
Loss = 1.3986e-01, PNorm = 34.9717, GNorm = 2.0027, lr_0 = 5.4548e-04
Loss = 1.0384e-01, PNorm = 34.9904, GNorm = 1.8771, lr_0 = 5.3124e-04
Validation rmse = 0.141749
Epoch 17
Loss = 1.2439e-01, PNorm = 35.0034, GNorm = 1.1198, lr_0 = 5.1736e-04
Loss = 1.0130e-01, PNorm = 35.0230, GNorm = 3.0529, lr_0 = 5.0385e-04
Validation rmse = 0.146894
Epoch 18
Loss = 1.0118e-01, PNorm = 35.0362, GNorm = 2.2501, lr_0 = 4.9069e-04
Validation rmse = 0.146593
Epoch 19
Loss = 8.7666e-02, PNorm = 35.0547, GNorm = 0.7139, lr_0 = 4.7661e-04
Loss = 1.0547e-01, PNorm = 35.0693, GNorm = 0.5979, lr_0 = 4.6416e-04
Validation rmse = 0.138907
Epoch 20
Loss = 9.7685e-02, PNorm = 35.0846, GNorm = 1.5870, lr_0 = 4.5204e-04
Validation rmse = 0.141763
Epoch 21
Loss = 1.0057e-01, PNorm = 35.0992, GNorm = 2.1320, lr_0 = 4.3906e-04
Loss = 9.7201e-02, PNorm = 35.1132, GNorm = 3.7669, lr_0 = 4.2760e-04
Validation rmse = 0.151508
Epoch 22
Loss = 1.0716e-01, PNorm = 35.1275, GNorm = 1.6864, lr_0 = 4.1643e-04
Validation rmse = 0.140994
Epoch 23
Loss = 8.0953e-02, PNorm = 35.1423, GNorm = 2.8714, lr_0 = 4.0448e-04
Loss = 1.1554e-01, PNorm = 35.1563, GNorm = 2.7483, lr_0 = 3.9391e-04
Validation rmse = 0.144759
Epoch 24
Loss = 8.5859e-02, PNorm = 35.1676, GNorm = 0.6891, lr_0 = 3.8363e-04
Validation rmse = 0.140953
Epoch 25
Loss = 1.1293e-01, PNorm = 35.1809, GNorm = 1.5121, lr_0 = 3.7361e-04
Loss = 9.1714e-02, PNorm = 35.1938, GNorm = 1.4942, lr_0 = 3.6385e-04
Validation rmse = 0.138782
Epoch 26
Loss = 9.4853e-02, PNorm = 35.2072, GNorm = 0.7018, lr_0 = 3.5341e-04
Loss = 9.1978e-02, PNorm = 35.2202, GNorm = 1.2742, lr_0 = 3.4418e-04
Validation rmse = 0.154087
Epoch 27
Loss = 1.0034e-01, PNorm = 35.2337, GNorm = 0.6972, lr_0 = 3.3519e-04
Validation rmse = 0.139670
Epoch 28
Loss = 9.0752e-02, PNorm = 35.2451, GNorm = 0.4804, lr_0 = 3.2557e-04
Loss = 8.1550e-02, PNorm = 35.2548, GNorm = 1.4145, lr_0 = 3.1707e-04
Validation rmse = 0.141289
Epoch 29
Loss = 9.4451e-02, PNorm = 35.2656, GNorm = 2.2714, lr_0 = 3.0878e-04
Validation rmse = 0.141388
Epoch 30
Loss = 1.0205e-01, PNorm = 35.2773, GNorm = 0.8958, lr_0 = 2.9992e-04
Loss = 8.6541e-02, PNorm = 35.2889, GNorm = 2.4895, lr_0 = 2.9209e-04
Validation rmse = 0.139133
Epoch 31
Loss = 7.3500e-02, PNorm = 35.2984, GNorm = 1.2566, lr_0 = 2.8446e-04
Validation rmse = 0.141254
Epoch 32
Loss = 6.1207e-02, PNorm = 35.3101, GNorm = 0.4373, lr_0 = 2.7630e-04
Loss = 8.4046e-02, PNorm = 35.3190, GNorm = 1.0525, lr_0 = 2.6908e-04
Validation rmse = 0.140221
Epoch 33
Loss = 7.2724e-02, PNorm = 35.3292, GNorm = 1.1540, lr_0 = 2.6205e-04
Validation rmse = 0.140925
Epoch 34
Loss = 5.6940e-02, PNorm = 35.3383, GNorm = 1.5385, lr_0 = 2.5521e-04
Loss = 8.4338e-02, PNorm = 35.3471, GNorm = 0.4997, lr_0 = 2.4854e-04
Validation rmse = 0.139840
Epoch 35
Loss = 7.0454e-02, PNorm = 35.3570, GNorm = 1.9737, lr_0 = 2.4141e-04
Loss = 8.2477e-02, PNorm = 35.3654, GNorm = 1.0067, lr_0 = 2.3511e-04
Validation rmse = 0.137517
Epoch 36
Loss = 7.1124e-02, PNorm = 35.3736, GNorm = 1.5712, lr_0 = 2.2897e-04
Validation rmse = 0.142889
Epoch 37
Loss = 8.1045e-02, PNorm = 35.3828, GNorm = 2.6271, lr_0 = 2.2240e-04
Loss = 7.1217e-02, PNorm = 35.3915, GNorm = 0.5368, lr_0 = 2.1659e-04
Validation rmse = 0.141537
Epoch 38
Loss = 7.6261e-02, PNorm = 35.3992, GNorm = 0.8230, lr_0 = 2.1093e-04
Validation rmse = 0.137281
Epoch 39
Loss = 6.4938e-02, PNorm = 35.4073, GNorm = 1.2796, lr_0 = 2.0488e-04
Loss = 7.6046e-02, PNorm = 35.4146, GNorm = 1.0498, lr_0 = 1.9953e-04
Validation rmse = 0.139474
Epoch 40
Loss = 7.5432e-02, PNorm = 35.4219, GNorm = 0.8945, lr_0 = 1.9431e-04
Validation rmse = 0.140250
Epoch 41
Loss = 7.8345e-02, PNorm = 35.4289, GNorm = 0.5994, lr_0 = 1.8874e-04
Loss = 6.8008e-02, PNorm = 35.4345, GNorm = 0.9481, lr_0 = 1.8381e-04
Validation rmse = 0.139093
Epoch 42
Loss = 7.2619e-02, PNorm = 35.4423, GNorm = 0.6905, lr_0 = 1.7901e-04
Validation rmse = 0.140658
Epoch 43
Loss = 6.2169e-02, PNorm = 35.4490, GNorm = 2.0917, lr_0 = 1.7433e-04
Loss = 6.9339e-02, PNorm = 35.4551, GNorm = 1.0766, lr_0 = 1.6978e-04
Validation rmse = 0.139479
Epoch 44
Loss = 6.7391e-02, PNorm = 35.4617, GNorm = 0.9339, lr_0 = 1.6491e-04
Loss = 7.6578e-02, PNorm = 35.4673, GNorm = 1.6225, lr_0 = 1.6060e-04
Validation rmse = 0.139713
Epoch 45
Loss = 7.7999e-02, PNorm = 35.4726, GNorm = 0.9251, lr_0 = 1.5641e-04
Validation rmse = 0.137804
Epoch 46
Loss = 5.8330e-02, PNorm = 35.4791, GNorm = 0.5989, lr_0 = 1.5192e-04
Loss = 8.1396e-02, PNorm = 35.4845, GNorm = 0.6080, lr_0 = 1.4795e-04
Validation rmse = 0.139644
Epoch 47
Loss = 7.0662e-02, PNorm = 35.4899, GNorm = 1.4530, lr_0 = 1.4409e-04
Validation rmse = 0.140813
Epoch 48
Loss = 5.9037e-02, PNorm = 35.4957, GNorm = 0.8164, lr_0 = 1.3995e-04
Loss = 8.0813e-02, PNorm = 35.5004, GNorm = 1.3426, lr_0 = 1.3630e-04
Validation rmse = 0.138297
Epoch 49
Loss = 7.6472e-02, PNorm = 35.5053, GNorm = 0.5969, lr_0 = 1.3274e-04
Validation rmse = 0.138265
Epoch 50
Loss = 8.0495e-02, PNorm = 35.5102, GNorm = 0.4977, lr_0 = 1.2927e-04
Loss = 6.3926e-02, PNorm = 35.5149, GNorm = 2.1703, lr_0 = 1.2589e-04
Validation rmse = 0.139072
Epoch 51
Loss = 6.3409e-02, PNorm = 35.5198, GNorm = 0.5319, lr_0 = 1.2228e-04
Validation rmse = 0.138513
Epoch 52
Loss = 6.6730e-02, PNorm = 35.5239, GNorm = 0.9087, lr_0 = 1.1909e-04
Loss = 6.9183e-02, PNorm = 35.5283, GNorm = 0.6613, lr_0 = 1.1598e-04
Validation rmse = 0.138490
Epoch 53
Loss = 7.0419e-02, PNorm = 35.5324, GNorm = 0.7827, lr_0 = 1.1265e-04
Loss = 6.7397e-02, PNorm = 35.5361, GNorm = 3.8426, lr_0 = 1.0971e-04
Validation rmse = 0.139637
Epoch 54
Loss = 6.3998e-02, PNorm = 35.5395, GNorm = 0.7818, lr_0 = 1.0684e-04
Validation rmse = 0.139864
Epoch 55
Loss = 5.6223e-02, PNorm = 35.5436, GNorm = 0.7956, lr_0 = 1.0377e-04
Loss = 6.8323e-02, PNorm = 35.5465, GNorm = 1.5263, lr_0 = 1.0106e-04
Validation rmse = 0.137658
Epoch 56
Loss = 5.9476e-02, PNorm = 35.5509, GNorm = 0.8865, lr_0 = 1.0000e-04
Validation rmse = 0.140203
Epoch 57
Loss = 6.6340e-02, PNorm = 35.5547, GNorm = 1.2037, lr_0 = 1.0000e-04
Loss = 6.4772e-02, PNorm = 35.5583, GNorm = 0.7467, lr_0 = 1.0000e-04
Validation rmse = 0.137996
Epoch 58
Loss = 6.3868e-02, PNorm = 35.5620, GNorm = 0.6665, lr_0 = 1.0000e-04
Validation rmse = 0.138007
Epoch 59
Loss = 4.6777e-02, PNorm = 35.5655, GNorm = 2.2740, lr_0 = 1.0000e-04
Loss = 6.4741e-02, PNorm = 35.5688, GNorm = 0.6284, lr_0 = 1.0000e-04
Validation rmse = 0.138862
Model 0 best validation rmse = 0.137281 on epoch 38
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.244236
Ensemble test rmse = 0.244236
1-fold cross validation
	Seed 0 ==> test rmse = 0.244236
Overall test rmse = 0.244236 +/- 0.000000
Elapsed time = 0:00:41
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/DMF_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/DMF_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/DMF_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 934 | train size = 747 | val size = 187 | test size = 98
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1846e-01, PNorm = 34.0169, GNorm = 4.4513, lr_0 = 4.5357e-04
Validation rmse = 0.317788
Epoch 1
Loss = 6.8465e-01, PNorm = 34.0567, GNorm = 3.8671, lr_0 = 8.0714e-04
Validation rmse = 0.286314
Epoch 2
Loss = 7.0183e-01, PNorm = 34.1111, GNorm = 6.8028, lr_0 = 9.8872e-04
Loss = 5.0396e-01, PNorm = 34.1819, GNorm = 8.3375, lr_0 = 9.6108e-04
Validation rmse = 0.240348
Epoch 3
Loss = 3.7533e-01, PNorm = 34.2486, GNorm = 1.4161, lr_0 = 9.3421e-04
Validation rmse = 0.230508
Epoch 4
Loss = 2.8555e-01, PNorm = 34.3174, GNorm = 6.1392, lr_0 = 9.0809e-04
Loss = 3.4793e-01, PNorm = 34.3829, GNorm = 2.3509, lr_0 = 8.8270e-04
Validation rmse = 0.194878
Epoch 5
Loss = 2.6385e-01, PNorm = 34.4484, GNorm = 0.7204, lr_0 = 8.5802e-04
Validation rmse = 0.178318
Epoch 6
Loss = 2.1672e-01, PNorm = 34.5067, GNorm = 2.2115, lr_0 = 8.3403e-04
Loss = 1.9851e-01, PNorm = 34.5590, GNorm = 1.7547, lr_0 = 8.1071e-04
Validation rmse = 0.170791
Epoch 7
Loss = 2.4177e-01, PNorm = 34.6023, GNorm = 8.5956, lr_0 = 7.8805e-04
Validation rmse = 0.198103
Epoch 8
Loss = 2.5356e-01, PNorm = 34.6453, GNorm = 6.1821, lr_0 = 7.6601e-04
Loss = 2.2997e-01, PNorm = 34.6869, GNorm = 2.6910, lr_0 = 7.4460e-04
Validation rmse = 0.161685
Epoch 9
Loss = 1.7937e-01, PNorm = 34.7269, GNorm = 2.2676, lr_0 = 7.2378e-04
Validation rmse = 0.172630
Epoch 10
Loss = 1.1007e-01, PNorm = 34.7609, GNorm = 2.7083, lr_0 = 7.0354e-04
Loss = 1.5824e-01, PNorm = 34.7913, GNorm = 2.6266, lr_0 = 6.8387e-04
Validation rmse = 0.170043
Epoch 11
Loss = 1.5956e-01, PNorm = 34.8145, GNorm = 3.2746, lr_0 = 6.6475e-04
Validation rmse = 0.152640
Epoch 12
Loss = 1.9203e-01, PNorm = 34.8425, GNorm = 1.0187, lr_0 = 6.4617e-04
Loss = 1.2591e-01, PNorm = 34.8593, GNorm = 2.2644, lr_0 = 6.2810e-04
Validation rmse = 0.159020
Epoch 13
Loss = 1.2127e-01, PNorm = 34.8832, GNorm = 1.4151, lr_0 = 6.1054e-04
Validation rmse = 0.168177
Epoch 14
Loss = 1.2643e-01, PNorm = 34.9008, GNorm = 3.9175, lr_0 = 5.9347e-04
Loss = 1.3041e-01, PNorm = 34.9177, GNorm = 1.0918, lr_0 = 5.7688e-04
Validation rmse = 0.166462
Epoch 15
Loss = 1.2494e-01, PNorm = 34.9365, GNorm = 1.1421, lr_0 = 5.6075e-04
Validation rmse = 0.147892
Epoch 16
Loss = 9.0272e-02, PNorm = 34.9586, GNorm = 0.7353, lr_0 = 5.4507e-04
Loss = 1.2209e-01, PNorm = 34.9762, GNorm = 3.5114, lr_0 = 5.2983e-04
Validation rmse = 0.156284
Epoch 17
Loss = 1.0924e-01, PNorm = 34.9923, GNorm = 0.6531, lr_0 = 5.1356e-04
Validation rmse = 0.155422
Epoch 18
Loss = 1.1719e-01, PNorm = 35.0078, GNorm = 0.5885, lr_0 = 4.9920e-04
Loss = 1.1374e-01, PNorm = 35.0256, GNorm = 1.4164, lr_0 = 4.8524e-04
Validation rmse = 0.145608
Epoch 19
Loss = 1.1176e-01, PNorm = 35.0373, GNorm = 2.4118, lr_0 = 4.7168e-04
Validation rmse = 0.146029
Epoch 20
Loss = 8.5279e-02, PNorm = 35.0502, GNorm = 1.4390, lr_0 = 4.5849e-04
Loss = 1.0528e-01, PNorm = 35.0631, GNorm = 0.7011, lr_0 = 4.4567e-04
Validation rmse = 0.148928
Epoch 21
Loss = 9.4062e-02, PNorm = 35.0778, GNorm = 2.0195, lr_0 = 4.3321e-04
Validation rmse = 0.168299
Epoch 22
Loss = 1.2249e-01, PNorm = 35.0922, GNorm = 2.8941, lr_0 = 4.2110e-04
Loss = 9.4087e-02, PNorm = 35.1040, GNorm = 0.8216, lr_0 = 4.0933e-04
Validation rmse = 0.146787
Epoch 23
Loss = 9.3937e-02, PNorm = 35.1161, GNorm = 1.7891, lr_0 = 3.9788e-04
Validation rmse = 0.149419
Epoch 24
Loss = 9.3941e-02, PNorm = 35.1306, GNorm = 1.6919, lr_0 = 3.8676e-04
Loss = 9.5407e-02, PNorm = 35.1407, GNorm = 0.5313, lr_0 = 3.7594e-04
Validation rmse = 0.144991
Epoch 25
Loss = 8.7892e-02, PNorm = 35.1509, GNorm = 1.8528, lr_0 = 3.6543e-04
Validation rmse = 0.149005
Epoch 26
Loss = 1.0087e-01, PNorm = 35.1615, GNorm = 2.5272, lr_0 = 3.5522e-04
Loss = 9.0459e-02, PNorm = 35.1733, GNorm = 0.9745, lr_0 = 3.4528e-04
Validation rmse = 0.147664
Epoch 27
Loss = 8.8373e-02, PNorm = 35.1832, GNorm = 0.9531, lr_0 = 3.3563e-04
Validation rmse = 0.145604
Epoch 28
Loss = 8.2830e-02, PNorm = 35.1923, GNorm = 0.6255, lr_0 = 3.2625e-04
Loss = 8.8840e-02, PNorm = 35.2046, GNorm = 0.9363, lr_0 = 3.1713e-04
Validation rmse = 0.149655
Epoch 29
Loss = 8.8036e-02, PNorm = 35.2132, GNorm = 0.8001, lr_0 = 3.0826e-04
Validation rmse = 0.151594
Epoch 30
Loss = 1.0067e-01, PNorm = 35.2222, GNorm = 0.5565, lr_0 = 2.9964e-04
Loss = 9.7712e-02, PNorm = 35.2321, GNorm = 0.4731, lr_0 = 2.9126e-04
Validation rmse = 0.146097
Epoch 31
Loss = 9.1612e-02, PNorm = 35.2421, GNorm = 1.7518, lr_0 = 2.8312e-04
Validation rmse = 0.154664
Epoch 32
Loss = 1.2152e-01, PNorm = 35.2515, GNorm = 2.0846, lr_0 = 2.7520e-04
Loss = 8.6458e-02, PNorm = 35.2605, GNorm = 1.6745, lr_0 = 2.6751e-04
Validation rmse = 0.147631
Epoch 33
Loss = 9.7629e-02, PNorm = 35.2699, GNorm = 5.1712, lr_0 = 2.6003e-04
Validation rmse = 0.151105
Epoch 34
Loss = 9.0206e-02, PNorm = 35.2801, GNorm = 2.6792, lr_0 = 2.5204e-04
Loss = 9.2031e-02, PNorm = 35.2893, GNorm = 2.2538, lr_0 = 2.4500e-04
Validation rmse = 0.147185
Epoch 35
Loss = 8.2896e-02, PNorm = 35.2953, GNorm = 1.2653, lr_0 = 2.3815e-04
Validation rmse = 0.146996
Epoch 36
Loss = 6.0471e-02, PNorm = 35.3017, GNorm = 0.5857, lr_0 = 2.3149e-04
Loss = 8.8624e-02, PNorm = 35.3102, GNorm = 0.6543, lr_0 = 2.2502e-04
Validation rmse = 0.148073
Epoch 37
Loss = 8.3213e-02, PNorm = 35.3158, GNorm = 1.5500, lr_0 = 2.1873e-04
Validation rmse = 0.147529
Epoch 38
Loss = 8.9069e-02, PNorm = 35.3225, GNorm = 1.5961, lr_0 = 2.1261e-04
Loss = 8.2354e-02, PNorm = 35.3305, GNorm = 1.7484, lr_0 = 2.0667e-04
Validation rmse = 0.151224
Epoch 39
Loss = 7.9016e-02, PNorm = 35.3359, GNorm = 1.8391, lr_0 = 2.0089e-04
Validation rmse = 0.145682
Epoch 40
Loss = 8.1818e-02, PNorm = 35.3425, GNorm = 0.5287, lr_0 = 1.9527e-04
Loss = 8.0383e-02, PNorm = 35.3494, GNorm = 2.1153, lr_0 = 1.8981e-04
Validation rmse = 0.154102
Epoch 41
Loss = 8.8631e-02, PNorm = 35.3553, GNorm = 0.7679, lr_0 = 1.8451e-04
Validation rmse = 0.145766
Epoch 42
Loss = 6.2268e-02, PNorm = 35.3602, GNorm = 2.1194, lr_0 = 1.7935e-04
Loss = 8.1164e-02, PNorm = 35.3653, GNorm = 1.9439, lr_0 = 1.7433e-04
Validation rmse = 0.146967
Epoch 43
Loss = 8.0357e-02, PNorm = 35.3713, GNorm = 0.6811, lr_0 = 1.6946e-04
Validation rmse = 0.148941
Epoch 44
Loss = 8.2313e-02, PNorm = 35.3775, GNorm = 0.8563, lr_0 = 1.6472e-04
Loss = 7.4550e-02, PNorm = 35.3831, GNorm = 2.1641, lr_0 = 1.6012e-04
Validation rmse = 0.146136
Epoch 45
Loss = 7.6727e-02, PNorm = 35.3876, GNorm = 0.9222, lr_0 = 1.5564e-04
Validation rmse = 0.146288
Epoch 46
Loss = 6.1031e-02, PNorm = 35.3920, GNorm = 1.8866, lr_0 = 1.5129e-04
Loss = 8.1900e-02, PNorm = 35.3967, GNorm = 0.5535, lr_0 = 1.4706e-04
Validation rmse = 0.148043
Epoch 47
Loss = 7.5964e-02, PNorm = 35.4017, GNorm = 1.4204, lr_0 = 1.4295e-04
Validation rmse = 0.145509
Epoch 48
Loss = 6.2752e-02, PNorm = 35.4064, GNorm = 0.5436, lr_0 = 1.3895e-04
Loss = 7.7378e-02, PNorm = 35.4100, GNorm = 0.8903, lr_0 = 1.3506e-04
Validation rmse = 0.146317
Epoch 49
Loss = 7.8189e-02, PNorm = 35.4158, GNorm = 1.3452, lr_0 = 1.3129e-04
Validation rmse = 0.146225
Epoch 50
Loss = 7.5598e-02, PNorm = 35.4203, GNorm = 0.8968, lr_0 = 1.2762e-04
Loss = 7.4521e-02, PNorm = 35.4235, GNorm = 0.7948, lr_0 = 1.2405e-04
Validation rmse = 0.145659
Epoch 51
Loss = 7.1610e-02, PNorm = 35.4280, GNorm = 0.7968, lr_0 = 1.2024e-04
Validation rmse = 0.145539
Epoch 52
Loss = 6.8102e-02, PNorm = 35.4321, GNorm = 0.5919, lr_0 = 1.1688e-04
Loss = 7.1743e-02, PNorm = 35.4358, GNorm = 0.5300, lr_0 = 1.1361e-04
Validation rmse = 0.146932
Epoch 53
Loss = 6.4675e-02, PNorm = 35.4397, GNorm = 1.5346, lr_0 = 1.1043e-04
Validation rmse = 0.149121
Epoch 54
Loss = 7.7052e-02, PNorm = 35.4433, GNorm = 0.9158, lr_0 = 1.0735e-04
Loss = 7.0331e-02, PNorm = 35.4477, GNorm = 0.4365, lr_0 = 1.0435e-04
Validation rmse = 0.147499
Epoch 55
Loss = 7.2029e-02, PNorm = 35.4510, GNorm = 1.1243, lr_0 = 1.0143e-04
Validation rmse = 0.148640
Epoch 56
Loss = 7.1445e-02, PNorm = 35.4541, GNorm = 1.4961, lr_0 = 1.0000e-04
Loss = 7.3288e-02, PNorm = 35.4577, GNorm = 1.1584, lr_0 = 1.0000e-04
Validation rmse = 0.153462
Epoch 57
Loss = 7.4103e-02, PNorm = 35.4606, GNorm = 0.8125, lr_0 = 1.0000e-04
Validation rmse = 0.150770
Epoch 58
Loss = 9.1055e-02, PNorm = 35.4639, GNorm = 0.8158, lr_0 = 1.0000e-04
Loss = 6.2428e-02, PNorm = 35.4669, GNorm = 1.5614, lr_0 = 1.0000e-04
Validation rmse = 0.146710
Epoch 59
Loss = 7.3618e-02, PNorm = 35.4706, GNorm = 1.0893, lr_0 = 1.0000e-04
Validation rmse = 0.145879
Model 0 best validation rmse = 0.144991 on epoch 24
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.226962
Ensemble test rmse = 0.226962
1-fold cross validation
	Seed 0 ==> test rmse = 0.226962
Overall test rmse = 0.226962 +/- 0.000000
Elapsed time = 0:00:37
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/EtOAc_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/EtOAc_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/EtOAc_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 967 | train size = 773 | val size = 194 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.9531e-01, PNorm = 34.0204, GNorm = 1.1346, lr_0 = 4.3000e-04
Validation rmse = 0.295603
Epoch 1
Loss = 6.0829e-01, PNorm = 34.0578, GNorm = 1.8101, lr_0 = 7.6000e-04
Loss = 6.5184e-01, PNorm = 34.1278, GNorm = 17.9069, lr_0 = 9.9472e-04
Loss = 7.4671e-01, PNorm = 34.1331, GNorm = 12.1541, lr_0 = 9.9209e-04
Validation rmse = 0.304016
Epoch 2
Loss = 5.0684e-01, PNorm = 34.1995, GNorm = 6.2351, lr_0 = 9.6618e-04
Validation rmse = 0.227574
Epoch 3
Loss = 4.0496e-01, PNorm = 34.2654, GNorm = 6.0075, lr_0 = 9.4094e-04
Loss = 3.6705e-01, PNorm = 34.3231, GNorm = 2.6052, lr_0 = 9.1637e-04
Validation rmse = 0.217909
Epoch 4
Loss = 3.2931e-01, PNorm = 34.3824, GNorm = 5.2687, lr_0 = 8.9007e-04
Validation rmse = 0.200535
Epoch 5
Loss = 2.5703e-01, PNorm = 34.4247, GNorm = 2.2400, lr_0 = 8.6682e-04
Loss = 2.2258e-01, PNorm = 34.4674, GNorm = 3.6833, lr_0 = 8.4418e-04
Validation rmse = 0.183474
Epoch 6
Loss = 2.4784e-01, PNorm = 34.5150, GNorm = 0.9283, lr_0 = 8.1996e-04
Validation rmse = 0.188469
Epoch 7
Loss = 2.4150e-01, PNorm = 34.5536, GNorm = 7.3195, lr_0 = 7.9854e-04
Loss = 1.8856e-01, PNorm = 34.5887, GNorm = 1.3376, lr_0 = 7.7769e-04
Validation rmse = 0.234810
Epoch 8
Loss = 2.3704e-01, PNorm = 34.6283, GNorm = 3.3628, lr_0 = 7.5537e-04
Validation rmse = 0.195766
Epoch 9
Loss = 1.8396e-01, PNorm = 34.6704, GNorm = 2.8114, lr_0 = 7.3564e-04
Loss = 1.7046e-01, PNorm = 34.7077, GNorm = 2.2222, lr_0 = 7.1643e-04
Validation rmse = 0.163484
Epoch 10
Loss = 1.3859e-01, PNorm = 34.7449, GNorm = 0.9435, lr_0 = 6.9587e-04
Loss = 1.5334e-01, PNorm = 34.7751, GNorm = 2.1305, lr_0 = 6.7770e-04
Validation rmse = 0.161754
Epoch 11
Loss = 1.3651e-01, PNorm = 34.8042, GNorm = 0.4431, lr_0 = 6.5999e-04
Validation rmse = 0.150535
Epoch 12
Loss = 1.3987e-01, PNorm = 34.8333, GNorm = 0.8775, lr_0 = 6.4106e-04
Loss = 1.3954e-01, PNorm = 34.8551, GNorm = 0.9462, lr_0 = 6.2431e-04
Loss = 1.1183e-01, PNorm = 34.8577, GNorm = 2.7025, lr_0 = 6.2266e-04
Validation rmse = 0.167656
Epoch 13
Loss = 1.5155e-01, PNorm = 34.8839, GNorm = 0.8346, lr_0 = 6.0640e-04
Validation rmse = 0.161913
Epoch 14
Loss = 1.1977e-01, PNorm = 34.9037, GNorm = 3.6017, lr_0 = 5.9056e-04
Loss = 1.1574e-01, PNorm = 34.9246, GNorm = 0.5883, lr_0 = 5.7514e-04
Validation rmse = 0.156335
Epoch 15
Loss = 1.1067e-01, PNorm = 34.9410, GNorm = 0.9139, lr_0 = 5.5863e-04
Validation rmse = 0.159796
Epoch 16
Loss = 1.1049e-01, PNorm = 34.9597, GNorm = 1.2816, lr_0 = 5.4404e-04
Loss = 1.3388e-01, PNorm = 34.9755, GNorm = 4.0570, lr_0 = 5.2983e-04
Validation rmse = 0.154687
Epoch 17
Loss = 1.3264e-01, PNorm = 34.9920, GNorm = 2.9745, lr_0 = 5.1463e-04
Validation rmse = 0.146182
Epoch 18
Loss = 1.4715e-01, PNorm = 35.0104, GNorm = 2.5816, lr_0 = 5.0119e-04
Loss = 1.0616e-01, PNorm = 35.0282, GNorm = 0.5676, lr_0 = 4.8810e-04
Validation rmse = 0.147752
Epoch 19
Loss = 1.0304e-01, PNorm = 35.0461, GNorm = 2.6397, lr_0 = 4.7409e-04
Validation rmse = 0.145164
Epoch 20
Loss = 1.3354e-01, PNorm = 35.0591, GNorm = 3.2388, lr_0 = 4.6171e-04
Loss = 1.0015e-01, PNorm = 35.0759, GNorm = 1.4329, lr_0 = 4.4965e-04
Validation rmse = 0.146783
Epoch 21
Loss = 1.0337e-01, PNorm = 35.0905, GNorm = 2.2011, lr_0 = 4.3675e-04
Loss = 9.3637e-02, PNorm = 35.1018, GNorm = 2.8251, lr_0 = 4.2534e-04
Validation rmse = 0.146375
Epoch 22
Loss = 8.9692e-02, PNorm = 35.1139, GNorm = 1.7133, lr_0 = 4.1423e-04
Validation rmse = 0.146106
Epoch 23
Loss = 8.6795e-02, PNorm = 35.1271, GNorm = 0.6005, lr_0 = 4.0234e-04
Loss = 9.8585e-02, PNorm = 35.1396, GNorm = 0.6366, lr_0 = 3.9184e-04
Validation rmse = 0.166216
Epoch 24
Loss = 9.1991e-02, PNorm = 35.1506, GNorm = 1.7783, lr_0 = 3.8160e-04
Validation rmse = 0.143199
Epoch 25
Loss = 8.3135e-02, PNorm = 35.1644, GNorm = 1.6198, lr_0 = 3.7065e-04
Loss = 1.0278e-01, PNorm = 35.1751, GNorm = 1.0860, lr_0 = 3.6097e-04
Validation rmse = 0.147242
Epoch 26
Loss = 9.6567e-02, PNorm = 35.1853, GNorm = 2.0043, lr_0 = 3.5061e-04
Validation rmse = 0.146290
Epoch 27
Loss = 1.0240e-01, PNorm = 35.1958, GNorm = 1.0533, lr_0 = 3.4145e-04
Loss = 8.3450e-02, PNorm = 35.2061, GNorm = 0.7484, lr_0 = 3.3254e-04
Validation rmse = 0.146372
Epoch 28
Loss = 8.7577e-02, PNorm = 35.2168, GNorm = 0.8521, lr_0 = 3.2299e-04
Validation rmse = 0.150004
Epoch 29
Loss = 9.5479e-02, PNorm = 35.2269, GNorm = 0.8048, lr_0 = 3.1456e-04
Loss = 8.7199e-02, PNorm = 35.2383, GNorm = 3.7451, lr_0 = 3.0634e-04
Validation rmse = 0.145343
Epoch 30
Loss = 9.5941e-02, PNorm = 35.2468, GNorm = 3.1871, lr_0 = 2.9755e-04
Validation rmse = 0.144973
Epoch 31
Loss = 6.8514e-02, PNorm = 35.2559, GNorm = 3.1416, lr_0 = 2.8978e-04
Loss = 9.3760e-02, PNorm = 35.2648, GNorm = 1.9395, lr_0 = 2.8221e-04
Validation rmse = 0.158706
Epoch 32
Loss = 9.6333e-02, PNorm = 35.2755, GNorm = 1.9515, lr_0 = 2.7411e-04
Loss = 8.7080e-02, PNorm = 35.2832, GNorm = 0.7674, lr_0 = 2.6695e-04
Validation rmse = 0.143554
Epoch 33
Loss = 8.6475e-02, PNorm = 35.2908, GNorm = 1.8021, lr_0 = 2.5998e-04
Validation rmse = 0.146684
Epoch 34
Loss = 7.5098e-02, PNorm = 35.3001, GNorm = 0.4585, lr_0 = 2.5252e-04
Loss = 8.5523e-02, PNorm = 35.3071, GNorm = 1.6314, lr_0 = 2.4593e-04
Validation rmse = 0.143966
Epoch 35
Loss = 8.1966e-02, PNorm = 35.3165, GNorm = 1.7075, lr_0 = 2.3950e-04
Validation rmse = 0.152648
Epoch 36
Loss = 8.9202e-02, PNorm = 35.3239, GNorm = 1.4467, lr_0 = 2.3263e-04
Loss = 8.5218e-02, PNorm = 35.3315, GNorm = 0.6485, lr_0 = 2.2655e-04
Validation rmse = 0.143693
Epoch 37
Loss = 8.3647e-02, PNorm = 35.3377, GNorm = 1.9705, lr_0 = 2.2064e-04
Validation rmse = 0.153873
Epoch 38
Loss = 9.0785e-02, PNorm = 35.3467, GNorm = 2.0391, lr_0 = 2.1431e-04
Loss = 7.6313e-02, PNorm = 35.3527, GNorm = 0.9872, lr_0 = 2.0871e-04
Validation rmse = 0.151766
Epoch 39
Loss = 7.4770e-02, PNorm = 35.3585, GNorm = 1.1128, lr_0 = 2.0272e-04
Validation rmse = 0.145116
Epoch 40
Loss = 4.8949e-02, PNorm = 35.3641, GNorm = 0.6524, lr_0 = 1.9743e-04
Loss = 7.7897e-02, PNorm = 35.3694, GNorm = 0.9610, lr_0 = 1.9227e-04
Validation rmse = 0.142464
Epoch 41
Loss = 7.1675e-02, PNorm = 35.3778, GNorm = 0.6980, lr_0 = 1.8675e-04
Validation rmse = 0.148664
Epoch 42
Loss = 8.0188e-02, PNorm = 35.3829, GNorm = 2.2844, lr_0 = 1.8187e-04
Loss = 8.1079e-02, PNorm = 35.3869, GNorm = 0.4882, lr_0 = 1.7712e-04
Validation rmse = 0.143981
Epoch 43
Loss = 6.4555e-02, PNorm = 35.3927, GNorm = 2.5144, lr_0 = 1.7204e-04
Loss = 8.2375e-02, PNorm = 35.3981, GNorm = 0.5786, lr_0 = 1.6755e-04
Validation rmse = 0.145208
Epoch 44
Loss = 7.2985e-02, PNorm = 35.4034, GNorm = 1.4295, lr_0 = 1.6317e-04
Validation rmse = 0.147266
Epoch 45
Loss = 8.6692e-02, PNorm = 35.4090, GNorm = 0.7114, lr_0 = 1.5849e-04
Loss = 7.1131e-02, PNorm = 35.4147, GNorm = 0.6817, lr_0 = 1.5435e-04
Validation rmse = 0.146393
Epoch 46
Loss = 7.8889e-02, PNorm = 35.4177, GNorm = 2.3542, lr_0 = 1.5032e-04
Validation rmse = 0.143828
Epoch 47
Loss = 8.2615e-02, PNorm = 35.4230, GNorm = 0.6068, lr_0 = 1.4601e-04
Loss = 7.3853e-02, PNorm = 35.4284, GNorm = 1.2959, lr_0 = 1.4219e-04
Validation rmse = 0.146487
Epoch 48
Loss = 6.7695e-02, PNorm = 35.4327, GNorm = 0.8472, lr_0 = 1.3848e-04
Validation rmse = 0.144262
Epoch 49
Loss = 8.1129e-02, PNorm = 35.4369, GNorm = 0.7233, lr_0 = 1.3450e-04
Loss = 7.1211e-02, PNorm = 35.4407, GNorm = 0.8122, lr_0 = 1.3099e-04
Validation rmse = 0.144564
Epoch 50
Loss = 6.9764e-02, PNorm = 35.4444, GNorm = 2.4744, lr_0 = 1.2757e-04
Validation rmse = 0.148386
Epoch 51
Loss = 8.1327e-02, PNorm = 35.4493, GNorm = 2.8419, lr_0 = 1.2391e-04
Loss = 7.1575e-02, PNorm = 35.4537, GNorm = 0.7664, lr_0 = 1.2067e-04
Validation rmse = 0.149543
Epoch 52
Loss = 6.6943e-02, PNorm = 35.4564, GNorm = 0.6284, lr_0 = 1.1721e-04
Validation rmse = 0.145424
Epoch 53
Loss = 7.6710e-02, PNorm = 35.4601, GNorm = 1.1181, lr_0 = 1.1415e-04
Loss = 7.3184e-02, PNorm = 35.4637, GNorm = 1.2679, lr_0 = 1.1117e-04
Validation rmse = 0.145586
Epoch 54
Loss = 7.5150e-02, PNorm = 35.4671, GNorm = 2.5658, lr_0 = 1.0798e-04
Loss = 6.8619e-02, PNorm = 35.4705, GNorm = 0.7399, lr_0 = 1.0516e-04
Validation rmse = 0.146040
Epoch 55
Loss = 7.8070e-02, PNorm = 35.4733, GNorm = 1.6387, lr_0 = 1.0241e-04
Validation rmse = 0.145990
Epoch 56
Loss = 6.9462e-02, PNorm = 35.4768, GNorm = 0.8185, lr_0 = 1.0000e-04
Loss = 7.4809e-02, PNorm = 35.4796, GNorm = 2.6634, lr_0 = 1.0000e-04
Validation rmse = 0.144751
Epoch 57
Loss = 7.2003e-02, PNorm = 35.4844, GNorm = 1.0820, lr_0 = 1.0000e-04
Validation rmse = 0.143910
Epoch 58
Loss = 7.8703e-02, PNorm = 35.4874, GNorm = 0.4895, lr_0 = 1.0000e-04
Loss = 6.7808e-02, PNorm = 35.4901, GNorm = 2.0157, lr_0 = 1.0000e-04
Validation rmse = 0.144089
Epoch 59
Loss = 6.8866e-02, PNorm = 35.4935, GNorm = 1.1447, lr_0 = 1.0000e-04
Validation rmse = 0.143304
Model 0 best validation rmse = 0.142464 on epoch 40
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.227110
Ensemble test rmse = 0.227110
1-fold cross validation
	Seed 0 ==> test rmse = 0.227110
Overall test rmse = 0.227110 +/- 0.000000
Elapsed time = 0:00:39
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/MeOH_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/MeOH_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/MeOH_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 695 | train size = 688 | val size = 7 | test size = 337
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.5179e-01, PNorm = 43.2641, GNorm = 3.7596, lr_0 = 4.8077e-04
Validation rmse = 0.361506
Epoch 1
Loss = 6.9682e-01, PNorm = 43.3076, GNorm = 8.7747, lr_0 = 8.6154e-04
Validation rmse = 0.372762
Epoch 2
Loss = 4.4965e-01, PNorm = 43.3670, GNorm = 2.0051, lr_0 = 9.8184e-04
Loss = 5.5475e-01, PNorm = 43.4429, GNorm = 8.3434, lr_0 = 9.5231e-04
Validation rmse = 0.325042
Epoch 3
Loss = 4.5864e-01, PNorm = 43.5136, GNorm = 2.9301, lr_0 = 9.2367e-04
Validation rmse = 0.320919
Epoch 4
Loss = 2.9871e-01, PNorm = 43.5759, GNorm = 1.3348, lr_0 = 8.9589e-04
Validation rmse = 0.315991
Epoch 5
Loss = 3.2056e-01, PNorm = 43.6435, GNorm = 3.8634, lr_0 = 8.6629e-04
Loss = 2.3510e-01, PNorm = 43.6886, GNorm = 1.1473, lr_0 = 8.4024e-04
Validation rmse = 0.231890
Epoch 6
Loss = 2.8559e-01, PNorm = 43.7352, GNorm = 7.8492, lr_0 = 8.1497e-04
Validation rmse = 0.234591
Epoch 7
Loss = 2.7694e-01, PNorm = 43.7866, GNorm = 1.6954, lr_0 = 7.9046e-04
Loss = 2.0308e-01, PNorm = 43.8285, GNorm = 1.3642, lr_0 = 7.6668e-04
Validation rmse = 0.242063
Epoch 8
Loss = 1.8334e-01, PNorm = 43.8582, GNorm = 1.4121, lr_0 = 7.4362e-04
Validation rmse = 0.260783
Epoch 9
Loss = 2.2530e-01, PNorm = 43.8947, GNorm = 1.2017, lr_0 = 7.1906e-04
Validation rmse = 0.195323
Epoch 10
Loss = 1.6588e-01, PNorm = 43.9321, GNorm = 3.2423, lr_0 = 6.9743e-04
Loss = 1.4024e-01, PNorm = 43.9598, GNorm = 1.1019, lr_0 = 6.7645e-04
Validation rmse = 0.188895
Epoch 11
Loss = 1.4240e-01, PNorm = 43.9828, GNorm = 3.4267, lr_0 = 6.5611e-04
Validation rmse = 0.171600
Epoch 12
Loss = 9.9090e-02, PNorm = 44.0055, GNorm = 2.8240, lr_0 = 6.3638e-04
Validation rmse = 0.188103
Epoch 13
Loss = 1.3694e-01, PNorm = 44.0306, GNorm = 2.0401, lr_0 = 6.1535e-04
Loss = 1.2633e-01, PNorm = 44.0512, GNorm = 0.9714, lr_0 = 5.9685e-04
Validation rmse = 0.172953
Epoch 14
Loss = 1.0048e-01, PNorm = 44.0688, GNorm = 0.8289, lr_0 = 5.7889e-04
Validation rmse = 0.190847
Epoch 15
Loss = 1.4132e-01, PNorm = 44.0841, GNorm = 2.0194, lr_0 = 5.6148e-04
Loss = 1.2992e-01, PNorm = 44.1003, GNorm = 0.8915, lr_0 = 5.4460e-04
Validation rmse = 0.178731
Epoch 16
Loss = 1.0937e-01, PNorm = 44.1207, GNorm = 1.0647, lr_0 = 5.2822e-04
Validation rmse = 0.177168
Epoch 17
Loss = 1.0990e-01, PNorm = 44.1364, GNorm = 2.3177, lr_0 = 5.1077e-04
Validation rmse = 0.161252
Epoch 18
Loss = 9.6877e-02, PNorm = 44.1526, GNorm = 1.3632, lr_0 = 4.9540e-04
Loss = 1.1497e-01, PNorm = 44.1680, GNorm = 0.8518, lr_0 = 4.8050e-04
Validation rmse = 0.176895
Epoch 19
Loss = 1.0189e-01, PNorm = 44.1821, GNorm = 0.8662, lr_0 = 4.6605e-04
Validation rmse = 0.175793
Epoch 20
Loss = 8.8310e-02, PNorm = 44.1946, GNorm = 1.6889, lr_0 = 4.5204e-04
Validation rmse = 0.176115
Epoch 21
Loss = 1.3645e-01, PNorm = 44.2092, GNorm = 1.3655, lr_0 = 4.3710e-04
Loss = 8.7012e-02, PNorm = 44.2228, GNorm = 2.6756, lr_0 = 4.2396e-04
Validation rmse = 0.175856
Epoch 22
Loss = 9.6875e-02, PNorm = 44.2358, GNorm = 2.6090, lr_0 = 4.1120e-04
Validation rmse = 0.162869
Epoch 23
Loss = 9.4403e-02, PNorm = 44.2492, GNorm = 2.6835, lr_0 = 3.9884e-04
Loss = 9.0761e-02, PNorm = 44.2614, GNorm = 1.1297, lr_0 = 3.8684e-04
Validation rmse = 0.177145
Epoch 24
Loss = 9.3693e-02, PNorm = 44.2758, GNorm = 0.5488, lr_0 = 3.7521e-04
Validation rmse = 0.166042
Epoch 25
Loss = 9.6441e-02, PNorm = 44.2874, GNorm = 1.1564, lr_0 = 3.6392e-04
Validation rmse = 0.159792
Epoch 26
Loss = 6.3979e-02, PNorm = 44.3009, GNorm = 1.0861, lr_0 = 3.5190e-04
Loss = 1.0537e-01, PNorm = 44.3143, GNorm = 1.9008, lr_0 = 3.4132e-04
Validation rmse = 0.173493
Epoch 27
Loss = 8.3458e-02, PNorm = 44.3262, GNorm = 2.2225, lr_0 = 3.3105e-04
Validation rmse = 0.168404
Epoch 28
Loss = 8.4946e-02, PNorm = 44.3387, GNorm = 1.5321, lr_0 = 3.2109e-04
Validation rmse = 0.170622
Epoch 29
Loss = 1.1725e-01, PNorm = 44.3502, GNorm = 2.0493, lr_0 = 3.1144e-04
Loss = 8.3376e-02, PNorm = 44.3600, GNorm = 1.1779, lr_0 = 3.0207e-04
Validation rmse = 0.164251
Epoch 30
Loss = 7.7236e-02, PNorm = 44.3732, GNorm = 0.8797, lr_0 = 2.9209e-04
Validation rmse = 0.174653
Epoch 31
Loss = 7.7918e-02, PNorm = 44.3845, GNorm = 1.8259, lr_0 = 2.8331e-04
Loss = 8.4377e-02, PNorm = 44.3951, GNorm = 1.0491, lr_0 = 2.7478e-04
Validation rmse = 0.168526
Epoch 32
Loss = 7.8360e-02, PNorm = 44.4073, GNorm = 1.2289, lr_0 = 2.6652e-04
Validation rmse = 0.167843
Epoch 33
Loss = 8.3330e-02, PNorm = 44.4184, GNorm = 0.7553, lr_0 = 2.5850e-04
Validation rmse = 0.165567
Epoch 34
Loss = 8.7962e-02, PNorm = 44.4299, GNorm = 0.8194, lr_0 = 2.4996e-04
Loss = 7.9109e-02, PNorm = 44.4403, GNorm = 1.2231, lr_0 = 2.4245e-04
Validation rmse = 0.163450
Epoch 35
Loss = 6.9961e-02, PNorm = 44.4502, GNorm = 0.3619, lr_0 = 2.3515e-04
Validation rmse = 0.169925
Epoch 36
Loss = 7.3141e-02, PNorm = 44.4595, GNorm = 1.7616, lr_0 = 2.2808e-04
Validation rmse = 0.165959
Epoch 37
Loss = 9.9283e-02, PNorm = 44.4695, GNorm = 1.1878, lr_0 = 2.2122e-04
Loss = 7.0754e-02, PNorm = 44.4800, GNorm = 1.0882, lr_0 = 2.1457e-04
Validation rmse = 0.162398
Epoch 38
Loss = 6.3373e-02, PNorm = 44.4893, GNorm = 0.8703, lr_0 = 2.0748e-04
Validation rmse = 0.156204
Epoch 39
Loss = 7.2294e-02, PNorm = 44.4973, GNorm = 2.3355, lr_0 = 2.0124e-04
Loss = 7.3810e-02, PNorm = 44.5050, GNorm = 1.3548, lr_0 = 1.9519e-04
Validation rmse = 0.166436
Epoch 40
Loss = 6.8571e-02, PNorm = 44.5139, GNorm = 1.0071, lr_0 = 1.8932e-04
Validation rmse = 0.165774
Epoch 41
Loss = 5.9977e-02, PNorm = 44.5217, GNorm = 1.2947, lr_0 = 1.8362e-04
Validation rmse = 0.159774
Epoch 42
Loss = 4.3896e-02, PNorm = 44.5306, GNorm = 0.7769, lr_0 = 1.7756e-04
Loss = 7.2814e-02, PNorm = 44.5383, GNorm = 0.5870, lr_0 = 1.7222e-04
Validation rmse = 0.161845
Epoch 43
Loss = 5.9769e-02, PNorm = 44.5467, GNorm = 1.0460, lr_0 = 1.6704e-04
Validation rmse = 0.165059
Epoch 44
Loss = 6.6547e-02, PNorm = 44.5534, GNorm = 0.5482, lr_0 = 1.6201e-04
Validation rmse = 0.148442
Epoch 45
Loss = 5.5743e-02, PNorm = 44.5612, GNorm = 1.6400, lr_0 = 1.5714e-04
Loss = 6.4245e-02, PNorm = 44.5676, GNorm = 1.0143, lr_0 = 1.5241e-04
Validation rmse = 0.156557
Epoch 46
Loss = 5.7956e-02, PNorm = 44.5750, GNorm = 0.8761, lr_0 = 1.4738e-04
Validation rmse = 0.149007
Epoch 47
Loss = 6.9257e-02, PNorm = 44.5815, GNorm = 0.4677, lr_0 = 1.4295e-04
Loss = 6.1949e-02, PNorm = 44.5870, GNorm = 2.1955, lr_0 = 1.3865e-04
Validation rmse = 0.162164
Epoch 48
Loss = 6.8603e-02, PNorm = 44.5937, GNorm = 0.8200, lr_0 = 1.3448e-04
Validation rmse = 0.151291
Epoch 49
Loss = 6.3296e-02, PNorm = 44.5999, GNorm = 0.6822, lr_0 = 1.3043e-04
Validation rmse = 0.157861
Epoch 50
Loss = 5.4280e-02, PNorm = 44.6062, GNorm = 1.2499, lr_0 = 1.2651e-04
Loss = 6.1500e-02, PNorm = 44.6120, GNorm = 0.5019, lr_0 = 1.2270e-04
Validation rmse = 0.150369
Epoch 51
Loss = 5.6975e-02, PNorm = 44.6181, GNorm = 0.7442, lr_0 = 1.1865e-04
Validation rmse = 0.153205
Epoch 52
Loss = 4.5944e-02, PNorm = 44.6233, GNorm = 0.8030, lr_0 = 1.1508e-04
Validation rmse = 0.150986
Epoch 53
Loss = 6.6283e-02, PNorm = 44.6284, GNorm = 1.9631, lr_0 = 1.1162e-04
Loss = 5.4227e-02, PNorm = 44.6335, GNorm = 0.6207, lr_0 = 1.0826e-04
Validation rmse = 0.150613
Epoch 54
Loss = 5.3422e-02, PNorm = 44.6388, GNorm = 0.8643, lr_0 = 1.0501e-04
Validation rmse = 0.145433
Epoch 55
Loss = 5.8249e-02, PNorm = 44.6438, GNorm = 0.8530, lr_0 = 1.0154e-04
Loss = 5.3120e-02, PNorm = 44.6486, GNorm = 0.5201, lr_0 = 1.0000e-04
Validation rmse = 0.145792
Epoch 56
Loss = 5.3638e-02, PNorm = 44.6535, GNorm = 1.6077, lr_0 = 1.0000e-04
Validation rmse = 0.153238
Epoch 57
Loss = 5.7541e-02, PNorm = 44.6579, GNorm = 1.3825, lr_0 = 1.0000e-04
Validation rmse = 0.145169
Epoch 58
Loss = 4.1980e-02, PNorm = 44.6626, GNorm = 0.6371, lr_0 = 1.0000e-04
Loss = 5.6548e-02, PNorm = 44.6676, GNorm = 0.6395, lr_0 = 1.0000e-04
Validation rmse = 0.143254
Epoch 59
Loss = 4.9147e-02, PNorm = 44.6726, GNorm = 1.1457, lr_0 = 1.0000e-04
Validation rmse = 0.149737
Model 0 best validation rmse = 0.143254 on epoch 58
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.161248
Ensemble test rmse = 0.161248
1-fold cross validation
	Seed 0 ==> test rmse = 0.161248
Overall test rmse = 0.161248 +/- 0.000000
Elapsed time = 0:00:31
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/EtOH_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/EtOH_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/EtOH_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 976 | train size = 966 | val size = 10 | test size = 56
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.6864e-01, PNorm = 43.2628, GNorm = 6.5036, lr_0 = 3.6053e-04
Validation rmse = 0.244020
Epoch 1
Loss = 6.1296e-01, PNorm = 43.2874, GNorm = 1.2816, lr_0 = 6.2105e-04
Loss = 6.5966e-01, PNorm = 43.3310, GNorm = 0.9923, lr_0 = 8.5789e-04
Validation rmse = 0.331899
Epoch 2
Loss = 7.2063e-01, PNorm = 43.4087, GNorm = 6.5790, lr_0 = 9.8961e-04
Loss = 6.3369e-01, PNorm = 43.4928, GNorm = 5.1945, lr_0 = 9.6914e-04
Validation rmse = 0.227522
Epoch 3
Loss = 2.8827e-01, PNorm = 43.5821, GNorm = 0.7033, lr_0 = 9.4712e-04
Loss = 3.0628e-01, PNorm = 43.6598, GNorm = 1.6234, lr_0 = 9.2754e-04
Validation rmse = 0.243854
Epoch 4
Loss = 2.6430e-01, PNorm = 43.7236, GNorm = 0.7669, lr_0 = 9.0836e-04
Loss = 2.4291e-01, PNorm = 43.7809, GNorm = 4.9215, lr_0 = 8.8958e-04
Validation rmse = 0.202118
Epoch 5
Loss = 1.6938e-01, PNorm = 43.8305, GNorm = 1.3826, lr_0 = 8.6936e-04
Loss = 2.0492e-01, PNorm = 43.8698, GNorm = 5.0357, lr_0 = 8.5139e-04
Validation rmse = 0.220018
Epoch 6
Loss = 1.9631e-01, PNorm = 43.9086, GNorm = 0.6650, lr_0 = 8.3204e-04
Loss = 2.0612e-01, PNorm = 43.9462, GNorm = 2.3684, lr_0 = 8.1484e-04
Validation rmse = 0.221342
Epoch 7
Loss = 1.8700e-01, PNorm = 43.9847, GNorm = 0.8257, lr_0 = 7.9799e-04
Loss = 1.5107e-01, PNorm = 44.0183, GNorm = 2.2897, lr_0 = 7.8149e-04
Validation rmse = 0.203967
Epoch 8
Loss = 1.9319e-01, PNorm = 44.0521, GNorm = 3.6482, lr_0 = 7.6373e-04
Loss = 1.5624e-01, PNorm = 44.0890, GNorm = 1.8682, lr_0 = 7.4794e-04
Validation rmse = 0.181987
Epoch 9
Loss = 1.3265e-01, PNorm = 44.1161, GNorm = 3.5820, lr_0 = 7.3094e-04
Loss = 1.4720e-01, PNorm = 44.1388, GNorm = 2.5729, lr_0 = 7.1583e-04
Validation rmse = 0.176029
Epoch 10
Loss = 1.1433e-01, PNorm = 44.1583, GNorm = 0.6196, lr_0 = 7.0103e-04
Loss = 1.3220e-01, PNorm = 44.1755, GNorm = 1.9666, lr_0 = 6.8653e-04
Validation rmse = 0.167026
Epoch 11
Loss = 1.2451e-01, PNorm = 44.1971, GNorm = 2.6945, lr_0 = 6.7093e-04
Loss = 1.3559e-01, PNorm = 44.2173, GNorm = 3.1331, lr_0 = 6.5706e-04
Validation rmse = 0.162530
Epoch 12
Loss = 1.2389e-01, PNorm = 44.2408, GNorm = 2.1436, lr_0 = 6.4213e-04
Loss = 1.2869e-01, PNorm = 44.2608, GNorm = 0.8079, lr_0 = 6.2885e-04
Validation rmse = 0.168849
Epoch 13
Loss = 1.1726e-01, PNorm = 44.2797, GNorm = 2.4671, lr_0 = 6.1585e-04
Loss = 1.1752e-01, PNorm = 44.2982, GNorm = 0.7067, lr_0 = 6.0311e-04
Loss = 9.9903e-02, PNorm = 44.3005, GNorm = 1.5622, lr_0 = 6.0185e-04
Validation rmse = 0.156850
Epoch 14
Loss = 1.0324e-01, PNorm = 44.3214, GNorm = 0.5565, lr_0 = 5.8941e-04
Validation rmse = 0.159300
Epoch 15
Loss = 1.3584e-01, PNorm = 44.3396, GNorm = 0.9310, lr_0 = 5.7602e-04
Loss = 1.0003e-01, PNorm = 44.3553, GNorm = 0.7218, lr_0 = 5.6411e-04
Validation rmse = 0.153009
Epoch 16
Loss = 1.2834e-01, PNorm = 44.3720, GNorm = 2.5389, lr_0 = 5.5244e-04
Loss = 1.1642e-01, PNorm = 44.3893, GNorm = 3.0683, lr_0 = 5.4102e-04
Validation rmse = 0.183446
Epoch 17
Loss = 9.2824e-02, PNorm = 44.4086, GNorm = 1.0722, lr_0 = 5.2873e-04
Loss = 1.0161e-01, PNorm = 44.4203, GNorm = 0.6043, lr_0 = 5.1779e-04
Validation rmse = 0.157682
Epoch 18
Loss = 7.4078e-02, PNorm = 44.4365, GNorm = 1.6620, lr_0 = 5.0603e-04
Loss = 1.0427e-01, PNorm = 44.4478, GNorm = 1.4205, lr_0 = 4.9556e-04
Validation rmse = 0.156236
Epoch 19
Loss = 9.3348e-02, PNorm = 44.4621, GNorm = 0.8145, lr_0 = 4.8532e-04
Loss = 9.9296e-02, PNorm = 44.4787, GNorm = 0.6292, lr_0 = 4.7528e-04
Validation rmse = 0.162115
Epoch 20
Loss = 9.1130e-02, PNorm = 44.4928, GNorm = 0.7418, lr_0 = 4.6448e-04
Loss = 9.1936e-02, PNorm = 44.5048, GNorm = 1.4602, lr_0 = 4.5488e-04
Validation rmse = 0.164425
Epoch 21
Loss = 8.5194e-02, PNorm = 44.5215, GNorm = 0.7755, lr_0 = 4.4454e-04
Loss = 8.1002e-02, PNorm = 44.5339, GNorm = 0.6691, lr_0 = 4.3535e-04
Validation rmse = 0.172964
Epoch 22
Loss = 9.2793e-02, PNorm = 44.5477, GNorm = 1.1272, lr_0 = 4.2635e-04
Loss = 9.1166e-02, PNorm = 44.5615, GNorm = 2.4878, lr_0 = 4.1753e-04
Validation rmse = 0.166967
Epoch 23
Loss = 8.3831e-02, PNorm = 44.5800, GNorm = 2.6861, lr_0 = 4.0804e-04
Loss = 9.7129e-02, PNorm = 44.5947, GNorm = 0.5734, lr_0 = 3.9961e-04
Validation rmse = 0.167537
Epoch 24
Loss = 8.3569e-02, PNorm = 44.6093, GNorm = 0.5476, lr_0 = 3.9053e-04
Loss = 8.4680e-02, PNorm = 44.6195, GNorm = 1.3736, lr_0 = 3.8245e-04
Validation rmse = 0.179778
Epoch 25
Loss = 7.7740e-02, PNorm = 44.6293, GNorm = 1.0005, lr_0 = 3.7454e-04
Loss = 9.6534e-02, PNorm = 44.6409, GNorm = 2.9586, lr_0 = 3.6680e-04
Validation rmse = 0.155860
Epoch 26
Loss = 8.2503e-02, PNorm = 44.6549, GNorm = 1.2348, lr_0 = 3.5846e-04
Loss = 8.0604e-02, PNorm = 44.6673, GNorm = 0.8069, lr_0 = 3.5105e-04
Validation rmse = 0.168411
Epoch 27
Loss = 9.3708e-02, PNorm = 44.6833, GNorm = 2.4425, lr_0 = 3.4308e-04
Loss = 9.2675e-02, PNorm = 44.6963, GNorm = 2.5843, lr_0 = 3.3598e-04
Loss = 1.0180e-01, PNorm = 44.6972, GNorm = 3.6546, lr_0 = 3.3528e-04
Validation rmse = 0.154821
Epoch 28
Loss = 9.6244e-02, PNorm = 44.7093, GNorm = 3.4162, lr_0 = 3.2835e-04
Loss = 8.6023e-02, PNorm = 44.7227, GNorm = 2.6397, lr_0 = 3.2156e-04
Validation rmse = 0.167802
Epoch 29
Loss = 7.4887e-02, PNorm = 44.7351, GNorm = 1.3098, lr_0 = 3.1491e-04
Validation rmse = 0.149216
Epoch 30
Loss = 7.0450e-02, PNorm = 44.7472, GNorm = 0.5202, lr_0 = 3.0775e-04
Loss = 7.7624e-02, PNorm = 44.7563, GNorm = 0.8575, lr_0 = 3.0139e-04
Validation rmse = 0.156610
Epoch 31
Loss = 5.7771e-02, PNorm = 44.7665, GNorm = 0.7312, lr_0 = 2.9454e-04
Loss = 7.5574e-02, PNorm = 44.7787, GNorm = 0.8899, lr_0 = 2.8845e-04
Validation rmse = 0.151547
Epoch 32
Loss = 8.3738e-02, PNorm = 44.7872, GNorm = 1.5218, lr_0 = 2.8249e-04
Loss = 7.4861e-02, PNorm = 44.7968, GNorm = 0.5275, lr_0 = 2.7665e-04
Validation rmse = 0.153238
Epoch 33
Loss = 7.2283e-02, PNorm = 44.8073, GNorm = 0.5894, lr_0 = 2.7036e-04
Loss = 7.1820e-02, PNorm = 44.8162, GNorm = 1.6969, lr_0 = 2.6477e-04
Validation rmse = 0.170147
Epoch 34
Loss = 7.2389e-02, PNorm = 44.8262, GNorm = 1.1577, lr_0 = 2.5875e-04
Loss = 6.4451e-02, PNorm = 44.8352, GNorm = 0.6793, lr_0 = 2.5340e-04
Validation rmse = 0.158414
Epoch 35
Loss = 6.2391e-02, PNorm = 44.8425, GNorm = 0.7248, lr_0 = 2.4816e-04
Loss = 7.2919e-02, PNorm = 44.8519, GNorm = 0.8522, lr_0 = 2.4303e-04
Validation rmse = 0.157353
Epoch 36
Loss = 6.8519e-02, PNorm = 44.8605, GNorm = 1.8750, lr_0 = 2.3751e-04
Loss = 6.4489e-02, PNorm = 44.8688, GNorm = 0.7160, lr_0 = 2.3260e-04
Validation rmse = 0.163560
Epoch 37
Loss = 6.4371e-02, PNorm = 44.8791, GNorm = 0.6104, lr_0 = 2.2731e-04
Loss = 5.9577e-02, PNorm = 44.8870, GNorm = 0.8419, lr_0 = 2.2261e-04
Validation rmse = 0.160742
Epoch 38
Loss = 5.0789e-02, PNorm = 44.8940, GNorm = 0.9592, lr_0 = 2.1801e-04
Loss = 7.2199e-02, PNorm = 44.9030, GNorm = 1.0684, lr_0 = 2.1350e-04
Validation rmse = 0.150950
Epoch 39
Loss = 5.8725e-02, PNorm = 44.9118, GNorm = 0.7667, lr_0 = 2.0865e-04
Loss = 6.7483e-02, PNorm = 44.9197, GNorm = 1.3760, lr_0 = 2.0434e-04
Validation rmse = 0.159181
Epoch 40
Loss = 5.7627e-02, PNorm = 44.9268, GNorm = 0.8611, lr_0 = 1.9969e-04
Loss = 6.0343e-02, PNorm = 44.9341, GNorm = 0.6639, lr_0 = 1.9556e-04
Validation rmse = 0.178912
Epoch 41
Loss = 6.1320e-02, PNorm = 44.9418, GNorm = 1.1546, lr_0 = 1.9152e-04
Loss = 6.1006e-02, PNorm = 44.9488, GNorm = 0.4658, lr_0 = 1.8756e-04
Validation rmse = 0.160446
Epoch 42
Loss = 6.0547e-02, PNorm = 44.9568, GNorm = 0.9788, lr_0 = 1.8330e-04
Loss = 5.3995e-02, PNorm = 44.9639, GNorm = 0.8932, lr_0 = 1.7951e-04
Loss = 6.8942e-02, PNorm = 44.9647, GNorm = 1.6416, lr_0 = 1.7913e-04
Validation rmse = 0.155583
Epoch 43
Loss = 5.7032e-02, PNorm = 44.9718, GNorm = 1.5690, lr_0 = 1.7543e-04
Loss = 6.2743e-02, PNorm = 44.9798, GNorm = 3.8184, lr_0 = 1.7180e-04
Validation rmse = 0.169285
Epoch 44
Loss = 7.0019e-02, PNorm = 44.9859, GNorm = 1.2411, lr_0 = 1.6825e-04
Validation rmse = 0.164131
Epoch 45
Loss = 5.9090e-02, PNorm = 44.9932, GNorm = 1.0494, lr_0 = 1.6443e-04
Loss = 6.1321e-02, PNorm = 44.9989, GNorm = 1.4177, lr_0 = 1.6103e-04
Validation rmse = 0.158963
Epoch 46
Loss = 6.5478e-02, PNorm = 45.0069, GNorm = 0.8592, lr_0 = 1.5737e-04
Loss = 5.6476e-02, PNorm = 45.0131, GNorm = 0.6624, lr_0 = 1.5411e-04
Validation rmse = 0.157021
Epoch 47
Loss = 7.1916e-02, PNorm = 45.0194, GNorm = 1.0296, lr_0 = 1.5093e-04
Loss = 5.0855e-02, PNorm = 45.0247, GNorm = 0.7531, lr_0 = 1.4781e-04
Validation rmse = 0.150215
Epoch 48
Loss = 4.8866e-02, PNorm = 45.0304, GNorm = 2.3037, lr_0 = 1.4445e-04
Loss = 5.5294e-02, PNorm = 45.0358, GNorm = 0.8808, lr_0 = 1.4146e-04
Validation rmse = 0.154066
Epoch 49
Loss = 7.0334e-02, PNorm = 45.0422, GNorm = 1.4232, lr_0 = 1.3825e-04
Loss = 5.4597e-02, PNorm = 45.0485, GNorm = 1.3526, lr_0 = 1.3539e-04
Validation rmse = 0.166137
Epoch 50
Loss = 4.5591e-02, PNorm = 45.0528, GNorm = 0.5760, lr_0 = 1.3259e-04
Loss = 5.2707e-02, PNorm = 45.0571, GNorm = 1.3051, lr_0 = 1.2985e-04
Validation rmse = 0.157511
Epoch 51
Loss = 4.4201e-02, PNorm = 45.0627, GNorm = 1.0405, lr_0 = 1.2690e-04
Loss = 4.8570e-02, PNorm = 45.0673, GNorm = 0.5530, lr_0 = 1.2427e-04
Validation rmse = 0.158945
Epoch 52
Loss = 4.6750e-02, PNorm = 45.0730, GNorm = 0.8431, lr_0 = 1.2145e-04
Loss = 5.0031e-02, PNorm = 45.0767, GNorm = 0.5292, lr_0 = 1.1894e-04
Validation rmse = 0.156794
Epoch 53
Loss = 4.4355e-02, PNorm = 45.0812, GNorm = 0.8165, lr_0 = 1.1623e-04
Loss = 5.6065e-02, PNorm = 45.0856, GNorm = 0.6325, lr_0 = 1.1383e-04
Validation rmse = 0.158786
Epoch 54
Loss = 4.4490e-02, PNorm = 45.0893, GNorm = 0.3978, lr_0 = 1.1148e-04
Loss = 5.2774e-02, PNorm = 45.0934, GNorm = 0.7211, lr_0 = 1.0917e-04
Validation rmse = 0.155934
Epoch 55
Loss = 5.6519e-02, PNorm = 45.0979, GNorm = 1.4720, lr_0 = 1.0669e-04
Loss = 4.4386e-02, PNorm = 45.1016, GNorm = 0.7457, lr_0 = 1.0449e-04
Validation rmse = 0.165127
Epoch 56
Loss = 4.4063e-02, PNorm = 45.1066, GNorm = 0.8868, lr_0 = 1.0211e-04
Loss = 5.0183e-02, PNorm = 45.1102, GNorm = 0.4707, lr_0 = 1.0000e-04
Validation rmse = 0.163877
Epoch 57
Loss = 3.8821e-02, PNorm = 45.1145, GNorm = 0.6737, lr_0 = 1.0000e-04
Loss = 5.4637e-02, PNorm = 45.1174, GNorm = 1.6793, lr_0 = 1.0000e-04
Loss = 2.3868e-02, PNorm = 45.1177, GNorm = 1.0235, lr_0 = 1.0000e-04
Validation rmse = 0.158022
Epoch 58
Loss = 4.9905e-02, PNorm = 45.1209, GNorm = 0.9638, lr_0 = 1.0000e-04
Validation rmse = 0.167569
Epoch 59
Loss = 4.4484e-02, PNorm = 45.1248, GNorm = 1.1933, lr_0 = 1.0000e-04
Loss = 4.5606e-02, PNorm = 45.1288, GNorm = 0.8166, lr_0 = 1.0000e-04
Validation rmse = 0.159812
Model 0 best validation rmse = 0.149216 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.136423
Ensemble test rmse = 0.136423
1-fold cross validation
	Seed 0 ==> test rmse = 0.136423
Overall test rmse = 0.136423 +/- 0.000000
Elapsed time = 0:00:41
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/IPA_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/IPA_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/IPA_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 975 | train size = 965 | val size = 10 | test size = 57
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.6368e-01, PNorm = 43.2629, GNorm = 4.9637, lr_0 = 3.6053e-04
Validation rmse = 0.334453
Epoch 1
Loss = 1.2995e+00, PNorm = 43.2920, GNorm = 21.3057, lr_0 = 6.2105e-04
Loss = 7.3605e-01, PNorm = 43.3295, GNorm = 1.3073, lr_0 = 8.5789e-04
Validation rmse = 0.307694
Epoch 2
Loss = 4.8707e-01, PNorm = 43.4063, GNorm = 1.8951, lr_0 = 9.8961e-04
Loss = 4.9064e-01, PNorm = 43.4874, GNorm = 4.0665, lr_0 = 9.6914e-04
Validation rmse = 0.231098
Epoch 3
Loss = 3.4282e-01, PNorm = 43.5721, GNorm = 1.7882, lr_0 = 9.4712e-04
Loss = 2.7699e-01, PNorm = 43.6397, GNorm = 2.7351, lr_0 = 9.2754e-04
Validation rmse = 0.202465
Epoch 4
Loss = 2.7930e-01, PNorm = 43.6972, GNorm = 6.0041, lr_0 = 9.0836e-04
Loss = 2.6743e-01, PNorm = 43.7516, GNorm = 1.6869, lr_0 = 8.8958e-04
Validation rmse = 0.173144
Epoch 5
Loss = 2.1444e-01, PNorm = 43.7952, GNorm = 2.4493, lr_0 = 8.6936e-04
Loss = 2.5378e-01, PNorm = 43.8370, GNorm = 6.1862, lr_0 = 8.5139e-04
Validation rmse = 0.176542
Epoch 6
Loss = 1.8202e-01, PNorm = 43.8863, GNorm = 2.9843, lr_0 = 8.3204e-04
Loss = 1.9202e-01, PNorm = 43.9189, GNorm = 3.0660, lr_0 = 8.1484e-04
Validation rmse = 0.210801
Epoch 7
Loss = 2.0445e-01, PNorm = 43.9486, GNorm = 3.0208, lr_0 = 7.9799e-04
Loss = 1.9255e-01, PNorm = 43.9814, GNorm = 1.9117, lr_0 = 7.8149e-04
Validation rmse = 0.185684
Epoch 8
Loss = 1.4476e-01, PNorm = 44.0161, GNorm = 3.2642, lr_0 = 7.6373e-04
Loss = 1.6095e-01, PNorm = 44.0374, GNorm = 2.8583, lr_0 = 7.4794e-04
Validation rmse = 0.169815
Epoch 9
Loss = 1.3798e-01, PNorm = 44.0648, GNorm = 3.3776, lr_0 = 7.3094e-04
Loss = 1.5801e-01, PNorm = 44.0929, GNorm = 0.9039, lr_0 = 7.1583e-04
Validation rmse = 0.195174
Epoch 10
Loss = 1.7689e-01, PNorm = 44.1169, GNorm = 3.2300, lr_0 = 7.0103e-04
Loss = 1.2718e-01, PNorm = 44.1445, GNorm = 3.1631, lr_0 = 6.8653e-04
Validation rmse = 0.156021
Epoch 11
Loss = 1.3354e-01, PNorm = 44.1667, GNorm = 1.7082, lr_0 = 6.7093e-04
Loss = 1.4171e-01, PNorm = 44.1885, GNorm = 1.4160, lr_0 = 6.5706e-04
Validation rmse = 0.171807
Epoch 12
Loss = 1.0971e-01, PNorm = 44.2138, GNorm = 0.7309, lr_0 = 6.4213e-04
Loss = 1.2907e-01, PNorm = 44.2325, GNorm = 0.7451, lr_0 = 6.2885e-04
Loss = 1.1589e-01, PNorm = 44.2338, GNorm = 1.9809, lr_0 = 6.2754e-04
Validation rmse = 0.146271
Epoch 13
Loss = 1.1378e-01, PNorm = 44.2481, GNorm = 1.1603, lr_0 = 6.1456e-04
Loss = 1.2223e-01, PNorm = 44.2658, GNorm = 3.3290, lr_0 = 6.0185e-04
Validation rmse = 0.145962
Epoch 14
Loss = 1.0698e-01, PNorm = 44.2914, GNorm = 2.5008, lr_0 = 5.8941e-04
Validation rmse = 0.173683
Epoch 15
Loss = 1.2722e-01, PNorm = 44.3112, GNorm = 1.2571, lr_0 = 5.7602e-04
Loss = 9.2931e-02, PNorm = 44.3267, GNorm = 2.0074, lr_0 = 5.6411e-04
Validation rmse = 0.157617
Epoch 16
Loss = 7.4372e-02, PNorm = 44.3460, GNorm = 1.1212, lr_0 = 5.5129e-04
Loss = 1.0717e-01, PNorm = 44.3619, GNorm = 1.7582, lr_0 = 5.3989e-04
Validation rmse = 0.157441
Epoch 17
Loss = 8.1688e-02, PNorm = 44.3745, GNorm = 1.2483, lr_0 = 5.2873e-04
Loss = 1.0136e-01, PNorm = 44.3869, GNorm = 0.6044, lr_0 = 5.1779e-04
Validation rmse = 0.171916
Epoch 18
Loss = 8.6657e-02, PNorm = 44.4009, GNorm = 0.9157, lr_0 = 5.0603e-04
Loss = 1.0276e-01, PNorm = 44.4161, GNorm = 1.1737, lr_0 = 4.9556e-04
Validation rmse = 0.159526
Epoch 19
Loss = 9.4126e-02, PNorm = 44.4319, GNorm = 0.4713, lr_0 = 4.8430e-04
Loss = 9.3723e-02, PNorm = 44.4464, GNorm = 1.1494, lr_0 = 4.7429e-04
Validation rmse = 0.157355
Epoch 20
Loss = 8.0213e-02, PNorm = 44.4578, GNorm = 1.1344, lr_0 = 4.6448e-04
Loss = 9.5483e-02, PNorm = 44.4692, GNorm = 1.3515, lr_0 = 4.5488e-04
Validation rmse = 0.142642
Epoch 21
Loss = 1.1656e-01, PNorm = 44.4815, GNorm = 3.4880, lr_0 = 4.4454e-04
Loss = 9.6840e-02, PNorm = 44.4956, GNorm = 0.6506, lr_0 = 4.3535e-04
Validation rmse = 0.174434
Epoch 22
Loss = 1.1007e-01, PNorm = 44.5140, GNorm = 2.7128, lr_0 = 4.2546e-04
Loss = 9.8517e-02, PNorm = 44.5288, GNorm = 1.8215, lr_0 = 4.1666e-04
Validation rmse = 0.153836
Epoch 23
Loss = 8.2342e-02, PNorm = 44.5451, GNorm = 3.1854, lr_0 = 4.0719e-04
Loss = 9.4073e-02, PNorm = 44.5579, GNorm = 2.3548, lr_0 = 3.9877e-04
Validation rmse = 0.164202
Epoch 24
Loss = 1.1018e-01, PNorm = 44.5674, GNorm = 1.6199, lr_0 = 3.9053e-04
Loss = 8.1226e-02, PNorm = 44.5811, GNorm = 1.8890, lr_0 = 3.8245e-04
Validation rmse = 0.156132
Epoch 25
Loss = 8.8458e-02, PNorm = 44.5934, GNorm = 0.6153, lr_0 = 3.7376e-04
Loss = 8.7229e-02, PNorm = 44.6035, GNorm = 1.4938, lr_0 = 3.6603e-04
Validation rmse = 0.155800
Epoch 26
Loss = 7.4079e-02, PNorm = 44.6175, GNorm = 2.2754, lr_0 = 3.5772e-04
Loss = 8.2887e-02, PNorm = 44.6264, GNorm = 0.7000, lr_0 = 3.5032e-04
Validation rmse = 0.155245
Epoch 27
Loss = 7.8303e-02, PNorm = 44.6345, GNorm = 1.0392, lr_0 = 3.4308e-04
Loss = 7.4396e-02, PNorm = 44.6439, GNorm = 0.6895, lr_0 = 3.3598e-04
Loss = 1.4146e-01, PNorm = 44.6450, GNorm = 2.4924, lr_0 = 3.3528e-04
Validation rmse = 0.141229
Epoch 28
Loss = 7.0163e-02, PNorm = 44.6565, GNorm = 1.0848, lr_0 = 3.2835e-04
Validation rmse = 0.155105
Epoch 29
Loss = 8.7046e-02, PNorm = 44.6650, GNorm = 0.7479, lr_0 = 3.2089e-04
Loss = 7.6870e-02, PNorm = 44.6754, GNorm = 1.2313, lr_0 = 3.1425e-04
Validation rmse = 0.139660
Epoch 30
Loss = 5.3968e-02, PNorm = 44.6849, GNorm = 0.5620, lr_0 = 3.0775e-04
Loss = 6.7177e-02, PNorm = 44.6916, GNorm = 0.6422, lr_0 = 3.0139e-04
Validation rmse = 0.141022
Epoch 31
Loss = 5.3942e-02, PNorm = 44.7019, GNorm = 0.8399, lr_0 = 2.9454e-04
Loss = 7.3700e-02, PNorm = 44.7104, GNorm = 0.6208, lr_0 = 2.8845e-04
Validation rmse = 0.157630
Epoch 32
Loss = 8.7247e-02, PNorm = 44.7203, GNorm = 1.0482, lr_0 = 2.8190e-04
Loss = 7.3863e-02, PNorm = 44.7288, GNorm = 0.6901, lr_0 = 2.7607e-04
Validation rmse = 0.159758
Epoch 33
Loss = 6.7364e-02, PNorm = 44.7392, GNorm = 0.8060, lr_0 = 2.6980e-04
Loss = 7.4988e-02, PNorm = 44.7478, GNorm = 1.5056, lr_0 = 2.6422e-04
Validation rmse = 0.142918
Epoch 34
Loss = 5.1750e-02, PNorm = 44.7578, GNorm = 0.6063, lr_0 = 2.5875e-04
Loss = 7.2676e-02, PNorm = 44.7656, GNorm = 1.2359, lr_0 = 2.5340e-04
Validation rmse = 0.148676
Epoch 35
Loss = 7.6210e-02, PNorm = 44.7731, GNorm = 2.4106, lr_0 = 2.4764e-04
Loss = 7.0309e-02, PNorm = 44.7836, GNorm = 1.8517, lr_0 = 2.4252e-04
Validation rmse = 0.135603
Epoch 36
Loss = 7.2061e-02, PNorm = 44.7922, GNorm = 0.7087, lr_0 = 2.3701e-04
Loss = 8.2342e-02, PNorm = 44.8020, GNorm = 2.2002, lr_0 = 2.3211e-04
Validation rmse = 0.144418
Epoch 37
Loss = 7.9024e-02, PNorm = 44.8099, GNorm = 1.4476, lr_0 = 2.2731e-04
Loss = 7.6677e-02, PNorm = 44.8171, GNorm = 1.8497, lr_0 = 2.2261e-04
Validation rmse = 0.128917
Epoch 38
Loss = 7.9087e-02, PNorm = 44.8265, GNorm = 2.1219, lr_0 = 2.1755e-04
Loss = 6.3922e-02, PNorm = 44.8335, GNorm = 1.3494, lr_0 = 2.1306e-04
Validation rmse = 0.134896
Epoch 39
Loss = 6.3108e-02, PNorm = 44.8401, GNorm = 0.7517, lr_0 = 2.0821e-04
Loss = 6.3523e-02, PNorm = 44.8467, GNorm = 1.0135, lr_0 = 2.0391e-04
Validation rmse = 0.142028
Epoch 40
Loss = 5.7605e-02, PNorm = 44.8533, GNorm = 1.1652, lr_0 = 1.9969e-04
Loss = 6.6018e-02, PNorm = 44.8586, GNorm = 0.6023, lr_0 = 1.9556e-04
Validation rmse = 0.143030
Epoch 41
Loss = 6.1012e-02, PNorm = 44.8669, GNorm = 0.8679, lr_0 = 1.9112e-04
Loss = 6.0590e-02, PNorm = 44.8727, GNorm = 1.1782, lr_0 = 1.8717e-04
Loss = 6.3093e-02, PNorm = 44.8734, GNorm = 1.7324, lr_0 = 1.8678e-04
Validation rmse = 0.155412
Epoch 42
Loss = 6.0846e-02, PNorm = 44.8804, GNorm = 0.4880, lr_0 = 1.8292e-04
Validation rmse = 0.139705
Epoch 43
Loss = 5.8398e-02, PNorm = 44.8869, GNorm = 0.7204, lr_0 = 1.7876e-04
Loss = 5.1583e-02, PNorm = 44.8924, GNorm = 0.3225, lr_0 = 1.7506e-04
Validation rmse = 0.139373
Epoch 44
Loss = 5.1506e-02, PNorm = 44.8972, GNorm = 0.7881, lr_0 = 1.7144e-04
Loss = 5.6785e-02, PNorm = 44.9029, GNorm = 0.4853, lr_0 = 1.6790e-04
Validation rmse = 0.126644
Epoch 45
Loss = 5.9026e-02, PNorm = 44.9092, GNorm = 0.9203, lr_0 = 1.6408e-04
Loss = 5.6849e-02, PNorm = 44.9149, GNorm = 0.8594, lr_0 = 1.6069e-04
Validation rmse = 0.148083
Epoch 46
Loss = 7.5055e-02, PNorm = 44.9209, GNorm = 2.3764, lr_0 = 1.5704e-04
Loss = 6.5839e-02, PNorm = 44.9276, GNorm = 1.6398, lr_0 = 1.5379e-04
Validation rmse = 0.131244
Epoch 47
Loss = 6.1661e-02, PNorm = 44.9329, GNorm = 1.0394, lr_0 = 1.5061e-04
Loss = 5.7030e-02, PNorm = 44.9387, GNorm = 0.7570, lr_0 = 1.4750e-04
Validation rmse = 0.129436
Epoch 48
Loss = 4.6254e-02, PNorm = 44.9434, GNorm = 0.7430, lr_0 = 1.4415e-04
Loss = 5.2417e-02, PNorm = 44.9481, GNorm = 0.5981, lr_0 = 1.4117e-04
Validation rmse = 0.132272
Epoch 49
Loss = 5.2820e-02, PNorm = 44.9528, GNorm = 1.0692, lr_0 = 1.3796e-04
Loss = 5.4609e-02, PNorm = 44.9570, GNorm = 0.5711, lr_0 = 1.3511e-04
Validation rmse = 0.116198
Epoch 50
Loss = 5.1868e-02, PNorm = 44.9625, GNorm = 0.7378, lr_0 = 1.3231e-04
Loss = 5.7671e-02, PNorm = 44.9662, GNorm = 0.6254, lr_0 = 1.2958e-04
Validation rmse = 0.128102
Epoch 51
Loss = 6.1809e-02, PNorm = 44.9719, GNorm = 0.8400, lr_0 = 1.2663e-04
Loss = 5.2152e-02, PNorm = 44.9765, GNorm = 0.7969, lr_0 = 1.2401e-04
Validation rmse = 0.114645
Epoch 52
Loss = 4.5247e-02, PNorm = 44.9813, GNorm = 1.5660, lr_0 = 1.2119e-04
Loss = 6.7208e-02, PNorm = 44.9858, GNorm = 1.2209, lr_0 = 1.1869e-04
Validation rmse = 0.124766
Epoch 53
Loss = 5.2225e-02, PNorm = 44.9905, GNorm = 0.5133, lr_0 = 1.1599e-04
Loss = 5.2422e-02, PNorm = 44.9948, GNorm = 0.7154, lr_0 = 1.1359e-04
Validation rmse = 0.123798
Epoch 54
Loss = 5.0068e-02, PNorm = 44.9994, GNorm = 0.4871, lr_0 = 1.1124e-04
Loss = 5.0681e-02, PNorm = 45.0029, GNorm = 0.9565, lr_0 = 1.0894e-04
Validation rmse = 0.121572
Epoch 55
Loss = 4.8241e-02, PNorm = 45.0072, GNorm = 0.5005, lr_0 = 1.0647e-04
Loss = 5.2561e-02, PNorm = 45.0115, GNorm = 0.9487, lr_0 = 1.0427e-04
Loss = 2.6944e-02, PNorm = 45.0119, GNorm = 0.9534, lr_0 = 1.0405e-04
Validation rmse = 0.119447
Epoch 56
Loss = 5.3072e-02, PNorm = 45.0160, GNorm = 0.6146, lr_0 = 1.0190e-04
Loss = 4.5378e-02, PNorm = 45.0203, GNorm = 0.7562, lr_0 = 1.0000e-04
Validation rmse = 0.120322
Epoch 57
Loss = 4.7033e-02, PNorm = 45.0235, GNorm = 0.4817, lr_0 = 1.0000e-04
Validation rmse = 0.122493
Epoch 58
Loss = 3.8412e-02, PNorm = 45.0272, GNorm = 0.6354, lr_0 = 1.0000e-04
Loss = 4.3632e-02, PNorm = 45.0309, GNorm = 0.8926, lr_0 = 1.0000e-04
Validation rmse = 0.129486
Epoch 59
Loss = 6.9411e-02, PNorm = 45.0349, GNorm = 1.7767, lr_0 = 1.0000e-04
Loss = 4.3711e-02, PNorm = 45.0384, GNorm = 0.6023, lr_0 = 1.0000e-04
Validation rmse = 0.114457
Model 0 best validation rmse = 0.114457 on epoch 59
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.161798
Ensemble test rmse = 0.161798
1-fold cross validation
	Seed 0 ==> test rmse = 0.161798
Overall test rmse = 0.161798 +/- 0.000000
Elapsed time = 0:00:43
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/Tol_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/Tol_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/Tol_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 984 | train size = 974 | val size = 10 | test size = 48
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 8.6050e-01, PNorm = 43.2664, GNorm = 1.5742, lr_0 = 3.6053e-04
Validation rmse = 0.265278
Epoch 1
Loss = 6.8094e-01, PNorm = 43.2916, GNorm = 8.7570, lr_0 = 6.2105e-04
Loss = 7.1686e-01, PNorm = 43.3267, GNorm = 5.3634, lr_0 = 8.5789e-04
Validation rmse = 0.255325
Epoch 2
Loss = 5.3669e-01, PNorm = 43.3998, GNorm = 1.7678, lr_0 = 9.8961e-04
Loss = 3.8935e-01, PNorm = 43.4646, GNorm = 2.3614, lr_0 = 9.6914e-04
Validation rmse = 0.221152
Epoch 3
Loss = 2.7739e-01, PNorm = 43.5277, GNorm = 1.5475, lr_0 = 9.4910e-04
Loss = 2.7876e-01, PNorm = 43.5811, GNorm = 2.3156, lr_0 = 9.2948e-04
Validation rmse = 0.156545
Epoch 4
Loss = 3.3260e-01, PNorm = 43.6254, GNorm = 5.3794, lr_0 = 9.0836e-04
Loss = 2.3133e-01, PNorm = 43.6722, GNorm = 1.6928, lr_0 = 8.8958e-04
Validation rmse = 0.157497
Epoch 5
Loss = 2.4472e-01, PNorm = 43.7130, GNorm = 7.2312, lr_0 = 8.7118e-04
Loss = 2.0617e-01, PNorm = 43.7529, GNorm = 3.7870, lr_0 = 8.5317e-04
Validation rmse = 0.149938
Epoch 6
Loss = 1.6305e-01, PNorm = 43.7787, GNorm = 0.7738, lr_0 = 8.3378e-04
Loss = 1.9416e-01, PNorm = 43.8092, GNorm = 2.5754, lr_0 = 8.1654e-04
Validation rmse = 0.142862
Epoch 7
Loss = 1.4317e-01, PNorm = 43.8356, GNorm = 3.1363, lr_0 = 7.9966e-04
Loss = 1.5358e-01, PNorm = 43.8574, GNorm = 1.3063, lr_0 = 7.8312e-04
Validation rmse = 0.128086
Epoch 8
Loss = 1.3422e-01, PNorm = 43.8816, GNorm = 1.4217, lr_0 = 7.6533e-04
Loss = 1.3477e-01, PNorm = 43.9072, GNorm = 4.5695, lr_0 = 7.4950e-04
Validation rmse = 0.214519
Epoch 9
Loss = 1.9042e-01, PNorm = 43.9313, GNorm = 5.7138, lr_0 = 7.3400e-04
Loss = 1.4720e-01, PNorm = 43.9635, GNorm = 5.2239, lr_0 = 7.1883e-04
Validation rmse = 0.143645
Epoch 10
Loss = 1.7697e-01, PNorm = 43.9936, GNorm = 2.1480, lr_0 = 7.0249e-04
Loss = 1.3443e-01, PNorm = 44.0211, GNorm = 2.7344, lr_0 = 6.8797e-04
Validation rmse = 0.139627
Epoch 11
Loss = 1.4842e-01, PNorm = 44.0425, GNorm = 0.8478, lr_0 = 6.7374e-04
Loss = 1.3618e-01, PNorm = 44.0628, GNorm = 2.5562, lr_0 = 6.5981e-04
Validation rmse = 0.117893
Epoch 12
Loss = 9.6698e-02, PNorm = 44.0912, GNorm = 0.9780, lr_0 = 6.4482e-04
Loss = 1.2243e-01, PNorm = 44.1089, GNorm = 2.9578, lr_0 = 6.3148e-04
Validation rmse = 0.111663
Epoch 13
Loss = 1.1502e-01, PNorm = 44.1231, GNorm = 1.6870, lr_0 = 6.1843e-04
Loss = 1.0768e-01, PNorm = 44.1391, GNorm = 2.0280, lr_0 = 6.0564e-04
Validation rmse = 0.122517
Epoch 14
Loss = 1.1226e-01, PNorm = 44.1588, GNorm = 0.7980, lr_0 = 5.9188e-04
Loss = 1.1385e-01, PNorm = 44.1796, GNorm = 1.3947, lr_0 = 5.7964e-04
Validation rmse = 0.144136
Epoch 15
Loss = 1.0652e-01, PNorm = 44.1981, GNorm = 1.2197, lr_0 = 5.6765e-04
Loss = 1.0741e-01, PNorm = 44.2153, GNorm = 1.5860, lr_0 = 5.5592e-04
Validation rmse = 0.107799
Epoch 16
Loss = 9.8630e-02, PNorm = 44.2277, GNorm = 0.8089, lr_0 = 5.4328e-04
Loss = 1.1412e-01, PNorm = 44.2416, GNorm = 0.7896, lr_0 = 5.3205e-04
Validation rmse = 0.113848
Epoch 17
Loss = 1.0451e-01, PNorm = 44.2579, GNorm = 2.4996, lr_0 = 5.2105e-04
Loss = 1.1624e-01, PNorm = 44.2761, GNorm = 2.0598, lr_0 = 5.1027e-04
Loss = 8.3456e-02, PNorm = 44.2780, GNorm = 2.8518, lr_0 = 5.0921e-04
Validation rmse = 0.114494
Epoch 18
Loss = 1.2478e-01, PNorm = 44.2922, GNorm = 3.6438, lr_0 = 4.9868e-04
Loss = 1.4258e-01, PNorm = 44.3070, GNorm = 4.9046, lr_0 = 4.8837e-04
Validation rmse = 0.136183
Epoch 19
Loss = 1.3978e-01, PNorm = 44.3301, GNorm = 1.1131, lr_0 = 4.7827e-04
Validation rmse = 0.129204
Epoch 20
Loss = 1.4704e-01, PNorm = 44.3518, GNorm = 1.3078, lr_0 = 4.6740e-04
Loss = 1.0594e-01, PNorm = 44.3712, GNorm = 0.6459, lr_0 = 4.5774e-04
Validation rmse = 0.125896
Epoch 21
Loss = 1.2753e-01, PNorm = 44.3876, GNorm = 2.9836, lr_0 = 4.4827e-04
Loss = 9.8667e-02, PNorm = 44.4025, GNorm = 0.4409, lr_0 = 4.3900e-04
Validation rmse = 0.110622
Epoch 22
Loss = 9.7586e-02, PNorm = 44.4137, GNorm = 1.1393, lr_0 = 4.2903e-04
Loss = 9.2287e-02, PNorm = 44.4256, GNorm = 1.9224, lr_0 = 4.2016e-04
Validation rmse = 0.110528
Epoch 23
Loss = 1.1036e-01, PNorm = 44.4332, GNorm = 1.1421, lr_0 = 4.1147e-04
Loss = 9.1391e-02, PNorm = 44.4470, GNorm = 2.1019, lr_0 = 4.0296e-04
Validation rmse = 0.109720
Epoch 24
Loss = 9.8487e-02, PNorm = 44.4615, GNorm = 1.7504, lr_0 = 3.9381e-04
Loss = 8.3005e-02, PNorm = 44.4711, GNorm = 0.7729, lr_0 = 3.8566e-04
Validation rmse = 0.097479
Epoch 25
Loss = 8.4688e-02, PNorm = 44.4822, GNorm = 1.5853, lr_0 = 3.7769e-04
Loss = 1.0036e-01, PNorm = 44.4937, GNorm = 0.9047, lr_0 = 3.6988e-04
Validation rmse = 0.105711
Epoch 26
Loss = 7.4636e-02, PNorm = 44.5037, GNorm = 1.4431, lr_0 = 3.6147e-04
Loss = 9.0827e-02, PNorm = 44.5159, GNorm = 0.6055, lr_0 = 3.5400e-04
Validation rmse = 0.117295
Epoch 27
Loss = 1.1365e-01, PNorm = 44.5289, GNorm = 2.1819, lr_0 = 3.4596e-04
Loss = 9.1054e-02, PNorm = 44.5437, GNorm = 0.7349, lr_0 = 3.3880e-04
Validation rmse = 0.099716
Epoch 28
Loss = 8.1083e-02, PNorm = 44.5547, GNorm = 2.2600, lr_0 = 3.3180e-04
Loss = 9.3811e-02, PNorm = 44.5625, GNorm = 1.8357, lr_0 = 3.2494e-04
Validation rmse = 0.111879
Epoch 29
Loss = 8.0105e-02, PNorm = 44.5729, GNorm = 0.6770, lr_0 = 3.1755e-04
Loss = 7.5703e-02, PNorm = 44.5808, GNorm = 0.6728, lr_0 = 3.1099e-04
Validation rmse = 0.097205
Epoch 30
Loss = 8.3851e-02, PNorm = 44.5926, GNorm = 1.6002, lr_0 = 3.0456e-04
Loss = 8.2883e-02, PNorm = 44.6020, GNorm = 1.4377, lr_0 = 2.9826e-04
Validation rmse = 0.095737
Epoch 31
Loss = 7.2375e-02, PNorm = 44.6121, GNorm = 0.7294, lr_0 = 2.9148e-04
Loss = 8.5651e-02, PNorm = 44.6206, GNorm = 0.6234, lr_0 = 2.8545e-04
Validation rmse = 0.095185
Epoch 32
Loss = 7.7732e-02, PNorm = 44.6286, GNorm = 0.5600, lr_0 = 2.7955e-04
Loss = 7.8070e-02, PNorm = 44.6394, GNorm = 0.9435, lr_0 = 2.7377e-04
Validation rmse = 0.099611
Epoch 33
Loss = 7.7438e-02, PNorm = 44.6483, GNorm = 0.9452, lr_0 = 2.6755e-04
Loss = 6.6332e-02, PNorm = 44.6558, GNorm = 0.3633, lr_0 = 2.6202e-04
Validation rmse = 0.090991
Epoch 34
Loss = 8.5157e-02, PNorm = 44.6632, GNorm = 1.1808, lr_0 = 2.5660e-04
Loss = 6.0524e-02, PNorm = 44.6708, GNorm = 0.7946, lr_0 = 2.5129e-04
Validation rmse = 0.099250
Epoch 35
Loss = 6.7798e-02, PNorm = 44.6770, GNorm = 1.5559, lr_0 = 2.4558e-04
Loss = 7.2582e-02, PNorm = 44.6854, GNorm = 0.5763, lr_0 = 2.4051e-04
Validation rmse = 0.096779
Epoch 36
Loss = 6.0925e-02, PNorm = 44.6942, GNorm = 1.3540, lr_0 = 2.3553e-04
Loss = 7.7358e-02, PNorm = 44.7009, GNorm = 0.5278, lr_0 = 2.3066e-04
Loss = 5.1917e-02, PNorm = 44.7018, GNorm = 1.8861, lr_0 = 2.3018e-04
Validation rmse = 0.100903
Epoch 37
Loss = 6.2056e-02, PNorm = 44.7101, GNorm = 0.5768, lr_0 = 2.2542e-04
Loss = 7.4360e-02, PNorm = 44.7171, GNorm = 0.6363, lr_0 = 2.2076e-04
Validation rmse = 0.091468
Epoch 38
Loss = 6.2870e-02, PNorm = 44.7228, GNorm = 1.2667, lr_0 = 2.1620e-04
Validation rmse = 0.094066
Epoch 39
Loss = 6.6089e-02, PNorm = 44.7317, GNorm = 1.7014, lr_0 = 2.1128e-04
Loss = 6.9288e-02, PNorm = 44.7404, GNorm = 0.4227, lr_0 = 2.0691e-04
Validation rmse = 0.093434
Epoch 40
Loss = 7.6973e-02, PNorm = 44.7473, GNorm = 0.9076, lr_0 = 2.0264e-04
Loss = 6.5110e-02, PNorm = 44.7538, GNorm = 0.8725, lr_0 = 1.9845e-04
Validation rmse = 0.095679
Epoch 41
Loss = 8.3140e-02, PNorm = 44.7603, GNorm = 1.7319, lr_0 = 1.9394e-04
Loss = 6.4432e-02, PNorm = 44.7674, GNorm = 2.3431, lr_0 = 1.8993e-04
Validation rmse = 0.103964
Epoch 42
Loss = 5.5905e-02, PNorm = 44.7738, GNorm = 1.1245, lr_0 = 1.8600e-04
Loss = 6.6359e-02, PNorm = 44.7795, GNorm = 1.1445, lr_0 = 1.8215e-04
Validation rmse = 0.096712
Epoch 43
Loss = 5.5785e-02, PNorm = 44.7860, GNorm = 0.4433, lr_0 = 1.7801e-04
Loss = 6.3351e-02, PNorm = 44.7929, GNorm = 0.8174, lr_0 = 1.7433e-04
Validation rmse = 0.095089
Epoch 44
Loss = 5.9883e-02, PNorm = 44.7987, GNorm = 1.2439, lr_0 = 1.7073e-04
Loss = 5.7778e-02, PNorm = 44.8046, GNorm = 1.2213, lr_0 = 1.6720e-04
Validation rmse = 0.090232
Epoch 45
Loss = 5.6334e-02, PNorm = 44.8115, GNorm = 1.0740, lr_0 = 1.6340e-04
Loss = 6.0634e-02, PNorm = 44.8177, GNorm = 0.4809, lr_0 = 1.6002e-04
Validation rmse = 0.092083
Epoch 46
Loss = 5.7357e-02, PNorm = 44.8228, GNorm = 0.6961, lr_0 = 1.5671e-04
Loss = 5.9362e-02, PNorm = 44.8276, GNorm = 1.0139, lr_0 = 1.5347e-04
Validation rmse = 0.090039
Epoch 47
Loss = 5.4582e-02, PNorm = 44.8341, GNorm = 1.6214, lr_0 = 1.4998e-04
Loss = 6.5113e-02, PNorm = 44.8389, GNorm = 0.7148, lr_0 = 1.4688e-04
Validation rmse = 0.089045
Epoch 48
Loss = 6.3330e-02, PNorm = 44.8445, GNorm = 1.3288, lr_0 = 1.4384e-04
Loss = 5.4416e-02, PNorm = 44.8496, GNorm = 0.4789, lr_0 = 1.4087e-04
Validation rmse = 0.089107
Epoch 49
Loss = 5.1370e-02, PNorm = 44.8552, GNorm = 1.0327, lr_0 = 1.3767e-04
Loss = 6.3981e-02, PNorm = 44.8596, GNorm = 1.5359, lr_0 = 1.3482e-04
Validation rmse = 0.093430
Epoch 50
Loss = 4.8003e-02, PNorm = 44.8654, GNorm = 0.7337, lr_0 = 1.3204e-04
Loss = 6.2022e-02, PNorm = 44.8699, GNorm = 0.5000, lr_0 = 1.2930e-04
Validation rmse = 0.088830
Epoch 51
Loss = 5.1151e-02, PNorm = 44.8748, GNorm = 0.9530, lr_0 = 1.2637e-04
Loss = 5.7661e-02, PNorm = 44.8787, GNorm = 1.4177, lr_0 = 1.2375e-04
Validation rmse = 0.091743
Epoch 52
Loss = 5.7473e-02, PNorm = 44.8841, GNorm = 1.3222, lr_0 = 1.2094e-04
Loss = 5.4593e-02, PNorm = 44.8883, GNorm = 0.5273, lr_0 = 1.1844e-04
Validation rmse = 0.097913
Epoch 53
Loss = 5.2515e-02, PNorm = 44.8931, GNorm = 0.6956, lr_0 = 1.1599e-04
Loss = 5.6367e-02, PNorm = 44.8976, GNorm = 0.4317, lr_0 = 1.1359e-04
Validation rmse = 0.091695
Epoch 54
Loss = 4.9945e-02, PNorm = 44.9027, GNorm = 1.9209, lr_0 = 1.1101e-04
Loss = 6.1302e-02, PNorm = 44.9065, GNorm = 1.1195, lr_0 = 1.0872e-04
Validation rmse = 0.092251
Epoch 55
Loss = 5.8090e-02, PNorm = 44.9104, GNorm = 0.7254, lr_0 = 1.0647e-04
Loss = 4.8942e-02, PNorm = 44.9138, GNorm = 0.5866, lr_0 = 1.0427e-04
Loss = 6.7896e-02, PNorm = 44.9142, GNorm = 1.5779, lr_0 = 1.0405e-04
Validation rmse = 0.086723
Epoch 56
Loss = 5.7343e-02, PNorm = 44.9188, GNorm = 1.1831, lr_0 = 1.0190e-04
Loss = 4.5448e-02, PNorm = 44.9221, GNorm = 0.5689, lr_0 = 1.0000e-04
Validation rmse = 0.087022
Epoch 57
Loss = 5.0545e-02, PNorm = 44.9249, GNorm = 0.5018, lr_0 = 1.0000e-04
Validation rmse = 0.083919
Epoch 58
Loss = 4.7930e-02, PNorm = 44.9289, GNorm = 0.8193, lr_0 = 1.0000e-04
Loss = 5.1857e-02, PNorm = 44.9327, GNorm = 0.8328, lr_0 = 1.0000e-04
Validation rmse = 0.087618
Epoch 59
Loss = 5.6203e-02, PNorm = 44.9361, GNorm = 0.9575, lr_0 = 1.0000e-04
Loss = 4.8873e-02, PNorm = 44.9397, GNorm = 0.6795, lr_0 = 1.0000e-04
Validation rmse = 0.086298
Model 0 best validation rmse = 0.083919 on epoch 57
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.612454
Ensemble test rmse = 0.612454
1-fold cross validation
	Seed 0 ==> test rmse = 0.612454
Overall test rmse = 0.612454 +/- 0.000000
Elapsed time = 0:00:44
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/Hept_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/Hept_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/Hept_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 983 | train size = 973 | val size = 10 | test size = 49
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.1038e-01, PNorm = 43.2601, GNorm = 2.4318, lr_0 = 3.6053e-04
Validation rmse = 0.147519
Epoch 1
Loss = 9.5312e-01, PNorm = 43.2902, GNorm = 5.4721, lr_0 = 6.2105e-04
Loss = 8.2921e-01, PNorm = 43.3243, GNorm = 5.9971, lr_0 = 8.5789e-04
Validation rmse = 0.211057
Epoch 2
Loss = 6.3890e-01, PNorm = 43.3845, GNorm = 1.7665, lr_0 = 9.8961e-04
Loss = 5.0384e-01, PNorm = 43.4601, GNorm = 3.5403, lr_0 = 9.6914e-04
Validation rmse = 0.142482
Epoch 3
Loss = 5.8892e-01, PNorm = 43.5406, GNorm = 7.1921, lr_0 = 9.4910e-04
Loss = 3.1565e-01, PNorm = 43.6101, GNorm = 1.3057, lr_0 = 9.2948e-04
Validation rmse = 0.148716
Epoch 4
Loss = 3.2103e-01, PNorm = 43.6716, GNorm = 4.5482, lr_0 = 9.0836e-04
Loss = 2.4195e-01, PNorm = 43.7271, GNorm = 1.0271, lr_0 = 8.8958e-04
Validation rmse = 0.129185
Epoch 5
Loss = 1.8568e-01, PNorm = 43.7674, GNorm = 3.4611, lr_0 = 8.7118e-04
Loss = 2.7209e-01, PNorm = 43.8082, GNorm = 1.5205, lr_0 = 8.5317e-04
Validation rmse = 0.128018
Epoch 6
Loss = 2.2733e-01, PNorm = 43.8519, GNorm = 2.1711, lr_0 = 8.3378e-04
Loss = 2.9451e-01, PNorm = 43.8843, GNorm = 1.9596, lr_0 = 8.1654e-04
Validation rmse = 0.210039
Epoch 7
Loss = 3.2909e-01, PNorm = 43.9368, GNorm = 6.5922, lr_0 = 7.9966e-04
Loss = 2.8839e-01, PNorm = 43.9821, GNorm = 3.9780, lr_0 = 7.8312e-04
Validation rmse = 0.133253
Epoch 8
Loss = 2.5208e-01, PNorm = 44.0229, GNorm = 1.5810, lr_0 = 7.6533e-04
Loss = 2.0794e-01, PNorm = 44.0561, GNorm = 0.6689, lr_0 = 7.4950e-04
Validation rmse = 0.139631
Epoch 9
Loss = 1.5851e-01, PNorm = 44.0854, GNorm = 0.5270, lr_0 = 7.3400e-04
Loss = 1.6540e-01, PNorm = 44.1077, GNorm = 1.3963, lr_0 = 7.1883e-04
Validation rmse = 0.123200
Epoch 10
Loss = 1.6223e-01, PNorm = 44.1320, GNorm = 2.4383, lr_0 = 7.0249e-04
Loss = 1.4839e-01, PNorm = 44.1486, GNorm = 0.6806, lr_0 = 6.8797e-04
Validation rmse = 0.128797
Epoch 11
Loss = 1.4877e-01, PNorm = 44.1726, GNorm = 1.1483, lr_0 = 6.7374e-04
Loss = 1.5965e-01, PNorm = 44.1929, GNorm = 0.7015, lr_0 = 6.5981e-04
Validation rmse = 0.123651
Epoch 12
Loss = 1.3455e-01, PNorm = 44.2127, GNorm = 0.7979, lr_0 = 6.4482e-04
Loss = 1.4221e-01, PNorm = 44.2298, GNorm = 1.8214, lr_0 = 6.3148e-04
Validation rmse = 0.136381
Epoch 13
Loss = 1.1805e-01, PNorm = 44.2545, GNorm = 0.5169, lr_0 = 6.1714e-04
Loss = 1.5843e-01, PNorm = 44.2710, GNorm = 0.7272, lr_0 = 6.0438e-04
Validation rmse = 0.148730
Epoch 14
Loss = 1.4370e-01, PNorm = 44.2890, GNorm = 2.3505, lr_0 = 5.9188e-04
Loss = 1.6459e-01, PNorm = 44.3125, GNorm = 2.2489, lr_0 = 5.7964e-04
Validation rmse = 0.127585
Epoch 15
Loss = 1.5120e-01, PNorm = 44.3404, GNorm = 2.9863, lr_0 = 5.6647e-04
Loss = 1.4975e-01, PNorm = 44.3616, GNorm = 0.7696, lr_0 = 5.5476e-04
Validation rmse = 0.156283
Epoch 16
Loss = 1.2633e-01, PNorm = 44.3749, GNorm = 1.4334, lr_0 = 5.4328e-04
Loss = 1.2699e-01, PNorm = 44.3940, GNorm = 2.9833, lr_0 = 5.3205e-04
Loss = 1.8846e-01, PNorm = 44.3958, GNorm = 2.6394, lr_0 = 5.3094e-04
Validation rmse = 0.150807
Epoch 17
Loss = 1.2861e-01, PNorm = 44.4131, GNorm = 2.4410, lr_0 = 5.1996e-04
Loss = 1.3190e-01, PNorm = 44.4319, GNorm = 0.9332, lr_0 = 5.0921e-04
Validation rmse = 0.120937
Epoch 18
Loss = 1.2218e-01, PNorm = 44.4463, GNorm = 1.5666, lr_0 = 4.9868e-04
Validation rmse = 0.135934
Epoch 19
Loss = 1.2922e-01, PNorm = 44.4641, GNorm = 0.9346, lr_0 = 4.8735e-04
Loss = 1.0848e-01, PNorm = 44.4805, GNorm = 0.8132, lr_0 = 4.7727e-04
Validation rmse = 0.143750
Epoch 20
Loss = 1.4907e-01, PNorm = 44.4955, GNorm = 0.7238, lr_0 = 4.6740e-04
Loss = 1.2326e-01, PNorm = 44.5096, GNorm = 1.8278, lr_0 = 4.5774e-04
Validation rmse = 0.171714
Epoch 21
Loss = 1.1801e-01, PNorm = 44.5258, GNorm = 3.3112, lr_0 = 4.4734e-04
Loss = 1.2515e-01, PNorm = 44.5431, GNorm = 2.0979, lr_0 = 4.3809e-04
Validation rmse = 0.182840
Epoch 22
Loss = 1.2331e-01, PNorm = 44.5611, GNorm = 0.9229, lr_0 = 4.2903e-04
Loss = 1.1592e-01, PNorm = 44.5791, GNorm = 1.4144, lr_0 = 4.2016e-04
Validation rmse = 0.166600
Epoch 23
Loss = 8.7911e-02, PNorm = 44.5922, GNorm = 0.7701, lr_0 = 4.1061e-04
Loss = 1.1397e-01, PNorm = 44.6074, GNorm = 1.0336, lr_0 = 4.0212e-04
Validation rmse = 0.145963
Epoch 24
Loss = 1.1157e-01, PNorm = 44.6219, GNorm = 1.7882, lr_0 = 3.9381e-04
Loss = 1.1002e-01, PNorm = 44.6351, GNorm = 0.7885, lr_0 = 3.8566e-04
Validation rmse = 0.149220
Epoch 25
Loss = 1.1327e-01, PNorm = 44.6530, GNorm = 1.0739, lr_0 = 3.7690e-04
Loss = 1.0386e-01, PNorm = 44.6652, GNorm = 2.1136, lr_0 = 3.6911e-04
Validation rmse = 0.139074
Epoch 26
Loss = 1.0352e-01, PNorm = 44.6797, GNorm = 1.1356, lr_0 = 3.6072e-04
Loss = 9.5481e-02, PNorm = 44.6922, GNorm = 1.4650, lr_0 = 3.5326e-04
Validation rmse = 0.129289
Epoch 27
Loss = 7.0523e-02, PNorm = 44.7036, GNorm = 1.4688, lr_0 = 3.4596e-04
Loss = 1.1265e-01, PNorm = 44.7179, GNorm = 1.0783, lr_0 = 3.3880e-04
Validation rmse = 0.142611
Epoch 28
Loss = 9.4930e-02, PNorm = 44.7318, GNorm = 1.1997, lr_0 = 3.3110e-04
Loss = 1.0236e-01, PNorm = 44.7443, GNorm = 0.6212, lr_0 = 3.2426e-04
Validation rmse = 0.146674
Epoch 29
Loss = 8.9033e-02, PNorm = 44.7571, GNorm = 1.2609, lr_0 = 3.1755e-04
Loss = 9.9828e-02, PNorm = 44.7700, GNorm = 1.9566, lr_0 = 3.1099e-04
Validation rmse = 0.145512
Epoch 30
Loss = 9.5331e-02, PNorm = 44.7827, GNorm = 1.8264, lr_0 = 3.0392e-04
Loss = 8.8870e-02, PNorm = 44.7936, GNorm = 1.0526, lr_0 = 2.9764e-04
Validation rmse = 0.163584
Epoch 31
Loss = 8.8296e-02, PNorm = 44.8057, GNorm = 2.2104, lr_0 = 2.9148e-04
Loss = 9.3536e-02, PNorm = 44.8183, GNorm = 0.8769, lr_0 = 2.8545e-04
Validation rmse = 0.158227
Epoch 32
Loss = 9.2497e-02, PNorm = 44.8291, GNorm = 1.6484, lr_0 = 2.7897e-04
Loss = 8.2799e-02, PNorm = 44.8403, GNorm = 0.4538, lr_0 = 2.7320e-04
Validation rmse = 0.150883
Epoch 33
Loss = 8.0912e-02, PNorm = 44.8523, GNorm = 0.7324, lr_0 = 2.6755e-04
Loss = 8.5759e-02, PNorm = 44.8641, GNorm = 2.8405, lr_0 = 2.6202e-04
Validation rmse = 0.168607
Epoch 34
Loss = 9.1544e-02, PNorm = 44.8752, GNorm = 0.5190, lr_0 = 2.5606e-04
Loss = 8.7826e-02, PNorm = 44.8876, GNorm = 0.7273, lr_0 = 2.5077e-04
Validation rmse = 0.147048
Epoch 35
Loss = 8.1059e-02, PNorm = 44.8970, GNorm = 1.4432, lr_0 = 2.4558e-04
Loss = 8.9214e-02, PNorm = 44.9079, GNorm = 1.3047, lr_0 = 2.4051e-04
Loss = 3.7644e-02, PNorm = 44.9092, GNorm = 1.6813, lr_0 = 2.4000e-04
Validation rmse = 0.146247
Epoch 36
Loss = 7.6457e-02, PNorm = 44.9191, GNorm = 1.3537, lr_0 = 2.3504e-04
Loss = 8.4110e-02, PNorm = 44.9299, GNorm = 0.8113, lr_0 = 2.3018e-04
Validation rmse = 0.151181
Epoch 37
Loss = 7.7785e-02, PNorm = 44.9384, GNorm = 1.0365, lr_0 = 2.2542e-04
Validation rmse = 0.142466
Epoch 38
Loss = 4.2397e-02, PNorm = 44.9486, GNorm = 0.4649, lr_0 = 2.2030e-04
Loss = 6.6205e-02, PNorm = 44.9585, GNorm = 0.5992, lr_0 = 2.1574e-04
Validation rmse = 0.144460
Epoch 39
Loss = 6.9809e-02, PNorm = 44.9685, GNorm = 1.2589, lr_0 = 2.1084e-04
Loss = 7.5253e-02, PNorm = 44.9787, GNorm = 1.7805, lr_0 = 2.0648e-04
Validation rmse = 0.138063
Epoch 40
Loss = 5.5952e-02, PNorm = 44.9879, GNorm = 0.6938, lr_0 = 2.0221e-04
Loss = 7.8968e-02, PNorm = 44.9974, GNorm = 0.7571, lr_0 = 1.9803e-04
Validation rmse = 0.149086
Epoch 41
Loss = 6.7958e-02, PNorm = 45.0071, GNorm = 0.4307, lr_0 = 1.9353e-04
Loss = 6.7601e-02, PNorm = 45.0151, GNorm = 0.4695, lr_0 = 1.8953e-04
Validation rmse = 0.134026
Epoch 42
Loss = 6.2157e-02, PNorm = 45.0236, GNorm = 0.7243, lr_0 = 1.8561e-04
Loss = 7.7638e-02, PNorm = 45.0329, GNorm = 1.2225, lr_0 = 1.8177e-04
Validation rmse = 0.141001
Epoch 43
Loss = 6.7520e-02, PNorm = 45.0417, GNorm = 0.7928, lr_0 = 1.7764e-04
Loss = 6.6387e-02, PNorm = 45.0502, GNorm = 1.2099, lr_0 = 1.7397e-04
Validation rmse = 0.145017
Epoch 44
Loss = 5.5227e-02, PNorm = 45.0580, GNorm = 0.8582, lr_0 = 1.7037e-04
Loss = 7.4101e-02, PNorm = 45.0663, GNorm = 0.8625, lr_0 = 1.6685e-04
Validation rmse = 0.157898
Epoch 45
Loss = 6.0438e-02, PNorm = 45.0744, GNorm = 1.3932, lr_0 = 1.6306e-04
Loss = 7.5390e-02, PNorm = 45.0823, GNorm = 1.2519, lr_0 = 1.5969e-04
Validation rmse = 0.162645
Epoch 46
Loss = 5.7263e-02, PNorm = 45.0898, GNorm = 0.8426, lr_0 = 1.5638e-04
Loss = 7.6024e-02, PNorm = 45.0968, GNorm = 1.5519, lr_0 = 1.5315e-04
Validation rmse = 0.144843
Epoch 47
Loss = 6.1053e-02, PNorm = 45.1043, GNorm = 0.7609, lr_0 = 1.4967e-04
Loss = 6.7995e-02, PNorm = 45.1116, GNorm = 1.2029, lr_0 = 1.4658e-04
Validation rmse = 0.147866
Epoch 48
Loss = 5.6434e-02, PNorm = 45.1181, GNorm = 0.8450, lr_0 = 1.4354e-04
Loss = 6.1853e-02, PNorm = 45.1244, GNorm = 0.6505, lr_0 = 1.4058e-04
Validation rmse = 0.143875
Epoch 49
Loss = 5.9009e-02, PNorm = 45.1316, GNorm = 1.0931, lr_0 = 1.3738e-04
Loss = 6.7426e-02, PNorm = 45.1375, GNorm = 0.6521, lr_0 = 1.3454e-04
Validation rmse = 0.137646
Epoch 50
Loss = 6.0035e-02, PNorm = 45.1436, GNorm = 0.8937, lr_0 = 1.3176e-04
Loss = 6.3819e-02, PNorm = 45.1498, GNorm = 0.7522, lr_0 = 1.2904e-04
Validation rmse = 0.162772
Epoch 51
Loss = 5.9409e-02, PNorm = 45.1568, GNorm = 1.3534, lr_0 = 1.2610e-04
Loss = 6.0538e-02, PNorm = 45.1619, GNorm = 1.7256, lr_0 = 1.2350e-04
Validation rmse = 0.149144
Epoch 52
Loss = 4.8637e-02, PNorm = 45.1677, GNorm = 1.1959, lr_0 = 1.2069e-04
Loss = 6.7250e-02, PNorm = 45.1724, GNorm = 0.7574, lr_0 = 1.1819e-04
Validation rmse = 0.136022
Epoch 53
Loss = 5.8325e-02, PNorm = 45.1782, GNorm = 1.4146, lr_0 = 1.1575e-04
Loss = 5.7904e-02, PNorm = 45.1836, GNorm = 1.2485, lr_0 = 1.1336e-04
Loss = 1.2547e-01, PNorm = 45.1842, GNorm = 2.0992, lr_0 = 1.1312e-04
Validation rmse = 0.158355
Epoch 54
Loss = 6.3889e-02, PNorm = 45.1903, GNorm = 1.2592, lr_0 = 1.1078e-04
Loss = 5.1389e-02, PNorm = 45.1949, GNorm = 1.0463, lr_0 = 1.0849e-04
Validation rmse = 0.144168
Epoch 55
Loss = 5.4355e-02, PNorm = 45.1992, GNorm = 0.5835, lr_0 = 1.0625e-04
Validation rmse = 0.152340
Epoch 56
Loss = 7.8325e-02, PNorm = 45.2048, GNorm = 0.8010, lr_0 = 1.0383e-04
Loss = 5.4561e-02, PNorm = 45.2099, GNorm = 0.6634, lr_0 = 1.0169e-04
Validation rmse = 0.155741
Epoch 57
Loss = 5.2015e-02, PNorm = 45.2147, GNorm = 0.6770, lr_0 = 1.0000e-04
Loss = 5.1221e-02, PNorm = 45.2199, GNorm = 0.7121, lr_0 = 1.0000e-04
Validation rmse = 0.162839
Epoch 58
Loss = 4.3900e-02, PNorm = 45.2246, GNorm = 0.5244, lr_0 = 1.0000e-04
Loss = 5.5371e-02, PNorm = 45.2277, GNorm = 1.3013, lr_0 = 1.0000e-04
Validation rmse = 0.157015
Epoch 59
Loss = 5.0223e-02, PNorm = 45.2330, GNorm = 0.7105, lr_0 = 1.0000e-04
Loss = 5.9783e-02, PNorm = 45.2396, GNorm = 1.2660, lr_0 = 1.0000e-04
Validation rmse = 0.146459
Model 0 best validation rmse = 0.120937 on epoch 17
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.751905
Ensemble test rmse = 0.751905
1-fold cross validation
	Seed 0 ==> test rmse = 0.751905
Overall test rmse = 0.751905 +/- 0.000000
Elapsed time = 0:00:42
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/Acet_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/Acet_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/Acet_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 936 | train size = 926 | val size = 10 | test size = 96
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 8.9511e-01, PNorm = 43.2630, GNorm = 5.5573, lr_0 = 3.7500e-04
Validation rmse = 0.199644
Epoch 1
Loss = 7.3015e-01, PNorm = 43.2846, GNorm = 1.6166, lr_0 = 6.5000e-04
Loss = 6.9942e-01, PNorm = 43.3358, GNorm = 2.3006, lr_0 = 9.0000e-04
Validation rmse = 0.349273
Epoch 2
Loss = 8.0658e-01, PNorm = 43.4139, GNorm = 11.2278, lr_0 = 9.8685e-04
Loss = 4.2698e-01, PNorm = 43.4863, GNorm = 0.8226, lr_0 = 9.6533e-04
Validation rmse = 0.150685
Epoch 3
Loss = 5.2044e-01, PNorm = 43.5565, GNorm = 6.5864, lr_0 = 9.4219e-04
Loss = 3.6397e-01, PNorm = 43.6219, GNorm = 4.3214, lr_0 = 9.2164e-04
Validation rmse = 0.160002
Epoch 4
Loss = 2.7632e-01, PNorm = 43.6780, GNorm = 4.1775, lr_0 = 9.0153e-04
Loss = 2.0603e-01, PNorm = 43.7302, GNorm = 0.7941, lr_0 = 8.8187e-04
Validation rmse = 0.069831
Epoch 5
Loss = 1.8716e-01, PNorm = 43.7809, GNorm = 4.9856, lr_0 = 8.6073e-04
Loss = 2.2350e-01, PNorm = 43.8235, GNorm = 2.2216, lr_0 = 8.4195e-04
Validation rmse = 0.057308
Epoch 6
Loss = 1.8676e-01, PNorm = 43.8559, GNorm = 1.5858, lr_0 = 8.2359e-04
Validation rmse = 0.052384
Epoch 7
Loss = 1.5338e-01, PNorm = 43.9011, GNorm = 3.0441, lr_0 = 8.0385e-04
Loss = 1.7324e-01, PNorm = 43.9412, GNorm = 1.5452, lr_0 = 7.8631e-04
Validation rmse = 0.053327
Epoch 8
Loss = 1.8525e-01, PNorm = 43.9683, GNorm = 1.5347, lr_0 = 7.6916e-04
Loss = 1.4662e-01, PNorm = 43.9946, GNorm = 0.7078, lr_0 = 7.5238e-04
Validation rmse = 0.135000
Epoch 9
Loss = 1.3038e-01, PNorm = 44.0265, GNorm = 1.0501, lr_0 = 7.3435e-04
Loss = 1.3957e-01, PNorm = 44.0478, GNorm = 2.3125, lr_0 = 7.1833e-04
Validation rmse = 0.073772
Epoch 10
Loss = 1.1696e-01, PNorm = 44.0709, GNorm = 1.0707, lr_0 = 7.0266e-04
Loss = 1.4353e-01, PNorm = 44.0958, GNorm = 1.0803, lr_0 = 6.8733e-04
Validation rmse = 0.152407
Epoch 11
Loss = 1.3106e-01, PNorm = 44.1238, GNorm = 2.7921, lr_0 = 6.7085e-04
Loss = 1.2858e-01, PNorm = 44.1453, GNorm = 3.1374, lr_0 = 6.5622e-04
Validation rmse = 0.110420
Epoch 12
Loss = 1.3069e-01, PNorm = 44.1779, GNorm = 2.4742, lr_0 = 6.4191e-04
Loss = 1.2426e-01, PNorm = 44.1975, GNorm = 2.0630, lr_0 = 6.2790e-04
Loss = 1.2658e-01, PNorm = 44.1996, GNorm = 1.2021, lr_0 = 6.2652e-04
Validation rmse = 0.092659
Epoch 13
Loss = 1.0045e-01, PNorm = 44.2220, GNorm = 0.7424, lr_0 = 6.1285e-04
Validation rmse = 0.119045
Epoch 14
Loss = 9.0132e-02, PNorm = 44.2417, GNorm = 2.2614, lr_0 = 5.9948e-04
Loss = 1.0794e-01, PNorm = 44.2613, GNorm = 1.8912, lr_0 = 5.8641e-04
Validation rmse = 0.065840
Epoch 15
Loss = 1.1425e-01, PNorm = 44.2789, GNorm = 1.4694, lr_0 = 5.7235e-04
Loss = 1.1010e-01, PNorm = 44.2960, GNorm = 1.7766, lr_0 = 5.5987e-04
Validation rmse = 0.104192
Epoch 16
Loss = 9.8929e-02, PNorm = 44.3119, GNorm = 0.7633, lr_0 = 5.4765e-04
Loss = 1.0606e-01, PNorm = 44.3278, GNorm = 3.6031, lr_0 = 5.3571e-04
Validation rmse = 0.086344
Epoch 17
Loss = 9.3761e-02, PNorm = 44.3487, GNorm = 0.4640, lr_0 = 5.2287e-04
Loss = 1.0066e-01, PNorm = 44.3645, GNorm = 0.6199, lr_0 = 5.1146e-04
Validation rmse = 0.118424
Epoch 18
Loss = 1.0576e-01, PNorm = 44.3797, GNorm = 1.8257, lr_0 = 5.0030e-04
Loss = 8.2395e-02, PNorm = 44.3927, GNorm = 0.3795, lr_0 = 4.8939e-04
Validation rmse = 0.109493
Epoch 19
Loss = 1.0516e-01, PNorm = 44.4109, GNorm = 2.7488, lr_0 = 4.7766e-04
Loss = 9.5656e-02, PNorm = 44.4251, GNorm = 1.5051, lr_0 = 4.6724e-04
Validation rmse = 0.105891
Epoch 20
Loss = 8.3247e-02, PNorm = 44.4398, GNorm = 0.5248, lr_0 = 4.5705e-04
Validation rmse = 0.092527
Epoch 21
Loss = 5.8204e-02, PNorm = 44.4564, GNorm = 0.7925, lr_0 = 4.4609e-04
Loss = 8.9902e-02, PNorm = 44.4685, GNorm = 0.8625, lr_0 = 4.3636e-04
Validation rmse = 0.113560
Epoch 22
Loss = 8.6947e-02, PNorm = 44.4806, GNorm = 2.2512, lr_0 = 4.2684e-04
Loss = 8.2189e-02, PNorm = 44.4953, GNorm = 0.6371, lr_0 = 4.1753e-04
Validation rmse = 0.082616
Epoch 23
Loss = 9.6666e-02, PNorm = 44.5130, GNorm = 1.6199, lr_0 = 4.0752e-04
Loss = 9.3365e-02, PNorm = 44.5278, GNorm = 2.0477, lr_0 = 3.9863e-04
Validation rmse = 0.106482
Epoch 24
Loss = 8.2707e-02, PNorm = 44.5408, GNorm = 1.9270, lr_0 = 3.8994e-04
Loss = 8.7175e-02, PNorm = 44.5533, GNorm = 0.6993, lr_0 = 3.8143e-04
Validation rmse = 0.101496
Epoch 25
Loss = 7.9548e-02, PNorm = 44.5671, GNorm = 2.8782, lr_0 = 3.7311e-04
Loss = 7.2600e-02, PNorm = 44.5800, GNorm = 0.7106, lr_0 = 3.6497e-04
Validation rmse = 0.094301
Epoch 26
Loss = 7.1592e-02, PNorm = 44.5934, GNorm = 1.0363, lr_0 = 3.5622e-04
Loss = 8.3866e-02, PNorm = 44.6046, GNorm = 1.6916, lr_0 = 3.4845e-04
Validation rmse = 0.125239
Epoch 27
Loss = 9.0760e-02, PNorm = 44.6188, GNorm = 2.5032, lr_0 = 3.4085e-04
Validation rmse = 0.091309
Epoch 28
Loss = 8.5967e-02, PNorm = 44.6294, GNorm = 0.6314, lr_0 = 3.3268e-04
Loss = 7.4683e-02, PNorm = 44.6421, GNorm = 1.0484, lr_0 = 3.2543e-04
Validation rmse = 0.117177
Epoch 29
Loss = 6.7024e-02, PNorm = 44.6519, GNorm = 0.6934, lr_0 = 3.1833e-04
Loss = 7.5093e-02, PNorm = 44.6619, GNorm = 1.0621, lr_0 = 3.1138e-04
Validation rmse = 0.106378
Epoch 30
Loss = 7.4814e-02, PNorm = 44.6735, GNorm = 2.4630, lr_0 = 3.0392e-04
Loss = 6.5012e-02, PNorm = 44.6842, GNorm = 1.1649, lr_0 = 2.9729e-04
Validation rmse = 0.116042
Epoch 31
Loss = 7.7613e-02, PNorm = 44.6937, GNorm = 1.5844, lr_0 = 2.9080e-04
Loss = 7.5456e-02, PNorm = 44.7053, GNorm = 2.0368, lr_0 = 2.8446e-04
Validation rmse = 0.119098
Epoch 32
Loss = 8.7907e-02, PNorm = 44.7173, GNorm = 2.1395, lr_0 = 2.7764e-04
Loss = 7.6429e-02, PNorm = 44.7284, GNorm = 0.6256, lr_0 = 2.7159e-04
Validation rmse = 0.103565
Epoch 33
Loss = 6.6919e-02, PNorm = 44.7390, GNorm = 0.6980, lr_0 = 2.6566e-04
Validation rmse = 0.105265
Epoch 34
Loss = 8.8720e-02, PNorm = 44.7485, GNorm = 1.4840, lr_0 = 2.5929e-04
Loss = 6.9342e-02, PNorm = 44.7585, GNorm = 2.4700, lr_0 = 2.5364e-04
Validation rmse = 0.088885
Epoch 35
Loss = 5.4994e-02, PNorm = 44.7667, GNorm = 0.5200, lr_0 = 2.4811e-04
Loss = 6.7134e-02, PNorm = 44.7762, GNorm = 1.1821, lr_0 = 2.4269e-04
Validation rmse = 0.093876
Epoch 36
Loss = 5.8350e-02, PNorm = 44.7845, GNorm = 0.9612, lr_0 = 2.3688e-04
Loss = 6.2801e-02, PNorm = 44.7918, GNorm = 0.9349, lr_0 = 2.3171e-04
Validation rmse = 0.095485
Epoch 37
Loss = 7.2514e-02, PNorm = 44.7989, GNorm = 0.8401, lr_0 = 2.2665e-04
Loss = 5.4310e-02, PNorm = 44.8066, GNorm = 0.5529, lr_0 = 2.2171e-04
Validation rmse = 0.098387
Epoch 38
Loss = 5.2756e-02, PNorm = 44.8138, GNorm = 1.3108, lr_0 = 2.1640e-04
Loss = 6.9302e-02, PNorm = 44.8229, GNorm = 2.3745, lr_0 = 2.1168e-04
Validation rmse = 0.089802
Epoch 39
Loss = 5.1094e-02, PNorm = 44.8283, GNorm = 1.0978, lr_0 = 2.0706e-04
Loss = 6.1525e-02, PNorm = 44.8353, GNorm = 0.6826, lr_0 = 2.0254e-04
Loss = 7.8925e-02, PNorm = 44.8362, GNorm = 1.8663, lr_0 = 2.0209e-04
Validation rmse = 0.092091
Epoch 40
Loss = 4.9769e-02, PNorm = 44.8423, GNorm = 0.6015, lr_0 = 1.9769e-04
Validation rmse = 0.095148
Epoch 41
Loss = 5.9420e-02, PNorm = 44.8499, GNorm = 1.4437, lr_0 = 1.9337e-04
Loss = 5.5423e-02, PNorm = 44.8566, GNorm = 0.8794, lr_0 = 1.8916e-04
Validation rmse = 0.089833
Epoch 42
Loss = 4.8774e-02, PNorm = 44.8634, GNorm = 1.9400, lr_0 = 1.8462e-04
Loss = 5.6351e-02, PNorm = 44.8696, GNorm = 1.2761, lr_0 = 1.8059e-04
Validation rmse = 0.099810
Epoch 43
Loss = 4.2778e-02, PNorm = 44.8763, GNorm = 0.8655, lr_0 = 1.7666e-04
Loss = 5.6410e-02, PNorm = 44.8817, GNorm = 0.7577, lr_0 = 1.7280e-04
Validation rmse = 0.090887
Epoch 44
Loss = 6.1425e-02, PNorm = 44.8878, GNorm = 2.3653, lr_0 = 1.6866e-04
Loss = 5.7344e-02, PNorm = 44.8936, GNorm = 1.7312, lr_0 = 1.6498e-04
Validation rmse = 0.095035
Epoch 45
Loss = 5.4319e-02, PNorm = 44.8999, GNorm = 1.3702, lr_0 = 1.6138e-04
Loss = 5.5610e-02, PNorm = 44.9056, GNorm = 1.0967, lr_0 = 1.5786e-04
Validation rmse = 0.096724
Epoch 46
Loss = 5.0049e-02, PNorm = 44.9124, GNorm = 1.0977, lr_0 = 1.5408e-04
Loss = 5.0726e-02, PNorm = 44.9168, GNorm = 1.1082, lr_0 = 1.5072e-04
Validation rmse = 0.103449
Epoch 47
Loss = 5.0187e-02, PNorm = 44.9219, GNorm = 1.0962, lr_0 = 1.4743e-04
Validation rmse = 0.097732
Epoch 48
Loss = 3.1923e-02, PNorm = 44.9267, GNorm = 0.8579, lr_0 = 1.4390e-04
Loss = 5.5304e-02, PNorm = 44.9332, GNorm = 0.6817, lr_0 = 1.4076e-04
Validation rmse = 0.097323
Epoch 49
Loss = 5.7471e-02, PNorm = 44.9369, GNorm = 0.6441, lr_0 = 1.3769e-04
Loss = 5.0582e-02, PNorm = 44.9403, GNorm = 1.0661, lr_0 = 1.3468e-04
Validation rmse = 0.090112
Epoch 50
Loss = 5.4176e-02, PNorm = 44.9450, GNorm = 1.2515, lr_0 = 1.3174e-04
Loss = 5.3860e-02, PNorm = 44.9497, GNorm = 1.0065, lr_0 = 1.2887e-04
Validation rmse = 0.107125
Epoch 51
Loss = 5.4236e-02, PNorm = 44.9544, GNorm = 2.4293, lr_0 = 1.2578e-04
Loss = 4.8426e-02, PNorm = 44.9580, GNorm = 0.9951, lr_0 = 1.2304e-04
Validation rmse = 0.096840
Epoch 52
Loss = 4.4107e-02, PNorm = 44.9631, GNorm = 0.8310, lr_0 = 1.2035e-04
Loss = 4.7687e-02, PNorm = 44.9677, GNorm = 1.0172, lr_0 = 1.1773e-04
Validation rmse = 0.100934
Epoch 53
Loss = 4.0257e-02, PNorm = 44.9711, GNorm = 0.6092, lr_0 = 1.1491e-04
Loss = 4.9764e-02, PNorm = 44.9747, GNorm = 0.9123, lr_0 = 1.1240e-04
Validation rmse = 0.094724
Epoch 54
Loss = 4.2063e-02, PNorm = 44.9780, GNorm = 0.6074, lr_0 = 1.0995e-04
Validation rmse = 0.097889
Epoch 55
Loss = 4.2691e-02, PNorm = 44.9818, GNorm = 0.7037, lr_0 = 1.0731e-04
Loss = 4.5769e-02, PNorm = 44.9855, GNorm = 0.4772, lr_0 = 1.0497e-04
Validation rmse = 0.094012
Epoch 56
Loss = 4.7840e-02, PNorm = 44.9890, GNorm = 0.8292, lr_0 = 1.0268e-04
Loss = 4.2789e-02, PNorm = 44.9920, GNorm = 0.9790, lr_0 = 1.0044e-04
Validation rmse = 0.093717
Epoch 57
Loss = 4.6453e-02, PNorm = 44.9949, GNorm = 0.6470, lr_0 = 1.0000e-04
Loss = 4.2476e-02, PNorm = 44.9985, GNorm = 1.2851, lr_0 = 1.0000e-04
Validation rmse = 0.110297
Epoch 58
Loss = 4.3166e-02, PNorm = 45.0022, GNorm = 1.1791, lr_0 = 1.0000e-04
Loss = 5.7333e-02, PNorm = 45.0054, GNorm = 0.8874, lr_0 = 1.0000e-04
Validation rmse = 0.091075
Epoch 59
Loss = 5.3471e-02, PNorm = 45.0084, GNorm = 2.2897, lr_0 = 1.0000e-04
Loss = 4.4985e-02, PNorm = 45.0124, GNorm = 0.9905, lr_0 = 1.0000e-04
Validation rmse = 0.098202
Model 0 best validation rmse = 0.052384 on epoch 6
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.261058
Ensemble test rmse = 0.261058
1-fold cross validation
	Seed 0 ==> test rmse = 0.261058
Overall test rmse = 0.261058 +/- 0.000000
Elapsed time = 0:00:40
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/MeCN_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/MeCN_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/MeCN_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 916 | train size = 906 | val size = 10 | test size = 116
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.1066e-01, PNorm = 43.2648, GNorm = 2.0844, lr_0 = 3.7500e-04
Validation rmse = 0.353156
Epoch 1
Loss = 8.9916e-01, PNorm = 43.2928, GNorm = 9.2525, lr_0 = 6.5000e-04
Loss = 5.9269e-01, PNorm = 43.3377, GNorm = 7.3462, lr_0 = 9.0000e-04
Validation rmse = 0.233684
Epoch 2
Loss = 5.1726e-01, PNorm = 43.4122, GNorm = 2.2691, lr_0 = 9.8468e-04
Loss = 3.9248e-01, PNorm = 43.4932, GNorm = 10.8177, lr_0 = 9.6320e-04
Validation rmse = 0.290787
Epoch 3
Loss = 3.8181e-01, PNorm = 43.5765, GNorm = 1.3302, lr_0 = 9.4011e-04
Loss = 3.7524e-01, PNorm = 43.6484, GNorm = 2.5122, lr_0 = 9.1961e-04
Validation rmse = 0.241476
Epoch 4
Loss = 3.2330e-01, PNorm = 43.7141, GNorm = 0.4965, lr_0 = 8.9756e-04
Loss = 3.2667e-01, PNorm = 43.7685, GNorm = 6.5923, lr_0 = 8.7798e-04
Loss = 3.3464e-01, PNorm = 43.7754, GNorm = 5.7109, lr_0 = 8.7605e-04
Validation rmse = 0.202792
Epoch 5
Loss = 2.3384e-01, PNorm = 43.8293, GNorm = 2.2712, lr_0 = 8.5694e-04
Validation rmse = 0.132110
Epoch 6
Loss = 1.8450e-01, PNorm = 43.8766, GNorm = 1.3392, lr_0 = 8.3640e-04
Loss = 2.0030e-01, PNorm = 43.9210, GNorm = 5.5669, lr_0 = 8.1815e-04
Validation rmse = 0.148075
Epoch 7
Loss = 1.6917e-01, PNorm = 43.9566, GNorm = 4.4457, lr_0 = 7.9854e-04
Loss = 1.8206e-01, PNorm = 43.9879, GNorm = 1.0202, lr_0 = 7.8112e-04
Validation rmse = 0.139039
Epoch 8
Loss = 1.6952e-01, PNorm = 44.0195, GNorm = 1.6454, lr_0 = 7.6240e-04
Loss = 1.3492e-01, PNorm = 44.0431, GNorm = 2.3217, lr_0 = 7.4577e-04
Validation rmse = 0.184313
Epoch 9
Loss = 1.3988e-01, PNorm = 44.0729, GNorm = 0.8017, lr_0 = 7.2950e-04
Loss = 1.4864e-01, PNorm = 44.0938, GNorm = 3.9126, lr_0 = 7.1359e-04
Validation rmse = 0.199952
Epoch 10
Loss = 1.3391e-01, PNorm = 44.1198, GNorm = 3.9684, lr_0 = 6.9649e-04
Validation rmse = 0.155887
Epoch 11
Loss = 1.1341e-01, PNorm = 44.1395, GNorm = 2.0183, lr_0 = 6.7979e-04
Loss = 1.3154e-01, PNorm = 44.1603, GNorm = 1.2542, lr_0 = 6.6496e-04
Validation rmse = 0.153080
Epoch 12
Loss = 1.7912e-01, PNorm = 44.1813, GNorm = 2.4919, lr_0 = 6.4902e-04
Loss = 1.1157e-01, PNorm = 44.2035, GNorm = 2.1455, lr_0 = 6.3487e-04
Validation rmse = 0.183928
Epoch 13
Loss = 1.2342e-01, PNorm = 44.2189, GNorm = 2.8251, lr_0 = 6.1965e-04
Loss = 1.4266e-01, PNorm = 44.2387, GNorm = 3.1562, lr_0 = 6.0613e-04
Validation rmse = 0.176506
Epoch 14
Loss = 1.5608e-01, PNorm = 44.2582, GNorm = 6.6604, lr_0 = 5.9160e-04
Loss = 1.3039e-01, PNorm = 44.2823, GNorm = 0.9667, lr_0 = 5.7870e-04
Validation rmse = 0.165596
Epoch 15
Loss = 1.1419e-01, PNorm = 44.3054, GNorm = 1.3770, lr_0 = 5.6483e-04
Validation rmse = 0.143284
Epoch 16
Loss = 1.4349e-01, PNorm = 44.3230, GNorm = 2.3796, lr_0 = 5.5129e-04
Loss = 9.9225e-02, PNorm = 44.3374, GNorm = 2.1570, lr_0 = 5.3926e-04
Validation rmse = 0.172516
Epoch 17
Loss = 8.7755e-02, PNorm = 44.3528, GNorm = 1.4950, lr_0 = 5.2750e-04
Loss = 1.1455e-01, PNorm = 44.3658, GNorm = 2.0671, lr_0 = 5.1599e-04
Validation rmse = 0.152609
Epoch 18
Loss = 1.2243e-01, PNorm = 44.3858, GNorm = 0.9064, lr_0 = 5.0362e-04
Loss = 9.4957e-02, PNorm = 44.4032, GNorm = 0.7093, lr_0 = 4.9264e-04
Validation rmse = 0.153375
Epoch 19
Loss = 1.0595e-01, PNorm = 44.4175, GNorm = 0.8117, lr_0 = 4.8083e-04
Loss = 1.0398e-01, PNorm = 44.4300, GNorm = 1.5661, lr_0 = 4.7034e-04
Validation rmse = 0.152001
Epoch 20
Loss = 1.0994e-01, PNorm = 44.4431, GNorm = 2.3532, lr_0 = 4.5907e-04
Loss = 1.1327e-01, PNorm = 44.4580, GNorm = 0.9707, lr_0 = 4.4905e-04
Loss = 6.8794e-02, PNorm = 44.4599, GNorm = 1.5344, lr_0 = 4.4806e-04
Validation rmse = 0.148297
Epoch 21
Loss = 9.3640e-02, PNorm = 44.4752, GNorm = 1.0787, lr_0 = 4.3829e-04
Validation rmse = 0.153613
Epoch 22
Loss = 1.1273e-01, PNorm = 44.4895, GNorm = 1.3388, lr_0 = 4.2779e-04
Loss = 1.0897e-01, PNorm = 44.5031, GNorm = 1.9836, lr_0 = 4.1845e-04
Validation rmse = 0.150638
Epoch 23
Loss = 1.1118e-01, PNorm = 44.5178, GNorm = 0.5102, lr_0 = 4.0842e-04
Loss = 1.1051e-01, PNorm = 44.5321, GNorm = 0.5637, lr_0 = 3.9951e-04
Validation rmse = 0.174586
Epoch 24
Loss = 1.6091e-01, PNorm = 44.5484, GNorm = 2.7164, lr_0 = 3.8994e-04
Loss = 1.0846e-01, PNorm = 44.5657, GNorm = 1.6511, lr_0 = 3.8143e-04
Validation rmse = 0.163872
Epoch 25
Loss = 9.6856e-02, PNorm = 44.5783, GNorm = 2.2575, lr_0 = 3.7311e-04
Loss = 1.0454e-01, PNorm = 44.5902, GNorm = 1.9515, lr_0 = 3.6497e-04
Validation rmse = 0.145378
Epoch 26
Loss = 7.7935e-02, PNorm = 44.6039, GNorm = 0.4611, lr_0 = 3.5622e-04
Validation rmse = 0.136803
Epoch 27
Loss = 1.0023e-01, PNorm = 44.6143, GNorm = 1.2007, lr_0 = 3.4769e-04
Loss = 8.5849e-02, PNorm = 44.6227, GNorm = 1.2531, lr_0 = 3.4010e-04
Validation rmse = 0.163717
Epoch 28
Loss = 1.0262e-01, PNorm = 44.6340, GNorm = 2.3820, lr_0 = 3.3195e-04
Loss = 1.1559e-01, PNorm = 44.6445, GNorm = 2.9437, lr_0 = 3.2471e-04
Validation rmse = 0.143104
Epoch 29
Loss = 1.1487e-01, PNorm = 44.6584, GNorm = 0.9515, lr_0 = 3.1693e-04
Loss = 9.8885e-02, PNorm = 44.6705, GNorm = 1.3347, lr_0 = 3.1001e-04
Validation rmse = 0.134139
Epoch 30
Loss = 1.0800e-01, PNorm = 44.6832, GNorm = 1.8801, lr_0 = 3.0258e-04
Loss = 9.0352e-02, PNorm = 44.6935, GNorm = 0.4617, lr_0 = 2.9598e-04
Validation rmse = 0.138956
Epoch 31
Loss = 9.0073e-02, PNorm = 44.7104, GNorm = 0.5525, lr_0 = 2.8889e-04
Validation rmse = 0.129979
Epoch 32
Loss = 7.0311e-02, PNorm = 44.7201, GNorm = 1.4677, lr_0 = 2.8196e-04
Loss = 7.4066e-02, PNorm = 44.7273, GNorm = 0.5978, lr_0 = 2.7581e-04
Validation rmse = 0.145593
Epoch 33
Loss = 7.8882e-02, PNorm = 44.7354, GNorm = 0.6012, lr_0 = 2.6920e-04
Loss = 8.0302e-02, PNorm = 44.7435, GNorm = 1.7448, lr_0 = 2.6333e-04
Validation rmse = 0.130324
Epoch 34
Loss = 6.5656e-02, PNorm = 44.7499, GNorm = 0.8917, lr_0 = 2.5758e-04
Loss = 8.1427e-02, PNorm = 44.7587, GNorm = 0.9823, lr_0 = 2.5197e-04
Validation rmse = 0.141262
Epoch 35
Loss = 6.8930e-02, PNorm = 44.7665, GNorm = 1.8848, lr_0 = 2.4593e-04
Loss = 7.1303e-02, PNorm = 44.7741, GNorm = 0.8717, lr_0 = 2.4056e-04
Validation rmse = 0.132474
Epoch 36
Loss = 6.5792e-02, PNorm = 44.7813, GNorm = 0.9602, lr_0 = 2.3480e-04
Loss = 7.7254e-02, PNorm = 44.7878, GNorm = 0.6121, lr_0 = 2.2967e-04
Loss = 2.5203e-02, PNorm = 44.7885, GNorm = 1.3618, lr_0 = 2.2917e-04
Validation rmse = 0.134046
Epoch 37
Loss = 7.0746e-02, PNorm = 44.7961, GNorm = 0.7578, lr_0 = 2.2417e-04
Validation rmse = 0.146073
Epoch 38
Loss = 4.4493e-02, PNorm = 44.8053, GNorm = 0.6580, lr_0 = 2.1880e-04
Loss = 7.5364e-02, PNorm = 44.8122, GNorm = 1.4958, lr_0 = 2.1402e-04
Validation rmse = 0.137837
Epoch 39
Loss = 6.7446e-02, PNorm = 44.8204, GNorm = 1.3580, lr_0 = 2.0889e-04
Loss = 6.8380e-02, PNorm = 44.8288, GNorm = 1.7436, lr_0 = 2.0434e-04
Validation rmse = 0.126225
Epoch 40
Loss = 6.8781e-02, PNorm = 44.8350, GNorm = 0.5782, lr_0 = 1.9944e-04
Loss = 7.3559e-02, PNorm = 44.8415, GNorm = 0.7331, lr_0 = 1.9509e-04
Validation rmse = 0.139440
Epoch 41
Loss = 7.5155e-02, PNorm = 44.8475, GNorm = 0.6533, lr_0 = 1.9041e-04
Loss = 6.1345e-02, PNorm = 44.8543, GNorm = 0.5981, lr_0 = 1.8626e-04
Validation rmse = 0.140115
Epoch 42
Loss = 6.7441e-02, PNorm = 44.8595, GNorm = 0.7034, lr_0 = 1.8219e-04
Validation rmse = 0.161553
Epoch 43
Loss = 5.3646e-02, PNorm = 44.8667, GNorm = 1.3276, lr_0 = 1.7783e-04
Loss = 6.8800e-02, PNorm = 44.8709, GNorm = 1.0326, lr_0 = 1.7395e-04
Validation rmse = 0.137551
Epoch 44
Loss = 5.7544e-02, PNorm = 44.8784, GNorm = 0.5258, lr_0 = 1.6978e-04
Loss = 6.8252e-02, PNorm = 44.8839, GNorm = 1.6003, lr_0 = 1.6608e-04
Validation rmse = 0.142885
Epoch 45
Loss = 6.2271e-02, PNorm = 44.8895, GNorm = 0.5108, lr_0 = 1.6210e-04
Loss = 6.2566e-02, PNorm = 44.8939, GNorm = 0.6984, lr_0 = 1.5856e-04
Validation rmse = 0.139110
Epoch 46
Loss = 6.6026e-02, PNorm = 44.9013, GNorm = 0.5110, lr_0 = 1.5476e-04
Loss = 5.6027e-02, PNorm = 44.9060, GNorm = 0.4591, lr_0 = 1.5138e-04
Validation rmse = 0.137089
Epoch 47
Loss = 5.7264e-02, PNorm = 44.9115, GNorm = 1.0564, lr_0 = 1.4775e-04
Validation rmse = 0.137338
Epoch 48
Loss = 7.5445e-02, PNorm = 44.9178, GNorm = 0.9365, lr_0 = 1.4421e-04
Loss = 6.3378e-02, PNorm = 44.9228, GNorm = 1.4193, lr_0 = 1.4107e-04
Validation rmse = 0.135112
Epoch 49
Loss = 5.9789e-02, PNorm = 44.9274, GNorm = 1.3038, lr_0 = 1.3769e-04
Loss = 5.5842e-02, PNorm = 44.9342, GNorm = 1.1207, lr_0 = 1.3468e-04
Validation rmse = 0.140112
Epoch 50
Loss = 6.7386e-02, PNorm = 44.9382, GNorm = 1.0767, lr_0 = 1.3174e-04
Loss = 5.4990e-02, PNorm = 44.9420, GNorm = 0.9369, lr_0 = 1.2887e-04
Validation rmse = 0.148890
Epoch 51
Loss = 6.1013e-02, PNorm = 44.9472, GNorm = 0.6561, lr_0 = 1.2578e-04
Loss = 5.7384e-02, PNorm = 44.9524, GNorm = 0.7812, lr_0 = 1.2304e-04
Validation rmse = 0.134728
Epoch 52
Loss = 5.5089e-02, PNorm = 44.9578, GNorm = 1.2124, lr_0 = 1.2009e-04
Loss = 5.8685e-02, PNorm = 44.9623, GNorm = 0.7804, lr_0 = 1.1747e-04
Loss = 2.5119e-01, PNorm = 44.9627, GNorm = 4.6219, lr_0 = 1.1721e-04
Validation rmse = 0.138728
Epoch 53
Loss = 6.0509e-02, PNorm = 44.9693, GNorm = 1.4026, lr_0 = 1.1465e-04
Validation rmse = 0.134207
Epoch 54
Loss = 5.8015e-02, PNorm = 44.9733, GNorm = 0.4566, lr_0 = 1.1191e-04
Loss = 5.4561e-02, PNorm = 44.9782, GNorm = 0.6730, lr_0 = 1.0946e-04
Validation rmse = 0.139505
Epoch 55
Loss = 5.0130e-02, PNorm = 44.9829, GNorm = 0.4523, lr_0 = 1.0684e-04
Loss = 5.7549e-02, PNorm = 44.9865, GNorm = 1.2311, lr_0 = 1.0451e-04
Validation rmse = 0.135350
Epoch 56
Loss = 5.7558e-02, PNorm = 44.9905, GNorm = 0.5331, lr_0 = 1.0200e-04
Loss = 5.1808e-02, PNorm = 44.9945, GNorm = 0.7236, lr_0 = 1.0000e-04
Validation rmse = 0.143466
Epoch 57
Loss = 5.5568e-02, PNorm = 44.9978, GNorm = 1.6162, lr_0 = 1.0000e-04
Loss = 5.4361e-02, PNorm = 45.0016, GNorm = 0.8778, lr_0 = 1.0000e-04
Loss = 5.5874e-03, PNorm = 45.0021, GNorm = 0.4951, lr_0 = 1.0000e-04
Validation rmse = 0.134934
Epoch 58
Loss = 5.3461e-02, PNorm = 45.0062, GNorm = 0.6890, lr_0 = 1.0000e-04
Validation rmse = 0.132482
Epoch 59
Loss = 4.9109e-02, PNorm = 45.0090, GNorm = 0.6199, lr_0 = 1.0000e-04
Loss = 5.8209e-02, PNorm = 45.0131, GNorm = 1.3351, lr_0 = 1.0000e-04
Validation rmse = 0.136200
Model 0 best validation rmse = 0.126225 on epoch 39
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.154540
Ensemble test rmse = 0.154540
1-fold cross validation
	Seed 0 ==> test rmse = 0.154540
Overall test rmse = 0.154540 +/- 0.000000
Elapsed time = 0:00:38
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/MTBE_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/MTBE_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/MTBE_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 981 | train size = 971 | val size = 10 | test size = 51
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.3400e-01, PNorm = 43.2653, GNorm = 3.8370, lr_0 = 3.6053e-04
Validation rmse = 0.236751
Epoch 1
Loss = 4.8839e-01, PNorm = 43.2921, GNorm = 3.5302, lr_0 = 6.2105e-04
Loss = 5.8966e-01, PNorm = 43.3272, GNorm = 8.2424, lr_0 = 8.5789e-04
Validation rmse = 0.180714
Epoch 2
Loss = 5.8761e-01, PNorm = 43.3926, GNorm = 1.6623, lr_0 = 9.8961e-04
Loss = 4.6415e-01, PNorm = 43.4557, GNorm = 4.7523, lr_0 = 9.6914e-04
Validation rmse = 0.250763
Epoch 3
Loss = 4.8436e-01, PNorm = 43.5238, GNorm = 6.4163, lr_0 = 9.4910e-04
Loss = 3.9131e-01, PNorm = 43.5877, GNorm = 2.1108, lr_0 = 9.2948e-04
Validation rmse = 0.173593
Epoch 4
Loss = 3.1123e-01, PNorm = 43.6599, GNorm = 4.0402, lr_0 = 9.0836e-04
Loss = 3.0347e-01, PNorm = 43.7244, GNorm = 5.9228, lr_0 = 8.8958e-04
Validation rmse = 0.194304
Epoch 5
Loss = 3.0164e-01, PNorm = 43.7764, GNorm = 7.8499, lr_0 = 8.7118e-04
Loss = 2.4454e-01, PNorm = 43.8239, GNorm = 4.3689, lr_0 = 8.5317e-04
Validation rmse = 0.174693
Epoch 6
Loss = 1.6956e-01, PNorm = 43.8783, GNorm = 1.5829, lr_0 = 8.3378e-04
Loss = 2.0633e-01, PNorm = 43.9213, GNorm = 3.5030, lr_0 = 8.1654e-04
Validation rmse = 0.109784
Epoch 7
Loss = 1.3900e-01, PNorm = 43.9659, GNorm = 4.3171, lr_0 = 7.9799e-04
Loss = 1.9937e-01, PNorm = 43.9982, GNorm = 1.6800, lr_0 = 7.8149e-04
Validation rmse = 0.133975
Epoch 8
Loss = 1.4450e-01, PNorm = 44.0328, GNorm = 3.1632, lr_0 = 7.6533e-04
Loss = 1.4607e-01, PNorm = 44.0729, GNorm = 0.7027, lr_0 = 7.4950e-04
Validation rmse = 0.175670
Epoch 9
Loss = 1.7112e-01, PNorm = 44.1066, GNorm = 2.3740, lr_0 = 7.3247e-04
Loss = 1.3928e-01, PNorm = 44.1325, GNorm = 2.1417, lr_0 = 7.1733e-04
Validation rmse = 0.188501
Epoch 10
Loss = 1.7283e-01, PNorm = 44.1661, GNorm = 2.7072, lr_0 = 7.0249e-04
Loss = 1.8074e-01, PNorm = 44.1933, GNorm = 3.2387, lr_0 = 6.8797e-04
Validation rmse = 0.116485
Epoch 11
Loss = 1.6482e-01, PNorm = 44.2286, GNorm = 1.6645, lr_0 = 6.7234e-04
Loss = 1.6214e-01, PNorm = 44.2652, GNorm = 6.7007, lr_0 = 6.5843e-04
Validation rmse = 0.101656
Epoch 12
Loss = 1.3674e-01, PNorm = 44.2889, GNorm = 1.7597, lr_0 = 6.4482e-04
Loss = 1.2204e-01, PNorm = 44.3095, GNorm = 2.2974, lr_0 = 6.3148e-04
Validation rmse = 0.118777
Epoch 13
Loss = 1.1314e-01, PNorm = 44.3322, GNorm = 0.9227, lr_0 = 6.1714e-04
Loss = 1.3200e-01, PNorm = 44.3469, GNorm = 1.9681, lr_0 = 6.0438e-04
Validation rmse = 0.099837
Epoch 14
Loss = 1.1223e-01, PNorm = 44.3676, GNorm = 0.6159, lr_0 = 5.9064e-04
Loss = 1.1625e-01, PNorm = 44.3871, GNorm = 1.1385, lr_0 = 5.7843e-04
Validation rmse = 0.114670
Epoch 15
Loss = 1.1841e-01, PNorm = 44.4031, GNorm = 2.1020, lr_0 = 5.6647e-04
Loss = 1.1356e-01, PNorm = 44.4214, GNorm = 2.6193, lr_0 = 5.5476e-04
Loss = 1.2301e-01, PNorm = 44.4222, GNorm = 2.9058, lr_0 = 5.5360e-04
Validation rmse = 0.108441
Epoch 16
Loss = 1.2226e-01, PNorm = 44.4361, GNorm = 1.8664, lr_0 = 5.4215e-04
Loss = 1.1215e-01, PNorm = 44.4505, GNorm = 1.2318, lr_0 = 5.3094e-04
Validation rmse = 0.089218
Epoch 17
Loss = 1.1330e-01, PNorm = 44.4677, GNorm = 1.5758, lr_0 = 5.1996e-04
Validation rmse = 0.096348
Epoch 18
Loss = 7.4988e-02, PNorm = 44.4852, GNorm = 2.5330, lr_0 = 5.0815e-04
Loss = 1.1017e-01, PNorm = 44.4995, GNorm = 1.4645, lr_0 = 4.9764e-04
Validation rmse = 0.081787
Epoch 19
Loss = 1.1408e-01, PNorm = 44.5137, GNorm = 3.2545, lr_0 = 4.8633e-04
Loss = 1.0976e-01, PNorm = 44.5251, GNorm = 4.2378, lr_0 = 4.7628e-04
Validation rmse = 0.133692
Epoch 20
Loss = 1.1540e-01, PNorm = 44.5422, GNorm = 0.9986, lr_0 = 4.6643e-04
Loss = 1.0751e-01, PNorm = 44.5586, GNorm = 3.1366, lr_0 = 4.5678e-04
Validation rmse = 0.094870
Epoch 21
Loss = 9.9525e-02, PNorm = 44.5765, GNorm = 0.9220, lr_0 = 4.4640e-04
Loss = 1.1751e-01, PNorm = 44.5922, GNorm = 2.7102, lr_0 = 4.3717e-04
Validation rmse = 0.096033
Epoch 22
Loss = 7.9987e-02, PNorm = 44.6048, GNorm = 1.7534, lr_0 = 4.2813e-04
Loss = 9.2672e-02, PNorm = 44.6183, GNorm = 1.1636, lr_0 = 4.1928e-04
Validation rmse = 0.082593
Epoch 23
Loss = 9.5284e-02, PNorm = 44.6333, GNorm = 0.5754, lr_0 = 4.0975e-04
Loss = 8.1333e-02, PNorm = 44.6466, GNorm = 2.3419, lr_0 = 4.0128e-04
Validation rmse = 0.088582
Epoch 24
Loss = 9.3001e-02, PNorm = 44.6588, GNorm = 1.1759, lr_0 = 3.9298e-04
Loss = 1.0123e-01, PNorm = 44.6720, GNorm = 1.9856, lr_0 = 3.8486e-04
Validation rmse = 0.089025
Epoch 25
Loss = 8.6197e-02, PNorm = 44.6859, GNorm = 0.6691, lr_0 = 3.7611e-04
Loss = 8.5195e-02, PNorm = 44.6953, GNorm = 1.0131, lr_0 = 3.6834e-04
Validation rmse = 0.104073
Epoch 26
Loss = 7.4096e-02, PNorm = 44.7070, GNorm = 2.4275, lr_0 = 3.5997e-04
Loss = 8.2972e-02, PNorm = 44.7180, GNorm = 0.7499, lr_0 = 3.5252e-04
Validation rmse = 0.096309
Epoch 27
Loss = 8.9737e-02, PNorm = 44.7298, GNorm = 0.9553, lr_0 = 3.4523e-04
Loss = 8.1608e-02, PNorm = 44.7399, GNorm = 1.6219, lr_0 = 3.3809e-04
Validation rmse = 0.089372
Epoch 28
Loss = 8.9140e-02, PNorm = 44.7521, GNorm = 2.6103, lr_0 = 3.3041e-04
Loss = 7.7660e-02, PNorm = 44.7623, GNorm = 2.6514, lr_0 = 3.2358e-04
Validation rmse = 0.105242
Epoch 29
Loss = 8.3911e-02, PNorm = 44.7729, GNorm = 1.9003, lr_0 = 3.1689e-04
Loss = 8.6580e-02, PNorm = 44.7834, GNorm = 0.9757, lr_0 = 3.1034e-04
Validation rmse = 0.102536
Epoch 30
Loss = 7.6297e-02, PNorm = 44.7985, GNorm = 1.3146, lr_0 = 3.0329e-04
Loss = 8.7189e-02, PNorm = 44.8101, GNorm = 1.6930, lr_0 = 2.9701e-04
Validation rmse = 0.110224
Epoch 31
Loss = 8.6826e-02, PNorm = 44.8212, GNorm = 0.8894, lr_0 = 2.9087e-04
Loss = 7.5894e-02, PNorm = 44.8296, GNorm = 1.3420, lr_0 = 2.8486e-04
Validation rmse = 0.113054
Epoch 32
Loss = 8.2066e-02, PNorm = 44.8391, GNorm = 1.1166, lr_0 = 2.7839e-04
Loss = 7.1683e-02, PNorm = 44.8499, GNorm = 1.1110, lr_0 = 2.7263e-04
Loss = 3.4874e-02, PNorm = 44.8506, GNorm = 0.6032, lr_0 = 2.7206e-04
Validation rmse = 0.116296
Epoch 33
Loss = 7.9697e-02, PNorm = 44.8587, GNorm = 1.5915, lr_0 = 2.6643e-04
Loss = 6.1482e-02, PNorm = 44.8664, GNorm = 2.6747, lr_0 = 2.6092e-04
Validation rmse = 0.104025
Epoch 34
Loss = 6.0682e-02, PNorm = 44.8738, GNorm = 1.3343, lr_0 = 2.5553e-04
Validation rmse = 0.097352
Epoch 35
Loss = 6.5706e-02, PNorm = 44.8820, GNorm = 0.6212, lr_0 = 2.4972e-04
Loss = 7.6620e-02, PNorm = 44.8907, GNorm = 1.0335, lr_0 = 2.4456e-04
Validation rmse = 0.081210
Epoch 36
Loss = 5.9010e-02, PNorm = 44.8989, GNorm = 2.0943, lr_0 = 2.3950e-04
Loss = 6.9794e-02, PNorm = 44.9089, GNorm = 0.8678, lr_0 = 2.3455e-04
Validation rmse = 0.115004
Epoch 37
Loss = 5.1630e-02, PNorm = 44.9182, GNorm = 0.3831, lr_0 = 2.2922e-04
Loss = 6.7813e-02, PNorm = 44.9271, GNorm = 1.4707, lr_0 = 2.2448e-04
Validation rmse = 0.116877
Epoch 38
Loss = 5.4244e-02, PNorm = 44.9357, GNorm = 0.4075, lr_0 = 2.1938e-04
Loss = 6.7695e-02, PNorm = 44.9432, GNorm = 1.0547, lr_0 = 2.1484e-04
Validation rmse = 0.077663
Epoch 39
Loss = 7.7594e-02, PNorm = 44.9502, GNorm = 0.8973, lr_0 = 2.1040e-04
Loss = 6.1060e-02, PNorm = 44.9574, GNorm = 2.4027, lr_0 = 2.0605e-04
Validation rmse = 0.097934
Epoch 40
Loss = 7.4885e-02, PNorm = 44.9651, GNorm = 1.0352, lr_0 = 2.0137e-04
Loss = 4.7186e-02, PNorm = 44.9737, GNorm = 0.8183, lr_0 = 1.9721e-04
Validation rmse = 0.111122
Epoch 41
Loss = 6.1430e-02, PNorm = 44.9794, GNorm = 0.8807, lr_0 = 1.9313e-04
Loss = 6.2937e-02, PNorm = 44.9869, GNorm = 1.3921, lr_0 = 1.8913e-04
Validation rmse = 0.120988
Epoch 42
Loss = 6.3847e-02, PNorm = 44.9944, GNorm = 2.2503, lr_0 = 1.8484e-04
Loss = 6.8553e-02, PNorm = 45.0008, GNorm = 1.2768, lr_0 = 1.8101e-04
Validation rmse = 0.102662
Epoch 43
Loss = 4.8948e-02, PNorm = 45.0070, GNorm = 2.2071, lr_0 = 1.7727e-04
Loss = 6.0285e-02, PNorm = 45.0124, GNorm = 1.3604, lr_0 = 1.7361e-04
Validation rmse = 0.093685
Epoch 44
Loss = 5.5524e-02, PNorm = 45.0197, GNorm = 0.7515, lr_0 = 1.6966e-04
Loss = 5.9582e-02, PNorm = 45.0264, GNorm = 0.8363, lr_0 = 1.6615e-04
Validation rmse = 0.101509
Epoch 45
Loss = 5.7156e-02, PNorm = 45.0323, GNorm = 1.8138, lr_0 = 1.6238e-04
Loss = 5.5824e-02, PNorm = 45.0375, GNorm = 0.7863, lr_0 = 1.5902e-04
Validation rmse = 0.116529
Epoch 46
Loss = 4.8225e-02, PNorm = 45.0434, GNorm = 0.8498, lr_0 = 1.5573e-04
Loss = 5.5678e-02, PNorm = 45.0489, GNorm = 1.1704, lr_0 = 1.5251e-04
Validation rmse = 0.079886
Epoch 47
Loss = 5.3757e-02, PNorm = 45.0549, GNorm = 0.6199, lr_0 = 1.4905e-04
Loss = 5.8343e-02, PNorm = 45.0601, GNorm = 1.6368, lr_0 = 1.4596e-04
Validation rmse = 0.094888
Epoch 48
Loss = 5.0586e-02, PNorm = 45.0644, GNorm = 0.5760, lr_0 = 1.4295e-04
Loss = 6.1137e-02, PNorm = 45.0696, GNorm = 0.8830, lr_0 = 1.3999e-04
Validation rmse = 0.117416
Epoch 49
Loss = 5.7779e-02, PNorm = 45.0749, GNorm = 1.6018, lr_0 = 1.3681e-04
Loss = 4.8853e-02, PNorm = 45.0803, GNorm = 1.0720, lr_0 = 1.3398e-04
Validation rmse = 0.081158
Epoch 50
Loss = 5.5115e-02, PNorm = 45.0854, GNorm = 0.6268, lr_0 = 1.3121e-04
Loss = 5.0930e-02, PNorm = 45.0905, GNorm = 1.7251, lr_0 = 1.2850e-04
Loss = 9.4475e-02, PNorm = 45.0909, GNorm = 1.4491, lr_0 = 1.2823e-04
Validation rmse = 0.089487
Epoch 51
Loss = 5.2866e-02, PNorm = 45.0956, GNorm = 1.0671, lr_0 = 1.2558e-04
Validation rmse = 0.121630
Epoch 52
Loss = 5.9710e-02, PNorm = 45.1007, GNorm = 1.4712, lr_0 = 1.2272e-04
Loss = 4.7858e-02, PNorm = 45.1050, GNorm = 0.4384, lr_0 = 1.2019e-04
Validation rmse = 0.101575
Epoch 53
Loss = 7.1666e-02, PNorm = 45.1092, GNorm = 1.1935, lr_0 = 1.1770e-04
Loss = 4.8789e-02, PNorm = 45.1137, GNorm = 0.7162, lr_0 = 1.1527e-04
Validation rmse = 0.091576
Epoch 54
Loss = 5.6025e-02, PNorm = 45.1180, GNorm = 1.8392, lr_0 = 1.1265e-04
Loss = 4.6716e-02, PNorm = 45.1229, GNorm = 1.4731, lr_0 = 1.1032e-04
Validation rmse = 0.102477
Epoch 55
Loss = 4.4411e-02, PNorm = 45.1263, GNorm = 0.5897, lr_0 = 1.0804e-04
Loss = 4.3621e-02, PNorm = 45.1300, GNorm = 0.9909, lr_0 = 1.0580e-04
Validation rmse = 0.091930
Epoch 56
Loss = 5.2255e-02, PNorm = 45.1343, GNorm = 0.8493, lr_0 = 1.0340e-04
Loss = 4.5749e-02, PNorm = 45.1379, GNorm = 1.2828, lr_0 = 1.0126e-04
Validation rmse = 0.134159
Epoch 57
Loss = 4.8692e-02, PNorm = 45.1421, GNorm = 0.6570, lr_0 = 1.0000e-04
Loss = 4.8413e-02, PNorm = 45.1459, GNorm = 0.8050, lr_0 = 1.0000e-04
Validation rmse = 0.081840
Epoch 58
Loss = 4.1219e-02, PNorm = 45.1491, GNorm = 1.5445, lr_0 = 1.0000e-04
Loss = 4.9529e-02, PNorm = 45.1528, GNorm = 1.7339, lr_0 = 1.0000e-04
Validation rmse = 0.111796
Epoch 59
Loss = 5.0858e-02, PNorm = 45.1572, GNorm = 1.5551, lr_0 = 1.0000e-04
Loss = 4.6804e-02, PNorm = 45.1614, GNorm = 1.2346, lr_0 = 1.0000e-04
Validation rmse = 0.096261
Model 0 best validation rmse = 0.077663 on epoch 38
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.458819
Ensemble test rmse = 0.458819
1-fold cross validation
	Seed 0 ==> test rmse = 0.458819
Overall test rmse = 0.458819 +/- 0.000000
Elapsed time = 0:00:43
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/MeTHF_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/MeTHF_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/MeTHF_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 973 | train size = 963 | val size = 10 | test size = 59
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 8.9907e-01, PNorm = 43.2640, GNorm = 8.0752, lr_0 = 3.6053e-04
Validation rmse = 0.279257
Epoch 1
Loss = 6.3402e-01, PNorm = 43.2875, GNorm = 5.9908, lr_0 = 6.2105e-04
Loss = 5.7998e-01, PNorm = 43.3346, GNorm = 0.7649, lr_0 = 8.5789e-04
Validation rmse = 0.300211
Epoch 2
Loss = 6.9444e-01, PNorm = 43.4042, GNorm = 2.7333, lr_0 = 9.8961e-04
Loss = 5.3731e-01, PNorm = 43.4920, GNorm = 4.5787, lr_0 = 9.6914e-04
Validation rmse = 0.268600
Epoch 3
Loss = 5.2166e-01, PNorm = 43.5823, GNorm = 2.8910, lr_0 = 9.4712e-04
Loss = 3.0655e-01, PNorm = 43.6588, GNorm = 2.1465, lr_0 = 9.2754e-04
Validation rmse = 0.147843
Epoch 4
Loss = 4.1254e-01, PNorm = 43.7150, GNorm = 1.0991, lr_0 = 9.0836e-04
Loss = 2.9524e-01, PNorm = 43.7682, GNorm = 1.9273, lr_0 = 8.8958e-04
Validation rmse = 0.121465
Epoch 5
Loss = 2.1827e-01, PNorm = 43.8222, GNorm = 2.5695, lr_0 = 8.6936e-04
Loss = 1.9107e-01, PNorm = 43.8627, GNorm = 2.0022, lr_0 = 8.5139e-04
Validation rmse = 0.129738
Epoch 6
Loss = 1.7396e-01, PNorm = 43.9024, GNorm = 2.0162, lr_0 = 8.3204e-04
Loss = 1.7559e-01, PNorm = 43.9288, GNorm = 3.6386, lr_0 = 8.1484e-04
Validation rmse = 0.145792
Epoch 7
Loss = 1.8745e-01, PNorm = 43.9633, GNorm = 4.2705, lr_0 = 7.9632e-04
Loss = 1.5740e-01, PNorm = 43.9894, GNorm = 3.9409, lr_0 = 7.7986e-04
Validation rmse = 0.133368
Epoch 8
Loss = 1.3765e-01, PNorm = 44.0152, GNorm = 2.4109, lr_0 = 7.6373e-04
Loss = 1.4949e-01, PNorm = 44.0417, GNorm = 2.2603, lr_0 = 7.4794e-04
Validation rmse = 0.144842
Epoch 9
Loss = 1.2510e-01, PNorm = 44.0665, GNorm = 1.3265, lr_0 = 7.3094e-04
Loss = 1.4381e-01, PNorm = 44.0895, GNorm = 2.6507, lr_0 = 7.1583e-04
Validation rmse = 0.133052
Epoch 10
Loss = 1.0714e-01, PNorm = 44.1118, GNorm = 2.2176, lr_0 = 6.9956e-04
Loss = 1.2742e-01, PNorm = 44.1337, GNorm = 1.4757, lr_0 = 6.8510e-04
Validation rmse = 0.123714
Epoch 11
Loss = 1.0660e-01, PNorm = 44.1518, GNorm = 2.4219, lr_0 = 6.6953e-04
Loss = 1.2573e-01, PNorm = 44.1676, GNorm = 4.1852, lr_0 = 6.5569e-04
Validation rmse = 0.129093
Epoch 12
Loss = 1.1668e-01, PNorm = 44.1853, GNorm = 2.9637, lr_0 = 6.4213e-04
Loss = 1.1358e-01, PNorm = 44.2013, GNorm = 1.2711, lr_0 = 6.2885e-04
Loss = 1.2684e-01, PNorm = 44.2042, GNorm = 3.6971, lr_0 = 6.2754e-04
Validation rmse = 0.126440
Epoch 13
Loss = 1.1044e-01, PNorm = 44.2272, GNorm = 1.7103, lr_0 = 6.1456e-04
Validation rmse = 0.124226
Epoch 14
Loss = 1.0082e-01, PNorm = 44.2462, GNorm = 0.9937, lr_0 = 6.0060e-04
Loss = 1.0776e-01, PNorm = 44.2661, GNorm = 3.0160, lr_0 = 5.8818e-04
Validation rmse = 0.122433
Epoch 15
Loss = 9.5209e-02, PNorm = 44.2830, GNorm = 1.8905, lr_0 = 5.7482e-04
Loss = 9.6285e-02, PNorm = 44.2999, GNorm = 0.6800, lr_0 = 5.6293e-04
Validation rmse = 0.156341
Epoch 16
Loss = 2.1022e-01, PNorm = 44.3181, GNorm = 7.3345, lr_0 = 5.5129e-04
Loss = 1.1425e-01, PNorm = 44.3422, GNorm = 2.2601, lr_0 = 5.3989e-04
Validation rmse = 0.137009
Epoch 17
Loss = 1.3817e-01, PNorm = 44.3630, GNorm = 3.3226, lr_0 = 5.2762e-04
Loss = 9.6029e-02, PNorm = 44.3849, GNorm = 0.7229, lr_0 = 5.1671e-04
Validation rmse = 0.152123
Epoch 18
Loss = 8.2173e-02, PNorm = 44.4018, GNorm = 1.2481, lr_0 = 5.0497e-04
Loss = 9.7810e-02, PNorm = 44.4154, GNorm = 2.0566, lr_0 = 4.9453e-04
Validation rmse = 0.117894
Epoch 19
Loss = 9.2777e-02, PNorm = 44.4283, GNorm = 0.8641, lr_0 = 4.8329e-04
Loss = 8.7920e-02, PNorm = 44.4426, GNorm = 2.4619, lr_0 = 4.7330e-04
Validation rmse = 0.132321
Epoch 20
Loss = 7.6848e-02, PNorm = 44.4526, GNorm = 1.3262, lr_0 = 4.6351e-04
Loss = 9.1923e-02, PNorm = 44.4641, GNorm = 1.3131, lr_0 = 4.5393e-04
Validation rmse = 0.117102
Epoch 21
Loss = 9.8803e-02, PNorm = 44.4791, GNorm = 3.6035, lr_0 = 4.4361e-04
Loss = 9.5602e-02, PNorm = 44.4890, GNorm = 1.1623, lr_0 = 4.3444e-04
Validation rmse = 0.129378
Epoch 22
Loss = 7.7321e-02, PNorm = 44.4995, GNorm = 0.8774, lr_0 = 4.2457e-04
Loss = 8.1365e-02, PNorm = 44.5103, GNorm = 0.8406, lr_0 = 4.1579e-04
Validation rmse = 0.119269
Epoch 23
Loss = 8.2564e-02, PNorm = 44.5252, GNorm = 0.7227, lr_0 = 4.0634e-04
Loss = 9.3716e-02, PNorm = 44.5354, GNorm = 0.6044, lr_0 = 3.9794e-04
Validation rmse = 0.143585
Epoch 24
Loss = 8.4257e-02, PNorm = 44.5467, GNorm = 0.9610, lr_0 = 3.8971e-04
Loss = 8.7855e-02, PNorm = 44.5623, GNorm = 2.1695, lr_0 = 3.8165e-04
Validation rmse = 0.143090
Epoch 25
Loss = 8.0801e-02, PNorm = 44.5750, GNorm = 0.8202, lr_0 = 3.7298e-04
Loss = 7.3757e-02, PNorm = 44.5850, GNorm = 0.7979, lr_0 = 3.6527e-04
Loss = 7.5272e-02, PNorm = 44.5860, GNorm = 0.9938, lr_0 = 3.6451e-04
Validation rmse = 0.128706
Epoch 26
Loss = 7.5430e-02, PNorm = 44.5975, GNorm = 2.4254, lr_0 = 3.5697e-04
Loss = 8.2850e-02, PNorm = 44.6069, GNorm = 4.0110, lr_0 = 3.4959e-04
Validation rmse = 0.134137
Epoch 27
Loss = 8.4156e-02, PNorm = 44.6184, GNorm = 0.5050, lr_0 = 3.4236e-04
Validation rmse = 0.133399
Epoch 28
Loss = 6.0831e-02, PNorm = 44.6335, GNorm = 1.5847, lr_0 = 3.3458e-04
Loss = 8.3912e-02, PNorm = 44.6443, GNorm = 0.4893, lr_0 = 3.2766e-04
Validation rmse = 0.126182
Epoch 29
Loss = 4.6628e-02, PNorm = 44.6538, GNorm = 0.8607, lr_0 = 3.2022e-04
Loss = 7.2867e-02, PNorm = 44.6623, GNorm = 1.8694, lr_0 = 3.1360e-04
Validation rmse = 0.126785
Epoch 30
Loss = 6.3885e-02, PNorm = 44.6698, GNorm = 1.6762, lr_0 = 3.0647e-04
Loss = 7.3713e-02, PNorm = 44.6777, GNorm = 0.5366, lr_0 = 3.0013e-04
Validation rmse = 0.136523
Epoch 31
Loss = 1.0180e-01, PNorm = 44.6861, GNorm = 1.0933, lr_0 = 2.9393e-04
Loss = 7.0609e-02, PNorm = 44.6958, GNorm = 0.8382, lr_0 = 2.8785e-04
Validation rmse = 0.136724
Epoch 32
Loss = 7.3955e-02, PNorm = 44.7067, GNorm = 1.7601, lr_0 = 2.8131e-04
Loss = 6.6809e-02, PNorm = 44.7158, GNorm = 0.4802, lr_0 = 2.7549e-04
Validation rmse = 0.134212
Epoch 33
Loss = 6.1722e-02, PNorm = 44.7234, GNorm = 1.2273, lr_0 = 2.6923e-04
Loss = 6.3944e-02, PNorm = 44.7312, GNorm = 0.5353, lr_0 = 2.6367e-04
Validation rmse = 0.136751
Epoch 34
Loss = 7.1482e-02, PNorm = 44.7404, GNorm = 0.5984, lr_0 = 2.5767e-04
Loss = 6.7226e-02, PNorm = 44.7499, GNorm = 1.5775, lr_0 = 2.5235e-04
Validation rmse = 0.134582
Epoch 35
Loss = 6.9977e-02, PNorm = 44.7587, GNorm = 0.6519, lr_0 = 2.4713e-04
Loss = 6.2515e-02, PNorm = 44.7662, GNorm = 0.5060, lr_0 = 2.4202e-04
Validation rmse = 0.128701
Epoch 36
Loss = 5.4626e-02, PNorm = 44.7740, GNorm = 1.3901, lr_0 = 2.3652e-04
Loss = 6.9541e-02, PNorm = 44.7808, GNorm = 1.6192, lr_0 = 2.3163e-04
Validation rmse = 0.128367
Epoch 37
Loss = 5.7204e-02, PNorm = 44.7880, GNorm = 0.4088, lr_0 = 2.2637e-04
Loss = 6.9163e-02, PNorm = 44.7960, GNorm = 1.4187, lr_0 = 2.2168e-04
Validation rmse = 0.129550
Epoch 38
Loss = 6.1368e-02, PNorm = 44.8037, GNorm = 2.1347, lr_0 = 2.1665e-04
Loss = 6.5842e-02, PNorm = 44.8104, GNorm = 2.1675, lr_0 = 2.1217e-04
Validation rmse = 0.135341
Epoch 39
Loss = 6.4863e-02, PNorm = 44.8178, GNorm = 1.6890, lr_0 = 2.0778e-04
Loss = 6.4646e-02, PNorm = 44.8261, GNorm = 0.8886, lr_0 = 2.0348e-04
Loss = 5.7960e-02, PNorm = 44.8267, GNorm = 1.2912, lr_0 = 2.0306e-04
Validation rmse = 0.152870
Epoch 40
Loss = 8.1364e-02, PNorm = 44.8324, GNorm = 1.2473, lr_0 = 1.9886e-04
Validation rmse = 0.131044
Epoch 41
Loss = 4.7644e-02, PNorm = 44.8415, GNorm = 1.3360, lr_0 = 1.9434e-04
Loss = 6.2849e-02, PNorm = 44.8496, GNorm = 1.4136, lr_0 = 1.9032e-04
Validation rmse = 0.141478
Epoch 42
Loss = 5.9442e-02, PNorm = 44.8573, GNorm = 1.1179, lr_0 = 1.8600e-04
Loss = 6.4120e-02, PNorm = 44.8634, GNorm = 0.5529, lr_0 = 1.8215e-04
Validation rmse = 0.124006
Epoch 43
Loss = 4.6735e-02, PNorm = 44.8695, GNorm = 1.1161, lr_0 = 1.7839e-04
Loss = 6.1559e-02, PNorm = 44.8747, GNorm = 0.9239, lr_0 = 1.7470e-04
Validation rmse = 0.132562
Epoch 44
Loss = 5.3249e-02, PNorm = 44.8805, GNorm = 0.4981, lr_0 = 1.7073e-04
Loss = 5.9614e-02, PNorm = 44.8863, GNorm = 1.2901, lr_0 = 1.6720e-04
Validation rmse = 0.135137
Epoch 45
Loss = 5.9827e-02, PNorm = 44.8917, GNorm = 1.1362, lr_0 = 1.6340e-04
Loss = 5.9524e-02, PNorm = 44.8968, GNorm = 1.1103, lr_0 = 1.6002e-04
Validation rmse = 0.127772
Epoch 46
Loss = 5.1521e-02, PNorm = 44.9017, GNorm = 0.4753, lr_0 = 1.5638e-04
Loss = 5.2438e-02, PNorm = 44.9064, GNorm = 0.2616, lr_0 = 1.5315e-04
Validation rmse = 0.129631
Epoch 47
Loss = 5.7599e-02, PNorm = 44.9126, GNorm = 1.0716, lr_0 = 1.4998e-04
Loss = 5.1252e-02, PNorm = 44.9185, GNorm = 0.9075, lr_0 = 1.4688e-04
Validation rmse = 0.121620
Epoch 48
Loss = 5.4132e-02, PNorm = 44.9236, GNorm = 0.5488, lr_0 = 1.4354e-04
Loss = 5.4303e-02, PNorm = 44.9285, GNorm = 1.3580, lr_0 = 1.4058e-04
Validation rmse = 0.123945
Epoch 49
Loss = 5.1515e-02, PNorm = 44.9344, GNorm = 0.6996, lr_0 = 1.3738e-04
Loss = 5.0314e-02, PNorm = 44.9394, GNorm = 0.6419, lr_0 = 1.3454e-04
Validation rmse = 0.124403
Epoch 50
Loss = 4.7367e-02, PNorm = 44.9446, GNorm = 0.9028, lr_0 = 1.3176e-04
Loss = 5.3542e-02, PNorm = 44.9494, GNorm = 1.3054, lr_0 = 1.2904e-04
Validation rmse = 0.126801
Epoch 51
Loss = 4.5597e-02, PNorm = 44.9548, GNorm = 1.0676, lr_0 = 1.2610e-04
Loss = 5.1225e-02, PNorm = 44.9595, GNorm = 0.7443, lr_0 = 1.2350e-04
Validation rmse = 0.125458
Epoch 52
Loss = 4.3776e-02, PNorm = 44.9640, GNorm = 1.0121, lr_0 = 1.2069e-04
Loss = 5.5153e-02, PNorm = 44.9683, GNorm = 1.9536, lr_0 = 1.1819e-04
Loss = 2.9921e-02, PNorm = 44.9689, GNorm = 1.2610, lr_0 = 1.1795e-04
Validation rmse = 0.123218
Epoch 53
Loss = 4.6901e-02, PNorm = 44.9726, GNorm = 1.1158, lr_0 = 1.1551e-04
Loss = 5.2779e-02, PNorm = 44.9769, GNorm = 2.5507, lr_0 = 1.1312e-04
Validation rmse = 0.133544
Epoch 54
Loss = 5.3383e-02, PNorm = 44.9814, GNorm = 1.1785, lr_0 = 1.1078e-04
Validation rmse = 0.123098
Epoch 55
Loss = 5.4187e-02, PNorm = 44.9860, GNorm = 0.8777, lr_0 = 1.0826e-04
Loss = 4.7428e-02, PNorm = 44.9898, GNorm = 1.5533, lr_0 = 1.0603e-04
Validation rmse = 0.125954
Epoch 56
Loss = 4.8738e-02, PNorm = 44.9940, GNorm = 1.0447, lr_0 = 1.0362e-04
Loss = 4.7267e-02, PNorm = 44.9968, GNorm = 0.9336, lr_0 = 1.0147e-04
Validation rmse = 0.123012
Epoch 57
Loss = 4.6053e-02, PNorm = 45.0016, GNorm = 1.5902, lr_0 = 1.0000e-04
Loss = 5.3089e-02, PNorm = 45.0054, GNorm = 1.6525, lr_0 = 1.0000e-04
Validation rmse = 0.124406
Epoch 58
Loss = 3.5971e-02, PNorm = 45.0092, GNorm = 1.2294, lr_0 = 1.0000e-04
Loss = 5.0301e-02, PNorm = 45.0128, GNorm = 3.1194, lr_0 = 1.0000e-04
Validation rmse = 0.125746
Epoch 59
Loss = 4.2643e-02, PNorm = 45.0172, GNorm = 0.9955, lr_0 = 1.0000e-04
Loss = 5.4079e-02, PNorm = 45.0205, GNorm = 0.6067, lr_0 = 1.0000e-04
Validation rmse = 0.125570
Model 0 best validation rmse = 0.117102 on epoch 20
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.192762
Ensemble test rmse = 0.192762
1-fold cross validation
	Seed 0 ==> test rmse = 0.192762
Overall test rmse = 0.192762 +/- 0.000000
Elapsed time = 0:00:43
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/DMF_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/DMF_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/DMF_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 934 | train size = 924 | val size = 10 | test size = 98
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.3813e-01, PNorm = 43.2616, GNorm = 1.4597, lr_0 = 3.7500e-04
Validation rmse = 0.212962
Epoch 1
Loss = 6.3755e-01, PNorm = 43.2882, GNorm = 4.1601, lr_0 = 6.5000e-04
Loss = 6.6683e-01, PNorm = 43.3367, GNorm = 3.2846, lr_0 = 9.0000e-04
Validation rmse = 0.260643
Epoch 2
Loss = 5.9237e-01, PNorm = 43.4098, GNorm = 5.3555, lr_0 = 9.8468e-04
Loss = 5.5275e-01, PNorm = 43.4910, GNorm = 0.7366, lr_0 = 9.6320e-04
Validation rmse = 0.156177
Epoch 3
Loss = 3.8654e-01, PNorm = 43.5750, GNorm = 2.0533, lr_0 = 9.4219e-04
Loss = 3.8008e-01, PNorm = 43.6458, GNorm = 1.8547, lr_0 = 9.2164e-04
Validation rmse = 0.150779
Epoch 4
Loss = 3.6671e-01, PNorm = 43.7243, GNorm = 7.5249, lr_0 = 8.9955e-04
Loss = 3.0388e-01, PNorm = 43.7880, GNorm = 1.8149, lr_0 = 8.7992e-04
Validation rmse = 0.129441
Epoch 5
Loss = 2.4249e-01, PNorm = 43.8361, GNorm = 5.7718, lr_0 = 8.6073e-04
Loss = 2.2637e-01, PNorm = 43.8826, GNorm = 2.2028, lr_0 = 8.4195e-04
Loss = 1.2516e-01, PNorm = 43.8871, GNorm = 2.2042, lr_0 = 8.4010e-04
Validation rmse = 0.105004
Epoch 6
Loss = 1.8444e-01, PNorm = 43.9280, GNorm = 1.4921, lr_0 = 8.2177e-04
Validation rmse = 0.094561
Epoch 7
Loss = 2.2178e-01, PNorm = 43.9641, GNorm = 1.2846, lr_0 = 8.0385e-04
Loss = 1.6488e-01, PNorm = 43.9948, GNorm = 3.7742, lr_0 = 7.8631e-04
Validation rmse = 0.094302
Epoch 8
Loss = 1.0529e-01, PNorm = 44.0203, GNorm = 1.6683, lr_0 = 7.6746e-04
Loss = 1.4727e-01, PNorm = 44.0455, GNorm = 2.4485, lr_0 = 7.5072e-04
Validation rmse = 0.083178
Epoch 9
Loss = 1.6244e-01, PNorm = 44.0723, GNorm = 3.5135, lr_0 = 7.3435e-04
Loss = 1.3135e-01, PNorm = 44.0990, GNorm = 2.6103, lr_0 = 7.1833e-04
Validation rmse = 0.129963
Epoch 10
Loss = 1.4227e-01, PNorm = 44.1206, GNorm = 1.4597, lr_0 = 7.0111e-04
Loss = 1.4919e-01, PNorm = 44.1371, GNorm = 3.3329, lr_0 = 6.8581e-04
Validation rmse = 0.147713
Epoch 11
Loss = 1.2570e-01, PNorm = 44.1615, GNorm = 1.0924, lr_0 = 6.7085e-04
Loss = 1.2321e-01, PNorm = 44.1796, GNorm = 0.9874, lr_0 = 6.5622e-04
Validation rmse = 0.103864
Epoch 12
Loss = 1.2792e-01, PNorm = 44.1998, GNorm = 3.2222, lr_0 = 6.4049e-04
Loss = 1.1103e-01, PNorm = 44.2157, GNorm = 1.7434, lr_0 = 6.2652e-04
Validation rmse = 0.109977
Epoch 13
Loss = 1.1292e-01, PNorm = 44.2383, GNorm = 2.0163, lr_0 = 6.1285e-04
Validation rmse = 0.099869
Epoch 14
Loss = 9.8770e-02, PNorm = 44.2550, GNorm = 0.6265, lr_0 = 5.9816e-04
Loss = 9.7950e-02, PNorm = 44.2708, GNorm = 0.7007, lr_0 = 5.8512e-04
Validation rmse = 0.100034
Epoch 15
Loss = 1.0461e-01, PNorm = 44.2882, GNorm = 1.4828, lr_0 = 5.7235e-04
Loss = 1.1379e-01, PNorm = 44.3001, GNorm = 1.1746, lr_0 = 5.5987e-04
Validation rmse = 0.108414
Epoch 16
Loss = 1.1461e-01, PNorm = 44.3206, GNorm = 1.1962, lr_0 = 5.4645e-04
Loss = 9.6454e-02, PNorm = 44.3407, GNorm = 0.7842, lr_0 = 5.3453e-04
Validation rmse = 0.129374
Epoch 17
Loss = 9.6235e-02, PNorm = 44.3566, GNorm = 1.3439, lr_0 = 5.2287e-04
Loss = 1.2603e-01, PNorm = 44.3744, GNorm = 2.1706, lr_0 = 5.1146e-04
Validation rmse = 0.100860
Epoch 18
Loss = 1.1063e-01, PNorm = 44.3920, GNorm = 1.8192, lr_0 = 4.9920e-04
Loss = 9.3034e-02, PNorm = 44.4075, GNorm = 0.7002, lr_0 = 4.8831e-04
Validation rmse = 0.120578
Epoch 19
Loss = 9.1415e-02, PNorm = 44.4202, GNorm = 1.1243, lr_0 = 4.7766e-04
Validation rmse = 0.108216
Epoch 20
Loss = 6.7265e-02, PNorm = 44.4327, GNorm = 1.2541, lr_0 = 4.6621e-04
Loss = 9.2127e-02, PNorm = 44.4430, GNorm = 0.7222, lr_0 = 4.5604e-04
Validation rmse = 0.112416
Epoch 21
Loss = 5.6751e-02, PNorm = 44.4579, GNorm = 1.3918, lr_0 = 4.4609e-04
Loss = 9.0022e-02, PNorm = 44.4707, GNorm = 2.2348, lr_0 = 4.3636e-04
Validation rmse = 0.112371
Epoch 22
Loss = 7.8426e-02, PNorm = 44.4850, GNorm = 1.2726, lr_0 = 4.2590e-04
Loss = 1.0489e-01, PNorm = 44.4977, GNorm = 1.3129, lr_0 = 4.1661e-04
Validation rmse = 0.120312
Epoch 23
Loss = 9.5131e-02, PNorm = 44.5095, GNorm = 2.2152, lr_0 = 4.0752e-04
Loss = 8.9665e-02, PNorm = 44.5247, GNorm = 1.3887, lr_0 = 3.9863e-04
Validation rmse = 0.100153
Epoch 24
Loss = 8.7477e-02, PNorm = 44.5396, GNorm = 1.6242, lr_0 = 3.8908e-04
Loss = 9.5810e-02, PNorm = 44.5520, GNorm = 1.3907, lr_0 = 3.8059e-04
Validation rmse = 0.105336
Epoch 25
Loss = 1.0024e-01, PNorm = 44.5677, GNorm = 2.2225, lr_0 = 3.7229e-04
Loss = 8.2060e-02, PNorm = 44.5808, GNorm = 0.5698, lr_0 = 3.6417e-04
Loss = 1.2195e-01, PNorm = 44.5819, GNorm = 2.1327, lr_0 = 3.6337e-04
Validation rmse = 0.095022
Epoch 26
Loss = 8.4496e-02, PNorm = 44.5935, GNorm = 0.8853, lr_0 = 3.5544e-04
Validation rmse = 0.108980
Epoch 27
Loss = 8.2152e-02, PNorm = 44.6061, GNorm = 0.7526, lr_0 = 3.4692e-04
Loss = 7.9279e-02, PNorm = 44.6172, GNorm = 0.9653, lr_0 = 3.3935e-04
Validation rmse = 0.102276
Epoch 28
Loss = 5.3009e-02, PNorm = 44.6273, GNorm = 0.8221, lr_0 = 3.3195e-04
Loss = 7.9997e-02, PNorm = 44.6369, GNorm = 0.8275, lr_0 = 3.2471e-04
Validation rmse = 0.114137
Epoch 29
Loss = 8.2379e-02, PNorm = 44.6450, GNorm = 0.4954, lr_0 = 3.1693e-04
Loss = 7.8644e-02, PNorm = 44.6556, GNorm = 0.9286, lr_0 = 3.1001e-04
Validation rmse = 0.110353
Epoch 30
Loss = 7.8615e-02, PNorm = 44.6644, GNorm = 0.8343, lr_0 = 3.0325e-04
Loss = 7.5713e-02, PNorm = 44.6764, GNorm = 0.9570, lr_0 = 2.9663e-04
Validation rmse = 0.103448
Epoch 31
Loss = 6.7279e-02, PNorm = 44.6885, GNorm = 0.6164, lr_0 = 2.8952e-04
Loss = 7.6238e-02, PNorm = 44.6955, GNorm = 1.8055, lr_0 = 2.8321e-04
Validation rmse = 0.100796
Epoch 32
Loss = 7.2375e-02, PNorm = 44.7051, GNorm = 0.7730, lr_0 = 2.7703e-04
Validation rmse = 0.103983
Epoch 33
Loss = 6.3445e-02, PNorm = 44.7145, GNorm = 0.6167, lr_0 = 2.7039e-04
Loss = 7.3214e-02, PNorm = 44.7230, GNorm = 1.2453, lr_0 = 2.6449e-04
Validation rmse = 0.106976
Epoch 34
Loss = 9.0250e-02, PNorm = 44.7316, GNorm = 1.1542, lr_0 = 2.5872e-04
Loss = 7.2102e-02, PNorm = 44.7412, GNorm = 1.0397, lr_0 = 2.5308e-04
Validation rmse = 0.101313
Epoch 35
Loss = 7.1783e-02, PNorm = 44.7509, GNorm = 0.7763, lr_0 = 2.4701e-04
Loss = 6.8116e-02, PNorm = 44.7576, GNorm = 1.4938, lr_0 = 2.4162e-04
Validation rmse = 0.104231
Epoch 36
Loss = 5.3043e-02, PNorm = 44.7665, GNorm = 2.2099, lr_0 = 2.3635e-04
Loss = 7.3017e-02, PNorm = 44.7734, GNorm = 1.1008, lr_0 = 2.3120e-04
Validation rmse = 0.106226
Epoch 37
Loss = 5.9045e-02, PNorm = 44.7860, GNorm = 1.8836, lr_0 = 2.2566e-04
Loss = 7.6054e-02, PNorm = 44.7945, GNorm = 1.7975, lr_0 = 2.2073e-04
Validation rmse = 0.103040
Epoch 38
Loss = 6.3403e-02, PNorm = 44.8010, GNorm = 0.6590, lr_0 = 2.1592e-04
Loss = 6.9599e-02, PNorm = 44.8105, GNorm = 1.3675, lr_0 = 2.1121e-04
Loss = 4.3301e-02, PNorm = 44.8114, GNorm = 0.8675, lr_0 = 2.1074e-04
Validation rmse = 0.100057
Epoch 39
Loss = 5.9898e-02, PNorm = 44.8192, GNorm = 1.2515, lr_0 = 2.0615e-04
Validation rmse = 0.102715
Epoch 40
Loss = 4.6461e-02, PNorm = 44.8252, GNorm = 0.9077, lr_0 = 2.0165e-04
Loss = 6.2809e-02, PNorm = 44.8334, GNorm = 1.6798, lr_0 = 1.9725e-04
Validation rmse = 0.105370
Epoch 41
Loss = 6.5218e-02, PNorm = 44.8411, GNorm = 1.8363, lr_0 = 1.9252e-04
Loss = 6.0019e-02, PNorm = 44.8479, GNorm = 1.0195, lr_0 = 1.8832e-04
Validation rmse = 0.109180
Epoch 42
Loss = 6.5035e-02, PNorm = 44.8547, GNorm = 0.6279, lr_0 = 1.8422e-04
Loss = 6.4912e-02, PNorm = 44.8624, GNorm = 0.5966, lr_0 = 1.8020e-04
Validation rmse = 0.102164
Epoch 43
Loss = 5.3905e-02, PNorm = 44.8693, GNorm = 0.5449, lr_0 = 1.7588e-04
Loss = 5.5134e-02, PNorm = 44.8755, GNorm = 1.1625, lr_0 = 1.7204e-04
Validation rmse = 0.104816
Epoch 44
Loss = 5.6227e-02, PNorm = 44.8816, GNorm = 2.0333, lr_0 = 1.6829e-04
Loss = 6.5884e-02, PNorm = 44.8874, GNorm = 1.9152, lr_0 = 1.6462e-04
Validation rmse = 0.100078
Epoch 45
Loss = 5.7002e-02, PNorm = 44.8947, GNorm = 0.9303, lr_0 = 1.6067e-04
Loss = 6.2085e-02, PNorm = 44.9006, GNorm = 1.6700, lr_0 = 1.5717e-04
Validation rmse = 0.099609
Epoch 46
Loss = 5.7997e-02, PNorm = 44.9080, GNorm = 0.8368, lr_0 = 1.5374e-04
Validation rmse = 0.102806
Epoch 47
Loss = 2.9014e-02, PNorm = 44.9135, GNorm = 0.6176, lr_0 = 1.5005e-04
Loss = 6.0633e-02, PNorm = 44.9190, GNorm = 0.9467, lr_0 = 1.4678e-04
Validation rmse = 0.101098
Epoch 48
Loss = 5.7077e-02, PNorm = 44.9253, GNorm = 0.6898, lr_0 = 1.4358e-04
Loss = 5.9605e-02, PNorm = 44.9306, GNorm = 0.7192, lr_0 = 1.4045e-04
Validation rmse = 0.099569
Epoch 49
Loss = 4.8646e-02, PNorm = 44.9372, GNorm = 1.1453, lr_0 = 1.3708e-04
Loss = 5.8340e-02, PNorm = 44.9433, GNorm = 0.5511, lr_0 = 1.3409e-04
Validation rmse = 0.098376
Epoch 50
Loss = 5.4183e-02, PNorm = 44.9478, GNorm = 0.5193, lr_0 = 1.3116e-04
Loss = 5.6590e-02, PNorm = 44.9526, GNorm = 2.1703, lr_0 = 1.2830e-04
Validation rmse = 0.101836
Epoch 51
Loss = 6.1601e-02, PNorm = 44.9586, GNorm = 0.9298, lr_0 = 1.2523e-04
Loss = 5.1640e-02, PNorm = 44.9649, GNorm = 1.4031, lr_0 = 1.2250e-04
Loss = 2.3147e-02, PNorm = 44.9654, GNorm = 0.6319, lr_0 = 1.2223e-04
Validation rmse = 0.109079
Epoch 52
Loss = 5.4247e-02, PNorm = 44.9705, GNorm = 1.4049, lr_0 = 1.1956e-04
Validation rmse = 0.101211
Epoch 53
Loss = 4.7494e-02, PNorm = 44.9751, GNorm = 1.0995, lr_0 = 1.1695e-04
Loss = 5.0010e-02, PNorm = 44.9805, GNorm = 0.8019, lr_0 = 1.1440e-04
Validation rmse = 0.118685
Epoch 54
Loss = 5.1780e-02, PNorm = 44.9842, GNorm = 0.5278, lr_0 = 1.1166e-04
Loss = 5.1361e-02, PNorm = 44.9895, GNorm = 1.9676, lr_0 = 1.0922e-04
Validation rmse = 0.103854
Epoch 55
Loss = 5.4450e-02, PNorm = 44.9945, GNorm = 1.3319, lr_0 = 1.0684e-04
Loss = 5.4940e-02, PNorm = 44.9984, GNorm = 0.6480, lr_0 = 1.0451e-04
Validation rmse = 0.103488
Epoch 56
Loss = 4.5753e-02, PNorm = 45.0027, GNorm = 0.8083, lr_0 = 1.0200e-04
Loss = 5.1782e-02, PNorm = 45.0068, GNorm = 0.9255, lr_0 = 1.0000e-04
Validation rmse = 0.103461
Epoch 57
Loss = 5.3204e-02, PNorm = 45.0107, GNorm = 0.7798, lr_0 = 1.0000e-04
Loss = 5.1785e-02, PNorm = 45.0147, GNorm = 0.6036, lr_0 = 1.0000e-04
Validation rmse = 0.103449
Epoch 58
Loss = 4.7784e-02, PNorm = 45.0199, GNorm = 1.3443, lr_0 = 1.0000e-04
Loss = 5.1530e-02, PNorm = 45.0235, GNorm = 1.4395, lr_0 = 1.0000e-04
Validation rmse = 0.104694
Epoch 59
Loss = 4.7944e-02, PNorm = 45.0281, GNorm = 1.2414, lr_0 = 1.0000e-04
Validation rmse = 0.097895
Model 0 best validation rmse = 0.083178 on epoch 8
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.183920
Ensemble test rmse = 0.183920
1-fold cross validation
	Seed 0 ==> test rmse = 0.183920
Overall test rmse = 0.183920 +/- 0.000000
Elapsed time = 0:00:42
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/EtOAc_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/EtOAc_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/EtOAc_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 967 | train size = 957 | val size = 10 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.3621e-01, PNorm = 43.2624, GNorm = 2.2659, lr_0 = 3.6053e-04
Validation rmse = 0.350582
Epoch 1
Loss = 8.8402e-01, PNorm = 43.2824, GNorm = 6.3822, lr_0 = 6.2105e-04
Loss = 9.3630e-01, PNorm = 43.3193, GNorm = 2.7021, lr_0 = 8.5789e-04
Validation rmse = 0.265661
Epoch 2
Loss = 4.0227e-01, PNorm = 43.4029, GNorm = 0.7937, lr_0 = 9.8961e-04
Loss = 5.7630e-01, PNorm = 43.4903, GNorm = 7.1278, lr_0 = 9.6914e-04
Validation rmse = 0.237980
Epoch 3
Loss = 4.5865e-01, PNorm = 43.5684, GNorm = 4.5915, lr_0 = 9.4712e-04
Loss = 3.2021e-01, PNorm = 43.6274, GNorm = 0.5909, lr_0 = 9.2754e-04
Validation rmse = 0.218871
Epoch 4
Loss = 2.4639e-01, PNorm = 43.6773, GNorm = 1.1637, lr_0 = 9.0646e-04
Loss = 2.4892e-01, PNorm = 43.7260, GNorm = 1.1716, lr_0 = 8.8772e-04
Validation rmse = 0.224490
Epoch 5
Loss = 2.4334e-01, PNorm = 43.7724, GNorm = 1.0004, lr_0 = 8.6755e-04
Loss = 2.2275e-01, PNorm = 43.8066, GNorm = 1.8827, lr_0 = 8.4961e-04
Validation rmse = 0.178325
Epoch 6
Loss = 1.8801e-01, PNorm = 43.8568, GNorm = 2.0549, lr_0 = 8.3031e-04
Loss = 2.3105e-01, PNorm = 43.8873, GNorm = 1.1256, lr_0 = 8.1314e-04
Validation rmse = 0.189203
Epoch 7
Loss = 2.0439e-01, PNorm = 43.9167, GNorm = 1.5569, lr_0 = 7.9466e-04
Loss = 1.4455e-01, PNorm = 43.9458, GNorm = 5.1698, lr_0 = 7.7823e-04
Validation rmse = 0.170370
Epoch 8
Loss = 1.6054e-01, PNorm = 43.9779, GNorm = 3.3771, lr_0 = 7.6214e-04
Loss = 1.5417e-01, PNorm = 44.0066, GNorm = 2.9369, lr_0 = 7.4638e-04
Validation rmse = 0.182760
Epoch 9
Loss = 1.2674e-01, PNorm = 44.0264, GNorm = 2.1161, lr_0 = 7.2942e-04
Loss = 1.6596e-01, PNorm = 44.0519, GNorm = 2.8771, lr_0 = 7.1434e-04
Validation rmse = 0.203645
Epoch 10
Loss = 1.8935e-01, PNorm = 44.0789, GNorm = 2.2910, lr_0 = 6.9810e-04
Loss = 1.6867e-01, PNorm = 44.1051, GNorm = 0.8260, lr_0 = 6.8367e-04
Loss = 5.6846e-02, PNorm = 44.1082, GNorm = 1.1389, lr_0 = 6.8224e-04
Validation rmse = 0.186731
Epoch 11
Loss = 1.3556e-01, PNorm = 44.1326, GNorm = 0.6040, lr_0 = 6.6813e-04
Validation rmse = 0.187076
Epoch 12
Loss = 1.5453e-01, PNorm = 44.1519, GNorm = 1.9133, lr_0 = 6.5295e-04
Loss = 1.4065e-01, PNorm = 44.1706, GNorm = 1.4797, lr_0 = 6.3945e-04
Validation rmse = 0.183413
Epoch 13
Loss = 1.0960e-01, PNorm = 44.1895, GNorm = 1.5935, lr_0 = 6.2492e-04
Loss = 1.2886e-01, PNorm = 44.2070, GNorm = 1.4518, lr_0 = 6.1200e-04
Validation rmse = 0.185141
Epoch 14
Loss = 1.3343e-01, PNorm = 44.2242, GNorm = 0.9536, lr_0 = 5.9809e-04
Loss = 1.0323e-01, PNorm = 44.2405, GNorm = 1.0216, lr_0 = 5.8573e-04
Validation rmse = 0.186481
Epoch 15
Loss = 1.1478e-01, PNorm = 44.2539, GNorm = 0.7866, lr_0 = 5.7362e-04
Loss = 1.1097e-01, PNorm = 44.2646, GNorm = 0.7462, lr_0 = 5.6175e-04
Validation rmse = 0.177028
Epoch 16
Loss = 1.1412e-01, PNorm = 44.2790, GNorm = 2.0889, lr_0 = 5.4899e-04
Loss = 1.3237e-01, PNorm = 44.2967, GNorm = 3.0802, lr_0 = 5.3764e-04
Validation rmse = 0.172428
Epoch 17
Loss = 1.1496e-01, PNorm = 44.3126, GNorm = 4.9097, lr_0 = 5.2542e-04
Loss = 1.4573e-01, PNorm = 44.3338, GNorm = 1.4097, lr_0 = 5.1456e-04
Validation rmse = 0.192926
Epoch 18
Loss = 1.0363e-01, PNorm = 44.3562, GNorm = 0.6089, lr_0 = 5.0287e-04
Loss = 1.1017e-01, PNorm = 44.3658, GNorm = 1.4381, lr_0 = 4.9247e-04
Validation rmse = 0.181625
Epoch 19
Loss = 1.2712e-01, PNorm = 44.3815, GNorm = 2.0959, lr_0 = 4.8128e-04
Loss = 1.0086e-01, PNorm = 44.3946, GNorm = 0.4325, lr_0 = 4.7133e-04
Validation rmse = 0.173060
Epoch 20
Loss = 1.0542e-01, PNorm = 44.4103, GNorm = 3.0620, lr_0 = 4.6062e-04
Loss = 1.1778e-01, PNorm = 44.4245, GNorm = 1.1337, lr_0 = 4.5109e-04
Validation rmse = 0.188709
Epoch 21
Loss = 1.1414e-01, PNorm = 44.4383, GNorm = 2.6485, lr_0 = 4.4084e-04
Loss = 9.0157e-02, PNorm = 44.4498, GNorm = 0.8795, lr_0 = 4.3173e-04
Validation rmse = 0.180950
Epoch 22
Loss = 7.8925e-02, PNorm = 44.4572, GNorm = 1.3095, lr_0 = 4.2280e-04
Loss = 1.0609e-01, PNorm = 44.4691, GNorm = 1.6341, lr_0 = 4.1406e-04
Loss = 1.5712e-01, PNorm = 44.4710, GNorm = 3.1347, lr_0 = 4.1319e-04
Validation rmse = 0.182913
Epoch 23
Loss = 9.5253e-02, PNorm = 44.4873, GNorm = 0.8387, lr_0 = 4.0465e-04
Validation rmse = 0.172436
Epoch 24
Loss = 1.0355e-01, PNorm = 44.4963, GNorm = 0.8662, lr_0 = 3.9545e-04
Loss = 9.9224e-02, PNorm = 44.5097, GNorm = 0.6290, lr_0 = 3.8728e-04
Validation rmse = 0.177985
Epoch 25
Loss = 9.8313e-02, PNorm = 44.5223, GNorm = 2.2549, lr_0 = 3.7848e-04
Loss = 8.7319e-02, PNorm = 44.5332, GNorm = 0.6363, lr_0 = 3.7065e-04
Validation rmse = 0.174137
Epoch 26
Loss = 8.3388e-02, PNorm = 44.5431, GNorm = 1.7263, lr_0 = 3.6223e-04
Loss = 9.9596e-02, PNorm = 44.5513, GNorm = 0.8743, lr_0 = 3.5474e-04
Validation rmse = 0.176349
Epoch 27
Loss = 1.0195e-01, PNorm = 44.5640, GNorm = 1.7913, lr_0 = 3.4668e-04
Loss = 1.0416e-01, PNorm = 44.5748, GNorm = 1.0175, lr_0 = 3.3951e-04
Validation rmse = 0.178130
Epoch 28
Loss = 8.8738e-02, PNorm = 44.5855, GNorm = 0.7535, lr_0 = 3.3180e-04
Loss = 8.1467e-02, PNorm = 44.5960, GNorm = 1.6357, lr_0 = 3.2494e-04
Validation rmse = 0.172711
Epoch 29
Loss = 6.2500e-02, PNorm = 44.6034, GNorm = 0.5670, lr_0 = 3.1822e-04
Loss = 9.3422e-02, PNorm = 44.6113, GNorm = 2.7472, lr_0 = 3.1164e-04
Validation rmse = 0.181086
Epoch 30
Loss = 9.9787e-02, PNorm = 44.6217, GNorm = 2.3465, lr_0 = 3.0456e-04
Loss = 9.1318e-02, PNorm = 44.6328, GNorm = 1.5144, lr_0 = 2.9826e-04
Validation rmse = 0.164939
Epoch 31
Loss = 7.2534e-02, PNorm = 44.6437, GNorm = 0.5657, lr_0 = 2.9148e-04
Loss = 8.4089e-02, PNorm = 44.6533, GNorm = 1.0045, lr_0 = 2.8545e-04
Validation rmse = 0.177669
Epoch 32
Loss = 8.6890e-02, PNorm = 44.6615, GNorm = 1.7053, lr_0 = 2.7897e-04
Loss = 7.7879e-02, PNorm = 44.6701, GNorm = 0.5805, lr_0 = 2.7320e-04
Validation rmse = 0.166811
Epoch 33
Loss = 7.7922e-02, PNorm = 44.6806, GNorm = 0.6500, lr_0 = 2.6699e-04
Loss = 7.6385e-02, PNorm = 44.6900, GNorm = 1.4313, lr_0 = 2.6147e-04
Loss = 4.1966e-02, PNorm = 44.6911, GNorm = 2.4861, lr_0 = 2.6092e-04
Validation rmse = 0.167144
Epoch 34
Loss = 7.0463e-02, PNorm = 44.6974, GNorm = 0.6363, lr_0 = 2.5553e-04
Validation rmse = 0.171359
Epoch 35
Loss = 8.4192e-02, PNorm = 44.7057, GNorm = 1.2484, lr_0 = 2.4972e-04
Loss = 6.7404e-02, PNorm = 44.7145, GNorm = 0.3949, lr_0 = 2.4456e-04
Validation rmse = 0.164718
Epoch 36
Loss = 5.8229e-02, PNorm = 44.7219, GNorm = 0.6064, lr_0 = 2.3950e-04
Loss = 7.7146e-02, PNorm = 44.7293, GNorm = 0.9854, lr_0 = 2.3455e-04
Validation rmse = 0.170367
Epoch 37
Loss = 8.0050e-02, PNorm = 44.7392, GNorm = 0.6474, lr_0 = 2.2922e-04
Loss = 7.1905e-02, PNorm = 44.7464, GNorm = 0.9954, lr_0 = 2.2448e-04
Validation rmse = 0.159860
Epoch 38
Loss = 9.1723e-02, PNorm = 44.7532, GNorm = 1.1689, lr_0 = 2.1938e-04
Loss = 5.9041e-02, PNorm = 44.7600, GNorm = 1.4808, lr_0 = 2.1484e-04
Validation rmse = 0.172272
Epoch 39
Loss = 6.7130e-02, PNorm = 44.7685, GNorm = 1.5830, lr_0 = 2.0996e-04
Loss = 7.5191e-02, PNorm = 44.7757, GNorm = 0.8747, lr_0 = 2.0562e-04
Validation rmse = 0.166595
Epoch 40
Loss = 7.6283e-02, PNorm = 44.7836, GNorm = 0.4125, lr_0 = 2.0095e-04
Loss = 6.9534e-02, PNorm = 44.7896, GNorm = 0.8147, lr_0 = 1.9679e-04
Validation rmse = 0.167418
Epoch 41
Loss = 7.4011e-02, PNorm = 44.7994, GNorm = 1.8830, lr_0 = 1.9232e-04
Loss = 6.4700e-02, PNorm = 44.8067, GNorm = 1.7812, lr_0 = 1.8835e-04
Validation rmse = 0.161922
Epoch 42
Loss = 7.2782e-02, PNorm = 44.8111, GNorm = 3.3213, lr_0 = 1.8407e-04
Loss = 8.3972e-02, PNorm = 44.8184, GNorm = 0.6565, lr_0 = 1.8026e-04
Validation rmse = 0.172948
Epoch 43
Loss = 7.5124e-02, PNorm = 44.8254, GNorm = 1.3182, lr_0 = 1.7653e-04
Loss = 6.4586e-02, PNorm = 44.8319, GNorm = 2.0705, lr_0 = 1.7288e-04
Validation rmse = 0.168909
Epoch 44
Loss = 6.3936e-02, PNorm = 44.8380, GNorm = 0.6688, lr_0 = 1.6895e-04
Loss = 7.0731e-02, PNorm = 44.8437, GNorm = 0.6746, lr_0 = 1.6546e-04
Validation rmse = 0.164482
Epoch 45
Loss = 6.4613e-02, PNorm = 44.8495, GNorm = 1.4690, lr_0 = 1.6170e-04
Loss = 6.8299e-02, PNorm = 44.8556, GNorm = 0.7160, lr_0 = 1.5836e-04
Loss = 1.0548e-01, PNorm = 44.8562, GNorm = 3.4351, lr_0 = 1.5803e-04
Validation rmse = 0.169213
Epoch 46
Loss = 6.2933e-02, PNorm = 44.8607, GNorm = 0.6032, lr_0 = 1.5476e-04
Validation rmse = 0.158759
Epoch 47
Loss = 4.6443e-02, PNorm = 44.8667, GNorm = 0.8269, lr_0 = 1.5124e-04
Loss = 6.6471e-02, PNorm = 44.8727, GNorm = 0.6900, lr_0 = 1.4811e-04
Validation rmse = 0.160555
Epoch 48
Loss = 5.6234e-02, PNorm = 44.8793, GNorm = 1.1771, lr_0 = 1.4475e-04
Loss = 6.6289e-02, PNorm = 44.8842, GNorm = 0.4510, lr_0 = 1.4176e-04
Validation rmse = 0.158066
Epoch 49
Loss = 6.2798e-02, PNorm = 44.8903, GNorm = 0.8975, lr_0 = 1.3854e-04
Loss = 6.0310e-02, PNorm = 44.8954, GNorm = 0.6667, lr_0 = 1.3567e-04
Validation rmse = 0.158730
Epoch 50
Loss = 4.4767e-02, PNorm = 44.9000, GNorm = 0.7066, lr_0 = 1.3287e-04
Loss = 6.4027e-02, PNorm = 44.9045, GNorm = 0.8627, lr_0 = 1.3012e-04
Validation rmse = 0.163184
Epoch 51
Loss = 5.5065e-02, PNorm = 44.9098, GNorm = 0.4989, lr_0 = 1.2716e-04
Loss = 5.9192e-02, PNorm = 44.9134, GNorm = 0.7302, lr_0 = 1.2453e-04
Validation rmse = 0.155068
Epoch 52
Loss = 5.7535e-02, PNorm = 44.9188, GNorm = 0.3798, lr_0 = 1.2170e-04
Loss = 6.6828e-02, PNorm = 44.9233, GNorm = 0.8797, lr_0 = 1.1919e-04
Validation rmse = 0.153232
Epoch 53
Loss = 6.8572e-02, PNorm = 44.9283, GNorm = 2.0844, lr_0 = 1.1648e-04
Loss = 6.6254e-02, PNorm = 44.9316, GNorm = 1.1669, lr_0 = 1.1407e-04
Validation rmse = 0.145661
Epoch 54
Loss = 6.3087e-02, PNorm = 44.9363, GNorm = 0.4789, lr_0 = 1.1148e-04
Loss = 5.0190e-02, PNorm = 44.9398, GNorm = 0.9308, lr_0 = 1.0917e-04
Validation rmse = 0.151937
Epoch 55
Loss = 6.4013e-02, PNorm = 44.9442, GNorm = 0.6031, lr_0 = 1.0669e-04
Loss = 5.2827e-02, PNorm = 44.9481, GNorm = 0.5518, lr_0 = 1.0449e-04
Validation rmse = 0.154820
Epoch 56
Loss = 5.5163e-02, PNorm = 44.9519, GNorm = 0.5877, lr_0 = 1.0211e-04
Loss = 5.8497e-02, PNorm = 44.9557, GNorm = 1.5499, lr_0 = 1.0000e-04
Loss = 5.4174e-02, PNorm = 44.9559, GNorm = 1.8734, lr_0 = 1.0000e-04
Validation rmse = 0.154214
Epoch 57
Loss = 6.2557e-02, PNorm = 44.9602, GNorm = 1.2790, lr_0 = 1.0000e-04
Loss = 5.5259e-02, PNorm = 44.9633, GNorm = 2.2363, lr_0 = 1.0000e-04
Validation rmse = 0.151706
Epoch 58
Loss = 5.2598e-02, PNorm = 44.9663, GNorm = 1.1610, lr_0 = 1.0000e-04
Validation rmse = 0.158030
Epoch 59
Loss = 4.7163e-02, PNorm = 44.9701, GNorm = 1.9609, lr_0 = 1.0000e-04
Loss = 5.4295e-02, PNorm = 44.9736, GNorm = 1.2182, lr_0 = 1.0000e-04
Validation rmse = 0.145830
Model 0 best validation rmse = 0.145661 on epoch 53
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.260137
Ensemble test rmse = 0.260137
1-fold cross validation
	Seed 0 ==> test rmse = 0.260137
Overall test rmse = 0.260137 +/- 0.000000
Elapsed time = 0:00:44
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-05d85262-3219-459a-86b2-5360cba4da72.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/MeOH_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2', 'mse'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2', 'mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/MeOH_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/MeOH_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 695 | train size = 688 | val size = 7 | test size = 337
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.5179e-01, PNorm = 43.2641, GNorm = 3.7596, lr_0 = 4.8077e-04
Validation rmse = 0.361506
Validation r2 = 0.103498
Validation mse = 0.130687
Epoch 1
Loss = 6.9682e-01, PNorm = 43.3076, GNorm = 8.7747, lr_0 = 8.6154e-04
Validation rmse = 0.372762
Validation r2 = 0.046801
Validation mse = 0.138952
Epoch 2
Loss = 4.4965e-01, PNorm = 43.3670, GNorm = 2.0051, lr_0 = 9.8184e-04
Loss = 5.5475e-01, PNorm = 43.4429, GNorm = 8.3434, lr_0 = 9.5231e-04
Validation rmse = 0.325042
Validation r2 = 0.275231
Validation mse = 0.105653
Epoch 3
Loss = 4.5864e-01, PNorm = 43.5136, GNorm = 2.9301, lr_0 = 9.2367e-04
Validation rmse = 0.320919
Validation r2 = 0.293502
Validation mse = 0.102989
Epoch 4
Loss = 2.9871e-01, PNorm = 43.5759, GNorm = 1.3348, lr_0 = 8.9589e-04
Validation rmse = 0.315991
Validation r2 = 0.315032
Validation mse = 0.099851
Epoch 5
Loss = 3.2056e-01, PNorm = 43.6435, GNorm = 3.8634, lr_0 = 8.6629e-04
Loss = 2.3510e-01, PNorm = 43.6886, GNorm = 1.1473, lr_0 = 8.4024e-04
Validation rmse = 0.231890
Validation r2 = 0.631121
Validation mse = 0.053773
Epoch 6
Loss = 2.8559e-01, PNorm = 43.7352, GNorm = 7.8492, lr_0 = 8.1497e-04
Validation rmse = 0.234591
Validation r2 = 0.622477
Validation mse = 0.055033
Epoch 7
Loss = 2.7694e-01, PNorm = 43.7866, GNorm = 1.6954, lr_0 = 7.9046e-04
Loss = 2.0308e-01, PNorm = 43.8285, GNorm = 1.3642, lr_0 = 7.6668e-04
Validation rmse = 0.242063
Validation r2 = 0.598044
Validation mse = 0.058595
Epoch 8
Loss = 1.8334e-01, PNorm = 43.8582, GNorm = 1.4121, lr_0 = 7.4362e-04
Validation rmse = 0.260783
Validation r2 = 0.533471
Validation mse = 0.068008
Epoch 9
Loss = 2.2530e-01, PNorm = 43.8947, GNorm = 1.2017, lr_0 = 7.1906e-04
Validation rmse = 0.195323
Validation r2 = 0.738285
Validation mse = 0.038151
Epoch 10
Loss = 1.6588e-01, PNorm = 43.9321, GNorm = 3.2423, lr_0 = 6.9743e-04
Loss = 1.4024e-01, PNorm = 43.9598, GNorm = 1.1019, lr_0 = 6.7645e-04
Validation rmse = 0.188895
Validation r2 = 0.755229
Validation mse = 0.035681
Epoch 11
Loss = 1.4240e-01, PNorm = 43.9828, GNorm = 3.4267, lr_0 = 6.5611e-04
Validation rmse = 0.171600
Validation r2 = 0.797998
Validation mse = 0.029447
Epoch 12
Loss = 9.9090e-02, PNorm = 44.0055, GNorm = 2.8240, lr_0 = 6.3638e-04
Validation rmse = 0.188103
Validation r2 = 0.757277
Validation mse = 0.035383
Epoch 13
Loss = 1.3694e-01, PNorm = 44.0306, GNorm = 2.0401, lr_0 = 6.1535e-04
Loss = 1.2633e-01, PNorm = 44.0512, GNorm = 0.9714, lr_0 = 5.9685e-04
Validation rmse = 0.172953
Validation r2 = 0.794801
Validation mse = 0.029913
Epoch 14
Loss = 1.0048e-01, PNorm = 44.0688, GNorm = 0.8289, lr_0 = 5.7889e-04
Validation rmse = 0.190847
Validation r2 = 0.750144
Validation mse = 0.036423
Epoch 15
Loss = 1.4132e-01, PNorm = 44.0841, GNorm = 2.0194, lr_0 = 5.6148e-04
Loss = 1.2992e-01, PNorm = 44.1003, GNorm = 0.8915, lr_0 = 5.4460e-04
Validation rmse = 0.178731
Validation r2 = 0.780862
Validation mse = 0.031945
Epoch 16
Loss = 1.0937e-01, PNorm = 44.1207, GNorm = 1.0647, lr_0 = 5.2822e-04
Validation rmse = 0.177168
Validation r2 = 0.784676
Validation mse = 0.031389
Epoch 17
Loss = 1.0990e-01, PNorm = 44.1364, GNorm = 2.3177, lr_0 = 5.1077e-04
Validation rmse = 0.161252
Validation r2 = 0.821627
Validation mse = 0.026002
Epoch 18
Loss = 9.6877e-02, PNorm = 44.1526, GNorm = 1.3632, lr_0 = 4.9540e-04
Loss = 1.1497e-01, PNorm = 44.1680, GNorm = 0.8518, lr_0 = 4.8050e-04
Validation rmse = 0.176895
Validation r2 = 0.785340
Validation mse = 0.031292
Epoch 19
Loss = 1.0189e-01, PNorm = 44.1821, GNorm = 0.8662, lr_0 = 4.6605e-04
Validation rmse = 0.175793
Validation r2 = 0.788006
Validation mse = 0.030903
Epoch 20
Loss = 8.8310e-02, PNorm = 44.1946, GNorm = 1.6889, lr_0 = 4.5204e-04
Validation rmse = 0.176115
Validation r2 = 0.787229
Validation mse = 0.031017
Epoch 21
Loss = 1.3645e-01, PNorm = 44.2092, GNorm = 1.3655, lr_0 = 4.3710e-04
Loss = 8.7012e-02, PNorm = 44.2228, GNorm = 2.6756, lr_0 = 4.2396e-04
Validation rmse = 0.175856
Validation r2 = 0.787855
Validation mse = 0.030925
Epoch 22
Loss = 9.6875e-02, PNorm = 44.2358, GNorm = 2.6090, lr_0 = 4.1120e-04
Validation rmse = 0.162869
Validation r2 = 0.818031
Validation mse = 0.026526
Epoch 23
Loss = 9.4403e-02, PNorm = 44.2492, GNorm = 2.6835, lr_0 = 3.9884e-04
Loss = 9.0761e-02, PNorm = 44.2614, GNorm = 1.1297, lr_0 = 3.8684e-04
Validation rmse = 0.177145
Validation r2 = 0.784732
Validation mse = 0.031380
Epoch 24
Loss = 9.3693e-02, PNorm = 44.2758, GNorm = 0.5488, lr_0 = 3.7521e-04
Validation rmse = 0.166042
Validation r2 = 0.810872
Validation mse = 0.027570
Epoch 25
Loss = 9.6441e-02, PNorm = 44.2874, GNorm = 1.1564, lr_0 = 3.6392e-04
Validation rmse = 0.159792
Validation r2 = 0.824843
Validation mse = 0.025533
Epoch 26
Loss = 6.3979e-02, PNorm = 44.3009, GNorm = 1.0861, lr_0 = 3.5190e-04
Loss = 1.0537e-01, PNorm = 44.3143, GNorm = 1.9008, lr_0 = 3.4132e-04
Validation rmse = 0.173493
Validation r2 = 0.793518
Validation mse = 0.030100
Epoch 27
Loss = 8.3458e-02, PNorm = 44.3262, GNorm = 2.2225, lr_0 = 3.3105e-04
Validation rmse = 0.168404
Validation r2 = 0.805453
Validation mse = 0.028360
Epoch 28
Loss = 8.4946e-02, PNorm = 44.3387, GNorm = 1.5321, lr_0 = 3.2109e-04
Validation rmse = 0.170622
Validation r2 = 0.800294
Validation mse = 0.029112
Epoch 29
Loss = 1.1725e-01, PNorm = 44.3502, GNorm = 2.0493, lr_0 = 3.1144e-04
Loss = 8.3376e-02, PNorm = 44.3600, GNorm = 1.1779, lr_0 = 3.0207e-04
Validation rmse = 0.164251
Validation r2 = 0.814930
Validation mse = 0.026978
Epoch 30
Loss = 7.7236e-02, PNorm = 44.3732, GNorm = 0.8797, lr_0 = 2.9209e-04
Validation rmse = 0.174653
Validation r2 = 0.790746
Validation mse = 0.030504
Epoch 31
Loss = 7.7918e-02, PNorm = 44.3845, GNorm = 1.8259, lr_0 = 2.8331e-04
Loss = 8.4377e-02, PNorm = 44.3951, GNorm = 1.0491, lr_0 = 2.7478e-04
Validation rmse = 0.168526
Validation r2 = 0.805170
Validation mse = 0.028401
Epoch 32
Loss = 7.8360e-02, PNorm = 44.4073, GNorm = 1.2289, lr_0 = 2.6652e-04
Validation rmse = 0.167843
Validation r2 = 0.806747
Validation mse = 0.028171
Epoch 33
Loss = 8.3330e-02, PNorm = 44.4184, GNorm = 0.7553, lr_0 = 2.5850e-04
Validation rmse = 0.165567
Validation r2 = 0.811952
Validation mse = 0.027413
Epoch 34
Loss = 8.7962e-02, PNorm = 44.4299, GNorm = 0.8194, lr_0 = 2.4996e-04
Loss = 7.9109e-02, PNorm = 44.4403, GNorm = 1.2231, lr_0 = 2.4245e-04
Validation rmse = 0.163450
Validation r2 = 0.816730
Validation mse = 0.026716
Epoch 35
Loss = 6.9961e-02, PNorm = 44.4502, GNorm = 0.3619, lr_0 = 2.3515e-04
Validation rmse = 0.169925
Validation r2 = 0.801923
Validation mse = 0.028874
Epoch 36
Loss = 7.3141e-02, PNorm = 44.4595, GNorm = 1.7616, lr_0 = 2.2808e-04
Validation rmse = 0.165959
Validation r2 = 0.811060
Validation mse = 0.027543
Epoch 37
Loss = 9.9283e-02, PNorm = 44.4695, GNorm = 1.1878, lr_0 = 2.2122e-04
Loss = 7.0754e-02, PNorm = 44.4800, GNorm = 1.0882, lr_0 = 2.1457e-04
Validation rmse = 0.162398
Validation r2 = 0.819083
Validation mse = 0.026373
Epoch 38
Loss = 6.3373e-02, PNorm = 44.4893, GNorm = 0.8703, lr_0 = 2.0748e-04
Validation rmse = 0.156204
Validation r2 = 0.832621
Validation mse = 0.024400
Epoch 39
Loss = 7.2294e-02, PNorm = 44.4973, GNorm = 2.3355, lr_0 = 2.0124e-04
Loss = 7.3810e-02, PNorm = 44.5050, GNorm = 1.3548, lr_0 = 1.9519e-04
Validation rmse = 0.166436
Validation r2 = 0.809974
Validation mse = 0.027701
Epoch 40
Loss = 6.8571e-02, PNorm = 44.5139, GNorm = 1.0071, lr_0 = 1.8932e-04
Validation rmse = 0.165774
Validation r2 = 0.811482
Validation mse = 0.027481
Epoch 41
Loss = 5.9977e-02, PNorm = 44.5217, GNorm = 1.2947, lr_0 = 1.8362e-04
Validation rmse = 0.159774
Validation r2 = 0.824880
Validation mse = 0.025528
Epoch 42
Loss = 4.3896e-02, PNorm = 44.5306, GNorm = 0.7769, lr_0 = 1.7756e-04
Loss = 7.2814e-02, PNorm = 44.5383, GNorm = 0.5870, lr_0 = 1.7222e-04
Validation rmse = 0.161845
Validation r2 = 0.820313
Validation mse = 0.026194
Epoch 43
Loss = 5.9769e-02, PNorm = 44.5467, GNorm = 1.0460, lr_0 = 1.6704e-04
Validation rmse = 0.165059
Validation r2 = 0.813105
Validation mse = 0.027245
Epoch 44
Loss = 6.6547e-02, PNorm = 44.5534, GNorm = 0.5482, lr_0 = 1.6201e-04
Validation rmse = 0.148442
Validation r2 = 0.848842
Validation mse = 0.022035
Epoch 45
Loss = 5.5743e-02, PNorm = 44.5612, GNorm = 1.6400, lr_0 = 1.5714e-04
Loss = 6.4245e-02, PNorm = 44.5676, GNorm = 1.0143, lr_0 = 1.5241e-04
Validation rmse = 0.156557
Validation r2 = 0.831863
Validation mse = 0.024510
Epoch 46
Loss = 5.7956e-02, PNorm = 44.5750, GNorm = 0.8761, lr_0 = 1.4738e-04
Validation rmse = 0.149007
Validation r2 = 0.847689
Validation mse = 0.022203
Epoch 47
Loss = 6.9257e-02, PNorm = 44.5815, GNorm = 0.4677, lr_0 = 1.4295e-04
Loss = 6.1949e-02, PNorm = 44.5870, GNorm = 2.1955, lr_0 = 1.3865e-04
Validation rmse = 0.162164
Validation r2 = 0.819602
Validation mse = 0.026297
Epoch 48
Loss = 6.8603e-02, PNorm = 44.5937, GNorm = 0.8200, lr_0 = 1.3448e-04
Validation rmse = 0.151291
Validation r2 = 0.842984
Validation mse = 0.022889
Epoch 49
Loss = 6.3296e-02, PNorm = 44.5999, GNorm = 0.6822, lr_0 = 1.3043e-04
Validation rmse = 0.157861
Validation r2 = 0.829050
Validation mse = 0.024920
Epoch 50
Loss = 5.4280e-02, PNorm = 44.6062, GNorm = 1.2499, lr_0 = 1.2651e-04
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-05d85262-3219-459a-86b2-5360cba4da72.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/MeOH_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2', 'mse'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2', 'mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/MeOH_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/MeOH_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 695 | train size = 688 | val size = 7 | test size = 337
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.5179e-01, PNorm = 43.2641, GNorm = 3.7596, lr_0 = 4.8077e-04
Validation rmse = 0.361506
Validation r2 = 0.103498
Validation mse = 0.130687
Epoch 1
Loss = 6.9682e-01, PNorm = 43.3076, GNorm = 8.7747, lr_0 = 8.6154e-04
Validation rmse = 0.372762
Validation r2 = 0.046801
Validation mse = 0.138952
Epoch 2
Loss = 4.4965e-01, PNorm = 43.3670, GNorm = 2.0051, lr_0 = 9.8184e-04
Loss = 5.5475e-01, PNorm = 43.4429, GNorm = 8.3434, lr_0 = 9.5231e-04
Validation rmse = 0.325042
Validation r2 = 0.275231
Validation mse = 0.105653
Epoch 3
Loss = 4.5864e-01, PNorm = 43.5136, GNorm = 2.9301, lr_0 = 9.2367e-04
Validation rmse = 0.320919
Validation r2 = 0.293502
Validation mse = 0.102989
Epoch 4
Loss = 2.9871e-01, PNorm = 43.5759, GNorm = 1.3348, lr_0 = 8.9589e-04
Validation rmse = 0.315991
Validation r2 = 0.315032
Validation mse = 0.099851
Epoch 5
Loss = 3.2056e-01, PNorm = 43.6435, GNorm = 3.8634, lr_0 = 8.6629e-04
Loss = 2.3510e-01, PNorm = 43.6886, GNorm = 1.1473, lr_0 = 8.4024e-04
Validation rmse = 0.231890
Validation r2 = 0.631121
Validation mse = 0.053773
Epoch 6
Loss = 2.8559e-01, PNorm = 43.7352, GNorm = 7.8492, lr_0 = 8.1497e-04
Validation rmse = 0.234591
Validation r2 = 0.622477
Validation mse = 0.055033
Epoch 7
Loss = 2.7694e-01, PNorm = 43.7866, GNorm = 1.6954, lr_0 = 7.9046e-04
Loss = 2.0308e-01, PNorm = 43.8285, GNorm = 1.3642, lr_0 = 7.6668e-04
Validation rmse = 0.242063
Validation r2 = 0.598044
Validation mse = 0.058595
Epoch 8
Loss = 1.8334e-01, PNorm = 43.8582, GNorm = 1.4121, lr_0 = 7.4362e-04
Validation rmse = 0.260783
Validation r2 = 0.533471
Validation mse = 0.068008
Epoch 9
Loss = 2.2530e-01, PNorm = 43.8947, GNorm = 1.2017, lr_0 = 7.1906e-04
Validation rmse = 0.195323
Validation r2 = 0.738285
Validation mse = 0.038151
Epoch 10
Loss = 1.6588e-01, PNorm = 43.9321, GNorm = 3.2423, lr_0 = 6.9743e-04
Loss = 1.4024e-01, PNorm = 43.9598, GNorm = 1.1019, lr_0 = 6.7645e-04
Validation rmse = 0.188895
Validation r2 = 0.755229
Validation mse = 0.035681
Epoch 11
Loss = 1.4240e-01, PNorm = 43.9828, GNorm = 3.4267, lr_0 = 6.5611e-04
Validation rmse = 0.171600
Validation r2 = 0.797998
Validation mse = 0.029447
Epoch 12
Loss = 9.9090e-02, PNorm = 44.0055, GNorm = 2.8240, lr_0 = 6.3638e-04
Validation rmse = 0.188103
Validation r2 = 0.757277
Validation mse = 0.035383
Epoch 13
Loss = 1.3694e-01, PNorm = 44.0306, GNorm = 2.0401, lr_0 = 6.1535e-04
Loss = 1.2633e-01, PNorm = 44.0512, GNorm = 0.9714, lr_0 = 5.9685e-04
Validation rmse = 0.172953
Validation r2 = 0.794801
Validation mse = 0.029913
Epoch 14
Loss = 1.0048e-01, PNorm = 44.0688, GNorm = 0.8289, lr_0 = 5.7889e-04
Validation rmse = 0.190847
Validation r2 = 0.750144
Validation mse = 0.036423
Epoch 15
Loss = 1.4132e-01, PNorm = 44.0841, GNorm = 2.0194, lr_0 = 5.6148e-04
Loss = 1.2992e-01, PNorm = 44.1003, GNorm = 0.8915, lr_0 = 5.4460e-04
Validation rmse = 0.178731
Validation r2 = 0.780862
Validation mse = 0.031945
Epoch 16
Loss = 1.0937e-01, PNorm = 44.1207, GNorm = 1.0647, lr_0 = 5.2822e-04
Validation rmse = 0.177168
Validation r2 = 0.784676
Validation mse = 0.031389
Epoch 17
Loss = 1.0990e-01, PNorm = 44.1364, GNorm = 2.3177, lr_0 = 5.1077e-04
Validation rmse = 0.161252
Validation r2 = 0.821627
Validation mse = 0.026002
Epoch 18
Loss = 9.6877e-02, PNorm = 44.1526, GNorm = 1.3632, lr_0 = 4.9540e-04
Loss = 1.1497e-01, PNorm = 44.1680, GNorm = 0.8518, lr_0 = 4.8050e-04
Validation rmse = 0.176895
Validation r2 = 0.785340
Validation mse = 0.031292
Epoch 19
Loss = 1.0189e-01, PNorm = 44.1821, GNorm = 0.8662, lr_0 = 4.6605e-04
Validation rmse = 0.175793
Validation r2 = 0.788006
Validation mse = 0.030903
Epoch 20
Loss = 8.8310e-02, PNorm = 44.1946, GNorm = 1.6889, lr_0 = 4.5204e-04
Validation rmse = 0.176115
Validation r2 = 0.787229
Validation mse = 0.031017
Epoch 21
Loss = 1.3645e-01, PNorm = 44.2092, GNorm = 1.3655, lr_0 = 4.3710e-04
Loss = 8.7012e-02, PNorm = 44.2228, GNorm = 2.6756, lr_0 = 4.2396e-04
Validation rmse = 0.175856
Validation r2 = 0.787855
Validation mse = 0.030925
Epoch 22
Loss = 9.6875e-02, PNorm = 44.2358, GNorm = 2.6090, lr_0 = 4.1120e-04
Validation rmse = 0.162869
Validation r2 = 0.818031
Validation mse = 0.026526
Epoch 23
Loss = 9.4403e-02, PNorm = 44.2492, GNorm = 2.6835, lr_0 = 3.9884e-04
Loss = 9.0761e-02, PNorm = 44.2614, GNorm = 1.1297, lr_0 = 3.8684e-04
Validation rmse = 0.177145
Validation r2 = 0.784732
Validation mse = 0.031380
Epoch 24
Loss = 9.3693e-02, PNorm = 44.2758, GNorm = 0.5488, lr_0 = 3.7521e-04
Validation rmse = 0.166042
Validation r2 = 0.810872
Validation mse = 0.027570
Epoch 25
Loss = 9.6441e-02, PNorm = 44.2874, GNorm = 1.1564, lr_0 = 3.6392e-04
Validation rmse = 0.159792
Validation r2 = 0.824843
Validation mse = 0.025533
Epoch 26
Loss = 6.3979e-02, PNorm = 44.3009, GNorm = 1.0861, lr_0 = 3.5190e-04
Loss = 1.0537e-01, PNorm = 44.3143, GNorm = 1.9008, lr_0 = 3.4132e-04
Validation rmse = 0.173493
Validation r2 = 0.793518
Validation mse = 0.030100
Epoch 27
Loss = 8.3458e-02, PNorm = 44.3262, GNorm = 2.2225, lr_0 = 3.3105e-04
Validation rmse = 0.168404
Validation r2 = 0.805453
Validation mse = 0.028360
Epoch 28
Loss = 8.4946e-02, PNorm = 44.3387, GNorm = 1.5321, lr_0 = 3.2109e-04
Validation rmse = 0.170622
Validation r2 = 0.800294
Validation mse = 0.029112
Epoch 29
Loss = 1.1725e-01, PNorm = 44.3502, GNorm = 2.0493, lr_0 = 3.1144e-04
Loss = 8.3376e-02, PNorm = 44.3600, GNorm = 1.1779, lr_0 = 3.0207e-04
Validation rmse = 0.164251
Validation r2 = 0.814930
Validation mse = 0.026978
Epoch 30
Loss = 7.7236e-02, PNorm = 44.3732, GNorm = 0.8797, lr_0 = 2.9209e-04
Validation rmse = 0.174653
Validation r2 = 0.790746
Validation mse = 0.030504
Epoch 31
Loss = 7.7918e-02, PNorm = 44.3845, GNorm = 1.8259, lr_0 = 2.8331e-04
Loss = 8.4377e-02, PNorm = 44.3951, GNorm = 1.0491, lr_0 = 2.7478e-04
Validation rmse = 0.168526
Validation r2 = 0.805170
Validation mse = 0.028401
Epoch 32
Loss = 7.8360e-02, PNorm = 44.4073, GNorm = 1.2289, lr_0 = 2.6652e-04
Validation rmse = 0.167843
Validation r2 = 0.806747
Validation mse = 0.028171
Epoch 33
Loss = 8.3330e-02, PNorm = 44.4184, GNorm = 0.7553, lr_0 = 2.5850e-04
Validation rmse = 0.165567
Validation r2 = 0.811952
Validation mse = 0.027413
Epoch 34
Loss = 8.7962e-02, PNorm = 44.4299, GNorm = 0.8194, lr_0 = 2.4996e-04
Loss = 7.9109e-02, PNorm = 44.4403, GNorm = 1.2231, lr_0 = 2.4245e-04
Validation rmse = 0.163450
Validation r2 = 0.816730
Validation mse = 0.026716
Epoch 35
Loss = 6.9961e-02, PNorm = 44.4502, GNorm = 0.3619, lr_0 = 2.3515e-04
Validation rmse = 0.169925
Validation r2 = 0.801923
Validation mse = 0.028874
Epoch 36
Loss = 7.3141e-02, PNorm = 44.4595, GNorm = 1.7616, lr_0 = 2.2808e-04
Validation rmse = 0.165959
Validation r2 = 0.811060
Validation mse = 0.027543
Epoch 37
Loss = 9.9283e-02, PNorm = 44.4695, GNorm = 1.1878, lr_0 = 2.2122e-04
Loss = 7.0754e-02, PNorm = 44.4800, GNorm = 1.0882, lr_0 = 2.1457e-04
Validation rmse = 0.162398
Validation r2 = 0.819083
Validation mse = 0.026373
Epoch 38
Loss = 6.3373e-02, PNorm = 44.4893, GNorm = 0.8703, lr_0 = 2.0748e-04
Validation rmse = 0.156204
Validation r2 = 0.832621
Validation mse = 0.024400
Epoch 39
Loss = 7.2294e-02, PNorm = 44.4973, GNorm = 2.3355, lr_0 = 2.0124e-04
Loss = 7.3810e-02, PNorm = 44.5050, GNorm = 1.3548, lr_0 = 1.9519e-04
Validation rmse = 0.166436
Validation r2 = 0.809974
Validation mse = 0.027701
Epoch 40
Loss = 6.8571e-02, PNorm = 44.5139, GNorm = 1.0071, lr_0 = 1.8932e-04
Validation rmse = 0.165774
Validation r2 = 0.811482
Validation mse = 0.027481
Epoch 41
Loss = 5.9977e-02, PNorm = 44.5217, GNorm = 1.2947, lr_0 = 1.8362e-04
Validation rmse = 0.159774
Validation r2 = 0.824880
Validation mse = 0.025528
Epoch 42
Loss = 4.3896e-02, PNorm = 44.5306, GNorm = 0.7769, lr_0 = 1.7756e-04
Loss = 7.2814e-02, PNorm = 44.5383, GNorm = 0.5870, lr_0 = 1.7222e-04
Validation rmse = 0.161845
Validation r2 = 0.820313
Validation mse = 0.026194
Epoch 43
Loss = 5.9769e-02, PNorm = 44.5467, GNorm = 1.0460, lr_0 = 1.6704e-04
Validation rmse = 0.165059
Validation r2 = 0.813105
Validation mse = 0.027245
Epoch 44
Loss = 6.6547e-02, PNorm = 44.5534, GNorm = 0.5482, lr_0 = 1.6201e-04
Validation rmse = 0.148442
Validation r2 = 0.848842
Validation mse = 0.022035
Epoch 45
Loss = 5.5743e-02, PNorm = 44.5612, GNorm = 1.6400, lr_0 = 1.5714e-04
Loss = 6.4245e-02, PNorm = 44.5676, GNorm = 1.0143, lr_0 = 1.5241e-04
Validation rmse = 0.156557
Validation r2 = 0.831863
Validation mse = 0.024510
Epoch 46
Loss = 5.7956e-02, PNorm = 44.5750, GNorm = 0.8761, lr_0 = 1.4738e-04
Validation rmse = 0.149007
Validation r2 = 0.847689
Validation mse = 0.022203
Epoch 47
Loss = 6.9257e-02, PNorm = 44.5815, GNorm = 0.4677, lr_0 = 1.4295e-04
Loss = 6.1949e-02, PNorm = 44.5870, GNorm = 2.1955, lr_0 = 1.3865e-04
Validation rmse = 0.162164
Validation r2 = 0.819602
Validation mse = 0.026297
Epoch 48
Loss = 6.8603e-02, PNorm = 44.5937, GNorm = 0.8200, lr_0 = 1.3448e-04
Validation rmse = 0.151291
Validation r2 = 0.842984
Validation mse = 0.022889
Epoch 49
Loss = 6.3296e-02, PNorm = 44.5999, GNorm = 0.6822, lr_0 = 1.3043e-04
Validation rmse = 0.157861
Validation r2 = 0.829050
Validation mse = 0.024920
Epoch 50
Loss = 5.4280e-02, PNorm = 44.6062, GNorm = 1.2499, lr_0 = 1.2651e-04
Loss = 6.1500e-02, PNorm = 44.6120, GNorm = 0.5019, lr_0 = 1.2270e-04
Validation rmse = 0.150369
Validation r2 = 0.844892
Validation mse = 0.022611
Epoch 51
Loss = 5.6975e-02, PNorm = 44.6181, GNorm = 0.7442, lr_0 = 1.1865e-04
Validation rmse = 0.153205
Validation r2 = 0.838984
Validation mse = 0.023472
Epoch 52
Loss = 4.5944e-02, PNorm = 44.6233, GNorm = 0.8030, lr_0 = 1.1508e-04
Validation rmse = 0.150986
Validation r2 = 0.843615
Validation mse = 0.022797
Epoch 53
Loss = 6.6283e-02, PNorm = 44.6284, GNorm = 1.9631, lr_0 = 1.1162e-04
Loss = 5.4227e-02, PNorm = 44.6335, GNorm = 0.6207, lr_0 = 1.0826e-04
Validation rmse = 0.150613
Validation r2 = 0.844387
Validation mse = 0.022684
Epoch 54
Loss = 5.3422e-02, PNorm = 44.6388, GNorm = 0.8643, lr_0 = 1.0501e-04
Validation rmse = 0.145433
Validation r2 = 0.854907
Validation mse = 0.021151
Epoch 55
Loss = 5.8249e-02, PNorm = 44.6438, GNorm = 0.8530, lr_0 = 1.0154e-04
Loss = 5.3120e-02, PNorm = 44.6486, GNorm = 0.5201, lr_0 = 1.0000e-04
Validation rmse = 0.145792
Validation r2 = 0.854190
Validation mse = 0.021255
Epoch 56
Loss = 5.3638e-02, PNorm = 44.6535, GNorm = 1.6077, lr_0 = 1.0000e-04
Validation rmse = 0.153238
Validation r2 = 0.838917
Validation mse = 0.023482
Epoch 57
Loss = 5.7541e-02, PNorm = 44.6579, GNorm = 1.3825, lr_0 = 1.0000e-04
Validation rmse = 0.145169
Validation r2 = 0.855433
Validation mse = 0.021074
Epoch 58
Loss = 4.1980e-02, PNorm = 44.6626, GNorm = 0.6371, lr_0 = 1.0000e-04
Loss = 5.6548e-02, PNorm = 44.6676, GNorm = 0.6395, lr_0 = 1.0000e-04
Validation rmse = 0.143254
Validation r2 = 0.859223
Validation mse = 0.020522
Epoch 59
Loss = 4.9147e-02, PNorm = 44.6726, GNorm = 1.1457, lr_0 = 1.0000e-04
Validation rmse = 0.149737
Validation r2 = 0.846191
Validation mse = 0.022421
Model 0 best validation rmse = 0.143254 on epoch 58
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.161248
Model 0 test r2 = 0.580949
Model 0 test mse = 0.026001
Ensemble test rmse = 0.161248
Ensemble test r2 = 0.580949
Ensemble test mse = 0.026001
Fold 1
Splitting data with seed 1
Total size = 695 | train size = 688 | val size = 7 | test size = 337
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.2407e-01, PNorm = 43.2654, GNorm = 4.1500, lr_0 = 4.8077e-04
Validation rmse = 0.241286
Validation r2 = 0.566576
Validation mse = 0.058219
Epoch 1
Loss = 6.4427e-01, PNorm = 43.3127, GNorm = 19.5051, lr_0 = 8.6154e-04
Validation rmse = 0.266002
Validation r2 = 0.473234
Validation mse = 0.070757
Epoch 2
Loss = 7.4444e-01, PNorm = 43.3633, GNorm = 2.9528, lr_0 = 9.8184e-04
Loss = 5.4418e-01, PNorm = 43.4383, GNorm = 0.9811, lr_0 = 9.5231e-04
Validation rmse = 0.163641
Validation r2 = 0.800643
Validation mse = 0.026778
Epoch 3
Loss = 3.8512e-01, PNorm = 43.5135, GNorm = 4.3613, lr_0 = 9.2367e-04
Validation rmse = 0.145204
Validation r2 = 0.843034
Validation mse = 0.021084
Epoch 4
Loss = 3.8086e-01, PNorm = 43.5683, GNorm = 5.2408, lr_0 = 8.9589e-04
Validation rmse = 0.126615
Validation r2 = 0.880651
Validation mse = 0.016031
Epoch 5
Loss = 2.8106e-01, PNorm = 43.6301, GNorm = 6.9058, lr_0 = 8.6629e-04
Loss = 2.7875e-01, PNorm = 43.6755, GNorm = 3.0318, lr_0 = 8.4024e-04
Validation rmse = 0.094289
Validation r2 = 0.933813
Validation mse = 0.008890
Epoch 6
Loss = 2.3407e-01, PNorm = 43.7196, GNorm = 0.6261, lr_0 = 8.1497e-04
Validation rmse = 0.145741
Validation r2 = 0.841871
Validation mse = 0.021240
Epoch 7
Loss = 2.3323e-01, PNorm = 43.7589, GNorm = 2.1724, lr_0 = 7.9046e-04
Loss = 1.8581e-01, PNorm = 43.7958, GNorm = 2.3266, lr_0 = 7.6668e-04
Validation rmse = 0.105742
Validation r2 = 0.916757
Validation mse = 0.011181
Epoch 8
Loss = 1.9375e-01, PNorm = 43.8279, GNorm = 5.4097, lr_0 = 7.4362e-04
Validation rmse = 0.119110
Validation r2 = 0.894380
Validation mse = 0.014187
Epoch 9
Loss = 1.5559e-01, PNorm = 43.8651, GNorm = 1.8946, lr_0 = 7.1906e-04
Validation rmse = 0.123552
Validation r2 = 0.886356
Validation mse = 0.015265
Epoch 10
Loss = 1.5358e-01, PNorm = 43.8960, GNorm = 0.8082, lr_0 = 6.9743e-04
Loss = 1.2855e-01, PNorm = 43.9212, GNorm = 4.4488, lr_0 = 6.7645e-04
Validation rmse = 0.123742
Validation r2 = 0.886005
Validation mse = 0.015312
Epoch 11
Loss = 1.3623e-01, PNorm = 43.9443, GNorm = 1.9354, lr_0 = 6.5611e-04
Validation rmse = 0.142730
Validation r2 = 0.848338
Validation mse = 0.020372
Epoch 12
Loss = 1.5241e-01, PNorm = 43.9673, GNorm = 4.3988, lr_0 = 6.3638e-04
Validation rmse = 0.108077
Validation r2 = 0.913041
Validation mse = 0.011681
Epoch 13
Loss = 1.4331e-01, PNorm = 43.9925, GNorm = 0.9365, lr_0 = 6.1535e-04
Loss = 1.3275e-01, PNorm = 44.0128, GNorm = 1.4515, lr_0 = 5.9685e-04
Validation rmse = 0.111708
Validation r2 = 0.907100
Validation mse = 0.012479
Epoch 14
Loss = 1.2126e-01, PNorm = 44.0329, GNorm = 2.8437, lr_0 = 5.7889e-04
Validation rmse = 0.129934
Validation r2 = 0.874311
Validation mse = 0.016883
Epoch 15
Loss = 1.2647e-01, PNorm = 44.0572, GNorm = 2.2284, lr_0 = 5.6148e-04
Loss = 1.3051e-01, PNorm = 44.0758, GNorm = 4.6304, lr_0 = 5.4460e-04
Validation rmse = 0.113811
Validation r2 = 0.903570
Validation mse = 0.012953
Epoch 16
Loss = 1.0724e-01, PNorm = 44.0924, GNorm = 1.7792, lr_0 = 5.2822e-04
Validation rmse = 0.117478
Validation r2 = 0.897256
Validation mse = 0.013801
Epoch 17
Loss = 1.0437e-01, PNorm = 44.1089, GNorm = 2.3213, lr_0 = 5.1077e-04
Validation rmse = 0.094441
Validation r2 = 0.933600
Validation mse = 0.008919
Epoch 18
Loss = 1.1737e-01, PNorm = 44.1239, GNorm = 5.7223, lr_0 = 4.9540e-04
Loss = 1.4558e-01, PNorm = 44.1388, GNorm = 2.0303, lr_0 = 4.8050e-04
Validation rmse = 0.127330
Validation r2 = 0.879300
Validation mse = 0.016213
Epoch 19
Loss = 1.1182e-01, PNorm = 44.1534, GNorm = 1.3149, lr_0 = 4.6605e-04
Validation rmse = 0.127923
Validation r2 = 0.878173
Validation mse = 0.016364
Epoch 20
Loss = 1.0829e-01, PNorm = 44.1723, GNorm = 0.9708, lr_0 = 4.5204e-04
Validation rmse = 0.106263
Validation r2 = 0.915936
Validation mse = 0.011292
Epoch 21
Loss = 1.0307e-01, PNorm = 44.1860, GNorm = 0.8362, lr_0 = 4.3710e-04
Loss = 1.1110e-01, PNorm = 44.2021, GNorm = 2.6174, lr_0 = 4.2396e-04
Validation rmse = 0.101027
Validation r2 = 0.924016
Validation mse = 0.010206
Epoch 22
Loss = 1.0735e-01, PNorm = 44.2153, GNorm = 1.1917, lr_0 = 4.1120e-04
Validation rmse = 0.104960
Validation r2 = 0.917985
Validation mse = 0.011017
Epoch 23
Loss = 7.7465e-02, PNorm = 44.2285, GNorm = 0.9766, lr_0 = 3.9884e-04
Loss = 1.1123e-01, PNorm = 44.2406, GNorm = 1.8807, lr_0 = 3.8684e-04
Validation rmse = 0.095271
Validation r2 = 0.932428
Validation mse = 0.009077
Epoch 24
Loss = 9.9248e-02, PNorm = 44.2516, GNorm = 0.9613, lr_0 = 3.7521e-04
Validation rmse = 0.093960
Validation r2 = 0.934274
Validation mse = 0.008829
Epoch 25
Loss = 9.1632e-02, PNorm = 44.2644, GNorm = 1.5083, lr_0 = 3.6392e-04
Validation rmse = 0.122301
Validation r2 = 0.888646
Validation mse = 0.014958
Epoch 26
Loss = 8.9233e-02, PNorm = 44.2784, GNorm = 0.9271, lr_0 = 3.5190e-04
Loss = 9.3071e-02, PNorm = 44.2906, GNorm = 0.9085, lr_0 = 3.4132e-04
Validation rmse = 0.106644
Validation r2 = 0.915332
Validation mse = 0.011373
Epoch 27
Loss = 8.8011e-02, PNorm = 44.3028, GNorm = 0.7913, lr_0 = 3.3105e-04
Validation rmse = 0.097840
Validation r2 = 0.928734
Validation mse = 0.009573
Epoch 28
Loss = 8.9562e-02, PNorm = 44.3112, GNorm = 2.2086, lr_0 = 3.2109e-04
Validation rmse = 0.091861
Validation r2 = 0.937178
Validation mse = 0.008438
Epoch 29
Loss = 8.7529e-02, PNorm = 44.3217, GNorm = 1.2303, lr_0 = 3.1144e-04
Loss = 7.9824e-02, PNorm = 44.3317, GNorm = 2.0056, lr_0 = 3.0207e-04
Validation rmse = 0.101719
Validation r2 = 0.922971
Validation mse = 0.010347
Epoch 30
Loss = 8.0035e-02, PNorm = 44.3412, GNorm = 1.2079, lr_0 = 2.9209e-04
Validation rmse = 0.081849
Validation r2 = 0.950126
Validation mse = 0.006699
Epoch 31
Loss = 8.6569e-02, PNorm = 44.3526, GNorm = 1.0630, lr_0 = 2.8331e-04
Loss = 8.1365e-02, PNorm = 44.3631, GNorm = 2.2390, lr_0 = 2.7478e-04
Validation rmse = 0.102706
Validation r2 = 0.921470
Validation mse = 0.010548
Epoch 32
Loss = 8.3544e-02, PNorm = 44.3732, GNorm = 1.0791, lr_0 = 2.6652e-04
Validation rmse = 0.098878
Validation r2 = 0.927214
Validation mse = 0.009777
Epoch 33
Loss = 6.9910e-02, PNorm = 44.3822, GNorm = 0.8713, lr_0 = 2.5850e-04
Validation rmse = 0.100895
Validation r2 = 0.924214
Validation mse = 0.010180
Epoch 34
Loss = 6.5297e-02, PNorm = 44.3927, GNorm = 0.9491, lr_0 = 2.4996e-04
Loss = 7.8462e-02, PNorm = 44.4031, GNorm = 2.6496, lr_0 = 2.4245e-04
Validation rmse = 0.095680
Validation r2 = 0.931846
Validation mse = 0.009155
Epoch 35
Loss = 8.0020e-02, PNorm = 44.4104, GNorm = 0.8032, lr_0 = 2.3515e-04
Validation rmse = 0.082082
Validation r2 = 0.949842
Validation mse = 0.006737
Epoch 36
Loss = 6.3032e-02, PNorm = 44.4196, GNorm = 0.6327, lr_0 = 2.2808e-04
Validation rmse = 0.083870
Validation r2 = 0.947633
Validation mse = 0.007034
Epoch 37
Loss = 8.9585e-02, PNorm = 44.4289, GNorm = 0.9642, lr_0 = 2.2122e-04
Loss = 7.6845e-02, PNorm = 44.4371, GNorm = 3.1575, lr_0 = 2.1457e-04
Validation rmse = 0.104691
Validation r2 = 0.918405
Validation mse = 0.010960
Epoch 38
Loss = 6.7755e-02, PNorm = 44.4456, GNorm = 0.5703, lr_0 = 2.0748e-04
Validation rmse = 0.089728
Validation r2 = 0.940062
Validation mse = 0.008051
Epoch 39
Loss = 6.3988e-02, PNorm = 44.4548, GNorm = 0.4756, lr_0 = 2.0124e-04
Loss = 7.3360e-02, PNorm = 44.4618, GNorm = 1.6389, lr_0 = 1.9519e-04
Validation rmse = 0.105278
Validation r2 = 0.917487
Validation mse = 0.011083
Epoch 40
Loss = 6.9106e-02, PNorm = 44.4685, GNorm = 2.2729, lr_0 = 1.8932e-04
Validation rmse = 0.072440
Validation r2 = 0.960933
Validation mse = 0.005248
Epoch 41
Loss = 6.9307e-02, PNorm = 44.4760, GNorm = 2.4444, lr_0 = 1.8362e-04
Validation rmse = 0.102320
Validation r2 = 0.922059
Validation mse = 0.010469
Epoch 42
Loss = 7.4901e-02, PNorm = 44.4844, GNorm = 0.6872, lr_0 = 1.7756e-04
Loss = 6.6424e-02, PNorm = 44.4909, GNorm = 1.0690, lr_0 = 1.7222e-04
Validation rmse = 0.079438
Validation r2 = 0.953021
Validation mse = 0.006310
Epoch 43
Loss = 7.5478e-02, PNorm = 44.4982, GNorm = 1.8037, lr_0 = 1.6704e-04
Validation rmse = 0.079026
Validation r2 = 0.953507
Validation mse = 0.006245
Epoch 44
Loss = 6.9550e-02, PNorm = 44.5046, GNorm = 0.5729, lr_0 = 1.6201e-04
Validation rmse = 0.081622
Validation r2 = 0.950403
Validation mse = 0.006662
Epoch 45
Loss = 7.3420e-02, PNorm = 44.5111, GNorm = 0.7767, lr_0 = 1.5714e-04
Loss = 6.3938e-02, PNorm = 44.5173, GNorm = 0.8595, lr_0 = 1.5241e-04
Validation rmse = 0.098160
Validation r2 = 0.928268
Validation mse = 0.009635
Epoch 46
Loss = 7.2943e-02, PNorm = 44.5244, GNorm = 1.7552, lr_0 = 1.4738e-04
Validation rmse = 0.081044
Validation r2 = 0.951103
Validation mse = 0.006568
Epoch 47
Loss = 6.6583e-02, PNorm = 44.5304, GNorm = 0.8747, lr_0 = 1.4295e-04
Loss = 6.1901e-02, PNorm = 44.5357, GNorm = 0.5494, lr_0 = 1.3865e-04
Validation rmse = 0.084930
Validation r2 = 0.946300
Validation mse = 0.007213
Epoch 48
Loss = 5.7642e-02, PNorm = 44.5415, GNorm = 0.6258, lr_0 = 1.3448e-04
Validation rmse = 0.083831
Validation r2 = 0.947681
Validation mse = 0.007028
Epoch 49
Loss = 5.5963e-02, PNorm = 44.5466, GNorm = 0.6299, lr_0 = 1.3043e-04
Validation rmse = 0.085274
Validation r2 = 0.945865
Validation mse = 0.007272
Epoch 50
Loss = 5.5893e-02, PNorm = 44.5511, GNorm = 0.6979, lr_0 = 1.2651e-04
Loss = 6.4303e-02, PNorm = 44.5558, GNorm = 2.3603, lr_0 = 1.2270e-04
Validation rmse = 0.096869
Validation r2 = 0.930141
Validation mse = 0.009384
Epoch 51
Loss = 7.3625e-02, PNorm = 44.5617, GNorm = 1.4946, lr_0 = 1.1865e-04
Validation rmse = 0.090337
Validation r2 = 0.939246
Validation mse = 0.008161
Epoch 52
Loss = 5.0626e-02, PNorm = 44.5665, GNorm = 0.5707, lr_0 = 1.1508e-04
Validation rmse = 0.078466
Validation r2 = 0.954164
Validation mse = 0.006157
Epoch 53
Loss = 2.9821e-02, PNorm = 44.5710, GNorm = 0.4623, lr_0 = 1.1162e-04
Loss = 5.4124e-02, PNorm = 44.5751, GNorm = 1.6070, lr_0 = 1.0826e-04
Validation rmse = 0.084522
Validation r2 = 0.946815
Validation mse = 0.007144
Epoch 54
Loss = 5.7638e-02, PNorm = 44.5792, GNorm = 1.2680, lr_0 = 1.0501e-04
Validation rmse = 0.088712
Validation r2 = 0.941411
Validation mse = 0.007870
Epoch 55
Loss = 5.3264e-02, PNorm = 44.5841, GNorm = 0.8447, lr_0 = 1.0154e-04
Loss = 5.9921e-02, PNorm = 44.5880, GNorm = 0.9355, lr_0 = 1.0000e-04
Validation rmse = 0.083160
Validation r2 = 0.948516
Validation mse = 0.006916
Epoch 56
Loss = 5.7100e-02, PNorm = 44.5925, GNorm = 1.2421, lr_0 = 1.0000e-04
Validation rmse = 0.077753
Validation r2 = 0.954992
Validation mse = 0.006046
Epoch 57
Loss = 5.4780e-02, PNorm = 44.5966, GNorm = 0.8402, lr_0 = 1.0000e-04
Validation rmse = 0.082908
Validation r2 = 0.948827
Validation mse = 0.006874
Epoch 58
Loss = 6.8916e-02, PNorm = 44.6001, GNorm = 1.0908, lr_0 = 1.0000e-04
Loss = 5.7281e-02, PNorm = 44.6049, GNorm = 1.0619, lr_0 = 1.0000e-04
Validation rmse = 0.080103
Validation r2 = 0.952231
Validation mse = 0.006417
Epoch 59
Loss = 6.1500e-02, PNorm = 44.6088, GNorm = 0.4974, lr_0 = 1.0000e-04
Validation rmse = 0.085978
Validation r2 = 0.944967
Validation mse = 0.007392
Model 0 best validation rmse = 0.072440 on epoch 40
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.155825
Model 0 test r2 = 0.608661
Model 0 test mse = 0.024281
Ensemble test rmse = 0.155825
Ensemble test r2 = 0.608661
Ensemble test mse = 0.024281
Fold 2
Splitting data with seed 2
Total size = 695 | train size = 688 | val size = 7 | test size = 337
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.2066e-01, PNorm = 43.2663, GNorm = 6.3232, lr_0 = 4.8077e-04
Validation rmse = 0.221685
Validation r2 = 0.527335
Validation mse = 0.049144
Epoch 1
Loss = 7.4172e-01, PNorm = 43.3063, GNorm = 10.2582, lr_0 = 8.6154e-04
Validation rmse = 0.289715
Validation r2 = 0.192722
Validation mse = 0.083935
Epoch 2
Loss = 5.4775e-01, PNorm = 43.3640, GNorm = 2.7584, lr_0 = 9.8184e-04
Loss = 5.1193e-01, PNorm = 43.4323, GNorm = 3.0777, lr_0 = 9.5231e-04
Validation rmse = 0.247398
Validation r2 = 0.411329
Validation mse = 0.061206
Epoch 3
Loss = 4.0342e-01, PNorm = 43.5043, GNorm = 2.7773, lr_0 = 9.2367e-04
Validation rmse = 0.191165
Validation r2 = 0.648524
Validation mse = 0.036544
Epoch 4
Loss = 2.9075e-01, PNorm = 43.5626, GNorm = 1.4844, lr_0 = 8.9589e-04
Validation rmse = 0.183935
Validation r2 = 0.674607
Validation mse = 0.033832
Epoch 5
Loss = 2.4084e-01, PNorm = 43.6211, GNorm = 3.1687, lr_0 = 8.6629e-04
Loss = 2.2085e-01, PNorm = 43.6676, GNorm = 5.7862, lr_0 = 8.4024e-04
Validation rmse = 0.130837
Validation r2 = 0.835356
Validation mse = 0.017118
Epoch 6
Loss = 2.1459e-01, PNorm = 43.7086, GNorm = 1.0551, lr_0 = 8.1497e-04
Validation rmse = 0.108083
Validation r2 = 0.887643
Validation mse = 0.011682
Epoch 7
Loss = 1.5788e-01, PNorm = 43.7448, GNorm = 2.4909, lr_0 = 7.9046e-04
Loss = 1.6919e-01, PNorm = 43.7717, GNorm = 2.8536, lr_0 = 7.6668e-04
Validation rmse = 0.211844
Validation r2 = 0.568367
Validation mse = 0.044878
Epoch 8
Loss = 1.8712e-01, PNorm = 43.8045, GNorm = 2.1629, lr_0 = 7.4362e-04
Validation rmse = 0.127119
Validation r2 = 0.844582
Validation mse = 0.016159
Epoch 9
Loss = 1.5359e-01, PNorm = 43.8398, GNorm = 1.3626, lr_0 = 7.1906e-04
Validation rmse = 0.117574
Validation r2 = 0.867044
Validation mse = 0.013824
Epoch 10
Loss = 1.3166e-01, PNorm = 43.8610, GNorm = 2.6945, lr_0 = 6.9743e-04
Loss = 1.8182e-01, PNorm = 43.8826, GNorm = 5.0100, lr_0 = 6.7645e-04
Validation rmse = 0.052779
Validation r2 = 0.973208
Validation mse = 0.002786
Epoch 11
Loss = 1.4556e-01, PNorm = 43.9060, GNorm = 2.6619, lr_0 = 6.5611e-04
Validation rmse = 0.111283
Validation r2 = 0.880893
Validation mse = 0.012384
Epoch 12
Loss = 1.4401e-01, PNorm = 43.9305, GNorm = 2.4646, lr_0 = 6.3638e-04
Validation rmse = 0.100421
Validation r2 = 0.903009
Validation mse = 0.010084
Epoch 13
Loss = 1.2478e-01, PNorm = 43.9520, GNorm = 1.2089, lr_0 = 6.1535e-04
Loss = 1.1233e-01, PNorm = 43.9688, GNorm = 1.4772, lr_0 = 5.9685e-04
Validation rmse = 0.110587
Validation r2 = 0.882378
Validation mse = 0.012229
Epoch 14
Loss = 1.0944e-01, PNorm = 43.9852, GNorm = 0.8541, lr_0 = 5.7889e-04
Validation rmse = 0.090983
Validation r2 = 0.920384
Validation mse = 0.008278
Epoch 15
Loss = 1.0582e-01, PNorm = 44.0008, GNorm = 1.3089, lr_0 = 5.6148e-04
Loss = 1.1738e-01, PNorm = 44.0173, GNorm = 1.6413, lr_0 = 5.4460e-04
Validation rmse = 0.087305
Validation r2 = 0.926691
Validation mse = 0.007622
Epoch 16
Loss = 1.0451e-01, PNorm = 44.0291, GNorm = 1.2164, lr_0 = 5.2822e-04
Validation rmse = 0.138272
Validation r2 = 0.816113
Validation mse = 0.019119
Epoch 17
Loss = 1.0240e-01, PNorm = 44.0450, GNorm = 2.6771, lr_0 = 5.1077e-04
Validation rmse = 0.113034
Validation r2 = 0.877114
Validation mse = 0.012777
Epoch 18
Loss = 8.0163e-02, PNorm = 44.0602, GNorm = 0.6318, lr_0 = 4.9540e-04
Loss = 1.2473e-01, PNorm = 44.0753, GNorm = 3.0125, lr_0 = 4.8050e-04
Validation rmse = 0.072507
Validation r2 = 0.949436
Validation mse = 0.005257
Epoch 19
Loss = 9.6550e-02, PNorm = 44.0919, GNorm = 1.1483, lr_0 = 4.6605e-04
Validation rmse = 0.162773
Validation r2 = 0.745172
Validation mse = 0.026495
Epoch 20
Loss = 1.0344e-01, PNorm = 44.1042, GNorm = 1.8194, lr_0 = 4.5204e-04
Validation rmse = 0.087019
Validation r2 = 0.927170
Validation mse = 0.007572
Epoch 21
Loss = 1.1020e-01, PNorm = 44.1209, GNorm = 0.8684, lr_0 = 4.3710e-04
Loss = 9.8754e-02, PNorm = 44.1371, GNorm = 2.6152, lr_0 = 4.2396e-04
Validation rmse = 0.064989
Validation r2 = 0.959378
Validation mse = 0.004224
Epoch 22
Loss = 9.2908e-02, PNorm = 44.1500, GNorm = 2.7880, lr_0 = 4.1120e-04
Validation rmse = 0.060458
Validation r2 = 0.964844
Validation mse = 0.003655
Epoch 23
Loss = 1.3697e-01, PNorm = 44.1632, GNorm = 1.9731, lr_0 = 3.9884e-04
Loss = 1.1786e-01, PNorm = 44.1794, GNorm = 3.1185, lr_0 = 3.8684e-04
Validation rmse = 0.170501
Validation r2 = 0.720401
Validation mse = 0.029071
Epoch 24
Loss = 1.0831e-01, PNorm = 44.1960, GNorm = 1.1159, lr_0 = 3.7521e-04
Validation rmse = 0.094804
Validation r2 = 0.913557
Validation mse = 0.008988
Epoch 25
Loss = 1.0320e-01, PNorm = 44.2101, GNorm = 1.3746, lr_0 = 3.6392e-04
Validation rmse = 0.068180
Validation r2 = 0.955291
Validation mse = 0.004649
Epoch 26
Loss = 7.6311e-02, PNorm = 44.2256, GNorm = 1.2767, lr_0 = 3.5190e-04
Loss = 9.9384e-02, PNorm = 44.2381, GNorm = 1.7232, lr_0 = 3.4132e-04
Validation rmse = 0.083150
Validation r2 = 0.933502
Validation mse = 0.006914
Epoch 27
Loss = 1.0444e-01, PNorm = 44.2499, GNorm = 0.8653, lr_0 = 3.3105e-04
Validation rmse = 0.143076
Validation r2 = 0.803115
Validation mse = 0.020471
Epoch 28
Loss = 9.7934e-02, PNorm = 44.2609, GNorm = 1.0685, lr_0 = 3.2109e-04
Validation rmse = 0.095806
Validation r2 = 0.911719
Validation mse = 0.009179
Epoch 29
Loss = 9.2030e-02, PNorm = 44.2714, GNorm = 0.3967, lr_0 = 3.1144e-04
Loss = 8.0907e-02, PNorm = 44.2819, GNorm = 2.1342, lr_0 = 3.0207e-04
Validation rmse = 0.141323
Validation r2 = 0.807910
Validation mse = 0.019972
Epoch 30
Loss = 9.0788e-02, PNorm = 44.2913, GNorm = 1.2621, lr_0 = 2.9209e-04
Validation rmse = 0.068099
Validation r2 = 0.955397
Validation mse = 0.004638
Epoch 31
Loss = 6.3566e-02, PNorm = 44.3024, GNorm = 2.0039, lr_0 = 2.8331e-04
Loss = 8.8293e-02, PNorm = 44.3129, GNorm = 1.1259, lr_0 = 2.7478e-04
Validation rmse = 0.097684
Validation r2 = 0.908224
Validation mse = 0.009542
Epoch 32
Loss = 8.0556e-02, PNorm = 44.3220, GNorm = 1.2445, lr_0 = 2.6652e-04
Validation rmse = 0.091408
Validation r2 = 0.919638
Validation mse = 0.008355
Epoch 33
Loss = 6.3686e-02, PNorm = 44.3302, GNorm = 1.7120, lr_0 = 2.5850e-04
Validation rmse = 0.099159
Validation r2 = 0.905431
Validation mse = 0.009833
Epoch 34
Loss = 6.2950e-02, PNorm = 44.3398, GNorm = 0.5646, lr_0 = 2.4996e-04
Loss = 7.6950e-02, PNorm = 44.3482, GNorm = 1.2316, lr_0 = 2.4245e-04
Validation rmse = 0.102960
Validation r2 = 0.898043
Validation mse = 0.010601
Epoch 35
Loss = 7.3973e-02, PNorm = 44.3566, GNorm = 2.2475, lr_0 = 2.3515e-04
Validation rmse = 0.118501
Validation r2 = 0.864940
Validation mse = 0.014043
Epoch 36
Loss = 6.4695e-02, PNorm = 44.3652, GNorm = 0.4891, lr_0 = 2.2808e-04
Validation rmse = 0.105233
Validation r2 = 0.893491
Validation mse = 0.011074
Epoch 37
Loss = 6.8844e-02, PNorm = 44.3731, GNorm = 0.4512, lr_0 = 2.2122e-04
Loss = 6.6367e-02, PNorm = 44.3810, GNorm = 1.4172, lr_0 = 2.1457e-04
Validation rmse = 0.115031
Validation r2 = 0.872735
Validation mse = 0.013232
Epoch 38
Loss = 7.8208e-02, PNorm = 44.3899, GNorm = 3.6549, lr_0 = 2.0748e-04
Validation rmse = 0.084106
Validation r2 = 0.931965
Validation mse = 0.007074
Epoch 39
Loss = 7.2031e-02, PNorm = 44.3976, GNorm = 1.2484, lr_0 = 2.0124e-04
Loss = 6.5952e-02, PNorm = 44.4052, GNorm = 0.6821, lr_0 = 1.9519e-04
Validation rmse = 0.108371
Validation r2 = 0.887045
Validation mse = 0.011744
Epoch 40
Loss = 6.8554e-02, PNorm = 44.4114, GNorm = 1.5740, lr_0 = 1.8932e-04
Validation rmse = 0.098086
Validation r2 = 0.907467
Validation mse = 0.009621
Epoch 41
Loss = 7.1081e-02, PNorm = 44.4187, GNorm = 1.0834, lr_0 = 1.8362e-04
Validation rmse = 0.091726
Validation r2 = 0.919078
Validation mse = 0.008414
Epoch 42
Loss = 8.3081e-02, PNorm = 44.4275, GNorm = 3.2489, lr_0 = 1.7756e-04
Loss = 7.1079e-02, PNorm = 44.4357, GNorm = 2.0110, lr_0 = 1.7222e-04
Validation rmse = 0.102452
Validation r2 = 0.899046
Validation mse = 0.010496
Epoch 43
Loss = 5.4371e-02, PNorm = 44.4418, GNorm = 0.5391, lr_0 = 1.6704e-04
Validation rmse = 0.109739
Validation r2 = 0.884174
Validation mse = 0.012043
Epoch 44
Loss = 5.4546e-02, PNorm = 44.4481, GNorm = 0.7287, lr_0 = 1.6201e-04
Validation rmse = 0.092839
Validation r2 = 0.917102
Validation mse = 0.008619
Epoch 45
Loss = 4.5916e-02, PNorm = 44.4539, GNorm = 0.9643, lr_0 = 1.5714e-04
Loss = 6.4232e-02, PNorm = 44.4597, GNorm = 0.8863, lr_0 = 1.5241e-04
Validation rmse = 0.095536
Validation r2 = 0.912216
Validation mse = 0.009127
Epoch 46
Loss = 6.7377e-02, PNorm = 44.4659, GNorm = 0.7443, lr_0 = 1.4738e-04
Validation rmse = 0.128000
Validation r2 = 0.842420
Validation mse = 0.016384
Epoch 47
Loss = 7.6950e-02, PNorm = 44.4719, GNorm = 1.1178, lr_0 = 1.4295e-04
Loss = 6.2453e-02, PNorm = 44.4769, GNorm = 1.8392, lr_0 = 1.3865e-04
Validation rmse = 0.113758
Validation r2 = 0.875535
Validation mse = 0.012941
Epoch 48
Loss = 5.8195e-02, PNorm = 44.4829, GNorm = 0.8546, lr_0 = 1.3448e-04
Validation rmse = 0.103382
Validation r2 = 0.897205
Validation mse = 0.010688
Epoch 49
Loss = 6.5878e-02, PNorm = 44.4875, GNorm = 1.2623, lr_0 = 1.3043e-04
Validation rmse = 0.096012
Validation r2 = 0.911339
Validation mse = 0.009218
Epoch 50
Loss = 5.6010e-02, PNorm = 44.4928, GNorm = 0.9901, lr_0 = 1.2651e-04
Loss = 5.8526e-02, PNorm = 44.4973, GNorm = 1.7382, lr_0 = 1.2270e-04
Validation rmse = 0.105248
Validation r2 = 0.893462
Validation mse = 0.011077
Epoch 51
Loss = 5.2959e-02, PNorm = 44.5028, GNorm = 1.4439, lr_0 = 1.1865e-04
Validation rmse = 0.113856
Validation r2 = 0.875320
Validation mse = 0.012963
Epoch 52
Loss = 5.5064e-02, PNorm = 44.5072, GNorm = 0.8639, lr_0 = 1.1508e-04
Validation rmse = 0.117474
Validation r2 = 0.867271
Validation mse = 0.013800
Epoch 53
Loss = 6.2106e-02, PNorm = 44.5115, GNorm = 1.1732, lr_0 = 1.1162e-04
Loss = 5.4395e-02, PNorm = 44.5161, GNorm = 0.8739, lr_0 = 1.0826e-04
Validation rmse = 0.102482
Validation r2 = 0.898987
Validation mse = 0.010503
Epoch 54
Loss = 6.1603e-02, PNorm = 44.5209, GNorm = 0.9299, lr_0 = 1.0501e-04
Validation rmse = 0.113197
Validation r2 = 0.876760
Validation mse = 0.012814
Epoch 55
Loss = 5.5112e-02, PNorm = 44.5251, GNorm = 1.2364, lr_0 = 1.0154e-04
Loss = 5.6751e-02, PNorm = 44.5292, GNorm = 1.5952, lr_0 = 1.0000e-04
Validation rmse = 0.114271
Validation r2 = 0.874411
Validation mse = 0.013058
Epoch 56
Loss = 5.7096e-02, PNorm = 44.5330, GNorm = 2.0176, lr_0 = 1.0000e-04
Validation rmse = 0.100480
Validation r2 = 0.902895
Validation mse = 0.010096
Epoch 57
Loss = 4.7696e-02, PNorm = 44.5379, GNorm = 1.0424, lr_0 = 1.0000e-04
Validation rmse = 0.098535
Validation r2 = 0.906617
Validation mse = 0.009709
Epoch 58
Loss = 7.0202e-02, PNorm = 44.5424, GNorm = 1.6249, lr_0 = 1.0000e-04
Loss = 5.3862e-02, PNorm = 44.5470, GNorm = 0.8599, lr_0 = 1.0000e-04
Validation rmse = 0.091808
Validation r2 = 0.918933
Validation mse = 0.008429
Epoch 59
Loss = 5.6974e-02, PNorm = 44.5513, GNorm = 1.2808, lr_0 = 1.0000e-04
Validation rmse = 0.099693
Validation r2 = 0.904411
Validation mse = 0.009939
Model 0 best validation rmse = 0.052779 on epoch 10
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.141860
Model 0 test r2 = 0.675659
Model 0 test mse = 0.020124
Ensemble test rmse = 0.141860
Ensemble test r2 = 0.675659
Ensemble test mse = 0.020124
Fold 3
Splitting data with seed 3
Total size = 695 | train size = 688 | val size = 7 | test size = 337
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.6190e-01, PNorm = 43.2639, GNorm = 4.9444, lr_0 = 4.8077e-04
Validation rmse = 0.267508
Validation r2 = 0.475708
Validation mse = 0.071560
Epoch 1
Loss = 8.1102e-01, PNorm = 43.2994, GNorm = 7.5669, lr_0 = 8.6154e-04
Validation rmse = 0.197706
Validation r2 = 0.713623
Validation mse = 0.039088
Epoch 2
Loss = 5.4993e-01, PNorm = 43.3653, GNorm = 5.7595, lr_0 = 9.8184e-04
Loss = 4.6690e-01, PNorm = 43.4416, GNorm = 1.5245, lr_0 = 9.5231e-04
Validation rmse = 0.146056
Validation r2 = 0.843708
Validation mse = 0.021332
Epoch 3
Loss = 4.1659e-01, PNorm = 43.5149, GNorm = 3.5425, lr_0 = 9.2367e-04
Validation rmse = 0.167414
Validation r2 = 0.794655
Validation mse = 0.028028
Epoch 4
Loss = 3.1925e-01, PNorm = 43.5756, GNorm = 2.4069, lr_0 = 8.9589e-04
Validation rmse = 0.188518
Validation r2 = 0.739622
Validation mse = 0.035539
Epoch 5
Loss = 2.3335e-01, PNorm = 43.6434, GNorm = 1.1773, lr_0 = 8.6629e-04
Loss = 2.8688e-01, PNorm = 43.6933, GNorm = 1.5371, lr_0 = 8.4024e-04
Validation rmse = 0.147156
Validation r2 = 0.841345
Validation mse = 0.021655
Epoch 6
Loss = 2.3563e-01, PNorm = 43.7409, GNorm = 2.5859, lr_0 = 8.1497e-04
Validation rmse = 0.164109
Validation r2 = 0.802683
Validation mse = 0.026932
Epoch 7
Loss = 2.3254e-01, PNorm = 43.7878, GNorm = 6.0833, lr_0 = 7.9046e-04
Loss = 2.4777e-01, PNorm = 43.8304, GNorm = 3.3814, lr_0 = 7.6668e-04
Validation rmse = 0.159045
Validation r2 = 0.814672
Validation mse = 0.025295
Epoch 8
Loss = 1.9185e-01, PNorm = 43.8726, GNorm = 2.0759, lr_0 = 7.4362e-04
Validation rmse = 0.149337
Validation r2 = 0.836607
Validation mse = 0.022302
Epoch 9
Loss = 1.6198e-01, PNorm = 43.9036, GNorm = 1.3586, lr_0 = 7.1906e-04
Validation rmse = 0.150796
Validation r2 = 0.833397
Validation mse = 0.022740
Epoch 10
Loss = 1.5221e-01, PNorm = 43.9295, GNorm = 0.6719, lr_0 = 6.9743e-04
Loss = 1.2841e-01, PNorm = 43.9525, GNorm = 0.9682, lr_0 = 6.7645e-04
Validation rmse = 0.120655
Validation r2 = 0.893342
Validation mse = 0.014558
Epoch 11
Loss = 1.3211e-01, PNorm = 43.9733, GNorm = 2.4225, lr_0 = 6.5611e-04
Validation rmse = 0.111669
Validation r2 = 0.908637
Validation mse = 0.012470
Epoch 12
Loss = 1.4264e-01, PNorm = 43.9951, GNorm = 0.8140, lr_0 = 6.3638e-04
Validation rmse = 0.120445
Validation r2 = 0.893713
Validation mse = 0.014507
Epoch 13
Loss = 1.5840e-01, PNorm = 44.0208, GNorm = 1.5967, lr_0 = 6.1535e-04
Loss = 1.2933e-01, PNorm = 44.0391, GNorm = 0.9370, lr_0 = 5.9685e-04
Validation rmse = 0.104156
Validation r2 = 0.920518
Validation mse = 0.010849
Epoch 14
Loss = 1.2217e-01, PNorm = 44.0603, GNorm = 2.0206, lr_0 = 5.7889e-04
Validation rmse = 0.129692
Validation r2 = 0.876768
Validation mse = 0.016820
Epoch 15
Loss = 9.7188e-02, PNorm = 44.0754, GNorm = 1.8412, lr_0 = 5.6148e-04
Loss = 1.4324e-01, PNorm = 44.0959, GNorm = 0.5995, lr_0 = 5.4460e-04
Validation rmse = 0.117378
Validation r2 = 0.899058
Validation mse = 0.013778
Epoch 16
Loss = 1.1325e-01, PNorm = 44.1142, GNorm = 0.7394, lr_0 = 5.2822e-04
Validation rmse = 0.104230
Validation r2 = 0.920405
Validation mse = 0.010864
Epoch 17
Loss = 9.1565e-02, PNorm = 44.1334, GNorm = 2.4038, lr_0 = 5.1077e-04
Validation rmse = 0.102014
Validation r2 = 0.923754
Validation mse = 0.010407
Epoch 18
Loss = 1.1393e-01, PNorm = 44.1498, GNorm = 1.4197, lr_0 = 4.9540e-04
Loss = 1.0279e-01, PNorm = 44.1674, GNorm = 0.6571, lr_0 = 4.8050e-04
Validation rmse = 0.088452
Validation r2 = 0.942679
Validation mse = 0.007824
Epoch 19
Loss = 1.1063e-01, PNorm = 44.1808, GNorm = 3.5097, lr_0 = 4.6605e-04
Validation rmse = 0.089357
Validation r2 = 0.941500
Validation mse = 0.007985
Epoch 20
Loss = 8.8215e-02, PNorm = 44.1990, GNorm = 0.9178, lr_0 = 4.5204e-04
Validation rmse = 0.107041
Validation r2 = 0.916054
Validation mse = 0.011458
Epoch 21
Loss = 9.7662e-02, PNorm = 44.2166, GNorm = 1.0906, lr_0 = 4.3710e-04
Loss = 1.0100e-01, PNorm = 44.2343, GNorm = 0.6296, lr_0 = 4.2396e-04
Validation rmse = 0.113778
Validation r2 = 0.905155
Validation mse = 0.012945
Epoch 22
Loss = 9.4619e-02, PNorm = 44.2478, GNorm = 1.2913, lr_0 = 4.1120e-04
Validation rmse = 0.122935
Validation r2 = 0.889274
Validation mse = 0.015113
Epoch 23
Loss = 9.2515e-02, PNorm = 44.2631, GNorm = 1.1060, lr_0 = 3.9884e-04
Loss = 9.4574e-02, PNorm = 44.2776, GNorm = 0.6118, lr_0 = 3.8684e-04
Validation rmse = 0.092916
Validation r2 = 0.936748
Validation mse = 0.008633
Epoch 24
Loss = 1.0089e-01, PNorm = 44.2902, GNorm = 1.3081, lr_0 = 3.7521e-04
Validation rmse = 0.114946
Validation r2 = 0.903197
Validation mse = 0.013213
Epoch 25
Loss = 8.4688e-02, PNorm = 44.3074, GNorm = 1.1666, lr_0 = 3.6392e-04
Validation rmse = 0.096971
Validation r2 = 0.931106
Validation mse = 0.009403
Epoch 26
Loss = 9.9711e-02, PNorm = 44.3240, GNorm = 2.5798, lr_0 = 3.5190e-04
Loss = 8.6550e-02, PNorm = 44.3357, GNorm = 0.7468, lr_0 = 3.4132e-04
Validation rmse = 0.073389
Validation r2 = 0.960540
Validation mse = 0.005386
Epoch 27
Loss = 8.6119e-02, PNorm = 44.3495, GNorm = 0.7505, lr_0 = 3.3105e-04
Validation rmse = 0.108146
Validation r2 = 0.914312
Validation mse = 0.011696
Epoch 28
Loss = 8.4306e-02, PNorm = 44.3625, GNorm = 2.4134, lr_0 = 3.2109e-04
Validation rmse = 0.093478
Validation r2 = 0.935980
Validation mse = 0.008738
Epoch 29
Loss = 7.2707e-02, PNorm = 44.3755, GNorm = 0.6173, lr_0 = 3.1144e-04
Loss = 8.3512e-02, PNorm = 44.3892, GNorm = 2.2180, lr_0 = 3.0207e-04
Validation rmse = 0.118060
Validation r2 = 0.897881
Validation mse = 0.013938
Epoch 30
Loss = 8.2534e-02, PNorm = 44.4028, GNorm = 1.0612, lr_0 = 2.9209e-04
Validation rmse = 0.080031
Validation r2 = 0.953073
Validation mse = 0.006405
Epoch 31
Loss = 7.0177e-02, PNorm = 44.4147, GNorm = 1.0683, lr_0 = 2.8331e-04
Loss = 8.5524e-02, PNorm = 44.4280, GNorm = 0.7595, lr_0 = 2.7478e-04
Validation rmse = 0.108102
Validation r2 = 0.914382
Validation mse = 0.011686
Epoch 32
Loss = 7.2561e-02, PNorm = 44.4389, GNorm = 1.7356, lr_0 = 2.6652e-04
Validation rmse = 0.074072
Validation r2 = 0.959801
Validation mse = 0.005487
Epoch 33
Loss = 7.9409e-02, PNorm = 44.4499, GNorm = 1.2769, lr_0 = 2.5850e-04
Validation rmse = 0.113032
Validation r2 = 0.906394
Validation mse = 0.012776
Epoch 34
Loss = 7.9481e-02, PNorm = 44.4628, GNorm = 0.9344, lr_0 = 2.4996e-04
Loss = 7.6017e-02, PNorm = 44.4731, GNorm = 1.5412, lr_0 = 2.4245e-04
Validation rmse = 0.082778
Validation r2 = 0.949797
Validation mse = 0.006852
Epoch 35
Loss = 8.3520e-02, PNorm = 44.4856, GNorm = 1.7807, lr_0 = 2.3515e-04
Validation rmse = 0.091568
Validation r2 = 0.938569
Validation mse = 0.008385
Epoch 36
Loss = 6.9374e-02, PNorm = 44.4949, GNorm = 0.9184, lr_0 = 2.2808e-04
Validation rmse = 0.088186
Validation r2 = 0.943024
Validation mse = 0.007777
Epoch 37
Loss = 8.9402e-02, PNorm = 44.5062, GNorm = 1.8621, lr_0 = 2.2122e-04
Loss = 6.4606e-02, PNorm = 44.5165, GNorm = 1.1597, lr_0 = 2.1457e-04
Validation rmse = 0.095484
Validation r2 = 0.933202
Validation mse = 0.009117
Epoch 38
Loss = 6.6466e-02, PNorm = 44.5265, GNorm = 0.9743, lr_0 = 2.0748e-04
Validation rmse = 0.083262
Validation r2 = 0.949208
Validation mse = 0.006933
Epoch 39
Loss = 5.0873e-02, PNorm = 44.5346, GNorm = 0.8110, lr_0 = 2.0124e-04
Loss = 7.5314e-02, PNorm = 44.5431, GNorm = 1.3698, lr_0 = 1.9519e-04
Validation rmse = 0.090755
Validation r2 = 0.939655
Validation mse = 0.008237
Epoch 40
Loss = 6.6906e-02, PNorm = 44.5525, GNorm = 0.7230, lr_0 = 1.8932e-04
Validation rmse = 0.089709
Validation r2 = 0.941038
Validation mse = 0.008048
Epoch 41
Loss = 6.1411e-02, PNorm = 44.5613, GNorm = 0.6605, lr_0 = 1.8362e-04
Validation rmse = 0.076074
Validation r2 = 0.957600
Validation mse = 0.005787
Epoch 42
Loss = 7.9724e-02, PNorm = 44.5708, GNorm = 0.9599, lr_0 = 1.7756e-04
Loss = 5.8205e-02, PNorm = 44.5794, GNorm = 0.8889, lr_0 = 1.7222e-04
Validation rmse = 0.088235
Validation r2 = 0.942960
Validation mse = 0.007785
Epoch 43
Loss = 5.7176e-02, PNorm = 44.5866, GNorm = 1.0190, lr_0 = 1.6704e-04
Validation rmse = 0.096285
Validation r2 = 0.932076
Validation mse = 0.009271
Epoch 44
Loss = 4.6766e-02, PNorm = 44.5943, GNorm = 0.5808, lr_0 = 1.6201e-04
Validation rmse = 0.090301
Validation r2 = 0.940257
Validation mse = 0.008154
Epoch 45
Loss = 4.3926e-02, PNorm = 44.6031, GNorm = 0.5917, lr_0 = 1.5714e-04
Loss = 6.2861e-02, PNorm = 44.6095, GNorm = 0.7890, lr_0 = 1.5241e-04
Validation rmse = 0.086330
Validation r2 = 0.945397
Validation mse = 0.007453
Epoch 46
Loss = 6.0664e-02, PNorm = 44.6181, GNorm = 0.8602, lr_0 = 1.4738e-04
Validation rmse = 0.068320
Validation r2 = 0.965802
Validation mse = 0.004668
Epoch 47
Loss = 5.8869e-02, PNorm = 44.6255, GNorm = 2.3420, lr_0 = 1.4295e-04
Loss = 6.7437e-02, PNorm = 44.6323, GNorm = 1.5341, lr_0 = 1.3865e-04
Validation rmse = 0.083693
Validation r2 = 0.948681
Validation mse = 0.007005
Epoch 48
Loss = 5.9147e-02, PNorm = 44.6391, GNorm = 0.6131, lr_0 = 1.3448e-04
Validation rmse = 0.082668
Validation r2 = 0.949930
Validation mse = 0.006834
Epoch 49
Loss = 6.2907e-02, PNorm = 44.6451, GNorm = 1.3876, lr_0 = 1.3043e-04
Validation rmse = 0.075946
Validation r2 = 0.957741
Validation mse = 0.005768
Epoch 50
Loss = 6.1809e-02, PNorm = 44.6513, GNorm = 1.3853, lr_0 = 1.2651e-04
Loss = 6.0356e-02, PNorm = 44.6578, GNorm = 1.7368, lr_0 = 1.2270e-04
Validation rmse = 0.089742
Validation r2 = 0.940994
Validation mse = 0.008054
Epoch 51
Loss = 5.2921e-02, PNorm = 44.6645, GNorm = 1.0744, lr_0 = 1.1865e-04
Validation rmse = 0.080536
Validation r2 = 0.952479
Validation mse = 0.006486
Epoch 52
Loss = 4.6913e-02, PNorm = 44.6701, GNorm = 0.5516, lr_0 = 1.1508e-04
Validation rmse = 0.084792
Validation r2 = 0.947325
Validation mse = 0.007190
Epoch 53
Loss = 5.4787e-02, PNorm = 44.6760, GNorm = 1.3591, lr_0 = 1.1162e-04
Loss = 5.6253e-02, PNorm = 44.6811, GNorm = 0.8330, lr_0 = 1.0826e-04
Validation rmse = 0.074058
Validation r2 = 0.959817
Validation mse = 0.005485
Epoch 54
Loss = 4.9639e-02, PNorm = 44.6863, GNorm = 0.5195, lr_0 = 1.0501e-04
Validation rmse = 0.075813
Validation r2 = 0.957890
Validation mse = 0.005748
Epoch 55
Loss = 4.8330e-02, PNorm = 44.6920, GNorm = 0.5839, lr_0 = 1.0154e-04
Loss = 5.4079e-02, PNorm = 44.6967, GNorm = 1.1015, lr_0 = 1.0000e-04
Validation rmse = 0.071392
Validation r2 = 0.962658
Validation mse = 0.005097
Epoch 56
Loss = 5.1828e-02, PNorm = 44.7018, GNorm = 0.8793, lr_0 = 1.0000e-04
Validation rmse = 0.073953
Validation r2 = 0.959930
Validation mse = 0.005469
Epoch 57
Loss = 4.6518e-02, PNorm = 44.7068, GNorm = 0.8723, lr_0 = 1.0000e-04
Validation rmse = 0.072172
Validation r2 = 0.961837
Validation mse = 0.005209
Epoch 58
Loss = 5.1305e-02, PNorm = 44.7114, GNorm = 1.6426, lr_0 = 1.0000e-04
Loss = 5.4118e-02, PNorm = 44.7166, GNorm = 1.0843, lr_0 = 1.0000e-04
Validation rmse = 0.080761
Validation r2 = 0.952214
Validation mse = 0.006522
Epoch 59
Loss = 5.0069e-02, PNorm = 44.7220, GNorm = 0.4222, lr_0 = 1.0000e-04
Validation rmse = 0.069129
Validation r2 = 0.964988
Validation mse = 0.004779
Model 0 best validation rmse = 0.068320 on epoch 46
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.182387
Model 0 test r2 = 0.463877
Model 0 test mse = 0.033265
Ensemble test rmse = 0.182387
Ensemble test r2 = 0.463877
Ensemble test mse = 0.033265
Fold 4
Splitting data with seed 4
Total size = 695 | train size = 688 | val size = 7 | test size = 337
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 8.3750e-01, PNorm = 43.2676, GNorm = 2.8926, lr_0 = 4.8077e-04
Validation rmse = 0.545907
Validation r2 = -0.631322
Validation mse = 0.298015
Epoch 1
Loss = 7.8246e-01, PNorm = 43.3027, GNorm = 13.2927, lr_0 = 8.6154e-04
Validation rmse = 0.479965
Validation r2 = -0.261020
Validation mse = 0.230367
Epoch 2
Loss = 4.2229e-01, PNorm = 43.3648, GNorm = 2.4767, lr_0 = 9.8184e-04
Loss = 5.4975e-01, PNorm = 43.4443, GNorm = 2.4501, lr_0 = 9.5231e-04
Validation rmse = 0.398859
Validation r2 = 0.129155
Validation mse = 0.159089
Epoch 3
Loss = 4.8435e-01, PNorm = 43.5220, GNorm = 3.8654, lr_0 = 9.2367e-04
Validation rmse = 0.293187
Validation r2 = 0.529466
Validation mse = 0.085958
Epoch 4
Loss = 3.9311e-01, PNorm = 43.5888, GNorm = 1.7368, lr_0 = 8.9589e-04
Validation rmse = 0.187309
Validation r2 = 0.807948
Validation mse = 0.035085
Epoch 5
Loss = 3.1065e-01, PNorm = 43.6569, GNorm = 0.9370, lr_0 = 8.6629e-04
Loss = 2.2397e-01, PNorm = 43.7069, GNorm = 3.3695, lr_0 = 8.4024e-04
Validation rmse = 0.164683
Validation r2 = 0.851543
Validation mse = 0.027121
Epoch 6
Loss = 1.7304e-01, PNorm = 43.7457, GNorm = 0.8178, lr_0 = 8.1497e-04
Validation rmse = 0.195629
Validation r2 = 0.790508
Validation mse = 0.038271
Epoch 7
Loss = 1.4772e-01, PNorm = 43.7854, GNorm = 4.0979, lr_0 = 7.9046e-04
Loss = 2.2058e-01, PNorm = 43.8218, GNorm = 11.3107, lr_0 = 7.6668e-04
Validation rmse = 0.160614
Validation r2 = 0.858789
Validation mse = 0.025797
Epoch 8
Loss = 2.3230e-01, PNorm = 43.8610, GNorm = 4.2194, lr_0 = 7.4362e-04
Validation rmse = 0.151294
Validation r2 = 0.874701
Validation mse = 0.022890
Epoch 9
Loss = 1.7034e-01, PNorm = 43.8979, GNorm = 4.3462, lr_0 = 7.1906e-04
Validation rmse = 0.176794
Validation r2 = 0.828906
Validation mse = 0.031256
Epoch 10
Loss = 1.9972e-01, PNorm = 43.9309, GNorm = 0.8395, lr_0 = 6.9743e-04
Loss = 1.3007e-01, PNorm = 43.9573, GNorm = 0.6456, lr_0 = 6.7645e-04
Validation rmse = 0.186445
Validation r2 = 0.809716
Validation mse = 0.034762
Epoch 11
Loss = 1.3407e-01, PNorm = 43.9837, GNorm = 2.9939, lr_0 = 6.5611e-04
Validation rmse = 0.211179
Validation r2 = 0.755881
Validation mse = 0.044596
Epoch 12
Loss = 1.5933e-01, PNorm = 44.0030, GNorm = 0.9388, lr_0 = 6.3638e-04
Validation rmse = 0.196380
Validation r2 = 0.788897
Validation mse = 0.038565
Epoch 13
Loss = 1.4078e-01, PNorm = 44.0263, GNorm = 0.9802, lr_0 = 6.1535e-04
Loss = 1.3340e-01, PNorm = 44.0478, GNorm = 4.4657, lr_0 = 5.9685e-04
Validation rmse = 0.189693
Validation r2 = 0.803027
Validation mse = 0.035984
Epoch 14
Loss = 1.2935e-01, PNorm = 44.0632, GNorm = 1.2285, lr_0 = 5.7889e-04
Validation rmse = 0.143971
Validation r2 = 0.886537
Validation mse = 0.020728
Epoch 15
Loss = 1.2041e-01, PNorm = 44.0761, GNorm = 1.3372, lr_0 = 5.6148e-04
Loss = 1.1004e-01, PNorm = 44.0926, GNorm = 1.1770, lr_0 = 5.4460e-04
Validation rmse = 0.132096
Validation r2 = 0.904483
Validation mse = 0.017449
Epoch 16
Loss = 1.0942e-01, PNorm = 44.1068, GNorm = 1.5993, lr_0 = 5.2822e-04
Validation rmse = 0.186901
Validation r2 = 0.808783
Validation mse = 0.034932
Epoch 17
Loss = 1.1136e-01, PNorm = 44.1249, GNorm = 2.8135, lr_0 = 5.1077e-04
Validation rmse = 0.170753
Validation r2 = 0.840397
Validation mse = 0.029157
Epoch 18
Loss = 1.2928e-01, PNorm = 44.1407, GNorm = 3.5922, lr_0 = 4.9540e-04
Loss = 1.2124e-01, PNorm = 44.1542, GNorm = 4.3646, lr_0 = 4.8050e-04
Validation rmse = 0.200569
Validation r2 = 0.779794
Validation mse = 0.040228
Epoch 19
Loss = 1.0563e-01, PNorm = 44.1726, GNorm = 1.0170, lr_0 = 4.6605e-04
Validation rmse = 0.176536
Validation r2 = 0.829405
Validation mse = 0.031165
Epoch 20
Loss = 1.0822e-01, PNorm = 44.1857, GNorm = 4.4662, lr_0 = 4.5204e-04
Validation rmse = 0.181674
Validation r2 = 0.819329
Validation mse = 0.033006
Epoch 21
Loss = 7.9615e-02, PNorm = 44.2025, GNorm = 0.8322, lr_0 = 4.3710e-04
Loss = 1.0980e-01, PNorm = 44.2167, GNorm = 1.8276, lr_0 = 4.2396e-04
Validation rmse = 0.140884
Validation r2 = 0.891350
Validation mse = 0.019848
Epoch 22
Loss = 9.9219e-02, PNorm = 44.2299, GNorm = 1.6780, lr_0 = 4.1120e-04
Validation rmse = 0.193574
Validation r2 = 0.794885
Validation mse = 0.037471
Epoch 23
Loss = 1.0900e-01, PNorm = 44.2428, GNorm = 1.7459, lr_0 = 3.9884e-04
Loss = 1.0140e-01, PNorm = 44.2574, GNorm = 1.3103, lr_0 = 3.8684e-04
Validation rmse = 0.167627
Validation r2 = 0.846188
Validation mse = 0.028099
Epoch 24
Loss = 9.1735e-02, PNorm = 44.2692, GNorm = 1.5177, lr_0 = 3.7521e-04
Validation rmse = 0.166246
Validation r2 = 0.848712
Validation mse = 0.027638
Epoch 25
Loss = 7.8273e-02, PNorm = 44.2826, GNorm = 1.0308, lr_0 = 3.6392e-04
Validation rmse = 0.188036
Validation r2 = 0.806454
Validation mse = 0.035357
Epoch 26
Loss = 7.2622e-02, PNorm = 44.2951, GNorm = 0.9395, lr_0 = 3.5190e-04
Loss = 8.5886e-02, PNorm = 44.3066, GNorm = 1.9169, lr_0 = 3.4132e-04
Validation rmse = 0.174860
Validation r2 = 0.832628
Validation mse = 0.030576
Epoch 27
Loss = 9.1717e-02, PNorm = 44.3177, GNorm = 0.7604, lr_0 = 3.3105e-04
Validation rmse = 0.176001
Validation r2 = 0.830436
Validation mse = 0.030976
Epoch 28
Loss = 9.4034e-02, PNorm = 44.3298, GNorm = 0.8881, lr_0 = 3.2109e-04
Validation rmse = 0.172559
Validation r2 = 0.837004
Validation mse = 0.029777
Epoch 29
Loss = 3.8949e-02, PNorm = 44.3429, GNorm = 1.0415, lr_0 = 3.1144e-04
Loss = 7.9135e-02, PNorm = 44.3545, GNorm = 0.4933, lr_0 = 3.0207e-04
Validation rmse = 0.173219
Validation r2 = 0.835754
Validation mse = 0.030005
Epoch 30
Loss = 8.1341e-02, PNorm = 44.3634, GNorm = 0.9268, lr_0 = 2.9209e-04
Validation rmse = 0.169121
Validation r2 = 0.843434
Validation mse = 0.028602
Epoch 31
Loss = 7.2784e-02, PNorm = 44.3732, GNorm = 0.9964, lr_0 = 2.8331e-04
Loss = 7.7340e-02, PNorm = 44.3822, GNorm = 0.8468, lr_0 = 2.7478e-04
Validation rmse = 0.184881
Validation r2 = 0.812894
Validation mse = 0.034181
Epoch 32
Loss = 7.6207e-02, PNorm = 44.3916, GNorm = 0.8482, lr_0 = 2.6652e-04
Validation rmse = 0.177916
Validation r2 = 0.826726
Validation mse = 0.031654
Epoch 33
Loss = 6.0331e-02, PNorm = 44.4006, GNorm = 0.8040, lr_0 = 2.5850e-04
Validation rmse = 0.175284
Validation r2 = 0.831815
Validation mse = 0.030725
Epoch 34
Loss = 7.7027e-02, PNorm = 44.4110, GNorm = 1.7682, lr_0 = 2.4996e-04
Loss = 7.4978e-02, PNorm = 44.4199, GNorm = 1.1378, lr_0 = 2.4245e-04
Validation rmse = 0.165088
Validation r2 = 0.850813
Validation mse = 0.027254
Epoch 35
Loss = 7.2297e-02, PNorm = 44.4289, GNorm = 1.4741, lr_0 = 2.3515e-04
Validation rmse = 0.175833
Validation r2 = 0.830760
Validation mse = 0.030917
Epoch 36
Loss = 8.1662e-02, PNorm = 44.4375, GNorm = 1.2323, lr_0 = 2.2808e-04
Validation rmse = 0.184158
Validation r2 = 0.814355
Validation mse = 0.033914
Epoch 37
Loss = 7.8965e-02, PNorm = 44.4453, GNorm = 0.8726, lr_0 = 2.2122e-04
Loss = 6.6179e-02, PNorm = 44.4543, GNorm = 0.7398, lr_0 = 2.1457e-04
Validation rmse = 0.165442
Validation r2 = 0.850171
Validation mse = 0.027371
Epoch 38
Loss = 6.6001e-02, PNorm = 44.4630, GNorm = 0.5363, lr_0 = 2.0748e-04
Validation rmse = 0.161353
Validation r2 = 0.857487
Validation mse = 0.026035
Epoch 39
Loss = 7.5853e-02, PNorm = 44.4709, GNorm = 1.1667, lr_0 = 2.0124e-04
Loss = 6.1685e-02, PNorm = 44.4781, GNorm = 0.9961, lr_0 = 1.9519e-04
Validation rmse = 0.187800
Validation r2 = 0.806940
Validation mse = 0.035269
Epoch 40
Loss = 6.8853e-02, PNorm = 44.4859, GNorm = 1.2973, lr_0 = 1.8932e-04
Validation rmse = 0.169329
Validation r2 = 0.843048
Validation mse = 0.028672
Epoch 41
Loss = 7.2420e-02, PNorm = 44.4935, GNorm = 0.4525, lr_0 = 1.8362e-04
Validation rmse = 0.165087
Validation r2 = 0.850814
Validation mse = 0.027254
Epoch 42
Loss = 5.8866e-02, PNorm = 44.5011, GNorm = 1.2657, lr_0 = 1.7756e-04
Loss = 6.6860e-02, PNorm = 44.5083, GNorm = 1.3507, lr_0 = 1.7222e-04
Validation rmse = 0.177604
Validation r2 = 0.827334
Validation mse = 0.031543
Epoch 43
Loss = 6.4416e-02, PNorm = 44.5155, GNorm = 1.4240, lr_0 = 1.6704e-04
Validation rmse = 0.168608
Validation r2 = 0.844383
Validation mse = 0.028429
Epoch 44
Loss = 4.5605e-02, PNorm = 44.5220, GNorm = 1.1147, lr_0 = 1.6201e-04
Validation rmse = 0.173464
Validation r2 = 0.835290
Validation mse = 0.030090
Epoch 45
Loss = 7.2570e-02, PNorm = 44.5292, GNorm = 0.8189, lr_0 = 1.5714e-04
Loss = 5.9587e-02, PNorm = 44.5352, GNorm = 0.6333, lr_0 = 1.5241e-04
Validation rmse = 0.160615
Validation r2 = 0.858788
Validation mse = 0.025797
Epoch 46
Loss = 5.2705e-02, PNorm = 44.5420, GNorm = 1.2871, lr_0 = 1.4738e-04
Validation rmse = 0.173578
Validation r2 = 0.835073
Validation mse = 0.030129
Epoch 47
Loss = 6.0890e-02, PNorm = 44.5483, GNorm = 0.8663, lr_0 = 1.4295e-04
Loss = 6.0146e-02, PNorm = 44.5540, GNorm = 0.7654, lr_0 = 1.3865e-04
Validation rmse = 0.168580
Validation r2 = 0.844435
Validation mse = 0.028419
Epoch 48
Loss = 5.9379e-02, PNorm = 44.5597, GNorm = 2.2854, lr_0 = 1.3448e-04
Validation rmse = 0.178887
Validation r2 = 0.824829
Validation mse = 0.032001
Epoch 49
Loss = 6.1101e-02, PNorm = 44.5650, GNorm = 1.0989, lr_0 = 1.3043e-04
Validation rmse = 0.165266
Validation r2 = 0.850491
Validation mse = 0.027313
Epoch 50
Loss = 7.1734e-02, PNorm = 44.5703, GNorm = 2.4728, lr_0 = 1.2651e-04
Loss = 5.5240e-02, PNorm = 44.5759, GNorm = 1.4921, lr_0 = 1.2270e-04
Validation rmse = 0.175301
Validation r2 = 0.831783
Validation mse = 0.030730
Epoch 51
Loss = 6.1432e-02, PNorm = 44.5809, GNorm = 0.9187, lr_0 = 1.1865e-04
Validation rmse = 0.168322
Validation r2 = 0.844910
Validation mse = 0.028332
Epoch 52
Loss = 5.4515e-02, PNorm = 44.5859, GNorm = 0.7117, lr_0 = 1.1508e-04
Validation rmse = 0.174375
Validation r2 = 0.833555
Validation mse = 0.030407
Epoch 53
Loss = 4.3626e-02, PNorm = 44.5912, GNorm = 0.5696, lr_0 = 1.1162e-04
Loss = 5.7668e-02, PNorm = 44.5950, GNorm = 0.8374, lr_0 = 1.0826e-04
Validation rmse = 0.181382
Validation r2 = 0.819910
Validation mse = 0.032899
Epoch 54
Loss = 5.2165e-02, PNorm = 44.5999, GNorm = 1.2528, lr_0 = 1.0501e-04
Validation rmse = 0.178785
Validation r2 = 0.825030
Validation mse = 0.031964
Epoch 55
Loss = 4.7537e-02, PNorm = 44.6041, GNorm = 1.8582, lr_0 = 1.0154e-04
Loss = 5.7749e-02, PNorm = 44.6083, GNorm = 1.1080, lr_0 = 1.0000e-04
Validation rmse = 0.164362
Validation r2 = 0.852122
Validation mse = 0.027015
Epoch 56
Loss = 5.7358e-02, PNorm = 44.6124, GNorm = 1.6014, lr_0 = 1.0000e-04
Validation rmse = 0.173686
Validation r2 = 0.834869
Validation mse = 0.030167
Epoch 57
Loss = 5.0096e-02, PNorm = 44.6160, GNorm = 0.7165, lr_0 = 1.0000e-04
Validation rmse = 0.172054
Validation r2 = 0.837956
Validation mse = 0.029603
Epoch 58
Loss = 2.8511e-02, PNorm = 44.6200, GNorm = 0.3402, lr_0 = 1.0000e-04
Loss = 5.4867e-02, PNorm = 44.6237, GNorm = 1.5909, lr_0 = 1.0000e-04
Validation rmse = 0.187272
Validation r2 = 0.808024
Validation mse = 0.035071
Epoch 59
Loss = 5.4732e-02, PNorm = 44.6290, GNorm = 2.2820, lr_0 = 1.0000e-04
Validation rmse = 0.177331
Validation r2 = 0.827864
Validation mse = 0.031446
Model 0 best validation rmse = 0.132096 on epoch 15
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.166970
Model 0 test r2 = 0.550677
Model 0 test mse = 0.027879
Ensemble test rmse = 0.166970
Ensemble test r2 = 0.550677
Ensemble test mse = 0.027879
Fold 5
Splitting data with seed 5
Total size = 695 | train size = 688 | val size = 7 | test size = 337
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 8.8148e-01, PNorm = 43.2677, GNorm = 6.0002, lr_0 = 4.8077e-04
Validation rmse = 0.465908
Validation r2 = -0.773312
Validation mse = 0.217071
Epoch 1
Loss = 6.2738e-01, PNorm = 43.3083, GNorm = 0.9206, lr_0 = 8.6154e-04
Validation rmse = 0.375667
Validation r2 = -0.152893
Validation mse = 0.141125
Epoch 2
Loss = 4.8779e-01, PNorm = 43.3770, GNorm = 1.9472, lr_0 = 9.8184e-04
Loss = 5.3258e-01, PNorm = 43.4409, GNorm = 5.9672, lr_0 = 9.5231e-04
Validation rmse = 0.323796
Validation r2 = 0.143500
Validation mse = 0.104844
Epoch 3
Loss = 4.2441e-01, PNorm = 43.5136, GNorm = 3.3573, lr_0 = 9.2367e-04
Validation rmse = 0.322998
Validation r2 = 0.147720
Validation mse = 0.104327
Epoch 4
Loss = 2.7197e-01, PNorm = 43.5792, GNorm = 4.6047, lr_0 = 8.9589e-04
Validation rmse = 0.351162
Validation r2 = -0.007395
Validation mse = 0.123315
Epoch 5
Loss = 2.3713e-01, PNorm = 43.6399, GNorm = 0.8304, lr_0 = 8.6629e-04
Loss = 2.2042e-01, PNorm = 43.6902, GNorm = 1.9919, lr_0 = 8.4024e-04
Validation rmse = 0.271393
Validation r2 = 0.398298
Validation mse = 0.073654
Epoch 6
Loss = 2.0081e-01, PNorm = 43.7321, GNorm = 1.0757, lr_0 = 8.1497e-04
Validation rmse = 0.243717
Validation r2 = 0.514762
Validation mse = 0.059398
Epoch 7
Loss = 1.6185e-01, PNorm = 43.7717, GNorm = 1.2029, lr_0 = 7.9046e-04
Loss = 1.8351e-01, PNorm = 43.8084, GNorm = 2.2692, lr_0 = 7.6668e-04
Validation rmse = 0.293132
Validation r2 = 0.298043
Validation mse = 0.085926
Epoch 8
Loss = 1.7630e-01, PNorm = 43.8416, GNorm = 4.2046, lr_0 = 7.4362e-04
Validation rmse = 0.253777
Validation r2 = 0.473878
Validation mse = 0.064403
Epoch 9
Loss = 1.4179e-01, PNorm = 43.8678, GNorm = 1.4056, lr_0 = 7.1906e-04
Validation rmse = 0.252887
Validation r2 = 0.477560
Validation mse = 0.063952
Epoch 10
Loss = 1.4456e-01, PNorm = 43.8974, GNorm = 2.3601, lr_0 = 6.9743e-04
Loss = 1.6148e-01, PNorm = 43.9221, GNorm = 5.5064, lr_0 = 6.7645e-04
Validation rmse = 0.258739
Validation r2 = 0.453100
Validation mse = 0.066946
Epoch 11
Loss = 1.4923e-01, PNorm = 43.9481, GNorm = 1.4579, lr_0 = 6.5611e-04
Validation rmse = 0.254514
Validation r2 = 0.470813
Validation mse = 0.064778
Epoch 12
Loss = 1.4205e-01, PNorm = 43.9718, GNorm = 4.2012, lr_0 = 6.3638e-04
Validation rmse = 0.256552
Validation r2 = 0.462305
Validation mse = 0.065819
Epoch 13
Loss = 9.8303e-02, PNorm = 43.9917, GNorm = 0.8437, lr_0 = 6.1535e-04
Loss = 1.1713e-01, PNorm = 44.0072, GNorm = 2.6334, lr_0 = 5.9685e-04
Validation rmse = 0.250823
Validation r2 = 0.486051
Validation mse = 0.062912
Epoch 14
Loss = 1.0966e-01, PNorm = 44.0245, GNorm = 3.0980, lr_0 = 5.7889e-04
Validation rmse = 0.234135
Validation r2 = 0.552165
Validation mse = 0.054819
Epoch 15
Loss = 1.1611e-01, PNorm = 44.0387, GNorm = 3.0194, lr_0 = 5.6148e-04
Loss = 1.0759e-01, PNorm = 44.0539, GNorm = 1.6407, lr_0 = 5.4460e-04
Validation rmse = 0.257712
Validation r2 = 0.457433
Validation mse = 0.066416
Epoch 16
Loss = 1.0220e-01, PNorm = 44.0700, GNorm = 2.2592, lr_0 = 5.2822e-04
Validation rmse = 0.266748
Validation r2 = 0.418717
Validation mse = 0.071155
Epoch 17
Loss = 1.1006e-01, PNorm = 44.0870, GNorm = 2.7252, lr_0 = 5.1077e-04
Validation rmse = 0.269162
Validation r2 = 0.408150
Validation mse = 0.072448
Epoch 18
Loss = 1.2635e-01, PNorm = 44.1031, GNorm = 3.5908, lr_0 = 4.9540e-04
Loss = 9.3357e-02, PNorm = 44.1203, GNorm = 0.5624, lr_0 = 4.8050e-04
Validation rmse = 0.275930
Validation r2 = 0.378011
Validation mse = 0.076138
Epoch 19
Loss = 9.6862e-02, PNorm = 44.1335, GNorm = 0.8742, lr_0 = 4.6605e-04
Validation rmse = 0.247825
Validation r2 = 0.498263
Validation mse = 0.061417
Epoch 20
Loss = 9.0992e-02, PNorm = 44.1472, GNorm = 1.3461, lr_0 = 4.5204e-04
Validation rmse = 0.246818
Validation r2 = 0.502335
Validation mse = 0.060919
Epoch 21
Loss = 1.0605e-01, PNorm = 44.1628, GNorm = 2.6993, lr_0 = 4.3710e-04
Loss = 9.5319e-02, PNorm = 44.1779, GNorm = 1.0444, lr_0 = 4.2396e-04
Validation rmse = 0.256930
Validation r2 = 0.460722
Validation mse = 0.066013
Epoch 22
Loss = 8.7236e-02, PNorm = 44.1922, GNorm = 2.1593, lr_0 = 4.1120e-04
Validation rmse = 0.263083
Validation r2 = 0.434584
Validation mse = 0.069212
Epoch 23
Loss = 8.9987e-02, PNorm = 44.2065, GNorm = 2.0630, lr_0 = 3.9884e-04
Loss = 9.6763e-02, PNorm = 44.2195, GNorm = 4.2639, lr_0 = 3.8684e-04
Validation rmse = 0.250468
Validation r2 = 0.487507
Validation mse = 0.062734
Epoch 24
Loss = 8.4263e-02, PNorm = 44.2334, GNorm = 3.2923, lr_0 = 3.7521e-04
Validation rmse = 0.253173
Validation r2 = 0.476379
Validation mse = 0.064096
Epoch 25
Loss = 7.7917e-02, PNorm = 44.2455, GNorm = 0.7545, lr_0 = 3.6392e-04
Validation rmse = 0.242704
Validation r2 = 0.518787
Validation mse = 0.058905
Epoch 26
Loss = 9.0099e-02, PNorm = 44.2596, GNorm = 2.6434, lr_0 = 3.5190e-04
Loss = 7.7832e-02, PNorm = 44.2717, GNorm = 3.7186, lr_0 = 3.4132e-04
Validation rmse = 0.243194
Validation r2 = 0.516840
Validation mse = 0.059143
Epoch 27
Loss = 7.9073e-02, PNorm = 44.2827, GNorm = 1.1312, lr_0 = 3.3105e-04
Validation rmse = 0.240071
Validation r2 = 0.529169
Validation mse = 0.057634
Epoch 28
Loss = 7.1818e-02, PNorm = 44.2937, GNorm = 2.4871, lr_0 = 3.2109e-04
Validation rmse = 0.233754
Validation r2 = 0.553624
Validation mse = 0.054641
Epoch 29
Loss = 5.5002e-02, PNorm = 44.3038, GNorm = 1.5529, lr_0 = 3.1144e-04
Loss = 9.8327e-02, PNorm = 44.3147, GNorm = 1.4981, lr_0 = 3.0207e-04
Validation rmse = 0.252735
Validation r2 = 0.478186
Validation mse = 0.063875
Epoch 30
Loss = 6.9372e-02, PNorm = 44.3268, GNorm = 0.8625, lr_0 = 2.9209e-04
Validation rmse = 0.242873
Validation r2 = 0.518118
Validation mse = 0.058987
Epoch 31
Loss = 8.5859e-02, PNorm = 44.3377, GNorm = 2.5885, lr_0 = 2.8331e-04
Loss = 7.0787e-02, PNorm = 44.3477, GNorm = 0.8267, lr_0 = 2.7478e-04
Validation rmse = 0.241583
Validation r2 = 0.523223
Validation mse = 0.058362
Epoch 32
Loss = 7.0031e-02, PNorm = 44.3575, GNorm = 0.4105, lr_0 = 2.6652e-04
Validation rmse = 0.238462
Validation r2 = 0.535462
Validation mse = 0.056864
Epoch 33
Loss = 6.5700e-02, PNorm = 44.3658, GNorm = 0.8809, lr_0 = 2.5850e-04
Validation rmse = 0.231399
Validation r2 = 0.562570
Validation mse = 0.053546
Epoch 34
Loss = 5.6867e-02, PNorm = 44.3770, GNorm = 1.3142, lr_0 = 2.4996e-04
Loss = 8.0647e-02, PNorm = 44.3864, GNorm = 1.7189, lr_0 = 2.4245e-04
Validation rmse = 0.261515
Validation r2 = 0.441301
Validation mse = 0.068390
Epoch 35
Loss = 7.2877e-02, PNorm = 44.3949, GNorm = 1.3139, lr_0 = 2.3515e-04
Validation rmse = 0.251869
Validation r2 = 0.481756
Validation mse = 0.063438
Epoch 36
Loss = 6.4636e-02, PNorm = 44.4038, GNorm = 1.0128, lr_0 = 2.2808e-04
Validation rmse = 0.237090
Validation r2 = 0.540790
Validation mse = 0.056212
Epoch 37
Loss = 7.6695e-02, PNorm = 44.4125, GNorm = 2.1355, lr_0 = 2.2122e-04
Loss = 6.7227e-02, PNorm = 44.4203, GNorm = 1.2256, lr_0 = 2.1457e-04
Validation rmse = 0.250020
Validation r2 = 0.489339
Validation mse = 0.062510
Epoch 38
Loss = 5.9460e-02, PNorm = 44.4287, GNorm = 1.0846, lr_0 = 2.0748e-04
Validation rmse = 0.236635
Validation r2 = 0.542553
Validation mse = 0.055996
Epoch 39
Loss = 6.5353e-02, PNorm = 44.4358, GNorm = 0.7937, lr_0 = 2.0124e-04
Loss = 6.2858e-02, PNorm = 44.4439, GNorm = 1.3048, lr_0 = 1.9519e-04
Validation rmse = 0.252537
Validation r2 = 0.479004
Validation mse = 0.063775
Epoch 40
Loss = 6.1067e-02, PNorm = 44.4513, GNorm = 0.7432, lr_0 = 1.8932e-04
Validation rmse = 0.251166
Validation r2 = 0.484645
Validation mse = 0.063084
Epoch 41
Loss = 6.7322e-02, PNorm = 44.4583, GNorm = 0.9850, lr_0 = 1.8362e-04
Validation rmse = 0.229666
Validation r2 = 0.569098
Validation mse = 0.052747
Epoch 42
Loss = 5.3266e-02, PNorm = 44.4664, GNorm = 2.4181, lr_0 = 1.7756e-04
Loss = 6.0615e-02, PNorm = 44.4727, GNorm = 0.3720, lr_0 = 1.7222e-04
Validation rmse = 0.240682
Validation r2 = 0.526769
Validation mse = 0.057928
Epoch 43
Loss = 5.6143e-02, PNorm = 44.4795, GNorm = 1.9173, lr_0 = 1.6704e-04
Validation rmse = 0.232867
Validation r2 = 0.557006
Validation mse = 0.054227
Epoch 44
Loss = 6.3551e-02, PNorm = 44.4855, GNorm = 1.1212, lr_0 = 1.6201e-04
Validation rmse = 0.242718
Validation r2 = 0.518733
Validation mse = 0.058912
Epoch 45
Loss = 5.5525e-02, PNorm = 44.4911, GNorm = 0.6494, lr_0 = 1.5714e-04
Loss = 6.1382e-02, PNorm = 44.4970, GNorm = 2.1065, lr_0 = 1.5241e-04
Validation rmse = 0.234449
Validation r2 = 0.550966
Validation mse = 0.054966
Epoch 46
Loss = 6.1717e-02, PNorm = 44.5022, GNorm = 0.6101, lr_0 = 1.4738e-04
Validation rmse = 0.246732
Validation r2 = 0.502682
Validation mse = 0.060877
Epoch 47
Loss = 4.9527e-02, PNorm = 44.5082, GNorm = 0.5656, lr_0 = 1.4295e-04
Loss = 5.7652e-02, PNorm = 44.5146, GNorm = 0.7242, lr_0 = 1.3865e-04
Validation rmse = 0.234262
Validation r2 = 0.551681
Validation mse = 0.054879
Epoch 48
Loss = 5.2975e-02, PNorm = 44.5188, GNorm = 0.7583, lr_0 = 1.3448e-04
Validation rmse = 0.235696
Validation r2 = 0.546174
Validation mse = 0.055553
Epoch 49
Loss = 4.9925e-02, PNorm = 44.5227, GNorm = 1.0160, lr_0 = 1.3043e-04
Validation rmse = 0.235733
Validation r2 = 0.546031
Validation mse = 0.055570
Epoch 50
Loss = 2.8169e-02, PNorm = 44.5274, GNorm = 0.5187, lr_0 = 1.2651e-04
Loss = 5.8851e-02, PNorm = 44.5322, GNorm = 1.3556, lr_0 = 1.2270e-04
Validation rmse = 0.223324
Validation r2 = 0.592570
Validation mse = 0.049873
Epoch 51
Loss = 5.9114e-02, PNorm = 44.5374, GNorm = 0.7111, lr_0 = 1.1865e-04
Validation rmse = 0.239503
Validation r2 = 0.531396
Validation mse = 0.057362
Epoch 52
Loss = 5.1257e-02, PNorm = 44.5422, GNorm = 0.3367, lr_0 = 1.1508e-04
Validation rmse = 0.245081
Validation r2 = 0.509314
Validation mse = 0.060065
Epoch 53
Loss = 4.3047e-02, PNorm = 44.5469, GNorm = 1.1154, lr_0 = 1.1162e-04
Loss = 5.4885e-02, PNorm = 44.5522, GNorm = 1.3692, lr_0 = 1.0826e-04
Validation rmse = 0.229569
Validation r2 = 0.569462
Validation mse = 0.052702
Epoch 54
Loss = 5.3893e-02, PNorm = 44.5554, GNorm = 0.7935, lr_0 = 1.0501e-04
Validation rmse = 0.228006
Validation r2 = 0.575306
Validation mse = 0.051987
Epoch 55
Loss = 5.4850e-02, PNorm = 44.5596, GNorm = 0.6865, lr_0 = 1.0154e-04
Loss = 5.1192e-02, PNorm = 44.5626, GNorm = 1.9430, lr_0 = 1.0000e-04
Validation rmse = 0.223703
Validation r2 = 0.591183
Validation mse = 0.050043
Epoch 56
Loss = 4.8798e-02, PNorm = 44.5667, GNorm = 2.2098, lr_0 = 1.0000e-04
Validation rmse = 0.231046
Validation r2 = 0.563905
Validation mse = 0.053382
Epoch 57
Loss = 4.5517e-02, PNorm = 44.5704, GNorm = 0.8773, lr_0 = 1.0000e-04
Validation rmse = 0.232486
Validation r2 = 0.558451
Validation mse = 0.054050
Epoch 58
Loss = 5.0658e-02, PNorm = 44.5741, GNorm = 0.7606, lr_0 = 1.0000e-04
Loss = 4.7044e-02, PNorm = 44.5774, GNorm = 0.7985, lr_0 = 1.0000e-04
Validation rmse = 0.236964
Validation r2 = 0.541279
Validation mse = 0.056152
Epoch 59
Loss = 4.9084e-02, PNorm = 44.5811, GNorm = 1.1836, lr_0 = 1.0000e-04
Validation rmse = 0.229864
Validation r2 = 0.568356
Validation mse = 0.052837
Model 0 best validation rmse = 0.223324 on epoch 50
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.178065
Model 0 test r2 = 0.488983
Model 0 test mse = 0.031707
Ensemble test rmse = 0.178065
Ensemble test r2 = 0.488983
Ensemble test mse = 0.031707
Fold 6
Splitting data with seed 6
Total size = 695 | train size = 688 | val size = 7 | test size = 337
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.1104e-01, PNorm = 43.2660, GNorm = 1.3705, lr_0 = 4.8077e-04
Validation rmse = 0.293708
Validation r2 = 0.193940
Validation mse = 0.086265
Epoch 1
Loss = 7.2119e-01, PNorm = 43.3060, GNorm = 1.4010, lr_0 = 8.6154e-04
Validation rmse = 0.295917
Validation r2 = 0.181768
Validation mse = 0.087567
Epoch 2
Loss = 5.1219e-01, PNorm = 43.3686, GNorm = 4.0736, lr_0 = 9.8184e-04
Loss = 4.4213e-01, PNorm = 43.4333, GNorm = 3.5017, lr_0 = 9.5231e-04
Validation rmse = 0.304448
Validation r2 = 0.133915
Validation mse = 0.092688
Epoch 3
Loss = 3.4158e-01, PNorm = 43.5021, GNorm = 1.2360, lr_0 = 9.2367e-04
Validation rmse = 0.221026
Validation r2 = 0.543520
Validation mse = 0.048852
Epoch 4
Loss = 3.2096e-01, PNorm = 43.5603, GNorm = 8.3631, lr_0 = 8.9589e-04
Validation rmse = 0.223904
Validation r2 = 0.531553
Validation mse = 0.050133
Epoch 5
Loss = 3.8343e-01, PNorm = 43.6216, GNorm = 7.9922, lr_0 = 8.6629e-04
Loss = 3.1936e-01, PNorm = 43.6769, GNorm = 0.9373, lr_0 = 8.4024e-04
Validation rmse = 0.217443
Validation r2 = 0.558199
Validation mse = 0.047282
Epoch 6
Loss = 2.7359e-01, PNorm = 43.7191, GNorm = 3.8941, lr_0 = 8.1497e-04
Validation rmse = 0.182172
Validation r2 = 0.689902
Validation mse = 0.033187
Epoch 7
Loss = 2.0501e-01, PNorm = 43.7627, GNorm = 0.5049, lr_0 = 7.9046e-04
Loss = 1.9724e-01, PNorm = 43.8020, GNorm = 1.5095, lr_0 = 7.6668e-04
Validation rmse = 0.098714
Validation r2 = 0.908948
Validation mse = 0.009744
Epoch 8
Loss = 1.6389e-01, PNorm = 43.8366, GNorm = 3.8365, lr_0 = 7.4362e-04
Validation rmse = 0.105104
Validation r2 = 0.896779
Validation mse = 0.011047
Epoch 9
Loss = 1.6784e-01, PNorm = 43.8670, GNorm = 0.7352, lr_0 = 7.1906e-04
Validation rmse = 0.097841
Validation r2 = 0.910550
Validation mse = 0.009573
Epoch 10
Loss = 1.5828e-01, PNorm = 43.8958, GNorm = 1.3016, lr_0 = 6.9743e-04
Loss = 1.4700e-01, PNorm = 43.9225, GNorm = 5.2908, lr_0 = 6.7645e-04
Validation rmse = 0.141172
Validation r2 = 0.813777
Validation mse = 0.019930
Epoch 11
Loss = 1.6566e-01, PNorm = 43.9475, GNorm = 2.5203, lr_0 = 6.5611e-04
Validation rmse = 0.147643
Validation r2 = 0.796314
Validation mse = 0.021798
Epoch 12
Loss = 1.8030e-01, PNorm = 43.9695, GNorm = 3.6118, lr_0 = 6.3638e-04
Validation rmse = 0.148486
Validation r2 = 0.793982
Validation mse = 0.022048
Epoch 13
Loss = 1.3339e-01, PNorm = 43.9962, GNorm = 0.6621, lr_0 = 6.1535e-04
Loss = 1.2738e-01, PNorm = 44.0163, GNorm = 2.0783, lr_0 = 5.9685e-04
Validation rmse = 0.103609
Validation r2 = 0.899693
Validation mse = 0.010735
Epoch 14
Loss = 1.1986e-01, PNorm = 44.0365, GNorm = 3.1485, lr_0 = 5.7889e-04
Validation rmse = 0.076146
Validation r2 = 0.945821
Validation mse = 0.005798
Epoch 15
Loss = 1.1228e-01, PNorm = 44.0526, GNorm = 1.4165, lr_0 = 5.6148e-04
Loss = 1.1735e-01, PNorm = 44.0705, GNorm = 1.0477, lr_0 = 5.4460e-04
Validation rmse = 0.121797
Validation r2 = 0.861385
Validation mse = 0.014835
Epoch 16
Loss = 1.1194e-01, PNorm = 44.0858, GNorm = 1.9644, lr_0 = 5.2822e-04
Validation rmse = 0.097392
Validation r2 = 0.911370
Validation mse = 0.009485
Epoch 17
Loss = 1.1306e-01, PNorm = 44.1069, GNorm = 0.9490, lr_0 = 5.1077e-04
Validation rmse = 0.124708
Validation r2 = 0.854680
Validation mse = 0.015552
Epoch 18
Loss = 9.7336e-02, PNorm = 44.1223, GNorm = 1.0115, lr_0 = 4.9540e-04
Loss = 1.1882e-01, PNorm = 44.1376, GNorm = 2.0020, lr_0 = 4.8050e-04
Validation rmse = 0.117396
Validation r2 = 0.871222
Validation mse = 0.013782
Epoch 19
Loss = 1.0181e-01, PNorm = 44.1542, GNorm = 1.0704, lr_0 = 4.6605e-04
Validation rmse = 0.074647
Validation r2 = 0.947933
Validation mse = 0.005572
Epoch 20
Loss = 1.0657e-01, PNorm = 44.1709, GNorm = 2.1721, lr_0 = 4.5204e-04
Validation rmse = 0.107705
Validation r2 = 0.891606
Validation mse = 0.011600
Epoch 21
Loss = 8.5341e-02, PNorm = 44.1880, GNorm = 0.5440, lr_0 = 4.3710e-04
Loss = 9.8148e-02, PNorm = 44.2006, GNorm = 1.2971, lr_0 = 4.2396e-04
Validation rmse = 0.118561
Validation r2 = 0.868653
Validation mse = 0.014057
Epoch 22
Loss = 9.2554e-02, PNorm = 44.2155, GNorm = 1.4539, lr_0 = 4.1120e-04
Validation rmse = 0.119659
Validation r2 = 0.866210
Validation mse = 0.014318
Epoch 23
Loss = 1.0643e-01, PNorm = 44.2276, GNorm = 1.4586, lr_0 = 3.9884e-04
Loss = 9.4509e-02, PNorm = 44.2416, GNorm = 1.4660, lr_0 = 3.8684e-04
Validation rmse = 0.097746
Validation r2 = 0.910724
Validation mse = 0.009554
Epoch 24
Loss = 8.5151e-02, PNorm = 44.2534, GNorm = 1.7926, lr_0 = 3.7521e-04
Validation rmse = 0.090818
Validation r2 = 0.922932
Validation mse = 0.008248
Epoch 25
Loss = 8.6804e-02, PNorm = 44.2671, GNorm = 2.0447, lr_0 = 3.6392e-04
Validation rmse = 0.104077
Validation r2 = 0.898786
Validation mse = 0.010832
Epoch 26
Loss = 7.7398e-02, PNorm = 44.2793, GNorm = 1.0245, lr_0 = 3.5190e-04
Loss = 9.5586e-02, PNorm = 44.2905, GNorm = 1.7084, lr_0 = 3.4132e-04
Validation rmse = 0.119340
Validation r2 = 0.866922
Validation mse = 0.014242
Epoch 27
Loss = 8.8574e-02, PNorm = 44.3034, GNorm = 1.1090, lr_0 = 3.3105e-04
Validation rmse = 0.085136
Validation r2 = 0.932274
Validation mse = 0.007248
Epoch 28
Loss = 9.5466e-02, PNorm = 44.3143, GNorm = 1.3441, lr_0 = 3.2109e-04
Validation rmse = 0.094482
Validation r2 = 0.916587
Validation mse = 0.008927
Epoch 29
Loss = 7.1871e-02, PNorm = 44.3256, GNorm = 0.6161, lr_0 = 3.1144e-04
Loss = 8.5075e-02, PNorm = 44.3359, GNorm = 0.8338, lr_0 = 3.0207e-04
Validation rmse = 0.126503
Validation r2 = 0.850467
Validation mse = 0.016003
Epoch 30
Loss = 7.6763e-02, PNorm = 44.3477, GNorm = 1.2164, lr_0 = 2.9209e-04
Validation rmse = 0.140714
Validation r2 = 0.814983
Validation mse = 0.019801
Epoch 31
Loss = 7.9339e-02, PNorm = 44.3581, GNorm = 0.5424, lr_0 = 2.8331e-04
Loss = 8.7394e-02, PNorm = 44.3690, GNorm = 1.0668, lr_0 = 2.7478e-04
Validation rmse = 0.087377
Validation r2 = 0.928660
Validation mse = 0.007635
Epoch 32
Loss = 8.1454e-02, PNorm = 44.3780, GNorm = 2.1671, lr_0 = 2.6652e-04
Validation rmse = 0.105960
Validation r2 = 0.895089
Validation mse = 0.011228
Epoch 33
Loss = 7.0847e-02, PNorm = 44.3880, GNorm = 1.0771, lr_0 = 2.5850e-04
Validation rmse = 0.099495
Validation r2 = 0.907500
Validation mse = 0.009899
Epoch 34
Loss = 7.8315e-02, PNorm = 44.3978, GNorm = 1.3874, lr_0 = 2.4996e-04
Loss = 8.1292e-02, PNorm = 44.4072, GNorm = 4.3377, lr_0 = 2.4245e-04
Validation rmse = 0.099474
Validation r2 = 0.907539
Validation mse = 0.009895
Epoch 35
Loss = 7.9273e-02, PNorm = 44.4164, GNorm = 2.0540, lr_0 = 2.3515e-04
Validation rmse = 0.136553
Validation r2 = 0.825765
Validation mse = 0.018647
Epoch 36
Loss = 6.8380e-02, PNorm = 44.4246, GNorm = 1.3289, lr_0 = 2.2808e-04
Validation rmse = 0.113168
Validation r2 = 0.880332
Validation mse = 0.012807
Epoch 37
Loss = 7.6385e-02, PNorm = 44.4343, GNorm = 1.0952, lr_0 = 2.2122e-04
Loss = 8.6322e-02, PNorm = 44.4440, GNorm = 1.0099, lr_0 = 2.1457e-04
Validation rmse = 0.122303
Validation r2 = 0.860232
Validation mse = 0.014958
Epoch 38
Loss = 7.6008e-02, PNorm = 44.4531, GNorm = 1.4834, lr_0 = 2.0748e-04
Validation rmse = 0.092460
Validation r2 = 0.920119
Validation mse = 0.008549
Epoch 39
Loss = 7.8179e-02, PNorm = 44.4621, GNorm = 2.0777, lr_0 = 2.0124e-04
Loss = 7.7246e-02, PNorm = 44.4704, GNorm = 2.3080, lr_0 = 1.9519e-04
Validation rmse = 0.128541
Validation r2 = 0.845611
Validation mse = 0.016523
Epoch 40
Loss = 7.2854e-02, PNorm = 44.4778, GNorm = 1.0956, lr_0 = 1.8932e-04
Validation rmse = 0.109511
Validation r2 = 0.887939
Validation mse = 0.011993
Epoch 41
Loss = 5.8748e-02, PNorm = 44.4852, GNorm = 0.6102, lr_0 = 1.8362e-04
Validation rmse = 0.108434
Validation r2 = 0.890133
Validation mse = 0.011758
Epoch 42
Loss = 6.4337e-02, PNorm = 44.4926, GNorm = 1.9831, lr_0 = 1.7756e-04
Loss = 6.6305e-02, PNorm = 44.5004, GNorm = 0.4893, lr_0 = 1.7222e-04
Validation rmse = 0.095924
Validation r2 = 0.914022
Validation mse = 0.009201
Epoch 43
Loss = 6.9567e-02, PNorm = 44.5061, GNorm = 1.1838, lr_0 = 1.6704e-04
Validation rmse = 0.113045
Validation r2 = 0.880591
Validation mse = 0.012779
Epoch 44
Loss = 5.6596e-02, PNorm = 44.5129, GNorm = 0.6254, lr_0 = 1.6201e-04
Validation rmse = 0.096266
Validation r2 = 0.913408
Validation mse = 0.009267
Epoch 45
Loss = 5.7062e-02, PNorm = 44.5195, GNorm = 0.7557, lr_0 = 1.5714e-04
Loss = 6.6798e-02, PNorm = 44.5254, GNorm = 0.7816, lr_0 = 1.5241e-04
Validation rmse = 0.089190
Validation r2 = 0.925670
Validation mse = 0.007955
Epoch 46
Loss = 5.4301e-02, PNorm = 44.5321, GNorm = 0.6274, lr_0 = 1.4738e-04
Validation rmse = 0.106471
Validation r2 = 0.894076
Validation mse = 0.011336
Epoch 47
Loss = 6.5989e-02, PNorm = 44.5384, GNorm = 0.9361, lr_0 = 1.4295e-04
Loss = 5.6802e-02, PNorm = 44.5440, GNorm = 1.1744, lr_0 = 1.3865e-04
Validation rmse = 0.097402
Validation r2 = 0.911351
Validation mse = 0.009487
Epoch 48
Loss = 5.7564e-02, PNorm = 44.5489, GNorm = 0.7056, lr_0 = 1.3448e-04
Validation rmse = 0.102560
Validation r2 = 0.901715
Validation mse = 0.010518
Epoch 49
Loss = 5.8491e-02, PNorm = 44.5541, GNorm = 0.7095, lr_0 = 1.3043e-04
Validation rmse = 0.110803
Validation r2 = 0.885280
Validation mse = 0.012277
Epoch 50
Loss = 4.7295e-02, PNorm = 44.5596, GNorm = 2.1749, lr_0 = 1.2651e-04
Loss = 6.1231e-02, PNorm = 44.5650, GNorm = 1.1746, lr_0 = 1.2270e-04
Validation rmse = 0.108297
Validation r2 = 0.890410
Validation mse = 0.011728
Epoch 51
Loss = 5.6561e-02, PNorm = 44.5698, GNorm = 0.5380, lr_0 = 1.1865e-04
Validation rmse = 0.104188
Validation r2 = 0.898569
Validation mse = 0.010855
Epoch 52
Loss = 4.7623e-02, PNorm = 44.5741, GNorm = 0.8118, lr_0 = 1.1508e-04
Validation rmse = 0.094448
Validation r2 = 0.916648
Validation mse = 0.008920
Epoch 53
Loss = 6.8231e-02, PNorm = 44.5793, GNorm = 1.6920, lr_0 = 1.1162e-04
Loss = 5.3368e-02, PNorm = 44.5845, GNorm = 0.5237, lr_0 = 1.0826e-04
Validation rmse = 0.092860
Validation r2 = 0.919426
Validation mse = 0.008623
Epoch 54
Loss = 5.7168e-02, PNorm = 44.5876, GNorm = 3.5578, lr_0 = 1.0501e-04
Validation rmse = 0.105400
Validation r2 = 0.896195
Validation mse = 0.011109
Epoch 55
Loss = 5.1005e-02, PNorm = 44.5925, GNorm = 1.9938, lr_0 = 1.0154e-04
Loss = 6.0980e-02, PNorm = 44.5964, GNorm = 0.8312, lr_0 = 1.0000e-04
Validation rmse = 0.111787
Validation r2 = 0.883233
Validation mse = 0.012496
Epoch 56
Loss = 5.7353e-02, PNorm = 44.6014, GNorm = 1.0126, lr_0 = 1.0000e-04
Validation rmse = 0.106251
Validation r2 = 0.894513
Validation mse = 0.011289
Epoch 57
Loss = 5.3419e-02, PNorm = 44.6047, GNorm = 1.0615, lr_0 = 1.0000e-04
Validation rmse = 0.111299
Validation r2 = 0.884251
Validation mse = 0.012387
Epoch 58
Loss = 5.1427e-02, PNorm = 44.6086, GNorm = 0.9319, lr_0 = 1.0000e-04
Loss = 5.6470e-02, PNorm = 44.6130, GNorm = 0.8033, lr_0 = 1.0000e-04
Validation rmse = 0.117233
Validation r2 = 0.871578
Validation mse = 0.013744
Epoch 59
Loss = 5.2051e-02, PNorm = 44.6176, GNorm = 1.4421, lr_0 = 1.0000e-04
Validation rmse = 0.111109
Validation r2 = 0.884646
Validation mse = 0.012345
Model 0 best validation rmse = 0.074647 on epoch 19
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.143185
Model 0 test r2 = 0.669572
Model 0 test mse = 0.020502
Ensemble test rmse = 0.143185
Ensemble test r2 = 0.669572
Ensemble test mse = 0.020502
Fold 7
Splitting data with seed 7
Total size = 695 | train size = 688 | val size = 7 | test size = 337
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 8.5954e-01, PNorm = 43.2667, GNorm = 3.2757, lr_0 = 4.8077e-04
Validation rmse = 0.313947
Validation r2 = 0.229664
Validation mse = 0.098562
Epoch 1
Loss = 8.6516e-01, PNorm = 43.2967, GNorm = 4.5228, lr_0 = 8.6154e-04
Validation rmse = 0.323501
Validation r2 = 0.182064
Validation mse = 0.104653
Epoch 2
Loss = 6.4671e-01, PNorm = 43.3610, GNorm = 0.8855, lr_0 = 9.8184e-04
Loss = 5.1749e-01, PNorm = 43.4458, GNorm = 5.8166, lr_0 = 9.5231e-04
Validation rmse = 0.309554
Validation r2 = 0.251070
Validation mse = 0.095823
Epoch 3
Loss = 3.9829e-01, PNorm = 43.5144, GNorm = 2.2620, lr_0 = 9.2367e-04
Validation rmse = 0.209942
Validation r2 = 0.655516
Validation mse = 0.044076
Epoch 4
Loss = 3.6081e-01, PNorm = 43.5796, GNorm = 3.2724, lr_0 = 8.9589e-04
Validation rmse = 0.133215
Validation r2 = 0.861300
Validation mse = 0.017746
Epoch 5
Loss = 2.9037e-01, PNorm = 43.6404, GNorm = 4.4831, lr_0 = 8.6629e-04
Loss = 2.4256e-01, PNorm = 43.6876, GNorm = 1.3959, lr_0 = 8.4024e-04
Validation rmse = 0.147158
Validation r2 = 0.830748
Validation mse = 0.021655
Epoch 6
Loss = 2.2750e-01, PNorm = 43.7324, GNorm = 1.9058, lr_0 = 8.1497e-04
Validation rmse = 0.108696
Validation r2 = 0.907659
Validation mse = 0.011815
Epoch 7
Loss = 1.9235e-01, PNorm = 43.7685, GNorm = 2.5656, lr_0 = 7.9046e-04
Loss = 1.8514e-01, PNorm = 43.8043, GNorm = 0.7718, lr_0 = 7.6668e-04
Validation rmse = 0.141998
Validation r2 = 0.842408
Validation mse = 0.020164
Epoch 8
Loss = 1.7241e-01, PNorm = 43.8376, GNorm = 6.8765, lr_0 = 7.4362e-04
Validation rmse = 0.102712
Validation r2 = 0.917546
Validation mse = 0.010550
Epoch 9
Loss = 1.7160e-01, PNorm = 43.8689, GNorm = 3.7880, lr_0 = 7.1906e-04
Validation rmse = 0.095003
Validation r2 = 0.929459
Validation mse = 0.009026
Epoch 10
Loss = 1.1589e-01, PNorm = 43.8950, GNorm = 1.5018, lr_0 = 6.9743e-04
Loss = 1.4591e-01, PNorm = 43.9190, GNorm = 3.8317, lr_0 = 6.7645e-04
Validation rmse = 0.072168
Validation r2 = 0.959294
Validation mse = 0.005208
Epoch 11
Loss = 1.4801e-01, PNorm = 43.9398, GNorm = 2.1773, lr_0 = 6.5611e-04
Validation rmse = 0.112048
Validation r2 = 0.901876
Validation mse = 0.012555
Epoch 12
Loss = 1.2684e-01, PNorm = 43.9580, GNorm = 3.3153, lr_0 = 6.3638e-04
Validation rmse = 0.087801
Validation r2 = 0.939748
Validation mse = 0.007709
Epoch 13
Loss = 1.5808e-01, PNorm = 43.9806, GNorm = 1.5578, lr_0 = 6.1535e-04
Loss = 1.1479e-01, PNorm = 43.9958, GNorm = 3.7510, lr_0 = 5.9685e-04
Validation rmse = 0.083072
Validation r2 = 0.946064
Validation mse = 0.006901
Epoch 14
Loss = 1.3204e-01, PNorm = 44.0121, GNorm = 3.1096, lr_0 = 5.7889e-04
Validation rmse = 0.080592
Validation r2 = 0.949236
Validation mse = 0.006495
Epoch 15
Loss = 1.6046e-01, PNorm = 44.0281, GNorm = 3.3727, lr_0 = 5.6148e-04
Loss = 1.1214e-01, PNorm = 44.0469, GNorm = 2.5631, lr_0 = 5.4460e-04
Validation rmse = 0.096319
Validation r2 = 0.927491
Validation mse = 0.009277
Epoch 16
Loss = 1.0785e-01, PNorm = 44.0639, GNorm = 1.2874, lr_0 = 5.2822e-04
Validation rmse = 0.088304
Validation r2 = 0.939056
Validation mse = 0.007798
Epoch 17
Loss = 9.6150e-02, PNorm = 44.0779, GNorm = 1.2786, lr_0 = 5.1077e-04
Validation rmse = 0.077540
Validation r2 = 0.953008
Validation mse = 0.006012
Epoch 18
Loss = 1.0083e-01, PNorm = 44.0933, GNorm = 2.2115, lr_0 = 4.9540e-04
Loss = 1.1161e-01, PNorm = 44.1043, GNorm = 1.3753, lr_0 = 4.8050e-04
Validation rmse = 0.085787
Validation r2 = 0.942481
Validation mse = 0.007359
Epoch 19
Loss = 1.1613e-01, PNorm = 44.1201, GNorm = 3.2583, lr_0 = 4.6605e-04
Validation rmse = 0.080251
Validation r2 = 0.949665
Validation mse = 0.006440
Epoch 20
Loss = 1.2877e-01, PNorm = 44.1376, GNorm = 3.5862, lr_0 = 4.5204e-04
Validation rmse = 0.086839
Validation r2 = 0.941061
Validation mse = 0.007541
Epoch 21
Loss = 1.1470e-01, PNorm = 44.1546, GNorm = 2.0630, lr_0 = 4.3710e-04
Loss = 1.0096e-01, PNorm = 44.1651, GNorm = 0.5225, lr_0 = 4.2396e-04
Validation rmse = 0.081630
Validation r2 = 0.947921
Validation mse = 0.006663
Epoch 22
Loss = 9.1313e-02, PNorm = 44.1776, GNorm = 0.9617, lr_0 = 4.1120e-04
Validation rmse = 0.074202
Validation r2 = 0.956967
Validation mse = 0.005506
Epoch 23
Loss = 9.1324e-02, PNorm = 44.1908, GNorm = 0.7652, lr_0 = 3.9884e-04
Loss = 9.0625e-02, PNorm = 44.2027, GNorm = 1.6402, lr_0 = 3.8684e-04
Validation rmse = 0.117262
Validation r2 = 0.892531
Validation mse = 0.013750
Epoch 24
Loss = 9.6799e-02, PNorm = 44.2134, GNorm = 0.7055, lr_0 = 3.7521e-04
Validation rmse = 0.085097
Validation r2 = 0.943403
Validation mse = 0.007241
Epoch 25
Loss = 8.0978e-02, PNorm = 44.2245, GNorm = 1.3267, lr_0 = 3.6392e-04
Validation rmse = 0.080965
Validation r2 = 0.948765
Validation mse = 0.006555
Epoch 26
Loss = 8.1018e-02, PNorm = 44.2373, GNorm = 1.2036, lr_0 = 3.5190e-04
Loss = 8.8975e-02, PNorm = 44.2481, GNorm = 1.4157, lr_0 = 3.4132e-04
Validation rmse = 0.086218
Validation r2 = 0.941901
Validation mse = 0.007434
Epoch 27
Loss = 9.5156e-02, PNorm = 44.2601, GNorm = 2.7406, lr_0 = 3.3105e-04
Validation rmse = 0.092323
Validation r2 = 0.933382
Validation mse = 0.008524
Epoch 28
Loss = 8.8486e-02, PNorm = 44.2707, GNorm = 1.1319, lr_0 = 3.2109e-04
Validation rmse = 0.077305
Validation r2 = 0.953292
Validation mse = 0.005976
Epoch 29
Loss = 7.8101e-02, PNorm = 44.2828, GNorm = 1.1619, lr_0 = 3.1144e-04
Loss = 7.7392e-02, PNorm = 44.2946, GNorm = 1.0705, lr_0 = 3.0207e-04
Validation rmse = 0.080555
Validation r2 = 0.949283
Validation mse = 0.006489
Epoch 30
Loss = 8.4004e-02, PNorm = 44.3055, GNorm = 1.8056, lr_0 = 2.9209e-04
Validation rmse = 0.079345
Validation r2 = 0.950796
Validation mse = 0.006296
Epoch 31
Loss = 8.4916e-02, PNorm = 44.3151, GNorm = 1.0994, lr_0 = 2.8331e-04
Loss = 7.2125e-02, PNorm = 44.3250, GNorm = 0.4757, lr_0 = 2.7478e-04
Validation rmse = 0.103519
Validation r2 = 0.916246
Validation mse = 0.010716
Epoch 32
Loss = 8.4279e-02, PNorm = 44.3352, GNorm = 2.0425, lr_0 = 2.6652e-04
Validation rmse = 0.088419
Validation r2 = 0.938897
Validation mse = 0.007818
Epoch 33
Loss = 6.8984e-02, PNorm = 44.3441, GNorm = 1.0960, lr_0 = 2.5850e-04
Validation rmse = 0.104576
Validation r2 = 0.914526
Validation mse = 0.010936
Epoch 34
Loss = 7.3713e-02, PNorm = 44.3545, GNorm = 0.5761, lr_0 = 2.4996e-04
Loss = 7.5615e-02, PNorm = 44.3639, GNorm = 1.4878, lr_0 = 2.4245e-04
Validation rmse = 0.094224
Validation r2 = 0.930611
Validation mse = 0.008878
Epoch 35
Loss = 6.6839e-02, PNorm = 44.3714, GNorm = 0.7266, lr_0 = 2.3515e-04
Validation rmse = 0.123642
Validation r2 = 0.880519
Validation mse = 0.015287
Epoch 36
Loss = 9.1826e-02, PNorm = 44.3806, GNorm = 3.6034, lr_0 = 2.2808e-04
Validation rmse = 0.093323
Validation r2 = 0.931931
Validation mse = 0.008709
Epoch 37
Loss = 8.0031e-02, PNorm = 44.3898, GNorm = 3.0556, lr_0 = 2.2122e-04
Loss = 7.6561e-02, PNorm = 44.3975, GNorm = 2.1707, lr_0 = 2.1457e-04
Validation rmse = 0.116240
Validation r2 = 0.894396
Validation mse = 0.013512
Epoch 38
Loss = 6.7960e-02, PNorm = 44.4064, GNorm = 0.5579, lr_0 = 2.0748e-04
Validation rmse = 0.111717
Validation r2 = 0.902455
Validation mse = 0.012481
Epoch 39
Loss = 5.8768e-02, PNorm = 44.4143, GNorm = 0.8692, lr_0 = 2.0124e-04
Loss = 7.3463e-02, PNorm = 44.4216, GNorm = 3.2270, lr_0 = 1.9519e-04
Validation rmse = 0.108387
Validation r2 = 0.908184
Validation mse = 0.011748
Epoch 40
Loss = 6.6007e-02, PNorm = 44.4282, GNorm = 0.6251, lr_0 = 1.8932e-04
Validation rmse = 0.113836
Validation r2 = 0.898719
Validation mse = 0.012959
Epoch 41
Loss = 6.3658e-02, PNorm = 44.4343, GNorm = 2.1013, lr_0 = 1.8362e-04
Validation rmse = 0.096271
Validation r2 = 0.927563
Validation mse = 0.009268
Epoch 42
Loss = 6.4269e-02, PNorm = 44.4425, GNorm = 1.1041, lr_0 = 1.7756e-04
Loss = 6.7461e-02, PNorm = 44.4485, GNorm = 2.3466, lr_0 = 1.7222e-04
Validation rmse = 0.087983
Validation r2 = 0.939498
Validation mse = 0.007741
Epoch 43
Loss = 6.9175e-02, PNorm = 44.4544, GNorm = 1.9987, lr_0 = 1.6704e-04
Validation rmse = 0.116774
Validation r2 = 0.893423
Validation mse = 0.013636
Epoch 44
Loss = 5.4823e-02, PNorm = 44.4608, GNorm = 0.8107, lr_0 = 1.6201e-04
Validation rmse = 0.118246
Validation r2 = 0.890720
Validation mse = 0.013982
Epoch 45
Loss = 8.5297e-02, PNorm = 44.4662, GNorm = 2.1898, lr_0 = 1.5714e-04
Loss = 6.1967e-02, PNorm = 44.4719, GNorm = 1.8148, lr_0 = 1.5241e-04
Validation rmse = 0.103614
Validation r2 = 0.916091
Validation mse = 0.010736
Epoch 46
Loss = 6.5835e-02, PNorm = 44.4779, GNorm = 0.9540, lr_0 = 1.4738e-04
Validation rmse = 0.100859
Validation r2 = 0.920494
Validation mse = 0.010173
Epoch 47
Loss = 5.3857e-02, PNorm = 44.4833, GNorm = 1.5716, lr_0 = 1.4295e-04
Loss = 6.6508e-02, PNorm = 44.4881, GNorm = 2.1549, lr_0 = 1.3865e-04
Validation rmse = 0.120182
Validation r2 = 0.887111
Validation mse = 0.014444
Epoch 48
Loss = 5.8971e-02, PNorm = 44.4927, GNorm = 1.0528, lr_0 = 1.3448e-04
Validation rmse = 0.122293
Validation r2 = 0.883112
Validation mse = 0.014956
Epoch 49
Loss = 5.6635e-02, PNorm = 44.4965, GNorm = 1.0880, lr_0 = 1.3043e-04
Validation rmse = 0.101322
Validation r2 = 0.919762
Validation mse = 0.010266
Epoch 50
Loss = 4.6960e-02, PNorm = 44.5013, GNorm = 0.4211, lr_0 = 1.2651e-04
Loss = 5.7827e-02, PNorm = 44.5056, GNorm = 1.6638, lr_0 = 1.2270e-04
Validation rmse = 0.112944
Validation r2 = 0.900300
Validation mse = 0.012756
Epoch 51
Loss = 5.3114e-02, PNorm = 44.5112, GNorm = 0.4282, lr_0 = 1.1865e-04
Validation rmse = 0.109570
Validation r2 = 0.906167
Validation mse = 0.012006
Epoch 52
Loss = 5.4505e-02, PNorm = 44.5159, GNorm = 2.7740, lr_0 = 1.1508e-04
Validation rmse = 0.131544
Validation r2 = 0.864758
Validation mse = 0.017304
Epoch 53
Loss = 5.8328e-02, PNorm = 44.5204, GNorm = 1.9394, lr_0 = 1.1162e-04
Loss = 5.6676e-02, PNorm = 44.5247, GNorm = 0.7082, lr_0 = 1.0826e-04
Validation rmse = 0.133258
Validation r2 = 0.861210
Validation mse = 0.017758
Epoch 54
Loss = 6.3334e-02, PNorm = 44.5285, GNorm = 2.7495, lr_0 = 1.0501e-04
Validation rmse = 0.117961
Validation r2 = 0.891245
Validation mse = 0.013915
Epoch 55
Loss = 4.7255e-02, PNorm = 44.5329, GNorm = 0.6429, lr_0 = 1.0154e-04
Loss = 5.8843e-02, PNorm = 44.5363, GNorm = 2.5080, lr_0 = 1.0000e-04
Validation rmse = 0.126310
Validation r2 = 0.875306
Validation mse = 0.015954
Epoch 56
Loss = 5.3735e-02, PNorm = 44.5408, GNorm = 1.0035, lr_0 = 1.0000e-04
Validation rmse = 0.110775
Validation r2 = 0.904093
Validation mse = 0.012271
Epoch 57
Loss = 4.9844e-02, PNorm = 44.5441, GNorm = 0.7802, lr_0 = 1.0000e-04
Validation rmse = 0.111022
Validation r2 = 0.903665
Validation mse = 0.012326
Epoch 58
Loss = 3.8495e-02, PNorm = 44.5474, GNorm = 1.1339, lr_0 = 1.0000e-04
Loss = 5.8182e-02, PNorm = 44.5510, GNorm = 2.2529, lr_0 = 1.0000e-04
Validation rmse = 0.115929
Validation r2 = 0.894961
Validation mse = 0.013440
Epoch 59
Loss = 5.4353e-02, PNorm = 44.5550, GNorm = 0.9969, lr_0 = 1.0000e-04
Validation rmse = 0.121000
Validation r2 = 0.885570
Validation mse = 0.014641
Model 0 best validation rmse = 0.072168 on epoch 10
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.188587
Model 0 test r2 = 0.426804
Model 0 test mse = 0.035565
Ensemble test rmse = 0.188587
Ensemble test r2 = 0.426804
Ensemble test mse = 0.035565
Fold 8
Splitting data with seed 8
Total size = 695 | train size = 688 | val size = 7 | test size = 337
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.5569e-01, PNorm = 43.2655, GNorm = 4.2963, lr_0 = 4.8077e-04
Validation rmse = 0.355424
Validation r2 = 0.001564
Validation mse = 0.126326
Epoch 1
Loss = 7.4465e-01, PNorm = 43.3036, GNorm = 10.3642, lr_0 = 8.6154e-04
Validation rmse = 0.318180
Validation r2 = 0.199851
Validation mse = 0.101238
Epoch 2
Loss = 4.9959e-01, PNorm = 43.3689, GNorm = 4.8652, lr_0 = 9.8184e-04
Loss = 4.8434e-01, PNorm = 43.4421, GNorm = 5.7536, lr_0 = 9.5231e-04
Validation rmse = 0.212316
Validation r2 = 0.643719
Validation mse = 0.045078
Epoch 3
Loss = 3.6445e-01, PNorm = 43.5115, GNorm = 3.0741, lr_0 = 9.2367e-04
Validation rmse = 0.202400
Validation r2 = 0.676221
Validation mse = 0.040966
Epoch 4
Loss = 3.6694e-01, PNorm = 43.5738, GNorm = 1.8310, lr_0 = 8.9589e-04
Validation rmse = 0.210423
Validation r2 = 0.650044
Validation mse = 0.044278
Epoch 5
Loss = 2.7404e-01, PNorm = 43.6339, GNorm = 0.9220, lr_0 = 8.6629e-04
Loss = 2.1455e-01, PNorm = 43.6837, GNorm = 1.6982, lr_0 = 8.4024e-04
Validation rmse = 0.165818
Validation r2 = 0.782684
Validation mse = 0.027496
Epoch 6
Loss = 1.9860e-01, PNorm = 43.7255, GNorm = 1.1883, lr_0 = 8.1497e-04
Validation rmse = 0.171159
Validation r2 = 0.768460
Validation mse = 0.029295
Epoch 7
Loss = 1.6136e-01, PNorm = 43.7685, GNorm = 2.0455, lr_0 = 7.9046e-04
Loss = 1.9483e-01, PNorm = 43.8053, GNorm = 4.4312, lr_0 = 7.6668e-04
Validation rmse = 0.166790
Validation r2 = 0.780130
Validation mse = 0.027819
Epoch 8
Loss = 1.9339e-01, PNorm = 43.8351, GNorm = 1.2537, lr_0 = 7.4362e-04
Validation rmse = 0.207225
Validation r2 = 0.660602
Validation mse = 0.042942
Epoch 9
Loss = 1.6666e-01, PNorm = 43.8656, GNorm = 0.9562, lr_0 = 7.1906e-04
Validation rmse = 0.181489
Validation r2 = 0.739669
Validation mse = 0.032938
Epoch 10
Loss = 1.7433e-01, PNorm = 43.8964, GNorm = 1.2881, lr_0 = 6.9743e-04
Loss = 1.2675e-01, PNorm = 43.9229, GNorm = 1.2301, lr_0 = 6.7645e-04
Validation rmse = 0.137851
Validation r2 = 0.849809
Validation mse = 0.019003
Epoch 11
Loss = 1.3473e-01, PNorm = 43.9423, GNorm = 1.3464, lr_0 = 6.5611e-04
Validation rmse = 0.140566
Validation r2 = 0.843833
Validation mse = 0.019759
Epoch 12
Loss = 1.2621e-01, PNorm = 43.9583, GNorm = 0.7416, lr_0 = 6.3638e-04
Validation rmse = 0.159830
Validation r2 = 0.798097
Validation mse = 0.025546
Epoch 13
Loss = 1.5462e-01, PNorm = 43.9772, GNorm = 1.3379, lr_0 = 6.1535e-04
Loss = 1.0488e-01, PNorm = 43.9948, GNorm = 0.7405, lr_0 = 5.9685e-04
Validation rmse = 0.149224
Validation r2 = 0.824005
Validation mse = 0.022268
Epoch 14
Loss = 1.2363e-01, PNorm = 44.0099, GNorm = 2.8519, lr_0 = 5.7889e-04
Validation rmse = 0.153645
Validation r2 = 0.813420
Validation mse = 0.023607
Epoch 15
Loss = 1.0193e-01, PNorm = 44.0253, GNorm = 1.2025, lr_0 = 5.6148e-04
Loss = 1.2505e-01, PNorm = 44.0407, GNorm = 4.3524, lr_0 = 5.4460e-04
Validation rmse = 0.158397
Validation r2 = 0.801700
Validation mse = 0.025090
Epoch 16
Loss = 1.2705e-01, PNorm = 44.0557, GNorm = 2.8876, lr_0 = 5.2822e-04
Validation rmse = 0.134785
Validation r2 = 0.856414
Validation mse = 0.018167
Epoch 17
Loss = 1.0602e-01, PNorm = 44.0725, GNorm = 0.8687, lr_0 = 5.1077e-04
Validation rmse = 0.161499
Validation r2 = 0.793859
Validation mse = 0.026082
Epoch 18
Loss = 1.1781e-01, PNorm = 44.0845, GNorm = 1.2521, lr_0 = 4.9540e-04
Loss = 1.0783e-01, PNorm = 44.1002, GNorm = 2.2120, lr_0 = 4.8050e-04
Validation rmse = 0.152877
Validation r2 = 0.815282
Validation mse = 0.023371
Epoch 19
Loss = 9.9161e-02, PNorm = 44.1128, GNorm = 1.1975, lr_0 = 4.6605e-04
Validation rmse = 0.147819
Validation r2 = 0.827302
Validation mse = 0.021850
Epoch 20
Loss = 9.3184e-02, PNorm = 44.1311, GNorm = 1.0312, lr_0 = 4.5204e-04
Validation rmse = 0.153855
Validation r2 = 0.812911
Validation mse = 0.023671
Epoch 21
Loss = 9.4169e-02, PNorm = 44.1467, GNorm = 2.2579, lr_0 = 4.3710e-04
Loss = 9.9163e-02, PNorm = 44.1635, GNorm = 0.8356, lr_0 = 4.2396e-04
Validation rmse = 0.149942
Validation r2 = 0.822306
Validation mse = 0.022483
Epoch 22
Loss = 1.1184e-01, PNorm = 44.1761, GNorm = 0.4846, lr_0 = 4.1120e-04
Validation rmse = 0.159273
Validation r2 = 0.799500
Validation mse = 0.025368
Epoch 23
Loss = 1.0879e-01, PNorm = 44.1898, GNorm = 2.2744, lr_0 = 3.9884e-04
Loss = 1.1390e-01, PNorm = 44.2060, GNorm = 2.7853, lr_0 = 3.8684e-04
Validation rmse = 0.165751
Validation r2 = 0.782860
Validation mse = 0.027473
Epoch 24
Loss = 1.0585e-01, PNorm = 44.2208, GNorm = 2.9018, lr_0 = 3.7521e-04
Validation rmse = 0.160382
Validation r2 = 0.796700
Validation mse = 0.025722
Epoch 25
Loss = 8.4037e-02, PNorm = 44.2334, GNorm = 0.9237, lr_0 = 3.6392e-04
Validation rmse = 0.141080
Validation r2 = 0.842689
Validation mse = 0.019904
Epoch 26
Loss = 9.5174e-02, PNorm = 44.2484, GNorm = 2.5167, lr_0 = 3.5190e-04
Loss = 9.0712e-02, PNorm = 44.2623, GNorm = 1.1066, lr_0 = 3.4132e-04
Validation rmse = 0.163285
Validation r2 = 0.789272
Validation mse = 0.026662
Epoch 27
Loss = 8.7974e-02, PNorm = 44.2724, GNorm = 1.2049, lr_0 = 3.3105e-04
Validation rmse = 0.149771
Validation r2 = 0.822712
Validation mse = 0.022431
Epoch 28
Loss = 8.8205e-02, PNorm = 44.2823, GNorm = 1.0963, lr_0 = 3.2109e-04
Validation rmse = 0.152733
Validation r2 = 0.815629
Validation mse = 0.023327
Epoch 29
Loss = 6.3560e-02, PNorm = 44.2933, GNorm = 1.4602, lr_0 = 3.1144e-04
Loss = 7.8184e-02, PNorm = 44.3052, GNorm = 1.1284, lr_0 = 3.0207e-04
Validation rmse = 0.140621
Validation r2 = 0.843712
Validation mse = 0.019774
Epoch 30
Loss = 7.8348e-02, PNorm = 44.3148, GNorm = 1.3761, lr_0 = 2.9209e-04
Validation rmse = 0.171809
Validation r2 = 0.766698
Validation mse = 0.029518
Epoch 31
Loss = 8.7261e-02, PNorm = 44.3231, GNorm = 0.8629, lr_0 = 2.8331e-04
Loss = 8.2167e-02, PNorm = 44.3344, GNorm = 0.9163, lr_0 = 2.7478e-04
Validation rmse = 0.155656
Validation r2 = 0.808505
Validation mse = 0.024229
Epoch 32
Loss = 7.0451e-02, PNorm = 44.3444, GNorm = 1.5515, lr_0 = 2.6652e-04
Validation rmse = 0.150295
Validation r2 = 0.821467
Validation mse = 0.022589
Epoch 33
Loss = 6.8027e-02, PNorm = 44.3553, GNorm = 0.6752, lr_0 = 2.5850e-04
Validation rmse = 0.150837
Validation r2 = 0.820179
Validation mse = 0.022752
Epoch 34
Loss = 6.0937e-02, PNorm = 44.3642, GNorm = 0.9375, lr_0 = 2.4996e-04
Loss = 7.8522e-02, PNorm = 44.3739, GNorm = 1.6487, lr_0 = 2.4245e-04
Validation rmse = 0.148701
Validation r2 = 0.825235
Validation mse = 0.022112
Epoch 35
Loss = 9.1289e-02, PNorm = 44.3838, GNorm = 2.4287, lr_0 = 2.3515e-04
Validation rmse = 0.180731
Validation r2 = 0.741839
Validation mse = 0.032664
Epoch 36
Loss = 9.2221e-02, PNorm = 44.3937, GNorm = 3.4899, lr_0 = 2.2808e-04
Validation rmse = 0.140998
Validation r2 = 0.842873
Validation mse = 0.019880
Epoch 37
Loss = 6.0007e-02, PNorm = 44.4032, GNorm = 1.1842, lr_0 = 2.2122e-04
Loss = 7.8959e-02, PNorm = 44.4113, GNorm = 2.8727, lr_0 = 2.1457e-04
Validation rmse = 0.146618
Validation r2 = 0.830097
Validation mse = 0.021497
Epoch 38
Loss = 7.5248e-02, PNorm = 44.4204, GNorm = 0.5258, lr_0 = 2.0748e-04
Validation rmse = 0.150310
Validation r2 = 0.821433
Validation mse = 0.022593
Epoch 39
Loss = 8.0473e-02, PNorm = 44.4285, GNorm = 0.9215, lr_0 = 2.0124e-04
Loss = 6.0026e-02, PNorm = 44.4359, GNorm = 1.1646, lr_0 = 1.9519e-04
Validation rmse = 0.151626
Validation r2 = 0.818292
Validation mse = 0.022990
Epoch 40
Loss = 6.7455e-02, PNorm = 44.4434, GNorm = 1.8523, lr_0 = 1.8932e-04
Validation rmse = 0.150139
Validation r2 = 0.821838
Validation mse = 0.022542
Epoch 41
Loss = 5.9196e-02, PNorm = 44.4501, GNorm = 0.8591, lr_0 = 1.8362e-04
Validation rmse = 0.159811
Validation r2 = 0.798146
Validation mse = 0.025539
Epoch 42
Loss = 8.0785e-02, PNorm = 44.4579, GNorm = 2.5886, lr_0 = 1.7756e-04
Loss = 6.3987e-02, PNorm = 44.4650, GNorm = 0.8806, lr_0 = 1.7222e-04
Validation rmse = 0.154466
Validation r2 = 0.811420
Validation mse = 0.023860
Epoch 43
Loss = 6.5915e-02, PNorm = 44.4728, GNorm = 1.0535, lr_0 = 1.6704e-04
Validation rmse = 0.146699
Validation r2 = 0.829908
Validation mse = 0.021521
Epoch 44
Loss = 6.3224e-02, PNorm = 44.4785, GNorm = 0.6394, lr_0 = 1.6201e-04
Validation rmse = 0.148804
Validation r2 = 0.824992
Validation mse = 0.022143
Epoch 45
Loss = 5.0933e-02, PNorm = 44.4846, GNorm = 1.6168, lr_0 = 1.5714e-04
Loss = 6.3473e-02, PNorm = 44.4918, GNorm = 1.0058, lr_0 = 1.5241e-04
Validation rmse = 0.155862
Validation r2 = 0.807997
Validation mse = 0.024293
Epoch 46
Loss = 5.7178e-02, PNorm = 44.4985, GNorm = 1.3269, lr_0 = 1.4738e-04
Validation rmse = 0.151823
Validation r2 = 0.817820
Validation mse = 0.023050
Epoch 47
Loss = 7.0103e-02, PNorm = 44.5045, GNorm = 0.7909, lr_0 = 1.4295e-04
Loss = 5.9282e-02, PNorm = 44.5107, GNorm = 1.3904, lr_0 = 1.3865e-04
Validation rmse = 0.147658
Validation r2 = 0.827677
Validation mse = 0.021803
Epoch 48
Loss = 5.7465e-02, PNorm = 44.5164, GNorm = 0.9566, lr_0 = 1.3448e-04
Validation rmse = 0.150427
Validation r2 = 0.821155
Validation mse = 0.022628
Epoch 49
Loss = 5.9647e-02, PNorm = 44.5221, GNorm = 1.2691, lr_0 = 1.3043e-04
Validation rmse = 0.151645
Validation r2 = 0.818247
Validation mse = 0.022996
Epoch 50
Loss = 6.5486e-02, PNorm = 44.5273, GNorm = 0.5380, lr_0 = 1.2651e-04
Loss = 5.8825e-02, PNorm = 44.5325, GNorm = 1.7225, lr_0 = 1.2270e-04
Validation rmse = 0.150493
Validation r2 = 0.820998
Validation mse = 0.022648
Epoch 51
Loss = 5.6955e-02, PNorm = 44.5379, GNorm = 0.8805, lr_0 = 1.1865e-04
Validation rmse = 0.149196
Validation r2 = 0.824070
Validation mse = 0.022259
Epoch 52
Loss = 3.9418e-02, PNorm = 44.5425, GNorm = 0.3489, lr_0 = 1.1508e-04
Validation rmse = 0.143203
Validation r2 = 0.837918
Validation mse = 0.020507
Epoch 53
Loss = 3.7297e-02, PNorm = 44.5464, GNorm = 1.1516, lr_0 = 1.1162e-04
Loss = 6.7353e-02, PNorm = 44.5514, GNorm = 1.5188, lr_0 = 1.0826e-04
Validation rmse = 0.152356
Validation r2 = 0.816537
Validation mse = 0.023212
Epoch 54
Loss = 6.9062e-02, PNorm = 44.5565, GNorm = 0.9727, lr_0 = 1.0501e-04
Validation rmse = 0.146613
Validation r2 = 0.830108
Validation mse = 0.021495
Epoch 55
Loss = 6.1356e-02, PNorm = 44.5620, GNorm = 0.6877, lr_0 = 1.0154e-04
Loss = 5.2692e-02, PNorm = 44.5666, GNorm = 1.8931, lr_0 = 1.0000e-04
Validation rmse = 0.159585
Validation r2 = 0.798716
Validation mse = 0.025467
Epoch 56
Loss = 5.6993e-02, PNorm = 44.5710, GNorm = 0.9758, lr_0 = 1.0000e-04
Validation rmse = 0.146956
Validation r2 = 0.829313
Validation mse = 0.021596
Epoch 57
Loss = 5.0068e-02, PNorm = 44.5748, GNorm = 0.8724, lr_0 = 1.0000e-04
Validation rmse = 0.155458
Validation r2 = 0.808991
Validation mse = 0.024167
Epoch 58
Loss = 5.1282e-02, PNorm = 44.5790, GNorm = 2.0207, lr_0 = 1.0000e-04
Loss = 5.4148e-02, PNorm = 44.5830, GNorm = 1.0752, lr_0 = 1.0000e-04
Validation rmse = 0.145016
Validation r2 = 0.833789
Validation mse = 0.021030
Epoch 59
Loss = 5.4714e-02, PNorm = 44.5878, GNorm = 1.0398, lr_0 = 1.0000e-04
Validation rmse = 0.150537
Validation r2 = 0.820892
Validation mse = 0.022661
Model 0 best validation rmse = 0.134785 on epoch 16
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.162608
Model 0 test r2 = 0.573850
Model 0 test mse = 0.026441
Ensemble test rmse = 0.162608
Ensemble test r2 = 0.573850
Ensemble test mse = 0.026441
Fold 9
Splitting data with seed 9
Total size = 695 | train size = 688 | val size = 7 | test size = 337
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 8.9384e-01, PNorm = 43.2676, GNorm = 4.1819, lr_0 = 4.8077e-04
Validation rmse = 0.299939
Validation r2 = 0.108287
Validation mse = 0.089963
Epoch 1
Loss = 5.7383e-01, PNorm = 43.3115, GNorm = 0.7575, lr_0 = 8.6154e-04
Validation rmse = 0.339892
Validation r2 = -0.145095
Validation mse = 0.115527
Epoch 2
Loss = 5.2680e-01, PNorm = 43.3855, GNorm = 1.7134, lr_0 = 9.8184e-04
Loss = 5.2600e-01, PNorm = 43.4569, GNorm = 3.5484, lr_0 = 9.5231e-04
Validation rmse = 0.249331
Validation r2 = 0.383811
Validation mse = 0.062166
Epoch 3
Loss = 3.5853e-01, PNorm = 43.5282, GNorm = 4.2744, lr_0 = 9.2367e-04
Validation rmse = 0.194914
Validation r2 = 0.623428
Validation mse = 0.037992
Epoch 4
Loss = 3.3484e-01, PNorm = 43.5922, GNorm = 1.9272, lr_0 = 8.9589e-04
Validation rmse = 0.154891
Validation r2 = 0.762200
Validation mse = 0.023991
Epoch 5
Loss = 2.4024e-01, PNorm = 43.6505, GNorm = 1.8141, lr_0 = 8.6629e-04
Loss = 2.4193e-01, PNorm = 43.6968, GNorm = 8.0806, lr_0 = 8.4024e-04
Validation rmse = 0.276057
Validation r2 = 0.244634
Validation mse = 0.076208
Epoch 6
Loss = 2.2117e-01, PNorm = 43.7442, GNorm = 0.9221, lr_0 = 8.1497e-04
Validation rmse = 0.135584
Validation r2 = 0.817787
Validation mse = 0.018383
Epoch 7
Loss = 1.7126e-01, PNorm = 43.7774, GNorm = 0.8343, lr_0 = 7.9046e-04
Loss = 2.0060e-01, PNorm = 43.8135, GNorm = 1.1650, lr_0 = 7.6668e-04
Validation rmse = 0.095444
Validation r2 = 0.909707
Validation mse = 0.009109
Epoch 8
Loss = 1.7142e-01, PNorm = 43.8450, GNorm = 0.8747, lr_0 = 7.4362e-04
Validation rmse = 0.080807
Validation r2 = 0.935277
Validation mse = 0.006530
Epoch 9
Loss = 1.5229e-01, PNorm = 43.8802, GNorm = 1.2360, lr_0 = 7.1906e-04
Validation rmse = 0.109294
Validation r2 = 0.881600
Validation mse = 0.011945
Epoch 10
Loss = 1.2062e-01, PNorm = 43.9051, GNorm = 1.1590, lr_0 = 6.9743e-04
Loss = 1.3941e-01, PNorm = 43.9301, GNorm = 2.3663, lr_0 = 6.7645e-04
Validation rmse = 0.066520
Validation r2 = 0.956141
Validation mse = 0.004425
Epoch 11
Loss = 1.3481e-01, PNorm = 43.9504, GNorm = 4.6203, lr_0 = 6.5611e-04
Validation rmse = 0.209345
Validation r2 = 0.565603
Validation mse = 0.043825
Epoch 12
Loss = 1.5256e-01, PNorm = 43.9704, GNorm = 3.1822, lr_0 = 6.3638e-04
Validation rmse = 0.207963
Validation r2 = 0.571323
Validation mse = 0.043248
Epoch 13
Loss = 1.2434e-01, PNorm = 43.9930, GNorm = 1.4736, lr_0 = 6.1535e-04
Loss = 1.2966e-01, PNorm = 44.0145, GNorm = 0.5508, lr_0 = 5.9685e-04
Validation rmse = 0.071307
Validation r2 = 0.949601
Validation mse = 0.005085
Epoch 14
Loss = 1.1088e-01, PNorm = 44.0300, GNorm = 0.5881, lr_0 = 5.7889e-04
Validation rmse = 0.127071
Validation r2 = 0.839950
Validation mse = 0.016147
Epoch 15
Loss = 1.0968e-01, PNorm = 44.0454, GNorm = 2.1169, lr_0 = 5.6148e-04
Loss = 1.1050e-01, PNorm = 44.0633, GNorm = 1.2466, lr_0 = 5.4460e-04
Validation rmse = 0.096770
Validation r2 = 0.907181
Validation mse = 0.009364
Epoch 16
Loss = 1.1111e-01, PNorm = 44.0793, GNorm = 1.0690, lr_0 = 5.2822e-04
Validation rmse = 0.079230
Validation r2 = 0.937779
Validation mse = 0.006277
Epoch 17
Loss = 9.6655e-02, PNorm = 44.0966, GNorm = 1.4814, lr_0 = 5.1077e-04
Validation rmse = 0.042406
Validation r2 = 0.982175
Validation mse = 0.001798
Epoch 18
Loss = 1.4452e-01, PNorm = 44.1111, GNorm = 2.2236, lr_0 = 4.9540e-04
Loss = 9.7696e-02, PNorm = 44.1267, GNorm = 1.2701, lr_0 = 4.8050e-04
Validation rmse = 0.143507
Validation r2 = 0.795872
Validation mse = 0.020594
Epoch 19
Loss = 1.0321e-01, PNorm = 44.1437, GNorm = 1.8157, lr_0 = 4.6605e-04
Validation rmse = 0.070480
Validation r2 = 0.950762
Validation mse = 0.004968
Epoch 20
Loss = 1.1492e-01, PNorm = 44.1566, GNorm = 2.6375, lr_0 = 4.5204e-04
Validation rmse = 0.164587
Validation r2 = 0.731496
Validation mse = 0.027089
Epoch 21
Loss = 9.5483e-02, PNorm = 44.1739, GNorm = 0.4867, lr_0 = 4.3710e-04
Loss = 1.1048e-01, PNorm = 44.1883, GNorm = 2.8225, lr_0 = 4.2396e-04
Validation rmse = 0.173033
Validation r2 = 0.703230
Validation mse = 0.029941
Epoch 22
Loss = 9.5593e-02, PNorm = 44.2035, GNorm = 1.0894, lr_0 = 4.1120e-04
Validation rmse = 0.097563
Validation r2 = 0.905653
Validation mse = 0.009518
Epoch 23
Loss = 8.4544e-02, PNorm = 44.2196, GNorm = 1.7157, lr_0 = 3.9884e-04
Loss = 1.0471e-01, PNorm = 44.2355, GNorm = 1.7273, lr_0 = 3.8684e-04
Validation rmse = 0.162442
Validation r2 = 0.738448
Validation mse = 0.026388
Epoch 24
Loss = 1.0526e-01, PNorm = 44.2503, GNorm = 2.5251, lr_0 = 3.7521e-04
Validation rmse = 0.124080
Validation r2 = 0.847397
Validation mse = 0.015396
Epoch 25
Loss = 9.8963e-02, PNorm = 44.2632, GNorm = 0.5581, lr_0 = 3.6392e-04
Validation rmse = 0.148497
Validation r2 = 0.781428
Validation mse = 0.022051
Epoch 26
Loss = 7.9341e-02, PNorm = 44.2784, GNorm = 0.4967, lr_0 = 3.5190e-04
Loss = 9.1483e-02, PNorm = 44.2899, GNorm = 0.6619, lr_0 = 3.4132e-04
Validation rmse = 0.090513
Validation r2 = 0.918795
Validation mse = 0.008193
Epoch 27
Loss = 8.4982e-02, PNorm = 44.3013, GNorm = 1.5117, lr_0 = 3.3105e-04
Validation rmse = 0.102956
Validation r2 = 0.894934
Validation mse = 0.010600
Epoch 28
Loss = 7.7068e-02, PNorm = 44.3126, GNorm = 1.2018, lr_0 = 3.2109e-04
Validation rmse = 0.166356
Validation r2 = 0.725694
Validation mse = 0.027674
Epoch 29
Loss = 5.6789e-02, PNorm = 44.3247, GNorm = 1.0742, lr_0 = 3.1144e-04
Loss = 8.9396e-02, PNorm = 44.3341, GNorm = 1.7234, lr_0 = 3.0207e-04
Validation rmse = 0.081720
Validation r2 = 0.933806
Validation mse = 0.006678
Epoch 30
Loss = 9.2070e-02, PNorm = 44.3478, GNorm = 0.5853, lr_0 = 2.9209e-04
Validation rmse = 0.154521
Validation r2 = 0.763334
Validation mse = 0.023877
Epoch 31
Loss = 5.5637e-02, PNorm = 44.3590, GNorm = 1.5741, lr_0 = 2.8331e-04
Loss = 8.5853e-02, PNorm = 44.3686, GNorm = 3.5677, lr_0 = 2.7478e-04
Validation rmse = 0.146372
Validation r2 = 0.787639
Validation mse = 0.021425
Epoch 32
Loss = 8.2680e-02, PNorm = 44.3800, GNorm = 1.7482, lr_0 = 2.6652e-04
Validation rmse = 0.111683
Validation r2 = 0.876366
Validation mse = 0.012473
Epoch 33
Loss = 8.1978e-02, PNorm = 44.3900, GNorm = 0.7753, lr_0 = 2.5850e-04
Validation rmse = 0.133539
Validation r2 = 0.823243
Validation mse = 0.017833
Epoch 34
Loss = 6.6303e-02, PNorm = 44.4021, GNorm = 4.0958, lr_0 = 2.4996e-04
Loss = 7.9690e-02, PNorm = 44.4115, GNorm = 1.4718, lr_0 = 2.4245e-04
Validation rmse = 0.125817
Validation r2 = 0.843095
Validation mse = 0.015830
Epoch 35
Loss = 7.2342e-02, PNorm = 44.4210, GNorm = 0.4758, lr_0 = 2.3515e-04
Validation rmse = 0.146040
Validation r2 = 0.788601
Validation mse = 0.021328
Epoch 36
Loss = 7.0669e-02, PNorm = 44.4299, GNorm = 1.4810, lr_0 = 2.2808e-04
Validation rmse = 0.131759
Validation r2 = 0.827924
Validation mse = 0.017360
Epoch 37
Loss = 7.2852e-02, PNorm = 44.4393, GNorm = 0.6087, lr_0 = 2.2122e-04
Loss = 6.7605e-02, PNorm = 44.4481, GNorm = 1.0998, lr_0 = 2.1457e-04
Validation rmse = 0.157543
Validation r2 = 0.753987
Validation mse = 0.024820
Epoch 38
Loss = 6.4105e-02, PNorm = 44.4571, GNorm = 0.8024, lr_0 = 2.0748e-04
Validation rmse = 0.108415
Validation r2 = 0.883497
Validation mse = 0.011754
Epoch 39
Loss = 5.4877e-02, PNorm = 44.4656, GNorm = 1.7306, lr_0 = 2.0124e-04
Loss = 8.5810e-02, PNorm = 44.4734, GNorm = 4.0795, lr_0 = 1.9519e-04
Validation rmse = 0.147213
Validation r2 = 0.785191
Validation mse = 0.021672
Epoch 40
Loss = 7.4982e-02, PNorm = 44.4836, GNorm = 0.7266, lr_0 = 1.8932e-04
Validation rmse = 0.146264
Validation r2 = 0.787953
Validation mse = 0.021393
Epoch 41
Loss = 6.8016e-02, PNorm = 44.4912, GNorm = 0.5747, lr_0 = 1.8362e-04
Validation rmse = 0.115912
Validation r2 = 0.866827
Validation mse = 0.013436
Epoch 42
Loss = 6.0854e-02, PNorm = 44.4994, GNorm = 1.3336, lr_0 = 1.7756e-04
Loss = 7.0048e-02, PNorm = 44.5069, GNorm = 0.5715, lr_0 = 1.7222e-04
Validation rmse = 0.177669
Validation r2 = 0.687117
Validation mse = 0.031566
Epoch 43
Loss = 6.9754e-02, PNorm = 44.5146, GNorm = 0.6234, lr_0 = 1.6704e-04
Validation rmse = 0.145637
Validation r2 = 0.789767
Validation mse = 0.021210
Epoch 44
Loss = 6.8385e-02, PNorm = 44.5220, GNorm = 1.1277, lr_0 = 1.6201e-04
Validation rmse = 0.135070
Validation r2 = 0.819167
Validation mse = 0.018244
Epoch 45
Loss = 5.2381e-02, PNorm = 44.5287, GNorm = 0.4740, lr_0 = 1.5714e-04
Loss = 6.5103e-02, PNorm = 44.5347, GNorm = 1.1490, lr_0 = 1.5241e-04
Validation rmse = 0.128442
Validation r2 = 0.836478
Validation mse = 0.016497
Epoch 46
Loss = 6.2587e-02, PNorm = 44.5406, GNorm = 0.4326, lr_0 = 1.4738e-04
Validation rmse = 0.143717
Validation r2 = 0.795274
Validation mse = 0.020654
Epoch 47
Loss = 5.7900e-02, PNorm = 44.5468, GNorm = 0.4974, lr_0 = 1.4295e-04
Loss = 5.7029e-02, PNorm = 44.5527, GNorm = 1.0244, lr_0 = 1.3865e-04
Validation rmse = 0.148585
Validation r2 = 0.781170
Validation mse = 0.022077
Epoch 48
Loss = 6.1974e-02, PNorm = 44.5593, GNorm = 0.7416, lr_0 = 1.3448e-04
Validation rmse = 0.136105
Validation r2 = 0.816386
Validation mse = 0.018524
Epoch 49
Loss = 6.2546e-02, PNorm = 44.5645, GNorm = 0.7628, lr_0 = 1.3043e-04
Validation rmse = 0.146390
Validation r2 = 0.787585
Validation mse = 0.021430
Epoch 50
Loss = 5.4349e-02, PNorm = 44.5699, GNorm = 1.3041, lr_0 = 1.2651e-04
Loss = 5.6890e-02, PNorm = 44.5745, GNorm = 0.8400, lr_0 = 1.2270e-04
Validation rmse = 0.131772
Validation r2 = 0.827889
Validation mse = 0.017364
Epoch 51
Loss = 5.3932e-02, PNorm = 44.5808, GNorm = 1.4359, lr_0 = 1.1865e-04
Validation rmse = 0.158510
Validation r2 = 0.750959
Validation mse = 0.025125
Epoch 52
Loss = 5.7996e-02, PNorm = 44.5860, GNorm = 1.5469, lr_0 = 1.1508e-04
Validation rmse = 0.130831
Validation r2 = 0.830339
Validation mse = 0.017117
Epoch 53
Loss = 6.3243e-02, PNorm = 44.5913, GNorm = 1.3473, lr_0 = 1.1162e-04
Loss = 5.4379e-02, PNorm = 44.5957, GNorm = 0.8811, lr_0 = 1.0826e-04
Validation rmse = 0.138205
Validation r2 = 0.810676
Validation mse = 0.019101
Epoch 54
Loss = 5.3884e-02, PNorm = 44.6002, GNorm = 0.7421, lr_0 = 1.0501e-04
Validation rmse = 0.137004
Validation r2 = 0.813952
Validation mse = 0.018770
Epoch 55
Loss = 4.4191e-02, PNorm = 44.6047, GNorm = 0.6304, lr_0 = 1.0154e-04
Loss = 5.4735e-02, PNorm = 44.6092, GNorm = 0.6392, lr_0 = 1.0000e-04
Validation rmse = 0.148342
Validation r2 = 0.781885
Validation mse = 0.022005
Epoch 56
Loss = 5.1379e-02, PNorm = 44.6136, GNorm = 0.7882, lr_0 = 1.0000e-04
Validation rmse = 0.151226
Validation r2 = 0.773321
Validation mse = 0.022869
Epoch 57
Loss = 5.4382e-02, PNorm = 44.6185, GNorm = 0.9259, lr_0 = 1.0000e-04
Validation rmse = 0.134751
Validation r2 = 0.820020
Validation mse = 0.018158
Epoch 58
Loss = 5.4470e-02, PNorm = 44.6225, GNorm = 0.9170, lr_0 = 1.0000e-04
Loss = 5.1103e-02, PNorm = 44.6266, GNorm = 0.6780, lr_0 = 1.0000e-04
Validation rmse = 0.157258
Validation r2 = 0.754876
Validation mse = 0.024730
Epoch 59
Loss = 5.4396e-02, PNorm = 44.6320, GNorm = 0.6306, lr_0 = 1.0000e-04
Validation rmse = 0.150333
Validation r2 = 0.775988
Validation mse = 0.022600
Model 0 best validation rmse = 0.042406 on epoch 17
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.136103
Model 0 test r2 = 0.701450
Model 0 test mse = 0.018524
Ensemble test rmse = 0.136103
Ensemble test r2 = 0.701450
Ensemble test mse = 0.018524
10-fold cross validation
	Seed 0 ==> test rmse = 0.161248
	Seed 0 ==> test r2 = 0.580949
	Seed 0 ==> test mse = 0.026001
	Seed 1 ==> test rmse = 0.155825
	Seed 1 ==> test r2 = 0.608661
	Seed 1 ==> test mse = 0.024281
	Seed 2 ==> test rmse = 0.141860
	Seed 2 ==> test r2 = 0.675659
	Seed 2 ==> test mse = 0.020124
	Seed 3 ==> test rmse = 0.182387
	Seed 3 ==> test r2 = 0.463877
	Seed 3 ==> test mse = 0.033265
	Seed 4 ==> test rmse = 0.166970
	Seed 4 ==> test r2 = 0.550677
	Seed 4 ==> test mse = 0.027879
	Seed 5 ==> test rmse = 0.178065
	Seed 5 ==> test r2 = 0.488983
	Seed 5 ==> test mse = 0.031707
	Seed 6 ==> test rmse = 0.143185
	Seed 6 ==> test r2 = 0.669572
	Seed 6 ==> test mse = 0.020502
	Seed 7 ==> test rmse = 0.188587
	Seed 7 ==> test r2 = 0.426804
	Seed 7 ==> test mse = 0.035565
	Seed 8 ==> test rmse = 0.162608
	Seed 8 ==> test r2 = 0.573850
	Seed 8 ==> test mse = 0.026441
	Seed 9 ==> test rmse = 0.136103
	Seed 9 ==> test r2 = 0.701450
	Seed 9 ==> test mse = 0.018524
Overall test rmse = 0.161684 +/- 0.016952
Overall test r2 = 0.574048 +/- 0.088616
Overall test mse = 0.026429 +/- 0.005498
Elapsed time = 0:05:38
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-05d85262-3219-459a-86b2-5360cba4da72.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/EtOH_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2', 'mse'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2', 'mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/EtOH_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/EtOH_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 976 | train size = 966 | val size = 10 | test size = 56
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.6864e-01, PNorm = 43.2628, GNorm = 6.5036, lr_0 = 3.6053e-04
Validation rmse = 0.244020
Validation r2 = 0.352465
Validation mse = 0.059546
Epoch 1
Loss = 6.1296e-01, PNorm = 43.2874, GNorm = 1.2816, lr_0 = 6.2105e-04
Loss = 6.5966e-01, PNorm = 43.3310, GNorm = 0.9923, lr_0 = 8.5789e-04
Validation rmse = 0.331899
Validation r2 = -0.197913
Validation mse = 0.110157
Epoch 2
Loss = 7.2063e-01, PNorm = 43.4087, GNorm = 6.5790, lr_0 = 9.8961e-04
Loss = 6.3369e-01, PNorm = 43.4928, GNorm = 5.1945, lr_0 = 9.6914e-04
Validation rmse = 0.227522
Validation r2 = 0.437062
Validation mse = 0.051766
Epoch 3
Loss = 2.8827e-01, PNorm = 43.5821, GNorm = 0.7033, lr_0 = 9.4712e-04
Loss = 3.0628e-01, PNorm = 43.6598, GNorm = 1.6234, lr_0 = 9.2754e-04
Validation rmse = 0.243854
Validation r2 = 0.353342
Validation mse = 0.059465
Epoch 4
Loss = 2.6430e-01, PNorm = 43.7236, GNorm = 0.7669, lr_0 = 9.0836e-04
Loss = 2.4291e-01, PNorm = 43.7809, GNorm = 4.9215, lr_0 = 8.8958e-04
Validation rmse = 0.202118
Validation r2 = 0.555752
Validation mse = 0.040852
Epoch 5
Loss = 1.6938e-01, PNorm = 43.8305, GNorm = 1.3826, lr_0 = 8.6936e-04
Loss = 2.0492e-01, PNorm = 43.8698, GNorm = 5.0357, lr_0 = 8.5139e-04
Validation rmse = 0.220018
Validation r2 = 0.473583
Validation mse = 0.048408
Epoch 6
Loss = 1.9631e-01, PNorm = 43.9086, GNorm = 0.6650, lr_0 = 8.3204e-04
Loss = 2.0612e-01, PNorm = 43.9462, GNorm = 2.3684, lr_0 = 8.1484e-04
Validation rmse = 0.221342
Validation r2 = 0.467226
Validation mse = 0.048992
Epoch 7
Loss = 1.8700e-01, PNorm = 43.9847, GNorm = 0.8257, lr_0 = 7.9799e-04
Loss = 1.5107e-01, PNorm = 44.0183, GNorm = 2.2897, lr_0 = 7.8149e-04
Validation rmse = 0.203967
Validation r2 = 0.547590
Validation mse = 0.041602
Epoch 8
Loss = 1.9319e-01, PNorm = 44.0521, GNorm = 3.6482, lr_0 = 7.6373e-04
Loss = 1.5624e-01, PNorm = 44.0890, GNorm = 1.8682, lr_0 = 7.4794e-04
Validation rmse = 0.181987
Validation r2 = 0.639842
Validation mse = 0.033119
Epoch 9
Loss = 1.3265e-01, PNorm = 44.1161, GNorm = 3.5820, lr_0 = 7.3094e-04
Loss = 1.4720e-01, PNorm = 44.1388, GNorm = 2.5729, lr_0 = 7.1583e-04
Validation rmse = 0.176029
Validation r2 = 0.663035
Validation mse = 0.030986
Epoch 10
Loss = 1.1433e-01, PNorm = 44.1583, GNorm = 0.6196, lr_0 = 7.0103e-04
Loss = 1.3220e-01, PNorm = 44.1755, GNorm = 1.9666, lr_0 = 6.8653e-04
Validation rmse = 0.167026
Validation r2 = 0.696624
Validation mse = 0.027898
Epoch 11
Loss = 1.2451e-01, PNorm = 44.1971, GNorm = 2.6945, lr_0 = 6.7093e-04
Loss = 1.3559e-01, PNorm = 44.2173, GNorm = 3.1331, lr_0 = 6.5706e-04
Validation rmse = 0.162530
Validation r2 = 0.712737
Validation mse = 0.026416
Epoch 12
Loss = 1.2389e-01, PNorm = 44.2408, GNorm = 2.1436, lr_0 = 6.4213e-04
Loss = 1.2869e-01, PNorm = 44.2608, GNorm = 0.8079, lr_0 = 6.2885e-04
Validation rmse = 0.168849
Validation r2 = 0.689963
Validation mse = 0.028510
Epoch 13
Loss = 1.1726e-01, PNorm = 44.2797, GNorm = 2.4671, lr_0 = 6.1585e-04
Loss = 1.1752e-01, PNorm = 44.2982, GNorm = 0.7067, lr_0 = 6.0311e-04
Loss = 9.9903e-02, PNorm = 44.3005, GNorm = 1.5622, lr_0 = 6.0185e-04
Validation rmse = 0.156850
Validation r2 = 0.732465
Validation mse = 0.024602
Epoch 14
Loss = 1.0324e-01, PNorm = 44.3214, GNorm = 0.5565, lr_0 = 5.8941e-04
Validation rmse = 0.159300
Validation r2 = 0.724041
Validation mse = 0.025376
Epoch 15
Loss = 1.3584e-01, PNorm = 44.3396, GNorm = 0.9310, lr_0 = 5.7602e-04
Loss = 1.0003e-01, PNorm = 44.3553, GNorm = 0.7218, lr_0 = 5.6411e-04
Validation rmse = 0.153009
Validation r2 = 0.745407
Validation mse = 0.023412
Epoch 16
Loss = 1.2834e-01, PNorm = 44.3720, GNorm = 2.5389, lr_0 = 5.5244e-04
Loss = 1.1642e-01, PNorm = 44.3893, GNorm = 3.0683, lr_0 = 5.4102e-04
Validation rmse = 0.183446
Validation r2 = 0.634045
Validation mse = 0.033652
Epoch 17
Loss = 9.2824e-02, PNorm = 44.4086, GNorm = 1.0722, lr_0 = 5.2873e-04
Loss = 1.0161e-01, PNorm = 44.4203, GNorm = 0.6043, lr_0 = 5.1779e-04
Validation rmse = 0.157682
Validation r2 = 0.729617
Validation mse = 0.024864
Epoch 18
Loss = 7.4078e-02, PNorm = 44.4365, GNorm = 1.6620, lr_0 = 5.0603e-04
Loss = 1.0427e-01, PNorm = 44.4478, GNorm = 1.4205, lr_0 = 4.9556e-04
Validation rmse = 0.156236
Validation r2 = 0.734554
Validation mse = 0.024410
Epoch 19
Loss = 9.3348e-02, PNorm = 44.4621, GNorm = 0.8145, lr_0 = 4.8532e-04
Loss = 9.9296e-02, PNorm = 44.4787, GNorm = 0.6292, lr_0 = 4.7528e-04
Validation rmse = 0.162115
Validation r2 = 0.714200
Validation mse = 0.026281
Epoch 20
Loss = 9.1130e-02, PNorm = 44.4928, GNorm = 0.7418, lr_0 = 4.6448e-04
Loss = 9.1936e-02, PNorm = 44.5048, GNorm = 1.4602, lr_0 = 4.5488e-04
Validation rmse = 0.164425
Validation r2 = 0.705997
Validation mse = 0.027036
Epoch 21
Loss = 8.5194e-02, PNorm = 44.5215, GNorm = 0.7755, lr_0 = 4.4454e-04
Loss = 8.1002e-02, PNorm = 44.5339, GNorm = 0.6691, lr_0 = 4.3535e-04
Validation rmse = 0.172964
Validation r2 = 0.674670
Validation mse = 0.029917
Epoch 22
Loss = 9.2793e-02, PNorm = 44.5477, GNorm = 1.1272, lr_0 = 4.2635e-04
Loss = 9.1166e-02, PNorm = 44.5615, GNorm = 2.4878, lr_0 = 4.1753e-04
Validation rmse = 0.166967
Validation r2 = 0.696839
Validation mse = 0.027878
Epoch 23
Loss = 8.3831e-02, PNorm = 44.5800, GNorm = 2.6861, lr_0 = 4.0804e-04
Loss = 9.7129e-02, PNorm = 44.5947, GNorm = 0.5734, lr_0 = 3.9961e-04
Validation rmse = 0.167537
Validation r2 = 0.694764
Validation mse = 0.028069
Epoch 24
Loss = 8.3569e-02, PNorm = 44.6093, GNorm = 0.5476, lr_0 = 3.9053e-04
Loss = 8.4680e-02, PNorm = 44.6195, GNorm = 1.3736, lr_0 = 3.8245e-04
Validation rmse = 0.179778
Validation r2 = 0.648531
Validation mse = 0.032320
Epoch 25
Loss = 7.7740e-02, PNorm = 44.6293, GNorm = 1.0005, lr_0 = 3.7454e-04
Loss = 9.6534e-02, PNorm = 44.6409, GNorm = 2.9586, lr_0 = 3.6680e-04
Validation rmse = 0.155860
Validation r2 = 0.735830
Validation mse = 0.024292
Epoch 26
Loss = 8.2503e-02, PNorm = 44.6549, GNorm = 1.2348, lr_0 = 3.5846e-04
Loss = 8.0604e-02, PNorm = 44.6673, GNorm = 0.8069, lr_0 = 3.5105e-04
Validation rmse = 0.168411
Validation r2 = 0.691573
Validation mse = 0.028362
Epoch 27
Loss = 9.3708e-02, PNorm = 44.6833, GNorm = 2.4425, lr_0 = 3.4308e-04
Loss = 9.2675e-02, PNorm = 44.6963, GNorm = 2.5843, lr_0 = 3.3598e-04
Loss = 1.0180e-01, PNorm = 44.6972, GNorm = 3.6546, lr_0 = 3.3528e-04
Validation rmse = 0.154821
Validation r2 = 0.739341
Validation mse = 0.023970
Epoch 28
Loss = 9.6244e-02, PNorm = 44.7093, GNorm = 3.4162, lr_0 = 3.2835e-04
Loss = 8.6023e-02, PNorm = 44.7227, GNorm = 2.6397, lr_0 = 3.2156e-04
Validation rmse = 0.167802
Validation r2 = 0.693798
Validation mse = 0.028157
Epoch 29
Loss = 7.4887e-02, PNorm = 44.7351, GNorm = 1.3098, lr_0 = 3.1491e-04
Validation rmse = 0.149216
Validation r2 = 0.757873
Validation mse = 0.022265
Epoch 30
Loss = 7.0450e-02, PNorm = 44.7472, GNorm = 0.5202, lr_0 = 3.0775e-04
Loss = 7.7624e-02, PNorm = 44.7563, GNorm = 0.8575, lr_0 = 3.0139e-04
Validation rmse = 0.156610
Validation r2 = 0.733283
Validation mse = 0.024527
Epoch 31
Loss = 5.7771e-02, PNorm = 44.7665, GNorm = 0.7312, lr_0 = 2.9454e-04
Loss = 7.5574e-02, PNorm = 44.7787, GNorm = 0.8899, lr_0 = 2.8845e-04
Validation rmse = 0.151547
Validation r2 = 0.750250
Validation mse = 0.022966
Epoch 32
Loss = 8.3738e-02, PNorm = 44.7872, GNorm = 1.5218, lr_0 = 2.8249e-04
Loss = 7.4861e-02, PNorm = 44.7968, GNorm = 0.5275, lr_0 = 2.7665e-04
Validation rmse = 0.153238
Validation r2 = 0.744643
Validation mse = 0.023482
Epoch 33
Loss = 7.2283e-02, PNorm = 44.8073, GNorm = 0.5894, lr_0 = 2.7036e-04
Loss = 7.1820e-02, PNorm = 44.8162, GNorm = 1.6969, lr_0 = 2.6477e-04
Validation rmse = 0.170147
Validation r2 = 0.685181
Validation mse = 0.028950
Epoch 34
Loss = 7.2389e-02, PNorm = 44.8262, GNorm = 1.1577, lr_0 = 2.5875e-04
Loss = 6.4451e-02, PNorm = 44.8352, GNorm = 0.6793, lr_0 = 2.5340e-04
Validation rmse = 0.158414
Validation r2 = 0.727103
Validation mse = 0.025095
Epoch 35
Loss = 6.2391e-02, PNorm = 44.8425, GNorm = 0.7248, lr_0 = 2.4816e-04
Loss = 7.2919e-02, PNorm = 44.8519, GNorm = 0.8522, lr_0 = 2.4303e-04
Validation rmse = 0.157353
Validation r2 = 0.730745
Validation mse = 0.024760
Epoch 36
Loss = 6.8519e-02, PNorm = 44.8605, GNorm = 1.8750, lr_0 = 2.3751e-04
Loss = 6.4489e-02, PNorm = 44.8688, GNorm = 0.7160, lr_0 = 2.3260e-04
Validation rmse = 0.163560
Validation r2 = 0.709085
Validation mse = 0.026752
Epoch 37
Loss = 6.4371e-02, PNorm = 44.8791, GNorm = 0.6104, lr_0 = 2.2731e-04
Loss = 5.9577e-02, PNorm = 44.8870, GNorm = 0.8419, lr_0 = 2.2261e-04
Validation rmse = 0.160742
Validation r2 = 0.719021
Validation mse = 0.025838
Epoch 38
Loss = 5.0789e-02, PNorm = 44.8940, GNorm = 0.9592, lr_0 = 2.1801e-04
Loss = 7.2199e-02, PNorm = 44.9030, GNorm = 1.0684, lr_0 = 2.1350e-04
Validation rmse = 0.150950
Validation r2 = 0.752211
Validation mse = 0.022786
Epoch 39
Loss = 5.8725e-02, PNorm = 44.9118, GNorm = 0.7667, lr_0 = 2.0865e-04
Loss = 6.7483e-02, PNorm = 44.9197, GNorm = 1.3760, lr_0 = 2.0434e-04
Validation rmse = 0.159181
Validation r2 = 0.724454
Validation mse = 0.025338
Epoch 40
Loss = 5.7627e-02, PNorm = 44.9268, GNorm = 0.8611, lr_0 = 1.9969e-04
Loss = 6.0343e-02, PNorm = 44.9341, GNorm = 0.6639, lr_0 = 1.9556e-04
Validation rmse = 0.178912
Validation r2 = 0.651908
Validation mse = 0.032010
Epoch 41
Loss = 6.1320e-02, PNorm = 44.9418, GNorm = 1.1546, lr_0 = 1.9152e-04
Loss = 6.1006e-02, PNorm = 44.9488, GNorm = 0.4658, lr_0 = 1.8756e-04
Validation rmse = 0.160446
Validation r2 = 0.720057
Validation mse = 0.025743
Epoch 42
Loss = 6.0547e-02, PNorm = 44.9568, GNorm = 0.9788, lr_0 = 1.8330e-04
Loss = 5.3995e-02, PNorm = 44.9639, GNorm = 0.8932, lr_0 = 1.7951e-04
Loss = 6.8942e-02, PNorm = 44.9647, GNorm = 1.6416, lr_0 = 1.7913e-04
Validation rmse = 0.155583
Validation r2 = 0.736769
Validation mse = 0.024206
Epoch 43
Loss = 5.7032e-02, PNorm = 44.9718, GNorm = 1.5690, lr_0 = 1.7543e-04
Loss = 6.2743e-02, PNorm = 44.9798, GNorm = 3.8184, lr_0 = 1.7180e-04
Validation rmse = 0.169285
Validation r2 = 0.688363
Validation mse = 0.028657
Epoch 44
Loss = 7.0019e-02, PNorm = 44.9859, GNorm = 1.2411, lr_0 = 1.6825e-04
Validation rmse = 0.164131
Validation r2 = 0.707050
Validation mse = 0.026939
Epoch 45
Loss = 5.9090e-02, PNorm = 44.9932, GNorm = 1.0494, lr_0 = 1.6443e-04
Loss = 6.1321e-02, PNorm = 44.9989, GNorm = 1.4177, lr_0 = 1.6103e-04
Validation rmse = 0.158963
Validation r2 = 0.725207
Validation mse = 0.025269
Epoch 46
Loss = 6.5478e-02, PNorm = 45.0069, GNorm = 0.8592, lr_0 = 1.5737e-04
Loss = 5.6476e-02, PNorm = 45.0131, GNorm = 0.6624, lr_0 = 1.5411e-04
Validation rmse = 0.157021
Validation r2 = 0.731879
Validation mse = 0.024656
Epoch 47
Loss = 7.1916e-02, PNorm = 45.0194, GNorm = 1.0296, lr_0 = 1.5093e-04
Loss = 5.0855e-02, PNorm = 45.0247, GNorm = 0.7531, lr_0 = 1.4781e-04
Validation rmse = 0.150215
Validation r2 = 0.754620
Validation mse = 0.022564
Epoch 48
Loss = 4.8866e-02, PNorm = 45.0304, GNorm = 2.3037, lr_0 = 1.4445e-04
Loss = 5.5294e-02, PNorm = 45.0358, GNorm = 0.8808, lr_0 = 1.4146e-04
Validation rmse = 0.154066
Validation r2 = 0.741876
Validation mse = 0.023736
Epoch 49
Loss = 7.0334e-02, PNorm = 45.0422, GNorm = 1.4232, lr_0 = 1.3825e-04
Loss = 5.4597e-02, PNorm = 45.0485, GNorm = 1.3526, lr_0 = 1.3539e-04
Validation rmse = 0.166137
Validation r2 = 0.699843
Validation mse = 0.027602
Epoch 50
Loss = 4.5591e-02, PNorm = 45.0528, GNorm = 0.5760, lr_0 = 1.3259e-04
Loss = 5.2707e-02, PNorm = 45.0571, GNorm = 1.3051, lr_0 = 1.2985e-04
Validation rmse = 0.157511
Validation r2 = 0.730203
Validation mse = 0.024810
Epoch 51
Loss = 4.4201e-02, PNorm = 45.0627, GNorm = 1.0405, lr_0 = 1.2690e-04
Loss = 4.8570e-02, PNorm = 45.0673, GNorm = 0.5530, lr_0 = 1.2427e-04
Validation rmse = 0.158945
Validation r2 = 0.725270
Validation mse = 0.025263
Epoch 52
Loss = 4.6750e-02, PNorm = 45.0730, GNorm = 0.8431, lr_0 = 1.2145e-04
Loss = 5.0031e-02, PNorm = 45.0767, GNorm = 0.5292, lr_0 = 1.1894e-04
Validation rmse = 0.156794
Validation r2 = 0.732653
Validation mse = 0.024584
Epoch 53
Loss = 4.4355e-02, PNorm = 45.0812, GNorm = 0.8165, lr_0 = 1.1623e-04
Loss = 5.6065e-02, PNorm = 45.0856, GNorm = 0.6325, lr_0 = 1.1383e-04
Validation rmse = 0.158786
Validation r2 = 0.725819
Validation mse = 0.025213
Epoch 54
Loss = 4.4490e-02, PNorm = 45.0893, GNorm = 0.3978, lr_0 = 1.1148e-04
Loss = 5.2774e-02, PNorm = 45.0934, GNorm = 0.7211, lr_0 = 1.0917e-04
Validation rmse = 0.155934
Validation r2 = 0.735580
Validation mse = 0.024315
Epoch 55
Loss = 5.6519e-02, PNorm = 45.0979, GNorm = 1.4720, lr_0 = 1.0669e-04
Loss = 4.4386e-02, PNorm = 45.1016, GNorm = 0.7457, lr_0 = 1.0449e-04
Validation rmse = 0.165127
Validation r2 = 0.703482
Validation mse = 0.027267
Epoch 56
Loss = 4.4063e-02, PNorm = 45.1066, GNorm = 0.8868, lr_0 = 1.0211e-04
Loss = 5.0183e-02, PNorm = 45.1102, GNorm = 0.4707, lr_0 = 1.0000e-04
Validation rmse = 0.163877
Validation r2 = 0.707955
Validation mse = 0.026856
Epoch 57
Loss = 3.8821e-02, PNorm = 45.1145, GNorm = 0.6737, lr_0 = 1.0000e-04
Loss = 5.4637e-02, PNorm = 45.1174, GNorm = 1.6793, lr_0 = 1.0000e-04
Loss = 2.3868e-02, PNorm = 45.1177, GNorm = 1.0235, lr_0 = 1.0000e-04
Validation rmse = 0.158022
Validation r2 = 0.728450
Validation mse = 0.024971
Epoch 58
Loss = 4.9905e-02, PNorm = 45.1209, GNorm = 0.9638, lr_0 = 1.0000e-04
Validation rmse = 0.167569
Validation r2 = 0.694649
Validation mse = 0.028079
Epoch 59
Loss = 4.4484e-02, PNorm = 45.1248, GNorm = 1.1933, lr_0 = 1.0000e-04
Loss = 4.5606e-02, PNorm = 45.1288, GNorm = 0.8166, lr_0 = 1.0000e-04
Validation rmse = 0.159812
Validation r2 = 0.722264
Validation mse = 0.025540
Model 0 best validation rmse = 0.149216 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.136423
Model 0 test r2 = 0.761288
Model 0 test mse = 0.018611
Ensemble test rmse = 0.136423
Ensemble test r2 = 0.761288
Ensemble test mse = 0.018611
Fold 1
Splitting data with seed 1
Total size = 976 | train size = 966 | val size = 10 | test size = 56
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 1.0434e+00, PNorm = 43.2607, GNorm = 2.8665, lr_0 = 3.6053e-04
Validation rmse = 0.289179
Validation r2 = 0.138266
Validation mse = 0.083625
Epoch 1
Loss = 8.5874e-01, PNorm = 43.2789, GNorm = 4.1109, lr_0 = 6.2105e-04
Loss = 7.2203e-01, PNorm = 43.3238, GNorm = 9.5396, lr_0 = 8.5789e-04
Validation rmse = 0.202205
Validation r2 = 0.578672
Validation mse = 0.040887
Epoch 2
Loss = 3.0611e-01, PNorm = 43.4013, GNorm = 2.1387, lr_0 = 9.8961e-04
Loss = 5.4995e-01, PNorm = 43.4858, GNorm = 1.7829, lr_0 = 9.6914e-04
Validation rmse = 0.149706
Validation r2 = 0.769050
Validation mse = 0.022412
Epoch 3
Loss = 3.7651e-01, PNorm = 43.5739, GNorm = 2.0774, lr_0 = 9.4712e-04
Loss = 3.3113e-01, PNorm = 43.6399, GNorm = 1.1240, lr_0 = 9.2754e-04
Validation rmse = 0.159437
Validation r2 = 0.738050
Validation mse = 0.025420
Epoch 4
Loss = 2.4734e-01, PNorm = 43.6955, GNorm = 1.6601, lr_0 = 9.0836e-04
Loss = 2.5597e-01, PNorm = 43.7451, GNorm = 1.0513, lr_0 = 8.8958e-04
Validation rmse = 0.156668
Validation r2 = 0.747072
Validation mse = 0.024545
Epoch 5
Loss = 1.8536e-01, PNorm = 43.7970, GNorm = 2.4126, lr_0 = 8.6936e-04
Loss = 2.2076e-01, PNorm = 43.8285, GNorm = 2.2773, lr_0 = 8.5139e-04
Validation rmse = 0.143917
Validation r2 = 0.786568
Validation mse = 0.020712
Epoch 6
Loss = 1.7192e-01, PNorm = 43.8708, GNorm = 2.9036, lr_0 = 8.3204e-04
Loss = 2.1901e-01, PNorm = 43.8971, GNorm = 6.1116, lr_0 = 8.1484e-04
Validation rmse = 0.177292
Validation r2 = 0.676097
Validation mse = 0.031432
Epoch 7
Loss = 2.1838e-01, PNorm = 43.9280, GNorm = 7.7239, lr_0 = 7.9799e-04
Loss = 1.9516e-01, PNorm = 43.9631, GNorm = 0.8329, lr_0 = 7.8149e-04
Validation rmse = 0.167091
Validation r2 = 0.712295
Validation mse = 0.027920
Epoch 8
Loss = 1.6531e-01, PNorm = 43.9912, GNorm = 5.4477, lr_0 = 7.6373e-04
Loss = 1.6246e-01, PNorm = 44.0172, GNorm = 1.5696, lr_0 = 7.4794e-04
Validation rmse = 0.131299
Validation r2 = 0.822351
Validation mse = 0.017239
Epoch 9
Loss = 1.2572e-01, PNorm = 44.0379, GNorm = 2.4668, lr_0 = 7.3094e-04
Loss = 1.5510e-01, PNorm = 44.0589, GNorm = 2.4098, lr_0 = 7.1583e-04
Validation rmse = 0.148553
Validation r2 = 0.772593
Validation mse = 0.022068
Epoch 10
Loss = 1.5309e-01, PNorm = 44.0829, GNorm = 0.9415, lr_0 = 7.0103e-04
Loss = 1.1327e-01, PNorm = 44.1054, GNorm = 1.4804, lr_0 = 6.8653e-04
Validation rmse = 0.132723
Validation r2 = 0.818477
Validation mse = 0.017615
Epoch 11
Loss = 1.3052e-01, PNorm = 44.1245, GNorm = 2.5030, lr_0 = 6.7093e-04
Loss = 1.2510e-01, PNorm = 44.1449, GNorm = 2.6905, lr_0 = 6.5706e-04
Validation rmse = 0.136887
Validation r2 = 0.806908
Validation mse = 0.018738
Epoch 12
Loss = 1.1538e-01, PNorm = 44.1685, GNorm = 1.5073, lr_0 = 6.4213e-04
Loss = 1.5849e-01, PNorm = 44.1874, GNorm = 0.9838, lr_0 = 6.2885e-04
Validation rmse = 0.148350
Validation r2 = 0.773216
Validation mse = 0.022008
Epoch 13
Loss = 1.7225e-01, PNorm = 44.2143, GNorm = 1.2142, lr_0 = 6.1585e-04
Loss = 1.4526e-01, PNorm = 44.2391, GNorm = 0.5381, lr_0 = 6.0311e-04
Loss = 7.6280e-02, PNorm = 44.2415, GNorm = 1.4711, lr_0 = 6.0185e-04
Validation rmse = 0.154105
Validation r2 = 0.755279
Validation mse = 0.023748
Epoch 14
Loss = 1.3571e-01, PNorm = 44.2642, GNorm = 0.5659, lr_0 = 5.8941e-04
Validation rmse = 0.106301
Validation r2 = 0.883557
Validation mse = 0.011300
Epoch 15
Loss = 1.1896e-01, PNorm = 44.2819, GNorm = 0.8011, lr_0 = 5.7602e-04
Loss = 1.1010e-01, PNorm = 44.2983, GNorm = 2.0681, lr_0 = 5.6411e-04
Validation rmse = 0.167016
Validation r2 = 0.712554
Validation mse = 0.027894
Epoch 16
Loss = 8.8276e-02, PNorm = 44.3157, GNorm = 2.4075, lr_0 = 5.5244e-04
Loss = 1.1453e-01, PNorm = 44.3302, GNorm = 1.4479, lr_0 = 5.4102e-04
Validation rmse = 0.131815
Validation r2 = 0.820951
Validation mse = 0.017375
Epoch 17
Loss = 1.2147e-01, PNorm = 44.3488, GNorm = 1.9483, lr_0 = 5.2873e-04
Loss = 1.1511e-01, PNorm = 44.3638, GNorm = 0.6780, lr_0 = 5.1779e-04
Validation rmse = 0.126622
Validation r2 = 0.834782
Validation mse = 0.016033
Epoch 18
Loss = 8.5926e-02, PNorm = 44.3831, GNorm = 0.7785, lr_0 = 5.0603e-04
Loss = 1.0944e-01, PNorm = 44.3979, GNorm = 1.1027, lr_0 = 4.9556e-04
Validation rmse = 0.134226
Validation r2 = 0.814343
Validation mse = 0.018017
Epoch 19
Loss = 1.1421e-01, PNorm = 44.4129, GNorm = 2.2152, lr_0 = 4.8532e-04
Loss = 9.1774e-02, PNorm = 44.4267, GNorm = 2.3587, lr_0 = 4.7528e-04
Validation rmse = 0.135415
Validation r2 = 0.811040
Validation mse = 0.018337
Epoch 20
Loss = 1.1759e-01, PNorm = 44.4405, GNorm = 0.7804, lr_0 = 4.6448e-04
Loss = 9.3927e-02, PNorm = 44.4535, GNorm = 0.5689, lr_0 = 4.5488e-04
Validation rmse = 0.116921
Validation r2 = 0.859128
Validation mse = 0.013671
Epoch 21
Loss = 8.4734e-02, PNorm = 44.4652, GNorm = 2.5246, lr_0 = 4.4454e-04
Loss = 1.1146e-01, PNorm = 44.4787, GNorm = 1.2045, lr_0 = 4.3535e-04
Validation rmse = 0.134848
Validation r2 = 0.812619
Validation mse = 0.018184
Epoch 22
Loss = 1.0483e-01, PNorm = 44.4877, GNorm = 1.2113, lr_0 = 4.2635e-04
Loss = 9.6112e-02, PNorm = 44.4994, GNorm = 1.6098, lr_0 = 4.1753e-04
Validation rmse = 0.129160
Validation r2 = 0.828092
Validation mse = 0.016682
Epoch 23
Loss = 9.9176e-02, PNorm = 44.5152, GNorm = 1.2103, lr_0 = 4.0804e-04
Loss = 1.0444e-01, PNorm = 44.5282, GNorm = 1.4473, lr_0 = 3.9961e-04
Validation rmse = 0.117147
Validation r2 = 0.858583
Validation mse = 0.013723
Epoch 24
Loss = 1.2572e-01, PNorm = 44.5426, GNorm = 4.2169, lr_0 = 3.9053e-04
Loss = 1.1611e-01, PNorm = 44.5571, GNorm = 2.1797, lr_0 = 3.8245e-04
Validation rmse = 0.146854
Validation r2 = 0.777765
Validation mse = 0.021566
Epoch 25
Loss = 1.0576e-01, PNorm = 44.5723, GNorm = 0.6776, lr_0 = 3.7454e-04
Loss = 9.5255e-02, PNorm = 44.5834, GNorm = 0.9104, lr_0 = 3.6680e-04
Validation rmse = 0.129170
Validation r2 = 0.828066
Validation mse = 0.016685
Epoch 26
Loss = 1.0509e-01, PNorm = 44.6002, GNorm = 0.9243, lr_0 = 3.5846e-04
Loss = 8.6091e-02, PNorm = 44.6118, GNorm = 1.1601, lr_0 = 3.5105e-04
Validation rmse = 0.131947
Validation r2 = 0.820594
Validation mse = 0.017410
Epoch 27
Loss = 8.8644e-02, PNorm = 44.6238, GNorm = 0.4015, lr_0 = 3.4308e-04
Loss = 8.1965e-02, PNorm = 44.6329, GNorm = 1.8087, lr_0 = 3.3598e-04
Loss = 1.3009e-01, PNorm = 44.6334, GNorm = 2.0536, lr_0 = 3.3528e-04
Validation rmse = 0.133604
Validation r2 = 0.816059
Validation mse = 0.017850
Epoch 28
Loss = 9.5953e-02, PNorm = 44.6445, GNorm = 2.2438, lr_0 = 3.2835e-04
Loss = 1.0324e-01, PNorm = 44.6569, GNorm = 2.1517, lr_0 = 3.2156e-04
Validation rmse = 0.123683
Validation r2 = 0.842362
Validation mse = 0.015298
Epoch 29
Loss = 8.2570e-02, PNorm = 44.6710, GNorm = 0.5154, lr_0 = 3.1491e-04
Validation rmse = 0.131070
Validation r2 = 0.822970
Validation mse = 0.017179
Epoch 30
Loss = 9.5305e-02, PNorm = 44.6826, GNorm = 1.2665, lr_0 = 3.0775e-04
Loss = 7.7550e-02, PNorm = 44.6911, GNorm = 0.4996, lr_0 = 3.0139e-04
Validation rmse = 0.123591
Validation r2 = 0.842596
Validation mse = 0.015275
Epoch 31
Loss = 9.4131e-02, PNorm = 44.7019, GNorm = 1.1651, lr_0 = 2.9454e-04
Loss = 8.0160e-02, PNorm = 44.7115, GNorm = 0.7647, lr_0 = 2.8845e-04
Validation rmse = 0.124673
Validation r2 = 0.839828
Validation mse = 0.015543
Epoch 32
Loss = 9.4624e-02, PNorm = 44.7187, GNorm = 1.4038, lr_0 = 2.8249e-04
Loss = 8.2602e-02, PNorm = 44.7279, GNorm = 0.9429, lr_0 = 2.7665e-04
Validation rmse = 0.119399
Validation r2 = 0.853095
Validation mse = 0.014256
Epoch 33
Loss = 6.8582e-02, PNorm = 44.7374, GNorm = 1.3212, lr_0 = 2.7036e-04
Loss = 8.5608e-02, PNorm = 44.7447, GNorm = 0.8798, lr_0 = 2.6477e-04
Validation rmse = 0.136455
Validation r2 = 0.808124
Validation mse = 0.018620
Epoch 34
Loss = 7.2294e-02, PNorm = 44.7565, GNorm = 0.5048, lr_0 = 2.5875e-04
Loss = 8.1796e-02, PNorm = 44.7667, GNorm = 1.9108, lr_0 = 2.5340e-04
Validation rmse = 0.115035
Validation r2 = 0.863637
Validation mse = 0.013233
Epoch 35
Loss = 8.4405e-02, PNorm = 44.7734, GNorm = 0.8041, lr_0 = 2.4816e-04
Loss = 6.3864e-02, PNorm = 44.7795, GNorm = 0.6370, lr_0 = 2.4303e-04
Validation rmse = 0.133511
Validation r2 = 0.816315
Validation mse = 0.017825
Epoch 36
Loss = 7.2170e-02, PNorm = 44.7904, GNorm = 0.5591, lr_0 = 2.3751e-04
Loss = 8.6842e-02, PNorm = 44.8010, GNorm = 1.5273, lr_0 = 2.3260e-04
Validation rmse = 0.123400
Validation r2 = 0.843084
Validation mse = 0.015228
Epoch 37
Loss = 9.3514e-02, PNorm = 44.8116, GNorm = 1.0955, lr_0 = 2.2731e-04
Loss = 7.8822e-02, PNorm = 44.8210, GNorm = 0.3855, lr_0 = 2.2261e-04
Validation rmse = 0.119881
Validation r2 = 0.851906
Validation mse = 0.014371
Epoch 38
Loss = 6.9385e-02, PNorm = 44.8304, GNorm = 0.5988, lr_0 = 2.1801e-04
Loss = 7.4606e-02, PNorm = 44.8395, GNorm = 0.9567, lr_0 = 2.1350e-04
Validation rmse = 0.118810
Validation r2 = 0.854540
Validation mse = 0.014116
Epoch 39
Loss = 7.1501e-02, PNorm = 44.8471, GNorm = 3.0239, lr_0 = 2.0865e-04
Loss = 7.4807e-02, PNorm = 44.8545, GNorm = 1.2762, lr_0 = 2.0434e-04
Validation rmse = 0.114370
Validation r2 = 0.865209
Validation mse = 0.013080
Epoch 40
Loss = 6.7310e-02, PNorm = 44.8634, GNorm = 1.4960, lr_0 = 1.9969e-04
Loss = 7.4944e-02, PNorm = 44.8715, GNorm = 1.0462, lr_0 = 1.9556e-04
Validation rmse = 0.112130
Validation r2 = 0.870437
Validation mse = 0.012573
Epoch 41
Loss = 6.8742e-02, PNorm = 44.8776, GNorm = 0.9505, lr_0 = 1.9152e-04
Loss = 7.1975e-02, PNorm = 44.8857, GNorm = 0.8571, lr_0 = 1.8756e-04
Validation rmse = 0.112936
Validation r2 = 0.868567
Validation mse = 0.012755
Epoch 42
Loss = 5.9170e-02, PNorm = 44.8923, GNorm = 1.2055, lr_0 = 1.8330e-04
Loss = 7.7280e-02, PNorm = 44.8986, GNorm = 0.7141, lr_0 = 1.7951e-04
Loss = 8.6478e-02, PNorm = 44.8995, GNorm = 1.3425, lr_0 = 1.7913e-04
Validation rmse = 0.124126
Validation r2 = 0.841233
Validation mse = 0.015407
Epoch 43
Loss = 6.6795e-02, PNorm = 44.9060, GNorm = 0.7902, lr_0 = 1.7543e-04
Loss = 6.9302e-02, PNorm = 44.9118, GNorm = 1.3094, lr_0 = 1.7180e-04
Validation rmse = 0.113221
Validation r2 = 0.867902
Validation mse = 0.012819
Epoch 44
Loss = 7.0844e-02, PNorm = 44.9184, GNorm = 2.8399, lr_0 = 1.6825e-04
Validation rmse = 0.129286
Validation r2 = 0.827757
Validation mse = 0.016715
Epoch 45
Loss = 1.2224e-01, PNorm = 44.9257, GNorm = 2.9848, lr_0 = 1.6443e-04
Loss = 7.3287e-02, PNorm = 44.9335, GNorm = 1.0098, lr_0 = 1.6103e-04
Validation rmse = 0.109452
Validation r2 = 0.876551
Validation mse = 0.011980
Epoch 46
Loss = 6.6976e-02, PNorm = 44.9410, GNorm = 0.8146, lr_0 = 1.5737e-04
Loss = 6.0074e-02, PNorm = 44.9463, GNorm = 0.6070, lr_0 = 1.5411e-04
Validation rmse = 0.118238
Validation r2 = 0.855937
Validation mse = 0.013980
Epoch 47
Loss = 4.0083e-02, PNorm = 44.9521, GNorm = 1.0539, lr_0 = 1.5093e-04
Loss = 7.6072e-02, PNorm = 44.9576, GNorm = 2.8056, lr_0 = 1.4781e-04
Validation rmse = 0.110342
Validation r2 = 0.874536
Validation mse = 0.012175
Epoch 48
Loss = 5.0262e-02, PNorm = 44.9642, GNorm = 0.7612, lr_0 = 1.4445e-04
Loss = 6.6856e-02, PNorm = 44.9692, GNorm = 0.8150, lr_0 = 1.4146e-04
Validation rmse = 0.114686
Validation r2 = 0.864462
Validation mse = 0.013153
Epoch 49
Loss = 5.0757e-02, PNorm = 44.9758, GNorm = 0.4168, lr_0 = 1.3825e-04
Loss = 6.3477e-02, PNorm = 44.9806, GNorm = 2.7947, lr_0 = 1.3539e-04
Validation rmse = 0.111490
Validation r2 = 0.871911
Validation mse = 0.012430
Epoch 50
Loss = 5.4066e-02, PNorm = 44.9863, GNorm = 0.8815, lr_0 = 1.3259e-04
Loss = 7.0699e-02, PNorm = 44.9913, GNorm = 0.5579, lr_0 = 1.2985e-04
Validation rmse = 0.111311
Validation r2 = 0.872322
Validation mse = 0.012390
Epoch 51
Loss = 5.4565e-02, PNorm = 44.9966, GNorm = 0.6074, lr_0 = 1.2690e-04
Loss = 6.4777e-02, PNorm = 45.0006, GNorm = 0.9561, lr_0 = 1.2427e-04
Validation rmse = 0.112424
Validation r2 = 0.869756
Validation mse = 0.012639
Epoch 52
Loss = 5.8733e-02, PNorm = 45.0076, GNorm = 1.2003, lr_0 = 1.2145e-04
Loss = 6.2253e-02, PNorm = 45.0115, GNorm = 1.3752, lr_0 = 1.1894e-04
Validation rmse = 0.111039
Validation r2 = 0.872946
Validation mse = 0.012330
Epoch 53
Loss = 6.2532e-02, PNorm = 45.0167, GNorm = 0.3351, lr_0 = 1.1623e-04
Loss = 5.3524e-02, PNorm = 45.0209, GNorm = 0.7210, lr_0 = 1.1383e-04
Validation rmse = 0.111446
Validation r2 = 0.872012
Validation mse = 0.012420
Epoch 54
Loss = 6.1267e-02, PNorm = 45.0253, GNorm = 1.4561, lr_0 = 1.1148e-04
Loss = 5.2112e-02, PNorm = 45.0290, GNorm = 0.7674, lr_0 = 1.0917e-04
Validation rmse = 0.104260
Validation r2 = 0.887985
Validation mse = 0.010870
Epoch 55
Loss = 5.4971e-02, PNorm = 45.0341, GNorm = 1.1335, lr_0 = 1.0669e-04
Loss = 6.1258e-02, PNorm = 45.0384, GNorm = 1.2554, lr_0 = 1.0449e-04
Validation rmse = 0.115009
Validation r2 = 0.863699
Validation mse = 0.013227
Epoch 56
Loss = 5.8331e-02, PNorm = 45.0429, GNorm = 0.4939, lr_0 = 1.0211e-04
Loss = 5.2303e-02, PNorm = 45.0472, GNorm = 1.6050, lr_0 = 1.0000e-04
Validation rmse = 0.110860
Validation r2 = 0.873354
Validation mse = 0.012290
Epoch 57
Loss = 4.9895e-02, PNorm = 45.0509, GNorm = 1.3338, lr_0 = 1.0000e-04
Loss = 6.1036e-02, PNorm = 45.0546, GNorm = 0.6386, lr_0 = 1.0000e-04
Loss = 5.3299e-02, PNorm = 45.0551, GNorm = 2.6799, lr_0 = 1.0000e-04
Validation rmse = 0.102594
Validation r2 = 0.891537
Validation mse = 0.010526
Epoch 58
Loss = 4.8507e-02, PNorm = 45.0588, GNorm = 0.8194, lr_0 = 1.0000e-04
Validation rmse = 0.102827
Validation r2 = 0.891044
Validation mse = 0.010573
Epoch 59
Loss = 5.6130e-02, PNorm = 45.0628, GNorm = 1.1064, lr_0 = 1.0000e-04
Loss = 5.1735e-02, PNorm = 45.0666, GNorm = 0.9643, lr_0 = 1.0000e-04
Validation rmse = 0.106372
Validation r2 = 0.883402
Validation mse = 0.011315
Model 0 best validation rmse = 0.102594 on epoch 57
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.150381
Model 0 test r2 = 0.709939
Model 0 test mse = 0.022615
Ensemble test rmse = 0.150381
Ensemble test r2 = 0.709939
Ensemble test mse = 0.022615
Fold 2
Splitting data with seed 2
Total size = 976 | train size = 966 | val size = 10 | test size = 56
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.5572e-01, PNorm = 43.2642, GNorm = 6.8209, lr_0 = 3.6053e-04
Validation rmse = 0.236933
Validation r2 = 0.417047
Validation mse = 0.056137
Epoch 1
Loss = 6.3036e-01, PNorm = 43.2903, GNorm = 7.0289, lr_0 = 6.2105e-04
Loss = 7.0159e-01, PNorm = 43.3254, GNorm = 6.7600, lr_0 = 8.5789e-04
Validation rmse = 0.194165
Validation r2 = 0.608504
Validation mse = 0.037700
Epoch 2
Loss = 5.0230e-01, PNorm = 43.4003, GNorm = 2.5122, lr_0 = 9.8961e-04
Loss = 4.4756e-01, PNorm = 43.4917, GNorm = 0.9319, lr_0 = 9.6914e-04
Validation rmse = 0.137920
Validation r2 = 0.802468
Validation mse = 0.019022
Epoch 3
Loss = 3.2285e-01, PNorm = 43.5758, GNorm = 5.8129, lr_0 = 9.4712e-04
Loss = 3.3593e-01, PNorm = 43.6402, GNorm = 4.0562, lr_0 = 9.2754e-04
Validation rmse = 0.172325
Validation r2 = 0.691626
Validation mse = 0.029696
Epoch 4
Loss = 3.2153e-01, PNorm = 43.6997, GNorm = 2.2099, lr_0 = 9.0836e-04
Loss = 2.6709e-01, PNorm = 43.7545, GNorm = 2.1146, lr_0 = 8.8958e-04
Validation rmse = 0.096113
Validation r2 = 0.904072
Validation mse = 0.009238
Epoch 5
Loss = 2.2648e-01, PNorm = 43.8042, GNorm = 4.3796, lr_0 = 8.6936e-04
Loss = 2.0891e-01, PNorm = 43.8428, GNorm = 3.1906, lr_0 = 8.5139e-04
Validation rmse = 0.114501
Validation r2 = 0.863854
Validation mse = 0.013111
Epoch 6
Loss = 2.0854e-01, PNorm = 43.8903, GNorm = 4.9642, lr_0 = 8.3204e-04
Loss = 1.7627e-01, PNorm = 43.9195, GNorm = 2.2675, lr_0 = 8.1484e-04
Validation rmse = 0.086932
Validation r2 = 0.921522
Validation mse = 0.007557
Epoch 7
Loss = 1.4385e-01, PNorm = 43.9477, GNorm = 4.7917, lr_0 = 7.9799e-04
Loss = 1.7502e-01, PNorm = 43.9736, GNorm = 4.4086, lr_0 = 7.8149e-04
Validation rmse = 0.098685
Validation r2 = 0.898868
Validation mse = 0.009739
Epoch 8
Loss = 1.3658e-01, PNorm = 44.0000, GNorm = 1.4947, lr_0 = 7.6373e-04
Loss = 1.4555e-01, PNorm = 44.0227, GNorm = 2.1444, lr_0 = 7.4794e-04
Validation rmse = 0.116663
Validation r2 = 0.858664
Validation mse = 0.013610
Epoch 9
Loss = 1.5169e-01, PNorm = 44.0509, GNorm = 2.6749, lr_0 = 7.3094e-04
Loss = 1.4113e-01, PNorm = 44.0697, GNorm = 0.8085, lr_0 = 7.1583e-04
Validation rmse = 0.105199
Validation r2 = 0.885077
Validation mse = 0.011067
Epoch 10
Loss = 1.4967e-01, PNorm = 44.0890, GNorm = 1.5416, lr_0 = 7.0103e-04
Loss = 1.2850e-01, PNorm = 44.1111, GNorm = 1.0209, lr_0 = 6.8653e-04
Validation rmse = 0.096470
Validation r2 = 0.903358
Validation mse = 0.009306
Epoch 11
Loss = 1.3807e-01, PNorm = 44.1204, GNorm = 1.1907, lr_0 = 6.7093e-04
Loss = 1.3007e-01, PNorm = 44.1422, GNorm = 1.8449, lr_0 = 6.5706e-04
Validation rmse = 0.165376
Validation r2 = 0.715993
Validation mse = 0.027349
Epoch 12
Loss = 1.7012e-01, PNorm = 44.1724, GNorm = 4.9067, lr_0 = 6.4213e-04
Loss = 1.2129e-01, PNorm = 44.1915, GNorm = 4.0618, lr_0 = 6.2885e-04
Validation rmse = 0.097003
Validation r2 = 0.902287
Validation mse = 0.009410
Epoch 13
Loss = 1.1287e-01, PNorm = 44.2081, GNorm = 1.2890, lr_0 = 6.1585e-04
Loss = 1.1840e-01, PNorm = 44.2245, GNorm = 1.9129, lr_0 = 6.0311e-04
Loss = 1.2876e-01, PNorm = 44.2264, GNorm = 1.5197, lr_0 = 6.0185e-04
Validation rmse = 0.157485
Validation r2 = 0.742451
Validation mse = 0.024801
Epoch 14
Loss = 1.4237e-01, PNorm = 44.2441, GNorm = 6.7279, lr_0 = 5.8941e-04
Validation rmse = 0.157923
Validation r2 = 0.741016
Validation mse = 0.024940
Epoch 15
Loss = 1.1462e-01, PNorm = 44.2657, GNorm = 2.1835, lr_0 = 5.7602e-04
Loss = 1.2508e-01, PNorm = 44.2870, GNorm = 1.8699, lr_0 = 5.6411e-04
Validation rmse = 0.108543
Validation r2 = 0.877655
Validation mse = 0.011782
Epoch 16
Loss = 9.3738e-02, PNorm = 44.3045, GNorm = 1.2664, lr_0 = 5.5244e-04
Loss = 1.1466e-01, PNorm = 44.3190, GNorm = 0.7199, lr_0 = 5.4102e-04
Validation rmse = 0.128139
Validation r2 = 0.829490
Validation mse = 0.016420
Epoch 17
Loss = 8.0578e-02, PNorm = 44.3345, GNorm = 2.2859, lr_0 = 5.2873e-04
Loss = 1.1689e-01, PNorm = 44.3483, GNorm = 3.0754, lr_0 = 5.1779e-04
Validation rmse = 0.132230
Validation r2 = 0.818431
Validation mse = 0.017485
Epoch 18
Loss = 9.6985e-02, PNorm = 44.3636, GNorm = 1.5117, lr_0 = 5.0603e-04
Loss = 1.0484e-01, PNorm = 44.3807, GNorm = 0.9212, lr_0 = 4.9556e-04
Validation rmse = 0.123461
Validation r2 = 0.841714
Validation mse = 0.015243
Epoch 19
Loss = 8.8393e-02, PNorm = 44.3940, GNorm = 0.8993, lr_0 = 4.8532e-04
Loss = 9.5122e-02, PNorm = 44.4077, GNorm = 0.4970, lr_0 = 4.7528e-04
Validation rmse = 0.146389
Validation r2 = 0.777463
Validation mse = 0.021430
Epoch 20
Loss = 1.0203e-01, PNorm = 44.4202, GNorm = 0.8878, lr_0 = 4.6448e-04
Loss = 8.6782e-02, PNorm = 44.4325, GNorm = 1.1644, lr_0 = 4.5488e-04
Validation rmse = 0.144534
Validation r2 = 0.783068
Validation mse = 0.020890
Epoch 21
Loss = 1.0821e-01, PNorm = 44.4483, GNorm = 2.9442, lr_0 = 4.4454e-04
Loss = 8.9115e-02, PNorm = 44.4624, GNorm = 0.8904, lr_0 = 4.3535e-04
Validation rmse = 0.118686
Validation r2 = 0.853720
Validation mse = 0.014086
Epoch 22
Loss = 9.1604e-02, PNorm = 44.4760, GNorm = 0.4841, lr_0 = 4.2635e-04
Loss = 9.0506e-02, PNorm = 44.4884, GNorm = 0.7953, lr_0 = 4.1753e-04
Validation rmse = 0.170503
Validation r2 = 0.698111
Validation mse = 0.029071
Epoch 23
Loss = 1.0250e-01, PNorm = 44.5030, GNorm = 2.5004, lr_0 = 4.0804e-04
Loss = 1.1044e-01, PNorm = 44.5171, GNorm = 0.5510, lr_0 = 3.9961e-04
Validation rmse = 0.140978
Validation r2 = 0.793610
Validation mse = 0.019875
Epoch 24
Loss = 1.3392e-01, PNorm = 44.5330, GNorm = 3.8323, lr_0 = 3.9053e-04
Loss = 1.0004e-01, PNorm = 44.5478, GNorm = 3.1573, lr_0 = 3.8245e-04
Validation rmse = 0.139743
Validation r2 = 0.797211
Validation mse = 0.019528
Epoch 25
Loss = 9.3795e-02, PNorm = 44.5630, GNorm = 2.6154, lr_0 = 3.7454e-04
Loss = 9.6737e-02, PNorm = 44.5777, GNorm = 1.2334, lr_0 = 3.6680e-04
Validation rmse = 0.162535
Validation r2 = 0.725668
Validation mse = 0.026418
Epoch 26
Loss = 9.2934e-02, PNorm = 44.5890, GNorm = 0.8604, lr_0 = 3.5846e-04
Loss = 8.5902e-02, PNorm = 44.6003, GNorm = 0.6934, lr_0 = 3.5105e-04
Validation rmse = 0.119215
Validation r2 = 0.852415
Validation mse = 0.014212
Epoch 27
Loss = 8.7042e-02, PNorm = 44.6098, GNorm = 2.8337, lr_0 = 3.4308e-04
Loss = 8.4145e-02, PNorm = 44.6203, GNorm = 3.1285, lr_0 = 3.3598e-04
Loss = 1.3433e-01, PNorm = 44.6205, GNorm = 3.0606, lr_0 = 3.3528e-04
Validation rmse = 0.162321
Validation r2 = 0.726390
Validation mse = 0.026348
Epoch 28
Loss = 9.4224e-02, PNorm = 44.6277, GNorm = 2.3936, lr_0 = 3.2835e-04
Loss = 9.1441e-02, PNorm = 44.6396, GNorm = 1.1147, lr_0 = 3.2156e-04
Validation rmse = 0.141274
Validation r2 = 0.792744
Validation mse = 0.019958
Epoch 29
Loss = 8.5894e-02, PNorm = 44.6490, GNorm = 2.1573, lr_0 = 3.1491e-04
Validation rmse = 0.184795
Validation r2 = 0.645378
Validation mse = 0.034149
Epoch 30
Loss = 1.7591e-01, PNorm = 44.6608, GNorm = 5.5610, lr_0 = 3.0775e-04
Loss = 9.5942e-02, PNorm = 44.6705, GNorm = 2.6402, lr_0 = 3.0139e-04
Validation rmse = 0.151400
Validation r2 = 0.761967
Validation mse = 0.022922
Epoch 31
Loss = 1.0115e-01, PNorm = 44.6826, GNorm = 3.5268, lr_0 = 2.9454e-04
Loss = 9.0213e-02, PNorm = 44.6920, GNorm = 2.8185, lr_0 = 2.8845e-04
Validation rmse = 0.156715
Validation r2 = 0.744961
Validation mse = 0.024560
Epoch 32
Loss = 9.4610e-02, PNorm = 44.7011, GNorm = 2.6305, lr_0 = 2.8249e-04
Loss = 8.5655e-02, PNorm = 44.7107, GNorm = 1.1875, lr_0 = 2.7665e-04
Validation rmse = 0.155035
Validation r2 = 0.750402
Validation mse = 0.024036
Epoch 33
Loss = 8.6859e-02, PNorm = 44.7193, GNorm = 0.8363, lr_0 = 2.7036e-04
Loss = 6.4996e-02, PNorm = 44.7276, GNorm = 1.5654, lr_0 = 2.6477e-04
Validation rmse = 0.164183
Validation r2 = 0.720077
Validation mse = 0.026956
Epoch 34
Loss = 7.7795e-02, PNorm = 44.7361, GNorm = 0.7526, lr_0 = 2.5875e-04
Loss = 6.9707e-02, PNorm = 44.7435, GNorm = 0.7087, lr_0 = 2.5340e-04
Validation rmse = 0.142767
Validation r2 = 0.788340
Validation mse = 0.020382
Epoch 35
Loss = 6.2309e-02, PNorm = 44.7504, GNorm = 0.7932, lr_0 = 2.4816e-04
Loss = 7.4034e-02, PNorm = 44.7587, GNorm = 1.2562, lr_0 = 2.4303e-04
Validation rmse = 0.143769
Validation r2 = 0.785360
Validation mse = 0.020669
Epoch 36
Loss = 6.8502e-02, PNorm = 44.7662, GNorm = 1.2377, lr_0 = 2.3751e-04
Loss = 7.5701e-02, PNorm = 44.7731, GNorm = 0.6208, lr_0 = 2.3260e-04
Validation rmse = 0.144291
Validation r2 = 0.783798
Validation mse = 0.020820
Epoch 37
Loss = 7.9611e-02, PNorm = 44.7810, GNorm = 0.9167, lr_0 = 2.2731e-04
Loss = 6.3076e-02, PNorm = 44.7881, GNorm = 0.8503, lr_0 = 2.2261e-04
Validation rmse = 0.151568
Validation r2 = 0.761440
Validation mse = 0.022973
Epoch 38
Loss = 6.2554e-02, PNorm = 44.7957, GNorm = 0.4768, lr_0 = 2.1801e-04
Loss = 7.1746e-02, PNorm = 44.8029, GNorm = 0.8727, lr_0 = 2.1350e-04
Validation rmse = 0.150372
Validation r2 = 0.765189
Validation mse = 0.022612
Epoch 39
Loss = 5.1208e-02, PNorm = 44.8086, GNorm = 0.4440, lr_0 = 2.0865e-04
Loss = 7.1394e-02, PNorm = 44.8152, GNorm = 1.7712, lr_0 = 2.0434e-04
Validation rmse = 0.149699
Validation r2 = 0.767286
Validation mse = 0.022410
Epoch 40
Loss = 6.3644e-02, PNorm = 44.8235, GNorm = 0.6934, lr_0 = 1.9969e-04
Loss = 7.0165e-02, PNorm = 44.8305, GNorm = 0.9033, lr_0 = 1.9556e-04
Validation rmse = 0.138962
Validation r2 = 0.799472
Validation mse = 0.019310
Epoch 41
Loss = 6.0369e-02, PNorm = 44.8375, GNorm = 0.6920, lr_0 = 1.9152e-04
Loss = 7.1976e-02, PNorm = 44.8447, GNorm = 1.4189, lr_0 = 1.8756e-04
Validation rmse = 0.151322
Validation r2 = 0.762214
Validation mse = 0.022898
Epoch 42
Loss = 6.0537e-02, PNorm = 44.8510, GNorm = 0.9913, lr_0 = 1.8330e-04
Loss = 6.6485e-02, PNorm = 44.8573, GNorm = 0.6274, lr_0 = 1.7951e-04
Loss = 8.5532e-02, PNorm = 44.8581, GNorm = 1.2064, lr_0 = 1.7913e-04
Validation rmse = 0.148502
Validation r2 = 0.770992
Validation mse = 0.022053
Epoch 43
Loss = 5.8918e-02, PNorm = 44.8650, GNorm = 1.0353, lr_0 = 1.7543e-04
Loss = 6.7820e-02, PNorm = 44.8719, GNorm = 1.0229, lr_0 = 1.7180e-04
Validation rmse = 0.149081
Validation r2 = 0.769203
Validation mse = 0.022225
Epoch 44
Loss = 6.0026e-02, PNorm = 44.8775, GNorm = 0.8168, lr_0 = 1.6825e-04
Validation rmse = 0.155831
Validation r2 = 0.747833
Validation mse = 0.024283
Epoch 45
Loss = 7.8636e-02, PNorm = 44.8841, GNorm = 1.0177, lr_0 = 1.6443e-04
Loss = 5.3808e-02, PNorm = 44.8905, GNorm = 2.5476, lr_0 = 1.6103e-04
Validation rmse = 0.160425
Validation r2 = 0.732743
Validation mse = 0.025736
Epoch 46
Loss = 8.6436e-02, PNorm = 44.8952, GNorm = 1.0963, lr_0 = 1.5737e-04
Loss = 6.1019e-02, PNorm = 44.9009, GNorm = 1.0743, lr_0 = 1.5411e-04
Validation rmse = 0.177466
Validation r2 = 0.672952
Validation mse = 0.031494
Epoch 47
Loss = 5.9248e-02, PNorm = 44.9066, GNorm = 2.4549, lr_0 = 1.5093e-04
Loss = 6.6419e-02, PNorm = 44.9130, GNorm = 1.9894, lr_0 = 1.4781e-04
Validation rmse = 0.168247
Validation r2 = 0.706047
Validation mse = 0.028307
Epoch 48
Loss = 5.7222e-02, PNorm = 44.9188, GNorm = 1.3439, lr_0 = 1.4445e-04
Loss = 5.6997e-02, PNorm = 44.9240, GNorm = 0.5111, lr_0 = 1.4146e-04
Validation rmse = 0.147221
Validation r2 = 0.774928
Validation mse = 0.021674
Epoch 49
Loss = 7.2687e-02, PNorm = 44.9284, GNorm = 0.8777, lr_0 = 1.3825e-04
Loss = 5.7822e-02, PNorm = 44.9338, GNorm = 1.7445, lr_0 = 1.3539e-04
Validation rmse = 0.166849
Validation r2 = 0.710911
Validation mse = 0.027839
Epoch 50
Loss = 5.7865e-02, PNorm = 44.9386, GNorm = 0.7081, lr_0 = 1.3259e-04
Loss = 7.0169e-02, PNorm = 44.9439, GNorm = 0.9603, lr_0 = 1.2985e-04
Validation rmse = 0.168949
Validation r2 = 0.703590
Validation mse = 0.028544
Epoch 51
Loss = 5.8564e-02, PNorm = 44.9485, GNorm = 0.7695, lr_0 = 1.2690e-04
Loss = 6.1675e-02, PNorm = 44.9532, GNorm = 1.2749, lr_0 = 1.2427e-04
Validation rmse = 0.165449
Validation r2 = 0.715744
Validation mse = 0.027373
Epoch 52
Loss = 6.8780e-02, PNorm = 44.9577, GNorm = 1.4575, lr_0 = 1.2145e-04
Loss = 5.1344e-02, PNorm = 44.9618, GNorm = 2.4066, lr_0 = 1.1894e-04
Validation rmse = 0.169420
Validation r2 = 0.701934
Validation mse = 0.028703
Epoch 53
Loss = 6.2695e-02, PNorm = 44.9659, GNorm = 0.9026, lr_0 = 1.1623e-04
Loss = 4.9886e-02, PNorm = 44.9701, GNorm = 0.4090, lr_0 = 1.1383e-04
Validation rmse = 0.162850
Validation r2 = 0.724604
Validation mse = 0.026520
Epoch 54
Loss = 5.1794e-02, PNorm = 44.9739, GNorm = 0.7328, lr_0 = 1.1148e-04
Loss = 5.7227e-02, PNorm = 44.9776, GNorm = 1.3967, lr_0 = 1.0917e-04
Validation rmse = 0.151888
Validation r2 = 0.760430
Validation mse = 0.023070
Epoch 55
Loss = 4.9435e-02, PNorm = 44.9810, GNorm = 0.8681, lr_0 = 1.0669e-04
Loss = 5.9775e-02, PNorm = 44.9847, GNorm = 1.2754, lr_0 = 1.0449e-04
Validation rmse = 0.155426
Validation r2 = 0.749140
Validation mse = 0.024157
Epoch 56
Loss = 4.6341e-02, PNorm = 44.9892, GNorm = 1.2366, lr_0 = 1.0211e-04
Loss = 5.6746e-02, PNorm = 44.9926, GNorm = 0.9519, lr_0 = 1.0000e-04
Validation rmse = 0.164838
Validation r2 = 0.717838
Validation mse = 0.027172
Epoch 57
Loss = 5.4242e-02, PNorm = 44.9962, GNorm = 2.1915, lr_0 = 1.0000e-04
Loss = 5.0352e-02, PNorm = 45.0000, GNorm = 2.0793, lr_0 = 1.0000e-04
Loss = 4.9748e-02, PNorm = 45.0003, GNorm = 1.4187, lr_0 = 1.0000e-04
Validation rmse = 0.165236
Validation r2 = 0.716473
Validation mse = 0.027303
Epoch 58
Loss = 4.8161e-02, PNorm = 45.0037, GNorm = 2.1691, lr_0 = 1.0000e-04
Validation rmse = 0.173324
Validation r2 = 0.688040
Validation mse = 0.030041
Epoch 59
Loss = 6.7315e-02, PNorm = 45.0076, GNorm = 1.0522, lr_0 = 1.0000e-04
Loss = 4.3376e-02, PNorm = 45.0111, GNorm = 0.5253, lr_0 = 1.0000e-04
Validation rmse = 0.175871
Validation r2 = 0.678803
Validation mse = 0.030931
Model 0 best validation rmse = 0.086932 on epoch 6
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.202441
Model 0 test r2 = 0.474351
Model 0 test mse = 0.040982
Ensemble test rmse = 0.202441
Ensemble test r2 = 0.474351
Ensemble test mse = 0.040982
Fold 3
Splitting data with seed 3
Total size = 976 | train size = 966 | val size = 10 | test size = 56
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.8829e-01, PNorm = 43.2625, GNorm = 2.6817, lr_0 = 3.6053e-04
Validation rmse = 0.278033
Validation r2 = 0.224332
Validation mse = 0.077302
Epoch 1
Loss = 8.6287e-01, PNorm = 43.2842, GNorm = 4.4728, lr_0 = 6.2105e-04
Loss = 6.8999e-01, PNorm = 43.3217, GNorm = 4.6501, lr_0 = 8.5789e-04
Validation rmse = 0.239609
Validation r2 = 0.423910
Validation mse = 0.057412
Epoch 2
Loss = 4.9593e-01, PNorm = 43.3997, GNorm = 5.4891, lr_0 = 9.8961e-04
Loss = 4.6051e-01, PNorm = 43.4855, GNorm = 8.3777, lr_0 = 9.6914e-04
Validation rmse = 0.264565
Validation r2 = 0.297659
Validation mse = 0.069994
Epoch 3
Loss = 5.2257e-01, PNorm = 43.5676, GNorm = 6.4802, lr_0 = 9.4712e-04
Loss = 3.9981e-01, PNorm = 43.6316, GNorm = 1.5917, lr_0 = 9.2754e-04
Validation rmse = 0.190056
Validation r2 = 0.637551
Validation mse = 0.036121
Epoch 4
Loss = 4.5206e-01, PNorm = 43.6920, GNorm = 3.5335, lr_0 = 9.0836e-04
Loss = 3.5297e-01, PNorm = 43.7537, GNorm = 3.5700, lr_0 = 8.8958e-04
Validation rmse = 0.207973
Validation r2 = 0.565993
Validation mse = 0.043253
Epoch 5
Loss = 3.3070e-01, PNorm = 43.8127, GNorm = 1.5934, lr_0 = 8.6936e-04
Loss = 1.8821e-01, PNorm = 43.8580, GNorm = 1.9451, lr_0 = 8.5139e-04
Validation rmse = 0.156182
Validation r2 = 0.755238
Validation mse = 0.024393
Epoch 6
Loss = 1.4154e-01, PNorm = 43.8922, GNorm = 0.8514, lr_0 = 8.3204e-04
Loss = 1.6283e-01, PNorm = 43.9173, GNorm = 1.3442, lr_0 = 8.1484e-04
Validation rmse = 0.118872
Validation r2 = 0.858210
Validation mse = 0.014131
Epoch 7
Loss = 2.1736e-01, PNorm = 43.9436, GNorm = 7.6685, lr_0 = 7.9799e-04
Loss = 2.3017e-01, PNorm = 43.9680, GNorm = 3.7113, lr_0 = 7.8149e-04
Validation rmse = 0.133259
Validation r2 = 0.821813
Validation mse = 0.017758
Epoch 8
Loss = 1.6696e-01, PNorm = 44.0020, GNorm = 1.6392, lr_0 = 7.6373e-04
Loss = 1.7062e-01, PNorm = 44.0242, GNorm = 3.9695, lr_0 = 7.4794e-04
Validation rmse = 0.138825
Validation r2 = 0.806615
Validation mse = 0.019272
Epoch 9
Loss = 1.4956e-01, PNorm = 44.0557, GNorm = 1.7076, lr_0 = 7.3094e-04
Loss = 1.4823e-01, PNorm = 44.0761, GNorm = 3.0327, lr_0 = 7.1583e-04
Validation rmse = 0.196222
Validation r2 = 0.613653
Validation mse = 0.038503
Epoch 10
Loss = 1.4482e-01, PNorm = 44.0912, GNorm = 1.8451, lr_0 = 7.0103e-04
Loss = 1.4715e-01, PNorm = 44.1087, GNorm = 0.7405, lr_0 = 6.8653e-04
Validation rmse = 0.148601
Validation r2 = 0.778420
Validation mse = 0.022082
Epoch 11
Loss = 1.3539e-01, PNorm = 44.1343, GNorm = 1.7801, lr_0 = 6.7093e-04
Loss = 1.5202e-01, PNorm = 44.1559, GNorm = 1.0389, lr_0 = 6.5706e-04
Validation rmse = 0.099039
Validation r2 = 0.901578
Validation mse = 0.009809
Epoch 12
Loss = 1.3305e-01, PNorm = 44.1793, GNorm = 1.0390, lr_0 = 6.4213e-04
Loss = 1.2168e-01, PNorm = 44.1967, GNorm = 1.1725, lr_0 = 6.2885e-04
Validation rmse = 0.126415
Validation r2 = 0.839644
Validation mse = 0.015981
Epoch 13
Loss = 1.1308e-01, PNorm = 44.2124, GNorm = 1.5884, lr_0 = 6.1585e-04
Loss = 1.2175e-01, PNorm = 44.2284, GNorm = 0.7956, lr_0 = 6.0311e-04
Loss = 5.9013e-02, PNorm = 44.2305, GNorm = 3.5880, lr_0 = 6.0185e-04
Validation rmse = 0.117750
Validation r2 = 0.860874
Validation mse = 0.013865
Epoch 14
Loss = 1.1594e-01, PNorm = 44.2439, GNorm = 0.9339, lr_0 = 5.8941e-04
Validation rmse = 0.124775
Validation r2 = 0.843780
Validation mse = 0.015569
Epoch 15
Loss = 1.4876e-01, PNorm = 44.2573, GNorm = 0.7292, lr_0 = 5.7602e-04
Loss = 1.0814e-01, PNorm = 44.2715, GNorm = 2.6387, lr_0 = 5.6411e-04
Validation rmse = 0.094666
Validation r2 = 0.910077
Validation mse = 0.008962
Epoch 16
Loss = 1.8514e-01, PNorm = 44.2862, GNorm = 5.7406, lr_0 = 5.5244e-04
Loss = 1.3146e-01, PNorm = 44.3006, GNorm = 1.6463, lr_0 = 5.4102e-04
Validation rmse = 0.085724
Validation r2 = 0.926262
Validation mse = 0.007349
Epoch 17
Loss = 1.0236e-01, PNorm = 44.3199, GNorm = 1.0668, lr_0 = 5.2873e-04
Loss = 1.0517e-01, PNorm = 44.3363, GNorm = 1.0465, lr_0 = 5.1779e-04
Validation rmse = 0.101384
Validation r2 = 0.896860
Validation mse = 0.010279
Epoch 18
Loss = 7.0885e-02, PNorm = 44.3493, GNorm = 0.8684, lr_0 = 5.0603e-04
Loss = 1.0959e-01, PNorm = 44.3604, GNorm = 0.8849, lr_0 = 4.9556e-04
Validation rmse = 0.087250
Validation r2 = 0.923614
Validation mse = 0.007613
Epoch 19
Loss = 1.4883e-01, PNorm = 44.3728, GNorm = 0.8048, lr_0 = 4.8532e-04
Loss = 9.3760e-02, PNorm = 44.3851, GNorm = 1.6355, lr_0 = 4.7528e-04
Validation rmse = 0.092781
Validation r2 = 0.913622
Validation mse = 0.008608
Epoch 20
Loss = 1.0057e-01, PNorm = 44.4037, GNorm = 0.8036, lr_0 = 4.6448e-04
Loss = 1.0348e-01, PNorm = 44.4161, GNorm = 1.7344, lr_0 = 4.5488e-04
Validation rmse = 0.088225
Validation r2 = 0.921898
Validation mse = 0.007784
Epoch 21
Loss = 1.0619e-01, PNorm = 44.4323, GNorm = 0.7841, lr_0 = 4.4454e-04
Loss = 9.3591e-02, PNorm = 44.4431, GNorm = 1.2254, lr_0 = 4.3535e-04
Validation rmse = 0.119282
Validation r2 = 0.857231
Validation mse = 0.014228
Epoch 22
Loss = 7.6832e-02, PNorm = 44.4539, GNorm = 0.8680, lr_0 = 4.2635e-04
Loss = 1.0565e-01, PNorm = 44.4670, GNorm = 0.6044, lr_0 = 4.1753e-04
Validation rmse = 0.085837
Validation r2 = 0.926067
Validation mse = 0.007368
Epoch 23
Loss = 9.4255e-02, PNorm = 44.4823, GNorm = 1.6357, lr_0 = 4.0804e-04
Loss = 1.0735e-01, PNorm = 44.4934, GNorm = 1.5368, lr_0 = 3.9961e-04
Validation rmse = 0.117502
Validation r2 = 0.861461
Validation mse = 0.013807
Epoch 24
Loss = 8.3282e-02, PNorm = 44.5075, GNorm = 0.5521, lr_0 = 3.9053e-04
Loss = 1.0089e-01, PNorm = 44.5200, GNorm = 2.3203, lr_0 = 3.8245e-04
Validation rmse = 0.085671
Validation r2 = 0.926354
Validation mse = 0.007339
Epoch 25
Loss = 9.0988e-02, PNorm = 44.5307, GNorm = 0.9283, lr_0 = 3.7454e-04
Loss = 8.3976e-02, PNorm = 44.5401, GNorm = 1.2405, lr_0 = 3.6680e-04
Validation rmse = 0.093660
Validation r2 = 0.911978
Validation mse = 0.008772
Epoch 26
Loss = 8.8117e-02, PNorm = 44.5510, GNorm = 0.8530, lr_0 = 3.5846e-04
Loss = 9.3021e-02, PNorm = 44.5625, GNorm = 0.9959, lr_0 = 3.5105e-04
Validation rmse = 0.105571
Validation r2 = 0.888166
Validation mse = 0.011145
Epoch 27
Loss = 9.3506e-02, PNorm = 44.5731, GNorm = 0.6244, lr_0 = 3.4308e-04
Loss = 8.0301e-02, PNorm = 44.5839, GNorm = 0.9866, lr_0 = 3.3598e-04
Loss = 1.0870e-01, PNorm = 44.5847, GNorm = 2.3741, lr_0 = 3.3528e-04
Validation rmse = 0.097069
Validation r2 = 0.905454
Validation mse = 0.009422
Epoch 28
Loss = 8.5541e-02, PNorm = 44.5949, GNorm = 2.6650, lr_0 = 3.2835e-04
Loss = 8.4220e-02, PNorm = 44.6025, GNorm = 0.8000, lr_0 = 3.2156e-04
Validation rmse = 0.103176
Validation r2 = 0.893183
Validation mse = 0.010645
Epoch 29
Loss = 8.5202e-02, PNorm = 44.6122, GNorm = 1.8100, lr_0 = 3.1491e-04
Validation rmse = 0.099949
Validation r2 = 0.899760
Validation mse = 0.009990
Epoch 30
Loss = 7.3011e-02, PNorm = 44.6231, GNorm = 1.6877, lr_0 = 3.0775e-04
Loss = 8.6239e-02, PNorm = 44.6334, GNorm = 1.3074, lr_0 = 3.0139e-04
Validation rmse = 0.120585
Validation r2 = 0.854094
Validation mse = 0.014541
Epoch 31
Loss = 8.5373e-02, PNorm = 44.6434, GNorm = 0.9617, lr_0 = 2.9454e-04
Loss = 8.2815e-02, PNorm = 44.6538, GNorm = 0.3867, lr_0 = 2.8845e-04
Validation rmse = 0.077048
Validation r2 = 0.940433
Validation mse = 0.005936
Epoch 32
Loss = 7.9928e-02, PNorm = 44.6649, GNorm = 0.6766, lr_0 = 2.8249e-04
Loss = 7.5101e-02, PNorm = 44.6748, GNorm = 0.7854, lr_0 = 2.7665e-04
Validation rmse = 0.081674
Validation r2 = 0.933066
Validation mse = 0.006671
Epoch 33
Loss = 7.5752e-02, PNorm = 44.6849, GNorm = 1.0435, lr_0 = 2.7036e-04
Loss = 8.2981e-02, PNorm = 44.6941, GNorm = 1.1250, lr_0 = 2.6477e-04
Validation rmse = 0.090797
Validation r2 = 0.917277
Validation mse = 0.008244
Epoch 34
Loss = 7.1148e-02, PNorm = 44.7025, GNorm = 1.2661, lr_0 = 2.5875e-04
Loss = 8.2055e-02, PNorm = 44.7114, GNorm = 0.5596, lr_0 = 2.5340e-04
Validation rmse = 0.090186
Validation r2 = 0.918387
Validation mse = 0.008133
Epoch 35
Loss = 7.8954e-02, PNorm = 44.7209, GNorm = 1.0213, lr_0 = 2.4816e-04
Loss = 7.9285e-02, PNorm = 44.7276, GNorm = 2.4848, lr_0 = 2.4303e-04
Validation rmse = 0.101094
Validation r2 = 0.897449
Validation mse = 0.010220
Epoch 36
Loss = 5.5672e-02, PNorm = 44.7373, GNorm = 0.8681, lr_0 = 2.3751e-04
Loss = 8.0205e-02, PNorm = 44.7452, GNorm = 0.8047, lr_0 = 2.3260e-04
Validation rmse = 0.084320
Validation r2 = 0.928657
Validation mse = 0.007110
Epoch 37
Loss = 8.4589e-02, PNorm = 44.7524, GNorm = 0.8822, lr_0 = 2.2731e-04
Loss = 6.8297e-02, PNorm = 44.7602, GNorm = 0.7049, lr_0 = 2.2261e-04
Validation rmse = 0.089445
Validation r2 = 0.919722
Validation mse = 0.008000
Epoch 38
Loss = 8.7866e-02, PNorm = 44.7673, GNorm = 1.5795, lr_0 = 2.1801e-04
Loss = 8.3300e-02, PNorm = 44.7756, GNorm = 1.9068, lr_0 = 2.1350e-04
Validation rmse = 0.082313
Validation r2 = 0.932013
Validation mse = 0.006775
Epoch 39
Loss = 8.1060e-02, PNorm = 44.7840, GNorm = 2.0463, lr_0 = 2.0865e-04
Loss = 7.1894e-02, PNorm = 44.7919, GNorm = 0.8889, lr_0 = 2.0434e-04
Validation rmse = 0.088297
Validation r2 = 0.921770
Validation mse = 0.007796
Epoch 40
Loss = 6.5195e-02, PNorm = 44.7995, GNorm = 1.4051, lr_0 = 1.9969e-04
Loss = 7.3642e-02, PNorm = 44.8057, GNorm = 0.9696, lr_0 = 1.9556e-04
Validation rmse = 0.077695
Validation r2 = 0.939429
Validation mse = 0.006036
Epoch 41
Loss = 6.8906e-02, PNorm = 44.8124, GNorm = 0.9876, lr_0 = 1.9152e-04
Loss = 7.6776e-02, PNorm = 44.8198, GNorm = 1.1199, lr_0 = 1.8756e-04
Validation rmse = 0.106260
Validation r2 = 0.886701
Validation mse = 0.011291
Epoch 42
Loss = 7.8638e-02, PNorm = 44.8291, GNorm = 1.1440, lr_0 = 1.8330e-04
Loss = 8.3347e-02, PNorm = 44.8346, GNorm = 2.0975, lr_0 = 1.7951e-04
Loss = 1.1404e-01, PNorm = 44.8353, GNorm = 2.2646, lr_0 = 1.7913e-04
Validation rmse = 0.102552
Validation r2 = 0.894471
Validation mse = 0.010517
Epoch 43
Loss = 7.5648e-02, PNorm = 44.8419, GNorm = 0.8699, lr_0 = 1.7543e-04
Loss = 6.5726e-02, PNorm = 44.8481, GNorm = 0.4929, lr_0 = 1.7180e-04
Validation rmse = 0.082928
Validation r2 = 0.930994
Validation mse = 0.006877
Epoch 44
Loss = 6.8519e-02, PNorm = 44.8531, GNorm = 0.8059, lr_0 = 1.6825e-04
Validation rmse = 0.089435
Validation r2 = 0.919739
Validation mse = 0.007999
Epoch 45
Loss = 3.4370e-02, PNorm = 44.8599, GNorm = 0.6310, lr_0 = 1.6443e-04
Loss = 6.5531e-02, PNorm = 44.8663, GNorm = 0.4987, lr_0 = 1.6103e-04
Validation rmse = 0.091944
Validation r2 = 0.915173
Validation mse = 0.008454
Epoch 46
Loss = 5.2072e-02, PNorm = 44.8714, GNorm = 0.4952, lr_0 = 1.5737e-04
Loss = 6.2615e-02, PNorm = 44.8776, GNorm = 0.6819, lr_0 = 1.5411e-04
Validation rmse = 0.087871
Validation r2 = 0.922523
Validation mse = 0.007721
Epoch 47
Loss = 4.9361e-02, PNorm = 44.8814, GNorm = 0.5162, lr_0 = 1.5093e-04
Loss = 6.6830e-02, PNorm = 44.8872, GNorm = 1.2405, lr_0 = 1.4781e-04
Validation rmse = 0.104415
Validation r2 = 0.890603
Validation mse = 0.010902
Epoch 48
Loss = 7.4817e-02, PNorm = 44.8927, GNorm = 1.1709, lr_0 = 1.4445e-04
Loss = 6.1737e-02, PNorm = 44.8972, GNorm = 2.2737, lr_0 = 1.4146e-04
Validation rmse = 0.083398
Validation r2 = 0.930209
Validation mse = 0.006955
Epoch 49
Loss = 6.2899e-02, PNorm = 44.9028, GNorm = 0.4695, lr_0 = 1.3825e-04
Loss = 5.9223e-02, PNorm = 44.9078, GNorm = 1.1118, lr_0 = 1.3539e-04
Validation rmse = 0.092083
Validation r2 = 0.914917
Validation mse = 0.008479
Epoch 50
Loss = 4.9078e-02, PNorm = 44.9122, GNorm = 0.4461, lr_0 = 1.3259e-04
Loss = 6.3447e-02, PNorm = 44.9175, GNorm = 0.6471, lr_0 = 1.2985e-04
Validation rmse = 0.081748
Validation r2 = 0.932945
Validation mse = 0.006683
Epoch 51
Loss = 5.8038e-02, PNorm = 44.9224, GNorm = 0.4346, lr_0 = 1.2690e-04
Loss = 6.8772e-02, PNorm = 44.9264, GNorm = 0.9331, lr_0 = 1.2427e-04
Validation rmse = 0.100061
Validation r2 = 0.899536
Validation mse = 0.010012
Epoch 52
Loss = 5.5204e-02, PNorm = 44.9316, GNorm = 0.9292, lr_0 = 1.2145e-04
Loss = 6.9328e-02, PNorm = 44.9364, GNorm = 0.7007, lr_0 = 1.1894e-04
Validation rmse = 0.078223
Validation r2 = 0.938602
Validation mse = 0.006119
Epoch 53
Loss = 7.1424e-02, PNorm = 44.9416, GNorm = 2.5650, lr_0 = 1.1623e-04
Loss = 6.6553e-02, PNorm = 44.9459, GNorm = 2.1375, lr_0 = 1.1383e-04
Validation rmse = 0.110577
Validation r2 = 0.877310
Validation mse = 0.012227
Epoch 54
Loss = 6.1090e-02, PNorm = 44.9489, GNorm = 0.5991, lr_0 = 1.1148e-04
Loss = 6.4536e-02, PNorm = 44.9539, GNorm = 2.0861, lr_0 = 1.0917e-04
Validation rmse = 0.075847
Validation r2 = 0.942275
Validation mse = 0.005753
Epoch 55
Loss = 6.7532e-02, PNorm = 44.9581, GNorm = 3.3239, lr_0 = 1.0669e-04
Loss = 4.9476e-02, PNorm = 44.9623, GNorm = 0.5268, lr_0 = 1.0449e-04
Validation rmse = 0.081200
Validation r2 = 0.933840
Validation mse = 0.006593
Epoch 56
Loss = 5.5551e-02, PNorm = 44.9661, GNorm = 1.1896, lr_0 = 1.0211e-04
Loss = 6.0747e-02, PNorm = 44.9698, GNorm = 0.8323, lr_0 = 1.0000e-04
Validation rmse = 0.077966
Validation r2 = 0.939004
Validation mse = 0.006079
Epoch 57
Loss = 6.1166e-02, PNorm = 44.9735, GNorm = 1.1360, lr_0 = 1.0000e-04
Loss = 5.5978e-02, PNorm = 44.9773, GNorm = 0.6795, lr_0 = 1.0000e-04
Loss = 2.7613e-02, PNorm = 44.9778, GNorm = 1.0279, lr_0 = 1.0000e-04
Validation rmse = 0.083443
Validation r2 = 0.930134
Validation mse = 0.006963
Epoch 58
Loss = 5.4504e-02, PNorm = 44.9813, GNorm = 0.4703, lr_0 = 1.0000e-04
Validation rmse = 0.077486
Validation r2 = 0.939754
Validation mse = 0.006004
Epoch 59
Loss = 8.7264e-02, PNorm = 44.9852, GNorm = 0.6616, lr_0 = 1.0000e-04
Loss = 5.4857e-02, PNorm = 44.9889, GNorm = 0.8653, lr_0 = 1.0000e-04
Validation rmse = 0.080542
Validation r2 = 0.934908
Validation mse = 0.006487
Model 0 best validation rmse = 0.075847 on epoch 54
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.171670
Model 0 test r2 = 0.622001
Model 0 test mse = 0.029471
Ensemble test rmse = 0.171670
Ensemble test r2 = 0.622001
Ensemble test mse = 0.029471
Fold 4
Splitting data with seed 4
Total size = 976 | train size = 966 | val size = 10 | test size = 56
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.2059e-01, PNorm = 43.2638, GNorm = 0.9435, lr_0 = 3.6053e-04
Validation rmse = 0.150263
Validation r2 = 0.602481
Validation mse = 0.022579
Epoch 1
Loss = 6.2289e-01, PNorm = 43.2921, GNorm = 6.1290, lr_0 = 6.2105e-04
Loss = 6.2269e-01, PNorm = 43.3329, GNorm = 16.3696, lr_0 = 8.5789e-04
Validation rmse = 0.175285
Validation r2 = 0.459068
Validation mse = 0.030725
Epoch 2
Loss = 4.9287e-01, PNorm = 43.4026, GNorm = 5.8908, lr_0 = 9.8961e-04
Loss = 4.2075e-01, PNorm = 43.4873, GNorm = 4.2754, lr_0 = 9.6914e-04
Validation rmse = 0.286647
Validation r2 = -0.446596
Validation mse = 0.082166
Epoch 3
Loss = 4.4474e-01, PNorm = 43.5697, GNorm = 4.5549, lr_0 = 9.4712e-04
Loss = 3.7702e-01, PNorm = 43.6378, GNorm = 4.5567, lr_0 = 9.2754e-04
Validation rmse = 0.253447
Validation r2 = -0.130910
Validation mse = 0.064235
Epoch 4
Loss = 2.5897e-01, PNorm = 43.6892, GNorm = 1.6928, lr_0 = 9.0836e-04
Loss = 2.5931e-01, PNorm = 43.7317, GNorm = 3.7975, lr_0 = 8.8958e-04
Validation rmse = 0.191178
Validation r2 = 0.356527
Validation mse = 0.036549
Epoch 5
Loss = 1.8621e-01, PNorm = 43.7737, GNorm = 4.3176, lr_0 = 8.6936e-04
Loss = 2.1004e-01, PNorm = 43.8096, GNorm = 8.0737, lr_0 = 8.5139e-04
Validation rmse = 0.172842
Validation r2 = 0.474038
Validation mse = 0.029875
Epoch 6
Loss = 1.9720e-01, PNorm = 43.8397, GNorm = 2.5386, lr_0 = 8.3204e-04
Loss = 2.1297e-01, PNorm = 43.8698, GNorm = 1.8232, lr_0 = 8.1484e-04
Validation rmse = 0.189293
Validation r2 = 0.369158
Validation mse = 0.035832
Epoch 7
Loss = 1.6370e-01, PNorm = 43.8971, GNorm = 3.6831, lr_0 = 7.9799e-04
Loss = 1.6670e-01, PNorm = 43.9283, GNorm = 2.2968, lr_0 = 7.8149e-04
Validation rmse = 0.189624
Validation r2 = 0.366948
Validation mse = 0.035957
Epoch 8
Loss = 1.5558e-01, PNorm = 43.9548, GNorm = 2.2596, lr_0 = 7.6373e-04
Loss = 1.4175e-01, PNorm = 43.9738, GNorm = 3.8255, lr_0 = 7.4794e-04
Validation rmse = 0.200144
Validation r2 = 0.294755
Validation mse = 0.040058
Epoch 9
Loss = 1.7112e-01, PNorm = 44.0011, GNorm = 1.1014, lr_0 = 7.3094e-04
Loss = 1.4994e-01, PNorm = 44.0240, GNorm = 2.9280, lr_0 = 7.1583e-04
Validation rmse = 0.147691
Validation r2 = 0.615974
Validation mse = 0.021813
Epoch 10
Loss = 1.2592e-01, PNorm = 44.0465, GNorm = 2.2554, lr_0 = 7.0103e-04
Loss = 1.3495e-01, PNorm = 44.0702, GNorm = 0.8055, lr_0 = 6.8653e-04
Validation rmse = 0.168418
Validation r2 = 0.500623
Validation mse = 0.028364
Epoch 11
Loss = 1.4742e-01, PNorm = 44.0866, GNorm = 0.8142, lr_0 = 6.7093e-04
Loss = 1.2958e-01, PNorm = 44.1043, GNorm = 3.1680, lr_0 = 6.5706e-04
Validation rmse = 0.149023
Validation r2 = 0.609015
Validation mse = 0.022208
Epoch 12
Loss = 1.0970e-01, PNorm = 44.1276, GNorm = 3.0397, lr_0 = 6.4213e-04
Loss = 1.6479e-01, PNorm = 44.1484, GNorm = 2.6851, lr_0 = 6.2885e-04
Validation rmse = 0.162417
Validation r2 = 0.535574
Validation mse = 0.026379
Epoch 13
Loss = 1.1473e-01, PNorm = 44.1732, GNorm = 0.8878, lr_0 = 6.1585e-04
Loss = 1.1602e-01, PNorm = 44.1899, GNorm = 0.9972, lr_0 = 6.0311e-04
Loss = 1.5714e-01, PNorm = 44.1910, GNorm = 1.5458, lr_0 = 6.0185e-04
Validation rmse = 0.138841
Validation r2 = 0.660619
Validation mse = 0.019277
Epoch 14
Loss = 1.1909e-01, PNorm = 44.2043, GNorm = 3.3950, lr_0 = 5.8941e-04
Validation rmse = 0.146294
Validation r2 = 0.623202
Validation mse = 0.021402
Epoch 15
Loss = 8.2857e-02, PNorm = 44.2255, GNorm = 0.7185, lr_0 = 5.7602e-04
Loss = 1.2133e-01, PNorm = 44.2404, GNorm = 1.7661, lr_0 = 5.6411e-04
Validation rmse = 0.156754
Validation r2 = 0.567398
Validation mse = 0.024572
Epoch 16
Loss = 1.1073e-01, PNorm = 44.2580, GNorm = 2.6205, lr_0 = 5.5244e-04
Loss = 1.0548e-01, PNorm = 44.2757, GNorm = 1.3585, lr_0 = 5.4102e-04
Validation rmse = 0.155351
Validation r2 = 0.575106
Validation mse = 0.024134
Epoch 17
Loss = 9.4686e-02, PNorm = 44.2859, GNorm = 0.6912, lr_0 = 5.2873e-04
Loss = 1.1483e-01, PNorm = 44.2984, GNorm = 3.5736, lr_0 = 5.1779e-04
Validation rmse = 0.153199
Validation r2 = 0.586794
Validation mse = 0.023470
Epoch 18
Loss = 7.9767e-02, PNorm = 44.3154, GNorm = 2.0774, lr_0 = 5.0603e-04
Loss = 9.4822e-02, PNorm = 44.3282, GNorm = 0.5997, lr_0 = 4.9556e-04
Validation rmse = 0.145529
Validation r2 = 0.627132
Validation mse = 0.021179
Epoch 19
Loss = 9.8477e-02, PNorm = 44.3446, GNorm = 2.0536, lr_0 = 4.8532e-04
Loss = 1.0666e-01, PNorm = 44.3550, GNorm = 1.6607, lr_0 = 4.7528e-04
Validation rmse = 0.163424
Validation r2 = 0.529796
Validation mse = 0.026707
Epoch 20
Loss = 8.4698e-02, PNorm = 44.3716, GNorm = 0.7571, lr_0 = 4.6448e-04
Loss = 9.5457e-02, PNorm = 44.3852, GNorm = 1.3592, lr_0 = 4.5488e-04
Validation rmse = 0.161170
Validation r2 = 0.542676
Validation mse = 0.025976
Epoch 21
Loss = 8.4709e-02, PNorm = 44.3965, GNorm = 1.2444, lr_0 = 4.4454e-04
Loss = 1.0693e-01, PNorm = 44.4105, GNorm = 0.9856, lr_0 = 4.3535e-04
Validation rmse = 0.167307
Validation r2 = 0.507186
Validation mse = 0.027992
Epoch 22
Loss = 8.6963e-02, PNorm = 44.4220, GNorm = 3.0295, lr_0 = 4.2635e-04
Loss = 1.0129e-01, PNorm = 44.4361, GNorm = 1.9858, lr_0 = 4.1753e-04
Validation rmse = 0.152406
Validation r2 = 0.591061
Validation mse = 0.023228
Epoch 23
Loss = 8.0591e-02, PNorm = 44.4496, GNorm = 0.6787, lr_0 = 4.0804e-04
Loss = 9.5781e-02, PNorm = 44.4606, GNorm = 1.2001, lr_0 = 3.9961e-04
Validation rmse = 0.162256
Validation r2 = 0.536495
Validation mse = 0.026327
Epoch 24
Loss = 9.5579e-02, PNorm = 44.4719, GNorm = 0.8260, lr_0 = 3.9053e-04
Loss = 9.5461e-02, PNorm = 44.4816, GNorm = 2.8268, lr_0 = 3.8245e-04
Validation rmse = 0.161550
Validation r2 = 0.540518
Validation mse = 0.026098
Epoch 25
Loss = 8.3112e-02, PNorm = 44.4935, GNorm = 0.6760, lr_0 = 3.7454e-04
Loss = 1.0083e-01, PNorm = 44.5064, GNorm = 3.6957, lr_0 = 3.6680e-04
Validation rmse = 0.170740
Validation r2 = 0.486756
Validation mse = 0.029152
Epoch 26
Loss = 8.4698e-02, PNorm = 44.5159, GNorm = 2.2716, lr_0 = 3.5846e-04
Loss = 8.8660e-02, PNorm = 44.5262, GNorm = 0.5470, lr_0 = 3.5105e-04
Validation rmse = 0.158723
Validation r2 = 0.556462
Validation mse = 0.025193
Epoch 27
Loss = 6.4201e-02, PNorm = 44.5365, GNorm = 1.0050, lr_0 = 3.4308e-04
Loss = 9.6039e-02, PNorm = 44.5440, GNorm = 1.6912, lr_0 = 3.3598e-04
Loss = 1.3854e-01, PNorm = 44.5453, GNorm = 2.4287, lr_0 = 3.3528e-04
Validation rmse = 0.152551
Validation r2 = 0.590284
Validation mse = 0.023272
Epoch 28
Loss = 8.4783e-02, PNorm = 44.5550, GNorm = 1.1352, lr_0 = 3.2835e-04
Loss = 8.2158e-02, PNorm = 44.5622, GNorm = 1.4487, lr_0 = 3.2156e-04
Validation rmse = 0.151122
Validation r2 = 0.597923
Validation mse = 0.022838
Epoch 29
Loss = 7.5778e-02, PNorm = 44.5715, GNorm = 1.0396, lr_0 = 3.1491e-04
Validation rmse = 0.155727
Validation r2 = 0.573044
Validation mse = 0.024251
Epoch 30
Loss = 1.1416e-01, PNorm = 44.5810, GNorm = 0.7722, lr_0 = 3.0775e-04
Loss = 8.5455e-02, PNorm = 44.5898, GNorm = 0.8855, lr_0 = 3.0139e-04
Validation rmse = 0.156324
Validation r2 = 0.569765
Validation mse = 0.024437
Epoch 31
Loss = 9.5735e-02, PNorm = 44.6009, GNorm = 3.3064, lr_0 = 2.9454e-04
Loss = 8.0645e-02, PNorm = 44.6090, GNorm = 0.8240, lr_0 = 2.8845e-04
Validation rmse = 0.173611
Validation r2 = 0.469348
Validation mse = 0.030141
Epoch 32
Loss = 1.0126e-01, PNorm = 44.6177, GNorm = 4.3594, lr_0 = 2.8249e-04
Loss = 9.8055e-02, PNorm = 44.6287, GNorm = 2.1775, lr_0 = 2.7665e-04
Validation rmse = 0.171648
Validation r2 = 0.481285
Validation mse = 0.029463
Epoch 33
Loss = 1.1540e-01, PNorm = 44.6408, GNorm = 2.6997, lr_0 = 2.7036e-04
Loss = 9.8415e-02, PNorm = 44.6524, GNorm = 0.8801, lr_0 = 2.6477e-04
Validation rmse = 0.167164
Validation r2 = 0.508030
Validation mse = 0.027944
Epoch 34
Loss = 8.1257e-02, PNorm = 44.6647, GNorm = 1.7153, lr_0 = 2.5875e-04
Loss = 7.4514e-02, PNorm = 44.6730, GNorm = 0.7568, lr_0 = 2.5340e-04
Validation rmse = 0.163998
Validation r2 = 0.526489
Validation mse = 0.026895
Epoch 35
Loss = 6.9131e-02, PNorm = 44.6812, GNorm = 0.4825, lr_0 = 2.4816e-04
Loss = 7.8527e-02, PNorm = 44.6897, GNorm = 0.9417, lr_0 = 2.4303e-04
Validation rmse = 0.158227
Validation r2 = 0.559225
Validation mse = 0.025036
Epoch 36
Loss = 7.0598e-02, PNorm = 44.6973, GNorm = 1.1252, lr_0 = 2.3751e-04
Loss = 7.7450e-02, PNorm = 44.7052, GNorm = 1.5892, lr_0 = 2.3260e-04
Validation rmse = 0.150134
Validation r2 = 0.603163
Validation mse = 0.022540
Epoch 37
Loss = 7.1966e-02, PNorm = 44.7114, GNorm = 2.0704, lr_0 = 2.2731e-04
Loss = 7.4919e-02, PNorm = 44.7188, GNorm = 1.0248, lr_0 = 2.2261e-04
Validation rmse = 0.157210
Validation r2 = 0.564877
Validation mse = 0.024715
Epoch 38
Loss = 7.5987e-02, PNorm = 44.7251, GNorm = 0.6020, lr_0 = 2.1801e-04
Loss = 5.9328e-02, PNorm = 44.7322, GNorm = 1.0123, lr_0 = 2.1350e-04
Validation rmse = 0.156419
Validation r2 = 0.569242
Validation mse = 0.024467
Epoch 39
Loss = 6.4021e-02, PNorm = 44.7396, GNorm = 1.3142, lr_0 = 2.0865e-04
Loss = 7.1103e-02, PNorm = 44.7464, GNorm = 1.1285, lr_0 = 2.0434e-04
Validation rmse = 0.154102
Validation r2 = 0.581909
Validation mse = 0.023747
Epoch 40
Loss = 7.1013e-02, PNorm = 44.7520, GNorm = 1.1671, lr_0 = 1.9969e-04
Loss = 6.8469e-02, PNorm = 44.7590, GNorm = 0.6177, lr_0 = 1.9556e-04
Validation rmse = 0.155332
Validation r2 = 0.575211
Validation mse = 0.024128
Epoch 41
Loss = 8.0487e-02, PNorm = 44.7655, GNorm = 1.2453, lr_0 = 1.9152e-04
Loss = 6.5759e-02, PNorm = 44.7710, GNorm = 0.9282, lr_0 = 1.8756e-04
Validation rmse = 0.156693
Validation r2 = 0.567730
Validation mse = 0.024553
Epoch 42
Loss = 7.4766e-02, PNorm = 44.7793, GNorm = 0.8052, lr_0 = 1.8330e-04
Loss = 6.1797e-02, PNorm = 44.7851, GNorm = 0.9890, lr_0 = 1.7951e-04
Loss = 9.4494e-02, PNorm = 44.7857, GNorm = 2.1079, lr_0 = 1.7913e-04
Validation rmse = 0.149821
Validation r2 = 0.604818
Validation mse = 0.022446
Epoch 43
Loss = 6.7059e-02, PNorm = 44.7913, GNorm = 1.0142, lr_0 = 1.7543e-04
Loss = 6.5581e-02, PNorm = 44.7968, GNorm = 2.8980, lr_0 = 1.7180e-04
Validation rmse = 0.158447
Validation r2 = 0.558000
Validation mse = 0.025106
Epoch 44
Loss = 6.4833e-02, PNorm = 44.8019, GNorm = 2.7530, lr_0 = 1.6825e-04
Validation rmse = 0.156437
Validation r2 = 0.569143
Validation mse = 0.024473
Epoch 45
Loss = 6.4385e-02, PNorm = 44.8085, GNorm = 1.1250, lr_0 = 1.6443e-04
Loss = 6.9957e-02, PNorm = 44.8141, GNorm = 2.2298, lr_0 = 1.6103e-04
Validation rmse = 0.157236
Validation r2 = 0.564729
Validation mse = 0.024723
Epoch 46
Loss = 6.3819e-02, PNorm = 44.8205, GNorm = 1.9096, lr_0 = 1.5737e-04
Loss = 6.7070e-02, PNorm = 44.8263, GNorm = 2.7058, lr_0 = 1.5411e-04
Validation rmse = 0.151067
Validation r2 = 0.598218
Validation mse = 0.022821
Epoch 47
Loss = 7.4369e-02, PNorm = 44.8316, GNorm = 2.3207, lr_0 = 1.5093e-04
Loss = 6.0451e-02, PNorm = 44.8364, GNorm = 0.9532, lr_0 = 1.4781e-04
Validation rmse = 0.158248
Validation r2 = 0.559112
Validation mse = 0.025042
Epoch 48
Loss = 8.2507e-02, PNorm = 44.8424, GNorm = 1.6535, lr_0 = 1.4445e-04
Loss = 5.7102e-02, PNorm = 44.8464, GNorm = 1.4472, lr_0 = 1.4146e-04
Validation rmse = 0.161105
Validation r2 = 0.543050
Validation mse = 0.025955
Epoch 49
Loss = 7.2727e-02, PNorm = 44.8526, GNorm = 1.4768, lr_0 = 1.3825e-04
Loss = 6.4866e-02, PNorm = 44.8577, GNorm = 1.4470, lr_0 = 1.3539e-04
Validation rmse = 0.158608
Validation r2 = 0.557104
Validation mse = 0.025156
Epoch 50
Loss = 5.7080e-02, PNorm = 44.8625, GNorm = 0.6843, lr_0 = 1.3259e-04
Loss = 5.5828e-02, PNorm = 44.8670, GNorm = 0.5999, lr_0 = 1.2985e-04
Validation rmse = 0.157162
Validation r2 = 0.565140
Validation mse = 0.024700
Epoch 51
Loss = 6.4844e-02, PNorm = 44.8717, GNorm = 1.5830, lr_0 = 1.2690e-04
Loss = 5.2330e-02, PNorm = 44.8755, GNorm = 0.6291, lr_0 = 1.2427e-04
Validation rmse = 0.154539
Validation r2 = 0.579536
Validation mse = 0.023882
Epoch 52
Loss = 5.3564e-02, PNorm = 44.8807, GNorm = 1.0630, lr_0 = 1.2145e-04
Loss = 5.9380e-02, PNorm = 44.8847, GNorm = 1.6122, lr_0 = 1.1894e-04
Validation rmse = 0.156358
Validation r2 = 0.569581
Validation mse = 0.024448
Epoch 53
Loss = 5.7825e-02, PNorm = 44.8888, GNorm = 0.5595, lr_0 = 1.1623e-04
Loss = 5.4732e-02, PNorm = 44.8938, GNorm = 0.4719, lr_0 = 1.1383e-04
Validation rmse = 0.157759
Validation r2 = 0.561833
Validation mse = 0.024888
Epoch 54
Loss = 5.5597e-02, PNorm = 44.8977, GNorm = 1.7948, lr_0 = 1.1148e-04
Loss = 5.6653e-02, PNorm = 44.9018, GNorm = 2.8031, lr_0 = 1.0917e-04
Validation rmse = 0.155900
Validation r2 = 0.572096
Validation mse = 0.024305
Epoch 55
Loss = 5.0454e-02, PNorm = 44.9062, GNorm = 0.5723, lr_0 = 1.0669e-04
Loss = 5.7805e-02, PNorm = 44.9102, GNorm = 1.4648, lr_0 = 1.0449e-04
Validation rmse = 0.159936
Validation r2 = 0.549654
Validation mse = 0.025580
Epoch 56
Loss = 5.1833e-02, PNorm = 44.9145, GNorm = 1.0130, lr_0 = 1.0211e-04
Loss = 5.9879e-02, PNorm = 44.9180, GNorm = 1.0841, lr_0 = 1.0000e-04
Validation rmse = 0.153280
Validation r2 = 0.586359
Validation mse = 0.023495
Epoch 57
Loss = 5.3573e-02, PNorm = 44.9212, GNorm = 0.7702, lr_0 = 1.0000e-04
Loss = 5.2157e-02, PNorm = 44.9246, GNorm = 0.4808, lr_0 = 1.0000e-04
Loss = 6.2880e-02, PNorm = 44.9249, GNorm = 1.3509, lr_0 = 1.0000e-04
Validation rmse = 0.155357
Validation r2 = 0.575070
Validation mse = 0.024136
Epoch 58
Loss = 5.4072e-02, PNorm = 44.9288, GNorm = 0.9186, lr_0 = 1.0000e-04
Validation rmse = 0.156955
Validation r2 = 0.566283
Validation mse = 0.024635
Epoch 59
Loss = 4.9707e-02, PNorm = 44.9325, GNorm = 1.3474, lr_0 = 1.0000e-04
Loss = 5.1234e-02, PNorm = 44.9354, GNorm = 1.2307, lr_0 = 1.0000e-04
Validation rmse = 0.158181
Validation r2 = 0.559482
Validation mse = 0.025021
Model 0 best validation rmse = 0.138841 on epoch 13
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.182042
Model 0 test r2 = 0.574946
Model 0 test mse = 0.033139
Ensemble test rmse = 0.182042
Ensemble test r2 = 0.574946
Ensemble test mse = 0.033139
Fold 5
Splitting data with seed 5
Total size = 976 | train size = 966 | val size = 10 | test size = 56
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 8.6451e-01, PNorm = 43.2636, GNorm = 5.5794, lr_0 = 3.6053e-04
Validation rmse = 0.308831
Validation r2 = -0.143231
Validation mse = 0.095377
Epoch 1
Loss = 6.8094e-01, PNorm = 43.2945, GNorm = 13.5311, lr_0 = 6.2105e-04
Loss = 7.2557e-01, PNorm = 43.3274, GNorm = 3.3894, lr_0 = 8.5789e-04
Validation rmse = 0.267406
Validation r2 = 0.142898
Validation mse = 0.071506
Epoch 2
Loss = 7.1880e-01, PNorm = 43.4033, GNorm = 1.0766, lr_0 = 9.8961e-04
Loss = 3.8830e-01, PNorm = 43.4892, GNorm = 1.7822, lr_0 = 9.6914e-04
Validation rmse = 0.315415
Validation r2 = -0.192493
Validation mse = 0.099487
Epoch 3
Loss = 3.1273e-01, PNorm = 43.5775, GNorm = 2.2135, lr_0 = 9.4712e-04
Loss = 2.9465e-01, PNorm = 43.6490, GNorm = 3.2919, lr_0 = 9.2754e-04
Validation rmse = 0.237893
Validation r2 = 0.321651
Validation mse = 0.056593
Epoch 4
Loss = 2.4652e-01, PNorm = 43.6993, GNorm = 2.8977, lr_0 = 9.0836e-04
Loss = 2.5678e-01, PNorm = 43.7505, GNorm = 4.2421, lr_0 = 8.8958e-04
Validation rmse = 0.182183
Validation r2 = 0.602162
Validation mse = 0.033191
Epoch 5
Loss = 1.9124e-01, PNorm = 43.7973, GNorm = 3.6369, lr_0 = 8.6936e-04
Loss = 1.9985e-01, PNorm = 43.8349, GNorm = 5.7832, lr_0 = 8.5139e-04
Validation rmse = 0.177442
Validation r2 = 0.622600
Validation mse = 0.031486
Epoch 6
Loss = 1.9187e-01, PNorm = 43.8650, GNorm = 2.9653, lr_0 = 8.3204e-04
Loss = 1.8489e-01, PNorm = 43.9034, GNorm = 1.5691, lr_0 = 8.1484e-04
Validation rmse = 0.167303
Validation r2 = 0.664496
Validation mse = 0.027990
Epoch 7
Loss = 1.4105e-01, PNorm = 43.9302, GNorm = 1.1295, lr_0 = 7.9799e-04
Loss = 1.7872e-01, PNorm = 43.9520, GNorm = 7.8122, lr_0 = 7.8149e-04
Validation rmse = 0.168932
Validation r2 = 0.657928
Validation mse = 0.028538
Epoch 8
Loss = 1.6384e-01, PNorm = 43.9749, GNorm = 1.9817, lr_0 = 7.6373e-04
Loss = 1.6271e-01, PNorm = 44.0050, GNorm = 0.9795, lr_0 = 7.4794e-04
Validation rmse = 0.162092
Validation r2 = 0.685070
Validation mse = 0.026274
Epoch 9
Loss = 1.7621e-01, PNorm = 44.0258, GNorm = 5.2806, lr_0 = 7.3094e-04
Loss = 1.6076e-01, PNorm = 44.0486, GNorm = 7.6541, lr_0 = 7.1583e-04
Validation rmse = 0.170946
Validation r2 = 0.649727
Validation mse = 0.029222
Epoch 10
Loss = 1.7280e-01, PNorm = 44.0896, GNorm = 2.1810, lr_0 = 7.0103e-04
Loss = 1.7135e-01, PNorm = 44.1229, GNorm = 4.0070, lr_0 = 6.8653e-04
Validation rmse = 0.221060
Validation r2 = 0.414254
Validation mse = 0.048867
Epoch 11
Loss = 1.1934e-01, PNorm = 44.1469, GNorm = 0.7289, lr_0 = 6.7093e-04
Loss = 1.2130e-01, PNorm = 44.1605, GNorm = 1.6913, lr_0 = 6.5706e-04
Validation rmse = 0.168393
Validation r2 = 0.660110
Validation mse = 0.028356
Epoch 12
Loss = 1.1353e-01, PNorm = 44.1782, GNorm = 3.1180, lr_0 = 6.4213e-04
Loss = 1.5593e-01, PNorm = 44.2002, GNorm = 1.3379, lr_0 = 6.2885e-04
Validation rmse = 0.178430
Validation r2 = 0.618386
Validation mse = 0.031837
Epoch 13
Loss = 1.1840e-01, PNorm = 44.2190, GNorm = 1.6315, lr_0 = 6.1585e-04
Loss = 1.2177e-01, PNorm = 44.2335, GNorm = 1.3435, lr_0 = 6.0311e-04
Loss = 9.7155e-02, PNorm = 44.2355, GNorm = 1.3972, lr_0 = 6.0185e-04
Validation rmse = 0.201986
Validation r2 = 0.510973
Validation mse = 0.040798
Epoch 14
Loss = 1.2650e-01, PNorm = 44.2541, GNorm = 0.7949, lr_0 = 5.8941e-04
Validation rmse = 0.178806
Validation r2 = 0.616773
Validation mse = 0.031972
Epoch 15
Loss = 8.7269e-02, PNorm = 44.2762, GNorm = 0.8000, lr_0 = 5.7602e-04
Loss = 1.3927e-01, PNorm = 44.2926, GNorm = 1.7637, lr_0 = 5.6411e-04
Validation rmse = 0.168704
Validation r2 = 0.658852
Validation mse = 0.028461
Epoch 16
Loss = 7.9813e-02, PNorm = 44.3083, GNorm = 1.4793, lr_0 = 5.5244e-04
Loss = 1.2192e-01, PNorm = 44.3247, GNorm = 3.6426, lr_0 = 5.4102e-04
Validation rmse = 0.146695
Validation r2 = 0.742058
Validation mse = 0.021519
Epoch 17
Loss = 1.0894e-01, PNorm = 44.3428, GNorm = 0.5008, lr_0 = 5.2873e-04
Loss = 1.1324e-01, PNorm = 44.3582, GNorm = 4.2253, lr_0 = 5.1779e-04
Validation rmse = 0.207656
Validation r2 = 0.483132
Validation mse = 0.043121
Epoch 18
Loss = 9.5969e-02, PNorm = 44.3772, GNorm = 0.8718, lr_0 = 5.0603e-04
Loss = 1.1442e-01, PNorm = 44.3909, GNorm = 0.9596, lr_0 = 4.9556e-04
Validation rmse = 0.160490
Validation r2 = 0.691265
Validation mse = 0.025757
Epoch 19
Loss = 9.3343e-02, PNorm = 44.4060, GNorm = 1.4899, lr_0 = 4.8532e-04
Loss = 1.1625e-01, PNorm = 44.4172, GNorm = 2.5951, lr_0 = 4.7528e-04
Validation rmse = 0.199251
Validation r2 = 0.524126
Validation mse = 0.039701
Epoch 20
Loss = 8.6254e-02, PNorm = 44.4322, GNorm = 2.2645, lr_0 = 4.6448e-04
Loss = 1.0425e-01, PNorm = 44.4480, GNorm = 0.4098, lr_0 = 4.5488e-04
Validation rmse = 0.166259
Validation r2 = 0.668668
Validation mse = 0.027642
Epoch 21
Loss = 8.0879e-02, PNorm = 44.4570, GNorm = 1.0815, lr_0 = 4.4454e-04
Loss = 1.0385e-01, PNorm = 44.4691, GNorm = 1.4488, lr_0 = 4.3535e-04
Validation rmse = 0.194933
Validation r2 = 0.544526
Validation mse = 0.037999
Epoch 22
Loss = 8.9353e-02, PNorm = 44.4812, GNorm = 2.4188, lr_0 = 4.2635e-04
Loss = 9.2755e-02, PNorm = 44.4910, GNorm = 0.9200, lr_0 = 4.1753e-04
Validation rmse = 0.154669
Validation r2 = 0.713255
Validation mse = 0.023922
Epoch 23
Loss = 8.6399e-02, PNorm = 44.5046, GNorm = 1.7145, lr_0 = 4.0804e-04
Loss = 9.3650e-02, PNorm = 44.5166, GNorm = 2.6078, lr_0 = 3.9961e-04
Validation rmse = 0.141061
Validation r2 = 0.761491
Validation mse = 0.019898
Epoch 24
Loss = 7.7063e-02, PNorm = 44.5276, GNorm = 0.8605, lr_0 = 3.9053e-04
Loss = 1.0687e-01, PNorm = 44.5394, GNorm = 2.1615, lr_0 = 3.8245e-04
Validation rmse = 0.165944
Validation r2 = 0.669923
Validation mse = 0.027537
Epoch 25
Loss = 7.6713e-02, PNorm = 44.5498, GNorm = 0.6346, lr_0 = 3.7454e-04
Loss = 9.4064e-02, PNorm = 44.5582, GNorm = 1.2726, lr_0 = 3.6680e-04
Validation rmse = 0.168033
Validation r2 = 0.661563
Validation mse = 0.028235
Epoch 26
Loss = 8.4470e-02, PNorm = 44.5708, GNorm = 2.7454, lr_0 = 3.5846e-04
Loss = 9.8545e-02, PNorm = 44.5807, GNorm = 1.2246, lr_0 = 3.5105e-04
Validation rmse = 0.164610
Validation r2 = 0.675211
Validation mse = 0.027096
Epoch 27
Loss = 8.3519e-02, PNorm = 44.5946, GNorm = 1.2594, lr_0 = 3.4308e-04
Loss = 8.7847e-02, PNorm = 44.6054, GNorm = 0.5830, lr_0 = 3.3598e-04
Loss = 8.2801e-02, PNorm = 44.6063, GNorm = 1.1276, lr_0 = 3.3528e-04
Validation rmse = 0.184554
Validation r2 = 0.591739
Validation mse = 0.034060
Epoch 28
Loss = 8.3720e-02, PNorm = 44.6158, GNorm = 0.8312, lr_0 = 3.2835e-04
Loss = 8.9041e-02, PNorm = 44.6253, GNorm = 1.1741, lr_0 = 3.2156e-04
Validation rmse = 0.185280
Validation r2 = 0.588521
Validation mse = 0.034329
Epoch 29
Loss = 9.3588e-02, PNorm = 44.6384, GNorm = 1.9045, lr_0 = 3.1491e-04
Validation rmse = 0.190241
Validation r2 = 0.566191
Validation mse = 0.036192
Epoch 30
Loss = 9.3880e-02, PNorm = 44.6489, GNorm = 2.6887, lr_0 = 3.0775e-04
Loss = 8.7087e-02, PNorm = 44.6580, GNorm = 1.6750, lr_0 = 3.0139e-04
Validation rmse = 0.192328
Validation r2 = 0.556620
Validation mse = 0.036990
Epoch 31
Loss = 7.9578e-02, PNorm = 44.6680, GNorm = 2.3124, lr_0 = 2.9454e-04
Loss = 7.5885e-02, PNorm = 44.6781, GNorm = 0.4394, lr_0 = 2.8845e-04
Validation rmse = 0.154356
Validation r2 = 0.714413
Validation mse = 0.023826
Epoch 32
Loss = 9.9811e-02, PNorm = 44.6858, GNorm = 1.6989, lr_0 = 2.8249e-04
Loss = 8.1853e-02, PNorm = 44.6958, GNorm = 0.7773, lr_0 = 2.7665e-04
Validation rmse = 0.158889
Validation r2 = 0.697393
Validation mse = 0.025246
Epoch 33
Loss = 8.3705e-02, PNorm = 44.7054, GNorm = 1.0978, lr_0 = 2.7036e-04
Loss = 7.6784e-02, PNorm = 44.7139, GNorm = 1.3566, lr_0 = 2.6477e-04
Validation rmse = 0.145232
Validation r2 = 0.747177
Validation mse = 0.021092
Epoch 34
Loss = 7.4874e-02, PNorm = 44.7243, GNorm = 0.4932, lr_0 = 2.5875e-04
Loss = 6.9841e-02, PNorm = 44.7317, GNorm = 1.0335, lr_0 = 2.5340e-04
Validation rmse = 0.165907
Validation r2 = 0.670069
Validation mse = 0.027525
Epoch 35
Loss = 7.8162e-02, PNorm = 44.7398, GNorm = 2.2333, lr_0 = 2.4816e-04
Loss = 7.3089e-02, PNorm = 44.7493, GNorm = 0.4666, lr_0 = 2.4303e-04
Validation rmse = 0.134555
Validation r2 = 0.782984
Validation mse = 0.018105
Epoch 36
Loss = 9.6551e-02, PNorm = 44.7593, GNorm = 1.1763, lr_0 = 2.3751e-04
Loss = 8.2801e-02, PNorm = 44.7692, GNorm = 2.1836, lr_0 = 2.3260e-04
Validation rmse = 0.139160
Validation r2 = 0.767876
Validation mse = 0.019365
Epoch 37
Loss = 7.7806e-02, PNorm = 44.7784, GNorm = 0.7043, lr_0 = 2.2731e-04
Loss = 6.0830e-02, PNorm = 44.7848, GNorm = 1.3004, lr_0 = 2.2261e-04
Validation rmse = 0.156343
Validation r2 = 0.707013
Validation mse = 0.024443
Epoch 38
Loss = 6.7320e-02, PNorm = 44.7926, GNorm = 1.1405, lr_0 = 2.1801e-04
Loss = 6.8088e-02, PNorm = 44.7992, GNorm = 1.0849, lr_0 = 2.1350e-04
Validation rmse = 0.138122
Validation r2 = 0.771326
Validation mse = 0.019078
Epoch 39
Loss = 7.1031e-02, PNorm = 44.8073, GNorm = 0.3295, lr_0 = 2.0865e-04
Loss = 7.0075e-02, PNorm = 44.8154, GNorm = 0.9913, lr_0 = 2.0434e-04
Validation rmse = 0.154676
Validation r2 = 0.713229
Validation mse = 0.023925
Epoch 40
Loss = 6.4075e-02, PNorm = 44.8239, GNorm = 1.0960, lr_0 = 1.9969e-04
Loss = 7.3962e-02, PNorm = 44.8313, GNorm = 0.6334, lr_0 = 1.9556e-04
Validation rmse = 0.160621
Validation r2 = 0.690761
Validation mse = 0.025799
Epoch 41
Loss = 6.4266e-02, PNorm = 44.8374, GNorm = 0.3901, lr_0 = 1.9152e-04
Loss = 6.5966e-02, PNorm = 44.8432, GNorm = 1.3376, lr_0 = 1.8756e-04
Validation rmse = 0.168051
Validation r2 = 0.661490
Validation mse = 0.028241
Epoch 42
Loss = 6.4659e-02, PNorm = 44.8492, GNorm = 1.4210, lr_0 = 1.8330e-04
Loss = 7.6160e-02, PNorm = 44.8561, GNorm = 0.6651, lr_0 = 1.7951e-04
Loss = 5.8612e-02, PNorm = 44.8569, GNorm = 1.2297, lr_0 = 1.7913e-04
Validation rmse = 0.143806
Validation r2 = 0.752117
Validation mse = 0.020680
Epoch 43
Loss = 6.2591e-02, PNorm = 44.8649, GNorm = 0.8742, lr_0 = 1.7543e-04
Loss = 7.4660e-02, PNorm = 44.8711, GNorm = 0.9821, lr_0 = 1.7180e-04
Validation rmse = 0.134618
Validation r2 = 0.782782
Validation mse = 0.018122
Epoch 44
Loss = 6.2048e-02, PNorm = 44.8770, GNorm = 0.6595, lr_0 = 1.6825e-04
Validation rmse = 0.170961
Validation r2 = 0.649664
Validation mse = 0.029228
Epoch 45
Loss = 7.7662e-02, PNorm = 44.8837, GNorm = 1.1894, lr_0 = 1.6443e-04
Loss = 5.8516e-02, PNorm = 44.8902, GNorm = 0.6225, lr_0 = 1.6103e-04
Validation rmse = 0.146680
Validation r2 = 0.742110
Validation mse = 0.021515
Epoch 46
Loss = 4.1179e-02, PNorm = 44.8969, GNorm = 0.7704, lr_0 = 1.5737e-04
Loss = 6.8010e-02, PNorm = 44.9026, GNorm = 0.7724, lr_0 = 1.5411e-04
Validation rmse = 0.163329
Validation r2 = 0.680243
Validation mse = 0.026677
Epoch 47
Loss = 6.0004e-02, PNorm = 44.9086, GNorm = 1.0377, lr_0 = 1.5093e-04
Loss = 7.2763e-02, PNorm = 44.9149, GNorm = 2.3666, lr_0 = 1.4781e-04
Validation rmse = 0.173189
Validation r2 = 0.640472
Validation mse = 0.029994
Epoch 48
Loss = 7.7198e-02, PNorm = 44.9205, GNorm = 2.5668, lr_0 = 1.4445e-04
Loss = 5.9879e-02, PNorm = 44.9256, GNorm = 0.9130, lr_0 = 1.4146e-04
Validation rmse = 0.140577
Validation r2 = 0.763124
Validation mse = 0.019762
Epoch 49
Loss = 6.2637e-02, PNorm = 44.9315, GNorm = 0.5104, lr_0 = 1.3825e-04
Loss = 6.2378e-02, PNorm = 44.9359, GNorm = 2.0596, lr_0 = 1.3539e-04
Validation rmse = 0.169366
Validation r2 = 0.656172
Validation mse = 0.028685
Epoch 50
Loss = 6.8506e-02, PNorm = 44.9415, GNorm = 0.3684, lr_0 = 1.3259e-04
Loss = 6.5011e-02, PNorm = 44.9461, GNorm = 0.7407, lr_0 = 1.2985e-04
Validation rmse = 0.156007
Validation r2 = 0.708270
Validation mse = 0.024338
Epoch 51
Loss = 5.9879e-02, PNorm = 44.9512, GNorm = 0.4346, lr_0 = 1.2690e-04
Loss = 5.0809e-02, PNorm = 44.9559, GNorm = 0.7009, lr_0 = 1.2427e-04
Validation rmse = 0.147140
Validation r2 = 0.740490
Validation mse = 0.021650
Epoch 52
Loss = 6.8271e-02, PNorm = 44.9608, GNorm = 0.5278, lr_0 = 1.2145e-04
Loss = 4.9539e-02, PNorm = 44.9660, GNorm = 1.2498, lr_0 = 1.1894e-04
Validation rmse = 0.153626
Validation r2 = 0.717107
Validation mse = 0.023601
Epoch 53
Loss = 5.5758e-02, PNorm = 44.9710, GNorm = 0.7130, lr_0 = 1.1623e-04
Loss = 5.2025e-02, PNorm = 44.9761, GNorm = 0.7532, lr_0 = 1.1383e-04
Validation rmse = 0.160580
Validation r2 = 0.690916
Validation mse = 0.025786
Epoch 54
Loss = 5.3344e-02, PNorm = 44.9806, GNorm = 1.3359, lr_0 = 1.1148e-04
Loss = 5.6271e-02, PNorm = 44.9848, GNorm = 2.4978, lr_0 = 1.0917e-04
Validation rmse = 0.161513
Validation r2 = 0.687315
Validation mse = 0.026087
Epoch 55
Loss = 6.1662e-02, PNorm = 44.9889, GNorm = 0.9345, lr_0 = 1.0669e-04
Loss = 5.4217e-02, PNorm = 44.9930, GNorm = 1.0405, lr_0 = 1.0449e-04
Validation rmse = 0.147636
Validation r2 = 0.738739
Validation mse = 0.021796
Epoch 56
Loss = 5.7623e-02, PNorm = 44.9972, GNorm = 0.7668, lr_0 = 1.0211e-04
Loss = 5.2017e-02, PNorm = 45.0008, GNorm = 0.8291, lr_0 = 1.0000e-04
Validation rmse = 0.149777
Validation r2 = 0.731105
Validation mse = 0.022433
Epoch 57
Loss = 5.9991e-02, PNorm = 45.0049, GNorm = 0.8247, lr_0 = 1.0000e-04
Loss = 4.7631e-02, PNorm = 45.0091, GNorm = 1.6283, lr_0 = 1.0000e-04
Loss = 7.7660e-02, PNorm = 45.0094, GNorm = 1.2360, lr_0 = 1.0000e-04
Validation rmse = 0.155499
Validation r2 = 0.710170
Validation mse = 0.024180
Epoch 58
Loss = 5.5384e-02, PNorm = 45.0134, GNorm = 0.4896, lr_0 = 1.0000e-04
Validation rmse = 0.151569
Validation r2 = 0.724632
Validation mse = 0.022973
Epoch 59
Loss = 4.7934e-02, PNorm = 45.0182, GNorm = 1.0630, lr_0 = 1.0000e-04
Loss = 5.1555e-02, PNorm = 45.0222, GNorm = 2.1139, lr_0 = 1.0000e-04
Validation rmse = 0.157395
Validation r2 = 0.703059
Validation mse = 0.024773
Model 0 best validation rmse = 0.134555 on epoch 35
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.203966
Model 0 test r2 = 0.466398
Model 0 test mse = 0.041602
Ensemble test rmse = 0.203966
Ensemble test r2 = 0.466398
Ensemble test mse = 0.041602
Fold 6
Splitting data with seed 6
Total size = 976 | train size = 966 | val size = 10 | test size = 56
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.1886e-01, PNorm = 43.2636, GNorm = 5.0176, lr_0 = 3.6053e-04
Validation rmse = 0.262482
Validation r2 = 0.159893
Validation mse = 0.068897
Epoch 1
Loss = 1.0709e+00, PNorm = 43.2938, GNorm = 10.2399, lr_0 = 6.2105e-04
Loss = 5.8635e-01, PNorm = 43.3338, GNorm = 4.6556, lr_0 = 8.5789e-04
Validation rmse = 0.255357
Validation r2 = 0.204882
Validation mse = 0.065207
Epoch 2
Loss = 3.8888e-01, PNorm = 43.4014, GNorm = 4.8457, lr_0 = 9.8961e-04
Loss = 5.4377e-01, PNorm = 43.4736, GNorm = 3.8135, lr_0 = 9.6914e-04
Validation rmse = 0.215933
Validation r2 = 0.431445
Validation mse = 0.046627
Epoch 3
Loss = 3.8581e-01, PNorm = 43.5541, GNorm = 4.7465, lr_0 = 9.4712e-04
Loss = 3.7980e-01, PNorm = 43.6162, GNorm = 6.9537, lr_0 = 9.2754e-04
Validation rmse = 0.205663
Validation r2 = 0.484242
Validation mse = 0.042297
Epoch 4
Loss = 2.9318e-01, PNorm = 43.6727, GNorm = 4.4007, lr_0 = 9.0836e-04
Loss = 2.0622e-01, PNorm = 43.7228, GNorm = 1.7195, lr_0 = 8.8958e-04
Validation rmse = 0.101342
Validation r2 = 0.874769
Validation mse = 0.010270
Epoch 5
Loss = 1.8419e-01, PNorm = 43.7694, GNorm = 1.6769, lr_0 = 8.6936e-04
Loss = 2.0611e-01, PNorm = 43.8036, GNorm = 4.3142, lr_0 = 8.5139e-04
Validation rmse = 0.101542
Validation r2 = 0.874273
Validation mse = 0.010311
Epoch 6
Loss = 1.8428e-01, PNorm = 43.8383, GNorm = 2.3354, lr_0 = 8.3204e-04
Loss = 1.8624e-01, PNorm = 43.8702, GNorm = 6.6919, lr_0 = 8.1484e-04
Validation rmse = 0.113332
Validation r2 = 0.843383
Validation mse = 0.012844
Epoch 7
Loss = 2.6248e-01, PNorm = 43.9022, GNorm = 0.9454, lr_0 = 7.9799e-04
Loss = 2.3421e-01, PNorm = 43.9352, GNorm = 1.7595, lr_0 = 7.8149e-04
Validation rmse = 0.097472
Validation r2 = 0.884150
Validation mse = 0.009501
Epoch 8
Loss = 1.9274e-01, PNorm = 43.9697, GNorm = 5.0917, lr_0 = 7.6373e-04
Loss = 1.6712e-01, PNorm = 44.0008, GNorm = 3.6496, lr_0 = 7.4794e-04
Validation rmse = 0.083824
Validation r2 = 0.914321
Validation mse = 0.007027
Epoch 9
Loss = 1.4752e-01, PNorm = 44.0293, GNorm = 3.4904, lr_0 = 7.3094e-04
Loss = 1.4511e-01, PNorm = 44.0567, GNorm = 2.0480, lr_0 = 7.1583e-04
Validation rmse = 0.094167
Validation r2 = 0.891874
Validation mse = 0.008867
Epoch 10
Loss = 1.2919e-01, PNorm = 44.0745, GNorm = 1.5816, lr_0 = 7.0103e-04
Loss = 1.2726e-01, PNorm = 44.0948, GNorm = 1.6883, lr_0 = 6.8653e-04
Validation rmse = 0.110224
Validation r2 = 0.851854
Validation mse = 0.012149
Epoch 11
Loss = 1.4151e-01, PNorm = 44.1090, GNorm = 4.3360, lr_0 = 6.7093e-04
Loss = 1.3162e-01, PNorm = 44.1288, GNorm = 0.7201, lr_0 = 6.5706e-04
Validation rmse = 0.102595
Validation r2 = 0.871654
Validation mse = 0.010526
Epoch 12
Loss = 1.4686e-01, PNorm = 44.1487, GNorm = 2.4465, lr_0 = 6.4213e-04
Loss = 1.4508e-01, PNorm = 44.1710, GNorm = 1.5074, lr_0 = 6.2885e-04
Validation rmse = 0.107616
Validation r2 = 0.858784
Validation mse = 0.011581
Epoch 13
Loss = 1.2722e-01, PNorm = 44.1905, GNorm = 3.1024, lr_0 = 6.1585e-04
Loss = 1.1918e-01, PNorm = 44.2114, GNorm = 2.5003, lr_0 = 6.0311e-04
Loss = 1.1157e-01, PNorm = 44.2132, GNorm = 1.6858, lr_0 = 6.0185e-04
Validation rmse = 0.091464
Validation r2 = 0.897992
Validation mse = 0.008366
Epoch 14
Loss = 1.6906e-01, PNorm = 44.2345, GNorm = 4.8375, lr_0 = 5.8941e-04
Validation rmse = 0.099945
Validation r2 = 0.878197
Validation mse = 0.009989
Epoch 15
Loss = 1.1727e-01, PNorm = 44.2637, GNorm = 2.5398, lr_0 = 5.7602e-04
Loss = 1.1871e-01, PNorm = 44.2844, GNorm = 0.7123, lr_0 = 5.6411e-04
Validation rmse = 0.094233
Validation r2 = 0.891722
Validation mse = 0.008880
Epoch 16
Loss = 1.2955e-01, PNorm = 44.3002, GNorm = 2.7326, lr_0 = 5.5244e-04
Loss = 1.1365e-01, PNorm = 44.3190, GNorm = 1.0460, lr_0 = 5.4102e-04
Validation rmse = 0.089055
Validation r2 = 0.903295
Validation mse = 0.007931
Epoch 17
Loss = 1.0485e-01, PNorm = 44.3321, GNorm = 1.8087, lr_0 = 5.2873e-04
Loss = 1.0682e-01, PNorm = 44.3424, GNorm = 0.5414, lr_0 = 5.1779e-04
Validation rmse = 0.110431
Validation r2 = 0.851298
Validation mse = 0.012195
Epoch 18
Loss = 1.3069e-01, PNorm = 44.3606, GNorm = 4.1696, lr_0 = 5.0603e-04
Loss = 1.1022e-01, PNorm = 44.3775, GNorm = 0.9643, lr_0 = 4.9556e-04
Validation rmse = 0.077123
Validation r2 = 0.927473
Validation mse = 0.005948
Epoch 19
Loss = 1.1999e-01, PNorm = 44.3939, GNorm = 2.1542, lr_0 = 4.8532e-04
Loss = 1.0913e-01, PNorm = 44.4100, GNorm = 1.1648, lr_0 = 4.7528e-04
Validation rmse = 0.074188
Validation r2 = 0.932888
Validation mse = 0.005504
Epoch 20
Loss = 9.4376e-02, PNorm = 44.4263, GNorm = 2.5562, lr_0 = 4.6448e-04
Loss = 1.0021e-01, PNorm = 44.4381, GNorm = 0.7432, lr_0 = 4.5488e-04
Validation rmse = 0.107935
Validation r2 = 0.857944
Validation mse = 0.011650
Epoch 21
Loss = 1.0424e-01, PNorm = 44.4528, GNorm = 1.5943, lr_0 = 4.4454e-04
Loss = 9.5468e-02, PNorm = 44.4676, GNorm = 2.0860, lr_0 = 4.3535e-04
Validation rmse = 0.088727
Validation r2 = 0.904006
Validation mse = 0.007872
Epoch 22
Loss = 1.1259e-01, PNorm = 44.4773, GNorm = 0.9628, lr_0 = 4.2635e-04
Loss = 7.7190e-02, PNorm = 44.4911, GNorm = 2.0472, lr_0 = 4.1753e-04
Validation rmse = 0.084815
Validation r2 = 0.912284
Validation mse = 0.007194
Epoch 23
Loss = 8.1149e-02, PNorm = 44.5039, GNorm = 1.5714, lr_0 = 4.0804e-04
Loss = 9.4399e-02, PNorm = 44.5163, GNorm = 0.9708, lr_0 = 3.9961e-04
Validation rmse = 0.080690
Validation r2 = 0.920609
Validation mse = 0.006511
Epoch 24
Loss = 7.9767e-02, PNorm = 44.5289, GNorm = 0.9955, lr_0 = 3.9053e-04
Loss = 9.3192e-02, PNorm = 44.5416, GNorm = 1.1777, lr_0 = 3.8245e-04
Validation rmse = 0.083994
Validation r2 = 0.913974
Validation mse = 0.007055
Epoch 25
Loss = 8.7139e-02, PNorm = 44.5536, GNorm = 1.8170, lr_0 = 3.7454e-04
Loss = 7.7688e-02, PNorm = 44.5651, GNorm = 1.4811, lr_0 = 3.6680e-04
Validation rmse = 0.081792
Validation r2 = 0.918425
Validation mse = 0.006690
Epoch 26
Loss = 7.8560e-02, PNorm = 44.5759, GNorm = 0.7472, lr_0 = 3.5846e-04
Loss = 9.1341e-02, PNorm = 44.5850, GNorm = 0.7979, lr_0 = 3.5105e-04
Validation rmse = 0.090558
Validation r2 = 0.900002
Validation mse = 0.008201
Epoch 27
Loss = 7.9897e-02, PNorm = 44.5975, GNorm = 1.0660, lr_0 = 3.4308e-04
Loss = 9.5093e-02, PNorm = 44.6105, GNorm = 1.9093, lr_0 = 3.3598e-04
Loss = 2.4150e-01, PNorm = 44.6121, GNorm = 7.5047, lr_0 = 3.3528e-04
Validation rmse = 0.083372
Validation r2 = 0.915243
Validation mse = 0.006951
Epoch 28
Loss = 8.2838e-02, PNorm = 44.6249, GNorm = 1.2597, lr_0 = 3.2835e-04
Loss = 9.7715e-02, PNorm = 44.6378, GNorm = 2.2607, lr_0 = 3.2156e-04
Validation rmse = 0.080027
Validation r2 = 0.921907
Validation mse = 0.006404
Epoch 29
Loss = 9.6623e-02, PNorm = 44.6496, GNorm = 0.9686, lr_0 = 3.1491e-04
Validation rmse = 0.087587
Validation r2 = 0.906457
Validation mse = 0.007671
Epoch 30
Loss = 7.3559e-02, PNorm = 44.6600, GNorm = 1.2893, lr_0 = 3.0775e-04
Loss = 8.2442e-02, PNorm = 44.6676, GNorm = 0.6039, lr_0 = 3.0139e-04
Validation rmse = 0.084357
Validation r2 = 0.913228
Validation mse = 0.007116
Epoch 31
Loss = 8.6983e-02, PNorm = 44.6777, GNorm = 0.7208, lr_0 = 2.9454e-04
Loss = 8.5619e-02, PNorm = 44.6893, GNorm = 2.2943, lr_0 = 2.8845e-04
Validation rmse = 0.089102
Validation r2 = 0.903193
Validation mse = 0.007939
Epoch 32
Loss = 8.0796e-02, PNorm = 44.7007, GNorm = 1.1620, lr_0 = 2.8249e-04
Loss = 8.1186e-02, PNorm = 44.7111, GNorm = 1.3148, lr_0 = 2.7665e-04
Validation rmse = 0.088781
Validation r2 = 0.903889
Validation mse = 0.007882
Epoch 33
Loss = 6.0429e-02, PNorm = 44.7188, GNorm = 2.6343, lr_0 = 2.7036e-04
Loss = 8.1041e-02, PNorm = 44.7276, GNorm = 1.1969, lr_0 = 2.6477e-04
Validation rmse = 0.089055
Validation r2 = 0.903295
Validation mse = 0.007931
Epoch 34
Loss = 6.2720e-02, PNorm = 44.7368, GNorm = 1.6641, lr_0 = 2.5875e-04
Loss = 7.2619e-02, PNorm = 44.7444, GNorm = 1.7201, lr_0 = 2.5340e-04
Validation rmse = 0.080188
Validation r2 = 0.921594
Validation mse = 0.006430
Epoch 35
Loss = 7.4064e-02, PNorm = 44.7517, GNorm = 1.0912, lr_0 = 2.4816e-04
Loss = 7.4226e-02, PNorm = 44.7604, GNorm = 0.9515, lr_0 = 2.4303e-04
Validation rmse = 0.086754
Validation r2 = 0.908228
Validation mse = 0.007526
Epoch 36
Loss = 7.6784e-02, PNorm = 44.7692, GNorm = 1.2202, lr_0 = 2.3751e-04
Loss = 6.8682e-02, PNorm = 44.7769, GNorm = 0.6202, lr_0 = 2.3260e-04
Validation rmse = 0.084329
Validation r2 = 0.913285
Validation mse = 0.007111
Epoch 37
Loss = 6.0157e-02, PNorm = 44.7850, GNorm = 0.4664, lr_0 = 2.2731e-04
Loss = 7.0139e-02, PNorm = 44.7930, GNorm = 0.8127, lr_0 = 2.2261e-04
Validation rmse = 0.092734
Validation r2 = 0.895140
Validation mse = 0.008600
Epoch 38
Loss = 6.1513e-02, PNorm = 44.8002, GNorm = 0.6703, lr_0 = 2.1801e-04
Loss = 7.4550e-02, PNorm = 44.8064, GNorm = 2.2980, lr_0 = 2.1350e-04
Validation rmse = 0.080260
Validation r2 = 0.921453
Validation mse = 0.006442
Epoch 39
Loss = 7.0973e-02, PNorm = 44.8135, GNorm = 1.0204, lr_0 = 2.0865e-04
Loss = 6.9787e-02, PNorm = 44.8207, GNorm = 0.9674, lr_0 = 2.0434e-04
Validation rmse = 0.086542
Validation r2 = 0.908676
Validation mse = 0.007489
Epoch 40
Loss = 6.4397e-02, PNorm = 44.8285, GNorm = 0.7625, lr_0 = 1.9969e-04
Loss = 6.2438e-02, PNorm = 44.8354, GNorm = 1.1869, lr_0 = 1.9556e-04
Validation rmse = 0.090459
Validation r2 = 0.900222
Validation mse = 0.008183
Epoch 41
Loss = 7.0347e-02, PNorm = 44.8415, GNorm = 3.8151, lr_0 = 1.9152e-04
Loss = 7.5240e-02, PNorm = 44.8482, GNorm = 1.7064, lr_0 = 1.8756e-04
Validation rmse = 0.087988
Validation r2 = 0.905599
Validation mse = 0.007742
Epoch 42
Loss = 5.8720e-02, PNorm = 44.8556, GNorm = 0.8132, lr_0 = 1.8330e-04
Loss = 7.6463e-02, PNorm = 44.8612, GNorm = 1.0705, lr_0 = 1.7951e-04
Loss = 6.6882e-02, PNorm = 44.8618, GNorm = 0.8763, lr_0 = 1.7913e-04
Validation rmse = 0.090433
Validation r2 = 0.900279
Validation mse = 0.008178
Epoch 43
Loss = 6.6369e-02, PNorm = 44.8689, GNorm = 0.9996, lr_0 = 1.7543e-04
Loss = 6.3740e-02, PNorm = 44.8755, GNorm = 1.0406, lr_0 = 1.7180e-04
Validation rmse = 0.086017
Validation r2 = 0.909779
Validation mse = 0.007399
Epoch 44
Loss = 6.6463e-02, PNorm = 44.8818, GNorm = 0.6445, lr_0 = 1.6825e-04
Validation rmse = 0.087218
Validation r2 = 0.907243
Validation mse = 0.007607
Epoch 45
Loss = 4.5173e-02, PNorm = 44.8884, GNorm = 0.5114, lr_0 = 1.6443e-04
Loss = 6.5507e-02, PNorm = 44.8942, GNorm = 0.6628, lr_0 = 1.6103e-04
Validation rmse = 0.084123
Validation r2 = 0.913709
Validation mse = 0.007077
Epoch 46
Loss = 5.6497e-02, PNorm = 44.8995, GNorm = 0.8251, lr_0 = 1.5737e-04
Loss = 6.7946e-02, PNorm = 44.9042, GNorm = 1.4648, lr_0 = 1.5411e-04
Validation rmse = 0.100298
Validation r2 = 0.877335
Validation mse = 0.010060
Epoch 47
Loss = 6.6239e-02, PNorm = 44.9096, GNorm = 2.2554, lr_0 = 1.5093e-04
Loss = 6.4661e-02, PNorm = 44.9159, GNorm = 1.4314, lr_0 = 1.4781e-04
Validation rmse = 0.085455
Validation r2 = 0.910954
Validation mse = 0.007303
Epoch 48
Loss = 5.3000e-02, PNorm = 44.9220, GNorm = 1.5924, lr_0 = 1.4445e-04
Loss = 6.3687e-02, PNorm = 44.9277, GNorm = 0.6328, lr_0 = 1.4146e-04
Validation rmse = 0.086713
Validation r2 = 0.908313
Validation mse = 0.007519
Epoch 49
Loss = 5.2765e-02, PNorm = 44.9326, GNorm = 0.8370, lr_0 = 1.3825e-04
Loss = 5.8036e-02, PNorm = 44.9363, GNorm = 1.1244, lr_0 = 1.3539e-04
Validation rmse = 0.086627
Validation r2 = 0.908495
Validation mse = 0.007504
Epoch 50
Loss = 5.2839e-02, PNorm = 44.9407, GNorm = 1.0316, lr_0 = 1.3259e-04
Loss = 5.7156e-02, PNorm = 44.9444, GNorm = 1.1528, lr_0 = 1.2985e-04
Validation rmse = 0.082506
Validation r2 = 0.916995
Validation mse = 0.006807
Epoch 51
Loss = 4.9813e-02, PNorm = 44.9490, GNorm = 0.4842, lr_0 = 1.2690e-04
Loss = 6.4550e-02, PNorm = 44.9535, GNorm = 0.7453, lr_0 = 1.2427e-04
Validation rmse = 0.088776
Validation r2 = 0.903899
Validation mse = 0.007881
Epoch 52
Loss = 5.7512e-02, PNorm = 44.9581, GNorm = 1.1826, lr_0 = 1.2145e-04
Loss = 5.9609e-02, PNorm = 44.9619, GNorm = 0.8940, lr_0 = 1.1894e-04
Validation rmse = 0.087088
Validation r2 = 0.907519
Validation mse = 0.007584
Epoch 53
Loss = 5.6081e-02, PNorm = 44.9665, GNorm = 1.0723, lr_0 = 1.1623e-04
Loss = 5.4058e-02, PNorm = 44.9708, GNorm = 1.0521, lr_0 = 1.1383e-04
Validation rmse = 0.088610
Validation r2 = 0.904259
Validation mse = 0.007852
Epoch 54
Loss = 5.7056e-02, PNorm = 44.9746, GNorm = 1.4971, lr_0 = 1.1148e-04
Loss = 5.4938e-02, PNorm = 44.9790, GNorm = 1.2527, lr_0 = 1.0917e-04
Validation rmse = 0.081154
Validation r2 = 0.919693
Validation mse = 0.006586
Epoch 55
Loss = 5.5167e-02, PNorm = 44.9828, GNorm = 0.8485, lr_0 = 1.0669e-04
Loss = 5.2705e-02, PNorm = 44.9867, GNorm = 0.8720, lr_0 = 1.0449e-04
Validation rmse = 0.089528
Validation r2 = 0.902265
Validation mse = 0.008015
Epoch 56
Loss = 4.8549e-02, PNorm = 44.9902, GNorm = 0.6705, lr_0 = 1.0211e-04
Loss = 5.6533e-02, PNorm = 44.9932, GNorm = 0.4939, lr_0 = 1.0000e-04
Validation rmse = 0.091229
Validation r2 = 0.898516
Validation mse = 0.008323
Epoch 57
Loss = 6.1442e-02, PNorm = 44.9980, GNorm = 1.9159, lr_0 = 1.0000e-04
Loss = 5.5193e-02, PNorm = 45.0016, GNorm = 1.0778, lr_0 = 1.0000e-04
Loss = 3.2566e-02, PNorm = 45.0019, GNorm = 1.3538, lr_0 = 1.0000e-04
Validation rmse = 0.085447
Validation r2 = 0.910972
Validation mse = 0.007301
Epoch 58
Loss = 4.7670e-02, PNorm = 45.0049, GNorm = 1.0042, lr_0 = 1.0000e-04
Validation rmse = 0.080363
Validation r2 = 0.921252
Validation mse = 0.006458
Epoch 59
Loss = 5.5426e-02, PNorm = 45.0086, GNorm = 0.6910, lr_0 = 1.0000e-04
Loss = 5.5292e-02, PNorm = 45.0129, GNorm = 0.5537, lr_0 = 1.0000e-04
Validation rmse = 0.081968
Validation r2 = 0.918074
Validation mse = 0.006719
Model 0 best validation rmse = 0.074188 on epoch 19
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.131632
Model 0 test r2 = 0.777758
Model 0 test mse = 0.017327
Ensemble test rmse = 0.131632
Ensemble test r2 = 0.777758
Ensemble test mse = 0.017327
Fold 7
Splitting data with seed 7
Total size = 976 | train size = 966 | val size = 10 | test size = 56
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.4519e-01, PNorm = 43.2646, GNorm = 1.5204, lr_0 = 3.6053e-04
Validation rmse = 0.305008
Validation r2 = -0.615923
Validation mse = 0.093030
Epoch 1
Loss = 5.3967e-01, PNorm = 43.2898, GNorm = 4.6650, lr_0 = 6.2105e-04
Loss = 6.0212e-01, PNorm = 43.3349, GNorm = 9.6813, lr_0 = 8.5789e-04
Validation rmse = 0.187289
Validation r2 = 0.390713
Validation mse = 0.035077
Epoch 2
Loss = 4.3329e-01, PNorm = 43.4172, GNorm = 1.1347, lr_0 = 9.8961e-04
Loss = 4.2057e-01, PNorm = 43.4988, GNorm = 9.0167, lr_0 = 9.6914e-04
Validation rmse = 0.199194
Validation r2 = 0.310792
Validation mse = 0.039678
Epoch 3
Loss = 4.2116e-01, PNorm = 43.5920, GNorm = 6.0481, lr_0 = 9.4712e-04
Loss = 3.5099e-01, PNorm = 43.6702, GNorm = 6.1293, lr_0 = 9.2754e-04
Validation rmse = 0.192103
Validation r2 = 0.358990
Validation mse = 0.036903
Epoch 4
Loss = 3.5156e-01, PNorm = 43.7346, GNorm = 9.4685, lr_0 = 9.0836e-04
Loss = 2.6194e-01, PNorm = 43.7948, GNorm = 1.0093, lr_0 = 8.8958e-04
Validation rmse = 0.157179
Validation r2 = 0.570870
Validation mse = 0.024705
Epoch 5
Loss = 2.0703e-01, PNorm = 43.8374, GNorm = 1.6153, lr_0 = 8.6936e-04
Loss = 2.1971e-01, PNorm = 43.8799, GNorm = 2.1813, lr_0 = 8.5139e-04
Validation rmse = 0.162746
Validation r2 = 0.539938
Validation mse = 0.026486
Epoch 6
Loss = 2.2722e-01, PNorm = 43.9170, GNorm = 9.3971, lr_0 = 8.3204e-04
Loss = 2.1079e-01, PNorm = 43.9576, GNorm = 2.9795, lr_0 = 8.1484e-04
Validation rmse = 0.190303
Validation r2 = 0.370946
Validation mse = 0.036215
Epoch 7
Loss = 1.7052e-01, PNorm = 43.9829, GNorm = 3.4437, lr_0 = 7.9799e-04
Loss = 1.6541e-01, PNorm = 44.0110, GNorm = 2.8837, lr_0 = 7.8149e-04
Validation rmse = 0.147238
Validation r2 = 0.623437
Validation mse = 0.021679
Epoch 8
Loss = 1.6673e-01, PNorm = 44.0497, GNorm = 3.4581, lr_0 = 7.6373e-04
Loss = 1.4373e-01, PNorm = 44.0755, GNorm = 2.2818, lr_0 = 7.4794e-04
Validation rmse = 0.205971
Validation r2 = 0.263096
Validation mse = 0.042424
Epoch 9
Loss = 1.6477e-01, PNorm = 44.0940, GNorm = 1.0505, lr_0 = 7.3094e-04
Loss = 1.5083e-01, PNorm = 44.1147, GNorm = 5.1412, lr_0 = 7.1583e-04
Validation rmse = 0.149613
Validation r2 = 0.611191
Validation mse = 0.022384
Epoch 10
Loss = 1.2375e-01, PNorm = 44.1411, GNorm = 2.0791, lr_0 = 7.0103e-04
Loss = 1.6874e-01, PNorm = 44.1646, GNorm = 2.9790, lr_0 = 6.8653e-04
Validation rmse = 0.153985
Validation r2 = 0.588133
Validation mse = 0.023712
Epoch 11
Loss = 1.0880e-01, PNorm = 44.1799, GNorm = 0.6532, lr_0 = 6.7093e-04
Loss = 1.3636e-01, PNorm = 44.1967, GNorm = 0.9152, lr_0 = 6.5706e-04
Validation rmse = 0.175742
Validation r2 = 0.463525
Validation mse = 0.030885
Epoch 12
Loss = 1.2738e-01, PNorm = 44.2214, GNorm = 2.8324, lr_0 = 6.4213e-04
Loss = 1.4850e-01, PNorm = 44.2373, GNorm = 1.8356, lr_0 = 6.2885e-04
Validation rmse = 0.157795
Validation r2 = 0.567499
Validation mse = 0.024899
Epoch 13
Loss = 1.5220e-01, PNorm = 44.2524, GNorm = 0.8417, lr_0 = 6.1585e-04
Loss = 1.3719e-01, PNorm = 44.2763, GNorm = 1.9477, lr_0 = 6.0311e-04
Loss = 2.1861e-01, PNorm = 44.2791, GNorm = 2.8526, lr_0 = 6.0185e-04
Validation rmse = 0.187050
Validation r2 = 0.392267
Validation mse = 0.034988
Epoch 14
Loss = 1.1394e-01, PNorm = 44.3034, GNorm = 0.9669, lr_0 = 5.8941e-04
Validation rmse = 0.146683
Validation r2 = 0.626271
Validation mse = 0.021516
Epoch 15
Loss = 9.9914e-02, PNorm = 44.3224, GNorm = 2.9523, lr_0 = 5.7602e-04
Loss = 1.3992e-01, PNorm = 44.3354, GNorm = 1.8363, lr_0 = 5.6411e-04
Validation rmse = 0.144723
Validation r2 = 0.636190
Validation mse = 0.020945
Epoch 16
Loss = 1.4752e-01, PNorm = 44.3541, GNorm = 3.8803, lr_0 = 5.5244e-04
Loss = 1.1229e-01, PNorm = 44.3748, GNorm = 0.8313, lr_0 = 5.4102e-04
Validation rmse = 0.166610
Validation r2 = 0.517833
Validation mse = 0.027759
Epoch 17
Loss = 9.0253e-02, PNorm = 44.3907, GNorm = 1.7633, lr_0 = 5.2873e-04
Loss = 1.0629e-01, PNorm = 44.4075, GNorm = 1.8059, lr_0 = 5.1779e-04
Validation rmse = 0.164530
Validation r2 = 0.529796
Validation mse = 0.027070
Epoch 18
Loss = 8.8047e-02, PNorm = 44.4205, GNorm = 1.2023, lr_0 = 5.0603e-04
Loss = 1.1438e-01, PNorm = 44.4336, GNorm = 1.3164, lr_0 = 4.9556e-04
Validation rmse = 0.147703
Validation r2 = 0.621055
Validation mse = 0.021816
Epoch 19
Loss = 1.0677e-01, PNorm = 44.4441, GNorm = 3.5196, lr_0 = 4.8532e-04
Loss = 1.0409e-01, PNorm = 44.4580, GNorm = 0.6748, lr_0 = 4.7528e-04
Validation rmse = 0.163434
Validation r2 = 0.536039
Validation mse = 0.026711
Epoch 20
Loss = 8.7046e-02, PNorm = 44.4727, GNorm = 0.8463, lr_0 = 4.6448e-04
Loss = 1.0451e-01, PNorm = 44.4844, GNorm = 0.4701, lr_0 = 4.5488e-04
Validation rmse = 0.193881
Validation r2 = 0.347069
Validation mse = 0.037590
Epoch 21
Loss = 1.1453e-01, PNorm = 44.5018, GNorm = 4.3617, lr_0 = 4.4454e-04
Loss = 1.0834e-01, PNorm = 44.5142, GNorm = 2.8275, lr_0 = 4.3535e-04
Validation rmse = 0.160562
Validation r2 = 0.552201
Validation mse = 0.025780
Epoch 22
Loss = 9.8181e-02, PNorm = 44.5260, GNorm = 2.2237, lr_0 = 4.2635e-04
Loss = 1.2383e-01, PNorm = 44.5414, GNorm = 1.2097, lr_0 = 4.1753e-04
Validation rmse = 0.160231
Validation r2 = 0.554047
Validation mse = 0.025674
Epoch 23
Loss = 1.0079e-01, PNorm = 44.5531, GNorm = 2.0513, lr_0 = 4.0804e-04
Loss = 9.0793e-02, PNorm = 44.5651, GNorm = 0.9201, lr_0 = 3.9961e-04
Validation rmse = 0.168237
Validation r2 = 0.508368
Validation mse = 0.028304
Epoch 24
Loss = 7.8928e-02, PNorm = 44.5768, GNorm = 0.9244, lr_0 = 3.9053e-04
Loss = 9.5771e-02, PNorm = 44.5862, GNorm = 0.9224, lr_0 = 3.8245e-04
Validation rmse = 0.146073
Validation r2 = 0.629374
Validation mse = 0.021337
Epoch 25
Loss = 8.6100e-02, PNorm = 44.5954, GNorm = 1.0666, lr_0 = 3.7454e-04
Loss = 9.0077e-02, PNorm = 44.6078, GNorm = 1.5570, lr_0 = 3.6680e-04
Validation rmse = 0.171747
Validation r2 = 0.487638
Validation mse = 0.029497
Epoch 26
Loss = 8.1685e-02, PNorm = 44.6190, GNorm = 2.1444, lr_0 = 3.5846e-04
Loss = 9.9870e-02, PNorm = 44.6276, GNorm = 0.5403, lr_0 = 3.5105e-04
Validation rmse = 0.159542
Validation r2 = 0.557873
Validation mse = 0.025454
Epoch 27
Loss = 8.5216e-02, PNorm = 44.6396, GNorm = 0.5015, lr_0 = 3.4308e-04
Loss = 8.3429e-02, PNorm = 44.6507, GNorm = 1.4203, lr_0 = 3.3598e-04
Loss = 8.9470e-02, PNorm = 44.6518, GNorm = 1.1572, lr_0 = 3.3528e-04
Validation rmse = 0.160558
Validation r2 = 0.552225
Validation mse = 0.025779
Epoch 28
Loss = 7.1225e-02, PNorm = 44.6618, GNorm = 1.6964, lr_0 = 3.2835e-04
Loss = 9.1758e-02, PNorm = 44.6701, GNorm = 2.0018, lr_0 = 3.2156e-04
Validation rmse = 0.166803
Validation r2 = 0.516711
Validation mse = 0.027823
Epoch 29
Loss = 8.2936e-02, PNorm = 44.6814, GNorm = 0.5784, lr_0 = 3.1491e-04
Validation rmse = 0.168149
Validation r2 = 0.508881
Validation mse = 0.028274
Epoch 30
Loss = 4.4570e-02, PNorm = 44.6893, GNorm = 0.6605, lr_0 = 3.0775e-04
Loss = 7.6842e-02, PNorm = 44.6964, GNorm = 1.5261, lr_0 = 3.0139e-04
Validation rmse = 0.172720
Validation r2 = 0.481818
Validation mse = 0.029832
Epoch 31
Loss = 8.0911e-02, PNorm = 44.7068, GNorm = 0.6348, lr_0 = 2.9454e-04
Loss = 8.6416e-02, PNorm = 44.7149, GNorm = 1.4597, lr_0 = 2.8845e-04
Validation rmse = 0.178741
Validation r2 = 0.445062
Validation mse = 0.031948
Epoch 32
Loss = 1.1401e-01, PNorm = 44.7237, GNorm = 0.9560, lr_0 = 2.8249e-04
Loss = 7.3897e-02, PNorm = 44.7324, GNorm = 1.2615, lr_0 = 2.7665e-04
Validation rmse = 0.165959
Validation r2 = 0.521591
Validation mse = 0.027542
Epoch 33
Loss = 5.8913e-02, PNorm = 44.7422, GNorm = 0.8419, lr_0 = 2.7036e-04
Loss = 8.8020e-02, PNorm = 44.7505, GNorm = 0.6686, lr_0 = 2.6477e-04
Validation rmse = 0.155978
Validation r2 = 0.577403
Validation mse = 0.024329
Epoch 34
Loss = 7.8497e-02, PNorm = 44.7598, GNorm = 0.9400, lr_0 = 2.5875e-04
Loss = 8.3783e-02, PNorm = 44.7683, GNorm = 1.1145, lr_0 = 2.5340e-04
Validation rmse = 0.176527
Validation r2 = 0.458721
Validation mse = 0.031162
Epoch 35
Loss = 5.9118e-02, PNorm = 44.7778, GNorm = 1.0372, lr_0 = 2.4816e-04
Loss = 7.1702e-02, PNorm = 44.7848, GNorm = 1.1425, lr_0 = 2.4303e-04
Validation rmse = 0.159010
Validation r2 = 0.560815
Validation mse = 0.025284
Epoch 36
Loss = 7.0245e-02, PNorm = 44.7903, GNorm = 0.9155, lr_0 = 2.3751e-04
Loss = 8.2670e-02, PNorm = 44.7982, GNorm = 0.8296, lr_0 = 2.3260e-04
Validation rmse = 0.167442
Validation r2 = 0.513005
Validation mse = 0.028037
Epoch 37
Loss = 5.9249e-02, PNorm = 44.8052, GNorm = 0.7409, lr_0 = 2.2731e-04
Loss = 8.4061e-02, PNorm = 44.8132, GNorm = 1.0501, lr_0 = 2.2261e-04
Validation rmse = 0.155892
Validation r2 = 0.577869
Validation mse = 0.024302
Epoch 38
Loss = 7.5495e-02, PNorm = 44.8227, GNorm = 0.3660, lr_0 = 2.1801e-04
Loss = 7.3039e-02, PNorm = 44.8299, GNorm = 2.1067, lr_0 = 2.1350e-04
Validation rmse = 0.165568
Validation r2 = 0.523844
Validation mse = 0.027413
Epoch 39
Loss = 6.4241e-02, PNorm = 44.8383, GNorm = 0.7029, lr_0 = 2.0865e-04
Loss = 7.1409e-02, PNorm = 44.8443, GNorm = 1.9440, lr_0 = 2.0434e-04
Validation rmse = 0.162227
Validation r2 = 0.542864
Validation mse = 0.026318
Epoch 40
Loss = 6.1348e-02, PNorm = 44.8510, GNorm = 0.5236, lr_0 = 1.9969e-04
Loss = 7.0943e-02, PNorm = 44.8573, GNorm = 0.6467, lr_0 = 1.9556e-04
Validation rmse = 0.176809
Validation r2 = 0.456993
Validation mse = 0.031261
Epoch 41
Loss = 6.8148e-02, PNorm = 44.8609, GNorm = 0.9410, lr_0 = 1.9152e-04
Loss = 6.4029e-02, PNorm = 44.8677, GNorm = 2.8473, lr_0 = 1.8756e-04
Validation rmse = 0.175485
Validation r2 = 0.465095
Validation mse = 0.030795
Epoch 42
Loss = 6.2530e-02, PNorm = 44.8757, GNorm = 1.3908, lr_0 = 1.8330e-04
Loss = 7.4442e-02, PNorm = 44.8821, GNorm = 0.7362, lr_0 = 1.7951e-04
Loss = 8.5993e-02, PNorm = 44.8824, GNorm = 1.5072, lr_0 = 1.7913e-04
Validation rmse = 0.178299
Validation r2 = 0.447803
Validation mse = 0.031790
Epoch 43
Loss = 6.9084e-02, PNorm = 44.8880, GNorm = 1.2106, lr_0 = 1.7543e-04
Loss = 6.2483e-02, PNorm = 44.8943, GNorm = 1.4035, lr_0 = 1.7180e-04
Validation rmse = 0.163157
Validation r2 = 0.537611
Validation mse = 0.026620
Epoch 44
Loss = 6.1239e-02, PNorm = 44.8997, GNorm = 0.9683, lr_0 = 1.6825e-04
Validation rmse = 0.166793
Validation r2 = 0.516769
Validation mse = 0.027820
Epoch 45
Loss = 6.8683e-02, PNorm = 44.9061, GNorm = 1.1008, lr_0 = 1.6443e-04
Loss = 6.1126e-02, PNorm = 44.9118, GNorm = 0.7593, lr_0 = 1.6103e-04
Validation rmse = 0.185652
Validation r2 = 0.401317
Validation mse = 0.034467
Epoch 46
Loss = 5.6481e-02, PNorm = 44.9180, GNorm = 0.6090, lr_0 = 1.5737e-04
Loss = 5.9706e-02, PNorm = 44.9226, GNorm = 1.6608, lr_0 = 1.5411e-04
Validation rmse = 0.162791
Validation r2 = 0.539679
Validation mse = 0.026501
Epoch 47
Loss = 7.1410e-02, PNorm = 44.9286, GNorm = 0.5916, lr_0 = 1.5093e-04
Loss = 5.1306e-02, PNorm = 44.9336, GNorm = 0.8882, lr_0 = 1.4781e-04
Validation rmse = 0.163706
Validation r2 = 0.534490
Validation mse = 0.026800
Epoch 48
Loss = 5.7120e-02, PNorm = 44.9399, GNorm = 0.7259, lr_0 = 1.4445e-04
Loss = 6.1732e-02, PNorm = 44.9446, GNorm = 0.5954, lr_0 = 1.4146e-04
Validation rmse = 0.170796
Validation r2 = 0.493300
Validation mse = 0.029171
Epoch 49
Loss = 5.1473e-02, PNorm = 44.9510, GNorm = 0.6370, lr_0 = 1.3825e-04
Loss = 5.8773e-02, PNorm = 44.9561, GNorm = 0.6233, lr_0 = 1.3539e-04
Validation rmse = 0.179209
Validation r2 = 0.442150
Validation mse = 0.032116
Epoch 50
Loss = 7.2261e-02, PNorm = 44.9600, GNorm = 0.8603, lr_0 = 1.3259e-04
Loss = 5.2975e-02, PNorm = 44.9652, GNorm = 1.8243, lr_0 = 1.2985e-04
Validation rmse = 0.161902
Validation r2 = 0.544697
Validation mse = 0.026212
Epoch 51
Loss = 6.4029e-02, PNorm = 44.9707, GNorm = 1.9681, lr_0 = 1.2690e-04
Loss = 5.4574e-02, PNorm = 44.9747, GNorm = 1.1494, lr_0 = 1.2427e-04
Validation rmse = 0.170181
Validation r2 = 0.496941
Validation mse = 0.028962
Epoch 52
Loss = 5.1314e-02, PNorm = 44.9799, GNorm = 0.6792, lr_0 = 1.2145e-04
Loss = 5.3867e-02, PNorm = 44.9847, GNorm = 0.9569, lr_0 = 1.1894e-04
Validation rmse = 0.179283
Validation r2 = 0.441692
Validation mse = 0.032142
Epoch 53
Loss = 5.6717e-02, PNorm = 44.9894, GNorm = 0.8165, lr_0 = 1.1623e-04
Loss = 5.3313e-02, PNorm = 44.9937, GNorm = 0.7618, lr_0 = 1.1383e-04
Validation rmse = 0.161930
Validation r2 = 0.544538
Validation mse = 0.026221
Epoch 54
Loss = 5.6481e-02, PNorm = 44.9975, GNorm = 0.9305, lr_0 = 1.1148e-04
Loss = 5.1240e-02, PNorm = 45.0015, GNorm = 0.4113, lr_0 = 1.0917e-04
Validation rmse = 0.180793
Validation r2 = 0.432246
Validation mse = 0.032686
Epoch 55
Loss = 5.6209e-02, PNorm = 45.0062, GNorm = 0.4767, lr_0 = 1.0669e-04
Loss = 4.4912e-02, PNorm = 45.0107, GNorm = 0.4749, lr_0 = 1.0449e-04
Validation rmse = 0.174433
Validation r2 = 0.471490
Validation mse = 0.030427
Epoch 56
Loss = 5.1266e-02, PNorm = 45.0143, GNorm = 0.5213, lr_0 = 1.0211e-04
Loss = 5.4818e-02, PNorm = 45.0179, GNorm = 1.2481, lr_0 = 1.0000e-04
Validation rmse = 0.176248
Validation r2 = 0.460434
Validation mse = 0.031063
Epoch 57
Loss = 5.3869e-02, PNorm = 45.0224, GNorm = 1.3466, lr_0 = 1.0000e-04
Loss = 5.3319e-02, PNorm = 45.0267, GNorm = 0.6213, lr_0 = 1.0000e-04
Loss = 4.6592e-02, PNorm = 45.0271, GNorm = 0.7669, lr_0 = 1.0000e-04
Validation rmse = 0.172030
Validation r2 = 0.485951
Validation mse = 0.029594
Epoch 58
Loss = 5.3584e-02, PNorm = 45.0311, GNorm = 0.8134, lr_0 = 1.0000e-04
Validation rmse = 0.176447
Validation r2 = 0.459210
Validation mse = 0.031134
Epoch 59
Loss = 6.1257e-02, PNorm = 45.0355, GNorm = 0.9594, lr_0 = 1.0000e-04
Loss = 5.4972e-02, PNorm = 45.0396, GNorm = 0.5574, lr_0 = 1.0000e-04
Validation rmse = 0.172572
Validation r2 = 0.482702
Validation mse = 0.029781
Model 0 best validation rmse = 0.144723 on epoch 15
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.111782
Model 0 test r2 = 0.839732
Model 0 test mse = 0.012495
Ensemble test rmse = 0.111782
Ensemble test r2 = 0.839732
Ensemble test mse = 0.012495
Fold 8
Splitting data with seed 8
Total size = 976 | train size = 966 | val size = 10 | test size = 56
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.7984e-01, PNorm = 43.2622, GNorm = 1.2846, lr_0 = 3.6053e-04
Validation rmse = 0.422288
Validation r2 = -0.292016
Validation mse = 0.178327
Epoch 1
Loss = 9.4314e-01, PNorm = 43.2971, GNorm = 19.7462, lr_0 = 6.2105e-04
Loss = 7.9870e-01, PNorm = 43.3252, GNorm = 1.8621, lr_0 = 8.5789e-04
Validation rmse = 0.317764
Validation r2 = 0.268424
Validation mse = 0.100974
Epoch 2
Loss = 4.3837e-01, PNorm = 43.3977, GNorm = 3.7147, lr_0 = 9.8961e-04
Loss = 4.1851e-01, PNorm = 43.4856, GNorm = 2.3376, lr_0 = 9.6914e-04
Validation rmse = 0.314417
Validation r2 = 0.283751
Validation mse = 0.098858
Epoch 3
Loss = 2.9158e-01, PNorm = 43.5651, GNorm = 8.3421, lr_0 = 9.4712e-04
Loss = 3.0003e-01, PNorm = 43.6272, GNorm = 0.8240, lr_0 = 9.2754e-04
Validation rmse = 0.334818
Validation r2 = 0.187788
Validation mse = 0.112103
Epoch 4
Loss = 3.9870e-01, PNorm = 43.6827, GNorm = 12.0662, lr_0 = 9.0836e-04
Loss = 3.0517e-01, PNorm = 43.7348, GNorm = 5.1533, lr_0 = 8.8958e-04
Validation rmse = 0.217823
Validation r2 = 0.656236
Validation mse = 0.047447
Epoch 5
Loss = 2.2555e-01, PNorm = 43.7807, GNorm = 6.1677, lr_0 = 8.6936e-04
Loss = 1.9958e-01, PNorm = 43.8199, GNorm = 3.4791, lr_0 = 8.5139e-04
Validation rmse = 0.188504
Validation r2 = 0.742549
Validation mse = 0.035534
Epoch 6
Loss = 2.1805e-01, PNorm = 43.8423, GNorm = 4.0540, lr_0 = 8.3204e-04
Loss = 1.8008e-01, PNorm = 43.8700, GNorm = 2.7096, lr_0 = 8.1484e-04
Validation rmse = 0.155170
Validation r2 = 0.825553
Validation mse = 0.024078
Epoch 7
Loss = 1.7644e-01, PNorm = 43.8951, GNorm = 2.1537, lr_0 = 7.9799e-04
Loss = 1.8681e-01, PNorm = 43.9226, GNorm = 7.1751, lr_0 = 7.8149e-04
Validation rmse = 0.154528
Validation r2 = 0.826992
Validation mse = 0.023879
Epoch 8
Loss = 1.6511e-01, PNorm = 43.9436, GNorm = 3.7556, lr_0 = 7.6373e-04
Loss = 2.0666e-01, PNorm = 43.9736, GNorm = 2.9433, lr_0 = 7.4794e-04
Validation rmse = 0.188310
Validation r2 = 0.743079
Validation mse = 0.035461
Epoch 9
Loss = 2.0041e-01, PNorm = 44.0065, GNorm = 2.9881, lr_0 = 7.3094e-04
Loss = 1.5687e-01, PNorm = 44.0348, GNorm = 1.8576, lr_0 = 7.1583e-04
Validation rmse = 0.158215
Validation r2 = 0.818637
Validation mse = 0.025032
Epoch 10
Loss = 1.5191e-01, PNorm = 44.0593, GNorm = 0.9577, lr_0 = 7.0103e-04
Loss = 1.2677e-01, PNorm = 44.0789, GNorm = 1.9295, lr_0 = 6.8653e-04
Validation rmse = 0.118312
Validation r2 = 0.898584
Validation mse = 0.013998
Epoch 11
Loss = 1.2911e-01, PNorm = 44.0932, GNorm = 0.8753, lr_0 = 6.7093e-04
Loss = 1.2212e-01, PNorm = 44.1111, GNorm = 1.3633, lr_0 = 6.5706e-04
Validation rmse = 0.111188
Validation r2 = 0.910429
Validation mse = 0.012363
Epoch 12
Loss = 1.4210e-01, PNorm = 44.1344, GNorm = 2.0671, lr_0 = 6.4213e-04
Loss = 1.1289e-01, PNorm = 44.1480, GNorm = 0.4310, lr_0 = 6.2885e-04
Validation rmse = 0.121462
Validation r2 = 0.893111
Validation mse = 0.014753
Epoch 13
Loss = 1.2234e-01, PNorm = 44.1659, GNorm = 1.0706, lr_0 = 6.1585e-04
Loss = 1.1936e-01, PNorm = 44.1813, GNorm = 0.7536, lr_0 = 6.0311e-04
Loss = 8.1460e-02, PNorm = 44.1829, GNorm = 1.0186, lr_0 = 6.0185e-04
Validation rmse = 0.094152
Validation r2 = 0.935773
Validation mse = 0.008865
Epoch 14
Loss = 1.1202e-01, PNorm = 44.1960, GNorm = 1.3207, lr_0 = 5.8941e-04
Validation rmse = 0.177833
Validation r2 = 0.770874
Validation mse = 0.031624
Epoch 15
Loss = 1.3640e-01, PNorm = 44.2120, GNorm = 3.4357, lr_0 = 5.7602e-04
Loss = 1.1561e-01, PNorm = 44.2301, GNorm = 2.5371, lr_0 = 5.6411e-04
Validation rmse = 0.139923
Validation r2 = 0.858150
Validation mse = 0.019578
Epoch 16
Loss = 1.1129e-01, PNorm = 44.2453, GNorm = 3.0439, lr_0 = 5.5244e-04
Loss = 1.2992e-01, PNorm = 44.2569, GNorm = 3.5392, lr_0 = 5.4102e-04
Validation rmse = 0.155164
Validation r2 = 0.825565
Validation mse = 0.024076
Epoch 17
Loss = 9.8976e-02, PNorm = 44.2756, GNorm = 1.7794, lr_0 = 5.2873e-04
Loss = 1.1050e-01, PNorm = 44.2905, GNorm = 3.6071, lr_0 = 5.1779e-04
Validation rmse = 0.128406
Validation r2 = 0.880540
Validation mse = 0.016488
Epoch 18
Loss = 1.3607e-01, PNorm = 44.3049, GNorm = 2.2781, lr_0 = 5.0603e-04
Loss = 1.1085e-01, PNorm = 44.3198, GNorm = 1.1172, lr_0 = 4.9556e-04
Validation rmse = 0.098925
Validation r2 = 0.929097
Validation mse = 0.009786
Epoch 19
Loss = 9.8689e-02, PNorm = 44.3347, GNorm = 1.7125, lr_0 = 4.8532e-04
Loss = 1.0055e-01, PNorm = 44.3461, GNorm = 2.7383, lr_0 = 4.7528e-04
Validation rmse = 0.102442
Validation r2 = 0.923966
Validation mse = 0.010494
Epoch 20
Loss = 1.4312e-01, PNorm = 44.3611, GNorm = 2.5887, lr_0 = 4.6448e-04
Loss = 1.1858e-01, PNorm = 44.3755, GNorm = 5.3933, lr_0 = 4.5488e-04
Validation rmse = 0.112356
Validation r2 = 0.908538
Validation mse = 0.012624
Epoch 21
Loss = 1.0846e-01, PNorm = 44.3956, GNorm = 2.2049, lr_0 = 4.4454e-04
Loss = 9.5346e-02, PNorm = 44.4124, GNorm = 1.5631, lr_0 = 4.3535e-04
Validation rmse = 0.097063
Validation r2 = 0.931742
Validation mse = 0.009421
Epoch 22
Loss = 1.0467e-01, PNorm = 44.4241, GNorm = 0.6783, lr_0 = 4.2635e-04
Loss = 1.0056e-01, PNorm = 44.4384, GNorm = 2.6375, lr_0 = 4.1753e-04
Validation rmse = 0.105369
Validation r2 = 0.919560
Validation mse = 0.011103
Epoch 23
Loss = 1.0389e-01, PNorm = 44.4512, GNorm = 0.4389, lr_0 = 4.0804e-04
Loss = 1.0026e-01, PNorm = 44.4645, GNorm = 1.2295, lr_0 = 3.9961e-04
Validation rmse = 0.126876
Validation r2 = 0.883370
Validation mse = 0.016097
Epoch 24
Loss = 9.1977e-02, PNorm = 44.4766, GNorm = 1.1783, lr_0 = 3.9053e-04
Loss = 9.9098e-02, PNorm = 44.4894, GNorm = 1.0194, lr_0 = 3.8245e-04
Validation rmse = 0.112032
Validation r2 = 0.909065
Validation mse = 0.012551
Epoch 25
Loss = 9.7451e-02, PNorm = 44.5032, GNorm = 0.7370, lr_0 = 3.7454e-04
Loss = 8.7592e-02, PNorm = 44.5157, GNorm = 0.6969, lr_0 = 3.6680e-04
Validation rmse = 0.100532
Validation r2 = 0.926774
Validation mse = 0.010107
Epoch 26
Loss = 9.0107e-02, PNorm = 44.5285, GNorm = 1.5690, lr_0 = 3.5846e-04
Loss = 9.6903e-02, PNorm = 44.5405, GNorm = 1.0767, lr_0 = 3.5105e-04
Validation rmse = 0.118572
Validation r2 = 0.898136
Validation mse = 0.014059
Epoch 27
Loss = 1.0191e-01, PNorm = 44.5535, GNorm = 0.8076, lr_0 = 3.4308e-04
Loss = 9.0776e-02, PNorm = 44.5635, GNorm = 1.2028, lr_0 = 3.3598e-04
Loss = 1.9337e-01, PNorm = 44.5644, GNorm = 4.5471, lr_0 = 3.3528e-04
Validation rmse = 0.125401
Validation r2 = 0.886066
Validation mse = 0.015725
Epoch 28
Loss = 8.7737e-02, PNorm = 44.5749, GNorm = 1.8009, lr_0 = 3.2835e-04
Loss = 1.0535e-01, PNorm = 44.5884, GNorm = 2.6578, lr_0 = 3.2156e-04
Validation rmse = 0.098965
Validation r2 = 0.929040
Validation mse = 0.009794
Epoch 29
Loss = 8.4878e-02, PNorm = 44.5999, GNorm = 2.7682, lr_0 = 3.1491e-04
Validation rmse = 0.117334
Validation r2 = 0.900254
Validation mse = 0.013767
Epoch 30
Loss = 8.3479e-02, PNorm = 44.6113, GNorm = 0.6853, lr_0 = 3.0775e-04
Loss = 8.3018e-02, PNorm = 44.6197, GNorm = 1.2943, lr_0 = 3.0139e-04
Validation rmse = 0.089474
Validation r2 = 0.941998
Validation mse = 0.008006
Epoch 31
Loss = 7.3297e-02, PNorm = 44.6310, GNorm = 0.9098, lr_0 = 2.9454e-04
Loss = 7.8590e-02, PNorm = 44.6399, GNorm = 1.1271, lr_0 = 2.8845e-04
Validation rmse = 0.109150
Validation r2 = 0.913682
Validation mse = 0.011914
Epoch 32
Loss = 1.1305e-01, PNorm = 44.6486, GNorm = 1.8329, lr_0 = 2.8249e-04
Loss = 7.1385e-02, PNorm = 44.6581, GNorm = 1.8102, lr_0 = 2.7665e-04
Validation rmse = 0.099604
Validation r2 = 0.928120
Validation mse = 0.009921
Epoch 33
Loss = 8.2447e-02, PNorm = 44.6683, GNorm = 0.4494, lr_0 = 2.7036e-04
Loss = 8.6723e-02, PNorm = 44.6781, GNorm = 1.9251, lr_0 = 2.6477e-04
Validation rmse = 0.089041
Validation r2 = 0.942557
Validation mse = 0.007928
Epoch 34
Loss = 6.8105e-02, PNorm = 44.6859, GNorm = 0.9307, lr_0 = 2.5875e-04
Loss = 8.0197e-02, PNorm = 44.6933, GNorm = 1.2734, lr_0 = 2.5340e-04
Validation rmse = 0.125044
Validation r2 = 0.886715
Validation mse = 0.015636
Epoch 35
Loss = 7.7027e-02, PNorm = 44.7011, GNorm = 2.2484, lr_0 = 2.4816e-04
Loss = 8.7427e-02, PNorm = 44.7106, GNorm = 3.2419, lr_0 = 2.4303e-04
Validation rmse = 0.105764
Validation r2 = 0.918956
Validation mse = 0.011186
Epoch 36
Loss = 7.1981e-02, PNorm = 44.7191, GNorm = 0.9949, lr_0 = 2.3751e-04
Loss = 7.4152e-02, PNorm = 44.7278, GNorm = 0.8605, lr_0 = 2.3260e-04
Validation rmse = 0.106832
Validation r2 = 0.917310
Validation mse = 0.011413
Epoch 37
Loss = 6.4751e-02, PNorm = 44.7363, GNorm = 0.8375, lr_0 = 2.2731e-04
Loss = 7.9053e-02, PNorm = 44.7429, GNorm = 0.9079, lr_0 = 2.2261e-04
Validation rmse = 0.104696
Validation r2 = 0.920583
Validation mse = 0.010961
Epoch 38
Loss = 8.0783e-02, PNorm = 44.7502, GNorm = 1.7980, lr_0 = 2.1801e-04
Loss = 6.8944e-02, PNorm = 44.7581, GNorm = 0.5779, lr_0 = 2.1350e-04
Validation rmse = 0.103306
Validation r2 = 0.922678
Validation mse = 0.010672
Epoch 39
Loss = 6.0328e-02, PNorm = 44.7662, GNorm = 0.6734, lr_0 = 2.0865e-04
Loss = 8.5315e-02, PNorm = 44.7738, GNorm = 1.1602, lr_0 = 2.0434e-04
Validation rmse = 0.109358
Validation r2 = 0.913353
Validation mse = 0.011959
Epoch 40
Loss = 8.2022e-02, PNorm = 44.7824, GNorm = 2.4754, lr_0 = 1.9969e-04
Loss = 6.8948e-02, PNorm = 44.7892, GNorm = 0.9635, lr_0 = 1.9556e-04
Validation rmse = 0.096957
Validation r2 = 0.931890
Validation mse = 0.009401
Epoch 41
Loss = 6.0509e-02, PNorm = 44.7954, GNorm = 0.7888, lr_0 = 1.9152e-04
Loss = 7.8515e-02, PNorm = 44.8020, GNorm = 2.4249, lr_0 = 1.8756e-04
Validation rmse = 0.092690
Validation r2 = 0.937753
Validation mse = 0.008591
Epoch 42
Loss = 6.4079e-02, PNorm = 44.8093, GNorm = 1.5284, lr_0 = 1.8330e-04
Loss = 7.0267e-02, PNorm = 44.8164, GNorm = 0.8789, lr_0 = 1.7951e-04
Loss = 5.9159e-02, PNorm = 44.8169, GNorm = 1.0717, lr_0 = 1.7913e-04
Validation rmse = 0.107709
Validation r2 = 0.915947
Validation mse = 0.011601
Epoch 43
Loss = 6.3789e-02, PNorm = 44.8224, GNorm = 1.5883, lr_0 = 1.7543e-04
Loss = 6.6236e-02, PNorm = 44.8286, GNorm = 0.8603, lr_0 = 1.7180e-04
Validation rmse = 0.097255
Validation r2 = 0.931471
Validation mse = 0.009458
Epoch 44
Loss = 6.1580e-02, PNorm = 44.8349, GNorm = 1.0955, lr_0 = 1.6825e-04
Validation rmse = 0.095088
Validation r2 = 0.934490
Validation mse = 0.009042
Epoch 45
Loss = 4.0376e-02, PNorm = 44.8405, GNorm = 1.8484, lr_0 = 1.6443e-04
Loss = 6.4476e-02, PNorm = 44.8466, GNorm = 0.6996, lr_0 = 1.6103e-04
Validation rmse = 0.089459
Validation r2 = 0.942017
Validation mse = 0.008003
Epoch 46
Loss = 4.1078e-02, PNorm = 44.8539, GNorm = 1.9200, lr_0 = 1.5737e-04
Loss = 6.5491e-02, PNorm = 44.8593, GNorm = 1.6443, lr_0 = 1.5411e-04
Validation rmse = 0.146706
Validation r2 = 0.844064
Validation mse = 0.021523
Epoch 47
Loss = 7.7929e-02, PNorm = 44.8650, GNorm = 2.1545, lr_0 = 1.5093e-04
Loss = 6.9569e-02, PNorm = 44.8715, GNorm = 1.3267, lr_0 = 1.4781e-04
Validation rmse = 0.103984
Validation r2 = 0.921660
Validation mse = 0.010813
Epoch 48
Loss = 7.3612e-02, PNorm = 44.8780, GNorm = 3.0052, lr_0 = 1.4445e-04
Loss = 6.3784e-02, PNorm = 44.8830, GNorm = 0.5917, lr_0 = 1.4146e-04
Validation rmse = 0.092024
Validation r2 = 0.938644
Validation mse = 0.008469
Epoch 49
Loss = 6.8588e-02, PNorm = 44.8891, GNorm = 1.0069, lr_0 = 1.3825e-04
Loss = 6.1796e-02, PNorm = 44.8947, GNorm = 0.3758, lr_0 = 1.3539e-04
Validation rmse = 0.104906
Validation r2 = 0.920265
Validation mse = 0.011005
Epoch 50
Loss = 6.0405e-02, PNorm = 44.8986, GNorm = 0.6759, lr_0 = 1.3259e-04
Loss = 5.9564e-02, PNorm = 44.9028, GNorm = 1.5968, lr_0 = 1.2985e-04
Validation rmse = 0.092590
Validation r2 = 0.937888
Validation mse = 0.008573
Epoch 51
Loss = 5.2224e-02, PNorm = 44.9084, GNorm = 0.7145, lr_0 = 1.2690e-04
Loss = 6.4893e-02, PNorm = 44.9127, GNorm = 0.8202, lr_0 = 1.2427e-04
Validation rmse = 0.100395
Validation r2 = 0.926975
Validation mse = 0.010079
Epoch 52
Loss = 5.2849e-02, PNorm = 44.9180, GNorm = 0.6580, lr_0 = 1.2145e-04
Loss = 6.6792e-02, PNorm = 44.9225, GNorm = 0.8945, lr_0 = 1.1894e-04
Validation rmse = 0.113243
Validation r2 = 0.907088
Validation mse = 0.012824
Epoch 53
Loss = 5.7621e-02, PNorm = 44.9268, GNorm = 0.7722, lr_0 = 1.1623e-04
Loss = 5.8698e-02, PNorm = 44.9316, GNorm = 1.3847, lr_0 = 1.1383e-04
Validation rmse = 0.096736
Validation r2 = 0.932200
Validation mse = 0.009358
Epoch 54
Loss = 5.8789e-02, PNorm = 44.9365, GNorm = 0.8576, lr_0 = 1.1148e-04
Loss = 5.5156e-02, PNorm = 44.9408, GNorm = 0.6881, lr_0 = 1.0917e-04
Validation rmse = 0.102581
Validation r2 = 0.923760
Validation mse = 0.010523
Epoch 55
Loss = 5.6643e-02, PNorm = 44.9449, GNorm = 0.9619, lr_0 = 1.0669e-04
Loss = 5.8199e-02, PNorm = 44.9486, GNorm = 0.7086, lr_0 = 1.0449e-04
Validation rmse = 0.099793
Validation r2 = 0.927847
Validation mse = 0.009959
Epoch 56
Loss = 5.3419e-02, PNorm = 44.9532, GNorm = 0.6553, lr_0 = 1.0211e-04
Loss = 5.8193e-02, PNorm = 44.9570, GNorm = 0.3382, lr_0 = 1.0000e-04
Validation rmse = 0.097071
Validation r2 = 0.931729
Validation mse = 0.009423
Epoch 57
Loss = 5.3295e-02, PNorm = 44.9607, GNorm = 1.4255, lr_0 = 1.0000e-04
Loss = 5.9508e-02, PNorm = 44.9639, GNorm = 0.5679, lr_0 = 1.0000e-04
Loss = 3.5472e-02, PNorm = 44.9642, GNorm = 0.9917, lr_0 = 1.0000e-04
Validation rmse = 0.088266
Validation r2 = 0.943554
Validation mse = 0.007791
Epoch 58
Loss = 5.5388e-02, PNorm = 44.9685, GNorm = 1.0559, lr_0 = 1.0000e-04
Validation rmse = 0.109911
Validation r2 = 0.912475
Validation mse = 0.012080
Epoch 59
Loss = 6.2939e-02, PNorm = 44.9731, GNorm = 1.0934, lr_0 = 1.0000e-04
Loss = 5.2102e-02, PNorm = 44.9768, GNorm = 0.7205, lr_0 = 1.0000e-04
Validation rmse = 0.089673
Validation r2 = 0.941740
Validation mse = 0.008041
Model 0 best validation rmse = 0.088266 on epoch 57
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.169706
Model 0 test r2 = 0.630602
Model 0 test mse = 0.028800
Ensemble test rmse = 0.169706
Ensemble test r2 = 0.630602
Ensemble test mse = 0.028800
Fold 9
Splitting data with seed 9
Total size = 976 | train size = 966 | val size = 10 | test size = 56
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.8935e-01, PNorm = 43.2609, GNorm = 3.7561, lr_0 = 3.6053e-04
Validation rmse = 0.262329
Validation r2 = 0.554718
Validation mse = 0.068816
Epoch 1
Loss = 4.4541e-01, PNorm = 43.2893, GNorm = 1.2758, lr_0 = 6.2105e-04
Loss = 6.5255e-01, PNorm = 43.3262, GNorm = 5.8200, lr_0 = 8.5789e-04
Validation rmse = 0.202528
Validation r2 = 0.734593
Validation mse = 0.041017
Epoch 2
Loss = 2.6658e-01, PNorm = 43.4021, GNorm = 1.4749, lr_0 = 9.8961e-04
Loss = 4.9685e-01, PNorm = 43.4733, GNorm = 1.9655, lr_0 = 9.6914e-04
Validation rmse = 0.126683
Validation r2 = 0.896156
Validation mse = 0.016049
Epoch 3
Loss = 3.0816e-01, PNorm = 43.5600, GNorm = 0.7050, lr_0 = 9.4712e-04
Loss = 2.9475e-01, PNorm = 43.6268, GNorm = 1.7498, lr_0 = 9.2754e-04
Validation rmse = 0.143650
Validation r2 = 0.866478
Validation mse = 0.020635
Epoch 4
Loss = 1.7514e-01, PNorm = 43.6884, GNorm = 1.8471, lr_0 = 9.0836e-04
Loss = 2.2728e-01, PNorm = 43.7331, GNorm = 9.8888, lr_0 = 8.8958e-04
Validation rmse = 0.150059
Validation r2 = 0.854297
Validation mse = 0.022518
Epoch 5
Loss = 2.6022e-01, PNorm = 43.7882, GNorm = 7.5864, lr_0 = 8.6936e-04
Loss = 2.2937e-01, PNorm = 43.8320, GNorm = 2.3571, lr_0 = 8.5139e-04
Validation rmse = 0.154897
Validation r2 = 0.844750
Validation mse = 0.023993
Epoch 6
Loss = 2.4248e-01, PNorm = 43.8758, GNorm = 2.8040, lr_0 = 8.3204e-04
Loss = 1.5758e-01, PNorm = 43.9104, GNorm = 2.4504, lr_0 = 8.1484e-04
Validation rmse = 0.160103
Validation r2 = 0.834140
Validation mse = 0.025633
Epoch 7
Loss = 1.9503e-01, PNorm = 43.9358, GNorm = 6.0390, lr_0 = 7.9799e-04
Loss = 1.7118e-01, PNorm = 43.9636, GNorm = 3.0834, lr_0 = 7.8149e-04
Validation rmse = 0.136157
Validation r2 = 0.880044
Validation mse = 0.018539
Epoch 8
Loss = 1.6660e-01, PNorm = 43.9926, GNorm = 1.3020, lr_0 = 7.6373e-04
Loss = 1.4682e-01, PNorm = 44.0157, GNorm = 0.6110, lr_0 = 7.4794e-04
Validation rmse = 0.161341
Validation r2 = 0.831566
Validation mse = 0.026031
Epoch 9
Loss = 1.4749e-01, PNorm = 44.0312, GNorm = 1.0880, lr_0 = 7.3094e-04
Loss = 1.3862e-01, PNorm = 44.0496, GNorm = 0.5141, lr_0 = 7.1583e-04
Validation rmse = 0.147924
Validation r2 = 0.858413
Validation mse = 0.021882
Epoch 10
Loss = 1.2457e-01, PNorm = 44.0662, GNorm = 3.1499, lr_0 = 7.0103e-04
Loss = 1.2702e-01, PNorm = 44.0872, GNorm = 1.5288, lr_0 = 6.8653e-04
Validation rmse = 0.129292
Validation r2 = 0.891835
Validation mse = 0.016716
Epoch 11
Loss = 1.6000e-01, PNorm = 44.1058, GNorm = 1.6816, lr_0 = 6.7093e-04
Loss = 1.5708e-01, PNorm = 44.1289, GNorm = 2.2137, lr_0 = 6.5706e-04
Validation rmse = 0.137439
Validation r2 = 0.877775
Validation mse = 0.018889
Epoch 12
Loss = 1.2343e-01, PNorm = 44.1529, GNorm = 3.3520, lr_0 = 6.4213e-04
Loss = 1.1923e-01, PNorm = 44.1711, GNorm = 1.5828, lr_0 = 6.2885e-04
Validation rmse = 0.134569
Validation r2 = 0.882825
Validation mse = 0.018109
Epoch 13
Loss = 1.1044e-01, PNorm = 44.1856, GNorm = 1.0478, lr_0 = 6.1585e-04
Loss = 1.1956e-01, PNorm = 44.1984, GNorm = 4.0779, lr_0 = 6.0311e-04
Loss = 8.4956e-02, PNorm = 44.1993, GNorm = 3.6087, lr_0 = 6.0185e-04
Validation rmse = 0.162967
Validation r2 = 0.828154
Validation mse = 0.026558
Epoch 14
Loss = 1.0595e-01, PNorm = 44.2132, GNorm = 0.8907, lr_0 = 5.8941e-04
Validation rmse = 0.176612
Validation r2 = 0.798172
Validation mse = 0.031192
Epoch 15
Loss = 1.0093e-01, PNorm = 44.2282, GNorm = 3.3923, lr_0 = 5.7602e-04
Loss = 1.2006e-01, PNorm = 44.2411, GNorm = 1.2445, lr_0 = 5.6411e-04
Validation rmse = 0.135600
Validation r2 = 0.881022
Validation mse = 0.018387
Epoch 16
Loss = 1.0188e-01, PNorm = 44.2594, GNorm = 1.5959, lr_0 = 5.5244e-04
Loss = 1.1795e-01, PNorm = 44.2755, GNorm = 2.4802, lr_0 = 5.4102e-04
Validation rmse = 0.140531
Validation r2 = 0.872213
Validation mse = 0.019749
Epoch 17
Loss = 9.3296e-02, PNorm = 44.2908, GNorm = 0.9768, lr_0 = 5.2873e-04
Loss = 1.2895e-01, PNorm = 44.3051, GNorm = 3.3791, lr_0 = 5.1779e-04
Validation rmse = 0.122611
Validation r2 = 0.902725
Validation mse = 0.015033
Epoch 18
Loss = 1.0961e-01, PNorm = 44.3232, GNorm = 1.3359, lr_0 = 5.0603e-04
Loss = 1.1186e-01, PNorm = 44.3380, GNorm = 1.6116, lr_0 = 4.9556e-04
Validation rmse = 0.150386
Validation r2 = 0.853662
Validation mse = 0.022616
Epoch 19
Loss = 1.0381e-01, PNorm = 44.3516, GNorm = 1.1706, lr_0 = 4.8532e-04
Loss = 9.5142e-02, PNorm = 44.3620, GNorm = 0.9801, lr_0 = 4.7528e-04
Validation rmse = 0.159111
Validation r2 = 0.836190
Validation mse = 0.025316
Epoch 20
Loss = 1.1569e-01, PNorm = 44.3741, GNorm = 3.1757, lr_0 = 4.6448e-04
Loss = 1.1004e-01, PNorm = 44.3908, GNorm = 1.2687, lr_0 = 4.5488e-04
Validation rmse = 0.121989
Validation r2 = 0.903710
Validation mse = 0.014881
Epoch 21
Loss = 1.0738e-01, PNorm = 44.4034, GNorm = 2.2180, lr_0 = 4.4454e-04
Loss = 1.0266e-01, PNorm = 44.4142, GNorm = 1.1685, lr_0 = 4.3535e-04
Validation rmse = 0.132335
Validation r2 = 0.886684
Validation mse = 0.017513
Epoch 22
Loss = 8.9216e-02, PNorm = 44.4237, GNorm = 0.9425, lr_0 = 4.2635e-04
Loss = 9.0058e-02, PNorm = 44.4347, GNorm = 0.8030, lr_0 = 4.1753e-04
Validation rmse = 0.121758
Validation r2 = 0.904074
Validation mse = 0.014825
Epoch 23
Loss = 1.0329e-01, PNorm = 44.4463, GNorm = 3.8768, lr_0 = 4.0804e-04
Loss = 8.7369e-02, PNorm = 44.4542, GNorm = 1.9146, lr_0 = 3.9961e-04
Validation rmse = 0.116789
Validation r2 = 0.911743
Validation mse = 0.013640
Epoch 24
Loss = 8.7729e-02, PNorm = 44.4662, GNorm = 1.2799, lr_0 = 3.9053e-04
Loss = 8.5563e-02, PNorm = 44.4769, GNorm = 2.8246, lr_0 = 3.8245e-04
Validation rmse = 0.125377
Validation r2 = 0.898287
Validation mse = 0.015719
Epoch 25
Loss = 8.8622e-02, PNorm = 44.4862, GNorm = 1.0529, lr_0 = 3.7454e-04
Loss = 8.7872e-02, PNorm = 44.4981, GNorm = 1.1613, lr_0 = 3.6680e-04
Validation rmse = 0.123977
Validation r2 = 0.900545
Validation mse = 0.015370
Epoch 26
Loss = 8.2660e-02, PNorm = 44.5120, GNorm = 0.8223, lr_0 = 3.5846e-04
Loss = 8.8693e-02, PNorm = 44.5219, GNorm = 0.7819, lr_0 = 3.5105e-04
Validation rmse = 0.143912
Validation r2 = 0.865991
Validation mse = 0.020711
Epoch 27
Loss = 8.3839e-02, PNorm = 44.5302, GNorm = 1.8478, lr_0 = 3.4308e-04
Loss = 8.7781e-02, PNorm = 44.5379, GNorm = 1.2920, lr_0 = 3.3598e-04
Loss = 3.1569e-02, PNorm = 44.5388, GNorm = 1.2385, lr_0 = 3.3528e-04
Validation rmse = 0.133725
Validation r2 = 0.884290
Validation mse = 0.017882
Epoch 28
Loss = 8.2518e-02, PNorm = 44.5477, GNorm = 1.0443, lr_0 = 3.2835e-04
Loss = 8.6717e-02, PNorm = 44.5568, GNorm = 2.9795, lr_0 = 3.2156e-04
Validation rmse = 0.140081
Validation r2 = 0.873030
Validation mse = 0.019623
Epoch 29
Loss = 8.5019e-02, PNorm = 44.5654, GNorm = 2.0696, lr_0 = 3.1491e-04
Validation rmse = 0.131320
Validation r2 = 0.888415
Validation mse = 0.017245
Epoch 30
Loss = 8.8458e-02, PNorm = 44.5753, GNorm = 1.9005, lr_0 = 3.0775e-04
Loss = 7.5717e-02, PNorm = 44.5854, GNorm = 1.6484, lr_0 = 3.0139e-04
Validation rmse = 0.137873
Validation r2 = 0.877000
Validation mse = 0.019009
Epoch 31
Loss = 8.3535e-02, PNorm = 44.5956, GNorm = 0.8448, lr_0 = 2.9454e-04
Loss = 8.1210e-02, PNorm = 44.6031, GNorm = 0.6875, lr_0 = 2.8845e-04
Validation rmse = 0.123976
Validation r2 = 0.900547
Validation mse = 0.015370
Epoch 32
Loss = 6.1059e-02, PNorm = 44.6124, GNorm = 0.6462, lr_0 = 2.8249e-04
Loss = 8.4948e-02, PNorm = 44.6229, GNorm = 0.7752, lr_0 = 2.7665e-04
Validation rmse = 0.164227
Validation r2 = 0.825485
Validation mse = 0.026971
Epoch 33
Loss = 1.2215e-01, PNorm = 44.6317, GNorm = 1.6225, lr_0 = 2.7036e-04
Loss = 9.8629e-02, PNorm = 44.6387, GNorm = 1.4166, lr_0 = 2.6477e-04
Validation rmse = 0.143809
Validation r2 = 0.866182
Validation mse = 0.020681
Epoch 34
Loss = 8.1917e-02, PNorm = 44.6524, GNorm = 0.8824, lr_0 = 2.5875e-04
Loss = 7.7800e-02, PNorm = 44.6617, GNorm = 1.2027, lr_0 = 2.5340e-04
Validation rmse = 0.115584
Validation r2 = 0.913555
Validation mse = 0.013360
Epoch 35
Loss = 7.8615e-02, PNorm = 44.6697, GNorm = 0.8867, lr_0 = 2.4816e-04
Loss = 7.9635e-02, PNorm = 44.6774, GNorm = 2.3150, lr_0 = 2.4303e-04
Validation rmse = 0.117079
Validation r2 = 0.911305
Validation mse = 0.013707
Epoch 36
Loss = 8.7469e-02, PNorm = 44.6849, GNorm = 0.5377, lr_0 = 2.3751e-04
Loss = 7.4812e-02, PNorm = 44.6924, GNorm = 0.7531, lr_0 = 2.3260e-04
Validation rmse = 0.112189
Validation r2 = 0.918558
Validation mse = 0.012586
Epoch 37
Loss = 7.2670e-02, PNorm = 44.7017, GNorm = 1.2128, lr_0 = 2.2731e-04
Loss = 7.5588e-02, PNorm = 44.7087, GNorm = 0.4924, lr_0 = 2.2261e-04
Validation rmse = 0.112485
Validation r2 = 0.918128
Validation mse = 0.012653
Epoch 38
Loss = 9.7204e-02, PNorm = 44.7185, GNorm = 2.6745, lr_0 = 2.1801e-04
Loss = 7.5082e-02, PNorm = 44.7269, GNorm = 2.3948, lr_0 = 2.1350e-04
Validation rmse = 0.127607
Validation r2 = 0.894636
Validation mse = 0.016284
Epoch 39
Loss = 6.2994e-02, PNorm = 44.7320, GNorm = 0.9921, lr_0 = 2.0865e-04
Loss = 7.7862e-02, PNorm = 44.7403, GNorm = 1.7249, lr_0 = 2.0434e-04
Validation rmse = 0.148735
Validation r2 = 0.856856
Validation mse = 0.022122
Epoch 40
Loss = 6.0612e-02, PNorm = 44.7460, GNorm = 1.4460, lr_0 = 1.9969e-04
Loss = 8.4780e-02, PNorm = 44.7524, GNorm = 0.5145, lr_0 = 1.9556e-04
Validation rmse = 0.134734
Validation r2 = 0.882537
Validation mse = 0.018153
Epoch 41
Loss = 6.4878e-02, PNorm = 44.7595, GNorm = 1.5597, lr_0 = 1.9152e-04
Loss = 6.8473e-02, PNorm = 44.7644, GNorm = 2.7831, lr_0 = 1.8756e-04
Validation rmse = 0.130789
Validation r2 = 0.889316
Validation mse = 0.017106
Epoch 42
Loss = 6.0300e-02, PNorm = 44.7720, GNorm = 0.7504, lr_0 = 1.8330e-04
Loss = 7.0776e-02, PNorm = 44.7780, GNorm = 0.8651, lr_0 = 1.7951e-04
Loss = 8.1628e-02, PNorm = 44.7784, GNorm = 1.0999, lr_0 = 1.7913e-04
Validation rmse = 0.125820
Validation r2 = 0.897566
Validation mse = 0.015831
Epoch 43
Loss = 6.8912e-02, PNorm = 44.7839, GNorm = 1.2620, lr_0 = 1.7543e-04
Loss = 6.2971e-02, PNorm = 44.7902, GNorm = 1.1693, lr_0 = 1.7180e-04
Validation rmse = 0.134546
Validation r2 = 0.882865
Validation mse = 0.018103
Epoch 44
Loss = 6.4912e-02, PNorm = 44.7953, GNorm = 0.8001, lr_0 = 1.6825e-04
Validation rmse = 0.124108
Validation r2 = 0.900335
Validation mse = 0.015403
Epoch 45
Loss = 6.2503e-02, PNorm = 44.8005, GNorm = 1.1809, lr_0 = 1.6443e-04
Loss = 6.7169e-02, PNorm = 44.8062, GNorm = 0.4412, lr_0 = 1.6103e-04
Validation rmse = 0.130865
Validation r2 = 0.889187
Validation mse = 0.017126
Epoch 46
Loss = 3.4785e-02, PNorm = 44.8133, GNorm = 0.5397, lr_0 = 1.5737e-04
Loss = 6.5538e-02, PNorm = 44.8185, GNorm = 1.1197, lr_0 = 1.5411e-04
Validation rmse = 0.116155
Validation r2 = 0.912699
Validation mse = 0.013492
Epoch 47
Loss = 5.4607e-02, PNorm = 44.8227, GNorm = 0.5890, lr_0 = 1.5093e-04
Loss = 6.1278e-02, PNorm = 44.8280, GNorm = 0.6040, lr_0 = 1.4781e-04
Validation rmse = 0.147670
Validation r2 = 0.858899
Validation mse = 0.021807
Epoch 48
Loss = 6.8785e-02, PNorm = 44.8334, GNorm = 0.5127, lr_0 = 1.4445e-04
Loss = 6.1783e-02, PNorm = 44.8393, GNorm = 0.5753, lr_0 = 1.4146e-04
Validation rmse = 0.114807
Validation r2 = 0.914713
Validation mse = 0.013181
Epoch 49
Loss = 6.3390e-02, PNorm = 44.8443, GNorm = 0.9436, lr_0 = 1.3825e-04
Loss = 6.1535e-02, PNorm = 44.8489, GNorm = 0.7894, lr_0 = 1.3539e-04
Validation rmse = 0.129554
Validation r2 = 0.891397
Validation mse = 0.016784
Epoch 50
Loss = 6.3184e-02, PNorm = 44.8542, GNorm = 1.6807, lr_0 = 1.3259e-04
Loss = 6.4534e-02, PNorm = 44.8594, GNorm = 0.5995, lr_0 = 1.2985e-04
Validation rmse = 0.119827
Validation r2 = 0.907092
Validation mse = 0.014358
Epoch 51
Loss = 4.6938e-02, PNorm = 44.8645, GNorm = 0.8505, lr_0 = 1.2690e-04
Loss = 5.7094e-02, PNorm = 44.8685, GNorm = 0.8925, lr_0 = 1.2427e-04
Validation rmse = 0.116758
Validation r2 = 0.911791
Validation mse = 0.013632
Epoch 52
Loss = 5.6654e-02, PNorm = 44.8733, GNorm = 1.1711, lr_0 = 1.2145e-04
Loss = 6.1122e-02, PNorm = 44.8778, GNorm = 0.5627, lr_0 = 1.1894e-04
Validation rmse = 0.134765
Validation r2 = 0.882484
Validation mse = 0.018162
Epoch 53
Loss = 5.4886e-02, PNorm = 44.8821, GNorm = 0.9437, lr_0 = 1.1623e-04
Loss = 6.0299e-02, PNorm = 44.8857, GNorm = 1.1692, lr_0 = 1.1383e-04
Validation rmse = 0.126348
Validation r2 = 0.896705
Validation mse = 0.015964
Epoch 54
Loss = 5.6801e-02, PNorm = 44.8902, GNorm = 0.7185, lr_0 = 1.1148e-04
Loss = 5.7634e-02, PNorm = 44.8948, GNorm = 1.5504, lr_0 = 1.0917e-04
Validation rmse = 0.112768
Validation r2 = 0.917716
Validation mse = 0.012717
Epoch 55
Loss = 6.4159e-02, PNorm = 44.9001, GNorm = 0.8828, lr_0 = 1.0669e-04
Loss = 5.2287e-02, PNorm = 44.9043, GNorm = 0.5804, lr_0 = 1.0449e-04
Validation rmse = 0.123318
Validation r2 = 0.901599
Validation mse = 0.015207
Epoch 56
Loss = 5.6293e-02, PNorm = 44.9078, GNorm = 1.8247, lr_0 = 1.0211e-04
Loss = 5.3189e-02, PNorm = 44.9118, GNorm = 0.8246, lr_0 = 1.0000e-04
Validation rmse = 0.113292
Validation r2 = 0.916950
Validation mse = 0.012835
Epoch 57
Loss = 6.0625e-02, PNorm = 44.9159, GNorm = 0.8874, lr_0 = 1.0000e-04
Loss = 5.1026e-02, PNorm = 44.9205, GNorm = 0.7586, lr_0 = 1.0000e-04
Loss = 7.8597e-02, PNorm = 44.9208, GNorm = 1.3197, lr_0 = 1.0000e-04
Validation rmse = 0.119708
Validation r2 = 0.907277
Validation mse = 0.014330
Epoch 58
Loss = 5.3929e-02, PNorm = 44.9243, GNorm = 0.6348, lr_0 = 1.0000e-04
Validation rmse = 0.130850
Validation r2 = 0.889213
Validation mse = 0.017122
Epoch 59
Loss = 4.4098e-02, PNorm = 44.9285, GNorm = 0.7085, lr_0 = 1.0000e-04
Loss = 4.8420e-02, PNorm = 44.9328, GNorm = 1.6717, lr_0 = 1.0000e-04
Validation rmse = 0.128738
Validation r2 = 0.892759
Validation mse = 0.016574
Model 0 best validation rmse = 0.112189 on epoch 36
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.184000
Model 0 test r2 = 0.565752
Model 0 test mse = 0.033856
Ensemble test rmse = 0.184000
Ensemble test r2 = 0.565752
Ensemble test mse = 0.033856
10-fold cross validation
	Seed 0 ==> test rmse = 0.136423
	Seed 0 ==> test r2 = 0.761288
	Seed 0 ==> test mse = 0.018611
	Seed 1 ==> test rmse = 0.150381
	Seed 1 ==> test r2 = 0.709939
	Seed 1 ==> test mse = 0.022615
	Seed 2 ==> test rmse = 0.202441
	Seed 2 ==> test r2 = 0.474351
	Seed 2 ==> test mse = 0.040982
	Seed 3 ==> test rmse = 0.171670
	Seed 3 ==> test r2 = 0.622001
	Seed 3 ==> test mse = 0.029471
	Seed 4 ==> test rmse = 0.182042
	Seed 4 ==> test r2 = 0.574946
	Seed 4 ==> test mse = 0.033139
	Seed 5 ==> test rmse = 0.203966
	Seed 5 ==> test r2 = 0.466398
	Seed 5 ==> test mse = 0.041602
	Seed 6 ==> test rmse = 0.131632
	Seed 6 ==> test r2 = 0.777758
	Seed 6 ==> test mse = 0.017327
	Seed 7 ==> test rmse = 0.111782
	Seed 7 ==> test r2 = 0.839732
	Seed 7 ==> test mse = 0.012495
	Seed 8 ==> test rmse = 0.169706
	Seed 8 ==> test r2 = 0.630602
	Seed 8 ==> test mse = 0.028800
	Seed 9 ==> test rmse = 0.184000
	Seed 9 ==> test r2 = 0.565752
	Seed 9 ==> test mse = 0.033856
Overall test rmse = 0.164404 +/- 0.029344
Overall test r2 = 0.642276 +/- 0.120895
Overall test mse = 0.027890 +/- 0.009426
Elapsed time = 0:07:29
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-05d85262-3219-459a-86b2-5360cba4da72.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/IPA_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2', 'mse'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2', 'mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/IPA_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/IPA_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 975 | train size = 965 | val size = 10 | test size = 57
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.6368e-01, PNorm = 43.2629, GNorm = 4.9637, lr_0 = 3.6053e-04
Validation rmse = 0.334453
Validation r2 = 0.200632
Validation mse = 0.111859
Epoch 1
Loss = 1.2995e+00, PNorm = 43.2920, GNorm = 21.3057, lr_0 = 6.2105e-04
Loss = 7.3605e-01, PNorm = 43.3295, GNorm = 1.3073, lr_0 = 8.5789e-04
Validation rmse = 0.307694
Validation r2 = 0.323425
Validation mse = 0.094676
Epoch 2
Loss = 4.8707e-01, PNorm = 43.4063, GNorm = 1.8951, lr_0 = 9.8961e-04
Loss = 4.9064e-01, PNorm = 43.4874, GNorm = 4.0665, lr_0 = 9.6914e-04
Validation rmse = 0.231098
Validation r2 = 0.618346
Validation mse = 0.053406
Epoch 3
Loss = 3.4282e-01, PNorm = 43.5721, GNorm = 1.7882, lr_0 = 9.4712e-04
Loss = 2.7699e-01, PNorm = 43.6397, GNorm = 2.7351, lr_0 = 9.2754e-04
Validation rmse = 0.202465
Validation r2 = 0.707060
Validation mse = 0.040992
Epoch 4
Loss = 2.7930e-01, PNorm = 43.6972, GNorm = 6.0041, lr_0 = 9.0836e-04
Loss = 2.6743e-01, PNorm = 43.7516, GNorm = 1.6869, lr_0 = 8.8958e-04
Validation rmse = 0.173144
Validation r2 = 0.785763
Validation mse = 0.029979
Epoch 5
Loss = 2.1444e-01, PNorm = 43.7952, GNorm = 2.4493, lr_0 = 8.6936e-04
Loss = 2.5378e-01, PNorm = 43.8370, GNorm = 6.1862, lr_0 = 8.5139e-04
Validation rmse = 0.176542
Validation r2 = 0.777272
Validation mse = 0.031167
Epoch 6
Loss = 1.8202e-01, PNorm = 43.8863, GNorm = 2.9843, lr_0 = 8.3204e-04
Loss = 1.9202e-01, PNorm = 43.9189, GNorm = 3.0660, lr_0 = 8.1484e-04
Validation rmse = 0.210801
Validation r2 = 0.682442
Validation mse = 0.044437
Epoch 7
Loss = 2.0445e-01, PNorm = 43.9486, GNorm = 3.0208, lr_0 = 7.9799e-04
Loss = 1.9255e-01, PNorm = 43.9814, GNorm = 1.9117, lr_0 = 7.8149e-04
Validation rmse = 0.185684
Validation r2 = 0.753608
Validation mse = 0.034479
Epoch 8
Loss = 1.4476e-01, PNorm = 44.0161, GNorm = 3.2642, lr_0 = 7.6373e-04
Loss = 1.6095e-01, PNorm = 44.0374, GNorm = 2.8583, lr_0 = 7.4794e-04
Validation rmse = 0.169815
Validation r2 = 0.793924
Validation mse = 0.028837
Epoch 9
Loss = 1.3798e-01, PNorm = 44.0648, GNorm = 3.3776, lr_0 = 7.3094e-04
Loss = 1.5801e-01, PNorm = 44.0929, GNorm = 0.9039, lr_0 = 7.1583e-04
Validation rmse = 0.195174
Validation r2 = 0.727778
Validation mse = 0.038093
Epoch 10
Loss = 1.7689e-01, PNorm = 44.1169, GNorm = 3.2300, lr_0 = 7.0103e-04
Loss = 1.2718e-01, PNorm = 44.1445, GNorm = 3.1631, lr_0 = 6.8653e-04
Validation rmse = 0.156021
Validation r2 = 0.826042
Validation mse = 0.024343
Epoch 11
Loss = 1.3354e-01, PNorm = 44.1667, GNorm = 1.7082, lr_0 = 6.7093e-04
Loss = 1.4171e-01, PNorm = 44.1885, GNorm = 1.4160, lr_0 = 6.5706e-04
Validation rmse = 0.171807
Validation r2 = 0.789060
Validation mse = 0.029518
Epoch 12
Loss = 1.0971e-01, PNorm = 44.2138, GNorm = 0.7309, lr_0 = 6.4213e-04
Loss = 1.2907e-01, PNorm = 44.2325, GNorm = 0.7451, lr_0 = 6.2885e-04
Loss = 1.1589e-01, PNorm = 44.2338, GNorm = 1.9809, lr_0 = 6.2754e-04
Validation rmse = 0.146271
Validation r2 = 0.847104
Validation mse = 0.021395
Epoch 13
Loss = 1.1378e-01, PNorm = 44.2481, GNorm = 1.1603, lr_0 = 6.1456e-04
Loss = 1.2223e-01, PNorm = 44.2658, GNorm = 3.3290, lr_0 = 6.0185e-04
Validation rmse = 0.145962
Validation r2 = 0.847750
Validation mse = 0.021305
Epoch 14
Loss = 1.0698e-01, PNorm = 44.2914, GNorm = 2.5008, lr_0 = 5.8941e-04
Validation rmse = 0.173683
Validation r2 = 0.784429
Validation mse = 0.030166
Epoch 15
Loss = 1.2722e-01, PNorm = 44.3112, GNorm = 1.2571, lr_0 = 5.7602e-04
Loss = 9.2931e-02, PNorm = 44.3267, GNorm = 2.0074, lr_0 = 5.6411e-04
Validation rmse = 0.157617
Validation r2 = 0.822465
Validation mse = 0.024843
Epoch 16
Loss = 7.4372e-02, PNorm = 44.3460, GNorm = 1.1212, lr_0 = 5.5129e-04
Loss = 1.0717e-01, PNorm = 44.3619, GNorm = 1.7582, lr_0 = 5.3989e-04
Validation rmse = 0.157441
Validation r2 = 0.822862
Validation mse = 0.024788
Epoch 17
Loss = 8.1688e-02, PNorm = 44.3745, GNorm = 1.2483, lr_0 = 5.2873e-04
Loss = 1.0136e-01, PNorm = 44.3869, GNorm = 0.6044, lr_0 = 5.1779e-04
Validation rmse = 0.171916
Validation r2 = 0.788792
Validation mse = 0.029555
Epoch 18
Loss = 8.6657e-02, PNorm = 44.4009, GNorm = 0.9157, lr_0 = 5.0603e-04
Loss = 1.0276e-01, PNorm = 44.4161, GNorm = 1.1737, lr_0 = 4.9556e-04
Validation rmse = 0.159526
Validation r2 = 0.818139
Validation mse = 0.025449
Epoch 19
Loss = 9.4126e-02, PNorm = 44.4319, GNorm = 0.4713, lr_0 = 4.8430e-04
Loss = 9.3723e-02, PNorm = 44.4464, GNorm = 1.1494, lr_0 = 4.7429e-04
Validation rmse = 0.157355
Validation r2 = 0.823055
Validation mse = 0.024761
Epoch 20
Loss = 8.0213e-02, PNorm = 44.4578, GNorm = 1.1344, lr_0 = 4.6448e-04
Loss = 9.5483e-02, PNorm = 44.4692, GNorm = 1.3515, lr_0 = 4.5488e-04
Validation rmse = 0.142642
Validation r2 = 0.854597
Validation mse = 0.020347
Epoch 21
Loss = 1.1656e-01, PNorm = 44.4815, GNorm = 3.4880, lr_0 = 4.4454e-04
Loss = 9.6840e-02, PNorm = 44.4956, GNorm = 0.6506, lr_0 = 4.3535e-04
Validation rmse = 0.174434
Validation r2 = 0.782559
Validation mse = 0.030427
Epoch 22
Loss = 1.1007e-01, PNorm = 44.5140, GNorm = 2.7128, lr_0 = 4.2546e-04
Loss = 9.8517e-02, PNorm = 44.5288, GNorm = 1.8215, lr_0 = 4.1666e-04
Validation rmse = 0.153836
Validation r2 = 0.830881
Validation mse = 0.023665
Epoch 23
Loss = 8.2342e-02, PNorm = 44.5451, GNorm = 3.1854, lr_0 = 4.0719e-04
Loss = 9.4073e-02, PNorm = 44.5579, GNorm = 2.3548, lr_0 = 3.9877e-04
Validation rmse = 0.164202
Validation r2 = 0.807321
Validation mse = 0.026962
Epoch 24
Loss = 1.1018e-01, PNorm = 44.5674, GNorm = 1.6199, lr_0 = 3.9053e-04
Loss = 8.1226e-02, PNorm = 44.5811, GNorm = 1.8890, lr_0 = 3.8245e-04
Validation rmse = 0.156132
Validation r2 = 0.825795
Validation mse = 0.024377
Epoch 25
Loss = 8.8458e-02, PNorm = 44.5934, GNorm = 0.6153, lr_0 = 3.7376e-04
Loss = 8.7229e-02, PNorm = 44.6035, GNorm = 1.4938, lr_0 = 3.6603e-04
Validation rmse = 0.155800
Validation r2 = 0.826535
Validation mse = 0.024274
Epoch 26
Loss = 7.4079e-02, PNorm = 44.6175, GNorm = 2.2754, lr_0 = 3.5772e-04
Loss = 8.2887e-02, PNorm = 44.6264, GNorm = 0.7000, lr_0 = 3.5032e-04
Validation rmse = 0.155245
Validation r2 = 0.827769
Validation mse = 0.024101
Epoch 27
Loss = 7.8303e-02, PNorm = 44.6345, GNorm = 1.0392, lr_0 = 3.4308e-04
Loss = 7.4396e-02, PNorm = 44.6439, GNorm = 0.6895, lr_0 = 3.3598e-04
Loss = 1.4146e-01, PNorm = 44.6450, GNorm = 2.4924, lr_0 = 3.3528e-04
Validation rmse = 0.141229
Validation r2 = 0.857465
Validation mse = 0.019946
Epoch 28
Loss = 7.0163e-02, PNorm = 44.6565, GNorm = 1.0848, lr_0 = 3.2835e-04
Validation rmse = 0.155105
Validation r2 = 0.828079
Validation mse = 0.024058
Epoch 29
Loss = 8.7046e-02, PNorm = 44.6650, GNorm = 0.7479, lr_0 = 3.2089e-04
Loss = 7.6870e-02, PNorm = 44.6754, GNorm = 1.2313, lr_0 = 3.1425e-04
Validation rmse = 0.139660
Validation r2 = 0.860614
Validation mse = 0.019505
Epoch 30
Loss = 5.3968e-02, PNorm = 44.6849, GNorm = 0.5620, lr_0 = 3.0775e-04
Loss = 6.7177e-02, PNorm = 44.6916, GNorm = 0.6422, lr_0 = 3.0139e-04
Validation rmse = 0.141022
Validation r2 = 0.857882
Validation mse = 0.019887
Epoch 31
Loss = 5.3942e-02, PNorm = 44.7019, GNorm = 0.8399, lr_0 = 2.9454e-04
Loss = 7.3700e-02, PNorm = 44.7104, GNorm = 0.6208, lr_0 = 2.8845e-04
Validation rmse = 0.157630
Validation r2 = 0.822435
Validation mse = 0.024847
Epoch 32
Loss = 8.7247e-02, PNorm = 44.7203, GNorm = 1.0482, lr_0 = 2.8190e-04
Loss = 7.3863e-02, PNorm = 44.7288, GNorm = 0.6901, lr_0 = 2.7607e-04
Validation rmse = 0.159758
Validation r2 = 0.817609
Validation mse = 0.025523
Epoch 33
Loss = 6.7364e-02, PNorm = 44.7392, GNorm = 0.8060, lr_0 = 2.6980e-04
Loss = 7.4988e-02, PNorm = 44.7478, GNorm = 1.5056, lr_0 = 2.6422e-04
Validation rmse = 0.142918
Validation r2 = 0.854035
Validation mse = 0.020425
Epoch 34
Loss = 5.1750e-02, PNorm = 44.7578, GNorm = 0.6063, lr_0 = 2.5875e-04
Loss = 7.2676e-02, PNorm = 44.7656, GNorm = 1.2359, lr_0 = 2.5340e-04
Validation rmse = 0.148676
Validation r2 = 0.842037
Validation mse = 0.022104
Epoch 35
Loss = 7.6210e-02, PNorm = 44.7731, GNorm = 2.4106, lr_0 = 2.4764e-04
Loss = 7.0309e-02, PNorm = 44.7836, GNorm = 1.8517, lr_0 = 2.4252e-04
Validation rmse = 0.135603
Validation r2 = 0.868595
Validation mse = 0.018388
Epoch 36
Loss = 7.2061e-02, PNorm = 44.7922, GNorm = 0.7087, lr_0 = 2.3701e-04
Loss = 8.2342e-02, PNorm = 44.8020, GNorm = 2.2002, lr_0 = 2.3211e-04
Validation rmse = 0.144418
Validation r2 = 0.850954
Validation mse = 0.020857
Epoch 37
Loss = 7.9024e-02, PNorm = 44.8099, GNorm = 1.4476, lr_0 = 2.2731e-04
Loss = 7.6677e-02, PNorm = 44.8171, GNorm = 1.8497, lr_0 = 2.2261e-04
Validation rmse = 0.128917
Validation r2 = 0.881233
Validation mse = 0.016619
Epoch 38
Loss = 7.9087e-02, PNorm = 44.8265, GNorm = 2.1219, lr_0 = 2.1755e-04
Loss = 6.3922e-02, PNorm = 44.8335, GNorm = 1.3494, lr_0 = 2.1306e-04
Validation rmse = 0.134896
Validation r2 = 0.869961
Validation mse = 0.018197
Epoch 39
Loss = 6.3108e-02, PNorm = 44.8401, GNorm = 0.7517, lr_0 = 2.0821e-04
Loss = 6.3523e-02, PNorm = 44.8467, GNorm = 1.0135, lr_0 = 2.0391e-04
Validation rmse = 0.142028
Validation r2 = 0.855846
Validation mse = 0.020172
Epoch 40
Loss = 5.7605e-02, PNorm = 44.8533, GNorm = 1.1652, lr_0 = 1.9969e-04
Loss = 6.6018e-02, PNorm = 44.8586, GNorm = 0.6023, lr_0 = 1.9556e-04
Validation rmse = 0.143030
Validation r2 = 0.853806
Validation mse = 0.020457
Epoch 41
Loss = 6.1012e-02, PNorm = 44.8669, GNorm = 0.8679, lr_0 = 1.9112e-04
Loss = 6.0590e-02, PNorm = 44.8727, GNorm = 1.1782, lr_0 = 1.8717e-04
Loss = 6.3093e-02, PNorm = 44.8734, GNorm = 1.7324, lr_0 = 1.8678e-04
Validation rmse = 0.155412
Validation r2 = 0.827397
Validation mse = 0.024153
Epoch 42
Loss = 6.0846e-02, PNorm = 44.8804, GNorm = 0.4880, lr_0 = 1.8292e-04
Validation rmse = 0.139705
Validation r2 = 0.860523
Validation mse = 0.019518
Epoch 43
Loss = 5.8398e-02, PNorm = 44.8869, GNorm = 0.7204, lr_0 = 1.7876e-04
Loss = 5.1583e-02, PNorm = 44.8924, GNorm = 0.3225, lr_0 = 1.7506e-04
Validation rmse = 0.139373
Validation r2 = 0.861186
Validation mse = 0.019425
Epoch 44
Loss = 5.1506e-02, PNorm = 44.8972, GNorm = 0.7881, lr_0 = 1.7144e-04
Loss = 5.6785e-02, PNorm = 44.9029, GNorm = 0.4853, lr_0 = 1.6790e-04
Validation rmse = 0.126644
Validation r2 = 0.885383
Validation mse = 0.016039
Epoch 45
Loss = 5.9026e-02, PNorm = 44.9092, GNorm = 0.9203, lr_0 = 1.6408e-04
Loss = 5.6849e-02, PNorm = 44.9149, GNorm = 0.8594, lr_0 = 1.6069e-04
Validation rmse = 0.148083
Validation r2 = 0.843294
Validation mse = 0.021928
Epoch 46
Loss = 7.5055e-02, PNorm = 44.9209, GNorm = 2.3764, lr_0 = 1.5704e-04
Loss = 6.5839e-02, PNorm = 44.9276, GNorm = 1.6398, lr_0 = 1.5379e-04
Validation rmse = 0.131244
Validation r2 = 0.876907
Validation mse = 0.017225
Epoch 47
Loss = 6.1661e-02, PNorm = 44.9329, GNorm = 1.0394, lr_0 = 1.5061e-04
Loss = 5.7030e-02, PNorm = 44.9387, GNorm = 0.7570, lr_0 = 1.4750e-04
Validation rmse = 0.129436
Validation r2 = 0.880274
Validation mse = 0.016754
Epoch 48
Loss = 4.6254e-02, PNorm = 44.9434, GNorm = 0.7430, lr_0 = 1.4415e-04
Loss = 5.2417e-02, PNorm = 44.9481, GNorm = 0.5981, lr_0 = 1.4117e-04
Validation rmse = 0.132272
Validation r2 = 0.874970
Validation mse = 0.017496
Epoch 49
Loss = 5.2820e-02, PNorm = 44.9528, GNorm = 1.0692, lr_0 = 1.3796e-04
Loss = 5.4609e-02, PNorm = 44.9570, GNorm = 0.5711, lr_0 = 1.3511e-04
Validation rmse = 0.116198
Validation r2 = 0.903511
Validation mse = 0.013502
Epoch 50
Loss = 5.1868e-02, PNorm = 44.9625, GNorm = 0.7378, lr_0 = 1.3231e-04
Loss = 5.7671e-02, PNorm = 44.9662, GNorm = 0.6254, lr_0 = 1.2958e-04
Validation rmse = 0.128102
Validation r2 = 0.882730
Validation mse = 0.016410
Epoch 51
Loss = 6.1809e-02, PNorm = 44.9719, GNorm = 0.8400, lr_0 = 1.2663e-04
Loss = 5.2152e-02, PNorm = 44.9765, GNorm = 0.7969, lr_0 = 1.2401e-04
Validation rmse = 0.114645
Validation r2 = 0.906073
Validation mse = 0.013144
Epoch 52
Loss = 4.5247e-02, PNorm = 44.9813, GNorm = 1.5660, lr_0 = 1.2119e-04
Loss = 6.7208e-02, PNorm = 44.9858, GNorm = 1.2209, lr_0 = 1.1869e-04
Validation rmse = 0.124766
Validation r2 = 0.888757
Validation mse = 0.015567
Epoch 53
Loss = 5.2225e-02, PNorm = 44.9905, GNorm = 0.5133, lr_0 = 1.1599e-04
Loss = 5.2422e-02, PNorm = 44.9948, GNorm = 0.7154, lr_0 = 1.1359e-04
Validation rmse = 0.123798
Validation r2 = 0.890477
Validation mse = 0.015326
Epoch 54
Loss = 5.0068e-02, PNorm = 44.9994, GNorm = 0.4871, lr_0 = 1.1124e-04
Loss = 5.0681e-02, PNorm = 45.0029, GNorm = 0.9565, lr_0 = 1.0894e-04
Validation rmse = 0.121572
Validation r2 = 0.894381
Validation mse = 0.014780
Epoch 55
Loss = 4.8241e-02, PNorm = 45.0072, GNorm = 0.5005, lr_0 = 1.0647e-04
Loss = 5.2561e-02, PNorm = 45.0115, GNorm = 0.9487, lr_0 = 1.0427e-04
Loss = 2.6944e-02, PNorm = 45.0119, GNorm = 0.9534, lr_0 = 1.0405e-04
Validation rmse = 0.119447
Validation r2 = 0.898041
Validation mse = 0.014268
Epoch 56
Loss = 5.3072e-02, PNorm = 45.0160, GNorm = 0.6146, lr_0 = 1.0190e-04
Loss = 4.5378e-02, PNorm = 45.0203, GNorm = 0.7562, lr_0 = 1.0000e-04
Validation rmse = 0.120322
Validation r2 = 0.896541
Validation mse = 0.014477
Epoch 57
Loss = 4.7033e-02, PNorm = 45.0235, GNorm = 0.4817, lr_0 = 1.0000e-04
Validation rmse = 0.122493
Validation r2 = 0.892774
Validation mse = 0.015005
Epoch 58
Loss = 3.8412e-02, PNorm = 45.0272, GNorm = 0.6354, lr_0 = 1.0000e-04
Loss = 4.3632e-02, PNorm = 45.0309, GNorm = 0.8926, lr_0 = 1.0000e-04
Validation rmse = 0.129486
Validation r2 = 0.880181
Validation mse = 0.016767
Epoch 59
Loss = 6.9411e-02, PNorm = 45.0349, GNorm = 1.7767, lr_0 = 1.0000e-04
Loss = 4.3711e-02, PNorm = 45.0384, GNorm = 0.6023, lr_0 = 1.0000e-04
Validation rmse = 0.114457
Validation r2 = 0.906381
Validation mse = 0.013101
Model 0 best validation rmse = 0.114457 on epoch 59
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.161798
Model 0 test r2 = 0.762087
Model 0 test mse = 0.026179
Ensemble test rmse = 0.161798
Ensemble test r2 = 0.762087
Ensemble test mse = 0.026179
Fold 1
Splitting data with seed 1
Total size = 975 | train size = 965 | val size = 10 | test size = 57
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 1.0053e+00, PNorm = 43.2608, GNorm = 3.6768, lr_0 = 3.6053e-04
Validation rmse = 0.298897
Validation r2 = -1.614141
Validation mse = 0.089339
Epoch 1
Loss = 7.5146e-01, PNorm = 43.2874, GNorm = 1.5236, lr_0 = 6.2105e-04
Loss = 7.8468e-01, PNorm = 43.3272, GNorm = 8.0449, lr_0 = 8.5789e-04
Validation rmse = 0.213670
Validation r2 = -0.335894
Validation mse = 0.045655
Epoch 2
Loss = 4.6974e-01, PNorm = 43.3974, GNorm = 2.8022, lr_0 = 9.8961e-04
Loss = 5.0520e-01, PNorm = 43.4837, GNorm = 4.8700, lr_0 = 9.6914e-04
Validation rmse = 0.188364
Validation r2 = -0.038204
Validation mse = 0.035481
Epoch 3
Loss = 3.9857e-01, PNorm = 43.5761, GNorm = 3.0025, lr_0 = 9.4712e-04
Loss = 2.8368e-01, PNorm = 43.6553, GNorm = 5.4787, lr_0 = 9.2754e-04
Validation rmse = 0.202443
Validation r2 = -0.199200
Validation mse = 0.040983
Epoch 4
Loss = 3.1228e-01, PNorm = 43.7041, GNorm = 6.6236, lr_0 = 9.0836e-04
Loss = 2.3903e-01, PNorm = 43.7543, GNorm = 2.5449, lr_0 = 8.8958e-04
Validation rmse = 0.188152
Validation r2 = -0.035863
Validation mse = 0.035401
Epoch 5
Loss = 1.5225e-01, PNorm = 43.8103, GNorm = 1.5796, lr_0 = 8.6936e-04
Loss = 1.9738e-01, PNorm = 43.8437, GNorm = 2.4518, lr_0 = 8.5139e-04
Validation rmse = 0.177833
Validation r2 = 0.074638
Validation mse = 0.031625
Epoch 6
Loss = 1.6284e-01, PNorm = 43.8867, GNorm = 3.4259, lr_0 = 8.3204e-04
Loss = 2.2752e-01, PNorm = 43.9183, GNorm = 4.1338, lr_0 = 8.1484e-04
Validation rmse = 0.224599
Validation r2 = -0.476055
Validation mse = 0.050445
Epoch 7
Loss = 2.1230e-01, PNorm = 43.9594, GNorm = 3.5928, lr_0 = 7.9799e-04
Loss = 1.9981e-01, PNorm = 43.9952, GNorm = 5.5276, lr_0 = 7.8149e-04
Validation rmse = 0.166194
Validation r2 = 0.191801
Validation mse = 0.027621
Epoch 8
Loss = 1.6350e-01, PNorm = 44.0276, GNorm = 3.0174, lr_0 = 7.6373e-04
Loss = 1.4931e-01, PNorm = 44.0574, GNorm = 1.1038, lr_0 = 7.4794e-04
Validation rmse = 0.186923
Validation r2 = -0.022381
Validation mse = 0.034940
Epoch 9
Loss = 1.6503e-01, PNorm = 44.0931, GNorm = 1.8087, lr_0 = 7.3094e-04
Loss = 1.2194e-01, PNorm = 44.1181, GNorm = 2.5502, lr_0 = 7.1583e-04
Validation rmse = 0.172826
Validation r2 = 0.126013
Validation mse = 0.029869
Epoch 10
Loss = 1.2761e-01, PNorm = 44.1355, GNorm = 1.6548, lr_0 = 7.0103e-04
Loss = 1.3582e-01, PNorm = 44.1535, GNorm = 0.9539, lr_0 = 6.8653e-04
Validation rmse = 0.154169
Validation r2 = 0.304525
Validation mse = 0.023768
Epoch 11
Loss = 1.1642e-01, PNorm = 44.1723, GNorm = 1.1880, lr_0 = 6.7093e-04
Loss = 1.2039e-01, PNorm = 44.1893, GNorm = 1.2946, lr_0 = 6.5706e-04
Validation rmse = 0.163816
Validation r2 = 0.214765
Validation mse = 0.026836
Epoch 12
Loss = 1.3959e-01, PNorm = 44.2071, GNorm = 4.6195, lr_0 = 6.4213e-04
Loss = 1.1207e-01, PNorm = 44.2284, GNorm = 1.5012, lr_0 = 6.2885e-04
Loss = 1.5690e-01, PNorm = 44.2299, GNorm = 2.2443, lr_0 = 6.2754e-04
Validation rmse = 0.153615
Validation r2 = 0.309517
Validation mse = 0.023598
Epoch 13
Loss = 9.9026e-02, PNorm = 44.2482, GNorm = 0.9793, lr_0 = 6.1456e-04
Loss = 1.1925e-01, PNorm = 44.2667, GNorm = 2.2590, lr_0 = 6.0185e-04
Validation rmse = 0.155706
Validation r2 = 0.290591
Validation mse = 0.024244
Epoch 14
Loss = 1.2780e-01, PNorm = 44.2840, GNorm = 1.6249, lr_0 = 5.8941e-04
Validation rmse = 0.161552
Validation r2 = 0.236319
Validation mse = 0.026099
Epoch 15
Loss = 1.5730e-01, PNorm = 44.2980, GNorm = 3.3024, lr_0 = 5.7602e-04
Loss = 1.0446e-01, PNorm = 44.3127, GNorm = 1.4596, lr_0 = 5.6411e-04
Validation rmse = 0.159722
Validation r2 = 0.253523
Validation mse = 0.025511
Epoch 16
Loss = 7.3699e-02, PNorm = 44.3328, GNorm = 0.8900, lr_0 = 5.5129e-04
Loss = 9.8555e-02, PNorm = 44.3523, GNorm = 2.0344, lr_0 = 5.3989e-04
Validation rmse = 0.165057
Validation r2 = 0.202827
Validation mse = 0.027244
Epoch 17
Loss = 1.3656e-01, PNorm = 44.3677, GNorm = 1.3576, lr_0 = 5.2873e-04
Loss = 1.0360e-01, PNorm = 44.3806, GNorm = 1.5339, lr_0 = 5.1779e-04
Validation rmse = 0.149171
Validation r2 = 0.348892
Validation mse = 0.022252
Epoch 18
Loss = 1.0804e-01, PNorm = 44.3973, GNorm = 2.1058, lr_0 = 5.0603e-04
Loss = 1.0098e-01, PNorm = 44.4148, GNorm = 1.6676, lr_0 = 4.9556e-04
Validation rmse = 0.141791
Validation r2 = 0.411719
Validation mse = 0.020105
Epoch 19
Loss = 8.2663e-02, PNorm = 44.4321, GNorm = 1.6727, lr_0 = 4.8430e-04
Loss = 9.7704e-02, PNorm = 44.4441, GNorm = 1.2498, lr_0 = 4.7429e-04
Validation rmse = 0.148254
Validation r2 = 0.356869
Validation mse = 0.021979
Epoch 20
Loss = 1.1306e-01, PNorm = 44.4558, GNorm = 0.5031, lr_0 = 4.6448e-04
Loss = 8.7770e-02, PNorm = 44.4666, GNorm = 1.6902, lr_0 = 4.5488e-04
Validation rmse = 0.161195
Validation r2 = 0.239692
Validation mse = 0.025984
Epoch 21
Loss = 1.0440e-01, PNorm = 44.4801, GNorm = 1.7435, lr_0 = 4.4454e-04
Loss = 9.8112e-02, PNorm = 44.4921, GNorm = 2.9458, lr_0 = 4.3535e-04
Validation rmse = 0.160294
Validation r2 = 0.248164
Validation mse = 0.025694
Epoch 22
Loss = 6.9466e-02, PNorm = 44.5075, GNorm = 0.7397, lr_0 = 4.2546e-04
Loss = 9.5917e-02, PNorm = 44.5212, GNorm = 2.0530, lr_0 = 4.1666e-04
Validation rmse = 0.150567
Validation r2 = 0.336646
Validation mse = 0.022670
Epoch 23
Loss = 1.0146e-01, PNorm = 44.5345, GNorm = 2.4284, lr_0 = 4.0719e-04
Loss = 8.4657e-02, PNorm = 44.5461, GNorm = 1.2130, lr_0 = 3.9877e-04
Validation rmse = 0.168427
Validation r2 = 0.169934
Validation mse = 0.028368
Epoch 24
Loss = 8.7069e-02, PNorm = 44.5608, GNorm = 2.5888, lr_0 = 3.9053e-04
Loss = 9.8161e-02, PNorm = 44.5707, GNorm = 2.0890, lr_0 = 3.8245e-04
Validation rmse = 0.151961
Validation r2 = 0.324302
Validation mse = 0.023092
Epoch 25
Loss = 8.2112e-02, PNorm = 44.5873, GNorm = 0.5126, lr_0 = 3.7376e-04
Loss = 9.3112e-02, PNorm = 44.6019, GNorm = 1.5372, lr_0 = 3.6603e-04
Validation rmse = 0.139559
Validation r2 = 0.430095
Validation mse = 0.019477
Epoch 26
Loss = 7.3725e-02, PNorm = 44.6140, GNorm = 1.3342, lr_0 = 3.5772e-04
Loss = 8.6462e-02, PNorm = 44.6224, GNorm = 1.5426, lr_0 = 3.5032e-04
Validation rmse = 0.133237
Validation r2 = 0.480557
Validation mse = 0.017752
Epoch 27
Loss = 7.1470e-02, PNorm = 44.6335, GNorm = 0.3859, lr_0 = 3.4308e-04
Loss = 8.3216e-02, PNorm = 44.6427, GNorm = 0.9707, lr_0 = 3.3598e-04
Loss = 1.9354e-01, PNorm = 44.6430, GNorm = 5.4514, lr_0 = 3.3528e-04
Validation rmse = 0.141436
Validation r2 = 0.414663
Validation mse = 0.020004
Epoch 28
Loss = 8.2613e-02, PNorm = 44.6540, GNorm = 0.9113, lr_0 = 3.2835e-04
Validation rmse = 0.135780
Validation r2 = 0.460539
Validation mse = 0.018436
Epoch 29
Loss = 6.9412e-02, PNorm = 44.6639, GNorm = 0.3830, lr_0 = 3.2089e-04
Loss = 7.4727e-02, PNorm = 44.6722, GNorm = 0.5237, lr_0 = 3.1425e-04
Validation rmse = 0.138177
Validation r2 = 0.441330
Validation mse = 0.019093
Epoch 30
Loss = 4.2907e-02, PNorm = 44.6828, GNorm = 0.5713, lr_0 = 3.0775e-04
Loss = 7.4432e-02, PNorm = 44.6918, GNorm = 0.9318, lr_0 = 3.0139e-04
Validation rmse = 0.128398
Validation r2 = 0.517607
Validation mse = 0.016486
Epoch 31
Loss = 9.6348e-02, PNorm = 44.7021, GNorm = 1.6680, lr_0 = 2.9454e-04
Loss = 8.6518e-02, PNorm = 44.7122, GNorm = 1.9509, lr_0 = 2.8845e-04
Validation rmse = 0.151029
Validation r2 = 0.332571
Validation mse = 0.022810
Epoch 32
Loss = 8.0462e-02, PNorm = 44.7214, GNorm = 1.0443, lr_0 = 2.8190e-04
Loss = 8.6101e-02, PNorm = 44.7299, GNorm = 0.8025, lr_0 = 2.7607e-04
Validation rmse = 0.137344
Validation r2 = 0.448039
Validation mse = 0.018863
Epoch 33
Loss = 7.6601e-02, PNorm = 44.7413, GNorm = 0.4983, lr_0 = 2.6980e-04
Loss = 7.6544e-02, PNorm = 44.7513, GNorm = 0.9589, lr_0 = 2.6422e-04
Validation rmse = 0.138894
Validation r2 = 0.435517
Validation mse = 0.019291
Epoch 34
Loss = 8.0960e-02, PNorm = 44.7610, GNorm = 1.3336, lr_0 = 2.5875e-04
Loss = 6.9905e-02, PNorm = 44.7683, GNorm = 1.0786, lr_0 = 2.5340e-04
Validation rmse = 0.143710
Validation r2 = 0.395691
Validation mse = 0.020652
Epoch 35
Loss = 5.0819e-02, PNorm = 44.7764, GNorm = 0.7217, lr_0 = 2.4764e-04
Loss = 8.0354e-02, PNorm = 44.7835, GNorm = 0.5193, lr_0 = 2.4252e-04
Validation rmse = 0.142359
Validation r2 = 0.407002
Validation mse = 0.020266
Epoch 36
Loss = 5.1007e-02, PNorm = 44.7933, GNorm = 0.6514, lr_0 = 2.3701e-04
Loss = 7.8631e-02, PNorm = 44.8013, GNorm = 1.6849, lr_0 = 2.3211e-04
Validation rmse = 0.154053
Validation r2 = 0.305575
Validation mse = 0.023732
Epoch 37
Loss = 6.9979e-02, PNorm = 44.8099, GNorm = 2.7607, lr_0 = 2.2731e-04
Loss = 6.9800e-02, PNorm = 44.8187, GNorm = 0.9440, lr_0 = 2.2261e-04
Validation rmse = 0.136826
Validation r2 = 0.452196
Validation mse = 0.018721
Epoch 38
Loss = 6.9253e-02, PNorm = 44.8282, GNorm = 1.5553, lr_0 = 2.1755e-04
Loss = 6.7393e-02, PNorm = 44.8342, GNorm = 1.0395, lr_0 = 2.1306e-04
Validation rmse = 0.130332
Validation r2 = 0.502967
Validation mse = 0.016986
Epoch 39
Loss = 6.5082e-02, PNorm = 44.8417, GNorm = 0.6256, lr_0 = 2.0821e-04
Loss = 6.5042e-02, PNorm = 44.8495, GNorm = 1.1195, lr_0 = 2.0391e-04
Validation rmse = 0.133224
Validation r2 = 0.480664
Validation mse = 0.017749
Epoch 40
Loss = 6.4781e-02, PNorm = 44.8561, GNorm = 1.0712, lr_0 = 1.9969e-04
Loss = 6.1735e-02, PNorm = 44.8617, GNorm = 0.7965, lr_0 = 1.9556e-04
Validation rmse = 0.137496
Validation r2 = 0.446818
Validation mse = 0.018905
Epoch 41
Loss = 7.1350e-02, PNorm = 44.8708, GNorm = 0.7935, lr_0 = 1.9112e-04
Loss = 6.2093e-02, PNorm = 44.8787, GNorm = 1.4784, lr_0 = 1.8717e-04
Loss = 3.1519e-02, PNorm = 44.8792, GNorm = 1.1462, lr_0 = 1.8678e-04
Validation rmse = 0.142826
Validation r2 = 0.403101
Validation mse = 0.020399
Epoch 42
Loss = 5.9456e-02, PNorm = 44.8850, GNorm = 0.9081, lr_0 = 1.8292e-04
Validation rmse = 0.130443
Validation r2 = 0.502119
Validation mse = 0.017015
Epoch 43
Loss = 4.7434e-02, PNorm = 44.8921, GNorm = 1.0867, lr_0 = 1.7876e-04
Loss = 6.1339e-02, PNorm = 44.8982, GNorm = 0.6045, lr_0 = 1.7506e-04
Validation rmse = 0.132665
Validation r2 = 0.485008
Validation mse = 0.017600
Epoch 44
Loss = 4.0333e-02, PNorm = 44.9039, GNorm = 0.4515, lr_0 = 1.7144e-04
Loss = 5.7488e-02, PNorm = 44.9111, GNorm = 1.3339, lr_0 = 1.6790e-04
Validation rmse = 0.142247
Validation r2 = 0.407927
Validation mse = 0.020234
Epoch 45
Loss = 8.1871e-02, PNorm = 44.9172, GNorm = 2.4104, lr_0 = 1.6408e-04
Loss = 6.9560e-02, PNorm = 44.9245, GNorm = 1.2286, lr_0 = 1.6069e-04
Validation rmse = 0.127297
Validation r2 = 0.525846
Validation mse = 0.016204
Epoch 46
Loss = 5.8339e-02, PNorm = 44.9315, GNorm = 0.8698, lr_0 = 1.5704e-04
Loss = 5.6538e-02, PNorm = 44.9387, GNorm = 1.1922, lr_0 = 1.5379e-04
Validation rmse = 0.137117
Validation r2 = 0.449863
Validation mse = 0.018801
Epoch 47
Loss = 5.2576e-02, PNorm = 44.9437, GNorm = 0.7672, lr_0 = 1.5061e-04
Loss = 5.7624e-02, PNorm = 44.9493, GNorm = 0.6907, lr_0 = 1.4750e-04
Validation rmse = 0.133449
Validation r2 = 0.478904
Validation mse = 0.017809
Epoch 48
Loss = 5.4929e-02, PNorm = 44.9561, GNorm = 0.4706, lr_0 = 1.4415e-04
Loss = 6.0944e-02, PNorm = 44.9616, GNorm = 1.9652, lr_0 = 1.4117e-04
Validation rmse = 0.137969
Validation r2 = 0.443005
Validation mse = 0.019036
Epoch 49
Loss = 4.3248e-02, PNorm = 44.9675, GNorm = 0.7344, lr_0 = 1.3796e-04
Loss = 5.8952e-02, PNorm = 44.9720, GNorm = 1.2622, lr_0 = 1.3511e-04
Validation rmse = 0.134150
Validation r2 = 0.473418
Validation mse = 0.017996
Epoch 50
Loss = 5.3389e-02, PNorm = 44.9767, GNorm = 0.4931, lr_0 = 1.3231e-04
Loss = 5.0382e-02, PNorm = 44.9815, GNorm = 1.4763, lr_0 = 1.2958e-04
Validation rmse = 0.128367
Validation r2 = 0.517834
Validation mse = 0.016478
Epoch 51
Loss = 5.3933e-02, PNorm = 44.9861, GNorm = 0.4100, lr_0 = 1.2663e-04
Loss = 5.5017e-02, PNorm = 44.9915, GNorm = 1.4221, lr_0 = 1.2401e-04
Validation rmse = 0.134648
Validation r2 = 0.469496
Validation mse = 0.018130
Epoch 52
Loss = 5.3359e-02, PNorm = 44.9964, GNorm = 0.6033, lr_0 = 1.2119e-04
Loss = 5.3244e-02, PNorm = 45.0008, GNorm = 0.7196, lr_0 = 1.1869e-04
Validation rmse = 0.125339
Validation r2 = 0.540317
Validation mse = 0.015710
Epoch 53
Loss = 5.4897e-02, PNorm = 45.0069, GNorm = 1.2464, lr_0 = 1.1599e-04
Loss = 5.6174e-02, PNorm = 45.0113, GNorm = 0.5298, lr_0 = 1.1359e-04
Validation rmse = 0.133169
Validation r2 = 0.481089
Validation mse = 0.017734
Epoch 54
Loss = 5.4205e-02, PNorm = 45.0154, GNorm = 0.9110, lr_0 = 1.1124e-04
Loss = 5.1265e-02, PNorm = 45.0202, GNorm = 0.6542, lr_0 = 1.0894e-04
Validation rmse = 0.130137
Validation r2 = 0.504452
Validation mse = 0.016936
Epoch 55
Loss = 5.8165e-02, PNorm = 45.0253, GNorm = 1.6567, lr_0 = 1.0647e-04
Loss = 4.7127e-02, PNorm = 45.0291, GNorm = 0.5821, lr_0 = 1.0427e-04
Loss = 4.4407e-02, PNorm = 45.0296, GNorm = 1.1786, lr_0 = 1.0405e-04
Validation rmse = 0.129167
Validation r2 = 0.511806
Validation mse = 0.016684
Epoch 56
Loss = 5.0981e-02, PNorm = 45.0342, GNorm = 0.5654, lr_0 = 1.0190e-04
Loss = 5.1479e-02, PNorm = 45.0388, GNorm = 1.4080, lr_0 = 1.0000e-04
Validation rmse = 0.131001
Validation r2 = 0.497847
Validation mse = 0.017161
Epoch 57
Loss = 4.9083e-02, PNorm = 45.0427, GNorm = 0.4796, lr_0 = 1.0000e-04
Validation rmse = 0.127102
Validation r2 = 0.527297
Validation mse = 0.016155
Epoch 58
Loss = 4.4394e-02, PNorm = 45.0469, GNorm = 0.9507, lr_0 = 1.0000e-04
Loss = 5.2879e-02, PNorm = 45.0506, GNorm = 0.8909, lr_0 = 1.0000e-04
Validation rmse = 0.128286
Validation r2 = 0.518447
Validation mse = 0.016457
Epoch 59
Loss = 3.8494e-02, PNorm = 45.0553, GNorm = 0.7130, lr_0 = 1.0000e-04
Loss = 5.3278e-02, PNorm = 45.0597, GNorm = 0.7903, lr_0 = 1.0000e-04
Validation rmse = 0.127350
Validation r2 = 0.525446
Validation mse = 0.016218
Model 0 best validation rmse = 0.125339 on epoch 52
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.200275
Model 0 test r2 = 0.635477
Model 0 test mse = 0.040110
Ensemble test rmse = 0.200275
Ensemble test r2 = 0.635477
Ensemble test mse = 0.040110
Fold 2
Splitting data with seed 2
Total size = 975 | train size = 965 | val size = 10 | test size = 57
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.5027e-01, PNorm = 43.2636, GNorm = 1.2293, lr_0 = 3.6053e-04
Validation rmse = 0.268479
Validation r2 = 0.213495
Validation mse = 0.072081
Epoch 1
Loss = 1.0719e+00, PNorm = 43.2859, GNorm = 16.3599, lr_0 = 6.2105e-04
Loss = 6.7584e-01, PNorm = 43.3247, GNorm = 8.7200, lr_0 = 8.5789e-04
Validation rmse = 0.137638
Validation r2 = 0.793291
Validation mse = 0.018944
Epoch 2
Loss = 3.4863e-01, PNorm = 43.4085, GNorm = 3.1538, lr_0 = 9.8961e-04
Loss = 4.2437e-01, PNorm = 43.4977, GNorm = 4.3883, lr_0 = 9.6914e-04
Validation rmse = 0.188648
Validation r2 = 0.611682
Validation mse = 0.035588
Epoch 3
Loss = 3.0664e-01, PNorm = 43.5948, GNorm = 8.8772, lr_0 = 9.4712e-04
Loss = 4.3109e-01, PNorm = 43.6612, GNorm = 0.8216, lr_0 = 9.2754e-04
Validation rmse = 0.125124
Validation r2 = 0.829169
Validation mse = 0.015656
Epoch 4
Loss = 2.6153e-01, PNorm = 43.7216, GNorm = 4.7046, lr_0 = 9.0836e-04
Loss = 2.6089e-01, PNorm = 43.7808, GNorm = 0.5067, lr_0 = 8.8958e-04
Validation rmse = 0.102654
Validation r2 = 0.885016
Validation mse = 0.010538
Epoch 5
Loss = 1.9324e-01, PNorm = 43.8354, GNorm = 4.1973, lr_0 = 8.6936e-04
Loss = 1.7308e-01, PNorm = 43.8779, GNorm = 4.5373, lr_0 = 8.5139e-04
Validation rmse = 0.104958
Validation r2 = 0.879798
Validation mse = 0.011016
Epoch 6
Loss = 1.9300e-01, PNorm = 43.9167, GNorm = 1.3588, lr_0 = 8.3204e-04
Loss = 1.6410e-01, PNorm = 43.9532, GNorm = 1.5386, lr_0 = 8.1484e-04
Validation rmse = 0.100080
Validation r2 = 0.890712
Validation mse = 0.010016
Epoch 7
Loss = 1.4446e-01, PNorm = 43.9845, GNorm = 1.8588, lr_0 = 7.9799e-04
Loss = 1.4279e-01, PNorm = 44.0139, GNorm = 3.5296, lr_0 = 7.8149e-04
Validation rmse = 0.121982
Validation r2 = 0.837641
Validation mse = 0.014880
Epoch 8
Loss = 1.6108e-01, PNorm = 44.0375, GNorm = 3.2688, lr_0 = 7.6373e-04
Loss = 1.4406e-01, PNorm = 44.0652, GNorm = 1.0233, lr_0 = 7.4794e-04
Validation rmse = 0.137960
Validation r2 = 0.792322
Validation mse = 0.019033
Epoch 9
Loss = 1.1829e-01, PNorm = 44.0844, GNorm = 1.6710, lr_0 = 7.3094e-04
Loss = 1.4930e-01, PNorm = 44.1039, GNorm = 1.4556, lr_0 = 7.1583e-04
Validation rmse = 0.095450
Validation r2 = 0.900588
Validation mse = 0.009111
Epoch 10
Loss = 1.2617e-01, PNorm = 44.1291, GNorm = 1.2011, lr_0 = 7.0103e-04
Loss = 1.2859e-01, PNorm = 44.1493, GNorm = 3.7588, lr_0 = 6.8653e-04
Validation rmse = 0.093077
Validation r2 = 0.905470
Validation mse = 0.008663
Epoch 11
Loss = 1.4495e-01, PNorm = 44.1622, GNorm = 1.6918, lr_0 = 6.7093e-04
Loss = 1.2187e-01, PNorm = 44.1867, GNorm = 3.8194, lr_0 = 6.5706e-04
Validation rmse = 0.144911
Validation r2 = 0.770867
Validation mse = 0.020999
Epoch 12
Loss = 1.1746e-01, PNorm = 44.2098, GNorm = 2.6861, lr_0 = 6.4213e-04
Loss = 1.0756e-01, PNorm = 44.2272, GNorm = 1.6942, lr_0 = 6.2885e-04
Loss = 1.4379e-01, PNorm = 44.2287, GNorm = 3.2154, lr_0 = 6.2754e-04
Validation rmse = 0.093639
Validation r2 = 0.904325
Validation mse = 0.008768
Epoch 13
Loss = 1.0448e-01, PNorm = 44.2456, GNorm = 1.2846, lr_0 = 6.1456e-04
Loss = 1.0710e-01, PNorm = 44.2620, GNorm = 1.4829, lr_0 = 6.0185e-04
Validation rmse = 0.114199
Validation r2 = 0.857700
Validation mse = 0.013041
Epoch 14
Loss = 1.0473e-01, PNorm = 44.2783, GNorm = 5.1312, lr_0 = 5.8941e-04
Validation rmse = 0.131667
Validation r2 = 0.810837
Validation mse = 0.017336
Epoch 15
Loss = 1.2482e-01, PNorm = 44.2915, GNorm = 1.6160, lr_0 = 5.7602e-04
Loss = 1.0011e-01, PNorm = 44.3078, GNorm = 1.3962, lr_0 = 5.6411e-04
Validation rmse = 0.125456
Validation r2 = 0.828262
Validation mse = 0.015739
Epoch 16
Loss = 7.4876e-02, PNorm = 44.3205, GNorm = 2.4157, lr_0 = 5.5129e-04
Loss = 1.1087e-01, PNorm = 44.3346, GNorm = 1.8322, lr_0 = 5.3989e-04
Validation rmse = 0.128232
Validation r2 = 0.820577
Validation mse = 0.016444
Epoch 17
Loss = 8.0120e-02, PNorm = 44.3524, GNorm = 0.4134, lr_0 = 5.2873e-04
Loss = 8.7238e-02, PNorm = 44.3657, GNorm = 0.7820, lr_0 = 5.1779e-04
Validation rmse = 0.186756
Validation r2 = 0.619435
Validation mse = 0.034878
Epoch 18
Loss = 9.0891e-02, PNorm = 44.3767, GNorm = 0.8038, lr_0 = 5.0603e-04
Loss = 1.1035e-01, PNorm = 44.3923, GNorm = 3.3520, lr_0 = 4.9556e-04
Validation rmse = 0.140720
Validation r2 = 0.783930
Validation mse = 0.019802
Epoch 19
Loss = 1.3568e-01, PNorm = 44.4119, GNorm = 2.7880, lr_0 = 4.8430e-04
Loss = 1.2867e-01, PNorm = 44.4341, GNorm = 3.6430, lr_0 = 4.7429e-04
Validation rmse = 0.147417
Validation r2 = 0.762876
Validation mse = 0.021732
Epoch 20
Loss = 9.0267e-02, PNorm = 44.4484, GNorm = 1.4185, lr_0 = 4.6448e-04
Loss = 9.7769e-02, PNorm = 44.4607, GNorm = 0.9175, lr_0 = 4.5488e-04
Validation rmse = 0.116378
Validation r2 = 0.852218
Validation mse = 0.013544
Epoch 21
Loss = 8.4782e-02, PNorm = 44.4743, GNorm = 1.8406, lr_0 = 4.4454e-04
Loss = 9.0811e-02, PNorm = 44.4834, GNorm = 1.3147, lr_0 = 4.3535e-04
Validation rmse = 0.141599
Validation r2 = 0.781224
Validation mse = 0.020050
Epoch 22
Loss = 9.2854e-02, PNorm = 44.4975, GNorm = 1.2970, lr_0 = 4.2546e-04
Loss = 8.2499e-02, PNorm = 44.5091, GNorm = 0.9780, lr_0 = 4.1666e-04
Validation rmse = 0.159902
Validation r2 = 0.721008
Validation mse = 0.025569
Epoch 23
Loss = 8.6263e-02, PNorm = 44.5233, GNorm = 1.6116, lr_0 = 4.0719e-04
Loss = 9.1135e-02, PNorm = 44.5366, GNorm = 1.9681, lr_0 = 3.9877e-04
Validation rmse = 0.146029
Validation r2 = 0.767319
Validation mse = 0.021324
Epoch 24
Loss = 8.6411e-02, PNorm = 44.5471, GNorm = 1.9425, lr_0 = 3.9053e-04
Loss = 8.6635e-02, PNorm = 44.5578, GNorm = 0.7004, lr_0 = 3.8245e-04
Validation rmse = 0.160862
Validation r2 = 0.717648
Validation mse = 0.025877
Epoch 25
Loss = 8.5092e-02, PNorm = 44.5664, GNorm = 2.8568, lr_0 = 3.7376e-04
Loss = 8.5666e-02, PNorm = 44.5730, GNorm = 1.5574, lr_0 = 3.6603e-04
Validation rmse = 0.164849
Validation r2 = 0.703479
Validation mse = 0.027175
Epoch 26
Loss = 8.5094e-02, PNorm = 44.5850, GNorm = 2.0570, lr_0 = 3.5772e-04
Loss = 8.2642e-02, PNorm = 44.5943, GNorm = 0.5631, lr_0 = 3.5032e-04
Validation rmse = 0.123047
Validation r2 = 0.834796
Validation mse = 0.015140
Epoch 27
Loss = 7.5688e-02, PNorm = 44.6064, GNorm = 0.7176, lr_0 = 3.4308e-04
Loss = 7.6500e-02, PNorm = 44.6147, GNorm = 1.0838, lr_0 = 3.3598e-04
Loss = 5.7253e-02, PNorm = 44.6155, GNorm = 1.9412, lr_0 = 3.3528e-04
Validation rmse = 0.141067
Validation r2 = 0.782862
Validation mse = 0.019900
Epoch 28
Loss = 7.6841e-02, PNorm = 44.6250, GNorm = 1.7738, lr_0 = 3.2835e-04
Validation rmse = 0.147288
Validation r2 = 0.763290
Validation mse = 0.021694
Epoch 29
Loss = 6.7813e-02, PNorm = 44.6330, GNorm = 0.8301, lr_0 = 3.2089e-04
Loss = 7.5325e-02, PNorm = 44.6416, GNorm = 3.1436, lr_0 = 3.1425e-04
Validation rmse = 0.131806
Validation r2 = 0.810439
Validation mse = 0.017373
Epoch 30
Loss = 6.5102e-02, PNorm = 44.6495, GNorm = 1.1836, lr_0 = 3.0775e-04
Loss = 8.2731e-02, PNorm = 44.6593, GNorm = 2.3269, lr_0 = 3.0139e-04
Validation rmse = 0.116545
Validation r2 = 0.851792
Validation mse = 0.013583
Epoch 31
Loss = 9.5018e-02, PNorm = 44.6713, GNorm = 3.3346, lr_0 = 2.9454e-04
Loss = 8.3227e-02, PNorm = 44.6815, GNorm = 1.6493, lr_0 = 2.8845e-04
Validation rmse = 0.134503
Validation r2 = 0.802601
Validation mse = 0.018091
Epoch 32
Loss = 9.5292e-02, PNorm = 44.6909, GNorm = 2.7607, lr_0 = 2.8190e-04
Loss = 9.7869e-02, PNorm = 44.7018, GNorm = 4.4257, lr_0 = 2.7607e-04
Validation rmse = 0.135690
Validation r2 = 0.799100
Validation mse = 0.018412
Epoch 33
Loss = 8.1080e-02, PNorm = 44.7150, GNorm = 1.5085, lr_0 = 2.6980e-04
Loss = 7.9198e-02, PNorm = 44.7244, GNorm = 2.3058, lr_0 = 2.6422e-04
Validation rmse = 0.170471
Validation r2 = 0.682908
Validation mse = 0.029060
Epoch 34
Loss = 9.0074e-02, PNorm = 44.7331, GNorm = 1.5272, lr_0 = 2.5875e-04
Loss = 7.0771e-02, PNorm = 44.7419, GNorm = 2.0817, lr_0 = 2.5340e-04
Validation rmse = 0.179642
Validation r2 = 0.647874
Validation mse = 0.032271
Epoch 35
Loss = 7.6964e-02, PNorm = 44.7504, GNorm = 1.3176, lr_0 = 2.4764e-04
Loss = 7.4391e-02, PNorm = 44.7572, GNorm = 1.0306, lr_0 = 2.4252e-04
Validation rmse = 0.154216
Validation r2 = 0.740496
Validation mse = 0.023783
Epoch 36
Loss = 6.9863e-02, PNorm = 44.7648, GNorm = 0.8169, lr_0 = 2.3701e-04
Loss = 6.4861e-02, PNorm = 44.7710, GNorm = 1.1554, lr_0 = 2.3211e-04
Validation rmse = 0.148606
Validation r2 = 0.759035
Validation mse = 0.022084
Epoch 37
Loss = 5.9013e-02, PNorm = 44.7769, GNorm = 1.7066, lr_0 = 2.2731e-04
Loss = 6.2287e-02, PNorm = 44.7820, GNorm = 0.6037, lr_0 = 2.2261e-04
Validation rmse = 0.175107
Validation r2 = 0.665429
Validation mse = 0.030662
Epoch 38
Loss = 6.5062e-02, PNorm = 44.7905, GNorm = 2.0801, lr_0 = 2.1755e-04
Loss = 7.0483e-02, PNorm = 44.7977, GNorm = 0.6326, lr_0 = 2.1306e-04
Validation rmse = 0.130615
Validation r2 = 0.813847
Validation mse = 0.017060
Epoch 39
Loss = 5.9642e-02, PNorm = 44.8039, GNorm = 1.5477, lr_0 = 2.0821e-04
Loss = 7.2297e-02, PNorm = 44.8111, GNorm = 2.0991, lr_0 = 2.0391e-04
Validation rmse = 0.139934
Validation r2 = 0.786337
Validation mse = 0.019582
Epoch 40
Loss = 6.1189e-02, PNorm = 44.8179, GNorm = 0.4714, lr_0 = 1.9969e-04
Loss = 6.6353e-02, PNorm = 44.8245, GNorm = 0.9469, lr_0 = 1.9556e-04
Validation rmse = 0.142087
Validation r2 = 0.779711
Validation mse = 0.020189
Epoch 41
Loss = 7.7101e-02, PNorm = 44.8332, GNorm = 1.2629, lr_0 = 1.9112e-04
Loss = 5.5616e-02, PNorm = 44.8388, GNorm = 0.9462, lr_0 = 1.8717e-04
Loss = 7.2409e-02, PNorm = 44.8395, GNorm = 0.9773, lr_0 = 1.8678e-04
Validation rmse = 0.143853
Validation r2 = 0.774201
Validation mse = 0.020694
Epoch 42
Loss = 6.1997e-02, PNorm = 44.8452, GNorm = 0.8536, lr_0 = 1.8292e-04
Validation rmse = 0.145893
Validation r2 = 0.767752
Validation mse = 0.021285
Epoch 43
Loss = 6.1312e-02, PNorm = 44.8521, GNorm = 0.6750, lr_0 = 1.7876e-04
Loss = 5.7307e-02, PNorm = 44.8575, GNorm = 0.7125, lr_0 = 1.7506e-04
Validation rmse = 0.133475
Validation r2 = 0.805605
Validation mse = 0.017816
Epoch 44
Loss = 5.8955e-02, PNorm = 44.8636, GNorm = 1.0430, lr_0 = 1.7144e-04
Loss = 6.7496e-02, PNorm = 44.8687, GNorm = 1.8507, lr_0 = 1.6790e-04
Validation rmse = 0.146530
Validation r2 = 0.765721
Validation mse = 0.021471
Epoch 45
Loss = 5.0631e-02, PNorm = 44.8748, GNorm = 0.5826, lr_0 = 1.6408e-04
Loss = 5.4480e-02, PNorm = 44.8806, GNorm = 1.2831, lr_0 = 1.6069e-04
Validation rmse = 0.139876
Validation r2 = 0.786514
Validation mse = 0.019565
Epoch 46
Loss = 5.4910e-02, PNorm = 44.8861, GNorm = 1.0494, lr_0 = 1.5704e-04
Loss = 5.6543e-02, PNorm = 44.8895, GNorm = 1.8647, lr_0 = 1.5379e-04
Validation rmse = 0.164008
Validation r2 = 0.706499
Validation mse = 0.026898
Epoch 47
Loss = 5.4381e-02, PNorm = 44.8958, GNorm = 0.5888, lr_0 = 1.5061e-04
Loss = 6.1746e-02, PNorm = 44.9021, GNorm = 1.2807, lr_0 = 1.4750e-04
Validation rmse = 0.144470
Validation r2 = 0.772261
Validation mse = 0.020872
Epoch 48
Loss = 4.6644e-02, PNorm = 44.9061, GNorm = 0.8926, lr_0 = 1.4415e-04
Loss = 5.5317e-02, PNorm = 44.9116, GNorm = 1.7045, lr_0 = 1.4117e-04
Validation rmse = 0.165553
Validation r2 = 0.700941
Validation mse = 0.027408
Epoch 49
Loss = 7.0205e-02, PNorm = 44.9169, GNorm = 1.4014, lr_0 = 1.3796e-04
Loss = 5.2949e-02, PNorm = 44.9221, GNorm = 0.9817, lr_0 = 1.3511e-04
Validation rmse = 0.138512
Validation r2 = 0.790658
Validation mse = 0.019186
Epoch 50
Loss = 6.5409e-02, PNorm = 44.9273, GNorm = 0.6769, lr_0 = 1.3231e-04
Loss = 5.5376e-02, PNorm = 44.9320, GNorm = 0.5592, lr_0 = 1.2958e-04
Validation rmse = 0.161840
Validation r2 = 0.714206
Validation mse = 0.026192
Epoch 51
Loss = 5.4212e-02, PNorm = 44.9358, GNorm = 0.8389, lr_0 = 1.2663e-04
Loss = 4.9566e-02, PNorm = 44.9401, GNorm = 0.5321, lr_0 = 1.2401e-04
Validation rmse = 0.153417
Validation r2 = 0.743181
Validation mse = 0.023537
Epoch 52
Loss = 6.0552e-02, PNorm = 44.9442, GNorm = 1.1430, lr_0 = 1.2119e-04
Loss = 5.3744e-02, PNorm = 44.9491, GNorm = 0.7005, lr_0 = 1.1869e-04
Validation rmse = 0.162570
Validation r2 = 0.711623
Validation mse = 0.026429
Epoch 53
Loss = 4.7585e-02, PNorm = 44.9540, GNorm = 0.4401, lr_0 = 1.1599e-04
Loss = 5.6408e-02, PNorm = 44.9587, GNorm = 1.1091, lr_0 = 1.1359e-04
Validation rmse = 0.148702
Validation r2 = 0.758723
Validation mse = 0.022112
Epoch 54
Loss = 5.4419e-02, PNorm = 44.9624, GNorm = 0.5338, lr_0 = 1.1124e-04
Loss = 5.2674e-02, PNorm = 44.9663, GNorm = 1.0298, lr_0 = 1.0894e-04
Validation rmse = 0.154430
Validation r2 = 0.739776
Validation mse = 0.023849
Epoch 55
Loss = 4.8726e-02, PNorm = 44.9703, GNorm = 1.3339, lr_0 = 1.0647e-04
Loss = 5.3307e-02, PNorm = 44.9746, GNorm = 0.8894, lr_0 = 1.0427e-04
Loss = 4.9460e-02, PNorm = 44.9751, GNorm = 1.0437, lr_0 = 1.0405e-04
Validation rmse = 0.151725
Validation r2 = 0.748814
Validation mse = 0.023020
Epoch 56
Loss = 5.4141e-02, PNorm = 44.9788, GNorm = 1.6287, lr_0 = 1.0190e-04
Loss = 4.7458e-02, PNorm = 44.9826, GNorm = 2.0719, lr_0 = 1.0000e-04
Validation rmse = 0.152329
Validation r2 = 0.746808
Validation mse = 0.023204
Epoch 57
Loss = 4.7710e-02, PNorm = 44.9859, GNorm = 0.6452, lr_0 = 1.0000e-04
Validation rmse = 0.153876
Validation r2 = 0.741642
Validation mse = 0.023678
Epoch 58
Loss = 3.9312e-02, PNorm = 44.9896, GNorm = 0.6639, lr_0 = 1.0000e-04
Loss = 4.6229e-02, PNorm = 44.9925, GNorm = 2.6050, lr_0 = 1.0000e-04
Validation rmse = 0.163124
Validation r2 = 0.709654
Validation mse = 0.026609
Epoch 59
Loss = 4.0039e-02, PNorm = 44.9970, GNorm = 0.8899, lr_0 = 1.0000e-04
Loss = 4.8508e-02, PNorm = 45.0007, GNorm = 0.4384, lr_0 = 1.0000e-04
Validation rmse = 0.158469
Validation r2 = 0.725988
Validation mse = 0.025112
Model 0 best validation rmse = 0.093077 on epoch 10
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.180687
Model 0 test r2 = 0.703295
Model 0 test mse = 0.032648
Ensemble test rmse = 0.180687
Ensemble test r2 = 0.703295
Ensemble test mse = 0.032648
Fold 3
Splitting data with seed 3
Total size = 975 | train size = 965 | val size = 10 | test size = 57
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 8.9905e-01, PNorm = 43.2659, GNorm = 2.1734, lr_0 = 3.6053e-04
Validation rmse = 0.311521
Validation r2 = 0.364328
Validation mse = 0.097045
Epoch 1
Loss = 5.2821e-01, PNorm = 43.2918, GNorm = 7.7380, lr_0 = 6.2105e-04
Loss = 5.6837e-01, PNorm = 43.3389, GNorm = 5.5013, lr_0 = 8.5789e-04
Validation rmse = 0.263060
Validation r2 = 0.546718
Validation mse = 0.069201
Epoch 2
Loss = 3.1426e-01, PNorm = 43.4233, GNorm = 3.9574, lr_0 = 9.8961e-04
Loss = 3.9510e-01, PNorm = 43.5060, GNorm = 8.4898, lr_0 = 9.6914e-04
Validation rmse = 0.233018
Validation r2 = 0.644339
Validation mse = 0.054297
Epoch 3
Loss = 2.7937e-01, PNorm = 43.5744, GNorm = 3.8659, lr_0 = 9.4712e-04
Loss = 2.7442e-01, PNorm = 43.6345, GNorm = 8.0893, lr_0 = 9.2754e-04
Validation rmse = 0.186756
Validation r2 = 0.771541
Validation mse = 0.034878
Epoch 4
Loss = 2.1482e-01, PNorm = 43.6750, GNorm = 7.1573, lr_0 = 9.0836e-04
Loss = 2.1001e-01, PNorm = 43.7189, GNorm = 3.2143, lr_0 = 8.8958e-04
Validation rmse = 0.146244
Validation r2 = 0.859908
Validation mse = 0.021387
Epoch 5
Loss = 2.0546e-01, PNorm = 43.7631, GNorm = 1.7417, lr_0 = 8.6936e-04
Loss = 1.5283e-01, PNorm = 43.7998, GNorm = 3.3230, lr_0 = 8.5139e-04
Validation rmse = 0.186973
Validation r2 = 0.771011
Validation mse = 0.034959
Epoch 6
Loss = 2.3131e-01, PNorm = 43.8290, GNorm = 4.2975, lr_0 = 8.3204e-04
Loss = 1.9040e-01, PNorm = 43.8588, GNorm = 4.0629, lr_0 = 8.1484e-04
Validation rmse = 0.136265
Validation r2 = 0.878374
Validation mse = 0.018568
Epoch 7
Loss = 1.4605e-01, PNorm = 43.8906, GNorm = 1.6975, lr_0 = 7.9799e-04
Loss = 1.5720e-01, PNorm = 43.9229, GNorm = 3.8821, lr_0 = 7.8149e-04
Validation rmse = 0.126001
Validation r2 = 0.896006
Validation mse = 0.015876
Epoch 8
Loss = 1.4583e-01, PNorm = 43.9412, GNorm = 1.4016, lr_0 = 7.6373e-04
Loss = 1.6400e-01, PNorm = 43.9684, GNorm = 3.4746, lr_0 = 7.4794e-04
Validation rmse = 0.148357
Validation r2 = 0.855830
Validation mse = 0.022010
Epoch 9
Loss = 1.5981e-01, PNorm = 43.9947, GNorm = 2.7754, lr_0 = 7.3094e-04
Loss = 1.4358e-01, PNorm = 44.0153, GNorm = 1.6337, lr_0 = 7.1583e-04
Validation rmse = 0.119126
Validation r2 = 0.907045
Validation mse = 0.014191
Epoch 10
Loss = 1.6115e-01, PNorm = 44.0395, GNorm = 5.0968, lr_0 = 7.0103e-04
Loss = 1.1182e-01, PNorm = 44.0627, GNorm = 2.0920, lr_0 = 6.8653e-04
Validation rmse = 0.151314
Validation r2 = 0.850026
Validation mse = 0.022896
Epoch 11
Loss = 1.4303e-01, PNorm = 44.0772, GNorm = 0.7602, lr_0 = 6.7093e-04
Loss = 1.1735e-01, PNorm = 44.0987, GNorm = 1.2844, lr_0 = 6.5706e-04
Validation rmse = 0.136916
Validation r2 = 0.877210
Validation mse = 0.018746
Epoch 12
Loss = 1.0739e-01, PNorm = 44.1143, GNorm = 0.4839, lr_0 = 6.4213e-04
Loss = 1.1559e-01, PNorm = 44.1289, GNorm = 1.6705, lr_0 = 6.2885e-04
Loss = 1.2706e-01, PNorm = 44.1308, GNorm = 5.6647, lr_0 = 6.2754e-04
Validation rmse = 0.125027
Validation r2 = 0.897607
Validation mse = 0.015632
Epoch 13
Loss = 1.4283e-01, PNorm = 44.1483, GNorm = 4.2885, lr_0 = 6.1456e-04
Loss = 1.3122e-01, PNorm = 44.1696, GNorm = 3.9661, lr_0 = 6.0185e-04
Validation rmse = 0.124545
Validation r2 = 0.898396
Validation mse = 0.015512
Epoch 14
Loss = 1.1644e-01, PNorm = 44.1900, GNorm = 2.9596, lr_0 = 5.8941e-04
Validation rmse = 0.135369
Validation r2 = 0.879968
Validation mse = 0.018325
Epoch 15
Loss = 9.8708e-02, PNorm = 44.2119, GNorm = 2.4611, lr_0 = 5.7602e-04
Loss = 1.2509e-01, PNorm = 44.2264, GNorm = 1.6661, lr_0 = 5.6411e-04
Validation rmse = 0.120150
Validation r2 = 0.905440
Validation mse = 0.014436
Epoch 16
Loss = 1.1344e-01, PNorm = 44.2436, GNorm = 2.0405, lr_0 = 5.5129e-04
Loss = 9.4656e-02, PNorm = 44.2561, GNorm = 0.8008, lr_0 = 5.3989e-04
Validation rmse = 0.123750
Validation r2 = 0.899690
Validation mse = 0.015314
Epoch 17
Loss = 9.0751e-02, PNorm = 44.2702, GNorm = 1.5573, lr_0 = 5.2873e-04
Loss = 1.1133e-01, PNorm = 44.2816, GNorm = 4.0934, lr_0 = 5.1779e-04
Validation rmse = 0.126230
Validation r2 = 0.895629
Validation mse = 0.015934
Epoch 18
Loss = 8.5267e-02, PNorm = 44.2951, GNorm = 2.4009, lr_0 = 5.0603e-04
Loss = 1.0719e-01, PNorm = 44.3049, GNorm = 2.4427, lr_0 = 4.9556e-04
Validation rmse = 0.117533
Validation r2 = 0.909515
Validation mse = 0.013814
Epoch 19
Loss = 1.2887e-01, PNorm = 44.3225, GNorm = 1.3274, lr_0 = 4.8430e-04
Loss = 1.0317e-01, PNorm = 44.3335, GNorm = 3.8594, lr_0 = 4.7429e-04
Validation rmse = 0.119067
Validation r2 = 0.907137
Validation mse = 0.014177
Epoch 20
Loss = 9.2228e-02, PNorm = 44.3466, GNorm = 2.1468, lr_0 = 4.6448e-04
Loss = 1.0360e-01, PNorm = 44.3564, GNorm = 1.1695, lr_0 = 4.5488e-04
Validation rmse = 0.118070
Validation r2 = 0.908686
Validation mse = 0.013940
Epoch 21
Loss = 9.8392e-02, PNorm = 44.3691, GNorm = 3.3779, lr_0 = 4.4454e-04
Loss = 9.6519e-02, PNorm = 44.3785, GNorm = 1.3136, lr_0 = 4.3535e-04
Validation rmse = 0.124122
Validation r2 = 0.899084
Validation mse = 0.015406
Epoch 22
Loss = 9.3641e-02, PNorm = 44.3927, GNorm = 0.5769, lr_0 = 4.2546e-04
Loss = 9.0451e-02, PNorm = 44.4020, GNorm = 0.9088, lr_0 = 4.1666e-04
Validation rmse = 0.113524
Validation r2 = 0.915582
Validation mse = 0.012888
Epoch 23
Loss = 9.8315e-02, PNorm = 44.4142, GNorm = 2.6486, lr_0 = 4.0719e-04
Loss = 9.2574e-02, PNorm = 44.4247, GNorm = 0.5048, lr_0 = 3.9877e-04
Validation rmse = 0.120723
Validation r2 = 0.904537
Validation mse = 0.014574
Epoch 24
Loss = 7.7575e-02, PNorm = 44.4366, GNorm = 2.7112, lr_0 = 3.9053e-04
Loss = 1.1598e-01, PNorm = 44.4466, GNorm = 1.6754, lr_0 = 3.8245e-04
Validation rmse = 0.121972
Validation r2 = 0.902551
Validation mse = 0.014877
Epoch 25
Loss = 1.0483e-01, PNorm = 44.4597, GNorm = 1.6439, lr_0 = 3.7376e-04
Loss = 7.9563e-02, PNorm = 44.4723, GNorm = 1.0549, lr_0 = 3.6603e-04
Validation rmse = 0.113092
Validation r2 = 0.916224
Validation mse = 0.012790
Epoch 26
Loss = 9.0244e-02, PNorm = 44.4827, GNorm = 2.8449, lr_0 = 3.5772e-04
Loss = 8.8868e-02, PNorm = 44.4935, GNorm = 1.2141, lr_0 = 3.5032e-04
Validation rmse = 0.118697
Validation r2 = 0.907714
Validation mse = 0.014089
Epoch 27
Loss = 6.9245e-02, PNorm = 44.5022, GNorm = 0.6623, lr_0 = 3.4308e-04
Loss = 9.2155e-02, PNorm = 44.5099, GNorm = 0.6826, lr_0 = 3.3598e-04
Loss = 1.1703e-01, PNorm = 44.5107, GNorm = 1.1883, lr_0 = 3.3528e-04
Validation rmse = 0.134124
Validation r2 = 0.882166
Validation mse = 0.017989
Epoch 28
Loss = 8.0615e-02, PNorm = 44.5212, GNorm = 1.6124, lr_0 = 3.2835e-04
Validation rmse = 0.122954
Validation r2 = 0.900976
Validation mse = 0.015118
Epoch 29
Loss = 1.1493e-01, PNorm = 44.5325, GNorm = 1.5301, lr_0 = 3.2089e-04
Loss = 8.0501e-02, PNorm = 44.5403, GNorm = 2.0705, lr_0 = 3.1425e-04
Validation rmse = 0.112861
Validation r2 = 0.916565
Validation mse = 0.012738
Epoch 30
Loss = 8.3444e-02, PNorm = 44.5498, GNorm = 2.5590, lr_0 = 3.0775e-04
Loss = 7.7853e-02, PNorm = 44.5565, GNorm = 0.6538, lr_0 = 3.0139e-04
Validation rmse = 0.113462
Validation r2 = 0.915675
Validation mse = 0.012874
Epoch 31
Loss = 9.4721e-02, PNorm = 44.5649, GNorm = 3.2696, lr_0 = 2.9454e-04
Loss = 6.8069e-02, PNorm = 44.5723, GNorm = 1.1863, lr_0 = 2.8845e-04
Validation rmse = 0.114442
Validation r2 = 0.914212
Validation mse = 0.013097
Epoch 32
Loss = 8.1121e-02, PNorm = 44.5791, GNorm = 3.6643, lr_0 = 2.8190e-04
Loss = 9.0649e-02, PNorm = 44.5854, GNorm = 3.5694, lr_0 = 2.7607e-04
Validation rmse = 0.120177
Validation r2 = 0.905397
Validation mse = 0.014443
Epoch 33
Loss = 6.6606e-02, PNorm = 44.5964, GNorm = 0.9600, lr_0 = 2.6980e-04
Loss = 8.3513e-02, PNorm = 44.6045, GNorm = 2.3448, lr_0 = 2.6422e-04
Validation rmse = 0.128549
Validation r2 = 0.891758
Validation mse = 0.016525
Epoch 34
Loss = 7.2090e-02, PNorm = 44.6130, GNorm = 0.9356, lr_0 = 2.5875e-04
Loss = 7.7340e-02, PNorm = 44.6211, GNorm = 0.8957, lr_0 = 2.5340e-04
Validation rmse = 0.110822
Validation r2 = 0.919553
Validation mse = 0.012281
Epoch 35
Loss = 8.1709e-02, PNorm = 44.6291, GNorm = 0.5534, lr_0 = 2.4764e-04
Loss = 7.0442e-02, PNorm = 44.6358, GNorm = 3.0759, lr_0 = 2.4252e-04
Validation rmse = 0.115376
Validation r2 = 0.912805
Validation mse = 0.013312
Epoch 36
Loss = 7.2951e-02, PNorm = 44.6424, GNorm = 0.7278, lr_0 = 2.3701e-04
Loss = 7.1187e-02, PNorm = 44.6497, GNorm = 1.5375, lr_0 = 2.3211e-04
Validation rmse = 0.104462
Validation r2 = 0.928522
Validation mse = 0.010912
Epoch 37
Loss = 7.8425e-02, PNorm = 44.6574, GNorm = 0.9121, lr_0 = 2.2731e-04
Loss = 6.7394e-02, PNorm = 44.6644, GNorm = 1.5718, lr_0 = 2.2261e-04
Validation rmse = 0.122174
Validation r2 = 0.902228
Validation mse = 0.014926
Epoch 38
Loss = 7.1390e-02, PNorm = 44.6701, GNorm = 1.4451, lr_0 = 2.1755e-04
Loss = 6.9473e-02, PNorm = 44.6769, GNorm = 0.9889, lr_0 = 2.1306e-04
Validation rmse = 0.113349
Validation r2 = 0.915843
Validation mse = 0.012848
Epoch 39
Loss = 7.4064e-02, PNorm = 44.6822, GNorm = 2.4633, lr_0 = 2.0821e-04
Loss = 7.2626e-02, PNorm = 44.6893, GNorm = 1.4257, lr_0 = 2.0391e-04
Validation rmse = 0.114903
Validation r2 = 0.913518
Validation mse = 0.013203
Epoch 40
Loss = 6.4306e-02, PNorm = 44.6950, GNorm = 1.1864, lr_0 = 1.9969e-04
Loss = 6.5183e-02, PNorm = 44.7026, GNorm = 1.2630, lr_0 = 1.9556e-04
Validation rmse = 0.111131
Validation r2 = 0.919104
Validation mse = 0.012350
Epoch 41
Loss = 6.4250e-02, PNorm = 44.7097, GNorm = 1.0763, lr_0 = 1.9112e-04
Loss = 6.7910e-02, PNorm = 44.7151, GNorm = 0.6472, lr_0 = 1.8717e-04
Loss = 7.6248e-02, PNorm = 44.7158, GNorm = 2.1077, lr_0 = 1.8678e-04
Validation rmse = 0.108293
Validation r2 = 0.923183
Validation mse = 0.011727
Epoch 42
Loss = 6.3690e-02, PNorm = 44.7226, GNorm = 1.1026, lr_0 = 1.8292e-04
Validation rmse = 0.112660
Validation r2 = 0.916862
Validation mse = 0.012692
Epoch 43
Loss = 7.7455e-02, PNorm = 44.7288, GNorm = 0.9135, lr_0 = 1.7876e-04
Loss = 7.1433e-02, PNorm = 44.7347, GNorm = 0.9059, lr_0 = 1.7506e-04
Validation rmse = 0.121624
Validation r2 = 0.903106
Validation mse = 0.014792
Epoch 44
Loss = 6.5199e-02, PNorm = 44.7390, GNorm = 2.4553, lr_0 = 1.7144e-04
Loss = 6.5857e-02, PNorm = 44.7445, GNorm = 1.5367, lr_0 = 1.6790e-04
Validation rmse = 0.113235
Validation r2 = 0.916012
Validation mse = 0.012822
Epoch 45
Loss = 6.6503e-02, PNorm = 44.7507, GNorm = 1.0919, lr_0 = 1.6408e-04
Loss = 6.9574e-02, PNorm = 44.7550, GNorm = 0.5430, lr_0 = 1.6069e-04
Validation rmse = 0.114332
Validation r2 = 0.914376
Validation mse = 0.013072
Epoch 46
Loss = 6.9824e-02, PNorm = 44.7609, GNorm = 1.1211, lr_0 = 1.5704e-04
Loss = 6.5755e-02, PNorm = 44.7670, GNorm = 0.9531, lr_0 = 1.5379e-04
Validation rmse = 0.117716
Validation r2 = 0.909232
Validation mse = 0.013857
Epoch 47
Loss = 7.0515e-02, PNorm = 44.7721, GNorm = 1.5900, lr_0 = 1.5061e-04
Loss = 5.6921e-02, PNorm = 44.7768, GNorm = 1.3179, lr_0 = 1.4750e-04
Validation rmse = 0.117327
Validation r2 = 0.909831
Validation mse = 0.013766
Epoch 48
Loss = 6.2543e-02, PNorm = 44.7819, GNorm = 0.9668, lr_0 = 1.4415e-04
Loss = 6.1750e-02, PNorm = 44.7869, GNorm = 0.8666, lr_0 = 1.4117e-04
Validation rmse = 0.110276
Validation r2 = 0.920344
Validation mse = 0.012161
Epoch 49
Loss = 5.3877e-02, PNorm = 44.7920, GNorm = 0.4923, lr_0 = 1.3796e-04
Loss = 5.8566e-02, PNorm = 44.7953, GNorm = 1.5978, lr_0 = 1.3511e-04
Validation rmse = 0.122845
Validation r2 = 0.901151
Validation mse = 0.015091
Epoch 50
Loss = 6.0722e-02, PNorm = 44.7994, GNorm = 0.6115, lr_0 = 1.3231e-04
Loss = 5.8645e-02, PNorm = 44.8042, GNorm = 0.3954, lr_0 = 1.2958e-04
Validation rmse = 0.110780
Validation r2 = 0.919614
Validation mse = 0.012272
Epoch 51
Loss = 5.6572e-02, PNorm = 44.8082, GNorm = 1.5957, lr_0 = 1.2663e-04
Loss = 6.5639e-02, PNorm = 44.8125, GNorm = 0.5852, lr_0 = 1.2401e-04
Validation rmse = 0.116221
Validation r2 = 0.911524
Validation mse = 0.013507
Epoch 52
Loss = 6.3529e-02, PNorm = 44.8180, GNorm = 1.7535, lr_0 = 1.2119e-04
Loss = 6.0543e-02, PNorm = 44.8217, GNorm = 2.4621, lr_0 = 1.1869e-04
Validation rmse = 0.108817
Validation r2 = 0.922438
Validation mse = 0.011841
Epoch 53
Loss = 6.1029e-02, PNorm = 44.8269, GNorm = 0.9115, lr_0 = 1.1599e-04
Loss = 5.6709e-02, PNorm = 44.8299, GNorm = 1.1945, lr_0 = 1.1359e-04
Validation rmse = 0.109718
Validation r2 = 0.921147
Validation mse = 0.012038
Epoch 54
Loss = 5.9971e-02, PNorm = 44.8339, GNorm = 0.7735, lr_0 = 1.1124e-04
Loss = 5.2627e-02, PNorm = 44.8372, GNorm = 0.6183, lr_0 = 1.0894e-04
Validation rmse = 0.119957
Validation r2 = 0.905744
Validation mse = 0.014390
Epoch 55
Loss = 5.7155e-02, PNorm = 44.8411, GNorm = 0.7664, lr_0 = 1.0647e-04
Loss = 5.7012e-02, PNorm = 44.8442, GNorm = 2.5298, lr_0 = 1.0427e-04
Loss = 1.5921e-02, PNorm = 44.8446, GNorm = 0.4510, lr_0 = 1.0405e-04
Validation rmse = 0.116514
Validation r2 = 0.911077
Validation mse = 0.013576
Epoch 56
Loss = 5.4802e-02, PNorm = 44.8487, GNorm = 0.6264, lr_0 = 1.0190e-04
Loss = 5.7210e-02, PNorm = 44.8522, GNorm = 1.1284, lr_0 = 1.0000e-04
Validation rmse = 0.113496
Validation r2 = 0.915624
Validation mse = 0.012881
Epoch 57
Loss = 5.2691e-02, PNorm = 44.8546, GNorm = 0.6885, lr_0 = 1.0000e-04
Validation rmse = 0.111242
Validation r2 = 0.918943
Validation mse = 0.012375
Epoch 58
Loss = 6.1187e-02, PNorm = 44.8592, GNorm = 2.2105, lr_0 = 1.0000e-04
Loss = 5.5693e-02, PNorm = 44.8621, GNorm = 0.9805, lr_0 = 1.0000e-04
Validation rmse = 0.118711
Validation r2 = 0.907692
Validation mse = 0.014092
Epoch 59
Loss = 5.2341e-02, PNorm = 44.8663, GNorm = 1.2302, lr_0 = 1.0000e-04
Loss = 6.1325e-02, PNorm = 44.8699, GNorm = 2.2674, lr_0 = 1.0000e-04
Validation rmse = 0.118650
Validation r2 = 0.907787
Validation mse = 0.014078
Model 0 best validation rmse = 0.104462 on epoch 36
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.173839
Model 0 test r2 = 0.725359
Model 0 test mse = 0.030220
Ensemble test rmse = 0.173839
Ensemble test r2 = 0.725359
Ensemble test mse = 0.030220
Fold 4
Splitting data with seed 4
Total size = 975 | train size = 965 | val size = 10 | test size = 57
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.1142e-01, PNorm = 43.2625, GNorm = 1.9922, lr_0 = 3.6053e-04
Validation rmse = 0.331418
Validation r2 = 0.003463
Validation mse = 0.109838
Epoch 1
Loss = 8.5114e-01, PNorm = 43.2920, GNorm = 17.2643, lr_0 = 6.2105e-04
Loss = 7.8297e-01, PNorm = 43.3234, GNorm = 11.5719, lr_0 = 8.5789e-04
Validation rmse = 0.306058
Validation r2 = 0.150137
Validation mse = 0.093672
Epoch 2
Loss = 5.8737e-01, PNorm = 43.3907, GNorm = 3.0231, lr_0 = 9.8961e-04
Loss = 5.2227e-01, PNorm = 43.4633, GNorm = 1.0291, lr_0 = 9.6914e-04
Validation rmse = 0.294038
Validation r2 = 0.215581
Validation mse = 0.086459
Epoch 3
Loss = 2.9928e-01, PNorm = 43.5509, GNorm = 1.0143, lr_0 = 9.4712e-04
Loss = 3.1978e-01, PNorm = 43.6184, GNorm = 1.8999, lr_0 = 9.2754e-04
Validation rmse = 0.283377
Validation r2 = 0.271432
Validation mse = 0.080303
Epoch 4
Loss = 2.3230e-01, PNorm = 43.6789, GNorm = 2.4669, lr_0 = 9.0836e-04
Loss = 2.2052e-01, PNorm = 43.7381, GNorm = 2.8548, lr_0 = 8.8958e-04
Validation rmse = 0.221523
Validation r2 = 0.554777
Validation mse = 0.049072
Epoch 5
Loss = 2.1523e-01, PNorm = 43.7872, GNorm = 4.6557, lr_0 = 8.6936e-04
Loss = 2.2315e-01, PNorm = 43.8330, GNorm = 3.6297, lr_0 = 8.5139e-04
Validation rmse = 0.224918
Validation r2 = 0.541025
Validation mse = 0.050588
Epoch 6
Loss = 1.5581e-01, PNorm = 43.8895, GNorm = 0.8769, lr_0 = 8.3204e-04
Loss = 2.1383e-01, PNorm = 43.9266, GNorm = 4.7201, lr_0 = 8.1484e-04
Validation rmse = 0.226578
Validation r2 = 0.534227
Validation mse = 0.051337
Epoch 7
Loss = 2.1126e-01, PNorm = 43.9591, GNorm = 2.8811, lr_0 = 7.9799e-04
Loss = 1.7715e-01, PNorm = 43.9989, GNorm = 1.1121, lr_0 = 7.8149e-04
Validation rmse = 0.206575
Validation r2 = 0.612837
Validation mse = 0.042673
Epoch 8
Loss = 1.2447e-01, PNorm = 44.0380, GNorm = 3.2164, lr_0 = 7.6373e-04
Loss = 1.3536e-01, PNorm = 44.0644, GNorm = 1.0956, lr_0 = 7.4794e-04
Validation rmse = 0.201090
Validation r2 = 0.633123
Validation mse = 0.040437
Epoch 9
Loss = 1.2709e-01, PNorm = 44.0870, GNorm = 1.7014, lr_0 = 7.3094e-04
Loss = 1.3507e-01, PNorm = 44.1075, GNorm = 1.4880, lr_0 = 7.1583e-04
Validation rmse = 0.207222
Validation r2 = 0.610405
Validation mse = 0.042941
Epoch 10
Loss = 1.2630e-01, PNorm = 44.1300, GNorm = 1.3727, lr_0 = 7.0103e-04
Loss = 1.2181e-01, PNorm = 44.1517, GNorm = 0.8421, lr_0 = 6.8653e-04
Validation rmse = 0.205094
Validation r2 = 0.618368
Validation mse = 0.042063
Epoch 11
Loss = 1.4159e-01, PNorm = 44.1695, GNorm = 2.2767, lr_0 = 6.7093e-04
Loss = 1.2291e-01, PNorm = 44.1869, GNorm = 1.2212, lr_0 = 6.5706e-04
Validation rmse = 0.199087
Validation r2 = 0.640395
Validation mse = 0.039636
Epoch 12
Loss = 1.1047e-01, PNorm = 44.2069, GNorm = 2.9384, lr_0 = 6.4213e-04
Loss = 1.1223e-01, PNorm = 44.2245, GNorm = 1.4132, lr_0 = 6.2885e-04
Loss = 2.2222e-02, PNorm = 44.2263, GNorm = 0.9061, lr_0 = 6.2754e-04
Validation rmse = 0.187173
Validation r2 = 0.682148
Validation mse = 0.035034
Epoch 13
Loss = 1.0562e-01, PNorm = 44.2401, GNorm = 2.1169, lr_0 = 6.1456e-04
Loss = 1.1909e-01, PNorm = 44.2534, GNorm = 3.3714, lr_0 = 6.0185e-04
Validation rmse = 0.206193
Validation r2 = 0.614264
Validation mse = 0.042516
Epoch 14
Loss = 9.5102e-02, PNorm = 44.2732, GNorm = 3.8112, lr_0 = 5.8941e-04
Validation rmse = 0.206702
Validation r2 = 0.612360
Validation mse = 0.042726
Epoch 15
Loss = 1.4020e-01, PNorm = 44.2899, GNorm = 3.6034, lr_0 = 5.7602e-04
Loss = 1.1413e-01, PNorm = 44.3074, GNorm = 0.9251, lr_0 = 5.6411e-04
Validation rmse = 0.181324
Validation r2 = 0.701703
Validation mse = 0.032878
Epoch 16
Loss = 9.5090e-02, PNorm = 44.3252, GNorm = 2.1119, lr_0 = 5.5129e-04
Loss = 1.1109e-01, PNorm = 44.3366, GNorm = 1.0325, lr_0 = 5.3989e-04
Validation rmse = 0.189189
Validation r2 = 0.675263
Validation mse = 0.035792
Epoch 17
Loss = 1.1951e-01, PNorm = 44.3524, GNorm = 1.3726, lr_0 = 5.2873e-04
Loss = 9.3958e-02, PNorm = 44.3677, GNorm = 1.2452, lr_0 = 5.1779e-04
Validation rmse = 0.180257
Validation r2 = 0.705201
Validation mse = 0.032493
Epoch 18
Loss = 8.7396e-02, PNorm = 44.3853, GNorm = 2.7772, lr_0 = 5.0603e-04
Loss = 8.9949e-02, PNorm = 44.3990, GNorm = 0.9231, lr_0 = 4.9556e-04
Validation rmse = 0.189729
Validation r2 = 0.673406
Validation mse = 0.035997
Epoch 19
Loss = 7.7604e-02, PNorm = 44.4105, GNorm = 0.9505, lr_0 = 4.8430e-04
Loss = 9.6208e-02, PNorm = 44.4225, GNorm = 0.6643, lr_0 = 4.7429e-04
Validation rmse = 0.187417
Validation r2 = 0.681316
Validation mse = 0.035125
Epoch 20
Loss = 6.8493e-02, PNorm = 44.4366, GNorm = 1.7707, lr_0 = 4.6448e-04
Loss = 9.6910e-02, PNorm = 44.4463, GNorm = 2.6376, lr_0 = 4.5488e-04
Validation rmse = 0.201473
Validation r2 = 0.631725
Validation mse = 0.040591
Epoch 21
Loss = 1.1238e-01, PNorm = 44.4584, GNorm = 1.3587, lr_0 = 4.4454e-04
Loss = 1.0559e-01, PNorm = 44.4754, GNorm = 1.1657, lr_0 = 4.3535e-04
Validation rmse = 0.183917
Validation r2 = 0.693109
Validation mse = 0.033825
Epoch 22
Loss = 9.6467e-02, PNorm = 44.4942, GNorm = 1.5337, lr_0 = 4.2546e-04
Loss = 8.4263e-02, PNorm = 44.5065, GNorm = 0.9388, lr_0 = 4.1666e-04
Validation rmse = 0.200262
Validation r2 = 0.636137
Validation mse = 0.040105
Epoch 23
Loss = 8.6598e-02, PNorm = 44.5205, GNorm = 1.8697, lr_0 = 4.0719e-04
Loss = 9.4432e-02, PNorm = 44.5298, GNorm = 0.9824, lr_0 = 3.9877e-04
Validation rmse = 0.190137
Validation r2 = 0.671998
Validation mse = 0.036152
Epoch 24
Loss = 9.1802e-02, PNorm = 44.5395, GNorm = 1.4163, lr_0 = 3.9053e-04
Loss = 8.5757e-02, PNorm = 44.5501, GNorm = 1.6669, lr_0 = 3.8245e-04
Validation rmse = 0.188125
Validation r2 = 0.678905
Validation mse = 0.035391
Epoch 25
Loss = 7.7574e-02, PNorm = 44.5606, GNorm = 0.8162, lr_0 = 3.7376e-04
Loss = 8.6444e-02, PNorm = 44.5721, GNorm = 1.6794, lr_0 = 3.6603e-04
Validation rmse = 0.183535
Validation r2 = 0.694384
Validation mse = 0.033685
Epoch 26
Loss = 7.5106e-02, PNorm = 44.5831, GNorm = 0.6172, lr_0 = 3.5772e-04
Loss = 7.9532e-02, PNorm = 44.5910, GNorm = 0.7126, lr_0 = 3.5032e-04
Validation rmse = 0.182558
Validation r2 = 0.697628
Validation mse = 0.033327
Epoch 27
Loss = 7.5131e-02, PNorm = 44.5990, GNorm = 1.8542, lr_0 = 3.4308e-04
Loss = 8.5771e-02, PNorm = 44.6083, GNorm = 2.0071, lr_0 = 3.3598e-04
Loss = 3.9543e-02, PNorm = 44.6094, GNorm = 1.8899, lr_0 = 3.3528e-04
Validation rmse = 0.178287
Validation r2 = 0.711611
Validation mse = 0.031786
Epoch 28
Loss = 7.4626e-02, PNorm = 44.6172, GNorm = 0.9379, lr_0 = 3.2835e-04
Validation rmse = 0.177204
Validation r2 = 0.715103
Validation mse = 0.031401
Epoch 29
Loss = 9.3150e-02, PNorm = 44.6287, GNorm = 0.7269, lr_0 = 3.2089e-04
Loss = 7.3113e-02, PNorm = 44.6375, GNorm = 1.9434, lr_0 = 3.1425e-04
Validation rmse = 0.177117
Validation r2 = 0.715383
Validation mse = 0.031370
Epoch 30
Loss = 9.1973e-02, PNorm = 44.6469, GNorm = 1.5487, lr_0 = 3.0775e-04
Loss = 7.8565e-02, PNorm = 44.6556, GNorm = 0.7932, lr_0 = 3.0139e-04
Validation rmse = 0.183356
Validation r2 = 0.694979
Validation mse = 0.033619
Epoch 31
Loss = 6.7383e-02, PNorm = 44.6649, GNorm = 1.9312, lr_0 = 2.9454e-04
Loss = 7.2027e-02, PNorm = 44.6748, GNorm = 2.6678, lr_0 = 2.8845e-04
Validation rmse = 0.173233
Validation r2 = 0.727729
Validation mse = 0.030010
Epoch 32
Loss = 7.6392e-02, PNorm = 44.6838, GNorm = 1.0363, lr_0 = 2.8190e-04
Loss = 7.7002e-02, PNorm = 44.6928, GNorm = 1.4596, lr_0 = 2.7607e-04
Validation rmse = 0.178315
Validation r2 = 0.711520
Validation mse = 0.031796
Epoch 33
Loss = 7.1859e-02, PNorm = 44.7024, GNorm = 0.6668, lr_0 = 2.6980e-04
Loss = 7.0216e-02, PNorm = 44.7107, GNorm = 0.7872, lr_0 = 2.6422e-04
Validation rmse = 0.177329
Validation r2 = 0.714703
Validation mse = 0.031445
Epoch 34
Loss = 6.4670e-02, PNorm = 44.7188, GNorm = 1.0711, lr_0 = 2.5875e-04
Loss = 7.9685e-02, PNorm = 44.7266, GNorm = 1.7224, lr_0 = 2.5340e-04
Validation rmse = 0.180900
Validation r2 = 0.703096
Validation mse = 0.032725
Epoch 35
Loss = 8.8707e-02, PNorm = 44.7365, GNorm = 2.1194, lr_0 = 2.4764e-04
Loss = 7.1238e-02, PNorm = 44.7445, GNorm = 2.1496, lr_0 = 2.4252e-04
Validation rmse = 0.179172
Validation r2 = 0.708741
Validation mse = 0.032102
Epoch 36
Loss = 7.5875e-02, PNorm = 44.7542, GNorm = 0.8308, lr_0 = 2.3701e-04
Loss = 6.6703e-02, PNorm = 44.7614, GNorm = 1.1227, lr_0 = 2.3211e-04
Validation rmse = 0.177897
Validation r2 = 0.712871
Validation mse = 0.031647
Epoch 37
Loss = 7.2027e-02, PNorm = 44.7675, GNorm = 1.6614, lr_0 = 2.2731e-04
Loss = 6.5107e-02, PNorm = 44.7744, GNorm = 2.4844, lr_0 = 2.2261e-04
Validation rmse = 0.167974
Validation r2 = 0.744010
Validation mse = 0.028215
Epoch 38
Loss = 7.2780e-02, PNorm = 44.7842, GNorm = 1.0066, lr_0 = 2.1755e-04
Loss = 5.8066e-02, PNorm = 44.7922, GNorm = 1.6724, lr_0 = 2.1306e-04
Validation rmse = 0.165904
Validation r2 = 0.750281
Validation mse = 0.027524
Epoch 39
Loss = 6.3527e-02, PNorm = 44.8004, GNorm = 1.3287, lr_0 = 2.0821e-04
Loss = 6.5595e-02, PNorm = 44.8052, GNorm = 0.7198, lr_0 = 2.0391e-04
Validation rmse = 0.177888
Validation r2 = 0.712899
Validation mse = 0.031644
Epoch 40
Loss = 6.3114e-02, PNorm = 44.8110, GNorm = 1.2174, lr_0 = 1.9969e-04
Loss = 6.0179e-02, PNorm = 44.8170, GNorm = 0.3911, lr_0 = 1.9556e-04
Validation rmse = 0.174854
Validation r2 = 0.722610
Validation mse = 0.030574
Epoch 41
Loss = 7.5068e-02, PNorm = 44.8231, GNorm = 2.9249, lr_0 = 1.9112e-04
Loss = 6.4172e-02, PNorm = 44.8291, GNorm = 2.1973, lr_0 = 1.8717e-04
Loss = 8.6010e-02, PNorm = 44.8296, GNorm = 3.4092, lr_0 = 1.8678e-04
Validation rmse = 0.172139
Validation r2 = 0.731155
Validation mse = 0.029632
Epoch 42
Loss = 6.4906e-02, PNorm = 44.8362, GNorm = 1.1086, lr_0 = 1.8292e-04
Validation rmse = 0.170863
Validation r2 = 0.735128
Validation mse = 0.029194
Epoch 43
Loss = 5.9463e-02, PNorm = 44.8432, GNorm = 0.8121, lr_0 = 1.7876e-04
Loss = 5.8001e-02, PNorm = 44.8486, GNorm = 0.6551, lr_0 = 1.7506e-04
Validation rmse = 0.177041
Validation r2 = 0.715628
Validation mse = 0.031343
Epoch 44
Loss = 7.6501e-02, PNorm = 44.8533, GNorm = 2.0825, lr_0 = 1.7144e-04
Loss = 6.0003e-02, PNorm = 44.8594, GNorm = 1.3051, lr_0 = 1.6790e-04
Validation rmse = 0.168049
Validation r2 = 0.743779
Validation mse = 0.028241
Epoch 45
Loss = 4.5795e-02, PNorm = 44.8666, GNorm = 1.5365, lr_0 = 1.6408e-04
Loss = 7.0809e-02, PNorm = 44.8717, GNorm = 1.0981, lr_0 = 1.6069e-04
Validation rmse = 0.172165
Validation r2 = 0.731075
Validation mse = 0.029641
Epoch 46
Loss = 5.5541e-02, PNorm = 44.8779, GNorm = 1.5016, lr_0 = 1.5704e-04
Loss = 5.4019e-02, PNorm = 44.8840, GNorm = 1.0890, lr_0 = 1.5379e-04
Validation rmse = 0.166648
Validation r2 = 0.748034
Validation mse = 0.027772
Epoch 47
Loss = 5.7480e-02, PNorm = 44.8896, GNorm = 0.7521, lr_0 = 1.5061e-04
Loss = 5.3163e-02, PNorm = 44.8948, GNorm = 0.8061, lr_0 = 1.4750e-04
Validation rmse = 0.161811
Validation r2 = 0.762449
Validation mse = 0.026183
Epoch 48
Loss = 4.6434e-02, PNorm = 44.8987, GNorm = 0.9989, lr_0 = 1.4415e-04
Loss = 5.8812e-02, PNorm = 44.9030, GNorm = 0.6573, lr_0 = 1.4117e-04
Validation rmse = 0.167167
Validation r2 = 0.746464
Validation mse = 0.027945
Epoch 49
Loss = 4.8876e-02, PNorm = 44.9081, GNorm = 0.7835, lr_0 = 1.3796e-04
Loss = 5.3409e-02, PNorm = 44.9126, GNorm = 0.9566, lr_0 = 1.3511e-04
Validation rmse = 0.166512
Validation r2 = 0.748445
Validation mse = 0.027726
Epoch 50
Loss = 5.4046e-02, PNorm = 44.9162, GNorm = 2.0974, lr_0 = 1.3231e-04
Loss = 5.4920e-02, PNorm = 44.9195, GNorm = 0.8706, lr_0 = 1.2958e-04
Validation rmse = 0.164808
Validation r2 = 0.753569
Validation mse = 0.027162
Epoch 51
Loss = 5.3340e-02, PNorm = 44.9259, GNorm = 0.6556, lr_0 = 1.2663e-04
Loss = 5.7082e-02, PNorm = 44.9310, GNorm = 0.5875, lr_0 = 1.2401e-04
Validation rmse = 0.161634
Validation r2 = 0.762969
Validation mse = 0.026125
Epoch 52
Loss = 4.5523e-02, PNorm = 44.9350, GNorm = 0.4370, lr_0 = 1.2119e-04
Loss = 6.1337e-02, PNorm = 44.9389, GNorm = 0.9529, lr_0 = 1.1869e-04
Validation rmse = 0.159969
Validation r2 = 0.767826
Validation mse = 0.025590
Epoch 53
Loss = 5.9801e-02, PNorm = 44.9435, GNorm = 1.7841, lr_0 = 1.1599e-04
Loss = 4.7397e-02, PNorm = 44.9485, GNorm = 0.4977, lr_0 = 1.1359e-04
Validation rmse = 0.163678
Validation r2 = 0.756936
Validation mse = 0.026790
Epoch 54
Loss = 5.3363e-02, PNorm = 44.9518, GNorm = 0.6391, lr_0 = 1.1124e-04
Loss = 4.9942e-02, PNorm = 44.9551, GNorm = 1.1615, lr_0 = 1.0894e-04
Validation rmse = 0.163934
Validation r2 = 0.756174
Validation mse = 0.026874
Epoch 55
Loss = 5.0256e-02, PNorm = 44.9591, GNorm = 1.6078, lr_0 = 1.0647e-04
Loss = 5.1565e-02, PNorm = 44.9636, GNorm = 0.4200, lr_0 = 1.0427e-04
Loss = 5.6384e-02, PNorm = 44.9638, GNorm = 1.0637, lr_0 = 1.0405e-04
Validation rmse = 0.164709
Validation r2 = 0.753865
Validation mse = 0.027129
Epoch 56
Loss = 4.8581e-02, PNorm = 44.9665, GNorm = 1.0209, lr_0 = 1.0190e-04
Loss = 4.8100e-02, PNorm = 44.9702, GNorm = 0.7022, lr_0 = 1.0000e-04
Validation rmse = 0.157183
Validation r2 = 0.775842
Validation mse = 0.024707
Epoch 57
Loss = 4.5323e-02, PNorm = 44.9735, GNorm = 0.8172, lr_0 = 1.0000e-04
Validation rmse = 0.159053
Validation r2 = 0.770478
Validation mse = 0.025298
Epoch 58
Loss = 3.3277e-02, PNorm = 44.9772, GNorm = 0.4264, lr_0 = 1.0000e-04
Loss = 4.6996e-02, PNorm = 44.9811, GNorm = 1.3715, lr_0 = 1.0000e-04
Validation rmse = 0.160647
Validation r2 = 0.765854
Validation mse = 0.025807
Epoch 59
Loss = 3.6932e-02, PNorm = 44.9851, GNorm = 0.8560, lr_0 = 1.0000e-04
Loss = 5.2003e-02, PNorm = 44.9890, GNorm = 0.7623, lr_0 = 1.0000e-04
Validation rmse = 0.158517
Validation r2 = 0.772023
Validation mse = 0.025128
Model 0 best validation rmse = 0.157183 on epoch 56
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.170664
Model 0 test r2 = 0.735299
Model 0 test mse = 0.029126
Ensemble test rmse = 0.170664
Ensemble test r2 = 0.735299
Ensemble test mse = 0.029126
Fold 5
Splitting data with seed 5
Total size = 975 | train size = 965 | val size = 10 | test size = 57
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 1.0008e+00, PNorm = 43.2592, GNorm = 2.4664, lr_0 = 3.6053e-04
Validation rmse = 0.303946
Validation r2 = -0.020204
Validation mse = 0.092383
Epoch 1
Loss = 9.7427e-01, PNorm = 43.2809, GNorm = 8.7206, lr_0 = 6.2105e-04
Loss = 7.9207e-01, PNorm = 43.3191, GNorm = 3.0289, lr_0 = 8.5789e-04
Validation rmse = 0.279618
Validation r2 = 0.136580
Validation mse = 0.078186
Epoch 2
Loss = 7.2614e-01, PNorm = 43.3876, GNorm = 2.3106, lr_0 = 9.8961e-04
Loss = 4.7956e-01, PNorm = 43.4805, GNorm = 1.8209, lr_0 = 9.6914e-04
Validation rmse = 0.304962
Validation r2 = -0.027032
Validation mse = 0.093002
Epoch 3
Loss = 4.1618e-01, PNorm = 43.5662, GNorm = 1.2796, lr_0 = 9.4712e-04
Loss = 3.7975e-01, PNorm = 43.6333, GNorm = 1.5395, lr_0 = 9.2754e-04
Validation rmse = 0.243681
Validation r2 = 0.344253
Validation mse = 0.059380
Epoch 4
Loss = 3.9913e-01, PNorm = 43.6979, GNorm = 4.7901, lr_0 = 9.0836e-04
Loss = 3.4048e-01, PNorm = 43.7675, GNorm = 5.7715, lr_0 = 8.8958e-04
Validation rmse = 0.293328
Validation r2 = 0.049833
Validation mse = 0.086041
Epoch 5
Loss = 2.5437e-01, PNorm = 43.8204, GNorm = 3.0026, lr_0 = 8.6936e-04
Loss = 2.5444e-01, PNorm = 43.8724, GNorm = 5.7910, lr_0 = 8.5139e-04
Validation rmse = 0.235522
Validation r2 = 0.387432
Validation mse = 0.055470
Epoch 6
Loss = 2.0308e-01, PNorm = 43.9183, GNorm = 2.0187, lr_0 = 8.3204e-04
Loss = 1.4309e-01, PNorm = 43.9569, GNorm = 1.1514, lr_0 = 8.1484e-04
Validation rmse = 0.193937
Validation r2 = 0.584648
Validation mse = 0.037612
Epoch 7
Loss = 1.4049e-01, PNorm = 43.9795, GNorm = 1.0884, lr_0 = 7.9799e-04
Loss = 1.7375e-01, PNorm = 44.0061, GNorm = 2.2640, lr_0 = 7.8149e-04
Validation rmse = 0.230960
Validation r2 = 0.410928
Validation mse = 0.053343
Epoch 8
Loss = 1.9596e-01, PNorm = 44.0391, GNorm = 3.1767, lr_0 = 7.6373e-04
Loss = 1.6503e-01, PNorm = 44.0672, GNorm = 1.3828, lr_0 = 7.4794e-04
Validation rmse = 0.188383
Validation r2 = 0.608100
Validation mse = 0.035488
Epoch 9
Loss = 1.9855e-01, PNorm = 44.0972, GNorm = 1.0768, lr_0 = 7.3094e-04
Loss = 1.4865e-01, PNorm = 44.1292, GNorm = 1.0977, lr_0 = 7.1583e-04
Validation rmse = 0.190818
Validation r2 = 0.597903
Validation mse = 0.036411
Epoch 10
Loss = 1.2622e-01, PNorm = 44.1563, GNorm = 0.4605, lr_0 = 7.0103e-04
Loss = 1.3550e-01, PNorm = 44.1760, GNorm = 0.8815, lr_0 = 6.8653e-04
Validation rmse = 0.189624
Validation r2 = 0.602918
Validation mse = 0.035957
Epoch 11
Loss = 1.3310e-01, PNorm = 44.2031, GNorm = 3.0666, lr_0 = 6.7093e-04
Loss = 1.2210e-01, PNorm = 44.2274, GNorm = 2.9656, lr_0 = 6.5706e-04
Validation rmse = 0.148324
Validation r2 = 0.757051
Validation mse = 0.022000
Epoch 12
Loss = 9.6578e-02, PNorm = 44.2474, GNorm = 1.8083, lr_0 = 6.4213e-04
Loss = 1.1912e-01, PNorm = 44.2661, GNorm = 1.5014, lr_0 = 6.2885e-04
Loss = 1.0774e-01, PNorm = 44.2682, GNorm = 0.9658, lr_0 = 6.2754e-04
Validation rmse = 0.150963
Validation r2 = 0.748328
Validation mse = 0.022790
Epoch 13
Loss = 1.2596e-01, PNorm = 44.2859, GNorm = 1.7933, lr_0 = 6.1456e-04
Loss = 1.1367e-01, PNorm = 44.3057, GNorm = 3.4547, lr_0 = 6.0185e-04
Validation rmse = 0.162193
Validation r2 = 0.709494
Validation mse = 0.026306
Epoch 14
Loss = 1.1392e-01, PNorm = 44.3323, GNorm = 1.3427, lr_0 = 5.8941e-04
Validation rmse = 0.167681
Validation r2 = 0.689499
Validation mse = 0.028117
Epoch 15
Loss = 1.2743e-01, PNorm = 44.3482, GNorm = 1.7135, lr_0 = 5.7602e-04
Loss = 1.0438e-01, PNorm = 44.3642, GNorm = 0.9058, lr_0 = 5.6411e-04
Validation rmse = 0.233546
Validation r2 = 0.397665
Validation mse = 0.054544
Epoch 16
Loss = 1.2065e-01, PNorm = 44.3761, GNorm = 1.1776, lr_0 = 5.5129e-04
Loss = 1.1252e-01, PNorm = 44.3883, GNorm = 0.7973, lr_0 = 5.3989e-04
Validation rmse = 0.163484
Validation r2 = 0.704848
Validation mse = 0.026727
Epoch 17
Loss = 7.9944e-02, PNorm = 44.4063, GNorm = 1.8616, lr_0 = 5.2873e-04
Loss = 1.0188e-01, PNorm = 44.4249, GNorm = 1.1116, lr_0 = 5.1779e-04
Validation rmse = 0.172762
Validation r2 = 0.670397
Validation mse = 0.029847
Epoch 18
Loss = 1.0198e-01, PNorm = 44.4432, GNorm = 3.4635, lr_0 = 5.0603e-04
Loss = 1.1463e-01, PNorm = 44.4560, GNorm = 1.7360, lr_0 = 4.9556e-04
Validation rmse = 0.159386
Validation r2 = 0.719460
Validation mse = 0.025404
Epoch 19
Loss = 8.8230e-02, PNorm = 44.4770, GNorm = 1.1962, lr_0 = 4.8430e-04
Loss = 1.0450e-01, PNorm = 44.4944, GNorm = 1.0752, lr_0 = 4.7429e-04
Validation rmse = 0.161989
Validation r2 = 0.710224
Validation mse = 0.026240
Epoch 20
Loss = 9.0727e-02, PNorm = 44.5077, GNorm = 0.8642, lr_0 = 4.6448e-04
Loss = 9.7861e-02, PNorm = 44.5193, GNorm = 1.0216, lr_0 = 4.5488e-04
Validation rmse = 0.162697
Validation r2 = 0.707686
Validation mse = 0.026470
Epoch 21
Loss = 8.6633e-02, PNorm = 44.5347, GNorm = 2.1865, lr_0 = 4.4454e-04
Loss = 8.7421e-02, PNorm = 44.5497, GNorm = 1.7310, lr_0 = 4.3535e-04
Validation rmse = 0.143559
Validation r2 = 0.772410
Validation mse = 0.020609
Epoch 22
Loss = 9.0260e-02, PNorm = 44.5629, GNorm = 1.4476, lr_0 = 4.2546e-04
Loss = 9.1308e-02, PNorm = 44.5760, GNorm = 1.1696, lr_0 = 4.1666e-04
Validation rmse = 0.172891
Validation r2 = 0.669906
Validation mse = 0.029891
Epoch 23
Loss = 7.8844e-02, PNorm = 44.5911, GNorm = 1.9206, lr_0 = 4.0719e-04
Loss = 8.3091e-02, PNorm = 44.6039, GNorm = 1.6776, lr_0 = 3.9877e-04
Validation rmse = 0.177975
Validation r2 = 0.650208
Validation mse = 0.031675
Epoch 24
Loss = 9.2569e-02, PNorm = 44.6140, GNorm = 1.4718, lr_0 = 3.9053e-04
Loss = 9.7801e-02, PNorm = 44.6271, GNorm = 1.4198, lr_0 = 3.8245e-04
Validation rmse = 0.165218
Validation r2 = 0.698555
Validation mse = 0.027297
Epoch 25
Loss = 8.4584e-02, PNorm = 44.6417, GNorm = 0.8257, lr_0 = 3.7376e-04
Loss = 8.9875e-02, PNorm = 44.6538, GNorm = 1.8555, lr_0 = 3.6603e-04
Validation rmse = 0.156217
Validation r2 = 0.730506
Validation mse = 0.024404
Epoch 26
Loss = 9.5909e-02, PNorm = 44.6687, GNorm = 1.2757, lr_0 = 3.5772e-04
Loss = 8.7974e-02, PNorm = 44.6806, GNorm = 0.9009, lr_0 = 3.5032e-04
Validation rmse = 0.155376
Validation r2 = 0.733400
Validation mse = 0.024142
Epoch 27
Loss = 7.6292e-02, PNorm = 44.6937, GNorm = 0.7152, lr_0 = 3.4308e-04
Loss = 8.3600e-02, PNorm = 44.7039, GNorm = 0.5896, lr_0 = 3.3598e-04
Loss = 5.9488e-02, PNorm = 44.7049, GNorm = 1.4191, lr_0 = 3.3528e-04
Validation rmse = 0.161428
Validation r2 = 0.712227
Validation mse = 0.026059
Epoch 28
Loss = 7.6887e-02, PNorm = 44.7149, GNorm = 1.0897, lr_0 = 3.2835e-04
Validation rmse = 0.157658
Validation r2 = 0.725511
Validation mse = 0.024856
Epoch 29
Loss = 1.2003e-01, PNorm = 44.7246, GNorm = 1.0876, lr_0 = 3.2089e-04
Loss = 8.3647e-02, PNorm = 44.7386, GNorm = 1.4391, lr_0 = 3.1425e-04
Validation rmse = 0.152165
Validation r2 = 0.744304
Validation mse = 0.023154
Epoch 30
Loss = 4.3059e-02, PNorm = 44.7462, GNorm = 0.6293, lr_0 = 3.0775e-04
Loss = 7.9445e-02, PNorm = 44.7550, GNorm = 0.6113, lr_0 = 3.0139e-04
Validation rmse = 0.146621
Validation r2 = 0.762596
Validation mse = 0.021498
Epoch 31
Loss = 6.5454e-02, PNorm = 44.7661, GNorm = 0.7182, lr_0 = 2.9454e-04
Loss = 6.6135e-02, PNorm = 44.7766, GNorm = 1.2913, lr_0 = 2.8845e-04
Validation rmse = 0.140217
Validation r2 = 0.782883
Validation mse = 0.019661
Epoch 32
Loss = 8.3087e-02, PNorm = 44.7876, GNorm = 0.8048, lr_0 = 2.8190e-04
Loss = 7.0430e-02, PNorm = 44.7989, GNorm = 0.4638, lr_0 = 2.7607e-04
Validation rmse = 0.163680
Validation r2 = 0.704142
Validation mse = 0.026791
Epoch 33
Loss = 8.3565e-02, PNorm = 44.8100, GNorm = 1.1643, lr_0 = 2.6980e-04
Loss = 7.5148e-02, PNorm = 44.8194, GNorm = 0.6398, lr_0 = 2.6422e-04
Validation rmse = 0.141549
Validation r2 = 0.778738
Validation mse = 0.020036
Epoch 34
Loss = 7.1104e-02, PNorm = 44.8322, GNorm = 0.3993, lr_0 = 2.5875e-04
Loss = 7.0504e-02, PNorm = 44.8424, GNorm = 1.1258, lr_0 = 2.5340e-04
Validation rmse = 0.140167
Validation r2 = 0.783036
Validation mse = 0.019647
Epoch 35
Loss = 6.8284e-02, PNorm = 44.8519, GNorm = 1.2985, lr_0 = 2.4764e-04
Loss = 7.3606e-02, PNorm = 44.8594, GNorm = 0.7627, lr_0 = 2.4252e-04
Validation rmse = 0.160317
Validation r2 = 0.716173
Validation mse = 0.025702
Epoch 36
Loss = 5.9413e-02, PNorm = 44.8673, GNorm = 0.5772, lr_0 = 2.3701e-04
Loss = 7.0202e-02, PNorm = 44.8758, GNorm = 0.6531, lr_0 = 2.3211e-04
Validation rmse = 0.141339
Validation r2 = 0.779394
Validation mse = 0.019977
Epoch 37
Loss = 6.4326e-02, PNorm = 44.8847, GNorm = 0.7324, lr_0 = 2.2731e-04
Loss = 7.2159e-02, PNorm = 44.8939, GNorm = 1.4253, lr_0 = 2.2261e-04
Validation rmse = 0.127875
Validation r2 = 0.819422
Validation mse = 0.016352
Epoch 38
Loss = 6.6304e-02, PNorm = 44.9033, GNorm = 1.7909, lr_0 = 2.1755e-04
Loss = 6.7327e-02, PNorm = 44.9107, GNorm = 1.0988, lr_0 = 2.1306e-04
Validation rmse = 0.135364
Validation r2 = 0.797651
Validation mse = 0.018324
Epoch 39
Loss = 6.3692e-02, PNorm = 44.9197, GNorm = 0.5971, lr_0 = 2.0821e-04
Loss = 6.2170e-02, PNorm = 44.9269, GNorm = 0.6321, lr_0 = 2.0391e-04
Validation rmse = 0.151026
Validation r2 = 0.748118
Validation mse = 0.022809
Epoch 40
Loss = 5.9387e-02, PNorm = 44.9343, GNorm = 1.5573, lr_0 = 1.9969e-04
Loss = 6.2801e-02, PNorm = 44.9414, GNorm = 0.7616, lr_0 = 1.9556e-04
Validation rmse = 0.147602
Validation r2 = 0.759410
Validation mse = 0.021786
Epoch 41
Loss = 6.1728e-02, PNorm = 44.9498, GNorm = 1.9356, lr_0 = 1.9112e-04
Loss = 6.1190e-02, PNorm = 44.9569, GNorm = 1.6885, lr_0 = 1.8717e-04
Loss = 1.7410e-01, PNorm = 44.9577, GNorm = 3.2292, lr_0 = 1.8678e-04
Validation rmse = 0.152689
Validation r2 = 0.742540
Validation mse = 0.023314
Epoch 42
Loss = 5.7587e-02, PNorm = 44.9655, GNorm = 0.6109, lr_0 = 1.8292e-04
Validation rmse = 0.163627
Validation r2 = 0.704334
Validation mse = 0.026774
Epoch 43
Loss = 6.0845e-02, PNorm = 44.9737, GNorm = 1.0007, lr_0 = 1.7876e-04
Loss = 7.7863e-02, PNorm = 44.9817, GNorm = 1.5826, lr_0 = 1.7506e-04
Validation rmse = 0.142375
Validation r2 = 0.776149
Validation mse = 0.020271
Epoch 44
Loss = 7.7552e-02, PNorm = 44.9880, GNorm = 1.1825, lr_0 = 1.7144e-04
Loss = 5.5363e-02, PNorm = 44.9949, GNorm = 0.5762, lr_0 = 1.6790e-04
Validation rmse = 0.142957
Validation r2 = 0.774314
Validation mse = 0.020437
Epoch 45
Loss = 8.0568e-02, PNorm = 45.0005, GNorm = 0.9274, lr_0 = 1.6408e-04
Loss = 4.9325e-02, PNorm = 45.0062, GNorm = 0.7612, lr_0 = 1.6069e-04
Validation rmse = 0.138714
Validation r2 = 0.787512
Validation mse = 0.019242
Epoch 46
Loss = 5.0391e-02, PNorm = 45.0125, GNorm = 1.1896, lr_0 = 1.5704e-04
Loss = 5.7123e-02, PNorm = 45.0178, GNorm = 1.1011, lr_0 = 1.5379e-04
Validation rmse = 0.142779
Validation r2 = 0.774875
Validation mse = 0.020386
Epoch 47
Loss = 4.1406e-02, PNorm = 45.0240, GNorm = 0.4734, lr_0 = 1.5061e-04
Loss = 6.1089e-02, PNorm = 45.0299, GNorm = 1.1224, lr_0 = 1.4750e-04
Validation rmse = 0.150416
Validation r2 = 0.750151
Validation mse = 0.022625
Epoch 48
Loss = 6.4089e-02, PNorm = 45.0365, GNorm = 2.3307, lr_0 = 1.4415e-04
Loss = 5.6297e-02, PNorm = 45.0420, GNorm = 0.8085, lr_0 = 1.4117e-04
Validation rmse = 0.128109
Validation r2 = 0.818759
Validation mse = 0.016412
Epoch 49
Loss = 5.3206e-02, PNorm = 45.0475, GNorm = 0.9706, lr_0 = 1.3796e-04
Loss = 5.5700e-02, PNorm = 45.0520, GNorm = 0.9316, lr_0 = 1.3511e-04
Validation rmse = 0.154890
Validation r2 = 0.735066
Validation mse = 0.023991
Epoch 50
Loss = 5.2813e-02, PNorm = 45.0574, GNorm = 0.3847, lr_0 = 1.3231e-04
Loss = 5.5133e-02, PNorm = 45.0634, GNorm = 2.2309, lr_0 = 1.2958e-04
Validation rmse = 0.136730
Validation r2 = 0.793546
Validation mse = 0.018695
Epoch 51
Loss = 5.0055e-02, PNorm = 45.0687, GNorm = 1.1158, lr_0 = 1.2663e-04
Loss = 5.3772e-02, PNorm = 45.0734, GNorm = 1.1280, lr_0 = 1.2401e-04
Validation rmse = 0.136639
Validation r2 = 0.793823
Validation mse = 0.018670
Epoch 52
Loss = 5.8665e-02, PNorm = 45.0783, GNorm = 0.9105, lr_0 = 1.2119e-04
Loss = 4.8895e-02, PNorm = 45.0824, GNorm = 0.7527, lr_0 = 1.1869e-04
Validation rmse = 0.141240
Validation r2 = 0.779704
Validation mse = 0.019949
Epoch 53
Loss = 4.6351e-02, PNorm = 45.0877, GNorm = 0.5616, lr_0 = 1.1599e-04
Loss = 5.1928e-02, PNorm = 45.0933, GNorm = 0.6690, lr_0 = 1.1359e-04
Validation rmse = 0.144877
Validation r2 = 0.768211
Validation mse = 0.020989
Epoch 54
Loss = 4.8967e-02, PNorm = 45.0970, GNorm = 1.2608, lr_0 = 1.1124e-04
Loss = 5.3817e-02, PNorm = 45.1018, GNorm = 1.5430, lr_0 = 1.0894e-04
Validation rmse = 0.136542
Validation r2 = 0.794115
Validation mse = 0.018644
Epoch 55
Loss = 4.6718e-02, PNorm = 45.1065, GNorm = 0.8697, lr_0 = 1.0647e-04
Loss = 5.6388e-02, PNorm = 45.1103, GNorm = 1.6969, lr_0 = 1.0427e-04
Loss = 2.2820e-02, PNorm = 45.1107, GNorm = 0.8433, lr_0 = 1.0405e-04
Validation rmse = 0.139932
Validation r2 = 0.783766
Validation mse = 0.019581
Epoch 56
Loss = 5.2410e-02, PNorm = 45.1160, GNorm = 0.7707, lr_0 = 1.0190e-04
Loss = 4.4524e-02, PNorm = 45.1193, GNorm = 0.8154, lr_0 = 1.0000e-04
Validation rmse = 0.143858
Validation r2 = 0.771460
Validation mse = 0.020695
Epoch 57
Loss = 5.0143e-02, PNorm = 45.1231, GNorm = 1.2728, lr_0 = 1.0000e-04
Validation rmse = 0.132345
Validation r2 = 0.806578
Validation mse = 0.017515
Epoch 58
Loss = 7.5586e-02, PNorm = 45.1277, GNorm = 1.2596, lr_0 = 1.0000e-04
Loss = 5.0376e-02, PNorm = 45.1325, GNorm = 0.6857, lr_0 = 1.0000e-04
Validation rmse = 0.138148
Validation r2 = 0.789244
Validation mse = 0.019085
Epoch 59
Loss = 4.0885e-02, PNorm = 45.1363, GNorm = 0.5833, lr_0 = 1.0000e-04
Loss = 4.7278e-02, PNorm = 45.1400, GNorm = 1.2558, lr_0 = 1.0000e-04
Validation rmse = 0.138422
Validation r2 = 0.788407
Validation mse = 0.019161
Model 0 best validation rmse = 0.127875 on epoch 37
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.166072
Model 0 test r2 = 0.749352
Model 0 test mse = 0.027580
Ensemble test rmse = 0.166072
Ensemble test r2 = 0.749352
Ensemble test mse = 0.027580
Fold 6
Splitting data with seed 6
Total size = 975 | train size = 965 | val size = 10 | test size = 57
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.9775e-01, PNorm = 43.2613, GNorm = 5.9782, lr_0 = 3.6053e-04
Validation rmse = 0.334334
Validation r2 = -0.426430
Validation mse = 0.111779
Epoch 1
Loss = 1.0025e+00, PNorm = 43.2880, GNorm = 13.4083, lr_0 = 6.2105e-04
Loss = 8.6822e-01, PNorm = 43.3193, GNorm = 3.5496, lr_0 = 8.5789e-04
Validation rmse = 0.270172
Validation r2 = 0.068530
Validation mse = 0.072993
Epoch 2
Loss = 4.1407e-01, PNorm = 43.3918, GNorm = 0.9669, lr_0 = 9.8961e-04
Loss = 6.1799e-01, PNorm = 43.4579, GNorm = 3.0689, lr_0 = 9.6914e-04
Validation rmse = 0.215413
Validation r2 = 0.407846
Validation mse = 0.046403
Epoch 3
Loss = 3.3248e-01, PNorm = 43.5443, GNorm = 1.5580, lr_0 = 9.4712e-04
Loss = 3.5231e-01, PNorm = 43.6064, GNorm = 4.3058, lr_0 = 9.2754e-04
Validation rmse = 0.129549
Validation r2 = 0.785830
Validation mse = 0.016783
Epoch 4
Loss = 2.8073e-01, PNorm = 43.6685, GNorm = 1.5141, lr_0 = 9.0836e-04
Loss = 2.8121e-01, PNorm = 43.7201, GNorm = 4.6570, lr_0 = 8.8958e-04
Validation rmse = 0.115792
Validation r2 = 0.828901
Validation mse = 0.013408
Epoch 5
Loss = 2.5524e-01, PNorm = 43.7676, GNorm = 4.2970, lr_0 = 8.6936e-04
Loss = 2.2795e-01, PNorm = 43.8097, GNorm = 2.2887, lr_0 = 8.5139e-04
Validation rmse = 0.076465
Validation r2 = 0.925388
Validation mse = 0.005847
Epoch 6
Loss = 2.1646e-01, PNorm = 43.8500, GNorm = 1.3308, lr_0 = 8.3204e-04
Loss = 1.9181e-01, PNorm = 43.8839, GNorm = 2.3198, lr_0 = 8.1484e-04
Validation rmse = 0.086654
Validation r2 = 0.904177
Validation mse = 0.007509
Epoch 7
Loss = 1.8455e-01, PNorm = 43.9149, GNorm = 1.7896, lr_0 = 7.9799e-04
Loss = 2.0934e-01, PNorm = 43.9458, GNorm = 0.8825, lr_0 = 7.8149e-04
Validation rmse = 0.121054
Validation r2 = 0.812998
Validation mse = 0.014654
Epoch 8
Loss = 1.4836e-01, PNorm = 43.9746, GNorm = 0.8917, lr_0 = 7.6373e-04
Loss = 1.5559e-01, PNorm = 43.9986, GNorm = 1.2015, lr_0 = 7.4794e-04
Validation rmse = 0.071623
Validation r2 = 0.934538
Validation mse = 0.005130
Epoch 9
Loss = 1.2952e-01, PNorm = 44.0248, GNorm = 2.6733, lr_0 = 7.3094e-04
Loss = 1.5072e-01, PNorm = 44.0471, GNorm = 4.0634, lr_0 = 7.1583e-04
Validation rmse = 0.071985
Validation r2 = 0.933873
Validation mse = 0.005182
Epoch 10
Loss = 1.1212e-01, PNorm = 44.0690, GNorm = 2.1172, lr_0 = 7.0103e-04
Loss = 1.3982e-01, PNorm = 44.0899, GNorm = 1.8977, lr_0 = 6.8653e-04
Validation rmse = 0.077509
Validation r2 = 0.923336
Validation mse = 0.006008
Epoch 11
Loss = 1.2081e-01, PNorm = 44.1125, GNorm = 0.9128, lr_0 = 6.7093e-04
Loss = 1.2974e-01, PNorm = 44.1295, GNorm = 0.8275, lr_0 = 6.5706e-04
Validation rmse = 0.067693
Validation r2 = 0.941523
Validation mse = 0.004582
Epoch 12
Loss = 1.2654e-01, PNorm = 44.1537, GNorm = 2.5546, lr_0 = 6.4213e-04
Loss = 1.4012e-01, PNorm = 44.1717, GNorm = 2.6253, lr_0 = 6.2885e-04
Loss = 9.9358e-02, PNorm = 44.1738, GNorm = 2.9112, lr_0 = 6.2754e-04
Validation rmse = 0.099467
Validation r2 = 0.873746
Validation mse = 0.009894
Epoch 13
Loss = 1.4396e-01, PNorm = 44.2009, GNorm = 1.3371, lr_0 = 6.1456e-04
Loss = 1.2127e-01, PNorm = 44.2248, GNorm = 2.5100, lr_0 = 6.0185e-04
Validation rmse = 0.092336
Validation r2 = 0.891198
Validation mse = 0.008526
Epoch 14
Loss = 1.3379e-01, PNorm = 44.2454, GNorm = 3.5890, lr_0 = 5.8941e-04
Validation rmse = 0.078200
Validation r2 = 0.921962
Validation mse = 0.006115
Epoch 15
Loss = 2.1814e-01, PNorm = 44.2736, GNorm = 3.7875, lr_0 = 5.7602e-04
Loss = 1.0616e-01, PNorm = 44.2960, GNorm = 1.8166, lr_0 = 5.6411e-04
Validation rmse = 0.061143
Validation r2 = 0.952292
Validation mse = 0.003739
Epoch 16
Loss = 1.0999e-01, PNorm = 44.3165, GNorm = 0.4759, lr_0 = 5.5129e-04
Loss = 1.0246e-01, PNorm = 44.3301, GNorm = 1.7583, lr_0 = 5.3989e-04
Validation rmse = 0.063561
Validation r2 = 0.948445
Validation mse = 0.004040
Epoch 17
Loss = 7.5030e-02, PNorm = 44.3490, GNorm = 0.5620, lr_0 = 5.2873e-04
Loss = 9.1901e-02, PNorm = 44.3634, GNorm = 0.9699, lr_0 = 5.1779e-04
Validation rmse = 0.061768
Validation r2 = 0.951313
Validation mse = 0.003815
Epoch 18
Loss = 1.3765e-01, PNorm = 44.3803, GNorm = 3.0357, lr_0 = 5.0603e-04
Loss = 1.0667e-01, PNorm = 44.3982, GNorm = 1.4977, lr_0 = 4.9556e-04
Validation rmse = 0.065348
Validation r2 = 0.945505
Validation mse = 0.004270
Epoch 19
Loss = 9.9625e-02, PNorm = 44.4129, GNorm = 0.7723, lr_0 = 4.8430e-04
Loss = 8.7211e-02, PNorm = 44.4257, GNorm = 0.4788, lr_0 = 4.7429e-04
Validation rmse = 0.056542
Validation r2 = 0.959202
Validation mse = 0.003197
Epoch 20
Loss = 8.0296e-02, PNorm = 44.4392, GNorm = 0.5513, lr_0 = 4.6448e-04
Loss = 8.8573e-02, PNorm = 44.4518, GNorm = 0.6090, lr_0 = 4.5488e-04
Validation rmse = 0.052245
Validation r2 = 0.965169
Validation mse = 0.002730
Epoch 21
Loss = 9.5413e-02, PNorm = 44.4727, GNorm = 1.7053, lr_0 = 4.4454e-04
Loss = 9.2870e-02, PNorm = 44.4875, GNorm = 1.8306, lr_0 = 4.3535e-04
Validation rmse = 0.077255
Validation r2 = 0.923838
Validation mse = 0.005968
Epoch 22
Loss = 1.1530e-01, PNorm = 44.5015, GNorm = 2.3482, lr_0 = 4.2546e-04
Loss = 9.3907e-02, PNorm = 44.5161, GNorm = 0.9169, lr_0 = 4.1666e-04
Validation rmse = 0.063585
Validation r2 = 0.948406
Validation mse = 0.004043
Epoch 23
Loss = 9.3058e-02, PNorm = 44.5325, GNorm = 1.9812, lr_0 = 4.0719e-04
Loss = 8.9047e-02, PNorm = 44.5440, GNorm = 0.7613, lr_0 = 3.9877e-04
Validation rmse = 0.050767
Validation r2 = 0.967111
Validation mse = 0.002577
Epoch 24
Loss = 7.5161e-02, PNorm = 44.5571, GNorm = 2.2882, lr_0 = 3.9053e-04
Loss = 9.8142e-02, PNorm = 44.5692, GNorm = 1.9927, lr_0 = 3.8245e-04
Validation rmse = 0.052347
Validation r2 = 0.965032
Validation mse = 0.002740
Epoch 25
Loss = 7.5707e-02, PNorm = 44.5785, GNorm = 1.1355, lr_0 = 3.7376e-04
Loss = 8.3618e-02, PNorm = 44.5903, GNorm = 2.1379, lr_0 = 3.6603e-04
Validation rmse = 0.082703
Validation r2 = 0.912718
Validation mse = 0.006840
Epoch 26
Loss = 8.8037e-02, PNorm = 44.6017, GNorm = 1.0755, lr_0 = 3.5772e-04
Loss = 9.6611e-02, PNorm = 44.6127, GNorm = 1.4001, lr_0 = 3.5032e-04
Validation rmse = 0.063348
Validation r2 = 0.948791
Validation mse = 0.004013
Epoch 27
Loss = 9.1056e-02, PNorm = 44.6237, GNorm = 2.0303, lr_0 = 3.4308e-04
Loss = 8.3043e-02, PNorm = 44.6358, GNorm = 1.0237, lr_0 = 3.3598e-04
Loss = 2.8204e-02, PNorm = 44.6371, GNorm = 0.7433, lr_0 = 3.3528e-04
Validation rmse = 0.049192
Validation r2 = 0.969119
Validation mse = 0.002420
Epoch 28
Loss = 8.2459e-02, PNorm = 44.6458, GNorm = 0.9965, lr_0 = 3.2835e-04
Validation rmse = 0.054156
Validation r2 = 0.962574
Validation mse = 0.002933
Epoch 29
Loss = 7.3819e-02, PNorm = 44.6567, GNorm = 1.2624, lr_0 = 3.2089e-04
Loss = 7.5419e-02, PNorm = 44.6671, GNorm = 0.5430, lr_0 = 3.1425e-04
Validation rmse = 0.055813
Validation r2 = 0.960248
Validation mse = 0.003115
Epoch 30
Loss = 5.2020e-02, PNorm = 44.6775, GNorm = 1.6294, lr_0 = 3.0775e-04
Loss = 7.4646e-02, PNorm = 44.6883, GNorm = 2.0064, lr_0 = 3.0139e-04
Validation rmse = 0.049695
Validation r2 = 0.968485
Validation mse = 0.002470
Epoch 31
Loss = 1.1057e-01, PNorm = 44.6959, GNorm = 2.5996, lr_0 = 2.9454e-04
Loss = 7.6189e-02, PNorm = 44.7053, GNorm = 1.5836, lr_0 = 2.8845e-04
Validation rmse = 0.063063
Validation r2 = 0.949250
Validation mse = 0.003977
Epoch 32
Loss = 9.1149e-02, PNorm = 44.7144, GNorm = 0.9082, lr_0 = 2.8190e-04
Loss = 7.5861e-02, PNorm = 44.7226, GNorm = 0.7988, lr_0 = 2.7607e-04
Validation rmse = 0.061129
Validation r2 = 0.952315
Validation mse = 0.003737
Epoch 33
Loss = 6.9189e-02, PNorm = 44.7340, GNorm = 1.9900, lr_0 = 2.6980e-04
Loss = 7.4238e-02, PNorm = 44.7415, GNorm = 0.8195, lr_0 = 2.6422e-04
Validation rmse = 0.053139
Validation r2 = 0.963966
Validation mse = 0.002824
Epoch 34
Loss = 7.3548e-02, PNorm = 44.7506, GNorm = 2.3563, lr_0 = 2.5875e-04
Loss = 6.7974e-02, PNorm = 44.7594, GNorm = 0.6843, lr_0 = 2.5340e-04
Validation rmse = 0.056972
Validation r2 = 0.958580
Validation mse = 0.003246
Epoch 35
Loss = 7.6363e-02, PNorm = 44.7695, GNorm = 3.0702, lr_0 = 2.4764e-04
Loss = 6.9857e-02, PNorm = 44.7765, GNorm = 0.7858, lr_0 = 2.4252e-04
Validation rmse = 0.052948
Validation r2 = 0.964224
Validation mse = 0.002803
Epoch 36
Loss = 6.5297e-02, PNorm = 44.7858, GNorm = 1.2377, lr_0 = 2.3701e-04
Loss = 6.6574e-02, PNorm = 44.7921, GNorm = 0.5693, lr_0 = 2.3211e-04
Validation rmse = 0.050446
Validation r2 = 0.967525
Validation mse = 0.002545
Epoch 37
Loss = 6.6872e-02, PNorm = 44.7983, GNorm = 0.6578, lr_0 = 2.2731e-04
Loss = 6.8881e-02, PNorm = 44.8060, GNorm = 0.9718, lr_0 = 2.2261e-04
Validation rmse = 0.052256
Validation r2 = 0.965153
Validation mse = 0.002731
Epoch 38
Loss = 7.4047e-02, PNorm = 44.8144, GNorm = 2.2054, lr_0 = 2.1755e-04
Loss = 6.5043e-02, PNorm = 44.8205, GNorm = 1.0392, lr_0 = 2.1306e-04
Validation rmse = 0.054047
Validation r2 = 0.962724
Validation mse = 0.002921
Epoch 39
Loss = 6.8073e-02, PNorm = 44.8290, GNorm = 0.6638, lr_0 = 2.0821e-04
Loss = 6.5887e-02, PNorm = 44.8354, GNorm = 0.6914, lr_0 = 2.0391e-04
Validation rmse = 0.055129
Validation r2 = 0.961217
Validation mse = 0.003039
Epoch 40
Loss = 6.1795e-02, PNorm = 44.8431, GNorm = 0.6135, lr_0 = 1.9969e-04
Loss = 7.0308e-02, PNorm = 44.8508, GNorm = 1.0397, lr_0 = 1.9556e-04
Validation rmse = 0.051916
Validation r2 = 0.965606
Validation mse = 0.002695
Epoch 41
Loss = 6.6037e-02, PNorm = 44.8579, GNorm = 1.3425, lr_0 = 1.9112e-04
Loss = 7.0269e-02, PNorm = 44.8637, GNorm = 2.8031, lr_0 = 1.8717e-04
Loss = 8.3521e-02, PNorm = 44.8643, GNorm = 1.3675, lr_0 = 1.8678e-04
Validation rmse = 0.061632
Validation r2 = 0.951527
Validation mse = 0.003798
Epoch 42
Loss = 6.2592e-02, PNorm = 44.8725, GNorm = 0.7786, lr_0 = 1.8292e-04
Validation rmse = 0.047179
Validation r2 = 0.971596
Validation mse = 0.002226
Epoch 43
Loss = 5.2331e-02, PNorm = 44.8790, GNorm = 1.1485, lr_0 = 1.7876e-04
Loss = 7.0451e-02, PNorm = 44.8855, GNorm = 1.0434, lr_0 = 1.7506e-04
Validation rmse = 0.046717
Validation r2 = 0.972149
Validation mse = 0.002183
Epoch 44
Loss = 6.3442e-02, PNorm = 44.8920, GNorm = 1.0565, lr_0 = 1.7144e-04
Loss = 7.3532e-02, PNorm = 44.8992, GNorm = 1.8558, lr_0 = 1.6790e-04
Validation rmse = 0.057823
Validation r2 = 0.957334
Validation mse = 0.003343
Epoch 45
Loss = 4.8469e-02, PNorm = 44.9059, GNorm = 0.4493, lr_0 = 1.6408e-04
Loss = 6.2203e-02, PNorm = 44.9120, GNorm = 1.7076, lr_0 = 1.6069e-04
Validation rmse = 0.055916
Validation r2 = 0.960101
Validation mse = 0.003127
Epoch 46
Loss = 5.3469e-02, PNorm = 44.9181, GNorm = 0.8463, lr_0 = 1.5704e-04
Loss = 5.9520e-02, PNorm = 44.9250, GNorm = 1.1718, lr_0 = 1.5379e-04
Validation rmse = 0.059381
Validation r2 = 0.955003
Validation mse = 0.003526
Epoch 47
Loss = 7.3257e-02, PNorm = 44.9294, GNorm = 0.9185, lr_0 = 1.5061e-04
Loss = 5.6896e-02, PNorm = 44.9356, GNorm = 1.7767, lr_0 = 1.4750e-04
Validation rmse = 0.049970
Validation r2 = 0.968136
Validation mse = 0.002497
Epoch 48
Loss = 5.5089e-02, PNorm = 44.9405, GNorm = 1.1994, lr_0 = 1.4415e-04
Loss = 5.5497e-02, PNorm = 44.9457, GNorm = 2.1299, lr_0 = 1.4117e-04
Validation rmse = 0.068284
Validation r2 = 0.940498
Validation mse = 0.004663
Epoch 49
Loss = 4.7556e-02, PNorm = 44.9518, GNorm = 0.3523, lr_0 = 1.3796e-04
Loss = 5.7974e-02, PNorm = 44.9570, GNorm = 0.5972, lr_0 = 1.3511e-04
Validation rmse = 0.057973
Validation r2 = 0.957112
Validation mse = 0.003361
Epoch 50
Loss = 5.9515e-02, PNorm = 44.9616, GNorm = 0.8820, lr_0 = 1.3231e-04
Loss = 5.7638e-02, PNorm = 44.9671, GNorm = 0.5551, lr_0 = 1.2958e-04
Validation rmse = 0.053610
Validation r2 = 0.963324
Validation mse = 0.002874
Epoch 51
Loss = 5.0916e-02, PNorm = 44.9722, GNorm = 1.0536, lr_0 = 1.2663e-04
Loss = 5.9464e-02, PNorm = 44.9769, GNorm = 0.7285, lr_0 = 1.2401e-04
Validation rmse = 0.066473
Validation r2 = 0.943613
Validation mse = 0.004419
Epoch 52
Loss = 5.8944e-02, PNorm = 44.9828, GNorm = 1.2670, lr_0 = 1.2119e-04
Loss = 5.7804e-02, PNorm = 44.9869, GNorm = 1.8360, lr_0 = 1.1869e-04
Validation rmse = 0.063715
Validation r2 = 0.948194
Validation mse = 0.004060
Epoch 53
Loss = 4.8899e-02, PNorm = 44.9925, GNorm = 0.6290, lr_0 = 1.1599e-04
Loss = 6.0724e-02, PNorm = 44.9971, GNorm = 0.5029, lr_0 = 1.1359e-04
Validation rmse = 0.055161
Validation r2 = 0.961171
Validation mse = 0.003043
Epoch 54
Loss = 5.4521e-02, PNorm = 45.0016, GNorm = 0.6991, lr_0 = 1.1124e-04
Loss = 5.1863e-02, PNorm = 45.0060, GNorm = 0.6329, lr_0 = 1.0894e-04
Validation rmse = 0.070117
Validation r2 = 0.937260
Validation mse = 0.004916
Epoch 55
Loss = 5.0840e-02, PNorm = 45.0097, GNorm = 0.8242, lr_0 = 1.0647e-04
Loss = 5.4135e-02, PNorm = 45.0135, GNorm = 0.4892, lr_0 = 1.0427e-04
Loss = 9.7903e-02, PNorm = 45.0139, GNorm = 1.6013, lr_0 = 1.0405e-04
Validation rmse = 0.059130
Validation r2 = 0.955382
Validation mse = 0.003496
Epoch 56
Loss = 4.7232e-02, PNorm = 45.0186, GNorm = 0.7295, lr_0 = 1.0190e-04
Loss = 6.1960e-02, PNorm = 45.0221, GNorm = 2.0353, lr_0 = 1.0000e-04
Validation rmse = 0.073956
Validation r2 = 0.930204
Validation mse = 0.005469
Epoch 57
Loss = 5.9861e-02, PNorm = 45.0265, GNorm = 1.1790, lr_0 = 1.0000e-04
Validation rmse = 0.049029
Validation r2 = 0.969325
Validation mse = 0.002404
Epoch 58
Loss = 4.5142e-02, PNorm = 45.0316, GNorm = 1.0153, lr_0 = 1.0000e-04
Loss = 5.4595e-02, PNorm = 45.0356, GNorm = 1.5086, lr_0 = 1.0000e-04
Validation rmse = 0.061968
Validation r2 = 0.950997
Validation mse = 0.003840
Epoch 59
Loss = 6.3853e-02, PNorm = 45.0399, GNorm = 1.2509, lr_0 = 1.0000e-04
Loss = 5.3149e-02, PNorm = 45.0440, GNorm = 2.3081, lr_0 = 1.0000e-04
Validation rmse = 0.056706
Validation r2 = 0.958966
Validation mse = 0.003216
Model 0 best validation rmse = 0.046717 on epoch 43
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.202910
Model 0 test r2 = 0.625822
Model 0 test mse = 0.041173
Ensemble test rmse = 0.202910
Ensemble test r2 = 0.625822
Ensemble test mse = 0.041173
Fold 7
Splitting data with seed 7
Total size = 975 | train size = 965 | val size = 10 | test size = 57
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.7989e-01, PNorm = 43.2613, GNorm = 1.6520, lr_0 = 3.6053e-04
Validation rmse = 0.260313
Validation r2 = 0.360127
Validation mse = 0.067763
Epoch 1
Loss = 6.6789e-01, PNorm = 43.2899, GNorm = 6.3577, lr_0 = 6.2105e-04
Loss = 7.0088e-01, PNorm = 43.3391, GNorm = 2.7020, lr_0 = 8.5789e-04
Validation rmse = 0.185532
Validation r2 = 0.674958
Validation mse = 0.034422
Epoch 2
Loss = 6.1324e-01, PNorm = 43.4077, GNorm = 5.2037, lr_0 = 9.8961e-04
Loss = 4.8277e-01, PNorm = 43.4788, GNorm = 3.8227, lr_0 = 9.6914e-04
Validation rmse = 0.167054
Validation r2 = 0.736480
Validation mse = 0.027907
Epoch 3
Loss = 3.2142e-01, PNorm = 43.5590, GNorm = 2.9972, lr_0 = 9.4712e-04
Loss = 3.5214e-01, PNorm = 43.6283, GNorm = 1.9123, lr_0 = 9.2754e-04
Validation rmse = 0.173807
Validation r2 = 0.714742
Validation mse = 0.030209
Epoch 4
Loss = 2.5890e-01, PNorm = 43.6886, GNorm = 2.2655, lr_0 = 9.0836e-04
Loss = 2.5097e-01, PNorm = 43.7428, GNorm = 3.1383, lr_0 = 8.8958e-04
Validation rmse = 0.225514
Validation r2 = 0.519770
Validation mse = 0.050857
Epoch 5
Loss = 2.8314e-01, PNorm = 43.7893, GNorm = 7.0327, lr_0 = 8.6936e-04
Loss = 2.3687e-01, PNorm = 43.8386, GNorm = 1.8393, lr_0 = 8.5139e-04
Validation rmse = 0.199348
Validation r2 = 0.624747
Validation mse = 0.039740
Epoch 6
Loss = 2.0816e-01, PNorm = 43.8814, GNorm = 7.1136, lr_0 = 8.3204e-04
Loss = 2.2133e-01, PNorm = 43.9241, GNorm = 1.3710, lr_0 = 8.1484e-04
Validation rmse = 0.185246
Validation r2 = 0.675961
Validation mse = 0.034316
Epoch 7
Loss = 1.7500e-01, PNorm = 43.9630, GNorm = 2.0847, lr_0 = 7.9799e-04
Loss = 1.6670e-01, PNorm = 43.9867, GNorm = 1.0380, lr_0 = 7.8149e-04
Validation rmse = 0.173172
Validation r2 = 0.716825
Validation mse = 0.029988
Epoch 8
Loss = 1.2509e-01, PNorm = 44.0179, GNorm = 2.1585, lr_0 = 7.6373e-04
Loss = 1.3710e-01, PNorm = 44.0413, GNorm = 1.2855, lr_0 = 7.4794e-04
Validation rmse = 0.169598
Validation r2 = 0.728394
Validation mse = 0.028763
Epoch 9
Loss = 1.7090e-01, PNorm = 44.0616, GNorm = 3.8580, lr_0 = 7.3094e-04
Loss = 1.5854e-01, PNorm = 44.0903, GNorm = 0.9817, lr_0 = 7.1583e-04
Validation rmse = 0.166436
Validation r2 = 0.738427
Validation mse = 0.027701
Epoch 10
Loss = 2.0349e-01, PNorm = 44.1286, GNorm = 3.2149, lr_0 = 7.0103e-04
Loss = 1.5446e-01, PNorm = 44.1562, GNorm = 2.8542, lr_0 = 6.8653e-04
Validation rmse = 0.167654
Validation r2 = 0.734585
Validation mse = 0.028108
Epoch 11
Loss = 1.3652e-01, PNorm = 44.1786, GNorm = 2.8123, lr_0 = 6.7093e-04
Loss = 1.3567e-01, PNorm = 44.1999, GNorm = 0.9085, lr_0 = 6.5706e-04
Validation rmse = 0.166427
Validation r2 = 0.738454
Validation mse = 0.027698
Epoch 12
Loss = 1.0800e-01, PNorm = 44.2242, GNorm = 1.1563, lr_0 = 6.4213e-04
Loss = 1.3029e-01, PNorm = 44.2414, GNorm = 0.8230, lr_0 = 6.2885e-04
Loss = 9.0933e-02, PNorm = 44.2435, GNorm = 0.8921, lr_0 = 6.2754e-04
Validation rmse = 0.165821
Validation r2 = 0.740356
Validation mse = 0.027497
Epoch 13
Loss = 1.1093e-01, PNorm = 44.2557, GNorm = 0.7699, lr_0 = 6.1456e-04
Loss = 1.2646e-01, PNorm = 44.2746, GNorm = 1.0938, lr_0 = 6.0185e-04
Validation rmse = 0.168521
Validation r2 = 0.731829
Validation mse = 0.028399
Epoch 14
Loss = 1.0004e-01, PNorm = 44.2920, GNorm = 1.3312, lr_0 = 5.8941e-04
Validation rmse = 0.164996
Validation r2 = 0.742932
Validation mse = 0.027224
Epoch 15
Loss = 1.0243e-01, PNorm = 44.3085, GNorm = 1.5502, lr_0 = 5.7602e-04
Loss = 1.1041e-01, PNorm = 44.3261, GNorm = 1.5149, lr_0 = 5.6411e-04
Validation rmse = 0.168240
Validation r2 = 0.732725
Validation mse = 0.028305
Epoch 16
Loss = 1.0375e-01, PNorm = 44.3444, GNorm = 1.9483, lr_0 = 5.5129e-04
Loss = 1.0460e-01, PNorm = 44.3610, GNorm = 0.9253, lr_0 = 5.3989e-04
Validation rmse = 0.181664
Validation r2 = 0.688370
Validation mse = 0.033002
Epoch 17
Loss = 7.8189e-02, PNorm = 44.3797, GNorm = 2.6296, lr_0 = 5.2873e-04
Loss = 9.9874e-02, PNorm = 44.3972, GNorm = 0.6150, lr_0 = 5.1779e-04
Validation rmse = 0.167238
Validation r2 = 0.735899
Validation mse = 0.027969
Epoch 18
Loss = 9.3382e-02, PNorm = 44.4116, GNorm = 0.5216, lr_0 = 5.0603e-04
Loss = 9.5198e-02, PNorm = 44.4260, GNorm = 2.5076, lr_0 = 4.9556e-04
Validation rmse = 0.180674
Validation r2 = 0.691759
Validation mse = 0.032643
Epoch 19
Loss = 6.7455e-02, PNorm = 44.4421, GNorm = 0.5520, lr_0 = 4.8430e-04
Loss = 1.0577e-01, PNorm = 44.4602, GNorm = 2.6128, lr_0 = 4.7429e-04
Validation rmse = 0.174618
Validation r2 = 0.712074
Validation mse = 0.030492
Epoch 20
Loss = 9.2062e-02, PNorm = 44.4765, GNorm = 0.5811, lr_0 = 4.6448e-04
Loss = 8.4380e-02, PNorm = 44.4916, GNorm = 0.8260, lr_0 = 4.5488e-04
Validation rmse = 0.175504
Validation r2 = 0.709146
Validation mse = 0.030802
Epoch 21
Loss = 8.2211e-02, PNorm = 44.5067, GNorm = 2.1524, lr_0 = 4.4454e-04
Loss = 9.8015e-02, PNorm = 44.5220, GNorm = 2.3331, lr_0 = 4.3535e-04
Validation rmse = 0.188552
Validation r2 = 0.664292
Validation mse = 0.035552
Epoch 22
Loss = 8.6697e-02, PNorm = 44.5371, GNorm = 1.0725, lr_0 = 4.2546e-04
Loss = 8.6471e-02, PNorm = 44.5500, GNorm = 1.5934, lr_0 = 4.1666e-04
Validation rmse = 0.187997
Validation r2 = 0.666265
Validation mse = 0.035343
Epoch 23
Loss = 7.7391e-02, PNorm = 44.5630, GNorm = 0.8686, lr_0 = 4.0719e-04
Loss = 9.2079e-02, PNorm = 44.5757, GNorm = 1.3481, lr_0 = 3.9877e-04
Validation rmse = 0.178778
Validation r2 = 0.698193
Validation mse = 0.031962
Epoch 24
Loss = 9.5228e-02, PNorm = 44.5907, GNorm = 0.8321, lr_0 = 3.9053e-04
Loss = 7.8271e-02, PNorm = 44.6008, GNorm = 1.2044, lr_0 = 3.8245e-04
Validation rmse = 0.180059
Validation r2 = 0.693851
Validation mse = 0.032421
Epoch 25
Loss = 8.7831e-02, PNorm = 44.6122, GNorm = 0.8677, lr_0 = 3.7376e-04
Loss = 7.6789e-02, PNorm = 44.6244, GNorm = 0.5658, lr_0 = 3.6603e-04
Validation rmse = 0.194807
Validation r2 = 0.641648
Validation mse = 0.037950
Epoch 26
Loss = 6.7224e-02, PNorm = 44.6379, GNorm = 0.5230, lr_0 = 3.5772e-04
Loss = 8.4414e-02, PNorm = 44.6478, GNorm = 0.5604, lr_0 = 3.5032e-04
Validation rmse = 0.185551
Validation r2 = 0.674894
Validation mse = 0.034429
Epoch 27
Loss = 7.2371e-02, PNorm = 44.6597, GNorm = 0.6922, lr_0 = 3.4308e-04
Loss = 8.2055e-02, PNorm = 44.6694, GNorm = 1.4100, lr_0 = 3.3598e-04
Loss = 4.4392e-02, PNorm = 44.6706, GNorm = 0.9877, lr_0 = 3.3528e-04
Validation rmse = 0.188040
Validation r2 = 0.666113
Validation mse = 0.035359
Epoch 28
Loss = 6.7083e-02, PNorm = 44.6825, GNorm = 1.0949, lr_0 = 3.2835e-04
Validation rmse = 0.197618
Validation r2 = 0.631230
Validation mse = 0.039053
Epoch 29
Loss = 8.2899e-02, PNorm = 44.6930, GNorm = 1.8432, lr_0 = 3.2089e-04
Loss = 6.4863e-02, PNorm = 44.7017, GNorm = 0.4576, lr_0 = 3.1425e-04
Validation rmse = 0.191545
Validation r2 = 0.653548
Validation mse = 0.036690
Epoch 30
Loss = 6.6310e-02, PNorm = 44.7103, GNorm = 1.3773, lr_0 = 3.0775e-04
Loss = 6.5190e-02, PNorm = 44.7199, GNorm = 0.8374, lr_0 = 3.0139e-04
Validation rmse = 0.189117
Validation r2 = 0.662275
Validation mse = 0.035765
Epoch 31
Loss = 7.8339e-02, PNorm = 44.7323, GNorm = 1.3850, lr_0 = 2.9454e-04
Loss = 6.2965e-02, PNorm = 44.7405, GNorm = 0.9249, lr_0 = 2.8845e-04
Validation rmse = 0.199159
Validation r2 = 0.625460
Validation mse = 0.039664
Epoch 32
Loss = 6.2618e-02, PNorm = 44.7524, GNorm = 0.6847, lr_0 = 2.8190e-04
Loss = 6.1663e-02, PNorm = 44.7626, GNorm = 0.7169, lr_0 = 2.7607e-04
Validation rmse = 0.191323
Validation r2 = 0.654351
Validation mse = 0.036604
Epoch 33
Loss = 5.9140e-02, PNorm = 44.7709, GNorm = 0.4673, lr_0 = 2.6980e-04
Loss = 7.3977e-02, PNorm = 44.7807, GNorm = 1.6885, lr_0 = 2.6422e-04
Validation rmse = 0.193477
Validation r2 = 0.646525
Validation mse = 0.037433
Epoch 34
Loss = 7.1195e-02, PNorm = 44.7910, GNorm = 0.4094, lr_0 = 2.5875e-04
Loss = 6.3824e-02, PNorm = 44.8011, GNorm = 1.3006, lr_0 = 2.5340e-04
Validation rmse = 0.196086
Validation r2 = 0.636928
Validation mse = 0.038450
Epoch 35
Loss = 6.7298e-02, PNorm = 44.8105, GNorm = 1.2918, lr_0 = 2.4764e-04
Loss = 6.4924e-02, PNorm = 44.8190, GNorm = 1.6580, lr_0 = 2.4252e-04
Validation rmse = 0.198919
Validation r2 = 0.626362
Validation mse = 0.039569
Epoch 36
Loss = 7.0405e-02, PNorm = 44.8277, GNorm = 2.0064, lr_0 = 2.3701e-04
Loss = 7.1145e-02, PNorm = 44.8374, GNorm = 0.8175, lr_0 = 2.3211e-04
Validation rmse = 0.197287
Validation r2 = 0.632465
Validation mse = 0.038922
Epoch 37
Loss = 7.7551e-02, PNorm = 44.8459, GNorm = 0.9461, lr_0 = 2.2731e-04
Loss = 5.7004e-02, PNorm = 44.8532, GNorm = 0.9843, lr_0 = 2.2261e-04
Validation rmse = 0.192663
Validation r2 = 0.649491
Validation mse = 0.037119
Epoch 38
Loss = 4.6594e-02, PNorm = 44.8624, GNorm = 1.0813, lr_0 = 2.1755e-04
Loss = 6.8372e-02, PNorm = 44.8693, GNorm = 0.8380, lr_0 = 2.1306e-04
Validation rmse = 0.197352
Validation r2 = 0.632223
Validation mse = 0.038948
Epoch 39
Loss = 5.3254e-02, PNorm = 44.8784, GNorm = 0.5163, lr_0 = 2.0821e-04
Loss = 6.1902e-02, PNorm = 44.8850, GNorm = 0.6942, lr_0 = 2.0391e-04
Validation rmse = 0.195103
Validation r2 = 0.640559
Validation mse = 0.038065
Epoch 40
Loss = 6.1966e-02, PNorm = 44.8921, GNorm = 1.0573, lr_0 = 1.9969e-04
Loss = 5.7929e-02, PNorm = 44.9002, GNorm = 1.0002, lr_0 = 1.9556e-04
Validation rmse = 0.196857
Validation r2 = 0.634068
Validation mse = 0.038753
Epoch 41
Loss = 5.3285e-02, PNorm = 44.9079, GNorm = 1.3193, lr_0 = 1.9112e-04
Loss = 6.6427e-02, PNorm = 44.9146, GNorm = 0.4853, lr_0 = 1.8717e-04
Loss = 3.4576e-02, PNorm = 44.9152, GNorm = 1.6136, lr_0 = 1.8678e-04
Validation rmse = 0.199591
Validation r2 = 0.623830
Validation mse = 0.039837
Epoch 42
Loss = 5.3492e-02, PNorm = 44.9216, GNorm = 0.4836, lr_0 = 1.8292e-04
Validation rmse = 0.198818
Validation r2 = 0.626741
Validation mse = 0.039528
Epoch 43
Loss = 4.7041e-02, PNorm = 44.9284, GNorm = 0.6172, lr_0 = 1.7876e-04
Loss = 6.7705e-02, PNorm = 44.9339, GNorm = 0.7883, lr_0 = 1.7506e-04
Validation rmse = 0.200996
Validation r2 = 0.618518
Validation mse = 0.040399
Epoch 44
Loss = 4.7620e-02, PNorm = 44.9410, GNorm = 1.0952, lr_0 = 1.7144e-04
Loss = 4.9892e-02, PNorm = 44.9467, GNorm = 0.5448, lr_0 = 1.6790e-04
Validation rmse = 0.194350
Validation r2 = 0.643329
Validation mse = 0.037772
Epoch 45
Loss = 5.4331e-02, PNorm = 44.9539, GNorm = 0.8289, lr_0 = 1.6408e-04
Loss = 5.1737e-02, PNorm = 44.9600, GNorm = 0.9075, lr_0 = 1.6069e-04
Validation rmse = 0.195688
Validation r2 = 0.638400
Validation mse = 0.038294
Epoch 46
Loss = 5.0955e-02, PNorm = 44.9655, GNorm = 0.6845, lr_0 = 1.5704e-04
Loss = 5.4752e-02, PNorm = 44.9713, GNorm = 1.5502, lr_0 = 1.5379e-04
Validation rmse = 0.193365
Validation r2 = 0.646933
Validation mse = 0.037390
Epoch 47
Loss = 4.2053e-02, PNorm = 44.9774, GNorm = 1.1592, lr_0 = 1.5061e-04
Loss = 5.3987e-02, PNorm = 44.9831, GNorm = 0.5406, lr_0 = 1.4750e-04
Validation rmse = 0.195491
Validation r2 = 0.639128
Validation mse = 0.038217
Epoch 48
Loss = 4.9848e-02, PNorm = 44.9892, GNorm = 0.3281, lr_0 = 1.4415e-04
Loss = 5.4341e-02, PNorm = 44.9940, GNorm = 0.6576, lr_0 = 1.4117e-04
Validation rmse = 0.193015
Validation r2 = 0.648212
Validation mse = 0.037255
Epoch 49
Loss = 5.0102e-02, PNorm = 45.0002, GNorm = 0.9505, lr_0 = 1.3796e-04
Loss = 5.9619e-02, PNorm = 45.0057, GNorm = 2.0716, lr_0 = 1.3511e-04
Validation rmse = 0.205484
Validation r2 = 0.601290
Validation mse = 0.042224
Epoch 50
Loss = 5.3953e-02, PNorm = 45.0108, GNorm = 1.4364, lr_0 = 1.3231e-04
Loss = 5.2441e-02, PNorm = 45.0154, GNorm = 0.5863, lr_0 = 1.2958e-04
Validation rmse = 0.194963
Validation r2 = 0.641072
Validation mse = 0.038011
Epoch 51
Loss = 4.9612e-02, PNorm = 45.0215, GNorm = 0.6412, lr_0 = 1.2663e-04
Loss = 5.4441e-02, PNorm = 45.0260, GNorm = 1.7106, lr_0 = 1.2401e-04
Validation rmse = 0.194800
Validation r2 = 0.641674
Validation mse = 0.037947
Epoch 52
Loss = 4.6398e-02, PNorm = 45.0312, GNorm = 0.8134, lr_0 = 1.2119e-04
Loss = 5.3066e-02, PNorm = 45.0354, GNorm = 0.5176, lr_0 = 1.1869e-04
Validation rmse = 0.194862
Validation r2 = 0.641448
Validation mse = 0.037971
Epoch 53
Loss = 4.3706e-02, PNorm = 45.0405, GNorm = 0.4369, lr_0 = 1.1599e-04
Loss = 4.9788e-02, PNorm = 45.0447, GNorm = 0.5622, lr_0 = 1.1359e-04
Validation rmse = 0.192799
Validation r2 = 0.648997
Validation mse = 0.037172
Epoch 54
Loss = 4.7579e-02, PNorm = 45.0482, GNorm = 0.5676, lr_0 = 1.1124e-04
Loss = 4.9108e-02, PNorm = 45.0523, GNorm = 1.2821, lr_0 = 1.0894e-04
Validation rmse = 0.192950
Validation r2 = 0.648446
Validation mse = 0.037230
Epoch 55
Loss = 4.9963e-02, PNorm = 45.0575, GNorm = 1.1018, lr_0 = 1.0647e-04
Loss = 4.4923e-02, PNorm = 45.0613, GNorm = 0.5512, lr_0 = 1.0427e-04
Loss = 4.7272e-02, PNorm = 45.0618, GNorm = 1.4450, lr_0 = 1.0405e-04
Validation rmse = 0.192692
Validation r2 = 0.649388
Validation mse = 0.037130
Epoch 56
Loss = 4.9458e-02, PNorm = 45.0650, GNorm = 0.5009, lr_0 = 1.0190e-04
Loss = 4.3876e-02, PNorm = 45.0687, GNorm = 0.8368, lr_0 = 1.0000e-04
Validation rmse = 0.194346
Validation r2 = 0.643341
Validation mse = 0.037770
Epoch 57
Loss = 4.4671e-02, PNorm = 45.0720, GNorm = 0.7054, lr_0 = 1.0000e-04
Validation rmse = 0.192455
Validation r2 = 0.650248
Validation mse = 0.037039
Epoch 58
Loss = 5.8110e-02, PNorm = 45.0759, GNorm = 0.9238, lr_0 = 1.0000e-04
Loss = 4.7464e-02, PNorm = 45.0800, GNorm = 1.3098, lr_0 = 1.0000e-04
Validation rmse = 0.194144
Validation r2 = 0.644083
Validation mse = 0.037692
Epoch 59
Loss = 3.9020e-02, PNorm = 45.0840, GNorm = 0.9826, lr_0 = 1.0000e-04
Loss = 4.6015e-02, PNorm = 45.0874, GNorm = 0.7626, lr_0 = 1.0000e-04
Validation rmse = 0.190603
Validation r2 = 0.656947
Validation mse = 0.036330
Model 0 best validation rmse = 0.164996 on epoch 14
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.194087
Model 0 test r2 = 0.657654
Model 0 test mse = 0.037670
Ensemble test rmse = 0.194087
Ensemble test r2 = 0.657654
Ensemble test mse = 0.037670
Fold 8
Splitting data with seed 8
Total size = 975 | train size = 965 | val size = 10 | test size = 57
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.2894e-01, PNorm = 43.2627, GNorm = 1.5746, lr_0 = 3.6053e-04
Validation rmse = 0.345711
Validation r2 = -0.089260
Validation mse = 0.119516
Epoch 1
Loss = 9.7430e-01, PNorm = 43.2830, GNorm = 8.9442, lr_0 = 6.2105e-04
Loss = 7.1015e-01, PNorm = 43.3262, GNorm = 3.8262, lr_0 = 8.5789e-04
Validation rmse = 0.314366
Validation r2 = 0.099303
Validation mse = 0.098826
Epoch 2
Loss = 3.5442e-01, PNorm = 43.4046, GNorm = 1.8984, lr_0 = 9.8961e-04
Loss = 4.2758e-01, PNorm = 43.4884, GNorm = 6.4996, lr_0 = 9.6914e-04
Validation rmse = 0.306826
Validation r2 = 0.141990
Validation mse = 0.094142
Epoch 3
Loss = 3.2867e-01, PNorm = 43.5737, GNorm = 7.1362, lr_0 = 9.4712e-04
Loss = 3.7623e-01, PNorm = 43.6425, GNorm = 4.2170, lr_0 = 9.2754e-04
Validation rmse = 0.267818
Validation r2 = 0.346289
Validation mse = 0.071726
Epoch 4
Loss = 2.5252e-01, PNorm = 43.7143, GNorm = 5.0330, lr_0 = 9.0836e-04
Loss = 2.9065e-01, PNorm = 43.7732, GNorm = 2.1480, lr_0 = 8.8958e-04
Validation rmse = 0.200764
Validation r2 = 0.632652
Validation mse = 0.040306
Epoch 5
Loss = 1.8752e-01, PNorm = 43.8143, GNorm = 1.1325, lr_0 = 8.6936e-04
Loss = 1.9884e-01, PNorm = 43.8493, GNorm = 1.0596, lr_0 = 8.5139e-04
Validation rmse = 0.137241
Validation r2 = 0.828337
Validation mse = 0.018835
Epoch 6
Loss = 1.5237e-01, PNorm = 43.8909, GNorm = 2.4939, lr_0 = 8.3204e-04
Loss = 1.5573e-01, PNorm = 43.9202, GNorm = 0.8896, lr_0 = 8.1484e-04
Validation rmse = 0.171136
Validation r2 = 0.733074
Validation mse = 0.029288
Epoch 7
Loss = 1.9698e-01, PNorm = 43.9453, GNorm = 4.5019, lr_0 = 7.9799e-04
Loss = 1.8260e-01, PNorm = 43.9796, GNorm = 3.7027, lr_0 = 7.8149e-04
Validation rmse = 0.167768
Validation r2 = 0.743477
Validation mse = 0.028146
Epoch 8
Loss = 1.9731e-01, PNorm = 44.0108, GNorm = 3.5092, lr_0 = 7.6373e-04
Loss = 1.6194e-01, PNorm = 44.0413, GNorm = 3.6206, lr_0 = 7.4794e-04
Validation rmse = 0.140317
Validation r2 = 0.820557
Validation mse = 0.019689
Epoch 9
Loss = 1.6291e-01, PNorm = 44.0734, GNorm = 1.3885, lr_0 = 7.3094e-04
Loss = 1.4534e-01, PNorm = 44.0967, GNorm = 2.6542, lr_0 = 7.1583e-04
Validation rmse = 0.126206
Validation r2 = 0.854833
Validation mse = 0.015928
Epoch 10
Loss = 1.7650e-01, PNorm = 44.1197, GNorm = 4.9648, lr_0 = 7.0103e-04
Loss = 1.3437e-01, PNorm = 44.1432, GNorm = 1.5087, lr_0 = 6.8653e-04
Validation rmse = 0.161953
Validation r2 = 0.760951
Validation mse = 0.026229
Epoch 11
Loss = 1.3548e-01, PNorm = 44.1667, GNorm = 2.5455, lr_0 = 6.7093e-04
Loss = 1.1065e-01, PNorm = 44.1828, GNorm = 1.7802, lr_0 = 6.5706e-04
Validation rmse = 0.096093
Validation r2 = 0.915843
Validation mse = 0.009234
Epoch 12
Loss = 1.1696e-01, PNorm = 44.2047, GNorm = 1.5728, lr_0 = 6.4213e-04
Loss = 1.1707e-01, PNorm = 44.2208, GNorm = 0.4961, lr_0 = 6.2885e-04
Loss = 4.0655e-02, PNorm = 44.2227, GNorm = 0.7227, lr_0 = 6.2754e-04
Validation rmse = 0.164157
Validation r2 = 0.754402
Validation mse = 0.026947
Epoch 13
Loss = 1.1606e-01, PNorm = 44.2422, GNorm = 0.8509, lr_0 = 6.1456e-04
Loss = 1.0953e-01, PNorm = 44.2566, GNorm = 1.3262, lr_0 = 6.0185e-04
Validation rmse = 0.127428
Validation r2 = 0.852010
Validation mse = 0.016238
Epoch 14
Loss = 1.0882e-01, PNorm = 44.2720, GNorm = 0.5607, lr_0 = 5.8941e-04
Validation rmse = 0.084084
Validation r2 = 0.935563
Validation mse = 0.007070
Epoch 15
Loss = 9.6123e-02, PNorm = 44.2910, GNorm = 1.0952, lr_0 = 5.7602e-04
Loss = 9.8160e-02, PNorm = 44.3081, GNorm = 0.9475, lr_0 = 5.6411e-04
Validation rmse = 0.119376
Validation r2 = 0.870121
Validation mse = 0.014251
Epoch 16
Loss = 9.6585e-02, PNorm = 44.3160, GNorm = 2.7768, lr_0 = 5.5129e-04
Loss = 1.2039e-01, PNorm = 44.3363, GNorm = 1.1571, lr_0 = 5.3989e-04
Validation rmse = 0.103063
Validation r2 = 0.903191
Validation mse = 0.010622
Epoch 17
Loss = 1.1595e-01, PNorm = 44.3532, GNorm = 0.8386, lr_0 = 5.2873e-04
Loss = 1.1076e-01, PNorm = 44.3717, GNorm = 0.6835, lr_0 = 5.1779e-04
Validation rmse = 0.102436
Validation r2 = 0.904365
Validation mse = 0.010493
Epoch 18
Loss = 9.3152e-02, PNorm = 44.3916, GNorm = 0.4070, lr_0 = 5.0603e-04
Loss = 9.5951e-02, PNorm = 44.4077, GNorm = 1.1435, lr_0 = 4.9556e-04
Validation rmse = 0.089726
Validation r2 = 0.926625
Validation mse = 0.008051
Epoch 19
Loss = 7.4644e-02, PNorm = 44.4245, GNorm = 1.3659, lr_0 = 4.8430e-04
Loss = 1.0956e-01, PNorm = 44.4339, GNorm = 1.7867, lr_0 = 4.7429e-04
Validation rmse = 0.092094
Validation r2 = 0.922702
Validation mse = 0.008481
Epoch 20
Loss = 1.0292e-01, PNorm = 44.4505, GNorm = 2.8781, lr_0 = 4.6448e-04
Loss = 9.0946e-02, PNorm = 44.4641, GNorm = 1.0871, lr_0 = 4.5488e-04
Validation rmse = 0.087671
Validation r2 = 0.929949
Validation mse = 0.007686
Epoch 21
Loss = 9.0948e-02, PNorm = 44.4757, GNorm = 1.0369, lr_0 = 4.4454e-04
Loss = 8.7108e-02, PNorm = 44.4892, GNorm = 1.6745, lr_0 = 4.3535e-04
Validation rmse = 0.099722
Validation r2 = 0.909367
Validation mse = 0.009944
Epoch 22
Loss = 9.0742e-02, PNorm = 44.5021, GNorm = 2.4090, lr_0 = 4.2546e-04
Loss = 7.9189e-02, PNorm = 44.5131, GNorm = 0.6787, lr_0 = 4.1666e-04
Validation rmse = 0.076232
Validation r2 = 0.947037
Validation mse = 0.005811
Epoch 23
Loss = 8.1846e-02, PNorm = 44.5281, GNorm = 0.9202, lr_0 = 4.0719e-04
Loss = 8.5172e-02, PNorm = 44.5403, GNorm = 2.4485, lr_0 = 3.9877e-04
Validation rmse = 0.073519
Validation r2 = 0.950738
Validation mse = 0.005405
Epoch 24
Loss = 8.1266e-02, PNorm = 44.5560, GNorm = 0.9946, lr_0 = 3.9053e-04
Loss = 8.6240e-02, PNorm = 44.5688, GNorm = 2.4466, lr_0 = 3.8245e-04
Validation rmse = 0.108276
Validation r2 = 0.893152
Validation mse = 0.011724
Epoch 25
Loss = 8.9848e-02, PNorm = 44.5826, GNorm = 2.9122, lr_0 = 3.7376e-04
Loss = 8.5385e-02, PNorm = 44.5956, GNorm = 1.6486, lr_0 = 3.6603e-04
Validation rmse = 0.102224
Validation r2 = 0.904762
Validation mse = 0.010450
Epoch 26
Loss = 8.9591e-02, PNorm = 44.6081, GNorm = 0.8824, lr_0 = 3.5772e-04
Loss = 8.1949e-02, PNorm = 44.6208, GNorm = 0.9246, lr_0 = 3.5032e-04
Validation rmse = 0.074850
Validation r2 = 0.948940
Validation mse = 0.005602
Epoch 27
Loss = 8.8170e-02, PNorm = 44.6326, GNorm = 0.7636, lr_0 = 3.4308e-04
Loss = 8.3218e-02, PNorm = 44.6452, GNorm = 0.7636, lr_0 = 3.3598e-04
Loss = 6.1820e-02, PNorm = 44.6465, GNorm = 0.9927, lr_0 = 3.3528e-04
Validation rmse = 0.106161
Validation r2 = 0.897285
Validation mse = 0.011270
Epoch 28
Loss = 7.7742e-02, PNorm = 44.6558, GNorm = 0.7704, lr_0 = 3.2835e-04
Validation rmse = 0.093590
Validation r2 = 0.920170
Validation mse = 0.008759
Epoch 29
Loss = 5.3711e-02, PNorm = 44.6663, GNorm = 2.1055, lr_0 = 3.2089e-04
Loss = 8.3855e-02, PNorm = 44.6765, GNorm = 0.5398, lr_0 = 3.1425e-04
Validation rmse = 0.094026
Validation r2 = 0.919425
Validation mse = 0.008841
Epoch 30
Loss = 6.4113e-02, PNorm = 44.6866, GNorm = 0.7415, lr_0 = 3.0775e-04
Loss = 6.3463e-02, PNorm = 44.6950, GNorm = 0.8451, lr_0 = 3.0139e-04
Validation rmse = 0.088575
Validation r2 = 0.928496
Validation mse = 0.007846
Epoch 31
Loss = 9.7724e-02, PNorm = 44.7042, GNorm = 0.9849, lr_0 = 2.9454e-04
Loss = 6.9276e-02, PNorm = 44.7149, GNorm = 0.8693, lr_0 = 2.8845e-04
Validation rmse = 0.094454
Validation r2 = 0.918690
Validation mse = 0.008922
Epoch 32
Loss = 6.8350e-02, PNorm = 44.7241, GNorm = 0.4582, lr_0 = 2.8190e-04
Loss = 6.9789e-02, PNorm = 44.7332, GNorm = 0.6912, lr_0 = 2.7607e-04
Validation rmse = 0.087016
Validation r2 = 0.930991
Validation mse = 0.007572
Epoch 33
Loss = 7.7656e-02, PNorm = 44.7441, GNorm = 1.8113, lr_0 = 2.6980e-04
Loss = 6.8776e-02, PNorm = 44.7528, GNorm = 1.3863, lr_0 = 2.6422e-04
Validation rmse = 0.110378
Validation r2 = 0.888962
Validation mse = 0.012183
Epoch 34
Loss = 7.0030e-02, PNorm = 44.7603, GNorm = 0.5476, lr_0 = 2.5875e-04
Loss = 7.2418e-02, PNorm = 44.7693, GNorm = 0.9719, lr_0 = 2.5340e-04
Validation rmse = 0.120083
Validation r2 = 0.868578
Validation mse = 0.014420
Epoch 35
Loss = 6.1893e-02, PNorm = 44.7783, GNorm = 0.6091, lr_0 = 2.4764e-04
Loss = 6.2937e-02, PNorm = 44.7863, GNorm = 0.5196, lr_0 = 2.4252e-04
Validation rmse = 0.100722
Validation r2 = 0.907540
Validation mse = 0.010145
Epoch 36
Loss = 6.8614e-02, PNorm = 44.7953, GNorm = 0.5997, lr_0 = 2.3701e-04
Loss = 5.6683e-02, PNorm = 44.8034, GNorm = 1.0402, lr_0 = 2.3211e-04
Validation rmse = 0.080651
Validation r2 = 0.940717
Validation mse = 0.006505
Epoch 37
Loss = 6.1440e-02, PNorm = 44.8124, GNorm = 1.1814, lr_0 = 2.2731e-04
Loss = 7.0040e-02, PNorm = 44.8202, GNorm = 1.1205, lr_0 = 2.2261e-04
Validation rmse = 0.096474
Validation r2 = 0.915175
Validation mse = 0.009307
Epoch 38
Loss = 7.0511e-02, PNorm = 44.8299, GNorm = 1.9358, lr_0 = 2.1755e-04
Loss = 6.0248e-02, PNorm = 44.8376, GNorm = 0.6409, lr_0 = 2.1306e-04
Validation rmse = 0.095771
Validation r2 = 0.916406
Validation mse = 0.009172
Epoch 39
Loss = 6.1323e-02, PNorm = 44.8435, GNorm = 1.9470, lr_0 = 2.0821e-04
Loss = 6.9132e-02, PNorm = 44.8504, GNorm = 1.2860, lr_0 = 2.0391e-04
Validation rmse = 0.096625
Validation r2 = 0.914909
Validation mse = 0.009336
Epoch 40
Loss = 6.7992e-02, PNorm = 44.8565, GNorm = 1.2854, lr_0 = 1.9969e-04
Loss = 6.2083e-02, PNorm = 44.8644, GNorm = 0.9472, lr_0 = 1.9556e-04
Validation rmse = 0.090231
Validation r2 = 0.925797
Validation mse = 0.008142
Epoch 41
Loss = 5.7941e-02, PNorm = 44.8722, GNorm = 1.2214, lr_0 = 1.9112e-04
Loss = 6.4228e-02, PNorm = 44.8801, GNorm = 1.1176, lr_0 = 1.8717e-04
Loss = 5.1436e-02, PNorm = 44.8808, GNorm = 1.2921, lr_0 = 1.8678e-04
Validation rmse = 0.090216
Validation r2 = 0.925823
Validation mse = 0.008139
Epoch 42
Loss = 5.7302e-02, PNorm = 44.8875, GNorm = 1.6492, lr_0 = 1.8292e-04
Validation rmse = 0.115620
Validation r2 = 0.878166
Validation mse = 0.013368
Epoch 43
Loss = 6.5260e-02, PNorm = 44.8946, GNorm = 2.4322, lr_0 = 1.7876e-04
Loss = 6.1351e-02, PNorm = 44.9015, GNorm = 2.1653, lr_0 = 1.7506e-04
Validation rmse = 0.097146
Validation r2 = 0.913989
Validation mse = 0.009437
Epoch 44
Loss = 4.3335e-02, PNorm = 44.9076, GNorm = 1.1096, lr_0 = 1.7144e-04
Loss = 4.9576e-02, PNorm = 44.9124, GNorm = 0.3988, lr_0 = 1.6790e-04
Validation rmse = 0.090848
Validation r2 = 0.924780
Validation mse = 0.008253
Epoch 45
Loss = 4.9119e-02, PNorm = 44.9191, GNorm = 0.7074, lr_0 = 1.6408e-04
Loss = 5.8381e-02, PNorm = 44.9244, GNorm = 1.2711, lr_0 = 1.6069e-04
Validation rmse = 0.096276
Validation r2 = 0.915522
Validation mse = 0.009269
Epoch 46
Loss = 5.8215e-02, PNorm = 44.9311, GNorm = 1.1403, lr_0 = 1.5704e-04
Loss = 6.2716e-02, PNorm = 44.9362, GNorm = 1.2958, lr_0 = 1.5379e-04
Validation rmse = 0.095661
Validation r2 = 0.916599
Validation mse = 0.009151
Epoch 47
Loss = 4.9534e-02, PNorm = 44.9410, GNorm = 2.1289, lr_0 = 1.5061e-04
Loss = 6.4429e-02, PNorm = 44.9462, GNorm = 1.6795, lr_0 = 1.4750e-04
Validation rmse = 0.100596
Validation r2 = 0.907772
Validation mse = 0.010119
Epoch 48
Loss = 6.5443e-02, PNorm = 44.9527, GNorm = 0.7333, lr_0 = 1.4415e-04
Loss = 5.4053e-02, PNorm = 44.9589, GNorm = 1.1155, lr_0 = 1.4117e-04
Validation rmse = 0.091298
Validation r2 = 0.924032
Validation mse = 0.008335
Epoch 49
Loss = 5.8966e-02, PNorm = 44.9650, GNorm = 2.7843, lr_0 = 1.3796e-04
Loss = 5.7382e-02, PNorm = 44.9704, GNorm = 1.0157, lr_0 = 1.3511e-04
Validation rmse = 0.097861
Validation r2 = 0.912717
Validation mse = 0.009577
Epoch 50
Loss = 5.5184e-02, PNorm = 44.9752, GNorm = 0.6512, lr_0 = 1.3231e-04
Loss = 5.6458e-02, PNorm = 44.9798, GNorm = 0.6308, lr_0 = 1.2958e-04
Validation rmse = 0.090168
Validation r2 = 0.925901
Validation mse = 0.008130
Epoch 51
Loss = 6.5207e-02, PNorm = 44.9841, GNorm = 2.7977, lr_0 = 1.2663e-04
Loss = 4.9529e-02, PNorm = 44.9892, GNorm = 0.6805, lr_0 = 1.2401e-04
Validation rmse = 0.106266
Validation r2 = 0.897081
Validation mse = 0.011292
Epoch 52
Loss = 5.4772e-02, PNorm = 44.9937, GNorm = 0.7080, lr_0 = 1.2119e-04
Loss = 5.2964e-02, PNorm = 44.9979, GNorm = 1.0793, lr_0 = 1.1869e-04
Validation rmse = 0.093981
Validation r2 = 0.919502
Validation mse = 0.008832
Epoch 53
Loss = 4.3250e-02, PNorm = 45.0033, GNorm = 0.4916, lr_0 = 1.1599e-04
Loss = 5.6642e-02, PNorm = 45.0068, GNorm = 0.9779, lr_0 = 1.1359e-04
Validation rmse = 0.090542
Validation r2 = 0.925285
Validation mse = 0.008198
Epoch 54
Loss = 4.6497e-02, PNorm = 45.0114, GNorm = 0.8436, lr_0 = 1.1124e-04
Loss = 5.1384e-02, PNorm = 45.0149, GNorm = 0.6350, lr_0 = 1.0894e-04
Validation rmse = 0.097567
Validation r2 = 0.913242
Validation mse = 0.009519
Epoch 55
Loss = 4.8183e-02, PNorm = 45.0190, GNorm = 0.6361, lr_0 = 1.0647e-04
Loss = 4.8681e-02, PNorm = 45.0231, GNorm = 1.1248, lr_0 = 1.0427e-04
Loss = 9.9577e-02, PNorm = 45.0235, GNorm = 1.3637, lr_0 = 1.0405e-04
Validation rmse = 0.100271
Validation r2 = 0.908366
Validation mse = 0.010054
Epoch 56
Loss = 4.5185e-02, PNorm = 45.0276, GNorm = 1.0484, lr_0 = 1.0190e-04
Loss = 5.1415e-02, PNorm = 45.0316, GNorm = 1.1441, lr_0 = 1.0000e-04
Validation rmse = 0.099348
Validation r2 = 0.910046
Validation mse = 0.009870
Epoch 57
Loss = 5.1139e-02, PNorm = 45.0347, GNorm = 0.5653, lr_0 = 1.0000e-04
Validation rmse = 0.091897
Validation r2 = 0.923032
Validation mse = 0.008445
Epoch 58
Loss = 4.8260e-02, PNorm = 45.0391, GNorm = 0.5772, lr_0 = 1.0000e-04
Loss = 4.9870e-02, PNorm = 45.0426, GNorm = 0.7389, lr_0 = 1.0000e-04
Validation rmse = 0.101597
Validation r2 = 0.905927
Validation mse = 0.010322
Epoch 59
Loss = 4.9436e-02, PNorm = 45.0477, GNorm = 1.7739, lr_0 = 1.0000e-04
Loss = 4.6993e-02, PNorm = 45.0518, GNorm = 0.7258, lr_0 = 1.0000e-04
Validation rmse = 0.100777
Validation r2 = 0.907439
Validation mse = 0.010156
Model 0 best validation rmse = 0.073519 on epoch 23
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.174056
Model 0 test r2 = 0.724672
Model 0 test mse = 0.030296
Ensemble test rmse = 0.174056
Ensemble test r2 = 0.724672
Ensemble test mse = 0.030296
Fold 9
Splitting data with seed 9
Total size = 975 | train size = 965 | val size = 10 | test size = 57
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.7105e-01, PNorm = 43.2612, GNorm = 2.4566, lr_0 = 3.6053e-04
Validation rmse = 0.169029
Validation r2 = 0.647560
Validation mse = 0.028571
Epoch 1
Loss = 4.6231e-01, PNorm = 43.2926, GNorm = 9.1092, lr_0 = 6.2105e-04
Loss = 7.4700e-01, PNorm = 43.3289, GNorm = 3.4171, lr_0 = 8.5789e-04
Validation rmse = 0.214237
Validation r2 = 0.433824
Validation mse = 0.045897
Epoch 2
Loss = 7.9461e-01, PNorm = 43.4087, GNorm = 7.8888, lr_0 = 9.8961e-04
Loss = 5.5062e-01, PNorm = 43.4779, GNorm = 6.4267, lr_0 = 9.6914e-04
Validation rmse = 0.273139
Validation r2 = 0.079694
Validation mse = 0.074605
Epoch 3
Loss = 5.9080e-01, PNorm = 43.5605, GNorm = 3.6081, lr_0 = 9.4712e-04
Loss = 3.6517e-01, PNorm = 43.6291, GNorm = 2.1698, lr_0 = 9.2754e-04
Validation rmse = 0.127757
Validation r2 = 0.798660
Validation mse = 0.016322
Epoch 4
Loss = 3.1381e-01, PNorm = 43.6909, GNorm = 2.1853, lr_0 = 9.0836e-04
Loss = 2.3743e-01, PNorm = 43.7517, GNorm = 1.5732, lr_0 = 8.8958e-04
Validation rmse = 0.113967
Validation r2 = 0.839778
Validation mse = 0.012988
Epoch 5
Loss = 2.7727e-01, PNorm = 43.8068, GNorm = 1.1952, lr_0 = 8.6936e-04
Loss = 1.7448e-01, PNorm = 43.8496, GNorm = 3.5848, lr_0 = 8.5139e-04
Validation rmse = 0.100340
Validation r2 = 0.875802
Validation mse = 0.010068
Epoch 6
Loss = 1.4427e-01, PNorm = 43.8886, GNorm = 0.8455, lr_0 = 8.3204e-04
Loss = 1.8517e-01, PNorm = 43.9241, GNorm = 5.7485, lr_0 = 8.1484e-04
Validation rmse = 0.139979
Validation r2 = 0.758293
Validation mse = 0.019594
Epoch 7
Loss = 2.1086e-01, PNorm = 43.9567, GNorm = 1.4914, lr_0 = 7.9799e-04
Loss = 2.0764e-01, PNorm = 43.9944, GNorm = 3.3734, lr_0 = 7.8149e-04
Validation rmse = 0.112637
Validation r2 = 0.843497
Validation mse = 0.012687
Epoch 8
Loss = 1.2870e-01, PNorm = 44.0338, GNorm = 1.2287, lr_0 = 7.6373e-04
Loss = 1.6868e-01, PNorm = 44.0549, GNorm = 1.7666, lr_0 = 7.4794e-04
Validation rmse = 0.080257
Validation r2 = 0.920543
Validation mse = 0.006441
Epoch 9
Loss = 1.2795e-01, PNorm = 44.0819, GNorm = 3.2720, lr_0 = 7.3094e-04
Loss = 1.4880e-01, PNorm = 44.1037, GNorm = 3.5133, lr_0 = 7.1583e-04
Validation rmse = 0.093822
Validation r2 = 0.891414
Validation mse = 0.008803
Epoch 10
Loss = 1.4743e-01, PNorm = 44.1272, GNorm = 6.0249, lr_0 = 7.0103e-04
Loss = 1.3976e-01, PNorm = 44.1522, GNorm = 5.0733, lr_0 = 6.8653e-04
Validation rmse = 0.136235
Validation r2 = 0.771049
Validation mse = 0.018560
Epoch 11
Loss = 1.2414e-01, PNorm = 44.1812, GNorm = 1.5233, lr_0 = 6.7093e-04
Loss = 1.2937e-01, PNorm = 44.2040, GNorm = 2.3675, lr_0 = 6.5706e-04
Validation rmse = 0.122471
Validation r2 = 0.814975
Validation mse = 0.014999
Epoch 12
Loss = 1.4750e-01, PNorm = 44.2280, GNorm = 3.0623, lr_0 = 6.4213e-04
Loss = 1.3055e-01, PNorm = 44.2469, GNorm = 0.8124, lr_0 = 6.2885e-04
Loss = 8.3264e-02, PNorm = 44.2485, GNorm = 2.0289, lr_0 = 6.2754e-04
Validation rmse = 0.105558
Validation r2 = 0.862550
Validation mse = 0.011142
Epoch 13
Loss = 1.1646e-01, PNorm = 44.2709, GNorm = 1.8631, lr_0 = 6.1456e-04
Loss = 1.2241e-01, PNorm = 44.2812, GNorm = 2.6458, lr_0 = 6.0185e-04
Validation rmse = 0.105860
Validation r2 = 0.861761
Validation mse = 0.011206
Epoch 14
Loss = 1.2400e-01, PNorm = 44.2950, GNorm = 0.7832, lr_0 = 5.8941e-04
Validation rmse = 0.086582
Validation r2 = 0.907527
Validation mse = 0.007496
Epoch 15
Loss = 8.9848e-02, PNorm = 44.3119, GNorm = 1.0836, lr_0 = 5.7602e-04
Loss = 1.2304e-01, PNorm = 44.3275, GNorm = 1.4734, lr_0 = 5.6411e-04
Validation rmse = 0.084805
Validation r2 = 0.911282
Validation mse = 0.007192
Epoch 16
Loss = 1.3183e-01, PNorm = 44.3476, GNorm = 1.4115, lr_0 = 5.5129e-04
Loss = 1.1722e-01, PNorm = 44.3651, GNorm = 1.9376, lr_0 = 5.3989e-04
Validation rmse = 0.077006
Validation r2 = 0.926850
Validation mse = 0.005930
Epoch 17
Loss = 7.0245e-02, PNorm = 44.3823, GNorm = 0.9999, lr_0 = 5.2873e-04
Loss = 9.5427e-02, PNorm = 44.3944, GNorm = 1.4880, lr_0 = 5.1779e-04
Validation rmse = 0.116728
Validation r2 = 0.831921
Validation mse = 0.013625
Epoch 18
Loss = 1.1196e-01, PNorm = 44.4098, GNorm = 1.9927, lr_0 = 5.0603e-04
Loss = 1.1358e-01, PNorm = 44.4249, GNorm = 1.9421, lr_0 = 4.9556e-04
Validation rmse = 0.075657
Validation r2 = 0.929392
Validation mse = 0.005724
Epoch 19
Loss = 1.2315e-01, PNorm = 44.4345, GNorm = 2.1148, lr_0 = 4.8430e-04
Loss = 1.0855e-01, PNorm = 44.4476, GNorm = 1.1563, lr_0 = 4.7429e-04
Validation rmse = 0.099792
Validation r2 = 0.877155
Validation mse = 0.009959
Epoch 20
Loss = 1.1324e-01, PNorm = 44.4625, GNorm = 2.3800, lr_0 = 4.6448e-04
Loss = 8.1743e-02, PNorm = 44.4757, GNorm = 1.1742, lr_0 = 4.5488e-04
Validation rmse = 0.100299
Validation r2 = 0.875904
Validation mse = 0.010060
Epoch 21
Loss = 7.7214e-02, PNorm = 44.4885, GNorm = 0.6654, lr_0 = 4.4454e-04
Loss = 9.8481e-02, PNorm = 44.4991, GNorm = 2.2634, lr_0 = 4.3535e-04
Validation rmse = 0.078359
Validation r2 = 0.924258
Validation mse = 0.006140
Epoch 22
Loss = 7.9820e-02, PNorm = 44.5137, GNorm = 1.8583, lr_0 = 4.2546e-04
Loss = 9.6757e-02, PNorm = 44.5241, GNorm = 0.8807, lr_0 = 4.1666e-04
Validation rmse = 0.084031
Validation r2 = 0.912896
Validation mse = 0.007061
Epoch 23
Loss = 7.4066e-02, PNorm = 44.5329, GNorm = 0.6622, lr_0 = 4.0719e-04
Loss = 9.4141e-02, PNorm = 44.5437, GNorm = 0.9028, lr_0 = 3.9877e-04
Validation rmse = 0.094390
Validation r2 = 0.890095
Validation mse = 0.008910
Epoch 24
Loss = 7.9408e-02, PNorm = 44.5560, GNorm = 2.3802, lr_0 = 3.9053e-04
Loss = 1.0018e-01, PNorm = 44.5633, GNorm = 1.4001, lr_0 = 3.8245e-04
Validation rmse = 0.071366
Validation r2 = 0.937173
Validation mse = 0.005093
Epoch 25
Loss = 8.3211e-02, PNorm = 44.5742, GNorm = 1.6678, lr_0 = 3.7376e-04
Loss = 9.0975e-02, PNorm = 44.5849, GNorm = 0.9144, lr_0 = 3.6603e-04
Validation rmse = 0.083870
Validation r2 = 0.913230
Validation mse = 0.007034
Epoch 26
Loss = 9.6454e-02, PNorm = 44.5961, GNorm = 1.0642, lr_0 = 3.5772e-04
Loss = 8.6821e-02, PNorm = 44.6057, GNorm = 0.7777, lr_0 = 3.5032e-04
Validation rmse = 0.081204
Validation r2 = 0.918658
Validation mse = 0.006594
Epoch 27
Loss = 9.0394e-02, PNorm = 44.6174, GNorm = 1.5560, lr_0 = 3.4308e-04
Loss = 8.2366e-02, PNorm = 44.6279, GNorm = 1.3714, lr_0 = 3.3598e-04
Loss = 6.8825e-02, PNorm = 44.6288, GNorm = 1.8497, lr_0 = 3.3528e-04
Validation rmse = 0.097282
Validation r2 = 0.883258
Validation mse = 0.009464
Epoch 28
Loss = 8.5686e-02, PNorm = 44.6402, GNorm = 2.5507, lr_0 = 3.2835e-04
Validation rmse = 0.086911
Validation r2 = 0.906822
Validation mse = 0.007554
Epoch 29
Loss = 8.6183e-02, PNorm = 44.6517, GNorm = 1.7318, lr_0 = 3.2089e-04
Loss = 8.2466e-02, PNorm = 44.6604, GNorm = 1.2196, lr_0 = 3.1425e-04
Validation rmse = 0.084739
Validation r2 = 0.911422
Validation mse = 0.007181
Epoch 30
Loss = 7.3813e-02, PNorm = 44.6686, GNorm = 0.7267, lr_0 = 3.0775e-04
Loss = 6.6327e-02, PNorm = 44.6753, GNorm = 1.6297, lr_0 = 3.0139e-04
Validation rmse = 0.084155
Validation r2 = 0.912637
Validation mse = 0.007082
Epoch 31
Loss = 5.9509e-02, PNorm = 44.6824, GNorm = 0.5844, lr_0 = 2.9454e-04
Loss = 7.4531e-02, PNorm = 44.6888, GNorm = 1.2608, lr_0 = 2.8845e-04
Validation rmse = 0.080233
Validation r2 = 0.920591
Validation mse = 0.006437
Epoch 32
Loss = 6.3024e-02, PNorm = 44.6982, GNorm = 1.0051, lr_0 = 2.8190e-04
Loss = 7.7911e-02, PNorm = 44.7054, GNorm = 0.7476, lr_0 = 2.7607e-04
Validation rmse = 0.074130
Validation r2 = 0.932212
Validation mse = 0.005495
Epoch 33
Loss = 7.2306e-02, PNorm = 44.7135, GNorm = 0.8385, lr_0 = 2.6980e-04
Loss = 7.4238e-02, PNorm = 44.7229, GNorm = 1.8099, lr_0 = 2.6422e-04
Validation rmse = 0.088719
Validation r2 = 0.902905
Validation mse = 0.007871
Epoch 34
Loss = 9.0423e-02, PNorm = 44.7303, GNorm = 1.4317, lr_0 = 2.5875e-04
Loss = 7.3775e-02, PNorm = 44.7376, GNorm = 0.6695, lr_0 = 2.5340e-04
Validation rmse = 0.079326
Validation r2 = 0.922377
Validation mse = 0.006293
Epoch 35
Loss = 7.0979e-02, PNorm = 44.7454, GNorm = 1.6283, lr_0 = 2.4764e-04
Loss = 7.0263e-02, PNorm = 44.7522, GNorm = 0.7500, lr_0 = 2.4252e-04
Validation rmse = 0.094634
Validation r2 = 0.889526
Validation mse = 0.008956
Epoch 36
Loss = 6.6726e-02, PNorm = 44.7605, GNorm = 0.9197, lr_0 = 2.3701e-04
Loss = 6.7180e-02, PNorm = 44.7666, GNorm = 0.5581, lr_0 = 2.3211e-04
Validation rmse = 0.071130
Validation r2 = 0.937589
Validation mse = 0.005059
Epoch 37
Loss = 5.8892e-02, PNorm = 44.7727, GNorm = 0.6467, lr_0 = 2.2731e-04
Loss = 6.5222e-02, PNorm = 44.7787, GNorm = 2.0384, lr_0 = 2.2261e-04
Validation rmse = 0.077318
Validation r2 = 0.926257
Validation mse = 0.005978
Epoch 38
Loss = 6.6140e-02, PNorm = 44.7875, GNorm = 1.6202, lr_0 = 2.1755e-04
Loss = 6.6039e-02, PNorm = 44.7939, GNorm = 1.4781, lr_0 = 2.1306e-04
Validation rmse = 0.071588
Validation r2 = 0.936781
Validation mse = 0.005125
Epoch 39
Loss = 6.0045e-02, PNorm = 44.7997, GNorm = 0.5657, lr_0 = 2.0821e-04
Loss = 6.9063e-02, PNorm = 44.8065, GNorm = 0.7660, lr_0 = 2.0391e-04
Validation rmse = 0.071143
Validation r2 = 0.937566
Validation mse = 0.005061
Epoch 40
Loss = 5.9066e-02, PNorm = 44.8122, GNorm = 0.4644, lr_0 = 1.9969e-04
Loss = 6.7706e-02, PNorm = 44.8178, GNorm = 0.5295, lr_0 = 1.9556e-04
Validation rmse = 0.070254
Validation r2 = 0.939116
Validation mse = 0.004936
Epoch 41
Loss = 6.7126e-02, PNorm = 44.8284, GNorm = 2.3795, lr_0 = 1.9112e-04
Loss = 7.3412e-02, PNorm = 44.8352, GNorm = 1.3538, lr_0 = 1.8717e-04
Loss = 8.1775e-02, PNorm = 44.8358, GNorm = 2.9241, lr_0 = 1.8678e-04
Validation rmse = 0.084521
Validation r2 = 0.911876
Validation mse = 0.007144
Epoch 42
Loss = 6.0057e-02, PNorm = 44.8424, GNorm = 0.4006, lr_0 = 1.8292e-04
Validation rmse = 0.071929
Validation r2 = 0.936178
Validation mse = 0.005174
Epoch 43
Loss = 1.1530e-01, PNorm = 44.8494, GNorm = 2.2012, lr_0 = 1.7876e-04
Loss = 4.9774e-02, PNorm = 44.8544, GNorm = 1.4425, lr_0 = 1.7506e-04
Validation rmse = 0.083304
Validation r2 = 0.914396
Validation mse = 0.006940
Epoch 44
Loss = 3.9621e-02, PNorm = 44.8604, GNorm = 0.3455, lr_0 = 1.7144e-04
Loss = 6.2522e-02, PNorm = 44.8668, GNorm = 0.8054, lr_0 = 1.6790e-04
Validation rmse = 0.077148
Validation r2 = 0.926581
Validation mse = 0.005952
Epoch 45
Loss = 6.4166e-02, PNorm = 44.8723, GNorm = 1.5513, lr_0 = 1.6408e-04
Loss = 5.6489e-02, PNorm = 44.8767, GNorm = 1.5543, lr_0 = 1.6069e-04
Validation rmse = 0.065379
Validation r2 = 0.947272
Validation mse = 0.004274
Epoch 46
Loss = 5.0937e-02, PNorm = 44.8831, GNorm = 0.9134, lr_0 = 1.5704e-04
Loss = 6.2680e-02, PNorm = 44.8876, GNorm = 0.9784, lr_0 = 1.5379e-04
Validation rmse = 0.080658
Validation r2 = 0.919748
Validation mse = 0.006506
Epoch 47
Loss = 6.8799e-02, PNorm = 44.8927, GNorm = 0.5418, lr_0 = 1.5061e-04
Loss = 6.2625e-02, PNorm = 44.8982, GNorm = 1.7527, lr_0 = 1.4750e-04
Validation rmse = 0.067199
Validation r2 = 0.944295
Validation mse = 0.004516
Epoch 48
Loss = 5.7888e-02, PNorm = 44.9045, GNorm = 0.7597, lr_0 = 1.4415e-04
Loss = 5.4044e-02, PNorm = 44.9086, GNorm = 0.3994, lr_0 = 1.4117e-04
Validation rmse = 0.085530
Validation r2 = 0.909760
Validation mse = 0.007315
Epoch 49
Loss = 5.6609e-02, PNorm = 44.9141, GNorm = 0.9460, lr_0 = 1.3796e-04
Loss = 6.5571e-02, PNorm = 44.9178, GNorm = 0.8192, lr_0 = 1.3511e-04
Validation rmse = 0.072025
Validation r2 = 0.936007
Validation mse = 0.005188
Epoch 50
Loss = 5.1692e-02, PNorm = 44.9221, GNorm = 1.6185, lr_0 = 1.3231e-04
Loss = 6.2386e-02, PNorm = 44.9266, GNorm = 0.8394, lr_0 = 1.2958e-04
Validation rmse = 0.082865
Validation r2 = 0.915295
Validation mse = 0.006867
Epoch 51
Loss = 5.3114e-02, PNorm = 44.9322, GNorm = 1.2470, lr_0 = 1.2663e-04
Loss = 5.4518e-02, PNorm = 44.9364, GNorm = 0.5999, lr_0 = 1.2401e-04
Validation rmse = 0.076051
Validation r2 = 0.928654
Validation mse = 0.005784
Epoch 52
Loss = 4.7940e-02, PNorm = 44.9404, GNorm = 0.9616, lr_0 = 1.2119e-04
Loss = 6.1204e-02, PNorm = 44.9441, GNorm = 0.4004, lr_0 = 1.1869e-04
Validation rmse = 0.095087
Validation r2 = 0.888467
Validation mse = 0.009041
Epoch 53
Loss = 4.5294e-02, PNorm = 44.9480, GNorm = 0.3791, lr_0 = 1.1599e-04
Loss = 6.4713e-02, PNorm = 44.9510, GNorm = 0.9142, lr_0 = 1.1359e-04
Validation rmse = 0.083793
Validation r2 = 0.913388
Validation mse = 0.007021
Epoch 54
Loss = 5.3522e-02, PNorm = 44.9549, GNorm = 0.5125, lr_0 = 1.1124e-04
Loss = 5.2074e-02, PNorm = 44.9593, GNorm = 0.6572, lr_0 = 1.0894e-04
Validation rmse = 0.072660
Validation r2 = 0.934873
Validation mse = 0.005280
Epoch 55
Loss = 5.3141e-02, PNorm = 44.9634, GNorm = 0.9621, lr_0 = 1.0647e-04
Loss = 5.0820e-02, PNorm = 44.9673, GNorm = 1.2041, lr_0 = 1.0427e-04
Loss = 2.6132e-02, PNorm = 44.9676, GNorm = 0.8667, lr_0 = 1.0405e-04
Validation rmse = 0.076350
Validation r2 = 0.928091
Validation mse = 0.005829
Epoch 56
Loss = 5.2896e-02, PNorm = 44.9711, GNorm = 0.6960, lr_0 = 1.0190e-04
Loss = 4.9327e-02, PNorm = 44.9736, GNorm = 0.7389, lr_0 = 1.0000e-04
Validation rmse = 0.083894
Validation r2 = 0.913180
Validation mse = 0.007038
Epoch 57
Loss = 5.3288e-02, PNorm = 44.9776, GNorm = 0.7908, lr_0 = 1.0000e-04
Validation rmse = 0.072789
Validation r2 = 0.934643
Validation mse = 0.005298
Epoch 58
Loss = 3.7959e-02, PNorm = 44.9813, GNorm = 0.5894, lr_0 = 1.0000e-04
Loss = 4.6333e-02, PNorm = 44.9843, GNorm = 1.1148, lr_0 = 1.0000e-04
Validation rmse = 0.084198
Validation r2 = 0.912548
Validation mse = 0.007089
Epoch 59
Loss = 4.9523e-02, PNorm = 44.9878, GNorm = 0.7956, lr_0 = 1.0000e-04
Loss = 5.6151e-02, PNorm = 44.9917, GNorm = 0.7026, lr_0 = 1.0000e-04
Validation rmse = 0.076981
Validation r2 = 0.926899
Validation mse = 0.005926
Model 0 best validation rmse = 0.065379 on epoch 45
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.165008
Model 0 test r2 = 0.752554
Model 0 test mse = 0.027228
Ensemble test rmse = 0.165008
Ensemble test r2 = 0.752554
Ensemble test mse = 0.027228
10-fold cross validation
	Seed 0 ==> test rmse = 0.161798
	Seed 0 ==> test r2 = 0.762087
	Seed 0 ==> test mse = 0.026179
	Seed 1 ==> test rmse = 0.200275
	Seed 1 ==> test r2 = 0.635477
	Seed 1 ==> test mse = 0.040110
	Seed 2 ==> test rmse = 0.180687
	Seed 2 ==> test r2 = 0.703295
	Seed 2 ==> test mse = 0.032648
	Seed 3 ==> test rmse = 0.173839
	Seed 3 ==> test r2 = 0.725359
	Seed 3 ==> test mse = 0.030220
	Seed 4 ==> test rmse = 0.170664
	Seed 4 ==> test r2 = 0.735299
	Seed 4 ==> test mse = 0.029126
	Seed 5 ==> test rmse = 0.166072
	Seed 5 ==> test r2 = 0.749352
	Seed 5 ==> test mse = 0.027580
	Seed 6 ==> test rmse = 0.202910
	Seed 6 ==> test r2 = 0.625822
	Seed 6 ==> test mse = 0.041173
	Seed 7 ==> test rmse = 0.194087
	Seed 7 ==> test r2 = 0.657654
	Seed 7 ==> test mse = 0.037670
	Seed 8 ==> test rmse = 0.174056
	Seed 8 ==> test r2 = 0.724672
	Seed 8 ==> test mse = 0.030296
	Seed 9 ==> test rmse = 0.165008
	Seed 9 ==> test r2 = 0.752554
	Seed 9 ==> test mse = 0.027228
Overall test rmse = 0.178940 +/- 0.014262
Overall test r2 = 0.707157 +/- 0.047442
Overall test mse = 0.032223 +/- 0.005220
Elapsed time = 0:07:33
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-05d85262-3219-459a-86b2-5360cba4da72.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/Tol_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2', 'mse'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2', 'mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/Tol_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/Tol_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 984 | train size = 974 | val size = 10 | test size = 48
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 8.6050e-01, PNorm = 43.2664, GNorm = 1.5742, lr_0 = 3.6053e-04
Validation rmse = 0.265278
Validation r2 = 0.258180
Validation mse = 0.070372
Epoch 1
Loss = 6.8094e-01, PNorm = 43.2916, GNorm = 8.7570, lr_0 = 6.2105e-04
Loss = 7.1686e-01, PNorm = 43.3267, GNorm = 5.3634, lr_0 = 8.5789e-04
Validation rmse = 0.255325
Validation r2 = 0.312798
Validation mse = 0.065191
Epoch 2
Loss = 5.3669e-01, PNorm = 43.3998, GNorm = 1.7678, lr_0 = 9.8961e-04
Loss = 3.8935e-01, PNorm = 43.4646, GNorm = 2.3614, lr_0 = 9.6914e-04
Validation rmse = 0.221152
Validation r2 = 0.484439
Validation mse = 0.048908
Epoch 3
Loss = 2.7739e-01, PNorm = 43.5277, GNorm = 1.5475, lr_0 = 9.4910e-04
Loss = 2.7876e-01, PNorm = 43.5811, GNorm = 2.3156, lr_0 = 9.2948e-04
Validation rmse = 0.156545
Validation r2 = 0.741670
Validation mse = 0.024506
Epoch 4
Loss = 3.3260e-01, PNorm = 43.6254, GNorm = 5.3794, lr_0 = 9.0836e-04
Loss = 2.3133e-01, PNorm = 43.6722, GNorm = 1.6928, lr_0 = 8.8958e-04
Validation rmse = 0.157497
Validation r2 = 0.738518
Validation mse = 0.024805
Epoch 5
Loss = 2.4472e-01, PNorm = 43.7130, GNorm = 7.2312, lr_0 = 8.7118e-04
Loss = 2.0617e-01, PNorm = 43.7529, GNorm = 3.7870, lr_0 = 8.5317e-04
Validation rmse = 0.149938
Validation r2 = 0.763016
Validation mse = 0.022481
Epoch 6
Loss = 1.6305e-01, PNorm = 43.7787, GNorm = 0.7738, lr_0 = 8.3378e-04
Loss = 1.9416e-01, PNorm = 43.8092, GNorm = 2.5754, lr_0 = 8.1654e-04
Validation rmse = 0.142862
Validation r2 = 0.784856
Validation mse = 0.020409
Epoch 7
Loss = 1.4317e-01, PNorm = 43.8356, GNorm = 3.1363, lr_0 = 7.9966e-04
Loss = 1.5358e-01, PNorm = 43.8574, GNorm = 1.3063, lr_0 = 7.8312e-04
Validation rmse = 0.128086
Validation r2 = 0.827058
Validation mse = 0.016406
Epoch 8
Loss = 1.3422e-01, PNorm = 43.8816, GNorm = 1.4217, lr_0 = 7.6533e-04
Loss = 1.3477e-01, PNorm = 43.9072, GNorm = 4.5695, lr_0 = 7.4950e-04
Validation rmse = 0.214519
Validation r2 = 0.514901
Validation mse = 0.046019
Epoch 9
Loss = 1.9042e-01, PNorm = 43.9313, GNorm = 5.7138, lr_0 = 7.3400e-04
Loss = 1.4720e-01, PNorm = 43.9635, GNorm = 5.2239, lr_0 = 7.1883e-04
Validation rmse = 0.143645
Validation r2 = 0.782490
Validation mse = 0.020634
Epoch 10
Loss = 1.7697e-01, PNorm = 43.9936, GNorm = 2.1480, lr_0 = 7.0249e-04
Loss = 1.3443e-01, PNorm = 44.0211, GNorm = 2.7344, lr_0 = 6.8797e-04
Validation rmse = 0.139627
Validation r2 = 0.794489
Validation mse = 0.019496
Epoch 11
Loss = 1.4842e-01, PNorm = 44.0425, GNorm = 0.8478, lr_0 = 6.7374e-04
Loss = 1.3618e-01, PNorm = 44.0628, GNorm = 2.5562, lr_0 = 6.5981e-04
Validation rmse = 0.117893
Validation r2 = 0.853488
Validation mse = 0.013899
Epoch 12
Loss = 9.6698e-02, PNorm = 44.0912, GNorm = 0.9780, lr_0 = 6.4482e-04
Loss = 1.2243e-01, PNorm = 44.1089, GNorm = 2.9578, lr_0 = 6.3148e-04
Validation rmse = 0.111663
Validation r2 = 0.868564
Validation mse = 0.012469
Epoch 13
Loss = 1.1502e-01, PNorm = 44.1231, GNorm = 1.6870, lr_0 = 6.1843e-04
Loss = 1.0768e-01, PNorm = 44.1391, GNorm = 2.0280, lr_0 = 6.0564e-04
Validation rmse = 0.122517
Validation r2 = 0.841771
Validation mse = 0.015010
Epoch 14
Loss = 1.1226e-01, PNorm = 44.1588, GNorm = 0.7980, lr_0 = 5.9188e-04
Loss = 1.1385e-01, PNorm = 44.1796, GNorm = 1.3947, lr_0 = 5.7964e-04
Validation rmse = 0.144136
Validation r2 = 0.781002
Validation mse = 0.020775
Epoch 15
Loss = 1.0652e-01, PNorm = 44.1981, GNorm = 1.2197, lr_0 = 5.6765e-04
Loss = 1.0741e-01, PNorm = 44.2153, GNorm = 1.5860, lr_0 = 5.5592e-04
Validation rmse = 0.107799
Validation r2 = 0.877502
Validation mse = 0.011621
Epoch 16
Loss = 9.8630e-02, PNorm = 44.2277, GNorm = 0.8089, lr_0 = 5.4328e-04
Loss = 1.1412e-01, PNorm = 44.2416, GNorm = 0.7896, lr_0 = 5.3205e-04
Validation rmse = 0.113848
Validation r2 = 0.863370
Validation mse = 0.012961
Epoch 17
Loss = 1.0451e-01, PNorm = 44.2579, GNorm = 2.4996, lr_0 = 5.2105e-04
Loss = 1.1624e-01, PNorm = 44.2761, GNorm = 2.0598, lr_0 = 5.1027e-04
Loss = 8.3456e-02, PNorm = 44.2780, GNorm = 2.8518, lr_0 = 5.0921e-04
Validation rmse = 0.114494
Validation r2 = 0.861815
Validation mse = 0.013109
Epoch 18
Loss = 1.2478e-01, PNorm = 44.2922, GNorm = 3.6438, lr_0 = 4.9868e-04
Loss = 1.4258e-01, PNorm = 44.3070, GNorm = 4.9046, lr_0 = 4.8837e-04
Validation rmse = 0.136183
Validation r2 = 0.804501
Validation mse = 0.018546
Epoch 19
Loss = 1.3978e-01, PNorm = 44.3301, GNorm = 1.1131, lr_0 = 4.7827e-04
Validation rmse = 0.129204
Validation r2 = 0.824026
Validation mse = 0.016694
Epoch 20
Loss = 1.4704e-01, PNorm = 44.3518, GNorm = 1.3078, lr_0 = 4.6740e-04
Loss = 1.0594e-01, PNorm = 44.3712, GNorm = 0.6459, lr_0 = 4.5774e-04
Validation rmse = 0.125896
Validation r2 = 0.832922
Validation mse = 0.015850
Epoch 21
Loss = 1.2753e-01, PNorm = 44.3876, GNorm = 2.9836, lr_0 = 4.4827e-04
Loss = 9.8667e-02, PNorm = 44.4025, GNorm = 0.4409, lr_0 = 4.3900e-04
Validation rmse = 0.110622
Validation r2 = 0.871002
Validation mse = 0.012237
Epoch 22
Loss = 9.7586e-02, PNorm = 44.4137, GNorm = 1.1393, lr_0 = 4.2903e-04
Loss = 9.2287e-02, PNorm = 44.4256, GNorm = 1.9224, lr_0 = 4.2016e-04
Validation rmse = 0.110528
Validation r2 = 0.871221
Validation mse = 0.012216
Epoch 23
Loss = 1.1036e-01, PNorm = 44.4332, GNorm = 1.1421, lr_0 = 4.1147e-04
Loss = 9.1391e-02, PNorm = 44.4470, GNorm = 2.1019, lr_0 = 4.0296e-04
Validation rmse = 0.109720
Validation r2 = 0.873099
Validation mse = 0.012038
Epoch 24
Loss = 9.8487e-02, PNorm = 44.4615, GNorm = 1.7504, lr_0 = 3.9381e-04
Loss = 8.3005e-02, PNorm = 44.4711, GNorm = 0.7729, lr_0 = 3.8566e-04
Validation rmse = 0.097479
Validation r2 = 0.899834
Validation mse = 0.009502
Epoch 25
Loss = 8.4688e-02, PNorm = 44.4822, GNorm = 1.5853, lr_0 = 3.7769e-04
Loss = 1.0036e-01, PNorm = 44.4937, GNorm = 0.9047, lr_0 = 3.6988e-04
Validation rmse = 0.105711
Validation r2 = 0.882203
Validation mse = 0.011175
Epoch 26
Loss = 7.4636e-02, PNorm = 44.5037, GNorm = 1.4431, lr_0 = 3.6147e-04
Loss = 9.0827e-02, PNorm = 44.5159, GNorm = 0.6055, lr_0 = 3.5400e-04
Validation rmse = 0.117295
Validation r2 = 0.854972
Validation mse = 0.013758
Epoch 27
Loss = 1.1365e-01, PNorm = 44.5289, GNorm = 2.1819, lr_0 = 3.4596e-04
Loss = 9.1054e-02, PNorm = 44.5437, GNorm = 0.7349, lr_0 = 3.3880e-04
Validation rmse = 0.099716
Validation r2 = 0.895184
Validation mse = 0.009943
Epoch 28
Loss = 8.1083e-02, PNorm = 44.5547, GNorm = 2.2600, lr_0 = 3.3180e-04
Loss = 9.3811e-02, PNorm = 44.5625, GNorm = 1.8357, lr_0 = 3.2494e-04
Validation rmse = 0.111879
Validation r2 = 0.868054
Validation mse = 0.012517
Epoch 29
Loss = 8.0105e-02, PNorm = 44.5729, GNorm = 0.6770, lr_0 = 3.1755e-04
Loss = 7.5703e-02, PNorm = 44.5808, GNorm = 0.6728, lr_0 = 3.1099e-04
Validation rmse = 0.097205
Validation r2 = 0.900396
Validation mse = 0.009449
Epoch 30
Loss = 8.3851e-02, PNorm = 44.5926, GNorm = 1.6002, lr_0 = 3.0456e-04
Loss = 8.2883e-02, PNorm = 44.6020, GNorm = 1.4377, lr_0 = 2.9826e-04
Validation rmse = 0.095737
Validation r2 = 0.903383
Validation mse = 0.009166
Epoch 31
Loss = 7.2375e-02, PNorm = 44.6121, GNorm = 0.7294, lr_0 = 2.9148e-04
Loss = 8.5651e-02, PNorm = 44.6206, GNorm = 0.6234, lr_0 = 2.8545e-04
Validation rmse = 0.095185
Validation r2 = 0.904492
Validation mse = 0.009060
Epoch 32
Loss = 7.7732e-02, PNorm = 44.6286, GNorm = 0.5600, lr_0 = 2.7955e-04
Loss = 7.8070e-02, PNorm = 44.6394, GNorm = 0.9435, lr_0 = 2.7377e-04
Validation rmse = 0.099611
Validation r2 = 0.895405
Validation mse = 0.009922
Epoch 33
Loss = 7.7438e-02, PNorm = 44.6483, GNorm = 0.9452, lr_0 = 2.6755e-04
Loss = 6.6332e-02, PNorm = 44.6558, GNorm = 0.3633, lr_0 = 2.6202e-04
Validation rmse = 0.090991
Validation r2 = 0.912724
Validation mse = 0.008279
Epoch 34
Loss = 8.5157e-02, PNorm = 44.6632, GNorm = 1.1808, lr_0 = 2.5660e-04
Loss = 6.0524e-02, PNorm = 44.6708, GNorm = 0.7946, lr_0 = 2.5129e-04
Validation rmse = 0.099250
Validation r2 = 0.896162
Validation mse = 0.009850
Epoch 35
Loss = 6.7798e-02, PNorm = 44.6770, GNorm = 1.5559, lr_0 = 2.4558e-04
Loss = 7.2582e-02, PNorm = 44.6854, GNorm = 0.5763, lr_0 = 2.4051e-04
Validation rmse = 0.096779
Validation r2 = 0.901267
Validation mse = 0.009366
Epoch 36
Loss = 6.0925e-02, PNorm = 44.6942, GNorm = 1.3540, lr_0 = 2.3553e-04
Loss = 7.7358e-02, PNorm = 44.7009, GNorm = 0.5278, lr_0 = 2.3066e-04
Loss = 5.1917e-02, PNorm = 44.7018, GNorm = 1.8861, lr_0 = 2.3018e-04
Validation rmse = 0.100903
Validation r2 = 0.892674
Validation mse = 0.010181
Epoch 37
Loss = 6.2056e-02, PNorm = 44.7101, GNorm = 0.5768, lr_0 = 2.2542e-04
Loss = 7.4360e-02, PNorm = 44.7171, GNorm = 0.6363, lr_0 = 2.2076e-04
Validation rmse = 0.091468
Validation r2 = 0.911806
Validation mse = 0.008366
Epoch 38
Loss = 6.2870e-02, PNorm = 44.7228, GNorm = 1.2667, lr_0 = 2.1620e-04
Validation rmse = 0.094066
Validation r2 = 0.906726
Validation mse = 0.008848
Epoch 39
Loss = 6.6089e-02, PNorm = 44.7317, GNorm = 1.7014, lr_0 = 2.1128e-04
Loss = 6.9288e-02, PNorm = 44.7404, GNorm = 0.4227, lr_0 = 2.0691e-04
Validation rmse = 0.093434
Validation r2 = 0.907975
Validation mse = 0.008730
Epoch 40
Loss = 7.6973e-02, PNorm = 44.7473, GNorm = 0.9076, lr_0 = 2.0264e-04
Loss = 6.5110e-02, PNorm = 44.7538, GNorm = 0.8725, lr_0 = 1.9845e-04
Validation rmse = 0.095679
Validation r2 = 0.903499
Validation mse = 0.009154
Epoch 41
Loss = 8.3140e-02, PNorm = 44.7603, GNorm = 1.7319, lr_0 = 1.9394e-04
Loss = 6.4432e-02, PNorm = 44.7674, GNorm = 2.3431, lr_0 = 1.8993e-04
Validation rmse = 0.103964
Validation r2 = 0.886063
Validation mse = 0.010809
Epoch 42
Loss = 5.5905e-02, PNorm = 44.7738, GNorm = 1.1245, lr_0 = 1.8600e-04
Loss = 6.6359e-02, PNorm = 44.7795, GNorm = 1.1445, lr_0 = 1.8215e-04
Validation rmse = 0.096712
Validation r2 = 0.901404
Validation mse = 0.009353
Epoch 43
Loss = 5.5785e-02, PNorm = 44.7860, GNorm = 0.4433, lr_0 = 1.7801e-04
Loss = 6.3351e-02, PNorm = 44.7929, GNorm = 0.8174, lr_0 = 1.7433e-04
Validation rmse = 0.095089
Validation r2 = 0.904685
Validation mse = 0.009042
Epoch 44
Loss = 5.9883e-02, PNorm = 44.7987, GNorm = 1.2439, lr_0 = 1.7073e-04
Loss = 5.7778e-02, PNorm = 44.8046, GNorm = 1.2213, lr_0 = 1.6720e-04
Validation rmse = 0.090232
Validation r2 = 0.914175
Validation mse = 0.008142
Epoch 45
Loss = 5.6334e-02, PNorm = 44.8115, GNorm = 1.0740, lr_0 = 1.6340e-04
Loss = 6.0634e-02, PNorm = 44.8177, GNorm = 0.4809, lr_0 = 1.6002e-04
Validation rmse = 0.092083
Validation r2 = 0.910617
Validation mse = 0.008479
Epoch 46
Loss = 5.7357e-02, PNorm = 44.8228, GNorm = 0.6961, lr_0 = 1.5671e-04
Loss = 5.9362e-02, PNorm = 44.8276, GNorm = 1.0139, lr_0 = 1.5347e-04
Validation rmse = 0.090039
Validation r2 = 0.914541
Validation mse = 0.008107
Epoch 47
Loss = 5.4582e-02, PNorm = 44.8341, GNorm = 1.6214, lr_0 = 1.4998e-04
Loss = 6.5113e-02, PNorm = 44.8389, GNorm = 0.7148, lr_0 = 1.4688e-04
Validation rmse = 0.089045
Validation r2 = 0.916417
Validation mse = 0.007929
Epoch 48
Loss = 6.3330e-02, PNorm = 44.8445, GNorm = 1.3288, lr_0 = 1.4384e-04
Loss = 5.4416e-02, PNorm = 44.8496, GNorm = 0.4789, lr_0 = 1.4087e-04
Validation rmse = 0.089107
Validation r2 = 0.916300
Validation mse = 0.007940
Epoch 49
Loss = 5.1370e-02, PNorm = 44.8552, GNorm = 1.0327, lr_0 = 1.3767e-04
Loss = 6.3981e-02, PNorm = 44.8596, GNorm = 1.5359, lr_0 = 1.3482e-04
Validation rmse = 0.093430
Validation r2 = 0.907982
Validation mse = 0.008729
Epoch 50
Loss = 4.8003e-02, PNorm = 44.8654, GNorm = 0.7337, lr_0 = 1.3204e-04
Loss = 6.2022e-02, PNorm = 44.8699, GNorm = 0.5000, lr_0 = 1.2930e-04
Validation rmse = 0.088830
Validation r2 = 0.916820
Validation mse = 0.007891
Epoch 51
Loss = 5.1151e-02, PNorm = 44.8748, GNorm = 0.9530, lr_0 = 1.2637e-04
Loss = 5.7661e-02, PNorm = 44.8787, GNorm = 1.4177, lr_0 = 1.2375e-04
Validation rmse = 0.091743
Validation r2 = 0.911276
Validation mse = 0.008417
Epoch 52
Loss = 5.7473e-02, PNorm = 44.8841, GNorm = 1.3222, lr_0 = 1.2094e-04
Loss = 5.4593e-02, PNorm = 44.8883, GNorm = 0.5273, lr_0 = 1.1844e-04
Validation rmse = 0.097913
Validation r2 = 0.898941
Validation mse = 0.009587
Epoch 53
Loss = 5.2515e-02, PNorm = 44.8931, GNorm = 0.6956, lr_0 = 1.1599e-04
Loss = 5.6367e-02, PNorm = 44.8976, GNorm = 0.4317, lr_0 = 1.1359e-04
Validation rmse = 0.091695
Validation r2 = 0.911368
Validation mse = 0.008408
Epoch 54
Loss = 4.9945e-02, PNorm = 44.9027, GNorm = 1.9209, lr_0 = 1.1101e-04
Loss = 6.1302e-02, PNorm = 44.9065, GNorm = 1.1195, lr_0 = 1.0872e-04
Validation rmse = 0.092251
Validation r2 = 0.910291
Validation mse = 0.008510
Epoch 55
Loss = 5.8090e-02, PNorm = 44.9104, GNorm = 0.7254, lr_0 = 1.0647e-04
Loss = 4.8942e-02, PNorm = 44.9138, GNorm = 0.5866, lr_0 = 1.0427e-04
Loss = 6.7896e-02, PNorm = 44.9142, GNorm = 1.5779, lr_0 = 1.0405e-04
Validation rmse = 0.086723
Validation r2 = 0.920719
Validation mse = 0.007521
Epoch 56
Loss = 5.7343e-02, PNorm = 44.9188, GNorm = 1.1831, lr_0 = 1.0190e-04
Loss = 4.5448e-02, PNorm = 44.9221, GNorm = 0.5689, lr_0 = 1.0000e-04
Validation rmse = 0.087022
Validation r2 = 0.920171
Validation mse = 0.007573
Epoch 57
Loss = 5.0545e-02, PNorm = 44.9249, GNorm = 0.5018, lr_0 = 1.0000e-04
Validation rmse = 0.083919
Validation r2 = 0.925763
Validation mse = 0.007042
Epoch 58
Loss = 4.7930e-02, PNorm = 44.9289, GNorm = 0.8193, lr_0 = 1.0000e-04
Loss = 5.1857e-02, PNorm = 44.9327, GNorm = 0.8328, lr_0 = 1.0000e-04
Validation rmse = 0.087618
Validation r2 = 0.919075
Validation mse = 0.007677
Epoch 59
Loss = 5.6203e-02, PNorm = 44.9361, GNorm = 0.9575, lr_0 = 1.0000e-04
Loss = 4.8873e-02, PNorm = 44.9397, GNorm = 0.6795, lr_0 = 1.0000e-04
Validation rmse = 0.086298
Validation r2 = 0.921495
Validation mse = 0.007447
Model 0 best validation rmse = 0.083919 on epoch 57
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.612454
Model 0 test r2 = -3.986162
Model 0 test mse = 0.375100
Ensemble test rmse = 0.612454
Ensemble test r2 = -3.986162
Ensemble test mse = 0.375100
Fold 1
Splitting data with seed 1
Total size = 984 | train size = 974 | val size = 10 | test size = 48
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.6479e-01, PNorm = 43.2633, GNorm = 1.2853, lr_0 = 3.6053e-04
Validation rmse = 0.304051
Validation r2 = 0.250222
Validation mse = 0.092447
Epoch 1
Loss = 4.3667e-01, PNorm = 43.2930, GNorm = 5.4076, lr_0 = 6.2105e-04
Loss = 5.9618e-01, PNorm = 43.3366, GNorm = 2.9210, lr_0 = 8.5789e-04
Validation rmse = 0.225602
Validation r2 = 0.587213
Validation mse = 0.050896
Epoch 2
Loss = 3.8120e-01, PNorm = 43.4041, GNorm = 3.4150, lr_0 = 9.8961e-04
Loss = 3.3817e-01, PNorm = 43.4787, GNorm = 7.7717, lr_0 = 9.6914e-04
Validation rmse = 0.219761
Validation r2 = 0.608309
Validation mse = 0.048295
Epoch 3
Loss = 2.6480e-01, PNorm = 43.5348, GNorm = 3.8396, lr_0 = 9.4910e-04
Loss = 2.3204e-01, PNorm = 43.5831, GNorm = 3.8753, lr_0 = 9.2948e-04
Validation rmse = 0.242781
Validation r2 = 0.521953
Validation mse = 0.058943
Epoch 4
Loss = 2.3090e-01, PNorm = 43.6283, GNorm = 9.2206, lr_0 = 9.0836e-04
Loss = 1.7959e-01, PNorm = 43.6641, GNorm = 0.9568, lr_0 = 8.8958e-04
Validation rmse = 0.222200
Validation r2 = 0.599567
Validation mse = 0.049373
Epoch 5
Loss = 1.5840e-01, PNorm = 43.6933, GNorm = 3.8506, lr_0 = 8.7118e-04
Loss = 2.3601e-01, PNorm = 43.7249, GNorm = 0.9824, lr_0 = 8.5317e-04
Validation rmse = 0.147335
Validation r2 = 0.823943
Validation mse = 0.021708
Epoch 6
Loss = 1.7003e-01, PNorm = 43.7651, GNorm = 2.1307, lr_0 = 8.3378e-04
Loss = 1.6623e-01, PNorm = 43.7901, GNorm = 2.9085, lr_0 = 8.1654e-04
Validation rmse = 0.151120
Validation r2 = 0.814780
Validation mse = 0.022837
Epoch 7
Loss = 1.4428e-01, PNorm = 43.8099, GNorm = 2.2011, lr_0 = 7.9966e-04
Loss = 1.4792e-01, PNorm = 43.8338, GNorm = 2.6066, lr_0 = 7.8312e-04
Validation rmse = 0.192148
Validation r2 = 0.700558
Validation mse = 0.036921
Epoch 8
Loss = 1.7056e-01, PNorm = 43.8661, GNorm = 2.0983, lr_0 = 7.6533e-04
Loss = 1.7963e-01, PNorm = 43.8920, GNorm = 3.4889, lr_0 = 7.4950e-04
Validation rmse = 0.177285
Validation r2 = 0.745091
Validation mse = 0.031430
Epoch 9
Loss = 1.6706e-01, PNorm = 43.9164, GNorm = 3.2576, lr_0 = 7.3400e-04
Loss = 1.4289e-01, PNorm = 43.9378, GNorm = 1.9205, lr_0 = 7.1883e-04
Validation rmse = 0.140146
Validation r2 = 0.840705
Validation mse = 0.019641
Epoch 10
Loss = 1.2450e-01, PNorm = 43.9600, GNorm = 0.6056, lr_0 = 7.0249e-04
Loss = 1.1960e-01, PNorm = 43.9821, GNorm = 0.7778, lr_0 = 6.8797e-04
Validation rmse = 0.093307
Validation r2 = 0.929390
Validation mse = 0.008706
Epoch 11
Loss = 1.0516e-01, PNorm = 44.0010, GNorm = 1.2726, lr_0 = 6.7374e-04
Loss = 1.2906e-01, PNorm = 44.0201, GNorm = 2.8528, lr_0 = 6.5981e-04
Validation rmse = 0.100097
Validation r2 = 0.918738
Validation mse = 0.010019
Epoch 12
Loss = 1.5016e-01, PNorm = 44.0380, GNorm = 0.5748, lr_0 = 6.4482e-04
Loss = 1.2269e-01, PNorm = 44.0598, GNorm = 1.2909, lr_0 = 6.3148e-04
Validation rmse = 0.101707
Validation r2 = 0.916104
Validation mse = 0.010344
Epoch 13
Loss = 1.1326e-01, PNorm = 44.0774, GNorm = 1.2712, lr_0 = 6.1843e-04
Loss = 1.0593e-01, PNorm = 44.0983, GNorm = 1.0930, lr_0 = 6.0564e-04
Validation rmse = 0.093121
Validation r2 = 0.929670
Validation mse = 0.008672
Epoch 14
Loss = 1.2826e-01, PNorm = 44.1153, GNorm = 1.9072, lr_0 = 5.9188e-04
Loss = 1.1107e-01, PNorm = 44.1313, GNorm = 1.1802, lr_0 = 5.7964e-04
Validation rmse = 0.093889
Validation r2 = 0.928506
Validation mse = 0.008815
Epoch 15
Loss = 1.1526e-01, PNorm = 44.1488, GNorm = 0.8819, lr_0 = 5.6765e-04
Loss = 1.0185e-01, PNorm = 44.1617, GNorm = 1.8671, lr_0 = 5.5592e-04
Validation rmse = 0.090747
Validation r2 = 0.933211
Validation mse = 0.008235
Epoch 16
Loss = 1.1332e-01, PNorm = 44.1780, GNorm = 3.0119, lr_0 = 5.4328e-04
Loss = 1.0031e-01, PNorm = 44.1898, GNorm = 1.2298, lr_0 = 5.3205e-04
Validation rmse = 0.086103
Validation r2 = 0.939872
Validation mse = 0.007414
Epoch 17
Loss = 1.0694e-01, PNorm = 44.1986, GNorm = 2.3846, lr_0 = 5.2105e-04
Loss = 9.8073e-02, PNorm = 44.2130, GNorm = 1.3606, lr_0 = 5.1027e-04
Loss = 8.1795e-02, PNorm = 44.2142, GNorm = 0.5784, lr_0 = 5.0921e-04
Validation rmse = 0.103777
Validation r2 = 0.912654
Validation mse = 0.010770
Epoch 18
Loss = 1.1008e-01, PNorm = 44.2242, GNorm = 1.0819, lr_0 = 4.9868e-04
Loss = 1.1426e-01, PNorm = 44.2402, GNorm = 3.0562, lr_0 = 4.8837e-04
Validation rmse = 0.085326
Validation r2 = 0.940952
Validation mse = 0.007281
Epoch 19
Loss = 9.3010e-02, PNorm = 44.2560, GNorm = 1.6956, lr_0 = 4.7827e-04
Validation rmse = 0.074490
Validation r2 = 0.954998
Validation mse = 0.005549
Epoch 20
Loss = 6.4013e-02, PNorm = 44.2682, GNorm = 1.3947, lr_0 = 4.6740e-04
Loss = 9.5344e-02, PNorm = 44.2817, GNorm = 1.2975, lr_0 = 4.5774e-04
Validation rmse = 0.088221
Validation r2 = 0.936877
Validation mse = 0.007783
Epoch 21
Loss = 1.0379e-01, PNorm = 44.2931, GNorm = 2.8775, lr_0 = 4.4827e-04
Loss = 1.0239e-01, PNorm = 44.3034, GNorm = 0.6140, lr_0 = 4.3900e-04
Validation rmse = 0.074597
Validation r2 = 0.954868
Validation mse = 0.005565
Epoch 22
Loss = 1.1991e-01, PNorm = 44.3146, GNorm = 0.6250, lr_0 = 4.2903e-04
Loss = 9.7811e-02, PNorm = 44.3259, GNorm = 0.9410, lr_0 = 4.2016e-04
Validation rmse = 0.074358
Validation r2 = 0.955157
Validation mse = 0.005529
Epoch 23
Loss = 1.1654e-01, PNorm = 44.3405, GNorm = 3.0896, lr_0 = 4.1147e-04
Loss = 1.0942e-01, PNorm = 44.3538, GNorm = 1.5886, lr_0 = 4.0296e-04
Validation rmse = 0.086863
Validation r2 = 0.938806
Validation mse = 0.007545
Epoch 24
Loss = 9.1119e-02, PNorm = 44.3648, GNorm = 1.1120, lr_0 = 3.9381e-04
Loss = 7.9982e-02, PNorm = 44.3772, GNorm = 0.4525, lr_0 = 3.8566e-04
Validation rmse = 0.075803
Validation r2 = 0.953397
Validation mse = 0.005746
Epoch 25
Loss = 7.4751e-02, PNorm = 44.3869, GNorm = 1.5553, lr_0 = 3.7769e-04
Loss = 9.3025e-02, PNorm = 44.3973, GNorm = 1.4315, lr_0 = 3.6988e-04
Validation rmse = 0.087943
Validation r2 = 0.937275
Validation mse = 0.007734
Epoch 26
Loss = 7.2323e-02, PNorm = 44.4069, GNorm = 1.2485, lr_0 = 3.6147e-04
Loss = 9.4453e-02, PNorm = 44.4159, GNorm = 0.5696, lr_0 = 3.5400e-04
Validation rmse = 0.092748
Validation r2 = 0.930233
Validation mse = 0.008602
Epoch 27
Loss = 9.0173e-02, PNorm = 44.4240, GNorm = 2.5490, lr_0 = 3.4596e-04
Loss = 8.3173e-02, PNorm = 44.4335, GNorm = 2.1967, lr_0 = 3.3880e-04
Validation rmse = 0.073838
Validation r2 = 0.955782
Validation mse = 0.005452
Epoch 28
Loss = 8.0474e-02, PNorm = 44.4451, GNorm = 1.5425, lr_0 = 3.3180e-04
Loss = 9.4089e-02, PNorm = 44.4557, GNorm = 1.4079, lr_0 = 3.2494e-04
Validation rmse = 0.082521
Validation r2 = 0.944770
Validation mse = 0.006810
Epoch 29
Loss = 8.2379e-02, PNorm = 44.4684, GNorm = 0.9328, lr_0 = 3.1755e-04
Loss = 9.5063e-02, PNorm = 44.4772, GNorm = 0.9967, lr_0 = 3.1099e-04
Validation rmse = 0.085510
Validation r2 = 0.940698
Validation mse = 0.007312
Epoch 30
Loss = 8.2658e-02, PNorm = 44.4844, GNorm = 2.1160, lr_0 = 3.0456e-04
Loss = 7.9425e-02, PNorm = 44.4938, GNorm = 2.7069, lr_0 = 2.9826e-04
Validation rmse = 0.070081
Validation r2 = 0.960167
Validation mse = 0.004911
Epoch 31
Loss = 8.1001e-02, PNorm = 44.5046, GNorm = 1.6362, lr_0 = 2.9148e-04
Loss = 8.5387e-02, PNorm = 44.5126, GNorm = 1.3569, lr_0 = 2.8545e-04
Validation rmse = 0.072648
Validation r2 = 0.957195
Validation mse = 0.005278
Epoch 32
Loss = 7.8505e-02, PNorm = 44.5218, GNorm = 1.4333, lr_0 = 2.7955e-04
Loss = 7.9089e-02, PNorm = 44.5305, GNorm = 0.9900, lr_0 = 2.7377e-04
Validation rmse = 0.085486
Validation r2 = 0.940731
Validation mse = 0.007308
Epoch 33
Loss = 8.2599e-02, PNorm = 44.5382, GNorm = 2.1950, lr_0 = 2.6755e-04
Loss = 1.0036e-01, PNorm = 44.5465, GNorm = 1.2070, lr_0 = 2.6202e-04
Validation rmse = 0.104597
Validation r2 = 0.911268
Validation mse = 0.010941
Epoch 34
Loss = 8.6799e-02, PNorm = 44.5548, GNorm = 0.6165, lr_0 = 2.5660e-04
Loss = 7.5663e-02, PNorm = 44.5629, GNorm = 2.3409, lr_0 = 2.5129e-04
Validation rmse = 0.079110
Validation r2 = 0.949242
Validation mse = 0.006258
Epoch 35
Loss = 7.4043e-02, PNorm = 44.5707, GNorm = 1.1521, lr_0 = 2.4558e-04
Loss = 7.0761e-02, PNorm = 44.5768, GNorm = 0.7290, lr_0 = 2.4051e-04
Validation rmse = 0.074664
Validation r2 = 0.954787
Validation mse = 0.005575
Epoch 36
Loss = 6.5409e-02, PNorm = 44.5825, GNorm = 1.3304, lr_0 = 2.3553e-04
Loss = 7.7683e-02, PNorm = 44.5897, GNorm = 0.9758, lr_0 = 2.3066e-04
Loss = 5.4975e-02, PNorm = 44.5904, GNorm = 1.2092, lr_0 = 2.3018e-04
Validation rmse = 0.085832
Validation r2 = 0.940250
Validation mse = 0.007367
Epoch 37
Loss = 7.0646e-02, PNorm = 44.5979, GNorm = 0.5916, lr_0 = 2.2542e-04
Loss = 7.6678e-02, PNorm = 44.6047, GNorm = 1.8251, lr_0 = 2.2076e-04
Validation rmse = 0.084212
Validation r2 = 0.942484
Validation mse = 0.007092
Epoch 38
Loss = 7.0472e-02, PNorm = 44.6110, GNorm = 0.9272, lr_0 = 2.1620e-04
Validation rmse = 0.078166
Validation r2 = 0.950446
Validation mse = 0.006110
Epoch 39
Loss = 7.4355e-02, PNorm = 44.6185, GNorm = 1.1107, lr_0 = 2.1128e-04
Loss = 7.0202e-02, PNorm = 44.6246, GNorm = 1.9241, lr_0 = 2.0691e-04
Validation rmse = 0.070731
Validation r2 = 0.959425
Validation mse = 0.005003
Epoch 40
Loss = 4.2442e-02, PNorm = 44.6307, GNorm = 1.3396, lr_0 = 2.0264e-04
Loss = 7.5295e-02, PNorm = 44.6369, GNorm = 3.0444, lr_0 = 1.9845e-04
Validation rmse = 0.079922
Validation r2 = 0.948195
Validation mse = 0.006388
Epoch 41
Loss = 5.8118e-02, PNorm = 44.6429, GNorm = 1.6818, lr_0 = 1.9394e-04
Loss = 6.8458e-02, PNorm = 44.6495, GNorm = 1.4406, lr_0 = 1.8993e-04
Validation rmse = 0.079221
Validation r2 = 0.949099
Validation mse = 0.006276
Epoch 42
Loss = 7.8689e-02, PNorm = 44.6556, GNorm = 0.4745, lr_0 = 1.8600e-04
Loss = 7.4646e-02, PNorm = 44.6618, GNorm = 0.7210, lr_0 = 1.8215e-04
Validation rmse = 0.075963
Validation r2 = 0.953200
Validation mse = 0.005770
Epoch 43
Loss = 7.1741e-02, PNorm = 44.6679, GNorm = 0.7756, lr_0 = 1.7801e-04
Loss = 6.3649e-02, PNorm = 44.6740, GNorm = 0.6388, lr_0 = 1.7433e-04
Validation rmse = 0.076686
Validation r2 = 0.952305
Validation mse = 0.005881
Epoch 44
Loss = 6.0701e-02, PNorm = 44.6786, GNorm = 0.9198, lr_0 = 1.7073e-04
Loss = 7.3254e-02, PNorm = 44.6846, GNorm = 1.2169, lr_0 = 1.6720e-04
Validation rmse = 0.071734
Validation r2 = 0.958266
Validation mse = 0.005146
Epoch 45
Loss = 6.8655e-02, PNorm = 44.6895, GNorm = 1.6476, lr_0 = 1.6340e-04
Loss = 6.9385e-02, PNorm = 44.6942, GNorm = 1.2371, lr_0 = 1.6002e-04
Validation rmse = 0.086515
Validation r2 = 0.939295
Validation mse = 0.007485
Epoch 46
Loss = 5.9495e-02, PNorm = 44.6994, GNorm = 0.9404, lr_0 = 1.5671e-04
Loss = 6.8862e-02, PNorm = 44.7043, GNorm = 0.5999, lr_0 = 1.5347e-04
Validation rmse = 0.075613
Validation r2 = 0.953631
Validation mse = 0.005717
Epoch 47
Loss = 5.5485e-02, PNorm = 44.7095, GNorm = 0.5970, lr_0 = 1.4998e-04
Loss = 6.9709e-02, PNorm = 44.7141, GNorm = 1.7259, lr_0 = 1.4688e-04
Validation rmse = 0.071620
Validation r2 = 0.958398
Validation mse = 0.005129
Epoch 48
Loss = 5.8090e-02, PNorm = 44.7187, GNorm = 0.7485, lr_0 = 1.4384e-04
Loss = 6.0607e-02, PNorm = 44.7231, GNorm = 0.6174, lr_0 = 1.4087e-04
Validation rmse = 0.066566
Validation r2 = 0.964063
Validation mse = 0.004431
Epoch 49
Loss = 6.8400e-02, PNorm = 44.7281, GNorm = 0.6307, lr_0 = 1.3767e-04
Loss = 5.9798e-02, PNorm = 44.7333, GNorm = 0.8493, lr_0 = 1.3482e-04
Validation rmse = 0.079969
Validation r2 = 0.948134
Validation mse = 0.006395
Epoch 50
Loss = 5.9524e-02, PNorm = 44.7370, GNorm = 0.5912, lr_0 = 1.3204e-04
Loss = 5.7487e-02, PNorm = 44.7413, GNorm = 0.8485, lr_0 = 1.2930e-04
Validation rmse = 0.069394
Validation r2 = 0.960944
Validation mse = 0.004816
Epoch 51
Loss = 6.5580e-02, PNorm = 44.7455, GNorm = 0.8963, lr_0 = 1.2637e-04
Loss = 5.8380e-02, PNorm = 44.7495, GNorm = 0.6881, lr_0 = 1.2375e-04
Validation rmse = 0.074035
Validation r2 = 0.955545
Validation mse = 0.005481
Epoch 52
Loss = 5.9752e-02, PNorm = 44.7534, GNorm = 0.8741, lr_0 = 1.2094e-04
Loss = 5.9548e-02, PNorm = 44.7573, GNorm = 0.7081, lr_0 = 1.1844e-04
Validation rmse = 0.066838
Validation r2 = 0.963769
Validation mse = 0.004467
Epoch 53
Loss = 5.0919e-02, PNorm = 44.7608, GNorm = 0.9039, lr_0 = 1.1599e-04
Loss = 6.3550e-02, PNorm = 44.7636, GNorm = 0.4866, lr_0 = 1.1359e-04
Validation rmse = 0.067527
Validation r2 = 0.963017
Validation mse = 0.004560
Epoch 54
Loss = 5.6681e-02, PNorm = 44.7678, GNorm = 1.4966, lr_0 = 1.1101e-04
Loss = 5.7731e-02, PNorm = 44.7710, GNorm = 1.8092, lr_0 = 1.0872e-04
Validation rmse = 0.076133
Validation r2 = 0.952991
Validation mse = 0.005796
Epoch 55
Loss = 5.0226e-02, PNorm = 44.7743, GNorm = 0.6244, lr_0 = 1.0647e-04
Loss = 6.0074e-02, PNorm = 44.7774, GNorm = 0.9449, lr_0 = 1.0427e-04
Loss = 6.7284e-02, PNorm = 44.7777, GNorm = 0.8380, lr_0 = 1.0405e-04
Validation rmse = 0.066745
Validation r2 = 0.963869
Validation mse = 0.004455
Epoch 56
Loss = 5.7960e-02, PNorm = 44.7811, GNorm = 0.5342, lr_0 = 1.0190e-04
Loss = 5.6247e-02, PNorm = 44.7846, GNorm = 1.7017, lr_0 = 1.0000e-04
Validation rmse = 0.086282
Validation r2 = 0.939622
Validation mse = 0.007445
Epoch 57
Loss = 6.2619e-02, PNorm = 44.7885, GNorm = 0.8280, lr_0 = 1.0000e-04
Validation rmse = 0.067232
Validation r2 = 0.963340
Validation mse = 0.004520
Epoch 58
Loss = 5.4178e-02, PNorm = 44.7923, GNorm = 0.9706, lr_0 = 1.0000e-04
Loss = 5.5487e-02, PNorm = 44.7951, GNorm = 0.9158, lr_0 = 1.0000e-04
Validation rmse = 0.078247
Validation r2 = 0.950344
Validation mse = 0.006123
Epoch 59
Loss = 5.1195e-02, PNorm = 44.7979, GNorm = 1.7701, lr_0 = 1.0000e-04
Loss = 6.7768e-02, PNorm = 44.8022, GNorm = 1.8493, lr_0 = 1.0000e-04
Validation rmse = 0.080988
Validation r2 = 0.946804
Validation mse = 0.006559
Model 0 best validation rmse = 0.066566 on epoch 48
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.612384
Model 0 test r2 = -3.985016
Model 0 test mse = 0.375014
Ensemble test rmse = 0.612384
Ensemble test r2 = -3.985016
Ensemble test mse = 0.375014
Fold 2
Splitting data with seed 2
Total size = 984 | train size = 974 | val size = 10 | test size = 48
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 8.9504e-01, PNorm = 43.2639, GNorm = 6.7684, lr_0 = 3.6053e-04
Validation rmse = 0.348405
Validation r2 = 0.205504
Validation mse = 0.121386
Epoch 1
Loss = 5.2829e-01, PNorm = 43.2919, GNorm = 5.4541, lr_0 = 6.2105e-04
Loss = 4.8769e-01, PNorm = 43.3400, GNorm = 2.5193, lr_0 = 8.5789e-04
Validation rmse = 0.246664
Validation r2 = 0.601770
Validation mse = 0.060843
Epoch 2
Loss = 5.4447e-01, PNorm = 43.4150, GNorm = 6.8698, lr_0 = 9.8961e-04
Loss = 4.4520e-01, PNorm = 43.4890, GNorm = 5.9514, lr_0 = 9.6914e-04
Validation rmse = 0.147850
Validation r2 = 0.856924
Validation mse = 0.021860
Epoch 3
Loss = 2.8367e-01, PNorm = 43.5538, GNorm = 6.5046, lr_0 = 9.4910e-04
Loss = 3.0092e-01, PNorm = 43.6085, GNorm = 1.3826, lr_0 = 9.2948e-04
Validation rmse = 0.190063
Validation r2 = 0.763562
Validation mse = 0.036124
Epoch 4
Loss = 2.6641e-01, PNorm = 43.6536, GNorm = 1.5547, lr_0 = 9.0836e-04
Loss = 2.3333e-01, PNorm = 43.6989, GNorm = 1.5165, lr_0 = 8.8958e-04
Validation rmse = 0.131511
Validation r2 = 0.886800
Validation mse = 0.017295
Epoch 5
Loss = 2.0107e-01, PNorm = 43.7373, GNorm = 1.2189, lr_0 = 8.7118e-04
Loss = 1.7456e-01, PNorm = 43.7619, GNorm = 3.2709, lr_0 = 8.5317e-04
Validation rmse = 0.091978
Validation r2 = 0.944629
Validation mse = 0.008460
Epoch 6
Loss = 1.4207e-01, PNorm = 43.7962, GNorm = 1.0863, lr_0 = 8.3378e-04
Loss = 1.6902e-01, PNorm = 43.8245, GNorm = 1.0065, lr_0 = 8.1654e-04
Validation rmse = 0.098483
Validation r2 = 0.936519
Validation mse = 0.009699
Epoch 7
Loss = 1.6004e-01, PNorm = 43.8465, GNorm = 2.9603, lr_0 = 7.9966e-04
Loss = 1.5922e-01, PNorm = 43.8731, GNorm = 2.7833, lr_0 = 7.8312e-04
Validation rmse = 0.132719
Validation r2 = 0.884711
Validation mse = 0.017614
Epoch 8
Loss = 1.8281e-01, PNorm = 43.9104, GNorm = 6.2158, lr_0 = 7.6533e-04
Loss = 1.4178e-01, PNorm = 43.9382, GNorm = 0.7566, lr_0 = 7.4950e-04
Validation rmse = 0.107480
Validation r2 = 0.924391
Validation mse = 0.011552
Epoch 9
Loss = 1.2659e-01, PNorm = 43.9662, GNorm = 2.2799, lr_0 = 7.3400e-04
Loss = 1.5324e-01, PNorm = 43.9936, GNorm = 3.8768, lr_0 = 7.1883e-04
Validation rmse = 0.073722
Validation r2 = 0.964427
Validation mse = 0.005435
Epoch 10
Loss = 1.2953e-01, PNorm = 44.0130, GNorm = 1.3347, lr_0 = 7.0249e-04
Loss = 1.3467e-01, PNorm = 44.0371, GNorm = 2.0733, lr_0 = 6.8797e-04
Validation rmse = 0.086928
Validation r2 = 0.950541
Validation mse = 0.007556
Epoch 11
Loss = 1.1281e-01, PNorm = 44.0555, GNorm = 1.4094, lr_0 = 6.7374e-04
Loss = 1.4532e-01, PNorm = 44.0730, GNorm = 4.3291, lr_0 = 6.5981e-04
Validation rmse = 0.105011
Validation r2 = 0.927824
Validation mse = 0.011027
Epoch 12
Loss = 1.1578e-01, PNorm = 44.0974, GNorm = 2.1984, lr_0 = 6.4482e-04
Loss = 1.3237e-01, PNorm = 44.1178, GNorm = 0.6579, lr_0 = 6.3148e-04
Validation rmse = 0.077264
Validation r2 = 0.960927
Validation mse = 0.005970
Epoch 13
Loss = 1.0410e-01, PNorm = 44.1339, GNorm = 0.5728, lr_0 = 6.1843e-04
Loss = 1.1527e-01, PNorm = 44.1495, GNorm = 1.8226, lr_0 = 6.0564e-04
Validation rmse = 0.094703
Validation r2 = 0.941298
Validation mse = 0.008969
Epoch 14
Loss = 1.1507e-01, PNorm = 44.1721, GNorm = 2.2444, lr_0 = 5.9188e-04
Loss = 1.1931e-01, PNorm = 44.1877, GNorm = 0.8836, lr_0 = 5.7964e-04
Validation rmse = 0.060491
Validation r2 = 0.976050
Validation mse = 0.003659
Epoch 15
Loss = 1.1172e-01, PNorm = 44.2041, GNorm = 0.7095, lr_0 = 5.6765e-04
Loss = 9.2447e-02, PNorm = 44.2190, GNorm = 0.5227, lr_0 = 5.5592e-04
Validation rmse = 0.091307
Validation r2 = 0.945434
Validation mse = 0.008337
Epoch 16
Loss = 1.0960e-01, PNorm = 44.2341, GNorm = 1.3319, lr_0 = 5.4328e-04
Loss = 1.1082e-01, PNorm = 44.2455, GNorm = 0.6736, lr_0 = 5.3205e-04
Validation rmse = 0.089782
Validation r2 = 0.947240
Validation mse = 0.008061
Epoch 17
Loss = 9.7853e-02, PNorm = 44.2592, GNorm = 0.5990, lr_0 = 5.2105e-04
Loss = 1.0173e-01, PNorm = 44.2718, GNorm = 2.3939, lr_0 = 5.1027e-04
Loss = 1.0661e-01, PNorm = 44.2726, GNorm = 1.1315, lr_0 = 5.0921e-04
Validation rmse = 0.065455
Validation r2 = 0.971958
Validation mse = 0.004284
Epoch 18
Loss = 9.1183e-02, PNorm = 44.2840, GNorm = 2.4533, lr_0 = 4.9868e-04
Loss = 1.1679e-01, PNorm = 44.2985, GNorm = 3.3947, lr_0 = 4.8837e-04
Validation rmse = 0.076383
Validation r2 = 0.961813
Validation mse = 0.005834
Epoch 19
Loss = 9.8913e-02, PNorm = 44.3111, GNorm = 1.4785, lr_0 = 4.7827e-04
Validation rmse = 0.075282
Validation r2 = 0.962906
Validation mse = 0.005667
Epoch 20
Loss = 9.8283e-02, PNorm = 44.3252, GNorm = 1.3152, lr_0 = 4.6740e-04
Loss = 1.0229e-01, PNorm = 44.3386, GNorm = 2.7796, lr_0 = 4.5774e-04
Validation rmse = 0.072957
Validation r2 = 0.965162
Validation mse = 0.005323
Epoch 21
Loss = 1.1565e-01, PNorm = 44.3468, GNorm = 1.4289, lr_0 = 4.4827e-04
Loss = 8.7871e-02, PNorm = 44.3588, GNorm = 1.1851, lr_0 = 4.3900e-04
Validation rmse = 0.087048
Validation r2 = 0.950405
Validation mse = 0.007577
Epoch 22
Loss = 1.0073e-01, PNorm = 44.3711, GNorm = 1.2451, lr_0 = 4.2903e-04
Loss = 9.4788e-02, PNorm = 44.3838, GNorm = 0.8153, lr_0 = 4.2016e-04
Validation rmse = 0.091817
Validation r2 = 0.944822
Validation mse = 0.008430
Epoch 23
Loss = 1.2372e-01, PNorm = 44.3917, GNorm = 1.4302, lr_0 = 4.1147e-04
Loss = 8.3063e-02, PNorm = 44.4029, GNorm = 2.0632, lr_0 = 4.0296e-04
Validation rmse = 0.090501
Validation r2 = 0.946392
Validation mse = 0.008190
Epoch 24
Loss = 7.4119e-02, PNorm = 44.4131, GNorm = 0.5240, lr_0 = 3.9381e-04
Loss = 9.2080e-02, PNorm = 44.4243, GNorm = 1.3157, lr_0 = 3.8566e-04
Validation rmse = 0.098753
Validation r2 = 0.936170
Validation mse = 0.009752
Epoch 25
Loss = 8.3098e-02, PNorm = 44.4363, GNorm = 0.7962, lr_0 = 3.7769e-04
Loss = 8.8706e-02, PNorm = 44.4476, GNorm = 2.2960, lr_0 = 3.6988e-04
Validation rmse = 0.077063
Validation r2 = 0.961130
Validation mse = 0.005939
Epoch 26
Loss = 6.3747e-02, PNorm = 44.4552, GNorm = 0.9395, lr_0 = 3.6147e-04
Loss = 8.5777e-02, PNorm = 44.4641, GNorm = 1.9567, lr_0 = 3.5400e-04
Validation rmse = 0.088988
Validation r2 = 0.948170
Validation mse = 0.007919
Epoch 27
Loss = 7.5792e-02, PNorm = 44.4716, GNorm = 0.9766, lr_0 = 3.4596e-04
Loss = 8.9299e-02, PNorm = 44.4782, GNorm = 0.5488, lr_0 = 3.3880e-04
Validation rmse = 0.088609
Validation r2 = 0.948610
Validation mse = 0.007852
Epoch 28
Loss = 8.0544e-02, PNorm = 44.4897, GNorm = 0.6721, lr_0 = 3.3180e-04
Loss = 8.8285e-02, PNorm = 44.4996, GNorm = 2.3361, lr_0 = 3.2494e-04
Validation rmse = 0.071586
Validation r2 = 0.966459
Validation mse = 0.005125
Epoch 29
Loss = 6.9695e-02, PNorm = 44.5075, GNorm = 1.0848, lr_0 = 3.1755e-04
Loss = 8.3366e-02, PNorm = 44.5165, GNorm = 1.8373, lr_0 = 3.1099e-04
Validation rmse = 0.092671
Validation r2 = 0.943790
Validation mse = 0.008588
Epoch 30
Loss = 7.8452e-02, PNorm = 44.5237, GNorm = 2.5197, lr_0 = 3.0456e-04
Loss = 8.5825e-02, PNorm = 44.5332, GNorm = 0.7756, lr_0 = 2.9826e-04
Validation rmse = 0.074322
Validation r2 = 0.963846
Validation mse = 0.005524
Epoch 31
Loss = 7.9036e-02, PNorm = 44.5434, GNorm = 1.2672, lr_0 = 2.9148e-04
Loss = 8.0263e-02, PNorm = 44.5509, GNorm = 1.2994, lr_0 = 2.8545e-04
Validation rmse = 0.092675
Validation r2 = 0.943785
Validation mse = 0.008589
Epoch 32
Loss = 7.9718e-02, PNorm = 44.5572, GNorm = 2.1709, lr_0 = 2.7955e-04
Loss = 7.2475e-02, PNorm = 44.5656, GNorm = 0.9019, lr_0 = 2.7377e-04
Validation rmse = 0.084173
Validation r2 = 0.953627
Validation mse = 0.007085
Epoch 33
Loss = 8.6477e-02, PNorm = 44.5737, GNorm = 2.3582, lr_0 = 2.6755e-04
Loss = 7.7770e-02, PNorm = 44.5810, GNorm = 1.8764, lr_0 = 2.6202e-04
Validation rmse = 0.062440
Validation r2 = 0.974482
Validation mse = 0.003899
Epoch 34
Loss = 7.0063e-02, PNorm = 44.5902, GNorm = 0.6910, lr_0 = 2.5660e-04
Loss = 7.9283e-02, PNorm = 44.5968, GNorm = 1.0945, lr_0 = 2.5129e-04
Validation rmse = 0.066963
Validation r2 = 0.970651
Validation mse = 0.004484
Epoch 35
Loss = 7.8052e-02, PNorm = 44.6048, GNorm = 0.7378, lr_0 = 2.4558e-04
Loss = 7.3583e-02, PNorm = 44.6131, GNorm = 0.4500, lr_0 = 2.4051e-04
Validation rmse = 0.068988
Validation r2 = 0.968849
Validation mse = 0.004759
Epoch 36
Loss = 5.9981e-02, PNorm = 44.6213, GNorm = 0.8615, lr_0 = 2.3553e-04
Loss = 7.8690e-02, PNorm = 44.6271, GNorm = 1.1173, lr_0 = 2.3066e-04
Loss = 1.3688e-01, PNorm = 44.6277, GNorm = 4.2789, lr_0 = 2.3018e-04
Validation rmse = 0.073144
Validation r2 = 0.964983
Validation mse = 0.005350
Epoch 37
Loss = 8.3022e-02, PNorm = 44.6340, GNorm = 1.2080, lr_0 = 2.2542e-04
Loss = 7.8907e-02, PNorm = 44.6417, GNorm = 2.1562, lr_0 = 2.2076e-04
Validation rmse = 0.070720
Validation r2 = 0.967265
Validation mse = 0.005001
Epoch 38
Loss = 6.7271e-02, PNorm = 44.6489, GNorm = 0.8570, lr_0 = 2.1620e-04
Validation rmse = 0.078329
Validation r2 = 0.959842
Validation mse = 0.006135
Epoch 39
Loss = 7.6890e-02, PNorm = 44.6555, GNorm = 2.0850, lr_0 = 2.1128e-04
Loss = 7.2900e-02, PNorm = 44.6614, GNorm = 1.4813, lr_0 = 2.0691e-04
Validation rmse = 0.071080
Validation r2 = 0.966932
Validation mse = 0.005052
Epoch 40
Loss = 7.9995e-02, PNorm = 44.6682, GNorm = 0.7722, lr_0 = 2.0264e-04
Loss = 5.8810e-02, PNorm = 44.6757, GNorm = 0.8731, lr_0 = 1.9845e-04
Validation rmse = 0.091189
Validation r2 = 0.945574
Validation mse = 0.008315
Epoch 41
Loss = 6.9055e-02, PNorm = 44.6812, GNorm = 0.5482, lr_0 = 1.9394e-04
Loss = 6.4450e-02, PNorm = 44.6871, GNorm = 1.2169, lr_0 = 1.8993e-04
Validation rmse = 0.077979
Validation r2 = 0.960201
Validation mse = 0.006081
Epoch 42
Loss = 6.1592e-02, PNorm = 44.6920, GNorm = 0.6324, lr_0 = 1.8600e-04
Loss = 6.2456e-02, PNorm = 44.6964, GNorm = 0.9637, lr_0 = 1.8215e-04
Validation rmse = 0.078555
Validation r2 = 0.959610
Validation mse = 0.006171
Epoch 43
Loss = 5.9894e-02, PNorm = 44.7034, GNorm = 1.5466, lr_0 = 1.7801e-04
Loss = 6.8974e-02, PNorm = 44.7083, GNorm = 0.9362, lr_0 = 1.7433e-04
Validation rmse = 0.079856
Validation r2 = 0.958262
Validation mse = 0.006377
Epoch 44
Loss = 4.4431e-02, PNorm = 44.7134, GNorm = 0.7176, lr_0 = 1.7073e-04
Loss = 6.1148e-02, PNorm = 44.7182, GNorm = 0.4087, lr_0 = 1.6720e-04
Validation rmse = 0.090444
Validation r2 = 0.946460
Validation mse = 0.008180
Epoch 45
Loss = 5.6428e-02, PNorm = 44.7240, GNorm = 1.0070, lr_0 = 1.6340e-04
Loss = 6.1305e-02, PNorm = 44.7291, GNorm = 0.7862, lr_0 = 1.6002e-04
Validation rmse = 0.085349
Validation r2 = 0.952322
Validation mse = 0.007284
Epoch 46
Loss = 5.8011e-02, PNorm = 44.7340, GNorm = 0.6790, lr_0 = 1.5671e-04
Loss = 5.5682e-02, PNorm = 44.7398, GNorm = 1.9406, lr_0 = 1.5347e-04
Validation rmse = 0.082157
Validation r2 = 0.955821
Validation mse = 0.006750
Epoch 47
Loss = 6.1398e-02, PNorm = 44.7456, GNorm = 0.6656, lr_0 = 1.4998e-04
Loss = 5.4531e-02, PNorm = 44.7495, GNorm = 0.4425, lr_0 = 1.4688e-04
Validation rmse = 0.075187
Validation r2 = 0.962999
Validation mse = 0.005653
Epoch 48
Loss = 5.9528e-02, PNorm = 44.7547, GNorm = 1.0535, lr_0 = 1.4384e-04
Loss = 5.9617e-02, PNorm = 44.7600, GNorm = 0.9622, lr_0 = 1.4087e-04
Validation rmse = 0.080925
Validation r2 = 0.957136
Validation mse = 0.006549
Epoch 49
Loss = 5.2692e-02, PNorm = 44.7653, GNorm = 0.9794, lr_0 = 1.3767e-04
Loss = 5.2127e-02, PNorm = 44.7702, GNorm = 0.3983, lr_0 = 1.3482e-04
Validation rmse = 0.080141
Validation r2 = 0.957963
Validation mse = 0.006423
Epoch 50
Loss = 5.5640e-02, PNorm = 44.7750, GNorm = 0.9234, lr_0 = 1.3204e-04
Loss = 5.6890e-02, PNorm = 44.7798, GNorm = 1.8941, lr_0 = 1.2930e-04
Validation rmse = 0.075896
Validation r2 = 0.962299
Validation mse = 0.005760
Epoch 51
Loss = 5.5498e-02, PNorm = 44.7843, GNorm = 0.7672, lr_0 = 1.2637e-04
Loss = 5.7723e-02, PNorm = 44.7877, GNorm = 0.6245, lr_0 = 1.2375e-04
Validation rmse = 0.076867
Validation r2 = 0.961328
Validation mse = 0.005909
Epoch 52
Loss = 5.9261e-02, PNorm = 44.7928, GNorm = 0.6207, lr_0 = 1.2094e-04
Loss = 5.0122e-02, PNorm = 44.7973, GNorm = 1.3505, lr_0 = 1.1844e-04
Validation rmse = 0.083900
Validation r2 = 0.953927
Validation mse = 0.007039
Epoch 53
Loss = 5.9833e-02, PNorm = 44.8013, GNorm = 1.8141, lr_0 = 1.1599e-04
Loss = 5.2431e-02, PNorm = 44.8052, GNorm = 1.7368, lr_0 = 1.1359e-04
Validation rmse = 0.070145
Validation r2 = 0.967796
Validation mse = 0.004920
Epoch 54
Loss = 5.6124e-02, PNorm = 44.8096, GNorm = 1.2824, lr_0 = 1.1101e-04
Loss = 5.4497e-02, PNorm = 44.8133, GNorm = 0.7444, lr_0 = 1.0872e-04
Validation rmse = 0.079345
Validation r2 = 0.958794
Validation mse = 0.006296
Epoch 55
Loss = 5.7124e-02, PNorm = 44.8171, GNorm = 0.9267, lr_0 = 1.0647e-04
Loss = 4.9084e-02, PNorm = 44.8208, GNorm = 2.0176, lr_0 = 1.0427e-04
Loss = 3.9039e-02, PNorm = 44.8211, GNorm = 1.5340, lr_0 = 1.0405e-04
Validation rmse = 0.083186
Validation r2 = 0.954708
Validation mse = 0.006920
Epoch 56
Loss = 5.3358e-02, PNorm = 44.8251, GNorm = 0.6578, lr_0 = 1.0190e-04
Loss = 5.0079e-02, PNorm = 44.8287, GNorm = 1.1934, lr_0 = 1.0000e-04
Validation rmse = 0.078203
Validation r2 = 0.959971
Validation mse = 0.006116
Epoch 57
Loss = 4.9264e-02, PNorm = 44.8317, GNorm = 1.1370, lr_0 = 1.0000e-04
Validation rmse = 0.080696
Validation r2 = 0.957379
Validation mse = 0.006512
Epoch 58
Loss = 4.6294e-02, PNorm = 44.8356, GNorm = 1.4622, lr_0 = 1.0000e-04
Loss = 5.2844e-02, PNorm = 44.8390, GNorm = 1.5929, lr_0 = 1.0000e-04
Validation rmse = 0.086703
Validation r2 = 0.950797
Validation mse = 0.007517
Epoch 59
Loss = 5.0571e-02, PNorm = 44.8423, GNorm = 1.9864, lr_0 = 1.0000e-04
Loss = 5.7115e-02, PNorm = 44.8467, GNorm = 0.9098, lr_0 = 1.0000e-04
Validation rmse = 0.075439
Validation r2 = 0.962751
Validation mse = 0.005691
Model 0 best validation rmse = 0.060491 on epoch 14
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.587054
Model 0 test r2 = -3.581162
Model 0 test mse = 0.344633
Ensemble test rmse = 0.587054
Ensemble test r2 = -3.581162
Ensemble test mse = 0.344633
Fold 3
Splitting data with seed 3
Total size = 984 | train size = 974 | val size = 10 | test size = 48
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 1.0344e+00, PNorm = 43.2622, GNorm = 2.4148, lr_0 = 3.6053e-04
Validation rmse = 0.263664
Validation r2 = 0.247343
Validation mse = 0.069519
Epoch 1
Loss = 8.2936e-01, PNorm = 43.2921, GNorm = 9.1888, lr_0 = 6.2105e-04
Loss = 5.0718e-01, PNorm = 43.3355, GNorm = 2.2665, lr_0 = 8.5789e-04
Validation rmse = 0.184207
Validation r2 = 0.632627
Validation mse = 0.033932
Epoch 2
Loss = 5.1699e-01, PNorm = 43.4137, GNorm = 7.3197, lr_0 = 9.8961e-04
Loss = 3.2715e-01, PNorm = 43.4823, GNorm = 9.1851, lr_0 = 9.6914e-04
Validation rmse = 0.193886
Validation r2 = 0.593006
Validation mse = 0.037592
Epoch 3
Loss = 3.3309e-01, PNorm = 43.5348, GNorm = 6.4687, lr_0 = 9.4910e-04
Loss = 3.0212e-01, PNorm = 43.5844, GNorm = 1.4670, lr_0 = 9.2948e-04
Validation rmse = 0.156312
Validation r2 = 0.735467
Validation mse = 0.024434
Epoch 4
Loss = 2.0025e-01, PNorm = 43.6364, GNorm = 4.4889, lr_0 = 9.0836e-04
Loss = 2.0452e-01, PNorm = 43.6783, GNorm = 2.5547, lr_0 = 8.8958e-04
Validation rmse = 0.192474
Validation r2 = 0.598915
Validation mse = 0.037046
Epoch 5
Loss = 1.7324e-01, PNorm = 43.7103, GNorm = 5.1432, lr_0 = 8.7118e-04
Loss = 1.7285e-01, PNorm = 43.7351, GNorm = 2.5390, lr_0 = 8.5317e-04
Validation rmse = 0.144279
Validation r2 = 0.774627
Validation mse = 0.020817
Epoch 6
Loss = 1.3950e-01, PNorm = 43.7753, GNorm = 1.3158, lr_0 = 8.3378e-04
Loss = 1.4885e-01, PNorm = 43.8050, GNorm = 5.2187, lr_0 = 8.1654e-04
Validation rmse = 0.200156
Validation r2 = 0.566257
Validation mse = 0.040063
Epoch 7
Loss = 1.3982e-01, PNorm = 43.8299, GNorm = 1.7035, lr_0 = 7.9966e-04
Loss = 1.5088e-01, PNorm = 43.8558, GNorm = 1.9063, lr_0 = 7.8312e-04
Validation rmse = 0.170187
Validation r2 = 0.686422
Validation mse = 0.028964
Epoch 8
Loss = 1.4354e-01, PNorm = 43.8828, GNorm = 4.0289, lr_0 = 7.6533e-04
Loss = 1.7664e-01, PNorm = 43.9041, GNorm = 1.3385, lr_0 = 7.4950e-04
Validation rmse = 0.153215
Validation r2 = 0.745847
Validation mse = 0.023475
Epoch 9
Loss = 1.3229e-01, PNorm = 43.9294, GNorm = 1.4487, lr_0 = 7.3400e-04
Loss = 1.3274e-01, PNorm = 43.9481, GNorm = 1.4684, lr_0 = 7.1883e-04
Validation rmse = 0.202343
Validation r2 = 0.556730
Validation mse = 0.040943
Epoch 10
Loss = 1.6288e-01, PNorm = 43.9729, GNorm = 1.4649, lr_0 = 7.0249e-04
Loss = 1.5837e-01, PNorm = 43.9976, GNorm = 1.9790, lr_0 = 6.8797e-04
Validation rmse = 0.181684
Validation r2 = 0.642621
Validation mse = 0.033009
Epoch 11
Loss = 1.4179e-01, PNorm = 44.0182, GNorm = 2.5558, lr_0 = 6.7374e-04
Loss = 1.5815e-01, PNorm = 44.0378, GNorm = 2.5452, lr_0 = 6.5981e-04
Validation rmse = 0.137868
Validation r2 = 0.794213
Validation mse = 0.019007
Epoch 12
Loss = 1.3820e-01, PNorm = 44.0635, GNorm = 1.4397, lr_0 = 6.4482e-04
Loss = 1.2101e-01, PNorm = 44.0809, GNorm = 2.5056, lr_0 = 6.3148e-04
Validation rmse = 0.189218
Validation r2 = 0.612367
Validation mse = 0.035804
Epoch 13
Loss = 1.1816e-01, PNorm = 44.0926, GNorm = 2.0547, lr_0 = 6.1843e-04
Loss = 1.1211e-01, PNorm = 44.1099, GNorm = 2.2049, lr_0 = 6.0564e-04
Validation rmse = 0.141598
Validation r2 = 0.782925
Validation mse = 0.020050
Epoch 14
Loss = 1.2974e-01, PNorm = 44.1164, GNorm = 2.0346, lr_0 = 5.9188e-04
Loss = 1.2150e-01, PNorm = 44.1265, GNorm = 0.7098, lr_0 = 5.7964e-04
Validation rmse = 0.132411
Validation r2 = 0.810181
Validation mse = 0.017533
Epoch 15
Loss = 1.0491e-01, PNorm = 44.1370, GNorm = 1.5925, lr_0 = 5.6765e-04
Loss = 1.3511e-01, PNorm = 44.1557, GNorm = 1.8055, lr_0 = 5.5592e-04
Validation rmse = 0.133335
Validation r2 = 0.807521
Validation mse = 0.017778
Epoch 16
Loss = 1.1153e-01, PNorm = 44.1722, GNorm = 1.1547, lr_0 = 5.4328e-04
Loss = 1.0373e-01, PNorm = 44.1850, GNorm = 0.8056, lr_0 = 5.3205e-04
Validation rmse = 0.146432
Validation r2 = 0.767851
Validation mse = 0.021442
Epoch 17
Loss = 1.1669e-01, PNorm = 44.1969, GNorm = 2.2213, lr_0 = 5.2105e-04
Loss = 1.0404e-01, PNorm = 44.2105, GNorm = 1.8135, lr_0 = 5.1027e-04
Loss = 5.4147e-02, PNorm = 44.2118, GNorm = 0.7409, lr_0 = 5.0921e-04
Validation rmse = 0.152597
Validation r2 = 0.747893
Validation mse = 0.023286
Epoch 18
Loss = 9.7755e-02, PNorm = 44.2271, GNorm = 1.0355, lr_0 = 4.9868e-04
Loss = 1.1650e-01, PNorm = 44.2362, GNorm = 5.1092, lr_0 = 4.8837e-04
Validation rmse = 0.161067
Validation r2 = 0.719130
Validation mse = 0.025942
Epoch 19
Loss = 1.4087e-01, PNorm = 44.2508, GNorm = 2.8598, lr_0 = 4.7827e-04
Validation rmse = 0.133876
Validation r2 = 0.805956
Validation mse = 0.017923
Epoch 20
Loss = 9.2963e-02, PNorm = 44.2667, GNorm = 1.0071, lr_0 = 4.6740e-04
Loss = 8.8081e-02, PNorm = 44.2754, GNorm = 1.7900, lr_0 = 4.5774e-04
Validation rmse = 0.142325
Validation r2 = 0.780691
Validation mse = 0.020256
Epoch 21
Loss = 1.0424e-01, PNorm = 44.2835, GNorm = 0.8144, lr_0 = 4.4827e-04
Loss = 9.0812e-02, PNorm = 44.2921, GNorm = 0.5096, lr_0 = 4.3900e-04
Validation rmse = 0.116247
Validation r2 = 0.853696
Validation mse = 0.013513
Epoch 22
Loss = 1.2147e-01, PNorm = 44.3038, GNorm = 2.6103, lr_0 = 4.2903e-04
Loss = 9.5246e-02, PNorm = 44.3140, GNorm = 1.0402, lr_0 = 4.2016e-04
Validation rmse = 0.128143
Validation r2 = 0.822220
Validation mse = 0.016421
Epoch 23
Loss = 1.0125e-01, PNorm = 44.3222, GNorm = 0.7154, lr_0 = 4.1147e-04
Loss = 8.1987e-02, PNorm = 44.3305, GNorm = 1.0133, lr_0 = 4.0296e-04
Validation rmse = 0.128357
Validation r2 = 0.821624
Validation mse = 0.016476
Epoch 24
Loss = 9.6761e-02, PNorm = 44.3406, GNorm = 0.6848, lr_0 = 3.9381e-04
Loss = 9.5802e-02, PNorm = 44.3500, GNorm = 1.0064, lr_0 = 3.8566e-04
Validation rmse = 0.119557
Validation r2 = 0.845245
Validation mse = 0.014294
Epoch 25
Loss = 9.0107e-02, PNorm = 44.3572, GNorm = 0.7883, lr_0 = 3.7769e-04
Loss = 8.8730e-02, PNorm = 44.3666, GNorm = 1.4597, lr_0 = 3.6988e-04
Validation rmse = 0.157602
Validation r2 = 0.731083
Validation mse = 0.024838
Epoch 26
Loss = 7.8951e-02, PNorm = 44.3760, GNorm = 1.1398, lr_0 = 3.6147e-04
Loss = 9.2702e-02, PNorm = 44.3842, GNorm = 1.2012, lr_0 = 3.5400e-04
Validation rmse = 0.118066
Validation r2 = 0.849080
Validation mse = 0.013940
Epoch 27
Loss = 8.8839e-02, PNorm = 44.3953, GNorm = 2.1143, lr_0 = 3.4596e-04
Loss = 8.0154e-02, PNorm = 44.4055, GNorm = 1.3577, lr_0 = 3.3880e-04
Validation rmse = 0.122893
Validation r2 = 0.836487
Validation mse = 0.015103
Epoch 28
Loss = 8.2719e-02, PNorm = 44.4149, GNorm = 0.8497, lr_0 = 3.3180e-04
Loss = 8.5395e-02, PNorm = 44.4227, GNorm = 0.8383, lr_0 = 3.2494e-04
Validation rmse = 0.138612
Validation r2 = 0.791985
Validation mse = 0.019213
Epoch 29
Loss = 8.6631e-02, PNorm = 44.4320, GNorm = 3.1061, lr_0 = 3.1755e-04
Loss = 9.1991e-02, PNorm = 44.4401, GNorm = 4.1649, lr_0 = 3.1099e-04
Validation rmse = 0.151930
Validation r2 = 0.750092
Validation mse = 0.023083
Epoch 30
Loss = 8.0921e-02, PNorm = 44.4467, GNorm = 2.3177, lr_0 = 3.0456e-04
Loss = 8.1726e-02, PNorm = 44.4558, GNorm = 0.5959, lr_0 = 2.9826e-04
Validation rmse = 0.120508
Validation r2 = 0.842773
Validation mse = 0.014522
Epoch 31
Loss = 7.0373e-02, PNorm = 44.4644, GNorm = 0.5732, lr_0 = 2.9148e-04
Loss = 8.1608e-02, PNorm = 44.4715, GNorm = 1.3683, lr_0 = 2.8545e-04
Validation rmse = 0.127693
Validation r2 = 0.823465
Validation mse = 0.016306
Epoch 32
Loss = 8.2488e-02, PNorm = 44.4788, GNorm = 0.5821, lr_0 = 2.7955e-04
Loss = 7.2219e-02, PNorm = 44.4867, GNorm = 0.5893, lr_0 = 2.7377e-04
Validation rmse = 0.119882
Validation r2 = 0.844403
Validation mse = 0.014372
Epoch 33
Loss = 8.0589e-02, PNorm = 44.4962, GNorm = 2.8873, lr_0 = 2.6755e-04
Loss = 8.4609e-02, PNorm = 44.5021, GNorm = 1.3279, lr_0 = 2.6202e-04
Validation rmse = 0.127226
Validation r2 = 0.824756
Validation mse = 0.016186
Epoch 34
Loss = 6.9333e-02, PNorm = 44.5086, GNorm = 0.4527, lr_0 = 2.5660e-04
Loss = 8.5392e-02, PNorm = 44.5150, GNorm = 1.1944, lr_0 = 2.5129e-04
Validation rmse = 0.117638
Validation r2 = 0.850173
Validation mse = 0.013839
Epoch 35
Loss = 6.9822e-02, PNorm = 44.5244, GNorm = 0.6729, lr_0 = 2.4558e-04
Loss = 8.4612e-02, PNorm = 44.5306, GNorm = 0.9808, lr_0 = 2.4051e-04
Validation rmse = 0.115444
Validation r2 = 0.855710
Validation mse = 0.013327
Epoch 36
Loss = 6.7746e-02, PNorm = 44.5377, GNorm = 0.7651, lr_0 = 2.3553e-04
Loss = 8.1601e-02, PNorm = 44.5434, GNorm = 0.6693, lr_0 = 2.3066e-04
Loss = 3.6152e-02, PNorm = 44.5440, GNorm = 1.1086, lr_0 = 2.3018e-04
Validation rmse = 0.116550
Validation r2 = 0.852933
Validation mse = 0.013584
Epoch 37
Loss = 6.8921e-02, PNorm = 44.5504, GNorm = 0.7278, lr_0 = 2.2542e-04
Loss = 7.9997e-02, PNorm = 44.5561, GNorm = 1.1386, lr_0 = 2.2076e-04
Validation rmse = 0.128305
Validation r2 = 0.821769
Validation mse = 0.016462
Epoch 38
Loss = 7.4307e-02, PNorm = 44.5624, GNorm = 0.9782, lr_0 = 2.1620e-04
Validation rmse = 0.137418
Validation r2 = 0.795552
Validation mse = 0.018884
Epoch 39
Loss = 1.0939e-01, PNorm = 44.5696, GNorm = 0.8762, lr_0 = 2.1128e-04
Loss = 6.5910e-02, PNorm = 44.5753, GNorm = 1.1834, lr_0 = 2.0691e-04
Validation rmse = 0.131571
Validation r2 = 0.812581
Validation mse = 0.017311
Epoch 40
Loss = 6.0032e-02, PNorm = 44.5803, GNorm = 1.0062, lr_0 = 2.0264e-04
Loss = 6.6524e-02, PNorm = 44.5864, GNorm = 0.9020, lr_0 = 1.9845e-04
Validation rmse = 0.142589
Validation r2 = 0.779877
Validation mse = 0.020332
Epoch 41
Loss = 7.0331e-02, PNorm = 44.5922, GNorm = 1.6622, lr_0 = 1.9394e-04
Loss = 6.8716e-02, PNorm = 44.5986, GNorm = 0.3304, lr_0 = 1.8993e-04
Validation rmse = 0.127305
Validation r2 = 0.824538
Validation mse = 0.016207
Epoch 42
Loss = 6.6834e-02, PNorm = 44.6035, GNorm = 1.3492, lr_0 = 1.8600e-04
Loss = 6.3360e-02, PNorm = 44.6096, GNorm = 0.4366, lr_0 = 1.8215e-04
Validation rmse = 0.109387
Validation r2 = 0.870455
Validation mse = 0.011965
Epoch 43
Loss = 6.5302e-02, PNorm = 44.6160, GNorm = 1.1643, lr_0 = 1.7801e-04
Loss = 7.4253e-02, PNorm = 44.6211, GNorm = 0.8625, lr_0 = 1.7433e-04
Validation rmse = 0.117280
Validation r2 = 0.851085
Validation mse = 0.013755
Epoch 44
Loss = 7.8082e-02, PNorm = 44.6261, GNorm = 1.1064, lr_0 = 1.7073e-04
Loss = 6.2384e-02, PNorm = 44.6316, GNorm = 1.0182, lr_0 = 1.6720e-04
Validation rmse = 0.120516
Validation r2 = 0.842753
Validation mse = 0.014524
Epoch 45
Loss = 8.3985e-02, PNorm = 44.6375, GNorm = 0.8612, lr_0 = 1.6340e-04
Loss = 5.7184e-02, PNorm = 44.6424, GNorm = 0.7256, lr_0 = 1.6002e-04
Validation rmse = 0.118594
Validation r2 = 0.847727
Validation mse = 0.014065
Epoch 46
Loss = 6.8069e-02, PNorm = 44.6476, GNorm = 1.3499, lr_0 = 1.5671e-04
Loss = 7.0804e-02, PNorm = 44.6525, GNorm = 2.0955, lr_0 = 1.5347e-04
Validation rmse = 0.112765
Validation r2 = 0.862329
Validation mse = 0.012716
Epoch 47
Loss = 5.5936e-02, PNorm = 44.6576, GNorm = 0.5799, lr_0 = 1.4998e-04
Loss = 6.7126e-02, PNorm = 44.6624, GNorm = 0.5042, lr_0 = 1.4688e-04
Validation rmse = 0.128256
Validation r2 = 0.821907
Validation mse = 0.016450
Epoch 48
Loss = 5.3836e-02, PNorm = 44.6669, GNorm = 0.4320, lr_0 = 1.4384e-04
Loss = 6.3234e-02, PNorm = 44.6719, GNorm = 2.0405, lr_0 = 1.4087e-04
Validation rmse = 0.129250
Validation r2 = 0.819134
Validation mse = 0.016706
Epoch 49
Loss = 6.3297e-02, PNorm = 44.6767, GNorm = 1.4188, lr_0 = 1.3767e-04
Loss = 6.0209e-02, PNorm = 44.6813, GNorm = 0.6607, lr_0 = 1.3482e-04
Validation rmse = 0.143253
Validation r2 = 0.777820
Validation mse = 0.020522
Epoch 50
Loss = 6.7652e-02, PNorm = 44.6856, GNorm = 0.7855, lr_0 = 1.3204e-04
Loss = 6.4098e-02, PNorm = 44.6899, GNorm = 0.7684, lr_0 = 1.2930e-04
Validation rmse = 0.111623
Validation r2 = 0.865104
Validation mse = 0.012460
Epoch 51
Loss = 6.5373e-02, PNorm = 44.6950, GNorm = 1.2438, lr_0 = 1.2637e-04
Loss = 5.9411e-02, PNorm = 44.6985, GNorm = 0.5250, lr_0 = 1.2375e-04
Validation rmse = 0.122861
Validation r2 = 0.836573
Validation mse = 0.015095
Epoch 52
Loss = 5.4249e-02, PNorm = 44.7021, GNorm = 0.5440, lr_0 = 1.2094e-04
Loss = 5.9955e-02, PNorm = 44.7068, GNorm = 0.5470, lr_0 = 1.1844e-04
Validation rmse = 0.123975
Validation r2 = 0.833597
Validation mse = 0.015370
Epoch 53
Loss = 5.9036e-02, PNorm = 44.7112, GNorm = 0.5674, lr_0 = 1.1599e-04
Loss = 6.6596e-02, PNorm = 44.7150, GNorm = 1.1278, lr_0 = 1.1359e-04
Validation rmse = 0.133849
Validation r2 = 0.806036
Validation mse = 0.017915
Epoch 54
Loss = 5.3950e-02, PNorm = 44.7186, GNorm = 0.9098, lr_0 = 1.1101e-04
Loss = 6.9029e-02, PNorm = 44.7222, GNorm = 0.5622, lr_0 = 1.0872e-04
Validation rmse = 0.114632
Validation r2 = 0.857733
Validation mse = 0.013140
Epoch 55
Loss = 6.1793e-02, PNorm = 44.7260, GNorm = 0.4364, lr_0 = 1.0647e-04
Loss = 5.4593e-02, PNorm = 44.7300, GNorm = 0.4603, lr_0 = 1.0427e-04
Loss = 6.4492e-02, PNorm = 44.7303, GNorm = 1.6131, lr_0 = 1.0405e-04
Validation rmse = 0.117348
Validation r2 = 0.850911
Validation mse = 0.013771
Epoch 56
Loss = 5.9225e-02, PNorm = 44.7341, GNorm = 0.5955, lr_0 = 1.0190e-04
Loss = 5.7783e-02, PNorm = 44.7376, GNorm = 1.9312, lr_0 = 1.0000e-04
Validation rmse = 0.117251
Validation r2 = 0.851159
Validation mse = 0.013748
Epoch 57
Loss = 6.1178e-02, PNorm = 44.7405, GNorm = 1.0196, lr_0 = 1.0000e-04
Validation rmse = 0.135833
Validation r2 = 0.800243
Validation mse = 0.018450
Epoch 58
Loss = 5.3053e-02, PNorm = 44.7446, GNorm = 3.0464, lr_0 = 1.0000e-04
Loss = 6.4569e-02, PNorm = 44.7478, GNorm = 1.7978, lr_0 = 1.0000e-04
Validation rmse = 0.119659
Validation r2 = 0.844980
Validation mse = 0.014318
Epoch 59
Loss = 8.6716e-02, PNorm = 44.7520, GNorm = 1.3944, lr_0 = 1.0000e-04
Loss = 5.5576e-02, PNorm = 44.7547, GNorm = 1.2556, lr_0 = 1.0000e-04
Validation rmse = 0.112696
Validation r2 = 0.862497
Validation mse = 0.012700
Model 0 best validation rmse = 0.109387 on epoch 42
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.653055
Model 0 test r2 = -4.669156
Model 0 test mse = 0.426481
Ensemble test rmse = 0.653055
Ensemble test r2 = -4.669156
Ensemble test mse = 0.426481
Fold 4
Splitting data with seed 4
Total size = 984 | train size = 974 | val size = 10 | test size = 48
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 1.0438e+00, PNorm = 43.2618, GNorm = 5.3670, lr_0 = 3.6053e-04
Validation rmse = 0.416471
Validation r2 = -0.279395
Validation mse = 0.173448
Epoch 1
Loss = 1.1707e+00, PNorm = 43.2841, GNorm = 11.3100, lr_0 = 6.2105e-04
Loss = 5.8555e-01, PNorm = 43.3298, GNorm = 6.4365, lr_0 = 8.5789e-04
Validation rmse = 0.280319
Validation r2 = 0.420385
Validation mse = 0.078579
Epoch 2
Loss = 4.4980e-01, PNorm = 43.4059, GNorm = 3.0399, lr_0 = 9.8961e-04
Loss = 3.5921e-01, PNorm = 43.4775, GNorm = 2.0681, lr_0 = 9.6914e-04
Validation rmse = 0.265093
Validation r2 = 0.481639
Validation mse = 0.070275
Epoch 3
Loss = 3.2920e-01, PNorm = 43.5406, GNorm = 3.3865, lr_0 = 9.4910e-04
Loss = 2.7908e-01, PNorm = 43.5902, GNorm = 2.4864, lr_0 = 9.2948e-04
Validation rmse = 0.192333
Validation r2 = 0.727138
Validation mse = 0.036992
Epoch 4
Loss = 2.0100e-01, PNorm = 43.6416, GNorm = 4.1518, lr_0 = 9.0836e-04
Loss = 1.7166e-01, PNorm = 43.6829, GNorm = 0.6669, lr_0 = 8.8958e-04
Validation rmse = 0.202180
Validation r2 = 0.698485
Validation mse = 0.040877
Epoch 5
Loss = 1.4505e-01, PNorm = 43.7197, GNorm = 1.2659, lr_0 = 8.7118e-04
Loss = 1.6593e-01, PNorm = 43.7490, GNorm = 0.9201, lr_0 = 8.5317e-04
Validation rmse = 0.270641
Validation r2 = 0.459715
Validation mse = 0.073247
Epoch 6
Loss = 1.7238e-01, PNorm = 43.7821, GNorm = 3.8415, lr_0 = 8.3378e-04
Loss = 1.4855e-01, PNorm = 43.8084, GNorm = 1.7859, lr_0 = 8.1654e-04
Validation rmse = 0.186652
Validation r2 = 0.743019
Validation mse = 0.034839
Epoch 7
Loss = 1.4149e-01, PNorm = 43.8344, GNorm = 4.0545, lr_0 = 7.9966e-04
Loss = 1.4302e-01, PNorm = 43.8563, GNorm = 1.2512, lr_0 = 7.8312e-04
Validation rmse = 0.183077
Validation r2 = 0.752770
Validation mse = 0.033517
Epoch 8
Loss = 1.3537e-01, PNorm = 43.8808, GNorm = 1.5270, lr_0 = 7.6533e-04
Loss = 1.2636e-01, PNorm = 43.9006, GNorm = 1.9725, lr_0 = 7.4950e-04
Validation rmse = 0.169882
Validation r2 = 0.787122
Validation mse = 0.028860
Epoch 9
Loss = 1.4825e-01, PNorm = 43.9243, GNorm = 3.2148, lr_0 = 7.3400e-04
Loss = 1.6356e-01, PNorm = 43.9483, GNorm = 4.1291, lr_0 = 7.1883e-04
Validation rmse = 0.213059
Validation r2 = 0.665161
Validation mse = 0.045394
Epoch 10
Loss = 1.1824e-01, PNorm = 43.9691, GNorm = 1.0671, lr_0 = 7.0249e-04
Loss = 1.2353e-01, PNorm = 43.9851, GNorm = 0.8050, lr_0 = 6.8797e-04
Validation rmse = 0.161970
Validation r2 = 0.806491
Validation mse = 0.026234
Epoch 11
Loss = 1.0106e-01, PNorm = 44.0065, GNorm = 1.2102, lr_0 = 6.7374e-04
Loss = 1.3409e-01, PNorm = 44.0271, GNorm = 1.0325, lr_0 = 6.5981e-04
Validation rmse = 0.129841
Validation r2 = 0.875646
Validation mse = 0.016859
Epoch 12
Loss = 1.6317e-01, PNorm = 44.0522, GNorm = 3.3897, lr_0 = 6.4482e-04
Loss = 1.2804e-01, PNorm = 44.0752, GNorm = 2.0004, lr_0 = 6.3148e-04
Validation rmse = 0.164436
Validation r2 = 0.800552
Validation mse = 0.027039
Epoch 13
Loss = 1.1585e-01, PNorm = 44.0940, GNorm = 2.1495, lr_0 = 6.1843e-04
Loss = 1.4039e-01, PNorm = 44.1103, GNorm = 3.8469, lr_0 = 6.0564e-04
Validation rmse = 0.171141
Validation r2 = 0.783955
Validation mse = 0.029289
Epoch 14
Loss = 1.4416e-01, PNorm = 44.1307, GNorm = 2.5258, lr_0 = 5.9188e-04
Loss = 1.1216e-01, PNorm = 44.1484, GNorm = 0.8721, lr_0 = 5.7964e-04
Validation rmse = 0.185731
Validation r2 = 0.745550
Validation mse = 0.034496
Epoch 15
Loss = 1.1906e-01, PNorm = 44.1679, GNorm = 3.2021, lr_0 = 5.6765e-04
Loss = 1.1033e-01, PNorm = 44.1788, GNorm = 1.4807, lr_0 = 5.5592e-04
Validation rmse = 0.161525
Validation r2 = 0.807551
Validation mse = 0.026090
Epoch 16
Loss = 9.9556e-02, PNorm = 44.1917, GNorm = 2.2180, lr_0 = 5.4328e-04
Loss = 1.2439e-01, PNorm = 44.2104, GNorm = 2.0218, lr_0 = 5.3205e-04
Validation rmse = 0.161881
Validation r2 = 0.806703
Validation mse = 0.026205
Epoch 17
Loss = 1.1094e-01, PNorm = 44.2247, GNorm = 0.8468, lr_0 = 5.2105e-04
Loss = 1.3440e-01, PNorm = 44.2371, GNorm = 2.4067, lr_0 = 5.1027e-04
Loss = 1.9761e-01, PNorm = 44.2384, GNorm = 1.4694, lr_0 = 5.0921e-04
Validation rmse = 0.163015
Validation r2 = 0.803985
Validation mse = 0.026574
Epoch 18
Loss = 1.2330e-01, PNorm = 44.2590, GNorm = 3.5006, lr_0 = 4.9868e-04
Loss = 1.3545e-01, PNorm = 44.2811, GNorm = 2.0973, lr_0 = 4.8837e-04
Validation rmse = 0.144524
Validation r2 = 0.845931
Validation mse = 0.020887
Epoch 19
Loss = 1.2666e-01, PNorm = 44.2958, GNorm = 1.4789, lr_0 = 4.7827e-04
Validation rmse = 0.206632
Validation r2 = 0.685057
Validation mse = 0.042697
Epoch 20
Loss = 1.2635e-01, PNorm = 44.3144, GNorm = 2.1355, lr_0 = 4.6740e-04
Loss = 1.1692e-01, PNorm = 44.3316, GNorm = 1.3146, lr_0 = 4.5774e-04
Validation rmse = 0.180684
Validation r2 = 0.759189
Validation mse = 0.032647
Epoch 21
Loss = 8.7404e-02, PNorm = 44.3445, GNorm = 1.4420, lr_0 = 4.4827e-04
Loss = 9.8544e-02, PNorm = 44.3569, GNorm = 1.2826, lr_0 = 4.3900e-04
Validation rmse = 0.155526
Validation r2 = 0.821581
Validation mse = 0.024188
Epoch 22
Loss = 9.1498e-02, PNorm = 44.3710, GNorm = 0.6267, lr_0 = 4.2903e-04
Loss = 9.1216e-02, PNorm = 44.3839, GNorm = 1.1622, lr_0 = 4.2016e-04
Validation rmse = 0.152829
Validation r2 = 0.827714
Validation mse = 0.023357
Epoch 23
Loss = 7.9029e-02, PNorm = 44.3908, GNorm = 0.6148, lr_0 = 4.1147e-04
Loss = 8.4704e-02, PNorm = 44.3976, GNorm = 1.0591, lr_0 = 4.0296e-04
Validation rmse = 0.148569
Validation r2 = 0.837186
Validation mse = 0.022073
Epoch 24
Loss = 8.9075e-02, PNorm = 44.4084, GNorm = 0.9882, lr_0 = 3.9381e-04
Loss = 8.6409e-02, PNorm = 44.4164, GNorm = 0.7452, lr_0 = 3.8566e-04
Validation rmse = 0.147300
Validation r2 = 0.839955
Validation mse = 0.021697
Epoch 25
Loss = 1.0124e-01, PNorm = 44.4264, GNorm = 3.0735, lr_0 = 3.7769e-04
Loss = 1.0568e-01, PNorm = 44.4392, GNorm = 0.9825, lr_0 = 3.6988e-04
Validation rmse = 0.140706
Validation r2 = 0.853964
Validation mse = 0.019798
Epoch 26
Loss = 1.1047e-01, PNorm = 44.4512, GNorm = 1.2502, lr_0 = 3.6147e-04
Loss = 7.7835e-02, PNorm = 44.4613, GNorm = 1.3240, lr_0 = 3.5400e-04
Validation rmse = 0.164918
Validation r2 = 0.799382
Validation mse = 0.027198
Epoch 27
Loss = 7.4795e-02, PNorm = 44.4722, GNorm = 0.5130, lr_0 = 3.4596e-04
Loss = 9.1394e-02, PNorm = 44.4809, GNorm = 1.2997, lr_0 = 3.3880e-04
Validation rmse = 0.146102
Validation r2 = 0.842549
Validation mse = 0.021346
Epoch 28
Loss = 9.3014e-02, PNorm = 44.4901, GNorm = 0.5747, lr_0 = 3.3180e-04
Loss = 7.5598e-02, PNorm = 44.4984, GNorm = 0.8486, lr_0 = 3.2494e-04
Validation rmse = 0.160649
Validation r2 = 0.809632
Validation mse = 0.025808
Epoch 29
Loss = 7.7561e-02, PNorm = 44.5079, GNorm = 1.2964, lr_0 = 3.1755e-04
Loss = 8.0218e-02, PNorm = 44.5176, GNorm = 0.6153, lr_0 = 3.1099e-04
Validation rmse = 0.145589
Validation r2 = 0.843651
Validation mse = 0.021196
Epoch 30
Loss = 8.4403e-02, PNorm = 44.5251, GNorm = 1.1127, lr_0 = 3.0456e-04
Loss = 7.6992e-02, PNorm = 44.5339, GNorm = 1.1424, lr_0 = 2.9826e-04
Validation rmse = 0.153245
Validation r2 = 0.826776
Validation mse = 0.023484
Epoch 31
Loss = 6.6224e-02, PNorm = 44.5449, GNorm = 1.1374, lr_0 = 2.9148e-04
Loss = 8.2033e-02, PNorm = 44.5530, GNorm = 1.7076, lr_0 = 2.8545e-04
Validation rmse = 0.162447
Validation r2 = 0.805349
Validation mse = 0.026389
Epoch 32
Loss = 7.8731e-02, PNorm = 44.5618, GNorm = 1.2482, lr_0 = 2.7955e-04
Loss = 7.4187e-02, PNorm = 44.5699, GNorm = 1.0964, lr_0 = 2.7377e-04
Validation rmse = 0.167953
Validation r2 = 0.791929
Validation mse = 0.028208
Epoch 33
Loss = 6.8269e-02, PNorm = 44.5765, GNorm = 0.7187, lr_0 = 2.6755e-04
Loss = 7.6462e-02, PNorm = 44.5869, GNorm = 0.5546, lr_0 = 2.6202e-04
Validation rmse = 0.159585
Validation r2 = 0.812146
Validation mse = 0.025467
Epoch 34
Loss = 8.1122e-02, PNorm = 44.5942, GNorm = 1.4011, lr_0 = 2.5660e-04
Loss = 7.9162e-02, PNorm = 44.6044, GNorm = 1.5520, lr_0 = 2.5129e-04
Validation rmse = 0.138474
Validation r2 = 0.858561
Validation mse = 0.019175
Epoch 35
Loss = 7.5379e-02, PNorm = 44.6141, GNorm = 0.9128, lr_0 = 2.4558e-04
Loss = 7.5360e-02, PNorm = 44.6207, GNorm = 0.5062, lr_0 = 2.4051e-04
Validation rmse = 0.147433
Validation r2 = 0.839666
Validation mse = 0.021737
Epoch 36
Loss = 7.4436e-02, PNorm = 44.6276, GNorm = 1.5040, lr_0 = 2.3553e-04
Loss = 7.3434e-02, PNorm = 44.6363, GNorm = 0.7484, lr_0 = 2.3066e-04
Loss = 6.9685e-02, PNorm = 44.6374, GNorm = 1.2555, lr_0 = 2.3018e-04
Validation rmse = 0.172037
Validation r2 = 0.781687
Validation mse = 0.029597
Epoch 37
Loss = 7.2817e-02, PNorm = 44.6460, GNorm = 0.8371, lr_0 = 2.2542e-04
Loss = 7.3048e-02, PNorm = 44.6534, GNorm = 0.7425, lr_0 = 2.2076e-04
Validation rmse = 0.147474
Validation r2 = 0.839578
Validation mse = 0.021748
Epoch 38
Loss = 6.4918e-02, PNorm = 44.6609, GNorm = 0.6736, lr_0 = 2.1620e-04
Validation rmse = 0.140611
Validation r2 = 0.854162
Validation mse = 0.019771
Epoch 39
Loss = 5.6117e-02, PNorm = 44.6686, GNorm = 0.6332, lr_0 = 2.1128e-04
Loss = 7.1343e-02, PNorm = 44.6765, GNorm = 1.3315, lr_0 = 2.0691e-04
Validation rmse = 0.139512
Validation r2 = 0.856433
Validation mse = 0.019463
Epoch 40
Loss = 6.2474e-02, PNorm = 44.6843, GNorm = 1.1322, lr_0 = 2.0264e-04
Loss = 6.8967e-02, PNorm = 44.6907, GNorm = 0.7191, lr_0 = 1.9845e-04
Validation rmse = 0.146915
Validation r2 = 0.840792
Validation mse = 0.021584
Epoch 41
Loss = 3.6098e-02, PNorm = 44.6994, GNorm = 0.4334, lr_0 = 1.9394e-04
Loss = 6.8045e-02, PNorm = 44.7073, GNorm = 0.5093, lr_0 = 1.8993e-04
Validation rmse = 0.152071
Validation r2 = 0.829420
Validation mse = 0.023126
Epoch 42
Loss = 5.5188e-02, PNorm = 44.7131, GNorm = 1.4391, lr_0 = 1.8600e-04
Loss = 6.4893e-02, PNorm = 44.7189, GNorm = 0.5607, lr_0 = 1.8215e-04
Validation rmse = 0.153620
Validation r2 = 0.825927
Validation mse = 0.023599
Epoch 43
Loss = 5.2935e-02, PNorm = 44.7259, GNorm = 0.9581, lr_0 = 1.7801e-04
Loss = 6.1311e-02, PNorm = 44.7306, GNorm = 0.8093, lr_0 = 1.7433e-04
Validation rmse = 0.139468
Validation r2 = 0.856523
Validation mse = 0.019451
Epoch 44
Loss = 6.2387e-02, PNorm = 44.7361, GNorm = 0.8948, lr_0 = 1.7073e-04
Loss = 6.1682e-02, PNorm = 44.7418, GNorm = 1.2287, lr_0 = 1.6720e-04
Validation rmse = 0.146616
Validation r2 = 0.841438
Validation mse = 0.021496
Epoch 45
Loss = 7.4106e-02, PNorm = 44.7484, GNorm = 0.5517, lr_0 = 1.6340e-04
Loss = 6.2121e-02, PNorm = 44.7550, GNorm = 0.8700, lr_0 = 1.6002e-04
Validation rmse = 0.150565
Validation r2 = 0.832782
Validation mse = 0.022670
Epoch 46
Loss = 5.3809e-02, PNorm = 44.7609, GNorm = 1.2324, lr_0 = 1.5671e-04
Loss = 6.1128e-02, PNorm = 44.7670, GNorm = 1.2551, lr_0 = 1.5347e-04
Validation rmse = 0.143385
Validation r2 = 0.848351
Validation mse = 0.020559
Epoch 47
Loss = 5.3073e-02, PNorm = 44.7729, GNorm = 0.8808, lr_0 = 1.4998e-04
Loss = 6.4105e-02, PNorm = 44.7780, GNorm = 0.4628, lr_0 = 1.4688e-04
Validation rmse = 0.144495
Validation r2 = 0.845994
Validation mse = 0.020879
Epoch 48
Loss = 5.7747e-02, PNorm = 44.7839, GNorm = 1.0460, lr_0 = 1.4384e-04
Loss = 6.5433e-02, PNorm = 44.7889, GNorm = 0.5659, lr_0 = 1.4087e-04
Validation rmse = 0.150516
Validation r2 = 0.832890
Validation mse = 0.022655
Epoch 49
Loss = 6.2245e-02, PNorm = 44.7944, GNorm = 1.0419, lr_0 = 1.3767e-04
Loss = 6.0314e-02, PNorm = 44.7991, GNorm = 0.6592, lr_0 = 1.3482e-04
Validation rmse = 0.141973
Validation r2 = 0.851323
Validation mse = 0.020156
Epoch 50
Loss = 5.5890e-02, PNorm = 44.8033, GNorm = 0.7881, lr_0 = 1.3204e-04
Loss = 6.6070e-02, PNorm = 44.8077, GNorm = 1.1170, lr_0 = 1.2930e-04
Validation rmse = 0.155821
Validation r2 = 0.820903
Validation mse = 0.024280
Epoch 51
Loss = 5.1172e-02, PNorm = 44.8118, GNorm = 0.5003, lr_0 = 1.2637e-04
Loss = 6.7304e-02, PNorm = 44.8167, GNorm = 2.1708, lr_0 = 1.2375e-04
Validation rmse = 0.134257
Validation r2 = 0.867044
Validation mse = 0.018025
Epoch 52
Loss = 5.7178e-02, PNorm = 44.8218, GNorm = 0.6200, lr_0 = 1.2094e-04
Loss = 6.1023e-02, PNorm = 44.8250, GNorm = 1.6928, lr_0 = 1.1844e-04
Validation rmse = 0.147414
Validation r2 = 0.839707
Validation mse = 0.021731
Epoch 53
Loss = 5.6589e-02, PNorm = 44.8308, GNorm = 0.8323, lr_0 = 1.1599e-04
Loss = 5.6830e-02, PNorm = 44.8352, GNorm = 0.5916, lr_0 = 1.1359e-04
Validation rmse = 0.146468
Validation r2 = 0.841758
Validation mse = 0.021453
Epoch 54
Loss = 5.8381e-02, PNorm = 44.8401, GNorm = 0.6401, lr_0 = 1.1101e-04
Loss = 5.5034e-02, PNorm = 44.8434, GNorm = 0.6642, lr_0 = 1.0872e-04
Validation rmse = 0.151618
Validation r2 = 0.830435
Validation mse = 0.022988
Epoch 55
Loss = 5.3243e-02, PNorm = 44.8476, GNorm = 0.6805, lr_0 = 1.0647e-04
Loss = 6.0347e-02, PNorm = 44.8513, GNorm = 1.1134, lr_0 = 1.0427e-04
Loss = 4.8725e-02, PNorm = 44.8517, GNorm = 1.4429, lr_0 = 1.0405e-04
Validation rmse = 0.143624
Validation r2 = 0.847844
Validation mse = 0.020628
Epoch 56
Loss = 5.8258e-02, PNorm = 44.8564, GNorm = 1.0147, lr_0 = 1.0190e-04
Loss = 5.4140e-02, PNorm = 44.8602, GNorm = 1.0401, lr_0 = 1.0000e-04
Validation rmse = 0.140608
Validation r2 = 0.854167
Validation mse = 0.019771
Epoch 57
Loss = 5.3466e-02, PNorm = 44.8639, GNorm = 0.4770, lr_0 = 1.0000e-04
Validation rmse = 0.139772
Validation r2 = 0.855896
Validation mse = 0.019536
Epoch 58
Loss = 7.5449e-02, PNorm = 44.8683, GNorm = 1.4503, lr_0 = 1.0000e-04
Loss = 4.9254e-02, PNorm = 44.8724, GNorm = 0.7634, lr_0 = 1.0000e-04
Validation rmse = 0.149391
Validation r2 = 0.835379
Validation mse = 0.022318
Epoch 59
Loss = 4.8921e-02, PNorm = 44.8753, GNorm = 0.6517, lr_0 = 1.0000e-04
Loss = 5.6588e-02, PNorm = 44.8787, GNorm = 0.4969, lr_0 = 1.0000e-04
Validation rmse = 0.132980
Validation r2 = 0.869561
Validation mse = 0.017684
Model 0 best validation rmse = 0.129841 on epoch 11
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.585875
Model 0 test r2 = -3.562766
Model 0 test mse = 0.343249
Ensemble test rmse = 0.585875
Ensemble test r2 = -3.562766
Ensemble test mse = 0.343249
Fold 5
Splitting data with seed 5
Total size = 984 | train size = 974 | val size = 10 | test size = 48
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.1905e-01, PNorm = 43.2626, GNorm = 1.6643, lr_0 = 3.6053e-04
Validation rmse = 0.294118
Validation r2 = 0.112192
Validation mse = 0.086506
Epoch 1
Loss = 6.4586e-01, PNorm = 43.2890, GNorm = 7.9873, lr_0 = 6.2105e-04
Loss = 6.6821e-01, PNorm = 43.3272, GNorm = 6.4696, lr_0 = 8.5789e-04
Validation rmse = 0.245887
Validation r2 = 0.379494
Validation mse = 0.060460
Epoch 2
Loss = 3.4385e-01, PNorm = 43.3977, GNorm = 4.1141, lr_0 = 9.8961e-04
Loss = 4.1968e-01, PNorm = 43.4688, GNorm = 2.0244, lr_0 = 9.6914e-04
Validation rmse = 0.223799
Validation r2 = 0.485967
Validation mse = 0.050086
Epoch 3
Loss = 3.6517e-01, PNorm = 43.5376, GNorm = 9.5783, lr_0 = 9.4910e-04
Loss = 3.4225e-01, PNorm = 43.5918, GNorm = 8.2173, lr_0 = 9.2948e-04
Validation rmse = 0.217245
Validation r2 = 0.515632
Validation mse = 0.047195
Epoch 4
Loss = 1.9732e-01, PNorm = 43.6466, GNorm = 2.8574, lr_0 = 9.0836e-04
Loss = 2.2810e-01, PNorm = 43.6889, GNorm = 4.5458, lr_0 = 8.8958e-04
Validation rmse = 0.207495
Validation r2 = 0.558135
Validation mse = 0.043054
Epoch 5
Loss = 1.8387e-01, PNorm = 43.7227, GNorm = 0.6964, lr_0 = 8.7118e-04
Loss = 2.2256e-01, PNorm = 43.7539, GNorm = 0.9094, lr_0 = 8.5317e-04
Validation rmse = 0.177698
Validation r2 = 0.675929
Validation mse = 0.031577
Epoch 6
Loss = 1.2941e-01, PNorm = 43.7939, GNorm = 3.3756, lr_0 = 8.3378e-04
Loss = 1.6829e-01, PNorm = 43.8255, GNorm = 1.9275, lr_0 = 8.1654e-04
Validation rmse = 0.162081
Validation r2 = 0.730387
Validation mse = 0.026270
Epoch 7
Loss = 1.3774e-01, PNorm = 43.8475, GNorm = 0.6588, lr_0 = 7.9966e-04
Loss = 1.6803e-01, PNorm = 43.8741, GNorm = 3.5974, lr_0 = 7.8312e-04
Validation rmse = 0.182430
Validation r2 = 0.658438
Validation mse = 0.033281
Epoch 8
Loss = 1.4234e-01, PNorm = 43.9072, GNorm = 3.8426, lr_0 = 7.6533e-04
Loss = 1.4713e-01, PNorm = 43.9279, GNorm = 1.1253, lr_0 = 7.4950e-04
Validation rmse = 0.153188
Validation r2 = 0.759164
Validation mse = 0.023466
Epoch 9
Loss = 1.3384e-01, PNorm = 43.9499, GNorm = 0.9031, lr_0 = 7.3400e-04
Loss = 1.3450e-01, PNorm = 43.9708, GNorm = 4.2677, lr_0 = 7.1883e-04
Validation rmse = 0.158196
Validation r2 = 0.743158
Validation mse = 0.025026
Epoch 10
Loss = 1.2623e-01, PNorm = 43.9884, GNorm = 3.9073, lr_0 = 7.0249e-04
Loss = 1.3966e-01, PNorm = 44.0109, GNorm = 2.7839, lr_0 = 6.8797e-04
Validation rmse = 0.167518
Validation r2 = 0.711995
Validation mse = 0.028062
Epoch 11
Loss = 1.1875e-01, PNorm = 44.0351, GNorm = 1.2365, lr_0 = 6.7374e-04
Loss = 1.5362e-01, PNorm = 44.0559, GNorm = 5.8424, lr_0 = 6.5981e-04
Validation rmse = 0.189004
Validation r2 = 0.633378
Validation mse = 0.035723
Epoch 12
Loss = 1.5494e-01, PNorm = 44.0812, GNorm = 5.5579, lr_0 = 6.4482e-04
Loss = 1.6614e-01, PNorm = 44.1062, GNorm = 1.9069, lr_0 = 6.3148e-04
Validation rmse = 0.161833
Validation r2 = 0.731214
Validation mse = 0.026190
Epoch 13
Loss = 1.2646e-01, PNorm = 44.1257, GNorm = 1.4349, lr_0 = 6.1843e-04
Loss = 1.0960e-01, PNorm = 44.1466, GNorm = 1.6274, lr_0 = 6.0564e-04
Validation rmse = 0.138607
Validation r2 = 0.802829
Validation mse = 0.019212
Epoch 14
Loss = 1.1326e-01, PNorm = 44.1619, GNorm = 1.1622, lr_0 = 5.9188e-04
Loss = 1.2200e-01, PNorm = 44.1779, GNorm = 1.7945, lr_0 = 5.7964e-04
Validation rmse = 0.160733
Validation r2 = 0.734853
Validation mse = 0.025835
Epoch 15
Loss = 1.0603e-01, PNorm = 44.1977, GNorm = 0.4065, lr_0 = 5.6765e-04
Loss = 1.2293e-01, PNorm = 44.2153, GNorm = 2.9786, lr_0 = 5.5592e-04
Validation rmse = 0.144949
Validation r2 = 0.784372
Validation mse = 0.021010
Epoch 16
Loss = 9.2643e-02, PNorm = 44.2295, GNorm = 1.1560, lr_0 = 5.4328e-04
Loss = 1.1884e-01, PNorm = 44.2437, GNorm = 0.7544, lr_0 = 5.3205e-04
Validation rmse = 0.144744
Validation r2 = 0.784982
Validation mse = 0.020951
Epoch 17
Loss = 1.0206e-01, PNorm = 44.2589, GNorm = 1.2446, lr_0 = 5.2105e-04
Loss = 1.0244e-01, PNorm = 44.2713, GNorm = 1.0996, lr_0 = 5.1027e-04
Loss = 1.4334e-01, PNorm = 44.2728, GNorm = 2.7087, lr_0 = 5.0921e-04
Validation rmse = 0.150955
Validation r2 = 0.766133
Validation mse = 0.022787
Epoch 18
Loss = 1.1635e-01, PNorm = 44.2860, GNorm = 2.0583, lr_0 = 4.9868e-04
Loss = 9.0427e-02, PNorm = 44.2988, GNorm = 0.8958, lr_0 = 4.8837e-04
Validation rmse = 0.133033
Validation r2 = 0.818367
Validation mse = 0.017698
Epoch 19
Loss = 9.9332e-02, PNorm = 44.3132, GNorm = 1.5772, lr_0 = 4.7827e-04
Validation rmse = 0.150925
Validation r2 = 0.766226
Validation mse = 0.022778
Epoch 20
Loss = 1.1998e-01, PNorm = 44.3257, GNorm = 2.3876, lr_0 = 4.6740e-04
Loss = 1.0093e-01, PNorm = 44.3410, GNorm = 2.0535, lr_0 = 4.5774e-04
Validation rmse = 0.145170
Validation r2 = 0.783713
Validation mse = 0.021074
Epoch 21
Loss = 7.3594e-02, PNorm = 44.3547, GNorm = 1.2010, lr_0 = 4.4827e-04
Loss = 9.1771e-02, PNorm = 44.3662, GNorm = 0.9881, lr_0 = 4.3900e-04
Validation rmse = 0.137498
Validation r2 = 0.805972
Validation mse = 0.018906
Epoch 22
Loss = 9.6806e-02, PNorm = 44.3763, GNorm = 1.2529, lr_0 = 4.2903e-04
Loss = 8.7317e-02, PNorm = 44.3886, GNorm = 1.5497, lr_0 = 4.2016e-04
Validation rmse = 0.137829
Validation r2 = 0.805035
Validation mse = 0.018997
Epoch 23
Loss = 8.4958e-02, PNorm = 44.4000, GNorm = 1.7354, lr_0 = 4.1147e-04
Loss = 9.4209e-02, PNorm = 44.4090, GNorm = 1.1811, lr_0 = 4.0296e-04
Validation rmse = 0.147208
Validation r2 = 0.777598
Validation mse = 0.021670
Epoch 24
Loss = 1.0171e-01, PNorm = 44.4200, GNorm = 0.5048, lr_0 = 3.9381e-04
Loss = 8.3514e-02, PNorm = 44.4304, GNorm = 1.0168, lr_0 = 3.8566e-04
Validation rmse = 0.133711
Validation r2 = 0.816510
Validation mse = 0.017879
Epoch 25
Loss = 7.1493e-02, PNorm = 44.4410, GNorm = 1.1126, lr_0 = 3.7769e-04
Loss = 7.7396e-02, PNorm = 44.4509, GNorm = 0.8723, lr_0 = 3.6988e-04
Validation rmse = 0.139231
Validation r2 = 0.801049
Validation mse = 0.019385
Epoch 26
Loss = 9.0264e-02, PNorm = 44.4618, GNorm = 0.8305, lr_0 = 3.6147e-04
Loss = 7.8268e-02, PNorm = 44.4703, GNorm = 0.7075, lr_0 = 3.5400e-04
Validation rmse = 0.130276
Validation r2 = 0.825819
Validation mse = 0.016972
Epoch 27
Loss = 8.1329e-02, PNorm = 44.4803, GNorm = 2.5232, lr_0 = 3.4596e-04
Loss = 8.5718e-02, PNorm = 44.4909, GNorm = 0.8036, lr_0 = 3.3880e-04
Validation rmse = 0.137462
Validation r2 = 0.806073
Validation mse = 0.018896
Epoch 28
Loss = 8.7587e-02, PNorm = 44.5010, GNorm = 0.6727, lr_0 = 3.3180e-04
Loss = 8.2340e-02, PNorm = 44.5097, GNorm = 1.0201, lr_0 = 3.2494e-04
Validation rmse = 0.140878
Validation r2 = 0.796315
Validation mse = 0.019847
Epoch 29
Loss = 6.9193e-02, PNorm = 44.5201, GNorm = 0.6338, lr_0 = 3.1755e-04
Loss = 9.0318e-02, PNorm = 44.5299, GNorm = 0.4874, lr_0 = 3.1099e-04
Validation rmse = 0.131653
Validation r2 = 0.822117
Validation mse = 0.017332
Epoch 30
Loss = 8.1918e-02, PNorm = 44.5386, GNorm = 1.0755, lr_0 = 3.0456e-04
Loss = 8.3856e-02, PNorm = 44.5471, GNorm = 0.5475, lr_0 = 2.9826e-04
Validation rmse = 0.134794
Validation r2 = 0.813528
Validation mse = 0.018169
Epoch 31
Loss = 6.4022e-02, PNorm = 44.5557, GNorm = 0.8505, lr_0 = 2.9148e-04
Loss = 8.3008e-02, PNorm = 44.5648, GNorm = 2.3667, lr_0 = 2.8545e-04
Validation rmse = 0.133657
Validation r2 = 0.816659
Validation mse = 0.017864
Epoch 32
Loss = 7.7850e-02, PNorm = 44.5721, GNorm = 0.7171, lr_0 = 2.7955e-04
Loss = 7.2007e-02, PNorm = 44.5797, GNorm = 1.1443, lr_0 = 2.7377e-04
Validation rmse = 0.129729
Validation r2 = 0.827277
Validation mse = 0.016830
Epoch 33
Loss = 6.9254e-02, PNorm = 44.5866, GNorm = 1.3650, lr_0 = 2.6755e-04
Loss = 7.9693e-02, PNorm = 44.5958, GNorm = 0.8304, lr_0 = 2.6202e-04
Validation rmse = 0.137587
Validation r2 = 0.805720
Validation mse = 0.018930
Epoch 34
Loss = 7.4830e-02, PNorm = 44.6046, GNorm = 1.6552, lr_0 = 2.5660e-04
Loss = 8.2650e-02, PNorm = 44.6139, GNorm = 1.3266, lr_0 = 2.5129e-04
Validation rmse = 0.135276
Validation r2 = 0.812191
Validation mse = 0.018300
Epoch 35
Loss = 7.3348e-02, PNorm = 44.6240, GNorm = 1.0884, lr_0 = 2.4558e-04
Loss = 7.5491e-02, PNorm = 44.6306, GNorm = 1.3700, lr_0 = 2.4051e-04
Validation rmse = 0.133269
Validation r2 = 0.817721
Validation mse = 0.017761
Epoch 36
Loss = 7.2737e-02, PNorm = 44.6382, GNorm = 2.8986, lr_0 = 2.3553e-04
Loss = 7.8834e-02, PNorm = 44.6446, GNorm = 1.3524, lr_0 = 2.3066e-04
Loss = 1.6228e-01, PNorm = 44.6453, GNorm = 2.3178, lr_0 = 2.3018e-04
Validation rmse = 0.130474
Validation r2 = 0.825287
Validation mse = 0.017024
Epoch 37
Loss = 6.9124e-02, PNorm = 44.6525, GNorm = 1.7135, lr_0 = 2.2542e-04
Loss = 7.1966e-02, PNorm = 44.6605, GNorm = 1.3276, lr_0 = 2.2076e-04
Validation rmse = 0.128892
Validation r2 = 0.829498
Validation mse = 0.016613
Epoch 38
Loss = 6.9496e-02, PNorm = 44.6690, GNorm = 2.2648, lr_0 = 2.1620e-04
Validation rmse = 0.124525
Validation r2 = 0.840858
Validation mse = 0.015506
Epoch 39
Loss = 6.4711e-02, PNorm = 44.6763, GNorm = 1.1054, lr_0 = 2.1128e-04
Loss = 7.3508e-02, PNorm = 44.6816, GNorm = 0.6249, lr_0 = 2.0691e-04
Validation rmse = 0.130648
Validation r2 = 0.824822
Validation mse = 0.017069
Epoch 40
Loss = 7.7012e-02, PNorm = 44.6892, GNorm = 0.7009, lr_0 = 2.0264e-04
Loss = 6.5880e-02, PNorm = 44.6949, GNorm = 0.6409, lr_0 = 1.9845e-04
Validation rmse = 0.127192
Validation r2 = 0.833966
Validation mse = 0.016178
Epoch 41
Loss = 6.7498e-02, PNorm = 44.7033, GNorm = 1.3396, lr_0 = 1.9394e-04
Loss = 6.5817e-02, PNorm = 44.7097, GNorm = 0.6005, lr_0 = 1.8993e-04
Validation rmse = 0.124635
Validation r2 = 0.840574
Validation mse = 0.015534
Epoch 42
Loss = 4.8875e-02, PNorm = 44.7150, GNorm = 0.6769, lr_0 = 1.8600e-04
Loss = 6.5797e-02, PNorm = 44.7211, GNorm = 0.6682, lr_0 = 1.8215e-04
Validation rmse = 0.129194
Validation r2 = 0.828700
Validation mse = 0.016691
Epoch 43
Loss = 7.0464e-02, PNorm = 44.7276, GNorm = 0.9506, lr_0 = 1.7801e-04
Loss = 5.9950e-02, PNorm = 44.7331, GNorm = 0.4383, lr_0 = 1.7433e-04
Validation rmse = 0.125398
Validation r2 = 0.838618
Validation mse = 0.015725
Epoch 44
Loss = 6.1795e-02, PNorm = 44.7383, GNorm = 0.6450, lr_0 = 1.7073e-04
Loss = 6.9065e-02, PNorm = 44.7439, GNorm = 0.6929, lr_0 = 1.6720e-04
Validation rmse = 0.127370
Validation r2 = 0.833501
Validation mse = 0.016223
Epoch 45
Loss = 4.5011e-02, PNorm = 44.7501, GNorm = 0.6503, lr_0 = 1.6340e-04
Loss = 6.0154e-02, PNorm = 44.7548, GNorm = 0.7216, lr_0 = 1.6002e-04
Validation rmse = 0.132446
Validation r2 = 0.819965
Validation mse = 0.017542
Epoch 46
Loss = 5.1077e-02, PNorm = 44.7606, GNorm = 1.1768, lr_0 = 1.5671e-04
Loss = 6.6917e-02, PNorm = 44.7663, GNorm = 1.2564, lr_0 = 1.5347e-04
Validation rmse = 0.122623
Validation r2 = 0.845682
Validation mse = 0.015036
Epoch 47
Loss = 5.7641e-02, PNorm = 44.7727, GNorm = 0.6304, lr_0 = 1.4998e-04
Loss = 5.9602e-02, PNorm = 44.7776, GNorm = 0.9421, lr_0 = 1.4688e-04
Validation rmse = 0.133211
Validation r2 = 0.817881
Validation mse = 0.017745
Epoch 48
Loss = 6.6368e-02, PNorm = 44.7828, GNorm = 0.7682, lr_0 = 1.4384e-04
Loss = 7.3146e-02, PNorm = 44.7882, GNorm = 2.4264, lr_0 = 1.4087e-04
Validation rmse = 0.125965
Validation r2 = 0.837155
Validation mse = 0.015867
Epoch 49
Loss = 6.2795e-02, PNorm = 44.7932, GNorm = 1.9303, lr_0 = 1.3767e-04
Loss = 5.5273e-02, PNorm = 44.7976, GNorm = 0.5348, lr_0 = 1.3482e-04
Validation rmse = 0.124113
Validation r2 = 0.841907
Validation mse = 0.015404
Epoch 50
Loss = 4.4518e-02, PNorm = 44.8017, GNorm = 1.0072, lr_0 = 1.3204e-04
Loss = 7.1516e-02, PNorm = 44.8064, GNorm = 1.0728, lr_0 = 1.2930e-04
Validation rmse = 0.127607
Validation r2 = 0.832881
Validation mse = 0.016284
Epoch 51
Loss = 5.3863e-02, PNorm = 44.8117, GNorm = 0.4921, lr_0 = 1.2637e-04
Loss = 6.0634e-02, PNorm = 44.8157, GNorm = 0.9628, lr_0 = 1.2375e-04
Validation rmse = 0.125391
Validation r2 = 0.838635
Validation mse = 0.015723
Epoch 52
Loss = 5.0183e-02, PNorm = 44.8194, GNorm = 1.3207, lr_0 = 1.2094e-04
Loss = 5.7792e-02, PNorm = 44.8238, GNorm = 0.7248, lr_0 = 1.1844e-04
Validation rmse = 0.124360
Validation r2 = 0.841278
Validation mse = 0.015465
Epoch 53
Loss = 5.3589e-02, PNorm = 44.8278, GNorm = 0.5430, lr_0 = 1.1599e-04
Loss = 5.6450e-02, PNorm = 44.8318, GNorm = 1.8487, lr_0 = 1.1359e-04
Validation rmse = 0.129634
Validation r2 = 0.827530
Validation mse = 0.016805
Epoch 54
Loss = 5.1611e-02, PNorm = 44.8356, GNorm = 0.8002, lr_0 = 1.1101e-04
Loss = 5.8273e-02, PNorm = 44.8394, GNorm = 0.8638, lr_0 = 1.0872e-04
Validation rmse = 0.125431
Validation r2 = 0.838534
Validation mse = 0.015733
Epoch 55
Loss = 5.6997e-02, PNorm = 44.8440, GNorm = 0.7131, lr_0 = 1.0647e-04
Loss = 5.3690e-02, PNorm = 44.8481, GNorm = 0.8304, lr_0 = 1.0427e-04
Loss = 8.1848e-02, PNorm = 44.8485, GNorm = 2.3595, lr_0 = 1.0405e-04
Validation rmse = 0.123909
Validation r2 = 0.842428
Validation mse = 0.015353
Epoch 56
Loss = 5.5692e-02, PNorm = 44.8524, GNorm = 1.0597, lr_0 = 1.0190e-04
Loss = 5.5097e-02, PNorm = 44.8566, GNorm = 0.9233, lr_0 = 1.0000e-04
Validation rmse = 0.124533
Validation r2 = 0.840835
Validation mse = 0.015509
Epoch 57
Loss = 5.3913e-02, PNorm = 44.8603, GNorm = 0.8046, lr_0 = 1.0000e-04
Validation rmse = 0.125079
Validation r2 = 0.839438
Validation mse = 0.015645
Epoch 58
Loss = 6.7054e-02, PNorm = 44.8643, GNorm = 0.8912, lr_0 = 1.0000e-04
Loss = 5.0271e-02, PNorm = 44.8680, GNorm = 0.7650, lr_0 = 1.0000e-04
Validation rmse = 0.126919
Validation r2 = 0.834679
Validation mse = 0.016108
Epoch 59
Loss = 5.1310e-02, PNorm = 44.8717, GNorm = 1.4540, lr_0 = 1.0000e-04
Loss = 4.4606e-02, PNorm = 44.8751, GNorm = 0.8789, lr_0 = 1.0000e-04
Validation rmse = 0.124971
Validation r2 = 0.839714
Validation mse = 0.015618
Model 0 best validation rmse = 0.122623 on epoch 46
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.627748
Model 0 test r2 = -4.238286
Model 0 test mse = 0.394067
Ensemble test rmse = 0.627748
Ensemble test r2 = -4.238286
Ensemble test mse = 0.394067
Fold 6
Splitting data with seed 6
Total size = 984 | train size = 974 | val size = 10 | test size = 48
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.7447e-01, PNorm = 43.2619, GNorm = 1.9618, lr_0 = 3.6053e-04
Validation rmse = 0.349120
Validation r2 = -0.557195
Validation mse = 0.121885
Epoch 1
Loss = 1.0256e+00, PNorm = 43.2814, GNorm = 9.3643, lr_0 = 6.2105e-04
Loss = 7.6848e-01, PNorm = 43.3200, GNorm = 5.6683, lr_0 = 8.5789e-04
Validation rmse = 0.229191
Validation r2 = 0.328894
Validation mse = 0.052529
Epoch 2
Loss = 5.6078e-01, PNorm = 43.4025, GNorm = 2.9777, lr_0 = 9.8961e-04
Loss = 4.1420e-01, PNorm = 43.4857, GNorm = 7.3857, lr_0 = 9.6914e-04
Validation rmse = 0.203029
Validation r2 = 0.473366
Validation mse = 0.041221
Epoch 3
Loss = 3.5886e-01, PNorm = 43.5518, GNorm = 4.4495, lr_0 = 9.4910e-04
Loss = 3.7575e-01, PNorm = 43.6189, GNorm = 3.0675, lr_0 = 9.2948e-04
Validation rmse = 0.190766
Validation r2 = 0.535062
Validation mse = 0.036392
Epoch 4
Loss = 1.7998e-01, PNorm = 43.6741, GNorm = 0.7758, lr_0 = 9.0836e-04
Loss = 2.3970e-01, PNorm = 43.7094, GNorm = 2.5314, lr_0 = 8.8958e-04
Validation rmse = 0.149385
Validation r2 = 0.714893
Validation mse = 0.022316
Epoch 5
Loss = 1.7901e-01, PNorm = 43.7503, GNorm = 1.4628, lr_0 = 8.7118e-04
Loss = 2.1950e-01, PNorm = 43.7886, GNorm = 5.1971, lr_0 = 8.5317e-04
Validation rmse = 0.153979
Validation r2 = 0.697086
Validation mse = 0.023710
Epoch 6
Loss = 2.7255e-01, PNorm = 43.8276, GNorm = 5.5574, lr_0 = 8.3378e-04
Loss = 2.0008e-01, PNorm = 43.8653, GNorm = 0.7355, lr_0 = 8.1654e-04
Validation rmse = 0.163231
Validation r2 = 0.659594
Validation mse = 0.026644
Epoch 7
Loss = 1.6566e-01, PNorm = 43.9018, GNorm = 3.0723, lr_0 = 7.9966e-04
Loss = 1.7985e-01, PNorm = 43.9325, GNorm = 1.3562, lr_0 = 7.8312e-04
Validation rmse = 0.111140
Validation r2 = 0.842191
Validation mse = 0.012352
Epoch 8
Loss = 1.6563e-01, PNorm = 43.9592, GNorm = 1.3523, lr_0 = 7.6533e-04
Loss = 1.3772e-01, PNorm = 43.9825, GNorm = 1.4225, lr_0 = 7.4950e-04
Validation rmse = 0.119420
Validation r2 = 0.817801
Validation mse = 0.014261
Epoch 9
Loss = 1.4240e-01, PNorm = 44.0057, GNorm = 1.5186, lr_0 = 7.3400e-04
Loss = 1.2798e-01, PNorm = 44.0259, GNorm = 1.5164, lr_0 = 7.1883e-04
Validation rmse = 0.108498
Validation r2 = 0.849603
Validation mse = 0.011772
Epoch 10
Loss = 1.4597e-01, PNorm = 44.0525, GNorm = 0.6009, lr_0 = 7.0249e-04
Loss = 1.3524e-01, PNorm = 44.0716, GNorm = 3.7804, lr_0 = 6.8797e-04
Validation rmse = 0.111340
Validation r2 = 0.841623
Validation mse = 0.012396
Epoch 11
Loss = 1.5079e-01, PNorm = 44.0955, GNorm = 1.4362, lr_0 = 6.7374e-04
Loss = 1.2605e-01, PNorm = 44.1205, GNorm = 2.8898, lr_0 = 6.5981e-04
Validation rmse = 0.111962
Validation r2 = 0.839848
Validation mse = 0.012535
Epoch 12
Loss = 1.1710e-01, PNorm = 44.1438, GNorm = 0.6521, lr_0 = 6.4482e-04
Loss = 1.2899e-01, PNorm = 44.1643, GNorm = 1.0231, lr_0 = 6.3148e-04
Validation rmse = 0.132276
Validation r2 = 0.776459
Validation mse = 0.017497
Epoch 13
Loss = 1.1308e-01, PNorm = 44.1851, GNorm = 1.7438, lr_0 = 6.1843e-04
Loss = 1.2289e-01, PNorm = 44.2030, GNorm = 1.3631, lr_0 = 6.0564e-04
Validation rmse = 0.110318
Validation r2 = 0.844517
Validation mse = 0.012170
Epoch 14
Loss = 1.1869e-01, PNorm = 44.2199, GNorm = 1.6328, lr_0 = 5.9188e-04
Loss = 9.7020e-02, PNorm = 44.2364, GNorm = 0.8395, lr_0 = 5.7964e-04
Validation rmse = 0.112664
Validation r2 = 0.837832
Validation mse = 0.012693
Epoch 15
Loss = 1.1176e-01, PNorm = 44.2518, GNorm = 1.2792, lr_0 = 5.6765e-04
Loss = 1.2157e-01, PNorm = 44.2658, GNorm = 0.7662, lr_0 = 5.5592e-04
Validation rmse = 0.102333
Validation r2 = 0.866210
Validation mse = 0.010472
Epoch 16
Loss = 9.8534e-02, PNorm = 44.2799, GNorm = 0.7953, lr_0 = 5.4328e-04
Loss = 1.0462e-01, PNorm = 44.2909, GNorm = 0.7169, lr_0 = 5.3205e-04
Validation rmse = 0.109584
Validation r2 = 0.846577
Validation mse = 0.012009
Epoch 17
Loss = 9.7000e-02, PNorm = 44.3077, GNorm = 2.2567, lr_0 = 5.2105e-04
Loss = 1.0616e-01, PNorm = 44.3204, GNorm = 2.4542, lr_0 = 5.1027e-04
Loss = 7.8815e-02, PNorm = 44.3218, GNorm = 0.7210, lr_0 = 5.0921e-04
Validation rmse = 0.110258
Validation r2 = 0.844684
Validation mse = 0.012157
Epoch 18
Loss = 1.1006e-01, PNorm = 44.3373, GNorm = 1.0852, lr_0 = 4.9868e-04
Loss = 1.0402e-01, PNorm = 44.3518, GNorm = 2.7348, lr_0 = 4.8837e-04
Validation rmse = 0.125195
Validation r2 = 0.799753
Validation mse = 0.015674
Epoch 19
Loss = 9.5702e-02, PNorm = 44.3660, GNorm = 0.5675, lr_0 = 4.7827e-04
Validation rmse = 0.112895
Validation r2 = 0.837166
Validation mse = 0.012745
Epoch 20
Loss = 6.0034e-02, PNorm = 44.3848, GNorm = 0.8687, lr_0 = 4.6740e-04
Loss = 1.1026e-01, PNorm = 44.3997, GNorm = 2.5395, lr_0 = 4.5774e-04
Validation rmse = 0.108860
Validation r2 = 0.848599
Validation mse = 0.011850
Epoch 21
Loss = 7.2902e-02, PNorm = 44.4119, GNorm = 0.9265, lr_0 = 4.4827e-04
Loss = 8.6394e-02, PNorm = 44.4246, GNorm = 0.7471, lr_0 = 4.3900e-04
Validation rmse = 0.116227
Validation r2 = 0.827414
Validation mse = 0.013509
Epoch 22
Loss = 8.1322e-02, PNorm = 44.4397, GNorm = 0.6797, lr_0 = 4.2903e-04
Loss = 8.8301e-02, PNorm = 44.4515, GNorm = 1.1499, lr_0 = 4.2016e-04
Validation rmse = 0.107947
Validation r2 = 0.851126
Validation mse = 0.011653
Epoch 23
Loss = 8.8988e-02, PNorm = 44.4640, GNorm = 2.2706, lr_0 = 4.1147e-04
Loss = 1.0873e-01, PNorm = 44.4799, GNorm = 0.7116, lr_0 = 4.0296e-04
Validation rmse = 0.092457
Validation r2 = 0.890787
Validation mse = 0.008548
Epoch 24
Loss = 9.2277e-02, PNorm = 44.4948, GNorm = 1.3407, lr_0 = 3.9381e-04
Loss = 8.7943e-02, PNorm = 44.5056, GNorm = 1.2384, lr_0 = 3.8566e-04
Validation rmse = 0.102194
Validation r2 = 0.866573
Validation mse = 0.010444
Epoch 25
Loss = 7.1040e-02, PNorm = 44.5163, GNorm = 1.0844, lr_0 = 3.7769e-04
Loss = 7.5484e-02, PNorm = 44.5295, GNorm = 1.5649, lr_0 = 3.6988e-04
Validation rmse = 0.116279
Validation r2 = 0.827259
Validation mse = 0.013521
Epoch 26
Loss = 8.3859e-02, PNorm = 44.5389, GNorm = 1.3244, lr_0 = 3.6147e-04
Loss = 8.4123e-02, PNorm = 44.5509, GNorm = 0.7707, lr_0 = 3.5400e-04
Validation rmse = 0.110770
Validation r2 = 0.843238
Validation mse = 0.012270
Epoch 27
Loss = 8.2481e-02, PNorm = 44.5609, GNorm = 1.2059, lr_0 = 3.4596e-04
Loss = 8.8080e-02, PNorm = 44.5700, GNorm = 0.8536, lr_0 = 3.3880e-04
Validation rmse = 0.114191
Validation r2 = 0.833406
Validation mse = 0.013040
Epoch 28
Loss = 7.7127e-02, PNorm = 44.5780, GNorm = 2.3280, lr_0 = 3.3180e-04
Loss = 8.8884e-02, PNorm = 44.5888, GNorm = 0.6512, lr_0 = 3.2494e-04
Validation rmse = 0.093682
Validation r2 = 0.887873
Validation mse = 0.008776
Epoch 29
Loss = 7.8332e-02, PNorm = 44.5973, GNorm = 1.0219, lr_0 = 3.1755e-04
Loss = 8.1580e-02, PNorm = 44.6054, GNorm = 1.4218, lr_0 = 3.1099e-04
Validation rmse = 0.105245
Validation r2 = 0.858487
Validation mse = 0.011076
Epoch 30
Loss = 8.9888e-02, PNorm = 44.6156, GNorm = 2.1225, lr_0 = 3.0456e-04
Loss = 8.1578e-02, PNorm = 44.6243, GNorm = 2.1993, lr_0 = 2.9826e-04
Validation rmse = 0.107173
Validation r2 = 0.853255
Validation mse = 0.011486
Epoch 31
Loss = 8.9976e-02, PNorm = 44.6338, GNorm = 0.7348, lr_0 = 2.9148e-04
Loss = 8.1226e-02, PNorm = 44.6437, GNorm = 0.8150, lr_0 = 2.8545e-04
Validation rmse = 0.092462
Validation r2 = 0.890775
Validation mse = 0.008549
Epoch 32
Loss = 7.3937e-02, PNorm = 44.6531, GNorm = 0.8893, lr_0 = 2.7955e-04
Loss = 7.1519e-02, PNorm = 44.6611, GNorm = 1.6050, lr_0 = 2.7377e-04
Validation rmse = 0.090647
Validation r2 = 0.895022
Validation mse = 0.008217
Epoch 33
Loss = 5.5082e-02, PNorm = 44.6692, GNorm = 0.5701, lr_0 = 2.6755e-04
Loss = 8.4956e-02, PNorm = 44.6786, GNorm = 0.6108, lr_0 = 2.6202e-04
Validation rmse = 0.107288
Validation r2 = 0.852938
Validation mse = 0.011511
Epoch 34
Loss = 6.1202e-02, PNorm = 44.6866, GNorm = 0.4967, lr_0 = 2.5660e-04
Loss = 8.0630e-02, PNorm = 44.6943, GNorm = 0.5561, lr_0 = 2.5129e-04
Validation rmse = 0.093627
Validation r2 = 0.888006
Validation mse = 0.008766
Epoch 35
Loss = 7.4487e-02, PNorm = 44.7015, GNorm = 0.9905, lr_0 = 2.4558e-04
Loss = 7.3023e-02, PNorm = 44.7088, GNorm = 0.7092, lr_0 = 2.4051e-04
Validation rmse = 0.097672
Validation r2 = 0.878119
Validation mse = 0.009540
Epoch 36
Loss = 6.6918e-02, PNorm = 44.7167, GNorm = 1.0377, lr_0 = 2.3553e-04
Loss = 7.4348e-02, PNorm = 44.7246, GNorm = 1.4396, lr_0 = 2.3066e-04
Loss = 9.1392e-02, PNorm = 44.7254, GNorm = 0.9577, lr_0 = 2.3018e-04
Validation rmse = 0.090363
Validation r2 = 0.895677
Validation mse = 0.008166
Epoch 37
Loss = 6.8409e-02, PNorm = 44.7324, GNorm = 0.5821, lr_0 = 2.2542e-04
Loss = 7.2650e-02, PNorm = 44.7394, GNorm = 1.1746, lr_0 = 2.2076e-04
Validation rmse = 0.098215
Validation r2 = 0.876759
Validation mse = 0.009646
Epoch 38
Loss = 7.2616e-02, PNorm = 44.7479, GNorm = 0.8978, lr_0 = 2.1620e-04
Validation rmse = 0.096459
Validation r2 = 0.881127
Validation mse = 0.009304
Epoch 39
Loss = 1.0030e-01, PNorm = 44.7553, GNorm = 1.2507, lr_0 = 2.1128e-04
Loss = 6.9059e-02, PNorm = 44.7615, GNorm = 0.8971, lr_0 = 2.0691e-04
Validation rmse = 0.097585
Validation r2 = 0.878337
Validation mse = 0.009523
Epoch 40
Loss = 5.7680e-02, PNorm = 44.7686, GNorm = 0.5017, lr_0 = 2.0264e-04
Loss = 7.4912e-02, PNorm = 44.7744, GNorm = 0.8178, lr_0 = 1.9845e-04
Validation rmse = 0.092945
Validation r2 = 0.889630
Validation mse = 0.008639
Epoch 41
Loss = 5.2276e-02, PNorm = 44.7819, GNorm = 1.7295, lr_0 = 1.9394e-04
Loss = 7.5274e-02, PNorm = 44.7889, GNorm = 2.2013, lr_0 = 1.8993e-04
Validation rmse = 0.086750
Validation r2 = 0.903854
Validation mse = 0.007526
Epoch 42
Loss = 5.6407e-02, PNorm = 44.7953, GNorm = 0.6249, lr_0 = 1.8600e-04
Loss = 6.5136e-02, PNorm = 44.8010, GNorm = 1.5479, lr_0 = 1.8215e-04
Validation rmse = 0.097133
Validation r2 = 0.879462
Validation mse = 0.009435
Epoch 43
Loss = 6.2154e-02, PNorm = 44.8078, GNorm = 0.6259, lr_0 = 1.7801e-04
Loss = 7.6857e-02, PNorm = 44.8131, GNorm = 1.4079, lr_0 = 1.7433e-04
Validation rmse = 0.105214
Validation r2 = 0.858570
Validation mse = 0.011070
Epoch 44
Loss = 7.5406e-02, PNorm = 44.8191, GNorm = 1.8326, lr_0 = 1.7073e-04
Loss = 5.9368e-02, PNorm = 44.8262, GNorm = 1.4855, lr_0 = 1.6720e-04
Validation rmse = 0.090904
Validation r2 = 0.894424
Validation mse = 0.008264
Epoch 45
Loss = 4.7620e-02, PNorm = 44.8309, GNorm = 0.5591, lr_0 = 1.6340e-04
Loss = 6.2628e-02, PNorm = 44.8357, GNorm = 1.2129, lr_0 = 1.6002e-04
Validation rmse = 0.094436
Validation r2 = 0.886062
Validation mse = 0.008918
Epoch 46
Loss = 5.9766e-02, PNorm = 44.8420, GNorm = 0.7595, lr_0 = 1.5671e-04
Loss = 5.4737e-02, PNorm = 44.8464, GNorm = 0.4293, lr_0 = 1.5347e-04
Validation rmse = 0.092299
Validation r2 = 0.891159
Validation mse = 0.008519
Epoch 47
Loss = 6.3619e-02, PNorm = 44.8526, GNorm = 1.1917, lr_0 = 1.4998e-04
Loss = 6.2276e-02, PNorm = 44.8571, GNorm = 1.1866, lr_0 = 1.4688e-04
Validation rmse = 0.088604
Validation r2 = 0.899699
Validation mse = 0.007851
Epoch 48
Loss = 5.7266e-02, PNorm = 44.8620, GNorm = 0.7809, lr_0 = 1.4384e-04
Loss = 7.3428e-02, PNorm = 44.8666, GNorm = 0.7631, lr_0 = 1.4087e-04
Validation rmse = 0.093960
Validation r2 = 0.887208
Validation mse = 0.008828
Epoch 49
Loss = 5.5198e-02, PNorm = 44.8727, GNorm = 0.4966, lr_0 = 1.3767e-04
Loss = 6.1108e-02, PNorm = 44.8773, GNorm = 0.9731, lr_0 = 1.3482e-04
Validation rmse = 0.098461
Validation r2 = 0.876142
Validation mse = 0.009695
Epoch 50
Loss = 5.5796e-02, PNorm = 44.8830, GNorm = 0.7145, lr_0 = 1.3204e-04
Loss = 5.7555e-02, PNorm = 44.8877, GNorm = 1.4026, lr_0 = 1.2930e-04
Validation rmse = 0.095484
Validation r2 = 0.883519
Validation mse = 0.009117
Epoch 51
Loss = 5.6721e-02, PNorm = 44.8936, GNorm = 1.4390, lr_0 = 1.2637e-04
Loss = 5.8202e-02, PNorm = 44.8972, GNorm = 0.7020, lr_0 = 1.2375e-04
Validation rmse = 0.095809
Validation r2 = 0.882724
Validation mse = 0.009179
Epoch 52
Loss = 6.1512e-02, PNorm = 44.9014, GNorm = 1.8912, lr_0 = 1.2094e-04
Loss = 5.9943e-02, PNorm = 44.9045, GNorm = 0.8358, lr_0 = 1.1844e-04
Validation rmse = 0.089952
Validation r2 = 0.896626
Validation mse = 0.008091
Epoch 53
Loss = 5.3608e-02, PNorm = 44.9095, GNorm = 0.7502, lr_0 = 1.1599e-04
Loss = 5.9651e-02, PNorm = 44.9131, GNorm = 1.3045, lr_0 = 1.1359e-04
Validation rmse = 0.086406
Validation r2 = 0.904615
Validation mse = 0.007466
Epoch 54
Loss = 5.5875e-02, PNorm = 44.9168, GNorm = 0.6868, lr_0 = 1.1101e-04
Loss = 5.8165e-02, PNorm = 44.9201, GNorm = 1.0817, lr_0 = 1.0872e-04
Validation rmse = 0.093098
Validation r2 = 0.889267
Validation mse = 0.008667
Epoch 55
Loss = 6.0556e-02, PNorm = 44.9235, GNorm = 0.5305, lr_0 = 1.0647e-04
Loss = 5.4964e-02, PNorm = 44.9277, GNorm = 0.4968, lr_0 = 1.0427e-04
Loss = 6.8806e-02, PNorm = 44.9281, GNorm = 1.5826, lr_0 = 1.0405e-04
Validation rmse = 0.098381
Validation r2 = 0.876344
Validation mse = 0.009679
Epoch 56
Loss = 6.1082e-02, PNorm = 44.9325, GNorm = 2.0431, lr_0 = 1.0190e-04
Loss = 5.5687e-02, PNorm = 44.9362, GNorm = 2.2896, lr_0 = 1.0000e-04
Validation rmse = 0.095679
Validation r2 = 0.883042
Validation mse = 0.009155
Epoch 57
Loss = 5.3932e-02, PNorm = 44.9392, GNorm = 0.8810, lr_0 = 1.0000e-04
Validation rmse = 0.095691
Validation r2 = 0.883014
Validation mse = 0.009157
Epoch 58
Loss = 4.2580e-02, PNorm = 44.9424, GNorm = 1.2085, lr_0 = 1.0000e-04
Loss = 5.1852e-02, PNorm = 44.9459, GNorm = 0.7929, lr_0 = 1.0000e-04
Validation rmse = 0.087079
Validation r2 = 0.903123
Validation mse = 0.007583
Epoch 59
Loss = 6.0874e-02, PNorm = 44.9499, GNorm = 1.0255, lr_0 = 1.0000e-04
Loss = 5.3964e-02, PNorm = 44.9541, GNorm = 0.5120, lr_0 = 1.0000e-04
Validation rmse = 0.104063
Validation r2 = 0.861646
Validation mse = 0.010829
Model 0 best validation rmse = 0.086406 on epoch 53
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.614181
Model 0 test r2 = -4.014307
Model 0 test mse = 0.377218
Ensemble test rmse = 0.614181
Ensemble test r2 = -4.014307
Ensemble test mse = 0.377218
Fold 7
Splitting data with seed 7
Total size = 984 | train size = 974 | val size = 10 | test size = 48
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.1018e-01, PNorm = 43.2626, GNorm = 3.8859, lr_0 = 3.6053e-04
Validation rmse = 0.249323
Validation r2 = 0.451765
Validation mse = 0.062162
Epoch 1
Loss = 8.5464e-01, PNorm = 43.2905, GNorm = 9.1799, lr_0 = 6.2105e-04
Loss = 5.3247e-01, PNorm = 43.3382, GNorm = 2.7406, lr_0 = 8.5789e-04
Validation rmse = 0.154984
Validation r2 = 0.788157
Validation mse = 0.024020
Epoch 2
Loss = 3.9063e-01, PNorm = 43.4187, GNorm = 6.9211, lr_0 = 9.8961e-04
Loss = 3.1522e-01, PNorm = 43.4879, GNorm = 3.7692, lr_0 = 9.6914e-04
Validation rmse = 0.136710
Validation r2 = 0.835168
Validation mse = 0.018690
Epoch 3
Loss = 2.2398e-01, PNorm = 43.5538, GNorm = 2.8985, lr_0 = 9.4910e-04
Loss = 2.6741e-01, PNorm = 43.6033, GNorm = 1.0056, lr_0 = 9.2948e-04
Validation rmse = 0.200381
Validation r2 = 0.645876
Validation mse = 0.040153
Epoch 4
Loss = 3.3180e-01, PNorm = 43.6613, GNorm = 7.2388, lr_0 = 9.0836e-04
Loss = 2.1210e-01, PNorm = 43.6987, GNorm = 1.3697, lr_0 = 8.8958e-04
Validation rmse = 0.152734
Validation r2 = 0.794264
Validation mse = 0.023328
Epoch 5
Loss = 1.9243e-01, PNorm = 43.7436, GNorm = 1.3948, lr_0 = 8.7118e-04
Loss = 1.9055e-01, PNorm = 43.7894, GNorm = 2.2141, lr_0 = 8.5317e-04
Validation rmse = 0.136297
Validation r2 = 0.836162
Validation mse = 0.018577
Epoch 6
Loss = 1.5105e-01, PNorm = 43.8194, GNorm = 1.9173, lr_0 = 8.3378e-04
Loss = 1.7685e-01, PNorm = 43.8466, GNorm = 3.1389, lr_0 = 8.1654e-04
Validation rmse = 0.150750
Validation r2 = 0.799574
Validation mse = 0.022725
Epoch 7
Loss = 1.5527e-01, PNorm = 43.8758, GNorm = 1.5304, lr_0 = 7.9966e-04
Loss = 1.7021e-01, PNorm = 43.9058, GNorm = 6.4469, lr_0 = 7.8312e-04
Validation rmse = 0.167033
Validation r2 = 0.753939
Validation mse = 0.027900
Epoch 8
Loss = 1.4280e-01, PNorm = 43.9329, GNorm = 1.9660, lr_0 = 7.6533e-04
Loss = 1.4035e-01, PNorm = 43.9566, GNorm = 1.4870, lr_0 = 7.4950e-04
Validation rmse = 0.182010
Validation r2 = 0.707834
Validation mse = 0.033128
Epoch 9
Loss = 1.6812e-01, PNorm = 43.9838, GNorm = 3.3453, lr_0 = 7.3400e-04
Loss = 1.6029e-01, PNorm = 44.0066, GNorm = 1.4890, lr_0 = 7.1883e-04
Validation rmse = 0.158017
Validation r2 = 0.779784
Validation mse = 0.024969
Epoch 10
Loss = 1.3422e-01, PNorm = 44.0350, GNorm = 1.4864, lr_0 = 7.0249e-04
Loss = 1.3979e-01, PNorm = 44.0623, GNorm = 2.5448, lr_0 = 6.8797e-04
Validation rmse = 0.142221
Validation r2 = 0.821611
Validation mse = 0.020227
Epoch 11
Loss = 1.0239e-01, PNorm = 44.0836, GNorm = 0.9007, lr_0 = 6.7374e-04
Loss = 1.2766e-01, PNorm = 44.0999, GNorm = 1.6198, lr_0 = 6.5981e-04
Validation rmse = 0.136882
Validation r2 = 0.834752
Validation mse = 0.018737
Epoch 12
Loss = 1.3457e-01, PNorm = 44.1189, GNorm = 1.6286, lr_0 = 6.4482e-04
Loss = 1.1484e-01, PNorm = 44.1361, GNorm = 0.9593, lr_0 = 6.3148e-04
Validation rmse = 0.154654
Validation r2 = 0.789057
Validation mse = 0.023918
Epoch 13
Loss = 1.3492e-01, PNorm = 44.1523, GNorm = 1.7624, lr_0 = 6.1843e-04
Loss = 1.1728e-01, PNorm = 44.1662, GNorm = 0.7446, lr_0 = 6.0564e-04
Validation rmse = 0.129217
Validation r2 = 0.852741
Validation mse = 0.016697
Epoch 14
Loss = 1.1017e-01, PNorm = 44.1816, GNorm = 0.9010, lr_0 = 5.9188e-04
Loss = 1.3236e-01, PNorm = 44.2026, GNorm = 2.7949, lr_0 = 5.7964e-04
Validation rmse = 0.176953
Validation r2 = 0.723842
Validation mse = 0.031312
Epoch 15
Loss = 1.0547e-01, PNorm = 44.2168, GNorm = 2.1866, lr_0 = 5.6765e-04
Loss = 1.0208e-01, PNorm = 44.2316, GNorm = 1.6539, lr_0 = 5.5592e-04
Validation rmse = 0.148301
Validation r2 = 0.806032
Validation mse = 0.021993
Epoch 16
Loss = 1.0013e-01, PNorm = 44.2478, GNorm = 1.1872, lr_0 = 5.4328e-04
Loss = 1.2583e-01, PNorm = 44.2594, GNorm = 2.0575, lr_0 = 5.3205e-04
Validation rmse = 0.178781
Validation r2 = 0.718108
Validation mse = 0.031963
Epoch 17
Loss = 1.4054e-01, PNorm = 44.2776, GNorm = 1.9139, lr_0 = 5.2105e-04
Loss = 1.1515e-01, PNorm = 44.2946, GNorm = 4.3621, lr_0 = 5.1027e-04
Loss = 8.6418e-02, PNorm = 44.2958, GNorm = 0.6496, lr_0 = 5.0921e-04
Validation rmse = 0.155063
Validation r2 = 0.787941
Validation mse = 0.024045
Epoch 18
Loss = 1.0526e-01, PNorm = 44.3125, GNorm = 1.8338, lr_0 = 4.9868e-04
Loss = 9.6471e-02, PNorm = 44.3239, GNorm = 0.7910, lr_0 = 4.8837e-04
Validation rmse = 0.152464
Validation r2 = 0.794991
Validation mse = 0.023245
Epoch 19
Loss = 8.3186e-02, PNorm = 44.3356, GNorm = 1.0289, lr_0 = 4.7827e-04
Validation rmse = 0.138022
Validation r2 = 0.831989
Validation mse = 0.019050
Epoch 20
Loss = 6.5657e-02, PNorm = 44.3451, GNorm = 0.4421, lr_0 = 4.6740e-04
Loss = 8.4697e-02, PNorm = 44.3541, GNorm = 1.6951, lr_0 = 4.5774e-04
Validation rmse = 0.165857
Validation r2 = 0.757391
Validation mse = 0.027508
Epoch 21
Loss = 9.7809e-02, PNorm = 44.3669, GNorm = 1.0624, lr_0 = 4.4827e-04
Loss = 9.1502e-02, PNorm = 44.3801, GNorm = 0.7009, lr_0 = 4.3900e-04
Validation rmse = 0.149567
Validation r2 = 0.802705
Validation mse = 0.022370
Epoch 22
Loss = 9.0506e-02, PNorm = 44.3904, GNorm = 3.1508, lr_0 = 4.2903e-04
Loss = 1.0701e-01, PNorm = 44.4022, GNorm = 2.2467, lr_0 = 4.2016e-04
Validation rmse = 0.150350
Validation r2 = 0.800637
Validation mse = 0.022605
Epoch 23
Loss = 7.1909e-02, PNorm = 44.4145, GNorm = 0.5377, lr_0 = 4.1147e-04
Loss = 9.7119e-02, PNorm = 44.4242, GNorm = 0.6314, lr_0 = 4.0296e-04
Validation rmse = 0.183094
Validation r2 = 0.704342
Validation mse = 0.033523
Epoch 24
Loss = 7.3975e-02, PNorm = 44.4395, GNorm = 0.8957, lr_0 = 3.9381e-04
Loss = 8.2638e-02, PNorm = 44.4504, GNorm = 1.0512, lr_0 = 3.8566e-04
Validation rmse = 0.138211
Validation r2 = 0.831529
Validation mse = 0.019102
Epoch 25
Loss = 8.3090e-02, PNorm = 44.4609, GNorm = 0.7343, lr_0 = 3.7769e-04
Loss = 8.2154e-02, PNorm = 44.4712, GNorm = 0.5059, lr_0 = 3.6988e-04
Validation rmse = 0.148611
Validation r2 = 0.805221
Validation mse = 0.022085
Epoch 26
Loss = 7.0429e-02, PNorm = 44.4794, GNorm = 0.7419, lr_0 = 3.6147e-04
Loss = 8.1770e-02, PNorm = 44.4886, GNorm = 1.5768, lr_0 = 3.5400e-04
Validation rmse = 0.144542
Validation r2 = 0.815741
Validation mse = 0.020892
Epoch 27
Loss = 7.5351e-02, PNorm = 44.4972, GNorm = 0.9079, lr_0 = 3.4596e-04
Loss = 8.8846e-02, PNorm = 44.5037, GNorm = 2.3852, lr_0 = 3.3880e-04
Validation rmse = 0.155401
Validation r2 = 0.787015
Validation mse = 0.024149
Epoch 28
Loss = 7.5261e-02, PNorm = 44.5152, GNorm = 1.8467, lr_0 = 3.3180e-04
Loss = 1.0678e-01, PNorm = 44.5252, GNorm = 2.8550, lr_0 = 3.2494e-04
Validation rmse = 0.137783
Validation r2 = 0.832571
Validation mse = 0.018984
Epoch 29
Loss = 8.3919e-02, PNorm = 44.5369, GNorm = 1.4406, lr_0 = 3.1755e-04
Loss = 8.6869e-02, PNorm = 44.5447, GNorm = 1.6548, lr_0 = 3.1099e-04
Validation rmse = 0.146405
Validation r2 = 0.810961
Validation mse = 0.021434
Epoch 30
Loss = 6.9456e-02, PNorm = 44.5508, GNorm = 0.8727, lr_0 = 3.0456e-04
Loss = 8.9152e-02, PNorm = 44.5603, GNorm = 0.9160, lr_0 = 2.9826e-04
Validation rmse = 0.165846
Validation r2 = 0.757421
Validation mse = 0.027505
Epoch 31
Loss = 7.3084e-02, PNorm = 44.5725, GNorm = 0.9879, lr_0 = 2.9148e-04
Loss = 7.7788e-02, PNorm = 44.5798, GNorm = 0.9609, lr_0 = 2.8545e-04
Validation rmse = 0.141081
Validation r2 = 0.824460
Validation mse = 0.019904
Epoch 32
Loss = 6.7180e-02, PNorm = 44.5868, GNorm = 0.5889, lr_0 = 2.7955e-04
Loss = 7.8464e-02, PNorm = 44.5949, GNorm = 1.5165, lr_0 = 2.7377e-04
Validation rmse = 0.165823
Validation r2 = 0.757490
Validation mse = 0.027497
Epoch 33
Loss = 6.4568e-02, PNorm = 44.6040, GNorm = 1.2885, lr_0 = 2.6755e-04
Loss = 8.0525e-02, PNorm = 44.6129, GNorm = 1.0507, lr_0 = 2.6202e-04
Validation rmse = 0.151171
Validation r2 = 0.798453
Validation mse = 0.022853
Epoch 34
Loss = 8.6833e-02, PNorm = 44.6219, GNorm = 1.1764, lr_0 = 2.5660e-04
Loss = 7.2360e-02, PNorm = 44.6288, GNorm = 1.8638, lr_0 = 2.5129e-04
Validation rmse = 0.154975
Validation r2 = 0.788181
Validation mse = 0.024017
Epoch 35
Loss = 8.5060e-02, PNorm = 44.6359, GNorm = 2.5704, lr_0 = 2.4558e-04
Loss = 7.2934e-02, PNorm = 44.6431, GNorm = 1.5073, lr_0 = 2.4051e-04
Validation rmse = 0.159504
Validation r2 = 0.775620
Validation mse = 0.025442
Epoch 36
Loss = 7.2639e-02, PNorm = 44.6538, GNorm = 1.1033, lr_0 = 2.3553e-04
Loss = 7.6187e-02, PNorm = 44.6592, GNorm = 0.4872, lr_0 = 2.3066e-04
Loss = 9.4295e-02, PNorm = 44.6599, GNorm = 0.9876, lr_0 = 2.3018e-04
Validation rmse = 0.149589
Validation r2 = 0.802648
Validation mse = 0.022377
Epoch 37
Loss = 6.8382e-02, PNorm = 44.6660, GNorm = 0.4238, lr_0 = 2.2542e-04
Loss = 7.8549e-02, PNorm = 44.6738, GNorm = 0.8302, lr_0 = 2.2076e-04
Validation rmse = 0.156611
Validation r2 = 0.783685
Validation mse = 0.024527
Epoch 38
Loss = 7.4941e-02, PNorm = 44.6805, GNorm = 1.0881, lr_0 = 2.1620e-04
Validation rmse = 0.150108
Validation r2 = 0.801276
Validation mse = 0.022532
Epoch 39
Loss = 6.0166e-02, PNorm = 44.6883, GNorm = 0.5166, lr_0 = 2.1128e-04
Loss = 7.4234e-02, PNorm = 44.6958, GNorm = 1.1540, lr_0 = 2.0691e-04
Validation rmse = 0.145844
Validation r2 = 0.812405
Validation mse = 0.021271
Epoch 40
Loss = 7.4942e-02, PNorm = 44.7017, GNorm = 0.6418, lr_0 = 2.0264e-04
Loss = 6.5489e-02, PNorm = 44.7075, GNorm = 0.7693, lr_0 = 1.9845e-04
Validation rmse = 0.147617
Validation r2 = 0.807818
Validation mse = 0.021791
Epoch 41
Loss = 6.5504e-02, PNorm = 44.7158, GNorm = 0.4858, lr_0 = 1.9394e-04
Loss = 7.1700e-02, PNorm = 44.7214, GNorm = 1.2237, lr_0 = 1.8993e-04
Validation rmse = 0.149601
Validation r2 = 0.802617
Validation mse = 0.022380
Epoch 42
Loss = 5.9122e-02, PNorm = 44.7277, GNorm = 1.0884, lr_0 = 1.8600e-04
Loss = 7.5956e-02, PNorm = 44.7348, GNorm = 0.6136, lr_0 = 1.8215e-04
Validation rmse = 0.143006
Validation r2 = 0.819635
Validation mse = 0.020451
Epoch 43
Loss = 5.9931e-02, PNorm = 44.7406, GNorm = 0.9813, lr_0 = 1.7801e-04
Loss = 6.6840e-02, PNorm = 44.7461, GNorm = 1.2076, lr_0 = 1.7433e-04
Validation rmse = 0.144028
Validation r2 = 0.817048
Validation mse = 0.020744
Epoch 44
Loss = 4.5662e-02, PNorm = 44.7522, GNorm = 1.5796, lr_0 = 1.7073e-04
Loss = 6.7429e-02, PNorm = 44.7583, GNorm = 0.6132, lr_0 = 1.6720e-04
Validation rmse = 0.142388
Validation r2 = 0.821192
Validation mse = 0.020274
Epoch 45
Loss = 5.7945e-02, PNorm = 44.7643, GNorm = 2.3200, lr_0 = 1.6340e-04
Loss = 6.8713e-02, PNorm = 44.7692, GNorm = 1.5313, lr_0 = 1.6002e-04
Validation rmse = 0.136447
Validation r2 = 0.835802
Validation mse = 0.018618
Epoch 46
Loss = 6.1086e-02, PNorm = 44.7749, GNorm = 1.0475, lr_0 = 1.5671e-04
Loss = 5.7618e-02, PNorm = 44.7811, GNorm = 0.6663, lr_0 = 1.5347e-04
Validation rmse = 0.146840
Validation r2 = 0.809835
Validation mse = 0.021562
Epoch 47
Loss = 5.9668e-02, PNorm = 44.7855, GNorm = 1.0362, lr_0 = 1.4998e-04
Loss = 6.1903e-02, PNorm = 44.7902, GNorm = 0.5658, lr_0 = 1.4688e-04
Validation rmse = 0.138878
Validation r2 = 0.829899
Validation mse = 0.019287
Epoch 48
Loss = 5.8446e-02, PNorm = 44.7960, GNorm = 0.6885, lr_0 = 1.4384e-04
Loss = 6.5542e-02, PNorm = 44.7998, GNorm = 0.8583, lr_0 = 1.4087e-04
Validation rmse = 0.144617
Validation r2 = 0.815548
Validation mse = 0.020914
Epoch 49
Loss = 6.2973e-02, PNorm = 44.8057, GNorm = 0.7519, lr_0 = 1.3767e-04
Loss = 5.3863e-02, PNorm = 44.8105, GNorm = 0.5092, lr_0 = 1.3482e-04
Validation rmse = 0.150403
Validation r2 = 0.800494
Validation mse = 0.022621
Epoch 50
Loss = 5.5065e-02, PNorm = 44.8151, GNorm = 0.5971, lr_0 = 1.3204e-04
Loss = 6.1216e-02, PNorm = 44.8196, GNorm = 0.8850, lr_0 = 1.2930e-04
Validation rmse = 0.139450
Validation r2 = 0.828495
Validation mse = 0.019446
Epoch 51
Loss = 6.3893e-02, PNorm = 44.8239, GNorm = 1.0260, lr_0 = 1.2637e-04
Loss = 5.0715e-02, PNorm = 44.8273, GNorm = 0.6693, lr_0 = 1.2375e-04
Validation rmse = 0.139908
Validation r2 = 0.827366
Validation mse = 0.019574
Epoch 52
Loss = 5.9678e-02, PNorm = 44.8321, GNorm = 0.9182, lr_0 = 1.2094e-04
Loss = 5.0632e-02, PNorm = 44.8371, GNorm = 1.3434, lr_0 = 1.1844e-04
Validation rmse = 0.144446
Validation r2 = 0.815985
Validation mse = 0.020865
Epoch 53
Loss = 5.3657e-02, PNorm = 44.8406, GNorm = 0.5650, lr_0 = 1.1599e-04
Loss = 5.8288e-02, PNorm = 44.8441, GNorm = 0.7255, lr_0 = 1.1359e-04
Validation rmse = 0.136130
Validation r2 = 0.836564
Validation mse = 0.018531
Epoch 54
Loss = 6.1191e-02, PNorm = 44.8495, GNorm = 1.2668, lr_0 = 1.1101e-04
Loss = 5.5232e-02, PNorm = 44.8527, GNorm = 1.4990, lr_0 = 1.0872e-04
Validation rmse = 0.146293
Validation r2 = 0.811250
Validation mse = 0.021402
Epoch 55
Loss = 6.3994e-02, PNorm = 44.8565, GNorm = 0.8623, lr_0 = 1.0647e-04
Loss = 6.3707e-02, PNorm = 44.8604, GNorm = 0.7170, lr_0 = 1.0427e-04
Loss = 6.4390e-02, PNorm = 44.8608, GNorm = 1.9211, lr_0 = 1.0405e-04
Validation rmse = 0.143822
Validation r2 = 0.817572
Validation mse = 0.020685
Epoch 56
Loss = 4.8139e-02, PNorm = 44.8647, GNorm = 1.0588, lr_0 = 1.0190e-04
Loss = 5.6852e-02, PNorm = 44.8678, GNorm = 1.0677, lr_0 = 1.0000e-04
Validation rmse = 0.141733
Validation r2 = 0.822834
Validation mse = 0.020088
Epoch 57
Loss = 4.9757e-02, PNorm = 44.8713, GNorm = 0.3281, lr_0 = 1.0000e-04
Validation rmse = 0.143146
Validation r2 = 0.819283
Validation mse = 0.020491
Epoch 58
Loss = 6.3925e-02, PNorm = 44.8749, GNorm = 0.6840, lr_0 = 1.0000e-04
Loss = 5.5110e-02, PNorm = 44.8792, GNorm = 0.7608, lr_0 = 1.0000e-04
Validation rmse = 0.148289
Validation r2 = 0.806063
Validation mse = 0.021990
Epoch 59
Loss = 6.1399e-02, PNorm = 44.8822, GNorm = 1.3226, lr_0 = 1.0000e-04
Loss = 5.4173e-02, PNorm = 44.8856, GNorm = 1.4904, lr_0 = 1.0000e-04
Validation rmse = 0.136750
Validation r2 = 0.835072
Validation mse = 0.018701
Model 0 best validation rmse = 0.129217 on epoch 13
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.582270
Model 0 test r2 = -3.506787
Model 0 test mse = 0.339038
Ensemble test rmse = 0.582270
Ensemble test r2 = -3.506787
Ensemble test mse = 0.339038
Fold 8
Splitting data with seed 8
Total size = 984 | train size = 974 | val size = 10 | test size = 48
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.9680e-01, PNorm = 43.2624, GNorm = 2.5426, lr_0 = 3.6053e-04
Validation rmse = 0.225380
Validation r2 = -0.070599
Validation mse = 0.050796
Epoch 1
Loss = 4.7874e-01, PNorm = 43.2898, GNorm = 1.6865, lr_0 = 6.2105e-04
Loss = 6.1058e-01, PNorm = 43.3287, GNorm = 3.5376, lr_0 = 8.5789e-04
Validation rmse = 0.239498
Validation r2 = -0.208925
Validation mse = 0.057359
Epoch 2
Loss = 4.9287e-01, PNorm = 43.4042, GNorm = 4.9362, lr_0 = 9.8961e-04
Loss = 3.5509e-01, PNorm = 43.4798, GNorm = 2.6389, lr_0 = 9.6914e-04
Validation rmse = 0.212054
Validation r2 = 0.052264
Validation mse = 0.044967
Epoch 3
Loss = 2.4519e-01, PNorm = 43.5416, GNorm = 1.1247, lr_0 = 9.4910e-04
Loss = 2.2885e-01, PNorm = 43.5966, GNorm = 1.3574, lr_0 = 9.2948e-04
Validation rmse = 0.127015
Validation r2 = 0.659980
Validation mse = 0.016133
Epoch 4
Loss = 2.1986e-01, PNorm = 43.6535, GNorm = 6.8052, lr_0 = 9.0836e-04
Loss = 2.1414e-01, PNorm = 43.6951, GNorm = 3.6854, lr_0 = 8.8958e-04
Validation rmse = 0.229114
Validation r2 = -0.106364
Validation mse = 0.052493
Epoch 5
Loss = 2.0663e-01, PNorm = 43.7403, GNorm = 1.6360, lr_0 = 8.7118e-04
Loss = 2.0863e-01, PNorm = 43.7768, GNorm = 0.9885, lr_0 = 8.5317e-04
Validation rmse = 0.116716
Validation r2 = 0.712883
Validation mse = 0.013623
Epoch 6
Loss = 1.4657e-01, PNorm = 43.8096, GNorm = 3.6529, lr_0 = 8.3378e-04
Loss = 1.8193e-01, PNorm = 43.8419, GNorm = 7.1774, lr_0 = 8.1654e-04
Validation rmse = 0.099780
Validation r2 = 0.790164
Validation mse = 0.009956
Epoch 7
Loss = 1.9851e-01, PNorm = 43.8631, GNorm = 5.2244, lr_0 = 7.9966e-04
Loss = 1.7480e-01, PNorm = 43.8924, GNorm = 4.7213, lr_0 = 7.8312e-04
Validation rmse = 0.126301
Validation r2 = 0.663789
Validation mse = 0.015952
Epoch 8
Loss = 1.6448e-01, PNorm = 43.9220, GNorm = 2.3765, lr_0 = 7.6533e-04
Loss = 1.4097e-01, PNorm = 43.9490, GNorm = 2.0422, lr_0 = 7.4950e-04
Validation rmse = 0.130708
Validation r2 = 0.639922
Validation mse = 0.017084
Epoch 9
Loss = 1.5151e-01, PNorm = 43.9675, GNorm = 3.2452, lr_0 = 7.3400e-04
Loss = 1.1869e-01, PNorm = 43.9890, GNorm = 0.7407, lr_0 = 7.1883e-04
Validation rmse = 0.142687
Validation r2 = 0.570897
Validation mse = 0.020359
Epoch 10
Loss = 1.0669e-01, PNorm = 44.0156, GNorm = 1.0628, lr_0 = 7.0249e-04
Loss = 1.3271e-01, PNorm = 44.0381, GNorm = 0.5413, lr_0 = 6.8797e-04
Validation rmse = 0.155603
Validation r2 = 0.489694
Validation mse = 0.024212
Epoch 11
Loss = 1.4370e-01, PNorm = 44.0581, GNorm = 1.2315, lr_0 = 6.7374e-04
Loss = 1.0291e-01, PNorm = 44.0770, GNorm = 0.7611, lr_0 = 6.5981e-04
Validation rmse = 0.105740
Validation r2 = 0.764344
Validation mse = 0.011181
Epoch 12
Loss = 1.0538e-01, PNorm = 44.0935, GNorm = 2.7857, lr_0 = 6.4482e-04
Loss = 1.1729e-01, PNorm = 44.1109, GNorm = 1.7330, lr_0 = 6.3148e-04
Validation rmse = 0.141700
Validation r2 = 0.576810
Validation mse = 0.020079
Epoch 13
Loss = 1.2766e-01, PNorm = 44.1271, GNorm = 3.3074, lr_0 = 6.1843e-04
Loss = 1.3574e-01, PNorm = 44.1426, GNorm = 4.0242, lr_0 = 6.0564e-04
Validation rmse = 0.116379
Validation r2 = 0.714539
Validation mse = 0.013544
Epoch 14
Loss = 1.0446e-01, PNorm = 44.1659, GNorm = 3.0603, lr_0 = 5.9188e-04
Loss = 1.0988e-01, PNorm = 44.1842, GNorm = 2.0922, lr_0 = 5.7964e-04
Validation rmse = 0.129856
Validation r2 = 0.644596
Validation mse = 0.016863
Epoch 15
Loss = 1.1355e-01, PNorm = 44.1995, GNorm = 2.4762, lr_0 = 5.6765e-04
Loss = 1.1314e-01, PNorm = 44.2134, GNorm = 2.2642, lr_0 = 5.5592e-04
Validation rmse = 0.134387
Validation r2 = 0.619363
Validation mse = 0.018060
Epoch 16
Loss = 1.1150e-01, PNorm = 44.2267, GNorm = 3.9137, lr_0 = 5.4328e-04
Loss = 1.2520e-01, PNorm = 44.2461, GNorm = 2.3716, lr_0 = 5.3205e-04
Validation rmse = 0.125812
Validation r2 = 0.666387
Validation mse = 0.015829
Epoch 17
Loss = 1.1933e-01, PNorm = 44.2588, GNorm = 2.7505, lr_0 = 5.2105e-04
Loss = 1.1205e-01, PNorm = 44.2741, GNorm = 1.1103, lr_0 = 5.1027e-04
Loss = 1.4759e-01, PNorm = 44.2757, GNorm = 1.6532, lr_0 = 5.0921e-04
Validation rmse = 0.203865
Validation r2 = 0.124044
Validation mse = 0.041561
Epoch 18
Loss = 1.2570e-01, PNorm = 44.2937, GNorm = 2.6655, lr_0 = 4.9868e-04
Loss = 1.0815e-01, PNorm = 44.3135, GNorm = 1.7691, lr_0 = 4.8837e-04
Validation rmse = 0.121756
Validation r2 = 0.687555
Validation mse = 0.014824
Epoch 19
Loss = 9.3952e-02, PNorm = 44.3277, GNorm = 1.3103, lr_0 = 4.7827e-04
Validation rmse = 0.106574
Validation r2 = 0.760616
Validation mse = 0.011358
Epoch 20
Loss = 1.7672e-01, PNorm = 44.3407, GNorm = 2.3813, lr_0 = 4.6740e-04
Loss = 1.1477e-01, PNorm = 44.3580, GNorm = 3.3912, lr_0 = 4.5774e-04
Validation rmse = 0.122704
Validation r2 = 0.682670
Validation mse = 0.015056
Epoch 21
Loss = 1.1583e-01, PNorm = 44.3728, GNorm = 1.6337, lr_0 = 4.4827e-04
Loss = 9.5973e-02, PNorm = 44.3850, GNorm = 0.7641, lr_0 = 4.3900e-04
Validation rmse = 0.151377
Validation r2 = 0.517037
Validation mse = 0.022915
Epoch 22
Loss = 9.0605e-02, PNorm = 44.3969, GNorm = 0.7744, lr_0 = 4.2903e-04
Loss = 9.2971e-02, PNorm = 44.4079, GNorm = 2.4936, lr_0 = 4.2016e-04
Validation rmse = 0.145601
Validation r2 = 0.553186
Validation mse = 0.021200
Epoch 23
Loss = 8.5132e-02, PNorm = 44.4176, GNorm = 0.9783, lr_0 = 4.1147e-04
Loss = 9.0691e-02, PNorm = 44.4276, GNorm = 1.3013, lr_0 = 4.0296e-04
Validation rmse = 0.119906
Validation r2 = 0.696975
Validation mse = 0.014377
Epoch 24
Loss = 1.3916e-01, PNorm = 44.4394, GNorm = 2.7174, lr_0 = 3.9381e-04
Loss = 9.7712e-02, PNorm = 44.4534, GNorm = 2.3577, lr_0 = 3.8566e-04
Validation rmse = 0.119354
Validation r2 = 0.699758
Validation mse = 0.014245
Epoch 25
Loss = 9.7719e-02, PNorm = 44.4658, GNorm = 0.5598, lr_0 = 3.7769e-04
Loss = 9.1452e-02, PNorm = 44.4774, GNorm = 1.5602, lr_0 = 3.6988e-04
Validation rmse = 0.144189
Validation r2 = 0.561815
Validation mse = 0.020790
Epoch 26
Loss = 9.0484e-02, PNorm = 44.4897, GNorm = 1.4221, lr_0 = 3.6147e-04
Loss = 8.0671e-02, PNorm = 44.5010, GNorm = 0.9673, lr_0 = 3.5400e-04
Validation rmse = 0.141619
Validation r2 = 0.577293
Validation mse = 0.020056
Epoch 27
Loss = 8.5117e-02, PNorm = 44.5122, GNorm = 2.0727, lr_0 = 3.4596e-04
Loss = 7.2991e-02, PNorm = 44.5215, GNorm = 1.8173, lr_0 = 3.3880e-04
Validation rmse = 0.137791
Validation r2 = 0.599837
Validation mse = 0.018986
Epoch 28
Loss = 8.9874e-02, PNorm = 44.5293, GNorm = 0.5867, lr_0 = 3.3180e-04
Loss = 7.9982e-02, PNorm = 44.5375, GNorm = 0.7766, lr_0 = 3.2494e-04
Validation rmse = 0.123979
Validation r2 = 0.676039
Validation mse = 0.015371
Epoch 29
Loss = 8.5182e-02, PNorm = 44.5475, GNorm = 1.6043, lr_0 = 3.1755e-04
Loss = 8.2461e-02, PNorm = 44.5566, GNorm = 1.0401, lr_0 = 3.1099e-04
Validation rmse = 0.136512
Validation r2 = 0.607233
Validation mse = 0.018635
Epoch 30
Loss = 7.3669e-02, PNorm = 44.5666, GNorm = 0.6819, lr_0 = 3.0456e-04
Loss = 7.3849e-02, PNorm = 44.5755, GNorm = 1.4767, lr_0 = 2.9826e-04
Validation rmse = 0.153538
Validation r2 = 0.503148
Validation mse = 0.023574
Epoch 31
Loss = 7.7444e-02, PNorm = 44.5833, GNorm = 0.9374, lr_0 = 2.9148e-04
Loss = 8.7258e-02, PNorm = 44.5921, GNorm = 0.4367, lr_0 = 2.8545e-04
Validation rmse = 0.143087
Validation r2 = 0.568486
Validation mse = 0.020474
Epoch 32
Loss = 7.0221e-02, PNorm = 44.6000, GNorm = 0.9356, lr_0 = 2.7955e-04
Loss = 7.6897e-02, PNorm = 44.6071, GNorm = 0.6482, lr_0 = 2.7377e-04
Validation rmse = 0.143864
Validation r2 = 0.563786
Validation mse = 0.020697
Epoch 33
Loss = 7.2920e-02, PNorm = 44.6174, GNorm = 2.7559, lr_0 = 2.6755e-04
Loss = 8.0126e-02, PNorm = 44.6246, GNorm = 0.8557, lr_0 = 2.6202e-04
Validation rmse = 0.126623
Validation r2 = 0.662076
Validation mse = 0.016033
Epoch 34
Loss = 6.1392e-02, PNorm = 44.6298, GNorm = 0.6008, lr_0 = 2.5660e-04
Loss = 7.8558e-02, PNorm = 44.6390, GNorm = 0.8224, lr_0 = 2.5129e-04
Validation rmse = 0.157963
Validation r2 = 0.474100
Validation mse = 0.024952
Epoch 35
Loss = 7.2801e-02, PNorm = 44.6479, GNorm = 0.6880, lr_0 = 2.4558e-04
Loss = 6.7598e-02, PNorm = 44.6551, GNorm = 0.5714, lr_0 = 2.4051e-04
Validation rmse = 0.142230
Validation r2 = 0.573638
Validation mse = 0.020229
Epoch 36
Loss = 5.9564e-02, PNorm = 44.6636, GNorm = 1.3111, lr_0 = 2.3553e-04
Loss = 7.9113e-02, PNorm = 44.6712, GNorm = 0.8814, lr_0 = 2.3066e-04
Loss = 7.3782e-02, PNorm = 44.6718, GNorm = 1.8783, lr_0 = 2.3018e-04
Validation rmse = 0.147605
Validation r2 = 0.540804
Validation mse = 0.021787
Epoch 37
Loss = 6.6392e-02, PNorm = 44.6773, GNorm = 2.2132, lr_0 = 2.2542e-04
Loss = 7.0759e-02, PNorm = 44.6831, GNorm = 1.2027, lr_0 = 2.2076e-04
Validation rmse = 0.147383
Validation r2 = 0.542183
Validation mse = 0.021722
Epoch 38
Loss = 7.2387e-02, PNorm = 44.6906, GNorm = 0.4911, lr_0 = 2.1620e-04
Validation rmse = 0.154432
Validation r2 = 0.497346
Validation mse = 0.023849
Epoch 39
Loss = 6.2243e-02, PNorm = 44.6986, GNorm = 1.1951, lr_0 = 2.1128e-04
Loss = 7.2394e-02, PNorm = 44.7069, GNorm = 1.2237, lr_0 = 2.0691e-04
Validation rmse = 0.151800
Validation r2 = 0.514335
Validation mse = 0.023043
Epoch 40
Loss = 4.2833e-02, PNorm = 44.7134, GNorm = 0.8614, lr_0 = 2.0264e-04
Loss = 7.0399e-02, PNorm = 44.7193, GNorm = 0.6726, lr_0 = 1.9845e-04
Validation rmse = 0.158813
Validation r2 = 0.468419
Validation mse = 0.025222
Epoch 41
Loss = 6.7430e-02, PNorm = 44.7274, GNorm = 1.3297, lr_0 = 1.9394e-04
Loss = 6.8032e-02, PNorm = 44.7344, GNorm = 0.7969, lr_0 = 1.8993e-04
Validation rmse = 0.156474
Validation r2 = 0.483961
Validation mse = 0.024484
Epoch 42
Loss = 5.5620e-02, PNorm = 44.7405, GNorm = 0.9716, lr_0 = 1.8600e-04
Loss = 6.5038e-02, PNorm = 44.7461, GNorm = 1.0820, lr_0 = 1.8215e-04
Validation rmse = 0.170287
Validation r2 = 0.388832
Validation mse = 0.028998
Epoch 43
Loss = 7.2487e-02, PNorm = 44.7533, GNorm = 2.6575, lr_0 = 1.7801e-04
Loss = 7.1393e-02, PNorm = 44.7593, GNorm = 0.7646, lr_0 = 1.7433e-04
Validation rmse = 0.154468
Validation r2 = 0.497112
Validation mse = 0.023860
Epoch 44
Loss = 5.3941e-02, PNorm = 44.7654, GNorm = 2.3471, lr_0 = 1.7073e-04
Loss = 6.8170e-02, PNorm = 44.7715, GNorm = 1.1485, lr_0 = 1.6720e-04
Validation rmse = 0.140279
Validation r2 = 0.585258
Validation mse = 0.019678
Epoch 45
Loss = 5.6241e-02, PNorm = 44.7776, GNorm = 1.0660, lr_0 = 1.6340e-04
Loss = 6.6330e-02, PNorm = 44.7832, GNorm = 0.5586, lr_0 = 1.6002e-04
Validation rmse = 0.176123
Validation r2 = 0.346223
Validation mse = 0.031019
Epoch 46
Loss = 5.8256e-02, PNorm = 44.7886, GNorm = 0.4389, lr_0 = 1.5671e-04
Loss = 6.1826e-02, PNorm = 44.7927, GNorm = 0.6471, lr_0 = 1.5347e-04
Validation rmse = 0.148495
Validation r2 = 0.535252
Validation mse = 0.022051
Epoch 47
Loss = 5.9128e-02, PNorm = 44.7982, GNorm = 0.6010, lr_0 = 1.4998e-04
Loss = 5.9577e-02, PNorm = 44.8045, GNorm = 0.5232, lr_0 = 1.4688e-04
Validation rmse = 0.156876
Validation r2 = 0.481310
Validation mse = 0.024610
Epoch 48
Loss = 4.3881e-02, PNorm = 44.8102, GNorm = 0.5720, lr_0 = 1.4384e-04
Loss = 6.2515e-02, PNorm = 44.8144, GNorm = 1.2819, lr_0 = 1.4087e-04
Validation rmse = 0.151884
Validation r2 = 0.513794
Validation mse = 0.023069
Epoch 49
Loss = 5.9183e-02, PNorm = 44.8197, GNorm = 0.9234, lr_0 = 1.3767e-04
Loss = 6.0060e-02, PNorm = 44.8250, GNorm = 2.5757, lr_0 = 1.3482e-04
Validation rmse = 0.182317
Validation r2 = 0.299436
Validation mse = 0.033239
Epoch 50
Loss = 6.2414e-02, PNorm = 44.8299, GNorm = 2.0064, lr_0 = 1.3204e-04
Loss = 6.7421e-02, PNorm = 44.8350, GNorm = 1.0181, lr_0 = 1.2930e-04
Validation rmse = 0.151018
Validation r2 = 0.519324
Validation mse = 0.022806
Epoch 51
Loss = 5.2442e-02, PNorm = 44.8397, GNorm = 0.5032, lr_0 = 1.2637e-04
Loss = 5.7343e-02, PNorm = 44.8441, GNorm = 0.6907, lr_0 = 1.2375e-04
Validation rmse = 0.158499
Validation r2 = 0.470520
Validation mse = 0.025122
Epoch 52
Loss = 5.7309e-02, PNorm = 44.8486, GNorm = 0.4651, lr_0 = 1.2094e-04
Loss = 5.3604e-02, PNorm = 44.8531, GNorm = 0.6261, lr_0 = 1.1844e-04
Validation rmse = 0.177717
Validation r2 = 0.334340
Validation mse = 0.031583
Epoch 53
Loss = 4.9044e-02, PNorm = 44.8573, GNorm = 0.4586, lr_0 = 1.1599e-04
Loss = 5.5369e-02, PNorm = 44.8617, GNorm = 0.9520, lr_0 = 1.1359e-04
Validation rmse = 0.161938
Validation r2 = 0.447298
Validation mse = 0.026224
Epoch 54
Loss = 5.1034e-02, PNorm = 44.8667, GNorm = 1.2561, lr_0 = 1.1101e-04
Loss = 5.2361e-02, PNorm = 44.8705, GNorm = 0.4858, lr_0 = 1.0872e-04
Validation rmse = 0.172603
Validation r2 = 0.372098
Validation mse = 0.029792
Epoch 55
Loss = 5.6074e-02, PNorm = 44.8745, GNorm = 0.7440, lr_0 = 1.0647e-04
Loss = 5.2360e-02, PNorm = 44.8783, GNorm = 0.9082, lr_0 = 1.0427e-04
Loss = 2.3426e-02, PNorm = 44.8787, GNorm = 0.8379, lr_0 = 1.0405e-04
Validation rmse = 0.169153
Validation r2 = 0.396949
Validation mse = 0.028613
Epoch 56
Loss = 4.8585e-02, PNorm = 44.8830, GNorm = 0.9272, lr_0 = 1.0190e-04
Loss = 5.8713e-02, PNorm = 44.8866, GNorm = 1.2665, lr_0 = 1.0000e-04
Validation rmse = 0.183809
Validation r2 = 0.287921
Validation mse = 0.033786
Epoch 57
Loss = 5.1516e-02, PNorm = 44.8904, GNorm = 0.3738, lr_0 = 1.0000e-04
Validation rmse = 0.167596
Validation r2 = 0.408000
Validation mse = 0.028088
Epoch 58
Loss = 6.2539e-02, PNorm = 44.8947, GNorm = 1.0048, lr_0 = 1.0000e-04
Loss = 5.3826e-02, PNorm = 44.8984, GNorm = 0.5635, lr_0 = 1.0000e-04
Validation rmse = 0.157319
Validation r2 = 0.478373
Validation mse = 0.024749
Epoch 59
Loss = 5.3738e-02, PNorm = 44.9021, GNorm = 0.8263, lr_0 = 1.0000e-04
Loss = 4.4928e-02, PNorm = 44.9057, GNorm = 0.5385, lr_0 = 1.0000e-04
Validation rmse = 0.170396
Validation r2 = 0.388053
Validation mse = 0.029035
Model 0 best validation rmse = 0.099780 on epoch 6
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.653451
Model 0 test r2 = -4.676029
Model 0 test mse = 0.426998
Ensemble test rmse = 0.653451
Ensemble test r2 = -4.676029
Ensemble test mse = 0.426998
Fold 9
Splitting data with seed 9
Total size = 984 | train size = 974 | val size = 10 | test size = 48
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.0789e-01, PNorm = 43.2626, GNorm = 3.8250, lr_0 = 3.6053e-04
Validation rmse = 0.198175
Validation r2 = 0.683569
Validation mse = 0.039273
Epoch 1
Loss = 5.5751e-01, PNorm = 43.2886, GNorm = 2.0970, lr_0 = 6.2105e-04
Loss = 5.4801e-01, PNorm = 43.3346, GNorm = 6.4705, lr_0 = 8.5789e-04
Validation rmse = 0.156446
Validation r2 = 0.802798
Validation mse = 0.024475
Epoch 2
Loss = 5.2161e-01, PNorm = 43.4144, GNorm = 6.5404, lr_0 = 9.8961e-04
Loss = 3.6163e-01, PNorm = 43.4883, GNorm = 1.4430, lr_0 = 9.6914e-04
Validation rmse = 0.166245
Validation r2 = 0.777321
Validation mse = 0.027637
Epoch 3
Loss = 2.9531e-01, PNorm = 43.5508, GNorm = 6.0045, lr_0 = 9.4910e-04
Loss = 2.7344e-01, PNorm = 43.6012, GNorm = 1.1973, lr_0 = 9.2948e-04
Validation rmse = 0.127835
Validation r2 = 0.868333
Validation mse = 0.016342
Epoch 4
Loss = 1.7786e-01, PNorm = 43.6518, GNorm = 2.1308, lr_0 = 9.0836e-04
Loss = 2.0349e-01, PNorm = 43.6933, GNorm = 4.0083, lr_0 = 8.8958e-04
Validation rmse = 0.089849
Validation r2 = 0.934956
Validation mse = 0.008073
Epoch 5
Loss = 2.0995e-01, PNorm = 43.7228, GNorm = 6.2493, lr_0 = 8.7118e-04
Loss = 2.2666e-01, PNorm = 43.7523, GNorm = 0.8225, lr_0 = 8.5317e-04
Validation rmse = 0.126144
Validation r2 = 0.871793
Validation mse = 0.015912
Epoch 6
Loss = 2.0469e-01, PNorm = 43.7894, GNorm = 2.0830, lr_0 = 8.3378e-04
Loss = 1.5486e-01, PNorm = 43.8217, GNorm = 0.7586, lr_0 = 8.1654e-04
Validation rmse = 0.107793
Validation r2 = 0.906381
Validation mse = 0.011619
Epoch 7
Loss = 1.6239e-01, PNorm = 43.8461, GNorm = 4.5278, lr_0 = 7.9966e-04
Loss = 1.4305e-01, PNorm = 43.8702, GNorm = 1.7060, lr_0 = 7.8312e-04
Validation rmse = 0.091332
Validation r2 = 0.932791
Validation mse = 0.008342
Epoch 8
Loss = 1.2943e-01, PNorm = 43.8888, GNorm = 1.8737, lr_0 = 7.6533e-04
Loss = 1.3197e-01, PNorm = 43.9113, GNorm = 1.6320, lr_0 = 7.4950e-04
Validation rmse = 0.075817
Validation r2 = 0.953686
Validation mse = 0.005748
Epoch 9
Loss = 1.7476e-01, PNorm = 43.9347, GNorm = 4.5101, lr_0 = 7.3400e-04
Loss = 1.4297e-01, PNorm = 43.9579, GNorm = 1.9516, lr_0 = 7.1883e-04
Validation rmse = 0.136376
Validation r2 = 0.850151
Validation mse = 0.018598
Epoch 10
Loss = 1.9154e-01, PNorm = 43.9801, GNorm = 1.2205, lr_0 = 7.0249e-04
Loss = 1.3069e-01, PNorm = 44.0034, GNorm = 2.9448, lr_0 = 6.8797e-04
Validation rmse = 0.072539
Validation r2 = 0.957604
Validation mse = 0.005262
Epoch 11
Loss = 1.3746e-01, PNorm = 44.0225, GNorm = 1.9715, lr_0 = 6.7374e-04
Loss = 1.3482e-01, PNorm = 44.0415, GNorm = 0.6166, lr_0 = 6.5981e-04
Validation rmse = 0.075899
Validation r2 = 0.953586
Validation mse = 0.005761
Epoch 12
Loss = 1.1932e-01, PNorm = 44.0655, GNorm = 1.3497, lr_0 = 6.4482e-04
Loss = 1.3973e-01, PNorm = 44.0838, GNorm = 2.1218, lr_0 = 6.3148e-04
Validation rmse = 0.094724
Validation r2 = 0.927706
Validation mse = 0.008973
Epoch 13
Loss = 1.2658e-01, PNorm = 44.1067, GNorm = 1.4117, lr_0 = 6.1843e-04
Loss = 1.1702e-01, PNorm = 44.1241, GNorm = 1.2504, lr_0 = 6.0564e-04
Validation rmse = 0.085351
Validation r2 = 0.941306
Validation mse = 0.007285
Epoch 14
Loss = 1.0041e-01, PNorm = 44.1409, GNorm = 0.7574, lr_0 = 5.9188e-04
Loss = 1.2004e-01, PNorm = 44.1616, GNorm = 0.8206, lr_0 = 5.7964e-04
Validation rmse = 0.110571
Validation r2 = 0.901494
Validation mse = 0.012226
Epoch 15
Loss = 1.3153e-01, PNorm = 44.1758, GNorm = 1.1686, lr_0 = 5.6765e-04
Loss = 1.0536e-01, PNorm = 44.1917, GNorm = 1.6127, lr_0 = 5.5592e-04
Validation rmse = 0.046261
Validation r2 = 0.982757
Validation mse = 0.002140
Epoch 16
Loss = 1.0770e-01, PNorm = 44.2106, GNorm = 0.9026, lr_0 = 5.4328e-04
Loss = 9.7437e-02, PNorm = 44.2256, GNorm = 1.3472, lr_0 = 5.3205e-04
Validation rmse = 0.069444
Validation r2 = 0.961145
Validation mse = 0.004822
Epoch 17
Loss = 1.0214e-01, PNorm = 44.2420, GNorm = 2.1033, lr_0 = 5.2105e-04
Loss = 9.8342e-02, PNorm = 44.2554, GNorm = 1.3433, lr_0 = 5.1027e-04
Loss = 1.2887e-01, PNorm = 44.2564, GNorm = 1.3587, lr_0 = 5.0921e-04
Validation rmse = 0.070156
Validation r2 = 0.960344
Validation mse = 0.004922
Epoch 18
Loss = 1.1167e-01, PNorm = 44.2702, GNorm = 0.7908, lr_0 = 4.9868e-04
Loss = 9.9942e-02, PNorm = 44.2854, GNorm = 0.4959, lr_0 = 4.8837e-04
Validation rmse = 0.078655
Validation r2 = 0.950154
Validation mse = 0.006187
Epoch 19
Loss = 1.0413e-01, PNorm = 44.3000, GNorm = 1.5490, lr_0 = 4.7827e-04
Validation rmse = 0.067687
Validation r2 = 0.963086
Validation mse = 0.004582
Epoch 20
Loss = 9.1386e-02, PNorm = 44.3168, GNorm = 1.5781, lr_0 = 4.6740e-04
Loss = 1.0869e-01, PNorm = 44.3317, GNorm = 1.7452, lr_0 = 4.5774e-04
Validation rmse = 0.088455
Validation r2 = 0.936959
Validation mse = 0.007824
Epoch 21
Loss = 8.6300e-02, PNorm = 44.3473, GNorm = 1.6121, lr_0 = 4.4827e-04
Loss = 9.7228e-02, PNorm = 44.3632, GNorm = 0.9137, lr_0 = 4.3900e-04
Validation rmse = 0.063108
Validation r2 = 0.967912
Validation mse = 0.003983
Epoch 22
Loss = 9.9417e-02, PNorm = 44.3770, GNorm = 2.3883, lr_0 = 4.2903e-04
Loss = 9.3530e-02, PNorm = 44.3899, GNorm = 0.8639, lr_0 = 4.2016e-04
Validation rmse = 0.078703
Validation r2 = 0.950093
Validation mse = 0.006194
Epoch 23
Loss = 8.3260e-02, PNorm = 44.4000, GNorm = 0.7422, lr_0 = 4.1147e-04
Loss = 1.0405e-01, PNorm = 44.4116, GNorm = 0.6803, lr_0 = 4.0296e-04
Validation rmse = 0.065948
Validation r2 = 0.964958
Validation mse = 0.004349
Epoch 24
Loss = 8.3859e-02, PNorm = 44.4242, GNorm = 0.6565, lr_0 = 3.9381e-04
Loss = 9.5260e-02, PNorm = 44.4341, GNorm = 2.1802, lr_0 = 3.8566e-04
Validation rmse = 0.059653
Validation r2 = 0.971328
Validation mse = 0.003559
Epoch 25
Loss = 8.4193e-02, PNorm = 44.4452, GNorm = 2.4372, lr_0 = 3.7769e-04
Loss = 9.6630e-02, PNorm = 44.4566, GNorm = 1.2734, lr_0 = 3.6988e-04
Validation rmse = 0.060431
Validation r2 = 0.970576
Validation mse = 0.003652
Epoch 26
Loss = 7.1304e-02, PNorm = 44.4670, GNorm = 0.6197, lr_0 = 3.6147e-04
Loss = 8.7638e-02, PNorm = 44.4765, GNorm = 1.1523, lr_0 = 3.5400e-04
Validation rmse = 0.071399
Validation r2 = 0.958926
Validation mse = 0.005098
Epoch 27
Loss = 7.4786e-02, PNorm = 44.4873, GNorm = 0.6126, lr_0 = 3.4596e-04
Loss = 9.0482e-02, PNorm = 44.4960, GNorm = 2.4407, lr_0 = 3.3880e-04
Validation rmse = 0.098792
Validation r2 = 0.921363
Validation mse = 0.009760
Epoch 28
Loss = 9.4662e-02, PNorm = 44.5074, GNorm = 1.3598, lr_0 = 3.3180e-04
Loss = 8.7556e-02, PNorm = 44.5169, GNorm = 1.2003, lr_0 = 3.2494e-04
Validation rmse = 0.059792
Validation r2 = 0.971195
Validation mse = 0.003575
Epoch 29
Loss = 7.8357e-02, PNorm = 44.5290, GNorm = 0.9586, lr_0 = 3.1755e-04
Loss = 8.5005e-02, PNorm = 44.5378, GNorm = 1.1133, lr_0 = 3.1099e-04
Validation rmse = 0.079426
Validation r2 = 0.949172
Validation mse = 0.006308
Epoch 30
Loss = 6.6795e-02, PNorm = 44.5480, GNorm = 0.6520, lr_0 = 3.0456e-04
Loss = 8.5601e-02, PNorm = 44.5588, GNorm = 0.7230, lr_0 = 2.9826e-04
Validation rmse = 0.068088
Validation r2 = 0.962647
Validation mse = 0.004636
Epoch 31
Loss = 9.5227e-02, PNorm = 44.5657, GNorm = 2.2378, lr_0 = 2.9148e-04
Loss = 8.1066e-02, PNorm = 44.5744, GNorm = 2.7076, lr_0 = 2.8545e-04
Validation rmse = 0.058415
Validation r2 = 0.972507
Validation mse = 0.003412
Epoch 32
Loss = 8.7006e-02, PNorm = 44.5841, GNorm = 2.3802, lr_0 = 2.7955e-04
Loss = 6.9877e-02, PNorm = 44.5944, GNorm = 1.8132, lr_0 = 2.7377e-04
Validation rmse = 0.061083
Validation r2 = 0.969938
Validation mse = 0.003731
Epoch 33
Loss = 8.9434e-02, PNorm = 44.6018, GNorm = 2.8207, lr_0 = 2.6755e-04
Loss = 7.3414e-02, PNorm = 44.6105, GNorm = 1.9395, lr_0 = 2.6202e-04
Validation rmse = 0.080155
Validation r2 = 0.948234
Validation mse = 0.006425
Epoch 34
Loss = 7.6658e-02, PNorm = 44.6197, GNorm = 0.8341, lr_0 = 2.5660e-04
Loss = 7.5069e-02, PNorm = 44.6273, GNorm = 0.7084, lr_0 = 2.5129e-04
Validation rmse = 0.076332
Validation r2 = 0.953054
Validation mse = 0.005827
Epoch 35
Loss = 8.0687e-02, PNorm = 44.6359, GNorm = 0.8045, lr_0 = 2.4558e-04
Loss = 6.3687e-02, PNorm = 44.6437, GNorm = 1.1254, lr_0 = 2.4051e-04
Validation rmse = 0.053501
Validation r2 = 0.976938
Validation mse = 0.002862
Epoch 36
Loss = 6.6899e-02, PNorm = 44.6504, GNorm = 0.8535, lr_0 = 2.3553e-04
Loss = 7.4454e-02, PNorm = 44.6586, GNorm = 1.1625, lr_0 = 2.3066e-04
Loss = 6.3403e-02, PNorm = 44.6593, GNorm = 0.6100, lr_0 = 2.3018e-04
Validation rmse = 0.059669
Validation r2 = 0.971313
Validation mse = 0.003560
Epoch 37
Loss = 6.8644e-02, PNorm = 44.6666, GNorm = 1.5995, lr_0 = 2.2542e-04
Loss = 7.0620e-02, PNorm = 44.6743, GNorm = 1.1398, lr_0 = 2.2076e-04
Validation rmse = 0.081068
Validation r2 = 0.947048
Validation mse = 0.006572
Epoch 38
Loss = 6.9294e-02, PNorm = 44.6810, GNorm = 1.0051, lr_0 = 2.1620e-04
Validation rmse = 0.076098
Validation r2 = 0.953342
Validation mse = 0.005791
Epoch 39
Loss = 5.4380e-02, PNorm = 44.6898, GNorm = 1.2961, lr_0 = 2.1128e-04
Loss = 7.1104e-02, PNorm = 44.6972, GNorm = 1.2698, lr_0 = 2.0691e-04
Validation rmse = 0.067554
Validation r2 = 0.963231
Validation mse = 0.004564
Epoch 40
Loss = 6.2726e-02, PNorm = 44.7055, GNorm = 0.8460, lr_0 = 2.0264e-04
Loss = 7.2056e-02, PNorm = 44.7127, GNorm = 1.0400, lr_0 = 1.9845e-04
Validation rmse = 0.068750
Validation r2 = 0.961918
Validation mse = 0.004727
Epoch 41
Loss = 7.4539e-02, PNorm = 44.7204, GNorm = 1.7380, lr_0 = 1.9394e-04
Loss = 6.8707e-02, PNorm = 44.7276, GNorm = 0.6693, lr_0 = 1.8993e-04
Validation rmse = 0.076152
Validation r2 = 0.953276
Validation mse = 0.005799
Epoch 42
Loss = 8.6364e-02, PNorm = 44.7344, GNorm = 0.9359, lr_0 = 1.8600e-04
Loss = 6.3077e-02, PNorm = 44.7404, GNorm = 1.9384, lr_0 = 1.8215e-04
Validation rmse = 0.076989
Validation r2 = 0.952243
Validation mse = 0.005927
Epoch 43
Loss = 5.4520e-02, PNorm = 44.7475, GNorm = 0.8113, lr_0 = 1.7801e-04
Loss = 6.5109e-02, PNorm = 44.7537, GNorm = 0.8448, lr_0 = 1.7433e-04
Validation rmse = 0.062880
Validation r2 = 0.968143
Validation mse = 0.003954
Epoch 44
Loss = 5.4875e-02, PNorm = 44.7596, GNorm = 0.3381, lr_0 = 1.7073e-04
Loss = 6.4783e-02, PNorm = 44.7666, GNorm = 1.1322, lr_0 = 1.6720e-04
Validation rmse = 0.062237
Validation r2 = 0.968792
Validation mse = 0.003873
Epoch 45
Loss = 5.6888e-02, PNorm = 44.7720, GNorm = 0.4078, lr_0 = 1.6340e-04
Loss = 6.1974e-02, PNorm = 44.7779, GNorm = 0.5156, lr_0 = 1.6002e-04
Validation rmse = 0.077621
Validation r2 = 0.951455
Validation mse = 0.006025
Epoch 46
Loss = 7.0904e-02, PNorm = 44.7833, GNorm = 1.5185, lr_0 = 1.5671e-04
Loss = 6.2304e-02, PNorm = 44.7900, GNorm = 0.8650, lr_0 = 1.5347e-04
Validation rmse = 0.064081
Validation r2 = 0.966915
Validation mse = 0.004106
Epoch 47
Loss = 6.2251e-02, PNorm = 44.7964, GNorm = 1.4236, lr_0 = 1.4998e-04
Loss = 5.7110e-02, PNorm = 44.8021, GNorm = 1.8113, lr_0 = 1.4688e-04
Validation rmse = 0.073316
Validation r2 = 0.956690
Validation mse = 0.005375
Epoch 48
Loss = 5.1483e-02, PNorm = 44.8078, GNorm = 0.8447, lr_0 = 1.4384e-04
Loss = 6.4961e-02, PNorm = 44.8125, GNorm = 0.4373, lr_0 = 1.4087e-04
Validation rmse = 0.074840
Validation r2 = 0.954872
Validation mse = 0.005601
Epoch 49
Loss = 5.8710e-02, PNorm = 44.8185, GNorm = 0.7003, lr_0 = 1.3767e-04
Loss = 5.7056e-02, PNorm = 44.8237, GNorm = 1.3439, lr_0 = 1.3482e-04
Validation rmse = 0.078788
Validation r2 = 0.949984
Validation mse = 0.006208
Epoch 50
Loss = 5.6328e-02, PNorm = 44.8281, GNorm = 0.4152, lr_0 = 1.3204e-04
Loss = 5.8891e-02, PNorm = 44.8333, GNorm = 0.7390, lr_0 = 1.2930e-04
Validation rmse = 0.070591
Validation r2 = 0.959850
Validation mse = 0.004983
Epoch 51
Loss = 5.2725e-02, PNorm = 44.8385, GNorm = 0.7795, lr_0 = 1.2637e-04
Loss = 5.4372e-02, PNorm = 44.8428, GNorm = 0.7585, lr_0 = 1.2375e-04
Validation rmse = 0.081235
Validation r2 = 0.946830
Validation mse = 0.006599
Epoch 52
Loss = 5.7788e-02, PNorm = 44.8477, GNorm = 0.4617, lr_0 = 1.2094e-04
Loss = 5.2670e-02, PNorm = 44.8524, GNorm = 1.2187, lr_0 = 1.1844e-04
Validation rmse = 0.070909
Validation r2 = 0.959488
Validation mse = 0.005028
Epoch 53
Loss = 5.1254e-02, PNorm = 44.8576, GNorm = 0.7322, lr_0 = 1.1599e-04
Loss = 5.6867e-02, PNorm = 44.8613, GNorm = 1.3892, lr_0 = 1.1359e-04
Validation rmse = 0.068524
Validation r2 = 0.962168
Validation mse = 0.004695
Epoch 54
Loss = 5.0258e-02, PNorm = 44.8661, GNorm = 0.5106, lr_0 = 1.1101e-04
Loss = 5.6228e-02, PNorm = 44.8694, GNorm = 0.8010, lr_0 = 1.0872e-04
Validation rmse = 0.076792
Validation r2 = 0.952486
Validation mse = 0.005897
Epoch 55
Loss = 5.0397e-02, PNorm = 44.8740, GNorm = 0.7801, lr_0 = 1.0647e-04
Loss = 5.6360e-02, PNorm = 44.8783, GNorm = 1.5928, lr_0 = 1.0427e-04
Loss = 4.5255e-02, PNorm = 44.8786, GNorm = 1.6165, lr_0 = 1.0405e-04
Validation rmse = 0.073832
Validation r2 = 0.956079
Validation mse = 0.005451
Epoch 56
Loss = 5.2464e-02, PNorm = 44.8833, GNorm = 0.7377, lr_0 = 1.0190e-04
Loss = 5.3131e-02, PNorm = 44.8865, GNorm = 0.9447, lr_0 = 1.0000e-04
Validation rmse = 0.066586
Validation r2 = 0.964277
Validation mse = 0.004434
Epoch 57
Loss = 5.0500e-02, PNorm = 44.8904, GNorm = 1.0830, lr_0 = 1.0000e-04
Validation rmse = 0.063331
Validation r2 = 0.967685
Validation mse = 0.004011
Epoch 58
Loss = 3.7743e-02, PNorm = 44.8944, GNorm = 0.4290, lr_0 = 1.0000e-04
Loss = 5.1481e-02, PNorm = 44.8986, GNorm = 0.8847, lr_0 = 1.0000e-04
Validation rmse = 0.078015
Validation r2 = 0.950962
Validation mse = 0.006086
Epoch 59
Loss = 8.3730e-02, PNorm = 44.9032, GNorm = 1.3238, lr_0 = 1.0000e-04
Loss = 4.7865e-02, PNorm = 44.9068, GNorm = 0.7594, lr_0 = 1.0000e-04
Validation rmse = 0.068627
Validation r2 = 0.962054
Validation mse = 0.004710
Model 0 best validation rmse = 0.046261 on epoch 15
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.632218
Model 0 test r2 = -4.313155
Model 0 test mse = 0.399699
Ensemble test rmse = 0.632218
Ensemble test r2 = -4.313155
Ensemble test mse = 0.399699
10-fold cross validation
	Seed 0 ==> test rmse = 0.612454
	Seed 0 ==> test r2 = -3.986162
	Seed 0 ==> test mse = 0.375100
	Seed 1 ==> test rmse = 0.612384
	Seed 1 ==> test r2 = -3.985016
	Seed 1 ==> test mse = 0.375014
	Seed 2 ==> test rmse = 0.587054
	Seed 2 ==> test r2 = -3.581162
	Seed 2 ==> test mse = 0.344633
	Seed 3 ==> test rmse = 0.653055
	Seed 3 ==> test r2 = -4.669156
	Seed 3 ==> test mse = 0.426481
	Seed 4 ==> test rmse = 0.585875
	Seed 4 ==> test r2 = -3.562766
	Seed 4 ==> test mse = 0.343249
	Seed 5 ==> test rmse = 0.627748
	Seed 5 ==> test r2 = -4.238286
	Seed 5 ==> test mse = 0.394067
	Seed 6 ==> test rmse = 0.614181
	Seed 6 ==> test r2 = -4.014307
	Seed 6 ==> test mse = 0.377218
	Seed 7 ==> test rmse = 0.582270
	Seed 7 ==> test r2 = -3.506787
	Seed 7 ==> test mse = 0.339038
	Seed 8 ==> test rmse = 0.653451
	Seed 8 ==> test r2 = -4.676029
	Seed 8 ==> test mse = 0.426998
	Seed 9 ==> test rmse = 0.632218
	Seed 9 ==> test r2 = -4.313155
	Seed 9 ==> test mse = 0.399699
Overall test rmse = 0.616069 +/- 0.024675
Overall test r2 = -4.053282 +/- 0.405181
Overall test mse = 0.380150 +/- 0.030481
Elapsed time = 0:07:28
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-05d85262-3219-459a-86b2-5360cba4da72.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/Hept_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2', 'mse'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2', 'mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/Hept_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/Hept_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 983 | train size = 973 | val size = 10 | test size = 49
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.1038e-01, PNorm = 43.2601, GNorm = 2.4318, lr_0 = 3.6053e-04
Validation rmse = 0.147519
Validation r2 = 0.546858
Validation mse = 0.021762
Epoch 1
Loss = 9.5312e-01, PNorm = 43.2902, GNorm = 5.4721, lr_0 = 6.2105e-04
Loss = 8.2921e-01, PNorm = 43.3243, GNorm = 5.9971, lr_0 = 8.5789e-04
Validation rmse = 0.211057
Validation r2 = 0.072458
Validation mse = 0.044545
Epoch 2
Loss = 6.3890e-01, PNorm = 43.3845, GNorm = 1.7665, lr_0 = 9.8961e-04
Loss = 5.0384e-01, PNorm = 43.4601, GNorm = 3.5403, lr_0 = 9.6914e-04
Validation rmse = 0.142482
Validation r2 = 0.577278
Validation mse = 0.020301
Epoch 3
Loss = 5.8892e-01, PNorm = 43.5406, GNorm = 7.1921, lr_0 = 9.4910e-04
Loss = 3.1565e-01, PNorm = 43.6101, GNorm = 1.3057, lr_0 = 9.2948e-04
Validation rmse = 0.148716
Validation r2 = 0.539480
Validation mse = 0.022116
Epoch 4
Loss = 3.2103e-01, PNorm = 43.6716, GNorm = 4.5482, lr_0 = 9.0836e-04
Loss = 2.4195e-01, PNorm = 43.7271, GNorm = 1.0271, lr_0 = 8.8958e-04
Validation rmse = 0.129185
Validation r2 = 0.652496
Validation mse = 0.016689
Epoch 5
Loss = 1.8568e-01, PNorm = 43.7674, GNorm = 3.4611, lr_0 = 8.7118e-04
Loss = 2.7209e-01, PNorm = 43.8082, GNorm = 1.5205, lr_0 = 8.5317e-04
Validation rmse = 0.128018
Validation r2 = 0.658744
Validation mse = 0.016389
Epoch 6
Loss = 2.2733e-01, PNorm = 43.8519, GNorm = 2.1711, lr_0 = 8.3378e-04
Loss = 2.9451e-01, PNorm = 43.8843, GNorm = 1.9596, lr_0 = 8.1654e-04
Validation rmse = 0.210039
Validation r2 = 0.081384
Validation mse = 0.044116
Epoch 7
Loss = 3.2909e-01, PNorm = 43.9368, GNorm = 6.5922, lr_0 = 7.9966e-04
Loss = 2.8839e-01, PNorm = 43.9821, GNorm = 3.9780, lr_0 = 7.8312e-04
Validation rmse = 0.133253
Validation r2 = 0.630264
Validation mse = 0.017756
Epoch 8
Loss = 2.5208e-01, PNorm = 44.0229, GNorm = 1.5810, lr_0 = 7.6533e-04
Loss = 2.0794e-01, PNorm = 44.0561, GNorm = 0.6689, lr_0 = 7.4950e-04
Validation rmse = 0.139631
Validation r2 = 0.594028
Validation mse = 0.019497
Epoch 9
Loss = 1.5851e-01, PNorm = 44.0854, GNorm = 0.5270, lr_0 = 7.3400e-04
Loss = 1.6540e-01, PNorm = 44.1077, GNorm = 1.3963, lr_0 = 7.1883e-04
Validation rmse = 0.123200
Validation r2 = 0.683951
Validation mse = 0.015178
Epoch 10
Loss = 1.6223e-01, PNorm = 44.1320, GNorm = 2.4383, lr_0 = 7.0249e-04
Loss = 1.4839e-01, PNorm = 44.1486, GNorm = 0.6806, lr_0 = 6.8797e-04
Validation rmse = 0.128797
Validation r2 = 0.654578
Validation mse = 0.016589
Epoch 11
Loss = 1.4877e-01, PNorm = 44.1726, GNorm = 1.1483, lr_0 = 6.7374e-04
Loss = 1.5965e-01, PNorm = 44.1929, GNorm = 0.7015, lr_0 = 6.5981e-04
Validation rmse = 0.123651
Validation r2 = 0.681630
Validation mse = 0.015290
Epoch 12
Loss = 1.3455e-01, PNorm = 44.2127, GNorm = 0.7979, lr_0 = 6.4482e-04
Loss = 1.4221e-01, PNorm = 44.2298, GNorm = 1.8214, lr_0 = 6.3148e-04
Validation rmse = 0.136381
Validation r2 = 0.612704
Validation mse = 0.018600
Epoch 13
Loss = 1.1805e-01, PNorm = 44.2545, GNorm = 0.5169, lr_0 = 6.1714e-04
Loss = 1.5843e-01, PNorm = 44.2710, GNorm = 0.7272, lr_0 = 6.0438e-04
Validation rmse = 0.148730
Validation r2 = 0.539391
Validation mse = 0.022121
Epoch 14
Loss = 1.4370e-01, PNorm = 44.2890, GNorm = 2.3505, lr_0 = 5.9188e-04
Loss = 1.6459e-01, PNorm = 44.3125, GNorm = 2.2489, lr_0 = 5.7964e-04
Validation rmse = 0.127585
Validation r2 = 0.661053
Validation mse = 0.016278
Epoch 15
Loss = 1.5120e-01, PNorm = 44.3404, GNorm = 2.9863, lr_0 = 5.6647e-04
Loss = 1.4975e-01, PNorm = 44.3616, GNorm = 0.7696, lr_0 = 5.5476e-04
Validation rmse = 0.156283
Validation r2 = 0.491421
Validation mse = 0.024424
Epoch 16
Loss = 1.2633e-01, PNorm = 44.3749, GNorm = 1.4334, lr_0 = 5.4328e-04
Loss = 1.2699e-01, PNorm = 44.3940, GNorm = 2.9833, lr_0 = 5.3205e-04
Loss = 1.8846e-01, PNorm = 44.3958, GNorm = 2.6394, lr_0 = 5.3094e-04
Validation rmse = 0.150807
Validation r2 = 0.526434
Validation mse = 0.022743
Epoch 17
Loss = 1.2861e-01, PNorm = 44.4131, GNorm = 2.4410, lr_0 = 5.1996e-04
Loss = 1.3190e-01, PNorm = 44.4319, GNorm = 0.9332, lr_0 = 5.0921e-04
Validation rmse = 0.120937
Validation r2 = 0.695454
Validation mse = 0.014626
Epoch 18
Loss = 1.2218e-01, PNorm = 44.4463, GNorm = 1.5666, lr_0 = 4.9868e-04
Validation rmse = 0.135934
Validation r2 = 0.615239
Validation mse = 0.018478
Epoch 19
Loss = 1.2922e-01, PNorm = 44.4641, GNorm = 0.9346, lr_0 = 4.8735e-04
Loss = 1.0848e-01, PNorm = 44.4805, GNorm = 0.8132, lr_0 = 4.7727e-04
Validation rmse = 0.143750
Validation r2 = 0.569721
Validation mse = 0.020664
Epoch 20
Loss = 1.4907e-01, PNorm = 44.4955, GNorm = 0.7238, lr_0 = 4.6740e-04
Loss = 1.2326e-01, PNorm = 44.5096, GNorm = 1.8278, lr_0 = 4.5774e-04
Validation rmse = 0.171714
Validation r2 = 0.386028
Validation mse = 0.029486
Epoch 21
Loss = 1.1801e-01, PNorm = 44.5258, GNorm = 3.3112, lr_0 = 4.4734e-04
Loss = 1.2515e-01, PNorm = 44.5431, GNorm = 2.0979, lr_0 = 4.3809e-04
Validation rmse = 0.182840
Validation r2 = 0.303888
Validation mse = 0.033431
Epoch 22
Loss = 1.2331e-01, PNorm = 44.5611, GNorm = 0.9229, lr_0 = 4.2903e-04
Loss = 1.1592e-01, PNorm = 44.5791, GNorm = 1.4144, lr_0 = 4.2016e-04
Validation rmse = 0.166600
Validation r2 = 0.422054
Validation mse = 0.027756
Epoch 23
Loss = 8.7911e-02, PNorm = 44.5922, GNorm = 0.7701, lr_0 = 4.1061e-04
Loss = 1.1397e-01, PNorm = 44.6074, GNorm = 1.0336, lr_0 = 4.0212e-04
Validation rmse = 0.145963
Validation r2 = 0.556373
Validation mse = 0.021305
Epoch 24
Loss = 1.1157e-01, PNorm = 44.6219, GNorm = 1.7882, lr_0 = 3.9381e-04
Loss = 1.1002e-01, PNorm = 44.6351, GNorm = 0.7885, lr_0 = 3.8566e-04
Validation rmse = 0.149220
Validation r2 = 0.536352
Validation mse = 0.022267
Epoch 25
Loss = 1.1327e-01, PNorm = 44.6530, GNorm = 1.0739, lr_0 = 3.7690e-04
Loss = 1.0386e-01, PNorm = 44.6652, GNorm = 2.1136, lr_0 = 3.6911e-04
Validation rmse = 0.139074
Validation r2 = 0.597255
Validation mse = 0.019342
Epoch 26
Loss = 1.0352e-01, PNorm = 44.6797, GNorm = 1.1356, lr_0 = 3.6072e-04
Loss = 9.5481e-02, PNorm = 44.6922, GNorm = 1.4650, lr_0 = 3.5326e-04
Validation rmse = 0.129289
Validation r2 = 0.651934
Validation mse = 0.016716
Epoch 27
Loss = 7.0523e-02, PNorm = 44.7036, GNorm = 1.4688, lr_0 = 3.4596e-04
Loss = 1.1265e-01, PNorm = 44.7179, GNorm = 1.0783, lr_0 = 3.3880e-04
Validation rmse = 0.142611
Validation r2 = 0.576510
Validation mse = 0.020338
Epoch 28
Loss = 9.4930e-02, PNorm = 44.7318, GNorm = 1.1997, lr_0 = 3.3110e-04
Loss = 1.0236e-01, PNorm = 44.7443, GNorm = 0.6212, lr_0 = 3.2426e-04
Validation rmse = 0.146674
Validation r2 = 0.552038
Validation mse = 0.021513
Epoch 29
Loss = 8.9033e-02, PNorm = 44.7571, GNorm = 1.2609, lr_0 = 3.1755e-04
Loss = 9.9828e-02, PNorm = 44.7700, GNorm = 1.9566, lr_0 = 3.1099e-04
Validation rmse = 0.145512
Validation r2 = 0.559104
Validation mse = 0.021174
Epoch 30
Loss = 9.5331e-02, PNorm = 44.7827, GNorm = 1.8264, lr_0 = 3.0392e-04
Loss = 8.8870e-02, PNorm = 44.7936, GNorm = 1.0526, lr_0 = 2.9764e-04
Validation rmse = 0.163584
Validation r2 = 0.442791
Validation mse = 0.026760
Epoch 31
Loss = 8.8296e-02, PNorm = 44.8057, GNorm = 2.2104, lr_0 = 2.9148e-04
Loss = 9.3536e-02, PNorm = 44.8183, GNorm = 0.8769, lr_0 = 2.8545e-04
Validation rmse = 0.158227
Validation r2 = 0.478689
Validation mse = 0.025036
Epoch 32
Loss = 9.2497e-02, PNorm = 44.8291, GNorm = 1.6484, lr_0 = 2.7897e-04
Loss = 8.2799e-02, PNorm = 44.8403, GNorm = 0.4538, lr_0 = 2.7320e-04
Validation rmse = 0.150883
Validation r2 = 0.525957
Validation mse = 0.022766
Epoch 33
Loss = 8.0912e-02, PNorm = 44.8523, GNorm = 0.7324, lr_0 = 2.6755e-04
Loss = 8.5759e-02, PNorm = 44.8641, GNorm = 2.8405, lr_0 = 2.6202e-04
Validation rmse = 0.168607
Validation r2 = 0.408049
Validation mse = 0.028428
Epoch 34
Loss = 9.1544e-02, PNorm = 44.8752, GNorm = 0.5190, lr_0 = 2.5606e-04
Loss = 8.7826e-02, PNorm = 44.8876, GNorm = 0.7273, lr_0 = 2.5077e-04
Validation rmse = 0.147048
Validation r2 = 0.549749
Validation mse = 0.021623
Epoch 35
Loss = 8.1059e-02, PNorm = 44.8970, GNorm = 1.4432, lr_0 = 2.4558e-04
Loss = 8.9214e-02, PNorm = 44.9079, GNorm = 1.3047, lr_0 = 2.4051e-04
Loss = 3.7644e-02, PNorm = 44.9092, GNorm = 1.6813, lr_0 = 2.4000e-04
Validation rmse = 0.146247
Validation r2 = 0.554644
Validation mse = 0.021388
Epoch 36
Loss = 7.6457e-02, PNorm = 44.9191, GNorm = 1.3537, lr_0 = 2.3504e-04
Loss = 8.4110e-02, PNorm = 44.9299, GNorm = 0.8113, lr_0 = 2.3018e-04
Validation rmse = 0.151181
Validation r2 = 0.524086
Validation mse = 0.022856
Epoch 37
Loss = 7.7785e-02, PNorm = 44.9384, GNorm = 1.0365, lr_0 = 2.2542e-04
Validation rmse = 0.142466
Validation r2 = 0.577370
Validation mse = 0.020297
Epoch 38
Loss = 4.2397e-02, PNorm = 44.9486, GNorm = 0.4649, lr_0 = 2.2030e-04
Loss = 6.6205e-02, PNorm = 44.9585, GNorm = 0.5992, lr_0 = 2.1574e-04
Validation rmse = 0.144460
Validation r2 = 0.565456
Validation mse = 0.020869
Epoch 39
Loss = 6.9809e-02, PNorm = 44.9685, GNorm = 1.2589, lr_0 = 2.1084e-04
Loss = 7.5253e-02, PNorm = 44.9787, GNorm = 1.7805, lr_0 = 2.0648e-04
Validation rmse = 0.138063
Validation r2 = 0.603091
Validation mse = 0.019061
Epoch 40
Loss = 5.5952e-02, PNorm = 44.9879, GNorm = 0.6938, lr_0 = 2.0221e-04
Loss = 7.8968e-02, PNorm = 44.9974, GNorm = 0.7571, lr_0 = 1.9803e-04
Validation rmse = 0.149086
Validation r2 = 0.537185
Validation mse = 0.022227
Epoch 41
Loss = 6.7958e-02, PNorm = 45.0071, GNorm = 0.4307, lr_0 = 1.9353e-04
Loss = 6.7601e-02, PNorm = 45.0151, GNorm = 0.4695, lr_0 = 1.8953e-04
Validation rmse = 0.134026
Validation r2 = 0.625964
Validation mse = 0.017963
Epoch 42
Loss = 6.2157e-02, PNorm = 45.0236, GNorm = 0.7243, lr_0 = 1.8561e-04
Loss = 7.7638e-02, PNorm = 45.0329, GNorm = 1.2225, lr_0 = 1.8177e-04
Validation rmse = 0.141001
Validation r2 = 0.586019
Validation mse = 0.019881
Epoch 43
Loss = 6.7520e-02, PNorm = 45.0417, GNorm = 0.7928, lr_0 = 1.7764e-04
Loss = 6.6387e-02, PNorm = 45.0502, GNorm = 1.2099, lr_0 = 1.7397e-04
Validation rmse = 0.145017
Validation r2 = 0.562102
Validation mse = 0.021030
Epoch 44
Loss = 5.5227e-02, PNorm = 45.0580, GNorm = 0.8582, lr_0 = 1.7037e-04
Loss = 7.4101e-02, PNorm = 45.0663, GNorm = 0.8625, lr_0 = 1.6685e-04
Validation rmse = 0.157898
Validation r2 = 0.480854
Validation mse = 0.024932
Epoch 45
Loss = 6.0438e-02, PNorm = 45.0744, GNorm = 1.3932, lr_0 = 1.6306e-04
Loss = 7.5390e-02, PNorm = 45.0823, GNorm = 1.2519, lr_0 = 1.5969e-04
Validation rmse = 0.162645
Validation r2 = 0.449170
Validation mse = 0.026453
Epoch 46
Loss = 5.7263e-02, PNorm = 45.0898, GNorm = 0.8426, lr_0 = 1.5638e-04
Loss = 7.6024e-02, PNorm = 45.0968, GNorm = 1.5519, lr_0 = 1.5315e-04
Validation rmse = 0.144843
Validation r2 = 0.563152
Validation mse = 0.020979
Epoch 47
Loss = 6.1053e-02, PNorm = 45.1043, GNorm = 0.7609, lr_0 = 1.4967e-04
Loss = 6.7995e-02, PNorm = 45.1116, GNorm = 1.2029, lr_0 = 1.4658e-04
Validation rmse = 0.147866
Validation r2 = 0.544729
Validation mse = 0.021864
Epoch 48
Loss = 5.6434e-02, PNorm = 45.1181, GNorm = 0.8450, lr_0 = 1.4354e-04
Loss = 6.1853e-02, PNorm = 45.1244, GNorm = 0.6505, lr_0 = 1.4058e-04
Validation rmse = 0.143875
Validation r2 = 0.568969
Validation mse = 0.020700
Epoch 49
Loss = 5.9009e-02, PNorm = 45.1316, GNorm = 1.0931, lr_0 = 1.3738e-04
Loss = 6.7426e-02, PNorm = 45.1375, GNorm = 0.6521, lr_0 = 1.3454e-04
Validation rmse = 0.137646
Validation r2 = 0.605483
Validation mse = 0.018947
Epoch 50
Loss = 6.0035e-02, PNorm = 45.1436, GNorm = 0.8937, lr_0 = 1.3176e-04
Loss = 6.3819e-02, PNorm = 45.1498, GNorm = 0.7522, lr_0 = 1.2904e-04
Validation rmse = 0.162772
Validation r2 = 0.448311
Validation mse = 0.026495
Epoch 51
Loss = 5.9409e-02, PNorm = 45.1568, GNorm = 1.3534, lr_0 = 1.2610e-04
Loss = 6.0538e-02, PNorm = 45.1619, GNorm = 1.7256, lr_0 = 1.2350e-04
Validation rmse = 0.149144
Validation r2 = 0.536825
Validation mse = 0.022244
Epoch 52
Loss = 4.8637e-02, PNorm = 45.1677, GNorm = 1.1959, lr_0 = 1.2069e-04
Loss = 6.7250e-02, PNorm = 45.1724, GNorm = 0.7574, lr_0 = 1.1819e-04
Validation rmse = 0.136022
Validation r2 = 0.614743
Validation mse = 0.018502
Epoch 53
Loss = 5.8325e-02, PNorm = 45.1782, GNorm = 1.4146, lr_0 = 1.1575e-04
Loss = 5.7904e-02, PNorm = 45.1836, GNorm = 1.2485, lr_0 = 1.1336e-04
Loss = 1.2547e-01, PNorm = 45.1842, GNorm = 2.0992, lr_0 = 1.1312e-04
Validation rmse = 0.158355
Validation r2 = 0.477846
Validation mse = 0.025076
Epoch 54
Loss = 6.3889e-02, PNorm = 45.1903, GNorm = 1.2592, lr_0 = 1.1078e-04
Loss = 5.1389e-02, PNorm = 45.1949, GNorm = 1.0463, lr_0 = 1.0849e-04
Validation rmse = 0.144168
Validation r2 = 0.567214
Validation mse = 0.020784
Epoch 55
Loss = 5.4355e-02, PNorm = 45.1992, GNorm = 0.5835, lr_0 = 1.0625e-04
Validation rmse = 0.152340
Validation r2 = 0.516757
Validation mse = 0.023208
Epoch 56
Loss = 7.8325e-02, PNorm = 45.2048, GNorm = 0.8010, lr_0 = 1.0383e-04
Loss = 5.4561e-02, PNorm = 45.2099, GNorm = 0.6634, lr_0 = 1.0169e-04
Validation rmse = 0.155741
Validation r2 = 0.494941
Validation mse = 0.024255
Epoch 57
Loss = 5.2015e-02, PNorm = 45.2147, GNorm = 0.6770, lr_0 = 1.0000e-04
Loss = 5.1221e-02, PNorm = 45.2199, GNorm = 0.7121, lr_0 = 1.0000e-04
Validation rmse = 0.162839
Validation r2 = 0.447855
Validation mse = 0.026517
Epoch 58
Loss = 4.3900e-02, PNorm = 45.2246, GNorm = 0.5244, lr_0 = 1.0000e-04
Loss = 5.5371e-02, PNorm = 45.2277, GNorm = 1.3013, lr_0 = 1.0000e-04
Validation rmse = 0.157015
Validation r2 = 0.486648
Validation mse = 0.024654
Epoch 59
Loss = 5.0223e-02, PNorm = 45.2330, GNorm = 0.7105, lr_0 = 1.0000e-04
Loss = 5.9783e-02, PNorm = 45.2396, GNorm = 1.2660, lr_0 = 1.0000e-04
Validation rmse = 0.146459
Validation r2 = 0.553352
Validation mse = 0.021450
Model 0 best validation rmse = 0.120937 on epoch 17
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.751905
Model 0 test r2 = -156.933324
Model 0 test mse = 0.565362
Ensemble test rmse = 0.751905
Ensemble test r2 = -156.933324
Ensemble test mse = 0.565362
Fold 1
Splitting data with seed 1
Total size = 983 | train size = 973 | val size = 10 | test size = 49
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.9090e-01, PNorm = 43.2634, GNorm = 5.9831, lr_0 = 3.6053e-04
Validation rmse = 0.177887
Validation r2 = 0.122425
Validation mse = 0.031644
Epoch 1
Loss = 8.2559e-01, PNorm = 43.2859, GNorm = 4.0016, lr_0 = 6.2105e-04
Loss = 6.8973e-01, PNorm = 43.3264, GNorm = 3.7511, lr_0 = 8.5789e-04
Validation rmse = 0.181812
Validation r2 = 0.083263
Validation mse = 0.033056
Epoch 2
Loss = 3.9965e-01, PNorm = 43.3994, GNorm = 1.6041, lr_0 = 9.8961e-04
Loss = 4.8187e-01, PNorm = 43.4843, GNorm = 5.2773, lr_0 = 9.6914e-04
Validation rmse = 0.173057
Validation r2 = 0.169430
Validation mse = 0.029949
Epoch 3
Loss = 2.5670e-01, PNorm = 43.5606, GNorm = 0.8373, lr_0 = 9.4910e-04
Loss = 3.2793e-01, PNorm = 43.6268, GNorm = 1.9611, lr_0 = 9.2948e-04
Validation rmse = 0.237882
Validation r2 = -0.569353
Validation mse = 0.056588
Epoch 4
Loss = 3.3330e-01, PNorm = 43.6835, GNorm = 8.8155, lr_0 = 9.0836e-04
Loss = 4.0603e-01, PNorm = 43.7331, GNorm = 4.1515, lr_0 = 8.8958e-04
Validation rmse = 0.183725
Validation r2 = 0.063877
Validation mse = 0.033755
Epoch 5
Loss = 2.7442e-01, PNorm = 43.7885, GNorm = 1.3294, lr_0 = 8.7118e-04
Loss = 2.4466e-01, PNorm = 43.8299, GNorm = 5.5097, lr_0 = 8.5317e-04
Validation rmse = 0.161597
Validation r2 = 0.275792
Validation mse = 0.026114
Epoch 6
Loss = 1.8868e-01, PNorm = 43.8755, GNorm = 1.6024, lr_0 = 8.3378e-04
Loss = 1.6740e-01, PNorm = 43.9117, GNorm = 1.0329, lr_0 = 8.1654e-04
Validation rmse = 0.158584
Validation r2 = 0.302548
Validation mse = 0.025149
Epoch 7
Loss = 1.9199e-01, PNorm = 43.9416, GNorm = 1.9841, lr_0 = 7.9966e-04
Loss = 1.6621e-01, PNorm = 43.9746, GNorm = 2.5403, lr_0 = 7.8312e-04
Validation rmse = 0.139271
Validation r2 = 0.462076
Validation mse = 0.019396
Epoch 8
Loss = 1.4227e-01, PNorm = 43.9995, GNorm = 0.5986, lr_0 = 7.6533e-04
Loss = 1.5052e-01, PNorm = 44.0224, GNorm = 1.5231, lr_0 = 7.4950e-04
Validation rmse = 0.124468
Validation r2 = 0.570351
Validation mse = 0.015492
Epoch 9
Loss = 1.5373e-01, PNorm = 44.0451, GNorm = 3.6448, lr_0 = 7.3400e-04
Loss = 1.8098e-01, PNorm = 44.0632, GNorm = 5.3642, lr_0 = 7.1883e-04
Validation rmse = 0.177913
Validation r2 = 0.122161
Validation mse = 0.031653
Epoch 10
Loss = 1.4612e-01, PNorm = 44.0866, GNorm = 1.6964, lr_0 = 7.0249e-04
Loss = 1.4603e-01, PNorm = 44.1068, GNorm = 0.7282, lr_0 = 6.8797e-04
Validation rmse = 0.126942
Validation r2 = 0.553105
Validation mse = 0.016114
Epoch 11
Loss = 1.6692e-01, PNorm = 44.1334, GNorm = 4.7384, lr_0 = 6.7374e-04
Loss = 1.7084e-01, PNorm = 44.1571, GNorm = 3.0880, lr_0 = 6.5981e-04
Validation rmse = 0.141526
Validation r2 = 0.444516
Validation mse = 0.020030
Epoch 12
Loss = 1.4491e-01, PNorm = 44.1853, GNorm = 1.9503, lr_0 = 6.4482e-04
Loss = 1.3766e-01, PNorm = 44.2068, GNorm = 1.0564, lr_0 = 6.3148e-04
Validation rmse = 0.141423
Validation r2 = 0.445324
Validation mse = 0.020001
Epoch 13
Loss = 1.2996e-01, PNorm = 44.2296, GNorm = 3.2072, lr_0 = 6.1714e-04
Loss = 1.5338e-01, PNorm = 44.2502, GNorm = 4.4325, lr_0 = 6.0438e-04
Validation rmse = 0.119327
Validation r2 = 0.605114
Validation mse = 0.014239
Epoch 14
Loss = 1.2262e-01, PNorm = 44.2687, GNorm = 1.5139, lr_0 = 5.9188e-04
Loss = 1.5029e-01, PNorm = 44.2823, GNorm = 1.8394, lr_0 = 5.7964e-04
Validation rmse = 0.136295
Validation r2 = 0.484818
Validation mse = 0.018576
Epoch 15
Loss = 1.2677e-01, PNorm = 44.3021, GNorm = 2.1220, lr_0 = 5.6647e-04
Loss = 1.3343e-01, PNorm = 44.3196, GNorm = 2.3542, lr_0 = 5.5476e-04
Validation rmse = 0.159127
Validation r2 = 0.297756
Validation mse = 0.025322
Epoch 16
Loss = 1.3243e-01, PNorm = 44.3353, GNorm = 2.8039, lr_0 = 5.4328e-04
Loss = 1.5760e-01, PNorm = 44.3532, GNorm = 5.4654, lr_0 = 5.3205e-04
Loss = 1.3325e-01, PNorm = 44.3540, GNorm = 1.1254, lr_0 = 5.3094e-04
Validation rmse = 0.191491
Validation r2 = -0.016941
Validation mse = 0.036669
Epoch 17
Loss = 1.5756e-01, PNorm = 44.3737, GNorm = 5.0313, lr_0 = 5.1996e-04
Loss = 1.4474e-01, PNorm = 44.3952, GNorm = 1.5501, lr_0 = 5.0921e-04
Validation rmse = 0.133958
Validation r2 = 0.502337
Validation mse = 0.017945
Epoch 18
Loss = 1.1702e-01, PNorm = 44.4140, GNorm = 1.3241, lr_0 = 4.9868e-04
Validation rmse = 0.124230
Validation r2 = 0.571991
Validation mse = 0.015433
Epoch 19
Loss = 1.2974e-01, PNorm = 44.4315, GNorm = 1.6805, lr_0 = 4.8735e-04
Loss = 1.0929e-01, PNorm = 44.4460, GNorm = 0.4966, lr_0 = 4.7727e-04
Validation rmse = 0.168999
Validation r2 = 0.207927
Validation mse = 0.028561
Epoch 20
Loss = 2.0596e-01, PNorm = 44.4570, GNorm = 2.7815, lr_0 = 4.6740e-04
Loss = 1.4288e-01, PNorm = 44.4757, GNorm = 4.9532, lr_0 = 4.5774e-04
Validation rmse = 0.135907
Validation r2 = 0.487754
Validation mse = 0.018471
Epoch 21
Loss = 1.1372e-01, PNorm = 44.4942, GNorm = 1.3401, lr_0 = 4.4734e-04
Loss = 1.2425e-01, PNorm = 44.5116, GNorm = 2.5807, lr_0 = 4.3809e-04
Validation rmse = 0.126479
Validation r2 = 0.556358
Validation mse = 0.015997
Epoch 22
Loss = 8.0095e-02, PNorm = 44.5287, GNorm = 2.0221, lr_0 = 4.2903e-04
Loss = 1.1095e-01, PNorm = 44.5436, GNorm = 2.1250, lr_0 = 4.2016e-04
Validation rmse = 0.141071
Validation r2 = 0.448085
Validation mse = 0.019901
Epoch 23
Loss = 1.1477e-01, PNorm = 44.5561, GNorm = 0.9690, lr_0 = 4.1061e-04
Loss = 1.1441e-01, PNorm = 44.5673, GNorm = 0.9223, lr_0 = 4.0212e-04
Validation rmse = 0.130971
Validation r2 = 0.524287
Validation mse = 0.017153
Epoch 24
Loss = 8.5799e-02, PNorm = 44.5812, GNorm = 1.4010, lr_0 = 3.9381e-04
Loss = 9.7570e-02, PNorm = 44.5929, GNorm = 1.5165, lr_0 = 3.8566e-04
Validation rmse = 0.130045
Validation r2 = 0.530983
Validation mse = 0.016912
Epoch 25
Loss = 1.0388e-01, PNorm = 44.6056, GNorm = 1.2193, lr_0 = 3.7690e-04
Loss = 1.0465e-01, PNorm = 44.6164, GNorm = 0.9528, lr_0 = 3.6911e-04
Validation rmse = 0.136901
Validation r2 = 0.480230
Validation mse = 0.018742
Epoch 26
Loss = 9.0197e-02, PNorm = 44.6302, GNorm = 0.7723, lr_0 = 3.6072e-04
Loss = 9.4359e-02, PNorm = 44.6422, GNorm = 2.0929, lr_0 = 3.5326e-04
Validation rmse = 0.128461
Validation r2 = 0.542344
Validation mse = 0.016502
Epoch 27
Loss = 9.4141e-02, PNorm = 44.6533, GNorm = 0.9509, lr_0 = 3.4596e-04
Loss = 9.9506e-02, PNorm = 44.6650, GNorm = 2.5041, lr_0 = 3.3880e-04
Validation rmse = 0.144446
Validation r2 = 0.421355
Validation mse = 0.020865
Epoch 28
Loss = 9.3850e-02, PNorm = 44.6806, GNorm = 0.8863, lr_0 = 3.3110e-04
Loss = 9.4601e-02, PNorm = 44.6915, GNorm = 0.9014, lr_0 = 3.2426e-04
Validation rmse = 0.140344
Validation r2 = 0.453758
Validation mse = 0.019696
Epoch 29
Loss = 7.4578e-02, PNorm = 44.7034, GNorm = 1.8697, lr_0 = 3.1755e-04
Loss = 9.1694e-02, PNorm = 44.7166, GNorm = 0.5408, lr_0 = 3.1099e-04
Validation rmse = 0.130671
Validation r2 = 0.526458
Validation mse = 0.017075
Epoch 30
Loss = 9.4257e-02, PNorm = 44.7276, GNorm = 2.0874, lr_0 = 3.0392e-04
Loss = 8.5736e-02, PNorm = 44.7378, GNorm = 0.7504, lr_0 = 2.9764e-04
Validation rmse = 0.150857
Validation r2 = 0.368854
Validation mse = 0.022758
Epoch 31
Loss = 1.0050e-01, PNorm = 44.7473, GNorm = 2.5798, lr_0 = 2.9148e-04
Loss = 8.7233e-02, PNorm = 44.7584, GNorm = 1.2091, lr_0 = 2.8545e-04
Validation rmse = 0.148149
Validation r2 = 0.391314
Validation mse = 0.021948
Epoch 32
Loss = 8.2850e-02, PNorm = 44.7703, GNorm = 1.0747, lr_0 = 2.7897e-04
Loss = 8.4398e-02, PNorm = 44.7816, GNorm = 0.6323, lr_0 = 2.7320e-04
Validation rmse = 0.136187
Validation r2 = 0.485637
Validation mse = 0.018547
Epoch 33
Loss = 8.9713e-02, PNorm = 44.7911, GNorm = 2.3791, lr_0 = 2.6755e-04
Loss = 9.0960e-02, PNorm = 44.8021, GNorm = 0.8690, lr_0 = 2.6202e-04
Validation rmse = 0.127572
Validation r2 = 0.548654
Validation mse = 0.016275
Epoch 34
Loss = 7.6251e-02, PNorm = 44.8152, GNorm = 0.8342, lr_0 = 2.5606e-04
Loss = 8.5543e-02, PNorm = 44.8228, GNorm = 0.8436, lr_0 = 2.5077e-04
Validation rmse = 0.130259
Validation r2 = 0.529444
Validation mse = 0.016967
Epoch 35
Loss = 8.6174e-02, PNorm = 44.8329, GNorm = 1.2633, lr_0 = 2.4558e-04
Loss = 8.1049e-02, PNorm = 44.8429, GNorm = 0.4851, lr_0 = 2.4051e-04
Loss = 3.0096e-02, PNorm = 44.8438, GNorm = 0.4458, lr_0 = 2.4000e-04
Validation rmse = 0.122648
Validation r2 = 0.582822
Validation mse = 0.015043
Epoch 36
Loss = 8.6087e-02, PNorm = 44.8527, GNorm = 0.7785, lr_0 = 2.3504e-04
Loss = 6.9781e-02, PNorm = 44.8614, GNorm = 0.7745, lr_0 = 2.3018e-04
Validation rmse = 0.140531
Validation r2 = 0.452299
Validation mse = 0.019749
Epoch 37
Loss = 7.5848e-02, PNorm = 44.8687, GNorm = 2.6086, lr_0 = 2.2542e-04
Validation rmse = 0.144039
Validation r2 = 0.424616
Validation mse = 0.020747
Epoch 38
Loss = 9.2877e-02, PNorm = 44.8796, GNorm = 2.2202, lr_0 = 2.2030e-04
Loss = 7.4635e-02, PNorm = 44.8883, GNorm = 0.4816, lr_0 = 2.1574e-04
Validation rmse = 0.136179
Validation r2 = 0.485694
Validation mse = 0.018545
Epoch 39
Loss = 9.0920e-02, PNorm = 44.8968, GNorm = 0.5253, lr_0 = 2.1084e-04
Loss = 6.7752e-02, PNorm = 44.9046, GNorm = 0.7888, lr_0 = 2.0648e-04
Validation rmse = 0.134654
Validation r2 = 0.497151
Validation mse = 0.018132
Epoch 40
Loss = 8.0080e-02, PNorm = 44.9120, GNorm = 1.9747, lr_0 = 2.0221e-04
Loss = 7.5479e-02, PNorm = 44.9204, GNorm = 2.0985, lr_0 = 1.9803e-04
Validation rmse = 0.142107
Validation r2 = 0.439949
Validation mse = 0.020194
Epoch 41
Loss = 6.8643e-02, PNorm = 44.9299, GNorm = 0.7061, lr_0 = 1.9353e-04
Loss = 7.5680e-02, PNorm = 44.9382, GNorm = 1.9020, lr_0 = 1.8953e-04
Validation rmse = 0.134126
Validation r2 = 0.501086
Validation mse = 0.017990
Epoch 42
Loss = 1.0062e-01, PNorm = 44.9456, GNorm = 1.0018, lr_0 = 1.8561e-04
Loss = 6.0265e-02, PNorm = 44.9540, GNorm = 0.9829, lr_0 = 1.8177e-04
Validation rmse = 0.149486
Validation r2 = 0.380278
Validation mse = 0.022346
Epoch 43
Loss = 8.6690e-02, PNorm = 44.9604, GNorm = 1.7179, lr_0 = 1.7764e-04
Loss = 6.4134e-02, PNorm = 44.9675, GNorm = 0.8677, lr_0 = 1.7397e-04
Validation rmse = 0.144528
Validation r2 = 0.420702
Validation mse = 0.020888
Epoch 44
Loss = 6.2005e-02, PNorm = 44.9743, GNorm = 0.7567, lr_0 = 1.7037e-04
Loss = 7.0384e-02, PNorm = 44.9801, GNorm = 0.6495, lr_0 = 1.6685e-04
Validation rmse = 0.140617
Validation r2 = 0.451632
Validation mse = 0.019773
Epoch 45
Loss = 6.2805e-02, PNorm = 44.9868, GNorm = 2.5650, lr_0 = 1.6306e-04
Loss = 6.7793e-02, PNorm = 44.9935, GNorm = 1.2662, lr_0 = 1.5969e-04
Validation rmse = 0.134725
Validation r2 = 0.496624
Validation mse = 0.018151
Epoch 46
Loss = 5.9588e-02, PNorm = 44.9990, GNorm = 0.8049, lr_0 = 1.5638e-04
Loss = 6.7762e-02, PNorm = 45.0049, GNorm = 1.9085, lr_0 = 1.5315e-04
Validation rmse = 0.136056
Validation r2 = 0.486624
Validation mse = 0.018511
Epoch 47
Loss = 5.4983e-02, PNorm = 45.0128, GNorm = 0.9304, lr_0 = 1.4967e-04
Loss = 6.5191e-02, PNorm = 45.0177, GNorm = 1.4919, lr_0 = 1.4658e-04
Validation rmse = 0.127755
Validation r2 = 0.547356
Validation mse = 0.016321
Epoch 48
Loss = 7.0481e-02, PNorm = 45.0237, GNorm = 2.1544, lr_0 = 1.4354e-04
Loss = 5.5283e-02, PNorm = 45.0299, GNorm = 0.6991, lr_0 = 1.4058e-04
Validation rmse = 0.139325
Validation r2 = 0.461660
Validation mse = 0.019411
Epoch 49
Loss = 6.3939e-02, PNorm = 45.0351, GNorm = 1.2271, lr_0 = 1.3738e-04
Loss = 5.7581e-02, PNorm = 45.0416, GNorm = 1.3761, lr_0 = 1.3454e-04
Validation rmse = 0.143886
Validation r2 = 0.425838
Validation mse = 0.020703
Epoch 50
Loss = 5.1882e-02, PNorm = 45.0464, GNorm = 0.5375, lr_0 = 1.3176e-04
Loss = 6.1355e-02, PNorm = 45.0516, GNorm = 1.4268, lr_0 = 1.2904e-04
Validation rmse = 0.140941
Validation r2 = 0.449099
Validation mse = 0.019864
Epoch 51
Loss = 5.1687e-02, PNorm = 45.0573, GNorm = 0.6000, lr_0 = 1.2610e-04
Loss = 6.5327e-02, PNorm = 45.0626, GNorm = 2.5746, lr_0 = 1.2350e-04
Validation rmse = 0.135083
Validation r2 = 0.493941
Validation mse = 0.018247
Epoch 52
Loss = 5.8855e-02, PNorm = 45.0681, GNorm = 1.0935, lr_0 = 1.2069e-04
Loss = 6.1450e-02, PNorm = 45.0728, GNorm = 1.5672, lr_0 = 1.1819e-04
Validation rmse = 0.133948
Validation r2 = 0.502413
Validation mse = 0.017942
Epoch 53
Loss = 5.8251e-02, PNorm = 45.0773, GNorm = 1.8638, lr_0 = 1.1575e-04
Loss = 6.0153e-02, PNorm = 45.0811, GNorm = 2.5987, lr_0 = 1.1336e-04
Loss = 3.9109e-02, PNorm = 45.0814, GNorm = 1.4284, lr_0 = 1.1312e-04
Validation rmse = 0.127499
Validation r2 = 0.549172
Validation mse = 0.016256
Epoch 54
Loss = 6.4206e-02, PNorm = 45.0859, GNorm = 1.6170, lr_0 = 1.1078e-04
Loss = 5.5860e-02, PNorm = 45.0906, GNorm = 1.2928, lr_0 = 1.0849e-04
Validation rmse = 0.122860
Validation r2 = 0.581384
Validation mse = 0.015094
Epoch 55
Loss = 6.0911e-02, PNorm = 45.0958, GNorm = 1.0748, lr_0 = 1.0625e-04
Validation rmse = 0.144107
Validation r2 = 0.424076
Validation mse = 0.020767
Epoch 56
Loss = 9.6212e-02, PNorm = 45.0997, GNorm = 1.3156, lr_0 = 1.0383e-04
Loss = 5.3974e-02, PNorm = 45.1039, GNorm = 1.1301, lr_0 = 1.0169e-04
Validation rmse = 0.132262
Validation r2 = 0.514862
Validation mse = 0.017493
Epoch 57
Loss = 4.4431e-02, PNorm = 45.1073, GNorm = 0.5971, lr_0 = 1.0000e-04
Loss = 5.5876e-02, PNorm = 45.1114, GNorm = 1.0462, lr_0 = 1.0000e-04
Validation rmse = 0.132684
Validation r2 = 0.511759
Validation mse = 0.017605
Epoch 58
Loss = 4.3813e-02, PNorm = 45.1155, GNorm = 0.7437, lr_0 = 1.0000e-04
Loss = 6.0011e-02, PNorm = 45.1198, GNorm = 2.3856, lr_0 = 1.0000e-04
Validation rmse = 0.124314
Validation r2 = 0.571414
Validation mse = 0.015454
Epoch 59
Loss = 4.9912e-02, PNorm = 45.1238, GNorm = 0.8002, lr_0 = 1.0000e-04
Loss = 5.1874e-02, PNorm = 45.1277, GNorm = 1.4129, lr_0 = 1.0000e-04
Validation rmse = 0.138706
Validation r2 = 0.466436
Validation mse = 0.019239
Model 0 best validation rmse = 0.119327 on epoch 13
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.733593
Model 0 test r2 = -149.334348
Model 0 test mse = 0.538159
Ensemble test rmse = 0.733593
Ensemble test r2 = -149.334348
Ensemble test mse = 0.538159
Fold 2
Splitting data with seed 2
Total size = 983 | train size = 973 | val size = 10 | test size = 49
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 8.0130e-01, PNorm = 43.2651, GNorm = 3.2882, lr_0 = 3.6053e-04
Validation rmse = 0.121947
Validation r2 = 0.674873
Validation mse = 0.014871
Epoch 1
Loss = 7.9959e-01, PNorm = 43.2869, GNorm = 9.7471, lr_0 = 6.2105e-04
Loss = 5.7384e-01, PNorm = 43.3294, GNorm = 1.6394, lr_0 = 8.5789e-04
Validation rmse = 0.225339
Validation r2 = -0.110148
Validation mse = 0.050778
Epoch 2
Loss = 7.0376e-01, PNorm = 43.4046, GNorm = 15.5889, lr_0 = 9.8961e-04
Loss = 5.1062e-01, PNorm = 43.4785, GNorm = 1.2567, lr_0 = 9.6914e-04
Validation rmse = 0.202861
Validation r2 = 0.100287
Validation mse = 0.041152
Epoch 3
Loss = 4.4089e-01, PNorm = 43.5537, GNorm = 1.9483, lr_0 = 9.4910e-04
Loss = 3.5893e-01, PNorm = 43.6183, GNorm = 1.1677, lr_0 = 9.2948e-04
Validation rmse = 0.107265
Validation r2 = 0.748449
Validation mse = 0.011506
Epoch 4
Loss = 2.4069e-01, PNorm = 43.6836, GNorm = 2.8532, lr_0 = 9.0836e-04
Loss = 2.7323e-01, PNorm = 43.7258, GNorm = 3.2426, lr_0 = 8.8958e-04
Validation rmse = 0.129393
Validation r2 = 0.633962
Validation mse = 0.016742
Epoch 5
Loss = 2.5339e-01, PNorm = 43.7652, GNorm = 2.4597, lr_0 = 8.7118e-04
Loss = 2.1892e-01, PNorm = 43.7933, GNorm = 7.1506, lr_0 = 8.5317e-04
Validation rmse = 0.129356
Validation r2 = 0.634166
Validation mse = 0.016733
Epoch 6
Loss = 2.0751e-01, PNorm = 43.8248, GNorm = 5.6615, lr_0 = 8.3378e-04
Loss = 2.2972e-01, PNorm = 43.8594, GNorm = 3.4583, lr_0 = 8.1654e-04
Validation rmse = 0.106094
Validation r2 = 0.753914
Validation mse = 0.011256
Epoch 7
Loss = 1.8150e-01, PNorm = 43.8891, GNorm = 1.5005, lr_0 = 7.9966e-04
Loss = 1.7088e-01, PNorm = 43.9177, GNorm = 1.7619, lr_0 = 7.8312e-04
Validation rmse = 0.111616
Validation r2 = 0.727631
Validation mse = 0.012458
Epoch 8
Loss = 1.3917e-01, PNorm = 43.9380, GNorm = 2.2190, lr_0 = 7.6533e-04
Loss = 1.6706e-01, PNorm = 43.9589, GNorm = 1.7469, lr_0 = 7.4950e-04
Validation rmse = 0.103424
Validation r2 = 0.766143
Validation mse = 0.010696
Epoch 9
Loss = 1.5996e-01, PNorm = 43.9844, GNorm = 0.9680, lr_0 = 7.3400e-04
Loss = 1.4042e-01, PNorm = 44.0045, GNorm = 1.0881, lr_0 = 7.1883e-04
Validation rmse = 0.130288
Validation r2 = 0.628876
Validation mse = 0.016975
Epoch 10
Loss = 2.1824e-01, PNorm = 44.0260, GNorm = 2.9972, lr_0 = 7.0249e-04
Loss = 1.7662e-01, PNorm = 44.0510, GNorm = 2.5732, lr_0 = 6.8797e-04
Validation rmse = 0.107900
Validation r2 = 0.745461
Validation mse = 0.011642
Epoch 11
Loss = 1.8513e-01, PNorm = 44.0715, GNorm = 1.0968, lr_0 = 6.7374e-04
Loss = 1.3778e-01, PNorm = 44.0939, GNorm = 0.7231, lr_0 = 6.5981e-04
Validation rmse = 0.103094
Validation r2 = 0.767633
Validation mse = 0.010628
Epoch 12
Loss = 1.2463e-01, PNorm = 44.1118, GNorm = 0.6927, lr_0 = 6.4482e-04
Loss = 1.5278e-01, PNorm = 44.1276, GNorm = 4.4159, lr_0 = 6.3148e-04
Validation rmse = 0.115189
Validation r2 = 0.709911
Validation mse = 0.013269
Epoch 13
Loss = 1.4926e-01, PNorm = 44.1482, GNorm = 2.8548, lr_0 = 6.1714e-04
Loss = 1.6554e-01, PNorm = 44.1680, GNorm = 4.6278, lr_0 = 6.0438e-04
Validation rmse = 0.123183
Validation r2 = 0.668249
Validation mse = 0.015174
Epoch 14
Loss = 1.5989e-01, PNorm = 44.1894, GNorm = 3.1575, lr_0 = 5.9188e-04
Loss = 1.5734e-01, PNorm = 44.2098, GNorm = 0.9721, lr_0 = 5.7964e-04
Validation rmse = 0.075876
Validation r2 = 0.874131
Validation mse = 0.005757
Epoch 15
Loss = 1.3030e-01, PNorm = 44.2232, GNorm = 1.3576, lr_0 = 5.6647e-04
Loss = 1.3879e-01, PNorm = 44.2394, GNorm = 2.6405, lr_0 = 5.5476e-04
Validation rmse = 0.121857
Validation r2 = 0.675353
Validation mse = 0.014849
Epoch 16
Loss = 1.1913e-01, PNorm = 44.2575, GNorm = 1.8554, lr_0 = 5.4328e-04
Loss = 1.5014e-01, PNorm = 44.2717, GNorm = 0.9942, lr_0 = 5.3205e-04
Loss = 8.2889e-02, PNorm = 44.2730, GNorm = 3.2430, lr_0 = 5.3094e-04
Validation rmse = 0.102212
Validation r2 = 0.771592
Validation mse = 0.010447
Epoch 17
Loss = 1.4563e-01, PNorm = 44.2893, GNorm = 0.9265, lr_0 = 5.1996e-04
Loss = 1.1230e-01, PNorm = 44.3037, GNorm = 1.7183, lr_0 = 5.0921e-04
Validation rmse = 0.099015
Validation r2 = 0.785655
Validation mse = 0.009804
Epoch 18
Loss = 1.2064e-01, PNorm = 44.3181, GNorm = 3.1193, lr_0 = 4.9868e-04
Validation rmse = 0.104408
Validation r2 = 0.761672
Validation mse = 0.010901
Epoch 19
Loss = 1.3779e-01, PNorm = 44.3330, GNorm = 3.6135, lr_0 = 4.8735e-04
Loss = 1.0629e-01, PNorm = 44.3497, GNorm = 0.7019, lr_0 = 4.7727e-04
Validation rmse = 0.098972
Validation r2 = 0.785844
Validation mse = 0.009795
Epoch 20
Loss = 1.3569e-01, PNorm = 44.3625, GNorm = 1.2536, lr_0 = 4.6740e-04
Loss = 1.1369e-01, PNorm = 44.3740, GNorm = 2.5343, lr_0 = 4.5774e-04
Validation rmse = 0.090154
Validation r2 = 0.822302
Validation mse = 0.008128
Epoch 21
Loss = 1.2243e-01, PNorm = 44.3918, GNorm = 1.5328, lr_0 = 4.4734e-04
Loss = 1.0143e-01, PNorm = 44.4021, GNorm = 1.0533, lr_0 = 4.3809e-04
Validation rmse = 0.094153
Validation r2 = 0.806189
Validation mse = 0.008865
Epoch 22
Loss = 1.5755e-01, PNorm = 44.4161, GNorm = 0.8011, lr_0 = 4.2903e-04
Loss = 1.0947e-01, PNorm = 44.4321, GNorm = 1.0984, lr_0 = 4.2016e-04
Validation rmse = 0.102900
Validation r2 = 0.768507
Validation mse = 0.010588
Epoch 23
Loss = 1.0149e-01, PNorm = 44.4465, GNorm = 0.5383, lr_0 = 4.1061e-04
Loss = 1.1225e-01, PNorm = 44.4620, GNorm = 1.1914, lr_0 = 4.0212e-04
Validation rmse = 0.086137
Validation r2 = 0.837787
Validation mse = 0.007420
Epoch 24
Loss = 1.2929e-01, PNorm = 44.4746, GNorm = 1.8015, lr_0 = 3.9381e-04
Loss = 1.0317e-01, PNorm = 44.4866, GNorm = 0.5986, lr_0 = 3.8566e-04
Validation rmse = 0.091938
Validation r2 = 0.815201
Validation mse = 0.008453
Epoch 25
Loss = 9.2574e-02, PNorm = 44.5007, GNorm = 0.9394, lr_0 = 3.7690e-04
Loss = 1.1098e-01, PNorm = 44.5113, GNorm = 2.4957, lr_0 = 3.6911e-04
Validation rmse = 0.100990
Validation r2 = 0.777019
Validation mse = 0.010199
Epoch 26
Loss = 1.0434e-01, PNorm = 44.5243, GNorm = 2.0967, lr_0 = 3.6072e-04
Loss = 1.0128e-01, PNorm = 44.5366, GNorm = 1.7214, lr_0 = 3.5326e-04
Validation rmse = 0.083712
Validation r2 = 0.846789
Validation mse = 0.007008
Epoch 27
Loss = 9.6544e-02, PNorm = 44.5487, GNorm = 0.5971, lr_0 = 3.4596e-04
Loss = 9.9657e-02, PNorm = 44.5608, GNorm = 2.8840, lr_0 = 3.3880e-04
Validation rmse = 0.088791
Validation r2 = 0.827638
Validation mse = 0.007884
Epoch 28
Loss = 1.0619e-01, PNorm = 44.5745, GNorm = 2.0742, lr_0 = 3.3110e-04
Loss = 9.7067e-02, PNorm = 44.5849, GNorm = 2.9914, lr_0 = 3.2426e-04
Validation rmse = 0.087405
Validation r2 = 0.832977
Validation mse = 0.007640
Epoch 29
Loss = 9.4549e-02, PNorm = 44.5975, GNorm = 0.9616, lr_0 = 3.1755e-04
Loss = 9.7924e-02, PNorm = 44.6082, GNorm = 1.3401, lr_0 = 3.1099e-04
Validation rmse = 0.095934
Validation r2 = 0.798789
Validation mse = 0.009203
Epoch 30
Loss = 9.4862e-02, PNorm = 44.6201, GNorm = 1.6352, lr_0 = 3.0392e-04
Loss = 8.8698e-02, PNorm = 44.6314, GNorm = 0.8963, lr_0 = 2.9764e-04
Validation rmse = 0.092125
Validation r2 = 0.814451
Validation mse = 0.008487
Epoch 31
Loss = 8.0568e-02, PNorm = 44.6435, GNorm = 1.3727, lr_0 = 2.9148e-04
Loss = 9.2277e-02, PNorm = 44.6557, GNorm = 0.6854, lr_0 = 2.8545e-04
Validation rmse = 0.093327
Validation r2 = 0.809574
Validation mse = 0.008710
Epoch 32
Loss = 1.0268e-01, PNorm = 44.6674, GNorm = 0.8701, lr_0 = 2.7897e-04
Loss = 8.4799e-02, PNorm = 44.6783, GNorm = 2.4540, lr_0 = 2.7320e-04
Validation rmse = 0.081005
Validation r2 = 0.856541
Validation mse = 0.006562
Epoch 33
Loss = 7.8117e-02, PNorm = 44.6885, GNorm = 1.3218, lr_0 = 2.6755e-04
Loss = 9.8486e-02, PNorm = 44.7005, GNorm = 3.6599, lr_0 = 2.6202e-04
Validation rmse = 0.083073
Validation r2 = 0.849123
Validation mse = 0.006901
Epoch 34
Loss = 7.9506e-02, PNorm = 44.7102, GNorm = 1.0639, lr_0 = 2.5606e-04
Loss = 8.5655e-02, PNorm = 44.7200, GNorm = 1.5954, lr_0 = 2.5077e-04
Validation rmse = 0.073166
Validation r2 = 0.882961
Validation mse = 0.005353
Epoch 35
Loss = 8.3374e-02, PNorm = 44.7315, GNorm = 0.9115, lr_0 = 2.4558e-04
Loss = 8.1603e-02, PNorm = 44.7424, GNorm = 1.1565, lr_0 = 2.4051e-04
Loss = 8.3743e-02, PNorm = 44.7432, GNorm = 2.8308, lr_0 = 2.4000e-04
Validation rmse = 0.076287
Validation r2 = 0.872765
Validation mse = 0.005820
Epoch 36
Loss = 8.1547e-02, PNorm = 44.7501, GNorm = 1.6799, lr_0 = 2.3504e-04
Loss = 8.8320e-02, PNorm = 44.7627, GNorm = 1.2364, lr_0 = 2.3018e-04
Validation rmse = 0.072862
Validation r2 = 0.883933
Validation mse = 0.005309
Epoch 37
Loss = 7.5633e-02, PNorm = 44.7713, GNorm = 0.4727, lr_0 = 2.2542e-04
Validation rmse = 0.085959
Validation r2 = 0.838457
Validation mse = 0.007389
Epoch 38
Loss = 5.7284e-02, PNorm = 44.7810, GNorm = 1.5468, lr_0 = 2.2030e-04
Loss = 7.3029e-02, PNorm = 44.7903, GNorm = 1.0704, lr_0 = 2.1574e-04
Validation rmse = 0.080262
Validation r2 = 0.859158
Validation mse = 0.006442
Epoch 39
Loss = 8.6350e-02, PNorm = 44.7990, GNorm = 1.1688, lr_0 = 2.1084e-04
Loss = 7.5367e-02, PNorm = 44.8069, GNorm = 1.8468, lr_0 = 2.0648e-04
Validation rmse = 0.073678
Validation r2 = 0.881320
Validation mse = 0.005428
Epoch 40
Loss = 4.6075e-02, PNorm = 44.8168, GNorm = 0.4676, lr_0 = 2.0221e-04
Loss = 8.3601e-02, PNorm = 44.8256, GNorm = 1.0756, lr_0 = 1.9803e-04
Validation rmse = 0.075989
Validation r2 = 0.873755
Validation mse = 0.005774
Epoch 41
Loss = 6.8954e-02, PNorm = 44.8339, GNorm = 0.8450, lr_0 = 1.9353e-04
Loss = 8.2162e-02, PNorm = 44.8420, GNorm = 1.6751, lr_0 = 1.8953e-04
Validation rmse = 0.084272
Validation r2 = 0.844733
Validation mse = 0.007102
Epoch 42
Loss = 7.3152e-02, PNorm = 44.8492, GNorm = 1.6377, lr_0 = 1.8561e-04
Loss = 7.9501e-02, PNorm = 44.8577, GNorm = 2.2472, lr_0 = 1.8177e-04
Validation rmse = 0.101344
Validation r2 = 0.775453
Validation mse = 0.010271
Epoch 43
Loss = 7.9241e-02, PNorm = 44.8652, GNorm = 0.8786, lr_0 = 1.7764e-04
Loss = 7.9679e-02, PNorm = 44.8718, GNorm = 0.7277, lr_0 = 1.7397e-04
Validation rmse = 0.093139
Validation r2 = 0.810343
Validation mse = 0.008675
Epoch 44
Loss = 7.8765e-02, PNorm = 44.8785, GNorm = 1.1485, lr_0 = 1.7037e-04
Loss = 8.4460e-02, PNorm = 44.8870, GNorm = 1.1065, lr_0 = 1.6685e-04
Validation rmse = 0.064711
Validation r2 = 0.908449
Validation mse = 0.004188
Epoch 45
Loss = 6.6050e-02, PNorm = 44.8949, GNorm = 0.8284, lr_0 = 1.6306e-04
Loss = 5.8788e-02, PNorm = 44.9014, GNorm = 1.1327, lr_0 = 1.5969e-04
Validation rmse = 0.064528
Validation r2 = 0.908966
Validation mse = 0.004164
Epoch 46
Loss = 6.6061e-02, PNorm = 44.9078, GNorm = 3.4180, lr_0 = 1.5638e-04
Loss = 7.0250e-02, PNorm = 44.9143, GNorm = 1.2586, lr_0 = 1.5315e-04
Validation rmse = 0.062431
Validation r2 = 0.914787
Validation mse = 0.003898
Epoch 47
Loss = 4.8617e-02, PNorm = 44.9203, GNorm = 0.5288, lr_0 = 1.4967e-04
Loss = 7.0397e-02, PNorm = 44.9261, GNorm = 0.9693, lr_0 = 1.4658e-04
Validation rmse = 0.062175
Validation r2 = 0.915484
Validation mse = 0.003866
Epoch 48
Loss = 5.6758e-02, PNorm = 44.9328, GNorm = 0.5266, lr_0 = 1.4354e-04
Loss = 6.4669e-02, PNorm = 44.9395, GNorm = 1.0637, lr_0 = 1.4058e-04
Validation rmse = 0.065780
Validation r2 = 0.905399
Validation mse = 0.004327
Epoch 49
Loss = 6.1456e-02, PNorm = 44.9449, GNorm = 0.6351, lr_0 = 1.3738e-04
Loss = 6.1400e-02, PNorm = 44.9508, GNorm = 1.0298, lr_0 = 1.3454e-04
Validation rmse = 0.065279
Validation r2 = 0.906834
Validation mse = 0.004261
Epoch 50
Loss = 6.3526e-02, PNorm = 44.9562, GNorm = 0.9664, lr_0 = 1.3176e-04
Loss = 5.5184e-02, PNorm = 44.9616, GNorm = 0.8941, lr_0 = 1.2904e-04
Validation rmse = 0.059884
Validation r2 = 0.921598
Validation mse = 0.003586
Epoch 51
Loss = 6.3202e-02, PNorm = 44.9676, GNorm = 0.7490, lr_0 = 1.2610e-04
Loss = 5.8221e-02, PNorm = 44.9730, GNorm = 1.0449, lr_0 = 1.2350e-04
Validation rmse = 0.063819
Validation r2 = 0.910954
Validation mse = 0.004073
Epoch 52
Loss = 6.0136e-02, PNorm = 44.9784, GNorm = 1.2545, lr_0 = 1.2069e-04
Loss = 5.6123e-02, PNorm = 44.9827, GNorm = 2.0389, lr_0 = 1.1819e-04
Validation rmse = 0.062503
Validation r2 = 0.914590
Validation mse = 0.003907
Epoch 53
Loss = 5.4858e-02, PNorm = 44.9882, GNorm = 1.0552, lr_0 = 1.1575e-04
Loss = 5.9447e-02, PNorm = 44.9932, GNorm = 1.5160, lr_0 = 1.1336e-04
Loss = 5.4117e-02, PNorm = 44.9938, GNorm = 2.0046, lr_0 = 1.1312e-04
Validation rmse = 0.062852
Validation r2 = 0.913634
Validation mse = 0.003950
Epoch 54
Loss = 5.7870e-02, PNorm = 44.9984, GNorm = 1.3879, lr_0 = 1.1078e-04
Loss = 5.8616e-02, PNorm = 45.0031, GNorm = 1.4189, lr_0 = 1.0849e-04
Validation rmse = 0.061994
Validation r2 = 0.915975
Validation mse = 0.003843
Epoch 55
Loss = 5.4390e-02, PNorm = 45.0076, GNorm = 0.4088, lr_0 = 1.0625e-04
Validation rmse = 0.058312
Validation r2 = 0.925661
Validation mse = 0.003400
Epoch 56
Loss = 5.9476e-02, PNorm = 45.0128, GNorm = 1.1764, lr_0 = 1.0383e-04
Loss = 5.4799e-02, PNorm = 45.0164, GNorm = 0.7153, lr_0 = 1.0169e-04
Validation rmse = 0.064723
Validation r2 = 0.908413
Validation mse = 0.004189
Epoch 57
Loss = 5.4934e-02, PNorm = 45.0205, GNorm = 1.0429, lr_0 = 1.0000e-04
Loss = 4.8725e-02, PNorm = 45.0249, GNorm = 0.6600, lr_0 = 1.0000e-04
Validation rmse = 0.058822
Validation r2 = 0.924353
Validation mse = 0.003460
Epoch 58
Loss = 5.2956e-02, PNorm = 45.0293, GNorm = 2.4038, lr_0 = 1.0000e-04
Loss = 5.9435e-02, PNorm = 45.0338, GNorm = 0.6113, lr_0 = 1.0000e-04
Validation rmse = 0.064164
Validation r2 = 0.909991
Validation mse = 0.004117
Epoch 59
Loss = 6.4474e-02, PNorm = 45.0382, GNorm = 1.4151, lr_0 = 1.0000e-04
Loss = 4.9181e-02, PNorm = 45.0424, GNorm = 1.1853, lr_0 = 1.0000e-04
Validation rmse = 0.057187
Validation r2 = 0.928500
Validation mse = 0.003270
Model 0 best validation rmse = 0.057187 on epoch 59
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.684782
Model 0 test r2 = -129.994289
Model 0 test mse = 0.468927
Ensemble test rmse = 0.684782
Ensemble test r2 = -129.994289
Ensemble test mse = 0.468927
Fold 3
Splitting data with seed 3
Total size = 983 | train size = 973 | val size = 10 | test size = 49
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.3984e-01, PNorm = 43.2635, GNorm = 0.9166, lr_0 = 3.6053e-04
Validation rmse = 0.203890
Validation r2 = 0.399338
Validation mse = 0.041571
Epoch 1
Loss = 3.7754e-01, PNorm = 43.2941, GNorm = 1.6929, lr_0 = 6.2105e-04
Loss = 5.8819e-01, PNorm = 43.3300, GNorm = 5.1455, lr_0 = 8.5789e-04
Validation rmse = 0.249419
Validation r2 = 0.101130
Validation mse = 0.062210
Epoch 2
Loss = 3.8192e-01, PNorm = 43.4009, GNorm = 1.5117, lr_0 = 9.8961e-04
Loss = 3.7792e-01, PNorm = 43.4871, GNorm = 11.7138, lr_0 = 9.6914e-04
Validation rmse = 0.219852
Validation r2 = 0.301610
Validation mse = 0.048335
Epoch 3
Loss = 4.1647e-01, PNorm = 43.5537, GNorm = 4.0624, lr_0 = 9.4910e-04
Loss = 2.9547e-01, PNorm = 43.6175, GNorm = 1.1256, lr_0 = 9.2948e-04
Validation rmse = 0.098313
Validation r2 = 0.860345
Validation mse = 0.009665
Epoch 4
Loss = 2.4913e-01, PNorm = 43.6805, GNorm = 1.3505, lr_0 = 9.0836e-04
Loss = 2.9279e-01, PNorm = 43.7287, GNorm = 7.3849, lr_0 = 8.8958e-04
Validation rmse = 0.234009
Validation r2 = 0.208774
Validation mse = 0.054760
Epoch 5
Loss = 2.7214e-01, PNorm = 43.7685, GNorm = 4.6251, lr_0 = 8.7118e-04
Loss = 2.8045e-01, PNorm = 43.8081, GNorm = 1.6491, lr_0 = 8.5317e-04
Validation rmse = 0.235887
Validation r2 = 0.196021
Validation mse = 0.055643
Epoch 6
Loss = 2.5308e-01, PNorm = 43.8482, GNorm = 3.8585, lr_0 = 8.3378e-04
Loss = 1.8639e-01, PNorm = 43.8823, GNorm = 2.4869, lr_0 = 8.1654e-04
Validation rmse = 0.184226
Validation r2 = 0.509612
Validation mse = 0.033939
Epoch 7
Loss = 2.1052e-01, PNorm = 43.9093, GNorm = 4.6632, lr_0 = 7.9966e-04
Loss = 1.7158e-01, PNorm = 43.9329, GNorm = 3.9599, lr_0 = 7.8312e-04
Validation rmse = 0.211750
Validation r2 = 0.352135
Validation mse = 0.044838
Epoch 8
Loss = 2.0820e-01, PNorm = 43.9645, GNorm = 5.9803, lr_0 = 7.6533e-04
Loss = 1.9101e-01, PNorm = 43.9920, GNorm = 5.8213, lr_0 = 7.4950e-04
Validation rmse = 0.187762
Validation r2 = 0.490605
Validation mse = 0.035255
Epoch 9
Loss = 2.0085e-01, PNorm = 44.0240, GNorm = 3.9107, lr_0 = 7.3400e-04
Loss = 1.5923e-01, PNorm = 44.0494, GNorm = 2.0217, lr_0 = 7.1883e-04
Validation rmse = 0.131503
Validation r2 = 0.750133
Validation mse = 0.017293
Epoch 10
Loss = 1.5177e-01, PNorm = 44.0805, GNorm = 1.7878, lr_0 = 7.0249e-04
Loss = 1.7016e-01, PNorm = 44.1014, GNorm = 2.3454, lr_0 = 6.8797e-04
Validation rmse = 0.171143
Validation r2 = 0.576789
Validation mse = 0.029290
Epoch 11
Loss = 1.4432e-01, PNorm = 44.1120, GNorm = 0.9813, lr_0 = 6.7374e-04
Loss = 1.4401e-01, PNorm = 44.1311, GNorm = 3.9533, lr_0 = 6.5981e-04
Validation rmse = 0.092795
Validation r2 = 0.875581
Validation mse = 0.008611
Epoch 12
Loss = 1.5764e-01, PNorm = 44.1536, GNorm = 1.5186, lr_0 = 6.4482e-04
Loss = 1.3740e-01, PNorm = 44.1747, GNorm = 2.3459, lr_0 = 6.3148e-04
Validation rmse = 0.129231
Validation r2 = 0.758694
Validation mse = 0.016701
Epoch 13
Loss = 1.4583e-01, PNorm = 44.1939, GNorm = 3.4033, lr_0 = 6.1714e-04
Loss = 1.5910e-01, PNorm = 44.2129, GNorm = 2.2407, lr_0 = 6.0438e-04
Validation rmse = 0.137971
Validation r2 = 0.724949
Validation mse = 0.019036
Epoch 14
Loss = 1.4332e-01, PNorm = 44.2344, GNorm = 1.3824, lr_0 = 5.9188e-04
Loss = 1.2208e-01, PNorm = 44.2505, GNorm = 0.9196, lr_0 = 5.7964e-04
Validation rmse = 0.148463
Validation r2 = 0.681527
Validation mse = 0.022041
Epoch 15
Loss = 1.2912e-01, PNorm = 44.2695, GNorm = 0.9137, lr_0 = 5.6647e-04
Loss = 1.3691e-01, PNorm = 44.2883, GNorm = 2.6298, lr_0 = 5.5476e-04
Validation rmse = 0.089429
Validation r2 = 0.884443
Validation mse = 0.007998
Epoch 16
Loss = 1.3816e-01, PNorm = 44.3052, GNorm = 0.8386, lr_0 = 5.4328e-04
Loss = 1.3725e-01, PNorm = 44.3244, GNorm = 1.6218, lr_0 = 5.3205e-04
Loss = 1.7407e-01, PNorm = 44.3252, GNorm = 2.0230, lr_0 = 5.3094e-04
Validation rmse = 0.201105
Validation r2 = 0.415640
Validation mse = 0.040443
Epoch 17
Loss = 1.6250e-01, PNorm = 44.3412, GNorm = 3.5053, lr_0 = 5.1996e-04
Loss = 1.6453e-01, PNorm = 44.3698, GNorm = 1.7664, lr_0 = 5.0921e-04
Validation rmse = 0.125826
Validation r2 = 0.771240
Validation mse = 0.015832
Epoch 18
Loss = 1.1274e-01, PNorm = 44.3879, GNorm = 1.5911, lr_0 = 4.9868e-04
Validation rmse = 0.171466
Validation r2 = 0.575190
Validation mse = 0.029401
Epoch 19
Loss = 2.0025e-01, PNorm = 44.4058, GNorm = 2.4466, lr_0 = 4.8735e-04
Loss = 1.3600e-01, PNorm = 44.4223, GNorm = 1.4030, lr_0 = 4.7727e-04
Validation rmse = 0.098549
Validation r2 = 0.859672
Validation mse = 0.009712
Epoch 20
Loss = 1.2073e-01, PNorm = 44.4379, GNorm = 1.9945, lr_0 = 4.6740e-04
Loss = 1.0172e-01, PNorm = 44.4532, GNorm = 0.7469, lr_0 = 4.5774e-04
Validation rmse = 0.144714
Validation r2 = 0.697409
Validation mse = 0.020942
Epoch 21
Loss = 1.5983e-01, PNorm = 44.4662, GNorm = 5.4321, lr_0 = 4.4734e-04
Loss = 1.4466e-01, PNorm = 44.4897, GNorm = 3.4394, lr_0 = 4.3809e-04
Validation rmse = 0.106068
Validation r2 = 0.837442
Validation mse = 0.011251
Epoch 22
Loss = 1.1342e-01, PNorm = 44.5017, GNorm = 1.0547, lr_0 = 4.2903e-04
Loss = 1.1667e-01, PNorm = 44.5186, GNorm = 2.2572, lr_0 = 4.2016e-04
Validation rmse = 0.114279
Validation r2 = 0.811301
Validation mse = 0.013060
Epoch 23
Loss = 9.6558e-02, PNorm = 44.5335, GNorm = 0.7488, lr_0 = 4.1061e-04
Loss = 1.1029e-01, PNorm = 44.5464, GNorm = 1.5206, lr_0 = 4.0212e-04
Validation rmse = 0.152462
Validation r2 = 0.664140
Validation mse = 0.023245
Epoch 24
Loss = 1.0739e-01, PNorm = 44.5592, GNorm = 1.4415, lr_0 = 3.9381e-04
Loss = 1.0905e-01, PNorm = 44.5717, GNorm = 0.9314, lr_0 = 3.8566e-04
Validation rmse = 0.095923
Validation r2 = 0.867053
Validation mse = 0.009201
Epoch 25
Loss = 1.0750e-01, PNorm = 44.5853, GNorm = 1.7071, lr_0 = 3.7690e-04
Loss = 1.0776e-01, PNorm = 44.6013, GNorm = 1.4226, lr_0 = 3.6911e-04
Validation rmse = 0.099500
Validation r2 = 0.856950
Validation mse = 0.009900
Epoch 26
Loss = 1.0796e-01, PNorm = 44.6137, GNorm = 4.2745, lr_0 = 3.6072e-04
Loss = 9.8570e-02, PNorm = 44.6258, GNorm = 1.3838, lr_0 = 3.5326e-04
Validation rmse = 0.109619
Validation r2 = 0.826377
Validation mse = 0.012016
Epoch 27
Loss = 9.0754e-02, PNorm = 44.6387, GNorm = 0.6777, lr_0 = 3.4596e-04
Loss = 1.0749e-01, PNorm = 44.6537, GNorm = 3.2074, lr_0 = 3.3880e-04
Validation rmse = 0.139390
Validation r2 = 0.719262
Validation mse = 0.019430
Epoch 28
Loss = 1.0418e-01, PNorm = 44.6695, GNorm = 1.8910, lr_0 = 3.3110e-04
Loss = 9.9601e-02, PNorm = 44.6810, GNorm = 2.0663, lr_0 = 3.2426e-04
Validation rmse = 0.142066
Validation r2 = 0.708380
Validation mse = 0.020183
Epoch 29
Loss = 9.5220e-02, PNorm = 44.6935, GNorm = 2.4894, lr_0 = 3.1755e-04
Loss = 1.1899e-01, PNorm = 44.7059, GNorm = 2.8378, lr_0 = 3.1099e-04
Validation rmse = 0.119556
Validation r2 = 0.793472
Validation mse = 0.014294
Epoch 30
Loss = 1.0027e-01, PNorm = 44.7192, GNorm = 1.7339, lr_0 = 3.0392e-04
Loss = 8.0071e-02, PNorm = 44.7302, GNorm = 1.8137, lr_0 = 2.9764e-04
Validation rmse = 0.102692
Validation r2 = 0.847627
Validation mse = 0.010546
Epoch 31
Loss = 7.8428e-02, PNorm = 44.7397, GNorm = 0.6729, lr_0 = 2.9148e-04
Loss = 9.0748e-02, PNorm = 44.7506, GNorm = 1.5639, lr_0 = 2.8545e-04
Validation rmse = 0.092544
Validation r2 = 0.876254
Validation mse = 0.008564
Epoch 32
Loss = 9.1938e-02, PNorm = 44.7628, GNorm = 0.8119, lr_0 = 2.7897e-04
Loss = 9.3531e-02, PNorm = 44.7736, GNorm = 0.9555, lr_0 = 2.7320e-04
Validation rmse = 0.094962
Validation r2 = 0.869701
Validation mse = 0.009018
Epoch 33
Loss = 6.7528e-02, PNorm = 44.7817, GNorm = 0.6509, lr_0 = 2.6755e-04
Loss = 9.2169e-02, PNorm = 44.7933, GNorm = 0.6946, lr_0 = 2.6202e-04
Validation rmse = 0.138521
Validation r2 = 0.722752
Validation mse = 0.019188
Epoch 34
Loss = 8.8571e-02, PNorm = 44.8045, GNorm = 1.6077, lr_0 = 2.5606e-04
Loss = 7.8174e-02, PNorm = 44.8154, GNorm = 1.9977, lr_0 = 2.5077e-04
Validation rmse = 0.133364
Validation r2 = 0.743013
Validation mse = 0.017786
Epoch 35
Loss = 7.1222e-02, PNorm = 44.8229, GNorm = 1.0653, lr_0 = 2.4558e-04
Loss = 8.6563e-02, PNorm = 44.8325, GNorm = 0.7291, lr_0 = 2.4051e-04
Loss = 8.0660e-02, PNorm = 44.8335, GNorm = 1.2655, lr_0 = 2.4000e-04
Validation rmse = 0.127308
Validation r2 = 0.765821
Validation mse = 0.016207
Epoch 36
Loss = 6.4222e-02, PNorm = 44.8442, GNorm = 0.8759, lr_0 = 2.3504e-04
Loss = 9.4894e-02, PNorm = 44.8532, GNorm = 1.4511, lr_0 = 2.3018e-04
Validation rmse = 0.119223
Validation r2 = 0.794620
Validation mse = 0.014214
Epoch 37
Loss = 6.6531e-02, PNorm = 44.8637, GNorm = 0.9750, lr_0 = 2.2542e-04
Validation rmse = 0.107568
Validation r2 = 0.832814
Validation mse = 0.011571
Epoch 38
Loss = 6.6938e-02, PNorm = 44.8707, GNorm = 2.2992, lr_0 = 2.2030e-04
Loss = 8.4239e-02, PNorm = 44.8816, GNorm = 1.7018, lr_0 = 2.1574e-04
Validation rmse = 0.125428
Validation r2 = 0.772687
Validation mse = 0.015732
Epoch 39
Loss = 7.2216e-02, PNorm = 44.8894, GNorm = 1.9204, lr_0 = 2.1084e-04
Loss = 7.4814e-02, PNorm = 44.8979, GNorm = 1.8157, lr_0 = 2.0648e-04
Validation rmse = 0.125720
Validation r2 = 0.771626
Validation mse = 0.015806
Epoch 40
Loss = 8.1236e-02, PNorm = 44.9059, GNorm = 2.9838, lr_0 = 2.0221e-04
Loss = 6.5462e-02, PNorm = 44.9132, GNorm = 0.8043, lr_0 = 1.9803e-04
Validation rmse = 0.110658
Validation r2 = 0.823069
Validation mse = 0.012245
Epoch 41
Loss = 6.7773e-02, PNorm = 44.9226, GNorm = 0.7912, lr_0 = 1.9353e-04
Loss = 7.3897e-02, PNorm = 44.9310, GNorm = 1.1604, lr_0 = 1.8953e-04
Validation rmse = 0.107973
Validation r2 = 0.831551
Validation mse = 0.011658
Epoch 42
Loss = 5.0512e-02, PNorm = 44.9378, GNorm = 0.4624, lr_0 = 1.8561e-04
Loss = 6.8521e-02, PNorm = 44.9443, GNorm = 1.4881, lr_0 = 1.8177e-04
Validation rmse = 0.104782
Validation r2 = 0.841361
Validation mse = 0.010979
Epoch 43
Loss = 7.2186e-02, PNorm = 44.9524, GNorm = 1.5718, lr_0 = 1.7764e-04
Loss = 7.0657e-02, PNorm = 44.9600, GNorm = 1.8524, lr_0 = 1.7397e-04
Validation rmse = 0.115286
Validation r2 = 0.807960
Validation mse = 0.013291
Epoch 44
Loss = 7.0619e-02, PNorm = 44.9681, GNorm = 1.2403, lr_0 = 1.7037e-04
Loss = 5.9354e-02, PNorm = 44.9758, GNorm = 1.1228, lr_0 = 1.6685e-04
Validation rmse = 0.114433
Validation r2 = 0.810791
Validation mse = 0.013095
Epoch 45
Loss = 7.1785e-02, PNorm = 44.9834, GNorm = 0.7484, lr_0 = 1.6306e-04
Loss = 6.5901e-02, PNorm = 44.9896, GNorm = 1.8782, lr_0 = 1.5969e-04
Validation rmse = 0.113029
Validation r2 = 0.815405
Validation mse = 0.012776
Epoch 46
Loss = 5.9399e-02, PNorm = 44.9964, GNorm = 0.8194, lr_0 = 1.5638e-04
Loss = 6.8334e-02, PNorm = 45.0031, GNorm = 2.4130, lr_0 = 1.5315e-04
Validation rmse = 0.095767
Validation r2 = 0.867484
Validation mse = 0.009171
Epoch 47
Loss = 6.8911e-02, PNorm = 45.0105, GNorm = 1.6321, lr_0 = 1.4967e-04
Loss = 6.5232e-02, PNorm = 45.0166, GNorm = 1.4700, lr_0 = 1.4658e-04
Validation rmse = 0.116009
Validation r2 = 0.805543
Validation mse = 0.013458
Epoch 48
Loss = 7.0446e-02, PNorm = 45.0231, GNorm = 0.8160, lr_0 = 1.4354e-04
Loss = 6.1145e-02, PNorm = 45.0293, GNorm = 1.0260, lr_0 = 1.4058e-04
Validation rmse = 0.117655
Validation r2 = 0.799988
Validation mse = 0.013843
Epoch 49
Loss = 5.7069e-02, PNorm = 45.0363, GNorm = 0.8591, lr_0 = 1.3738e-04
Loss = 6.5612e-02, PNorm = 45.0422, GNorm = 1.9771, lr_0 = 1.3454e-04
Validation rmse = 0.104835
Validation r2 = 0.841200
Validation mse = 0.010990
Epoch 50
Loss = 5.8268e-02, PNorm = 45.0477, GNorm = 0.9281, lr_0 = 1.3176e-04
Loss = 6.0996e-02, PNorm = 45.0531, GNorm = 0.4582, lr_0 = 1.2904e-04
Validation rmse = 0.106477
Validation r2 = 0.836186
Validation mse = 0.011337
Epoch 51
Loss = 6.7083e-02, PNorm = 45.0593, GNorm = 1.0390, lr_0 = 1.2610e-04
Loss = 4.9810e-02, PNorm = 45.0650, GNorm = 1.0024, lr_0 = 1.2350e-04
Validation rmse = 0.117019
Validation r2 = 0.802143
Validation mse = 0.013694
Epoch 52
Loss = 5.2416e-02, PNorm = 45.0705, GNorm = 0.6643, lr_0 = 1.2069e-04
Loss = 6.1481e-02, PNorm = 45.0748, GNorm = 1.0865, lr_0 = 1.1819e-04
Validation rmse = 0.104698
Validation r2 = 0.841614
Validation mse = 0.010962
Epoch 53
Loss = 5.3683e-02, PNorm = 45.0802, GNorm = 1.4987, lr_0 = 1.1575e-04
Loss = 6.2858e-02, PNorm = 45.0849, GNorm = 0.8325, lr_0 = 1.1336e-04
Loss = 5.7006e-02, PNorm = 45.0853, GNorm = 1.5439, lr_0 = 1.1312e-04
Validation rmse = 0.103474
Validation r2 = 0.845297
Validation mse = 0.010707
Epoch 54
Loss = 5.6688e-02, PNorm = 45.0903, GNorm = 1.2551, lr_0 = 1.1078e-04
Loss = 6.0016e-02, PNorm = 45.0949, GNorm = 1.5808, lr_0 = 1.0849e-04
Validation rmse = 0.100567
Validation r2 = 0.853868
Validation mse = 0.010114
Epoch 55
Loss = 5.5075e-02, PNorm = 45.0995, GNorm = 0.4693, lr_0 = 1.0625e-04
Validation rmse = 0.107494
Validation r2 = 0.833042
Validation mse = 0.011555
Epoch 56
Loss = 6.3185e-02, PNorm = 45.1043, GNorm = 0.6635, lr_0 = 1.0383e-04
Loss = 6.0043e-02, PNorm = 45.1090, GNorm = 0.6560, lr_0 = 1.0169e-04
Validation rmse = 0.114086
Validation r2 = 0.811937
Validation mse = 0.013016
Epoch 57
Loss = 6.5621e-02, PNorm = 45.1131, GNorm = 1.0269, lr_0 = 1.0000e-04
Loss = 4.9875e-02, PNorm = 45.1171, GNorm = 0.8052, lr_0 = 1.0000e-04
Validation rmse = 0.114871
Validation r2 = 0.809341
Validation mse = 0.013195
Epoch 58
Loss = 4.7895e-02, PNorm = 45.1218, GNorm = 0.6893, lr_0 = 1.0000e-04
Loss = 5.3590e-02, PNorm = 45.1262, GNorm = 0.6718, lr_0 = 1.0000e-04
Validation rmse = 0.109662
Validation r2 = 0.826239
Validation mse = 0.012026
Epoch 59
Loss = 8.8992e-02, PNorm = 45.1302, GNorm = 0.9215, lr_0 = 1.0000e-04
Loss = 4.3390e-02, PNorm = 45.1347, GNorm = 0.5796, lr_0 = 1.0000e-04
Validation rmse = 0.104966
Validation r2 = 0.840803
Validation mse = 0.011018
Model 0 best validation rmse = 0.089429 on epoch 15
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.776524
Model 0 test r2 = -167.444687
Model 0 test mse = 0.602990
Ensemble test rmse = 0.776524
Ensemble test r2 = -167.444687
Ensemble test mse = 0.602990
Fold 4
Splitting data with seed 4
Total size = 983 | train size = 973 | val size = 10 | test size = 49
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.6162e-01, PNorm = 43.2635, GNorm = 3.9855, lr_0 = 3.6053e-04
Validation rmse = 0.389565
Validation r2 = 0.077805
Validation mse = 0.151761
Epoch 1
Loss = 9.3010e-01, PNorm = 43.2859, GNorm = 4.9559, lr_0 = 6.2105e-04
Loss = 8.1020e-01, PNorm = 43.3198, GNorm = 3.0670, lr_0 = 8.5789e-04
Validation rmse = 0.253645
Validation r2 = 0.609057
Validation mse = 0.064336
Epoch 2
Loss = 6.4847e-01, PNorm = 43.3972, GNorm = 12.9836, lr_0 = 9.8961e-04
Loss = 5.8111e-01, PNorm = 43.4671, GNorm = 3.0446, lr_0 = 9.6914e-04
Validation rmse = 0.257700
Validation r2 = 0.596456
Validation mse = 0.066409
Epoch 3
Loss = 3.4687e-01, PNorm = 43.5508, GNorm = 6.5339, lr_0 = 9.4910e-04
Loss = 3.6997e-01, PNorm = 43.6178, GNorm = 1.1379, lr_0 = 9.2948e-04
Validation rmse = 0.255854
Validation r2 = 0.602216
Validation mse = 0.065461
Epoch 4
Loss = 3.8968e-01, PNorm = 43.6806, GNorm = 4.9524, lr_0 = 9.0836e-04
Loss = 2.8499e-01, PNorm = 43.7302, GNorm = 1.0435, lr_0 = 8.8958e-04
Validation rmse = 0.234678
Validation r2 = 0.665338
Validation mse = 0.055074
Epoch 5
Loss = 2.1935e-01, PNorm = 43.7801, GNorm = 1.6089, lr_0 = 8.7118e-04
Loss = 2.3410e-01, PNorm = 43.8236, GNorm = 0.6380, lr_0 = 8.5317e-04
Validation rmse = 0.236089
Validation r2 = 0.661302
Validation mse = 0.055738
Epoch 6
Loss = 2.1891e-01, PNorm = 43.8626, GNorm = 5.0979, lr_0 = 8.3378e-04
Loss = 2.5073e-01, PNorm = 43.8990, GNorm = 4.7946, lr_0 = 8.1654e-04
Validation rmse = 0.267208
Validation r2 = 0.566127
Validation mse = 0.071400
Epoch 7
Loss = 2.7594e-01, PNorm = 43.9345, GNorm = 5.2293, lr_0 = 7.9966e-04
Loss = 2.3213e-01, PNorm = 43.9700, GNorm = 2.1829, lr_0 = 7.8312e-04
Validation rmse = 0.203681
Validation r2 = 0.747906
Validation mse = 0.041486
Epoch 8
Loss = 1.8905e-01, PNorm = 44.0049, GNorm = 0.6656, lr_0 = 7.6533e-04
Loss = 1.7955e-01, PNorm = 44.0354, GNorm = 1.7954, lr_0 = 7.4950e-04
Validation rmse = 0.218576
Validation r2 = 0.709687
Validation mse = 0.047775
Epoch 9
Loss = 1.9020e-01, PNorm = 44.0600, GNorm = 0.7987, lr_0 = 7.3400e-04
Loss = 1.6026e-01, PNorm = 44.0804, GNorm = 2.6631, lr_0 = 7.1883e-04
Validation rmse = 0.191529
Validation r2 = 0.777090
Validation mse = 0.036683
Epoch 10
Loss = 1.8222e-01, PNorm = 44.1068, GNorm = 2.7681, lr_0 = 7.0249e-04
Loss = 1.4968e-01, PNorm = 44.1312, GNorm = 0.8443, lr_0 = 6.8797e-04
Validation rmse = 0.180886
Validation r2 = 0.801174
Validation mse = 0.032720
Epoch 11
Loss = 1.9851e-01, PNorm = 44.1548, GNorm = 2.9395, lr_0 = 6.7374e-04
Loss = 1.4970e-01, PNorm = 44.1788, GNorm = 3.3286, lr_0 = 6.5981e-04
Validation rmse = 0.198953
Validation r2 = 0.759473
Validation mse = 0.039582
Epoch 12
Loss = 1.4207e-01, PNorm = 44.2050, GNorm = 1.9993, lr_0 = 6.4482e-04
Loss = 1.4770e-01, PNorm = 44.2215, GNorm = 2.0010, lr_0 = 6.3148e-04
Validation rmse = 0.186362
Validation r2 = 0.788954
Validation mse = 0.034731
Epoch 13
Loss = 1.6096e-01, PNorm = 44.2434, GNorm = 2.7711, lr_0 = 6.1714e-04
Loss = 1.2004e-01, PNorm = 44.2624, GNorm = 0.7537, lr_0 = 6.0438e-04
Validation rmse = 0.173575
Validation r2 = 0.816922
Validation mse = 0.030128
Epoch 14
Loss = 1.3142e-01, PNorm = 44.2766, GNorm = 0.9194, lr_0 = 5.9188e-04
Loss = 1.3483e-01, PNorm = 44.2990, GNorm = 1.3424, lr_0 = 5.7964e-04
Validation rmse = 0.187872
Validation r2 = 0.785520
Validation mse = 0.035296
Epoch 15
Loss = 1.3189e-01, PNorm = 44.3171, GNorm = 1.8862, lr_0 = 5.6647e-04
Loss = 1.4362e-01, PNorm = 44.3332, GNorm = 2.2188, lr_0 = 5.5476e-04
Validation rmse = 0.196290
Validation r2 = 0.765870
Validation mse = 0.038530
Epoch 16
Loss = 1.2830e-01, PNorm = 44.3531, GNorm = 2.8535, lr_0 = 5.4328e-04
Loss = 1.3340e-01, PNorm = 44.3693, GNorm = 1.0630, lr_0 = 5.3205e-04
Loss = 1.3116e-01, PNorm = 44.3711, GNorm = 1.6332, lr_0 = 5.3094e-04
Validation rmse = 0.169488
Validation r2 = 0.825442
Validation mse = 0.028726
Epoch 17
Loss = 1.3200e-01, PNorm = 44.3891, GNorm = 5.3733, lr_0 = 5.1996e-04
Loss = 1.3825e-01, PNorm = 44.4086, GNorm = 1.3491, lr_0 = 5.0921e-04
Validation rmse = 0.161889
Validation r2 = 0.840743
Validation mse = 0.026208
Epoch 18
Loss = 1.1204e-01, PNorm = 44.4276, GNorm = 1.7173, lr_0 = 4.9868e-04
Validation rmse = 0.198457
Validation r2 = 0.760671
Validation mse = 0.039385
Epoch 19
Loss = 1.8198e-01, PNorm = 44.4444, GNorm = 3.5940, lr_0 = 4.8735e-04
Loss = 1.2686e-01, PNorm = 44.4624, GNorm = 3.4958, lr_0 = 4.7727e-04
Validation rmse = 0.178127
Validation r2 = 0.807195
Validation mse = 0.031729
Epoch 20
Loss = 1.6901e-01, PNorm = 44.4767, GNorm = 1.9448, lr_0 = 4.6740e-04
Loss = 1.2633e-01, PNorm = 44.4939, GNorm = 1.0616, lr_0 = 4.5774e-04
Validation rmse = 0.199583
Validation r2 = 0.757948
Validation mse = 0.039833
Epoch 21
Loss = 1.6039e-01, PNorm = 44.5092, GNorm = 2.9710, lr_0 = 4.4734e-04
Loss = 1.2401e-01, PNorm = 44.5235, GNorm = 2.0770, lr_0 = 4.3809e-04
Validation rmse = 0.177533
Validation r2 = 0.808478
Validation mse = 0.031518
Epoch 22
Loss = 8.7329e-02, PNorm = 44.5432, GNorm = 0.5876, lr_0 = 4.2903e-04
Loss = 1.0728e-01, PNorm = 44.5591, GNorm = 0.6906, lr_0 = 4.2016e-04
Validation rmse = 0.166516
Validation r2 = 0.831510
Validation mse = 0.027728
Epoch 23
Loss = 1.2441e-01, PNorm = 44.5741, GNorm = 1.9093, lr_0 = 4.1061e-04
Loss = 9.1633e-02, PNorm = 44.5880, GNorm = 1.0112, lr_0 = 4.0212e-04
Validation rmse = 0.150441
Validation r2 = 0.862471
Validation mse = 0.022633
Epoch 24
Loss = 1.1622e-01, PNorm = 44.6018, GNorm = 0.7341, lr_0 = 3.9381e-04
Loss = 9.8408e-02, PNorm = 44.6128, GNorm = 0.9281, lr_0 = 3.8566e-04
Validation rmse = 0.176364
Validation r2 = 0.810991
Validation mse = 0.031104
Epoch 25
Loss = 1.2006e-01, PNorm = 44.6266, GNorm = 0.8228, lr_0 = 3.7690e-04
Loss = 1.1666e-01, PNorm = 44.6396, GNorm = 1.6073, lr_0 = 3.6911e-04
Validation rmse = 0.164773
Validation r2 = 0.835018
Validation mse = 0.027150
Epoch 26
Loss = 1.2343e-01, PNorm = 44.6551, GNorm = 1.8861, lr_0 = 3.6072e-04
Loss = 1.1020e-01, PNorm = 44.6664, GNorm = 0.7966, lr_0 = 3.5326e-04
Validation rmse = 0.160483
Validation r2 = 0.843497
Validation mse = 0.025755
Epoch 27
Loss = 1.0741e-01, PNorm = 44.6831, GNorm = 1.1909, lr_0 = 3.4596e-04
Loss = 9.6588e-02, PNorm = 44.6935, GNorm = 1.5090, lr_0 = 3.3880e-04
Validation rmse = 0.164277
Validation r2 = 0.836010
Validation mse = 0.026987
Epoch 28
Loss = 7.9717e-02, PNorm = 44.7044, GNorm = 1.2259, lr_0 = 3.3110e-04
Loss = 1.0487e-01, PNorm = 44.7169, GNorm = 0.5330, lr_0 = 3.2426e-04
Validation rmse = 0.158415
Validation r2 = 0.847505
Validation mse = 0.025095
Epoch 29
Loss = 1.0426e-01, PNorm = 44.7283, GNorm = 1.3956, lr_0 = 3.1755e-04
Loss = 8.9012e-02, PNorm = 44.7375, GNorm = 0.9805, lr_0 = 3.1099e-04
Validation rmse = 0.162288
Validation r2 = 0.839958
Validation mse = 0.026337
Epoch 30
Loss = 8.1712e-02, PNorm = 44.7490, GNorm = 1.1499, lr_0 = 3.0392e-04
Loss = 1.0372e-01, PNorm = 44.7595, GNorm = 0.7104, lr_0 = 2.9764e-04
Validation rmse = 0.158246
Validation r2 = 0.847830
Validation mse = 0.025042
Epoch 31
Loss = 8.6276e-02, PNorm = 44.7692, GNorm = 1.8155, lr_0 = 2.9148e-04
Loss = 9.4042e-02, PNorm = 44.7805, GNorm = 1.1651, lr_0 = 2.8545e-04
Validation rmse = 0.157159
Validation r2 = 0.849914
Validation mse = 0.024699
Epoch 32
Loss = 8.6308e-02, PNorm = 44.7893, GNorm = 1.0754, lr_0 = 2.7897e-04
Loss = 9.4453e-02, PNorm = 44.7990, GNorm = 0.7482, lr_0 = 2.7320e-04
Validation rmse = 0.164134
Validation r2 = 0.836295
Validation mse = 0.026940
Epoch 33
Loss = 9.7191e-02, PNorm = 44.8100, GNorm = 1.2964, lr_0 = 2.6755e-04
Loss = 8.2628e-02, PNorm = 44.8204, GNorm = 0.8760, lr_0 = 2.6202e-04
Validation rmse = 0.154536
Validation r2 = 0.854882
Validation mse = 0.023881
Epoch 34
Loss = 8.8951e-02, PNorm = 44.8286, GNorm = 1.1439, lr_0 = 2.5606e-04
Loss = 1.0212e-01, PNorm = 44.8394, GNorm = 2.0524, lr_0 = 2.5077e-04
Validation rmse = 0.164666
Validation r2 = 0.835232
Validation mse = 0.027115
Epoch 35
Loss = 9.0892e-02, PNorm = 44.8500, GNorm = 1.3852, lr_0 = 2.4558e-04
Loss = 8.6330e-02, PNorm = 44.8604, GNorm = 1.3134, lr_0 = 2.4051e-04
Loss = 6.5326e-02, PNorm = 44.8615, GNorm = 1.8399, lr_0 = 2.4000e-04
Validation rmse = 0.159777
Validation r2 = 0.844873
Validation mse = 0.025529
Epoch 36
Loss = 8.4612e-02, PNorm = 44.8701, GNorm = 0.5511, lr_0 = 2.3504e-04
Loss = 8.0896e-02, PNorm = 44.8784, GNorm = 1.6647, lr_0 = 2.3018e-04
Validation rmse = 0.151022
Validation r2 = 0.861407
Validation mse = 0.022808
Epoch 37
Loss = 7.2834e-02, PNorm = 44.8858, GNorm = 0.7964, lr_0 = 2.2542e-04
Validation rmse = 0.149975
Validation r2 = 0.863321
Validation mse = 0.022493
Epoch 38
Loss = 6.8761e-02, PNorm = 44.8944, GNorm = 1.2722, lr_0 = 2.2030e-04
Loss = 8.7773e-02, PNorm = 44.9040, GNorm = 1.1536, lr_0 = 2.1574e-04
Validation rmse = 0.156177
Validation r2 = 0.851783
Validation mse = 0.024391
Epoch 39
Loss = 9.5386e-02, PNorm = 44.9136, GNorm = 1.2773, lr_0 = 2.1084e-04
Loss = 8.7369e-02, PNorm = 44.9201, GNorm = 2.4391, lr_0 = 2.0648e-04
Validation rmse = 0.154277
Validation r2 = 0.855367
Validation mse = 0.023802
Epoch 40
Loss = 5.5582e-02, PNorm = 44.9283, GNorm = 0.9472, lr_0 = 2.0221e-04
Loss = 7.7024e-02, PNorm = 44.9376, GNorm = 0.6691, lr_0 = 1.9803e-04
Validation rmse = 0.150037
Validation r2 = 0.863208
Validation mse = 0.022511
Epoch 41
Loss = 1.0259e-01, PNorm = 44.9453, GNorm = 2.1035, lr_0 = 1.9353e-04
Loss = 7.4160e-02, PNorm = 44.9529, GNorm = 0.7859, lr_0 = 1.8953e-04
Validation rmse = 0.152414
Validation r2 = 0.858840
Validation mse = 0.023230
Epoch 42
Loss = 6.4049e-02, PNorm = 44.9596, GNorm = 0.9256, lr_0 = 1.8561e-04
Loss = 7.9737e-02, PNorm = 44.9663, GNorm = 2.0406, lr_0 = 1.8177e-04
Validation rmse = 0.149240
Validation r2 = 0.864658
Validation mse = 0.022273
Epoch 43
Loss = 8.1263e-02, PNorm = 44.9749, GNorm = 1.8062, lr_0 = 1.7764e-04
Loss = 7.1330e-02, PNorm = 44.9813, GNorm = 0.8086, lr_0 = 1.7397e-04
Validation rmse = 0.152432
Validation r2 = 0.858806
Validation mse = 0.023236
Epoch 44
Loss = 5.4056e-02, PNorm = 44.9886, GNorm = 1.2923, lr_0 = 1.7037e-04
Loss = 7.8891e-02, PNorm = 44.9954, GNorm = 1.0043, lr_0 = 1.6685e-04
Validation rmse = 0.150896
Validation r2 = 0.861638
Validation mse = 0.022770
Epoch 45
Loss = 7.3490e-02, PNorm = 45.0043, GNorm = 1.8036, lr_0 = 1.6306e-04
Loss = 7.7774e-02, PNorm = 45.0117, GNorm = 1.1254, lr_0 = 1.5969e-04
Validation rmse = 0.147314
Validation r2 = 0.868129
Validation mse = 0.021701
Epoch 46
Loss = 7.3793e-02, PNorm = 45.0170, GNorm = 0.5716, lr_0 = 1.5638e-04
Loss = 6.3826e-02, PNorm = 45.0239, GNorm = 0.4653, lr_0 = 1.5315e-04
Validation rmse = 0.151285
Validation r2 = 0.860923
Validation mse = 0.022887
Epoch 47
Loss = 7.0890e-02, PNorm = 45.0308, GNorm = 0.7982, lr_0 = 1.4967e-04
Loss = 6.2573e-02, PNorm = 45.0359, GNorm = 0.9349, lr_0 = 1.4658e-04
Validation rmse = 0.145311
Validation r2 = 0.871690
Validation mse = 0.021115
Epoch 48
Loss = 7.0125e-02, PNorm = 45.0431, GNorm = 1.3959, lr_0 = 1.4354e-04
Loss = 6.3251e-02, PNorm = 45.0495, GNorm = 1.2561, lr_0 = 1.4058e-04
Validation rmse = 0.145319
Validation r2 = 0.871676
Validation mse = 0.021118
Epoch 49
Loss = 6.4169e-02, PNorm = 45.0551, GNorm = 1.0312, lr_0 = 1.3738e-04
Loss = 7.0477e-02, PNorm = 45.0609, GNorm = 0.7430, lr_0 = 1.3454e-04
Validation rmse = 0.148409
Validation r2 = 0.866162
Validation mse = 0.022025
Epoch 50
Loss = 6.6752e-02, PNorm = 45.0662, GNorm = 0.8269, lr_0 = 1.3176e-04
Loss = 6.5895e-02, PNorm = 45.0724, GNorm = 0.6886, lr_0 = 1.2904e-04
Validation rmse = 0.145404
Validation r2 = 0.871526
Validation mse = 0.021142
Epoch 51
Loss = 6.6875e-02, PNorm = 45.0783, GNorm = 0.8309, lr_0 = 1.2610e-04
Loss = 6.1849e-02, PNorm = 45.0834, GNorm = 0.7295, lr_0 = 1.2350e-04
Validation rmse = 0.143134
Validation r2 = 0.875506
Validation mse = 0.020487
Epoch 52
Loss = 5.7344e-02, PNorm = 45.0881, GNorm = 1.3802, lr_0 = 1.2069e-04
Loss = 7.5196e-02, PNorm = 45.0942, GNorm = 3.7242, lr_0 = 1.1819e-04
Validation rmse = 0.159440
Validation r2 = 0.845526
Validation mse = 0.025421
Epoch 53
Loss = 7.2451e-02, PNorm = 45.0988, GNorm = 0.5855, lr_0 = 1.1575e-04
Loss = 6.3787e-02, PNorm = 45.1029, GNorm = 1.7897, lr_0 = 1.1336e-04
Loss = 6.8491e-02, PNorm = 45.1037, GNorm = 1.7209, lr_0 = 1.1312e-04
Validation rmse = 0.144720
Validation r2 = 0.872733
Validation mse = 0.020944
Epoch 54
Loss = 6.0086e-02, PNorm = 45.1099, GNorm = 1.9743, lr_0 = 1.1078e-04
Loss = 7.4850e-02, PNorm = 45.1148, GNorm = 3.9423, lr_0 = 1.0849e-04
Validation rmse = 0.141775
Validation r2 = 0.877860
Validation mse = 0.020100
Epoch 55
Loss = 5.8636e-02, PNorm = 45.1206, GNorm = 0.7020, lr_0 = 1.0625e-04
Validation rmse = 0.147677
Validation r2 = 0.867478
Validation mse = 0.021809
Epoch 56
Loss = 4.4671e-02, PNorm = 45.1253, GNorm = 1.0472, lr_0 = 1.0383e-04
Loss = 6.2937e-02, PNorm = 45.1301, GNorm = 0.6410, lr_0 = 1.0169e-04
Validation rmse = 0.139521
Validation r2 = 0.881711
Validation mse = 0.019466
Epoch 57
Loss = 5.8479e-02, PNorm = 45.1337, GNorm = 0.7594, lr_0 = 1.0000e-04
Loss = 5.8936e-02, PNorm = 45.1380, GNorm = 0.9678, lr_0 = 1.0000e-04
Validation rmse = 0.150592
Validation r2 = 0.862194
Validation mse = 0.022678
Epoch 58
Loss = 6.0388e-02, PNorm = 45.1430, GNorm = 1.1774, lr_0 = 1.0000e-04
Loss = 6.9072e-02, PNorm = 45.1479, GNorm = 1.7627, lr_0 = 1.0000e-04
Validation rmse = 0.141777
Validation r2 = 0.877856
Validation mse = 0.020101
Epoch 59
Loss = 5.8898e-02, PNorm = 45.1520, GNorm = 0.7137, lr_0 = 1.0000e-04
Loss = 5.7126e-02, PNorm = 45.1564, GNorm = 1.1996, lr_0 = 1.0000e-04
Validation rmse = 0.139605
Validation r2 = 0.881570
Validation mse = 0.019489
Model 0 best validation rmse = 0.139521 on epoch 56
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.688462
Model 0 test r2 = -131.406028
Model 0 test mse = 0.473980
Ensemble test rmse = 0.688462
Ensemble test r2 = -131.406028
Ensemble test mse = 0.473980
Fold 5
Splitting data with seed 5
Total size = 983 | train size = 973 | val size = 10 | test size = 49
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.3049e-01, PNorm = 43.2632, GNorm = 1.1912, lr_0 = 3.6053e-04
Validation rmse = 0.314417
Validation r2 = 0.106772
Validation mse = 0.098858
Epoch 1
Loss = 5.0922e-01, PNorm = 43.2950, GNorm = 1.3209, lr_0 = 6.2105e-04
Loss = 5.9074e-01, PNorm = 43.3335, GNorm = 5.5576, lr_0 = 8.5789e-04
Validation rmse = 0.320335
Validation r2 = 0.072831
Validation mse = 0.102615
Epoch 2
Loss = 4.8502e-01, PNorm = 43.4000, GNorm = 1.2612, lr_0 = 9.8961e-04
Loss = 4.3180e-01, PNorm = 43.4867, GNorm = 1.3443, lr_0 = 9.6914e-04
Validation rmse = 0.279446
Validation r2 = 0.294421
Validation mse = 0.078090
Epoch 3
Loss = 4.6002e-01, PNorm = 43.5585, GNorm = 4.5570, lr_0 = 9.4910e-04
Loss = 4.3925e-01, PNorm = 43.6211, GNorm = 4.1248, lr_0 = 9.2948e-04
Validation rmse = 0.258309
Validation r2 = 0.397125
Validation mse = 0.066723
Epoch 4
Loss = 3.2299e-01, PNorm = 43.6787, GNorm = 3.2470, lr_0 = 9.0836e-04
Loss = 3.1453e-01, PNorm = 43.7273, GNorm = 4.7456, lr_0 = 8.8958e-04
Validation rmse = 0.233080
Validation r2 = 0.509137
Validation mse = 0.054326
Epoch 5
Loss = 2.3441e-01, PNorm = 43.7628, GNorm = 7.6443, lr_0 = 8.7118e-04
Loss = 2.5555e-01, PNorm = 43.8009, GNorm = 1.0760, lr_0 = 8.5317e-04
Validation rmse = 0.202810
Validation r2 = 0.628355
Validation mse = 0.041132
Epoch 6
Loss = 2.1976e-01, PNorm = 43.8288, GNorm = 1.1696, lr_0 = 8.3378e-04
Loss = 2.2573e-01, PNorm = 43.8576, GNorm = 3.9461, lr_0 = 8.1654e-04
Validation rmse = 0.196487
Validation r2 = 0.651168
Validation mse = 0.038607
Epoch 7
Loss = 2.0730e-01, PNorm = 43.8950, GNorm = 1.5887, lr_0 = 7.9966e-04
Loss = 1.8248e-01, PNorm = 43.9200, GNorm = 1.6824, lr_0 = 7.8312e-04
Validation rmse = 0.189766
Validation r2 = 0.674625
Validation mse = 0.036011
Epoch 8
Loss = 1.5301e-01, PNorm = 43.9442, GNorm = 0.8290, lr_0 = 7.6533e-04
Loss = 2.1496e-01, PNorm = 43.9686, GNorm = 4.9593, lr_0 = 7.4950e-04
Validation rmse = 0.183326
Validation r2 = 0.696333
Validation mse = 0.033608
Epoch 9
Loss = 1.5323e-01, PNorm = 43.9979, GNorm = 1.6104, lr_0 = 7.3400e-04
Loss = 1.9143e-01, PNorm = 44.0264, GNorm = 6.9049, lr_0 = 7.1883e-04
Validation rmse = 0.195422
Validation r2 = 0.654939
Validation mse = 0.038190
Epoch 10
Loss = 1.7939e-01, PNorm = 44.0523, GNorm = 1.9698, lr_0 = 7.0249e-04
Loss = 1.7745e-01, PNorm = 44.0816, GNorm = 2.2685, lr_0 = 6.8797e-04
Validation rmse = 0.187767
Validation r2 = 0.681441
Validation mse = 0.035257
Epoch 11
Loss = 1.8278e-01, PNorm = 44.1072, GNorm = 4.0969, lr_0 = 6.7374e-04
Loss = 1.8250e-01, PNorm = 44.1358, GNorm = 6.7813, lr_0 = 6.5981e-04
Validation rmse = 0.202391
Validation r2 = 0.629890
Validation mse = 0.040962
Epoch 12
Loss = 1.4924e-01, PNorm = 44.1623, GNorm = 2.1309, lr_0 = 6.4482e-04
Loss = 1.5038e-01, PNorm = 44.1841, GNorm = 1.3937, lr_0 = 6.3148e-04
Validation rmse = 0.183583
Validation r2 = 0.695482
Validation mse = 0.033703
Epoch 13
Loss = 1.5412e-01, PNorm = 44.2062, GNorm = 3.4386, lr_0 = 6.1714e-04
Loss = 1.8320e-01, PNorm = 44.2301, GNorm = 0.9754, lr_0 = 6.0438e-04
Validation rmse = 0.187113
Validation r2 = 0.683657
Validation mse = 0.035011
Epoch 14
Loss = 1.4175e-01, PNorm = 44.2521, GNorm = 1.1784, lr_0 = 5.9188e-04
Loss = 1.2858e-01, PNorm = 44.2779, GNorm = 0.7930, lr_0 = 5.7964e-04
Validation rmse = 0.184092
Validation r2 = 0.693790
Validation mse = 0.033890
Epoch 15
Loss = 1.2240e-01, PNorm = 44.2961, GNorm = 1.1483, lr_0 = 5.6647e-04
Loss = 1.4801e-01, PNorm = 44.3104, GNorm = 2.4200, lr_0 = 5.5476e-04
Validation rmse = 0.187608
Validation r2 = 0.681982
Validation mse = 0.035197
Epoch 16
Loss = 1.3982e-01, PNorm = 44.3294, GNorm = 0.9844, lr_0 = 5.4328e-04
Loss = 1.3671e-01, PNorm = 44.3489, GNorm = 1.9223, lr_0 = 5.3205e-04
Loss = 7.2456e-02, PNorm = 44.3505, GNorm = 0.9193, lr_0 = 5.3094e-04
Validation rmse = 0.184958
Validation r2 = 0.690902
Validation mse = 0.034210
Epoch 17
Loss = 1.1904e-01, PNorm = 44.3677, GNorm = 1.9411, lr_0 = 5.1996e-04
Loss = 1.4315e-01, PNorm = 44.3821, GNorm = 3.7273, lr_0 = 5.0921e-04
Validation rmse = 0.190384
Validation r2 = 0.672500
Validation mse = 0.036246
Epoch 18
Loss = 1.1779e-01, PNorm = 44.4001, GNorm = 1.2192, lr_0 = 4.9868e-04
Validation rmse = 0.176788
Validation r2 = 0.717606
Validation mse = 0.031254
Epoch 19
Loss = 5.1854e-02, PNorm = 44.4151, GNorm = 1.0576, lr_0 = 4.8735e-04
Loss = 1.2966e-01, PNorm = 44.4310, GNorm = 1.3703, lr_0 = 4.7727e-04
Validation rmse = 0.177550
Validation r2 = 0.715166
Validation mse = 0.031524
Epoch 20
Loss = 1.2736e-01, PNorm = 44.4462, GNorm = 0.8674, lr_0 = 4.6740e-04
Loss = 1.1715e-01, PNorm = 44.4621, GNorm = 1.0191, lr_0 = 4.5774e-04
Validation rmse = 0.172371
Validation r2 = 0.731541
Validation mse = 0.029712
Epoch 21
Loss = 1.1714e-01, PNorm = 44.4788, GNorm = 0.9514, lr_0 = 4.4734e-04
Loss = 1.0133e-01, PNorm = 44.4940, GNorm = 1.2497, lr_0 = 4.3809e-04
Validation rmse = 0.170425
Validation r2 = 0.737568
Validation mse = 0.029045
Epoch 22
Loss = 1.2129e-01, PNorm = 44.5069, GNorm = 1.3933, lr_0 = 4.2903e-04
Loss = 1.1563e-01, PNorm = 44.5224, GNorm = 2.1101, lr_0 = 4.2016e-04
Validation rmse = 0.179402
Validation r2 = 0.709195
Validation mse = 0.032185
Epoch 23
Loss = 9.8675e-02, PNorm = 44.5366, GNorm = 1.0109, lr_0 = 4.1061e-04
Loss = 9.3655e-02, PNorm = 44.5499, GNorm = 0.9483, lr_0 = 4.0212e-04
Validation rmse = 0.186568
Validation r2 = 0.685498
Validation mse = 0.034808
Epoch 24
Loss = 7.4970e-02, PNorm = 44.5649, GNorm = 0.9212, lr_0 = 3.9381e-04
Loss = 1.1884e-01, PNorm = 44.5773, GNorm = 3.5227, lr_0 = 3.8566e-04
Validation rmse = 0.150806
Validation r2 = 0.794512
Validation mse = 0.022742
Epoch 25
Loss = 1.0762e-01, PNorm = 44.5947, GNorm = 0.7899, lr_0 = 3.7690e-04
Loss = 1.2349e-01, PNorm = 44.6112, GNorm = 2.8107, lr_0 = 3.6911e-04
Validation rmse = 0.167141
Validation r2 = 0.747586
Validation mse = 0.027936
Epoch 26
Loss = 1.1274e-01, PNorm = 44.6246, GNorm = 1.7857, lr_0 = 3.6072e-04
Loss = 9.8801e-02, PNorm = 44.6377, GNorm = 0.5970, lr_0 = 3.5326e-04
Validation rmse = 0.171623
Validation r2 = 0.733868
Validation mse = 0.029454
Epoch 27
Loss = 1.1461e-01, PNorm = 44.6478, GNorm = 1.6951, lr_0 = 3.4596e-04
Loss = 9.8262e-02, PNorm = 44.6606, GNorm = 0.7742, lr_0 = 3.3880e-04
Validation rmse = 0.179171
Validation r2 = 0.709942
Validation mse = 0.032102
Epoch 28
Loss = 1.0156e-01, PNorm = 44.6735, GNorm = 2.7289, lr_0 = 3.3110e-04
Loss = 9.2777e-02, PNorm = 44.6841, GNorm = 2.1126, lr_0 = 3.2426e-04
Validation rmse = 0.170758
Validation r2 = 0.736543
Validation mse = 0.029158
Epoch 29
Loss = 9.1886e-02, PNorm = 44.6995, GNorm = 3.6557, lr_0 = 3.1755e-04
Loss = 9.8572e-02, PNorm = 44.7083, GNorm = 0.6653, lr_0 = 3.1099e-04
Validation rmse = 0.168021
Validation r2 = 0.744919
Validation mse = 0.028231
Epoch 30
Loss = 1.0153e-01, PNorm = 44.7202, GNorm = 0.7055, lr_0 = 3.0392e-04
Loss = 1.0313e-01, PNorm = 44.7284, GNorm = 0.9516, lr_0 = 2.9764e-04
Validation rmse = 0.167347
Validation r2 = 0.746964
Validation mse = 0.028005
Epoch 31
Loss = 9.4303e-02, PNorm = 44.7403, GNorm = 1.0162, lr_0 = 2.9148e-04
Loss = 1.0208e-01, PNorm = 44.7514, GNorm = 1.4916, lr_0 = 2.8545e-04
Validation rmse = 0.163928
Validation r2 = 0.757197
Validation mse = 0.026872
Epoch 32
Loss = 9.1490e-02, PNorm = 44.7638, GNorm = 2.1791, lr_0 = 2.7897e-04
Loss = 9.4723e-02, PNorm = 44.7760, GNorm = 0.9164, lr_0 = 2.7320e-04
Validation rmse = 0.162475
Validation r2 = 0.761480
Validation mse = 0.026398
Epoch 33
Loss = 9.4869e-02, PNorm = 44.7854, GNorm = 1.5064, lr_0 = 2.6755e-04
Loss = 8.1232e-02, PNorm = 44.7938, GNorm = 2.4074, lr_0 = 2.6202e-04
Validation rmse = 0.159320
Validation r2 = 0.770653
Validation mse = 0.025383
Epoch 34
Loss = 9.0634e-02, PNorm = 44.8037, GNorm = 1.8693, lr_0 = 2.5606e-04
Loss = 8.0020e-02, PNorm = 44.8130, GNorm = 0.8002, lr_0 = 2.5077e-04
Validation rmse = 0.158139
Validation r2 = 0.774042
Validation mse = 0.025008
Epoch 35
Loss = 7.8235e-02, PNorm = 44.8220, GNorm = 1.4023, lr_0 = 2.4558e-04
Loss = 8.8603e-02, PNorm = 44.8318, GNorm = 2.0209, lr_0 = 2.4051e-04
Loss = 1.5708e-01, PNorm = 44.8321, GNorm = 1.4736, lr_0 = 2.4000e-04
Validation rmse = 0.153680
Validation r2 = 0.786604
Validation mse = 0.023618
Epoch 36
Loss = 9.5472e-02, PNorm = 44.8415, GNorm = 0.5675, lr_0 = 2.3504e-04
Loss = 8.2082e-02, PNorm = 44.8498, GNorm = 1.6016, lr_0 = 2.3018e-04
Validation rmse = 0.153451
Validation r2 = 0.787240
Validation mse = 0.023547
Epoch 37
Loss = 7.5449e-02, PNorm = 44.8593, GNorm = 0.9351, lr_0 = 2.2542e-04
Validation rmse = 0.159218
Validation r2 = 0.770949
Validation mse = 0.025350
Epoch 38
Loss = 1.1003e-01, PNorm = 44.8686, GNorm = 0.7970, lr_0 = 2.2030e-04
Loss = 7.8199e-02, PNorm = 44.8781, GNorm = 1.0776, lr_0 = 2.1574e-04
Validation rmse = 0.159186
Validation r2 = 0.771042
Validation mse = 0.025340
Epoch 39
Loss = 5.6263e-02, PNorm = 44.8854, GNorm = 0.7291, lr_0 = 2.1084e-04
Loss = 7.4286e-02, PNorm = 44.8936, GNorm = 1.6869, lr_0 = 2.0648e-04
Validation rmse = 0.154193
Validation r2 = 0.785178
Validation mse = 0.023776
Epoch 40
Loss = 6.5509e-02, PNorm = 44.9010, GNorm = 1.5508, lr_0 = 2.0221e-04
Loss = 7.7674e-02, PNorm = 44.9085, GNorm = 0.9254, lr_0 = 1.9803e-04
Validation rmse = 0.153187
Validation r2 = 0.787971
Validation mse = 0.023466
Epoch 41
Loss = 5.3092e-02, PNorm = 44.9179, GNorm = 0.7205, lr_0 = 1.9353e-04
Loss = 7.5925e-02, PNorm = 44.9262, GNorm = 0.9747, lr_0 = 1.8953e-04
Validation rmse = 0.162672
Validation r2 = 0.760904
Validation mse = 0.026462
Epoch 42
Loss = 5.6117e-02, PNorm = 44.9325, GNorm = 1.1750, lr_0 = 1.8561e-04
Loss = 7.7448e-02, PNorm = 44.9390, GNorm = 1.3841, lr_0 = 1.8177e-04
Validation rmse = 0.153756
Validation r2 = 0.786394
Validation mse = 0.023641
Epoch 43
Loss = 6.4345e-02, PNorm = 44.9466, GNorm = 1.9973, lr_0 = 1.7764e-04
Loss = 7.2834e-02, PNorm = 44.9530, GNorm = 1.6811, lr_0 = 1.7397e-04
Validation rmse = 0.144746
Validation r2 = 0.810696
Validation mse = 0.020951
Epoch 44
Loss = 5.2568e-02, PNorm = 44.9610, GNorm = 0.9263, lr_0 = 1.7037e-04
Loss = 7.2318e-02, PNorm = 44.9675, GNorm = 1.6841, lr_0 = 1.6685e-04
Validation rmse = 0.151025
Validation r2 = 0.793914
Validation mse = 0.022809
Epoch 45
Loss = 7.2611e-02, PNorm = 44.9747, GNorm = 0.8567, lr_0 = 1.6306e-04
Loss = 6.2784e-02, PNorm = 44.9805, GNorm = 0.7539, lr_0 = 1.5969e-04
Validation rmse = 0.153884
Validation r2 = 0.786038
Validation mse = 0.023680
Epoch 46
Loss = 6.8517e-02, PNorm = 44.9865, GNorm = 0.9473, lr_0 = 1.5638e-04
Loss = 6.3009e-02, PNorm = 44.9925, GNorm = 1.1558, lr_0 = 1.5315e-04
Validation rmse = 0.158971
Validation r2 = 0.771658
Validation mse = 0.025272
Epoch 47
Loss = 4.6373e-02, PNorm = 44.9985, GNorm = 0.6851, lr_0 = 1.4967e-04
Loss = 7.1639e-02, PNorm = 45.0047, GNorm = 1.5551, lr_0 = 1.4658e-04
Validation rmse = 0.174946
Validation r2 = 0.723462
Validation mse = 0.030606
Epoch 48
Loss = 6.9840e-02, PNorm = 45.0095, GNorm = 2.1531, lr_0 = 1.4354e-04
Loss = 6.6645e-02, PNorm = 45.0155, GNorm = 0.4354, lr_0 = 1.4058e-04
Validation rmse = 0.151260
Validation r2 = 0.793273
Validation mse = 0.022880
Epoch 49
Loss = 6.2659e-02, PNorm = 45.0220, GNorm = 1.2304, lr_0 = 1.3738e-04
Loss = 6.1025e-02, PNorm = 45.0262, GNorm = 1.4417, lr_0 = 1.3454e-04
Validation rmse = 0.157350
Validation r2 = 0.776291
Validation mse = 0.024759
Epoch 50
Loss = 5.7611e-02, PNorm = 45.0312, GNorm = 0.8679, lr_0 = 1.3176e-04
Loss = 6.7787e-02, PNorm = 45.0363, GNorm = 1.3147, lr_0 = 1.2904e-04
Validation rmse = 0.149337
Validation r2 = 0.798497
Validation mse = 0.022301
Epoch 51
Loss = 6.6425e-02, PNorm = 45.0422, GNorm = 0.6355, lr_0 = 1.2610e-04
Loss = 6.2175e-02, PNorm = 45.0477, GNorm = 1.1981, lr_0 = 1.2350e-04
Validation rmse = 0.154735
Validation r2 = 0.783664
Validation mse = 0.023943
Epoch 52
Loss = 6.3270e-02, PNorm = 45.0527, GNorm = 0.7056, lr_0 = 1.2069e-04
Loss = 5.6062e-02, PNorm = 45.0565, GNorm = 0.6610, lr_0 = 1.1819e-04
Validation rmse = 0.148600
Validation r2 = 0.800479
Validation mse = 0.022082
Epoch 53
Loss = 6.2615e-02, PNorm = 45.0619, GNorm = 0.7675, lr_0 = 1.1575e-04
Loss = 6.0047e-02, PNorm = 45.0665, GNorm = 0.7777, lr_0 = 1.1336e-04
Loss = 2.9986e-02, PNorm = 45.0669, GNorm = 1.2301, lr_0 = 1.1312e-04
Validation rmse = 0.152935
Validation r2 = 0.788668
Validation mse = 0.023389
Epoch 54
Loss = 6.7405e-02, PNorm = 45.0716, GNorm = 2.1489, lr_0 = 1.1078e-04
Loss = 5.1073e-02, PNorm = 45.0759, GNorm = 1.4035, lr_0 = 1.0849e-04
Validation rmse = 0.151016
Validation r2 = 0.793941
Validation mse = 0.022806
Epoch 55
Loss = 6.1494e-02, PNorm = 45.0802, GNorm = 1.2332, lr_0 = 1.0625e-04
Validation rmse = 0.150867
Validation r2 = 0.794347
Validation mse = 0.022761
Epoch 56
Loss = 7.7534e-02, PNorm = 45.0841, GNorm = 0.9677, lr_0 = 1.0383e-04
Loss = 5.9445e-02, PNorm = 45.0887, GNorm = 1.9850, lr_0 = 1.0169e-04
Validation rmse = 0.151527
Validation r2 = 0.792543
Validation mse = 0.022960
Epoch 57
Loss = 6.5554e-02, PNorm = 45.0917, GNorm = 1.1549, lr_0 = 1.0000e-04
Loss = 5.9981e-02, PNorm = 45.0961, GNorm = 2.2184, lr_0 = 1.0000e-04
Validation rmse = 0.146618
Validation r2 = 0.805768
Validation mse = 0.021497
Epoch 58
Loss = 5.5913e-02, PNorm = 45.1000, GNorm = 2.1459, lr_0 = 1.0000e-04
Loss = 5.6852e-02, PNorm = 45.1036, GNorm = 1.2066, lr_0 = 1.0000e-04
Validation rmse = 0.153616
Validation r2 = 0.786784
Validation mse = 0.023598
Epoch 59
Loss = 4.6706e-02, PNorm = 45.1081, GNorm = 1.4936, lr_0 = 1.0000e-04
Loss = 5.9487e-02, PNorm = 45.1127, GNorm = 1.3316, lr_0 = 1.0000e-04
Validation rmse = 0.144736
Validation r2 = 0.810721
Validation mse = 0.020948
Model 0 best validation rmse = 0.144736 on epoch 59
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.674044
Model 0 test r2 = -125.918014
Model 0 test mse = 0.454335
Ensemble test rmse = 0.674044
Ensemble test r2 = -125.918014
Ensemble test mse = 0.454335
Fold 6
Splitting data with seed 6
Total size = 983 | train size = 973 | val size = 10 | test size = 49
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 1.0066e+00, PNorm = 43.2622, GNorm = 1.4389, lr_0 = 3.6053e-04
Validation rmse = 0.223752
Validation r2 = 0.360060
Validation mse = 0.050065
Epoch 1
Loss = 5.6659e-01, PNorm = 43.2896, GNorm = 1.6960, lr_0 = 6.2105e-04
Loss = 5.9356e-01, PNorm = 43.3325, GNorm = 1.5411, lr_0 = 8.5789e-04
Validation rmse = 0.225259
Validation r2 = 0.351410
Validation mse = 0.050742
Epoch 2
Loss = 5.2441e-01, PNorm = 43.3982, GNorm = 3.4728, lr_0 = 9.8961e-04
Loss = 4.8849e-01, PNorm = 43.4812, GNorm = 1.9598, lr_0 = 9.6914e-04
Validation rmse = 0.195631
Validation r2 = 0.510809
Validation mse = 0.038271
Epoch 3
Loss = 3.3473e-01, PNorm = 43.5616, GNorm = 5.3745, lr_0 = 9.4910e-04
Loss = 2.8803e-01, PNorm = 43.6311, GNorm = 2.7508, lr_0 = 9.2948e-04
Validation rmse = 0.201139
Validation r2 = 0.482872
Validation mse = 0.040457
Epoch 4
Loss = 2.3359e-01, PNorm = 43.6937, GNorm = 4.3850, lr_0 = 9.0836e-04
Loss = 3.0115e-01, PNorm = 43.7433, GNorm = 1.4416, lr_0 = 8.8958e-04
Validation rmse = 0.190184
Validation r2 = 0.537670
Validation mse = 0.036170
Epoch 5
Loss = 1.5337e-01, PNorm = 43.7881, GNorm = 2.1448, lr_0 = 8.7118e-04
Loss = 2.3501e-01, PNorm = 43.8276, GNorm = 5.2008, lr_0 = 8.5317e-04
Validation rmse = 0.172238
Validation r2 = 0.620805
Validation mse = 0.029666
Epoch 6
Loss = 2.2500e-01, PNorm = 43.8712, GNorm = 3.0887, lr_0 = 8.3378e-04
Loss = 1.8148e-01, PNorm = 43.9033, GNorm = 3.0583, lr_0 = 8.1654e-04
Validation rmse = 0.163711
Validation r2 = 0.657422
Validation mse = 0.026801
Epoch 7
Loss = 1.7863e-01, PNorm = 43.9344, GNorm = 0.9867, lr_0 = 7.9966e-04
Loss = 2.0342e-01, PNorm = 43.9624, GNorm = 7.5880, lr_0 = 7.8312e-04
Validation rmse = 0.157890
Validation r2 = 0.681349
Validation mse = 0.024929
Epoch 8
Loss = 1.6990e-01, PNorm = 43.9934, GNorm = 2.7214, lr_0 = 7.6533e-04
Loss = 1.6549e-01, PNorm = 44.0238, GNorm = 1.6091, lr_0 = 7.4950e-04
Validation rmse = 0.176468
Validation r2 = 0.601953
Validation mse = 0.031141
Epoch 9
Loss = 1.6340e-01, PNorm = 44.0456, GNorm = 3.8094, lr_0 = 7.3400e-04
Loss = 1.7244e-01, PNorm = 44.0735, GNorm = 1.5994, lr_0 = 7.1883e-04
Validation rmse = 0.154130
Validation r2 = 0.696344
Validation mse = 0.023756
Epoch 10
Loss = 1.4285e-01, PNorm = 44.0978, GNorm = 3.2375, lr_0 = 7.0249e-04
Loss = 1.5894e-01, PNorm = 44.1190, GNorm = 2.6738, lr_0 = 6.8797e-04
Validation rmse = 0.153643
Validation r2 = 0.698261
Validation mse = 0.023606
Epoch 11
Loss = 1.5923e-01, PNorm = 44.1345, GNorm = 5.9051, lr_0 = 6.7374e-04
Loss = 1.6125e-01, PNorm = 44.1552, GNorm = 2.6075, lr_0 = 6.5981e-04
Validation rmse = 0.149818
Validation r2 = 0.713099
Validation mse = 0.022445
Epoch 12
Loss = 1.3374e-01, PNorm = 44.1864, GNorm = 1.2498, lr_0 = 6.4482e-04
Loss = 1.2778e-01, PNorm = 44.2067, GNorm = 1.0468, lr_0 = 6.3148e-04
Validation rmse = 0.144189
Validation r2 = 0.734252
Validation mse = 0.020791
Epoch 13
Loss = 1.3960e-01, PNorm = 44.2245, GNorm = 1.9861, lr_0 = 6.1714e-04
Loss = 1.2954e-01, PNorm = 44.2413, GNorm = 0.6351, lr_0 = 6.0438e-04
Validation rmse = 0.159917
Validation r2 = 0.673115
Validation mse = 0.025573
Epoch 14
Loss = 1.4776e-01, PNorm = 44.2570, GNorm = 1.5283, lr_0 = 5.9188e-04
Loss = 1.6998e-01, PNorm = 44.2740, GNorm = 6.9649, lr_0 = 5.7964e-04
Validation rmse = 0.161253
Validation r2 = 0.667632
Validation mse = 0.026002
Epoch 15
Loss = 1.7304e-01, PNorm = 44.3070, GNorm = 5.0635, lr_0 = 5.6647e-04
Loss = 1.4553e-01, PNorm = 44.3291, GNorm = 1.0194, lr_0 = 5.5476e-04
Validation rmse = 0.152445
Validation r2 = 0.702948
Validation mse = 0.023240
Epoch 16
Loss = 1.3013e-01, PNorm = 44.3483, GNorm = 1.5807, lr_0 = 5.4328e-04
Loss = 1.3010e-01, PNorm = 44.3674, GNorm = 0.9442, lr_0 = 5.3205e-04
Loss = 1.8077e-01, PNorm = 44.3703, GNorm = 1.5730, lr_0 = 5.3094e-04
Validation rmse = 0.160275
Validation r2 = 0.671649
Validation mse = 0.025688
Epoch 17
Loss = 1.2096e-01, PNorm = 44.3815, GNorm = 1.8932, lr_0 = 5.1996e-04
Loss = 1.3445e-01, PNorm = 44.4015, GNorm = 2.5922, lr_0 = 5.0921e-04
Validation rmse = 0.155344
Validation r2 = 0.691545
Validation mse = 0.024132
Epoch 18
Loss = 1.2465e-01, PNorm = 44.4120, GNorm = 1.7651, lr_0 = 4.9868e-04
Validation rmse = 0.132122
Validation r2 = 0.776873
Validation mse = 0.017456
Epoch 19
Loss = 9.3865e-02, PNorm = 44.4306, GNorm = 2.1527, lr_0 = 4.8735e-04
Loss = 1.2552e-01, PNorm = 44.4498, GNorm = 3.0757, lr_0 = 4.7727e-04
Validation rmse = 0.143275
Validation r2 = 0.737609
Validation mse = 0.020528
Epoch 20
Loss = 1.2865e-01, PNorm = 44.4662, GNorm = 1.5574, lr_0 = 4.6740e-04
Loss = 1.2543e-01, PNorm = 44.4814, GNorm = 2.4298, lr_0 = 4.5774e-04
Validation rmse = 0.142554
Validation r2 = 0.740245
Validation mse = 0.020322
Epoch 21
Loss = 1.1407e-01, PNorm = 44.4998, GNorm = 1.9215, lr_0 = 4.4734e-04
Loss = 1.0748e-01, PNorm = 44.5130, GNorm = 1.8274, lr_0 = 4.3809e-04
Validation rmse = 0.128315
Validation r2 = 0.789544
Validation mse = 0.016465
Epoch 22
Loss = 1.0640e-01, PNorm = 44.5282, GNorm = 1.5733, lr_0 = 4.2903e-04
Loss = 9.7766e-02, PNorm = 44.5377, GNorm = 0.9691, lr_0 = 4.2016e-04
Validation rmse = 0.134049
Validation r2 = 0.770317
Validation mse = 0.017969
Epoch 23
Loss = 1.1215e-01, PNorm = 44.5549, GNorm = 2.3030, lr_0 = 4.1061e-04
Loss = 9.7444e-02, PNorm = 44.5701, GNorm = 1.5445, lr_0 = 4.0212e-04
Validation rmse = 0.124388
Validation r2 = 0.802228
Validation mse = 0.015472
Epoch 24
Loss = 1.0579e-01, PNorm = 44.5804, GNorm = 1.4276, lr_0 = 3.9381e-04
Loss = 9.4463e-02, PNorm = 44.5961, GNorm = 1.1218, lr_0 = 3.8566e-04
Validation rmse = 0.122930
Validation r2 = 0.806839
Validation mse = 0.015112
Epoch 25
Loss = 8.4041e-02, PNorm = 44.6155, GNorm = 2.4869, lr_0 = 3.7690e-04
Loss = 8.8708e-02, PNorm = 44.6284, GNorm = 1.0347, lr_0 = 3.6911e-04
Validation rmse = 0.133415
Validation r2 = 0.772484
Validation mse = 0.017799
Epoch 26
Loss = 1.0064e-01, PNorm = 44.6430, GNorm = 2.6762, lr_0 = 3.6072e-04
Loss = 9.6317e-02, PNorm = 44.6562, GNorm = 1.2688, lr_0 = 3.5326e-04
Validation rmse = 0.146642
Validation r2 = 0.725135
Validation mse = 0.021504
Epoch 27
Loss = 1.0749e-01, PNorm = 44.6699, GNorm = 1.3501, lr_0 = 3.4596e-04
Loss = 9.1856e-02, PNorm = 44.6854, GNorm = 1.1797, lr_0 = 3.3880e-04
Validation rmse = 0.127179
Validation r2 = 0.793254
Validation mse = 0.016175
Epoch 28
Loss = 8.2928e-02, PNorm = 44.6984, GNorm = 1.0018, lr_0 = 3.3110e-04
Loss = 9.0817e-02, PNorm = 44.7126, GNorm = 1.6868, lr_0 = 3.2426e-04
Validation rmse = 0.114801
Validation r2 = 0.831540
Validation mse = 0.013179
Epoch 29
Loss = 9.1781e-02, PNorm = 44.7243, GNorm = 0.6196, lr_0 = 3.1755e-04
Loss = 9.2842e-02, PNorm = 44.7376, GNorm = 1.8813, lr_0 = 3.1099e-04
Validation rmse = 0.121657
Validation r2 = 0.810819
Validation mse = 0.014800
Epoch 30
Loss = 8.3300e-02, PNorm = 44.7480, GNorm = 0.9795, lr_0 = 3.0392e-04
Loss = 8.0676e-02, PNorm = 44.7596, GNorm = 0.4211, lr_0 = 2.9764e-04
Validation rmse = 0.120483
Validation r2 = 0.814453
Validation mse = 0.014516
Epoch 31
Loss = 7.5114e-02, PNorm = 44.7709, GNorm = 0.9188, lr_0 = 2.9148e-04
Loss = 8.9882e-02, PNorm = 44.7824, GNorm = 1.9105, lr_0 = 2.8545e-04
Validation rmse = 0.122364
Validation r2 = 0.808613
Validation mse = 0.014973
Epoch 32
Loss = 7.9365e-02, PNorm = 44.7960, GNorm = 1.1671, lr_0 = 2.7897e-04
Loss = 8.3644e-02, PNorm = 44.8055, GNorm = 0.6946, lr_0 = 2.7320e-04
Validation rmse = 0.145626
Validation r2 = 0.728930
Validation mse = 0.021207
Epoch 33
Loss = 8.3255e-02, PNorm = 44.8173, GNorm = 0.7186, lr_0 = 2.6755e-04
Loss = 8.2278e-02, PNorm = 44.8269, GNorm = 2.5122, lr_0 = 2.6202e-04
Validation rmse = 0.124957
Validation r2 = 0.800416
Validation mse = 0.015614
Epoch 34
Loss = 8.4491e-02, PNorm = 44.8372, GNorm = 0.8790, lr_0 = 2.5606e-04
Loss = 7.8127e-02, PNorm = 44.8464, GNorm = 1.7987, lr_0 = 2.5077e-04
Validation rmse = 0.116862
Validation r2 = 0.825436
Validation mse = 0.013657
Epoch 35
Loss = 7.4486e-02, PNorm = 44.8568, GNorm = 1.5209, lr_0 = 2.4558e-04
Loss = 8.1684e-02, PNorm = 44.8666, GNorm = 4.8278, lr_0 = 2.4051e-04
Loss = 9.3670e-02, PNorm = 44.8675, GNorm = 1.3119, lr_0 = 2.4000e-04
Validation rmse = 0.106135
Validation r2 = 0.856012
Validation mse = 0.011265
Epoch 36
Loss = 7.8148e-02, PNorm = 44.8770, GNorm = 1.2150, lr_0 = 2.3504e-04
Loss = 7.3769e-02, PNorm = 44.8867, GNorm = 1.1451, lr_0 = 2.3018e-04
Validation rmse = 0.123995
Validation r2 = 0.803478
Validation mse = 0.015375
Epoch 37
Loss = 7.8690e-02, PNorm = 44.8956, GNorm = 0.8565, lr_0 = 2.2542e-04
Validation rmse = 0.128897
Validation r2 = 0.787632
Validation mse = 0.016614
Epoch 38
Loss = 8.4513e-02, PNorm = 44.9054, GNorm = 1.6739, lr_0 = 2.2030e-04
Loss = 7.3786e-02, PNorm = 44.9164, GNorm = 0.6609, lr_0 = 2.1574e-04
Validation rmse = 0.121555
Validation r2 = 0.811135
Validation mse = 0.014776
Epoch 39
Loss = 5.5178e-02, PNorm = 44.9261, GNorm = 0.5245, lr_0 = 2.1084e-04
Loss = 7.1483e-02, PNorm = 44.9341, GNorm = 0.5603, lr_0 = 2.0648e-04
Validation rmse = 0.116093
Validation r2 = 0.827727
Validation mse = 0.013478
Epoch 40
Loss = 5.5603e-02, PNorm = 44.9418, GNorm = 1.5131, lr_0 = 2.0221e-04
Loss = 6.6456e-02, PNorm = 44.9500, GNorm = 1.3442, lr_0 = 1.9803e-04
Validation rmse = 0.118141
Validation r2 = 0.821594
Validation mse = 0.013957
Epoch 41
Loss = 6.2202e-02, PNorm = 44.9581, GNorm = 1.3579, lr_0 = 1.9353e-04
Loss = 7.1733e-02, PNorm = 44.9666, GNorm = 1.8676, lr_0 = 1.8953e-04
Validation rmse = 0.102107
Validation r2 = 0.866736
Validation mse = 0.010426
Epoch 42
Loss = 4.8968e-02, PNorm = 44.9736, GNorm = 0.6336, lr_0 = 1.8561e-04
Loss = 6.9622e-02, PNorm = 44.9810, GNorm = 0.6051, lr_0 = 1.8177e-04
Validation rmse = 0.113467
Validation r2 = 0.835432
Validation mse = 0.012875
Epoch 43
Loss = 8.6428e-02, PNorm = 44.9911, GNorm = 1.4245, lr_0 = 1.7764e-04
Loss = 6.8632e-02, PNorm = 44.9993, GNorm = 0.6895, lr_0 = 1.7397e-04
Validation rmse = 0.105134
Validation r2 = 0.858717
Validation mse = 0.011053
Epoch 44
Loss = 6.2877e-02, PNorm = 45.0055, GNorm = 0.6885, lr_0 = 1.7037e-04
Loss = 5.9350e-02, PNorm = 45.0113, GNorm = 1.1704, lr_0 = 1.6685e-04
Validation rmse = 0.111385
Validation r2 = 0.841416
Validation mse = 0.012407
Epoch 45
Loss = 7.6528e-02, PNorm = 45.0179, GNorm = 0.9654, lr_0 = 1.6306e-04
Loss = 6.3607e-02, PNorm = 45.0238, GNorm = 1.2653, lr_0 = 1.5969e-04
Validation rmse = 0.106029
Validation r2 = 0.856302
Validation mse = 0.011242
Epoch 46
Loss = 6.0578e-02, PNorm = 45.0305, GNorm = 0.8089, lr_0 = 1.5638e-04
Loss = 6.7530e-02, PNorm = 45.0367, GNorm = 1.3613, lr_0 = 1.5315e-04
Validation rmse = 0.110896
Validation r2 = 0.842806
Validation mse = 0.012298
Epoch 47
Loss = 5.2802e-02, PNorm = 45.0437, GNorm = 0.6485, lr_0 = 1.4967e-04
Loss = 5.7806e-02, PNorm = 45.0491, GNorm = 1.3465, lr_0 = 1.4658e-04
Validation rmse = 0.105307
Validation r2 = 0.858251
Validation mse = 0.011090
Epoch 48
Loss = 6.0717e-02, PNorm = 45.0550, GNorm = 1.4964, lr_0 = 1.4354e-04
Loss = 6.1484e-02, PNorm = 45.0601, GNorm = 1.1814, lr_0 = 1.4058e-04
Validation rmse = 0.106747
Validation r2 = 0.854348
Validation mse = 0.011395
Epoch 49
Loss = 6.3478e-02, PNorm = 45.0672, GNorm = 0.8228, lr_0 = 1.3738e-04
Loss = 5.7660e-02, PNorm = 45.0718, GNorm = 1.1615, lr_0 = 1.3454e-04
Validation rmse = 0.102815
Validation r2 = 0.864881
Validation mse = 0.010571
Epoch 50
Loss = 5.6110e-02, PNorm = 45.0767, GNorm = 1.2949, lr_0 = 1.3176e-04
Loss = 5.3356e-02, PNorm = 45.0811, GNorm = 0.5159, lr_0 = 1.2904e-04
Validation rmse = 0.102739
Validation r2 = 0.865081
Validation mse = 0.010555
Epoch 51
Loss = 5.3726e-02, PNorm = 45.0872, GNorm = 1.4166, lr_0 = 1.2610e-04
Loss = 5.6489e-02, PNorm = 45.0920, GNorm = 0.5329, lr_0 = 1.2350e-04
Validation rmse = 0.101271
Validation r2 = 0.868908
Validation mse = 0.010256
Epoch 52
Loss = 5.8516e-02, PNorm = 45.0969, GNorm = 1.9313, lr_0 = 1.2069e-04
Loss = 5.7567e-02, PNorm = 45.1020, GNorm = 1.0737, lr_0 = 1.1819e-04
Validation rmse = 0.106450
Validation r2 = 0.855158
Validation mse = 0.011332
Epoch 53
Loss = 5.3660e-02, PNorm = 45.1061, GNorm = 0.7608, lr_0 = 1.1575e-04
Loss = 5.6264e-02, PNorm = 45.1118, GNorm = 0.7893, lr_0 = 1.1336e-04
Loss = 6.6226e-02, PNorm = 45.1121, GNorm = 1.3582, lr_0 = 1.1312e-04
Validation rmse = 0.104578
Validation r2 = 0.860207
Validation mse = 0.010937
Epoch 54
Loss = 5.3570e-02, PNorm = 45.1163, GNorm = 0.8906, lr_0 = 1.1078e-04
Loss = 5.9774e-02, PNorm = 45.1204, GNorm = 1.8961, lr_0 = 1.0849e-04
Validation rmse = 0.103334
Validation r2 = 0.863513
Validation mse = 0.010678
Epoch 55
Loss = 4.8131e-02, PNorm = 45.1246, GNorm = 1.0350, lr_0 = 1.0625e-04
Validation rmse = 0.104208
Validation r2 = 0.861195
Validation mse = 0.010859
Epoch 56
Loss = 3.9228e-02, PNorm = 45.1296, GNorm = 0.8150, lr_0 = 1.0383e-04
Loss = 4.6068e-02, PNorm = 45.1331, GNorm = 0.4484, lr_0 = 1.0169e-04
Validation rmse = 0.103709
Validation r2 = 0.862522
Validation mse = 0.010755
Epoch 57
Loss = 5.3486e-02, PNorm = 45.1370, GNorm = 1.4662, lr_0 = 1.0000e-04
Loss = 5.2157e-02, PNorm = 45.1404, GNorm = 0.7991, lr_0 = 1.0000e-04
Validation rmse = 0.098063
Validation r2 = 0.877081
Validation mse = 0.009616
Epoch 58
Loss = 4.4947e-02, PNorm = 45.1453, GNorm = 0.5834, lr_0 = 1.0000e-04
Loss = 5.0393e-02, PNorm = 45.1491, GNorm = 0.9609, lr_0 = 1.0000e-04
Validation rmse = 0.101435
Validation r2 = 0.868482
Validation mse = 0.010289
Epoch 59
Loss = 3.1633e-02, PNorm = 45.1529, GNorm = 0.9481, lr_0 = 1.0000e-04
Loss = 5.2511e-02, PNorm = 45.1565, GNorm = 1.1461, lr_0 = 1.0000e-04
Validation rmse = 0.105959
Validation r2 = 0.856491
Validation mse = 0.011227
Model 0 best validation rmse = 0.098063 on epoch 57
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.682864
Model 0 test r2 = -129.261544
Model 0 test mse = 0.466304
Ensemble test rmse = 0.682864
Ensemble test r2 = -129.261544
Ensemble test mse = 0.466304
Fold 7
Splitting data with seed 7
Total size = 983 | train size = 973 | val size = 10 | test size = 49
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.5993e-01, PNorm = 43.2634, GNorm = 3.2460, lr_0 = 3.6053e-04
Validation rmse = 0.224004
Validation r2 = 0.373625
Validation mse = 0.050178
Epoch 1
Loss = 3.6657e-01, PNorm = 43.2910, GNorm = 2.6458, lr_0 = 6.2105e-04
Loss = 6.8401e-01, PNorm = 43.3284, GNorm = 6.0966, lr_0 = 8.5789e-04
Validation rmse = 0.165140
Validation r2 = 0.659571
Validation mse = 0.027271
Epoch 2
Loss = 5.0660e-01, PNorm = 43.4038, GNorm = 1.7127, lr_0 = 9.8961e-04
Loss = 4.2241e-01, PNorm = 43.4781, GNorm = 10.7527, lr_0 = 9.6914e-04
Validation rmse = 0.162520
Validation r2 = 0.670285
Validation mse = 0.026413
Epoch 3
Loss = 3.4564e-01, PNorm = 43.5523, GNorm = 5.6914, lr_0 = 9.4910e-04
Loss = 3.8821e-01, PNorm = 43.6171, GNorm = 6.3776, lr_0 = 9.2948e-04
Validation rmse = 0.156664
Validation r2 = 0.693620
Validation mse = 0.024544
Epoch 4
Loss = 2.8019e-01, PNorm = 43.6890, GNorm = 3.6696, lr_0 = 9.0836e-04
Loss = 2.5284e-01, PNorm = 43.7376, GNorm = 4.6736, lr_0 = 8.8958e-04
Validation rmse = 0.156518
Validation r2 = 0.694190
Validation mse = 0.024498
Epoch 5
Loss = 1.9249e-01, PNorm = 43.7854, GNorm = 2.9701, lr_0 = 8.7118e-04
Loss = 2.2814e-01, PNorm = 43.8282, GNorm = 0.9299, lr_0 = 8.5317e-04
Validation rmse = 0.166361
Validation r2 = 0.654517
Validation mse = 0.027676
Epoch 6
Loss = 1.9944e-01, PNorm = 43.8616, GNorm = 2.9400, lr_0 = 8.3378e-04
Loss = 2.1298e-01, PNorm = 43.8963, GNorm = 1.3161, lr_0 = 8.1654e-04
Validation rmse = 0.156214
Validation r2 = 0.695377
Validation mse = 0.024403
Epoch 7
Loss = 2.0317e-01, PNorm = 43.9280, GNorm = 0.9108, lr_0 = 7.9966e-04
Loss = 1.6342e-01, PNorm = 43.9570, GNorm = 3.4033, lr_0 = 7.8312e-04
Validation rmse = 0.158851
Validation r2 = 0.685005
Validation mse = 0.025234
Epoch 8
Loss = 1.6676e-01, PNorm = 43.9902, GNorm = 1.4544, lr_0 = 7.6533e-04
Loss = 1.5091e-01, PNorm = 44.0141, GNorm = 1.7199, lr_0 = 7.4950e-04
Validation rmse = 0.146988
Validation r2 = 0.730296
Validation mse = 0.021605
Epoch 9
Loss = 1.8060e-01, PNorm = 44.0420, GNorm = 3.3823, lr_0 = 7.3400e-04
Loss = 1.4834e-01, PNorm = 44.0730, GNorm = 0.7662, lr_0 = 7.1883e-04
Validation rmse = 0.166395
Validation r2 = 0.654376
Validation mse = 0.027687
Epoch 10
Loss = 1.8781e-01, PNorm = 44.0974, GNorm = 5.6273, lr_0 = 7.0249e-04
Loss = 1.6355e-01, PNorm = 44.1290, GNorm = 2.0003, lr_0 = 6.8797e-04
Validation rmse = 0.139062
Validation r2 = 0.758597
Validation mse = 0.019338
Epoch 11
Loss = 1.5495e-01, PNorm = 44.1580, GNorm = 4.8824, lr_0 = 6.7374e-04
Loss = 1.4221e-01, PNorm = 44.1773, GNorm = 1.2277, lr_0 = 6.5981e-04
Validation rmse = 0.144965
Validation r2 = 0.737668
Validation mse = 0.021015
Epoch 12
Loss = 1.4477e-01, PNorm = 44.1998, GNorm = 1.4465, lr_0 = 6.4482e-04
Loss = 1.6057e-01, PNorm = 44.2264, GNorm = 1.1430, lr_0 = 6.3148e-04
Validation rmse = 0.133008
Validation r2 = 0.779160
Validation mse = 0.017691
Epoch 13
Loss = 1.4761e-01, PNorm = 44.2449, GNorm = 2.2204, lr_0 = 6.1714e-04
Loss = 1.3958e-01, PNorm = 44.2666, GNorm = 1.7854, lr_0 = 6.0438e-04
Validation rmse = 0.120785
Validation r2 = 0.817885
Validation mse = 0.014589
Epoch 14
Loss = 1.4842e-01, PNorm = 44.2826, GNorm = 1.0986, lr_0 = 5.9188e-04
Loss = 1.3520e-01, PNorm = 44.3027, GNorm = 1.9568, lr_0 = 5.7964e-04
Validation rmse = 0.176439
Validation r2 = 0.611389
Validation mse = 0.031131
Epoch 15
Loss = 1.2318e-01, PNorm = 44.3280, GNorm = 1.3793, lr_0 = 5.6647e-04
Loss = 1.3425e-01, PNorm = 44.3439, GNorm = 2.0823, lr_0 = 5.5476e-04
Validation rmse = 0.134694
Validation r2 = 0.773525
Validation mse = 0.018142
Epoch 16
Loss = 1.1799e-01, PNorm = 44.3671, GNorm = 0.4887, lr_0 = 5.4328e-04
Loss = 1.2654e-01, PNorm = 44.3825, GNorm = 2.9153, lr_0 = 5.3205e-04
Loss = 9.5520e-02, PNorm = 44.3836, GNorm = 2.8714, lr_0 = 5.3094e-04
Validation rmse = 0.145895
Validation r2 = 0.734294
Validation mse = 0.021285
Epoch 17
Loss = 1.1431e-01, PNorm = 44.4005, GNorm = 0.9371, lr_0 = 5.1996e-04
Loss = 1.2139e-01, PNorm = 44.4157, GNorm = 3.4854, lr_0 = 5.0921e-04
Validation rmse = 0.168946
Validation r2 = 0.643696
Validation mse = 0.028543
Epoch 18
Loss = 1.2350e-01, PNorm = 44.4299, GNorm = 2.5552, lr_0 = 4.9868e-04
Validation rmse = 0.160814
Validation r2 = 0.677171
Validation mse = 0.025861
Epoch 19
Loss = 1.5783e-01, PNorm = 44.4484, GNorm = 4.5184, lr_0 = 4.8735e-04
Loss = 1.1795e-01, PNorm = 44.4687, GNorm = 0.5017, lr_0 = 4.7727e-04
Validation rmse = 0.127437
Validation r2 = 0.797272
Validation mse = 0.016240
Epoch 20
Loss = 6.7169e-02, PNorm = 44.4876, GNorm = 0.9255, lr_0 = 4.6740e-04
Loss = 1.3272e-01, PNorm = 44.5070, GNorm = 0.8545, lr_0 = 4.5774e-04
Validation rmse = 0.153134
Validation r2 = 0.707271
Validation mse = 0.023450
Epoch 21
Loss = 1.0573e-01, PNorm = 44.5247, GNorm = 1.9100, lr_0 = 4.4734e-04
Loss = 1.1105e-01, PNorm = 44.5420, GNorm = 0.9027, lr_0 = 4.3809e-04
Validation rmse = 0.152748
Validation r2 = 0.708744
Validation mse = 0.023332
Epoch 22
Loss = 1.0027e-01, PNorm = 44.5585, GNorm = 1.9644, lr_0 = 4.2903e-04
Loss = 9.9769e-02, PNorm = 44.5769, GNorm = 1.0101, lr_0 = 4.2016e-04
Validation rmse = 0.143408
Validation r2 = 0.743275
Validation mse = 0.020566
Epoch 23
Loss = 9.5127e-02, PNorm = 44.5905, GNorm = 2.0419, lr_0 = 4.1061e-04
Loss = 1.0391e-01, PNorm = 44.6048, GNorm = 2.5361, lr_0 = 4.0212e-04
Validation rmse = 0.139685
Validation r2 = 0.756430
Validation mse = 0.019512
Epoch 24
Loss = 8.1987e-02, PNorm = 44.6182, GNorm = 1.0498, lr_0 = 3.9381e-04
Loss = 9.7648e-02, PNorm = 44.6340, GNorm = 2.1663, lr_0 = 3.8566e-04
Validation rmse = 0.129080
Validation r2 = 0.792010
Validation mse = 0.016662
Epoch 25
Loss = 1.0031e-01, PNorm = 44.6477, GNorm = 0.9813, lr_0 = 3.7690e-04
Loss = 8.4978e-02, PNorm = 44.6611, GNorm = 0.9417, lr_0 = 3.6911e-04
Validation rmse = 0.146307
Validation r2 = 0.732790
Validation mse = 0.021406
Epoch 26
Loss = 1.0776e-01, PNorm = 44.6763, GNorm = 1.7554, lr_0 = 3.6072e-04
Loss = 1.0931e-01, PNorm = 44.6929, GNorm = 1.7906, lr_0 = 3.5326e-04
Validation rmse = 0.145304
Validation r2 = 0.736441
Validation mse = 0.021113
Epoch 27
Loss = 9.5901e-02, PNorm = 44.7052, GNorm = 0.6749, lr_0 = 3.4596e-04
Loss = 8.2518e-02, PNorm = 44.7192, GNorm = 1.4293, lr_0 = 3.3880e-04
Validation rmse = 0.148373
Validation r2 = 0.725191
Validation mse = 0.022014
Epoch 28
Loss = 8.7695e-02, PNorm = 44.7342, GNorm = 0.6743, lr_0 = 3.3110e-04
Loss = 8.2526e-02, PNorm = 44.7478, GNorm = 0.8227, lr_0 = 3.2426e-04
Validation rmse = 0.126828
Validation r2 = 0.799203
Validation mse = 0.016085
Epoch 29
Loss = 8.8835e-02, PNorm = 44.7584, GNorm = 3.5491, lr_0 = 3.1755e-04
Loss = 1.0115e-01, PNorm = 44.7702, GNorm = 0.8537, lr_0 = 3.1099e-04
Validation rmse = 0.132092
Validation r2 = 0.782189
Validation mse = 0.017448
Epoch 30
Loss = 7.7430e-02, PNorm = 44.7858, GNorm = 2.4700, lr_0 = 3.0392e-04
Loss = 8.9259e-02, PNorm = 44.7978, GNorm = 1.0391, lr_0 = 2.9764e-04
Validation rmse = 0.139650
Validation r2 = 0.756554
Validation mse = 0.019502
Epoch 31
Loss = 8.3416e-02, PNorm = 44.8091, GNorm = 0.8488, lr_0 = 2.9148e-04
Loss = 8.7566e-02, PNorm = 44.8228, GNorm = 1.7177, lr_0 = 2.8545e-04
Validation rmse = 0.134370
Validation r2 = 0.774613
Validation mse = 0.018055
Epoch 32
Loss = 8.1800e-02, PNorm = 44.8370, GNorm = 1.1045, lr_0 = 2.7897e-04
Loss = 9.1141e-02, PNorm = 44.8468, GNorm = 0.5875, lr_0 = 2.7320e-04
Validation rmse = 0.138900
Validation r2 = 0.759161
Validation mse = 0.019293
Epoch 33
Loss = 9.7001e-02, PNorm = 44.8574, GNorm = 1.6095, lr_0 = 2.6755e-04
Loss = 7.1592e-02, PNorm = 44.8679, GNorm = 0.9234, lr_0 = 2.6202e-04
Validation rmse = 0.139627
Validation r2 = 0.756633
Validation mse = 0.019496
Epoch 34
Loss = 8.4723e-02, PNorm = 44.8790, GNorm = 1.1159, lr_0 = 2.5606e-04
Loss = 7.6060e-02, PNorm = 44.8899, GNorm = 0.8823, lr_0 = 2.5077e-04
Validation rmse = 0.135117
Validation r2 = 0.772100
Validation mse = 0.018257
Epoch 35
Loss = 7.6610e-02, PNorm = 44.8997, GNorm = 0.6327, lr_0 = 2.4558e-04
Loss = 8.0896e-02, PNorm = 44.9100, GNorm = 1.0704, lr_0 = 2.4051e-04
Loss = 8.2550e-02, PNorm = 44.9110, GNorm = 2.7892, lr_0 = 2.4000e-04
Validation rmse = 0.135995
Validation r2 = 0.769130
Validation mse = 0.018495
Epoch 36
Loss = 6.9099e-02, PNorm = 44.9204, GNorm = 0.9359, lr_0 = 2.3504e-04
Loss = 8.1314e-02, PNorm = 44.9301, GNorm = 1.3566, lr_0 = 2.3018e-04
Validation rmse = 0.137637
Validation r2 = 0.763521
Validation mse = 0.018944
Epoch 37
Loss = 6.6108e-02, PNorm = 44.9381, GNorm = 1.3599, lr_0 = 2.2542e-04
Validation rmse = 0.135931
Validation r2 = 0.769346
Validation mse = 0.018477
Epoch 38
Loss = 3.3197e-02, PNorm = 44.9491, GNorm = 0.7532, lr_0 = 2.2030e-04
Loss = 6.6988e-02, PNorm = 44.9584, GNorm = 0.6934, lr_0 = 2.1574e-04
Validation rmse = 0.136983
Validation r2 = 0.765763
Validation mse = 0.018764
Epoch 39
Loss = 7.1400e-02, PNorm = 44.9681, GNorm = 1.8903, lr_0 = 2.1084e-04
Loss = 7.8266e-02, PNorm = 44.9762, GNorm = 1.9904, lr_0 = 2.0648e-04
Validation rmse = 0.138355
Validation r2 = 0.761046
Validation mse = 0.019142
Epoch 40
Loss = 6.3760e-02, PNorm = 44.9856, GNorm = 0.5982, lr_0 = 2.0221e-04
Loss = 7.1214e-02, PNorm = 44.9924, GNorm = 0.7561, lr_0 = 1.9803e-04
Validation rmse = 0.128124
Validation r2 = 0.795079
Validation mse = 0.016416
Epoch 41
Loss = 8.5249e-02, PNorm = 45.0005, GNorm = 2.0120, lr_0 = 1.9353e-04
Loss = 7.3536e-02, PNorm = 45.0107, GNorm = 2.3392, lr_0 = 1.8953e-04
Validation rmse = 0.139584
Validation r2 = 0.756783
Validation mse = 0.019484
Epoch 42
Loss = 5.0628e-02, PNorm = 45.0181, GNorm = 0.5703, lr_0 = 1.8561e-04
Loss = 7.0557e-02, PNorm = 45.0260, GNorm = 0.7881, lr_0 = 1.8177e-04
Validation rmse = 0.139658
Validation r2 = 0.756525
Validation mse = 0.019504
Epoch 43
Loss = 7.4743e-02, PNorm = 45.0342, GNorm = 1.6140, lr_0 = 1.7764e-04
Loss = 6.6462e-02, PNorm = 45.0424, GNorm = 1.2898, lr_0 = 1.7397e-04
Validation rmse = 0.143650
Validation r2 = 0.742406
Validation mse = 0.020635
Epoch 44
Loss = 7.5869e-02, PNorm = 45.0501, GNorm = 1.3964, lr_0 = 1.7037e-04
Loss = 7.1277e-02, PNorm = 45.0582, GNorm = 1.4030, lr_0 = 1.6685e-04
Validation rmse = 0.129210
Validation r2 = 0.791592
Validation mse = 0.016695
Epoch 45
Loss = 5.7809e-02, PNorm = 45.0664, GNorm = 0.5955, lr_0 = 1.6306e-04
Loss = 6.4527e-02, PNorm = 45.0730, GNorm = 1.3266, lr_0 = 1.5969e-04
Validation rmse = 0.138388
Validation r2 = 0.760933
Validation mse = 0.019151
Epoch 46
Loss = 5.0034e-02, PNorm = 45.0788, GNorm = 0.5610, lr_0 = 1.5638e-04
Loss = 6.8420e-02, PNorm = 45.0853, GNorm = 1.3772, lr_0 = 1.5315e-04
Validation rmse = 0.136147
Validation r2 = 0.768614
Validation mse = 0.018536
Epoch 47
Loss = 6.8098e-02, PNorm = 45.0923, GNorm = 2.4452, lr_0 = 1.4967e-04
Loss = 6.9934e-02, PNorm = 45.0985, GNorm = 3.0670, lr_0 = 1.4658e-04
Validation rmse = 0.139784
Validation r2 = 0.756084
Validation mse = 0.019540
Epoch 48
Loss = 5.6656e-02, PNorm = 45.1043, GNorm = 1.8070, lr_0 = 1.4354e-04
Loss = 7.3557e-02, PNorm = 45.1104, GNorm = 1.1413, lr_0 = 1.4058e-04
Validation rmse = 0.132055
Validation r2 = 0.782314
Validation mse = 0.017438
Epoch 49
Loss = 5.8519e-02, PNorm = 45.1162, GNorm = 0.7312, lr_0 = 1.3738e-04
Loss = 5.6169e-02, PNorm = 45.1219, GNorm = 0.5341, lr_0 = 1.3454e-04
Validation rmse = 0.134275
Validation r2 = 0.774931
Validation mse = 0.018030
Epoch 50
Loss = 5.2115e-02, PNorm = 45.1272, GNorm = 1.0150, lr_0 = 1.3176e-04
Loss = 6.5950e-02, PNorm = 45.1328, GNorm = 1.0888, lr_0 = 1.2904e-04
Validation rmse = 0.133327
Validation r2 = 0.778098
Validation mse = 0.017776
Epoch 51
Loss = 5.6550e-02, PNorm = 45.1391, GNorm = 1.0029, lr_0 = 1.2610e-04
Loss = 6.3701e-02, PNorm = 45.1442, GNorm = 1.7422, lr_0 = 1.2350e-04
Validation rmse = 0.139386
Validation r2 = 0.757471
Validation mse = 0.019429
Epoch 52
Loss = 6.4642e-02, PNorm = 45.1489, GNorm = 0.4992, lr_0 = 1.2069e-04
Loss = 5.8371e-02, PNorm = 45.1536, GNorm = 1.1016, lr_0 = 1.1819e-04
Validation rmse = 0.137877
Validation r2 = 0.762695
Validation mse = 0.019010
Epoch 53
Loss = 6.6707e-02, PNorm = 45.1590, GNorm = 1.2684, lr_0 = 1.1575e-04
Loss = 5.1598e-02, PNorm = 45.1637, GNorm = 0.8071, lr_0 = 1.1336e-04
Loss = 4.6646e-02, PNorm = 45.1641, GNorm = 1.4673, lr_0 = 1.1312e-04
Validation rmse = 0.130212
Validation r2 = 0.788345
Validation mse = 0.016955
Epoch 54
Loss = 5.6447e-02, PNorm = 45.1693, GNorm = 0.5536, lr_0 = 1.1078e-04
Loss = 5.1524e-02, PNorm = 45.1733, GNorm = 2.9200, lr_0 = 1.0849e-04
Validation rmse = 0.130125
Validation r2 = 0.788630
Validation mse = 0.016932
Epoch 55
Loss = 5.2823e-02, PNorm = 45.1767, GNorm = 0.6143, lr_0 = 1.0625e-04
Validation rmse = 0.131440
Validation r2 = 0.784336
Validation mse = 0.017276
Epoch 56
Loss = 4.5603e-02, PNorm = 45.1819, GNorm = 0.5779, lr_0 = 1.0383e-04
Loss = 5.5727e-02, PNorm = 45.1868, GNorm = 0.9644, lr_0 = 1.0169e-04
Validation rmse = 0.134062
Validation r2 = 0.775646
Validation mse = 0.017973
Epoch 57
Loss = 3.7454e-02, PNorm = 45.1907, GNorm = 0.8919, lr_0 = 1.0000e-04
Loss = 4.8167e-02, PNorm = 45.1948, GNorm = 1.1260, lr_0 = 1.0000e-04
Validation rmse = 0.131732
Validation r2 = 0.783376
Validation mse = 0.017353
Epoch 58
Loss = 5.5263e-02, PNorm = 45.1993, GNorm = 0.5393, lr_0 = 1.0000e-04
Loss = 4.7516e-02, PNorm = 45.2031, GNorm = 0.7891, lr_0 = 1.0000e-04
Validation rmse = 0.138914
Validation r2 = 0.759113
Validation mse = 0.019297
Epoch 59
Loss = 4.2873e-02, PNorm = 45.2069, GNorm = 0.7236, lr_0 = 1.0000e-04
Loss = 5.3698e-02, PNorm = 45.2112, GNorm = 0.8026, lr_0 = 1.0000e-04
Validation rmse = 0.131130
Validation r2 = 0.785350
Validation mse = 0.017195
Model 0 best validation rmse = 0.120785 on epoch 13
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.680363
Model 0 test r2 = -128.308908
Model 0 test mse = 0.462893
Ensemble test rmse = 0.680363
Ensemble test r2 = -128.308908
Ensemble test mse = 0.462893
Fold 8
Splitting data with seed 8
Total size = 983 | train size = 973 | val size = 10 | test size = 49
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.6891e-01, PNorm = 43.2621, GNorm = 1.8575, lr_0 = 3.6053e-04
Validation rmse = 0.274452
Validation r2 = 0.412628
Validation mse = 0.075324
Epoch 1
Loss = 6.9828e-01, PNorm = 43.2853, GNorm = 1.3633, lr_0 = 6.2105e-04
Loss = 7.3006e-01, PNorm = 43.3161, GNorm = 8.0240, lr_0 = 8.5789e-04
Validation rmse = 0.218244
Validation r2 = 0.628582
Validation mse = 0.047630
Epoch 2
Loss = 5.8326e-01, PNorm = 43.3814, GNorm = 7.6654, lr_0 = 9.8961e-04
Loss = 4.7664e-01, PNorm = 43.4511, GNorm = 0.9926, lr_0 = 9.6914e-04
Validation rmse = 0.122661
Validation r2 = 0.882675
Validation mse = 0.015046
Epoch 3
Loss = 3.0223e-01, PNorm = 43.5316, GNorm = 2.6844, lr_0 = 9.4910e-04
Loss = 3.2669e-01, PNorm = 43.6057, GNorm = 6.5254, lr_0 = 9.2948e-04
Validation rmse = 0.107288
Validation r2 = 0.910241
Validation mse = 0.011511
Epoch 4
Loss = 3.2506e-01, PNorm = 43.6695, GNorm = 4.7469, lr_0 = 9.0836e-04
Loss = 2.7820e-01, PNorm = 43.7283, GNorm = 1.2220, lr_0 = 8.8958e-04
Validation rmse = 0.085384
Validation r2 = 0.943149
Validation mse = 0.007291
Epoch 5
Loss = 2.6194e-01, PNorm = 43.7628, GNorm = 1.9233, lr_0 = 8.7118e-04
Loss = 2.1720e-01, PNorm = 43.8017, GNorm = 4.5623, lr_0 = 8.5317e-04
Validation rmse = 0.098651
Validation r2 = 0.924111
Validation mse = 0.009732
Epoch 6
Loss = 2.1800e-01, PNorm = 43.8322, GNorm = 5.0102, lr_0 = 8.3378e-04
Loss = 2.5225e-01, PNorm = 43.8648, GNorm = 7.8096, lr_0 = 8.1654e-04
Validation rmse = 0.105974
Validation r2 = 0.912426
Validation mse = 0.011230
Epoch 7
Loss = 1.9289e-01, PNorm = 43.9067, GNorm = 4.6285, lr_0 = 7.9966e-04
Loss = 1.8753e-01, PNorm = 43.9357, GNorm = 3.4337, lr_0 = 7.8312e-04
Validation rmse = 0.086583
Validation r2 = 0.941542
Validation mse = 0.007497
Epoch 8
Loss = 1.8000e-01, PNorm = 43.9569, GNorm = 4.6131, lr_0 = 7.6533e-04
Loss = 1.7719e-01, PNorm = 43.9794, GNorm = 1.0911, lr_0 = 7.4950e-04
Validation rmse = 0.119875
Validation r2 = 0.887944
Validation mse = 0.014370
Epoch 9
Loss = 1.7939e-01, PNorm = 44.0009, GNorm = 1.2283, lr_0 = 7.3400e-04
Loss = 1.8581e-01, PNorm = 44.0206, GNorm = 1.3070, lr_0 = 7.1883e-04
Validation rmse = 0.071308
Validation r2 = 0.960349
Validation mse = 0.005085
Epoch 10
Loss = 2.2661e-01, PNorm = 44.0487, GNorm = 4.6278, lr_0 = 7.0249e-04
Loss = 1.8993e-01, PNorm = 44.0785, GNorm = 2.5515, lr_0 = 6.8797e-04
Validation rmse = 0.134467
Validation r2 = 0.859002
Validation mse = 0.018081
Epoch 11
Loss = 1.7046e-01, PNorm = 44.1021, GNorm = 1.5230, lr_0 = 6.7374e-04
Loss = 1.5555e-01, PNorm = 44.1259, GNorm = 2.7139, lr_0 = 6.5981e-04
Validation rmse = 0.113414
Validation r2 = 0.899697
Validation mse = 0.012863
Epoch 12
Loss = 1.4635e-01, PNorm = 44.1485, GNorm = 0.7807, lr_0 = 6.4482e-04
Loss = 1.4849e-01, PNorm = 44.1667, GNorm = 2.7978, lr_0 = 6.3148e-04
Validation rmse = 0.114751
Validation r2 = 0.897319
Validation mse = 0.013168
Epoch 13
Loss = 1.5881e-01, PNorm = 44.1865, GNorm = 1.2303, lr_0 = 6.1714e-04
Loss = 1.3059e-01, PNorm = 44.2041, GNorm = 1.9935, lr_0 = 6.0438e-04
Validation rmse = 0.117784
Validation r2 = 0.891818
Validation mse = 0.013873
Epoch 14
Loss = 1.2304e-01, PNorm = 44.2209, GNorm = 2.3348, lr_0 = 5.9188e-04
Loss = 1.4748e-01, PNorm = 44.2353, GNorm = 4.0768, lr_0 = 5.7964e-04
Validation rmse = 0.132905
Validation r2 = 0.862259
Validation mse = 0.017664
Epoch 15
Loss = 1.2706e-01, PNorm = 44.2510, GNorm = 2.4111, lr_0 = 5.6647e-04
Loss = 1.4379e-01, PNorm = 44.2674, GNorm = 0.8785, lr_0 = 5.5476e-04
Validation rmse = 0.140242
Validation r2 = 0.846631
Validation mse = 0.019668
Epoch 16
Loss = 1.2328e-01, PNorm = 44.2815, GNorm = 0.8570, lr_0 = 5.4328e-04
Loss = 1.4124e-01, PNorm = 44.2993, GNorm = 2.4751, lr_0 = 5.3205e-04
Loss = 1.9327e-01, PNorm = 44.3011, GNorm = 3.2621, lr_0 = 5.3094e-04
Validation rmse = 0.149109
Validation r2 = 0.826625
Validation mse = 0.022233
Epoch 17
Loss = 1.3297e-01, PNorm = 44.3164, GNorm = 2.8071, lr_0 = 5.1996e-04
Loss = 1.4607e-01, PNorm = 44.3351, GNorm = 4.1230, lr_0 = 5.0921e-04
Validation rmse = 0.143024
Validation r2 = 0.840487
Validation mse = 0.020456
Epoch 18
Loss = 1.3392e-01, PNorm = 44.3530, GNorm = 2.0181, lr_0 = 4.9868e-04
Validation rmse = 0.165667
Validation r2 = 0.785981
Validation mse = 0.027446
Epoch 19
Loss = 2.3105e-01, PNorm = 44.3693, GNorm = 5.2617, lr_0 = 4.8735e-04
Loss = 1.2632e-01, PNorm = 44.3861, GNorm = 1.1733, lr_0 = 4.7727e-04
Validation rmse = 0.134124
Validation r2 = 0.859720
Validation mse = 0.017989
Epoch 20
Loss = 9.7953e-02, PNorm = 44.4028, GNorm = 1.1023, lr_0 = 4.6740e-04
Loss = 1.2102e-01, PNorm = 44.4177, GNorm = 1.0593, lr_0 = 4.5774e-04
Validation rmse = 0.140245
Validation r2 = 0.846625
Validation mse = 0.019669
Epoch 21
Loss = 8.3945e-02, PNorm = 44.4331, GNorm = 1.1218, lr_0 = 4.4734e-04
Loss = 1.2521e-01, PNorm = 44.4458, GNorm = 2.5541, lr_0 = 4.3809e-04
Validation rmse = 0.148650
Validation r2 = 0.827690
Validation mse = 0.022097
Epoch 22
Loss = 9.0622e-02, PNorm = 44.4618, GNorm = 2.7488, lr_0 = 4.2903e-04
Loss = 1.1374e-01, PNorm = 44.4732, GNorm = 1.2484, lr_0 = 4.2016e-04
Validation rmse = 0.135448
Validation r2 = 0.856938
Validation mse = 0.018346
Epoch 23
Loss = 1.1169e-01, PNorm = 44.4901, GNorm = 1.3624, lr_0 = 4.1061e-04
Loss = 1.0754e-01, PNorm = 44.5039, GNorm = 1.2420, lr_0 = 4.0212e-04
Validation rmse = 0.145813
Validation r2 = 0.834204
Validation mse = 0.021261
Epoch 24
Loss = 1.2954e-01, PNorm = 44.5178, GNorm = 0.8751, lr_0 = 3.9381e-04
Loss = 1.2396e-01, PNorm = 44.5370, GNorm = 2.7888, lr_0 = 3.8566e-04
Validation rmse = 0.157766
Validation r2 = 0.805908
Validation mse = 0.024890
Epoch 25
Loss = 1.0619e-01, PNorm = 44.5476, GNorm = 1.2638, lr_0 = 3.7690e-04
Loss = 1.0947e-01, PNorm = 44.5634, GNorm = 2.1376, lr_0 = 3.6911e-04
Validation rmse = 0.155244
Validation r2 = 0.812064
Validation mse = 0.024101
Epoch 26
Loss = 1.1345e-01, PNorm = 44.5758, GNorm = 3.1862, lr_0 = 3.6072e-04
Loss = 1.1324e-01, PNorm = 44.5889, GNorm = 0.8421, lr_0 = 3.5326e-04
Validation rmse = 0.140094
Validation r2 = 0.846956
Validation mse = 0.019626
Epoch 27
Loss = 1.0113e-01, PNorm = 44.6026, GNorm = 0.7233, lr_0 = 3.4596e-04
Loss = 1.0138e-01, PNorm = 44.6160, GNorm = 1.6157, lr_0 = 3.3880e-04
Validation rmse = 0.162454
Validation r2 = 0.794203
Validation mse = 0.026391
Epoch 28
Loss = 9.1875e-02, PNorm = 44.6276, GNorm = 1.1163, lr_0 = 3.3110e-04
Loss = 9.4660e-02, PNorm = 44.6376, GNorm = 0.8489, lr_0 = 3.2426e-04
Validation rmse = 0.147872
Validation r2 = 0.829490
Validation mse = 0.021866
Epoch 29
Loss = 6.9806e-02, PNorm = 44.6494, GNorm = 1.0068, lr_0 = 3.1755e-04
Loss = 1.0358e-01, PNorm = 44.6608, GNorm = 1.8768, lr_0 = 3.1099e-04
Validation rmse = 0.153328
Validation r2 = 0.816675
Validation mse = 0.023509
Epoch 30
Loss = 9.1343e-02, PNorm = 44.6728, GNorm = 0.6467, lr_0 = 3.0392e-04
Loss = 9.3381e-02, PNorm = 44.6824, GNorm = 0.8981, lr_0 = 2.9764e-04
Validation rmse = 0.166390
Validation r2 = 0.784108
Validation mse = 0.027686
Epoch 31
Loss = 1.0443e-01, PNorm = 44.6942, GNorm = 1.0115, lr_0 = 2.9148e-04
Loss = 8.5562e-02, PNorm = 44.7043, GNorm = 0.9234, lr_0 = 2.8545e-04
Validation rmse = 0.153345
Validation r2 = 0.816634
Validation mse = 0.023515
Epoch 32
Loss = 9.4521e-02, PNorm = 44.7143, GNorm = 2.7265, lr_0 = 2.7897e-04
Loss = 1.0469e-01, PNorm = 44.7272, GNorm = 1.4104, lr_0 = 2.7320e-04
Validation rmse = 0.165031
Validation r2 = 0.787621
Validation mse = 0.027235
Epoch 33
Loss = 8.7964e-02, PNorm = 44.7364, GNorm = 0.7101, lr_0 = 2.6755e-04
Loss = 8.6559e-02, PNorm = 44.7460, GNorm = 0.5245, lr_0 = 2.6202e-04
Validation rmse = 0.154640
Validation r2 = 0.813524
Validation mse = 0.023913
Epoch 34
Loss = 8.5277e-02, PNorm = 44.7569, GNorm = 0.6012, lr_0 = 2.5606e-04
Loss = 8.3481e-02, PNorm = 44.7670, GNorm = 1.1594, lr_0 = 2.5077e-04
Validation rmse = 0.158348
Validation r2 = 0.804472
Validation mse = 0.025074
Epoch 35
Loss = 8.7706e-02, PNorm = 44.7752, GNorm = 0.6703, lr_0 = 2.4558e-04
Loss = 7.8252e-02, PNorm = 44.7847, GNorm = 0.7950, lr_0 = 2.4051e-04
Loss = 1.4203e-01, PNorm = 44.7859, GNorm = 1.0348, lr_0 = 2.4000e-04
Validation rmse = 0.161798
Validation r2 = 0.795862
Validation mse = 0.026178
Epoch 36
Loss = 8.6093e-02, PNorm = 44.7975, GNorm = 1.2388, lr_0 = 2.3504e-04
Loss = 7.8605e-02, PNorm = 44.8055, GNorm = 1.9756, lr_0 = 2.3018e-04
Validation rmse = 0.159799
Validation r2 = 0.800874
Validation mse = 0.025536
Epoch 37
Loss = 8.8286e-02, PNorm = 44.8172, GNorm = 3.3500, lr_0 = 2.2542e-04
Validation rmse = 0.166846
Validation r2 = 0.782923
Validation mse = 0.027838
Epoch 38
Loss = 7.5402e-02, PNorm = 44.8273, GNorm = 2.3320, lr_0 = 2.2030e-04
Loss = 7.7695e-02, PNorm = 44.8366, GNorm = 1.3649, lr_0 = 2.1574e-04
Validation rmse = 0.172429
Validation r2 = 0.768154
Validation mse = 0.029732
Epoch 39
Loss = 7.7623e-02, PNorm = 44.8458, GNorm = 0.7249, lr_0 = 2.1084e-04
Loss = 7.9370e-02, PNorm = 44.8537, GNorm = 2.4780, lr_0 = 2.0648e-04
Validation rmse = 0.165164
Validation r2 = 0.787278
Validation mse = 0.027279
Epoch 40
Loss = 7.1635e-02, PNorm = 44.8614, GNorm = 1.5542, lr_0 = 2.0221e-04
Loss = 8.2087e-02, PNorm = 44.8696, GNorm = 0.7517, lr_0 = 1.9803e-04
Validation rmse = 0.177622
Validation r2 = 0.753978
Validation mse = 0.031550
Epoch 41
Loss = 6.7164e-02, PNorm = 44.8802, GNorm = 1.1583, lr_0 = 1.9353e-04
Loss = 7.8107e-02, PNorm = 44.8877, GNorm = 0.7353, lr_0 = 1.8953e-04
Validation rmse = 0.165885
Validation r2 = 0.785418
Validation mse = 0.027518
Epoch 42
Loss = 7.5834e-02, PNorm = 44.8969, GNorm = 0.8164, lr_0 = 1.8561e-04
Loss = 7.6606e-02, PNorm = 44.9045, GNorm = 0.6905, lr_0 = 1.8177e-04
Validation rmse = 0.164797
Validation r2 = 0.788222
Validation mse = 0.027158
Epoch 43
Loss = 8.1113e-02, PNorm = 44.9131, GNorm = 1.7414, lr_0 = 1.7764e-04
Loss = 7.5611e-02, PNorm = 44.9207, GNorm = 1.1113, lr_0 = 1.7397e-04
Validation rmse = 0.164717
Validation r2 = 0.788428
Validation mse = 0.027132
Epoch 44
Loss = 7.5124e-02, PNorm = 44.9278, GNorm = 2.6848, lr_0 = 1.7037e-04
Loss = 6.7151e-02, PNorm = 44.9350, GNorm = 1.0336, lr_0 = 1.6685e-04
Validation rmse = 0.180189
Validation r2 = 0.746816
Validation mse = 0.032468
Epoch 45
Loss = 8.7010e-02, PNorm = 44.9432, GNorm = 3.0748, lr_0 = 1.6306e-04
Loss = 6.8761e-02, PNorm = 44.9505, GNorm = 0.8554, lr_0 = 1.5969e-04
Validation rmse = 0.173731
Validation r2 = 0.764640
Validation mse = 0.030182
Epoch 46
Loss = 6.9258e-02, PNorm = 44.9564, GNorm = 1.8848, lr_0 = 1.5638e-04
Loss = 7.4522e-02, PNorm = 44.9639, GNorm = 1.3758, lr_0 = 1.5315e-04
Validation rmse = 0.172317
Validation r2 = 0.768455
Validation mse = 0.029693
Epoch 47
Loss = 6.9577e-02, PNorm = 44.9712, GNorm = 1.5980, lr_0 = 1.4967e-04
Loss = 6.7043e-02, PNorm = 44.9773, GNorm = 1.1761, lr_0 = 1.4658e-04
Validation rmse = 0.167753
Validation r2 = 0.780559
Validation mse = 0.028141
Epoch 48
Loss = 4.9377e-02, PNorm = 44.9843, GNorm = 0.6977, lr_0 = 1.4354e-04
Loss = 6.9884e-02, PNorm = 44.9902, GNorm = 0.9884, lr_0 = 1.4058e-04
Validation rmse = 0.178047
Validation r2 = 0.752801
Validation mse = 0.031701
Epoch 49
Loss = 6.5220e-02, PNorm = 44.9969, GNorm = 1.6277, lr_0 = 1.3738e-04
Loss = 6.3458e-02, PNorm = 45.0029, GNorm = 1.1766, lr_0 = 1.3454e-04
Validation rmse = 0.177055
Validation r2 = 0.755546
Validation mse = 0.031348
Epoch 50
Loss = 6.8287e-02, PNorm = 45.0094, GNorm = 1.1937, lr_0 = 1.3176e-04
Loss = 6.2016e-02, PNorm = 45.0137, GNorm = 0.8698, lr_0 = 1.2904e-04
Validation rmse = 0.178099
Validation r2 = 0.752654
Validation mse = 0.031719
Epoch 51
Loss = 5.8316e-02, PNorm = 45.0207, GNorm = 0.6316, lr_0 = 1.2610e-04
Loss = 6.5837e-02, PNorm = 45.0259, GNorm = 0.8067, lr_0 = 1.2350e-04
Validation rmse = 0.173590
Validation r2 = 0.765021
Validation mse = 0.030133
Epoch 52
Loss = 6.8761e-02, PNorm = 45.0321, GNorm = 0.9360, lr_0 = 1.2069e-04
Loss = 5.4650e-02, PNorm = 45.0370, GNorm = 1.2435, lr_0 = 1.1819e-04
Validation rmse = 0.179589
Validation r2 = 0.748499
Validation mse = 0.032252
Epoch 53
Loss = 6.3128e-02, PNorm = 45.0421, GNorm = 0.7211, lr_0 = 1.1575e-04
Loss = 6.3803e-02, PNorm = 45.0468, GNorm = 0.7978, lr_0 = 1.1336e-04
Loss = 4.6795e-02, PNorm = 45.0473, GNorm = 0.9689, lr_0 = 1.1312e-04
Validation rmse = 0.171417
Validation r2 = 0.770866
Validation mse = 0.029384
Epoch 54
Loss = 5.8472e-02, PNorm = 45.0523, GNorm = 1.5173, lr_0 = 1.1078e-04
Loss = 6.3944e-02, PNorm = 45.0567, GNorm = 2.1226, lr_0 = 1.0849e-04
Validation rmse = 0.177249
Validation r2 = 0.755010
Validation mse = 0.031417
Epoch 55
Loss = 6.2332e-02, PNorm = 45.0616, GNorm = 1.4901, lr_0 = 1.0625e-04
Validation rmse = 0.164600
Validation r2 = 0.788728
Validation mse = 0.027093
Epoch 56
Loss = 4.0630e-02, PNorm = 45.0659, GNorm = 0.6867, lr_0 = 1.0383e-04
Loss = 5.8952e-02, PNorm = 45.0696, GNorm = 0.8106, lr_0 = 1.0169e-04
Validation rmse = 0.172954
Validation r2 = 0.766740
Validation mse = 0.029913
Epoch 57
Loss = 5.5219e-02, PNorm = 45.0741, GNorm = 0.9462, lr_0 = 1.0000e-04
Loss = 5.2181e-02, PNorm = 45.0786, GNorm = 0.5971, lr_0 = 1.0000e-04
Validation rmse = 0.176796
Validation r2 = 0.756262
Validation mse = 0.031257
Epoch 58
Loss = 6.6742e-02, PNorm = 45.0832, GNorm = 0.5978, lr_0 = 1.0000e-04
Loss = 4.6545e-02, PNorm = 45.0870, GNorm = 1.3699, lr_0 = 1.0000e-04
Validation rmse = 0.175507
Validation r2 = 0.759802
Validation mse = 0.030803
Epoch 59
Loss = 5.3641e-02, PNorm = 45.0909, GNorm = 1.1558, lr_0 = 1.0000e-04
Loss = 5.7923e-02, PNorm = 45.0958, GNorm = 1.1734, lr_0 = 1.0000e-04
Validation rmse = 0.175208
Validation r2 = 0.760621
Validation mse = 0.030698
Model 0 best validation rmse = 0.071308 on epoch 9
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.634214
Model 0 test r2 = -111.361859
Model 0 test mse = 0.402227
Ensemble test rmse = 0.634214
Ensemble test r2 = -111.361859
Ensemble test mse = 0.402227
Fold 9
Splitting data with seed 9
Total size = 983 | train size = 973 | val size = 10 | test size = 49
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 8.9482e-01, PNorm = 43.2640, GNorm = 8.1039, lr_0 = 3.6053e-04
Validation rmse = 0.269676
Validation r2 = 0.303872
Validation mse = 0.072725
Epoch 1
Loss = 7.0334e-01, PNorm = 43.2871, GNorm = 4.2768, lr_0 = 6.2105e-04
Loss = 6.6070e-01, PNorm = 43.3339, GNorm = 3.9634, lr_0 = 8.5789e-04
Validation rmse = 0.194004
Validation r2 = 0.639731
Validation mse = 0.037638
Epoch 2
Loss = 4.0656e-01, PNorm = 43.4102, GNorm = 7.2663, lr_0 = 9.8961e-04
Loss = 4.2804e-01, PNorm = 43.4953, GNorm = 2.6207, lr_0 = 9.6914e-04
Validation rmse = 0.232259
Validation r2 = 0.483643
Validation mse = 0.053944
Epoch 3
Loss = 4.3958e-01, PNorm = 43.5679, GNorm = 8.2077, lr_0 = 9.4910e-04
Loss = 3.1908e-01, PNorm = 43.6278, GNorm = 7.5870, lr_0 = 9.2948e-04
Validation rmse = 0.223293
Validation r2 = 0.522740
Validation mse = 0.049860
Epoch 4
Loss = 2.8467e-01, PNorm = 43.6818, GNorm = 1.3190, lr_0 = 9.0836e-04
Loss = 2.7243e-01, PNorm = 43.7348, GNorm = 2.6799, lr_0 = 8.8958e-04
Validation rmse = 0.172190
Validation r2 = 0.716196
Validation mse = 0.029649
Epoch 5
Loss = 2.0239e-01, PNorm = 43.7834, GNorm = 3.0893, lr_0 = 8.7118e-04
Loss = 2.5078e-01, PNorm = 43.8219, GNorm = 4.1696, lr_0 = 8.5317e-04
Validation rmse = 0.158600
Validation r2 = 0.759225
Validation mse = 0.025154
Epoch 6
Loss = 2.2845e-01, PNorm = 43.8655, GNorm = 1.3165, lr_0 = 8.3378e-04
Loss = 2.1693e-01, PNorm = 43.9078, GNorm = 2.8895, lr_0 = 8.1654e-04
Validation rmse = 0.170557
Validation r2 = 0.721552
Validation mse = 0.029090
Epoch 7
Loss = 2.0595e-01, PNorm = 43.9356, GNorm = 5.8650, lr_0 = 7.9966e-04
Loss = 1.7455e-01, PNorm = 43.9576, GNorm = 0.7344, lr_0 = 7.8312e-04
Validation rmse = 0.161617
Validation r2 = 0.749980
Validation mse = 0.026120
Epoch 8
Loss = 1.7606e-01, PNorm = 43.9863, GNorm = 1.8892, lr_0 = 7.6533e-04
Loss = 1.7648e-01, PNorm = 44.0084, GNorm = 1.6242, lr_0 = 7.4950e-04
Validation rmse = 0.159884
Validation r2 = 0.755310
Validation mse = 0.025563
Epoch 9
Loss = 1.7186e-01, PNorm = 44.0290, GNorm = 0.9865, lr_0 = 7.3400e-04
Loss = 1.6704e-01, PNorm = 44.0533, GNorm = 1.4238, lr_0 = 7.1883e-04
Validation rmse = 0.158488
Validation r2 = 0.759565
Validation mse = 0.025118
Epoch 10
Loss = 1.4136e-01, PNorm = 44.0763, GNorm = 0.8578, lr_0 = 7.0249e-04
Loss = 1.5558e-01, PNorm = 44.0963, GNorm = 3.9526, lr_0 = 6.8797e-04
Validation rmse = 0.151339
Validation r2 = 0.780768
Validation mse = 0.022903
Epoch 11
Loss = 1.5436e-01, PNorm = 44.1144, GNorm = 1.2885, lr_0 = 6.7374e-04
Loss = 1.3446e-01, PNorm = 44.1376, GNorm = 1.0880, lr_0 = 6.5981e-04
Validation rmse = 0.164257
Validation r2 = 0.741742
Validation mse = 0.026981
Epoch 12
Loss = 1.6599e-01, PNorm = 44.1665, GNorm = 4.3883, lr_0 = 6.4482e-04
Loss = 2.0251e-01, PNorm = 44.1917, GNorm = 5.5385, lr_0 = 6.3148e-04
Validation rmse = 0.203978
Validation r2 = 0.601737
Validation mse = 0.041607
Epoch 13
Loss = 2.1763e-01, PNorm = 44.2215, GNorm = 1.5356, lr_0 = 6.1714e-04
Loss = 1.6674e-01, PNorm = 44.2524, GNorm = 5.1405, lr_0 = 6.0438e-04
Validation rmse = 0.198203
Validation r2 = 0.623970
Validation mse = 0.039284
Epoch 14
Loss = 1.6230e-01, PNorm = 44.2784, GNorm = 2.6873, lr_0 = 5.9188e-04
Loss = 1.4484e-01, PNorm = 44.2983, GNorm = 1.8504, lr_0 = 5.7964e-04
Validation rmse = 0.159806
Validation r2 = 0.755551
Validation mse = 0.025538
Epoch 15
Loss = 1.1964e-01, PNorm = 44.3197, GNorm = 1.4121, lr_0 = 5.6647e-04
Loss = 1.4117e-01, PNorm = 44.3385, GNorm = 2.1797, lr_0 = 5.5476e-04
Validation rmse = 0.165032
Validation r2 = 0.739302
Validation mse = 0.027235
Epoch 16
Loss = 1.4752e-01, PNorm = 44.3577, GNorm = 0.8605, lr_0 = 5.4328e-04
Loss = 1.1266e-01, PNorm = 44.3763, GNorm = 1.0589, lr_0 = 5.3205e-04
Loss = 1.0843e-01, PNorm = 44.3777, GNorm = 1.4452, lr_0 = 5.3094e-04
Validation rmse = 0.154455
Validation r2 = 0.771645
Validation mse = 0.023856
Epoch 17
Loss = 1.2487e-01, PNorm = 44.3932, GNorm = 1.6692, lr_0 = 5.1996e-04
Loss = 1.1895e-01, PNorm = 44.4107, GNorm = 1.8256, lr_0 = 5.0921e-04
Validation rmse = 0.161755
Validation r2 = 0.749553
Validation mse = 0.026165
Epoch 18
Loss = 1.2129e-01, PNorm = 44.4278, GNorm = 1.6924, lr_0 = 4.9868e-04
Validation rmse = 0.149446
Validation r2 = 0.786219
Validation mse = 0.022334
Epoch 19
Loss = 1.1504e-01, PNorm = 44.4448, GNorm = 1.2151, lr_0 = 4.8735e-04
Loss = 1.2073e-01, PNorm = 44.4632, GNorm = 3.9389, lr_0 = 4.7727e-04
Validation rmse = 0.161253
Validation r2 = 0.751103
Validation mse = 0.026003
Epoch 20
Loss = 1.4119e-01, PNorm = 44.4803, GNorm = 0.6459, lr_0 = 4.6740e-04
Loss = 1.0814e-01, PNorm = 44.5004, GNorm = 1.3242, lr_0 = 4.5774e-04
Validation rmse = 0.173859
Validation r2 = 0.710665
Validation mse = 0.030227
Epoch 21
Loss = 1.6376e-01, PNorm = 44.5165, GNorm = 2.6830, lr_0 = 4.4734e-04
Loss = 1.0882e-01, PNorm = 44.5306, GNorm = 2.0939, lr_0 = 4.3809e-04
Validation rmse = 0.151731
Validation r2 = 0.779631
Validation mse = 0.023022
Epoch 22
Loss = 1.1910e-01, PNorm = 44.5481, GNorm = 2.4428, lr_0 = 4.2903e-04
Loss = 1.1286e-01, PNorm = 44.5676, GNorm = 1.4639, lr_0 = 4.2016e-04
Validation rmse = 0.150646
Validation r2 = 0.782770
Validation mse = 0.022694
Epoch 23
Loss = 1.1089e-01, PNorm = 44.5831, GNorm = 0.8157, lr_0 = 4.1061e-04
Loss = 1.0551e-01, PNorm = 44.5964, GNorm = 1.1434, lr_0 = 4.0212e-04
Validation rmse = 0.159463
Validation r2 = 0.756599
Validation mse = 0.025428
Epoch 24
Loss = 1.0665e-01, PNorm = 44.6110, GNorm = 1.6371, lr_0 = 3.9381e-04
Loss = 1.0224e-01, PNorm = 44.6270, GNorm = 0.8920, lr_0 = 3.8566e-04
Validation rmse = 0.151377
Validation r2 = 0.780657
Validation mse = 0.022915
Epoch 25
Loss = 8.8857e-02, PNorm = 44.6446, GNorm = 0.8312, lr_0 = 3.7690e-04
Loss = 1.0990e-01, PNorm = 44.6599, GNorm = 0.8208, lr_0 = 3.6911e-04
Validation rmse = 0.163795
Validation r2 = 0.743194
Validation mse = 0.026829
Epoch 26
Loss = 9.0782e-02, PNorm = 44.6769, GNorm = 0.7920, lr_0 = 3.6072e-04
Loss = 9.0349e-02, PNorm = 44.6898, GNorm = 1.6078, lr_0 = 3.5326e-04
Validation rmse = 0.135333
Validation r2 = 0.824689
Validation mse = 0.018315
Epoch 27
Loss = 7.8535e-02, PNorm = 44.7043, GNorm = 1.4456, lr_0 = 3.4596e-04
Loss = 1.0811e-01, PNorm = 44.7186, GNorm = 1.9609, lr_0 = 3.3880e-04
Validation rmse = 0.144610
Validation r2 = 0.799830
Validation mse = 0.020912
Epoch 28
Loss = 8.1629e-02, PNorm = 44.7309, GNorm = 1.0318, lr_0 = 3.3110e-04
Loss = 9.0440e-02, PNorm = 44.7407, GNorm = 0.7477, lr_0 = 3.2426e-04
Validation rmse = 0.144375
Validation r2 = 0.800478
Validation mse = 0.020844
Epoch 29
Loss = 1.0078e-01, PNorm = 44.7560, GNorm = 2.2803, lr_0 = 3.1755e-04
Loss = 8.1049e-02, PNorm = 44.7688, GNorm = 0.5851, lr_0 = 3.1099e-04
Validation rmse = 0.135077
Validation r2 = 0.825350
Validation mse = 0.018246
Epoch 30
Loss = 8.4170e-02, PNorm = 44.7835, GNorm = 1.4027, lr_0 = 3.0392e-04
Loss = 8.4380e-02, PNorm = 44.7957, GNorm = 1.0513, lr_0 = 2.9764e-04
Validation rmse = 0.150723
Validation r2 = 0.782548
Validation mse = 0.022717
Epoch 31
Loss = 7.2634e-02, PNorm = 44.8084, GNorm = 0.7503, lr_0 = 2.9148e-04
Loss = 8.8799e-02, PNorm = 44.8185, GNorm = 0.5356, lr_0 = 2.8545e-04
Validation rmse = 0.142826
Validation r2 = 0.804738
Validation mse = 0.020399
Epoch 32
Loss = 8.9074e-02, PNorm = 44.8337, GNorm = 1.0732, lr_0 = 2.7897e-04
Loss = 7.7673e-02, PNorm = 44.8459, GNorm = 1.2538, lr_0 = 2.7320e-04
Validation rmse = 0.142640
Validation r2 = 0.805247
Validation mse = 0.020346
Epoch 33
Loss = 7.2002e-02, PNorm = 44.8561, GNorm = 1.0443, lr_0 = 2.6755e-04
Loss = 8.4027e-02, PNorm = 44.8675, GNorm = 0.8486, lr_0 = 2.6202e-04
Validation rmse = 0.152709
Validation r2 = 0.776781
Validation mse = 0.023320
Epoch 34
Loss = 8.0385e-02, PNorm = 44.8791, GNorm = 0.8034, lr_0 = 2.5606e-04
Loss = 7.7836e-02, PNorm = 44.8887, GNorm = 0.9967, lr_0 = 2.5077e-04
Validation rmse = 0.145033
Validation r2 = 0.798657
Validation mse = 0.021035
Epoch 35
Loss = 7.6325e-02, PNorm = 44.9020, GNorm = 1.0191, lr_0 = 2.4558e-04
Loss = 7.7011e-02, PNorm = 44.9125, GNorm = 1.0425, lr_0 = 2.4051e-04
Loss = 3.7564e-02, PNorm = 44.9134, GNorm = 0.8510, lr_0 = 2.4000e-04
Validation rmse = 0.136459
Validation r2 = 0.821760
Validation mse = 0.018621
Epoch 36
Loss = 6.9934e-02, PNorm = 44.9228, GNorm = 1.0687, lr_0 = 2.3504e-04
Loss = 8.0700e-02, PNorm = 44.9319, GNorm = 1.2326, lr_0 = 2.3018e-04
Validation rmse = 0.147333
Validation r2 = 0.792219
Validation mse = 0.021707
Epoch 37
Loss = 7.2611e-02, PNorm = 44.9403, GNorm = 0.8779, lr_0 = 2.2542e-04
Validation rmse = 0.143605
Validation r2 = 0.802601
Validation mse = 0.020622
Epoch 38
Loss = 5.2032e-02, PNorm = 44.9519, GNorm = 0.6021, lr_0 = 2.2030e-04
Loss = 6.7921e-02, PNorm = 44.9597, GNorm = 0.8194, lr_0 = 2.1574e-04
Validation rmse = 0.136124
Validation r2 = 0.822633
Validation mse = 0.018530
Epoch 39
Loss = 7.1027e-02, PNorm = 44.9696, GNorm = 1.1466, lr_0 = 2.1084e-04
Loss = 7.0977e-02, PNorm = 44.9794, GNorm = 1.0661, lr_0 = 2.0648e-04
Validation rmse = 0.134951
Validation r2 = 0.825677
Validation mse = 0.018212
Epoch 40
Loss = 6.1920e-02, PNorm = 44.9877, GNorm = 0.6530, lr_0 = 2.0221e-04
Loss = 6.5428e-02, PNorm = 44.9957, GNorm = 0.8354, lr_0 = 1.9803e-04
Validation rmse = 0.136574
Validation r2 = 0.821458
Validation mse = 0.018652
Epoch 41
Loss = 6.8414e-02, PNorm = 45.0045, GNorm = 0.6160, lr_0 = 1.9353e-04
Loss = 6.0333e-02, PNorm = 45.0133, GNorm = 2.1951, lr_0 = 1.8953e-04
Validation rmse = 0.148373
Validation r2 = 0.789276
Validation mse = 0.022015
Epoch 42
Loss = 8.7254e-02, PNorm = 45.0220, GNorm = 0.7155, lr_0 = 1.8561e-04
Loss = 6.3424e-02, PNorm = 45.0312, GNorm = 3.1616, lr_0 = 1.8177e-04
Validation rmse = 0.137392
Validation r2 = 0.819313
Validation mse = 0.018877
Epoch 43
Loss = 7.9243e-02, PNorm = 45.0394, GNorm = 0.6818, lr_0 = 1.7764e-04
Loss = 5.9238e-02, PNorm = 45.0467, GNorm = 0.5968, lr_0 = 1.7397e-04
Validation rmse = 0.132618
Validation r2 = 0.831651
Validation mse = 0.017588
Epoch 44
Loss = 5.5527e-02, PNorm = 45.0551, GNorm = 0.9768, lr_0 = 1.7037e-04
Loss = 5.1425e-02, PNorm = 45.0622, GNorm = 0.7110, lr_0 = 1.6685e-04
Validation rmse = 0.134760
Validation r2 = 0.826170
Validation mse = 0.018160
Epoch 45
Loss = 6.0031e-02, PNorm = 45.0694, GNorm = 1.2317, lr_0 = 1.6306e-04
Loss = 6.2221e-02, PNorm = 45.0759, GNorm = 0.5732, lr_0 = 1.5969e-04
Validation rmse = 0.131053
Validation r2 = 0.835603
Validation mse = 0.017175
Epoch 46
Loss = 7.0481e-02, PNorm = 45.0807, GNorm = 1.0592, lr_0 = 1.5638e-04
Loss = 5.7643e-02, PNorm = 45.0875, GNorm = 1.1913, lr_0 = 1.5315e-04
Validation rmse = 0.149701
Validation r2 = 0.785487
Validation mse = 0.022410
Epoch 47
Loss = 5.9439e-02, PNorm = 45.0939, GNorm = 0.8851, lr_0 = 1.4967e-04
Loss = 5.9535e-02, PNorm = 45.0995, GNorm = 0.9090, lr_0 = 1.4658e-04
Validation rmse = 0.146138
Validation r2 = 0.795578
Validation mse = 0.021356
Epoch 48
Loss = 7.0112e-02, PNorm = 45.1057, GNorm = 1.3727, lr_0 = 1.4354e-04
Loss = 6.8862e-02, PNorm = 45.1116, GNorm = 0.9383, lr_0 = 1.4058e-04
Validation rmse = 0.141503
Validation r2 = 0.808338
Validation mse = 0.020023
Epoch 49
Loss = 7.3156e-02, PNorm = 45.1194, GNorm = 1.4508, lr_0 = 1.3738e-04
Loss = 5.5793e-02, PNorm = 45.1248, GNorm = 1.1802, lr_0 = 1.3454e-04
Validation rmse = 0.136066
Validation r2 = 0.822785
Validation mse = 0.018514
Epoch 50
Loss = 6.4937e-02, PNorm = 45.1304, GNorm = 1.4336, lr_0 = 1.3176e-04
Loss = 5.7059e-02, PNorm = 45.1355, GNorm = 0.7107, lr_0 = 1.2904e-04
Validation rmse = 0.135667
Validation r2 = 0.823823
Validation mse = 0.018405
Epoch 51
Loss = 5.7481e-02, PNorm = 45.1415, GNorm = 0.8423, lr_0 = 1.2610e-04
Loss = 5.5122e-02, PNorm = 45.1463, GNorm = 0.6836, lr_0 = 1.2350e-04
Validation rmse = 0.137665
Validation r2 = 0.818594
Validation mse = 0.018952
Epoch 52
Loss = 5.9594e-02, PNorm = 45.1522, GNorm = 1.1820, lr_0 = 1.2069e-04
Loss = 5.3574e-02, PNorm = 45.1563, GNorm = 0.6045, lr_0 = 1.1819e-04
Validation rmse = 0.133916
Validation r2 = 0.828341
Validation mse = 0.017933
Epoch 53
Loss = 4.4658e-02, PNorm = 45.1619, GNorm = 0.9945, lr_0 = 1.1575e-04
Loss = 5.9157e-02, PNorm = 45.1655, GNorm = 1.4934, lr_0 = 1.1336e-04
Loss = 8.4157e-02, PNorm = 45.1661, GNorm = 1.6426, lr_0 = 1.1312e-04
Validation rmse = 0.140878
Validation r2 = 0.810028
Validation mse = 0.019847
Epoch 54
Loss = 5.7228e-02, PNorm = 45.1715, GNorm = 1.1556, lr_0 = 1.1078e-04
Loss = 5.4810e-02, PNorm = 45.1765, GNorm = 0.9751, lr_0 = 1.0849e-04
Validation rmse = 0.135064
Validation r2 = 0.825384
Validation mse = 0.018242
Epoch 55
Loss = 5.8259e-02, PNorm = 45.1812, GNorm = 0.7009, lr_0 = 1.0625e-04
Validation rmse = 0.133879
Validation r2 = 0.828435
Validation mse = 0.017924
Epoch 56
Loss = 4.2121e-02, PNorm = 45.1865, GNorm = 0.4937, lr_0 = 1.0383e-04
Loss = 4.9511e-02, PNorm = 45.1904, GNorm = 0.6972, lr_0 = 1.0169e-04
Validation rmse = 0.137930
Validation r2 = 0.817894
Validation mse = 0.019025
Epoch 57
Loss = 4.1759e-02, PNorm = 45.1939, GNorm = 0.7995, lr_0 = 1.0000e-04
Loss = 5.2733e-02, PNorm = 45.1979, GNorm = 1.7548, lr_0 = 1.0000e-04
Validation rmse = 0.141283
Validation r2 = 0.808934
Validation mse = 0.019961
Epoch 58
Loss = 4.6771e-02, PNorm = 45.2039, GNorm = 0.7298, lr_0 = 1.0000e-04
Loss = 4.9287e-02, PNorm = 45.2079, GNorm = 1.4015, lr_0 = 1.0000e-04
Validation rmse = 0.133128
Validation r2 = 0.830353
Validation mse = 0.017723
Epoch 59
Loss = 4.7528e-02, PNorm = 45.2119, GNorm = 1.0551, lr_0 = 1.0000e-04
Loss = 5.1216e-02, PNorm = 45.2167, GNorm = 0.6087, lr_0 = 1.0000e-04
Validation rmse = 0.137625
Validation r2 = 0.818701
Validation mse = 0.018941
Model 0 best validation rmse = 0.131053 on epoch 45
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.691429
Model 0 test r2 = -132.549779
Model 0 test mse = 0.478075
Ensemble test rmse = 0.691429
Ensemble test r2 = -132.549779
Ensemble test mse = 0.478075
10-fold cross validation
	Seed 0 ==> test rmse = 0.751905
	Seed 0 ==> test r2 = -156.933324
	Seed 0 ==> test mse = 0.565362
	Seed 1 ==> test rmse = 0.733593
	Seed 1 ==> test r2 = -149.334348
	Seed 1 ==> test mse = 0.538159
	Seed 2 ==> test rmse = 0.684782
	Seed 2 ==> test r2 = -129.994289
	Seed 2 ==> test mse = 0.468927
	Seed 3 ==> test rmse = 0.776524
	Seed 3 ==> test r2 = -167.444687
	Seed 3 ==> test mse = 0.602990
	Seed 4 ==> test rmse = 0.688462
	Seed 4 ==> test r2 = -131.406028
	Seed 4 ==> test mse = 0.473980
	Seed 5 ==> test rmse = 0.674044
	Seed 5 ==> test r2 = -125.918014
	Seed 5 ==> test mse = 0.454335
	Seed 6 ==> test rmse = 0.682864
	Seed 6 ==> test r2 = -129.261544
	Seed 6 ==> test mse = 0.466304
	Seed 7 ==> test rmse = 0.680363
	Seed 7 ==> test r2 = -128.308908
	Seed 7 ==> test mse = 0.462893
	Seed 8 ==> test rmse = 0.634214
	Seed 8 ==> test r2 = -111.361859
	Seed 8 ==> test mse = 0.402227
	Seed 9 ==> test rmse = 0.691429
	Seed 9 ==> test r2 = -132.549779
	Seed 9 ==> test mse = 0.478075
Overall test rmse = 0.699818 +/- 0.039746
Overall test r2 = -136.251278 +/- 15.768536
Overall test mse = 0.491325 +/- 0.056447
Elapsed time = 0:07:30
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-05d85262-3219-459a-86b2-5360cba4da72.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/Acet_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2', 'mse'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2', 'mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/Acet_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/Acet_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 936 | train size = 926 | val size = 10 | test size = 96
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 8.9511e-01, PNorm = 43.2630, GNorm = 5.5573, lr_0 = 3.7500e-04
Validation rmse = 0.199644
Validation r2 = 0.441178
Validation mse = 0.039858
Epoch 1
Loss = 7.3015e-01, PNorm = 43.2846, GNorm = 1.6166, lr_0 = 6.5000e-04
Loss = 6.9942e-01, PNorm = 43.3358, GNorm = 2.3006, lr_0 = 9.0000e-04
Validation rmse = 0.349273
Validation r2 = -0.710373
Validation mse = 0.121992
Epoch 2
Loss = 8.0658e-01, PNorm = 43.4139, GNorm = 11.2278, lr_0 = 9.8685e-04
Loss = 4.2698e-01, PNorm = 43.4863, GNorm = 0.8226, lr_0 = 9.6533e-04
Validation rmse = 0.150685
Validation r2 = 0.681654
Validation mse = 0.022706
Epoch 3
Loss = 5.2044e-01, PNorm = 43.5565, GNorm = 6.5864, lr_0 = 9.4219e-04
Loss = 3.6397e-01, PNorm = 43.6219, GNorm = 4.3214, lr_0 = 9.2164e-04
Validation rmse = 0.160002
Validation r2 = 0.641069
Validation mse = 0.025601
Epoch 4
Loss = 2.7632e-01, PNorm = 43.6780, GNorm = 4.1775, lr_0 = 9.0153e-04
Loss = 2.0603e-01, PNorm = 43.7302, GNorm = 0.7941, lr_0 = 8.8187e-04
Validation rmse = 0.069831
Validation r2 = 0.931632
Validation mse = 0.004876
Epoch 5
Loss = 1.8716e-01, PNorm = 43.7809, GNorm = 4.9856, lr_0 = 8.6073e-04
Loss = 2.2350e-01, PNorm = 43.8235, GNorm = 2.2216, lr_0 = 8.4195e-04
Validation rmse = 0.057308
Validation r2 = 0.953954
Validation mse = 0.003284
Epoch 6
Loss = 1.8676e-01, PNorm = 43.8559, GNorm = 1.5858, lr_0 = 8.2359e-04
Validation rmse = 0.052384
Validation r2 = 0.961527
Validation mse = 0.002744
Epoch 7
Loss = 1.5338e-01, PNorm = 43.9011, GNorm = 3.0441, lr_0 = 8.0385e-04
Loss = 1.7324e-01, PNorm = 43.9412, GNorm = 1.5452, lr_0 = 7.8631e-04
Validation rmse = 0.053327
Validation r2 = 0.960129
Validation mse = 0.002844
Epoch 8
Loss = 1.8525e-01, PNorm = 43.9683, GNorm = 1.5347, lr_0 = 7.6916e-04
Loss = 1.4662e-01, PNorm = 43.9946, GNorm = 0.7078, lr_0 = 7.5238e-04
Validation rmse = 0.135000
Validation r2 = 0.744479
Validation mse = 0.018225
Epoch 9
Loss = 1.3038e-01, PNorm = 44.0265, GNorm = 1.0501, lr_0 = 7.3435e-04
Loss = 1.3957e-01, PNorm = 44.0478, GNorm = 2.3125, lr_0 = 7.1833e-04
Validation rmse = 0.073772
Validation r2 = 0.923697
Validation mse = 0.005442
Epoch 10
Loss = 1.1696e-01, PNorm = 44.0709, GNorm = 1.0707, lr_0 = 7.0266e-04
Loss = 1.4353e-01, PNorm = 44.0958, GNorm = 1.0803, lr_0 = 6.8733e-04
Validation rmse = 0.152407
Validation r2 = 0.674334
Validation mse = 0.023228
Epoch 11
Loss = 1.3106e-01, PNorm = 44.1238, GNorm = 2.7921, lr_0 = 6.7085e-04
Loss = 1.2858e-01, PNorm = 44.1453, GNorm = 3.1374, lr_0 = 6.5622e-04
Validation rmse = 0.110420
Validation r2 = 0.829055
Validation mse = 0.012193
Epoch 12
Loss = 1.3069e-01, PNorm = 44.1779, GNorm = 2.4742, lr_0 = 6.4191e-04
Loss = 1.2426e-01, PNorm = 44.1975, GNorm = 2.0630, lr_0 = 6.2790e-04
Loss = 1.2658e-01, PNorm = 44.1996, GNorm = 1.2021, lr_0 = 6.2652e-04
Validation rmse = 0.092659
Validation r2 = 0.879625
Validation mse = 0.008586
Epoch 13
Loss = 1.0045e-01, PNorm = 44.2220, GNorm = 0.7424, lr_0 = 6.1285e-04
Validation rmse = 0.119045
Validation r2 = 0.801306
Validation mse = 0.014172
Epoch 14
Loss = 9.0132e-02, PNorm = 44.2417, GNorm = 2.2614, lr_0 = 5.9948e-04
Loss = 1.0794e-01, PNorm = 44.2613, GNorm = 1.8912, lr_0 = 5.8641e-04
Validation rmse = 0.065840
Validation r2 = 0.939223
Validation mse = 0.004335
Epoch 15
Loss = 1.1425e-01, PNorm = 44.2789, GNorm = 1.4694, lr_0 = 5.7235e-04
Loss = 1.1010e-01, PNorm = 44.2960, GNorm = 1.7766, lr_0 = 5.5987e-04
Validation rmse = 0.104192
Validation r2 = 0.847795
Validation mse = 0.010856
Epoch 16
Loss = 9.8929e-02, PNorm = 44.3119, GNorm = 0.7633, lr_0 = 5.4765e-04
Loss = 1.0606e-01, PNorm = 44.3278, GNorm = 3.6031, lr_0 = 5.3571e-04
Validation rmse = 0.086344
Validation r2 = 0.895473
Validation mse = 0.007455
Epoch 17
Loss = 9.3761e-02, PNorm = 44.3487, GNorm = 0.4640, lr_0 = 5.2287e-04
Loss = 1.0066e-01, PNorm = 44.3645, GNorm = 0.6199, lr_0 = 5.1146e-04
Validation rmse = 0.118424
Validation r2 = 0.803376
Validation mse = 0.014024
Epoch 18
Loss = 1.0576e-01, PNorm = 44.3797, GNorm = 1.8257, lr_0 = 5.0030e-04
Loss = 8.2395e-02, PNorm = 44.3927, GNorm = 0.3795, lr_0 = 4.8939e-04
Validation rmse = 0.109493
Validation r2 = 0.831912
Validation mse = 0.011989
Epoch 19
Loss = 1.0516e-01, PNorm = 44.4109, GNorm = 2.7488, lr_0 = 4.7766e-04
Loss = 9.5656e-02, PNorm = 44.4251, GNorm = 1.5051, lr_0 = 4.6724e-04
Validation rmse = 0.105891
Validation r2 = 0.842789
Validation mse = 0.011213
Epoch 20
Loss = 8.3247e-02, PNorm = 44.4398, GNorm = 0.5248, lr_0 = 4.5705e-04
Validation rmse = 0.092527
Validation r2 = 0.879969
Validation mse = 0.008561
Epoch 21
Loss = 5.8204e-02, PNorm = 44.4564, GNorm = 0.7925, lr_0 = 4.4609e-04
Loss = 8.9902e-02, PNorm = 44.4685, GNorm = 0.8625, lr_0 = 4.3636e-04
Validation rmse = 0.113560
Validation r2 = 0.819194
Validation mse = 0.012896
Epoch 22
Loss = 8.6947e-02, PNorm = 44.4806, GNorm = 2.2512, lr_0 = 4.2684e-04
Loss = 8.2189e-02, PNorm = 44.4953, GNorm = 0.6371, lr_0 = 4.1753e-04
Validation rmse = 0.082616
Validation r2 = 0.904305
Validation mse = 0.006825
Epoch 23
Loss = 9.6666e-02, PNorm = 44.5130, GNorm = 1.6199, lr_0 = 4.0752e-04
Loss = 9.3365e-02, PNorm = 44.5278, GNorm = 2.0477, lr_0 = 3.9863e-04
Validation rmse = 0.106482
Validation r2 = 0.841030
Validation mse = 0.011338
Epoch 24
Loss = 8.2707e-02, PNorm = 44.5408, GNorm = 1.9270, lr_0 = 3.8994e-04
Loss = 8.7175e-02, PNorm = 44.5533, GNorm = 0.6993, lr_0 = 3.8143e-04
Validation rmse = 0.101496
Validation r2 = 0.855569
Validation mse = 0.010301
Epoch 25
Loss = 7.9548e-02, PNorm = 44.5671, GNorm = 2.8782, lr_0 = 3.7311e-04
Loss = 7.2600e-02, PNorm = 44.5800, GNorm = 0.7106, lr_0 = 3.6497e-04
Validation rmse = 0.094301
Validation r2 = 0.875321
Validation mse = 0.008893
Epoch 26
Loss = 7.1592e-02, PNorm = 44.5934, GNorm = 1.0363, lr_0 = 3.5622e-04
Loss = 8.3866e-02, PNorm = 44.6046, GNorm = 1.6916, lr_0 = 3.4845e-04
Validation rmse = 0.125239
Validation r2 = 0.780092
Validation mse = 0.015685
Epoch 27
Loss = 9.0760e-02, PNorm = 44.6188, GNorm = 2.5032, lr_0 = 3.4085e-04
Validation rmse = 0.091309
Validation r2 = 0.883108
Validation mse = 0.008337
Epoch 28
Loss = 8.5967e-02, PNorm = 44.6294, GNorm = 0.6314, lr_0 = 3.3268e-04
Loss = 7.4683e-02, PNorm = 44.6421, GNorm = 1.0484, lr_0 = 3.2543e-04
Validation rmse = 0.117177
Validation r2 = 0.807493
Validation mse = 0.013730
Epoch 29
Loss = 6.7024e-02, PNorm = 44.6519, GNorm = 0.6934, lr_0 = 3.1833e-04
Loss = 7.5093e-02, PNorm = 44.6619, GNorm = 1.0621, lr_0 = 3.1138e-04
Validation rmse = 0.106378
Validation r2 = 0.841341
Validation mse = 0.011316
Epoch 30
Loss = 7.4814e-02, PNorm = 44.6735, GNorm = 2.4630, lr_0 = 3.0392e-04
Loss = 6.5012e-02, PNorm = 44.6842, GNorm = 1.1649, lr_0 = 2.9729e-04
Validation rmse = 0.116042
Validation r2 = 0.811204
Validation mse = 0.013466
Epoch 31
Loss = 7.7613e-02, PNorm = 44.6937, GNorm = 1.5844, lr_0 = 2.9080e-04
Loss = 7.5456e-02, PNorm = 44.7053, GNorm = 2.0368, lr_0 = 2.8446e-04
Validation rmse = 0.119098
Validation r2 = 0.801131
Validation mse = 0.014184
Epoch 32
Loss = 8.7907e-02, PNorm = 44.7173, GNorm = 2.1395, lr_0 = 2.7764e-04
Loss = 7.6429e-02, PNorm = 44.7284, GNorm = 0.6256, lr_0 = 2.7159e-04
Validation rmse = 0.103565
Validation r2 = 0.849620
Validation mse = 0.010726
Epoch 33
Loss = 6.6919e-02, PNorm = 44.7390, GNorm = 0.6980, lr_0 = 2.6566e-04
Validation rmse = 0.105265
Validation r2 = 0.844645
Validation mse = 0.011081
Epoch 34
Loss = 8.8720e-02, PNorm = 44.7485, GNorm = 1.4840, lr_0 = 2.5929e-04
Loss = 6.9342e-02, PNorm = 44.7585, GNorm = 2.4700, lr_0 = 2.5364e-04
Validation rmse = 0.088885
Validation r2 = 0.889232
Validation mse = 0.007900
Epoch 35
Loss = 5.4994e-02, PNorm = 44.7667, GNorm = 0.5200, lr_0 = 2.4811e-04
Loss = 6.7134e-02, PNorm = 44.7762, GNorm = 1.1821, lr_0 = 2.4269e-04
Validation rmse = 0.093876
Validation r2 = 0.876441
Validation mse = 0.008813
Epoch 36
Loss = 5.8350e-02, PNorm = 44.7845, GNorm = 0.9612, lr_0 = 2.3688e-04
Loss = 6.2801e-02, PNorm = 44.7918, GNorm = 0.9349, lr_0 = 2.3171e-04
Validation rmse = 0.095485
Validation r2 = 0.872171
Validation mse = 0.009117
Epoch 37
Loss = 7.2514e-02, PNorm = 44.7989, GNorm = 0.8401, lr_0 = 2.2665e-04
Loss = 5.4310e-02, PNorm = 44.8066, GNorm = 0.5529, lr_0 = 2.2171e-04
Validation rmse = 0.098387
Validation r2 = 0.864283
Validation mse = 0.009680
Epoch 38
Loss = 5.2756e-02, PNorm = 44.8138, GNorm = 1.3108, lr_0 = 2.1640e-04
Loss = 6.9302e-02, PNorm = 44.8229, GNorm = 2.3745, lr_0 = 2.1168e-04
Validation rmse = 0.089802
Validation r2 = 0.886933
Validation mse = 0.008064
Epoch 39
Loss = 5.1094e-02, PNorm = 44.8283, GNorm = 1.0978, lr_0 = 2.0706e-04
Loss = 6.1525e-02, PNorm = 44.8353, GNorm = 0.6826, lr_0 = 2.0254e-04
Loss = 7.8925e-02, PNorm = 44.8362, GNorm = 1.8663, lr_0 = 2.0209e-04
Validation rmse = 0.092091
Validation r2 = 0.881096
Validation mse = 0.008481
Epoch 40
Loss = 4.9769e-02, PNorm = 44.8423, GNorm = 0.6015, lr_0 = 1.9769e-04
Validation rmse = 0.095148
Validation r2 = 0.873073
Validation mse = 0.009053
Epoch 41
Loss = 5.9420e-02, PNorm = 44.8499, GNorm = 1.4437, lr_0 = 1.9337e-04
Loss = 5.5423e-02, PNorm = 44.8566, GNorm = 0.8794, lr_0 = 1.8916e-04
Validation rmse = 0.089833
Validation r2 = 0.886855
Validation mse = 0.008070
Epoch 42
Loss = 4.8774e-02, PNorm = 44.8634, GNorm = 1.9400, lr_0 = 1.8462e-04
Loss = 5.6351e-02, PNorm = 44.8696, GNorm = 1.2761, lr_0 = 1.8059e-04
Validation rmse = 0.099810
Validation r2 = 0.860327
Validation mse = 0.009962
Epoch 43
Loss = 4.2778e-02, PNorm = 44.8763, GNorm = 0.8655, lr_0 = 1.7666e-04
Loss = 5.6410e-02, PNorm = 44.8817, GNorm = 0.7577, lr_0 = 1.7280e-04
Validation rmse = 0.090887
Validation r2 = 0.884186
Validation mse = 0.008260
Epoch 44
Loss = 6.1425e-02, PNorm = 44.8878, GNorm = 2.3653, lr_0 = 1.6866e-04
Loss = 5.7344e-02, PNorm = 44.8936, GNorm = 1.7312, lr_0 = 1.6498e-04
Validation rmse = 0.095035
Validation r2 = 0.873371
Validation mse = 0.009032
Epoch 45
Loss = 5.4319e-02, PNorm = 44.8999, GNorm = 1.3702, lr_0 = 1.6138e-04
Loss = 5.5610e-02, PNorm = 44.9056, GNorm = 1.0967, lr_0 = 1.5786e-04
Validation rmse = 0.096724
Validation r2 = 0.868833
Validation mse = 0.009355
Epoch 46
Loss = 5.0049e-02, PNorm = 44.9124, GNorm = 1.0977, lr_0 = 1.5408e-04
Loss = 5.0726e-02, PNorm = 44.9168, GNorm = 1.1082, lr_0 = 1.5072e-04
Validation rmse = 0.103449
Validation r2 = 0.849959
Validation mse = 0.010702
Epoch 47
Loss = 5.0187e-02, PNorm = 44.9219, GNorm = 1.0962, lr_0 = 1.4743e-04
Validation rmse = 0.097732
Validation r2 = 0.866083
Validation mse = 0.009552
Epoch 48
Loss = 3.1923e-02, PNorm = 44.9267, GNorm = 0.8579, lr_0 = 1.4390e-04
Loss = 5.5304e-02, PNorm = 44.9332, GNorm = 0.6817, lr_0 = 1.4076e-04
Validation rmse = 0.097323
Validation r2 = 0.867201
Validation mse = 0.009472
Epoch 49
Loss = 5.7471e-02, PNorm = 44.9369, GNorm = 0.6441, lr_0 = 1.3769e-04
Loss = 5.0582e-02, PNorm = 44.9403, GNorm = 1.0661, lr_0 = 1.3468e-04
Validation rmse = 0.090112
Validation r2 = 0.886153
Validation mse = 0.008120
Epoch 50
Loss = 5.4176e-02, PNorm = 44.9450, GNorm = 1.2515, lr_0 = 1.3174e-04
Loss = 5.3860e-02, PNorm = 44.9497, GNorm = 1.0065, lr_0 = 1.2887e-04
Validation rmse = 0.107125
Validation r2 = 0.839104
Validation mse = 0.011476
Epoch 51
Loss = 5.4236e-02, PNorm = 44.9544, GNorm = 2.4293, lr_0 = 1.2578e-04
Loss = 4.8426e-02, PNorm = 44.9580, GNorm = 0.9951, lr_0 = 1.2304e-04
Validation rmse = 0.096840
Validation r2 = 0.868517
Validation mse = 0.009378
Epoch 52
Loss = 4.4107e-02, PNorm = 44.9631, GNorm = 0.8310, lr_0 = 1.2035e-04
Loss = 4.7687e-02, PNorm = 44.9677, GNorm = 1.0172, lr_0 = 1.1773e-04
Validation rmse = 0.100934
Validation r2 = 0.857164
Validation mse = 0.010188
Epoch 53
Loss = 4.0257e-02, PNorm = 44.9711, GNorm = 0.6092, lr_0 = 1.1491e-04
Loss = 4.9764e-02, PNorm = 44.9747, GNorm = 0.9123, lr_0 = 1.1240e-04
Validation rmse = 0.094724
Validation r2 = 0.874199
Validation mse = 0.008973
Epoch 54
Loss = 4.2063e-02, PNorm = 44.9780, GNorm = 0.6074, lr_0 = 1.0995e-04
Validation rmse = 0.097889
Validation r2 = 0.865652
Validation mse = 0.009582
Epoch 55
Loss = 4.2691e-02, PNorm = 44.9818, GNorm = 0.7037, lr_0 = 1.0731e-04
Loss = 4.5769e-02, PNorm = 44.9855, GNorm = 0.4772, lr_0 = 1.0497e-04
Validation rmse = 0.094012
Validation r2 = 0.876083
Validation mse = 0.008838
Epoch 56
Loss = 4.7840e-02, PNorm = 44.9890, GNorm = 0.8292, lr_0 = 1.0268e-04
Loss = 4.2789e-02, PNorm = 44.9920, GNorm = 0.9790, lr_0 = 1.0044e-04
Validation rmse = 0.093717
Validation r2 = 0.876860
Validation mse = 0.008783
Epoch 57
Loss = 4.6453e-02, PNorm = 44.9949, GNorm = 0.6470, lr_0 = 1.0000e-04
Loss = 4.2476e-02, PNorm = 44.9985, GNorm = 1.2851, lr_0 = 1.0000e-04
Validation rmse = 0.110297
Validation r2 = 0.829436
Validation mse = 0.012165
Epoch 58
Loss = 4.3166e-02, PNorm = 45.0022, GNorm = 1.1791, lr_0 = 1.0000e-04
Loss = 5.7333e-02, PNorm = 45.0054, GNorm = 0.8874, lr_0 = 1.0000e-04
Validation rmse = 0.091075
Validation r2 = 0.883705
Validation mse = 0.008295
Epoch 59
Loss = 5.3471e-02, PNorm = 45.0084, GNorm = 2.2897, lr_0 = 1.0000e-04
Loss = 4.4985e-02, PNorm = 45.0124, GNorm = 0.9905, lr_0 = 1.0000e-04
Validation rmse = 0.098202
Validation r2 = 0.864793
Validation mse = 0.009644
Model 0 best validation rmse = 0.052384 on epoch 6
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.261058
Model 0 test r2 = -0.728717
Model 0 test mse = 0.068151
Ensemble test rmse = 0.261058
Ensemble test r2 = -0.728717
Ensemble test mse = 0.068151
Fold 1
Splitting data with seed 1
Total size = 936 | train size = 926 | val size = 10 | test size = 96
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 1.0104e+00, PNorm = 43.2612, GNorm = 2.8482, lr_0 = 3.7500e-04
Validation rmse = 0.275665
Validation r2 = 0.261419
Validation mse = 0.075991
Epoch 1
Loss = 5.5256e-01, PNorm = 43.2862, GNorm = 0.7028, lr_0 = 6.5000e-04
Loss = 7.3025e-01, PNorm = 43.3322, GNorm = 1.8911, lr_0 = 9.0000e-04
Validation rmse = 0.271335
Validation r2 = 0.284441
Validation mse = 0.073623
Epoch 2
Loss = 4.4779e-01, PNorm = 43.3994, GNorm = 1.4299, lr_0 = 9.8685e-04
Loss = 5.3789e-01, PNorm = 43.4813, GNorm = 3.5125, lr_0 = 9.6533e-04
Validation rmse = 0.239834
Validation r2 = 0.440945
Validation mse = 0.057520
Epoch 3
Loss = 2.6748e-01, PNorm = 43.5661, GNorm = 0.7295, lr_0 = 9.4219e-04
Loss = 3.4886e-01, PNorm = 43.6356, GNorm = 6.1238, lr_0 = 9.2164e-04
Validation rmse = 0.241563
Validation r2 = 0.432854
Validation mse = 0.058353
Epoch 4
Loss = 2.8866e-01, PNorm = 43.6973, GNorm = 2.4481, lr_0 = 9.0153e-04
Loss = 2.2221e-01, PNorm = 43.7480, GNorm = 2.9514, lr_0 = 8.8187e-04
Validation rmse = 0.198773
Validation r2 = 0.615986
Validation mse = 0.039511
Epoch 5
Loss = 2.2783e-01, PNorm = 43.8048, GNorm = 1.5472, lr_0 = 8.6073e-04
Loss = 1.8594e-01, PNorm = 43.8499, GNorm = 1.9820, lr_0 = 8.4195e-04
Validation rmse = 0.178088
Validation r2 = 0.691749
Validation mse = 0.031715
Epoch 6
Loss = 1.8936e-01, PNorm = 43.8891, GNorm = 1.8694, lr_0 = 8.2359e-04
Validation rmse = 0.155691
Validation r2 = 0.764407
Validation mse = 0.024240
Epoch 7
Loss = 1.4879e-01, PNorm = 43.9266, GNorm = 1.0546, lr_0 = 8.0385e-04
Loss = 1.4802e-01, PNorm = 43.9499, GNorm = 1.8137, lr_0 = 7.8631e-04
Validation rmse = 0.199772
Validation r2 = 0.612114
Validation mse = 0.039909
Epoch 8
Loss = 1.7598e-01, PNorm = 43.9807, GNorm = 3.4548, lr_0 = 7.6916e-04
Loss = 1.4085e-01, PNorm = 44.0034, GNorm = 1.9035, lr_0 = 7.5238e-04
Validation rmse = 0.150827
Validation r2 = 0.778897
Validation mse = 0.022749
Epoch 9
Loss = 1.3944e-01, PNorm = 44.0317, GNorm = 3.4622, lr_0 = 7.3435e-04
Loss = 1.1788e-01, PNorm = 44.0523, GNorm = 1.7006, lr_0 = 7.1833e-04
Validation rmse = 0.155145
Validation r2 = 0.766058
Validation mse = 0.024070
Epoch 10
Loss = 1.2130e-01, PNorm = 44.0738, GNorm = 2.4613, lr_0 = 7.0266e-04
Loss = 1.2570e-01, PNorm = 44.0964, GNorm = 0.9510, lr_0 = 6.8733e-04
Validation rmse = 0.173531
Validation r2 = 0.707325
Validation mse = 0.030113
Epoch 11
Loss = 1.2569e-01, PNorm = 44.1287, GNorm = 3.7187, lr_0 = 6.7085e-04
Loss = 1.1793e-01, PNorm = 44.1520, GNorm = 1.9676, lr_0 = 6.5622e-04
Validation rmse = 0.149566
Validation r2 = 0.782579
Validation mse = 0.022370
Epoch 12
Loss = 1.2310e-01, PNorm = 44.1728, GNorm = 4.2073, lr_0 = 6.4191e-04
Loss = 1.1296e-01, PNorm = 44.1935, GNorm = 0.8603, lr_0 = 6.2790e-04
Loss = 1.2934e-01, PNorm = 44.1952, GNorm = 1.2131, lr_0 = 6.2652e-04
Validation rmse = 0.131630
Validation r2 = 0.831599
Validation mse = 0.017327
Epoch 13
Loss = 1.2178e-01, PNorm = 44.2104, GNorm = 1.7672, lr_0 = 6.1285e-04
Validation rmse = 0.150195
Validation r2 = 0.780746
Validation mse = 0.022559
Epoch 14
Loss = 1.5152e-01, PNorm = 44.2273, GNorm = 4.4726, lr_0 = 5.9948e-04
Loss = 1.1074e-01, PNorm = 44.2512, GNorm = 1.7276, lr_0 = 5.8641e-04
Validation rmse = 0.125619
Validation r2 = 0.846628
Validation mse = 0.015780
Epoch 15
Loss = 1.1544e-01, PNorm = 44.2718, GNorm = 4.6911, lr_0 = 5.7235e-04
Loss = 1.0438e-01, PNorm = 44.2900, GNorm = 2.2662, lr_0 = 5.5987e-04
Validation rmse = 0.132326
Validation r2 = 0.829813
Validation mse = 0.017510
Epoch 16
Loss = 1.1478e-01, PNorm = 44.3036, GNorm = 0.9029, lr_0 = 5.4765e-04
Loss = 1.2160e-01, PNorm = 44.3227, GNorm = 1.6720, lr_0 = 5.3571e-04
Validation rmse = 0.136356
Validation r2 = 0.819289
Validation mse = 0.018593
Epoch 17
Loss = 1.2685e-01, PNorm = 44.3409, GNorm = 2.6627, lr_0 = 5.2287e-04
Loss = 1.3058e-01, PNorm = 44.3559, GNorm = 4.1941, lr_0 = 5.1146e-04
Validation rmse = 0.130242
Validation r2 = 0.835133
Validation mse = 0.016963
Epoch 18
Loss = 1.1190e-01, PNorm = 44.3771, GNorm = 2.6055, lr_0 = 5.0030e-04
Loss = 1.3585e-01, PNorm = 44.3963, GNorm = 1.0976, lr_0 = 4.8939e-04
Validation rmse = 0.137977
Validation r2 = 0.814969
Validation mse = 0.019038
Epoch 19
Loss = 9.5203e-02, PNorm = 44.4175, GNorm = 1.9175, lr_0 = 4.7766e-04
Loss = 9.4414e-02, PNorm = 44.4326, GNorm = 0.8240, lr_0 = 4.6724e-04
Validation rmse = 0.130222
Validation r2 = 0.835184
Validation mse = 0.016958
Epoch 20
Loss = 9.8436e-02, PNorm = 44.4465, GNorm = 0.9780, lr_0 = 4.5705e-04
Validation rmse = 0.115153
Validation r2 = 0.871120
Validation mse = 0.013260
Epoch 21
Loss = 8.5092e-02, PNorm = 44.4582, GNorm = 2.3101, lr_0 = 4.4609e-04
Loss = 9.0936e-02, PNorm = 44.4709, GNorm = 1.1436, lr_0 = 4.3636e-04
Validation rmse = 0.119659
Validation r2 = 0.860837
Validation mse = 0.014318
Epoch 22
Loss = 8.3968e-02, PNorm = 44.4814, GNorm = 2.9418, lr_0 = 4.2684e-04
Loss = 9.0311e-02, PNorm = 44.4919, GNorm = 0.9580, lr_0 = 4.1753e-04
Validation rmse = 0.114449
Validation r2 = 0.872690
Validation mse = 0.013099
Epoch 23
Loss = 8.4159e-02, PNorm = 44.5083, GNorm = 1.2449, lr_0 = 4.0752e-04
Loss = 8.7697e-02, PNorm = 44.5189, GNorm = 1.6685, lr_0 = 3.9863e-04
Validation rmse = 0.113956
Validation r2 = 0.873786
Validation mse = 0.012986
Epoch 24
Loss = 7.6135e-02, PNorm = 44.5293, GNorm = 0.6943, lr_0 = 3.8994e-04
Loss = 8.4589e-02, PNorm = 44.5407, GNorm = 1.3544, lr_0 = 3.8143e-04
Validation rmse = 0.108225
Validation r2 = 0.886162
Validation mse = 0.011713
Epoch 25
Loss = 7.5094e-02, PNorm = 44.5518, GNorm = 1.9145, lr_0 = 3.7311e-04
Loss = 8.1645e-02, PNorm = 44.5640, GNorm = 1.5550, lr_0 = 3.6497e-04
Validation rmse = 0.115828
Validation r2 = 0.869606
Validation mse = 0.013416
Epoch 26
Loss = 7.6929e-02, PNorm = 44.5776, GNorm = 1.2763, lr_0 = 3.5622e-04
Loss = 7.7250e-02, PNorm = 44.5861, GNorm = 1.3538, lr_0 = 3.4845e-04
Validation rmse = 0.113170
Validation r2 = 0.875521
Validation mse = 0.012807
Epoch 27
Loss = 7.4848e-02, PNorm = 44.5957, GNorm = 1.1031, lr_0 = 3.4085e-04
Validation rmse = 0.115456
Validation r2 = 0.870442
Validation mse = 0.013330
Epoch 28
Loss = 1.0167e-01, PNorm = 44.6105, GNorm = 1.2919, lr_0 = 3.3268e-04
Loss = 5.9443e-02, PNorm = 44.6215, GNorm = 0.8319, lr_0 = 3.2543e-04
Validation rmse = 0.109097
Validation r2 = 0.884320
Validation mse = 0.011902
Epoch 29
Loss = 9.0672e-02, PNorm = 44.6298, GNorm = 2.4515, lr_0 = 3.1833e-04
Loss = 6.5616e-02, PNorm = 44.6395, GNorm = 1.2275, lr_0 = 3.1138e-04
Validation rmse = 0.110686
Validation r2 = 0.880925
Validation mse = 0.012251
Epoch 30
Loss = 7.0807e-02, PNorm = 44.6482, GNorm = 1.0243, lr_0 = 3.0392e-04
Loss = 7.2702e-02, PNorm = 44.6584, GNorm = 2.8651, lr_0 = 2.9729e-04
Validation rmse = 0.098720
Validation r2 = 0.905279
Validation mse = 0.009746
Epoch 31
Loss = 6.1055e-02, PNorm = 44.6666, GNorm = 0.7731, lr_0 = 2.9080e-04
Loss = 7.7748e-02, PNorm = 44.6763, GNorm = 0.9581, lr_0 = 2.8446e-04
Validation rmse = 0.108624
Validation r2 = 0.885321
Validation mse = 0.011799
Epoch 32
Loss = 7.3483e-02, PNorm = 44.6854, GNorm = 1.9534, lr_0 = 2.7764e-04
Loss = 7.5424e-02, PNorm = 44.6950, GNorm = 1.6744, lr_0 = 2.7159e-04
Validation rmse = 0.103377
Validation r2 = 0.896132
Validation mse = 0.010687
Epoch 33
Loss = 7.5063e-02, PNorm = 44.7048, GNorm = 1.6576, lr_0 = 2.6566e-04
Validation rmse = 0.098655
Validation r2 = 0.905405
Validation mse = 0.009733
Epoch 34
Loss = 5.7160e-02, PNorm = 44.7120, GNorm = 0.4339, lr_0 = 2.5929e-04
Loss = 6.0195e-02, PNorm = 44.7224, GNorm = 1.0432, lr_0 = 2.5364e-04
Validation rmse = 0.108564
Validation r2 = 0.885447
Validation mse = 0.011786
Epoch 35
Loss = 6.0575e-02, PNorm = 44.7283, GNorm = 0.6103, lr_0 = 2.4811e-04
Loss = 6.4720e-02, PNorm = 44.7354, GNorm = 0.9351, lr_0 = 2.4269e-04
Validation rmse = 0.100128
Validation r2 = 0.902559
Validation mse = 0.010026
Epoch 36
Loss = 5.9508e-02, PNorm = 44.7442, GNorm = 1.0682, lr_0 = 2.3688e-04
Loss = 6.5908e-02, PNorm = 44.7517, GNorm = 0.9454, lr_0 = 2.3171e-04
Validation rmse = 0.104863
Validation r2 = 0.893125
Validation mse = 0.010996
Epoch 37
Loss = 6.2168e-02, PNorm = 44.7601, GNorm = 1.4738, lr_0 = 2.2665e-04
Loss = 6.3166e-02, PNorm = 44.7686, GNorm = 1.3058, lr_0 = 2.2171e-04
Validation rmse = 0.101384
Validation r2 = 0.900098
Validation mse = 0.010279
Epoch 38
Loss = 5.6462e-02, PNorm = 44.7770, GNorm = 0.5339, lr_0 = 2.1640e-04
Loss = 6.8227e-02, PNorm = 44.7837, GNorm = 1.4725, lr_0 = 2.1168e-04
Validation rmse = 0.100588
Validation r2 = 0.901662
Validation mse = 0.010118
Epoch 39
Loss = 6.1530e-02, PNorm = 44.7893, GNorm = 1.5251, lr_0 = 2.0706e-04
Loss = 6.7195e-02, PNorm = 44.7966, GNorm = 0.7780, lr_0 = 2.0254e-04
Loss = 3.9265e-02, PNorm = 44.7974, GNorm = 0.7535, lr_0 = 2.0209e-04
Validation rmse = 0.106681
Validation r2 = 0.889387
Validation mse = 0.011381
Epoch 40
Loss = 5.6074e-02, PNorm = 44.8045, GNorm = 0.6063, lr_0 = 1.9769e-04
Validation rmse = 0.098381
Validation r2 = 0.905929
Validation mse = 0.009679
Epoch 41
Loss = 6.3276e-02, PNorm = 44.8108, GNorm = 1.0285, lr_0 = 1.9337e-04
Loss = 6.1548e-02, PNorm = 44.8172, GNorm = 0.8612, lr_0 = 1.8916e-04
Validation rmse = 0.100789
Validation r2 = 0.901268
Validation mse = 0.010158
Epoch 42
Loss = 4.7634e-02, PNorm = 44.8244, GNorm = 0.9958, lr_0 = 1.8462e-04
Loss = 5.9311e-02, PNorm = 44.8295, GNorm = 1.2865, lr_0 = 1.8059e-04
Validation rmse = 0.101433
Validation r2 = 0.900001
Validation mse = 0.010289
Epoch 43
Loss = 6.3872e-02, PNorm = 44.8361, GNorm = 1.2300, lr_0 = 1.7666e-04
Loss = 5.6288e-02, PNorm = 44.8413, GNorm = 0.5746, lr_0 = 1.7280e-04
Validation rmse = 0.094827
Validation r2 = 0.912603
Validation mse = 0.008992
Epoch 44
Loss = 5.9734e-02, PNorm = 44.8479, GNorm = 0.5530, lr_0 = 1.6866e-04
Loss = 5.4297e-02, PNorm = 44.8547, GNorm = 0.7368, lr_0 = 1.6498e-04
Validation rmse = 0.101352
Validation r2 = 0.900161
Validation mse = 0.010272
Epoch 45
Loss = 5.8586e-02, PNorm = 44.8596, GNorm = 0.6139, lr_0 = 1.6138e-04
Loss = 5.6795e-02, PNorm = 44.8654, GNorm = 0.9211, lr_0 = 1.5786e-04
Validation rmse = 0.096356
Validation r2 = 0.909762
Validation mse = 0.009284
Epoch 46
Loss = 5.6447e-02, PNorm = 44.8706, GNorm = 0.4959, lr_0 = 1.5408e-04
Loss = 5.5674e-02, PNorm = 44.8760, GNorm = 1.0406, lr_0 = 1.5072e-04
Validation rmse = 0.092780
Validation r2 = 0.916335
Validation mse = 0.008608
Epoch 47
Loss = 5.6992e-02, PNorm = 44.8810, GNorm = 0.6129, lr_0 = 1.4743e-04
Validation rmse = 0.095425
Validation r2 = 0.911497
Validation mse = 0.009106
Epoch 48
Loss = 5.2148e-02, PNorm = 44.8859, GNorm = 0.5601, lr_0 = 1.4390e-04
Loss = 5.1023e-02, PNorm = 44.8906, GNorm = 1.9011, lr_0 = 1.4076e-04
Validation rmse = 0.096787
Validation r2 = 0.908953
Validation mse = 0.009368
Epoch 49
Loss = 4.5090e-02, PNorm = 44.8948, GNorm = 0.7702, lr_0 = 1.3769e-04
Loss = 4.5987e-02, PNorm = 44.8978, GNorm = 1.0248, lr_0 = 1.3468e-04
Validation rmse = 0.097389
Validation r2 = 0.907815
Validation mse = 0.009485
Epoch 50
Loss = 5.5588e-02, PNorm = 44.9038, GNorm = 1.7782, lr_0 = 1.3174e-04
Loss = 5.3256e-02, PNorm = 44.9088, GNorm = 1.0373, lr_0 = 1.2887e-04
Validation rmse = 0.097830
Validation r2 = 0.906980
Validation mse = 0.009571
Epoch 51
Loss = 5.0775e-02, PNorm = 44.9132, GNorm = 0.6768, lr_0 = 1.2578e-04
Loss = 4.8476e-02, PNorm = 44.9173, GNorm = 0.5672, lr_0 = 1.2304e-04
Validation rmse = 0.093260
Validation r2 = 0.915467
Validation mse = 0.008697
Epoch 52
Loss = 4.8869e-02, PNorm = 44.9216, GNorm = 0.8127, lr_0 = 1.2035e-04
Loss = 5.1661e-02, PNorm = 44.9250, GNorm = 2.5903, lr_0 = 1.1773e-04
Validation rmse = 0.093428
Validation r2 = 0.915162
Validation mse = 0.008729
Epoch 53
Loss = 5.1579e-02, PNorm = 44.9294, GNorm = 1.1032, lr_0 = 1.1491e-04
Loss = 4.9253e-02, PNorm = 44.9337, GNorm = 0.9840, lr_0 = 1.1240e-04
Validation rmse = 0.090330
Validation r2 = 0.920695
Validation mse = 0.008160
Epoch 54
Loss = 5.0092e-02, PNorm = 44.9371, GNorm = 0.7362, lr_0 = 1.0995e-04
Validation rmse = 0.094385
Validation r2 = 0.913415
Validation mse = 0.008909
Epoch 55
Loss = 3.9114e-02, PNorm = 44.9412, GNorm = 0.7337, lr_0 = 1.0731e-04
Loss = 4.8119e-02, PNorm = 44.9442, GNorm = 1.8216, lr_0 = 1.0497e-04
Validation rmse = 0.092179
Validation r2 = 0.917416
Validation mse = 0.008497
Epoch 56
Loss = 5.5378e-02, PNorm = 44.9475, GNorm = 0.6753, lr_0 = 1.0268e-04
Loss = 4.4482e-02, PNorm = 44.9516, GNorm = 0.5194, lr_0 = 1.0044e-04
Validation rmse = 0.092430
Validation r2 = 0.916966
Validation mse = 0.008543
Epoch 57
Loss = 5.3765e-02, PNorm = 44.9542, GNorm = 0.6103, lr_0 = 1.0000e-04
Loss = 4.5538e-02, PNorm = 44.9574, GNorm = 1.1633, lr_0 = 1.0000e-04
Validation rmse = 0.092491
Validation r2 = 0.916855
Validation mse = 0.008555
Epoch 58
Loss = 4.4629e-02, PNorm = 44.9609, GNorm = 0.5649, lr_0 = 1.0000e-04
Loss = 4.6759e-02, PNorm = 44.9641, GNorm = 0.7135, lr_0 = 1.0000e-04
Validation rmse = 0.091707
Validation r2 = 0.918259
Validation mse = 0.008410
Epoch 59
Loss = 4.3319e-02, PNorm = 44.9675, GNorm = 0.9793, lr_0 = 1.0000e-04
Loss = 4.8822e-02, PNorm = 44.9709, GNorm = 0.5880, lr_0 = 1.0000e-04
Validation rmse = 0.095790
Validation r2 = 0.910819
Validation mse = 0.009176
Model 0 best validation rmse = 0.090330 on epoch 53
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.267589
Model 0 test r2 = -0.816286
Model 0 test mse = 0.071604
Ensemble test rmse = 0.267589
Ensemble test r2 = -0.816286
Ensemble test mse = 0.071604
Fold 2
Splitting data with seed 2
Total size = 936 | train size = 926 | val size = 10 | test size = 96
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.5103e-01, PNorm = 43.2631, GNorm = 0.7790, lr_0 = 3.7500e-04
Validation rmse = 0.236077
Validation r2 = 0.369150
Validation mse = 0.055733
Epoch 1
Loss = 5.9259e-01, PNorm = 43.2883, GNorm = 5.1326, lr_0 = 6.5000e-04
Loss = 6.7512e-01, PNorm = 43.3376, GNorm = 7.0530, lr_0 = 9.0000e-04
Validation rmse = 0.228593
Validation r2 = 0.408514
Validation mse = 0.052255
Epoch 2
Loss = 4.7753e-01, PNorm = 43.4132, GNorm = 5.1380, lr_0 = 9.8685e-04
Loss = 4.6087e-01, PNorm = 43.4913, GNorm = 5.4359, lr_0 = 9.6533e-04
Validation rmse = 0.168333
Validation r2 = 0.679259
Validation mse = 0.028336
Epoch 3
Loss = 3.3199e-01, PNorm = 43.5721, GNorm = 1.8945, lr_0 = 9.4219e-04
Loss = 3.2566e-01, PNorm = 43.6298, GNorm = 2.0814, lr_0 = 9.2164e-04
Validation rmse = 0.165062
Validation r2 = 0.691602
Validation mse = 0.027245
Epoch 4
Loss = 2.9032e-01, PNorm = 43.6906, GNorm = 0.9098, lr_0 = 9.0153e-04
Loss = 2.4763e-01, PNorm = 43.7483, GNorm = 1.1418, lr_0 = 8.8187e-04
Validation rmse = 0.205486
Validation r2 = 0.522052
Validation mse = 0.042224
Epoch 5
Loss = 1.8329e-01, PNorm = 43.7986, GNorm = 1.1416, lr_0 = 8.6073e-04
Loss = 1.9028e-01, PNorm = 43.8366, GNorm = 0.7857, lr_0 = 8.4195e-04
Validation rmse = 0.131435
Validation r2 = 0.804460
Validation mse = 0.017275
Epoch 6
Loss = 1.6796e-01, PNorm = 43.8742, GNorm = 2.6989, lr_0 = 8.2359e-04
Validation rmse = 0.156758
Validation r2 = 0.721850
Validation mse = 0.024573
Epoch 7
Loss = 1.4788e-01, PNorm = 43.9093, GNorm = 1.1906, lr_0 = 8.0385e-04
Loss = 1.3875e-01, PNorm = 43.9427, GNorm = 1.2709, lr_0 = 7.8631e-04
Validation rmse = 0.162441
Validation r2 = 0.701318
Validation mse = 0.026387
Epoch 8
Loss = 1.3441e-01, PNorm = 43.9682, GNorm = 2.8161, lr_0 = 7.6916e-04
Loss = 1.6396e-01, PNorm = 43.9988, GNorm = 2.6388, lr_0 = 7.5238e-04
Validation rmse = 0.125008
Validation r2 = 0.823114
Validation mse = 0.015627
Epoch 9
Loss = 2.0180e-01, PNorm = 44.0306, GNorm = 2.2426, lr_0 = 7.3435e-04
Loss = 1.3922e-01, PNorm = 44.0607, GNorm = 0.8644, lr_0 = 7.1833e-04
Validation rmse = 0.149054
Validation r2 = 0.748519
Validation mse = 0.022217
Epoch 10
Loss = 1.0614e-01, PNorm = 44.0978, GNorm = 0.8677, lr_0 = 7.0266e-04
Loss = 1.2438e-01, PNorm = 44.1194, GNorm = 1.5002, lr_0 = 6.8733e-04
Validation rmse = 0.142884
Validation r2 = 0.768909
Validation mse = 0.020416
Epoch 11
Loss = 1.3851e-01, PNorm = 44.1471, GNorm = 3.6569, lr_0 = 6.7085e-04
Loss = 1.1918e-01, PNorm = 44.1715, GNorm = 1.2957, lr_0 = 6.5622e-04
Validation rmse = 0.125223
Validation r2 = 0.822504
Validation mse = 0.015681
Epoch 12
Loss = 1.0549e-01, PNorm = 44.1908, GNorm = 0.5970, lr_0 = 6.4191e-04
Loss = 1.1649e-01, PNorm = 44.2109, GNorm = 0.9913, lr_0 = 6.2790e-04
Loss = 1.0704e-01, PNorm = 44.2134, GNorm = 0.9590, lr_0 = 6.2652e-04
Validation rmse = 0.114430
Validation r2 = 0.851783
Validation mse = 0.013094
Epoch 13
Loss = 1.1072e-01, PNorm = 44.2316, GNorm = 3.4579, lr_0 = 6.1285e-04
Validation rmse = 0.101874
Validation r2 = 0.882525
Validation mse = 0.010378
Epoch 14
Loss = 1.2267e-01, PNorm = 44.2491, GNorm = 3.3162, lr_0 = 5.9948e-04
Loss = 1.0729e-01, PNorm = 44.2668, GNorm = 0.8293, lr_0 = 5.8641e-04
Validation rmse = 0.125154
Validation r2 = 0.822702
Validation mse = 0.015663
Epoch 15
Loss = 1.4070e-01, PNorm = 44.2822, GNorm = 2.0136, lr_0 = 5.7235e-04
Loss = 9.4003e-02, PNorm = 44.3010, GNorm = 1.3087, lr_0 = 5.5987e-04
Validation rmse = 0.103558
Validation r2 = 0.878609
Validation mse = 0.010724
Epoch 16
Loss = 1.0249e-01, PNorm = 44.3175, GNorm = 1.7293, lr_0 = 5.4765e-04
Loss = 9.6939e-02, PNorm = 44.3373, GNorm = 1.0471, lr_0 = 5.3571e-04
Validation rmse = 0.101105
Validation r2 = 0.884292
Validation mse = 0.010222
Epoch 17
Loss = 7.1077e-02, PNorm = 44.3533, GNorm = 2.0042, lr_0 = 5.2287e-04
Loss = 1.0284e-01, PNorm = 44.3694, GNorm = 2.7313, lr_0 = 5.1146e-04
Validation rmse = 0.091449
Validation r2 = 0.905338
Validation mse = 0.008363
Epoch 18
Loss = 9.3531e-02, PNorm = 44.3845, GNorm = 1.0553, lr_0 = 5.0030e-04
Loss = 1.0267e-01, PNorm = 44.4003, GNorm = 1.5720, lr_0 = 4.8939e-04
Validation rmse = 0.118330
Validation r2 = 0.841509
Validation mse = 0.014002
Epoch 19
Loss = 1.0026e-01, PNorm = 44.4211, GNorm = 1.6798, lr_0 = 4.7766e-04
Loss = 9.0833e-02, PNorm = 44.4357, GNorm = 1.3418, lr_0 = 4.6724e-04
Validation rmse = 0.086951
Validation r2 = 0.914422
Validation mse = 0.007560
Epoch 20
Loss = 8.8365e-02, PNorm = 44.4548, GNorm = 1.5428, lr_0 = 4.5705e-04
Validation rmse = 0.130226
Validation r2 = 0.808039
Validation mse = 0.016959
Epoch 21
Loss = 7.9463e-02, PNorm = 44.4705, GNorm = 2.1014, lr_0 = 4.4609e-04
Loss = 1.2183e-01, PNorm = 44.4851, GNorm = 3.1788, lr_0 = 4.3636e-04
Validation rmse = 0.120520
Validation r2 = 0.835588
Validation mse = 0.014525
Epoch 22
Loss = 1.0011e-01, PNorm = 44.5019, GNorm = 3.1528, lr_0 = 4.2684e-04
Loss = 1.0849e-01, PNorm = 44.5234, GNorm = 3.1194, lr_0 = 4.1753e-04
Validation rmse = 0.088525
Validation r2 = 0.911296
Validation mse = 0.007837
Epoch 23
Loss = 9.0646e-02, PNorm = 44.5409, GNorm = 0.5734, lr_0 = 4.0752e-04
Loss = 8.2525e-02, PNorm = 44.5530, GNorm = 3.3998, lr_0 = 3.9863e-04
Validation rmse = 0.083475
Validation r2 = 0.921126
Validation mse = 0.006968
Epoch 24
Loss = 8.7339e-02, PNorm = 44.5681, GNorm = 1.1890, lr_0 = 3.8994e-04
Loss = 8.3576e-02, PNorm = 44.5775, GNorm = 0.9477, lr_0 = 3.8143e-04
Validation rmse = 0.099491
Validation r2 = 0.887957
Validation mse = 0.009898
Epoch 25
Loss = 8.8984e-02, PNorm = 44.5867, GNorm = 1.1230, lr_0 = 3.7311e-04
Loss = 8.1497e-02, PNorm = 44.6000, GNorm = 0.6176, lr_0 = 3.6497e-04
Validation rmse = 0.090256
Validation r2 = 0.907791
Validation mse = 0.008146
Epoch 26
Loss = 7.4000e-02, PNorm = 44.6127, GNorm = 1.4986, lr_0 = 3.5622e-04
Loss = 8.9400e-02, PNorm = 44.6217, GNorm = 1.1338, lr_0 = 3.4845e-04
Validation rmse = 0.082186
Validation r2 = 0.923544
Validation mse = 0.006754
Epoch 27
Loss = 7.6004e-02, PNorm = 44.6335, GNorm = 0.8032, lr_0 = 3.4085e-04
Validation rmse = 0.110851
Validation r2 = 0.860909
Validation mse = 0.012288
Epoch 28
Loss = 9.8491e-02, PNorm = 44.6454, GNorm = 2.8714, lr_0 = 3.3268e-04
Loss = 7.7423e-02, PNorm = 44.6556, GNorm = 0.7454, lr_0 = 3.2543e-04
Validation rmse = 0.087651
Validation r2 = 0.913037
Validation mse = 0.007683
Epoch 29
Loss = 5.2876e-02, PNorm = 44.6661, GNorm = 1.2635, lr_0 = 3.1833e-04
Loss = 7.1259e-02, PNorm = 44.6765, GNorm = 1.7412, lr_0 = 3.1138e-04
Validation rmse = 0.086795
Validation r2 = 0.914728
Validation mse = 0.007533
Epoch 30
Loss = 7.3493e-02, PNorm = 44.6876, GNorm = 2.5374, lr_0 = 3.0392e-04
Loss = 7.3767e-02, PNorm = 44.6970, GNorm = 1.1598, lr_0 = 2.9729e-04
Validation rmse = 0.092934
Validation r2 = 0.902238
Validation mse = 0.008637
Epoch 31
Loss = 6.0427e-02, PNorm = 44.7084, GNorm = 0.9092, lr_0 = 2.9080e-04
Loss = 7.9859e-02, PNorm = 44.7172, GNorm = 0.6360, lr_0 = 2.8446e-04
Validation rmse = 0.092747
Validation r2 = 0.902633
Validation mse = 0.008602
Epoch 32
Loss = 6.4197e-02, PNorm = 44.7285, GNorm = 0.6676, lr_0 = 2.7764e-04
Loss = 7.6055e-02, PNorm = 44.7379, GNorm = 1.5407, lr_0 = 2.7159e-04
Validation rmse = 0.093378
Validation r2 = 0.901302
Validation mse = 0.008720
Epoch 33
Loss = 6.8604e-02, PNorm = 44.7468, GNorm = 1.1716, lr_0 = 2.6566e-04
Validation rmse = 0.080601
Validation r2 = 0.926464
Validation mse = 0.006497
Epoch 34
Loss = 9.7737e-02, PNorm = 44.7567, GNorm = 1.7643, lr_0 = 2.5929e-04
Loss = 7.1609e-02, PNorm = 44.7669, GNorm = 0.6916, lr_0 = 2.5364e-04
Validation rmse = 0.082957
Validation r2 = 0.922102
Validation mse = 0.006882
Epoch 35
Loss = 5.4671e-02, PNorm = 44.7734, GNorm = 0.6512, lr_0 = 2.4811e-04
Loss = 6.7177e-02, PNorm = 44.7829, GNorm = 0.6414, lr_0 = 2.4269e-04
Validation rmse = 0.090026
Validation r2 = 0.908261
Validation mse = 0.008105
Epoch 36
Loss = 4.6081e-02, PNorm = 44.7919, GNorm = 1.2358, lr_0 = 2.3688e-04
Loss = 6.6141e-02, PNorm = 44.8016, GNorm = 0.7755, lr_0 = 2.3171e-04
Validation rmse = 0.081029
Validation r2 = 0.925681
Validation mse = 0.006566
Epoch 37
Loss = 5.3384e-02, PNorm = 44.8090, GNorm = 0.9627, lr_0 = 2.2665e-04
Loss = 6.0328e-02, PNorm = 44.8177, GNorm = 0.7543, lr_0 = 2.2171e-04
Validation rmse = 0.086071
Validation r2 = 0.916144
Validation mse = 0.007408
Epoch 38
Loss = 6.1471e-02, PNorm = 44.8260, GNorm = 2.1024, lr_0 = 2.1640e-04
Loss = 6.3512e-02, PNorm = 44.8336, GNorm = 0.6328, lr_0 = 2.1168e-04
Validation rmse = 0.082867
Validation r2 = 0.922271
Validation mse = 0.006867
Epoch 39
Loss = 6.0613e-02, PNorm = 44.8418, GNorm = 0.6969, lr_0 = 2.0706e-04
Loss = 6.2683e-02, PNorm = 44.8479, GNorm = 0.5286, lr_0 = 2.0254e-04
Loss = 6.2548e-02, PNorm = 44.8488, GNorm = 1.4682, lr_0 = 2.0209e-04
Validation rmse = 0.086774
Validation r2 = 0.914768
Validation mse = 0.007530
Epoch 40
Loss = 6.0508e-02, PNorm = 44.8542, GNorm = 1.4987, lr_0 = 1.9769e-04
Validation rmse = 0.086778
Validation r2 = 0.914761
Validation mse = 0.007530
Epoch 41
Loss = 5.8634e-02, PNorm = 44.8628, GNorm = 0.6280, lr_0 = 1.9337e-04
Loss = 5.8713e-02, PNorm = 44.8691, GNorm = 0.5954, lr_0 = 1.8916e-04
Validation rmse = 0.083500
Validation r2 = 0.921079
Validation mse = 0.006972
Epoch 42
Loss = 6.2210e-02, PNorm = 44.8781, GNorm = 0.8674, lr_0 = 1.8462e-04
Loss = 5.8669e-02, PNorm = 44.8854, GNorm = 2.0201, lr_0 = 1.8059e-04
Validation rmse = 0.078927
Validation r2 = 0.929488
Validation mse = 0.006229
Epoch 43
Loss = 4.8810e-02, PNorm = 44.8924, GNorm = 1.2315, lr_0 = 1.7666e-04
Loss = 6.3145e-02, PNorm = 44.8985, GNorm = 1.2079, lr_0 = 1.7280e-04
Validation rmse = 0.083235
Validation r2 = 0.921579
Validation mse = 0.006928
Epoch 44
Loss = 4.2834e-02, PNorm = 44.9050, GNorm = 0.8364, lr_0 = 1.6866e-04
Loss = 6.7830e-02, PNorm = 44.9105, GNorm = 2.6129, lr_0 = 1.6498e-04
Validation rmse = 0.091775
Validation r2 = 0.904661
Validation mse = 0.008423
Epoch 45
Loss = 5.2922e-02, PNorm = 44.9178, GNorm = 0.9067, lr_0 = 1.6138e-04
Loss = 5.9377e-02, PNorm = 44.9229, GNorm = 1.5482, lr_0 = 1.5786e-04
Validation rmse = 0.084185
Validation r2 = 0.919778
Validation mse = 0.007087
Epoch 46
Loss = 4.9404e-02, PNorm = 44.9296, GNorm = 0.6136, lr_0 = 1.5408e-04
Loss = 5.8005e-02, PNorm = 44.9351, GNorm = 1.5343, lr_0 = 1.5072e-04
Validation rmse = 0.079186
Validation r2 = 0.929024
Validation mse = 0.006270
Epoch 47
Loss = 5.2027e-02, PNorm = 44.9399, GNorm = 0.7235, lr_0 = 1.4743e-04
Validation rmse = 0.084534
Validation r2 = 0.919113
Validation mse = 0.007146
Epoch 48
Loss = 5.8830e-02, PNorm = 44.9467, GNorm = 1.2916, lr_0 = 1.4390e-04
Loss = 4.9186e-02, PNorm = 44.9521, GNorm = 0.8653, lr_0 = 1.4076e-04
Validation rmse = 0.073957
Validation r2 = 0.938087
Validation mse = 0.005470
Epoch 49
Loss = 4.9358e-02, PNorm = 44.9575, GNorm = 1.1827, lr_0 = 1.3769e-04
Loss = 5.6421e-02, PNorm = 44.9625, GNorm = 0.5507, lr_0 = 1.3468e-04
Validation rmse = 0.081231
Validation r2 = 0.925310
Validation mse = 0.006598
Epoch 50
Loss = 4.8475e-02, PNorm = 44.9680, GNorm = 0.6023, lr_0 = 1.3174e-04
Loss = 5.2027e-02, PNorm = 44.9730, GNorm = 0.6908, lr_0 = 1.2887e-04
Validation rmse = 0.086356
Validation r2 = 0.915588
Validation mse = 0.007457
Epoch 51
Loss = 5.0443e-02, PNorm = 44.9783, GNorm = 1.0358, lr_0 = 1.2578e-04
Loss = 5.0969e-02, PNorm = 44.9824, GNorm = 0.8741, lr_0 = 1.2304e-04
Validation rmse = 0.072828
Validation r2 = 0.939964
Validation mse = 0.005304
Epoch 52
Loss = 4.6294e-02, PNorm = 44.9872, GNorm = 0.5845, lr_0 = 1.2035e-04
Loss = 4.8789e-02, PNorm = 44.9908, GNorm = 0.4182, lr_0 = 1.1773e-04
Validation rmse = 0.082385
Validation r2 = 0.923172
Validation mse = 0.006787
Epoch 53
Loss = 4.7904e-02, PNorm = 44.9956, GNorm = 0.4633, lr_0 = 1.1491e-04
Loss = 4.8309e-02, PNorm = 45.0000, GNorm = 0.8938, lr_0 = 1.1240e-04
Validation rmse = 0.077943
Validation r2 = 0.931234
Validation mse = 0.006075
Epoch 54
Loss = 4.3818e-02, PNorm = 45.0042, GNorm = 0.8455, lr_0 = 1.0995e-04
Validation rmse = 0.078709
Validation r2 = 0.929876
Validation mse = 0.006195
Epoch 55
Loss = 4.2775e-02, PNorm = 45.0086, GNorm = 0.6744, lr_0 = 1.0731e-04
Loss = 4.6722e-02, PNorm = 45.0128, GNorm = 1.2874, lr_0 = 1.0497e-04
Validation rmse = 0.083132
Validation r2 = 0.921774
Validation mse = 0.006911
Epoch 56
Loss = 5.1447e-02, PNorm = 45.0167, GNorm = 0.9912, lr_0 = 1.0268e-04
Loss = 4.7150e-02, PNorm = 45.0209, GNorm = 2.1420, lr_0 = 1.0044e-04
Validation rmse = 0.077654
Validation r2 = 0.931744
Validation mse = 0.006030
Epoch 57
Loss = 4.2513e-02, PNorm = 45.0249, GNorm = 0.9256, lr_0 = 1.0000e-04
Loss = 4.5750e-02, PNorm = 45.0281, GNorm = 0.7807, lr_0 = 1.0000e-04
Validation rmse = 0.077102
Validation r2 = 0.932711
Validation mse = 0.005945
Epoch 58
Loss = 3.8467e-02, PNorm = 45.0321, GNorm = 1.5134, lr_0 = 1.0000e-04
Loss = 5.6646e-02, PNorm = 45.0358, GNorm = 0.7559, lr_0 = 1.0000e-04
Validation rmse = 0.076052
Validation r2 = 0.934531
Validation mse = 0.005784
Epoch 59
Loss = 4.3837e-02, PNorm = 45.0405, GNorm = 1.4317, lr_0 = 1.0000e-04
Loss = 4.8070e-02, PNorm = 45.0447, GNorm = 0.6100, lr_0 = 1.0000e-04
Validation rmse = 0.084003
Validation r2 = 0.920126
Validation mse = 0.007057
Model 0 best validation rmse = 0.072828 on epoch 51
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.289844
Model 0 test r2 = -1.130963
Model 0 test mse = 0.084009
Ensemble test rmse = 0.289844
Ensemble test r2 = -1.130963
Ensemble test mse = 0.084009
Fold 3
Splitting data with seed 3
Total size = 936 | train size = 926 | val size = 10 | test size = 96
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.8832e-01, PNorm = 43.2607, GNorm = 1.9934, lr_0 = 3.7500e-04
Validation rmse = 0.377479
Validation r2 = -6.595793
Validation mse = 0.142491
Epoch 1
Loss = 6.3980e-01, PNorm = 43.2878, GNorm = 2.1370, lr_0 = 6.5000e-04
Loss = 6.4851e-01, PNorm = 43.3281, GNorm = 3.4024, lr_0 = 9.0000e-04
Validation rmse = 0.203964
Validation r2 = -1.217656
Validation mse = 0.041601
Epoch 2
Loss = 4.9005e-01, PNorm = 43.4035, GNorm = 7.5763, lr_0 = 9.8685e-04
Loss = 5.3955e-01, PNorm = 43.4655, GNorm = 1.4438, lr_0 = 9.6533e-04
Validation rmse = 0.276963
Validation r2 = -3.089137
Validation mse = 0.076709
Epoch 3
Loss = 3.9828e-01, PNorm = 43.5437, GNorm = 0.8091, lr_0 = 9.4219e-04
Loss = 3.0004e-01, PNorm = 43.6130, GNorm = 4.4461, lr_0 = 9.2164e-04
Validation rmse = 0.156311
Validation r2 = -0.302465
Validation mse = 0.024433
Epoch 4
Loss = 2.4235e-01, PNorm = 43.6649, GNorm = 0.5423, lr_0 = 9.0153e-04
Loss = 2.3435e-01, PNorm = 43.7137, GNorm = 2.3793, lr_0 = 8.8187e-04
Validation rmse = 0.069070
Validation r2 = 0.745685
Validation mse = 0.004771
Epoch 5
Loss = 2.3735e-01, PNorm = 43.7516, GNorm = 6.9237, lr_0 = 8.6073e-04
Loss = 2.0393e-01, PNorm = 43.7891, GNorm = 2.8252, lr_0 = 8.4195e-04
Validation rmse = 0.112820
Validation r2 = 0.321489
Validation mse = 0.012728
Epoch 6
Loss = 1.7565e-01, PNorm = 43.8211, GNorm = 0.9140, lr_0 = 8.2359e-04
Validation rmse = 0.072987
Validation r2 = 0.716027
Validation mse = 0.005327
Epoch 7
Loss = 1.7399e-01, PNorm = 43.8534, GNorm = 1.1103, lr_0 = 8.0385e-04
Loss = 1.7161e-01, PNorm = 43.8756, GNorm = 5.1223, lr_0 = 7.8631e-04
Validation rmse = 0.189174
Validation r2 = -0.907707
Validation mse = 0.035787
Epoch 8
Loss = 2.6272e-01, PNorm = 43.9080, GNorm = 3.4706, lr_0 = 7.6916e-04
Loss = 2.3653e-01, PNorm = 43.9431, GNorm = 4.6050, lr_0 = 7.5238e-04
Validation rmse = 0.099072
Validation r2 = 0.476774
Validation mse = 0.009815
Epoch 9
Loss = 1.4766e-01, PNorm = 43.9757, GNorm = 1.4130, lr_0 = 7.3435e-04
Loss = 1.5023e-01, PNorm = 44.0023, GNorm = 0.9543, lr_0 = 7.1833e-04
Validation rmse = 0.094618
Validation r2 = 0.522763
Validation mse = 0.008953
Epoch 10
Loss = 1.2500e-01, PNorm = 44.0222, GNorm = 1.3816, lr_0 = 7.0266e-04
Loss = 1.3940e-01, PNorm = 44.0476, GNorm = 2.0068, lr_0 = 6.8733e-04
Validation rmse = 0.065215
Validation r2 = 0.773288
Validation mse = 0.004253
Epoch 11
Loss = 1.1659e-01, PNorm = 44.0661, GNorm = 0.7568, lr_0 = 6.7085e-04
Loss = 1.3158e-01, PNorm = 44.0870, GNorm = 2.7623, lr_0 = 6.5622e-04
Validation rmse = 0.079275
Validation r2 = 0.664985
Validation mse = 0.006285
Epoch 12
Loss = 1.2376e-01, PNorm = 44.1037, GNorm = 1.9217, lr_0 = 6.4191e-04
Loss = 1.1142e-01, PNorm = 44.1210, GNorm = 3.1838, lr_0 = 6.2790e-04
Loss = 8.0433e-02, PNorm = 44.1225, GNorm = 2.8417, lr_0 = 6.2652e-04
Validation rmse = 0.074325
Validation r2 = 0.705517
Validation mse = 0.005524
Epoch 13
Loss = 1.3230e-01, PNorm = 44.1403, GNorm = 1.4065, lr_0 = 6.1285e-04
Validation rmse = 0.084262
Validation r2 = 0.621513
Validation mse = 0.007100
Epoch 14
Loss = 1.6916e-01, PNorm = 44.1583, GNorm = 3.9918, lr_0 = 5.9948e-04
Loss = 1.3059e-01, PNorm = 44.1808, GNorm = 2.3697, lr_0 = 5.8641e-04
Validation rmse = 0.095651
Validation r2 = 0.512285
Validation mse = 0.009149
Epoch 15
Loss = 9.9461e-02, PNorm = 44.2019, GNorm = 2.0151, lr_0 = 5.7235e-04
Loss = 1.0513e-01, PNorm = 44.2165, GNorm = 1.1441, lr_0 = 5.5987e-04
Validation rmse = 0.060305
Validation r2 = 0.806138
Validation mse = 0.003637
Epoch 16
Loss = 1.0652e-01, PNorm = 44.2293, GNorm = 1.3926, lr_0 = 5.4765e-04
Loss = 1.1107e-01, PNorm = 44.2469, GNorm = 1.5381, lr_0 = 5.3571e-04
Validation rmse = 0.064280
Validation r2 = 0.779736
Validation mse = 0.004132
Epoch 17
Loss = 8.1619e-02, PNorm = 44.2634, GNorm = 1.1044, lr_0 = 5.2287e-04
Loss = 1.0683e-01, PNorm = 44.2789, GNorm = 0.7794, lr_0 = 5.1146e-04
Validation rmse = 0.095190
Validation r2 = 0.516977
Validation mse = 0.009061
Epoch 18
Loss = 1.0617e-01, PNorm = 44.2899, GNorm = 0.9547, lr_0 = 5.0030e-04
Loss = 1.0684e-01, PNorm = 44.3052, GNorm = 2.3865, lr_0 = 4.8939e-04
Validation rmse = 0.072694
Validation r2 = 0.718303
Validation mse = 0.005284
Epoch 19
Loss = 9.8786e-02, PNorm = 44.3242, GNorm = 2.3179, lr_0 = 4.7766e-04
Loss = 9.3303e-02, PNorm = 44.3378, GNorm = 1.8165, lr_0 = 4.6724e-04
Validation rmse = 0.081422
Validation r2 = 0.646600
Validation mse = 0.006629
Epoch 20
Loss = 1.1531e-01, PNorm = 44.3518, GNorm = 3.8581, lr_0 = 4.5705e-04
Validation rmse = 0.060593
Validation r2 = 0.804282
Validation mse = 0.003671
Epoch 21
Loss = 7.7047e-02, PNorm = 44.3689, GNorm = 0.6211, lr_0 = 4.4609e-04
Loss = 9.7650e-02, PNorm = 44.3818, GNorm = 1.6823, lr_0 = 4.3636e-04
Validation rmse = 0.070236
Validation r2 = 0.737030
Validation mse = 0.004933
Epoch 22
Loss = 9.3298e-02, PNorm = 44.3950, GNorm = 1.7329, lr_0 = 4.2684e-04
Loss = 8.1824e-02, PNorm = 44.4068, GNorm = 1.0073, lr_0 = 4.1753e-04
Validation rmse = 0.067934
Validation r2 = 0.753987
Validation mse = 0.004615
Epoch 23
Loss = 8.3715e-02, PNorm = 44.4195, GNorm = 1.2641, lr_0 = 4.0752e-04
Loss = 8.5205e-02, PNorm = 44.4302, GNorm = 1.0504, lr_0 = 3.9863e-04
Validation rmse = 0.078362
Validation r2 = 0.672660
Validation mse = 0.006141
Epoch 24
Loss = 7.2833e-02, PNorm = 44.4393, GNorm = 0.6787, lr_0 = 3.8994e-04
Loss = 8.7528e-02, PNorm = 44.4504, GNorm = 2.5056, lr_0 = 3.8143e-04
Validation rmse = 0.075475
Validation r2 = 0.696336
Validation mse = 0.005696
Epoch 25
Loss = 7.9973e-02, PNorm = 44.4620, GNorm = 1.3641, lr_0 = 3.7311e-04
Loss = 7.8155e-02, PNorm = 44.4739, GNorm = 0.8547, lr_0 = 3.6497e-04
Validation rmse = 0.069686
Validation r2 = 0.741135
Validation mse = 0.004856
Epoch 26
Loss = 7.1081e-02, PNorm = 44.4850, GNorm = 0.5592, lr_0 = 3.5622e-04
Loss = 7.9877e-02, PNorm = 44.4935, GNorm = 1.1921, lr_0 = 3.4845e-04
Validation rmse = 0.085005
Validation r2 = 0.614806
Validation mse = 0.007226
Epoch 27
Loss = 8.6865e-02, PNorm = 44.5060, GNorm = 1.1344, lr_0 = 3.4085e-04
Validation rmse = 0.086111
Validation r2 = 0.604724
Validation mse = 0.007415
Epoch 28
Loss = 6.3588e-02, PNorm = 44.5171, GNorm = 0.8645, lr_0 = 3.3268e-04
Loss = 7.6039e-02, PNorm = 44.5277, GNorm = 1.1587, lr_0 = 3.2543e-04
Validation rmse = 0.098186
Validation r2 = 0.486097
Validation mse = 0.009640
Epoch 29
Loss = 7.5484e-02, PNorm = 44.5384, GNorm = 0.8232, lr_0 = 3.1833e-04
Loss = 7.5707e-02, PNorm = 44.5481, GNorm = 1.1925, lr_0 = 3.1138e-04
Validation rmse = 0.085040
Validation r2 = 0.614496
Validation mse = 0.007232
Epoch 30
Loss = 7.6317e-02, PNorm = 44.5601, GNorm = 1.4643, lr_0 = 3.0392e-04
Loss = 7.1283e-02, PNorm = 44.5694, GNorm = 1.0000, lr_0 = 2.9729e-04
Validation rmse = 0.087126
Validation r2 = 0.595344
Validation mse = 0.007591
Epoch 31
Loss = 6.7971e-02, PNorm = 44.5784, GNorm = 2.5865, lr_0 = 2.9080e-04
Loss = 7.2618e-02, PNorm = 44.5872, GNorm = 1.0285, lr_0 = 2.8446e-04
Validation rmse = 0.079933
Validation r2 = 0.659403
Validation mse = 0.006389
Epoch 32
Loss = 8.3608e-02, PNorm = 44.5998, GNorm = 1.2711, lr_0 = 2.7764e-04
Loss = 6.4761e-02, PNorm = 44.6100, GNorm = 2.8846, lr_0 = 2.7159e-04
Validation rmse = 0.094960
Validation r2 = 0.519302
Validation mse = 0.009017
Epoch 33
Loss = 5.5364e-02, PNorm = 44.6169, GNorm = 0.8709, lr_0 = 2.6566e-04
Validation rmse = 0.075412
Validation r2 = 0.696839
Validation mse = 0.005687
Epoch 34
Loss = 5.2334e-02, PNorm = 44.6253, GNorm = 0.6352, lr_0 = 2.5929e-04
Loss = 7.0689e-02, PNorm = 44.6349, GNorm = 0.6658, lr_0 = 2.5364e-04
Validation rmse = 0.091616
Validation r2 = 0.552570
Validation mse = 0.008393
Epoch 35
Loss = 5.4928e-02, PNorm = 44.6438, GNorm = 0.6997, lr_0 = 2.4811e-04
Loss = 6.1671e-02, PNorm = 44.6520, GNorm = 1.3158, lr_0 = 2.4269e-04
Validation rmse = 0.085562
Validation r2 = 0.609746
Validation mse = 0.007321
Epoch 36
Loss = 5.6299e-02, PNorm = 44.6609, GNorm = 1.1486, lr_0 = 2.3688e-04
Loss = 6.1798e-02, PNorm = 44.6661, GNorm = 0.7050, lr_0 = 2.3171e-04
Validation rmse = 0.081256
Validation r2 = 0.648039
Validation mse = 0.006602
Epoch 37
Loss = 5.6576e-02, PNorm = 44.6749, GNorm = 0.9448, lr_0 = 2.2665e-04
Loss = 7.1931e-02, PNorm = 44.6820, GNorm = 1.2617, lr_0 = 2.2171e-04
Validation rmse = 0.095219
Validation r2 = 0.516683
Validation mse = 0.009067
Epoch 38
Loss = 6.2223e-02, PNorm = 44.6894, GNorm = 0.8909, lr_0 = 2.1640e-04
Loss = 6.2131e-02, PNorm = 44.6979, GNorm = 2.3616, lr_0 = 2.1168e-04
Validation rmse = 0.105632
Validation r2 = 0.405189
Validation mse = 0.011158
Epoch 39
Loss = 6.8835e-02, PNorm = 44.7055, GNorm = 1.4221, lr_0 = 2.0706e-04
Loss = 5.5118e-02, PNorm = 44.7113, GNorm = 0.3963, lr_0 = 2.0254e-04
Loss = 6.6388e-02, PNorm = 44.7119, GNorm = 0.7635, lr_0 = 2.0209e-04
Validation rmse = 0.078525
Validation r2 = 0.671300
Validation mse = 0.006166
Epoch 40
Loss = 6.0178e-02, PNorm = 44.7198, GNorm = 1.8496, lr_0 = 1.9769e-04
Validation rmse = 0.098790
Validation r2 = 0.479746
Validation mse = 0.009760
Epoch 41
Loss = 6.1914e-02, PNorm = 44.7264, GNorm = 0.6115, lr_0 = 1.9337e-04
Loss = 6.5218e-02, PNorm = 44.7335, GNorm = 1.4390, lr_0 = 1.8916e-04
Validation rmse = 0.110735
Validation r2 = 0.346336
Validation mse = 0.012262
Epoch 42
Loss = 6.8888e-02, PNorm = 44.7401, GNorm = 0.7797, lr_0 = 1.8462e-04
Loss = 6.0576e-02, PNorm = 44.7460, GNorm = 1.1976, lr_0 = 1.8059e-04
Validation rmse = 0.104175
Validation r2 = 0.421481
Validation mse = 0.010853
Epoch 43
Loss = 5.6676e-02, PNorm = 44.7514, GNorm = 0.7299, lr_0 = 1.7666e-04
Loss = 6.0249e-02, PNorm = 44.7569, GNorm = 0.9184, lr_0 = 1.7280e-04
Validation rmse = 0.094655
Validation r2 = 0.522393
Validation mse = 0.008960
Epoch 44
Loss = 5.6995e-02, PNorm = 44.7640, GNorm = 0.9650, lr_0 = 1.6866e-04
Loss = 5.9509e-02, PNorm = 44.7706, GNorm = 1.8005, lr_0 = 1.6498e-04
Validation rmse = 0.099065
Validation r2 = 0.476844
Validation mse = 0.009814
Epoch 45
Loss = 5.0839e-02, PNorm = 44.7756, GNorm = 1.9790, lr_0 = 1.6138e-04
Loss = 5.6821e-02, PNorm = 44.7807, GNorm = 0.9403, lr_0 = 1.5786e-04
Validation rmse = 0.099638
Validation r2 = 0.470781
Validation mse = 0.009928
Epoch 46
Loss = 5.4962e-02, PNorm = 44.7870, GNorm = 0.8088, lr_0 = 1.5408e-04
Loss = 5.7170e-02, PNorm = 44.7916, GNorm = 1.6584, lr_0 = 1.5072e-04
Validation rmse = 0.096128
Validation r2 = 0.507413
Validation mse = 0.009241
Epoch 47
Loss = 5.4833e-02, PNorm = 44.7964, GNorm = 1.6419, lr_0 = 1.4743e-04
Validation rmse = 0.106463
Validation r2 = 0.395800
Validation mse = 0.011334
Epoch 48
Loss = 4.7829e-02, PNorm = 44.8020, GNorm = 2.3161, lr_0 = 1.4390e-04
Loss = 5.2498e-02, PNorm = 44.8066, GNorm = 1.0938, lr_0 = 1.4076e-04
Validation rmse = 0.098786
Validation r2 = 0.479793
Validation mse = 0.009759
Epoch 49
Loss = 4.9067e-02, PNorm = 44.8107, GNorm = 1.1300, lr_0 = 1.3769e-04
Loss = 5.0440e-02, PNorm = 44.8156, GNorm = 1.1291, lr_0 = 1.3468e-04
Validation rmse = 0.099223
Validation r2 = 0.475182
Validation mse = 0.009845
Epoch 50
Loss = 5.8937e-02, PNorm = 44.8200, GNorm = 1.1443, lr_0 = 1.3174e-04
Loss = 5.0514e-02, PNorm = 44.8249, GNorm = 2.1547, lr_0 = 1.2887e-04
Validation rmse = 0.103651
Validation r2 = 0.427295
Validation mse = 0.010743
Epoch 51
Loss = 5.3968e-02, PNorm = 44.8290, GNorm = 0.5272, lr_0 = 1.2578e-04
Loss = 4.9808e-02, PNorm = 44.8332, GNorm = 0.5968, lr_0 = 1.2304e-04
Validation rmse = 0.096253
Validation r2 = 0.506131
Validation mse = 0.009265
Epoch 52
Loss = 5.2345e-02, PNorm = 44.8363, GNorm = 0.5677, lr_0 = 1.2035e-04
Loss = 4.8867e-02, PNorm = 44.8401, GNorm = 0.7388, lr_0 = 1.1773e-04
Validation rmse = 0.095539
Validation r2 = 0.513422
Validation mse = 0.009128
Epoch 53
Loss = 4.8035e-02, PNorm = 44.8435, GNorm = 2.8325, lr_0 = 1.1491e-04
Loss = 5.7988e-02, PNorm = 44.8474, GNorm = 0.7780, lr_0 = 1.1240e-04
Validation rmse = 0.097024
Validation r2 = 0.498179
Validation mse = 0.009414
Epoch 54
Loss = 4.6533e-02, PNorm = 44.8513, GNorm = 0.4891, lr_0 = 1.0995e-04
Validation rmse = 0.106362
Validation r2 = 0.396936
Validation mse = 0.011313
Epoch 55
Loss = 4.0485e-02, PNorm = 44.8552, GNorm = 1.8816, lr_0 = 1.0731e-04
Loss = 5.1768e-02, PNorm = 44.8587, GNorm = 1.0643, lr_0 = 1.0497e-04
Validation rmse = 0.097474
Validation r2 = 0.493517
Validation mse = 0.009501
Epoch 56
Loss = 5.8111e-02, PNorm = 44.8623, GNorm = 1.0178, lr_0 = 1.0268e-04
Loss = 4.0394e-02, PNorm = 44.8658, GNorm = 0.5697, lr_0 = 1.0044e-04
Validation rmse = 0.109080
Validation r2 = 0.365723
Validation mse = 0.011899
Epoch 57
Loss = 3.9113e-02, PNorm = 44.8694, GNorm = 0.7100, lr_0 = 1.0000e-04
Loss = 5.0091e-02, PNorm = 44.8722, GNorm = 1.0244, lr_0 = 1.0000e-04
Validation rmse = 0.101705
Validation r2 = 0.448593
Validation mse = 0.010344
Epoch 58
Loss = 3.8896e-02, PNorm = 44.8755, GNorm = 0.4861, lr_0 = 1.0000e-04
Loss = 5.0804e-02, PNorm = 44.8786, GNorm = 0.7482, lr_0 = 1.0000e-04
Validation rmse = 0.103135
Validation r2 = 0.432974
Validation mse = 0.010637
Epoch 59
Loss = 5.1351e-02, PNorm = 44.8825, GNorm = 0.8569, lr_0 = 1.0000e-04
Loss = 4.1720e-02, PNorm = 44.8860, GNorm = 0.5677, lr_0 = 1.0000e-04
Validation rmse = 0.103940
Validation r2 = 0.424090
Validation mse = 0.010804
Model 0 best validation rmse = 0.060305 on epoch 15
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.285971
Model 0 test r2 = -1.074407
Model 0 test mse = 0.081780
Ensemble test rmse = 0.285971
Ensemble test r2 = -1.074407
Ensemble test mse = 0.081780
Fold 4
Splitting data with seed 4
Total size = 936 | train size = 926 | val size = 10 | test size = 96
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.0721e-01, PNorm = 43.2649, GNorm = 7.2929, lr_0 = 3.7500e-04
Validation rmse = 0.322246
Validation r2 = -0.093167
Validation mse = 0.103842
Epoch 1
Loss = 7.5861e-01, PNorm = 43.2904, GNorm = 12.2514, lr_0 = 6.5000e-04
Loss = 8.1746e-01, PNorm = 43.3273, GNorm = 6.3964, lr_0 = 9.0000e-04
Validation rmse = 0.284564
Validation r2 = 0.147543
Validation mse = 0.080977
Epoch 2
Loss = 5.4869e-01, PNorm = 43.3984, GNorm = 2.0964, lr_0 = 9.8685e-04
Loss = 5.2114e-01, PNorm = 43.4838, GNorm = 5.7196, lr_0 = 9.6533e-04
Validation rmse = 0.238143
Validation r2 = 0.402984
Validation mse = 0.056712
Epoch 3
Loss = 4.9396e-01, PNorm = 43.5610, GNorm = 8.1706, lr_0 = 9.4219e-04
Loss = 3.6986e-01, PNorm = 43.6281, GNorm = 5.4047, lr_0 = 9.2164e-04
Validation rmse = 0.231976
Validation r2 = 0.433502
Validation mse = 0.053813
Epoch 4
Loss = 3.1629e-01, PNorm = 43.6840, GNorm = 1.5521, lr_0 = 9.0153e-04
Loss = 2.6276e-01, PNorm = 43.7352, GNorm = 3.1702, lr_0 = 8.8187e-04
Validation rmse = 0.208613
Validation r2 = 0.541862
Validation mse = 0.043520
Epoch 5
Loss = 1.8151e-01, PNorm = 43.7822, GNorm = 1.2087, lr_0 = 8.6073e-04
Loss = 2.4760e-01, PNorm = 43.8146, GNorm = 3.5714, lr_0 = 8.4195e-04
Validation rmse = 0.213329
Validation r2 = 0.520917
Validation mse = 0.045509
Epoch 6
Loss = 2.0968e-01, PNorm = 43.8509, GNorm = 3.4367, lr_0 = 8.2359e-04
Validation rmse = 0.190561
Validation r2 = 0.617720
Validation mse = 0.036314
Epoch 7
Loss = 1.8186e-01, PNorm = 43.8908, GNorm = 3.6011, lr_0 = 8.0385e-04
Loss = 2.0691e-01, PNorm = 43.9284, GNorm = 3.9680, lr_0 = 7.8631e-04
Validation rmse = 0.186890
Validation r2 = 0.632307
Validation mse = 0.034928
Epoch 8
Loss = 1.2639e-01, PNorm = 43.9610, GNorm = 0.6171, lr_0 = 7.6916e-04
Loss = 1.6223e-01, PNorm = 43.9920, GNorm = 1.7029, lr_0 = 7.5238e-04
Validation rmse = 0.216664
Validation r2 = 0.505821
Validation mse = 0.046943
Epoch 9
Loss = 1.2607e-01, PNorm = 44.0169, GNorm = 1.4621, lr_0 = 7.3435e-04
Loss = 1.5318e-01, PNorm = 44.0433, GNorm = 1.3419, lr_0 = 7.1833e-04
Validation rmse = 0.214028
Validation r2 = 0.517773
Validation mse = 0.045808
Epoch 10
Loss = 1.3835e-01, PNorm = 44.0631, GNorm = 1.0816, lr_0 = 7.0266e-04
Loss = 1.3012e-01, PNorm = 44.0847, GNorm = 0.8457, lr_0 = 6.8733e-04
Validation rmse = 0.176101
Validation r2 = 0.673537
Validation mse = 0.031012
Epoch 11
Loss = 1.3384e-01, PNorm = 44.1099, GNorm = 3.9477, lr_0 = 6.7085e-04
Loss = 1.3518e-01, PNorm = 44.1312, GNorm = 1.3944, lr_0 = 6.5622e-04
Validation rmse = 0.163865
Validation r2 = 0.717327
Validation mse = 0.026852
Epoch 12
Loss = 9.5798e-02, PNorm = 44.1496, GNorm = 2.1732, lr_0 = 6.4191e-04
Loss = 1.3096e-01, PNorm = 44.1712, GNorm = 1.4287, lr_0 = 6.2790e-04
Loss = 1.8717e-01, PNorm = 44.1732, GNorm = 3.4585, lr_0 = 6.2652e-04
Validation rmse = 0.182928
Validation r2 = 0.647734
Validation mse = 0.033463
Epoch 13
Loss = 1.0112e-01, PNorm = 44.1960, GNorm = 0.6371, lr_0 = 6.1285e-04
Validation rmse = 0.217864
Validation r2 = 0.500333
Validation mse = 0.047465
Epoch 14
Loss = 9.2447e-02, PNorm = 44.2098, GNorm = 1.6846, lr_0 = 5.9948e-04
Loss = 1.1885e-01, PNorm = 44.2272, GNorm = 0.8672, lr_0 = 5.8641e-04
Validation rmse = 0.137634
Validation r2 = 0.800582
Validation mse = 0.018943
Epoch 15
Loss = 1.0697e-01, PNorm = 44.2500, GNorm = 0.6005, lr_0 = 5.7235e-04
Loss = 1.0556e-01, PNorm = 44.2664, GNorm = 1.4413, lr_0 = 5.5987e-04
Validation rmse = 0.143658
Validation r2 = 0.782745
Validation mse = 0.020638
Epoch 16
Loss = 1.1311e-01, PNorm = 44.2828, GNorm = 3.1290, lr_0 = 5.4765e-04
Loss = 1.1115e-01, PNorm = 44.2980, GNorm = 1.7298, lr_0 = 5.3571e-04
Validation rmse = 0.190777
Validation r2 = 0.616853
Validation mse = 0.036396
Epoch 17
Loss = 1.0392e-01, PNorm = 44.3220, GNorm = 0.3789, lr_0 = 5.2287e-04
Loss = 1.0009e-01, PNorm = 44.3373, GNorm = 1.6076, lr_0 = 5.1146e-04
Validation rmse = 0.158331
Validation r2 = 0.736098
Validation mse = 0.025069
Epoch 18
Loss = 9.9907e-02, PNorm = 44.3491, GNorm = 0.9685, lr_0 = 5.0030e-04
Loss = 9.3444e-02, PNorm = 44.3645, GNorm = 0.5670, lr_0 = 4.8939e-04
Validation rmse = 0.181293
Validation r2 = 0.654001
Validation mse = 0.032867
Epoch 19
Loss = 9.9068e-02, PNorm = 44.3831, GNorm = 1.1170, lr_0 = 4.7766e-04
Loss = 9.6065e-02, PNorm = 44.3953, GNorm = 0.8781, lr_0 = 4.6724e-04
Validation rmse = 0.169763
Validation r2 = 0.696613
Validation mse = 0.028819
Epoch 20
Loss = 8.5967e-02, PNorm = 44.4158, GNorm = 1.3912, lr_0 = 4.5705e-04
Validation rmse = 0.203606
Validation r2 = 0.563594
Validation mse = 0.041455
Epoch 21
Loss = 9.3142e-02, PNorm = 44.4292, GNorm = 0.8772, lr_0 = 4.4609e-04
Loss = 8.7161e-02, PNorm = 44.4419, GNorm = 0.9321, lr_0 = 4.3636e-04
Validation rmse = 0.153719
Validation r2 = 0.751249
Validation mse = 0.023629
Epoch 22
Loss = 9.5493e-02, PNorm = 44.4569, GNorm = 1.2340, lr_0 = 4.2684e-04
Loss = 8.5246e-02, PNorm = 44.4718, GNorm = 0.7941, lr_0 = 4.1753e-04
Validation rmse = 0.206365
Validation r2 = 0.551683
Validation mse = 0.042587
Epoch 23
Loss = 7.9543e-02, PNorm = 44.4846, GNorm = 1.5193, lr_0 = 4.0752e-04
Loss = 8.8571e-02, PNorm = 44.4992, GNorm = 0.9072, lr_0 = 3.9863e-04
Validation rmse = 0.168797
Validation r2 = 0.700054
Validation mse = 0.028493
Epoch 24
Loss = 8.5658e-02, PNorm = 44.5115, GNorm = 2.3061, lr_0 = 3.8994e-04
Loss = 9.6028e-02, PNorm = 44.5247, GNorm = 1.5307, lr_0 = 3.8143e-04
Validation rmse = 0.159848
Validation r2 = 0.731015
Validation mse = 0.025551
Epoch 25
Loss = 9.0739e-02, PNorm = 44.5368, GNorm = 2.1771, lr_0 = 3.7311e-04
Loss = 8.6970e-02, PNorm = 44.5511, GNorm = 1.0780, lr_0 = 3.6497e-04
Validation rmse = 0.170184
Validation r2 = 0.695105
Validation mse = 0.028963
Epoch 26
Loss = 7.9041e-02, PNorm = 44.5654, GNorm = 1.5097, lr_0 = 3.5622e-04
Loss = 8.7961e-02, PNorm = 44.5763, GNorm = 1.2900, lr_0 = 3.4845e-04
Validation rmse = 0.180249
Validation r2 = 0.657976
Validation mse = 0.032490
Epoch 27
Loss = 8.4079e-02, PNorm = 44.5884, GNorm = 1.6733, lr_0 = 3.4085e-04
Validation rmse = 0.169944
Validation r2 = 0.695965
Validation mse = 0.028881
Epoch 28
Loss = 7.1974e-02, PNorm = 44.5993, GNorm = 1.1773, lr_0 = 3.3268e-04
Loss = 7.6641e-02, PNorm = 44.6095, GNorm = 0.8651, lr_0 = 3.2543e-04
Validation rmse = 0.193728
Validation r2 = 0.604910
Validation mse = 0.037530
Epoch 29
Loss = 7.5332e-02, PNorm = 44.6196, GNorm = 1.9533, lr_0 = 3.1833e-04
Loss = 8.7985e-02, PNorm = 44.6309, GNorm = 1.8245, lr_0 = 3.1138e-04
Validation rmse = 0.176002
Validation r2 = 0.673903
Validation mse = 0.030977
Epoch 30
Loss = 7.9266e-02, PNorm = 44.6440, GNorm = 1.3553, lr_0 = 3.0392e-04
Loss = 7.3501e-02, PNorm = 44.6548, GNorm = 0.9345, lr_0 = 2.9729e-04
Validation rmse = 0.161229
Validation r2 = 0.726347
Validation mse = 0.025995
Epoch 31
Loss = 6.7506e-02, PNorm = 44.6643, GNorm = 0.6711, lr_0 = 2.9080e-04
Loss = 7.1998e-02, PNorm = 44.6736, GNorm = 0.4518, lr_0 = 2.8446e-04
Validation rmse = 0.160118
Validation r2 = 0.730108
Validation mse = 0.025638
Epoch 32
Loss = 7.6263e-02, PNorm = 44.6856, GNorm = 1.9839, lr_0 = 2.7764e-04
Loss = 7.2033e-02, PNorm = 44.6942, GNorm = 0.6715, lr_0 = 2.7159e-04
Validation rmse = 0.188248
Validation r2 = 0.626944
Validation mse = 0.035437
Epoch 33
Loss = 6.0634e-02, PNorm = 44.7025, GNorm = 0.4715, lr_0 = 2.6566e-04
Validation rmse = 0.189990
Validation r2 = 0.620008
Validation mse = 0.036096
Epoch 34
Loss = 6.2830e-02, PNorm = 44.7123, GNorm = 0.7689, lr_0 = 2.5929e-04
Loss = 6.8700e-02, PNorm = 44.7207, GNorm = 0.6527, lr_0 = 2.5364e-04
Validation rmse = 0.182065
Validation r2 = 0.651049
Validation mse = 0.033148
Epoch 35
Loss = 5.4854e-02, PNorm = 44.7298, GNorm = 0.5010, lr_0 = 2.4811e-04
Loss = 6.5313e-02, PNorm = 44.7372, GNorm = 1.4848, lr_0 = 2.4269e-04
Validation rmse = 0.183168
Validation r2 = 0.646807
Validation mse = 0.033551
Epoch 36
Loss = 6.7869e-02, PNorm = 44.7467, GNorm = 0.5799, lr_0 = 2.3688e-04
Loss = 5.9553e-02, PNorm = 44.7547, GNorm = 0.8041, lr_0 = 2.3171e-04
Validation rmse = 0.182157
Validation r2 = 0.650697
Validation mse = 0.033181
Epoch 37
Loss = 6.1975e-02, PNorm = 44.7641, GNorm = 0.7771, lr_0 = 2.2665e-04
Loss = 6.2297e-02, PNorm = 44.7722, GNorm = 0.7666, lr_0 = 2.2171e-04
Validation rmse = 0.183918
Validation r2 = 0.643911
Validation mse = 0.033826
Epoch 38
Loss = 6.3996e-02, PNorm = 44.7799, GNorm = 1.3589, lr_0 = 2.1640e-04
Loss = 6.5620e-02, PNorm = 44.7878, GNorm = 1.5061, lr_0 = 2.1168e-04
Validation rmse = 0.157596
Validation r2 = 0.738542
Validation mse = 0.024836
Epoch 39
Loss = 6.1897e-02, PNorm = 44.7943, GNorm = 0.5590, lr_0 = 2.0706e-04
Loss = 6.1955e-02, PNorm = 44.8018, GNorm = 0.9307, lr_0 = 2.0254e-04
Loss = 7.1416e-02, PNorm = 44.8023, GNorm = 1.6805, lr_0 = 2.0209e-04
Validation rmse = 0.172957
Validation r2 = 0.685090
Validation mse = 0.029914
Epoch 40
Loss = 5.7659e-02, PNorm = 44.8094, GNorm = 0.8926, lr_0 = 1.9769e-04
Validation rmse = 0.166067
Validation r2 = 0.709679
Validation mse = 0.027578
Epoch 41
Loss = 6.7178e-02, PNorm = 44.8162, GNorm = 2.0513, lr_0 = 1.9337e-04
Loss = 6.4457e-02, PNorm = 44.8249, GNorm = 0.4397, lr_0 = 1.8916e-04
Validation rmse = 0.176772
Validation r2 = 0.671044
Validation mse = 0.031248
Epoch 42
Loss = 6.1781e-02, PNorm = 44.8318, GNorm = 0.7072, lr_0 = 1.8462e-04
Loss = 5.4566e-02, PNorm = 44.8383, GNorm = 0.5835, lr_0 = 1.8059e-04
Validation rmse = 0.160010
Validation r2 = 0.730470
Validation mse = 0.025603
Epoch 43
Loss = 4.9024e-02, PNorm = 44.8452, GNorm = 0.8930, lr_0 = 1.7666e-04
Loss = 6.6536e-02, PNorm = 44.8516, GNorm = 1.2819, lr_0 = 1.7280e-04
Validation rmse = 0.195109
Validation r2 = 0.599256
Validation mse = 0.038068
Epoch 44
Loss = 6.3587e-02, PNorm = 44.8594, GNorm = 1.3539, lr_0 = 1.6866e-04
Loss = 5.8312e-02, PNorm = 44.8653, GNorm = 2.7907, lr_0 = 1.6498e-04
Validation rmse = 0.186916
Validation r2 = 0.632205
Validation mse = 0.034938
Epoch 45
Loss = 6.3239e-02, PNorm = 44.8722, GNorm = 1.2261, lr_0 = 1.6138e-04
Loss = 5.9078e-02, PNorm = 44.8771, GNorm = 0.4779, lr_0 = 1.5786e-04
Validation rmse = 0.160297
Validation r2 = 0.729502
Validation mse = 0.025695
Epoch 46
Loss = 5.8092e-02, PNorm = 44.8839, GNorm = 1.0706, lr_0 = 1.5408e-04
Loss = 5.2081e-02, PNorm = 44.8895, GNorm = 0.4095, lr_0 = 1.5072e-04
Validation rmse = 0.165466
Validation r2 = 0.711777
Validation mse = 0.027379
Epoch 47
Loss = 4.9591e-02, PNorm = 44.8950, GNorm = 0.5816, lr_0 = 1.4743e-04
Validation rmse = 0.168861
Validation r2 = 0.699827
Validation mse = 0.028514
Epoch 48
Loss = 4.7550e-02, PNorm = 44.9012, GNorm = 1.0619, lr_0 = 1.4390e-04
Loss = 5.5270e-02, PNorm = 44.9067, GNorm = 1.1415, lr_0 = 1.4076e-04
Validation rmse = 0.162172
Validation r2 = 0.723136
Validation mse = 0.026300
Epoch 49
Loss = 4.5234e-02, PNorm = 44.9113, GNorm = 0.7323, lr_0 = 1.3769e-04
Loss = 5.4964e-02, PNorm = 44.9159, GNorm = 1.3072, lr_0 = 1.3468e-04
Validation rmse = 0.166740
Validation r2 = 0.707320
Validation mse = 0.027802
Epoch 50
Loss = 5.4257e-02, PNorm = 44.9219, GNorm = 0.5806, lr_0 = 1.3174e-04
Loss = 5.1750e-02, PNorm = 44.9268, GNorm = 0.7136, lr_0 = 1.2887e-04
Validation rmse = 0.176910
Validation r2 = 0.670531
Validation mse = 0.031297
Epoch 51
Loss = 4.6925e-02, PNorm = 44.9313, GNorm = 0.4022, lr_0 = 1.2578e-04
Loss = 5.2144e-02, PNorm = 44.9356, GNorm = 0.4600, lr_0 = 1.2304e-04
Validation rmse = 0.159281
Validation r2 = 0.732922
Validation mse = 0.025370
Epoch 52
Loss = 4.7610e-02, PNorm = 44.9403, GNorm = 0.4840, lr_0 = 1.2035e-04
Loss = 5.6871e-02, PNorm = 44.9447, GNorm = 1.0202, lr_0 = 1.1773e-04
Validation rmse = 0.162440
Validation r2 = 0.722224
Validation mse = 0.026387
Epoch 53
Loss = 5.2348e-02, PNorm = 44.9497, GNorm = 0.6709, lr_0 = 1.1491e-04
Loss = 4.9015e-02, PNorm = 44.9541, GNorm = 0.6826, lr_0 = 1.1240e-04
Validation rmse = 0.178215
Validation r2 = 0.665651
Validation mse = 0.031761
Epoch 54
Loss = 4.7727e-02, PNorm = 44.9576, GNorm = 1.2412, lr_0 = 1.0995e-04
Validation rmse = 0.165052
Validation r2 = 0.713218
Validation mse = 0.027242
Epoch 55
Loss = 4.5718e-02, PNorm = 44.9617, GNorm = 1.3158, lr_0 = 1.0731e-04
Loss = 5.0557e-02, PNorm = 44.9656, GNorm = 0.8963, lr_0 = 1.0497e-04
Validation rmse = 0.166485
Validation r2 = 0.708216
Validation mse = 0.027717
Epoch 56
Loss = 6.3492e-02, PNorm = 44.9701, GNorm = 1.3098, lr_0 = 1.0268e-04
Loss = 4.6257e-02, PNorm = 44.9739, GNorm = 0.9014, lr_0 = 1.0044e-04
Validation rmse = 0.168875
Validation r2 = 0.699777
Validation mse = 0.028519
Epoch 57
Loss = 5.3187e-02, PNorm = 44.9778, GNorm = 0.6923, lr_0 = 1.0000e-04
Loss = 4.9146e-02, PNorm = 44.9824, GNorm = 0.7659, lr_0 = 1.0000e-04
Validation rmse = 0.154090
Validation r2 = 0.750045
Validation mse = 0.023744
Epoch 58
Loss = 5.0393e-02, PNorm = 44.9857, GNorm = 0.7432, lr_0 = 1.0000e-04
Loss = 5.0003e-02, PNorm = 44.9890, GNorm = 1.9640, lr_0 = 1.0000e-04
Validation rmse = 0.175565
Validation r2 = 0.675519
Validation mse = 0.030823
Epoch 59
Loss = 5.2839e-02, PNorm = 44.9938, GNorm = 0.5929, lr_0 = 1.0000e-04
Loss = 5.0475e-02, PNorm = 44.9985, GNorm = 1.4417, lr_0 = 1.0000e-04
Validation rmse = 0.155555
Validation r2 = 0.745269
Validation mse = 0.024197
Model 0 best validation rmse = 0.137634 on epoch 14
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.340739
Model 0 test r2 = -1.945043
Model 0 test mse = 0.116103
Ensemble test rmse = 0.340739
Ensemble test r2 = -1.945043
Ensemble test mse = 0.116103
Fold 5
Splitting data with seed 5
Total size = 936 | train size = 926 | val size = 10 | test size = 96
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 8.9384e-01, PNorm = 43.2625, GNorm = 2.0351, lr_0 = 3.7500e-04
Validation rmse = 0.119445
Validation r2 = 0.093169
Validation mse = 0.014267
Epoch 1
Loss = 8.5435e-01, PNorm = 43.2995, GNorm = 21.1998, lr_0 = 6.5000e-04
Loss = 7.1954e-01, PNorm = 43.3335, GNorm = 1.5795, lr_0 = 9.0000e-04
Validation rmse = 0.131079
Validation r2 = -0.092075
Validation mse = 0.017182
Epoch 2
Loss = 4.9182e-01, PNorm = 43.4065, GNorm = 11.0905, lr_0 = 9.8685e-04
Loss = 4.4765e-01, PNorm = 43.4757, GNorm = 3.2593, lr_0 = 9.6533e-04
Validation rmse = 0.106204
Validation r2 = 0.283085
Validation mse = 0.011279
Epoch 3
Loss = 3.5573e-01, PNorm = 43.5469, GNorm = 1.9182, lr_0 = 9.4219e-04
Loss = 2.5195e-01, PNorm = 43.6178, GNorm = 1.5556, lr_0 = 9.2164e-04
Validation rmse = 0.158738
Validation r2 = -0.601582
Validation mse = 0.025198
Epoch 4
Loss = 2.4649e-01, PNorm = 43.6705, GNorm = 1.3575, lr_0 = 9.0153e-04
Loss = 2.3016e-01, PNorm = 43.7177, GNorm = 6.6188, lr_0 = 8.8187e-04
Validation rmse = 0.107203
Validation r2 = 0.269539
Validation mse = 0.011492
Epoch 5
Loss = 2.1751e-01, PNorm = 43.7688, GNorm = 2.8431, lr_0 = 8.6073e-04
Loss = 2.2033e-01, PNorm = 43.8112, GNorm = 5.2723, lr_0 = 8.4195e-04
Validation rmse = 0.121575
Validation r2 = 0.060551
Validation mse = 0.014780
Epoch 6
Loss = 1.8832e-01, PNorm = 43.8492, GNorm = 5.0656, lr_0 = 8.2359e-04
Validation rmse = 0.104037
Validation r2 = 0.312039
Validation mse = 0.010824
Epoch 7
Loss = 1.6457e-01, PNorm = 43.8862, GNorm = 1.0888, lr_0 = 8.0385e-04
Loss = 1.6414e-01, PNorm = 43.9146, GNorm = 1.1502, lr_0 = 7.8631e-04
Validation rmse = 0.134297
Validation r2 = -0.146355
Validation mse = 0.018036
Epoch 8
Loss = 2.2268e-01, PNorm = 43.9435, GNorm = 5.3941, lr_0 = 7.6916e-04
Loss = 1.4560e-01, PNorm = 43.9729, GNorm = 1.3556, lr_0 = 7.5238e-04
Validation rmse = 0.100015
Validation r2 = 0.364203
Validation mse = 0.010003
Epoch 9
Loss = 1.3571e-01, PNorm = 44.0020, GNorm = 3.0003, lr_0 = 7.3435e-04
Loss = 1.3656e-01, PNorm = 44.0249, GNorm = 1.8834, lr_0 = 7.1833e-04
Validation rmse = 0.119118
Validation r2 = 0.098134
Validation mse = 0.014189
Epoch 10
Loss = 1.2178e-01, PNorm = 44.0469, GNorm = 0.4527, lr_0 = 7.0266e-04
Loss = 1.2487e-01, PNorm = 44.0698, GNorm = 1.0332, lr_0 = 6.8733e-04
Validation rmse = 0.120353
Validation r2 = 0.079340
Validation mse = 0.014485
Epoch 11
Loss = 9.4656e-02, PNorm = 44.0924, GNorm = 1.2029, lr_0 = 6.7085e-04
Loss = 1.5571e-01, PNorm = 44.1142, GNorm = 0.9024, lr_0 = 6.5622e-04
Validation rmse = 0.144056
Validation r2 = -0.319017
Validation mse = 0.020752
Epoch 12
Loss = 1.2022e-01, PNorm = 44.1349, GNorm = 2.5868, lr_0 = 6.4191e-04
Loss = 1.2564e-01, PNorm = 44.1537, GNorm = 1.1403, lr_0 = 6.2790e-04
Loss = 1.1024e-01, PNorm = 44.1559, GNorm = 1.0351, lr_0 = 6.2652e-04
Validation rmse = 0.140212
Validation r2 = -0.249560
Validation mse = 0.019659
Epoch 13
Loss = 1.2241e-01, PNorm = 44.1792, GNorm = 0.9975, lr_0 = 6.1285e-04
Validation rmse = 0.117986
Validation r2 = 0.115192
Validation mse = 0.013921
Epoch 14
Loss = 1.1171e-01, PNorm = 44.1978, GNorm = 2.4517, lr_0 = 5.9948e-04
Loss = 1.1079e-01, PNorm = 44.2175, GNorm = 1.6791, lr_0 = 5.8641e-04
Validation rmse = 0.105607
Validation r2 = 0.291115
Validation mse = 0.011153
Epoch 15
Loss = 9.9433e-02, PNorm = 44.2346, GNorm = 0.9893, lr_0 = 5.7235e-04
Loss = 1.0154e-01, PNorm = 44.2536, GNorm = 1.3539, lr_0 = 5.5987e-04
Validation rmse = 0.114422
Validation r2 = 0.167835
Validation mse = 0.013092
Epoch 16
Loss = 7.9252e-02, PNorm = 44.2712, GNorm = 2.3289, lr_0 = 5.4765e-04
Loss = 1.1082e-01, PNorm = 44.2878, GNorm = 2.4774, lr_0 = 5.3571e-04
Validation rmse = 0.110646
Validation r2 = 0.221853
Validation mse = 0.012243
Epoch 17
Loss = 8.8889e-02, PNorm = 44.3042, GNorm = 1.1748, lr_0 = 5.2287e-04
Loss = 9.7522e-02, PNorm = 44.3210, GNorm = 1.5870, lr_0 = 5.1146e-04
Validation rmse = 0.107547
Validation r2 = 0.264839
Validation mse = 0.011566
Epoch 18
Loss = 9.9971e-02, PNorm = 44.3423, GNorm = 1.2464, lr_0 = 5.0030e-04
Loss = 9.2429e-02, PNorm = 44.3572, GNorm = 0.7794, lr_0 = 4.8939e-04
Validation rmse = 0.110322
Validation r2 = 0.226412
Validation mse = 0.012171
Epoch 19
Loss = 1.2804e-01, PNorm = 44.3736, GNorm = 2.8190, lr_0 = 4.7766e-04
Loss = 1.2667e-01, PNorm = 44.3907, GNorm = 3.0465, lr_0 = 4.6724e-04
Validation rmse = 0.110893
Validation r2 = 0.218385
Validation mse = 0.012297
Epoch 20
Loss = 1.0820e-01, PNorm = 44.4120, GNorm = 4.3413, lr_0 = 4.5705e-04
Validation rmse = 0.127715
Validation r2 = -0.036749
Validation mse = 0.016311
Epoch 21
Loss = 1.0046e-01, PNorm = 44.4278, GNorm = 1.1796, lr_0 = 4.4609e-04
Loss = 9.1356e-02, PNorm = 44.4443, GNorm = 1.7172, lr_0 = 4.3636e-04
Validation rmse = 0.119087
Validation r2 = 0.098611
Validation mse = 0.014182
Epoch 22
Loss = 6.9879e-02, PNorm = 44.4580, GNorm = 2.2353, lr_0 = 4.2684e-04
Loss = 7.7382e-02, PNorm = 44.4736, GNorm = 2.2159, lr_0 = 4.1753e-04
Validation rmse = 0.112294
Validation r2 = 0.198499
Validation mse = 0.012610
Epoch 23
Loss = 7.8608e-02, PNorm = 44.4845, GNorm = 1.1233, lr_0 = 4.0752e-04
Loss = 7.9290e-02, PNorm = 44.4980, GNorm = 0.7557, lr_0 = 3.9863e-04
Validation rmse = 0.121397
Validation r2 = 0.063290
Validation mse = 0.014737
Epoch 24
Loss = 6.6804e-02, PNorm = 44.5122, GNorm = 0.8472, lr_0 = 3.8994e-04
Loss = 8.1621e-02, PNorm = 44.5221, GNorm = 1.3351, lr_0 = 3.8143e-04
Validation rmse = 0.121273
Validation r2 = 0.065211
Validation mse = 0.014707
Epoch 25
Loss = 6.3713e-02, PNorm = 44.5367, GNorm = 0.7156, lr_0 = 3.7311e-04
Loss = 8.5863e-02, PNorm = 44.5478, GNorm = 2.0853, lr_0 = 3.6497e-04
Validation rmse = 0.104902
Validation r2 = 0.300554
Validation mse = 0.011004
Epoch 26
Loss = 6.8212e-02, PNorm = 44.5602, GNorm = 0.6998, lr_0 = 3.5622e-04
Loss = 8.4405e-02, PNorm = 44.5733, GNorm = 1.5825, lr_0 = 3.4845e-04
Validation rmse = 0.121320
Validation r2 = 0.064481
Validation mse = 0.014719
Epoch 27
Loss = 6.4389e-02, PNorm = 44.5838, GNorm = 0.5997, lr_0 = 3.4085e-04
Validation rmse = 0.123236
Validation r2 = 0.034699
Validation mse = 0.015187
Epoch 28
Loss = 5.5678e-02, PNorm = 44.5950, GNorm = 0.8395, lr_0 = 3.3268e-04
Loss = 6.7835e-02, PNorm = 44.6028, GNorm = 0.8263, lr_0 = 3.2543e-04
Validation rmse = 0.108551
Validation r2 = 0.251040
Validation mse = 0.011783
Epoch 29
Loss = 5.4589e-02, PNorm = 44.6131, GNorm = 1.3697, lr_0 = 3.1833e-04
Loss = 7.6125e-02, PNorm = 44.6228, GNorm = 0.8234, lr_0 = 3.1138e-04
Validation rmse = 0.144600
Validation r2 = -0.328998
Validation mse = 0.020909
Epoch 30
Loss = 6.5758e-02, PNorm = 44.6354, GNorm = 1.7690, lr_0 = 3.0392e-04
Loss = 6.7907e-02, PNorm = 44.6473, GNorm = 0.4618, lr_0 = 2.9729e-04
Validation rmse = 0.102157
Validation r2 = 0.336681
Validation mse = 0.010436
Epoch 31
Loss = 6.9008e-02, PNorm = 44.6577, GNorm = 1.3343, lr_0 = 2.9080e-04
Loss = 5.8661e-02, PNorm = 44.6673, GNorm = 1.7198, lr_0 = 2.8446e-04
Validation rmse = 0.127477
Validation r2 = -0.032884
Validation mse = 0.016250
Epoch 32
Loss = 7.1319e-02, PNorm = 44.6791, GNorm = 1.0892, lr_0 = 2.7764e-04
Loss = 6.3864e-02, PNorm = 44.6873, GNorm = 0.6833, lr_0 = 2.7159e-04
Validation rmse = 0.106502
Validation r2 = 0.279049
Validation mse = 0.011343
Epoch 33
Loss = 6.0613e-02, PNorm = 44.6999, GNorm = 1.6943, lr_0 = 2.6566e-04
Validation rmse = 0.121759
Validation r2 = 0.057695
Validation mse = 0.014825
Epoch 34
Loss = 5.7459e-02, PNorm = 44.7097, GNorm = 2.1563, lr_0 = 2.5929e-04
Loss = 6.0980e-02, PNorm = 44.7179, GNorm = 0.6622, lr_0 = 2.5364e-04
Validation rmse = 0.121049
Validation r2 = 0.068663
Validation mse = 0.014653
Epoch 35
Loss = 5.5532e-02, PNorm = 44.7263, GNorm = 1.1667, lr_0 = 2.4811e-04
Loss = 6.1677e-02, PNorm = 44.7332, GNorm = 1.6906, lr_0 = 2.4269e-04
Validation rmse = 0.143865
Validation r2 = -0.315513
Validation mse = 0.020697
Epoch 36
Loss = 6.4218e-02, PNorm = 44.7415, GNorm = 2.2451, lr_0 = 2.3688e-04
Loss = 6.2254e-02, PNorm = 44.7509, GNorm = 1.3876, lr_0 = 2.3171e-04
Validation rmse = 0.113043
Validation r2 = 0.187784
Validation mse = 0.012779
Epoch 37
Loss = 6.9818e-02, PNorm = 44.7592, GNorm = 1.4434, lr_0 = 2.2665e-04
Loss = 6.1142e-02, PNorm = 44.7683, GNorm = 0.8297, lr_0 = 2.2171e-04
Validation rmse = 0.117491
Validation r2 = 0.122607
Validation mse = 0.013804
Epoch 38
Loss = 5.2677e-02, PNorm = 44.7759, GNorm = 1.5705, lr_0 = 2.1640e-04
Loss = 6.1939e-02, PNorm = 44.7823, GNorm = 0.6605, lr_0 = 2.1168e-04
Validation rmse = 0.102973
Validation r2 = 0.326036
Validation mse = 0.010604
Epoch 39
Loss = 5.0976e-02, PNorm = 44.7904, GNorm = 0.7850, lr_0 = 2.0706e-04
Loss = 6.1992e-02, PNorm = 44.7975, GNorm = 0.5852, lr_0 = 2.0254e-04
Loss = 5.5233e-02, PNorm = 44.7983, GNorm = 1.3481, lr_0 = 2.0209e-04
Validation rmse = 0.095369
Validation r2 = 0.421903
Validation mse = 0.009095
Epoch 40
Loss = 6.2200e-02, PNorm = 44.8061, GNorm = 2.2344, lr_0 = 1.9769e-04
Validation rmse = 0.103779
Validation r2 = 0.315449
Validation mse = 0.010770
Epoch 41
Loss = 5.9792e-02, PNorm = 44.8128, GNorm = 1.8438, lr_0 = 1.9337e-04
Loss = 5.8938e-02, PNorm = 44.8202, GNorm = 0.4697, lr_0 = 1.8916e-04
Validation rmse = 0.104078
Validation r2 = 0.311495
Validation mse = 0.010832
Epoch 42
Loss = 6.2938e-02, PNorm = 44.8283, GNorm = 1.1454, lr_0 = 1.8462e-04
Loss = 5.4037e-02, PNorm = 44.8344, GNorm = 0.9213, lr_0 = 1.8059e-04
Validation rmse = 0.108490
Validation r2 = 0.251885
Validation mse = 0.011770
Epoch 43
Loss = 5.4794e-02, PNorm = 44.8405, GNorm = 0.8781, lr_0 = 1.7666e-04
Loss = 5.3986e-02, PNorm = 44.8467, GNorm = 1.0810, lr_0 = 1.7280e-04
Validation rmse = 0.106558
Validation r2 = 0.278302
Validation mse = 0.011355
Epoch 44
Loss = 5.7250e-02, PNorm = 44.8525, GNorm = 1.6781, lr_0 = 1.6866e-04
Loss = 5.0513e-02, PNorm = 44.8585, GNorm = 1.3268, lr_0 = 1.6498e-04
Validation rmse = 0.111135
Validation r2 = 0.214970
Validation mse = 0.012351
Epoch 45
Loss = 5.5863e-02, PNorm = 44.8646, GNorm = 1.2101, lr_0 = 1.6138e-04
Loss = 4.7779e-02, PNorm = 44.8702, GNorm = 0.5602, lr_0 = 1.5786e-04
Validation rmse = 0.107394
Validation r2 = 0.266924
Validation mse = 0.011534
Epoch 46
Loss = 5.1258e-02, PNorm = 44.8762, GNorm = 1.3045, lr_0 = 1.5408e-04
Loss = 5.0198e-02, PNorm = 44.8821, GNorm = 0.9643, lr_0 = 1.5072e-04
Validation rmse = 0.107458
Validation r2 = 0.266056
Validation mse = 0.011547
Epoch 47
Loss = 4.3962e-02, PNorm = 44.8866, GNorm = 1.5095, lr_0 = 1.4743e-04
Validation rmse = 0.095124
Validation r2 = 0.424863
Validation mse = 0.009049
Epoch 48
Loss = 6.2040e-02, PNorm = 44.8924, GNorm = 1.4350, lr_0 = 1.4390e-04
Loss = 4.8139e-02, PNorm = 44.8985, GNorm = 0.9686, lr_0 = 1.4076e-04
Validation rmse = 0.099540
Validation r2 = 0.370234
Validation mse = 0.009908
Epoch 49
Loss = 5.4415e-02, PNorm = 44.9024, GNorm = 1.2185, lr_0 = 1.3769e-04
Loss = 4.5537e-02, PNorm = 44.9074, GNorm = 1.2262, lr_0 = 1.3468e-04
Validation rmse = 0.107893
Validation r2 = 0.260099
Validation mse = 0.011641
Epoch 50
Loss = 5.6795e-02, PNorm = 44.9117, GNorm = 2.2701, lr_0 = 1.3174e-04
Loss = 5.0455e-02, PNorm = 44.9162, GNorm = 0.9673, lr_0 = 1.2887e-04
Validation rmse = 0.114327
Validation r2 = 0.169220
Validation mse = 0.013071
Epoch 51
Loss = 4.6455e-02, PNorm = 44.9207, GNorm = 0.7912, lr_0 = 1.2578e-04
Loss = 4.7987e-02, PNorm = 44.9257, GNorm = 0.6855, lr_0 = 1.2304e-04
Validation rmse = 0.117202
Validation r2 = 0.126916
Validation mse = 0.013736
Epoch 52
Loss = 3.9446e-02, PNorm = 44.9295, GNorm = 0.4933, lr_0 = 1.2035e-04
Loss = 4.7586e-02, PNorm = 44.9333, GNorm = 0.7938, lr_0 = 1.1773e-04
Validation rmse = 0.101974
Validation r2 = 0.339050
Validation mse = 0.010399
Epoch 53
Loss = 4.3125e-02, PNorm = 44.9379, GNorm = 1.2683, lr_0 = 1.1491e-04
Loss = 4.7223e-02, PNorm = 44.9410, GNorm = 1.3307, lr_0 = 1.1240e-04
Validation rmse = 0.102856
Validation r2 = 0.327575
Validation mse = 0.010579
Epoch 54
Loss = 4.2757e-02, PNorm = 44.9448, GNorm = 0.6824, lr_0 = 1.0995e-04
Validation rmse = 0.129240
Validation r2 = -0.061653
Validation mse = 0.016703
Epoch 55
Loss = 3.5864e-02, PNorm = 44.9496, GNorm = 2.1047, lr_0 = 1.0731e-04
Loss = 4.7197e-02, PNorm = 44.9527, GNorm = 1.7771, lr_0 = 1.0497e-04
Validation rmse = 0.098058
Validation r2 = 0.388841
Validation mse = 0.009615
Epoch 56
Loss = 3.6821e-02, PNorm = 44.9558, GNorm = 0.6544, lr_0 = 1.0268e-04
Loss = 4.5032e-02, PNorm = 44.9595, GNorm = 0.6035, lr_0 = 1.0044e-04
Validation rmse = 0.105637
Validation r2 = 0.290719
Validation mse = 0.011159
Epoch 57
Loss = 4.8422e-02, PNorm = 44.9628, GNorm = 0.7922, lr_0 = 1.0000e-04
Loss = 4.3884e-02, PNorm = 44.9667, GNorm = 0.8637, lr_0 = 1.0000e-04
Validation rmse = 0.112657
Validation r2 = 0.193316
Validation mse = 0.012692
Epoch 58
Loss = 3.4279e-02, PNorm = 44.9696, GNorm = 2.0121, lr_0 = 1.0000e-04
Loss = 4.7732e-02, PNorm = 44.9730, GNorm = 0.8337, lr_0 = 1.0000e-04
Validation rmse = 0.107409
Validation r2 = 0.266720
Validation mse = 0.011537
Epoch 59
Loss = 4.3786e-02, PNorm = 44.9765, GNorm = 1.1012, lr_0 = 1.0000e-04
Loss = 3.9051e-02, PNorm = 44.9803, GNorm = 0.4733, lr_0 = 1.0000e-04
Validation rmse = 0.105746
Validation r2 = 0.289258
Validation mse = 0.011182
Model 0 best validation rmse = 0.095124 on epoch 47
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.332534
Model 0 test r2 = -1.804917
Model 0 test mse = 0.110579
Ensemble test rmse = 0.332534
Ensemble test r2 = -1.804917
Ensemble test mse = 0.110579
Fold 6
Splitting data with seed 6
Total size = 936 | train size = 926 | val size = 10 | test size = 96
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.4709e-01, PNorm = 43.2630, GNorm = 7.0701, lr_0 = 3.7500e-04
Validation rmse = 0.304277
Validation r2 = -2.670307
Validation mse = 0.092585
Epoch 1
Loss = 8.9182e-01, PNorm = 43.2903, GNorm = 8.3631, lr_0 = 6.5000e-04
Loss = 6.1503e-01, PNorm = 43.3332, GNorm = 4.3632, lr_0 = 9.0000e-04
Validation rmse = 0.372657
Validation r2 = -4.505320
Validation mse = 0.138873
Epoch 2
Loss = 5.0249e-01, PNorm = 43.4006, GNorm = 3.0866, lr_0 = 9.8685e-04
Loss = 4.2407e-01, PNorm = 43.4824, GNorm = 5.9660, lr_0 = 9.6533e-04
Validation rmse = 0.233371
Validation r2 = -1.159018
Validation mse = 0.054462
Epoch 3
Loss = 2.5899e-01, PNorm = 43.5602, GNorm = 1.3030, lr_0 = 9.4219e-04
Loss = 2.4449e-01, PNorm = 43.6199, GNorm = 3.5663, lr_0 = 9.2164e-04
Validation rmse = 0.328782
Validation r2 = -3.285291
Validation mse = 0.108098
Epoch 4
Loss = 3.1270e-01, PNorm = 43.6697, GNorm = 5.8422, lr_0 = 9.0153e-04
Loss = 2.3836e-01, PNorm = 43.7191, GNorm = 1.3727, lr_0 = 8.8187e-04
Validation rmse = 0.223553
Validation r2 = -0.981186
Validation mse = 0.049976
Epoch 5
Loss = 2.0682e-01, PNorm = 43.7571, GNorm = 1.4016, lr_0 = 8.6073e-04
Loss = 2.2167e-01, PNorm = 43.7977, GNorm = 0.8204, lr_0 = 8.4195e-04
Validation rmse = 0.224253
Validation r2 = -0.993613
Validation mse = 0.050290
Epoch 6
Loss = 2.0326e-01, PNorm = 43.8316, GNorm = 1.8896, lr_0 = 8.2359e-04
Validation rmse = 0.167378
Validation r2 = -0.110609
Validation mse = 0.028015
Epoch 7
Loss = 1.5270e-01, PNorm = 43.8664, GNorm = 1.1006, lr_0 = 8.0385e-04
Loss = 1.7237e-01, PNorm = 43.8946, GNorm = 5.0189, lr_0 = 7.8631e-04
Validation rmse = 0.169856
Validation r2 = -0.143729
Validation mse = 0.028851
Epoch 8
Loss = 1.8087e-01, PNorm = 43.9196, GNorm = 2.4755, lr_0 = 7.6916e-04
Loss = 1.6284e-01, PNorm = 43.9469, GNorm = 1.0774, lr_0 = 7.5238e-04
Validation rmse = 0.128385
Validation r2 = 0.346579
Validation mse = 0.016483
Epoch 9
Loss = 1.6590e-01, PNorm = 43.9727, GNorm = 3.6382, lr_0 = 7.3435e-04
Loss = 1.5686e-01, PNorm = 43.9986, GNorm = 2.4950, lr_0 = 7.1833e-04
Validation rmse = 0.248143
Validation r2 = -1.440997
Validation mse = 0.061575
Epoch 10
Loss = 1.3938e-01, PNorm = 44.0252, GNorm = 0.8558, lr_0 = 7.0266e-04
Loss = 1.1353e-01, PNorm = 44.0469, GNorm = 0.8830, lr_0 = 6.8733e-04
Validation rmse = 0.200837
Validation r2 = -0.599011
Validation mse = 0.040336
Epoch 11
Loss = 1.0285e-01, PNorm = 44.0638, GNorm = 1.0164, lr_0 = 6.7085e-04
Loss = 1.2034e-01, PNorm = 44.0825, GNorm = 1.7104, lr_0 = 6.5622e-04
Validation rmse = 0.210933
Validation r2 = -0.763818
Validation mse = 0.044493
Epoch 12
Loss = 1.2528e-01, PNorm = 44.0989, GNorm = 2.0361, lr_0 = 6.4191e-04
Loss = 1.2598e-01, PNorm = 44.1141, GNorm = 3.7294, lr_0 = 6.2790e-04
Loss = 1.2438e-01, PNorm = 44.1168, GNorm = 2.8410, lr_0 = 6.2652e-04
Validation rmse = 0.184834
Validation r2 = -0.354333
Validation mse = 0.034163
Epoch 13
Loss = 1.4410e-01, PNorm = 44.1324, GNorm = 5.1075, lr_0 = 6.1285e-04
Validation rmse = 0.232156
Validation r2 = -1.136592
Validation mse = 0.053896
Epoch 14
Loss = 8.8295e-02, PNorm = 44.1500, GNorm = 1.8207, lr_0 = 5.9948e-04
Loss = 1.1105e-01, PNorm = 44.1680, GNorm = 1.0231, lr_0 = 5.8641e-04
Validation rmse = 0.175450
Validation r2 = -0.220316
Validation mse = 0.030783
Epoch 15
Loss = 1.0605e-01, PNorm = 44.1863, GNorm = 1.8923, lr_0 = 5.7235e-04
Loss = 1.1012e-01, PNorm = 44.2031, GNorm = 2.1202, lr_0 = 5.5987e-04
Validation rmse = 0.219159
Validation r2 = -0.904061
Validation mse = 0.048031
Epoch 16
Loss = 1.0359e-01, PNorm = 44.2167, GNorm = 1.4686, lr_0 = 5.4765e-04
Loss = 1.2123e-01, PNorm = 44.2337, GNorm = 1.2512, lr_0 = 5.3571e-04
Validation rmse = 0.218075
Validation r2 = -0.885268
Validation mse = 0.047556
Epoch 17
Loss = 9.2375e-02, PNorm = 44.2499, GNorm = 1.4276, lr_0 = 5.2287e-04
Loss = 9.7489e-02, PNorm = 44.2651, GNorm = 0.7052, lr_0 = 5.1146e-04
Validation rmse = 0.190375
Validation r2 = -0.436749
Validation mse = 0.036242
Epoch 18
Loss = 8.6490e-02, PNorm = 44.2794, GNorm = 0.4344, lr_0 = 5.0030e-04
Loss = 1.0284e-01, PNorm = 44.2904, GNorm = 1.4200, lr_0 = 4.8939e-04
Validation rmse = 0.206748
Validation r2 = -0.694510
Validation mse = 0.042745
Epoch 19
Loss = 9.5038e-02, PNorm = 44.3019, GNorm = 2.5484, lr_0 = 4.7766e-04
Loss = 9.2241e-02, PNorm = 44.3137, GNorm = 2.0112, lr_0 = 4.6724e-04
Validation rmse = 0.198334
Validation r2 = -0.559406
Validation mse = 0.039337
Epoch 20
Loss = 8.6130e-02, PNorm = 44.3264, GNorm = 0.7014, lr_0 = 4.5705e-04
Validation rmse = 0.185340
Validation r2 = -0.361762
Validation mse = 0.034351
Epoch 21
Loss = 6.5352e-02, PNorm = 44.3393, GNorm = 1.0855, lr_0 = 4.4609e-04
Loss = 8.8027e-02, PNorm = 44.3521, GNorm = 0.9646, lr_0 = 4.3636e-04
Validation rmse = 0.155485
Validation r2 = 0.041619
Validation mse = 0.024175
Epoch 22
Loss = 9.0680e-02, PNorm = 44.3623, GNorm = 1.0224, lr_0 = 4.2684e-04
Loss = 1.0005e-01, PNorm = 44.3728, GNorm = 3.7398, lr_0 = 4.1753e-04
Validation rmse = 0.211176
Validation r2 = -0.767883
Validation mse = 0.044595
Epoch 23
Loss = 7.5670e-02, PNorm = 44.3884, GNorm = 1.1802, lr_0 = 4.0752e-04
Loss = 8.5906e-02, PNorm = 44.4008, GNorm = 1.4909, lr_0 = 3.9863e-04
Validation rmse = 0.193097
Validation r2 = -0.478128
Validation mse = 0.037286
Epoch 24
Loss = 8.3009e-02, PNorm = 44.4126, GNorm = 0.8145, lr_0 = 3.8994e-04
Loss = 7.8661e-02, PNorm = 44.4258, GNorm = 1.7134, lr_0 = 3.8143e-04
Validation rmse = 0.185304
Validation r2 = -0.361232
Validation mse = 0.034338
Epoch 25
Loss = 8.2898e-02, PNorm = 44.4380, GNorm = 0.5650, lr_0 = 3.7311e-04
Loss = 6.5387e-02, PNorm = 44.4495, GNorm = 1.2325, lr_0 = 3.6497e-04
Validation rmse = 0.214371
Validation r2 = -0.821775
Validation mse = 0.045955
Epoch 26
Loss = 8.0364e-02, PNorm = 44.4615, GNorm = 0.5090, lr_0 = 3.5622e-04
Loss = 8.0332e-02, PNorm = 44.4719, GNorm = 0.8028, lr_0 = 3.4845e-04
Validation rmse = 0.168663
Validation r2 = -0.127728
Validation mse = 0.028447
Epoch 27
Loss = 7.0433e-02, PNorm = 44.4836, GNorm = 1.4972, lr_0 = 3.4085e-04
Validation rmse = 0.188413
Validation r2 = -0.407301
Validation mse = 0.035500
Epoch 28
Loss = 9.1913e-02, PNorm = 44.4935, GNorm = 1.7770, lr_0 = 3.3268e-04
Loss = 8.6285e-02, PNorm = 44.5053, GNorm = 3.9732, lr_0 = 3.2543e-04
Validation rmse = 0.196343
Validation r2 = -0.528249
Validation mse = 0.038551
Epoch 29
Loss = 6.7820e-02, PNorm = 44.5169, GNorm = 0.7317, lr_0 = 3.1833e-04
Loss = 7.7790e-02, PNorm = 44.5280, GNorm = 1.3029, lr_0 = 3.1138e-04
Validation rmse = 0.195699
Validation r2 = -0.518238
Validation mse = 0.038298
Epoch 30
Loss = 6.0512e-02, PNorm = 44.5373, GNorm = 0.5807, lr_0 = 3.0392e-04
Loss = 7.1905e-02, PNorm = 44.5474, GNorm = 1.8935, lr_0 = 2.9729e-04
Validation rmse = 0.205295
Validation r2 = -0.670782
Validation mse = 0.042146
Epoch 31
Loss = 6.6252e-02, PNorm = 44.5554, GNorm = 1.1902, lr_0 = 2.9080e-04
Loss = 7.3648e-02, PNorm = 44.5631, GNorm = 0.8215, lr_0 = 2.8446e-04
Validation rmse = 0.178501
Validation r2 = -0.263113
Validation mse = 0.031862
Epoch 32
Loss = 6.5626e-02, PNorm = 44.5727, GNorm = 0.9098, lr_0 = 2.7764e-04
Loss = 7.9700e-02, PNorm = 44.5797, GNorm = 1.9843, lr_0 = 2.7159e-04
Validation rmse = 0.192990
Validation r2 = -0.476492
Validation mse = 0.037245
Epoch 33
Loss = 6.4104e-02, PNorm = 44.5892, GNorm = 0.7284, lr_0 = 2.6566e-04
Validation rmse = 0.180690
Validation r2 = -0.294291
Validation mse = 0.032649
Epoch 34
Loss = 2.9875e-02, PNorm = 44.5990, GNorm = 0.8473, lr_0 = 2.5929e-04
Loss = 6.7394e-02, PNorm = 44.6061, GNorm = 0.8723, lr_0 = 2.5364e-04
Validation rmse = 0.189262
Validation r2 = -0.420007
Validation mse = 0.035820
Epoch 35
Loss = 4.8304e-02, PNorm = 44.6143, GNorm = 0.7342, lr_0 = 2.4811e-04
Loss = 6.4649e-02, PNorm = 44.6201, GNorm = 0.9135, lr_0 = 2.4269e-04
Validation rmse = 0.158755
Validation r2 = 0.000874
Validation mse = 0.025203
Epoch 36
Loss = 6.6901e-02, PNorm = 44.6274, GNorm = 1.0799, lr_0 = 2.3688e-04
Loss = 6.5036e-02, PNorm = 44.6352, GNorm = 2.9037, lr_0 = 2.3171e-04
Validation rmse = 0.165484
Validation r2 = -0.085618
Validation mse = 0.027385
Epoch 37
Loss = 5.9026e-02, PNorm = 44.6429, GNorm = 1.1707, lr_0 = 2.2665e-04
Loss = 6.8642e-02, PNorm = 44.6503, GNorm = 2.5536, lr_0 = 2.2171e-04
Validation rmse = 0.176152
Validation r2 = -0.230100
Validation mse = 0.031030
Epoch 38
Loss = 5.4925e-02, PNorm = 44.6591, GNorm = 0.7066, lr_0 = 2.1640e-04
Loss = 6.4392e-02, PNorm = 44.6658, GNorm = 1.0115, lr_0 = 2.1168e-04
Validation rmse = 0.201512
Validation r2 = -0.609773
Validation mse = 0.040607
Epoch 39
Loss = 6.0068e-02, PNorm = 44.6737, GNorm = 1.2292, lr_0 = 2.0706e-04
Loss = 6.1973e-02, PNorm = 44.6807, GNorm = 1.9030, lr_0 = 2.0254e-04
Loss = 4.6124e-02, PNorm = 44.6812, GNorm = 1.3721, lr_0 = 2.0209e-04
Validation rmse = 0.187366
Validation r2 = -0.391697
Validation mse = 0.035106
Epoch 40
Loss = 5.8820e-02, PNorm = 44.6873, GNorm = 0.7694, lr_0 = 1.9769e-04
Validation rmse = 0.199768
Validation r2 = -0.582027
Validation mse = 0.039907
Epoch 41
Loss = 4.0784e-02, PNorm = 44.6929, GNorm = 1.6370, lr_0 = 1.9337e-04
Loss = 5.4245e-02, PNorm = 44.7004, GNorm = 0.5157, lr_0 = 1.8916e-04
Validation rmse = 0.192811
Validation r2 = -0.473756
Validation mse = 0.037176
Epoch 42
Loss = 5.4554e-02, PNorm = 44.7084, GNorm = 1.8822, lr_0 = 1.8462e-04
Loss = 5.4635e-02, PNorm = 44.7153, GNorm = 0.5719, lr_0 = 1.8059e-04
Validation rmse = 0.186973
Validation r2 = -0.385868
Validation mse = 0.034959
Epoch 43
Loss = 4.5547e-02, PNorm = 44.7211, GNorm = 0.5874, lr_0 = 1.7666e-04
Loss = 5.6908e-02, PNorm = 44.7264, GNorm = 0.8569, lr_0 = 1.7280e-04
Validation rmse = 0.194565
Validation r2 = -0.500688
Validation mse = 0.037855
Epoch 44
Loss = 5.2787e-02, PNorm = 44.7331, GNorm = 1.7479, lr_0 = 1.6866e-04
Loss = 5.9899e-02, PNorm = 44.7382, GNorm = 0.5256, lr_0 = 1.6498e-04
Validation rmse = 0.184490
Validation r2 = -0.349300
Validation mse = 0.034037
Epoch 45
Loss = 5.8516e-02, PNorm = 44.7432, GNorm = 0.9095, lr_0 = 1.6138e-04
Loss = 5.4722e-02, PNorm = 44.7489, GNorm = 0.8940, lr_0 = 1.5786e-04
Validation rmse = 0.192717
Validation r2 = -0.472330
Validation mse = 0.037140
Epoch 46
Loss = 5.5192e-02, PNorm = 44.7555, GNorm = 0.7416, lr_0 = 1.5408e-04
Loss = 5.1813e-02, PNorm = 44.7602, GNorm = 0.8206, lr_0 = 1.5072e-04
Validation rmse = 0.179978
Validation r2 = -0.284107
Validation mse = 0.032392
Epoch 47
Loss = 5.4921e-02, PNorm = 44.7650, GNorm = 0.8134, lr_0 = 1.4743e-04
Validation rmse = 0.175398
Validation r2 = -0.219591
Validation mse = 0.030765
Epoch 48
Loss = 5.5731e-02, PNorm = 44.7700, GNorm = 0.8693, lr_0 = 1.4390e-04
Loss = 4.8261e-02, PNorm = 44.7743, GNorm = 0.5009, lr_0 = 1.4076e-04
Validation rmse = 0.190185
Validation r2 = -0.433897
Validation mse = 0.036171
Epoch 49
Loss = 5.2912e-02, PNorm = 44.7795, GNorm = 1.1057, lr_0 = 1.3769e-04
Loss = 4.7060e-02, PNorm = 44.7833, GNorm = 0.6089, lr_0 = 1.3468e-04
Validation rmse = 0.174099
Validation r2 = -0.201595
Validation mse = 0.030311
Epoch 50
Loss = 5.9693e-02, PNorm = 44.7878, GNorm = 1.3226, lr_0 = 1.3174e-04
Loss = 4.8109e-02, PNorm = 44.7926, GNorm = 0.6843, lr_0 = 1.2887e-04
Validation rmse = 0.203211
Validation r2 = -0.637035
Validation mse = 0.041295
Epoch 51
Loss = 4.6560e-02, PNorm = 44.7976, GNorm = 1.0035, lr_0 = 1.2578e-04
Loss = 5.3571e-02, PNorm = 44.8016, GNorm = 0.6983, lr_0 = 1.2304e-04
Validation rmse = 0.193271
Validation r2 = -0.480800
Validation mse = 0.037354
Epoch 52
Loss = 5.0024e-02, PNorm = 44.8056, GNorm = 0.7285, lr_0 = 1.2035e-04
Loss = 5.1054e-02, PNorm = 44.8092, GNorm = 1.3974, lr_0 = 1.1773e-04
Validation rmse = 0.184005
Validation r2 = -0.342210
Validation mse = 0.033858
Epoch 53
Loss = 4.6236e-02, PNorm = 44.8143, GNorm = 1.0215, lr_0 = 1.1491e-04
Loss = 4.9228e-02, PNorm = 44.8173, GNorm = 0.8914, lr_0 = 1.1240e-04
Validation rmse = 0.185315
Validation r2 = -0.361395
Validation mse = 0.034342
Epoch 54
Loss = 4.6433e-02, PNorm = 44.8215, GNorm = 0.3859, lr_0 = 1.0995e-04
Validation rmse = 0.178614
Validation r2 = -0.264719
Validation mse = 0.031903
Epoch 55
Loss = 3.8509e-02, PNorm = 44.8255, GNorm = 0.9849, lr_0 = 1.0731e-04
Loss = 4.3241e-02, PNorm = 44.8292, GNorm = 0.4141, lr_0 = 1.0497e-04
Validation rmse = 0.206752
Validation r2 = -0.694575
Validation mse = 0.042746
Epoch 56
Loss = 4.5893e-02, PNorm = 44.8323, GNorm = 1.1012, lr_0 = 1.0268e-04
Loss = 4.6653e-02, PNorm = 44.8355, GNorm = 0.8350, lr_0 = 1.0044e-04
Validation rmse = 0.181419
Validation r2 = -0.304760
Validation mse = 0.032913
Epoch 57
Loss = 3.6463e-02, PNorm = 44.8397, GNorm = 0.4721, lr_0 = 1.0000e-04
Loss = 4.6206e-02, PNorm = 44.8426, GNorm = 0.8391, lr_0 = 1.0000e-04
Validation rmse = 0.192487
Validation r2 = -0.468819
Validation mse = 0.037051
Epoch 58
Loss = 5.0058e-02, PNorm = 44.8463, GNorm = 0.8642, lr_0 = 1.0000e-04
Loss = 4.1931e-02, PNorm = 44.8498, GNorm = 1.1478, lr_0 = 1.0000e-04
Validation rmse = 0.181960
Validation r2 = -0.312542
Validation mse = 0.033109
Epoch 59
Loss = 4.2339e-02, PNorm = 44.8539, GNorm = 0.4486, lr_0 = 1.0000e-04
Loss = 4.5937e-02, PNorm = 44.8575, GNorm = 1.1808, lr_0 = 1.0000e-04
Validation rmse = 0.191348
Validation r2 = -0.451474
Validation mse = 0.036614
Model 0 best validation rmse = 0.128385 on epoch 8
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.227942
Model 0 test r2 = -0.317944
Model 0 test mse = 0.051957
Ensemble test rmse = 0.227942
Ensemble test r2 = -0.317944
Ensemble test mse = 0.051957
Fold 7
Splitting data with seed 7
Total size = 936 | train size = 926 | val size = 10 | test size = 96
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.6732e-01, PNorm = 43.2608, GNorm = 2.4682, lr_0 = 3.7500e-04
Validation rmse = 0.227491
Validation r2 = 0.589647
Validation mse = 0.051752
Epoch 1
Loss = 6.3471e-01, PNorm = 43.2861, GNorm = 6.9397, lr_0 = 6.5000e-04
Loss = 6.4536e-01, PNorm = 43.3352, GNorm = 8.1825, lr_0 = 9.0000e-04
Validation rmse = 0.164881
Validation r2 = 0.784439
Validation mse = 0.027186
Epoch 2
Loss = 4.7655e-01, PNorm = 43.4068, GNorm = 2.3308, lr_0 = 9.8685e-04
Loss = 4.8440e-01, PNorm = 43.4815, GNorm = 2.2215, lr_0 = 9.6533e-04
Validation rmse = 0.204915
Validation r2 = 0.667050
Validation mse = 0.041990
Epoch 3
Loss = 4.4226e-01, PNorm = 43.5649, GNorm = 1.6106, lr_0 = 9.4219e-04
Loss = 3.1771e-01, PNorm = 43.6298, GNorm = 0.9263, lr_0 = 9.2164e-04
Validation rmse = 0.195412
Validation r2 = 0.697215
Validation mse = 0.038186
Epoch 4
Loss = 2.2633e-01, PNorm = 43.6843, GNorm = 1.9553, lr_0 = 9.0153e-04
Loss = 2.4960e-01, PNorm = 43.7282, GNorm = 1.4433, lr_0 = 8.8187e-04
Validation rmse = 0.160020
Validation r2 = 0.796961
Validation mse = 0.025606
Epoch 5
Loss = 2.1054e-01, PNorm = 43.7733, GNorm = 1.9075, lr_0 = 8.6073e-04
Loss = 2.0729e-01, PNorm = 43.8154, GNorm = 2.7469, lr_0 = 8.4195e-04
Validation rmse = 0.122094
Validation r2 = 0.881800
Validation mse = 0.014907
Epoch 6
Loss = 1.5448e-01, PNorm = 43.8485, GNorm = 1.8272, lr_0 = 8.2359e-04
Validation rmse = 0.128928
Validation r2 = 0.868198
Validation mse = 0.016622
Epoch 7
Loss = 1.7378e-01, PNorm = 43.8845, GNorm = 3.3238, lr_0 = 8.0385e-04
Loss = 1.7164e-01, PNorm = 43.9206, GNorm = 4.1209, lr_0 = 7.8631e-04
Validation rmse = 0.155383
Validation r2 = 0.808559
Validation mse = 0.024144
Epoch 8
Loss = 2.1304e-01, PNorm = 43.9555, GNorm = 8.1801, lr_0 = 7.6916e-04
Loss = 1.9841e-01, PNorm = 43.9847, GNorm = 6.0917, lr_0 = 7.5238e-04
Validation rmse = 0.114152
Validation r2 = 0.896676
Validation mse = 0.013031
Epoch 9
Loss = 1.1082e-01, PNorm = 44.0223, GNorm = 3.2827, lr_0 = 7.3435e-04
Loss = 1.7777e-01, PNorm = 44.0521, GNorm = 3.8528, lr_0 = 7.1833e-04
Validation rmse = 0.152021
Validation r2 = 0.816752
Validation mse = 0.023110
Epoch 10
Loss = 1.8668e-01, PNorm = 44.0843, GNorm = 3.0902, lr_0 = 7.0266e-04
Loss = 1.3619e-01, PNorm = 44.1176, GNorm = 1.2187, lr_0 = 6.8733e-04
Validation rmse = 0.118972
Validation r2 = 0.887768
Validation mse = 0.014154
Epoch 11
Loss = 1.3007e-01, PNorm = 44.1424, GNorm = 0.8966, lr_0 = 6.7085e-04
Loss = 1.3203e-01, PNorm = 44.1624, GNorm = 1.3140, lr_0 = 6.5622e-04
Validation rmse = 0.122463
Validation r2 = 0.881084
Validation mse = 0.014997
Epoch 12
Loss = 1.3150e-01, PNorm = 44.1783, GNorm = 1.5333, lr_0 = 6.4191e-04
Loss = 1.2404e-01, PNorm = 44.1995, GNorm = 1.3614, lr_0 = 6.2790e-04
Loss = 1.3734e-01, PNorm = 44.2019, GNorm = 1.4377, lr_0 = 6.2652e-04
Validation rmse = 0.114320
Validation r2 = 0.896373
Validation mse = 0.013069
Epoch 13
Loss = 1.1643e-01, PNorm = 44.2191, GNorm = 2.8513, lr_0 = 6.1285e-04
Validation rmse = 0.111657
Validation r2 = 0.901145
Validation mse = 0.012467
Epoch 14
Loss = 6.8964e-02, PNorm = 44.2376, GNorm = 1.8900, lr_0 = 5.9948e-04
Loss = 1.0336e-01, PNorm = 44.2553, GNorm = 0.8118, lr_0 = 5.8641e-04
Validation rmse = 0.104412
Validation r2 = 0.913557
Validation mse = 0.010902
Epoch 15
Loss = 8.8798e-02, PNorm = 44.2693, GNorm = 0.9941, lr_0 = 5.7235e-04
Loss = 9.8256e-02, PNorm = 44.2878, GNorm = 0.6995, lr_0 = 5.5987e-04
Validation rmse = 0.105929
Validation r2 = 0.911026
Validation mse = 0.011221
Epoch 16
Loss = 1.0851e-01, PNorm = 44.3025, GNorm = 1.9407, lr_0 = 5.4765e-04
Loss = 9.6532e-02, PNorm = 44.3167, GNorm = 2.3756, lr_0 = 5.3571e-04
Validation rmse = 0.107743
Validation r2 = 0.907953
Validation mse = 0.011609
Epoch 17
Loss = 9.0696e-02, PNorm = 44.3319, GNorm = 1.0223, lr_0 = 5.2287e-04
Loss = 9.6021e-02, PNorm = 44.3459, GNorm = 1.5386, lr_0 = 5.1146e-04
Validation rmse = 0.131149
Validation r2 = 0.863617
Validation mse = 0.017200
Epoch 18
Loss = 1.0349e-01, PNorm = 44.3571, GNorm = 1.3333, lr_0 = 5.0030e-04
Loss = 1.1256e-01, PNorm = 44.3725, GNorm = 2.8298, lr_0 = 4.8939e-04
Validation rmse = 0.097270
Validation r2 = 0.924978
Validation mse = 0.009461
Epoch 19
Loss = 9.2720e-02, PNorm = 44.3888, GNorm = 2.4439, lr_0 = 4.7766e-04
Loss = 9.7549e-02, PNorm = 44.4054, GNorm = 0.8460, lr_0 = 4.6724e-04
Validation rmse = 0.089483
Validation r2 = 0.936510
Validation mse = 0.008007
Epoch 20
Loss = 8.3368e-02, PNorm = 44.4166, GNorm = 0.6253, lr_0 = 4.5705e-04
Validation rmse = 0.106822
Validation r2 = 0.909521
Validation mse = 0.011411
Epoch 21
Loss = 6.8894e-02, PNorm = 44.4299, GNorm = 0.9293, lr_0 = 4.4609e-04
Loss = 9.0172e-02, PNorm = 44.4445, GNorm = 1.2248, lr_0 = 4.3636e-04
Validation rmse = 0.102270
Validation r2 = 0.917067
Validation mse = 0.010459
Epoch 22
Loss = 8.5463e-02, PNorm = 44.4550, GNorm = 1.1567, lr_0 = 4.2684e-04
Loss = 9.3591e-02, PNorm = 44.4682, GNorm = 1.3245, lr_0 = 4.1753e-04
Validation rmse = 0.098054
Validation r2 = 0.923764
Validation mse = 0.009615
Epoch 23
Loss = 6.8134e-02, PNorm = 44.4814, GNorm = 1.0391, lr_0 = 4.0752e-04
Loss = 9.0561e-02, PNorm = 44.4928, GNorm = 2.1142, lr_0 = 3.9863e-04
Validation rmse = 0.109637
Validation r2 = 0.904689
Validation mse = 0.012020
Epoch 24
Loss = 9.3925e-02, PNorm = 44.5062, GNorm = 2.1019, lr_0 = 3.8994e-04
Loss = 9.3805e-02, PNorm = 44.5203, GNorm = 0.3671, lr_0 = 3.8143e-04
Validation rmse = 0.083119
Validation r2 = 0.945219
Validation mse = 0.006909
Epoch 25
Loss = 7.5904e-02, PNorm = 44.5336, GNorm = 0.8253, lr_0 = 3.7311e-04
Loss = 9.2899e-02, PNorm = 44.5444, GNorm = 0.6320, lr_0 = 3.6497e-04
Validation rmse = 0.109810
Validation r2 = 0.904387
Validation mse = 0.012058
Epoch 26
Loss = 8.3947e-02, PNorm = 44.5576, GNorm = 1.6265, lr_0 = 3.5622e-04
Loss = 9.9655e-02, PNorm = 44.5708, GNorm = 2.3965, lr_0 = 3.4845e-04
Validation rmse = 0.098015
Validation r2 = 0.923825
Validation mse = 0.009607
Epoch 27
Loss = 9.1785e-02, PNorm = 44.5848, GNorm = 0.6045, lr_0 = 3.4085e-04
Validation rmse = 0.076107
Validation r2 = 0.954072
Validation mse = 0.005792
Epoch 28
Loss = 8.2299e-02, PNorm = 44.5971, GNorm = 0.6274, lr_0 = 3.3268e-04
Loss = 7.8048e-02, PNorm = 44.6080, GNorm = 2.0824, lr_0 = 3.2543e-04
Validation rmse = 0.088264
Validation r2 = 0.938227
Validation mse = 0.007791
Epoch 29
Loss = 6.6897e-02, PNorm = 44.6203, GNorm = 1.9548, lr_0 = 3.1833e-04
Loss = 8.5861e-02, PNorm = 44.6297, GNorm = 1.2164, lr_0 = 3.1138e-04
Validation rmse = 0.096238
Validation r2 = 0.926561
Validation mse = 0.009262
Epoch 30
Loss = 6.3205e-02, PNorm = 44.6396, GNorm = 0.8507, lr_0 = 3.0392e-04
Loss = 7.1271e-02, PNorm = 44.6498, GNorm = 0.9185, lr_0 = 2.9729e-04
Validation rmse = 0.096557
Validation r2 = 0.926074
Validation mse = 0.009323
Epoch 31
Loss = 6.4391e-02, PNorm = 44.6589, GNorm = 0.6923, lr_0 = 2.9080e-04
Loss = 7.5718e-02, PNorm = 44.6678, GNorm = 1.7152, lr_0 = 2.8446e-04
Validation rmse = 0.079456
Validation r2 = 0.949941
Validation mse = 0.006313
Epoch 32
Loss = 7.4252e-02, PNorm = 44.6797, GNorm = 1.2492, lr_0 = 2.7764e-04
Loss = 7.2967e-02, PNorm = 44.6889, GNorm = 1.6203, lr_0 = 2.7159e-04
Validation rmse = 0.075466
Validation r2 = 0.954843
Validation mse = 0.005695
Epoch 33
Loss = 7.3774e-02, PNorm = 44.6972, GNorm = 0.9390, lr_0 = 2.6566e-04
Validation rmse = 0.089719
Validation r2 = 0.936174
Validation mse = 0.008049
Epoch 34
Loss = 7.3636e-02, PNorm = 44.7054, GNorm = 1.5496, lr_0 = 2.5929e-04
Loss = 5.9974e-02, PNorm = 44.7141, GNorm = 0.7637, lr_0 = 2.5364e-04
Validation rmse = 0.083204
Validation r2 = 0.945107
Validation mse = 0.006923
Epoch 35
Loss = 6.8783e-02, PNorm = 44.7227, GNorm = 1.8531, lr_0 = 2.4811e-04
Loss = 7.2914e-02, PNorm = 44.7309, GNorm = 4.1449, lr_0 = 2.4269e-04
Validation rmse = 0.081261
Validation r2 = 0.947640
Validation mse = 0.006603
Epoch 36
Loss = 1.0935e-01, PNorm = 44.7432, GNorm = 2.6554, lr_0 = 2.3688e-04
Loss = 7.9214e-02, PNorm = 44.7541, GNorm = 1.4950, lr_0 = 2.3171e-04
Validation rmse = 0.072435
Validation r2 = 0.958397
Validation mse = 0.005247
Epoch 37
Loss = 7.4958e-02, PNorm = 44.7636, GNorm = 1.8371, lr_0 = 2.2665e-04
Loss = 6.3428e-02, PNorm = 44.7722, GNorm = 1.1403, lr_0 = 2.2171e-04
Validation rmse = 0.082180
Validation r2 = 0.946449
Validation mse = 0.006754
Epoch 38
Loss = 6.5684e-02, PNorm = 44.7817, GNorm = 1.6112, lr_0 = 2.1640e-04
Loss = 6.2049e-02, PNorm = 44.7888, GNorm = 0.7635, lr_0 = 2.1168e-04
Validation rmse = 0.075492
Validation r2 = 0.954811
Validation mse = 0.005699
Epoch 39
Loss = 6.2398e-02, PNorm = 44.7967, GNorm = 1.5832, lr_0 = 2.0706e-04
Loss = 5.9597e-02, PNorm = 44.8038, GNorm = 0.9530, lr_0 = 2.0254e-04
Loss = 7.9553e-02, PNorm = 44.8045, GNorm = 2.2099, lr_0 = 2.0209e-04
Validation rmse = 0.078533
Validation r2 = 0.951097
Validation mse = 0.006167
Epoch 40
Loss = 5.9724e-02, PNorm = 44.8107, GNorm = 0.9636, lr_0 = 1.9769e-04
Validation rmse = 0.072154
Validation r2 = 0.958719
Validation mse = 0.005206
Epoch 41
Loss = 6.4564e-02, PNorm = 44.8176, GNorm = 0.8792, lr_0 = 1.9337e-04
Loss = 6.6121e-02, PNorm = 44.8262, GNorm = 0.7338, lr_0 = 1.8916e-04
Validation rmse = 0.073539
Validation r2 = 0.957118
Validation mse = 0.005408
Epoch 42
Loss = 5.3147e-02, PNorm = 44.8337, GNorm = 1.2398, lr_0 = 1.8462e-04
Loss = 6.6424e-02, PNorm = 44.8419, GNorm = 0.9326, lr_0 = 1.8059e-04
Validation rmse = 0.078294
Validation r2 = 0.951394
Validation mse = 0.006130
Epoch 43
Loss = 6.0392e-02, PNorm = 44.8475, GNorm = 0.6551, lr_0 = 1.7666e-04
Loss = 6.0094e-02, PNorm = 44.8534, GNorm = 1.4895, lr_0 = 1.7280e-04
Validation rmse = 0.068999
Validation r2 = 0.962250
Validation mse = 0.004761
Epoch 44
Loss = 5.4710e-02, PNorm = 44.8601, GNorm = 2.0912, lr_0 = 1.6866e-04
Loss = 5.9052e-02, PNorm = 44.8671, GNorm = 1.3297, lr_0 = 1.6498e-04
Validation rmse = 0.069759
Validation r2 = 0.961414
Validation mse = 0.004866
Epoch 45
Loss = 5.4081e-02, PNorm = 44.8720, GNorm = 0.7882, lr_0 = 1.6138e-04
Loss = 5.4598e-02, PNorm = 44.8772, GNorm = 1.1045, lr_0 = 1.5786e-04
Validation rmse = 0.072457
Validation r2 = 0.958372
Validation mse = 0.005250
Epoch 46
Loss = 4.9234e-02, PNorm = 44.8841, GNorm = 0.9530, lr_0 = 1.5408e-04
Loss = 5.9931e-02, PNorm = 44.8896, GNorm = 0.9988, lr_0 = 1.5072e-04
Validation rmse = 0.066358
Validation r2 = 0.965084
Validation mse = 0.004403
Epoch 47
Loss = 5.2023e-02, PNorm = 44.8968, GNorm = 1.1369, lr_0 = 1.4743e-04
Validation rmse = 0.068055
Validation r2 = 0.963275
Validation mse = 0.004632
Epoch 48
Loss = 5.9456e-02, PNorm = 44.9027, GNorm = 1.0740, lr_0 = 1.4390e-04
Loss = 5.0489e-02, PNorm = 44.9082, GNorm = 1.3758, lr_0 = 1.4076e-04
Validation rmse = 0.060979
Validation r2 = 0.970515
Validation mse = 0.003718
Epoch 49
Loss = 6.3255e-02, PNorm = 44.9139, GNorm = 1.3410, lr_0 = 1.3769e-04
Loss = 4.5090e-02, PNorm = 44.9193, GNorm = 0.5211, lr_0 = 1.3468e-04
Validation rmse = 0.074139
Validation r2 = 0.956416
Validation mse = 0.005497
Epoch 50
Loss = 4.8470e-02, PNorm = 44.9245, GNorm = 0.5161, lr_0 = 1.3174e-04
Loss = 5.3464e-02, PNorm = 44.9294, GNorm = 0.3916, lr_0 = 1.2887e-04
Validation rmse = 0.069885
Validation r2 = 0.961275
Validation mse = 0.004884
Epoch 51
Loss = 5.8136e-02, PNorm = 44.9345, GNorm = 0.7863, lr_0 = 1.2578e-04
Loss = 4.6170e-02, PNorm = 44.9391, GNorm = 0.4565, lr_0 = 1.2304e-04
Validation rmse = 0.072251
Validation r2 = 0.958608
Validation mse = 0.005220
Epoch 52
Loss = 4.8977e-02, PNorm = 44.9440, GNorm = 0.9016, lr_0 = 1.2035e-04
Loss = 5.5806e-02, PNorm = 44.9490, GNorm = 0.6683, lr_0 = 1.1773e-04
Validation rmse = 0.070864
Validation r2 = 0.960182
Validation mse = 0.005022
Epoch 53
Loss = 4.7542e-02, PNorm = 44.9532, GNorm = 1.5502, lr_0 = 1.1491e-04
Loss = 5.4264e-02, PNorm = 44.9584, GNorm = 1.1242, lr_0 = 1.1240e-04
Validation rmse = 0.069855
Validation r2 = 0.961308
Validation mse = 0.004880
Epoch 54
Loss = 4.8323e-02, PNorm = 44.9630, GNorm = 1.1956, lr_0 = 1.0995e-04
Validation rmse = 0.067323
Validation r2 = 0.964062
Validation mse = 0.004532
Epoch 55
Loss = 4.5743e-02, PNorm = 44.9687, GNorm = 1.0626, lr_0 = 1.0731e-04
Loss = 5.3049e-02, PNorm = 44.9725, GNorm = 0.9952, lr_0 = 1.0497e-04
Validation rmse = 0.074598
Validation r2 = 0.955875
Validation mse = 0.005565
Epoch 56
Loss = 4.2691e-02, PNorm = 44.9766, GNorm = 0.5644, lr_0 = 1.0268e-04
Loss = 5.2519e-02, PNorm = 44.9797, GNorm = 0.7066, lr_0 = 1.0044e-04
Validation rmse = 0.064364
Validation r2 = 0.967151
Validation mse = 0.004143
Epoch 57
Loss = 4.5041e-02, PNorm = 44.9845, GNorm = 0.3446, lr_0 = 1.0000e-04
Loss = 5.1097e-02, PNorm = 44.9884, GNorm = 0.6796, lr_0 = 1.0000e-04
Validation rmse = 0.063666
Validation r2 = 0.967860
Validation mse = 0.004053
Epoch 58
Loss = 4.9176e-02, PNorm = 44.9927, GNorm = 0.9130, lr_0 = 1.0000e-04
Loss = 4.3895e-02, PNorm = 44.9961, GNorm = 0.6304, lr_0 = 1.0000e-04
Validation rmse = 0.066274
Validation r2 = 0.965173
Validation mse = 0.004392
Epoch 59
Loss = 4.8946e-02, PNorm = 45.0001, GNorm = 0.7539, lr_0 = 1.0000e-04
Loss = 4.5818e-02, PNorm = 45.0039, GNorm = 1.9712, lr_0 = 1.0000e-04
Validation rmse = 0.064641
Validation r2 = 0.966868
Validation mse = 0.004178
Model 0 best validation rmse = 0.060979 on epoch 48
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.312423
Model 0 test r2 = -1.475914
Model 0 test mse = 0.097608
Ensemble test rmse = 0.312423
Ensemble test r2 = -1.475914
Ensemble test mse = 0.097608
Fold 8
Splitting data with seed 8
Total size = 936 | train size = 926 | val size = 10 | test size = 96
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.5005e-01, PNorm = 43.2611, GNorm = 4.5631, lr_0 = 3.7500e-04
Validation rmse = 0.348631
Validation r2 = 0.284584
Validation mse = 0.121543
Epoch 1
Loss = 8.6804e-01, PNorm = 43.2800, GNorm = 1.0488, lr_0 = 6.5000e-04
Loss = 6.5287e-01, PNorm = 43.3371, GNorm = 3.1146, lr_0 = 9.0000e-04
Validation rmse = 0.254810
Validation r2 = 0.617827
Validation mse = 0.064928
Epoch 2
Loss = 4.7473e-01, PNorm = 43.4108, GNorm = 6.9953, lr_0 = 9.8685e-04
Loss = 3.8817e-01, PNorm = 43.4932, GNorm = 6.2121, lr_0 = 9.6533e-04
Validation rmse = 0.131510
Validation r2 = 0.898200
Validation mse = 0.017295
Epoch 3
Loss = 3.9638e-01, PNorm = 43.5661, GNorm = 9.8056, lr_0 = 9.4219e-04
Loss = 2.6610e-01, PNorm = 43.6298, GNorm = 4.1665, lr_0 = 9.2164e-04
Validation rmse = 0.204819
Validation r2 = 0.753074
Validation mse = 0.041951
Epoch 4
Loss = 3.0608e-01, PNorm = 43.6807, GNorm = 4.8675, lr_0 = 9.0153e-04
Loss = 3.1310e-01, PNorm = 43.7353, GNorm = 10.0295, lr_0 = 8.8187e-04
Validation rmse = 0.179237
Validation r2 = 0.810903
Validation mse = 0.032126
Epoch 5
Loss = 2.7255e-01, PNorm = 43.7879, GNorm = 2.3470, lr_0 = 8.6073e-04
Loss = 2.4555e-01, PNorm = 43.8366, GNorm = 2.2594, lr_0 = 8.4195e-04
Validation rmse = 0.106606
Validation r2 = 0.933105
Validation mse = 0.011365
Epoch 6
Loss = 1.7274e-01, PNorm = 43.8789, GNorm = 1.2715, lr_0 = 8.2359e-04
Validation rmse = 0.123187
Validation r2 = 0.910678
Validation mse = 0.015175
Epoch 7
Loss = 1.4189e-01, PNorm = 43.9129, GNorm = 2.3700, lr_0 = 8.0385e-04
Loss = 1.5324e-01, PNorm = 43.9397, GNorm = 2.9636, lr_0 = 7.8631e-04
Validation rmse = 0.112062
Validation r2 = 0.926083
Validation mse = 0.012558
Epoch 8
Loss = 1.5803e-01, PNorm = 43.9690, GNorm = 1.4192, lr_0 = 7.6916e-04
Loss = 1.3491e-01, PNorm = 43.9984, GNorm = 1.8182, lr_0 = 7.5238e-04
Validation rmse = 0.089439
Validation r2 = 0.952915
Validation mse = 0.007999
Epoch 9
Loss = 1.2178e-01, PNorm = 44.0207, GNorm = 2.5441, lr_0 = 7.3435e-04
Loss = 1.6332e-01, PNorm = 44.0392, GNorm = 5.9593, lr_0 = 7.1833e-04
Validation rmse = 0.109564
Validation r2 = 0.929341
Validation mse = 0.012004
Epoch 10
Loss = 1.3696e-01, PNorm = 44.0654, GNorm = 3.0922, lr_0 = 7.0266e-04
Loss = 1.3507e-01, PNorm = 44.0886, GNorm = 1.1664, lr_0 = 6.8733e-04
Validation rmse = 0.081442
Validation r2 = 0.960958
Validation mse = 0.006633
Epoch 11
Loss = 1.4332e-01, PNorm = 44.1141, GNorm = 0.9292, lr_0 = 6.7085e-04
Loss = 1.1515e-01, PNorm = 44.1340, GNorm = 1.5776, lr_0 = 6.5622e-04
Validation rmse = 0.093255
Validation r2 = 0.948811
Validation mse = 0.008697
Epoch 12
Loss = 1.1037e-01, PNorm = 44.1509, GNorm = 1.7426, lr_0 = 6.4191e-04
Loss = 1.2958e-01, PNorm = 44.1686, GNorm = 1.0645, lr_0 = 6.2790e-04
Loss = 1.0771e-01, PNorm = 44.1707, GNorm = 0.8995, lr_0 = 6.2652e-04
Validation rmse = 0.086216
Validation r2 = 0.956247
Validation mse = 0.007433
Epoch 13
Loss = 1.1126e-01, PNorm = 44.1869, GNorm = 2.4574, lr_0 = 6.1285e-04
Validation rmse = 0.089470
Validation r2 = 0.952882
Validation mse = 0.008005
Epoch 14
Loss = 1.4331e-01, PNorm = 44.2051, GNorm = 0.9445, lr_0 = 5.9948e-04
Loss = 8.8414e-02, PNorm = 44.2204, GNorm = 1.3266, lr_0 = 5.8641e-04
Validation rmse = 0.085582
Validation r2 = 0.956889
Validation mse = 0.007324
Epoch 15
Loss = 1.0564e-01, PNorm = 44.2390, GNorm = 0.7212, lr_0 = 5.7235e-04
Loss = 1.0994e-01, PNorm = 44.2545, GNorm = 3.0735, lr_0 = 5.5987e-04
Validation rmse = 0.088502
Validation r2 = 0.953897
Validation mse = 0.007833
Epoch 16
Loss = 1.2070e-01, PNorm = 44.2684, GNorm = 1.7611, lr_0 = 5.4765e-04
Loss = 1.1344e-01, PNorm = 44.2896, GNorm = 1.7300, lr_0 = 5.3571e-04
Validation rmse = 0.072604
Validation r2 = 0.968972
Validation mse = 0.005271
Epoch 17
Loss = 1.0393e-01, PNorm = 44.3050, GNorm = 0.7068, lr_0 = 5.2287e-04
Loss = 1.1134e-01, PNorm = 44.3251, GNorm = 1.9998, lr_0 = 5.1146e-04
Validation rmse = 0.082845
Validation r2 = 0.959602
Validation mse = 0.006863
Epoch 18
Loss = 1.0197e-01, PNorm = 44.3383, GNorm = 0.9372, lr_0 = 5.0030e-04
Loss = 9.8496e-02, PNorm = 44.3555, GNorm = 1.5571, lr_0 = 4.8939e-04
Validation rmse = 0.101121
Validation r2 = 0.939812
Validation mse = 0.010225
Epoch 19
Loss = 8.6495e-02, PNorm = 44.3725, GNorm = 1.2876, lr_0 = 4.7766e-04
Loss = 1.0141e-01, PNorm = 44.3869, GNorm = 2.0728, lr_0 = 4.6724e-04
Validation rmse = 0.083537
Validation r2 = 0.958925
Validation mse = 0.006978
Epoch 20
Loss = 8.8379e-02, PNorm = 44.4003, GNorm = 0.8155, lr_0 = 4.5705e-04
Validation rmse = 0.073226
Validation r2 = 0.968439
Validation mse = 0.005362
Epoch 21
Loss = 8.0220e-02, PNorm = 44.4106, GNorm = 0.6778, lr_0 = 4.4609e-04
Loss = 7.6168e-02, PNorm = 44.4215, GNorm = 0.7765, lr_0 = 4.3636e-04
Validation rmse = 0.090130
Validation r2 = 0.952185
Validation mse = 0.008123
Epoch 22
Loss = 9.1671e-02, PNorm = 44.4335, GNorm = 0.6320, lr_0 = 4.2684e-04
Loss = 9.6859e-02, PNorm = 44.4491, GNorm = 2.2954, lr_0 = 4.1753e-04
Validation rmse = 0.099910
Validation r2 = 0.941245
Validation mse = 0.009982
Epoch 23
Loss = 7.1563e-02, PNorm = 44.4609, GNorm = 1.0586, lr_0 = 4.0752e-04
Loss = 9.8842e-02, PNorm = 44.4730, GNorm = 2.0593, lr_0 = 3.9863e-04
Validation rmse = 0.102011
Validation r2 = 0.938748
Validation mse = 0.010406
Epoch 24
Loss = 1.1582e-01, PNorm = 44.4866, GNorm = 2.6800, lr_0 = 3.8994e-04
Loss = 1.0144e-01, PNorm = 44.4998, GNorm = 1.2895, lr_0 = 3.8143e-04
Validation rmse = 0.076444
Validation r2 = 0.965604
Validation mse = 0.005844
Epoch 25
Loss = 8.5995e-02, PNorm = 44.5131, GNorm = 1.2080, lr_0 = 3.7311e-04
Loss = 8.0187e-02, PNorm = 44.5253, GNorm = 0.5620, lr_0 = 3.6497e-04
Validation rmse = 0.079043
Validation r2 = 0.963225
Validation mse = 0.006248
Epoch 26
Loss = 6.9434e-02, PNorm = 44.5361, GNorm = 0.9010, lr_0 = 3.5622e-04
Loss = 8.8485e-02, PNorm = 44.5473, GNorm = 3.4295, lr_0 = 3.4845e-04
Validation rmse = 0.081675
Validation r2 = 0.960735
Validation mse = 0.006671
Epoch 27
Loss = 7.5967e-02, PNorm = 44.5546, GNorm = 1.2414, lr_0 = 3.4085e-04
Validation rmse = 0.079284
Validation r2 = 0.963000
Validation mse = 0.006286
Epoch 28
Loss = 7.8637e-02, PNorm = 44.5678, GNorm = 0.9546, lr_0 = 3.3268e-04
Loss = 7.7494e-02, PNorm = 44.5813, GNorm = 0.7083, lr_0 = 3.2543e-04
Validation rmse = 0.071507
Validation r2 = 0.969903
Validation mse = 0.005113
Epoch 29
Loss = 8.7908e-02, PNorm = 44.5921, GNorm = 2.2850, lr_0 = 3.1833e-04
Loss = 8.6574e-02, PNorm = 44.6025, GNorm = 3.0264, lr_0 = 3.1138e-04
Validation rmse = 0.073633
Validation r2 = 0.968086
Validation mse = 0.005422
Epoch 30
Loss = 8.2453e-02, PNorm = 44.6146, GNorm = 0.9267, lr_0 = 3.0392e-04
Loss = 7.5947e-02, PNorm = 44.6235, GNorm = 1.7976, lr_0 = 2.9729e-04
Validation rmse = 0.078271
Validation r2 = 0.963940
Validation mse = 0.006126
Epoch 31
Loss = 6.7612e-02, PNorm = 44.6338, GNorm = 1.6185, lr_0 = 2.9080e-04
Loss = 9.0149e-02, PNorm = 44.6437, GNorm = 0.7953, lr_0 = 2.8446e-04
Validation rmse = 0.083314
Validation r2 = 0.959143
Validation mse = 0.006941
Epoch 32
Loss = 8.4582e-02, PNorm = 44.6562, GNorm = 1.4698, lr_0 = 2.7764e-04
Loss = 7.0534e-02, PNorm = 44.6667, GNorm = 1.0942, lr_0 = 2.7159e-04
Validation rmse = 0.072105
Validation r2 = 0.969397
Validation mse = 0.005199
Epoch 33
Loss = 6.2829e-02, PNorm = 44.6756, GNorm = 1.1432, lr_0 = 2.6566e-04
Validation rmse = 0.072411
Validation r2 = 0.969137
Validation mse = 0.005243
Epoch 34
Loss = 7.2881e-02, PNorm = 44.6856, GNorm = 1.0281, lr_0 = 2.5929e-04
Loss = 7.6042e-02, PNorm = 44.6936, GNorm = 1.3879, lr_0 = 2.5364e-04
Validation rmse = 0.071787
Validation r2 = 0.969667
Validation mse = 0.005153
Epoch 35
Loss = 8.0039e-02, PNorm = 44.7016, GNorm = 2.3173, lr_0 = 2.4811e-04
Loss = 6.9302e-02, PNorm = 44.7086, GNorm = 2.7595, lr_0 = 2.4269e-04
Validation rmse = 0.089888
Validation r2 = 0.952441
Validation mse = 0.008080
Epoch 36
Loss = 7.4175e-02, PNorm = 44.7200, GNorm = 0.5632, lr_0 = 2.3688e-04
Loss = 7.5881e-02, PNorm = 44.7281, GNorm = 0.7613, lr_0 = 2.3171e-04
Validation rmse = 0.078995
Validation r2 = 0.963270
Validation mse = 0.006240
Epoch 37
Loss = 8.4717e-02, PNorm = 44.7365, GNorm = 1.1531, lr_0 = 2.2665e-04
Loss = 7.0266e-02, PNorm = 44.7457, GNorm = 0.6413, lr_0 = 2.2171e-04
Validation rmse = 0.062889
Validation r2 = 0.976721
Validation mse = 0.003955
Epoch 38
Loss = 5.9792e-02, PNorm = 44.7530, GNorm = 1.5475, lr_0 = 2.1640e-04
Loss = 7.0300e-02, PNorm = 44.7598, GNorm = 1.3966, lr_0 = 2.1168e-04
Validation rmse = 0.066954
Validation r2 = 0.973613
Validation mse = 0.004483
Epoch 39
Loss = 6.6861e-02, PNorm = 44.7672, GNorm = 0.3396, lr_0 = 2.0706e-04
Loss = 6.0252e-02, PNorm = 44.7753, GNorm = 0.5643, lr_0 = 2.0254e-04
Loss = 1.0900e-01, PNorm = 44.7758, GNorm = 2.8865, lr_0 = 2.0209e-04
Validation rmse = 0.064329
Validation r2 = 0.975642
Validation mse = 0.004138
Epoch 40
Loss = 6.0172e-02, PNorm = 44.7825, GNorm = 1.0809, lr_0 = 1.9769e-04
Validation rmse = 0.064520
Validation r2 = 0.975497
Validation mse = 0.004163
Epoch 41
Loss = 8.1147e-02, PNorm = 44.7898, GNorm = 1.5453, lr_0 = 1.9337e-04
Loss = 5.3962e-02, PNorm = 44.7956, GNorm = 0.9250, lr_0 = 1.8916e-04
Validation rmse = 0.079932
Validation r2 = 0.962393
Validation mse = 0.006389
Epoch 42
Loss = 6.6389e-02, PNorm = 44.8037, GNorm = 2.7529, lr_0 = 1.8462e-04
Loss = 6.5797e-02, PNorm = 44.8098, GNorm = 0.7998, lr_0 = 1.8059e-04
Validation rmse = 0.080863
Validation r2 = 0.961512
Validation mse = 0.006539
Epoch 43
Loss = 5.8187e-02, PNorm = 44.8162, GNorm = 1.0156, lr_0 = 1.7666e-04
Loss = 6.1382e-02, PNorm = 44.8225, GNorm = 0.4670, lr_0 = 1.7280e-04
Validation rmse = 0.072292
Validation r2 = 0.969239
Validation mse = 0.005226
Epoch 44
Loss = 5.9536e-02, PNorm = 44.8292, GNorm = 1.3432, lr_0 = 1.6866e-04
Loss = 5.4128e-02, PNorm = 44.8344, GNorm = 1.6090, lr_0 = 1.6498e-04
Validation rmse = 0.064391
Validation r2 = 0.975595
Validation mse = 0.004146
Epoch 45
Loss = 5.2075e-02, PNorm = 44.8396, GNorm = 0.6853, lr_0 = 1.6138e-04
Loss = 6.6417e-02, PNorm = 44.8473, GNorm = 0.7595, lr_0 = 1.5786e-04
Validation rmse = 0.098857
Validation r2 = 0.942476
Validation mse = 0.009773
Epoch 46
Loss = 5.6816e-02, PNorm = 44.8525, GNorm = 1.3981, lr_0 = 1.5408e-04
Loss = 5.6119e-02, PNorm = 44.8584, GNorm = 0.8162, lr_0 = 1.5072e-04
Validation rmse = 0.059409
Validation r2 = 0.979225
Validation mse = 0.003529
Epoch 47
Loss = 5.1881e-02, PNorm = 44.8644, GNorm = 0.6040, lr_0 = 1.4743e-04
Validation rmse = 0.070420
Validation r2 = 0.970811
Validation mse = 0.004959
Epoch 48
Loss = 3.8859e-02, PNorm = 44.8700, GNorm = 0.3990, lr_0 = 1.4390e-04
Loss = 5.5229e-02, PNorm = 44.8743, GNorm = 0.5463, lr_0 = 1.4076e-04
Validation rmse = 0.066052
Validation r2 = 0.974320
Validation mse = 0.004363
Epoch 49
Loss = 4.6229e-02, PNorm = 44.8800, GNorm = 0.8023, lr_0 = 1.3769e-04
Loss = 5.5976e-02, PNorm = 44.8847, GNorm = 0.4853, lr_0 = 1.3468e-04
Validation rmse = 0.071232
Validation r2 = 0.970134
Validation mse = 0.005074
Epoch 50
Loss = 5.0708e-02, PNorm = 44.8899, GNorm = 0.9092, lr_0 = 1.3174e-04
Loss = 5.0677e-02, PNorm = 44.8940, GNorm = 1.1931, lr_0 = 1.2887e-04
Validation rmse = 0.071004
Validation r2 = 0.970325
Validation mse = 0.005042
Epoch 51
Loss = 5.5003e-02, PNorm = 44.8998, GNorm = 1.1341, lr_0 = 1.2578e-04
Loss = 4.8299e-02, PNorm = 44.9046, GNorm = 0.7916, lr_0 = 1.2304e-04
Validation rmse = 0.070889
Validation r2 = 0.970421
Validation mse = 0.005025
Epoch 52
Loss = 5.4272e-02, PNorm = 44.9087, GNorm = 0.8079, lr_0 = 1.2035e-04
Loss = 5.1985e-02, PNorm = 44.9134, GNorm = 0.7320, lr_0 = 1.1773e-04
Validation rmse = 0.069403
Validation r2 = 0.971648
Validation mse = 0.004817
Epoch 53
Loss = 5.4289e-02, PNorm = 44.9172, GNorm = 0.7138, lr_0 = 1.1491e-04
Loss = 5.0839e-02, PNorm = 44.9226, GNorm = 1.2354, lr_0 = 1.1240e-04
Validation rmse = 0.073274
Validation r2 = 0.968397
Validation mse = 0.005369
Epoch 54
Loss = 4.8845e-02, PNorm = 44.9265, GNorm = 0.6291, lr_0 = 1.0995e-04
Validation rmse = 0.069428
Validation r2 = 0.971627
Validation mse = 0.004820
Epoch 55
Loss = 3.7318e-02, PNorm = 44.9306, GNorm = 0.6127, lr_0 = 1.0731e-04
Loss = 4.8329e-02, PNorm = 44.9342, GNorm = 0.7534, lr_0 = 1.0497e-04
Validation rmse = 0.069938
Validation r2 = 0.971210
Validation mse = 0.004891
Epoch 56
Loss = 5.6894e-02, PNorm = 44.9383, GNorm = 1.2290, lr_0 = 1.0268e-04
Loss = 4.4366e-02, PNorm = 44.9419, GNorm = 0.7367, lr_0 = 1.0044e-04
Validation rmse = 0.077925
Validation r2 = 0.964258
Validation mse = 0.006072
Epoch 57
Loss = 4.7876e-02, PNorm = 44.9458, GNorm = 0.8211, lr_0 = 1.0000e-04
Loss = 4.8790e-02, PNorm = 44.9495, GNorm = 0.4014, lr_0 = 1.0000e-04
Validation rmse = 0.074045
Validation r2 = 0.967728
Validation mse = 0.005483
Epoch 58
Loss = 4.6229e-02, PNorm = 44.9532, GNorm = 0.5279, lr_0 = 1.0000e-04
Loss = 4.7906e-02, PNorm = 44.9566, GNorm = 0.8285, lr_0 = 1.0000e-04
Validation rmse = 0.078316
Validation r2 = 0.963898
Validation mse = 0.006133
Epoch 59
Loss = 4.2708e-02, PNorm = 44.9605, GNorm = 0.9076, lr_0 = 1.0000e-04
Loss = 5.1105e-02, PNorm = 44.9647, GNorm = 0.7381, lr_0 = 1.0000e-04
Validation rmse = 0.070254
Validation r2 = 0.970948
Validation mse = 0.004936
Model 0 best validation rmse = 0.059409 on epoch 46
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.289100
Model 0 test r2 = -1.120039
Model 0 test mse = 0.083579
Ensemble test rmse = 0.289100
Ensemble test r2 = -1.120039
Ensemble test mse = 0.083579
Fold 9
Splitting data with seed 9
Total size = 936 | train size = 926 | val size = 10 | test size = 96
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.0159e-01, PNorm = 43.2641, GNorm = 3.1902, lr_0 = 3.7500e-04
Validation rmse = 0.288919
Validation r2 = 0.399805
Validation mse = 0.083474
Epoch 1
Loss = 5.8005e-01, PNorm = 43.2950, GNorm = 3.8805, lr_0 = 6.5000e-04
Loss = 5.1380e-01, PNorm = 43.3469, GNorm = 8.3372, lr_0 = 9.0000e-04
Validation rmse = 0.208115
Validation r2 = 0.688581
Validation mse = 0.043312
Epoch 2
Loss = 3.4122e-01, PNorm = 43.4190, GNorm = 2.0109, lr_0 = 9.8685e-04
Loss = 3.8983e-01, PNorm = 43.4845, GNorm = 8.7636, lr_0 = 9.6533e-04
Validation rmse = 0.137070
Validation r2 = 0.864909
Validation mse = 0.018788
Epoch 3
Loss = 3.9008e-01, PNorm = 43.5635, GNorm = 9.4113, lr_0 = 9.4219e-04
Loss = 3.5040e-01, PNorm = 43.6259, GNorm = 4.1352, lr_0 = 9.2164e-04
Validation rmse = 0.136569
Validation r2 = 0.865896
Validation mse = 0.018651
Epoch 4
Loss = 2.5971e-01, PNorm = 43.6752, GNorm = 3.0333, lr_0 = 9.0153e-04
Loss = 2.6078e-01, PNorm = 43.7211, GNorm = 4.4540, lr_0 = 8.8187e-04
Validation rmse = 0.136128
Validation r2 = 0.866760
Validation mse = 0.018531
Epoch 5
Loss = 2.2192e-01, PNorm = 43.7732, GNorm = 1.2731, lr_0 = 8.6073e-04
Loss = 2.1540e-01, PNorm = 43.8150, GNorm = 2.0674, lr_0 = 8.4195e-04
Validation rmse = 0.191278
Validation r2 = 0.736931
Validation mse = 0.036587
Epoch 6
Loss = 2.7725e-01, PNorm = 43.8570, GNorm = 2.1336, lr_0 = 8.2359e-04
Validation rmse = 0.112316
Validation r2 = 0.909296
Validation mse = 0.012615
Epoch 7
Loss = 2.1355e-01, PNorm = 43.8894, GNorm = 3.1728, lr_0 = 8.0385e-04
Loss = 1.4712e-01, PNorm = 43.9114, GNorm = 0.3538, lr_0 = 7.8631e-04
Validation rmse = 0.100737
Validation r2 = 0.927035
Validation mse = 0.010148
Epoch 8
Loss = 1.6725e-01, PNorm = 43.9413, GNorm = 3.3634, lr_0 = 7.6916e-04
Loss = 1.3922e-01, PNorm = 43.9679, GNorm = 0.7469, lr_0 = 7.5238e-04
Validation rmse = 0.131876
Validation r2 = 0.874953
Validation mse = 0.017391
Epoch 9
Loss = 1.4669e-01, PNorm = 43.9965, GNorm = 2.5193, lr_0 = 7.3435e-04
Loss = 1.7324e-01, PNorm = 44.0219, GNorm = 1.1399, lr_0 = 7.1833e-04
Validation rmse = 0.092948
Validation r2 = 0.937881
Validation mse = 0.008639
Epoch 10
Loss = 1.4943e-01, PNorm = 44.0459, GNorm = 0.7443, lr_0 = 7.0266e-04
Loss = 1.1362e-01, PNorm = 44.0719, GNorm = 0.6941, lr_0 = 6.8733e-04
Validation rmse = 0.094478
Validation r2 = 0.935820
Validation mse = 0.008926
Epoch 11
Loss = 1.0939e-01, PNorm = 44.0903, GNorm = 1.8599, lr_0 = 6.7085e-04
Loss = 1.1563e-01, PNorm = 44.1097, GNorm = 4.2545, lr_0 = 6.5622e-04
Validation rmse = 0.098638
Validation r2 = 0.930044
Validation mse = 0.009729
Epoch 12
Loss = 1.2306e-01, PNorm = 44.1300, GNorm = 3.9567, lr_0 = 6.4191e-04
Loss = 1.2353e-01, PNorm = 44.1428, GNorm = 1.5185, lr_0 = 6.2790e-04
Loss = 1.6487e-01, PNorm = 44.1455, GNorm = 3.9525, lr_0 = 6.2652e-04
Validation rmse = 0.080668
Validation r2 = 0.953211
Validation mse = 0.006507
Epoch 13
Loss = 1.1125e-01, PNorm = 44.1697, GNorm = 1.2157, lr_0 = 6.1285e-04
Validation rmse = 0.092871
Validation r2 = 0.937985
Validation mse = 0.008625
Epoch 14
Loss = 1.2217e-01, PNorm = 44.1859, GNorm = 1.7180, lr_0 = 5.9948e-04
Loss = 1.0240e-01, PNorm = 44.2069, GNorm = 0.5471, lr_0 = 5.8641e-04
Validation rmse = 0.070921
Validation r2 = 0.963835
Validation mse = 0.005030
Epoch 15
Loss = 1.0024e-01, PNorm = 44.2277, GNorm = 2.0595, lr_0 = 5.7235e-04
Loss = 1.1289e-01, PNorm = 44.2426, GNorm = 2.2344, lr_0 = 5.5987e-04
Validation rmse = 0.086725
Validation r2 = 0.945921
Validation mse = 0.007521
Epoch 16
Loss = 1.1759e-01, PNorm = 44.2589, GNorm = 1.4286, lr_0 = 5.4765e-04
Loss = 9.8991e-02, PNorm = 44.2742, GNorm = 1.7537, lr_0 = 5.3571e-04
Validation rmse = 0.068712
Validation r2 = 0.966053
Validation mse = 0.004721
Epoch 17
Loss = 8.9964e-02, PNorm = 44.2860, GNorm = 2.4879, lr_0 = 5.2287e-04
Loss = 1.0242e-01, PNorm = 44.3013, GNorm = 3.1174, lr_0 = 5.1146e-04
Validation rmse = 0.066183
Validation r2 = 0.968505
Validation mse = 0.004380
Epoch 18
Loss = 8.6617e-02, PNorm = 44.3138, GNorm = 1.1997, lr_0 = 5.0030e-04
Loss = 1.0475e-01, PNorm = 44.3296, GNorm = 1.3775, lr_0 = 4.8939e-04
Validation rmse = 0.070512
Validation r2 = 0.964251
Validation mse = 0.004972
Epoch 19
Loss = 9.2859e-02, PNorm = 44.3419, GNorm = 2.6548, lr_0 = 4.7766e-04
Loss = 1.0899e-01, PNorm = 44.3561, GNorm = 5.0902, lr_0 = 4.6724e-04
Validation rmse = 0.076286
Validation r2 = 0.958156
Validation mse = 0.005820
Epoch 20
Loss = 9.0236e-02, PNorm = 44.3691, GNorm = 2.3890, lr_0 = 4.5705e-04
Validation rmse = 0.063529
Validation r2 = 0.970981
Validation mse = 0.004036
Epoch 21
Loss = 8.3266e-02, PNorm = 44.3857, GNorm = 1.8730, lr_0 = 4.4609e-04
Loss = 9.5389e-02, PNorm = 44.3992, GNorm = 1.6017, lr_0 = 4.3636e-04
Validation rmse = 0.093621
Validation r2 = 0.936979
Validation mse = 0.008765
Epoch 22
Loss = 7.6242e-02, PNorm = 44.4090, GNorm = 1.0555, lr_0 = 4.2684e-04
Loss = 9.3629e-02, PNorm = 44.4206, GNorm = 2.8313, lr_0 = 4.1753e-04
Validation rmse = 0.060013
Validation r2 = 0.974104
Validation mse = 0.003602
Epoch 23
Loss = 9.0129e-02, PNorm = 44.4344, GNorm = 2.1271, lr_0 = 4.0752e-04
Loss = 8.5254e-02, PNorm = 44.4465, GNorm = 1.2356, lr_0 = 3.9863e-04
Validation rmse = 0.080345
Validation r2 = 0.953585
Validation mse = 0.006455
Epoch 24
Loss = 8.6771e-02, PNorm = 44.4583, GNorm = 1.6248, lr_0 = 3.8994e-04
Loss = 7.9224e-02, PNorm = 44.4698, GNorm = 1.3479, lr_0 = 3.8143e-04
Validation rmse = 0.065658
Validation r2 = 0.969003
Validation mse = 0.004311
Epoch 25
Loss = 9.5183e-02, PNorm = 44.4817, GNorm = 2.6292, lr_0 = 3.7311e-04
Loss = 9.0815e-02, PNorm = 44.4916, GNorm = 1.0105, lr_0 = 3.6497e-04
Validation rmse = 0.095597
Validation r2 = 0.934290
Validation mse = 0.009139
Epoch 26
Loss = 9.2861e-02, PNorm = 44.5070, GNorm = 1.1251, lr_0 = 3.5622e-04
Loss = 7.9188e-02, PNorm = 44.5163, GNorm = 2.8889, lr_0 = 3.4845e-04
Validation rmse = 0.070698
Validation r2 = 0.964062
Validation mse = 0.004998
Epoch 27
Loss = 7.4376e-02, PNorm = 44.5271, GNorm = 0.7943, lr_0 = 3.4085e-04
Validation rmse = 0.099833
Validation r2 = 0.928339
Validation mse = 0.009967
Epoch 28
Loss = 6.9731e-02, PNorm = 44.5375, GNorm = 1.1793, lr_0 = 3.3268e-04
Loss = 7.1687e-02, PNorm = 44.5447, GNorm = 0.7551, lr_0 = 3.2543e-04
Validation rmse = 0.084404
Validation r2 = 0.948777
Validation mse = 0.007124
Epoch 29
Loss = 6.9235e-02, PNorm = 44.5561, GNorm = 0.7366, lr_0 = 3.1833e-04
Loss = 7.4727e-02, PNorm = 44.5670, GNorm = 0.8758, lr_0 = 3.1138e-04
Validation rmse = 0.066405
Validation r2 = 0.968294
Validation mse = 0.004410
Epoch 30
Loss = 8.9457e-02, PNorm = 44.5770, GNorm = 2.4235, lr_0 = 3.0392e-04
Loss = 6.8472e-02, PNorm = 44.5870, GNorm = 0.7609, lr_0 = 2.9729e-04
Validation rmse = 0.058714
Validation r2 = 0.975213
Validation mse = 0.003447
Epoch 31
Loss = 6.6142e-02, PNorm = 44.5970, GNorm = 0.9446, lr_0 = 2.9080e-04
Loss = 7.0662e-02, PNorm = 44.6060, GNorm = 0.8823, lr_0 = 2.8446e-04
Validation rmse = 0.094670
Validation r2 = 0.935558
Validation mse = 0.008962
Epoch 32
Loss = 7.4458e-02, PNorm = 44.6176, GNorm = 0.6610, lr_0 = 2.7764e-04
Loss = 7.3884e-02, PNorm = 44.6257, GNorm = 1.0895, lr_0 = 2.7159e-04
Validation rmse = 0.078032
Validation r2 = 0.956219
Validation mse = 0.006089
Epoch 33
Loss = 6.2046e-02, PNorm = 44.6351, GNorm = 0.7445, lr_0 = 2.6566e-04
Validation rmse = 0.060315
Validation r2 = 0.973843
Validation mse = 0.003638
Epoch 34
Loss = 6.4497e-02, PNorm = 44.6452, GNorm = 1.1027, lr_0 = 2.5929e-04
Loss = 6.3694e-02, PNorm = 44.6544, GNorm = 0.9377, lr_0 = 2.5364e-04
Validation rmse = 0.074035
Validation r2 = 0.960589
Validation mse = 0.005481
Epoch 35
Loss = 7.3904e-02, PNorm = 44.6614, GNorm = 1.3660, lr_0 = 2.4811e-04
Loss = 6.2495e-02, PNorm = 44.6690, GNorm = 0.7207, lr_0 = 2.4269e-04
Validation rmse = 0.078726
Validation r2 = 0.955437
Validation mse = 0.006198
Epoch 36
Loss = 6.1724e-02, PNorm = 44.6772, GNorm = 1.2586, lr_0 = 2.3688e-04
Loss = 7.3223e-02, PNorm = 44.6868, GNorm = 0.8140, lr_0 = 2.3171e-04
Validation rmse = 0.086365
Validation r2 = 0.946369
Validation mse = 0.007459
Epoch 37
Loss = 6.1302e-02, PNorm = 44.6948, GNorm = 0.6693, lr_0 = 2.2665e-04
Loss = 6.2876e-02, PNorm = 44.7013, GNorm = 0.6891, lr_0 = 2.2171e-04
Validation rmse = 0.076227
Validation r2 = 0.958221
Validation mse = 0.005811
Epoch 38
Loss = 6.6316e-02, PNorm = 44.7090, GNorm = 1.7600, lr_0 = 2.1640e-04
Loss = 7.3065e-02, PNorm = 44.7153, GNorm = 3.3494, lr_0 = 2.1168e-04
Validation rmse = 0.065878
Validation r2 = 0.968796
Validation mse = 0.004340
Epoch 39
Loss = 6.4819e-02, PNorm = 44.7246, GNorm = 1.9537, lr_0 = 2.0706e-04
Loss = 6.7497e-02, PNorm = 44.7325, GNorm = 2.2180, lr_0 = 2.0254e-04
Loss = 5.3389e-02, PNorm = 44.7333, GNorm = 1.5597, lr_0 = 2.0209e-04
Validation rmse = 0.073857
Validation r2 = 0.960779
Validation mse = 0.005455
Epoch 40
Loss = 6.6771e-02, PNorm = 44.7413, GNorm = 0.4567, lr_0 = 1.9769e-04
Validation rmse = 0.083412
Validation r2 = 0.949974
Validation mse = 0.006958
Epoch 41
Loss = 4.4663e-02, PNorm = 44.7470, GNorm = 1.3424, lr_0 = 1.9337e-04
Loss = 5.8234e-02, PNorm = 44.7539, GNorm = 0.9208, lr_0 = 1.8916e-04
Validation rmse = 0.070810
Validation r2 = 0.963948
Validation mse = 0.005014
Epoch 42
Loss = 7.3180e-02, PNorm = 44.7613, GNorm = 1.7476, lr_0 = 1.8462e-04
Loss = 5.7943e-02, PNorm = 44.7682, GNorm = 1.3616, lr_0 = 1.8059e-04
Validation rmse = 0.068227
Validation r2 = 0.966530
Validation mse = 0.004655
Epoch 43
Loss = 4.6965e-02, PNorm = 44.7752, GNorm = 0.8699, lr_0 = 1.7666e-04
Loss = 6.1405e-02, PNorm = 44.7814, GNorm = 0.8500, lr_0 = 1.7280e-04
Validation rmse = 0.062537
Validation r2 = 0.971881
Validation mse = 0.003911
Epoch 44
Loss = 6.9637e-02, PNorm = 44.7878, GNorm = 1.2940, lr_0 = 1.6866e-04
Loss = 5.8470e-02, PNorm = 44.7941, GNorm = 0.7998, lr_0 = 1.6498e-04
Validation rmse = 0.077128
Validation r2 = 0.957227
Validation mse = 0.005949
Epoch 45
Loss = 4.8094e-02, PNorm = 44.7990, GNorm = 0.8364, lr_0 = 1.6138e-04
Loss = 5.9393e-02, PNorm = 44.8028, GNorm = 0.7085, lr_0 = 1.5786e-04
Validation rmse = 0.064166
Validation r2 = 0.970396
Validation mse = 0.004117
Epoch 46
Loss = 5.5856e-02, PNorm = 44.8105, GNorm = 0.6486, lr_0 = 1.5408e-04
Loss = 5.0448e-02, PNorm = 44.8147, GNorm = 0.8180, lr_0 = 1.5072e-04
Validation rmse = 0.078516
Validation r2 = 0.955674
Validation mse = 0.006165
Epoch 47
Loss = 4.5156e-02, PNorm = 44.8191, GNorm = 0.7794, lr_0 = 1.4743e-04
Validation rmse = 0.065344
Validation r2 = 0.969299
Validation mse = 0.004270
Epoch 48
Loss = 4.5770e-02, PNorm = 44.8239, GNorm = 1.3938, lr_0 = 1.4390e-04
Loss = 5.4756e-02, PNorm = 44.8286, GNorm = 1.4715, lr_0 = 1.4076e-04
Validation rmse = 0.077171
Validation r2 = 0.957179
Validation mse = 0.005955
Epoch 49
Loss = 4.5377e-02, PNorm = 44.8333, GNorm = 1.4170, lr_0 = 1.3769e-04
Loss = 4.7874e-02, PNorm = 44.8379, GNorm = 0.8535, lr_0 = 1.3468e-04
Validation rmse = 0.074478
Validation r2 = 0.960116
Validation mse = 0.005547
Epoch 50
Loss = 4.5404e-02, PNorm = 44.8427, GNorm = 1.2573, lr_0 = 1.3174e-04
Loss = 4.8788e-02, PNorm = 44.8476, GNorm = 1.1989, lr_0 = 1.2887e-04
Validation rmse = 0.068465
Validation r2 = 0.966296
Validation mse = 0.004688
Epoch 51
Loss = 5.0415e-02, PNorm = 44.8522, GNorm = 0.5369, lr_0 = 1.2578e-04
Loss = 4.9424e-02, PNorm = 44.8562, GNorm = 0.8549, lr_0 = 1.2304e-04
Validation rmse = 0.060970
Validation r2 = 0.973271
Validation mse = 0.003717
Epoch 52
Loss = 5.4457e-02, PNorm = 44.8611, GNorm = 0.8930, lr_0 = 1.2035e-04
Loss = 5.1613e-02, PNorm = 44.8657, GNorm = 0.8813, lr_0 = 1.1773e-04
Validation rmse = 0.082773
Validation r2 = 0.950737
Validation mse = 0.006851
Epoch 53
Loss = 5.0037e-02, PNorm = 44.8697, GNorm = 0.9382, lr_0 = 1.1491e-04
Loss = 5.4407e-02, PNorm = 44.8745, GNorm = 0.9406, lr_0 = 1.1240e-04
Validation rmse = 0.062041
Validation r2 = 0.972325
Validation mse = 0.003849
Epoch 54
Loss = 5.0826e-02, PNorm = 44.8787, GNorm = 1.1488, lr_0 = 1.0995e-04
Validation rmse = 0.063979
Validation r2 = 0.970568
Validation mse = 0.004093
Epoch 55
Loss = 4.2342e-02, PNorm = 44.8826, GNorm = 1.1928, lr_0 = 1.0731e-04
Loss = 5.1822e-02, PNorm = 44.8868, GNorm = 0.7657, lr_0 = 1.0497e-04
Validation rmse = 0.060428
Validation r2 = 0.973745
Validation mse = 0.003652
Epoch 56
Loss = 5.5073e-02, PNorm = 44.8905, GNorm = 1.0759, lr_0 = 1.0268e-04
Loss = 4.7819e-02, PNorm = 44.8940, GNorm = 0.7578, lr_0 = 1.0044e-04
Validation rmse = 0.072867
Validation r2 = 0.961823
Validation mse = 0.005310
Epoch 57
Loss = 5.5777e-02, PNorm = 44.8975, GNorm = 0.9490, lr_0 = 1.0000e-04
Loss = 4.7402e-02, PNorm = 44.9017, GNorm = 1.3668, lr_0 = 1.0000e-04
Validation rmse = 0.061946
Validation r2 = 0.972409
Validation mse = 0.003837
Epoch 58
Loss = 4.7965e-02, PNorm = 44.9047, GNorm = 2.1865, lr_0 = 1.0000e-04
Loss = 4.5925e-02, PNorm = 44.9077, GNorm = 0.9759, lr_0 = 1.0000e-04
Validation rmse = 0.072972
Validation r2 = 0.961713
Validation mse = 0.005325
Epoch 59
Loss = 4.7897e-02, PNorm = 44.9113, GNorm = 1.0849, lr_0 = 1.0000e-04
Loss = 4.9999e-02, PNorm = 44.9153, GNorm = 2.7126, lr_0 = 1.0000e-04
Validation rmse = 0.063710
Validation r2 = 0.970816
Validation mse = 0.004059
Model 0 best validation rmse = 0.058714 on epoch 30
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.338420
Model 0 test r2 = -1.905102
Model 0 test mse = 0.114528
Ensemble test rmse = 0.338420
Ensemble test r2 = -1.905102
Ensemble test mse = 0.114528
10-fold cross validation
	Seed 0 ==> test rmse = 0.261058
	Seed 0 ==> test r2 = -0.728717
	Seed 0 ==> test mse = 0.068151
	Seed 1 ==> test rmse = 0.267589
	Seed 1 ==> test r2 = -0.816286
	Seed 1 ==> test mse = 0.071604
	Seed 2 ==> test rmse = 0.289844
	Seed 2 ==> test r2 = -1.130963
	Seed 2 ==> test mse = 0.084009
	Seed 3 ==> test rmse = 0.285971
	Seed 3 ==> test r2 = -1.074407
	Seed 3 ==> test mse = 0.081780
	Seed 4 ==> test rmse = 0.340739
	Seed 4 ==> test r2 = -1.945043
	Seed 4 ==> test mse = 0.116103
	Seed 5 ==> test rmse = 0.332534
	Seed 5 ==> test r2 = -1.804917
	Seed 5 ==> test mse = 0.110579
	Seed 6 ==> test rmse = 0.227942
	Seed 6 ==> test r2 = -0.317944
	Seed 6 ==> test mse = 0.051957
	Seed 7 ==> test rmse = 0.312423
	Seed 7 ==> test r2 = -1.475914
	Seed 7 ==> test mse = 0.097608
	Seed 8 ==> test rmse = 0.289100
	Seed 8 ==> test r2 = -1.120039
	Seed 8 ==> test mse = 0.083579
	Seed 9 ==> test rmse = 0.338420
	Seed 9 ==> test r2 = -1.905102
	Seed 9 ==> test mse = 0.114528
Overall test rmse = 0.294562 +/- 0.034973
Overall test r2 = -1.231933 +/- 0.515598
Overall test mse = 0.087990 +/- 0.020326
Elapsed time = 0:07:14
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-05d85262-3219-459a-86b2-5360cba4da72.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/MeCN_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2', 'mse'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2', 'mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/MeCN_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/MeCN_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 916 | train size = 906 | val size = 10 | test size = 116
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.1066e-01, PNorm = 43.2648, GNorm = 2.0844, lr_0 = 3.7500e-04
Validation rmse = 0.353156
Validation r2 = 0.171088
Validation mse = 0.124719
Epoch 1
Loss = 8.9916e-01, PNorm = 43.2928, GNorm = 9.2525, lr_0 = 6.5000e-04
Loss = 5.9269e-01, PNorm = 43.3377, GNorm = 7.3462, lr_0 = 9.0000e-04
Validation rmse = 0.233684
Validation r2 = 0.637063
Validation mse = 0.054608
Epoch 2
Loss = 5.1726e-01, PNorm = 43.4122, GNorm = 2.2691, lr_0 = 9.8468e-04
Loss = 3.9248e-01, PNorm = 43.4932, GNorm = 10.8177, lr_0 = 9.6320e-04
Validation rmse = 0.290787
Validation r2 = 0.438016
Validation mse = 0.084557
Epoch 3
Loss = 3.8181e-01, PNorm = 43.5765, GNorm = 1.3302, lr_0 = 9.4011e-04
Loss = 3.7524e-01, PNorm = 43.6484, GNorm = 2.5122, lr_0 = 9.1961e-04
Validation rmse = 0.241476
Validation r2 = 0.612454
Validation mse = 0.058311
Epoch 4
Loss = 3.2330e-01, PNorm = 43.7141, GNorm = 0.4965, lr_0 = 8.9756e-04
Loss = 3.2667e-01, PNorm = 43.7685, GNorm = 6.5923, lr_0 = 8.7798e-04
Loss = 3.3464e-01, PNorm = 43.7754, GNorm = 5.7109, lr_0 = 8.7605e-04
Validation rmse = 0.202792
Validation r2 = 0.726677
Validation mse = 0.041125
Epoch 5
Loss = 2.3384e-01, PNorm = 43.8293, GNorm = 2.2712, lr_0 = 8.5694e-04
Validation rmse = 0.132110
Validation r2 = 0.884003
Validation mse = 0.017453
Epoch 6
Loss = 1.8450e-01, PNorm = 43.8766, GNorm = 1.3392, lr_0 = 8.3640e-04
Loss = 2.0030e-01, PNorm = 43.9210, GNorm = 5.5669, lr_0 = 8.1815e-04
Validation rmse = 0.148075
Validation r2 = 0.854273
Validation mse = 0.021926
Epoch 7
Loss = 1.6917e-01, PNorm = 43.9566, GNorm = 4.4457, lr_0 = 7.9854e-04
Loss = 1.8206e-01, PNorm = 43.9879, GNorm = 1.0202, lr_0 = 7.8112e-04
Validation rmse = 0.139039
Validation r2 = 0.871517
Validation mse = 0.019332
Epoch 8
Loss = 1.6952e-01, PNorm = 44.0195, GNorm = 1.6454, lr_0 = 7.6240e-04
Loss = 1.3492e-01, PNorm = 44.0431, GNorm = 2.3217, lr_0 = 7.4577e-04
Validation rmse = 0.184313
Validation r2 = 0.774219
Validation mse = 0.033971
Epoch 9
Loss = 1.3988e-01, PNorm = 44.0729, GNorm = 0.8017, lr_0 = 7.2950e-04
Loss = 1.4864e-01, PNorm = 44.0938, GNorm = 3.9126, lr_0 = 7.1359e-04
Validation rmse = 0.199952
Validation r2 = 0.734279
Validation mse = 0.039981
Epoch 10
Loss = 1.3391e-01, PNorm = 44.1198, GNorm = 3.9684, lr_0 = 6.9649e-04
Validation rmse = 0.155887
Validation r2 = 0.838492
Validation mse = 0.024301
Epoch 11
Loss = 1.1341e-01, PNorm = 44.1395, GNorm = 2.0183, lr_0 = 6.7979e-04
Loss = 1.3154e-01, PNorm = 44.1603, GNorm = 1.2542, lr_0 = 6.6496e-04
Validation rmse = 0.153080
Validation r2 = 0.844255
Validation mse = 0.023434
Epoch 12
Loss = 1.7912e-01, PNorm = 44.1813, GNorm = 2.4919, lr_0 = 6.4902e-04
Loss = 1.1157e-01, PNorm = 44.2035, GNorm = 2.1455, lr_0 = 6.3487e-04
Validation rmse = 0.183928
Validation r2 = 0.775162
Validation mse = 0.033829
Epoch 13
Loss = 1.2342e-01, PNorm = 44.2189, GNorm = 2.8251, lr_0 = 6.1965e-04
Loss = 1.4266e-01, PNorm = 44.2387, GNorm = 3.1562, lr_0 = 6.0613e-04
Validation rmse = 0.176506
Validation r2 = 0.792942
Validation mse = 0.031154
Epoch 14
Loss = 1.5608e-01, PNorm = 44.2582, GNorm = 6.6604, lr_0 = 5.9160e-04
Loss = 1.3039e-01, PNorm = 44.2823, GNorm = 0.9667, lr_0 = 5.7870e-04
Validation rmse = 0.165596
Validation r2 = 0.817748
Validation mse = 0.027422
Epoch 15
Loss = 1.1419e-01, PNorm = 44.3054, GNorm = 1.3770, lr_0 = 5.6483e-04
Validation rmse = 0.143284
Validation r2 = 0.863551
Validation mse = 0.020530
Epoch 16
Loss = 1.4349e-01, PNorm = 44.3230, GNorm = 2.3796, lr_0 = 5.5129e-04
Loss = 9.9225e-02, PNorm = 44.3374, GNorm = 2.1570, lr_0 = 5.3926e-04
Validation rmse = 0.172516
Validation r2 = 0.802197
Validation mse = 0.029762
Epoch 17
Loss = 8.7755e-02, PNorm = 44.3528, GNorm = 1.4950, lr_0 = 5.2750e-04
Loss = 1.1455e-01, PNorm = 44.3658, GNorm = 2.0671, lr_0 = 5.1599e-04
Validation rmse = 0.152609
Validation r2 = 0.845213
Validation mse = 0.023289
Epoch 18
Loss = 1.2243e-01, PNorm = 44.3858, GNorm = 0.9064, lr_0 = 5.0362e-04
Loss = 9.4957e-02, PNorm = 44.4032, GNorm = 0.7093, lr_0 = 4.9264e-04
Validation rmse = 0.153375
Validation r2 = 0.843655
Validation mse = 0.023524
Epoch 19
Loss = 1.0595e-01, PNorm = 44.4175, GNorm = 0.8117, lr_0 = 4.8083e-04
Loss = 1.0398e-01, PNorm = 44.4300, GNorm = 1.5661, lr_0 = 4.7034e-04
Validation rmse = 0.152001
Validation r2 = 0.846445
Validation mse = 0.023104
Epoch 20
Loss = 1.0994e-01, PNorm = 44.4431, GNorm = 2.3532, lr_0 = 4.5907e-04
Loss = 1.1327e-01, PNorm = 44.4580, GNorm = 0.9707, lr_0 = 4.4905e-04
Loss = 6.8794e-02, PNorm = 44.4599, GNorm = 1.5344, lr_0 = 4.4806e-04
Validation rmse = 0.148297
Validation r2 = 0.853836
Validation mse = 0.021992
Epoch 21
Loss = 9.3640e-02, PNorm = 44.4752, GNorm = 1.0787, lr_0 = 4.3829e-04
Validation rmse = 0.153613
Validation r2 = 0.843170
Validation mse = 0.023597
Epoch 22
Loss = 1.1273e-01, PNorm = 44.4895, GNorm = 1.3388, lr_0 = 4.2779e-04
Loss = 1.0897e-01, PNorm = 44.5031, GNorm = 1.9836, lr_0 = 4.1845e-04
Validation rmse = 0.150638
Validation r2 = 0.849186
Validation mse = 0.022692
Epoch 23
Loss = 1.1118e-01, PNorm = 44.5178, GNorm = 0.5102, lr_0 = 4.0842e-04
Loss = 1.1051e-01, PNorm = 44.5321, GNorm = 0.5637, lr_0 = 3.9951e-04
Validation rmse = 0.174586
Validation r2 = 0.797423
Validation mse = 0.030480
Epoch 24
Loss = 1.6091e-01, PNorm = 44.5484, GNorm = 2.7164, lr_0 = 3.8994e-04
Loss = 1.0846e-01, PNorm = 44.5657, GNorm = 1.6511, lr_0 = 3.8143e-04
Validation rmse = 0.163872
Validation r2 = 0.821523
Validation mse = 0.026854
Epoch 25
Loss = 9.6856e-02, PNorm = 44.5783, GNorm = 2.2575, lr_0 = 3.7311e-04
Loss = 1.0454e-01, PNorm = 44.5902, GNorm = 1.9515, lr_0 = 3.6497e-04
Validation rmse = 0.145378
Validation r2 = 0.859535
Validation mse = 0.021135
Epoch 26
Loss = 7.7935e-02, PNorm = 44.6039, GNorm = 0.4611, lr_0 = 3.5622e-04
Validation rmse = 0.136803
Validation r2 = 0.875616
Validation mse = 0.018715
Epoch 27
Loss = 1.0023e-01, PNorm = 44.6143, GNorm = 1.2007, lr_0 = 3.4769e-04
Loss = 8.5849e-02, PNorm = 44.6227, GNorm = 1.2531, lr_0 = 3.4010e-04
Validation rmse = 0.163717
Validation r2 = 0.821861
Validation mse = 0.026803
Epoch 28
Loss = 1.0262e-01, PNorm = 44.6340, GNorm = 2.3820, lr_0 = 3.3195e-04
Loss = 1.1559e-01, PNorm = 44.6445, GNorm = 2.9437, lr_0 = 3.2471e-04
Validation rmse = 0.143104
Validation r2 = 0.863893
Validation mse = 0.020479
Epoch 29
Loss = 1.1487e-01, PNorm = 44.6584, GNorm = 0.9515, lr_0 = 3.1693e-04
Loss = 9.8885e-02, PNorm = 44.6705, GNorm = 1.3347, lr_0 = 3.1001e-04
Validation rmse = 0.134139
Validation r2 = 0.880414
Validation mse = 0.017993
Epoch 30
Loss = 1.0800e-01, PNorm = 44.6832, GNorm = 1.8801, lr_0 = 3.0258e-04
Loss = 9.0352e-02, PNorm = 44.6935, GNorm = 0.4617, lr_0 = 2.9598e-04
Validation rmse = 0.138956
Validation r2 = 0.871670
Validation mse = 0.019309
Epoch 31
Loss = 9.0073e-02, PNorm = 44.7104, GNorm = 0.5525, lr_0 = 2.8889e-04
Validation rmse = 0.129979
Validation r2 = 0.887716
Validation mse = 0.016894
Epoch 32
Loss = 7.0311e-02, PNorm = 44.7201, GNorm = 1.4677, lr_0 = 2.8196e-04
Loss = 7.4066e-02, PNorm = 44.7273, GNorm = 0.5978, lr_0 = 2.7581e-04
Validation rmse = 0.145593
Validation r2 = 0.859118
Validation mse = 0.021197
Epoch 33
Loss = 7.8882e-02, PNorm = 44.7354, GNorm = 0.6012, lr_0 = 2.6920e-04
Loss = 8.0302e-02, PNorm = 44.7435, GNorm = 1.7448, lr_0 = 2.6333e-04
Validation rmse = 0.130324
Validation r2 = 0.887119
Validation mse = 0.016984
Epoch 34
Loss = 6.5656e-02, PNorm = 44.7499, GNorm = 0.8917, lr_0 = 2.5758e-04
Loss = 8.1427e-02, PNorm = 44.7587, GNorm = 0.9823, lr_0 = 2.5197e-04
Validation rmse = 0.141262
Validation r2 = 0.867375
Validation mse = 0.019955
Epoch 35
Loss = 6.8930e-02, PNorm = 44.7665, GNorm = 1.8848, lr_0 = 2.4593e-04
Loss = 7.1303e-02, PNorm = 44.7741, GNorm = 0.8717, lr_0 = 2.4056e-04
Validation rmse = 0.132474
Validation r2 = 0.883364
Validation mse = 0.017549
Epoch 36
Loss = 6.5792e-02, PNorm = 44.7813, GNorm = 0.9602, lr_0 = 2.3480e-04
Loss = 7.7254e-02, PNorm = 44.7878, GNorm = 0.6121, lr_0 = 2.2967e-04
Loss = 2.5203e-02, PNorm = 44.7885, GNorm = 1.3618, lr_0 = 2.2917e-04
Validation rmse = 0.134046
Validation r2 = 0.880579
Validation mse = 0.017968
Epoch 37
Loss = 7.0746e-02, PNorm = 44.7961, GNorm = 0.7578, lr_0 = 2.2417e-04
Validation rmse = 0.146073
Validation r2 = 0.858189
Validation mse = 0.021337
Epoch 38
Loss = 4.4493e-02, PNorm = 44.8053, GNorm = 0.6580, lr_0 = 2.1880e-04
Loss = 7.5364e-02, PNorm = 44.8122, GNorm = 1.4958, lr_0 = 2.1402e-04
Validation rmse = 0.137837
Validation r2 = 0.873728
Validation mse = 0.018999
Epoch 39
Loss = 6.7446e-02, PNorm = 44.8204, GNorm = 1.3580, lr_0 = 2.0889e-04
Loss = 6.8380e-02, PNorm = 44.8288, GNorm = 1.7436, lr_0 = 2.0434e-04
Validation rmse = 0.126225
Validation r2 = 0.894108
Validation mse = 0.015933
Epoch 40
Loss = 6.8781e-02, PNorm = 44.8350, GNorm = 0.5782, lr_0 = 1.9944e-04
Loss = 7.3559e-02, PNorm = 44.8415, GNorm = 0.7331, lr_0 = 1.9509e-04
Validation rmse = 0.139440
Validation r2 = 0.870775
Validation mse = 0.019443
Epoch 41
Loss = 7.5155e-02, PNorm = 44.8475, GNorm = 0.6533, lr_0 = 1.9041e-04
Loss = 6.1345e-02, PNorm = 44.8543, GNorm = 0.5981, lr_0 = 1.8626e-04
Validation rmse = 0.140115
Validation r2 = 0.869521
Validation mse = 0.019632
Epoch 42
Loss = 6.7441e-02, PNorm = 44.8595, GNorm = 0.7034, lr_0 = 1.8219e-04
Validation rmse = 0.161553
Validation r2 = 0.826539
Validation mse = 0.026099
Epoch 43
Loss = 5.3646e-02, PNorm = 44.8667, GNorm = 1.3276, lr_0 = 1.7783e-04
Loss = 6.8800e-02, PNorm = 44.8709, GNorm = 1.0326, lr_0 = 1.7395e-04
Validation rmse = 0.137551
Validation r2 = 0.874252
Validation mse = 0.018920
Epoch 44
Loss = 5.7544e-02, PNorm = 44.8784, GNorm = 0.5258, lr_0 = 1.6978e-04
Loss = 6.8252e-02, PNorm = 44.8839, GNorm = 1.6003, lr_0 = 1.6608e-04
Validation rmse = 0.142885
Validation r2 = 0.864311
Validation mse = 0.020416
Epoch 45
Loss = 6.2271e-02, PNorm = 44.8895, GNorm = 0.5108, lr_0 = 1.6210e-04
Loss = 6.2566e-02, PNorm = 44.8939, GNorm = 0.6984, lr_0 = 1.5856e-04
Validation rmse = 0.139110
Validation r2 = 0.871385
Validation mse = 0.019352
Epoch 46
Loss = 6.6026e-02, PNorm = 44.9013, GNorm = 0.5110, lr_0 = 1.5476e-04
Loss = 5.6027e-02, PNorm = 44.9060, GNorm = 0.4591, lr_0 = 1.5138e-04
Validation rmse = 0.137089
Validation r2 = 0.875094
Validation mse = 0.018793
Epoch 47
Loss = 5.7264e-02, PNorm = 44.9115, GNorm = 1.0564, lr_0 = 1.4775e-04
Validation rmse = 0.137338
Validation r2 = 0.874641
Validation mse = 0.018862
Epoch 48
Loss = 7.5445e-02, PNorm = 44.9178, GNorm = 0.9365, lr_0 = 1.4421e-04
Loss = 6.3378e-02, PNorm = 44.9228, GNorm = 1.4193, lr_0 = 1.4107e-04
Validation rmse = 0.135112
Validation r2 = 0.878672
Validation mse = 0.018255
Epoch 49
Loss = 5.9789e-02, PNorm = 44.9274, GNorm = 1.3038, lr_0 = 1.3769e-04
Loss = 5.5842e-02, PNorm = 44.9342, GNorm = 1.1207, lr_0 = 1.3468e-04
Validation rmse = 0.140112
Validation r2 = 0.869527
Validation mse = 0.019631
Epoch 50
Loss = 6.7386e-02, PNorm = 44.9382, GNorm = 1.0767, lr_0 = 1.3174e-04
Loss = 5.4990e-02, PNorm = 44.9420, GNorm = 0.9369, lr_0 = 1.2887e-04
Validation rmse = 0.148890
Validation r2 = 0.852665
Validation mse = 0.022168
Epoch 51
Loss = 6.1013e-02, PNorm = 44.9472, GNorm = 0.6561, lr_0 = 1.2578e-04
Loss = 5.7384e-02, PNorm = 44.9524, GNorm = 0.7812, lr_0 = 1.2304e-04
Validation rmse = 0.134728
Validation r2 = 0.879360
Validation mse = 0.018152
Epoch 52
Loss = 5.5089e-02, PNorm = 44.9578, GNorm = 1.2124, lr_0 = 1.2009e-04
Loss = 5.8685e-02, PNorm = 44.9623, GNorm = 0.7804, lr_0 = 1.1747e-04
Loss = 2.5119e-01, PNorm = 44.9627, GNorm = 4.6219, lr_0 = 1.1721e-04
Validation rmse = 0.138728
Validation r2 = 0.872090
Validation mse = 0.019246
Epoch 53
Loss = 6.0509e-02, PNorm = 44.9693, GNorm = 1.4026, lr_0 = 1.1465e-04
Validation rmse = 0.134207
Validation r2 = 0.880292
Validation mse = 0.018011
Epoch 54
Loss = 5.8015e-02, PNorm = 44.9733, GNorm = 0.4566, lr_0 = 1.1191e-04
Loss = 5.4561e-02, PNorm = 44.9782, GNorm = 0.6730, lr_0 = 1.0946e-04
Validation rmse = 0.139505
Validation r2 = 0.870654
Validation mse = 0.019462
Epoch 55
Loss = 5.0130e-02, PNorm = 44.9829, GNorm = 0.4523, lr_0 = 1.0684e-04
Loss = 5.7549e-02, PNorm = 44.9865, GNorm = 1.2311, lr_0 = 1.0451e-04
Validation rmse = 0.135350
Validation r2 = 0.878244
Validation mse = 0.018320
Epoch 56
Loss = 5.7558e-02, PNorm = 44.9905, GNorm = 0.5331, lr_0 = 1.0200e-04
Loss = 5.1808e-02, PNorm = 44.9945, GNorm = 0.7236, lr_0 = 1.0000e-04
Validation rmse = 0.143466
Validation r2 = 0.863204
Validation mse = 0.020583
Epoch 57
Loss = 5.5568e-02, PNorm = 44.9978, GNorm = 1.6162, lr_0 = 1.0000e-04
Loss = 5.4361e-02, PNorm = 45.0016, GNorm = 0.8778, lr_0 = 1.0000e-04
Loss = 5.5874e-03, PNorm = 45.0021, GNorm = 0.4951, lr_0 = 1.0000e-04
Validation rmse = 0.134934
Validation r2 = 0.878990
Validation mse = 0.018207
Epoch 58
Loss = 5.3461e-02, PNorm = 45.0062, GNorm = 0.6890, lr_0 = 1.0000e-04
Validation rmse = 0.132482
Validation r2 = 0.883350
Validation mse = 0.017551
Epoch 59
Loss = 4.9109e-02, PNorm = 45.0090, GNorm = 0.6199, lr_0 = 1.0000e-04
Loss = 5.8209e-02, PNorm = 45.0131, GNorm = 1.3351, lr_0 = 1.0000e-04
Validation rmse = 0.136200
Validation r2 = 0.876711
Validation mse = 0.018550
Model 0 best validation rmse = 0.126225 on epoch 39
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.154540
Model 0 test r2 = 0.301465
Model 0 test mse = 0.023883
Ensemble test rmse = 0.154540
Ensemble test r2 = 0.301465
Ensemble test mse = 0.023883
Fold 1
Splitting data with seed 1
Total size = 916 | train size = 906 | val size = 10 | test size = 116
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.4469e-01, PNorm = 43.2630, GNorm = 3.0456, lr_0 = 3.7500e-04
Validation rmse = 0.328449
Validation r2 = 0.403808
Validation mse = 0.107878
Epoch 1
Loss = 9.2463e-01, PNorm = 43.2882, GNorm = 15.8475, lr_0 = 6.5000e-04
Loss = 7.2346e-01, PNorm = 43.3265, GNorm = 3.7036, lr_0 = 9.0000e-04
Validation rmse = 0.307406
Validation r2 = 0.477754
Validation mse = 0.094498
Epoch 2
Loss = 5.2692e-01, PNorm = 43.4014, GNorm = 4.3281, lr_0 = 9.8468e-04
Loss = 5.7477e-01, PNorm = 43.4722, GNorm = 7.5742, lr_0 = 9.6320e-04
Validation rmse = 0.283873
Validation r2 = 0.554653
Validation mse = 0.080584
Epoch 3
Loss = 3.1264e-01, PNorm = 43.5524, GNorm = 1.5226, lr_0 = 9.4011e-04
Loss = 4.0636e-01, PNorm = 43.6183, GNorm = 7.8482, lr_0 = 9.1961e-04
Validation rmse = 0.227332
Validation r2 = 0.714389
Validation mse = 0.051680
Epoch 4
Loss = 2.4166e-01, PNorm = 43.6869, GNorm = 0.6157, lr_0 = 8.9756e-04
Loss = 2.5728e-01, PNorm = 43.7430, GNorm = 8.9347, lr_0 = 8.7798e-04
Loss = 1.2516e-01, PNorm = 43.7480, GNorm = 3.8840, lr_0 = 8.7605e-04
Validation rmse = 0.215643
Validation r2 = 0.743006
Validation mse = 0.046502
Epoch 5
Loss = 2.5635e-01, PNorm = 43.7887, GNorm = 1.0365, lr_0 = 8.5694e-04
Validation rmse = 0.143936
Validation r2 = 0.885504
Validation mse = 0.020718
Epoch 6
Loss = 2.0616e-01, PNorm = 43.8382, GNorm = 1.2792, lr_0 = 8.3640e-04
Loss = 2.2137e-01, PNorm = 43.8768, GNorm = 4.0660, lr_0 = 8.1815e-04
Validation rmse = 0.128593
Validation r2 = 0.908613
Validation mse = 0.016536
Epoch 7
Loss = 2.0456e-01, PNorm = 43.9111, GNorm = 6.3512, lr_0 = 7.9854e-04
Loss = 1.6869e-01, PNorm = 43.9452, GNorm = 1.0293, lr_0 = 7.8112e-04
Validation rmse = 0.146778
Validation r2 = 0.880937
Validation mse = 0.021544
Epoch 8
Loss = 1.5876e-01, PNorm = 43.9837, GNorm = 3.0596, lr_0 = 7.6240e-04
Loss = 1.6482e-01, PNorm = 44.0107, GNorm = 0.7865, lr_0 = 7.4577e-04
Validation rmse = 0.116047
Validation r2 = 0.925575
Validation mse = 0.013467
Epoch 9
Loss = 1.6055e-01, PNorm = 44.0403, GNorm = 0.7100, lr_0 = 7.2950e-04
Loss = 1.3260e-01, PNorm = 44.0641, GNorm = 0.9350, lr_0 = 7.1359e-04
Validation rmse = 0.199975
Validation r2 = 0.778995
Validation mse = 0.039990
Epoch 10
Loss = 2.1409e-01, PNorm = 44.0874, GNorm = 6.5369, lr_0 = 6.9649e-04
Validation rmse = 0.175666
Validation r2 = 0.829459
Validation mse = 0.030859
Epoch 11
Loss = 2.5462e-01, PNorm = 44.1109, GNorm = 6.0125, lr_0 = 6.7979e-04
Loss = 1.7229e-01, PNorm = 44.1479, GNorm = 3.2479, lr_0 = 6.6496e-04
Validation rmse = 0.128596
Validation r2 = 0.908609
Validation mse = 0.016537
Epoch 12
Loss = 1.6171e-01, PNorm = 44.1814, GNorm = 0.6163, lr_0 = 6.4902e-04
Loss = 1.1910e-01, PNorm = 44.2011, GNorm = 0.9158, lr_0 = 6.3487e-04
Validation rmse = 0.109086
Validation r2 = 0.934236
Validation mse = 0.011900
Epoch 13
Loss = 1.2340e-01, PNorm = 44.2218, GNorm = 2.0672, lr_0 = 6.1965e-04
Loss = 1.2474e-01, PNorm = 44.2401, GNorm = 1.9885, lr_0 = 6.0613e-04
Validation rmse = 0.103841
Validation r2 = 0.940407
Validation mse = 0.010783
Epoch 14
Loss = 1.0482e-01, PNorm = 44.2571, GNorm = 0.6525, lr_0 = 5.9160e-04
Loss = 1.1764e-01, PNorm = 44.2738, GNorm = 0.6320, lr_0 = 5.7870e-04
Validation rmse = 0.111603
Validation r2 = 0.931165
Validation mse = 0.012455
Epoch 15
Loss = 1.1096e-01, PNorm = 44.2931, GNorm = 0.5046, lr_0 = 5.6483e-04
Validation rmse = 0.136766
Validation r2 = 0.896627
Validation mse = 0.018705
Epoch 16
Loss = 6.7228e-02, PNorm = 44.3117, GNorm = 1.6484, lr_0 = 5.5129e-04
Loss = 1.5234e-01, PNorm = 44.3283, GNorm = 5.3042, lr_0 = 5.3926e-04
Validation rmse = 0.091692
Validation r2 = 0.953536
Validation mse = 0.008408
Epoch 17
Loss = 1.1463e-01, PNorm = 44.3454, GNorm = 0.9586, lr_0 = 5.2750e-04
Loss = 1.2290e-01, PNorm = 44.3650, GNorm = 1.7158, lr_0 = 5.1599e-04
Validation rmse = 0.099197
Validation r2 = 0.945619
Validation mse = 0.009840
Epoch 18
Loss = 1.1341e-01, PNorm = 44.3784, GNorm = 2.1357, lr_0 = 5.0362e-04
Loss = 1.0971e-01, PNorm = 44.3941, GNorm = 2.1174, lr_0 = 4.9264e-04
Validation rmse = 0.110743
Validation r2 = 0.932223
Validation mse = 0.012264
Epoch 19
Loss = 1.0319e-01, PNorm = 44.4071, GNorm = 0.8028, lr_0 = 4.8083e-04
Loss = 1.2534e-01, PNorm = 44.4179, GNorm = 3.0248, lr_0 = 4.7034e-04
Validation rmse = 0.089425
Validation r2 = 0.955805
Validation mse = 0.007997
Epoch 20
Loss = 1.0329e-01, PNorm = 44.4340, GNorm = 2.0810, lr_0 = 4.5907e-04
Loss = 9.7110e-02, PNorm = 44.4469, GNorm = 0.6137, lr_0 = 4.4905e-04
Loss = 6.1716e-02, PNorm = 44.4480, GNorm = 2.9888, lr_0 = 4.4806e-04
Validation rmse = 0.117377
Validation r2 = 0.923859
Validation mse = 0.013777
Epoch 21
Loss = 9.8218e-02, PNorm = 44.4590, GNorm = 0.8365, lr_0 = 4.3829e-04
Validation rmse = 0.086350
Validation r2 = 0.958792
Validation mse = 0.007456
Epoch 22
Loss = 7.5341e-02, PNorm = 44.4676, GNorm = 0.5773, lr_0 = 4.2779e-04
Loss = 1.0741e-01, PNorm = 44.4786, GNorm = 2.5299, lr_0 = 4.1845e-04
Validation rmse = 0.118033
Validation r2 = 0.923006
Validation mse = 0.013932
Epoch 23
Loss = 8.5447e-02, PNorm = 44.4881, GNorm = 0.9721, lr_0 = 4.0842e-04
Loss = 1.0254e-01, PNorm = 44.4997, GNorm = 1.6199, lr_0 = 3.9951e-04
Validation rmse = 0.143798
Validation r2 = 0.885724
Validation mse = 0.020678
Epoch 24
Loss = 1.1976e-01, PNorm = 44.5119, GNorm = 2.2844, lr_0 = 3.8994e-04
Loss = 1.0842e-01, PNorm = 44.5238, GNorm = 1.3645, lr_0 = 3.8143e-04
Validation rmse = 0.115922
Validation r2 = 0.925735
Validation mse = 0.013438
Epoch 25
Loss = 9.9622e-02, PNorm = 44.5354, GNorm = 1.4258, lr_0 = 3.7311e-04
Loss = 9.2500e-02, PNorm = 44.5475, GNorm = 0.5634, lr_0 = 3.6497e-04
Validation rmse = 0.116191
Validation r2 = 0.925390
Validation mse = 0.013500
Epoch 26
Loss = 9.5001e-02, PNorm = 44.5617, GNorm = 0.6577, lr_0 = 3.5622e-04
Validation rmse = 0.098301
Validation r2 = 0.946596
Validation mse = 0.009663
Epoch 27
Loss = 6.5580e-02, PNorm = 44.5728, GNorm = 0.6884, lr_0 = 3.4769e-04
Loss = 8.7740e-02, PNorm = 44.5829, GNorm = 1.1937, lr_0 = 3.4010e-04
Validation rmse = 0.114635
Validation r2 = 0.927375
Validation mse = 0.013141
Epoch 28
Loss = 8.8229e-02, PNorm = 44.5929, GNorm = 0.9561, lr_0 = 3.3195e-04
Loss = 8.3220e-02, PNorm = 44.6051, GNorm = 0.8171, lr_0 = 3.2471e-04
Validation rmse = 0.101450
Validation r2 = 0.943121
Validation mse = 0.010292
Epoch 29
Loss = 7.4574e-02, PNorm = 44.6174, GNorm = 1.1055, lr_0 = 3.1693e-04
Loss = 1.1879e-01, PNorm = 44.6271, GNorm = 4.3356, lr_0 = 3.1001e-04
Validation rmse = 0.109757
Validation r2 = 0.933424
Validation mse = 0.012047
Epoch 30
Loss = 8.9025e-02, PNorm = 44.6374, GNorm = 1.1221, lr_0 = 3.0258e-04
Loss = 8.7891e-02, PNorm = 44.6474, GNorm = 0.9997, lr_0 = 2.9598e-04
Validation rmse = 0.089967
Validation r2 = 0.955268
Validation mse = 0.008094
Epoch 31
Loss = 7.3209e-02, PNorm = 44.6577, GNorm = 0.4813, lr_0 = 2.8889e-04
Validation rmse = 0.116870
Validation r2 = 0.924516
Validation mse = 0.013658
Epoch 32
Loss = 7.3458e-02, PNorm = 44.6672, GNorm = 1.8731, lr_0 = 2.8196e-04
Loss = 1.0317e-01, PNorm = 44.6758, GNorm = 2.8712, lr_0 = 2.7581e-04
Validation rmse = 0.098867
Validation r2 = 0.945980
Validation mse = 0.009775
Epoch 33
Loss = 6.9908e-02, PNorm = 44.6884, GNorm = 0.7269, lr_0 = 2.6920e-04
Loss = 9.1941e-02, PNorm = 44.6962, GNorm = 2.1067, lr_0 = 2.6333e-04
Validation rmse = 0.121307
Validation r2 = 0.918675
Validation mse = 0.014715
Epoch 34
Loss = 1.0432e-01, PNorm = 44.7025, GNorm = 0.9867, lr_0 = 2.5758e-04
Loss = 7.9190e-02, PNorm = 44.7130, GNorm = 0.9595, lr_0 = 2.5197e-04
Validation rmse = 0.091792
Validation r2 = 0.953435
Validation mse = 0.008426
Epoch 35
Loss = 7.5761e-02, PNorm = 44.7204, GNorm = 1.8487, lr_0 = 2.4593e-04
Loss = 7.6039e-02, PNorm = 44.7291, GNorm = 0.4844, lr_0 = 2.4056e-04
Validation rmse = 0.090348
Validation r2 = 0.954889
Validation mse = 0.008163
Epoch 36
Loss = 7.7128e-02, PNorm = 44.7395, GNorm = 1.1826, lr_0 = 2.3480e-04
Loss = 7.9435e-02, PNorm = 44.7478, GNorm = 0.6801, lr_0 = 2.2967e-04
Loss = 1.5115e-02, PNorm = 44.7484, GNorm = 0.8902, lr_0 = 2.2917e-04
Validation rmse = 0.095561
Validation r2 = 0.949533
Validation mse = 0.009132
Epoch 37
Loss = 7.6937e-02, PNorm = 44.7554, GNorm = 1.7051, lr_0 = 2.2417e-04
Validation rmse = 0.089596
Validation r2 = 0.955637
Validation mse = 0.008027
Epoch 38
Loss = 8.0076e-02, PNorm = 44.7619, GNorm = 1.5059, lr_0 = 2.1880e-04
Loss = 8.1867e-02, PNorm = 44.7692, GNorm = 1.3976, lr_0 = 2.1402e-04
Validation rmse = 0.108576
Validation r2 = 0.934849
Validation mse = 0.011789
Epoch 39
Loss = 8.0293e-02, PNorm = 44.7773, GNorm = 0.6972, lr_0 = 2.0889e-04
Loss = 7.2454e-02, PNorm = 44.7849, GNorm = 1.3364, lr_0 = 2.0434e-04
Validation rmse = 0.094874
Validation r2 = 0.950256
Validation mse = 0.009001
Epoch 40
Loss = 7.0154e-02, PNorm = 44.7913, GNorm = 0.5301, lr_0 = 1.9944e-04
Loss = 7.2392e-02, PNorm = 44.7986, GNorm = 0.5993, lr_0 = 1.9509e-04
Validation rmse = 0.107859
Validation r2 = 0.935707
Validation mse = 0.011634
Epoch 41
Loss = 7.7122e-02, PNorm = 44.8068, GNorm = 1.5345, lr_0 = 1.9041e-04
Loss = 7.0575e-02, PNorm = 44.8130, GNorm = 1.4880, lr_0 = 1.8626e-04
Validation rmse = 0.097072
Validation r2 = 0.947924
Validation mse = 0.009423
Epoch 42
Loss = 6.5706e-02, PNorm = 44.8191, GNorm = 0.5483, lr_0 = 1.8219e-04
Validation rmse = 0.086854
Validation r2 = 0.958310
Validation mse = 0.007544
Epoch 43
Loss = 1.0243e-01, PNorm = 44.8270, GNorm = 2.2857, lr_0 = 1.7783e-04
Loss = 6.3052e-02, PNorm = 44.8343, GNorm = 0.5155, lr_0 = 1.7395e-04
Validation rmse = 0.102685
Validation r2 = 0.941727
Validation mse = 0.010544
Epoch 44
Loss = 5.8893e-02, PNorm = 44.8409, GNorm = 0.4978, lr_0 = 1.6978e-04
Loss = 7.0826e-02, PNorm = 44.8473, GNorm = 0.8495, lr_0 = 1.6608e-04
Validation rmse = 0.090159
Validation r2 = 0.955077
Validation mse = 0.008129
Epoch 45
Loss = 7.4689e-02, PNorm = 44.8545, GNorm = 0.6609, lr_0 = 1.6210e-04
Loss = 6.3574e-02, PNorm = 44.8620, GNorm = 1.3161, lr_0 = 1.5856e-04
Validation rmse = 0.087999
Validation r2 = 0.957204
Validation mse = 0.007744
Epoch 46
Loss = 5.6599e-02, PNorm = 44.8678, GNorm = 1.1508, lr_0 = 1.5476e-04
Loss = 6.9047e-02, PNorm = 44.8728, GNorm = 0.4264, lr_0 = 1.5138e-04
Validation rmse = 0.088921
Validation r2 = 0.956302
Validation mse = 0.007907
Epoch 47
Loss = 6.1630e-02, PNorm = 44.8791, GNorm = 0.5120, lr_0 = 1.4775e-04
Validation rmse = 0.091822
Validation r2 = 0.953405
Validation mse = 0.008431
Epoch 48
Loss = 4.0109e-02, PNorm = 44.8851, GNorm = 0.6976, lr_0 = 1.4421e-04
Loss = 6.4412e-02, PNorm = 44.8903, GNorm = 1.5646, lr_0 = 1.4107e-04
Validation rmse = 0.085100
Validation r2 = 0.959977
Validation mse = 0.007242
Epoch 49
Loss = 6.1250e-02, PNorm = 44.8961, GNorm = 0.7378, lr_0 = 1.3769e-04
Loss = 6.2450e-02, PNorm = 44.8999, GNorm = 0.9094, lr_0 = 1.3468e-04
Validation rmse = 0.095263
Validation r2 = 0.949847
Validation mse = 0.009075
Epoch 50
Loss = 5.6243e-02, PNorm = 44.9057, GNorm = 1.6030, lr_0 = 1.3174e-04
Loss = 6.1777e-02, PNorm = 44.9112, GNorm = 0.8592, lr_0 = 1.2887e-04
Validation rmse = 0.103423
Validation r2 = 0.940886
Validation mse = 0.010696
Epoch 51
Loss = 5.5939e-02, PNorm = 44.9161, GNorm = 0.6835, lr_0 = 1.2578e-04
Loss = 6.0495e-02, PNorm = 44.9211, GNorm = 0.7947, lr_0 = 1.2304e-04
Validation rmse = 0.087492
Validation r2 = 0.957695
Validation mse = 0.007655
Epoch 52
Loss = 5.5882e-02, PNorm = 44.9254, GNorm = 0.6045, lr_0 = 1.2009e-04
Loss = 6.1716e-02, PNorm = 44.9308, GNorm = 0.5369, lr_0 = 1.1747e-04
Loss = 4.3671e-02, PNorm = 44.9314, GNorm = 1.3124, lr_0 = 1.1721e-04
Validation rmse = 0.096717
Validation r2 = 0.948304
Validation mse = 0.009354
Epoch 53
Loss = 5.8533e-02, PNorm = 44.9372, GNorm = 0.7492, lr_0 = 1.1465e-04
Validation rmse = 0.092102
Validation r2 = 0.953120
Validation mse = 0.008483
Epoch 54
Loss = 8.4996e-02, PNorm = 44.9420, GNorm = 1.9882, lr_0 = 1.1191e-04
Loss = 5.4778e-02, PNorm = 44.9473, GNorm = 1.0697, lr_0 = 1.0946e-04
Validation rmse = 0.090477
Validation r2 = 0.954759
Validation mse = 0.008186
Epoch 55
Loss = 5.6846e-02, PNorm = 44.9519, GNorm = 0.9764, lr_0 = 1.0684e-04
Loss = 6.3444e-02, PNorm = 44.9561, GNorm = 1.0231, lr_0 = 1.0451e-04
Validation rmse = 0.097664
Validation r2 = 0.947287
Validation mse = 0.009538
Epoch 56
Loss = 5.7724e-02, PNorm = 44.9595, GNorm = 0.8269, lr_0 = 1.0200e-04
Loss = 6.2338e-02, PNorm = 44.9640, GNorm = 1.2709, lr_0 = 1.0000e-04
Validation rmse = 0.087207
Validation r2 = 0.957970
Validation mse = 0.007605
Epoch 57
Loss = 6.2347e-02, PNorm = 44.9687, GNorm = 0.9577, lr_0 = 1.0000e-04
Loss = 5.8753e-02, PNorm = 44.9725, GNorm = 2.2257, lr_0 = 1.0000e-04
Loss = 2.9092e-02, PNorm = 44.9731, GNorm = 1.8786, lr_0 = 1.0000e-04
Validation rmse = 0.087709
Validation r2 = 0.957485
Validation mse = 0.007693
Epoch 58
Loss = 5.5371e-02, PNorm = 44.9771, GNorm = 0.5288, lr_0 = 1.0000e-04
Validation rmse = 0.092087
Validation r2 = 0.953135
Validation mse = 0.008480
Epoch 59
Loss = 5.6501e-02, PNorm = 44.9816, GNorm = 0.3827, lr_0 = 1.0000e-04
Loss = 6.0234e-02, PNorm = 44.9865, GNorm = 0.6573, lr_0 = 1.0000e-04
Validation rmse = 0.092337
Validation r2 = 0.952880
Validation mse = 0.008526
Model 0 best validation rmse = 0.085100 on epoch 48
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.189712
Model 0 test r2 = -0.052682
Model 0 test mse = 0.035991
Ensemble test rmse = 0.189712
Ensemble test r2 = -0.052682
Ensemble test mse = 0.035991
Fold 2
Splitting data with seed 2
Total size = 916 | train size = 906 | val size = 10 | test size = 116
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.2351e-01, PNorm = 43.2647, GNorm = 4.4280, lr_0 = 3.7500e-04
Validation rmse = 0.227814
Validation r2 = 0.080302
Validation mse = 0.051899
Epoch 1
Loss = 5.5444e-01, PNorm = 43.2926, GNorm = 7.1856, lr_0 = 6.5000e-04
Loss = 7.7913e-01, PNorm = 43.3232, GNorm = 1.8095, lr_0 = 9.0000e-04
Validation rmse = 0.171773
Validation r2 = 0.477129
Validation mse = 0.029506
Epoch 2
Loss = 6.5971e-01, PNorm = 43.3866, GNorm = 7.1756, lr_0 = 9.8468e-04
Loss = 6.1326e-01, PNorm = 43.4515, GNorm = 3.2417, lr_0 = 9.6320e-04
Validation rmse = 0.240740
Validation r2 = -0.027025
Validation mse = 0.057956
Epoch 3
Loss = 4.8806e-01, PNorm = 43.5307, GNorm = 0.9854, lr_0 = 9.4011e-04
Loss = 3.6052e-01, PNorm = 43.6079, GNorm = 1.2024, lr_0 = 9.1961e-04
Validation rmse = 0.146297
Validation r2 = 0.620724
Validation mse = 0.021403
Epoch 4
Loss = 2.8589e-01, PNorm = 43.6872, GNorm = 3.6107, lr_0 = 8.9756e-04
Loss = 3.0505e-01, PNorm = 43.7427, GNorm = 5.7249, lr_0 = 8.7798e-04
Loss = 1.8244e-01, PNorm = 43.7474, GNorm = 3.1326, lr_0 = 8.7605e-04
Validation rmse = 0.183144
Validation r2 = 0.405615
Validation mse = 0.033542
Epoch 5
Loss = 2.4508e-01, PNorm = 43.8004, GNorm = 2.2186, lr_0 = 8.5694e-04
Validation rmse = 0.142536
Validation r2 = 0.639977
Validation mse = 0.020316
Epoch 6
Loss = 1.7348e-01, PNorm = 43.8551, GNorm = 0.9774, lr_0 = 8.3640e-04
Loss = 1.9678e-01, PNorm = 43.8901, GNorm = 1.4058, lr_0 = 8.1815e-04
Validation rmse = 0.115729
Validation r2 = 0.762664
Validation mse = 0.013393
Epoch 7
Loss = 1.6066e-01, PNorm = 43.9270, GNorm = 1.1542, lr_0 = 7.9854e-04
Loss = 1.5890e-01, PNorm = 43.9509, GNorm = 1.4316, lr_0 = 7.8112e-04
Validation rmse = 0.156083
Validation r2 = 0.568290
Validation mse = 0.024362
Epoch 8
Loss = 1.8298e-01, PNorm = 43.9814, GNorm = 6.2629, lr_0 = 7.6240e-04
Loss = 2.1998e-01, PNorm = 44.0082, GNorm = 4.8580, lr_0 = 7.4577e-04
Validation rmse = 0.112435
Validation r2 = 0.775979
Validation mse = 0.012642
Epoch 9
Loss = 1.6555e-01, PNorm = 44.0386, GNorm = 1.6237, lr_0 = 7.2950e-04
Loss = 2.1104e-01, PNorm = 44.0703, GNorm = 5.7721, lr_0 = 7.1359e-04
Validation rmse = 0.244949
Validation r2 = -0.063246
Validation mse = 0.060000
Epoch 10
Loss = 3.3461e-01, PNorm = 44.1056, GNorm = 1.2606, lr_0 = 6.9649e-04
Validation rmse = 0.258718
Validation r2 = -0.186142
Validation mse = 0.066935
Epoch 11
Loss = 3.8720e-01, PNorm = 44.1506, GNorm = 6.8967, lr_0 = 6.7979e-04
Loss = 2.5308e-01, PNorm = 44.1975, GNorm = 1.6505, lr_0 = 6.6496e-04
Validation rmse = 0.119875
Validation r2 = 0.745351
Validation mse = 0.014370
Epoch 12
Loss = 1.7371e-01, PNorm = 44.2319, GNorm = 1.7597, lr_0 = 6.4902e-04
Loss = 1.5283e-01, PNorm = 44.2585, GNorm = 1.0309, lr_0 = 6.3487e-04
Validation rmse = 0.184291
Validation r2 = 0.398143
Validation mse = 0.033963
Epoch 13
Loss = 2.0322e-01, PNorm = 44.2876, GNorm = 3.1722, lr_0 = 6.1965e-04
Loss = 1.6797e-01, PNorm = 44.3102, GNorm = 2.8847, lr_0 = 6.0613e-04
Validation rmse = 0.115825
Validation r2 = 0.762268
Validation mse = 0.013415
Epoch 14
Loss = 1.3829e-01, PNorm = 44.3344, GNorm = 0.7606, lr_0 = 5.9160e-04
Loss = 1.3850e-01, PNorm = 44.3486, GNorm = 2.9779, lr_0 = 5.7870e-04
Validation rmse = 0.117874
Validation r2 = 0.753784
Validation mse = 0.013894
Epoch 15
Loss = 1.2289e-01, PNorm = 44.3637, GNorm = 0.4270, lr_0 = 5.6483e-04
Validation rmse = 0.158196
Validation r2 = 0.556522
Validation mse = 0.025026
Epoch 16
Loss = 1.6972e-01, PNorm = 44.3767, GNorm = 3.4854, lr_0 = 5.5129e-04
Loss = 1.1160e-01, PNorm = 44.3894, GNorm = 2.0145, lr_0 = 5.3926e-04
Validation rmse = 0.155949
Validation r2 = 0.569031
Validation mse = 0.024320
Epoch 17
Loss = 1.3151e-01, PNorm = 44.4009, GNorm = 1.0991, lr_0 = 5.2750e-04
Loss = 1.0994e-01, PNorm = 44.4117, GNorm = 0.6904, lr_0 = 5.1599e-04
Validation rmse = 0.126161
Validation r2 = 0.717947
Validation mse = 0.015917
Epoch 18
Loss = 1.0492e-01, PNorm = 44.4243, GNorm = 1.2524, lr_0 = 5.0362e-04
Loss = 1.0490e-01, PNorm = 44.4334, GNorm = 1.2733, lr_0 = 4.9264e-04
Validation rmse = 0.089480
Validation r2 = 0.858117
Validation mse = 0.008007
Epoch 19
Loss = 1.3153e-01, PNorm = 44.4463, GNorm = 2.0063, lr_0 = 4.8083e-04
Loss = 1.0894e-01, PNorm = 44.4605, GNorm = 1.2183, lr_0 = 4.7034e-04
Validation rmse = 0.093840
Validation r2 = 0.843950
Validation mse = 0.008806
Epoch 20
Loss = 1.1300e-01, PNorm = 44.4738, GNorm = 2.6290, lr_0 = 4.5907e-04
Loss = 1.1412e-01, PNorm = 44.4870, GNorm = 1.9253, lr_0 = 4.4905e-04
Loss = 8.8186e-02, PNorm = 44.4889, GNorm = 2.1643, lr_0 = 4.4806e-04
Validation rmse = 0.105500
Validation r2 = 0.802762
Validation mse = 0.011130
Epoch 21
Loss = 9.7789e-02, PNorm = 44.5016, GNorm = 1.1736, lr_0 = 4.3829e-04
Validation rmse = 0.133158
Validation r2 = 0.685792
Validation mse = 0.017731
Epoch 22
Loss = 1.0340e-01, PNorm = 44.5156, GNorm = 2.7749, lr_0 = 4.2779e-04
Loss = 1.0287e-01, PNorm = 44.5257, GNorm = 0.6038, lr_0 = 4.1845e-04
Validation rmse = 0.123917
Validation r2 = 0.727892
Validation mse = 0.015355
Epoch 23
Loss = 9.8601e-02, PNorm = 44.5399, GNorm = 1.1711, lr_0 = 4.0842e-04
Loss = 9.5759e-02, PNorm = 44.5505, GNorm = 1.2862, lr_0 = 3.9951e-04
Validation rmse = 0.170561
Validation r2 = 0.484484
Validation mse = 0.029091
Epoch 24
Loss = 1.0406e-01, PNorm = 44.5640, GNorm = 2.6026, lr_0 = 3.8994e-04
Loss = 1.3058e-01, PNorm = 44.5780, GNorm = 0.6517, lr_0 = 3.8143e-04
Validation rmse = 0.090790
Validation r2 = 0.853929
Validation mse = 0.008243
Epoch 25
Loss = 1.0462e-01, PNorm = 44.5936, GNorm = 1.5926, lr_0 = 3.7311e-04
Loss = 9.5640e-02, PNorm = 44.6079, GNorm = 0.8990, lr_0 = 3.6497e-04
Validation rmse = 0.138629
Validation r2 = 0.659440
Validation mse = 0.019218
Epoch 26
Loss = 9.6759e-02, PNorm = 44.6221, GNorm = 1.6383, lr_0 = 3.5622e-04
Validation rmse = 0.112125
Validation r2 = 0.777216
Validation mse = 0.012572
Epoch 27
Loss = 1.0685e-01, PNorm = 44.6328, GNorm = 0.4353, lr_0 = 3.4769e-04
Loss = 8.9317e-02, PNorm = 44.6427, GNorm = 2.7748, lr_0 = 3.4010e-04
Validation rmse = 0.093689
Validation r2 = 0.844452
Validation mse = 0.008778
Epoch 28
Loss = 9.6507e-02, PNorm = 44.6525, GNorm = 0.5127, lr_0 = 3.3195e-04
Loss = 9.1884e-02, PNorm = 44.6643, GNorm = 1.6002, lr_0 = 3.2471e-04
Validation rmse = 0.166801
Validation r2 = 0.506962
Validation mse = 0.027823
Epoch 29
Loss = 1.1759e-01, PNorm = 44.6728, GNorm = 0.7229, lr_0 = 3.1693e-04
Loss = 9.5577e-02, PNorm = 44.6845, GNorm = 1.4069, lr_0 = 3.1001e-04
Validation rmse = 0.115495
Validation r2 = 0.763621
Validation mse = 0.013339
Epoch 30
Loss = 8.1878e-02, PNorm = 44.6936, GNorm = 2.4655, lr_0 = 3.0258e-04
Loss = 9.2691e-02, PNorm = 44.7025, GNorm = 1.0707, lr_0 = 2.9598e-04
Validation rmse = 0.130663
Validation r2 = 0.697457
Validation mse = 0.017073
Epoch 31
Loss = 8.3703e-02, PNorm = 44.7111, GNorm = 0.5577, lr_0 = 2.8889e-04
Validation rmse = 0.107087
Validation r2 = 0.796783
Validation mse = 0.011468
Epoch 32
Loss = 7.7751e-02, PNorm = 44.7215, GNorm = 0.7108, lr_0 = 2.8196e-04
Loss = 7.4292e-02, PNorm = 44.7301, GNorm = 1.2041, lr_0 = 2.7581e-04
Validation rmse = 0.110752
Validation r2 = 0.782636
Validation mse = 0.012266
Epoch 33
Loss = 8.3496e-02, PNorm = 44.7400, GNorm = 0.8712, lr_0 = 2.6920e-04
Loss = 8.3704e-02, PNorm = 44.7465, GNorm = 1.3183, lr_0 = 2.6333e-04
Validation rmse = 0.103193
Validation r2 = 0.811293
Validation mse = 0.010649
Epoch 34
Loss = 8.0402e-02, PNorm = 44.7562, GNorm = 1.7954, lr_0 = 2.5758e-04
Loss = 8.2679e-02, PNorm = 44.7642, GNorm = 0.6371, lr_0 = 2.5197e-04
Validation rmse = 0.140375
Validation r2 = 0.650808
Validation mse = 0.019705
Epoch 35
Loss = 8.3210e-02, PNorm = 44.7724, GNorm = 1.0853, lr_0 = 2.4593e-04
Loss = 7.9151e-02, PNorm = 44.7805, GNorm = 0.7253, lr_0 = 2.4056e-04
Validation rmse = 0.103830
Validation r2 = 0.808959
Validation mse = 0.010781
Epoch 36
Loss = 9.2009e-02, PNorm = 44.7874, GNorm = 1.7779, lr_0 = 2.3480e-04
Loss = 8.0623e-02, PNorm = 44.7953, GNorm = 1.2431, lr_0 = 2.2967e-04
Loss = 1.7168e-01, PNorm = 44.7963, GNorm = 2.1018, lr_0 = 2.2917e-04
Validation rmse = 0.134767
Validation r2 = 0.678152
Validation mse = 0.018162
Epoch 37
Loss = 7.8953e-02, PNorm = 44.8045, GNorm = 0.7306, lr_0 = 2.2417e-04
Validation rmse = 0.109650
Validation r2 = 0.786942
Validation mse = 0.012023
Epoch 38
Loss = 9.6216e-02, PNorm = 44.8131, GNorm = 0.7129, lr_0 = 2.1880e-04
Loss = 7.4337e-02, PNorm = 44.8203, GNorm = 1.5043, lr_0 = 2.1402e-04
Validation rmse = 0.127332
Validation r2 = 0.712687
Validation mse = 0.016213
Epoch 39
Loss = 8.9021e-02, PNorm = 44.8279, GNorm = 1.0260, lr_0 = 2.0889e-04
Loss = 7.5577e-02, PNorm = 44.8342, GNorm = 0.4566, lr_0 = 2.0434e-04
Validation rmse = 0.106732
Validation r2 = 0.798130
Validation mse = 0.011392
Epoch 40
Loss = 7.5967e-02, PNorm = 44.8404, GNorm = 0.6130, lr_0 = 1.9944e-04
Loss = 7.5672e-02, PNorm = 44.8481, GNorm = 1.8668, lr_0 = 1.9509e-04
Validation rmse = 0.108733
Validation r2 = 0.790490
Validation mse = 0.011823
Epoch 41
Loss = 8.4483e-02, PNorm = 44.8564, GNorm = 0.5850, lr_0 = 1.9041e-04
Loss = 6.6897e-02, PNorm = 44.8623, GNorm = 0.6541, lr_0 = 1.8626e-04
Validation rmse = 0.095467
Validation r2 = 0.838494
Validation mse = 0.009114
Epoch 42
Loss = 7.0482e-02, PNorm = 44.8683, GNorm = 2.1446, lr_0 = 1.8219e-04
Validation rmse = 0.124827
Validation r2 = 0.723877
Validation mse = 0.015582
Epoch 43
Loss = 6.7971e-02, PNorm = 44.8750, GNorm = 1.2457, lr_0 = 1.7783e-04
Loss = 7.6193e-02, PNorm = 44.8810, GNorm = 1.1702, lr_0 = 1.7395e-04
Validation rmse = 0.103486
Validation r2 = 0.810221
Validation mse = 0.010709
Epoch 44
Loss = 6.3623e-02, PNorm = 44.8872, GNorm = 0.5428, lr_0 = 1.6978e-04
Loss = 6.9264e-02, PNorm = 44.8932, GNorm = 0.4283, lr_0 = 1.6608e-04
Validation rmse = 0.119978
Validation r2 = 0.744914
Validation mse = 0.014395
Epoch 45
Loss = 7.0564e-02, PNorm = 44.9006, GNorm = 1.7278, lr_0 = 1.6210e-04
Loss = 7.1357e-02, PNorm = 44.9066, GNorm = 1.2288, lr_0 = 1.5856e-04
Validation rmse = 0.118307
Validation r2 = 0.751970
Validation mse = 0.013997
Epoch 46
Loss = 7.0042e-02, PNorm = 44.9118, GNorm = 1.3386, lr_0 = 1.5476e-04
Loss = 7.5077e-02, PNorm = 44.9168, GNorm = 0.5480, lr_0 = 1.5138e-04
Validation rmse = 0.113189
Validation r2 = 0.772967
Validation mse = 0.012812
Epoch 47
Loss = 7.2200e-02, PNorm = 44.9232, GNorm = 2.0452, lr_0 = 1.4775e-04
Validation rmse = 0.112211
Validation r2 = 0.776873
Validation mse = 0.012591
Epoch 48
Loss = 4.5984e-02, PNorm = 44.9281, GNorm = 0.4770, lr_0 = 1.4421e-04
Loss = 6.1636e-02, PNorm = 44.9325, GNorm = 0.9833, lr_0 = 1.4107e-04
Validation rmse = 0.106848
Validation r2 = 0.797689
Validation mse = 0.011417
Epoch 49
Loss = 5.8635e-02, PNorm = 44.9383, GNorm = 0.9316, lr_0 = 1.3769e-04
Loss = 6.8350e-02, PNorm = 44.9437, GNorm = 0.8546, lr_0 = 1.3468e-04
Validation rmse = 0.113319
Validation r2 = 0.772445
Validation mse = 0.012841
Epoch 50
Loss = 6.8856e-02, PNorm = 44.9485, GNorm = 1.7995, lr_0 = 1.3174e-04
Loss = 6.7494e-02, PNorm = 44.9533, GNorm = 1.1835, lr_0 = 1.2887e-04
Validation rmse = 0.107769
Validation r2 = 0.794189
Validation mse = 0.011614
Epoch 51
Loss = 7.5548e-02, PNorm = 44.9583, GNorm = 2.7468, lr_0 = 1.2578e-04
Loss = 6.5753e-02, PNorm = 44.9630, GNorm = 0.4940, lr_0 = 1.2304e-04
Validation rmse = 0.102273
Validation r2 = 0.814645
Validation mse = 0.010460
Epoch 52
Loss = 6.9904e-02, PNorm = 44.9680, GNorm = 0.8201, lr_0 = 1.2009e-04
Loss = 6.2270e-02, PNorm = 44.9719, GNorm = 0.6396, lr_0 = 1.1747e-04
Loss = 4.1274e-02, PNorm = 44.9723, GNorm = 1.2249, lr_0 = 1.1721e-04
Validation rmse = 0.110094
Validation r2 = 0.785213
Validation mse = 0.012121
Epoch 53
Loss = 6.7822e-02, PNorm = 44.9765, GNorm = 0.9764, lr_0 = 1.1465e-04
Validation rmse = 0.107850
Validation r2 = 0.793880
Validation mse = 0.011632
Epoch 54
Loss = 5.8332e-02, PNorm = 44.9818, GNorm = 0.9734, lr_0 = 1.1191e-04
Loss = 7.7783e-02, PNorm = 44.9866, GNorm = 1.4103, lr_0 = 1.0946e-04
Validation rmse = 0.121450
Validation r2 = 0.738615
Validation mse = 0.014750
Epoch 55
Loss = 4.8932e-02, PNorm = 44.9909, GNorm = 0.3846, lr_0 = 1.0684e-04
Loss = 6.5651e-02, PNorm = 44.9944, GNorm = 0.6328, lr_0 = 1.0451e-04
Validation rmse = 0.101916
Validation r2 = 0.815936
Validation mse = 0.010387
Epoch 56
Loss = 6.5578e-02, PNorm = 44.9986, GNorm = 0.7579, lr_0 = 1.0200e-04
Loss = 5.6585e-02, PNorm = 45.0023, GNorm = 0.8324, lr_0 = 1.0000e-04
Validation rmse = 0.106026
Validation r2 = 0.800791
Validation mse = 0.011242
Epoch 57
Loss = 5.7304e-02, PNorm = 45.0068, GNorm = 0.5003, lr_0 = 1.0000e-04
Loss = 6.7398e-02, PNorm = 45.0105, GNorm = 1.1302, lr_0 = 1.0000e-04
Loss = 2.7865e-02, PNorm = 45.0109, GNorm = 1.4004, lr_0 = 1.0000e-04
Validation rmse = 0.120245
Validation r2 = 0.743778
Validation mse = 0.014459
Epoch 58
Loss = 6.0977e-02, PNorm = 45.0148, GNorm = 0.8642, lr_0 = 1.0000e-04
Validation rmse = 0.099178
Validation r2 = 0.825692
Validation mse = 0.009836
Epoch 59
Loss = 8.0720e-02, PNorm = 45.0187, GNorm = 0.7134, lr_0 = 1.0000e-04
Loss = 6.1616e-02, PNorm = 45.0219, GNorm = 0.7598, lr_0 = 1.0000e-04
Validation rmse = 0.103458
Validation r2 = 0.810323
Validation mse = 0.010704
Model 0 best validation rmse = 0.089480 on epoch 18
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.140648
Model 0 test r2 = 0.421410
Model 0 test mse = 0.019782
Ensemble test rmse = 0.140648
Ensemble test r2 = 0.421410
Ensemble test mse = 0.019782
Fold 3
Splitting data with seed 3
Total size = 916 | train size = 906 | val size = 10 | test size = 116
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.6390e-01, PNorm = 43.2632, GNorm = 1.0340, lr_0 = 3.7500e-04
Validation rmse = 0.432130
Validation r2 = -1.588551
Validation mse = 0.186736
Epoch 1
Loss = 6.8421e-01, PNorm = 43.2947, GNorm = 3.3806, lr_0 = 6.5000e-04
Loss = 7.1556e-01, PNorm = 43.3316, GNorm = 5.4222, lr_0 = 9.0000e-04
Validation rmse = 0.358961
Validation r2 = -0.786164
Validation mse = 0.128853
Epoch 2
Loss = 4.8464e-01, PNorm = 43.3957, GNorm = 3.6967, lr_0 = 9.8468e-04
Loss = 5.0893e-01, PNorm = 43.4705, GNorm = 0.8759, lr_0 = 9.6320e-04
Validation rmse = 0.300444
Validation r2 = -0.251284
Validation mse = 0.090267
Epoch 3
Loss = 4.7398e-01, PNorm = 43.5416, GNorm = 3.6480, lr_0 = 9.4011e-04
Loss = 3.6328e-01, PNorm = 43.6032, GNorm = 3.7707, lr_0 = 9.1961e-04
Validation rmse = 0.192958
Validation r2 = 0.483878
Validation mse = 0.037233
Epoch 4
Loss = 3.0011e-01, PNorm = 43.6762, GNorm = 2.3958, lr_0 = 8.9756e-04
Loss = 2.9215e-01, PNorm = 43.7327, GNorm = 2.4082, lr_0 = 8.7798e-04
Loss = 3.9496e-01, PNorm = 43.7377, GNorm = 5.9072, lr_0 = 8.7605e-04
Validation rmse = 0.269831
Validation r2 = -0.009282
Validation mse = 0.072809
Epoch 5
Loss = 2.6886e-01, PNorm = 43.7915, GNorm = 3.5137, lr_0 = 8.5694e-04
Validation rmse = 0.270728
Validation r2 = -0.015998
Validation mse = 0.073293
Epoch 6
Loss = 3.0871e-01, PNorm = 43.8423, GNorm = 8.7285, lr_0 = 8.3640e-04
Loss = 2.1192e-01, PNorm = 43.8878, GNorm = 2.0460, lr_0 = 8.1815e-04
Validation rmse = 0.190245
Validation r2 = 0.498287
Validation mse = 0.036193
Epoch 7
Loss = 1.9114e-01, PNorm = 43.9387, GNorm = 1.0154, lr_0 = 7.9854e-04
Loss = 1.7555e-01, PNorm = 43.9837, GNorm = 0.7187, lr_0 = 7.8112e-04
Validation rmse = 0.157145
Validation r2 = 0.657684
Validation mse = 0.024694
Epoch 8
Loss = 1.7948e-01, PNorm = 44.0239, GNorm = 1.5487, lr_0 = 7.6240e-04
Loss = 1.8478e-01, PNorm = 44.0547, GNorm = 1.9141, lr_0 = 7.4577e-04
Validation rmse = 0.129976
Validation r2 = 0.765819
Validation mse = 0.016894
Epoch 9
Loss = 1.3368e-01, PNorm = 44.0808, GNorm = 1.7363, lr_0 = 7.2950e-04
Loss = 1.8307e-01, PNorm = 44.1034, GNorm = 2.7416, lr_0 = 7.1359e-04
Validation rmse = 0.156158
Validation r2 = 0.661969
Validation mse = 0.024385
Epoch 10
Loss = 1.4287e-01, PNorm = 44.1311, GNorm = 2.2670, lr_0 = 6.9649e-04
Validation rmse = 0.189155
Validation r2 = 0.504022
Validation mse = 0.035780
Epoch 11
Loss = 2.0249e-01, PNorm = 44.1541, GNorm = 5.5454, lr_0 = 6.7979e-04
Loss = 1.5258e-01, PNorm = 44.1779, GNorm = 1.7879, lr_0 = 6.6496e-04
Validation rmse = 0.132843
Validation r2 = 0.755374
Validation mse = 0.017647
Epoch 12
Loss = 1.2233e-01, PNorm = 44.1936, GNorm = 2.4417, lr_0 = 6.4902e-04
Loss = 1.3924e-01, PNorm = 44.2120, GNorm = 1.3234, lr_0 = 6.3487e-04
Validation rmse = 0.115681
Validation r2 = 0.814497
Validation mse = 0.013382
Epoch 13
Loss = 1.4430e-01, PNorm = 44.2367, GNorm = 1.7510, lr_0 = 6.1965e-04
Loss = 1.1568e-01, PNorm = 44.2593, GNorm = 0.6935, lr_0 = 6.0613e-04
Validation rmse = 0.118615
Validation r2 = 0.804969
Validation mse = 0.014069
Epoch 14
Loss = 1.2666e-01, PNorm = 44.2750, GNorm = 2.6767, lr_0 = 5.9160e-04
Loss = 1.1512e-01, PNorm = 44.2887, GNorm = 0.9570, lr_0 = 5.7870e-04
Validation rmse = 0.119075
Validation r2 = 0.803452
Validation mse = 0.014179
Epoch 15
Loss = 1.1872e-01, PNorm = 44.3080, GNorm = 3.5029, lr_0 = 5.6483e-04
Validation rmse = 0.094208
Validation r2 = 0.876973
Validation mse = 0.008875
Epoch 16
Loss = 1.2398e-01, PNorm = 44.3265, GNorm = 1.6254, lr_0 = 5.5129e-04
Loss = 1.0915e-01, PNorm = 44.3388, GNorm = 0.6363, lr_0 = 5.3926e-04
Validation rmse = 0.136666
Validation r2 = 0.741090
Validation mse = 0.018678
Epoch 17
Loss = 1.0822e-01, PNorm = 44.3531, GNorm = 1.0537, lr_0 = 5.2750e-04
Loss = 9.6566e-02, PNorm = 44.3685, GNorm = 0.7077, lr_0 = 5.1599e-04
Validation rmse = 0.113808
Validation r2 = 0.820454
Validation mse = 0.012952
Epoch 18
Loss = 9.4102e-02, PNorm = 44.3840, GNorm = 0.6415, lr_0 = 5.0362e-04
Loss = 1.0885e-01, PNorm = 44.3973, GNorm = 4.1587, lr_0 = 4.9264e-04
Validation rmse = 0.095061
Validation r2 = 0.874733
Validation mse = 0.009037
Epoch 19
Loss = 9.3762e-02, PNorm = 44.4150, GNorm = 0.7996, lr_0 = 4.8083e-04
Loss = 1.1596e-01, PNorm = 44.4301, GNorm = 1.5361, lr_0 = 4.7034e-04
Validation rmse = 0.139036
Validation r2 = 0.732034
Validation mse = 0.019331
Epoch 20
Loss = 1.0849e-01, PNorm = 44.4441, GNorm = 1.3741, lr_0 = 4.5907e-04
Loss = 1.0780e-01, PNorm = 44.4600, GNorm = 2.0431, lr_0 = 4.4905e-04
Loss = 4.6611e-02, PNorm = 44.4616, GNorm = 1.3303, lr_0 = 4.4806e-04
Validation rmse = 0.097350
Validation r2 = 0.868630
Validation mse = 0.009477
Epoch 21
Loss = 9.6911e-02, PNorm = 44.4759, GNorm = 0.7742, lr_0 = 4.3829e-04
Validation rmse = 0.130347
Validation r2 = 0.764481
Validation mse = 0.016990
Epoch 22
Loss = 1.2185e-01, PNorm = 44.4896, GNorm = 3.8394, lr_0 = 4.2779e-04
Loss = 1.1046e-01, PNorm = 44.5028, GNorm = 0.7058, lr_0 = 4.1845e-04
Validation rmse = 0.107281
Validation r2 = 0.840457
Validation mse = 0.011509
Epoch 23
Loss = 9.9107e-02, PNorm = 44.5173, GNorm = 1.1373, lr_0 = 4.0842e-04
Loss = 1.0221e-01, PNorm = 44.5321, GNorm = 2.0287, lr_0 = 3.9951e-04
Validation rmse = 0.104780
Validation r2 = 0.847810
Validation mse = 0.010979
Epoch 24
Loss = 9.5536e-02, PNorm = 44.5445, GNorm = 1.0507, lr_0 = 3.8994e-04
Loss = 1.0225e-01, PNorm = 44.5589, GNorm = 1.6845, lr_0 = 3.8143e-04
Validation rmse = 0.091180
Validation r2 = 0.884753
Validation mse = 0.008314
Epoch 25
Loss = 8.5094e-02, PNorm = 44.5719, GNorm = 0.8506, lr_0 = 3.7311e-04
Loss = 8.9546e-02, PNorm = 44.5827, GNorm = 0.5380, lr_0 = 3.6497e-04
Validation rmse = 0.092065
Validation r2 = 0.882505
Validation mse = 0.008476
Epoch 26
Loss = 9.5563e-02, PNorm = 44.5943, GNorm = 1.7137, lr_0 = 3.5622e-04
Validation rmse = 0.090115
Validation r2 = 0.887431
Validation mse = 0.008121
Epoch 27
Loss = 4.7546e-02, PNorm = 44.6080, GNorm = 0.7127, lr_0 = 3.4769e-04
Loss = 9.6642e-02, PNorm = 44.6201, GNorm = 0.7214, lr_0 = 3.4010e-04
Validation rmse = 0.082922
Validation r2 = 0.904683
Validation mse = 0.006876
Epoch 28
Loss = 7.3306e-02, PNorm = 44.6300, GNorm = 1.8319, lr_0 = 3.3195e-04
Loss = 7.8407e-02, PNorm = 44.6382, GNorm = 1.7856, lr_0 = 3.2471e-04
Validation rmse = 0.148615
Validation r2 = 0.693837
Validation mse = 0.022086
Epoch 29
Loss = 7.3070e-02, PNorm = 44.6492, GNorm = 1.9234, lr_0 = 3.1693e-04
Loss = 9.7763e-02, PNorm = 44.6563, GNorm = 0.8579, lr_0 = 3.1001e-04
Validation rmse = 0.120323
Validation r2 = 0.799311
Validation mse = 0.014478
Epoch 30
Loss = 8.8628e-02, PNorm = 44.6698, GNorm = 1.9405, lr_0 = 3.0258e-04
Loss = 9.0579e-02, PNorm = 44.6822, GNorm = 1.2812, lr_0 = 2.9598e-04
Validation rmse = 0.083412
Validation r2 = 0.903554
Validation mse = 0.006958
Epoch 31
Loss = 8.7897e-02, PNorm = 44.6935, GNorm = 3.7291, lr_0 = 2.8889e-04
Validation rmse = 0.108149
Validation r2 = 0.837865
Validation mse = 0.011696
Epoch 32
Loss = 6.4386e-02, PNorm = 44.7019, GNorm = 1.4080, lr_0 = 2.8196e-04
Loss = 8.6960e-02, PNorm = 44.7111, GNorm = 0.7309, lr_0 = 2.7581e-04
Validation rmse = 0.080385
Validation r2 = 0.910427
Validation mse = 0.006462
Epoch 33
Loss = 8.3728e-02, PNorm = 44.7221, GNorm = 2.9626, lr_0 = 2.6920e-04
Loss = 9.5219e-02, PNorm = 44.7333, GNorm = 1.2573, lr_0 = 2.6333e-04
Validation rmse = 0.072822
Validation r2 = 0.926489
Validation mse = 0.005303
Epoch 34
Loss = 8.7251e-02, PNorm = 44.7434, GNorm = 0.7021, lr_0 = 2.5758e-04
Loss = 8.5071e-02, PNorm = 44.7535, GNorm = 4.0131, lr_0 = 2.5197e-04
Validation rmse = 0.086132
Validation r2 = 0.897162
Validation mse = 0.007419
Epoch 35
Loss = 7.5084e-02, PNorm = 44.7629, GNorm = 1.0902, lr_0 = 2.4593e-04
Loss = 7.8676e-02, PNorm = 44.7715, GNorm = 0.6125, lr_0 = 2.4056e-04
Validation rmse = 0.078925
Validation r2 = 0.913651
Validation mse = 0.006229
Epoch 36
Loss = 7.4432e-02, PNorm = 44.7811, GNorm = 1.0411, lr_0 = 2.3480e-04
Loss = 8.9198e-02, PNorm = 44.7880, GNorm = 1.1618, lr_0 = 2.2967e-04
Loss = 1.1773e-01, PNorm = 44.7890, GNorm = 3.2528, lr_0 = 2.2917e-04
Validation rmse = 0.083225
Validation r2 = 0.903986
Validation mse = 0.006926
Epoch 37
Loss = 8.7696e-02, PNorm = 44.7980, GNorm = 1.6183, lr_0 = 2.2417e-04
Validation rmse = 0.095514
Validation r2 = 0.873537
Validation mse = 0.009123
Epoch 38
Loss = 1.0969e-01, PNorm = 44.8078, GNorm = 1.8438, lr_0 = 2.1880e-04
Loss = 6.8326e-02, PNorm = 44.8156, GNorm = 1.2303, lr_0 = 2.1402e-04
Validation rmse = 0.083485
Validation r2 = 0.903385
Validation mse = 0.006970
Epoch 39
Loss = 6.8574e-02, PNorm = 44.8225, GNorm = 1.2091, lr_0 = 2.0889e-04
Loss = 7.0374e-02, PNorm = 44.8303, GNorm = 1.1332, lr_0 = 2.0434e-04
Validation rmse = 0.081370
Validation r2 = 0.908219
Validation mse = 0.006621
Epoch 40
Loss = 7.0144e-02, PNorm = 44.8381, GNorm = 1.5825, lr_0 = 1.9944e-04
Loss = 6.9362e-02, PNorm = 44.8447, GNorm = 0.5175, lr_0 = 1.9509e-04
Validation rmse = 0.104759
Validation r2 = 0.847871
Validation mse = 0.010975
Epoch 41
Loss = 7.3738e-02, PNorm = 44.8517, GNorm = 1.2527, lr_0 = 1.9041e-04
Loss = 7.2323e-02, PNorm = 44.8578, GNorm = 2.4702, lr_0 = 1.8626e-04
Validation rmse = 0.083537
Validation r2 = 0.903264
Validation mse = 0.006979
Epoch 42
Loss = 7.5300e-02, PNorm = 44.8646, GNorm = 1.8778, lr_0 = 1.8219e-04
Validation rmse = 0.078460
Validation r2 = 0.914665
Validation mse = 0.006156
Epoch 43
Loss = 4.0670e-02, PNorm = 44.8719, GNorm = 1.0313, lr_0 = 1.7783e-04
Loss = 7.1612e-02, PNorm = 44.8777, GNorm = 0.8505, lr_0 = 1.7395e-04
Validation rmse = 0.093686
Validation r2 = 0.878331
Validation mse = 0.008777
Epoch 44
Loss = 5.7481e-02, PNorm = 44.8841, GNorm = 0.9707, lr_0 = 1.6978e-04
Loss = 6.7772e-02, PNorm = 44.8900, GNorm = 2.3005, lr_0 = 1.6608e-04
Validation rmse = 0.067707
Validation r2 = 0.936453
Validation mse = 0.004584
Epoch 45
Loss = 5.8523e-02, PNorm = 44.8955, GNorm = 0.5763, lr_0 = 1.6210e-04
Loss = 6.4760e-02, PNorm = 44.9011, GNorm = 0.5657, lr_0 = 1.5856e-04
Validation rmse = 0.087101
Validation r2 = 0.894834
Validation mse = 0.007587
Epoch 46
Loss = 6.0859e-02, PNorm = 44.9064, GNorm = 0.7922, lr_0 = 1.5476e-04
Loss = 6.8931e-02, PNorm = 44.9117, GNorm = 1.2733, lr_0 = 1.5138e-04
Validation rmse = 0.075359
Validation r2 = 0.921278
Validation mse = 0.005679
Epoch 47
Loss = 6.0395e-02, PNorm = 44.9172, GNorm = 0.9605, lr_0 = 1.4775e-04
Validation rmse = 0.074225
Validation r2 = 0.923629
Validation mse = 0.005509
Epoch 48
Loss = 6.4661e-02, PNorm = 44.9223, GNorm = 1.0229, lr_0 = 1.4421e-04
Loss = 5.9886e-02, PNorm = 44.9279, GNorm = 0.6026, lr_0 = 1.4107e-04
Validation rmse = 0.071163
Validation r2 = 0.929801
Validation mse = 0.005064
Epoch 49
Loss = 5.8195e-02, PNorm = 44.9330, GNorm = 2.1341, lr_0 = 1.3769e-04
Loss = 6.4121e-02, PNorm = 44.9385, GNorm = 0.6574, lr_0 = 1.3468e-04
Validation rmse = 0.066838
Validation r2 = 0.938073
Validation mse = 0.004467
Epoch 50
Loss = 4.9832e-02, PNorm = 44.9428, GNorm = 0.5158, lr_0 = 1.3174e-04
Loss = 6.6129e-02, PNorm = 44.9478, GNorm = 0.7529, lr_0 = 1.2887e-04
Validation rmse = 0.064070
Validation r2 = 0.943096
Validation mse = 0.004105
Epoch 51
Loss = 7.3817e-02, PNorm = 44.9529, GNorm = 1.1967, lr_0 = 1.2578e-04
Loss = 6.0536e-02, PNorm = 44.9581, GNorm = 1.5256, lr_0 = 1.2304e-04
Validation rmse = 0.100368
Validation r2 = 0.860358
Validation mse = 0.010074
Epoch 52
Loss = 6.4891e-02, PNorm = 44.9636, GNorm = 1.2464, lr_0 = 1.2009e-04
Loss = 6.1140e-02, PNorm = 44.9676, GNorm = 0.8217, lr_0 = 1.1747e-04
Loss = 2.3344e-02, PNorm = 44.9681, GNorm = 1.7776, lr_0 = 1.1721e-04
Validation rmse = 0.069639
Validation r2 = 0.932775
Validation mse = 0.004850
Epoch 53
Loss = 5.4280e-02, PNorm = 44.9721, GNorm = 0.9261, lr_0 = 1.1465e-04
Validation rmse = 0.071756
Validation r2 = 0.928626
Validation mse = 0.005149
Epoch 54
Loss = 4.3478e-02, PNorm = 44.9765, GNorm = 0.5183, lr_0 = 1.1191e-04
Loss = 5.3844e-02, PNorm = 44.9798, GNorm = 0.8551, lr_0 = 1.0946e-04
Validation rmse = 0.072238
Validation r2 = 0.927662
Validation mse = 0.005218
Epoch 55
Loss = 5.7421e-02, PNorm = 44.9848, GNorm = 0.6792, lr_0 = 1.0684e-04
Loss = 5.6269e-02, PNorm = 44.9895, GNorm = 0.5236, lr_0 = 1.0451e-04
Validation rmse = 0.068758
Validation r2 = 0.934465
Validation mse = 0.004728
Epoch 56
Loss = 6.2242e-02, PNorm = 44.9935, GNorm = 0.9055, lr_0 = 1.0200e-04
Loss = 5.8295e-02, PNorm = 44.9975, GNorm = 1.1775, lr_0 = 1.0000e-04
Validation rmse = 0.068788
Validation r2 = 0.934408
Validation mse = 0.004732
Epoch 57
Loss = 5.2636e-02, PNorm = 45.0023, GNorm = 1.0070, lr_0 = 1.0000e-04
Loss = 5.8481e-02, PNorm = 45.0063, GNorm = 0.6602, lr_0 = 1.0000e-04
Loss = 3.7953e-02, PNorm = 45.0066, GNorm = 2.6009, lr_0 = 1.0000e-04
Validation rmse = 0.074538
Validation r2 = 0.922984
Validation mse = 0.005556
Epoch 58
Loss = 5.1789e-02, PNorm = 45.0110, GNorm = 1.2348, lr_0 = 1.0000e-04
Validation rmse = 0.073330
Validation r2 = 0.925459
Validation mse = 0.005377
Epoch 59
Loss = 6.7629e-02, PNorm = 45.0145, GNorm = 0.9554, lr_0 = 1.0000e-04
Loss = 5.4167e-02, PNorm = 45.0185, GNorm = 0.6277, lr_0 = 1.0000e-04
Validation rmse = 0.067803
Validation r2 = 0.936273
Validation mse = 0.004597
Model 0 best validation rmse = 0.064070 on epoch 50
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.132154
Model 0 test r2 = 0.489183
Model 0 test mse = 0.017465
Ensemble test rmse = 0.132154
Ensemble test r2 = 0.489183
Ensemble test mse = 0.017465
Fold 4
Splitting data with seed 4
Total size = 916 | train size = 906 | val size = 10 | test size = 116
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.1337e-01, PNorm = 43.2645, GNorm = 1.6362, lr_0 = 3.7500e-04
Validation rmse = 0.312574
Validation r2 = 0.327120
Validation mse = 0.097703
Epoch 1
Loss = 6.7417e-01, PNorm = 43.2835, GNorm = 2.7398, lr_0 = 6.5000e-04
Loss = 9.5210e-01, PNorm = 43.3168, GNorm = 2.3612, lr_0 = 9.0000e-04
Validation rmse = 0.277173
Validation r2 = 0.470905
Validation mse = 0.076825
Epoch 2
Loss = 7.0376e-01, PNorm = 43.3913, GNorm = 1.5828, lr_0 = 9.8468e-04
Loss = 4.8201e-01, PNorm = 43.4616, GNorm = 2.7513, lr_0 = 9.6320e-04
Validation rmse = 0.358510
Validation r2 = 0.114814
Validation mse = 0.128530
Epoch 3
Loss = 5.4932e-01, PNorm = 43.5325, GNorm = 4.5676, lr_0 = 9.4011e-04
Loss = 4.4864e-01, PNorm = 43.6005, GNorm = 4.1807, lr_0 = 9.1961e-04
Validation rmse = 0.299716
Validation r2 = 0.381344
Validation mse = 0.089829
Epoch 4
Loss = 2.9006e-01, PNorm = 43.6696, GNorm = 1.9025, lr_0 = 8.9756e-04
Loss = 3.0230e-01, PNorm = 43.7273, GNorm = 5.6310, lr_0 = 8.7798e-04
Loss = 1.4158e-01, PNorm = 43.7344, GNorm = 5.6005, lr_0 = 8.7605e-04
Validation rmse = 0.237268
Validation r2 = 0.612287
Validation mse = 0.056296
Epoch 5
Loss = 3.0978e-01, PNorm = 43.7966, GNorm = 4.9397, lr_0 = 8.5694e-04
Validation rmse = 0.183058
Validation r2 = 0.769215
Validation mse = 0.033510
Epoch 6
Loss = 2.5614e-01, PNorm = 43.8470, GNorm = 3.4610, lr_0 = 8.3640e-04
Loss = 2.0439e-01, PNorm = 43.8899, GNorm = 2.1599, lr_0 = 8.1815e-04
Validation rmse = 0.156213
Validation r2 = 0.831940
Validation mse = 0.024403
Epoch 7
Loss = 2.4499e-01, PNorm = 43.9298, GNorm = 5.3518, lr_0 = 7.9854e-04
Loss = 2.5008e-01, PNorm = 43.9693, GNorm = 0.7879, lr_0 = 7.8112e-04
Validation rmse = 0.192304
Validation r2 = 0.745312
Validation mse = 0.036981
Epoch 8
Loss = 1.7456e-01, PNorm = 44.0063, GNorm = 2.0887, lr_0 = 7.6240e-04
Loss = 1.6884e-01, PNorm = 44.0353, GNorm = 3.3379, lr_0 = 7.4577e-04
Validation rmse = 0.143118
Validation r2 = 0.858935
Validation mse = 0.020483
Epoch 9
Loss = 1.7172e-01, PNorm = 44.0579, GNorm = 1.1228, lr_0 = 7.2950e-04
Loss = 1.4096e-01, PNorm = 44.0769, GNorm = 1.1680, lr_0 = 7.1359e-04
Validation rmse = 0.130012
Validation r2 = 0.883589
Validation mse = 0.016903
Epoch 10
Loss = 1.3579e-01, PNorm = 44.0926, GNorm = 2.2694, lr_0 = 6.9649e-04
Validation rmse = 0.153309
Validation r2 = 0.838131
Validation mse = 0.023504
Epoch 11
Loss = 1.2535e-01, PNorm = 44.1101, GNorm = 1.2132, lr_0 = 6.7979e-04
Loss = 1.3650e-01, PNorm = 44.1352, GNorm = 1.0722, lr_0 = 6.6496e-04
Validation rmse = 0.142288
Validation r2 = 0.860566
Validation mse = 0.020246
Epoch 12
Loss = 1.4058e-01, PNorm = 44.1534, GNorm = 1.3881, lr_0 = 6.4902e-04
Loss = 1.3481e-01, PNorm = 44.1727, GNorm = 1.2435, lr_0 = 6.3487e-04
Validation rmse = 0.151441
Validation r2 = 0.842050
Validation mse = 0.022934
Epoch 13
Loss = 1.2660e-01, PNorm = 44.1907, GNorm = 1.1836, lr_0 = 6.1965e-04
Loss = 1.1814e-01, PNorm = 44.2064, GNorm = 1.1712, lr_0 = 6.0613e-04
Validation rmse = 0.158534
Validation r2 = 0.826908
Validation mse = 0.025133
Epoch 14
Loss = 1.0491e-01, PNorm = 44.2245, GNorm = 2.3743, lr_0 = 5.9160e-04
Loss = 1.2285e-01, PNorm = 44.2407, GNorm = 1.2981, lr_0 = 5.7870e-04
Validation rmse = 0.179154
Validation r2 = 0.778953
Validation mse = 0.032096
Epoch 15
Loss = 1.1577e-01, PNorm = 44.2577, GNorm = 1.5166, lr_0 = 5.6483e-04
Validation rmse = 0.135037
Validation r2 = 0.874415
Validation mse = 0.018235
Epoch 16
Loss = 1.2706e-01, PNorm = 44.2787, GNorm = 3.0673, lr_0 = 5.5129e-04
Loss = 1.0763e-01, PNorm = 44.2965, GNorm = 1.8543, lr_0 = 5.3926e-04
Validation rmse = 0.194365
Validation r2 = 0.739824
Validation mse = 0.037778
Epoch 17
Loss = 1.4306e-01, PNorm = 44.3120, GNorm = 4.4958, lr_0 = 5.2750e-04
Loss = 1.2637e-01, PNorm = 44.3295, GNorm = 0.5736, lr_0 = 5.1599e-04
Validation rmse = 0.158552
Validation r2 = 0.826869
Validation mse = 0.025139
Epoch 18
Loss = 1.1552e-01, PNorm = 44.3447, GNorm = 1.4817, lr_0 = 5.0362e-04
Loss = 1.1521e-01, PNorm = 44.3591, GNorm = 2.8623, lr_0 = 4.9264e-04
Validation rmse = 0.142920
Validation r2 = 0.859325
Validation mse = 0.020426
Epoch 19
Loss = 1.1754e-01, PNorm = 44.3718, GNorm = 3.7525, lr_0 = 4.8083e-04
Loss = 1.0714e-01, PNorm = 44.3864, GNorm = 1.1963, lr_0 = 4.7034e-04
Validation rmse = 0.148210
Validation r2 = 0.848719
Validation mse = 0.021966
Epoch 20
Loss = 1.0583e-01, PNorm = 44.4023, GNorm = 1.0031, lr_0 = 4.5907e-04
Loss = 1.0885e-01, PNorm = 44.4121, GNorm = 0.9559, lr_0 = 4.4905e-04
Loss = 3.3361e-02, PNorm = 44.4139, GNorm = 1.4595, lr_0 = 4.4806e-04
Validation rmse = 0.158014
Validation r2 = 0.828043
Validation mse = 0.024968
Epoch 21
Loss = 1.0812e-01, PNorm = 44.4263, GNorm = 2.2864, lr_0 = 4.3829e-04
Validation rmse = 0.148913
Validation r2 = 0.847281
Validation mse = 0.022175
Epoch 22
Loss = 7.7451e-02, PNorm = 44.4421, GNorm = 0.8131, lr_0 = 4.2779e-04
Loss = 1.4116e-01, PNorm = 44.4582, GNorm = 2.1135, lr_0 = 4.1845e-04
Validation rmse = 0.142281
Validation r2 = 0.860580
Validation mse = 0.020244
Epoch 23
Loss = 1.2712e-01, PNorm = 44.4773, GNorm = 1.7704, lr_0 = 4.0842e-04
Loss = 1.0841e-01, PNorm = 44.4901, GNorm = 2.9678, lr_0 = 3.9951e-04
Validation rmse = 0.122777
Validation r2 = 0.896185
Validation mse = 0.015074
Epoch 24
Loss = 1.3233e-01, PNorm = 44.5028, GNorm = 0.5432, lr_0 = 3.8994e-04
Loss = 1.2579e-01, PNorm = 44.5213, GNorm = 1.4051, lr_0 = 3.8143e-04
Validation rmse = 0.145739
Validation r2 = 0.853721
Validation mse = 0.021240
Epoch 25
Loss = 9.3183e-02, PNorm = 44.5348, GNorm = 0.5755, lr_0 = 3.7311e-04
Loss = 1.0409e-01, PNorm = 44.5478, GNorm = 0.7143, lr_0 = 3.6497e-04
Validation rmse = 0.140267
Validation r2 = 0.864499
Validation mse = 0.019675
Epoch 26
Loss = 9.3445e-02, PNorm = 44.5635, GNorm = 0.5501, lr_0 = 3.5622e-04
Validation rmse = 0.138106
Validation r2 = 0.868642
Validation mse = 0.019073
Epoch 27
Loss = 1.0405e-01, PNorm = 44.5721, GNorm = 2.1354, lr_0 = 3.4769e-04
Loss = 1.0754e-01, PNorm = 44.5816, GNorm = 1.8364, lr_0 = 3.4010e-04
Validation rmse = 0.147204
Validation r2 = 0.850765
Validation mse = 0.021669
Epoch 28
Loss = 9.2675e-02, PNorm = 44.5910, GNorm = 2.6285, lr_0 = 3.3195e-04
Loss = 9.9701e-02, PNorm = 44.5998, GNorm = 3.5674, lr_0 = 3.2471e-04
Validation rmse = 0.149842
Validation r2 = 0.845369
Validation mse = 0.022453
Epoch 29
Loss = 7.7391e-02, PNorm = 44.6125, GNorm = 0.6815, lr_0 = 3.1693e-04
Loss = 9.4750e-02, PNorm = 44.6229, GNorm = 1.3275, lr_0 = 3.1001e-04
Validation rmse = 0.148292
Validation r2 = 0.848552
Validation mse = 0.021990
Epoch 30
Loss = 1.1129e-01, PNorm = 44.6378, GNorm = 2.4512, lr_0 = 3.0258e-04
Loss = 8.9574e-02, PNorm = 44.6453, GNorm = 1.4865, lr_0 = 2.9598e-04
Validation rmse = 0.148655
Validation r2 = 0.847810
Validation mse = 0.022098
Epoch 31
Loss = 9.4922e-02, PNorm = 44.6544, GNorm = 0.6957, lr_0 = 2.8889e-04
Validation rmse = 0.158895
Validation r2 = 0.826119
Validation mse = 0.025248
Epoch 32
Loss = 8.3051e-02, PNorm = 44.6650, GNorm = 0.7515, lr_0 = 2.8196e-04
Loss = 8.4664e-02, PNorm = 44.6728, GNorm = 1.6388, lr_0 = 2.7581e-04
Validation rmse = 0.143204
Validation r2 = 0.858766
Validation mse = 0.020507
Epoch 33
Loss = 8.0115e-02, PNorm = 44.6821, GNorm = 1.3010, lr_0 = 2.6920e-04
Loss = 8.9972e-02, PNorm = 44.6906, GNorm = 0.8276, lr_0 = 2.6333e-04
Validation rmse = 0.145274
Validation r2 = 0.854653
Validation mse = 0.021104
Epoch 34
Loss = 1.1927e-01, PNorm = 44.6988, GNorm = 2.0640, lr_0 = 2.5758e-04
Loss = 9.5132e-02, PNorm = 44.7056, GNorm = 2.1121, lr_0 = 2.5197e-04
Validation rmse = 0.162575
Validation r2 = 0.817972
Validation mse = 0.026431
Epoch 35
Loss = 8.9043e-02, PNorm = 44.7139, GNorm = 1.2582, lr_0 = 2.4593e-04
Loss = 7.4938e-02, PNorm = 44.7226, GNorm = 0.8363, lr_0 = 2.4056e-04
Validation rmse = 0.150247
Validation r2 = 0.844532
Validation mse = 0.022574
Epoch 36
Loss = 7.6155e-02, PNorm = 44.7292, GNorm = 1.5188, lr_0 = 2.3480e-04
Loss = 8.9417e-02, PNorm = 44.7354, GNorm = 3.1514, lr_0 = 2.2967e-04
Loss = 1.5136e-01, PNorm = 44.7366, GNorm = 2.6712, lr_0 = 2.2917e-04
Validation rmse = 0.149011
Validation r2 = 0.847079
Validation mse = 0.022204
Epoch 37
Loss = 8.8849e-02, PNorm = 44.7455, GNorm = 1.9149, lr_0 = 2.2417e-04
Validation rmse = 0.142474
Validation r2 = 0.860202
Validation mse = 0.020299
Epoch 38
Loss = 8.6229e-02, PNorm = 44.7535, GNorm = 1.2055, lr_0 = 2.1880e-04
Loss = 7.8209e-02, PNorm = 44.7604, GNorm = 1.4952, lr_0 = 2.1402e-04
Validation rmse = 0.149226
Validation r2 = 0.846637
Validation mse = 0.022268
Epoch 39
Loss = 7.6096e-02, PNorm = 44.7675, GNorm = 2.0498, lr_0 = 2.0889e-04
Loss = 8.0474e-02, PNorm = 44.7760, GNorm = 0.4389, lr_0 = 2.0434e-04
Validation rmse = 0.155252
Validation r2 = 0.834001
Validation mse = 0.024103
Epoch 40
Loss = 7.2494e-02, PNorm = 44.7813, GNorm = 0.7100, lr_0 = 1.9944e-04
Loss = 7.1714e-02, PNorm = 44.7866, GNorm = 0.6363, lr_0 = 1.9509e-04
Validation rmse = 0.148332
Validation r2 = 0.848470
Validation mse = 0.022002
Epoch 41
Loss = 7.8017e-02, PNorm = 44.7946, GNorm = 0.8377, lr_0 = 1.9041e-04
Loss = 7.6641e-02, PNorm = 44.7997, GNorm = 0.9149, lr_0 = 1.8626e-04
Validation rmse = 0.159383
Validation r2 = 0.825050
Validation mse = 0.025403
Epoch 42
Loss = 7.7914e-02, PNorm = 44.8056, GNorm = 0.5009, lr_0 = 1.8219e-04
Validation rmse = 0.146206
Validation r2 = 0.852782
Validation mse = 0.021376
Epoch 43
Loss = 9.3580e-02, PNorm = 44.8126, GNorm = 1.3194, lr_0 = 1.7783e-04
Loss = 1.0025e-01, PNorm = 44.8208, GNorm = 1.9773, lr_0 = 1.7395e-04
Validation rmse = 0.161316
Validation r2 = 0.820781
Validation mse = 0.026023
Epoch 44
Loss = 8.4239e-02, PNorm = 44.8282, GNorm = 2.4814, lr_0 = 1.6978e-04
Loss = 7.2970e-02, PNorm = 44.8349, GNorm = 0.7521, lr_0 = 1.6608e-04
Validation rmse = 0.159864
Validation r2 = 0.823991
Validation mse = 0.025557
Epoch 45
Loss = 7.4949e-02, PNorm = 44.8404, GNorm = 0.6972, lr_0 = 1.6210e-04
Loss = 6.8637e-02, PNorm = 44.8457, GNorm = 1.2641, lr_0 = 1.5856e-04
Validation rmse = 0.155533
Validation r2 = 0.833400
Validation mse = 0.024190
Epoch 46
Loss = 8.8852e-02, PNorm = 44.8515, GNorm = 1.9527, lr_0 = 1.5476e-04
Loss = 7.5425e-02, PNorm = 44.8583, GNorm = 2.4512, lr_0 = 1.5138e-04
Validation rmse = 0.151197
Validation r2 = 0.842559
Validation mse = 0.022861
Epoch 47
Loss = 6.6626e-02, PNorm = 44.8635, GNorm = 0.4939, lr_0 = 1.4775e-04
Validation rmse = 0.148186
Validation r2 = 0.848767
Validation mse = 0.021959
Epoch 48
Loss = 7.6905e-02, PNorm = 44.8691, GNorm = 0.5216, lr_0 = 1.4421e-04
Loss = 7.4814e-02, PNorm = 44.8747, GNorm = 2.4711, lr_0 = 1.4107e-04
Validation rmse = 0.155975
Validation r2 = 0.832452
Validation mse = 0.024328
Epoch 49
Loss = 5.6933e-02, PNorm = 44.8803, GNorm = 1.3559, lr_0 = 1.3769e-04
Loss = 7.2566e-02, PNorm = 44.8840, GNorm = 0.6446, lr_0 = 1.3468e-04
Validation rmse = 0.154219
Validation r2 = 0.836203
Validation mse = 0.023783
Epoch 50
Loss = 7.1879e-02, PNorm = 44.8884, GNorm = 1.1780, lr_0 = 1.3174e-04
Loss = 6.6631e-02, PNorm = 44.8923, GNorm = 0.6250, lr_0 = 1.2887e-04
Validation rmse = 0.158545
Validation r2 = 0.826885
Validation mse = 0.025136
Epoch 51
Loss = 6.8160e-02, PNorm = 44.8976, GNorm = 0.7525, lr_0 = 1.2578e-04
Loss = 6.8950e-02, PNorm = 44.9013, GNorm = 0.5242, lr_0 = 1.2304e-04
Validation rmse = 0.151726
Validation r2 = 0.841456
Validation mse = 0.023021
Epoch 52
Loss = 6.3722e-02, PNorm = 44.9054, GNorm = 1.3185, lr_0 = 1.2009e-04
Loss = 7.1616e-02, PNorm = 44.9098, GNorm = 0.8577, lr_0 = 1.1747e-04
Loss = 7.3861e-02, PNorm = 44.9106, GNorm = 3.2906, lr_0 = 1.1721e-04
Validation rmse = 0.162749
Validation r2 = 0.817583
Validation mse = 0.026487
Epoch 53
Loss = 7.2129e-02, PNorm = 44.9152, GNorm = 0.5765, lr_0 = 1.1465e-04
Validation rmse = 0.154002
Validation r2 = 0.836663
Validation mse = 0.023717
Epoch 54
Loss = 5.5989e-02, PNorm = 44.9195, GNorm = 0.6169, lr_0 = 1.1191e-04
Loss = 6.8805e-02, PNorm = 44.9246, GNorm = 0.8552, lr_0 = 1.0946e-04
Validation rmse = 0.155544
Validation r2 = 0.833377
Validation mse = 0.024194
Epoch 55
Loss = 7.7949e-02, PNorm = 44.9278, GNorm = 0.9198, lr_0 = 1.0684e-04
Loss = 6.9918e-02, PNorm = 44.9315, GNorm = 0.8182, lr_0 = 1.0451e-04
Validation rmse = 0.164861
Validation r2 = 0.812817
Validation mse = 0.027179
Epoch 56
Loss = 6.8228e-02, PNorm = 44.9356, GNorm = 1.5876, lr_0 = 1.0200e-04
Loss = 6.6591e-02, PNorm = 44.9395, GNorm = 0.4639, lr_0 = 1.0000e-04
Validation rmse = 0.161303
Validation r2 = 0.820808
Validation mse = 0.026019
Epoch 57
Loss = 6.8196e-02, PNorm = 44.9433, GNorm = 1.8678, lr_0 = 1.0000e-04
Loss = 6.2817e-02, PNorm = 44.9469, GNorm = 0.8770, lr_0 = 1.0000e-04
Loss = 7.2543e-02, PNorm = 44.9471, GNorm = 1.3469, lr_0 = 1.0000e-04
Validation rmse = 0.155618
Validation r2 = 0.833217
Validation mse = 0.024217
Epoch 58
Loss = 5.8806e-02, PNorm = 44.9505, GNorm = 0.9004, lr_0 = 1.0000e-04
Validation rmse = 0.153948
Validation r2 = 0.836777
Validation mse = 0.023700
Epoch 59
Loss = 6.9817e-02, PNorm = 44.9530, GNorm = 1.1518, lr_0 = 1.0000e-04
Loss = 6.2149e-02, PNorm = 44.9565, GNorm = 1.1592, lr_0 = 1.0000e-04
Validation rmse = 0.160811
Validation r2 = 0.821900
Validation mse = 0.025860
Model 0 best validation rmse = 0.122777 on epoch 23
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.197696
Model 0 test r2 = -0.143150
Model 0 test mse = 0.039084
Ensemble test rmse = 0.197696
Ensemble test r2 = -0.143150
Ensemble test mse = 0.039084
Fold 5
Splitting data with seed 5
Total size = 916 | train size = 906 | val size = 10 | test size = 116
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.2491e-01, PNorm = 43.2606, GNorm = 4.1309, lr_0 = 3.7500e-04
Validation rmse = 0.283042
Validation r2 = -0.191740
Validation mse = 0.080113
Epoch 1
Loss = 1.0423e+00, PNorm = 43.2868, GNorm = 15.5355, lr_0 = 6.5000e-04
Loss = 8.2725e-01, PNorm = 43.3199, GNorm = 3.6624, lr_0 = 9.0000e-04
Validation rmse = 0.176999
Validation r2 = 0.533959
Validation mse = 0.031329
Epoch 2
Loss = 7.3678e-01, PNorm = 43.3877, GNorm = 7.5090, lr_0 = 9.8468e-04
Loss = 4.8826e-01, PNorm = 43.4563, GNorm = 4.6492, lr_0 = 9.6320e-04
Validation rmse = 0.168895
Validation r2 = 0.575658
Validation mse = 0.028526
Epoch 3
Loss = 3.9076e-01, PNorm = 43.5418, GNorm = 2.6242, lr_0 = 9.4011e-04
Loss = 3.2740e-01, PNorm = 43.6124, GNorm = 2.6695, lr_0 = 9.1961e-04
Validation rmse = 0.161826
Validation r2 = 0.610438
Validation mse = 0.026188
Epoch 4
Loss = 2.7958e-01, PNorm = 43.6846, GNorm = 1.5707, lr_0 = 8.9756e-04
Loss = 2.4587e-01, PNorm = 43.7348, GNorm = 4.6119, lr_0 = 8.7798e-04
Loss = 2.4972e-01, PNorm = 43.7385, GNorm = 3.2824, lr_0 = 8.7605e-04
Validation rmse = 0.170291
Validation r2 = 0.568615
Validation mse = 0.028999
Epoch 5
Loss = 2.6680e-01, PNorm = 43.7883, GNorm = 4.6809, lr_0 = 8.5694e-04
Validation rmse = 0.110155
Validation r2 = 0.819495
Validation mse = 0.012134
Epoch 6
Loss = 2.2600e-01, PNorm = 43.8396, GNorm = 1.6417, lr_0 = 8.3640e-04
Loss = 1.8954e-01, PNorm = 43.8733, GNorm = 1.4144, lr_0 = 8.1815e-04
Validation rmse = 0.118332
Validation r2 = 0.791702
Validation mse = 0.014002
Epoch 7
Loss = 2.5301e-01, PNorm = 43.9150, GNorm = 5.2422, lr_0 = 7.9854e-04
Loss = 1.7036e-01, PNorm = 43.9435, GNorm = 1.7409, lr_0 = 7.8112e-04
Validation rmse = 0.114216
Validation r2 = 0.805939
Validation mse = 0.013045
Epoch 8
Loss = 1.9152e-01, PNorm = 43.9807, GNorm = 2.6381, lr_0 = 7.6240e-04
Loss = 1.5194e-01, PNorm = 44.0137, GNorm = 1.2771, lr_0 = 7.4577e-04
Validation rmse = 0.122640
Validation r2 = 0.776258
Validation mse = 0.015041
Epoch 9
Loss = 1.1694e-01, PNorm = 44.0354, GNorm = 1.2893, lr_0 = 7.2950e-04
Loss = 1.6594e-01, PNorm = 44.0524, GNorm = 3.0572, lr_0 = 7.1359e-04
Validation rmse = 0.155317
Validation r2 = 0.641147
Validation mse = 0.024123
Epoch 10
Loss = 1.7518e-01, PNorm = 44.0730, GNorm = 6.1186, lr_0 = 6.9649e-04
Validation rmse = 0.122965
Validation r2 = 0.775073
Validation mse = 0.015120
Epoch 11
Loss = 2.0752e-01, PNorm = 44.1029, GNorm = 1.7380, lr_0 = 6.7979e-04
Loss = 1.4382e-01, PNorm = 44.1300, GNorm = 1.8613, lr_0 = 6.6496e-04
Validation rmse = 0.151839
Validation r2 = 0.657037
Validation mse = 0.023055
Epoch 12
Loss = 1.3085e-01, PNorm = 44.1564, GNorm = 1.6756, lr_0 = 6.4902e-04
Loss = 1.3865e-01, PNorm = 44.1779, GNorm = 2.3181, lr_0 = 6.3487e-04
Validation rmse = 0.132108
Validation r2 = 0.740377
Validation mse = 0.017453
Epoch 13
Loss = 1.4070e-01, PNorm = 44.2002, GNorm = 4.4570, lr_0 = 6.1965e-04
Loss = 1.6472e-01, PNorm = 44.2235, GNorm = 0.5159, lr_0 = 6.0613e-04
Validation rmse = 0.126849
Validation r2 = 0.760639
Validation mse = 0.016091
Epoch 14
Loss = 1.4592e-01, PNorm = 44.2553, GNorm = 3.9506, lr_0 = 5.9160e-04
Loss = 1.1461e-01, PNorm = 44.2699, GNorm = 0.5950, lr_0 = 5.7870e-04
Validation rmse = 0.138543
Validation r2 = 0.714471
Validation mse = 0.019194
Epoch 15
Loss = 1.4153e-01, PNorm = 44.2840, GNorm = 2.3693, lr_0 = 5.6483e-04
Validation rmse = 0.129828
Validation r2 = 0.749263
Validation mse = 0.016855
Epoch 16
Loss = 1.4569e-01, PNorm = 44.3007, GNorm = 3.3327, lr_0 = 5.5129e-04
Loss = 1.2505e-01, PNorm = 44.3157, GNorm = 2.8563, lr_0 = 5.3926e-04
Validation rmse = 0.125821
Validation r2 = 0.764502
Validation mse = 0.015831
Epoch 17
Loss = 8.8116e-02, PNorm = 44.3312, GNorm = 1.7902, lr_0 = 5.2750e-04
Loss = 1.1857e-01, PNorm = 44.3459, GNorm = 1.3826, lr_0 = 5.1599e-04
Validation rmse = 0.125021
Validation r2 = 0.767486
Validation mse = 0.015630
Epoch 18
Loss = 1.3466e-01, PNorm = 44.3621, GNorm = 1.5980, lr_0 = 5.0362e-04
Loss = 9.8876e-02, PNorm = 44.3747, GNorm = 2.2197, lr_0 = 4.9264e-04
Validation rmse = 0.128362
Validation r2 = 0.754895
Validation mse = 0.016477
Epoch 19
Loss = 8.1220e-02, PNorm = 44.3884, GNorm = 0.8639, lr_0 = 4.8083e-04
Loss = 1.2153e-01, PNorm = 44.4003, GNorm = 0.8274, lr_0 = 4.7034e-04
Validation rmse = 0.130544
Validation r2 = 0.746489
Validation mse = 0.017042
Epoch 20
Loss = 1.2236e-01, PNorm = 44.4145, GNorm = 3.2038, lr_0 = 4.5907e-04
Loss = 1.1442e-01, PNorm = 44.4291, GNorm = 1.4668, lr_0 = 4.4905e-04
Loss = 2.1218e-01, PNorm = 44.4306, GNorm = 5.7414, lr_0 = 4.4806e-04
Validation rmse = 0.131880
Validation r2 = 0.741274
Validation mse = 0.017392
Epoch 21
Loss = 1.0893e-01, PNorm = 44.4493, GNorm = 0.8335, lr_0 = 4.3829e-04
Validation rmse = 0.137638
Validation r2 = 0.718191
Validation mse = 0.018944
Epoch 22
Loss = 1.0489e-01, PNorm = 44.4675, GNorm = 1.0018, lr_0 = 4.2779e-04
Loss = 9.6493e-02, PNorm = 44.4785, GNorm = 0.7990, lr_0 = 4.1845e-04
Validation rmse = 0.133284
Validation r2 = 0.735738
Validation mse = 0.017765
Epoch 23
Loss = 8.0801e-02, PNorm = 44.4902, GNorm = 0.8363, lr_0 = 4.0842e-04
Loss = 9.7113e-02, PNorm = 44.5020, GNorm = 1.1325, lr_0 = 3.9951e-04
Validation rmse = 0.129079
Validation r2 = 0.752147
Validation mse = 0.016661
Epoch 24
Loss = 8.6093e-02, PNorm = 44.5158, GNorm = 0.7383, lr_0 = 3.8994e-04
Loss = 9.6221e-02, PNorm = 44.5242, GNorm = 1.0442, lr_0 = 3.8143e-04
Validation rmse = 0.144521
Validation r2 = 0.689300
Validation mse = 0.020886
Epoch 25
Loss = 1.0143e-01, PNorm = 44.5366, GNorm = 0.7004, lr_0 = 3.7311e-04
Loss = 9.7990e-02, PNorm = 44.5466, GNorm = 1.5240, lr_0 = 3.6497e-04
Validation rmse = 0.135547
Validation r2 = 0.726686
Validation mse = 0.018373
Epoch 26
Loss = 1.2285e-01, PNorm = 44.5606, GNorm = 1.3266, lr_0 = 3.5622e-04
Validation rmse = 0.129234
Validation r2 = 0.751554
Validation mse = 0.016701
Epoch 27
Loss = 1.3371e-01, PNorm = 44.5764, GNorm = 0.8661, lr_0 = 3.4769e-04
Loss = 9.7884e-02, PNorm = 44.5872, GNorm = 0.6428, lr_0 = 3.4010e-04
Validation rmse = 0.133669
Validation r2 = 0.734208
Validation mse = 0.017867
Epoch 28
Loss = 9.3236e-02, PNorm = 44.5999, GNorm = 0.8215, lr_0 = 3.3195e-04
Loss = 9.4188e-02, PNorm = 44.6098, GNorm = 1.3764, lr_0 = 3.2471e-04
Validation rmse = 0.132277
Validation r2 = 0.739716
Validation mse = 0.017497
Epoch 29
Loss = 7.8170e-02, PNorm = 44.6201, GNorm = 0.7845, lr_0 = 3.1693e-04
Loss = 9.1540e-02, PNorm = 44.6285, GNorm = 2.1528, lr_0 = 3.1001e-04
Validation rmse = 0.135903
Validation r2 = 0.725248
Validation mse = 0.018470
Epoch 30
Loss = 9.1375e-02, PNorm = 44.6371, GNorm = 0.9012, lr_0 = 3.0258e-04
Loss = 8.7274e-02, PNorm = 44.6469, GNorm = 1.2484, lr_0 = 2.9598e-04
Validation rmse = 0.129073
Validation r2 = 0.752170
Validation mse = 0.016660
Epoch 31
Loss = 9.2573e-02, PNorm = 44.6550, GNorm = 1.8503, lr_0 = 2.8889e-04
Validation rmse = 0.129469
Validation r2 = 0.750647
Validation mse = 0.016762
Epoch 32
Loss = 9.6880e-02, PNorm = 44.6640, GNorm = 0.6278, lr_0 = 2.8196e-04
Loss = 8.7794e-02, PNorm = 44.6723, GNorm = 0.9463, lr_0 = 2.7581e-04
Validation rmse = 0.128840
Validation r2 = 0.753065
Validation mse = 0.016600
Epoch 33
Loss = 6.1768e-02, PNorm = 44.6824, GNorm = 0.6901, lr_0 = 2.6920e-04
Loss = 8.7626e-02, PNorm = 44.6897, GNorm = 0.9425, lr_0 = 2.6333e-04
Validation rmse = 0.130815
Validation r2 = 0.745437
Validation mse = 0.017113
Epoch 34
Loss = 9.6576e-02, PNorm = 44.6990, GNorm = 0.8875, lr_0 = 2.5758e-04
Loss = 8.3549e-02, PNorm = 44.7060, GNorm = 0.9717, lr_0 = 2.5197e-04
Validation rmse = 0.127747
Validation r2 = 0.757236
Validation mse = 0.016319
Epoch 35
Loss = 8.2352e-02, PNorm = 44.7147, GNorm = 0.5656, lr_0 = 2.4593e-04
Loss = 6.8879e-02, PNorm = 44.7228, GNorm = 0.7498, lr_0 = 2.4056e-04
Validation rmse = 0.127719
Validation r2 = 0.757342
Validation mse = 0.016312
Epoch 36
Loss = 6.8932e-02, PNorm = 44.7305, GNorm = 0.8614, lr_0 = 2.3480e-04
Loss = 7.7538e-02, PNorm = 44.7392, GNorm = 0.7184, lr_0 = 2.2967e-04
Loss = 4.9211e-02, PNorm = 44.7403, GNorm = 3.2501, lr_0 = 2.2917e-04
Validation rmse = 0.127693
Validation r2 = 0.757442
Validation mse = 0.016306
Epoch 37
Loss = 7.0928e-02, PNorm = 44.7483, GNorm = 0.6651, lr_0 = 2.2417e-04
Validation rmse = 0.126573
Validation r2 = 0.761680
Validation mse = 0.016021
Epoch 38
Loss = 6.3202e-02, PNorm = 44.7573, GNorm = 0.6918, lr_0 = 2.1880e-04
Loss = 8.4384e-02, PNorm = 44.7641, GNorm = 1.1998, lr_0 = 2.1402e-04
Validation rmse = 0.130338
Validation r2 = 0.747289
Validation mse = 0.016988
Epoch 39
Loss = 8.4576e-02, PNorm = 44.7713, GNorm = 0.7541, lr_0 = 2.0889e-04
Loss = 6.7105e-02, PNorm = 44.7773, GNorm = 0.3907, lr_0 = 2.0434e-04
Validation rmse = 0.123037
Validation r2 = 0.774810
Validation mse = 0.015138
Epoch 40
Loss = 6.7476e-02, PNorm = 44.7842, GNorm = 0.4323, lr_0 = 1.9944e-04
Loss = 7.3005e-02, PNorm = 44.7919, GNorm = 1.8612, lr_0 = 1.9509e-04
Validation rmse = 0.124616
Validation r2 = 0.768993
Validation mse = 0.015529
Epoch 41
Loss = 6.9170e-02, PNorm = 44.8006, GNorm = 0.8782, lr_0 = 1.9041e-04
Loss = 7.2576e-02, PNorm = 44.8091, GNorm = 1.7149, lr_0 = 1.8626e-04
Validation rmse = 0.119321
Validation r2 = 0.788205
Validation mse = 0.014238
Epoch 42
Loss = 6.2694e-02, PNorm = 44.8143, GNorm = 1.3502, lr_0 = 1.8219e-04
Validation rmse = 0.128376
Validation r2 = 0.754842
Validation mse = 0.016480
Epoch 43
Loss = 7.8049e-02, PNorm = 44.8216, GNorm = 1.4220, lr_0 = 1.7783e-04
Loss = 8.0699e-02, PNorm = 44.8279, GNorm = 0.7580, lr_0 = 1.7395e-04
Validation rmse = 0.124645
Validation r2 = 0.768885
Validation mse = 0.015536
Epoch 44
Loss = 6.2209e-02, PNorm = 44.8329, GNorm = 1.8619, lr_0 = 1.6978e-04
Loss = 6.1854e-02, PNorm = 44.8391, GNorm = 0.9463, lr_0 = 1.6608e-04
Validation rmse = 0.123065
Validation r2 = 0.774705
Validation mse = 0.015145
Epoch 45
Loss = 7.9994e-02, PNorm = 44.8457, GNorm = 1.0879, lr_0 = 1.6210e-04
Loss = 7.2651e-02, PNorm = 44.8529, GNorm = 2.9713, lr_0 = 1.5856e-04
Validation rmse = 0.125081
Validation r2 = 0.767265
Validation mse = 0.015645
Epoch 46
Loss = 6.4220e-02, PNorm = 44.8594, GNorm = 0.7064, lr_0 = 1.5476e-04
Loss = 6.9690e-02, PNorm = 44.8650, GNorm = 1.3125, lr_0 = 1.5138e-04
Validation rmse = 0.117854
Validation r2 = 0.793383
Validation mse = 0.013889
Epoch 47
Loss = 6.6292e-02, PNorm = 44.8713, GNorm = 0.7694, lr_0 = 1.4775e-04
Validation rmse = 0.122166
Validation r2 = 0.777984
Validation mse = 0.014925
Epoch 48
Loss = 3.5036e-02, PNorm = 44.8765, GNorm = 1.3363, lr_0 = 1.4421e-04
Loss = 6.7495e-02, PNorm = 44.8812, GNorm = 0.8754, lr_0 = 1.4107e-04
Validation rmse = 0.115250
Validation r2 = 0.802410
Validation mse = 0.013283
Epoch 49
Loss = 5.0967e-02, PNorm = 44.8872, GNorm = 1.1530, lr_0 = 1.3769e-04
Loss = 6.4286e-02, PNorm = 44.8919, GNorm = 0.7116, lr_0 = 1.3468e-04
Validation rmse = 0.118443
Validation r2 = 0.791310
Validation mse = 0.014029
Epoch 50
Loss = 6.9217e-02, PNorm = 44.8968, GNorm = 0.8457, lr_0 = 1.3174e-04
Loss = 6.1174e-02, PNorm = 44.9018, GNorm = 1.9506, lr_0 = 1.2887e-04
Validation rmse = 0.122140
Validation r2 = 0.778079
Validation mse = 0.014918
Epoch 51
Loss = 6.0028e-02, PNorm = 44.9067, GNorm = 0.6539, lr_0 = 1.2578e-04
Loss = 5.8521e-02, PNorm = 44.9111, GNorm = 0.6034, lr_0 = 1.2304e-04
Validation rmse = 0.116251
Validation r2 = 0.798964
Validation mse = 0.013514
Epoch 52
Loss = 5.6078e-02, PNorm = 44.9159, GNorm = 0.7258, lr_0 = 1.2009e-04
Loss = 6.2226e-02, PNorm = 44.9212, GNorm = 1.2474, lr_0 = 1.1747e-04
Loss = 1.0859e-01, PNorm = 44.9216, GNorm = 1.9504, lr_0 = 1.1721e-04
Validation rmse = 0.119093
Validation r2 = 0.789013
Validation mse = 0.014183
Epoch 53
Loss = 6.1925e-02, PNorm = 44.9266, GNorm = 0.4784, lr_0 = 1.1465e-04
Validation rmse = 0.119659
Validation r2 = 0.787003
Validation mse = 0.014318
Epoch 54
Loss = 8.4030e-02, PNorm = 44.9310, GNorm = 0.6501, lr_0 = 1.1191e-04
Loss = 5.7897e-02, PNorm = 44.9357, GNorm = 1.0055, lr_0 = 1.0946e-04
Validation rmse = 0.114026
Validation r2 = 0.806586
Validation mse = 0.013002
Epoch 55
Loss = 3.9848e-02, PNorm = 44.9404, GNorm = 1.3921, lr_0 = 1.0684e-04
Loss = 6.5908e-02, PNorm = 44.9439, GNorm = 1.9478, lr_0 = 1.0451e-04
Validation rmse = 0.115292
Validation r2 = 0.802268
Validation mse = 0.013292
Epoch 56
Loss = 5.1574e-02, PNorm = 44.9485, GNorm = 0.8754, lr_0 = 1.0200e-04
Loss = 5.6281e-02, PNorm = 44.9519, GNorm = 0.4866, lr_0 = 1.0000e-04
Validation rmse = 0.117819
Validation r2 = 0.793505
Validation mse = 0.013881
Epoch 57
Loss = 5.8021e-02, PNorm = 44.9568, GNorm = 0.6404, lr_0 = 1.0000e-04
Loss = 5.6685e-02, PNorm = 44.9605, GNorm = 0.8552, lr_0 = 1.0000e-04
Loss = 8.5418e-03, PNorm = 44.9607, GNorm = 0.9762, lr_0 = 1.0000e-04
Validation rmse = 0.117395
Validation r2 = 0.794986
Validation mse = 0.013782
Epoch 58
Loss = 5.9693e-02, PNorm = 44.9643, GNorm = 1.2037, lr_0 = 1.0000e-04
Validation rmse = 0.116070
Validation r2 = 0.799588
Validation mse = 0.013472
Epoch 59
Loss = 6.4559e-02, PNorm = 44.9677, GNorm = 0.9100, lr_0 = 1.0000e-04
Loss = 5.4219e-02, PNorm = 44.9717, GNorm = 0.9098, lr_0 = 1.0000e-04
Validation rmse = 0.112823
Validation r2 = 0.810645
Validation mse = 0.012729
Model 0 best validation rmse = 0.110155 on epoch 5
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.264098
Model 0 test r2 = -1.040023
Model 0 test mse = 0.069748
Ensemble test rmse = 0.264098
Ensemble test r2 = -1.040023
Ensemble test mse = 0.069748
Fold 6
Splitting data with seed 6
Total size = 916 | train size = 906 | val size = 10 | test size = 116
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.6189e-01, PNorm = 43.2625, GNorm = 4.4150, lr_0 = 3.7500e-04
Validation rmse = 0.326898
Validation r2 = 0.137960
Validation mse = 0.106862
Epoch 1
Loss = 8.3191e-01, PNorm = 43.2843, GNorm = 2.7056, lr_0 = 6.5000e-04
Loss = 6.6549e-01, PNorm = 43.3316, GNorm = 4.2827, lr_0 = 9.0000e-04
Validation rmse = 0.269689
Validation r2 = 0.413282
Validation mse = 0.072732
Epoch 2
Loss = 6.0212e-01, PNorm = 43.4115, GNorm = 6.9207, lr_0 = 9.8468e-04
Loss = 5.7458e-01, PNorm = 43.4929, GNorm = 3.7176, lr_0 = 9.6320e-04
Validation rmse = 0.253897
Validation r2 = 0.479985
Validation mse = 0.064463
Epoch 3
Loss = 3.6655e-01, PNorm = 43.5614, GNorm = 2.2483, lr_0 = 9.4011e-04
Loss = 3.1418e-01, PNorm = 43.6263, GNorm = 3.3082, lr_0 = 9.1961e-04
Validation rmse = 0.217324
Validation r2 = 0.619007
Validation mse = 0.047230
Epoch 4
Loss = 3.0116e-01, PNorm = 43.6804, GNorm = 6.5312, lr_0 = 8.9756e-04
Loss = 2.3629e-01, PNorm = 43.7262, GNorm = 3.4281, lr_0 = 8.7798e-04
Loss = 3.2829e-01, PNorm = 43.7309, GNorm = 4.0182, lr_0 = 8.7605e-04
Validation rmse = 0.184362
Validation r2 = 0.725813
Validation mse = 0.033989
Epoch 5
Loss = 2.2656e-01, PNorm = 43.7749, GNorm = 1.5383, lr_0 = 8.5694e-04
Validation rmse = 0.147316
Validation r2 = 0.824933
Validation mse = 0.021702
Epoch 6
Loss = 2.1074e-01, PNorm = 43.8203, GNorm = 0.9237, lr_0 = 8.3640e-04
Loss = 1.5628e-01, PNorm = 43.8507, GNorm = 2.1689, lr_0 = 8.1815e-04
Validation rmse = 0.153604
Validation r2 = 0.809670
Validation mse = 0.023594
Epoch 7
Loss = 1.5399e-01, PNorm = 43.8827, GNorm = 3.2763, lr_0 = 7.9854e-04
Loss = 1.6907e-01, PNorm = 43.9080, GNorm = 4.4982, lr_0 = 7.8112e-04
Validation rmse = 0.158042
Validation r2 = 0.798513
Validation mse = 0.024977
Epoch 8
Loss = 2.3582e-01, PNorm = 43.9375, GNorm = 3.6871, lr_0 = 7.6240e-04
Loss = 1.7271e-01, PNorm = 43.9661, GNorm = 3.6934, lr_0 = 7.4577e-04
Validation rmse = 0.130287
Validation r2 = 0.863069
Validation mse = 0.016975
Epoch 9
Loss = 1.6441e-01, PNorm = 43.9952, GNorm = 5.5269, lr_0 = 7.2950e-04
Loss = 2.0066e-01, PNorm = 44.0245, GNorm = 1.8117, lr_0 = 7.1359e-04
Validation rmse = 0.169999
Validation r2 = 0.766872
Validation mse = 0.028900
Epoch 10
Loss = 1.6564e-01, PNorm = 44.0473, GNorm = 3.2609, lr_0 = 6.9649e-04
Validation rmse = 0.125529
Validation r2 = 0.872886
Validation mse = 0.015758
Epoch 11
Loss = 1.1027e-01, PNorm = 44.0709, GNorm = 1.8815, lr_0 = 6.7979e-04
Loss = 1.5552e-01, PNorm = 44.0895, GNorm = 3.0507, lr_0 = 6.6496e-04
Validation rmse = 0.122346
Validation r2 = 0.879252
Validation mse = 0.014968
Epoch 12
Loss = 1.4324e-01, PNorm = 44.1139, GNorm = 1.4015, lr_0 = 6.4902e-04
Loss = 1.5569e-01, PNorm = 44.1263, GNorm = 4.1895, lr_0 = 6.3487e-04
Validation rmse = 0.160531
Validation r2 = 0.792117
Validation mse = 0.025770
Epoch 13
Loss = 1.7940e-01, PNorm = 44.1518, GNorm = 2.0383, lr_0 = 6.1965e-04
Loss = 1.4389e-01, PNorm = 44.1731, GNorm = 0.6598, lr_0 = 6.0613e-04
Validation rmse = 0.152621
Validation r2 = 0.812098
Validation mse = 0.023293
Epoch 14
Loss = 1.6523e-01, PNorm = 44.1937, GNorm = 2.5182, lr_0 = 5.9160e-04
Loss = 1.3305e-01, PNorm = 44.2077, GNorm = 0.4603, lr_0 = 5.7870e-04
Validation rmse = 0.160958
Validation r2 = 0.791008
Validation mse = 0.025908
Epoch 15
Loss = 1.1742e-01, PNorm = 44.2313, GNorm = 1.5971, lr_0 = 5.6483e-04
Validation rmse = 0.160070
Validation r2 = 0.793309
Validation mse = 0.025622
Epoch 16
Loss = 1.3364e-01, PNorm = 44.2490, GNorm = 1.7769, lr_0 = 5.5129e-04
Loss = 1.2278e-01, PNorm = 44.2643, GNorm = 2.8835, lr_0 = 5.3926e-04
Validation rmse = 0.141362
Validation r2 = 0.838799
Validation mse = 0.019983
Epoch 17
Loss = 9.8992e-02, PNorm = 44.2809, GNorm = 1.2054, lr_0 = 5.2750e-04
Loss = 1.2355e-01, PNorm = 44.2983, GNorm = 1.4062, lr_0 = 5.1599e-04
Validation rmse = 0.122785
Validation r2 = 0.878382
Validation mse = 0.015076
Epoch 18
Loss = 1.0234e-01, PNorm = 44.3139, GNorm = 0.5364, lr_0 = 5.0362e-04
Loss = 1.0970e-01, PNorm = 44.3309, GNorm = 0.9855, lr_0 = 4.9264e-04
Validation rmse = 0.130952
Validation r2 = 0.861666
Validation mse = 0.017148
Epoch 19
Loss = 1.1166e-01, PNorm = 44.3443, GNorm = 1.6364, lr_0 = 4.8083e-04
Loss = 1.0669e-01, PNorm = 44.3565, GNorm = 2.2937, lr_0 = 4.7034e-04
Validation rmse = 0.116854
Validation r2 = 0.889849
Validation mse = 0.013655
Epoch 20
Loss = 1.2451e-01, PNorm = 44.3711, GNorm = 1.2284, lr_0 = 4.5907e-04
Loss = 9.8996e-02, PNorm = 44.3817, GNorm = 0.9279, lr_0 = 4.4905e-04
Loss = 2.7549e-01, PNorm = 44.3828, GNorm = 3.1287, lr_0 = 4.4806e-04
Validation rmse = 0.152124
Validation r2 = 0.813319
Validation mse = 0.023142
Epoch 21
Loss = 1.2600e-01, PNorm = 44.3995, GNorm = 3.4499, lr_0 = 4.3829e-04
Validation rmse = 0.144738
Validation r2 = 0.831007
Validation mse = 0.020949
Epoch 22
Loss = 9.0866e-02, PNorm = 44.4156, GNorm = 1.4133, lr_0 = 4.2779e-04
Loss = 9.3942e-02, PNorm = 44.4287, GNorm = 0.6613, lr_0 = 4.1845e-04
Validation rmse = 0.150621
Validation r2 = 0.816991
Validation mse = 0.022687
Epoch 23
Loss = 1.0242e-01, PNorm = 44.4441, GNorm = 2.1601, lr_0 = 4.0842e-04
Loss = 1.1681e-01, PNorm = 44.4576, GNorm = 1.5827, lr_0 = 3.9951e-04
Validation rmse = 0.116997
Validation r2 = 0.889579
Validation mse = 0.013688
Epoch 24
Loss = 9.7190e-02, PNorm = 44.4732, GNorm = 1.1835, lr_0 = 3.8994e-04
Loss = 9.6814e-02, PNorm = 44.4854, GNorm = 1.3818, lr_0 = 3.8143e-04
Validation rmse = 0.131911
Validation r2 = 0.859634
Validation mse = 0.017400
Epoch 25
Loss = 9.6459e-02, PNorm = 44.4953, GNorm = 1.7834, lr_0 = 3.7311e-04
Loss = 9.4790e-02, PNorm = 44.5037, GNorm = 1.9941, lr_0 = 3.6497e-04
Validation rmse = 0.172352
Validation r2 = 0.760373
Validation mse = 0.029705
Epoch 26
Loss = 1.4324e-01, PNorm = 44.5189, GNorm = 2.5208, lr_0 = 3.5622e-04
Validation rmse = 0.160094
Validation r2 = 0.793246
Validation mse = 0.025630
Epoch 27
Loss = 1.0327e-01, PNorm = 44.5345, GNorm = 1.8119, lr_0 = 3.4769e-04
Loss = 1.2761e-01, PNorm = 44.5470, GNorm = 1.5634, lr_0 = 3.4010e-04
Validation rmse = 0.117178
Validation r2 = 0.889236
Validation mse = 0.013731
Epoch 28
Loss = 9.9084e-02, PNorm = 44.5617, GNorm = 0.9502, lr_0 = 3.3195e-04
Loss = 1.0111e-01, PNorm = 44.5739, GNorm = 1.6742, lr_0 = 3.2471e-04
Validation rmse = 0.126584
Validation r2 = 0.870742
Validation mse = 0.016023
Epoch 29
Loss = 1.0789e-01, PNorm = 44.5843, GNorm = 1.6965, lr_0 = 3.1693e-04
Loss = 9.3769e-02, PNorm = 44.5938, GNorm = 3.4129, lr_0 = 3.1001e-04
Validation rmse = 0.168288
Validation r2 = 0.771541
Validation mse = 0.028321
Epoch 30
Loss = 8.5489e-02, PNorm = 44.6046, GNorm = 0.8817, lr_0 = 3.0258e-04
Loss = 8.9112e-02, PNorm = 44.6130, GNorm = 1.0763, lr_0 = 2.9598e-04
Validation rmse = 0.126769
Validation r2 = 0.870362
Validation mse = 0.016071
Epoch 31
Loss = 7.8662e-02, PNorm = 44.6243, GNorm = 1.4341, lr_0 = 2.8889e-04
Validation rmse = 0.115579
Validation r2 = 0.892239
Validation mse = 0.013359
Epoch 32
Loss = 9.5106e-02, PNorm = 44.6320, GNorm = 1.6940, lr_0 = 2.8196e-04
Loss = 7.9819e-02, PNorm = 44.6395, GNorm = 1.5824, lr_0 = 2.7581e-04
Validation rmse = 0.124519
Validation r2 = 0.874923
Validation mse = 0.015505
Epoch 33
Loss = 8.6530e-02, PNorm = 44.6479, GNorm = 0.7399, lr_0 = 2.6920e-04
Loss = 7.6598e-02, PNorm = 44.6555, GNorm = 1.1143, lr_0 = 2.6333e-04
Validation rmse = 0.130337
Validation r2 = 0.862964
Validation mse = 0.016988
Epoch 34
Loss = 7.6319e-02, PNorm = 44.6625, GNorm = 1.6342, lr_0 = 2.5758e-04
Loss = 7.6950e-02, PNorm = 44.6697, GNorm = 0.4715, lr_0 = 2.5197e-04
Validation rmse = 0.115288
Validation r2 = 0.892782
Validation mse = 0.013291
Epoch 35
Loss = 8.6858e-02, PNorm = 44.6790, GNorm = 1.4793, lr_0 = 2.4593e-04
Loss = 8.4455e-02, PNorm = 44.6878, GNorm = 0.8096, lr_0 = 2.4056e-04
Validation rmse = 0.129150
Validation r2 = 0.865447
Validation mse = 0.016680
Epoch 36
Loss = 7.0354e-02, PNorm = 44.6952, GNorm = 0.9247, lr_0 = 2.3480e-04
Loss = 8.3858e-02, PNorm = 44.7014, GNorm = 0.8412, lr_0 = 2.2967e-04
Loss = 1.1929e-01, PNorm = 44.7022, GNorm = 2.7881, lr_0 = 2.2917e-04
Validation rmse = 0.115288
Validation r2 = 0.892781
Validation mse = 0.013291
Epoch 37
Loss = 7.6306e-02, PNorm = 44.7106, GNorm = 2.7888, lr_0 = 2.2417e-04
Validation rmse = 0.146160
Validation r2 = 0.827670
Validation mse = 0.021363
Epoch 38
Loss = 8.5167e-02, PNorm = 44.7185, GNorm = 0.9431, lr_0 = 2.1880e-04
Loss = 8.3774e-02, PNorm = 44.7263, GNorm = 1.6012, lr_0 = 2.1402e-04
Validation rmse = 0.132679
Validation r2 = 0.857993
Validation mse = 0.017604
Epoch 39
Loss = 6.1891e-02, PNorm = 44.7332, GNorm = 1.2573, lr_0 = 2.0889e-04
Loss = 8.3874e-02, PNorm = 44.7402, GNorm = 2.6637, lr_0 = 2.0434e-04
Validation rmse = 0.141478
Validation r2 = 0.838534
Validation mse = 0.020016
Epoch 40
Loss = 8.5847e-02, PNorm = 44.7475, GNorm = 2.0168, lr_0 = 1.9944e-04
Loss = 7.1126e-02, PNorm = 44.7536, GNorm = 0.6957, lr_0 = 1.9509e-04
Validation rmse = 0.136153
Validation r2 = 0.850461
Validation mse = 0.018538
Epoch 41
Loss = 7.3725e-02, PNorm = 44.7607, GNorm = 0.9051, lr_0 = 1.9041e-04
Loss = 7.4462e-02, PNorm = 44.7665, GNorm = 0.7845, lr_0 = 1.8626e-04
Validation rmse = 0.125312
Validation r2 = 0.873325
Validation mse = 0.015703
Epoch 42
Loss = 7.2320e-02, PNorm = 44.7717, GNorm = 1.4196, lr_0 = 1.8219e-04
Validation rmse = 0.139461
Validation r2 = 0.843106
Validation mse = 0.019449
Epoch 43
Loss = 1.0273e-01, PNorm = 44.7781, GNorm = 1.4442, lr_0 = 1.7783e-04
Loss = 7.6092e-02, PNorm = 44.7863, GNorm = 1.3142, lr_0 = 1.7395e-04
Validation rmse = 0.129225
Validation r2 = 0.865291
Validation mse = 0.016699
Epoch 44
Loss = 5.7376e-02, PNorm = 44.7917, GNorm = 0.8167, lr_0 = 1.6978e-04
Loss = 7.6722e-02, PNorm = 44.7972, GNorm = 1.0483, lr_0 = 1.6608e-04
Validation rmse = 0.132672
Validation r2 = 0.858009
Validation mse = 0.017602
Epoch 45
Loss = 7.4467e-02, PNorm = 44.8035, GNorm = 0.9686, lr_0 = 1.6210e-04
Loss = 7.6140e-02, PNorm = 44.8086, GNorm = 0.5707, lr_0 = 1.5856e-04
Validation rmse = 0.133137
Validation r2 = 0.857011
Validation mse = 0.017726
Epoch 46
Loss = 6.6412e-02, PNorm = 44.8148, GNorm = 1.2277, lr_0 = 1.5476e-04
Loss = 7.1943e-02, PNorm = 44.8191, GNorm = 0.5527, lr_0 = 1.5138e-04
Validation rmse = 0.124939
Validation r2 = 0.874079
Validation mse = 0.015610
Epoch 47
Loss = 6.4007e-02, PNorm = 44.8251, GNorm = 2.4694, lr_0 = 1.4775e-04
Validation rmse = 0.133768
Validation r2 = 0.855652
Validation mse = 0.017894
Epoch 48
Loss = 7.6807e-02, PNorm = 44.8307, GNorm = 1.3557, lr_0 = 1.4421e-04
Loss = 6.8543e-02, PNorm = 44.8353, GNorm = 0.6569, lr_0 = 1.4107e-04
Validation rmse = 0.124900
Validation r2 = 0.874158
Validation mse = 0.015600
Epoch 49
Loss = 5.8896e-02, PNorm = 44.8400, GNorm = 1.0714, lr_0 = 1.3769e-04
Loss = 6.9002e-02, PNorm = 44.8443, GNorm = 0.8993, lr_0 = 1.3468e-04
Validation rmse = 0.111073
Validation r2 = 0.900477
Validation mse = 0.012337
Epoch 50
Loss = 7.6418e-02, PNorm = 44.8487, GNorm = 0.5674, lr_0 = 1.3174e-04
Loss = 6.4790e-02, PNorm = 44.8537, GNorm = 1.6278, lr_0 = 1.2887e-04
Validation rmse = 0.100527
Validation r2 = 0.918479
Validation mse = 0.010106
Epoch 51
Loss = 6.5996e-02, PNorm = 44.8573, GNorm = 0.5796, lr_0 = 1.2578e-04
Loss = 6.9033e-02, PNorm = 44.8631, GNorm = 1.5262, lr_0 = 1.2304e-04
Validation rmse = 0.146109
Validation r2 = 0.827790
Validation mse = 0.021348
Epoch 52
Loss = 7.3233e-02, PNorm = 44.8681, GNorm = 1.5309, lr_0 = 1.2009e-04
Loss = 7.6518e-02, PNorm = 44.8720, GNorm = 0.8847, lr_0 = 1.1747e-04
Loss = 3.4669e-02, PNorm = 44.8727, GNorm = 2.2896, lr_0 = 1.1721e-04
Validation rmse = 0.112114
Validation r2 = 0.898604
Validation mse = 0.012570
Epoch 53
Loss = 7.2711e-02, PNorm = 44.8768, GNorm = 1.8593, lr_0 = 1.1465e-04
Validation rmse = 0.112263
Validation r2 = 0.898334
Validation mse = 0.012603
Epoch 54
Loss = 6.4191e-02, PNorm = 44.8815, GNorm = 1.7144, lr_0 = 1.1191e-04
Loss = 6.8639e-02, PNorm = 44.8849, GNorm = 0.6036, lr_0 = 1.0946e-04
Validation rmse = 0.118297
Validation r2 = 0.887111
Validation mse = 0.013994
Epoch 55
Loss = 6.3676e-02, PNorm = 44.8890, GNorm = 0.6448, lr_0 = 1.0684e-04
Loss = 6.2151e-02, PNorm = 44.8921, GNorm = 1.5321, lr_0 = 1.0451e-04
Validation rmse = 0.112983
Validation r2 = 0.897027
Validation mse = 0.012765
Epoch 56
Loss = 6.0310e-02, PNorm = 44.8970, GNorm = 0.7028, lr_0 = 1.0200e-04
Loss = 6.6435e-02, PNorm = 44.9011, GNorm = 1.3494, lr_0 = 1.0000e-04
Validation rmse = 0.115325
Validation r2 = 0.892712
Validation mse = 0.013300
Epoch 57
Loss = 6.2051e-02, PNorm = 44.9045, GNorm = 0.5824, lr_0 = 1.0000e-04
Loss = 6.1103e-02, PNorm = 44.9086, GNorm = 1.7070, lr_0 = 1.0000e-04
Loss = 5.9034e-02, PNorm = 44.9089, GNorm = 1.0414, lr_0 = 1.0000e-04
Validation rmse = 0.121971
Validation r2 = 0.879991
Validation mse = 0.014877
Epoch 58
Loss = 5.4148e-02, PNorm = 44.9124, GNorm = 1.3105, lr_0 = 1.0000e-04
Validation rmse = 0.126919
Validation r2 = 0.870056
Validation mse = 0.016108
Epoch 59
Loss = 7.1915e-02, PNorm = 44.9157, GNorm = 1.3450, lr_0 = 1.0000e-04
Loss = 6.6735e-02, PNorm = 44.9191, GNorm = 1.7990, lr_0 = 1.0000e-04
Validation rmse = 0.109003
Validation r2 = 0.904154
Validation mse = 0.011882
Model 0 best validation rmse = 0.100527 on epoch 50
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.148903
Model 0 test r2 = 0.351492
Model 0 test mse = 0.022172
Ensemble test rmse = 0.148903
Ensemble test r2 = 0.351492
Ensemble test mse = 0.022172
Fold 7
Splitting data with seed 7
Total size = 916 | train size = 906 | val size = 10 | test size = 116
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.0879e-01, PNorm = 43.2657, GNorm = 11.2449, lr_0 = 3.7500e-04
Validation rmse = 0.206505
Validation r2 = 0.484966
Validation mse = 0.042644
Epoch 1
Loss = 6.0696e-01, PNorm = 43.2921, GNorm = 16.2580, lr_0 = 6.5000e-04
Loss = 8.0619e-01, PNorm = 43.3233, GNorm = 4.8016, lr_0 = 9.0000e-04
Validation rmse = 0.117402
Validation r2 = 0.833533
Validation mse = 0.013783
Epoch 2
Loss = 5.0743e-01, PNorm = 43.3987, GNorm = 1.6218, lr_0 = 9.8468e-04
Loss = 4.7621e-01, PNorm = 43.4763, GNorm = 8.7844, lr_0 = 9.6320e-04
Validation rmse = 0.118624
Validation r2 = 0.830051
Validation mse = 0.014072
Epoch 3
Loss = 3.2576e-01, PNorm = 43.5665, GNorm = 3.0283, lr_0 = 9.4011e-04
Loss = 3.3268e-01, PNorm = 43.6305, GNorm = 1.9984, lr_0 = 9.1961e-04
Validation rmse = 0.165471
Validation r2 = 0.669310
Validation mse = 0.027381
Epoch 4
Loss = 3.8940e-01, PNorm = 43.7060, GNorm = 5.3110, lr_0 = 8.9756e-04
Loss = 2.6915e-01, PNorm = 43.7760, GNorm = 1.8568, lr_0 = 8.7798e-04
Loss = 2.9188e-01, PNorm = 43.7832, GNorm = 10.1012, lr_0 = 8.7605e-04
Validation rmse = 0.277546
Validation r2 = 0.069654
Validation mse = 0.077032
Epoch 5
Loss = 3.5355e-01, PNorm = 43.8259, GNorm = 5.4018, lr_0 = 8.5694e-04
Validation rmse = 0.174236
Validation r2 = 0.633350
Validation mse = 0.030358
Epoch 6
Loss = 2.9502e-01, PNorm = 43.8762, GNorm = 2.9241, lr_0 = 8.3640e-04
Loss = 2.3226e-01, PNorm = 43.9206, GNorm = 3.9046, lr_0 = 8.1815e-04
Validation rmse = 0.148668
Validation r2 = 0.733061
Validation mse = 0.022102
Epoch 7
Loss = 2.3962e-01, PNorm = 43.9509, GNorm = 5.7251, lr_0 = 7.9854e-04
Loss = 1.7385e-01, PNorm = 43.9810, GNorm = 2.8217, lr_0 = 7.8112e-04
Validation rmse = 0.164075
Validation r2 = 0.674867
Validation mse = 0.026921
Epoch 8
Loss = 1.4795e-01, PNorm = 44.0075, GNorm = 2.4398, lr_0 = 7.6240e-04
Loss = 1.8157e-01, PNorm = 44.0247, GNorm = 0.9782, lr_0 = 7.4577e-04
Validation rmse = 0.144214
Validation r2 = 0.748818
Validation mse = 0.020798
Epoch 9
Loss = 1.7739e-01, PNorm = 44.0445, GNorm = 1.6027, lr_0 = 7.2950e-04
Loss = 1.8354e-01, PNorm = 44.0696, GNorm = 2.0934, lr_0 = 7.1359e-04
Validation rmse = 0.191131
Validation r2 = 0.558796
Validation mse = 0.036531
Epoch 10
Loss = 1.6487e-01, PNorm = 44.0938, GNorm = 1.8871, lr_0 = 6.9649e-04
Validation rmse = 0.136336
Validation r2 = 0.775510
Validation mse = 0.018587
Epoch 11
Loss = 1.6285e-01, PNorm = 44.1187, GNorm = 3.9907, lr_0 = 6.7979e-04
Loss = 1.9318e-01, PNorm = 44.1430, GNorm = 2.8828, lr_0 = 6.6496e-04
Validation rmse = 0.126478
Validation r2 = 0.806800
Validation mse = 0.015997
Epoch 12
Loss = 1.5893e-01, PNorm = 44.1650, GNorm = 2.3389, lr_0 = 6.4902e-04
Loss = 1.3450e-01, PNorm = 44.1836, GNorm = 1.4078, lr_0 = 6.3487e-04
Validation rmse = 0.150875
Validation r2 = 0.725078
Validation mse = 0.022763
Epoch 13
Loss = 1.2857e-01, PNorm = 44.2082, GNorm = 1.2568, lr_0 = 6.1965e-04
Loss = 1.3809e-01, PNorm = 44.2204, GNorm = 0.6426, lr_0 = 6.0613e-04
Validation rmse = 0.140880
Validation r2 = 0.760297
Validation mse = 0.019847
Epoch 14
Loss = 1.1791e-01, PNorm = 44.2306, GNorm = 1.8055, lr_0 = 5.9160e-04
Loss = 1.3630e-01, PNorm = 44.2471, GNorm = 2.3482, lr_0 = 5.7870e-04
Validation rmse = 0.151056
Validation r2 = 0.724417
Validation mse = 0.022818
Epoch 15
Loss = 1.3492e-01, PNorm = 44.2655, GNorm = 1.1391, lr_0 = 5.6483e-04
Validation rmse = 0.143600
Validation r2 = 0.750950
Validation mse = 0.020621
Epoch 16
Loss = 1.8560e-01, PNorm = 44.2817, GNorm = 3.3057, lr_0 = 5.5129e-04
Loss = 1.1935e-01, PNorm = 44.2953, GNorm = 4.1889, lr_0 = 5.3926e-04
Validation rmse = 0.109026
Validation r2 = 0.856438
Validation mse = 0.011887
Epoch 17
Loss = 1.3938e-01, PNorm = 44.3099, GNorm = 2.7909, lr_0 = 5.2750e-04
Loss = 1.2830e-01, PNorm = 44.3272, GNorm = 2.6723, lr_0 = 5.1599e-04
Validation rmse = 0.139169
Validation r2 = 0.766083
Validation mse = 0.019368
Epoch 18
Loss = 1.1434e-01, PNorm = 44.3385, GNorm = 1.8768, lr_0 = 5.0362e-04
Loss = 1.2890e-01, PNorm = 44.3522, GNorm = 2.1181, lr_0 = 4.9264e-04
Validation rmse = 0.120380
Validation r2 = 0.824983
Validation mse = 0.014491
Epoch 19
Loss = 1.1619e-01, PNorm = 44.3650, GNorm = 1.0769, lr_0 = 4.8083e-04
Loss = 1.0156e-01, PNorm = 44.3752, GNorm = 0.5330, lr_0 = 4.7034e-04
Validation rmse = 0.127564
Validation r2 = 0.803467
Validation mse = 0.016273
Epoch 20
Loss = 1.2646e-01, PNorm = 44.3884, GNorm = 1.3367, lr_0 = 4.5907e-04
Loss = 1.0386e-01, PNorm = 44.3995, GNorm = 0.5565, lr_0 = 4.4905e-04
Loss = 2.3985e-02, PNorm = 44.4005, GNorm = 1.5999, lr_0 = 4.4806e-04
Validation rmse = 0.127486
Validation r2 = 0.803710
Validation mse = 0.016253
Epoch 21
Loss = 1.1244e-01, PNorm = 44.4121, GNorm = 3.1568, lr_0 = 4.3829e-04
Validation rmse = 0.115974
Validation r2 = 0.837559
Validation mse = 0.013450
Epoch 22
Loss = 9.9890e-02, PNorm = 44.4259, GNorm = 2.4161, lr_0 = 4.2779e-04
Loss = 9.3935e-02, PNorm = 44.4437, GNorm = 0.5693, lr_0 = 4.1845e-04
Validation rmse = 0.118571
Validation r2 = 0.830201
Validation mse = 0.014059
Epoch 23
Loss = 9.9731e-02, PNorm = 44.4544, GNorm = 0.6996, lr_0 = 4.0842e-04
Loss = 1.0724e-01, PNorm = 44.4618, GNorm = 1.1260, lr_0 = 3.9951e-04
Validation rmse = 0.119263
Validation r2 = 0.828215
Validation mse = 0.014224
Epoch 24
Loss = 9.4132e-02, PNorm = 44.4741, GNorm = 1.0548, lr_0 = 3.8994e-04
Loss = 9.8603e-02, PNorm = 44.4831, GNorm = 1.0725, lr_0 = 3.8143e-04
Validation rmse = 0.118390
Validation r2 = 0.830721
Validation mse = 0.014016
Epoch 25
Loss = 1.0263e-01, PNorm = 44.4921, GNorm = 1.8609, lr_0 = 3.7311e-04
Loss = 9.2368e-02, PNorm = 44.5021, GNorm = 0.4680, lr_0 = 3.6497e-04
Validation rmse = 0.115480
Validation r2 = 0.838939
Validation mse = 0.013336
Epoch 26
Loss = 8.6969e-02, PNorm = 44.5107, GNorm = 0.4679, lr_0 = 3.5622e-04
Validation rmse = 0.126072
Validation r2 = 0.808038
Validation mse = 0.015894
Epoch 27
Loss = 9.3955e-02, PNorm = 44.5212, GNorm = 0.9687, lr_0 = 3.4769e-04
Loss = 8.1217e-02, PNorm = 44.5282, GNorm = 0.8934, lr_0 = 3.4010e-04
Validation rmse = 0.123648
Validation r2 = 0.815350
Validation mse = 0.015289
Epoch 28
Loss = 1.0421e-01, PNorm = 44.5385, GNorm = 2.8472, lr_0 = 3.3195e-04
Loss = 1.0090e-01, PNorm = 44.5474, GNorm = 2.7011, lr_0 = 3.2471e-04
Validation rmse = 0.125828
Validation r2 = 0.808782
Validation mse = 0.015833
Epoch 29
Loss = 8.1582e-02, PNorm = 44.5567, GNorm = 1.1113, lr_0 = 3.1693e-04
Loss = 9.3024e-02, PNorm = 44.5643, GNorm = 2.1957, lr_0 = 3.1001e-04
Validation rmse = 0.112630
Validation r2 = 0.846791
Validation mse = 0.012686
Epoch 30
Loss = 8.7956e-02, PNorm = 44.5734, GNorm = 0.5190, lr_0 = 3.0258e-04
Loss = 1.0791e-01, PNorm = 44.5815, GNorm = 0.6776, lr_0 = 2.9598e-04
Validation rmse = 0.109629
Validation r2 = 0.854848
Validation mse = 0.012018
Epoch 31
Loss = 9.5604e-02, PNorm = 44.5921, GNorm = 1.0113, lr_0 = 2.8889e-04
Validation rmse = 0.112658
Validation r2 = 0.846716
Validation mse = 0.012692
Epoch 32
Loss = 9.5081e-02, PNorm = 44.6012, GNorm = 1.6240, lr_0 = 2.8196e-04
Loss = 1.0044e-01, PNorm = 44.6096, GNorm = 1.8033, lr_0 = 2.7581e-04
Validation rmse = 0.127122
Validation r2 = 0.804829
Validation mse = 0.016160
Epoch 33
Loss = 9.2060e-02, PNorm = 44.6178, GNorm = 0.5801, lr_0 = 2.6920e-04
Loss = 8.0077e-02, PNorm = 44.6276, GNorm = 0.4725, lr_0 = 2.6333e-04
Validation rmse = 0.114122
Validation r2 = 0.842705
Validation mse = 0.013024
Epoch 34
Loss = 9.2297e-02, PNorm = 44.6332, GNorm = 1.0772, lr_0 = 2.5758e-04
Loss = 8.4086e-02, PNorm = 44.6390, GNorm = 2.1028, lr_0 = 2.5197e-04
Validation rmse = 0.118829
Validation r2 = 0.829462
Validation mse = 0.014120
Epoch 35
Loss = 8.4818e-02, PNorm = 44.6462, GNorm = 1.7104, lr_0 = 2.4593e-04
Loss = 8.7608e-02, PNorm = 44.6527, GNorm = 1.4001, lr_0 = 2.4056e-04
Validation rmse = 0.115725
Validation r2 = 0.838254
Validation mse = 0.013392
Epoch 36
Loss = 8.1838e-02, PNorm = 44.6627, GNorm = 1.2170, lr_0 = 2.3480e-04
Loss = 7.8514e-02, PNorm = 44.6691, GNorm = 1.4211, lr_0 = 2.2967e-04
Loss = 1.7953e-01, PNorm = 44.6701, GNorm = 2.5359, lr_0 = 2.2917e-04
Validation rmse = 0.118815
Validation r2 = 0.829501
Validation mse = 0.014117
Epoch 37
Loss = 9.1574e-02, PNorm = 44.6765, GNorm = 2.7646, lr_0 = 2.2417e-04
Validation rmse = 0.134484
Validation r2 = 0.781569
Validation mse = 0.018086
Epoch 38
Loss = 8.3363e-02, PNorm = 44.6844, GNorm = 0.8794, lr_0 = 2.1880e-04
Loss = 8.1824e-02, PNorm = 44.6892, GNorm = 0.8737, lr_0 = 2.1402e-04
Validation rmse = 0.110669
Validation r2 = 0.852081
Validation mse = 0.012248
Epoch 39
Loss = 9.8231e-02, PNorm = 44.6960, GNorm = 0.7989, lr_0 = 2.0889e-04
Loss = 6.9741e-02, PNorm = 44.7038, GNorm = 0.9621, lr_0 = 2.0434e-04
Validation rmse = 0.115867
Validation r2 = 0.837857
Validation mse = 0.013425
Epoch 40
Loss = 6.4878e-02, PNorm = 44.7090, GNorm = 0.9372, lr_0 = 1.9944e-04
Loss = 7.9523e-02, PNorm = 44.7137, GNorm = 0.7091, lr_0 = 1.9509e-04
Validation rmse = 0.110372
Validation r2 = 0.852872
Validation mse = 0.012182
Epoch 41
Loss = 8.2300e-02, PNorm = 44.7183, GNorm = 2.1492, lr_0 = 1.9041e-04
Loss = 8.3229e-02, PNorm = 44.7252, GNorm = 0.7523, lr_0 = 1.8626e-04
Validation rmse = 0.116428
Validation r2 = 0.836285
Validation mse = 0.013555
Epoch 42
Loss = 7.2504e-02, PNorm = 44.7303, GNorm = 0.5556, lr_0 = 1.8219e-04
Validation rmse = 0.114137
Validation r2 = 0.842664
Validation mse = 0.013027
Epoch 43
Loss = 9.2069e-02, PNorm = 44.7357, GNorm = 0.9847, lr_0 = 1.7783e-04
Loss = 8.5038e-02, PNorm = 44.7411, GNorm = 1.8184, lr_0 = 1.7395e-04
Validation rmse = 0.116416
Validation r2 = 0.836318
Validation mse = 0.013553
Epoch 44
Loss = 6.8531e-02, PNorm = 44.7464, GNorm = 0.8277, lr_0 = 1.6978e-04
Loss = 7.7602e-02, PNorm = 44.7515, GNorm = 1.7482, lr_0 = 1.6608e-04
Validation rmse = 0.104191
Validation r2 = 0.868890
Validation mse = 0.010856
Epoch 45
Loss = 7.0728e-02, PNorm = 44.7581, GNorm = 0.5378, lr_0 = 1.6210e-04
Loss = 7.9324e-02, PNorm = 44.7647, GNorm = 1.6696, lr_0 = 1.5856e-04
Validation rmse = 0.109235
Validation r2 = 0.855889
Validation mse = 0.011932
Epoch 46
Loss = 6.8085e-02, PNorm = 44.7682, GNorm = 0.7590, lr_0 = 1.5476e-04
Loss = 8.0115e-02, PNorm = 44.7732, GNorm = 1.0193, lr_0 = 1.5138e-04
Validation rmse = 0.117181
Validation r2 = 0.834159
Validation mse = 0.013731
Epoch 47
Loss = 6.8306e-02, PNorm = 44.7796, GNorm = 0.6015, lr_0 = 1.4775e-04
Validation rmse = 0.110479
Validation r2 = 0.852587
Validation mse = 0.012206
Epoch 48
Loss = 6.2563e-02, PNorm = 44.7848, GNorm = 0.6465, lr_0 = 1.4421e-04
Loss = 7.5668e-02, PNorm = 44.7890, GNorm = 1.0278, lr_0 = 1.4107e-04
Validation rmse = 0.107859
Validation r2 = 0.859497
Validation mse = 0.011634
Epoch 49
Loss = 5.5497e-02, PNorm = 44.7935, GNorm = 0.9136, lr_0 = 1.3769e-04
Loss = 6.0103e-02, PNorm = 44.7972, GNorm = 0.5915, lr_0 = 1.3468e-04
Validation rmse = 0.110149
Validation r2 = 0.853467
Validation mse = 0.012133
Epoch 50
Loss = 7.1154e-02, PNorm = 44.8016, GNorm = 1.1000, lr_0 = 1.3174e-04
Loss = 6.5542e-02, PNorm = 44.8053, GNorm = 0.5197, lr_0 = 1.2887e-04
Validation rmse = 0.108824
Validation r2 = 0.856972
Validation mse = 0.011843
Epoch 51
Loss = 7.2738e-02, PNorm = 44.8098, GNorm = 0.5844, lr_0 = 1.2578e-04
Loss = 7.0670e-02, PNorm = 44.8138, GNorm = 1.0226, lr_0 = 1.2304e-04
Validation rmse = 0.109643
Validation r2 = 0.854810
Validation mse = 0.012022
Epoch 52
Loss = 6.5410e-02, PNorm = 44.8190, GNorm = 1.0205, lr_0 = 1.2009e-04
Loss = 7.9366e-02, PNorm = 44.8216, GNorm = 1.6182, lr_0 = 1.1747e-04
Loss = 8.3640e-02, PNorm = 44.8222, GNorm = 3.8962, lr_0 = 1.1721e-04
Validation rmse = 0.099592
Validation r2 = 0.880209
Validation mse = 0.009919
Epoch 53
Loss = 6.9682e-02, PNorm = 44.8267, GNorm = 1.1117, lr_0 = 1.1465e-04
Validation rmse = 0.107953
Validation r2 = 0.859252
Validation mse = 0.011654
Epoch 54
Loss = 7.3269e-02, PNorm = 44.8305, GNorm = 0.5515, lr_0 = 1.1191e-04
Loss = 7.0615e-02, PNorm = 44.8341, GNorm = 0.7473, lr_0 = 1.0946e-04
Validation rmse = 0.105743
Validation r2 = 0.864955
Validation mse = 0.011182
Epoch 55
Loss = 6.6191e-02, PNorm = 44.8378, GNorm = 0.3746, lr_0 = 1.0684e-04
Loss = 6.4250e-02, PNorm = 44.8412, GNorm = 0.4484, lr_0 = 1.0451e-04
Validation rmse = 0.102051
Validation r2 = 0.874219
Validation mse = 0.010415
Epoch 56
Loss = 5.7528e-02, PNorm = 44.8450, GNorm = 0.5433, lr_0 = 1.0200e-04
Loss = 6.4064e-02, PNorm = 44.8485, GNorm = 1.7930, lr_0 = 1.0000e-04
Validation rmse = 0.103823
Validation r2 = 0.869814
Validation mse = 0.010779
Epoch 57
Loss = 6.0540e-02, PNorm = 44.8517, GNorm = 1.8959, lr_0 = 1.0000e-04
Loss = 6.8680e-02, PNorm = 44.8544, GNorm = 0.9512, lr_0 = 1.0000e-04
Loss = 1.1413e-01, PNorm = 44.8547, GNorm = 3.6312, lr_0 = 1.0000e-04
Validation rmse = 0.100835
Validation r2 = 0.877200
Validation mse = 0.010168
Epoch 58
Loss = 6.3125e-02, PNorm = 44.8578, GNorm = 0.4917, lr_0 = 1.0000e-04
Validation rmse = 0.103313
Validation r2 = 0.871091
Validation mse = 0.010673
Epoch 59
Loss = 7.7866e-02, PNorm = 44.8617, GNorm = 1.7312, lr_0 = 1.0000e-04
Loss = 6.7860e-02, PNorm = 44.8646, GNorm = 1.3230, lr_0 = 1.0000e-04
Validation rmse = 0.106253
Validation r2 = 0.863650
Validation mse = 0.011290
Model 0 best validation rmse = 0.099592 on epoch 52
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.190773
Model 0 test r2 = -0.064485
Model 0 test mse = 0.036394
Ensemble test rmse = 0.190773
Ensemble test r2 = -0.064485
Ensemble test mse = 0.036394
Fold 8
Splitting data with seed 8
Total size = 916 | train size = 906 | val size = 10 | test size = 116
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.5759e-01, PNorm = 43.2655, GNorm = 5.4285, lr_0 = 3.7500e-04
Validation rmse = 0.194666
Validation r2 = 0.664689
Validation mse = 0.037895
Epoch 1
Loss = 9.0277e-01, PNorm = 43.2876, GNorm = 13.8095, lr_0 = 6.5000e-04
Loss = 6.5463e-01, PNorm = 43.3255, GNorm = 2.4231, lr_0 = 9.0000e-04
Validation rmse = 0.352382
Validation r2 = -0.098738
Validation mse = 0.124173
Epoch 2
Loss = 7.5019e-01, PNorm = 43.3982, GNorm = 6.0699, lr_0 = 9.8468e-04
Loss = 6.3903e-01, PNorm = 43.4711, GNorm = 6.0629, lr_0 = 9.6320e-04
Validation rmse = 0.228313
Validation r2 = 0.538759
Validation mse = 0.052127
Epoch 3
Loss = 4.8219e-01, PNorm = 43.5558, GNorm = 4.6295, lr_0 = 9.4011e-04
Loss = 4.3485e-01, PNorm = 43.6245, GNorm = 5.6510, lr_0 = 9.1961e-04
Validation rmse = 0.070678
Validation r2 = 0.955798
Validation mse = 0.004995
Epoch 4
Loss = 3.3153e-01, PNorm = 43.7001, GNorm = 3.7351, lr_0 = 8.9756e-04
Loss = 3.0851e-01, PNorm = 43.7539, GNorm = 1.3047, lr_0 = 8.7798e-04
Loss = 2.8066e-01, PNorm = 43.7586, GNorm = 2.1735, lr_0 = 8.7605e-04
Validation rmse = 0.242787
Validation r2 = 0.478425
Validation mse = 0.058946
Epoch 5
Loss = 3.0759e-01, PNorm = 43.8150, GNorm = 1.0459, lr_0 = 8.5694e-04
Validation rmse = 0.112676
Validation r2 = 0.887661
Validation mse = 0.012696
Epoch 6
Loss = 1.9524e-01, PNorm = 43.8605, GNorm = 2.3085, lr_0 = 8.3640e-04
Loss = 1.9497e-01, PNorm = 43.8930, GNorm = 2.2065, lr_0 = 8.1815e-04
Validation rmse = 0.122868
Validation r2 = 0.866419
Validation mse = 0.015097
Epoch 7
Loss = 1.7018e-01, PNorm = 43.9280, GNorm = 1.0923, lr_0 = 7.9854e-04
Loss = 1.7599e-01, PNorm = 43.9615, GNorm = 2.7281, lr_0 = 7.8112e-04
Validation rmse = 0.132959
Validation r2 = 0.843578
Validation mse = 0.017678
Epoch 8
Loss = 1.8129e-01, PNorm = 43.9867, GNorm = 2.0908, lr_0 = 7.6240e-04
Loss = 1.6471e-01, PNorm = 44.0062, GNorm = 0.6482, lr_0 = 7.4577e-04
Validation rmse = 0.112999
Validation r2 = 0.887016
Validation mse = 0.012769
Epoch 9
Loss = 1.8042e-01, PNorm = 44.0304, GNorm = 6.1629, lr_0 = 7.2950e-04
Loss = 1.5724e-01, PNorm = 44.0562, GNorm = 4.8818, lr_0 = 7.1359e-04
Validation rmse = 0.128912
Validation r2 = 0.852954
Validation mse = 0.016618
Epoch 10
Loss = 1.5252e-01, PNorm = 44.0751, GNorm = 2.1429, lr_0 = 6.9649e-04
Validation rmse = 0.154121
Validation r2 = 0.789821
Validation mse = 0.023753
Epoch 11
Loss = 1.3949e-01, PNorm = 44.1001, GNorm = 2.7772, lr_0 = 6.7979e-04
Loss = 1.6957e-01, PNorm = 44.1253, GNorm = 1.9829, lr_0 = 6.6496e-04
Validation rmse = 0.107789
Validation r2 = 0.897195
Validation mse = 0.011618
Epoch 12
Loss = 1.7488e-01, PNorm = 44.1476, GNorm = 2.7909, lr_0 = 6.4902e-04
Loss = 1.5071e-01, PNorm = 44.1702, GNorm = 0.6460, lr_0 = 6.3487e-04
Validation rmse = 0.121961
Validation r2 = 0.868385
Validation mse = 0.014874
Epoch 13
Loss = 1.2649e-01, PNorm = 44.1877, GNorm = 0.6614, lr_0 = 6.1965e-04
Loss = 1.3904e-01, PNorm = 44.2086, GNorm = 1.4320, lr_0 = 6.0613e-04
Validation rmse = 0.172816
Validation r2 = 0.735738
Validation mse = 0.029865
Epoch 14
Loss = 1.2270e-01, PNorm = 44.2325, GNorm = 0.9781, lr_0 = 5.9160e-04
Loss = 1.2348e-01, PNorm = 44.2472, GNorm = 1.0911, lr_0 = 5.7870e-04
Validation rmse = 0.155212
Validation r2 = 0.786836
Validation mse = 0.024091
Epoch 15
Loss = 1.2905e-01, PNorm = 44.2630, GNorm = 4.3290, lr_0 = 5.6483e-04
Validation rmse = 0.127066
Validation r2 = 0.857135
Validation mse = 0.016146
Epoch 16
Loss = 2.0960e-01, PNorm = 44.2832, GNorm = 3.9683, lr_0 = 5.5129e-04
Loss = 1.3769e-01, PNorm = 44.2991, GNorm = 2.6125, lr_0 = 5.3926e-04
Validation rmse = 0.122683
Validation r2 = 0.866822
Validation mse = 0.015051
Epoch 17
Loss = 1.4423e-01, PNorm = 44.3132, GNorm = 1.6149, lr_0 = 5.2750e-04
Loss = 1.2284e-01, PNorm = 44.3266, GNorm = 0.4858, lr_0 = 5.1599e-04
Validation rmse = 0.153976
Validation r2 = 0.790215
Validation mse = 0.023709
Epoch 18
Loss = 1.4341e-01, PNorm = 44.3475, GNorm = 2.0826, lr_0 = 5.0362e-04
Loss = 1.3718e-01, PNorm = 44.3621, GNorm = 5.4441, lr_0 = 4.9264e-04
Validation rmse = 0.140730
Validation r2 = 0.824757
Validation mse = 0.019805
Epoch 19
Loss = 1.3959e-01, PNorm = 44.3790, GNorm = 2.8126, lr_0 = 4.8083e-04
Loss = 1.6463e-01, PNorm = 44.3991, GNorm = 0.9338, lr_0 = 4.7034e-04
Validation rmse = 0.185646
Validation r2 = 0.695043
Validation mse = 0.034465
Epoch 20
Loss = 1.3705e-01, PNorm = 44.4250, GNorm = 0.9340, lr_0 = 4.5907e-04
Loss = 1.3297e-01, PNorm = 44.4428, GNorm = 0.8666, lr_0 = 4.4905e-04
Loss = 1.3780e-01, PNorm = 44.4448, GNorm = 4.9638, lr_0 = 4.4806e-04
Validation rmse = 0.152628
Validation r2 = 0.793872
Validation mse = 0.023295
Epoch 21
Loss = 1.1601e-01, PNorm = 44.4587, GNorm = 0.4771, lr_0 = 4.3829e-04
Validation rmse = 0.152524
Validation r2 = 0.794154
Validation mse = 0.023264
Epoch 22
Loss = 1.1201e-01, PNorm = 44.4742, GNorm = 2.2768, lr_0 = 4.2779e-04
Loss = 1.1329e-01, PNorm = 44.4859, GNorm = 2.2976, lr_0 = 4.1845e-04
Validation rmse = 0.144017
Validation r2 = 0.816476
Validation mse = 0.020741
Epoch 23
Loss = 1.0077e-01, PNorm = 44.4995, GNorm = 1.1534, lr_0 = 4.0842e-04
Loss = 1.0520e-01, PNorm = 44.5097, GNorm = 1.0986, lr_0 = 3.9951e-04
Validation rmse = 0.138588
Validation r2 = 0.830053
Validation mse = 0.019207
Epoch 24
Loss = 8.5628e-02, PNorm = 44.5188, GNorm = 1.0248, lr_0 = 3.8994e-04
Loss = 1.0780e-01, PNorm = 44.5295, GNorm = 1.0531, lr_0 = 3.8143e-04
Validation rmse = 0.133578
Validation r2 = 0.842116
Validation mse = 0.017843
Epoch 25
Loss = 9.3088e-02, PNorm = 44.5385, GNorm = 1.3188, lr_0 = 3.7311e-04
Loss = 9.3898e-02, PNorm = 44.5467, GNorm = 1.6472, lr_0 = 3.6497e-04
Validation rmse = 0.151246
Validation r2 = 0.797588
Validation mse = 0.022875
Epoch 26
Loss = 9.9866e-02, PNorm = 44.5578, GNorm = 1.2093, lr_0 = 3.5622e-04
Validation rmse = 0.156857
Validation r2 = 0.782291
Validation mse = 0.024604
Epoch 27
Loss = 6.4950e-02, PNorm = 44.5682, GNorm = 1.7609, lr_0 = 3.4769e-04
Loss = 9.0878e-02, PNorm = 44.5775, GNorm = 0.8924, lr_0 = 3.4010e-04
Validation rmse = 0.125448
Validation r2 = 0.860750
Validation mse = 0.015737
Epoch 28
Loss = 9.2402e-02, PNorm = 44.5875, GNorm = 2.1353, lr_0 = 3.3195e-04
Loss = 7.6616e-02, PNorm = 44.5987, GNorm = 0.4590, lr_0 = 3.2471e-04
Validation rmse = 0.126792
Validation r2 = 0.857752
Validation mse = 0.016076
Epoch 29
Loss = 8.8267e-02, PNorm = 44.6092, GNorm = 1.2046, lr_0 = 3.1693e-04
Loss = 8.7790e-02, PNorm = 44.6174, GNorm = 1.7977, lr_0 = 3.1001e-04
Validation rmse = 0.139532
Validation r2 = 0.827728
Validation mse = 0.019469
Epoch 30
Loss = 8.8061e-02, PNorm = 44.6262, GNorm = 0.6070, lr_0 = 3.0258e-04
Loss = 9.8940e-02, PNorm = 44.6343, GNorm = 1.7789, lr_0 = 2.9598e-04
Validation rmse = 0.149432
Validation r2 = 0.802415
Validation mse = 0.022330
Epoch 31
Loss = 8.5866e-02, PNorm = 44.6443, GNorm = 0.6820, lr_0 = 2.8889e-04
Validation rmse = 0.147537
Validation r2 = 0.807396
Validation mse = 0.021767
Epoch 32
Loss = 1.0549e-01, PNorm = 44.6536, GNorm = 0.8127, lr_0 = 2.8196e-04
Loss = 9.1525e-02, PNorm = 44.6615, GNorm = 0.8954, lr_0 = 2.7581e-04
Validation rmse = 0.145453
Validation r2 = 0.812797
Validation mse = 0.021157
Epoch 33
Loss = 8.6625e-02, PNorm = 44.6706, GNorm = 0.7908, lr_0 = 2.6920e-04
Loss = 8.1746e-02, PNorm = 44.6771, GNorm = 0.5663, lr_0 = 2.6333e-04
Validation rmse = 0.145434
Validation r2 = 0.812848
Validation mse = 0.021151
Epoch 34
Loss = 7.4194e-02, PNorm = 44.6848, GNorm = 0.9641, lr_0 = 2.5758e-04
Loss = 8.6176e-02, PNorm = 44.6932, GNorm = 1.1993, lr_0 = 2.5197e-04
Validation rmse = 0.193502
Validation r2 = 0.668687
Validation mse = 0.037443
Epoch 35
Loss = 1.0981e-01, PNorm = 44.7057, GNorm = 1.0375, lr_0 = 2.4593e-04
Loss = 8.8168e-02, PNorm = 44.7155, GNorm = 1.1622, lr_0 = 2.4056e-04
Validation rmse = 0.139177
Validation r2 = 0.828604
Validation mse = 0.019370
Epoch 36
Loss = 8.2495e-02, PNorm = 44.7243, GNorm = 0.7953, lr_0 = 2.3480e-04
Loss = 8.0669e-02, PNorm = 44.7325, GNorm = 0.3995, lr_0 = 2.2967e-04
Loss = 5.8323e-02, PNorm = 44.7335, GNorm = 1.9714, lr_0 = 2.2917e-04
Validation rmse = 0.145264
Validation r2 = 0.813283
Validation mse = 0.021102
Epoch 37
Loss = 7.3910e-02, PNorm = 44.7401, GNorm = 0.8034, lr_0 = 2.2417e-04
Validation rmse = 0.150600
Validation r2 = 0.799316
Validation mse = 0.022680
Epoch 38
Loss = 6.4480e-02, PNorm = 44.7473, GNorm = 0.6885, lr_0 = 2.1880e-04
Loss = 8.1108e-02, PNorm = 44.7544, GNorm = 0.8177, lr_0 = 2.1402e-04
Validation rmse = 0.135470
Validation r2 = 0.837612
Validation mse = 0.018352
Epoch 39
Loss = 1.0031e-01, PNorm = 44.7615, GNorm = 2.0472, lr_0 = 2.0889e-04
Loss = 7.0881e-02, PNorm = 44.7675, GNorm = 1.6468, lr_0 = 2.0434e-04
Validation rmse = 0.123776
Validation r2 = 0.864437
Validation mse = 0.015321
Epoch 40
Loss = 7.7331e-02, PNorm = 44.7739, GNorm = 1.2423, lr_0 = 1.9944e-04
Loss = 8.2025e-02, PNorm = 44.7804, GNorm = 0.6079, lr_0 = 1.9509e-04
Validation rmse = 0.137252
Validation r2 = 0.833311
Validation mse = 0.018838
Epoch 41
Loss = 6.7958e-02, PNorm = 44.7862, GNorm = 0.5036, lr_0 = 1.9041e-04
Loss = 7.7824e-02, PNorm = 44.7926, GNorm = 1.8632, lr_0 = 1.8626e-04
Validation rmse = 0.151128
Validation r2 = 0.797906
Validation mse = 0.022840
Epoch 42
Loss = 8.6641e-02, PNorm = 44.7992, GNorm = 2.3535, lr_0 = 1.8219e-04
Validation rmse = 0.152432
Validation r2 = 0.794402
Validation mse = 0.023235
Epoch 43
Loss = 8.5981e-02, PNorm = 44.8062, GNorm = 0.5723, lr_0 = 1.7783e-04
Loss = 7.9957e-02, PNorm = 44.8111, GNorm = 1.3018, lr_0 = 1.7395e-04
Validation rmse = 0.139498
Validation r2 = 0.827813
Validation mse = 0.019460
Epoch 44
Loss = 6.4237e-02, PNorm = 44.8189, GNorm = 0.7217, lr_0 = 1.6978e-04
Loss = 7.0895e-02, PNorm = 44.8238, GNorm = 0.7913, lr_0 = 1.6608e-04
Validation rmse = 0.144226
Validation r2 = 0.815944
Validation mse = 0.020801
Epoch 45
Loss = 7.8715e-02, PNorm = 44.8303, GNorm = 0.6190, lr_0 = 1.6210e-04
Loss = 6.7355e-02, PNorm = 44.8355, GNorm = 0.7412, lr_0 = 1.5856e-04
Validation rmse = 0.133775
Validation r2 = 0.841651
Validation mse = 0.017896
Epoch 46
Loss = 7.1873e-02, PNorm = 44.8404, GNorm = 0.5747, lr_0 = 1.5476e-04
Loss = 7.0620e-02, PNorm = 44.8463, GNorm = 0.5012, lr_0 = 1.5138e-04
Validation rmse = 0.132182
Validation r2 = 0.845400
Validation mse = 0.017472
Epoch 47
Loss = 7.3329e-02, PNorm = 44.8527, GNorm = 0.5553, lr_0 = 1.4775e-04
Validation rmse = 0.137442
Validation r2 = 0.832850
Validation mse = 0.018890
Epoch 48
Loss = 4.6195e-02, PNorm = 44.8582, GNorm = 0.4428, lr_0 = 1.4421e-04
Loss = 6.8646e-02, PNorm = 44.8634, GNorm = 0.6191, lr_0 = 1.4107e-04
Validation rmse = 0.139217
Validation r2 = 0.828504
Validation mse = 0.019381
Epoch 49
Loss = 5.9943e-02, PNorm = 44.8679, GNorm = 0.6498, lr_0 = 1.3769e-04
Loss = 6.7744e-02, PNorm = 44.8732, GNorm = 0.4644, lr_0 = 1.3468e-04
Validation rmse = 0.138288
Validation r2 = 0.830786
Validation mse = 0.019124
Epoch 50
Loss = 6.8128e-02, PNorm = 44.8776, GNorm = 0.6330, lr_0 = 1.3174e-04
Loss = 6.6125e-02, PNorm = 44.8813, GNorm = 0.6525, lr_0 = 1.2887e-04
Validation rmse = 0.128854
Validation r2 = 0.853086
Validation mse = 0.016603
Epoch 51
Loss = 6.9257e-02, PNorm = 44.8866, GNorm = 0.9030, lr_0 = 1.2578e-04
Loss = 6.3524e-02, PNorm = 44.8910, GNorm = 1.2909, lr_0 = 1.2304e-04
Validation rmse = 0.127855
Validation r2 = 0.855355
Validation mse = 0.016347
Epoch 52
Loss = 6.7428e-02, PNorm = 44.8962, GNorm = 0.5903, lr_0 = 1.2009e-04
Loss = 6.4894e-02, PNorm = 44.8994, GNorm = 0.7114, lr_0 = 1.1747e-04
Loss = 1.9276e-02, PNorm = 44.8997, GNorm = 1.5930, lr_0 = 1.1721e-04
Validation rmse = 0.138532
Validation r2 = 0.830189
Validation mse = 0.019191
Epoch 53
Loss = 6.8411e-02, PNorm = 44.9041, GNorm = 1.2911, lr_0 = 1.1465e-04
Validation rmse = 0.136894
Validation r2 = 0.834182
Validation mse = 0.018740
Epoch 54
Loss = 6.5822e-02, PNorm = 44.9080, GNorm = 0.9994, lr_0 = 1.1191e-04
Loss = 6.1205e-02, PNorm = 44.9119, GNorm = 0.8809, lr_0 = 1.0946e-04
Validation rmse = 0.134204
Validation r2 = 0.840632
Validation mse = 0.018011
Epoch 55
Loss = 6.0898e-02, PNorm = 44.9166, GNorm = 1.3209, lr_0 = 1.0684e-04
Loss = 6.5603e-02, PNorm = 44.9208, GNorm = 0.6469, lr_0 = 1.0451e-04
Validation rmse = 0.129493
Validation r2 = 0.851626
Validation mse = 0.016768
Epoch 56
Loss = 5.8117e-02, PNorm = 44.9244, GNorm = 0.6133, lr_0 = 1.0200e-04
Loss = 6.6179e-02, PNorm = 44.9283, GNorm = 0.4404, lr_0 = 1.0000e-04
Validation rmse = 0.142313
Validation r2 = 0.820793
Validation mse = 0.020253
Epoch 57
Loss = 5.7151e-02, PNorm = 44.9328, GNorm = 1.0586, lr_0 = 1.0000e-04
Loss = 6.8074e-02, PNorm = 44.9359, GNorm = 0.9751, lr_0 = 1.0000e-04
Loss = 6.4167e-02, PNorm = 44.9363, GNorm = 1.9023, lr_0 = 1.0000e-04
Validation rmse = 0.129179
Validation r2 = 0.852344
Validation mse = 0.016687
Epoch 58
Loss = 6.2460e-02, PNorm = 44.9393, GNorm = 2.3457, lr_0 = 1.0000e-04
Validation rmse = 0.138227
Validation r2 = 0.830936
Validation mse = 0.019107
Epoch 59
Loss = 7.5610e-02, PNorm = 44.9434, GNorm = 1.1126, lr_0 = 1.0000e-04
Loss = 5.2999e-02, PNorm = 44.9469, GNorm = 0.6066, lr_0 = 1.0000e-04
Validation rmse = 0.133809
Validation r2 = 0.841571
Validation mse = 0.017905
Model 0 best validation rmse = 0.070678 on epoch 3
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.138133
Model 0 test r2 = 0.441917
Model 0 test mse = 0.019081
Ensemble test rmse = 0.138133
Ensemble test r2 = 0.441917
Ensemble test mse = 0.019081
Fold 9
Splitting data with seed 9
Total size = 916 | train size = 906 | val size = 10 | test size = 116
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.0586e-01, PNorm = 43.2650, GNorm = 0.8672, lr_0 = 3.7500e-04
Validation rmse = 0.345118
Validation r2 = -0.152048
Validation mse = 0.119107
Epoch 1
Loss = 8.3225e-01, PNorm = 43.2934, GNorm = 11.6299, lr_0 = 6.5000e-04
Loss = 6.8157e-01, PNorm = 43.3301, GNorm = 2.0936, lr_0 = 9.0000e-04
Validation rmse = 0.251335
Validation r2 = 0.389000
Validation mse = 0.063169
Epoch 2
Loss = 4.4844e-01, PNorm = 43.4024, GNorm = 2.0926, lr_0 = 9.8468e-04
Loss = 4.4761e-01, PNorm = 43.4760, GNorm = 10.7801, lr_0 = 9.6320e-04
Validation rmse = 0.215970
Validation r2 = 0.548849
Validation mse = 0.046643
Epoch 3
Loss = 4.3536e-01, PNorm = 43.5527, GNorm = 4.7021, lr_0 = 9.4011e-04
Loss = 3.8201e-01, PNorm = 43.6168, GNorm = 10.1648, lr_0 = 9.1961e-04
Validation rmse = 0.203655
Validation r2 = 0.598834
Validation mse = 0.041475
Epoch 4
Loss = 2.3663e-01, PNorm = 43.6783, GNorm = 1.7421, lr_0 = 8.9756e-04
Loss = 2.7618e-01, PNorm = 43.7232, GNorm = 1.9658, lr_0 = 8.7798e-04
Loss = 3.8569e-01, PNorm = 43.7271, GNorm = 10.1541, lr_0 = 8.7605e-04
Validation rmse = 0.190907
Validation r2 = 0.647486
Validation mse = 0.036445
Epoch 5
Loss = 2.5344e-01, PNorm = 43.7690, GNorm = 1.2304, lr_0 = 8.5694e-04
Validation rmse = 0.196856
Validation r2 = 0.625172
Validation mse = 0.038752
Epoch 6
Loss = 2.0006e-01, PNorm = 43.8136, GNorm = 4.4195, lr_0 = 8.3640e-04
Loss = 2.0257e-01, PNorm = 43.8450, GNorm = 2.2480, lr_0 = 8.1815e-04
Validation rmse = 0.197927
Validation r2 = 0.621082
Validation mse = 0.039175
Epoch 7
Loss = 2.4881e-01, PNorm = 43.8727, GNorm = 5.2315, lr_0 = 7.9854e-04
Loss = 1.8420e-01, PNorm = 43.9002, GNorm = 2.2984, lr_0 = 7.8112e-04
Validation rmse = 0.189574
Validation r2 = 0.652391
Validation mse = 0.035938
Epoch 8
Loss = 2.2379e-01, PNorm = 43.9246, GNorm = 7.9442, lr_0 = 7.6240e-04
Loss = 2.5758e-01, PNorm = 43.9541, GNorm = 4.6976, lr_0 = 7.4577e-04
Validation rmse = 0.204506
Validation r2 = 0.595475
Validation mse = 0.041823
Epoch 9
Loss = 1.9382e-01, PNorm = 43.9854, GNorm = 2.9014, lr_0 = 7.2950e-04
Loss = 1.8030e-01, PNorm = 44.0141, GNorm = 3.1134, lr_0 = 7.1359e-04
Validation rmse = 0.176555
Validation r2 = 0.698495
Validation mse = 0.031172
Epoch 10
Loss = 1.4063e-01, PNorm = 44.0347, GNorm = 2.8918, lr_0 = 6.9649e-04
Validation rmse = 0.194504
Validation r2 = 0.634077
Validation mse = 0.037832
Epoch 11
Loss = 1.2013e-01, PNorm = 44.0639, GNorm = 3.3094, lr_0 = 6.7979e-04
Loss = 1.6065e-01, PNorm = 44.0809, GNorm = 3.8666, lr_0 = 6.6496e-04
Validation rmse = 0.190817
Validation r2 = 0.647816
Validation mse = 0.036411
Epoch 12
Loss = 1.2007e-01, PNorm = 44.1003, GNorm = 1.9635, lr_0 = 6.4902e-04
Loss = 1.3854e-01, PNorm = 44.1153, GNorm = 3.1354, lr_0 = 6.3487e-04
Validation rmse = 0.170497
Validation r2 = 0.718830
Validation mse = 0.029069
Epoch 13
Loss = 1.4238e-01, PNorm = 44.1370, GNorm = 2.9352, lr_0 = 6.1965e-04
Loss = 1.5140e-01, PNorm = 44.1521, GNorm = 1.1117, lr_0 = 6.0613e-04
Validation rmse = 0.188713
Validation r2 = 0.655539
Validation mse = 0.035613
Epoch 14
Loss = 1.3425e-01, PNorm = 44.1689, GNorm = 3.1008, lr_0 = 5.9160e-04
Loss = 1.2551e-01, PNorm = 44.1833, GNorm = 2.6122, lr_0 = 5.7870e-04
Validation rmse = 0.190044
Validation r2 = 0.650665
Validation mse = 0.036117
Epoch 15
Loss = 1.1737e-01, PNorm = 44.1990, GNorm = 0.9823, lr_0 = 5.6483e-04
Validation rmse = 0.165252
Validation r2 = 0.735863
Validation mse = 0.027308
Epoch 16
Loss = 1.2040e-01, PNorm = 44.2125, GNorm = 0.9897, lr_0 = 5.5129e-04
Loss = 1.2379e-01, PNorm = 44.2285, GNorm = 0.9171, lr_0 = 5.3926e-04
Validation rmse = 0.194239
Validation r2 = 0.635071
Validation mse = 0.037729
Epoch 17
Loss = 1.7785e-01, PNorm = 44.2394, GNorm = 3.2645, lr_0 = 5.2750e-04
Loss = 1.3494e-01, PNorm = 44.2545, GNorm = 0.8037, lr_0 = 5.1599e-04
Validation rmse = 0.163765
Validation r2 = 0.740596
Validation mse = 0.026819
Epoch 18
Loss = 1.2912e-01, PNorm = 44.2745, GNorm = 3.4532, lr_0 = 5.0362e-04
Loss = 1.4291e-01, PNorm = 44.2930, GNorm = 1.6820, lr_0 = 4.9264e-04
Validation rmse = 0.202126
Validation r2 = 0.604834
Validation mse = 0.040855
Epoch 19
Loss = 1.3153e-01, PNorm = 44.3107, GNorm = 6.1143, lr_0 = 4.8083e-04
Loss = 1.4539e-01, PNorm = 44.3278, GNorm = 3.2774, lr_0 = 4.7034e-04
Validation rmse = 0.176162
Validation r2 = 0.699835
Validation mse = 0.031033
Epoch 20
Loss = 1.2483e-01, PNorm = 44.3474, GNorm = 1.4650, lr_0 = 4.5907e-04
Loss = 1.0511e-01, PNorm = 44.3594, GNorm = 2.0286, lr_0 = 4.4905e-04
Loss = 1.3987e-01, PNorm = 44.3605, GNorm = 4.5091, lr_0 = 4.4806e-04
Validation rmse = 0.176333
Validation r2 = 0.699252
Validation mse = 0.031093
Epoch 21
Loss = 1.0561e-01, PNorm = 44.3694, GNorm = 1.3103, lr_0 = 4.3829e-04
Validation rmse = 0.183833
Validation r2 = 0.673127
Validation mse = 0.033794
Epoch 22
Loss = 7.6564e-02, PNorm = 44.3840, GNorm = 1.4317, lr_0 = 4.2779e-04
Loss = 1.0828e-01, PNorm = 44.3967, GNorm = 2.6619, lr_0 = 4.1845e-04
Validation rmse = 0.179531
Validation r2 = 0.688247
Validation mse = 0.032231
Epoch 23
Loss = 1.0874e-01, PNorm = 44.4098, GNorm = 0.4785, lr_0 = 4.0842e-04
Loss = 1.1956e-01, PNorm = 44.4224, GNorm = 1.5690, lr_0 = 3.9951e-04
Validation rmse = 0.165840
Validation r2 = 0.733980
Validation mse = 0.027503
Epoch 24
Loss = 1.0875e-01, PNorm = 44.4372, GNorm = 1.1524, lr_0 = 3.8994e-04
Loss = 9.5559e-02, PNorm = 44.4503, GNorm = 0.5085, lr_0 = 3.8143e-04
Validation rmse = 0.170088
Validation r2 = 0.720179
Validation mse = 0.028930
Epoch 25
Loss = 9.0717e-02, PNorm = 44.4607, GNorm = 1.4783, lr_0 = 3.7311e-04
Loss = 9.4654e-02, PNorm = 44.4695, GNorm = 0.8762, lr_0 = 3.6497e-04
Validation rmse = 0.175682
Validation r2 = 0.701471
Validation mse = 0.030864
Epoch 26
Loss = 1.0638e-01, PNorm = 44.4805, GNorm = 0.8111, lr_0 = 3.5622e-04
Validation rmse = 0.168043
Validation r2 = 0.726865
Validation mse = 0.028239
Epoch 27
Loss = 1.2634e-01, PNorm = 44.4925, GNorm = 0.8771, lr_0 = 3.4769e-04
Loss = 9.1941e-02, PNorm = 44.5029, GNorm = 3.1497, lr_0 = 3.4010e-04
Validation rmse = 0.167861
Validation r2 = 0.727459
Validation mse = 0.028177
Epoch 28
Loss = 8.8527e-02, PNorm = 44.5117, GNorm = 0.8535, lr_0 = 3.3195e-04
Loss = 8.8048e-02, PNorm = 44.5217, GNorm = 0.7799, lr_0 = 3.2471e-04
Validation rmse = 0.164574
Validation r2 = 0.738027
Validation mse = 0.027085
Epoch 29
Loss = 1.0406e-01, PNorm = 44.5311, GNorm = 2.0314, lr_0 = 3.1693e-04
Loss = 9.4986e-02, PNorm = 44.5416, GNorm = 1.2496, lr_0 = 3.1001e-04
Validation rmse = 0.161913
Validation r2 = 0.746431
Validation mse = 0.026216
Epoch 30
Loss = 1.0559e-01, PNorm = 44.5503, GNorm = 3.5769, lr_0 = 3.0258e-04
Loss = 8.7862e-02, PNorm = 44.5590, GNorm = 1.5439, lr_0 = 2.9598e-04
Validation rmse = 0.166489
Validation r2 = 0.731895
Validation mse = 0.027719
Epoch 31
Loss = 7.3750e-02, PNorm = 44.5690, GNorm = 0.6219, lr_0 = 2.8889e-04
Validation rmse = 0.164084
Validation r2 = 0.739583
Validation mse = 0.026924
Epoch 32
Loss = 1.4509e-01, PNorm = 44.5757, GNorm = 3.2549, lr_0 = 2.8196e-04
Loss = 8.0504e-02, PNorm = 44.5852, GNorm = 0.5442, lr_0 = 2.7581e-04
Validation rmse = 0.171892
Validation r2 = 0.714211
Validation mse = 0.029547
Epoch 33
Loss = 9.1504e-02, PNorm = 44.5952, GNorm = 0.5463, lr_0 = 2.6920e-04
Loss = 9.3476e-02, PNorm = 44.6038, GNorm = 0.8367, lr_0 = 2.6333e-04
Validation rmse = 0.168989
Validation r2 = 0.723782
Validation mse = 0.028557
Epoch 34
Loss = 7.8627e-02, PNorm = 44.6125, GNorm = 0.9324, lr_0 = 2.5758e-04
Loss = 8.0537e-02, PNorm = 44.6195, GNorm = 0.3561, lr_0 = 2.5197e-04
Validation rmse = 0.169663
Validation r2 = 0.721574
Validation mse = 0.028786
Epoch 35
Loss = 8.9226e-02, PNorm = 44.6278, GNorm = 1.1167, lr_0 = 2.4593e-04
Loss = 7.8096e-02, PNorm = 44.6352, GNorm = 1.2447, lr_0 = 2.4056e-04
Validation rmse = 0.173669
Validation r2 = 0.708271
Validation mse = 0.030161
Epoch 36
Loss = 9.7710e-02, PNorm = 44.6441, GNorm = 3.3439, lr_0 = 2.3480e-04
Loss = 8.6507e-02, PNorm = 44.6516, GNorm = 0.8498, lr_0 = 2.2967e-04
Loss = 1.2273e-01, PNorm = 44.6523, GNorm = 2.5381, lr_0 = 2.2917e-04
Validation rmse = 0.174367
Validation r2 = 0.705921
Validation mse = 0.030404
Epoch 37
Loss = 8.4317e-02, PNorm = 44.6606, GNorm = 3.1356, lr_0 = 2.2417e-04
Validation rmse = 0.162137
Validation r2 = 0.745728
Validation mse = 0.026288
Epoch 38
Loss = 6.6389e-02, PNorm = 44.6675, GNorm = 0.7561, lr_0 = 2.1880e-04
Loss = 7.9569e-02, PNorm = 44.6741, GNorm = 0.9107, lr_0 = 2.1402e-04
Validation rmse = 0.171899
Validation r2 = 0.714187
Validation mse = 0.029549
Epoch 39
Loss = 7.6484e-02, PNorm = 44.6813, GNorm = 0.8979, lr_0 = 2.0889e-04
Loss = 6.8032e-02, PNorm = 44.6877, GNorm = 0.9176, lr_0 = 2.0434e-04
Validation rmse = 0.168134
Validation r2 = 0.726570
Validation mse = 0.028269
Epoch 40
Loss = 7.6435e-02, PNorm = 44.6961, GNorm = 0.6829, lr_0 = 1.9944e-04
Loss = 7.5233e-02, PNorm = 44.7029, GNorm = 1.1842, lr_0 = 1.9509e-04
Validation rmse = 0.172402
Validation r2 = 0.712511
Validation mse = 0.029723
Epoch 41
Loss = 7.2235e-02, PNorm = 44.7096, GNorm = 0.4127, lr_0 = 1.9041e-04
Loss = 7.5561e-02, PNorm = 44.7146, GNorm = 0.8769, lr_0 = 1.8626e-04
Validation rmse = 0.169252
Validation r2 = 0.722922
Validation mse = 0.028646
Epoch 42
Loss = 8.6724e-02, PNorm = 44.7205, GNorm = 1.3615, lr_0 = 1.8219e-04
Validation rmse = 0.165361
Validation r2 = 0.735515
Validation mse = 0.027344
Epoch 43
Loss = 3.5668e-02, PNorm = 44.7272, GNorm = 0.4011, lr_0 = 1.7783e-04
Loss = 7.0135e-02, PNorm = 44.7331, GNorm = 0.9677, lr_0 = 1.7395e-04
Validation rmse = 0.165024
Validation r2 = 0.736591
Validation mse = 0.027233
Epoch 44
Loss = 5.7407e-02, PNorm = 44.7380, GNorm = 1.1565, lr_0 = 1.6978e-04
Loss = 7.7936e-02, PNorm = 44.7435, GNorm = 0.6423, lr_0 = 1.6608e-04
Validation rmse = 0.168693
Validation r2 = 0.724748
Validation mse = 0.028457
Epoch 45
Loss = 7.4663e-02, PNorm = 44.7499, GNorm = 0.7799, lr_0 = 1.6210e-04
Loss = 7.0819e-02, PNorm = 44.7550, GNorm = 0.5873, lr_0 = 1.5856e-04
Validation rmse = 0.164961
Validation r2 = 0.736793
Validation mse = 0.027212
Epoch 46
Loss = 6.3642e-02, PNorm = 44.7612, GNorm = 0.4610, lr_0 = 1.5476e-04
Loss = 7.3880e-02, PNorm = 44.7669, GNorm = 0.8761, lr_0 = 1.5138e-04
Validation rmse = 0.173887
Validation r2 = 0.707539
Validation mse = 0.030237
Epoch 47
Loss = 8.0995e-02, PNorm = 44.7728, GNorm = 4.0787, lr_0 = 1.4775e-04
Validation rmse = 0.164873
Validation r2 = 0.737074
Validation mse = 0.027183
Epoch 48
Loss = 9.9603e-02, PNorm = 44.7798, GNorm = 1.9479, lr_0 = 1.4421e-04
Loss = 6.9706e-02, PNorm = 44.7870, GNorm = 1.2718, lr_0 = 1.4107e-04
Validation rmse = 0.167253
Validation r2 = 0.729429
Validation mse = 0.027974
Epoch 49
Loss = 6.9908e-02, PNorm = 44.7922, GNorm = 1.6182, lr_0 = 1.3769e-04
Loss = 7.7179e-02, PNorm = 44.7973, GNorm = 2.3380, lr_0 = 1.3468e-04
Validation rmse = 0.162815
Validation r2 = 0.743598
Validation mse = 0.026509
Epoch 50
Loss = 7.2908e-02, PNorm = 44.8024, GNorm = 2.3163, lr_0 = 1.3174e-04
Loss = 7.1272e-02, PNorm = 44.8076, GNorm = 0.7560, lr_0 = 1.2887e-04
Validation rmse = 0.167200
Validation r2 = 0.729599
Validation mse = 0.027956
Epoch 51
Loss = 6.9367e-02, PNorm = 44.8133, GNorm = 0.8569, lr_0 = 1.2578e-04
Loss = 6.5545e-02, PNorm = 44.8168, GNorm = 0.5194, lr_0 = 1.2304e-04
Validation rmse = 0.164475
Validation r2 = 0.738343
Validation mse = 0.027052
Epoch 52
Loss = 5.6907e-02, PNorm = 44.8210, GNorm = 1.0589, lr_0 = 1.2009e-04
Loss = 7.1107e-02, PNorm = 44.8247, GNorm = 1.2134, lr_0 = 1.1747e-04
Loss = 3.6577e-02, PNorm = 44.8250, GNorm = 2.0427, lr_0 = 1.1721e-04
Validation rmse = 0.166718
Validation r2 = 0.731158
Validation mse = 0.027795
Epoch 53
Loss = 7.0943e-02, PNorm = 44.8291, GNorm = 3.1029, lr_0 = 1.1465e-04
Validation rmse = 0.163831
Validation r2 = 0.740386
Validation mse = 0.026841
Epoch 54
Loss = 6.5782e-02, PNorm = 44.8328, GNorm = 0.5269, lr_0 = 1.1191e-04
Loss = 6.5478e-02, PNorm = 44.8365, GNorm = 1.8850, lr_0 = 1.0946e-04
Validation rmse = 0.169436
Validation r2 = 0.722320
Validation mse = 0.028709
Epoch 55
Loss = 7.2176e-02, PNorm = 44.8401, GNorm = 1.2185, lr_0 = 1.0684e-04
Loss = 6.0160e-02, PNorm = 44.8436, GNorm = 0.7223, lr_0 = 1.0451e-04
Validation rmse = 0.163570
Validation r2 = 0.741214
Validation mse = 0.026755
Epoch 56
Loss = 5.5697e-02, PNorm = 44.8472, GNorm = 0.6242, lr_0 = 1.0200e-04
Loss = 6.6186e-02, PNorm = 44.8505, GNorm = 0.6419, lr_0 = 1.0000e-04
Validation rmse = 0.166458
Validation r2 = 0.731994
Validation mse = 0.027708
Epoch 57
Loss = 6.8314e-02, PNorm = 44.8535, GNorm = 1.9328, lr_0 = 1.0000e-04
Loss = 5.8337e-02, PNorm = 44.8575, GNorm = 1.3358, lr_0 = 1.0000e-04
Loss = 2.1509e-02, PNorm = 44.8579, GNorm = 2.0262, lr_0 = 1.0000e-04
Validation rmse = 0.168431
Validation r2 = 0.725605
Validation mse = 0.028369
Epoch 58
Loss = 6.5769e-02, PNorm = 44.8612, GNorm = 2.1833, lr_0 = 1.0000e-04
Validation rmse = 0.169402
Validation r2 = 0.722431
Validation mse = 0.028697
Epoch 59
Loss = 4.7360e-02, PNorm = 44.8653, GNorm = 1.6303, lr_0 = 1.0000e-04
Loss = 6.1941e-02, PNorm = 44.8678, GNorm = 0.9345, lr_0 = 1.0000e-04
Validation rmse = 0.165304
Validation r2 = 0.735699
Validation mse = 0.027325
Model 0 best validation rmse = 0.161913 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.198423
Model 0 test r2 = -0.151574
Model 0 test mse = 0.039372
Ensemble test rmse = 0.198423
Ensemble test r2 = -0.151574
Ensemble test mse = 0.039372
10-fold cross validation
	Seed 0 ==> test rmse = 0.154540
	Seed 0 ==> test r2 = 0.301465
	Seed 0 ==> test mse = 0.023883
	Seed 1 ==> test rmse = 0.189712
	Seed 1 ==> test r2 = -0.052682
	Seed 1 ==> test mse = 0.035991
	Seed 2 ==> test rmse = 0.140648
	Seed 2 ==> test r2 = 0.421410
	Seed 2 ==> test mse = 0.019782
	Seed 3 ==> test rmse = 0.132154
	Seed 3 ==> test r2 = 0.489183
	Seed 3 ==> test mse = 0.017465
	Seed 4 ==> test rmse = 0.197696
	Seed 4 ==> test r2 = -0.143150
	Seed 4 ==> test mse = 0.039084
	Seed 5 ==> test rmse = 0.264098
	Seed 5 ==> test r2 = -1.040023
	Seed 5 ==> test mse = 0.069748
	Seed 6 ==> test rmse = 0.148903
	Seed 6 ==> test r2 = 0.351492
	Seed 6 ==> test mse = 0.022172
	Seed 7 ==> test rmse = 0.190773
	Seed 7 ==> test r2 = -0.064485
	Seed 7 ==> test mse = 0.036394
	Seed 8 ==> test rmse = 0.138133
	Seed 8 ==> test r2 = 0.441917
	Seed 8 ==> test mse = 0.019081
	Seed 9 ==> test rmse = 0.198423
	Seed 9 ==> test r2 = -0.151574
	Seed 9 ==> test mse = 0.039372
Overall test rmse = 0.175508 +/- 0.038652
Overall test r2 = 0.055355 +/- 0.439091
Overall test mse = 0.032297 +/- 0.015012
Elapsed time = 0:06:54
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-05d85262-3219-459a-86b2-5360cba4da72.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/MTBE_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2', 'mse'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2', 'mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/MTBE_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/MTBE_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 981 | train size = 971 | val size = 10 | test size = 51
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.3400e-01, PNorm = 43.2653, GNorm = 3.8370, lr_0 = 3.6053e-04
Validation rmse = 0.236751
Validation r2 = 0.323771
Validation mse = 0.056051
Epoch 1
Loss = 4.8839e-01, PNorm = 43.2921, GNorm = 3.5302, lr_0 = 6.2105e-04
Loss = 5.8966e-01, PNorm = 43.3272, GNorm = 8.2424, lr_0 = 8.5789e-04
Validation rmse = 0.180714
Validation r2 = 0.606002
Validation mse = 0.032658
Epoch 2
Loss = 5.8761e-01, PNorm = 43.3926, GNorm = 1.6623, lr_0 = 9.8961e-04
Loss = 4.6415e-01, PNorm = 43.4557, GNorm = 4.7523, lr_0 = 9.6914e-04
Validation rmse = 0.250763
Validation r2 = 0.241359
Validation mse = 0.062882
Epoch 3
Loss = 4.8436e-01, PNorm = 43.5238, GNorm = 6.4163, lr_0 = 9.4910e-04
Loss = 3.9131e-01, PNorm = 43.5877, GNorm = 2.1108, lr_0 = 9.2948e-04
Validation rmse = 0.173593
Validation r2 = 0.636441
Validation mse = 0.030135
Epoch 4
Loss = 3.1123e-01, PNorm = 43.6599, GNorm = 4.0402, lr_0 = 9.0836e-04
Loss = 3.0347e-01, PNorm = 43.7244, GNorm = 5.9228, lr_0 = 8.8958e-04
Validation rmse = 0.194304
Validation r2 = 0.544515
Validation mse = 0.037754
Epoch 5
Loss = 3.0164e-01, PNorm = 43.7764, GNorm = 7.8499, lr_0 = 8.7118e-04
Loss = 2.4454e-01, PNorm = 43.8239, GNorm = 4.3689, lr_0 = 8.5317e-04
Validation rmse = 0.174693
Validation r2 = 0.631819
Validation mse = 0.030518
Epoch 6
Loss = 1.6956e-01, PNorm = 43.8783, GNorm = 1.5829, lr_0 = 8.3378e-04
Loss = 2.0633e-01, PNorm = 43.9213, GNorm = 3.5030, lr_0 = 8.1654e-04
Validation rmse = 0.109784
Validation r2 = 0.854593
Validation mse = 0.012052
Epoch 7
Loss = 1.3900e-01, PNorm = 43.9659, GNorm = 4.3171, lr_0 = 7.9799e-04
Loss = 1.9937e-01, PNorm = 43.9982, GNorm = 1.6800, lr_0 = 7.8149e-04
Validation rmse = 0.133975
Validation r2 = 0.783451
Validation mse = 0.017949
Epoch 8
Loss = 1.4450e-01, PNorm = 44.0328, GNorm = 3.1632, lr_0 = 7.6533e-04
Loss = 1.4607e-01, PNorm = 44.0729, GNorm = 0.7027, lr_0 = 7.4950e-04
Validation rmse = 0.175670
Validation r2 = 0.627691
Validation mse = 0.030860
Epoch 9
Loss = 1.7112e-01, PNorm = 44.1066, GNorm = 2.3740, lr_0 = 7.3247e-04
Loss = 1.3928e-01, PNorm = 44.1325, GNorm = 2.1417, lr_0 = 7.1733e-04
Validation rmse = 0.188501
Validation r2 = 0.571317
Validation mse = 0.035533
Epoch 10
Loss = 1.7283e-01, PNorm = 44.1661, GNorm = 2.7072, lr_0 = 7.0249e-04
Loss = 1.8074e-01, PNorm = 44.1933, GNorm = 3.2387, lr_0 = 6.8797e-04
Validation rmse = 0.116485
Validation r2 = 0.836299
Validation mse = 0.013569
Epoch 11
Loss = 1.6482e-01, PNorm = 44.2286, GNorm = 1.6645, lr_0 = 6.7234e-04
Loss = 1.6214e-01, PNorm = 44.2652, GNorm = 6.7007, lr_0 = 6.5843e-04
Validation rmse = 0.101656
Validation r2 = 0.875326
Validation mse = 0.010334
Epoch 12
Loss = 1.3674e-01, PNorm = 44.2889, GNorm = 1.7597, lr_0 = 6.4482e-04
Loss = 1.2204e-01, PNorm = 44.3095, GNorm = 2.2974, lr_0 = 6.3148e-04
Validation rmse = 0.118777
Validation r2 = 0.829795
Validation mse = 0.014108
Epoch 13
Loss = 1.1314e-01, PNorm = 44.3322, GNorm = 0.9227, lr_0 = 6.1714e-04
Loss = 1.3200e-01, PNorm = 44.3469, GNorm = 1.9681, lr_0 = 6.0438e-04
Validation rmse = 0.099837
Validation r2 = 0.879748
Validation mse = 0.009967
Epoch 14
Loss = 1.1223e-01, PNorm = 44.3676, GNorm = 0.6159, lr_0 = 5.9064e-04
Loss = 1.1625e-01, PNorm = 44.3871, GNorm = 1.1385, lr_0 = 5.7843e-04
Validation rmse = 0.114670
Validation r2 = 0.841361
Validation mse = 0.013149
Epoch 15
Loss = 1.1841e-01, PNorm = 44.4031, GNorm = 2.1020, lr_0 = 5.6647e-04
Loss = 1.1356e-01, PNorm = 44.4214, GNorm = 2.6193, lr_0 = 5.5476e-04
Loss = 1.2301e-01, PNorm = 44.4222, GNorm = 2.9058, lr_0 = 5.5360e-04
Validation rmse = 0.108441
Validation r2 = 0.858128
Validation mse = 0.011759
Epoch 16
Loss = 1.2226e-01, PNorm = 44.4361, GNorm = 1.8664, lr_0 = 5.4215e-04
Loss = 1.1215e-01, PNorm = 44.4505, GNorm = 1.2318, lr_0 = 5.3094e-04
Validation rmse = 0.089218
Validation r2 = 0.903969
Validation mse = 0.007960
Epoch 17
Loss = 1.1330e-01, PNorm = 44.4677, GNorm = 1.5758, lr_0 = 5.1996e-04
Validation rmse = 0.096348
Validation r2 = 0.888007
Validation mse = 0.009283
Epoch 18
Loss = 7.4988e-02, PNorm = 44.4852, GNorm = 2.5330, lr_0 = 5.0815e-04
Loss = 1.1017e-01, PNorm = 44.4995, GNorm = 1.4645, lr_0 = 4.9764e-04
Validation rmse = 0.081787
Validation r2 = 0.919299
Validation mse = 0.006689
Epoch 19
Loss = 1.1408e-01, PNorm = 44.5137, GNorm = 3.2545, lr_0 = 4.8633e-04
Loss = 1.0976e-01, PNorm = 44.5251, GNorm = 4.2378, lr_0 = 4.7628e-04
Validation rmse = 0.133692
Validation r2 = 0.784364
Validation mse = 0.017874
Epoch 20
Loss = 1.1540e-01, PNorm = 44.5422, GNorm = 0.9986, lr_0 = 4.6643e-04
Loss = 1.0751e-01, PNorm = 44.5586, GNorm = 3.1366, lr_0 = 4.5678e-04
Validation rmse = 0.094870
Validation r2 = 0.891416
Validation mse = 0.009000
Epoch 21
Loss = 9.9525e-02, PNorm = 44.5765, GNorm = 0.9220, lr_0 = 4.4640e-04
Loss = 1.1751e-01, PNorm = 44.5922, GNorm = 2.7102, lr_0 = 4.3717e-04
Validation rmse = 0.096033
Validation r2 = 0.888737
Validation mse = 0.009222
Epoch 22
Loss = 7.9987e-02, PNorm = 44.6048, GNorm = 1.7534, lr_0 = 4.2813e-04
Loss = 9.2672e-02, PNorm = 44.6183, GNorm = 1.1636, lr_0 = 4.1928e-04
Validation rmse = 0.082593
Validation r2 = 0.917700
Validation mse = 0.006822
Epoch 23
Loss = 9.5284e-02, PNorm = 44.6333, GNorm = 0.5754, lr_0 = 4.0975e-04
Loss = 8.1333e-02, PNorm = 44.6466, GNorm = 2.3419, lr_0 = 4.0128e-04
Validation rmse = 0.088582
Validation r2 = 0.905332
Validation mse = 0.007847
Epoch 24
Loss = 9.3001e-02, PNorm = 44.6588, GNorm = 1.1759, lr_0 = 3.9298e-04
Loss = 1.0123e-01, PNorm = 44.6720, GNorm = 1.9856, lr_0 = 3.8486e-04
Validation rmse = 0.089025
Validation r2 = 0.904383
Validation mse = 0.007925
Epoch 25
Loss = 8.6197e-02, PNorm = 44.6859, GNorm = 0.6691, lr_0 = 3.7611e-04
Loss = 8.5195e-02, PNorm = 44.6953, GNorm = 1.0131, lr_0 = 3.6834e-04
Validation rmse = 0.104073
Validation r2 = 0.869328
Validation mse = 0.010831
Epoch 26
Loss = 7.4096e-02, PNorm = 44.7070, GNorm = 2.4275, lr_0 = 3.5997e-04
Loss = 8.2972e-02, PNorm = 44.7180, GNorm = 0.7499, lr_0 = 3.5252e-04
Validation rmse = 0.096309
Validation r2 = 0.888097
Validation mse = 0.009275
Epoch 27
Loss = 8.9737e-02, PNorm = 44.7298, GNorm = 0.9553, lr_0 = 3.4523e-04
Loss = 8.1608e-02, PNorm = 44.7399, GNorm = 1.6219, lr_0 = 3.3809e-04
Validation rmse = 0.089372
Validation r2 = 0.903637
Validation mse = 0.007987
Epoch 28
Loss = 8.9140e-02, PNorm = 44.7521, GNorm = 2.6103, lr_0 = 3.3041e-04
Loss = 7.7660e-02, PNorm = 44.7623, GNorm = 2.6514, lr_0 = 3.2358e-04
Validation rmse = 0.105242
Validation r2 = 0.866375
Validation mse = 0.011076
Epoch 29
Loss = 8.3911e-02, PNorm = 44.7729, GNorm = 1.9003, lr_0 = 3.1689e-04
Loss = 8.6580e-02, PNorm = 44.7834, GNorm = 0.9757, lr_0 = 3.1034e-04
Validation rmse = 0.102536
Validation r2 = 0.873157
Validation mse = 0.010514
Epoch 30
Loss = 7.6297e-02, PNorm = 44.7985, GNorm = 1.3146, lr_0 = 3.0329e-04
Loss = 8.7189e-02, PNorm = 44.8101, GNorm = 1.6930, lr_0 = 2.9701e-04
Validation rmse = 0.110224
Validation r2 = 0.853425
Validation mse = 0.012149
Epoch 31
Loss = 8.6826e-02, PNorm = 44.8212, GNorm = 0.8894, lr_0 = 2.9087e-04
Loss = 7.5894e-02, PNorm = 44.8296, GNorm = 1.3420, lr_0 = 2.8486e-04
Validation rmse = 0.113054
Validation r2 = 0.845801
Validation mse = 0.012781
Epoch 32
Loss = 8.2066e-02, PNorm = 44.8391, GNorm = 1.1166, lr_0 = 2.7839e-04
Loss = 7.1683e-02, PNorm = 44.8499, GNorm = 1.1110, lr_0 = 2.7263e-04
Loss = 3.4874e-02, PNorm = 44.8506, GNorm = 0.6032, lr_0 = 2.7206e-04
Validation rmse = 0.116296
Validation r2 = 0.836831
Validation mse = 0.013525
Epoch 33
Loss = 7.9697e-02, PNorm = 44.8587, GNorm = 1.5915, lr_0 = 2.6643e-04
Loss = 6.1482e-02, PNorm = 44.8664, GNorm = 2.6747, lr_0 = 2.6092e-04
Validation rmse = 0.104025
Validation r2 = 0.869446
Validation mse = 0.010821
Epoch 34
Loss = 6.0682e-02, PNorm = 44.8738, GNorm = 1.3343, lr_0 = 2.5553e-04
Validation rmse = 0.097352
Validation r2 = 0.885660
Validation mse = 0.009477
Epoch 35
Loss = 6.5706e-02, PNorm = 44.8820, GNorm = 0.6212, lr_0 = 2.4972e-04
Loss = 7.6620e-02, PNorm = 44.8907, GNorm = 1.0335, lr_0 = 2.4456e-04
Validation rmse = 0.081210
Validation r2 = 0.920434
Validation mse = 0.006595
Epoch 36
Loss = 5.9010e-02, PNorm = 44.8989, GNorm = 2.0943, lr_0 = 2.3950e-04
Loss = 6.9794e-02, PNorm = 44.9089, GNorm = 0.8678, lr_0 = 2.3455e-04
Validation rmse = 0.115004
Validation r2 = 0.840435
Validation mse = 0.013226
Epoch 37
Loss = 5.1630e-02, PNorm = 44.9182, GNorm = 0.3831, lr_0 = 2.2922e-04
Loss = 6.7813e-02, PNorm = 44.9271, GNorm = 1.4707, lr_0 = 2.2448e-04
Validation rmse = 0.116877
Validation r2 = 0.835196
Validation mse = 0.013660
Epoch 38
Loss = 5.4244e-02, PNorm = 44.9357, GNorm = 0.4075, lr_0 = 2.1938e-04
Loss = 6.7695e-02, PNorm = 44.9432, GNorm = 1.0547, lr_0 = 2.1484e-04
Validation rmse = 0.077663
Validation r2 = 0.927233
Validation mse = 0.006031
Epoch 39
Loss = 7.7594e-02, PNorm = 44.9502, GNorm = 0.8973, lr_0 = 2.1040e-04
Loss = 6.1060e-02, PNorm = 44.9574, GNorm = 2.4027, lr_0 = 2.0605e-04
Validation rmse = 0.097934
Validation r2 = 0.884288
Validation mse = 0.009591
Epoch 40
Loss = 7.4885e-02, PNorm = 44.9651, GNorm = 1.0352, lr_0 = 2.0137e-04
Loss = 4.7186e-02, PNorm = 44.9737, GNorm = 0.8183, lr_0 = 1.9721e-04
Validation rmse = 0.111122
Validation r2 = 0.851026
Validation mse = 0.012348
Epoch 41
Loss = 6.1430e-02, PNorm = 44.9794, GNorm = 0.8807, lr_0 = 1.9313e-04
Loss = 6.2937e-02, PNorm = 44.9869, GNorm = 1.3921, lr_0 = 1.8913e-04
Validation rmse = 0.120988
Validation r2 = 0.823399
Validation mse = 0.014638
Epoch 42
Loss = 6.3847e-02, PNorm = 44.9944, GNorm = 2.2503, lr_0 = 1.8484e-04
Loss = 6.8553e-02, PNorm = 45.0008, GNorm = 1.2768, lr_0 = 1.8101e-04
Validation rmse = 0.102662
Validation r2 = 0.872846
Validation mse = 0.010540
Epoch 43
Loss = 4.8948e-02, PNorm = 45.0070, GNorm = 2.2071, lr_0 = 1.7727e-04
Loss = 6.0285e-02, PNorm = 45.0124, GNorm = 1.3604, lr_0 = 1.7361e-04
Validation rmse = 0.093685
Validation r2 = 0.894111
Validation mse = 0.008777
Epoch 44
Loss = 5.5524e-02, PNorm = 45.0197, GNorm = 0.7515, lr_0 = 1.6966e-04
Loss = 5.9582e-02, PNorm = 45.0264, GNorm = 0.8363, lr_0 = 1.6615e-04
Validation rmse = 0.101509
Validation r2 = 0.875686
Validation mse = 0.010304
Epoch 45
Loss = 5.7156e-02, PNorm = 45.0323, GNorm = 1.8138, lr_0 = 1.6238e-04
Loss = 5.5824e-02, PNorm = 45.0375, GNorm = 0.7863, lr_0 = 1.5902e-04
Validation rmse = 0.116529
Validation r2 = 0.836177
Validation mse = 0.013579
Epoch 46
Loss = 4.8225e-02, PNorm = 45.0434, GNorm = 0.8498, lr_0 = 1.5573e-04
Loss = 5.5678e-02, PNorm = 45.0489, GNorm = 1.1704, lr_0 = 1.5251e-04
Validation rmse = 0.079886
Validation r2 = 0.923006
Validation mse = 0.006382
Epoch 47
Loss = 5.3757e-02, PNorm = 45.0549, GNorm = 0.6199, lr_0 = 1.4905e-04
Loss = 5.8343e-02, PNorm = 45.0601, GNorm = 1.6368, lr_0 = 1.4596e-04
Validation rmse = 0.094888
Validation r2 = 0.891375
Validation mse = 0.009004
Epoch 48
Loss = 5.0586e-02, PNorm = 45.0644, GNorm = 0.5760, lr_0 = 1.4295e-04
Loss = 6.1137e-02, PNorm = 45.0696, GNorm = 0.8830, lr_0 = 1.3999e-04
Validation rmse = 0.117416
Validation r2 = 0.833673
Validation mse = 0.013786
Epoch 49
Loss = 5.7779e-02, PNorm = 45.0749, GNorm = 1.6018, lr_0 = 1.3681e-04
Loss = 4.8853e-02, PNorm = 45.0803, GNorm = 1.0720, lr_0 = 1.3398e-04
Validation rmse = 0.081158
Validation r2 = 0.920535
Validation mse = 0.006587
Epoch 50
Loss = 5.5115e-02, PNorm = 45.0854, GNorm = 0.6268, lr_0 = 1.3121e-04
Loss = 5.0930e-02, PNorm = 45.0905, GNorm = 1.7251, lr_0 = 1.2850e-04
Loss = 9.4475e-02, PNorm = 45.0909, GNorm = 1.4491, lr_0 = 1.2823e-04
Validation rmse = 0.089487
Validation r2 = 0.903388
Validation mse = 0.008008
Epoch 51
Loss = 5.2866e-02, PNorm = 45.0956, GNorm = 1.0671, lr_0 = 1.2558e-04
Validation rmse = 0.121630
Validation r2 = 0.821519
Validation mse = 0.014794
Epoch 52
Loss = 5.9710e-02, PNorm = 45.1007, GNorm = 1.4712, lr_0 = 1.2272e-04
Loss = 4.7858e-02, PNorm = 45.1050, GNorm = 0.4384, lr_0 = 1.2019e-04
Validation rmse = 0.101575
Validation r2 = 0.875524
Validation mse = 0.010318
Epoch 53
Loss = 7.1666e-02, PNorm = 45.1092, GNorm = 1.1935, lr_0 = 1.1770e-04
Loss = 4.8789e-02, PNorm = 45.1137, GNorm = 0.7162, lr_0 = 1.1527e-04
Validation rmse = 0.091576
Validation r2 = 0.898825
Validation mse = 0.008386
Epoch 54
Loss = 5.6025e-02, PNorm = 45.1180, GNorm = 1.8392, lr_0 = 1.1265e-04
Loss = 4.6716e-02, PNorm = 45.1229, GNorm = 1.4731, lr_0 = 1.1032e-04
Validation rmse = 0.102477
Validation r2 = 0.873304
Validation mse = 0.010502
Epoch 55
Loss = 4.4411e-02, PNorm = 45.1263, GNorm = 0.5897, lr_0 = 1.0804e-04
Loss = 4.3621e-02, PNorm = 45.1300, GNorm = 0.9909, lr_0 = 1.0580e-04
Validation rmse = 0.091930
Validation r2 = 0.898040
Validation mse = 0.008451
Epoch 56
Loss = 5.2255e-02, PNorm = 45.1343, GNorm = 0.8493, lr_0 = 1.0340e-04
Loss = 4.5749e-02, PNorm = 45.1379, GNorm = 1.2828, lr_0 = 1.0126e-04
Validation rmse = 0.134159
Validation r2 = 0.782856
Validation mse = 0.017999
Epoch 57
Loss = 4.8692e-02, PNorm = 45.1421, GNorm = 0.6570, lr_0 = 1.0000e-04
Loss = 4.8413e-02, PNorm = 45.1459, GNorm = 0.8050, lr_0 = 1.0000e-04
Validation rmse = 0.081840
Validation r2 = 0.919195
Validation mse = 0.006698
Epoch 58
Loss = 4.1219e-02, PNorm = 45.1491, GNorm = 1.5445, lr_0 = 1.0000e-04
Loss = 4.9529e-02, PNorm = 45.1528, GNorm = 1.7339, lr_0 = 1.0000e-04
Validation rmse = 0.111796
Validation r2 = 0.849215
Validation mse = 0.012498
Epoch 59
Loss = 5.0858e-02, PNorm = 45.1572, GNorm = 1.5551, lr_0 = 1.0000e-04
Loss = 4.6804e-02, PNorm = 45.1614, GNorm = 1.2346, lr_0 = 1.0000e-04
Validation rmse = 0.096261
Validation r2 = 0.888207
Validation mse = 0.009266
Model 0 best validation rmse = 0.077663 on epoch 38
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.458819
Model 0 test r2 = -3.995727
Model 0 test mse = 0.210515
Ensemble test rmse = 0.458819
Ensemble test r2 = -3.995727
Ensemble test mse = 0.210515
Fold 1
Splitting data with seed 1
Total size = 981 | train size = 971 | val size = 10 | test size = 51
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.2340e-01, PNorm = 43.2624, GNorm = 2.0831, lr_0 = 3.6053e-04
Validation rmse = 0.213010
Validation r2 = 0.137965
Validation mse = 0.045373
Epoch 1
Loss = 5.6835e-01, PNorm = 43.2904, GNorm = 8.7119, lr_0 = 6.2105e-04
Loss = 5.5686e-01, PNorm = 43.3309, GNorm = 2.3686, lr_0 = 8.5789e-04
Validation rmse = 0.291861
Validation r2 = -0.618366
Validation mse = 0.085183
Epoch 2
Loss = 6.3305e-01, PNorm = 43.3891, GNorm = 5.4463, lr_0 = 9.8961e-04
Loss = 4.6419e-01, PNorm = 43.4569, GNorm = 1.6613, lr_0 = 9.6914e-04
Validation rmse = 0.199971
Validation r2 = 0.240273
Validation mse = 0.039988
Epoch 3
Loss = 4.2664e-01, PNorm = 43.5253, GNorm = 8.1911, lr_0 = 9.4910e-04
Loss = 2.8348e-01, PNorm = 43.5862, GNorm = 1.0291, lr_0 = 9.2948e-04
Validation rmse = 0.158173
Validation r2 = 0.524673
Validation mse = 0.025019
Epoch 4
Loss = 2.4242e-01, PNorm = 43.6488, GNorm = 1.2097, lr_0 = 9.0836e-04
Loss = 2.2965e-01, PNorm = 43.7032, GNorm = 1.8325, lr_0 = 8.8958e-04
Validation rmse = 0.152530
Validation r2 = 0.557988
Validation mse = 0.023265
Epoch 5
Loss = 2.5691e-01, PNorm = 43.7477, GNorm = 5.4706, lr_0 = 8.7118e-04
Loss = 2.1527e-01, PNorm = 43.7853, GNorm = 5.8473, lr_0 = 8.5317e-04
Validation rmse = 0.152095
Validation r2 = 0.560505
Validation mse = 0.023133
Epoch 6
Loss = 2.8493e-01, PNorm = 43.8330, GNorm = 5.0892, lr_0 = 8.3378e-04
Loss = 2.1118e-01, PNorm = 43.8734, GNorm = 1.0241, lr_0 = 8.1654e-04
Validation rmse = 0.134450
Validation r2 = 0.656561
Validation mse = 0.018077
Epoch 7
Loss = 1.8789e-01, PNorm = 43.9069, GNorm = 3.8465, lr_0 = 7.9799e-04
Loss = 1.8557e-01, PNorm = 43.9350, GNorm = 2.9872, lr_0 = 7.8149e-04
Validation rmse = 0.130287
Validation r2 = 0.677500
Validation mse = 0.016975
Epoch 8
Loss = 1.6654e-01, PNorm = 43.9695, GNorm = 2.6666, lr_0 = 7.6533e-04
Loss = 1.6451e-01, PNorm = 44.0050, GNorm = 1.7446, lr_0 = 7.4950e-04
Validation rmse = 0.098886
Validation r2 = 0.814221
Validation mse = 0.009778
Epoch 9
Loss = 1.3174e-01, PNorm = 44.0286, GNorm = 1.0906, lr_0 = 7.3247e-04
Loss = 1.5207e-01, PNorm = 44.0574, GNorm = 2.2610, lr_0 = 7.1733e-04
Validation rmse = 0.101295
Validation r2 = 0.805060
Validation mse = 0.010261
Epoch 10
Loss = 1.4872e-01, PNorm = 44.0806, GNorm = 1.1960, lr_0 = 7.0249e-04
Loss = 1.4302e-01, PNorm = 44.1023, GNorm = 5.8028, lr_0 = 6.8797e-04
Validation rmse = 0.103645
Validation r2 = 0.795908
Validation mse = 0.010742
Epoch 11
Loss = 1.3898e-01, PNorm = 44.1298, GNorm = 1.7846, lr_0 = 6.7234e-04
Loss = 1.5132e-01, PNorm = 44.1537, GNorm = 1.5445, lr_0 = 6.5843e-04
Validation rmse = 0.088716
Validation r2 = 0.850468
Validation mse = 0.007871
Epoch 12
Loss = 1.2023e-01, PNorm = 44.1787, GNorm = 3.4429, lr_0 = 6.4482e-04
Loss = 1.3893e-01, PNorm = 44.1976, GNorm = 2.8662, lr_0 = 6.3148e-04
Validation rmse = 0.111233
Validation r2 = 0.764930
Validation mse = 0.012373
Epoch 13
Loss = 1.8126e-01, PNorm = 44.2227, GNorm = 1.2468, lr_0 = 6.1714e-04
Loss = 1.3083e-01, PNorm = 44.2470, GNorm = 2.5282, lr_0 = 6.0438e-04
Validation rmse = 0.083640
Validation r2 = 0.867091
Validation mse = 0.006996
Epoch 14
Loss = 1.3302e-01, PNorm = 44.2715, GNorm = 2.0656, lr_0 = 5.9064e-04
Loss = 1.1602e-01, PNorm = 44.2881, GNorm = 0.5126, lr_0 = 5.7843e-04
Validation rmse = 0.076407
Validation r2 = 0.889084
Validation mse = 0.005838
Epoch 15
Loss = 1.1574e-01, PNorm = 44.3054, GNorm = 2.4292, lr_0 = 5.6647e-04
Loss = 1.1691e-01, PNorm = 44.3232, GNorm = 3.1966, lr_0 = 5.5476e-04
Loss = 6.3015e-02, PNorm = 44.3251, GNorm = 0.7284, lr_0 = 5.5360e-04
Validation rmse = 0.106951
Validation r2 = 0.782681
Validation mse = 0.011439
Epoch 16
Loss = 1.2625e-01, PNorm = 44.3393, GNorm = 4.0288, lr_0 = 5.4215e-04
Loss = 1.1746e-01, PNorm = 44.3539, GNorm = 1.3330, lr_0 = 5.3094e-04
Validation rmse = 0.110082
Validation r2 = 0.769774
Validation mse = 0.012118
Epoch 17
Loss = 1.1940e-01, PNorm = 44.3716, GNorm = 2.4448, lr_0 = 5.1996e-04
Validation rmse = 0.095716
Validation r2 = 0.825940
Validation mse = 0.009162
Epoch 18
Loss = 1.4667e-01, PNorm = 44.3906, GNorm = 4.3840, lr_0 = 5.0815e-04
Loss = 1.1841e-01, PNorm = 44.4057, GNorm = 0.8941, lr_0 = 4.9764e-04
Validation rmse = 0.079267
Validation r2 = 0.880627
Validation mse = 0.006283
Epoch 19
Loss = 6.7604e-02, PNorm = 44.4227, GNorm = 0.8610, lr_0 = 4.8633e-04
Loss = 1.1425e-01, PNorm = 44.4386, GNorm = 0.5397, lr_0 = 4.7628e-04
Validation rmse = 0.071551
Validation r2 = 0.902735
Validation mse = 0.005120
Epoch 20
Loss = 7.6944e-02, PNorm = 44.4547, GNorm = 0.5167, lr_0 = 4.6643e-04
Loss = 1.1369e-01, PNorm = 44.4676, GNorm = 2.0533, lr_0 = 4.5678e-04
Validation rmse = 0.071319
Validation r2 = 0.903363
Validation mse = 0.005086
Epoch 21
Loss = 8.7168e-02, PNorm = 44.4818, GNorm = 1.1957, lr_0 = 4.4640e-04
Loss = 9.8602e-02, PNorm = 44.4925, GNorm = 0.7688, lr_0 = 4.3717e-04
Validation rmse = 0.059284
Validation r2 = 0.933226
Validation mse = 0.003515
Epoch 22
Loss = 9.7467e-02, PNorm = 44.5060, GNorm = 1.7584, lr_0 = 4.2813e-04
Loss = 9.9763e-02, PNorm = 44.5181, GNorm = 1.4714, lr_0 = 4.1928e-04
Validation rmse = 0.078116
Validation r2 = 0.884069
Validation mse = 0.006102
Epoch 23
Loss = 9.4237e-02, PNorm = 44.5316, GNorm = 1.4422, lr_0 = 4.0975e-04
Loss = 8.5517e-02, PNorm = 44.5445, GNorm = 1.5180, lr_0 = 4.0128e-04
Validation rmse = 0.065899
Validation r2 = 0.917494
Validation mse = 0.004343
Epoch 24
Loss = 8.1583e-02, PNorm = 44.5559, GNorm = 1.0267, lr_0 = 3.9298e-04
Loss = 8.1511e-02, PNorm = 44.5656, GNorm = 1.0591, lr_0 = 3.8486e-04
Validation rmse = 0.057433
Validation r2 = 0.937332
Validation mse = 0.003299
Epoch 25
Loss = 8.4602e-02, PNorm = 44.5795, GNorm = 0.7076, lr_0 = 3.7611e-04
Loss = 9.3032e-02, PNorm = 44.5907, GNorm = 1.7455, lr_0 = 3.6834e-04
Validation rmse = 0.063056
Validation r2 = 0.924460
Validation mse = 0.003976
Epoch 26
Loss = 9.4197e-02, PNorm = 44.6023, GNorm = 0.9730, lr_0 = 3.5997e-04
Loss = 9.7495e-02, PNorm = 44.6130, GNorm = 4.3084, lr_0 = 3.5252e-04
Validation rmse = 0.075986
Validation r2 = 0.890304
Validation mse = 0.005774
Epoch 27
Loss = 9.0921e-02, PNorm = 44.6241, GNorm = 1.5564, lr_0 = 3.4523e-04
Loss = 9.2794e-02, PNorm = 44.6344, GNorm = 2.2203, lr_0 = 3.3809e-04
Validation rmse = 0.053614
Validation r2 = 0.945390
Validation mse = 0.002874
Epoch 28
Loss = 8.0813e-02, PNorm = 44.6473, GNorm = 0.7329, lr_0 = 3.3041e-04
Loss = 9.4790e-02, PNorm = 44.6593, GNorm = 2.3169, lr_0 = 3.2358e-04
Validation rmse = 0.080519
Validation r2 = 0.876826
Validation mse = 0.006483
Epoch 29
Loss = 9.2073e-02, PNorm = 44.6697, GNorm = 0.6018, lr_0 = 3.1689e-04
Loss = 7.8386e-02, PNorm = 44.6778, GNorm = 0.6969, lr_0 = 3.1034e-04
Validation rmse = 0.061641
Validation r2 = 0.927812
Validation mse = 0.003800
Epoch 30
Loss = 9.2815e-02, PNorm = 44.6885, GNorm = 1.2664, lr_0 = 3.0329e-04
Loss = 7.1295e-02, PNorm = 44.6974, GNorm = 2.6019, lr_0 = 2.9701e-04
Validation rmse = 0.050250
Validation r2 = 0.952027
Validation mse = 0.002525
Epoch 31
Loss = 7.7047e-02, PNorm = 44.7044, GNorm = 1.0097, lr_0 = 2.9087e-04
Loss = 8.7046e-02, PNorm = 44.7126, GNorm = 2.2925, lr_0 = 2.8486e-04
Validation rmse = 0.055615
Validation r2 = 0.941236
Validation mse = 0.003093
Epoch 32
Loss = 8.2129e-02, PNorm = 44.7223, GNorm = 2.5707, lr_0 = 2.7839e-04
Loss = 8.1250e-02, PNorm = 44.7322, GNorm = 2.5475, lr_0 = 2.7263e-04
Loss = 8.1275e-02, PNorm = 44.7330, GNorm = 1.5900, lr_0 = 2.7206e-04
Validation rmse = 0.049043
Validation r2 = 0.954304
Validation mse = 0.002405
Epoch 33
Loss = 8.1146e-02, PNorm = 44.7407, GNorm = 1.1517, lr_0 = 2.6643e-04
Loss = 8.1469e-02, PNorm = 44.7501, GNorm = 1.8836, lr_0 = 2.6092e-04
Validation rmse = 0.052283
Validation r2 = 0.948066
Validation mse = 0.002734
Epoch 34
Loss = 8.7032e-02, PNorm = 44.7601, GNorm = 2.6161, lr_0 = 2.5553e-04
Validation rmse = 0.053889
Validation r2 = 0.944827
Validation mse = 0.002904
Epoch 35
Loss = 5.1251e-02, PNorm = 44.7683, GNorm = 0.5155, lr_0 = 2.4972e-04
Loss = 7.8770e-02, PNorm = 44.7775, GNorm = 3.1744, lr_0 = 2.4456e-04
Validation rmse = 0.051092
Validation r2 = 0.950405
Validation mse = 0.002610
Epoch 36
Loss = 9.7970e-02, PNorm = 44.7847, GNorm = 1.4464, lr_0 = 2.3950e-04
Loss = 7.4447e-02, PNorm = 44.7939, GNorm = 1.7072, lr_0 = 2.3455e-04
Validation rmse = 0.048515
Validation r2 = 0.955282
Validation mse = 0.002354
Epoch 37
Loss = 6.8067e-02, PNorm = 44.8006, GNorm = 1.4828, lr_0 = 2.2922e-04
Loss = 7.9053e-02, PNorm = 44.8099, GNorm = 0.9181, lr_0 = 2.2448e-04
Validation rmse = 0.062618
Validation r2 = 0.925505
Validation mse = 0.003921
Epoch 38
Loss = 7.6455e-02, PNorm = 44.8177, GNorm = 1.0531, lr_0 = 2.1938e-04
Loss = 7.6420e-02, PNorm = 44.8261, GNorm = 0.5385, lr_0 = 2.1484e-04
Validation rmse = 0.051315
Validation r2 = 0.949972
Validation mse = 0.002633
Epoch 39
Loss = 6.3702e-02, PNorm = 44.8350, GNorm = 1.3046, lr_0 = 2.1040e-04
Loss = 7.8492e-02, PNorm = 44.8434, GNorm = 2.5526, lr_0 = 2.0605e-04
Validation rmse = 0.062831
Validation r2 = 0.924997
Validation mse = 0.003948
Epoch 40
Loss = 6.9098e-02, PNorm = 44.8498, GNorm = 0.8997, lr_0 = 2.0137e-04
Loss = 6.9739e-02, PNorm = 44.8559, GNorm = 0.9776, lr_0 = 1.9721e-04
Validation rmse = 0.049710
Validation r2 = 0.953053
Validation mse = 0.002471
Epoch 41
Loss = 7.7253e-02, PNorm = 44.8629, GNorm = 2.5965, lr_0 = 1.9313e-04
Loss = 7.5358e-02, PNorm = 44.8688, GNorm = 0.8808, lr_0 = 1.8913e-04
Validation rmse = 0.068618
Validation r2 = 0.910545
Validation mse = 0.004708
Epoch 42
Loss = 7.2074e-02, PNorm = 44.8770, GNorm = 0.4998, lr_0 = 1.8484e-04
Loss = 7.0249e-02, PNorm = 44.8839, GNorm = 0.5099, lr_0 = 1.8101e-04
Validation rmse = 0.056527
Validation r2 = 0.939294
Validation mse = 0.003195
Epoch 43
Loss = 7.4113e-02, PNorm = 44.8900, GNorm = 0.6953, lr_0 = 1.7727e-04
Loss = 8.0896e-02, PNorm = 44.8970, GNorm = 1.4344, lr_0 = 1.7361e-04
Validation rmse = 0.050347
Validation r2 = 0.951841
Validation mse = 0.002535
Epoch 44
Loss = 5.8734e-02, PNorm = 44.9036, GNorm = 0.5356, lr_0 = 1.6966e-04
Loss = 7.7230e-02, PNorm = 44.9091, GNorm = 0.8950, lr_0 = 1.6615e-04
Validation rmse = 0.052423
Validation r2 = 0.947787
Validation mse = 0.002748
Epoch 45
Loss = 6.4971e-02, PNorm = 44.9169, GNorm = 0.7592, lr_0 = 1.6238e-04
Loss = 6.6909e-02, PNorm = 44.9224, GNorm = 1.5905, lr_0 = 1.5902e-04
Validation rmse = 0.051059
Validation r2 = 0.950470
Validation mse = 0.002607
Epoch 46
Loss = 6.1339e-02, PNorm = 44.9280, GNorm = 0.6746, lr_0 = 1.5573e-04
Loss = 7.2348e-02, PNorm = 44.9337, GNorm = 1.4478, lr_0 = 1.5251e-04
Validation rmse = 0.046114
Validation r2 = 0.959598
Validation mse = 0.002127
Epoch 47
Loss = 6.9313e-02, PNorm = 44.9405, GNorm = 1.6668, lr_0 = 1.4905e-04
Loss = 6.2441e-02, PNorm = 44.9463, GNorm = 1.2779, lr_0 = 1.4596e-04
Validation rmse = 0.055808
Validation r2 = 0.940828
Validation mse = 0.003115
Epoch 48
Loss = 6.4856e-02, PNorm = 44.9513, GNorm = 2.1926, lr_0 = 1.4295e-04
Loss = 7.1782e-02, PNorm = 44.9554, GNorm = 3.3555, lr_0 = 1.3999e-04
Validation rmse = 0.044573
Validation r2 = 0.962254
Validation mse = 0.001987
Epoch 49
Loss = 5.4566e-02, PNorm = 44.9610, GNorm = 1.9702, lr_0 = 1.3681e-04
Loss = 7.8485e-02, PNorm = 44.9662, GNorm = 1.9086, lr_0 = 1.3398e-04
Validation rmse = 0.048738
Validation r2 = 0.954870
Validation mse = 0.002375
Epoch 50
Loss = 6.1663e-02, PNorm = 44.9714, GNorm = 0.8480, lr_0 = 1.3121e-04
Loss = 6.0829e-02, PNorm = 44.9760, GNorm = 1.0420, lr_0 = 1.2850e-04
Loss = 7.6712e-02, PNorm = 44.9764, GNorm = 1.2323, lr_0 = 1.2823e-04
Validation rmse = 0.047488
Validation r2 = 0.957155
Validation mse = 0.002255
Epoch 51
Loss = 6.0146e-02, PNorm = 44.9805, GNorm = 1.9471, lr_0 = 1.2558e-04
Validation rmse = 0.047578
Validation r2 = 0.956994
Validation mse = 0.002264
Epoch 52
Loss = 5.5638e-02, PNorm = 44.9853, GNorm = 0.5917, lr_0 = 1.2272e-04
Loss = 6.0051e-02, PNorm = 44.9896, GNorm = 1.2054, lr_0 = 1.2019e-04
Validation rmse = 0.045610
Validation r2 = 0.960478
Validation mse = 0.002080
Epoch 53
Loss = 3.8415e-02, PNorm = 44.9941, GNorm = 0.5738, lr_0 = 1.1770e-04
Loss = 6.6436e-02, PNorm = 44.9984, GNorm = 1.0963, lr_0 = 1.1527e-04
Validation rmse = 0.061270
Validation r2 = 0.928679
Validation mse = 0.003754
Epoch 54
Loss = 6.8398e-02, PNorm = 45.0022, GNorm = 1.0928, lr_0 = 1.1265e-04
Loss = 6.2757e-02, PNorm = 45.0072, GNorm = 1.9736, lr_0 = 1.1032e-04
Validation rmse = 0.045660
Validation r2 = 0.960391
Validation mse = 0.002085
Epoch 55
Loss = 5.3959e-02, PNorm = 45.0104, GNorm = 2.1053, lr_0 = 1.0804e-04
Loss = 5.9041e-02, PNorm = 45.0151, GNorm = 1.2102, lr_0 = 1.0580e-04
Validation rmse = 0.043591
Validation r2 = 0.963898
Validation mse = 0.001900
Epoch 56
Loss = 4.7186e-02, PNorm = 45.0187, GNorm = 0.5284, lr_0 = 1.0340e-04
Loss = 5.8920e-02, PNorm = 45.0226, GNorm = 1.5186, lr_0 = 1.0126e-04
Validation rmse = 0.045864
Validation r2 = 0.960036
Validation mse = 0.002104
Epoch 57
Loss = 5.5911e-02, PNorm = 45.0269, GNorm = 0.9394, lr_0 = 1.0000e-04
Loss = 6.0735e-02, PNorm = 45.0301, GNorm = 1.2940, lr_0 = 1.0000e-04
Validation rmse = 0.050350
Validation r2 = 0.951837
Validation mse = 0.002535
Epoch 58
Loss = 5.9437e-02, PNorm = 45.0341, GNorm = 0.6134, lr_0 = 1.0000e-04
Loss = 5.6384e-02, PNorm = 45.0381, GNorm = 1.3802, lr_0 = 1.0000e-04
Validation rmse = 0.048440
Validation r2 = 0.955422
Validation mse = 0.002346
Epoch 59
Loss = 5.7888e-02, PNorm = 45.0423, GNorm = 1.0506, lr_0 = 1.0000e-04
Loss = 5.5788e-02, PNorm = 45.0456, GNorm = 0.4970, lr_0 = 1.0000e-04
Validation rmse = 0.042173
Validation r2 = 0.966209
Validation mse = 0.001779
Model 0 best validation rmse = 0.042173 on epoch 59
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.508819
Model 0 test r2 = -5.143881
Model 0 test mse = 0.258897
Ensemble test rmse = 0.508819
Ensemble test r2 = -5.143881
Ensemble test mse = 0.258897
Fold 2
Splitting data with seed 2
Total size = 981 | train size = 971 | val size = 10 | test size = 51
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.8979e-01, PNorm = 43.2616, GNorm = 5.6998, lr_0 = 3.6053e-04
Validation rmse = 0.265591
Validation r2 = 0.236605
Validation mse = 0.070539
Epoch 1
Loss = 7.3918e-01, PNorm = 43.2813, GNorm = 2.6715, lr_0 = 6.2105e-04
Loss = 6.5541e-01, PNorm = 43.3267, GNorm = 4.0569, lr_0 = 8.5789e-04
Validation rmse = 0.395614
Validation r2 = -0.693817
Validation mse = 0.156511
Epoch 2
Loss = 3.6902e-01, PNorm = 43.3862, GNorm = 5.2204, lr_0 = 9.8961e-04
Loss = 3.6687e-01, PNorm = 43.4531, GNorm = 5.1246, lr_0 = 9.6914e-04
Validation rmse = 0.414428
Validation r2 = -0.858748
Validation mse = 0.171751
Epoch 3
Loss = 3.0464e-01, PNorm = 43.5182, GNorm = 2.1432, lr_0 = 9.4910e-04
Loss = 2.9678e-01, PNorm = 43.5853, GNorm = 1.8070, lr_0 = 9.2948e-04
Validation rmse = 0.412483
Validation r2 = -0.841338
Validation mse = 0.170142
Epoch 4
Loss = 3.1258e-01, PNorm = 43.6412, GNorm = 11.3736, lr_0 = 9.0836e-04
Loss = 2.9850e-01, PNorm = 43.6842, GNorm = 4.0387, lr_0 = 8.8958e-04
Validation rmse = 0.413436
Validation r2 = -0.849862
Validation mse = 0.170930
Epoch 5
Loss = 2.0418e-01, PNorm = 43.7376, GNorm = 2.2303, lr_0 = 8.7118e-04
Loss = 2.1651e-01, PNorm = 43.7744, GNorm = 6.9880, lr_0 = 8.5317e-04
Validation rmse = 0.370729
Validation r2 = -0.487429
Validation mse = 0.137440
Epoch 6
Loss = 2.8074e-01, PNorm = 43.8222, GNorm = 1.4779, lr_0 = 8.3378e-04
Loss = 1.7707e-01, PNorm = 43.8674, GNorm = 0.9934, lr_0 = 8.1654e-04
Validation rmse = 0.379364
Validation r2 = -0.557525
Validation mse = 0.143917
Epoch 7
Loss = 1.7253e-01, PNorm = 43.9068, GNorm = 0.7385, lr_0 = 7.9799e-04
Loss = 1.8645e-01, PNorm = 43.9362, GNorm = 2.2055, lr_0 = 7.8149e-04
Validation rmse = 0.380308
Validation r2 = -0.565280
Validation mse = 0.144634
Epoch 8
Loss = 1.3417e-01, PNorm = 43.9657, GNorm = 1.4717, lr_0 = 7.6533e-04
Loss = 1.5837e-01, PNorm = 43.9920, GNorm = 1.9115, lr_0 = 7.4950e-04
Validation rmse = 0.350994
Validation r2 = -0.333278
Validation mse = 0.123197
Epoch 9
Loss = 1.2047e-01, PNorm = 44.0193, GNorm = 0.5758, lr_0 = 7.3247e-04
Loss = 1.5345e-01, PNorm = 44.0429, GNorm = 3.2200, lr_0 = 7.1733e-04
Validation rmse = 0.371062
Validation r2 = -0.490100
Validation mse = 0.137687
Epoch 10
Loss = 1.2364e-01, PNorm = 44.0701, GNorm = 2.4956, lr_0 = 7.0249e-04
Loss = 1.4760e-01, PNorm = 44.0951, GNorm = 2.1222, lr_0 = 6.8797e-04
Validation rmse = 0.373844
Validation r2 = -0.512527
Validation mse = 0.139759
Epoch 11
Loss = 1.5176e-01, PNorm = 44.1217, GNorm = 2.2677, lr_0 = 6.7234e-04
Loss = 1.2315e-01, PNorm = 44.1455, GNorm = 0.8131, lr_0 = 6.5843e-04
Validation rmse = 0.331433
Validation r2 = -0.188815
Validation mse = 0.109848
Epoch 12
Loss = 1.1134e-01, PNorm = 44.1709, GNorm = 0.9068, lr_0 = 6.4482e-04
Loss = 1.2544e-01, PNorm = 44.1872, GNorm = 3.1895, lr_0 = 6.3148e-04
Validation rmse = 0.352732
Validation r2 = -0.346520
Validation mse = 0.124420
Epoch 13
Loss = 1.2912e-01, PNorm = 44.2082, GNorm = 2.5094, lr_0 = 6.1714e-04
Loss = 1.2533e-01, PNorm = 44.2260, GNorm = 1.5177, lr_0 = 6.0438e-04
Validation rmse = 0.386813
Validation r2 = -0.619290
Validation mse = 0.149624
Epoch 14
Loss = 1.1435e-01, PNorm = 44.2470, GNorm = 0.8263, lr_0 = 5.9064e-04
Loss = 1.2264e-01, PNorm = 44.2617, GNorm = 1.2036, lr_0 = 5.7843e-04
Validation rmse = 0.353071
Validation r2 = -0.349108
Validation mse = 0.124659
Epoch 15
Loss = 1.1503e-01, PNorm = 44.2799, GNorm = 2.7462, lr_0 = 5.6647e-04
Loss = 1.2663e-01, PNorm = 44.2992, GNorm = 0.9003, lr_0 = 5.5476e-04
Loss = 1.2524e-01, PNorm = 44.3015, GNorm = 1.2087, lr_0 = 5.5360e-04
Validation rmse = 0.375694
Validation r2 = -0.527533
Validation mse = 0.141146
Epoch 16
Loss = 1.0971e-01, PNorm = 44.3199, GNorm = 2.6503, lr_0 = 5.4215e-04
Loss = 1.1385e-01, PNorm = 44.3377, GNorm = 1.2027, lr_0 = 5.3094e-04
Validation rmse = 0.379234
Validation r2 = -0.556454
Validation mse = 0.143818
Epoch 17
Loss = 1.2168e-01, PNorm = 44.3554, GNorm = 0.6785, lr_0 = 5.1996e-04
Validation rmse = 0.349177
Validation r2 = -0.319514
Validation mse = 0.121925
Epoch 18
Loss = 1.2497e-01, PNorm = 44.3730, GNorm = 2.2264, lr_0 = 5.0815e-04
Loss = 1.2293e-01, PNorm = 44.3902, GNorm = 4.0165, lr_0 = 4.9764e-04
Validation rmse = 0.355961
Validation r2 = -0.371284
Validation mse = 0.126708
Epoch 19
Loss = 1.1346e-01, PNorm = 44.4103, GNorm = 2.1072, lr_0 = 4.8633e-04
Loss = 1.1198e-01, PNorm = 44.4239, GNorm = 2.8465, lr_0 = 4.7628e-04
Validation rmse = 0.371355
Validation r2 = -0.492452
Validation mse = 0.137904
Epoch 20
Loss = 1.0132e-01, PNorm = 44.4437, GNorm = 2.3396, lr_0 = 4.6643e-04
Loss = 1.0115e-01, PNorm = 44.4587, GNorm = 3.7357, lr_0 = 4.5678e-04
Validation rmse = 0.346216
Validation r2 = -0.297231
Validation mse = 0.119866
Epoch 21
Loss = 9.3964e-02, PNorm = 44.4746, GNorm = 0.7369, lr_0 = 4.4640e-04
Loss = 1.1772e-01, PNorm = 44.4936, GNorm = 2.2835, lr_0 = 4.3717e-04
Validation rmse = 0.338696
Validation r2 = -0.241489
Validation mse = 0.114715
Epoch 22
Loss = 8.7623e-02, PNorm = 44.5083, GNorm = 1.2059, lr_0 = 4.2813e-04
Loss = 8.8605e-02, PNorm = 44.5214, GNorm = 1.0092, lr_0 = 4.1928e-04
Validation rmse = 0.390268
Validation r2 = -0.648344
Validation mse = 0.152309
Epoch 23
Loss = 9.0537e-02, PNorm = 44.5383, GNorm = 2.3597, lr_0 = 4.0975e-04
Loss = 8.0798e-02, PNorm = 44.5517, GNorm = 0.7521, lr_0 = 4.0128e-04
Validation rmse = 0.379664
Validation r2 = -0.559991
Validation mse = 0.144145
Epoch 24
Loss = 7.9247e-02, PNorm = 44.5630, GNorm = 1.8394, lr_0 = 3.9298e-04
Loss = 9.0679e-02, PNorm = 44.5750, GNorm = 1.6906, lr_0 = 3.8486e-04
Validation rmse = 0.368040
Validation r2 = -0.465925
Validation mse = 0.135453
Epoch 25
Loss = 8.2547e-02, PNorm = 44.5880, GNorm = 1.2300, lr_0 = 3.7611e-04
Loss = 8.0159e-02, PNorm = 44.5986, GNorm = 0.5764, lr_0 = 3.6834e-04
Validation rmse = 0.351818
Validation r2 = -0.339550
Validation mse = 0.123776
Epoch 26
Loss = 6.7769e-02, PNorm = 44.6121, GNorm = 1.2020, lr_0 = 3.5997e-04
Loss = 9.0276e-02, PNorm = 44.6236, GNorm = 1.2086, lr_0 = 3.5252e-04
Validation rmse = 0.337463
Validation r2 = -0.232461
Validation mse = 0.113881
Epoch 27
Loss = 8.2306e-02, PNorm = 44.6336, GNorm = 1.1282, lr_0 = 3.4523e-04
Loss = 9.7447e-02, PNorm = 44.6446, GNorm = 3.5792, lr_0 = 3.3809e-04
Validation rmse = 0.345282
Validation r2 = -0.290235
Validation mse = 0.119219
Epoch 28
Loss = 9.3772e-02, PNorm = 44.6588, GNorm = 1.0784, lr_0 = 3.3041e-04
Loss = 7.4465e-02, PNorm = 44.6711, GNorm = 0.7341, lr_0 = 3.2358e-04
Validation rmse = 0.332051
Validation r2 = -0.193250
Validation mse = 0.110258
Epoch 29
Loss = 8.2385e-02, PNorm = 44.6822, GNorm = 1.0043, lr_0 = 3.1689e-04
Loss = 7.5112e-02, PNorm = 44.6931, GNorm = 0.8470, lr_0 = 3.1034e-04
Validation rmse = 0.350009
Validation r2 = -0.325805
Validation mse = 0.122506
Epoch 30
Loss = 7.9261e-02, PNorm = 44.7031, GNorm = 1.5252, lr_0 = 3.0329e-04
Loss = 9.1995e-02, PNorm = 44.7132, GNorm = 0.8754, lr_0 = 2.9701e-04
Validation rmse = 0.380209
Validation r2 = -0.564466
Validation mse = 0.144559
Epoch 31
Loss = 8.0320e-02, PNorm = 44.7229, GNorm = 0.7096, lr_0 = 2.9087e-04
Loss = 9.0205e-02, PNorm = 44.7336, GNorm = 2.4063, lr_0 = 2.8486e-04
Validation rmse = 0.337143
Validation r2 = -0.230128
Validation mse = 0.113665
Epoch 32
Loss = 7.4171e-02, PNorm = 44.7451, GNorm = 0.7296, lr_0 = 2.7839e-04
Loss = 8.8479e-02, PNorm = 44.7552, GNorm = 0.9979, lr_0 = 2.7263e-04
Loss = 9.3433e-02, PNorm = 44.7562, GNorm = 2.9381, lr_0 = 2.7206e-04
Validation rmse = 0.371495
Validation r2 = -0.493581
Validation mse = 0.138009
Epoch 33
Loss = 9.0522e-02, PNorm = 44.7649, GNorm = 2.9267, lr_0 = 2.6643e-04
Loss = 8.2022e-02, PNorm = 44.7762, GNorm = 1.0441, lr_0 = 2.6092e-04
Validation rmse = 0.353907
Validation r2 = -0.355504
Validation mse = 0.125250
Epoch 34
Loss = 7.2335e-02, PNorm = 44.7857, GNorm = 0.9965, lr_0 = 2.5553e-04
Validation rmse = 0.345779
Validation r2 = -0.293957
Validation mse = 0.119563
Epoch 35
Loss = 5.3020e-02, PNorm = 44.7955, GNorm = 0.4823, lr_0 = 2.4972e-04
Loss = 6.7552e-02, PNorm = 44.8036, GNorm = 1.9050, lr_0 = 2.4456e-04
Validation rmse = 0.351468
Validation r2 = -0.336886
Validation mse = 0.123530
Epoch 36
Loss = 4.5576e-02, PNorm = 44.8114, GNorm = 0.6809, lr_0 = 2.3950e-04
Loss = 6.4435e-02, PNorm = 44.8178, GNorm = 0.5698, lr_0 = 2.3455e-04
Validation rmse = 0.347485
Validation r2 = -0.306757
Validation mse = 0.120746
Epoch 37
Loss = 6.8702e-02, PNorm = 44.8259, GNorm = 1.4080, lr_0 = 2.2922e-04
Loss = 6.6249e-02, PNorm = 44.8348, GNorm = 2.8657, lr_0 = 2.2448e-04
Validation rmse = 0.344524
Validation r2 = -0.284580
Validation mse = 0.118697
Epoch 38
Loss = 5.1836e-02, PNorm = 44.8426, GNorm = 0.8449, lr_0 = 2.1938e-04
Loss = 6.8785e-02, PNorm = 44.8499, GNorm = 0.7088, lr_0 = 2.1484e-04
Validation rmse = 0.340408
Validation r2 = -0.254073
Validation mse = 0.115878
Epoch 39
Loss = 5.0693e-02, PNorm = 44.8584, GNorm = 1.4336, lr_0 = 2.1040e-04
Loss = 5.7405e-02, PNorm = 44.8649, GNorm = 1.7683, lr_0 = 2.0605e-04
Validation rmse = 0.381590
Validation r2 = -0.575855
Validation mse = 0.145611
Epoch 40
Loss = 7.5844e-02, PNorm = 44.8736, GNorm = 1.3536, lr_0 = 2.0137e-04
Loss = 5.9888e-02, PNorm = 44.8813, GNorm = 0.6637, lr_0 = 1.9721e-04
Validation rmse = 0.360065
Validation r2 = -0.403082
Validation mse = 0.129647
Epoch 41
Loss = 5.9725e-02, PNorm = 44.8888, GNorm = 0.6904, lr_0 = 1.9313e-04
Loss = 6.8508e-02, PNorm = 44.8963, GNorm = 1.6737, lr_0 = 1.8913e-04
Validation rmse = 0.363074
Validation r2 = -0.426635
Validation mse = 0.131823
Epoch 42
Loss = 6.0170e-02, PNorm = 44.9055, GNorm = 1.5005, lr_0 = 1.8484e-04
Loss = 6.0966e-02, PNorm = 44.9127, GNorm = 0.5885, lr_0 = 1.8101e-04
Validation rmse = 0.361612
Validation r2 = -0.415164
Validation mse = 0.130763
Epoch 43
Loss = 6.5713e-02, PNorm = 44.9202, GNorm = 1.5958, lr_0 = 1.7727e-04
Loss = 5.8057e-02, PNorm = 44.9273, GNorm = 1.7749, lr_0 = 1.7361e-04
Validation rmse = 0.342707
Validation r2 = -0.271064
Validation mse = 0.117448
Epoch 44
Loss = 5.3125e-02, PNorm = 44.9332, GNorm = 1.2802, lr_0 = 1.6966e-04
Loss = 5.8271e-02, PNorm = 44.9390, GNorm = 0.6463, lr_0 = 1.6615e-04
Validation rmse = 0.339243
Validation r2 = -0.245504
Validation mse = 0.115086
Epoch 45
Loss = 4.6921e-02, PNorm = 44.9465, GNorm = 0.6125, lr_0 = 1.6238e-04
Loss = 5.7390e-02, PNorm = 44.9514, GNorm = 0.8528, lr_0 = 1.5902e-04
Validation rmse = 0.342852
Validation r2 = -0.272145
Validation mse = 0.117548
Epoch 46
Loss = 5.5552e-02, PNorm = 44.9567, GNorm = 1.6876, lr_0 = 1.5573e-04
Loss = 5.7479e-02, PNorm = 44.9625, GNorm = 0.6547, lr_0 = 1.5251e-04
Validation rmse = 0.357776
Validation r2 = -0.385305
Validation mse = 0.128004
Epoch 47
Loss = 5.4861e-02, PNorm = 44.9677, GNorm = 2.1195, lr_0 = 1.4905e-04
Loss = 6.3869e-02, PNorm = 44.9725, GNorm = 1.9609, lr_0 = 1.4596e-04
Validation rmse = 0.357029
Validation r2 = -0.379521
Validation mse = 0.127469
Epoch 48
Loss = 6.5446e-02, PNorm = 44.9786, GNorm = 3.0631, lr_0 = 1.4295e-04
Loss = 5.1126e-02, PNorm = 44.9839, GNorm = 0.7815, lr_0 = 1.3999e-04
Validation rmse = 0.340181
Validation r2 = -0.252397
Validation mse = 0.115723
Epoch 49
Loss = 5.1277e-02, PNorm = 44.9894, GNorm = 0.5049, lr_0 = 1.3681e-04
Loss = 5.4017e-02, PNorm = 44.9941, GNorm = 1.2302, lr_0 = 1.3398e-04
Validation rmse = 0.365211
Validation r2 = -0.443480
Validation mse = 0.133379
Epoch 50
Loss = 5.2122e-02, PNorm = 44.9990, GNorm = 0.8858, lr_0 = 1.3121e-04
Loss = 5.8860e-02, PNorm = 45.0029, GNorm = 2.0502, lr_0 = 1.2850e-04
Loss = 4.6145e-02, PNorm = 45.0035, GNorm = 1.8886, lr_0 = 1.2823e-04
Validation rmse = 0.332974
Validation r2 = -0.199892
Validation mse = 0.110872
Epoch 51
Loss = 5.0824e-02, PNorm = 45.0083, GNorm = 1.2881, lr_0 = 1.2558e-04
Validation rmse = 0.327011
Validation r2 = -0.157300
Validation mse = 0.106936
Epoch 52
Loss = 6.1265e-02, PNorm = 45.0140, GNorm = 0.9649, lr_0 = 1.2272e-04
Loss = 5.5014e-02, PNorm = 45.0189, GNorm = 1.0471, lr_0 = 1.2019e-04
Validation rmse = 0.359295
Validation r2 = -0.397092
Validation mse = 0.129093
Epoch 53
Loss = 6.9359e-02, PNorm = 45.0228, GNorm = 1.3497, lr_0 = 1.1770e-04
Loss = 4.4035e-02, PNorm = 45.0269, GNorm = 1.2367, lr_0 = 1.1527e-04
Validation rmse = 0.346908
Validation r2 = -0.302422
Validation mse = 0.120345
Epoch 54
Loss = 6.7948e-02, PNorm = 45.0320, GNorm = 2.5542, lr_0 = 1.1265e-04
Loss = 5.1364e-02, PNorm = 45.0361, GNorm = 0.8036, lr_0 = 1.1032e-04
Validation rmse = 0.361219
Validation r2 = -0.412092
Validation mse = 0.130479
Epoch 55
Loss = 4.8351e-02, PNorm = 45.0401, GNorm = 1.9540, lr_0 = 1.0804e-04
Loss = 4.7826e-02, PNorm = 45.0435, GNorm = 1.1478, lr_0 = 1.0580e-04
Validation rmse = 0.333543
Validation r2 = -0.203996
Validation mse = 0.111251
Epoch 56
Loss = 3.7072e-02, PNorm = 45.0477, GNorm = 0.5324, lr_0 = 1.0340e-04
Loss = 5.1095e-02, PNorm = 45.0516, GNorm = 0.7215, lr_0 = 1.0126e-04
Validation rmse = 0.337652
Validation r2 = -0.233844
Validation mse = 0.114009
Epoch 57
Loss = 4.6420e-02, PNorm = 45.0553, GNorm = 0.6847, lr_0 = 1.0000e-04
Loss = 4.6236e-02, PNorm = 45.0587, GNorm = 0.6079, lr_0 = 1.0000e-04
Validation rmse = 0.330782
Validation r2 = -0.184149
Validation mse = 0.109417
Epoch 58
Loss = 4.7064e-02, PNorm = 45.0619, GNorm = 2.0892, lr_0 = 1.0000e-04
Loss = 4.8229e-02, PNorm = 45.0654, GNorm = 1.1948, lr_0 = 1.0000e-04
Validation rmse = 0.335106
Validation r2 = -0.215308
Validation mse = 0.112296
Epoch 59
Loss = 3.9771e-02, PNorm = 45.0696, GNorm = 0.8788, lr_0 = 1.0000e-04
Loss = 4.8444e-02, PNorm = 45.0728, GNorm = 0.8336, lr_0 = 1.0000e-04
Validation rmse = 0.343554
Validation r2 = -0.277359
Validation mse = 0.118030
Model 0 best validation rmse = 0.265591 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.540366
Model 0 test r2 = -5.929345
Model 0 test mse = 0.291996
Ensemble test rmse = 0.540366
Ensemble test r2 = -5.929345
Ensemble test mse = 0.291996
Fold 3
Splitting data with seed 3
Total size = 981 | train size = 971 | val size = 10 | test size = 51
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 1.0187e+00, PNorm = 43.2605, GNorm = 2.8412, lr_0 = 3.6053e-04
Validation rmse = 0.283810
Validation r2 = 0.300967
Validation mse = 0.080548
Epoch 1
Loss = 1.0284e+00, PNorm = 43.2829, GNorm = 10.6006, lr_0 = 6.2105e-04
Loss = 6.3072e-01, PNorm = 43.3173, GNorm = 8.5372, lr_0 = 8.5789e-04
Validation rmse = 0.226793
Validation r2 = 0.553622
Validation mse = 0.051435
Epoch 2
Loss = 4.1358e-01, PNorm = 43.3846, GNorm = 3.6959, lr_0 = 9.8961e-04
Loss = 4.9408e-01, PNorm = 43.4547, GNorm = 2.2170, lr_0 = 9.6914e-04
Validation rmse = 0.214414
Validation r2 = 0.601021
Validation mse = 0.045973
Epoch 3
Loss = 3.7432e-01, PNorm = 43.5125, GNorm = 6.4914, lr_0 = 9.4910e-04
Loss = 3.5190e-01, PNorm = 43.5704, GNorm = 4.2424, lr_0 = 9.2948e-04
Validation rmse = 0.184177
Validation r2 = 0.705617
Validation mse = 0.033921
Epoch 4
Loss = 2.1435e-01, PNorm = 43.6375, GNorm = 1.0122, lr_0 = 9.0836e-04
Loss = 3.0925e-01, PNorm = 43.6940, GNorm = 6.3671, lr_0 = 8.8958e-04
Validation rmse = 0.151863
Validation r2 = 0.799853
Validation mse = 0.023062
Epoch 5
Loss = 2.4250e-01, PNorm = 43.7499, GNorm = 0.8471, lr_0 = 8.7118e-04
Loss = 2.3248e-01, PNorm = 43.7972, GNorm = 3.7289, lr_0 = 8.5317e-04
Validation rmse = 0.164859
Validation r2 = 0.764131
Validation mse = 0.027179
Epoch 6
Loss = 2.3505e-01, PNorm = 43.8438, GNorm = 1.2021, lr_0 = 8.3378e-04
Loss = 1.8861e-01, PNorm = 43.8828, GNorm = 1.4740, lr_0 = 8.1654e-04
Validation rmse = 0.147506
Validation r2 = 0.811174
Validation mse = 0.021758
Epoch 7
Loss = 2.4716e-01, PNorm = 43.9280, GNorm = 5.4395, lr_0 = 7.9799e-04
Loss = 1.7663e-01, PNorm = 43.9672, GNorm = 6.4178, lr_0 = 7.8149e-04
Validation rmse = 0.128813
Validation r2 = 0.856000
Validation mse = 0.016593
Epoch 8
Loss = 1.5154e-01, PNorm = 44.0139, GNorm = 1.9754, lr_0 = 7.6533e-04
Loss = 1.5020e-01, PNorm = 44.0527, GNorm = 0.8830, lr_0 = 7.4950e-04
Validation rmse = 0.123182
Validation r2 = 0.868314
Validation mse = 0.015174
Epoch 9
Loss = 1.1662e-01, PNorm = 44.0914, GNorm = 1.6651, lr_0 = 7.3247e-04
Loss = 1.4515e-01, PNorm = 44.1163, GNorm = 1.7572, lr_0 = 7.1733e-04
Validation rmse = 0.118202
Validation r2 = 0.878747
Validation mse = 0.013972
Epoch 10
Loss = 1.1265e-01, PNorm = 44.1429, GNorm = 2.6498, lr_0 = 7.0249e-04
Loss = 1.3845e-01, PNorm = 44.1671, GNorm = 1.5801, lr_0 = 6.8797e-04
Validation rmse = 0.092989
Validation r2 = 0.924957
Validation mse = 0.008647
Epoch 11
Loss = 1.1888e-01, PNorm = 44.1901, GNorm = 0.4162, lr_0 = 6.7234e-04
Loss = 1.3235e-01, PNorm = 44.2123, GNorm = 2.0720, lr_0 = 6.5843e-04
Validation rmse = 0.099442
Validation r2 = 0.914181
Validation mse = 0.009889
Epoch 12
Loss = 1.3743e-01, PNorm = 44.2320, GNorm = 1.1236, lr_0 = 6.4482e-04
Loss = 1.1095e-01, PNorm = 44.2546, GNorm = 1.1317, lr_0 = 6.3148e-04
Validation rmse = 0.090650
Validation r2 = 0.928685
Validation mse = 0.008217
Epoch 13
Loss = 1.2111e-01, PNorm = 44.2730, GNorm = 1.7927, lr_0 = 6.1714e-04
Loss = 1.1447e-01, PNorm = 44.2893, GNorm = 1.5962, lr_0 = 6.0438e-04
Validation rmse = 0.119823
Validation r2 = 0.875399
Validation mse = 0.014357
Epoch 14
Loss = 1.1067e-01, PNorm = 44.3118, GNorm = 1.0860, lr_0 = 5.9064e-04
Loss = 1.1943e-01, PNorm = 44.3314, GNorm = 2.7741, lr_0 = 5.7843e-04
Validation rmse = 0.104372
Validation r2 = 0.905461
Validation mse = 0.010893
Epoch 15
Loss = 1.2480e-01, PNorm = 44.3482, GNorm = 2.8586, lr_0 = 5.6647e-04
Loss = 1.2529e-01, PNorm = 44.3645, GNorm = 0.8263, lr_0 = 5.5476e-04
Loss = 7.6197e-02, PNorm = 44.3656, GNorm = 1.1829, lr_0 = 5.5360e-04
Validation rmse = 0.089970
Validation r2 = 0.929751
Validation mse = 0.008095
Epoch 16
Loss = 1.0309e-01, PNorm = 44.3816, GNorm = 1.6743, lr_0 = 5.4215e-04
Loss = 1.0596e-01, PNorm = 44.3976, GNorm = 1.9700, lr_0 = 5.3094e-04
Validation rmse = 0.099374
Validation r2 = 0.914298
Validation mse = 0.009875
Epoch 17
Loss = 9.9716e-02, PNorm = 44.4140, GNorm = 5.2553, lr_0 = 5.1996e-04
Validation rmse = 0.092632
Validation r2 = 0.925532
Validation mse = 0.008581
Epoch 18
Loss = 1.0763e-01, PNorm = 44.4329, GNorm = 1.2314, lr_0 = 5.0815e-04
Loss = 9.6046e-02, PNorm = 44.4473, GNorm = 1.7282, lr_0 = 4.9764e-04
Validation rmse = 0.084176
Validation r2 = 0.938508
Validation mse = 0.007086
Epoch 19
Loss = 9.9983e-02, PNorm = 44.4626, GNorm = 1.1936, lr_0 = 4.8633e-04
Loss = 1.0185e-01, PNorm = 44.4821, GNorm = 2.2228, lr_0 = 4.7628e-04
Validation rmse = 0.112189
Validation r2 = 0.890770
Validation mse = 0.012586
Epoch 20
Loss = 1.1260e-01, PNorm = 44.4965, GNorm = 1.0746, lr_0 = 4.6643e-04
Loss = 9.4732e-02, PNorm = 44.5092, GNorm = 2.4197, lr_0 = 4.5678e-04
Validation rmse = 0.086441
Validation r2 = 0.935155
Validation mse = 0.007472
Epoch 21
Loss = 1.0953e-01, PNorm = 44.5261, GNorm = 2.9890, lr_0 = 4.4640e-04
Loss = 7.5183e-02, PNorm = 44.5374, GNorm = 1.1290, lr_0 = 4.3717e-04
Validation rmse = 0.093460
Validation r2 = 0.924195
Validation mse = 0.008735
Epoch 22
Loss = 1.0987e-01, PNorm = 44.5518, GNorm = 1.1251, lr_0 = 4.2813e-04
Loss = 8.4593e-02, PNorm = 44.5676, GNorm = 1.8075, lr_0 = 4.1928e-04
Validation rmse = 0.114317
Validation r2 = 0.886586
Validation mse = 0.013068
Epoch 23
Loss = 1.0074e-01, PNorm = 44.5811, GNorm = 2.4075, lr_0 = 4.0975e-04
Loss = 1.0650e-01, PNorm = 44.5960, GNorm = 3.3470, lr_0 = 4.0128e-04
Validation rmse = 0.097554
Validation r2 = 0.917409
Validation mse = 0.009517
Epoch 24
Loss = 8.8619e-02, PNorm = 44.6118, GNorm = 1.2391, lr_0 = 3.9298e-04
Loss = 9.7611e-02, PNorm = 44.6266, GNorm = 1.9576, lr_0 = 3.8486e-04
Validation rmse = 0.086767
Validation r2 = 0.934665
Validation mse = 0.007528
Epoch 25
Loss = 7.3804e-02, PNorm = 44.6414, GNorm = 0.7632, lr_0 = 3.7611e-04
Loss = 9.6280e-02, PNorm = 44.6550, GNorm = 0.7963, lr_0 = 3.6834e-04
Validation rmse = 0.095790
Validation r2 = 0.920368
Validation mse = 0.009176
Epoch 26
Loss = 7.6366e-02, PNorm = 44.6652, GNorm = 0.7223, lr_0 = 3.5997e-04
Loss = 8.6619e-02, PNorm = 44.6788, GNorm = 1.7439, lr_0 = 3.5252e-04
Validation rmse = 0.095936
Validation r2 = 0.920125
Validation mse = 0.009204
Epoch 27
Loss = 7.6132e-02, PNorm = 44.6856, GNorm = 1.3804, lr_0 = 3.4523e-04
Loss = 8.5963e-02, PNorm = 44.6960, GNorm = 2.9976, lr_0 = 3.3809e-04
Validation rmse = 0.098329
Validation r2 = 0.916092
Validation mse = 0.009669
Epoch 28
Loss = 8.1134e-02, PNorm = 44.7063, GNorm = 3.4544, lr_0 = 3.3041e-04
Loss = 1.0705e-01, PNorm = 44.7195, GNorm = 1.2752, lr_0 = 3.2358e-04
Validation rmse = 0.085134
Validation r2 = 0.937100
Validation mse = 0.007248
Epoch 29
Loss = 8.6504e-02, PNorm = 44.7306, GNorm = 3.4927, lr_0 = 3.1689e-04
Loss = 8.1918e-02, PNorm = 44.7418, GNorm = 1.0788, lr_0 = 3.1034e-04
Validation rmse = 0.096858
Validation r2 = 0.918583
Validation mse = 0.009381
Epoch 30
Loss = 9.2343e-02, PNorm = 44.7523, GNorm = 2.6677, lr_0 = 3.0329e-04
Loss = 8.1796e-02, PNorm = 44.7624, GNorm = 1.0169, lr_0 = 2.9701e-04
Validation rmse = 0.089859
Validation r2 = 0.929925
Validation mse = 0.008075
Epoch 31
Loss = 7.3376e-02, PNorm = 44.7723, GNorm = 0.8711, lr_0 = 2.9087e-04
Loss = 7.2326e-02, PNorm = 44.7811, GNorm = 0.9601, lr_0 = 2.8486e-04
Validation rmse = 0.086984
Validation r2 = 0.934337
Validation mse = 0.007566
Epoch 32
Loss = 8.1666e-02, PNorm = 44.7923, GNorm = 1.9413, lr_0 = 2.7839e-04
Loss = 7.8123e-02, PNorm = 44.8019, GNorm = 3.1053, lr_0 = 2.7263e-04
Loss = 6.3643e-02, PNorm = 44.8025, GNorm = 1.0305, lr_0 = 2.7206e-04
Validation rmse = 0.087423
Validation r2 = 0.933673
Validation mse = 0.007643
Epoch 33
Loss = 7.6101e-02, PNorm = 44.8119, GNorm = 0.9269, lr_0 = 2.6643e-04
Loss = 7.4153e-02, PNorm = 44.8206, GNorm = 1.1454, lr_0 = 2.6092e-04
Validation rmse = 0.087264
Validation r2 = 0.933913
Validation mse = 0.007615
Epoch 34
Loss = 7.1074e-02, PNorm = 44.8296, GNorm = 1.3450, lr_0 = 2.5553e-04
Validation rmse = 0.096708
Validation r2 = 0.918835
Validation mse = 0.009352
Epoch 35
Loss = 8.1745e-02, PNorm = 44.8389, GNorm = 1.3626, lr_0 = 2.4972e-04
Loss = 7.0138e-02, PNorm = 44.8456, GNorm = 2.4009, lr_0 = 2.4456e-04
Validation rmse = 0.088084
Validation r2 = 0.932666
Validation mse = 0.007759
Epoch 36
Loss = 5.1029e-02, PNorm = 44.8542, GNorm = 0.8287, lr_0 = 2.3950e-04
Loss = 6.9194e-02, PNorm = 44.8607, GNorm = 1.0385, lr_0 = 2.3455e-04
Validation rmse = 0.090120
Validation r2 = 0.929517
Validation mse = 0.008122
Epoch 37
Loss = 5.7328e-02, PNorm = 44.8677, GNorm = 1.3624, lr_0 = 2.2922e-04
Loss = 6.4154e-02, PNorm = 44.8740, GNorm = 1.8429, lr_0 = 2.2448e-04
Validation rmse = 0.089319
Validation r2 = 0.930764
Validation mse = 0.007978
Epoch 38
Loss = 6.4844e-02, PNorm = 44.8825, GNorm = 1.3539, lr_0 = 2.1938e-04
Loss = 6.8864e-02, PNorm = 44.8892, GNorm = 0.5794, lr_0 = 2.1484e-04
Validation rmse = 0.089828
Validation r2 = 0.929973
Validation mse = 0.008069
Epoch 39
Loss = 6.7896e-02, PNorm = 44.8959, GNorm = 3.2955, lr_0 = 2.1040e-04
Loss = 6.6958e-02, PNorm = 44.9035, GNorm = 0.7094, lr_0 = 2.0605e-04
Validation rmse = 0.090208
Validation r2 = 0.929379
Validation mse = 0.008137
Epoch 40
Loss = 5.1526e-02, PNorm = 44.9090, GNorm = 0.7527, lr_0 = 2.0137e-04
Loss = 7.0927e-02, PNorm = 44.9151, GNorm = 1.3982, lr_0 = 1.9721e-04
Validation rmse = 0.088638
Validation r2 = 0.931816
Validation mse = 0.007857
Epoch 41
Loss = 5.5087e-02, PNorm = 44.9215, GNorm = 0.4490, lr_0 = 1.9313e-04
Loss = 6.6916e-02, PNorm = 44.9278, GNorm = 0.5994, lr_0 = 1.8913e-04
Validation rmse = 0.087177
Validation r2 = 0.934044
Validation mse = 0.007600
Epoch 42
Loss = 5.8515e-02, PNorm = 44.9368, GNorm = 0.5371, lr_0 = 1.8484e-04
Loss = 6.4403e-02, PNorm = 44.9434, GNorm = 1.1757, lr_0 = 1.8101e-04
Validation rmse = 0.084135
Validation r2 = 0.938568
Validation mse = 0.007079
Epoch 43
Loss = 5.7587e-02, PNorm = 44.9488, GNorm = 1.2821, lr_0 = 1.7727e-04
Loss = 6.0576e-02, PNorm = 44.9548, GNorm = 0.6681, lr_0 = 1.7361e-04
Validation rmse = 0.091011
Validation r2 = 0.928116
Validation mse = 0.008283
Epoch 44
Loss = 5.4533e-02, PNorm = 44.9612, GNorm = 0.6149, lr_0 = 1.6966e-04
Loss = 5.5147e-02, PNorm = 44.9660, GNorm = 0.7086, lr_0 = 1.6615e-04
Validation rmse = 0.081989
Validation r2 = 0.941662
Validation mse = 0.006722
Epoch 45
Loss = 5.5607e-02, PNorm = 44.9722, GNorm = 0.5872, lr_0 = 1.6238e-04
Loss = 5.5808e-02, PNorm = 44.9775, GNorm = 0.4117, lr_0 = 1.5902e-04
Validation rmse = 0.087549
Validation r2 = 0.933481
Validation mse = 0.007665
Epoch 46
Loss = 6.2964e-02, PNorm = 44.9825, GNorm = 2.3039, lr_0 = 1.5573e-04
Loss = 6.6897e-02, PNorm = 44.9891, GNorm = 1.6285, lr_0 = 1.5251e-04
Validation rmse = 0.092634
Validation r2 = 0.925530
Validation mse = 0.008581
Epoch 47
Loss = 4.9179e-02, PNorm = 44.9958, GNorm = 1.2142, lr_0 = 1.4905e-04
Loss = 5.9556e-02, PNorm = 45.0002, GNorm = 1.3901, lr_0 = 1.4596e-04
Validation rmse = 0.088003
Validation r2 = 0.932789
Validation mse = 0.007745
Epoch 48
Loss = 5.1822e-02, PNorm = 45.0049, GNorm = 0.8162, lr_0 = 1.4295e-04
Loss = 5.8230e-02, PNorm = 45.0093, GNorm = 1.1220, lr_0 = 1.3999e-04
Validation rmse = 0.092865
Validation r2 = 0.925157
Validation mse = 0.008624
Epoch 49
Loss = 6.2109e-02, PNorm = 45.0153, GNorm = 0.8262, lr_0 = 1.3681e-04
Loss = 4.7511e-02, PNorm = 45.0206, GNorm = 0.6213, lr_0 = 1.3398e-04
Validation rmse = 0.087262
Validation r2 = 0.933917
Validation mse = 0.007615
Epoch 50
Loss = 5.4644e-02, PNorm = 45.0253, GNorm = 0.6244, lr_0 = 1.3121e-04
Loss = 5.0408e-02, PNorm = 45.0299, GNorm = 0.9714, lr_0 = 1.2850e-04
Loss = 4.8616e-02, PNorm = 45.0303, GNorm = 1.0392, lr_0 = 1.2823e-04
Validation rmse = 0.089180
Validation r2 = 0.930979
Validation mse = 0.007953
Epoch 51
Loss = 4.9298e-02, PNorm = 45.0347, GNorm = 0.6089, lr_0 = 1.2558e-04
Validation rmse = 0.084514
Validation r2 = 0.938013
Validation mse = 0.007143
Epoch 52
Loss = 5.3431e-02, PNorm = 45.0392, GNorm = 0.4910, lr_0 = 1.2272e-04
Loss = 6.1305e-02, PNorm = 45.0435, GNorm = 1.2423, lr_0 = 1.2019e-04
Validation rmse = 0.086382
Validation r2 = 0.935243
Validation mse = 0.007462
Epoch 53
Loss = 4.7304e-02, PNorm = 45.0476, GNorm = 1.6261, lr_0 = 1.1770e-04
Loss = 4.6899e-02, PNorm = 45.0519, GNorm = 1.2739, lr_0 = 1.1527e-04
Validation rmse = 0.098246
Validation r2 = 0.916234
Validation mse = 0.009652
Epoch 54
Loss = 6.1925e-02, PNorm = 45.0562, GNorm = 1.3935, lr_0 = 1.1265e-04
Loss = 4.7668e-02, PNorm = 45.0603, GNorm = 0.4739, lr_0 = 1.1032e-04
Validation rmse = 0.078512
Validation r2 = 0.946504
Validation mse = 0.006164
Epoch 55
Loss = 4.0281e-02, PNorm = 45.0642, GNorm = 0.8910, lr_0 = 1.0804e-04
Loss = 4.8587e-02, PNorm = 45.0679, GNorm = 0.5827, lr_0 = 1.0580e-04
Validation rmse = 0.084091
Validation r2 = 0.938632
Validation mse = 0.007071
Epoch 56
Loss = 3.9805e-02, PNorm = 45.0725, GNorm = 0.8174, lr_0 = 1.0340e-04
Loss = 4.4599e-02, PNorm = 45.0766, GNorm = 0.6069, lr_0 = 1.0126e-04
Validation rmse = 0.084104
Validation r2 = 0.938612
Validation mse = 0.007074
Epoch 57
Loss = 3.6643e-02, PNorm = 45.0808, GNorm = 0.4828, lr_0 = 1.0000e-04
Loss = 5.1716e-02, PNorm = 45.0843, GNorm = 0.5351, lr_0 = 1.0000e-04
Validation rmse = 0.082628
Validation r2 = 0.940749
Validation mse = 0.006827
Epoch 58
Loss = 4.3964e-02, PNorm = 45.0880, GNorm = 1.2346, lr_0 = 1.0000e-04
Loss = 4.3311e-02, PNorm = 45.0914, GNorm = 1.4555, lr_0 = 1.0000e-04
Validation rmse = 0.092399
Validation r2 = 0.925907
Validation mse = 0.008538
Epoch 59
Loss = 4.8801e-02, PNorm = 45.0961, GNorm = 0.8496, lr_0 = 1.0000e-04
Loss = 4.7683e-02, PNorm = 45.0991, GNorm = 0.5846, lr_0 = 1.0000e-04
Validation rmse = 0.081862
Validation r2 = 0.941842
Validation mse = 0.006701
Model 0 best validation rmse = 0.078512 on epoch 54
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.462963
Model 0 test r2 = -4.086376
Model 0 test mse = 0.214335
Ensemble test rmse = 0.462963
Ensemble test r2 = -4.086376
Ensemble test mse = 0.214335
Fold 4
Splitting data with seed 4
Total size = 981 | train size = 971 | val size = 10 | test size = 51
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 1.0049e+00, PNorm = 43.2627, GNorm = 0.9499, lr_0 = 3.6053e-04
Validation rmse = 0.166958
Validation r2 = 0.513107
Validation mse = 0.027875
Epoch 1
Loss = 7.1728e-01, PNorm = 43.2926, GNorm = 1.5397, lr_0 = 6.2105e-04
Loss = 6.4479e-01, PNorm = 43.3248, GNorm = 8.3012, lr_0 = 8.5789e-04
Validation rmse = 0.158756
Validation r2 = 0.559772
Validation mse = 0.025203
Epoch 2
Loss = 4.6439e-01, PNorm = 43.3930, GNorm = 1.7072, lr_0 = 9.8961e-04
Loss = 4.0680e-01, PNorm = 43.4508, GNorm = 9.8572, lr_0 = 9.6914e-04
Validation rmse = 0.152194
Validation r2 = 0.595408
Validation mse = 0.023163
Epoch 3
Loss = 5.1723e-01, PNorm = 43.5109, GNorm = 9.9871, lr_0 = 9.4910e-04
Loss = 3.0947e-01, PNorm = 43.5760, GNorm = 4.1937, lr_0 = 9.2948e-04
Validation rmse = 0.189502
Validation r2 = 0.372738
Validation mse = 0.035911
Epoch 4
Loss = 3.9203e-01, PNorm = 43.6485, GNorm = 6.2636, lr_0 = 9.0836e-04
Loss = 3.5252e-01, PNorm = 43.7033, GNorm = 1.5611, lr_0 = 8.8958e-04
Validation rmse = 0.168499
Validation r2 = 0.504076
Validation mse = 0.028392
Epoch 5
Loss = 2.3576e-01, PNorm = 43.7589, GNorm = 1.2950, lr_0 = 8.7118e-04
Loss = 2.1957e-01, PNorm = 43.8014, GNorm = 2.2029, lr_0 = 8.5317e-04
Validation rmse = 0.150768
Validation r2 = 0.602957
Validation mse = 0.022731
Epoch 6
Loss = 2.2402e-01, PNorm = 43.8483, GNorm = 4.9640, lr_0 = 8.3378e-04
Loss = 1.8958e-01, PNorm = 43.8903, GNorm = 6.5111, lr_0 = 8.1654e-04
Validation rmse = 0.133426
Validation r2 = 0.689044
Validation mse = 0.017802
Epoch 7
Loss = 1.7733e-01, PNorm = 43.9255, GNorm = 1.1473, lr_0 = 7.9799e-04
Loss = 2.1132e-01, PNorm = 43.9619, GNorm = 4.0086, lr_0 = 7.8149e-04
Validation rmse = 0.126415
Validation r2 = 0.720864
Validation mse = 0.015981
Epoch 8
Loss = 1.7530e-01, PNorm = 44.0007, GNorm = 0.6333, lr_0 = 7.6533e-04
Loss = 1.9717e-01, PNorm = 44.0394, GNorm = 2.4375, lr_0 = 7.4950e-04
Validation rmse = 0.135364
Validation r2 = 0.679946
Validation mse = 0.018323
Epoch 9
Loss = 1.9332e-01, PNorm = 44.0719, GNorm = 2.1753, lr_0 = 7.3247e-04
Loss = 1.7632e-01, PNorm = 44.1058, GNorm = 1.4840, lr_0 = 7.1733e-04
Validation rmse = 0.113960
Validation r2 = 0.773159
Validation mse = 0.012987
Epoch 10
Loss = 1.2721e-01, PNorm = 44.1329, GNorm = 1.4091, lr_0 = 7.0249e-04
Loss = 1.2981e-01, PNorm = 44.1536, GNorm = 1.0421, lr_0 = 6.8797e-04
Validation rmse = 0.157726
Validation r2 = 0.565466
Validation mse = 0.024877
Epoch 11
Loss = 1.3429e-01, PNorm = 44.1738, GNorm = 0.9662, lr_0 = 6.7234e-04
Loss = 1.4777e-01, PNorm = 44.1936, GNorm = 2.1668, lr_0 = 6.5843e-04
Validation rmse = 0.108118
Validation r2 = 0.795818
Validation mse = 0.011690
Epoch 12
Loss = 1.6134e-01, PNorm = 44.2154, GNorm = 3.7535, lr_0 = 6.4482e-04
Loss = 1.2859e-01, PNorm = 44.2386, GNorm = 1.4471, lr_0 = 6.3148e-04
Validation rmse = 0.119503
Validation r2 = 0.750552
Validation mse = 0.014281
Epoch 13
Loss = 1.1310e-01, PNorm = 44.2589, GNorm = 1.8649, lr_0 = 6.1714e-04
Loss = 1.2749e-01, PNorm = 44.2760, GNorm = 2.3762, lr_0 = 6.0438e-04
Validation rmse = 0.109288
Validation r2 = 0.791377
Validation mse = 0.011944
Epoch 14
Loss = 1.4009e-01, PNorm = 44.2925, GNorm = 3.1710, lr_0 = 5.9064e-04
Loss = 1.3659e-01, PNorm = 44.3103, GNorm = 1.0255, lr_0 = 5.7843e-04
Validation rmse = 0.143053
Validation r2 = 0.642550
Validation mse = 0.020464
Epoch 15
Loss = 1.2038e-01, PNorm = 44.3255, GNorm = 2.6537, lr_0 = 5.6647e-04
Loss = 1.4138e-01, PNorm = 44.3419, GNorm = 2.5493, lr_0 = 5.5476e-04
Loss = 1.2510e-01, PNorm = 44.3443, GNorm = 0.7541, lr_0 = 5.5360e-04
Validation rmse = 0.102957
Validation r2 = 0.814845
Validation mse = 0.010600
Epoch 16
Loss = 1.2466e-01, PNorm = 44.3607, GNorm = 0.3604, lr_0 = 5.4215e-04
Loss = 1.0851e-01, PNorm = 44.3746, GNorm = 2.8581, lr_0 = 5.3094e-04
Validation rmse = 0.117793
Validation r2 = 0.757642
Validation mse = 0.013875
Epoch 17
Loss = 1.0104e-01, PNorm = 44.3888, GNorm = 0.5239, lr_0 = 5.1996e-04
Validation rmse = 0.130705
Validation r2 = 0.701594
Validation mse = 0.017084
Epoch 18
Loss = 9.7092e-02, PNorm = 44.4016, GNorm = 1.1490, lr_0 = 5.0815e-04
Loss = 1.1250e-01, PNorm = 44.4137, GNorm = 2.6528, lr_0 = 4.9764e-04
Validation rmse = 0.112788
Validation r2 = 0.777800
Validation mse = 0.012721
Epoch 19
Loss = 1.0246e-01, PNorm = 44.4252, GNorm = 3.6317, lr_0 = 4.8633e-04
Loss = 1.1077e-01, PNorm = 44.4383, GNorm = 1.9630, lr_0 = 4.7628e-04
Validation rmse = 0.105089
Validation r2 = 0.807099
Validation mse = 0.011044
Epoch 20
Loss = 1.1873e-01, PNorm = 44.4526, GNorm = 2.8954, lr_0 = 4.6643e-04
Loss = 1.1069e-01, PNorm = 44.4633, GNorm = 1.0184, lr_0 = 4.5678e-04
Validation rmse = 0.107464
Validation r2 = 0.798283
Validation mse = 0.011548
Epoch 21
Loss = 1.2097e-01, PNorm = 44.4781, GNorm = 3.0509, lr_0 = 4.4640e-04
Loss = 1.2082e-01, PNorm = 44.4956, GNorm = 4.0335, lr_0 = 4.3717e-04
Validation rmse = 0.166648
Validation r2 = 0.514912
Validation mse = 0.027772
Epoch 22
Loss = 1.3703e-01, PNorm = 44.5091, GNorm = 3.2010, lr_0 = 4.2813e-04
Loss = 1.2403e-01, PNorm = 44.5282, GNorm = 0.7190, lr_0 = 4.1928e-04
Validation rmse = 0.110823
Validation r2 = 0.785476
Validation mse = 0.012282
Epoch 23
Loss = 9.7897e-02, PNorm = 44.5439, GNorm = 0.6801, lr_0 = 4.0975e-04
Loss = 1.0329e-01, PNorm = 44.5576, GNorm = 1.8617, lr_0 = 4.0128e-04
Validation rmse = 0.107563
Validation r2 = 0.797911
Validation mse = 0.011570
Epoch 24
Loss = 1.3094e-01, PNorm = 44.5674, GNorm = 2.6491, lr_0 = 3.9298e-04
Loss = 8.9490e-02, PNorm = 44.5771, GNorm = 1.6417, lr_0 = 3.8486e-04
Validation rmse = 0.141674
Validation r2 = 0.649408
Validation mse = 0.020072
Epoch 25
Loss = 9.0468e-02, PNorm = 44.5890, GNorm = 0.7974, lr_0 = 3.7611e-04
Loss = 8.8014e-02, PNorm = 44.6009, GNorm = 0.8753, lr_0 = 3.6834e-04
Validation rmse = 0.129809
Validation r2 = 0.705676
Validation mse = 0.016850
Epoch 26
Loss = 9.5906e-02, PNorm = 44.6089, GNorm = 0.8996, lr_0 = 3.5997e-04
Loss = 8.9326e-02, PNorm = 44.6200, GNorm = 0.9444, lr_0 = 3.5252e-04
Validation rmse = 0.118363
Validation r2 = 0.755290
Validation mse = 0.014010
Epoch 27
Loss = 9.6859e-02, PNorm = 44.6287, GNorm = 2.0075, lr_0 = 3.4523e-04
Loss = 9.5851e-02, PNorm = 44.6372, GNorm = 1.2585, lr_0 = 3.3809e-04
Validation rmse = 0.124622
Validation r2 = 0.728726
Validation mse = 0.015531
Epoch 28
Loss = 8.1401e-02, PNorm = 44.6498, GNorm = 1.8348, lr_0 = 3.3041e-04
Loss = 9.1102e-02, PNorm = 44.6608, GNorm = 2.0243, lr_0 = 3.2358e-04
Validation rmse = 0.132444
Validation r2 = 0.693605
Validation mse = 0.017541
Epoch 29
Loss = 7.4902e-02, PNorm = 44.6687, GNorm = 1.3867, lr_0 = 3.1689e-04
Loss = 9.2686e-02, PNorm = 44.6788, GNorm = 0.7542, lr_0 = 3.1034e-04
Validation rmse = 0.140806
Validation r2 = 0.653693
Validation mse = 0.019826
Epoch 30
Loss = 8.4076e-02, PNorm = 44.6881, GNorm = 0.8581, lr_0 = 3.0329e-04
Loss = 7.7831e-02, PNorm = 44.6969, GNorm = 1.0849, lr_0 = 2.9701e-04
Validation rmse = 0.140293
Validation r2 = 0.656212
Validation mse = 0.019682
Epoch 31
Loss = 8.7786e-02, PNorm = 44.7052, GNorm = 1.0041, lr_0 = 2.9087e-04
Loss = 7.1484e-02, PNorm = 44.7148, GNorm = 0.8169, lr_0 = 2.8486e-04
Validation rmse = 0.136224
Validation r2 = 0.675866
Validation mse = 0.018557
Epoch 32
Loss = 7.3680e-02, PNorm = 44.7233, GNorm = 0.6973, lr_0 = 2.7839e-04
Loss = 9.2659e-02, PNorm = 44.7303, GNorm = 2.0577, lr_0 = 2.7263e-04
Loss = 3.3305e-02, PNorm = 44.7309, GNorm = 1.2537, lr_0 = 2.7206e-04
Validation rmse = 0.148991
Validation r2 = 0.612260
Validation mse = 0.022198
Epoch 33
Loss = 8.1942e-02, PNorm = 44.7385, GNorm = 1.0002, lr_0 = 2.6643e-04
Loss = 8.6530e-02, PNorm = 44.7473, GNorm = 0.8665, lr_0 = 2.6092e-04
Validation rmse = 0.135712
Validation r2 = 0.678294
Validation mse = 0.018418
Epoch 34
Loss = 8.3362e-02, PNorm = 44.7572, GNorm = 2.4761, lr_0 = 2.5553e-04
Validation rmse = 0.129444
Validation r2 = 0.707326
Validation mse = 0.016756
Epoch 35
Loss = 8.0489e-02, PNorm = 44.7650, GNorm = 1.7806, lr_0 = 2.4972e-04
Loss = 8.7692e-02, PNorm = 44.7730, GNorm = 1.3361, lr_0 = 2.4456e-04
Validation rmse = 0.121688
Validation r2 = 0.741348
Validation mse = 0.014808
Epoch 36
Loss = 1.1697e-01, PNorm = 44.7818, GNorm = 4.0014, lr_0 = 2.3950e-04
Loss = 7.3654e-02, PNorm = 44.7876, GNorm = 0.7031, lr_0 = 2.3455e-04
Validation rmse = 0.133145
Validation r2 = 0.690352
Validation mse = 0.017728
Epoch 37
Loss = 7.3553e-02, PNorm = 44.7964, GNorm = 1.1505, lr_0 = 2.2922e-04
Loss = 8.0716e-02, PNorm = 44.8041, GNorm = 0.5185, lr_0 = 2.2448e-04
Validation rmse = 0.122635
Validation r2 = 0.737307
Validation mse = 0.015039
Epoch 38
Loss = 9.0836e-02, PNorm = 44.8136, GNorm = 0.7838, lr_0 = 2.1938e-04
Loss = 6.9333e-02, PNorm = 44.8231, GNorm = 1.3299, lr_0 = 2.1484e-04
Validation rmse = 0.114127
Validation r2 = 0.772491
Validation mse = 0.013025
Epoch 39
Loss = 7.8168e-02, PNorm = 44.8303, GNorm = 1.7947, lr_0 = 2.1040e-04
Loss = 7.3803e-02, PNorm = 44.8373, GNorm = 0.6062, lr_0 = 2.0605e-04
Validation rmse = 0.116473
Validation r2 = 0.763043
Validation mse = 0.013566
Epoch 40
Loss = 6.6172e-02, PNorm = 44.8444, GNorm = 1.1809, lr_0 = 2.0137e-04
Loss = 7.5426e-02, PNorm = 44.8510, GNorm = 0.7298, lr_0 = 1.9721e-04
Validation rmse = 0.130490
Validation r2 = 0.702578
Validation mse = 0.017028
Epoch 41
Loss = 6.0925e-02, PNorm = 44.8579, GNorm = 0.4811, lr_0 = 1.9313e-04
Loss = 7.4738e-02, PNorm = 44.8653, GNorm = 2.2095, lr_0 = 1.8913e-04
Validation rmse = 0.143435
Validation r2 = 0.640642
Validation mse = 0.020573
Epoch 42
Loss = 7.5669e-02, PNorm = 44.8711, GNorm = 1.9837, lr_0 = 1.8484e-04
Loss = 6.2070e-02, PNorm = 44.8766, GNorm = 0.7840, lr_0 = 1.8101e-04
Validation rmse = 0.123721
Validation r2 = 0.732634
Validation mse = 0.015307
Epoch 43
Loss = 6.8459e-02, PNorm = 44.8830, GNorm = 0.7120, lr_0 = 1.7727e-04
Loss = 7.2551e-02, PNorm = 44.8897, GNorm = 1.5562, lr_0 = 1.7361e-04
Validation rmse = 0.134882
Validation r2 = 0.682218
Validation mse = 0.018193
Epoch 44
Loss = 5.6459e-02, PNorm = 44.8957, GNorm = 1.0282, lr_0 = 1.6966e-04
Loss = 6.7958e-02, PNorm = 44.9014, GNorm = 0.5292, lr_0 = 1.6615e-04
Validation rmse = 0.144491
Validation r2 = 0.635328
Validation mse = 0.020878
Epoch 45
Loss = 6.4341e-02, PNorm = 44.9069, GNorm = 0.8284, lr_0 = 1.6238e-04
Loss = 6.6356e-02, PNorm = 44.9128, GNorm = 1.8870, lr_0 = 1.5902e-04
Validation rmse = 0.132441
Validation r2 = 0.693616
Validation mse = 0.017541
Epoch 46
Loss = 6.1368e-02, PNorm = 44.9173, GNorm = 0.7974, lr_0 = 1.5573e-04
Loss = 7.0398e-02, PNorm = 44.9230, GNorm = 0.5642, lr_0 = 1.5251e-04
Validation rmse = 0.128038
Validation r2 = 0.713650
Validation mse = 0.016394
Epoch 47
Loss = 7.4760e-02, PNorm = 44.9296, GNorm = 1.3982, lr_0 = 1.4905e-04
Loss = 6.6109e-02, PNorm = 44.9365, GNorm = 0.8029, lr_0 = 1.4596e-04
Validation rmse = 0.144217
Validation r2 = 0.636713
Validation mse = 0.020798
Epoch 48
Loss = 5.7986e-02, PNorm = 44.9421, GNorm = 0.4525, lr_0 = 1.4295e-04
Loss = 6.3954e-02, PNorm = 44.9462, GNorm = 0.5434, lr_0 = 1.3999e-04
Validation rmse = 0.130926
Validation r2 = 0.700587
Validation mse = 0.017142
Epoch 49
Loss = 5.6233e-02, PNorm = 44.9510, GNorm = 0.7989, lr_0 = 1.3681e-04
Loss = 6.4852e-02, PNorm = 44.9559, GNorm = 0.7739, lr_0 = 1.3398e-04
Validation rmse = 0.135442
Validation r2 = 0.679573
Validation mse = 0.018345
Epoch 50
Loss = 6.3625e-02, PNorm = 44.9602, GNorm = 1.1973, lr_0 = 1.3121e-04
Loss = 5.8324e-02, PNorm = 44.9660, GNorm = 0.5635, lr_0 = 1.2850e-04
Loss = 8.9451e-02, PNorm = 44.9665, GNorm = 2.2812, lr_0 = 1.2823e-04
Validation rmse = 0.130627
Validation r2 = 0.701953
Validation mse = 0.017063
Epoch 51
Loss = 5.8928e-02, PNorm = 44.9711, GNorm = 0.8782, lr_0 = 1.2558e-04
Validation rmse = 0.124505
Validation r2 = 0.729235
Validation mse = 0.015501
Epoch 52
Loss = 7.1394e-02, PNorm = 44.9760, GNorm = 1.1073, lr_0 = 1.2272e-04
Loss = 6.8188e-02, PNorm = 44.9806, GNorm = 0.8258, lr_0 = 1.2019e-04
Validation rmse = 0.141139
Validation r2 = 0.652054
Validation mse = 0.019920
Epoch 53
Loss = 8.7946e-02, PNorm = 44.9850, GNorm = 1.2073, lr_0 = 1.1770e-04
Loss = 5.0604e-02, PNorm = 44.9889, GNorm = 0.7049, lr_0 = 1.1527e-04
Validation rmse = 0.123016
Validation r2 = 0.735674
Validation mse = 0.015133
Epoch 54
Loss = 4.4055e-02, PNorm = 44.9933, GNorm = 0.8926, lr_0 = 1.1265e-04
Loss = 5.3615e-02, PNorm = 44.9966, GNorm = 0.9628, lr_0 = 1.1032e-04
Validation rmse = 0.137169
Validation r2 = 0.671351
Validation mse = 0.018815
Epoch 55
Loss = 5.7329e-02, PNorm = 45.0011, GNorm = 1.4653, lr_0 = 1.0804e-04
Loss = 5.9492e-02, PNorm = 45.0041, GNorm = 2.3110, lr_0 = 1.0580e-04
Validation rmse = 0.115868
Validation r2 = 0.765499
Validation mse = 0.013425
Epoch 56
Loss = 5.6021e-02, PNorm = 45.0085, GNorm = 0.5252, lr_0 = 1.0340e-04
Loss = 5.6861e-02, PNorm = 45.0122, GNorm = 0.5797, lr_0 = 1.0126e-04
Validation rmse = 0.129150
Validation r2 = 0.708654
Validation mse = 0.016680
Epoch 57
Loss = 4.9969e-02, PNorm = 45.0159, GNorm = 0.5955, lr_0 = 1.0000e-04
Loss = 5.3627e-02, PNorm = 45.0198, GNorm = 0.6636, lr_0 = 1.0000e-04
Validation rmse = 0.125199
Validation r2 = 0.726210
Validation mse = 0.015675
Epoch 58
Loss = 5.2112e-02, PNorm = 45.0237, GNorm = 0.6050, lr_0 = 1.0000e-04
Loss = 5.5862e-02, PNorm = 45.0280, GNorm = 0.6682, lr_0 = 1.0000e-04
Validation rmse = 0.127381
Validation r2 = 0.716583
Validation mse = 0.016226
Epoch 59
Loss = 5.7598e-02, PNorm = 45.0315, GNorm = 1.3225, lr_0 = 1.0000e-04
Loss = 5.7495e-02, PNorm = 45.0350, GNorm = 0.7654, lr_0 = 1.0000e-04
Validation rmse = 0.118848
Validation r2 = 0.753280
Validation mse = 0.014125
Model 0 best validation rmse = 0.102957 on epoch 15
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.520973
Model 0 test r2 = -5.440907
Model 0 test mse = 0.271413
Ensemble test rmse = 0.520973
Ensemble test r2 = -5.440907
Ensemble test mse = 0.271413
Fold 5
Splitting data with seed 5
Total size = 981 | train size = 971 | val size = 10 | test size = 51
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.3549e-01, PNorm = 43.2618, GNorm = 6.6111, lr_0 = 3.6053e-04
Validation rmse = 0.400020
Validation r2 = -0.789809
Validation mse = 0.160016
Epoch 1
Loss = 7.6933e-01, PNorm = 43.2915, GNorm = 13.0724, lr_0 = 6.2105e-04
Loss = 5.5611e-01, PNorm = 43.3302, GNorm = 1.0681, lr_0 = 8.5789e-04
Validation rmse = 0.294518
Validation r2 = 0.029787
Validation mse = 0.086741
Epoch 2
Loss = 4.0948e-01, PNorm = 43.3986, GNorm = 7.5886, lr_0 = 9.8961e-04
Loss = 4.3672e-01, PNorm = 43.4562, GNorm = 4.3149, lr_0 = 9.6914e-04
Validation rmse = 0.287866
Validation r2 = 0.073116
Validation mse = 0.082867
Epoch 3
Loss = 5.7593e-01, PNorm = 43.5149, GNorm = 11.9583, lr_0 = 9.4910e-04
Loss = 4.3836e-01, PNorm = 43.5717, GNorm = 7.7787, lr_0 = 9.2948e-04
Validation rmse = 0.287586
Validation r2 = 0.074918
Validation mse = 0.082706
Epoch 4
Loss = 2.1504e-01, PNorm = 43.6395, GNorm = 3.4194, lr_0 = 9.0836e-04
Loss = 3.0854e-01, PNorm = 43.6855, GNorm = 4.2374, lr_0 = 8.8958e-04
Validation rmse = 0.220085
Validation r2 = 0.458217
Validation mse = 0.048438
Epoch 5
Loss = 2.2602e-01, PNorm = 43.7369, GNorm = 8.4801, lr_0 = 8.7118e-04
Loss = 2.2436e-01, PNorm = 43.7797, GNorm = 3.0587, lr_0 = 8.5317e-04
Validation rmse = 0.193513
Validation r2 = 0.581146
Validation mse = 0.037447
Epoch 6
Loss = 1.9872e-01, PNorm = 43.8163, GNorm = 4.3494, lr_0 = 8.3378e-04
Loss = 1.9038e-01, PNorm = 43.8446, GNorm = 3.6730, lr_0 = 8.1654e-04
Validation rmse = 0.179920
Validation r2 = 0.637921
Validation mse = 0.032371
Epoch 7
Loss = 2.1505e-01, PNorm = 43.8806, GNorm = 6.9524, lr_0 = 7.9799e-04
Loss = 2.1018e-01, PNorm = 43.9117, GNorm = 2.5621, lr_0 = 7.8149e-04
Validation rmse = 0.196088
Validation r2 = 0.569923
Validation mse = 0.038451
Epoch 8
Loss = 1.4965e-01, PNorm = 43.9384, GNorm = 2.1595, lr_0 = 7.6533e-04
Loss = 1.4422e-01, PNorm = 43.9601, GNorm = 6.4110, lr_0 = 7.4950e-04
Validation rmse = 0.152690
Validation r2 = 0.739227
Validation mse = 0.023314
Epoch 9
Loss = 1.6902e-01, PNorm = 43.9895, GNorm = 1.1864, lr_0 = 7.3247e-04
Loss = 1.3113e-01, PNorm = 44.0177, GNorm = 1.1698, lr_0 = 7.1733e-04
Validation rmse = 0.161750
Validation r2 = 0.707359
Validation mse = 0.026163
Epoch 10
Loss = 1.6484e-01, PNorm = 44.0420, GNorm = 6.2618, lr_0 = 7.0249e-04
Loss = 1.5115e-01, PNorm = 44.0680, GNorm = 1.2778, lr_0 = 6.8797e-04
Validation rmse = 0.120193
Validation r2 = 0.838416
Validation mse = 0.014446
Epoch 11
Loss = 1.3319e-01, PNorm = 44.0888, GNorm = 3.8122, lr_0 = 6.7234e-04
Loss = 1.6551e-01, PNorm = 44.1090, GNorm = 3.0200, lr_0 = 6.5843e-04
Validation rmse = 0.168549
Validation r2 = 0.682243
Validation mse = 0.028409
Epoch 12
Loss = 1.4103e-01, PNorm = 44.1393, GNorm = 1.5030, lr_0 = 6.4482e-04
Loss = 1.4510e-01, PNorm = 44.1576, GNorm = 2.4028, lr_0 = 6.3148e-04
Validation rmse = 0.153650
Validation r2 = 0.735938
Validation mse = 0.023608
Epoch 13
Loss = 1.3329e-01, PNorm = 44.1737, GNorm = 2.0565, lr_0 = 6.1714e-04
Loss = 1.1403e-01, PNorm = 44.1939, GNorm = 1.2344, lr_0 = 6.0438e-04
Validation rmse = 0.130357
Validation r2 = 0.809929
Validation mse = 0.016993
Epoch 14
Loss = 1.2577e-01, PNorm = 44.2108, GNorm = 0.7033, lr_0 = 5.9064e-04
Loss = 1.3104e-01, PNorm = 44.2256, GNorm = 0.9024, lr_0 = 5.7843e-04
Validation rmse = 0.131050
Validation r2 = 0.807905
Validation mse = 0.017174
Epoch 15
Loss = 1.1936e-01, PNorm = 44.2407, GNorm = 1.9785, lr_0 = 5.6647e-04
Loss = 1.2094e-01, PNorm = 44.2619, GNorm = 1.2451, lr_0 = 5.5476e-04
Loss = 9.8081e-02, PNorm = 44.2635, GNorm = 2.0307, lr_0 = 5.5360e-04
Validation rmse = 0.117344
Validation r2 = 0.845984
Validation mse = 0.013770
Epoch 16
Loss = 1.1280e-01, PNorm = 44.2763, GNorm = 2.0493, lr_0 = 5.4215e-04
Loss = 1.1860e-01, PNorm = 44.2912, GNorm = 2.8401, lr_0 = 5.3094e-04
Validation rmse = 0.115624
Validation r2 = 0.850466
Validation mse = 0.013369
Epoch 17
Loss = 1.1393e-01, PNorm = 44.3046, GNorm = 0.9633, lr_0 = 5.1996e-04
Validation rmse = 0.115511
Validation r2 = 0.850758
Validation mse = 0.013343
Epoch 18
Loss = 9.0935e-02, PNorm = 44.3213, GNorm = 0.6312, lr_0 = 5.0815e-04
Loss = 8.8690e-02, PNorm = 44.3376, GNorm = 0.5671, lr_0 = 4.9764e-04
Validation rmse = 0.112865
Validation r2 = 0.857516
Validation mse = 0.012739
Epoch 19
Loss = 9.6920e-02, PNorm = 44.3516, GNorm = 1.9010, lr_0 = 4.8633e-04
Loss = 1.1958e-01, PNorm = 44.3665, GNorm = 1.9714, lr_0 = 4.7628e-04
Validation rmse = 0.113125
Validation r2 = 0.856861
Validation mse = 0.012797
Epoch 20
Loss = 1.1304e-01, PNorm = 44.3806, GNorm = 1.7377, lr_0 = 4.6643e-04
Loss = 1.1097e-01, PNorm = 44.3947, GNorm = 1.8172, lr_0 = 4.5678e-04
Validation rmse = 0.125856
Validation r2 = 0.822831
Validation mse = 0.015840
Epoch 21
Loss = 8.8613e-02, PNorm = 44.4099, GNorm = 2.0669, lr_0 = 4.4640e-04
Loss = 1.1170e-01, PNorm = 44.4220, GNorm = 0.8528, lr_0 = 4.3717e-04
Validation rmse = 0.103726
Validation r2 = 0.879659
Validation mse = 0.010759
Epoch 22
Loss = 8.7563e-02, PNorm = 44.4340, GNorm = 1.1181, lr_0 = 4.2813e-04
Loss = 9.7054e-02, PNorm = 44.4460, GNorm = 2.2462, lr_0 = 4.1928e-04
Validation rmse = 0.115051
Validation r2 = 0.851944
Validation mse = 0.013237
Epoch 23
Loss = 8.5014e-02, PNorm = 44.4586, GNorm = 1.4811, lr_0 = 4.0975e-04
Loss = 1.1590e-01, PNorm = 44.4715, GNorm = 1.5008, lr_0 = 4.0128e-04
Validation rmse = 0.117440
Validation r2 = 0.845732
Validation mse = 0.013792
Epoch 24
Loss = 1.0379e-01, PNorm = 44.4858, GNorm = 0.7437, lr_0 = 3.9298e-04
Loss = 8.3501e-02, PNorm = 44.4987, GNorm = 3.2445, lr_0 = 3.8486e-04
Validation rmse = 0.137952
Validation r2 = 0.787136
Validation mse = 0.019031
Epoch 25
Loss = 1.2060e-01, PNorm = 44.5116, GNorm = 3.1880, lr_0 = 3.7611e-04
Loss = 1.1009e-01, PNorm = 44.5253, GNorm = 0.6179, lr_0 = 3.6834e-04
Validation rmse = 0.101521
Validation r2 = 0.884719
Validation mse = 0.010307
Epoch 26
Loss = 8.7631e-02, PNorm = 44.5406, GNorm = 0.7292, lr_0 = 3.5997e-04
Loss = 8.4292e-02, PNorm = 44.5527, GNorm = 0.5389, lr_0 = 3.5252e-04
Validation rmse = 0.091514
Validation r2 = 0.906327
Validation mse = 0.008375
Epoch 27
Loss = 8.5946e-02, PNorm = 44.5624, GNorm = 0.8384, lr_0 = 3.4523e-04
Loss = 8.8189e-02, PNorm = 44.5720, GNorm = 3.1414, lr_0 = 3.3809e-04
Validation rmse = 0.085327
Validation r2 = 0.918564
Validation mse = 0.007281
Epoch 28
Loss = 1.0061e-01, PNorm = 44.5834, GNorm = 2.0320, lr_0 = 3.3041e-04
Loss = 8.6035e-02, PNorm = 44.5944, GNorm = 2.4231, lr_0 = 3.2358e-04
Validation rmse = 0.089977
Validation r2 = 0.909445
Validation mse = 0.008096
Epoch 29
Loss = 8.4783e-02, PNorm = 44.6066, GNorm = 1.0988, lr_0 = 3.1689e-04
Loss = 8.8012e-02, PNorm = 44.6168, GNorm = 0.8428, lr_0 = 3.1034e-04
Validation rmse = 0.097590
Validation r2 = 0.893474
Validation mse = 0.009524
Epoch 30
Loss = 8.7470e-02, PNorm = 44.6293, GNorm = 1.1859, lr_0 = 3.0329e-04
Loss = 8.1749e-02, PNorm = 44.6398, GNorm = 0.8078, lr_0 = 2.9701e-04
Validation rmse = 0.086342
Validation r2 = 0.916615
Validation mse = 0.007455
Epoch 31
Loss = 8.4607e-02, PNorm = 44.6513, GNorm = 0.7547, lr_0 = 2.9087e-04
Loss = 8.3217e-02, PNorm = 44.6601, GNorm = 0.6412, lr_0 = 2.8486e-04
Validation rmse = 0.088749
Validation r2 = 0.911901
Validation mse = 0.007876
Epoch 32
Loss = 8.7335e-02, PNorm = 44.6720, GNorm = 2.7851, lr_0 = 2.7839e-04
Loss = 7.0980e-02, PNorm = 44.6806, GNorm = 1.4172, lr_0 = 2.7263e-04
Loss = 6.0272e-02, PNorm = 44.6812, GNorm = 2.1746, lr_0 = 2.7206e-04
Validation rmse = 0.081056
Validation r2 = 0.926512
Validation mse = 0.006570
Epoch 33
Loss = 8.1808e-02, PNorm = 44.6904, GNorm = 1.3886, lr_0 = 2.6643e-04
Loss = 7.3585e-02, PNorm = 44.6980, GNorm = 1.6285, lr_0 = 2.6092e-04
Validation rmse = 0.097919
Validation r2 = 0.892756
Validation mse = 0.009588
Epoch 34
Loss = 7.4003e-02, PNorm = 44.7068, GNorm = 1.0348, lr_0 = 2.5553e-04
Validation rmse = 0.076583
Validation r2 = 0.934400
Validation mse = 0.005865
Epoch 35
Loss = 6.6354e-02, PNorm = 44.7154, GNorm = 0.7224, lr_0 = 2.4972e-04
Loss = 7.7116e-02, PNorm = 44.7229, GNorm = 1.2202, lr_0 = 2.4456e-04
Validation rmse = 0.086489
Validation r2 = 0.916331
Validation mse = 0.007480
Epoch 36
Loss = 1.1257e-01, PNorm = 44.7315, GNorm = 4.2524, lr_0 = 2.3950e-04
Loss = 8.4135e-02, PNorm = 44.7416, GNorm = 1.3540, lr_0 = 2.3455e-04
Validation rmse = 0.080015
Validation r2 = 0.928388
Validation mse = 0.006402
Epoch 37
Loss = 9.3014e-02, PNorm = 44.7509, GNorm = 1.2062, lr_0 = 2.2922e-04
Loss = 7.1716e-02, PNorm = 44.7592, GNorm = 0.7642, lr_0 = 2.2448e-04
Validation rmse = 0.072713
Validation r2 = 0.940862
Validation mse = 0.005287
Epoch 38
Loss = 7.0464e-02, PNorm = 44.7687, GNorm = 0.8445, lr_0 = 2.1938e-04
Loss = 6.9856e-02, PNorm = 44.7757, GNorm = 1.6961, lr_0 = 2.1484e-04
Validation rmse = 0.080677
Validation r2 = 0.927197
Validation mse = 0.006509
Epoch 39
Loss = 5.7932e-02, PNorm = 44.7839, GNorm = 1.7173, lr_0 = 2.1040e-04
Loss = 7.1679e-02, PNorm = 44.7937, GNorm = 2.0642, lr_0 = 2.0605e-04
Validation rmse = 0.083326
Validation r2 = 0.922339
Validation mse = 0.006943
Epoch 40
Loss = 9.3914e-02, PNorm = 44.7988, GNorm = 1.1358, lr_0 = 2.0137e-04
Loss = 7.9244e-02, PNorm = 44.8059, GNorm = 0.7892, lr_0 = 1.9721e-04
Validation rmse = 0.086881
Validation r2 = 0.915571
Validation mse = 0.007548
Epoch 41
Loss = 7.8520e-02, PNorm = 44.8132, GNorm = 0.9766, lr_0 = 1.9313e-04
Loss = 7.3714e-02, PNorm = 44.8206, GNorm = 0.5555, lr_0 = 1.8913e-04
Validation rmse = 0.074094
Validation r2 = 0.938595
Validation mse = 0.005490
Epoch 42
Loss = 7.5934e-02, PNorm = 44.8283, GNorm = 1.1653, lr_0 = 1.8484e-04
Loss = 6.8224e-02, PNorm = 44.8339, GNorm = 0.4961, lr_0 = 1.8101e-04
Validation rmse = 0.066730
Validation r2 = 0.950193
Validation mse = 0.004453
Epoch 43
Loss = 6.6503e-02, PNorm = 44.8421, GNorm = 1.5907, lr_0 = 1.7727e-04
Loss = 6.3431e-02, PNorm = 44.8479, GNorm = 0.7077, lr_0 = 1.7361e-04
Validation rmse = 0.070637
Validation r2 = 0.944190
Validation mse = 0.004990
Epoch 44
Loss = 5.5943e-02, PNorm = 44.8535, GNorm = 0.4094, lr_0 = 1.6966e-04
Loss = 6.2381e-02, PNorm = 44.8599, GNorm = 0.4241, lr_0 = 1.6615e-04
Validation rmse = 0.068212
Validation r2 = 0.947956
Validation mse = 0.004653
Epoch 45
Loss = 5.9340e-02, PNorm = 44.8658, GNorm = 0.7076, lr_0 = 1.6238e-04
Loss = 6.5902e-02, PNorm = 44.8719, GNorm = 0.8113, lr_0 = 1.5902e-04
Validation rmse = 0.070832
Validation r2 = 0.943882
Validation mse = 0.005017
Epoch 46
Loss = 6.1926e-02, PNorm = 44.8772, GNorm = 1.3226, lr_0 = 1.5573e-04
Loss = 6.0284e-02, PNorm = 44.8819, GNorm = 0.9234, lr_0 = 1.5251e-04
Validation rmse = 0.073401
Validation r2 = 0.939737
Validation mse = 0.005388
Epoch 47
Loss = 6.2779e-02, PNorm = 44.8883, GNorm = 1.0447, lr_0 = 1.4905e-04
Loss = 5.7690e-02, PNorm = 44.8932, GNorm = 0.7792, lr_0 = 1.4596e-04
Validation rmse = 0.065957
Validation r2 = 0.951341
Validation mse = 0.004350
Epoch 48
Loss = 5.9736e-02, PNorm = 44.8986, GNorm = 1.5921, lr_0 = 1.4295e-04
Loss = 5.9678e-02, PNorm = 44.9034, GNorm = 1.1744, lr_0 = 1.3999e-04
Validation rmse = 0.067532
Validation r2 = 0.948989
Validation mse = 0.004561
Epoch 49
Loss = 6.6650e-02, PNorm = 44.9097, GNorm = 0.7911, lr_0 = 1.3681e-04
Loss = 5.4424e-02, PNorm = 44.9144, GNorm = 0.9048, lr_0 = 1.3398e-04
Validation rmse = 0.075141
Validation r2 = 0.936846
Validation mse = 0.005646
Epoch 50
Loss = 5.8471e-02, PNorm = 44.9189, GNorm = 0.7087, lr_0 = 1.3121e-04
Loss = 5.5936e-02, PNorm = 44.9233, GNorm = 0.6662, lr_0 = 1.2850e-04
Loss = 6.2058e-02, PNorm = 44.9238, GNorm = 1.6038, lr_0 = 1.2823e-04
Validation rmse = 0.067148
Validation r2 = 0.949568
Validation mse = 0.004509
Epoch 51
Loss = 5.2396e-02, PNorm = 44.9286, GNorm = 0.6589, lr_0 = 1.2558e-04
Validation rmse = 0.073098
Validation r2 = 0.940234
Validation mse = 0.005343
Epoch 52
Loss = 6.3959e-02, PNorm = 44.9331, GNorm = 0.6919, lr_0 = 1.2272e-04
Loss = 5.9865e-02, PNorm = 44.9375, GNorm = 0.6304, lr_0 = 1.2019e-04
Validation rmse = 0.066072
Validation r2 = 0.951172
Validation mse = 0.004365
Epoch 53
Loss = 5.8270e-02, PNorm = 44.9413, GNorm = 0.9702, lr_0 = 1.1770e-04
Loss = 5.6746e-02, PNorm = 44.9461, GNorm = 1.7451, lr_0 = 1.1527e-04
Validation rmse = 0.076453
Validation r2 = 0.934621
Validation mse = 0.005845
Epoch 54
Loss = 5.0930e-02, PNorm = 44.9497, GNorm = 1.7574, lr_0 = 1.1265e-04
Loss = 5.6095e-02, PNorm = 44.9534, GNorm = 1.8638, lr_0 = 1.1032e-04
Validation rmse = 0.065136
Validation r2 = 0.952545
Validation mse = 0.004243
Epoch 55
Loss = 5.5214e-02, PNorm = 44.9573, GNorm = 1.7922, lr_0 = 1.0804e-04
Loss = 6.2705e-02, PNorm = 44.9617, GNorm = 1.6238, lr_0 = 1.0580e-04
Validation rmse = 0.081035
Validation r2 = 0.926550
Validation mse = 0.006567
Epoch 56
Loss = 5.6417e-02, PNorm = 44.9663, GNorm = 0.9209, lr_0 = 1.0340e-04
Loss = 6.9546e-02, PNorm = 44.9695, GNorm = 4.5240, lr_0 = 1.0126e-04
Validation rmse = 0.071043
Validation r2 = 0.943548
Validation mse = 0.005047
Epoch 57
Loss = 6.5900e-02, PNorm = 44.9743, GNorm = 3.4432, lr_0 = 1.0000e-04
Loss = 5.9068e-02, PNorm = 44.9777, GNorm = 1.2073, lr_0 = 1.0000e-04
Validation rmse = 0.063197
Validation r2 = 0.955328
Validation mse = 0.003994
Epoch 58
Loss = 6.6043e-02, PNorm = 44.9811, GNorm = 0.8439, lr_0 = 1.0000e-04
Loss = 5.2626e-02, PNorm = 44.9850, GNorm = 1.1768, lr_0 = 1.0000e-04
Validation rmse = 0.064802
Validation r2 = 0.953030
Validation mse = 0.004199
Epoch 59
Loss = 5.5292e-02, PNorm = 44.9880, GNorm = 0.8032, lr_0 = 1.0000e-04
Loss = 5.0140e-02, PNorm = 44.9911, GNorm = 0.9482, lr_0 = 1.0000e-04
Validation rmse = 0.072730
Validation r2 = 0.940835
Validation mse = 0.005290
Model 0 best validation rmse = 0.063197 on epoch 57
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.499901
Model 0 test r2 = -4.930408
Model 0 test mse = 0.249901
Ensemble test rmse = 0.499901
Ensemble test r2 = -4.930408
Ensemble test mse = 0.249901
Fold 6
Splitting data with seed 6
Total size = 981 | train size = 971 | val size = 10 | test size = 51
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.5082e-01, PNorm = 43.2658, GNorm = 4.1504, lr_0 = 3.6053e-04
Validation rmse = 0.319284
Validation r2 = 0.175758
Validation mse = 0.101942
Epoch 1
Loss = 6.9600e-01, PNorm = 43.2906, GNorm = 11.3534, lr_0 = 6.2105e-04
Loss = 6.1682e-01, PNorm = 43.3255, GNorm = 1.0283, lr_0 = 8.5789e-04
Validation rmse = 0.196401
Validation r2 = 0.688119
Validation mse = 0.038573
Epoch 2
Loss = 4.6953e-01, PNorm = 43.3941, GNorm = 7.7837, lr_0 = 9.8961e-04
Loss = 4.3871e-01, PNorm = 43.4552, GNorm = 6.0449, lr_0 = 9.6914e-04
Validation rmse = 0.129358
Validation r2 = 0.864703
Validation mse = 0.016733
Epoch 3
Loss = 2.6907e-01, PNorm = 43.5303, GNorm = 1.4554, lr_0 = 9.4910e-04
Loss = 4.2697e-01, PNorm = 43.5964, GNorm = 3.1280, lr_0 = 9.2948e-04
Validation rmse = 0.123488
Validation r2 = 0.876703
Validation mse = 0.015249
Epoch 4
Loss = 2.4452e-01, PNorm = 43.6542, GNorm = 3.7151, lr_0 = 9.0836e-04
Loss = 3.1491e-01, PNorm = 43.7083, GNorm = 6.5531, lr_0 = 8.8958e-04
Validation rmse = 0.144559
Validation r2 = 0.831036
Validation mse = 0.020897
Epoch 5
Loss = 3.1748e-01, PNorm = 43.7539, GNorm = 2.6860, lr_0 = 8.7118e-04
Loss = 2.5294e-01, PNorm = 43.7997, GNorm = 0.6502, lr_0 = 8.5317e-04
Validation rmse = 0.081366
Validation r2 = 0.946472
Validation mse = 0.006620
Epoch 6
Loss = 1.9947e-01, PNorm = 43.8448, GNorm = 0.5830, lr_0 = 8.3378e-04
Loss = 1.9735e-01, PNorm = 43.8820, GNorm = 4.5936, lr_0 = 8.1654e-04
Validation rmse = 0.071478
Validation r2 = 0.958691
Validation mse = 0.005109
Epoch 7
Loss = 1.7943e-01, PNorm = 43.9191, GNorm = 3.4467, lr_0 = 7.9799e-04
Loss = 1.5857e-01, PNorm = 43.9389, GNorm = 2.0418, lr_0 = 7.8149e-04
Validation rmse = 0.184747
Validation r2 = 0.724034
Validation mse = 0.034131
Epoch 8
Loss = 2.3548e-01, PNorm = 43.9720, GNorm = 7.9508, lr_0 = 7.6533e-04
Loss = 1.7088e-01, PNorm = 44.0030, GNorm = 4.7633, lr_0 = 7.4950e-04
Validation rmse = 0.151331
Validation r2 = 0.814836
Validation mse = 0.022901
Epoch 9
Loss = 1.5602e-01, PNorm = 44.0350, GNorm = 2.4227, lr_0 = 7.3247e-04
Loss = 1.4803e-01, PNorm = 44.0634, GNorm = 0.7555, lr_0 = 7.1733e-04
Validation rmse = 0.135229
Validation r2 = 0.852142
Validation mse = 0.018287
Epoch 10
Loss = 1.6109e-01, PNorm = 44.0879, GNorm = 1.9709, lr_0 = 7.0249e-04
Loss = 1.5721e-01, PNorm = 44.1131, GNorm = 2.2192, lr_0 = 6.8797e-04
Validation rmse = 0.086460
Validation r2 = 0.939559
Validation mse = 0.007475
Epoch 11
Loss = 1.1962e-01, PNorm = 44.1346, GNorm = 1.7721, lr_0 = 6.7234e-04
Loss = 1.2809e-01, PNorm = 44.1533, GNorm = 1.3311, lr_0 = 6.5843e-04
Validation rmse = 0.066236
Validation r2 = 0.964528
Validation mse = 0.004387
Epoch 12
Loss = 1.2377e-01, PNorm = 44.1755, GNorm = 0.8632, lr_0 = 6.4482e-04
Loss = 1.2270e-01, PNorm = 44.1930, GNorm = 0.6495, lr_0 = 6.3148e-04
Validation rmse = 0.045038
Validation r2 = 0.983599
Validation mse = 0.002028
Epoch 13
Loss = 1.0574e-01, PNorm = 44.2141, GNorm = 0.7410, lr_0 = 6.1714e-04
Loss = 1.3206e-01, PNorm = 44.2319, GNorm = 4.5127, lr_0 = 6.0438e-04
Validation rmse = 0.052987
Validation r2 = 0.977299
Validation mse = 0.002808
Epoch 14
Loss = 1.7704e-01, PNorm = 44.2536, GNorm = 4.8497, lr_0 = 5.9064e-04
Loss = 1.1739e-01, PNorm = 44.2777, GNorm = 2.9062, lr_0 = 5.7843e-04
Validation rmse = 0.105514
Validation r2 = 0.909984
Validation mse = 0.011133
Epoch 15
Loss = 1.1246e-01, PNorm = 44.2991, GNorm = 1.0911, lr_0 = 5.6647e-04
Loss = 1.3448e-01, PNorm = 44.3178, GNorm = 4.8524, lr_0 = 5.5476e-04
Loss = 8.9959e-02, PNorm = 44.3192, GNorm = 3.5492, lr_0 = 5.5360e-04
Validation rmse = 0.135848
Validation r2 = 0.850788
Validation mse = 0.018455
Epoch 16
Loss = 1.3689e-01, PNorm = 44.3383, GNorm = 3.2888, lr_0 = 5.4215e-04
Loss = 1.1024e-01, PNorm = 44.3556, GNorm = 1.1610, lr_0 = 5.3094e-04
Validation rmse = 0.070590
Validation r2 = 0.959710
Validation mse = 0.004983
Epoch 17
Loss = 1.1107e-01, PNorm = 44.3702, GNorm = 1.9732, lr_0 = 5.1996e-04
Validation rmse = 0.082436
Validation r2 = 0.945054
Validation mse = 0.006796
Epoch 18
Loss = 9.1217e-02, PNorm = 44.3877, GNorm = 0.8941, lr_0 = 5.0815e-04
Loss = 1.0550e-01, PNorm = 44.4044, GNorm = 1.3994, lr_0 = 4.9764e-04
Validation rmse = 0.100715
Validation r2 = 0.917985
Validation mse = 0.010144
Epoch 19
Loss = 6.5700e-02, PNorm = 44.4207, GNorm = 0.9790, lr_0 = 4.8633e-04
Loss = 1.2160e-01, PNorm = 44.4343, GNorm = 2.8312, lr_0 = 4.7628e-04
Validation rmse = 0.035149
Validation r2 = 0.990011
Validation mse = 0.001235
Epoch 20
Loss = 1.5564e-01, PNorm = 44.4501, GNorm = 3.5469, lr_0 = 4.6643e-04
Loss = 1.0316e-01, PNorm = 44.4656, GNorm = 2.1872, lr_0 = 4.5678e-04
Validation rmse = 0.118730
Validation r2 = 0.886022
Validation mse = 0.014097
Epoch 21
Loss = 9.7104e-02, PNorm = 44.4797, GNorm = 1.2700, lr_0 = 4.4640e-04
Loss = 9.9962e-02, PNorm = 44.4939, GNorm = 2.4761, lr_0 = 4.3717e-04
Validation rmse = 0.080313
Validation r2 = 0.947847
Validation mse = 0.006450
Epoch 22
Loss = 8.3477e-02, PNorm = 44.5063, GNorm = 1.4358, lr_0 = 4.2813e-04
Loss = 9.0729e-02, PNorm = 44.5184, GNorm = 1.1890, lr_0 = 4.1928e-04
Validation rmse = 0.112416
Validation r2 = 0.897822
Validation mse = 0.012637
Epoch 23
Loss = 7.8794e-02, PNorm = 44.5337, GNorm = 3.5407, lr_0 = 4.0975e-04
Loss = 1.0089e-01, PNorm = 44.5470, GNorm = 2.2256, lr_0 = 4.0128e-04
Validation rmse = 0.046876
Validation r2 = 0.982234
Validation mse = 0.002197
Epoch 24
Loss = 9.7235e-02, PNorm = 44.5600, GNorm = 3.9525, lr_0 = 3.9298e-04
Loss = 9.0407e-02, PNorm = 44.5728, GNorm = 0.3710, lr_0 = 3.8486e-04
Validation rmse = 0.094351
Validation r2 = 0.928022
Validation mse = 0.008902
Epoch 25
Loss = 9.6243e-02, PNorm = 44.5863, GNorm = 0.6226, lr_0 = 3.7611e-04
Loss = 9.0804e-02, PNorm = 44.5984, GNorm = 1.3273, lr_0 = 3.6834e-04
Validation rmse = 0.097651
Validation r2 = 0.922900
Validation mse = 0.009536
Epoch 26
Loss = 8.5486e-02, PNorm = 44.6102, GNorm = 3.1865, lr_0 = 3.5997e-04
Loss = 1.1209e-01, PNorm = 44.6230, GNorm = 3.8174, lr_0 = 3.5252e-04
Validation rmse = 0.052920
Validation r2 = 0.977356
Validation mse = 0.002801
Epoch 27
Loss = 9.8695e-02, PNorm = 44.6363, GNorm = 0.8811, lr_0 = 3.4523e-04
Loss = 9.4545e-02, PNorm = 44.6468, GNorm = 1.2405, lr_0 = 3.3809e-04
Validation rmse = 0.083453
Validation r2 = 0.943691
Validation mse = 0.006964
Epoch 28
Loss = 9.5956e-02, PNorm = 44.6604, GNorm = 3.0306, lr_0 = 3.3041e-04
Loss = 8.5104e-02, PNorm = 44.6723, GNorm = 2.2094, lr_0 = 3.2358e-04
Validation rmse = 0.116023
Validation r2 = 0.891160
Validation mse = 0.013461
Epoch 29
Loss = 1.0032e-01, PNorm = 44.6829, GNorm = 1.5495, lr_0 = 3.1689e-04
Loss = 8.3847e-02, PNorm = 44.6951, GNorm = 1.3025, lr_0 = 3.1034e-04
Validation rmse = 0.074004
Validation r2 = 0.955720
Validation mse = 0.005477
Epoch 30
Loss = 7.3649e-02, PNorm = 44.7083, GNorm = 0.5023, lr_0 = 3.0329e-04
Loss = 8.0272e-02, PNorm = 44.7197, GNorm = 0.8982, lr_0 = 2.9701e-04
Validation rmse = 0.089286
Validation r2 = 0.935543
Validation mse = 0.007972
Epoch 31
Loss = 7.9764e-02, PNorm = 44.7285, GNorm = 1.4725, lr_0 = 2.9087e-04
Loss = 7.9654e-02, PNorm = 44.7361, GNorm = 2.3794, lr_0 = 2.8486e-04
Validation rmse = 0.088171
Validation r2 = 0.937143
Validation mse = 0.007774
Epoch 32
Loss = 6.9777e-02, PNorm = 44.7476, GNorm = 1.2650, lr_0 = 2.7839e-04
Loss = 8.3484e-02, PNorm = 44.7571, GNorm = 0.7508, lr_0 = 2.7263e-04
Loss = 8.4151e-02, PNorm = 44.7581, GNorm = 1.1938, lr_0 = 2.7206e-04
Validation rmse = 0.066931
Validation r2 = 0.963779
Validation mse = 0.004480
Epoch 33
Loss = 7.0651e-02, PNorm = 44.7662, GNorm = 1.6497, lr_0 = 2.6643e-04
Loss = 8.2527e-02, PNorm = 44.7754, GNorm = 3.5018, lr_0 = 2.6092e-04
Validation rmse = 0.084434
Validation r2 = 0.942358
Validation mse = 0.007129
Epoch 34
Loss = 7.6822e-02, PNorm = 44.7868, GNorm = 1.6720, lr_0 = 2.5553e-04
Validation rmse = 0.110400
Validation r2 = 0.901454
Validation mse = 0.012188
Epoch 35
Loss = 1.1788e-01, PNorm = 44.7968, GNorm = 2.5924, lr_0 = 2.4972e-04
Loss = 7.1328e-02, PNorm = 44.8038, GNorm = 0.8950, lr_0 = 2.4456e-04
Validation rmse = 0.085470
Validation r2 = 0.940936
Validation mse = 0.007305
Epoch 36
Loss = 9.0192e-02, PNorm = 44.8130, GNorm = 0.7062, lr_0 = 2.3950e-04
Loss = 7.0305e-02, PNorm = 44.8230, GNorm = 1.2917, lr_0 = 2.3455e-04
Validation rmse = 0.076518
Validation r2 = 0.952660
Validation mse = 0.005855
Epoch 37
Loss = 5.7468e-02, PNorm = 44.8322, GNorm = 0.9505, lr_0 = 2.2922e-04
Loss = 7.3270e-02, PNorm = 44.8405, GNorm = 0.5076, lr_0 = 2.2448e-04
Validation rmse = 0.109170
Validation r2 = 0.903637
Validation mse = 0.011918
Epoch 38
Loss = 6.3225e-02, PNorm = 44.8498, GNorm = 2.2913, lr_0 = 2.1938e-04
Loss = 7.8169e-02, PNorm = 44.8587, GNorm = 0.9139, lr_0 = 2.1484e-04
Validation rmse = 0.106657
Validation r2 = 0.908023
Validation mse = 0.011376
Epoch 39
Loss = 6.5953e-02, PNorm = 44.8676, GNorm = 0.7427, lr_0 = 2.1040e-04
Loss = 6.9920e-02, PNorm = 44.8751, GNorm = 0.4497, lr_0 = 2.0605e-04
Validation rmse = 0.108230
Validation r2 = 0.905291
Validation mse = 0.011714
Epoch 40
Loss = 6.9869e-02, PNorm = 44.8844, GNorm = 2.8023, lr_0 = 2.0137e-04
Loss = 6.4456e-02, PNorm = 44.8922, GNorm = 0.6900, lr_0 = 1.9721e-04
Validation rmse = 0.110739
Validation r2 = 0.900847
Validation mse = 0.012263
Epoch 41
Loss = 8.0249e-02, PNorm = 44.9006, GNorm = 0.6354, lr_0 = 1.9313e-04
Loss = 6.6777e-02, PNorm = 44.9082, GNorm = 0.7474, lr_0 = 1.8913e-04
Validation rmse = 0.105980
Validation r2 = 0.909186
Validation mse = 0.011232
Epoch 42
Loss = 5.5666e-02, PNorm = 44.9167, GNorm = 1.0950, lr_0 = 1.8484e-04
Loss = 6.3171e-02, PNorm = 44.9230, GNorm = 1.0392, lr_0 = 1.8101e-04
Validation rmse = 0.100061
Validation r2 = 0.919047
Validation mse = 0.010012
Epoch 43
Loss = 6.5429e-02, PNorm = 44.9303, GNorm = 0.6728, lr_0 = 1.7727e-04
Loss = 5.7639e-02, PNorm = 44.9369, GNorm = 0.6254, lr_0 = 1.7361e-04
Validation rmse = 0.108122
Validation r2 = 0.905478
Validation mse = 0.011690
Epoch 44
Loss = 6.2148e-02, PNorm = 44.9439, GNorm = 1.5659, lr_0 = 1.6966e-04
Loss = 5.8959e-02, PNorm = 44.9506, GNorm = 0.6336, lr_0 = 1.6615e-04
Validation rmse = 0.111447
Validation r2 = 0.899577
Validation mse = 0.012420
Epoch 45
Loss = 6.6806e-02, PNorm = 44.9581, GNorm = 0.5713, lr_0 = 1.6238e-04
Loss = 5.8952e-02, PNorm = 44.9641, GNorm = 2.0497, lr_0 = 1.5902e-04
Validation rmse = 0.092964
Validation r2 = 0.930124
Validation mse = 0.008642
Epoch 46
Loss = 6.3879e-02, PNorm = 44.9704, GNorm = 1.1795, lr_0 = 1.5573e-04
Loss = 5.7333e-02, PNorm = 44.9758, GNorm = 0.7714, lr_0 = 1.5251e-04
Validation rmse = 0.092500
Validation r2 = 0.930819
Validation mse = 0.008556
Epoch 47
Loss = 5.9378e-02, PNorm = 44.9828, GNorm = 1.9998, lr_0 = 1.4905e-04
Loss = 5.5073e-02, PNorm = 44.9883, GNorm = 0.6954, lr_0 = 1.4596e-04
Validation rmse = 0.097397
Validation r2 = 0.923300
Validation mse = 0.009486
Epoch 48
Loss = 4.8442e-02, PNorm = 44.9950, GNorm = 0.6533, lr_0 = 1.4295e-04
Loss = 6.4562e-02, PNorm = 45.0003, GNorm = 2.8322, lr_0 = 1.3999e-04
Validation rmse = 0.065221
Validation r2 = 0.965606
Validation mse = 0.004254
Epoch 49
Loss = 8.7430e-02, PNorm = 45.0069, GNorm = 2.0647, lr_0 = 1.3681e-04
Loss = 5.6894e-02, PNorm = 45.0131, GNorm = 0.8454, lr_0 = 1.3398e-04
Validation rmse = 0.096884
Validation r2 = 0.924106
Validation mse = 0.009387
Epoch 50
Loss = 5.7262e-02, PNorm = 45.0187, GNorm = 0.7643, lr_0 = 1.3121e-04
Loss = 5.1789e-02, PNorm = 45.0235, GNorm = 0.8555, lr_0 = 1.2850e-04
Loss = 6.0064e-02, PNorm = 45.0240, GNorm = 1.6675, lr_0 = 1.2823e-04
Validation rmse = 0.076281
Validation r2 = 0.952953
Validation mse = 0.005819
Epoch 51
Loss = 4.9842e-02, PNorm = 45.0287, GNorm = 0.6021, lr_0 = 1.2558e-04
Validation rmse = 0.082221
Validation r2 = 0.945340
Validation mse = 0.006760
Epoch 52
Loss = 4.0305e-02, PNorm = 45.0338, GNorm = 0.8791, lr_0 = 1.2272e-04
Loss = 4.8333e-02, PNorm = 45.0377, GNorm = 1.1709, lr_0 = 1.2019e-04
Validation rmse = 0.105943
Validation r2 = 0.909250
Validation mse = 0.011224
Epoch 53
Loss = 4.9597e-02, PNorm = 45.0418, GNorm = 0.6051, lr_0 = 1.1770e-04
Loss = 5.3681e-02, PNorm = 45.0467, GNorm = 0.6067, lr_0 = 1.1527e-04
Validation rmse = 0.088261
Validation r2 = 0.937015
Validation mse = 0.007790
Epoch 54
Loss = 3.5374e-02, PNorm = 45.0521, GNorm = 0.4972, lr_0 = 1.1265e-04
Loss = 5.6041e-02, PNorm = 45.0574, GNorm = 0.6443, lr_0 = 1.1032e-04
Validation rmse = 0.078157
Validation r2 = 0.950611
Validation mse = 0.006108
Epoch 55
Loss = 4.7876e-02, PNorm = 45.0616, GNorm = 0.8346, lr_0 = 1.0804e-04
Loss = 5.1256e-02, PNorm = 45.0655, GNorm = 0.7330, lr_0 = 1.0580e-04
Validation rmse = 0.095083
Validation r2 = 0.926902
Validation mse = 0.009041
Epoch 56
Loss = 4.5129e-02, PNorm = 45.0698, GNorm = 0.7937, lr_0 = 1.0340e-04
Loss = 5.1767e-02, PNorm = 45.0742, GNorm = 0.5706, lr_0 = 1.0126e-04
Validation rmse = 0.087536
Validation r2 = 0.938046
Validation mse = 0.007662
Epoch 57
Loss = 5.5636e-02, PNorm = 45.0782, GNorm = 0.4874, lr_0 = 1.0000e-04
Loss = 4.8919e-02, PNorm = 45.0818, GNorm = 0.5734, lr_0 = 1.0000e-04
Validation rmse = 0.095360
Validation r2 = 0.926475
Validation mse = 0.009094
Epoch 58
Loss = 4.7345e-02, PNorm = 45.0854, GNorm = 0.5712, lr_0 = 1.0000e-04
Loss = 5.1354e-02, PNorm = 45.0887, GNorm = 1.3729, lr_0 = 1.0000e-04
Validation rmse = 0.084991
Validation r2 = 0.941596
Validation mse = 0.007223
Epoch 59
Loss = 5.2839e-02, PNorm = 45.0931, GNorm = 1.0693, lr_0 = 1.0000e-04
Loss = 4.8509e-02, PNorm = 45.0973, GNorm = 0.8157, lr_0 = 1.0000e-04
Validation rmse = 0.096572
Validation r2 = 0.924595
Validation mse = 0.009326
Model 0 best validation rmse = 0.035149 on epoch 19
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.548968
Model 0 test r2 = -6.151715
Model 0 test mse = 0.301366
Ensemble test rmse = 0.548968
Ensemble test r2 = -6.151715
Ensemble test mse = 0.301366
Fold 7
Splitting data with seed 7
Total size = 981 | train size = 971 | val size = 10 | test size = 51
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.7159e-01, PNorm = 43.2636, GNorm = 4.5399, lr_0 = 3.6053e-04
Validation rmse = 0.230565
Validation r2 = 0.029906
Validation mse = 0.053160
Epoch 1
Loss = 6.3602e-01, PNorm = 43.2888, GNorm = 2.4583, lr_0 = 6.2105e-04
Loss = 5.1002e-01, PNorm = 43.3321, GNorm = 3.5815, lr_0 = 8.5789e-04
Validation rmse = 0.229766
Validation r2 = 0.036615
Validation mse = 0.052792
Epoch 2
Loss = 8.9645e-01, PNorm = 43.3993, GNorm = 3.8358, lr_0 = 9.8961e-04
Loss = 7.0103e-01, PNorm = 43.4593, GNorm = 2.9637, lr_0 = 9.6914e-04
Validation rmse = 0.295778
Validation r2 = -0.596468
Validation mse = 0.087485
Epoch 3
Loss = 6.0859e-01, PNorm = 43.5315, GNorm = 1.0752, lr_0 = 9.4910e-04
Loss = 4.4871e-01, PNorm = 43.5852, GNorm = 7.3145, lr_0 = 9.2948e-04
Validation rmse = 0.154533
Validation r2 = 0.564218
Validation mse = 0.023880
Epoch 4
Loss = 3.1480e-01, PNorm = 43.6500, GNorm = 3.9880, lr_0 = 9.0836e-04
Loss = 2.9039e-01, PNorm = 43.7033, GNorm = 3.6858, lr_0 = 8.8958e-04
Validation rmse = 0.199433
Validation r2 = 0.274190
Validation mse = 0.039774
Epoch 5
Loss = 2.7619e-01, PNorm = 43.7446, GNorm = 4.9376, lr_0 = 8.7118e-04
Loss = 2.5480e-01, PNorm = 43.7871, GNorm = 1.9438, lr_0 = 8.5317e-04
Validation rmse = 0.188318
Validation r2 = 0.352838
Validation mse = 0.035464
Epoch 6
Loss = 2.3322e-01, PNorm = 43.8333, GNorm = 1.4090, lr_0 = 8.3378e-04
Loss = 1.8875e-01, PNorm = 43.8750, GNorm = 1.9221, lr_0 = 8.1654e-04
Validation rmse = 0.202966
Validation r2 = 0.248245
Validation mse = 0.041195
Epoch 7
Loss = 2.0643e-01, PNorm = 43.9110, GNorm = 2.8650, lr_0 = 7.9799e-04
Loss = 1.9043e-01, PNorm = 43.9410, GNorm = 2.8173, lr_0 = 7.8149e-04
Validation rmse = 0.138284
Validation r2 = 0.651043
Validation mse = 0.019122
Epoch 8
Loss = 2.0366e-01, PNorm = 43.9745, GNorm = 6.1550, lr_0 = 7.6533e-04
Loss = 1.9712e-01, PNorm = 44.0143, GNorm = 3.2663, lr_0 = 7.4950e-04
Validation rmse = 0.129448
Validation r2 = 0.694212
Validation mse = 0.016757
Epoch 9
Loss = 1.7124e-01, PNorm = 44.0431, GNorm = 4.1262, lr_0 = 7.3247e-04
Loss = 1.6281e-01, PNorm = 44.0753, GNorm = 1.9699, lr_0 = 7.1733e-04
Validation rmse = 0.127495
Validation r2 = 0.703370
Validation mse = 0.016255
Epoch 10
Loss = 1.5135e-01, PNorm = 44.1047, GNorm = 2.2161, lr_0 = 7.0249e-04
Loss = 1.2748e-01, PNorm = 44.1297, GNorm = 2.4228, lr_0 = 6.8797e-04
Validation rmse = 0.168113
Validation r2 = 0.484259
Validation mse = 0.028262
Epoch 11
Loss = 1.3928e-01, PNorm = 44.1503, GNorm = 5.1165, lr_0 = 6.7234e-04
Loss = 1.5454e-01, PNorm = 44.1736, GNorm = 1.1358, lr_0 = 6.5843e-04
Validation rmse = 0.108575
Validation r2 = 0.784876
Validation mse = 0.011789
Epoch 12
Loss = 1.3318e-01, PNorm = 44.1977, GNorm = 0.5942, lr_0 = 6.4482e-04
Loss = 1.3793e-01, PNorm = 44.2208, GNorm = 4.1623, lr_0 = 6.3148e-04
Validation rmse = 0.126960
Validation r2 = 0.705856
Validation mse = 0.016119
Epoch 13
Loss = 1.2318e-01, PNorm = 44.2396, GNorm = 1.8233, lr_0 = 6.1714e-04
Loss = 1.2584e-01, PNorm = 44.2600, GNorm = 1.0913, lr_0 = 6.0438e-04
Validation rmse = 0.121787
Validation r2 = 0.729335
Validation mse = 0.014832
Epoch 14
Loss = 1.1927e-01, PNorm = 44.2834, GNorm = 0.7711, lr_0 = 5.9064e-04
Loss = 1.2070e-01, PNorm = 44.3011, GNorm = 1.1857, lr_0 = 5.7843e-04
Validation rmse = 0.174876
Validation r2 = 0.441927
Validation mse = 0.030582
Epoch 15
Loss = 1.2488e-01, PNorm = 44.3180, GNorm = 5.1203, lr_0 = 5.6647e-04
Loss = 1.2139e-01, PNorm = 44.3395, GNorm = 0.8533, lr_0 = 5.5476e-04
Loss = 1.3866e-01, PNorm = 44.3419, GNorm = 3.0348, lr_0 = 5.5360e-04
Validation rmse = 0.120996
Validation r2 = 0.732841
Validation mse = 0.014640
Epoch 16
Loss = 1.2371e-01, PNorm = 44.3611, GNorm = 3.9528, lr_0 = 5.4215e-04
Loss = 1.1712e-01, PNorm = 44.3771, GNorm = 0.8945, lr_0 = 5.3094e-04
Validation rmse = 0.102806
Validation r2 = 0.807131
Validation mse = 0.010569
Epoch 17
Loss = 1.2045e-01, PNorm = 44.3954, GNorm = 1.0408, lr_0 = 5.1996e-04
Validation rmse = 0.150226
Validation r2 = 0.588168
Validation mse = 0.022568
Epoch 18
Loss = 1.0093e-01, PNorm = 44.4123, GNorm = 2.0568, lr_0 = 5.0815e-04
Loss = 1.0566e-01, PNorm = 44.4285, GNorm = 1.2403, lr_0 = 4.9764e-04
Validation rmse = 0.120301
Validation r2 = 0.735902
Validation mse = 0.014472
Epoch 19
Loss = 7.8459e-02, PNorm = 44.4441, GNorm = 1.2629, lr_0 = 4.8633e-04
Loss = 1.0930e-01, PNorm = 44.4577, GNorm = 2.2965, lr_0 = 4.7628e-04
Validation rmse = 0.141868
Validation r2 = 0.632722
Validation mse = 0.020126
Epoch 20
Loss = 1.0307e-01, PNorm = 44.4703, GNorm = 0.8485, lr_0 = 4.6643e-04
Loss = 1.1513e-01, PNorm = 44.4845, GNorm = 0.9709, lr_0 = 4.5678e-04
Validation rmse = 0.116318
Validation r2 = 0.753098
Validation mse = 0.013530
Epoch 21
Loss = 1.1373e-01, PNorm = 44.5021, GNorm = 4.0345, lr_0 = 4.4640e-04
Loss = 1.2552e-01, PNorm = 44.5193, GNorm = 3.3936, lr_0 = 4.3717e-04
Validation rmse = 0.161124
Validation r2 = 0.526252
Validation mse = 0.025961
Epoch 22
Loss = 1.1428e-01, PNorm = 44.5367, GNorm = 0.7211, lr_0 = 4.2813e-04
Loss = 1.0134e-01, PNorm = 44.5549, GNorm = 0.9732, lr_0 = 4.1928e-04
Validation rmse = 0.134310
Validation r2 = 0.670813
Validation mse = 0.018039
Epoch 23
Loss = 9.9514e-02, PNorm = 44.5706, GNorm = 1.0467, lr_0 = 4.0975e-04
Loss = 9.4707e-02, PNorm = 44.5808, GNorm = 2.2265, lr_0 = 4.0128e-04
Validation rmse = 0.145644
Validation r2 = 0.612907
Validation mse = 0.021212
Epoch 24
Loss = 8.2127e-02, PNorm = 44.5948, GNorm = 1.7792, lr_0 = 3.9298e-04
Loss = 9.4800e-02, PNorm = 44.6100, GNorm = 0.9695, lr_0 = 3.8486e-04
Validation rmse = 0.150368
Validation r2 = 0.587390
Validation mse = 0.022611
Epoch 25
Loss = 1.0108e-01, PNorm = 44.6230, GNorm = 1.6033, lr_0 = 3.7611e-04
Loss = 9.4255e-02, PNorm = 44.6364, GNorm = 1.9565, lr_0 = 3.6834e-04
Validation rmse = 0.129421
Validation r2 = 0.694340
Validation mse = 0.016750
Epoch 26
Loss = 9.0044e-02, PNorm = 44.6509, GNorm = 1.1993, lr_0 = 3.5997e-04
Loss = 8.5020e-02, PNorm = 44.6613, GNorm = 2.0708, lr_0 = 3.5252e-04
Validation rmse = 0.122147
Validation r2 = 0.727735
Validation mse = 0.014920
Epoch 27
Loss = 8.9172e-02, PNorm = 44.6740, GNorm = 1.0777, lr_0 = 3.4523e-04
Loss = 8.5648e-02, PNorm = 44.6847, GNorm = 0.7214, lr_0 = 3.3809e-04
Validation rmse = 0.119894
Validation r2 = 0.737684
Validation mse = 0.014375
Epoch 28
Loss = 8.1779e-02, PNorm = 44.6968, GNorm = 1.4301, lr_0 = 3.3041e-04
Loss = 8.4641e-02, PNorm = 44.7079, GNorm = 0.6717, lr_0 = 3.2358e-04
Validation rmse = 0.119439
Validation r2 = 0.739674
Validation mse = 0.014266
Epoch 29
Loss = 9.2217e-02, PNorm = 44.7186, GNorm = 2.1510, lr_0 = 3.1689e-04
Loss = 1.0145e-01, PNorm = 44.7313, GNorm = 2.8181, lr_0 = 3.1034e-04
Validation rmse = 0.129573
Validation r2 = 0.693620
Validation mse = 0.016789
Epoch 30
Loss = 7.4935e-02, PNorm = 44.7418, GNorm = 0.8011, lr_0 = 3.0329e-04
Loss = 8.3875e-02, PNorm = 44.7531, GNorm = 3.3832, lr_0 = 2.9701e-04
Validation rmse = 0.128888
Validation r2 = 0.696855
Validation mse = 0.016612
Epoch 31
Loss = 7.3832e-02, PNorm = 44.7629, GNorm = 0.9504, lr_0 = 2.9087e-04
Loss = 8.2812e-02, PNorm = 44.7711, GNorm = 1.8725, lr_0 = 2.8486e-04
Validation rmse = 0.135988
Validation r2 = 0.662534
Validation mse = 0.018493
Epoch 32
Loss = 7.4321e-02, PNorm = 44.7837, GNorm = 0.7080, lr_0 = 2.7839e-04
Loss = 8.5259e-02, PNorm = 44.7949, GNorm = 1.9146, lr_0 = 2.7263e-04
Loss = 3.5752e-02, PNorm = 44.7958, GNorm = 0.8251, lr_0 = 2.7206e-04
Validation rmse = 0.157248
Validation r2 = 0.548768
Validation mse = 0.024727
Epoch 33
Loss = 9.2145e-02, PNorm = 44.8069, GNorm = 2.5955, lr_0 = 2.6643e-04
Loss = 7.0389e-02, PNorm = 44.8165, GNorm = 1.8664, lr_0 = 2.6092e-04
Validation rmse = 0.138045
Validation r2 = 0.652248
Validation mse = 0.019056
Epoch 34
Loss = 7.4311e-02, PNorm = 44.8250, GNorm = 0.7584, lr_0 = 2.5553e-04
Validation rmse = 0.128273
Validation r2 = 0.699738
Validation mse = 0.016454
Epoch 35
Loss = 5.9497e-02, PNorm = 44.8338, GNorm = 0.7815, lr_0 = 2.4972e-04
Loss = 7.6483e-02, PNorm = 44.8415, GNorm = 0.9234, lr_0 = 2.4456e-04
Validation rmse = 0.150275
Validation r2 = 0.587899
Validation mse = 0.022583
Epoch 36
Loss = 8.4765e-02, PNorm = 44.8503, GNorm = 1.4186, lr_0 = 2.3950e-04
Loss = 7.0194e-02, PNorm = 44.8559, GNorm = 0.5711, lr_0 = 2.3455e-04
Validation rmse = 0.140031
Validation r2 = 0.642168
Validation mse = 0.019609
Epoch 37
Loss = 1.0325e-01, PNorm = 44.8645, GNorm = 1.6686, lr_0 = 2.2922e-04
Loss = 6.4070e-02, PNorm = 44.8722, GNorm = 1.0485, lr_0 = 2.2448e-04
Validation rmse = 0.137199
Validation r2 = 0.656496
Validation mse = 0.018824
Epoch 38
Loss = 7.7628e-02, PNorm = 44.8818, GNorm = 0.8548, lr_0 = 2.1938e-04
Loss = 6.1629e-02, PNorm = 44.8890, GNorm = 1.1240, lr_0 = 2.1484e-04
Validation rmse = 0.137193
Validation r2 = 0.656526
Validation mse = 0.018822
Epoch 39
Loss = 4.7301e-02, PNorm = 44.8963, GNorm = 0.5779, lr_0 = 2.1040e-04
Loss = 6.7317e-02, PNorm = 44.9043, GNorm = 0.9953, lr_0 = 2.0605e-04
Validation rmse = 0.156170
Validation r2 = 0.554932
Validation mse = 0.024389
Epoch 40
Loss = 7.2710e-02, PNorm = 44.9130, GNorm = 1.7626, lr_0 = 2.0137e-04
Loss = 7.2559e-02, PNorm = 44.9198, GNorm = 2.7460, lr_0 = 1.9721e-04
Validation rmse = 0.146265
Validation r2 = 0.609600
Validation mse = 0.021394
Epoch 41
Loss = 5.0229e-02, PNorm = 44.9265, GNorm = 0.8857, lr_0 = 1.9313e-04
Loss = 6.8688e-02, PNorm = 44.9330, GNorm = 3.4702, lr_0 = 1.8913e-04
Validation rmse = 0.144749
Validation r2 = 0.617652
Validation mse = 0.020952
Epoch 42
Loss = 6.1922e-02, PNorm = 44.9408, GNorm = 1.6078, lr_0 = 1.8484e-04
Loss = 7.7731e-02, PNorm = 44.9475, GNorm = 2.0028, lr_0 = 1.8101e-04
Validation rmse = 0.137255
Validation r2 = 0.656215
Validation mse = 0.018839
Epoch 43
Loss = 6.4729e-02, PNorm = 44.9544, GNorm = 2.1778, lr_0 = 1.7727e-04
Loss = 6.2749e-02, PNorm = 44.9599, GNorm = 1.2913, lr_0 = 1.7361e-04
Validation rmse = 0.144087
Validation r2 = 0.621140
Validation mse = 0.020761
Epoch 44
Loss = 6.5705e-02, PNorm = 44.9679, GNorm = 1.4220, lr_0 = 1.6966e-04
Loss = 6.9524e-02, PNorm = 44.9746, GNorm = 2.8665, lr_0 = 1.6615e-04
Validation rmse = 0.136764
Validation r2 = 0.658674
Validation mse = 0.018704
Epoch 45
Loss = 6.2586e-02, PNorm = 44.9813, GNorm = 1.7870, lr_0 = 1.6238e-04
Loss = 6.3098e-02, PNorm = 44.9864, GNorm = 1.5554, lr_0 = 1.5902e-04
Validation rmse = 0.142471
Validation r2 = 0.629589
Validation mse = 0.020298
Epoch 46
Loss = 5.0155e-02, PNorm = 44.9918, GNorm = 0.7601, lr_0 = 1.5573e-04
Loss = 6.9613e-02, PNorm = 44.9976, GNorm = 0.8204, lr_0 = 1.5251e-04
Validation rmse = 0.148096
Validation r2 = 0.599763
Validation mse = 0.021933
Epoch 47
Loss = 5.8478e-02, PNorm = 45.0029, GNorm = 2.1737, lr_0 = 1.4905e-04
Loss = 5.8809e-02, PNorm = 45.0077, GNorm = 1.9368, lr_0 = 1.4596e-04
Validation rmse = 0.153723
Validation r2 = 0.568774
Validation mse = 0.023631
Epoch 48
Loss = 6.4518e-02, PNorm = 45.0133, GNorm = 0.7429, lr_0 = 1.4295e-04
Loss = 5.2753e-02, PNorm = 45.0189, GNorm = 1.5012, lr_0 = 1.3999e-04
Validation rmse = 0.152780
Validation r2 = 0.574049
Validation mse = 0.023342
Epoch 49
Loss = 5.7342e-02, PNorm = 45.0246, GNorm = 1.3029, lr_0 = 1.3681e-04
Loss = 5.7852e-02, PNorm = 45.0285, GNorm = 1.0484, lr_0 = 1.3398e-04
Validation rmse = 0.143463
Validation r2 = 0.624413
Validation mse = 0.020582
Epoch 50
Loss = 5.4166e-02, PNorm = 45.0332, GNorm = 2.6568, lr_0 = 1.3121e-04
Loss = 6.2320e-02, PNorm = 45.0382, GNorm = 0.6303, lr_0 = 1.2850e-04
Loss = 3.6935e-02, PNorm = 45.0387, GNorm = 1.4609, lr_0 = 1.2823e-04
Validation rmse = 0.147123
Validation r2 = 0.605007
Validation mse = 0.021645
Epoch 51
Loss = 5.5560e-02, PNorm = 45.0438, GNorm = 0.4382, lr_0 = 1.2558e-04
Validation rmse = 0.146674
Validation r2 = 0.607415
Validation mse = 0.021513
Epoch 52
Loss = 6.9856e-02, PNorm = 45.0482, GNorm = 0.6911, lr_0 = 1.2272e-04
Loss = 5.0849e-02, PNorm = 45.0524, GNorm = 1.2748, lr_0 = 1.2019e-04
Validation rmse = 0.138899
Validation r2 = 0.647930
Validation mse = 0.019293
Epoch 53
Loss = 6.0928e-02, PNorm = 45.0563, GNorm = 0.7953, lr_0 = 1.1770e-04
Loss = 5.7836e-02, PNorm = 45.0605, GNorm = 0.5956, lr_0 = 1.1527e-04
Validation rmse = 0.148270
Validation r2 = 0.598822
Validation mse = 0.021984
Epoch 54
Loss = 7.8628e-02, PNorm = 45.0650, GNorm = 1.6196, lr_0 = 1.1265e-04
Loss = 5.4437e-02, PNorm = 45.0690, GNorm = 0.5799, lr_0 = 1.1032e-04
Validation rmse = 0.148680
Validation r2 = 0.596605
Validation mse = 0.022106
Epoch 55
Loss = 4.3665e-02, PNorm = 45.0730, GNorm = 0.6315, lr_0 = 1.0804e-04
Loss = 5.6139e-02, PNorm = 45.0771, GNorm = 0.6870, lr_0 = 1.0580e-04
Validation rmse = 0.155723
Validation r2 = 0.557480
Validation mse = 0.024250
Epoch 56
Loss = 4.8242e-02, PNorm = 45.0803, GNorm = 2.4554, lr_0 = 1.0340e-04
Loss = 5.4460e-02, PNorm = 45.0840, GNorm = 2.2169, lr_0 = 1.0126e-04
Validation rmse = 0.148952
Validation r2 = 0.595126
Validation mse = 0.022187
Epoch 57
Loss = 5.5022e-02, PNorm = 45.0883, GNorm = 0.5400, lr_0 = 1.0000e-04
Loss = 5.2788e-02, PNorm = 45.0917, GNorm = 1.5541, lr_0 = 1.0000e-04
Validation rmse = 0.154166
Validation r2 = 0.566286
Validation mse = 0.023767
Epoch 58
Loss = 4.4809e-02, PNorm = 45.0954, GNorm = 1.0462, lr_0 = 1.0000e-04
Loss = 4.7208e-02, PNorm = 45.0989, GNorm = 1.1581, lr_0 = 1.0000e-04
Validation rmse = 0.156907
Validation r2 = 0.550724
Validation mse = 0.024620
Epoch 59
Loss = 5.9465e-02, PNorm = 45.1038, GNorm = 0.9583, lr_0 = 1.0000e-04
Loss = 5.4787e-02, PNorm = 45.1073, GNorm = 0.5737, lr_0 = 1.0000e-04
Validation rmse = 0.152771
Validation r2 = 0.574096
Validation mse = 0.023339
Model 0 best validation rmse = 0.102806 on epoch 16
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.610362
Model 0 test r2 = -7.840797
Model 0 test mse = 0.372542
Ensemble test rmse = 0.610362
Ensemble test r2 = -7.840797
Ensemble test mse = 0.372542
Fold 8
Splitting data with seed 8
Total size = 981 | train size = 971 | val size = 10 | test size = 51
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 1.0044e+00, PNorm = 43.2613, GNorm = 3.1652, lr_0 = 3.6053e-04
Validation rmse = 0.217865
Validation r2 = 0.310422
Validation mse = 0.047465
Epoch 1
Loss = 1.0302e+00, PNorm = 43.2867, GNorm = 15.1364, lr_0 = 6.2105e-04
Loss = 8.1921e-01, PNorm = 43.3132, GNorm = 7.2952, lr_0 = 8.5789e-04
Validation rmse = 0.213799
Validation r2 = 0.335916
Validation mse = 0.045710
Epoch 2
Loss = 5.9778e-01, PNorm = 43.3778, GNorm = 5.0408, lr_0 = 9.8961e-04
Loss = 5.3750e-01, PNorm = 43.4465, GNorm = 2.1672, lr_0 = 9.6914e-04
Validation rmse = 0.191895
Validation r2 = 0.465023
Validation mse = 0.036824
Epoch 3
Loss = 3.7268e-01, PNorm = 43.5150, GNorm = 2.4153, lr_0 = 9.4910e-04
Loss = 3.9928e-01, PNorm = 43.5867, GNorm = 6.7576, lr_0 = 9.2948e-04
Validation rmse = 0.220103
Validation r2 = 0.296181
Validation mse = 0.048445
Epoch 4
Loss = 3.4288e-01, PNorm = 43.6514, GNorm = 3.6693, lr_0 = 9.0836e-04
Loss = 3.4102e-01, PNorm = 43.7023, GNorm = 5.9921, lr_0 = 8.8958e-04
Validation rmse = 0.143047
Validation r2 = 0.702718
Validation mse = 0.020463
Epoch 5
Loss = 3.0866e-01, PNorm = 43.7565, GNorm = 6.2303, lr_0 = 8.7118e-04
Loss = 2.8304e-01, PNorm = 43.8104, GNorm = 0.8584, lr_0 = 8.5317e-04
Validation rmse = 0.145811
Validation r2 = 0.691121
Validation mse = 0.021261
Epoch 6
Loss = 1.9678e-01, PNorm = 43.8588, GNorm = 1.6134, lr_0 = 8.3378e-04
Loss = 1.9253e-01, PNorm = 43.9046, GNorm = 0.8588, lr_0 = 8.1654e-04
Validation rmse = 0.118385
Validation r2 = 0.796389
Validation mse = 0.014015
Epoch 7
Loss = 2.2641e-01, PNorm = 43.9464, GNorm = 0.8141, lr_0 = 7.9799e-04
Loss = 3.3940e-01, PNorm = 43.9885, GNorm = 6.2169, lr_0 = 7.8149e-04
Validation rmse = 0.116850
Validation r2 = 0.801635
Validation mse = 0.013654
Epoch 8
Loss = 2.3779e-01, PNorm = 44.0383, GNorm = 2.6056, lr_0 = 7.6533e-04
Loss = 2.0683e-01, PNorm = 44.0852, GNorm = 3.3324, lr_0 = 7.4950e-04
Validation rmse = 0.150202
Validation r2 = 0.672237
Validation mse = 0.022561
Epoch 9
Loss = 1.6652e-01, PNorm = 44.1258, GNorm = 0.7916, lr_0 = 7.3247e-04
Loss = 1.7507e-01, PNorm = 44.1574, GNorm = 0.8681, lr_0 = 7.1733e-04
Validation rmse = 0.088673
Validation r2 = 0.885766
Validation mse = 0.007863
Epoch 10
Loss = 1.7736e-01, PNorm = 44.1830, GNorm = 4.2195, lr_0 = 7.0249e-04
Loss = 1.7015e-01, PNorm = 44.2087, GNorm = 4.8196, lr_0 = 6.8797e-04
Validation rmse = 0.100371
Validation r2 = 0.853640
Validation mse = 0.010074
Epoch 11
Loss = 1.4721e-01, PNorm = 44.2392, GNorm = 0.9596, lr_0 = 6.7234e-04
Loss = 1.4023e-01, PNorm = 44.2618, GNorm = 3.3099, lr_0 = 6.5843e-04
Validation rmse = 0.085500
Validation r2 = 0.893795
Validation mse = 0.007310
Epoch 12
Loss = 1.3570e-01, PNorm = 44.2796, GNorm = 0.8152, lr_0 = 6.4482e-04
Loss = 1.2558e-01, PNorm = 44.2995, GNorm = 0.5538, lr_0 = 6.3148e-04
Validation rmse = 0.163895
Validation r2 = 0.609750
Validation mse = 0.026862
Epoch 13
Loss = 1.3914e-01, PNorm = 44.3162, GNorm = 2.2734, lr_0 = 6.1714e-04
Loss = 1.3053e-01, PNorm = 44.3366, GNorm = 1.1079, lr_0 = 6.0438e-04
Validation rmse = 0.104606
Validation r2 = 0.841026
Validation mse = 0.010942
Epoch 14
Loss = 1.2939e-01, PNorm = 44.3584, GNorm = 0.5235, lr_0 = 5.9064e-04
Loss = 1.1005e-01, PNorm = 44.3732, GNorm = 0.5053, lr_0 = 5.7843e-04
Validation rmse = 0.119591
Validation r2 = 0.792217
Validation mse = 0.014302
Epoch 15
Loss = 1.2648e-01, PNorm = 44.3899, GNorm = 1.7237, lr_0 = 5.6647e-04
Loss = 1.2330e-01, PNorm = 44.4025, GNorm = 2.5524, lr_0 = 5.5476e-04
Loss = 1.1925e-01, PNorm = 44.4042, GNorm = 3.5097, lr_0 = 5.5360e-04
Validation rmse = 0.130590
Validation r2 = 0.752241
Validation mse = 0.017054
Epoch 16
Loss = 1.0708e-01, PNorm = 44.4233, GNorm = 1.7048, lr_0 = 5.4215e-04
Loss = 1.3922e-01, PNorm = 44.4395, GNorm = 1.3980, lr_0 = 5.3094e-04
Validation rmse = 0.113828
Validation r2 = 0.811763
Validation mse = 0.012957
Epoch 17
Loss = 1.4866e-01, PNorm = 44.4580, GNorm = 2.6388, lr_0 = 5.1996e-04
Validation rmse = 0.102844
Validation r2 = 0.846337
Validation mse = 0.010577
Epoch 18
Loss = 6.4781e-02, PNorm = 44.4780, GNorm = 1.0662, lr_0 = 5.0815e-04
Loss = 1.2487e-01, PNorm = 44.4940, GNorm = 0.9651, lr_0 = 4.9764e-04
Validation rmse = 0.113233
Validation r2 = 0.813723
Validation mse = 0.012822
Epoch 19
Loss = 1.0283e-01, PNorm = 44.5091, GNorm = 0.8252, lr_0 = 4.8633e-04
Loss = 1.0558e-01, PNorm = 44.5204, GNorm = 2.8407, lr_0 = 4.7628e-04
Validation rmse = 0.118386
Validation r2 = 0.796386
Validation mse = 0.014015
Epoch 20
Loss = 9.2677e-02, PNorm = 44.5360, GNorm = 0.7489, lr_0 = 4.6643e-04
Loss = 9.9095e-02, PNorm = 44.5517, GNorm = 0.5557, lr_0 = 4.5678e-04
Validation rmse = 0.130963
Validation r2 = 0.750822
Validation mse = 0.017151
Epoch 21
Loss = 9.1148e-02, PNorm = 44.5642, GNorm = 1.3680, lr_0 = 4.4640e-04
Loss = 9.2574e-02, PNorm = 44.5767, GNorm = 0.8174, lr_0 = 4.3717e-04
Validation rmse = 0.118023
Validation r2 = 0.797630
Validation mse = 0.013930
Epoch 22
Loss = 8.5795e-02, PNorm = 44.5898, GNorm = 0.4556, lr_0 = 4.2813e-04
Loss = 9.5978e-02, PNorm = 44.6008, GNorm = 1.0693, lr_0 = 4.1928e-04
Validation rmse = 0.130760
Validation r2 = 0.751596
Validation mse = 0.017098
Epoch 23
Loss = 1.0213e-01, PNorm = 44.6153, GNorm = 1.5417, lr_0 = 4.0975e-04
Loss = 1.0052e-01, PNorm = 44.6279, GNorm = 2.4728, lr_0 = 4.0128e-04
Validation rmse = 0.114745
Validation r2 = 0.808717
Validation mse = 0.013166
Epoch 24
Loss = 8.0742e-02, PNorm = 44.6404, GNorm = 0.5863, lr_0 = 3.9298e-04
Loss = 1.0163e-01, PNorm = 44.6526, GNorm = 3.6078, lr_0 = 3.8486e-04
Validation rmse = 0.150318
Validation r2 = 0.671731
Validation mse = 0.022595
Epoch 25
Loss = 7.5113e-02, PNorm = 44.6663, GNorm = 2.4278, lr_0 = 3.7611e-04
Loss = 1.1754e-01, PNorm = 44.6784, GNorm = 3.4624, lr_0 = 3.6834e-04
Validation rmse = 0.160060
Validation r2 = 0.627803
Validation mse = 0.025619
Epoch 26
Loss = 1.0533e-01, PNorm = 44.6932, GNorm = 2.1971, lr_0 = 3.5997e-04
Loss = 1.0597e-01, PNorm = 44.7070, GNorm = 1.5092, lr_0 = 3.5252e-04
Validation rmse = 0.134899
Validation r2 = 0.735619
Validation mse = 0.018198
Epoch 27
Loss = 8.4836e-02, PNorm = 44.7218, GNorm = 0.5992, lr_0 = 3.4523e-04
Loss = 8.4196e-02, PNorm = 44.7324, GNorm = 1.2681, lr_0 = 3.3809e-04
Validation rmse = 0.111268
Validation r2 = 0.820134
Validation mse = 0.012380
Epoch 28
Loss = 6.8940e-02, PNorm = 44.7429, GNorm = 0.7028, lr_0 = 3.3041e-04
Loss = 1.0335e-01, PNorm = 44.7531, GNorm = 0.9159, lr_0 = 3.2358e-04
Validation rmse = 0.149247
Validation r2 = 0.676392
Validation mse = 0.022275
Epoch 29
Loss = 1.0425e-01, PNorm = 44.7629, GNorm = 0.7298, lr_0 = 3.1689e-04
Loss = 9.5426e-02, PNorm = 44.7748, GNorm = 0.6595, lr_0 = 3.1034e-04
Validation rmse = 0.155182
Validation r2 = 0.650142
Validation mse = 0.024081
Epoch 30
Loss = 8.3846e-02, PNorm = 44.7875, GNorm = 0.5952, lr_0 = 3.0329e-04
Loss = 9.4048e-02, PNorm = 44.7981, GNorm = 1.6541, lr_0 = 2.9701e-04
Validation rmse = 0.157657
Validation r2 = 0.638890
Validation mse = 0.024856
Epoch 31
Loss = 8.1113e-02, PNorm = 44.8079, GNorm = 1.3065, lr_0 = 2.9087e-04
Loss = 8.7112e-02, PNorm = 44.8174, GNorm = 1.6239, lr_0 = 2.8486e-04
Validation rmse = 0.150554
Validation r2 = 0.670698
Validation mse = 0.022666
Epoch 32
Loss = 8.5291e-02, PNorm = 44.8279, GNorm = 0.7398, lr_0 = 2.7839e-04
Loss = 8.1085e-02, PNorm = 44.8373, GNorm = 0.7016, lr_0 = 2.7263e-04
Loss = 1.4098e-01, PNorm = 44.8380, GNorm = 1.1699, lr_0 = 2.7206e-04
Validation rmse = 0.131309
Validation r2 = 0.749505
Validation mse = 0.017242
Epoch 33
Loss = 8.7880e-02, PNorm = 44.8486, GNorm = 3.2826, lr_0 = 2.6643e-04
Loss = 7.6655e-02, PNorm = 44.8581, GNorm = 2.2211, lr_0 = 2.6092e-04
Validation rmse = 0.116356
Validation r2 = 0.803308
Validation mse = 0.013539
Epoch 34
Loss = 7.5480e-02, PNorm = 44.8680, GNorm = 0.7847, lr_0 = 2.5553e-04
Validation rmse = 0.135769
Validation r2 = 0.732198
Validation mse = 0.018433
Epoch 35
Loss = 5.5223e-02, PNorm = 44.8773, GNorm = 0.5861, lr_0 = 2.4972e-04
Loss = 8.3434e-02, PNorm = 44.8845, GNorm = 0.7655, lr_0 = 2.4456e-04
Validation rmse = 0.135402
Validation r2 = 0.733644
Validation mse = 0.018334
Epoch 36
Loss = 5.6384e-02, PNorm = 44.8935, GNorm = 0.9914, lr_0 = 2.3950e-04
Loss = 8.5900e-02, PNorm = 44.9028, GNorm = 0.6624, lr_0 = 2.3455e-04
Validation rmse = 0.131990
Validation r2 = 0.746899
Validation mse = 0.017421
Epoch 37
Loss = 5.1485e-02, PNorm = 44.9110, GNorm = 1.1445, lr_0 = 2.2922e-04
Loss = 7.3014e-02, PNorm = 44.9179, GNorm = 0.9195, lr_0 = 2.2448e-04
Validation rmse = 0.133681
Validation r2 = 0.740373
Validation mse = 0.017871
Epoch 38
Loss = 7.2775e-02, PNorm = 44.9248, GNorm = 2.4812, lr_0 = 2.1938e-04
Loss = 8.0975e-02, PNorm = 44.9329, GNorm = 0.7275, lr_0 = 2.1484e-04
Validation rmse = 0.118623
Validation r2 = 0.795569
Validation mse = 0.014071
Epoch 39
Loss = 6.5907e-02, PNorm = 44.9412, GNorm = 0.6822, lr_0 = 2.1040e-04
Loss = 8.0805e-02, PNorm = 44.9489, GNorm = 0.4183, lr_0 = 2.0605e-04
Validation rmse = 0.128131
Validation r2 = 0.761482
Validation mse = 0.016418
Epoch 40
Loss = 6.4640e-02, PNorm = 44.9569, GNorm = 1.0119, lr_0 = 2.0137e-04
Loss = 8.2394e-02, PNorm = 44.9643, GNorm = 0.9724, lr_0 = 1.9721e-04
Validation rmse = 0.128173
Validation r2 = 0.761325
Validation mse = 0.016428
Epoch 41
Loss = 6.8825e-02, PNorm = 44.9709, GNorm = 1.6357, lr_0 = 1.9313e-04
Loss = 7.1185e-02, PNorm = 44.9790, GNorm = 1.0943, lr_0 = 1.8913e-04
Validation rmse = 0.142656
Validation r2 = 0.704341
Validation mse = 0.020351
Epoch 42
Loss = 7.3501e-02, PNorm = 44.9857, GNorm = 0.8548, lr_0 = 1.8484e-04
Loss = 6.0750e-02, PNorm = 44.9929, GNorm = 1.6542, lr_0 = 1.8101e-04
Validation rmse = 0.129114
Validation r2 = 0.757810
Validation mse = 0.016670
Epoch 43
Loss = 7.1267e-02, PNorm = 44.9977, GNorm = 0.8157, lr_0 = 1.7727e-04
Loss = 6.9803e-02, PNorm = 45.0036, GNorm = 0.7968, lr_0 = 1.7361e-04
Validation rmse = 0.133156
Validation r2 = 0.742407
Validation mse = 0.017731
Epoch 44
Loss = 5.8960e-02, PNorm = 45.0108, GNorm = 0.6228, lr_0 = 1.6966e-04
Loss = 7.6929e-02, PNorm = 45.0181, GNorm = 1.4503, lr_0 = 1.6615e-04
Validation rmse = 0.145503
Validation r2 = 0.692422
Validation mse = 0.021171
Epoch 45
Loss = 7.1717e-02, PNorm = 45.0237, GNorm = 1.3176, lr_0 = 1.6238e-04
Loss = 6.3548e-02, PNorm = 45.0292, GNorm = 2.0886, lr_0 = 1.5902e-04
Validation rmse = 0.140562
Validation r2 = 0.712958
Validation mse = 0.019758
Epoch 46
Loss = 5.8028e-02, PNorm = 45.0354, GNorm = 1.5375, lr_0 = 1.5573e-04
Loss = 6.7264e-02, PNorm = 45.0414, GNorm = 0.5000, lr_0 = 1.5251e-04
Validation rmse = 0.129137
Validation r2 = 0.757723
Validation mse = 0.016676
Epoch 47
Loss = 5.6484e-02, PNorm = 45.0481, GNorm = 0.4670, lr_0 = 1.4905e-04
Loss = 6.7673e-02, PNorm = 45.0536, GNorm = 0.8650, lr_0 = 1.4596e-04
Validation rmse = 0.146262
Validation r2 = 0.689206
Validation mse = 0.021393
Epoch 48
Loss = 6.3206e-02, PNorm = 45.0591, GNorm = 0.4541, lr_0 = 1.4295e-04
Loss = 6.8131e-02, PNorm = 45.0645, GNorm = 1.0913, lr_0 = 1.3999e-04
Validation rmse = 0.140637
Validation r2 = 0.712651
Validation mse = 0.019779
Epoch 49
Loss = 5.7754e-02, PNorm = 45.0697, GNorm = 0.7018, lr_0 = 1.3681e-04
Loss = 6.4438e-02, PNorm = 45.0746, GNorm = 0.5831, lr_0 = 1.3398e-04
Validation rmse = 0.133502
Validation r2 = 0.741068
Validation mse = 0.017823
Epoch 50
Loss = 5.4744e-02, PNorm = 45.0800, GNorm = 1.0395, lr_0 = 1.3121e-04
Loss = 6.5615e-02, PNorm = 45.0858, GNorm = 0.9869, lr_0 = 1.2850e-04
Loss = 4.6774e-02, PNorm = 45.0865, GNorm = 1.0541, lr_0 = 1.2823e-04
Validation rmse = 0.128457
Validation r2 = 0.760269
Validation mse = 0.016501
Epoch 51
Loss = 5.4049e-02, PNorm = 45.0911, GNorm = 1.0254, lr_0 = 1.2558e-04
Validation rmse = 0.138135
Validation r2 = 0.722785
Validation mse = 0.019081
Epoch 52
Loss = 6.9173e-02, PNorm = 45.0964, GNorm = 0.8017, lr_0 = 1.2272e-04
Loss = 5.9344e-02, PNorm = 45.1019, GNorm = 0.5034, lr_0 = 1.2019e-04
Validation rmse = 0.148830
Validation r2 = 0.678196
Validation mse = 0.022150
Epoch 53
Loss = 7.6925e-02, PNorm = 45.1058, GNorm = 1.6275, lr_0 = 1.1770e-04
Loss = 6.7525e-02, PNorm = 45.1106, GNorm = 1.4050, lr_0 = 1.1527e-04
Validation rmse = 0.137306
Validation r2 = 0.726103
Validation mse = 0.018853
Epoch 54
Loss = 4.9135e-02, PNorm = 45.1157, GNorm = 1.4171, lr_0 = 1.1265e-04
Loss = 5.6018e-02, PNorm = 45.1194, GNorm = 0.7710, lr_0 = 1.1032e-04
Validation rmse = 0.141193
Validation r2 = 0.710374
Validation mse = 0.019936
Epoch 55
Loss = 4.3647e-02, PNorm = 45.1239, GNorm = 0.6958, lr_0 = 1.0804e-04
Loss = 6.8352e-02, PNorm = 45.1303, GNorm = 1.2307, lr_0 = 1.0580e-04
Validation rmse = 0.134885
Validation r2 = 0.735677
Validation mse = 0.018194
Epoch 56
Loss = 5.5616e-02, PNorm = 45.1347, GNorm = 1.7113, lr_0 = 1.0340e-04
Loss = 5.6492e-02, PNorm = 45.1385, GNorm = 1.0846, lr_0 = 1.0126e-04
Validation rmse = 0.142838
Validation r2 = 0.703587
Validation mse = 0.020403
Epoch 57
Loss = 4.7752e-02, PNorm = 45.1432, GNorm = 1.0104, lr_0 = 1.0000e-04
Loss = 6.1068e-02, PNorm = 45.1478, GNorm = 1.7302, lr_0 = 1.0000e-04
Validation rmse = 0.141214
Validation r2 = 0.710288
Validation mse = 0.019941
Epoch 58
Loss = 5.4131e-02, PNorm = 45.1510, GNorm = 0.8813, lr_0 = 1.0000e-04
Loss = 6.0232e-02, PNorm = 45.1547, GNorm = 1.2500, lr_0 = 1.0000e-04
Validation rmse = 0.129245
Validation r2 = 0.757318
Validation mse = 0.016704
Epoch 59
Loss = 4.5862e-02, PNorm = 45.1588, GNorm = 0.4390, lr_0 = 1.0000e-04
Loss = 6.0275e-02, PNorm = 45.1625, GNorm = 1.1962, lr_0 = 1.0000e-04
Validation rmse = 0.149346
Validation r2 = 0.675963
Validation mse = 0.022304
Model 0 best validation rmse = 0.085500 on epoch 11
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.540338
Model 0 test r2 = -5.928620
Model 0 test mse = 0.291965
Ensemble test rmse = 0.540338
Ensemble test r2 = -5.928620
Ensemble test mse = 0.291965
Fold 9
Splitting data with seed 9
Total size = 981 | train size = 971 | val size = 10 | test size = 51
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 8.7907e-01, PNorm = 43.2628, GNorm = 4.0439, lr_0 = 3.6053e-04
Validation rmse = 0.343430
Validation r2 = 0.308574
Validation mse = 0.117944
Epoch 1
Loss = 6.7619e-01, PNorm = 43.2867, GNorm = 4.0802, lr_0 = 6.2105e-04
Loss = 6.3092e-01, PNorm = 43.3215, GNorm = 7.9175, lr_0 = 8.5789e-04
Validation rmse = 0.429347
Validation r2 = -0.080650
Validation mse = 0.184339
Epoch 2
Loss = 7.1469e-01, PNorm = 43.3878, GNorm = 10.6767, lr_0 = 9.8961e-04
Loss = 6.6198e-01, PNorm = 43.4551, GNorm = 3.7829, lr_0 = 9.6914e-04
Validation rmse = 0.208361
Validation r2 = 0.745492
Validation mse = 0.043414
Epoch 3
Loss = 3.8099e-01, PNorm = 43.5290, GNorm = 2.0984, lr_0 = 9.4910e-04
Loss = 4.0021e-01, PNorm = 43.6040, GNorm = 2.4689, lr_0 = 9.2948e-04
Validation rmse = 0.172914
Validation r2 = 0.824722
Validation mse = 0.029899
Epoch 4
Loss = 3.0039e-01, PNorm = 43.6729, GNorm = 4.2662, lr_0 = 9.0836e-04
Loss = 2.8277e-01, PNorm = 43.7303, GNorm = 2.4323, lr_0 = 8.8958e-04
Validation rmse = 0.187329
Validation r2 = 0.794279
Validation mse = 0.035092
Epoch 5
Loss = 2.9556e-01, PNorm = 43.7817, GNorm = 1.7151, lr_0 = 8.7118e-04
Loss = 2.2456e-01, PNorm = 43.8383, GNorm = 0.8344, lr_0 = 8.5317e-04
Validation rmse = 0.120313
Validation r2 = 0.915142
Validation mse = 0.014475
Epoch 6
Loss = 1.9065e-01, PNorm = 43.8814, GNorm = 1.9334, lr_0 = 8.3378e-04
Loss = 1.9063e-01, PNorm = 43.9206, GNorm = 4.0759, lr_0 = 8.1654e-04
Validation rmse = 0.136157
Validation r2 = 0.891321
Validation mse = 0.018539
Epoch 7
Loss = 1.6857e-01, PNorm = 43.9656, GNorm = 3.3157, lr_0 = 7.9799e-04
Loss = 2.1982e-01, PNorm = 44.0008, GNorm = 2.1522, lr_0 = 7.8149e-04
Validation rmse = 0.110558
Validation r2 = 0.928344
Validation mse = 0.012223
Epoch 8
Loss = 1.9369e-01, PNorm = 44.0421, GNorm = 2.5010, lr_0 = 7.6533e-04
Loss = 2.0131e-01, PNorm = 44.0756, GNorm = 2.5563, lr_0 = 7.4950e-04
Validation rmse = 0.130867
Validation r2 = 0.899601
Validation mse = 0.017126
Epoch 9
Loss = 1.6657e-01, PNorm = 44.1124, GNorm = 1.7880, lr_0 = 7.3247e-04
Loss = 1.7203e-01, PNorm = 44.1428, GNorm = 2.5570, lr_0 = 7.1733e-04
Validation rmse = 0.136005
Validation r2 = 0.891563
Validation mse = 0.018497
Epoch 10
Loss = 1.5705e-01, PNorm = 44.1714, GNorm = 0.8080, lr_0 = 7.0249e-04
Loss = 1.2231e-01, PNorm = 44.1947, GNorm = 1.9468, lr_0 = 6.8797e-04
Validation rmse = 0.128395
Validation r2 = 0.903358
Validation mse = 0.016485
Epoch 11
Loss = 1.3845e-01, PNorm = 44.2207, GNorm = 0.8591, lr_0 = 6.7234e-04
Loss = 1.3662e-01, PNorm = 44.2428, GNorm = 0.7241, lr_0 = 6.5843e-04
Validation rmse = 0.122073
Validation r2 = 0.912641
Validation mse = 0.014902
Epoch 12
Loss = 1.3823e-01, PNorm = 44.2601, GNorm = 3.7614, lr_0 = 6.4482e-04
Loss = 1.5378e-01, PNorm = 44.2817, GNorm = 2.4930, lr_0 = 6.3148e-04
Validation rmse = 0.133739
Validation r2 = 0.895147
Validation mse = 0.017886
Epoch 13
Loss = 1.3000e-01, PNorm = 44.3028, GNorm = 3.0350, lr_0 = 6.1714e-04
Loss = 1.2314e-01, PNorm = 44.3257, GNorm = 1.5560, lr_0 = 6.0438e-04
Validation rmse = 0.122290
Validation r2 = 0.912330
Validation mse = 0.014955
Epoch 14
Loss = 1.1165e-01, PNorm = 44.3445, GNorm = 1.0305, lr_0 = 5.9064e-04
Loss = 1.2551e-01, PNorm = 44.3591, GNorm = 0.9769, lr_0 = 5.7843e-04
Validation rmse = 0.120600
Validation r2 = 0.914736
Validation mse = 0.014544
Epoch 15
Loss = 1.0516e-01, PNorm = 44.3750, GNorm = 1.3890, lr_0 = 5.6647e-04
Loss = 1.2415e-01, PNorm = 44.3897, GNorm = 0.7094, lr_0 = 5.5476e-04
Loss = 6.9988e-02, PNorm = 44.3910, GNorm = 2.0211, lr_0 = 5.5360e-04
Validation rmse = 0.138654
Validation r2 = 0.887298
Validation mse = 0.019225
Epoch 16
Loss = 1.1666e-01, PNorm = 44.4036, GNorm = 0.7086, lr_0 = 5.4215e-04
Loss = 1.1291e-01, PNorm = 44.4214, GNorm = 2.1422, lr_0 = 5.3094e-04
Validation rmse = 0.117563
Validation r2 = 0.918977
Validation mse = 0.013821
Epoch 17
Loss = 1.0917e-01, PNorm = 44.4406, GNorm = 0.8744, lr_0 = 5.1996e-04
Validation rmse = 0.121502
Validation r2 = 0.913456
Validation mse = 0.014763
Epoch 18
Loss = 1.5138e-01, PNorm = 44.4556, GNorm = 1.9663, lr_0 = 5.0815e-04
Loss = 1.1207e-01, PNorm = 44.4683, GNorm = 1.2618, lr_0 = 4.9764e-04
Validation rmse = 0.121106
Validation r2 = 0.914020
Validation mse = 0.014667
Epoch 19
Loss = 8.6630e-02, PNorm = 44.4849, GNorm = 1.8005, lr_0 = 4.8633e-04
Loss = 1.1210e-01, PNorm = 44.5013, GNorm = 0.6738, lr_0 = 4.7628e-04
Validation rmse = 0.130607
Validation r2 = 0.900000
Validation mse = 0.017058
Epoch 20
Loss = 1.1282e-01, PNorm = 44.5150, GNorm = 0.8016, lr_0 = 4.6643e-04
Loss = 1.0323e-01, PNorm = 44.5273, GNorm = 0.5909, lr_0 = 4.5678e-04
Validation rmse = 0.121839
Validation r2 = 0.912975
Validation mse = 0.014845
Epoch 21
Loss = 8.3748e-02, PNorm = 44.5417, GNorm = 0.8825, lr_0 = 4.4640e-04
Loss = 1.2151e-01, PNorm = 44.5573, GNorm = 1.8576, lr_0 = 4.3717e-04
Validation rmse = 0.129493
Validation r2 = 0.901698
Validation mse = 0.016768
Epoch 22
Loss = 1.2913e-01, PNorm = 44.5689, GNorm = 0.6640, lr_0 = 4.2813e-04
Loss = 1.2090e-01, PNorm = 44.5845, GNorm = 2.6157, lr_0 = 4.1928e-04
Validation rmse = 0.128781
Validation r2 = 0.902777
Validation mse = 0.016584
Epoch 23
Loss = 1.0465e-01, PNorm = 44.6000, GNorm = 1.7108, lr_0 = 4.0975e-04
Loss = 9.4281e-02, PNorm = 44.6140, GNorm = 0.9821, lr_0 = 4.0128e-04
Validation rmse = 0.114906
Validation r2 = 0.922598
Validation mse = 0.013203
Epoch 24
Loss = 9.0959e-02, PNorm = 44.6257, GNorm = 1.9771, lr_0 = 3.9298e-04
Loss = 8.9746e-02, PNorm = 44.6347, GNorm = 0.7203, lr_0 = 3.8486e-04
Validation rmse = 0.124778
Validation r2 = 0.908726
Validation mse = 0.015570
Epoch 25
Loss = 1.1053e-01, PNorm = 44.6479, GNorm = 3.6064, lr_0 = 3.7611e-04
Loss = 1.2392e-01, PNorm = 44.6616, GNorm = 0.5316, lr_0 = 3.6834e-04
Validation rmse = 0.120532
Validation r2 = 0.914832
Validation mse = 0.014528
Epoch 26
Loss = 1.0552e-01, PNorm = 44.6785, GNorm = 0.7208, lr_0 = 3.5997e-04
Loss = 8.2753e-02, PNorm = 44.6887, GNorm = 0.5979, lr_0 = 3.5252e-04
Validation rmse = 0.117042
Validation r2 = 0.919693
Validation mse = 0.013699
Epoch 27
Loss = 6.2693e-02, PNorm = 44.6996, GNorm = 0.6439, lr_0 = 3.4523e-04
Loss = 1.0378e-01, PNorm = 44.7106, GNorm = 1.9866, lr_0 = 3.3809e-04
Validation rmse = 0.138034
Validation r2 = 0.888302
Validation mse = 0.019053
Epoch 28
Loss = 9.3198e-02, PNorm = 44.7218, GNorm = 2.8906, lr_0 = 3.3041e-04
Loss = 9.5547e-02, PNorm = 44.7328, GNorm = 2.8728, lr_0 = 3.2358e-04
Validation rmse = 0.162798
Validation r2 = 0.844631
Validation mse = 0.026503
Epoch 29
Loss = 8.6672e-02, PNorm = 44.7432, GNorm = 0.7143, lr_0 = 3.1689e-04
Loss = 9.6223e-02, PNorm = 44.7543, GNorm = 1.9762, lr_0 = 3.1034e-04
Validation rmse = 0.111376
Validation r2 = 0.927281
Validation mse = 0.012405
Epoch 30
Loss = 6.8940e-02, PNorm = 44.7667, GNorm = 1.3198, lr_0 = 3.0329e-04
Loss = 1.0129e-01, PNorm = 44.7760, GNorm = 3.8816, lr_0 = 2.9701e-04
Validation rmse = 0.120067
Validation r2 = 0.915489
Validation mse = 0.014416
Epoch 31
Loss = 9.9055e-02, PNorm = 44.7885, GNorm = 0.6356, lr_0 = 2.9087e-04
Loss = 7.5914e-02, PNorm = 44.7985, GNorm = 2.7976, lr_0 = 2.8486e-04
Validation rmse = 0.125836
Validation r2 = 0.907173
Validation mse = 0.015835
Epoch 32
Loss = 8.1279e-02, PNorm = 44.8086, GNorm = 1.1392, lr_0 = 2.7839e-04
Loss = 7.7590e-02, PNorm = 44.8180, GNorm = 0.7115, lr_0 = 2.7263e-04
Loss = 4.3117e-02, PNorm = 44.8189, GNorm = 0.8396, lr_0 = 2.7206e-04
Validation rmse = 0.117366
Validation r2 = 0.919248
Validation mse = 0.013775
Epoch 33
Loss = 8.5080e-02, PNorm = 44.8273, GNorm = 1.7924, lr_0 = 2.6643e-04
Loss = 7.9153e-02, PNorm = 44.8357, GNorm = 2.4065, lr_0 = 2.6092e-04
Validation rmse = 0.125427
Validation r2 = 0.907775
Validation mse = 0.015732
Epoch 34
Loss = 7.2600e-02, PNorm = 44.8428, GNorm = 0.7665, lr_0 = 2.5553e-04
Validation rmse = 0.124552
Validation r2 = 0.909057
Validation mse = 0.015513
Epoch 35
Loss = 6.0087e-02, PNorm = 44.8537, GNorm = 1.4762, lr_0 = 2.4972e-04
Loss = 7.1970e-02, PNorm = 44.8632, GNorm = 0.5271, lr_0 = 2.4456e-04
Validation rmse = 0.120505
Validation r2 = 0.914871
Validation mse = 0.014521
Epoch 36
Loss = 5.8701e-02, PNorm = 44.8713, GNorm = 0.5836, lr_0 = 2.3950e-04
Loss = 7.0211e-02, PNorm = 44.8781, GNorm = 1.5800, lr_0 = 2.3455e-04
Validation rmse = 0.123902
Validation r2 = 0.910004
Validation mse = 0.015352
Epoch 37
Loss = 5.6812e-02, PNorm = 44.8884, GNorm = 0.7308, lr_0 = 2.2922e-04
Loss = 7.4306e-02, PNorm = 44.8966, GNorm = 1.7413, lr_0 = 2.2448e-04
Validation rmse = 0.113084
Validation r2 = 0.925033
Validation mse = 0.012788
Epoch 38
Loss = 5.2252e-02, PNorm = 44.9052, GNorm = 2.4059, lr_0 = 2.1938e-04
Loss = 8.0520e-02, PNorm = 44.9116, GNorm = 3.1959, lr_0 = 2.1484e-04
Validation rmse = 0.107797
Validation r2 = 0.931879
Validation mse = 0.011620
Epoch 39
Loss = 8.3689e-02, PNorm = 44.9210, GNorm = 2.2360, lr_0 = 2.1040e-04
Loss = 8.0997e-02, PNorm = 44.9297, GNorm = 1.8434, lr_0 = 2.0605e-04
Validation rmse = 0.127376
Validation r2 = 0.904886
Validation mse = 0.016225
Epoch 40
Loss = 6.7721e-02, PNorm = 44.9380, GNorm = 0.9097, lr_0 = 2.0137e-04
Loss = 7.2137e-02, PNorm = 44.9452, GNorm = 1.4002, lr_0 = 1.9721e-04
Validation rmse = 0.120762
Validation r2 = 0.914508
Validation mse = 0.014583
Epoch 41
Loss = 6.8419e-02, PNorm = 44.9516, GNorm = 0.4921, lr_0 = 1.9313e-04
Loss = 6.6289e-02, PNorm = 44.9600, GNorm = 1.1918, lr_0 = 1.8913e-04
Validation rmse = 0.118133
Validation r2 = 0.918188
Validation mse = 0.013956
Epoch 42
Loss = 5.0272e-02, PNorm = 44.9663, GNorm = 0.7260, lr_0 = 1.8484e-04
Loss = 6.7137e-02, PNorm = 44.9720, GNorm = 1.0052, lr_0 = 1.8101e-04
Validation rmse = 0.115755
Validation r2 = 0.921450
Validation mse = 0.013399
Epoch 43
Loss = 5.6550e-02, PNorm = 44.9789, GNorm = 0.8680, lr_0 = 1.7727e-04
Loss = 6.3354e-02, PNorm = 44.9858, GNorm = 1.8806, lr_0 = 1.7361e-04
Validation rmse = 0.121577
Validation r2 = 0.913349
Validation mse = 0.014781
Epoch 44
Loss = 5.9587e-02, PNorm = 44.9937, GNorm = 0.7483, lr_0 = 1.6966e-04
Loss = 6.1988e-02, PNorm = 45.0001, GNorm = 1.2543, lr_0 = 1.6615e-04
Validation rmse = 0.122701
Validation r2 = 0.911740
Validation mse = 0.015055
Epoch 45
Loss = 5.7985e-02, PNorm = 45.0062, GNorm = 0.9126, lr_0 = 1.6238e-04
Loss = 6.3193e-02, PNorm = 45.0120, GNorm = 1.9445, lr_0 = 1.5902e-04
Validation rmse = 0.117679
Validation r2 = 0.918817
Validation mse = 0.013848
Epoch 46
Loss = 5.3113e-02, PNorm = 45.0175, GNorm = 0.8214, lr_0 = 1.5573e-04
Loss = 6.4566e-02, PNorm = 45.0229, GNorm = 0.8475, lr_0 = 1.5251e-04
Validation rmse = 0.116564
Validation r2 = 0.920348
Validation mse = 0.013587
Epoch 47
Loss = 5.6472e-02, PNorm = 45.0299, GNorm = 1.5670, lr_0 = 1.4905e-04
Loss = 6.2579e-02, PNorm = 45.0356, GNorm = 1.1398, lr_0 = 1.4596e-04
Validation rmse = 0.105267
Validation r2 = 0.935039
Validation mse = 0.011081
Epoch 48
Loss = 6.1538e-02, PNorm = 45.0403, GNorm = 0.6230, lr_0 = 1.4295e-04
Loss = 6.0147e-02, PNorm = 45.0454, GNorm = 0.7912, lr_0 = 1.3999e-04
Validation rmse = 0.112064
Validation r2 = 0.926380
Validation mse = 0.012558
Epoch 49
Loss = 5.9580e-02, PNorm = 45.0511, GNorm = 1.9891, lr_0 = 1.3681e-04
Loss = 6.1329e-02, PNorm = 45.0562, GNorm = 0.9753, lr_0 = 1.3398e-04
Validation rmse = 0.121948
Validation r2 = 0.912820
Validation mse = 0.014871
Epoch 50
Loss = 5.7950e-02, PNorm = 45.0629, GNorm = 0.6917, lr_0 = 1.3121e-04
Loss = 5.6330e-02, PNorm = 45.0670, GNorm = 0.6808, lr_0 = 1.2850e-04
Loss = 8.9152e-02, PNorm = 45.0675, GNorm = 1.7135, lr_0 = 1.2823e-04
Validation rmse = 0.111581
Validation r2 = 0.927012
Validation mse = 0.012450
Epoch 51
Loss = 5.4826e-02, PNorm = 45.0728, GNorm = 0.8163, lr_0 = 1.2558e-04
Validation rmse = 0.121518
Validation r2 = 0.913434
Validation mse = 0.014767
Epoch 52
Loss = 6.3135e-02, PNorm = 45.0783, GNorm = 0.7795, lr_0 = 1.2272e-04
Loss = 5.7811e-02, PNorm = 45.0824, GNorm = 2.0298, lr_0 = 1.2019e-04
Validation rmse = 0.127840
Validation r2 = 0.904193
Validation mse = 0.016343
Epoch 53
Loss = 7.8194e-02, PNorm = 45.0865, GNorm = 3.0106, lr_0 = 1.1770e-04
Loss = 5.1044e-02, PNorm = 45.0917, GNorm = 0.3987, lr_0 = 1.1527e-04
Validation rmse = 0.107590
Validation r2 = 0.932140
Validation mse = 0.011576
Epoch 54
Loss = 6.9726e-02, PNorm = 45.0970, GNorm = 2.6635, lr_0 = 1.1265e-04
Loss = 5.8231e-02, PNorm = 45.1018, GNorm = 0.4298, lr_0 = 1.1032e-04
Validation rmse = 0.112479
Validation r2 = 0.925833
Validation mse = 0.012652
Epoch 55
Loss = 7.0986e-02, PNorm = 45.1058, GNorm = 0.8559, lr_0 = 1.0804e-04
Loss = 4.9913e-02, PNorm = 45.1102, GNorm = 0.3976, lr_0 = 1.0580e-04
Validation rmse = 0.114121
Validation r2 = 0.923651
Validation mse = 0.013024
Epoch 56
Loss = 4.1913e-02, PNorm = 45.1139, GNorm = 0.5417, lr_0 = 1.0340e-04
Loss = 5.5013e-02, PNorm = 45.1175, GNorm = 0.8867, lr_0 = 1.0126e-04
Validation rmse = 0.121310
Validation r2 = 0.913729
Validation mse = 0.014716
Epoch 57
Loss = 4.8038e-02, PNorm = 45.1224, GNorm = 1.7884, lr_0 = 1.0000e-04
Loss = 5.6911e-02, PNorm = 45.1258, GNorm = 1.9702, lr_0 = 1.0000e-04
Validation rmse = 0.112513
Validation r2 = 0.925787
Validation mse = 0.012659
Epoch 58
Loss = 4.5518e-02, PNorm = 45.1300, GNorm = 0.6905, lr_0 = 1.0000e-04
Loss = 4.9147e-02, PNorm = 45.1345, GNorm = 0.7100, lr_0 = 1.0000e-04
Validation rmse = 0.123882
Validation r2 = 0.910033
Validation mse = 0.015347
Epoch 59
Loss = 5.0199e-02, PNorm = 45.1385, GNorm = 0.7755, lr_0 = 1.0000e-04
Loss = 4.8505e-02, PNorm = 45.1429, GNorm = 2.4554, lr_0 = 1.0000e-04
Validation rmse = 0.103631
Validation r2 = 0.937042
Validation mse = 0.010739
Model 0 best validation rmse = 0.103631 on epoch 59
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.522105
Model 0 test r2 = -5.468904
Model 0 test mse = 0.272593
Ensemble test rmse = 0.522105
Ensemble test r2 = -5.468904
Ensemble test mse = 0.272593
10-fold cross validation
	Seed 0 ==> test rmse = 0.458819
	Seed 0 ==> test r2 = -3.995727
	Seed 0 ==> test mse = 0.210515
	Seed 1 ==> test rmse = 0.508819
	Seed 1 ==> test r2 = -5.143881
	Seed 1 ==> test mse = 0.258897
	Seed 2 ==> test rmse = 0.540366
	Seed 2 ==> test r2 = -5.929345
	Seed 2 ==> test mse = 0.291996
	Seed 3 ==> test rmse = 0.462963
	Seed 3 ==> test r2 = -4.086376
	Seed 3 ==> test mse = 0.214335
	Seed 4 ==> test rmse = 0.520973
	Seed 4 ==> test r2 = -5.440907
	Seed 4 ==> test mse = 0.271413
	Seed 5 ==> test rmse = 0.499901
	Seed 5 ==> test r2 = -4.930408
	Seed 5 ==> test mse = 0.249901
	Seed 6 ==> test rmse = 0.548968
	Seed 6 ==> test r2 = -6.151715
	Seed 6 ==> test mse = 0.301366
	Seed 7 ==> test rmse = 0.610362
	Seed 7 ==> test r2 = -7.840797
	Seed 7 ==> test mse = 0.372542
	Seed 8 ==> test rmse = 0.540338
	Seed 8 ==> test r2 = -5.928620
	Seed 8 ==> test mse = 0.291965
	Seed 9 ==> test rmse = 0.522105
	Seed 9 ==> test r2 = -5.468904
	Seed 9 ==> test mse = 0.272593
Overall test rmse = 0.521362 +/- 0.041647
Overall test r2 = -5.491668 +/- 1.048251
Overall test mse = 0.273552 +/- 0.044172
Elapsed time = 0:07:20
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-05d85262-3219-459a-86b2-5360cba4da72.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/MeTHF_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2', 'mse'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2', 'mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/MeTHF_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/MeTHF_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 973 | train size = 963 | val size = 10 | test size = 59
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 8.9907e-01, PNorm = 43.2640, GNorm = 8.0752, lr_0 = 3.6053e-04
Validation rmse = 0.279257
Validation r2 = 0.462950
Validation mse = 0.077984
Epoch 1
Loss = 6.3402e-01, PNorm = 43.2875, GNorm = 5.9908, lr_0 = 6.2105e-04
Loss = 5.7998e-01, PNorm = 43.3346, GNorm = 0.7649, lr_0 = 8.5789e-04
Validation rmse = 0.300211
Validation r2 = 0.379330
Validation mse = 0.090127
Epoch 2
Loss = 6.9444e-01, PNorm = 43.4042, GNorm = 2.7333, lr_0 = 9.8961e-04
Loss = 5.3731e-01, PNorm = 43.4920, GNorm = 4.5787, lr_0 = 9.6914e-04
Validation rmse = 0.268600
Validation r2 = 0.503155
Validation mse = 0.072146
Epoch 3
Loss = 5.2166e-01, PNorm = 43.5823, GNorm = 2.8910, lr_0 = 9.4712e-04
Loss = 3.0655e-01, PNorm = 43.6588, GNorm = 2.1465, lr_0 = 9.2754e-04
Validation rmse = 0.147843
Validation r2 = 0.849474
Validation mse = 0.021858
Epoch 4
Loss = 4.1254e-01, PNorm = 43.7150, GNorm = 1.0991, lr_0 = 9.0836e-04
Loss = 2.9524e-01, PNorm = 43.7682, GNorm = 1.9273, lr_0 = 8.8958e-04
Validation rmse = 0.121465
Validation r2 = 0.898396
Validation mse = 0.014754
Epoch 5
Loss = 2.1827e-01, PNorm = 43.8222, GNorm = 2.5695, lr_0 = 8.6936e-04
Loss = 1.9107e-01, PNorm = 43.8627, GNorm = 2.0022, lr_0 = 8.5139e-04
Validation rmse = 0.129738
Validation r2 = 0.884085
Validation mse = 0.016832
Epoch 6
Loss = 1.7396e-01, PNorm = 43.9024, GNorm = 2.0162, lr_0 = 8.3204e-04
Loss = 1.7559e-01, PNorm = 43.9288, GNorm = 3.6386, lr_0 = 8.1484e-04
Validation rmse = 0.145792
Validation r2 = 0.853622
Validation mse = 0.021255
Epoch 7
Loss = 1.8745e-01, PNorm = 43.9633, GNorm = 4.2705, lr_0 = 7.9632e-04
Loss = 1.5740e-01, PNorm = 43.9894, GNorm = 3.9409, lr_0 = 7.7986e-04
Validation rmse = 0.133368
Validation r2 = 0.877508
Validation mse = 0.017787
Epoch 8
Loss = 1.3765e-01, PNorm = 44.0152, GNorm = 2.4109, lr_0 = 7.6373e-04
Loss = 1.4949e-01, PNorm = 44.0417, GNorm = 2.2603, lr_0 = 7.4794e-04
Validation rmse = 0.144842
Validation r2 = 0.855524
Validation mse = 0.020979
Epoch 9
Loss = 1.2510e-01, PNorm = 44.0665, GNorm = 1.3265, lr_0 = 7.3094e-04
Loss = 1.4381e-01, PNorm = 44.0895, GNorm = 2.6507, lr_0 = 7.1583e-04
Validation rmse = 0.133052
Validation r2 = 0.878086
Validation mse = 0.017703
Epoch 10
Loss = 1.0714e-01, PNorm = 44.1118, GNorm = 2.2176, lr_0 = 6.9956e-04
Loss = 1.2742e-01, PNorm = 44.1337, GNorm = 1.4757, lr_0 = 6.8510e-04
Validation rmse = 0.123714
Validation r2 = 0.894598
Validation mse = 0.015305
Epoch 11
Loss = 1.0660e-01, PNorm = 44.1518, GNorm = 2.4219, lr_0 = 6.6953e-04
Loss = 1.2573e-01, PNorm = 44.1676, GNorm = 4.1852, lr_0 = 6.5569e-04
Validation rmse = 0.129093
Validation r2 = 0.885235
Validation mse = 0.016665
Epoch 12
Loss = 1.1668e-01, PNorm = 44.1853, GNorm = 2.9637, lr_0 = 6.4213e-04
Loss = 1.1358e-01, PNorm = 44.2013, GNorm = 1.2711, lr_0 = 6.2885e-04
Loss = 1.2684e-01, PNorm = 44.2042, GNorm = 3.6971, lr_0 = 6.2754e-04
Validation rmse = 0.126440
Validation r2 = 0.889902
Validation mse = 0.015987
Epoch 13
Loss = 1.1044e-01, PNorm = 44.2272, GNorm = 1.7103, lr_0 = 6.1456e-04
Validation rmse = 0.124226
Validation r2 = 0.893724
Validation mse = 0.015432
Epoch 14
Loss = 1.0082e-01, PNorm = 44.2462, GNorm = 0.9937, lr_0 = 6.0060e-04
Loss = 1.0776e-01, PNorm = 44.2661, GNorm = 3.0160, lr_0 = 5.8818e-04
Validation rmse = 0.122433
Validation r2 = 0.896771
Validation mse = 0.014990
Epoch 15
Loss = 9.5209e-02, PNorm = 44.2830, GNorm = 1.8905, lr_0 = 5.7482e-04
Loss = 9.6285e-02, PNorm = 44.2999, GNorm = 0.6800, lr_0 = 5.6293e-04
Validation rmse = 0.156341
Validation r2 = 0.831674
Validation mse = 0.024442
Epoch 16
Loss = 2.1022e-01, PNorm = 44.3181, GNorm = 7.3345, lr_0 = 5.5129e-04
Loss = 1.1425e-01, PNorm = 44.3422, GNorm = 2.2601, lr_0 = 5.3989e-04
Validation rmse = 0.137009
Validation r2 = 0.870727
Validation mse = 0.018772
Epoch 17
Loss = 1.3817e-01, PNorm = 44.3630, GNorm = 3.3226, lr_0 = 5.2762e-04
Loss = 9.6029e-02, PNorm = 44.3849, GNorm = 0.7229, lr_0 = 5.1671e-04
Validation rmse = 0.152123
Validation r2 = 0.840632
Validation mse = 0.023142
Epoch 18
Loss = 8.2173e-02, PNorm = 44.4018, GNorm = 1.2481, lr_0 = 5.0497e-04
Loss = 9.7810e-02, PNorm = 44.4154, GNorm = 2.0566, lr_0 = 4.9453e-04
Validation rmse = 0.117894
Validation r2 = 0.904282
Validation mse = 0.013899
Epoch 19
Loss = 9.2777e-02, PNorm = 44.4283, GNorm = 0.8641, lr_0 = 4.8329e-04
Loss = 8.7920e-02, PNorm = 44.4426, GNorm = 2.4619, lr_0 = 4.7330e-04
Validation rmse = 0.132321
Validation r2 = 0.879422
Validation mse = 0.017509
Epoch 20
Loss = 7.6848e-02, PNorm = 44.4526, GNorm = 1.3262, lr_0 = 4.6351e-04
Loss = 9.1923e-02, PNorm = 44.4641, GNorm = 1.3131, lr_0 = 4.5393e-04
Validation rmse = 0.117102
Validation r2 = 0.905564
Validation mse = 0.013713
Epoch 21
Loss = 9.8803e-02, PNorm = 44.4791, GNorm = 3.6035, lr_0 = 4.4361e-04
Loss = 9.5602e-02, PNorm = 44.4890, GNorm = 1.1623, lr_0 = 4.3444e-04
Validation rmse = 0.129378
Validation r2 = 0.884726
Validation mse = 0.016739
Epoch 22
Loss = 7.7321e-02, PNorm = 44.4995, GNorm = 0.8774, lr_0 = 4.2457e-04
Loss = 8.1365e-02, PNorm = 44.5103, GNorm = 0.8406, lr_0 = 4.1579e-04
Validation rmse = 0.119269
Validation r2 = 0.902037
Validation mse = 0.014225
Epoch 23
Loss = 8.2564e-02, PNorm = 44.5252, GNorm = 0.7227, lr_0 = 4.0634e-04
Loss = 9.3716e-02, PNorm = 44.5354, GNorm = 0.6044, lr_0 = 3.9794e-04
Validation rmse = 0.143585
Validation r2 = 0.858020
Validation mse = 0.020617
Epoch 24
Loss = 8.4257e-02, PNorm = 44.5467, GNorm = 0.9610, lr_0 = 3.8971e-04
Loss = 8.7855e-02, PNorm = 44.5623, GNorm = 2.1695, lr_0 = 3.8165e-04
Validation rmse = 0.143090
Validation r2 = 0.858997
Validation mse = 0.020475
Epoch 25
Loss = 8.0801e-02, PNorm = 44.5750, GNorm = 0.8202, lr_0 = 3.7298e-04
Loss = 7.3757e-02, PNorm = 44.5850, GNorm = 0.7979, lr_0 = 3.6527e-04
Loss = 7.5272e-02, PNorm = 44.5860, GNorm = 0.9938, lr_0 = 3.6451e-04
Validation rmse = 0.128706
Validation r2 = 0.885920
Validation mse = 0.016565
Epoch 26
Loss = 7.5430e-02, PNorm = 44.5975, GNorm = 2.4254, lr_0 = 3.5697e-04
Loss = 8.2850e-02, PNorm = 44.6069, GNorm = 4.0110, lr_0 = 3.4959e-04
Validation rmse = 0.134137
Validation r2 = 0.876091
Validation mse = 0.017993
Epoch 27
Loss = 8.4156e-02, PNorm = 44.6184, GNorm = 0.5050, lr_0 = 3.4236e-04
Validation rmse = 0.133399
Validation r2 = 0.877451
Validation mse = 0.017795
Epoch 28
Loss = 6.0831e-02, PNorm = 44.6335, GNorm = 1.5847, lr_0 = 3.3458e-04
Loss = 8.3912e-02, PNorm = 44.6443, GNorm = 0.4893, lr_0 = 3.2766e-04
Validation rmse = 0.126182
Validation r2 = 0.890351
Validation mse = 0.015922
Epoch 29
Loss = 4.6628e-02, PNorm = 44.6538, GNorm = 0.8607, lr_0 = 3.2022e-04
Loss = 7.2867e-02, PNorm = 44.6623, GNorm = 1.8694, lr_0 = 3.1360e-04
Validation rmse = 0.126785
Validation r2 = 0.889301
Validation mse = 0.016074
Epoch 30
Loss = 6.3885e-02, PNorm = 44.6698, GNorm = 1.6762, lr_0 = 3.0647e-04
Loss = 7.3713e-02, PNorm = 44.6777, GNorm = 0.5366, lr_0 = 3.0013e-04
Validation rmse = 0.136523
Validation r2 = 0.871642
Validation mse = 0.018639
Epoch 31
Loss = 1.0180e-01, PNorm = 44.6861, GNorm = 1.0933, lr_0 = 2.9393e-04
Loss = 7.0609e-02, PNorm = 44.6958, GNorm = 0.8382, lr_0 = 2.8785e-04
Validation rmse = 0.136724
Validation r2 = 0.871264
Validation mse = 0.018693
Epoch 32
Loss = 7.3955e-02, PNorm = 44.7067, GNorm = 1.7601, lr_0 = 2.8131e-04
Loss = 6.6809e-02, PNorm = 44.7158, GNorm = 0.4802, lr_0 = 2.7549e-04
Validation rmse = 0.134212
Validation r2 = 0.875951
Validation mse = 0.018013
Epoch 33
Loss = 6.1722e-02, PNorm = 44.7234, GNorm = 1.2273, lr_0 = 2.6923e-04
Loss = 6.3944e-02, PNorm = 44.7312, GNorm = 0.5353, lr_0 = 2.6367e-04
Validation rmse = 0.136751
Validation r2 = 0.871214
Validation mse = 0.018701
Epoch 34
Loss = 7.1482e-02, PNorm = 44.7404, GNorm = 0.5984, lr_0 = 2.5767e-04
Loss = 6.7226e-02, PNorm = 44.7499, GNorm = 1.5775, lr_0 = 2.5235e-04
Validation rmse = 0.134582
Validation r2 = 0.875267
Validation mse = 0.018112
Epoch 35
Loss = 6.9977e-02, PNorm = 44.7587, GNorm = 0.6519, lr_0 = 2.4713e-04
Loss = 6.2515e-02, PNorm = 44.7662, GNorm = 0.5060, lr_0 = 2.4202e-04
Validation rmse = 0.128701
Validation r2 = 0.885930
Validation mse = 0.016564
Epoch 36
Loss = 5.4626e-02, PNorm = 44.7740, GNorm = 1.3901, lr_0 = 2.3652e-04
Loss = 6.9541e-02, PNorm = 44.7808, GNorm = 1.6192, lr_0 = 2.3163e-04
Validation rmse = 0.128367
Validation r2 = 0.886522
Validation mse = 0.016478
Epoch 37
Loss = 5.7204e-02, PNorm = 44.7880, GNorm = 0.4088, lr_0 = 2.2637e-04
Loss = 6.9163e-02, PNorm = 44.7960, GNorm = 1.4187, lr_0 = 2.2168e-04
Validation rmse = 0.129550
Validation r2 = 0.884420
Validation mse = 0.016783
Epoch 38
Loss = 6.1368e-02, PNorm = 44.8037, GNorm = 2.1347, lr_0 = 2.1665e-04
Loss = 6.5842e-02, PNorm = 44.8104, GNorm = 2.1675, lr_0 = 2.1217e-04
Validation rmse = 0.135341
Validation r2 = 0.873856
Validation mse = 0.018317
Epoch 39
Loss = 6.4863e-02, PNorm = 44.8178, GNorm = 1.6890, lr_0 = 2.0778e-04
Loss = 6.4646e-02, PNorm = 44.8261, GNorm = 0.8886, lr_0 = 2.0348e-04
Loss = 5.7960e-02, PNorm = 44.8267, GNorm = 1.2912, lr_0 = 2.0306e-04
Validation rmse = 0.152870
Validation r2 = 0.839064
Validation mse = 0.023369
Epoch 40
Loss = 8.1364e-02, PNorm = 44.8324, GNorm = 1.2473, lr_0 = 1.9886e-04
Validation rmse = 0.131044
Validation r2 = 0.881739
Validation mse = 0.017173
Epoch 41
Loss = 4.7644e-02, PNorm = 44.8415, GNorm = 1.3360, lr_0 = 1.9434e-04
Loss = 6.2849e-02, PNorm = 44.8496, GNorm = 1.4136, lr_0 = 1.9032e-04
Validation rmse = 0.141478
Validation r2 = 0.862157
Validation mse = 0.020016
Epoch 42
Loss = 5.9442e-02, PNorm = 44.8573, GNorm = 1.1179, lr_0 = 1.8600e-04
Loss = 6.4120e-02, PNorm = 44.8634, GNorm = 0.5529, lr_0 = 1.8215e-04
Validation rmse = 0.124006
Validation r2 = 0.894100
Validation mse = 0.015378
Epoch 43
Loss = 4.6735e-02, PNorm = 44.8695, GNorm = 1.1161, lr_0 = 1.7839e-04
Loss = 6.1559e-02, PNorm = 44.8747, GNorm = 0.9239, lr_0 = 1.7470e-04
Validation rmse = 0.132562
Validation r2 = 0.878983
Validation mse = 0.017573
Epoch 44
Loss = 5.3249e-02, PNorm = 44.8805, GNorm = 0.4981, lr_0 = 1.7073e-04
Loss = 5.9614e-02, PNorm = 44.8863, GNorm = 1.2901, lr_0 = 1.6720e-04
Validation rmse = 0.135137
Validation r2 = 0.874236
Validation mse = 0.018262
Epoch 45
Loss = 5.9827e-02, PNorm = 44.8917, GNorm = 1.1362, lr_0 = 1.6340e-04
Loss = 5.9524e-02, PNorm = 44.8968, GNorm = 1.1103, lr_0 = 1.6002e-04
Validation rmse = 0.127772
Validation r2 = 0.887571
Validation mse = 0.016326
Epoch 46
Loss = 5.1521e-02, PNorm = 44.9017, GNorm = 0.4753, lr_0 = 1.5638e-04
Loss = 5.2438e-02, PNorm = 44.9064, GNorm = 0.2616, lr_0 = 1.5315e-04
Validation rmse = 0.129631
Validation r2 = 0.884275
Validation mse = 0.016804
Epoch 47
Loss = 5.7599e-02, PNorm = 44.9126, GNorm = 1.0716, lr_0 = 1.4998e-04
Loss = 5.1252e-02, PNorm = 44.9185, GNorm = 0.9075, lr_0 = 1.4688e-04
Validation rmse = 0.121620
Validation r2 = 0.898136
Validation mse = 0.014791
Epoch 48
Loss = 5.4132e-02, PNorm = 44.9236, GNorm = 0.5488, lr_0 = 1.4354e-04
Loss = 5.4303e-02, PNorm = 44.9285, GNorm = 1.3580, lr_0 = 1.4058e-04
Validation rmse = 0.123945
Validation r2 = 0.894206
Validation mse = 0.015362
Epoch 49
Loss = 5.1515e-02, PNorm = 44.9344, GNorm = 0.6996, lr_0 = 1.3738e-04
Loss = 5.0314e-02, PNorm = 44.9394, GNorm = 0.6419, lr_0 = 1.3454e-04
Validation rmse = 0.124403
Validation r2 = 0.893422
Validation mse = 0.015476
Epoch 50
Loss = 4.7367e-02, PNorm = 44.9446, GNorm = 0.9028, lr_0 = 1.3176e-04
Loss = 5.3542e-02, PNorm = 44.9494, GNorm = 1.3054, lr_0 = 1.2904e-04
Validation rmse = 0.126801
Validation r2 = 0.889272
Validation mse = 0.016079
Epoch 51
Loss = 4.5597e-02, PNorm = 44.9548, GNorm = 1.0676, lr_0 = 1.2610e-04
Loss = 5.1225e-02, PNorm = 44.9595, GNorm = 0.7443, lr_0 = 1.2350e-04
Validation rmse = 0.125458
Validation r2 = 0.891607
Validation mse = 0.015740
Epoch 52
Loss = 4.3776e-02, PNorm = 44.9640, GNorm = 1.0121, lr_0 = 1.2069e-04
Loss = 5.5153e-02, PNorm = 44.9683, GNorm = 1.9536, lr_0 = 1.1819e-04
Loss = 2.9921e-02, PNorm = 44.9689, GNorm = 1.2610, lr_0 = 1.1795e-04
Validation rmse = 0.123218
Validation r2 = 0.895442
Validation mse = 0.015183
Epoch 53
Loss = 4.6901e-02, PNorm = 44.9726, GNorm = 1.1158, lr_0 = 1.1551e-04
Loss = 5.2779e-02, PNorm = 44.9769, GNorm = 2.5507, lr_0 = 1.1312e-04
Validation rmse = 0.133544
Validation r2 = 0.877183
Validation mse = 0.017834
Epoch 54
Loss = 5.3383e-02, PNorm = 44.9814, GNorm = 1.1785, lr_0 = 1.1078e-04
Validation rmse = 0.123098
Validation r2 = 0.895645
Validation mse = 0.015153
Epoch 55
Loss = 5.4187e-02, PNorm = 44.9860, GNorm = 0.8777, lr_0 = 1.0826e-04
Loss = 4.7428e-02, PNorm = 44.9898, GNorm = 1.5533, lr_0 = 1.0603e-04
Validation rmse = 0.125954
Validation r2 = 0.890747
Validation mse = 0.015864
Epoch 56
Loss = 4.8738e-02, PNorm = 44.9940, GNorm = 1.0447, lr_0 = 1.0362e-04
Loss = 4.7267e-02, PNorm = 44.9968, GNorm = 0.9336, lr_0 = 1.0147e-04
Validation rmse = 0.123012
Validation r2 = 0.895791
Validation mse = 0.015132
Epoch 57
Loss = 4.6053e-02, PNorm = 45.0016, GNorm = 1.5902, lr_0 = 1.0000e-04
Loss = 5.3089e-02, PNorm = 45.0054, GNorm = 1.6525, lr_0 = 1.0000e-04
Validation rmse = 0.124406
Validation r2 = 0.893417
Validation mse = 0.015477
Epoch 58
Loss = 3.5971e-02, PNorm = 45.0092, GNorm = 1.2294, lr_0 = 1.0000e-04
Loss = 5.0301e-02, PNorm = 45.0128, GNorm = 3.1194, lr_0 = 1.0000e-04
Validation rmse = 0.125746
Validation r2 = 0.891107
Validation mse = 0.015812
Epoch 59
Loss = 4.2643e-02, PNorm = 45.0172, GNorm = 0.9955, lr_0 = 1.0000e-04
Loss = 5.4079e-02, PNorm = 45.0205, GNorm = 0.6067, lr_0 = 1.0000e-04
Validation rmse = 0.125570
Validation r2 = 0.891413
Validation mse = 0.015768
Model 0 best validation rmse = 0.117102 on epoch 20
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.192762
Model 0 test r2 = 0.457287
Model 0 test mse = 0.037157
Ensemble test rmse = 0.192762
Ensemble test r2 = 0.457287
Ensemble test mse = 0.037157
Fold 1
Splitting data with seed 1
Total size = 973 | train size = 963 | val size = 10 | test size = 59
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.8599e-01, PNorm = 43.2601, GNorm = 4.5419, lr_0 = 3.6053e-04
Validation rmse = 0.194422
Validation r2 = 0.388788
Validation mse = 0.037800
Epoch 1
Loss = 8.5459e-01, PNorm = 43.2836, GNorm = 1.7062, lr_0 = 6.2105e-04
Loss = 6.5720e-01, PNorm = 43.3324, GNorm = 8.0243, lr_0 = 8.5789e-04
Validation rmse = 0.183817
Validation r2 = 0.453646
Validation mse = 0.033789
Epoch 2
Loss = 3.8254e-01, PNorm = 43.4173, GNorm = 2.9389, lr_0 = 9.8961e-04
Loss = 4.8418e-01, PNorm = 43.4976, GNorm = 5.8264, lr_0 = 9.6914e-04
Validation rmse = 0.202648
Validation r2 = 0.335971
Validation mse = 0.041066
Epoch 3
Loss = 3.6453e-01, PNorm = 43.5796, GNorm = 8.2525, lr_0 = 9.4712e-04
Loss = 3.1570e-01, PNorm = 43.6445, GNorm = 3.0210, lr_0 = 9.2754e-04
Validation rmse = 0.189751
Validation r2 = 0.417799
Validation mse = 0.036006
Epoch 4
Loss = 2.6252e-01, PNorm = 43.7038, GNorm = 0.6693, lr_0 = 9.0836e-04
Loss = 2.8582e-01, PNorm = 43.7605, GNorm = 3.5679, lr_0 = 8.8958e-04
Validation rmse = 0.205954
Validation r2 = 0.314130
Validation mse = 0.042417
Epoch 5
Loss = 2.2295e-01, PNorm = 43.8161, GNorm = 4.0425, lr_0 = 8.6936e-04
Loss = 2.3706e-01, PNorm = 43.8573, GNorm = 3.3182, lr_0 = 8.5139e-04
Validation rmse = 0.137954
Validation r2 = 0.692268
Validation mse = 0.019031
Epoch 6
Loss = 1.7815e-01, PNorm = 43.8950, GNorm = 2.1885, lr_0 = 8.3204e-04
Loss = 1.7336e-01, PNorm = 43.9293, GNorm = 3.5960, lr_0 = 8.1484e-04
Validation rmse = 0.161194
Validation r2 = 0.579854
Validation mse = 0.025983
Epoch 7
Loss = 1.4777e-01, PNorm = 43.9633, GNorm = 1.0802, lr_0 = 7.9632e-04
Loss = 1.3497e-01, PNorm = 43.9839, GNorm = 1.9206, lr_0 = 7.7986e-04
Validation rmse = 0.136523
Validation r2 = 0.698620
Validation mse = 0.018639
Epoch 8
Loss = 1.5701e-01, PNorm = 44.0071, GNorm = 1.1973, lr_0 = 7.6373e-04
Loss = 1.2675e-01, PNorm = 44.0333, GNorm = 2.0462, lr_0 = 7.4794e-04
Validation rmse = 0.152222
Validation r2 = 0.625322
Validation mse = 0.023172
Epoch 9
Loss = 1.3854e-01, PNorm = 44.0571, GNorm = 1.3202, lr_0 = 7.3094e-04
Loss = 1.2363e-01, PNorm = 44.0774, GNorm = 0.7487, lr_0 = 7.1583e-04
Validation rmse = 0.137180
Validation r2 = 0.695714
Validation mse = 0.018818
Epoch 10
Loss = 1.3001e-01, PNorm = 44.0929, GNorm = 1.8058, lr_0 = 6.9956e-04
Loss = 1.2762e-01, PNorm = 44.1166, GNorm = 0.8315, lr_0 = 6.8510e-04
Validation rmse = 0.144054
Validation r2 = 0.664455
Validation mse = 0.020751
Epoch 11
Loss = 1.0319e-01, PNorm = 44.1347, GNorm = 1.5940, lr_0 = 6.6953e-04
Loss = 1.1893e-01, PNorm = 44.1502, GNorm = 1.3376, lr_0 = 6.5569e-04
Validation rmse = 0.145046
Validation r2 = 0.659816
Validation mse = 0.021038
Epoch 12
Loss = 1.2045e-01, PNorm = 44.1666, GNorm = 1.2516, lr_0 = 6.4213e-04
Loss = 1.0490e-01, PNorm = 44.1874, GNorm = 1.5640, lr_0 = 6.2885e-04
Loss = 1.0942e-01, PNorm = 44.1892, GNorm = 1.5808, lr_0 = 6.2754e-04
Validation rmse = 0.132085
Validation r2 = 0.717897
Validation mse = 0.017446
Epoch 13
Loss = 9.9731e-02, PNorm = 44.2066, GNorm = 1.0580, lr_0 = 6.1456e-04
Validation rmse = 0.106088
Validation r2 = 0.818014
Validation mse = 0.011255
Epoch 14
Loss = 4.5973e-02, PNorm = 44.2260, GNorm = 1.4577, lr_0 = 6.0060e-04
Loss = 9.9939e-02, PNorm = 44.2444, GNorm = 2.2760, lr_0 = 5.8818e-04
Validation rmse = 0.160011
Validation r2 = 0.585996
Validation mse = 0.025604
Epoch 15
Loss = 1.2901e-01, PNorm = 44.2625, GNorm = 2.5446, lr_0 = 5.7482e-04
Loss = 1.1394e-01, PNorm = 44.2801, GNorm = 1.9161, lr_0 = 5.6293e-04
Validation rmse = 0.121221
Validation r2 = 0.762393
Validation mse = 0.014695
Epoch 16
Loss = 1.1903e-01, PNorm = 44.2980, GNorm = 1.5886, lr_0 = 5.5129e-04
Loss = 1.0294e-01, PNorm = 44.3122, GNorm = 1.8073, lr_0 = 5.3989e-04
Validation rmse = 0.135881
Validation r2 = 0.701448
Validation mse = 0.018464
Epoch 17
Loss = 8.4073e-02, PNorm = 44.3300, GNorm = 1.4046, lr_0 = 5.2762e-04
Loss = 9.7954e-02, PNorm = 44.3466, GNorm = 2.6733, lr_0 = 5.1671e-04
Validation rmse = 0.117202
Validation r2 = 0.777887
Validation mse = 0.013736
Epoch 18
Loss = 9.0989e-02, PNorm = 44.3616, GNorm = 0.8266, lr_0 = 5.0497e-04
Loss = 9.2741e-02, PNorm = 44.3766, GNorm = 0.4253, lr_0 = 4.9453e-04
Validation rmse = 0.124025
Validation r2 = 0.751275
Validation mse = 0.015382
Epoch 19
Loss = 9.6959e-02, PNorm = 44.3946, GNorm = 2.5860, lr_0 = 4.8329e-04
Loss = 9.3122e-02, PNorm = 44.4120, GNorm = 1.2425, lr_0 = 4.7330e-04
Validation rmse = 0.110802
Validation r2 = 0.801482
Validation mse = 0.012277
Epoch 20
Loss = 8.5463e-02, PNorm = 44.4241, GNorm = 1.0546, lr_0 = 4.6351e-04
Loss = 8.1612e-02, PNorm = 44.4380, GNorm = 2.3947, lr_0 = 4.5393e-04
Validation rmse = 0.139052
Validation r2 = 0.687353
Validation mse = 0.019335
Epoch 21
Loss = 8.2532e-02, PNorm = 44.4538, GNorm = 2.0614, lr_0 = 4.4361e-04
Loss = 8.7099e-02, PNorm = 44.4680, GNorm = 0.6024, lr_0 = 4.3444e-04
Validation rmse = 0.108645
Validation r2 = 0.809136
Validation mse = 0.011804
Epoch 22
Loss = 7.0022e-02, PNorm = 44.4836, GNorm = 1.2284, lr_0 = 4.2457e-04
Loss = 9.0415e-02, PNorm = 44.4980, GNorm = 1.0762, lr_0 = 4.1579e-04
Validation rmse = 0.115185
Validation r2 = 0.785468
Validation mse = 0.013267
Epoch 23
Loss = 8.8188e-02, PNorm = 44.5136, GNorm = 1.6323, lr_0 = 4.0634e-04
Loss = 9.0750e-02, PNorm = 44.5284, GNorm = 1.9816, lr_0 = 3.9794e-04
Validation rmse = 0.097296
Validation r2 = 0.846930
Validation mse = 0.009466
Epoch 24
Loss = 7.8114e-02, PNorm = 44.5421, GNorm = 0.6819, lr_0 = 3.8971e-04
Loss = 7.5633e-02, PNorm = 44.5555, GNorm = 0.3968, lr_0 = 3.8165e-04
Validation rmse = 0.104914
Validation r2 = 0.822021
Validation mse = 0.011007
Epoch 25
Loss = 6.7820e-02, PNorm = 44.5689, GNorm = 1.0409, lr_0 = 3.7298e-04
Loss = 7.7369e-02, PNorm = 44.5821, GNorm = 1.8149, lr_0 = 3.6527e-04
Loss = 9.1181e-02, PNorm = 44.5834, GNorm = 2.0608, lr_0 = 3.6451e-04
Validation rmse = 0.125007
Validation r2 = 0.747318
Validation mse = 0.015627
Epoch 26
Loss = 8.9972e-02, PNorm = 44.5923, GNorm = 1.4823, lr_0 = 3.5697e-04
Loss = 1.0436e-01, PNorm = 44.6052, GNorm = 6.2773, lr_0 = 3.4959e-04
Validation rmse = 0.093072
Validation r2 = 0.859931
Validation mse = 0.008662
Epoch 27
Loss = 8.0211e-02, PNorm = 44.6224, GNorm = 0.9735, lr_0 = 3.4236e-04
Validation rmse = 0.114897
Validation r2 = 0.786540
Validation mse = 0.013201
Epoch 28
Loss = 1.0274e-01, PNorm = 44.6334, GNorm = 1.5205, lr_0 = 3.3458e-04
Loss = 7.2579e-02, PNorm = 44.6448, GNorm = 0.8487, lr_0 = 3.2766e-04
Validation rmse = 0.098699
Validation r2 = 0.842481
Validation mse = 0.009742
Epoch 29
Loss = 7.9855e-02, PNorm = 44.6562, GNorm = 0.5846, lr_0 = 3.2022e-04
Loss = 6.2125e-02, PNorm = 44.6648, GNorm = 0.4992, lr_0 = 3.1360e-04
Validation rmse = 0.105970
Validation r2 = 0.818421
Validation mse = 0.011230
Epoch 30
Loss = 5.3602e-02, PNorm = 44.6758, GNorm = 0.7326, lr_0 = 3.0647e-04
Loss = 6.2796e-02, PNorm = 44.6854, GNorm = 1.1244, lr_0 = 3.0013e-04
Validation rmse = 0.075856
Validation r2 = 0.906957
Validation mse = 0.005754
Epoch 31
Loss = 6.2666e-02, PNorm = 44.6937, GNorm = 0.8127, lr_0 = 2.9393e-04
Loss = 7.3253e-02, PNorm = 44.7023, GNorm = 2.2524, lr_0 = 2.8785e-04
Validation rmse = 0.098867
Validation r2 = 0.841945
Validation mse = 0.009775
Epoch 32
Loss = 6.7992e-02, PNorm = 44.7105, GNorm = 1.6414, lr_0 = 2.8131e-04
Loss = 6.4112e-02, PNorm = 44.7207, GNorm = 1.8099, lr_0 = 2.7549e-04
Validation rmse = 0.085398
Validation r2 = 0.882076
Validation mse = 0.007293
Epoch 33
Loss = 5.6291e-02, PNorm = 44.7297, GNorm = 2.1118, lr_0 = 2.6923e-04
Loss = 6.5870e-02, PNorm = 44.7370, GNorm = 0.5304, lr_0 = 2.6367e-04
Validation rmse = 0.085175
Validation r2 = 0.882692
Validation mse = 0.007255
Epoch 34
Loss = 7.2585e-02, PNorm = 44.7473, GNorm = 2.0184, lr_0 = 2.5767e-04
Loss = 6.0606e-02, PNorm = 44.7549, GNorm = 0.6859, lr_0 = 2.5235e-04
Validation rmse = 0.077791
Validation r2 = 0.902150
Validation mse = 0.006051
Epoch 35
Loss = 6.6856e-02, PNorm = 44.7627, GNorm = 0.5101, lr_0 = 2.4713e-04
Loss = 5.7398e-02, PNorm = 44.7710, GNorm = 1.8422, lr_0 = 2.4202e-04
Validation rmse = 0.089309
Validation r2 = 0.871029
Validation mse = 0.007976
Epoch 36
Loss = 5.2995e-02, PNorm = 44.7781, GNorm = 1.9888, lr_0 = 2.3652e-04
Loss = 6.7297e-02, PNorm = 44.7837, GNorm = 1.4368, lr_0 = 2.3163e-04
Validation rmse = 0.099506
Validation r2 = 0.839897
Validation mse = 0.009901
Epoch 37
Loss = 6.0456e-02, PNorm = 44.7933, GNorm = 0.8735, lr_0 = 2.2637e-04
Loss = 6.1272e-02, PNorm = 44.8001, GNorm = 1.6223, lr_0 = 2.2168e-04
Validation rmse = 0.081870
Validation r2 = 0.891620
Validation mse = 0.006703
Epoch 38
Loss = 5.2444e-02, PNorm = 44.8095, GNorm = 1.4167, lr_0 = 2.1665e-04
Loss = 6.5412e-02, PNorm = 44.8165, GNorm = 1.3025, lr_0 = 2.1217e-04
Validation rmse = 0.084787
Validation r2 = 0.883759
Validation mse = 0.007189
Epoch 39
Loss = 6.0441e-02, PNorm = 44.8232, GNorm = 2.1080, lr_0 = 2.0778e-04
Loss = 5.2467e-02, PNorm = 44.8299, GNorm = 1.1397, lr_0 = 2.0348e-04
Loss = 1.2399e-01, PNorm = 44.8306, GNorm = 1.9477, lr_0 = 2.0306e-04
Validation rmse = 0.091233
Validation r2 = 0.865412
Validation mse = 0.008323
Epoch 40
Loss = 4.7881e-02, PNorm = 44.8368, GNorm = 2.0545, lr_0 = 1.9886e-04
Validation rmse = 0.094304
Validation r2 = 0.856197
Validation mse = 0.008893
Epoch 41
Loss = 4.2753e-02, PNorm = 44.8443, GNorm = 0.6134, lr_0 = 1.9434e-04
Loss = 5.9339e-02, PNorm = 44.8501, GNorm = 0.5684, lr_0 = 1.9032e-04
Validation rmse = 0.095425
Validation r2 = 0.852760
Validation mse = 0.009106
Epoch 42
Loss = 5.4655e-02, PNorm = 44.8579, GNorm = 1.4534, lr_0 = 1.8600e-04
Loss = 5.6003e-02, PNorm = 44.8633, GNorm = 0.5296, lr_0 = 1.8215e-04
Validation rmse = 0.082556
Validation r2 = 0.889796
Validation mse = 0.006815
Epoch 43
Loss = 4.6546e-02, PNorm = 44.8684, GNorm = 0.6331, lr_0 = 1.7839e-04
Loss = 5.3046e-02, PNorm = 44.8735, GNorm = 1.1310, lr_0 = 1.7470e-04
Validation rmse = 0.075958
Validation r2 = 0.906706
Validation mse = 0.005770
Epoch 44
Loss = 4.6886e-02, PNorm = 44.8802, GNorm = 0.7728, lr_0 = 1.7073e-04
Loss = 4.4330e-02, PNorm = 44.8850, GNorm = 0.6625, lr_0 = 1.6720e-04
Validation rmse = 0.079582
Validation r2 = 0.897593
Validation mse = 0.006333
Epoch 45
Loss = 4.4300e-02, PNorm = 44.8909, GNorm = 0.6861, lr_0 = 1.6340e-04
Loss = 4.7533e-02, PNorm = 44.8954, GNorm = 0.6232, lr_0 = 1.6002e-04
Validation rmse = 0.084584
Validation r2 = 0.884315
Validation mse = 0.007154
Epoch 46
Loss = 5.2988e-02, PNorm = 44.9011, GNorm = 0.7922, lr_0 = 1.5638e-04
Loss = 4.9110e-02, PNorm = 44.9057, GNorm = 0.6496, lr_0 = 1.5315e-04
Validation rmse = 0.079896
Validation r2 = 0.896781
Validation mse = 0.006383
Epoch 47
Loss = 3.5009e-02, PNorm = 44.9105, GNorm = 1.9371, lr_0 = 1.4998e-04
Loss = 4.9021e-02, PNorm = 44.9149, GNorm = 0.5961, lr_0 = 1.4688e-04
Validation rmse = 0.079491
Validation r2 = 0.897826
Validation mse = 0.006319
Epoch 48
Loss = 4.2470e-02, PNorm = 44.9200, GNorm = 0.5972, lr_0 = 1.4354e-04
Loss = 4.1606e-02, PNorm = 44.9242, GNorm = 1.6385, lr_0 = 1.4058e-04
Validation rmse = 0.096178
Validation r2 = 0.850427
Validation mse = 0.009250
Epoch 49
Loss = 5.6482e-02, PNorm = 44.9301, GNorm = 2.2327, lr_0 = 1.3738e-04
Loss = 5.5120e-02, PNorm = 44.9344, GNorm = 1.2192, lr_0 = 1.3454e-04
Validation rmse = 0.091605
Validation r2 = 0.864313
Validation mse = 0.008391
Epoch 50
Loss = 4.5088e-02, PNorm = 44.9382, GNorm = 0.9593, lr_0 = 1.3176e-04
Loss = 5.2070e-02, PNorm = 44.9421, GNorm = 1.3441, lr_0 = 1.2904e-04
Validation rmse = 0.078078
Validation r2 = 0.901426
Validation mse = 0.006096
Epoch 51
Loss = 4.9003e-02, PNorm = 44.9466, GNorm = 1.0772, lr_0 = 1.2610e-04
Loss = 4.6682e-02, PNorm = 44.9516, GNorm = 1.0403, lr_0 = 1.2350e-04
Validation rmse = 0.073891
Validation r2 = 0.911716
Validation mse = 0.005460
Epoch 52
Loss = 4.6355e-02, PNorm = 44.9565, GNorm = 0.6899, lr_0 = 1.2069e-04
Loss = 4.6281e-02, PNorm = 44.9607, GNorm = 2.1280, lr_0 = 1.1819e-04
Loss = 8.2560e-02, PNorm = 44.9611, GNorm = 3.2468, lr_0 = 1.1795e-04
Validation rmse = 0.080737
Validation r2 = 0.894598
Validation mse = 0.006518
Epoch 53
Loss = 5.0528e-02, PNorm = 44.9645, GNorm = 0.9383, lr_0 = 1.1551e-04
Loss = 4.1897e-02, PNorm = 44.9679, GNorm = 2.1063, lr_0 = 1.1312e-04
Validation rmse = 0.077112
Validation r2 = 0.903850
Validation mse = 0.005946
Epoch 54
Loss = 4.2525e-02, PNorm = 44.9725, GNorm = 0.7326, lr_0 = 1.1078e-04
Validation rmse = 0.071899
Validation r2 = 0.916411
Validation mse = 0.005169
Epoch 55
Loss = 3.3939e-02, PNorm = 44.9755, GNorm = 1.0663, lr_0 = 1.0826e-04
Loss = 4.6146e-02, PNorm = 44.9788, GNorm = 0.7069, lr_0 = 1.0603e-04
Validation rmse = 0.072585
Validation r2 = 0.914807
Validation mse = 0.005269
Epoch 56
Loss = 4.5169e-02, PNorm = 44.9828, GNorm = 0.8126, lr_0 = 1.0362e-04
Loss = 3.7183e-02, PNorm = 44.9858, GNorm = 0.9228, lr_0 = 1.0147e-04
Validation rmse = 0.073048
Validation r2 = 0.913717
Validation mse = 0.005336
Epoch 57
Loss = 4.3227e-02, PNorm = 44.9888, GNorm = 1.0788, lr_0 = 1.0000e-04
Loss = 3.8198e-02, PNorm = 44.9922, GNorm = 0.5207, lr_0 = 1.0000e-04
Validation rmse = 0.072577
Validation r2 = 0.914826
Validation mse = 0.005267
Epoch 58
Loss = 3.9272e-02, PNorm = 44.9950, GNorm = 0.7859, lr_0 = 1.0000e-04
Loss = 4.2534e-02, PNorm = 44.9985, GNorm = 0.5073, lr_0 = 1.0000e-04
Validation rmse = 0.069611
Validation r2 = 0.921647
Validation mse = 0.004846
Epoch 59
Loss = 4.1010e-02, PNorm = 45.0014, GNorm = 0.9646, lr_0 = 1.0000e-04
Loss = 3.7555e-02, PNorm = 45.0041, GNorm = 0.5867, lr_0 = 1.0000e-04
Validation rmse = 0.083170
Validation r2 = 0.888149
Validation mse = 0.006917
Model 0 best validation rmse = 0.069611 on epoch 58
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.259439
Model 0 test r2 = 0.016894
Model 0 test mse = 0.067309
Ensemble test rmse = 0.259439
Ensemble test r2 = 0.016894
Ensemble test mse = 0.067309
Fold 2
Splitting data with seed 2
Total size = 973 | train size = 963 | val size = 10 | test size = 59
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 8.8377e-01, PNorm = 43.2640, GNorm = 1.3702, lr_0 = 3.6053e-04
Validation rmse = 0.179573
Validation r2 = 0.694481
Validation mse = 0.032247
Epoch 1
Loss = 9.8832e-01, PNorm = 43.2955, GNorm = 6.1180, lr_0 = 6.2105e-04
Loss = 5.9597e-01, PNorm = 43.3367, GNorm = 2.1965, lr_0 = 8.5789e-04
Validation rmse = 0.143428
Validation r2 = 0.805095
Validation mse = 0.020572
Epoch 2
Loss = 3.9114e-01, PNorm = 43.4103, GNorm = 1.3600, lr_0 = 9.8961e-04
Loss = 4.8955e-01, PNorm = 43.4898, GNorm = 2.8207, lr_0 = 9.6914e-04
Validation rmse = 0.141018
Validation r2 = 0.811589
Validation mse = 0.019886
Epoch 3
Loss = 2.9527e-01, PNorm = 43.5747, GNorm = 1.2496, lr_0 = 9.4712e-04
Loss = 3.4112e-01, PNorm = 43.6378, GNorm = 2.1537, lr_0 = 9.2754e-04
Validation rmse = 0.077015
Validation r2 = 0.943805
Validation mse = 0.005931
Epoch 4
Loss = 2.1325e-01, PNorm = 43.7041, GNorm = 1.2355, lr_0 = 9.0836e-04
Loss = 2.2826e-01, PNorm = 43.7673, GNorm = 1.0630, lr_0 = 8.8958e-04
Validation rmse = 0.099201
Validation r2 = 0.906764
Validation mse = 0.009841
Epoch 5
Loss = 2.3745e-01, PNorm = 43.8187, GNorm = 5.1348, lr_0 = 8.6936e-04
Loss = 2.0338e-01, PNorm = 43.8514, GNorm = 0.5833, lr_0 = 8.5139e-04
Validation rmse = 0.117427
Validation r2 = 0.869355
Validation mse = 0.013789
Epoch 6
Loss = 1.6867e-01, PNorm = 43.8884, GNorm = 4.0889, lr_0 = 8.3204e-04
Loss = 1.5672e-01, PNorm = 43.9194, GNorm = 1.6746, lr_0 = 8.1484e-04
Validation rmse = 0.043664
Validation r2 = 0.981936
Validation mse = 0.001907
Epoch 7
Loss = 1.3536e-01, PNorm = 43.9605, GNorm = 2.1203, lr_0 = 7.9632e-04
Loss = 1.6867e-01, PNorm = 43.9867, GNorm = 6.5204, lr_0 = 7.7986e-04
Validation rmse = 0.055096
Validation r2 = 0.971240
Validation mse = 0.003036
Epoch 8
Loss = 1.5957e-01, PNorm = 44.0124, GNorm = 4.3173, lr_0 = 7.6373e-04
Loss = 1.6588e-01, PNorm = 44.0428, GNorm = 5.5889, lr_0 = 7.4794e-04
Validation rmse = 0.107120
Validation r2 = 0.891284
Validation mse = 0.011475
Epoch 9
Loss = 1.9134e-01, PNorm = 44.0766, GNorm = 2.5832, lr_0 = 7.3094e-04
Loss = 1.5283e-01, PNorm = 44.1065, GNorm = 2.6288, lr_0 = 7.1583e-04
Validation rmse = 0.045221
Validation r2 = 0.980626
Validation mse = 0.002045
Epoch 10
Loss = 1.2114e-01, PNorm = 44.1300, GNorm = 2.8604, lr_0 = 6.9956e-04
Loss = 1.3837e-01, PNorm = 44.1511, GNorm = 3.3286, lr_0 = 6.8510e-04
Validation rmse = 0.056009
Validation r2 = 0.970279
Validation mse = 0.003137
Epoch 11
Loss = 1.1971e-01, PNorm = 44.1739, GNorm = 1.8870, lr_0 = 6.6953e-04
Loss = 1.2942e-01, PNorm = 44.1918, GNorm = 1.9144, lr_0 = 6.5569e-04
Validation rmse = 0.116695
Validation r2 = 0.870981
Validation mse = 0.013618
Epoch 12
Loss = 1.4185e-01, PNorm = 44.2059, GNorm = 1.8595, lr_0 = 6.4213e-04
Loss = 1.1013e-01, PNorm = 44.2250, GNorm = 1.1084, lr_0 = 6.2885e-04
Loss = 6.9646e-02, PNorm = 44.2264, GNorm = 0.8657, lr_0 = 6.2754e-04
Validation rmse = 0.059631
Validation r2 = 0.966310
Validation mse = 0.003556
Epoch 13
Loss = 1.2039e-01, PNorm = 44.2421, GNorm = 0.7934, lr_0 = 6.1456e-04
Validation rmse = 0.089749
Validation r2 = 0.923685
Validation mse = 0.008055
Epoch 14
Loss = 1.2319e-01, PNorm = 44.2643, GNorm = 2.1702, lr_0 = 6.0060e-04
Loss = 1.0677e-01, PNorm = 44.2802, GNorm = 1.1643, lr_0 = 5.8818e-04
Validation rmse = 0.048142
Validation r2 = 0.978041
Validation mse = 0.002318
Epoch 15
Loss = 9.6023e-02, PNorm = 44.2966, GNorm = 1.8411, lr_0 = 5.7482e-04
Loss = 1.1253e-01, PNorm = 44.3140, GNorm = 0.8891, lr_0 = 5.6293e-04
Validation rmse = 0.071265
Validation r2 = 0.951882
Validation mse = 0.005079
Epoch 16
Loss = 1.1616e-01, PNorm = 44.3307, GNorm = 3.7551, lr_0 = 5.5129e-04
Loss = 8.7873e-02, PNorm = 44.3456, GNorm = 0.7884, lr_0 = 5.3989e-04
Validation rmse = 0.104084
Validation r2 = 0.897359
Validation mse = 0.010833
Epoch 17
Loss = 7.8167e-02, PNorm = 44.3583, GNorm = 0.7602, lr_0 = 5.2762e-04
Loss = 1.1183e-01, PNorm = 44.3741, GNorm = 1.1202, lr_0 = 5.1671e-04
Validation rmse = 0.053463
Validation r2 = 0.972919
Validation mse = 0.002858
Epoch 18
Loss = 7.4788e-02, PNorm = 44.3881, GNorm = 0.8047, lr_0 = 5.0497e-04
Loss = 9.3045e-02, PNorm = 44.4014, GNorm = 3.1393, lr_0 = 4.9453e-04
Validation rmse = 0.064612
Validation r2 = 0.960447
Validation mse = 0.004175
Epoch 19
Loss = 7.7817e-02, PNorm = 44.4167, GNorm = 0.9136, lr_0 = 4.8329e-04
Loss = 9.8310e-02, PNorm = 44.4315, GNorm = 1.0395, lr_0 = 4.7330e-04
Validation rmse = 0.071483
Validation r2 = 0.951587
Validation mse = 0.005110
Epoch 20
Loss = 1.3531e-01, PNorm = 44.4439, GNorm = 5.4002, lr_0 = 4.6351e-04
Loss = 1.1100e-01, PNorm = 44.4628, GNorm = 1.7671, lr_0 = 4.5393e-04
Validation rmse = 0.063169
Validation r2 = 0.962194
Validation mse = 0.003990
Epoch 21
Loss = 9.5557e-02, PNorm = 44.4794, GNorm = 1.6271, lr_0 = 4.4361e-04
Loss = 9.8692e-02, PNorm = 44.4932, GNorm = 2.2863, lr_0 = 4.3444e-04
Validation rmse = 0.033840
Validation r2 = 0.989150
Validation mse = 0.001145
Epoch 22
Loss = 8.8970e-02, PNorm = 44.5052, GNorm = 0.8741, lr_0 = 4.2457e-04
Loss = 8.6734e-02, PNorm = 44.5163, GNorm = 3.4160, lr_0 = 4.1579e-04
Validation rmse = 0.077857
Validation r2 = 0.942568
Validation mse = 0.006062
Epoch 23
Loss = 8.5229e-02, PNorm = 44.5329, GNorm = 1.0894, lr_0 = 4.0634e-04
Loss = 8.4648e-02, PNorm = 44.5442, GNorm = 0.5111, lr_0 = 3.9794e-04
Validation rmse = 0.065403
Validation r2 = 0.959473
Validation mse = 0.004278
Epoch 24
Loss = 8.1597e-02, PNorm = 44.5571, GNorm = 0.7783, lr_0 = 3.8971e-04
Loss = 7.8803e-02, PNorm = 44.5684, GNorm = 2.6644, lr_0 = 3.8165e-04
Validation rmse = 0.053332
Validation r2 = 0.973052
Validation mse = 0.002844
Epoch 25
Loss = 7.4252e-02, PNorm = 44.5809, GNorm = 1.4868, lr_0 = 3.7298e-04
Loss = 8.5061e-02, PNorm = 44.5922, GNorm = 0.9098, lr_0 = 3.6527e-04
Loss = 5.6033e-02, PNorm = 44.5932, GNorm = 1.5501, lr_0 = 3.6451e-04
Validation rmse = 0.053194
Validation r2 = 0.973191
Validation mse = 0.002830
Epoch 26
Loss = 7.8181e-02, PNorm = 44.6033, GNorm = 1.7880, lr_0 = 3.5697e-04
Loss = 8.8805e-02, PNorm = 44.6141, GNorm = 3.0654, lr_0 = 3.4959e-04
Validation rmse = 0.044375
Validation r2 = 0.981344
Validation mse = 0.001969
Epoch 27
Loss = 6.9709e-02, PNorm = 44.6258, GNorm = 0.7516, lr_0 = 3.4236e-04
Validation rmse = 0.058859
Validation r2 = 0.967177
Validation mse = 0.003464
Epoch 28
Loss = 5.4348e-02, PNorm = 44.6367, GNorm = 1.1077, lr_0 = 3.3458e-04
Loss = 8.6064e-02, PNorm = 44.6461, GNorm = 1.6753, lr_0 = 3.2766e-04
Validation rmse = 0.047809
Validation r2 = 0.978344
Validation mse = 0.002286
Epoch 29
Loss = 7.9520e-02, PNorm = 44.6598, GNorm = 1.4809, lr_0 = 3.2022e-04
Loss = 7.9096e-02, PNorm = 44.6710, GNorm = 1.6056, lr_0 = 3.1360e-04
Validation rmse = 0.087846
Validation r2 = 0.926886
Validation mse = 0.007717
Epoch 30
Loss = 8.9184e-02, PNorm = 44.6817, GNorm = 1.0017, lr_0 = 3.0647e-04
Loss = 7.2756e-02, PNorm = 44.6896, GNorm = 0.4257, lr_0 = 3.0013e-04
Validation rmse = 0.075679
Validation r2 = 0.945737
Validation mse = 0.005727
Epoch 31
Loss = 8.8299e-02, PNorm = 44.6986, GNorm = 0.5882, lr_0 = 2.9393e-04
Loss = 6.2666e-02, PNorm = 44.7072, GNorm = 1.5368, lr_0 = 2.8785e-04
Validation rmse = 0.080006
Validation r2 = 0.939354
Validation mse = 0.006401
Epoch 32
Loss = 6.9146e-02, PNorm = 44.7178, GNorm = 0.7611, lr_0 = 2.8131e-04
Loss = 7.3229e-02, PNorm = 44.7261, GNorm = 1.9300, lr_0 = 2.7549e-04
Validation rmse = 0.057475
Validation r2 = 0.968702
Validation mse = 0.003303
Epoch 33
Loss = 6.9344e-02, PNorm = 44.7346, GNorm = 0.8951, lr_0 = 2.6923e-04
Loss = 6.6841e-02, PNorm = 44.7434, GNorm = 1.5443, lr_0 = 2.6367e-04
Validation rmse = 0.077593
Validation r2 = 0.942958
Validation mse = 0.006021
Epoch 34
Loss = 6.9744e-02, PNorm = 44.7546, GNorm = 1.5412, lr_0 = 2.5767e-04
Loss = 6.7303e-02, PNorm = 44.7638, GNorm = 1.2263, lr_0 = 2.5235e-04
Validation rmse = 0.052357
Validation r2 = 0.974028
Validation mse = 0.002741
Epoch 35
Loss = 6.6861e-02, PNorm = 44.7722, GNorm = 0.4909, lr_0 = 2.4713e-04
Loss = 6.7302e-02, PNorm = 44.7804, GNorm = 0.7217, lr_0 = 2.4202e-04
Validation rmse = 0.050773
Validation r2 = 0.975576
Validation mse = 0.002578
Epoch 36
Loss = 6.2303e-02, PNorm = 44.7905, GNorm = 0.6932, lr_0 = 2.3652e-04
Loss = 6.8032e-02, PNorm = 44.7975, GNorm = 0.3733, lr_0 = 2.3163e-04
Validation rmse = 0.042766
Validation r2 = 0.982672
Validation mse = 0.001829
Epoch 37
Loss = 6.2564e-02, PNorm = 44.8060, GNorm = 1.3393, lr_0 = 2.2637e-04
Loss = 6.7195e-02, PNorm = 44.8135, GNorm = 1.3879, lr_0 = 2.2168e-04
Validation rmse = 0.042362
Validation r2 = 0.982998
Validation mse = 0.001795
Epoch 38
Loss = 6.1649e-02, PNorm = 44.8215, GNorm = 0.4534, lr_0 = 2.1665e-04
Loss = 6.1354e-02, PNorm = 44.8289, GNorm = 0.8079, lr_0 = 2.1217e-04
Validation rmse = 0.053913
Validation r2 = 0.972461
Validation mse = 0.002907
Epoch 39
Loss = 6.8620e-02, PNorm = 44.8358, GNorm = 1.3585, lr_0 = 2.0778e-04
Loss = 5.3051e-02, PNorm = 44.8428, GNorm = 0.5389, lr_0 = 2.0348e-04
Loss = 4.0740e-02, PNorm = 44.8436, GNorm = 1.1947, lr_0 = 2.0306e-04
Validation rmse = 0.067603
Validation r2 = 0.956701
Validation mse = 0.004570
Epoch 40
Loss = 5.7966e-02, PNorm = 44.8509, GNorm = 0.9258, lr_0 = 1.9886e-04
Validation rmse = 0.084971
Validation r2 = 0.931594
Validation mse = 0.007220
Epoch 41
Loss = 6.5356e-02, PNorm = 44.8594, GNorm = 1.6286, lr_0 = 1.9434e-04
Loss = 6.4592e-02, PNorm = 44.8674, GNorm = 1.2329, lr_0 = 1.9032e-04
Validation rmse = 0.057402
Validation r2 = 0.968782
Validation mse = 0.003295
Epoch 42
Loss = 5.9843e-02, PNorm = 44.8731, GNorm = 0.5649, lr_0 = 1.8600e-04
Loss = 4.8771e-02, PNorm = 44.8801, GNorm = 0.8043, lr_0 = 1.8215e-04
Validation rmse = 0.056016
Validation r2 = 0.970271
Validation mse = 0.003138
Epoch 43
Loss = 4.5488e-02, PNorm = 44.8862, GNorm = 0.6612, lr_0 = 1.7839e-04
Loss = 5.6966e-02, PNorm = 44.8916, GNorm = 0.6526, lr_0 = 1.7470e-04
Validation rmse = 0.052510
Validation r2 = 0.973877
Validation mse = 0.002757
Epoch 44
Loss = 5.4466e-02, PNorm = 44.8991, GNorm = 1.2445, lr_0 = 1.7073e-04
Loss = 5.7847e-02, PNorm = 44.9055, GNorm = 0.5007, lr_0 = 1.6720e-04
Validation rmse = 0.053514
Validation r2 = 0.972868
Validation mse = 0.002864
Epoch 45
Loss = 4.3213e-02, PNorm = 44.9121, GNorm = 1.1337, lr_0 = 1.6340e-04
Loss = 5.6211e-02, PNorm = 44.9176, GNorm = 0.9353, lr_0 = 1.6002e-04
Validation rmse = 0.064640
Validation r2 = 0.960412
Validation mse = 0.004178
Epoch 46
Loss = 4.8793e-02, PNorm = 44.9241, GNorm = 0.8366, lr_0 = 1.5638e-04
Loss = 4.6349e-02, PNorm = 44.9288, GNorm = 0.7028, lr_0 = 1.5315e-04
Validation rmse = 0.056619
Validation r2 = 0.969627
Validation mse = 0.003206
Epoch 47
Loss = 4.9034e-02, PNorm = 44.9345, GNorm = 1.0446, lr_0 = 1.4998e-04
Loss = 5.3854e-02, PNorm = 44.9407, GNorm = 0.5016, lr_0 = 1.4688e-04
Validation rmse = 0.053283
Validation r2 = 0.973101
Validation mse = 0.002839
Epoch 48
Loss = 4.8984e-02, PNorm = 44.9460, GNorm = 0.7559, lr_0 = 1.4354e-04
Loss = 5.2582e-02, PNorm = 44.9509, GNorm = 1.0162, lr_0 = 1.4058e-04
Validation rmse = 0.060890
Validation r2 = 0.964873
Validation mse = 0.003708
Epoch 49
Loss = 5.0103e-02, PNorm = 44.9570, GNorm = 1.3301, lr_0 = 1.3738e-04
Loss = 5.6387e-02, PNorm = 44.9626, GNorm = 0.9821, lr_0 = 1.3454e-04
Validation rmse = 0.050088
Validation r2 = 0.976230
Validation mse = 0.002509
Epoch 50
Loss = 5.5795e-02, PNorm = 44.9684, GNorm = 1.8076, lr_0 = 1.3176e-04
Loss = 5.9444e-02, PNorm = 44.9739, GNorm = 1.3066, lr_0 = 1.2904e-04
Validation rmse = 0.078541
Validation r2 = 0.941555
Validation mse = 0.006169
Epoch 51
Loss = 4.5052e-02, PNorm = 44.9784, GNorm = 1.3927, lr_0 = 1.2610e-04
Loss = 5.1581e-02, PNorm = 44.9828, GNorm = 1.3094, lr_0 = 1.2350e-04
Validation rmse = 0.050954
Validation r2 = 0.975401
Validation mse = 0.002596
Epoch 52
Loss = 4.7968e-02, PNorm = 44.9879, GNorm = 0.8757, lr_0 = 1.2069e-04
Loss = 5.3363e-02, PNorm = 44.9929, GNorm = 1.4927, lr_0 = 1.1819e-04
Loss = 1.9336e-02, PNorm = 44.9935, GNorm = 1.6561, lr_0 = 1.1795e-04
Validation rmse = 0.055437
Validation r2 = 0.970882
Validation mse = 0.003073
Epoch 53
Loss = 4.6471e-02, PNorm = 44.9982, GNorm = 1.3413, lr_0 = 1.1551e-04
Loss = 4.6187e-02, PNorm = 45.0021, GNorm = 1.3071, lr_0 = 1.1312e-04
Validation rmse = 0.063468
Validation r2 = 0.961835
Validation mse = 0.004028
Epoch 54
Loss = 4.5913e-02, PNorm = 45.0064, GNorm = 1.7092, lr_0 = 1.1078e-04
Validation rmse = 0.074304
Validation r2 = 0.947690
Validation mse = 0.005521
Epoch 55
Loss = 7.2279e-02, PNorm = 45.0112, GNorm = 1.7165, lr_0 = 1.0826e-04
Loss = 4.4550e-02, PNorm = 45.0147, GNorm = 1.7403, lr_0 = 1.0603e-04
Validation rmse = 0.056052
Validation r2 = 0.970233
Validation mse = 0.003142
Epoch 56
Loss = 4.0557e-02, PNorm = 45.0186, GNorm = 1.0682, lr_0 = 1.0362e-04
Loss = 4.2374e-02, PNorm = 45.0224, GNorm = 0.6121, lr_0 = 1.0147e-04
Validation rmse = 0.056028
Validation r2 = 0.970258
Validation mse = 0.003139
Epoch 57
Loss = 4.0356e-02, PNorm = 45.0264, GNorm = 0.7303, lr_0 = 1.0000e-04
Loss = 4.8001e-02, PNorm = 45.0301, GNorm = 1.0659, lr_0 = 1.0000e-04
Validation rmse = 0.054966
Validation r2 = 0.971375
Validation mse = 0.003021
Epoch 58
Loss = 4.0679e-02, PNorm = 45.0343, GNorm = 1.1469, lr_0 = 1.0000e-04
Loss = 4.4212e-02, PNorm = 45.0381, GNorm = 0.5694, lr_0 = 1.0000e-04
Validation rmse = 0.066030
Validation r2 = 0.958691
Validation mse = 0.004360
Epoch 59
Loss = 3.3941e-02, PNorm = 45.0417, GNorm = 0.4331, lr_0 = 1.0000e-04
Loss = 4.2049e-02, PNorm = 45.0450, GNorm = 0.6693, lr_0 = 1.0000e-04
Validation rmse = 0.049077
Validation r2 = 0.977180
Validation mse = 0.002409
Model 0 best validation rmse = 0.033840 on epoch 21
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.177057
Model 0 test r2 = 0.542116
Model 0 test mse = 0.031349
Ensemble test rmse = 0.177057
Ensemble test r2 = 0.542116
Ensemble test mse = 0.031349
Fold 3
Splitting data with seed 3
Total size = 973 | train size = 963 | val size = 10 | test size = 59
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.3268e-01, PNorm = 43.2620, GNorm = 1.1699, lr_0 = 3.6053e-04
Validation rmse = 0.299667
Validation r2 = 0.238388
Validation mse = 0.089800
Epoch 1
Loss = 6.1138e-01, PNorm = 43.2866, GNorm = 6.9261, lr_0 = 6.2105e-04
Loss = 7.1951e-01, PNorm = 43.3250, GNorm = 11.7434, lr_0 = 8.5789e-04
Validation rmse = 0.344368
Validation r2 = -0.005777
Validation mse = 0.118589
Epoch 2
Loss = 6.0450e-01, PNorm = 43.3979, GNorm = 1.5295, lr_0 = 9.8961e-04
Loss = 4.8222e-01, PNorm = 43.4819, GNorm = 5.3655, lr_0 = 9.6914e-04
Validation rmse = 0.210331
Validation r2 = 0.624801
Validation mse = 0.044239
Epoch 3
Loss = 3.0609e-01, PNorm = 43.5765, GNorm = 2.0444, lr_0 = 9.4712e-04
Loss = 2.8663e-01, PNorm = 43.6493, GNorm = 2.1103, lr_0 = 9.2754e-04
Validation rmse = 0.161123
Validation r2 = 0.779823
Validation mse = 0.025961
Epoch 4
Loss = 2.1469e-01, PNorm = 43.7135, GNorm = 3.2250, lr_0 = 9.0836e-04
Loss = 2.4446e-01, PNorm = 43.7660, GNorm = 0.7942, lr_0 = 8.8958e-04
Validation rmse = 0.165184
Validation r2 = 0.768586
Validation mse = 0.027286
Epoch 5
Loss = 1.8322e-01, PNorm = 43.8115, GNorm = 0.8075, lr_0 = 8.6936e-04
Loss = 1.7294e-01, PNorm = 43.8512, GNorm = 5.2967, lr_0 = 8.5139e-04
Validation rmse = 0.195380
Validation r2 = 0.676246
Validation mse = 0.038173
Epoch 6
Loss = 2.4593e-01, PNorm = 43.8757, GNorm = 5.7447, lr_0 = 8.3204e-04
Loss = 1.9435e-01, PNorm = 43.9157, GNorm = 2.9827, lr_0 = 8.1484e-04
Validation rmse = 0.123058
Validation r2 = 0.871567
Validation mse = 0.015143
Epoch 7
Loss = 1.5247e-01, PNorm = 43.9399, GNorm = 6.7055, lr_0 = 7.9632e-04
Loss = 1.7209e-01, PNorm = 43.9708, GNorm = 0.7194, lr_0 = 7.7986e-04
Validation rmse = 0.144669
Validation r2 = 0.822498
Validation mse = 0.020929
Epoch 8
Loss = 1.3242e-01, PNorm = 43.9971, GNorm = 1.0297, lr_0 = 7.6373e-04
Loss = 1.4063e-01, PNorm = 44.0178, GNorm = 3.5616, lr_0 = 7.4794e-04
Validation rmse = 0.155306
Validation r2 = 0.795436
Validation mse = 0.024120
Epoch 9
Loss = 1.3940e-01, PNorm = 44.0427, GNorm = 1.7394, lr_0 = 7.3094e-04
Loss = 1.3959e-01, PNorm = 44.0658, GNorm = 3.8142, lr_0 = 7.1583e-04
Validation rmse = 0.140052
Validation r2 = 0.833646
Validation mse = 0.019615
Epoch 10
Loss = 1.0852e-01, PNorm = 44.0850, GNorm = 0.4627, lr_0 = 6.9956e-04
Loss = 1.3929e-01, PNorm = 44.1057, GNorm = 2.2478, lr_0 = 6.8510e-04
Validation rmse = 0.141166
Validation r2 = 0.830989
Validation mse = 0.019928
Epoch 11
Loss = 1.2309e-01, PNorm = 44.1291, GNorm = 0.8057, lr_0 = 6.6953e-04
Loss = 1.3289e-01, PNorm = 44.1549, GNorm = 2.1423, lr_0 = 6.5569e-04
Validation rmse = 0.115821
Validation r2 = 0.886230
Validation mse = 0.013414
Epoch 12
Loss = 1.1273e-01, PNorm = 44.1732, GNorm = 1.3633, lr_0 = 6.4213e-04
Loss = 1.2918e-01, PNorm = 44.1848, GNorm = 1.2051, lr_0 = 6.2885e-04
Loss = 9.2563e-02, PNorm = 44.1865, GNorm = 1.4765, lr_0 = 6.2754e-04
Validation rmse = 0.117651
Validation r2 = 0.882606
Validation mse = 0.013842
Epoch 13
Loss = 1.1522e-01, PNorm = 44.2028, GNorm = 1.3569, lr_0 = 6.1456e-04
Validation rmse = 0.118861
Validation r2 = 0.880179
Validation mse = 0.014128
Epoch 14
Loss = 7.5679e-02, PNorm = 44.2264, GNorm = 2.7296, lr_0 = 6.0060e-04
Loss = 1.2419e-01, PNorm = 44.2480, GNorm = 2.1753, lr_0 = 5.8818e-04
Validation rmse = 0.132699
Validation r2 = 0.850655
Validation mse = 0.017609
Epoch 15
Loss = 1.1439e-01, PNorm = 44.2751, GNorm = 1.1913, lr_0 = 5.7482e-04
Loss = 1.1460e-01, PNorm = 44.2956, GNorm = 0.6102, lr_0 = 5.6293e-04
Validation rmse = 0.118109
Validation r2 = 0.881690
Validation mse = 0.013950
Epoch 16
Loss = 8.9828e-02, PNorm = 44.3109, GNorm = 1.9819, lr_0 = 5.5129e-04
Loss = 1.1164e-01, PNorm = 44.3228, GNorm = 0.7197, lr_0 = 5.3989e-04
Validation rmse = 0.120577
Validation r2 = 0.876695
Validation mse = 0.014539
Epoch 17
Loss = 7.1416e-02, PNorm = 44.3417, GNorm = 0.5349, lr_0 = 5.2762e-04
Loss = 1.0963e-01, PNorm = 44.3534, GNorm = 1.2960, lr_0 = 5.1671e-04
Validation rmse = 0.113893
Validation r2 = 0.889985
Validation mse = 0.012972
Epoch 18
Loss = 1.0480e-01, PNorm = 44.3663, GNorm = 1.9487, lr_0 = 5.0497e-04
Loss = 9.9384e-02, PNorm = 44.3814, GNorm = 1.8841, lr_0 = 4.9453e-04
Validation rmse = 0.106867
Validation r2 = 0.903141
Validation mse = 0.011421
Epoch 19
Loss = 1.1790e-01, PNorm = 44.4006, GNorm = 1.1237, lr_0 = 4.8329e-04
Loss = 8.9778e-02, PNorm = 44.4157, GNorm = 0.8260, lr_0 = 4.7330e-04
Validation rmse = 0.100679
Validation r2 = 0.914032
Validation mse = 0.010136
Epoch 20
Loss = 8.6186e-02, PNorm = 44.4288, GNorm = 1.6026, lr_0 = 4.6351e-04
Loss = 8.4954e-02, PNorm = 44.4418, GNorm = 1.5121, lr_0 = 4.5393e-04
Validation rmse = 0.118286
Validation r2 = 0.881334
Validation mse = 0.013992
Epoch 21
Loss = 8.0124e-02, PNorm = 44.4563, GNorm = 0.5530, lr_0 = 4.4361e-04
Loss = 9.3243e-02, PNorm = 44.4672, GNorm = 1.5423, lr_0 = 4.3444e-04
Validation rmse = 0.131301
Validation r2 = 0.853785
Validation mse = 0.017240
Epoch 22
Loss = 7.1893e-02, PNorm = 44.4809, GNorm = 1.3542, lr_0 = 4.2457e-04
Loss = 9.5065e-02, PNorm = 44.4951, GNorm = 2.8228, lr_0 = 4.1579e-04
Validation rmse = 0.114581
Validation r2 = 0.888653
Validation mse = 0.013129
Epoch 23
Loss = 9.6678e-02, PNorm = 44.5089, GNorm = 2.2714, lr_0 = 4.0634e-04
Loss = 1.0006e-01, PNorm = 44.5246, GNorm = 2.8175, lr_0 = 3.9794e-04
Validation rmse = 0.152858
Validation r2 = 0.801832
Validation mse = 0.023366
Epoch 24
Loss = 1.0230e-01, PNorm = 44.5444, GNorm = 2.9983, lr_0 = 3.8971e-04
Loss = 8.7366e-02, PNorm = 44.5609, GNorm = 1.5525, lr_0 = 3.8165e-04
Validation rmse = 0.127853
Validation r2 = 0.861364
Validation mse = 0.016346
Epoch 25
Loss = 7.7861e-02, PNorm = 44.5767, GNorm = 0.5847, lr_0 = 3.7298e-04
Loss = 9.1549e-02, PNorm = 44.5887, GNorm = 2.1080, lr_0 = 3.6527e-04
Loss = 5.9318e-02, PNorm = 44.5900, GNorm = 2.5526, lr_0 = 3.6451e-04
Validation rmse = 0.101554
Validation r2 = 0.912531
Validation mse = 0.010313
Epoch 26
Loss = 7.2765e-02, PNorm = 44.6049, GNorm = 1.8104, lr_0 = 3.5697e-04
Loss = 8.1084e-02, PNorm = 44.6135, GNorm = 1.5004, lr_0 = 3.4959e-04
Validation rmse = 0.121693
Validation r2 = 0.874402
Validation mse = 0.014809
Epoch 27
Loss = 7.0724e-02, PNorm = 44.6232, GNorm = 0.3453, lr_0 = 3.4236e-04
Validation rmse = 0.141467
Validation r2 = 0.830267
Validation mse = 0.020013
Epoch 28
Loss = 4.9596e-02, PNorm = 44.6348, GNorm = 1.5465, lr_0 = 3.3458e-04
Loss = 8.2737e-02, PNorm = 44.6441, GNorm = 0.8314, lr_0 = 3.2766e-04
Validation rmse = 0.104148
Validation r2 = 0.908007
Validation mse = 0.010847
Epoch 29
Loss = 7.5685e-02, PNorm = 44.6562, GNorm = 2.3983, lr_0 = 3.2022e-04
Loss = 6.9125e-02, PNorm = 44.6685, GNorm = 0.6629, lr_0 = 3.1360e-04
Validation rmse = 0.116113
Validation r2 = 0.885654
Validation mse = 0.013482
Epoch 30
Loss = 7.3019e-02, PNorm = 44.6776, GNorm = 0.5133, lr_0 = 3.0647e-04
Loss = 6.9765e-02, PNorm = 44.6855, GNorm = 0.5266, lr_0 = 3.0013e-04
Validation rmse = 0.112437
Validation r2 = 0.892780
Validation mse = 0.012642
Epoch 31
Loss = 6.7334e-02, PNorm = 44.6945, GNorm = 1.5342, lr_0 = 2.9393e-04
Loss = 7.3034e-02, PNorm = 44.7029, GNorm = 1.4002, lr_0 = 2.8785e-04
Validation rmse = 0.102961
Validation r2 = 0.910092
Validation mse = 0.010601
Epoch 32
Loss = 5.8970e-02, PNorm = 44.7148, GNorm = 0.6414, lr_0 = 2.8131e-04
Loss = 7.3703e-02, PNorm = 44.7244, GNorm = 1.1755, lr_0 = 2.7549e-04
Validation rmse = 0.118214
Validation r2 = 0.881479
Validation mse = 0.013975
Epoch 33
Loss = 7.1106e-02, PNorm = 44.7352, GNorm = 0.7709, lr_0 = 2.6923e-04
Loss = 5.8255e-02, PNorm = 44.7462, GNorm = 0.3393, lr_0 = 2.6367e-04
Validation rmse = 0.125310
Validation r2 = 0.866823
Validation mse = 0.015703
Epoch 34
Loss = 6.9413e-02, PNorm = 44.7555, GNorm = 1.1636, lr_0 = 2.5767e-04
Loss = 7.4204e-02, PNorm = 44.7654, GNorm = 1.3553, lr_0 = 2.5235e-04
Validation rmse = 0.120649
Validation r2 = 0.876546
Validation mse = 0.014556
Epoch 35
Loss = 6.2278e-02, PNorm = 44.7740, GNorm = 1.7657, lr_0 = 2.4713e-04
Loss = 6.1266e-02, PNorm = 44.7833, GNorm = 1.4056, lr_0 = 2.4202e-04
Validation rmse = 0.119573
Validation r2 = 0.878738
Validation mse = 0.014298
Epoch 36
Loss = 6.2709e-02, PNorm = 44.7928, GNorm = 0.8035, lr_0 = 2.3652e-04
Loss = 6.2778e-02, PNorm = 44.8012, GNorm = 0.6954, lr_0 = 2.3163e-04
Validation rmse = 0.106413
Validation r2 = 0.903962
Validation mse = 0.011324
Epoch 37
Loss = 6.0629e-02, PNorm = 44.8090, GNorm = 1.0062, lr_0 = 2.2637e-04
Loss = 5.7769e-02, PNorm = 44.8163, GNorm = 1.0574, lr_0 = 2.2168e-04
Validation rmse = 0.110443
Validation r2 = 0.896549
Validation mse = 0.012198
Epoch 38
Loss = 5.7076e-02, PNorm = 44.8242, GNorm = 1.0344, lr_0 = 2.1665e-04
Loss = 6.3985e-02, PNorm = 44.8317, GNorm = 1.2795, lr_0 = 2.1217e-04
Validation rmse = 0.111119
Validation r2 = 0.895279
Validation mse = 0.012348
Epoch 39
Loss = 5.6816e-02, PNorm = 44.8399, GNorm = 0.4337, lr_0 = 2.0778e-04
Loss = 6.1929e-02, PNorm = 44.8472, GNorm = 1.2445, lr_0 = 2.0348e-04
Loss = 1.1913e-01, PNorm = 44.8482, GNorm = 3.7331, lr_0 = 2.0306e-04
Validation rmse = 0.114093
Validation r2 = 0.889599
Validation mse = 0.013017
Epoch 40
Loss = 5.5976e-02, PNorm = 44.8570, GNorm = 1.5426, lr_0 = 1.9886e-04
Validation rmse = 0.104176
Validation r2 = 0.907956
Validation mse = 0.010853
Epoch 41
Loss = 6.0576e-02, PNorm = 44.8648, GNorm = 0.4156, lr_0 = 1.9434e-04
Loss = 5.2056e-02, PNorm = 44.8719, GNorm = 0.5103, lr_0 = 1.9032e-04
Validation rmse = 0.111968
Validation r2 = 0.893674
Validation mse = 0.012537
Epoch 42
Loss = 4.3211e-02, PNorm = 44.8795, GNorm = 0.4543, lr_0 = 1.8600e-04
Loss = 5.2290e-02, PNorm = 44.8870, GNorm = 0.8995, lr_0 = 1.8215e-04
Validation rmse = 0.108208
Validation r2 = 0.900694
Validation mse = 0.011709
Epoch 43
Loss = 4.0441e-02, PNorm = 44.8918, GNorm = 0.5204, lr_0 = 1.7839e-04
Loss = 5.5544e-02, PNorm = 44.8972, GNorm = 3.6836, lr_0 = 1.7470e-04
Validation rmse = 0.101178
Validation r2 = 0.913179
Validation mse = 0.010237
Epoch 44
Loss = 5.8036e-02, PNorm = 44.9048, GNorm = 1.7783, lr_0 = 1.7073e-04
Loss = 5.4949e-02, PNorm = 44.9123, GNorm = 1.5293, lr_0 = 1.6720e-04
Validation rmse = 0.106376
Validation r2 = 0.904028
Validation mse = 0.011316
Epoch 45
Loss = 4.4757e-02, PNorm = 44.9185, GNorm = 0.7642, lr_0 = 1.6340e-04
Loss = 5.1778e-02, PNorm = 44.9243, GNorm = 0.9115, lr_0 = 1.6002e-04
Validation rmse = 0.113060
Validation r2 = 0.891589
Validation mse = 0.012783
Epoch 46
Loss = 4.7235e-02, PNorm = 44.9301, GNorm = 0.7763, lr_0 = 1.5638e-04
Loss = 5.1143e-02, PNorm = 44.9367, GNorm = 0.6149, lr_0 = 1.5315e-04
Validation rmse = 0.109586
Validation r2 = 0.898149
Validation mse = 0.012009
Epoch 47
Loss = 5.0222e-02, PNorm = 44.9421, GNorm = 1.0320, lr_0 = 1.4998e-04
Loss = 4.8592e-02, PNorm = 44.9468, GNorm = 0.5586, lr_0 = 1.4688e-04
Validation rmse = 0.108172
Validation r2 = 0.900761
Validation mse = 0.011701
Epoch 48
Loss = 5.1625e-02, PNorm = 44.9532, GNorm = 0.9255, lr_0 = 1.4354e-04
Loss = 5.0808e-02, PNorm = 44.9584, GNorm = 0.7095, lr_0 = 1.4058e-04
Validation rmse = 0.112878
Validation r2 = 0.891938
Validation mse = 0.012741
Epoch 49
Loss = 4.7065e-02, PNorm = 44.9648, GNorm = 0.7427, lr_0 = 1.3738e-04
Loss = 4.5211e-02, PNorm = 44.9694, GNorm = 1.2323, lr_0 = 1.3454e-04
Validation rmse = 0.119704
Validation r2 = 0.878472
Validation mse = 0.014329
Epoch 50
Loss = 5.2961e-02, PNorm = 44.9737, GNorm = 1.4560, lr_0 = 1.3176e-04
Loss = 4.7306e-02, PNorm = 44.9788, GNorm = 0.8063, lr_0 = 1.2904e-04
Validation rmse = 0.103534
Validation r2 = 0.909087
Validation mse = 0.010719
Epoch 51
Loss = 5.0129e-02, PNorm = 44.9834, GNorm = 0.5853, lr_0 = 1.2610e-04
Loss = 4.2016e-02, PNorm = 44.9878, GNorm = 0.9976, lr_0 = 1.2350e-04
Validation rmse = 0.117021
Validation r2 = 0.883860
Validation mse = 0.013694
Epoch 52
Loss = 4.7397e-02, PNorm = 44.9922, GNorm = 1.1343, lr_0 = 1.2069e-04
Loss = 4.2620e-02, PNorm = 44.9970, GNorm = 0.4328, lr_0 = 1.1819e-04
Loss = 1.7320e-02, PNorm = 44.9975, GNorm = 0.5179, lr_0 = 1.1795e-04
Validation rmse = 0.115383
Validation r2 = 0.887089
Validation mse = 0.013313
Epoch 53
Loss = 4.3254e-02, PNorm = 45.0010, GNorm = 1.1888, lr_0 = 1.1551e-04
Loss = 4.4771e-02, PNorm = 45.0049, GNorm = 0.8704, lr_0 = 1.1312e-04
Validation rmse = 0.103178
Validation r2 = 0.909712
Validation mse = 0.010646
Epoch 54
Loss = 4.7048e-02, PNorm = 45.0098, GNorm = 0.9976, lr_0 = 1.1078e-04
Validation rmse = 0.113740
Validation r2 = 0.890281
Validation mse = 0.012937
Epoch 55
Loss = 2.2241e-02, PNorm = 45.0144, GNorm = 0.3557, lr_0 = 1.0826e-04
Loss = 3.5628e-02, PNorm = 45.0185, GNorm = 1.0497, lr_0 = 1.0603e-04
Validation rmse = 0.113784
Validation r2 = 0.890195
Validation mse = 0.012947
Epoch 56
Loss = 4.4751e-02, PNorm = 45.0222, GNorm = 0.4550, lr_0 = 1.0362e-04
Loss = 4.5786e-02, PNorm = 45.0263, GNorm = 0.4637, lr_0 = 1.0147e-04
Validation rmse = 0.111768
Validation r2 = 0.894053
Validation mse = 0.012492
Epoch 57
Loss = 4.1407e-02, PNorm = 45.0298, GNorm = 1.2950, lr_0 = 1.0000e-04
Loss = 4.0410e-02, PNorm = 45.0333, GNorm = 0.8244, lr_0 = 1.0000e-04
Validation rmse = 0.111230
Validation r2 = 0.895071
Validation mse = 0.012372
Epoch 58
Loss = 3.9900e-02, PNorm = 45.0371, GNorm = 0.7156, lr_0 = 1.0000e-04
Loss = 4.4858e-02, PNorm = 45.0410, GNorm = 0.9851, lr_0 = 1.0000e-04
Validation rmse = 0.110962
Validation r2 = 0.895576
Validation mse = 0.012312
Epoch 59
Loss = 3.4591e-02, PNorm = 45.0450, GNorm = 0.6770, lr_0 = 1.0000e-04
Loss = 4.4732e-02, PNorm = 45.0484, GNorm = 0.6029, lr_0 = 1.0000e-04
Validation rmse = 0.102958
Validation r2 = 0.910096
Validation mse = 0.010600
Model 0 best validation rmse = 0.100679 on epoch 19
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.190281
Model 0 test r2 = 0.471166
Model 0 test mse = 0.036207
Ensemble test rmse = 0.190281
Ensemble test r2 = 0.471166
Ensemble test mse = 0.036207
Fold 4
Splitting data with seed 4
Total size = 973 | train size = 963 | val size = 10 | test size = 59
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.8275e-01, PNorm = 43.2619, GNorm = 2.8153, lr_0 = 3.6053e-04
Validation rmse = 0.438092
Validation r2 = -0.605239
Validation mse = 0.191925
Epoch 1
Loss = 7.2016e-01, PNorm = 43.2917, GNorm = 15.6945, lr_0 = 6.2105e-04
Loss = 7.3096e-01, PNorm = 43.3259, GNorm = 2.9420, lr_0 = 8.5789e-04
Validation rmse = 0.333005
Validation r2 = 0.072509
Validation mse = 0.110892
Epoch 2
Loss = 6.2759e-01, PNorm = 43.3958, GNorm = 2.9289, lr_0 = 9.8961e-04
Loss = 4.6725e-01, PNorm = 43.4820, GNorm = 1.6136, lr_0 = 9.6914e-04
Validation rmse = 0.324805
Validation r2 = 0.117623
Validation mse = 0.105498
Epoch 3
Loss = 4.2634e-01, PNorm = 43.5686, GNorm = 4.5865, lr_0 = 9.4712e-04
Loss = 2.7885e-01, PNorm = 43.6317, GNorm = 1.9282, lr_0 = 9.2754e-04
Validation rmse = 0.232172
Validation r2 = 0.549155
Validation mse = 0.053904
Epoch 4
Loss = 3.3933e-01, PNorm = 43.6911, GNorm = 8.0091, lr_0 = 9.0836e-04
Loss = 3.0928e-01, PNorm = 43.7434, GNorm = 2.4358, lr_0 = 8.8958e-04
Validation rmse = 0.203361
Validation r2 = 0.654105
Validation mse = 0.041356
Epoch 5
Loss = 2.2132e-01, PNorm = 43.8047, GNorm = 0.9587, lr_0 = 8.6936e-04
Loss = 2.0617e-01, PNorm = 43.8489, GNorm = 2.7303, lr_0 = 8.5139e-04
Validation rmse = 0.244522
Validation r2 = 0.499914
Validation mse = 0.059791
Epoch 6
Loss = 2.9156e-01, PNorm = 43.8890, GNorm = 2.2062, lr_0 = 8.3204e-04
Loss = 2.3229e-01, PNorm = 43.9321, GNorm = 4.6747, lr_0 = 8.1484e-04
Validation rmse = 0.238830
Validation r2 = 0.522923
Validation mse = 0.057040
Epoch 7
Loss = 1.5447e-01, PNorm = 43.9790, GNorm = 3.0794, lr_0 = 7.9632e-04
Loss = 1.4673e-01, PNorm = 44.0101, GNorm = 2.3991, lr_0 = 7.7986e-04
Validation rmse = 0.206696
Validation r2 = 0.642666
Validation mse = 0.042723
Epoch 8
Loss = 1.2280e-01, PNorm = 44.0356, GNorm = 3.6331, lr_0 = 7.6373e-04
Loss = 1.7869e-01, PNorm = 44.0604, GNorm = 4.7110, lr_0 = 7.4794e-04
Validation rmse = 0.183642
Validation r2 = 0.717933
Validation mse = 0.033724
Epoch 9
Loss = 1.5401e-01, PNorm = 44.0778, GNorm = 3.2041, lr_0 = 7.3094e-04
Loss = 1.7086e-01, PNorm = 44.1077, GNorm = 1.0721, lr_0 = 7.1583e-04
Validation rmse = 0.190951
Validation r2 = 0.695032
Validation mse = 0.036462
Epoch 10
Loss = 1.4307e-01, PNorm = 44.1354, GNorm = 3.8590, lr_0 = 6.9956e-04
Loss = 1.4659e-01, PNorm = 44.1605, GNorm = 0.9996, lr_0 = 6.8510e-04
Validation rmse = 0.179782
Validation r2 = 0.729665
Validation mse = 0.032322
Epoch 11
Loss = 1.0365e-01, PNorm = 44.1869, GNorm = 1.7160, lr_0 = 6.6953e-04
Loss = 1.2610e-01, PNorm = 44.2011, GNorm = 0.8151, lr_0 = 6.5569e-04
Validation rmse = 0.188725
Validation r2 = 0.702100
Validation mse = 0.035617
Epoch 12
Loss = 9.8934e-02, PNorm = 44.2140, GNorm = 0.6206, lr_0 = 6.4213e-04
Loss = 1.1566e-01, PNorm = 44.2307, GNorm = 1.1799, lr_0 = 6.2885e-04
Loss = 1.3238e-01, PNorm = 44.2318, GNorm = 1.8781, lr_0 = 6.2754e-04
Validation rmse = 0.183088
Validation r2 = 0.719630
Validation mse = 0.033521
Epoch 13
Loss = 1.0186e-01, PNorm = 44.2452, GNorm = 1.6217, lr_0 = 6.1456e-04
Validation rmse = 0.187562
Validation r2 = 0.705761
Validation mse = 0.035180
Epoch 14
Loss = 9.3678e-02, PNorm = 44.2621, GNorm = 0.9932, lr_0 = 6.0060e-04
Loss = 1.0548e-01, PNorm = 44.2823, GNorm = 1.2140, lr_0 = 5.8818e-04
Validation rmse = 0.184664
Validation r2 = 0.714783
Validation mse = 0.034101
Epoch 15
Loss = 8.7344e-02, PNorm = 44.2954, GNorm = 0.4578, lr_0 = 5.7482e-04
Loss = 9.8097e-02, PNorm = 44.3087, GNorm = 2.7035, lr_0 = 5.6293e-04
Validation rmse = 0.196338
Validation r2 = 0.677585
Validation mse = 0.038548
Epoch 16
Loss = 1.1240e-01, PNorm = 44.3271, GNorm = 2.7131, lr_0 = 5.5129e-04
Loss = 1.0760e-01, PNorm = 44.3455, GNorm = 1.6433, lr_0 = 5.3989e-04
Validation rmse = 0.172209
Validation r2 = 0.751961
Validation mse = 0.029656
Epoch 17
Loss = 1.0868e-01, PNorm = 44.3622, GNorm = 0.9395, lr_0 = 5.2762e-04
Loss = 9.5990e-02, PNorm = 44.3786, GNorm = 0.9883, lr_0 = 5.1671e-04
Validation rmse = 0.167020
Validation r2 = 0.766682
Validation mse = 0.027896
Epoch 18
Loss = 8.1439e-02, PNorm = 44.3971, GNorm = 0.6432, lr_0 = 5.0497e-04
Loss = 9.2742e-02, PNorm = 44.4142, GNorm = 1.7739, lr_0 = 4.9453e-04
Validation rmse = 0.183537
Validation r2 = 0.718256
Validation mse = 0.033686
Epoch 19
Loss = 8.8865e-02, PNorm = 44.4297, GNorm = 1.7277, lr_0 = 4.8329e-04
Loss = 1.0623e-01, PNorm = 44.4391, GNorm = 1.0032, lr_0 = 4.7330e-04
Validation rmse = 0.198761
Validation r2 = 0.669575
Validation mse = 0.039506
Epoch 20
Loss = 1.0894e-01, PNorm = 44.4551, GNorm = 1.8847, lr_0 = 4.6351e-04
Loss = 9.9141e-02, PNorm = 44.4687, GNorm = 2.3924, lr_0 = 4.5393e-04
Validation rmse = 0.182047
Validation r2 = 0.722810
Validation mse = 0.033141
Epoch 21
Loss = 8.5907e-02, PNorm = 44.4809, GNorm = 0.8459, lr_0 = 4.4361e-04
Loss = 9.4458e-02, PNorm = 44.4944, GNorm = 1.1082, lr_0 = 4.3444e-04
Validation rmse = 0.188862
Validation r2 = 0.701669
Validation mse = 0.035669
Epoch 22
Loss = 1.0427e-01, PNorm = 44.5039, GNorm = 2.1037, lr_0 = 4.2457e-04
Loss = 8.2733e-02, PNorm = 44.5152, GNorm = 1.1378, lr_0 = 4.1579e-04
Validation rmse = 0.177420
Validation r2 = 0.736721
Validation mse = 0.031478
Epoch 23
Loss = 7.1802e-02, PNorm = 44.5281, GNorm = 1.4848, lr_0 = 4.0634e-04
Loss = 8.5925e-02, PNorm = 44.5381, GNorm = 0.8940, lr_0 = 3.9794e-04
Validation rmse = 0.179103
Validation r2 = 0.731702
Validation mse = 0.032078
Epoch 24
Loss = 8.8754e-02, PNorm = 44.5505, GNorm = 1.5479, lr_0 = 3.8971e-04
Loss = 8.1868e-02, PNorm = 44.5618, GNorm = 0.7817, lr_0 = 3.8165e-04
Validation rmse = 0.197942
Validation r2 = 0.672295
Validation mse = 0.039181
Epoch 25
Loss = 1.1492e-01, PNorm = 44.5755, GNorm = 2.8295, lr_0 = 3.7298e-04
Loss = 9.0141e-02, PNorm = 44.5917, GNorm = 1.2447, lr_0 = 3.6527e-04
Loss = 5.7479e-02, PNorm = 44.5933, GNorm = 1.0170, lr_0 = 3.6451e-04
Validation rmse = 0.181931
Validation r2 = 0.723164
Validation mse = 0.033099
Epoch 26
Loss = 7.5067e-02, PNorm = 44.6045, GNorm = 1.5691, lr_0 = 3.5697e-04
Loss = 8.8657e-02, PNorm = 44.6171, GNorm = 1.0964, lr_0 = 3.4959e-04
Validation rmse = 0.176373
Validation r2 = 0.739821
Validation mse = 0.031107
Epoch 27
Loss = 6.5813e-02, PNorm = 44.6262, GNorm = 0.9295, lr_0 = 3.4236e-04
Validation rmse = 0.173921
Validation r2 = 0.747004
Validation mse = 0.030248
Epoch 28
Loss = 4.6443e-02, PNorm = 44.6371, GNorm = 0.7977, lr_0 = 3.3458e-04
Loss = 7.6648e-02, PNorm = 44.6479, GNorm = 1.3271, lr_0 = 3.2766e-04
Validation rmse = 0.173839
Validation r2 = 0.747243
Validation mse = 0.030220
Epoch 29
Loss = 8.9070e-02, PNorm = 44.6579, GNorm = 1.7734, lr_0 = 3.2022e-04
Loss = 8.1808e-02, PNorm = 44.6682, GNorm = 1.1967, lr_0 = 3.1360e-04
Validation rmse = 0.177601
Validation r2 = 0.736185
Validation mse = 0.031542
Epoch 30
Loss = 6.9025e-02, PNorm = 44.6767, GNorm = 1.1617, lr_0 = 3.0647e-04
Loss = 7.6885e-02, PNorm = 44.6851, GNorm = 1.8901, lr_0 = 3.0013e-04
Validation rmse = 0.164796
Validation r2 = 0.772855
Validation mse = 0.027158
Epoch 31
Loss = 6.7733e-02, PNorm = 44.6943, GNorm = 1.2376, lr_0 = 2.9393e-04
Loss = 6.6893e-02, PNorm = 44.7040, GNorm = 0.5845, lr_0 = 2.8785e-04
Validation rmse = 0.176647
Validation r2 = 0.739012
Validation mse = 0.031204
Epoch 32
Loss = 6.5528e-02, PNorm = 44.7137, GNorm = 1.3263, lr_0 = 2.8131e-04
Loss = 7.5855e-02, PNorm = 44.7242, GNorm = 1.6758, lr_0 = 2.7549e-04
Validation rmse = 0.173983
Validation r2 = 0.746824
Validation mse = 0.030270
Epoch 33
Loss = 7.3302e-02, PNorm = 44.7331, GNorm = 1.1448, lr_0 = 2.6923e-04
Loss = 6.2420e-02, PNorm = 44.7414, GNorm = 1.3933, lr_0 = 2.6367e-04
Validation rmse = 0.175370
Validation r2 = 0.742772
Validation mse = 0.030755
Epoch 34
Loss = 6.2887e-02, PNorm = 44.7495, GNorm = 0.9047, lr_0 = 2.5767e-04
Loss = 6.8306e-02, PNorm = 44.7572, GNorm = 2.2013, lr_0 = 2.5235e-04
Validation rmse = 0.176285
Validation r2 = 0.740079
Validation mse = 0.031077
Epoch 35
Loss = 5.7621e-02, PNorm = 44.7657, GNorm = 0.4374, lr_0 = 2.4713e-04
Loss = 6.8311e-02, PNorm = 44.7748, GNorm = 0.6697, lr_0 = 2.4202e-04
Validation rmse = 0.169284
Validation r2 = 0.760316
Validation mse = 0.028657
Epoch 36
Loss = 7.7840e-02, PNorm = 44.7816, GNorm = 1.3187, lr_0 = 2.3652e-04
Loss = 5.5852e-02, PNorm = 44.7891, GNorm = 0.7586, lr_0 = 2.3163e-04
Validation rmse = 0.166315
Validation r2 = 0.768648
Validation mse = 0.027661
Epoch 37
Loss = 5.9970e-02, PNorm = 44.7979, GNorm = 1.7933, lr_0 = 2.2637e-04
Loss = 5.9864e-02, PNorm = 44.8068, GNorm = 0.7053, lr_0 = 2.2168e-04
Validation rmse = 0.167737
Validation r2 = 0.764676
Validation mse = 0.028136
Epoch 38
Loss = 5.6057e-02, PNorm = 44.8150, GNorm = 0.6448, lr_0 = 2.1665e-04
Loss = 5.9351e-02, PNorm = 44.8230, GNorm = 1.2392, lr_0 = 2.1217e-04
Validation rmse = 0.167967
Validation r2 = 0.764031
Validation mse = 0.028213
Epoch 39
Loss = 5.9490e-02, PNorm = 44.8299, GNorm = 1.1151, lr_0 = 2.0778e-04
Loss = 5.9070e-02, PNorm = 44.8365, GNorm = 1.2382, lr_0 = 2.0348e-04
Loss = 1.2258e-01, PNorm = 44.8374, GNorm = 1.5701, lr_0 = 2.0306e-04
Validation rmse = 0.171807
Validation r2 = 0.753118
Validation mse = 0.029518
Epoch 40
Loss = 5.6604e-02, PNorm = 44.8453, GNorm = 0.4997, lr_0 = 1.9886e-04
Validation rmse = 0.171985
Validation r2 = 0.752605
Validation mse = 0.029579
Epoch 41
Loss = 5.8239e-02, PNorm = 44.8536, GNorm = 0.9513, lr_0 = 1.9434e-04
Loss = 5.3703e-02, PNorm = 44.8599, GNorm = 1.1650, lr_0 = 1.9032e-04
Validation rmse = 0.163662
Validation r2 = 0.775970
Validation mse = 0.026785
Epoch 42
Loss = 4.0073e-02, PNorm = 44.8690, GNorm = 1.5018, lr_0 = 1.8600e-04
Loss = 6.6722e-02, PNorm = 44.8757, GNorm = 0.6053, lr_0 = 1.8215e-04
Validation rmse = 0.165753
Validation r2 = 0.770211
Validation mse = 0.027474
Epoch 43
Loss = 5.3557e-02, PNorm = 44.8835, GNorm = 1.8256, lr_0 = 1.7839e-04
Loss = 5.7952e-02, PNorm = 44.8900, GNorm = 0.7978, lr_0 = 1.7470e-04
Validation rmse = 0.173237
Validation r2 = 0.748991
Validation mse = 0.030011
Epoch 44
Loss = 6.6309e-02, PNorm = 44.8973, GNorm = 1.3719, lr_0 = 1.7073e-04
Loss = 5.2257e-02, PNorm = 44.9040, GNorm = 1.1025, lr_0 = 1.6720e-04
Validation rmse = 0.162674
Validation r2 = 0.778666
Validation mse = 0.026463
Epoch 45
Loss = 5.1712e-02, PNorm = 44.9095, GNorm = 0.3939, lr_0 = 1.6340e-04
Loss = 4.5766e-02, PNorm = 44.9160, GNorm = 0.7453, lr_0 = 1.6002e-04
Validation rmse = 0.168011
Validation r2 = 0.763907
Validation mse = 0.028228
Epoch 46
Loss = 5.4138e-02, PNorm = 44.9212, GNorm = 0.6076, lr_0 = 1.5638e-04
Loss = 5.0751e-02, PNorm = 44.9279, GNorm = 0.9582, lr_0 = 1.5315e-04
Validation rmse = 0.162914
Validation r2 = 0.778014
Validation mse = 0.026541
Epoch 47
Loss = 5.6896e-02, PNorm = 44.9329, GNorm = 1.1241, lr_0 = 1.4998e-04
Loss = 4.9370e-02, PNorm = 44.9377, GNorm = 1.6829, lr_0 = 1.4688e-04
Validation rmse = 0.164236
Validation r2 = 0.774397
Validation mse = 0.026973
Epoch 48
Loss = 5.8458e-02, PNorm = 44.9443, GNorm = 1.5043, lr_0 = 1.4354e-04
Loss = 5.0493e-02, PNorm = 44.9490, GNorm = 2.1906, lr_0 = 1.4058e-04
Validation rmse = 0.167352
Validation r2 = 0.765755
Validation mse = 0.028007
Epoch 49
Loss = 5.7674e-02, PNorm = 44.9559, GNorm = 1.8002, lr_0 = 1.3738e-04
Loss = 4.3612e-02, PNorm = 44.9616, GNorm = 0.9081, lr_0 = 1.3454e-04
Validation rmse = 0.162995
Validation r2 = 0.777792
Validation mse = 0.026568
Epoch 50
Loss = 5.2265e-02, PNorm = 44.9662, GNorm = 1.1838, lr_0 = 1.3176e-04
Loss = 4.8369e-02, PNorm = 44.9722, GNorm = 0.7801, lr_0 = 1.2904e-04
Validation rmse = 0.155240
Validation r2 = 0.798434
Validation mse = 0.024100
Epoch 51
Loss = 5.5996e-02, PNorm = 44.9771, GNorm = 0.8121, lr_0 = 1.2610e-04
Loss = 5.1941e-02, PNorm = 44.9820, GNorm = 2.1177, lr_0 = 1.2350e-04
Validation rmse = 0.157562
Validation r2 = 0.792359
Validation mse = 0.024826
Epoch 52
Loss = 4.8419e-02, PNorm = 44.9885, GNorm = 0.9562, lr_0 = 1.2069e-04
Loss = 4.7629e-02, PNorm = 44.9929, GNorm = 0.7997, lr_0 = 1.1819e-04
Loss = 2.0051e-02, PNorm = 44.9934, GNorm = 1.0661, lr_0 = 1.1795e-04
Validation rmse = 0.163758
Validation r2 = 0.775709
Validation mse = 0.026817
Epoch 53
Loss = 4.6101e-02, PNorm = 44.9974, GNorm = 0.4251, lr_0 = 1.1551e-04
Loss = 4.7940e-02, PNorm = 45.0021, GNorm = 1.5782, lr_0 = 1.1312e-04
Validation rmse = 0.155570
Validation r2 = 0.797577
Validation mse = 0.024202
Epoch 54
Loss = 4.4180e-02, PNorm = 45.0054, GNorm = 0.9319, lr_0 = 1.1078e-04
Validation rmse = 0.155468
Validation r2 = 0.797841
Validation mse = 0.024170
Epoch 55
Loss = 4.0727e-02, PNorm = 45.0100, GNorm = 1.0158, lr_0 = 1.0826e-04
Loss = 4.5996e-02, PNorm = 45.0142, GNorm = 0.5944, lr_0 = 1.0603e-04
Validation rmse = 0.159136
Validation r2 = 0.788191
Validation mse = 0.025324
Epoch 56
Loss = 3.7146e-02, PNorm = 45.0187, GNorm = 0.5508, lr_0 = 1.0362e-04
Loss = 4.0532e-02, PNorm = 45.0222, GNorm = 1.2649, lr_0 = 1.0147e-04
Validation rmse = 0.151126
Validation r2 = 0.808977
Validation mse = 0.022839
Epoch 57
Loss = 4.1667e-02, PNorm = 45.0264, GNorm = 0.9566, lr_0 = 1.0000e-04
Loss = 4.5466e-02, PNorm = 45.0307, GNorm = 0.6384, lr_0 = 1.0000e-04
Validation rmse = 0.153790
Validation r2 = 0.802183
Validation mse = 0.023651
Epoch 58
Loss = 6.4516e-02, PNorm = 45.0345, GNorm = 2.7669, lr_0 = 1.0000e-04
Loss = 4.5597e-02, PNorm = 45.0382, GNorm = 1.0039, lr_0 = 1.0000e-04
Validation rmse = 0.157600
Validation r2 = 0.792258
Validation mse = 0.024838
Epoch 59
Loss = 5.3529e-02, PNorm = 45.0429, GNorm = 0.6836, lr_0 = 1.0000e-04
Loss = 4.3436e-02, PNorm = 45.0474, GNorm = 1.1117, lr_0 = 1.0000e-04
Validation rmse = 0.158952
Validation r2 = 0.788680
Validation mse = 0.025266
Model 0 best validation rmse = 0.151126 on epoch 56
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.182744
Model 0 test r2 = 0.512231
Model 0 test mse = 0.033395
Ensemble test rmse = 0.182744
Ensemble test r2 = 0.512231
Ensemble test mse = 0.033395
Fold 5
Splitting data with seed 5
Total size = 973 | train size = 963 | val size = 10 | test size = 59
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.3560e-01, PNorm = 43.2618, GNorm = 3.2926, lr_0 = 3.6053e-04
Validation rmse = 0.299592
Validation r2 = -1.350486
Validation mse = 0.089755
Epoch 1
Loss = 1.0326e+00, PNorm = 43.2849, GNorm = 7.9261, lr_0 = 6.2105e-04
Loss = 8.0772e-01, PNorm = 43.3220, GNorm = 2.6490, lr_0 = 8.5789e-04
Validation rmse = 0.186560
Validation r2 = 0.088548
Validation mse = 0.034805
Epoch 2
Loss = 6.8550e-01, PNorm = 43.3998, GNorm = 2.9993, lr_0 = 9.8961e-04
Loss = 5.0260e-01, PNorm = 43.4849, GNorm = 1.9104, lr_0 = 9.6914e-04
Validation rmse = 0.153147
Validation r2 = 0.385793
Validation mse = 0.023454
Epoch 3
Loss = 3.7123e-01, PNorm = 43.5735, GNorm = 2.7449, lr_0 = 9.4712e-04
Loss = 3.3354e-01, PNorm = 43.6349, GNorm = 1.8561, lr_0 = 9.2754e-04
Validation rmse = 0.188120
Validation r2 = 0.073236
Validation mse = 0.035389
Epoch 4
Loss = 3.3397e-01, PNorm = 43.6992, GNorm = 2.5648, lr_0 = 9.0836e-04
Loss = 3.4461e-01, PNorm = 43.7569, GNorm = 3.6151, lr_0 = 8.8958e-04
Validation rmse = 0.177393
Validation r2 = 0.175914
Validation mse = 0.031468
Epoch 5
Loss = 2.2271e-01, PNorm = 43.8100, GNorm = 2.6603, lr_0 = 8.6936e-04
Loss = 1.8612e-01, PNorm = 43.8536, GNorm = 0.9427, lr_0 = 8.5139e-04
Validation rmse = 0.163849
Validation r2 = 0.296956
Validation mse = 0.026846
Epoch 6
Loss = 1.8488e-01, PNorm = 43.8908, GNorm = 2.3577, lr_0 = 8.3204e-04
Loss = 1.8219e-01, PNorm = 43.9256, GNorm = 5.1384, lr_0 = 8.1484e-04
Validation rmse = 0.234530
Validation r2 = -0.440438
Validation mse = 0.055004
Epoch 7
Loss = 1.8045e-01, PNorm = 43.9648, GNorm = 1.0719, lr_0 = 7.9632e-04
Loss = 1.5808e-01, PNorm = 43.9961, GNorm = 1.2170, lr_0 = 7.7986e-04
Validation rmse = 0.204422
Validation r2 = -0.094335
Validation mse = 0.041788
Epoch 8
Loss = 1.6943e-01, PNorm = 44.0263, GNorm = 2.5996, lr_0 = 7.6373e-04
Loss = 1.2943e-01, PNorm = 44.0527, GNorm = 1.2178, lr_0 = 7.4794e-04
Validation rmse = 0.165311
Validation r2 = 0.284347
Validation mse = 0.027328
Epoch 9
Loss = 1.3847e-01, PNorm = 44.0702, GNorm = 1.9773, lr_0 = 7.3094e-04
Loss = 1.1530e-01, PNorm = 44.0915, GNorm = 2.2244, lr_0 = 7.1583e-04
Validation rmse = 0.157851
Validation r2 = 0.347479
Validation mse = 0.024917
Epoch 10
Loss = 1.4560e-01, PNorm = 44.1136, GNorm = 1.1493, lr_0 = 6.9956e-04
Loss = 1.3157e-01, PNorm = 44.1399, GNorm = 1.1940, lr_0 = 6.8510e-04
Validation rmse = 0.175308
Validation r2 = 0.195176
Validation mse = 0.030733
Epoch 11
Loss = 1.3028e-01, PNorm = 44.1635, GNorm = 0.8397, lr_0 = 6.6953e-04
Loss = 1.2642e-01, PNorm = 44.1844, GNorm = 3.3033, lr_0 = 6.5569e-04
Validation rmse = 0.160229
Validation r2 = 0.327678
Validation mse = 0.025673
Epoch 12
Loss = 1.5235e-01, PNorm = 44.2043, GNorm = 3.6205, lr_0 = 6.4213e-04
Loss = 1.3294e-01, PNorm = 44.2302, GNorm = 2.1588, lr_0 = 6.2885e-04
Loss = 1.2427e-01, PNorm = 44.2339, GNorm = 2.1801, lr_0 = 6.2754e-04
Validation rmse = 0.180599
Validation r2 = 0.145866
Validation mse = 0.032616
Epoch 13
Loss = 1.0944e-01, PNorm = 44.2614, GNorm = 0.9618, lr_0 = 6.1456e-04
Validation rmse = 0.155178
Validation r2 = 0.369395
Validation mse = 0.024080
Epoch 14
Loss = 9.5662e-02, PNorm = 44.2808, GNorm = 0.8713, lr_0 = 6.0060e-04
Loss = 1.0075e-01, PNorm = 44.2957, GNorm = 1.7989, lr_0 = 5.8818e-04
Validation rmse = 0.142992
Validation r2 = 0.464551
Validation mse = 0.020447
Epoch 15
Loss = 1.0066e-01, PNorm = 44.3145, GNorm = 1.3229, lr_0 = 5.7482e-04
Loss = 9.1448e-02, PNorm = 44.3286, GNorm = 0.6381, lr_0 = 5.6293e-04
Validation rmse = 0.157097
Validation r2 = 0.353698
Validation mse = 0.024680
Epoch 16
Loss = 8.0867e-02, PNorm = 44.3413, GNorm = 0.8804, lr_0 = 5.5129e-04
Loss = 9.4765e-02, PNorm = 44.3576, GNorm = 1.2305, lr_0 = 5.3989e-04
Validation rmse = 0.135503
Validation r2 = 0.519169
Validation mse = 0.018361
Epoch 17
Loss = 8.8903e-02, PNorm = 44.3717, GNorm = 1.5566, lr_0 = 5.2762e-04
Loss = 9.0228e-02, PNorm = 44.3886, GNorm = 1.1176, lr_0 = 5.1671e-04
Validation rmse = 0.165983
Validation r2 = 0.278524
Validation mse = 0.027550
Epoch 18
Loss = 8.4784e-02, PNorm = 44.4027, GNorm = 2.1299, lr_0 = 5.0497e-04
Loss = 1.0170e-01, PNorm = 44.4141, GNorm = 1.1901, lr_0 = 4.9453e-04
Validation rmse = 0.134482
Validation r2 = 0.526388
Validation mse = 0.018085
Epoch 19
Loss = 1.1011e-01, PNorm = 44.4341, GNorm = 3.3473, lr_0 = 4.8329e-04
Loss = 1.0296e-01, PNorm = 44.4501, GNorm = 2.0382, lr_0 = 4.7330e-04
Validation rmse = 0.203626
Validation r2 = -0.085836
Validation mse = 0.041464
Epoch 20
Loss = 1.6580e-01, PNorm = 44.4672, GNorm = 4.9260, lr_0 = 4.6351e-04
Loss = 9.0072e-02, PNorm = 44.4916, GNorm = 0.9358, lr_0 = 4.5393e-04
Validation rmse = 0.170631
Validation r2 = 0.237547
Validation mse = 0.029115
Epoch 21
Loss = 7.7869e-02, PNorm = 44.5062, GNorm = 0.4891, lr_0 = 4.4361e-04
Loss = 9.0861e-02, PNorm = 44.5189, GNorm = 1.2234, lr_0 = 4.3444e-04
Validation rmse = 0.150208
Validation r2 = 0.409144
Validation mse = 0.022562
Epoch 22
Loss = 8.2423e-02, PNorm = 44.5315, GNorm = 1.0107, lr_0 = 4.2457e-04
Loss = 8.5553e-02, PNorm = 44.5403, GNorm = 0.8914, lr_0 = 4.1579e-04
Validation rmse = 0.157859
Validation r2 = 0.347414
Validation mse = 0.024920
Epoch 23
Loss = 7.1390e-02, PNorm = 44.5523, GNorm = 1.4539, lr_0 = 4.0634e-04
Loss = 8.7821e-02, PNorm = 44.5629, GNorm = 1.8331, lr_0 = 3.9794e-04
Validation rmse = 0.161204
Validation r2 = 0.319465
Validation mse = 0.025987
Epoch 24
Loss = 8.4494e-02, PNorm = 44.5717, GNorm = 1.0419, lr_0 = 3.8971e-04
Loss = 7.7780e-02, PNorm = 44.5854, GNorm = 0.8540, lr_0 = 3.8165e-04
Validation rmse = 0.156897
Validation r2 = 0.355344
Validation mse = 0.024617
Epoch 25
Loss = 9.2830e-02, PNorm = 44.5972, GNorm = 1.1239, lr_0 = 3.7298e-04
Loss = 9.2186e-02, PNorm = 44.6125, GNorm = 1.3856, lr_0 = 3.6527e-04
Loss = 1.2785e-01, PNorm = 44.6137, GNorm = 1.8329, lr_0 = 3.6451e-04
Validation rmse = 0.138953
Validation r2 = 0.494367
Validation mse = 0.019308
Epoch 26
Loss = 9.8582e-02, PNorm = 44.6275, GNorm = 3.1924, lr_0 = 3.5697e-04
Loss = 8.8940e-02, PNorm = 44.6383, GNorm = 2.4430, lr_0 = 3.4959e-04
Validation rmse = 0.143202
Validation r2 = 0.462971
Validation mse = 0.020507
Epoch 27
Loss = 7.8816e-02, PNorm = 44.6511, GNorm = 0.9037, lr_0 = 3.4236e-04
Validation rmse = 0.160751
Validation r2 = 0.323287
Validation mse = 0.025841
Epoch 28
Loss = 4.6482e-02, PNorm = 44.6630, GNorm = 0.5827, lr_0 = 3.3458e-04
Loss = 8.8225e-02, PNorm = 44.6729, GNorm = 3.2271, lr_0 = 3.2766e-04
Validation rmse = 0.167682
Validation r2 = 0.263670
Validation mse = 0.028117
Epoch 29
Loss = 7.8948e-02, PNorm = 44.6850, GNorm = 1.4646, lr_0 = 3.2022e-04
Loss = 7.8330e-02, PNorm = 44.6965, GNorm = 2.9485, lr_0 = 3.1360e-04
Validation rmse = 0.172973
Validation r2 = 0.216476
Validation mse = 0.029920
Epoch 30
Loss = 1.0539e-01, PNorm = 44.7083, GNorm = 2.2855, lr_0 = 3.0647e-04
Loss = 7.4247e-02, PNorm = 44.7166, GNorm = 1.2226, lr_0 = 3.0013e-04
Validation rmse = 0.145830
Validation r2 = 0.443085
Validation mse = 0.021266
Epoch 31
Loss = 6.8152e-02, PNorm = 44.7275, GNorm = 0.8819, lr_0 = 2.9393e-04
Loss = 6.7117e-02, PNorm = 44.7372, GNorm = 0.7327, lr_0 = 2.8785e-04
Validation rmse = 0.149242
Validation r2 = 0.416717
Validation mse = 0.022273
Epoch 32
Loss = 5.8546e-02, PNorm = 44.7470, GNorm = 1.1371, lr_0 = 2.8131e-04
Loss = 6.5378e-02, PNorm = 44.7548, GNorm = 1.2355, lr_0 = 2.7549e-04
Validation rmse = 0.154290
Validation r2 = 0.376587
Validation mse = 0.023806
Epoch 33
Loss = 7.1967e-02, PNorm = 44.7645, GNorm = 1.9173, lr_0 = 2.6923e-04
Loss = 6.8282e-02, PNorm = 44.7744, GNorm = 1.0329, lr_0 = 2.6367e-04
Validation rmse = 0.150412
Validation r2 = 0.407535
Validation mse = 0.022624
Epoch 34
Loss = 6.8114e-02, PNorm = 44.7822, GNorm = 0.8289, lr_0 = 2.5767e-04
Loss = 7.5062e-02, PNorm = 44.7902, GNorm = 0.9230, lr_0 = 2.5235e-04
Validation rmse = 0.159902
Validation r2 = 0.330414
Validation mse = 0.025569
Epoch 35
Loss = 6.1676e-02, PNorm = 44.7986, GNorm = 1.7500, lr_0 = 2.4713e-04
Loss = 6.9758e-02, PNorm = 44.8078, GNorm = 0.6174, lr_0 = 2.4202e-04
Validation rmse = 0.151474
Validation r2 = 0.399137
Validation mse = 0.022944
Epoch 36
Loss = 5.9043e-02, PNorm = 44.8170, GNorm = 0.5338, lr_0 = 2.3652e-04
Loss = 6.2238e-02, PNorm = 44.8243, GNorm = 1.7960, lr_0 = 2.3163e-04
Validation rmse = 0.179238
Validation r2 = 0.158688
Validation mse = 0.032126
Epoch 37
Loss = 6.3900e-02, PNorm = 44.8324, GNorm = 1.3987, lr_0 = 2.2637e-04
Loss = 6.8184e-02, PNorm = 44.8403, GNorm = 2.6094, lr_0 = 2.2168e-04
Validation rmse = 0.156512
Validation r2 = 0.358509
Validation mse = 0.024496
Epoch 38
Loss = 6.3886e-02, PNorm = 44.8504, GNorm = 1.5837, lr_0 = 2.1665e-04
Loss = 6.0546e-02, PNorm = 44.8579, GNorm = 0.6170, lr_0 = 2.1217e-04
Validation rmse = 0.158542
Validation r2 = 0.341757
Validation mse = 0.025136
Epoch 39
Loss = 5.5613e-02, PNorm = 44.8640, GNorm = 0.7132, lr_0 = 2.0778e-04
Loss = 6.1179e-02, PNorm = 44.8706, GNorm = 1.1950, lr_0 = 2.0348e-04
Loss = 1.0456e-01, PNorm = 44.8709, GNorm = 1.0252, lr_0 = 2.0306e-04
Validation rmse = 0.133684
Validation r2 = 0.531992
Validation mse = 0.017871
Epoch 40
Loss = 5.8386e-02, PNorm = 44.8775, GNorm = 1.1522, lr_0 = 1.9886e-04
Validation rmse = 0.154989
Validation r2 = 0.370931
Validation mse = 0.024022
Epoch 41
Loss = 4.9194e-02, PNorm = 44.8864, GNorm = 0.5112, lr_0 = 1.9434e-04
Loss = 6.5240e-02, PNorm = 44.8935, GNorm = 0.4137, lr_0 = 1.9032e-04
Validation rmse = 0.144214
Validation r2 = 0.455359
Validation mse = 0.020798
Epoch 42
Loss = 4.2046e-02, PNorm = 44.8997, GNorm = 0.3645, lr_0 = 1.8600e-04
Loss = 5.3089e-02, PNorm = 44.9060, GNorm = 0.8518, lr_0 = 1.8215e-04
Validation rmse = 0.134360
Validation r2 = 0.527245
Validation mse = 0.018053
Epoch 43
Loss = 7.5823e-02, PNorm = 44.9122, GNorm = 2.3321, lr_0 = 1.7839e-04
Loss = 6.0264e-02, PNorm = 44.9182, GNorm = 1.0277, lr_0 = 1.7470e-04
Validation rmse = 0.142583
Validation r2 = 0.467608
Validation mse = 0.020330
Epoch 44
Loss = 4.7991e-02, PNorm = 44.9254, GNorm = 1.2288, lr_0 = 1.7073e-04
Loss = 5.7477e-02, PNorm = 44.9323, GNorm = 0.7857, lr_0 = 1.6720e-04
Validation rmse = 0.148299
Validation r2 = 0.424064
Validation mse = 0.021993
Epoch 45
Loss = 6.2559e-02, PNorm = 44.9396, GNorm = 1.0496, lr_0 = 1.6340e-04
Loss = 5.4084e-02, PNorm = 44.9464, GNorm = 0.5962, lr_0 = 1.6002e-04
Validation rmse = 0.141424
Validation r2 = 0.476224
Validation mse = 0.020001
Epoch 46
Loss = 6.0049e-02, PNorm = 44.9519, GNorm = 0.7802, lr_0 = 1.5638e-04
Loss = 5.0577e-02, PNorm = 44.9584, GNorm = 0.7510, lr_0 = 1.5315e-04
Validation rmse = 0.143844
Validation r2 = 0.458148
Validation mse = 0.020691
Epoch 47
Loss = 5.6372e-02, PNorm = 44.9636, GNorm = 0.7017, lr_0 = 1.4998e-04
Loss = 5.1151e-02, PNorm = 44.9686, GNorm = 0.8850, lr_0 = 1.4688e-04
Validation rmse = 0.143871
Validation r2 = 0.457943
Validation mse = 0.020699
Epoch 48
Loss = 6.5186e-02, PNorm = 44.9736, GNorm = 0.8208, lr_0 = 1.4354e-04
Loss = 4.7437e-02, PNorm = 44.9793, GNorm = 0.5572, lr_0 = 1.4058e-04
Validation rmse = 0.143934
Validation r2 = 0.457470
Validation mse = 0.020717
Epoch 49
Loss = 5.6845e-02, PNorm = 44.9859, GNorm = 0.6387, lr_0 = 1.3738e-04
Loss = 4.9428e-02, PNorm = 44.9910, GNorm = 0.5282, lr_0 = 1.3454e-04
Validation rmse = 0.135630
Validation r2 = 0.518264
Validation mse = 0.018396
Epoch 50
Loss = 5.2345e-02, PNorm = 44.9956, GNorm = 0.9504, lr_0 = 1.3176e-04
Loss = 5.2548e-02, PNorm = 45.0003, GNorm = 0.6330, lr_0 = 1.2904e-04
Validation rmse = 0.147572
Validation r2 = 0.429700
Validation mse = 0.021777
Epoch 51
Loss = 4.5038e-02, PNorm = 45.0040, GNorm = 0.5197, lr_0 = 1.2610e-04
Loss = 4.9629e-02, PNorm = 45.0082, GNorm = 0.4205, lr_0 = 1.2350e-04
Validation rmse = 0.138601
Validation r2 = 0.496931
Validation mse = 0.019210
Epoch 52
Loss = 4.5810e-02, PNorm = 45.0128, GNorm = 0.5843, lr_0 = 1.2069e-04
Loss = 4.7968e-02, PNorm = 45.0175, GNorm = 0.7006, lr_0 = 1.1819e-04
Loss = 5.3665e-02, PNorm = 45.0180, GNorm = 1.9905, lr_0 = 1.1795e-04
Validation rmse = 0.160158
Validation r2 = 0.328269
Validation mse = 0.025651
Epoch 53
Loss = 5.1048e-02, PNorm = 45.0224, GNorm = 0.9361, lr_0 = 1.1551e-04
Loss = 4.8707e-02, PNorm = 45.0264, GNorm = 1.8014, lr_0 = 1.1312e-04
Validation rmse = 0.137749
Validation r2 = 0.503096
Validation mse = 0.018975
Epoch 54
Loss = 4.4794e-02, PNorm = 45.0303, GNorm = 1.3234, lr_0 = 1.1078e-04
Validation rmse = 0.138689
Validation r2 = 0.496289
Validation mse = 0.019235
Epoch 55
Loss = 4.0787e-02, PNorm = 45.0344, GNorm = 1.4032, lr_0 = 1.0826e-04
Loss = 4.3867e-02, PNorm = 45.0381, GNorm = 0.9958, lr_0 = 1.0603e-04
Validation rmse = 0.145549
Validation r2 = 0.445227
Validation mse = 0.021184
Epoch 56
Loss = 4.4315e-02, PNorm = 45.0428, GNorm = 0.7360, lr_0 = 1.0362e-04
Loss = 4.3327e-02, PNorm = 45.0473, GNorm = 0.9623, lr_0 = 1.0147e-04
Validation rmse = 0.144907
Validation r2 = 0.450111
Validation mse = 0.020998
Epoch 57
Loss = 4.5711e-02, PNorm = 45.0502, GNorm = 0.4875, lr_0 = 1.0000e-04
Loss = 4.4739e-02, PNorm = 45.0539, GNorm = 0.9887, lr_0 = 1.0000e-04
Validation rmse = 0.141550
Validation r2 = 0.475290
Validation mse = 0.020037
Epoch 58
Loss = 3.4439e-02, PNorm = 45.0576, GNorm = 0.6672, lr_0 = 1.0000e-04
Loss = 4.3381e-02, PNorm = 45.0614, GNorm = 0.9325, lr_0 = 1.0000e-04
Validation rmse = 0.144509
Validation r2 = 0.453129
Validation mse = 0.020883
Epoch 59
Loss = 4.1442e-02, PNorm = 45.0660, GNorm = 1.5856, lr_0 = 1.0000e-04
Loss = 4.8064e-02, PNorm = 45.0695, GNorm = 1.1236, lr_0 = 1.0000e-04
Validation rmse = 0.147792
Validation r2 = 0.427999
Validation mse = 0.021842
Model 0 best validation rmse = 0.133684 on epoch 39
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.175846
Model 0 test r2 = 0.548359
Model 0 test mse = 0.030922
Ensemble test rmse = 0.175846
Ensemble test r2 = 0.548359
Ensemble test mse = 0.030922
Fold 6
Splitting data with seed 6
Total size = 973 | train size = 963 | val size = 10 | test size = 59
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.2724e-01, PNorm = 43.2625, GNorm = 1.5275, lr_0 = 3.6053e-04
Validation rmse = 0.275808
Validation r2 = -0.035846
Validation mse = 0.076070
Epoch 1
Loss = 7.6129e-01, PNorm = 43.2858, GNorm = 1.6467, lr_0 = 6.2105e-04
Loss = 8.5468e-01, PNorm = 43.3162, GNorm = 1.4221, lr_0 = 8.5789e-04
Validation rmse = 0.284584
Validation r2 = -0.102815
Validation mse = 0.080988
Epoch 2
Loss = 5.7262e-01, PNorm = 43.3978, GNorm = 10.8210, lr_0 = 9.8961e-04
Loss = 4.8768e-01, PNorm = 43.4701, GNorm = 6.3318, lr_0 = 9.6914e-04
Validation rmse = 0.225601
Validation r2 = 0.306954
Validation mse = 0.050896
Epoch 3
Loss = 3.5361e-01, PNorm = 43.5524, GNorm = 1.4488, lr_0 = 9.4712e-04
Loss = 3.0498e-01, PNorm = 43.6203, GNorm = 4.3599, lr_0 = 9.2754e-04
Validation rmse = 0.148536
Validation r2 = 0.699569
Validation mse = 0.022063
Epoch 4
Loss = 2.7607e-01, PNorm = 43.6834, GNorm = 4.4579, lr_0 = 9.0836e-04
Loss = 2.6053e-01, PNorm = 43.7377, GNorm = 6.3823, lr_0 = 8.8958e-04
Validation rmse = 0.121482
Validation r2 = 0.799042
Validation mse = 0.014758
Epoch 5
Loss = 2.1066e-01, PNorm = 43.7859, GNorm = 0.7320, lr_0 = 8.6936e-04
Loss = 2.2087e-01, PNorm = 43.8286, GNorm = 3.4157, lr_0 = 8.5139e-04
Validation rmse = 0.105455
Validation r2 = 0.848569
Validation mse = 0.011121
Epoch 6
Loss = 2.0172e-01, PNorm = 43.8802, GNorm = 1.3063, lr_0 = 8.3204e-04
Loss = 1.7781e-01, PNorm = 43.9146, GNorm = 0.7005, lr_0 = 8.1484e-04
Validation rmse = 0.098810
Validation r2 = 0.867051
Validation mse = 0.009763
Epoch 7
Loss = 2.3563e-01, PNorm = 43.9534, GNorm = 3.8479, lr_0 = 7.9632e-04
Loss = 2.4745e-01, PNorm = 43.9898, GNorm = 6.1585, lr_0 = 7.7986e-04
Validation rmse = 0.104746
Validation r2 = 0.850599
Validation mse = 0.010972
Epoch 8
Loss = 1.7807e-01, PNorm = 44.0255, GNorm = 0.8060, lr_0 = 7.6373e-04
Loss = 1.7259e-01, PNorm = 44.0631, GNorm = 4.9114, lr_0 = 7.4794e-04
Validation rmse = 0.154250
Validation r2 = 0.676009
Validation mse = 0.023793
Epoch 9
Loss = 1.7612e-01, PNorm = 44.1048, GNorm = 1.8448, lr_0 = 7.3094e-04
Loss = 1.5818e-01, PNorm = 44.1283, GNorm = 1.2231, lr_0 = 7.1583e-04
Validation rmse = 0.090266
Validation r2 = 0.889049
Validation mse = 0.008148
Epoch 10
Loss = 1.5466e-01, PNorm = 44.1553, GNorm = 0.6664, lr_0 = 6.9956e-04
Loss = 1.2489e-01, PNorm = 44.1719, GNorm = 0.7293, lr_0 = 6.8510e-04
Validation rmse = 0.059482
Validation r2 = 0.951821
Validation mse = 0.003538
Epoch 11
Loss = 1.1900e-01, PNorm = 44.2002, GNorm = 1.0629, lr_0 = 6.6953e-04
Loss = 1.2739e-01, PNorm = 44.2179, GNorm = 0.6154, lr_0 = 6.5569e-04
Validation rmse = 0.082762
Validation r2 = 0.906730
Validation mse = 0.006850
Epoch 12
Loss = 1.2634e-01, PNorm = 44.2355, GNorm = 2.6000, lr_0 = 6.4213e-04
Loss = 1.1613e-01, PNorm = 44.2507, GNorm = 1.1317, lr_0 = 6.2885e-04
Loss = 1.1227e-01, PNorm = 44.2522, GNorm = 0.8836, lr_0 = 6.2754e-04
Validation rmse = 0.069546
Validation r2 = 0.934139
Validation mse = 0.004837
Epoch 13
Loss = 1.1517e-01, PNorm = 44.2729, GNorm = 1.1611, lr_0 = 6.1456e-04
Validation rmse = 0.067037
Validation r2 = 0.938805
Validation mse = 0.004494
Epoch 14
Loss = 1.2448e-01, PNorm = 44.2876, GNorm = 0.9308, lr_0 = 6.0060e-04
Loss = 1.0027e-01, PNorm = 44.2980, GNorm = 0.9441, lr_0 = 5.8818e-04
Validation rmse = 0.066201
Validation r2 = 0.940322
Validation mse = 0.004383
Epoch 15
Loss = 1.3133e-01, PNorm = 44.3193, GNorm = 1.4212, lr_0 = 5.7482e-04
Loss = 1.1696e-01, PNorm = 44.3368, GNorm = 1.4590, lr_0 = 5.6293e-04
Validation rmse = 0.084156
Validation r2 = 0.903561
Validation mse = 0.007082
Epoch 16
Loss = 8.4726e-02, PNorm = 44.3560, GNorm = 2.2409, lr_0 = 5.5129e-04
Loss = 1.1850e-01, PNorm = 44.3740, GNorm = 1.8104, lr_0 = 5.3989e-04
Validation rmse = 0.100703
Validation r2 = 0.861908
Validation mse = 0.010141
Epoch 17
Loss = 1.2958e-01, PNorm = 44.3896, GNorm = 0.5666, lr_0 = 5.2762e-04
Loss = 1.1121e-01, PNorm = 44.4069, GNorm = 1.3818, lr_0 = 5.1671e-04
Validation rmse = 0.059802
Validation r2 = 0.951302
Validation mse = 0.003576
Epoch 18
Loss = 9.9875e-02, PNorm = 44.4261, GNorm = 0.5989, lr_0 = 5.0497e-04
Loss = 1.0369e-01, PNorm = 44.4462, GNorm = 1.0363, lr_0 = 4.9453e-04
Validation rmse = 0.069237
Validation r2 = 0.934723
Validation mse = 0.004794
Epoch 19
Loss = 9.8480e-02, PNorm = 44.4605, GNorm = 0.6188, lr_0 = 4.8329e-04
Loss = 9.5183e-02, PNorm = 44.4723, GNorm = 1.1993, lr_0 = 4.7330e-04
Validation rmse = 0.069401
Validation r2 = 0.934414
Validation mse = 0.004816
Epoch 20
Loss = 8.6942e-02, PNorm = 44.4880, GNorm = 1.6445, lr_0 = 4.6351e-04
Loss = 8.6796e-02, PNorm = 44.5019, GNorm = 1.2696, lr_0 = 4.5393e-04
Validation rmse = 0.083286
Validation r2 = 0.905545
Validation mse = 0.006937
Epoch 21
Loss = 1.1569e-01, PNorm = 44.5186, GNorm = 2.2669, lr_0 = 4.4361e-04
Loss = 1.1372e-01, PNorm = 44.5326, GNorm = 4.8685, lr_0 = 4.3444e-04
Validation rmse = 0.077389
Validation r2 = 0.918447
Validation mse = 0.005989
Epoch 22
Loss = 1.0000e-01, PNorm = 44.5509, GNorm = 0.5144, lr_0 = 4.2457e-04
Loss = 9.4638e-02, PNorm = 44.5664, GNorm = 2.4013, lr_0 = 4.1579e-04
Validation rmse = 0.064076
Validation r2 = 0.944092
Validation mse = 0.004106
Epoch 23
Loss = 8.8626e-02, PNorm = 44.5829, GNorm = 0.6082, lr_0 = 4.0634e-04
Loss = 8.8847e-02, PNorm = 44.5940, GNorm = 0.7833, lr_0 = 3.9794e-04
Validation rmse = 0.069700
Validation r2 = 0.933847
Validation mse = 0.004858
Epoch 24
Loss = 1.0265e-01, PNorm = 44.6043, GNorm = 1.8984, lr_0 = 3.8971e-04
Loss = 9.5476e-02, PNorm = 44.6195, GNorm = 2.0023, lr_0 = 3.8165e-04
Validation rmse = 0.078882
Validation r2 = 0.915269
Validation mse = 0.006222
Epoch 25
Loss = 8.3445e-02, PNorm = 44.6330, GNorm = 0.6935, lr_0 = 3.7298e-04
Loss = 8.6128e-02, PNorm = 44.6476, GNorm = 0.9705, lr_0 = 3.6527e-04
Loss = 2.4380e-02, PNorm = 44.6483, GNorm = 0.7657, lr_0 = 3.6451e-04
Validation rmse = 0.062067
Validation r2 = 0.947542
Validation mse = 0.003852
Epoch 26
Loss = 7.7237e-02, PNorm = 44.6571, GNorm = 0.9720, lr_0 = 3.5697e-04
Loss = 8.3177e-02, PNorm = 44.6690, GNorm = 1.7999, lr_0 = 3.4959e-04
Validation rmse = 0.061703
Validation r2 = 0.948157
Validation mse = 0.003807
Epoch 27
Loss = 7.7779e-02, PNorm = 44.6820, GNorm = 1.5929, lr_0 = 3.4236e-04
Validation rmse = 0.069108
Validation r2 = 0.934965
Validation mse = 0.004776
Epoch 28
Loss = 4.3572e-02, PNorm = 44.6928, GNorm = 0.3474, lr_0 = 3.3458e-04
Loss = 8.1872e-02, PNorm = 44.7020, GNorm = 0.7876, lr_0 = 3.2766e-04
Validation rmse = 0.067887
Validation r2 = 0.937245
Validation mse = 0.004609
Epoch 29
Loss = 6.9319e-02, PNorm = 44.7142, GNorm = 1.8149, lr_0 = 3.2022e-04
Loss = 9.7310e-02, PNorm = 44.7277, GNorm = 2.5785, lr_0 = 3.1360e-04
Validation rmse = 0.078255
Validation r2 = 0.916612
Validation mse = 0.006124
Epoch 30
Loss = 9.3591e-02, PNorm = 44.7398, GNorm = 2.7716, lr_0 = 3.0647e-04
Loss = 8.1700e-02, PNorm = 44.7505, GNorm = 0.8105, lr_0 = 3.0013e-04
Validation rmse = 0.075422
Validation r2 = 0.922539
Validation mse = 0.005689
Epoch 31
Loss = 1.0069e-01, PNorm = 44.7605, GNorm = 3.9547, lr_0 = 2.9393e-04
Loss = 8.6868e-02, PNorm = 44.7700, GNorm = 3.4257, lr_0 = 2.8785e-04
Validation rmse = 0.067262
Validation r2 = 0.938394
Validation mse = 0.004524
Epoch 32
Loss = 7.0175e-02, PNorm = 44.7808, GNorm = 0.9394, lr_0 = 2.8131e-04
Loss = 7.1270e-02, PNorm = 44.7900, GNorm = 0.5530, lr_0 = 2.7549e-04
Validation rmse = 0.062701
Validation r2 = 0.946467
Validation mse = 0.003931
Epoch 33
Loss = 7.8458e-02, PNorm = 44.8000, GNorm = 0.5809, lr_0 = 2.6923e-04
Loss = 8.0234e-02, PNorm = 44.8087, GNorm = 0.7669, lr_0 = 2.6367e-04
Validation rmse = 0.066315
Validation r2 = 0.940117
Validation mse = 0.004398
Epoch 34
Loss = 6.6429e-02, PNorm = 44.8181, GNorm = 1.3155, lr_0 = 2.5767e-04
Loss = 8.6625e-02, PNorm = 44.8277, GNorm = 0.7695, lr_0 = 2.5235e-04
Validation rmse = 0.069369
Validation r2 = 0.934475
Validation mse = 0.004812
Epoch 35
Loss = 7.1347e-02, PNorm = 44.8348, GNorm = 1.5753, lr_0 = 2.4713e-04
Loss = 7.3174e-02, PNorm = 44.8421, GNorm = 0.5781, lr_0 = 2.4202e-04
Validation rmse = 0.064839
Validation r2 = 0.942753
Validation mse = 0.004204
Epoch 36
Loss = 7.3442e-02, PNorm = 44.8512, GNorm = 0.9858, lr_0 = 2.3652e-04
Loss = 6.7860e-02, PNorm = 44.8594, GNorm = 0.7711, lr_0 = 2.3163e-04
Validation rmse = 0.072414
Validation r2 = 0.928594
Validation mse = 0.005244
Epoch 37
Loss = 6.1232e-02, PNorm = 44.8685, GNorm = 1.1152, lr_0 = 2.2637e-04
Loss = 7.6470e-02, PNorm = 44.8770, GNorm = 0.7316, lr_0 = 2.2168e-04
Validation rmse = 0.067435
Validation r2 = 0.938077
Validation mse = 0.004547
Epoch 38
Loss = 6.6672e-02, PNorm = 44.8859, GNorm = 1.9075, lr_0 = 2.1665e-04
Loss = 6.7912e-02, PNorm = 44.8934, GNorm = 0.7025, lr_0 = 2.1217e-04
Validation rmse = 0.065171
Validation r2 = 0.942164
Validation mse = 0.004247
Epoch 39
Loss = 6.7690e-02, PNorm = 44.9015, GNorm = 0.7780, lr_0 = 2.0778e-04
Loss = 6.7117e-02, PNorm = 44.9077, GNorm = 0.6348, lr_0 = 2.0348e-04
Loss = 1.0799e-02, PNorm = 44.9082, GNorm = 0.4734, lr_0 = 2.0306e-04
Validation rmse = 0.072960
Validation r2 = 0.927515
Validation mse = 0.005323
Epoch 40
Loss = 6.4327e-02, PNorm = 44.9149, GNorm = 0.9686, lr_0 = 1.9886e-04
Validation rmse = 0.073620
Validation r2 = 0.926197
Validation mse = 0.005420
Epoch 41
Loss = 5.7976e-02, PNorm = 44.9223, GNorm = 0.7422, lr_0 = 1.9434e-04
Loss = 7.0833e-02, PNorm = 44.9291, GNorm = 0.8464, lr_0 = 1.9032e-04
Validation rmse = 0.069656
Validation r2 = 0.933931
Validation mse = 0.004852
Epoch 42
Loss = 7.8409e-02, PNorm = 44.9355, GNorm = 1.3286, lr_0 = 1.8600e-04
Loss = 6.6921e-02, PNorm = 44.9419, GNorm = 0.6355, lr_0 = 1.8215e-04
Validation rmse = 0.068174
Validation r2 = 0.936713
Validation mse = 0.004648
Epoch 43
Loss = 5.5177e-02, PNorm = 44.9488, GNorm = 0.9118, lr_0 = 1.7839e-04
Loss = 6.1096e-02, PNorm = 44.9546, GNorm = 1.3473, lr_0 = 1.7470e-04
Validation rmse = 0.065071
Validation r2 = 0.942343
Validation mse = 0.004234
Epoch 44
Loss = 6.9498e-02, PNorm = 44.9613, GNorm = 0.7813, lr_0 = 1.7073e-04
Loss = 6.3985e-02, PNorm = 44.9673, GNorm = 0.6480, lr_0 = 1.6720e-04
Validation rmse = 0.068459
Validation r2 = 0.936182
Validation mse = 0.004687
Epoch 45
Loss = 6.7591e-02, PNorm = 44.9744, GNorm = 1.7699, lr_0 = 1.6340e-04
Loss = 6.6830e-02, PNorm = 44.9806, GNorm = 0.9279, lr_0 = 1.6002e-04
Validation rmse = 0.074228
Validation r2 = 0.924972
Validation mse = 0.005510
Epoch 46
Loss = 4.9648e-02, PNorm = 44.9862, GNorm = 0.4833, lr_0 = 1.5638e-04
Loss = 6.4065e-02, PNorm = 44.9912, GNorm = 0.4201, lr_0 = 1.5315e-04
Validation rmse = 0.064732
Validation r2 = 0.942941
Validation mse = 0.004190
Epoch 47
Loss = 5.5110e-02, PNorm = 44.9973, GNorm = 1.6167, lr_0 = 1.4998e-04
Loss = 6.3454e-02, PNorm = 45.0023, GNorm = 0.5701, lr_0 = 1.4688e-04
Validation rmse = 0.070105
Validation r2 = 0.933077
Validation mse = 0.004915
Epoch 48
Loss = 5.9375e-02, PNorm = 45.0093, GNorm = 0.8808, lr_0 = 1.4354e-04
Loss = 5.9115e-02, PNorm = 45.0153, GNorm = 0.6922, lr_0 = 1.4058e-04
Validation rmse = 0.069007
Validation r2 = 0.935155
Validation mse = 0.004762
Epoch 49
Loss = 5.5763e-02, PNorm = 45.0203, GNorm = 0.9480, lr_0 = 1.3738e-04
Loss = 6.3181e-02, PNorm = 45.0249, GNorm = 1.1273, lr_0 = 1.3454e-04
Validation rmse = 0.065450
Validation r2 = 0.941669
Validation mse = 0.004284
Epoch 50
Loss = 5.9251e-02, PNorm = 45.0310, GNorm = 0.8194, lr_0 = 1.3176e-04
Loss = 5.6686e-02, PNorm = 45.0355, GNorm = 0.6449, lr_0 = 1.2904e-04
Validation rmse = 0.070425
Validation r2 = 0.932464
Validation mse = 0.004960
Epoch 51
Loss = 5.5274e-02, PNorm = 45.0406, GNorm = 0.5705, lr_0 = 1.2610e-04
Loss = 5.2888e-02, PNorm = 45.0457, GNorm = 1.5319, lr_0 = 1.2350e-04
Validation rmse = 0.063073
Validation r2 = 0.945829
Validation mse = 0.003978
Epoch 52
Loss = 5.6322e-02, PNorm = 45.0515, GNorm = 0.6150, lr_0 = 1.2069e-04
Loss = 5.3178e-02, PNorm = 45.0569, GNorm = 0.6854, lr_0 = 1.1819e-04
Loss = 3.7361e-02, PNorm = 45.0573, GNorm = 1.3889, lr_0 = 1.1795e-04
Validation rmse = 0.069897
Validation r2 = 0.933473
Validation mse = 0.004886
Epoch 53
Loss = 5.2398e-02, PNorm = 45.0617, GNorm = 0.6875, lr_0 = 1.1551e-04
Loss = 5.5166e-02, PNorm = 45.0654, GNorm = 0.8171, lr_0 = 1.1312e-04
Validation rmse = 0.066907
Validation r2 = 0.939044
Validation mse = 0.004476
Epoch 54
Loss = 5.6376e-02, PNorm = 45.0700, GNorm = 0.8071, lr_0 = 1.1078e-04
Validation rmse = 0.062347
Validation r2 = 0.947068
Validation mse = 0.003887
Epoch 55
Loss = 3.8286e-02, PNorm = 45.0748, GNorm = 0.8717, lr_0 = 1.0826e-04
Loss = 5.0935e-02, PNorm = 45.0785, GNorm = 0.7309, lr_0 = 1.0603e-04
Validation rmse = 0.068523
Validation r2 = 0.936063
Validation mse = 0.004695
Epoch 56
Loss = 4.8258e-02, PNorm = 45.0834, GNorm = 0.7335, lr_0 = 1.0362e-04
Loss = 5.0091e-02, PNorm = 45.0879, GNorm = 0.5012, lr_0 = 1.0147e-04
Validation rmse = 0.064905
Validation r2 = 0.942637
Validation mse = 0.004213
Epoch 57
Loss = 4.9543e-02, PNorm = 45.0925, GNorm = 0.3609, lr_0 = 1.0000e-04
Loss = 5.0259e-02, PNorm = 45.0967, GNorm = 1.3875, lr_0 = 1.0000e-04
Validation rmse = 0.079024
Validation r2 = 0.914964
Validation mse = 0.006245
Epoch 58
Loss = 4.6238e-02, PNorm = 45.1001, GNorm = 1.0972, lr_0 = 1.0000e-04
Loss = 4.6334e-02, PNorm = 45.1037, GNorm = 0.6619, lr_0 = 1.0000e-04
Validation rmse = 0.062502
Validation r2 = 0.946806
Validation mse = 0.003906
Epoch 59
Loss = 5.4370e-02, PNorm = 45.1079, GNorm = 0.8469, lr_0 = 1.0000e-04
Loss = 4.7650e-02, PNorm = 45.1121, GNorm = 0.8144, lr_0 = 1.0000e-04
Validation rmse = 0.078171
Validation r2 = 0.916791
Validation mse = 0.006111
Model 0 best validation rmse = 0.059482 on epoch 10
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.231665
Model 0 test r2 = 0.216122
Model 0 test mse = 0.053669
Ensemble test rmse = 0.231665
Ensemble test r2 = 0.216122
Ensemble test mse = 0.053669
Fold 7
Splitting data with seed 7
Total size = 973 | train size = 963 | val size = 10 | test size = 59
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.4242e-01, PNorm = 43.2630, GNorm = 1.6252, lr_0 = 3.6053e-04
Validation rmse = 0.212153
Validation r2 = 0.515511
Validation mse = 0.045009
Epoch 1
Loss = 1.1209e+00, PNorm = 43.2863, GNorm = 9.8022, lr_0 = 6.2105e-04
Loss = 7.7178e-01, PNorm = 43.3176, GNorm = 2.7863, lr_0 = 8.5789e-04
Validation rmse = 0.177882
Validation r2 = 0.659396
Validation mse = 0.031642
Epoch 2
Loss = 6.0734e-01, PNorm = 43.3912, GNorm = 5.5226, lr_0 = 9.8961e-04
Loss = 5.1851e-01, PNorm = 43.4644, GNorm = 6.2558, lr_0 = 9.6914e-04
Validation rmse = 0.180464
Validation r2 = 0.649435
Validation mse = 0.032567
Epoch 3
Loss = 3.9357e-01, PNorm = 43.5547, GNorm = 3.6089, lr_0 = 9.4712e-04
Loss = 3.9434e-01, PNorm = 43.6193, GNorm = 1.2858, lr_0 = 9.2754e-04
Validation rmse = 0.148036
Validation r2 = 0.764102
Validation mse = 0.021915
Epoch 4
Loss = 2.2276e-01, PNorm = 43.6853, GNorm = 3.7041, lr_0 = 9.0836e-04
Loss = 2.9474e-01, PNorm = 43.7326, GNorm = 8.8728, lr_0 = 8.8958e-04
Validation rmse = 0.143716
Validation r2 = 0.777670
Validation mse = 0.020654
Epoch 5
Loss = 2.2309e-01, PNorm = 43.7960, GNorm = 5.5346, lr_0 = 8.6936e-04
Loss = 3.1916e-01, PNorm = 43.8484, GNorm = 4.4835, lr_0 = 8.5139e-04
Validation rmse = 0.125344
Validation r2 = 0.830880
Validation mse = 0.015711
Epoch 6
Loss = 2.1210e-01, PNorm = 43.8969, GNorm = 1.8194, lr_0 = 8.3204e-04
Loss = 2.0149e-01, PNorm = 43.9356, GNorm = 1.6957, lr_0 = 8.1484e-04
Validation rmse = 0.131959
Validation r2 = 0.812558
Validation mse = 0.017413
Epoch 7
Loss = 1.9590e-01, PNorm = 43.9797, GNorm = 1.4419, lr_0 = 7.9632e-04
Loss = 1.7955e-01, PNorm = 44.0154, GNorm = 2.8486, lr_0 = 7.7986e-04
Validation rmse = 0.130383
Validation r2 = 0.817009
Validation mse = 0.017000
Epoch 8
Loss = 1.5800e-01, PNorm = 44.0485, GNorm = 2.1134, lr_0 = 7.6373e-04
Loss = 1.7757e-01, PNorm = 44.0747, GNorm = 1.3464, lr_0 = 7.4794e-04
Validation rmse = 0.119817
Validation r2 = 0.845465
Validation mse = 0.014356
Epoch 9
Loss = 1.6438e-01, PNorm = 44.1067, GNorm = 0.8599, lr_0 = 7.3094e-04
Loss = 1.3180e-01, PNorm = 44.1331, GNorm = 1.6723, lr_0 = 7.1583e-04
Validation rmse = 0.122377
Validation r2 = 0.838792
Validation mse = 0.014976
Epoch 10
Loss = 1.1920e-01, PNorm = 44.1573, GNorm = 2.5992, lr_0 = 6.9956e-04
Loss = 1.1936e-01, PNorm = 44.1735, GNorm = 0.9020, lr_0 = 6.8510e-04
Validation rmse = 0.125554
Validation r2 = 0.830312
Validation mse = 0.015764
Epoch 11
Loss = 1.2147e-01, PNorm = 44.1935, GNorm = 2.7548, lr_0 = 6.6953e-04
Loss = 1.1266e-01, PNorm = 44.2171, GNorm = 2.4196, lr_0 = 6.5569e-04
Validation rmse = 0.128799
Validation r2 = 0.821427
Validation mse = 0.016589
Epoch 12
Loss = 1.1247e-01, PNorm = 44.2320, GNorm = 0.7185, lr_0 = 6.4213e-04
Loss = 1.2193e-01, PNorm = 44.2466, GNorm = 0.9491, lr_0 = 6.2885e-04
Loss = 1.6174e-01, PNorm = 44.2491, GNorm = 2.5186, lr_0 = 6.2754e-04
Validation rmse = 0.127617
Validation r2 = 0.824692
Validation mse = 0.016286
Epoch 13
Loss = 1.1496e-01, PNorm = 44.2718, GNorm = 3.1748, lr_0 = 6.1456e-04
Validation rmse = 0.122812
Validation r2 = 0.837643
Validation mse = 0.015083
Epoch 14
Loss = 1.0673e-01, PNorm = 44.2932, GNorm = 1.7260, lr_0 = 6.0060e-04
Loss = 1.0948e-01, PNorm = 44.3138, GNorm = 2.6285, lr_0 = 5.8818e-04
Validation rmse = 0.134191
Validation r2 = 0.806165
Validation mse = 0.018007
Epoch 15
Loss = 1.1182e-01, PNorm = 44.3409, GNorm = 1.0424, lr_0 = 5.7482e-04
Loss = 1.4420e-01, PNorm = 44.3614, GNorm = 3.3941, lr_0 = 5.6293e-04
Validation rmse = 0.129404
Validation r2 = 0.819746
Validation mse = 0.016745
Epoch 16
Loss = 7.1932e-02, PNorm = 44.3838, GNorm = 1.3299, lr_0 = 5.5129e-04
Loss = 1.1013e-01, PNorm = 44.4043, GNorm = 2.0493, lr_0 = 5.3989e-04
Validation rmse = 0.128599
Validation r2 = 0.821982
Validation mse = 0.016538
Epoch 17
Loss = 8.0552e-02, PNorm = 44.4245, GNorm = 1.0045, lr_0 = 5.2762e-04
Loss = 1.0301e-01, PNorm = 44.4414, GNorm = 1.3471, lr_0 = 5.1671e-04
Validation rmse = 0.119614
Validation r2 = 0.845989
Validation mse = 0.014308
Epoch 18
Loss = 9.5635e-02, PNorm = 44.4589, GNorm = 0.4293, lr_0 = 5.0497e-04
Loss = 9.8684e-02, PNorm = 44.4724, GNorm = 1.5760, lr_0 = 4.9453e-04
Validation rmse = 0.122073
Validation r2 = 0.839592
Validation mse = 0.014902
Epoch 19
Loss = 9.4806e-02, PNorm = 44.4898, GNorm = 0.9080, lr_0 = 4.8329e-04
Loss = 9.1076e-02, PNorm = 44.5060, GNorm = 0.8039, lr_0 = 4.7330e-04
Validation rmse = 0.130894
Validation r2 = 0.815572
Validation mse = 0.017133
Epoch 20
Loss = 8.9552e-02, PNorm = 44.5206, GNorm = 2.0689, lr_0 = 4.6351e-04
Loss = 8.8052e-02, PNorm = 44.5358, GNorm = 3.0971, lr_0 = 4.5393e-04
Validation rmse = 0.121107
Validation r2 = 0.842120
Validation mse = 0.014667
Epoch 21
Loss = 8.4584e-02, PNorm = 44.5537, GNorm = 0.9179, lr_0 = 4.4361e-04
Loss = 9.1227e-02, PNorm = 44.5688, GNorm = 1.8890, lr_0 = 4.3444e-04
Validation rmse = 0.133799
Validation r2 = 0.807295
Validation mse = 0.017902
Epoch 22
Loss = 7.6175e-02, PNorm = 44.5827, GNorm = 1.1757, lr_0 = 4.2457e-04
Loss = 9.9126e-02, PNorm = 44.5955, GNorm = 0.7469, lr_0 = 4.1579e-04
Validation rmse = 0.126639
Validation r2 = 0.827368
Validation mse = 0.016037
Epoch 23
Loss = 8.8371e-02, PNorm = 44.6079, GNorm = 0.6215, lr_0 = 4.0634e-04
Loss = 8.1048e-02, PNorm = 44.6211, GNorm = 1.8546, lr_0 = 3.9794e-04
Validation rmse = 0.113380
Validation r2 = 0.861624
Validation mse = 0.012855
Epoch 24
Loss = 9.1879e-02, PNorm = 44.6354, GNorm = 0.7560, lr_0 = 3.8971e-04
Loss = 6.8876e-02, PNorm = 44.6463, GNorm = 1.1644, lr_0 = 3.8165e-04
Validation rmse = 0.125409
Validation r2 = 0.830704
Validation mse = 0.015727
Epoch 25
Loss = 7.9128e-02, PNorm = 44.6595, GNorm = 1.4382, lr_0 = 3.7298e-04
Loss = 7.9484e-02, PNorm = 44.6713, GNorm = 1.4259, lr_0 = 3.6527e-04
Loss = 5.9378e-02, PNorm = 44.6729, GNorm = 1.3042, lr_0 = 3.6451e-04
Validation rmse = 0.123819
Validation r2 = 0.834970
Validation mse = 0.015331
Epoch 26
Loss = 8.7373e-02, PNorm = 44.6858, GNorm = 1.8204, lr_0 = 3.5697e-04
Loss = 1.0198e-01, PNorm = 44.6975, GNorm = 5.3585, lr_0 = 3.4959e-04
Validation rmse = 0.125130
Validation r2 = 0.831457
Validation mse = 0.015658
Epoch 27
Loss = 7.5940e-02, PNorm = 44.7135, GNorm = 1.1770, lr_0 = 3.4236e-04
Validation rmse = 0.136751
Validation r2 = 0.798699
Validation mse = 0.018701
Epoch 28
Loss = 1.2228e-01, PNorm = 44.7293, GNorm = 2.8524, lr_0 = 3.3458e-04
Loss = 7.3952e-02, PNorm = 44.7437, GNorm = 1.9328, lr_0 = 3.2766e-04
Validation rmse = 0.128420
Validation r2 = 0.822477
Validation mse = 0.016492
Epoch 29
Loss = 6.3134e-02, PNorm = 44.7571, GNorm = 0.8569, lr_0 = 3.2022e-04
Loss = 7.1401e-02, PNorm = 44.7679, GNorm = 1.9745, lr_0 = 3.1360e-04
Validation rmse = 0.133418
Validation r2 = 0.808390
Validation mse = 0.017800
Epoch 30
Loss = 6.8566e-02, PNorm = 44.7789, GNorm = 0.6587, lr_0 = 3.0647e-04
Loss = 6.1455e-02, PNorm = 44.7885, GNorm = 1.0040, lr_0 = 3.0013e-04
Validation rmse = 0.130631
Validation r2 = 0.816312
Validation mse = 0.017065
Epoch 31
Loss = 7.4962e-02, PNorm = 44.7987, GNorm = 1.3878, lr_0 = 2.9393e-04
Loss = 6.0430e-02, PNorm = 44.8093, GNorm = 0.3934, lr_0 = 2.8785e-04
Validation rmse = 0.131955
Validation r2 = 0.812569
Validation mse = 0.017412
Epoch 32
Loss = 7.7279e-02, PNorm = 44.8225, GNorm = 1.9100, lr_0 = 2.8131e-04
Loss = 6.4957e-02, PNorm = 44.8339, GNorm = 2.0289, lr_0 = 2.7549e-04
Validation rmse = 0.134082
Validation r2 = 0.806479
Validation mse = 0.017978
Epoch 33
Loss = 7.6615e-02, PNorm = 44.8444, GNorm = 2.0306, lr_0 = 2.6923e-04
Loss = 8.2744e-02, PNorm = 44.8549, GNorm = 1.0620, lr_0 = 2.6367e-04
Validation rmse = 0.127886
Validation r2 = 0.823952
Validation mse = 0.016355
Epoch 34
Loss = 7.2589e-02, PNorm = 44.8660, GNorm = 0.5750, lr_0 = 2.5767e-04
Loss = 5.4677e-02, PNorm = 44.8756, GNorm = 0.7719, lr_0 = 2.5235e-04
Validation rmse = 0.133608
Validation r2 = 0.807846
Validation mse = 0.017851
Epoch 35
Loss = 6.1670e-02, PNorm = 44.8844, GNorm = 2.5184, lr_0 = 2.4713e-04
Loss = 5.9190e-02, PNorm = 44.8929, GNorm = 1.0716, lr_0 = 2.4202e-04
Validation rmse = 0.135110
Validation r2 = 0.803499
Validation mse = 0.018255
Epoch 36
Loss = 6.2894e-02, PNorm = 44.9019, GNorm = 0.9133, lr_0 = 2.3652e-04
Loss = 6.0481e-02, PNorm = 44.9120, GNorm = 1.7015, lr_0 = 2.3163e-04
Validation rmse = 0.139953
Validation r2 = 0.789162
Validation mse = 0.019587
Epoch 37
Loss = 5.6123e-02, PNorm = 44.9202, GNorm = 1.0193, lr_0 = 2.2637e-04
Loss = 6.0692e-02, PNorm = 44.9290, GNorm = 0.9823, lr_0 = 2.2168e-04
Validation rmse = 0.137877
Validation r2 = 0.795368
Validation mse = 0.019010
Epoch 38
Loss = 7.5975e-02, PNorm = 44.9411, GNorm = 2.5284, lr_0 = 2.1665e-04
Loss = 5.3939e-02, PNorm = 44.9500, GNorm = 0.7481, lr_0 = 2.1217e-04
Validation rmse = 0.128003
Validation r2 = 0.823628
Validation mse = 0.016385
Epoch 39
Loss = 5.6426e-02, PNorm = 44.9568, GNorm = 0.6289, lr_0 = 2.0778e-04
Loss = 5.6037e-02, PNorm = 44.9638, GNorm = 1.1407, lr_0 = 2.0348e-04
Loss = 3.2675e-02, PNorm = 44.9647, GNorm = 1.0151, lr_0 = 2.0306e-04
Validation rmse = 0.137396
Validation r2 = 0.796795
Validation mse = 0.018878
Epoch 40
Loss = 6.7204e-02, PNorm = 44.9729, GNorm = 1.6306, lr_0 = 1.9886e-04
Validation rmse = 0.131443
Validation r2 = 0.814022
Validation mse = 0.017277
Epoch 41
Loss = 4.2730e-02, PNorm = 44.9805, GNorm = 1.2239, lr_0 = 1.9434e-04
Loss = 5.7227e-02, PNorm = 44.9875, GNorm = 0.7094, lr_0 = 1.9032e-04
Validation rmse = 0.134798
Validation r2 = 0.804407
Validation mse = 0.018170
Epoch 42
Loss = 4.2515e-02, PNorm = 44.9947, GNorm = 1.1571, lr_0 = 1.8600e-04
Loss = 5.7414e-02, PNorm = 45.0025, GNorm = 1.0349, lr_0 = 1.8215e-04
Validation rmse = 0.136297
Validation r2 = 0.800033
Validation mse = 0.018577
Epoch 43
Loss = 4.3227e-02, PNorm = 45.0093, GNorm = 1.0053, lr_0 = 1.7839e-04
Loss = 6.0399e-02, PNorm = 45.0162, GNorm = 1.7947, lr_0 = 1.7470e-04
Validation rmse = 0.136684
Validation r2 = 0.798895
Validation mse = 0.018683
Epoch 44
Loss = 5.9857e-02, PNorm = 45.0236, GNorm = 1.6791, lr_0 = 1.7073e-04
Loss = 4.5024e-02, PNorm = 45.0298, GNorm = 1.3996, lr_0 = 1.6720e-04
Validation rmse = 0.136846
Validation r2 = 0.798419
Validation mse = 0.018727
Epoch 45
Loss = 5.1462e-02, PNorm = 45.0360, GNorm = 0.6016, lr_0 = 1.6340e-04
Loss = 4.6460e-02, PNorm = 45.0416, GNorm = 0.5310, lr_0 = 1.6002e-04
Validation rmse = 0.138294
Validation r2 = 0.794130
Validation mse = 0.019125
Epoch 46
Loss = 4.8698e-02, PNorm = 45.0479, GNorm = 1.3751, lr_0 = 1.5638e-04
Loss = 4.9048e-02, PNorm = 45.0544, GNorm = 0.8738, lr_0 = 1.5315e-04
Validation rmse = 0.137338
Validation r2 = 0.796966
Validation mse = 0.018862
Epoch 47
Loss = 4.6124e-02, PNorm = 45.0597, GNorm = 0.4198, lr_0 = 1.4998e-04
Loss = 4.6492e-02, PNorm = 45.0656, GNorm = 0.8673, lr_0 = 1.4688e-04
Validation rmse = 0.141607
Validation r2 = 0.784146
Validation mse = 0.020053
Epoch 48
Loss = 5.2798e-02, PNorm = 45.0716, GNorm = 1.3701, lr_0 = 1.4354e-04
Loss = 4.2631e-02, PNorm = 45.0774, GNorm = 0.6265, lr_0 = 1.4058e-04
Validation rmse = 0.139414
Validation r2 = 0.790781
Validation mse = 0.019436
Epoch 49
Loss = 4.5757e-02, PNorm = 45.0832, GNorm = 0.7923, lr_0 = 1.3738e-04
Loss = 4.5255e-02, PNorm = 45.0882, GNorm = 0.9814, lr_0 = 1.3454e-04
Validation rmse = 0.137673
Validation r2 = 0.795975
Validation mse = 0.018954
Epoch 50
Loss = 4.2672e-02, PNorm = 45.0939, GNorm = 0.7277, lr_0 = 1.3176e-04
Loss = 4.7388e-02, PNorm = 45.0997, GNorm = 0.8010, lr_0 = 1.2904e-04
Validation rmse = 0.139747
Validation r2 = 0.789782
Validation mse = 0.019529
Epoch 51
Loss = 4.3178e-02, PNorm = 45.1045, GNorm = 0.9758, lr_0 = 1.2610e-04
Loss = 4.2682e-02, PNorm = 45.1091, GNorm = 0.4553, lr_0 = 1.2350e-04
Validation rmse = 0.141924
Validation r2 = 0.783180
Validation mse = 0.020142
Epoch 52
Loss = 3.7526e-02, PNorm = 45.1140, GNorm = 0.5610, lr_0 = 1.2069e-04
Loss = 4.8822e-02, PNorm = 45.1186, GNorm = 1.2216, lr_0 = 1.1819e-04
Loss = 3.8809e-02, PNorm = 45.1192, GNorm = 1.1332, lr_0 = 1.1795e-04
Validation rmse = 0.139225
Validation r2 = 0.791349
Validation mse = 0.019384
Epoch 53
Loss = 4.0997e-02, PNorm = 45.1243, GNorm = 0.6066, lr_0 = 1.1551e-04
Loss = 4.3699e-02, PNorm = 45.1288, GNorm = 1.4018, lr_0 = 1.1312e-04
Validation rmse = 0.140513
Validation r2 = 0.787471
Validation mse = 0.019744
Epoch 54
Loss = 3.9174e-02, PNorm = 45.1331, GNorm = 1.0425, lr_0 = 1.1078e-04
Validation rmse = 0.142605
Validation r2 = 0.781093
Validation mse = 0.020336
Epoch 55
Loss = 3.1222e-02, PNorm = 45.1378, GNorm = 0.8813, lr_0 = 1.0826e-04
Loss = 4.7956e-02, PNorm = 45.1424, GNorm = 0.6066, lr_0 = 1.0603e-04
Validation rmse = 0.140377
Validation r2 = 0.787880
Validation mse = 0.019706
Epoch 56
Loss = 3.5853e-02, PNorm = 45.1465, GNorm = 1.1230, lr_0 = 1.0362e-04
Loss = 4.2402e-02, PNorm = 45.1498, GNorm = 0.6332, lr_0 = 1.0147e-04
Validation rmse = 0.142492
Validation r2 = 0.781440
Validation mse = 0.020304
Epoch 57
Loss = 3.5428e-02, PNorm = 45.1541, GNorm = 0.4598, lr_0 = 1.0000e-04
Loss = 3.4433e-02, PNorm = 45.1578, GNorm = 0.9268, lr_0 = 1.0000e-04
Validation rmse = 0.141579
Validation r2 = 0.784234
Validation mse = 0.020044
Epoch 58
Loss = 3.5048e-02, PNorm = 45.1614, GNorm = 0.7351, lr_0 = 1.0000e-04
Loss = 3.8861e-02, PNorm = 45.1653, GNorm = 0.6911, lr_0 = 1.0000e-04
Validation rmse = 0.143031
Validation r2 = 0.779785
Validation mse = 0.020458
Epoch 59
Loss = 3.2915e-02, PNorm = 45.1699, GNorm = 1.0127, lr_0 = 1.0000e-04
Loss = 3.8019e-02, PNorm = 45.1739, GNorm = 0.9512, lr_0 = 1.0000e-04
Validation rmse = 0.147179
Validation r2 = 0.766828
Validation mse = 0.021662
Model 0 best validation rmse = 0.113380 on epoch 23
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.172654
Model 0 test r2 = 0.564608
Model 0 test mse = 0.029809
Ensemble test rmse = 0.172654
Ensemble test r2 = 0.564608
Ensemble test mse = 0.029809
Fold 8
Splitting data with seed 8
Total size = 973 | train size = 963 | val size = 10 | test size = 59
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.9555e-01, PNorm = 43.2621, GNorm = 1.9195, lr_0 = 3.6053e-04
Validation rmse = 0.479488
Validation r2 = -0.552296
Validation mse = 0.229909
Epoch 1
Loss = 1.0424e+00, PNorm = 43.2889, GNorm = 15.5224, lr_0 = 6.2105e-04
Loss = 7.7758e-01, PNorm = 43.3233, GNorm = 3.0802, lr_0 = 8.5789e-04
Validation rmse = 0.291998
Validation r2 = 0.424322
Validation mse = 0.085263
Epoch 2
Loss = 3.7942e-01, PNorm = 43.4074, GNorm = 3.9235, lr_0 = 9.8961e-04
Loss = 4.9329e-01, PNorm = 43.4903, GNorm = 5.2691, lr_0 = 9.6914e-04
Validation rmse = 0.235270
Validation r2 = 0.626276
Validation mse = 0.055352
Epoch 3
Loss = 3.0547e-01, PNorm = 43.5701, GNorm = 4.6574, lr_0 = 9.4712e-04
Loss = 3.4861e-01, PNorm = 43.6336, GNorm = 2.3288, lr_0 = 9.2754e-04
Validation rmse = 0.240437
Validation r2 = 0.609679
Validation mse = 0.057810
Epoch 4
Loss = 2.5956e-01, PNorm = 43.6913, GNorm = 2.2196, lr_0 = 9.0836e-04
Loss = 2.4737e-01, PNorm = 43.7499, GNorm = 4.4122, lr_0 = 8.8958e-04
Validation rmse = 0.213226
Validation r2 = 0.693028
Validation mse = 0.045465
Epoch 5
Loss = 2.8523e-01, PNorm = 43.8002, GNorm = 5.9855, lr_0 = 8.6936e-04
Loss = 2.3888e-01, PNorm = 43.8444, GNorm = 3.7980, lr_0 = 8.5139e-04
Validation rmse = 0.137306
Validation r2 = 0.872709
Validation mse = 0.018853
Epoch 6
Loss = 1.7987e-01, PNorm = 43.8930, GNorm = 2.9481, lr_0 = 8.3204e-04
Loss = 1.8729e-01, PNorm = 43.9319, GNorm = 3.5093, lr_0 = 8.1484e-04
Validation rmse = 0.110795
Validation r2 = 0.917118
Validation mse = 0.012275
Epoch 7
Loss = 1.4879e-01, PNorm = 43.9576, GNorm = 1.5744, lr_0 = 7.9632e-04
Loss = 1.6462e-01, PNorm = 43.9907, GNorm = 2.6949, lr_0 = 7.7986e-04
Validation rmse = 0.132785
Validation r2 = 0.880954
Validation mse = 0.017632
Epoch 8
Loss = 1.9693e-01, PNorm = 44.0221, GNorm = 3.8334, lr_0 = 7.6373e-04
Loss = 1.7131e-01, PNorm = 44.0509, GNorm = 1.7041, lr_0 = 7.4794e-04
Validation rmse = 0.140702
Validation r2 = 0.866333
Validation mse = 0.019797
Epoch 9
Loss = 1.7498e-01, PNorm = 44.0848, GNorm = 1.0152, lr_0 = 7.3094e-04
Loss = 1.3954e-01, PNorm = 44.1095, GNorm = 3.4047, lr_0 = 7.1583e-04
Validation rmse = 0.123777
Validation r2 = 0.896558
Validation mse = 0.015321
Epoch 10
Loss = 1.2114e-01, PNorm = 44.1394, GNorm = 1.4664, lr_0 = 6.9956e-04
Loss = 1.4393e-01, PNorm = 44.1637, GNorm = 1.2487, lr_0 = 6.8510e-04
Validation rmse = 0.136129
Validation r2 = 0.874882
Validation mse = 0.018531
Epoch 11
Loss = 1.5005e-01, PNorm = 44.1820, GNorm = 1.5431, lr_0 = 6.6953e-04
Loss = 1.1130e-01, PNorm = 44.1990, GNorm = 1.6688, lr_0 = 6.5569e-04
Validation rmse = 0.089522
Validation r2 = 0.945890
Validation mse = 0.008014
Epoch 12
Loss = 1.1228e-01, PNorm = 44.2280, GNorm = 1.8504, lr_0 = 6.4213e-04
Loss = 1.1976e-01, PNorm = 44.2498, GNorm = 1.3295, lr_0 = 6.2885e-04
Loss = 1.6000e-02, PNorm = 44.2515, GNorm = 0.3753, lr_0 = 6.2754e-04
Validation rmse = 0.125649
Validation r2 = 0.893405
Validation mse = 0.015788
Epoch 13
Loss = 9.5894e-02, PNorm = 44.2683, GNorm = 0.7847, lr_0 = 6.1456e-04
Validation rmse = 0.108904
Validation r2 = 0.919923
Validation mse = 0.011860
Epoch 14
Loss = 8.2118e-02, PNorm = 44.2834, GNorm = 1.0819, lr_0 = 6.0060e-04
Loss = 1.0035e-01, PNorm = 44.2991, GNorm = 0.8134, lr_0 = 5.8818e-04
Validation rmse = 0.097701
Validation r2 = 0.935550
Validation mse = 0.009546
Epoch 15
Loss = 1.1319e-01, PNorm = 44.3157, GNorm = 0.9512, lr_0 = 5.7482e-04
Loss = 9.6685e-02, PNorm = 44.3332, GNorm = 2.0461, lr_0 = 5.6293e-04
Validation rmse = 0.104684
Validation r2 = 0.926008
Validation mse = 0.010959
Epoch 16
Loss = 8.1519e-02, PNorm = 44.3439, GNorm = 1.2720, lr_0 = 5.5129e-04
Loss = 1.0229e-01, PNorm = 44.3550, GNorm = 1.2883, lr_0 = 5.3989e-04
Validation rmse = 0.122654
Validation r2 = 0.898426
Validation mse = 0.015044
Epoch 17
Loss = 8.6060e-02, PNorm = 44.3735, GNorm = 0.6399, lr_0 = 5.2762e-04
Loss = 1.0156e-01, PNorm = 44.3916, GNorm = 1.1927, lr_0 = 5.1671e-04
Validation rmse = 0.095473
Validation r2 = 0.938456
Validation mse = 0.009115
Epoch 18
Loss = 1.2175e-01, PNorm = 44.4077, GNorm = 3.4041, lr_0 = 5.0497e-04
Loss = 1.0957e-01, PNorm = 44.4254, GNorm = 0.6206, lr_0 = 4.9453e-04
Validation rmse = 0.092657
Validation r2 = 0.942034
Validation mse = 0.008585
Epoch 19
Loss = 1.0567e-01, PNorm = 44.4428, GNorm = 1.4367, lr_0 = 4.8329e-04
Loss = 9.2306e-02, PNorm = 44.4590, GNorm = 1.2498, lr_0 = 4.7330e-04
Validation rmse = 0.127465
Validation r2 = 0.890302
Validation mse = 0.016247
Epoch 20
Loss = 1.0936e-01, PNorm = 44.4734, GNorm = 1.0598, lr_0 = 4.6351e-04
Loss = 8.5049e-02, PNorm = 44.4853, GNorm = 0.4914, lr_0 = 4.5393e-04
Validation rmse = 0.095474
Validation r2 = 0.938455
Validation mse = 0.009115
Epoch 21
Loss = 8.4660e-02, PNorm = 44.5013, GNorm = 1.7128, lr_0 = 4.4361e-04
Loss = 8.8406e-02, PNorm = 44.5131, GNorm = 1.2319, lr_0 = 4.3444e-04
Validation rmse = 0.081367
Validation r2 = 0.955299
Validation mse = 0.006621
Epoch 22
Loss = 8.4826e-02, PNorm = 44.5245, GNorm = 2.5034, lr_0 = 4.2457e-04
Loss = 7.9822e-02, PNorm = 44.5379, GNorm = 1.2374, lr_0 = 4.1579e-04
Validation rmse = 0.107935
Validation r2 = 0.921342
Validation mse = 0.011650
Epoch 23
Loss = 8.9525e-02, PNorm = 44.5528, GNorm = 0.5487, lr_0 = 4.0634e-04
Loss = 8.5103e-02, PNorm = 44.5638, GNorm = 1.7470, lr_0 = 3.9794e-04
Validation rmse = 0.097385
Validation r2 = 0.935967
Validation mse = 0.009484
Epoch 24
Loss = 9.3822e-02, PNorm = 44.5751, GNorm = 0.6866, lr_0 = 3.8971e-04
Loss = 7.7197e-02, PNorm = 44.5850, GNorm = 0.6902, lr_0 = 3.8165e-04
Validation rmse = 0.119462
Validation r2 = 0.903645
Validation mse = 0.014271
Epoch 25
Loss = 6.9215e-02, PNorm = 44.5969, GNorm = 0.5676, lr_0 = 3.7298e-04
Loss = 8.2832e-02, PNorm = 44.6067, GNorm = 1.8703, lr_0 = 3.6527e-04
Loss = 1.1888e-01, PNorm = 44.6079, GNorm = 3.5536, lr_0 = 3.6451e-04
Validation rmse = 0.089115
Validation r2 = 0.946380
Validation mse = 0.007942
Epoch 26
Loss = 8.2407e-02, PNorm = 44.6158, GNorm = 1.0738, lr_0 = 3.5697e-04
Loss = 8.8336e-02, PNorm = 44.6263, GNorm = 1.5369, lr_0 = 3.4959e-04
Validation rmse = 0.114680
Validation r2 = 0.911204
Validation mse = 0.013151
Epoch 27
Loss = 8.3357e-02, PNorm = 44.6393, GNorm = 2.5854, lr_0 = 3.4236e-04
Validation rmse = 0.091744
Validation r2 = 0.943170
Validation mse = 0.008417
Epoch 28
Loss = 5.9166e-02, PNorm = 44.6519, GNorm = 0.6099, lr_0 = 3.3458e-04
Loss = 8.0429e-02, PNorm = 44.6642, GNorm = 1.4537, lr_0 = 3.2766e-04
Validation rmse = 0.120581
Validation r2 = 0.901831
Validation mse = 0.014540
Epoch 29
Loss = 1.1717e-01, PNorm = 44.6747, GNorm = 2.7264, lr_0 = 3.2022e-04
Loss = 7.3221e-02, PNorm = 44.6839, GNorm = 1.3663, lr_0 = 3.1360e-04
Validation rmse = 0.107879
Validation r2 = 0.921423
Validation mse = 0.011638
Epoch 30
Loss = 7.1344e-02, PNorm = 44.6971, GNorm = 0.7533, lr_0 = 3.0647e-04
Loss = 6.8754e-02, PNorm = 44.7046, GNorm = 0.9096, lr_0 = 3.0013e-04
Validation rmse = 0.116925
Validation r2 = 0.907694
Validation mse = 0.013671
Epoch 31
Loss = 7.8828e-02, PNorm = 44.7137, GNorm = 2.8770, lr_0 = 2.9393e-04
Loss = 7.2613e-02, PNorm = 44.7218, GNorm = 0.8929, lr_0 = 2.8785e-04
Validation rmse = 0.100711
Validation r2 = 0.931519
Validation mse = 0.010143
Epoch 32
Loss = 7.4445e-02, PNorm = 44.7302, GNorm = 2.3978, lr_0 = 2.8131e-04
Loss = 6.8159e-02, PNorm = 44.7398, GNorm = 0.8446, lr_0 = 2.7549e-04
Validation rmse = 0.108507
Validation r2 = 0.920506
Validation mse = 0.011774
Epoch 33
Loss = 6.9555e-02, PNorm = 44.7498, GNorm = 1.4498, lr_0 = 2.6923e-04
Loss = 6.6937e-02, PNorm = 44.7587, GNorm = 0.7403, lr_0 = 2.6367e-04
Validation rmse = 0.127042
Validation r2 = 0.891029
Validation mse = 0.016140
Epoch 34
Loss = 8.3438e-02, PNorm = 44.7671, GNorm = 2.6239, lr_0 = 2.5767e-04
Loss = 7.2504e-02, PNorm = 44.7771, GNorm = 1.8975, lr_0 = 2.5235e-04
Validation rmse = 0.113077
Validation r2 = 0.913669
Validation mse = 0.012786
Epoch 35
Loss = 5.8351e-02, PNorm = 44.7854, GNorm = 0.6064, lr_0 = 2.4713e-04
Loss = 7.7050e-02, PNorm = 44.7939, GNorm = 2.5583, lr_0 = 2.4202e-04
Validation rmse = 0.128893
Validation r2 = 0.887829
Validation mse = 0.016613
Epoch 36
Loss = 8.0055e-02, PNorm = 44.8036, GNorm = 1.0660, lr_0 = 2.3652e-04
Loss = 6.1964e-02, PNorm = 44.8113, GNorm = 0.4741, lr_0 = 2.3163e-04
Validation rmse = 0.099506
Validation r2 = 0.933148
Validation mse = 0.009901
Epoch 37
Loss = 6.7345e-02, PNorm = 44.8180, GNorm = 1.2505, lr_0 = 2.2637e-04
Loss = 7.0638e-02, PNorm = 44.8255, GNorm = 1.7011, lr_0 = 2.2168e-04
Validation rmse = 0.106267
Validation r2 = 0.923754
Validation mse = 0.011293
Epoch 38
Loss = 6.0191e-02, PNorm = 44.8318, GNorm = 0.7538, lr_0 = 2.1665e-04
Loss = 6.0795e-02, PNorm = 44.8382, GNorm = 1.1426, lr_0 = 2.1217e-04
Validation rmse = 0.095678
Validation r2 = 0.938193
Validation mse = 0.009154
Epoch 39
Loss = 6.1695e-02, PNorm = 44.8451, GNorm = 1.2821, lr_0 = 2.0778e-04
Loss = 5.9342e-02, PNorm = 44.8519, GNorm = 0.3284, lr_0 = 2.0348e-04
Loss = 7.9661e-02, PNorm = 44.8525, GNorm = 1.5724, lr_0 = 2.0306e-04
Validation rmse = 0.098845
Validation r2 = 0.934033
Validation mse = 0.009770
Epoch 40
Loss = 6.3908e-02, PNorm = 44.8583, GNorm = 0.8621, lr_0 = 1.9886e-04
Validation rmse = 0.097725
Validation r2 = 0.935519
Validation mse = 0.009550
Epoch 41
Loss = 5.6408e-02, PNorm = 44.8658, GNorm = 1.1076, lr_0 = 1.9434e-04
Loss = 5.7766e-02, PNorm = 44.8721, GNorm = 0.9263, lr_0 = 1.9032e-04
Validation rmse = 0.101754
Validation r2 = 0.930092
Validation mse = 0.010354
Epoch 42
Loss = 2.9596e-02, PNorm = 44.8789, GNorm = 0.4542, lr_0 = 1.8600e-04
Loss = 6.6131e-02, PNorm = 44.8857, GNorm = 0.5364, lr_0 = 1.8215e-04
Validation rmse = 0.122305
Validation r2 = 0.899003
Validation mse = 0.014959
Epoch 43
Loss = 4.1337e-02, PNorm = 44.8922, GNorm = 0.5889, lr_0 = 1.7839e-04
Loss = 6.5072e-02, PNorm = 44.8991, GNorm = 1.7799, lr_0 = 1.7470e-04
Validation rmse = 0.101319
Validation r2 = 0.930690
Validation mse = 0.010265
Epoch 44
Loss = 6.7797e-02, PNorm = 44.9052, GNorm = 1.8289, lr_0 = 1.7073e-04
Loss = 5.2045e-02, PNorm = 44.9103, GNorm = 0.9323, lr_0 = 1.6720e-04
Validation rmse = 0.102784
Validation r2 = 0.928671
Validation mse = 0.010564
Epoch 45
Loss = 4.4931e-02, PNorm = 44.9171, GNorm = 1.0699, lr_0 = 1.6340e-04
Loss = 6.1972e-02, PNorm = 44.9217, GNorm = 0.9462, lr_0 = 1.6002e-04
Validation rmse = 0.099048
Validation r2 = 0.933762
Validation mse = 0.009810
Epoch 46
Loss = 5.5026e-02, PNorm = 44.9289, GNorm = 0.8490, lr_0 = 1.5638e-04
Loss = 5.0291e-02, PNorm = 44.9331, GNorm = 0.4160, lr_0 = 1.5315e-04
Validation rmse = 0.101354
Validation r2 = 0.930642
Validation mse = 0.010273
Epoch 47
Loss = 4.8613e-02, PNorm = 44.9382, GNorm = 0.8234, lr_0 = 1.4998e-04
Loss = 5.2905e-02, PNorm = 44.9445, GNorm = 0.5811, lr_0 = 1.4688e-04
Validation rmse = 0.103113
Validation r2 = 0.928212
Validation mse = 0.010632
Epoch 48
Loss = 4.7427e-02, PNorm = 44.9487, GNorm = 0.6941, lr_0 = 1.4354e-04
Loss = 5.3526e-02, PNorm = 44.9528, GNorm = 2.0271, lr_0 = 1.4058e-04
Validation rmse = 0.106812
Validation r2 = 0.922970
Validation mse = 0.011409
Epoch 49
Loss = 5.2013e-02, PNorm = 44.9589, GNorm = 0.8239, lr_0 = 1.3738e-04
Loss = 5.3445e-02, PNorm = 44.9635, GNorm = 0.5972, lr_0 = 1.3454e-04
Validation rmse = 0.101778
Validation r2 = 0.930059
Validation mse = 0.010359
Epoch 50
Loss = 5.1766e-02, PNorm = 44.9691, GNorm = 0.5946, lr_0 = 1.3176e-04
Loss = 4.5816e-02, PNorm = 44.9737, GNorm = 0.5795, lr_0 = 1.2904e-04
Validation rmse = 0.100605
Validation r2 = 0.931663
Validation mse = 0.010121
Epoch 51
Loss = 5.4086e-02, PNorm = 44.9780, GNorm = 1.0081, lr_0 = 1.2610e-04
Loss = 5.0768e-02, PNorm = 44.9824, GNorm = 1.6223, lr_0 = 1.2350e-04
Validation rmse = 0.104425
Validation r2 = 0.926374
Validation mse = 0.010905
Epoch 52
Loss = 5.1309e-02, PNorm = 44.9881, GNorm = 0.7916, lr_0 = 1.2069e-04
Loss = 4.9301e-02, PNorm = 44.9926, GNorm = 0.7413, lr_0 = 1.1819e-04
Loss = 2.2174e-02, PNorm = 44.9930, GNorm = 0.8696, lr_0 = 1.1795e-04
Validation rmse = 0.101917
Validation r2 = 0.929869
Validation mse = 0.010387
Epoch 53
Loss = 5.3043e-02, PNorm = 44.9974, GNorm = 1.5198, lr_0 = 1.1551e-04
Loss = 5.0645e-02, PNorm = 45.0020, GNorm = 3.5084, lr_0 = 1.1312e-04
Validation rmse = 0.105559
Validation r2 = 0.924766
Validation mse = 0.011143
Epoch 54
Loss = 4.8390e-02, PNorm = 45.0060, GNorm = 2.2867, lr_0 = 1.1078e-04
Validation rmse = 0.100836
Validation r2 = 0.931349
Validation mse = 0.010168
Epoch 55
Loss = 3.0402e-02, PNorm = 45.0107, GNorm = 1.1888, lr_0 = 1.0826e-04
Loss = 4.4923e-02, PNorm = 45.0143, GNorm = 0.5904, lr_0 = 1.0603e-04
Validation rmse = 0.097010
Validation r2 = 0.936460
Validation mse = 0.009411
Epoch 56
Loss = 5.1871e-02, PNorm = 45.0192, GNorm = 2.0842, lr_0 = 1.0362e-04
Loss = 5.3773e-02, PNorm = 45.0238, GNorm = 0.8305, lr_0 = 1.0147e-04
Validation rmse = 0.100436
Validation r2 = 0.931892
Validation mse = 0.010087
Epoch 57
Loss = 4.1498e-02, PNorm = 45.0281, GNorm = 0.7545, lr_0 = 1.0000e-04
Loss = 4.3935e-02, PNorm = 45.0312, GNorm = 0.9630, lr_0 = 1.0000e-04
Validation rmse = 0.099462
Validation r2 = 0.933206
Validation mse = 0.009893
Epoch 58
Loss = 5.0030e-02, PNorm = 45.0353, GNorm = 0.8943, lr_0 = 1.0000e-04
Loss = 4.7334e-02, PNorm = 45.0394, GNorm = 0.4839, lr_0 = 1.0000e-04
Validation rmse = 0.100299
Validation r2 = 0.932078
Validation mse = 0.010060
Epoch 59
Loss = 3.4927e-02, PNorm = 45.0428, GNorm = 0.5867, lr_0 = 1.0000e-04
Loss = 4.9058e-02, PNorm = 45.0468, GNorm = 1.4369, lr_0 = 1.0000e-04
Validation rmse = 0.101902
Validation r2 = 0.929890
Validation mse = 0.010384
Model 0 best validation rmse = 0.081367 on epoch 21
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.253834
Model 0 test r2 = 0.058917
Model 0 test mse = 0.064432
Ensemble test rmse = 0.253834
Ensemble test r2 = 0.058917
Ensemble test mse = 0.064432
Fold 9
Splitting data with seed 9
Total size = 973 | train size = 963 | val size = 10 | test size = 59
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 1.0158e+00, PNorm = 43.2607, GNorm = 7.3296, lr_0 = 3.6053e-04
Validation rmse = 0.300260
Validation r2 = 0.348671
Validation mse = 0.090156
Epoch 1
Loss = 6.0512e-01, PNorm = 43.2834, GNorm = 6.5761, lr_0 = 6.2105e-04
Loss = 7.1297e-01, PNorm = 43.3251, GNorm = 9.8665, lr_0 = 8.5789e-04
Validation rmse = 0.251634
Validation r2 = 0.542551
Validation mse = 0.063320
Epoch 2
Loss = 5.9491e-01, PNorm = 43.3986, GNorm = 10.7721, lr_0 = 9.8961e-04
Loss = 4.6299e-01, PNorm = 43.4796, GNorm = 3.2970, lr_0 = 9.6914e-04
Validation rmse = 0.185291
Validation r2 = 0.751966
Validation mse = 0.034333
Epoch 3
Loss = 3.5123e-01, PNorm = 43.5731, GNorm = 4.9971, lr_0 = 9.4712e-04
Loss = 2.8008e-01, PNorm = 43.6413, GNorm = 1.3217, lr_0 = 9.2754e-04
Validation rmse = 0.172091
Validation r2 = 0.786047
Validation mse = 0.029615
Epoch 4
Loss = 2.4126e-01, PNorm = 43.7022, GNorm = 5.4517, lr_0 = 9.0836e-04
Loss = 3.2344e-01, PNorm = 43.7578, GNorm = 5.5568, lr_0 = 8.8958e-04
Validation rmse = 0.217998
Validation r2 = 0.656672
Validation mse = 0.047523
Epoch 5
Loss = 2.5265e-01, PNorm = 43.8125, GNorm = 3.4982, lr_0 = 8.6936e-04
Loss = 2.7418e-01, PNorm = 43.8680, GNorm = 4.5226, lr_0 = 8.5139e-04
Validation rmse = 0.127661
Validation r2 = 0.882260
Validation mse = 0.016297
Epoch 6
Loss = 1.6564e-01, PNorm = 43.9142, GNorm = 1.1839, lr_0 = 8.3204e-04
Loss = 1.9245e-01, PNorm = 43.9508, GNorm = 1.0365, lr_0 = 8.1484e-04
Validation rmse = 0.164415
Validation r2 = 0.804707
Validation mse = 0.027032
Epoch 7
Loss = 1.6726e-01, PNorm = 43.9847, GNorm = 1.1551, lr_0 = 7.9632e-04
Loss = 1.5891e-01, PNorm = 44.0061, GNorm = 1.3881, lr_0 = 7.7986e-04
Validation rmse = 0.135506
Validation r2 = 0.867346
Validation mse = 0.018362
Epoch 8
Loss = 1.5709e-01, PNorm = 44.0318, GNorm = 2.6770, lr_0 = 7.6373e-04
Loss = 1.5316e-01, PNorm = 44.0565, GNorm = 2.7604, lr_0 = 7.4794e-04
Validation rmse = 0.122148
Validation r2 = 0.892210
Validation mse = 0.014920
Epoch 9
Loss = 1.1816e-01, PNorm = 44.0856, GNorm = 0.8757, lr_0 = 7.3094e-04
Loss = 1.3232e-01, PNorm = 44.1056, GNorm = 2.1408, lr_0 = 7.1583e-04
Validation rmse = 0.115046
Validation r2 = 0.904380
Validation mse = 0.013236
Epoch 10
Loss = 1.7382e-01, PNorm = 44.1207, GNorm = 4.2273, lr_0 = 6.9956e-04
Loss = 1.3495e-01, PNorm = 44.1447, GNorm = 1.7778, lr_0 = 6.8510e-04
Validation rmse = 0.144078
Validation r2 = 0.850031
Validation mse = 0.020759
Epoch 11
Loss = 1.2263e-01, PNorm = 44.1708, GNorm = 2.0523, lr_0 = 6.6953e-04
Loss = 1.2384e-01, PNorm = 44.1925, GNorm = 1.9936, lr_0 = 6.5569e-04
Validation rmse = 0.118050
Validation r2 = 0.899321
Validation mse = 0.013936
Epoch 12
Loss = 1.1699e-01, PNorm = 44.2129, GNorm = 1.5371, lr_0 = 6.4213e-04
Loss = 1.1128e-01, PNorm = 44.2289, GNorm = 2.3109, lr_0 = 6.2885e-04
Loss = 6.0285e-02, PNorm = 44.2302, GNorm = 1.3834, lr_0 = 6.2754e-04
Validation rmse = 0.122917
Validation r2 = 0.890850
Validation mse = 0.015108
Epoch 13
Loss = 1.0315e-01, PNorm = 44.2505, GNorm = 0.8378, lr_0 = 6.1456e-04
Validation rmse = 0.131660
Validation r2 = 0.874769
Validation mse = 0.017334
Epoch 14
Loss = 1.3819e-01, PNorm = 44.2681, GNorm = 1.4544, lr_0 = 6.0060e-04
Loss = 1.0216e-01, PNorm = 44.2851, GNorm = 2.2939, lr_0 = 5.8818e-04
Validation rmse = 0.155671
Validation r2 = 0.824927
Validation mse = 0.024233
Epoch 15
Loss = 1.4462e-01, PNorm = 44.3104, GNorm = 1.7060, lr_0 = 5.7482e-04
Loss = 1.0492e-01, PNorm = 44.3297, GNorm = 0.8040, lr_0 = 5.6293e-04
Validation rmse = 0.129557
Validation r2 = 0.878738
Validation mse = 0.016785
Epoch 16
Loss = 1.0386e-01, PNorm = 44.3466, GNorm = 4.2932, lr_0 = 5.5129e-04
Loss = 1.0633e-01, PNorm = 44.3682, GNorm = 1.0399, lr_0 = 5.3989e-04
Validation rmse = 0.110281
Validation r2 = 0.912137
Validation mse = 0.012162
Epoch 17
Loss = 1.0749e-01, PNorm = 44.3885, GNorm = 2.8823, lr_0 = 5.2762e-04
Loss = 1.3607e-01, PNorm = 44.4066, GNorm = 2.1704, lr_0 = 5.1671e-04
Validation rmse = 0.146668
Validation r2 = 0.844592
Validation mse = 0.021511
Epoch 18
Loss = 1.0068e-01, PNorm = 44.4239, GNorm = 1.6587, lr_0 = 5.0497e-04
Loss = 1.0111e-01, PNorm = 44.4396, GNorm = 0.9291, lr_0 = 4.9453e-04
Validation rmse = 0.108333
Validation r2 = 0.915214
Validation mse = 0.011736
Epoch 19
Loss = 9.2667e-02, PNorm = 44.4560, GNorm = 1.2103, lr_0 = 4.8329e-04
Loss = 9.0050e-02, PNorm = 44.4721, GNorm = 1.2890, lr_0 = 4.7330e-04
Validation rmse = 0.149071
Validation r2 = 0.839457
Validation mse = 0.022222
Epoch 20
Loss = 1.0154e-01, PNorm = 44.4829, GNorm = 2.2497, lr_0 = 4.6351e-04
Loss = 8.8753e-02, PNorm = 44.4980, GNorm = 0.9196, lr_0 = 4.5393e-04
Validation rmse = 0.134226
Validation r2 = 0.869839
Validation mse = 0.018017
Epoch 21
Loss = 7.5476e-02, PNorm = 44.5147, GNorm = 1.1207, lr_0 = 4.4361e-04
Loss = 7.6405e-02, PNorm = 44.5264, GNorm = 0.9732, lr_0 = 4.3444e-04
Validation rmse = 0.116044
Validation r2 = 0.902714
Validation mse = 0.013466
Epoch 22
Loss = 8.1464e-02, PNorm = 44.5397, GNorm = 0.6924, lr_0 = 4.2457e-04
Loss = 8.8745e-02, PNorm = 44.5539, GNorm = 1.1877, lr_0 = 4.1579e-04
Validation rmse = 0.120590
Validation r2 = 0.894942
Validation mse = 0.014542
Epoch 23
Loss = 9.5061e-02, PNorm = 44.5662, GNorm = 0.5194, lr_0 = 4.0634e-04
Loss = 7.1661e-02, PNorm = 44.5769, GNorm = 0.6288, lr_0 = 3.9794e-04
Validation rmse = 0.127851
Validation r2 = 0.881910
Validation mse = 0.016346
Epoch 24
Loss = 7.6203e-02, PNorm = 44.5889, GNorm = 0.7718, lr_0 = 3.8971e-04
Loss = 8.0334e-02, PNorm = 44.5996, GNorm = 1.9768, lr_0 = 3.8165e-04
Validation rmse = 0.106222
Validation r2 = 0.918486
Validation mse = 0.011283
Epoch 25
Loss = 9.0208e-02, PNorm = 44.6166, GNorm = 1.5208, lr_0 = 3.7298e-04
Loss = 8.5456e-02, PNorm = 44.6327, GNorm = 5.6657, lr_0 = 3.6527e-04
Loss = 9.5753e-02, PNorm = 44.6347, GNorm = 1.6579, lr_0 = 3.6451e-04
Validation rmse = 0.126786
Validation r2 = 0.883869
Validation mse = 0.016075
Epoch 26
Loss = 8.4295e-02, PNorm = 44.6501, GNorm = 1.2057, lr_0 = 3.5697e-04
Loss = 8.3919e-02, PNorm = 44.6628, GNorm = 1.8963, lr_0 = 3.4959e-04
Validation rmse = 0.137759
Validation r2 = 0.862897
Validation mse = 0.018978
Epoch 27
Loss = 7.6617e-02, PNorm = 44.6744, GNorm = 0.9549, lr_0 = 3.4236e-04
Validation rmse = 0.141824
Validation r2 = 0.854688
Validation mse = 0.020114
Epoch 28
Loss = 6.8452e-02, PNorm = 44.6868, GNorm = 1.0055, lr_0 = 3.3458e-04
Loss = 5.8394e-02, PNorm = 44.6993, GNorm = 0.5202, lr_0 = 3.2766e-04
Validation rmse = 0.124658
Validation r2 = 0.887734
Validation mse = 0.015540
Epoch 29
Loss = 9.1008e-02, PNorm = 44.7092, GNorm = 1.5691, lr_0 = 3.2022e-04
Loss = 6.7119e-02, PNorm = 44.7219, GNorm = 1.9334, lr_0 = 3.1360e-04
Validation rmse = 0.111083
Validation r2 = 0.910854
Validation mse = 0.012339
Epoch 30
Loss = 7.3546e-02, PNorm = 44.7345, GNorm = 1.8714, lr_0 = 3.0647e-04
Loss = 7.4424e-02, PNorm = 44.7464, GNorm = 1.2044, lr_0 = 3.0013e-04
Validation rmse = 0.112453
Validation r2 = 0.908642
Validation mse = 0.012646
Epoch 31
Loss = 7.3628e-02, PNorm = 44.7591, GNorm = 0.8009, lr_0 = 2.9393e-04
Loss = 7.5076e-02, PNorm = 44.7699, GNorm = 0.5178, lr_0 = 2.8785e-04
Validation rmse = 0.120549
Validation r2 = 0.895013
Validation mse = 0.014532
Epoch 32
Loss = 5.1400e-02, PNorm = 44.7826, GNorm = 1.4561, lr_0 = 2.8131e-04
Loss = 6.3119e-02, PNorm = 44.7918, GNorm = 2.1950, lr_0 = 2.7549e-04
Validation rmse = 0.127665
Validation r2 = 0.882253
Validation mse = 0.016298
Epoch 33
Loss = 7.5823e-02, PNorm = 44.8041, GNorm = 1.7600, lr_0 = 2.6923e-04
Loss = 6.6670e-02, PNorm = 44.8135, GNorm = 2.3325, lr_0 = 2.6367e-04
Validation rmse = 0.131448
Validation r2 = 0.875171
Validation mse = 0.017279
Epoch 34
Loss = 6.2711e-02, PNorm = 44.8269, GNorm = 0.6328, lr_0 = 2.5767e-04
Loss = 6.0949e-02, PNorm = 44.8382, GNorm = 0.6639, lr_0 = 2.5235e-04
Validation rmse = 0.121263
Validation r2 = 0.893767
Validation mse = 0.014705
Epoch 35
Loss = 5.8703e-02, PNorm = 44.8477, GNorm = 2.1345, lr_0 = 2.4713e-04
Loss = 6.8549e-02, PNorm = 44.8566, GNorm = 1.1035, lr_0 = 2.4202e-04
Validation rmse = 0.135554
Validation r2 = 0.867252
Validation mse = 0.018375
Epoch 36
Loss = 6.7290e-02, PNorm = 44.8663, GNorm = 1.4966, lr_0 = 2.3652e-04
Loss = 6.9169e-02, PNorm = 44.8757, GNorm = 0.9247, lr_0 = 2.3163e-04
Validation rmse = 0.123111
Validation r2 = 0.890505
Validation mse = 0.015156
Epoch 37
Loss = 5.4956e-02, PNorm = 44.8861, GNorm = 0.6543, lr_0 = 2.2637e-04
Loss = 5.9519e-02, PNorm = 44.8944, GNorm = 0.6872, lr_0 = 2.2168e-04
Validation rmse = 0.118196
Validation r2 = 0.899072
Validation mse = 0.013970
Epoch 38
Loss = 6.1768e-02, PNorm = 44.9023, GNorm = 0.9890, lr_0 = 2.1665e-04
Loss = 5.0326e-02, PNorm = 44.9107, GNorm = 0.9178, lr_0 = 2.1217e-04
Validation rmse = 0.124351
Validation r2 = 0.888287
Validation mse = 0.015463
Epoch 39
Loss = 5.0869e-02, PNorm = 44.9179, GNorm = 0.9122, lr_0 = 2.0778e-04
Loss = 6.1531e-02, PNorm = 44.9264, GNorm = 0.9507, lr_0 = 2.0348e-04
Loss = 1.0555e-01, PNorm = 44.9271, GNorm = 2.1638, lr_0 = 2.0306e-04
Validation rmse = 0.116688
Validation r2 = 0.901631
Validation mse = 0.013616
Epoch 40
Loss = 5.7401e-02, PNorm = 44.9350, GNorm = 1.2739, lr_0 = 1.9886e-04
Validation rmse = 0.140147
Validation r2 = 0.858104
Validation mse = 0.019641
Epoch 41
Loss = 6.6406e-02, PNorm = 44.9435, GNorm = 1.3628, lr_0 = 1.9434e-04
Loss = 4.9119e-02, PNorm = 44.9506, GNorm = 0.5777, lr_0 = 1.9032e-04
Validation rmse = 0.134417
Validation r2 = 0.869469
Validation mse = 0.018068
Epoch 42
Loss = 4.5985e-02, PNorm = 44.9577, GNorm = 1.1586, lr_0 = 1.8600e-04
Loss = 4.8126e-02, PNorm = 44.9646, GNorm = 1.4498, lr_0 = 1.8215e-04
Validation rmse = 0.127767
Validation r2 = 0.882065
Validation mse = 0.016324
Epoch 43
Loss = 4.0225e-02, PNorm = 44.9703, GNorm = 1.0820, lr_0 = 1.7839e-04
Loss = 4.8845e-02, PNorm = 44.9761, GNorm = 0.9921, lr_0 = 1.7470e-04
Validation rmse = 0.133096
Validation r2 = 0.872022
Validation mse = 0.017715
Epoch 44
Loss = 4.8695e-02, PNorm = 44.9825, GNorm = 0.7093, lr_0 = 1.7073e-04
Loss = 4.9982e-02, PNorm = 44.9890, GNorm = 1.5131, lr_0 = 1.6720e-04
Validation rmse = 0.132640
Validation r2 = 0.872898
Validation mse = 0.017593
Epoch 45
Loss = 5.9568e-02, PNorm = 44.9951, GNorm = 2.1597, lr_0 = 1.6340e-04
Loss = 4.8005e-02, PNorm = 45.0025, GNorm = 1.6529, lr_0 = 1.6002e-04
Validation rmse = 0.124898
Validation r2 = 0.887303
Validation mse = 0.015599
Epoch 46
Loss = 3.9143e-02, PNorm = 45.0076, GNorm = 1.0014, lr_0 = 1.5638e-04
Loss = 4.9682e-02, PNorm = 45.0142, GNorm = 0.8368, lr_0 = 1.5315e-04
Validation rmse = 0.125717
Validation r2 = 0.885819
Validation mse = 0.015805
Epoch 47
Loss = 5.2607e-02, PNorm = 45.0204, GNorm = 0.6436, lr_0 = 1.4998e-04
Loss = 4.3957e-02, PNorm = 45.0262, GNorm = 0.3571, lr_0 = 1.4688e-04
Validation rmse = 0.122934
Validation r2 = 0.890819
Validation mse = 0.015113
Epoch 48
Loss = 4.2674e-02, PNorm = 45.0314, GNorm = 0.6323, lr_0 = 1.4354e-04
Loss = 4.7890e-02, PNorm = 45.0366, GNorm = 2.3791, lr_0 = 1.4058e-04
Validation rmse = 0.127682
Validation r2 = 0.882222
Validation mse = 0.016303
Epoch 49
Loss = 4.6133e-02, PNorm = 45.0424, GNorm = 1.2439, lr_0 = 1.3738e-04
Loss = 4.4563e-02, PNorm = 45.0472, GNorm = 1.0692, lr_0 = 1.3454e-04
Validation rmse = 0.130537
Validation r2 = 0.876897
Validation mse = 0.017040
Epoch 50
Loss = 5.6097e-02, PNorm = 45.0533, GNorm = 1.1751, lr_0 = 1.3176e-04
Loss = 3.7033e-02, PNorm = 45.0584, GNorm = 0.4516, lr_0 = 1.2904e-04
Validation rmse = 0.125044
Validation r2 = 0.887038
Validation mse = 0.015636
Epoch 51
Loss = 3.7362e-02, PNorm = 45.0632, GNorm = 0.5082, lr_0 = 1.2610e-04
Loss = 4.1546e-02, PNorm = 45.0673, GNorm = 0.6695, lr_0 = 1.2350e-04
Validation rmse = 0.127520
Validation r2 = 0.882521
Validation mse = 0.016261
Epoch 52
Loss = 3.8978e-02, PNorm = 45.0713, GNorm = 0.6570, lr_0 = 1.2069e-04
Loss = 3.9809e-02, PNorm = 45.0759, GNorm = 0.4118, lr_0 = 1.1819e-04
Loss = 1.2058e-01, PNorm = 45.0765, GNorm = 2.1875, lr_0 = 1.1795e-04
Validation rmse = 0.127810
Validation r2 = 0.881985
Validation mse = 0.016335
Epoch 53
Loss = 4.0117e-02, PNorm = 45.0811, GNorm = 1.0647, lr_0 = 1.1551e-04
Loss = 4.4564e-02, PNorm = 45.0858, GNorm = 1.3922, lr_0 = 1.1312e-04
Validation rmse = 0.125318
Validation r2 = 0.886542
Validation mse = 0.015705
Epoch 54
Loss = 4.0287e-02, PNorm = 45.0896, GNorm = 1.0593, lr_0 = 1.1078e-04
Validation rmse = 0.128110
Validation r2 = 0.881431
Validation mse = 0.016412
Epoch 55
Loss = 6.4330e-02, PNorm = 45.0939, GNorm = 0.8837, lr_0 = 1.0826e-04
Loss = 3.5656e-02, PNorm = 45.0974, GNorm = 0.8650, lr_0 = 1.0603e-04
Validation rmse = 0.127120
Validation r2 = 0.883257
Validation mse = 0.016160
Epoch 56
Loss = 3.3544e-02, PNorm = 45.1016, GNorm = 1.0572, lr_0 = 1.0362e-04
Loss = 3.8237e-02, PNorm = 45.1049, GNorm = 0.8071, lr_0 = 1.0147e-04
Validation rmse = 0.129295
Validation r2 = 0.879228
Validation mse = 0.016717
Epoch 57
Loss = 2.8759e-02, PNorm = 45.1088, GNorm = 0.7535, lr_0 = 1.0000e-04
Loss = 3.4504e-02, PNorm = 45.1119, GNorm = 0.6828, lr_0 = 1.0000e-04
Validation rmse = 0.129194
Validation r2 = 0.879417
Validation mse = 0.016691
Epoch 58
Loss = 4.3140e-02, PNorm = 45.1159, GNorm = 0.7047, lr_0 = 1.0000e-04
Loss = 3.4992e-02, PNorm = 45.1196, GNorm = 0.7708, lr_0 = 1.0000e-04
Validation rmse = 0.121214
Validation r2 = 0.893852
Validation mse = 0.014693
Epoch 59
Loss = 3.5979e-02, PNorm = 45.1237, GNorm = 0.8464, lr_0 = 1.0000e-04
Loss = 3.6039e-02, PNorm = 45.1269, GNorm = 0.5722, lr_0 = 1.0000e-04
Validation rmse = 0.126150
Validation r2 = 0.885031
Validation mse = 0.015914
Model 0 best validation rmse = 0.106222 on epoch 24
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.187425
Model 0 test r2 = 0.486922
Model 0 test mse = 0.035128
Ensemble test rmse = 0.187425
Ensemble test r2 = 0.486922
Ensemble test mse = 0.035128
10-fold cross validation
	Seed 0 ==> test rmse = 0.192762
	Seed 0 ==> test r2 = 0.457287
	Seed 0 ==> test mse = 0.037157
	Seed 1 ==> test rmse = 0.259439
	Seed 1 ==> test r2 = 0.016894
	Seed 1 ==> test mse = 0.067309
	Seed 2 ==> test rmse = 0.177057
	Seed 2 ==> test r2 = 0.542116
	Seed 2 ==> test mse = 0.031349
	Seed 3 ==> test rmse = 0.190281
	Seed 3 ==> test r2 = 0.471166
	Seed 3 ==> test mse = 0.036207
	Seed 4 ==> test rmse = 0.182744
	Seed 4 ==> test r2 = 0.512231
	Seed 4 ==> test mse = 0.033395
	Seed 5 ==> test rmse = 0.175846
	Seed 5 ==> test r2 = 0.548359
	Seed 5 ==> test mse = 0.030922
	Seed 6 ==> test rmse = 0.231665
	Seed 6 ==> test r2 = 0.216122
	Seed 6 ==> test mse = 0.053669
	Seed 7 ==> test rmse = 0.172654
	Seed 7 ==> test r2 = 0.564608
	Seed 7 ==> test mse = 0.029809
	Seed 8 ==> test rmse = 0.253834
	Seed 8 ==> test r2 = 0.058917
	Seed 8 ==> test mse = 0.064432
	Seed 9 ==> test rmse = 0.187425
	Seed 9 ==> test r2 = 0.486922
	Seed 9 ==> test mse = 0.035128
Overall test rmse = 0.202371 +/- 0.031366
Overall test r2 = 0.387462 +/- 0.198280
Overall test mse = 0.041938 +/- 0.013575
Elapsed time = 0:07:06
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-05d85262-3219-459a-86b2-5360cba4da72.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/DMF_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2', 'mse'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2', 'mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/DMF_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/DMF_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 934 | train size = 924 | val size = 10 | test size = 98
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.3813e-01, PNorm = 43.2616, GNorm = 1.4597, lr_0 = 3.7500e-04
Validation rmse = 0.212962
Validation r2 = 0.518053
Validation mse = 0.045353
Epoch 1
Loss = 6.3755e-01, PNorm = 43.2882, GNorm = 4.1601, lr_0 = 6.5000e-04
Loss = 6.6683e-01, PNorm = 43.3367, GNorm = 3.2846, lr_0 = 9.0000e-04
Validation rmse = 0.260643
Validation r2 = 0.278082
Validation mse = 0.067935
Epoch 2
Loss = 5.9237e-01, PNorm = 43.4098, GNorm = 5.3555, lr_0 = 9.8468e-04
Loss = 5.5275e-01, PNorm = 43.4910, GNorm = 0.7366, lr_0 = 9.6320e-04
Validation rmse = 0.156177
Validation r2 = 0.740805
Validation mse = 0.024391
Epoch 3
Loss = 3.8654e-01, PNorm = 43.5750, GNorm = 2.0533, lr_0 = 9.4219e-04
Loss = 3.8008e-01, PNorm = 43.6458, GNorm = 1.8547, lr_0 = 9.2164e-04
Validation rmse = 0.150779
Validation r2 = 0.758411
Validation mse = 0.022734
Epoch 4
Loss = 3.6671e-01, PNorm = 43.7243, GNorm = 7.5249, lr_0 = 8.9955e-04
Loss = 3.0388e-01, PNorm = 43.7880, GNorm = 1.8149, lr_0 = 8.7992e-04
Validation rmse = 0.129441
Validation r2 = 0.821952
Validation mse = 0.016755
Epoch 5
Loss = 2.4249e-01, PNorm = 43.8361, GNorm = 5.7718, lr_0 = 8.6073e-04
Loss = 2.2637e-01, PNorm = 43.8826, GNorm = 2.2028, lr_0 = 8.4195e-04
Loss = 1.2516e-01, PNorm = 43.8871, GNorm = 2.2042, lr_0 = 8.4010e-04
Validation rmse = 0.105004
Validation r2 = 0.882833
Validation mse = 0.011026
Epoch 6
Loss = 1.8444e-01, PNorm = 43.9280, GNorm = 1.4921, lr_0 = 8.2177e-04
Validation rmse = 0.094561
Validation r2 = 0.904980
Validation mse = 0.008942
Epoch 7
Loss = 2.2178e-01, PNorm = 43.9641, GNorm = 1.2846, lr_0 = 8.0385e-04
Loss = 1.6488e-01, PNorm = 43.9948, GNorm = 3.7742, lr_0 = 7.8631e-04
Validation rmse = 0.094302
Validation r2 = 0.905499
Validation mse = 0.008893
Epoch 8
Loss = 1.0529e-01, PNorm = 44.0203, GNorm = 1.6683, lr_0 = 7.6746e-04
Loss = 1.4727e-01, PNorm = 44.0455, GNorm = 2.4485, lr_0 = 7.5072e-04
Validation rmse = 0.083178
Validation r2 = 0.926479
Validation mse = 0.006919
Epoch 9
Loss = 1.6244e-01, PNorm = 44.0723, GNorm = 3.5135, lr_0 = 7.3435e-04
Loss = 1.3135e-01, PNorm = 44.0990, GNorm = 2.6103, lr_0 = 7.1833e-04
Validation rmse = 0.129963
Validation r2 = 0.820512
Validation mse = 0.016890
Epoch 10
Loss = 1.4227e-01, PNorm = 44.1206, GNorm = 1.4597, lr_0 = 7.0111e-04
Loss = 1.4919e-01, PNorm = 44.1371, GNorm = 3.3329, lr_0 = 6.8581e-04
Validation rmse = 0.147713
Validation r2 = 0.768137
Validation mse = 0.021819
Epoch 11
Loss = 1.2570e-01, PNorm = 44.1615, GNorm = 1.0924, lr_0 = 6.7085e-04
Loss = 1.2321e-01, PNorm = 44.1796, GNorm = 0.9874, lr_0 = 6.5622e-04
Validation rmse = 0.103864
Validation r2 = 0.885362
Validation mse = 0.010788
Epoch 12
Loss = 1.2792e-01, PNorm = 44.1998, GNorm = 3.2222, lr_0 = 6.4049e-04
Loss = 1.1103e-01, PNorm = 44.2157, GNorm = 1.7434, lr_0 = 6.2652e-04
Validation rmse = 0.109977
Validation r2 = 0.871471
Validation mse = 0.012095
Epoch 13
Loss = 1.1292e-01, PNorm = 44.2383, GNorm = 2.0163, lr_0 = 6.1285e-04
Validation rmse = 0.099869
Validation r2 = 0.894011
Validation mse = 0.009974
Epoch 14
Loss = 9.8770e-02, PNorm = 44.2550, GNorm = 0.6265, lr_0 = 5.9816e-04
Loss = 9.7950e-02, PNorm = 44.2708, GNorm = 0.7007, lr_0 = 5.8512e-04
Validation rmse = 0.100034
Validation r2 = 0.893662
Validation mse = 0.010007
Epoch 15
Loss = 1.0461e-01, PNorm = 44.2882, GNorm = 1.4828, lr_0 = 5.7235e-04
Loss = 1.1379e-01, PNorm = 44.3001, GNorm = 1.1746, lr_0 = 5.5987e-04
Validation rmse = 0.108414
Validation r2 = 0.875098
Validation mse = 0.011754
Epoch 16
Loss = 1.1461e-01, PNorm = 44.3206, GNorm = 1.1962, lr_0 = 5.4645e-04
Loss = 9.6454e-02, PNorm = 44.3407, GNorm = 0.7842, lr_0 = 5.3453e-04
Validation rmse = 0.129374
Validation r2 = 0.822135
Validation mse = 0.016738
Epoch 17
Loss = 9.6235e-02, PNorm = 44.3566, GNorm = 1.3439, lr_0 = 5.2287e-04
Loss = 1.2603e-01, PNorm = 44.3744, GNorm = 2.1706, lr_0 = 5.1146e-04
Validation rmse = 0.100860
Validation r2 = 0.891898
Validation mse = 0.010173
Epoch 18
Loss = 1.1063e-01, PNorm = 44.3920, GNorm = 1.8192, lr_0 = 4.9920e-04
Loss = 9.3034e-02, PNorm = 44.4075, GNorm = 0.7002, lr_0 = 4.8831e-04
Validation rmse = 0.120578
Validation r2 = 0.845498
Validation mse = 0.014539
Epoch 19
Loss = 9.1415e-02, PNorm = 44.4202, GNorm = 1.1243, lr_0 = 4.7766e-04
Validation rmse = 0.108216
Validation r2 = 0.875556
Validation mse = 0.011711
Epoch 20
Loss = 6.7265e-02, PNorm = 44.4327, GNorm = 1.2541, lr_0 = 4.6621e-04
Loss = 9.2127e-02, PNorm = 44.4430, GNorm = 0.7222, lr_0 = 4.5604e-04
Validation rmse = 0.112416
Validation r2 = 0.865706
Validation mse = 0.012637
Epoch 21
Loss = 5.6751e-02, PNorm = 44.4579, GNorm = 1.3918, lr_0 = 4.4609e-04
Loss = 9.0022e-02, PNorm = 44.4707, GNorm = 2.2348, lr_0 = 4.3636e-04
Validation rmse = 0.112371
Validation r2 = 0.865815
Validation mse = 0.012627
Epoch 22
Loss = 7.8426e-02, PNorm = 44.4850, GNorm = 1.2726, lr_0 = 4.2590e-04
Loss = 1.0489e-01, PNorm = 44.4977, GNorm = 1.3129, lr_0 = 4.1661e-04
Validation rmse = 0.120312
Validation r2 = 0.846179
Validation mse = 0.014475
Epoch 23
Loss = 9.5131e-02, PNorm = 44.5095, GNorm = 2.2152, lr_0 = 4.0752e-04
Loss = 8.9665e-02, PNorm = 44.5247, GNorm = 1.3887, lr_0 = 3.9863e-04
Validation rmse = 0.100153
Validation r2 = 0.893409
Validation mse = 0.010031
Epoch 24
Loss = 8.7477e-02, PNorm = 44.5396, GNorm = 1.6242, lr_0 = 3.8908e-04
Loss = 9.5810e-02, PNorm = 44.5520, GNorm = 1.3907, lr_0 = 3.8059e-04
Validation rmse = 0.105336
Validation r2 = 0.882090
Validation mse = 0.011096
Epoch 25
Loss = 1.0024e-01, PNorm = 44.5677, GNorm = 2.2225, lr_0 = 3.7229e-04
Loss = 8.2060e-02, PNorm = 44.5808, GNorm = 0.5698, lr_0 = 3.6417e-04
Loss = 1.2195e-01, PNorm = 44.5819, GNorm = 2.1327, lr_0 = 3.6337e-04
Validation rmse = 0.095022
Validation r2 = 0.904051
Validation mse = 0.009029
Epoch 26
Loss = 8.4496e-02, PNorm = 44.5935, GNorm = 0.8853, lr_0 = 3.5544e-04
Validation rmse = 0.108980
Validation r2 = 0.873790
Validation mse = 0.011877
Epoch 27
Loss = 8.2152e-02, PNorm = 44.6061, GNorm = 0.7526, lr_0 = 3.4692e-04
Loss = 7.9279e-02, PNorm = 44.6172, GNorm = 0.9653, lr_0 = 3.3935e-04
Validation rmse = 0.102276
Validation r2 = 0.888842
Validation mse = 0.010460
Epoch 28
Loss = 5.3009e-02, PNorm = 44.6273, GNorm = 0.8221, lr_0 = 3.3195e-04
Loss = 7.9997e-02, PNorm = 44.6369, GNorm = 0.8275, lr_0 = 3.2471e-04
Validation rmse = 0.114137
Validation r2 = 0.861563
Validation mse = 0.013027
Epoch 29
Loss = 8.2379e-02, PNorm = 44.6450, GNorm = 0.4954, lr_0 = 3.1693e-04
Loss = 7.8644e-02, PNorm = 44.6556, GNorm = 0.9286, lr_0 = 3.1001e-04
Validation rmse = 0.110353
Validation r2 = 0.870591
Validation mse = 0.012178
Epoch 30
Loss = 7.8615e-02, PNorm = 44.6644, GNorm = 0.8343, lr_0 = 3.0325e-04
Loss = 7.5713e-02, PNorm = 44.6764, GNorm = 0.9570, lr_0 = 2.9663e-04
Validation rmse = 0.103448
Validation r2 = 0.886279
Validation mse = 0.010701
Epoch 31
Loss = 6.7279e-02, PNorm = 44.6885, GNorm = 0.6164, lr_0 = 2.8952e-04
Loss = 7.6238e-02, PNorm = 44.6955, GNorm = 1.8055, lr_0 = 2.8321e-04
Validation rmse = 0.100796
Validation r2 = 0.892036
Validation mse = 0.010160
Epoch 32
Loss = 7.2375e-02, PNorm = 44.7051, GNorm = 0.7730, lr_0 = 2.7703e-04
Validation rmse = 0.103983
Validation r2 = 0.885099
Validation mse = 0.010813
Epoch 33
Loss = 6.3445e-02, PNorm = 44.7145, GNorm = 0.6167, lr_0 = 2.7039e-04
Loss = 7.3214e-02, PNorm = 44.7230, GNorm = 1.2453, lr_0 = 2.6449e-04
Validation rmse = 0.106976
Validation r2 = 0.878391
Validation mse = 0.011444
Epoch 34
Loss = 9.0250e-02, PNorm = 44.7316, GNorm = 1.1542, lr_0 = 2.5872e-04
Loss = 7.2102e-02, PNorm = 44.7412, GNorm = 1.0397, lr_0 = 2.5308e-04
Validation rmse = 0.101313
Validation r2 = 0.890924
Validation mse = 0.010264
Epoch 35
Loss = 7.1783e-02, PNorm = 44.7509, GNorm = 0.7763, lr_0 = 2.4701e-04
Loss = 6.8116e-02, PNorm = 44.7576, GNorm = 1.4938, lr_0 = 2.4162e-04
Validation rmse = 0.104231
Validation r2 = 0.884551
Validation mse = 0.010864
Epoch 36
Loss = 5.3043e-02, PNorm = 44.7665, GNorm = 2.2099, lr_0 = 2.3635e-04
Loss = 7.3017e-02, PNorm = 44.7734, GNorm = 1.1008, lr_0 = 2.3120e-04
Validation rmse = 0.106226
Validation r2 = 0.880089
Validation mse = 0.011284
Epoch 37
Loss = 5.9045e-02, PNorm = 44.7860, GNorm = 1.8836, lr_0 = 2.2566e-04
Loss = 7.6054e-02, PNorm = 44.7945, GNorm = 1.7975, lr_0 = 2.2073e-04
Validation rmse = 0.103040
Validation r2 = 0.887174
Validation mse = 0.010617
Epoch 38
Loss = 6.3403e-02, PNorm = 44.8010, GNorm = 0.6590, lr_0 = 2.1592e-04
Loss = 6.9599e-02, PNorm = 44.8105, GNorm = 1.3675, lr_0 = 2.1121e-04
Loss = 4.3301e-02, PNorm = 44.8114, GNorm = 0.8675, lr_0 = 2.1074e-04
Validation rmse = 0.100057
Validation r2 = 0.893612
Validation mse = 0.010011
Epoch 39
Loss = 5.9898e-02, PNorm = 44.8192, GNorm = 1.2515, lr_0 = 2.0615e-04
Validation rmse = 0.102715
Validation r2 = 0.887885
Validation mse = 0.010550
Epoch 40
Loss = 4.6461e-02, PNorm = 44.8252, GNorm = 0.9077, lr_0 = 2.0165e-04
Loss = 6.2809e-02, PNorm = 44.8334, GNorm = 1.6798, lr_0 = 1.9725e-04
Validation rmse = 0.105370
Validation r2 = 0.882015
Validation mse = 0.011103
Epoch 41
Loss = 6.5218e-02, PNorm = 44.8411, GNorm = 1.8363, lr_0 = 1.9252e-04
Loss = 6.0019e-02, PNorm = 44.8479, GNorm = 1.0195, lr_0 = 1.8832e-04
Validation rmse = 0.109180
Validation r2 = 0.873328
Validation mse = 0.011920
Epoch 42
Loss = 6.5035e-02, PNorm = 44.8547, GNorm = 0.6279, lr_0 = 1.8422e-04
Loss = 6.4912e-02, PNorm = 44.8624, GNorm = 0.5966, lr_0 = 1.8020e-04
Validation rmse = 0.102164
Validation r2 = 0.889084
Validation mse = 0.010438
Epoch 43
Loss = 5.3905e-02, PNorm = 44.8693, GNorm = 0.5449, lr_0 = 1.7588e-04
Loss = 5.5134e-02, PNorm = 44.8755, GNorm = 1.1625, lr_0 = 1.7204e-04
Validation rmse = 0.104816
Validation r2 = 0.883252
Validation mse = 0.010986
Epoch 44
Loss = 5.6227e-02, PNorm = 44.8816, GNorm = 2.0333, lr_0 = 1.6829e-04
Loss = 6.5884e-02, PNorm = 44.8874, GNorm = 1.9152, lr_0 = 1.6462e-04
Validation rmse = 0.100078
Validation r2 = 0.893568
Validation mse = 0.010016
Epoch 45
Loss = 5.7002e-02, PNorm = 44.8947, GNorm = 0.9303, lr_0 = 1.6067e-04
Loss = 6.2085e-02, PNorm = 44.9006, GNorm = 1.6700, lr_0 = 1.5717e-04
Validation rmse = 0.099609
Validation r2 = 0.894563
Validation mse = 0.009922
Epoch 46
Loss = 5.7997e-02, PNorm = 44.9080, GNorm = 0.8368, lr_0 = 1.5374e-04
Validation rmse = 0.102806
Validation r2 = 0.887686
Validation mse = 0.010569
Epoch 47
Loss = 2.9014e-02, PNorm = 44.9135, GNorm = 0.6176, lr_0 = 1.5005e-04
Loss = 6.0633e-02, PNorm = 44.9190, GNorm = 0.9467, lr_0 = 1.4678e-04
Validation rmse = 0.101098
Validation r2 = 0.891387
Validation mse = 0.010221
Epoch 48
Loss = 5.7077e-02, PNorm = 44.9253, GNorm = 0.6898, lr_0 = 1.4358e-04
Loss = 5.9605e-02, PNorm = 44.9306, GNorm = 0.7192, lr_0 = 1.4045e-04
Validation rmse = 0.099569
Validation r2 = 0.894647
Validation mse = 0.009914
Epoch 49
Loss = 4.8646e-02, PNorm = 44.9372, GNorm = 1.1453, lr_0 = 1.3708e-04
Loss = 5.8340e-02, PNorm = 44.9433, GNorm = 0.5511, lr_0 = 1.3409e-04
Validation rmse = 0.098376
Validation r2 = 0.897157
Validation mse = 0.009678
Epoch 50
Loss = 5.4183e-02, PNorm = 44.9478, GNorm = 0.5193, lr_0 = 1.3116e-04
Loss = 5.6590e-02, PNorm = 44.9526, GNorm = 2.1703, lr_0 = 1.2830e-04
Validation rmse = 0.101836
Validation r2 = 0.889795
Validation mse = 0.010371
Epoch 51
Loss = 6.1601e-02, PNorm = 44.9586, GNorm = 0.9298, lr_0 = 1.2523e-04
Loss = 5.1640e-02, PNorm = 44.9649, GNorm = 1.4031, lr_0 = 1.2250e-04
Loss = 2.3147e-02, PNorm = 44.9654, GNorm = 0.6319, lr_0 = 1.2223e-04
Validation rmse = 0.109079
Validation r2 = 0.873562
Validation mse = 0.011898
Epoch 52
Loss = 5.4247e-02, PNorm = 44.9705, GNorm = 1.4049, lr_0 = 1.1956e-04
Validation rmse = 0.101211
Validation r2 = 0.891145
Validation mse = 0.010244
Epoch 53
Loss = 4.7494e-02, PNorm = 44.9751, GNorm = 1.0995, lr_0 = 1.1695e-04
Loss = 5.0010e-02, PNorm = 44.9805, GNorm = 0.8019, lr_0 = 1.1440e-04
Validation rmse = 0.118685
Validation r2 = 0.850312
Validation mse = 0.014086
Epoch 54
Loss = 5.1780e-02, PNorm = 44.9842, GNorm = 0.5278, lr_0 = 1.1166e-04
Loss = 5.1361e-02, PNorm = 44.9895, GNorm = 1.9676, lr_0 = 1.0922e-04
Validation rmse = 0.103854
Validation r2 = 0.885385
Validation mse = 0.010786
Epoch 55
Loss = 5.4450e-02, PNorm = 44.9945, GNorm = 1.3319, lr_0 = 1.0684e-04
Loss = 5.4940e-02, PNorm = 44.9984, GNorm = 0.6480, lr_0 = 1.0451e-04
Validation rmse = 0.103488
Validation r2 = 0.886191
Validation mse = 0.010710
Epoch 56
Loss = 4.5753e-02, PNorm = 45.0027, GNorm = 0.8083, lr_0 = 1.0200e-04
Loss = 5.1782e-02, PNorm = 45.0068, GNorm = 0.9255, lr_0 = 1.0000e-04
Validation rmse = 0.103461
Validation r2 = 0.886251
Validation mse = 0.010704
Epoch 57
Loss = 5.3204e-02, PNorm = 45.0107, GNorm = 0.7798, lr_0 = 1.0000e-04
Loss = 5.1785e-02, PNorm = 45.0147, GNorm = 0.6036, lr_0 = 1.0000e-04
Validation rmse = 0.103449
Validation r2 = 0.886276
Validation mse = 0.010702
Epoch 58
Loss = 4.7784e-02, PNorm = 45.0199, GNorm = 1.3443, lr_0 = 1.0000e-04
Loss = 5.1530e-02, PNorm = 45.0235, GNorm = 1.4395, lr_0 = 1.0000e-04
Validation rmse = 0.104694
Validation r2 = 0.883523
Validation mse = 0.010961
Epoch 59
Loss = 4.7944e-02, PNorm = 45.0281, GNorm = 1.2414, lr_0 = 1.0000e-04
Validation rmse = 0.097895
Validation r2 = 0.898160
Validation mse = 0.009583
Model 0 best validation rmse = 0.083178 on epoch 8
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.183920
Model 0 test r2 = 0.374386
Model 0 test mse = 0.033826
Ensemble test rmse = 0.183920
Ensemble test r2 = 0.374386
Ensemble test mse = 0.033826
Fold 1
Splitting data with seed 1
Total size = 934 | train size = 924 | val size = 10 | test size = 98
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.4636e-01, PNorm = 43.2628, GNorm = 4.3304, lr_0 = 3.7500e-04
Validation rmse = 0.284139
Validation r2 = 0.245115
Validation mse = 0.080735
Epoch 1
Loss = 7.2898e-01, PNorm = 43.2866, GNorm = 7.7403, lr_0 = 6.5000e-04
Loss = 8.5642e-01, PNorm = 43.3256, GNorm = 2.9932, lr_0 = 9.0000e-04
Validation rmse = 0.265302
Validation r2 = 0.341889
Validation mse = 0.070385
Epoch 2
Loss = 5.6717e-01, PNorm = 43.4085, GNorm = 6.1099, lr_0 = 9.8468e-04
Loss = 4.7331e-01, PNorm = 43.4953, GNorm = 4.6100, lr_0 = 9.6320e-04
Validation rmse = 0.239256
Validation r2 = 0.464768
Validation mse = 0.057243
Epoch 3
Loss = 2.9867e-01, PNorm = 43.5727, GNorm = 2.7281, lr_0 = 9.4219e-04
Loss = 3.7896e-01, PNorm = 43.6427, GNorm = 6.1894, lr_0 = 9.2164e-04
Validation rmse = 0.206365
Validation r2 = 0.601808
Validation mse = 0.042587
Epoch 4
Loss = 3.1217e-01, PNorm = 43.7111, GNorm = 2.6850, lr_0 = 8.9955e-04
Loss = 2.6072e-01, PNorm = 43.7643, GNorm = 4.1748, lr_0 = 8.7992e-04
Validation rmse = 0.158523
Validation r2 = 0.765037
Validation mse = 0.025129
Epoch 5
Loss = 2.4554e-01, PNorm = 43.8112, GNorm = 3.1227, lr_0 = 8.6073e-04
Loss = 2.2589e-01, PNorm = 43.8530, GNorm = 2.3510, lr_0 = 8.4195e-04
Loss = 1.3396e-01, PNorm = 43.8561, GNorm = 2.0782, lr_0 = 8.4010e-04
Validation rmse = 0.164558
Validation r2 = 0.746805
Validation mse = 0.027079
Epoch 6
Loss = 2.0237e-01, PNorm = 43.8970, GNorm = 1.4309, lr_0 = 8.2177e-04
Validation rmse = 0.146908
Validation r2 = 0.798206
Validation mse = 0.021582
Epoch 7
Loss = 1.7722e-01, PNorm = 43.9345, GNorm = 2.0034, lr_0 = 8.0385e-04
Loss = 1.6732e-01, PNorm = 43.9708, GNorm = 3.0670, lr_0 = 7.8631e-04
Validation rmse = 0.135646
Validation r2 = 0.827958
Validation mse = 0.018400
Epoch 8
Loss = 1.2487e-01, PNorm = 43.9993, GNorm = 2.6100, lr_0 = 7.6746e-04
Loss = 1.4649e-01, PNorm = 44.0227, GNorm = 0.5875, lr_0 = 7.5072e-04
Validation rmse = 0.145274
Validation r2 = 0.802670
Validation mse = 0.021104
Epoch 9
Loss = 1.1917e-01, PNorm = 44.0524, GNorm = 1.9326, lr_0 = 7.3435e-04
Loss = 1.3542e-01, PNorm = 44.0774, GNorm = 1.6361, lr_0 = 7.1833e-04
Validation rmse = 0.130232
Validation r2 = 0.841419
Validation mse = 0.016960
Epoch 10
Loss = 1.4482e-01, PNorm = 44.0983, GNorm = 2.7729, lr_0 = 7.0111e-04
Loss = 1.1942e-01, PNorm = 44.1198, GNorm = 1.4017, lr_0 = 6.8581e-04
Validation rmse = 0.139009
Validation r2 = 0.819323
Validation mse = 0.019323
Epoch 11
Loss = 1.1869e-01, PNorm = 44.1476, GNorm = 1.0992, lr_0 = 6.7085e-04
Loss = 1.4233e-01, PNorm = 44.1723, GNorm = 1.8544, lr_0 = 6.5622e-04
Validation rmse = 0.130249
Validation r2 = 0.841378
Validation mse = 0.016965
Epoch 12
Loss = 1.4578e-01, PNorm = 44.1961, GNorm = 2.1237, lr_0 = 6.4049e-04
Loss = 1.3449e-01, PNorm = 44.2190, GNorm = 1.3585, lr_0 = 6.2652e-04
Validation rmse = 0.134500
Validation r2 = 0.830854
Validation mse = 0.018090
Epoch 13
Loss = 1.3210e-01, PNorm = 44.2442, GNorm = 5.7178, lr_0 = 6.1285e-04
Validation rmse = 0.126359
Validation r2 = 0.850711
Validation mse = 0.015967
Epoch 14
Loss = 1.1179e-01, PNorm = 44.2677, GNorm = 1.7106, lr_0 = 5.9816e-04
Loss = 1.1670e-01, PNorm = 44.2902, GNorm = 4.0454, lr_0 = 5.8512e-04
Validation rmse = 0.146342
Validation r2 = 0.799759
Validation mse = 0.021416
Epoch 15
Loss = 1.6556e-01, PNorm = 44.3063, GNorm = 2.5731, lr_0 = 5.7235e-04
Loss = 1.0817e-01, PNorm = 44.3243, GNorm = 0.8498, lr_0 = 5.5987e-04
Validation rmse = 0.122620
Validation r2 = 0.859416
Validation mse = 0.015036
Epoch 16
Loss = 8.3446e-02, PNorm = 44.3431, GNorm = 1.8809, lr_0 = 5.4645e-04
Loss = 1.0421e-01, PNorm = 44.3610, GNorm = 1.0135, lr_0 = 5.3453e-04
Validation rmse = 0.125532
Validation r2 = 0.852659
Validation mse = 0.015758
Epoch 17
Loss = 8.1463e-02, PNorm = 44.3717, GNorm = 0.6946, lr_0 = 5.2287e-04
Loss = 1.1601e-01, PNorm = 44.3879, GNorm = 2.8045, lr_0 = 5.1146e-04
Validation rmse = 0.143982
Validation r2 = 0.806165
Validation mse = 0.020731
Epoch 18
Loss = 1.1122e-01, PNorm = 44.4038, GNorm = 0.8592, lr_0 = 4.9920e-04
Loss = 1.0347e-01, PNorm = 44.4205, GNorm = 0.8641, lr_0 = 4.8831e-04
Validation rmse = 0.121945
Validation r2 = 0.860958
Validation mse = 0.014871
Epoch 19
Loss = 9.0991e-02, PNorm = 44.4331, GNorm = 1.6313, lr_0 = 4.7766e-04
Validation rmse = 0.125804
Validation r2 = 0.852018
Validation mse = 0.015827
Epoch 20
Loss = 1.2303e-01, PNorm = 44.4500, GNorm = 2.8581, lr_0 = 4.6621e-04
Loss = 1.0951e-01, PNorm = 44.4687, GNorm = 1.7918, lr_0 = 4.5604e-04
Validation rmse = 0.110912
Validation r2 = 0.884979
Validation mse = 0.012302
Epoch 21
Loss = 1.0080e-01, PNorm = 44.4832, GNorm = 0.9126, lr_0 = 4.4609e-04
Loss = 9.9932e-02, PNorm = 44.4978, GNorm = 1.7506, lr_0 = 4.3636e-04
Validation rmse = 0.135288
Validation r2 = 0.828867
Validation mse = 0.018303
Epoch 22
Loss = 1.2162e-01, PNorm = 44.5131, GNorm = 2.5835, lr_0 = 4.2590e-04
Loss = 1.1075e-01, PNorm = 44.5295, GNorm = 2.3327, lr_0 = 4.1661e-04
Validation rmse = 0.146732
Validation r2 = 0.798689
Validation mse = 0.021530
Epoch 23
Loss = 9.3094e-02, PNorm = 44.5451, GNorm = 2.1964, lr_0 = 4.0752e-04
Loss = 1.0166e-01, PNorm = 44.5592, GNorm = 1.1803, lr_0 = 3.9863e-04
Validation rmse = 0.125362
Validation r2 = 0.853057
Validation mse = 0.015716
Epoch 24
Loss = 8.4628e-02, PNorm = 44.5701, GNorm = 0.6150, lr_0 = 3.8908e-04
Loss = 8.0031e-02, PNorm = 44.5791, GNorm = 0.6833, lr_0 = 3.8059e-04
Validation rmse = 0.114975
Validation r2 = 0.876399
Validation mse = 0.013219
Epoch 25
Loss = 7.8345e-02, PNorm = 44.5890, GNorm = 0.4425, lr_0 = 3.7229e-04
Loss = 8.2703e-02, PNorm = 44.5993, GNorm = 0.5557, lr_0 = 3.6417e-04
Loss = 1.0694e-01, PNorm = 44.6004, GNorm = 2.0687, lr_0 = 3.6337e-04
Validation rmse = 0.121577
Validation r2 = 0.861796
Validation mse = 0.014781
Epoch 26
Loss = 8.2519e-02, PNorm = 44.6121, GNorm = 0.8025, lr_0 = 3.5544e-04
Validation rmse = 0.114434
Validation r2 = 0.877558
Validation mse = 0.013095
Epoch 27
Loss = 7.8026e-02, PNorm = 44.6207, GNorm = 0.7031, lr_0 = 3.4692e-04
Loss = 8.3317e-02, PNorm = 44.6313, GNorm = 1.1985, lr_0 = 3.3935e-04
Validation rmse = 0.103958
Validation r2 = 0.898951
Validation mse = 0.010807
Epoch 28
Loss = 7.2036e-02, PNorm = 44.6403, GNorm = 2.2186, lr_0 = 3.3195e-04
Loss = 7.3621e-02, PNorm = 44.6499, GNorm = 1.0817, lr_0 = 3.2471e-04
Validation rmse = 0.121394
Validation r2 = 0.862212
Validation mse = 0.014736
Epoch 29
Loss = 7.4597e-02, PNorm = 44.6608, GNorm = 2.0889, lr_0 = 3.1693e-04
Loss = 8.3703e-02, PNorm = 44.6711, GNorm = 1.2973, lr_0 = 3.1001e-04
Validation rmse = 0.118457
Validation r2 = 0.868798
Validation mse = 0.014032
Epoch 30
Loss = 7.5936e-02, PNorm = 44.6821, GNorm = 1.1158, lr_0 = 3.0325e-04
Loss = 7.7631e-02, PNorm = 44.6910, GNorm = 1.1958, lr_0 = 2.9663e-04
Validation rmse = 0.107720
Validation r2 = 0.891504
Validation mse = 0.011604
Epoch 31
Loss = 7.8544e-02, PNorm = 44.7013, GNorm = 1.4127, lr_0 = 2.8952e-04
Loss = 7.2506e-02, PNorm = 44.7097, GNorm = 0.7387, lr_0 = 2.8321e-04
Validation rmse = 0.110730
Validation r2 = 0.885357
Validation mse = 0.012261
Epoch 32
Loss = 6.9011e-02, PNorm = 44.7199, GNorm = 1.1878, lr_0 = 2.7703e-04
Validation rmse = 0.101901
Validation r2 = 0.902911
Validation mse = 0.010384
Epoch 33
Loss = 4.7888e-02, PNorm = 44.7273, GNorm = 0.7077, lr_0 = 2.7039e-04
Loss = 6.8098e-02, PNorm = 44.7356, GNorm = 0.4979, lr_0 = 2.6449e-04
Validation rmse = 0.107146
Validation r2 = 0.892658
Validation mse = 0.011480
Epoch 34
Loss = 6.0646e-02, PNorm = 44.7442, GNorm = 0.8281, lr_0 = 2.5872e-04
Loss = 6.8291e-02, PNorm = 44.7529, GNorm = 0.4496, lr_0 = 2.5308e-04
Validation rmse = 0.102457
Validation r2 = 0.901847
Validation mse = 0.010498
Epoch 35
Loss = 7.3484e-02, PNorm = 44.7632, GNorm = 1.0114, lr_0 = 2.4701e-04
Loss = 6.7699e-02, PNorm = 44.7721, GNorm = 1.1524, lr_0 = 2.4162e-04
Validation rmse = 0.102574
Validation r2 = 0.901624
Validation mse = 0.010521
Epoch 36
Loss = 7.0159e-02, PNorm = 44.7802, GNorm = 1.0378, lr_0 = 2.3635e-04
Loss = 6.0477e-02, PNorm = 44.7871, GNorm = 0.4255, lr_0 = 2.3120e-04
Validation rmse = 0.103339
Validation r2 = 0.900150
Validation mse = 0.010679
Epoch 37
Loss = 6.1054e-02, PNorm = 44.7956, GNorm = 0.8168, lr_0 = 2.2566e-04
Loss = 7.9620e-02, PNorm = 44.8040, GNorm = 1.6836, lr_0 = 2.2073e-04
Validation rmse = 0.103955
Validation r2 = 0.898956
Validation mse = 0.010807
Epoch 38
Loss = 7.0060e-02, PNorm = 44.8127, GNorm = 1.0251, lr_0 = 2.1592e-04
Loss = 6.8592e-02, PNorm = 44.8206, GNorm = 1.7001, lr_0 = 2.1121e-04
Loss = 1.0089e-01, PNorm = 44.8214, GNorm = 5.0198, lr_0 = 2.1074e-04
Validation rmse = 0.106668
Validation r2 = 0.893614
Validation mse = 0.011378
Epoch 39
Loss = 6.6898e-02, PNorm = 44.8307, GNorm = 1.5925, lr_0 = 2.0615e-04
Validation rmse = 0.105461
Validation r2 = 0.896008
Validation mse = 0.011122
Epoch 40
Loss = 6.1543e-02, PNorm = 44.8378, GNorm = 0.7264, lr_0 = 2.0165e-04
Loss = 5.6527e-02, PNorm = 44.8452, GNorm = 0.8433, lr_0 = 1.9725e-04
Validation rmse = 0.095977
Validation r2 = 0.913871
Validation mse = 0.009212
Epoch 41
Loss = 6.0338e-02, PNorm = 44.8529, GNorm = 1.2534, lr_0 = 1.9252e-04
Loss = 6.4459e-02, PNorm = 44.8593, GNorm = 1.2835, lr_0 = 1.8832e-04
Validation rmse = 0.108586
Validation r2 = 0.889753
Validation mse = 0.011791
Epoch 42
Loss = 8.7936e-02, PNorm = 44.8672, GNorm = 0.9360, lr_0 = 1.8422e-04
Loss = 6.8785e-02, PNorm = 44.8743, GNorm = 1.0090, lr_0 = 1.8020e-04
Validation rmse = 0.097358
Validation r2 = 0.911374
Validation mse = 0.009479
Epoch 43
Loss = 5.9681e-02, PNorm = 44.8818, GNorm = 1.2105, lr_0 = 1.7588e-04
Loss = 6.4419e-02, PNorm = 44.8885, GNorm = 1.2904, lr_0 = 1.7204e-04
Validation rmse = 0.093650
Validation r2 = 0.917997
Validation mse = 0.008770
Epoch 44
Loss = 6.4629e-02, PNorm = 44.8939, GNorm = 1.7162, lr_0 = 1.6829e-04
Loss = 6.6344e-02, PNorm = 44.9007, GNorm = 1.6198, lr_0 = 1.6462e-04
Validation rmse = 0.094099
Validation r2 = 0.917208
Validation mse = 0.008855
Epoch 45
Loss = 6.3802e-02, PNorm = 44.9083, GNorm = 1.8539, lr_0 = 1.6067e-04
Loss = 5.7464e-02, PNorm = 44.9135, GNorm = 1.7008, lr_0 = 1.5717e-04
Validation rmse = 0.096345
Validation r2 = 0.913208
Validation mse = 0.009282
Epoch 46
Loss = 5.7673e-02, PNorm = 44.9186, GNorm = 1.0998, lr_0 = 1.5374e-04
Validation rmse = 0.102711
Validation r2 = 0.901361
Validation mse = 0.010549
Epoch 47
Loss = 6.6886e-02, PNorm = 44.9248, GNorm = 0.7188, lr_0 = 1.5005e-04
Loss = 5.1404e-02, PNorm = 44.9299, GNorm = 1.0227, lr_0 = 1.4678e-04
Validation rmse = 0.094175
Validation r2 = 0.917075
Validation mse = 0.008869
Epoch 48
Loss = 3.7777e-02, PNorm = 44.9353, GNorm = 0.3456, lr_0 = 1.4358e-04
Loss = 6.3289e-02, PNorm = 44.9416, GNorm = 0.8154, lr_0 = 1.4045e-04
Validation rmse = 0.094902
Validation r2 = 0.915789
Validation mse = 0.009006
Epoch 49
Loss = 5.5628e-02, PNorm = 44.9457, GNorm = 0.7008, lr_0 = 1.3708e-04
Loss = 5.3544e-02, PNorm = 44.9503, GNorm = 1.3340, lr_0 = 1.3409e-04
Validation rmse = 0.102695
Validation r2 = 0.901391
Validation mse = 0.010546
Epoch 50
Loss = 6.4055e-02, PNorm = 44.9558, GNorm = 0.8570, lr_0 = 1.3116e-04
Loss = 5.3082e-02, PNorm = 44.9611, GNorm = 0.8058, lr_0 = 1.2830e-04
Validation rmse = 0.099512
Validation r2 = 0.907409
Validation mse = 0.009903
Epoch 51
Loss = 5.2666e-02, PNorm = 44.9661, GNorm = 0.9438, lr_0 = 1.2523e-04
Loss = 5.7962e-02, PNorm = 44.9712, GNorm = 0.6361, lr_0 = 1.2250e-04
Loss = 5.9589e-02, PNorm = 44.9717, GNorm = 1.0136, lr_0 = 1.2223e-04
Validation rmse = 0.094518
Validation r2 = 0.916470
Validation mse = 0.008934
Epoch 52
Loss = 5.6853e-02, PNorm = 44.9768, GNorm = 0.8634, lr_0 = 1.1956e-04
Validation rmse = 0.094556
Validation r2 = 0.916401
Validation mse = 0.008941
Epoch 53
Loss = 5.0086e-02, PNorm = 44.9808, GNorm = 0.9625, lr_0 = 1.1695e-04
Loss = 5.3293e-02, PNorm = 44.9852, GNorm = 1.0559, lr_0 = 1.1440e-04
Validation rmse = 0.095372
Validation r2 = 0.914952
Validation mse = 0.009096
Epoch 54
Loss = 5.2685e-02, PNorm = 44.9898, GNorm = 0.5598, lr_0 = 1.1166e-04
Loss = 4.7321e-02, PNorm = 44.9939, GNorm = 0.7550, lr_0 = 1.0922e-04
Validation rmse = 0.095110
Validation r2 = 0.915419
Validation mse = 0.009046
Epoch 55
Loss = 5.7907e-02, PNorm = 44.9977, GNorm = 1.0668, lr_0 = 1.0684e-04
Loss = 5.2360e-02, PNorm = 45.0018, GNorm = 0.9717, lr_0 = 1.0451e-04
Validation rmse = 0.090632
Validation r2 = 0.923196
Validation mse = 0.008214
Epoch 56
Loss = 4.5691e-02, PNorm = 45.0065, GNorm = 0.9672, lr_0 = 1.0200e-04
Loss = 5.3457e-02, PNorm = 45.0101, GNorm = 1.5371, lr_0 = 1.0000e-04
Validation rmse = 0.089742
Validation r2 = 0.924697
Validation mse = 0.008054
Epoch 57
Loss = 4.6998e-02, PNorm = 45.0141, GNorm = 0.6008, lr_0 = 1.0000e-04
Loss = 5.1111e-02, PNorm = 45.0182, GNorm = 0.9259, lr_0 = 1.0000e-04
Validation rmse = 0.094614
Validation r2 = 0.916299
Validation mse = 0.008952
Epoch 58
Loss = 5.0659e-02, PNorm = 45.0225, GNorm = 1.0536, lr_0 = 1.0000e-04
Loss = 4.8041e-02, PNorm = 45.0266, GNorm = 0.5600, lr_0 = 1.0000e-04
Validation rmse = 0.095574
Validation r2 = 0.914592
Validation mse = 0.009134
Epoch 59
Loss = 4.7375e-02, PNorm = 45.0304, GNorm = 1.4765, lr_0 = 1.0000e-04
Validation rmse = 0.093167
Validation r2 = 0.918840
Validation mse = 0.008680
Model 0 best validation rmse = 0.089742 on epoch 56
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.198152
Model 0 test r2 = 0.273815
Model 0 test mse = 0.039264
Ensemble test rmse = 0.198152
Ensemble test r2 = 0.273815
Ensemble test mse = 0.039264
Fold 2
Splitting data with seed 2
Total size = 934 | train size = 924 | val size = 10 | test size = 98
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.4726e-01, PNorm = 43.2645, GNorm = 4.7639, lr_0 = 3.7500e-04
Validation rmse = 0.350888
Validation r2 = -0.798897
Validation mse = 0.123122
Epoch 1
Loss = 7.6422e-01, PNorm = 43.2966, GNorm = 1.1144, lr_0 = 6.5000e-04
Loss = 5.6609e-01, PNorm = 43.3377, GNorm = 2.3655, lr_0 = 9.0000e-04
Validation rmse = 0.300252
Validation r2 = -0.317168
Validation mse = 0.090151
Epoch 2
Loss = 3.6032e-01, PNorm = 43.4241, GNorm = 1.0398, lr_0 = 9.8468e-04
Loss = 4.3461e-01, PNorm = 43.5049, GNorm = 4.4057, lr_0 = 9.6320e-04
Validation rmse = 0.192217
Validation r2 = 0.460174
Validation mse = 0.036947
Epoch 3
Loss = 3.1569e-01, PNorm = 43.5744, GNorm = 3.1120, lr_0 = 9.4219e-04
Loss = 3.1174e-01, PNorm = 43.6391, GNorm = 4.4043, lr_0 = 9.2164e-04
Validation rmse = 0.183293
Validation r2 = 0.509135
Validation mse = 0.033596
Epoch 4
Loss = 1.9263e-01, PNorm = 43.6907, GNorm = 2.7198, lr_0 = 8.9955e-04
Loss = 2.2816e-01, PNorm = 43.7344, GNorm = 1.6912, lr_0 = 8.7992e-04
Validation rmse = 0.186155
Validation r2 = 0.493688
Validation mse = 0.034654
Epoch 5
Loss = 1.7891e-01, PNorm = 43.7796, GNorm = 1.0525, lr_0 = 8.6073e-04
Loss = 1.6413e-01, PNorm = 43.8142, GNorm = 1.5413, lr_0 = 8.4195e-04
Loss = 1.1417e-01, PNorm = 43.8169, GNorm = 1.6166, lr_0 = 8.4010e-04
Validation rmse = 0.172155
Validation r2 = 0.566978
Validation mse = 0.029637
Epoch 6
Loss = 1.7425e-01, PNorm = 43.8467, GNorm = 4.5945, lr_0 = 8.2177e-04
Validation rmse = 0.172205
Validation r2 = 0.566727
Validation mse = 0.029655
Epoch 7
Loss = 1.8696e-01, PNorm = 43.8845, GNorm = 6.0666, lr_0 = 8.0385e-04
Loss = 1.5625e-01, PNorm = 43.9142, GNorm = 2.4392, lr_0 = 7.8631e-04
Validation rmse = 0.171175
Validation r2 = 0.571893
Validation mse = 0.029301
Epoch 8
Loss = 1.3390e-01, PNorm = 43.9441, GNorm = 2.5507, lr_0 = 7.6746e-04
Loss = 1.3666e-01, PNorm = 43.9630, GNorm = 1.5510, lr_0 = 7.5072e-04
Validation rmse = 0.213447
Validation r2 = 0.334345
Validation mse = 0.045559
Epoch 9
Loss = 1.4094e-01, PNorm = 43.9820, GNorm = 4.9327, lr_0 = 7.3435e-04
Loss = 1.4468e-01, PNorm = 44.0086, GNorm = 1.7017, lr_0 = 7.1833e-04
Validation rmse = 0.194342
Validation r2 = 0.448175
Validation mse = 0.037769
Epoch 10
Loss = 1.2708e-01, PNorm = 44.0376, GNorm = 2.5693, lr_0 = 7.0111e-04
Loss = 1.1830e-01, PNorm = 44.0540, GNorm = 2.4858, lr_0 = 6.8581e-04
Validation rmse = 0.181213
Validation r2 = 0.520211
Validation mse = 0.032838
Epoch 11
Loss = 1.4319e-01, PNorm = 44.0738, GNorm = 3.0173, lr_0 = 6.7085e-04
Loss = 1.3575e-01, PNorm = 44.0964, GNorm = 1.1722, lr_0 = 6.5622e-04
Validation rmse = 0.178675
Validation r2 = 0.533559
Validation mse = 0.031925
Epoch 12
Loss = 1.0391e-01, PNorm = 44.1224, GNorm = 2.4998, lr_0 = 6.4049e-04
Loss = 1.1882e-01, PNorm = 44.1389, GNorm = 1.9235, lr_0 = 6.2652e-04
Validation rmse = 0.178991
Validation r2 = 0.531904
Validation mse = 0.032038
Epoch 13
Loss = 1.1166e-01, PNorm = 44.1590, GNorm = 0.8318, lr_0 = 6.1285e-04
Validation rmse = 0.159231
Validation r2 = 0.629554
Validation mse = 0.025354
Epoch 14
Loss = 1.2963e-01, PNorm = 44.1794, GNorm = 3.1228, lr_0 = 5.9816e-04
Loss = 1.0180e-01, PNorm = 44.1950, GNorm = 1.9248, lr_0 = 5.8512e-04
Validation rmse = 0.179014
Validation r2 = 0.531786
Validation mse = 0.032046
Epoch 15
Loss = 8.9832e-02, PNorm = 44.2134, GNorm = 1.8627, lr_0 = 5.7235e-04
Loss = 1.3630e-01, PNorm = 44.2294, GNorm = 6.4021, lr_0 = 5.5987e-04
Validation rmse = 0.167181
Validation r2 = 0.591639
Validation mse = 0.027949
Epoch 16
Loss = 1.2764e-01, PNorm = 44.2534, GNorm = 5.2919, lr_0 = 5.4645e-04
Loss = 1.2135e-01, PNorm = 44.2730, GNorm = 0.7374, lr_0 = 5.3453e-04
Validation rmse = 0.178127
Validation r2 = 0.536415
Validation mse = 0.031729
Epoch 17
Loss = 1.0218e-01, PNorm = 44.2938, GNorm = 0.6586, lr_0 = 5.2287e-04
Loss = 8.9249e-02, PNorm = 44.3092, GNorm = 1.2178, lr_0 = 5.1146e-04
Validation rmse = 0.178859
Validation r2 = 0.532595
Validation mse = 0.031991
Epoch 18
Loss = 9.1668e-02, PNorm = 44.3243, GNorm = 0.7288, lr_0 = 4.9920e-04
Loss = 9.4049e-02, PNorm = 44.3399, GNorm = 1.7726, lr_0 = 4.8831e-04
Validation rmse = 0.168609
Validation r2 = 0.584632
Validation mse = 0.028429
Epoch 19
Loss = 8.5403e-02, PNorm = 44.3537, GNorm = 0.7636, lr_0 = 4.7766e-04
Validation rmse = 0.156516
Validation r2 = 0.642077
Validation mse = 0.024497
Epoch 20
Loss = 6.0351e-02, PNorm = 44.3654, GNorm = 0.5638, lr_0 = 4.6621e-04
Loss = 1.0875e-01, PNorm = 44.3778, GNorm = 3.4425, lr_0 = 4.5604e-04
Validation rmse = 0.175969
Validation r2 = 0.547581
Validation mse = 0.030965
Epoch 21
Loss = 1.1414e-01, PNorm = 44.3952, GNorm = 0.8893, lr_0 = 4.4609e-04
Loss = 8.9297e-02, PNorm = 44.4113, GNorm = 2.5599, lr_0 = 4.3636e-04
Validation rmse = 0.167861
Validation r2 = 0.588312
Validation mse = 0.028177
Epoch 22
Loss = 1.0285e-01, PNorm = 44.4257, GNorm = 1.5081, lr_0 = 4.2590e-04
Loss = 8.6305e-02, PNorm = 44.4391, GNorm = 1.3793, lr_0 = 4.1661e-04
Validation rmse = 0.155793
Validation r2 = 0.645378
Validation mse = 0.024271
Epoch 23
Loss = 9.6564e-02, PNorm = 44.4493, GNorm = 0.7941, lr_0 = 4.0752e-04
Loss = 8.1369e-02, PNorm = 44.4592, GNorm = 2.7444, lr_0 = 3.9863e-04
Validation rmse = 0.175865
Validation r2 = 0.548112
Validation mse = 0.030929
Epoch 24
Loss = 8.7784e-02, PNorm = 44.4706, GNorm = 1.7908, lr_0 = 3.8908e-04
Loss = 9.1629e-02, PNorm = 44.4823, GNorm = 0.7599, lr_0 = 3.8059e-04
Validation rmse = 0.168020
Validation r2 = 0.587532
Validation mse = 0.028231
Epoch 25
Loss = 6.7455e-02, PNorm = 44.4941, GNorm = 1.0047, lr_0 = 3.7229e-04
Loss = 9.2802e-02, PNorm = 44.5049, GNorm = 1.1373, lr_0 = 3.6417e-04
Loss = 6.8075e-02, PNorm = 44.5060, GNorm = 1.1129, lr_0 = 3.6337e-04
Validation rmse = 0.174109
Validation r2 = 0.557091
Validation mse = 0.030314
Epoch 26
Loss = 7.4514e-02, PNorm = 44.5169, GNorm = 0.5840, lr_0 = 3.5544e-04
Validation rmse = 0.165697
Validation r2 = 0.598857
Validation mse = 0.027455
Epoch 27
Loss = 8.9533e-02, PNorm = 44.5275, GNorm = 0.7636, lr_0 = 3.4692e-04
Loss = 7.3416e-02, PNorm = 44.5384, GNorm = 3.0928, lr_0 = 3.3935e-04
Validation rmse = 0.162778
Validation r2 = 0.612863
Validation mse = 0.026497
Epoch 28
Loss = 6.8258e-02, PNorm = 44.5477, GNorm = 1.0384, lr_0 = 3.3195e-04
Loss = 8.4882e-02, PNorm = 44.5572, GNorm = 1.8965, lr_0 = 3.2471e-04
Validation rmse = 0.173898
Validation r2 = 0.558165
Validation mse = 0.030241
Epoch 29
Loss = 7.9827e-02, PNorm = 44.5689, GNorm = 1.0179, lr_0 = 3.1693e-04
Loss = 7.0202e-02, PNorm = 44.5782, GNorm = 0.7825, lr_0 = 3.1001e-04
Validation rmse = 0.173180
Validation r2 = 0.561808
Validation mse = 0.029991
Epoch 30
Loss = 8.6955e-02, PNorm = 44.5885, GNorm = 1.1578, lr_0 = 3.0325e-04
Loss = 6.6102e-02, PNorm = 44.5994, GNorm = 0.7155, lr_0 = 2.9663e-04
Validation rmse = 0.185476
Validation r2 = 0.497372
Validation mse = 0.034401
Epoch 31
Loss = 6.3356e-02, PNorm = 44.6088, GNorm = 0.6082, lr_0 = 2.8952e-04
Loss = 7.2222e-02, PNorm = 44.6167, GNorm = 1.8519, lr_0 = 2.8321e-04
Validation rmse = 0.165827
Validation r2 = 0.598228
Validation mse = 0.027499
Epoch 32
Loss = 6.7419e-02, PNorm = 44.6255, GNorm = 1.5931, lr_0 = 2.7703e-04
Validation rmse = 0.165966
Validation r2 = 0.597554
Validation mse = 0.027545
Epoch 33
Loss = 5.1550e-02, PNorm = 44.6346, GNorm = 1.2137, lr_0 = 2.7039e-04
Loss = 6.9348e-02, PNorm = 44.6436, GNorm = 0.8238, lr_0 = 2.6449e-04
Validation rmse = 0.172909
Validation r2 = 0.563179
Validation mse = 0.029897
Epoch 34
Loss = 7.9452e-02, PNorm = 44.6506, GNorm = 3.3495, lr_0 = 2.5872e-04
Loss = 6.4611e-02, PNorm = 44.6582, GNorm = 1.6228, lr_0 = 2.5308e-04
Validation rmse = 0.173476
Validation r2 = 0.560307
Validation mse = 0.030094
Epoch 35
Loss = 5.6934e-02, PNorm = 44.6697, GNorm = 1.9094, lr_0 = 2.4701e-04
Loss = 6.7998e-02, PNorm = 44.6759, GNorm = 1.0427, lr_0 = 2.4162e-04
Validation rmse = 0.170596
Validation r2 = 0.574787
Validation mse = 0.029103
Epoch 36
Loss = 6.9424e-02, PNorm = 44.6825, GNorm = 0.9581, lr_0 = 2.3635e-04
Loss = 6.4849e-02, PNorm = 44.6899, GNorm = 2.0390, lr_0 = 2.3120e-04
Validation rmse = 0.163399
Validation r2 = 0.609904
Validation mse = 0.026699
Epoch 37
Loss = 6.3477e-02, PNorm = 44.6970, GNorm = 1.4646, lr_0 = 2.2566e-04
Loss = 6.1809e-02, PNorm = 44.7050, GNorm = 1.5192, lr_0 = 2.2073e-04
Validation rmse = 0.164145
Validation r2 = 0.606337
Validation mse = 0.026943
Epoch 38
Loss = 5.9841e-02, PNorm = 44.7114, GNorm = 1.6272, lr_0 = 2.1592e-04
Loss = 6.4342e-02, PNorm = 44.7185, GNorm = 1.0754, lr_0 = 2.1121e-04
Loss = 4.9641e-02, PNorm = 44.7191, GNorm = 1.9659, lr_0 = 2.1074e-04
Validation rmse = 0.170354
Validation r2 = 0.575991
Validation mse = 0.029020
Epoch 39
Loss = 6.0030e-02, PNorm = 44.7261, GNorm = 0.8470, lr_0 = 2.0615e-04
Validation rmse = 0.158159
Validation r2 = 0.634525
Validation mse = 0.025014
Epoch 40
Loss = 6.8374e-02, PNorm = 44.7323, GNorm = 0.7493, lr_0 = 2.0165e-04
Loss = 6.0574e-02, PNorm = 44.7377, GNorm = 1.1242, lr_0 = 1.9725e-04
Validation rmse = 0.157456
Validation r2 = 0.637764
Validation mse = 0.024793
Epoch 41
Loss = 6.9996e-02, PNorm = 44.7430, GNorm = 3.3897, lr_0 = 1.9252e-04
Loss = 6.3203e-02, PNorm = 44.7489, GNorm = 0.6323, lr_0 = 1.8832e-04
Validation rmse = 0.167467
Validation r2 = 0.590239
Validation mse = 0.028045
Epoch 42
Loss = 5.3336e-02, PNorm = 44.7544, GNorm = 0.8153, lr_0 = 1.8422e-04
Loss = 5.8704e-02, PNorm = 44.7609, GNorm = 0.9951, lr_0 = 1.8020e-04
Validation rmse = 0.171747
Validation r2 = 0.569028
Validation mse = 0.029497
Epoch 43
Loss = 7.0523e-02, PNorm = 44.7678, GNorm = 2.8574, lr_0 = 1.7588e-04
Loss = 5.7512e-02, PNorm = 44.7732, GNorm = 1.6664, lr_0 = 1.7204e-04
Validation rmse = 0.168541
Validation r2 = 0.584970
Validation mse = 0.028406
Epoch 44
Loss = 5.2250e-02, PNorm = 44.7778, GNorm = 2.4314, lr_0 = 1.6829e-04
Loss = 5.7367e-02, PNorm = 44.7832, GNorm = 0.9998, lr_0 = 1.6462e-04
Validation rmse = 0.170813
Validation r2 = 0.573702
Validation mse = 0.029177
Epoch 45
Loss = 5.0568e-02, PNorm = 44.7888, GNorm = 1.3807, lr_0 = 1.6067e-04
Loss = 5.7774e-02, PNorm = 44.7949, GNorm = 0.7956, lr_0 = 1.5717e-04
Validation rmse = 0.173278
Validation r2 = 0.561311
Validation mse = 0.030025
Epoch 46
Loss = 5.2692e-02, PNorm = 44.8003, GNorm = 0.7929, lr_0 = 1.5374e-04
Validation rmse = 0.166948
Validation r2 = 0.592776
Validation mse = 0.027872
Epoch 47
Loss = 7.1810e-02, PNorm = 44.8060, GNorm = 1.5157, lr_0 = 1.5005e-04
Loss = 5.2003e-02, PNorm = 44.8109, GNorm = 0.8621, lr_0 = 1.4678e-04
Validation rmse = 0.164717
Validation r2 = 0.603587
Validation mse = 0.027132
Epoch 48
Loss = 6.2356e-02, PNorm = 44.8157, GNorm = 0.8847, lr_0 = 1.4358e-04
Loss = 5.0369e-02, PNorm = 44.8206, GNorm = 2.1437, lr_0 = 1.4045e-04
Validation rmse = 0.163214
Validation r2 = 0.610787
Validation mse = 0.026639
Epoch 49
Loss = 5.9971e-02, PNorm = 44.8268, GNorm = 1.3530, lr_0 = 1.3708e-04
Loss = 5.0301e-02, PNorm = 44.8320, GNorm = 0.7746, lr_0 = 1.3409e-04
Validation rmse = 0.163232
Validation r2 = 0.610704
Validation mse = 0.026645
Epoch 50
Loss = 5.7674e-02, PNorm = 44.8359, GNorm = 1.4835, lr_0 = 1.3116e-04
Loss = 5.2761e-02, PNorm = 44.8411, GNorm = 0.9366, lr_0 = 1.2830e-04
Validation rmse = 0.160603
Validation r2 = 0.623140
Validation mse = 0.025793
Epoch 51
Loss = 4.5531e-02, PNorm = 44.8457, GNorm = 1.0182, lr_0 = 1.2523e-04
Loss = 5.8691e-02, PNorm = 44.8497, GNorm = 2.4711, lr_0 = 1.2250e-04
Loss = 4.4908e-02, PNorm = 44.8502, GNorm = 0.8053, lr_0 = 1.2223e-04
Validation rmse = 0.169187
Validation r2 = 0.581781
Validation mse = 0.028624
Epoch 52
Loss = 4.9580e-02, PNorm = 44.8540, GNorm = 1.0970, lr_0 = 1.1956e-04
Validation rmse = 0.162289
Validation r2 = 0.615187
Validation mse = 0.026338
Epoch 53
Loss = 7.5368e-02, PNorm = 44.8578, GNorm = 1.3329, lr_0 = 1.1695e-04
Loss = 5.1434e-02, PNorm = 44.8615, GNorm = 1.4996, lr_0 = 1.1440e-04
Validation rmse = 0.166610
Validation r2 = 0.594424
Validation mse = 0.027759
Epoch 54
Loss = 3.8188e-02, PNorm = 44.8665, GNorm = 0.6619, lr_0 = 1.1166e-04
Loss = 4.9811e-02, PNorm = 44.8701, GNorm = 0.6144, lr_0 = 1.0922e-04
Validation rmse = 0.165900
Validation r2 = 0.597872
Validation mse = 0.027523
Epoch 55
Loss = 5.1618e-02, PNorm = 44.8742, GNorm = 0.9426, lr_0 = 1.0684e-04
Loss = 5.2099e-02, PNorm = 44.8776, GNorm = 1.0043, lr_0 = 1.0451e-04
Validation rmse = 0.166428
Validation r2 = 0.595309
Validation mse = 0.027698
Epoch 56
Loss = 4.8504e-02, PNorm = 44.8809, GNorm = 0.8011, lr_0 = 1.0200e-04
Loss = 4.8520e-02, PNorm = 44.8841, GNorm = 1.2362, lr_0 = 1.0000e-04
Validation rmse = 0.168497
Validation r2 = 0.585185
Validation mse = 0.028391
Epoch 57
Loss = 4.9615e-02, PNorm = 44.8875, GNorm = 1.5435, lr_0 = 1.0000e-04
Loss = 4.9673e-02, PNorm = 44.8909, GNorm = 0.9643, lr_0 = 1.0000e-04
Validation rmse = 0.159747
Validation r2 = 0.627147
Validation mse = 0.025519
Epoch 58
Loss = 4.9656e-02, PNorm = 44.8946, GNorm = 0.8427, lr_0 = 1.0000e-04
Loss = 4.6633e-02, PNorm = 44.8980, GNorm = 1.2348, lr_0 = 1.0000e-04
Validation rmse = 0.169420
Validation r2 = 0.580628
Validation mse = 0.028703
Epoch 59
Loss = 4.7419e-02, PNorm = 44.9013, GNorm = 0.6187, lr_0 = 1.0000e-04
Validation rmse = 0.161543
Validation r2 = 0.618718
Validation mse = 0.026096
Model 0 best validation rmse = 0.155793 on epoch 22
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.159395
Model 0 test r2 = 0.530109
Model 0 test mse = 0.025407
Ensemble test rmse = 0.159395
Ensemble test r2 = 0.530109
Ensemble test mse = 0.025407
Fold 3
Splitting data with seed 3
Total size = 934 | train size = 924 | val size = 10 | test size = 98
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 8.9146e-01, PNorm = 43.2635, GNorm = 1.1329, lr_0 = 3.7500e-04
Validation rmse = 0.345855
Validation r2 = 0.136311
Validation mse = 0.119616
Epoch 1
Loss = 6.2146e-01, PNorm = 43.3000, GNorm = 13.2054, lr_0 = 6.5000e-04
Loss = 6.4970e-01, PNorm = 43.3480, GNorm = 14.1696, lr_0 = 9.0000e-04
Validation rmse = 0.353572
Validation r2 = 0.097335
Validation mse = 0.125013
Epoch 2
Loss = 6.1086e-01, PNorm = 43.4162, GNorm = 1.6619, lr_0 = 9.8468e-04
Loss = 4.8731e-01, PNorm = 43.4985, GNorm = 1.7359, lr_0 = 9.6320e-04
Validation rmse = 0.328296
Validation r2 = 0.221783
Validation mse = 0.107778
Epoch 3
Loss = 3.2868e-01, PNorm = 43.5833, GNorm = 0.9605, lr_0 = 9.4219e-04
Loss = 3.5606e-01, PNorm = 43.6505, GNorm = 10.7352, lr_0 = 9.2164e-04
Validation rmse = 0.249566
Validation r2 = 0.550280
Validation mse = 0.062283
Epoch 4
Loss = 2.6586e-01, PNorm = 43.7070, GNorm = 4.5991, lr_0 = 8.9955e-04
Loss = 2.3906e-01, PNorm = 43.7524, GNorm = 1.9983, lr_0 = 8.7992e-04
Validation rmse = 0.237090
Validation r2 = 0.594121
Validation mse = 0.056212
Epoch 5
Loss = 2.0997e-01, PNorm = 43.7937, GNorm = 1.0054, lr_0 = 8.6073e-04
Loss = 2.0227e-01, PNorm = 43.8298, GNorm = 1.2066, lr_0 = 8.4195e-04
Loss = 1.7048e-01, PNorm = 43.8335, GNorm = 2.5392, lr_0 = 8.4010e-04
Validation rmse = 0.211970
Validation r2 = 0.675571
Validation mse = 0.044931
Epoch 6
Loss = 1.6828e-01, PNorm = 43.8671, GNorm = 1.0894, lr_0 = 8.2177e-04
Validation rmse = 0.196108
Validation r2 = 0.722311
Validation mse = 0.038458
Epoch 7
Loss = 1.9307e-01, PNorm = 43.8949, GNorm = 1.9373, lr_0 = 8.0385e-04
Loss = 1.8965e-01, PNorm = 43.9235, GNorm = 2.2581, lr_0 = 7.8631e-04
Validation rmse = 0.193632
Validation r2 = 0.729278
Validation mse = 0.037493
Epoch 8
Loss = 1.4915e-01, PNorm = 43.9523, GNorm = 5.5280, lr_0 = 7.6746e-04
Loss = 1.6798e-01, PNorm = 43.9748, GNorm = 1.3742, lr_0 = 7.5072e-04
Validation rmse = 0.171486
Validation r2 = 0.787662
Validation mse = 0.029408
Epoch 9
Loss = 1.6256e-01, PNorm = 43.9982, GNorm = 4.1106, lr_0 = 7.3435e-04
Loss = 1.3707e-01, PNorm = 44.0192, GNorm = 1.5864, lr_0 = 7.1833e-04
Validation rmse = 0.177064
Validation r2 = 0.773624
Validation mse = 0.031352
Epoch 10
Loss = 1.3350e-01, PNorm = 44.0416, GNorm = 0.9282, lr_0 = 7.0111e-04
Loss = 1.2210e-01, PNorm = 44.0582, GNorm = 2.0195, lr_0 = 6.8581e-04
Validation rmse = 0.176142
Validation r2 = 0.775975
Validation mse = 0.031026
Epoch 11
Loss = 1.0600e-01, PNorm = 44.0730, GNorm = 0.8772, lr_0 = 6.7085e-04
Loss = 1.2444e-01, PNorm = 44.0876, GNorm = 1.7400, lr_0 = 6.5622e-04
Validation rmse = 0.184756
Validation r2 = 0.753528
Validation mse = 0.034135
Epoch 12
Loss = 1.1666e-01, PNorm = 44.1077, GNorm = 2.0365, lr_0 = 6.4049e-04
Loss = 1.1471e-01, PNorm = 44.1236, GNorm = 2.1573, lr_0 = 6.2652e-04
Validation rmse = 0.177151
Validation r2 = 0.773400
Validation mse = 0.031383
Epoch 13
Loss = 1.0934e-01, PNorm = 44.1395, GNorm = 2.5433, lr_0 = 6.1285e-04
Validation rmse = 0.163729
Validation r2 = 0.806437
Validation mse = 0.026807
Epoch 14
Loss = 9.0852e-02, PNorm = 44.1544, GNorm = 0.8211, lr_0 = 5.9816e-04
Loss = 1.0166e-01, PNorm = 44.1670, GNorm = 1.0026, lr_0 = 5.8512e-04
Validation rmse = 0.158658
Validation r2 = 0.818242
Validation mse = 0.025172
Epoch 15
Loss = 8.2594e-02, PNorm = 44.1826, GNorm = 0.9209, lr_0 = 5.7235e-04
Loss = 1.0996e-01, PNorm = 44.1965, GNorm = 3.0820, lr_0 = 5.5987e-04
Validation rmse = 0.173635
Validation r2 = 0.782308
Validation mse = 0.030149
Epoch 16
Loss = 1.0951e-01, PNorm = 44.2160, GNorm = 0.7428, lr_0 = 5.4645e-04
Loss = 1.0130e-01, PNorm = 44.2311, GNorm = 0.5026, lr_0 = 5.3453e-04
Validation rmse = 0.186699
Validation r2 = 0.748317
Validation mse = 0.034857
Epoch 17
Loss = 1.1262e-01, PNorm = 44.2447, GNorm = 1.2482, lr_0 = 5.2287e-04
Loss = 1.0642e-01, PNorm = 44.2565, GNorm = 3.6193, lr_0 = 5.1146e-04
Validation rmse = 0.165752
Validation r2 = 0.801624
Validation mse = 0.027474
Epoch 18
Loss = 8.8295e-02, PNorm = 44.2733, GNorm = 2.9259, lr_0 = 4.9920e-04
Loss = 1.0799e-01, PNorm = 44.2863, GNorm = 2.1979, lr_0 = 4.8831e-04
Validation rmse = 0.177981
Validation r2 = 0.771273
Validation mse = 0.031677
Epoch 19
Loss = 1.0170e-01, PNorm = 44.2984, GNorm = 1.4913, lr_0 = 4.7766e-04
Validation rmse = 0.153874
Validation r2 = 0.829038
Validation mse = 0.023677
Epoch 20
Loss = 7.3917e-02, PNorm = 44.3122, GNorm = 0.4996, lr_0 = 4.6621e-04
Loss = 1.0884e-01, PNorm = 44.3276, GNorm = 4.1979, lr_0 = 4.5604e-04
Validation rmse = 0.152718
Validation r2 = 0.831598
Validation mse = 0.023323
Epoch 21
Loss = 1.1013e-01, PNorm = 44.3428, GNorm = 1.3833, lr_0 = 4.4609e-04
Loss = 9.6476e-02, PNorm = 44.3560, GNorm = 3.0134, lr_0 = 4.3636e-04
Validation rmse = 0.166855
Validation r2 = 0.798976
Validation mse = 0.027841
Epoch 22
Loss = 7.4366e-02, PNorm = 44.3672, GNorm = 1.2284, lr_0 = 4.2590e-04
Loss = 8.7037e-02, PNorm = 44.3773, GNorm = 0.7119, lr_0 = 4.1661e-04
Validation rmse = 0.172142
Validation r2 = 0.786035
Validation mse = 0.029633
Epoch 23
Loss = 1.0034e-01, PNorm = 44.3877, GNorm = 0.9607, lr_0 = 4.0752e-04
Loss = 1.0014e-01, PNorm = 44.4005, GNorm = 3.2400, lr_0 = 3.9863e-04
Validation rmse = 0.151439
Validation r2 = 0.834405
Validation mse = 0.022934
Epoch 24
Loss = 1.0691e-01, PNorm = 44.4136, GNorm = 1.7647, lr_0 = 3.8908e-04
Loss = 9.3966e-02, PNorm = 44.4266, GNorm = 1.6133, lr_0 = 3.8059e-04
Validation rmse = 0.145817
Validation r2 = 0.846472
Validation mse = 0.021263
Epoch 25
Loss = 8.0494e-02, PNorm = 44.4351, GNorm = 1.4730, lr_0 = 3.7229e-04
Loss = 9.3366e-02, PNorm = 44.4453, GNorm = 1.5252, lr_0 = 3.6417e-04
Loss = 4.8990e-02, PNorm = 44.4460, GNorm = 0.7023, lr_0 = 3.6337e-04
Validation rmse = 0.176359
Validation r2 = 0.775424
Validation mse = 0.031102
Epoch 26
Loss = 7.7687e-02, PNorm = 44.4548, GNorm = 0.8785, lr_0 = 3.5544e-04
Validation rmse = 0.168956
Validation r2 = 0.793882
Validation mse = 0.028546
Epoch 27
Loss = 7.1645e-02, PNorm = 44.4663, GNorm = 1.6418, lr_0 = 3.4692e-04
Loss = 8.6178e-02, PNorm = 44.4757, GNorm = 1.7206, lr_0 = 3.3935e-04
Validation rmse = 0.170213
Validation r2 = 0.790803
Validation mse = 0.028972
Epoch 28
Loss = 9.7806e-02, PNorm = 44.4847, GNorm = 1.6325, lr_0 = 3.3195e-04
Loss = 7.1269e-02, PNorm = 44.4939, GNorm = 0.8380, lr_0 = 3.2471e-04
Validation rmse = 0.178102
Validation r2 = 0.770962
Validation mse = 0.031720
Epoch 29
Loss = 7.2143e-02, PNorm = 44.5028, GNorm = 1.1714, lr_0 = 3.1693e-04
Loss = 8.7944e-02, PNorm = 44.5122, GNorm = 3.2541, lr_0 = 3.1001e-04
Validation rmse = 0.186907
Validation r2 = 0.747755
Validation mse = 0.034934
Epoch 30
Loss = 8.2007e-02, PNorm = 44.5217, GNorm = 2.2033, lr_0 = 3.0325e-04
Loss = 7.6355e-02, PNorm = 44.5307, GNorm = 2.3337, lr_0 = 2.9663e-04
Validation rmse = 0.189874
Validation r2 = 0.739684
Validation mse = 0.036052
Epoch 31
Loss = 7.7410e-02, PNorm = 44.5409, GNorm = 1.3665, lr_0 = 2.8952e-04
Loss = 7.6065e-02, PNorm = 44.5492, GNorm = 0.4557, lr_0 = 2.8321e-04
Validation rmse = 0.160743
Validation r2 = 0.813433
Validation mse = 0.025838
Epoch 32
Loss = 8.0046e-02, PNorm = 44.5597, GNorm = 1.7766, lr_0 = 2.7703e-04
Validation rmse = 0.147723
Validation r2 = 0.842432
Validation mse = 0.021822
Epoch 33
Loss = 7.3698e-02, PNorm = 44.5675, GNorm = 0.9274, lr_0 = 2.7039e-04
Loss = 8.2094e-02, PNorm = 44.5737, GNorm = 0.8380, lr_0 = 2.6449e-04
Validation rmse = 0.154232
Validation r2 = 0.828241
Validation mse = 0.023788
Epoch 34
Loss = 6.3660e-02, PNorm = 44.5818, GNorm = 1.1650, lr_0 = 2.5872e-04
Loss = 7.3639e-02, PNorm = 44.5878, GNorm = 0.8160, lr_0 = 2.5308e-04
Validation rmse = 0.159265
Validation r2 = 0.816848
Validation mse = 0.025365
Epoch 35
Loss = 6.6016e-02, PNorm = 44.5952, GNorm = 0.8613, lr_0 = 2.4701e-04
Loss = 6.7850e-02, PNorm = 44.6031, GNorm = 2.6870, lr_0 = 2.4162e-04
Validation rmse = 0.153254
Validation r2 = 0.830413
Validation mse = 0.023487
Epoch 36
Loss = 8.2765e-02, PNorm = 44.6109, GNorm = 1.6127, lr_0 = 2.3635e-04
Loss = 6.3548e-02, PNorm = 44.6179, GNorm = 0.9419, lr_0 = 2.3120e-04
Validation rmse = 0.159959
Validation r2 = 0.815250
Validation mse = 0.025587
Epoch 37
Loss = 6.3963e-02, PNorm = 44.6256, GNorm = 0.9512, lr_0 = 2.2566e-04
Loss = 6.7415e-02, PNorm = 44.6305, GNorm = 0.5740, lr_0 = 2.2073e-04
Validation rmse = 0.157113
Validation r2 = 0.821765
Validation mse = 0.024684
Epoch 38
Loss = 7.2247e-02, PNorm = 44.6365, GNorm = 1.0150, lr_0 = 2.1592e-04
Loss = 6.5836e-02, PNorm = 44.6435, GNorm = 1.1597, lr_0 = 2.1121e-04
Loss = 5.2026e-02, PNorm = 44.6441, GNorm = 1.3212, lr_0 = 2.1074e-04
Validation rmse = 0.150371
Validation r2 = 0.836732
Validation mse = 0.022612
Epoch 39
Loss = 7.5267e-02, PNorm = 44.6523, GNorm = 2.3059, lr_0 = 2.0615e-04
Validation rmse = 0.159585
Validation r2 = 0.816113
Validation mse = 0.025467
Epoch 40
Loss = 5.7419e-02, PNorm = 44.6576, GNorm = 1.6409, lr_0 = 2.0165e-04
Loss = 7.3690e-02, PNorm = 44.6649, GNorm = 1.8443, lr_0 = 1.9725e-04
Validation rmse = 0.174740
Validation r2 = 0.779527
Validation mse = 0.030534
Epoch 41
Loss = 7.4037e-02, PNorm = 44.6725, GNorm = 1.0400, lr_0 = 1.9252e-04
Loss = 5.8133e-02, PNorm = 44.6791, GNorm = 0.3480, lr_0 = 1.8832e-04
Validation rmse = 0.161110
Validation r2 = 0.812582
Validation mse = 0.025956
Epoch 42
Loss = 5.1041e-02, PNorm = 44.6855, GNorm = 1.8934, lr_0 = 1.8422e-04
Loss = 6.0010e-02, PNorm = 44.6910, GNorm = 1.7025, lr_0 = 1.8020e-04
Validation rmse = 0.157927
Validation r2 = 0.819912
Validation mse = 0.024941
Epoch 43
Loss = 6.5564e-02, PNorm = 44.6985, GNorm = 1.3639, lr_0 = 1.7588e-04
Loss = 5.8784e-02, PNorm = 44.7051, GNorm = 0.4952, lr_0 = 1.7204e-04
Validation rmse = 0.155579
Validation r2 = 0.825227
Validation mse = 0.024205
Epoch 44
Loss = 4.3438e-02, PNorm = 44.7093, GNorm = 1.6264, lr_0 = 1.6829e-04
Loss = 7.2583e-02, PNorm = 44.7147, GNorm = 1.4707, lr_0 = 1.6462e-04
Validation rmse = 0.162530
Validation r2 = 0.809262
Validation mse = 0.026416
Epoch 45
Loss = 6.1684e-02, PNorm = 44.7203, GNorm = 1.7236, lr_0 = 1.6067e-04
Loss = 6.2513e-02, PNorm = 44.7251, GNorm = 1.1518, lr_0 = 1.5717e-04
Validation rmse = 0.154477
Validation r2 = 0.827695
Validation mse = 0.023863
Epoch 46
Loss = 6.3665e-02, PNorm = 44.7298, GNorm = 0.8186, lr_0 = 1.5374e-04
Validation rmse = 0.159144
Validation r2 = 0.817126
Validation mse = 0.025327
Epoch 47
Loss = 4.6199e-02, PNorm = 44.7360, GNorm = 1.0240, lr_0 = 1.5005e-04
Loss = 5.9906e-02, PNorm = 44.7400, GNorm = 0.6833, lr_0 = 1.4678e-04
Validation rmse = 0.167024
Validation r2 = 0.798568
Validation mse = 0.027897
Epoch 48
Loss = 6.4843e-02, PNorm = 44.7447, GNorm = 0.7069, lr_0 = 1.4358e-04
Loss = 6.2025e-02, PNorm = 44.7497, GNorm = 0.6329, lr_0 = 1.4045e-04
Validation rmse = 0.160278
Validation r2 = 0.814511
Validation mse = 0.025689
Epoch 49
Loss = 5.7982e-02, PNorm = 44.7542, GNorm = 0.7035, lr_0 = 1.3708e-04
Loss = 6.5363e-02, PNorm = 44.7585, GNorm = 1.3317, lr_0 = 1.3409e-04
Validation rmse = 0.171076
Validation r2 = 0.788676
Validation mse = 0.029267
Epoch 50
Loss = 5.7150e-02, PNorm = 44.7629, GNorm = 0.6266, lr_0 = 1.3116e-04
Loss = 6.1898e-02, PNorm = 44.7670, GNorm = 1.6011, lr_0 = 1.2830e-04
Validation rmse = 0.153867
Validation r2 = 0.829053
Validation mse = 0.023675
Epoch 51
Loss = 6.4197e-02, PNorm = 44.7722, GNorm = 1.5137, lr_0 = 1.2523e-04
Loss = 5.9054e-02, PNorm = 44.7768, GNorm = 0.8106, lr_0 = 1.2250e-04
Loss = 4.6071e-02, PNorm = 44.7772, GNorm = 1.5206, lr_0 = 1.2223e-04
Validation rmse = 0.169898
Validation r2 = 0.791577
Validation mse = 0.028865
Epoch 52
Loss = 6.0548e-02, PNorm = 44.7807, GNorm = 1.6558, lr_0 = 1.1956e-04
Validation rmse = 0.152485
Validation r2 = 0.832111
Validation mse = 0.023252
Epoch 53
Loss = 7.9414e-02, PNorm = 44.7849, GNorm = 2.3404, lr_0 = 1.1695e-04
Loss = 5.6411e-02, PNorm = 44.7896, GNorm = 0.4804, lr_0 = 1.1440e-04
Validation rmse = 0.159090
Validation r2 = 0.817250
Validation mse = 0.025310
Epoch 54
Loss = 4.7407e-02, PNorm = 44.7942, GNorm = 0.6579, lr_0 = 1.1166e-04
Loss = 5.4548e-02, PNorm = 44.7980, GNorm = 0.9791, lr_0 = 1.0922e-04
Validation rmse = 0.157739
Validation r2 = 0.820341
Validation mse = 0.024882
Epoch 55
Loss = 5.4618e-02, PNorm = 44.8016, GNorm = 1.8914, lr_0 = 1.0684e-04
Loss = 4.9734e-02, PNorm = 44.8054, GNorm = 1.2335, lr_0 = 1.0451e-04
Validation rmse = 0.157043
Validation r2 = 0.821923
Validation mse = 0.024662
Epoch 56
Loss = 5.9005e-02, PNorm = 44.8087, GNorm = 0.6462, lr_0 = 1.0200e-04
Loss = 5.5403e-02, PNorm = 44.8125, GNorm = 0.6167, lr_0 = 1.0000e-04
Validation rmse = 0.149997
Validation r2 = 0.837545
Validation mse = 0.022499
Epoch 57
Loss = 5.6154e-02, PNorm = 44.8157, GNorm = 1.0764, lr_0 = 1.0000e-04
Loss = 5.3004e-02, PNorm = 44.8187, GNorm = 0.9156, lr_0 = 1.0000e-04
Validation rmse = 0.153505
Validation r2 = 0.829856
Validation mse = 0.023564
Epoch 58
Loss = 5.2328e-02, PNorm = 44.8221, GNorm = 0.6460, lr_0 = 1.0000e-04
Loss = 5.3860e-02, PNorm = 44.8257, GNorm = 0.7070, lr_0 = 1.0000e-04
Validation rmse = 0.157354
Validation r2 = 0.821216
Validation mse = 0.024760
Epoch 59
Loss = 4.6735e-02, PNorm = 44.8288, GNorm = 0.7187, lr_0 = 1.0000e-04
Validation rmse = 0.156221
Validation r2 = 0.823783
Validation mse = 0.024405
Model 0 best validation rmse = 0.145817 on epoch 24
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.194249
Model 0 test r2 = 0.302144
Model 0 test mse = 0.037733
Ensemble test rmse = 0.194249
Ensemble test r2 = 0.302144
Ensemble test mse = 0.037733
Fold 4
Splitting data with seed 4
Total size = 934 | train size = 924 | val size = 10 | test size = 98
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 8.9874e-01, PNorm = 43.2633, GNorm = 7.5013, lr_0 = 3.7500e-04
Validation rmse = 0.225205
Validation r2 = 0.496087
Validation mse = 0.050717
Epoch 1
Loss = 6.1426e-01, PNorm = 43.2950, GNorm = 1.1157, lr_0 = 6.5000e-04
Loss = 5.1724e-01, PNorm = 43.3484, GNorm = 9.3292, lr_0 = 9.0000e-04
Validation rmse = 0.229890
Validation r2 = 0.474902
Validation mse = 0.052850
Epoch 2
Loss = 8.2548e-01, PNorm = 43.4209, GNorm = 3.9198, lr_0 = 9.8468e-04
Loss = 5.3128e-01, PNorm = 43.5148, GNorm = 8.2941, lr_0 = 9.6320e-04
Validation rmse = 0.148451
Validation r2 = 0.781042
Validation mse = 0.022038
Epoch 3
Loss = 4.2990e-01, PNorm = 43.5864, GNorm = 1.3735, lr_0 = 9.4219e-04
Loss = 3.1312e-01, PNorm = 43.6628, GNorm = 1.3587, lr_0 = 9.2164e-04
Validation rmse = 0.141066
Validation r2 = 0.802283
Validation mse = 0.019900
Epoch 4
Loss = 3.3436e-01, PNorm = 43.7251, GNorm = 7.1179, lr_0 = 8.9955e-04
Loss = 2.7869e-01, PNorm = 43.7706, GNorm = 1.0256, lr_0 = 8.7992e-04
Validation rmse = 0.098664
Validation r2 = 0.903281
Validation mse = 0.009735
Epoch 5
Loss = 2.1865e-01, PNorm = 43.8126, GNorm = 3.3431, lr_0 = 8.6073e-04
Loss = 1.9708e-01, PNorm = 43.8547, GNorm = 1.5149, lr_0 = 8.4195e-04
Loss = 2.6817e-01, PNorm = 43.8573, GNorm = 4.3929, lr_0 = 8.4010e-04
Validation rmse = 0.094796
Validation r2 = 0.910715
Validation mse = 0.008986
Epoch 6
Loss = 2.0057e-01, PNorm = 43.8913, GNorm = 0.7043, lr_0 = 8.2177e-04
Validation rmse = 0.078399
Validation r2 = 0.938931
Validation mse = 0.006146
Epoch 7
Loss = 1.7971e-01, PNorm = 43.9224, GNorm = 2.4453, lr_0 = 8.0385e-04
Loss = 2.0760e-01, PNorm = 43.9544, GNorm = 4.0231, lr_0 = 7.8631e-04
Validation rmse = 0.108576
Validation r2 = 0.882871
Validation mse = 0.011789
Epoch 8
Loss = 1.3837e-01, PNorm = 43.9917, GNorm = 0.9504, lr_0 = 7.6746e-04
Loss = 1.2610e-01, PNorm = 44.0167, GNorm = 1.8258, lr_0 = 7.5072e-04
Validation rmse = 0.082472
Validation r2 = 0.932422
Validation mse = 0.006802
Epoch 9
Loss = 1.4727e-01, PNorm = 44.0441, GNorm = 3.5287, lr_0 = 7.3435e-04
Loss = 1.5693e-01, PNorm = 44.0669, GNorm = 3.3652, lr_0 = 7.1833e-04
Validation rmse = 0.070829
Validation r2 = 0.950155
Validation mse = 0.005017
Epoch 10
Loss = 1.1261e-01, PNorm = 44.0865, GNorm = 1.9764, lr_0 = 7.0111e-04
Loss = 1.4170e-01, PNorm = 44.1045, GNorm = 1.2397, lr_0 = 6.8581e-04
Validation rmse = 0.080730
Validation r2 = 0.935245
Validation mse = 0.006517
Epoch 11
Loss = 8.9315e-02, PNorm = 44.1262, GNorm = 0.5734, lr_0 = 6.7085e-04
Loss = 1.4300e-01, PNorm = 44.1442, GNorm = 0.8019, lr_0 = 6.5622e-04
Validation rmse = 0.106909
Validation r2 = 0.886440
Validation mse = 0.011430
Epoch 12
Loss = 1.5781e-01, PNorm = 44.1610, GNorm = 3.7653, lr_0 = 6.4049e-04
Loss = 1.4085e-01, PNorm = 44.1832, GNorm = 2.1609, lr_0 = 6.2652e-04
Validation rmse = 0.088774
Validation r2 = 0.921698
Validation mse = 0.007881
Epoch 13
Loss = 1.2347e-01, PNorm = 44.2062, GNorm = 0.6918, lr_0 = 6.1285e-04
Validation rmse = 0.075878
Validation r2 = 0.942795
Validation mse = 0.005757
Epoch 14
Loss = 1.3050e-01, PNorm = 44.2289, GNorm = 1.9989, lr_0 = 5.9816e-04
Loss = 1.4379e-01, PNorm = 44.2529, GNorm = 2.8088, lr_0 = 5.8512e-04
Validation rmse = 0.099564
Validation r2 = 0.901507
Validation mse = 0.009913
Epoch 15
Loss = 1.1302e-01, PNorm = 44.2728, GNorm = 1.2139, lr_0 = 5.7235e-04
Loss = 1.1204e-01, PNorm = 44.2887, GNorm = 2.3156, lr_0 = 5.5987e-04
Validation rmse = 0.086310
Validation r2 = 0.925985
Validation mse = 0.007449
Epoch 16
Loss = 9.1889e-02, PNorm = 44.3076, GNorm = 1.3456, lr_0 = 5.4645e-04
Loss = 1.0935e-01, PNorm = 44.3201, GNorm = 1.8922, lr_0 = 5.3453e-04
Validation rmse = 0.100211
Validation r2 = 0.900222
Validation mse = 0.010042
Epoch 17
Loss = 1.0300e-01, PNorm = 44.3340, GNorm = 0.8306, lr_0 = 5.2287e-04
Loss = 9.9508e-02, PNorm = 44.3534, GNorm = 0.8725, lr_0 = 5.1146e-04
Validation rmse = 0.075675
Validation r2 = 0.943100
Validation mse = 0.005727
Epoch 18
Loss = 1.1017e-01, PNorm = 44.3635, GNorm = 2.3538, lr_0 = 4.9920e-04
Loss = 9.1116e-02, PNorm = 44.3759, GNorm = 1.3182, lr_0 = 4.8831e-04
Validation rmse = 0.093838
Validation r2 = 0.912511
Validation mse = 0.008806
Epoch 19
Loss = 9.7282e-02, PNorm = 44.3893, GNorm = 0.6055, lr_0 = 4.7766e-04
Validation rmse = 0.091541
Validation r2 = 0.916742
Validation mse = 0.008380
Epoch 20
Loss = 6.4193e-02, PNorm = 44.4015, GNorm = 0.9470, lr_0 = 4.6621e-04
Loss = 9.6396e-02, PNorm = 44.4098, GNorm = 2.4801, lr_0 = 4.5604e-04
Validation rmse = 0.080795
Validation r2 = 0.935142
Validation mse = 0.006528
Epoch 21
Loss = 1.0817e-01, PNorm = 44.4216, GNorm = 1.0322, lr_0 = 4.4609e-04
Loss = 9.5536e-02, PNorm = 44.4348, GNorm = 0.4828, lr_0 = 4.3636e-04
Validation rmse = 0.092429
Validation r2 = 0.915117
Validation mse = 0.008543
Epoch 22
Loss = 1.1115e-01, PNorm = 44.4486, GNorm = 3.8260, lr_0 = 4.2590e-04
Loss = 1.0393e-01, PNorm = 44.4605, GNorm = 0.2744, lr_0 = 4.1661e-04
Validation rmse = 0.079351
Validation r2 = 0.937440
Validation mse = 0.006297
Epoch 23
Loss = 9.4172e-02, PNorm = 44.4717, GNorm = 1.6449, lr_0 = 4.0752e-04
Loss = 9.2832e-02, PNorm = 44.4850, GNorm = 1.0263, lr_0 = 3.9863e-04
Validation rmse = 0.082445
Validation r2 = 0.932465
Validation mse = 0.006797
Epoch 24
Loss = 9.2886e-02, PNorm = 44.5006, GNorm = 0.8472, lr_0 = 3.8908e-04
Loss = 8.7926e-02, PNorm = 44.5123, GNorm = 0.8189, lr_0 = 3.8059e-04
Validation rmse = 0.084228
Validation r2 = 0.929513
Validation mse = 0.007094
Epoch 25
Loss = 7.9005e-02, PNorm = 44.5212, GNorm = 1.6091, lr_0 = 3.7229e-04
Loss = 9.3258e-02, PNorm = 44.5292, GNorm = 0.4322, lr_0 = 3.6417e-04
Loss = 6.8997e-02, PNorm = 44.5300, GNorm = 1.8024, lr_0 = 3.6337e-04
Validation rmse = 0.114564
Validation r2 = 0.869594
Validation mse = 0.013125
Epoch 26
Loss = 8.0244e-02, PNorm = 44.5399, GNorm = 1.2751, lr_0 = 3.5544e-04
Validation rmse = 0.091557
Validation r2 = 0.916713
Validation mse = 0.008383
Epoch 27
Loss = 7.3605e-02, PNorm = 44.5523, GNorm = 0.6663, lr_0 = 3.4692e-04
Loss = 7.6878e-02, PNorm = 44.5635, GNorm = 1.7624, lr_0 = 3.3935e-04
Validation rmse = 0.101386
Validation r2 = 0.897869
Validation mse = 0.010279
Epoch 28
Loss = 7.7425e-02, PNorm = 44.5734, GNorm = 1.2987, lr_0 = 3.3195e-04
Loss = 7.9873e-02, PNorm = 44.5834, GNorm = 1.0245, lr_0 = 3.2471e-04
Validation rmse = 0.106872
Validation r2 = 0.886519
Validation mse = 0.011422
Epoch 29
Loss = 7.4943e-02, PNorm = 44.5979, GNorm = 2.0435, lr_0 = 3.1693e-04
Loss = 9.3963e-02, PNorm = 44.6091, GNorm = 0.9163, lr_0 = 3.1001e-04
Validation rmse = 0.114586
Validation r2 = 0.869544
Validation mse = 0.013130
Epoch 30
Loss = 1.0039e-01, PNorm = 44.6218, GNorm = 3.1193, lr_0 = 3.0325e-04
Loss = 8.7647e-02, PNorm = 44.6318, GNorm = 0.7546, lr_0 = 2.9663e-04
Validation rmse = 0.088597
Validation r2 = 0.922010
Validation mse = 0.007849
Epoch 31
Loss = 7.9749e-02, PNorm = 44.6420, GNorm = 0.9732, lr_0 = 2.8952e-04
Loss = 7.0695e-02, PNorm = 44.6504, GNorm = 0.8910, lr_0 = 2.8321e-04
Validation rmse = 0.091652
Validation r2 = 0.916538
Validation mse = 0.008400
Epoch 32
Loss = 7.3947e-02, PNorm = 44.6575, GNorm = 0.6518, lr_0 = 2.7703e-04
Validation rmse = 0.096315
Validation r2 = 0.907832
Validation mse = 0.009277
Epoch 33
Loss = 5.0985e-02, PNorm = 44.6668, GNorm = 0.7946, lr_0 = 2.7039e-04
Loss = 7.6579e-02, PNorm = 44.6739, GNorm = 1.6785, lr_0 = 2.6449e-04
Validation rmse = 0.084993
Validation r2 = 0.928227
Validation mse = 0.007224
Epoch 34
Loss = 4.8324e-02, PNorm = 44.6818, GNorm = 0.6738, lr_0 = 2.5872e-04
Loss = 7.6574e-02, PNorm = 44.6886, GNorm = 1.9384, lr_0 = 2.5308e-04
Validation rmse = 0.082223
Validation r2 = 0.932829
Validation mse = 0.006761
Epoch 35
Loss = 6.4525e-02, PNorm = 44.6981, GNorm = 1.7218, lr_0 = 2.4701e-04
Loss = 7.8651e-02, PNorm = 44.7057, GNorm = 2.4386, lr_0 = 2.4162e-04
Validation rmse = 0.086919
Validation r2 = 0.924936
Validation mse = 0.007555
Epoch 36
Loss = 7.4391e-02, PNorm = 44.7143, GNorm = 2.1314, lr_0 = 2.3635e-04
Loss = 7.3043e-02, PNorm = 44.7240, GNorm = 1.1912, lr_0 = 2.3120e-04
Validation rmse = 0.101897
Validation r2 = 0.896838
Validation mse = 0.010383
Epoch 37
Loss = 6.6111e-02, PNorm = 44.7318, GNorm = 1.7377, lr_0 = 2.2566e-04
Loss = 7.5325e-02, PNorm = 44.7389, GNorm = 1.5127, lr_0 = 2.2073e-04
Validation rmse = 0.083836
Validation r2 = 0.930167
Validation mse = 0.007028
Epoch 38
Loss = 6.6880e-02, PNorm = 44.7454, GNorm = 0.5878, lr_0 = 2.1592e-04
Loss = 6.8908e-02, PNorm = 44.7523, GNorm = 1.0705, lr_0 = 2.1121e-04
Loss = 1.2666e-01, PNorm = 44.7529, GNorm = 2.2532, lr_0 = 2.1074e-04
Validation rmse = 0.068714
Validation r2 = 0.953088
Validation mse = 0.004722
Epoch 39
Loss = 8.3911e-02, PNorm = 44.7613, GNorm = 3.1056, lr_0 = 2.0615e-04
Validation rmse = 0.094564
Validation r2 = 0.911152
Validation mse = 0.008942
Epoch 40
Loss = 7.5922e-02, PNorm = 44.7685, GNorm = 0.9467, lr_0 = 2.0165e-04
Loss = 5.9707e-02, PNorm = 44.7739, GNorm = 0.6034, lr_0 = 1.9725e-04
Validation rmse = 0.094062
Validation r2 = 0.912092
Validation mse = 0.008848
Epoch 41
Loss = 5.7913e-02, PNorm = 44.7808, GNorm = 1.1770, lr_0 = 1.9252e-04
Loss = 7.3452e-02, PNorm = 44.7874, GNorm = 0.7613, lr_0 = 1.8832e-04
Validation rmse = 0.091919
Validation r2 = 0.916052
Validation mse = 0.008449
Epoch 42
Loss = 6.7093e-02, PNorm = 44.7935, GNorm = 1.2002, lr_0 = 1.8422e-04
Loss = 6.8034e-02, PNorm = 44.8010, GNorm = 0.5760, lr_0 = 1.8020e-04
Validation rmse = 0.096046
Validation r2 = 0.908346
Validation mse = 0.009225
Epoch 43
Loss = 5.5463e-02, PNorm = 44.8069, GNorm = 0.5633, lr_0 = 1.7588e-04
Loss = 7.0908e-02, PNorm = 44.8130, GNorm = 0.9792, lr_0 = 1.7204e-04
Validation rmse = 0.083306
Validation r2 = 0.931048
Validation mse = 0.006940
Epoch 44
Loss = 6.4500e-02, PNorm = 44.8176, GNorm = 1.6543, lr_0 = 1.6829e-04
Loss = 6.2002e-02, PNorm = 44.8229, GNorm = 0.7844, lr_0 = 1.6462e-04
Validation rmse = 0.087639
Validation r2 = 0.923687
Validation mse = 0.007681
Epoch 45
Loss = 6.2696e-02, PNorm = 44.8295, GNorm = 1.2841, lr_0 = 1.6067e-04
Loss = 6.1311e-02, PNorm = 44.8340, GNorm = 0.8754, lr_0 = 1.5717e-04
Validation rmse = 0.102181
Validation r2 = 0.896262
Validation mse = 0.010441
Epoch 46
Loss = 5.9564e-02, PNorm = 44.8396, GNorm = 1.4376, lr_0 = 1.5374e-04
Validation rmse = 0.090096
Validation r2 = 0.919350
Validation mse = 0.008117
Epoch 47
Loss = 4.7440e-02, PNorm = 44.8450, GNorm = 0.9013, lr_0 = 1.5005e-04
Loss = 6.6041e-02, PNorm = 44.8497, GNorm = 0.7036, lr_0 = 1.4678e-04
Validation rmse = 0.088777
Validation r2 = 0.921693
Validation mse = 0.007881
Epoch 48
Loss = 5.6372e-02, PNorm = 44.8553, GNorm = 1.2846, lr_0 = 1.4358e-04
Loss = 5.0080e-02, PNorm = 44.8603, GNorm = 0.9311, lr_0 = 1.4045e-04
Validation rmse = 0.088638
Validation r2 = 0.921938
Validation mse = 0.007857
Epoch 49
Loss = 4.8965e-02, PNorm = 44.8657, GNorm = 1.6213, lr_0 = 1.3708e-04
Loss = 6.5311e-02, PNorm = 44.8713, GNorm = 0.9629, lr_0 = 1.3409e-04
Validation rmse = 0.104260
Validation r2 = 0.891998
Validation mse = 0.010870
Epoch 50
Loss = 6.1501e-02, PNorm = 44.8751, GNorm = 0.4839, lr_0 = 1.3116e-04
Loss = 5.5312e-02, PNorm = 44.8793, GNorm = 2.2535, lr_0 = 1.2830e-04
Validation rmse = 0.080245
Validation r2 = 0.936021
Validation mse = 0.006439
Epoch 51
Loss = 5.3105e-02, PNorm = 44.8853, GNorm = 0.5469, lr_0 = 1.2523e-04
Loss = 6.1374e-02, PNorm = 44.8898, GNorm = 0.8139, lr_0 = 1.2250e-04
Loss = 7.7437e-02, PNorm = 44.8903, GNorm = 0.9473, lr_0 = 1.2223e-04
Validation rmse = 0.093141
Validation r2 = 0.913806
Validation mse = 0.008675
Epoch 52
Loss = 5.8886e-02, PNorm = 44.8947, GNorm = 1.1364, lr_0 = 1.1956e-04
Validation rmse = 0.094986
Validation r2 = 0.910357
Validation mse = 0.009022
Epoch 53
Loss = 2.7797e-02, PNorm = 44.8986, GNorm = 0.3714, lr_0 = 1.1695e-04
Loss = 5.6415e-02, PNorm = 44.9030, GNorm = 0.6465, lr_0 = 1.1440e-04
Validation rmse = 0.079087
Validation r2 = 0.937854
Validation mse = 0.006255
Epoch 54
Loss = 5.3564e-02, PNorm = 44.9073, GNorm = 1.3351, lr_0 = 1.1166e-04
Loss = 6.0372e-02, PNorm = 44.9110, GNorm = 2.7864, lr_0 = 1.0922e-04
Validation rmse = 0.091504
Validation r2 = 0.916809
Validation mse = 0.008373
Epoch 55
Loss = 6.1462e-02, PNorm = 44.9154, GNorm = 0.8219, lr_0 = 1.0684e-04
Loss = 5.6108e-02, PNorm = 44.9202, GNorm = 0.5568, lr_0 = 1.0451e-04
Validation rmse = 0.090771
Validation r2 = 0.918135
Validation mse = 0.008239
Epoch 56
Loss = 5.2710e-02, PNorm = 44.9240, GNorm = 0.8762, lr_0 = 1.0200e-04
Loss = 5.1553e-02, PNorm = 44.9280, GNorm = 1.2856, lr_0 = 1.0000e-04
Validation rmse = 0.091289
Validation r2 = 0.917200
Validation mse = 0.008334
Epoch 57
Loss = 5.0797e-02, PNorm = 44.9321, GNorm = 0.4705, lr_0 = 1.0000e-04
Loss = 5.6184e-02, PNorm = 44.9358, GNorm = 1.4976, lr_0 = 1.0000e-04
Validation rmse = 0.098955
Validation r2 = 0.902710
Validation mse = 0.009792
Epoch 58
Loss = 5.1755e-02, PNorm = 44.9394, GNorm = 0.5909, lr_0 = 1.0000e-04
Loss = 5.4914e-02, PNorm = 44.9428, GNorm = 0.8259, lr_0 = 1.0000e-04
Validation rmse = 0.091545
Validation r2 = 0.916734
Validation mse = 0.008380
Epoch 59
Loss = 4.9195e-02, PNorm = 44.9471, GNorm = 0.7867, lr_0 = 1.0000e-04
Validation rmse = 0.088328
Validation r2 = 0.922483
Validation mse = 0.007802
Model 0 best validation rmse = 0.068714 on epoch 38
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.138625
Model 0 test r2 = 0.644589
Model 0 test mse = 0.019217
Ensemble test rmse = 0.138625
Ensemble test r2 = 0.644589
Ensemble test mse = 0.019217
Fold 5
Splitting data with seed 5
Total size = 934 | train size = 924 | val size = 10 | test size = 98
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.8633e-01, PNorm = 43.2634, GNorm = 3.5244, lr_0 = 3.7500e-04
Validation rmse = 0.276751
Validation r2 = 0.190827
Validation mse = 0.076591
Epoch 1
Loss = 6.5512e-01, PNorm = 43.2931, GNorm = 1.5853, lr_0 = 6.5000e-04
Loss = 5.4402e-01, PNorm = 43.3454, GNorm = 3.8490, lr_0 = 9.0000e-04
Validation rmse = 0.305369
Validation r2 = 0.014830
Validation mse = 0.093250
Epoch 2
Loss = 6.2155e-01, PNorm = 43.4281, GNorm = 22.2070, lr_0 = 9.8468e-04
Loss = 3.8038e-01, PNorm = 43.4992, GNorm = 4.9860, lr_0 = 9.6320e-04
Validation rmse = 0.219350
Validation r2 = 0.491679
Validation mse = 0.048114
Epoch 3
Loss = 2.5797e-01, PNorm = 43.5677, GNorm = 0.9989, lr_0 = 9.4219e-04
Loss = 3.3483e-01, PNorm = 43.6309, GNorm = 1.2238, lr_0 = 9.2164e-04
Validation rmse = 0.189194
Validation r2 = 0.621838
Validation mse = 0.035794
Epoch 4
Loss = 2.6559e-01, PNorm = 43.6853, GNorm = 3.9791, lr_0 = 8.9955e-04
Loss = 2.5772e-01, PNorm = 43.7321, GNorm = 8.4509, lr_0 = 8.7992e-04
Validation rmse = 0.176282
Validation r2 = 0.671694
Validation mse = 0.031075
Epoch 5
Loss = 2.1140e-01, PNorm = 43.7681, GNorm = 2.2016, lr_0 = 8.6073e-04
Loss = 2.3385e-01, PNorm = 43.8069, GNorm = 0.9055, lr_0 = 8.4195e-04
Loss = 2.7831e-01, PNorm = 43.8105, GNorm = 6.4206, lr_0 = 8.4010e-04
Validation rmse = 0.174597
Validation r2 = 0.677939
Validation mse = 0.030484
Epoch 6
Loss = 1.6784e-01, PNorm = 43.8451, GNorm = 2.2681, lr_0 = 8.2177e-04
Validation rmse = 0.175432
Validation r2 = 0.674854
Validation mse = 0.030776
Epoch 7
Loss = 1.9663e-01, PNorm = 43.8684, GNorm = 5.4198, lr_0 = 8.0385e-04
Loss = 1.7713e-01, PNorm = 43.8947, GNorm = 7.3829, lr_0 = 7.8631e-04
Validation rmse = 0.136646
Validation r2 = 0.802732
Validation mse = 0.018672
Epoch 8
Loss = 1.7377e-01, PNorm = 43.9238, GNorm = 2.1612, lr_0 = 7.6746e-04
Loss = 1.2886e-01, PNorm = 43.9453, GNorm = 1.0332, lr_0 = 7.5072e-04
Validation rmse = 0.137451
Validation r2 = 0.800400
Validation mse = 0.018893
Epoch 9
Loss = 1.6122e-01, PNorm = 43.9643, GNorm = 5.3958, lr_0 = 7.3435e-04
Loss = 1.5606e-01, PNorm = 43.9854, GNorm = 3.8967, lr_0 = 7.1833e-04
Validation rmse = 0.144538
Validation r2 = 0.779289
Validation mse = 0.020891
Epoch 10
Loss = 1.4107e-01, PNorm = 44.0151, GNorm = 1.6425, lr_0 = 7.0111e-04
Loss = 1.2959e-01, PNorm = 44.0329, GNorm = 1.0429, lr_0 = 6.8581e-04
Validation rmse = 0.146053
Validation r2 = 0.774635
Validation mse = 0.021332
Epoch 11
Loss = 1.3476e-01, PNorm = 44.0512, GNorm = 2.1955, lr_0 = 6.7085e-04
Loss = 1.1767e-01, PNorm = 44.0680, GNorm = 1.5893, lr_0 = 6.5622e-04
Validation rmse = 0.129594
Validation r2 = 0.822569
Validation mse = 0.016794
Epoch 12
Loss = 1.1029e-01, PNorm = 44.0865, GNorm = 1.5185, lr_0 = 6.4049e-04
Loss = 1.4931e-01, PNorm = 44.1048, GNorm = 1.6780, lr_0 = 6.2652e-04
Validation rmse = 0.132872
Validation r2 = 0.813477
Validation mse = 0.017655
Epoch 13
Loss = 1.2482e-01, PNorm = 44.1198, GNorm = 2.1023, lr_0 = 6.1285e-04
Validation rmse = 0.136086
Validation r2 = 0.804346
Validation mse = 0.018519
Epoch 14
Loss = 9.5648e-02, PNorm = 44.1407, GNorm = 1.0452, lr_0 = 5.9816e-04
Loss = 1.0256e-01, PNorm = 44.1583, GNorm = 1.2982, lr_0 = 5.8512e-04
Validation rmse = 0.144928
Validation r2 = 0.778095
Validation mse = 0.021004
Epoch 15
Loss = 9.8696e-02, PNorm = 44.1696, GNorm = 1.3129, lr_0 = 5.7235e-04
Loss = 1.2604e-01, PNorm = 44.1852, GNorm = 0.9705, lr_0 = 5.5987e-04
Validation rmse = 0.154150
Validation r2 = 0.748955
Validation mse = 0.023762
Epoch 16
Loss = 1.2142e-01, PNorm = 44.2009, GNorm = 3.4956, lr_0 = 5.4645e-04
Loss = 1.2131e-01, PNorm = 44.2146, GNorm = 0.8731, lr_0 = 5.3453e-04
Validation rmse = 0.123518
Validation r2 = 0.838816
Validation mse = 0.015257
Epoch 17
Loss = 1.8942e-01, PNorm = 44.2334, GNorm = 3.3392, lr_0 = 5.2287e-04
Loss = 1.4584e-01, PNorm = 44.2577, GNorm = 2.8757, lr_0 = 5.1146e-04
Validation rmse = 0.134800
Validation r2 = 0.808026
Validation mse = 0.018171
Epoch 18
Loss = 8.7918e-02, PNorm = 44.2807, GNorm = 1.6512, lr_0 = 4.9920e-04
Loss = 1.0737e-01, PNorm = 44.2924, GNorm = 1.8287, lr_0 = 4.8831e-04
Validation rmse = 0.148351
Validation r2 = 0.767489
Validation mse = 0.022008
Epoch 19
Loss = 1.2331e-01, PNorm = 44.3032, GNorm = 2.4286, lr_0 = 4.7766e-04
Validation rmse = 0.111547
Validation r2 = 0.868545
Validation mse = 0.012443
Epoch 20
Loss = 1.4966e-01, PNorm = 44.3181, GNorm = 2.1776, lr_0 = 4.6621e-04
Loss = 8.9688e-02, PNorm = 44.3282, GNorm = 0.6176, lr_0 = 4.5604e-04
Validation rmse = 0.114116
Validation r2 = 0.862419
Validation mse = 0.013023
Epoch 21
Loss = 1.0419e-01, PNorm = 44.3431, GNorm = 1.6550, lr_0 = 4.4609e-04
Loss = 9.6145e-02, PNorm = 44.3550, GNorm = 3.6720, lr_0 = 4.3636e-04
Validation rmse = 0.177257
Validation r2 = 0.668051
Validation mse = 0.031420
Epoch 22
Loss = 1.2383e-01, PNorm = 44.3670, GNorm = 0.5574, lr_0 = 4.2590e-04
Loss = 1.0763e-01, PNorm = 44.3797, GNorm = 1.7786, lr_0 = 4.1661e-04
Validation rmse = 0.146632
Validation r2 = 0.772848
Validation mse = 0.021501
Epoch 23
Loss = 9.6135e-02, PNorm = 44.3930, GNorm = 2.3061, lr_0 = 4.0752e-04
Loss = 8.8165e-02, PNorm = 44.4053, GNorm = 2.9761, lr_0 = 3.9863e-04
Validation rmse = 0.149498
Validation r2 = 0.763880
Validation mse = 0.022350
Epoch 24
Loss = 1.1034e-01, PNorm = 44.4154, GNorm = 1.5555, lr_0 = 3.8908e-04
Loss = 7.6956e-02, PNorm = 44.4265, GNorm = 0.5346, lr_0 = 3.8059e-04
Validation rmse = 0.135853
Validation r2 = 0.805016
Validation mse = 0.018456
Epoch 25
Loss = 9.4958e-02, PNorm = 44.4349, GNorm = 3.9374, lr_0 = 3.7229e-04
Loss = 1.0558e-01, PNorm = 44.4453, GNorm = 1.6795, lr_0 = 3.6417e-04
Loss = 1.1247e-01, PNorm = 44.4467, GNorm = 0.9371, lr_0 = 3.6337e-04
Validation rmse = 0.149255
Validation r2 = 0.764646
Validation mse = 0.022277
Epoch 26
Loss = 9.3875e-02, PNorm = 44.4574, GNorm = 3.0985, lr_0 = 3.5544e-04
Validation rmse = 0.127975
Validation r2 = 0.826973
Validation mse = 0.016378
Epoch 27
Loss = 6.1234e-02, PNorm = 44.4685, GNorm = 1.1611, lr_0 = 3.4692e-04
Loss = 9.8260e-02, PNorm = 44.4785, GNorm = 2.3553, lr_0 = 3.3935e-04
Validation rmse = 0.119238
Validation r2 = 0.849792
Validation mse = 0.014218
Epoch 28
Loss = 8.4202e-02, PNorm = 44.4900, GNorm = 2.8552, lr_0 = 3.3195e-04
Loss = 8.0011e-02, PNorm = 44.5011, GNorm = 0.7650, lr_0 = 3.2471e-04
Validation rmse = 0.139351
Validation r2 = 0.794845
Validation mse = 0.019419
Epoch 29
Loss = 8.1570e-02, PNorm = 44.5096, GNorm = 1.5937, lr_0 = 3.1693e-04
Loss = 8.0329e-02, PNorm = 44.5211, GNorm = 0.5551, lr_0 = 3.1001e-04
Validation rmse = 0.113686
Validation r2 = 0.863454
Validation mse = 0.012925
Epoch 30
Loss = 9.8418e-02, PNorm = 44.5308, GNorm = 1.8452, lr_0 = 3.0325e-04
Loss = 7.8352e-02, PNorm = 44.5386, GNorm = 2.6135, lr_0 = 2.9663e-04
Validation rmse = 0.110853
Validation r2 = 0.870175
Validation mse = 0.012288
Epoch 31
Loss = 8.2455e-02, PNorm = 44.5495, GNorm = 1.5253, lr_0 = 2.8952e-04
Loss = 8.0125e-02, PNorm = 44.5584, GNorm = 0.8198, lr_0 = 2.8321e-04
Validation rmse = 0.115669
Validation r2 = 0.858651
Validation mse = 0.013379
Epoch 32
Loss = 7.2256e-02, PNorm = 44.5671, GNorm = 0.8995, lr_0 = 2.7703e-04
Validation rmse = 0.113199
Validation r2 = 0.864621
Validation mse = 0.012814
Epoch 33
Loss = 6.1297e-02, PNorm = 44.5767, GNorm = 2.0701, lr_0 = 2.7039e-04
Loss = 7.6088e-02, PNorm = 44.5852, GNorm = 1.0113, lr_0 = 2.6449e-04
Validation rmse = 0.131336
Validation r2 = 0.817765
Validation mse = 0.017249
Epoch 34
Loss = 6.6564e-02, PNorm = 44.5931, GNorm = 1.0258, lr_0 = 2.5872e-04
Loss = 6.9807e-02, PNorm = 44.6017, GNorm = 2.9222, lr_0 = 2.5308e-04
Validation rmse = 0.131105
Validation r2 = 0.818405
Validation mse = 0.017189
Epoch 35
Loss = 7.6221e-02, PNorm = 44.6112, GNorm = 1.0290, lr_0 = 2.4701e-04
Loss = 7.8997e-02, PNorm = 44.6168, GNorm = 0.6275, lr_0 = 2.4162e-04
Validation rmse = 0.122669
Validation r2 = 0.841023
Validation mse = 0.015048
Epoch 36
Loss = 7.1427e-02, PNorm = 44.6249, GNorm = 0.8577, lr_0 = 2.3635e-04
Loss = 6.8980e-02, PNorm = 44.6308, GNorm = 0.8305, lr_0 = 2.3120e-04
Validation rmse = 0.112765
Validation r2 = 0.865657
Validation mse = 0.012716
Epoch 37
Loss = 6.5383e-02, PNorm = 44.6387, GNorm = 0.8149, lr_0 = 2.2566e-04
Loss = 6.8657e-02, PNorm = 44.6463, GNorm = 1.0322, lr_0 = 2.2073e-04
Validation rmse = 0.122795
Validation r2 = 0.840697
Validation mse = 0.015079
Epoch 38
Loss = 7.2417e-02, PNorm = 44.6559, GNorm = 2.5715, lr_0 = 2.1592e-04
Loss = 7.3687e-02, PNorm = 44.6638, GNorm = 0.7400, lr_0 = 2.1121e-04
Loss = 4.5481e-02, PNorm = 44.6644, GNorm = 2.4034, lr_0 = 2.1074e-04
Validation rmse = 0.103661
Validation r2 = 0.886474
Validation mse = 0.010746
Epoch 39
Loss = 7.1554e-02, PNorm = 44.6714, GNorm = 0.9030, lr_0 = 2.0615e-04
Validation rmse = 0.117695
Validation r2 = 0.853654
Validation mse = 0.013852
Epoch 40
Loss = 4.8395e-02, PNorm = 44.6777, GNorm = 0.9527, lr_0 = 2.0165e-04
Loss = 7.0230e-02, PNorm = 44.6846, GNorm = 1.2432, lr_0 = 1.9725e-04
Validation rmse = 0.107909
Validation r2 = 0.876980
Validation mse = 0.011644
Epoch 41
Loss = 6.6158e-02, PNorm = 44.6914, GNorm = 0.7184, lr_0 = 1.9252e-04
Loss = 5.7762e-02, PNorm = 44.6975, GNorm = 0.6421, lr_0 = 1.8832e-04
Validation rmse = 0.126564
Validation r2 = 0.830769
Validation mse = 0.016018
Epoch 42
Loss = 6.6741e-02, PNorm = 44.7035, GNorm = 0.7255, lr_0 = 1.8422e-04
Loss = 6.0709e-02, PNorm = 44.7098, GNorm = 0.6342, lr_0 = 1.8020e-04
Validation rmse = 0.131838
Validation r2 = 0.816370
Validation mse = 0.017381
Epoch 43
Loss = 7.2377e-02, PNorm = 44.7175, GNorm = 0.5483, lr_0 = 1.7588e-04
Loss = 7.0616e-02, PNorm = 44.7235, GNorm = 2.4390, lr_0 = 1.7204e-04
Validation rmse = 0.107514
Validation r2 = 0.877879
Validation mse = 0.011559
Epoch 44
Loss = 6.1415e-02, PNorm = 44.7300, GNorm = 3.1255, lr_0 = 1.6829e-04
Loss = 8.5943e-02, PNorm = 44.7374, GNorm = 1.8075, lr_0 = 1.6462e-04
Validation rmse = 0.119941
Validation r2 = 0.848016
Validation mse = 0.014386
Epoch 45
Loss = 6.0439e-02, PNorm = 44.7440, GNorm = 1.3809, lr_0 = 1.6067e-04
Loss = 6.6852e-02, PNorm = 44.7498, GNorm = 1.8969, lr_0 = 1.5717e-04
Validation rmse = 0.133264
Validation r2 = 0.812376
Validation mse = 0.017759
Epoch 46
Loss = 6.1550e-02, PNorm = 44.7557, GNorm = 0.6475, lr_0 = 1.5374e-04
Validation rmse = 0.121669
Validation r2 = 0.843606
Validation mse = 0.014803
Epoch 47
Loss = 7.2017e-02, PNorm = 44.7604, GNorm = 1.6394, lr_0 = 1.5005e-04
Loss = 6.0491e-02, PNorm = 44.7657, GNorm = 0.5180, lr_0 = 1.4678e-04
Validation rmse = 0.137671
Validation r2 = 0.799762
Validation mse = 0.018953
Epoch 48
Loss = 7.5626e-02, PNorm = 44.7705, GNorm = 1.6575, lr_0 = 1.4358e-04
Loss = 5.8710e-02, PNorm = 44.7750, GNorm = 0.9110, lr_0 = 1.4045e-04
Validation rmse = 0.123717
Validation r2 = 0.838295
Validation mse = 0.015306
Epoch 49
Loss = 6.2124e-02, PNorm = 44.7806, GNorm = 0.7023, lr_0 = 1.3708e-04
Loss = 5.2980e-02, PNorm = 44.7854, GNorm = 0.9237, lr_0 = 1.3409e-04
Validation rmse = 0.116305
Validation r2 = 0.857092
Validation mse = 0.013527
Epoch 50
Loss = 5.4166e-02, PNorm = 44.7907, GNorm = 0.6340, lr_0 = 1.3116e-04
Loss = 6.1926e-02, PNorm = 44.7956, GNorm = 1.0149, lr_0 = 1.2830e-04
Validation rmse = 0.133566
Validation r2 = 0.811526
Validation mse = 0.017840
Epoch 51
Loss = 6.1024e-02, PNorm = 44.8002, GNorm = 1.1004, lr_0 = 1.2523e-04
Loss = 5.4643e-02, PNorm = 44.8048, GNorm = 1.4438, lr_0 = 1.2250e-04
Loss = 5.1317e-02, PNorm = 44.8050, GNorm = 0.8517, lr_0 = 1.2223e-04
Validation rmse = 0.114008
Validation r2 = 0.862679
Validation mse = 0.012998
Epoch 52
Loss = 5.7094e-02, PNorm = 44.8089, GNorm = 1.4096, lr_0 = 1.1956e-04
Validation rmse = 0.119342
Validation r2 = 0.849530
Validation mse = 0.014243
Epoch 53
Loss = 3.6591e-02, PNorm = 44.8139, GNorm = 0.9932, lr_0 = 1.1695e-04
Loss = 6.2403e-02, PNorm = 44.8196, GNorm = 2.1363, lr_0 = 1.1440e-04
Validation rmse = 0.126858
Validation r2 = 0.829982
Validation mse = 0.016093
Epoch 54
Loss = 3.8130e-02, PNorm = 44.8236, GNorm = 1.7123, lr_0 = 1.1166e-04
Loss = 6.2472e-02, PNorm = 44.8271, GNorm = 0.8108, lr_0 = 1.0922e-04
Validation rmse = 0.126407
Validation r2 = 0.831187
Validation mse = 0.015979
Epoch 55
Loss = 4.9550e-02, PNorm = 44.8307, GNorm = 0.5826, lr_0 = 1.0684e-04
Loss = 5.7557e-02, PNorm = 44.8346, GNorm = 0.7438, lr_0 = 1.0451e-04
Validation rmse = 0.114376
Validation r2 = 0.861793
Validation mse = 0.013082
Epoch 56
Loss = 4.9672e-02, PNorm = 44.8384, GNorm = 1.9114, lr_0 = 1.0200e-04
Loss = 5.5129e-02, PNorm = 44.8419, GNorm = 2.1966, lr_0 = 1.0000e-04
Validation rmse = 0.112100
Validation r2 = 0.867237
Validation mse = 0.012566
Epoch 57
Loss = 5.7311e-02, PNorm = 44.8462, GNorm = 1.2532, lr_0 = 1.0000e-04
Loss = 5.3256e-02, PNorm = 44.8494, GNorm = 1.8511, lr_0 = 1.0000e-04
Validation rmse = 0.112874
Validation r2 = 0.865398
Validation mse = 0.012741
Epoch 58
Loss = 5.3448e-02, PNorm = 44.8531, GNorm = 0.9712, lr_0 = 1.0000e-04
Loss = 5.6142e-02, PNorm = 44.8564, GNorm = 0.9993, lr_0 = 1.0000e-04
Validation rmse = 0.114311
Validation r2 = 0.861949
Validation mse = 0.013067
Epoch 59
Loss = 4.9784e-02, PNorm = 44.8602, GNorm = 1.1075, lr_0 = 1.0000e-04
Validation rmse = 0.144505
Validation r2 = 0.779387
Validation mse = 0.020882
Model 0 best validation rmse = 0.103661 on epoch 38
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.233503
Model 0 test r2 = -0.008408
Model 0 test mse = 0.054524
Ensemble test rmse = 0.233503
Ensemble test r2 = -0.008408
Ensemble test mse = 0.054524
Fold 6
Splitting data with seed 6
Total size = 934 | train size = 924 | val size = 10 | test size = 98
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.4253e-01, PNorm = 43.2614, GNorm = 3.5421, lr_0 = 3.7500e-04
Validation rmse = 0.303857
Validation r2 = 0.082381
Validation mse = 0.092329
Epoch 1
Loss = 7.4285e-01, PNorm = 43.2932, GNorm = 6.3471, lr_0 = 6.5000e-04
Loss = 5.8810e-01, PNorm = 43.3411, GNorm = 3.7384, lr_0 = 9.0000e-04
Validation rmse = 0.252040
Validation r2 = 0.368662
Validation mse = 0.063524
Epoch 2
Loss = 4.3345e-01, PNorm = 43.4278, GNorm = 5.3294, lr_0 = 9.8468e-04
Loss = 4.0024e-01, PNorm = 43.5056, GNorm = 6.7018, lr_0 = 9.6320e-04
Validation rmse = 0.183180
Validation r2 = 0.666514
Validation mse = 0.033555
Epoch 3
Loss = 2.2637e-01, PNorm = 43.5795, GNorm = 2.2591, lr_0 = 9.4219e-04
Loss = 2.8107e-01, PNorm = 43.6469, GNorm = 8.2150, lr_0 = 9.2164e-04
Validation rmse = 0.154757
Validation r2 = 0.761972
Validation mse = 0.023950
Epoch 4
Loss = 2.4521e-01, PNorm = 43.6956, GNorm = 3.0251, lr_0 = 8.9955e-04
Loss = 2.5125e-01, PNorm = 43.7429, GNorm = 6.6800, lr_0 = 8.7992e-04
Validation rmse = 0.180193
Validation r2 = 0.677300
Validation mse = 0.032469
Epoch 5
Loss = 1.9526e-01, PNorm = 43.7864, GNorm = 1.1856, lr_0 = 8.6073e-04
Loss = 1.9831e-01, PNorm = 43.8242, GNorm = 4.7948, lr_0 = 8.4195e-04
Loss = 1.9024e-01, PNorm = 43.8270, GNorm = 1.9001, lr_0 = 8.4010e-04
Validation rmse = 0.164169
Validation r2 = 0.732141
Validation mse = 0.026951
Epoch 6
Loss = 1.8522e-01, PNorm = 43.8580, GNorm = 2.1021, lr_0 = 8.2177e-04
Validation rmse = 0.142469
Validation r2 = 0.798271
Validation mse = 0.020298
Epoch 7
Loss = 2.1900e-01, PNorm = 43.8890, GNorm = 5.0250, lr_0 = 8.0385e-04
Loss = 1.7800e-01, PNorm = 43.9150, GNorm = 3.3484, lr_0 = 7.8631e-04
Validation rmse = 0.165406
Validation r2 = 0.728089
Validation mse = 0.027359
Epoch 8
Loss = 1.9463e-01, PNorm = 43.9478, GNorm = 5.3541, lr_0 = 7.6746e-04
Loss = 2.0003e-01, PNorm = 43.9810, GNorm = 3.6682, lr_0 = 7.5072e-04
Validation rmse = 0.158179
Validation r2 = 0.751331
Validation mse = 0.025021
Epoch 9
Loss = 1.3500e-01, PNorm = 44.0115, GNorm = 0.7635, lr_0 = 7.3435e-04
Loss = 1.4817e-01, PNorm = 44.0426, GNorm = 1.6586, lr_0 = 7.1833e-04
Validation rmse = 0.144344
Validation r2 = 0.792927
Validation mse = 0.020835
Epoch 10
Loss = 1.3941e-01, PNorm = 44.0666, GNorm = 4.1989, lr_0 = 7.0111e-04
Loss = 1.1155e-01, PNorm = 44.0827, GNorm = 2.8504, lr_0 = 6.8581e-04
Validation rmse = 0.149376
Validation r2 = 0.778237
Validation mse = 0.022313
Epoch 11
Loss = 1.2280e-01, PNorm = 44.1002, GNorm = 1.0432, lr_0 = 6.7085e-04
Loss = 1.2191e-01, PNorm = 44.1188, GNorm = 0.5319, lr_0 = 6.5622e-04
Validation rmse = 0.145216
Validation r2 = 0.790420
Validation mse = 0.021088
Epoch 12
Loss = 1.0449e-01, PNorm = 44.1357, GNorm = 0.8828, lr_0 = 6.4049e-04
Loss = 1.2323e-01, PNorm = 44.1506, GNorm = 2.5165, lr_0 = 6.2652e-04
Validation rmse = 0.174382
Validation r2 = 0.697779
Validation mse = 0.030409
Epoch 13
Loss = 1.3293e-01, PNorm = 44.1641, GNorm = 1.9706, lr_0 = 6.1285e-04
Validation rmse = 0.137963
Validation r2 = 0.810831
Validation mse = 0.019034
Epoch 14
Loss = 1.1787e-01, PNorm = 44.1866, GNorm = 0.9908, lr_0 = 5.9816e-04
Loss = 1.1534e-01, PNorm = 44.2029, GNorm = 1.3688, lr_0 = 5.8512e-04
Validation rmse = 0.148122
Validation r2 = 0.781946
Validation mse = 0.021940
Epoch 15
Loss = 9.8293e-02, PNorm = 44.2165, GNorm = 1.1873, lr_0 = 5.7235e-04
Loss = 9.6489e-02, PNorm = 44.2309, GNorm = 1.9094, lr_0 = 5.5987e-04
Validation rmse = 0.138138
Validation r2 = 0.810352
Validation mse = 0.019082
Epoch 16
Loss = 9.6329e-02, PNorm = 44.2477, GNorm = 0.4910, lr_0 = 5.4645e-04
Loss = 1.0795e-01, PNorm = 44.2622, GNorm = 2.4540, lr_0 = 5.3453e-04
Validation rmse = 0.143548
Validation r2 = 0.795206
Validation mse = 0.020606
Epoch 17
Loss = 9.9768e-02, PNorm = 44.2754, GNorm = 1.3496, lr_0 = 5.2287e-04
Loss = 1.0459e-01, PNorm = 44.2920, GNorm = 5.2070, lr_0 = 5.1146e-04
Validation rmse = 0.148398
Validation r2 = 0.781134
Validation mse = 0.022022
Epoch 18
Loss = 1.0163e-01, PNorm = 44.3067, GNorm = 0.8152, lr_0 = 4.9920e-04
Loss = 9.2937e-02, PNorm = 44.3211, GNorm = 1.5402, lr_0 = 4.8831e-04
Validation rmse = 0.140641
Validation r2 = 0.803416
Validation mse = 0.019780
Epoch 19
Loss = 9.9813e-02, PNorm = 44.3381, GNorm = 0.7837, lr_0 = 4.7766e-04
Validation rmse = 0.142419
Validation r2 = 0.798414
Validation mse = 0.020283
Epoch 20
Loss = 1.4561e-01, PNorm = 44.3510, GNorm = 1.3382, lr_0 = 4.6621e-04
Loss = 9.8645e-02, PNorm = 44.3648, GNorm = 2.0726, lr_0 = 4.5604e-04
Validation rmse = 0.150961
Validation r2 = 0.773507
Validation mse = 0.022789
Epoch 21
Loss = 9.1590e-02, PNorm = 44.3782, GNorm = 1.4501, lr_0 = 4.4609e-04
Loss = 9.6272e-02, PNorm = 44.3902, GNorm = 3.0220, lr_0 = 4.3636e-04
Validation rmse = 0.168934
Validation r2 = 0.716366
Validation mse = 0.028539
Epoch 22
Loss = 8.5863e-02, PNorm = 44.4063, GNorm = 1.5805, lr_0 = 4.2590e-04
Loss = 8.8214e-02, PNorm = 44.4199, GNorm = 2.3720, lr_0 = 4.1661e-04
Validation rmse = 0.155763
Validation r2 = 0.758869
Validation mse = 0.024262
Epoch 23
Loss = 9.0099e-02, PNorm = 44.4290, GNorm = 2.1191, lr_0 = 4.0752e-04
Loss = 8.4278e-02, PNorm = 44.4394, GNorm = 0.5172, lr_0 = 3.9863e-04
Validation rmse = 0.152230
Validation r2 = 0.769683
Validation mse = 0.023174
Epoch 24
Loss = 6.3928e-02, PNorm = 44.4512, GNorm = 0.5824, lr_0 = 3.8908e-04
Loss = 9.4710e-02, PNorm = 44.4619, GNorm = 0.9975, lr_0 = 3.8059e-04
Validation rmse = 0.163511
Validation r2 = 0.734285
Validation mse = 0.026736
Epoch 25
Loss = 7.1987e-02, PNorm = 44.4727, GNorm = 1.0559, lr_0 = 3.7229e-04
Loss = 8.5645e-02, PNorm = 44.4843, GNorm = 1.6849, lr_0 = 3.6417e-04
Loss = 9.3396e-02, PNorm = 44.4852, GNorm = 3.0113, lr_0 = 3.6337e-04
Validation rmse = 0.163746
Validation r2 = 0.733520
Validation mse = 0.026813
Epoch 26
Loss = 7.5685e-02, PNorm = 44.4945, GNorm = 0.9765, lr_0 = 3.5544e-04
Validation rmse = 0.161423
Validation r2 = 0.741027
Validation mse = 0.026057
Epoch 27
Loss = 6.0844e-02, PNorm = 44.5060, GNorm = 2.1139, lr_0 = 3.4692e-04
Loss = 7.8356e-02, PNorm = 44.5183, GNorm = 3.0199, lr_0 = 3.3935e-04
Validation rmse = 0.199129
Validation r2 = 0.605913
Validation mse = 0.039652
Epoch 28
Loss = 1.3732e-01, PNorm = 44.5281, GNorm = 4.1961, lr_0 = 3.3195e-04
Loss = 8.9902e-02, PNorm = 44.5420, GNorm = 1.0876, lr_0 = 3.2471e-04
Validation rmse = 0.166106
Validation r2 = 0.725784
Validation mse = 0.027591
Epoch 29
Loss = 6.0806e-02, PNorm = 44.5553, GNorm = 0.6795, lr_0 = 3.1693e-04
Loss = 8.5742e-02, PNorm = 44.5655, GNorm = 0.5948, lr_0 = 3.1001e-04
Validation rmse = 0.169924
Validation r2 = 0.713031
Validation mse = 0.028874
Epoch 30
Loss = 6.9817e-02, PNorm = 44.5767, GNorm = 1.0372, lr_0 = 3.0325e-04
Loss = 8.6650e-02, PNorm = 44.5871, GNorm = 1.1455, lr_0 = 2.9663e-04
Validation rmse = 0.170178
Validation r2 = 0.712175
Validation mse = 0.028960
Epoch 31
Loss = 6.2893e-02, PNorm = 44.5965, GNorm = 1.9321, lr_0 = 2.8952e-04
Loss = 9.1651e-02, PNorm = 44.6053, GNorm = 1.8647, lr_0 = 2.8321e-04
Validation rmse = 0.177079
Validation r2 = 0.688356
Validation mse = 0.031357
Epoch 32
Loss = 7.8948e-02, PNorm = 44.6146, GNorm = 1.3564, lr_0 = 2.7703e-04
Validation rmse = 0.170218
Validation r2 = 0.712039
Validation mse = 0.028974
Epoch 33
Loss = 6.2746e-02, PNorm = 44.6233, GNorm = 0.6664, lr_0 = 2.7039e-04
Loss = 7.0884e-02, PNorm = 44.6318, GNorm = 1.0562, lr_0 = 2.6449e-04
Validation rmse = 0.166780
Validation r2 = 0.723552
Validation mse = 0.027816
Epoch 34
Loss = 6.0612e-02, PNorm = 44.6398, GNorm = 0.8945, lr_0 = 2.5872e-04
Loss = 6.3995e-02, PNorm = 44.6485, GNorm = 0.4442, lr_0 = 2.5308e-04
Validation rmse = 0.171519
Validation r2 = 0.707619
Validation mse = 0.029419
Epoch 35
Loss = 8.1230e-02, PNorm = 44.6577, GNorm = 0.4739, lr_0 = 2.4701e-04
Loss = 6.8970e-02, PNorm = 44.6646, GNorm = 1.0154, lr_0 = 2.4162e-04
Validation rmse = 0.176271
Validation r2 = 0.691195
Validation mse = 0.031071
Epoch 36
Loss = 7.2541e-02, PNorm = 44.6731, GNorm = 1.0184, lr_0 = 2.3635e-04
Loss = 6.5496e-02, PNorm = 44.6816, GNorm = 0.9731, lr_0 = 2.3120e-04
Validation rmse = 0.163676
Validation r2 = 0.733747
Validation mse = 0.026790
Epoch 37
Loss = 5.8629e-02, PNorm = 44.6898, GNorm = 0.7685, lr_0 = 2.2566e-04
Loss = 6.8055e-02, PNorm = 44.6964, GNorm = 2.7601, lr_0 = 2.2073e-04
Validation rmse = 0.170637
Validation r2 = 0.710618
Validation mse = 0.029117
Epoch 38
Loss = 5.7630e-02, PNorm = 44.7037, GNorm = 1.4440, lr_0 = 2.1592e-04
Loss = 6.9584e-02, PNorm = 44.7115, GNorm = 1.0396, lr_0 = 2.1121e-04
Loss = 9.3049e-02, PNorm = 44.7120, GNorm = 1.6126, lr_0 = 2.1074e-04
Validation rmse = 0.173161
Validation r2 = 0.701993
Validation mse = 0.029985
Epoch 39
Loss = 6.3494e-02, PNorm = 44.7175, GNorm = 0.8091, lr_0 = 2.0615e-04
Validation rmse = 0.173633
Validation r2 = 0.700367
Validation mse = 0.030148
Epoch 40
Loss = 5.8575e-02, PNorm = 44.7249, GNorm = 1.0302, lr_0 = 2.0165e-04
Loss = 6.7563e-02, PNorm = 44.7320, GNorm = 1.8025, lr_0 = 1.9725e-04
Validation rmse = 0.177441
Validation r2 = 0.687083
Validation mse = 0.031485
Epoch 41
Loss = 7.0728e-02, PNorm = 44.7400, GNorm = 1.6571, lr_0 = 1.9252e-04
Loss = 6.1500e-02, PNorm = 44.7474, GNorm = 1.8223, lr_0 = 1.8832e-04
Validation rmse = 0.179931
Validation r2 = 0.678237
Validation mse = 0.032375
Epoch 42
Loss = 6.1856e-02, PNorm = 44.7528, GNorm = 1.0161, lr_0 = 1.8422e-04
Loss = 5.1899e-02, PNorm = 44.7593, GNorm = 1.5829, lr_0 = 1.8020e-04
Validation rmse = 0.174781
Validation r2 = 0.696394
Validation mse = 0.030548
Epoch 43
Loss = 6.1485e-02, PNorm = 44.7673, GNorm = 0.5194, lr_0 = 1.7588e-04
Loss = 6.0688e-02, PNorm = 44.7735, GNorm = 0.9910, lr_0 = 1.7204e-04
Validation rmse = 0.169803
Validation r2 = 0.713439
Validation mse = 0.028833
Epoch 44
Loss = 6.2951e-02, PNorm = 44.7788, GNorm = 0.7413, lr_0 = 1.6829e-04
Loss = 5.5706e-02, PNorm = 44.7848, GNorm = 0.6199, lr_0 = 1.6462e-04
Validation rmse = 0.181653
Validation r2 = 0.672048
Validation mse = 0.032998
Epoch 45
Loss = 5.8707e-02, PNorm = 44.7904, GNorm = 0.6785, lr_0 = 1.6067e-04
Loss = 5.7058e-02, PNorm = 44.7957, GNorm = 1.5906, lr_0 = 1.5717e-04
Validation rmse = 0.177702
Validation r2 = 0.686161
Validation mse = 0.031578
Epoch 46
Loss = 5.4838e-02, PNorm = 44.8017, GNorm = 0.6326, lr_0 = 1.5374e-04
Validation rmse = 0.178071
Validation r2 = 0.684854
Validation mse = 0.031709
Epoch 47
Loss = 4.9554e-02, PNorm = 44.8084, GNorm = 0.6642, lr_0 = 1.5005e-04
Loss = 5.4591e-02, PNorm = 44.8136, GNorm = 0.5969, lr_0 = 1.4678e-04
Validation rmse = 0.188789
Validation r2 = 0.645777
Validation mse = 0.035641
Epoch 48
Loss = 5.1197e-02, PNorm = 44.8186, GNorm = 1.0175, lr_0 = 1.4358e-04
Loss = 5.2395e-02, PNorm = 44.8238, GNorm = 0.5106, lr_0 = 1.4045e-04
Validation rmse = 0.182432
Validation r2 = 0.669231
Validation mse = 0.033281
Epoch 49
Loss = 6.4319e-02, PNorm = 44.8298, GNorm = 1.4781, lr_0 = 1.3708e-04
Loss = 5.3430e-02, PNorm = 44.8343, GNorm = 0.5825, lr_0 = 1.3409e-04
Validation rmse = 0.181449
Validation r2 = 0.672783
Validation mse = 0.032924
Epoch 50
Loss = 4.7638e-02, PNorm = 44.8391, GNorm = 0.5574, lr_0 = 1.3116e-04
Loss = 5.5147e-02, PNorm = 44.8434, GNorm = 1.6993, lr_0 = 1.2830e-04
Validation rmse = 0.177359
Validation r2 = 0.687370
Validation mse = 0.031456
Epoch 51
Loss = 4.7680e-02, PNorm = 44.8502, GNorm = 1.3285, lr_0 = 1.2523e-04
Loss = 5.7318e-02, PNorm = 44.8546, GNorm = 0.9936, lr_0 = 1.2250e-04
Loss = 3.4549e-02, PNorm = 44.8550, GNorm = 0.8328, lr_0 = 1.2223e-04
Validation rmse = 0.186115
Validation r2 = 0.655739
Validation mse = 0.034639
Epoch 52
Loss = 4.9438e-02, PNorm = 44.8582, GNorm = 0.6786, lr_0 = 1.1956e-04
Validation rmse = 0.179913
Validation r2 = 0.678302
Validation mse = 0.032369
Epoch 53
Loss = 6.2622e-02, PNorm = 44.8626, GNorm = 1.0985, lr_0 = 1.1695e-04
Loss = 5.5550e-02, PNorm = 44.8671, GNorm = 1.1668, lr_0 = 1.1440e-04
Validation rmse = 0.182912
Validation r2 = 0.667487
Validation mse = 0.033457
Epoch 54
Loss = 5.3750e-02, PNorm = 44.8726, GNorm = 0.8886, lr_0 = 1.1166e-04
Loss = 5.3823e-02, PNorm = 44.8772, GNorm = 0.9102, lr_0 = 1.0922e-04
Validation rmse = 0.183452
Validation r2 = 0.665519
Validation mse = 0.033655
Epoch 55
Loss = 6.2425e-02, PNorm = 44.8810, GNorm = 1.9144, lr_0 = 1.0684e-04
Loss = 5.2609e-02, PNorm = 44.8851, GNorm = 1.8675, lr_0 = 1.0451e-04
Validation rmse = 0.177730
Validation r2 = 0.686061
Validation mse = 0.031588
Epoch 56
Loss = 4.9153e-02, PNorm = 44.8891, GNorm = 0.7883, lr_0 = 1.0200e-04
Loss = 5.0192e-02, PNorm = 44.8929, GNorm = 0.6404, lr_0 = 1.0000e-04
Validation rmse = 0.182368
Validation r2 = 0.669460
Validation mse = 0.033258
Epoch 57
Loss = 4.1330e-02, PNorm = 44.8967, GNorm = 0.4694, lr_0 = 1.0000e-04
Loss = 5.4283e-02, PNorm = 44.9001, GNorm = 0.8601, lr_0 = 1.0000e-04
Validation rmse = 0.181311
Validation r2 = 0.673283
Validation mse = 0.032874
Epoch 58
Loss = 5.5573e-02, PNorm = 44.9056, GNorm = 0.9977, lr_0 = 1.0000e-04
Loss = 4.0170e-02, PNorm = 44.9095, GNorm = 0.5955, lr_0 = 1.0000e-04
Validation rmse = 0.175304
Validation r2 = 0.694572
Validation mse = 0.030732
Epoch 59
Loss = 4.7164e-02, PNorm = 44.9129, GNorm = 1.0813, lr_0 = 1.0000e-04
Validation rmse = 0.180967
Validation r2 = 0.674521
Validation mse = 0.032749
Model 0 best validation rmse = 0.137963 on epoch 13
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.183354
Model 0 test r2 = 0.378232
Model 0 test mse = 0.033619
Ensemble test rmse = 0.183354
Ensemble test r2 = 0.378232
Ensemble test mse = 0.033619
Fold 7
Splitting data with seed 7
Total size = 934 | train size = 924 | val size = 10 | test size = 98
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.6324e-01, PNorm = 43.2608, GNorm = 2.0419, lr_0 = 3.7500e-04
Validation rmse = 0.334902
Validation r2 = -0.084070
Validation mse = 0.112159
Epoch 1
Loss = 6.4811e-01, PNorm = 43.2920, GNorm = 9.3003, lr_0 = 6.5000e-04
Loss = 7.2881e-01, PNorm = 43.3288, GNorm = 3.3165, lr_0 = 9.0000e-04
Validation rmse = 0.295857
Validation r2 = 0.153971
Validation mse = 0.087531
Epoch 2
Loss = 5.9736e-01, PNorm = 43.4081, GNorm = 2.7534, lr_0 = 9.8468e-04
Loss = 4.7510e-01, PNorm = 43.4917, GNorm = 3.4316, lr_0 = 9.6320e-04
Validation rmse = 0.180777
Validation r2 = 0.684130
Validation mse = 0.032680
Epoch 3
Loss = 3.6954e-01, PNorm = 43.5678, GNorm = 3.1788, lr_0 = 9.4219e-04
Loss = 2.7383e-01, PNorm = 43.6367, GNorm = 2.0647, lr_0 = 9.2164e-04
Validation rmse = 0.130708
Validation r2 = 0.834870
Validation mse = 0.017085
Epoch 4
Loss = 1.9616e-01, PNorm = 43.6973, GNorm = 5.7169, lr_0 = 8.9955e-04
Loss = 2.7668e-01, PNorm = 43.7452, GNorm = 3.0905, lr_0 = 8.7992e-04
Validation rmse = 0.127184
Validation r2 = 0.843655
Validation mse = 0.016176
Epoch 5
Loss = 2.2031e-01, PNorm = 43.7876, GNorm = 1.4149, lr_0 = 8.6073e-04
Loss = 1.8121e-01, PNorm = 43.8343, GNorm = 3.5919, lr_0 = 8.4195e-04
Loss = 1.4205e-01, PNorm = 43.8368, GNorm = 1.0172, lr_0 = 8.4010e-04
Validation rmse = 0.111455
Validation r2 = 0.879935
Validation mse = 0.012422
Epoch 6
Loss = 2.0672e-01, PNorm = 43.8674, GNorm = 4.0093, lr_0 = 8.2177e-04
Validation rmse = 0.100070
Validation r2 = 0.903211
Validation mse = 0.010014
Epoch 7
Loss = 1.1944e-01, PNorm = 43.9045, GNorm = 0.8618, lr_0 = 8.0385e-04
Loss = 1.7619e-01, PNorm = 43.9378, GNorm = 2.1489, lr_0 = 7.8631e-04
Validation rmse = 0.103874
Validation r2 = 0.895711
Validation mse = 0.010790
Epoch 8
Loss = 1.8095e-01, PNorm = 43.9673, GNorm = 3.6040, lr_0 = 7.6746e-04
Loss = 1.4488e-01, PNorm = 43.9944, GNorm = 2.2722, lr_0 = 7.5072e-04
Validation rmse = 0.085412
Validation r2 = 0.929489
Validation mse = 0.007295
Epoch 9
Loss = 1.4475e-01, PNorm = 44.0257, GNorm = 2.5991, lr_0 = 7.3435e-04
Loss = 1.3473e-01, PNorm = 44.0451, GNorm = 3.6689, lr_0 = 7.1833e-04
Validation rmse = 0.095139
Validation r2 = 0.912513
Validation mse = 0.009051
Epoch 10
Loss = 1.2963e-01, PNorm = 44.0697, GNorm = 3.7706, lr_0 = 7.0111e-04
Loss = 1.3431e-01, PNorm = 44.0934, GNorm = 1.8691, lr_0 = 6.8581e-04
Validation rmse = 0.076028
Validation r2 = 0.944132
Validation mse = 0.005780
Epoch 11
Loss = 1.3549e-01, PNorm = 44.1149, GNorm = 1.5747, lr_0 = 6.7085e-04
Loss = 1.2860e-01, PNorm = 44.1395, GNorm = 1.8423, lr_0 = 6.5622e-04
Validation rmse = 0.074409
Validation r2 = 0.946485
Validation mse = 0.005537
Epoch 12
Loss = 1.0322e-01, PNorm = 44.1622, GNorm = 0.8775, lr_0 = 6.4049e-04
Loss = 1.3270e-01, PNorm = 44.1802, GNorm = 3.2835, lr_0 = 6.2652e-04
Validation rmse = 0.071218
Validation r2 = 0.950977
Validation mse = 0.005072
Epoch 13
Loss = 1.0058e-01, PNorm = 44.1997, GNorm = 0.9621, lr_0 = 6.1285e-04
Validation rmse = 0.078849
Validation r2 = 0.939908
Validation mse = 0.006217
Epoch 14
Loss = 1.3187e-01, PNorm = 44.2176, GNorm = 2.3618, lr_0 = 5.9816e-04
Loss = 1.1466e-01, PNorm = 44.2332, GNorm = 1.1299, lr_0 = 5.8512e-04
Validation rmse = 0.073747
Validation r2 = 0.947433
Validation mse = 0.005439
Epoch 15
Loss = 1.4022e-01, PNorm = 44.2482, GNorm = 4.1849, lr_0 = 5.7235e-04
Loss = 1.1642e-01, PNorm = 44.2690, GNorm = 3.3639, lr_0 = 5.5987e-04
Validation rmse = 0.065905
Validation r2 = 0.958019
Validation mse = 0.004343
Epoch 16
Loss = 9.4493e-02, PNorm = 44.2866, GNorm = 0.6310, lr_0 = 5.4645e-04
Loss = 1.1381e-01, PNorm = 44.2998, GNorm = 1.2168, lr_0 = 5.3453e-04
Validation rmse = 0.071651
Validation r2 = 0.950379
Validation mse = 0.005134
Epoch 17
Loss = 1.1353e-01, PNorm = 44.3150, GNorm = 1.7130, lr_0 = 5.2287e-04
Loss = 9.7987e-02, PNorm = 44.3317, GNorm = 1.9295, lr_0 = 5.1146e-04
Validation rmse = 0.068497
Validation r2 = 0.954651
Validation mse = 0.004692
Epoch 18
Loss = 1.0828e-01, PNorm = 44.3495, GNorm = 3.3399, lr_0 = 4.9920e-04
Loss = 1.2586e-01, PNorm = 44.3638, GNorm = 1.0469, lr_0 = 4.8831e-04
Validation rmse = 0.116109
Validation r2 = 0.869697
Validation mse = 0.013481
Epoch 19
Loss = 1.2450e-01, PNorm = 44.3846, GNorm = 3.7624, lr_0 = 4.7766e-04
Validation rmse = 0.071170
Validation r2 = 0.951043
Validation mse = 0.005065
Epoch 20
Loss = 8.5681e-02, PNorm = 44.4063, GNorm = 0.9068, lr_0 = 4.6621e-04
Loss = 9.7409e-02, PNorm = 44.4253, GNorm = 2.3672, lr_0 = 4.5604e-04
Validation rmse = 0.064550
Validation r2 = 0.959727
Validation mse = 0.004167
Epoch 21
Loss = 1.0845e-01, PNorm = 44.4410, GNorm = 2.4308, lr_0 = 4.4609e-04
Loss = 9.0215e-02, PNorm = 44.4545, GNorm = 1.5198, lr_0 = 4.3636e-04
Validation rmse = 0.064052
Validation r2 = 0.960346
Validation mse = 0.004103
Epoch 22
Loss = 8.3554e-02, PNorm = 44.4718, GNorm = 1.2999, lr_0 = 4.2590e-04
Loss = 9.4339e-02, PNorm = 44.4854, GNorm = 0.5035, lr_0 = 4.1661e-04
Validation rmse = 0.074058
Validation r2 = 0.946989
Validation mse = 0.005485
Epoch 23
Loss = 6.9452e-02, PNorm = 44.4984, GNorm = 0.5123, lr_0 = 4.0752e-04
Loss = 8.9765e-02, PNorm = 44.5093, GNorm = 1.2820, lr_0 = 3.9863e-04
Validation rmse = 0.075192
Validation r2 = 0.945353
Validation mse = 0.005654
Epoch 24
Loss = 7.5559e-02, PNorm = 44.5220, GNorm = 0.9356, lr_0 = 3.8908e-04
Loss = 9.0430e-02, PNorm = 44.5325, GNorm = 1.3072, lr_0 = 3.8059e-04
Validation rmse = 0.066632
Validation r2 = 0.957087
Validation mse = 0.004440
Epoch 25
Loss = 7.8723e-02, PNorm = 44.5452, GNorm = 0.8133, lr_0 = 3.7229e-04
Loss = 8.5430e-02, PNorm = 44.5579, GNorm = 2.8623, lr_0 = 3.6417e-04
Loss = 7.7085e-02, PNorm = 44.5589, GNorm = 1.0462, lr_0 = 3.6337e-04
Validation rmse = 0.063863
Validation r2 = 0.960580
Validation mse = 0.004078
Epoch 26
Loss = 8.8762e-02, PNorm = 44.5693, GNorm = 1.4551, lr_0 = 3.5544e-04
Validation rmse = 0.065715
Validation r2 = 0.958260
Validation mse = 0.004318
Epoch 27
Loss = 7.4469e-02, PNorm = 44.5849, GNorm = 0.4709, lr_0 = 3.4692e-04
Loss = 9.0794e-02, PNorm = 44.5970, GNorm = 4.0211, lr_0 = 3.3935e-04
Validation rmse = 0.051729
Validation r2 = 0.974136
Validation mse = 0.002676
Epoch 28
Loss = 8.1524e-02, PNorm = 44.6059, GNorm = 2.4403, lr_0 = 3.3195e-04
Loss = 1.0250e-01, PNorm = 44.6194, GNorm = 3.1551, lr_0 = 3.2471e-04
Validation rmse = 0.051769
Validation r2 = 0.974096
Validation mse = 0.002680
Epoch 29
Loss = 8.2884e-02, PNorm = 44.6304, GNorm = 0.7857, lr_0 = 3.1693e-04
Loss = 8.8881e-02, PNorm = 44.6423, GNorm = 1.2015, lr_0 = 3.1001e-04
Validation rmse = 0.039918
Validation r2 = 0.984599
Validation mse = 0.001593
Epoch 30
Loss = 8.7713e-02, PNorm = 44.6550, GNorm = 1.9412, lr_0 = 3.0325e-04
Loss = 7.2286e-02, PNorm = 44.6651, GNorm = 1.7285, lr_0 = 2.9663e-04
Validation rmse = 0.064341
Validation r2 = 0.959988
Validation mse = 0.004140
Epoch 31
Loss = 8.6116e-02, PNorm = 44.6764, GNorm = 1.8307, lr_0 = 2.8952e-04
Loss = 7.6774e-02, PNorm = 44.6841, GNorm = 1.3474, lr_0 = 2.8321e-04
Validation rmse = 0.060327
Validation r2 = 0.964824
Validation mse = 0.003639
Epoch 32
Loss = 7.5361e-02, PNorm = 44.6926, GNorm = 0.8488, lr_0 = 2.7703e-04
Validation rmse = 0.064321
Validation r2 = 0.960012
Validation mse = 0.004137
Epoch 33
Loss = 9.1828e-02, PNorm = 44.7036, GNorm = 0.7532, lr_0 = 2.7039e-04
Loss = 6.8416e-02, PNorm = 44.7125, GNorm = 0.4562, lr_0 = 2.6449e-04
Validation rmse = 0.060260
Validation r2 = 0.964902
Validation mse = 0.003631
Epoch 34
Loss = 5.3344e-02, PNorm = 44.7201, GNorm = 1.5463, lr_0 = 2.5872e-04
Loss = 7.8770e-02, PNorm = 44.7282, GNorm = 0.7201, lr_0 = 2.5308e-04
Validation rmse = 0.066726
Validation r2 = 0.956967
Validation mse = 0.004452
Epoch 35
Loss = 8.5343e-02, PNorm = 44.7365, GNorm = 0.8862, lr_0 = 2.4701e-04
Loss = 6.4850e-02, PNorm = 44.7452, GNorm = 0.7965, lr_0 = 2.4162e-04
Validation rmse = 0.059647
Validation r2 = 0.965613
Validation mse = 0.003558
Epoch 36
Loss = 6.0415e-02, PNorm = 44.7524, GNorm = 0.5687, lr_0 = 2.3635e-04
Loss = 7.4238e-02, PNorm = 44.7603, GNorm = 0.9464, lr_0 = 2.3120e-04
Validation rmse = 0.068810
Validation r2 = 0.954236
Validation mse = 0.004735
Epoch 37
Loss = 7.7826e-02, PNorm = 44.7687, GNorm = 3.2033, lr_0 = 2.2566e-04
Loss = 7.0630e-02, PNorm = 44.7772, GNorm = 2.2367, lr_0 = 2.2073e-04
Validation rmse = 0.054322
Validation r2 = 0.971479
Validation mse = 0.002951
Epoch 38
Loss = 6.6928e-02, PNorm = 44.7838, GNorm = 0.6974, lr_0 = 2.1592e-04
Loss = 6.3285e-02, PNorm = 44.7910, GNorm = 1.8353, lr_0 = 2.1121e-04
Loss = 6.0863e-02, PNorm = 44.7918, GNorm = 0.9082, lr_0 = 2.1074e-04
Validation rmse = 0.055253
Validation r2 = 0.970492
Validation mse = 0.003053
Epoch 39
Loss = 6.2246e-02, PNorm = 44.7997, GNorm = 1.1144, lr_0 = 2.0615e-04
Validation rmse = 0.070777
Validation r2 = 0.951581
Validation mse = 0.005009
Epoch 40
Loss = 6.7478e-02, PNorm = 44.8054, GNorm = 1.3570, lr_0 = 2.0165e-04
Loss = 7.1298e-02, PNorm = 44.8113, GNorm = 1.7959, lr_0 = 1.9725e-04
Validation rmse = 0.055120
Validation r2 = 0.970634
Validation mse = 0.003038
Epoch 41
Loss = 5.9733e-02, PNorm = 44.8201, GNorm = 1.6461, lr_0 = 1.9252e-04
Loss = 6.4471e-02, PNorm = 44.8271, GNorm = 0.9361, lr_0 = 1.8832e-04
Validation rmse = 0.064327
Validation r2 = 0.960004
Validation mse = 0.004138
Epoch 42
Loss = 6.0318e-02, PNorm = 44.8340, GNorm = 0.8474, lr_0 = 1.8422e-04
Loss = 6.9228e-02, PNorm = 44.8407, GNorm = 1.4434, lr_0 = 1.8020e-04
Validation rmse = 0.060127
Validation r2 = 0.965056
Validation mse = 0.003615
Epoch 43
Loss = 7.2902e-02, PNorm = 44.8481, GNorm = 1.8572, lr_0 = 1.7588e-04
Loss = 6.2531e-02, PNorm = 44.8537, GNorm = 1.5944, lr_0 = 1.7204e-04
Validation rmse = 0.052922
Validation r2 = 0.972930
Validation mse = 0.002801
Epoch 44
Loss = 5.3355e-02, PNorm = 44.8593, GNorm = 0.4843, lr_0 = 1.6829e-04
Loss = 6.5910e-02, PNorm = 44.8644, GNorm = 1.7314, lr_0 = 1.6462e-04
Validation rmse = 0.053712
Validation r2 = 0.972115
Validation mse = 0.002885
Epoch 45
Loss = 6.2557e-02, PNorm = 44.8714, GNorm = 1.3731, lr_0 = 1.6067e-04
Loss = 5.7519e-02, PNorm = 44.8771, GNorm = 0.7560, lr_0 = 1.5717e-04
Validation rmse = 0.063008
Validation r2 = 0.961628
Validation mse = 0.003970
Epoch 46
Loss = 6.4529e-02, PNorm = 44.8837, GNorm = 0.5766, lr_0 = 1.5374e-04
Validation rmse = 0.052657
Validation r2 = 0.973200
Validation mse = 0.002773
Epoch 47
Loss = 5.8880e-02, PNorm = 44.8904, GNorm = 1.6271, lr_0 = 1.5005e-04
Loss = 5.6846e-02, PNorm = 44.8960, GNorm = 1.2356, lr_0 = 1.4678e-04
Validation rmse = 0.055376
Validation r2 = 0.970361
Validation mse = 0.003067
Epoch 48
Loss = 4.4727e-02, PNorm = 44.9004, GNorm = 0.8583, lr_0 = 1.4358e-04
Loss = 5.7146e-02, PNorm = 44.9048, GNorm = 0.6486, lr_0 = 1.4045e-04
Validation rmse = 0.046977
Validation r2 = 0.978670
Validation mse = 0.002207
Epoch 49
Loss = 5.9261e-02, PNorm = 44.9111, GNorm = 0.8595, lr_0 = 1.3708e-04
Loss = 5.2440e-02, PNorm = 44.9162, GNorm = 0.8657, lr_0 = 1.3409e-04
Validation rmse = 0.053710
Validation r2 = 0.972118
Validation mse = 0.002885
Epoch 50
Loss = 4.6207e-02, PNorm = 44.9209, GNorm = 1.0702, lr_0 = 1.3116e-04
Loss = 5.7242e-02, PNorm = 44.9259, GNorm = 1.5882, lr_0 = 1.2830e-04
Validation rmse = 0.061939
Validation r2 = 0.962919
Validation mse = 0.003836
Epoch 51
Loss = 5.2504e-02, PNorm = 44.9318, GNorm = 1.6308, lr_0 = 1.2523e-04
Loss = 5.8088e-02, PNorm = 44.9360, GNorm = 0.7766, lr_0 = 1.2250e-04
Loss = 4.4089e-02, PNorm = 44.9365, GNorm = 0.8735, lr_0 = 1.2223e-04
Validation rmse = 0.055849
Validation r2 = 0.969852
Validation mse = 0.003119
Epoch 52
Loss = 4.9901e-02, PNorm = 44.9420, GNorm = 1.0189, lr_0 = 1.1956e-04
Validation rmse = 0.051948
Validation r2 = 0.973917
Validation mse = 0.002699
Epoch 53
Loss = 4.4772e-02, PNorm = 44.9461, GNorm = 0.9621, lr_0 = 1.1695e-04
Loss = 5.0677e-02, PNorm = 44.9500, GNorm = 1.4898, lr_0 = 1.1440e-04
Validation rmse = 0.060985
Validation r2 = 0.964052
Validation mse = 0.003719
Epoch 54
Loss = 4.8896e-02, PNorm = 44.9555, GNorm = 0.6572, lr_0 = 1.1166e-04
Loss = 5.2673e-02, PNorm = 44.9592, GNorm = 0.5909, lr_0 = 1.0922e-04
Validation rmse = 0.061219
Validation r2 = 0.963776
Validation mse = 0.003748
Epoch 55
Loss = 7.1943e-02, PNorm = 44.9638, GNorm = 2.5504, lr_0 = 1.0684e-04
Loss = 4.8173e-02, PNorm = 44.9685, GNorm = 1.2612, lr_0 = 1.0451e-04
Validation rmse = 0.071530
Validation r2 = 0.950546
Validation mse = 0.005117
Epoch 56
Loss = 5.3130e-02, PNorm = 44.9731, GNorm = 1.1557, lr_0 = 1.0200e-04
Loss = 5.5245e-02, PNorm = 44.9772, GNorm = 0.5031, lr_0 = 1.0000e-04
Validation rmse = 0.045533
Validation r2 = 0.979961
Validation mse = 0.002073
Epoch 57
Loss = 5.4003e-02, PNorm = 44.9806, GNorm = 0.7045, lr_0 = 1.0000e-04
Loss = 5.0861e-02, PNorm = 44.9853, GNorm = 0.9030, lr_0 = 1.0000e-04
Validation rmse = 0.051616
Validation r2 = 0.974250
Validation mse = 0.002664
Epoch 58
Loss = 4.4934e-02, PNorm = 44.9893, GNorm = 1.2945, lr_0 = 1.0000e-04
Loss = 5.6142e-02, PNorm = 44.9925, GNorm = 0.8820, lr_0 = 1.0000e-04
Validation rmse = 0.057999
Validation r2 = 0.967486
Validation mse = 0.003364
Epoch 59
Loss = 4.6754e-02, PNorm = 44.9969, GNorm = 0.4799, lr_0 = 1.0000e-04
Validation rmse = 0.060240
Validation r2 = 0.964926
Validation mse = 0.003629
Model 0 best validation rmse = 0.039918 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.166189
Model 0 test r2 = 0.489197
Model 0 test mse = 0.027619
Ensemble test rmse = 0.166189
Ensemble test r2 = 0.489197
Ensemble test mse = 0.027619
Fold 8
Splitting data with seed 8
Total size = 934 | train size = 924 | val size = 10 | test size = 98
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.3490e-01, PNorm = 43.2668, GNorm = 1.4548, lr_0 = 3.7500e-04
Validation rmse = 0.355725
Validation r2 = -0.115631
Validation mse = 0.126540
Epoch 1
Loss = 7.2152e-01, PNorm = 43.2901, GNorm = 0.9984, lr_0 = 6.5000e-04
Loss = 6.9447e-01, PNorm = 43.3338, GNorm = 2.8189, lr_0 = 9.0000e-04
Validation rmse = 0.286455
Validation r2 = 0.276560
Validation mse = 0.082056
Epoch 2
Loss = 5.9020e-01, PNorm = 43.4254, GNorm = 3.6288, lr_0 = 9.8468e-04
Loss = 5.0347e-01, PNorm = 43.5046, GNorm = 1.6863, lr_0 = 9.6320e-04
Validation rmse = 0.230796
Validation r2 = 0.530378
Validation mse = 0.053267
Epoch 3
Loss = 3.2463e-01, PNorm = 43.5793, GNorm = 4.6678, lr_0 = 9.4219e-04
Loss = 3.0767e-01, PNorm = 43.6480, GNorm = 1.2287, lr_0 = 9.2164e-04
Validation rmse = 0.192244
Validation r2 = 0.674164
Validation mse = 0.036958
Epoch 4
Loss = 2.6213e-01, PNorm = 43.7151, GNorm = 1.8518, lr_0 = 8.9955e-04
Loss = 2.5902e-01, PNorm = 43.7703, GNorm = 6.5477, lr_0 = 8.7992e-04
Validation rmse = 0.234924
Validation r2 = 0.513428
Validation mse = 0.055189
Epoch 5
Loss = 2.0616e-01, PNorm = 43.8150, GNorm = 1.1800, lr_0 = 8.6073e-04
Loss = 1.7725e-01, PNorm = 43.8564, GNorm = 1.0526, lr_0 = 8.4195e-04
Loss = 1.9783e-01, PNorm = 43.8609, GNorm = 2.5834, lr_0 = 8.4010e-04
Validation rmse = 0.222083
Validation r2 = 0.565166
Validation mse = 0.049321
Epoch 6
Loss = 1.6863e-01, PNorm = 43.8965, GNorm = 5.1698, lr_0 = 8.2177e-04
Validation rmse = 0.166756
Validation r2 = 0.754838
Validation mse = 0.027808
Epoch 7
Loss = 9.4708e-02, PNorm = 43.9255, GNorm = 1.2941, lr_0 = 8.0385e-04
Loss = 1.5543e-01, PNorm = 43.9544, GNorm = 4.0760, lr_0 = 7.8631e-04
Validation rmse = 0.177888
Validation r2 = 0.721012
Validation mse = 0.031644
Epoch 8
Loss = 1.1578e-01, PNorm = 43.9794, GNorm = 1.4347, lr_0 = 7.6746e-04
Loss = 1.4449e-01, PNorm = 44.0033, GNorm = 2.1681, lr_0 = 7.5072e-04
Validation rmse = 0.125057
Validation r2 = 0.862118
Validation mse = 0.015639
Epoch 9
Loss = 1.3563e-01, PNorm = 44.0273, GNorm = 0.8353, lr_0 = 7.3435e-04
Loss = 1.4860e-01, PNorm = 44.0507, GNorm = 1.3467, lr_0 = 7.1833e-04
Validation rmse = 0.179591
Validation r2 = 0.715646
Validation mse = 0.032253
Epoch 10
Loss = 1.3579e-01, PNorm = 44.0757, GNorm = 2.6646, lr_0 = 7.0111e-04
Loss = 1.4626e-01, PNorm = 44.1037, GNorm = 1.2995, lr_0 = 6.8581e-04
Validation rmse = 0.170406
Validation r2 = 0.743988
Validation mse = 0.029038
Epoch 11
Loss = 1.1720e-01, PNorm = 44.1246, GNorm = 0.7030, lr_0 = 6.7085e-04
Loss = 1.5531e-01, PNorm = 44.1441, GNorm = 5.6572, lr_0 = 6.5622e-04
Validation rmse = 0.147781
Validation r2 = 0.807457
Validation mse = 0.021839
Epoch 12
Loss = 1.4306e-01, PNorm = 44.1728, GNorm = 3.9405, lr_0 = 6.4049e-04
Loss = 9.7729e-02, PNorm = 44.1923, GNorm = 0.7293, lr_0 = 6.2652e-04
Validation rmse = 0.145142
Validation r2 = 0.814272
Validation mse = 0.021066
Epoch 13
Loss = 1.0491e-01, PNorm = 44.2090, GNorm = 0.7116, lr_0 = 6.1285e-04
Validation rmse = 0.167634
Validation r2 = 0.752248
Validation mse = 0.028101
Epoch 14
Loss = 1.1569e-01, PNorm = 44.2254, GNorm = 2.2470, lr_0 = 5.9816e-04
Loss = 1.1107e-01, PNorm = 44.2398, GNorm = 1.0109, lr_0 = 5.8512e-04
Validation rmse = 0.128079
Validation r2 = 0.855373
Validation mse = 0.016404
Epoch 15
Loss = 1.0264e-01, PNorm = 44.2575, GNorm = 1.1876, lr_0 = 5.7235e-04
Loss = 1.0079e-01, PNorm = 44.2693, GNorm = 0.8302, lr_0 = 5.5987e-04
Validation rmse = 0.154825
Validation r2 = 0.788665
Validation mse = 0.023971
Epoch 16
Loss = 9.4147e-02, PNorm = 44.2854, GNorm = 0.8343, lr_0 = 5.4645e-04
Loss = 1.0559e-01, PNorm = 44.2971, GNorm = 1.5665, lr_0 = 5.3453e-04
Validation rmse = 0.132779
Validation r2 = 0.844564
Validation mse = 0.017630
Epoch 17
Loss = 9.9636e-02, PNorm = 44.3156, GNorm = 0.6626, lr_0 = 5.2287e-04
Loss = 1.1421e-01, PNorm = 44.3314, GNorm = 3.2306, lr_0 = 5.1146e-04
Validation rmse = 0.120827
Validation r2 = 0.871288
Validation mse = 0.014599
Epoch 18
Loss = 1.0307e-01, PNorm = 44.3501, GNorm = 0.7358, lr_0 = 4.9920e-04
Loss = 9.3308e-02, PNorm = 44.3624, GNorm = 0.8909, lr_0 = 4.8831e-04
Validation rmse = 0.126765
Validation r2 = 0.858325
Validation mse = 0.016069
Epoch 19
Loss = 8.2786e-02, PNorm = 44.3770, GNorm = 0.6272, lr_0 = 4.7766e-04
Validation rmse = 0.121855
Validation r2 = 0.869088
Validation mse = 0.014849
Epoch 20
Loss = 9.6667e-02, PNorm = 44.3902, GNorm = 1.2721, lr_0 = 4.6621e-04
Loss = 9.0138e-02, PNorm = 44.4019, GNorm = 0.7574, lr_0 = 4.5604e-04
Validation rmse = 0.137299
Validation r2 = 0.833801
Validation mse = 0.018851
Epoch 21
Loss = 1.1500e-01, PNorm = 44.4145, GNorm = 1.2652, lr_0 = 4.4609e-04
Loss = 1.2245e-01, PNorm = 44.4292, GNorm = 2.3551, lr_0 = 4.3636e-04
Validation rmse = 0.165372
Validation r2 = 0.758889
Validation mse = 0.027348
Epoch 22
Loss = 1.3628e-01, PNorm = 44.4452, GNorm = 3.6333, lr_0 = 4.2590e-04
Loss = 9.4575e-02, PNorm = 44.4613, GNorm = 1.0699, lr_0 = 4.1661e-04
Validation rmse = 0.129610
Validation r2 = 0.851895
Validation mse = 0.016799
Epoch 23
Loss = 9.5984e-02, PNorm = 44.4766, GNorm = 2.2153, lr_0 = 4.0752e-04
Loss = 8.8549e-02, PNorm = 44.4888, GNorm = 0.7846, lr_0 = 3.9863e-04
Validation rmse = 0.141021
Validation r2 = 0.824670
Validation mse = 0.019887
Epoch 24
Loss = 9.3990e-02, PNorm = 44.5013, GNorm = 1.2527, lr_0 = 3.8908e-04
Loss = 8.1661e-02, PNorm = 44.5127, GNorm = 2.0764, lr_0 = 3.8059e-04
Validation rmse = 0.143606
Validation r2 = 0.818182
Validation mse = 0.020623
Epoch 25
Loss = 8.4821e-02, PNorm = 44.5217, GNorm = 1.9180, lr_0 = 3.7229e-04
Loss = 8.6442e-02, PNorm = 44.5297, GNorm = 1.9346, lr_0 = 3.6417e-04
Loss = 8.1089e-02, PNorm = 44.5306, GNorm = 1.1776, lr_0 = 3.6337e-04
Validation rmse = 0.137915
Validation r2 = 0.832306
Validation mse = 0.019021
Epoch 26
Loss = 7.9936e-02, PNorm = 44.5431, GNorm = 0.8310, lr_0 = 3.5544e-04
Validation rmse = 0.136080
Validation r2 = 0.836740
Validation mse = 0.018518
Epoch 27
Loss = 6.2716e-02, PNorm = 44.5498, GNorm = 0.8258, lr_0 = 3.4692e-04
Loss = 7.8085e-02, PNorm = 44.5594, GNorm = 0.9764, lr_0 = 3.3935e-04
Validation rmse = 0.130380
Validation r2 = 0.850130
Validation mse = 0.016999
Epoch 28
Loss = 5.7485e-02, PNorm = 44.5674, GNorm = 0.6899, lr_0 = 3.3195e-04
Loss = 7.7810e-02, PNorm = 44.5759, GNorm = 0.7287, lr_0 = 3.2471e-04
Validation rmse = 0.117715
Validation r2 = 0.877834
Validation mse = 0.013857
Epoch 29
Loss = 7.3806e-02, PNorm = 44.5865, GNorm = 0.7517, lr_0 = 3.1693e-04
Loss = 7.9385e-02, PNorm = 44.5944, GNorm = 0.5237, lr_0 = 3.1001e-04
Validation rmse = 0.132700
Validation r2 = 0.844750
Validation mse = 0.017609
Epoch 30
Loss = 8.9407e-02, PNorm = 44.6025, GNorm = 1.6511, lr_0 = 3.0325e-04
Loss = 8.0589e-02, PNorm = 44.6130, GNorm = 0.8472, lr_0 = 2.9663e-04
Validation rmse = 0.139622
Validation r2 = 0.828132
Validation mse = 0.019494
Epoch 31
Loss = 7.5778e-02, PNorm = 44.6224, GNorm = 0.9505, lr_0 = 2.8952e-04
Loss = 7.0112e-02, PNorm = 44.6313, GNorm = 0.9871, lr_0 = 2.8321e-04
Validation rmse = 0.130048
Validation r2 = 0.850892
Validation mse = 0.016913
Epoch 32
Loss = 7.0711e-02, PNorm = 44.6396, GNorm = 1.0227, lr_0 = 2.7703e-04
Validation rmse = 0.122488
Validation r2 = 0.867725
Validation mse = 0.015003
Epoch 33
Loss = 5.9978e-02, PNorm = 44.6472, GNorm = 1.3380, lr_0 = 2.7039e-04
Loss = 7.3509e-02, PNorm = 44.6547, GNorm = 1.1331, lr_0 = 2.6449e-04
Validation rmse = 0.134957
Validation r2 = 0.839423
Validation mse = 0.018213
Epoch 34
Loss = 5.6782e-02, PNorm = 44.6623, GNorm = 1.4497, lr_0 = 2.5872e-04
Loss = 7.5780e-02, PNorm = 44.6696, GNorm = 1.0359, lr_0 = 2.5308e-04
Validation rmse = 0.138732
Validation r2 = 0.830314
Validation mse = 0.019247
Epoch 35
Loss = 6.2304e-02, PNorm = 44.6785, GNorm = 1.4114, lr_0 = 2.4701e-04
Loss = 7.8157e-02, PNorm = 44.6874, GNorm = 0.9058, lr_0 = 2.4162e-04
Validation rmse = 0.135429
Validation r2 = 0.838297
Validation mse = 0.018341
Epoch 36
Loss = 5.5563e-02, PNorm = 44.6940, GNorm = 0.7657, lr_0 = 2.3635e-04
Loss = 6.7347e-02, PNorm = 44.7017, GNorm = 1.1371, lr_0 = 2.3120e-04
Validation rmse = 0.127594
Validation r2 = 0.856467
Validation mse = 0.016280
Epoch 37
Loss = 5.7502e-02, PNorm = 44.7093, GNorm = 0.9351, lr_0 = 2.2566e-04
Loss = 7.8914e-02, PNorm = 44.7163, GNorm = 2.5280, lr_0 = 2.2073e-04
Validation rmse = 0.139604
Validation r2 = 0.828175
Validation mse = 0.019489
Epoch 38
Loss = 6.6915e-02, PNorm = 44.7236, GNorm = 1.5426, lr_0 = 2.1592e-04
Loss = 6.6753e-02, PNorm = 44.7305, GNorm = 1.6032, lr_0 = 2.1121e-04
Loss = 4.0520e-02, PNorm = 44.7309, GNorm = 0.8402, lr_0 = 2.1074e-04
Validation rmse = 0.132624
Validation r2 = 0.844926
Validation mse = 0.017589
Epoch 39
Loss = 6.6017e-02, PNorm = 44.7375, GNorm = 0.5502, lr_0 = 2.0615e-04
Validation rmse = 0.142621
Validation r2 = 0.820669
Validation mse = 0.020341
Epoch 40
Loss = 6.8048e-02, PNorm = 44.7430, GNorm = 1.9660, lr_0 = 2.0165e-04
Loss = 7.4848e-02, PNorm = 44.7507, GNorm = 1.4160, lr_0 = 1.9725e-04
Validation rmse = 0.133225
Validation r2 = 0.843518
Validation mse = 0.017749
Epoch 41
Loss = 7.6195e-02, PNorm = 44.7558, GNorm = 1.9247, lr_0 = 1.9252e-04
Loss = 6.5462e-02, PNorm = 44.7613, GNorm = 2.3663, lr_0 = 1.8832e-04
Validation rmse = 0.132527
Validation r2 = 0.845154
Validation mse = 0.017563
Epoch 42
Loss = 6.2699e-02, PNorm = 44.7686, GNorm = 0.9193, lr_0 = 1.8422e-04
Loss = 5.8720e-02, PNorm = 44.7742, GNorm = 0.6045, lr_0 = 1.8020e-04
Validation rmse = 0.122511
Validation r2 = 0.867676
Validation mse = 0.015009
Epoch 43
Loss = 5.4309e-02, PNorm = 44.7816, GNorm = 0.6563, lr_0 = 1.7588e-04
Loss = 6.6835e-02, PNorm = 44.7878, GNorm = 1.4241, lr_0 = 1.7204e-04
Validation rmse = 0.126736
Validation r2 = 0.858390
Validation mse = 0.016062
Epoch 44
Loss = 6.0733e-02, PNorm = 44.7932, GNorm = 1.4350, lr_0 = 1.6829e-04
Loss = 5.8610e-02, PNorm = 44.7986, GNorm = 0.6345, lr_0 = 1.6462e-04
Validation rmse = 0.131947
Validation r2 = 0.846505
Validation mse = 0.017410
Epoch 45
Loss = 6.1948e-02, PNorm = 44.8038, GNorm = 0.7113, lr_0 = 1.6067e-04
Loss = 6.1133e-02, PNorm = 44.8092, GNorm = 2.2475, lr_0 = 1.5717e-04
Validation rmse = 0.128147
Validation r2 = 0.855219
Validation mse = 0.016422
Epoch 46
Loss = 5.6920e-02, PNorm = 44.8147, GNorm = 0.9595, lr_0 = 1.5374e-04
Validation rmse = 0.129270
Validation r2 = 0.852673
Validation mse = 0.016711
Epoch 47
Loss = 4.2167e-02, PNorm = 44.8204, GNorm = 1.2260, lr_0 = 1.5005e-04
Loss = 5.7180e-02, PNorm = 44.8257, GNorm = 1.7854, lr_0 = 1.4678e-04
Validation rmse = 0.124410
Validation r2 = 0.863542
Validation mse = 0.015478
Epoch 48
Loss = 5.9590e-02, PNorm = 44.8313, GNorm = 1.5339, lr_0 = 1.4358e-04
Loss = 6.1158e-02, PNorm = 44.8359, GNorm = 0.5865, lr_0 = 1.4045e-04
Validation rmse = 0.125560
Validation r2 = 0.861006
Validation mse = 0.015765
Epoch 49
Loss = 5.4204e-02, PNorm = 44.8409, GNorm = 1.1521, lr_0 = 1.3708e-04
Loss = 5.5368e-02, PNorm = 44.8448, GNorm = 0.4988, lr_0 = 1.3409e-04
Validation rmse = 0.134302
Validation r2 = 0.840979
Validation mse = 0.018037
Epoch 50
Loss = 5.8142e-02, PNorm = 44.8487, GNorm = 0.8266, lr_0 = 1.3116e-04
Loss = 4.9515e-02, PNorm = 44.8535, GNorm = 1.8955, lr_0 = 1.2830e-04
Validation rmse = 0.126345
Validation r2 = 0.859264
Validation mse = 0.015963
Epoch 51
Loss = 5.5221e-02, PNorm = 44.8576, GNorm = 0.5201, lr_0 = 1.2523e-04
Loss = 5.4474e-02, PNorm = 44.8613, GNorm = 0.5045, lr_0 = 1.2250e-04
Loss = 1.0998e-01, PNorm = 44.8616, GNorm = 1.3345, lr_0 = 1.2223e-04
Validation rmse = 0.126291
Validation r2 = 0.859384
Validation mse = 0.015949
Epoch 52
Loss = 5.7470e-02, PNorm = 44.8657, GNorm = 1.1189, lr_0 = 1.1956e-04
Validation rmse = 0.125643
Validation r2 = 0.860823
Validation mse = 0.015786
Epoch 53
Loss = 6.9847e-02, PNorm = 44.8697, GNorm = 1.2317, lr_0 = 1.1695e-04
Loss = 5.5153e-02, PNorm = 44.8732, GNorm = 1.6889, lr_0 = 1.1440e-04
Validation rmse = 0.121533
Validation r2 = 0.869780
Validation mse = 0.014770
Epoch 54
Loss = 4.8552e-02, PNorm = 44.8775, GNorm = 0.7867, lr_0 = 1.1166e-04
Loss = 4.9922e-02, PNorm = 44.8816, GNorm = 0.7209, lr_0 = 1.0922e-04
Validation rmse = 0.123915
Validation r2 = 0.864625
Validation mse = 0.015355
Epoch 55
Loss = 5.1688e-02, PNorm = 44.8843, GNorm = 0.6400, lr_0 = 1.0684e-04
Loss = 5.0336e-02, PNorm = 44.8879, GNorm = 1.0684, lr_0 = 1.0451e-04
Validation rmse = 0.122883
Validation r2 = 0.866871
Validation mse = 0.015100
Epoch 56
Loss = 4.2160e-02, PNorm = 44.8914, GNorm = 0.5801, lr_0 = 1.0200e-04
Loss = 5.3601e-02, PNorm = 44.8957, GNorm = 0.9214, lr_0 = 1.0000e-04
Validation rmse = 0.128718
Validation r2 = 0.853927
Validation mse = 0.016568
Epoch 57
Loss = 4.5205e-02, PNorm = 44.8984, GNorm = 1.4502, lr_0 = 1.0000e-04
Loss = 5.8134e-02, PNorm = 44.9022, GNorm = 0.6346, lr_0 = 1.0000e-04
Validation rmse = 0.119208
Validation r2 = 0.874713
Validation mse = 0.014211
Epoch 58
Loss = 5.7479e-02, PNorm = 44.9056, GNorm = 1.8140, lr_0 = 1.0000e-04
Loss = 4.3298e-02, PNorm = 44.9095, GNorm = 1.9321, lr_0 = 1.0000e-04
Validation rmse = 0.127023
Validation r2 = 0.857748
Validation mse = 0.016135
Epoch 59
Loss = 4.7169e-02, PNorm = 44.9120, GNorm = 0.5473, lr_0 = 1.0000e-04
Validation rmse = 0.125501
Validation r2 = 0.861138
Validation mse = 0.015750
Model 0 best validation rmse = 0.117715 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.204898
Model 0 test r2 = 0.223532
Model 0 test mse = 0.041983
Ensemble test rmse = 0.204898
Ensemble test r2 = 0.223532
Ensemble test mse = 0.041983
Fold 9
Splitting data with seed 9
Total size = 934 | train size = 924 | val size = 10 | test size = 98
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.7324e-01, PNorm = 43.2614, GNorm = 5.6287, lr_0 = 3.7500e-04
Validation rmse = 0.184371
Validation r2 = 0.479586
Validation mse = 0.033993
Epoch 1
Loss = 7.4444e-01, PNorm = 43.2875, GNorm = 6.9105, lr_0 = 6.5000e-04
Loss = 6.1779e-01, PNorm = 43.3427, GNorm = 1.7351, lr_0 = 9.0000e-04
Validation rmse = 0.261471
Validation r2 = -0.046672
Validation mse = 0.068367
Epoch 2
Loss = 5.3506e-01, PNorm = 43.4230, GNorm = 1.3478, lr_0 = 9.8468e-04
Loss = 4.9943e-01, PNorm = 43.4906, GNorm = 4.1801, lr_0 = 9.6320e-04
Validation rmse = 0.168462
Validation r2 = 0.565523
Validation mse = 0.028379
Epoch 3
Loss = 4.1523e-01, PNorm = 43.5790, GNorm = 4.3653, lr_0 = 9.4219e-04
Loss = 3.0972e-01, PNorm = 43.6489, GNorm = 4.4787, lr_0 = 9.2164e-04
Validation rmse = 0.143268
Validation r2 = 0.685759
Validation mse = 0.020526
Epoch 4
Loss = 2.5134e-01, PNorm = 43.7264, GNorm = 1.6436, lr_0 = 8.9955e-04
Loss = 2.3663e-01, PNorm = 43.7717, GNorm = 1.2813, lr_0 = 8.7992e-04
Validation rmse = 0.090431
Validation r2 = 0.874800
Validation mse = 0.008178
Epoch 5
Loss = 2.6682e-01, PNorm = 43.8196, GNorm = 10.8671, lr_0 = 8.6073e-04
Loss = 2.3519e-01, PNorm = 43.8624, GNorm = 2.7038, lr_0 = 8.4195e-04
Loss = 1.5565e-01, PNorm = 43.8664, GNorm = 1.6677, lr_0 = 8.4010e-04
Validation rmse = 0.068601
Validation r2 = 0.927952
Validation mse = 0.004706
Epoch 6
Loss = 1.9556e-01, PNorm = 43.9010, GNorm = 4.1370, lr_0 = 8.2177e-04
Validation rmse = 0.121512
Validation r2 = 0.773950
Validation mse = 0.014765
Epoch 7
Loss = 2.2407e-01, PNorm = 43.9375, GNorm = 4.7366, lr_0 = 8.0385e-04
Loss = 1.6244e-01, PNorm = 43.9710, GNorm = 0.6573, lr_0 = 7.8631e-04
Validation rmse = 0.096627
Validation r2 = 0.857056
Validation mse = 0.009337
Epoch 8
Loss = 1.6646e-01, PNorm = 44.0041, GNorm = 1.5150, lr_0 = 7.6746e-04
Loss = 1.5495e-01, PNorm = 44.0315, GNorm = 3.5603, lr_0 = 7.5072e-04
Validation rmse = 0.088351
Validation r2 = 0.880496
Validation mse = 0.007806
Epoch 9
Loss = 1.2317e-01, PNorm = 44.0573, GNorm = 1.7576, lr_0 = 7.3435e-04
Loss = 1.4121e-01, PNorm = 44.0782, GNorm = 3.8461, lr_0 = 7.1833e-04
Validation rmse = 0.095877
Validation r2 = 0.859269
Validation mse = 0.009192
Epoch 10
Loss = 1.2605e-01, PNorm = 44.1003, GNorm = 1.3951, lr_0 = 7.0111e-04
Loss = 1.3290e-01, PNorm = 44.1205, GNorm = 3.3966, lr_0 = 6.8581e-04
Validation rmse = 0.115781
Validation r2 = 0.794772
Validation mse = 0.013405
Epoch 11
Loss = 1.1502e-01, PNorm = 44.1347, GNorm = 1.4266, lr_0 = 6.7085e-04
Loss = 1.2208e-01, PNorm = 44.1594, GNorm = 1.5282, lr_0 = 6.5622e-04
Validation rmse = 0.114820
Validation r2 = 0.798165
Validation mse = 0.013184
Epoch 12
Loss = 1.6832e-01, PNorm = 44.1739, GNorm = 2.5915, lr_0 = 6.4049e-04
Loss = 1.2552e-01, PNorm = 44.1933, GNorm = 0.6304, lr_0 = 6.2652e-04
Validation rmse = 0.098588
Validation r2 = 0.851197
Validation mse = 0.009720
Epoch 13
Loss = 1.3627e-01, PNorm = 44.2087, GNorm = 4.4319, lr_0 = 6.1285e-04
Validation rmse = 0.139041
Validation r2 = 0.704027
Validation mse = 0.019332
Epoch 14
Loss = 1.5520e-01, PNorm = 44.2325, GNorm = 1.6287, lr_0 = 5.9816e-04
Loss = 1.1949e-01, PNorm = 44.2529, GNorm = 2.9370, lr_0 = 5.8512e-04
Validation rmse = 0.103949
Validation r2 = 0.834575
Validation mse = 0.010805
Epoch 15
Loss = 1.0121e-01, PNorm = 44.2695, GNorm = 2.8319, lr_0 = 5.7235e-04
Loss = 1.2071e-01, PNorm = 44.2864, GNorm = 0.6731, lr_0 = 5.5987e-04
Validation rmse = 0.096755
Validation r2 = 0.856679
Validation mse = 0.009361
Epoch 16
Loss = 1.1266e-01, PNorm = 44.3040, GNorm = 0.6801, lr_0 = 5.4645e-04
Loss = 1.2445e-01, PNorm = 44.3220, GNorm = 0.8836, lr_0 = 5.3453e-04
Validation rmse = 0.095036
Validation r2 = 0.861728
Validation mse = 0.009032
Epoch 17
Loss = 1.0928e-01, PNorm = 44.3375, GNorm = 1.0701, lr_0 = 5.2287e-04
Loss = 9.7688e-02, PNorm = 44.3511, GNorm = 1.6634, lr_0 = 5.1146e-04
Validation rmse = 0.093006
Validation r2 = 0.867570
Validation mse = 0.008650
Epoch 18
Loss = 1.0595e-01, PNorm = 44.3674, GNorm = 1.6389, lr_0 = 4.9920e-04
Loss = 9.7581e-02, PNorm = 44.3808, GNorm = 1.1361, lr_0 = 4.8831e-04
Validation rmse = 0.125888
Validation r2 = 0.757378
Validation mse = 0.015848
Epoch 19
Loss = 1.0691e-01, PNorm = 44.3965, GNorm = 1.2946, lr_0 = 4.7766e-04
Validation rmse = 0.095454
Validation r2 = 0.860507
Validation mse = 0.009111
Epoch 20
Loss = 1.3351e-01, PNorm = 44.4147, GNorm = 1.2718, lr_0 = 4.6621e-04
Loss = 9.9687e-02, PNorm = 44.4289, GNorm = 2.2780, lr_0 = 4.5604e-04
Validation rmse = 0.081902
Validation r2 = 0.897303
Validation mse = 0.006708
Epoch 21
Loss = 8.9371e-02, PNorm = 44.4449, GNorm = 0.5742, lr_0 = 4.4609e-04
Loss = 9.0226e-02, PNorm = 44.4580, GNorm = 0.8277, lr_0 = 4.3636e-04
Validation rmse = 0.099051
Validation r2 = 0.849797
Validation mse = 0.009811
Epoch 22
Loss = 9.2063e-02, PNorm = 44.4708, GNorm = 1.1180, lr_0 = 4.2590e-04
Loss = 9.3258e-02, PNorm = 44.4830, GNorm = 1.4918, lr_0 = 4.1661e-04
Validation rmse = 0.103047
Validation r2 = 0.837432
Validation mse = 0.010619
Epoch 23
Loss = 9.7322e-02, PNorm = 44.4977, GNorm = 2.4649, lr_0 = 4.0752e-04
Loss = 1.1694e-01, PNorm = 44.5110, GNorm = 1.6282, lr_0 = 3.9863e-04
Validation rmse = 0.100204
Validation r2 = 0.846280
Validation mse = 0.010041
Epoch 24
Loss = 7.8886e-02, PNorm = 44.5240, GNorm = 1.4678, lr_0 = 3.8908e-04
Loss = 9.5902e-02, PNorm = 44.5383, GNorm = 1.4828, lr_0 = 3.8059e-04
Validation rmse = 0.076276
Validation r2 = 0.910929
Validation mse = 0.005818
Epoch 25
Loss = 8.8504e-02, PNorm = 44.5486, GNorm = 2.1592, lr_0 = 3.7229e-04
Loss = 8.4177e-02, PNorm = 44.5608, GNorm = 1.0092, lr_0 = 3.6417e-04
Loss = 1.1364e-01, PNorm = 44.5619, GNorm = 1.2853, lr_0 = 3.6337e-04
Validation rmse = 0.084486
Validation r2 = 0.890722
Validation mse = 0.007138
Epoch 26
Loss = 8.4334e-02, PNorm = 44.5760, GNorm = 1.9853, lr_0 = 3.5544e-04
Validation rmse = 0.102179
Validation r2 = 0.840159
Validation mse = 0.010441
Epoch 27
Loss = 7.3691e-02, PNorm = 44.5841, GNorm = 1.4556, lr_0 = 3.4692e-04
Loss = 9.3477e-02, PNorm = 44.5979, GNorm = 1.6549, lr_0 = 3.3935e-04
Validation rmse = 0.079709
Validation r2 = 0.902731
Validation mse = 0.006353
Epoch 28
Loss = 8.3687e-02, PNorm = 44.6085, GNorm = 0.8731, lr_0 = 3.3195e-04
Loss = 8.3084e-02, PNorm = 44.6153, GNorm = 0.9677, lr_0 = 3.2471e-04
Validation rmse = 0.088217
Validation r2 = 0.880856
Validation mse = 0.007782
Epoch 29
Loss = 8.4460e-02, PNorm = 44.6274, GNorm = 2.5383, lr_0 = 3.1693e-04
Loss = 8.3078e-02, PNorm = 44.6379, GNorm = 1.4624, lr_0 = 3.1001e-04
Validation rmse = 0.086978
Validation r2 = 0.884181
Validation mse = 0.007565
Epoch 30
Loss = 7.7763e-02, PNorm = 44.6475, GNorm = 0.7055, lr_0 = 3.0325e-04
Loss = 7.0946e-02, PNorm = 44.6571, GNorm = 1.3512, lr_0 = 2.9663e-04
Validation rmse = 0.078800
Validation r2 = 0.904937
Validation mse = 0.006209
Epoch 31
Loss = 7.3679e-02, PNorm = 44.6658, GNorm = 0.6522, lr_0 = 2.8952e-04
Loss = 7.4295e-02, PNorm = 44.6746, GNorm = 0.6136, lr_0 = 2.8321e-04
Validation rmse = 0.081124
Validation r2 = 0.899246
Validation mse = 0.006581
Epoch 32
Loss = 7.5374e-02, PNorm = 44.6817, GNorm = 1.6353, lr_0 = 2.7703e-04
Validation rmse = 0.089121
Validation r2 = 0.878403
Validation mse = 0.007943
Epoch 33
Loss = 5.2494e-02, PNorm = 44.6914, GNorm = 1.1451, lr_0 = 2.7039e-04
Loss = 7.3912e-02, PNorm = 44.6984, GNorm = 0.6175, lr_0 = 2.6449e-04
Validation rmse = 0.077476
Validation r2 = 0.908105
Validation mse = 0.006002
Epoch 34
Loss = 5.7988e-02, PNorm = 44.7057, GNorm = 0.8428, lr_0 = 2.5872e-04
Loss = 7.1143e-02, PNorm = 44.7131, GNorm = 0.4188, lr_0 = 2.5308e-04
Validation rmse = 0.087559
Validation r2 = 0.882627
Validation mse = 0.007667
Epoch 35
Loss = 8.1389e-02, PNorm = 44.7227, GNorm = 0.8049, lr_0 = 2.4701e-04
Loss = 7.1324e-02, PNorm = 44.7296, GNorm = 1.5847, lr_0 = 2.4162e-04
Validation rmse = 0.082916
Validation r2 = 0.894746
Validation mse = 0.006875
Epoch 36
Loss = 6.2204e-02, PNorm = 44.7381, GNorm = 0.7222, lr_0 = 2.3635e-04
Loss = 6.8212e-02, PNorm = 44.7456, GNorm = 1.0958, lr_0 = 2.3120e-04
Validation rmse = 0.089119
Validation r2 = 0.878407
Validation mse = 0.007942
Epoch 37
Loss = 6.4567e-02, PNorm = 44.7530, GNorm = 1.1593, lr_0 = 2.2566e-04
Loss = 6.4259e-02, PNorm = 44.7605, GNorm = 0.8449, lr_0 = 2.2073e-04
Validation rmse = 0.080763
Validation r2 = 0.900141
Validation mse = 0.006523
Epoch 38
Loss = 5.8994e-02, PNorm = 44.7688, GNorm = 0.6725, lr_0 = 2.1592e-04
Loss = 7.5935e-02, PNorm = 44.7742, GNorm = 1.5972, lr_0 = 2.1121e-04
Loss = 3.1027e-02, PNorm = 44.7748, GNorm = 0.9553, lr_0 = 2.1074e-04
Validation rmse = 0.088617
Validation r2 = 0.879774
Validation mse = 0.007853
Epoch 39
Loss = 6.4845e-02, PNorm = 44.7802, GNorm = 0.7776, lr_0 = 2.0615e-04
Validation rmse = 0.088755
Validation r2 = 0.879398
Validation mse = 0.007878
Epoch 40
Loss = 4.8726e-02, PNorm = 44.7888, GNorm = 1.0748, lr_0 = 2.0165e-04
Loss = 6.1984e-02, PNorm = 44.7961, GNorm = 0.4563, lr_0 = 1.9725e-04
Validation rmse = 0.080207
Validation r2 = 0.901511
Validation mse = 0.006433
Epoch 41
Loss = 5.8652e-02, PNorm = 44.8036, GNorm = 0.4310, lr_0 = 1.9252e-04
Loss = 6.5564e-02, PNorm = 44.8100, GNorm = 0.7819, lr_0 = 1.8832e-04
Validation rmse = 0.078794
Validation r2 = 0.904950
Validation mse = 0.006209
Epoch 42
Loss = 7.8830e-02, PNorm = 44.8164, GNorm = 1.5064, lr_0 = 1.8422e-04
Loss = 5.8038e-02, PNorm = 44.8237, GNorm = 0.7971, lr_0 = 1.8020e-04
Validation rmse = 0.073173
Validation r2 = 0.918028
Validation mse = 0.005354
Epoch 43
Loss = 6.1908e-02, PNorm = 44.8315, GNorm = 2.3222, lr_0 = 1.7588e-04
Loss = 6.9712e-02, PNorm = 44.8386, GNorm = 0.7540, lr_0 = 1.7204e-04
Validation rmse = 0.078093
Validation r2 = 0.906635
Validation mse = 0.006098
Epoch 44
Loss = 5.9828e-02, PNorm = 44.8439, GNorm = 0.9846, lr_0 = 1.6829e-04
Loss = 6.2924e-02, PNorm = 44.8495, GNorm = 1.4300, lr_0 = 1.6462e-04
Validation rmse = 0.070353
Validation r2 = 0.924225
Validation mse = 0.004949
Epoch 45
Loss = 5.3138e-02, PNorm = 44.8563, GNorm = 1.3256, lr_0 = 1.6067e-04
Loss = 6.5087e-02, PNorm = 44.8618, GNorm = 0.9296, lr_0 = 1.5717e-04
Validation rmse = 0.075024
Validation r2 = 0.913829
Validation mse = 0.005629
Epoch 46
Loss = 6.4532e-02, PNorm = 44.8677, GNorm = 2.0317, lr_0 = 1.5374e-04
Validation rmse = 0.078326
Validation r2 = 0.906076
Validation mse = 0.006135
Epoch 47
Loss = 7.4500e-02, PNorm = 44.8738, GNorm = 3.0363, lr_0 = 1.5005e-04
Loss = 6.0070e-02, PNorm = 44.8796, GNorm = 0.7190, lr_0 = 1.4678e-04
Validation rmse = 0.072186
Validation r2 = 0.920225
Validation mse = 0.005211
Epoch 48
Loss = 8.0261e-02, PNorm = 44.8846, GNorm = 1.5501, lr_0 = 1.4358e-04
Loss = 5.2199e-02, PNorm = 44.8909, GNorm = 0.8389, lr_0 = 1.4045e-04
Validation rmse = 0.089743
Validation r2 = 0.876699
Validation mse = 0.008054
Epoch 49
Loss = 6.2643e-02, PNorm = 44.8959, GNorm = 1.2570, lr_0 = 1.3708e-04
Loss = 5.4363e-02, PNorm = 44.9009, GNorm = 0.7614, lr_0 = 1.3409e-04
Validation rmse = 0.085853
Validation r2 = 0.887158
Validation mse = 0.007371
Epoch 50
Loss = 5.4231e-02, PNorm = 44.9061, GNorm = 1.6109, lr_0 = 1.3116e-04
Loss = 5.5688e-02, PNorm = 44.9106, GNorm = 1.4209, lr_0 = 1.2830e-04
Validation rmse = 0.081846
Validation r2 = 0.897444
Validation mse = 0.006699
Epoch 51
Loss = 5.0730e-02, PNorm = 44.9156, GNorm = 1.2963, lr_0 = 1.2523e-04
Loss = 5.6554e-02, PNorm = 44.9198, GNorm = 0.9785, lr_0 = 1.2250e-04
Loss = 8.3137e-02, PNorm = 44.9204, GNorm = 1.0076, lr_0 = 1.2223e-04
Validation rmse = 0.082074
Validation r2 = 0.896873
Validation mse = 0.006736
Epoch 52
Loss = 6.4024e-02, PNorm = 44.9258, GNorm = 1.8255, lr_0 = 1.1956e-04
Validation rmse = 0.076484
Validation r2 = 0.910442
Validation mse = 0.005850
Epoch 53
Loss = 3.7876e-02, PNorm = 44.9302, GNorm = 0.9083, lr_0 = 1.1695e-04
Loss = 5.1971e-02, PNorm = 44.9346, GNorm = 0.6633, lr_0 = 1.1440e-04
Validation rmse = 0.077633
Validation r2 = 0.907730
Validation mse = 0.006027
Epoch 54
Loss = 5.9674e-02, PNorm = 44.9390, GNorm = 0.7901, lr_0 = 1.1166e-04
Loss = 4.3826e-02, PNorm = 44.9424, GNorm = 0.9282, lr_0 = 1.0922e-04
Validation rmse = 0.079418
Validation r2 = 0.903439
Validation mse = 0.006307
Epoch 55
Loss = 5.1762e-02, PNorm = 44.9465, GNorm = 0.5972, lr_0 = 1.0684e-04
Loss = 5.8135e-02, PNorm = 44.9509, GNorm = 1.3791, lr_0 = 1.0451e-04
Validation rmse = 0.073893
Validation r2 = 0.916407
Validation mse = 0.005460
Epoch 56
Loss = 5.4956e-02, PNorm = 44.9550, GNorm = 0.6226, lr_0 = 1.0200e-04
Loss = 4.9112e-02, PNorm = 44.9587, GNorm = 2.2211, lr_0 = 1.0000e-04
Validation rmse = 0.094717
Validation r2 = 0.862652
Validation mse = 0.008971
Epoch 57
Loss = 5.2747e-02, PNorm = 44.9623, GNorm = 0.4902, lr_0 = 1.0000e-04
Loss = 5.1746e-02, PNorm = 44.9663, GNorm = 0.8819, lr_0 = 1.0000e-04
Validation rmse = 0.077156
Validation r2 = 0.908861
Validation mse = 0.005953
Epoch 58
Loss = 5.2333e-02, PNorm = 44.9708, GNorm = 0.5156, lr_0 = 1.0000e-04
Loss = 4.9759e-02, PNorm = 44.9744, GNorm = 0.9196, lr_0 = 1.0000e-04
Validation rmse = 0.081298
Validation r2 = 0.898813
Validation mse = 0.006609
Epoch 59
Loss = 4.9373e-02, PNorm = 44.9783, GNorm = 0.5822, lr_0 = 1.0000e-04
Validation rmse = 0.082424
Validation r2 = 0.895992
Validation mse = 0.006794
Model 0 best validation rmse = 0.068601 on epoch 5
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.142181
Model 0 test r2 = 0.626122
Model 0 test mse = 0.020215
Ensemble test rmse = 0.142181
Ensemble test r2 = 0.626122
Ensemble test mse = 0.020215
10-fold cross validation
	Seed 0 ==> test rmse = 0.183920
	Seed 0 ==> test r2 = 0.374386
	Seed 0 ==> test mse = 0.033826
	Seed 1 ==> test rmse = 0.198152
	Seed 1 ==> test r2 = 0.273815
	Seed 1 ==> test mse = 0.039264
	Seed 2 ==> test rmse = 0.159395
	Seed 2 ==> test r2 = 0.530109
	Seed 2 ==> test mse = 0.025407
	Seed 3 ==> test rmse = 0.194249
	Seed 3 ==> test r2 = 0.302144
	Seed 3 ==> test mse = 0.037733
	Seed 4 ==> test rmse = 0.138625
	Seed 4 ==> test r2 = 0.644589
	Seed 4 ==> test mse = 0.019217
	Seed 5 ==> test rmse = 0.233503
	Seed 5 ==> test r2 = -0.008408
	Seed 5 ==> test mse = 0.054524
	Seed 6 ==> test rmse = 0.183354
	Seed 6 ==> test r2 = 0.378232
	Seed 6 ==> test mse = 0.033619
	Seed 7 ==> test rmse = 0.166189
	Seed 7 ==> test r2 = 0.489197
	Seed 7 ==> test mse = 0.027619
	Seed 8 ==> test rmse = 0.204898
	Seed 8 ==> test r2 = 0.223532
	Seed 8 ==> test mse = 0.041983
	Seed 9 ==> test rmse = 0.142181
	Seed 9 ==> test r2 = 0.626122
	Seed 9 ==> test mse = 0.020215
Overall test rmse = 0.180446 +/- 0.027923
Overall test r2 = 0.383372 +/- 0.189114
Overall test mse = 0.033341 +/- 0.010225
Elapsed time = 0:06:52
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-05d85262-3219-459a-86b2-5360cba4da72.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/EtOAc_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2', 'mse'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2', 'mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/EtOAc_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/EtOAc_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 967 | train size = 957 | val size = 10 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.3621e-01, PNorm = 43.2624, GNorm = 2.2659, lr_0 = 3.6053e-04
Validation rmse = 0.350582
Validation r2 = 0.117438
Validation mse = 0.122907
Epoch 1
Loss = 8.8402e-01, PNorm = 43.2824, GNorm = 6.3822, lr_0 = 6.2105e-04
Loss = 9.3630e-01, PNorm = 43.3193, GNorm = 2.7021, lr_0 = 8.5789e-04
Validation rmse = 0.265661
Validation r2 = 0.493217
Validation mse = 0.070576
Epoch 2
Loss = 4.0227e-01, PNorm = 43.4029, GNorm = 0.7937, lr_0 = 9.8961e-04
Loss = 5.7630e-01, PNorm = 43.4903, GNorm = 7.1278, lr_0 = 9.6914e-04
Validation rmse = 0.237980
Validation r2 = 0.593325
Validation mse = 0.056634
Epoch 3
Loss = 4.5865e-01, PNorm = 43.5684, GNorm = 4.5915, lr_0 = 9.4712e-04
Loss = 3.2021e-01, PNorm = 43.6274, GNorm = 0.5909, lr_0 = 9.2754e-04
Validation rmse = 0.218871
Validation r2 = 0.656011
Validation mse = 0.047905
Epoch 4
Loss = 2.4639e-01, PNorm = 43.6773, GNorm = 1.1637, lr_0 = 9.0646e-04
Loss = 2.4892e-01, PNorm = 43.7260, GNorm = 1.1716, lr_0 = 8.8772e-04
Validation rmse = 0.224490
Validation r2 = 0.638124
Validation mse = 0.050396
Epoch 5
Loss = 2.4334e-01, PNorm = 43.7724, GNorm = 1.0004, lr_0 = 8.6755e-04
Loss = 2.2275e-01, PNorm = 43.8066, GNorm = 1.8827, lr_0 = 8.4961e-04
Validation rmse = 0.178325
Validation r2 = 0.771655
Validation mse = 0.031800
Epoch 6
Loss = 1.8801e-01, PNorm = 43.8568, GNorm = 2.0549, lr_0 = 8.3031e-04
Loss = 2.3105e-01, PNorm = 43.8873, GNorm = 1.1256, lr_0 = 8.1314e-04
Validation rmse = 0.189203
Validation r2 = 0.742946
Validation mse = 0.035798
Epoch 7
Loss = 2.0439e-01, PNorm = 43.9167, GNorm = 1.5569, lr_0 = 7.9466e-04
Loss = 1.4455e-01, PNorm = 43.9458, GNorm = 5.1698, lr_0 = 7.7823e-04
Validation rmse = 0.170370
Validation r2 = 0.791573
Validation mse = 0.029026
Epoch 8
Loss = 1.6054e-01, PNorm = 43.9779, GNorm = 3.3771, lr_0 = 7.6214e-04
Loss = 1.5417e-01, PNorm = 44.0066, GNorm = 2.9369, lr_0 = 7.4638e-04
Validation rmse = 0.182760
Validation r2 = 0.760156
Validation mse = 0.033401
Epoch 9
Loss = 1.2674e-01, PNorm = 44.0264, GNorm = 2.1161, lr_0 = 7.2942e-04
Loss = 1.6596e-01, PNorm = 44.0519, GNorm = 2.8771, lr_0 = 7.1434e-04
Validation rmse = 0.203645
Validation r2 = 0.702206
Validation mse = 0.041471
Epoch 10
Loss = 1.8935e-01, PNorm = 44.0789, GNorm = 2.2910, lr_0 = 6.9810e-04
Loss = 1.6867e-01, PNorm = 44.1051, GNorm = 0.8260, lr_0 = 6.8367e-04
Loss = 5.6846e-02, PNorm = 44.1082, GNorm = 1.1389, lr_0 = 6.8224e-04
Validation rmse = 0.186731
Validation r2 = 0.749621
Validation mse = 0.034868
Epoch 11
Loss = 1.3556e-01, PNorm = 44.1326, GNorm = 0.6040, lr_0 = 6.6813e-04
Validation rmse = 0.187076
Validation r2 = 0.748693
Validation mse = 0.034998
Epoch 12
Loss = 1.5453e-01, PNorm = 44.1519, GNorm = 1.9133, lr_0 = 6.5295e-04
Loss = 1.4065e-01, PNorm = 44.1706, GNorm = 1.4797, lr_0 = 6.3945e-04
Validation rmse = 0.183413
Validation r2 = 0.758439
Validation mse = 0.033640
Epoch 13
Loss = 1.0960e-01, PNorm = 44.1895, GNorm = 1.5935, lr_0 = 6.2492e-04
Loss = 1.2886e-01, PNorm = 44.2070, GNorm = 1.4518, lr_0 = 6.1200e-04
Validation rmse = 0.185141
Validation r2 = 0.753866
Validation mse = 0.034277
Epoch 14
Loss = 1.3343e-01, PNorm = 44.2242, GNorm = 0.9536, lr_0 = 5.9809e-04
Loss = 1.0323e-01, PNorm = 44.2405, GNorm = 1.0216, lr_0 = 5.8573e-04
Validation rmse = 0.186481
Validation r2 = 0.750289
Validation mse = 0.034775
Epoch 15
Loss = 1.1478e-01, PNorm = 44.2539, GNorm = 0.7866, lr_0 = 5.7362e-04
Loss = 1.1097e-01, PNorm = 44.2646, GNorm = 0.7462, lr_0 = 5.6175e-04
Validation rmse = 0.177028
Validation r2 = 0.774966
Validation mse = 0.031339
Epoch 16
Loss = 1.1412e-01, PNorm = 44.2790, GNorm = 2.0889, lr_0 = 5.4899e-04
Loss = 1.3237e-01, PNorm = 44.2967, GNorm = 3.0802, lr_0 = 5.3764e-04
Validation rmse = 0.172428
Validation r2 = 0.786508
Validation mse = 0.029731
Epoch 17
Loss = 1.1496e-01, PNorm = 44.3126, GNorm = 4.9097, lr_0 = 5.2542e-04
Loss = 1.4573e-01, PNorm = 44.3338, GNorm = 1.4097, lr_0 = 5.1456e-04
Validation rmse = 0.192926
Validation r2 = 0.732732
Validation mse = 0.037220
Epoch 18
Loss = 1.0363e-01, PNorm = 44.3562, GNorm = 0.6089, lr_0 = 5.0287e-04
Loss = 1.1017e-01, PNorm = 44.3658, GNorm = 1.4381, lr_0 = 4.9247e-04
Validation rmse = 0.181625
Validation r2 = 0.763127
Validation mse = 0.032987
Epoch 19
Loss = 1.2712e-01, PNorm = 44.3815, GNorm = 2.0959, lr_0 = 4.8128e-04
Loss = 1.0086e-01, PNorm = 44.3946, GNorm = 0.4325, lr_0 = 4.7133e-04
Validation rmse = 0.173060
Validation r2 = 0.784940
Validation mse = 0.029950
Epoch 20
Loss = 1.0542e-01, PNorm = 44.4103, GNorm = 3.0620, lr_0 = 4.6062e-04
Loss = 1.1778e-01, PNorm = 44.4245, GNorm = 1.1337, lr_0 = 4.5109e-04
Validation rmse = 0.188709
Validation r2 = 0.744287
Validation mse = 0.035611
Epoch 21
Loss = 1.1414e-01, PNorm = 44.4383, GNorm = 2.6485, lr_0 = 4.4084e-04
Loss = 9.0157e-02, PNorm = 44.4498, GNorm = 0.8795, lr_0 = 4.3173e-04
Validation rmse = 0.180950
Validation r2 = 0.764882
Validation mse = 0.032743
Epoch 22
Loss = 7.8925e-02, PNorm = 44.4572, GNorm = 1.3095, lr_0 = 4.2280e-04
Loss = 1.0609e-01, PNorm = 44.4691, GNorm = 1.6341, lr_0 = 4.1406e-04
Loss = 1.5712e-01, PNorm = 44.4710, GNorm = 3.1347, lr_0 = 4.1319e-04
Validation rmse = 0.182913
Validation r2 = 0.759754
Validation mse = 0.033457
Epoch 23
Loss = 9.5253e-02, PNorm = 44.4873, GNorm = 0.8387, lr_0 = 4.0465e-04
Validation rmse = 0.172436
Validation r2 = 0.786487
Validation mse = 0.029734
Epoch 24
Loss = 1.0355e-01, PNorm = 44.4963, GNorm = 0.8662, lr_0 = 3.9545e-04
Loss = 9.9224e-02, PNorm = 44.5097, GNorm = 0.6290, lr_0 = 3.8728e-04
Validation rmse = 0.177985
Validation r2 = 0.772524
Validation mse = 0.031679
Epoch 25
Loss = 9.8313e-02, PNorm = 44.5223, GNorm = 2.2549, lr_0 = 3.7848e-04
Loss = 8.7319e-02, PNorm = 44.5332, GNorm = 0.6363, lr_0 = 3.7065e-04
Validation rmse = 0.174137
Validation r2 = 0.782254
Validation mse = 0.030324
Epoch 26
Loss = 8.3388e-02, PNorm = 44.5431, GNorm = 1.7263, lr_0 = 3.6223e-04
Loss = 9.9596e-02, PNorm = 44.5513, GNorm = 0.8743, lr_0 = 3.5474e-04
Validation rmse = 0.176349
Validation r2 = 0.776688
Validation mse = 0.031099
Epoch 27
Loss = 1.0195e-01, PNorm = 44.5640, GNorm = 1.7913, lr_0 = 3.4668e-04
Loss = 1.0416e-01, PNorm = 44.5748, GNorm = 1.0175, lr_0 = 3.3951e-04
Validation rmse = 0.178130
Validation r2 = 0.772155
Validation mse = 0.031730
Epoch 28
Loss = 8.8738e-02, PNorm = 44.5855, GNorm = 0.7535, lr_0 = 3.3180e-04
Loss = 8.1467e-02, PNorm = 44.5960, GNorm = 1.6357, lr_0 = 3.2494e-04
Validation rmse = 0.172711
Validation r2 = 0.785806
Validation mse = 0.029829
Epoch 29
Loss = 6.2500e-02, PNorm = 44.6034, GNorm = 0.5670, lr_0 = 3.1822e-04
Loss = 9.3422e-02, PNorm = 44.6113, GNorm = 2.7472, lr_0 = 3.1164e-04
Validation rmse = 0.181086
Validation r2 = 0.764529
Validation mse = 0.032792
Epoch 30
Loss = 9.9787e-02, PNorm = 44.6217, GNorm = 2.3465, lr_0 = 3.0456e-04
Loss = 9.1318e-02, PNorm = 44.6328, GNorm = 1.5144, lr_0 = 2.9826e-04
Validation rmse = 0.164939
Validation r2 = 0.804651
Validation mse = 0.027205
Epoch 31
Loss = 7.2534e-02, PNorm = 44.6437, GNorm = 0.5657, lr_0 = 2.9148e-04
Loss = 8.4089e-02, PNorm = 44.6533, GNorm = 1.0045, lr_0 = 2.8545e-04
Validation rmse = 0.177669
Validation r2 = 0.773333
Validation mse = 0.031566
Epoch 32
Loss = 8.6890e-02, PNorm = 44.6615, GNorm = 1.7053, lr_0 = 2.7897e-04
Loss = 7.7879e-02, PNorm = 44.6701, GNorm = 0.5805, lr_0 = 2.7320e-04
Validation rmse = 0.166811
Validation r2 = 0.800191
Validation mse = 0.027826
Epoch 33
Loss = 7.7922e-02, PNorm = 44.6806, GNorm = 0.6500, lr_0 = 2.6699e-04
Loss = 7.6385e-02, PNorm = 44.6900, GNorm = 1.4313, lr_0 = 2.6147e-04
Loss = 4.1966e-02, PNorm = 44.6911, GNorm = 2.4861, lr_0 = 2.6092e-04
Validation rmse = 0.167144
Validation r2 = 0.799392
Validation mse = 0.027937
Epoch 34
Loss = 7.0463e-02, PNorm = 44.6974, GNorm = 0.6363, lr_0 = 2.5553e-04
Validation rmse = 0.171359
Validation r2 = 0.789146
Validation mse = 0.029364
Epoch 35
Loss = 8.4192e-02, PNorm = 44.7057, GNorm = 1.2484, lr_0 = 2.4972e-04
Loss = 6.7404e-02, PNorm = 44.7145, GNorm = 0.3949, lr_0 = 2.4456e-04
Validation rmse = 0.164718
Validation r2 = 0.805174
Validation mse = 0.027132
Epoch 36
Loss = 5.8229e-02, PNorm = 44.7219, GNorm = 0.6064, lr_0 = 2.3950e-04
Loss = 7.7146e-02, PNorm = 44.7293, GNorm = 0.9854, lr_0 = 2.3455e-04
Validation rmse = 0.170367
Validation r2 = 0.791581
Validation mse = 0.029025
Epoch 37
Loss = 8.0050e-02, PNorm = 44.7392, GNorm = 0.6474, lr_0 = 2.2922e-04
Loss = 7.1905e-02, PNorm = 44.7464, GNorm = 0.9954, lr_0 = 2.2448e-04
Validation rmse = 0.159860
Validation r2 = 0.816496
Validation mse = 0.025555
Epoch 38
Loss = 9.1723e-02, PNorm = 44.7532, GNorm = 1.1689, lr_0 = 2.1938e-04
Loss = 5.9041e-02, PNorm = 44.7600, GNorm = 1.4808, lr_0 = 2.1484e-04
Validation rmse = 0.172272
Validation r2 = 0.786895
Validation mse = 0.029677
Epoch 39
Loss = 6.7130e-02, PNorm = 44.7685, GNorm = 1.5830, lr_0 = 2.0996e-04
Loss = 7.5191e-02, PNorm = 44.7757, GNorm = 0.8747, lr_0 = 2.0562e-04
Validation rmse = 0.166595
Validation r2 = 0.800707
Validation mse = 0.027754
Epoch 40
Loss = 7.6283e-02, PNorm = 44.7836, GNorm = 0.4125, lr_0 = 2.0095e-04
Loss = 6.9534e-02, PNorm = 44.7896, GNorm = 0.8147, lr_0 = 1.9679e-04
Validation rmse = 0.167418
Validation r2 = 0.798734
Validation mse = 0.028029
Epoch 41
Loss = 7.4011e-02, PNorm = 44.7994, GNorm = 1.8830, lr_0 = 1.9232e-04
Loss = 6.4700e-02, PNorm = 44.8067, GNorm = 1.7812, lr_0 = 1.8835e-04
Validation rmse = 0.161922
Validation r2 = 0.811730
Validation mse = 0.026219
Epoch 42
Loss = 7.2782e-02, PNorm = 44.8111, GNorm = 3.3213, lr_0 = 1.8407e-04
Loss = 8.3972e-02, PNorm = 44.8184, GNorm = 0.6565, lr_0 = 1.8026e-04
Validation rmse = 0.172948
Validation r2 = 0.785218
Validation mse = 0.029911
Epoch 43
Loss = 7.5124e-02, PNorm = 44.8254, GNorm = 1.3182, lr_0 = 1.7653e-04
Loss = 6.4586e-02, PNorm = 44.8319, GNorm = 2.0705, lr_0 = 1.7288e-04
Validation rmse = 0.168909
Validation r2 = 0.795132
Validation mse = 0.028530
Epoch 44
Loss = 6.3936e-02, PNorm = 44.8380, GNorm = 0.6688, lr_0 = 1.6895e-04
Loss = 7.0731e-02, PNorm = 44.8437, GNorm = 0.6746, lr_0 = 1.6546e-04
Validation rmse = 0.164482
Validation r2 = 0.805730
Validation mse = 0.027054
Epoch 45
Loss = 6.4613e-02, PNorm = 44.8495, GNorm = 1.4690, lr_0 = 1.6170e-04
Loss = 6.8299e-02, PNorm = 44.8556, GNorm = 0.7160, lr_0 = 1.5836e-04
Loss = 1.0548e-01, PNorm = 44.8562, GNorm = 3.4351, lr_0 = 1.5803e-04
Validation rmse = 0.169213
Validation r2 = 0.794395
Validation mse = 0.028633
Epoch 46
Loss = 6.2933e-02, PNorm = 44.8607, GNorm = 0.6032, lr_0 = 1.5476e-04
Validation rmse = 0.158759
Validation r2 = 0.819015
Validation mse = 0.025204
Epoch 47
Loss = 4.6443e-02, PNorm = 44.8667, GNorm = 0.8269, lr_0 = 1.5124e-04
Loss = 6.6471e-02, PNorm = 44.8727, GNorm = 0.6900, lr_0 = 1.4811e-04
Validation rmse = 0.160555
Validation r2 = 0.814898
Validation mse = 0.025778
Epoch 48
Loss = 5.6234e-02, PNorm = 44.8793, GNorm = 1.1771, lr_0 = 1.4475e-04
Loss = 6.6289e-02, PNorm = 44.8842, GNorm = 0.4510, lr_0 = 1.4176e-04
Validation rmse = 0.158066
Validation r2 = 0.820591
Validation mse = 0.024985
Epoch 49
Loss = 6.2798e-02, PNorm = 44.8903, GNorm = 0.8975, lr_0 = 1.3854e-04
Loss = 6.0310e-02, PNorm = 44.8954, GNorm = 0.6667, lr_0 = 1.3567e-04
Validation rmse = 0.158730
Validation r2 = 0.819081
Validation mse = 0.025195
Epoch 50
Loss = 4.4767e-02, PNorm = 44.9000, GNorm = 0.7066, lr_0 = 1.3287e-04
Loss = 6.4027e-02, PNorm = 44.9045, GNorm = 0.8627, lr_0 = 1.3012e-04
Validation rmse = 0.163184
Validation r2 = 0.808784
Validation mse = 0.026629
Epoch 51
Loss = 5.5065e-02, PNorm = 44.9098, GNorm = 0.4989, lr_0 = 1.2716e-04
Loss = 5.9192e-02, PNorm = 44.9134, GNorm = 0.7302, lr_0 = 1.2453e-04
Validation rmse = 0.155068
Validation r2 = 0.827332
Validation mse = 0.024046
Epoch 52
Loss = 5.7535e-02, PNorm = 44.9188, GNorm = 0.3798, lr_0 = 1.2170e-04
Loss = 6.6828e-02, PNorm = 44.9233, GNorm = 0.8797, lr_0 = 1.1919e-04
Validation rmse = 0.153232
Validation r2 = 0.831396
Validation mse = 0.023480
Epoch 53
Loss = 6.8572e-02, PNorm = 44.9283, GNorm = 2.0844, lr_0 = 1.1648e-04
Loss = 6.6254e-02, PNorm = 44.9316, GNorm = 1.1669, lr_0 = 1.1407e-04
Validation rmse = 0.145661
Validation r2 = 0.847646
Validation mse = 0.021217
Epoch 54
Loss = 6.3087e-02, PNorm = 44.9363, GNorm = 0.4789, lr_0 = 1.1148e-04
Loss = 5.0190e-02, PNorm = 44.9398, GNorm = 0.9308, lr_0 = 1.0917e-04
Validation rmse = 0.151937
Validation r2 = 0.834233
Validation mse = 0.023085
Epoch 55
Loss = 6.4013e-02, PNorm = 44.9442, GNorm = 0.6031, lr_0 = 1.0669e-04
Loss = 5.2827e-02, PNorm = 44.9481, GNorm = 0.5518, lr_0 = 1.0449e-04
Validation rmse = 0.154820
Validation r2 = 0.827884
Validation mse = 0.023969
Epoch 56
Loss = 5.5163e-02, PNorm = 44.9519, GNorm = 0.5877, lr_0 = 1.0211e-04
Loss = 5.8497e-02, PNorm = 44.9557, GNorm = 1.5499, lr_0 = 1.0000e-04
Loss = 5.4174e-02, PNorm = 44.9559, GNorm = 1.8734, lr_0 = 1.0000e-04
Validation rmse = 0.154214
Validation r2 = 0.829228
Validation mse = 0.023782
Epoch 57
Loss = 6.2557e-02, PNorm = 44.9602, GNorm = 1.2790, lr_0 = 1.0000e-04
Loss = 5.5259e-02, PNorm = 44.9633, GNorm = 2.2363, lr_0 = 1.0000e-04
Validation rmse = 0.151706
Validation r2 = 0.834737
Validation mse = 0.023015
Epoch 58
Loss = 5.2598e-02, PNorm = 44.9663, GNorm = 1.1610, lr_0 = 1.0000e-04
Validation rmse = 0.158030
Validation r2 = 0.820674
Validation mse = 0.024973
Epoch 59
Loss = 4.7163e-02, PNorm = 44.9701, GNorm = 1.9609, lr_0 = 1.0000e-04
Loss = 5.4295e-02, PNorm = 44.9736, GNorm = 1.2182, lr_0 = 1.0000e-04
Validation rmse = 0.145830
Validation r2 = 0.847293
Validation mse = 0.021266
Model 0 best validation rmse = 0.145661 on epoch 53
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.260137
Model 0 test r2 = -0.366701
Model 0 test mse = 0.067671
Ensemble test rmse = 0.260137
Ensemble test r2 = -0.366701
Ensemble test mse = 0.067671
Fold 1
Splitting data with seed 1
Total size = 967 | train size = 957 | val size = 10 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.8331e-01, PNorm = 43.2620, GNorm = 5.7846, lr_0 = 3.6053e-04
Validation rmse = 0.242564
Validation r2 = -0.664685
Validation mse = 0.058837
Epoch 1
Loss = 6.5379e-01, PNorm = 43.2917, GNorm = 4.6906, lr_0 = 6.2105e-04
Loss = 6.3930e-01, PNorm = 43.3295, GNorm = 1.5945, lr_0 = 8.5789e-04
Validation rmse = 0.126879
Validation r2 = 0.544530
Validation mse = 0.016098
Epoch 2
Loss = 5.7412e-01, PNorm = 43.4012, GNorm = 2.1881, lr_0 = 9.8961e-04
Loss = 4.4347e-01, PNorm = 43.4713, GNorm = 1.8443, lr_0 = 9.6914e-04
Validation rmse = 0.187199
Validation r2 = 0.008514
Validation mse = 0.035043
Epoch 3
Loss = 2.8536e-01, PNorm = 43.5523, GNorm = 1.6079, lr_0 = 9.4712e-04
Loss = 3.0193e-01, PNorm = 43.6213, GNorm = 1.6781, lr_0 = 9.2754e-04
Validation rmse = 0.111876
Validation r2 = 0.645874
Validation mse = 0.012516
Epoch 4
Loss = 2.4656e-01, PNorm = 43.6827, GNorm = 3.8316, lr_0 = 9.0646e-04
Loss = 2.0343e-01, PNorm = 43.7314, GNorm = 1.5469, lr_0 = 8.8772e-04
Validation rmse = 0.112350
Validation r2 = 0.642872
Validation mse = 0.012622
Epoch 5
Loss = 3.1655e-01, PNorm = 43.7742, GNorm = 8.9171, lr_0 = 8.6755e-04
Loss = 2.4498e-01, PNorm = 43.8184, GNorm = 7.9107, lr_0 = 8.4961e-04
Validation rmse = 0.126680
Validation r2 = 0.545955
Validation mse = 0.016048
Epoch 6
Loss = 1.5637e-01, PNorm = 43.8572, GNorm = 3.2490, lr_0 = 8.3031e-04
Loss = 2.0989e-01, PNorm = 43.8879, GNorm = 3.0290, lr_0 = 8.1314e-04
Validation rmse = 0.092696
Validation r2 = 0.756891
Validation mse = 0.008593
Epoch 7
Loss = 1.6095e-01, PNorm = 43.9237, GNorm = 2.8102, lr_0 = 7.9466e-04
Loss = 1.5955e-01, PNorm = 43.9470, GNorm = 2.4699, lr_0 = 7.7823e-04
Validation rmse = 0.099072
Validation r2 = 0.722293
Validation mse = 0.009815
Epoch 8
Loss = 1.4069e-01, PNorm = 43.9693, GNorm = 5.1577, lr_0 = 7.6214e-04
Loss = 1.5703e-01, PNorm = 43.9950, GNorm = 1.0254, lr_0 = 7.4638e-04
Validation rmse = 0.109874
Validation r2 = 0.658439
Validation mse = 0.012072
Epoch 9
Loss = 1.6715e-01, PNorm = 44.0275, GNorm = 4.1346, lr_0 = 7.2942e-04
Loss = 1.4734e-01, PNorm = 44.0474, GNorm = 0.7258, lr_0 = 7.1434e-04
Validation rmse = 0.138212
Validation r2 = 0.459529
Validation mse = 0.019103
Epoch 10
Loss = 1.4746e-01, PNorm = 44.0755, GNorm = 3.3303, lr_0 = 6.9810e-04
Loss = 1.5768e-01, PNorm = 44.0987, GNorm = 0.4415, lr_0 = 6.8367e-04
Loss = 5.6396e-02, PNorm = 44.1008, GNorm = 2.7944, lr_0 = 6.8224e-04
Validation rmse = 0.090852
Validation r2 = 0.766468
Validation mse = 0.008254
Epoch 11
Loss = 1.4269e-01, PNorm = 44.1214, GNorm = 0.9970, lr_0 = 6.6813e-04
Validation rmse = 0.118292
Validation r2 = 0.604094
Validation mse = 0.013993
Epoch 12
Loss = 1.4747e-01, PNorm = 44.1419, GNorm = 2.1593, lr_0 = 6.5295e-04
Loss = 1.1422e-01, PNorm = 44.1593, GNorm = 0.7482, lr_0 = 6.3945e-04
Validation rmse = 0.111819
Validation r2 = 0.646238
Validation mse = 0.012503
Epoch 13
Loss = 1.3078e-01, PNorm = 44.1732, GNorm = 1.0114, lr_0 = 6.2492e-04
Loss = 1.1545e-01, PNorm = 44.1899, GNorm = 2.6930, lr_0 = 6.1200e-04
Validation rmse = 0.111100
Validation r2 = 0.650771
Validation mse = 0.012343
Epoch 14
Loss = 9.3479e-02, PNorm = 44.2093, GNorm = 1.9568, lr_0 = 5.9809e-04
Loss = 1.1477e-01, PNorm = 44.2268, GNorm = 0.8623, lr_0 = 5.8573e-04
Validation rmse = 0.160994
Validation r2 = 0.266670
Validation mse = 0.025919
Epoch 15
Loss = 1.3679e-01, PNorm = 44.2400, GNorm = 1.9390, lr_0 = 5.7362e-04
Loss = 1.0797e-01, PNorm = 44.2570, GNorm = 1.7235, lr_0 = 5.6175e-04
Validation rmse = 0.114863
Validation r2 = 0.626717
Validation mse = 0.013193
Epoch 16
Loss = 8.2492e-02, PNorm = 44.2769, GNorm = 1.2814, lr_0 = 5.4899e-04
Loss = 1.1175e-01, PNorm = 44.2921, GNorm = 1.4491, lr_0 = 5.3764e-04
Validation rmse = 0.148196
Validation r2 = 0.378623
Validation mse = 0.021962
Epoch 17
Loss = 1.1363e-01, PNorm = 44.3068, GNorm = 2.4341, lr_0 = 5.2542e-04
Loss = 1.1397e-01, PNorm = 44.3228, GNorm = 0.8687, lr_0 = 5.1456e-04
Validation rmse = 0.103584
Validation r2 = 0.696423
Validation mse = 0.010730
Epoch 18
Loss = 9.1568e-02, PNorm = 44.3390, GNorm = 0.7427, lr_0 = 5.0287e-04
Loss = 9.4742e-02, PNorm = 44.3485, GNorm = 0.9454, lr_0 = 4.9247e-04
Validation rmse = 0.114059
Validation r2 = 0.631920
Validation mse = 0.013010
Epoch 19
Loss = 1.0184e-01, PNorm = 44.3679, GNorm = 0.7980, lr_0 = 4.8128e-04
Loss = 9.1758e-02, PNorm = 44.3790, GNorm = 0.8972, lr_0 = 4.7133e-04
Validation rmse = 0.177738
Validation r2 = 0.106201
Validation mse = 0.031591
Epoch 20
Loss = 1.0313e-01, PNorm = 44.3918, GNorm = 2.1911, lr_0 = 4.6062e-04
Loss = 1.1956e-01, PNorm = 44.4070, GNorm = 1.7040, lr_0 = 4.5109e-04
Validation rmse = 0.117298
Validation r2 = 0.610720
Validation mse = 0.013759
Epoch 21
Loss = 9.0196e-02, PNorm = 44.4244, GNorm = 1.7488, lr_0 = 4.4084e-04
Loss = 9.6449e-02, PNorm = 44.4348, GNorm = 0.6473, lr_0 = 4.3173e-04
Validation rmse = 0.113440
Validation r2 = 0.635905
Validation mse = 0.012869
Epoch 22
Loss = 9.8784e-02, PNorm = 44.4469, GNorm = 1.3786, lr_0 = 4.2280e-04
Loss = 8.7061e-02, PNorm = 44.4595, GNorm = 1.3491, lr_0 = 4.1406e-04
Loss = 2.1097e-01, PNorm = 44.4601, GNorm = 5.7770, lr_0 = 4.1319e-04
Validation rmse = 0.114975
Validation r2 = 0.625988
Validation mse = 0.013219
Epoch 23
Loss = 9.0558e-02, PNorm = 44.4694, GNorm = 2.6439, lr_0 = 4.0465e-04
Validation rmse = 0.111211
Validation r2 = 0.650075
Validation mse = 0.012368
Epoch 24
Loss = 9.9278e-02, PNorm = 44.4833, GNorm = 1.1233, lr_0 = 3.9545e-04
Loss = 9.8764e-02, PNorm = 44.4953, GNorm = 1.6768, lr_0 = 3.8728e-04
Validation rmse = 0.159594
Validation r2 = 0.279366
Validation mse = 0.025470
Epoch 25
Loss = 1.4834e-01, PNorm = 44.5106, GNorm = 4.5183, lr_0 = 3.7848e-04
Loss = 1.0511e-01, PNorm = 44.5284, GNorm = 3.7054, lr_0 = 3.7065e-04
Validation rmse = 0.145996
Validation r2 = 0.396934
Validation mse = 0.021315
Epoch 26
Loss = 8.6597e-02, PNorm = 44.5442, GNorm = 2.1806, lr_0 = 3.6223e-04
Loss = 1.1601e-01, PNorm = 44.5573, GNorm = 2.6777, lr_0 = 3.5474e-04
Validation rmse = 0.121752
Validation r2 = 0.580597
Validation mse = 0.014824
Epoch 27
Loss = 7.0642e-02, PNorm = 44.5679, GNorm = 0.8320, lr_0 = 3.4668e-04
Loss = 8.9382e-02, PNorm = 44.5804, GNorm = 0.6415, lr_0 = 3.3951e-04
Validation rmse = 0.123933
Validation r2 = 0.565438
Validation mse = 0.015359
Epoch 28
Loss = 8.2614e-02, PNorm = 44.5896, GNorm = 0.4911, lr_0 = 3.3180e-04
Loss = 8.2641e-02, PNorm = 44.5995, GNorm = 0.8312, lr_0 = 3.2494e-04
Validation rmse = 0.127064
Validation r2 = 0.543202
Validation mse = 0.016145
Epoch 29
Loss = 8.4261e-02, PNorm = 44.6069, GNorm = 0.9229, lr_0 = 3.1822e-04
Loss = 7.9306e-02, PNorm = 44.6153, GNorm = 1.2175, lr_0 = 3.1164e-04
Validation rmse = 0.132957
Validation r2 = 0.499848
Validation mse = 0.017678
Epoch 30
Loss = 8.9355e-02, PNorm = 44.6243, GNorm = 2.8511, lr_0 = 3.0456e-04
Loss = 8.2101e-02, PNorm = 44.6301, GNorm = 0.5920, lr_0 = 2.9826e-04
Validation rmse = 0.127651
Validation r2 = 0.538970
Validation mse = 0.016295
Epoch 31
Loss = 8.0290e-02, PNorm = 44.6373, GNorm = 0.6513, lr_0 = 2.9148e-04
Loss = 7.6811e-02, PNorm = 44.6445, GNorm = 0.7236, lr_0 = 2.8545e-04
Validation rmse = 0.131344
Validation r2 = 0.511908
Validation mse = 0.017251
Epoch 32
Loss = 7.7164e-02, PNorm = 44.6535, GNorm = 0.7960, lr_0 = 2.7897e-04
Loss = 8.0128e-02, PNorm = 44.6608, GNorm = 1.5248, lr_0 = 2.7320e-04
Validation rmse = 0.124158
Validation r2 = 0.563858
Validation mse = 0.015415
Epoch 33
Loss = 7.6552e-02, PNorm = 44.6688, GNorm = 1.0213, lr_0 = 2.6699e-04
Loss = 7.5356e-02, PNorm = 44.6768, GNorm = 0.4979, lr_0 = 2.6147e-04
Loss = 1.5731e-01, PNorm = 44.6776, GNorm = 2.9921, lr_0 = 2.6092e-04
Validation rmse = 0.120694
Validation r2 = 0.587853
Validation mse = 0.014567
Epoch 34
Loss = 7.9110e-02, PNorm = 44.6862, GNorm = 0.9167, lr_0 = 2.5553e-04
Validation rmse = 0.127938
Validation r2 = 0.536897
Validation mse = 0.016368
Epoch 35
Loss = 6.3844e-02, PNorm = 44.6931, GNorm = 0.7148, lr_0 = 2.4972e-04
Loss = 7.4839e-02, PNorm = 44.7017, GNorm = 1.1139, lr_0 = 2.4456e-04
Validation rmse = 0.128833
Validation r2 = 0.530391
Validation mse = 0.016598
Epoch 36
Loss = 5.3681e-02, PNorm = 44.7081, GNorm = 1.1870, lr_0 = 2.3950e-04
Loss = 6.3841e-02, PNorm = 44.7143, GNorm = 0.9678, lr_0 = 2.3455e-04
Validation rmse = 0.131835
Validation r2 = 0.508249
Validation mse = 0.017381
Epoch 37
Loss = 7.1944e-02, PNorm = 44.7237, GNorm = 2.8820, lr_0 = 2.2922e-04
Loss = 7.0811e-02, PNorm = 44.7321, GNorm = 0.4855, lr_0 = 2.2448e-04
Validation rmse = 0.127058
Validation r2 = 0.543243
Validation mse = 0.016144
Epoch 38
Loss = 5.5532e-02, PNorm = 44.7396, GNorm = 1.2308, lr_0 = 2.1938e-04
Loss = 6.7657e-02, PNorm = 44.7447, GNorm = 0.6452, lr_0 = 2.1484e-04
Validation rmse = 0.130130
Validation r2 = 0.520888
Validation mse = 0.016934
Epoch 39
Loss = 7.3342e-02, PNorm = 44.7535, GNorm = 0.7697, lr_0 = 2.0996e-04
Loss = 6.8483e-02, PNorm = 44.7600, GNorm = 0.8353, lr_0 = 2.0562e-04
Validation rmse = 0.116025
Validation r2 = 0.619123
Validation mse = 0.013462
Epoch 40
Loss = 7.3935e-02, PNorm = 44.7660, GNorm = 1.9968, lr_0 = 2.0095e-04
Loss = 7.2033e-02, PNorm = 44.7721, GNorm = 1.3930, lr_0 = 1.9679e-04
Validation rmse = 0.127240
Validation r2 = 0.541936
Validation mse = 0.016190
Epoch 41
Loss = 5.9233e-02, PNorm = 44.7776, GNorm = 1.5333, lr_0 = 1.9232e-04
Loss = 7.5452e-02, PNorm = 44.7825, GNorm = 1.6597, lr_0 = 1.8835e-04
Validation rmse = 0.121879
Validation r2 = 0.579721
Validation mse = 0.014854
Epoch 42
Loss = 8.9602e-02, PNorm = 44.7899, GNorm = 1.3156, lr_0 = 1.8407e-04
Loss = 5.7281e-02, PNorm = 44.7955, GNorm = 0.8077, lr_0 = 1.8026e-04
Validation rmse = 0.137881
Validation r2 = 0.462112
Validation mse = 0.019011
Epoch 43
Loss = 7.1415e-02, PNorm = 44.8016, GNorm = 0.9472, lr_0 = 1.7653e-04
Loss = 5.8213e-02, PNorm = 44.8070, GNorm = 0.8637, lr_0 = 1.7288e-04
Validation rmse = 0.131180
Validation r2 = 0.513126
Validation mse = 0.017208
Epoch 44
Loss = 6.5645e-02, PNorm = 44.8117, GNorm = 0.5217, lr_0 = 1.6895e-04
Loss = 6.4688e-02, PNorm = 44.8164, GNorm = 0.9725, lr_0 = 1.6546e-04
Validation rmse = 0.122681
Validation r2 = 0.574168
Validation mse = 0.015051
Epoch 45
Loss = 7.0316e-02, PNorm = 44.8217, GNorm = 1.1024, lr_0 = 1.6170e-04
Loss = 5.6855e-02, PNorm = 44.8268, GNorm = 0.4096, lr_0 = 1.5836e-04
Loss = 7.9409e-02, PNorm = 44.8270, GNorm = 1.7964, lr_0 = 1.5803e-04
Validation rmse = 0.135966
Validation r2 = 0.476948
Validation mse = 0.018487
Epoch 46
Loss = 6.2446e-02, PNorm = 44.8315, GNorm = 1.0529, lr_0 = 1.5476e-04
Validation rmse = 0.130253
Validation r2 = 0.519980
Validation mse = 0.016966
Epoch 47
Loss = 5.6546e-02, PNorm = 44.8359, GNorm = 0.5270, lr_0 = 1.5124e-04
Loss = 5.8344e-02, PNorm = 44.8399, GNorm = 0.8175, lr_0 = 1.4811e-04
Validation rmse = 0.130283
Validation r2 = 0.519760
Validation mse = 0.016974
Epoch 48
Loss = 5.8635e-02, PNorm = 44.8449, GNorm = 0.4858, lr_0 = 1.4475e-04
Loss = 5.9945e-02, PNorm = 44.8488, GNorm = 1.9579, lr_0 = 1.4176e-04
Validation rmse = 0.126853
Validation r2 = 0.544719
Validation mse = 0.016092
Epoch 49
Loss = 7.7637e-02, PNorm = 44.8536, GNorm = 1.4695, lr_0 = 1.3854e-04
Loss = 5.9157e-02, PNorm = 44.8598, GNorm = 1.6379, lr_0 = 1.3567e-04
Validation rmse = 0.119875
Validation r2 = 0.593431
Validation mse = 0.014370
Epoch 50
Loss = 8.2391e-02, PNorm = 44.8640, GNorm = 1.4355, lr_0 = 1.3287e-04
Loss = 5.3994e-02, PNorm = 44.8684, GNorm = 0.4637, lr_0 = 1.3012e-04
Validation rmse = 0.130631
Validation r2 = 0.517192
Validation mse = 0.017065
Epoch 51
Loss = 6.3387e-02, PNorm = 44.8713, GNorm = 1.2393, lr_0 = 1.2716e-04
Loss = 6.3302e-02, PNorm = 44.8752, GNorm = 0.8046, lr_0 = 1.2453e-04
Validation rmse = 0.127023
Validation r2 = 0.543498
Validation mse = 0.016135
Epoch 52
Loss = 5.8193e-02, PNorm = 44.8789, GNorm = 1.1456, lr_0 = 1.2170e-04
Loss = 5.4463e-02, PNorm = 44.8826, GNorm = 0.4280, lr_0 = 1.1919e-04
Validation rmse = 0.126661
Validation r2 = 0.546096
Validation mse = 0.016043
Epoch 53
Loss = 4.3447e-02, PNorm = 44.8870, GNorm = 0.3060, lr_0 = 1.1648e-04
Loss = 6.1173e-02, PNorm = 44.8910, GNorm = 1.1785, lr_0 = 1.1407e-04
Validation rmse = 0.129591
Validation r2 = 0.524850
Validation mse = 0.016794
Epoch 54
Loss = 5.7921e-02, PNorm = 44.8955, GNorm = 0.8802, lr_0 = 1.1148e-04
Loss = 6.2258e-02, PNorm = 44.8990, GNorm = 1.7647, lr_0 = 1.0917e-04
Validation rmse = 0.120914
Validation r2 = 0.586348
Validation mse = 0.014620
Epoch 55
Loss = 5.9547e-02, PNorm = 44.9033, GNorm = 1.2372, lr_0 = 1.0669e-04
Loss = 5.2175e-02, PNorm = 44.9073, GNorm = 0.9925, lr_0 = 1.0449e-04
Validation rmse = 0.135985
Validation r2 = 0.476804
Validation mse = 0.018492
Epoch 56
Loss = 5.3302e-02, PNorm = 44.9110, GNorm = 1.3670, lr_0 = 1.0211e-04
Loss = 6.4794e-02, PNorm = 44.9146, GNorm = 2.0375, lr_0 = 1.0000e-04
Loss = 4.4022e-02, PNorm = 44.9151, GNorm = 1.7064, lr_0 = 1.0000e-04
Validation rmse = 0.124708
Validation r2 = 0.559981
Validation mse = 0.015552
Epoch 57
Loss = 5.3709e-02, PNorm = 44.9184, GNorm = 0.9282, lr_0 = 1.0000e-04
Loss = 5.2790e-02, PNorm = 44.9218, GNorm = 2.5817, lr_0 = 1.0000e-04
Validation rmse = 0.126265
Validation r2 = 0.548927
Validation mse = 0.015943
Epoch 58
Loss = 5.2347e-02, PNorm = 44.9255, GNorm = 0.6509, lr_0 = 1.0000e-04
Validation rmse = 0.132064
Validation r2 = 0.506544
Validation mse = 0.017441
Epoch 59
Loss = 6.3326e-02, PNorm = 44.9291, GNorm = 1.3443, lr_0 = 1.0000e-04
Loss = 5.5456e-02, PNorm = 44.9328, GNorm = 0.7710, lr_0 = 1.0000e-04
Validation rmse = 0.122378
Validation r2 = 0.576270
Validation mse = 0.014976
Model 0 best validation rmse = 0.090852 on epoch 10
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.337577
Model 0 test r2 = -1.301517
Model 0 test mse = 0.113958
Ensemble test rmse = 0.337577
Ensemble test r2 = -1.301517
Ensemble test mse = 0.113958
Fold 2
Splitting data with seed 2
Total size = 967 | train size = 957 | val size = 10 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.4348e-01, PNorm = 43.2651, GNorm = 1.4421, lr_0 = 3.6053e-04
Validation rmse = 0.219163
Validation r2 = 0.168721
Validation mse = 0.048033
Epoch 1
Loss = 5.1065e-01, PNorm = 43.2918, GNorm = 2.4805, lr_0 = 6.2105e-04
Loss = 5.3882e-01, PNorm = 43.3360, GNorm = 9.1629, lr_0 = 8.5789e-04
Validation rmse = 0.203408
Validation r2 = 0.283946
Validation mse = 0.041375
Epoch 2
Loss = 5.6074e-01, PNorm = 43.4086, GNorm = 2.0984, lr_0 = 9.8961e-04
Loss = 4.5630e-01, PNorm = 43.4870, GNorm = 6.6555, lr_0 = 9.6914e-04
Validation rmse = 0.206068
Validation r2 = 0.265093
Validation mse = 0.042464
Epoch 3
Loss = 3.9458e-01, PNorm = 43.5676, GNorm = 1.5741, lr_0 = 9.4712e-04
Loss = 2.6978e-01, PNorm = 43.6328, GNorm = 2.8207, lr_0 = 9.2754e-04
Validation rmse = 0.207987
Validation r2 = 0.251346
Validation mse = 0.043258
Epoch 4
Loss = 2.6165e-01, PNorm = 43.6899, GNorm = 5.1116, lr_0 = 9.0646e-04
Loss = 2.5787e-01, PNorm = 43.7368, GNorm = 7.6272, lr_0 = 8.8772e-04
Validation rmse = 0.169253
Validation r2 = 0.504225
Validation mse = 0.028647
Epoch 5
Loss = 2.3730e-01, PNorm = 43.7771, GNorm = 3.4833, lr_0 = 8.6755e-04
Loss = 1.8079e-01, PNorm = 43.8122, GNorm = 0.5725, lr_0 = 8.4961e-04
Validation rmse = 0.184176
Validation r2 = 0.412948
Validation mse = 0.033921
Epoch 6
Loss = 2.6091e-01, PNorm = 43.8589, GNorm = 6.5305, lr_0 = 8.3031e-04
Loss = 2.0713e-01, PNorm = 43.8904, GNorm = 3.8147, lr_0 = 8.1314e-04
Validation rmse = 0.204722
Validation r2 = 0.274660
Validation mse = 0.041911
Epoch 7
Loss = 1.5474e-01, PNorm = 43.9234, GNorm = 2.8737, lr_0 = 7.9466e-04
Loss = 1.4537e-01, PNorm = 43.9462, GNorm = 2.3100, lr_0 = 7.7823e-04
Validation rmse = 0.210052
Validation r2 = 0.236400
Validation mse = 0.044122
Epoch 8
Loss = 1.4087e-01, PNorm = 43.9675, GNorm = 0.9801, lr_0 = 7.6214e-04
Loss = 1.4960e-01, PNorm = 43.9847, GNorm = 1.7038, lr_0 = 7.4638e-04
Validation rmse = 0.231942
Validation r2 = 0.068954
Validation mse = 0.053797
Epoch 9
Loss = 1.2992e-01, PNorm = 44.0005, GNorm = 1.6934, lr_0 = 7.2942e-04
Loss = 1.4357e-01, PNorm = 44.0187, GNorm = 3.3272, lr_0 = 7.1434e-04
Validation rmse = 0.216501
Validation r2 = 0.188794
Validation mse = 0.046873
Epoch 10
Loss = 1.3646e-01, PNorm = 44.0368, GNorm = 1.2230, lr_0 = 6.9810e-04
Loss = 1.3601e-01, PNorm = 44.0554, GNorm = 2.0355, lr_0 = 6.8367e-04
Loss = 1.4129e-01, PNorm = 44.0566, GNorm = 3.0375, lr_0 = 6.8224e-04
Validation rmse = 0.221589
Validation r2 = 0.150216
Validation mse = 0.049102
Epoch 11
Loss = 1.2987e-01, PNorm = 44.0738, GNorm = 0.6123, lr_0 = 6.6813e-04
Validation rmse = 0.217866
Validation r2 = 0.178531
Validation mse = 0.047466
Epoch 12
Loss = 8.5460e-02, PNorm = 44.0918, GNorm = 2.6003, lr_0 = 6.5295e-04
Loss = 1.1249e-01, PNorm = 44.1045, GNorm = 2.3079, lr_0 = 6.3945e-04
Validation rmse = 0.223901
Validation r2 = 0.132394
Validation mse = 0.050132
Epoch 13
Loss = 1.1779e-01, PNorm = 44.1206, GNorm = 4.4183, lr_0 = 6.2492e-04
Loss = 1.2440e-01, PNorm = 44.1351, GNorm = 2.2502, lr_0 = 6.1200e-04
Validation rmse = 0.200553
Validation r2 = 0.303904
Validation mse = 0.040222
Epoch 14
Loss = 1.5404e-01, PNorm = 44.1550, GNorm = 2.2379, lr_0 = 5.9809e-04
Loss = 1.2416e-01, PNorm = 44.1715, GNorm = 2.7676, lr_0 = 5.8573e-04
Validation rmse = 0.213953
Validation r2 = 0.207776
Validation mse = 0.045776
Epoch 15
Loss = 1.1058e-01, PNorm = 44.1862, GNorm = 2.2804, lr_0 = 5.7362e-04
Loss = 1.0565e-01, PNorm = 44.2006, GNorm = 0.8170, lr_0 = 5.6175e-04
Validation rmse = 0.193282
Validation r2 = 0.353465
Validation mse = 0.037358
Epoch 16
Loss = 1.0774e-01, PNorm = 44.2135, GNorm = 0.5513, lr_0 = 5.4899e-04
Loss = 1.0450e-01, PNorm = 44.2241, GNorm = 2.7613, lr_0 = 5.3764e-04
Validation rmse = 0.200723
Validation r2 = 0.302724
Validation mse = 0.040290
Epoch 17
Loss = 1.0796e-01, PNorm = 44.2443, GNorm = 1.0999, lr_0 = 5.2542e-04
Loss = 1.2049e-01, PNorm = 44.2566, GNorm = 2.2685, lr_0 = 5.1456e-04
Validation rmse = 0.212844
Validation r2 = 0.215965
Validation mse = 0.045303
Epoch 18
Loss = 9.1881e-02, PNorm = 44.2733, GNorm = 1.9311, lr_0 = 5.0287e-04
Loss = 1.2053e-01, PNorm = 44.2859, GNorm = 2.2051, lr_0 = 4.9247e-04
Validation rmse = 0.195071
Validation r2 = 0.341438
Validation mse = 0.038053
Epoch 19
Loss = 1.0960e-01, PNorm = 44.3016, GNorm = 0.5506, lr_0 = 4.8128e-04
Loss = 1.1441e-01, PNorm = 44.3119, GNorm = 1.6248, lr_0 = 4.7133e-04
Validation rmse = 0.218636
Validation r2 = 0.172720
Validation mse = 0.047802
Epoch 20
Loss = 1.0935e-01, PNorm = 44.3276, GNorm = 1.4713, lr_0 = 4.6062e-04
Loss = 1.1127e-01, PNorm = 44.3380, GNorm = 2.6895, lr_0 = 4.5109e-04
Validation rmse = 0.204769
Validation r2 = 0.274328
Validation mse = 0.041931
Epoch 21
Loss = 1.0680e-01, PNorm = 44.3503, GNorm = 4.3150, lr_0 = 4.4084e-04
Loss = 9.4354e-02, PNorm = 44.3631, GNorm = 0.6892, lr_0 = 4.3173e-04
Validation rmse = 0.210797
Validation r2 = 0.230975
Validation mse = 0.044436
Epoch 22
Loss = 9.1615e-02, PNorm = 44.3751, GNorm = 2.8921, lr_0 = 4.2280e-04
Loss = 8.9700e-02, PNorm = 44.3860, GNorm = 0.9443, lr_0 = 4.1406e-04
Loss = 2.2267e-02, PNorm = 44.3872, GNorm = 0.6733, lr_0 = 4.1319e-04
Validation rmse = 0.217766
Validation r2 = 0.179290
Validation mse = 0.047422
Epoch 23
Loss = 7.9728e-02, PNorm = 44.3981, GNorm = 2.5386, lr_0 = 4.0465e-04
Validation rmse = 0.197913
Validation r2 = 0.322113
Validation mse = 0.039169
Epoch 24
Loss = 8.3424e-02, PNorm = 44.4102, GNorm = 1.8029, lr_0 = 3.9545e-04
Loss = 9.9645e-02, PNorm = 44.4222, GNorm = 3.4732, lr_0 = 3.8728e-04
Validation rmse = 0.211203
Validation r2 = 0.228012
Validation mse = 0.044607
Epoch 25
Loss = 7.6651e-02, PNorm = 44.4367, GNorm = 1.3243, lr_0 = 3.7848e-04
Loss = 8.8481e-02, PNorm = 44.4514, GNorm = 0.9955, lr_0 = 3.7065e-04
Validation rmse = 0.202564
Validation r2 = 0.289874
Validation mse = 0.041032
Epoch 26
Loss = 6.4650e-02, PNorm = 44.4641, GNorm = 1.1066, lr_0 = 3.6223e-04
Loss = 1.0253e-01, PNorm = 44.4770, GNorm = 4.4583, lr_0 = 3.5474e-04
Validation rmse = 0.235847
Validation r2 = 0.037342
Validation mse = 0.055624
Epoch 27
Loss = 1.0527e-01, PNorm = 44.4900, GNorm = 1.1492, lr_0 = 3.4668e-04
Loss = 7.8896e-02, PNorm = 44.5011, GNorm = 0.7345, lr_0 = 3.3951e-04
Validation rmse = 0.204493
Validation r2 = 0.276282
Validation mse = 0.041818
Epoch 28
Loss = 7.9380e-02, PNorm = 44.5109, GNorm = 0.7649, lr_0 = 3.3180e-04
Loss = 7.6807e-02, PNorm = 44.5200, GNorm = 2.2155, lr_0 = 3.2494e-04
Validation rmse = 0.198235
Validation r2 = 0.319903
Validation mse = 0.039297
Epoch 29
Loss = 7.5402e-02, PNorm = 44.5306, GNorm = 2.5323, lr_0 = 3.1822e-04
Loss = 8.1092e-02, PNorm = 44.5395, GNorm = 2.0896, lr_0 = 3.1164e-04
Validation rmse = 0.202949
Validation r2 = 0.287172
Validation mse = 0.041188
Epoch 30
Loss = 7.8275e-02, PNorm = 44.5503, GNorm = 0.5185, lr_0 = 3.0456e-04
Loss = 7.2058e-02, PNorm = 44.5598, GNorm = 2.3080, lr_0 = 2.9826e-04
Validation rmse = 0.198790
Validation r2 = 0.316087
Validation mse = 0.039518
Epoch 31
Loss = 1.0102e-01, PNorm = 44.5696, GNorm = 1.0257, lr_0 = 2.9148e-04
Loss = 6.8735e-02, PNorm = 44.5770, GNorm = 0.5838, lr_0 = 2.8545e-04
Validation rmse = 0.199857
Validation r2 = 0.308730
Validation mse = 0.039943
Epoch 32
Loss = 8.6014e-02, PNorm = 44.5859, GNorm = 0.8013, lr_0 = 2.7897e-04
Loss = 7.6580e-02, PNorm = 44.5931, GNorm = 0.9689, lr_0 = 2.7320e-04
Validation rmse = 0.203711
Validation r2 = 0.281812
Validation mse = 0.041498
Epoch 33
Loss = 6.1572e-02, PNorm = 44.6014, GNorm = 1.0855, lr_0 = 2.6699e-04
Loss = 9.4519e-02, PNorm = 44.6094, GNorm = 3.3882, lr_0 = 2.6147e-04
Loss = 7.0542e-02, PNorm = 44.6105, GNorm = 4.2487, lr_0 = 2.6092e-04
Validation rmse = 0.197999
Validation r2 = 0.321522
Validation mse = 0.039204
Epoch 34
Loss = 9.1618e-02, PNorm = 44.6206, GNorm = 1.4725, lr_0 = 2.5553e-04
Validation rmse = 0.200934
Validation r2 = 0.301257
Validation mse = 0.040374
Epoch 35
Loss = 5.7214e-02, PNorm = 44.6294, GNorm = 0.6882, lr_0 = 2.4972e-04
Loss = 6.6552e-02, PNorm = 44.6378, GNorm = 0.8168, lr_0 = 2.4456e-04
Validation rmse = 0.213256
Validation r2 = 0.212928
Validation mse = 0.045478
Epoch 36
Loss = 4.2425e-02, PNorm = 44.6448, GNorm = 0.6460, lr_0 = 2.3950e-04
Loss = 6.2524e-02, PNorm = 44.6512, GNorm = 0.9729, lr_0 = 2.3455e-04
Validation rmse = 0.204796
Validation r2 = 0.274138
Validation mse = 0.041941
Epoch 37
Loss = 7.5257e-02, PNorm = 44.6574, GNorm = 1.2652, lr_0 = 2.2922e-04
Loss = 6.2655e-02, PNorm = 44.6634, GNorm = 0.9238, lr_0 = 2.2448e-04
Validation rmse = 0.204245
Validation r2 = 0.278037
Validation mse = 0.041716
Epoch 38
Loss = 6.9479e-02, PNorm = 44.6697, GNorm = 1.3091, lr_0 = 2.1938e-04
Loss = 6.4480e-02, PNorm = 44.6766, GNorm = 0.7674, lr_0 = 2.1484e-04
Validation rmse = 0.209757
Validation r2 = 0.238545
Validation mse = 0.043998
Epoch 39
Loss = 5.9479e-02, PNorm = 44.6831, GNorm = 0.3626, lr_0 = 2.0996e-04
Loss = 6.0987e-02, PNorm = 44.6876, GNorm = 0.7592, lr_0 = 2.0562e-04
Validation rmse = 0.206431
Validation r2 = 0.262505
Validation mse = 0.042614
Epoch 40
Loss = 6.6568e-02, PNorm = 44.6931, GNorm = 2.3722, lr_0 = 2.0095e-04
Loss = 7.0594e-02, PNorm = 44.6999, GNorm = 2.3144, lr_0 = 1.9679e-04
Validation rmse = 0.206604
Validation r2 = 0.261268
Validation mse = 0.042685
Epoch 41
Loss = 6.1772e-02, PNorm = 44.7065, GNorm = 1.3676, lr_0 = 1.9232e-04
Loss = 6.7598e-02, PNorm = 44.7114, GNorm = 0.6448, lr_0 = 1.8835e-04
Validation rmse = 0.203930
Validation r2 = 0.280263
Validation mse = 0.041588
Epoch 42
Loss = 6.0206e-02, PNorm = 44.7168, GNorm = 0.7884, lr_0 = 1.8407e-04
Loss = 6.1066e-02, PNorm = 44.7228, GNorm = 1.5280, lr_0 = 1.8026e-04
Validation rmse = 0.211196
Validation r2 = 0.228066
Validation mse = 0.044604
Epoch 43
Loss = 5.8150e-02, PNorm = 44.7286, GNorm = 0.8588, lr_0 = 1.7653e-04
Loss = 6.1964e-02, PNorm = 44.7349, GNorm = 0.5162, lr_0 = 1.7288e-04
Validation rmse = 0.208511
Validation r2 = 0.247563
Validation mse = 0.043477
Epoch 44
Loss = 5.9727e-02, PNorm = 44.7413, GNorm = 1.2033, lr_0 = 1.6895e-04
Loss = 5.7256e-02, PNorm = 44.7461, GNorm = 0.8877, lr_0 = 1.6546e-04
Validation rmse = 0.213204
Validation r2 = 0.213311
Validation mse = 0.045456
Epoch 45
Loss = 5.3410e-02, PNorm = 44.7521, GNorm = 0.9688, lr_0 = 1.6170e-04
Loss = 6.3120e-02, PNorm = 44.7574, GNorm = 0.8968, lr_0 = 1.5836e-04
Loss = 5.6736e-02, PNorm = 44.7579, GNorm = 1.8419, lr_0 = 1.5803e-04
Validation rmse = 0.209266
Validation r2 = 0.242106
Validation mse = 0.043792
Epoch 46
Loss = 5.8495e-02, PNorm = 44.7621, GNorm = 0.4605, lr_0 = 1.5476e-04
Validation rmse = 0.209699
Validation r2 = 0.238967
Validation mse = 0.043974
Epoch 47
Loss = 4.6139e-02, PNorm = 44.7678, GNorm = 1.5557, lr_0 = 1.5124e-04
Loss = 6.0117e-02, PNorm = 44.7724, GNorm = 0.7408, lr_0 = 1.4811e-04
Validation rmse = 0.208509
Validation r2 = 0.247584
Validation mse = 0.043476
Epoch 48
Loss = 4.3772e-02, PNorm = 44.7773, GNorm = 0.4579, lr_0 = 1.4475e-04
Loss = 5.5487e-02, PNorm = 44.7820, GNorm = 0.7979, lr_0 = 1.4176e-04
Validation rmse = 0.202791
Validation r2 = 0.288285
Validation mse = 0.041124
Epoch 49
Loss = 6.9748e-02, PNorm = 44.7865, GNorm = 0.6337, lr_0 = 1.3854e-04
Loss = 4.8375e-02, PNorm = 44.7905, GNorm = 1.9403, lr_0 = 1.3567e-04
Validation rmse = 0.203995
Validation r2 = 0.279803
Validation mse = 0.041614
Epoch 50
Loss = 4.4346e-02, PNorm = 44.7949, GNorm = 0.7380, lr_0 = 1.3287e-04
Loss = 6.2714e-02, PNorm = 44.8003, GNorm = 0.5953, lr_0 = 1.3012e-04
Validation rmse = 0.218534
Validation r2 = 0.173490
Validation mse = 0.047757
Epoch 51
Loss = 5.4122e-02, PNorm = 44.8049, GNorm = 2.2539, lr_0 = 1.2716e-04
Loss = 6.2555e-02, PNorm = 44.8079, GNorm = 0.9047, lr_0 = 1.2453e-04
Validation rmse = 0.207312
Validation r2 = 0.256195
Validation mse = 0.042978
Epoch 52
Loss = 5.3228e-02, PNorm = 44.8133, GNorm = 0.8179, lr_0 = 1.2170e-04
Loss = 5.4115e-02, PNorm = 44.8174, GNorm = 1.0354, lr_0 = 1.1919e-04
Validation rmse = 0.208587
Validation r2 = 0.247014
Validation mse = 0.043509
Epoch 53
Loss = 5.4787e-02, PNorm = 44.8208, GNorm = 0.9836, lr_0 = 1.1648e-04
Loss = 5.2709e-02, PNorm = 44.8244, GNorm = 1.2073, lr_0 = 1.1407e-04
Validation rmse = 0.206979
Validation r2 = 0.258585
Validation mse = 0.042840
Epoch 54
Loss = 6.0219e-02, PNorm = 44.8287, GNorm = 0.6750, lr_0 = 1.1148e-04
Loss = 4.7708e-02, PNorm = 44.8322, GNorm = 0.7938, lr_0 = 1.0917e-04
Validation rmse = 0.203960
Validation r2 = 0.280053
Validation mse = 0.041600
Epoch 55
Loss = 5.3557e-02, PNorm = 44.8362, GNorm = 1.8503, lr_0 = 1.0669e-04
Loss = 5.0678e-02, PNorm = 44.8399, GNorm = 0.7862, lr_0 = 1.0449e-04
Validation rmse = 0.214205
Validation r2 = 0.205909
Validation mse = 0.045884
Epoch 56
Loss = 5.2434e-02, PNorm = 44.8435, GNorm = 0.6287, lr_0 = 1.0211e-04
Loss = 5.4837e-02, PNorm = 44.8467, GNorm = 0.5616, lr_0 = 1.0000e-04
Loss = 3.3390e-02, PNorm = 44.8471, GNorm = 0.7978, lr_0 = 1.0000e-04
Validation rmse = 0.209866
Validation r2 = 0.237753
Validation mse = 0.044044
Epoch 57
Loss = 5.3653e-02, PNorm = 44.8507, GNorm = 0.4226, lr_0 = 1.0000e-04
Loss = 5.1488e-02, PNorm = 44.8534, GNorm = 2.2738, lr_0 = 1.0000e-04
Validation rmse = 0.204531
Validation r2 = 0.276019
Validation mse = 0.041833
Epoch 58
Loss = 5.7887e-02, PNorm = 44.8568, GNorm = 1.4961, lr_0 = 1.0000e-04
Validation rmse = 0.203624
Validation r2 = 0.282421
Validation mse = 0.041463
Epoch 59
Loss = 8.1378e-02, PNorm = 44.8602, GNorm = 1.7676, lr_0 = 1.0000e-04
Loss = 4.6635e-02, PNorm = 44.8641, GNorm = 0.8352, lr_0 = 1.0000e-04
Validation rmse = 0.203507
Validation r2 = 0.283244
Validation mse = 0.041415
Model 0 best validation rmse = 0.169253 on epoch 4
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.208053
Model 0 test r2 = 0.125787
Model 0 test mse = 0.043286
Ensemble test rmse = 0.208053
Ensemble test r2 = 0.125787
Ensemble test mse = 0.043286
Fold 3
Splitting data with seed 3
Total size = 967 | train size = 957 | val size = 10 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.1561e-01, PNorm = 43.2646, GNorm = 2.5279, lr_0 = 3.6053e-04
Validation rmse = 0.361266
Validation r2 = 0.374444
Validation mse = 0.130513
Epoch 1
Loss = 6.9204e-01, PNorm = 43.2869, GNorm = 2.1419, lr_0 = 6.2105e-04
Loss = 6.5912e-01, PNorm = 43.3257, GNorm = 2.7693, lr_0 = 8.5789e-04
Validation rmse = 0.321746
Validation r2 = 0.503821
Validation mse = 0.103520
Epoch 2
Loss = 5.3374e-01, PNorm = 43.3921, GNorm = 2.0649, lr_0 = 9.8961e-04
Loss = 4.8742e-01, PNorm = 43.4706, GNorm = 2.8029, lr_0 = 9.6914e-04
Validation rmse = 0.239407
Validation r2 = 0.725282
Validation mse = 0.057316
Epoch 3
Loss = 4.2595e-01, PNorm = 43.5518, GNorm = 4.8886, lr_0 = 9.4712e-04
Loss = 3.8790e-01, PNorm = 43.6152, GNorm = 3.2858, lr_0 = 9.2754e-04
Validation rmse = 0.194597
Validation r2 = 0.818497
Validation mse = 0.037868
Epoch 4
Loss = 2.3321e-01, PNorm = 43.6736, GNorm = 1.5235, lr_0 = 9.0646e-04
Loss = 2.5448e-01, PNorm = 43.7209, GNorm = 2.8902, lr_0 = 8.8772e-04
Validation rmse = 0.203691
Validation r2 = 0.801137
Validation mse = 0.041490
Epoch 5
Loss = 2.4281e-01, PNorm = 43.7714, GNorm = 3.0350, lr_0 = 8.6755e-04
Loss = 1.7659e-01, PNorm = 43.8116, GNorm = 4.3453, lr_0 = 8.4961e-04
Validation rmse = 0.137872
Validation r2 = 0.908890
Validation mse = 0.019009
Epoch 6
Loss = 1.6868e-01, PNorm = 43.8437, GNorm = 1.1190, lr_0 = 8.3031e-04
Loss = 1.7536e-01, PNorm = 43.8775, GNorm = 3.2180, lr_0 = 8.1314e-04
Validation rmse = 0.182012
Validation r2 = 0.841214
Validation mse = 0.033128
Epoch 7
Loss = 2.0879e-01, PNorm = 43.9120, GNorm = 4.7859, lr_0 = 7.9466e-04
Loss = 1.8865e-01, PNorm = 43.9459, GNorm = 1.4866, lr_0 = 7.7823e-04
Validation rmse = 0.128659
Validation r2 = 0.920660
Validation mse = 0.016553
Epoch 8
Loss = 1.3412e-01, PNorm = 43.9774, GNorm = 2.2711, lr_0 = 7.6214e-04
Loss = 1.5175e-01, PNorm = 44.0019, GNorm = 2.4343, lr_0 = 7.4638e-04
Validation rmse = 0.159560
Validation r2 = 0.877972
Validation mse = 0.025459
Epoch 9
Loss = 1.5273e-01, PNorm = 44.0254, GNorm = 0.8928, lr_0 = 7.2942e-04
Loss = 1.4975e-01, PNorm = 44.0503, GNorm = 0.5542, lr_0 = 7.1434e-04
Validation rmse = 0.160112
Validation r2 = 0.877125
Validation mse = 0.025636
Epoch 10
Loss = 1.4492e-01, PNorm = 44.0717, GNorm = 3.8136, lr_0 = 6.9810e-04
Loss = 1.7041e-01, PNorm = 44.1014, GNorm = 5.8757, lr_0 = 6.8367e-04
Loss = 7.3114e-02, PNorm = 44.1029, GNorm = 2.6751, lr_0 = 6.8224e-04
Validation rmse = 0.130859
Validation r2 = 0.917923
Validation mse = 0.017124
Epoch 11
Loss = 1.2334e-01, PNorm = 44.1278, GNorm = 0.7644, lr_0 = 6.6813e-04
Validation rmse = 0.142618
Validation r2 = 0.902510
Validation mse = 0.020340
Epoch 12
Loss = 9.9096e-02, PNorm = 44.1488, GNorm = 0.8276, lr_0 = 6.5295e-04
Loss = 1.0894e-01, PNorm = 44.1664, GNorm = 1.0917, lr_0 = 6.3945e-04
Validation rmse = 0.186361
Validation r2 = 0.833535
Validation mse = 0.034730
Epoch 13
Loss = 2.8344e-01, PNorm = 44.1858, GNorm = 8.3191, lr_0 = 6.2492e-04
Loss = 1.9986e-01, PNorm = 44.2160, GNorm = 1.0280, lr_0 = 6.1200e-04
Validation rmse = 0.134512
Validation r2 = 0.913277
Validation mse = 0.018093
Epoch 14
Loss = 1.5420e-01, PNorm = 44.2436, GNorm = 3.8406, lr_0 = 5.9809e-04
Loss = 1.8865e-01, PNorm = 44.2767, GNorm = 4.2335, lr_0 = 5.8573e-04
Validation rmse = 0.135453
Validation r2 = 0.912059
Validation mse = 0.018348
Epoch 15
Loss = 1.0087e-01, PNorm = 44.3007, GNorm = 2.1410, lr_0 = 5.7362e-04
Loss = 1.2215e-01, PNorm = 44.3214, GNorm = 1.1770, lr_0 = 5.6175e-04
Validation rmse = 0.122729
Validation r2 = 0.927805
Validation mse = 0.015062
Epoch 16
Loss = 1.1117e-01, PNorm = 44.3373, GNorm = 1.2687, lr_0 = 5.4899e-04
Loss = 1.1962e-01, PNorm = 44.3528, GNorm = 1.1529, lr_0 = 5.3764e-04
Validation rmse = 0.135314
Validation r2 = 0.912239
Validation mse = 0.018310
Epoch 17
Loss = 1.1923e-01, PNorm = 44.3687, GNorm = 1.1348, lr_0 = 5.2542e-04
Loss = 1.0112e-01, PNorm = 44.3822, GNorm = 1.8762, lr_0 = 5.1456e-04
Validation rmse = 0.132911
Validation r2 = 0.915329
Validation mse = 0.017665
Epoch 18
Loss = 1.2244e-01, PNorm = 44.3995, GNorm = 1.1903, lr_0 = 5.0287e-04
Loss = 1.1661e-01, PNorm = 44.4082, GNorm = 3.1018, lr_0 = 4.9247e-04
Validation rmse = 0.166357
Validation r2 = 0.867354
Validation mse = 0.027675
Epoch 19
Loss = 1.2426e-01, PNorm = 44.4219, GNorm = 1.4692, lr_0 = 4.8128e-04
Loss = 1.1081e-01, PNorm = 44.4347, GNorm = 1.3644, lr_0 = 4.7133e-04
Validation rmse = 0.132953
Validation r2 = 0.915275
Validation mse = 0.017677
Epoch 20
Loss = 1.0062e-01, PNorm = 44.4469, GNorm = 2.6308, lr_0 = 4.6062e-04
Loss = 9.9737e-02, PNorm = 44.4573, GNorm = 1.2225, lr_0 = 4.5109e-04
Validation rmse = 0.127367
Validation r2 = 0.922245
Validation mse = 0.016222
Epoch 21
Loss = 1.0123e-01, PNorm = 44.4726, GNorm = 3.9382, lr_0 = 4.4084e-04
Loss = 1.0468e-01, PNorm = 44.4850, GNorm = 1.1922, lr_0 = 4.3173e-04
Validation rmse = 0.144652
Validation r2 = 0.899709
Validation mse = 0.020924
Epoch 22
Loss = 9.6129e-02, PNorm = 44.4947, GNorm = 1.3555, lr_0 = 4.2280e-04
Loss = 9.4375e-02, PNorm = 44.5084, GNorm = 0.6766, lr_0 = 4.1406e-04
Loss = 5.7666e-02, PNorm = 44.5093, GNorm = 1.6245, lr_0 = 4.1319e-04
Validation rmse = 0.124447
Validation r2 = 0.925769
Validation mse = 0.015487
Epoch 23
Loss = 7.9350e-02, PNorm = 44.5193, GNorm = 1.1899, lr_0 = 4.0465e-04
Validation rmse = 0.142406
Validation r2 = 0.902799
Validation mse = 0.020279
Epoch 24
Loss = 8.6288e-02, PNorm = 44.5294, GNorm = 2.5219, lr_0 = 3.9545e-04
Loss = 1.1052e-01, PNorm = 44.5429, GNorm = 0.6516, lr_0 = 3.8728e-04
Validation rmse = 0.128157
Validation r2 = 0.921277
Validation mse = 0.016424
Epoch 25
Loss = 9.7007e-02, PNorm = 44.5560, GNorm = 1.6836, lr_0 = 3.7848e-04
Loss = 8.5007e-02, PNorm = 44.5702, GNorm = 0.6630, lr_0 = 3.7065e-04
Validation rmse = 0.122903
Validation r2 = 0.927600
Validation mse = 0.015105
Epoch 26
Loss = 8.6156e-02, PNorm = 44.5811, GNorm = 0.6439, lr_0 = 3.6223e-04
Loss = 8.0395e-02, PNorm = 44.5898, GNorm = 0.9517, lr_0 = 3.5474e-04
Validation rmse = 0.134377
Validation r2 = 0.913451
Validation mse = 0.018057
Epoch 27
Loss = 5.9588e-02, PNorm = 44.6002, GNorm = 0.3764, lr_0 = 3.4668e-04
Loss = 9.1425e-02, PNorm = 44.6100, GNorm = 0.6637, lr_0 = 3.3951e-04
Validation rmse = 0.128917
Validation r2 = 0.920342
Validation mse = 0.016619
Epoch 28
Loss = 7.7231e-02, PNorm = 44.6182, GNorm = 0.7454, lr_0 = 3.3180e-04
Loss = 6.8531e-02, PNorm = 44.6258, GNorm = 1.1193, lr_0 = 3.2494e-04
Validation rmse = 0.129579
Validation r2 = 0.919521
Validation mse = 0.016791
Epoch 29
Loss = 7.2633e-02, PNorm = 44.6357, GNorm = 0.7366, lr_0 = 3.1822e-04
Loss = 8.0519e-02, PNorm = 44.6466, GNorm = 0.8734, lr_0 = 3.1164e-04
Validation rmse = 0.133209
Validation r2 = 0.914949
Validation mse = 0.017745
Epoch 30
Loss = 7.0318e-02, PNorm = 44.6567, GNorm = 0.9284, lr_0 = 3.0456e-04
Loss = 7.4654e-02, PNorm = 44.6653, GNorm = 0.7774, lr_0 = 2.9826e-04
Validation rmse = 0.130939
Validation r2 = 0.917823
Validation mse = 0.017145
Epoch 31
Loss = 7.5417e-02, PNorm = 44.6770, GNorm = 1.8078, lr_0 = 2.9148e-04
Loss = 7.9586e-02, PNorm = 44.6867, GNorm = 1.1458, lr_0 = 2.8545e-04
Validation rmse = 0.124341
Validation r2 = 0.925896
Validation mse = 0.015461
Epoch 32
Loss = 8.2939e-02, PNorm = 44.6973, GNorm = 2.3610, lr_0 = 2.7897e-04
Loss = 9.2682e-02, PNorm = 44.7074, GNorm = 3.1882, lr_0 = 2.7320e-04
Validation rmse = 0.133992
Validation r2 = 0.913946
Validation mse = 0.017954
Epoch 33
Loss = 7.1096e-02, PNorm = 44.7159, GNorm = 1.4620, lr_0 = 2.6699e-04
Loss = 8.2257e-02, PNorm = 44.7238, GNorm = 1.3802, lr_0 = 2.6147e-04
Loss = 1.3187e-01, PNorm = 44.7244, GNorm = 4.0234, lr_0 = 2.6092e-04
Validation rmse = 0.136602
Validation r2 = 0.910561
Validation mse = 0.018660
Epoch 34
Loss = 8.6265e-02, PNorm = 44.7328, GNorm = 1.5001, lr_0 = 2.5553e-04
Validation rmse = 0.120939
Validation r2 = 0.929896
Validation mse = 0.014626
Epoch 35
Loss = 5.0806e-02, PNorm = 44.7425, GNorm = 1.1116, lr_0 = 2.4972e-04
Loss = 6.8021e-02, PNorm = 44.7506, GNorm = 1.7179, lr_0 = 2.4456e-04
Validation rmse = 0.141142
Validation r2 = 0.904517
Validation mse = 0.019921
Epoch 36
Loss = 6.6170e-02, PNorm = 44.7589, GNorm = 0.6376, lr_0 = 2.3950e-04
Loss = 7.2359e-02, PNorm = 44.7675, GNorm = 0.5825, lr_0 = 2.3455e-04
Validation rmse = 0.142791
Validation r2 = 0.902273
Validation mse = 0.020389
Epoch 37
Loss = 6.3074e-02, PNorm = 44.7754, GNorm = 0.6170, lr_0 = 2.2922e-04
Loss = 6.9655e-02, PNorm = 44.7835, GNorm = 0.7527, lr_0 = 2.2448e-04
Validation rmse = 0.135462
Validation r2 = 0.912048
Validation mse = 0.018350
Epoch 38
Loss = 6.6258e-02, PNorm = 44.7927, GNorm = 0.9615, lr_0 = 2.1938e-04
Loss = 6.7464e-02, PNorm = 44.8016, GNorm = 0.8957, lr_0 = 2.1484e-04
Validation rmse = 0.143058
Validation r2 = 0.901907
Validation mse = 0.020466
Epoch 39
Loss = 6.7331e-02, PNorm = 44.8099, GNorm = 1.6936, lr_0 = 2.0996e-04
Loss = 8.9379e-02, PNorm = 44.8188, GNorm = 2.5703, lr_0 = 2.0562e-04
Validation rmse = 0.131460
Validation r2 = 0.917168
Validation mse = 0.017282
Epoch 40
Loss = 7.1944e-02, PNorm = 44.8255, GNorm = 0.5581, lr_0 = 2.0095e-04
Loss = 6.9358e-02, PNorm = 44.8330, GNorm = 0.7902, lr_0 = 1.9679e-04
Validation rmse = 0.122456
Validation r2 = 0.928126
Validation mse = 0.014995
Epoch 41
Loss = 6.3908e-02, PNorm = 44.8423, GNorm = 0.9987, lr_0 = 1.9232e-04
Loss = 5.7717e-02, PNorm = 44.8502, GNorm = 0.4397, lr_0 = 1.8835e-04
Validation rmse = 0.133535
Validation r2 = 0.914532
Validation mse = 0.017832
Epoch 42
Loss = 6.2471e-02, PNorm = 44.8573, GNorm = 1.3969, lr_0 = 1.8407e-04
Loss = 5.8943e-02, PNorm = 44.8644, GNorm = 1.2373, lr_0 = 1.8026e-04
Validation rmse = 0.136910
Validation r2 = 0.910157
Validation mse = 0.018744
Epoch 43
Loss = 6.5328e-02, PNorm = 44.8700, GNorm = 1.9777, lr_0 = 1.7653e-04
Loss = 6.2171e-02, PNorm = 44.8751, GNorm = 1.0653, lr_0 = 1.7288e-04
Validation rmse = 0.129010
Validation r2 = 0.920226
Validation mse = 0.016644
Epoch 44
Loss = 5.2470e-02, PNorm = 44.8817, GNorm = 0.9874, lr_0 = 1.6895e-04
Loss = 6.2500e-02, PNorm = 44.8892, GNorm = 0.7341, lr_0 = 1.6546e-04
Validation rmse = 0.131881
Validation r2 = 0.916636
Validation mse = 0.017393
Epoch 45
Loss = 5.5325e-02, PNorm = 44.8962, GNorm = 0.7379, lr_0 = 1.6170e-04
Loss = 6.0274e-02, PNorm = 44.9024, GNorm = 0.4025, lr_0 = 1.5836e-04
Loss = 4.0690e-02, PNorm = 44.9031, GNorm = 0.9942, lr_0 = 1.5803e-04
Validation rmse = 0.131784
Validation r2 = 0.916759
Validation mse = 0.017367
Epoch 46
Loss = 5.6446e-02, PNorm = 44.9101, GNorm = 1.1540, lr_0 = 1.5476e-04
Validation rmse = 0.140397
Validation r2 = 0.905523
Validation mse = 0.019711
Epoch 47
Loss = 5.1173e-02, PNorm = 44.9169, GNorm = 0.6187, lr_0 = 1.5124e-04
Loss = 5.4487e-02, PNorm = 44.9230, GNorm = 0.5258, lr_0 = 1.4811e-04
Validation rmse = 0.125127
Validation r2 = 0.924956
Validation mse = 0.015657
Epoch 48
Loss = 4.9464e-02, PNorm = 44.9291, GNorm = 0.3853, lr_0 = 1.4475e-04
Loss = 5.7470e-02, PNorm = 44.9350, GNorm = 0.5992, lr_0 = 1.4176e-04
Validation rmse = 0.128763
Validation r2 = 0.920531
Validation mse = 0.016580
Epoch 49
Loss = 4.5511e-02, PNorm = 44.9412, GNorm = 1.4863, lr_0 = 1.3854e-04
Loss = 5.7317e-02, PNorm = 44.9459, GNorm = 0.6227, lr_0 = 1.3567e-04
Validation rmse = 0.135628
Validation r2 = 0.911832
Validation mse = 0.018395
Epoch 50
Loss = 4.3604e-02, PNorm = 44.9506, GNorm = 0.7578, lr_0 = 1.3287e-04
Loss = 5.7582e-02, PNorm = 44.9558, GNorm = 0.8526, lr_0 = 1.3012e-04
Validation rmse = 0.126732
Validation r2 = 0.923019
Validation mse = 0.016061
Epoch 51
Loss = 5.9055e-02, PNorm = 44.9618, GNorm = 0.7731, lr_0 = 1.2716e-04
Loss = 4.4816e-02, PNorm = 44.9672, GNorm = 0.5659, lr_0 = 1.2453e-04
Validation rmse = 0.133327
Validation r2 = 0.914798
Validation mse = 0.017776
Epoch 52
Loss = 4.4156e-02, PNorm = 44.9718, GNorm = 0.5260, lr_0 = 1.2170e-04
Loss = 5.5983e-02, PNorm = 44.9757, GNorm = 0.9789, lr_0 = 1.1919e-04
Validation rmse = 0.138224
Validation r2 = 0.908425
Validation mse = 0.019106
Epoch 53
Loss = 6.1271e-02, PNorm = 44.9816, GNorm = 0.6268, lr_0 = 1.1648e-04
Loss = 4.9537e-02, PNorm = 44.9863, GNorm = 0.4723, lr_0 = 1.1407e-04
Validation rmse = 0.136897
Validation r2 = 0.910175
Validation mse = 0.018741
Epoch 54
Loss = 4.7387e-02, PNorm = 44.9922, GNorm = 0.6188, lr_0 = 1.1148e-04
Loss = 5.0901e-02, PNorm = 44.9970, GNorm = 0.9096, lr_0 = 1.0917e-04
Validation rmse = 0.137229
Validation r2 = 0.909738
Validation mse = 0.018832
Epoch 55
Loss = 4.8766e-02, PNorm = 45.0005, GNorm = 0.7785, lr_0 = 1.0669e-04
Loss = 5.2433e-02, PNorm = 45.0046, GNorm = 1.1395, lr_0 = 1.0449e-04
Validation rmse = 0.132522
Validation r2 = 0.915824
Validation mse = 0.017562
Epoch 56
Loss = 4.6846e-02, PNorm = 45.0090, GNorm = 0.8415, lr_0 = 1.0211e-04
Loss = 5.2389e-02, PNorm = 45.0127, GNorm = 0.7882, lr_0 = 1.0000e-04
Loss = 3.8166e-02, PNorm = 45.0131, GNorm = 2.1032, lr_0 = 1.0000e-04
Validation rmse = 0.132253
Validation r2 = 0.916165
Validation mse = 0.017491
Epoch 57
Loss = 4.2806e-02, PNorm = 45.0168, GNorm = 0.5994, lr_0 = 1.0000e-04
Loss = 4.8152e-02, PNorm = 45.0211, GNorm = 0.6256, lr_0 = 1.0000e-04
Validation rmse = 0.132112
Validation r2 = 0.916344
Validation mse = 0.017454
Epoch 58
Loss = 4.8158e-02, PNorm = 45.0247, GNorm = 1.3793, lr_0 = 1.0000e-04
Validation rmse = 0.135713
Validation r2 = 0.911722
Validation mse = 0.018418
Epoch 59
Loss = 5.0471e-02, PNorm = 45.0288, GNorm = 0.5354, lr_0 = 1.0000e-04
Loss = 4.9550e-02, PNorm = 45.0328, GNorm = 1.7408, lr_0 = 1.0000e-04
Validation rmse = 0.137842
Validation r2 = 0.908929
Validation mse = 0.019001
Model 0 best validation rmse = 0.120939 on epoch 34
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.298315
Model 0 test r2 = -0.797292
Model 0 test mse = 0.088992
Ensemble test rmse = 0.298315
Ensemble test r2 = -0.797292
Ensemble test mse = 0.088992
Fold 4
Splitting data with seed 4
Total size = 967 | train size = 957 | val size = 10 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.8976e-01, PNorm = 43.2610, GNorm = 0.9278, lr_0 = 3.6053e-04
Validation rmse = 0.233184
Validation r2 = 0.217778
Validation mse = 0.054375
Epoch 1
Loss = 6.5059e-01, PNorm = 43.2862, GNorm = 2.7228, lr_0 = 6.2105e-04
Loss = 5.9595e-01, PNorm = 43.3309, GNorm = 10.4782, lr_0 = 8.5789e-04
Validation rmse = 0.226402
Validation r2 = 0.262618
Validation mse = 0.051258
Epoch 2
Loss = 6.8812e-01, PNorm = 43.4004, GNorm = 9.2024, lr_0 = 9.8961e-04
Loss = 5.1449e-01, PNorm = 43.4753, GNorm = 2.1848, lr_0 = 9.6914e-04
Validation rmse = 0.173875
Validation r2 = 0.565085
Validation mse = 0.030232
Epoch 3
Loss = 4.0057e-01, PNorm = 43.5542, GNorm = 2.7271, lr_0 = 9.4712e-04
Loss = 3.5704e-01, PNorm = 43.6244, GNorm = 2.2044, lr_0 = 9.2754e-04
Validation rmse = 0.135182
Validation r2 = 0.737112
Validation mse = 0.018274
Epoch 4
Loss = 2.3656e-01, PNorm = 43.6890, GNorm = 2.1741, lr_0 = 9.0646e-04
Loss = 2.6470e-01, PNorm = 43.7365, GNorm = 0.6314, lr_0 = 8.8772e-04
Validation rmse = 0.105570
Validation r2 = 0.839670
Validation mse = 0.011145
Epoch 5
Loss = 3.1580e-01, PNorm = 43.7913, GNorm = 3.9086, lr_0 = 8.6755e-04
Loss = 2.3599e-01, PNorm = 43.8398, GNorm = 0.7610, lr_0 = 8.4961e-04
Validation rmse = 0.111311
Validation r2 = 0.821757
Validation mse = 0.012390
Epoch 6
Loss = 2.0710e-01, PNorm = 43.8785, GNorm = 0.9021, lr_0 = 8.3031e-04
Loss = 2.0848e-01, PNorm = 43.9167, GNorm = 0.7269, lr_0 = 8.1314e-04
Validation rmse = 0.085391
Validation r2 = 0.895104
Validation mse = 0.007292
Epoch 7
Loss = 1.7776e-01, PNorm = 43.9530, GNorm = 1.5242, lr_0 = 7.9466e-04
Loss = 1.5489e-01, PNorm = 43.9870, GNorm = 0.9999, lr_0 = 7.7823e-04
Validation rmse = 0.078554
Validation r2 = 0.911230
Validation mse = 0.006171
Epoch 8
Loss = 1.5913e-01, PNorm = 44.0161, GNorm = 1.0788, lr_0 = 7.6214e-04
Loss = 1.6347e-01, PNorm = 44.0456, GNorm = 0.9098, lr_0 = 7.4638e-04
Validation rmse = 0.096032
Validation r2 = 0.867333
Validation mse = 0.009222
Epoch 9
Loss = 1.3252e-01, PNorm = 44.0756, GNorm = 3.7663, lr_0 = 7.2942e-04
Loss = 1.5866e-01, PNorm = 44.1039, GNorm = 0.9219, lr_0 = 7.1434e-04
Validation rmse = 0.087749
Validation r2 = 0.889231
Validation mse = 0.007700
Epoch 10
Loss = 1.5313e-01, PNorm = 44.1266, GNorm = 1.1162, lr_0 = 6.9810e-04
Loss = 1.3596e-01, PNorm = 44.1519, GNorm = 1.1703, lr_0 = 6.8367e-04
Loss = 4.2452e-02, PNorm = 44.1547, GNorm = 2.4284, lr_0 = 6.8224e-04
Validation rmse = 0.127464
Validation r2 = 0.766273
Validation mse = 0.016247
Epoch 11
Loss = 1.3442e-01, PNorm = 44.1810, GNorm = 0.9676, lr_0 = 6.6813e-04
Validation rmse = 0.084233
Validation r2 = 0.897931
Validation mse = 0.007095
Epoch 12
Loss = 1.0497e-01, PNorm = 44.2005, GNorm = 0.6454, lr_0 = 6.5295e-04
Loss = 1.0488e-01, PNorm = 44.2146, GNorm = 1.2154, lr_0 = 6.3945e-04
Validation rmse = 0.089018
Validation r2 = 0.886003
Validation mse = 0.007924
Epoch 13
Loss = 1.3000e-01, PNorm = 44.2365, GNorm = 1.7632, lr_0 = 6.2492e-04
Loss = 1.2902e-01, PNorm = 44.2657, GNorm = 2.5600, lr_0 = 6.1200e-04
Validation rmse = 0.090550
Validation r2 = 0.882047
Validation mse = 0.008199
Epoch 14
Loss = 1.4667e-01, PNorm = 44.2845, GNorm = 1.7217, lr_0 = 5.9809e-04
Loss = 1.2063e-01, PNorm = 44.3046, GNorm = 3.9359, lr_0 = 5.8573e-04
Validation rmse = 0.096515
Validation r2 = 0.865996
Validation mse = 0.009315
Epoch 15
Loss = 8.1211e-02, PNorm = 44.3212, GNorm = 0.5791, lr_0 = 5.7362e-04
Loss = 1.1650e-01, PNorm = 44.3367, GNorm = 0.7714, lr_0 = 5.6175e-04
Validation rmse = 0.076376
Validation r2 = 0.916084
Validation mse = 0.005833
Epoch 16
Loss = 1.0679e-01, PNorm = 44.3563, GNorm = 1.7566, lr_0 = 5.4899e-04
Loss = 1.2408e-01, PNorm = 44.3754, GNorm = 3.4763, lr_0 = 5.3764e-04
Validation rmse = 0.082817
Validation r2 = 0.901334
Validation mse = 0.006859
Epoch 17
Loss = 9.4884e-02, PNorm = 44.3884, GNorm = 1.1262, lr_0 = 5.2542e-04
Loss = 1.1855e-01, PNorm = 44.4043, GNorm = 2.7472, lr_0 = 5.1456e-04
Validation rmse = 0.064921
Validation r2 = 0.939369
Validation mse = 0.004215
Epoch 18
Loss = 1.2734e-01, PNorm = 44.4262, GNorm = 0.9081, lr_0 = 5.0287e-04
Loss = 1.3189e-01, PNorm = 44.4434, GNorm = 2.7060, lr_0 = 4.9247e-04
Validation rmse = 0.102273
Validation r2 = 0.849527
Validation mse = 0.010460
Epoch 19
Loss = 8.1516e-02, PNorm = 44.4592, GNorm = 0.3018, lr_0 = 4.8128e-04
Loss = 1.1669e-01, PNorm = 44.4741, GNorm = 2.0207, lr_0 = 4.7133e-04
Validation rmse = 0.089656
Validation r2 = 0.884364
Validation mse = 0.008038
Epoch 20
Loss = 1.2593e-01, PNorm = 44.4881, GNorm = 0.6413, lr_0 = 4.6062e-04
Loss = 1.0959e-01, PNorm = 44.5053, GNorm = 2.5019, lr_0 = 4.5109e-04
Validation rmse = 0.081154
Validation r2 = 0.905257
Validation mse = 0.006586
Epoch 21
Loss = 7.8902e-02, PNorm = 44.5226, GNorm = 1.8075, lr_0 = 4.4084e-04
Loss = 1.0753e-01, PNorm = 44.5330, GNorm = 0.8981, lr_0 = 4.3173e-04
Validation rmse = 0.091380
Validation r2 = 0.879874
Validation mse = 0.008350
Epoch 22
Loss = 8.4166e-02, PNorm = 44.5441, GNorm = 2.4707, lr_0 = 4.2280e-04
Loss = 9.5704e-02, PNorm = 44.5530, GNorm = 1.6748, lr_0 = 4.1406e-04
Loss = 1.8133e-02, PNorm = 44.5541, GNorm = 1.2913, lr_0 = 4.1319e-04
Validation rmse = 0.092697
Validation r2 = 0.876388
Validation mse = 0.008593
Epoch 23
Loss = 7.9102e-02, PNorm = 44.5639, GNorm = 0.5901, lr_0 = 4.0465e-04
Validation rmse = 0.077951
Validation r2 = 0.912586
Validation mse = 0.006076
Epoch 24
Loss = 9.1969e-02, PNorm = 44.5755, GNorm = 1.2428, lr_0 = 3.9545e-04
Loss = 9.8589e-02, PNorm = 44.5874, GNorm = 2.5727, lr_0 = 3.8728e-04
Validation rmse = 0.080573
Validation r2 = 0.906608
Validation mse = 0.006492
Epoch 25
Loss = 1.0154e-01, PNorm = 44.5998, GNorm = 3.9799, lr_0 = 3.7848e-04
Loss = 9.0354e-02, PNorm = 44.6110, GNorm = 1.0542, lr_0 = 3.7065e-04
Validation rmse = 0.094125
Validation r2 = 0.872550
Validation mse = 0.008859
Epoch 26
Loss = 1.4215e-01, PNorm = 44.6261, GNorm = 4.4983, lr_0 = 3.6223e-04
Loss = 1.0777e-01, PNorm = 44.6369, GNorm = 3.5961, lr_0 = 3.5474e-04
Validation rmse = 0.078719
Validation r2 = 0.910857
Validation mse = 0.006197
Epoch 27
Loss = 9.9291e-02, PNorm = 44.6502, GNorm = 0.9426, lr_0 = 3.4668e-04
Loss = 7.8652e-02, PNorm = 44.6611, GNorm = 0.8523, lr_0 = 3.3951e-04
Validation rmse = 0.083876
Validation r2 = 0.898793
Validation mse = 0.007035
Epoch 28
Loss = 7.5659e-02, PNorm = 44.6694, GNorm = 0.6753, lr_0 = 3.3180e-04
Loss = 8.9380e-02, PNorm = 44.6758, GNorm = 5.1732, lr_0 = 3.2494e-04
Validation rmse = 0.086396
Validation r2 = 0.892620
Validation mse = 0.007464
Epoch 29
Loss = 7.8591e-02, PNorm = 44.6858, GNorm = 1.2219, lr_0 = 3.1822e-04
Loss = 8.1342e-02, PNorm = 44.6943, GNorm = 0.7852, lr_0 = 3.1164e-04
Validation rmse = 0.092278
Validation r2 = 0.877502
Validation mse = 0.008515
Epoch 30
Loss = 7.8095e-02, PNorm = 44.7005, GNorm = 1.5754, lr_0 = 3.0456e-04
Loss = 8.4217e-02, PNorm = 44.7090, GNorm = 1.1017, lr_0 = 2.9826e-04
Validation rmse = 0.080224
Validation r2 = 0.907414
Validation mse = 0.006436
Epoch 31
Loss = 7.0585e-02, PNorm = 44.7161, GNorm = 0.9524, lr_0 = 2.9148e-04
Loss = 7.3525e-02, PNorm = 44.7257, GNorm = 0.8336, lr_0 = 2.8545e-04
Validation rmse = 0.085888
Validation r2 = 0.893880
Validation mse = 0.007377
Epoch 32
Loss = 7.3743e-02, PNorm = 44.7325, GNorm = 1.5757, lr_0 = 2.7897e-04
Loss = 8.0243e-02, PNorm = 44.7406, GNorm = 0.8209, lr_0 = 2.7320e-04
Validation rmse = 0.087849
Validation r2 = 0.888978
Validation mse = 0.007718
Epoch 33
Loss = 8.2719e-02, PNorm = 44.7520, GNorm = 1.0864, lr_0 = 2.6699e-04
Loss = 8.1964e-02, PNorm = 44.7600, GNorm = 0.9791, lr_0 = 2.6147e-04
Loss = 8.0929e-02, PNorm = 44.7605, GNorm = 2.4471, lr_0 = 2.6092e-04
Validation rmse = 0.099717
Validation r2 = 0.856955
Validation mse = 0.009944
Epoch 34
Loss = 6.6291e-02, PNorm = 44.7666, GNorm = 2.2912, lr_0 = 2.5553e-04
Validation rmse = 0.087116
Validation r2 = 0.890824
Validation mse = 0.007589
Epoch 35
Loss = 5.5204e-02, PNorm = 44.7731, GNorm = 0.9640, lr_0 = 2.4972e-04
Loss = 8.7278e-02, PNorm = 44.7808, GNorm = 0.8733, lr_0 = 2.4456e-04
Validation rmse = 0.078637
Validation r2 = 0.911042
Validation mse = 0.006184
Epoch 36
Loss = 7.6351e-02, PNorm = 44.7882, GNorm = 1.6007, lr_0 = 2.3950e-04
Loss = 6.2284e-02, PNorm = 44.7933, GNorm = 0.6375, lr_0 = 2.3455e-04
Validation rmse = 0.082290
Validation r2 = 0.902585
Validation mse = 0.006772
Epoch 37
Loss = 9.6394e-02, PNorm = 44.8012, GNorm = 2.0339, lr_0 = 2.2922e-04
Loss = 7.2324e-02, PNorm = 44.8078, GNorm = 1.1855, lr_0 = 2.2448e-04
Validation rmse = 0.087671
Validation r2 = 0.889428
Validation mse = 0.007686
Epoch 38
Loss = 8.4919e-02, PNorm = 44.8168, GNorm = 2.1803, lr_0 = 2.1938e-04
Loss = 7.0210e-02, PNorm = 44.8248, GNorm = 0.6459, lr_0 = 2.1484e-04
Validation rmse = 0.098839
Validation r2 = 0.859465
Validation mse = 0.009769
Epoch 39
Loss = 7.6922e-02, PNorm = 44.8312, GNorm = 1.4331, lr_0 = 2.0996e-04
Loss = 7.8050e-02, PNorm = 44.8382, GNorm = 1.1021, lr_0 = 2.0562e-04
Validation rmse = 0.082451
Validation r2 = 0.902204
Validation mse = 0.006798
Epoch 40
Loss = 6.9624e-02, PNorm = 44.8445, GNorm = 0.9760, lr_0 = 2.0095e-04
Loss = 6.6581e-02, PNorm = 44.8501, GNorm = 0.5295, lr_0 = 1.9679e-04
Validation rmse = 0.085778
Validation r2 = 0.894152
Validation mse = 0.007358
Epoch 41
Loss = 7.2197e-02, PNorm = 44.8560, GNorm = 0.7378, lr_0 = 1.9232e-04
Loss = 7.0103e-02, PNorm = 44.8628, GNorm = 1.6286, lr_0 = 1.8835e-04
Validation rmse = 0.093094
Validation r2 = 0.875326
Validation mse = 0.008667
Epoch 42
Loss = 6.4037e-02, PNorm = 44.8669, GNorm = 1.8374, lr_0 = 1.8407e-04
Loss = 6.9235e-02, PNorm = 44.8720, GNorm = 1.8156, lr_0 = 1.8026e-04
Validation rmse = 0.089481
Validation r2 = 0.884817
Validation mse = 0.008007
Epoch 43
Loss = 7.0152e-02, PNorm = 44.8771, GNorm = 0.7284, lr_0 = 1.7653e-04
Loss = 6.4594e-02, PNorm = 44.8820, GNorm = 0.5697, lr_0 = 1.7288e-04
Validation rmse = 0.086494
Validation r2 = 0.892377
Validation mse = 0.007481
Epoch 44
Loss = 7.3732e-02, PNorm = 44.8888, GNorm = 1.2964, lr_0 = 1.6895e-04
Loss = 6.0527e-02, PNorm = 44.8941, GNorm = 0.6451, lr_0 = 1.6546e-04
Validation rmse = 0.077498
Validation r2 = 0.913599
Validation mse = 0.006006
Epoch 45
Loss = 6.9614e-02, PNorm = 44.8990, GNorm = 0.7564, lr_0 = 1.6170e-04
Loss = 5.3360e-02, PNorm = 44.9035, GNorm = 0.6444, lr_0 = 1.5836e-04
Loss = 9.3518e-02, PNorm = 44.9041, GNorm = 2.5805, lr_0 = 1.5803e-04
Validation rmse = 0.091192
Validation r2 = 0.880368
Validation mse = 0.008316
Epoch 46
Loss = 6.3523e-02, PNorm = 44.9105, GNorm = 1.4008, lr_0 = 1.5476e-04
Validation rmse = 0.079220
Validation r2 = 0.909718
Validation mse = 0.006276
Epoch 47
Loss = 5.6885e-02, PNorm = 44.9155, GNorm = 0.4487, lr_0 = 1.5124e-04
Loss = 6.0571e-02, PNorm = 44.9188, GNorm = 1.2679, lr_0 = 1.4811e-04
Validation rmse = 0.094364
Validation r2 = 0.871902
Validation mse = 0.008905
Epoch 48
Loss = 6.9096e-02, PNorm = 44.9240, GNorm = 0.9634, lr_0 = 1.4475e-04
Loss = 6.9167e-02, PNorm = 44.9292, GNorm = 1.1768, lr_0 = 1.4176e-04
Validation rmse = 0.085918
Validation r2 = 0.893807
Validation mse = 0.007382
Epoch 49
Loss = 5.9936e-02, PNorm = 44.9334, GNorm = 1.5168, lr_0 = 1.3854e-04
Loss = 6.2886e-02, PNorm = 44.9380, GNorm = 1.3962, lr_0 = 1.3567e-04
Validation rmse = 0.090051
Validation r2 = 0.883344
Validation mse = 0.008109
Epoch 50
Loss = 4.9935e-02, PNorm = 44.9424, GNorm = 0.6234, lr_0 = 1.3287e-04
Loss = 6.3503e-02, PNorm = 44.9461, GNorm = 1.0619, lr_0 = 1.3012e-04
Validation rmse = 0.086103
Validation r2 = 0.893349
Validation mse = 0.007414
Epoch 51
Loss = 6.2126e-02, PNorm = 44.9496, GNorm = 1.8633, lr_0 = 1.2716e-04
Loss = 6.7828e-02, PNorm = 44.9535, GNorm = 0.5568, lr_0 = 1.2453e-04
Validation rmse = 0.085955
Validation r2 = 0.893715
Validation mse = 0.007388
Epoch 52
Loss = 6.1029e-02, PNorm = 44.9570, GNorm = 1.9158, lr_0 = 1.2170e-04
Loss = 5.7283e-02, PNorm = 44.9607, GNorm = 0.6227, lr_0 = 1.1919e-04
Validation rmse = 0.079243
Validation r2 = 0.909666
Validation mse = 0.006279
Epoch 53
Loss = 5.9426e-02, PNorm = 44.9644, GNorm = 0.4062, lr_0 = 1.1648e-04
Loss = 5.3923e-02, PNorm = 44.9677, GNorm = 0.5339, lr_0 = 1.1407e-04
Validation rmse = 0.088793
Validation r2 = 0.886579
Validation mse = 0.007884
Epoch 54
Loss = 5.9921e-02, PNorm = 44.9730, GNorm = 1.0107, lr_0 = 1.1148e-04
Loss = 6.6082e-02, PNorm = 44.9761, GNorm = 0.6361, lr_0 = 1.0917e-04
Validation rmse = 0.084868
Validation r2 = 0.896387
Validation mse = 0.007203
Epoch 55
Loss = 5.6502e-02, PNorm = 44.9804, GNorm = 0.6779, lr_0 = 1.0669e-04
Loss = 5.7540e-02, PNorm = 44.9835, GNorm = 1.0520, lr_0 = 1.0449e-04
Validation rmse = 0.086779
Validation r2 = 0.891668
Validation mse = 0.007531
Epoch 56
Loss = 5.1158e-02, PNorm = 44.9870, GNorm = 1.2191, lr_0 = 1.0211e-04
Loss = 6.0310e-02, PNorm = 44.9901, GNorm = 1.3311, lr_0 = 1.0000e-04
Loss = 4.7131e-02, PNorm = 44.9905, GNorm = 1.2111, lr_0 = 1.0000e-04
Validation rmse = 0.088917
Validation r2 = 0.886263
Validation mse = 0.007906
Epoch 57
Loss = 5.9665e-02, PNorm = 44.9935, GNorm = 0.9343, lr_0 = 1.0000e-04
Loss = 4.8620e-02, PNorm = 44.9965, GNorm = 1.1836, lr_0 = 1.0000e-04
Validation rmse = 0.088572
Validation r2 = 0.887143
Validation mse = 0.007845
Epoch 58
Loss = 5.8971e-02, PNorm = 45.0002, GNorm = 0.6629, lr_0 = 1.0000e-04
Validation rmse = 0.086734
Validation r2 = 0.891779
Validation mse = 0.007523
Epoch 59
Loss = 3.3849e-02, PNorm = 45.0033, GNorm = 0.7202, lr_0 = 1.0000e-04
Loss = 6.2016e-02, PNorm = 45.0053, GNorm = 0.8719, lr_0 = 1.0000e-04
Validation rmse = 0.090769
Validation r2 = 0.881477
Validation mse = 0.008239
Model 0 best validation rmse = 0.064921 on epoch 17
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.233533
Model 0 test r2 = -0.101448
Model 0 test mse = 0.054538
Ensemble test rmse = 0.233533
Ensemble test r2 = -0.101448
Ensemble test mse = 0.054538
Fold 5
Splitting data with seed 5
Total size = 967 | train size = 957 | val size = 10 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.1774e-01, PNorm = 43.2613, GNorm = 1.2357, lr_0 = 3.6053e-04
Validation rmse = 0.385563
Validation r2 = -0.879438
Validation mse = 0.148659
Epoch 1
Loss = 1.1500e+00, PNorm = 43.2863, GNorm = 12.1907, lr_0 = 6.2105e-04
Loss = 6.4254e-01, PNorm = 43.3332, GNorm = 8.6910, lr_0 = 8.5789e-04
Validation rmse = 0.275467
Validation r2 = 0.040651
Validation mse = 0.075882
Epoch 2
Loss = 3.4270e-01, PNorm = 43.4197, GNorm = 3.1403, lr_0 = 9.8961e-04
Loss = 3.2525e-01, PNorm = 43.4964, GNorm = 2.6178, lr_0 = 9.6914e-04
Validation rmse = 0.230940
Validation r2 = 0.325730
Validation mse = 0.053333
Epoch 3
Loss = 4.2569e-01, PNorm = 43.5792, GNorm = 17.4914, lr_0 = 9.4712e-04
Loss = 3.9587e-01, PNorm = 43.6500, GNorm = 5.8363, lr_0 = 9.2754e-04
Validation rmse = 0.169851
Validation r2 = 0.635269
Validation mse = 0.028849
Epoch 4
Loss = 2.1147e-01, PNorm = 43.7054, GNorm = 1.5813, lr_0 = 9.0646e-04
Loss = 2.6327e-01, PNorm = 43.7529, GNorm = 4.1971, lr_0 = 8.8772e-04
Validation rmse = 0.123693
Validation r2 = 0.806568
Validation mse = 0.015300
Epoch 5
Loss = 1.7706e-01, PNorm = 43.8064, GNorm = 1.7831, lr_0 = 8.6755e-04
Loss = 2.1040e-01, PNorm = 43.8391, GNorm = 1.6260, lr_0 = 8.4961e-04
Validation rmse = 0.196971
Validation r2 = 0.509500
Validation mse = 0.038797
Epoch 6
Loss = 2.3351e-01, PNorm = 43.8772, GNorm = 4.6839, lr_0 = 8.3031e-04
Loss = 1.8011e-01, PNorm = 43.9124, GNorm = 0.9656, lr_0 = 8.1314e-04
Validation rmse = 0.131464
Validation r2 = 0.781500
Validation mse = 0.017283
Epoch 7
Loss = 1.5461e-01, PNorm = 43.9453, GNorm = 1.4642, lr_0 = 7.9466e-04
Loss = 1.6511e-01, PNorm = 43.9788, GNorm = 3.8807, lr_0 = 7.7823e-04
Validation rmse = 0.096875
Validation r2 = 0.881352
Validation mse = 0.009385
Epoch 8
Loss = 1.7707e-01, PNorm = 43.9995, GNorm = 2.0415, lr_0 = 7.6214e-04
Loss = 1.7717e-01, PNorm = 44.0242, GNorm = 2.2234, lr_0 = 7.4638e-04
Validation rmse = 0.115419
Validation r2 = 0.831582
Validation mse = 0.013321
Epoch 9
Loss = 1.8625e-01, PNorm = 44.0612, GNorm = 1.4302, lr_0 = 7.2942e-04
Loss = 1.9640e-01, PNorm = 44.0846, GNorm = 5.6689, lr_0 = 7.1434e-04
Validation rmse = 0.129806
Validation r2 = 0.786978
Validation mse = 0.016850
Epoch 10
Loss = 1.4583e-01, PNorm = 44.1102, GNorm = 1.3037, lr_0 = 6.9810e-04
Loss = 1.4464e-01, PNorm = 44.1366, GNorm = 1.3981, lr_0 = 6.8367e-04
Loss = 2.3692e-01, PNorm = 44.1392, GNorm = 2.8873, lr_0 = 6.8224e-04
Validation rmse = 0.116277
Validation r2 = 0.829068
Validation mse = 0.013520
Epoch 11
Loss = 1.3545e-01, PNorm = 44.1640, GNorm = 0.6687, lr_0 = 6.6813e-04
Validation rmse = 0.152478
Validation r2 = 0.706066
Validation mse = 0.023249
Epoch 12
Loss = 1.6121e-01, PNorm = 44.1840, GNorm = 3.0131, lr_0 = 6.5295e-04
Loss = 1.1762e-01, PNorm = 44.2013, GNorm = 1.0935, lr_0 = 6.3945e-04
Validation rmse = 0.092934
Validation r2 = 0.890810
Validation mse = 0.008637
Epoch 13
Loss = 8.6707e-02, PNorm = 44.2224, GNorm = 0.8028, lr_0 = 6.2492e-04
Loss = 1.2778e-01, PNorm = 44.2458, GNorm = 3.1869, lr_0 = 6.1200e-04
Validation rmse = 0.100424
Validation r2 = 0.872499
Validation mse = 0.010085
Epoch 14
Loss = 1.0604e-01, PNorm = 44.2615, GNorm = 3.0666, lr_0 = 5.9809e-04
Loss = 1.0990e-01, PNorm = 44.2783, GNorm = 0.6922, lr_0 = 5.8573e-04
Validation rmse = 0.125693
Validation r2 = 0.800263
Validation mse = 0.015799
Epoch 15
Loss = 1.4593e-01, PNorm = 44.2942, GNorm = 1.2205, lr_0 = 5.7362e-04
Loss = 1.0718e-01, PNorm = 44.3099, GNorm = 0.5453, lr_0 = 5.6175e-04
Validation rmse = 0.097050
Validation r2 = 0.880924
Validation mse = 0.009419
Epoch 16
Loss = 1.0366e-01, PNorm = 44.3250, GNorm = 1.5773, lr_0 = 5.4899e-04
Loss = 1.0334e-01, PNorm = 44.3378, GNorm = 0.3443, lr_0 = 5.3764e-04
Validation rmse = 0.090046
Validation r2 = 0.897490
Validation mse = 0.008108
Epoch 17
Loss = 9.8102e-02, PNorm = 44.3519, GNorm = 0.8185, lr_0 = 5.2542e-04
Loss = 9.2373e-02, PNorm = 44.3664, GNorm = 0.7797, lr_0 = 5.1456e-04
Validation rmse = 0.154021
Validation r2 = 0.700085
Validation mse = 0.023723
Epoch 18
Loss = 1.1414e-01, PNorm = 44.3839, GNorm = 4.0820, lr_0 = 5.0287e-04
Loss = 9.9362e-02, PNorm = 44.3960, GNorm = 2.3027, lr_0 = 4.9247e-04
Validation rmse = 0.099493
Validation r2 = 0.874853
Validation mse = 0.009899
Epoch 19
Loss = 8.1901e-02, PNorm = 44.4140, GNorm = 0.6183, lr_0 = 4.8128e-04
Loss = 1.0648e-01, PNorm = 44.4259, GNorm = 1.3487, lr_0 = 4.7133e-04
Validation rmse = 0.122391
Validation r2 = 0.810619
Validation mse = 0.014980
Epoch 20
Loss = 1.0795e-01, PNorm = 44.4395, GNorm = 1.5341, lr_0 = 4.6062e-04
Loss = 1.1707e-01, PNorm = 44.4529, GNorm = 2.2306, lr_0 = 4.5109e-04
Validation rmse = 0.111401
Validation r2 = 0.843103
Validation mse = 0.012410
Epoch 21
Loss = 8.6726e-02, PNorm = 44.4732, GNorm = 0.9394, lr_0 = 4.4084e-04
Loss = 1.1308e-01, PNorm = 44.4852, GNorm = 3.5718, lr_0 = 4.3173e-04
Validation rmse = 0.137343
Validation r2 = 0.761520
Validation mse = 0.018863
Epoch 22
Loss = 1.3621e-01, PNorm = 44.5023, GNorm = 2.8757, lr_0 = 4.2280e-04
Loss = 1.1616e-01, PNorm = 44.5186, GNorm = 0.5129, lr_0 = 4.1406e-04
Loss = 6.8010e-02, PNorm = 44.5202, GNorm = 3.0680, lr_0 = 4.1319e-04
Validation rmse = 0.092758
Validation r2 = 0.891223
Validation mse = 0.008604
Epoch 23
Loss = 1.0043e-01, PNorm = 44.5364, GNorm = 1.1766, lr_0 = 4.0465e-04
Validation rmse = 0.107678
Validation r2 = 0.853413
Validation mse = 0.011595
Epoch 24
Loss = 6.1768e-02, PNorm = 44.5497, GNorm = 0.7963, lr_0 = 3.9545e-04
Loss = 9.3257e-02, PNorm = 44.5589, GNorm = 1.3769, lr_0 = 3.8728e-04
Validation rmse = 0.108450
Validation r2 = 0.851305
Validation mse = 0.011761
Epoch 25
Loss = 7.3647e-02, PNorm = 44.5705, GNorm = 0.9337, lr_0 = 3.7848e-04
Loss = 9.4411e-02, PNorm = 44.5806, GNorm = 1.4913, lr_0 = 3.7065e-04
Validation rmse = 0.147572
Validation r2 = 0.724675
Validation mse = 0.021778
Epoch 26
Loss = 1.1173e-01, PNorm = 44.5899, GNorm = 1.3248, lr_0 = 3.6223e-04
Loss = 9.2861e-02, PNorm = 44.5980, GNorm = 0.6283, lr_0 = 3.5474e-04
Validation rmse = 0.100323
Validation r2 = 0.872757
Validation mse = 0.010065
Epoch 27
Loss = 9.3083e-02, PNorm = 44.6101, GNorm = 1.9133, lr_0 = 3.4668e-04
Loss = 8.9304e-02, PNorm = 44.6193, GNorm = 1.7395, lr_0 = 3.3951e-04
Validation rmse = 0.123314
Validation r2 = 0.807751
Validation mse = 0.015206
Epoch 28
Loss = 1.0194e-01, PNorm = 44.6301, GNorm = 1.6844, lr_0 = 3.3180e-04
Loss = 9.9457e-02, PNorm = 44.6399, GNorm = 2.9389, lr_0 = 3.2494e-04
Validation rmse = 0.127501
Validation r2 = 0.794475
Validation mse = 0.016257
Epoch 29
Loss = 9.3177e-02, PNorm = 44.6496, GNorm = 0.8496, lr_0 = 3.1822e-04
Loss = 9.5577e-02, PNorm = 44.6606, GNorm = 2.6290, lr_0 = 3.1164e-04
Validation rmse = 0.102020
Validation r2 = 0.868415
Validation mse = 0.010408
Epoch 30
Loss = 6.8136e-02, PNorm = 44.6720, GNorm = 0.7397, lr_0 = 3.0456e-04
Loss = 7.3892e-02, PNorm = 44.6808, GNorm = 0.5434, lr_0 = 2.9826e-04
Validation rmse = 0.119362
Validation r2 = 0.819876
Validation mse = 0.014247
Epoch 31
Loss = 7.2391e-02, PNorm = 44.6892, GNorm = 0.8242, lr_0 = 2.9148e-04
Loss = 7.9833e-02, PNorm = 44.6954, GNorm = 1.1677, lr_0 = 2.8545e-04
Validation rmse = 0.097065
Validation r2 = 0.880886
Validation mse = 0.009422
Epoch 32
Loss = 5.9674e-02, PNorm = 44.7051, GNorm = 0.4413, lr_0 = 2.7897e-04
Loss = 8.1767e-02, PNorm = 44.7141, GNorm = 1.0666, lr_0 = 2.7320e-04
Validation rmse = 0.118668
Validation r2 = 0.821965
Validation mse = 0.014082
Epoch 33
Loss = 7.5565e-02, PNorm = 44.7218, GNorm = 0.9803, lr_0 = 2.6699e-04
Loss = 7.3235e-02, PNorm = 44.7285, GNorm = 1.4498, lr_0 = 2.6147e-04
Loss = 7.0486e-02, PNorm = 44.7294, GNorm = 3.4441, lr_0 = 2.6092e-04
Validation rmse = 0.113509
Validation r2 = 0.837110
Validation mse = 0.012884
Epoch 34
Loss = 6.2685e-02, PNorm = 44.7387, GNorm = 0.4248, lr_0 = 2.5553e-04
Validation rmse = 0.112291
Validation r2 = 0.840587
Validation mse = 0.012609
Epoch 35
Loss = 8.9463e-02, PNorm = 44.7474, GNorm = 1.5542, lr_0 = 2.4972e-04
Loss = 6.6096e-02, PNorm = 44.7547, GNorm = 1.0671, lr_0 = 2.4456e-04
Validation rmse = 0.087804
Validation r2 = 0.902531
Validation mse = 0.007710
Epoch 36
Loss = 8.4096e-02, PNorm = 44.7618, GNorm = 2.2441, lr_0 = 2.3950e-04
Loss = 7.9846e-02, PNorm = 44.7726, GNorm = 1.2791, lr_0 = 2.3455e-04
Validation rmse = 0.103816
Validation r2 = 0.863740
Validation mse = 0.010778
Epoch 37
Loss = 8.6983e-02, PNorm = 44.7807, GNorm = 2.5875, lr_0 = 2.2922e-04
Loss = 7.2919e-02, PNorm = 44.7874, GNorm = 0.5494, lr_0 = 2.2448e-04
Validation rmse = 0.109832
Validation r2 = 0.847492
Validation mse = 0.012063
Epoch 38
Loss = 5.3781e-02, PNorm = 44.7951, GNorm = 1.6058, lr_0 = 2.1938e-04
Loss = 7.3481e-02, PNorm = 44.8029, GNorm = 2.5890, lr_0 = 2.1484e-04
Validation rmse = 0.110074
Validation r2 = 0.846817
Validation mse = 0.012116
Epoch 39
Loss = 7.2473e-02, PNorm = 44.8117, GNorm = 1.4445, lr_0 = 2.0996e-04
Loss = 6.8800e-02, PNorm = 44.8181, GNorm = 1.1669, lr_0 = 2.0562e-04
Validation rmse = 0.132217
Validation r2 = 0.778989
Validation mse = 0.017481
Epoch 40
Loss = 5.0151e-02, PNorm = 44.8256, GNorm = 0.5428, lr_0 = 2.0095e-04
Loss = 7.0260e-02, PNorm = 44.8304, GNorm = 0.9032, lr_0 = 1.9679e-04
Validation rmse = 0.118920
Validation r2 = 0.821208
Validation mse = 0.014142
Epoch 41
Loss = 5.5496e-02, PNorm = 44.8376, GNorm = 0.6933, lr_0 = 1.9232e-04
Loss = 7.0345e-02, PNorm = 44.8443, GNorm = 1.9847, lr_0 = 1.8835e-04
Validation rmse = 0.122974
Validation r2 = 0.808810
Validation mse = 0.015123
Epoch 42
Loss = 6.9035e-02, PNorm = 44.8509, GNorm = 1.0264, lr_0 = 1.8407e-04
Loss = 6.2333e-02, PNorm = 44.8574, GNorm = 0.9192, lr_0 = 1.8026e-04
Validation rmse = 0.122338
Validation r2 = 0.810782
Validation mse = 0.014967
Epoch 43
Loss = 5.5629e-02, PNorm = 44.8629, GNorm = 0.6385, lr_0 = 1.7653e-04
Loss = 6.3516e-02, PNorm = 44.8687, GNorm = 1.1542, lr_0 = 1.7288e-04
Validation rmse = 0.106273
Validation r2 = 0.857215
Validation mse = 0.011294
Epoch 44
Loss = 5.7071e-02, PNorm = 44.8761, GNorm = 1.5096, lr_0 = 1.6895e-04
Loss = 5.7451e-02, PNorm = 44.8814, GNorm = 0.4777, lr_0 = 1.6546e-04
Validation rmse = 0.102052
Validation r2 = 0.868331
Validation mse = 0.010415
Epoch 45
Loss = 6.1509e-02, PNorm = 44.8883, GNorm = 2.0572, lr_0 = 1.6170e-04
Loss = 6.4614e-02, PNorm = 44.8926, GNorm = 1.0435, lr_0 = 1.5836e-04
Loss = 6.2144e-02, PNorm = 44.8931, GNorm = 1.2329, lr_0 = 1.5803e-04
Validation rmse = 0.109436
Validation r2 = 0.848589
Validation mse = 0.011976
Epoch 46
Loss = 6.3103e-02, PNorm = 44.8990, GNorm = 1.3735, lr_0 = 1.5476e-04
Validation rmse = 0.102281
Validation r2 = 0.867740
Validation mse = 0.010461
Epoch 47
Loss = 5.9598e-02, PNorm = 44.9050, GNorm = 1.4281, lr_0 = 1.5124e-04
Loss = 5.8041e-02, PNorm = 44.9117, GNorm = 0.5240, lr_0 = 1.4811e-04
Validation rmse = 0.124649
Validation r2 = 0.803567
Validation mse = 0.015537
Epoch 48
Loss = 4.7747e-02, PNorm = 44.9178, GNorm = 0.8129, lr_0 = 1.4475e-04
Loss = 6.6918e-02, PNorm = 44.9224, GNorm = 1.0087, lr_0 = 1.4176e-04
Validation rmse = 0.135874
Validation r2 = 0.766594
Validation mse = 0.018462
Epoch 49
Loss = 6.0503e-02, PNorm = 44.9278, GNorm = 1.4382, lr_0 = 1.3854e-04
Loss = 5.3508e-02, PNorm = 44.9334, GNorm = 0.7588, lr_0 = 1.3567e-04
Validation rmse = 0.113067
Validation r2 = 0.838376
Validation mse = 0.012784
Epoch 50
Loss = 5.9131e-02, PNorm = 44.9381, GNorm = 0.7436, lr_0 = 1.3287e-04
Loss = 5.2589e-02, PNorm = 44.9423, GNorm = 0.7851, lr_0 = 1.3012e-04
Validation rmse = 0.126154
Validation r2 = 0.798793
Validation mse = 0.015915
Epoch 51
Loss = 5.6005e-02, PNorm = 44.9477, GNorm = 2.1881, lr_0 = 1.2716e-04
Loss = 5.5962e-02, PNorm = 44.9517, GNorm = 1.3139, lr_0 = 1.2453e-04
Validation rmse = 0.118204
Validation r2 = 0.823356
Validation mse = 0.013972
Epoch 52
Loss = 5.9054e-02, PNorm = 44.9566, GNorm = 1.4402, lr_0 = 1.2170e-04
Loss = 5.3908e-02, PNorm = 44.9608, GNorm = 1.4059, lr_0 = 1.1919e-04
Validation rmse = 0.125229
Validation r2 = 0.801735
Validation mse = 0.015682
Epoch 53
Loss = 6.8906e-02, PNorm = 44.9655, GNorm = 0.8185, lr_0 = 1.1648e-04
Loss = 5.4646e-02, PNorm = 44.9702, GNorm = 0.5734, lr_0 = 1.1407e-04
Validation rmse = 0.122365
Validation r2 = 0.810699
Validation mse = 0.014973
Epoch 54
Loss = 4.4489e-02, PNorm = 44.9740, GNorm = 0.7713, lr_0 = 1.1148e-04
Loss = 5.0999e-02, PNorm = 44.9778, GNorm = 0.7520, lr_0 = 1.0917e-04
Validation rmse = 0.118545
Validation r2 = 0.822334
Validation mse = 0.014053
Epoch 55
Loss = 5.3472e-02, PNorm = 44.9823, GNorm = 1.2415, lr_0 = 1.0669e-04
Loss = 4.6633e-02, PNorm = 44.9862, GNorm = 0.3749, lr_0 = 1.0449e-04
Validation rmse = 0.120571
Validation r2 = 0.816209
Validation mse = 0.014537
Epoch 56
Loss = 4.4890e-02, PNorm = 44.9910, GNorm = 0.8632, lr_0 = 1.0211e-04
Loss = 5.3956e-02, PNorm = 44.9946, GNorm = 1.2388, lr_0 = 1.0000e-04
Loss = 6.4501e-02, PNorm = 44.9950, GNorm = 1.0466, lr_0 = 1.0000e-04
Validation rmse = 0.124472
Validation r2 = 0.804126
Validation mse = 0.015493
Epoch 57
Loss = 4.4897e-02, PNorm = 44.9987, GNorm = 0.6637, lr_0 = 1.0000e-04
Loss = 5.0612e-02, PNorm = 45.0021, GNorm = 1.0623, lr_0 = 1.0000e-04
Validation rmse = 0.125703
Validation r2 = 0.800232
Validation mse = 0.015801
Epoch 58
Loss = 4.8404e-02, PNorm = 45.0055, GNorm = 0.8440, lr_0 = 1.0000e-04
Validation rmse = 0.118687
Validation r2 = 0.821908
Validation mse = 0.014087
Epoch 59
Loss = 2.4387e-02, PNorm = 45.0097, GNorm = 1.3763, lr_0 = 1.0000e-04
Loss = 4.7392e-02, PNorm = 45.0145, GNorm = 1.0201, lr_0 = 1.0000e-04
Validation rmse = 0.127673
Validation r2 = 0.793920
Validation mse = 0.016300
Model 0 best validation rmse = 0.087804 on epoch 35
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.247401
Model 0 test r2 = -0.236148
Model 0 test mse = 0.061207
Ensemble test rmse = 0.247401
Ensemble test r2 = -0.236148
Ensemble test mse = 0.061207
Fold 6
Splitting data with seed 6
Total size = 967 | train size = 957 | val size = 10 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.1657e-01, PNorm = 43.2623, GNorm = 5.4437, lr_0 = 3.6053e-04
Validation rmse = 0.274397
Validation r2 = 0.137712
Validation mse = 0.075294
Epoch 1
Loss = 7.0079e-01, PNorm = 43.2838, GNorm = 2.1631, lr_0 = 6.2105e-04
Loss = 7.0285e-01, PNorm = 43.3255, GNorm = 10.2563, lr_0 = 8.5789e-04
Validation rmse = 0.308881
Validation r2 = -0.092636
Validation mse = 0.095408
Epoch 2
Loss = 6.9279e-01, PNorm = 43.3983, GNorm = 3.8471, lr_0 = 9.8961e-04
Loss = 6.1103e-01, PNorm = 43.4697, GNorm = 4.5023, lr_0 = 9.6914e-04
Validation rmse = 0.283221
Validation r2 = 0.081366
Validation mse = 0.080214
Epoch 3
Loss = 4.5370e-01, PNorm = 43.5558, GNorm = 2.9649, lr_0 = 9.4712e-04
Loss = 4.0869e-01, PNorm = 43.6088, GNorm = 0.9208, lr_0 = 9.2754e-04
Validation rmse = 0.188273
Validation r2 = 0.594054
Validation mse = 0.035447
Epoch 4
Loss = 3.0642e-01, PNorm = 43.6785, GNorm = 4.3830, lr_0 = 9.0646e-04
Loss = 3.1815e-01, PNorm = 43.7298, GNorm = 1.9995, lr_0 = 8.8772e-04
Validation rmse = 0.159786
Validation r2 = 0.707604
Validation mse = 0.025532
Epoch 5
Loss = 2.9054e-01, PNorm = 43.7873, GNorm = 3.0908, lr_0 = 8.6755e-04
Loss = 2.4805e-01, PNorm = 43.8381, GNorm = 2.6367, lr_0 = 8.4961e-04
Validation rmse = 0.145589
Validation r2 = 0.757254
Validation mse = 0.021196
Epoch 6
Loss = 2.0733e-01, PNorm = 43.8802, GNorm = 1.8330, lr_0 = 8.3031e-04
Loss = 2.3397e-01, PNorm = 43.9229, GNorm = 1.4952, lr_0 = 8.1314e-04
Validation rmse = 0.136014
Validation r2 = 0.788134
Validation mse = 0.018500
Epoch 7
Loss = 2.0139e-01, PNorm = 43.9614, GNorm = 1.4528, lr_0 = 7.9466e-04
Loss = 2.1272e-01, PNorm = 43.9988, GNorm = 1.0320, lr_0 = 7.7823e-04
Validation rmse = 0.159231
Validation r2 = 0.709633
Validation mse = 0.025354
Epoch 8
Loss = 1.3991e-01, PNorm = 44.0305, GNorm = 1.1647, lr_0 = 7.6214e-04
Loss = 1.6339e-01, PNorm = 44.0590, GNorm = 3.0223, lr_0 = 7.4638e-04
Validation rmse = 0.108784
Validation r2 = 0.864475
Validation mse = 0.011834
Epoch 9
Loss = 1.4054e-01, PNorm = 44.0852, GNorm = 1.6004, lr_0 = 7.2942e-04
Loss = 1.5158e-01, PNorm = 44.1091, GNorm = 1.9492, lr_0 = 7.1434e-04
Validation rmse = 0.162408
Validation r2 = 0.697928
Validation mse = 0.026377
Epoch 10
Loss = 1.4958e-01, PNorm = 44.1330, GNorm = 1.7381, lr_0 = 6.9810e-04
Loss = 1.2552e-01, PNorm = 44.1532, GNorm = 2.1522, lr_0 = 6.8367e-04
Loss = 1.9484e-01, PNorm = 44.1562, GNorm = 4.4366, lr_0 = 6.8224e-04
Validation rmse = 0.137322
Validation r2 = 0.784041
Validation mse = 0.018857
Epoch 11
Loss = 1.4602e-01, PNorm = 44.1814, GNorm = 3.8314, lr_0 = 6.6813e-04
Validation rmse = 0.125292
Validation r2 = 0.820222
Validation mse = 0.015698
Epoch 12
Loss = 7.4661e-02, PNorm = 44.2014, GNorm = 0.8952, lr_0 = 6.5295e-04
Loss = 1.2588e-01, PNorm = 44.2127, GNorm = 1.6401, lr_0 = 6.3945e-04
Validation rmse = 0.123421
Validation r2 = 0.825549
Validation mse = 0.015233
Epoch 13
Loss = 1.0113e-01, PNorm = 44.2360, GNorm = 0.8225, lr_0 = 6.2492e-04
Loss = 1.2455e-01, PNorm = 44.2550, GNorm = 1.7000, lr_0 = 6.1200e-04
Validation rmse = 0.133555
Validation r2 = 0.795725
Validation mse = 0.017837
Epoch 14
Loss = 1.1377e-01, PNorm = 44.2772, GNorm = 1.1168, lr_0 = 5.9809e-04
Loss = 1.2644e-01, PNorm = 44.2984, GNorm = 2.6043, lr_0 = 5.8573e-04
Validation rmse = 0.139760
Validation r2 = 0.776305
Validation mse = 0.019533
Epoch 15
Loss = 2.1177e-01, PNorm = 44.3175, GNorm = 1.9931, lr_0 = 5.7362e-04
Loss = 1.4512e-01, PNorm = 44.3437, GNorm = 1.3185, lr_0 = 5.6175e-04
Validation rmse = 0.175209
Validation r2 = 0.648435
Validation mse = 0.030698
Epoch 16
Loss = 1.5775e-01, PNorm = 44.3709, GNorm = 1.8237, lr_0 = 5.4899e-04
Loss = 1.4202e-01, PNorm = 44.3966, GNorm = 2.2860, lr_0 = 5.3764e-04
Validation rmse = 0.128225
Validation r2 = 0.811704
Validation mse = 0.016442
Epoch 17
Loss = 1.3479e-01, PNorm = 44.4214, GNorm = 3.4090, lr_0 = 5.2542e-04
Loss = 1.2547e-01, PNorm = 44.4393, GNorm = 0.8658, lr_0 = 5.1456e-04
Validation rmse = 0.131614
Validation r2 = 0.801619
Validation mse = 0.017322
Epoch 18
Loss = 1.0274e-01, PNorm = 44.4560, GNorm = 1.4359, lr_0 = 5.0287e-04
Loss = 1.1313e-01, PNorm = 44.4701, GNorm = 3.2110, lr_0 = 4.9247e-04
Validation rmse = 0.142235
Validation r2 = 0.768310
Validation mse = 0.020231
Epoch 19
Loss = 1.0205e-01, PNorm = 44.4865, GNorm = 1.3990, lr_0 = 4.8128e-04
Loss = 1.0731e-01, PNorm = 44.4978, GNorm = 1.1896, lr_0 = 4.7133e-04
Validation rmse = 0.129282
Validation r2 = 0.808587
Validation mse = 0.016714
Epoch 20
Loss = 9.5699e-02, PNorm = 44.5127, GNorm = 1.3131, lr_0 = 4.6062e-04
Loss = 9.2654e-02, PNorm = 44.5221, GNorm = 0.7169, lr_0 = 4.5109e-04
Validation rmse = 0.131261
Validation r2 = 0.802682
Validation mse = 0.017230
Epoch 21
Loss = 1.0540e-01, PNorm = 44.5361, GNorm = 0.8430, lr_0 = 4.4084e-04
Loss = 8.1831e-02, PNorm = 44.5484, GNorm = 0.7651, lr_0 = 4.3173e-04
Validation rmse = 0.121174
Validation r2 = 0.831845
Validation mse = 0.014683
Epoch 22
Loss = 8.7573e-02, PNorm = 44.5593, GNorm = 0.7833, lr_0 = 4.2280e-04
Loss = 8.6723e-02, PNorm = 44.5701, GNorm = 1.0272, lr_0 = 4.1406e-04
Loss = 1.3010e-01, PNorm = 44.5710, GNorm = 1.4182, lr_0 = 4.1319e-04
Validation rmse = 0.126441
Validation r2 = 0.816908
Validation mse = 0.015987
Epoch 23
Loss = 7.6309e-02, PNorm = 44.5813, GNorm = 0.5137, lr_0 = 4.0465e-04
Validation rmse = 0.123542
Validation r2 = 0.825208
Validation mse = 0.015263
Epoch 24
Loss = 9.3324e-02, PNorm = 44.5915, GNorm = 2.1105, lr_0 = 3.9545e-04
Loss = 7.9890e-02, PNorm = 44.6000, GNorm = 0.3748, lr_0 = 3.8728e-04
Validation rmse = 0.116478
Validation r2 = 0.844626
Validation mse = 0.013567
Epoch 25
Loss = 5.7311e-02, PNorm = 44.6122, GNorm = 0.8051, lr_0 = 3.7848e-04
Loss = 7.4676e-02, PNorm = 44.6237, GNorm = 0.5387, lr_0 = 3.7065e-04
Validation rmse = 0.137533
Validation r2 = 0.783376
Validation mse = 0.018915
Epoch 26
Loss = 7.2246e-02, PNorm = 44.6360, GNorm = 1.2751, lr_0 = 3.6223e-04
Loss = 1.0216e-01, PNorm = 44.6499, GNorm = 1.5836, lr_0 = 3.5474e-04
Validation rmse = 0.129741
Validation r2 = 0.807226
Validation mse = 0.016833
Epoch 27
Loss = 7.7808e-02, PNorm = 44.6620, GNorm = 0.7509, lr_0 = 3.4668e-04
Loss = 8.4014e-02, PNorm = 44.6726, GNorm = 1.8529, lr_0 = 3.3951e-04
Validation rmse = 0.122061
Validation r2 = 0.829372
Validation mse = 0.014899
Epoch 28
Loss = 8.2245e-02, PNorm = 44.6817, GNorm = 0.9441, lr_0 = 3.3180e-04
Loss = 7.4233e-02, PNorm = 44.6926, GNorm = 0.9608, lr_0 = 3.2494e-04
Validation rmse = 0.128882
Validation r2 = 0.809772
Validation mse = 0.016610
Epoch 29
Loss = 8.8648e-02, PNorm = 44.7019, GNorm = 0.6635, lr_0 = 3.1822e-04
Loss = 7.7428e-02, PNorm = 44.7112, GNorm = 0.8864, lr_0 = 3.1164e-04
Validation rmse = 0.136480
Validation r2 = 0.786679
Validation mse = 0.018627
Epoch 30
Loss = 5.9131e-02, PNorm = 44.7194, GNorm = 0.4274, lr_0 = 3.0456e-04
Loss = 8.0396e-02, PNorm = 44.7263, GNorm = 0.6791, lr_0 = 2.9826e-04
Validation rmse = 0.126734
Validation r2 = 0.816058
Validation mse = 0.016062
Epoch 31
Loss = 6.9047e-02, PNorm = 44.7381, GNorm = 1.4119, lr_0 = 2.9148e-04
Loss = 7.5147e-02, PNorm = 44.7472, GNorm = 1.6139, lr_0 = 2.8545e-04
Validation rmse = 0.124122
Validation r2 = 0.823561
Validation mse = 0.015406
Epoch 32
Loss = 6.5448e-02, PNorm = 44.7545, GNorm = 1.0843, lr_0 = 2.7897e-04
Loss = 7.4572e-02, PNorm = 44.7633, GNorm = 0.7659, lr_0 = 2.7320e-04
Validation rmse = 0.131995
Validation r2 = 0.800471
Validation mse = 0.017423
Epoch 33
Loss = 7.0145e-02, PNorm = 44.7720, GNorm = 0.4729, lr_0 = 2.6699e-04
Loss = 6.9772e-02, PNorm = 44.7798, GNorm = 0.9302, lr_0 = 2.6147e-04
Loss = 1.1084e-01, PNorm = 44.7804, GNorm = 2.1965, lr_0 = 2.6092e-04
Validation rmse = 0.123443
Validation r2 = 0.825489
Validation mse = 0.015238
Epoch 34
Loss = 7.5540e-02, PNorm = 44.7883, GNorm = 1.9885, lr_0 = 2.5553e-04
Validation rmse = 0.135158
Validation r2 = 0.790793
Validation mse = 0.018268
Epoch 35
Loss = 5.7345e-02, PNorm = 44.7978, GNorm = 0.4631, lr_0 = 2.4972e-04
Loss = 7.5153e-02, PNorm = 44.8076, GNorm = 1.2886, lr_0 = 2.4456e-04
Validation rmse = 0.126684
Validation r2 = 0.816203
Validation mse = 0.016049
Epoch 36
Loss = 7.7988e-02, PNorm = 44.8151, GNorm = 0.7316, lr_0 = 2.3950e-04
Loss = 6.8077e-02, PNorm = 44.8234, GNorm = 0.6436, lr_0 = 2.3455e-04
Validation rmse = 0.134048
Validation r2 = 0.794215
Validation mse = 0.017969
Epoch 37
Loss = 6.2187e-02, PNorm = 44.8325, GNorm = 1.1195, lr_0 = 2.2922e-04
Loss = 7.1892e-02, PNorm = 44.8403, GNorm = 2.3609, lr_0 = 2.2448e-04
Validation rmse = 0.139161
Validation r2 = 0.778217
Validation mse = 0.019366
Epoch 38
Loss = 8.2593e-02, PNorm = 44.8475, GNorm = 2.3134, lr_0 = 2.1938e-04
Loss = 6.7388e-02, PNorm = 44.8542, GNorm = 1.5176, lr_0 = 2.1484e-04
Validation rmse = 0.115207
Validation r2 = 0.847996
Validation mse = 0.013273
Epoch 39
Loss = 6.3829e-02, PNorm = 44.8622, GNorm = 0.5635, lr_0 = 2.0996e-04
Loss = 6.2987e-02, PNorm = 44.8686, GNorm = 0.8212, lr_0 = 2.0562e-04
Validation rmse = 0.139663
Validation r2 = 0.776615
Validation mse = 0.019506
Epoch 40
Loss = 7.2441e-02, PNorm = 44.8769, GNorm = 1.7958, lr_0 = 2.0095e-04
Loss = 6.5200e-02, PNorm = 44.8842, GNorm = 1.7301, lr_0 = 1.9679e-04
Validation rmse = 0.126990
Validation r2 = 0.815315
Validation mse = 0.016126
Epoch 41
Loss = 5.8173e-02, PNorm = 44.8891, GNorm = 1.3506, lr_0 = 1.9232e-04
Loss = 7.2185e-02, PNorm = 44.8947, GNorm = 0.7734, lr_0 = 1.8835e-04
Validation rmse = 0.125810
Validation r2 = 0.818730
Validation mse = 0.015828
Epoch 42
Loss = 5.3748e-02, PNorm = 44.9014, GNorm = 0.5810, lr_0 = 1.8407e-04
Loss = 6.7301e-02, PNorm = 44.9074, GNorm = 0.5982, lr_0 = 1.8026e-04
Validation rmse = 0.130457
Validation r2 = 0.805092
Validation mse = 0.017019
Epoch 43
Loss = 6.1423e-02, PNorm = 44.9124, GNorm = 0.6458, lr_0 = 1.7653e-04
Loss = 6.2169e-02, PNorm = 44.9185, GNorm = 0.8232, lr_0 = 1.7288e-04
Validation rmse = 0.129437
Validation r2 = 0.808130
Validation mse = 0.016754
Epoch 44
Loss = 5.8198e-02, PNorm = 44.9239, GNorm = 1.6065, lr_0 = 1.6895e-04
Loss = 5.8958e-02, PNorm = 44.9302, GNorm = 1.2171, lr_0 = 1.6546e-04
Validation rmse = 0.120678
Validation r2 = 0.833218
Validation mse = 0.014563
Epoch 45
Loss = 5.9981e-02, PNorm = 44.9357, GNorm = 1.3822, lr_0 = 1.6170e-04
Loss = 5.7886e-02, PNorm = 44.9405, GNorm = 0.5309, lr_0 = 1.5836e-04
Loss = 3.3976e-02, PNorm = 44.9410, GNorm = 1.3720, lr_0 = 1.5803e-04
Validation rmse = 0.123812
Validation r2 = 0.824443
Validation mse = 0.015329
Epoch 46
Loss = 5.3814e-02, PNorm = 44.9455, GNorm = 0.8453, lr_0 = 1.5476e-04
Validation rmse = 0.131144
Validation r2 = 0.803036
Validation mse = 0.017199
Epoch 47
Loss = 5.6047e-02, PNorm = 44.9513, GNorm = 0.5531, lr_0 = 1.5124e-04
Loss = 5.3473e-02, PNorm = 44.9557, GNorm = 0.6232, lr_0 = 1.4811e-04
Validation rmse = 0.128732
Validation r2 = 0.810212
Validation mse = 0.016572
Epoch 48
Loss = 5.0095e-02, PNorm = 44.9604, GNorm = 0.7214, lr_0 = 1.4475e-04
Loss = 5.0244e-02, PNorm = 44.9657, GNorm = 1.2953, lr_0 = 1.4176e-04
Validation rmse = 0.132477
Validation r2 = 0.799012
Validation mse = 0.017550
Epoch 49
Loss = 5.1690e-02, PNorm = 44.9713, GNorm = 0.5081, lr_0 = 1.3854e-04
Loss = 5.1353e-02, PNorm = 44.9755, GNorm = 1.0734, lr_0 = 1.3567e-04
Validation rmse = 0.125095
Validation r2 = 0.820785
Validation mse = 0.015649
Epoch 50
Loss = 5.7345e-02, PNorm = 44.9799, GNorm = 1.1418, lr_0 = 1.3287e-04
Loss = 5.2162e-02, PNorm = 44.9845, GNorm = 0.5582, lr_0 = 1.3012e-04
Validation rmse = 0.129009
Validation r2 = 0.809396
Validation mse = 0.016643
Epoch 51
Loss = 5.3356e-02, PNorm = 44.9892, GNorm = 0.6201, lr_0 = 1.2716e-04
Loss = 5.4259e-02, PNorm = 44.9931, GNorm = 0.9310, lr_0 = 1.2453e-04
Validation rmse = 0.126115
Validation r2 = 0.817851
Validation mse = 0.015905
Epoch 52
Loss = 5.2685e-02, PNorm = 44.9973, GNorm = 0.6479, lr_0 = 1.2170e-04
Loss = 5.3802e-02, PNorm = 45.0015, GNorm = 1.2143, lr_0 = 1.1919e-04
Validation rmse = 0.139687
Validation r2 = 0.776537
Validation mse = 0.019512
Epoch 53
Loss = 5.1288e-02, PNorm = 45.0067, GNorm = 0.4920, lr_0 = 1.1648e-04
Loss = 4.7477e-02, PNorm = 45.0113, GNorm = 0.6217, lr_0 = 1.1407e-04
Validation rmse = 0.129441
Validation r2 = 0.808117
Validation mse = 0.016755
Epoch 54
Loss = 4.6772e-02, PNorm = 45.0148, GNorm = 0.4434, lr_0 = 1.1148e-04
Loss = 4.9108e-02, PNorm = 45.0189, GNorm = 0.7442, lr_0 = 1.0917e-04
Validation rmse = 0.138275
Validation r2 = 0.781031
Validation mse = 0.019120
Epoch 55
Loss = 4.5598e-02, PNorm = 45.0229, GNorm = 0.7679, lr_0 = 1.0669e-04
Loss = 5.7122e-02, PNorm = 45.0262, GNorm = 0.9327, lr_0 = 1.0449e-04
Validation rmse = 0.132327
Validation r2 = 0.799465
Validation mse = 0.017510
Epoch 56
Loss = 4.3621e-02, PNorm = 45.0299, GNorm = 0.4304, lr_0 = 1.0211e-04
Loss = 5.4033e-02, PNorm = 45.0338, GNorm = 1.4416, lr_0 = 1.0000e-04
Loss = 2.1268e-01, PNorm = 45.0341, GNorm = 2.6295, lr_0 = 1.0000e-04
Validation rmse = 0.131508
Validation r2 = 0.801941
Validation mse = 0.017294
Epoch 57
Loss = 5.6583e-02, PNorm = 45.0375, GNorm = 0.5612, lr_0 = 1.0000e-04
Loss = 4.2725e-02, PNorm = 45.0413, GNorm = 2.4484, lr_0 = 1.0000e-04
Validation rmse = 0.131856
Validation r2 = 0.800890
Validation mse = 0.017386
Epoch 58
Loss = 5.5278e-02, PNorm = 45.0462, GNorm = 0.6608, lr_0 = 1.0000e-04
Validation rmse = 0.136134
Validation r2 = 0.787762
Validation mse = 0.018532
Epoch 59
Loss = 3.8061e-02, PNorm = 45.0497, GNorm = 0.8661, lr_0 = 1.0000e-04
Loss = 5.1167e-02, PNorm = 45.0539, GNorm = 0.5824, lr_0 = 1.0000e-04
Validation rmse = 0.131808
Validation r2 = 0.801036
Validation mse = 0.017373
Model 0 best validation rmse = 0.108784 on epoch 8
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.292814
Model 0 test r2 = -0.731624
Model 0 test mse = 0.085740
Ensemble test rmse = 0.292814
Ensemble test r2 = -0.731624
Ensemble test mse = 0.085740
Fold 7
Splitting data with seed 7
Total size = 967 | train size = 957 | val size = 10 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 8.8661e-01, PNorm = 43.2625, GNorm = 6.6118, lr_0 = 3.6053e-04
Validation rmse = 0.365639
Validation r2 = 0.150855
Validation mse = 0.133692
Epoch 1
Loss = 8.7450e-01, PNorm = 43.2824, GNorm = 11.4636, lr_0 = 6.2105e-04
Loss = 7.3896e-01, PNorm = 43.3227, GNorm = 3.5760, lr_0 = 8.5789e-04
Validation rmse = 0.220361
Validation r2 = 0.691579
Validation mse = 0.048559
Epoch 2
Loss = 4.9369e-01, PNorm = 43.4115, GNorm = 5.1419, lr_0 = 9.8961e-04
Loss = 4.5134e-01, PNorm = 43.5019, GNorm = 7.4206, lr_0 = 9.6914e-04
Validation rmse = 0.196610
Validation r2 = 0.754480
Validation mse = 0.038655
Epoch 3
Loss = 4.3991e-01, PNorm = 43.5657, GNorm = 1.0964, lr_0 = 9.4712e-04
Loss = 3.2040e-01, PNorm = 43.6245, GNorm = 2.6738, lr_0 = 9.2754e-04
Validation rmse = 0.136701
Validation r2 = 0.881309
Validation mse = 0.018687
Epoch 4
Loss = 3.5069e-01, PNorm = 43.6788, GNorm = 3.0677, lr_0 = 9.0646e-04
Loss = 2.4258e-01, PNorm = 43.7214, GNorm = 0.6587, lr_0 = 8.8772e-04
Validation rmse = 0.121193
Validation r2 = 0.906711
Validation mse = 0.014688
Epoch 5
Loss = 2.1088e-01, PNorm = 43.7627, GNorm = 4.8649, lr_0 = 8.6755e-04
Loss = 2.1742e-01, PNorm = 43.7993, GNorm = 2.5428, lr_0 = 8.4961e-04
Validation rmse = 0.081222
Validation r2 = 0.958099
Validation mse = 0.006597
Epoch 6
Loss = 2.2582e-01, PNorm = 43.8445, GNorm = 1.6651, lr_0 = 8.3031e-04
Loss = 2.2095e-01, PNorm = 43.8872, GNorm = 2.7800, lr_0 = 8.1314e-04
Validation rmse = 0.108806
Validation r2 = 0.924806
Validation mse = 0.011839
Epoch 7
Loss = 1.8108e-01, PNorm = 43.9223, GNorm = 1.1063, lr_0 = 7.9466e-04
Loss = 1.4981e-01, PNorm = 43.9514, GNorm = 1.3163, lr_0 = 7.7823e-04
Validation rmse = 0.082412
Validation r2 = 0.956862
Validation mse = 0.006792
Epoch 8
Loss = 1.3261e-01, PNorm = 43.9793, GNorm = 0.9140, lr_0 = 7.6214e-04
Loss = 1.5653e-01, PNorm = 44.0021, GNorm = 2.2293, lr_0 = 7.4638e-04
Validation rmse = 0.124494
Validation r2 = 0.901559
Validation mse = 0.015499
Epoch 9
Loss = 2.0076e-01, PNorm = 44.0255, GNorm = 7.0021, lr_0 = 7.2942e-04
Loss = 1.7398e-01, PNorm = 44.0582, GNorm = 4.2278, lr_0 = 7.1434e-04
Validation rmse = 0.108283
Validation r2 = 0.925528
Validation mse = 0.011725
Epoch 10
Loss = 1.3704e-01, PNorm = 44.0853, GNorm = 2.5624, lr_0 = 6.9810e-04
Loss = 1.6995e-01, PNorm = 44.1094, GNorm = 3.3497, lr_0 = 6.8367e-04
Loss = 1.8321e-01, PNorm = 44.1107, GNorm = 3.8237, lr_0 = 6.8224e-04
Validation rmse = 0.065278
Validation r2 = 0.972935
Validation mse = 0.004261
Epoch 11
Loss = 1.3643e-01, PNorm = 44.1307, GNorm = 2.4961, lr_0 = 6.6813e-04
Validation rmse = 0.082007
Validation r2 = 0.957285
Validation mse = 0.006725
Epoch 12
Loss = 1.2315e-01, PNorm = 44.1542, GNorm = 2.4591, lr_0 = 6.5295e-04
Loss = 1.3606e-01, PNorm = 44.1747, GNorm = 1.7377, lr_0 = 6.3945e-04
Validation rmse = 0.119378
Validation r2 = 0.909484
Validation mse = 0.014251
Epoch 13
Loss = 1.7510e-01, PNorm = 44.1945, GNorm = 4.2693, lr_0 = 6.2492e-04
Loss = 1.5842e-01, PNorm = 44.2161, GNorm = 3.0153, lr_0 = 6.1200e-04
Validation rmse = 0.079664
Validation r2 = 0.959691
Validation mse = 0.006346
Epoch 14
Loss = 1.2170e-01, PNorm = 44.2350, GNorm = 2.0894, lr_0 = 5.9809e-04
Loss = 1.1376e-01, PNorm = 44.2530, GNorm = 0.8273, lr_0 = 5.8573e-04
Validation rmse = 0.070444
Validation r2 = 0.968482
Validation mse = 0.004962
Epoch 15
Loss = 1.0916e-01, PNorm = 44.2736, GNorm = 1.5620, lr_0 = 5.7362e-04
Loss = 1.0041e-01, PNorm = 44.2874, GNorm = 1.0650, lr_0 = 5.6175e-04
Validation rmse = 0.050304
Validation r2 = 0.983927
Validation mse = 0.002531
Epoch 16
Loss = 7.8640e-02, PNorm = 44.3053, GNorm = 0.6503, lr_0 = 5.4899e-04
Loss = 1.1348e-01, PNorm = 44.3164, GNorm = 0.9251, lr_0 = 5.3764e-04
Validation rmse = 0.099308
Validation r2 = 0.937361
Validation mse = 0.009862
Epoch 17
Loss = 1.1619e-01, PNorm = 44.3397, GNorm = 2.3841, lr_0 = 5.2542e-04
Loss = 1.2012e-01, PNorm = 44.3582, GNorm = 2.6245, lr_0 = 5.1456e-04
Validation rmse = 0.075690
Validation r2 = 0.963613
Validation mse = 0.005729
Epoch 18
Loss = 9.5903e-02, PNorm = 44.3782, GNorm = 1.1477, lr_0 = 5.0287e-04
Loss = 1.0941e-01, PNorm = 44.3916, GNorm = 0.9341, lr_0 = 4.9247e-04
Validation rmse = 0.078984
Validation r2 = 0.960376
Validation mse = 0.006238
Epoch 19
Loss = 9.8523e-02, PNorm = 44.4017, GNorm = 1.2468, lr_0 = 4.8128e-04
Loss = 1.0299e-01, PNorm = 44.4141, GNorm = 0.6853, lr_0 = 4.7133e-04
Validation rmse = 0.078816
Validation r2 = 0.960544
Validation mse = 0.006212
Epoch 20
Loss = 8.7012e-02, PNorm = 44.4272, GNorm = 0.6008, lr_0 = 4.6062e-04
Loss = 1.0245e-01, PNorm = 44.4361, GNorm = 2.2563, lr_0 = 4.5109e-04
Validation rmse = 0.073924
Validation r2 = 0.965290
Validation mse = 0.005465
Epoch 21
Loss = 8.4085e-02, PNorm = 44.4484, GNorm = 1.3859, lr_0 = 4.4084e-04
Loss = 9.8089e-02, PNorm = 44.4572, GNorm = 1.3477, lr_0 = 4.3173e-04
Validation rmse = 0.065988
Validation r2 = 0.972343
Validation mse = 0.004354
Epoch 22
Loss = 9.4266e-02, PNorm = 44.4712, GNorm = 1.3106, lr_0 = 4.2280e-04
Loss = 9.0179e-02, PNorm = 44.4814, GNorm = 0.9613, lr_0 = 4.1406e-04
Loss = 2.6116e-02, PNorm = 44.4828, GNorm = 1.3707, lr_0 = 4.1319e-04
Validation rmse = 0.090595
Validation r2 = 0.947870
Validation mse = 0.008207
Epoch 23
Loss = 8.5928e-02, PNorm = 44.4936, GNorm = 0.4374, lr_0 = 4.0465e-04
Validation rmse = 0.114778
Validation r2 = 0.916326
Validation mse = 0.013174
Epoch 24
Loss = 9.4958e-02, PNorm = 44.5073, GNorm = 3.5649, lr_0 = 3.9545e-04
Loss = 1.1892e-01, PNorm = 44.5204, GNorm = 3.0973, lr_0 = 3.8728e-04
Validation rmse = 0.102269
Validation r2 = 0.933570
Validation mse = 0.010459
Epoch 25
Loss = 7.3071e-02, PNorm = 44.5319, GNorm = 1.4569, lr_0 = 3.7848e-04
Loss = 1.0486e-01, PNorm = 44.5437, GNorm = 1.0582, lr_0 = 3.7065e-04
Validation rmse = 0.080610
Validation r2 = 0.958728
Validation mse = 0.006498
Epoch 26
Loss = 1.0163e-01, PNorm = 44.5571, GNorm = 2.8776, lr_0 = 3.6223e-04
Loss = 9.8311e-02, PNorm = 44.5704, GNorm = 0.7839, lr_0 = 3.5474e-04
Validation rmse = 0.077074
Validation r2 = 0.962269
Validation mse = 0.005940
Epoch 27
Loss = 9.9180e-02, PNorm = 44.5813, GNorm = 1.1483, lr_0 = 3.4668e-04
Loss = 8.8959e-02, PNorm = 44.5933, GNorm = 1.5964, lr_0 = 3.3951e-04
Validation rmse = 0.095242
Validation r2 = 0.942385
Validation mse = 0.009071
Epoch 28
Loss = 1.1024e-01, PNorm = 44.6016, GNorm = 1.0114, lr_0 = 3.3180e-04
Loss = 7.4277e-02, PNorm = 44.6130, GNorm = 0.7989, lr_0 = 3.2494e-04
Validation rmse = 0.097812
Validation r2 = 0.939234
Validation mse = 0.009567
Epoch 29
Loss = 8.7448e-02, PNorm = 44.6216, GNorm = 2.0518, lr_0 = 3.1822e-04
Loss = 8.3411e-02, PNorm = 44.6302, GNorm = 0.5761, lr_0 = 3.1164e-04
Validation rmse = 0.081718
Validation r2 = 0.957586
Validation mse = 0.006678
Epoch 30
Loss = 1.0343e-01, PNorm = 44.6443, GNorm = 1.7521, lr_0 = 3.0456e-04
Loss = 8.4723e-02, PNorm = 44.6565, GNorm = 1.6570, lr_0 = 2.9826e-04
Validation rmse = 0.080071
Validation r2 = 0.959279
Validation mse = 0.006411
Epoch 31
Loss = 7.3117e-02, PNorm = 44.6682, GNorm = 0.9412, lr_0 = 2.9148e-04
Loss = 8.6512e-02, PNorm = 44.6790, GNorm = 1.0483, lr_0 = 2.8545e-04
Validation rmse = 0.092218
Validation r2 = 0.945986
Validation mse = 0.008504
Epoch 32
Loss = 7.3208e-02, PNorm = 44.6890, GNorm = 1.9296, lr_0 = 2.7897e-04
Loss = 7.3371e-02, PNorm = 44.6968, GNorm = 0.6873, lr_0 = 2.7320e-04
Validation rmse = 0.101168
Validation r2 = 0.934993
Validation mse = 0.010235
Epoch 33
Loss = 6.8882e-02, PNorm = 44.7054, GNorm = 2.4160, lr_0 = 2.6699e-04
Loss = 7.5919e-02, PNorm = 44.7129, GNorm = 0.9921, lr_0 = 2.6147e-04
Loss = 4.7588e-02, PNorm = 44.7137, GNorm = 1.5333, lr_0 = 2.6092e-04
Validation rmse = 0.104611
Validation r2 = 0.930492
Validation mse = 0.010943
Epoch 34
Loss = 7.7147e-02, PNorm = 44.7198, GNorm = 1.3624, lr_0 = 2.5553e-04
Validation rmse = 0.089020
Validation r2 = 0.949667
Validation mse = 0.007925
Epoch 35
Loss = 7.1517e-02, PNorm = 44.7289, GNorm = 1.5578, lr_0 = 2.4972e-04
Loss = 7.2967e-02, PNorm = 44.7369, GNorm = 1.0138, lr_0 = 2.4456e-04
Validation rmse = 0.098826
Validation r2 = 0.937967
Validation mse = 0.009767
Epoch 36
Loss = 7.0603e-02, PNorm = 44.7439, GNorm = 0.8606, lr_0 = 2.3950e-04
Loss = 6.8782e-02, PNorm = 44.7517, GNorm = 0.3886, lr_0 = 2.3455e-04
Validation rmse = 0.102211
Validation r2 = 0.933646
Validation mse = 0.010447
Epoch 37
Loss = 9.7864e-02, PNorm = 44.7595, GNorm = 1.9364, lr_0 = 2.2922e-04
Loss = 8.1927e-02, PNorm = 44.7658, GNorm = 1.8524, lr_0 = 2.2448e-04
Validation rmse = 0.089738
Validation r2 = 0.948852
Validation mse = 0.008053
Epoch 38
Loss = 6.1371e-02, PNorm = 44.7765, GNorm = 1.2722, lr_0 = 2.1938e-04
Loss = 6.9898e-02, PNorm = 44.7828, GNorm = 0.9345, lr_0 = 2.1484e-04
Validation rmse = 0.092953
Validation r2 = 0.945121
Validation mse = 0.008640
Epoch 39
Loss = 8.1087e-02, PNorm = 44.7895, GNorm = 2.9893, lr_0 = 2.0996e-04
Loss = 7.6472e-02, PNorm = 44.7961, GNorm = 1.7603, lr_0 = 2.0562e-04
Validation rmse = 0.107160
Validation r2 = 0.927064
Validation mse = 0.011483
Epoch 40
Loss = 6.9825e-02, PNorm = 44.8044, GNorm = 1.7020, lr_0 = 2.0095e-04
Loss = 6.6554e-02, PNorm = 44.8121, GNorm = 0.7409, lr_0 = 1.9679e-04
Validation rmse = 0.093124
Validation r2 = 0.944919
Validation mse = 0.008672
Epoch 41
Loss = 6.3644e-02, PNorm = 44.8171, GNorm = 1.2634, lr_0 = 1.9232e-04
Loss = 6.7584e-02, PNorm = 44.8228, GNorm = 0.4933, lr_0 = 1.8835e-04
Validation rmse = 0.092209
Validation r2 = 0.945996
Validation mse = 0.008503
Epoch 42
Loss = 6.9444e-02, PNorm = 44.8313, GNorm = 0.7420, lr_0 = 1.8407e-04
Loss = 6.4203e-02, PNorm = 44.8370, GNorm = 0.7640, lr_0 = 1.8026e-04
Validation rmse = 0.106876
Validation r2 = 0.927450
Validation mse = 0.011422
Epoch 43
Loss = 6.4003e-02, PNorm = 44.8426, GNorm = 1.6129, lr_0 = 1.7653e-04
Loss = 5.8301e-02, PNorm = 44.8499, GNorm = 0.9648, lr_0 = 1.7288e-04
Validation rmse = 0.098051
Validation r2 = 0.938936
Validation mse = 0.009614
Epoch 44
Loss = 7.2702e-02, PNorm = 44.8551, GNorm = 0.8715, lr_0 = 1.6895e-04
Loss = 5.9918e-02, PNorm = 44.8604, GNorm = 0.8829, lr_0 = 1.6546e-04
Validation rmse = 0.098967
Validation r2 = 0.937791
Validation mse = 0.009794
Epoch 45
Loss = 5.1100e-02, PNorm = 44.8665, GNorm = 0.7345, lr_0 = 1.6170e-04
Loss = 6.6578e-02, PNorm = 44.8724, GNorm = 0.6161, lr_0 = 1.5836e-04
Loss = 7.5113e-02, PNorm = 44.8729, GNorm = 2.6132, lr_0 = 1.5803e-04
Validation rmse = 0.107689
Validation r2 = 0.926342
Validation mse = 0.011597
Epoch 46
Loss = 5.5988e-02, PNorm = 44.8786, GNorm = 0.4696, lr_0 = 1.5476e-04
Validation rmse = 0.101512
Validation r2 = 0.934550
Validation mse = 0.010305
Epoch 47
Loss = 2.9678e-02, PNorm = 44.8846, GNorm = 0.6650, lr_0 = 1.5124e-04
Loss = 6.2015e-02, PNorm = 44.8892, GNorm = 0.8708, lr_0 = 1.4811e-04
Validation rmse = 0.104727
Validation r2 = 0.930339
Validation mse = 0.010968
Epoch 48
Loss = 6.0372e-02, PNorm = 44.8946, GNorm = 1.0111, lr_0 = 1.4475e-04
Loss = 5.6573e-02, PNorm = 44.8999, GNorm = 0.8901, lr_0 = 1.4176e-04
Validation rmse = 0.113237
Validation r2 = 0.918557
Validation mse = 0.012823
Epoch 49
Loss = 5.2904e-02, PNorm = 44.9062, GNorm = 1.5184, lr_0 = 1.3854e-04
Loss = 5.6579e-02, PNorm = 44.9114, GNorm = 0.8074, lr_0 = 1.3567e-04
Validation rmse = 0.103995
Validation r2 = 0.931309
Validation mse = 0.010815
Epoch 50
Loss = 5.0892e-02, PNorm = 44.9161, GNorm = 0.8258, lr_0 = 1.3287e-04
Loss = 5.5762e-02, PNorm = 44.9203, GNorm = 1.4809, lr_0 = 1.3012e-04
Validation rmse = 0.106586
Validation r2 = 0.927843
Validation mse = 0.011361
Epoch 51
Loss = 4.3749e-02, PNorm = 44.9256, GNorm = 2.2042, lr_0 = 1.2716e-04
Loss = 5.3058e-02, PNorm = 44.9287, GNorm = 1.2437, lr_0 = 1.2453e-04
Validation rmse = 0.103534
Validation r2 = 0.931916
Validation mse = 0.010719
Epoch 52
Loss = 6.4847e-02, PNorm = 44.9344, GNorm = 1.2118, lr_0 = 1.2170e-04
Loss = 5.5085e-02, PNorm = 44.9387, GNorm = 0.5592, lr_0 = 1.1919e-04
Validation rmse = 0.102136
Validation r2 = 0.933742
Validation mse = 0.010432
Epoch 53
Loss = 5.0967e-02, PNorm = 44.9435, GNorm = 0.6482, lr_0 = 1.1648e-04
Loss = 5.1661e-02, PNorm = 44.9473, GNorm = 0.6313, lr_0 = 1.1407e-04
Validation rmse = 0.109067
Validation r2 = 0.924445
Validation mse = 0.011896
Epoch 54
Loss = 4.7727e-02, PNorm = 44.9517, GNorm = 0.6944, lr_0 = 1.1148e-04
Loss = 4.8612e-02, PNorm = 44.9551, GNorm = 0.8785, lr_0 = 1.0917e-04
Validation rmse = 0.106619
Validation r2 = 0.927799
Validation mse = 0.011368
Epoch 55
Loss = 6.3972e-02, PNorm = 44.9613, GNorm = 1.8062, lr_0 = 1.0669e-04
Loss = 5.4060e-02, PNorm = 44.9654, GNorm = 1.4389, lr_0 = 1.0449e-04
Validation rmse = 0.104950
Validation r2 = 0.930042
Validation mse = 0.011014
Epoch 56
Loss = 4.8867e-02, PNorm = 44.9695, GNorm = 0.7858, lr_0 = 1.0211e-04
Loss = 5.4449e-02, PNorm = 44.9728, GNorm = 0.8930, lr_0 = 1.0000e-04
Loss = 2.1886e-02, PNorm = 44.9731, GNorm = 0.8160, lr_0 = 1.0000e-04
Validation rmse = 0.106246
Validation r2 = 0.928302
Validation mse = 0.011288
Epoch 57
Loss = 4.5411e-02, PNorm = 44.9767, GNorm = 0.3902, lr_0 = 1.0000e-04
Loss = 5.4532e-02, PNorm = 44.9807, GNorm = 1.6964, lr_0 = 1.0000e-04
Validation rmse = 0.108099
Validation r2 = 0.925780
Validation mse = 0.011685
Epoch 58
Loss = 4.3431e-02, PNorm = 44.9838, GNorm = 0.5700, lr_0 = 1.0000e-04
Validation rmse = 0.111634
Validation r2 = 0.920846
Validation mse = 0.012462
Epoch 59
Loss = 4.7403e-02, PNorm = 44.9877, GNorm = 0.7774, lr_0 = 1.0000e-04
Loss = 4.9046e-02, PNorm = 44.9914, GNorm = 0.5695, lr_0 = 1.0000e-04
Validation rmse = 0.112026
Validation r2 = 0.920290
Validation mse = 0.012550
Model 0 best validation rmse = 0.050304 on epoch 15
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.300625
Model 0 test r2 = -0.825236
Model 0 test mse = 0.090375
Ensemble test rmse = 0.300625
Ensemble test r2 = -0.825236
Ensemble test mse = 0.090375
Fold 8
Splitting data with seed 8
Total size = 967 | train size = 957 | val size = 10 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.0546e-01, PNorm = 43.2619, GNorm = 1.8489, lr_0 = 3.6053e-04
Validation rmse = 0.595812
Validation r2 = -0.862561
Validation mse = 0.354992
Epoch 1
Loss = 1.1691e+00, PNorm = 43.2944, GNorm = 18.0587, lr_0 = 6.2105e-04
Loss = 7.8631e-01, PNorm = 43.3247, GNorm = 7.4500, lr_0 = 8.5789e-04
Validation rmse = 0.454948
Validation r2 = -0.085965
Validation mse = 0.206978
Epoch 2
Loss = 3.8904e-01, PNorm = 43.4027, GNorm = 3.7303, lr_0 = 9.8961e-04
Loss = 4.5708e-01, PNorm = 43.4773, GNorm = 4.1571, lr_0 = 9.6914e-04
Validation rmse = 0.285521
Validation r2 = 0.572270
Validation mse = 0.081522
Epoch 3
Loss = 3.6569e-01, PNorm = 43.5413, GNorm = 3.6286, lr_0 = 9.4712e-04
Loss = 3.1946e-01, PNorm = 43.5978, GNorm = 4.8836, lr_0 = 9.2754e-04
Validation rmse = 0.229822
Validation r2 = 0.722876
Validation mse = 0.052818
Epoch 4
Loss = 2.7360e-01, PNorm = 43.6538, GNorm = 2.0639, lr_0 = 9.0646e-04
Loss = 3.4855e-01, PNorm = 43.6982, GNorm = 1.2575, lr_0 = 8.8772e-04
Validation rmse = 0.204494
Validation r2 = 0.780592
Validation mse = 0.041818
Epoch 5
Loss = 3.4419e-01, PNorm = 43.7498, GNorm = 1.5762, lr_0 = 8.6755e-04
Loss = 2.7745e-01, PNorm = 43.7988, GNorm = 3.2001, lr_0 = 8.4961e-04
Validation rmse = 0.209053
Validation r2 = 0.770700
Validation mse = 0.043703
Epoch 6
Loss = 2.2847e-01, PNorm = 43.8446, GNorm = 1.4470, lr_0 = 8.3031e-04
Loss = 1.8041e-01, PNorm = 43.8743, GNorm = 2.1426, lr_0 = 8.1314e-04
Validation rmse = 0.161899
Validation r2 = 0.862475
Validation mse = 0.026211
Epoch 7
Loss = 1.6235e-01, PNorm = 43.9048, GNorm = 2.1536, lr_0 = 7.9466e-04
Loss = 1.6983e-01, PNorm = 43.9307, GNorm = 1.5422, lr_0 = 7.7823e-04
Validation rmse = 0.156699
Validation r2 = 0.871168
Validation mse = 0.024555
Epoch 8
Loss = 1.5325e-01, PNorm = 43.9598, GNorm = 1.0359, lr_0 = 7.6214e-04
Loss = 1.6248e-01, PNorm = 43.9846, GNorm = 1.8264, lr_0 = 7.4638e-04
Validation rmse = 0.151254
Validation r2 = 0.879965
Validation mse = 0.022878
Epoch 9
Loss = 1.6903e-01, PNorm = 44.0059, GNorm = 3.9332, lr_0 = 7.2942e-04
Loss = 1.6636e-01, PNorm = 44.0294, GNorm = 4.4209, lr_0 = 7.1434e-04
Validation rmse = 0.175324
Validation r2 = 0.838721
Validation mse = 0.030739
Epoch 10
Loss = 1.9585e-01, PNorm = 44.0624, GNorm = 2.4464, lr_0 = 6.9810e-04
Loss = 2.0244e-01, PNorm = 44.0867, GNorm = 6.3989, lr_0 = 6.8367e-04
Loss = 1.9213e-01, PNorm = 44.0882, GNorm = 3.7498, lr_0 = 6.8224e-04
Validation rmse = 0.161909
Validation r2 = 0.862458
Validation mse = 0.026215
Epoch 11
Loss = 1.6605e-01, PNorm = 44.1121, GNorm = 4.3502, lr_0 = 6.6813e-04
Validation rmse = 0.133073
Validation r2 = 0.907088
Validation mse = 0.017708
Epoch 12
Loss = 1.3570e-01, PNorm = 44.1392, GNorm = 1.8639, lr_0 = 6.5295e-04
Loss = 1.3917e-01, PNorm = 44.1612, GNorm = 1.6131, lr_0 = 6.3945e-04
Validation rmse = 0.137635
Validation r2 = 0.900608
Validation mse = 0.018943
Epoch 13
Loss = 9.5413e-02, PNorm = 44.1801, GNorm = 0.6179, lr_0 = 6.2492e-04
Loss = 1.0929e-01, PNorm = 44.1947, GNorm = 1.1214, lr_0 = 6.1200e-04
Validation rmse = 0.151802
Validation r2 = 0.879094
Validation mse = 0.023044
Epoch 14
Loss = 1.5951e-01, PNorm = 44.2122, GNorm = 4.3710, lr_0 = 5.9809e-04
Loss = 1.2377e-01, PNorm = 44.2295, GNorm = 2.8521, lr_0 = 5.8573e-04
Validation rmse = 0.135903
Validation r2 = 0.903094
Validation mse = 0.018470
Epoch 15
Loss = 1.1512e-01, PNorm = 44.2482, GNorm = 0.9592, lr_0 = 5.7362e-04
Loss = 1.0671e-01, PNorm = 44.2651, GNorm = 1.4662, lr_0 = 5.6175e-04
Validation rmse = 0.116809
Validation r2 = 0.928411
Validation mse = 0.013644
Epoch 16
Loss = 1.0944e-01, PNorm = 44.2760, GNorm = 4.2113, lr_0 = 5.4899e-04
Loss = 1.1228e-01, PNorm = 44.2945, GNorm = 2.2652, lr_0 = 5.3764e-04
Validation rmse = 0.123495
Validation r2 = 0.919982
Validation mse = 0.015251
Epoch 17
Loss = 1.1793e-01, PNorm = 44.3146, GNorm = 1.1831, lr_0 = 5.2542e-04
Loss = 1.1379e-01, PNorm = 44.3275, GNorm = 1.1731, lr_0 = 5.1456e-04
Validation rmse = 0.142342
Validation r2 = 0.893693
Validation mse = 0.020261
Epoch 18
Loss = 1.0475e-01, PNorm = 44.3393, GNorm = 1.3293, lr_0 = 5.0287e-04
Loss = 9.9346e-02, PNorm = 44.3543, GNorm = 1.2448, lr_0 = 4.9247e-04
Validation rmse = 0.114391
Validation r2 = 0.931344
Validation mse = 0.013085
Epoch 19
Loss = 1.0801e-01, PNorm = 44.3667, GNorm = 1.6222, lr_0 = 4.8128e-04
Loss = 9.7601e-02, PNorm = 44.3773, GNorm = 1.1856, lr_0 = 4.7133e-04
Validation rmse = 0.125474
Validation r2 = 0.917396
Validation mse = 0.015744
Epoch 20
Loss = 9.6187e-02, PNorm = 44.3929, GNorm = 0.7652, lr_0 = 4.6062e-04
Loss = 9.7080e-02, PNorm = 44.4084, GNorm = 0.8732, lr_0 = 4.5109e-04
Validation rmse = 0.122522
Validation r2 = 0.921238
Validation mse = 0.015012
Epoch 21
Loss = 9.9765e-02, PNorm = 44.4249, GNorm = 1.2411, lr_0 = 4.4084e-04
Loss = 1.0007e-01, PNorm = 44.4386, GNorm = 1.3981, lr_0 = 4.3173e-04
Validation rmse = 0.120012
Validation r2 = 0.924431
Validation mse = 0.014403
Epoch 22
Loss = 9.0938e-02, PNorm = 44.4514, GNorm = 1.1275, lr_0 = 4.2280e-04
Loss = 1.1589e-01, PNorm = 44.4639, GNorm = 2.0278, lr_0 = 4.1406e-04
Loss = 6.0458e-02, PNorm = 44.4656, GNorm = 3.5156, lr_0 = 4.1319e-04
Validation rmse = 0.114342
Validation r2 = 0.931403
Validation mse = 0.013074
Epoch 23
Loss = 9.5386e-02, PNorm = 44.4787, GNorm = 0.8314, lr_0 = 4.0465e-04
Validation rmse = 0.115127
Validation r2 = 0.930457
Validation mse = 0.013254
Epoch 24
Loss = 7.5050e-02, PNorm = 44.4917, GNorm = 0.8663, lr_0 = 3.9545e-04
Loss = 8.8789e-02, PNorm = 44.5004, GNorm = 0.5520, lr_0 = 3.8728e-04
Validation rmse = 0.138547
Validation r2 = 0.899287
Validation mse = 0.019195
Epoch 25
Loss = 1.4915e-01, PNorm = 44.5191, GNorm = 4.0785, lr_0 = 3.7848e-04
Loss = 1.1422e-01, PNorm = 44.5365, GNorm = 0.9754, lr_0 = 3.7065e-04
Validation rmse = 0.124628
Validation r2 = 0.918507
Validation mse = 0.015532
Epoch 26
Loss = 9.2024e-02, PNorm = 44.5514, GNorm = 0.5234, lr_0 = 3.6223e-04
Loss = 8.7909e-02, PNorm = 44.5637, GNorm = 0.6785, lr_0 = 3.5474e-04
Validation rmse = 0.108253
Validation r2 = 0.938514
Validation mse = 0.011719
Epoch 27
Loss = 7.5512e-02, PNorm = 44.5768, GNorm = 1.0605, lr_0 = 3.4668e-04
Loss = 1.1491e-01, PNorm = 44.5911, GNorm = 1.4521, lr_0 = 3.3951e-04
Validation rmse = 0.111505
Validation r2 = 0.934765
Validation mse = 0.012433
Epoch 28
Loss = 8.5449e-02, PNorm = 44.6060, GNorm = 0.4763, lr_0 = 3.3180e-04
Loss = 8.5705e-02, PNorm = 44.6171, GNorm = 0.7342, lr_0 = 3.2494e-04
Validation rmse = 0.108665
Validation r2 = 0.938045
Validation mse = 0.011808
Epoch 29
Loss = 6.8576e-02, PNorm = 44.6253, GNorm = 0.7121, lr_0 = 3.1822e-04
Loss = 8.9056e-02, PNorm = 44.6348, GNorm = 1.4331, lr_0 = 3.1164e-04
Validation rmse = 0.112356
Validation r2 = 0.933766
Validation mse = 0.012624
Epoch 30
Loss = 8.1268e-02, PNorm = 44.6467, GNorm = 1.2340, lr_0 = 3.0456e-04
Loss = 6.8364e-02, PNorm = 44.6574, GNorm = 0.4383, lr_0 = 2.9826e-04
Validation rmse = 0.106986
Validation r2 = 0.939945
Validation mse = 0.011446
Epoch 31
Loss = 7.4236e-02, PNorm = 44.6683, GNorm = 1.2925, lr_0 = 2.9148e-04
Loss = 8.3481e-02, PNorm = 44.6783, GNorm = 0.9473, lr_0 = 2.8545e-04
Validation rmse = 0.110055
Validation r2 = 0.936450
Validation mse = 0.012112
Epoch 32
Loss = 7.6234e-02, PNorm = 44.6901, GNorm = 1.8196, lr_0 = 2.7897e-04
Loss = 8.2246e-02, PNorm = 44.6984, GNorm = 2.3053, lr_0 = 2.7320e-04
Validation rmse = 0.105333
Validation r2 = 0.941787
Validation mse = 0.011095
Epoch 33
Loss = 6.9881e-02, PNorm = 44.7064, GNorm = 0.6162, lr_0 = 2.6699e-04
Loss = 8.4096e-02, PNorm = 44.7159, GNorm = 1.5598, lr_0 = 2.6147e-04
Loss = 1.0957e-01, PNorm = 44.7170, GNorm = 2.1442, lr_0 = 2.6092e-04
Validation rmse = 0.105411
Validation r2 = 0.941701
Validation mse = 0.011111
Epoch 34
Loss = 8.0009e-02, PNorm = 44.7309, GNorm = 2.6252, lr_0 = 2.5553e-04
Validation rmse = 0.115350
Validation r2 = 0.930189
Validation mse = 0.013306
Epoch 35
Loss = 2.8813e-02, PNorm = 44.7399, GNorm = 0.8100, lr_0 = 2.4972e-04
Loss = 7.8316e-02, PNorm = 44.7482, GNorm = 0.7286, lr_0 = 2.4456e-04
Validation rmse = 0.100099
Validation r2 = 0.947429
Validation mse = 0.010020
Epoch 36
Loss = 7.6039e-02, PNorm = 44.7551, GNorm = 1.1368, lr_0 = 2.3950e-04
Loss = 8.1049e-02, PNorm = 44.7648, GNorm = 1.4453, lr_0 = 2.3455e-04
Validation rmse = 0.104583
Validation r2 = 0.942613
Validation mse = 0.010938
Epoch 37
Loss = 7.3316e-02, PNorm = 44.7728, GNorm = 2.4190, lr_0 = 2.2922e-04
Loss = 7.2026e-02, PNorm = 44.7800, GNorm = 1.3854, lr_0 = 2.2448e-04
Validation rmse = 0.094289
Validation r2 = 0.953354
Validation mse = 0.008890
Epoch 38
Loss = 8.5395e-02, PNorm = 44.7887, GNorm = 1.2631, lr_0 = 2.1938e-04
Loss = 6.5578e-02, PNorm = 44.7968, GNorm = 0.4650, lr_0 = 2.1484e-04
Validation rmse = 0.101844
Validation r2 = 0.945579
Validation mse = 0.010372
Epoch 39
Loss = 7.1439e-02, PNorm = 44.8047, GNorm = 1.4002, lr_0 = 2.0996e-04
Loss = 6.0544e-02, PNorm = 44.8135, GNorm = 0.3120, lr_0 = 2.0562e-04
Validation rmse = 0.101185
Validation r2 = 0.946282
Validation mse = 0.010238
Epoch 40
Loss = 6.6170e-02, PNorm = 44.8193, GNorm = 0.6472, lr_0 = 2.0095e-04
Loss = 6.9515e-02, PNorm = 44.8259, GNorm = 0.5964, lr_0 = 1.9679e-04
Validation rmse = 0.108139
Validation r2 = 0.938644
Validation mse = 0.011694
Epoch 41
Loss = 6.5693e-02, PNorm = 44.8329, GNorm = 0.9725, lr_0 = 1.9232e-04
Loss = 6.7287e-02, PNorm = 44.8390, GNorm = 0.8316, lr_0 = 1.8835e-04
Validation rmse = 0.109681
Validation r2 = 0.936882
Validation mse = 0.012030
Epoch 42
Loss = 7.6815e-02, PNorm = 44.8443, GNorm = 1.5129, lr_0 = 1.8407e-04
Loss = 7.6749e-02, PNorm = 44.8507, GNorm = 1.0010, lr_0 = 1.8026e-04
Validation rmse = 0.100361
Validation r2 = 0.947153
Validation mse = 0.010072
Epoch 43
Loss = 5.8974e-02, PNorm = 44.8574, GNorm = 0.5332, lr_0 = 1.7653e-04
Loss = 6.4773e-02, PNorm = 44.8631, GNorm = 0.8145, lr_0 = 1.7288e-04
Validation rmse = 0.102208
Validation r2 = 0.945190
Validation mse = 0.010446
Epoch 44
Loss = 6.6782e-02, PNorm = 44.8712, GNorm = 1.0732, lr_0 = 1.6895e-04
Loss = 5.8201e-02, PNorm = 44.8762, GNorm = 1.0488, lr_0 = 1.6546e-04
Validation rmse = 0.103078
Validation r2 = 0.944253
Validation mse = 0.010625
Epoch 45
Loss = 5.9843e-02, PNorm = 44.8817, GNorm = 0.8924, lr_0 = 1.6170e-04
Loss = 6.2757e-02, PNorm = 44.8871, GNorm = 0.5216, lr_0 = 1.5836e-04
Loss = 2.4872e-01, PNorm = 44.8875, GNorm = 3.7776, lr_0 = 1.5803e-04
Validation rmse = 0.101116
Validation r2 = 0.946354
Validation mse = 0.010225
Epoch 46
Loss = 6.9047e-02, PNorm = 44.8932, GNorm = 1.5012, lr_0 = 1.5476e-04
Validation rmse = 0.099423
Validation r2 = 0.948136
Validation mse = 0.009885
Epoch 47
Loss = 4.2187e-02, PNorm = 44.8992, GNorm = 1.1287, lr_0 = 1.5124e-04
Loss = 5.9095e-02, PNorm = 44.9046, GNorm = 1.1178, lr_0 = 1.4811e-04
Validation rmse = 0.102476
Validation r2 = 0.944902
Validation mse = 0.010501
Epoch 48
Loss = 8.1065e-02, PNorm = 44.9100, GNorm = 1.4599, lr_0 = 1.4475e-04
Loss = 5.4231e-02, PNorm = 44.9136, GNorm = 0.3943, lr_0 = 1.4176e-04
Validation rmse = 0.095042
Validation r2 = 0.952606
Validation mse = 0.009033
Epoch 49
Loss = 5.2740e-02, PNorm = 44.9191, GNorm = 1.4681, lr_0 = 1.3854e-04
Loss = 5.9849e-02, PNorm = 44.9239, GNorm = 1.1526, lr_0 = 1.3567e-04
Validation rmse = 0.107359
Validation r2 = 0.939526
Validation mse = 0.011526
Epoch 50
Loss = 5.7706e-02, PNorm = 44.9290, GNorm = 0.7665, lr_0 = 1.3287e-04
Loss = 5.9491e-02, PNorm = 44.9334, GNorm = 0.5399, lr_0 = 1.3012e-04
Validation rmse = 0.103804
Validation r2 = 0.943465
Validation mse = 0.010775
Epoch 51
Loss = 4.6424e-02, PNorm = 44.9379, GNorm = 0.6829, lr_0 = 1.2716e-04
Loss = 5.6804e-02, PNorm = 44.9421, GNorm = 0.5313, lr_0 = 1.2453e-04
Validation rmse = 0.105176
Validation r2 = 0.941960
Validation mse = 0.011062
Epoch 52
Loss = 6.6290e-02, PNorm = 44.9473, GNorm = 1.3207, lr_0 = 1.2170e-04
Loss = 5.9557e-02, PNorm = 44.9515, GNorm = 1.4673, lr_0 = 1.1919e-04
Validation rmse = 0.107477
Validation r2 = 0.939393
Validation mse = 0.011551
Epoch 53
Loss = 5.0963e-02, PNorm = 44.9555, GNorm = 0.5856, lr_0 = 1.1648e-04
Loss = 5.3965e-02, PNorm = 44.9598, GNorm = 0.5549, lr_0 = 1.1407e-04
Validation rmse = 0.101519
Validation r2 = 0.945926
Validation mse = 0.010306
Epoch 54
Loss = 5.3462e-02, PNorm = 44.9645, GNorm = 0.6443, lr_0 = 1.1148e-04
Loss = 5.7089e-02, PNorm = 44.9677, GNorm = 1.1983, lr_0 = 1.0917e-04
Validation rmse = 0.110573
Validation r2 = 0.935850
Validation mse = 0.012226
Epoch 55
Loss = 5.4741e-02, PNorm = 44.9717, GNorm = 0.5392, lr_0 = 1.0669e-04
Loss = 5.0273e-02, PNorm = 44.9756, GNorm = 0.7289, lr_0 = 1.0449e-04
Validation rmse = 0.098583
Validation r2 = 0.949008
Validation mse = 0.009719
Epoch 56
Loss = 4.7249e-02, PNorm = 44.9800, GNorm = 0.4713, lr_0 = 1.0211e-04
Loss = 5.5384e-02, PNorm = 44.9840, GNorm = 0.5589, lr_0 = 1.0000e-04
Loss = 2.0294e-02, PNorm = 44.9843, GNorm = 0.8149, lr_0 = 1.0000e-04
Validation rmse = 0.106367
Validation r2 = 0.940638
Validation mse = 0.011314
Epoch 57
Loss = 5.8303e-02, PNorm = 44.9874, GNorm = 1.1637, lr_0 = 1.0000e-04
Loss = 4.4861e-02, PNorm = 44.9911, GNorm = 1.1162, lr_0 = 1.0000e-04
Validation rmse = 0.104188
Validation r2 = 0.943045
Validation mse = 0.010855
Epoch 58
Loss = 4.2532e-02, PNorm = 44.9946, GNorm = 0.5795, lr_0 = 1.0000e-04
Validation rmse = 0.094364
Validation r2 = 0.953280
Validation mse = 0.008905
Epoch 59
Loss = 6.7593e-02, PNorm = 44.9980, GNorm = 0.8732, lr_0 = 1.0000e-04
Loss = 4.7646e-02, PNorm = 45.0021, GNorm = 0.7608, lr_0 = 1.0000e-04
Validation rmse = 0.103479
Validation r2 = 0.943818
Validation mse = 0.010708
Model 0 best validation rmse = 0.094289 on epoch 37
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.277810
Model 0 test r2 = -0.558709
Model 0 test mse = 0.077179
Ensemble test rmse = 0.277810
Ensemble test r2 = -0.558709
Ensemble test mse = 0.077179
Fold 9
Splitting data with seed 9
Total size = 967 | train size = 957 | val size = 10 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.0750e-01, PNorm = 43.2626, GNorm = 2.7185, lr_0 = 3.6053e-04
Validation rmse = 0.322629
Validation r2 = 0.288022
Validation mse = 0.104090
Epoch 1
Loss = 5.6343e-01, PNorm = 43.2850, GNorm = 3.5888, lr_0 = 6.2105e-04
Loss = 5.9774e-01, PNorm = 43.3291, GNorm = 5.1552, lr_0 = 8.5789e-04
Validation rmse = 0.262181
Validation r2 = 0.529823
Validation mse = 0.068739
Epoch 2
Loss = 5.3120e-01, PNorm = 43.4037, GNorm = 3.8343, lr_0 = 9.8961e-04
Loss = 4.8121e-01, PNorm = 43.4869, GNorm = 6.4373, lr_0 = 9.6914e-04
Validation rmse = 0.198893
Validation r2 = 0.729418
Validation mse = 0.039559
Epoch 3
Loss = 3.4035e-01, PNorm = 43.5729, GNorm = 3.5589, lr_0 = 9.4712e-04
Loss = 3.4581e-01, PNorm = 43.6333, GNorm = 3.4320, lr_0 = 9.2754e-04
Validation rmse = 0.179164
Validation r2 = 0.780436
Validation mse = 0.032100
Epoch 4
Loss = 2.1461e-01, PNorm = 43.6967, GNorm = 0.7356, lr_0 = 9.0646e-04
Loss = 2.2479e-01, PNorm = 43.7406, GNorm = 3.9006, lr_0 = 8.8772e-04
Validation rmse = 0.203707
Validation r2 = 0.716161
Validation mse = 0.041497
Epoch 5
Loss = 1.9104e-01, PNorm = 43.7896, GNorm = 4.2846, lr_0 = 8.6755e-04
Loss = 1.8965e-01, PNorm = 43.8325, GNorm = 5.0219, lr_0 = 8.4961e-04
Validation rmse = 0.148157
Validation r2 = 0.849858
Validation mse = 0.021950
Epoch 6
Loss = 1.4175e-01, PNorm = 43.8731, GNorm = 4.9509, lr_0 = 8.3031e-04
Loss = 1.9430e-01, PNorm = 43.9113, GNorm = 2.7586, lr_0 = 8.1314e-04
Validation rmse = 0.127917
Validation r2 = 0.888079
Validation mse = 0.016363
Epoch 7
Loss = 1.1870e-01, PNorm = 43.9404, GNorm = 1.9043, lr_0 = 7.9466e-04
Loss = 1.7697e-01, PNorm = 43.9621, GNorm = 1.9827, lr_0 = 7.7823e-04
Validation rmse = 0.157915
Validation r2 = 0.829429
Validation mse = 0.024937
Epoch 8
Loss = 1.2627e-01, PNorm = 43.9933, GNorm = 2.0796, lr_0 = 7.6214e-04
Loss = 1.5649e-01, PNorm = 44.0142, GNorm = 5.4620, lr_0 = 7.4638e-04
Validation rmse = 0.114248
Validation r2 = 0.910720
Validation mse = 0.013053
Epoch 9
Loss = 1.2705e-01, PNorm = 44.0403, GNorm = 1.9639, lr_0 = 7.2942e-04
Loss = 1.3583e-01, PNorm = 44.0577, GNorm = 0.6855, lr_0 = 7.1434e-04
Validation rmse = 0.152425
Validation r2 = 0.841082
Validation mse = 0.023233
Epoch 10
Loss = 1.9321e-01, PNorm = 44.0765, GNorm = 3.0610, lr_0 = 6.9810e-04
Loss = 1.9755e-01, PNorm = 44.1017, GNorm = 5.3213, lr_0 = 6.8367e-04
Loss = 5.1844e-01, PNorm = 44.1051, GNorm = 5.7690, lr_0 = 6.8224e-04
Validation rmse = 0.204901
Validation r2 = 0.712825
Validation mse = 0.041984
Epoch 11
Loss = 2.8756e-01, PNorm = 44.1567, GNorm = 4.4048, lr_0 = 6.6813e-04
Validation rmse = 0.164316
Validation r2 = 0.815320
Validation mse = 0.027000
Epoch 12
Loss = 1.6869e-01, PNorm = 44.1923, GNorm = 3.9959, lr_0 = 6.5295e-04
Loss = 1.2507e-01, PNorm = 44.2172, GNorm = 1.5730, lr_0 = 6.3945e-04
Validation rmse = 0.134685
Validation r2 = 0.875921
Validation mse = 0.018140
Epoch 13
Loss = 1.5096e-01, PNorm = 44.2395, GNorm = 0.9083, lr_0 = 6.2492e-04
Loss = 1.1376e-01, PNorm = 44.2587, GNorm = 1.1841, lr_0 = 6.1200e-04
Validation rmse = 0.161250
Validation r2 = 0.822149
Validation mse = 0.026001
Epoch 14
Loss = 9.8853e-02, PNorm = 44.2729, GNorm = 1.9208, lr_0 = 5.9809e-04
Loss = 1.1759e-01, PNorm = 44.2875, GNorm = 3.5521, lr_0 = 5.8573e-04
Validation rmse = 0.153884
Validation r2 = 0.838025
Validation mse = 0.023680
Epoch 15
Loss = 1.0852e-01, PNorm = 44.3004, GNorm = 1.5221, lr_0 = 5.7362e-04
Loss = 1.2904e-01, PNorm = 44.3126, GNorm = 3.1235, lr_0 = 5.6175e-04
Validation rmse = 0.149330
Validation r2 = 0.847470
Validation mse = 0.022300
Epoch 16
Loss = 1.1271e-01, PNorm = 44.3312, GNorm = 0.7107, lr_0 = 5.4899e-04
Loss = 1.1050e-01, PNorm = 44.3496, GNorm = 1.7354, lr_0 = 5.3764e-04
Validation rmse = 0.145800
Validation r2 = 0.854596
Validation mse = 0.021258
Epoch 17
Loss = 8.5370e-02, PNorm = 44.3648, GNorm = 0.6172, lr_0 = 5.2542e-04
Loss = 1.1140e-01, PNorm = 44.3779, GNorm = 0.6629, lr_0 = 5.1456e-04
Validation rmse = 0.115706
Validation r2 = 0.908426
Validation mse = 0.013388
Epoch 18
Loss = 9.6863e-02, PNorm = 44.3834, GNorm = 0.5786, lr_0 = 5.0287e-04
Loss = 1.1157e-01, PNorm = 44.3950, GNorm = 2.2518, lr_0 = 4.9247e-04
Validation rmse = 0.152013
Validation r2 = 0.841941
Validation mse = 0.023108
Epoch 19
Loss = 1.2081e-01, PNorm = 44.4216, GNorm = 2.1223, lr_0 = 4.8128e-04
Loss = 1.2176e-01, PNorm = 44.4339, GNorm = 1.0931, lr_0 = 4.7133e-04
Validation rmse = 0.130300
Validation r2 = 0.883869
Validation mse = 0.016978
Epoch 20
Loss = 1.0256e-01, PNorm = 44.4490, GNorm = 1.3502, lr_0 = 4.6062e-04
Loss = 9.8158e-02, PNorm = 44.4612, GNorm = 0.9756, lr_0 = 4.5109e-04
Validation rmse = 0.129875
Validation r2 = 0.884625
Validation mse = 0.016868
Epoch 21
Loss = 9.5256e-02, PNorm = 44.4736, GNorm = 1.7825, lr_0 = 4.4084e-04
Loss = 8.6173e-02, PNorm = 44.4834, GNorm = 1.8871, lr_0 = 4.3173e-04
Validation rmse = 0.122027
Validation r2 = 0.898148
Validation mse = 0.014890
Epoch 22
Loss = 1.1263e-01, PNorm = 44.4928, GNorm = 1.2459, lr_0 = 4.2280e-04
Loss = 9.9526e-02, PNorm = 44.5033, GNorm = 1.6319, lr_0 = 4.1406e-04
Loss = 7.4297e-02, PNorm = 44.5044, GNorm = 1.4522, lr_0 = 4.1319e-04
Validation rmse = 0.131671
Validation r2 = 0.881413
Validation mse = 0.017337
Epoch 23
Loss = 9.4357e-02, PNorm = 44.5177, GNorm = 1.3095, lr_0 = 4.0465e-04
Validation rmse = 0.140482
Validation r2 = 0.865011
Validation mse = 0.019735
Epoch 24
Loss = 1.2316e-01, PNorm = 44.5272, GNorm = 2.7877, lr_0 = 3.9545e-04
Loss = 8.1016e-02, PNorm = 44.5355, GNorm = 1.0532, lr_0 = 3.8728e-04
Validation rmse = 0.127460
Validation r2 = 0.888877
Validation mse = 0.016246
Epoch 25
Loss = 8.8209e-02, PNorm = 44.5480, GNorm = 2.2364, lr_0 = 3.7848e-04
Loss = 9.5420e-02, PNorm = 44.5603, GNorm = 0.7005, lr_0 = 3.7065e-04
Validation rmse = 0.126292
Validation r2 = 0.890903
Validation mse = 0.015950
Epoch 26
Loss = 9.5769e-02, PNorm = 44.5675, GNorm = 0.7701, lr_0 = 3.6223e-04
Loss = 7.6997e-02, PNorm = 44.5746, GNorm = 0.7621, lr_0 = 3.5474e-04
Validation rmse = 0.125283
Validation r2 = 0.892640
Validation mse = 0.015696
Epoch 27
Loss = 7.7350e-02, PNorm = 44.5835, GNorm = 0.7367, lr_0 = 3.4668e-04
Loss = 7.5496e-02, PNorm = 44.5919, GNorm = 0.8757, lr_0 = 3.3951e-04
Validation rmse = 0.119389
Validation r2 = 0.902505
Validation mse = 0.014254
Epoch 28
Loss = 9.2869e-02, PNorm = 44.6024, GNorm = 2.4785, lr_0 = 3.3180e-04
Loss = 8.5504e-02, PNorm = 44.6098, GNorm = 2.1824, lr_0 = 3.2494e-04
Validation rmse = 0.135863
Validation r2 = 0.873742
Validation mse = 0.018459
Epoch 29
Loss = 1.0340e-01, PNorm = 44.6224, GNorm = 1.4130, lr_0 = 3.1822e-04
Loss = 9.1879e-02, PNorm = 44.6339, GNorm = 0.5333, lr_0 = 3.1164e-04
Validation rmse = 0.141977
Validation r2 = 0.862121
Validation mse = 0.020158
Epoch 30
Loss = 7.7734e-02, PNorm = 44.6440, GNorm = 0.4992, lr_0 = 3.0456e-04
Loss = 7.4479e-02, PNorm = 44.6534, GNorm = 1.0898, lr_0 = 2.9826e-04
Validation rmse = 0.110698
Validation r2 = 0.916182
Validation mse = 0.012254
Epoch 31
Loss = 6.7470e-02, PNorm = 44.6604, GNorm = 1.6880, lr_0 = 2.9148e-04
Loss = 8.3201e-02, PNorm = 44.6683, GNorm = 0.6081, lr_0 = 2.8545e-04
Validation rmse = 0.117286
Validation r2 = 0.905908
Validation mse = 0.013756
Epoch 32
Loss = 6.5897e-02, PNorm = 44.6793, GNorm = 2.1350, lr_0 = 2.7897e-04
Loss = 8.4575e-02, PNorm = 44.6873, GNorm = 0.8416, lr_0 = 2.7320e-04
Validation rmse = 0.126825
Validation r2 = 0.889981
Validation mse = 0.016084
Epoch 33
Loss = 7.9966e-02, PNorm = 44.6954, GNorm = 0.5735, lr_0 = 2.6699e-04
Loss = 7.0109e-02, PNorm = 44.7021, GNorm = 0.7341, lr_0 = 2.6147e-04
Loss = 2.3372e-02, PNorm = 44.7028, GNorm = 1.5110, lr_0 = 2.6092e-04
Validation rmse = 0.116596
Validation r2 = 0.907013
Validation mse = 0.013595
Epoch 34
Loss = 6.6921e-02, PNorm = 44.7090, GNorm = 0.5849, lr_0 = 2.5553e-04
Validation rmse = 0.124086
Validation r2 = 0.894681
Validation mse = 0.015397
Epoch 35
Loss = 9.9542e-02, PNorm = 44.7181, GNorm = 3.4079, lr_0 = 2.4972e-04
Loss = 7.9891e-02, PNorm = 44.7268, GNorm = 0.5647, lr_0 = 2.4456e-04
Validation rmse = 0.131706
Validation r2 = 0.881349
Validation mse = 0.017347
Epoch 36
Loss = 6.9458e-02, PNorm = 44.7337, GNorm = 1.3150, lr_0 = 2.3950e-04
Loss = 7.9041e-02, PNorm = 44.7427, GNorm = 2.3512, lr_0 = 2.3455e-04
Validation rmse = 0.114580
Validation r2 = 0.910200
Validation mse = 0.013128
Epoch 37
Loss = 7.2755e-02, PNorm = 44.7514, GNorm = 0.8926, lr_0 = 2.2922e-04
Loss = 6.6556e-02, PNorm = 44.7586, GNorm = 0.4602, lr_0 = 2.2448e-04
Validation rmse = 0.116363
Validation r2 = 0.907383
Validation mse = 0.013540
Epoch 38
Loss = 5.7741e-02, PNorm = 44.7661, GNorm = 1.2215, lr_0 = 2.1938e-04
Loss = 7.5706e-02, PNorm = 44.7734, GNorm = 0.6674, lr_0 = 2.1484e-04
Validation rmse = 0.143333
Validation r2 = 0.859476
Validation mse = 0.020544
Epoch 39
Loss = 6.8702e-02, PNorm = 44.7804, GNorm = 0.4397, lr_0 = 2.0996e-04
Loss = 6.6667e-02, PNorm = 44.7874, GNorm = 0.5369, lr_0 = 2.0562e-04
Validation rmse = 0.099838
Validation r2 = 0.931821
Validation mse = 0.009968
Epoch 40
Loss = 8.8572e-02, PNorm = 44.7944, GNorm = 0.9441, lr_0 = 2.0095e-04
Loss = 6.9898e-02, PNorm = 44.7991, GNorm = 0.7791, lr_0 = 1.9679e-04
Validation rmse = 0.133140
Validation r2 = 0.878752
Validation mse = 0.017726
Epoch 41
Loss = 7.0059e-02, PNorm = 44.8057, GNorm = 0.6173, lr_0 = 1.9232e-04
Loss = 6.3025e-02, PNorm = 44.8127, GNorm = 0.5540, lr_0 = 1.8835e-04
Validation rmse = 0.112865
Validation r2 = 0.912869
Validation mse = 0.012738
Epoch 42
Loss = 7.4178e-02, PNorm = 44.8178, GNorm = 1.7213, lr_0 = 1.8407e-04
Loss = 6.2504e-02, PNorm = 44.8230, GNorm = 1.1756, lr_0 = 1.8026e-04
Validation rmse = 0.114099
Validation r2 = 0.910952
Validation mse = 0.013019
Epoch 43
Loss = 6.4807e-02, PNorm = 44.8294, GNorm = 0.6809, lr_0 = 1.7653e-04
Loss = 5.9616e-02, PNorm = 44.8352, GNorm = 1.1305, lr_0 = 1.7288e-04
Validation rmse = 0.120492
Validation r2 = 0.900694
Validation mse = 0.014518
Epoch 44
Loss = 6.7132e-02, PNorm = 44.8411, GNorm = 0.6504, lr_0 = 1.6895e-04
Loss = 6.1955e-02, PNorm = 44.8463, GNorm = 0.5430, lr_0 = 1.6546e-04
Validation rmse = 0.111519
Validation r2 = 0.914934
Validation mse = 0.012436
Epoch 45
Loss = 6.3790e-02, PNorm = 44.8514, GNorm = 1.7777, lr_0 = 1.6170e-04
Loss = 6.0101e-02, PNorm = 44.8559, GNorm = 0.8773, lr_0 = 1.5836e-04
Loss = 3.0365e-02, PNorm = 44.8563, GNorm = 3.1654, lr_0 = 1.5803e-04
Validation rmse = 0.122169
Validation r2 = 0.897911
Validation mse = 0.014925
Epoch 46
Loss = 7.0208e-02, PNorm = 44.8602, GNorm = 1.2268, lr_0 = 1.5476e-04
Validation rmse = 0.107919
Validation r2 = 0.920337
Validation mse = 0.011647
Epoch 47
Loss = 7.1760e-02, PNorm = 44.8660, GNorm = 0.6582, lr_0 = 1.5124e-04
Loss = 6.1803e-02, PNorm = 44.8701, GNorm = 0.6936, lr_0 = 1.4811e-04
Validation rmse = 0.115567
Validation r2 = 0.908647
Validation mse = 0.013356
Epoch 48
Loss = 5.0497e-02, PNorm = 44.8746, GNorm = 0.5169, lr_0 = 1.4475e-04
Loss = 5.8471e-02, PNorm = 44.8783, GNorm = 1.5425, lr_0 = 1.4176e-04
Validation rmse = 0.111773
Validation r2 = 0.914545
Validation mse = 0.012493
Epoch 49
Loss = 8.3164e-02, PNorm = 44.8839, GNorm = 0.5647, lr_0 = 1.3854e-04
Loss = 5.2314e-02, PNorm = 44.8886, GNorm = 1.0600, lr_0 = 1.3567e-04
Validation rmse = 0.115828
Validation r2 = 0.908232
Validation mse = 0.013416
Epoch 50
Loss = 3.8407e-02, PNorm = 44.8924, GNorm = 0.8884, lr_0 = 1.3287e-04
Loss = 5.9820e-02, PNorm = 44.8956, GNorm = 1.5766, lr_0 = 1.3012e-04
Validation rmse = 0.115687
Validation r2 = 0.908457
Validation mse = 0.013383
Epoch 51
Loss = 5.2908e-02, PNorm = 44.9006, GNorm = 0.5053, lr_0 = 1.2716e-04
Loss = 5.9436e-02, PNorm = 44.9059, GNorm = 0.5865, lr_0 = 1.2453e-04
Validation rmse = 0.123828
Validation r2 = 0.895119
Validation mse = 0.015333
Epoch 52
Loss = 6.4762e-02, PNorm = 44.9090, GNorm = 1.4834, lr_0 = 1.2170e-04
Loss = 5.9839e-02, PNorm = 44.9138, GNorm = 1.4685, lr_0 = 1.1919e-04
Validation rmse = 0.110919
Validation r2 = 0.915847
Validation mse = 0.012303
Epoch 53
Loss = 5.8067e-02, PNorm = 44.9178, GNorm = 2.0614, lr_0 = 1.1648e-04
Loss = 5.7249e-02, PNorm = 44.9222, GNorm = 0.8868, lr_0 = 1.1407e-04
Validation rmse = 0.115413
Validation r2 = 0.908890
Validation mse = 0.013320
Epoch 54
Loss = 5.7300e-02, PNorm = 44.9250, GNorm = 0.7780, lr_0 = 1.1148e-04
Loss = 5.7841e-02, PNorm = 44.9286, GNorm = 0.6296, lr_0 = 1.0917e-04
Validation rmse = 0.119290
Validation r2 = 0.902665
Validation mse = 0.014230
Epoch 55
Loss = 4.4240e-02, PNorm = 44.9330, GNorm = 0.7256, lr_0 = 1.0669e-04
Loss = 6.2232e-02, PNorm = 44.9368, GNorm = 0.6339, lr_0 = 1.0449e-04
Validation rmse = 0.113578
Validation r2 = 0.911763
Validation mse = 0.012900
Epoch 56
Loss = 5.1863e-02, PNorm = 44.9409, GNorm = 0.9809, lr_0 = 1.0211e-04
Loss = 5.9838e-02, PNorm = 44.9439, GNorm = 1.0379, lr_0 = 1.0000e-04
Loss = 1.1783e-01, PNorm = 44.9443, GNorm = 2.9579, lr_0 = 1.0000e-04
Validation rmse = 0.130743
Validation r2 = 0.883078
Validation mse = 0.017094
Epoch 57
Loss = 5.6112e-02, PNorm = 44.9482, GNorm = 0.6387, lr_0 = 1.0000e-04
Loss = 4.7688e-02, PNorm = 44.9516, GNorm = 1.0088, lr_0 = 1.0000e-04
Validation rmse = 0.115381
Validation r2 = 0.908939
Validation mse = 0.013313
Epoch 58
Loss = 4.6498e-02, PNorm = 44.9549, GNorm = 0.4722, lr_0 = 1.0000e-04
Validation rmse = 0.112593
Validation r2 = 0.913287
Validation mse = 0.012677
Epoch 59
Loss = 3.7068e-02, PNorm = 44.9586, GNorm = 0.5775, lr_0 = 1.0000e-04
Loss = 5.3289e-02, PNorm = 44.9610, GNorm = 0.9533, lr_0 = 1.0000e-04
Validation rmse = 0.111120
Validation r2 = 0.915541
Validation mse = 0.012348
Model 0 best validation rmse = 0.099838 on epoch 39
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.268421
Model 0 test r2 = -0.455129
Model 0 test mse = 0.072050
Ensemble test rmse = 0.268421
Ensemble test r2 = -0.455129
Ensemble test mse = 0.072050
10-fold cross validation
	Seed 0 ==> test rmse = 0.260137
	Seed 0 ==> test r2 = -0.366701
	Seed 0 ==> test mse = 0.067671
	Seed 1 ==> test rmse = 0.337577
	Seed 1 ==> test r2 = -1.301517
	Seed 1 ==> test mse = 0.113958
	Seed 2 ==> test rmse = 0.208053
	Seed 2 ==> test r2 = 0.125787
	Seed 2 ==> test mse = 0.043286
	Seed 3 ==> test rmse = 0.298315
	Seed 3 ==> test r2 = -0.797292
	Seed 3 ==> test mse = 0.088992
	Seed 4 ==> test rmse = 0.233533
	Seed 4 ==> test r2 = -0.101448
	Seed 4 ==> test mse = 0.054538
	Seed 5 ==> test rmse = 0.247401
	Seed 5 ==> test r2 = -0.236148
	Seed 5 ==> test mse = 0.061207
	Seed 6 ==> test rmse = 0.292814
	Seed 6 ==> test r2 = -0.731624
	Seed 6 ==> test mse = 0.085740
	Seed 7 ==> test rmse = 0.300625
	Seed 7 ==> test r2 = -0.825236
	Seed 7 ==> test mse = 0.090375
	Seed 8 ==> test rmse = 0.277810
	Seed 8 ==> test r2 = -0.558709
	Seed 8 ==> test mse = 0.077179
	Seed 9 ==> test rmse = 0.268421
	Seed 9 ==> test r2 = -0.455129
	Seed 9 ==> test mse = 0.072050
Overall test rmse = 0.272469 +/- 0.035503
Overall test r2 = -0.524802 +/- 0.390818
Overall test mse = 0.075500 +/- 0.019351
Elapsed time = 0:07:08
