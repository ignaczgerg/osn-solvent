Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-eb396fcd-496c-45e5-bd4d-ee593ad4c4ad.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/_final_2.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/_temp/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,167 | train size = 927 | val size = 234 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 8.9265e-01, PNorm = 34.0157, GNorm = 3.5731, lr_0 = 3.7500e-04
Validation rmse = 0.284287
Validation r2 = 0.305286
Epoch 1
Loss = 6.9237e-01, PNorm = 34.0438, GNorm = 6.4419, lr_0 = 6.5000e-04
Loss = 7.6369e-01, PNorm = 34.0833, GNorm = 3.2122, lr_0 = 9.0000e-04
Validation rmse = 0.275664
Validation r2 = 0.346790
Epoch 2
Loss = 6.7297e-01, PNorm = 34.1344, GNorm = 9.6791, lr_0 = 9.8685e-04
Loss = 6.1923e-01, PNorm = 34.1973, GNorm = 5.1448, lr_0 = 9.6533e-04
Validation rmse = 0.265982
Validation r2 = 0.391870
Epoch 3
Loss = 5.1099e-01, PNorm = 34.2681, GNorm = 3.0248, lr_0 = 9.4219e-04
Loss = 4.2577e-01, PNorm = 34.3311, GNorm = 1.0211, lr_0 = 9.2164e-04
Validation rmse = 0.220160
Validation r2 = 0.583352
Epoch 4
Loss = 4.2940e-01, PNorm = 34.3850, GNorm = 1.1139, lr_0 = 9.0153e-04
Loss = 3.3446e-01, PNorm = 34.4454, GNorm = 1.4407, lr_0 = 8.8187e-04
Validation rmse = 0.202466
Validation r2 = 0.647632
Epoch 5
Loss = 3.1890e-01, PNorm = 34.5064, GNorm = 4.3385, lr_0 = 8.6073e-04
Loss = 2.7237e-01, PNorm = 34.5623, GNorm = 0.9057, lr_0 = 8.4195e-04
Validation rmse = 0.192527
Validation r2 = 0.681379
Epoch 6
Loss = 2.9796e-01, PNorm = 34.6020, GNorm = 3.0324, lr_0 = 8.2359e-04
Validation rmse = 0.204398
Validation r2 = 0.640876
Epoch 7
Loss = 2.3235e-01, PNorm = 34.6473, GNorm = 3.1078, lr_0 = 8.0385e-04
Loss = 2.9541e-01, PNorm = 34.6832, GNorm = 1.8813, lr_0 = 7.8631e-04
Validation rmse = 0.181761
Validation r2 = 0.716015
Epoch 8
Loss = 2.3294e-01, PNorm = 34.7141, GNorm = 2.4843, lr_0 = 7.6916e-04
Loss = 2.3768e-01, PNorm = 34.7452, GNorm = 2.2818, lr_0 = 7.5238e-04
Validation rmse = 0.192137
Validation r2 = 0.682667
Epoch 9
Loss = 2.9600e-01, PNorm = 34.7787, GNorm = 2.4612, lr_0 = 7.3435e-04
Loss = 2.0149e-01, PNorm = 34.8071, GNorm = 1.8046, lr_0 = 7.1833e-04
Validation rmse = 0.179056
Validation r2 = 0.724407
Epoch 10
Loss = 2.4629e-01, PNorm = 34.8268, GNorm = 5.9825, lr_0 = 7.0266e-04
Loss = 1.9124e-01, PNorm = 34.8475, GNorm = 1.9336, lr_0 = 6.8733e-04
Validation rmse = 0.182146
Validation r2 = 0.714811
Epoch 11
Loss = 2.0404e-01, PNorm = 34.8757, GNorm = 3.1288, lr_0 = 6.7085e-04
Loss = 2.1863e-01, PNorm = 34.8919, GNorm = 4.3055, lr_0 = 6.5622e-04
Validation rmse = 0.188030
Validation r2 = 0.696091
Epoch 12
Loss = 2.1899e-01, PNorm = 34.9041, GNorm = 3.5237, lr_0 = 6.4191e-04
Loss = 2.2534e-01, PNorm = 34.9250, GNorm = 5.9423, lr_0 = 6.2790e-04
Validation rmse = 0.199715
Validation r2 = 0.657142
Epoch 13
Loss = 2.7924e-01, PNorm = 34.9483, GNorm = 5.3654, lr_0 = 6.1421e-04
Validation rmse = 0.176562
Validation r2 = 0.732029
Epoch 14
Loss = 1.4206e-01, PNorm = 34.9670, GNorm = 0.6177, lr_0 = 5.9948e-04
Loss = 2.2206e-01, PNorm = 34.9837, GNorm = 3.1359, lr_0 = 5.8641e-04
Validation rmse = 0.181908
Validation r2 = 0.715556
Epoch 15
Loss = 2.2232e-01, PNorm = 35.0012, GNorm = 1.2581, lr_0 = 5.7362e-04
Loss = 1.8431e-01, PNorm = 35.0213, GNorm = 1.1133, lr_0 = 5.6110e-04
Validation rmse = 0.178018
Validation r2 = 0.727592
Epoch 16
Loss = 2.1966e-01, PNorm = 35.0364, GNorm = 4.2098, lr_0 = 5.4765e-04
Loss = 1.9959e-01, PNorm = 35.0526, GNorm = 2.5377, lr_0 = 5.3571e-04
Validation rmse = 0.170475
Validation r2 = 0.750187
Epoch 17
Loss = 1.8621e-01, PNorm = 35.0690, GNorm = 0.9833, lr_0 = 5.2402e-04
Loss = 1.9497e-01, PNorm = 35.0843, GNorm = 1.4994, lr_0 = 5.1259e-04
Validation rmse = 0.175488
Validation r2 = 0.735279
Epoch 18
Loss = 2.1459e-01, PNorm = 35.0991, GNorm = 3.4002, lr_0 = 5.0030e-04
Loss = 1.7284e-01, PNorm = 35.1141, GNorm = 1.7463, lr_0 = 4.8939e-04
Validation rmse = 0.171176
Validation r2 = 0.748130
Epoch 19
Loss = 1.9595e-01, PNorm = 35.1272, GNorm = 4.4133, lr_0 = 4.7871e-04
Loss = 1.9102e-01, PNorm = 35.1385, GNorm = 2.0390, lr_0 = 4.6827e-04
Loss = 1.6178e-01, PNorm = 35.1395, GNorm = 3.0490, lr_0 = 4.6724e-04
Validation rmse = 0.172798
Validation r2 = 0.743333
Epoch 20
Loss = 2.0356e-01, PNorm = 35.1516, GNorm = 3.0379, lr_0 = 4.5705e-04
Validation rmse = 0.168848
Validation r2 = 0.754933
Epoch 21
Loss = 1.4792e-01, PNorm = 35.1647, GNorm = 0.6703, lr_0 = 4.4708e-04
Loss = 1.7995e-01, PNorm = 35.1746, GNorm = 0.8211, lr_0 = 4.3733e-04
Validation rmse = 0.173638
Validation r2 = 0.740831
Epoch 22
Loss = 2.2108e-01, PNorm = 35.1892, GNorm = 1.5738, lr_0 = 4.2684e-04
Loss = 1.5925e-01, PNorm = 35.1977, GNorm = 2.2495, lr_0 = 4.1753e-04
Validation rmse = 0.169718
Validation r2 = 0.752401
Epoch 23
Loss = 1.5581e-01, PNorm = 35.2108, GNorm = 0.5928, lr_0 = 4.0842e-04
Loss = 1.7559e-01, PNorm = 35.2215, GNorm = 0.7277, lr_0 = 3.9951e-04
Validation rmse = 0.174937
Validation r2 = 0.736939
Epoch 24
Loss = 1.7189e-01, PNorm = 35.2332, GNorm = 2.8052, lr_0 = 3.8994e-04
Loss = 1.7159e-01, PNorm = 35.2450, GNorm = 1.1660, lr_0 = 3.8143e-04
Validation rmse = 0.172433
Validation r2 = 0.744417
Epoch 25
Loss = 1.9949e-01, PNorm = 35.2551, GNorm = 1.4189, lr_0 = 3.7311e-04
Loss = 1.5474e-01, PNorm = 35.2662, GNorm = 2.4462, lr_0 = 3.6497e-04
Validation rmse = 0.171504
Validation r2 = 0.747163
Epoch 26
Loss = 2.0897e-01, PNorm = 35.2762, GNorm = 3.4946, lr_0 = 3.5701e-04
Loss = 1.5582e-01, PNorm = 35.2888, GNorm = 2.5974, lr_0 = 3.4922e-04
Loss = 1.4255e-01, PNorm = 35.2900, GNorm = 1.8695, lr_0 = 3.4845e-04
Validation rmse = 0.178200
Validation r2 = 0.727034
Epoch 27
Loss = 1.7670e-01, PNorm = 35.2995, GNorm = 2.8735, lr_0 = 3.4085e-04
Validation rmse = 0.172388
Validation r2 = 0.744550
Epoch 28
Loss = 1.8864e-01, PNorm = 35.3077, GNorm = 2.0320, lr_0 = 3.3342e-04
Loss = 1.6326e-01, PNorm = 35.3164, GNorm = 3.1157, lr_0 = 3.2614e-04
Validation rmse = 0.181528
Validation r2 = 0.716744
Epoch 29
Loss = 1.7836e-01, PNorm = 35.3257, GNorm = 2.0692, lr_0 = 3.1833e-04
Loss = 1.7048e-01, PNorm = 35.3371, GNorm = 2.2442, lr_0 = 3.1138e-04
Validation rmse = 0.175889
Validation r2 = 0.734068
Epoch 30
Loss = 1.5505e-01, PNorm = 35.3460, GNorm = 0.8910, lr_0 = 3.0459e-04
Loss = 1.8446e-01, PNorm = 35.3524, GNorm = 1.5611, lr_0 = 2.9795e-04
Validation rmse = 0.173313
Validation r2 = 0.741800
Epoch 31
Loss = 1.7619e-01, PNorm = 35.3658, GNorm = 1.8007, lr_0 = 2.9080e-04
Loss = 1.7668e-01, PNorm = 35.3735, GNorm = 1.0031, lr_0 = 2.8446e-04
Validation rmse = 0.174291
Validation r2 = 0.738879
Epoch 32
Loss = 1.5367e-01, PNorm = 35.3814, GNorm = 3.1239, lr_0 = 2.7826e-04
Loss = 1.6885e-01, PNorm = 35.3894, GNorm = 0.9013, lr_0 = 2.7219e-04
Validation rmse = 0.173150
Validation r2 = 0.742287
Epoch 33
Loss = 1.6812e-01, PNorm = 35.3993, GNorm = 1.7359, lr_0 = 2.6566e-04
Loss = 1.5164e-01, PNorm = 35.4074, GNorm = 0.8988, lr_0 = 2.5987e-04
Validation rmse = 0.171198
Validation r2 = 0.748065
Epoch 34
Loss = 1.5455e-01, PNorm = 35.4166, GNorm = 1.2618, lr_0 = 2.5420e-04
Validation rmse = 0.168969
Validation r2 = 0.754581
Epoch 35
Loss = 1.4753e-01, PNorm = 35.4232, GNorm = 1.6057, lr_0 = 2.4811e-04
Loss = 1.5842e-01, PNorm = 35.4307, GNorm = 2.2717, lr_0 = 2.4269e-04
Validation rmse = 0.172524
Validation r2 = 0.744146
Epoch 36
Loss = 1.6925e-01, PNorm = 35.4378, GNorm = 1.9271, lr_0 = 2.3740e-04
Loss = 1.6209e-01, PNorm = 35.4435, GNorm = 1.6467, lr_0 = 2.3222e-04
Validation rmse = 0.174745
Validation r2 = 0.737517
Epoch 37
Loss = 1.8772e-01, PNorm = 35.4526, GNorm = 5.1479, lr_0 = 2.2665e-04
Loss = 1.5335e-01, PNorm = 35.4612, GNorm = 2.3719, lr_0 = 2.2171e-04
Validation rmse = 0.169282
Validation r2 = 0.753672
Epoch 38
Loss = 1.2606e-01, PNorm = 35.4675, GNorm = 1.6552, lr_0 = 2.1687e-04
Loss = 1.6346e-01, PNorm = 35.4750, GNorm = 2.0199, lr_0 = 2.1214e-04
Validation rmse = 0.174049
Validation r2 = 0.739604
Epoch 39
Loss = 1.7105e-01, PNorm = 35.4826, GNorm = 2.3915, lr_0 = 2.0752e-04
Loss = 1.5721e-01, PNorm = 35.4897, GNorm = 0.9142, lr_0 = 2.0299e-04
Validation rmse = 0.169587
Validation r2 = 0.752784
Epoch 40
Loss = 1.4623e-01, PNorm = 35.4962, GNorm = 3.2249, lr_0 = 1.9812e-04
Loss = 1.5222e-01, PNorm = 35.5022, GNorm = 3.6126, lr_0 = 1.9380e-04
Validation rmse = 0.170997
Validation r2 = 0.748657
Epoch 41
Loss = 1.6625e-01, PNorm = 35.5073, GNorm = 2.6317, lr_0 = 1.8957e-04
Validation rmse = 0.170045
Validation r2 = 0.751446
Epoch 42
Loss = 1.5387e-01, PNorm = 35.5154, GNorm = 1.3137, lr_0 = 1.8503e-04
Loss = 1.2431e-01, PNorm = 35.5211, GNorm = 1.5466, lr_0 = 1.8099e-04
Validation rmse = 0.166951
Validation r2 = 0.760410
Epoch 43
Loss = 1.3500e-01, PNorm = 35.5264, GNorm = 1.2220, lr_0 = 1.7705e-04
Loss = 1.6367e-01, PNorm = 35.5339, GNorm = 1.3905, lr_0 = 1.7318e-04
Validation rmse = 0.172313
Validation r2 = 0.744771
Epoch 44
Loss = 1.5808e-01, PNorm = 35.5403, GNorm = 1.7254, lr_0 = 1.6903e-04
Loss = 1.5260e-01, PNorm = 35.5461, GNorm = 1.7686, lr_0 = 1.6534e-04
Validation rmse = 0.175616
Validation r2 = 0.734895
Epoch 45
Loss = 1.5418e-01, PNorm = 35.5520, GNorm = 2.3917, lr_0 = 1.6174e-04
Loss = 1.3984e-01, PNorm = 35.5568, GNorm = 1.9486, lr_0 = 1.5821e-04
Validation rmse = 0.168474
Validation r2 = 0.756018
Epoch 46
Loss = 1.5786e-01, PNorm = 35.5628, GNorm = 1.4642, lr_0 = 1.5442e-04
Loss = 1.3523e-01, PNorm = 35.5680, GNorm = 0.6787, lr_0 = 1.5105e-04
Validation rmse = 0.171519
Validation r2 = 0.747119
Epoch 47
Loss = 1.5344e-01, PNorm = 35.5752, GNorm = 0.9116, lr_0 = 1.4775e-04
Validation rmse = 0.168656
Validation r2 = 0.755489
Epoch 48
Loss = 9.9743e-02, PNorm = 35.5808, GNorm = 0.7528, lr_0 = 1.4421e-04
Loss = 1.4660e-01, PNorm = 35.5851, GNorm = 0.9824, lr_0 = 1.4107e-04
Validation rmse = 0.168398
Validation r2 = 0.756238
Epoch 49
Loss = 1.2932e-01, PNorm = 35.5893, GNorm = 1.4238, lr_0 = 1.3799e-04
Loss = 1.3323e-01, PNorm = 35.5945, GNorm = 0.9978, lr_0 = 1.3498e-04
Validation rmse = 0.170000
Validation r2 = 0.751579
Epoch 50
Loss = 1.5215e-01, PNorm = 35.6001, GNorm = 1.9415, lr_0 = 1.3204e-04
Loss = 1.4731e-01, PNorm = 35.6054, GNorm = 1.0501, lr_0 = 1.2915e-04
Validation rmse = 0.166202
Validation r2 = 0.762554
Epoch 51
Loss = 1.4527e-01, PNorm = 35.6094, GNorm = 1.6361, lr_0 = 1.2606e-04
Loss = 1.4011e-01, PNorm = 35.6138, GNorm = 0.9351, lr_0 = 1.2331e-04
Validation rmse = 0.167528
Validation r2 = 0.758751
Epoch 52
Loss = 1.5814e-01, PNorm = 35.6178, GNorm = 0.9928, lr_0 = 1.2062e-04
Loss = 1.3402e-01, PNorm = 35.6228, GNorm = 2.8766, lr_0 = 1.1799e-04
Validation rmse = 0.169361
Validation r2 = 0.753441
Epoch 53
Loss = 1.4515e-01, PNorm = 35.6270, GNorm = 1.9322, lr_0 = 1.1516e-04
Loss = 1.3035e-01, PNorm = 35.6305, GNorm = 1.3818, lr_0 = 1.1265e-04
Validation rmse = 0.168736
Validation r2 = 0.755259
Epoch 54
Loss = 1.4552e-01, PNorm = 35.6343, GNorm = 1.3676, lr_0 = 1.1019e-04
Validation rmse = 0.167122
Validation r2 = 0.759919
Epoch 55
Loss = 1.2649e-01, PNorm = 35.6389, GNorm = 0.9186, lr_0 = 1.0755e-04
Loss = 1.3426e-01, PNorm = 35.6422, GNorm = 2.1542, lr_0 = 1.0520e-04
Validation rmse = 0.173253
Validation r2 = 0.741980
Epoch 56
Loss = 1.2547e-01, PNorm = 35.6454, GNorm = 1.0568, lr_0 = 1.0291e-04
Loss = 1.3675e-01, PNorm = 35.6497, GNorm = 1.3993, lr_0 = 1.0066e-04
Validation rmse = 0.168331
Validation r2 = 0.756433
Epoch 57
Loss = 1.2727e-01, PNorm = 35.6545, GNorm = 0.6577, lr_0 = 1.0000e-04
Loss = 1.3418e-01, PNorm = 35.6579, GNorm = 1.1695, lr_0 = 1.0000e-04
Validation rmse = 0.170307
Validation r2 = 0.750681
Epoch 58
Loss = 1.2050e-01, PNorm = 35.6614, GNorm = 0.9610, lr_0 = 1.0000e-04
Loss = 1.3162e-01, PNorm = 35.6643, GNorm = 1.5974, lr_0 = 1.0000e-04
Validation rmse = 0.168724
Validation r2 = 0.755293
Epoch 59
Loss = 1.3321e-01, PNorm = 35.6691, GNorm = 1.6922, lr_0 = 1.0000e-04
Loss = 1.4350e-01, PNorm = 35.6732, GNorm = 1.2869, lr_0 = 1.0000e-04
Validation rmse = 0.168041
Validation r2 = 0.757271
Model 0 best validation rmse = 0.166202 on epoch 50
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.255343
Model 0 test r2 = 0.673140
Ensemble test rmse = 0.255343
Ensemble test r2 = 0.673140
1-fold cross validation
	Seed 0 ==> test rmse = 0.255343
	Seed 0 ==> test r2 = 0.673140
Overall test rmse = 0.255343 +/- 0.000000
Overall test r2 = 0.673140 +/- 0.000000
Elapsed time = 0:00:43
