Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-1d5c3576-9790-4896-9034-9bb28ba18d8e.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/MeOH_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2', 'mse'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2', 'mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 7,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/generalization_3/MeOH_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/MeOH_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 705 | train size = 564 | val size = 141 | test size = 317
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.2161e-01, PNorm = 34.0201, GNorm = 5.8846, lr_0 = 5.5000e-04
Validation rmse = 0.306603
Validation r2 = 0.268784
Validation mse = 0.094006
Epoch 1
Loss = 7.5686e-01, PNorm = 34.0692, GNorm = 13.7927, lr_0 = 1.0000e-03
Validation rmse = 0.329331
Validation r2 = 0.156359
Validation mse = 0.108459
Epoch 2
Loss = 5.9437e-01, PNorm = 34.1394, GNorm = 6.9019, lr_0 = 9.6108e-04
Validation rmse = 0.236484
Validation r2 = 0.564993
Validation mse = 0.055925
Epoch 3
Loss = 4.0962e-01, PNorm = 34.2167, GNorm = 1.3270, lr_0 = 9.2367e-04
Validation rmse = 0.224794
Validation r2 = 0.606936
Validation mse = 0.050533
Epoch 4
Loss = 3.9030e-01, PNorm = 34.2735, GNorm = 1.3868, lr_0 = 8.9093e-04
Validation rmse = 0.202564
Validation r2 = 0.680834
Validation mse = 0.041032
Epoch 5
Loss = 3.6050e-01, PNorm = 34.3407, GNorm = 1.2807, lr_0 = 8.5625e-04
Validation rmse = 0.182894
Validation r2 = 0.739810
Validation mse = 0.033450
Epoch 6
Loss = 2.3473e-01, PNorm = 34.3952, GNorm = 0.8365, lr_0 = 8.2293e-04
Validation rmse = 0.187781
Validation r2 = 0.725720
Validation mse = 0.035262
Epoch 7
Loss = 3.3937e-01, PNorm = 34.4478, GNorm = 7.4210, lr_0 = 7.9090e-04
Loss = 2.4396e-01, PNorm = 34.4871, GNorm = 3.8694, lr_0 = 7.6286e-04
Validation rmse = 0.173626
Validation r2 = 0.765512
Validation mse = 0.030146
Epoch 8
Loss = 2.0932e-01, PNorm = 34.5252, GNorm = 0.7880, lr_0 = 7.3582e-04
Validation rmse = 0.154862
Validation r2 = 0.813456
Validation mse = 0.023982
Epoch 9
Loss = 2.0535e-01, PNorm = 34.5670, GNorm = 4.2564, lr_0 = 7.0718e-04
Validation rmse = 0.144791
Validation r2 = 0.836929
Validation mse = 0.020964
Epoch 10
Loss = 1.7615e-01, PNorm = 34.6041, GNorm = 3.0733, lr_0 = 6.7965e-04
Validation rmse = 0.143221
Validation r2 = 0.840447
Validation mse = 0.020512
Epoch 11
Loss = 1.5880e-01, PNorm = 34.6387, GNorm = 2.2179, lr_0 = 6.5556e-04
Validation rmse = 0.159829
Validation r2 = 0.801297
Validation mse = 0.025545
Epoch 12
Loss = 1.9353e-01, PNorm = 34.6711, GNorm = 2.4575, lr_0 = 6.3005e-04
Validation rmse = 0.130311
Validation r2 = 0.867914
Validation mse = 0.016981
Epoch 13
Loss = 1.4813e-01, PNorm = 34.7018, GNorm = 1.8375, lr_0 = 6.0552e-04
Validation rmse = 0.125339
Validation r2 = 0.877801
Validation mse = 0.015710
Epoch 14
Loss = 1.4400e-01, PNorm = 34.7312, GNorm = 1.6359, lr_0 = 5.8196e-04
Validation rmse = 0.123418
Validation r2 = 0.881520
Validation mse = 0.015232
Epoch 15
Loss = 1.0436e-01, PNorm = 34.7565, GNorm = 0.7218, lr_0 = 5.6133e-04
Loss = 1.4580e-01, PNorm = 34.7808, GNorm = 0.9583, lr_0 = 5.4143e-04
Loss = 1.8678e-01, PNorm = 34.7833, GNorm = 5.1863, lr_0 = 5.3948e-04
Validation rmse = 0.127163
Validation r2 = 0.874219
Validation mse = 0.016170
Epoch 16
Loss = 1.3664e-01, PNorm = 34.8039, GNorm = 4.4941, lr_0 = 5.2036e-04
Validation rmse = 0.125925
Validation r2 = 0.876657
Validation mse = 0.015857
Epoch 17
Loss = 1.4022e-01, PNorm = 34.8244, GNorm = 1.2130, lr_0 = 5.0010e-04
Validation rmse = 0.120363
Validation r2 = 0.887312
Validation mse = 0.014487
Epoch 18
Loss = 1.3295e-01, PNorm = 34.8393, GNorm = 4.2083, lr_0 = 4.8238e-04
Validation rmse = 0.120820
Validation r2 = 0.886455
Validation mse = 0.014597
Epoch 19
Loss = 1.5438e-01, PNorm = 34.8595, GNorm = 1.2685, lr_0 = 4.6360e-04
Validation rmse = 0.161202
Validation r2 = 0.797869
Validation mse = 0.025986
Epoch 20
Loss = 1.6640e-01, PNorm = 34.8761, GNorm = 4.2591, lr_0 = 4.4556e-04
Validation rmse = 0.131289
Validation r2 = 0.865925
Validation mse = 0.017237
Epoch 21
Loss = 1.2047e-01, PNorm = 34.8913, GNorm = 2.7988, lr_0 = 4.2821e-04
Validation rmse = 0.137997
Validation r2 = 0.851873
Validation mse = 0.019043
Epoch 22
Loss = 1.3124e-01, PNorm = 34.9083, GNorm = 0.7290, lr_0 = 4.1304e-04
Validation rmse = 0.115274
Validation r2 = 0.896640
Validation mse = 0.013288
Epoch 23
Loss = 1.2639e-01, PNorm = 34.9229, GNorm = 1.3255, lr_0 = 3.9696e-04
Loss = 1.1607e-01, PNorm = 34.9350, GNorm = 1.5481, lr_0 = 3.8289e-04
Loss = 7.8335e-02, PNorm = 34.9365, GNorm = 1.5580, lr_0 = 3.8151e-04
Validation rmse = 0.116293
Validation r2 = 0.894804
Validation mse = 0.013524
Epoch 24
Loss = 1.1975e-01, PNorm = 34.9475, GNorm = 1.6529, lr_0 = 3.6799e-04
Validation rmse = 0.114816
Validation r2 = 0.897460
Validation mse = 0.013183
Epoch 25
Loss = 1.1276e-01, PNorm = 34.9596, GNorm = 0.6357, lr_0 = 3.5494e-04
Validation rmse = 0.120241
Validation r2 = 0.887541
Validation mse = 0.014458
Epoch 26
Loss = 1.1675e-01, PNorm = 34.9713, GNorm = 0.9069, lr_0 = 3.4113e-04
Validation rmse = 0.116525
Validation r2 = 0.894384
Validation mse = 0.013578
Epoch 27
Loss = 9.7118e-02, PNorm = 34.9821, GNorm = 0.5660, lr_0 = 3.2785e-04
Validation rmse = 0.118833
Validation r2 = 0.890158
Validation mse = 0.014121
Epoch 28
Loss = 1.0370e-01, PNorm = 34.9931, GNorm = 0.9862, lr_0 = 3.1509e-04
Validation rmse = 0.116149
Validation r2 = 0.895064
Validation mse = 0.013491
Epoch 29
Loss = 1.0648e-01, PNorm = 35.0016, GNorm = 3.0728, lr_0 = 3.0392e-04
Validation rmse = 0.128453
Validation r2 = 0.871655
Validation mse = 0.016500
Epoch 30
Loss = 1.1800e-01, PNorm = 35.0132, GNorm = 1.6883, lr_0 = 2.9209e-04
Validation rmse = 0.124170
Validation r2 = 0.880070
Validation mse = 0.015418
Epoch 31
Loss = 1.2744e-01, PNorm = 35.0240, GNorm = 3.3784, lr_0 = 2.8072e-04
Loss = 1.2406e-01, PNorm = 35.0329, GNorm = 4.2041, lr_0 = 2.7077e-04
Loss = 7.3919e-02, PNorm = 35.0336, GNorm = 1.4658, lr_0 = 2.6980e-04
Validation rmse = 0.117759
Validation r2 = 0.892135
Validation mse = 0.013867
Epoch 32
Loss = 1.0642e-01, PNorm = 35.0441, GNorm = 0.9293, lr_0 = 2.6023e-04
Validation rmse = 0.114474
Validation r2 = 0.898069
Validation mse = 0.013104
Epoch 33
Loss = 1.0909e-01, PNorm = 35.0508, GNorm = 1.8332, lr_0 = 2.5101e-04
Validation rmse = 0.124300
Validation r2 = 0.879820
Validation mse = 0.015450
Epoch 34
Loss = 9.9346e-02, PNorm = 35.0598, GNorm = 0.5328, lr_0 = 2.4124e-04
Validation rmse = 0.120304
Validation r2 = 0.887422
Validation mse = 0.014473
Epoch 35
Loss = 9.6424e-02, PNorm = 35.0673, GNorm = 0.9215, lr_0 = 2.3185e-04
Validation rmse = 0.115061
Validation r2 = 0.897021
Validation mse = 0.013239
Epoch 36
Loss = 7.7117e-02, PNorm = 35.0739, GNorm = 0.7026, lr_0 = 2.2363e-04
Validation rmse = 0.115233
Validation r2 = 0.896712
Validation mse = 0.013279
Epoch 37
Loss = 9.2057e-02, PNorm = 35.0810, GNorm = 0.4350, lr_0 = 2.1493e-04
Validation rmse = 0.116193
Validation r2 = 0.894984
Validation mse = 0.013501
Epoch 38
Loss = 9.1616e-02, PNorm = 35.0872, GNorm = 1.5578, lr_0 = 2.0656e-04
Validation rmse = 0.119848
Validation r2 = 0.888275
Validation mse = 0.014363
Epoch 39
Loss = 8.1721e-02, PNorm = 35.0932, GNorm = 1.5472, lr_0 = 1.9852e-04
Loss = 9.9693e-02, PNorm = 35.0993, GNorm = 0.8789, lr_0 = 1.9148e-04
Validation rmse = 0.115854
Validation r2 = 0.895598
Validation mse = 0.013422
Epoch 40
Loss = 9.0889e-02, PNorm = 35.1049, GNorm = 1.7426, lr_0 = 1.8470e-04
Validation rmse = 0.114781
Validation r2 = 0.897522
Validation mse = 0.013175
Epoch 41
Loss = 9.8608e-02, PNorm = 35.1112, GNorm = 1.0247, lr_0 = 1.7751e-04
Validation rmse = 0.115963
Validation r2 = 0.895399
Validation mse = 0.013448
Epoch 42
Loss = 1.0154e-01, PNorm = 35.1176, GNorm = 1.1593, lr_0 = 1.7060e-04
Validation rmse = 0.115407
Validation r2 = 0.896401
Validation mse = 0.013319
Epoch 43
Loss = 9.7214e-02, PNorm = 35.1222, GNorm = 0.8975, lr_0 = 1.6455e-04
Validation rmse = 0.127170
Validation r2 = 0.874206
Validation mse = 0.016172
Epoch 44
Loss = 9.3462e-02, PNorm = 35.1268, GNorm = 2.2130, lr_0 = 1.5815e-04
Validation rmse = 0.115491
Validation r2 = 0.896250
Validation mse = 0.013338
Epoch 45
Loss = 9.2361e-02, PNorm = 35.1317, GNorm = 2.2940, lr_0 = 1.5199e-04
Validation rmse = 0.115378
Validation r2 = 0.896453
Validation mse = 0.013312
Epoch 46
Loss = 6.3761e-02, PNorm = 35.1365, GNorm = 1.0417, lr_0 = 1.4608e-04
Loss = 9.5356e-02, PNorm = 35.1411, GNorm = 2.7695, lr_0 = 1.4090e-04
Validation rmse = 0.115896
Validation r2 = 0.895520
Validation mse = 0.013432
Epoch 47
Loss = 9.9267e-02, PNorm = 35.1449, GNorm = 2.2912, lr_0 = 1.3590e-04
Validation rmse = 0.114334
Validation r2 = 0.898318
Validation mse = 0.013072
Epoch 48
Loss = 9.4721e-02, PNorm = 35.1488, GNorm = 1.6362, lr_0 = 1.3061e-04
Validation rmse = 0.114407
Validation r2 = 0.898188
Validation mse = 0.013089
Epoch 49
Loss = 9.5637e-02, PNorm = 35.1531, GNorm = 1.2052, lr_0 = 1.2553e-04
Validation rmse = 0.114936
Validation r2 = 0.897245
Validation mse = 0.013210
Epoch 50
Loss = 7.7737e-02, PNorm = 35.1563, GNorm = 0.4693, lr_0 = 1.2108e-04
Validation rmse = 0.125518
Validation r2 = 0.877452
Validation mse = 0.015755
Epoch 51
Loss = 9.1095e-02, PNorm = 35.1613, GNorm = 0.6424, lr_0 = 1.1637e-04
Validation rmse = 0.118401
Validation r2 = 0.890956
Validation mse = 0.014019
Epoch 52
Loss = 8.4625e-02, PNorm = 35.1652, GNorm = 0.8744, lr_0 = 1.1184e-04
Validation rmse = 0.115478
Validation r2 = 0.896273
Validation mse = 0.013335
Epoch 53
Loss = 7.7428e-02, PNorm = 35.1695, GNorm = 1.3867, lr_0 = 1.0749e-04
Validation rmse = 0.115819
Validation r2 = 0.895659
Validation mse = 0.013414
Epoch 54
Loss = 9.6785e-02, PNorm = 35.1730, GNorm = 0.8818, lr_0 = 1.0367e-04
Loss = 8.8160e-02, PNorm = 35.1757, GNorm = 0.5522, lr_0 = 1.0000e-04
Loss = 9.5300e-02, PNorm = 35.1760, GNorm = 2.0247, lr_0 = 1.0000e-04
Validation rmse = 0.117085
Validation r2 = 0.893367
Validation mse = 0.013709
Epoch 55
Loss = 9.0016e-02, PNorm = 35.1791, GNorm = 0.5885, lr_0 = 1.0000e-04
Validation rmse = 0.114462
Validation r2 = 0.898090
Validation mse = 0.013102
Epoch 56
Loss = 8.7324e-02, PNorm = 35.1819, GNorm = 1.3061, lr_0 = 1.0000e-04
Validation rmse = 0.120361
Validation r2 = 0.887315
Validation mse = 0.014487
Epoch 57
Loss = 8.2773e-02, PNorm = 35.1857, GNorm = 0.6719, lr_0 = 1.0000e-04
Validation rmse = 0.114880
Validation r2 = 0.897344
Validation mse = 0.013197
Epoch 58
Loss = 8.8975e-02, PNorm = 35.1895, GNorm = 2.3955, lr_0 = 1.0000e-04
Validation rmse = 0.113856
Validation r2 = 0.899166
Validation mse = 0.012963
Epoch 59
Loss = 1.0789e-01, PNorm = 35.1931, GNorm = 0.9479, lr_0 = 1.0000e-04
Validation rmse = 0.114327
Validation r2 = 0.898331
Validation mse = 0.013071
Model 0 best validation rmse = 0.113856 on epoch 58
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.166109
Model 0 test r2 = 0.603901
Model 0 test mse = 0.027592
Ensemble test rmse = 0.166109
Ensemble test r2 = 0.603901
Ensemble test mse = 0.027592
Fold 1
Splitting data with seed 1
Total size = 705 | train size = 564 | val size = 141 | test size = 317
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.6764e-01, PNorm = 34.0168, GNorm = 6.4484, lr_0 = 5.5000e-04
Validation rmse = 0.311166
Validation r2 = 0.184108
Validation mse = 0.096824
Epoch 1
Loss = 6.5920e-01, PNorm = 34.0647, GNorm = 1.1527, lr_0 = 1.0000e-03
Validation rmse = 0.414860
Validation r2 = -0.450281
Validation mse = 0.172109
Epoch 2
Loss = 6.7237e-01, PNorm = 34.1176, GNorm = 5.0880, lr_0 = 9.6108e-04
Validation rmse = 0.253347
Validation r2 = 0.459144
Validation mse = 0.064185
Epoch 3
Loss = 5.0852e-01, PNorm = 34.1878, GNorm = 0.7808, lr_0 = 9.2367e-04
Validation rmse = 0.301124
Validation r2 = 0.235919
Validation mse = 0.090676
Epoch 4
Loss = 4.3975e-01, PNorm = 34.2432, GNorm = 6.0465, lr_0 = 8.9093e-04
Validation rmse = 0.225146
Validation r2 = 0.572851
Validation mse = 0.050691
Epoch 5
Loss = 3.1486e-01, PNorm = 34.2974, GNorm = 3.5672, lr_0 = 8.5625e-04
Validation rmse = 0.225383
Validation r2 = 0.571953
Validation mse = 0.050798
Epoch 6
Loss = 3.1177e-01, PNorm = 34.3488, GNorm = 2.2252, lr_0 = 8.2293e-04
Validation rmse = 0.205211
Validation r2 = 0.645145
Validation mse = 0.042112
Epoch 7
Loss = 2.5268e-01, PNorm = 34.4016, GNorm = 2.9246, lr_0 = 7.9090e-04
Loss = 2.6301e-01, PNorm = 34.4486, GNorm = 8.3775, lr_0 = 7.6286e-04
Validation rmse = 0.201087
Validation r2 = 0.659266
Validation mse = 0.040436
Epoch 8
Loss = 2.5828e-01, PNorm = 34.4909, GNorm = 4.3386, lr_0 = 7.3582e-04
Validation rmse = 0.191095
Validation r2 = 0.692286
Validation mse = 0.036517
Epoch 9
Loss = 2.0409e-01, PNorm = 34.5373, GNorm = 1.0396, lr_0 = 7.0718e-04
Validation rmse = 0.192342
Validation r2 = 0.688258
Validation mse = 0.036995
Epoch 10
Loss = 2.4145e-01, PNorm = 34.5845, GNorm = 3.5485, lr_0 = 6.7965e-04
Validation rmse = 0.175062
Validation r2 = 0.741756
Validation mse = 0.030647
Epoch 11
Loss = 1.7095e-01, PNorm = 34.6252, GNorm = 1.7264, lr_0 = 6.5556e-04
Validation rmse = 0.174800
Validation r2 = 0.742528
Validation mse = 0.030555
Epoch 12
Loss = 1.6468e-01, PNorm = 34.6630, GNorm = 6.3293, lr_0 = 6.3005e-04
Validation rmse = 0.163071
Validation r2 = 0.775921
Validation mse = 0.026592
Epoch 13
Loss = 1.3699e-01, PNorm = 34.6991, GNorm = 2.4224, lr_0 = 6.0552e-04
Validation rmse = 0.158866
Validation r2 = 0.787327
Validation mse = 0.025239
Epoch 14
Loss = 1.3642e-01, PNorm = 34.7342, GNorm = 3.0384, lr_0 = 5.8196e-04
Validation rmse = 0.162962
Validation r2 = 0.776219
Validation mse = 0.026557
Epoch 15
Loss = 8.4795e-02, PNorm = 34.7640, GNorm = 0.6842, lr_0 = 5.6133e-04
Loss = 1.3866e-01, PNorm = 34.7885, GNorm = 1.2137, lr_0 = 5.4143e-04
Loss = 1.3927e-01, PNorm = 34.7909, GNorm = 1.9827, lr_0 = 5.3948e-04
Validation rmse = 0.163319
Validation r2 = 0.775237
Validation mse = 0.026673
Epoch 16
Loss = 1.2176e-01, PNorm = 34.8163, GNorm = 3.3072, lr_0 = 5.2036e-04
Validation rmse = 0.155677
Validation r2 = 0.795779
Validation mse = 0.024235
Epoch 17
Loss = 1.3797e-01, PNorm = 34.8408, GNorm = 3.0592, lr_0 = 5.0010e-04
Validation rmse = 0.159716
Validation r2 = 0.785046
Validation mse = 0.025509
Epoch 18
Loss = 1.2146e-01, PNorm = 34.8628, GNorm = 1.6507, lr_0 = 4.8238e-04
Validation rmse = 0.177514
Validation r2 = 0.734469
Validation mse = 0.031511
Epoch 19
Loss = 1.4824e-01, PNorm = 34.8805, GNorm = 3.0072, lr_0 = 4.6360e-04
Validation rmse = 0.158517
Validation r2 = 0.788261
Validation mse = 0.025128
Epoch 20
Loss = 1.1494e-01, PNorm = 34.9005, GNorm = 2.9109, lr_0 = 4.4556e-04
Validation rmse = 0.157001
Validation r2 = 0.792292
Validation mse = 0.024649
Epoch 21
Loss = 1.1849e-01, PNorm = 34.9181, GNorm = 0.4927, lr_0 = 4.2821e-04
Validation rmse = 0.157436
Validation r2 = 0.791139
Validation mse = 0.024786
Epoch 22
Loss = 1.0888e-01, PNorm = 34.9333, GNorm = 1.4037, lr_0 = 4.1304e-04
Validation rmse = 0.152885
Validation r2 = 0.803040
Validation mse = 0.023374
Epoch 23
Loss = 1.1943e-01, PNorm = 34.9456, GNorm = 2.1981, lr_0 = 3.9696e-04
Loss = 1.1619e-01, PNorm = 34.9623, GNorm = 1.0040, lr_0 = 3.8289e-04
Loss = 9.1016e-02, PNorm = 34.9639, GNorm = 3.0198, lr_0 = 3.8151e-04
Validation rmse = 0.163912
Validation r2 = 0.773603
Validation mse = 0.026867
Epoch 24
Loss = 1.0409e-01, PNorm = 34.9755, GNorm = 0.9976, lr_0 = 3.6799e-04
Validation rmse = 0.148860
Validation r2 = 0.813274
Validation mse = 0.022159
Epoch 25
Loss = 1.0747e-01, PNorm = 34.9921, GNorm = 0.9251, lr_0 = 3.5494e-04
Validation rmse = 0.153820
Validation r2 = 0.800624
Validation mse = 0.023660
Epoch 26
Loss = 9.3730e-02, PNorm = 35.0048, GNorm = 1.7879, lr_0 = 3.4113e-04
Validation rmse = 0.149264
Validation r2 = 0.812258
Validation mse = 0.022280
Epoch 27
Loss = 8.4734e-02, PNorm = 35.0157, GNorm = 1.2610, lr_0 = 3.2785e-04
Validation rmse = 0.152642
Validation r2 = 0.803664
Validation mse = 0.023300
Epoch 28
Loss = 1.0181e-01, PNorm = 35.0290, GNorm = 0.7351, lr_0 = 3.1509e-04
Validation rmse = 0.148295
Validation r2 = 0.814688
Validation mse = 0.021991
Epoch 29
Loss = 8.6945e-02, PNorm = 35.0406, GNorm = 1.8317, lr_0 = 3.0392e-04
Validation rmse = 0.152744
Validation r2 = 0.803403
Validation mse = 0.023331
Epoch 30
Loss = 8.6282e-02, PNorm = 35.0507, GNorm = 1.2207, lr_0 = 2.9209e-04
Validation rmse = 0.150433
Validation r2 = 0.809307
Validation mse = 0.022630
Epoch 31
Loss = 9.8797e-02, PNorm = 35.0627, GNorm = 1.9677, lr_0 = 2.8072e-04
Loss = 9.9549e-02, PNorm = 35.0712, GNorm = 3.8095, lr_0 = 2.7077e-04
Loss = 1.4343e-01, PNorm = 35.0732, GNorm = 5.9014, lr_0 = 2.6980e-04
Validation rmse = 0.148318
Validation r2 = 0.814632
Validation mse = 0.021998
Epoch 32
Loss = 1.1305e-01, PNorm = 35.0828, GNorm = 4.4971, lr_0 = 2.6023e-04
Validation rmse = 0.150846
Validation r2 = 0.808257
Validation mse = 0.022755
Epoch 33
Loss = 9.9189e-02, PNorm = 35.0925, GNorm = 1.5558, lr_0 = 2.5101e-04
Validation rmse = 0.146813
Validation r2 = 0.818374
Validation mse = 0.021554
Epoch 34
Loss = 9.8104e-02, PNorm = 35.1019, GNorm = 1.9034, lr_0 = 2.4124e-04
Validation rmse = 0.146808
Validation r2 = 0.818387
Validation mse = 0.021553
Epoch 35
Loss = 9.1673e-02, PNorm = 35.1100, GNorm = 0.9231, lr_0 = 2.3185e-04
Validation rmse = 0.146722
Validation r2 = 0.818600
Validation mse = 0.021527
Epoch 36
Loss = 6.9170e-02, PNorm = 35.1180, GNorm = 0.7097, lr_0 = 2.2363e-04
Validation rmse = 0.146549
Validation r2 = 0.819027
Validation mse = 0.021477
Epoch 37
Loss = 9.8303e-02, PNorm = 35.1263, GNorm = 0.6613, lr_0 = 2.1493e-04
Validation rmse = 0.146581
Validation r2 = 0.818948
Validation mse = 0.021486
Epoch 38
Loss = 1.2185e-01, PNorm = 35.1344, GNorm = 2.3331, lr_0 = 2.0656e-04
Validation rmse = 0.144950
Validation r2 = 0.822953
Validation mse = 0.021011
Epoch 39
Loss = 5.9052e-02, PNorm = 35.1417, GNorm = 0.6023, lr_0 = 1.9852e-04
Loss = 9.0011e-02, PNorm = 35.1484, GNorm = 2.1445, lr_0 = 1.9148e-04
Validation rmse = 0.146187
Validation r2 = 0.819920
Validation mse = 0.021371
Epoch 40
Loss = 8.8464e-02, PNorm = 35.1548, GNorm = 0.9178, lr_0 = 1.8470e-04
Validation rmse = 0.146161
Validation r2 = 0.819984
Validation mse = 0.021363
Epoch 41
Loss = 8.6896e-02, PNorm = 35.1621, GNorm = 1.8346, lr_0 = 1.7751e-04
Validation rmse = 0.145229
Validation r2 = 0.822272
Validation mse = 0.021091
Epoch 42
Loss = 7.6183e-02, PNorm = 35.1675, GNorm = 0.7533, lr_0 = 1.7060e-04
Validation rmse = 0.145932
Validation r2 = 0.820548
Validation mse = 0.021296
Epoch 43
Loss = 9.1956e-02, PNorm = 35.1731, GNorm = 2.1180, lr_0 = 1.6455e-04
Validation rmse = 0.145964
Validation r2 = 0.820468
Validation mse = 0.021306
Epoch 44
Loss = 7.4362e-02, PNorm = 35.1786, GNorm = 1.0775, lr_0 = 1.5815e-04
Validation rmse = 0.144857
Validation r2 = 0.823181
Validation mse = 0.020984
Epoch 45
Loss = 6.4240e-02, PNorm = 35.1854, GNorm = 0.5918, lr_0 = 1.5199e-04
Validation rmse = 0.145192
Validation r2 = 0.822362
Validation mse = 0.021081
Epoch 46
Loss = 7.3340e-02, PNorm = 35.1901, GNorm = 0.3839, lr_0 = 1.4608e-04
Loss = 9.0903e-02, PNorm = 35.1952, GNorm = 1.7955, lr_0 = 1.4090e-04
Validation rmse = 0.147237
Validation r2 = 0.817322
Validation mse = 0.021679
Epoch 47
Loss = 7.9532e-02, PNorm = 35.2010, GNorm = 2.0744, lr_0 = 1.3590e-04
Validation rmse = 0.144699
Validation r2 = 0.823568
Validation mse = 0.020938
Epoch 48
Loss = 7.7082e-02, PNorm = 35.2050, GNorm = 0.9905, lr_0 = 1.3061e-04
Validation rmse = 0.145899
Validation r2 = 0.820628
Validation mse = 0.021287
Epoch 49
Loss = 7.8495e-02, PNorm = 35.2104, GNorm = 1.1516, lr_0 = 1.2553e-04
Validation rmse = 0.144471
Validation r2 = 0.824123
Validation mse = 0.020872
Epoch 50
Loss = 8.0829e-02, PNorm = 35.2136, GNorm = 1.3542, lr_0 = 1.2108e-04
Validation rmse = 0.143649
Validation r2 = 0.826118
Validation mse = 0.020635
Epoch 51
Loss = 8.3411e-02, PNorm = 35.2180, GNorm = 1.9493, lr_0 = 1.1637e-04
Validation rmse = 0.146134
Validation r2 = 0.820051
Validation mse = 0.021355
Epoch 52
Loss = 6.3862e-02, PNorm = 35.2226, GNorm = 0.6604, lr_0 = 1.1184e-04
Validation rmse = 0.143705
Validation r2 = 0.825983
Validation mse = 0.020651
Epoch 53
Loss = 6.9852e-02, PNorm = 35.2273, GNorm = 1.8698, lr_0 = 1.0749e-04
Validation rmse = 0.145219
Validation r2 = 0.822296
Validation mse = 0.021089
Epoch 54
Loss = 7.8906e-02, PNorm = 35.2314, GNorm = 0.5292, lr_0 = 1.0367e-04
Loss = 7.6494e-02, PNorm = 35.2341, GNorm = 1.3057, lr_0 = 1.0000e-04
Loss = 1.2622e-01, PNorm = 35.2346, GNorm = 1.4036, lr_0 = 1.0000e-04
Validation rmse = 0.142795
Validation r2 = 0.828180
Validation mse = 0.020390
Epoch 55
Loss = 7.5269e-02, PNorm = 35.2388, GNorm = 1.0975, lr_0 = 1.0000e-04
Validation rmse = 0.144340
Validation r2 = 0.824441
Validation mse = 0.020834
Epoch 56
Loss = 7.5040e-02, PNorm = 35.2430, GNorm = 1.0556, lr_0 = 1.0000e-04
Validation rmse = 0.142990
Validation r2 = 0.827710
Validation mse = 0.020446
Epoch 57
Loss = 7.4576e-02, PNorm = 35.2465, GNorm = 0.5893, lr_0 = 1.0000e-04
Validation rmse = 0.142883
Validation r2 = 0.827968
Validation mse = 0.020416
Epoch 58
Loss = 7.5211e-02, PNorm = 35.2498, GNorm = 1.0309, lr_0 = 1.0000e-04
Validation rmse = 0.144279
Validation r2 = 0.824589
Validation mse = 0.020817
Epoch 59
Loss = 7.3183e-02, PNorm = 35.2533, GNorm = 0.8877, lr_0 = 1.0000e-04
Validation rmse = 0.143773
Validation r2 = 0.825818
Validation mse = 0.020671
Model 0 best validation rmse = 0.142795 on epoch 54
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.180713
Model 0 test r2 = 0.531193
Model 0 test mse = 0.032657
Ensemble test rmse = 0.180713
Ensemble test r2 = 0.531193
Ensemble test mse = 0.032657
Fold 2
Splitting data with seed 2
Total size = 705 | train size = 564 | val size = 141 | test size = 317
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.0333e-01, PNorm = 34.0219, GNorm = 2.5397, lr_0 = 5.5000e-04
Validation rmse = 0.305150
Validation r2 = 0.301225
Validation mse = 0.093117
Epoch 1
Loss = 8.2578e-01, PNorm = 34.0706, GNorm = 15.0500, lr_0 = 1.0000e-03
Validation rmse = 0.295493
Validation r2 = 0.344756
Validation mse = 0.087316
Epoch 2
Loss = 5.5269e-01, PNorm = 34.1281, GNorm = 5.2088, lr_0 = 9.6108e-04
Validation rmse = 0.259354
Validation r2 = 0.495227
Validation mse = 0.067265
Epoch 3
Loss = 4.2429e-01, PNorm = 34.2062, GNorm = 1.7343, lr_0 = 9.2367e-04
Validation rmse = 0.230592
Validation r2 = 0.600977
Validation mse = 0.053173
Epoch 4
Loss = 4.1207e-01, PNorm = 34.2648, GNorm = 4.8907, lr_0 = 8.9093e-04
Validation rmse = 0.216070
Validation r2 = 0.649654
Validation mse = 0.046686
Epoch 5
Loss = 3.2262e-01, PNorm = 34.3211, GNorm = 1.5639, lr_0 = 8.5625e-04
Validation rmse = 0.205577
Validation r2 = 0.682856
Validation mse = 0.042262
Epoch 6
Loss = 2.5308e-01, PNorm = 34.3761, GNorm = 2.1563, lr_0 = 8.2293e-04
Validation rmse = 0.193439
Validation r2 = 0.719201
Validation mse = 0.037418
Epoch 7
Loss = 1.9793e-01, PNorm = 34.4265, GNorm = 4.4107, lr_0 = 7.9090e-04
Loss = 2.3678e-01, PNorm = 34.4705, GNorm = 4.5005, lr_0 = 7.6286e-04
Validation rmse = 0.182372
Validation r2 = 0.750411
Validation mse = 0.033260
Epoch 8
Loss = 2.0226e-01, PNorm = 34.5093, GNorm = 1.4250, lr_0 = 7.3582e-04
Validation rmse = 0.183053
Validation r2 = 0.748544
Validation mse = 0.033508
Epoch 9
Loss = 1.8916e-01, PNorm = 34.5448, GNorm = 3.6888, lr_0 = 7.0718e-04
Validation rmse = 0.165690
Validation r2 = 0.793984
Validation mse = 0.027453
Epoch 10
Loss = 1.9279e-01, PNorm = 34.5853, GNorm = 5.1039, lr_0 = 6.7965e-04
Validation rmse = 0.167525
Validation r2 = 0.789394
Validation mse = 0.028065
Epoch 11
Loss = 1.6378e-01, PNorm = 34.6144, GNorm = 1.7530, lr_0 = 6.5556e-04
Validation rmse = 0.158436
Validation r2 = 0.811628
Validation mse = 0.025102
Epoch 12
Loss = 1.4895e-01, PNorm = 34.6440, GNorm = 3.6514, lr_0 = 6.3005e-04
Validation rmse = 0.156985
Validation r2 = 0.815063
Validation mse = 0.024644
Epoch 13
Loss = 1.5561e-01, PNorm = 34.6779, GNorm = 2.1906, lr_0 = 6.0552e-04
Validation rmse = 0.153113
Validation r2 = 0.824073
Validation mse = 0.023444
Epoch 14
Loss = 1.2517e-01, PNorm = 34.7049, GNorm = 1.1901, lr_0 = 5.8196e-04
Validation rmse = 0.160530
Validation r2 = 0.806617
Validation mse = 0.025770
Epoch 15
Loss = 8.4357e-02, PNorm = 34.7278, GNorm = 2.2142, lr_0 = 5.6133e-04
Loss = 1.4248e-01, PNorm = 34.7477, GNorm = 0.6151, lr_0 = 5.4143e-04
Loss = 1.1723e-01, PNorm = 34.7501, GNorm = 3.4988, lr_0 = 5.3948e-04
Validation rmse = 0.160010
Validation r2 = 0.807866
Validation mse = 0.025603
Epoch 16
Loss = 1.2631e-01, PNorm = 34.7722, GNorm = 2.1058, lr_0 = 5.2036e-04
Validation rmse = 0.151555
Validation r2 = 0.827636
Validation mse = 0.022969
Epoch 17
Loss = 1.2304e-01, PNorm = 34.7924, GNorm = 1.4153, lr_0 = 5.0010e-04
Validation rmse = 0.170076
Validation r2 = 0.782933
Validation mse = 0.028926
Epoch 18
Loss = 1.4390e-01, PNorm = 34.8099, GNorm = 0.9929, lr_0 = 4.8238e-04
Validation rmse = 0.162208
Validation r2 = 0.802553
Validation mse = 0.026311
Epoch 19
Loss = 1.2396e-01, PNorm = 34.8271, GNorm = 4.0425, lr_0 = 4.6360e-04
Validation rmse = 0.148935
Validation r2 = 0.833542
Validation mse = 0.022182
Epoch 20
Loss = 1.0757e-01, PNorm = 34.8456, GNorm = 3.0432, lr_0 = 4.4556e-04
Validation rmse = 0.193417
Validation r2 = 0.719263
Validation mse = 0.037410
Epoch 21
Loss = 1.5027e-01, PNorm = 34.8663, GNorm = 5.6041, lr_0 = 4.2821e-04
Validation rmse = 0.150674
Validation r2 = 0.829634
Validation mse = 0.022703
Epoch 22
Loss = 1.2517e-01, PNorm = 34.8818, GNorm = 2.8514, lr_0 = 4.1304e-04
Validation rmse = 0.147405
Validation r2 = 0.836946
Validation mse = 0.021728
Epoch 23
Loss = 1.2448e-01, PNorm = 34.8951, GNorm = 2.1371, lr_0 = 3.9696e-04
Loss = 1.0530e-01, PNorm = 34.9084, GNorm = 2.7185, lr_0 = 3.8289e-04
Loss = 8.4299e-02, PNorm = 34.9094, GNorm = 0.8913, lr_0 = 3.8151e-04
Validation rmse = 0.144160
Validation r2 = 0.844045
Validation mse = 0.020782
Epoch 24
Loss = 1.0421e-01, PNorm = 34.9190, GNorm = 0.8894, lr_0 = 3.6799e-04
Validation rmse = 0.140682
Validation r2 = 0.851479
Validation mse = 0.019791
Epoch 25
Loss = 1.2417e-01, PNorm = 34.9299, GNorm = 2.1574, lr_0 = 3.5494e-04
Validation rmse = 0.141849
Validation r2 = 0.849005
Validation mse = 0.020121
Epoch 26
Loss = 1.1525e-01, PNorm = 34.9398, GNorm = 3.7386, lr_0 = 3.4113e-04
Validation rmse = 0.168973
Validation r2 = 0.785738
Validation mse = 0.028552
Epoch 27
Loss = 1.1119e-01, PNorm = 34.9502, GNorm = 3.8002, lr_0 = 3.2785e-04
Validation rmse = 0.144877
Validation r2 = 0.842490
Validation mse = 0.020989
Epoch 28
Loss = 1.0423e-01, PNorm = 34.9600, GNorm = 2.7943, lr_0 = 3.1509e-04
Validation rmse = 0.139893
Validation r2 = 0.853140
Validation mse = 0.019570
Epoch 29
Loss = 1.1871e-01, PNorm = 34.9689, GNorm = 4.3672, lr_0 = 3.0392e-04
Validation rmse = 0.150758
Validation r2 = 0.829442
Validation mse = 0.022728
Epoch 30
Loss = 1.0189e-01, PNorm = 34.9820, GNorm = 2.1376, lr_0 = 2.9209e-04
Validation rmse = 0.138836
Validation r2 = 0.855351
Validation mse = 0.019276
Epoch 31
Loss = 6.7185e-02, PNorm = 34.9926, GNorm = 0.7784, lr_0 = 2.8072e-04
Loss = 1.0235e-01, PNorm = 34.9998, GNorm = 2.8082, lr_0 = 2.7077e-04
Loss = 1.2854e-01, PNorm = 35.0002, GNorm = 4.7677, lr_0 = 2.6980e-04
Validation rmse = 0.140966
Validation r2 = 0.850880
Validation mse = 0.019871
Epoch 32
Loss = 1.1227e-01, PNorm = 35.0082, GNorm = 2.0819, lr_0 = 2.6023e-04
Validation rmse = 0.144241
Validation r2 = 0.843870
Validation mse = 0.020805
Epoch 33
Loss = 8.9939e-02, PNorm = 35.0143, GNorm = 1.1191, lr_0 = 2.5101e-04
Validation rmse = 0.160898
Validation r2 = 0.805729
Validation mse = 0.025888
Epoch 34
Loss = 1.1051e-01, PNorm = 35.0229, GNorm = 0.6070, lr_0 = 2.4124e-04
Validation rmse = 0.140190
Validation r2 = 0.852517
Validation mse = 0.019653
Epoch 35
Loss = 9.3093e-02, PNorm = 35.0304, GNorm = 2.2750, lr_0 = 2.3185e-04
Validation rmse = 0.137956
Validation r2 = 0.857180
Validation mse = 0.019032
Epoch 36
Loss = 9.2865e-02, PNorm = 35.0371, GNorm = 0.9461, lr_0 = 2.2363e-04
Validation rmse = 0.140412
Validation r2 = 0.852049
Validation mse = 0.019715
Epoch 37
Loss = 9.8377e-02, PNorm = 35.0422, GNorm = 0.8923, lr_0 = 2.1493e-04
Validation rmse = 0.146643
Validation r2 = 0.838627
Validation mse = 0.021504
Epoch 38
Loss = 8.3637e-02, PNorm = 35.0481, GNorm = 1.5984, lr_0 = 2.0656e-04
Validation rmse = 0.150575
Validation r2 = 0.829857
Validation mse = 0.022673
Epoch 39
Loss = 1.1837e-01, PNorm = 35.0538, GNorm = 3.2338, lr_0 = 1.9852e-04
Loss = 1.0054e-01, PNorm = 35.0591, GNorm = 1.8282, lr_0 = 1.9148e-04
Validation rmse = 0.139898
Validation r2 = 0.853130
Validation mse = 0.019571
Epoch 40
Loss = 8.8804e-02, PNorm = 35.0656, GNorm = 0.3956, lr_0 = 1.8470e-04
Validation rmse = 0.144868
Validation r2 = 0.842510
Validation mse = 0.020987
Epoch 41
Loss = 9.5966e-02, PNorm = 35.0728, GNorm = 1.6070, lr_0 = 1.7751e-04
Validation rmse = 0.141674
Validation r2 = 0.849377
Validation mse = 0.020072
Epoch 42
Loss = 9.0005e-02, PNorm = 35.0779, GNorm = 1.4415, lr_0 = 1.7060e-04
Validation rmse = 0.155643
Validation r2 = 0.818210
Validation mse = 0.024225
Epoch 43
Loss = 1.0242e-01, PNorm = 35.0835, GNorm = 1.2953, lr_0 = 1.6455e-04
Validation rmse = 0.149546
Validation r2 = 0.832175
Validation mse = 0.022364
Epoch 44
Loss = 9.4994e-02, PNorm = 35.0888, GNorm = 1.0333, lr_0 = 1.5815e-04
Validation rmse = 0.140847
Validation r2 = 0.851131
Validation mse = 0.019838
Epoch 45
Loss = 8.5596e-02, PNorm = 35.0930, GNorm = 0.6260, lr_0 = 1.5199e-04
Validation rmse = 0.137800
Validation r2 = 0.857503
Validation mse = 0.018989
Epoch 46
Loss = 8.7577e-02, PNorm = 35.0968, GNorm = 1.5085, lr_0 = 1.4608e-04
Loss = 8.3233e-02, PNorm = 35.1002, GNorm = 1.2043, lr_0 = 1.4090e-04
Validation rmse = 0.143567
Validation r2 = 0.845327
Validation mse = 0.020611
Epoch 47
Loss = 8.6617e-02, PNorm = 35.1055, GNorm = 0.8744, lr_0 = 1.3590e-04
Validation rmse = 0.138965
Validation r2 = 0.855083
Validation mse = 0.019311
Epoch 48
Loss = 8.8663e-02, PNorm = 35.1095, GNorm = 0.5893, lr_0 = 1.3061e-04
Validation rmse = 0.136814
Validation r2 = 0.859534
Validation mse = 0.018718
Epoch 49
Loss = 7.9041e-02, PNorm = 35.1135, GNorm = 1.2730, lr_0 = 1.2553e-04
Validation rmse = 0.137202
Validation r2 = 0.858736
Validation mse = 0.018825
Epoch 50
Loss = 7.2940e-02, PNorm = 35.1178, GNorm = 1.4747, lr_0 = 1.2108e-04
Validation rmse = 0.136511
Validation r2 = 0.860156
Validation mse = 0.018635
Epoch 51
Loss = 9.1027e-02, PNorm = 35.1221, GNorm = 1.1494, lr_0 = 1.1637e-04
Validation rmse = 0.137588
Validation r2 = 0.857940
Validation mse = 0.018931
Epoch 52
Loss = 8.3774e-02, PNorm = 35.1259, GNorm = 2.6109, lr_0 = 1.1184e-04
Validation rmse = 0.142283
Validation r2 = 0.848079
Validation mse = 0.020245
Epoch 53
Loss = 9.8450e-02, PNorm = 35.1290, GNorm = 1.9830, lr_0 = 1.0749e-04
Validation rmse = 0.141107
Validation r2 = 0.850580
Validation mse = 0.019911
Epoch 54
Loss = 1.0396e-01, PNorm = 35.1318, GNorm = 3.2474, lr_0 = 1.0367e-04
Loss = 8.2746e-02, PNorm = 35.1348, GNorm = 1.4053, lr_0 = 1.0000e-04
Loss = 7.1452e-02, PNorm = 35.1351, GNorm = 1.6307, lr_0 = 1.0000e-04
Validation rmse = 0.138662
Validation r2 = 0.855714
Validation mse = 0.019227
Epoch 55
Loss = 8.1381e-02, PNorm = 35.1386, GNorm = 1.1689, lr_0 = 1.0000e-04
Validation rmse = 0.136673
Validation r2 = 0.859823
Validation mse = 0.018680
Epoch 56
Loss = 8.2502e-02, PNorm = 35.1415, GNorm = 0.8167, lr_0 = 1.0000e-04
Validation rmse = 0.137189
Validation r2 = 0.858764
Validation mse = 0.018821
Epoch 57
Loss = 8.2001e-02, PNorm = 35.1443, GNorm = 2.1061, lr_0 = 1.0000e-04
Validation rmse = 0.139593
Validation r2 = 0.853769
Validation mse = 0.019486
Epoch 58
Loss = 7.6373e-02, PNorm = 35.1478, GNorm = 1.1311, lr_0 = 1.0000e-04
Validation rmse = 0.141902
Validation r2 = 0.848892
Validation mse = 0.020136
Epoch 59
Loss = 7.7688e-02, PNorm = 35.1508, GNorm = 1.1091, lr_0 = 1.0000e-04
Validation rmse = 0.140394
Validation r2 = 0.852086
Validation mse = 0.019711
Model 0 best validation rmse = 0.136511 on epoch 50
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.167278
Model 0 test r2 = 0.598308
Model 0 test mse = 0.027982
Ensemble test rmse = 0.167278
Ensemble test r2 = 0.598308
Ensemble test mse = 0.027982
Fold 3
Splitting data with seed 3
Total size = 705 | train size = 564 | val size = 141 | test size = 317
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.0333e-01, PNorm = 34.0189, GNorm = 4.7381, lr_0 = 5.5000e-04
Validation rmse = 0.341752
Validation r2 = 0.068754
Validation mse = 0.116794
Epoch 1
Loss = 6.7384e-01, PNorm = 34.0649, GNorm = 2.1257, lr_0 = 1.0000e-03
Validation rmse = 0.270207
Validation r2 = 0.417851
Validation mse = 0.073012
Epoch 2
Loss = 4.6577e-01, PNorm = 34.1433, GNorm = 1.0766, lr_0 = 9.6108e-04
Validation rmse = 0.239022
Validation r2 = 0.544467
Validation mse = 0.057132
Epoch 3
Loss = 4.6860e-01, PNorm = 34.2098, GNorm = 5.4972, lr_0 = 9.2367e-04
Validation rmse = 0.252528
Validation r2 = 0.491534
Validation mse = 0.063770
Epoch 4
Loss = 4.3320e-01, PNorm = 34.2576, GNorm = 5.3978, lr_0 = 8.9093e-04
Validation rmse = 0.200933
Validation r2 = 0.678082
Validation mse = 0.040374
Epoch 5
Loss = 3.6130e-01, PNorm = 34.3122, GNorm = 4.1954, lr_0 = 8.5625e-04
Validation rmse = 0.184937
Validation r2 = 0.727296
Validation mse = 0.034202
Epoch 6
Loss = 3.0863e-01, PNorm = 34.3650, GNorm = 4.4163, lr_0 = 8.2293e-04
Validation rmse = 0.185687
Validation r2 = 0.725081
Validation mse = 0.034480
Epoch 7
Loss = 3.1029e-01, PNorm = 34.4141, GNorm = 0.4995, lr_0 = 7.9090e-04
Loss = 2.3703e-01, PNorm = 34.4622, GNorm = 1.9879, lr_0 = 7.6286e-04
Validation rmse = 0.175061
Validation r2 = 0.755644
Validation mse = 0.030646
Epoch 8
Loss = 2.2029e-01, PNorm = 34.5055, GNorm = 2.2663, lr_0 = 7.3582e-04
Validation rmse = 0.164926
Validation r2 = 0.783120
Validation mse = 0.027201
Epoch 9
Loss = 2.2579e-01, PNorm = 34.5542, GNorm = 6.1970, lr_0 = 7.0718e-04
Validation rmse = 0.159093
Validation r2 = 0.798190
Validation mse = 0.025310
Epoch 10
Loss = 2.0749e-01, PNorm = 34.5903, GNorm = 5.1832, lr_0 = 6.7965e-04
Validation rmse = 0.147720
Validation r2 = 0.826010
Validation mse = 0.021821
Epoch 11
Loss = 1.8252e-01, PNorm = 34.6293, GNorm = 2.6371, lr_0 = 6.5556e-04
Validation rmse = 0.142002
Validation r2 = 0.839221
Validation mse = 0.020164
Epoch 12
Loss = 1.5622e-01, PNorm = 34.6648, GNorm = 0.8313, lr_0 = 6.3005e-04
Validation rmse = 0.139283
Validation r2 = 0.845318
Validation mse = 0.019400
Epoch 13
Loss = 1.6568e-01, PNorm = 34.6978, GNorm = 1.8024, lr_0 = 6.0552e-04
Validation rmse = 0.146476
Validation r2 = 0.828929
Validation mse = 0.021455
Epoch 14
Loss = 1.8499e-01, PNorm = 34.7306, GNorm = 0.8028, lr_0 = 5.8196e-04
Validation rmse = 0.137217
Validation r2 = 0.849873
Validation mse = 0.018829
Epoch 15
Loss = 1.5858e-01, PNorm = 34.7558, GNorm = 2.7443, lr_0 = 5.6133e-04
Loss = 1.4416e-01, PNorm = 34.7810, GNorm = 1.9345, lr_0 = 5.4143e-04
Loss = 5.4961e-02, PNorm = 34.7835, GNorm = 1.9185, lr_0 = 5.3948e-04
Validation rmse = 0.136861
Validation r2 = 0.850652
Validation mse = 0.018731
Epoch 16
Loss = 1.4365e-01, PNorm = 34.8050, GNorm = 2.5087, lr_0 = 5.2036e-04
Validation rmse = 0.138352
Validation r2 = 0.847379
Validation mse = 0.019141
Epoch 17
Loss = 1.3603e-01, PNorm = 34.8237, GNorm = 1.4285, lr_0 = 5.0010e-04
Validation rmse = 0.134956
Validation r2 = 0.854781
Validation mse = 0.018213
Epoch 18
Loss = 1.4790e-01, PNorm = 34.8455, GNorm = 1.6940, lr_0 = 4.8238e-04
Validation rmse = 0.128889
Validation r2 = 0.867544
Validation mse = 0.016612
Epoch 19
Loss = 1.3672e-01, PNorm = 34.8656, GNorm = 2.5871, lr_0 = 4.6360e-04
Validation rmse = 0.126671
Validation r2 = 0.872062
Validation mse = 0.016046
Epoch 20
Loss = 1.1485e-01, PNorm = 34.8831, GNorm = 1.7583, lr_0 = 4.4556e-04
Validation rmse = 0.124352
Validation r2 = 0.876705
Validation mse = 0.015463
Epoch 21
Loss = 1.3172e-01, PNorm = 34.8988, GNorm = 2.2122, lr_0 = 4.2821e-04
Validation rmse = 0.122243
Validation r2 = 0.880852
Validation mse = 0.014943
Epoch 22
Loss = 1.0840e-01, PNorm = 34.9141, GNorm = 0.6281, lr_0 = 4.1304e-04
Validation rmse = 0.122134
Validation r2 = 0.881063
Validation mse = 0.014917
Epoch 23
Loss = 1.2673e-01, PNorm = 34.9294, GNorm = 1.1475, lr_0 = 3.9696e-04
Loss = 1.1389e-01, PNorm = 34.9446, GNorm = 3.7018, lr_0 = 3.8289e-04
Loss = 8.3344e-02, PNorm = 34.9462, GNorm = 1.0467, lr_0 = 3.8151e-04
Validation rmse = 0.123981
Validation r2 = 0.877440
Validation mse = 0.015371
Epoch 24
Loss = 1.1083e-01, PNorm = 34.9578, GNorm = 0.8388, lr_0 = 3.6799e-04
Validation rmse = 0.122285
Validation r2 = 0.880770
Validation mse = 0.014954
Epoch 25
Loss = 1.2828e-01, PNorm = 34.9726, GNorm = 2.9305, lr_0 = 3.5494e-04
Validation rmse = 0.126230
Validation r2 = 0.872952
Validation mse = 0.015934
Epoch 26
Loss = 1.1119e-01, PNorm = 34.9893, GNorm = 2.6159, lr_0 = 3.4113e-04
Validation rmse = 0.123527
Validation r2 = 0.878335
Validation mse = 0.015259
Epoch 27
Loss = 1.1089e-01, PNorm = 35.0030, GNorm = 1.1791, lr_0 = 3.2785e-04
Validation rmse = 0.124013
Validation r2 = 0.877375
Validation mse = 0.015379
Epoch 28
Loss = 1.1749e-01, PNorm = 35.0145, GNorm = 1.6268, lr_0 = 3.1509e-04
Validation rmse = 0.123877
Validation r2 = 0.877644
Validation mse = 0.015346
Epoch 29
Loss = 1.1906e-01, PNorm = 35.0221, GNorm = 0.9672, lr_0 = 3.0392e-04
Validation rmse = 0.119580
Validation r2 = 0.885986
Validation mse = 0.014299
Epoch 30
Loss = 8.8727e-02, PNorm = 35.0325, GNorm = 1.3492, lr_0 = 2.9209e-04
Validation rmse = 0.119063
Validation r2 = 0.886970
Validation mse = 0.014176
Epoch 31
Loss = 9.1958e-02, PNorm = 35.0433, GNorm = 1.2036, lr_0 = 2.8072e-04
Loss = 1.0265e-01, PNorm = 35.0525, GNorm = 0.4988, lr_0 = 2.7077e-04
Loss = 9.0676e-02, PNorm = 35.0536, GNorm = 1.2611, lr_0 = 2.6980e-04
Validation rmse = 0.122718
Validation r2 = 0.879923
Validation mse = 0.015060
Epoch 32
Loss = 1.0537e-01, PNorm = 35.0630, GNorm = 3.6624, lr_0 = 2.6023e-04
Validation rmse = 0.117970
Validation r2 = 0.889035
Validation mse = 0.013917
Epoch 33
Loss = 1.0922e-01, PNorm = 35.0708, GNorm = 2.4439, lr_0 = 2.5101e-04
Validation rmse = 0.119491
Validation r2 = 0.886155
Validation mse = 0.014278
Epoch 34
Loss = 8.8038e-02, PNorm = 35.0790, GNorm = 2.0125, lr_0 = 2.4124e-04
Validation rmse = 0.132292
Validation r2 = 0.860457
Validation mse = 0.017501
Epoch 35
Loss = 9.8868e-02, PNorm = 35.0870, GNorm = 1.4775, lr_0 = 2.3185e-04
Validation rmse = 0.119497
Validation r2 = 0.886144
Validation mse = 0.014279
Epoch 36
Loss = 8.3775e-02, PNorm = 35.0950, GNorm = 0.6038, lr_0 = 2.2363e-04
Validation rmse = 0.118846
Validation r2 = 0.887381
Validation mse = 0.014124
Epoch 37
Loss = 7.8444e-02, PNorm = 35.1040, GNorm = 0.9743, lr_0 = 2.1493e-04
Validation rmse = 0.120200
Validation r2 = 0.884800
Validation mse = 0.014448
Epoch 38
Loss = 7.4632e-02, PNorm = 35.1111, GNorm = 0.9718, lr_0 = 2.0656e-04
Validation rmse = 0.119510
Validation r2 = 0.886119
Validation mse = 0.014283
Epoch 39
Loss = 9.3116e-02, PNorm = 35.1187, GNorm = 0.8749, lr_0 = 1.9852e-04
Loss = 9.6507e-02, PNorm = 35.1238, GNorm = 0.9411, lr_0 = 1.9148e-04
Validation rmse = 0.117998
Validation r2 = 0.888982
Validation mse = 0.013924
Epoch 40
Loss = 9.1863e-02, PNorm = 35.1297, GNorm = 0.5736, lr_0 = 1.8470e-04
Validation rmse = 0.119729
Validation r2 = 0.885702
Validation mse = 0.014335
Epoch 41
Loss = 9.8353e-02, PNorm = 35.1360, GNorm = 1.3086, lr_0 = 1.7751e-04
Validation rmse = 0.127746
Validation r2 = 0.869883
Validation mse = 0.016319
Epoch 42
Loss = 9.0520e-02, PNorm = 35.1417, GNorm = 2.5337, lr_0 = 1.7060e-04
Validation rmse = 0.123951
Validation r2 = 0.877498
Validation mse = 0.015364
Epoch 43
Loss = 1.0304e-01, PNorm = 35.1464, GNorm = 0.9344, lr_0 = 1.6455e-04
Validation rmse = 0.119589
Validation r2 = 0.885968
Validation mse = 0.014302
Epoch 44
Loss = 8.9769e-02, PNorm = 35.1518, GNorm = 1.0073, lr_0 = 1.5815e-04
Validation rmse = 0.119432
Validation r2 = 0.886267
Validation mse = 0.014264
Epoch 45
Loss = 9.0156e-02, PNorm = 35.1571, GNorm = 0.8337, lr_0 = 1.5199e-04
Validation rmse = 0.117082
Validation r2 = 0.890700
Validation mse = 0.013708
Epoch 46
Loss = 1.2283e-01, PNorm = 35.1631, GNorm = 2.8010, lr_0 = 1.4608e-04
Loss = 8.3746e-02, PNorm = 35.1679, GNorm = 1.7161, lr_0 = 1.4090e-04
Validation rmse = 0.119505
Validation r2 = 0.886128
Validation mse = 0.014282
Epoch 47
Loss = 9.3004e-02, PNorm = 35.1724, GNorm = 0.8502, lr_0 = 1.3590e-04
Validation rmse = 0.121393
Validation r2 = 0.882503
Validation mse = 0.014736
Epoch 48
Loss = 8.9094e-02, PNorm = 35.1763, GNorm = 3.2162, lr_0 = 1.3061e-04
Validation rmse = 0.117589
Validation r2 = 0.889752
Validation mse = 0.013827
Epoch 49
Loss = 8.6116e-02, PNorm = 35.1801, GNorm = 1.2043, lr_0 = 1.2553e-04
Validation rmse = 0.118304
Validation r2 = 0.888406
Validation mse = 0.013996
Epoch 50
Loss = 8.4645e-02, PNorm = 35.1847, GNorm = 1.2542, lr_0 = 1.2108e-04
Validation rmse = 0.119004
Validation r2 = 0.887082
Validation mse = 0.014162
Epoch 51
Loss = 8.6252e-02, PNorm = 35.1890, GNorm = 1.1790, lr_0 = 1.1637e-04
Validation rmse = 0.120662
Validation r2 = 0.883912
Validation mse = 0.014559
Epoch 52
Loss = 8.0023e-02, PNorm = 35.1937, GNorm = 1.5232, lr_0 = 1.1184e-04
Validation rmse = 0.120049
Validation r2 = 0.885090
Validation mse = 0.014412
Epoch 53
Loss = 9.1289e-02, PNorm = 35.1975, GNorm = 2.1832, lr_0 = 1.0749e-04
Validation rmse = 0.119623
Validation r2 = 0.885903
Validation mse = 0.014310
Epoch 54
Loss = 1.2006e-01, PNorm = 35.2010, GNorm = 1.9548, lr_0 = 1.0367e-04
Loss = 8.7090e-02, PNorm = 35.2041, GNorm = 1.6701, lr_0 = 1.0000e-04
Loss = 7.8178e-02, PNorm = 35.2042, GNorm = 1.5941, lr_0 = 1.0000e-04
Validation rmse = 0.116888
Validation r2 = 0.891061
Validation mse = 0.013663
Epoch 55
Loss = 8.4965e-02, PNorm = 35.2084, GNorm = 0.5358, lr_0 = 1.0000e-04
Validation rmse = 0.122590
Validation r2 = 0.880173
Validation mse = 0.015028
Epoch 56
Loss = 9.2697e-02, PNorm = 35.2117, GNorm = 0.6012, lr_0 = 1.0000e-04
Validation rmse = 0.119194
Validation r2 = 0.886721
Validation mse = 0.014207
Epoch 57
Loss = 8.7380e-02, PNorm = 35.2154, GNorm = 1.8102, lr_0 = 1.0000e-04
Validation rmse = 0.117479
Validation r2 = 0.889957
Validation mse = 0.013801
Epoch 58
Loss = 9.3319e-02, PNorm = 35.2192, GNorm = 1.2273, lr_0 = 1.0000e-04
Validation rmse = 0.117368
Validation r2 = 0.890165
Validation mse = 0.013775
Epoch 59
Loss = 8.5858e-02, PNorm = 35.2227, GNorm = 0.6267, lr_0 = 1.0000e-04
Validation rmse = 0.118462
Validation r2 = 0.888107
Validation mse = 0.014033
Model 0 best validation rmse = 0.116888 on epoch 54
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.173278
Model 0 test r2 = 0.568973
Model 0 test mse = 0.030025
Ensemble test rmse = 0.173278
Ensemble test r2 = 0.568973
Ensemble test mse = 0.030025
Fold 4
Splitting data with seed 4
Total size = 705 | train size = 564 | val size = 141 | test size = 317
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.8398e-01, PNorm = 34.0211, GNorm = 5.7992, lr_0 = 5.5000e-04
Validation rmse = 0.316397
Validation r2 = 0.301127
Validation mse = 0.100107
Epoch 1
Loss = 6.2426e-01, PNorm = 34.0785, GNorm = 7.8609, lr_0 = 1.0000e-03
Validation rmse = 0.365777
Validation r2 = 0.065959
Validation mse = 0.133793
Epoch 2
Loss = 5.8133e-01, PNorm = 34.1335, GNorm = 5.7210, lr_0 = 9.6108e-04
Validation rmse = 0.305240
Validation r2 = 0.349549
Validation mse = 0.093171
Epoch 3
Loss = 5.4001e-01, PNorm = 34.1896, GNorm = 6.7909, lr_0 = 9.2367e-04
Validation rmse = 0.254290
Validation r2 = 0.548570
Validation mse = 0.064663
Epoch 4
Loss = 4.0732e-01, PNorm = 34.2382, GNorm = 2.6887, lr_0 = 8.9093e-04
Validation rmse = 0.239503
Validation r2 = 0.599545
Validation mse = 0.057362
Epoch 5
Loss = 3.3161e-01, PNorm = 34.2896, GNorm = 1.4472, lr_0 = 8.5625e-04
Validation rmse = 0.237777
Validation r2 = 0.605296
Validation mse = 0.056538
Epoch 6
Loss = 3.1413e-01, PNorm = 34.3365, GNorm = 1.5187, lr_0 = 8.2293e-04
Validation rmse = 0.211292
Validation r2 = 0.688328
Validation mse = 0.044644
Epoch 7
Loss = 3.0227e-01, PNorm = 34.3866, GNorm = 1.6716, lr_0 = 7.9090e-04
Loss = 2.8420e-01, PNorm = 34.4302, GNorm = 6.4822, lr_0 = 7.6286e-04
Validation rmse = 0.200334
Validation r2 = 0.719818
Validation mse = 0.040134
Epoch 8
Loss = 2.1244e-01, PNorm = 34.4686, GNorm = 3.5128, lr_0 = 7.3582e-04
Validation rmse = 0.188787
Validation r2 = 0.751185
Validation mse = 0.035640
Epoch 9
Loss = 2.0643e-01, PNorm = 34.5146, GNorm = 1.9444, lr_0 = 7.0718e-04
Validation rmse = 0.185908
Validation r2 = 0.758716
Validation mse = 0.034562
Epoch 10
Loss = 1.8931e-01, PNorm = 34.5563, GNorm = 2.4081, lr_0 = 6.7965e-04
Validation rmse = 0.167455
Validation r2 = 0.804237
Validation mse = 0.028041
Epoch 11
Loss = 1.7212e-01, PNorm = 34.5934, GNorm = 5.6475, lr_0 = 6.5556e-04
Validation rmse = 0.173560
Validation r2 = 0.789702
Validation mse = 0.030123
Epoch 12
Loss = 1.9052e-01, PNorm = 34.6283, GNorm = 4.4078, lr_0 = 6.3005e-04
Validation rmse = 0.168608
Validation r2 = 0.801532
Validation mse = 0.028429
Epoch 13
Loss = 1.6902e-01, PNorm = 34.6648, GNorm = 2.5983, lr_0 = 6.0552e-04
Validation rmse = 0.156313
Validation r2 = 0.829422
Validation mse = 0.024434
Epoch 14
Loss = 1.2450e-01, PNorm = 34.6936, GNorm = 0.4292, lr_0 = 5.8196e-04
Validation rmse = 0.156670
Validation r2 = 0.828643
Validation mse = 0.024545
Epoch 15
Loss = 9.8876e-02, PNorm = 34.7197, GNorm = 1.5962, lr_0 = 5.6133e-04
Loss = 1.3737e-01, PNorm = 34.7448, GNorm = 2.9788, lr_0 = 5.4143e-04
Loss = 2.1535e-01, PNorm = 34.7477, GNorm = 3.4448, lr_0 = 5.3948e-04
Validation rmse = 0.151268
Validation r2 = 0.840256
Validation mse = 0.022882
Epoch 16
Loss = 1.6491e-01, PNorm = 34.7655, GNorm = 6.8994, lr_0 = 5.2036e-04
Validation rmse = 0.149871
Validation r2 = 0.843191
Validation mse = 0.022461
Epoch 17
Loss = 1.3877e-01, PNorm = 34.7880, GNorm = 0.6364, lr_0 = 5.0010e-04
Validation rmse = 0.148992
Validation r2 = 0.845026
Validation mse = 0.022199
Epoch 18
Loss = 1.3665e-01, PNorm = 34.8025, GNorm = 4.9799, lr_0 = 4.8238e-04
Validation rmse = 0.154024
Validation r2 = 0.834382
Validation mse = 0.023723
Epoch 19
Loss = 1.2274e-01, PNorm = 34.8238, GNorm = 1.6583, lr_0 = 4.6360e-04
Validation rmse = 0.150366
Validation r2 = 0.842155
Validation mse = 0.022610
Epoch 20
Loss = 1.5739e-01, PNorm = 34.8403, GNorm = 2.7675, lr_0 = 4.4556e-04
Validation rmse = 0.149233
Validation r2 = 0.844524
Validation mse = 0.022270
Epoch 21
Loss = 1.4507e-01, PNorm = 34.8601, GNorm = 5.1867, lr_0 = 4.2821e-04
Validation rmse = 0.184843
Validation r2 = 0.761472
Validation mse = 0.034167
Epoch 22
Loss = 1.3762e-01, PNorm = 34.8783, GNorm = 1.5287, lr_0 = 4.1304e-04
Validation rmse = 0.148914
Validation r2 = 0.845188
Validation mse = 0.022175
Epoch 23
Loss = 1.2570e-01, PNorm = 34.8967, GNorm = 0.7317, lr_0 = 3.9696e-04
Loss = 1.3858e-01, PNorm = 34.9121, GNorm = 2.2915, lr_0 = 3.8289e-04
Loss = 1.0559e-01, PNorm = 34.9133, GNorm = 3.3965, lr_0 = 3.8151e-04
Validation rmse = 0.149193
Validation r2 = 0.844608
Validation mse = 0.022259
Epoch 24
Loss = 1.1860e-01, PNorm = 34.9260, GNorm = 0.7500, lr_0 = 3.6799e-04
Validation rmse = 0.145775
Validation r2 = 0.851646
Validation mse = 0.021250
Epoch 25
Loss = 1.0942e-01, PNorm = 34.9358, GNorm = 1.7027, lr_0 = 3.5494e-04
Validation rmse = 0.143452
Validation r2 = 0.856336
Validation mse = 0.020579
Epoch 26
Loss = 1.0916e-01, PNorm = 34.9507, GNorm = 1.0990, lr_0 = 3.4113e-04
Validation rmse = 0.147812
Validation r2 = 0.847472
Validation mse = 0.021848
Epoch 27
Loss = 1.1280e-01, PNorm = 34.9623, GNorm = 0.6020, lr_0 = 3.2785e-04
Validation rmse = 0.147990
Validation r2 = 0.847103
Validation mse = 0.021901
Epoch 28
Loss = 1.0221e-01, PNorm = 34.9722, GNorm = 0.7027, lr_0 = 3.1509e-04
Validation rmse = 0.147339
Validation r2 = 0.848445
Validation mse = 0.021709
Epoch 29
Loss = 9.5356e-02, PNorm = 34.9825, GNorm = 0.6334, lr_0 = 3.0392e-04
Validation rmse = 0.159551
Validation r2 = 0.822283
Validation mse = 0.025456
Epoch 30
Loss = 1.2247e-01, PNorm = 34.9942, GNorm = 3.9629, lr_0 = 2.9209e-04
Validation rmse = 0.150152
Validation r2 = 0.842604
Validation mse = 0.022546
Epoch 31
Loss = 6.9788e-02, PNorm = 35.0052, GNorm = 0.9926, lr_0 = 2.8072e-04
Loss = 1.0636e-01, PNorm = 35.0137, GNorm = 0.9254, lr_0 = 2.7077e-04
Loss = 1.0757e-01, PNorm = 35.0139, GNorm = 2.5219, lr_0 = 2.6980e-04
Validation rmse = 0.147424
Validation r2 = 0.848271
Validation mse = 0.021734
Epoch 32
Loss = 1.0130e-01, PNorm = 35.0215, GNorm = 1.0644, lr_0 = 2.6023e-04
Validation rmse = 0.144026
Validation r2 = 0.855185
Validation mse = 0.020743
Epoch 33
Loss = 9.1274e-02, PNorm = 35.0280, GNorm = 0.7454, lr_0 = 2.5101e-04
Validation rmse = 0.147890
Validation r2 = 0.847310
Validation mse = 0.021871
Epoch 34
Loss = 9.9340e-02, PNorm = 35.0389, GNorm = 1.2610, lr_0 = 2.4124e-04
Validation rmse = 0.143010
Validation r2 = 0.857220
Validation mse = 0.020452
Epoch 35
Loss = 1.0190e-01, PNorm = 35.0484, GNorm = 1.0327, lr_0 = 2.3185e-04
Validation rmse = 0.146606
Validation r2 = 0.849949
Validation mse = 0.021493
Epoch 36
Loss = 9.2546e-02, PNorm = 35.0551, GNorm = 1.0730, lr_0 = 2.2363e-04
Validation rmse = 0.143119
Validation r2 = 0.857003
Validation mse = 0.020483
Epoch 37
Loss = 7.2318e-02, PNorm = 35.0635, GNorm = 0.4783, lr_0 = 2.1493e-04
Validation rmse = 0.143272
Validation r2 = 0.856698
Validation mse = 0.020527
Epoch 38
Loss = 8.4994e-02, PNorm = 35.0714, GNorm = 2.2351, lr_0 = 2.0656e-04
Validation rmse = 0.146658
Validation r2 = 0.849844
Validation mse = 0.021509
Epoch 39
Loss = 7.2885e-02, PNorm = 35.0789, GNorm = 2.5039, lr_0 = 1.9852e-04
Loss = 9.5992e-02, PNorm = 35.0844, GNorm = 0.9367, lr_0 = 1.9148e-04
Validation rmse = 0.144610
Validation r2 = 0.854007
Validation mse = 0.020912
Epoch 40
Loss = 9.2577e-02, PNorm = 35.0902, GNorm = 1.2508, lr_0 = 1.8470e-04
Validation rmse = 0.144403
Validation r2 = 0.854426
Validation mse = 0.020852
Epoch 41
Loss = 9.8427e-02, PNorm = 35.0987, GNorm = 0.7122, lr_0 = 1.7751e-04
Validation rmse = 0.144941
Validation r2 = 0.853338
Validation mse = 0.021008
Epoch 42
Loss = 9.1114e-02, PNorm = 35.1046, GNorm = 1.5568, lr_0 = 1.7060e-04
Validation rmse = 0.149026
Validation r2 = 0.844956
Validation mse = 0.022209
Epoch 43
Loss = 9.9639e-02, PNorm = 35.1099, GNorm = 0.6912, lr_0 = 1.6455e-04
Validation rmse = 0.151017
Validation r2 = 0.840786
Validation mse = 0.022806
Epoch 44
Loss = 8.1976e-02, PNorm = 35.1159, GNorm = 1.0215, lr_0 = 1.5815e-04
Validation rmse = 0.157106
Validation r2 = 0.827686
Validation mse = 0.024682
Epoch 45
Loss = 1.0175e-01, PNorm = 35.1225, GNorm = 2.8818, lr_0 = 1.5199e-04
Validation rmse = 0.149338
Validation r2 = 0.844304
Validation mse = 0.022302
Epoch 46
Loss = 7.4066e-02, PNorm = 35.1286, GNorm = 0.4726, lr_0 = 1.4608e-04
Loss = 8.5617e-02, PNorm = 35.1333, GNorm = 2.2538, lr_0 = 1.4090e-04
Validation rmse = 0.143139
Validation r2 = 0.856963
Validation mse = 0.020489
Epoch 47
Loss = 8.5067e-02, PNorm = 35.1372, GNorm = 0.6236, lr_0 = 1.3590e-04
Validation rmse = 0.142647
Validation r2 = 0.857944
Validation mse = 0.020348
Epoch 48
Loss = 8.4247e-02, PNorm = 35.1425, GNorm = 0.9499, lr_0 = 1.3061e-04
Validation rmse = 0.142409
Validation r2 = 0.858417
Validation mse = 0.020280
Epoch 49
Loss = 8.5777e-02, PNorm = 35.1469, GNorm = 1.3030, lr_0 = 1.2553e-04
Validation rmse = 0.143943
Validation r2 = 0.855351
Validation mse = 0.020720
Epoch 50
Loss = 9.4178e-02, PNorm = 35.1513, GNorm = 1.2802, lr_0 = 1.2108e-04
Validation rmse = 0.144157
Validation r2 = 0.854921
Validation mse = 0.020781
Epoch 51
Loss = 8.3590e-02, PNorm = 35.1545, GNorm = 3.7917, lr_0 = 1.1637e-04
Validation rmse = 0.143175
Validation r2 = 0.856891
Validation mse = 0.020499
Epoch 52
Loss = 7.2310e-02, PNorm = 35.1590, GNorm = 0.5306, lr_0 = 1.1184e-04
Validation rmse = 0.144634
Validation r2 = 0.853960
Validation mse = 0.020919
Epoch 53
Loss = 8.4108e-02, PNorm = 35.1637, GNorm = 1.8248, lr_0 = 1.0749e-04
Validation rmse = 0.143289
Validation r2 = 0.856662
Validation mse = 0.020532
Epoch 54
Loss = 8.4159e-02, PNorm = 35.1681, GNorm = 2.2451, lr_0 = 1.0367e-04
Loss = 8.4219e-02, PNorm = 35.1712, GNorm = 1.3252, lr_0 = 1.0000e-04
Loss = 3.4514e-02, PNorm = 35.1715, GNorm = 1.1379, lr_0 = 1.0000e-04
Validation rmse = 0.145223
Validation r2 = 0.852767
Validation mse = 0.021090
Epoch 55
Loss = 8.2028e-02, PNorm = 35.1745, GNorm = 0.8535, lr_0 = 1.0000e-04
Validation rmse = 0.153612
Validation r2 = 0.835267
Validation mse = 0.023597
Epoch 56
Loss = 8.2394e-02, PNorm = 35.1795, GNorm = 1.5168, lr_0 = 1.0000e-04
Validation rmse = 0.146176
Validation r2 = 0.850829
Validation mse = 0.021367
Epoch 57
Loss = 7.9667e-02, PNorm = 35.1829, GNorm = 0.5289, lr_0 = 1.0000e-04
Validation rmse = 0.143853
Validation r2 = 0.855532
Validation mse = 0.020694
Epoch 58
Loss = 7.6439e-02, PNorm = 35.1853, GNorm = 0.6877, lr_0 = 1.0000e-04
Validation rmse = 0.143059
Validation r2 = 0.857124
Validation mse = 0.020466
Epoch 59
Loss = 7.4948e-02, PNorm = 35.1898, GNorm = 1.7017, lr_0 = 1.0000e-04
Validation rmse = 0.145957
Validation r2 = 0.851276
Validation mse = 0.021303
Model 0 best validation rmse = 0.142409 on epoch 48
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.160369
Model 0 test r2 = 0.630806
Model 0 test mse = 0.025718
Ensemble test rmse = 0.160369
Ensemble test r2 = 0.630806
Ensemble test mse = 0.025718
Fold 5
Splitting data with seed 5
Total size = 705 | train size = 564 | val size = 141 | test size = 317
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1630e-01, PNorm = 34.0193, GNorm = 5.2594, lr_0 = 5.5000e-04
Validation rmse = 0.374812
Validation r2 = -0.083278
Validation mse = 0.140484
Epoch 1
Loss = 7.5846e-01, PNorm = 34.0614, GNorm = 2.1121, lr_0 = 1.0000e-03
Validation rmse = 0.315284
Validation r2 = 0.233493
Validation mse = 0.099404
Epoch 2
Loss = 5.9512e-01, PNorm = 34.1344, GNorm = 3.5123, lr_0 = 9.6108e-04
Validation rmse = 0.258280
Validation r2 = 0.485609
Validation mse = 0.066708
Epoch 3
Loss = 3.9806e-01, PNorm = 34.2141, GNorm = 2.3841, lr_0 = 9.2367e-04
Validation rmse = 0.252014
Validation r2 = 0.510265
Validation mse = 0.063511
Epoch 4
Loss = 3.3255e-01, PNorm = 34.2837, GNorm = 4.5462, lr_0 = 8.9093e-04
Validation rmse = 0.231834
Validation r2 = 0.585556
Validation mse = 0.053747
Epoch 5
Loss = 2.9643e-01, PNorm = 34.3438, GNorm = 7.3804, lr_0 = 8.5625e-04
Validation rmse = 0.227201
Validation r2 = 0.601954
Validation mse = 0.051620
Epoch 6
Loss = 2.4962e-01, PNorm = 34.4002, GNorm = 5.5743, lr_0 = 8.2293e-04
Validation rmse = 0.213783
Validation r2 = 0.647580
Validation mse = 0.045703
Epoch 7
Loss = 2.0447e-01, PNorm = 34.4455, GNorm = 0.9835, lr_0 = 7.9090e-04
Loss = 2.1910e-01, PNorm = 34.4887, GNorm = 2.1965, lr_0 = 7.6286e-04
Validation rmse = 0.216068
Validation r2 = 0.640006
Validation mse = 0.046686
Epoch 8
Loss = 2.1819e-01, PNorm = 34.5283, GNorm = 2.9187, lr_0 = 7.3582e-04
Validation rmse = 0.209384
Validation r2 = 0.661935
Validation mse = 0.043842
Epoch 9
Loss = 2.1552e-01, PNorm = 34.5771, GNorm = 1.5345, lr_0 = 7.0718e-04
Validation rmse = 0.190444
Validation r2 = 0.720328
Validation mse = 0.036269
Epoch 10
Loss = 1.8941e-01, PNorm = 34.6155, GNorm = 1.1352, lr_0 = 6.7965e-04
Validation rmse = 0.188328
Validation r2 = 0.726510
Validation mse = 0.035467
Epoch 11
Loss = 1.5707e-01, PNorm = 34.6505, GNorm = 1.1376, lr_0 = 6.5556e-04
Validation rmse = 0.177745
Validation r2 = 0.756384
Validation mse = 0.031593
Epoch 12
Loss = 1.4118e-01, PNorm = 34.6878, GNorm = 0.7653, lr_0 = 6.3005e-04
Validation rmse = 0.177830
Validation r2 = 0.756151
Validation mse = 0.031623
Epoch 13
Loss = 1.5089e-01, PNorm = 34.7132, GNorm = 5.8944, lr_0 = 6.0552e-04
Validation rmse = 0.180468
Validation r2 = 0.748862
Validation mse = 0.032569
Epoch 14
Loss = 1.4285e-01, PNorm = 34.7366, GNorm = 4.6914, lr_0 = 5.8196e-04
Validation rmse = 0.173930
Validation r2 = 0.766729
Validation mse = 0.030252
Epoch 15
Loss = 9.5971e-02, PNorm = 34.7649, GNorm = 2.0466, lr_0 = 5.6133e-04
Loss = 1.2240e-01, PNorm = 34.7890, GNorm = 0.9926, lr_0 = 5.4143e-04
Loss = 1.9297e-01, PNorm = 34.7910, GNorm = 1.4556, lr_0 = 5.3948e-04
Validation rmse = 0.167622
Validation r2 = 0.783342
Validation mse = 0.028097
Epoch 16
Loss = 1.1364e-01, PNorm = 34.8128, GNorm = 1.0470, lr_0 = 5.2036e-04
Validation rmse = 0.165695
Validation r2 = 0.788296
Validation mse = 0.027455
Epoch 17
Loss = 1.1411e-01, PNorm = 34.8328, GNorm = 1.5391, lr_0 = 5.0010e-04
Validation rmse = 0.181392
Validation r2 = 0.746285
Validation mse = 0.032903
Epoch 18
Loss = 1.1538e-01, PNorm = 34.8492, GNorm = 0.8715, lr_0 = 4.8238e-04
Validation rmse = 0.167813
Validation r2 = 0.782849
Validation mse = 0.028161
Epoch 19
Loss = 1.3667e-01, PNorm = 34.8707, GNorm = 3.9325, lr_0 = 4.6360e-04
Validation rmse = 0.166813
Validation r2 = 0.785427
Validation mse = 0.027827
Epoch 20
Loss = 1.2117e-01, PNorm = 34.8849, GNorm = 0.9776, lr_0 = 4.4556e-04
Validation rmse = 0.163920
Validation r2 = 0.792807
Validation mse = 0.026870
Epoch 21
Loss = 1.0255e-01, PNorm = 34.9030, GNorm = 2.0101, lr_0 = 4.2821e-04
Validation rmse = 0.172622
Validation r2 = 0.770224
Validation mse = 0.029798
Epoch 22
Loss = 1.0444e-01, PNorm = 34.9157, GNorm = 0.9589, lr_0 = 4.1304e-04
Validation rmse = 0.180069
Validation r2 = 0.749970
Validation mse = 0.032425
Epoch 23
Loss = 1.9371e-01, PNorm = 34.9296, GNorm = 6.0845, lr_0 = 3.9696e-04
Loss = 1.3714e-01, PNorm = 34.9446, GNorm = 4.2895, lr_0 = 3.8289e-04
Loss = 1.9560e-01, PNorm = 34.9470, GNorm = 2.1310, lr_0 = 3.8151e-04
Validation rmse = 0.180947
Validation r2 = 0.747528
Validation mse = 0.032742
Epoch 24
Loss = 1.2634e-01, PNorm = 34.9611, GNorm = 0.7931, lr_0 = 3.6799e-04
Validation rmse = 0.176318
Validation r2 = 0.760278
Validation mse = 0.031088
Epoch 25
Loss = 1.1163e-01, PNorm = 34.9760, GNorm = 1.7192, lr_0 = 3.5494e-04
Validation rmse = 0.159334
Validation r2 = 0.804237
Validation mse = 0.025387
Epoch 26
Loss = 9.0313e-02, PNorm = 34.9880, GNorm = 0.9456, lr_0 = 3.4113e-04
Validation rmse = 0.163103
Validation r2 = 0.794866
Validation mse = 0.026603
Epoch 27
Loss = 8.2246e-02, PNorm = 35.0000, GNorm = 2.0692, lr_0 = 3.2785e-04
Validation rmse = 0.168796
Validation r2 = 0.780297
Validation mse = 0.028492
Epoch 28
Loss = 1.1006e-01, PNorm = 35.0127, GNorm = 1.1185, lr_0 = 3.1509e-04
Validation rmse = 0.164415
Validation r2 = 0.791554
Validation mse = 0.027032
Epoch 29
Loss = 1.2221e-01, PNorm = 35.0215, GNorm = 2.2304, lr_0 = 3.0392e-04
Validation rmse = 0.162495
Validation r2 = 0.796393
Validation mse = 0.026405
Epoch 30
Loss = 6.6414e-02, PNorm = 35.0341, GNorm = 0.5627, lr_0 = 2.9209e-04
Validation rmse = 0.161985
Validation r2 = 0.797670
Validation mse = 0.026239
Epoch 31
Loss = 8.8586e-02, PNorm = 35.0423, GNorm = 0.6735, lr_0 = 2.8072e-04
Loss = 9.2397e-02, PNorm = 35.0530, GNorm = 1.1169, lr_0 = 2.7077e-04
Loss = 1.7342e-01, PNorm = 35.0537, GNorm = 4.2165, lr_0 = 2.6980e-04
Validation rmse = 0.159787
Validation r2 = 0.803122
Validation mse = 0.025532
Epoch 32
Loss = 8.4871e-02, PNorm = 35.0615, GNorm = 0.8756, lr_0 = 2.6023e-04
Validation rmse = 0.170555
Validation r2 = 0.775694
Validation mse = 0.029089
Epoch 33
Loss = 9.4824e-02, PNorm = 35.0684, GNorm = 0.7704, lr_0 = 2.5101e-04
Validation rmse = 0.158974
Validation r2 = 0.805121
Validation mse = 0.025273
Epoch 34
Loss = 8.1022e-02, PNorm = 35.0781, GNorm = 0.5209, lr_0 = 2.4124e-04
Validation rmse = 0.154675
Validation r2 = 0.815519
Validation mse = 0.023924
Epoch 35
Loss = 7.9788e-02, PNorm = 35.0876, GNorm = 1.1514, lr_0 = 2.3185e-04
Validation rmse = 0.157561
Validation r2 = 0.808571
Validation mse = 0.024825
Epoch 36
Loss = 9.7273e-02, PNorm = 35.0944, GNorm = 0.9128, lr_0 = 2.2363e-04
Validation rmse = 0.162545
Validation r2 = 0.796268
Validation mse = 0.026421
Epoch 37
Loss = 1.0467e-01, PNorm = 35.1019, GNorm = 1.8231, lr_0 = 2.1493e-04
Validation rmse = 0.160036
Validation r2 = 0.802509
Validation mse = 0.025612
Epoch 38
Loss = 9.6264e-02, PNorm = 35.1091, GNorm = 0.5980, lr_0 = 2.0656e-04
Validation rmse = 0.155533
Validation r2 = 0.813467
Validation mse = 0.024190
Epoch 39
Loss = 9.9466e-02, PNorm = 35.1159, GNorm = 0.9934, lr_0 = 1.9852e-04
Loss = 9.0584e-02, PNorm = 35.1215, GNorm = 1.0203, lr_0 = 1.9148e-04
Validation rmse = 0.156072
Validation r2 = 0.812171
Validation mse = 0.024358
Epoch 40
Loss = 8.8866e-02, PNorm = 35.1278, GNorm = 1.9122, lr_0 = 1.8470e-04
Validation rmse = 0.155645
Validation r2 = 0.813198
Validation mse = 0.024225
Epoch 41
Loss = 8.3703e-02, PNorm = 35.1334, GNorm = 0.8176, lr_0 = 1.7751e-04
Validation rmse = 0.155303
Validation r2 = 0.814018
Validation mse = 0.024119
Epoch 42
Loss = 9.1753e-02, PNorm = 35.1410, GNorm = 0.9748, lr_0 = 1.7060e-04
Validation rmse = 0.156749
Validation r2 = 0.810539
Validation mse = 0.024570
Epoch 43
Loss = 7.5408e-02, PNorm = 35.1460, GNorm = 1.3519, lr_0 = 1.6455e-04
Validation rmse = 0.156828
Validation r2 = 0.810346
Validation mse = 0.024595
Epoch 44
Loss = 8.9984e-02, PNorm = 35.1535, GNorm = 0.8623, lr_0 = 1.5815e-04
Validation rmse = 0.161045
Validation r2 = 0.800012
Validation mse = 0.025935
Epoch 45
Loss = 8.6013e-02, PNorm = 35.1592, GNorm = 2.0389, lr_0 = 1.5199e-04
Validation rmse = 0.154623
Validation r2 = 0.815643
Validation mse = 0.023908
Epoch 46
Loss = 7.9161e-02, PNorm = 35.1641, GNorm = 1.1419, lr_0 = 1.4608e-04
Loss = 7.6875e-02, PNorm = 35.1689, GNorm = 0.5993, lr_0 = 1.4090e-04
Validation rmse = 0.154174
Validation r2 = 0.816712
Validation mse = 0.023770
Epoch 47
Loss = 8.1373e-02, PNorm = 35.1728, GNorm = 0.8540, lr_0 = 1.3590e-04
Validation rmse = 0.153649
Validation r2 = 0.817958
Validation mse = 0.023608
Epoch 48
Loss = 8.2619e-02, PNorm = 35.1784, GNorm = 0.4760, lr_0 = 1.3061e-04
Validation rmse = 0.154501
Validation r2 = 0.815934
Validation mse = 0.023870
Epoch 49
Loss = 8.1443e-02, PNorm = 35.1831, GNorm = 2.3823, lr_0 = 1.2553e-04
Validation rmse = 0.153790
Validation r2 = 0.817624
Validation mse = 0.023651
Epoch 50
Loss = 7.8211e-02, PNorm = 35.1877, GNorm = 2.1627, lr_0 = 1.2108e-04
Validation rmse = 0.154821
Validation r2 = 0.815171
Validation mse = 0.023969
Epoch 51
Loss = 6.9623e-02, PNorm = 35.1914, GNorm = 1.3247, lr_0 = 1.1637e-04
Validation rmse = 0.154843
Validation r2 = 0.815118
Validation mse = 0.023976
Epoch 52
Loss = 7.1672e-02, PNorm = 35.1955, GNorm = 1.2415, lr_0 = 1.1184e-04
Validation rmse = 0.158899
Validation r2 = 0.805305
Validation mse = 0.025249
Epoch 53
Loss = 6.4900e-02, PNorm = 35.1995, GNorm = 0.6022, lr_0 = 1.0749e-04
Validation rmse = 0.160300
Validation r2 = 0.801856
Validation mse = 0.025696
Epoch 54
Loss = 8.7942e-02, PNorm = 35.2034, GNorm = 1.4827, lr_0 = 1.0367e-04
Loss = 7.2856e-02, PNorm = 35.2072, GNorm = 0.9721, lr_0 = 1.0000e-04
Loss = 1.5308e-01, PNorm = 35.2076, GNorm = 2.4866, lr_0 = 1.0000e-04
Validation rmse = 0.155436
Validation r2 = 0.813699
Validation mse = 0.024160
Epoch 55
Loss = 7.4232e-02, PNorm = 35.2113, GNorm = 0.7232, lr_0 = 1.0000e-04
Validation rmse = 0.154100
Validation r2 = 0.816888
Validation mse = 0.023747
Epoch 56
Loss = 7.4020e-02, PNorm = 35.2152, GNorm = 0.9193, lr_0 = 1.0000e-04
Validation rmse = 0.153859
Validation r2 = 0.817461
Validation mse = 0.023673
Epoch 57
Loss = 7.3879e-02, PNorm = 35.2185, GNorm = 1.3528, lr_0 = 1.0000e-04
Validation rmse = 0.152487
Validation r2 = 0.820702
Validation mse = 0.023252
Epoch 58
Loss = 7.2370e-02, PNorm = 35.2211, GNorm = 1.4169, lr_0 = 1.0000e-04
Validation rmse = 0.153587
Validation r2 = 0.818104
Validation mse = 0.023589
Epoch 59
Loss = 7.6422e-02, PNorm = 35.2255, GNorm = 0.5379, lr_0 = 1.0000e-04
Validation rmse = 0.156460
Validation r2 = 0.811235
Validation mse = 0.024480
Model 0 best validation rmse = 0.152487 on epoch 57
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.177941
Model 0 test r2 = 0.545464
Model 0 test mse = 0.031663
Ensemble test rmse = 0.177941
Ensemble test r2 = 0.545464
Ensemble test mse = 0.031663
Fold 6
Splitting data with seed 6
Total size = 705 | train size = 564 | val size = 141 | test size = 317
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.3451e-01, PNorm = 34.0173, GNorm = 1.7928, lr_0 = 5.5000e-04
Validation rmse = 0.316721
Validation r2 = 0.256894
Validation mse = 0.100312
Epoch 1
Loss = 6.9022e-01, PNorm = 34.0675, GNorm = 1.4241, lr_0 = 1.0000e-03
Validation rmse = 0.437672
Validation r2 = -0.419036
Validation mse = 0.191556
Epoch 2
Loss = 7.8491e-01, PNorm = 34.1285, GNorm = 2.4530, lr_0 = 9.6108e-04
Validation rmse = 0.256919
Validation r2 = 0.511020
Validation mse = 0.066008
Epoch 3
Loss = 4.6734e-01, PNorm = 34.2025, GNorm = 3.1209, lr_0 = 9.2367e-04
Validation rmse = 0.246517
Validation r2 = 0.549816
Validation mse = 0.060771
Epoch 4
Loss = 4.4042e-01, PNorm = 34.2648, GNorm = 2.8442, lr_0 = 8.9093e-04
Validation rmse = 0.239206
Validation r2 = 0.576122
Validation mse = 0.057220
Epoch 5
Loss = 4.4611e-01, PNorm = 34.3244, GNorm = 2.0010, lr_0 = 8.5625e-04
Validation rmse = 0.214369
Validation r2 = 0.659575
Validation mse = 0.045954
Epoch 6
Loss = 3.4362e-01, PNorm = 34.3851, GNorm = 2.9877, lr_0 = 8.2293e-04
Validation rmse = 0.209925
Validation r2 = 0.673545
Validation mse = 0.044068
Epoch 7
Loss = 3.0810e-01, PNorm = 34.4294, GNorm = 1.8321, lr_0 = 7.9090e-04
Loss = 4.2433e-01, PNorm = 34.4784, GNorm = 5.3468, lr_0 = 7.6286e-04
Validation rmse = 0.235077
Validation r2 = 0.590629
Validation mse = 0.055261
Epoch 8
Loss = 3.5405e-01, PNorm = 34.5102, GNorm = 1.0582, lr_0 = 7.3582e-04
Validation rmse = 0.191960
Validation r2 = 0.727029
Validation mse = 0.036849
Epoch 9
Loss = 2.7347e-01, PNorm = 34.5532, GNorm = 2.8747, lr_0 = 7.0718e-04
Validation rmse = 0.186687
Validation r2 = 0.741820
Validation mse = 0.034852
Epoch 10
Loss = 2.7989e-01, PNorm = 34.5901, GNorm = 2.3812, lr_0 = 6.7965e-04
Validation rmse = 0.170659
Validation r2 = 0.784247
Validation mse = 0.029125
Epoch 11
Loss = 2.2150e-01, PNorm = 34.6253, GNorm = 2.3666, lr_0 = 6.5556e-04
Validation rmse = 0.164883
Validation r2 = 0.798606
Validation mse = 0.027186
Epoch 12
Loss = 1.5745e-01, PNorm = 34.6649, GNorm = 0.5663, lr_0 = 6.3005e-04
Validation rmse = 0.184652
Validation r2 = 0.747416
Validation mse = 0.034096
Epoch 13
Loss = 1.9296e-01, PNorm = 34.7020, GNorm = 2.1057, lr_0 = 6.0552e-04
Validation rmse = 0.155185
Validation r2 = 0.821599
Validation mse = 0.024082
Epoch 14
Loss = 1.3072e-01, PNorm = 34.7405, GNorm = 0.7352, lr_0 = 5.8196e-04
Validation rmse = 0.149333
Validation r2 = 0.834801
Validation mse = 0.022300
Epoch 15
Loss = 1.6426e-01, PNorm = 34.7699, GNorm = 1.1226, lr_0 = 5.6133e-04
Loss = 1.4538e-01, PNorm = 34.8000, GNorm = 0.7185, lr_0 = 5.4143e-04
Loss = 1.5134e-01, PNorm = 34.8022, GNorm = 0.9605, lr_0 = 5.3948e-04
Validation rmse = 0.143679
Validation r2 = 0.847073
Validation mse = 0.020644
Epoch 16
Loss = 1.4164e-01, PNorm = 34.8271, GNorm = 1.4078, lr_0 = 5.2036e-04
Validation rmse = 0.145576
Validation r2 = 0.843008
Validation mse = 0.021192
Epoch 17
Loss = 1.3903e-01, PNorm = 34.8488, GNorm = 0.6539, lr_0 = 5.0010e-04
Validation rmse = 0.142494
Validation r2 = 0.849585
Validation mse = 0.020305
Epoch 18
Loss = 1.6244e-01, PNorm = 34.8727, GNorm = 3.1060, lr_0 = 4.8238e-04
Validation rmse = 0.137719
Validation r2 = 0.859497
Validation mse = 0.018967
Epoch 19
Loss = 1.4892e-01, PNorm = 34.8956, GNorm = 4.3283, lr_0 = 4.6360e-04
Validation rmse = 0.139633
Validation r2 = 0.855565
Validation mse = 0.019497
Epoch 20
Loss = 1.3907e-01, PNorm = 34.9198, GNorm = 2.3463, lr_0 = 4.4556e-04
Validation rmse = 0.140912
Validation r2 = 0.852906
Validation mse = 0.019856
Epoch 21
Loss = 1.4193e-01, PNorm = 34.9384, GNorm = 1.5761, lr_0 = 4.2821e-04
Validation rmse = 0.140012
Validation r2 = 0.854780
Validation mse = 0.019603
Epoch 22
Loss = 8.8831e-02, PNorm = 34.9579, GNorm = 1.4995, lr_0 = 4.1304e-04
Validation rmse = 0.133848
Validation r2 = 0.867285
Validation mse = 0.017915
Epoch 23
Loss = 6.4399e-02, PNorm = 34.9745, GNorm = 0.3478, lr_0 = 3.9696e-04
Loss = 1.1908e-01, PNorm = 34.9873, GNorm = 0.6215, lr_0 = 3.8289e-04
Loss = 7.1931e-02, PNorm = 34.9886, GNorm = 1.3408, lr_0 = 3.8151e-04
Validation rmse = 0.156169
Validation r2 = 0.819329
Validation mse = 0.024389
Epoch 24
Loss = 1.2871e-01, PNorm = 35.0014, GNorm = 3.1697, lr_0 = 3.6799e-04
Validation rmse = 0.136365
Validation r2 = 0.862246
Validation mse = 0.018595
Epoch 25
Loss = 1.1371e-01, PNorm = 35.0143, GNorm = 2.5014, lr_0 = 3.5494e-04
Validation rmse = 0.133673
Validation r2 = 0.867631
Validation mse = 0.017869
Epoch 26
Loss = 1.1590e-01, PNorm = 35.0293, GNorm = 0.9793, lr_0 = 3.4113e-04
Validation rmse = 0.139034
Validation r2 = 0.856801
Validation mse = 0.019331
Epoch 27
Loss = 9.2030e-02, PNorm = 35.0436, GNorm = 0.8939, lr_0 = 3.2785e-04
Validation rmse = 0.138245
Validation r2 = 0.858421
Validation mse = 0.019112
Epoch 28
Loss = 1.1643e-01, PNorm = 35.0551, GNorm = 0.5238, lr_0 = 3.1509e-04
Validation rmse = 0.136747
Validation r2 = 0.861473
Validation mse = 0.018700
Epoch 29
Loss = 1.1248e-01, PNorm = 35.0652, GNorm = 2.2636, lr_0 = 3.0392e-04
Validation rmse = 0.134624
Validation r2 = 0.865742
Validation mse = 0.018123
Epoch 30
Loss = 9.4162e-02, PNorm = 35.0753, GNorm = 2.5526, lr_0 = 2.9209e-04
Validation rmse = 0.141502
Validation r2 = 0.851672
Validation mse = 0.020023
Epoch 31
Loss = 1.3511e-01, PNorm = 35.0848, GNorm = 1.6275, lr_0 = 2.8072e-04
Loss = 1.0836e-01, PNorm = 35.0954, GNorm = 0.9081, lr_0 = 2.7077e-04
Loss = 1.2249e-01, PNorm = 35.0962, GNorm = 1.8950, lr_0 = 2.6980e-04
Validation rmse = 0.142770
Validation r2 = 0.849003
Validation mse = 0.020383
Epoch 32
Loss = 1.0421e-01, PNorm = 35.1055, GNorm = 1.0462, lr_0 = 2.6023e-04
Validation rmse = 0.135573
Validation r2 = 0.863842
Validation mse = 0.018380
Epoch 33
Loss = 1.1635e-01, PNorm = 35.1127, GNorm = 2.9404, lr_0 = 2.5101e-04
Validation rmse = 0.131835
Validation r2 = 0.871247
Validation mse = 0.017380
Epoch 34
Loss = 1.0183e-01, PNorm = 35.1217, GNorm = 0.6588, lr_0 = 2.4124e-04
Validation rmse = 0.137782
Validation r2 = 0.859370
Validation mse = 0.018984
Epoch 35
Loss = 9.9109e-02, PNorm = 35.1306, GNorm = 1.8504, lr_0 = 2.3185e-04
Validation rmse = 0.133847
Validation r2 = 0.867288
Validation mse = 0.017915
Epoch 36
Loss = 9.4717e-02, PNorm = 35.1389, GNorm = 0.4897, lr_0 = 2.2363e-04
Validation rmse = 0.135596
Validation r2 = 0.863796
Validation mse = 0.018386
Epoch 37
Loss = 8.4609e-02, PNorm = 35.1458, GNorm = 0.7150, lr_0 = 2.1493e-04
Validation rmse = 0.133021
Validation r2 = 0.868921
Validation mse = 0.017694
Epoch 38
Loss = 8.1970e-02, PNorm = 35.1546, GNorm = 1.4355, lr_0 = 2.0656e-04
Validation rmse = 0.133146
Validation r2 = 0.868674
Validation mse = 0.017728
Epoch 39
Loss = 8.9790e-02, PNorm = 35.1605, GNorm = 1.3765, lr_0 = 1.9852e-04
Loss = 9.5673e-02, PNorm = 35.1681, GNorm = 0.8477, lr_0 = 1.9148e-04
Validation rmse = 0.131799
Validation r2 = 0.871316
Validation mse = 0.017371
Epoch 40
Loss = 9.4677e-02, PNorm = 35.1755, GNorm = 0.7102, lr_0 = 1.8470e-04
Validation rmse = 0.135429
Validation r2 = 0.864131
Validation mse = 0.018341
Epoch 41
Loss = 9.3401e-02, PNorm = 35.1809, GNorm = 0.9392, lr_0 = 1.7751e-04
Validation rmse = 0.134491
Validation r2 = 0.866007
Validation mse = 0.018088
Epoch 42
Loss = 8.5755e-02, PNorm = 35.1882, GNorm = 1.0825, lr_0 = 1.7060e-04
Validation rmse = 0.138076
Validation r2 = 0.858767
Validation mse = 0.019065
Epoch 43
Loss = 1.0462e-01, PNorm = 35.1940, GNorm = 1.4673, lr_0 = 1.6455e-04
Validation rmse = 0.132878
Validation r2 = 0.869201
Validation mse = 0.017657
Epoch 44
Loss = 9.5563e-02, PNorm = 35.2009, GNorm = 1.1130, lr_0 = 1.5815e-04
Validation rmse = 0.129791
Validation r2 = 0.875208
Validation mse = 0.016846
Epoch 45
Loss = 6.7323e-02, PNorm = 35.2072, GNorm = 0.6964, lr_0 = 1.5199e-04
Validation rmse = 0.132719
Validation r2 = 0.869515
Validation mse = 0.017614
Epoch 46
Loss = 1.4779e-01, PNorm = 35.2134, GNorm = 3.0393, lr_0 = 1.4608e-04
Loss = 7.8317e-02, PNorm = 35.2184, GNorm = 0.9860, lr_0 = 1.4090e-04
Validation rmse = 0.134349
Validation r2 = 0.866290
Validation mse = 0.018050
Epoch 47
Loss = 9.6998e-02, PNorm = 35.2218, GNorm = 0.4588, lr_0 = 1.3590e-04
Validation rmse = 0.132275
Validation r2 = 0.870386
Validation mse = 0.017497
Epoch 48
Loss = 9.8401e-02, PNorm = 35.2276, GNorm = 1.2871, lr_0 = 1.3061e-04
Validation rmse = 0.130540
Validation r2 = 0.873764
Validation mse = 0.017041
Epoch 49
Loss = 8.6371e-02, PNorm = 35.2313, GNorm = 0.7208, lr_0 = 1.2553e-04
Validation rmse = 0.133482
Validation r2 = 0.868010
Validation mse = 0.017817
Epoch 50
Loss = 8.2645e-02, PNorm = 35.2368, GNorm = 2.0108, lr_0 = 1.2108e-04
Validation rmse = 0.141582
Validation r2 = 0.851505
Validation mse = 0.020045
Epoch 51
Loss = 7.8167e-02, PNorm = 35.2420, GNorm = 1.1690, lr_0 = 1.1637e-04
Validation rmse = 0.134812
Validation r2 = 0.865366
Validation mse = 0.018174
Epoch 52
Loss = 8.9248e-02, PNorm = 35.2457, GNorm = 0.8162, lr_0 = 1.1184e-04
Validation rmse = 0.132067
Validation r2 = 0.870792
Validation mse = 0.017442
Epoch 53
Loss = 8.8634e-02, PNorm = 35.2502, GNorm = 0.7066, lr_0 = 1.0749e-04
Validation rmse = 0.135226
Validation r2 = 0.864538
Validation mse = 0.018286
Epoch 54
Loss = 1.1365e-01, PNorm = 35.2538, GNorm = 2.1854, lr_0 = 1.0367e-04
Loss = 8.4704e-02, PNorm = 35.2578, GNorm = 0.6556, lr_0 = 1.0000e-04
Loss = 5.3050e-02, PNorm = 35.2581, GNorm = 1.3427, lr_0 = 1.0000e-04
Validation rmse = 0.132568
Validation r2 = 0.869810
Validation mse = 0.017574
Epoch 55
Loss = 8.1564e-02, PNorm = 35.2618, GNorm = 1.1400, lr_0 = 1.0000e-04
Validation rmse = 0.130323
Validation r2 = 0.874182
Validation mse = 0.016984
Epoch 56
Loss = 8.2848e-02, PNorm = 35.2656, GNorm = 1.0127, lr_0 = 1.0000e-04
Validation rmse = 0.132447
Validation r2 = 0.870049
Validation mse = 0.017542
Epoch 57
Loss = 7.9492e-02, PNorm = 35.2696, GNorm = 1.1093, lr_0 = 1.0000e-04
Validation rmse = 0.131415
Validation r2 = 0.872066
Validation mse = 0.017270
Epoch 58
Loss = 9.3234e-02, PNorm = 35.2741, GNorm = 0.8029, lr_0 = 1.0000e-04
Validation rmse = 0.132173
Validation r2 = 0.870586
Validation mse = 0.017470
Epoch 59
Loss = 7.9212e-02, PNorm = 35.2781, GNorm = 0.4119, lr_0 = 1.0000e-04
Validation rmse = 0.132784
Validation r2 = 0.869386
Validation mse = 0.017632
Model 0 best validation rmse = 0.129791 on epoch 44
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.159815
Model 0 test r2 = 0.633350
Model 0 test mse = 0.025541
Ensemble test rmse = 0.159815
Ensemble test r2 = 0.633350
Ensemble test mse = 0.025541
7-fold cross validation
	Seed 0 ==> test rmse = 0.166109
	Seed 0 ==> test r2 = 0.603901
	Seed 0 ==> test mse = 0.027592
	Seed 1 ==> test rmse = 0.180713
	Seed 1 ==> test r2 = 0.531193
	Seed 1 ==> test mse = 0.032657
	Seed 2 ==> test rmse = 0.167278
	Seed 2 ==> test r2 = 0.598308
	Seed 2 ==> test mse = 0.027982
	Seed 3 ==> test rmse = 0.173278
	Seed 3 ==> test r2 = 0.568973
	Seed 3 ==> test mse = 0.030025
	Seed 4 ==> test rmse = 0.160369
	Seed 4 ==> test r2 = 0.630806
	Seed 4 ==> test mse = 0.025718
	Seed 5 ==> test rmse = 0.177941
	Seed 5 ==> test r2 = 0.545464
	Seed 5 ==> test mse = 0.031663
	Seed 6 ==> test rmse = 0.159815
	Seed 6 ==> test r2 = 0.633350
	Seed 6 ==> test mse = 0.025541
Overall test rmse = 0.169358 +/- 0.007604
Overall test r2 = 0.587428 +/- 0.037118
Overall test mse = 0.028740 +/- 0.002586
Elapsed time = 0:03:47
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-1d5c3576-9790-4896-9034-9bb28ba18d8e.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/EtOH_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2', 'mse'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2', 'mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 7,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/generalization_3/EtOH_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/EtOH_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 966 | train size = 772 | val size = 194 | test size = 56
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.3126e-01, PNorm = 34.0160, GNorm = 3.6573, lr_0 = 4.3000e-04
Validation rmse = 0.298809
Validation r2 = 0.275349
Validation mse = 0.089287
Epoch 1
Loss = 7.1992e-01, PNorm = 34.0451, GNorm = 2.8509, lr_0 = 7.6000e-04
Loss = 6.4800e-01, PNorm = 34.1011, GNorm = 2.0422, lr_0 = 9.9472e-04
Loss = 8.9903e-01, PNorm = 34.1066, GNorm = 8.2538, lr_0 = 9.9209e-04
Validation rmse = 0.253104
Validation r2 = 0.480077
Validation mse = 0.064062
Epoch 2
Loss = 5.6024e-01, PNorm = 34.1687, GNorm = 2.3572, lr_0 = 9.6618e-04
Validation rmse = 0.212144
Validation r2 = 0.634739
Validation mse = 0.045005
Epoch 3
Loss = 4.4064e-01, PNorm = 34.2343, GNorm = 7.5170, lr_0 = 9.4094e-04
Loss = 4.7192e-01, PNorm = 34.2954, GNorm = 3.1717, lr_0 = 9.1637e-04
Validation rmse = 0.202197
Validation r2 = 0.668189
Validation mse = 0.040884
Epoch 4
Loss = 3.3163e-01, PNorm = 34.3689, GNorm = 1.3390, lr_0 = 8.9007e-04
Validation rmse = 0.176959
Validation r2 = 0.745851
Validation mse = 0.031315
Epoch 5
Loss = 2.4686e-01, PNorm = 34.4275, GNorm = 3.3266, lr_0 = 8.6682e-04
Loss = 2.5863e-01, PNorm = 34.4813, GNorm = 4.5762, lr_0 = 8.4418e-04
Validation rmse = 0.177682
Validation r2 = 0.743771
Validation mse = 0.031571
Epoch 6
Loss = 2.5487e-01, PNorm = 34.5313, GNorm = 5.1026, lr_0 = 8.1996e-04
Validation rmse = 0.149937
Validation r2 = 0.817543
Validation mse = 0.022481
Epoch 7
Loss = 1.5462e-01, PNorm = 34.5750, GNorm = 2.3840, lr_0 = 7.9854e-04
Loss = 2.0331e-01, PNorm = 34.6162, GNorm = 3.3843, lr_0 = 7.7769e-04
Validation rmse = 0.157193
Validation r2 = 0.799457
Validation mse = 0.024710
Epoch 8
Loss = 1.4562e-01, PNorm = 34.6551, GNorm = 1.3723, lr_0 = 7.5537e-04
Validation rmse = 0.148816
Validation r2 = 0.820261
Validation mse = 0.022146
Epoch 9
Loss = 1.0453e-01, PNorm = 34.6922, GNorm = 3.4736, lr_0 = 7.3370e-04
Loss = 1.5695e-01, PNorm = 34.7282, GNorm = 3.4272, lr_0 = 7.1453e-04
Validation rmse = 0.187929
Validation r2 = 0.713364
Validation mse = 0.035317
Epoch 10
Loss = 1.7653e-01, PNorm = 34.7560, GNorm = 1.1279, lr_0 = 6.9587e-04
Validation rmse = 0.156790
Validation r2 = 0.800483
Validation mse = 0.024583
Epoch 11
Loss = 1.7821e-01, PNorm = 34.7820, GNorm = 6.5003, lr_0 = 6.7590e-04
Loss = 1.4033e-01, PNorm = 34.8054, GNorm = 3.4915, lr_0 = 6.5825e-04
Validation rmse = 0.134550
Validation r2 = 0.853071
Validation mse = 0.018104
Epoch 12
Loss = 1.2080e-01, PNorm = 34.8301, GNorm = 3.4265, lr_0 = 6.4106e-04
Loss = 1.3420e-01, PNorm = 34.8503, GNorm = 1.2030, lr_0 = 6.2431e-04
Loss = 1.8093e-01, PNorm = 34.8517, GNorm = 4.9899, lr_0 = 6.2266e-04
Validation rmse = 0.132398
Validation r2 = 0.857734
Validation mse = 0.017529
Epoch 13
Loss = 1.3585e-01, PNorm = 34.8689, GNorm = 3.3214, lr_0 = 6.0640e-04
Validation rmse = 0.130183
Validation r2 = 0.862453
Validation mse = 0.016948
Epoch 14
Loss = 1.0173e-01, PNorm = 34.8838, GNorm = 0.7107, lr_0 = 5.9056e-04
Loss = 1.2089e-01, PNorm = 34.9035, GNorm = 0.5945, lr_0 = 5.7514e-04
Validation rmse = 0.145820
Validation r2 = 0.827425
Validation mse = 0.021264
Epoch 15
Loss = 1.5319e-01, PNorm = 34.9213, GNorm = 0.4831, lr_0 = 5.5863e-04
Validation rmse = 0.130944
Validation r2 = 0.860841
Validation mse = 0.017146
Epoch 16
Loss = 9.6419e-02, PNorm = 34.9362, GNorm = 0.7840, lr_0 = 5.4404e-04
Loss = 1.1693e-01, PNorm = 34.9546, GNorm = 2.2672, lr_0 = 5.2983e-04
Validation rmse = 0.128851
Validation r2 = 0.865253
Validation mse = 0.016603
Epoch 17
Loss = 1.0143e-01, PNorm = 34.9658, GNorm = 1.3255, lr_0 = 5.1463e-04
Validation rmse = 0.129699
Validation r2 = 0.863473
Validation mse = 0.016822
Epoch 18
Loss = 1.2218e-01, PNorm = 34.9839, GNorm = 1.0862, lr_0 = 4.9986e-04
Loss = 9.8866e-02, PNorm = 34.9972, GNorm = 3.4419, lr_0 = 4.8681e-04
Validation rmse = 0.133000
Validation r2 = 0.856436
Validation mse = 0.017689
Epoch 19
Loss = 1.1619e-01, PNorm = 35.0131, GNorm = 1.2855, lr_0 = 4.7409e-04
Validation rmse = 0.126303
Validation r2 = 0.870529
Validation mse = 0.015953
Epoch 20
Loss = 8.7057e-02, PNorm = 35.0274, GNorm = 0.8595, lr_0 = 4.6049e-04
Loss = 1.0928e-01, PNorm = 35.0440, GNorm = 2.0530, lr_0 = 4.4846e-04
Validation rmse = 0.127166
Validation r2 = 0.868756
Validation mse = 0.016171
Epoch 21
Loss = 1.0478e-01, PNorm = 35.0573, GNorm = 0.9414, lr_0 = 4.3675e-04
Validation rmse = 0.132934
Validation r2 = 0.856579
Validation mse = 0.017671
Epoch 22
Loss = 8.0732e-02, PNorm = 35.0713, GNorm = 1.8914, lr_0 = 4.2422e-04
Loss = 1.1605e-01, PNorm = 35.0877, GNorm = 2.8067, lr_0 = 4.1313e-04
Validation rmse = 0.144501
Validation r2 = 0.830533
Validation mse = 0.020881
Epoch 23
Loss = 1.2297e-01, PNorm = 35.1020, GNorm = 3.6388, lr_0 = 4.0234e-04
Loss = 1.1390e-01, PNorm = 35.1159, GNorm = 1.6972, lr_0 = 3.9184e-04
Loss = 7.7299e-02, PNorm = 35.1177, GNorm = 1.9452, lr_0 = 3.9080e-04
Validation rmse = 0.129788
Validation r2 = 0.863288
Validation mse = 0.016845
Epoch 24
Loss = 1.0035e-01, PNorm = 35.1309, GNorm = 2.1003, lr_0 = 3.8059e-04
Validation rmse = 0.127928
Validation r2 = 0.867176
Validation mse = 0.016366
Epoch 25
Loss = 8.7625e-02, PNorm = 35.1433, GNorm = 0.8924, lr_0 = 3.7065e-04
Loss = 1.0121e-01, PNorm = 35.1549, GNorm = 1.4731, lr_0 = 3.6097e-04
Validation rmse = 0.128519
Validation r2 = 0.865948
Validation mse = 0.016517
Epoch 26
Loss = 9.1728e-02, PNorm = 35.1674, GNorm = 1.2830, lr_0 = 3.5061e-04
Validation rmse = 0.127913
Validation r2 = 0.867209
Validation mse = 0.016362
Epoch 27
Loss = 9.9992e-02, PNorm = 35.1799, GNorm = 2.4043, lr_0 = 3.4055e-04
Loss = 9.9003e-02, PNorm = 35.1909, GNorm = 1.0169, lr_0 = 3.3166e-04
Validation rmse = 0.133057
Validation r2 = 0.856314
Validation mse = 0.017704
Epoch 28
Loss = 9.7300e-02, PNorm = 35.2028, GNorm = 0.9624, lr_0 = 3.2299e-04
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-1d5c3576-9790-4896-9034-9bb28ba18d8e.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/MeOH_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2', 'mse'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2', 'mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 11,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/generalization_3/MeOH_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/MeOH_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 705 | train size = 697 | val size = 8 | test size = 317
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.0749e-01, PNorm = 34.0182, GNorm = 1.9978, lr_0 = 4.8077e-04
Validation rmse = 0.445704
Validation r2 = -0.578378
Validation mse = 0.198652
Epoch 1
Loss = 5.6419e-01, PNorm = 34.0651, GNorm = 6.7618, lr_0 = 8.6154e-04
Validation rmse = 0.400601
Validation r2 = -0.275093
Validation mse = 0.160481
Epoch 2
Loss = 5.9655e-01, PNorm = 34.1256, GNorm = 6.6744, lr_0 = 9.8184e-04
Loss = 4.3406e-01, PNorm = 34.1886, GNorm = 0.7502, lr_0 = 9.5231e-04
Validation rmse = 0.367323
Validation r2 = -0.072050
Validation mse = 0.134926
Epoch 3
Loss = 3.8780e-01, PNorm = 34.2478, GNorm = 2.2195, lr_0 = 9.2367e-04
Validation rmse = 0.331116
Validation r2 = 0.128879
Validation mse = 0.109638
Epoch 4
Loss = 3.7185e-01, PNorm = 34.2983, GNorm = 8.5831, lr_0 = 8.9589e-04
Validation rmse = 0.362667
Validation r2 = -0.045040
Validation mse = 0.131527
Epoch 5
Loss = 2.7895e-01, PNorm = 34.3482, GNorm = 2.3196, lr_0 = 8.6894e-04
Loss = 2.9072e-01, PNorm = 34.3968, GNorm = 1.8216, lr_0 = 8.4281e-04
Validation rmse = 0.303457
Validation r2 = 0.268333
Validation mse = 0.092086
Epoch 6
Loss = 2.1735e-01, PNorm = 34.4418, GNorm = 2.0771, lr_0 = 8.1746e-04
Validation rmse = 0.297896
Validation r2 = 0.294903
Validation mse = 0.088742
Epoch 7
Loss = 1.8117e-01, PNorm = 34.4929, GNorm = 3.4832, lr_0 = 7.9287e-04
Loss = 2.0036e-01, PNorm = 34.5315, GNorm = 4.0363, lr_0 = 7.6903e-04
Validation rmse = 0.271008
Validation r2 = 0.416443
Validation mse = 0.073446
Epoch 8
Loss = 1.7517e-01, PNorm = 34.5757, GNorm = 0.7352, lr_0 = 7.4590e-04
Validation rmse = 0.228621
Validation r2 = 0.584710
Validation mse = 0.052268
Epoch 9
Loss = 1.8355e-01, PNorm = 34.6195, GNorm = 1.6307, lr_0 = 7.2346e-04
Validation rmse = 0.202722
Validation r2 = 0.673473
Validation mse = 0.041096
Epoch 10
Loss = 1.4017e-01, PNorm = 34.6558, GNorm = 1.9570, lr_0 = 7.0170e-04
Loss = 1.9359e-01, PNorm = 34.6866, GNorm = 0.9281, lr_0 = 6.8060e-04
Validation rmse = 0.220489
Validation r2 = 0.613730
Validation mse = 0.048615
Epoch 11
Loss = 1.8016e-01, PNorm = 34.7179, GNorm = 1.4678, lr_0 = 6.6013e-04
Validation rmse = 0.215406
Validation r2 = 0.631333
Validation mse = 0.046400
Epoch 12
Loss = 1.3771e-01, PNorm = 34.7473, GNorm = 5.2619, lr_0 = 6.4027e-04
Loss = 1.4551e-01, PNorm = 34.7735, GNorm = 2.2988, lr_0 = 6.2102e-04
Validation rmse = 0.203363
Validation r2 = 0.671404
Validation mse = 0.041357
Epoch 13
Loss = 1.2684e-01, PNorm = 34.7974, GNorm = 1.0988, lr_0 = 6.0234e-04
Validation rmse = 0.182547
Validation r2 = 0.735230
Validation mse = 0.033324
Epoch 14
Loss = 1.2250e-01, PNorm = 34.8191, GNorm = 1.6637, lr_0 = 5.8422e-04
Validation rmse = 0.193299
Validation r2 = 0.703123
Validation mse = 0.037364
Epoch 15
Loss = 9.5021e-02, PNorm = 34.8386, GNorm = 0.5236, lr_0 = 5.6665e-04
Loss = 1.2323e-01, PNorm = 34.8566, GNorm = 1.9003, lr_0 = 5.4961e-04
Validation rmse = 0.207280
Validation r2 = 0.658623
Validation mse = 0.042965
Epoch 16
Loss = 1.1431e-01, PNorm = 34.8741, GNorm = 1.8523, lr_0 = 5.3308e-04
Validation rmse = 0.165065
Validation r2 = 0.783515
Validation mse = 0.027246
Epoch 17
Loss = 1.1623e-01, PNorm = 34.8920, GNorm = 1.3141, lr_0 = 5.1547e-04
Loss = 1.1999e-01, PNorm = 34.9095, GNorm = 1.8236, lr_0 = 4.9996e-04
Validation rmse = 0.150074
Validation r2 = 0.821050
Validation mse = 0.022522
Epoch 18
Loss = 1.3374e-01, PNorm = 34.9257, GNorm = 1.0870, lr_0 = 4.8493e-04
Validation rmse = 0.166937
Validation r2 = 0.778576
Validation mse = 0.027868
Epoch 19
Loss = 1.2573e-01, PNorm = 34.9392, GNorm = 4.7611, lr_0 = 4.7034e-04
Validation rmse = 0.177456
Validation r2 = 0.749793
Validation mse = 0.031491
Epoch 20
Loss = 1.0795e-01, PNorm = 34.9566, GNorm = 0.9886, lr_0 = 4.5620e-04
Loss = 1.2980e-01, PNorm = 34.9734, GNorm = 4.5133, lr_0 = 4.4247e-04
Validation rmse = 0.201404
Validation r2 = 0.677703
Validation mse = 0.040564
Epoch 21
Loss = 1.1963e-01, PNorm = 34.9875, GNorm = 0.5896, lr_0 = 4.2917e-04
Validation rmse = 0.160451
Validation r2 = 0.795449
Validation mse = 0.025744
Epoch 22
Loss = 1.0584e-01, PNorm = 35.0020, GNorm = 0.7777, lr_0 = 4.1626e-04
Loss = 1.1056e-01, PNorm = 35.0141, GNorm = 3.7322, lr_0 = 4.0374e-04
Validation rmse = 0.148737
Validation r2 = 0.824226
Validation mse = 0.022123
Epoch 23
Loss = 9.9850e-02, PNorm = 35.0283, GNorm = 2.0338, lr_0 = 3.9160e-04
Validation rmse = 0.160381
Validation r2 = 0.795628
Validation mse = 0.025722
Epoch 24
Loss = 9.9853e-02, PNorm = 35.0384, GNorm = 1.6680, lr_0 = 3.7982e-04
Validation rmse = 0.171007
Validation r2 = 0.767648
Validation mse = 0.029243
Epoch 25
Loss = 9.1464e-02, PNorm = 35.0508, GNorm = 0.9257, lr_0 = 3.6839e-04
Loss = 1.0817e-01, PNorm = 35.0605, GNorm = 0.5069, lr_0 = 3.5731e-04
Validation rmse = 0.163927
Validation r2 = 0.786488
Validation mse = 0.026872
Epoch 26
Loss = 9.9830e-02, PNorm = 35.0733, GNorm = 2.0070, lr_0 = 3.4657e-04
Validation rmse = 0.153067
Validation r2 = 0.813843
Validation mse = 0.023429
Epoch 27
Loss = 1.0821e-01, PNorm = 35.0833, GNorm = 1.7375, lr_0 = 3.3614e-04
Loss = 9.8291e-02, PNorm = 35.0940, GNorm = 1.0902, lr_0 = 3.2603e-04
Validation rmse = 0.158127
Validation r2 = 0.801332
Validation mse = 0.025004
Epoch 28
Loss = 9.5233e-02, PNorm = 35.1042, GNorm = 3.1985, lr_0 = 3.1623e-04
Validation rmse = 0.162535
Validation r2 = 0.790101
Validation mse = 0.026417
Epoch 29
Loss = 1.0054e-01, PNorm = 35.1161, GNorm = 1.4033, lr_0 = 3.0672e-04
Validation rmse = 0.189250
Validation r2 = 0.715431
Validation mse = 0.035815
Epoch 30
Loss = 1.1127e-01, PNorm = 35.1244, GNorm = 1.9683, lr_0 = 2.9749e-04
Loss = 1.0359e-01, PNorm = 35.1357, GNorm = 0.6796, lr_0 = 2.8854e-04
Validation rmse = 0.138325
Validation r2 = 0.847973
Validation mse = 0.019134
Epoch 31
Loss = 9.7236e-02, PNorm = 35.1438, GNorm = 0.9813, lr_0 = 2.7987e-04
Validation rmse = 0.180652
Validation r2 = 0.740699
Validation mse = 0.032635
Epoch 32
Loss = 1.0021e-01, PNorm = 35.1519, GNorm = 0.5310, lr_0 = 2.7145e-04
Loss = 9.6626e-02, PNorm = 35.1611, GNorm = 0.6824, lr_0 = 2.6328e-04
Validation rmse = 0.157476
Validation r2 = 0.802964
Validation mse = 0.024799
Epoch 33
Loss = 8.8862e-02, PNorm = 35.1709, GNorm = 1.1258, lr_0 = 2.5537e-04
Validation rmse = 0.142984
Validation r2 = 0.837560
Validation mse = 0.020444
Epoch 34
Loss = 9.2784e-02, PNorm = 35.1804, GNorm = 0.5312, lr_0 = 2.4693e-04
Validation rmse = 0.152875
Validation r2 = 0.814310
Validation mse = 0.023371
Epoch 35
Loss = 9.8625e-02, PNorm = 35.1873, GNorm = 1.7511, lr_0 = 2.3950e-04
Loss = 9.6813e-02, PNorm = 35.1970, GNorm = 1.2387, lr_0 = 2.3230e-04
Validation rmse = 0.174690
Validation r2 = 0.757532
Validation mse = 0.030517
Epoch 36
Loss = 9.4341e-02, PNorm = 35.2064, GNorm = 1.0323, lr_0 = 2.2531e-04
Validation rmse = 0.153974
Validation r2 = 0.811631
Validation mse = 0.023708
Epoch 37
Loss = 8.2257e-02, PNorm = 35.2137, GNorm = 1.1698, lr_0 = 2.1854e-04
Validation rmse = 0.148459
Validation r2 = 0.824881
Validation mse = 0.022040
Epoch 38
Loss = 6.0309e-02, PNorm = 35.2197, GNorm = 0.9950, lr_0 = 2.1196e-04
Loss = 8.7731e-02, PNorm = 35.2271, GNorm = 1.0975, lr_0 = 2.0559e-04
Validation rmse = 0.149006
Validation r2 = 0.823588
Validation mse = 0.022203
Epoch 39
Loss = 8.5714e-02, PNorm = 35.2344, GNorm = 2.0092, lr_0 = 1.9940e-04
Validation rmse = 0.152881
Validation r2 = 0.814294
Validation mse = 0.023373
Epoch 40
Loss = 9.2821e-02, PNorm = 35.2406, GNorm = 1.0036, lr_0 = 1.9341e-04
Loss = 8.2875e-02, PNorm = 35.2475, GNorm = 0.6084, lr_0 = 1.8759e-04
Validation rmse = 0.141818
Validation r2 = 0.840198
Validation mse = 0.020112
Epoch 41
Loss = 8.8850e-02, PNorm = 35.2534, GNorm = 0.5530, lr_0 = 1.8195e-04
Validation rmse = 0.157894
Validation r2 = 0.801916
Validation mse = 0.024930
Epoch 42
Loss = 8.1714e-02, PNorm = 35.2605, GNorm = 0.8589, lr_0 = 1.7648e-04
Validation rmse = 0.155412
Validation r2 = 0.808096
Validation mse = 0.024153
Epoch 43
Loss = 7.8701e-02, PNorm = 35.2664, GNorm = 0.7667, lr_0 = 1.7117e-04
Loss = 8.5379e-02, PNorm = 35.2735, GNorm = 0.9150, lr_0 = 1.6602e-04
Validation rmse = 0.146109
Validation r2 = 0.830383
Validation mse = 0.021348
Epoch 44
Loss = 8.1720e-02, PNorm = 35.2794, GNorm = 2.0807, lr_0 = 1.6103e-04
Validation rmse = 0.140722
Validation r2 = 0.842659
Validation mse = 0.019803
Epoch 45
Loss = 8.9863e-02, PNorm = 35.2848, GNorm = 1.2765, lr_0 = 1.5618e-04
Loss = 8.4693e-02, PNorm = 35.2908, GNorm = 2.3538, lr_0 = 1.5149e-04
Validation rmse = 0.158840
Validation r2 = 0.799535
Validation mse = 0.025230
Epoch 46
Loss = 8.6366e-02, PNorm = 35.2959, GNorm = 1.4352, lr_0 = 1.4693e-04
Validation rmse = 0.168855
Validation r2 = 0.773459
Validation mse = 0.028512
Epoch 47
Loss = 8.5709e-02, PNorm = 35.3006, GNorm = 0.6714, lr_0 = 1.4251e-04
Validation rmse = 0.161623
Validation r2 = 0.792449
Validation mse = 0.026122
Epoch 48
Loss = 5.1791e-02, PNorm = 35.3068, GNorm = 0.8463, lr_0 = 1.3822e-04
Loss = 8.3955e-02, PNorm = 35.3116, GNorm = 1.7970, lr_0 = 1.3407e-04
Validation rmse = 0.152747
Validation r2 = 0.814619
Validation mse = 0.023332
Epoch 49
Loss = 8.3743e-02, PNorm = 35.3153, GNorm = 0.7883, lr_0 = 1.3003e-04
Validation rmse = 0.145886
Validation r2 = 0.830900
Validation mse = 0.021283
Epoch 50
Loss = 7.7326e-02, PNorm = 35.3215, GNorm = 1.5613, lr_0 = 1.2612e-04
Loss = 9.0825e-02, PNorm = 35.3254, GNorm = 2.0697, lr_0 = 1.2233e-04
Loss = 6.9066e-02, PNorm = 35.3261, GNorm = 0.6705, lr_0 = 1.2196e-04
Validation rmse = 0.151795
Validation r2 = 0.816923
Validation mse = 0.023042
Epoch 51
Loss = 8.5041e-02, PNorm = 35.3304, GNorm = 2.2304, lr_0 = 1.1829e-04
Validation rmse = 0.146594
Validation r2 = 0.829254
Validation mse = 0.021490
Epoch 52
Loss = 7.7800e-02, PNorm = 35.3346, GNorm = 0.4818, lr_0 = 1.1473e-04
Validation rmse = 0.152065
Validation r2 = 0.816271
Validation mse = 0.023124
Epoch 53
Loss = 7.2776e-02, PNorm = 35.3387, GNorm = 0.4455, lr_0 = 1.1128e-04
Loss = 7.5265e-02, PNorm = 35.3436, GNorm = 1.1352, lr_0 = 1.0793e-04
Validation rmse = 0.156165
Validation r2 = 0.806229
Validation mse = 0.024388
Epoch 54
Loss = 6.9451e-02, PNorm = 35.3465, GNorm = 2.2174, lr_0 = 1.0469e-04
Validation rmse = 0.150269
Validation r2 = 0.820586
Validation mse = 0.022581
Epoch 55
Loss = 8.6869e-02, PNorm = 35.3504, GNorm = 0.6275, lr_0 = 1.0154e-04
Loss = 7.7966e-02, PNorm = 35.3537, GNorm = 0.4974, lr_0 = 1.0000e-04
Validation rmse = 0.145301
Validation r2 = 0.832253
Validation mse = 0.021112
Epoch 56
Loss = 8.0434e-02, PNorm = 35.3571, GNorm = 0.8174, lr_0 = 1.0000e-04
Validation rmse = 0.143752
Validation r2 = 0.835810
Validation mse = 0.020665
Epoch 57
Loss = 7.7065e-02, PNorm = 35.3613, GNorm = 0.8302, lr_0 = 1.0000e-04
Validation rmse = 0.140004
Validation r2 = 0.844260
Validation mse = 0.019601
Epoch 58
Loss = 7.7839e-02, PNorm = 35.3644, GNorm = 0.7216, lr_0 = 1.0000e-04
Loss = 7.1288e-02, PNorm = 35.3687, GNorm = 0.9544, lr_0 = 1.0000e-04
Validation rmse = 0.143644
Validation r2 = 0.836058
Validation mse = 0.020633
Epoch 59
Loss = 7.8215e-02, PNorm = 35.3728, GNorm = 1.2508, lr_0 = 1.0000e-04
Validation rmse = 0.145768
Validation r2 = 0.831174
Validation mse = 0.021248
Model 0 best validation rmse = 0.138325 on epoch 30
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.186704
Model 0 test r2 = 0.499592
Model 0 test mse = 0.034858
Ensemble test rmse = 0.186704
Ensemble test r2 = 0.499592
Ensemble test mse = 0.034858
Fold 1
Splitting data with seed 1
Total size = 705 | train size = 697 | val size = 8 | test size = 317
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.0641e-01, PNorm = 34.0188, GNorm = 3.5798, lr_0 = 4.8077e-04
Validation rmse = 0.379606
Validation r2 = -0.658419
Validation mse = 0.144101
Epoch 1
Loss = 7.0385e-01, PNorm = 34.0526, GNorm = 8.7423, lr_0 = 8.6154e-04
Validation rmse = 0.322237
Validation r2 = -0.195029
Validation mse = 0.103837
Epoch 2
Loss = 6.4729e-01, PNorm = 34.1169, GNorm = 10.4269, lr_0 = 9.8184e-04
Loss = 5.0781e-01, PNorm = 34.1857, GNorm = 0.8212, lr_0 = 9.5231e-04
Validation rmse = 0.227041
Validation r2 = 0.406751
Validation mse = 0.051548
Epoch 3
Loss = 3.8871e-01, PNorm = 34.2530, GNorm = 1.0572, lr_0 = 9.2367e-04
Validation rmse = 0.170159
Validation r2 = 0.666777
Validation mse = 0.028954
Epoch 4
Loss = 3.4532e-01, PNorm = 34.3129, GNorm = 4.3099, lr_0 = 8.9589e-04
Validation rmse = 0.147421
Validation r2 = 0.749881
Validation mse = 0.021733
Epoch 5
Loss = 3.4531e-01, PNorm = 34.3701, GNorm = 3.9494, lr_0 = 8.6894e-04
Loss = 2.5586e-01, PNorm = 34.4250, GNorm = 4.9428, lr_0 = 8.4281e-04
Validation rmse = 0.190802
Validation r2 = 0.581021
Validation mse = 0.036405
Epoch 6
Loss = 2.3039e-01, PNorm = 34.4735, GNorm = 2.9847, lr_0 = 8.1746e-04
Validation rmse = 0.118977
Validation r2 = 0.837088
Validation mse = 0.014155
Epoch 7
Loss = 2.1864e-01, PNorm = 34.5183, GNorm = 3.1003, lr_0 = 7.9287e-04
Loss = 2.0721e-01, PNorm = 34.5603, GNorm = 3.7463, lr_0 = 7.6903e-04
Validation rmse = 0.116925
Validation r2 = 0.842658
Validation mse = 0.013672
Epoch 8
Loss = 2.0597e-01, PNorm = 34.6071, GNorm = 6.7587, lr_0 = 7.4590e-04
Validation rmse = 0.127083
Validation r2 = 0.814134
Validation mse = 0.016150
Epoch 9
Loss = 2.0336e-01, PNorm = 34.6387, GNorm = 5.0662, lr_0 = 7.2346e-04
Validation rmse = 0.121873
Validation r2 = 0.829061
Validation mse = 0.014853
Epoch 10
Loss = 1.2595e-01, PNorm = 34.6712, GNorm = 1.6939, lr_0 = 7.0170e-04
Loss = 2.0942e-01, PNorm = 34.7051, GNorm = 3.0264, lr_0 = 6.8060e-04
Validation rmse = 0.173549
Validation r2 = 0.653364
Validation mse = 0.030119
Epoch 11
Loss = 1.7048e-01, PNorm = 34.7323, GNorm = 0.6876, lr_0 = 6.6013e-04
Validation rmse = 0.114555
Validation r2 = 0.848973
Validation mse = 0.013123
Epoch 12
Loss = 1.7661e-01, PNorm = 34.7586, GNorm = 3.1134, lr_0 = 6.4027e-04
Loss = 1.4343e-01, PNorm = 34.7854, GNorm = 1.8082, lr_0 = 6.2102e-04
Validation rmse = 0.101322
Validation r2 = 0.881848
Validation mse = 0.010266
Epoch 13
Loss = 1.3378e-01, PNorm = 34.8113, GNorm = 2.7915, lr_0 = 6.0234e-04
Validation rmse = 0.101798
Validation r2 = 0.880737
Validation mse = 0.010363
Epoch 14
Loss = 1.2953e-01, PNorm = 34.8286, GNorm = 1.1327, lr_0 = 5.8422e-04
Validation rmse = 0.115839
Validation r2 = 0.845569
Validation mse = 0.013419
Epoch 15
Loss = 1.5890e-01, PNorm = 34.8473, GNorm = 2.2355, lr_0 = 5.6665e-04
Loss = 1.2008e-01, PNorm = 34.8659, GNorm = 0.7409, lr_0 = 5.4961e-04
Validation rmse = 0.111665
Validation r2 = 0.856497
Validation mse = 0.012469
Epoch 16
Loss = 1.3642e-01, PNorm = 34.8861, GNorm = 1.4809, lr_0 = 5.3308e-04
Validation rmse = 0.117126
Validation r2 = 0.842116
Validation mse = 0.013719
Epoch 17
Loss = 1.1608e-01, PNorm = 34.9013, GNorm = 1.1169, lr_0 = 5.1547e-04
Loss = 1.1810e-01, PNorm = 34.9169, GNorm = 0.5667, lr_0 = 4.9996e-04
Validation rmse = 0.095247
Validation r2 = 0.895593
Validation mse = 0.009072
Epoch 18
Loss = 1.1722e-01, PNorm = 34.9267, GNorm = 0.8030, lr_0 = 4.8493e-04
Validation rmse = 0.097051
Validation r2 = 0.891599
Validation mse = 0.009419
Epoch 19
Loss = 1.1930e-01, PNorm = 34.9420, GNorm = 1.7885, lr_0 = 4.7034e-04
Validation rmse = 0.111095
Validation r2 = 0.857959
Validation mse = 0.012342
Epoch 20
Loss = 1.3962e-01, PNorm = 34.9564, GNorm = 1.3098, lr_0 = 4.5620e-04
Loss = 1.1188e-01, PNorm = 34.9706, GNorm = 1.0770, lr_0 = 4.4247e-04
Validation rmse = 0.103567
Validation r2 = 0.876556
Validation mse = 0.010726
Epoch 21
Loss = 1.1121e-01, PNorm = 34.9812, GNorm = 1.5555, lr_0 = 4.2917e-04
Validation rmse = 0.123583
Validation r2 = 0.824229
Validation mse = 0.015273
Epoch 22
Loss = 1.0050e-01, PNorm = 34.9936, GNorm = 0.8779, lr_0 = 4.1626e-04
Loss = 1.1364e-01, PNorm = 35.0056, GNorm = 2.3016, lr_0 = 4.0374e-04
Validation rmse = 0.116449
Validation r2 = 0.843938
Validation mse = 0.013560
Epoch 23
Loss = 1.1054e-01, PNorm = 35.0184, GNorm = 1.4724, lr_0 = 3.9160e-04
Validation rmse = 0.100032
Validation r2 = 0.884838
Validation mse = 0.010006
Epoch 24
Loss = 1.0528e-01, PNorm = 35.0280, GNorm = 1.7359, lr_0 = 3.7982e-04
Validation rmse = 0.101499
Validation r2 = 0.881437
Validation mse = 0.010302
Epoch 25
Loss = 8.0556e-02, PNorm = 35.0401, GNorm = 0.5406, lr_0 = 3.6839e-04
Loss = 1.0623e-01, PNorm = 35.0520, GNorm = 1.0667, lr_0 = 3.5731e-04
Validation rmse = 0.097542
Validation r2 = 0.890500
Validation mse = 0.009515
Epoch 26
Loss = 9.7610e-02, PNorm = 35.0631, GNorm = 2.1395, lr_0 = 3.4657e-04
Validation rmse = 0.114988
Validation r2 = 0.847828
Validation mse = 0.013222
Epoch 27
Loss = 1.0428e-01, PNorm = 35.0742, GNorm = 0.7467, lr_0 = 3.3614e-04
Loss = 9.2799e-02, PNorm = 35.0856, GNorm = 1.3267, lr_0 = 3.2603e-04
Validation rmse = 0.096520
Validation r2 = 0.892783
Validation mse = 0.009316
Epoch 28
Loss = 1.0078e-01, PNorm = 35.0955, GNorm = 0.8976, lr_0 = 3.1623e-04
Validation rmse = 0.100650
Validation r2 = 0.883411
Validation mse = 0.010131
Epoch 29
Loss = 9.9249e-02, PNorm = 35.1073, GNorm = 0.9176, lr_0 = 3.0672e-04
Validation rmse = 0.116159
Validation r2 = 0.844714
Validation mse = 0.013493
Epoch 30
Loss = 8.5697e-02, PNorm = 35.1159, GNorm = 0.9309, lr_0 = 2.9749e-04
Loss = 1.0170e-01, PNorm = 35.1240, GNorm = 0.9552, lr_0 = 2.8854e-04
Validation rmse = 0.108195
Validation r2 = 0.865277
Validation mse = 0.011706
Epoch 31
Loss = 1.0313e-01, PNorm = 35.1321, GNorm = 2.9261, lr_0 = 2.7987e-04
Validation rmse = 0.104578
Validation r2 = 0.874135
Validation mse = 0.010936
Epoch 32
Loss = 8.9674e-02, PNorm = 35.1407, GNorm = 0.7819, lr_0 = 2.7145e-04
Loss = 9.2013e-02, PNorm = 35.1501, GNorm = 0.7007, lr_0 = 2.6328e-04
Validation rmse = 0.103270
Validation r2 = 0.877264
Validation mse = 0.010665
Epoch 33
Loss = 9.7807e-02, PNorm = 35.1583, GNorm = 1.5826, lr_0 = 2.5537e-04
Validation rmse = 0.099454
Validation r2 = 0.886166
Validation mse = 0.009891
Epoch 34
Loss = 9.0348e-02, PNorm = 35.1675, GNorm = 1.1720, lr_0 = 2.4693e-04
Validation rmse = 0.110614
Validation r2 = 0.859185
Validation mse = 0.012235
Epoch 35
Loss = 8.7240e-02, PNorm = 35.1751, GNorm = 1.0889, lr_0 = 2.3950e-04
Loss = 9.0370e-02, PNorm = 35.1835, GNorm = 1.4741, lr_0 = 2.3230e-04
Validation rmse = 0.094157
Validation r2 = 0.897969
Validation mse = 0.008866
Epoch 36
Loss = 9.5835e-02, PNorm = 35.1902, GNorm = 1.4202, lr_0 = 2.2531e-04
Validation rmse = 0.108961
Validation r2 = 0.863363
Validation mse = 0.011872
Epoch 37
Loss = 9.7116e-02, PNorm = 35.1982, GNorm = 0.9309, lr_0 = 2.1854e-04
Validation rmse = 0.099518
Validation r2 = 0.886019
Validation mse = 0.009904
Epoch 38
Loss = 1.2179e-01, PNorm = 35.2068, GNorm = 1.7748, lr_0 = 2.1196e-04
Loss = 8.2981e-02, PNorm = 35.2136, GNorm = 1.0079, lr_0 = 2.0559e-04
Validation rmse = 0.106768
Validation r2 = 0.868808
Validation mse = 0.011399
Epoch 39
Loss = 8.2695e-02, PNorm = 35.2197, GNorm = 0.7273, lr_0 = 1.9940e-04
Validation rmse = 0.102131
Validation r2 = 0.879954
Validation mse = 0.010431
Epoch 40
Loss = 8.1817e-02, PNorm = 35.2276, GNorm = 1.8474, lr_0 = 1.9341e-04
Loss = 8.9341e-02, PNorm = 35.2337, GNorm = 0.6351, lr_0 = 1.8759e-04
Validation rmse = 0.096310
Validation r2 = 0.893250
Validation mse = 0.009276
Epoch 41
Loss = 9.4676e-02, PNorm = 35.2404, GNorm = 1.6463, lr_0 = 1.8195e-04
Validation rmse = 0.098445
Validation r2 = 0.888464
Validation mse = 0.009691
Epoch 42
Loss = 7.3929e-02, PNorm = 35.2453, GNorm = 1.5666, lr_0 = 1.7648e-04
Validation rmse = 0.108299
Validation r2 = 0.865017
Validation mse = 0.011729
Epoch 43
Loss = 8.6707e-02, PNorm = 35.2516, GNorm = 0.5421, lr_0 = 1.7117e-04
Loss = 8.2398e-02, PNorm = 35.2576, GNorm = 0.4015, lr_0 = 1.6602e-04
Validation rmse = 0.101090
Validation r2 = 0.882390
Validation mse = 0.010219
Epoch 44
Loss = 8.4299e-02, PNorm = 35.2626, GNorm = 1.4728, lr_0 = 1.6103e-04
Validation rmse = 0.096538
Validation r2 = 0.892744
Validation mse = 0.009320
Epoch 45
Loss = 9.3225e-02, PNorm = 35.2685, GNorm = 1.7759, lr_0 = 1.5618e-04
Loss = 8.3846e-02, PNorm = 35.2737, GNorm = 1.4092, lr_0 = 1.5149e-04
Validation rmse = 0.103139
Validation r2 = 0.877574
Validation mse = 0.010638
Epoch 46
Loss = 8.3346e-02, PNorm = 35.2792, GNorm = 0.7747, lr_0 = 1.4693e-04
Validation rmse = 0.105404
Validation r2 = 0.872139
Validation mse = 0.011110
Epoch 47
Loss = 8.2206e-02, PNorm = 35.2837, GNorm = 1.2379, lr_0 = 1.4251e-04
Validation rmse = 0.108119
Validation r2 = 0.865465
Validation mse = 0.011690
Epoch 48
Loss = 6.3206e-02, PNorm = 35.2875, GNorm = 0.9122, lr_0 = 1.3822e-04
Loss = 8.2413e-02, PNorm = 35.2925, GNorm = 1.5536, lr_0 = 1.3407e-04
Validation rmse = 0.097474
Validation r2 = 0.890653
Validation mse = 0.009501
Epoch 49
Loss = 7.9373e-02, PNorm = 35.2969, GNorm = 1.7110, lr_0 = 1.3003e-04
Validation rmse = 0.100513
Validation r2 = 0.883729
Validation mse = 0.010103
Epoch 50
Loss = 6.6310e-02, PNorm = 35.3010, GNorm = 1.1129, lr_0 = 1.2612e-04
Loss = 8.5022e-02, PNorm = 35.3054, GNorm = 1.1138, lr_0 = 1.2233e-04
Loss = 6.0328e-02, PNorm = 35.3058, GNorm = 1.5064, lr_0 = 1.2196e-04
Validation rmse = 0.103712
Validation r2 = 0.876210
Validation mse = 0.010756
Epoch 51
Loss = 7.9278e-02, PNorm = 35.3099, GNorm = 1.7440, lr_0 = 1.1829e-04
Validation rmse = 0.098879
Validation r2 = 0.887479
Validation mse = 0.009777
Epoch 52
Loss = 5.9578e-02, PNorm = 35.3142, GNorm = 0.4933, lr_0 = 1.1473e-04
Validation rmse = 0.096191
Validation r2 = 0.893513
Validation mse = 0.009253
Epoch 53
Loss = 7.4169e-02, PNorm = 35.3181, GNorm = 1.2097, lr_0 = 1.1128e-04
Loss = 8.2087e-02, PNorm = 35.3224, GNorm = 1.3327, lr_0 = 1.0793e-04
Validation rmse = 0.095812
Validation r2 = 0.894351
Validation mse = 0.009180
Epoch 54
Loss = 7.7414e-02, PNorm = 35.3264, GNorm = 0.6834, lr_0 = 1.0469e-04
Validation rmse = 0.095655
Validation r2 = 0.894697
Validation mse = 0.009150
Epoch 55
Loss = 8.3824e-02, PNorm = 35.3299, GNorm = 0.7393, lr_0 = 1.0154e-04
Loss = 7.5557e-02, PNorm = 35.3341, GNorm = 1.0520, lr_0 = 1.0000e-04
Validation rmse = 0.095621
Validation r2 = 0.894772
Validation mse = 0.009143
Epoch 56
Loss = 7.7845e-02, PNorm = 35.3371, GNorm = 1.9894, lr_0 = 1.0000e-04
Validation rmse = 0.094488
Validation r2 = 0.897251
Validation mse = 0.008928
Epoch 57
Loss = 9.1759e-02, PNorm = 35.3407, GNorm = 3.0288, lr_0 = 1.0000e-04
Validation rmse = 0.094085
Validation r2 = 0.898125
Validation mse = 0.008852
Epoch 58
Loss = 7.4243e-02, PNorm = 35.3449, GNorm = 0.6271, lr_0 = 1.0000e-04
Loss = 8.1455e-02, PNorm = 35.3486, GNorm = 0.5352, lr_0 = 1.0000e-04
Validation rmse = 0.093553
Validation r2 = 0.899274
Validation mse = 0.008752
Epoch 59
Loss = 7.7731e-02, PNorm = 35.3517, GNorm = 1.8515, lr_0 = 1.0000e-04
Validation rmse = 0.099563
Validation r2 = 0.885916
Validation mse = 0.009913
Model 0 best validation rmse = 0.093553 on epoch 58
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.159954
Model 0 test r2 = 0.632712
Model 0 test mse = 0.025585
Ensemble test rmse = 0.159954
Ensemble test r2 = 0.632712
Ensemble test mse = 0.025585
Fold 2
Splitting data with seed 2
Total size = 705 | train size = 697 | val size = 8 | test size = 317
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.2179e-01, PNorm = 34.0183, GNorm = 2.4068, lr_0 = 4.8077e-04
Validation rmse = 0.311978
Validation r2 = 0.143311
Validation mse = 0.097330
Epoch 1
Loss = 6.0021e-01, PNorm = 34.0597, GNorm = 3.8454, lr_0 = 8.6154e-04
Validation rmse = 0.299206
Validation r2 = 0.212017
Validation mse = 0.089524
Epoch 2
Loss = 4.9780e-01, PNorm = 34.1262, GNorm = 0.9314, lr_0 = 9.8184e-04
Loss = 3.7524e-01, PNorm = 34.1971, GNorm = 6.7382, lr_0 = 9.5231e-04
Validation rmse = 0.300601
Validation r2 = 0.204653
Validation mse = 0.090361
Epoch 3
Loss = 4.2793e-01, PNorm = 34.2542, GNorm = 0.8915, lr_0 = 9.2367e-04
Validation rmse = 0.340637
Validation r2 = -0.021314
Validation mse = 0.116033
Epoch 4
Loss = 3.8097e-01, PNorm = 34.2973, GNorm = 8.1918, lr_0 = 8.9589e-04
Validation rmse = 0.316429
Validation r2 = 0.118688
Validation mse = 0.100127
Epoch 5
Loss = 2.3603e-01, PNorm = 34.3479, GNorm = 3.7378, lr_0 = 8.6894e-04
Loss = 3.1398e-01, PNorm = 34.3951, GNorm = 3.9254, lr_0 = 8.4281e-04
Validation rmse = 0.322528
Validation r2 = 0.084391
Validation mse = 0.104024
Epoch 6
Loss = 2.5455e-01, PNorm = 34.4417, GNorm = 5.8375, lr_0 = 8.1746e-04
Validation rmse = 0.287262
Validation r2 = 0.273672
Validation mse = 0.082519
Epoch 7
Loss = 2.0572e-01, PNorm = 34.4821, GNorm = 5.2814, lr_0 = 7.9287e-04
Loss = 2.0571e-01, PNorm = 34.5225, GNorm = 1.1295, lr_0 = 7.6903e-04
Validation rmse = 0.286425
Validation r2 = 0.277897
Validation mse = 0.082039
Epoch 8
Loss = 1.8937e-01, PNorm = 34.5598, GNorm = 0.9441, lr_0 = 7.4590e-04
Validation rmse = 0.273939
Validation r2 = 0.339484
Validation mse = 0.075042
Epoch 9
Loss = 1.6361e-01, PNorm = 34.5984, GNorm = 2.5043, lr_0 = 7.2346e-04
Validation rmse = 0.260805
Validation r2 = 0.401302
Validation mse = 0.068019
Epoch 10
Loss = 1.5329e-01, PNorm = 34.6322, GNorm = 0.6367, lr_0 = 7.0170e-04
Loss = 1.5197e-01, PNorm = 34.6652, GNorm = 0.9236, lr_0 = 6.8060e-04
Validation rmse = 0.239002
Validation r2 = 0.497220
Validation mse = 0.057122
Epoch 11
Loss = 1.4795e-01, PNorm = 34.6872, GNorm = 0.7704, lr_0 = 6.6013e-04
Validation rmse = 0.267956
Validation r2 = 0.368020
Validation mse = 0.071800
Epoch 12
Loss = 2.2739e-01, PNorm = 34.7154, GNorm = 2.8749, lr_0 = 6.4027e-04
Loss = 1.4203e-01, PNorm = 34.7437, GNorm = 1.7148, lr_0 = 6.2102e-04
Validation rmse = 0.251139
Validation r2 = 0.444856
Validation mse = 0.063071
Epoch 13
Loss = 1.4439e-01, PNorm = 34.7672, GNorm = 4.9512, lr_0 = 6.0234e-04
Validation rmse = 0.252484
Validation r2 = 0.438894
Validation mse = 0.063748
Epoch 14
Loss = 1.9288e-01, PNorm = 34.7846, GNorm = 7.8285, lr_0 = 5.8422e-04
Validation rmse = 0.242112
Validation r2 = 0.484048
Validation mse = 0.058618
Epoch 15
Loss = 1.9231e-01, PNorm = 34.8038, GNorm = 4.6088, lr_0 = 5.6665e-04
Loss = 1.6626e-01, PNorm = 34.8262, GNorm = 2.9135, lr_0 = 5.4961e-04
Validation rmse = 0.249669
Validation r2 = 0.451336
Validation mse = 0.062335
Epoch 16
Loss = 1.3068e-01, PNorm = 34.8463, GNorm = 0.5761, lr_0 = 5.3308e-04
Validation rmse = 0.245337
Validation r2 = 0.470213
Validation mse = 0.060190
Epoch 17
Loss = 1.2557e-01, PNorm = 34.8660, GNorm = 1.4112, lr_0 = 5.1547e-04
Loss = 1.2276e-01, PNorm = 34.8827, GNorm = 2.5025, lr_0 = 4.9996e-04
Validation rmse = 0.248178
Validation r2 = 0.457871
Validation mse = 0.061592
Epoch 18
Loss = 1.3072e-01, PNorm = 34.9002, GNorm = 3.1995, lr_0 = 4.8493e-04
Validation rmse = 0.236804
Validation r2 = 0.506422
Validation mse = 0.056076
Epoch 19
Loss = 1.2600e-01, PNorm = 34.9146, GNorm = 0.9960, lr_0 = 4.7034e-04
Validation rmse = 0.219621
Validation r2 = 0.575455
Validation mse = 0.048233
Epoch 20
Loss = 8.1937e-02, PNorm = 34.9273, GNorm = 0.7971, lr_0 = 4.5620e-04
Loss = 1.1831e-01, PNorm = 34.9405, GNorm = 2.3135, lr_0 = 4.4247e-04
Validation rmse = 0.233987
Validation r2 = 0.518096
Validation mse = 0.054750
Epoch 21
Loss = 1.2229e-01, PNorm = 34.9539, GNorm = 3.0859, lr_0 = 4.2917e-04
Validation rmse = 0.230962
Validation r2 = 0.530475
Validation mse = 0.053344
Epoch 22
Loss = 9.9352e-02, PNorm = 34.9667, GNorm = 0.6676, lr_0 = 4.1626e-04
Loss = 1.0845e-01, PNorm = 34.9776, GNorm = 3.0633, lr_0 = 4.0374e-04
Validation rmse = 0.223220
Validation r2 = 0.561428
Validation mse = 0.049827
Epoch 23
Loss = 1.1569e-01, PNorm = 34.9876, GNorm = 1.9541, lr_0 = 3.9160e-04
Validation rmse = 0.227254
Validation r2 = 0.545431
Validation mse = 0.051644
Epoch 24
Loss = 1.1729e-01, PNorm = 34.9986, GNorm = 3.3019, lr_0 = 3.7982e-04
Validation rmse = 0.220585
Validation r2 = 0.571717
Validation mse = 0.048658
Epoch 25
Loss = 1.1287e-01, PNorm = 35.0095, GNorm = 0.5794, lr_0 = 3.6839e-04
Loss = 1.0184e-01, PNorm = 35.0208, GNorm = 2.0192, lr_0 = 3.5731e-04
Validation rmse = 0.228912
Validation r2 = 0.538775
Validation mse = 0.052401
Epoch 26
Loss = 1.0832e-01, PNorm = 35.0332, GNorm = 0.5800, lr_0 = 3.4657e-04
Validation rmse = 0.227043
Validation r2 = 0.546276
Validation mse = 0.051548
Epoch 27
Loss = 9.3416e-02, PNorm = 35.0414, GNorm = 1.8432, lr_0 = 3.3614e-04
Loss = 9.9302e-02, PNorm = 35.0517, GNorm = 1.3163, lr_0 = 3.2603e-04
Validation rmse = 0.216087
Validation r2 = 0.589007
Validation mse = 0.046694
Epoch 28
Loss = 9.4374e-02, PNorm = 35.0614, GNorm = 1.3447, lr_0 = 3.1623e-04
Validation rmse = 0.221364
Validation r2 = 0.568690
Validation mse = 0.049002
Epoch 29
Loss = 9.2570e-02, PNorm = 35.0717, GNorm = 0.4818, lr_0 = 3.0672e-04
Validation rmse = 0.221794
Validation r2 = 0.567012
Validation mse = 0.049193
Epoch 30
Loss = 1.0124e-01, PNorm = 35.0825, GNorm = 0.6695, lr_0 = 2.9749e-04
Loss = 9.9911e-02, PNorm = 35.0919, GNorm = 1.8177, lr_0 = 2.8854e-04
Validation rmse = 0.219443
Validation r2 = 0.576141
Validation mse = 0.048155
Epoch 31
Loss = 1.0763e-01, PNorm = 35.1011, GNorm = 1.7916, lr_0 = 2.7987e-04
Validation rmse = 0.218031
Validation r2 = 0.581580
Validation mse = 0.047537
Epoch 32
Loss = 9.4857e-02, PNorm = 35.1102, GNorm = 0.8264, lr_0 = 2.7145e-04
Loss = 9.0349e-02, PNorm = 35.1203, GNorm = 0.5463, lr_0 = 2.6328e-04
Validation rmse = 0.212549
Validation r2 = 0.602356
Validation mse = 0.045177
Epoch 33
Loss = 9.6487e-02, PNorm = 35.1289, GNorm = 1.5129, lr_0 = 2.5537e-04
Validation rmse = 0.220756
Validation r2 = 0.571056
Validation mse = 0.048733
Epoch 34
Loss = 1.0493e-01, PNorm = 35.1384, GNorm = 1.8857, lr_0 = 2.4693e-04
Validation rmse = 0.219340
Validation r2 = 0.576539
Validation mse = 0.048110
Epoch 35
Loss = 1.1216e-01, PNorm = 35.1466, GNorm = 4.8363, lr_0 = 2.3950e-04
Loss = 9.7241e-02, PNorm = 35.1546, GNorm = 2.4936, lr_0 = 2.3230e-04
Validation rmse = 0.216001
Validation r2 = 0.589335
Validation mse = 0.046656
Epoch 36
Loss = 8.8065e-02, PNorm = 35.1629, GNorm = 2.7463, lr_0 = 2.2531e-04
Validation rmse = 0.217900
Validation r2 = 0.582081
Validation mse = 0.047480
Epoch 37
Loss = 9.0136e-02, PNorm = 35.1721, GNorm = 0.8303, lr_0 = 2.1854e-04
Validation rmse = 0.212044
Validation r2 = 0.604243
Validation mse = 0.044963
Epoch 38
Loss = 7.8275e-02, PNorm = 35.1785, GNorm = 1.0719, lr_0 = 2.1196e-04
Loss = 9.3582e-02, PNorm = 35.1857, GNorm = 1.1013, lr_0 = 2.0559e-04
Validation rmse = 0.214488
Validation r2 = 0.595066
Validation mse = 0.046005
Epoch 39
Loss = 8.6248e-02, PNorm = 35.1907, GNorm = 0.9891, lr_0 = 1.9940e-04
Validation rmse = 0.214316
Validation r2 = 0.595717
Validation mse = 0.045931
Epoch 40
Loss = 8.1258e-02, PNorm = 35.1973, GNorm = 0.8811, lr_0 = 1.9341e-04
Loss = 8.4902e-02, PNorm = 35.2027, GNorm = 1.4610, lr_0 = 1.8759e-04
Validation rmse = 0.210342
Validation r2 = 0.610570
Validation mse = 0.044244
Epoch 41
Loss = 7.8500e-02, PNorm = 35.2085, GNorm = 0.5305, lr_0 = 1.8195e-04
Validation rmse = 0.205161
Validation r2 = 0.629519
Validation mse = 0.042091
Epoch 42
Loss = 9.1634e-02, PNorm = 35.2155, GNorm = 0.7751, lr_0 = 1.7648e-04
Validation rmse = 0.215766
Validation r2 = 0.590227
Validation mse = 0.046555
Epoch 43
Loss = 1.1167e-01, PNorm = 35.2207, GNorm = 0.5878, lr_0 = 1.7117e-04
Loss = 8.2291e-02, PNorm = 35.2256, GNorm = 0.4573, lr_0 = 1.6602e-04
Validation rmse = 0.213768
Validation r2 = 0.597780
Validation mse = 0.045697
Epoch 44
Loss = 8.9266e-02, PNorm = 35.2306, GNorm = 0.7849, lr_0 = 1.6103e-04
Validation rmse = 0.205962
Validation r2 = 0.626619
Validation mse = 0.042420
Epoch 45
Loss = 9.7521e-02, PNorm = 35.2363, GNorm = 1.1584, lr_0 = 1.5618e-04
Loss = 8.0944e-02, PNorm = 35.2411, GNorm = 2.3047, lr_0 = 1.5149e-04
Validation rmse = 0.211889
Validation r2 = 0.604822
Validation mse = 0.044897
Epoch 46
Loss = 7.9775e-02, PNorm = 35.2471, GNorm = 1.4625, lr_0 = 1.4693e-04
Validation rmse = 0.211508
Validation r2 = 0.606240
Validation mse = 0.044736
Epoch 47
Loss = 8.1371e-02, PNorm = 35.2515, GNorm = 1.6270, lr_0 = 1.4251e-04
Validation rmse = 0.205404
Validation r2 = 0.628639
Validation mse = 0.042191
Epoch 48
Loss = 6.1642e-02, PNorm = 35.2573, GNorm = 0.7307, lr_0 = 1.3822e-04
Loss = 8.5001e-02, PNorm = 35.2612, GNorm = 0.6543, lr_0 = 1.3407e-04
Validation rmse = 0.207655
Validation r2 = 0.620455
Validation mse = 0.043121
Epoch 49
Loss = 8.5536e-02, PNorm = 35.2653, GNorm = 1.4829, lr_0 = 1.3003e-04
Validation rmse = 0.203687
Validation r2 = 0.634822
Validation mse = 0.041489
Epoch 50
Loss = 5.7743e-02, PNorm = 35.2696, GNorm = 0.4261, lr_0 = 1.2612e-04
Loss = 8.4168e-02, PNorm = 35.2742, GNorm = 1.0146, lr_0 = 1.2233e-04
Loss = 1.1211e-01, PNorm = 35.2747, GNorm = 2.5825, lr_0 = 1.2196e-04
Validation rmse = 0.204670
Validation r2 = 0.631288
Validation mse = 0.041890
Epoch 51
Loss = 8.0493e-02, PNorm = 35.2797, GNorm = 1.1799, lr_0 = 1.1829e-04
Validation rmse = 0.203942
Validation r2 = 0.633907
Validation mse = 0.041592
Epoch 52
Loss = 7.4386e-02, PNorm = 35.2831, GNorm = 0.6202, lr_0 = 1.1473e-04
Validation rmse = 0.204872
Validation r2 = 0.630562
Validation mse = 0.041972
Epoch 53
Loss = 6.4354e-02, PNorm = 35.2869, GNorm = 0.9574, lr_0 = 1.1128e-04
Loss = 7.5639e-02, PNorm = 35.2904, GNorm = 0.7143, lr_0 = 1.0793e-04
Validation rmse = 0.202753
Validation r2 = 0.638166
Validation mse = 0.041109
Epoch 54
Loss = 8.0979e-02, PNorm = 35.2937, GNorm = 0.7654, lr_0 = 1.0469e-04
Validation rmse = 0.200337
Validation r2 = 0.646736
Validation mse = 0.040135
Epoch 55
Loss = 6.8440e-02, PNorm = 35.2977, GNorm = 0.8765, lr_0 = 1.0154e-04
Loss = 8.2469e-02, PNorm = 35.3018, GNorm = 1.5205, lr_0 = 1.0000e-04
Validation rmse = 0.207200
Validation r2 = 0.622118
Validation mse = 0.042932
Epoch 56
Loss = 7.6559e-02, PNorm = 35.3048, GNorm = 1.4457, lr_0 = 1.0000e-04
Validation rmse = 0.203369
Validation r2 = 0.635962
Validation mse = 0.041359
Epoch 57
Loss = 7.8766e-02, PNorm = 35.3078, GNorm = 1.1898, lr_0 = 1.0000e-04
Validation rmse = 0.202278
Validation r2 = 0.639859
Validation mse = 0.040916
Epoch 58
Loss = 5.0580e-02, PNorm = 35.3121, GNorm = 0.5666, lr_0 = 1.0000e-04
Loss = 8.6131e-02, PNorm = 35.3155, GNorm = 0.6406, lr_0 = 1.0000e-04
Validation rmse = 0.209835
Validation r2 = 0.612444
Validation mse = 0.044031
Epoch 59
Loss = 8.5685e-02, PNorm = 35.3191, GNorm = 1.1527, lr_0 = 1.0000e-04
Validation rmse = 0.197563
Validation r2 = 0.656453
Validation mse = 0.039031
Model 0 best validation rmse = 0.197563 on epoch 59
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.166679
Model 0 test r2 = 0.601178
Model 0 test mse = 0.027782
Ensemble test rmse = 0.166679
Ensemble test r2 = 0.601178
Ensemble test mse = 0.027782
Fold 3
Splitting data with seed 3
Total size = 705 | train size = 697 | val size = 8 | test size = 317
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.2442e-01, PNorm = 34.0183, GNorm = 5.5760, lr_0 = 4.8077e-04
Validation rmse = 0.234461
Validation r2 = -0.099707
Validation mse = 0.054972
Epoch 1
Loss = 7.2781e-01, PNorm = 34.0627, GNorm = 6.2875, lr_0 = 8.6154e-04
Validation rmse = 0.255881
Validation r2 = -0.309816
Validation mse = 0.065475
Epoch 2
Loss = 5.0566e-01, PNorm = 34.1350, GNorm = 7.1192, lr_0 = 9.8184e-04
Loss = 5.3091e-01, PNorm = 34.1966, GNorm = 1.5185, lr_0 = 9.5231e-04
Validation rmse = 0.221160
Validation r2 = 0.021527
Validation mse = 0.048912
Epoch 3
Loss = 4.8482e-01, PNorm = 34.2514, GNorm = 0.9039, lr_0 = 9.2367e-04
Validation rmse = 0.212739
Validation r2 = 0.094622
Validation mse = 0.045258
Epoch 4
Loss = 3.3875e-01, PNorm = 34.3064, GNorm = 0.6206, lr_0 = 8.9589e-04
Validation rmse = 0.200761
Validation r2 = 0.193703
Validation mse = 0.040305
Epoch 5
Loss = 2.6156e-01, PNorm = 34.3533, GNorm = 0.5833, lr_0 = 8.6894e-04
Loss = 2.6022e-01, PNorm = 34.4021, GNorm = 2.8049, lr_0 = 8.4281e-04
Validation rmse = 0.180435
Validation r2 = 0.348703
Validation mse = 0.032557
Epoch 6
Loss = 2.3955e-01, PNorm = 34.4417, GNorm = 1.3112, lr_0 = 8.1746e-04
Validation rmse = 0.174390
Validation r2 = 0.391618
Validation mse = 0.030412
Epoch 7
Loss = 2.8145e-01, PNorm = 34.4858, GNorm = 5.0549, lr_0 = 7.9287e-04
Loss = 2.2040e-01, PNorm = 34.5251, GNorm = 1.2163, lr_0 = 7.6903e-04
Validation rmse = 0.147711
Validation r2 = 0.563520
Validation mse = 0.021819
Epoch 8
Loss = 1.9977e-01, PNorm = 34.5606, GNorm = 1.5281, lr_0 = 7.4590e-04
Validation rmse = 0.177942
Validation r2 = 0.366580
Validation mse = 0.031663
Epoch 9
Loss = 1.3377e-01, PNorm = 34.5965, GNorm = 0.5479, lr_0 = 7.2346e-04
Validation rmse = 0.155519
Validation r2 = 0.516158
Validation mse = 0.024186
Epoch 10
Loss = 1.4579e-01, PNorm = 34.6298, GNorm = 2.2588, lr_0 = 7.0170e-04
Loss = 1.5372e-01, PNorm = 34.6629, GNorm = 1.6453, lr_0 = 6.8060e-04
Validation rmse = 0.138435
Validation r2 = 0.616623
Validation mse = 0.019164
Epoch 11
Loss = 1.4785e-01, PNorm = 34.6898, GNorm = 3.1830, lr_0 = 6.6013e-04
Validation rmse = 0.242280
Validation r2 = -0.174280
Validation mse = 0.058700
Epoch 12
Loss = 2.4267e-01, PNorm = 34.7189, GNorm = 3.1689, lr_0 = 6.4027e-04
Loss = 2.0459e-01, PNorm = 34.7452, GNorm = 2.2497, lr_0 = 6.2102e-04
Validation rmse = 0.156236
Validation r2 = 0.511688
Validation mse = 0.024410
Epoch 13
Loss = 1.3301e-01, PNorm = 34.7731, GNorm = 2.2968, lr_0 = 6.0234e-04
Validation rmse = 0.183285
Validation r2 = 0.327966
Validation mse = 0.033594
Epoch 14
Loss = 1.3314e-01, PNorm = 34.7975, GNorm = 1.1884, lr_0 = 5.8422e-04
Validation rmse = 0.153789
Validation r2 = 0.526864
Validation mse = 0.023651
Epoch 15
Loss = 1.0702e-01, PNorm = 34.8195, GNorm = 1.3426, lr_0 = 5.6665e-04
Loss = 1.2817e-01, PNorm = 34.8376, GNorm = 2.8115, lr_0 = 5.4961e-04
Validation rmse = 0.169231
Validation r2 = 0.427080
Validation mse = 0.028639
Epoch 16
Loss = 1.3649e-01, PNorm = 34.8550, GNorm = 2.8638, lr_0 = 5.3308e-04
Validation rmse = 0.129866
Validation r2 = 0.662617
Validation mse = 0.016865
Epoch 17
Loss = 1.3947e-01, PNorm = 34.8730, GNorm = 2.4284, lr_0 = 5.1547e-04
Loss = 1.1473e-01, PNorm = 34.8906, GNorm = 2.6309, lr_0 = 4.9996e-04
Validation rmse = 0.143278
Validation r2 = 0.589330
Validation mse = 0.020529
Epoch 18
Loss = 1.1413e-01, PNorm = 34.9073, GNorm = 1.0374, lr_0 = 4.8493e-04
Validation rmse = 0.204108
Validation r2 = 0.166594
Validation mse = 0.041660
Epoch 19
Loss = 1.1843e-01, PNorm = 34.9207, GNorm = 2.3046, lr_0 = 4.7034e-04
Validation rmse = 0.143219
Validation r2 = 0.589665
Validation mse = 0.020512
Epoch 20
Loss = 9.8807e-02, PNorm = 34.9333, GNorm = 0.4289, lr_0 = 4.5620e-04
Loss = 1.1863e-01, PNorm = 34.9496, GNorm = 3.2178, lr_0 = 4.4247e-04
Validation rmse = 0.124824
Validation r2 = 0.688305
Validation mse = 0.015581
Epoch 21
Loss = 1.1868e-01, PNorm = 34.9624, GNorm = 0.4300, lr_0 = 4.2917e-04
Validation rmse = 0.163140
Validation r2 = 0.467579
Validation mse = 0.026615
Epoch 22
Loss = 1.1807e-01, PNorm = 34.9763, GNorm = 2.8664, lr_0 = 4.1626e-04
Loss = 1.0983e-01, PNorm = 34.9903, GNorm = 0.6083, lr_0 = 4.0374e-04
Validation rmse = 0.130821
Validation r2 = 0.657632
Validation mse = 0.017114
Epoch 23
Loss = 1.0843e-01, PNorm = 35.0006, GNorm = 1.7207, lr_0 = 3.9160e-04
Validation rmse = 0.171267
Validation r2 = 0.413212
Validation mse = 0.029332
Epoch 24
Loss = 1.2425e-01, PNorm = 35.0163, GNorm = 3.1660, lr_0 = 3.7982e-04
Validation rmse = 0.127889
Validation r2 = 0.672809
Validation mse = 0.016356
Epoch 25
Loss = 1.5209e-01, PNorm = 35.0295, GNorm = 3.0478, lr_0 = 3.6839e-04
Loss = 1.1385e-01, PNorm = 35.0418, GNorm = 1.8502, lr_0 = 3.5731e-04
Validation rmse = 0.164235
Validation r2 = 0.460406
Validation mse = 0.026973
Epoch 26
Loss = 9.8738e-02, PNorm = 35.0538, GNorm = 3.1130, lr_0 = 3.4657e-04
Validation rmse = 0.145801
Validation r2 = 0.574739
Validation mse = 0.021258
Epoch 27
Loss = 9.6293e-02, PNorm = 35.0656, GNorm = 0.5051, lr_0 = 3.3614e-04
Loss = 1.0343e-01, PNorm = 35.0777, GNorm = 1.2562, lr_0 = 3.2603e-04
Validation rmse = 0.131434
Validation r2 = 0.654421
Validation mse = 0.017275
Epoch 28
Loss = 9.9996e-02, PNorm = 35.0873, GNorm = 0.4981, lr_0 = 3.1623e-04
Validation rmse = 0.168979
Validation r2 = 0.428784
Validation mse = 0.028554
Epoch 29
Loss = 1.1378e-01, PNorm = 35.0973, GNorm = 1.8189, lr_0 = 3.0672e-04
Validation rmse = 0.135510
Validation r2 = 0.632652
Validation mse = 0.018363
Epoch 30
Loss = 9.2004e-02, PNorm = 35.1068, GNorm = 0.6781, lr_0 = 2.9749e-04
Loss = 9.3812e-02, PNorm = 35.1161, GNorm = 1.1682, lr_0 = 2.8854e-04
Validation rmse = 0.143654
Validation r2 = 0.587171
Validation mse = 0.020636
Epoch 31
Loss = 1.0871e-01, PNorm = 35.1270, GNorm = 1.8672, lr_0 = 2.7987e-04
Validation rmse = 0.174525
Validation r2 = 0.390670
Validation mse = 0.030459
Epoch 32
Loss = 9.8674e-02, PNorm = 35.1364, GNorm = 0.7303, lr_0 = 2.7145e-04
Loss = 1.1017e-01, PNorm = 35.1455, GNorm = 2.6415, lr_0 = 2.6328e-04
Validation rmse = 0.127769
Validation r2 = 0.673425
Validation mse = 0.016325
Epoch 33
Loss = 9.5886e-02, PNorm = 35.1556, GNorm = 0.9816, lr_0 = 2.5537e-04
Validation rmse = 0.144066
Validation r2 = 0.584800
Validation mse = 0.020755
Epoch 34
Loss = 7.8292e-02, PNorm = 35.1636, GNorm = 0.6581, lr_0 = 2.4693e-04
Validation rmse = 0.141364
Validation r2 = 0.600229
Validation mse = 0.019984
Epoch 35
Loss = 1.0231e-01, PNorm = 35.1731, GNorm = 1.4073, lr_0 = 2.3950e-04
Loss = 8.9536e-02, PNorm = 35.1805, GNorm = 0.6000, lr_0 = 2.3230e-04
Validation rmse = 0.141516
Validation r2 = 0.599370
Validation mse = 0.020027
Epoch 36
Loss = 8.1737e-02, PNorm = 35.1885, GNorm = 0.8129, lr_0 = 2.2531e-04
Validation rmse = 0.122278
Validation r2 = 0.700891
Validation mse = 0.014952
Epoch 37
Loss = 9.6812e-02, PNorm = 35.1953, GNorm = 1.2517, lr_0 = 2.1854e-04
Validation rmse = 0.150155
Validation r2 = 0.548958
Validation mse = 0.022547
Epoch 38
Loss = 9.9098e-02, PNorm = 35.2043, GNorm = 2.0291, lr_0 = 2.1196e-04
Loss = 8.6975e-02, PNorm = 35.2109, GNorm = 1.9514, lr_0 = 2.0559e-04
Validation rmse = 0.142626
Validation r2 = 0.593056
Validation mse = 0.020342
Epoch 39
Loss = 9.7249e-02, PNorm = 35.2193, GNorm = 1.3269, lr_0 = 1.9940e-04
Validation rmse = 0.134500
Validation r2 = 0.638107
Validation mse = 0.018090
Epoch 40
Loss = 1.0984e-01, PNorm = 35.2274, GNorm = 2.4191, lr_0 = 1.9341e-04
Loss = 8.6727e-02, PNorm = 35.2331, GNorm = 0.7262, lr_0 = 1.8759e-04
Validation rmse = 0.129658
Validation r2 = 0.663694
Validation mse = 0.016811
Epoch 41
Loss = 8.4498e-02, PNorm = 35.2398, GNorm = 0.9187, lr_0 = 1.8195e-04
Validation rmse = 0.144051
Validation r2 = 0.584885
Validation mse = 0.020751
Epoch 42
Loss = 8.5424e-02, PNorm = 35.2460, GNorm = 0.8702, lr_0 = 1.7648e-04
Validation rmse = 0.154391
Validation r2 = 0.523150
Validation mse = 0.023837
Epoch 43
Loss = 5.7947e-02, PNorm = 35.2515, GNorm = 1.4008, lr_0 = 1.7117e-04
Loss = 9.0764e-02, PNorm = 35.2585, GNorm = 0.8071, lr_0 = 1.6602e-04
Validation rmse = 0.140873
Validation r2 = 0.603002
Validation mse = 0.019845
Epoch 44
Loss = 7.5558e-02, PNorm = 35.2642, GNorm = 0.5564, lr_0 = 1.6103e-04
Validation rmse = 0.141151
Validation r2 = 0.601429
Validation mse = 0.019924
Epoch 45
Loss = 8.5893e-02, PNorm = 35.2705, GNorm = 0.8417, lr_0 = 1.5618e-04
Loss = 7.7653e-02, PNorm = 35.2763, GNorm = 0.8410, lr_0 = 1.5149e-04
Validation rmse = 0.129444
Validation r2 = 0.664805
Validation mse = 0.016756
Epoch 46
Loss = 8.5365e-02, PNorm = 35.2812, GNorm = 1.4243, lr_0 = 1.4693e-04
Validation rmse = 0.144754
Validation r2 = 0.580826
Validation mse = 0.020954
Epoch 47
Loss = 7.2865e-02, PNorm = 35.2873, GNorm = 0.9862, lr_0 = 1.4251e-04
Validation rmse = 0.126663
Validation r2 = 0.679054
Validation mse = 0.016043
Epoch 48
Loss = 1.0978e-01, PNorm = 35.2917, GNorm = 0.5673, lr_0 = 1.3822e-04
Loss = 8.0213e-02, PNorm = 35.2964, GNorm = 0.9020, lr_0 = 1.3407e-04
Validation rmse = 0.130845
Validation r2 = 0.657508
Validation mse = 0.017120
Epoch 49
Loss = 8.6828e-02, PNorm = 35.3016, GNorm = 0.7007, lr_0 = 1.3003e-04
Validation rmse = 0.147028
Validation r2 = 0.567550
Validation mse = 0.021617
Epoch 50
Loss = 7.8496e-02, PNorm = 35.3062, GNorm = 0.5695, lr_0 = 1.2612e-04
Loss = 8.4639e-02, PNorm = 35.3112, GNorm = 0.6793, lr_0 = 1.2233e-04
Loss = 6.6437e-02, PNorm = 35.3116, GNorm = 0.8240, lr_0 = 1.2196e-04
Validation rmse = 0.132719
Validation r2 = 0.647628
Validation mse = 0.017614
Epoch 51
Loss = 8.5521e-02, PNorm = 35.3151, GNorm = 3.0960, lr_0 = 1.1829e-04
Validation rmse = 0.122744
Validation r2 = 0.698607
Validation mse = 0.015066
Epoch 52
Loss = 8.7616e-02, PNorm = 35.3197, GNorm = 1.1312, lr_0 = 1.1473e-04
Validation rmse = 0.134910
Validation r2 = 0.635896
Validation mse = 0.018201
Epoch 53
Loss = 7.8243e-02, PNorm = 35.3241, GNorm = 0.4058, lr_0 = 1.1128e-04
Loss = 8.2340e-02, PNorm = 35.3279, GNorm = 0.9389, lr_0 = 1.0793e-04
Validation rmse = 0.142549
Validation r2 = 0.593498
Validation mse = 0.020320
Epoch 54
Loss = 7.6470e-02, PNorm = 35.3323, GNorm = 0.8603, lr_0 = 1.0469e-04
Validation rmse = 0.141110
Validation r2 = 0.601661
Validation mse = 0.019912
Epoch 55
Loss = 9.3535e-02, PNorm = 35.3356, GNorm = 0.8671, lr_0 = 1.0154e-04
Loss = 7.4588e-02, PNorm = 35.3392, GNorm = 0.5470, lr_0 = 1.0000e-04
Validation rmse = 0.139737
Validation r2 = 0.609374
Validation mse = 0.019527
Epoch 56
Loss = 8.0725e-02, PNorm = 35.3436, GNorm = 1.3797, lr_0 = 1.0000e-04
Validation rmse = 0.136172
Validation r2 = 0.629055
Validation mse = 0.018543
Epoch 57
Loss = 7.9599e-02, PNorm = 35.3474, GNorm = 1.5601, lr_0 = 1.0000e-04
Validation rmse = 0.140363
Validation r2 = 0.605871
Validation mse = 0.019702
Epoch 58
Loss = 8.7043e-02, PNorm = 35.3512, GNorm = 1.3480, lr_0 = 1.0000e-04
Loss = 8.3916e-02, PNorm = 35.3558, GNorm = 1.2070, lr_0 = 1.0000e-04
Validation rmse = 0.140066
Validation r2 = 0.607535
Validation mse = 0.019619
Epoch 59
Loss = 8.2318e-02, PNorm = 35.3597, GNorm = 0.7387, lr_0 = 1.0000e-04
Validation rmse = 0.151455
Validation r2 = 0.541119
Validation mse = 0.022938
Model 0 best validation rmse = 0.122278 on epoch 36
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.150310
Model 0 test r2 = 0.675666
Model 0 test mse = 0.022593
Ensemble test rmse = 0.150310
Ensemble test r2 = 0.675666
Ensemble test mse = 0.022593
Fold 4
Splitting data with seed 4
Total size = 705 | train size = 697 | val size = 8 | test size = 317
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.3219e-01, PNorm = 34.0181, GNorm = 1.0971, lr_0 = 4.8077e-04
Validation rmse = 0.382399
Validation r2 = -0.523176
Validation mse = 0.146229
Epoch 1
Loss = 7.4157e-01, PNorm = 34.0479, GNorm = 1.7160, lr_0 = 8.6154e-04
Validation rmse = 0.318557
Validation r2 = -0.057038
Validation mse = 0.101479
Epoch 2
Loss = 6.1234e-01, PNorm = 34.1075, GNorm = 7.1005, lr_0 = 9.8184e-04
Loss = 5.4697e-01, PNorm = 34.1761, GNorm = 6.1872, lr_0 = 9.5231e-04
Validation rmse = 0.274698
Validation r2 = 0.213994
Validation mse = 0.075459
Epoch 3
Loss = 4.4268e-01, PNorm = 34.2453, GNorm = 1.3838, lr_0 = 9.2367e-04
Validation rmse = 0.277141
Validation r2 = 0.199948
Validation mse = 0.076807
Epoch 4
Loss = 3.3579e-01, PNorm = 34.3085, GNorm = 1.0522, lr_0 = 8.9589e-04
Validation rmse = 0.237165
Validation r2 = 0.414108
Validation mse = 0.056247
Epoch 5
Loss = 2.9162e-01, PNorm = 34.3664, GNorm = 1.0499, lr_0 = 8.6894e-04
Loss = 2.7263e-01, PNorm = 34.4231, GNorm = 1.5038, lr_0 = 8.4281e-04
Validation rmse = 0.226422
Validation r2 = 0.465986
Validation mse = 0.051267
Epoch 6
Loss = 2.2872e-01, PNorm = 34.4845, GNorm = 1.5793, lr_0 = 8.1746e-04
Validation rmse = 0.182985
Validation r2 = 0.651225
Validation mse = 0.033483
Epoch 7
Loss = 2.0017e-01, PNorm = 34.5343, GNorm = 1.8827, lr_0 = 7.9287e-04
Loss = 2.3796e-01, PNorm = 34.5863, GNorm = 3.2838, lr_0 = 7.6903e-04
Validation rmse = 0.186192
Validation r2 = 0.638892
Validation mse = 0.034667
Epoch 8
Loss = 1.9291e-01, PNorm = 34.6253, GNorm = 1.7167, lr_0 = 7.4590e-04
Validation rmse = 0.173634
Validation r2 = 0.685962
Validation mse = 0.030149
Epoch 9
Loss = 1.5714e-01, PNorm = 34.6662, GNorm = 0.7435, lr_0 = 7.2346e-04
Validation rmse = 0.240412
Validation r2 = 0.397958
Validation mse = 0.057798
Epoch 10
Loss = 1.6280e-01, PNorm = 34.7034, GNorm = 4.7666, lr_0 = 7.0170e-04
Loss = 1.5151e-01, PNorm = 34.7407, GNorm = 1.1395, lr_0 = 6.8060e-04
Validation rmse = 0.173876
Validation r2 = 0.685084
Validation mse = 0.030233
Epoch 11
Loss = 1.3888e-01, PNorm = 34.7728, GNorm = 2.7975, lr_0 = 6.6013e-04
Validation rmse = 0.168109
Validation r2 = 0.705629
Validation mse = 0.028261
Epoch 12
Loss = 1.1693e-01, PNorm = 34.8029, GNorm = 3.7906, lr_0 = 6.4027e-04
Loss = 1.5045e-01, PNorm = 34.8309, GNorm = 1.4775, lr_0 = 6.2102e-04
Validation rmse = 0.212144
Validation r2 = 0.531210
Validation mse = 0.045005
Epoch 13
Loss = 1.2559e-01, PNorm = 34.8565, GNorm = 1.7440, lr_0 = 6.0234e-04
Validation rmse = 0.185788
Validation r2 = 0.640456
Validation mse = 0.034517
Epoch 14
Loss = 1.0937e-01, PNorm = 34.8761, GNorm = 3.3508, lr_0 = 5.8422e-04
Validation rmse = 0.174411
Validation r2 = 0.683145
Validation mse = 0.030419
Epoch 15
Loss = 1.5353e-01, PNorm = 34.8940, GNorm = 2.3687, lr_0 = 5.6665e-04
Loss = 1.1916e-01, PNorm = 34.9147, GNorm = 0.9478, lr_0 = 5.4961e-04
Validation rmse = 0.172464
Validation r2 = 0.690178
Validation mse = 0.029744
Epoch 16
Loss = 1.1265e-01, PNorm = 34.9287, GNorm = 2.3825, lr_0 = 5.3308e-04
Validation rmse = 0.176300
Validation r2 = 0.676244
Validation mse = 0.031082
Epoch 17
Loss = 1.1837e-01, PNorm = 34.9487, GNorm = 0.9450, lr_0 = 5.1547e-04
Loss = 1.2356e-01, PNorm = 34.9660, GNorm = 4.1979, lr_0 = 4.9996e-04
Validation rmse = 0.208632
Validation r2 = 0.546603
Validation mse = 0.043527
Epoch 18
Loss = 1.4056e-01, PNorm = 34.9880, GNorm = 1.3283, lr_0 = 4.8493e-04
Validation rmse = 0.218121
Validation r2 = 0.504422
Validation mse = 0.047577
Epoch 19
Loss = 1.2103e-01, PNorm = 35.0051, GNorm = 2.7725, lr_0 = 4.7034e-04
Validation rmse = 0.185036
Validation r2 = 0.643361
Validation mse = 0.034238
Epoch 20
Loss = 1.3010e-01, PNorm = 35.0195, GNorm = 1.7696, lr_0 = 4.5620e-04
Loss = 1.0814e-01, PNorm = 35.0357, GNorm = 1.6075, lr_0 = 4.4247e-04
Validation rmse = 0.160199
Validation r2 = 0.732677
Validation mse = 0.025664
Epoch 21
Loss = 1.1071e-01, PNorm = 35.0513, GNorm = 2.0796, lr_0 = 4.2917e-04
Validation rmse = 0.179455
Validation r2 = 0.664552
Validation mse = 0.032204
Epoch 22
Loss = 1.2076e-01, PNorm = 35.0628, GNorm = 2.2488, lr_0 = 4.1626e-04
Loss = 1.0620e-01, PNorm = 35.0764, GNorm = 1.0540, lr_0 = 4.0374e-04
Validation rmse = 0.189178
Validation r2 = 0.627218
Validation mse = 0.035788
Epoch 23
Loss = 1.0813e-01, PNorm = 35.0911, GNorm = 1.7218, lr_0 = 3.9160e-04
Validation rmse = 0.183359
Validation r2 = 0.649798
Validation mse = 0.033620
Epoch 24
Loss = 1.1348e-01, PNorm = 35.1038, GNorm = 1.6804, lr_0 = 3.7982e-04
Validation rmse = 0.160017
Validation r2 = 0.733285
Validation mse = 0.025605
Epoch 25
Loss = 9.6451e-02, PNorm = 35.1160, GNorm = 0.8262, lr_0 = 3.6839e-04
Loss = 1.1328e-01, PNorm = 35.1293, GNorm = 1.7160, lr_0 = 3.5731e-04
Validation rmse = 0.184664
Validation r2 = 0.644793
Validation mse = 0.034101
Epoch 26
Loss = 9.9020e-02, PNorm = 35.1402, GNorm = 2.2751, lr_0 = 3.4657e-04
Validation rmse = 0.179952
Validation r2 = 0.662689
Validation mse = 0.032383
Epoch 27
Loss = 9.1783e-02, PNorm = 35.1523, GNorm = 1.8441, lr_0 = 3.3614e-04
Loss = 1.0515e-01, PNorm = 35.1638, GNorm = 0.5568, lr_0 = 3.2603e-04
Validation rmse = 0.155237
Validation r2 = 0.748982
Validation mse = 0.024098
Epoch 28
Loss = 1.0995e-01, PNorm = 35.1754, GNorm = 2.2858, lr_0 = 3.1623e-04
Validation rmse = 0.186898
Validation r2 = 0.636148
Validation mse = 0.034931
Epoch 29
Loss = 9.2575e-02, PNorm = 35.1844, GNorm = 1.5017, lr_0 = 3.0672e-04
Validation rmse = 0.169825
Validation r2 = 0.699589
Validation mse = 0.028840
Epoch 30
Loss = 8.9072e-02, PNorm = 35.1940, GNorm = 1.5208, lr_0 = 2.9749e-04
Loss = 1.0105e-01, PNorm = 35.2035, GNorm = 0.6789, lr_0 = 2.8854e-04
Validation rmse = 0.181417
Validation r2 = 0.657177
Validation mse = 0.032912
Epoch 31
Loss = 9.4727e-02, PNorm = 35.2131, GNorm = 1.3819, lr_0 = 2.7987e-04
Validation rmse = 0.161002
Validation r2 = 0.729992
Validation mse = 0.025922
Epoch 32
Loss = 1.0232e-01, PNorm = 35.2220, GNorm = 1.6069, lr_0 = 2.7145e-04
Loss = 9.7158e-02, PNorm = 35.2314, GNorm = 1.5438, lr_0 = 2.6328e-04
Validation rmse = 0.187467
Validation r2 = 0.633930
Validation mse = 0.035144
Epoch 33
Loss = 9.8223e-02, PNorm = 35.2406, GNorm = 1.2246, lr_0 = 2.5537e-04
Validation rmse = 0.187664
Validation r2 = 0.633160
Validation mse = 0.035218
Epoch 34
Loss = 9.9493e-02, PNorm = 35.2504, GNorm = 0.8050, lr_0 = 2.4693e-04
Validation rmse = 0.173340
Validation r2 = 0.687021
Validation mse = 0.030047
Epoch 35
Loss = 7.6056e-02, PNorm = 35.2597, GNorm = 1.0380, lr_0 = 2.3950e-04
Loss = 9.7282e-02, PNorm = 35.2672, GNorm = 0.8512, lr_0 = 2.3230e-04
Validation rmse = 0.159587
Validation r2 = 0.734718
Validation mse = 0.025468
Epoch 36
Loss = 1.0033e-01, PNorm = 35.2766, GNorm = 1.1779, lr_0 = 2.2531e-04
Validation rmse = 0.176399
Validation r2 = 0.675880
Validation mse = 0.031116
Epoch 37
Loss = 8.4265e-02, PNorm = 35.2840, GNorm = 1.1526, lr_0 = 2.1854e-04
Validation rmse = 0.197705
Validation r2 = 0.592854
Validation mse = 0.039087
Epoch 38
Loss = 1.1691e-01, PNorm = 35.2921, GNorm = 1.1049, lr_0 = 2.1196e-04
Loss = 8.4780e-02, PNorm = 35.3004, GNorm = 0.6752, lr_0 = 2.0559e-04
Validation rmse = 0.180459
Validation r2 = 0.660786
Validation mse = 0.032565
Epoch 39
Loss = 8.4535e-02, PNorm = 35.3069, GNorm = 1.3790, lr_0 = 1.9940e-04
Validation rmse = 0.168065
Validation r2 = 0.705783
Validation mse = 0.028246
Epoch 40
Loss = 8.2843e-02, PNorm = 35.3152, GNorm = 0.6444, lr_0 = 1.9341e-04
Loss = 8.7932e-02, PNorm = 35.3205, GNorm = 1.6895, lr_0 = 1.8759e-04
Validation rmse = 0.183230
Validation r2 = 0.650288
Validation mse = 0.033573
Epoch 41
Loss = 8.2814e-02, PNorm = 35.3281, GNorm = 0.9685, lr_0 = 1.8195e-04
Validation rmse = 0.166990
Validation r2 = 0.709534
Validation mse = 0.027886
Epoch 42
Loss = 8.8352e-02, PNorm = 35.3344, GNorm = 1.1353, lr_0 = 1.7648e-04
Validation rmse = 0.165735
Validation r2 = 0.713882
Validation mse = 0.027468
Epoch 43
Loss = 7.6256e-02, PNorm = 35.3411, GNorm = 1.8218, lr_0 = 1.7117e-04
Loss = 8.0757e-02, PNorm = 35.3465, GNorm = 0.5821, lr_0 = 1.6602e-04
Validation rmse = 0.181247
Validation r2 = 0.657819
Validation mse = 0.032850
Epoch 44
Loss = 8.8081e-02, PNorm = 35.3533, GNorm = 0.5094, lr_0 = 1.6103e-04
Validation rmse = 0.170866
Validation r2 = 0.695893
Validation mse = 0.029195
Epoch 45
Loss = 8.6730e-02, PNorm = 35.3590, GNorm = 0.4789, lr_0 = 1.5618e-04
Loss = 7.8924e-02, PNorm = 35.3638, GNorm = 0.7313, lr_0 = 1.5149e-04
Validation rmse = 0.187400
Validation r2 = 0.634192
Validation mse = 0.035119
Epoch 46
Loss = 7.9579e-02, PNorm = 35.3698, GNorm = 0.7240, lr_0 = 1.4693e-04
Validation rmse = 0.160950
Validation r2 = 0.730165
Validation mse = 0.025905
Epoch 47
Loss = 7.6851e-02, PNorm = 35.3751, GNorm = 1.4473, lr_0 = 1.4251e-04
Validation rmse = 0.157164
Validation r2 = 0.742710
Validation mse = 0.024701
Epoch 48
Loss = 1.2959e-01, PNorm = 35.3807, GNorm = 3.1513, lr_0 = 1.3822e-04
Loss = 7.5026e-02, PNorm = 35.3866, GNorm = 1.1542, lr_0 = 1.3407e-04
Validation rmse = 0.167253
Validation r2 = 0.708618
Validation mse = 0.027974
Epoch 49
Loss = 7.4300e-02, PNorm = 35.3902, GNorm = 0.8329, lr_0 = 1.3003e-04
Validation rmse = 0.168828
Validation r2 = 0.703105
Validation mse = 0.028503
Epoch 50
Loss = 6.8067e-02, PNorm = 35.3956, GNorm = 0.5763, lr_0 = 1.2612e-04
Loss = 7.5519e-02, PNorm = 35.3990, GNorm = 0.4305, lr_0 = 1.2233e-04
Loss = 1.2125e-01, PNorm = 35.3995, GNorm = 0.9034, lr_0 = 1.2196e-04
Validation rmse = 0.177391
Validation r2 = 0.672223
Validation mse = 0.031468
Epoch 51
Loss = 7.6873e-02, PNorm = 35.4049, GNorm = 1.1414, lr_0 = 1.1829e-04
Validation rmse = 0.167360
Validation r2 = 0.708246
Validation mse = 0.028009
Epoch 52
Loss = 9.4148e-02, PNorm = 35.4090, GNorm = 0.9078, lr_0 = 1.1473e-04
Validation rmse = 0.168319
Validation r2 = 0.704890
Validation mse = 0.028331
Epoch 53
Loss = 4.6421e-02, PNorm = 35.4136, GNorm = 0.6726, lr_0 = 1.1128e-04
Loss = 8.2411e-02, PNorm = 35.4171, GNorm = 0.6212, lr_0 = 1.0793e-04
Validation rmse = 0.170784
Validation r2 = 0.696185
Validation mse = 0.029167
Epoch 54
Loss = 7.6681e-02, PNorm = 35.4208, GNorm = 0.6588, lr_0 = 1.0469e-04
Validation rmse = 0.176072
Validation r2 = 0.677080
Validation mse = 0.031001
Epoch 55
Loss = 5.4493e-02, PNorm = 35.4251, GNorm = 0.5040, lr_0 = 1.0154e-04
Loss = 8.4497e-02, PNorm = 35.4277, GNorm = 1.3840, lr_0 = 1.0000e-04
Validation rmse = 0.186243
Validation r2 = 0.638692
Validation mse = 0.034687
Epoch 56
Loss = 7.0867e-02, PNorm = 35.4324, GNorm = 0.5771, lr_0 = 1.0000e-04
Validation rmse = 0.180532
Validation r2 = 0.660514
Validation mse = 0.032592
Epoch 57
Loss = 8.6690e-02, PNorm = 35.4366, GNorm = 1.2453, lr_0 = 1.0000e-04
Validation rmse = 0.171579
Validation r2 = 0.693351
Validation mse = 0.029439
Epoch 58
Loss = 6.5591e-02, PNorm = 35.4400, GNorm = 0.6918, lr_0 = 1.0000e-04
Loss = 7.4894e-02, PNorm = 35.4434, GNorm = 1.2333, lr_0 = 1.0000e-04
Validation rmse = 0.184450
Validation r2 = 0.645615
Validation mse = 0.034022
Epoch 59
Loss = 7.7246e-02, PNorm = 35.4472, GNorm = 0.8168, lr_0 = 1.0000e-04
Validation rmse = 0.169172
Validation r2 = 0.701893
Validation mse = 0.028619
Model 0 best validation rmse = 0.155237 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.146861
Model 0 test r2 = 0.690379
Model 0 test mse = 0.021568
Ensemble test rmse = 0.146861
Ensemble test r2 = 0.690379
Ensemble test mse = 0.021568
Fold 5
Splitting data with seed 5
Total size = 705 | train size = 697 | val size = 8 | test size = 317
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.9136e-01, PNorm = 34.0159, GNorm = 1.1075, lr_0 = 4.8077e-04
Validation rmse = 0.305764
Validation r2 = 0.229373
Validation mse = 0.093491
Epoch 1
Loss = 8.4638e-01, PNorm = 34.0505, GNorm = 3.5575, lr_0 = 8.6154e-04
Validation rmse = 0.227629
Validation r2 = 0.572900
Validation mse = 0.051815
Epoch 2
Loss = 5.8287e-01, PNorm = 34.1180, GNorm = 3.2930, lr_0 = 9.8184e-04
Loss = 4.9440e-01, PNorm = 34.1899, GNorm = 4.4682, lr_0 = 9.5231e-04
Validation rmse = 0.211752
Validation r2 = 0.630402
Validation mse = 0.044839
Epoch 3
Loss = 3.8050e-01, PNorm = 34.2601, GNorm = 1.5843, lr_0 = 9.2367e-04
Validation rmse = 0.244341
Validation r2 = 0.507887
Validation mse = 0.059703
Epoch 4
Loss = 3.4950e-01, PNorm = 34.3223, GNorm = 1.4793, lr_0 = 8.9589e-04
Validation rmse = 0.272980
Validation r2 = 0.385765
Validation mse = 0.074518
Epoch 5
Loss = 4.1981e-01, PNorm = 34.3750, GNorm = 6.7806, lr_0 = 8.6894e-04
Loss = 2.8551e-01, PNorm = 34.4274, GNorm = 3.3443, lr_0 = 8.4281e-04
Validation rmse = 0.242770
Validation r2 = 0.514196
Validation mse = 0.058937
Epoch 6
Loss = 2.4175e-01, PNorm = 34.4719, GNorm = 1.0146, lr_0 = 8.1746e-04
Validation rmse = 0.207329
Validation r2 = 0.645683
Validation mse = 0.042985
Epoch 7
Loss = 2.5898e-01, PNorm = 34.5174, GNorm = 3.0069, lr_0 = 7.9287e-04
Loss = 2.0186e-01, PNorm = 34.5564, GNorm = 3.5666, lr_0 = 7.6903e-04
Validation rmse = 0.205351
Validation r2 = 0.652410
Validation mse = 0.042169
Epoch 8
Loss = 2.0547e-01, PNorm = 34.5949, GNorm = 5.1121, lr_0 = 7.4590e-04
Validation rmse = 0.208990
Validation r2 = 0.639983
Validation mse = 0.043677
Epoch 9
Loss = 1.9006e-01, PNorm = 34.6326, GNorm = 4.4865, lr_0 = 7.2346e-04
Validation rmse = 0.211387
Validation r2 = 0.631677
Validation mse = 0.044684
Epoch 10
Loss = 2.3265e-01, PNorm = 34.6712, GNorm = 4.9673, lr_0 = 7.0170e-04
Loss = 1.4600e-01, PNorm = 34.7057, GNorm = 2.5194, lr_0 = 6.8060e-04
Validation rmse = 0.174127
Validation r2 = 0.750077
Validation mse = 0.030320
Epoch 11
Loss = 1.3423e-01, PNorm = 34.7377, GNorm = 1.8976, lr_0 = 6.6013e-04
Validation rmse = 0.162664
Validation r2 = 0.781900
Validation mse = 0.026460
Epoch 12
Loss = 1.2635e-01, PNorm = 34.7669, GNorm = 3.2460, lr_0 = 6.4027e-04
Loss = 1.5890e-01, PNorm = 34.7922, GNorm = 2.6574, lr_0 = 6.2102e-04
Validation rmse = 0.154559
Validation r2 = 0.803094
Validation mse = 0.023888
Epoch 13
Loss = 1.7651e-01, PNorm = 34.8184, GNorm = 0.8204, lr_0 = 6.0234e-04
Validation rmse = 0.156370
Validation r2 = 0.798451
Validation mse = 0.024452
Epoch 14
Loss = 1.3618e-01, PNorm = 34.8467, GNorm = 4.0429, lr_0 = 5.8422e-04
Validation rmse = 0.157695
Validation r2 = 0.795021
Validation mse = 0.024868
Epoch 15
Loss = 1.1449e-01, PNorm = 34.8701, GNorm = 1.2507, lr_0 = 5.6665e-04
Loss = 1.3578e-01, PNorm = 34.8916, GNorm = 1.4130, lr_0 = 5.4961e-04
Validation rmse = 0.208636
Validation r2 = 0.641202
Validation mse = 0.043529
Epoch 16
Loss = 1.2681e-01, PNorm = 34.9099, GNorm = 3.2179, lr_0 = 5.3308e-04
Validation rmse = 0.174392
Validation r2 = 0.749316
Validation mse = 0.030413
Epoch 17
Loss = 1.1462e-01, PNorm = 34.9312, GNorm = 1.3539, lr_0 = 5.1547e-04
Loss = 1.2155e-01, PNorm = 34.9512, GNorm = 1.9944, lr_0 = 4.9996e-04
Validation rmse = 0.172364
Validation r2 = 0.755114
Validation mse = 0.029709
Epoch 18
Loss = 1.0934e-01, PNorm = 34.9647, GNorm = 1.0470, lr_0 = 4.8493e-04
Validation rmse = 0.164523
Validation r2 = 0.776886
Validation mse = 0.027068
Epoch 19
Loss = 1.0974e-01, PNorm = 34.9823, GNorm = 3.2518, lr_0 = 4.7034e-04
Validation rmse = 0.214280
Validation r2 = 0.621525
Validation mse = 0.045916
Epoch 20
Loss = 1.3004e-01, PNorm = 34.9972, GNorm = 2.2694, lr_0 = 4.5620e-04
Loss = 1.1605e-01, PNorm = 35.0141, GNorm = 1.9535, lr_0 = 4.4247e-04
Validation rmse = 0.171712
Validation r2 = 0.756963
Validation mse = 0.029485
Epoch 21
Loss = 1.0916e-01, PNorm = 35.0307, GNorm = 2.6776, lr_0 = 4.2917e-04
Validation rmse = 0.164744
Validation r2 = 0.776288
Validation mse = 0.027140
Epoch 22
Loss = 1.2063e-01, PNorm = 35.0473, GNorm = 0.8964, lr_0 = 4.1626e-04
Loss = 1.0551e-01, PNorm = 35.0606, GNorm = 1.6882, lr_0 = 4.0374e-04
Validation rmse = 0.176297
Validation r2 = 0.743810
Validation mse = 0.031081
Epoch 23
Loss = 1.0042e-01, PNorm = 35.0746, GNorm = 0.9312, lr_0 = 3.9160e-04
Validation rmse = 0.163022
Validation r2 = 0.780939
Validation mse = 0.026576
Epoch 24
Loss = 8.7137e-02, PNorm = 35.0872, GNorm = 0.8428, lr_0 = 3.7982e-04
Validation rmse = 0.155569
Validation r2 = 0.800511
Validation mse = 0.024202
Epoch 25
Loss = 1.0161e-01, PNorm = 35.1009, GNorm = 1.2324, lr_0 = 3.6839e-04
Loss = 9.9231e-02, PNorm = 35.1121, GNorm = 0.6189, lr_0 = 3.5731e-04
Validation rmse = 0.165992
Validation r2 = 0.772885
Validation mse = 0.027553
Epoch 26
Loss = 9.9888e-02, PNorm = 35.1257, GNorm = 1.4475, lr_0 = 3.4657e-04
Validation rmse = 0.173535
Validation r2 = 0.751775
Validation mse = 0.030114
Epoch 27
Loss = 9.7239e-02, PNorm = 35.1382, GNorm = 0.4532, lr_0 = 3.3614e-04
Loss = 9.5935e-02, PNorm = 35.1496, GNorm = 1.0621, lr_0 = 3.2603e-04
Validation rmse = 0.181663
Validation r2 = 0.727978
Validation mse = 0.033001
Epoch 28
Loss = 1.0322e-01, PNorm = 35.1628, GNorm = 2.2244, lr_0 = 3.1623e-04
Validation rmse = 0.154401
Validation r2 = 0.803494
Validation mse = 0.023840
Epoch 29
Loss = 9.5159e-02, PNorm = 35.1729, GNorm = 2.5480, lr_0 = 3.0672e-04
Validation rmse = 0.200867
Validation r2 = 0.667424
Validation mse = 0.040348
Epoch 30
Loss = 8.5782e-02, PNorm = 35.1833, GNorm = 1.3943, lr_0 = 2.9749e-04
Loss = 9.6243e-02, PNorm = 35.1946, GNorm = 0.6894, lr_0 = 2.8854e-04
Validation rmse = 0.152921
Validation r2 = 0.807245
Validation mse = 0.023385
Epoch 31
Loss = 8.0475e-02, PNorm = 35.2020, GNorm = 1.0450, lr_0 = 2.7987e-04
Validation rmse = 0.183229
Validation r2 = 0.723267
Validation mse = 0.033573
Epoch 32
Loss = 1.2017e-01, PNorm = 35.2121, GNorm = 1.7473, lr_0 = 2.7145e-04
Loss = 8.2016e-02, PNorm = 35.2223, GNorm = 1.7552, lr_0 = 2.6328e-04
Validation rmse = 0.170228
Validation r2 = 0.761146
Validation mse = 0.028977
Epoch 33
Loss = 8.7351e-02, PNorm = 35.2311, GNorm = 2.2515, lr_0 = 2.5537e-04
Validation rmse = 0.156910
Validation r2 = 0.797057
Validation mse = 0.024621
Epoch 34
Loss = 8.6881e-02, PNorm = 35.2412, GNorm = 1.0519, lr_0 = 2.4693e-04
Validation rmse = 0.175986
Validation r2 = 0.744714
Validation mse = 0.030971
Epoch 35
Loss = 9.7313e-02, PNorm = 35.2508, GNorm = 0.5899, lr_0 = 2.3950e-04
Loss = 8.7049e-02, PNorm = 35.2587, GNorm = 1.0743, lr_0 = 2.3230e-04
Validation rmse = 0.173011
Validation r2 = 0.753270
Validation mse = 0.029933
Epoch 36
Loss = 8.9602e-02, PNorm = 35.2670, GNorm = 0.7159, lr_0 = 2.2531e-04
Validation rmse = 0.171393
Validation r2 = 0.757863
Validation mse = 0.029376
Epoch 37
Loss = 9.5982e-02, PNorm = 35.2745, GNorm = 1.2391, lr_0 = 2.1854e-04
Validation rmse = 0.179469
Validation r2 = 0.734508
Validation mse = 0.032209
Epoch 38
Loss = 6.9269e-02, PNorm = 35.2838, GNorm = 2.3062, lr_0 = 2.1196e-04
Loss = 9.0651e-02, PNorm = 35.2914, GNorm = 0.9024, lr_0 = 2.0559e-04
Validation rmse = 0.171561
Validation r2 = 0.757389
Validation mse = 0.029433
Epoch 39
Loss = 8.3603e-02, PNorm = 35.2987, GNorm = 0.9331, lr_0 = 1.9940e-04
Validation rmse = 0.156900
Validation r2 = 0.797082
Validation mse = 0.024618
Epoch 40
Loss = 7.4345e-02, PNorm = 35.3051, GNorm = 1.6183, lr_0 = 1.9341e-04
Loss = 8.9039e-02, PNorm = 35.3121, GNorm = 1.0134, lr_0 = 1.8759e-04
Validation rmse = 0.164730
Validation r2 = 0.776325
Validation mse = 0.027136
Epoch 41
Loss = 8.2683e-02, PNorm = 35.3204, GNorm = 0.9113, lr_0 = 1.8195e-04
Validation rmse = 0.160544
Validation r2 = 0.787548
Validation mse = 0.025774
Epoch 42
Loss = 7.6373e-02, PNorm = 35.3260, GNorm = 1.1154, lr_0 = 1.7648e-04
Validation rmse = 0.167596
Validation r2 = 0.768475
Validation mse = 0.028088
Epoch 43
Loss = 9.0274e-02, PNorm = 35.3330, GNorm = 0.7299, lr_0 = 1.7117e-04
Loss = 8.3614e-02, PNorm = 35.3404, GNorm = 0.7366, lr_0 = 1.6602e-04
Validation rmse = 0.177510
Validation r2 = 0.740273
Validation mse = 0.031510
Epoch 44
Loss = 7.3356e-02, PNorm = 35.3461, GNorm = 0.8410, lr_0 = 1.6103e-04
Validation rmse = 0.164222
Validation r2 = 0.777701
Validation mse = 0.026969
Epoch 45
Loss = 6.1519e-02, PNorm = 35.3523, GNorm = 1.9032, lr_0 = 1.5618e-04
Loss = 8.5853e-02, PNorm = 35.3581, GNorm = 0.8543, lr_0 = 1.5149e-04
Validation rmse = 0.172965
Validation r2 = 0.753402
Validation mse = 0.029917
Epoch 46
Loss = 7.6786e-02, PNorm = 35.3637, GNorm = 0.7471, lr_0 = 1.4693e-04
Validation rmse = 0.162648
Validation r2 = 0.781944
Validation mse = 0.026454
Epoch 47
Loss = 7.4036e-02, PNorm = 35.3694, GNorm = 1.3506, lr_0 = 1.4251e-04
Validation rmse = 0.170849
Validation r2 = 0.759398
Validation mse = 0.029190
Epoch 48
Loss = 6.6742e-02, PNorm = 35.3732, GNorm = 1.2848, lr_0 = 1.3822e-04
Loss = 8.4795e-02, PNorm = 35.3796, GNorm = 1.4067, lr_0 = 1.3407e-04
Validation rmse = 0.157657
Validation r2 = 0.795120
Validation mse = 0.024856
Epoch 49
Loss = 8.2520e-02, PNorm = 35.3842, GNorm = 0.7148, lr_0 = 1.3003e-04
Validation rmse = 0.170570
Validation r2 = 0.760184
Validation mse = 0.029094
Epoch 50
Loss = 7.8694e-02, PNorm = 35.3889, GNorm = 0.6920, lr_0 = 1.2612e-04
Loss = 8.0651e-02, PNorm = 35.3936, GNorm = 0.4089, lr_0 = 1.2233e-04
Loss = 5.8033e-02, PNorm = 35.3941, GNorm = 1.2563, lr_0 = 1.2196e-04
Validation rmse = 0.169435
Validation r2 = 0.763365
Validation mse = 0.028708
Epoch 51
Loss = 7.8827e-02, PNorm = 35.3987, GNorm = 1.1037, lr_0 = 1.1829e-04
Validation rmse = 0.162260
Validation r2 = 0.782983
Validation mse = 0.026328
Epoch 52
Loss = 7.6197e-02, PNorm = 35.4034, GNorm = 0.4271, lr_0 = 1.1473e-04
Validation rmse = 0.162741
Validation r2 = 0.781694
Validation mse = 0.026485
Epoch 53
Loss = 8.3454e-02, PNorm = 35.4078, GNorm = 0.9331, lr_0 = 1.1128e-04
Loss = 7.4202e-02, PNorm = 35.4117, GNorm = 1.3644, lr_0 = 1.0793e-04
Validation rmse = 0.172766
Validation r2 = 0.753970
Validation mse = 0.029848
Epoch 54
Loss = 6.9412e-02, PNorm = 35.4157, GNorm = 1.4344, lr_0 = 1.0469e-04
Validation rmse = 0.173630
Validation r2 = 0.751502
Validation mse = 0.030147
Epoch 55
Loss = 8.9227e-02, PNorm = 35.4192, GNorm = 1.7801, lr_0 = 1.0154e-04
Loss = 7.0152e-02, PNorm = 35.4231, GNorm = 0.8442, lr_0 = 1.0000e-04
Validation rmse = 0.171239
Validation r2 = 0.758298
Validation mse = 0.029323
Epoch 56
Loss = 7.4450e-02, PNorm = 35.4264, GNorm = 1.8328, lr_0 = 1.0000e-04
Validation rmse = 0.168692
Validation r2 = 0.765437
Validation mse = 0.028457
Epoch 57
Loss = 7.0964e-02, PNorm = 35.4308, GNorm = 0.5273, lr_0 = 1.0000e-04
Validation rmse = 0.170381
Validation r2 = 0.760715
Validation mse = 0.029030
Epoch 58
Loss = 7.3679e-02, PNorm = 35.4350, GNorm = 0.7182, lr_0 = 1.0000e-04
Loss = 7.7276e-02, PNorm = 35.4389, GNorm = 0.7015, lr_0 = 1.0000e-04
Validation rmse = 0.170386
Validation r2 = 0.760701
Validation mse = 0.029031
Epoch 59
Loss = 7.1181e-02, PNorm = 35.4421, GNorm = 0.5222, lr_0 = 1.0000e-04
Validation rmse = 0.170485
Validation r2 = 0.760422
Validation mse = 0.029065
Model 0 best validation rmse = 0.152921 on epoch 30
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.190110
Model 0 test r2 = 0.481171
Model 0 test mse = 0.036142
Ensemble test rmse = 0.190110
Ensemble test r2 = 0.481171
Ensemble test mse = 0.036142
Fold 6
Splitting data with seed 6
Total size = 705 | train size = 697 | val size = 8 | test size = 317
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.6093e-01, PNorm = 34.0163, GNorm = 5.0063, lr_0 = 4.8077e-04
Validation rmse = 0.337453
Validation r2 = -0.742845
Validation mse = 0.113875
Epoch 1
Loss = 7.1876e-01, PNorm = 34.0528, GNorm = 4.1345, lr_0 = 8.6154e-04
Validation rmse = 0.182540
Validation r2 = 0.490026
Validation mse = 0.033321
Epoch 2
Loss = 6.3383e-01, PNorm = 34.1205, GNorm = 5.6662, lr_0 = 9.8184e-04
Loss = 3.9571e-01, PNorm = 34.1995, GNorm = 2.9925, lr_0 = 9.5231e-04
Validation rmse = 0.129646
Validation r2 = 0.742753
Validation mse = 0.016808
Epoch 3
Loss = 3.3307e-01, PNorm = 34.2627, GNorm = 1.9127, lr_0 = 9.2367e-04
Validation rmse = 0.109869
Validation r2 = 0.815250
Validation mse = 0.012071
Epoch 4
Loss = 2.9408e-01, PNorm = 34.3221, GNorm = 1.5401, lr_0 = 8.9589e-04
Validation rmse = 0.115782
Validation r2 = 0.794830
Validation mse = 0.013405
Epoch 5
Loss = 2.5033e-01, PNorm = 34.3767, GNorm = 3.0084, lr_0 = 8.6894e-04
Loss = 2.2230e-01, PNorm = 34.4210, GNorm = 2.0307, lr_0 = 8.4281e-04
Validation rmse = 0.120102
Validation r2 = 0.779234
Validation mse = 0.014424
Epoch 6
Loss = 2.2331e-01, PNorm = 34.4611, GNorm = 1.8579, lr_0 = 8.1746e-04
Validation rmse = 0.118401
Validation r2 = 0.785444
Validation mse = 0.014019
Epoch 7
Loss = 1.6806e-01, PNorm = 34.5041, GNorm = 1.0943, lr_0 = 7.9287e-04
Loss = 2.1273e-01, PNorm = 34.5397, GNorm = 5.5074, lr_0 = 7.6903e-04
Validation rmse = 0.083386
Validation r2 = 0.893582
Validation mse = 0.006953
Epoch 8
Loss = 1.7538e-01, PNorm = 34.5708, GNorm = 3.8061, lr_0 = 7.4590e-04
Validation rmse = 0.107896
Validation r2 = 0.821826
Validation mse = 0.011642
Epoch 9
Loss = 1.3261e-01, PNorm = 34.6045, GNorm = 6.9135, lr_0 = 7.2346e-04
Validation rmse = 0.065051
Validation r2 = 0.935236
Validation mse = 0.004232
Epoch 10
Loss = 9.7642e-02, PNorm = 34.6351, GNorm = 1.3537, lr_0 = 7.0170e-04
Loss = 1.4778e-01, PNorm = 34.6629, GNorm = 1.3388, lr_0 = 6.8060e-04
Validation rmse = 0.060773
Validation r2 = 0.943473
Validation mse = 0.003693
Epoch 11
Loss = 1.5250e-01, PNorm = 34.6883, GNorm = 6.4570, lr_0 = 6.6013e-04
Validation rmse = 0.073469
Validation r2 = 0.917389
Validation mse = 0.005398
Epoch 12
Loss = 1.3335e-01, PNorm = 34.7138, GNorm = 1.0421, lr_0 = 6.4027e-04
Loss = 1.4540e-01, PNorm = 34.7393, GNorm = 2.8980, lr_0 = 6.2102e-04
Validation rmse = 0.121656
Validation r2 = 0.773484
Validation mse = 0.014800
Epoch 13
Loss = 1.2693e-01, PNorm = 34.7618, GNorm = 1.9468, lr_0 = 6.0234e-04
Validation rmse = 0.087902
Validation r2 = 0.881742
Validation mse = 0.007727
Epoch 14
Loss = 1.2918e-01, PNorm = 34.7796, GNorm = 2.8780, lr_0 = 5.8422e-04
Validation rmse = 0.081511
Validation r2 = 0.898314
Validation mse = 0.006644
Epoch 15
Loss = 9.7304e-02, PNorm = 34.7989, GNorm = 2.6059, lr_0 = 5.6665e-04
Loss = 1.3843e-01, PNorm = 34.8153, GNorm = 0.7489, lr_0 = 5.4961e-04
Validation rmse = 0.082816
Validation r2 = 0.895031
Validation mse = 0.006859
Epoch 16
Loss = 1.4054e-01, PNorm = 34.8323, GNorm = 2.0209, lr_0 = 5.3308e-04
Validation rmse = 0.065019
Validation r2 = 0.935299
Validation mse = 0.004227
Epoch 17
Loss = 1.3510e-01, PNorm = 34.8528, GNorm = 1.7819, lr_0 = 5.1547e-04
Loss = 1.1741e-01, PNorm = 34.8676, GNorm = 1.6455, lr_0 = 4.9996e-04
Validation rmse = 0.056796
Validation r2 = 0.950630
Validation mse = 0.003226
Epoch 18
Loss = 1.1363e-01, PNorm = 34.8817, GNorm = 2.5172, lr_0 = 4.8493e-04
Validation rmse = 0.052300
Validation r2 = 0.958137
Validation mse = 0.002735
Epoch 19
Loss = 1.1005e-01, PNorm = 34.8941, GNorm = 0.5847, lr_0 = 4.7034e-04
Validation rmse = 0.060374
Validation r2 = 0.944213
Validation mse = 0.003645
Epoch 20
Loss = 9.6725e-02, PNorm = 34.9083, GNorm = 0.7896, lr_0 = 4.5620e-04
Loss = 1.2260e-01, PNorm = 34.9220, GNorm = 1.4173, lr_0 = 4.4247e-04
Validation rmse = 0.059050
Validation r2 = 0.946634
Validation mse = 0.003487
Epoch 21
Loss = 1.1054e-01, PNorm = 34.9336, GNorm = 1.1617, lr_0 = 4.2917e-04
Validation rmse = 0.039652
Validation r2 = 0.975937
Validation mse = 0.001572
Epoch 22
Loss = 1.0813e-01, PNorm = 34.9459, GNorm = 1.4002, lr_0 = 4.1626e-04
Loss = 1.0885e-01, PNorm = 34.9593, GNorm = 4.8556, lr_0 = 4.0374e-04
Validation rmse = 0.055492
Validation r2 = 0.952871
Validation mse = 0.003079
Epoch 23
Loss = 1.1303e-01, PNorm = 34.9709, GNorm = 2.8068, lr_0 = 3.9160e-04
Validation rmse = 0.058699
Validation r2 = 0.947266
Validation mse = 0.003446
Epoch 24
Loss = 1.1619e-01, PNorm = 34.9846, GNorm = 0.5962, lr_0 = 3.7982e-04
Validation rmse = 0.062097
Validation r2 = 0.940984
Validation mse = 0.003856
Epoch 25
Loss = 1.4735e-01, PNorm = 34.9963, GNorm = 2.3870, lr_0 = 3.6839e-04
Loss = 1.1177e-01, PNorm = 35.0080, GNorm = 2.6788, lr_0 = 3.5731e-04
Validation rmse = 0.039758
Validation r2 = 0.975808
Validation mse = 0.001581
Epoch 26
Loss = 1.0009e-01, PNorm = 35.0200, GNorm = 1.0569, lr_0 = 3.4657e-04
Validation rmse = 0.047283
Validation r2 = 0.965783
Validation mse = 0.002236
Epoch 27
Loss = 9.5471e-02, PNorm = 35.0302, GNorm = 0.6664, lr_0 = 3.3614e-04
Loss = 9.9791e-02, PNorm = 35.0419, GNorm = 1.6878, lr_0 = 3.2603e-04
Validation rmse = 0.051061
Validation r2 = 0.960097
Validation mse = 0.002607
Epoch 28
Loss = 1.2220e-01, PNorm = 35.0531, GNorm = 2.5133, lr_0 = 3.1623e-04
Validation rmse = 0.059300
Validation r2 = 0.946181
Validation mse = 0.003516
Epoch 29
Loss = 1.0795e-01, PNorm = 35.0615, GNorm = 0.8046, lr_0 = 3.0672e-04
Validation rmse = 0.055779
Validation r2 = 0.952382
Validation mse = 0.003111
Epoch 30
Loss = 6.9989e-02, PNorm = 35.0741, GNorm = 0.5848, lr_0 = 2.9749e-04
Loss = 1.1013e-01, PNorm = 35.0815, GNorm = 1.2684, lr_0 = 2.8854e-04
Validation rmse = 0.054736
Validation r2 = 0.954146
Validation mse = 0.002996
Epoch 31
Loss = 9.8358e-02, PNorm = 35.0918, GNorm = 0.6821, lr_0 = 2.7987e-04
Validation rmse = 0.055941
Validation r2 = 0.952105
Validation mse = 0.003129
Epoch 32
Loss = 1.1658e-01, PNorm = 35.1009, GNorm = 1.2365, lr_0 = 2.7145e-04
Loss = 8.7134e-02, PNorm = 35.1105, GNorm = 1.6867, lr_0 = 2.6328e-04
Validation rmse = 0.039896
Validation r2 = 0.975640
Validation mse = 0.001592
Epoch 33
Loss = 8.8544e-02, PNorm = 35.1199, GNorm = 1.2341, lr_0 = 2.5537e-04
Validation rmse = 0.039371
Validation r2 = 0.976276
Validation mse = 0.001550
Epoch 34
Loss = 9.6263e-02, PNorm = 35.1271, GNorm = 2.5434, lr_0 = 2.4693e-04
Validation rmse = 0.046847
Validation r2 = 0.966411
Validation mse = 0.002195
Epoch 35
Loss = 1.0276e-01, PNorm = 35.1359, GNorm = 2.0928, lr_0 = 2.3950e-04
Loss = 9.1682e-02, PNorm = 35.1428, GNorm = 0.5569, lr_0 = 2.3230e-04
Validation rmse = 0.031350
Validation r2 = 0.984958
Validation mse = 0.000983
Epoch 36
Loss = 9.0827e-02, PNorm = 35.1514, GNorm = 0.6125, lr_0 = 2.2531e-04
Validation rmse = 0.055556
Validation r2 = 0.952762
Validation mse = 0.003086
Epoch 37
Loss = 9.4512e-02, PNorm = 35.1567, GNorm = 1.5415, lr_0 = 2.1854e-04
Validation rmse = 0.053674
Validation r2 = 0.955908
Validation mse = 0.002881
Epoch 38
Loss = 1.1712e-01, PNorm = 35.1646, GNorm = 1.3696, lr_0 = 2.1196e-04
Loss = 9.3689e-02, PNorm = 35.1716, GNorm = 2.0735, lr_0 = 2.0559e-04
Validation rmse = 0.040658
Validation r2 = 0.974700
Validation mse = 0.001653
Epoch 39
Loss = 8.4176e-02, PNorm = 35.1776, GNorm = 0.4839, lr_0 = 1.9940e-04
Validation rmse = 0.046553
Validation r2 = 0.966832
Validation mse = 0.002167
Epoch 40
Loss = 7.7978e-02, PNorm = 35.1844, GNorm = 0.8147, lr_0 = 1.9341e-04
Loss = 8.8326e-02, PNorm = 35.1896, GNorm = 0.5812, lr_0 = 1.8759e-04
Validation rmse = 0.038967
Validation r2 = 0.976760
Validation mse = 0.001518
Epoch 41
Loss = 9.0488e-02, PNorm = 35.1978, GNorm = 0.9582, lr_0 = 1.8195e-04
Validation rmse = 0.042685
Validation r2 = 0.972114
Validation mse = 0.001822
Epoch 42
Loss = 9.1591e-02, PNorm = 35.2033, GNorm = 1.3810, lr_0 = 1.7648e-04
Validation rmse = 0.038936
Validation r2 = 0.976797
Validation mse = 0.001516
Epoch 43
Loss = 7.8849e-02, PNorm = 35.2090, GNorm = 0.6496, lr_0 = 1.7117e-04
Loss = 8.1029e-02, PNorm = 35.2161, GNorm = 0.6624, lr_0 = 1.6602e-04
Validation rmse = 0.045361
Validation r2 = 0.968508
Validation mse = 0.002058
Epoch 44
Loss = 9.3547e-02, PNorm = 35.2203, GNorm = 0.6104, lr_0 = 1.6103e-04
Validation rmse = 0.046349
Validation r2 = 0.967122
Validation mse = 0.002148
Epoch 45
Loss = 8.8381e-02, PNorm = 35.2262, GNorm = 2.3654, lr_0 = 1.5618e-04
Loss = 9.0396e-02, PNorm = 35.2311, GNorm = 3.1369, lr_0 = 1.5149e-04
Validation rmse = 0.048330
Validation r2 = 0.964251
Validation mse = 0.002336
Epoch 46
Loss = 8.4009e-02, PNorm = 35.2370, GNorm = 1.3521, lr_0 = 1.4693e-04
Validation rmse = 0.056086
Validation r2 = 0.951856
Validation mse = 0.003146
Epoch 47
Loss = 8.4145e-02, PNorm = 35.2424, GNorm = 1.1270, lr_0 = 1.4251e-04
Validation rmse = 0.036878
Validation r2 = 0.979185
Validation mse = 0.001360
Epoch 48
Loss = 1.2999e-01, PNorm = 35.2467, GNorm = 3.1755, lr_0 = 1.3822e-04
Loss = 7.6000e-02, PNorm = 35.2515, GNorm = 0.7339, lr_0 = 1.3407e-04
Validation rmse = 0.043269
Validation r2 = 0.971347
Validation mse = 0.001872
Epoch 49
Loss = 7.5053e-02, PNorm = 35.2561, GNorm = 2.0232, lr_0 = 1.3003e-04
Validation rmse = 0.040982
Validation r2 = 0.974296
Validation mse = 0.001679
Epoch 50
Loss = 8.1020e-02, PNorm = 35.2605, GNorm = 1.5458, lr_0 = 1.2612e-04
Loss = 8.2609e-02, PNorm = 35.2649, GNorm = 3.2941, lr_0 = 1.2233e-04
Loss = 8.5391e-02, PNorm = 35.2655, GNorm = 0.7685, lr_0 = 1.2196e-04
Validation rmse = 0.039821
Validation r2 = 0.975731
Validation mse = 0.001586
Epoch 51
Loss = 7.7200e-02, PNorm = 35.2699, GNorm = 0.7337, lr_0 = 1.1829e-04
Validation rmse = 0.042215
Validation r2 = 0.972725
Validation mse = 0.001782
Epoch 52
Loss = 7.1360e-02, PNorm = 35.2739, GNorm = 0.6713, lr_0 = 1.1473e-04
Validation rmse = 0.043010
Validation r2 = 0.971688
Validation mse = 0.001850
Epoch 53
Loss = 7.8249e-02, PNorm = 35.2776, GNorm = 1.1371, lr_0 = 1.1128e-04
Loss = 8.7352e-02, PNorm = 35.2815, GNorm = 1.3444, lr_0 = 1.0793e-04
Validation rmse = 0.047415
Validation r2 = 0.965591
Validation mse = 0.002248
Epoch 54
Loss = 8.2058e-02, PNorm = 35.2856, GNorm = 1.6069, lr_0 = 1.0469e-04
Validation rmse = 0.042731
Validation r2 = 0.972054
Validation mse = 0.001826
Epoch 55
Loss = 8.0060e-02, PNorm = 35.2900, GNorm = 0.4831, lr_0 = 1.0154e-04
Loss = 7.8836e-02, PNorm = 35.2935, GNorm = 0.7587, lr_0 = 1.0000e-04
Validation rmse = 0.039407
Validation r2 = 0.976233
Validation mse = 0.001553
Epoch 56
Loss = 7.8381e-02, PNorm = 35.2964, GNorm = 1.0630, lr_0 = 1.0000e-04
Validation rmse = 0.041927
Validation r2 = 0.973095
Validation mse = 0.001758
Epoch 57
Loss = 8.5370e-02, PNorm = 35.3001, GNorm = 1.9181, lr_0 = 1.0000e-04
Validation rmse = 0.047804
Validation r2 = 0.965025
Validation mse = 0.002285
Epoch 58
Loss = 9.0565e-02, PNorm = 35.3033, GNorm = 1.6734, lr_0 = 1.0000e-04
Loss = 8.5713e-02, PNorm = 35.3070, GNorm = 3.0632, lr_0 = 1.0000e-04
Validation rmse = 0.041406
Validation r2 = 0.973760
Validation mse = 0.001714
Epoch 59
Loss = 8.1432e-02, PNorm = 35.3112, GNorm = 1.9303, lr_0 = 1.0000e-04
Validation rmse = 0.042391
Validation r2 = 0.972497
Validation mse = 0.001797
Model 0 best validation rmse = 0.031350 on epoch 35
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.161231
Model 0 test r2 = 0.626824
Model 0 test mse = 0.025996
Ensemble test rmse = 0.161231
Ensemble test r2 = 0.626824
Ensemble test mse = 0.025996
Fold 7
Splitting data with seed 7
Total size = 705 | train size = 697 | val size = 8 | test size = 317
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.9095e-01, PNorm = 34.0186, GNorm = 3.6357, lr_0 = 4.8077e-04
Validation rmse = 0.303478
Validation r2 = 0.026028
Validation mse = 0.092099
Epoch 1
Loss = 8.4453e-01, PNorm = 34.0515, GNorm = 8.6925, lr_0 = 8.6154e-04
Validation rmse = 0.322955
Validation r2 = -0.103002
Validation mse = 0.104300
Epoch 2
Loss = 1.0036e+00, PNorm = 34.0998, GNorm = 3.1127, lr_0 = 9.8184e-04
Loss = 5.9653e-01, PNorm = 34.1732, GNorm = 2.9645, lr_0 = 9.5231e-04
Validation rmse = 0.204097
Validation r2 = 0.559482
Validation mse = 0.041655
Epoch 3
Loss = 4.7453e-01, PNorm = 34.2464, GNorm = 1.8087, lr_0 = 9.2367e-04
Validation rmse = 0.191024
Validation r2 = 0.614107
Validation mse = 0.036490
Epoch 4
Loss = 3.8870e-01, PNorm = 34.3045, GNorm = 3.8947, lr_0 = 8.9589e-04
Validation rmse = 0.159560
Validation r2 = 0.730759
Validation mse = 0.025459
Epoch 5
Loss = 4.5593e-01, PNorm = 34.3591, GNorm = 3.6032, lr_0 = 8.6894e-04
Loss = 3.3534e-01, PNorm = 34.4143, GNorm = 3.1362, lr_0 = 8.4281e-04
Validation rmse = 0.154927
Validation r2 = 0.746169
Validation mse = 0.024002
Epoch 6
Loss = 2.7674e-01, PNorm = 34.4616, GNorm = 1.8420, lr_0 = 8.1746e-04
Validation rmse = 0.142710
Validation r2 = 0.784622
Validation mse = 0.020366
Epoch 7
Loss = 1.9092e-01, PNorm = 34.5060, GNorm = 1.4236, lr_0 = 7.9287e-04
Loss = 2.9049e-01, PNorm = 34.5471, GNorm = 8.4552, lr_0 = 7.6903e-04
Validation rmse = 0.132785
Validation r2 = 0.813537
Validation mse = 0.017632
Epoch 8
Loss = 2.6902e-01, PNorm = 34.5890, GNorm = 1.6588, lr_0 = 7.4590e-04
Validation rmse = 0.145726
Validation r2 = 0.775422
Validation mse = 0.021236
Epoch 9
Loss = 2.2771e-01, PNorm = 34.6279, GNorm = 3.6510, lr_0 = 7.2346e-04
Validation rmse = 0.111205
Validation r2 = 0.869221
Validation mse = 0.012366
Epoch 10
Loss = 1.7635e-01, PNorm = 34.6668, GNorm = 1.7778, lr_0 = 7.0170e-04
Loss = 1.6670e-01, PNorm = 34.7031, GNorm = 1.4073, lr_0 = 6.8060e-04
Validation rmse = 0.104657
Validation r2 = 0.884168
Validation mse = 0.010953
Epoch 11
Loss = 1.6312e-01, PNorm = 34.7388, GNorm = 3.2729, lr_0 = 6.6013e-04
Validation rmse = 0.101781
Validation r2 = 0.890447
Validation mse = 0.010359
Epoch 12
Loss = 1.2418e-01, PNorm = 34.7696, GNorm = 1.8733, lr_0 = 6.4027e-04
Loss = 1.7052e-01, PNorm = 34.8040, GNorm = 5.0801, lr_0 = 6.2102e-04
Validation rmse = 0.108535
Validation r2 = 0.875425
Validation mse = 0.011780
Epoch 13
Loss = 1.5112e-01, PNorm = 34.8287, GNorm = 1.1357, lr_0 = 6.0234e-04
Validation rmse = 0.111367
Validation r2 = 0.868839
Validation mse = 0.012403
Epoch 14
Loss = 1.2501e-01, PNorm = 34.8563, GNorm = 0.7243, lr_0 = 5.8422e-04
Validation rmse = 0.097935
Validation r2 = 0.898570
Validation mse = 0.009591
Epoch 15
Loss = 1.1156e-01, PNorm = 34.8798, GNorm = 0.8425, lr_0 = 5.6665e-04
Loss = 1.3798e-01, PNorm = 34.9045, GNorm = 2.3095, lr_0 = 5.4961e-04
Validation rmse = 0.122911
Validation r2 = 0.840238
Validation mse = 0.015107
Epoch 16
Loss = 1.2265e-01, PNorm = 34.9262, GNorm = 0.8617, lr_0 = 5.3308e-04
Validation rmse = 0.123579
Validation r2 = 0.838498
Validation mse = 0.015272
Epoch 17
Loss = 1.3817e-01, PNorm = 34.9459, GNorm = 2.1980, lr_0 = 5.1547e-04
Loss = 1.1990e-01, PNorm = 34.9650, GNorm = 1.2649, lr_0 = 4.9996e-04
Validation rmse = 0.133311
Validation r2 = 0.812059
Validation mse = 0.017772
Epoch 18
Loss = 1.2678e-01, PNorm = 34.9769, GNorm = 1.3139, lr_0 = 4.8493e-04
Validation rmse = 0.103480
Validation r2 = 0.886760
Validation mse = 0.010708
Epoch 19
Loss = 1.0551e-01, PNorm = 34.9950, GNorm = 0.6253, lr_0 = 4.7034e-04
Validation rmse = 0.108601
Validation r2 = 0.875273
Validation mse = 0.011794
Epoch 20
Loss = 8.1942e-02, PNorm = 35.0097, GNorm = 1.6419, lr_0 = 4.5620e-04
Loss = 1.3642e-01, PNorm = 35.0260, GNorm = 0.8376, lr_0 = 4.4247e-04
Validation rmse = 0.127092
Validation r2 = 0.829184
Validation mse = 0.016152
Epoch 21
Loss = 1.0472e-01, PNorm = 35.0395, GNorm = 1.4031, lr_0 = 4.2917e-04
Validation rmse = 0.108266
Validation r2 = 0.876043
Validation mse = 0.011721
Epoch 22
Loss = 1.0350e-01, PNorm = 35.0529, GNorm = 1.9594, lr_0 = 4.1626e-04
Loss = 1.1165e-01, PNorm = 35.0655, GNorm = 1.0364, lr_0 = 4.0374e-04
Validation rmse = 0.104424
Validation r2 = 0.884683
Validation mse = 0.010904
Epoch 23
Loss = 1.0510e-01, PNorm = 35.0783, GNorm = 1.5552, lr_0 = 3.9160e-04
Validation rmse = 0.120618
Validation r2 = 0.846145
Validation mse = 0.014549
Epoch 24
Loss = 9.7671e-02, PNorm = 35.0906, GNorm = 0.6168, lr_0 = 3.7982e-04
Validation rmse = 0.111140
Validation r2 = 0.869373
Validation mse = 0.012352
Epoch 25
Loss = 1.3089e-01, PNorm = 35.1007, GNorm = 1.5771, lr_0 = 3.6839e-04
Loss = 1.0430e-01, PNorm = 35.1118, GNorm = 1.5314, lr_0 = 3.5731e-04
Validation rmse = 0.109101
Validation r2 = 0.874123
Validation mse = 0.011903
Epoch 26
Loss = 9.8509e-02, PNorm = 35.1204, GNorm = 1.1467, lr_0 = 3.4657e-04
Validation rmse = 0.122992
Validation r2 = 0.840027
Validation mse = 0.015127
Epoch 27
Loss = 9.0898e-02, PNorm = 35.1317, GNorm = 1.1201, lr_0 = 3.3614e-04
Loss = 1.0657e-01, PNorm = 35.1418, GNorm = 1.0850, lr_0 = 3.2603e-04
Validation rmse = 0.111540
Validation r2 = 0.868432
Validation mse = 0.012441
Epoch 28
Loss = 8.8730e-02, PNorm = 35.1498, GNorm = 0.6843, lr_0 = 3.1623e-04
Validation rmse = 0.123493
Validation r2 = 0.838722
Validation mse = 0.015250
Epoch 29
Loss = 1.1053e-01, PNorm = 35.1598, GNorm = 1.4225, lr_0 = 3.0672e-04
Validation rmse = 0.119614
Validation r2 = 0.848695
Validation mse = 0.014307
Epoch 30
Loss = 8.5405e-02, PNorm = 35.1711, GNorm = 2.0374, lr_0 = 2.9749e-04
Loss = 1.0048e-01, PNorm = 35.1796, GNorm = 2.7290, lr_0 = 2.8854e-04
Validation rmse = 0.132630
Validation r2 = 0.813972
Validation mse = 0.017591
Epoch 31
Loss = 1.1426e-01, PNorm = 35.1897, GNorm = 2.2503, lr_0 = 2.7987e-04
Validation rmse = 0.110737
Validation r2 = 0.870320
Validation mse = 0.012263
Epoch 32
Loss = 1.0278e-01, PNorm = 35.1984, GNorm = 1.5145, lr_0 = 2.7145e-04
Loss = 9.8573e-02, PNorm = 35.2073, GNorm = 1.0776, lr_0 = 2.6328e-04
Validation rmse = 0.125188
Validation r2 = 0.834265
Validation mse = 0.015672
Epoch 33
Loss = 9.3541e-02, PNorm = 35.2148, GNorm = 1.0755, lr_0 = 2.5537e-04
Validation rmse = 0.116795
Validation r2 = 0.855741
Validation mse = 0.013641
Epoch 34
Loss = 8.8210e-02, PNorm = 35.2243, GNorm = 0.5479, lr_0 = 2.4693e-04
Validation rmse = 0.112766
Validation r2 = 0.865523
Validation mse = 0.012716
Epoch 35
Loss = 9.0927e-02, PNorm = 35.2316, GNorm = 1.4147, lr_0 = 2.3950e-04
Loss = 9.3384e-02, PNorm = 35.2380, GNorm = 1.4593, lr_0 = 2.3230e-04
Validation rmse = 0.116596
Validation r2 = 0.856233
Validation mse = 0.013595
Epoch 36
Loss = 9.9805e-02, PNorm = 35.2459, GNorm = 1.8515, lr_0 = 2.2531e-04
Validation rmse = 0.120925
Validation r2 = 0.845358
Validation mse = 0.014623
Epoch 37
Loss = 9.0921e-02, PNorm = 35.2523, GNorm = 0.5745, lr_0 = 2.1854e-04
Validation rmse = 0.122933
Validation r2 = 0.840181
Validation mse = 0.015113
Epoch 38
Loss = 1.0792e-01, PNorm = 35.2597, GNorm = 0.6054, lr_0 = 2.1196e-04
Loss = 9.1113e-02, PNorm = 35.2655, GNorm = 1.0240, lr_0 = 2.0559e-04
Validation rmse = 0.112623
Validation r2 = 0.865865
Validation mse = 0.012684
Epoch 39
Loss = 9.2290e-02, PNorm = 35.2728, GNorm = 1.2084, lr_0 = 1.9940e-04
Validation rmse = 0.128895
Validation r2 = 0.824304
Validation mse = 0.016614
Epoch 40
Loss = 7.6083e-02, PNorm = 35.2791, GNorm = 1.7196, lr_0 = 1.9341e-04
Loss = 9.8048e-02, PNorm = 35.2867, GNorm = 0.6752, lr_0 = 1.8759e-04
Validation rmse = 0.118608
Validation r2 = 0.851230
Validation mse = 0.014068
Epoch 41
Loss = 8.5365e-02, PNorm = 35.2912, GNorm = 1.7786, lr_0 = 1.8195e-04
Validation rmse = 0.111160
Validation r2 = 0.869327
Validation mse = 0.012356
Epoch 42
Loss = 8.1552e-02, PNorm = 35.2963, GNorm = 1.3203, lr_0 = 1.7648e-04
Validation rmse = 0.118446
Validation r2 = 0.851635
Validation mse = 0.014029
Epoch 43
Loss = 9.1051e-02, PNorm = 35.3025, GNorm = 1.0702, lr_0 = 1.7117e-04
Loss = 9.7103e-02, PNorm = 35.3071, GNorm = 1.6361, lr_0 = 1.6602e-04
Validation rmse = 0.122979
Validation r2 = 0.840062
Validation mse = 0.015124
Epoch 44
Loss = 9.2489e-02, PNorm = 35.3136, GNorm = 0.7588, lr_0 = 1.6103e-04
Validation rmse = 0.125606
Validation r2 = 0.833156
Validation mse = 0.015777
Epoch 45
Loss = 8.4725e-02, PNorm = 35.3191, GNorm = 1.2686, lr_0 = 1.5618e-04
Loss = 8.5121e-02, PNorm = 35.3227, GNorm = 0.4951, lr_0 = 1.5149e-04
Validation rmse = 0.120518
Validation r2 = 0.846400
Validation mse = 0.014524
Epoch 46
Loss = 8.6707e-02, PNorm = 35.3281, GNorm = 0.9104, lr_0 = 1.4693e-04
Validation rmse = 0.115430
Validation r2 = 0.859095
Validation mse = 0.013324
Epoch 47
Loss = 9.0676e-02, PNorm = 35.3332, GNorm = 2.1520, lr_0 = 1.4251e-04
Validation rmse = 0.115768
Validation r2 = 0.858269
Validation mse = 0.013402
Epoch 48
Loss = 8.3611e-02, PNorm = 35.3374, GNorm = 0.6589, lr_0 = 1.3822e-04
Loss = 8.3415e-02, PNorm = 35.3412, GNorm = 1.0913, lr_0 = 1.3407e-04
Validation rmse = 0.116459
Validation r2 = 0.856570
Validation mse = 0.013563
Epoch 49
Loss = 8.9097e-02, PNorm = 35.3453, GNorm = 0.6755, lr_0 = 1.3003e-04
Validation rmse = 0.117349
Validation r2 = 0.854370
Validation mse = 0.013771
Epoch 50
Loss = 7.8207e-02, PNorm = 35.3502, GNorm = 0.4304, lr_0 = 1.2612e-04
Loss = 8.5291e-02, PNorm = 35.3540, GNorm = 1.2819, lr_0 = 1.2233e-04
Loss = 9.8837e-02, PNorm = 35.3543, GNorm = 0.9373, lr_0 = 1.2196e-04
Validation rmse = 0.119528
Validation r2 = 0.848911
Validation mse = 0.014287
Epoch 51
Loss = 7.9647e-02, PNorm = 35.3582, GNorm = 1.9508, lr_0 = 1.1829e-04
Validation rmse = 0.116284
Validation r2 = 0.857001
Validation mse = 0.013522
Epoch 52
Loss = 8.3563e-02, PNorm = 35.3626, GNorm = 1.1648, lr_0 = 1.1473e-04
Validation rmse = 0.124450
Validation r2 = 0.836211
Validation mse = 0.015488
Epoch 53
Loss = 6.7437e-02, PNorm = 35.3664, GNorm = 0.4149, lr_0 = 1.1128e-04
Loss = 8.2308e-02, PNorm = 35.3703, GNorm = 0.4670, lr_0 = 1.0793e-04
Validation rmse = 0.120656
Validation r2 = 0.846048
Validation mse = 0.014558
Epoch 54
Loss = 7.6652e-02, PNorm = 35.3736, GNorm = 0.7152, lr_0 = 1.0469e-04
Validation rmse = 0.124960
Validation r2 = 0.834867
Validation mse = 0.015615
Epoch 55
Loss = 9.5431e-02, PNorm = 35.3768, GNorm = 1.3426, lr_0 = 1.0154e-04
Loss = 8.3018e-02, PNorm = 35.3810, GNorm = 1.3446, lr_0 = 1.0000e-04
Validation rmse = 0.124226
Validation r2 = 0.836800
Validation mse = 0.015432
Epoch 56
Loss = 8.7367e-02, PNorm = 35.3841, GNorm = 1.3504, lr_0 = 1.0000e-04
Validation rmse = 0.119896
Validation r2 = 0.847980
Validation mse = 0.014375
Epoch 57
Loss = 8.5599e-02, PNorm = 35.3877, GNorm = 0.6601, lr_0 = 1.0000e-04
Validation rmse = 0.118678
Validation r2 = 0.851053
Validation mse = 0.014084
Epoch 58
Loss = 1.0853e-01, PNorm = 35.3911, GNorm = 0.6222, lr_0 = 1.0000e-04
Loss = 8.0048e-02, PNorm = 35.3949, GNorm = 0.7107, lr_0 = 1.0000e-04
Validation rmse = 0.117443
Validation r2 = 0.854137
Validation mse = 0.013793
Epoch 59
Loss = 9.1225e-02, PNorm = 35.3976, GNorm = 0.6591, lr_0 = 1.0000e-04
Validation rmse = 0.116005
Validation r2 = 0.857688
Validation mse = 0.013457
Model 0 best validation rmse = 0.097935 on epoch 14
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.183398
Model 0 test r2 = 0.517159
Model 0 test mse = 0.033635
Ensemble test rmse = 0.183398
Ensemble test r2 = 0.517159
Ensemble test mse = 0.033635
Fold 8
Splitting data with seed 8
Total size = 705 | train size = 697 | val size = 8 | test size = 317
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.9420e-01, PNorm = 34.0152, GNorm = 7.8236, lr_0 = 4.8077e-04
Validation rmse = 0.438102
Validation r2 = -0.468943
Validation mse = 0.191934
Epoch 1
Loss = 6.9531e-01, PNorm = 34.0541, GNorm = 1.0057, lr_0 = 8.6154e-04
Validation rmse = 0.349224
Validation r2 = 0.066613
Validation mse = 0.121957
Epoch 2
Loss = 5.6965e-01, PNorm = 34.1187, GNorm = 5.3388, lr_0 = 9.8184e-04
Loss = 4.7038e-01, PNorm = 34.1887, GNorm = 1.4677, lr_0 = 9.5231e-04
Validation rmse = 0.297591
Validation r2 = 0.322212
Validation mse = 0.088561
Epoch 3
Loss = 3.8210e-01, PNorm = 34.2519, GNorm = 1.1573, lr_0 = 9.2367e-04
Validation rmse = 0.288701
Validation r2 = 0.362103
Validation mse = 0.083348
Epoch 4
Loss = 2.7321e-01, PNorm = 34.3126, GNorm = 1.7740, lr_0 = 8.9589e-04
Validation rmse = 0.258921
Validation r2 = 0.486918
Validation mse = 0.067040
Epoch 5
Loss = 2.4321e-01, PNorm = 34.3724, GNorm = 3.5424, lr_0 = 8.6894e-04
Loss = 3.2368e-01, PNorm = 34.4206, GNorm = 4.3879, lr_0 = 8.4281e-04
Validation rmse = 0.211241
Validation r2 = 0.658485
Validation mse = 0.044623
Epoch 6
Loss = 2.4781e-01, PNorm = 34.4641, GNorm = 5.9955, lr_0 = 8.1746e-04
Validation rmse = 0.214824
Validation r2 = 0.646802
Validation mse = 0.046149
Epoch 7
Loss = 2.6492e-01, PNorm = 34.5065, GNorm = 6.7396, lr_0 = 7.9287e-04
Loss = 1.9614e-01, PNorm = 34.5470, GNorm = 3.3270, lr_0 = 7.6903e-04
Validation rmse = 0.203642
Validation r2 = 0.682612
Validation mse = 0.041470
Epoch 8
Loss = 1.9611e-01, PNorm = 34.5904, GNorm = 2.4444, lr_0 = 7.4590e-04
Validation rmse = 0.175660
Validation r2 = 0.763845
Validation mse = 0.030856
Epoch 9
Loss = 1.8578e-01, PNorm = 34.6174, GNorm = 0.8454, lr_0 = 7.2346e-04
Validation rmse = 0.152389
Validation r2 = 0.822271
Validation mse = 0.023222
Epoch 10
Loss = 1.2838e-01, PNorm = 34.6562, GNorm = 1.3695, lr_0 = 7.0170e-04
Loss = 1.6142e-01, PNorm = 34.6885, GNorm = 2.5039, lr_0 = 6.8060e-04
Validation rmse = 0.154661
Validation r2 = 0.816930
Validation mse = 0.023920
Epoch 11
Loss = 1.6556e-01, PNorm = 34.7176, GNorm = 1.6462, lr_0 = 6.6013e-04
Validation rmse = 0.135851
Validation r2 = 0.858753
Validation mse = 0.018455
Epoch 12
Loss = 1.6188e-01, PNorm = 34.7480, GNorm = 2.7942, lr_0 = 6.4027e-04
Loss = 1.3776e-01, PNorm = 34.7742, GNorm = 2.2612, lr_0 = 6.2102e-04
Validation rmse = 0.138850
Validation r2 = 0.852447
Validation mse = 0.019279
Epoch 13
Loss = 1.4049e-01, PNorm = 34.7965, GNorm = 0.7388, lr_0 = 6.0234e-04
Validation rmse = 0.110688
Validation r2 = 0.906233
Validation mse = 0.012252
Epoch 14
Loss = 1.2647e-01, PNorm = 34.8202, GNorm = 0.8432, lr_0 = 5.8422e-04
Validation rmse = 0.103105
Validation r2 = 0.918640
Validation mse = 0.010631
Epoch 15
Loss = 1.5070e-01, PNorm = 34.8418, GNorm = 0.9402, lr_0 = 5.6665e-04
Loss = 1.3679e-01, PNorm = 34.8612, GNorm = 3.8396, lr_0 = 5.4961e-04
Validation rmse = 0.110745
Validation r2 = 0.906136
Validation mse = 0.012264
Epoch 16
Loss = 1.2957e-01, PNorm = 34.8811, GNorm = 1.0805, lr_0 = 5.3308e-04
Validation rmse = 0.112625
Validation r2 = 0.902921
Validation mse = 0.012684
Epoch 17
Loss = 1.3289e-01, PNorm = 34.9030, GNorm = 1.2363, lr_0 = 5.1547e-04
Loss = 1.1770e-01, PNorm = 34.9209, GNorm = 2.3794, lr_0 = 4.9996e-04
Validation rmse = 0.118233
Validation r2 = 0.893013
Validation mse = 0.013979
Epoch 18
Loss = 1.2135e-01, PNorm = 34.9405, GNorm = 0.8091, lr_0 = 4.8493e-04
Validation rmse = 0.136942
Validation r2 = 0.856476
Validation mse = 0.018753
Epoch 19
Loss = 1.2720e-01, PNorm = 34.9569, GNorm = 0.8682, lr_0 = 4.7034e-04
Validation rmse = 0.129535
Validation r2 = 0.871582
Validation mse = 0.016779
Epoch 20
Loss = 8.7940e-02, PNorm = 34.9719, GNorm = 1.7225, lr_0 = 4.5620e-04
Loss = 1.0889e-01, PNorm = 34.9885, GNorm = 1.9099, lr_0 = 4.4247e-04
Validation rmse = 0.108412
Validation r2 = 0.910048
Validation mse = 0.011753
Epoch 21
Loss = 1.0302e-01, PNorm = 35.0061, GNorm = 0.6282, lr_0 = 4.2917e-04
Validation rmse = 0.097802
Validation r2 = 0.926794
Validation mse = 0.009565
Epoch 22
Loss = 1.1981e-01, PNorm = 35.0192, GNorm = 0.9157, lr_0 = 4.1626e-04
Loss = 9.9759e-02, PNorm = 35.0351, GNorm = 2.2902, lr_0 = 4.0374e-04
Validation rmse = 0.099909
Validation r2 = 0.923605
Validation mse = 0.009982
Epoch 23
Loss = 1.0626e-01, PNorm = 35.0464, GNorm = 3.2911, lr_0 = 3.9160e-04
Validation rmse = 0.116307
Validation r2 = 0.896469
Validation mse = 0.013527
Epoch 24
Loss = 1.1068e-01, PNorm = 35.0598, GNorm = 2.4778, lr_0 = 3.7982e-04
Validation rmse = 0.100831
Validation r2 = 0.922189
Validation mse = 0.010167
Epoch 25
Loss = 1.1766e-01, PNorm = 35.0734, GNorm = 0.6217, lr_0 = 3.6839e-04
Loss = 9.4910e-02, PNorm = 35.0872, GNorm = 0.8744, lr_0 = 3.5731e-04
Validation rmse = 0.095987
Validation r2 = 0.929486
Validation mse = 0.009213
Epoch 26
Loss = 1.1156e-01, PNorm = 35.1007, GNorm = 1.2019, lr_0 = 3.4657e-04
Validation rmse = 0.088593
Validation r2 = 0.939930
Validation mse = 0.007849
Epoch 27
Loss = 9.0394e-02, PNorm = 35.1138, GNorm = 3.1791, lr_0 = 3.3614e-04
Loss = 1.0633e-01, PNorm = 35.1249, GNorm = 1.7753, lr_0 = 3.2603e-04
Validation rmse = 0.104226
Validation r2 = 0.916861
Validation mse = 0.010863
Epoch 28
Loss = 9.6705e-02, PNorm = 35.1379, GNorm = 1.8735, lr_0 = 3.1623e-04
Validation rmse = 0.103697
Validation r2 = 0.917703
Validation mse = 0.010753
Epoch 29
Loss = 8.5344e-02, PNorm = 35.1494, GNorm = 1.3252, lr_0 = 3.0672e-04
Validation rmse = 0.084210
Validation r2 = 0.945727
Validation mse = 0.007091
Epoch 30
Loss = 1.0736e-01, PNorm = 35.1604, GNorm = 1.0726, lr_0 = 2.9749e-04
Loss = 9.2315e-02, PNorm = 35.1716, GNorm = 1.1269, lr_0 = 2.8854e-04
Validation rmse = 0.114533
Validation r2 = 0.899605
Validation mse = 0.013118
Epoch 31
Loss = 1.0161e-01, PNorm = 35.1822, GNorm = 2.2157, lr_0 = 2.7987e-04
Validation rmse = 0.092383
Validation r2 = 0.934681
Validation mse = 0.008535
Epoch 32
Loss = 9.2866e-02, PNorm = 35.1921, GNorm = 1.0468, lr_0 = 2.7145e-04
Loss = 9.1840e-02, PNorm = 35.2021, GNorm = 2.3925, lr_0 = 2.6328e-04
Validation rmse = 0.085986
Validation r2 = 0.943414
Validation mse = 0.007394
Epoch 33
Loss = 9.3490e-02, PNorm = 35.2097, GNorm = 0.8404, lr_0 = 2.5537e-04
Validation rmse = 0.108174
Validation r2 = 0.910442
Validation mse = 0.011702
Epoch 34
Loss = 8.1789e-02, PNorm = 35.2215, GNorm = 1.3491, lr_0 = 2.4693e-04
Validation rmse = 0.108625
Validation r2 = 0.909695
Validation mse = 0.011799
Epoch 35
Loss = 1.0063e-01, PNorm = 35.2297, GNorm = 1.0275, lr_0 = 2.3950e-04
Loss = 9.3745e-02, PNorm = 35.2388, GNorm = 0.7417, lr_0 = 2.3230e-04
Validation rmse = 0.086487
Validation r2 = 0.942753
Validation mse = 0.007480
Epoch 36
Loss = 9.3850e-02, PNorm = 35.2480, GNorm = 0.5529, lr_0 = 2.2531e-04
Validation rmse = 0.092226
Validation r2 = 0.934903
Validation mse = 0.008506
Epoch 37
Loss = 8.3171e-02, PNorm = 35.2563, GNorm = 2.2999, lr_0 = 2.1854e-04
Validation rmse = 0.092878
Validation r2 = 0.933980
Validation mse = 0.008626
Epoch 38
Loss = 6.2811e-02, PNorm = 35.2635, GNorm = 0.4120, lr_0 = 2.1196e-04
Loss = 7.9658e-02, PNorm = 35.2708, GNorm = 0.9092, lr_0 = 2.0559e-04
Validation rmse = 0.079647
Validation r2 = 0.951449
Validation mse = 0.006344
Epoch 39
Loss = 9.5042e-02, PNorm = 35.2789, GNorm = 0.6507, lr_0 = 1.9940e-04
Validation rmse = 0.102306
Validation r2 = 0.919896
Validation mse = 0.010466
Epoch 40
Loss = 7.7052e-02, PNorm = 35.2862, GNorm = 1.4540, lr_0 = 1.9341e-04
Loss = 8.3199e-02, PNorm = 35.2937, GNorm = 1.2737, lr_0 = 1.8759e-04
Validation rmse = 0.090927
Validation r2 = 0.936723
Validation mse = 0.008268
Epoch 41
Loss = 8.2183e-02, PNorm = 35.2994, GNorm = 1.0271, lr_0 = 1.8195e-04
Validation rmse = 0.075280
Validation r2 = 0.956628
Validation mse = 0.005667
Epoch 42
Loss = 8.5416e-02, PNorm = 35.3065, GNorm = 5.2031, lr_0 = 1.7648e-04
Validation rmse = 0.131049
Validation r2 = 0.868561
Validation mse = 0.017174
Epoch 43
Loss = 1.1132e-01, PNorm = 35.3126, GNorm = 2.2735, lr_0 = 1.7117e-04
Loss = 8.7005e-02, PNorm = 35.3197, GNorm = 1.5553, lr_0 = 1.6602e-04
Validation rmse = 0.086107
Validation r2 = 0.943254
Validation mse = 0.007414
Epoch 44
Loss = 7.9756e-02, PNorm = 35.3259, GNorm = 0.8298, lr_0 = 1.6103e-04
Validation rmse = 0.084333
Validation r2 = 0.945569
Validation mse = 0.007112
Epoch 45
Loss = 7.5708e-02, PNorm = 35.3321, GNorm = 0.8224, lr_0 = 1.5618e-04
Loss = 8.2933e-02, PNorm = 35.3374, GNorm = 0.6962, lr_0 = 1.5149e-04
Validation rmse = 0.095650
Validation r2 = 0.929980
Validation mse = 0.009149
Epoch 46
Loss = 7.8034e-02, PNorm = 35.3436, GNorm = 1.6466, lr_0 = 1.4693e-04
Validation rmse = 0.075444
Validation r2 = 0.956438
Validation mse = 0.005692
Epoch 47
Loss = 8.0905e-02, PNorm = 35.3483, GNorm = 0.7820, lr_0 = 1.4251e-04
Validation rmse = 0.089437
Validation r2 = 0.938780
Validation mse = 0.007999
Epoch 48
Loss = 7.1373e-02, PNorm = 35.3534, GNorm = 0.5458, lr_0 = 1.3822e-04
Loss = 7.9491e-02, PNorm = 35.3582, GNorm = 0.9972, lr_0 = 1.3407e-04
Validation rmse = 0.092073
Validation r2 = 0.935119
Validation mse = 0.008477
Epoch 49
Loss = 8.7190e-02, PNorm = 35.3641, GNorm = 1.4855, lr_0 = 1.3003e-04
Validation rmse = 0.100118
Validation r2 = 0.923285
Validation mse = 0.010024
Epoch 50
Loss = 7.8113e-02, PNorm = 35.3683, GNorm = 0.8287, lr_0 = 1.2612e-04
Loss = 8.1546e-02, PNorm = 35.3730, GNorm = 1.4587, lr_0 = 1.2233e-04
Loss = 7.6848e-02, PNorm = 35.3734, GNorm = 1.5893, lr_0 = 1.2196e-04
Validation rmse = 0.077505
Validation r2 = 0.954026
Validation mse = 0.006007
Epoch 51
Loss = 7.6206e-02, PNorm = 35.3782, GNorm = 0.8070, lr_0 = 1.1829e-04
Validation rmse = 0.083661
Validation r2 = 0.946433
Validation mse = 0.006999
Epoch 52
Loss = 7.5233e-02, PNorm = 35.3823, GNorm = 0.9255, lr_0 = 1.1473e-04
Validation rmse = 0.075672
Validation r2 = 0.956174
Validation mse = 0.005726
Epoch 53
Loss = 6.6908e-02, PNorm = 35.3865, GNorm = 0.3506, lr_0 = 1.1128e-04
Loss = 7.6524e-02, PNorm = 35.3897, GNorm = 1.1446, lr_0 = 1.0793e-04
Validation rmse = 0.101253
Validation r2 = 0.921536
Validation mse = 0.010252
Epoch 54
Loss = 7.2172e-02, PNorm = 35.3933, GNorm = 0.6009, lr_0 = 1.0469e-04
Validation rmse = 0.087190
Validation r2 = 0.941818
Validation mse = 0.007602
Epoch 55
Loss = 7.5492e-02, PNorm = 35.3972, GNorm = 0.6470, lr_0 = 1.0154e-04
Loss = 7.5951e-02, PNorm = 35.4008, GNorm = 0.9779, lr_0 = 1.0000e-04
Validation rmse = 0.084201
Validation r2 = 0.945739
Validation mse = 0.007090
Epoch 56
Loss = 7.7028e-02, PNorm = 35.4040, GNorm = 1.8469, lr_0 = 1.0000e-04
Validation rmse = 0.075946
Validation r2 = 0.955857
Validation mse = 0.005768
Epoch 57
Loss = 7.9154e-02, PNorm = 35.4080, GNorm = 1.0141, lr_0 = 1.0000e-04
Validation rmse = 0.082472
Validation r2 = 0.947944
Validation mse = 0.006802
Epoch 58
Loss = 5.8461e-02, PNorm = 35.4113, GNorm = 1.5516, lr_0 = 1.0000e-04
Loss = 7.9138e-02, PNorm = 35.4149, GNorm = 0.6940, lr_0 = 1.0000e-04
Validation rmse = 0.080809
Validation r2 = 0.950023
Validation mse = 0.006530
Epoch 59
Loss = 7.0640e-02, PNorm = 35.4189, GNorm = 0.6679, lr_0 = 1.0000e-04
Validation rmse = 0.085278
Validation r2 = 0.944343
Validation mse = 0.007272
Model 0 best validation rmse = 0.075280 on epoch 41
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.176042
Model 0 test r2 = 0.555114
Model 0 test mse = 0.030991
Ensemble test rmse = 0.176042
Ensemble test r2 = 0.555114
Ensemble test mse = 0.030991
Fold 9
Splitting data with seed 9
Total size = 705 | train size = 697 | val size = 8 | test size = 317
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.7986e-01, PNorm = 34.0195, GNorm = 1.4729, lr_0 = 4.8077e-04
Validation rmse = 0.334825
Validation r2 = -0.807710
Validation mse = 0.112108
Epoch 1
Loss = 6.7269e-01, PNorm = 34.0661, GNorm = 1.2569, lr_0 = 8.6154e-04
Validation rmse = 0.277126
Validation r2 = -0.238363
Validation mse = 0.076799
Epoch 2
Loss = 6.4482e-01, PNorm = 34.1215, GNorm = 13.1821, lr_0 = 9.8184e-04
Loss = 5.2424e-01, PNorm = 34.1784, GNorm = 7.5804, lr_0 = 9.5231e-04
Validation rmse = 0.264995
Validation r2 = -0.132317
Validation mse = 0.070222
Epoch 3
Loss = 3.9842e-01, PNorm = 34.2391, GNorm = 3.0002, lr_0 = 9.2367e-04
Validation rmse = 0.203986
Validation r2 = 0.329042
Validation mse = 0.041610
Epoch 4
Loss = 3.7672e-01, PNorm = 34.2857, GNorm = 2.7840, lr_0 = 8.9589e-04
Validation rmse = 0.198181
Validation r2 = 0.366686
Validation mse = 0.039276
Epoch 5
Loss = 3.2116e-01, PNorm = 34.3363, GNorm = 6.5492, lr_0 = 8.6894e-04
Loss = 3.0076e-01, PNorm = 34.3891, GNorm = 1.3007, lr_0 = 8.4281e-04
Validation rmse = 0.196740
Validation r2 = 0.375865
Validation mse = 0.038707
Epoch 6
Loss = 2.1100e-01, PNorm = 34.4348, GNorm = 2.1698, lr_0 = 8.1746e-04
Validation rmse = 0.164981
Validation r2 = 0.561106
Validation mse = 0.027219
Epoch 7
Loss = 1.7196e-01, PNorm = 34.4814, GNorm = 0.7622, lr_0 = 7.9287e-04
Loss = 2.3392e-01, PNorm = 34.5293, GNorm = 3.0198, lr_0 = 7.6903e-04
Validation rmse = 0.193371
Validation r2 = 0.397058
Validation mse = 0.037392
Epoch 8
Loss = 1.9584e-01, PNorm = 34.5719, GNorm = 0.9200, lr_0 = 7.4590e-04
Validation rmse = 0.174161
Validation r2 = 0.510900
Validation mse = 0.030332
Epoch 9
Loss = 1.6249e-01, PNorm = 34.6120, GNorm = 6.0282, lr_0 = 7.2346e-04
Validation rmse = 0.172086
Validation r2 = 0.522487
Validation mse = 0.029614
Epoch 10
Loss = 3.0351e-01, PNorm = 34.6481, GNorm = 7.0601, lr_0 = 7.0170e-04
Loss = 1.8887e-01, PNorm = 34.6823, GNorm = 1.4986, lr_0 = 6.8060e-04
Validation rmse = 0.177752
Validation r2 = 0.490525
Validation mse = 0.031596
Epoch 11
Loss = 1.8764e-01, PNorm = 34.7131, GNorm = 5.3009, lr_0 = 6.6013e-04
Validation rmse = 0.230636
Validation r2 = 0.142277
Validation mse = 0.053193
Epoch 12
Loss = 1.8191e-01, PNorm = 34.7428, GNorm = 1.8830, lr_0 = 6.4027e-04
Loss = 1.6871e-01, PNorm = 34.7718, GNorm = 2.0601, lr_0 = 6.2102e-04
Validation rmse = 0.185538
Validation r2 = 0.444916
Validation mse = 0.034424
Epoch 13
Loss = 1.4400e-01, PNorm = 34.7958, GNorm = 0.8036, lr_0 = 6.0234e-04
Validation rmse = 0.178422
Validation r2 = 0.486675
Validation mse = 0.031835
Epoch 14
Loss = 1.3016e-01, PNorm = 34.8177, GNorm = 3.5757, lr_0 = 5.8422e-04
Validation rmse = 0.170607
Validation r2 = 0.530662
Validation mse = 0.029107
Epoch 15
Loss = 1.1755e-01, PNorm = 34.8352, GNorm = 1.4503, lr_0 = 5.6665e-04
Loss = 1.4090e-01, PNorm = 34.8573, GNorm = 1.9780, lr_0 = 5.4961e-04
Validation rmse = 0.194751
Validation r2 = 0.388420
Validation mse = 0.037928
Epoch 16
Loss = 1.2954e-01, PNorm = 34.8722, GNorm = 1.7054, lr_0 = 5.3308e-04
Validation rmse = 0.200304
Validation r2 = 0.353046
Validation mse = 0.040122
Epoch 17
Loss = 1.1884e-01, PNorm = 34.8889, GNorm = 0.9380, lr_0 = 5.1547e-04
Loss = 1.1827e-01, PNorm = 34.9034, GNorm = 0.7616, lr_0 = 4.9996e-04
Validation rmse = 0.177150
Validation r2 = 0.493969
Validation mse = 0.031382
Epoch 18
Loss = 1.1600e-01, PNorm = 34.9184, GNorm = 1.4779, lr_0 = 4.8493e-04
Validation rmse = 0.201485
Validation r2 = 0.345393
Validation mse = 0.040596
Epoch 19
Loss = 1.2160e-01, PNorm = 34.9353, GNorm = 2.8347, lr_0 = 4.7034e-04
Validation rmse = 0.188106
Validation r2 = 0.429441
Validation mse = 0.035384
Epoch 20
Loss = 1.0738e-01, PNorm = 34.9508, GNorm = 0.9660, lr_0 = 4.5620e-04
Loss = 1.1106e-01, PNorm = 34.9644, GNorm = 1.5955, lr_0 = 4.4247e-04
Validation rmse = 0.196237
Validation r2 = 0.379048
Validation mse = 0.038509
Epoch 21
Loss = 1.1080e-01, PNorm = 34.9757, GNorm = 0.5700, lr_0 = 4.2917e-04
Validation rmse = 0.194683
Validation r2 = 0.388847
Validation mse = 0.037901
Epoch 22
Loss = 9.9369e-02, PNorm = 34.9897, GNorm = 1.0851, lr_0 = 4.1626e-04
Loss = 1.0900e-01, PNorm = 34.9994, GNorm = 1.9145, lr_0 = 4.0374e-04
Validation rmse = 0.181195
Validation r2 = 0.470596
Validation mse = 0.032832
Epoch 23
Loss = 1.0431e-01, PNorm = 35.0135, GNorm = 1.3690, lr_0 = 3.9160e-04
Validation rmse = 0.181019
Validation r2 = 0.471624
Validation mse = 0.032768
Epoch 24
Loss = 1.0965e-01, PNorm = 35.0248, GNorm = 1.0708, lr_0 = 3.7982e-04
Validation rmse = 0.176237
Validation r2 = 0.499171
Validation mse = 0.031060
Epoch 25
Loss = 1.0860e-01, PNorm = 35.0366, GNorm = 2.0005, lr_0 = 3.6839e-04
Loss = 1.0080e-01, PNorm = 35.0482, GNorm = 3.1214, lr_0 = 3.5731e-04
Validation rmse = 0.211929
Validation r2 = 0.275772
Validation mse = 0.044914
Epoch 26
Loss = 9.9737e-02, PNorm = 35.0584, GNorm = 2.3039, lr_0 = 3.4657e-04
Validation rmse = 0.179627
Validation r2 = 0.479718
Validation mse = 0.032266
Epoch 27
Loss = 1.0504e-01, PNorm = 35.0709, GNorm = 2.6148, lr_0 = 3.3614e-04
Loss = 9.9400e-02, PNorm = 35.0820, GNorm = 0.8645, lr_0 = 3.2603e-04
Validation rmse = 0.195381
Validation r2 = 0.384455
Validation mse = 0.038174
Epoch 28
Loss = 9.7946e-02, PNorm = 35.0926, GNorm = 0.8923, lr_0 = 3.1623e-04
Validation rmse = 0.199851
Validation r2 = 0.355967
Validation mse = 0.039941
Epoch 29
Loss = 9.9148e-02, PNorm = 35.1018, GNorm = 1.8233, lr_0 = 3.0672e-04
Validation rmse = 0.180956
Validation r2 = 0.471994
Validation mse = 0.032745
Epoch 30
Loss = 8.6691e-02, PNorm = 35.1099, GNorm = 2.0781, lr_0 = 2.9749e-04
Loss = 1.0118e-01, PNorm = 35.1194, GNorm = 0.7771, lr_0 = 2.8854e-04
Validation rmse = 0.198409
Validation r2 = 0.365232
Validation mse = 0.039366
Epoch 31
Loss = 1.0203e-01, PNorm = 35.1288, GNorm = 0.5813, lr_0 = 2.7987e-04
Validation rmse = 0.188107
Validation r2 = 0.429435
Validation mse = 0.035384
Epoch 32
Loss = 1.0571e-01, PNorm = 35.1366, GNorm = 0.7829, lr_0 = 2.7145e-04
Loss = 8.9283e-02, PNorm = 35.1445, GNorm = 1.3134, lr_0 = 2.6328e-04
Validation rmse = 0.183106
Validation r2 = 0.459371
Validation mse = 0.033528
Epoch 33
Loss = 9.5672e-02, PNorm = 35.1542, GNorm = 2.2561, lr_0 = 2.5537e-04
Validation rmse = 0.216144
Validation r2 = 0.246676
Validation mse = 0.046718
Epoch 34
Loss = 9.9961e-02, PNorm = 35.1625, GNorm = 2.5417, lr_0 = 2.4693e-04
Validation rmse = 0.189804
Validation r2 = 0.419096
Validation mse = 0.036026
Epoch 35
Loss = 9.7882e-02, PNorm = 35.1709, GNorm = 1.8747, lr_0 = 2.3950e-04
Loss = 9.9119e-02, PNorm = 35.1792, GNorm = 4.4089, lr_0 = 2.3230e-04
Validation rmse = 0.191866
Validation r2 = 0.406404
Validation mse = 0.036813
Epoch 36
Loss = 8.4609e-02, PNorm = 35.1860, GNorm = 2.5894, lr_0 = 2.2531e-04
Validation rmse = 0.188681
Validation r2 = 0.425951
Validation mse = 0.035600
Epoch 37
Loss = 8.5297e-02, PNorm = 35.1932, GNorm = 1.8235, lr_0 = 2.1854e-04
Validation rmse = 0.193686
Validation r2 = 0.395092
Validation mse = 0.037514
Epoch 38
Loss = 8.2179e-02, PNorm = 35.2004, GNorm = 0.5198, lr_0 = 2.1196e-04
Loss = 8.4538e-02, PNorm = 35.2062, GNorm = 1.6953, lr_0 = 2.0559e-04
Validation rmse = 0.180709
Validation r2 = 0.473435
Validation mse = 0.032656
Epoch 39
Loss = 1.0434e-01, PNorm = 35.2131, GNorm = 1.3116, lr_0 = 1.9940e-04
Validation rmse = 0.192390
Validation r2 = 0.403161
Validation mse = 0.037014
Epoch 40
Loss = 7.4027e-02, PNorm = 35.2200, GNorm = 0.8307, lr_0 = 1.9341e-04
Loss = 9.3474e-02, PNorm = 35.2253, GNorm = 2.0824, lr_0 = 1.8759e-04
Validation rmse = 0.191266
Validation r2 = 0.410109
Validation mse = 0.036583
Epoch 41
Loss = 9.2088e-02, PNorm = 35.2323, GNorm = 1.0435, lr_0 = 1.8195e-04
Validation rmse = 0.202017
Validation r2 = 0.341931
Validation mse = 0.040811
Epoch 42
Loss = 7.2648e-02, PNorm = 35.2371, GNorm = 0.4134, lr_0 = 1.7648e-04
Validation rmse = 0.205280
Validation r2 = 0.320503
Validation mse = 0.042140
Epoch 43
Loss = 1.1340e-01, PNorm = 35.2431, GNorm = 3.2477, lr_0 = 1.7117e-04
Loss = 8.9341e-02, PNorm = 35.2489, GNorm = 2.1575, lr_0 = 1.6602e-04
Validation rmse = 0.184475
Validation r2 = 0.451258
Validation mse = 0.034031
Epoch 44
Loss = 9.0549e-02, PNorm = 35.2542, GNorm = 1.7067, lr_0 = 1.6103e-04
Validation rmse = 0.187817
Validation r2 = 0.431192
Validation mse = 0.035275
Epoch 45
Loss = 9.1197e-02, PNorm = 35.2592, GNorm = 1.9459, lr_0 = 1.5618e-04
Loss = 8.1066e-02, PNorm = 35.2648, GNorm = 0.8914, lr_0 = 1.5149e-04
Validation rmse = 0.198775
Validation r2 = 0.362883
Validation mse = 0.039512
Epoch 46
Loss = 9.2640e-02, PNorm = 35.2695, GNorm = 0.9702, lr_0 = 1.4693e-04
Validation rmse = 0.184953
Validation r2 = 0.448412
Validation mse = 0.034207
Epoch 47
Loss = 7.7134e-02, PNorm = 35.2744, GNorm = 2.1105, lr_0 = 1.4251e-04
Validation rmse = 0.183380
Validation r2 = 0.457753
Validation mse = 0.033628
Epoch 48
Loss = 6.4978e-02, PNorm = 35.2781, GNorm = 0.3379, lr_0 = 1.3822e-04
Loss = 7.9947e-02, PNorm = 35.2817, GNorm = 0.6717, lr_0 = 1.3407e-04
Validation rmse = 0.188421
Validation r2 = 0.427532
Validation mse = 0.035502
Epoch 49
Loss = 9.7413e-02, PNorm = 35.2867, GNorm = 0.9671, lr_0 = 1.3003e-04
Validation rmse = 0.198213
Validation r2 = 0.366484
Validation mse = 0.039288
Epoch 50
Loss = 9.7010e-02, PNorm = 35.2919, GNorm = 0.6816, lr_0 = 1.2612e-04
Loss = 7.2317e-02, PNorm = 35.2951, GNorm = 1.5212, lr_0 = 1.2233e-04
Loss = 1.1451e-01, PNorm = 35.2954, GNorm = 1.3114, lr_0 = 1.2196e-04
Validation rmse = 0.185741
Validation r2 = 0.443697
Validation mse = 0.034500
Epoch 51
Loss = 7.8152e-02, PNorm = 35.3002, GNorm = 1.0678, lr_0 = 1.1829e-04
Validation rmse = 0.186998
Validation r2 = 0.436146
Validation mse = 0.034968
Epoch 52
Loss = 7.6212e-02, PNorm = 35.3036, GNorm = 0.9120, lr_0 = 1.1473e-04
Validation rmse = 0.187557
Validation r2 = 0.432771
Validation mse = 0.035177
Epoch 53
Loss = 6.7096e-02, PNorm = 35.3072, GNorm = 0.5360, lr_0 = 1.1128e-04
Loss = 8.3269e-02, PNorm = 35.3100, GNorm = 1.6332, lr_0 = 1.0793e-04
Validation rmse = 0.188196
Validation r2 = 0.428897
Validation mse = 0.035418
Epoch 54
Loss = 7.5941e-02, PNorm = 35.3136, GNorm = 0.8846, lr_0 = 1.0469e-04
Validation rmse = 0.188478
Validation r2 = 0.427186
Validation mse = 0.035524
Epoch 55
Loss = 6.8721e-02, PNorm = 35.3174, GNorm = 0.7360, lr_0 = 1.0154e-04
Loss = 8.3098e-02, PNorm = 35.3213, GNorm = 0.6173, lr_0 = 1.0000e-04
Validation rmse = 0.194799
Validation r2 = 0.388119
Validation mse = 0.037947
Epoch 56
Loss = 8.0410e-02, PNorm = 35.3242, GNorm = 1.5855, lr_0 = 1.0000e-04
Validation rmse = 0.188155
Validation r2 = 0.429143
Validation mse = 0.035402
Epoch 57
Loss = 8.2975e-02, PNorm = 35.3276, GNorm = 1.4641, lr_0 = 1.0000e-04
Validation rmse = 0.187466
Validation r2 = 0.433321
Validation mse = 0.035143
Epoch 58
Loss = 6.1317e-02, PNorm = 35.3311, GNorm = 1.4094, lr_0 = 1.0000e-04
Loss = 8.5042e-02, PNorm = 35.3347, GNorm = 0.5032, lr_0 = 1.0000e-04
Validation rmse = 0.183338
Validation r2 = 0.458002
Validation mse = 0.033613
Epoch 59
Loss = 8.7127e-02, PNorm = 35.3382, GNorm = 0.7662, lr_0 = 1.0000e-04
Validation rmse = 0.184682
Validation r2 = 0.450024
Validation mse = 0.034108
Model 0 best validation rmse = 0.164981 on epoch 6
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.206279
Model 0 test r2 = 0.389163
Model 0 test mse = 0.042551
Ensemble test rmse = 0.206279
Ensemble test r2 = 0.389163
Ensemble test mse = 0.042551
Fold 10
Splitting data with seed 10
Total size = 705 | train size = 697 | val size = 8 | test size = 317
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.4958e-01, PNorm = 34.0180, GNorm = 10.6327, lr_0 = 4.8077e-04
Validation rmse = 0.384380
Validation r2 = -0.640983
Validation mse = 0.147748
Epoch 1
Loss = 8.2088e-01, PNorm = 34.0500, GNorm = 3.1493, lr_0 = 8.6154e-04
Validation rmse = 0.300182
Validation r2 = -0.000807
Validation mse = 0.090109
Epoch 2
Loss = 6.2583e-01, PNorm = 34.1137, GNorm = 2.9534, lr_0 = 9.8184e-04
Loss = 4.7439e-01, PNorm = 34.1907, GNorm = 5.4250, lr_0 = 9.5231e-04
Validation rmse = 0.300034
Validation r2 = 0.000177
Validation mse = 0.090020
Epoch 3
Loss = 4.3083e-01, PNorm = 34.2555, GNorm = 2.5302, lr_0 = 9.2367e-04
Validation rmse = 0.268898
Validation r2 = 0.196920
Validation mse = 0.072306
Epoch 4
Loss = 3.6165e-01, PNorm = 34.3188, GNorm = 1.3688, lr_0 = 8.9589e-04
Validation rmse = 0.234126
Validation r2 = 0.391192
Validation mse = 0.054815
Epoch 5
Loss = 3.6655e-01, PNorm = 34.3850, GNorm = 1.0939, lr_0 = 8.6894e-04
Loss = 2.5252e-01, PNorm = 34.4464, GNorm = 1.1921, lr_0 = 8.4281e-04
Validation rmse = 0.219051
Validation r2 = 0.467069
Validation mse = 0.047983
Epoch 6
Loss = 2.6859e-01, PNorm = 34.4917, GNorm = 1.9223, lr_0 = 8.1746e-04
Validation rmse = 0.208529
Validation r2 = 0.517034
Validation mse = 0.043484
Epoch 7
Loss = 2.7296e-01, PNorm = 34.5391, GNorm = 4.0556, lr_0 = 7.9287e-04
Loss = 2.2889e-01, PNorm = 34.5923, GNorm = 2.3989, lr_0 = 7.6903e-04
Validation rmse = 0.215531
Validation r2 = 0.484058
Validation mse = 0.046453
Epoch 8
Loss = 1.7163e-01, PNorm = 34.6327, GNorm = 1.3819, lr_0 = 7.4590e-04
Validation rmse = 0.188553
Validation r2 = 0.605136
Validation mse = 0.035552
Epoch 9
Loss = 1.5851e-01, PNorm = 34.6768, GNorm = 5.4347, lr_0 = 7.2346e-04
Validation rmse = 0.204485
Validation r2 = 0.535587
Validation mse = 0.041814
Epoch 10
Loss = 2.5286e-01, PNorm = 34.7177, GNorm = 5.4011, lr_0 = 7.0170e-04
Loss = 1.5369e-01, PNorm = 34.7551, GNorm = 1.2001, lr_0 = 6.8060e-04
Validation rmse = 0.183396
Validation r2 = 0.626439
Validation mse = 0.033634
Epoch 11
Loss = 1.4557e-01, PNorm = 34.7874, GNorm = 3.8470, lr_0 = 6.6013e-04
Validation rmse = 0.175973
Validation r2 = 0.656068
Validation mse = 0.030966
Epoch 12
Loss = 1.4959e-01, PNorm = 34.8189, GNorm = 4.2425, lr_0 = 6.4027e-04
Loss = 1.5190e-01, PNorm = 34.8460, GNorm = 1.4124, lr_0 = 6.2102e-04
Validation rmse = 0.187095
Validation r2 = 0.611219
Validation mse = 0.035004
Epoch 13
Loss = 1.2921e-01, PNorm = 34.8735, GNorm = 1.9520, lr_0 = 6.0234e-04
Validation rmse = 0.174964
Validation r2 = 0.660000
Validation mse = 0.030612
Epoch 14
Loss = 1.1070e-01, PNorm = 34.9015, GNorm = 2.0269, lr_0 = 5.8422e-04
Validation rmse = 0.180978
Validation r2 = 0.636226
Validation mse = 0.032753
Epoch 15
Loss = 1.7868e-01, PNorm = 34.9224, GNorm = 3.7939, lr_0 = 5.6665e-04
Loss = 1.3616e-01, PNorm = 34.9410, GNorm = 1.0267, lr_0 = 5.4961e-04
Validation rmse = 0.175143
Validation r2 = 0.659304
Validation mse = 0.030675
Epoch 16
Loss = 1.2242e-01, PNorm = 34.9585, GNorm = 2.0846, lr_0 = 5.3308e-04
Validation rmse = 0.164875
Validation r2 = 0.698080
Validation mse = 0.027184
Epoch 17
Loss = 9.9189e-02, PNorm = 34.9815, GNorm = 0.7904, lr_0 = 5.1547e-04
Loss = 1.3582e-01, PNorm = 34.9963, GNorm = 0.6739, lr_0 = 4.9996e-04
Validation rmse = 0.153742
Validation r2 = 0.737478
Validation mse = 0.023637
Epoch 18
Loss = 1.1809e-01, PNorm = 35.0200, GNorm = 2.7293, lr_0 = 4.8493e-04
Validation rmse = 0.159039
Validation r2 = 0.719074
Validation mse = 0.025294
Epoch 19
Loss = 1.1354e-01, PNorm = 35.0358, GNorm = 0.8088, lr_0 = 4.7034e-04
Validation rmse = 0.153568
Validation r2 = 0.738071
Validation mse = 0.023583
Epoch 20
Loss = 1.1520e-01, PNorm = 35.0541, GNorm = 2.3253, lr_0 = 4.5620e-04
Loss = 1.1141e-01, PNorm = 35.0689, GNorm = 2.8371, lr_0 = 4.4247e-04
Validation rmse = 0.152824
Validation r2 = 0.740602
Validation mse = 0.023355
Epoch 21
Loss = 1.0489e-01, PNorm = 35.0833, GNorm = 3.8689, lr_0 = 4.2917e-04
Validation rmse = 0.147995
Validation r2 = 0.756737
Validation mse = 0.021903
Epoch 22
Loss = 1.0864e-01, PNorm = 35.0967, GNorm = 0.5771, lr_0 = 4.1626e-04
Loss = 1.1975e-01, PNorm = 35.1116, GNorm = 1.0963, lr_0 = 4.0374e-04
Validation rmse = 0.165635
Validation r2 = 0.695292
Validation mse = 0.027435
Epoch 23
Loss = 1.2297e-01, PNorm = 35.1254, GNorm = 2.1801, lr_0 = 3.9160e-04
Validation rmse = 0.149272
Validation r2 = 0.752520
Validation mse = 0.022282
Epoch 24
Loss = 8.9666e-02, PNorm = 35.1399, GNorm = 0.9253, lr_0 = 3.7982e-04
Validation rmse = 0.145899
Validation r2 = 0.763579
Validation mse = 0.021286
Epoch 25
Loss = 9.1905e-02, PNorm = 35.1534, GNorm = 2.1913, lr_0 = 3.6839e-04
Loss = 1.0174e-01, PNorm = 35.1679, GNorm = 1.4373, lr_0 = 3.5731e-04
Validation rmse = 0.138624
Validation r2 = 0.786567
Validation mse = 0.019217
Epoch 26
Loss = 9.6017e-02, PNorm = 35.1786, GNorm = 1.7564, lr_0 = 3.4657e-04
Validation rmse = 0.147031
Validation r2 = 0.759896
Validation mse = 0.021618
Epoch 27
Loss = 9.0641e-02, PNorm = 35.1907, GNorm = 2.8575, lr_0 = 3.3614e-04
Loss = 1.1345e-01, PNorm = 35.2026, GNorm = 2.8207, lr_0 = 3.2603e-04
Validation rmse = 0.156475
Validation r2 = 0.728062
Validation mse = 0.024484
Epoch 28
Loss = 9.2831e-02, PNorm = 35.2155, GNorm = 1.1648, lr_0 = 3.1623e-04
Validation rmse = 0.144981
Validation r2 = 0.766544
Validation mse = 0.021020
Epoch 29
Loss = 9.4553e-02, PNorm = 35.2280, GNorm = 2.8074, lr_0 = 3.0672e-04
Validation rmse = 0.139598
Validation r2 = 0.783558
Validation mse = 0.019488
Epoch 30
Loss = 1.1351e-01, PNorm = 35.2397, GNorm = 2.2996, lr_0 = 2.9749e-04
Loss = 9.8681e-02, PNorm = 35.2531, GNorm = 1.1572, lr_0 = 2.8854e-04
Validation rmse = 0.139667
Validation r2 = 0.783344
Validation mse = 0.019507
Epoch 31
Loss = 9.8932e-02, PNorm = 35.2633, GNorm = 2.2668, lr_0 = 2.7987e-04
Validation rmse = 0.139852
Validation r2 = 0.782770
Validation mse = 0.019559
Epoch 32
Loss = 9.6965e-02, PNorm = 35.2743, GNorm = 1.0000, lr_0 = 2.7145e-04
Loss = 8.6258e-02, PNorm = 35.2835, GNorm = 0.5640, lr_0 = 2.6328e-04
Validation rmse = 0.136044
Validation r2 = 0.794438
Validation mse = 0.018508
Epoch 33
Loss = 9.1805e-02, PNorm = 35.2940, GNorm = 1.5306, lr_0 = 2.5537e-04
Validation rmse = 0.141346
Validation r2 = 0.778103
Validation mse = 0.019979
Epoch 34
Loss = 9.1924e-02, PNorm = 35.3054, GNorm = 0.7116, lr_0 = 2.4693e-04
Validation rmse = 0.131851
Validation r2 = 0.806914
Validation mse = 0.017385
Epoch 35
Loss = 1.0106e-01, PNorm = 35.3126, GNorm = 2.9316, lr_0 = 2.3950e-04
Loss = 8.5440e-02, PNorm = 35.3216, GNorm = 0.7411, lr_0 = 2.3230e-04
Validation rmse = 0.136523
Validation r2 = 0.792988
Validation mse = 0.018639
Epoch 36
Loss = 8.3009e-02, PNorm = 35.3308, GNorm = 0.7148, lr_0 = 2.2531e-04
Validation rmse = 0.129115
Validation r2 = 0.814846
Validation mse = 0.016671
Epoch 37
Loss = 8.9181e-02, PNorm = 35.3389, GNorm = 0.6428, lr_0 = 2.1854e-04
Validation rmse = 0.130799
Validation r2 = 0.809982
Validation mse = 0.017108
Epoch 38
Loss = 5.9385e-02, PNorm = 35.3482, GNorm = 0.6750, lr_0 = 2.1196e-04
Loss = 8.5717e-02, PNorm = 35.3546, GNorm = 0.7170, lr_0 = 2.0559e-04
Validation rmse = 0.132138
Validation r2 = 0.806073
Validation mse = 0.017460
Epoch 39
Loss = 9.0850e-02, PNorm = 35.3631, GNorm = 1.3652, lr_0 = 1.9940e-04
Validation rmse = 0.129871
Validation r2 = 0.812670
Validation mse = 0.016866
Epoch 40
Loss = 9.1059e-02, PNorm = 35.3717, GNorm = 0.9053, lr_0 = 1.9341e-04
Loss = 8.6214e-02, PNorm = 35.3804, GNorm = 1.2868, lr_0 = 1.8759e-04
Validation rmse = 0.129117
Validation r2 = 0.814839
Validation mse = 0.016671
Epoch 41
Loss = 8.0333e-02, PNorm = 35.3873, GNorm = 1.2849, lr_0 = 1.8195e-04
Validation rmse = 0.124422
Validation r2 = 0.828059
Validation mse = 0.015481
Epoch 42
Loss = 8.1393e-02, PNorm = 35.3938, GNorm = 1.4598, lr_0 = 1.7648e-04
Validation rmse = 0.131199
Validation r2 = 0.808820
Validation mse = 0.017213
Epoch 43
Loss = 1.2465e-01, PNorm = 35.4000, GNorm = 1.2400, lr_0 = 1.7117e-04
Loss = 8.4147e-02, PNorm = 35.4067, GNorm = 2.1928, lr_0 = 1.6602e-04
Validation rmse = 0.132806
Validation r2 = 0.804107
Validation mse = 0.017637
Epoch 44
Loss = 8.4120e-02, PNorm = 35.4140, GNorm = 0.7723, lr_0 = 1.6103e-04
Validation rmse = 0.134030
Validation r2 = 0.800480
Validation mse = 0.017964
Epoch 45
Loss = 7.7040e-02, PNorm = 35.4192, GNorm = 0.8950, lr_0 = 1.5618e-04
Loss = 7.7133e-02, PNorm = 35.4265, GNorm = 1.1700, lr_0 = 1.5149e-04
Validation rmse = 0.129380
Validation r2 = 0.814084
Validation mse = 0.016739
Epoch 46
Loss = 7.8026e-02, PNorm = 35.4324, GNorm = 0.4326, lr_0 = 1.4693e-04
Validation rmse = 0.131786
Validation r2 = 0.807106
Validation mse = 0.017367
Epoch 47
Loss = 7.6163e-02, PNorm = 35.4375, GNorm = 0.6473, lr_0 = 1.4251e-04
Validation rmse = 0.126834
Validation r2 = 0.821329
Validation mse = 0.016087
Epoch 48
Loss = 8.4324e-02, PNorm = 35.4431, GNorm = 1.2885, lr_0 = 1.3822e-04
Loss = 7.4920e-02, PNorm = 35.4486, GNorm = 2.4170, lr_0 = 1.3407e-04
Validation rmse = 0.124655
Validation r2 = 0.827416
Validation mse = 0.015539
Epoch 49
Loss = 7.1376e-02, PNorm = 35.4541, GNorm = 0.5740, lr_0 = 1.3003e-04
Validation rmse = 0.133637
Validation r2 = 0.801647
Validation mse = 0.017859
Epoch 50
Loss = 5.0201e-02, PNorm = 35.4588, GNorm = 0.3875, lr_0 = 1.2612e-04
Loss = 8.4151e-02, PNorm = 35.4647, GNorm = 0.8178, lr_0 = 1.2233e-04
Loss = 7.3959e-02, PNorm = 35.4652, GNorm = 2.7082, lr_0 = 1.2196e-04
Validation rmse = 0.125988
Validation r2 = 0.823706
Validation mse = 0.015873
Epoch 51
Loss = 7.1846e-02, PNorm = 35.4695, GNorm = 0.5706, lr_0 = 1.1829e-04
Validation rmse = 0.127963
Validation r2 = 0.818135
Validation mse = 0.016374
Epoch 52
Loss = 8.0053e-02, PNorm = 35.4748, GNorm = 1.1553, lr_0 = 1.1473e-04
Validation rmse = 0.126191
Validation r2 = 0.823137
Validation mse = 0.015924
Epoch 53
Loss = 8.4550e-02, PNorm = 35.4799, GNorm = 1.4964, lr_0 = 1.1128e-04
Loss = 8.0711e-02, PNorm = 35.4843, GNorm = 0.6476, lr_0 = 1.0793e-04
Validation rmse = 0.125457
Validation r2 = 0.825189
Validation mse = 0.015739
Epoch 54
Loss = 7.0009e-02, PNorm = 35.4883, GNorm = 0.8308, lr_0 = 1.0469e-04
Validation rmse = 0.126205
Validation r2 = 0.823097
Validation mse = 0.015928
Epoch 55
Loss = 6.9961e-02, PNorm = 35.4924, GNorm = 0.4306, lr_0 = 1.0154e-04
Loss = 7.4281e-02, PNorm = 35.4967, GNorm = 0.5771, lr_0 = 1.0000e-04
Validation rmse = 0.126952
Validation r2 = 0.820996
Validation mse = 0.016117
Epoch 56
Loss = 7.0370e-02, PNorm = 35.5008, GNorm = 0.7999, lr_0 = 1.0000e-04
Validation rmse = 0.124702
Validation r2 = 0.827286
Validation mse = 0.015551
Epoch 57
Loss = 8.1973e-02, PNorm = 35.5045, GNorm = 0.8434, lr_0 = 1.0000e-04
Validation rmse = 0.124327
Validation r2 = 0.828324
Validation mse = 0.015457
Epoch 58
Loss = 7.5464e-02, PNorm = 35.5085, GNorm = 0.7635, lr_0 = 1.0000e-04
Loss = 7.5110e-02, PNorm = 35.5127, GNorm = 0.6116, lr_0 = 1.0000e-04
Validation rmse = 0.127233
Validation r2 = 0.820203
Validation mse = 0.016188
Epoch 59
Loss = 7.3770e-02, PNorm = 35.5162, GNorm = 0.5821, lr_0 = 1.0000e-04
Validation rmse = 0.122831
Validation r2 = 0.832430
Validation mse = 0.015087
Model 0 best validation rmse = 0.122831 on epoch 59
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.163575
Model 0 test r2 = 0.615894
Model 0 test mse = 0.026757
Ensemble test rmse = 0.163575
Ensemble test r2 = 0.615894
Ensemble test mse = 0.026757
11-fold cross validation
	Seed 0 ==> test rmse = 0.186704
	Seed 0 ==> test r2 = 0.499592
	Seed 0 ==> test mse = 0.034858
	Seed 1 ==> test rmse = 0.159954
	Seed 1 ==> test r2 = 0.632712
	Seed 1 ==> test mse = 0.025585
	Seed 2 ==> test rmse = 0.166679
	Seed 2 ==> test r2 = 0.601178
	Seed 2 ==> test mse = 0.027782
	Seed 3 ==> test rmse = 0.150310
	Seed 3 ==> test r2 = 0.675666
	Seed 3 ==> test mse = 0.022593
	Seed 4 ==> test rmse = 0.146861
	Seed 4 ==> test r2 = 0.690379
	Seed 4 ==> test mse = 0.021568
	Seed 5 ==> test rmse = 0.190110
	Seed 5 ==> test r2 = 0.481171
	Seed 5 ==> test mse = 0.036142
	Seed 6 ==> test rmse = 0.161231
	Seed 6 ==> test r2 = 0.626824
	Seed 6 ==> test mse = 0.025996
	Seed 7 ==> test rmse = 0.183398
	Seed 7 ==> test r2 = 0.517159
	Seed 7 ==> test mse = 0.033635
	Seed 8 ==> test rmse = 0.176042
	Seed 8 ==> test r2 = 0.555114
	Seed 8 ==> test mse = 0.030991
	Seed 9 ==> test rmse = 0.206279
	Seed 9 ==> test r2 = 0.389163
	Seed 9 ==> test mse = 0.042551
	Seed 10 ==> test rmse = 0.163575
	Seed 10 ==> test r2 = 0.615894
	Seed 10 ==> test mse = 0.026757
Overall test rmse = 0.171922 +/- 0.017394
Overall test r2 = 0.571350 +/- 0.087615
Overall test mse = 0.029860 +/- 0.006103
Elapsed time = 0:06:08
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-1d5c3576-9790-4896-9034-9bb28ba18d8e.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/EtOH_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2', 'mse'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2', 'mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 11,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/generalization_3/EtOH_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/EtOH_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 966 | train size = 956 | val size = 10 | test size = 56
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1442e-01, PNorm = 34.0138, GNorm = 4.1385, lr_0 = 3.6053e-04
Validation rmse = 0.253392
Validation r2 = 0.187292
Validation mse = 0.064207
Epoch 1
Loss = 8.4964e-01, PNorm = 34.0384, GNorm = 5.1816, lr_0 = 6.2105e-04
Loss = 6.7760e-01, PNorm = 34.0811, GNorm = 16.6353, lr_0 = 8.5789e-04
Validation rmse = 0.204478
Validation r2 = 0.470771
Validation mse = 0.041811
Epoch 2
Loss = 3.6343e-01, PNorm = 34.1496, GNorm = 2.5348, lr_0 = 9.8961e-04
Loss = 4.3295e-01, PNorm = 34.2307, GNorm = 2.1745, lr_0 = 9.6914e-04
Validation rmse = 0.160001
Validation r2 = 0.675964
Validation mse = 0.025600
Epoch 3
Loss = 3.3174e-01, PNorm = 34.3047, GNorm = 2.2208, lr_0 = 9.4712e-04
Loss = 3.6278e-01, PNorm = 34.3653, GNorm = 4.2906, lr_0 = 9.2754e-04
Validation rmse = 0.162253
Validation r2 = 0.666778
Validation mse = 0.026326
Epoch 4
Loss = 3.5555e-01, PNorm = 34.4227, GNorm = 7.7976, lr_0 = 9.0646e-04
Loss = 2.3385e-01, PNorm = 34.4658, GNorm = 2.6415, lr_0 = 8.8772e-04
Validation rmse = 0.205595
Validation r2 = 0.464972
Validation mse = 0.042269
Epoch 5
Loss = 3.2692e-01, PNorm = 34.5201, GNorm = 10.1295, lr_0 = 8.6755e-04
Loss = 3.2688e-01, PNorm = 34.5685, GNorm = 3.2579, lr_0 = 8.4961e-04
Validation rmse = 0.151194
Validation r2 = 0.710652
Validation mse = 0.022860
Epoch 6
Loss = 2.6810e-01, PNorm = 34.6063, GNorm = 3.1955, lr_0 = 8.3031e-04
Loss = 2.6258e-01, PNorm = 34.6420, GNorm = 5.2688, lr_0 = 8.1314e-04
Validation rmse = 0.169076
Validation r2 = 0.638161
Validation mse = 0.028587
Epoch 7
Loss = 2.3026e-01, PNorm = 34.6830, GNorm = 4.9156, lr_0 = 7.9466e-04
Loss = 1.8427e-01, PNorm = 34.7188, GNorm = 2.2798, lr_0 = 7.7823e-04
Validation rmse = 0.122798
Validation r2 = 0.809131
Validation mse = 0.015079
Epoch 8
Loss = 1.4811e-01, PNorm = 34.7525, GNorm = 0.8742, lr_0 = 7.6055e-04
Loss = 1.8475e-01, PNorm = 34.7780, GNorm = 0.6564, lr_0 = 7.4482e-04
Validation rmse = 0.114885
Validation r2 = 0.832937
Validation mse = 0.013199
Epoch 9
Loss = 1.4017e-01, PNorm = 34.8031, GNorm = 5.1941, lr_0 = 7.2942e-04
Loss = 1.8594e-01, PNorm = 34.8288, GNorm = 1.0598, lr_0 = 7.1434e-04
Validation rmse = 0.127638
Validation r2 = 0.793791
Validation mse = 0.016291
Epoch 10
Loss = 1.6204e-01, PNorm = 34.8567, GNorm = 3.4500, lr_0 = 6.9810e-04
Loss = 1.4057e-01, PNorm = 34.8785, GNorm = 1.1153, lr_0 = 6.8367e-04
Loss = 1.5201e-01, PNorm = 34.8812, GNorm = 4.2057, lr_0 = 6.8224e-04
Validation rmse = 0.118887
Validation r2 = 0.821098
Validation mse = 0.014134
Epoch 11
Loss = 1.1635e-01, PNorm = 34.9050, GNorm = 0.4830, lr_0 = 6.6813e-04
Validation rmse = 0.143758
Validation r2 = 0.738414
Validation mse = 0.020666
Epoch 12
Loss = 1.9528e-01, PNorm = 34.9215, GNorm = 2.5122, lr_0 = 6.5295e-04
Loss = 1.3453e-01, PNorm = 34.9383, GNorm = 1.4291, lr_0 = 6.3945e-04
Validation rmse = 0.113168
Validation r2 = 0.837894
Validation mse = 0.012807
Epoch 13
Loss = 1.2564e-01, PNorm = 34.9608, GNorm = 1.7397, lr_0 = 6.2492e-04
Loss = 1.2362e-01, PNorm = 34.9723, GNorm = 0.7045, lr_0 = 6.1200e-04
Validation rmse = 0.163104
Validation r2 = 0.663273
Validation mse = 0.026603
Epoch 14
Loss = 1.2159e-01, PNorm = 34.9850, GNorm = 2.1825, lr_0 = 5.9809e-04
Loss = 1.3232e-01, PNorm = 34.9975, GNorm = 1.8572, lr_0 = 5.8573e-04
Validation rmse = 0.109726
Validation r2 = 0.847605
Validation mse = 0.012040
Epoch 15
Loss = 1.1156e-01, PNorm = 35.0210, GNorm = 1.0286, lr_0 = 5.7242e-04
Loss = 1.1140e-01, PNorm = 35.0381, GNorm = 0.9101, lr_0 = 5.6058e-04
Validation rmse = 0.144851
Validation r2 = 0.734422
Validation mse = 0.020982
Epoch 16
Loss = 1.0660e-01, PNorm = 35.0544, GNorm = 1.2777, lr_0 = 5.4784e-04
Loss = 1.1438e-01, PNorm = 35.0670, GNorm = 0.9735, lr_0 = 5.3652e-04
Validation rmse = 0.115691
Validation r2 = 0.830587
Validation mse = 0.013384
Epoch 17
Loss = 1.1351e-01, PNorm = 35.0761, GNorm = 3.2395, lr_0 = 5.2542e-04
Loss = 1.2253e-01, PNorm = 35.0894, GNorm = 1.2260, lr_0 = 5.1456e-04
Validation rmse = 0.104239
Validation r2 = 0.862467
Validation mse = 0.010866
Epoch 18
Loss = 1.1059e-01, PNorm = 35.1007, GNorm = 0.7767, lr_0 = 5.0287e-04
Loss = 1.2269e-01, PNorm = 35.1206, GNorm = 1.4752, lr_0 = 4.9247e-04
Validation rmse = 0.123974
Validation r2 = 0.805459
Validation mse = 0.015370
Epoch 19
Loss = 1.2092e-01, PNorm = 35.1425, GNorm = 3.0480, lr_0 = 4.8128e-04
Loss = 1.2734e-01, PNorm = 35.1588, GNorm = 1.6332, lr_0 = 4.7133e-04
Validation rmse = 0.120323
Validation r2 = 0.816749
Validation mse = 0.014478
Epoch 20
Loss = 1.0872e-01, PNorm = 35.1707, GNorm = 0.9925, lr_0 = 4.6062e-04
Loss = 1.0567e-01, PNorm = 35.1840, GNorm = 0.5491, lr_0 = 4.5109e-04
Validation rmse = 0.133481
Validation r2 = 0.774479
Validation mse = 0.017817
Epoch 21
Loss = 9.9097e-02, PNorm = 35.2002, GNorm = 1.7697, lr_0 = 4.4084e-04
Loss = 1.2115e-01, PNorm = 35.2149, GNorm = 1.4898, lr_0 = 4.3173e-04
Loss = 1.2119e-01, PNorm = 35.2165, GNorm = 1.9205, lr_0 = 4.3083e-04
Validation rmse = 0.135630
Validation r2 = 0.767156
Validation mse = 0.018396
Epoch 22
Loss = 1.1368e-01, PNorm = 35.2274, GNorm = 1.7307, lr_0 = 4.2192e-04
Validation rmse = 0.101928
Validation r2 = 0.868497
Validation mse = 0.010389
Epoch 23
Loss = 1.0396e-01, PNorm = 35.2434, GNorm = 1.6022, lr_0 = 4.1233e-04
Loss = 1.2705e-01, PNorm = 35.2590, GNorm = 4.5809, lr_0 = 4.0380e-04
Validation rmse = 0.109092
Validation r2 = 0.849363
Validation mse = 0.011901
Epoch 24
Loss = 1.2833e-01, PNorm = 35.2728, GNorm = 3.6083, lr_0 = 3.9463e-04
Loss = 1.1727e-01, PNorm = 35.2863, GNorm = 1.6958, lr_0 = 3.8647e-04
Validation rmse = 0.094873
Validation r2 = 0.886070
Validation mse = 0.009001
Epoch 25
Loss = 1.1073e-01, PNorm = 35.2968, GNorm = 2.3466, lr_0 = 3.7848e-04
Loss = 1.0761e-01, PNorm = 35.3070, GNorm = 1.9491, lr_0 = 3.7065e-04
Validation rmse = 0.100865
Validation r2 = 0.871224
Validation mse = 0.010174
Epoch 26
Loss = 8.6092e-02, PNorm = 35.3156, GNorm = 0.5059, lr_0 = 3.6223e-04
Loss = 9.6826e-02, PNorm = 35.3215, GNorm = 0.8324, lr_0 = 3.5474e-04
Validation rmse = 0.122665
Validation r2 = 0.809546
Validation mse = 0.015047
Epoch 27
Loss = 9.2111e-02, PNorm = 35.3325, GNorm = 0.9768, lr_0 = 3.4668e-04
Loss = 9.9998e-02, PNorm = 35.3445, GNorm = 0.5616, lr_0 = 3.3951e-04
Validation rmse = 0.100092
Validation r2 = 0.873192
Validation mse = 0.010018
Epoch 28
Loss = 9.6639e-02, PNorm = 35.3552, GNorm = 0.5713, lr_0 = 3.3180e-04
Loss = 9.7402e-02, PNorm = 35.3638, GNorm = 2.0582, lr_0 = 3.2494e-04
Validation rmse = 0.097182
Validation r2 = 0.880458
Validation mse = 0.009444
Epoch 29
Loss = 1.1822e-01, PNorm = 35.3753, GNorm = 2.2614, lr_0 = 3.1755e-04
Loss = 1.0432e-01, PNorm = 35.3835, GNorm = 0.5485, lr_0 = 3.1099e-04
Validation rmse = 0.091960
Validation r2 = 0.892958
Validation mse = 0.008457
Epoch 30
Loss = 1.1421e-01, PNorm = 35.3932, GNorm = 1.8598, lr_0 = 3.0392e-04
Loss = 9.3326e-02, PNorm = 35.4025, GNorm = 1.5736, lr_0 = 2.9764e-04
Validation rmse = 0.097854
Validation r2 = 0.878800
Validation mse = 0.009575
Epoch 31
Loss = 1.1998e-01, PNorm = 35.4106, GNorm = 2.1989, lr_0 = 2.9087e-04
Loss = 8.8969e-02, PNorm = 35.4168, GNorm = 1.3152, lr_0 = 2.8486e-04
Validation rmse = 0.092298
Validation r2 = 0.892172
Validation mse = 0.008519
Epoch 32
Loss = 9.8243e-02, PNorm = 35.4287, GNorm = 2.2682, lr_0 = 2.7839e-04
Loss = 9.9954e-02, PNorm = 35.4361, GNorm = 0.6071, lr_0 = 2.7263e-04
Loss = 3.8927e-01, PNorm = 35.4357, GNorm = 10.8737, lr_0 = 2.7206e-04
Validation rmse = 0.115373
Validation r2 = 0.831516
Validation mse = 0.013311
Epoch 33
Loss = 1.1213e-01, PNorm = 35.4442, GNorm = 2.6733, lr_0 = 2.6643e-04
Loss = 9.5944e-02, PNorm = 35.4515, GNorm = 2.7109, lr_0 = 2.6092e-04
Validation rmse = 0.139081
Validation r2 = 0.755157
Validation mse = 0.019344
Epoch 34
Loss = 1.1200e-01, PNorm = 35.4585, GNorm = 3.9687, lr_0 = 2.5553e-04
Validation rmse = 0.092814
Validation r2 = 0.890962
Validation mse = 0.008614
Epoch 35
Loss = 8.1127e-02, PNorm = 35.4687, GNorm = 2.0493, lr_0 = 2.4972e-04
Loss = 9.0658e-02, PNorm = 35.4767, GNorm = 0.4220, lr_0 = 2.4456e-04
Validation rmse = 0.100878
Validation r2 = 0.871191
Validation mse = 0.010176
Epoch 36
Loss = 8.7037e-02, PNorm = 35.4841, GNorm = 1.6381, lr_0 = 2.3900e-04
Loss = 9.1105e-02, PNorm = 35.4902, GNorm = 0.5407, lr_0 = 2.3406e-04
Validation rmse = 0.102841
Validation r2 = 0.866131
Validation mse = 0.010576
Epoch 37
Loss = 8.9263e-02, PNorm = 35.4970, GNorm = 0.7334, lr_0 = 2.2874e-04
Loss = 8.1505e-02, PNorm = 35.5045, GNorm = 1.1487, lr_0 = 2.2401e-04
Validation rmse = 0.081072
Validation r2 = 0.916806
Validation mse = 0.006573
Epoch 38
Loss = 9.0321e-02, PNorm = 35.5114, GNorm = 0.5672, lr_0 = 2.1892e-04
Loss = 9.4231e-02, PNorm = 35.5166, GNorm = 1.8351, lr_0 = 2.1440e-04
Validation rmse = 0.087944
Validation r2 = 0.902105
Validation mse = 0.007734
Epoch 39
Loss = 8.9284e-02, PNorm = 35.5246, GNorm = 0.5661, lr_0 = 2.0952e-04
Loss = 8.6078e-02, PNorm = 35.5321, GNorm = 1.0998, lr_0 = 2.0519e-04
Validation rmse = 0.113264
Validation r2 = 0.837619
Validation mse = 0.012829
Epoch 40
Loss = 8.3742e-02, PNorm = 35.5384, GNorm = 0.9437, lr_0 = 2.0053e-04
Loss = 8.5496e-02, PNorm = 35.5456, GNorm = 1.0043, lr_0 = 1.9638e-04
Validation rmse = 0.081215
Validation r2 = 0.916513
Validation mse = 0.006596
Epoch 41
Loss = 8.4140e-02, PNorm = 35.5518, GNorm = 0.5294, lr_0 = 1.9192e-04
Loss = 8.5854e-02, PNorm = 35.5574, GNorm = 1.8492, lr_0 = 1.8795e-04
Validation rmse = 0.092461
Validation r2 = 0.891790
Validation mse = 0.008549
Epoch 42
Loss = 7.9984e-02, PNorm = 35.5613, GNorm = 1.0715, lr_0 = 1.8407e-04
Loss = 9.0242e-02, PNorm = 35.5667, GNorm = 1.9185, lr_0 = 1.8026e-04
Validation rmse = 0.088455
Validation r2 = 0.900964
Validation mse = 0.007824
Epoch 43
Loss = 8.5896e-02, PNorm = 35.5729, GNorm = 0.4903, lr_0 = 1.7616e-04
Loss = 8.4296e-02, PNorm = 35.5763, GNorm = 0.8964, lr_0 = 1.7252e-04
Validation rmse = 0.080249
Validation r2 = 0.918487
Validation mse = 0.006440
Epoch 44
Loss = 8.8683e-02, PNorm = 35.5835, GNorm = 1.4613, lr_0 = 1.6860e-04
Loss = 8.1191e-02, PNorm = 35.5889, GNorm = 1.5426, lr_0 = 1.6511e-04
Loss = 2.0391e-02, PNorm = 35.5892, GNorm = 1.2307, lr_0 = 1.6477e-04
Validation rmse = 0.086923
Validation r2 = 0.904365
Validation mse = 0.007556
Epoch 45
Loss = 8.5692e-02, PNorm = 35.5932, GNorm = 2.6267, lr_0 = 1.6136e-04
Validation rmse = 0.081155
Validation r2 = 0.916636
Validation mse = 0.006586
Epoch 46
Loss = 9.3518e-02, PNorm = 35.5995, GNorm = 1.0609, lr_0 = 1.5770e-04
Loss = 8.8392e-02, PNorm = 35.6070, GNorm = 2.5005, lr_0 = 1.5444e-04
Validation rmse = 0.082259
Validation r2 = 0.914353
Validation mse = 0.006766
Epoch 47
Loss = 9.2997e-02, PNorm = 35.6122, GNorm = 0.5974, lr_0 = 1.5093e-04
Loss = 8.7073e-02, PNorm = 35.6174, GNorm = 0.6592, lr_0 = 1.4781e-04
Validation rmse = 0.089846
Validation r2 = 0.897825
Validation mse = 0.008072
Epoch 48
Loss = 8.0852e-02, PNorm = 35.6222, GNorm = 1.3684, lr_0 = 1.4445e-04
Loss = 8.0379e-02, PNorm = 35.6270, GNorm = 0.9123, lr_0 = 1.4146e-04
Validation rmse = 0.093776
Validation r2 = 0.888691
Validation mse = 0.008794
Epoch 49
Loss = 8.3145e-02, PNorm = 35.6308, GNorm = 0.7563, lr_0 = 1.3825e-04
Loss = 8.0414e-02, PNorm = 35.6348, GNorm = 0.6878, lr_0 = 1.3539e-04
Validation rmse = 0.093519
Validation r2 = 0.889299
Validation mse = 0.008746
Epoch 50
Loss = 7.1213e-02, PNorm = 35.6392, GNorm = 0.5183, lr_0 = 1.3259e-04
Loss = 7.3441e-02, PNorm = 35.6420, GNorm = 1.1874, lr_0 = 1.2985e-04
Validation rmse = 0.076173
Validation r2 = 0.926557
Validation mse = 0.005802
Epoch 51
Loss = 8.5061e-02, PNorm = 35.6471, GNorm = 1.9718, lr_0 = 1.2690e-04
Loss = 7.8603e-02, PNorm = 35.6508, GNorm = 1.3432, lr_0 = 1.2427e-04
Validation rmse = 0.086518
Validation r2 = 0.905254
Validation mse = 0.007485
Epoch 52
Loss = 8.7288e-02, PNorm = 35.6547, GNorm = 0.5095, lr_0 = 1.2145e-04
Loss = 7.7438e-02, PNorm = 35.6585, GNorm = 0.4620, lr_0 = 1.1894e-04
Validation rmse = 0.091373
Validation r2 = 0.894321
Validation mse = 0.008349
Epoch 53
Loss = 8.7968e-02, PNorm = 35.6626, GNorm = 1.8211, lr_0 = 1.1623e-04
Loss = 6.9860e-02, PNorm = 35.6666, GNorm = 0.9368, lr_0 = 1.1383e-04
Validation rmse = 0.093408
Validation r2 = 0.889562
Validation mse = 0.008725
Epoch 54
Loss = 8.2240e-02, PNorm = 35.6692, GNorm = 1.5672, lr_0 = 1.1124e-04
Loss = 7.5962e-02, PNorm = 35.6735, GNorm = 0.6071, lr_0 = 1.0894e-04
Validation rmse = 0.086914
Validation r2 = 0.904383
Validation mse = 0.007554
Epoch 55
Loss = 7.8530e-02, PNorm = 35.6766, GNorm = 0.9449, lr_0 = 1.0647e-04
Loss = 8.4905e-02, PNorm = 35.6798, GNorm = 1.1203, lr_0 = 1.0427e-04
Loss = 1.3205e-01, PNorm = 35.6801, GNorm = 3.6183, lr_0 = 1.0405e-04
Validation rmse = 0.083320
Validation r2 = 0.912129
Validation mse = 0.006942
Epoch 56
Loss = 7.6978e-02, PNorm = 35.6835, GNorm = 0.5736, lr_0 = 1.0190e-04
Validation rmse = 0.089507
Validation r2 = 0.898595
Validation mse = 0.008011
Epoch 57
Loss = 3.2594e-02, PNorm = 35.6875, GNorm = 0.7431, lr_0 = 1.0000e-04
Loss = 8.5134e-02, PNorm = 35.6900, GNorm = 0.9956, lr_0 = 1.0000e-04
Validation rmse = 0.089795
Validation r2 = 0.897940
Validation mse = 0.008063
Epoch 58
Loss = 6.1630e-02, PNorm = 35.6941, GNorm = 0.9996, lr_0 = 1.0000e-04
Loss = 8.0387e-02, PNorm = 35.6977, GNorm = 1.1578, lr_0 = 1.0000e-04
Validation rmse = 0.083864
Validation r2 = 0.910976
Validation mse = 0.007033
Epoch 59
Loss = 9.2242e-02, PNorm = 35.7013, GNorm = 0.9607, lr_0 = 1.0000e-04
Loss = 7.4875e-02, PNorm = 35.7054, GNorm = 0.9062, lr_0 = 1.0000e-04
Validation rmse = 0.085825
Validation r2 = 0.906766
Validation mse = 0.007366
Model 0 best validation rmse = 0.076173 on epoch 50
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.175040
Model 0 test r2 = 0.607015
Model 0 test mse = 0.030639
Ensemble test rmse = 0.175040
Ensemble test r2 = 0.607015
Ensemble test mse = 0.030639
Fold 1
Splitting data with seed 1
Total size = 966 | train size = 956 | val size = 10 | test size = 56
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.2044e-01, PNorm = 34.0170, GNorm = 1.6240, lr_0 = 3.6053e-04
Validation rmse = 0.225462
Validation r2 = -0.701964
Validation mse = 0.050833
Epoch 1
Loss = 7.1734e-01, PNorm = 34.0481, GNorm = 2.0996, lr_0 = 6.2105e-04
Loss = 5.1856e-01, PNorm = 34.1100, GNorm = 3.3152, lr_0 = 8.5789e-04
Validation rmse = 0.175822
Validation r2 = -0.035014
Validation mse = 0.030913
Epoch 2
Loss = 5.4059e-01, PNorm = 34.1827, GNorm = 7.9919, lr_0 = 9.8961e-04
Loss = 5.4574e-01, PNorm = 34.2408, GNorm = 5.5393, lr_0 = 9.6914e-04
Validation rmse = 0.244549
Validation r2 = -1.002321
Validation mse = 0.059804
Epoch 3
Loss = 3.5622e-01, PNorm = 34.3098, GNorm = 4.5946, lr_0 = 9.4712e-04
Loss = 3.0868e-01, PNorm = 34.3658, GNorm = 3.2489, lr_0 = 9.2754e-04
Validation rmse = 0.160160
Validation r2 = 0.141165
Validation mse = 0.025651
Epoch 4
Loss = 2.6270e-01, PNorm = 34.4200, GNorm = 1.9441, lr_0 = 9.0646e-04
Loss = 2.4032e-01, PNorm = 34.4668, GNorm = 3.5172, lr_0 = 8.8772e-04
Validation rmse = 0.137923
Validation r2 = 0.363098
Validation mse = 0.019023
Epoch 5
Loss = 2.6003e-01, PNorm = 34.5269, GNorm = 10.5241, lr_0 = 8.6755e-04
Loss = 3.1158e-01, PNorm = 34.5705, GNorm = 4.1252, lr_0 = 8.4961e-04
Validation rmse = 0.227236
Validation r2 = -0.728847
Validation mse = 0.051636
Epoch 6
Loss = 2.2661e-01, PNorm = 34.6051, GNorm = 0.5494, lr_0 = 8.3031e-04
Loss = 2.1387e-01, PNorm = 34.6362, GNorm = 3.0942, lr_0 = 8.1314e-04
Validation rmse = 0.176506
Validation r2 = -0.043083
Validation mse = 0.031154
Epoch 7
Loss = 1.8745e-01, PNorm = 34.6708, GNorm = 2.6056, lr_0 = 7.9466e-04
Loss = 1.8526e-01, PNorm = 34.6991, GNorm = 5.1446, lr_0 = 7.7823e-04
Validation rmse = 0.122167
Validation r2 = 0.500298
Validation mse = 0.014925
Epoch 8
Loss = 1.6254e-01, PNorm = 34.7241, GNorm = 1.3901, lr_0 = 7.6055e-04
Loss = 1.5006e-01, PNorm = 34.7462, GNorm = 2.0500, lr_0 = 7.4482e-04
Validation rmse = 0.124228
Validation r2 = 0.483297
Validation mse = 0.015433
Epoch 9
Loss = 1.4577e-01, PNorm = 34.7641, GNorm = 1.2027, lr_0 = 7.2942e-04
Loss = 1.7059e-01, PNorm = 34.7870, GNorm = 2.3017, lr_0 = 7.1434e-04
Validation rmse = 0.104197
Validation r2 = 0.636492
Validation mse = 0.010857
Epoch 10
Loss = 1.6732e-01, PNorm = 34.8119, GNorm = 2.8323, lr_0 = 6.9810e-04
Loss = 1.3507e-01, PNorm = 34.8298, GNorm = 2.6838, lr_0 = 6.8367e-04
Loss = 2.8306e-01, PNorm = 34.8321, GNorm = 5.0899, lr_0 = 6.8224e-04
Validation rmse = 0.124808
Validation r2 = 0.478457
Validation mse = 0.015577
Epoch 11
Loss = 1.4966e-01, PNorm = 34.8493, GNorm = 1.1292, lr_0 = 6.6813e-04
Validation rmse = 0.161978
Validation r2 = 0.121552
Validation mse = 0.026237
Epoch 12
Loss = 1.4387e-01, PNorm = 34.8724, GNorm = 0.9191, lr_0 = 6.5295e-04
Loss = 1.4158e-01, PNorm = 34.8855, GNorm = 3.4194, lr_0 = 6.3945e-04
Validation rmse = 0.130519
Validation r2 = 0.429639
Validation mse = 0.017035
Epoch 13
Loss = 1.2713e-01, PNorm = 34.9006, GNorm = 3.1722, lr_0 = 6.2492e-04
Loss = 1.4531e-01, PNorm = 34.9145, GNorm = 1.3596, lr_0 = 6.1200e-04
Validation rmse = 0.260665
Validation r2 = -1.274929
Validation mse = 0.067946
Epoch 14
Loss = 2.0568e-01, PNorm = 34.9335, GNorm = 1.1519, lr_0 = 5.9809e-04
Loss = 1.7016e-01, PNorm = 34.9513, GNorm = 2.8785, lr_0 = 5.8573e-04
Validation rmse = 0.143643
Validation r2 = 0.309170
Validation mse = 0.020633
Epoch 15
Loss = 1.1425e-01, PNorm = 34.9679, GNorm = 2.1073, lr_0 = 5.7242e-04
Loss = 1.3129e-01, PNorm = 34.9875, GNorm = 1.1146, lr_0 = 5.6058e-04
Validation rmse = 0.153524
Validation r2 = 0.210864
Validation mse = 0.023569
Epoch 16
Loss = 1.5077e-01, PNorm = 35.0046, GNorm = 0.9791, lr_0 = 5.4784e-04
Loss = 1.3645e-01, PNorm = 35.0223, GNorm = 3.6825, lr_0 = 5.3652e-04
Validation rmse = 0.125909
Validation r2 = 0.469218
Validation mse = 0.015853
Epoch 17
Loss = 1.4085e-01, PNorm = 35.0325, GNorm = 2.5415, lr_0 = 5.2542e-04
Loss = 1.3378e-01, PNorm = 35.0479, GNorm = 0.7751, lr_0 = 5.1456e-04
Validation rmse = 0.198592
Validation r2 = -0.320463
Validation mse = 0.039439
Epoch 18
Loss = 1.3591e-01, PNorm = 35.0573, GNorm = 2.4995, lr_0 = 5.0287e-04
Loss = 1.2987e-01, PNorm = 35.0701, GNorm = 1.7283, lr_0 = 4.9247e-04
Validation rmse = 0.154182
Validation r2 = 0.204078
Validation mse = 0.023772
Epoch 19
Loss = 9.2767e-02, PNorm = 35.0798, GNorm = 1.3977, lr_0 = 4.8128e-04
Loss = 1.4616e-01, PNorm = 35.0936, GNorm = 4.5480, lr_0 = 4.7133e-04
Validation rmse = 0.111781
Validation r2 = 0.581652
Validation mse = 0.012495
Epoch 20
Loss = 1.1936e-01, PNorm = 35.1063, GNorm = 0.7665, lr_0 = 4.6062e-04
Loss = 1.1182e-01, PNorm = 35.1198, GNorm = 0.7597, lr_0 = 4.5109e-04
Validation rmse = 0.164815
Validation r2 = 0.090512
Validation mse = 0.027164
Epoch 21
Loss = 9.9529e-02, PNorm = 35.1337, GNorm = 0.6970, lr_0 = 4.4084e-04
Loss = 1.1844e-01, PNorm = 35.1443, GNorm = 0.6615, lr_0 = 4.3173e-04
Loss = 5.6303e-02, PNorm = 35.1453, GNorm = 1.5228, lr_0 = 4.3083e-04
Validation rmse = 0.180801
Validation r2 = -0.094470
Validation mse = 0.032689
Epoch 22
Loss = 9.9854e-02, PNorm = 35.1515, GNorm = 0.8844, lr_0 = 4.2192e-04
Validation rmse = 0.178343
Validation r2 = -0.064915
Validation mse = 0.031806
Epoch 23
Loss = 4.4071e-02, PNorm = 35.1643, GNorm = 1.2002, lr_0 = 4.1233e-04
Loss = 1.0824e-01, PNorm = 35.1757, GNorm = 0.5519, lr_0 = 4.0380e-04
Validation rmse = 0.142395
Validation r2 = 0.321122
Validation mse = 0.020276
Epoch 24
Loss = 9.7017e-02, PNorm = 35.1870, GNorm = 1.5176, lr_0 = 3.9463e-04
Loss = 1.0465e-01, PNorm = 35.1962, GNorm = 0.7951, lr_0 = 3.8647e-04
Validation rmse = 0.161586
Validation r2 = 0.125801
Validation mse = 0.026110
Epoch 25
Loss = 1.0012e-01, PNorm = 35.2056, GNorm = 0.5036, lr_0 = 3.7848e-04
Loss = 1.0522e-01, PNorm = 35.2153, GNorm = 0.7511, lr_0 = 3.7065e-04
Validation rmse = 0.152698
Validation r2 = 0.219332
Validation mse = 0.023317
Epoch 26
Loss = 8.6381e-02, PNorm = 35.2270, GNorm = 2.1846, lr_0 = 3.6223e-04
Loss = 1.0783e-01, PNorm = 35.2356, GNorm = 1.2361, lr_0 = 3.5474e-04
Validation rmse = 0.127446
Validation r2 = 0.456185
Validation mse = 0.016242
Epoch 27
Loss = 9.6203e-02, PNorm = 35.2480, GNorm = 0.7055, lr_0 = 3.4668e-04
Loss = 9.8114e-02, PNorm = 35.2540, GNorm = 1.0947, lr_0 = 3.3951e-04
Validation rmse = 0.174943
Validation r2 = -0.024696
Validation mse = 0.030605
Epoch 28
Loss = 1.1420e-01, PNorm = 35.2683, GNorm = 2.4731, lr_0 = 3.3180e-04
Loss = 8.6655e-02, PNorm = 35.2767, GNorm = 1.0902, lr_0 = 3.2494e-04
Validation rmse = 0.147883
Validation r2 = 0.267789
Validation mse = 0.021869
Epoch 29
Loss = 1.0541e-01, PNorm = 35.2854, GNorm = 2.3834, lr_0 = 3.1755e-04
Loss = 1.0040e-01, PNorm = 35.2938, GNorm = 1.7835, lr_0 = 3.1099e-04
Validation rmse = 0.150550
Validation r2 = 0.241140
Validation mse = 0.022665
Epoch 30
Loss = 9.6907e-02, PNorm = 35.3037, GNorm = 0.6703, lr_0 = 3.0392e-04
Loss = 1.0003e-01, PNorm = 35.3136, GNorm = 2.8434, lr_0 = 2.9764e-04
Validation rmse = 0.154515
Validation r2 = 0.200637
Validation mse = 0.023875
Epoch 31
Loss = 1.0289e-01, PNorm = 35.3233, GNorm = 1.6901, lr_0 = 2.9087e-04
Loss = 9.2382e-02, PNorm = 35.3316, GNorm = 2.4949, lr_0 = 2.8486e-04
Validation rmse = 0.156515
Validation r2 = 0.179815
Validation mse = 0.024497
Epoch 32
Loss = 1.1791e-01, PNorm = 35.3402, GNorm = 5.4254, lr_0 = 2.7839e-04
Loss = 1.0623e-01, PNorm = 35.3497, GNorm = 2.5346, lr_0 = 2.7263e-04
Loss = 9.7447e-02, PNorm = 35.3502, GNorm = 5.1161, lr_0 = 2.7206e-04
Validation rmse = 0.148231
Validation r2 = 0.264337
Validation mse = 0.021972
Epoch 33
Loss = 8.1650e-02, PNorm = 35.3594, GNorm = 0.8665, lr_0 = 2.6643e-04
Loss = 1.3268e-01, PNorm = 35.3673, GNorm = 5.8912, lr_0 = 2.6092e-04
Validation rmse = 0.140338
Validation r2 = 0.340593
Validation mse = 0.019695
Epoch 34
Loss = 9.5633e-02, PNorm = 35.3771, GNorm = 0.6060, lr_0 = 2.5553e-04
Validation rmse = 0.175267
Validation r2 = -0.028496
Validation mse = 0.030719
Epoch 35
Loss = 7.2982e-02, PNorm = 35.3853, GNorm = 1.4931, lr_0 = 2.4972e-04
Loss = 1.0056e-01, PNorm = 35.3904, GNorm = 2.8226, lr_0 = 2.4456e-04
Validation rmse = 0.165645
Validation r2 = 0.081337
Validation mse = 0.027438
Epoch 36
Loss = 9.8024e-02, PNorm = 35.3977, GNorm = 0.7812, lr_0 = 2.3900e-04
Loss = 9.1481e-02, PNorm = 35.4042, GNorm = 1.4228, lr_0 = 2.3406e-04
Validation rmse = 0.137756
Validation r2 = 0.364635
Validation mse = 0.018977
Epoch 37
Loss = 7.5394e-02, PNorm = 35.4111, GNorm = 1.0192, lr_0 = 2.2874e-04
Loss = 9.7944e-02, PNorm = 35.4189, GNorm = 0.9395, lr_0 = 2.2401e-04
Validation rmse = 0.149188
Validation r2 = 0.254807
Validation mse = 0.022257
Epoch 38
Loss = 7.7748e-02, PNorm = 35.4249, GNorm = 0.4153, lr_0 = 2.1892e-04
Loss = 9.1838e-02, PNorm = 35.4302, GNorm = 1.3469, lr_0 = 2.1440e-04
Validation rmse = 0.137929
Validation r2 = 0.363035
Validation mse = 0.019025
Epoch 39
Loss = 7.6674e-02, PNorm = 35.4377, GNorm = 0.8215, lr_0 = 2.0952e-04
Loss = 9.5573e-02, PNorm = 35.4448, GNorm = 2.1600, lr_0 = 2.0519e-04
Validation rmse = 0.175798
Validation r2 = -0.034739
Validation mse = 0.030905
Epoch 40
Loss = 9.7037e-02, PNorm = 35.4513, GNorm = 1.2883, lr_0 = 2.0053e-04
Loss = 8.7956e-02, PNorm = 35.4565, GNorm = 1.0915, lr_0 = 1.9638e-04
Validation rmse = 0.159919
Validation r2 = 0.143747
Validation mse = 0.025574
Epoch 41
Loss = 8.4949e-02, PNorm = 35.4631, GNorm = 2.3251, lr_0 = 1.9192e-04
Loss = 9.1917e-02, PNorm = 35.4681, GNorm = 0.7501, lr_0 = 1.8795e-04
Validation rmse = 0.137402
Validation r2 = 0.367898
Validation mse = 0.018879
Epoch 42
Loss = 7.9968e-02, PNorm = 35.4732, GNorm = 0.6315, lr_0 = 1.8407e-04
Loss = 9.0775e-02, PNorm = 35.4787, GNorm = 0.5425, lr_0 = 1.8026e-04
Validation rmse = 0.137095
Validation r2 = 0.370715
Validation mse = 0.018795
Epoch 43
Loss = 8.9133e-02, PNorm = 35.4835, GNorm = 1.6031, lr_0 = 1.7616e-04
Loss = 7.9491e-02, PNorm = 35.4877, GNorm = 0.8492, lr_0 = 1.7252e-04
Validation rmse = 0.159616
Validation r2 = 0.146988
Validation mse = 0.025477
Epoch 44
Loss = 8.0161e-02, PNorm = 35.4932, GNorm = 0.9396, lr_0 = 1.6860e-04
Loss = 8.8795e-02, PNorm = 35.4983, GNorm = 1.3700, lr_0 = 1.6511e-04
Loss = 1.2665e-01, PNorm = 35.4984, GNorm = 4.9563, lr_0 = 1.6477e-04
Validation rmse = 0.145316
Validation r2 = 0.292984
Validation mse = 0.021117
Epoch 45
Loss = 1.0024e-01, PNorm = 35.5030, GNorm = 3.0647, lr_0 = 1.6136e-04
Validation rmse = 0.121871
Validation r2 = 0.502721
Validation mse = 0.014852
Epoch 46
Loss = 1.1157e-01, PNorm = 35.5080, GNorm = 1.8836, lr_0 = 1.5770e-04
Loss = 8.0577e-02, PNorm = 35.5102, GNorm = 0.4822, lr_0 = 1.5444e-04
Validation rmse = 0.160834
Validation r2 = 0.133922
Validation mse = 0.025868
Epoch 47
Loss = 8.5431e-02, PNorm = 35.5168, GNorm = 1.0643, lr_0 = 1.5093e-04
Loss = 9.3541e-02, PNorm = 35.5216, GNorm = 1.1784, lr_0 = 1.4781e-04
Validation rmse = 0.141023
Validation r2 = 0.334145
Validation mse = 0.019887
Epoch 48
Loss = 8.6648e-02, PNorm = 35.5263, GNorm = 1.6276, lr_0 = 1.4445e-04
Loss = 8.5517e-02, PNorm = 35.5316, GNorm = 1.1240, lr_0 = 1.4146e-04
Validation rmse = 0.138461
Validation r2 = 0.358118
Validation mse = 0.019171
Epoch 49
Loss = 8.7892e-02, PNorm = 35.5357, GNorm = 0.9731, lr_0 = 1.3825e-04
Loss = 8.5986e-02, PNorm = 35.5401, GNorm = 1.2402, lr_0 = 1.3539e-04
Validation rmse = 0.158529
Validation r2 = 0.158572
Validation mse = 0.025131
Epoch 50
Loss = 9.8283e-02, PNorm = 35.5432, GNorm = 2.4229, lr_0 = 1.3259e-04
Loss = 8.6007e-02, PNorm = 35.5469, GNorm = 1.9107, lr_0 = 1.2985e-04
Validation rmse = 0.151313
Validation r2 = 0.233423
Validation mse = 0.022896
Epoch 51
Loss = 8.1280e-02, PNorm = 35.5529, GNorm = 1.6596, lr_0 = 1.2690e-04
Loss = 8.3098e-02, PNorm = 35.5566, GNorm = 1.2907, lr_0 = 1.2427e-04
Validation rmse = 0.143312
Validation r2 = 0.312353
Validation mse = 0.020538
Epoch 52
Loss = 7.5740e-02, PNorm = 35.5596, GNorm = 1.2050, lr_0 = 1.2145e-04
Loss = 8.3972e-02, PNorm = 35.5634, GNorm = 0.6982, lr_0 = 1.1894e-04
Validation rmse = 0.149419
Validation r2 = 0.252494
Validation mse = 0.022326
Epoch 53
Loss = 7.6561e-02, PNorm = 35.5678, GNorm = 1.7651, lr_0 = 1.1623e-04
Loss = 8.1113e-02, PNorm = 35.5712, GNorm = 1.0010, lr_0 = 1.1383e-04
Validation rmse = 0.134885
Validation r2 = 0.390847
Validation mse = 0.018194
Epoch 54
Loss = 8.1137e-02, PNorm = 35.5745, GNorm = 1.7165, lr_0 = 1.1124e-04
Loss = 8.8121e-02, PNorm = 35.5772, GNorm = 0.9161, lr_0 = 1.0894e-04
Validation rmse = 0.152963
Validation r2 = 0.216619
Validation mse = 0.023398
Epoch 55
Loss = 8.2382e-02, PNorm = 35.5800, GNorm = 2.8714, lr_0 = 1.0647e-04
Loss = 7.8795e-02, PNorm = 35.5830, GNorm = 0.4683, lr_0 = 1.0427e-04
Loss = 7.1240e-02, PNorm = 35.5833, GNorm = 2.2579, lr_0 = 1.0405e-04
Validation rmse = 0.141767
Validation r2 = 0.327096
Validation mse = 0.020098
Epoch 56
Loss = 7.8127e-02, PNorm = 35.5866, GNorm = 1.2545, lr_0 = 1.0190e-04
Validation rmse = 0.165229
Validation r2 = 0.085939
Validation mse = 0.027301
Epoch 57
Loss = 7.2245e-02, PNorm = 35.5899, GNorm = 1.0292, lr_0 = 1.0000e-04
Loss = 8.2505e-02, PNorm = 35.5924, GNorm = 0.5182, lr_0 = 1.0000e-04
Validation rmse = 0.158976
Validation r2 = 0.153817
Validation mse = 0.025273
Epoch 58
Loss = 1.1234e-01, PNorm = 35.5957, GNorm = 1.3939, lr_0 = 1.0000e-04
Loss = 7.9499e-02, PNorm = 35.5988, GNorm = 0.5875, lr_0 = 1.0000e-04
Validation rmse = 0.147933
Validation r2 = 0.267286
Validation mse = 0.021884
Epoch 59
Loss = 9.9921e-02, PNorm = 35.6007, GNorm = 0.7769, lr_0 = 1.0000e-04
Loss = 7.8028e-02, PNorm = 35.6036, GNorm = 1.2994, lr_0 = 1.0000e-04
Validation rmse = 0.147085
Validation r2 = 0.275666
Validation mse = 0.021634
Model 0 best validation rmse = 0.104197 on epoch 9
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.149580
Model 0 test r2 = 0.713021
Model 0 test mse = 0.022374
Ensemble test rmse = 0.149580
Ensemble test r2 = 0.713021
Ensemble test mse = 0.022374
Fold 2
Splitting data with seed 2
Total size = 966 | train size = 956 | val size = 10 | test size = 56
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.3847e-01, PNorm = 34.0155, GNorm = 0.8710, lr_0 = 3.6053e-04
Validation rmse = 0.322644
Validation r2 = 0.065444
Validation mse = 0.104099
Epoch 1
Loss = 9.7592e-01, PNorm = 34.0465, GNorm = 13.4792, lr_0 = 6.2105e-04
Loss = 6.9096e-01, PNorm = 34.0849, GNorm = 13.9944, lr_0 = 8.5789e-04
Validation rmse = 0.257174
Validation r2 = 0.406235
Validation mse = 0.066139
Epoch 2
Loss = 7.7876e-01, PNorm = 34.1392, GNorm = 5.2082, lr_0 = 9.8961e-04
Loss = 5.5917e-01, PNorm = 34.1994, GNorm = 2.3196, lr_0 = 9.6914e-04
Validation rmse = 0.202486
Validation r2 = 0.631913
Validation mse = 0.041001
Epoch 3
Loss = 5.0134e-01, PNorm = 34.2775, GNorm = 7.1336, lr_0 = 9.4712e-04
Loss = 4.7796e-01, PNorm = 34.3385, GNorm = 3.0023, lr_0 = 9.2754e-04
Validation rmse = 0.213482
Validation r2 = 0.590852
Validation mse = 0.045574
Epoch 4
Loss = 3.1509e-01, PNorm = 34.4023, GNorm = 0.5948, lr_0 = 9.0646e-04
Loss = 3.1410e-01, PNorm = 34.4481, GNorm = 1.3210, lr_0 = 8.8772e-04
Validation rmse = 0.222006
Validation r2 = 0.557527
Validation mse = 0.049287
Epoch 5
Loss = 2.9220e-01, PNorm = 34.5003, GNorm = 2.6406, lr_0 = 8.6755e-04
Loss = 2.3842e-01, PNorm = 34.5458, GNorm = 1.3337, lr_0 = 8.4961e-04
Validation rmse = 0.187585
Validation r2 = 0.684095
Validation mse = 0.035188
Epoch 6
Loss = 1.9259e-01, PNorm = 34.5999, GNorm = 1.2830, lr_0 = 8.3031e-04
Loss = 2.0019e-01, PNorm = 34.6427, GNorm = 2.7647, lr_0 = 8.1314e-04
Validation rmse = 0.277443
Validation r2 = 0.308955
Validation mse = 0.076975
Epoch 7
Loss = 2.3407e-01, PNorm = 34.6742, GNorm = 5.8469, lr_0 = 7.9466e-04
Loss = 1.9686e-01, PNorm = 34.7087, GNorm = 0.7523, lr_0 = 7.7823e-04
Validation rmse = 0.205179
Validation r2 = 0.622057
Validation mse = 0.042099
Epoch 8
Loss = 1.8496e-01, PNorm = 34.7458, GNorm = 5.7675, lr_0 = 7.6055e-04
Loss = 1.8370e-01, PNorm = 34.7772, GNorm = 4.3554, lr_0 = 7.4482e-04
Validation rmse = 0.216774
Validation r2 = 0.578136
Validation mse = 0.046991
Epoch 9
Loss = 1.7337e-01, PNorm = 34.8026, GNorm = 0.9717, lr_0 = 7.2942e-04
Loss = 1.5956e-01, PNorm = 34.8288, GNorm = 1.7708, lr_0 = 7.1434e-04
Validation rmse = 0.143173
Validation r2 = 0.815974
Validation mse = 0.020498
Epoch 10
Loss = 1.6018e-01, PNorm = 34.8505, GNorm = 3.1280, lr_0 = 6.9810e-04
Loss = 1.4076e-01, PNorm = 34.8704, GNorm = 2.5905, lr_0 = 6.8367e-04
Loss = 3.7752e-01, PNorm = 34.8726, GNorm = 3.8683, lr_0 = 6.8224e-04
Validation rmse = 0.172256
Validation r2 = 0.733615
Validation mse = 0.029672
Epoch 11
Loss = 1.4232e-01, PNorm = 34.8991, GNorm = 1.3081, lr_0 = 6.6813e-04
Validation rmse = 0.181630
Validation r2 = 0.703834
Validation mse = 0.032990
Epoch 12
Loss = 1.4129e-01, PNorm = 34.9192, GNorm = 1.9067, lr_0 = 6.5295e-04
Loss = 1.4225e-01, PNorm = 34.9377, GNorm = 0.5934, lr_0 = 6.3945e-04
Validation rmse = 0.190081
Validation r2 = 0.675633
Validation mse = 0.036131
Epoch 13
Loss = 1.1676e-01, PNorm = 34.9530, GNorm = 1.5571, lr_0 = 6.2492e-04
Loss = 1.2742e-01, PNorm = 34.9713, GNorm = 2.8045, lr_0 = 6.1200e-04
Validation rmse = 0.142264
Validation r2 = 0.818303
Validation mse = 0.020239
Epoch 14
Loss = 1.2518e-01, PNorm = 34.9829, GNorm = 0.3441, lr_0 = 5.9809e-04
Loss = 1.2038e-01, PNorm = 34.9949, GNorm = 2.8364, lr_0 = 5.8573e-04
Validation rmse = 0.191030
Validation r2 = 0.672387
Validation mse = 0.036492
Epoch 15
Loss = 1.3859e-01, PNorm = 35.0129, GNorm = 0.8014, lr_0 = 5.7242e-04
Loss = 1.3244e-01, PNorm = 35.0342, GNorm = 3.2880, lr_0 = 5.6058e-04
Validation rmse = 0.134832
Validation r2 = 0.836791
Validation mse = 0.018180
Epoch 16
Loss = 1.5645e-01, PNorm = 35.0464, GNorm = 2.6477, lr_0 = 5.4784e-04
Loss = 1.2387e-01, PNorm = 35.0611, GNorm = 2.0773, lr_0 = 5.3652e-04
Validation rmse = 0.155911
Validation r2 = 0.781770
Validation mse = 0.024308
Epoch 17
Loss = 1.0531e-01, PNorm = 35.0752, GNorm = 1.3916, lr_0 = 5.2542e-04
Loss = 1.2173e-01, PNorm = 35.0869, GNorm = 3.5062, lr_0 = 5.1456e-04
Validation rmse = 0.123559
Validation r2 = 0.862942
Validation mse = 0.015267
Epoch 18
Loss = 1.5006e-01, PNorm = 35.1034, GNorm = 2.4409, lr_0 = 5.0287e-04
Loss = 1.5622e-01, PNorm = 35.1201, GNorm = 2.0064, lr_0 = 4.9247e-04
Validation rmse = 0.137870
Validation r2 = 0.829352
Validation mse = 0.019008
Epoch 19
Loss = 1.0889e-01, PNorm = 35.1325, GNorm = 0.5878, lr_0 = 4.8128e-04
Loss = 1.1596e-01, PNorm = 35.1451, GNorm = 1.4330, lr_0 = 4.7133e-04
Validation rmse = 0.127464
Validation r2 = 0.854140
Validation mse = 0.016247
Epoch 20
Loss = 1.3305e-01, PNorm = 35.1580, GNorm = 2.4049, lr_0 = 4.6062e-04
Loss = 1.2135e-01, PNorm = 35.1716, GNorm = 1.6482, lr_0 = 4.5109e-04
Validation rmse = 0.123048
Validation r2 = 0.864073
Validation mse = 0.015141
Epoch 21
Loss = 1.2504e-01, PNorm = 35.1865, GNorm = 1.8417, lr_0 = 4.4084e-04
Loss = 1.0518e-01, PNorm = 35.1979, GNorm = 1.3234, lr_0 = 4.3173e-04
Loss = 1.9124e-02, PNorm = 35.1985, GNorm = 0.8683, lr_0 = 4.3083e-04
Validation rmse = 0.126817
Validation r2 = 0.855618
Validation mse = 0.016083
Epoch 22
Loss = 1.0879e-01, PNorm = 35.2084, GNorm = 2.5485, lr_0 = 4.2192e-04
Validation rmse = 0.162089
Validation r2 = 0.764135
Validation mse = 0.026273
Epoch 23
Loss = 1.0351e-01, PNorm = 35.2204, GNorm = 0.6685, lr_0 = 4.1233e-04
Loss = 1.0541e-01, PNorm = 35.2290, GNorm = 1.2504, lr_0 = 4.0380e-04
Validation rmse = 0.141912
Validation r2 = 0.819201
Validation mse = 0.020139
Epoch 24
Loss = 9.1327e-02, PNorm = 35.2393, GNorm = 1.6505, lr_0 = 3.9463e-04
Loss = 1.1490e-01, PNorm = 35.2472, GNorm = 1.0458, lr_0 = 3.8647e-04
Validation rmse = 0.129113
Validation r2 = 0.850341
Validation mse = 0.016670
Epoch 25
Loss = 9.7704e-02, PNorm = 35.2572, GNorm = 1.4789, lr_0 = 3.7848e-04
Loss = 9.8782e-02, PNorm = 35.2647, GNorm = 1.2898, lr_0 = 3.7065e-04
Validation rmse = 0.168697
Validation r2 = 0.744509
Validation mse = 0.028459
Epoch 26
Loss = 1.3632e-01, PNorm = 35.2756, GNorm = 0.8587, lr_0 = 3.6223e-04
Loss = 9.6893e-02, PNorm = 35.2839, GNorm = 1.0166, lr_0 = 3.5474e-04
Validation rmse = 0.133244
Validation r2 = 0.840614
Validation mse = 0.017754
Epoch 27
Loss = 9.6344e-02, PNorm = 35.2963, GNorm = 0.5842, lr_0 = 3.4668e-04
Loss = 8.7136e-02, PNorm = 35.3048, GNorm = 0.6545, lr_0 = 3.3951e-04
Validation rmse = 0.134695
Validation r2 = 0.837121
Validation mse = 0.018143
Epoch 28
Loss = 1.0448e-01, PNorm = 35.3149, GNorm = 1.3090, lr_0 = 3.3180e-04
Loss = 9.5805e-02, PNorm = 35.3240, GNorm = 0.6153, lr_0 = 3.2494e-04
Validation rmse = 0.140233
Validation r2 = 0.823454
Validation mse = 0.019665
Epoch 29
Loss = 9.9098e-02, PNorm = 35.3301, GNorm = 3.7970, lr_0 = 3.1755e-04
Loss = 9.8063e-02, PNorm = 35.3373, GNorm = 1.3307, lr_0 = 3.1099e-04
Validation rmse = 0.173398
Validation r2 = 0.730072
Validation mse = 0.030067
Epoch 30
Loss = 7.9848e-02, PNorm = 35.3471, GNorm = 2.0207, lr_0 = 3.0392e-04
Loss = 1.0229e-01, PNorm = 35.3563, GNorm = 1.8438, lr_0 = 2.9764e-04
Validation rmse = 0.148193
Validation r2 = 0.802842
Validation mse = 0.021961
Epoch 31
Loss = 1.0182e-01, PNorm = 35.3658, GNorm = 1.6436, lr_0 = 2.9087e-04
Loss = 9.4047e-02, PNorm = 35.3745, GNorm = 2.7635, lr_0 = 2.8486e-04
Validation rmse = 0.155540
Validation r2 = 0.782807
Validation mse = 0.024193
Epoch 32
Loss = 9.3857e-02, PNorm = 35.3809, GNorm = 0.5387, lr_0 = 2.7839e-04
Loss = 9.4899e-02, PNorm = 35.3893, GNorm = 1.5856, lr_0 = 2.7263e-04
Loss = 1.3087e-01, PNorm = 35.3906, GNorm = 1.7433, lr_0 = 2.7206e-04
Validation rmse = 0.156236
Validation r2 = 0.780860
Validation mse = 0.024410
Epoch 33
Loss = 9.3684e-02, PNorm = 35.4016, GNorm = 1.0724, lr_0 = 2.6643e-04
Loss = 8.9889e-02, PNorm = 35.4077, GNorm = 1.3483, lr_0 = 2.6092e-04
Validation rmse = 0.133509
Validation r2 = 0.839978
Validation mse = 0.017825
Epoch 34
Loss = 9.5444e-02, PNorm = 35.4124, GNorm = 0.8078, lr_0 = 2.5553e-04
Validation rmse = 0.122041
Validation r2 = 0.866288
Validation mse = 0.014894
Epoch 35
Loss = 1.1488e-01, PNorm = 35.4199, GNorm = 1.3778, lr_0 = 2.4972e-04
Loss = 8.8540e-02, PNorm = 35.4267, GNorm = 0.6190, lr_0 = 2.4456e-04
Validation rmse = 0.137616
Validation r2 = 0.829982
Validation mse = 0.018938
Epoch 36
Loss = 7.4617e-02, PNorm = 35.4345, GNorm = 0.6234, lr_0 = 2.3900e-04
Loss = 8.0625e-02, PNorm = 35.4411, GNorm = 0.8566, lr_0 = 2.3406e-04
Validation rmse = 0.121217
Validation r2 = 0.868087
Validation mse = 0.014694
Epoch 37
Loss = 9.2736e-02, PNorm = 35.4486, GNorm = 2.1054, lr_0 = 2.2874e-04
Loss = 8.9980e-02, PNorm = 35.4545, GNorm = 1.2592, lr_0 = 2.2401e-04
Validation rmse = 0.141167
Validation r2 = 0.821094
Validation mse = 0.019928
Epoch 38
Loss = 8.2332e-02, PNorm = 35.4630, GNorm = 0.9613, lr_0 = 2.1892e-04
Loss = 8.6338e-02, PNorm = 35.4690, GNorm = 1.2615, lr_0 = 2.1440e-04
Validation rmse = 0.153632
Validation r2 = 0.788105
Validation mse = 0.023603
Epoch 39
Loss = 9.8936e-02, PNorm = 35.4762, GNorm = 1.2250, lr_0 = 2.0952e-04
Loss = 8.2372e-02, PNorm = 35.4827, GNorm = 2.9528, lr_0 = 2.0519e-04
Validation rmse = 0.163604
Validation r2 = 0.759702
Validation mse = 0.026766
Epoch 40
Loss = 1.0650e-01, PNorm = 35.4887, GNorm = 0.9011, lr_0 = 2.0053e-04
Loss = 7.6127e-02, PNorm = 35.4942, GNorm = 1.7930, lr_0 = 1.9638e-04
Validation rmse = 0.135473
Validation r2 = 0.835236
Validation mse = 0.018353
Epoch 41
Loss = 8.7005e-02, PNorm = 35.4996, GNorm = 2.0958, lr_0 = 1.9192e-04
Loss = 8.1043e-02, PNorm = 35.5060, GNorm = 0.6677, lr_0 = 1.8795e-04
Validation rmse = 0.136035
Validation r2 = 0.833866
Validation mse = 0.018505
Epoch 42
Loss = 9.1797e-02, PNorm = 35.5113, GNorm = 0.9946, lr_0 = 1.8407e-04
Loss = 8.1084e-02, PNorm = 35.5166, GNorm = 1.2766, lr_0 = 1.8026e-04
Validation rmse = 0.178060
Validation r2 = 0.715363
Validation mse = 0.031705
Epoch 43
Loss = 9.7603e-02, PNorm = 35.5205, GNorm = 1.6976, lr_0 = 1.7616e-04
Loss = 8.2290e-02, PNorm = 35.5271, GNorm = 0.5294, lr_0 = 1.7252e-04
Validation rmse = 0.125965
Validation r2 = 0.857551
Validation mse = 0.015867
Epoch 44
Loss = 8.6983e-02, PNorm = 35.5321, GNorm = 1.3114, lr_0 = 1.6860e-04
Loss = 9.5543e-02, PNorm = 35.5368, GNorm = 2.9216, lr_0 = 1.6511e-04
Loss = 2.7437e-02, PNorm = 35.5371, GNorm = 2.0264, lr_0 = 1.6477e-04
Validation rmse = 0.172866
Validation r2 = 0.731726
Validation mse = 0.029883
Epoch 45
Loss = 8.4279e-02, PNorm = 35.5424, GNorm = 1.2419, lr_0 = 1.6136e-04
Validation rmse = 0.151001
Validation r2 = 0.795299
Validation mse = 0.022801
Epoch 46
Loss = 8.3048e-02, PNorm = 35.5472, GNorm = 1.0816, lr_0 = 1.5770e-04
Loss = 7.5567e-02, PNorm = 35.5514, GNorm = 0.4560, lr_0 = 1.5444e-04
Validation rmse = 0.124554
Validation r2 = 0.860725
Validation mse = 0.015514
Epoch 47
Loss = 8.7947e-02, PNorm = 35.5568, GNorm = 2.6428, lr_0 = 1.5093e-04
Loss = 7.8634e-02, PNorm = 35.5619, GNorm = 0.7489, lr_0 = 1.4781e-04
Validation rmse = 0.137782
Validation r2 = 0.829572
Validation mse = 0.018984
Epoch 48
Loss = 5.8180e-02, PNorm = 35.5658, GNorm = 0.5661, lr_0 = 1.4445e-04
Loss = 8.4431e-02, PNorm = 35.5702, GNorm = 0.5975, lr_0 = 1.4146e-04
Validation rmse = 0.152821
Validation r2 = 0.790334
Validation mse = 0.023354
Epoch 49
Loss = 7.5167e-02, PNorm = 35.5748, GNorm = 0.7394, lr_0 = 1.3825e-04
Loss = 7.7376e-02, PNorm = 35.5783, GNorm = 0.4929, lr_0 = 1.3539e-04
Validation rmse = 0.133287
Validation r2 = 0.840508
Validation mse = 0.017766
Epoch 50
Loss = 8.6873e-02, PNorm = 35.5841, GNorm = 2.6171, lr_0 = 1.3259e-04
Loss = 9.4050e-02, PNorm = 35.5904, GNorm = 1.6030, lr_0 = 1.2985e-04
Validation rmse = 0.143562
Validation r2 = 0.814973
Validation mse = 0.020610
Epoch 51
Loss = 7.0656e-02, PNorm = 35.5953, GNorm = 1.2814, lr_0 = 1.2690e-04
Loss = 8.7364e-02, PNorm = 35.5984, GNorm = 1.4921, lr_0 = 1.2427e-04
Validation rmse = 0.157553
Validation r2 = 0.777149
Validation mse = 0.024823
Epoch 52
Loss = 8.0842e-02, PNorm = 35.6010, GNorm = 0.6991, lr_0 = 1.2145e-04
Loss = 7.8399e-02, PNorm = 35.6043, GNorm = 1.3026, lr_0 = 1.1894e-04
Validation rmse = 0.148371
Validation r2 = 0.802368
Validation mse = 0.022014
Epoch 53
Loss = 7.7772e-02, PNorm = 35.6073, GNorm = 0.4561, lr_0 = 1.1623e-04
Loss = 7.8194e-02, PNorm = 35.6103, GNorm = 1.1334, lr_0 = 1.1383e-04
Validation rmse = 0.139355
Validation r2 = 0.825657
Validation mse = 0.019420
Epoch 54
Loss = 8.0217e-02, PNorm = 35.6126, GNorm = 1.1783, lr_0 = 1.1124e-04
Loss = 7.9723e-02, PNorm = 35.6163, GNorm = 0.7233, lr_0 = 1.0894e-04
Validation rmse = 0.136747
Validation r2 = 0.832121
Validation mse = 0.018700
Epoch 55
Loss = 8.1059e-02, PNorm = 35.6189, GNorm = 0.8273, lr_0 = 1.0647e-04
Loss = 7.1643e-02, PNorm = 35.6228, GNorm = 1.4527, lr_0 = 1.0427e-04
Loss = 3.8347e-02, PNorm = 35.6230, GNorm = 2.0488, lr_0 = 1.0405e-04
Validation rmse = 0.155204
Validation r2 = 0.783746
Validation mse = 0.024088
Epoch 56
Loss = 7.9894e-02, PNorm = 35.6258, GNorm = 2.0084, lr_0 = 1.0190e-04
Validation rmse = 0.127691
Validation r2 = 0.853620
Validation mse = 0.016305
Epoch 57
Loss = 8.9406e-02, PNorm = 35.6282, GNorm = 1.3399, lr_0 = 1.0000e-04
Loss = 7.4240e-02, PNorm = 35.6312, GNorm = 1.0130, lr_0 = 1.0000e-04
Validation rmse = 0.146125
Validation r2 = 0.808306
Validation mse = 0.021353
Epoch 58
Loss = 7.3822e-02, PNorm = 35.6347, GNorm = 0.8179, lr_0 = 1.0000e-04
Loss = 7.0039e-02, PNorm = 35.6373, GNorm = 1.3255, lr_0 = 1.0000e-04
Validation rmse = 0.158135
Validation r2 = 0.775502
Validation mse = 0.025007
Epoch 59
Loss = 9.1403e-02, PNorm = 35.6404, GNorm = 2.6514, lr_0 = 1.0000e-04
Loss = 7.1690e-02, PNorm = 35.6427, GNorm = 0.5721, lr_0 = 1.0000e-04
Validation rmse = 0.130794
Validation r2 = 0.846421
Validation mse = 0.017107
Model 0 best validation rmse = 0.121217 on epoch 36
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.200229
Model 0 test r2 = 0.485774
Model 0 test mse = 0.040092
Ensemble test rmse = 0.200229
Ensemble test r2 = 0.485774
Ensemble test mse = 0.040092
Fold 3
Splitting data with seed 3
Total size = 966 | train size = 956 | val size = 10 | test size = 56
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.9728e-01, PNorm = 34.0172, GNorm = 1.8521, lr_0 = 3.6053e-04
Validation rmse = 0.227427
Validation r2 = 0.434606
Validation mse = 0.051723
Epoch 1
Loss = 7.0484e-01, PNorm = 34.0445, GNorm = 2.4309, lr_0 = 6.2105e-04
Loss = 6.3677e-01, PNorm = 34.0802, GNorm = 1.9672, lr_0 = 8.5789e-04
Validation rmse = 0.188690
Validation r2 = 0.610807
Validation mse = 0.035604
Epoch 2
Loss = 4.2195e-01, PNorm = 34.1622, GNorm = 2.6192, lr_0 = 9.8961e-04
Loss = 4.1775e-01, PNorm = 34.2404, GNorm = 7.9696, lr_0 = 9.6914e-04
Validation rmse = 0.126791
Validation r2 = 0.824273
Validation mse = 0.016076
Epoch 3
Loss = 2.7311e-01, PNorm = 34.3039, GNorm = 3.8826, lr_0 = 9.4712e-04
Loss = 3.6223e-01, PNorm = 34.3578, GNorm = 2.8370, lr_0 = 9.2754e-04
Validation rmse = 0.168186
Validation r2 = 0.690796
Validation mse = 0.028287
Epoch 4
Loss = 3.9682e-01, PNorm = 34.4119, GNorm = 6.2417, lr_0 = 9.0646e-04
Loss = 3.3235e-01, PNorm = 34.4593, GNorm = 4.6387, lr_0 = 8.8772e-04
Validation rmse = 0.112237
Validation r2 = 0.862300
Validation mse = 0.012597
Epoch 5
Loss = 2.7932e-01, PNorm = 34.5219, GNorm = 3.1090, lr_0 = 8.6755e-04
Loss = 2.3921e-01, PNorm = 34.5647, GNorm = 3.0198, lr_0 = 8.4961e-04
Validation rmse = 0.115625
Validation r2 = 0.853859
Validation mse = 0.013369
Epoch 6
Loss = 2.1805e-01, PNorm = 34.6065, GNorm = 5.6312, lr_0 = 8.3031e-04
Loss = 1.7102e-01, PNorm = 34.6412, GNorm = 2.5039, lr_0 = 8.1314e-04
Validation rmse = 0.135538
Validation r2 = 0.799190
Validation mse = 0.018370
Epoch 7
Loss = 1.7165e-01, PNorm = 34.6798, GNorm = 1.2686, lr_0 = 7.9466e-04
Loss = 1.6941e-01, PNorm = 34.7126, GNorm = 4.3181, lr_0 = 7.7823e-04
Validation rmse = 0.163364
Validation r2 = 0.708270
Validation mse = 0.026688
Epoch 8
Loss = 2.0656e-01, PNorm = 34.7450, GNorm = 7.0508, lr_0 = 7.6055e-04
Loss = 1.5399e-01, PNorm = 34.7776, GNorm = 0.8393, lr_0 = 7.4482e-04
Validation rmse = 0.097896
Validation r2 = 0.895240
Validation mse = 0.009584
Epoch 9
Loss = 1.5704e-01, PNorm = 34.8097, GNorm = 0.9638, lr_0 = 7.2942e-04
Loss = 1.5343e-01, PNorm = 34.8342, GNorm = 1.2451, lr_0 = 7.1434e-04
Validation rmse = 0.089840
Validation r2 = 0.911772
Validation mse = 0.008071
Epoch 10
Loss = 1.5204e-01, PNorm = 34.8652, GNorm = 0.6084, lr_0 = 6.9810e-04
Loss = 1.4555e-01, PNorm = 34.8816, GNorm = 4.1730, lr_0 = 6.8367e-04
Loss = 1.5535e-01, PNorm = 34.8831, GNorm = 3.2502, lr_0 = 6.8224e-04
Validation rmse = 0.109167
Validation r2 = 0.869729
Validation mse = 0.011917
Epoch 11
Loss = 1.3967e-01, PNorm = 34.8969, GNorm = 1.6683, lr_0 = 6.6813e-04
Validation rmse = 0.095631
Validation r2 = 0.900031
Validation mse = 0.009145
Epoch 12
Loss = 1.3408e-01, PNorm = 34.9165, GNorm = 0.8570, lr_0 = 6.5295e-04
Loss = 1.1858e-01, PNorm = 34.9312, GNorm = 0.5998, lr_0 = 6.3945e-04
Validation rmse = 0.116504
Validation r2 = 0.851630
Validation mse = 0.013573
Epoch 13
Loss = 1.7681e-01, PNorm = 34.9529, GNorm = 3.2525, lr_0 = 6.2492e-04
Loss = 1.3714e-01, PNorm = 34.9643, GNorm = 4.6470, lr_0 = 6.1200e-04
Validation rmse = 0.092362
Validation r2 = 0.906749
Validation mse = 0.008531
Epoch 14
Loss = 1.1419e-01, PNorm = 34.9801, GNorm = 1.3422, lr_0 = 5.9809e-04
Loss = 1.4460e-01, PNorm = 34.9927, GNorm = 0.8676, lr_0 = 5.8573e-04
Validation rmse = 0.172743
Validation r2 = 0.673814
Validation mse = 0.029840
Epoch 15
Loss = 1.3870e-01, PNorm = 35.0101, GNorm = 0.6167, lr_0 = 5.7242e-04
Loss = 1.3320e-01, PNorm = 35.0196, GNorm = 0.8706, lr_0 = 5.6058e-04
Validation rmse = 0.098204
Validation r2 = 0.894581
Validation mse = 0.009644
Epoch 16
Loss = 9.2710e-02, PNorm = 35.0328, GNorm = 2.2244, lr_0 = 5.4784e-04
Loss = 1.3075e-01, PNorm = 35.0425, GNorm = 0.9795, lr_0 = 5.3652e-04
Validation rmse = 0.116505
Validation r2 = 0.851626
Validation mse = 0.013574
Epoch 17
Loss = 9.6048e-02, PNorm = 35.0577, GNorm = 1.1743, lr_0 = 5.2542e-04
Loss = 1.2577e-01, PNorm = 35.0666, GNorm = 3.8506, lr_0 = 5.1456e-04
Validation rmse = 0.090208
Validation r2 = 0.911048
Validation mse = 0.008138
Epoch 18
Loss = 1.0674e-01, PNorm = 35.0855, GNorm = 0.9108, lr_0 = 5.0287e-04
Loss = 1.3151e-01, PNorm = 35.0997, GNorm = 3.5632, lr_0 = 4.9247e-04
Validation rmse = 0.096639
Validation r2 = 0.897913
Validation mse = 0.009339
Epoch 19
Loss = 1.0363e-01, PNorm = 35.1150, GNorm = 2.2967, lr_0 = 4.8128e-04
Loss = 1.0880e-01, PNorm = 35.1284, GNorm = 0.6475, lr_0 = 4.7133e-04
Validation rmse = 0.124920
Validation r2 = 0.829421
Validation mse = 0.015605
Epoch 20
Loss = 1.1337e-01, PNorm = 35.1357, GNorm = 0.7949, lr_0 = 4.6062e-04
Loss = 1.0867e-01, PNorm = 35.1494, GNorm = 1.1217, lr_0 = 4.5109e-04
Validation rmse = 0.114197
Validation r2 = 0.857449
Validation mse = 0.013041
Epoch 21
Loss = 1.1459e-01, PNorm = 35.1600, GNorm = 0.5170, lr_0 = 4.4084e-04
Loss = 1.0793e-01, PNorm = 35.1733, GNorm = 2.2755, lr_0 = 4.3173e-04
Loss = 1.0086e-01, PNorm = 35.1744, GNorm = 4.8645, lr_0 = 4.3083e-04
Validation rmse = 0.092363
Validation r2 = 0.906747
Validation mse = 0.008531
Epoch 22
Loss = 1.0484e-01, PNorm = 35.1848, GNorm = 1.8804, lr_0 = 4.2192e-04
Validation rmse = 0.095700
Validation r2 = 0.899888
Validation mse = 0.009158
Epoch 23
Loss = 4.6039e-02, PNorm = 35.1970, GNorm = 0.8670, lr_0 = 4.1233e-04
Loss = 1.0883e-01, PNorm = 35.2068, GNorm = 3.5357, lr_0 = 4.0380e-04
Validation rmse = 0.106014
Validation r2 = 0.877144
Validation mse = 0.011239
Epoch 24
Loss = 8.5028e-02, PNorm = 35.2186, GNorm = 0.9865, lr_0 = 3.9463e-04
Loss = 1.0811e-01, PNorm = 35.2284, GNorm = 2.8224, lr_0 = 3.8647e-04
Validation rmse = 0.102484
Validation r2 = 0.885191
Validation mse = 0.010503
Epoch 25
Loss = 1.2659e-01, PNorm = 35.2366, GNorm = 0.7963, lr_0 = 3.7848e-04
Loss = 9.9552e-02, PNorm = 35.2474, GNorm = 0.6979, lr_0 = 3.7065e-04
Validation rmse = 0.102960
Validation r2 = 0.884122
Validation mse = 0.010601
Epoch 26
Loss = 9.5011e-02, PNorm = 35.2570, GNorm = 0.7055, lr_0 = 3.6223e-04
Loss = 8.8772e-02, PNorm = 35.2660, GNorm = 0.8746, lr_0 = 3.5474e-04
Validation rmse = 0.083693
Validation r2 = 0.923433
Validation mse = 0.007004
Epoch 27
Loss = 1.1802e-01, PNorm = 35.2769, GNorm = 0.8143, lr_0 = 3.4668e-04
Loss = 9.6535e-02, PNorm = 35.2876, GNorm = 1.8126, lr_0 = 3.3951e-04
Validation rmse = 0.101813
Validation r2 = 0.886689
Validation mse = 0.010366
Epoch 28
Loss = 9.8220e-02, PNorm = 35.3037, GNorm = 1.4213, lr_0 = 3.3180e-04
Loss = 1.0195e-01, PNorm = 35.3143, GNorm = 0.9761, lr_0 = 3.2494e-04
Validation rmse = 0.118383
Validation r2 = 0.846806
Validation mse = 0.014015
Epoch 29
Loss = 1.1137e-01, PNorm = 35.3237, GNorm = 2.0887, lr_0 = 3.1755e-04
Loss = 9.0027e-02, PNorm = 35.3328, GNorm = 0.9249, lr_0 = 3.1099e-04
Validation rmse = 0.101880
Validation r2 = 0.886540
Validation mse = 0.010379
Epoch 30
Loss = 8.7397e-02, PNorm = 35.3372, GNorm = 0.5127, lr_0 = 3.0392e-04
Loss = 9.4559e-02, PNorm = 35.3436, GNorm = 2.8509, lr_0 = 2.9764e-04
Validation rmse = 0.081858
Validation r2 = 0.926753
Validation mse = 0.006701
Epoch 31
Loss = 9.3496e-02, PNorm = 35.3497, GNorm = 3.1731, lr_0 = 2.9087e-04
Loss = 9.7420e-02, PNorm = 35.3576, GNorm = 0.3978, lr_0 = 2.8486e-04
Validation rmse = 0.112708
Validation r2 = 0.861141
Validation mse = 0.012703
Epoch 32
Loss = 8.7759e-02, PNorm = 35.3664, GNorm = 2.6569, lr_0 = 2.7839e-04
Loss = 9.8921e-02, PNorm = 35.3738, GNorm = 1.7091, lr_0 = 2.7263e-04
Loss = 2.7726e-02, PNorm = 35.3748, GNorm = 1.0172, lr_0 = 2.7206e-04
Validation rmse = 0.098713
Validation r2 = 0.893485
Validation mse = 0.009744
Epoch 33
Loss = 9.3054e-02, PNorm = 35.3814, GNorm = 0.4522, lr_0 = 2.6643e-04
Loss = 8.2802e-02, PNorm = 35.3876, GNorm = 3.9357, lr_0 = 2.6092e-04
Validation rmse = 0.097970
Validation r2 = 0.895082
Validation mse = 0.009598
Epoch 34
Loss = 8.7731e-02, PNorm = 35.3947, GNorm = 1.9416, lr_0 = 2.5553e-04
Validation rmse = 0.081855
Validation r2 = 0.926759
Validation mse = 0.006700
Epoch 35
Loss = 6.8076e-02, PNorm = 35.4014, GNorm = 2.9705, lr_0 = 2.4972e-04
Loss = 8.9668e-02, PNorm = 35.4095, GNorm = 0.6642, lr_0 = 2.4456e-04
Validation rmse = 0.092572
Validation r2 = 0.906325
Validation mse = 0.008570
Epoch 36
Loss = 6.8896e-02, PNorm = 35.4172, GNorm = 1.5332, lr_0 = 2.3900e-04
Loss = 9.5860e-02, PNorm = 35.4241, GNorm = 3.3221, lr_0 = 2.3406e-04
Validation rmse = 0.086137
Validation r2 = 0.918895
Validation mse = 0.007420
Epoch 37
Loss = 8.8135e-02, PNorm = 35.4310, GNorm = 1.9926, lr_0 = 2.2874e-04
Loss = 8.6996e-02, PNorm = 35.4374, GNorm = 1.2026, lr_0 = 2.2401e-04
Validation rmse = 0.100196
Validation r2 = 0.890260
Validation mse = 0.010039
Epoch 38
Loss = 7.1967e-02, PNorm = 35.4452, GNorm = 0.6525, lr_0 = 2.1892e-04
Loss = 8.8164e-02, PNorm = 35.4527, GNorm = 0.6499, lr_0 = 2.1440e-04
Validation rmse = 0.110675
Validation r2 = 0.866105
Validation mse = 0.012249
Epoch 39
Loss = 8.4101e-02, PNorm = 35.4575, GNorm = 0.4096, lr_0 = 2.0952e-04
Loss = 8.1238e-02, PNorm = 35.4629, GNorm = 0.9295, lr_0 = 2.0519e-04
Validation rmse = 0.085032
Validation r2 = 0.920962
Validation mse = 0.007231
Epoch 40
Loss = 8.7182e-02, PNorm = 35.4697, GNorm = 0.5363, lr_0 = 2.0053e-04
Loss = 8.8697e-02, PNorm = 35.4769, GNorm = 0.9656, lr_0 = 1.9638e-04
Validation rmse = 0.091700
Validation r2 = 0.908081
Validation mse = 0.008409
Epoch 41
Loss = 8.1951e-02, PNorm = 35.4835, GNorm = 0.6015, lr_0 = 1.9192e-04
Loss = 9.8084e-02, PNorm = 35.4892, GNorm = 0.7183, lr_0 = 1.8795e-04
Validation rmse = 0.107659
Validation r2 = 0.873304
Validation mse = 0.011590
Epoch 42
Loss = 8.6305e-02, PNorm = 35.4955, GNorm = 0.4716, lr_0 = 1.8407e-04
Loss = 7.7538e-02, PNorm = 35.5020, GNorm = 1.0169, lr_0 = 1.8026e-04
Validation rmse = 0.092917
Validation r2 = 0.905625
Validation mse = 0.008634
Epoch 43
Loss = 7.3811e-02, PNorm = 35.5063, GNorm = 1.8961, lr_0 = 1.7616e-04
Loss = 9.8763e-02, PNorm = 35.5100, GNorm = 1.5221, lr_0 = 1.7252e-04
Validation rmse = 0.122275
Validation r2 = 0.836567
Validation mse = 0.014951
Epoch 44
Loss = 9.3192e-02, PNorm = 35.5163, GNorm = 0.7646, lr_0 = 1.6860e-04
Loss = 9.2960e-02, PNorm = 35.5221, GNorm = 1.1434, lr_0 = 1.6511e-04
Loss = 1.0071e-02, PNorm = 35.5224, GNorm = 0.8901, lr_0 = 1.6477e-04
Validation rmse = 0.106616
Validation r2 = 0.875747
Validation mse = 0.011367
Epoch 45
Loss = 8.9213e-02, PNorm = 35.5268, GNorm = 2.3202, lr_0 = 1.6136e-04
Validation rmse = 0.095768
Validation r2 = 0.899744
Validation mse = 0.009172
Epoch 46
Loss = 7.9966e-02, PNorm = 35.5326, GNorm = 0.5715, lr_0 = 1.5770e-04
Loss = 7.7906e-02, PNorm = 35.5380, GNorm = 0.9117, lr_0 = 1.5444e-04
Validation rmse = 0.098807
Validation r2 = 0.893280
Validation mse = 0.009763
Epoch 47
Loss = 5.3495e-02, PNorm = 35.5447, GNorm = 0.7399, lr_0 = 1.5093e-04
Loss = 8.2491e-02, PNorm = 35.5485, GNorm = 0.4954, lr_0 = 1.4781e-04
Validation rmse = 0.113600
Validation r2 = 0.858935
Validation mse = 0.012905
Epoch 48
Loss = 6.5011e-02, PNorm = 35.5522, GNorm = 0.7844, lr_0 = 1.4445e-04
Loss = 7.3772e-02, PNorm = 35.5558, GNorm = 0.4858, lr_0 = 1.4146e-04
Validation rmse = 0.099329
Validation r2 = 0.892150
Validation mse = 0.009866
Epoch 49
Loss = 6.6370e-02, PNorm = 35.5597, GNorm = 1.5518, lr_0 = 1.3825e-04
Loss = 8.2606e-02, PNorm = 35.5633, GNorm = 0.8809, lr_0 = 1.3539e-04
Validation rmse = 0.100397
Validation r2 = 0.889820
Validation mse = 0.010080
Epoch 50
Loss = 7.2408e-02, PNorm = 35.5675, GNorm = 0.6985, lr_0 = 1.3259e-04
Loss = 6.7988e-02, PNorm = 35.5709, GNorm = 1.0407, lr_0 = 1.2985e-04
Validation rmse = 0.086022
Validation r2 = 0.919112
Validation mse = 0.007400
Epoch 51
Loss = 7.5074e-02, PNorm = 35.5751, GNorm = 0.9391, lr_0 = 1.2690e-04
Loss = 7.8315e-02, PNorm = 35.5799, GNorm = 0.8373, lr_0 = 1.2427e-04
Validation rmse = 0.097715
Validation r2 = 0.895628
Validation mse = 0.009548
Epoch 52
Loss = 7.4218e-02, PNorm = 35.5839, GNorm = 1.6974, lr_0 = 1.2145e-04
Loss = 8.0668e-02, PNorm = 35.5888, GNorm = 1.1011, lr_0 = 1.1894e-04
Validation rmse = 0.098166
Validation r2 = 0.894661
Validation mse = 0.009637
Epoch 53
Loss = 6.8984e-02, PNorm = 35.5910, GNorm = 0.4852, lr_0 = 1.1623e-04
Loss = 7.4795e-02, PNorm = 35.5941, GNorm = 1.3511, lr_0 = 1.1383e-04
Validation rmse = 0.099322
Validation r2 = 0.892166
Validation mse = 0.009865
Epoch 54
Loss = 7.4145e-02, PNorm = 35.5980, GNorm = 0.8301, lr_0 = 1.1124e-04
Loss = 7.5639e-02, PNorm = 35.6013, GNorm = 1.4166, lr_0 = 1.0894e-04
Validation rmse = 0.090557
Validation r2 = 0.910359
Validation mse = 0.008201
Epoch 55
Loss = 8.6250e-02, PNorm = 35.6042, GNorm = 1.0075, lr_0 = 1.0647e-04
Loss = 7.2732e-02, PNorm = 35.6084, GNorm = 0.8192, lr_0 = 1.0427e-04
Loss = 5.6156e-02, PNorm = 35.6087, GNorm = 1.1814, lr_0 = 1.0405e-04
Validation rmse = 0.091722
Validation r2 = 0.908037
Validation mse = 0.008413
Epoch 56
Loss = 6.8660e-02, PNorm = 35.6115, GNorm = 1.4931, lr_0 = 1.0190e-04
Validation rmse = 0.094579
Validation r2 = 0.902218
Validation mse = 0.008945
Epoch 57
Loss = 5.9615e-02, PNorm = 35.6142, GNorm = 0.4742, lr_0 = 1.0000e-04
Loss = 7.2725e-02, PNorm = 35.6172, GNorm = 0.9748, lr_0 = 1.0000e-04
Validation rmse = 0.089019
Validation r2 = 0.913377
Validation mse = 0.007924
Epoch 58
Loss = 7.4846e-02, PNorm = 35.6208, GNorm = 2.4775, lr_0 = 1.0000e-04
Loss = 8.5056e-02, PNorm = 35.6230, GNorm = 2.3225, lr_0 = 1.0000e-04
Validation rmse = 0.082076
Validation r2 = 0.926363
Validation mse = 0.006736
Epoch 59
Loss = 7.4204e-02, PNorm = 35.6267, GNorm = 0.5808, lr_0 = 1.0000e-04
Loss = 8.1684e-02, PNorm = 35.6297, GNorm = 0.8628, lr_0 = 1.0000e-04
Validation rmse = 0.104372
Validation r2 = 0.880922
Validation mse = 0.010894
Model 0 best validation rmse = 0.081855 on epoch 34
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.157497
Model 0 test r2 = 0.681841
Model 0 test mse = 0.024805
Ensemble test rmse = 0.157497
Ensemble test r2 = 0.681841
Ensemble test mse = 0.024805
Fold 4
Splitting data with seed 4
Total size = 966 | train size = 956 | val size = 10 | test size = 56
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.0829e-01, PNorm = 34.0150, GNorm = 5.8520, lr_0 = 3.6053e-04
Validation rmse = 0.277867
Validation r2 = 0.072061
Validation mse = 0.077210
Epoch 1
Loss = 7.0962e-01, PNorm = 34.0379, GNorm = 8.6858, lr_0 = 6.2105e-04
Loss = 6.8470e-01, PNorm = 34.0829, GNorm = 6.0713, lr_0 = 8.5789e-04
Validation rmse = 0.353711
Validation r2 = -0.503636
Validation mse = 0.125112
Epoch 2
Loss = 8.1598e-01, PNorm = 34.1638, GNorm = 5.2173, lr_0 = 9.8961e-04
Loss = 6.4995e-01, PNorm = 34.2262, GNorm = 3.8845, lr_0 = 9.6914e-04
Validation rmse = 0.201634
Validation r2 = 0.511380
Validation mse = 0.040656
Epoch 3
Loss = 4.6298e-01, PNorm = 34.2940, GNorm = 3.8810, lr_0 = 9.4712e-04
Loss = 3.7097e-01, PNorm = 34.3505, GNorm = 3.6427, lr_0 = 9.2754e-04
Validation rmse = 0.182216
Validation r2 = 0.600957
Validation mse = 0.033203
Epoch 4
Loss = 2.7288e-01, PNorm = 34.4094, GNorm = 6.7798, lr_0 = 9.0646e-04
Loss = 3.4525e-01, PNorm = 34.4524, GNorm = 4.2258, lr_0 = 8.8772e-04
Validation rmse = 0.151223
Validation r2 = 0.725161
Validation mse = 0.022868
Epoch 5
Loss = 3.1133e-01, PNorm = 34.5095, GNorm = 1.0092, lr_0 = 8.6755e-04
Loss = 2.2556e-01, PNorm = 34.5500, GNorm = 2.4303, lr_0 = 8.4961e-04
Validation rmse = 0.164659
Validation r2 = 0.674153
Validation mse = 0.027112
Epoch 6
Loss = 1.8985e-01, PNorm = 34.5823, GNorm = 2.1991, lr_0 = 8.3031e-04
Loss = 1.8691e-01, PNorm = 34.6164, GNorm = 3.7461, lr_0 = 8.1314e-04
Validation rmse = 0.155103
Validation r2 = 0.710876
Validation mse = 0.024057
Epoch 7
Loss = 1.6982e-01, PNorm = 34.6521, GNorm = 0.9294, lr_0 = 7.9466e-04
Loss = 1.6768e-01, PNorm = 34.6866, GNorm = 2.1548, lr_0 = 7.7823e-04
Validation rmse = 0.210787
Validation r2 = 0.466010
Validation mse = 0.044431
Epoch 8
Loss = 1.9288e-01, PNorm = 34.7121, GNorm = 5.3005, lr_0 = 7.6055e-04
Loss = 1.7321e-01, PNorm = 34.7412, GNorm = 3.6204, lr_0 = 7.4482e-04
Validation rmse = 0.165145
Validation r2 = 0.672226
Validation mse = 0.027273
Epoch 9
Loss = 1.7365e-01, PNorm = 34.7658, GNorm = 4.2443, lr_0 = 7.2942e-04
Loss = 1.8478e-01, PNorm = 34.7896, GNorm = 1.1973, lr_0 = 7.1434e-04
Validation rmse = 0.161623
Validation r2 = 0.686056
Validation mse = 0.026122
Epoch 10
Loss = 1.3480e-01, PNorm = 34.8201, GNorm = 1.9318, lr_0 = 6.9810e-04
Loss = 1.4472e-01, PNorm = 34.8426, GNorm = 2.9292, lr_0 = 6.8367e-04
Loss = 2.4136e-01, PNorm = 34.8433, GNorm = 2.7327, lr_0 = 6.8224e-04
Validation rmse = 0.157705
Validation r2 = 0.701094
Validation mse = 0.024871
Epoch 11
Loss = 1.4397e-01, PNorm = 34.8628, GNorm = 0.6856, lr_0 = 6.6813e-04
Validation rmse = 0.159049
Validation r2 = 0.695979
Validation mse = 0.025296
Epoch 12
Loss = 1.5842e-01, PNorm = 34.8773, GNorm = 1.6291, lr_0 = 6.5295e-04
Loss = 1.6465e-01, PNorm = 34.8928, GNorm = 2.7845, lr_0 = 6.3945e-04
Validation rmse = 0.165951
Validation r2 = 0.669017
Validation mse = 0.027540
Epoch 13
Loss = 1.1630e-01, PNorm = 34.9164, GNorm = 0.4478, lr_0 = 6.2492e-04
Loss = 1.2977e-01, PNorm = 34.9330, GNorm = 2.0590, lr_0 = 6.1200e-04
Validation rmse = 0.149723
Validation r2 = 0.730586
Validation mse = 0.022417
Epoch 14
Loss = 1.2424e-01, PNorm = 34.9470, GNorm = 0.8276, lr_0 = 5.9809e-04
Loss = 1.3104e-01, PNorm = 34.9604, GNorm = 1.3083, lr_0 = 5.8573e-04
Validation rmse = 0.181806
Validation r2 = 0.602754
Validation mse = 0.033053
Epoch 15
Loss = 1.5021e-01, PNorm = 34.9769, GNorm = 2.6854, lr_0 = 5.7242e-04
Loss = 1.2458e-01, PNorm = 34.9883, GNorm = 1.8239, lr_0 = 5.6058e-04
Validation rmse = 0.136335
Validation r2 = 0.776612
Validation mse = 0.018587
Epoch 16
Loss = 1.1183e-01, PNorm = 35.0046, GNorm = 2.4582, lr_0 = 5.4784e-04
Loss = 1.3044e-01, PNorm = 35.0135, GNorm = 3.1582, lr_0 = 5.3652e-04
Validation rmse = 0.156276
Validation r2 = 0.706486
Validation mse = 0.024422
Epoch 17
Loss = 1.0170e-01, PNorm = 35.0250, GNorm = 1.3836, lr_0 = 5.2542e-04
Loss = 1.2356e-01, PNorm = 35.0407, GNorm = 0.5417, lr_0 = 5.1456e-04
Validation rmse = 0.150129
Validation r2 = 0.729124
Validation mse = 0.022539
Epoch 18
Loss = 1.2228e-01, PNorm = 35.0515, GNorm = 4.3138, lr_0 = 5.0287e-04
Loss = 1.0757e-01, PNorm = 35.0614, GNorm = 1.1545, lr_0 = 4.9247e-04
Validation rmse = 0.160150
Validation r2 = 0.691753
Validation mse = 0.025648
Epoch 19
Loss = 1.0790e-01, PNorm = 35.0755, GNorm = 1.3382, lr_0 = 4.8128e-04
Loss = 1.0006e-01, PNorm = 35.0869, GNorm = 2.0126, lr_0 = 4.7133e-04
Validation rmse = 0.157266
Validation r2 = 0.702756
Validation mse = 0.024733
Epoch 20
Loss = 1.0935e-01, PNorm = 35.1001, GNorm = 0.6276, lr_0 = 4.6062e-04
Loss = 1.0451e-01, PNorm = 35.1071, GNorm = 1.0467, lr_0 = 4.5109e-04
Validation rmse = 0.151311
Validation r2 = 0.724839
Validation mse = 0.022895
Epoch 21
Loss = 1.1391e-01, PNorm = 35.1205, GNorm = 2.4401, lr_0 = 4.4084e-04
Loss = 1.0124e-01, PNorm = 35.1295, GNorm = 3.5148, lr_0 = 4.3173e-04
Loss = 1.9871e-01, PNorm = 35.1306, GNorm = 2.4691, lr_0 = 4.3083e-04
Validation rmse = 0.161230
Validation r2 = 0.687580
Validation mse = 0.025995
Epoch 22
Loss = 1.0367e-01, PNorm = 35.1422, GNorm = 0.7169, lr_0 = 4.2192e-04
Validation rmse = 0.180598
Validation r2 = 0.608012
Validation mse = 0.032616
Epoch 23
Loss = 1.1222e-01, PNorm = 35.1551, GNorm = 2.5414, lr_0 = 4.1233e-04
Loss = 1.0305e-01, PNorm = 35.1655, GNorm = 0.8291, lr_0 = 4.0380e-04
Validation rmse = 0.166368
Validation r2 = 0.667354
Validation mse = 0.027678
Epoch 24
Loss = 9.4415e-02, PNorm = 35.1759, GNorm = 1.7150, lr_0 = 3.9463e-04
Loss = 1.1840e-01, PNorm = 35.1824, GNorm = 0.6972, lr_0 = 3.8647e-04
Validation rmse = 0.172357
Validation r2 = 0.642970
Validation mse = 0.029707
Epoch 25
Loss = 9.4669e-02, PNorm = 35.1940, GNorm = 1.2843, lr_0 = 3.7848e-04
Loss = 1.1161e-01, PNorm = 35.2029, GNorm = 0.8550, lr_0 = 3.7065e-04
Validation rmse = 0.164256
Validation r2 = 0.675743
Validation mse = 0.026980
Epoch 26
Loss = 8.3969e-02, PNorm = 35.2118, GNorm = 1.4062, lr_0 = 3.6223e-04
Loss = 9.6939e-02, PNorm = 35.2173, GNorm = 1.1299, lr_0 = 3.5474e-04
Validation rmse = 0.160482
Validation r2 = 0.690473
Validation mse = 0.025755
Epoch 27
Loss = 9.1998e-02, PNorm = 35.2251, GNorm = 0.6349, lr_0 = 3.4668e-04
Loss = 1.0246e-01, PNorm = 35.2346, GNorm = 1.5375, lr_0 = 3.3951e-04
Validation rmse = 0.151358
Validation r2 = 0.724669
Validation mse = 0.022909
Epoch 28
Loss = 8.1682e-02, PNorm = 35.2427, GNorm = 0.8398, lr_0 = 3.3180e-04
Loss = 9.5168e-02, PNorm = 35.2507, GNorm = 0.6331, lr_0 = 3.2494e-04
Validation rmse = 0.156300
Validation r2 = 0.706397
Validation mse = 0.024430
Epoch 29
Loss = 8.2594e-02, PNorm = 35.2582, GNorm = 0.6686, lr_0 = 3.1755e-04
Loss = 1.0870e-01, PNorm = 35.2668, GNorm = 2.0686, lr_0 = 3.1099e-04
Validation rmse = 0.163592
Validation r2 = 0.678363
Validation mse = 0.026762
Epoch 30
Loss = 1.0051e-01, PNorm = 35.2735, GNorm = 1.5013, lr_0 = 3.0392e-04
Loss = 8.8464e-02, PNorm = 35.2823, GNorm = 0.5348, lr_0 = 2.9764e-04
Validation rmse = 0.158979
Validation r2 = 0.696244
Validation mse = 0.025274
Epoch 31
Loss = 8.5629e-02, PNorm = 35.2917, GNorm = 1.1263, lr_0 = 2.9087e-04
Loss = 1.0353e-01, PNorm = 35.3003, GNorm = 1.6214, lr_0 = 2.8486e-04
Validation rmse = 0.150543
Validation r2 = 0.727624
Validation mse = 0.022663
Epoch 32
Loss = 8.2504e-02, PNorm = 35.3037, GNorm = 0.4652, lr_0 = 2.7839e-04
Loss = 1.0347e-01, PNorm = 35.3094, GNorm = 1.2556, lr_0 = 2.7263e-04
Loss = 5.5309e-02, PNorm = 35.3099, GNorm = 1.6796, lr_0 = 2.7206e-04
Validation rmse = 0.152620
Validation r2 = 0.720058
Validation mse = 0.023293
Epoch 33
Loss = 9.0032e-02, PNorm = 35.3182, GNorm = 0.5699, lr_0 = 2.6643e-04
Loss = 8.3484e-02, PNorm = 35.3254, GNorm = 1.2697, lr_0 = 2.6092e-04
Validation rmse = 0.151127
Validation r2 = 0.725510
Validation mse = 0.022839
Epoch 34
Loss = 7.9397e-02, PNorm = 35.3302, GNorm = 0.5092, lr_0 = 2.5553e-04
Validation rmse = 0.150511
Validation r2 = 0.727740
Validation mse = 0.022654
Epoch 35
Loss = 8.2809e-02, PNorm = 35.3375, GNorm = 2.5013, lr_0 = 2.4972e-04
Loss = 9.8282e-02, PNorm = 35.3448, GNorm = 1.4180, lr_0 = 2.4456e-04
Validation rmse = 0.150384
Validation r2 = 0.728201
Validation mse = 0.022615
Epoch 36
Loss = 8.3434e-02, PNorm = 35.3524, GNorm = 3.4748, lr_0 = 2.3900e-04
Loss = 9.3219e-02, PNorm = 35.3588, GNorm = 2.4691, lr_0 = 2.3406e-04
Validation rmse = 0.158512
Validation r2 = 0.698026
Validation mse = 0.025126
Epoch 37
Loss = 1.0041e-01, PNorm = 35.3646, GNorm = 0.5618, lr_0 = 2.2874e-04
Loss = 8.5499e-02, PNorm = 35.3723, GNorm = 0.7836, lr_0 = 2.2401e-04
Validation rmse = 0.151167
Validation r2 = 0.725362
Validation mse = 0.022852
Epoch 38
Loss = 8.9907e-02, PNorm = 35.3773, GNorm = 1.4573, lr_0 = 2.1892e-04
Loss = 9.0191e-02, PNorm = 35.3839, GNorm = 1.7420, lr_0 = 2.1440e-04
Validation rmse = 0.142672
Validation r2 = 0.755364
Validation mse = 0.020355
Epoch 39
Loss = 6.8329e-02, PNorm = 35.3893, GNorm = 1.7340, lr_0 = 2.0952e-04
Loss = 9.8070e-02, PNorm = 35.3958, GNorm = 2.2370, lr_0 = 2.0519e-04
Validation rmse = 0.156990
Validation r2 = 0.703799
Validation mse = 0.024646
Epoch 40
Loss = 7.9211e-02, PNorm = 35.3996, GNorm = 0.9965, lr_0 = 2.0053e-04
Loss = 8.9244e-02, PNorm = 35.4028, GNorm = 1.6336, lr_0 = 1.9638e-04
Validation rmse = 0.150407
Validation r2 = 0.728117
Validation mse = 0.022622
Epoch 41
Loss = 9.1795e-02, PNorm = 35.4092, GNorm = 1.8557, lr_0 = 1.9192e-04
Loss = 8.2651e-02, PNorm = 35.4163, GNorm = 0.8356, lr_0 = 1.8795e-04
Validation rmse = 0.164489
Validation r2 = 0.674825
Validation mse = 0.027057
Epoch 42
Loss = 9.7749e-02, PNorm = 35.4209, GNorm = 3.9738, lr_0 = 1.8407e-04
Loss = 8.7554e-02, PNorm = 35.4243, GNorm = 1.1267, lr_0 = 1.8026e-04
Validation rmse = 0.147639
Validation r2 = 0.738032
Validation mse = 0.021797
Epoch 43
Loss = 7.7305e-02, PNorm = 35.4303, GNorm = 0.6238, lr_0 = 1.7616e-04
Loss = 8.5342e-02, PNorm = 35.4346, GNorm = 0.7602, lr_0 = 1.7252e-04
Validation rmse = 0.151945
Validation r2 = 0.722530
Validation mse = 0.023087
Epoch 44
Loss = 8.7068e-02, PNorm = 35.4401, GNorm = 2.3952, lr_0 = 1.6860e-04
Loss = 7.7749e-02, PNorm = 35.4443, GNorm = 1.8077, lr_0 = 1.6511e-04
Loss = 3.7610e-03, PNorm = 35.4447, GNorm = 0.7667, lr_0 = 1.6477e-04
Validation rmse = 0.164711
Validation r2 = 0.673946
Validation mse = 0.027130
Epoch 45
Loss = 8.1815e-02, PNorm = 35.4488, GNorm = 1.0530, lr_0 = 1.6136e-04
Validation rmse = 0.153468
Validation r2 = 0.716937
Validation mse = 0.023553
Epoch 46
Loss = 6.5155e-02, PNorm = 35.4531, GNorm = 0.4882, lr_0 = 1.5770e-04
Loss = 7.8441e-02, PNorm = 35.4577, GNorm = 0.5222, lr_0 = 1.5444e-04
Validation rmse = 0.151984
Validation r2 = 0.722387
Validation mse = 0.023099
Epoch 47
Loss = 8.6765e-02, PNorm = 35.4613, GNorm = 0.6124, lr_0 = 1.5093e-04
Loss = 8.4957e-02, PNorm = 35.4665, GNorm = 0.8007, lr_0 = 1.4781e-04
Validation rmse = 0.164591
Validation r2 = 0.674423
Validation mse = 0.027090
Epoch 48
Loss = 7.0208e-02, PNorm = 35.4711, GNorm = 0.8885, lr_0 = 1.4445e-04
Loss = 8.1707e-02, PNorm = 35.4753, GNorm = 1.3311, lr_0 = 1.4146e-04
Validation rmse = 0.167647
Validation r2 = 0.662220
Validation mse = 0.028105
Epoch 49
Loss = 8.0353e-02, PNorm = 35.4798, GNorm = 0.7484, lr_0 = 1.3825e-04
Loss = 8.9096e-02, PNorm = 35.4823, GNorm = 0.5900, lr_0 = 1.3539e-04
Validation rmse = 0.150282
Validation r2 = 0.728571
Validation mse = 0.022585
Epoch 50
Loss = 9.5103e-02, PNorm = 35.4858, GNorm = 1.6649, lr_0 = 1.3259e-04
Loss = 7.2076e-02, PNorm = 35.4907, GNorm = 0.8826, lr_0 = 1.2985e-04
Validation rmse = 0.153560
Validation r2 = 0.716600
Validation mse = 0.023581
Epoch 51
Loss = 7.1646e-02, PNorm = 35.4945, GNorm = 1.8864, lr_0 = 1.2690e-04
Loss = 8.3548e-02, PNorm = 35.4980, GNorm = 0.6443, lr_0 = 1.2427e-04
Validation rmse = 0.150802
Validation r2 = 0.726688
Validation mse = 0.022741
Epoch 52
Loss = 8.3701e-02, PNorm = 35.5022, GNorm = 0.5961, lr_0 = 1.2145e-04
Loss = 7.8181e-02, PNorm = 35.5046, GNorm = 0.4110, lr_0 = 1.1894e-04
Validation rmse = 0.151405
Validation r2 = 0.724496
Validation mse = 0.022924
Epoch 53
Loss = 9.5146e-02, PNorm = 35.5095, GNorm = 0.6460, lr_0 = 1.1623e-04
Loss = 7.5145e-02, PNorm = 35.5129, GNorm = 1.3415, lr_0 = 1.1383e-04
Validation rmse = 0.154326
Validation r2 = 0.713764
Validation mse = 0.023817
Epoch 54
Loss = 8.3711e-02, PNorm = 35.5159, GNorm = 0.5977, lr_0 = 1.1124e-04
Loss = 7.6930e-02, PNorm = 35.5186, GNorm = 0.9812, lr_0 = 1.0894e-04
Validation rmse = 0.149681
Validation r2 = 0.730737
Validation mse = 0.022404
Epoch 55
Loss = 7.8481e-02, PNorm = 35.5219, GNorm = 0.4635, lr_0 = 1.0647e-04
Loss = 7.6086e-02, PNorm = 35.5248, GNorm = 0.6044, lr_0 = 1.0427e-04
Loss = 1.2672e-01, PNorm = 35.5249, GNorm = 1.6377, lr_0 = 1.0405e-04
Validation rmse = 0.154658
Validation r2 = 0.712533
Validation mse = 0.023919
Epoch 56
Loss = 7.6276e-02, PNorm = 35.5277, GNorm = 0.7056, lr_0 = 1.0190e-04
Validation rmse = 0.159234
Validation r2 = 0.695268
Validation mse = 0.025356
Epoch 57
Loss = 6.6294e-02, PNorm = 35.5306, GNorm = 1.3188, lr_0 = 1.0000e-04
Loss = 8.7979e-02, PNorm = 35.5329, GNorm = 1.1894, lr_0 = 1.0000e-04
Validation rmse = 0.148109
Validation r2 = 0.736361
Validation mse = 0.021936
Epoch 58
Loss = 6.6599e-02, PNorm = 35.5365, GNorm = 0.8868, lr_0 = 1.0000e-04
Loss = 8.7588e-02, PNorm = 35.5388, GNorm = 2.6152, lr_0 = 1.0000e-04
Validation rmse = 0.154905
Validation r2 = 0.711612
Validation mse = 0.023996
Epoch 59
Loss = 6.3527e-02, PNorm = 35.5415, GNorm = 1.0162, lr_0 = 1.0000e-04
Loss = 7.6764e-02, PNorm = 35.5441, GNorm = 2.4409, lr_0 = 1.0000e-04
Validation rmse = 0.150382
Validation r2 = 0.728208
Validation mse = 0.022615
Model 0 best validation rmse = 0.136335 on epoch 15
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.155957
Model 0 test r2 = 0.688030
Model 0 test mse = 0.024323
Ensemble test rmse = 0.155957
Ensemble test r2 = 0.688030
Ensemble test mse = 0.024323
Fold 5
Splitting data with seed 5
Total size = 966 | train size = 956 | val size = 10 | test size = 56
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.0779e-01, PNorm = 34.0163, GNorm = 2.4803, lr_0 = 3.6053e-04
Validation rmse = 0.499051
Validation r2 = -1.915851
Validation mse = 0.249052
Epoch 1
Loss = 1.0505e+00, PNorm = 34.0492, GNorm = 14.6948, lr_0 = 6.2105e-04
Loss = 6.1216e-01, PNorm = 34.0853, GNorm = 6.5672, lr_0 = 8.5789e-04
Validation rmse = 0.322649
Validation r2 = -0.218812
Validation mse = 0.104102
Epoch 2
Loss = 5.7051e-01, PNorm = 34.1561, GNorm = 12.4524, lr_0 = 9.8961e-04
Loss = 4.4631e-01, PNorm = 34.2178, GNorm = 3.4908, lr_0 = 9.6914e-04
Validation rmse = 0.314012
Validation r2 = -0.154429
Validation mse = 0.098603
Epoch 3
Loss = 3.9041e-01, PNorm = 34.2941, GNorm = 4.3364, lr_0 = 9.4712e-04
Loss = 3.7044e-01, PNorm = 34.3577, GNorm = 4.1538, lr_0 = 9.2754e-04
Validation rmse = 0.211919
Validation r2 = 0.474208
Validation mse = 0.044909
Epoch 4
Loss = 2.9370e-01, PNorm = 34.4205, GNorm = 4.4597, lr_0 = 9.0646e-04
Loss = 3.6347e-01, PNorm = 34.4973, GNorm = 3.3358, lr_0 = 8.8772e-04
Validation rmse = 0.230417
Validation r2 = 0.378409
Validation mse = 0.053092
Epoch 5
Loss = 2.9383e-01, PNorm = 34.5575, GNorm = 3.1341, lr_0 = 8.6755e-04
Loss = 2.0387e-01, PNorm = 34.5928, GNorm = 1.0901, lr_0 = 8.4961e-04
Validation rmse = 0.275126
Validation r2 = 0.113788
Validation mse = 0.075694
Epoch 6
Loss = 2.5457e-01, PNorm = 34.6253, GNorm = 3.8465, lr_0 = 8.3031e-04
Loss = 2.0986e-01, PNorm = 34.6588, GNorm = 2.4189, lr_0 = 8.1314e-04
Validation rmse = 0.234593
Validation r2 = 0.355672
Validation mse = 0.055034
Epoch 7
Loss = 1.8042e-01, PNorm = 34.6900, GNorm = 0.9863, lr_0 = 7.9466e-04
Loss = 1.6267e-01, PNorm = 34.7218, GNorm = 1.6204, lr_0 = 7.7823e-04
Validation rmse = 0.179238
Validation r2 = 0.623873
Validation mse = 0.032126
Epoch 8
Loss = 1.4477e-01, PNorm = 34.7517, GNorm = 0.6858, lr_0 = 7.6055e-04
Loss = 1.4787e-01, PNorm = 34.7766, GNorm = 3.4134, lr_0 = 7.4482e-04
Validation rmse = 0.219296
Validation r2 = 0.436963
Validation mse = 0.048091
Epoch 9
Loss = 1.3551e-01, PNorm = 34.7952, GNorm = 1.8321, lr_0 = 7.2942e-04
Loss = 1.4184e-01, PNorm = 34.8169, GNorm = 1.9414, lr_0 = 7.1434e-04
Validation rmse = 0.205551
Validation r2 = 0.505331
Validation mse = 0.042251
Epoch 10
Loss = 1.5397e-01, PNorm = 34.8317, GNorm = 3.5173, lr_0 = 6.9810e-04
Loss = 1.6217e-01, PNorm = 34.8454, GNorm = 0.7635, lr_0 = 6.8367e-04
Loss = 8.0394e-02, PNorm = 34.8471, GNorm = 4.3780, lr_0 = 6.8224e-04
Validation rmse = 0.183780
Validation r2 = 0.604569
Validation mse = 0.033775
Epoch 11
Loss = 1.3635e-01, PNorm = 34.8689, GNorm = 2.4026, lr_0 = 6.6813e-04
Validation rmse = 0.183038
Validation r2 = 0.607754
Validation mse = 0.033503
Epoch 12
Loss = 1.9393e-01, PNorm = 34.8862, GNorm = 5.4599, lr_0 = 6.5295e-04
Loss = 1.3472e-01, PNorm = 34.9044, GNorm = 2.7073, lr_0 = 6.3945e-04
Validation rmse = 0.184543
Validation r2 = 0.601278
Validation mse = 0.034056
Epoch 13
Loss = 2.0406e-01, PNorm = 34.9200, GNorm = 6.9841, lr_0 = 6.2492e-04
Loss = 1.6715e-01, PNorm = 34.9364, GNorm = 1.9787, lr_0 = 6.1200e-04
Validation rmse = 0.203027
Validation r2 = 0.517406
Validation mse = 0.041220
Epoch 14
Loss = 1.2870e-01, PNorm = 34.9575, GNorm = 5.4032, lr_0 = 5.9809e-04
Loss = 1.6679e-01, PNorm = 34.9802, GNorm = 1.9471, lr_0 = 5.8573e-04
Validation rmse = 0.223328
Validation r2 = 0.416066
Validation mse = 0.049876
Epoch 15
Loss = 1.2074e-01, PNorm = 34.9996, GNorm = 1.7383, lr_0 = 5.7242e-04
Loss = 1.5191e-01, PNorm = 35.0124, GNorm = 3.1946, lr_0 = 5.6058e-04
Validation rmse = 0.189466
Validation r2 = 0.579719
Validation mse = 0.035897
Epoch 16
Loss = 1.3256e-01, PNorm = 35.0279, GNorm = 1.7375, lr_0 = 5.4784e-04
Loss = 1.1746e-01, PNorm = 35.0431, GNorm = 0.8058, lr_0 = 5.3652e-04
Validation rmse = 0.194317
Validation r2 = 0.557921
Validation mse = 0.037759
Epoch 17
Loss = 1.0675e-01, PNorm = 35.0532, GNorm = 0.6738, lr_0 = 5.2542e-04
Loss = 1.2044e-01, PNorm = 35.0643, GNorm = 1.8450, lr_0 = 5.1456e-04
Validation rmse = 0.188529
Validation r2 = 0.583868
Validation mse = 0.035543
Epoch 18
Loss = 8.6375e-02, PNorm = 35.0730, GNorm = 1.4776, lr_0 = 5.0287e-04
Loss = 1.2965e-01, PNorm = 35.0809, GNorm = 1.3766, lr_0 = 4.9247e-04
Validation rmse = 0.190857
Validation r2 = 0.573525
Validation mse = 0.036426
Epoch 19
Loss = 1.1150e-01, PNorm = 35.0956, GNorm = 1.2507, lr_0 = 4.8128e-04
Loss = 1.0124e-01, PNorm = 35.1071, GNorm = 1.6352, lr_0 = 4.7133e-04
Validation rmse = 0.190521
Validation r2 = 0.575027
Validation mse = 0.036298
Epoch 20
Loss = 1.1007e-01, PNorm = 35.1193, GNorm = 0.9017, lr_0 = 4.6062e-04
Loss = 1.0823e-01, PNorm = 35.1275, GNorm = 2.8229, lr_0 = 4.5109e-04
Validation rmse = 0.182239
Validation r2 = 0.611171
Validation mse = 0.033211
Epoch 21
Loss = 1.0561e-01, PNorm = 35.1392, GNorm = 1.2674, lr_0 = 4.4084e-04
Loss = 1.1642e-01, PNorm = 35.1481, GNorm = 0.9036, lr_0 = 4.3173e-04
Loss = 3.0533e-02, PNorm = 35.1498, GNorm = 1.4243, lr_0 = 4.3083e-04
Validation rmse = 0.179992
Validation r2 = 0.620702
Validation mse = 0.032397
Epoch 22
Loss = 9.4629e-02, PNorm = 35.1618, GNorm = 0.7178, lr_0 = 4.2192e-04
Validation rmse = 0.192367
Validation r2 = 0.566752
Validation mse = 0.037005
Epoch 23
Loss = 6.9123e-02, PNorm = 35.1688, GNorm = 0.8378, lr_0 = 4.1233e-04
Loss = 1.0748e-01, PNorm = 35.1775, GNorm = 2.2277, lr_0 = 4.0380e-04
Validation rmse = 0.189649
Validation r2 = 0.578906
Validation mse = 0.035967
Epoch 24
Loss = 5.5553e-02, PNorm = 35.1902, GNorm = 0.7429, lr_0 = 3.9463e-04
Loss = 1.2010e-01, PNorm = 35.1996, GNorm = 0.6804, lr_0 = 3.8647e-04
Validation rmse = 0.194398
Validation r2 = 0.557556
Validation mse = 0.037790
Epoch 25
Loss = 1.1315e-01, PNorm = 35.2081, GNorm = 1.2465, lr_0 = 3.7848e-04
Loss = 9.8950e-02, PNorm = 35.2159, GNorm = 0.8071, lr_0 = 3.7065e-04
Validation rmse = 0.215774
Validation r2 = 0.454903
Validation mse = 0.046558
Epoch 26
Loss = 9.6360e-02, PNorm = 35.2251, GNorm = 1.4639, lr_0 = 3.6223e-04
Loss = 1.1858e-01, PNorm = 35.2359, GNorm = 2.2790, lr_0 = 3.5474e-04
Validation rmse = 0.186616
Validation r2 = 0.592267
Validation mse = 0.034826
Epoch 27
Loss = 9.5526e-02, PNorm = 35.2466, GNorm = 2.3205, lr_0 = 3.4668e-04
Loss = 1.0829e-01, PNorm = 35.2551, GNorm = 1.1811, lr_0 = 3.3951e-04
Validation rmse = 0.188098
Validation r2 = 0.585767
Validation mse = 0.035381
Epoch 28
Loss = 8.5585e-02, PNorm = 35.2641, GNorm = 0.6560, lr_0 = 3.3180e-04
Loss = 9.9090e-02, PNorm = 35.2715, GNorm = 2.7631, lr_0 = 3.2494e-04
Validation rmse = 0.180145
Validation r2 = 0.620055
Validation mse = 0.032452
Epoch 29
Loss = 9.1827e-02, PNorm = 35.2809, GNorm = 0.7956, lr_0 = 3.1755e-04
Loss = 1.0663e-01, PNorm = 35.2869, GNorm = 2.5130, lr_0 = 3.1099e-04
Validation rmse = 0.188282
Validation r2 = 0.584955
Validation mse = 0.035450
Epoch 30
Loss = 1.0181e-01, PNorm = 35.2959, GNorm = 1.0784, lr_0 = 3.0392e-04
Loss = 1.0009e-01, PNorm = 35.3043, GNorm = 3.2700, lr_0 = 2.9764e-04
Validation rmse = 0.195207
Validation r2 = 0.553866
Validation mse = 0.038106
Epoch 31
Loss = 8.2788e-02, PNorm = 35.3156, GNorm = 0.8025, lr_0 = 2.9087e-04
Loss = 1.0207e-01, PNorm = 35.3239, GNorm = 1.0215, lr_0 = 2.8486e-04
Validation rmse = 0.194729
Validation r2 = 0.556045
Validation mse = 0.037920
Epoch 32
Loss = 9.0070e-02, PNorm = 35.3298, GNorm = 0.8828, lr_0 = 2.7839e-04
Loss = 9.0177e-02, PNorm = 35.3368, GNorm = 0.7192, lr_0 = 2.7263e-04
Loss = 3.2662e-01, PNorm = 35.3377, GNorm = 7.5801, lr_0 = 2.7206e-04
Validation rmse = 0.198224
Validation r2 = 0.539968
Validation mse = 0.039293
Epoch 33
Loss = 1.1573e-01, PNorm = 35.3490, GNorm = 1.6588, lr_0 = 2.6643e-04
Loss = 1.1350e-01, PNorm = 35.3570, GNorm = 2.5318, lr_0 = 2.6092e-04
Validation rmse = 0.183945
Validation r2 = 0.603856
Validation mse = 0.033836
Epoch 34
Loss = 1.0065e-01, PNorm = 35.3648, GNorm = 0.8721, lr_0 = 2.5553e-04
Validation rmse = 0.177849
Validation r2 = 0.629677
Validation mse = 0.031630
Epoch 35
Loss = 1.2367e-01, PNorm = 35.3721, GNorm = 2.4885, lr_0 = 2.4972e-04
Loss = 9.0485e-02, PNorm = 35.3801, GNorm = 0.5523, lr_0 = 2.4456e-04
Validation rmse = 0.186742
Validation r2 = 0.591719
Validation mse = 0.034873
Epoch 36
Loss = 9.0616e-02, PNorm = 35.3869, GNorm = 0.6341, lr_0 = 2.3900e-04
Loss = 8.5987e-02, PNorm = 35.3924, GNorm = 0.9689, lr_0 = 2.3406e-04
Validation rmse = 0.183662
Validation r2 = 0.605076
Validation mse = 0.033732
Epoch 37
Loss = 8.7532e-02, PNorm = 35.3969, GNorm = 1.5256, lr_0 = 2.2874e-04
Loss = 9.4373e-02, PNorm = 35.4029, GNorm = 1.9206, lr_0 = 2.2401e-04
Validation rmse = 0.196617
Validation r2 = 0.547395
Validation mse = 0.038658
Epoch 38
Loss = 9.9962e-02, PNorm = 35.4102, GNorm = 1.8029, lr_0 = 2.1892e-04
Loss = 9.0422e-02, PNorm = 35.4181, GNorm = 0.6774, lr_0 = 2.1440e-04
Validation rmse = 0.185694
Validation r2 = 0.596288
Validation mse = 0.034482
Epoch 39
Loss = 9.8422e-02, PNorm = 35.4235, GNorm = 1.8889, lr_0 = 2.0952e-04
Loss = 7.4571e-02, PNorm = 35.4280, GNorm = 0.9033, lr_0 = 2.0519e-04
Validation rmse = 0.200936
Validation r2 = 0.527292
Validation mse = 0.040375
Epoch 40
Loss = 9.0633e-02, PNorm = 35.4341, GNorm = 0.7027, lr_0 = 2.0053e-04
Loss = 9.2314e-02, PNorm = 35.4396, GNorm = 0.7530, lr_0 = 1.9638e-04
Validation rmse = 0.183816
Validation r2 = 0.604410
Validation mse = 0.033788
Epoch 41
Loss = 1.1077e-01, PNorm = 35.4433, GNorm = 2.3314, lr_0 = 1.9192e-04
Loss = 7.6803e-02, PNorm = 35.4489, GNorm = 1.2554, lr_0 = 1.8795e-04
Validation rmse = 0.219086
Validation r2 = 0.438041
Validation mse = 0.047999
Epoch 42
Loss = 1.2822e-01, PNorm = 35.4556, GNorm = 3.7019, lr_0 = 1.8407e-04
Loss = 8.5565e-02, PNorm = 35.4598, GNorm = 1.7373, lr_0 = 1.8026e-04
Validation rmse = 0.185628
Validation r2 = 0.596577
Validation mse = 0.034458
Epoch 43
Loss = 7.9899e-02, PNorm = 35.4653, GNorm = 0.4052, lr_0 = 1.7616e-04
Loss = 8.5326e-02, PNorm = 35.4708, GNorm = 1.5560, lr_0 = 1.7252e-04
Validation rmse = 0.187549
Validation r2 = 0.588182
Validation mse = 0.035175
Epoch 44
Loss = 7.3981e-02, PNorm = 35.4772, GNorm = 0.8164, lr_0 = 1.6860e-04
Loss = 8.6575e-02, PNorm = 35.4813, GNorm = 0.6125, lr_0 = 1.6511e-04
Loss = 1.2536e-01, PNorm = 35.4818, GNorm = 2.9526, lr_0 = 1.6477e-04
Validation rmse = 0.180471
Validation r2 = 0.618680
Validation mse = 0.032570
Epoch 45
Loss = 9.5449e-02, PNorm = 35.4859, GNorm = 1.5465, lr_0 = 1.6136e-04
Validation rmse = 0.187528
Validation r2 = 0.588272
Validation mse = 0.035167
Epoch 46
Loss = 9.0509e-02, PNorm = 35.4911, GNorm = 0.7061, lr_0 = 1.5770e-04
Loss = 8.0324e-02, PNorm = 35.4947, GNorm = 1.9148, lr_0 = 1.5444e-04
Validation rmse = 0.186578
Validation r2 = 0.592434
Validation mse = 0.034811
Epoch 47
Loss = 6.7001e-02, PNorm = 35.4999, GNorm = 0.5767, lr_0 = 1.5093e-04
Loss = 8.5146e-02, PNorm = 35.5034, GNorm = 1.7835, lr_0 = 1.4781e-04
Validation rmse = 0.189425
Validation r2 = 0.579904
Validation mse = 0.035882
Epoch 48
Loss = 7.6829e-02, PNorm = 35.5080, GNorm = 2.1173, lr_0 = 1.4445e-04
Loss = 9.8861e-02, PNorm = 35.5133, GNorm = 1.0530, lr_0 = 1.4146e-04
Validation rmse = 0.183450
Validation r2 = 0.605988
Validation mse = 0.033654
Epoch 49
Loss = 8.7779e-02, PNorm = 35.5164, GNorm = 0.9514, lr_0 = 1.3825e-04
Loss = 9.3166e-02, PNorm = 35.5207, GNorm = 2.6593, lr_0 = 1.3539e-04
Validation rmse = 0.191745
Validation r2 = 0.569547
Validation mse = 0.036766
Epoch 50
Loss = 9.5004e-02, PNorm = 35.5265, GNorm = 0.5858, lr_0 = 1.3259e-04
Loss = 7.9707e-02, PNorm = 35.5302, GNorm = 1.3103, lr_0 = 1.2985e-04
Validation rmse = 0.185498
Validation r2 = 0.597142
Validation mse = 0.034409
Epoch 51
Loss = 8.8777e-02, PNorm = 35.5331, GNorm = 0.9757, lr_0 = 1.2690e-04
Loss = 7.6082e-02, PNorm = 35.5368, GNorm = 0.6719, lr_0 = 1.2427e-04
Validation rmse = 0.188411
Validation r2 = 0.584385
Validation mse = 0.035499
Epoch 52
Loss = 8.2014e-02, PNorm = 35.5397, GNorm = 0.5763, lr_0 = 1.2145e-04
Loss = 7.3664e-02, PNorm = 35.5426, GNorm = 0.4710, lr_0 = 1.1894e-04
Validation rmse = 0.194246
Validation r2 = 0.558244
Validation mse = 0.037732
Epoch 53
Loss = 7.1805e-02, PNorm = 35.5474, GNorm = 0.7905, lr_0 = 1.1623e-04
Loss = 8.7881e-02, PNorm = 35.5506, GNorm = 0.5631, lr_0 = 1.1383e-04
Validation rmse = 0.181080
Validation r2 = 0.616102
Validation mse = 0.032790
Epoch 54
Loss = 8.9719e-02, PNorm = 35.5535, GNorm = 1.0881, lr_0 = 1.1124e-04
Loss = 8.1633e-02, PNorm = 35.5570, GNorm = 0.6671, lr_0 = 1.0894e-04
Validation rmse = 0.188254
Validation r2 = 0.585082
Validation mse = 0.035439
Epoch 55
Loss = 7.9566e-02, PNorm = 35.5593, GNorm = 0.5494, lr_0 = 1.0647e-04
Loss = 7.6155e-02, PNorm = 35.5625, GNorm = 0.9005, lr_0 = 1.0427e-04
Loss = 3.7698e-02, PNorm = 35.5628, GNorm = 1.0437, lr_0 = 1.0405e-04
Validation rmse = 0.186790
Validation r2 = 0.591509
Validation mse = 0.034890
Epoch 56
Loss = 6.5225e-02, PNorm = 35.5655, GNorm = 0.5282, lr_0 = 1.0190e-04
Validation rmse = 0.186761
Validation r2 = 0.591633
Validation mse = 0.034880
Epoch 57
Loss = 7.6333e-02, PNorm = 35.5686, GNorm = 1.1201, lr_0 = 1.0000e-04
Loss = 6.3028e-02, PNorm = 35.5714, GNorm = 0.4024, lr_0 = 1.0000e-04
Validation rmse = 0.185579
Validation r2 = 0.596788
Validation mse = 0.034440
Epoch 58
Loss = 5.9251e-02, PNorm = 35.5747, GNorm = 0.6405, lr_0 = 1.0000e-04
Loss = 8.2588e-02, PNorm = 35.5770, GNorm = 0.4570, lr_0 = 1.0000e-04
Validation rmse = 0.181996
Validation r2 = 0.612209
Validation mse = 0.033122
Epoch 59
Loss = 9.1422e-02, PNorm = 35.5792, GNorm = 0.7907, lr_0 = 1.0000e-04
Loss = 7.6716e-02, PNorm = 35.5825, GNorm = 1.1144, lr_0 = 1.0000e-04
Validation rmse = 0.191205
Validation r2 = 0.571969
Validation mse = 0.036559
Model 0 best validation rmse = 0.177849 on epoch 34
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.150625
Model 0 test r2 = 0.708999
Model 0 test mse = 0.022688
Ensemble test rmse = 0.150625
Ensemble test r2 = 0.708999
Ensemble test mse = 0.022688
Fold 6
Splitting data with seed 6
Total size = 966 | train size = 956 | val size = 10 | test size = 56
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.2825e-01, PNorm = 34.0145, GNorm = 2.8822, lr_0 = 3.6053e-04
Validation rmse = 0.380149
Validation r2 = -0.104384
Validation mse = 0.144514
Epoch 1
Loss = 9.7081e-01, PNorm = 34.0398, GNorm = 12.9780, lr_0 = 6.2105e-04
Loss = 7.5598e-01, PNorm = 34.0805, GNorm = 8.1925, lr_0 = 8.5789e-04
Validation rmse = 0.172096
Validation r2 = 0.773665
Validation mse = 0.029617
Epoch 2
Loss = 5.5457e-01, PNorm = 34.1493, GNorm = 4.8639, lr_0 = 9.8961e-04
Loss = 4.9225e-01, PNorm = 34.2235, GNorm = 11.0547, lr_0 = 9.6914e-04
Validation rmse = 0.148808
Validation r2 = 0.830775
Validation mse = 0.022144
Epoch 3
Loss = 4.3081e-01, PNorm = 34.2971, GNorm = 5.4555, lr_0 = 9.4712e-04
Loss = 3.5594e-01, PNorm = 34.3640, GNorm = 1.4384, lr_0 = 9.2754e-04
Validation rmse = 0.119855
Validation r2 = 0.890219
Validation mse = 0.014365
Epoch 4
Loss = 2.2526e-01, PNorm = 34.4268, GNorm = 2.3675, lr_0 = 9.0646e-04
Loss = 2.4307e-01, PNorm = 34.4809, GNorm = 1.0566, lr_0 = 8.8772e-04
Validation rmse = 0.198051
Validation r2 = 0.700247
Validation mse = 0.039224
Epoch 5
Loss = 2.6427e-01, PNorm = 34.5395, GNorm = 1.5967, lr_0 = 8.6755e-04
Loss = 2.1614e-01, PNorm = 34.5781, GNorm = 1.9090, lr_0 = 8.4961e-04
Validation rmse = 0.105226
Validation r2 = 0.915383
Validation mse = 0.011073
Epoch 6
Loss = 2.5824e-01, PNorm = 34.6267, GNorm = 0.9476, lr_0 = 8.3031e-04
Loss = 2.3170e-01, PNorm = 34.6653, GNorm = 2.7762, lr_0 = 8.1314e-04
Validation rmse = 0.082857
Validation r2 = 0.947534
Validation mse = 0.006865
Epoch 7
Loss = 1.8867e-01, PNorm = 34.7090, GNorm = 1.4306, lr_0 = 7.9466e-04
Loss = 1.8918e-01, PNorm = 34.7341, GNorm = 3.5506, lr_0 = 7.7823e-04
Validation rmse = 0.064417
Validation r2 = 0.968289
Validation mse = 0.004150
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-1d5c3576-9790-4896-9034-9bb28ba18d8e.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/MeOH_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2', 'mse'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2', 'mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/generalization_3/MeOH_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/MeOH_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 705 | train size = 564 | val size = 141 | test size = 317
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.2161e-01, PNorm = 34.0201, GNorm = 5.8846, lr_0 = 5.5000e-04
Validation rmse = 0.306603
Validation r2 = 0.268784
Validation mse = 0.094006
Epoch 1
Loss = 7.5686e-01, PNorm = 34.0692, GNorm = 13.7927, lr_0 = 1.0000e-03
Validation rmse = 0.329331
Validation r2 = 0.156359
Validation mse = 0.108459
Epoch 2
Loss = 5.9437e-01, PNorm = 34.1394, GNorm = 6.9019, lr_0 = 9.6108e-04
Validation rmse = 0.236484
Validation r2 = 0.564993
Validation mse = 0.055925
Epoch 3
Loss = 4.0962e-01, PNorm = 34.2167, GNorm = 1.3270, lr_0 = 9.2367e-04
Validation rmse = 0.224794
Validation r2 = 0.606936
Validation mse = 0.050533
Epoch 4
Loss = 3.9030e-01, PNorm = 34.2735, GNorm = 1.3868, lr_0 = 8.9093e-04
Validation rmse = 0.202564
Validation r2 = 0.680834
Validation mse = 0.041032
Epoch 5
Loss = 3.6050e-01, PNorm = 34.3407, GNorm = 1.2807, lr_0 = 8.5625e-04
Validation rmse = 0.182894
Validation r2 = 0.739810
Validation mse = 0.033450
Epoch 6
Loss = 2.3473e-01, PNorm = 34.3952, GNorm = 0.8365, lr_0 = 8.2293e-04
Validation rmse = 0.187781
Validation r2 = 0.725720
Validation mse = 0.035262
Epoch 7
Loss = 3.3937e-01, PNorm = 34.4478, GNorm = 7.4210, lr_0 = 7.9090e-04
Loss = 2.4396e-01, PNorm = 34.4871, GNorm = 3.8694, lr_0 = 7.6286e-04
Validation rmse = 0.173626
Validation r2 = 0.765512
Validation mse = 0.030146
Epoch 8
Loss = 2.0932e-01, PNorm = 34.5252, GNorm = 0.7880, lr_0 = 7.3582e-04
Validation rmse = 0.154862
Validation r2 = 0.813456
Validation mse = 0.023982
Epoch 9
Loss = 2.0535e-01, PNorm = 34.5670, GNorm = 4.2564, lr_0 = 7.0718e-04
Validation rmse = 0.144791
Validation r2 = 0.836929
Validation mse = 0.020964
Epoch 10
Loss = 1.7615e-01, PNorm = 34.6041, GNorm = 3.0733, lr_0 = 6.7965e-04
Validation rmse = 0.143221
Validation r2 = 0.840447
Validation mse = 0.020512
Epoch 11
Loss = 1.5880e-01, PNorm = 34.6387, GNorm = 2.2179, lr_0 = 6.5556e-04
Validation rmse = 0.159829
Validation r2 = 0.801297
Validation mse = 0.025545
Epoch 12
Loss = 1.9353e-01, PNorm = 34.6711, GNorm = 2.4575, lr_0 = 6.3005e-04
Validation rmse = 0.130311
Validation r2 = 0.867914
Validation mse = 0.016981
Epoch 13
Loss = 1.4813e-01, PNorm = 34.7018, GNorm = 1.8375, lr_0 = 6.0552e-04
Validation rmse = 0.125339
Validation r2 = 0.877801
Validation mse = 0.015710
Epoch 14
Loss = 1.4400e-01, PNorm = 34.7312, GNorm = 1.6359, lr_0 = 5.8196e-04
Validation rmse = 0.123418
Validation r2 = 0.881520
Validation mse = 0.015232
Epoch 15
Loss = 1.0436e-01, PNorm = 34.7565, GNorm = 0.7218, lr_0 = 5.6133e-04
Loss = 1.4580e-01, PNorm = 34.7808, GNorm = 0.9583, lr_0 = 5.4143e-04
Loss = 1.8678e-01, PNorm = 34.7833, GNorm = 5.1863, lr_0 = 5.3948e-04
Validation rmse = 0.127163
Validation r2 = 0.874219
Validation mse = 0.016170
Epoch 16
Loss = 1.3664e-01, PNorm = 34.8039, GNorm = 4.4941, lr_0 = 5.2036e-04
Validation rmse = 0.125925
Validation r2 = 0.876657
Validation mse = 0.015857
Epoch 17
Loss = 1.4022e-01, PNorm = 34.8244, GNorm = 1.2130, lr_0 = 5.0010e-04
Validation rmse = 0.120363
Validation r2 = 0.887312
Validation mse = 0.014487
Epoch 18
Loss = 1.3295e-01, PNorm = 34.8393, GNorm = 4.2083, lr_0 = 4.8238e-04
Validation rmse = 0.120820
Validation r2 = 0.886455
Validation mse = 0.014597
Epoch 19
Loss = 1.5438e-01, PNorm = 34.8595, GNorm = 1.2685, lr_0 = 4.6360e-04
Validation rmse = 0.161202
Validation r2 = 0.797869
Validation mse = 0.025986
Epoch 20
Loss = 1.6640e-01, PNorm = 34.8761, GNorm = 4.2591, lr_0 = 4.4556e-04
Validation rmse = 0.131289
Validation r2 = 0.865925
Validation mse = 0.017237
Epoch 21
Loss = 1.2047e-01, PNorm = 34.8913, GNorm = 2.7988, lr_0 = 4.2821e-04
Validation rmse = 0.137997
Validation r2 = 0.851873
Validation mse = 0.019043
Epoch 22
Loss = 1.3124e-01, PNorm = 34.9083, GNorm = 0.7290, lr_0 = 4.1304e-04
Validation rmse = 0.115274
Validation r2 = 0.896640
Validation mse = 0.013288
Epoch 23
Loss = 1.2639e-01, PNorm = 34.9229, GNorm = 1.3255, lr_0 = 3.9696e-04
Loss = 1.1607e-01, PNorm = 34.9350, GNorm = 1.5481, lr_0 = 3.8289e-04
Loss = 7.8335e-02, PNorm = 34.9365, GNorm = 1.5580, lr_0 = 3.8151e-04
Validation rmse = 0.116293
Validation r2 = 0.894804
Validation mse = 0.013524
Epoch 24
Loss = 1.1975e-01, PNorm = 34.9475, GNorm = 1.6529, lr_0 = 3.6799e-04
Validation rmse = 0.114816
Validation r2 = 0.897460
Validation mse = 0.013183
Epoch 25
Loss = 1.1276e-01, PNorm = 34.9596, GNorm = 0.6357, lr_0 = 3.5494e-04
Validation rmse = 0.120241
Validation r2 = 0.887541
Validation mse = 0.014458
Epoch 26
Loss = 1.1675e-01, PNorm = 34.9713, GNorm = 0.9069, lr_0 = 3.4113e-04
Validation rmse = 0.116525
Validation r2 = 0.894384
Validation mse = 0.013578
Epoch 27
Loss = 9.7118e-02, PNorm = 34.9821, GNorm = 0.5660, lr_0 = 3.2785e-04
Validation rmse = 0.118833
Validation r2 = 0.890158
Validation mse = 0.014121
Epoch 28
Loss = 1.0370e-01, PNorm = 34.9931, GNorm = 0.9862, lr_0 = 3.1509e-04
Validation rmse = 0.116149
Validation r2 = 0.895064
Validation mse = 0.013491
Epoch 29
Loss = 1.0648e-01, PNorm = 35.0016, GNorm = 3.0728, lr_0 = 3.0392e-04
Validation rmse = 0.128453
Validation r2 = 0.871655
Validation mse = 0.016500
Epoch 30
Loss = 1.1800e-01, PNorm = 35.0132, GNorm = 1.6883, lr_0 = 2.9209e-04
Validation rmse = 0.124170
Validation r2 = 0.880070
Validation mse = 0.015418
Epoch 31
Loss = 1.2744e-01, PNorm = 35.0240, GNorm = 3.3784, lr_0 = 2.8072e-04
Loss = 1.2406e-01, PNorm = 35.0329, GNorm = 4.2041, lr_0 = 2.7077e-04
Loss = 7.3919e-02, PNorm = 35.0336, GNorm = 1.4658, lr_0 = 2.6980e-04
Validation rmse = 0.117759
Validation r2 = 0.892135
Validation mse = 0.013867
Epoch 32
Loss = 1.0642e-01, PNorm = 35.0441, GNorm = 0.9293, lr_0 = 2.6023e-04
Validation rmse = 0.114474
Validation r2 = 0.898069
Validation mse = 0.013104
Epoch 33
Loss = 1.0909e-01, PNorm = 35.0508, GNorm = 1.8332, lr_0 = 2.5101e-04
Validation rmse = 0.124300
Validation r2 = 0.879820
Validation mse = 0.015450
Epoch 34
Loss = 9.9346e-02, PNorm = 35.0598, GNorm = 0.5328, lr_0 = 2.4124e-04
Validation rmse = 0.120304
Validation r2 = 0.887422
Validation mse = 0.014473
Epoch 35
Loss = 9.6424e-02, PNorm = 35.0673, GNorm = 0.9215, lr_0 = 2.3185e-04
Validation rmse = 0.115061
Validation r2 = 0.897021
Validation mse = 0.013239
Epoch 36
Loss = 7.7117e-02, PNorm = 35.0739, GNorm = 0.7026, lr_0 = 2.2363e-04
Validation rmse = 0.115233
Validation r2 = 0.896712
Validation mse = 0.013279
Epoch 37
Loss = 9.2057e-02, PNorm = 35.0810, GNorm = 0.4350, lr_0 = 2.1493e-04
Validation rmse = 0.116193
Validation r2 = 0.894984
Validation mse = 0.013501
Epoch 38
Loss = 9.1616e-02, PNorm = 35.0872, GNorm = 1.5578, lr_0 = 2.0656e-04
Validation rmse = 0.119848
Validation r2 = 0.888275
Validation mse = 0.014363
Epoch 39
Loss = 8.1721e-02, PNorm = 35.0932, GNorm = 1.5472, lr_0 = 1.9852e-04
Loss = 9.9693e-02, PNorm = 35.0993, GNorm = 0.8789, lr_0 = 1.9148e-04
Validation rmse = 0.115854
Validation r2 = 0.895598
Validation mse = 0.013422
Epoch 40
Loss = 9.0889e-02, PNorm = 35.1049, GNorm = 1.7426, lr_0 = 1.8470e-04
Validation rmse = 0.114781
Validation r2 = 0.897522
Validation mse = 0.013175
Epoch 41
Loss = 9.8608e-02, PNorm = 35.1112, GNorm = 1.0247, lr_0 = 1.7751e-04
Validation rmse = 0.115963
Validation r2 = 0.895399
Validation mse = 0.013448
Epoch 42
Loss = 1.0154e-01, PNorm = 35.1176, GNorm = 1.1593, lr_0 = 1.7060e-04
Validation rmse = 0.115407
Validation r2 = 0.896401
Validation mse = 0.013319
Epoch 43
Loss = 9.7214e-02, PNorm = 35.1222, GNorm = 0.8975, lr_0 = 1.6455e-04
Validation rmse = 0.127170
Validation r2 = 0.874206
Validation mse = 0.016172
Epoch 44
Loss = 9.3462e-02, PNorm = 35.1268, GNorm = 2.2130, lr_0 = 1.5815e-04
Validation rmse = 0.115491
Validation r2 = 0.896250
Validation mse = 0.013338
Epoch 45
Loss = 9.2361e-02, PNorm = 35.1317, GNorm = 2.2940, lr_0 = 1.5199e-04
Validation rmse = 0.115378
Validation r2 = 0.896453
Validation mse = 0.013312
Epoch 46
Loss = 6.3761e-02, PNorm = 35.1365, GNorm = 1.0417, lr_0 = 1.4608e-04
Loss = 9.5356e-02, PNorm = 35.1411, GNorm = 2.7695, lr_0 = 1.4090e-04
Validation rmse = 0.115896
Validation r2 = 0.895520
Validation mse = 0.013432
Epoch 47
Loss = 9.9267e-02, PNorm = 35.1449, GNorm = 2.2912, lr_0 = 1.3590e-04
Validation rmse = 0.114334
Validation r2 = 0.898318
Validation mse = 0.013072
Epoch 48
Loss = 9.4721e-02, PNorm = 35.1488, GNorm = 1.6362, lr_0 = 1.3061e-04
Validation rmse = 0.114407
Validation r2 = 0.898188
Validation mse = 0.013089
Epoch 49
Loss = 9.5637e-02, PNorm = 35.1531, GNorm = 1.2052, lr_0 = 1.2553e-04
Validation rmse = 0.114936
Validation r2 = 0.897245
Validation mse = 0.013210
Epoch 50
Loss = 7.7737e-02, PNorm = 35.1563, GNorm = 0.4693, lr_0 = 1.2108e-04
Validation rmse = 0.125518
Validation r2 = 0.877452
Validation mse = 0.015755
Epoch 51
Loss = 9.1095e-02, PNorm = 35.1613, GNorm = 0.6424, lr_0 = 1.1637e-04
Validation rmse = 0.118401
Validation r2 = 0.890956
Validation mse = 0.014019
Epoch 52
Loss = 8.4625e-02, PNorm = 35.1652, GNorm = 0.8744, lr_0 = 1.1184e-04
Validation rmse = 0.115478
Validation r2 = 0.896273
Validation mse = 0.013335
Epoch 53
Loss = 7.7428e-02, PNorm = 35.1695, GNorm = 1.3867, lr_0 = 1.0749e-04
Validation rmse = 0.115819
Validation r2 = 0.895659
Validation mse = 0.013414
Epoch 54
Loss = 9.6785e-02, PNorm = 35.1730, GNorm = 0.8818, lr_0 = 1.0367e-04
Loss = 8.8160e-02, PNorm = 35.1757, GNorm = 0.5522, lr_0 = 1.0000e-04
Loss = 9.5300e-02, PNorm = 35.1760, GNorm = 2.0247, lr_0 = 1.0000e-04
Validation rmse = 0.117085
Validation r2 = 0.893367
Validation mse = 0.013709
Epoch 55
Loss = 9.0016e-02, PNorm = 35.1791, GNorm = 0.5885, lr_0 = 1.0000e-04
Validation rmse = 0.114462
Validation r2 = 0.898090
Validation mse = 0.013102
Epoch 56
Loss = 8.7324e-02, PNorm = 35.1819, GNorm = 1.3061, lr_0 = 1.0000e-04
Validation rmse = 0.120361
Validation r2 = 0.887315
Validation mse = 0.014487
Epoch 57
Loss = 8.2773e-02, PNorm = 35.1857, GNorm = 0.6719, lr_0 = 1.0000e-04
Validation rmse = 0.114880
Validation r2 = 0.897344
Validation mse = 0.013197
Epoch 58
Loss = 8.8975e-02, PNorm = 35.1895, GNorm = 2.3955, lr_0 = 1.0000e-04
Validation rmse = 0.113856
Validation r2 = 0.899166
Validation mse = 0.012963
Epoch 59
Loss = 1.0789e-01, PNorm = 35.1931, GNorm = 0.9479, lr_0 = 1.0000e-04
Validation rmse = 0.114327
Validation r2 = 0.898331
Validation mse = 0.013071
Model 0 best validation rmse = 0.113856 on epoch 58
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.166109
Model 0 test r2 = 0.603901
Model 0 test mse = 0.027592
Ensemble test rmse = 0.166109
Ensemble test r2 = 0.603901
Ensemble test mse = 0.027592
Fold 1
Splitting data with seed 1
Total size = 705 | train size = 564 | val size = 141 | test size = 317
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.6764e-01, PNorm = 34.0168, GNorm = 6.4484, lr_0 = 5.5000e-04
Validation rmse = 0.311166
Validation r2 = 0.184108
Validation mse = 0.096824
Epoch 1
Loss = 6.5920e-01, PNorm = 34.0647, GNorm = 1.1527, lr_0 = 1.0000e-03
Validation rmse = 0.414860
Validation r2 = -0.450281
Validation mse = 0.172109
Epoch 2
Loss = 6.7237e-01, PNorm = 34.1176, GNorm = 5.0880, lr_0 = 9.6108e-04
Validation rmse = 0.253347
Validation r2 = 0.459144
Validation mse = 0.064185
Epoch 3
Loss = 5.0852e-01, PNorm = 34.1878, GNorm = 0.7808, lr_0 = 9.2367e-04
Validation rmse = 0.301124
Validation r2 = 0.235919
Validation mse = 0.090676
Epoch 4
Loss = 4.3975e-01, PNorm = 34.2432, GNorm = 6.0465, lr_0 = 8.9093e-04
Validation rmse = 0.225146
Validation r2 = 0.572851
Validation mse = 0.050691
Epoch 5
Loss = 3.1486e-01, PNorm = 34.2974, GNorm = 3.5672, lr_0 = 8.5625e-04
Validation rmse = 0.225383
Validation r2 = 0.571953
Validation mse = 0.050798
Epoch 6
Loss = 3.1177e-01, PNorm = 34.3488, GNorm = 2.2252, lr_0 = 8.2293e-04
Validation rmse = 0.205211
Validation r2 = 0.645145
Validation mse = 0.042112
Epoch 7
Loss = 2.5268e-01, PNorm = 34.4016, GNorm = 2.9246, lr_0 = 7.9090e-04
Loss = 2.6301e-01, PNorm = 34.4486, GNorm = 8.3775, lr_0 = 7.6286e-04
Validation rmse = 0.201087
Validation r2 = 0.659266
Validation mse = 0.040436
Epoch 8
Loss = 2.5828e-01, PNorm = 34.4909, GNorm = 4.3386, lr_0 = 7.3582e-04
Validation rmse = 0.191095
Validation r2 = 0.692286
Validation mse = 0.036517
Epoch 9
Loss = 2.0409e-01, PNorm = 34.5373, GNorm = 1.0396, lr_0 = 7.0718e-04
Validation rmse = 0.192342
Validation r2 = 0.688258
Validation mse = 0.036995
Epoch 10
Loss = 2.4145e-01, PNorm = 34.5845, GNorm = 3.5485, lr_0 = 6.7965e-04
Validation rmse = 0.175062
Validation r2 = 0.741756
Validation mse = 0.030647
Epoch 11
Loss = 1.7095e-01, PNorm = 34.6252, GNorm = 1.7264, lr_0 = 6.5556e-04
Validation rmse = 0.174800
Validation r2 = 0.742528
Validation mse = 0.030555
Epoch 12
Loss = 1.6468e-01, PNorm = 34.6630, GNorm = 6.3293, lr_0 = 6.3005e-04
Validation rmse = 0.163071
Validation r2 = 0.775921
Validation mse = 0.026592
Epoch 13
Loss = 1.3699e-01, PNorm = 34.6991, GNorm = 2.4224, lr_0 = 6.0552e-04
Validation rmse = 0.158866
Validation r2 = 0.787327
Validation mse = 0.025239
Epoch 14
Loss = 1.3642e-01, PNorm = 34.7342, GNorm = 3.0384, lr_0 = 5.8196e-04
Validation rmse = 0.162962
Validation r2 = 0.776219
Validation mse = 0.026557
Epoch 15
Loss = 8.4795e-02, PNorm = 34.7640, GNorm = 0.6842, lr_0 = 5.6133e-04
Loss = 1.3866e-01, PNorm = 34.7885, GNorm = 1.2137, lr_0 = 5.4143e-04
Loss = 1.3927e-01, PNorm = 34.7909, GNorm = 1.9827, lr_0 = 5.3948e-04
Validation rmse = 0.163319
Validation r2 = 0.775237
Validation mse = 0.026673
Epoch 16
Loss = 1.2176e-01, PNorm = 34.8163, GNorm = 3.3072, lr_0 = 5.2036e-04
Validation rmse = 0.155677
Validation r2 = 0.795779
Validation mse = 0.024235
Epoch 17
Loss = 1.3797e-01, PNorm = 34.8408, GNorm = 3.0592, lr_0 = 5.0010e-04
Validation rmse = 0.159716
Validation r2 = 0.785046
Validation mse = 0.025509
Epoch 18
Loss = 1.2146e-01, PNorm = 34.8628, GNorm = 1.6507, lr_0 = 4.8238e-04
Validation rmse = 0.177514
Validation r2 = 0.734469
Validation mse = 0.031511
Epoch 19
Loss = 1.4824e-01, PNorm = 34.8805, GNorm = 3.0072, lr_0 = 4.6360e-04
Validation rmse = 0.158517
Validation r2 = 0.788261
Validation mse = 0.025128
Epoch 20
Loss = 1.1494e-01, PNorm = 34.9005, GNorm = 2.9109, lr_0 = 4.4556e-04
Validation rmse = 0.157001
Validation r2 = 0.792292
Validation mse = 0.024649
Epoch 21
Loss = 1.1849e-01, PNorm = 34.9181, GNorm = 0.4927, lr_0 = 4.2821e-04
Validation rmse = 0.157436
Validation r2 = 0.791139
Validation mse = 0.024786
Epoch 22
Loss = 1.0888e-01, PNorm = 34.9333, GNorm = 1.4037, lr_0 = 4.1304e-04
Validation rmse = 0.152885
Validation r2 = 0.803040
Validation mse = 0.023374
Epoch 23
Loss = 1.1943e-01, PNorm = 34.9456, GNorm = 2.1981, lr_0 = 3.9696e-04
Loss = 1.1619e-01, PNorm = 34.9623, GNorm = 1.0040, lr_0 = 3.8289e-04
Loss = 9.1016e-02, PNorm = 34.9639, GNorm = 3.0198, lr_0 = 3.8151e-04
Validation rmse = 0.163912
Validation r2 = 0.773603
Validation mse = 0.026867
Epoch 24
Loss = 1.0409e-01, PNorm = 34.9755, GNorm = 0.9976, lr_0 = 3.6799e-04
Validation rmse = 0.148860
Validation r2 = 0.813274
Validation mse = 0.022159
Epoch 25
Loss = 1.0747e-01, PNorm = 34.9921, GNorm = 0.9251, lr_0 = 3.5494e-04
Validation rmse = 0.153820
Validation r2 = 0.800624
Validation mse = 0.023660
Epoch 26
Loss = 9.3730e-02, PNorm = 35.0048, GNorm = 1.7879, lr_0 = 3.4113e-04
Validation rmse = 0.149264
Validation r2 = 0.812258
Validation mse = 0.022280
Epoch 27
Loss = 8.4734e-02, PNorm = 35.0157, GNorm = 1.2610, lr_0 = 3.2785e-04
Validation rmse = 0.152642
Validation r2 = 0.803664
Validation mse = 0.023300
Epoch 28
Loss = 1.0181e-01, PNorm = 35.0290, GNorm = 0.7351, lr_0 = 3.1509e-04
Validation rmse = 0.148295
Validation r2 = 0.814688
Validation mse = 0.021991
Epoch 29
Loss = 8.6945e-02, PNorm = 35.0406, GNorm = 1.8317, lr_0 = 3.0392e-04
Validation rmse = 0.152744
Validation r2 = 0.803403
Validation mse = 0.023331
Epoch 30
Loss = 8.6282e-02, PNorm = 35.0507, GNorm = 1.2207, lr_0 = 2.9209e-04
Validation rmse = 0.150433
Validation r2 = 0.809307
Validation mse = 0.022630
Epoch 31
Loss = 9.8797e-02, PNorm = 35.0627, GNorm = 1.9677, lr_0 = 2.8072e-04
Loss = 9.9549e-02, PNorm = 35.0712, GNorm = 3.8095, lr_0 = 2.7077e-04
Loss = 1.4343e-01, PNorm = 35.0732, GNorm = 5.9014, lr_0 = 2.6980e-04
Validation rmse = 0.148318
Validation r2 = 0.814632
Validation mse = 0.021998
Epoch 32
Loss = 1.1305e-01, PNorm = 35.0828, GNorm = 4.4971, lr_0 = 2.6023e-04
Validation rmse = 0.150846
Validation r2 = 0.808257
Validation mse = 0.022755
Epoch 33
Loss = 9.9189e-02, PNorm = 35.0925, GNorm = 1.5558, lr_0 = 2.5101e-04
Validation rmse = 0.146813
Validation r2 = 0.818374
Validation mse = 0.021554
Epoch 34
Loss = 9.8104e-02, PNorm = 35.1019, GNorm = 1.9034, lr_0 = 2.4124e-04
Validation rmse = 0.146808
Validation r2 = 0.818387
Validation mse = 0.021553
Epoch 35
Loss = 9.1673e-02, PNorm = 35.1100, GNorm = 0.9231, lr_0 = 2.3185e-04
Validation rmse = 0.146722
Validation r2 = 0.818600
Validation mse = 0.021527
Epoch 36
Loss = 6.9170e-02, PNorm = 35.1180, GNorm = 0.7097, lr_0 = 2.2363e-04
Validation rmse = 0.146549
Validation r2 = 0.819027
Validation mse = 0.021477
Epoch 37
Loss = 9.8303e-02, PNorm = 35.1263, GNorm = 0.6613, lr_0 = 2.1493e-04
Validation rmse = 0.146581
Validation r2 = 0.818948
Validation mse = 0.021486
Epoch 38
Loss = 1.2185e-01, PNorm = 35.1344, GNorm = 2.3331, lr_0 = 2.0656e-04
Validation rmse = 0.144950
Validation r2 = 0.822953
Validation mse = 0.021011
Epoch 39
Loss = 5.9052e-02, PNorm = 35.1417, GNorm = 0.6023, lr_0 = 1.9852e-04
Loss = 9.0011e-02, PNorm = 35.1484, GNorm = 2.1445, lr_0 = 1.9148e-04
Validation rmse = 0.146187
Validation r2 = 0.819920
Validation mse = 0.021371
Epoch 40
Loss = 8.8464e-02, PNorm = 35.1548, GNorm = 0.9178, lr_0 = 1.8470e-04
Validation rmse = 0.146161
Validation r2 = 0.819984
Validation mse = 0.021363
Epoch 41
Loss = 8.6896e-02, PNorm = 35.1621, GNorm = 1.8346, lr_0 = 1.7751e-04
Validation rmse = 0.145229
Validation r2 = 0.822272
Validation mse = 0.021091
Epoch 42
Loss = 7.6183e-02, PNorm = 35.1675, GNorm = 0.7533, lr_0 = 1.7060e-04
Validation rmse = 0.145932
Validation r2 = 0.820548
Validation mse = 0.021296
Epoch 43
Loss = 9.1956e-02, PNorm = 35.1731, GNorm = 2.1180, lr_0 = 1.6455e-04
Validation rmse = 0.145964
Validation r2 = 0.820468
Validation mse = 0.021306
Epoch 44
Loss = 7.4362e-02, PNorm = 35.1786, GNorm = 1.0775, lr_0 = 1.5815e-04
Validation rmse = 0.144857
Validation r2 = 0.823181
Validation mse = 0.020984
Epoch 45
Loss = 6.4240e-02, PNorm = 35.1854, GNorm = 0.5918, lr_0 = 1.5199e-04
Validation rmse = 0.145192
Validation r2 = 0.822362
Validation mse = 0.021081
Epoch 46
Loss = 7.3340e-02, PNorm = 35.1901, GNorm = 0.3839, lr_0 = 1.4608e-04
Loss = 9.0903e-02, PNorm = 35.1952, GNorm = 1.7955, lr_0 = 1.4090e-04
Validation rmse = 0.147237
Validation r2 = 0.817322
Validation mse = 0.021679
Epoch 47
Loss = 7.9532e-02, PNorm = 35.2010, GNorm = 2.0744, lr_0 = 1.3590e-04
Validation rmse = 0.144699
Validation r2 = 0.823568
Validation mse = 0.020938
Epoch 48
Loss = 7.7082e-02, PNorm = 35.2050, GNorm = 0.9905, lr_0 = 1.3061e-04
Validation rmse = 0.145899
Validation r2 = 0.820628
Validation mse = 0.021287
Epoch 49
Loss = 7.8495e-02, PNorm = 35.2104, GNorm = 1.1516, lr_0 = 1.2553e-04
Validation rmse = 0.144471
Validation r2 = 0.824123
Validation mse = 0.020872
Epoch 50
Loss = 8.0829e-02, PNorm = 35.2136, GNorm = 1.3542, lr_0 = 1.2108e-04
Validation rmse = 0.143649
Validation r2 = 0.826118
Validation mse = 0.020635
Epoch 51
Loss = 8.3411e-02, PNorm = 35.2180, GNorm = 1.9493, lr_0 = 1.1637e-04
Validation rmse = 0.146134
Validation r2 = 0.820051
Validation mse = 0.021355
Epoch 52
Loss = 6.3862e-02, PNorm = 35.2226, GNorm = 0.6604, lr_0 = 1.1184e-04
Validation rmse = 0.143705
Validation r2 = 0.825983
Validation mse = 0.020651
Epoch 53
Loss = 6.9852e-02, PNorm = 35.2273, GNorm = 1.8698, lr_0 = 1.0749e-04
Validation rmse = 0.145219
Validation r2 = 0.822296
Validation mse = 0.021089
Epoch 54
Loss = 7.8906e-02, PNorm = 35.2314, GNorm = 0.5292, lr_0 = 1.0367e-04
Loss = 7.6494e-02, PNorm = 35.2341, GNorm = 1.3057, lr_0 = 1.0000e-04
Loss = 1.2622e-01, PNorm = 35.2346, GNorm = 1.4036, lr_0 = 1.0000e-04
Validation rmse = 0.142795
Validation r2 = 0.828180
Validation mse = 0.020390
Epoch 55
Loss = 7.5269e-02, PNorm = 35.2388, GNorm = 1.0975, lr_0 = 1.0000e-04
Validation rmse = 0.144340
Validation r2 = 0.824441
Validation mse = 0.020834
Epoch 56
Loss = 7.5040e-02, PNorm = 35.2430, GNorm = 1.0556, lr_0 = 1.0000e-04
Validation rmse = 0.142990
Validation r2 = 0.827710
Validation mse = 0.020446
Epoch 57
Loss = 7.4576e-02, PNorm = 35.2465, GNorm = 0.5893, lr_0 = 1.0000e-04
Validation rmse = 0.142883
Validation r2 = 0.827968
Validation mse = 0.020416
Epoch 58
Loss = 7.5211e-02, PNorm = 35.2498, GNorm = 1.0309, lr_0 = 1.0000e-04
Validation rmse = 0.144279
Validation r2 = 0.824589
Validation mse = 0.020817
Epoch 59
Loss = 7.3183e-02, PNorm = 35.2533, GNorm = 0.8877, lr_0 = 1.0000e-04
Validation rmse = 0.143773
Validation r2 = 0.825818
Validation mse = 0.020671
Model 0 best validation rmse = 0.142795 on epoch 54
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.180713
Model 0 test r2 = 0.531193
Model 0 test mse = 0.032657
Ensemble test rmse = 0.180713
Ensemble test r2 = 0.531193
Ensemble test mse = 0.032657
Fold 2
Splitting data with seed 2
Total size = 705 | train size = 564 | val size = 141 | test size = 317
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.0333e-01, PNorm = 34.0219, GNorm = 2.5397, lr_0 = 5.5000e-04
Validation rmse = 0.305150
Validation r2 = 0.301225
Validation mse = 0.093117
Epoch 1
Loss = 8.2578e-01, PNorm = 34.0706, GNorm = 15.0500, lr_0 = 1.0000e-03
Validation rmse = 0.295493
Validation r2 = 0.344756
Validation mse = 0.087316
Epoch 2
Loss = 5.5269e-01, PNorm = 34.1281, GNorm = 5.2088, lr_0 = 9.6108e-04
Validation rmse = 0.259354
Validation r2 = 0.495227
Validation mse = 0.067265
Epoch 3
Loss = 4.2429e-01, PNorm = 34.2062, GNorm = 1.7343, lr_0 = 9.2367e-04
Validation rmse = 0.230592
Validation r2 = 0.600977
Validation mse = 0.053173
Epoch 4
Loss = 4.1207e-01, PNorm = 34.2648, GNorm = 4.8907, lr_0 = 8.9093e-04
Validation rmse = 0.216070
Validation r2 = 0.649654
Validation mse = 0.046686
Epoch 5
Loss = 3.2262e-01, PNorm = 34.3211, GNorm = 1.5639, lr_0 = 8.5625e-04
Validation rmse = 0.205577
Validation r2 = 0.682856
Validation mse = 0.042262
Epoch 6
Loss = 2.5308e-01, PNorm = 34.3761, GNorm = 2.1563, lr_0 = 8.2293e-04
Validation rmse = 0.193439
Validation r2 = 0.719201
Validation mse = 0.037418
Epoch 7
Loss = 1.9793e-01, PNorm = 34.4265, GNorm = 4.4107, lr_0 = 7.9090e-04
Loss = 2.3678e-01, PNorm = 34.4705, GNorm = 4.5005, lr_0 = 7.6286e-04
Validation rmse = 0.182372
Validation r2 = 0.750411
Validation mse = 0.033260
Epoch 8
Loss = 2.0226e-01, PNorm = 34.5093, GNorm = 1.4250, lr_0 = 7.3582e-04
Validation rmse = 0.183053
Validation r2 = 0.748544
Validation mse = 0.033508
Epoch 9
Loss = 1.8916e-01, PNorm = 34.5448, GNorm = 3.6888, lr_0 = 7.0718e-04
Validation rmse = 0.165690
Validation r2 = 0.793984
Validation mse = 0.027453
Epoch 10
Loss = 1.9279e-01, PNorm = 34.5853, GNorm = 5.1039, lr_0 = 6.7965e-04
Validation rmse = 0.167525
Validation r2 = 0.789394
Validation mse = 0.028065
Epoch 11
Loss = 1.6378e-01, PNorm = 34.6144, GNorm = 1.7530, lr_0 = 6.5556e-04
Validation rmse = 0.158436
Validation r2 = 0.811628
Validation mse = 0.025102
Epoch 12
Loss = 1.4895e-01, PNorm = 34.6440, GNorm = 3.6514, lr_0 = 6.3005e-04
Validation rmse = 0.156985
Validation r2 = 0.815063
Validation mse = 0.024644
Epoch 13
Loss = 1.5561e-01, PNorm = 34.6779, GNorm = 2.1906, lr_0 = 6.0552e-04
Validation rmse = 0.153113
Validation r2 = 0.824073
Validation mse = 0.023444
Epoch 14
Loss = 1.2517e-01, PNorm = 34.7049, GNorm = 1.1901, lr_0 = 5.8196e-04
Validation rmse = 0.160530
Validation r2 = 0.806617
Validation mse = 0.025770
Epoch 15
Loss = 8.4357e-02, PNorm = 34.7278, GNorm = 2.2142, lr_0 = 5.6133e-04
Loss = 1.4248e-01, PNorm = 34.7477, GNorm = 0.6151, lr_0 = 5.4143e-04
Loss = 1.1723e-01, PNorm = 34.7501, GNorm = 3.4988, lr_0 = 5.3948e-04
Validation rmse = 0.160010
Validation r2 = 0.807866
Validation mse = 0.025603
Epoch 16
Loss = 1.2631e-01, PNorm = 34.7722, GNorm = 2.1058, lr_0 = 5.2036e-04
Validation rmse = 0.151555
Validation r2 = 0.827636
Validation mse = 0.022969
Epoch 17
Loss = 1.2304e-01, PNorm = 34.7924, GNorm = 1.4153, lr_0 = 5.0010e-04
Validation rmse = 0.170076
Validation r2 = 0.782933
Validation mse = 0.028926
Epoch 18
Loss = 1.4390e-01, PNorm = 34.8099, GNorm = 0.9929, lr_0 = 4.8238e-04
Validation rmse = 0.162208
Validation r2 = 0.802553
Validation mse = 0.026311
Epoch 19
Loss = 1.2396e-01, PNorm = 34.8271, GNorm = 4.0425, lr_0 = 4.6360e-04
Validation rmse = 0.148935
Validation r2 = 0.833542
Validation mse = 0.022182
Epoch 20
Loss = 1.0757e-01, PNorm = 34.8456, GNorm = 3.0432, lr_0 = 4.4556e-04
Validation rmse = 0.193417
Validation r2 = 0.719263
Validation mse = 0.037410
Epoch 21
Loss = 1.5027e-01, PNorm = 34.8663, GNorm = 5.6041, lr_0 = 4.2821e-04
Validation rmse = 0.150674
Validation r2 = 0.829634
Validation mse = 0.022703
Epoch 22
Loss = 1.2517e-01, PNorm = 34.8818, GNorm = 2.8514, lr_0 = 4.1304e-04
Validation rmse = 0.147405
Validation r2 = 0.836946
Validation mse = 0.021728
Epoch 23
Loss = 1.2448e-01, PNorm = 34.8951, GNorm = 2.1371, lr_0 = 3.9696e-04
Loss = 1.0530e-01, PNorm = 34.9084, GNorm = 2.7185, lr_0 = 3.8289e-04
Loss = 8.4299e-02, PNorm = 34.9094, GNorm = 0.8913, lr_0 = 3.8151e-04
Validation rmse = 0.144160
Validation r2 = 0.844045
Validation mse = 0.020782
Epoch 24
Loss = 1.0421e-01, PNorm = 34.9190, GNorm = 0.8894, lr_0 = 3.6799e-04
Validation rmse = 0.140682
Validation r2 = 0.851479
Validation mse = 0.019791
Epoch 25
Loss = 1.2417e-01, PNorm = 34.9299, GNorm = 2.1574, lr_0 = 3.5494e-04
Validation rmse = 0.141849
Validation r2 = 0.849005
Validation mse = 0.020121
Epoch 26
Loss = 1.1525e-01, PNorm = 34.9398, GNorm = 3.7386, lr_0 = 3.4113e-04
Validation rmse = 0.168973
Validation r2 = 0.785738
Validation mse = 0.028552
Epoch 27
Loss = 1.1119e-01, PNorm = 34.9502, GNorm = 3.8002, lr_0 = 3.2785e-04
Validation rmse = 0.144877
Validation r2 = 0.842490
Validation mse = 0.020989
Epoch 28
Loss = 1.0423e-01, PNorm = 34.9600, GNorm = 2.7943, lr_0 = 3.1509e-04
Validation rmse = 0.139893
Validation r2 = 0.853140
Validation mse = 0.019570
Epoch 29
Loss = 1.1871e-01, PNorm = 34.9689, GNorm = 4.3672, lr_0 = 3.0392e-04
Validation rmse = 0.150758
Validation r2 = 0.829442
Validation mse = 0.022728
Epoch 30
Loss = 1.0189e-01, PNorm = 34.9820, GNorm = 2.1376, lr_0 = 2.9209e-04
Validation rmse = 0.138836
Validation r2 = 0.855351
Validation mse = 0.019276
Epoch 31
Loss = 6.7185e-02, PNorm = 34.9926, GNorm = 0.7784, lr_0 = 2.8072e-04
Loss = 1.0235e-01, PNorm = 34.9998, GNorm = 2.8082, lr_0 = 2.7077e-04
Loss = 1.2854e-01, PNorm = 35.0002, GNorm = 4.7677, lr_0 = 2.6980e-04
Validation rmse = 0.140966
Validation r2 = 0.850880
Validation mse = 0.019871
Epoch 32
Loss = 1.1227e-01, PNorm = 35.0082, GNorm = 2.0819, lr_0 = 2.6023e-04
Validation rmse = 0.144241
Validation r2 = 0.843870
Validation mse = 0.020805
Epoch 33
Loss = 8.9939e-02, PNorm = 35.0143, GNorm = 1.1191, lr_0 = 2.5101e-04
Validation rmse = 0.160898
Validation r2 = 0.805729
Validation mse = 0.025888
Epoch 34
Loss = 1.1051e-01, PNorm = 35.0229, GNorm = 0.6070, lr_0 = 2.4124e-04
Validation rmse = 0.140190
Validation r2 = 0.852517
Validation mse = 0.019653
Epoch 35
Loss = 9.3093e-02, PNorm = 35.0304, GNorm = 2.2750, lr_0 = 2.3185e-04
Validation rmse = 0.137956
Validation r2 = 0.857180
Validation mse = 0.019032
Epoch 36
Loss = 9.2865e-02, PNorm = 35.0371, GNorm = 0.9461, lr_0 = 2.2363e-04
Validation rmse = 0.140412
Validation r2 = 0.852049
Validation mse = 0.019715
Epoch 37
Loss = 9.8377e-02, PNorm = 35.0422, GNorm = 0.8923, lr_0 = 2.1493e-04
Validation rmse = 0.146643
Validation r2 = 0.838627
Validation mse = 0.021504
Epoch 38
Loss = 8.3637e-02, PNorm = 35.0481, GNorm = 1.5984, lr_0 = 2.0656e-04
Validation rmse = 0.150575
Validation r2 = 0.829857
Validation mse = 0.022673
Epoch 39
Loss = 1.1837e-01, PNorm = 35.0538, GNorm = 3.2338, lr_0 = 1.9852e-04
Loss = 1.0054e-01, PNorm = 35.0591, GNorm = 1.8282, lr_0 = 1.9148e-04
Validation rmse = 0.139898
Validation r2 = 0.853130
Validation mse = 0.019571
Epoch 40
Loss = 8.8804e-02, PNorm = 35.0656, GNorm = 0.3956, lr_0 = 1.8470e-04
Validation rmse = 0.144868
Validation r2 = 0.842510
Validation mse = 0.020987
Epoch 41
Loss = 9.5966e-02, PNorm = 35.0728, GNorm = 1.6070, lr_0 = 1.7751e-04
Validation rmse = 0.141674
Validation r2 = 0.849377
Validation mse = 0.020072
Epoch 42
Loss = 9.0005e-02, PNorm = 35.0779, GNorm = 1.4415, lr_0 = 1.7060e-04
Validation rmse = 0.155643
Validation r2 = 0.818210
Validation mse = 0.024225
Epoch 43
Loss = 1.0242e-01, PNorm = 35.0835, GNorm = 1.2953, lr_0 = 1.6455e-04
Validation rmse = 0.149546
Validation r2 = 0.832175
Validation mse = 0.022364
Epoch 44
Loss = 9.4994e-02, PNorm = 35.0888, GNorm = 1.0333, lr_0 = 1.5815e-04
Validation rmse = 0.140847
Validation r2 = 0.851131
Validation mse = 0.019838
Epoch 45
Loss = 8.5596e-02, PNorm = 35.0930, GNorm = 0.6260, lr_0 = 1.5199e-04
Validation rmse = 0.137800
Validation r2 = 0.857503
Validation mse = 0.018989
Epoch 46
Loss = 8.7577e-02, PNorm = 35.0968, GNorm = 1.5085, lr_0 = 1.4608e-04
Loss = 8.3233e-02, PNorm = 35.1002, GNorm = 1.2043, lr_0 = 1.4090e-04
Validation rmse = 0.143567
Validation r2 = 0.845327
Validation mse = 0.020611
Epoch 47
Loss = 8.6617e-02, PNorm = 35.1055, GNorm = 0.8744, lr_0 = 1.3590e-04
Validation rmse = 0.138965
Validation r2 = 0.855083
Validation mse = 0.019311
Epoch 48
Loss = 8.8663e-02, PNorm = 35.1095, GNorm = 0.5893, lr_0 = 1.3061e-04
Validation rmse = 0.136814
Validation r2 = 0.859534
Validation mse = 0.018718
Epoch 49
Loss = 7.9041e-02, PNorm = 35.1135, GNorm = 1.2730, lr_0 = 1.2553e-04
Validation rmse = 0.137202
Validation r2 = 0.858736
Validation mse = 0.018825
Epoch 50
Loss = 7.2940e-02, PNorm = 35.1178, GNorm = 1.4747, lr_0 = 1.2108e-04
Validation rmse = 0.136511
Validation r2 = 0.860156
Validation mse = 0.018635
Epoch 51
Loss = 9.1027e-02, PNorm = 35.1221, GNorm = 1.1494, lr_0 = 1.1637e-04
Validation rmse = 0.137588
Validation r2 = 0.857940
Validation mse = 0.018931
Epoch 52
Loss = 8.3774e-02, PNorm = 35.1259, GNorm = 2.6109, lr_0 = 1.1184e-04
Validation rmse = 0.142283
Validation r2 = 0.848079
Validation mse = 0.020245
Epoch 53
Loss = 9.8450e-02, PNorm = 35.1290, GNorm = 1.9830, lr_0 = 1.0749e-04
Validation rmse = 0.141107
Validation r2 = 0.850580
Validation mse = 0.019911
Epoch 54
Loss = 1.0396e-01, PNorm = 35.1318, GNorm = 3.2474, lr_0 = 1.0367e-04
Loss = 8.2746e-02, PNorm = 35.1348, GNorm = 1.4053, lr_0 = 1.0000e-04
Loss = 7.1452e-02, PNorm = 35.1351, GNorm = 1.6307, lr_0 = 1.0000e-04
Validation rmse = 0.138662
Validation r2 = 0.855714
Validation mse = 0.019227
Epoch 55
Loss = 8.1381e-02, PNorm = 35.1386, GNorm = 1.1689, lr_0 = 1.0000e-04
Validation rmse = 0.136673
Validation r2 = 0.859823
Validation mse = 0.018680
Epoch 56
Loss = 8.2502e-02, PNorm = 35.1415, GNorm = 0.8167, lr_0 = 1.0000e-04
Validation rmse = 0.137189
Validation r2 = 0.858764
Validation mse = 0.018821
Epoch 57
Loss = 8.2001e-02, PNorm = 35.1443, GNorm = 2.1061, lr_0 = 1.0000e-04
Validation rmse = 0.139593
Validation r2 = 0.853769
Validation mse = 0.019486
Epoch 58
Loss = 7.6373e-02, PNorm = 35.1478, GNorm = 1.1311, lr_0 = 1.0000e-04
Validation rmse = 0.141902
Validation r2 = 0.848892
Validation mse = 0.020136
Epoch 59
Loss = 7.7688e-02, PNorm = 35.1508, GNorm = 1.1091, lr_0 = 1.0000e-04
Validation rmse = 0.140394
Validation r2 = 0.852086
Validation mse = 0.019711
Model 0 best validation rmse = 0.136511 on epoch 50
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.167278
Model 0 test r2 = 0.598308
Model 0 test mse = 0.027982
Ensemble test rmse = 0.167278
Ensemble test r2 = 0.598308
Ensemble test mse = 0.027982
Fold 3
Splitting data with seed 3
Total size = 705 | train size = 564 | val size = 141 | test size = 317
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.0333e-01, PNorm = 34.0189, GNorm = 4.7381, lr_0 = 5.5000e-04
Validation rmse = 0.341752
Validation r2 = 0.068754
Validation mse = 0.116794
Epoch 1
Loss = 6.7384e-01, PNorm = 34.0649, GNorm = 2.1257, lr_0 = 1.0000e-03
Validation rmse = 0.270207
Validation r2 = 0.417851
Validation mse = 0.073012
Epoch 2
Loss = 4.6577e-01, PNorm = 34.1433, GNorm = 1.0766, lr_0 = 9.6108e-04
Validation rmse = 0.239022
Validation r2 = 0.544467
Validation mse = 0.057132
Epoch 3
Loss = 4.6860e-01, PNorm = 34.2098, GNorm = 5.4972, lr_0 = 9.2367e-04
Validation rmse = 0.252528
Validation r2 = 0.491534
Validation mse = 0.063770
Epoch 4
Loss = 4.3320e-01, PNorm = 34.2576, GNorm = 5.3978, lr_0 = 8.9093e-04
Validation rmse = 0.200933
Validation r2 = 0.678082
Validation mse = 0.040374
Epoch 5
Loss = 3.6130e-01, PNorm = 34.3122, GNorm = 4.1954, lr_0 = 8.5625e-04
Validation rmse = 0.184937
Validation r2 = 0.727296
Validation mse = 0.034202
Epoch 6
Loss = 3.0863e-01, PNorm = 34.3650, GNorm = 4.4163, lr_0 = 8.2293e-04
Validation rmse = 0.185687
Validation r2 = 0.725081
Validation mse = 0.034480
Epoch 7
Loss = 3.1029e-01, PNorm = 34.4141, GNorm = 0.4995, lr_0 = 7.9090e-04
Loss = 2.3703e-01, PNorm = 34.4622, GNorm = 1.9879, lr_0 = 7.6286e-04
Validation rmse = 0.175061
Validation r2 = 0.755644
Validation mse = 0.030646
Epoch 8
Loss = 2.2029e-01, PNorm = 34.5055, GNorm = 2.2663, lr_0 = 7.3582e-04
Validation rmse = 0.164926
Validation r2 = 0.783120
Validation mse = 0.027201
Epoch 9
Loss = 2.2579e-01, PNorm = 34.5542, GNorm = 6.1970, lr_0 = 7.0718e-04
Validation rmse = 0.159093
Validation r2 = 0.798190
Validation mse = 0.025310
Epoch 10
Loss = 2.0749e-01, PNorm = 34.5903, GNorm = 5.1832, lr_0 = 6.7965e-04
Validation rmse = 0.147720
Validation r2 = 0.826010
Validation mse = 0.021821
Epoch 11
Loss = 1.8252e-01, PNorm = 34.6293, GNorm = 2.6371, lr_0 = 6.5556e-04
Validation rmse = 0.142002
Validation r2 = 0.839221
Validation mse = 0.020164
Epoch 12
Loss = 1.5622e-01, PNorm = 34.6648, GNorm = 0.8313, lr_0 = 6.3005e-04
Validation rmse = 0.139283
Validation r2 = 0.845318
Validation mse = 0.019400
Epoch 13
Loss = 1.6568e-01, PNorm = 34.6978, GNorm = 1.8024, lr_0 = 6.0552e-04
Validation rmse = 0.146476
Validation r2 = 0.828929
Validation mse = 0.021455
Epoch 14
Loss = 1.8499e-01, PNorm = 34.7306, GNorm = 0.8028, lr_0 = 5.8196e-04
Validation rmse = 0.137217
Validation r2 = 0.849873
Validation mse = 0.018829
Epoch 15
Loss = 1.5858e-01, PNorm = 34.7558, GNorm = 2.7443, lr_0 = 5.6133e-04
Loss = 1.4416e-01, PNorm = 34.7810, GNorm = 1.9345, lr_0 = 5.4143e-04
Loss = 5.4961e-02, PNorm = 34.7835, GNorm = 1.9185, lr_0 = 5.3948e-04
Validation rmse = 0.136861
Validation r2 = 0.850652
Validation mse = 0.018731
Epoch 16
Loss = 1.4365e-01, PNorm = 34.8050, GNorm = 2.5087, lr_0 = 5.2036e-04
Validation rmse = 0.138352
Validation r2 = 0.847379
Validation mse = 0.019141
Epoch 17
Loss = 1.3603e-01, PNorm = 34.8237, GNorm = 1.4285, lr_0 = 5.0010e-04
Validation rmse = 0.134956
Validation r2 = 0.854781
Validation mse = 0.018213
Epoch 18
Loss = 1.4790e-01, PNorm = 34.8455, GNorm = 1.6940, lr_0 = 4.8238e-04
Validation rmse = 0.128889
Validation r2 = 0.867544
Validation mse = 0.016612
Epoch 19
Loss = 1.3672e-01, PNorm = 34.8656, GNorm = 2.5871, lr_0 = 4.6360e-04
Validation rmse = 0.126671
Validation r2 = 0.872062
Validation mse = 0.016046
Epoch 20
Loss = 1.1485e-01, PNorm = 34.8831, GNorm = 1.7583, lr_0 = 4.4556e-04
Validation rmse = 0.124352
Validation r2 = 0.876705
Validation mse = 0.015463
Epoch 21
Loss = 1.3172e-01, PNorm = 34.8988, GNorm = 2.2122, lr_0 = 4.2821e-04
Validation rmse = 0.122243
Validation r2 = 0.880852
Validation mse = 0.014943
Epoch 22
Loss = 1.0840e-01, PNorm = 34.9141, GNorm = 0.6281, lr_0 = 4.1304e-04
Validation rmse = 0.122134
Validation r2 = 0.881063
Validation mse = 0.014917
Epoch 23
Loss = 1.2673e-01, PNorm = 34.9294, GNorm = 1.1475, lr_0 = 3.9696e-04
Loss = 1.1389e-01, PNorm = 34.9446, GNorm = 3.7018, lr_0 = 3.8289e-04
Loss = 8.3344e-02, PNorm = 34.9462, GNorm = 1.0467, lr_0 = 3.8151e-04
Validation rmse = 0.123981
Validation r2 = 0.877440
Validation mse = 0.015371
Epoch 24
Loss = 1.1083e-01, PNorm = 34.9578, GNorm = 0.8388, lr_0 = 3.6799e-04
Validation rmse = 0.122285
Validation r2 = 0.880770
Validation mse = 0.014954
Epoch 25
Loss = 1.2828e-01, PNorm = 34.9726, GNorm = 2.9305, lr_0 = 3.5494e-04
Validation rmse = 0.126230
Validation r2 = 0.872952
Validation mse = 0.015934
Epoch 26
Loss = 1.1119e-01, PNorm = 34.9893, GNorm = 2.6159, lr_0 = 3.4113e-04
Validation rmse = 0.123527
Validation r2 = 0.878335
Validation mse = 0.015259
Epoch 27
Loss = 1.1089e-01, PNorm = 35.0030, GNorm = 1.1791, lr_0 = 3.2785e-04
Validation rmse = 0.124013
Validation r2 = 0.877375
Validation mse = 0.015379
Epoch 28
Loss = 1.1749e-01, PNorm = 35.0145, GNorm = 1.6268, lr_0 = 3.1509e-04
Validation rmse = 0.123877
Validation r2 = 0.877644
Validation mse = 0.015346
Epoch 29
Loss = 1.1906e-01, PNorm = 35.0221, GNorm = 0.9672, lr_0 = 3.0392e-04
Validation rmse = 0.119580
Validation r2 = 0.885986
Validation mse = 0.014299
Epoch 30
Loss = 8.8727e-02, PNorm = 35.0325, GNorm = 1.3492, lr_0 = 2.9209e-04
Validation rmse = 0.119063
Validation r2 = 0.886970
Validation mse = 0.014176
Epoch 31
Loss = 9.1958e-02, PNorm = 35.0433, GNorm = 1.2036, lr_0 = 2.8072e-04
Loss = 1.0265e-01, PNorm = 35.0525, GNorm = 0.4988, lr_0 = 2.7077e-04
Loss = 9.0676e-02, PNorm = 35.0536, GNorm = 1.2611, lr_0 = 2.6980e-04
Validation rmse = 0.122718
Validation r2 = 0.879923
Validation mse = 0.015060
Epoch 32
Loss = 1.0537e-01, PNorm = 35.0630, GNorm = 3.6624, lr_0 = 2.6023e-04
Validation rmse = 0.117970
Validation r2 = 0.889035
Validation mse = 0.013917
Epoch 33
Loss = 1.0922e-01, PNorm = 35.0708, GNorm = 2.4439, lr_0 = 2.5101e-04
Validation rmse = 0.119491
Validation r2 = 0.886155
Validation mse = 0.014278
Epoch 34
Loss = 8.8038e-02, PNorm = 35.0790, GNorm = 2.0125, lr_0 = 2.4124e-04
Validation rmse = 0.132292
Validation r2 = 0.860457
Validation mse = 0.017501
Epoch 35
Loss = 9.8868e-02, PNorm = 35.0870, GNorm = 1.4775, lr_0 = 2.3185e-04
Validation rmse = 0.119497
Validation r2 = 0.886144
Validation mse = 0.014279
Epoch 36
Loss = 8.3775e-02, PNorm = 35.0950, GNorm = 0.6038, lr_0 = 2.2363e-04
Validation rmse = 0.118846
Validation r2 = 0.887381
Validation mse = 0.014124
Epoch 37
Loss = 7.8444e-02, PNorm = 35.1040, GNorm = 0.9743, lr_0 = 2.1493e-04
Validation rmse = 0.120200
Validation r2 = 0.884800
Validation mse = 0.014448
Epoch 38
Loss = 7.4632e-02, PNorm = 35.1111, GNorm = 0.9718, lr_0 = 2.0656e-04
Validation rmse = 0.119510
Validation r2 = 0.886119
Validation mse = 0.014283
Epoch 39
Loss = 9.3116e-02, PNorm = 35.1187, GNorm = 0.8749, lr_0 = 1.9852e-04
Loss = 9.6507e-02, PNorm = 35.1238, GNorm = 0.9411, lr_0 = 1.9148e-04
Validation rmse = 0.117998
Validation r2 = 0.888982
Validation mse = 0.013924
Epoch 40
Loss = 9.1863e-02, PNorm = 35.1297, GNorm = 0.5736, lr_0 = 1.8470e-04
Validation rmse = 0.119729
Validation r2 = 0.885702
Validation mse = 0.014335
Epoch 41
Loss = 9.8353e-02, PNorm = 35.1360, GNorm = 1.3086, lr_0 = 1.7751e-04
Validation rmse = 0.127746
Validation r2 = 0.869883
Validation mse = 0.016319
Epoch 42
Loss = 9.0520e-02, PNorm = 35.1417, GNorm = 2.5337, lr_0 = 1.7060e-04
Validation rmse = 0.123951
Validation r2 = 0.877498
Validation mse = 0.015364
Epoch 43
Loss = 1.0304e-01, PNorm = 35.1464, GNorm = 0.9344, lr_0 = 1.6455e-04
Validation rmse = 0.119589
Validation r2 = 0.885968
Validation mse = 0.014302
Epoch 44
Loss = 8.9769e-02, PNorm = 35.1518, GNorm = 1.0073, lr_0 = 1.5815e-04
Validation rmse = 0.119432
Validation r2 = 0.886267
Validation mse = 0.014264
Epoch 45
Loss = 9.0156e-02, PNorm = 35.1571, GNorm = 0.8337, lr_0 = 1.5199e-04
Validation rmse = 0.117082
Validation r2 = 0.890700
Validation mse = 0.013708
Epoch 46
Loss = 1.2283e-01, PNorm = 35.1631, GNorm = 2.8010, lr_0 = 1.4608e-04
Loss = 8.3746e-02, PNorm = 35.1679, GNorm = 1.7161, lr_0 = 1.4090e-04
Validation rmse = 0.119505
Validation r2 = 0.886128
Validation mse = 0.014282
Epoch 47
Loss = 9.3004e-02, PNorm = 35.1724, GNorm = 0.8502, lr_0 = 1.3590e-04
Validation rmse = 0.121393
Validation r2 = 0.882503
Validation mse = 0.014736
Epoch 48
Loss = 8.9094e-02, PNorm = 35.1763, GNorm = 3.2162, lr_0 = 1.3061e-04
Validation rmse = 0.117589
Validation r2 = 0.889752
Validation mse = 0.013827
Epoch 49
Loss = 8.6116e-02, PNorm = 35.1801, GNorm = 1.2043, lr_0 = 1.2553e-04
Validation rmse = 0.118304
Validation r2 = 0.888406
Validation mse = 0.013996
Epoch 50
Loss = 8.4645e-02, PNorm = 35.1847, GNorm = 1.2542, lr_0 = 1.2108e-04
Validation rmse = 0.119004
Validation r2 = 0.887082
Validation mse = 0.014162
Epoch 51
Loss = 8.6252e-02, PNorm = 35.1890, GNorm = 1.1790, lr_0 = 1.1637e-04
Validation rmse = 0.120662
Validation r2 = 0.883912
Validation mse = 0.014559
Epoch 52
Loss = 8.0023e-02, PNorm = 35.1937, GNorm = 1.5232, lr_0 = 1.1184e-04
Validation rmse = 0.120049
Validation r2 = 0.885090
Validation mse = 0.014412
Epoch 53
Loss = 9.1289e-02, PNorm = 35.1975, GNorm = 2.1832, lr_0 = 1.0749e-04
Validation rmse = 0.119623
Validation r2 = 0.885903
Validation mse = 0.014310
Epoch 54
Loss = 1.2006e-01, PNorm = 35.2010, GNorm = 1.9548, lr_0 = 1.0367e-04
Loss = 8.7090e-02, PNorm = 35.2041, GNorm = 1.6701, lr_0 = 1.0000e-04
Loss = 7.8178e-02, PNorm = 35.2042, GNorm = 1.5941, lr_0 = 1.0000e-04
Validation rmse = 0.116888
Validation r2 = 0.891061
Validation mse = 0.013663
Epoch 55
Loss = 8.4965e-02, PNorm = 35.2084, GNorm = 0.5358, lr_0 = 1.0000e-04
Validation rmse = 0.122590
Validation r2 = 0.880173
Validation mse = 0.015028
Epoch 56
Loss = 9.2697e-02, PNorm = 35.2117, GNorm = 0.6012, lr_0 = 1.0000e-04
Validation rmse = 0.119194
Validation r2 = 0.886721
Validation mse = 0.014207
Epoch 57
Loss = 8.7380e-02, PNorm = 35.2154, GNorm = 1.8102, lr_0 = 1.0000e-04
Validation rmse = 0.117479
Validation r2 = 0.889957
Validation mse = 0.013801
Epoch 58
Loss = 9.3319e-02, PNorm = 35.2192, GNorm = 1.2273, lr_0 = 1.0000e-04
Validation rmse = 0.117368
Validation r2 = 0.890165
Validation mse = 0.013775
Epoch 59
Loss = 8.5858e-02, PNorm = 35.2227, GNorm = 0.6267, lr_0 = 1.0000e-04
Validation rmse = 0.118462
Validation r2 = 0.888107
Validation mse = 0.014033
Model 0 best validation rmse = 0.116888 on epoch 54
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.173278
Model 0 test r2 = 0.568973
Model 0 test mse = 0.030025
Ensemble test rmse = 0.173278
Ensemble test r2 = 0.568973
Ensemble test mse = 0.030025
Fold 4
Splitting data with seed 4
Total size = 705 | train size = 564 | val size = 141 | test size = 317
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.8398e-01, PNorm = 34.0211, GNorm = 5.7992, lr_0 = 5.5000e-04
Validation rmse = 0.316397
Validation r2 = 0.301127
Validation mse = 0.100107
Epoch 1
Loss = 6.2426e-01, PNorm = 34.0785, GNorm = 7.8609, lr_0 = 1.0000e-03
Validation rmse = 0.365777
Validation r2 = 0.065959
Validation mse = 0.133793
Epoch 2
Loss = 5.8133e-01, PNorm = 34.1335, GNorm = 5.7210, lr_0 = 9.6108e-04
Validation rmse = 0.305240
Validation r2 = 0.349549
Validation mse = 0.093171
Epoch 3
Loss = 5.4001e-01, PNorm = 34.1896, GNorm = 6.7909, lr_0 = 9.2367e-04
Validation rmse = 0.254290
Validation r2 = 0.548570
Validation mse = 0.064663
Epoch 4
Loss = 4.0732e-01, PNorm = 34.2382, GNorm = 2.6887, lr_0 = 8.9093e-04
Validation rmse = 0.239503
Validation r2 = 0.599545
Validation mse = 0.057362
Epoch 5
Loss = 3.3161e-01, PNorm = 34.2896, GNorm = 1.4472, lr_0 = 8.5625e-04
Validation rmse = 0.237777
Validation r2 = 0.605296
Validation mse = 0.056538
Epoch 6
Loss = 3.1413e-01, PNorm = 34.3365, GNorm = 1.5187, lr_0 = 8.2293e-04
Validation rmse = 0.211292
Validation r2 = 0.688328
Validation mse = 0.044644
Epoch 7
Loss = 3.0227e-01, PNorm = 34.3866, GNorm = 1.6716, lr_0 = 7.9090e-04
Loss = 2.8420e-01, PNorm = 34.4302, GNorm = 6.4822, lr_0 = 7.6286e-04
Validation rmse = 0.200334
Validation r2 = 0.719818
Validation mse = 0.040134
Epoch 8
Loss = 2.1244e-01, PNorm = 34.4686, GNorm = 3.5128, lr_0 = 7.3582e-04
Validation rmse = 0.188787
Validation r2 = 0.751185
Validation mse = 0.035640
Epoch 9
Loss = 2.0643e-01, PNorm = 34.5146, GNorm = 1.9444, lr_0 = 7.0718e-04
Validation rmse = 0.185908
Validation r2 = 0.758716
Validation mse = 0.034562
Epoch 10
Loss = 1.8931e-01, PNorm = 34.5563, GNorm = 2.4081, lr_0 = 6.7965e-04
Validation rmse = 0.167455
Validation r2 = 0.804237
Validation mse = 0.028041
Epoch 11
Loss = 1.7212e-01, PNorm = 34.5934, GNorm = 5.6475, lr_0 = 6.5556e-04
Validation rmse = 0.173560
Validation r2 = 0.789702
Validation mse = 0.030123
Epoch 12
Loss = 1.9052e-01, PNorm = 34.6283, GNorm = 4.4078, lr_0 = 6.3005e-04
Validation rmse = 0.168608
Validation r2 = 0.801532
Validation mse = 0.028429
Epoch 13
Loss = 1.6902e-01, PNorm = 34.6648, GNorm = 2.5983, lr_0 = 6.0552e-04
Validation rmse = 0.156313
Validation r2 = 0.829422
Validation mse = 0.024434
Epoch 14
Loss = 1.2450e-01, PNorm = 34.6936, GNorm = 0.4292, lr_0 = 5.8196e-04
Validation rmse = 0.156670
Validation r2 = 0.828643
Validation mse = 0.024545
Epoch 15
Loss = 9.8876e-02, PNorm = 34.7197, GNorm = 1.5962, lr_0 = 5.6133e-04
Loss = 1.3737e-01, PNorm = 34.7448, GNorm = 2.9788, lr_0 = 5.4143e-04
Loss = 2.1535e-01, PNorm = 34.7477, GNorm = 3.4448, lr_0 = 5.3948e-04
Validation rmse = 0.151268
Validation r2 = 0.840256
Validation mse = 0.022882
Epoch 16
Loss = 1.6491e-01, PNorm = 34.7655, GNorm = 6.8994, lr_0 = 5.2036e-04
Validation rmse = 0.149871
Validation r2 = 0.843191
Validation mse = 0.022461
Epoch 17
Loss = 1.3877e-01, PNorm = 34.7880, GNorm = 0.6364, lr_0 = 5.0010e-04
Validation rmse = 0.148992
Validation r2 = 0.845026
Validation mse = 0.022199
Epoch 18
Loss = 1.3665e-01, PNorm = 34.8025, GNorm = 4.9799, lr_0 = 4.8238e-04
Validation rmse = 0.154024
Validation r2 = 0.834382
Validation mse = 0.023723
Epoch 19
Loss = 1.2274e-01, PNorm = 34.8238, GNorm = 1.6583, lr_0 = 4.6360e-04
Validation rmse = 0.150366
Validation r2 = 0.842155
Validation mse = 0.022610
Epoch 20
Loss = 1.5739e-01, PNorm = 34.8403, GNorm = 2.7675, lr_0 = 4.4556e-04
Validation rmse = 0.149233
Validation r2 = 0.844524
Validation mse = 0.022270
Epoch 21
Loss = 1.4507e-01, PNorm = 34.8601, GNorm = 5.1867, lr_0 = 4.2821e-04
Validation rmse = 0.184843
Validation r2 = 0.761472
Validation mse = 0.034167
Epoch 22
Loss = 1.3762e-01, PNorm = 34.8783, GNorm = 1.5287, lr_0 = 4.1304e-04
Validation rmse = 0.148914
Validation r2 = 0.845188
Validation mse = 0.022175
Epoch 23
Loss = 1.2570e-01, PNorm = 34.8967, GNorm = 0.7317, lr_0 = 3.9696e-04
Loss = 1.3858e-01, PNorm = 34.9121, GNorm = 2.2915, lr_0 = 3.8289e-04
Loss = 1.0559e-01, PNorm = 34.9133, GNorm = 3.3965, lr_0 = 3.8151e-04
Validation rmse = 0.149193
Validation r2 = 0.844608
Validation mse = 0.022259
Epoch 24
Loss = 1.1860e-01, PNorm = 34.9260, GNorm = 0.7500, lr_0 = 3.6799e-04
Validation rmse = 0.145775
Validation r2 = 0.851646
Validation mse = 0.021250
Epoch 25
Loss = 1.0942e-01, PNorm = 34.9358, GNorm = 1.7027, lr_0 = 3.5494e-04
Validation rmse = 0.143452
Validation r2 = 0.856336
Validation mse = 0.020579
Epoch 26
Loss = 1.0916e-01, PNorm = 34.9507, GNorm = 1.0990, lr_0 = 3.4113e-04
Validation rmse = 0.147812
Validation r2 = 0.847472
Validation mse = 0.021848
Epoch 27
Loss = 1.1280e-01, PNorm = 34.9623, GNorm = 0.6020, lr_0 = 3.2785e-04
Validation rmse = 0.147990
Validation r2 = 0.847103
Validation mse = 0.021901
Epoch 28
Loss = 1.0221e-01, PNorm = 34.9722, GNorm = 0.7027, lr_0 = 3.1509e-04
Validation rmse = 0.147339
Validation r2 = 0.848445
Validation mse = 0.021709
Epoch 29
Loss = 9.5356e-02, PNorm = 34.9825, GNorm = 0.6334, lr_0 = 3.0392e-04
Validation rmse = 0.159551
Validation r2 = 0.822283
Validation mse = 0.025456
Epoch 30
Loss = 1.2247e-01, PNorm = 34.9942, GNorm = 3.9629, lr_0 = 2.9209e-04
Validation rmse = 0.150152
Validation r2 = 0.842604
Validation mse = 0.022546
Epoch 31
Loss = 6.9788e-02, PNorm = 35.0052, GNorm = 0.9926, lr_0 = 2.8072e-04
Loss = 1.0636e-01, PNorm = 35.0137, GNorm = 0.9254, lr_0 = 2.7077e-04
Loss = 1.0757e-01, PNorm = 35.0139, GNorm = 2.5219, lr_0 = 2.6980e-04
Validation rmse = 0.147424
Validation r2 = 0.848271
Validation mse = 0.021734
Epoch 32
Loss = 1.0130e-01, PNorm = 35.0215, GNorm = 1.0644, lr_0 = 2.6023e-04
Validation rmse = 0.144026
Validation r2 = 0.855185
Validation mse = 0.020743
Epoch 33
Loss = 9.1274e-02, PNorm = 35.0280, GNorm = 0.7454, lr_0 = 2.5101e-04
Validation rmse = 0.147890
Validation r2 = 0.847310
Validation mse = 0.021871
Epoch 34
Loss = 9.9340e-02, PNorm = 35.0389, GNorm = 1.2610, lr_0 = 2.4124e-04
Validation rmse = 0.143010
Validation r2 = 0.857220
Validation mse = 0.020452
Epoch 35
Loss = 1.0190e-01, PNorm = 35.0484, GNorm = 1.0327, lr_0 = 2.3185e-04
Validation rmse = 0.146606
Validation r2 = 0.849949
Validation mse = 0.021493
Epoch 36
Loss = 9.2546e-02, PNorm = 35.0551, GNorm = 1.0730, lr_0 = 2.2363e-04
Validation rmse = 0.143119
Validation r2 = 0.857003
Validation mse = 0.020483
Epoch 37
Loss = 7.2318e-02, PNorm = 35.0635, GNorm = 0.4783, lr_0 = 2.1493e-04
Validation rmse = 0.143272
Validation r2 = 0.856698
Validation mse = 0.020527
Epoch 38
Loss = 8.4994e-02, PNorm = 35.0714, GNorm = 2.2351, lr_0 = 2.0656e-04
Validation rmse = 0.146658
Validation r2 = 0.849844
Validation mse = 0.021509
Epoch 39
Loss = 7.2885e-02, PNorm = 35.0789, GNorm = 2.5039, lr_0 = 1.9852e-04
Loss = 9.5992e-02, PNorm = 35.0844, GNorm = 0.9367, lr_0 = 1.9148e-04
Validation rmse = 0.144610
Validation r2 = 0.854007
Validation mse = 0.020912
Epoch 40
Loss = 9.2577e-02, PNorm = 35.0902, GNorm = 1.2508, lr_0 = 1.8470e-04
Validation rmse = 0.144403
Validation r2 = 0.854426
Validation mse = 0.020852
Epoch 41
Loss = 9.8427e-02, PNorm = 35.0987, GNorm = 0.7122, lr_0 = 1.7751e-04
Validation rmse = 0.144941
Validation r2 = 0.853338
Validation mse = 0.021008
Epoch 42
Loss = 9.1114e-02, PNorm = 35.1046, GNorm = 1.5568, lr_0 = 1.7060e-04
Validation rmse = 0.149026
Validation r2 = 0.844956
Validation mse = 0.022209
Epoch 43
Loss = 9.9639e-02, PNorm = 35.1099, GNorm = 0.6912, lr_0 = 1.6455e-04
Validation rmse = 0.151017
Validation r2 = 0.840786
Validation mse = 0.022806
Epoch 44
Loss = 8.1976e-02, PNorm = 35.1159, GNorm = 1.0215, lr_0 = 1.5815e-04
Validation rmse = 0.157106
Validation r2 = 0.827686
Validation mse = 0.024682
Epoch 45
Loss = 1.0175e-01, PNorm = 35.1225, GNorm = 2.8818, lr_0 = 1.5199e-04
Validation rmse = 0.149338
Validation r2 = 0.844304
Validation mse = 0.022302
Epoch 46
Loss = 7.4066e-02, PNorm = 35.1286, GNorm = 0.4726, lr_0 = 1.4608e-04
Loss = 8.5617e-02, PNorm = 35.1333, GNorm = 2.2538, lr_0 = 1.4090e-04
Validation rmse = 0.143139
Validation r2 = 0.856963
Validation mse = 0.020489
Epoch 47
Loss = 8.5067e-02, PNorm = 35.1372, GNorm = 0.6236, lr_0 = 1.3590e-04
Validation rmse = 0.142647
Validation r2 = 0.857944
Validation mse = 0.020348
Epoch 48
Loss = 8.4247e-02, PNorm = 35.1425, GNorm = 0.9499, lr_0 = 1.3061e-04
Validation rmse = 0.142409
Validation r2 = 0.858417
Validation mse = 0.020280
Epoch 49
Loss = 8.5777e-02, PNorm = 35.1469, GNorm = 1.3030, lr_0 = 1.2553e-04
Validation rmse = 0.143943
Validation r2 = 0.855351
Validation mse = 0.020720
Epoch 50
Loss = 9.4178e-02, PNorm = 35.1513, GNorm = 1.2802, lr_0 = 1.2108e-04
Validation rmse = 0.144157
Validation r2 = 0.854921
Validation mse = 0.020781
Epoch 51
Loss = 8.3590e-02, PNorm = 35.1545, GNorm = 3.7917, lr_0 = 1.1637e-04
Validation rmse = 0.143175
Validation r2 = 0.856891
Validation mse = 0.020499
Epoch 52
Loss = 7.2310e-02, PNorm = 35.1590, GNorm = 0.5306, lr_0 = 1.1184e-04
Validation rmse = 0.144634
Validation r2 = 0.853960
Validation mse = 0.020919
Epoch 53
Loss = 8.4108e-02, PNorm = 35.1637, GNorm = 1.8248, lr_0 = 1.0749e-04
Validation rmse = 0.143289
Validation r2 = 0.856662
Validation mse = 0.020532
Epoch 54
Loss = 8.4159e-02, PNorm = 35.1681, GNorm = 2.2451, lr_0 = 1.0367e-04
Loss = 8.4219e-02, PNorm = 35.1712, GNorm = 1.3252, lr_0 = 1.0000e-04
Loss = 3.4514e-02, PNorm = 35.1715, GNorm = 1.1379, lr_0 = 1.0000e-04
Validation rmse = 0.145223
Validation r2 = 0.852767
Validation mse = 0.021090
Epoch 55
Loss = 8.2028e-02, PNorm = 35.1745, GNorm = 0.8535, lr_0 = 1.0000e-04
Validation rmse = 0.153612
Validation r2 = 0.835267
Validation mse = 0.023597
Epoch 56
Loss = 8.2394e-02, PNorm = 35.1795, GNorm = 1.5168, lr_0 = 1.0000e-04
Validation rmse = 0.146176
Validation r2 = 0.850829
Validation mse = 0.021367
Epoch 57
Loss = 7.9667e-02, PNorm = 35.1829, GNorm = 0.5289, lr_0 = 1.0000e-04
Validation rmse = 0.143853
Validation r2 = 0.855532
Validation mse = 0.020694
Epoch 58
Loss = 7.6439e-02, PNorm = 35.1853, GNorm = 0.6877, lr_0 = 1.0000e-04
Validation rmse = 0.143059
Validation r2 = 0.857124
Validation mse = 0.020466
Epoch 59
Loss = 7.4948e-02, PNorm = 35.1898, GNorm = 1.7017, lr_0 = 1.0000e-04
Validation rmse = 0.145957
Validation r2 = 0.851276
Validation mse = 0.021303
Model 0 best validation rmse = 0.142409 on epoch 48
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.160369
Model 0 test r2 = 0.630806
Model 0 test mse = 0.025718
Ensemble test rmse = 0.160369
Ensemble test r2 = 0.630806
Ensemble test mse = 0.025718
Fold 5
Splitting data with seed 5
Total size = 705 | train size = 564 | val size = 141 | test size = 317
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1630e-01, PNorm = 34.0193, GNorm = 5.2594, lr_0 = 5.5000e-04
Validation rmse = 0.374812
Validation r2 = -0.083278
Validation mse = 0.140484
Epoch 1
Loss = 7.5846e-01, PNorm = 34.0614, GNorm = 2.1121, lr_0 = 1.0000e-03
Validation rmse = 0.315284
Validation r2 = 0.233493
Validation mse = 0.099404
Epoch 2
Loss = 5.9512e-01, PNorm = 34.1344, GNorm = 3.5123, lr_0 = 9.6108e-04
Validation rmse = 0.258280
Validation r2 = 0.485609
Validation mse = 0.066708
Epoch 3
Loss = 3.9806e-01, PNorm = 34.2141, GNorm = 2.3841, lr_0 = 9.2367e-04
Validation rmse = 0.252014
Validation r2 = 0.510265
Validation mse = 0.063511
Epoch 4
Loss = 3.3255e-01, PNorm = 34.2837, GNorm = 4.5462, lr_0 = 8.9093e-04
Validation rmse = 0.231834
Validation r2 = 0.585556
Validation mse = 0.053747
Epoch 5
Loss = 2.9643e-01, PNorm = 34.3438, GNorm = 7.3804, lr_0 = 8.5625e-04
Validation rmse = 0.227201
Validation r2 = 0.601954
Validation mse = 0.051620
Epoch 6
Loss = 2.4962e-01, PNorm = 34.4002, GNorm = 5.5743, lr_0 = 8.2293e-04
Validation rmse = 0.213783
Validation r2 = 0.647580
Validation mse = 0.045703
Epoch 7
Loss = 2.0447e-01, PNorm = 34.4455, GNorm = 0.9835, lr_0 = 7.9090e-04
Loss = 2.1910e-01, PNorm = 34.4887, GNorm = 2.1965, lr_0 = 7.6286e-04
Validation rmse = 0.216068
Validation r2 = 0.640006
Validation mse = 0.046686
Epoch 8
Loss = 2.1819e-01, PNorm = 34.5283, GNorm = 2.9187, lr_0 = 7.3582e-04
Validation rmse = 0.209384
Validation r2 = 0.661935
Validation mse = 0.043842
Epoch 9
Loss = 2.1552e-01, PNorm = 34.5771, GNorm = 1.5345, lr_0 = 7.0718e-04
Validation rmse = 0.190444
Validation r2 = 0.720328
Validation mse = 0.036269
Epoch 10
Loss = 1.8941e-01, PNorm = 34.6155, GNorm = 1.1352, lr_0 = 6.7965e-04
Validation rmse = 0.188328
Validation r2 = 0.726510
Validation mse = 0.035467
Epoch 11
Loss = 1.5707e-01, PNorm = 34.6505, GNorm = 1.1376, lr_0 = 6.5556e-04
Validation rmse = 0.177745
Validation r2 = 0.756384
Validation mse = 0.031593
Epoch 12
Loss = 1.4118e-01, PNorm = 34.6878, GNorm = 0.7653, lr_0 = 6.3005e-04
Validation rmse = 0.177830
Validation r2 = 0.756151
Validation mse = 0.031623
Epoch 13
Loss = 1.5089e-01, PNorm = 34.7132, GNorm = 5.8944, lr_0 = 6.0552e-04
Validation rmse = 0.180468
Validation r2 = 0.748862
Validation mse = 0.032569
Epoch 14
Loss = 1.4285e-01, PNorm = 34.7366, GNorm = 4.6914, lr_0 = 5.8196e-04
Validation rmse = 0.173930
Validation r2 = 0.766729
Validation mse = 0.030252
Epoch 15
Loss = 9.5971e-02, PNorm = 34.7649, GNorm = 2.0466, lr_0 = 5.6133e-04
Loss = 1.2240e-01, PNorm = 34.7890, GNorm = 0.9926, lr_0 = 5.4143e-04
Loss = 1.9297e-01, PNorm = 34.7910, GNorm = 1.4556, lr_0 = 5.3948e-04
Validation rmse = 0.167622
Validation r2 = 0.783342
Validation mse = 0.028097
Epoch 16
Loss = 1.1364e-01, PNorm = 34.8128, GNorm = 1.0470, lr_0 = 5.2036e-04
Validation rmse = 0.165695
Validation r2 = 0.788296
Validation mse = 0.027455
Epoch 17
Loss = 1.1411e-01, PNorm = 34.8328, GNorm = 1.5391, lr_0 = 5.0010e-04
Validation rmse = 0.181392
Validation r2 = 0.746285
Validation mse = 0.032903
Epoch 18
Loss = 1.1538e-01, PNorm = 34.8492, GNorm = 0.8715, lr_0 = 4.8238e-04
Validation rmse = 0.167813
Validation r2 = 0.782849
Validation mse = 0.028161
Epoch 19
Loss = 1.3667e-01, PNorm = 34.8707, GNorm = 3.9325, lr_0 = 4.6360e-04
Validation rmse = 0.166813
Validation r2 = 0.785427
Validation mse = 0.027827
Epoch 20
Loss = 1.2117e-01, PNorm = 34.8849, GNorm = 0.9776, lr_0 = 4.4556e-04
Validation rmse = 0.163920
Validation r2 = 0.792807
Validation mse = 0.026870
Epoch 21
Loss = 1.0255e-01, PNorm = 34.9030, GNorm = 2.0101, lr_0 = 4.2821e-04
Validation rmse = 0.172622
Validation r2 = 0.770224
Validation mse = 0.029798
Epoch 22
Loss = 1.0444e-01, PNorm = 34.9157, GNorm = 0.9589, lr_0 = 4.1304e-04
Validation rmse = 0.180069
Validation r2 = 0.749970
Validation mse = 0.032425
Epoch 23
Loss = 1.9371e-01, PNorm = 34.9296, GNorm = 6.0845, lr_0 = 3.9696e-04
Loss = 1.3714e-01, PNorm = 34.9446, GNorm = 4.2895, lr_0 = 3.8289e-04
Loss = 1.9560e-01, PNorm = 34.9470, GNorm = 2.1310, lr_0 = 3.8151e-04
Validation rmse = 0.180947
Validation r2 = 0.747528
Validation mse = 0.032742
Epoch 24
Loss = 1.2634e-01, PNorm = 34.9611, GNorm = 0.7931, lr_0 = 3.6799e-04
Validation rmse = 0.176318
Validation r2 = 0.760278
Validation mse = 0.031088
Epoch 25
Loss = 1.1163e-01, PNorm = 34.9760, GNorm = 1.7192, lr_0 = 3.5494e-04
Validation rmse = 0.159334
Validation r2 = 0.804237
Validation mse = 0.025387
Epoch 26
Loss = 9.0313e-02, PNorm = 34.9880, GNorm = 0.9456, lr_0 = 3.4113e-04
Validation rmse = 0.163103
Validation r2 = 0.794866
Validation mse = 0.026603
Epoch 27
Loss = 8.2246e-02, PNorm = 35.0000, GNorm = 2.0692, lr_0 = 3.2785e-04
Validation rmse = 0.168796
Validation r2 = 0.780297
Validation mse = 0.028492
Epoch 28
Loss = 1.1006e-01, PNorm = 35.0127, GNorm = 1.1185, lr_0 = 3.1509e-04
Validation rmse = 0.164415
Validation r2 = 0.791554
Validation mse = 0.027032
Epoch 29
Loss = 1.2221e-01, PNorm = 35.0215, GNorm = 2.2304, lr_0 = 3.0392e-04
Validation rmse = 0.162495
Validation r2 = 0.796393
Validation mse = 0.026405
Epoch 30
Loss = 6.6414e-02, PNorm = 35.0341, GNorm = 0.5627, lr_0 = 2.9209e-04
Validation rmse = 0.161985
Validation r2 = 0.797670
Validation mse = 0.026239
Epoch 31
Loss = 8.8586e-02, PNorm = 35.0423, GNorm = 0.6735, lr_0 = 2.8072e-04
Loss = 9.2397e-02, PNorm = 35.0530, GNorm = 1.1169, lr_0 = 2.7077e-04
Loss = 1.7342e-01, PNorm = 35.0537, GNorm = 4.2165, lr_0 = 2.6980e-04
Validation rmse = 0.159787
Validation r2 = 0.803122
Validation mse = 0.025532
Epoch 32
Loss = 8.4871e-02, PNorm = 35.0615, GNorm = 0.8756, lr_0 = 2.6023e-04
Validation rmse = 0.170555
Validation r2 = 0.775694
Validation mse = 0.029089
Epoch 33
Loss = 9.4824e-02, PNorm = 35.0684, GNorm = 0.7704, lr_0 = 2.5101e-04
Validation rmse = 0.158974
Validation r2 = 0.805121
Validation mse = 0.025273
Epoch 34
Loss = 8.1022e-02, PNorm = 35.0781, GNorm = 0.5209, lr_0 = 2.4124e-04
Validation rmse = 0.154675
Validation r2 = 0.815519
Validation mse = 0.023924
Epoch 35
Loss = 7.9788e-02, PNorm = 35.0876, GNorm = 1.1514, lr_0 = 2.3185e-04
Validation rmse = 0.157561
Validation r2 = 0.808571
Validation mse = 0.024825
Epoch 36
Loss = 9.7273e-02, PNorm = 35.0944, GNorm = 0.9128, lr_0 = 2.2363e-04
Validation rmse = 0.162545
Validation r2 = 0.796268
Validation mse = 0.026421
Epoch 37
Loss = 1.0467e-01, PNorm = 35.1019, GNorm = 1.8231, lr_0 = 2.1493e-04
Validation rmse = 0.160036
Validation r2 = 0.802509
Validation mse = 0.025612
Epoch 38
Loss = 9.6264e-02, PNorm = 35.1091, GNorm = 0.5980, lr_0 = 2.0656e-04
Validation rmse = 0.155533
Validation r2 = 0.813467
Validation mse = 0.024190
Epoch 39
Loss = 9.9466e-02, PNorm = 35.1159, GNorm = 0.9934, lr_0 = 1.9852e-04
Loss = 9.0584e-02, PNorm = 35.1215, GNorm = 1.0203, lr_0 = 1.9148e-04
Validation rmse = 0.156072
Validation r2 = 0.812171
Validation mse = 0.024358
Epoch 40
Loss = 8.8866e-02, PNorm = 35.1278, GNorm = 1.9122, lr_0 = 1.8470e-04
Validation rmse = 0.155645
Validation r2 = 0.813198
Validation mse = 0.024225
Epoch 41
Loss = 8.3703e-02, PNorm = 35.1334, GNorm = 0.8176, lr_0 = 1.7751e-04
Validation rmse = 0.155303
Validation r2 = 0.814018
Validation mse = 0.024119
Epoch 42
Loss = 9.1753e-02, PNorm = 35.1410, GNorm = 0.9748, lr_0 = 1.7060e-04
Validation rmse = 0.156749
Validation r2 = 0.810539
Validation mse = 0.024570
Epoch 43
Loss = 7.5408e-02, PNorm = 35.1460, GNorm = 1.3519, lr_0 = 1.6455e-04
Validation rmse = 0.156828
Validation r2 = 0.810346
Validation mse = 0.024595
Epoch 44
Loss = 8.9984e-02, PNorm = 35.1535, GNorm = 0.8623, lr_0 = 1.5815e-04
Validation rmse = 0.161045
Validation r2 = 0.800012
Validation mse = 0.025935
Epoch 45
Loss = 8.6013e-02, PNorm = 35.1592, GNorm = 2.0389, lr_0 = 1.5199e-04
Validation rmse = 0.154623
Validation r2 = 0.815643
Validation mse = 0.023908
Epoch 46
Loss = 7.9161e-02, PNorm = 35.1641, GNorm = 1.1419, lr_0 = 1.4608e-04
Loss = 7.6875e-02, PNorm = 35.1689, GNorm = 0.5993, lr_0 = 1.4090e-04
Validation rmse = 0.154174
Validation r2 = 0.816712
Validation mse = 0.023770
Epoch 47
Loss = 8.1373e-02, PNorm = 35.1728, GNorm = 0.8540, lr_0 = 1.3590e-04
Validation rmse = 0.153649
Validation r2 = 0.817958
Validation mse = 0.023608
Epoch 48
Loss = 8.2619e-02, PNorm = 35.1784, GNorm = 0.4760, lr_0 = 1.3061e-04
Validation rmse = 0.154501
Validation r2 = 0.815934
Validation mse = 0.023870
Epoch 49
Loss = 8.1443e-02, PNorm = 35.1831, GNorm = 2.3823, lr_0 = 1.2553e-04
Validation rmse = 0.153790
Validation r2 = 0.817624
Validation mse = 0.023651
Epoch 50
Loss = 7.8211e-02, PNorm = 35.1877, GNorm = 2.1627, lr_0 = 1.2108e-04
Validation rmse = 0.154821
Validation r2 = 0.815171
Validation mse = 0.023969
Epoch 51
Loss = 6.9623e-02, PNorm = 35.1914, GNorm = 1.3247, lr_0 = 1.1637e-04
Validation rmse = 0.154843
Validation r2 = 0.815118
Validation mse = 0.023976
Epoch 52
Loss = 7.1672e-02, PNorm = 35.1955, GNorm = 1.2415, lr_0 = 1.1184e-04
Validation rmse = 0.158899
Validation r2 = 0.805305
Validation mse = 0.025249
Epoch 53
Loss = 6.4900e-02, PNorm = 35.1995, GNorm = 0.6022, lr_0 = 1.0749e-04
Validation rmse = 0.160300
Validation r2 = 0.801856
Validation mse = 0.025696
Epoch 54
Loss = 8.7942e-02, PNorm = 35.2034, GNorm = 1.4827, lr_0 = 1.0367e-04
Loss = 7.2856e-02, PNorm = 35.2072, GNorm = 0.9721, lr_0 = 1.0000e-04
Loss = 1.5308e-01, PNorm = 35.2076, GNorm = 2.4866, lr_0 = 1.0000e-04
Validation rmse = 0.155436
Validation r2 = 0.813699
Validation mse = 0.024160
Epoch 55
Loss = 7.4232e-02, PNorm = 35.2113, GNorm = 0.7232, lr_0 = 1.0000e-04
Validation rmse = 0.154100
Validation r2 = 0.816888
Validation mse = 0.023747
Epoch 56
Loss = 7.4020e-02, PNorm = 35.2152, GNorm = 0.9193, lr_0 = 1.0000e-04
Validation rmse = 0.153859
Validation r2 = 0.817461
Validation mse = 0.023673
Epoch 57
Loss = 7.3879e-02, PNorm = 35.2185, GNorm = 1.3528, lr_0 = 1.0000e-04
Validation rmse = 0.152487
Validation r2 = 0.820702
Validation mse = 0.023252
Epoch 58
Loss = 7.2370e-02, PNorm = 35.2211, GNorm = 1.4169, lr_0 = 1.0000e-04
Validation rmse = 0.153587
Validation r2 = 0.818104
Validation mse = 0.023589
Epoch 59
Loss = 7.6422e-02, PNorm = 35.2255, GNorm = 0.5379, lr_0 = 1.0000e-04
Validation rmse = 0.156460
Validation r2 = 0.811235
Validation mse = 0.024480
Model 0 best validation rmse = 0.152487 on epoch 57
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.177941
Model 0 test r2 = 0.545464
Model 0 test mse = 0.031663
Ensemble test rmse = 0.177941
Ensemble test r2 = 0.545464
Ensemble test mse = 0.031663
Fold 6
Splitting data with seed 6
Total size = 705 | train size = 564 | val size = 141 | test size = 317
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.3451e-01, PNorm = 34.0173, GNorm = 1.7928, lr_0 = 5.5000e-04
Validation rmse = 0.316721
Validation r2 = 0.256894
Validation mse = 0.100312
Epoch 1
Loss = 6.9022e-01, PNorm = 34.0675, GNorm = 1.4241, lr_0 = 1.0000e-03
Validation rmse = 0.437672
Validation r2 = -0.419036
Validation mse = 0.191556
Epoch 2
Loss = 7.8491e-01, PNorm = 34.1285, GNorm = 2.4530, lr_0 = 9.6108e-04
Validation rmse = 0.256919
Validation r2 = 0.511020
Validation mse = 0.066008
Epoch 3
Loss = 4.6734e-01, PNorm = 34.2025, GNorm = 3.1209, lr_0 = 9.2367e-04
Validation rmse = 0.246517
Validation r2 = 0.549816
Validation mse = 0.060771
Epoch 4
Loss = 4.4042e-01, PNorm = 34.2648, GNorm = 2.8442, lr_0 = 8.9093e-04
Validation rmse = 0.239206
Validation r2 = 0.576122
Validation mse = 0.057220
Epoch 5
Loss = 4.4611e-01, PNorm = 34.3244, GNorm = 2.0010, lr_0 = 8.5625e-04
Validation rmse = 0.214369
Validation r2 = 0.659575
Validation mse = 0.045954
Epoch 6
Loss = 3.4362e-01, PNorm = 34.3851, GNorm = 2.9877, lr_0 = 8.2293e-04
Validation rmse = 0.209925
Validation r2 = 0.673545
Validation mse = 0.044068
Epoch 7
Loss = 3.0810e-01, PNorm = 34.4294, GNorm = 1.8321, lr_0 = 7.9090e-04
Loss = 4.2433e-01, PNorm = 34.4784, GNorm = 5.3468, lr_0 = 7.6286e-04
Validation rmse = 0.235077
Validation r2 = 0.590629
Validation mse = 0.055261
Epoch 8
Loss = 3.5405e-01, PNorm = 34.5102, GNorm = 1.0582, lr_0 = 7.3582e-04
Validation rmse = 0.191960
Validation r2 = 0.727029
Validation mse = 0.036849
Epoch 9
Loss = 2.7347e-01, PNorm = 34.5532, GNorm = 2.8747, lr_0 = 7.0718e-04
Validation rmse = 0.186687
Validation r2 = 0.741820
Validation mse = 0.034852
Epoch 10
Loss = 2.7989e-01, PNorm = 34.5901, GNorm = 2.3812, lr_0 = 6.7965e-04
Validation rmse = 0.170659
Validation r2 = 0.784247
Validation mse = 0.029125
Epoch 11
Loss = 2.2150e-01, PNorm = 34.6253, GNorm = 2.3666, lr_0 = 6.5556e-04
Validation rmse = 0.164883
Validation r2 = 0.798606
Validation mse = 0.027186
Epoch 12
Loss = 1.5745e-01, PNorm = 34.6649, GNorm = 0.5663, lr_0 = 6.3005e-04
Validation rmse = 0.184652
Validation r2 = 0.747416
Validation mse = 0.034096
Epoch 13
Loss = 1.9296e-01, PNorm = 34.7020, GNorm = 2.1057, lr_0 = 6.0552e-04
Validation rmse = 0.155185
Validation r2 = 0.821599
Validation mse = 0.024082
Epoch 14
Loss = 1.3072e-01, PNorm = 34.7405, GNorm = 0.7352, lr_0 = 5.8196e-04
Validation rmse = 0.149333
Validation r2 = 0.834801
Validation mse = 0.022300
Epoch 15
Loss = 1.6426e-01, PNorm = 34.7699, GNorm = 1.1226, lr_0 = 5.6133e-04
Loss = 1.4538e-01, PNorm = 34.8000, GNorm = 0.7185, lr_0 = 5.4143e-04
Loss = 1.5134e-01, PNorm = 34.8022, GNorm = 0.9605, lr_0 = 5.3948e-04
Validation rmse = 0.143679
Validation r2 = 0.847073
Validation mse = 0.020644
Epoch 16
Loss = 1.4164e-01, PNorm = 34.8271, GNorm = 1.4078, lr_0 = 5.2036e-04
Validation rmse = 0.145576
Validation r2 = 0.843008
Validation mse = 0.021192
Epoch 17
Loss = 1.3903e-01, PNorm = 34.8488, GNorm = 0.6539, lr_0 = 5.0010e-04
Validation rmse = 0.142494
Validation r2 = 0.849585
Validation mse = 0.020305
Epoch 18
Loss = 1.6244e-01, PNorm = 34.8727, GNorm = 3.1060, lr_0 = 4.8238e-04
Validation rmse = 0.137719
Validation r2 = 0.859497
Validation mse = 0.018967
Epoch 19
Loss = 1.4892e-01, PNorm = 34.8956, GNorm = 4.3283, lr_0 = 4.6360e-04
Validation rmse = 0.139633
Validation r2 = 0.855565
Validation mse = 0.019497
Epoch 20
Loss = 1.3907e-01, PNorm = 34.9198, GNorm = 2.3463, lr_0 = 4.4556e-04
Validation rmse = 0.140912
Validation r2 = 0.852906
Validation mse = 0.019856
Epoch 21
Loss = 1.4193e-01, PNorm = 34.9384, GNorm = 1.5761, lr_0 = 4.2821e-04
Validation rmse = 0.140012
Validation r2 = 0.854780
Validation mse = 0.019603
Epoch 22
Loss = 8.8831e-02, PNorm = 34.9579, GNorm = 1.4995, lr_0 = 4.1304e-04
Validation rmse = 0.133848
Validation r2 = 0.867285
Validation mse = 0.017915
Epoch 23
Loss = 6.4399e-02, PNorm = 34.9745, GNorm = 0.3478, lr_0 = 3.9696e-04
Loss = 1.1908e-01, PNorm = 34.9873, GNorm = 0.6215, lr_0 = 3.8289e-04
Loss = 7.1931e-02, PNorm = 34.9886, GNorm = 1.3408, lr_0 = 3.8151e-04
Validation rmse = 0.156169
Validation r2 = 0.819329
Validation mse = 0.024389
Epoch 24
Loss = 1.2871e-01, PNorm = 35.0014, GNorm = 3.1697, lr_0 = 3.6799e-04
Validation rmse = 0.136365
Validation r2 = 0.862246
Validation mse = 0.018595
Epoch 25
Loss = 1.1371e-01, PNorm = 35.0143, GNorm = 2.5014, lr_0 = 3.5494e-04
Validation rmse = 0.133673
Validation r2 = 0.867631
Validation mse = 0.017869
Epoch 26
Loss = 1.1590e-01, PNorm = 35.0293, GNorm = 0.9793, lr_0 = 3.4113e-04
Validation rmse = 0.139034
Validation r2 = 0.856801
Validation mse = 0.019331
Epoch 27
Loss = 9.2030e-02, PNorm = 35.0436, GNorm = 0.8939, lr_0 = 3.2785e-04
Validation rmse = 0.138245
Validation r2 = 0.858421
Validation mse = 0.019112
Epoch 28
Loss = 1.1643e-01, PNorm = 35.0551, GNorm = 0.5238, lr_0 = 3.1509e-04
Validation rmse = 0.136747
Validation r2 = 0.861473
Validation mse = 0.018700
Epoch 29
Loss = 1.1248e-01, PNorm = 35.0652, GNorm = 2.2636, lr_0 = 3.0392e-04
Validation rmse = 0.134624
Validation r2 = 0.865742
Validation mse = 0.018123
Epoch 30
Loss = 9.4162e-02, PNorm = 35.0753, GNorm = 2.5526, lr_0 = 2.9209e-04
Validation rmse = 0.141502
Validation r2 = 0.851672
Validation mse = 0.020023
Epoch 31
Loss = 1.3511e-01, PNorm = 35.0848, GNorm = 1.6275, lr_0 = 2.8072e-04
Loss = 1.0836e-01, PNorm = 35.0954, GNorm = 0.9081, lr_0 = 2.7077e-04
Loss = 1.2249e-01, PNorm = 35.0962, GNorm = 1.8950, lr_0 = 2.6980e-04
Validation rmse = 0.142770
Validation r2 = 0.849003
Validation mse = 0.020383
Epoch 32
Loss = 1.0421e-01, PNorm = 35.1055, GNorm = 1.0462, lr_0 = 2.6023e-04
Validation rmse = 0.135573
Validation r2 = 0.863842
Validation mse = 0.018380
Epoch 33
Loss = 1.1635e-01, PNorm = 35.1127, GNorm = 2.9404, lr_0 = 2.5101e-04
Validation rmse = 0.131835
Validation r2 = 0.871247
Validation mse = 0.017380
Epoch 34
Loss = 1.0183e-01, PNorm = 35.1217, GNorm = 0.6588, lr_0 = 2.4124e-04
Validation rmse = 0.137782
Validation r2 = 0.859370
Validation mse = 0.018984
Epoch 35
Loss = 9.9109e-02, PNorm = 35.1306, GNorm = 1.8504, lr_0 = 2.3185e-04
Validation rmse = 0.133847
Validation r2 = 0.867288
Validation mse = 0.017915
Epoch 36
Loss = 9.4717e-02, PNorm = 35.1389, GNorm = 0.4897, lr_0 = 2.2363e-04
Validation rmse = 0.135596
Validation r2 = 0.863796
Validation mse = 0.018386
Epoch 37
Loss = 8.4609e-02, PNorm = 35.1458, GNorm = 0.7150, lr_0 = 2.1493e-04
Validation rmse = 0.133021
Validation r2 = 0.868921
Validation mse = 0.017694
Epoch 38
Loss = 8.1970e-02, PNorm = 35.1546, GNorm = 1.4355, lr_0 = 2.0656e-04
Validation rmse = 0.133146
Validation r2 = 0.868674
Validation mse = 0.017728
Epoch 39
Loss = 8.9790e-02, PNorm = 35.1605, GNorm = 1.3765, lr_0 = 1.9852e-04
Loss = 9.5673e-02, PNorm = 35.1681, GNorm = 0.8477, lr_0 = 1.9148e-04
Validation rmse = 0.131799
Validation r2 = 0.871316
Validation mse = 0.017371
Epoch 40
Loss = 9.4677e-02, PNorm = 35.1755, GNorm = 0.7102, lr_0 = 1.8470e-04
Validation rmse = 0.135429
Validation r2 = 0.864131
Validation mse = 0.018341
Epoch 41
Loss = 9.3401e-02, PNorm = 35.1809, GNorm = 0.9392, lr_0 = 1.7751e-04
Validation rmse = 0.134491
Validation r2 = 0.866007
Validation mse = 0.018088
Epoch 42
Loss = 8.5755e-02, PNorm = 35.1882, GNorm = 1.0825, lr_0 = 1.7060e-04
Validation rmse = 0.138076
Validation r2 = 0.858767
Validation mse = 0.019065
Epoch 43
Loss = 1.0462e-01, PNorm = 35.1940, GNorm = 1.4673, lr_0 = 1.6455e-04
Validation rmse = 0.132878
Validation r2 = 0.869201
Validation mse = 0.017657
Epoch 44
Loss = 9.5563e-02, PNorm = 35.2009, GNorm = 1.1130, lr_0 = 1.5815e-04
Validation rmse = 0.129791
Validation r2 = 0.875208
Validation mse = 0.016846
Epoch 45
Loss = 6.7323e-02, PNorm = 35.2072, GNorm = 0.6964, lr_0 = 1.5199e-04
Validation rmse = 0.132719
Validation r2 = 0.869515
Validation mse = 0.017614
Epoch 46
Loss = 1.4779e-01, PNorm = 35.2134, GNorm = 3.0393, lr_0 = 1.4608e-04
Loss = 7.8317e-02, PNorm = 35.2184, GNorm = 0.9860, lr_0 = 1.4090e-04
Validation rmse = 0.134349
Validation r2 = 0.866290
Validation mse = 0.018050
Epoch 47
Loss = 9.6998e-02, PNorm = 35.2218, GNorm = 0.4588, lr_0 = 1.3590e-04
Validation rmse = 0.132275
Validation r2 = 0.870386
Validation mse = 0.017497
Epoch 48
Loss = 9.8401e-02, PNorm = 35.2276, GNorm = 1.2871, lr_0 = 1.3061e-04
Validation rmse = 0.130540
Validation r2 = 0.873764
Validation mse = 0.017041
Epoch 49
Loss = 8.6371e-02, PNorm = 35.2313, GNorm = 0.7208, lr_0 = 1.2553e-04
Validation rmse = 0.133482
Validation r2 = 0.868010
Validation mse = 0.017817
Epoch 50
Loss = 8.2645e-02, PNorm = 35.2368, GNorm = 2.0108, lr_0 = 1.2108e-04
Validation rmse = 0.141582
Validation r2 = 0.851505
Validation mse = 0.020045
Epoch 51
Loss = 7.8167e-02, PNorm = 35.2420, GNorm = 1.1690, lr_0 = 1.1637e-04
Validation rmse = 0.134812
Validation r2 = 0.865366
Validation mse = 0.018174
Epoch 52
Loss = 8.9248e-02, PNorm = 35.2457, GNorm = 0.8162, lr_0 = 1.1184e-04
Validation rmse = 0.132067
Validation r2 = 0.870792
Validation mse = 0.017442
Epoch 53
Loss = 8.8634e-02, PNorm = 35.2502, GNorm = 0.7066, lr_0 = 1.0749e-04
Validation rmse = 0.135226
Validation r2 = 0.864538
Validation mse = 0.018286
Epoch 54
Loss = 1.1365e-01, PNorm = 35.2538, GNorm = 2.1854, lr_0 = 1.0367e-04
Loss = 8.4704e-02, PNorm = 35.2578, GNorm = 0.6556, lr_0 = 1.0000e-04
Loss = 5.3050e-02, PNorm = 35.2581, GNorm = 1.3427, lr_0 = 1.0000e-04
Validation rmse = 0.132568
Validation r2 = 0.869810
Validation mse = 0.017574
Epoch 55
Loss = 8.1564e-02, PNorm = 35.2618, GNorm = 1.1400, lr_0 = 1.0000e-04
Validation rmse = 0.130323
Validation r2 = 0.874182
Validation mse = 0.016984
Epoch 56
Loss = 8.2848e-02, PNorm = 35.2656, GNorm = 1.0127, lr_0 = 1.0000e-04
Validation rmse = 0.132447
Validation r2 = 0.870049
Validation mse = 0.017542
Epoch 57
Loss = 7.9492e-02, PNorm = 35.2696, GNorm = 1.1093, lr_0 = 1.0000e-04
Validation rmse = 0.131415
Validation r2 = 0.872066
Validation mse = 0.017270
Epoch 58
Loss = 9.3234e-02, PNorm = 35.2741, GNorm = 0.8029, lr_0 = 1.0000e-04
Validation rmse = 0.132173
Validation r2 = 0.870586
Validation mse = 0.017470
Epoch 59
Loss = 7.9212e-02, PNorm = 35.2781, GNorm = 0.4119, lr_0 = 1.0000e-04
Validation rmse = 0.132784
Validation r2 = 0.869386
Validation mse = 0.017632
Model 0 best validation rmse = 0.129791 on epoch 44
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.159815
Model 0 test r2 = 0.633350
Model 0 test mse = 0.025541
Ensemble test rmse = 0.159815
Ensemble test r2 = 0.633350
Ensemble test mse = 0.025541
Fold 7
Splitting data with seed 7
Total size = 705 | train size = 564 | val size = 141 | test size = 317
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1886e-01, PNorm = 34.0208, GNorm = 2.2431, lr_0 = 5.5000e-04
Validation rmse = 0.300987
Validation r2 = 0.239705
Validation mse = 0.090593
Epoch 1
Loss = 8.8071e-01, PNorm = 34.0535, GNorm = 1.4484, lr_0 = 1.0000e-03
Validation rmse = 0.323156
Validation r2 = 0.123579
Validation mse = 0.104430
Epoch 2
Loss = 7.8088e-01, PNorm = 34.1201, GNorm = 4.2995, lr_0 = 9.6108e-04
Validation rmse = 0.277113
Validation r2 = 0.355532
Validation mse = 0.076792
Epoch 3
Loss = 5.6213e-01, PNorm = 34.2033, GNorm = 5.0470, lr_0 = 9.2367e-04
Validation rmse = 0.224477
Validation r2 = 0.577107
Validation mse = 0.050390
Epoch 4
Loss = 4.9015e-01, PNorm = 34.2747, GNorm = 3.7314, lr_0 = 8.9093e-04
Validation rmse = 0.206311
Validation r2 = 0.642782
Validation mse = 0.042564
Epoch 5
Loss = 3.7916e-01, PNorm = 34.3501, GNorm = 5.2797, lr_0 = 8.5625e-04
Validation rmse = 0.249667
Validation r2 = 0.476872
Validation mse = 0.062333
Epoch 6
Loss = 3.6575e-01, PNorm = 34.4036, GNorm = 2.0676, lr_0 = 8.2293e-04
Validation rmse = 0.185284
Validation r2 = 0.711888
Validation mse = 0.034330
Epoch 7
Loss = 3.1218e-01, PNorm = 34.4659, GNorm = 1.2894, lr_0 = 7.9090e-04
Loss = 2.7295e-01, PNorm = 34.5154, GNorm = 1.4613, lr_0 = 7.6286e-04
Validation rmse = 0.176093
Validation r2 = 0.739761
Validation mse = 0.031009
Epoch 8
Loss = 2.5028e-01, PNorm = 34.5648, GNorm = 0.7326, lr_0 = 7.3582e-04
Validation rmse = 0.167328
Validation r2 = 0.765023
Validation mse = 0.027999
Epoch 9
Loss = 2.2164e-01, PNorm = 34.6204, GNorm = 5.1461, lr_0 = 7.0718e-04
Validation rmse = 0.166913
Validation r2 = 0.766188
Validation mse = 0.027860
Epoch 10
Loss = 2.0170e-01, PNorm = 34.6699, GNorm = 0.6605, lr_0 = 6.7965e-04
Validation rmse = 0.153933
Validation r2 = 0.801137
Validation mse = 0.023696
Epoch 11
Loss = 1.6952e-01, PNorm = 34.7114, GNorm = 3.3848, lr_0 = 6.5556e-04
Validation rmse = 0.152363
Validation r2 = 0.805175
Validation mse = 0.023214
Epoch 12
Loss = 1.6940e-01, PNorm = 34.7525, GNorm = 1.3028, lr_0 = 6.3005e-04
Validation rmse = 0.152059
Validation r2 = 0.805950
Validation mse = 0.023122
Epoch 13
Loss = 1.7171e-01, PNorm = 34.7921, GNorm = 4.2270, lr_0 = 6.0552e-04
Validation rmse = 0.147883
Validation r2 = 0.816464
Validation mse = 0.021869
Epoch 14
Loss = 1.3072e-01, PNorm = 34.8334, GNorm = 1.4480, lr_0 = 5.8196e-04
Validation rmse = 0.147186
Validation r2 = 0.818189
Validation mse = 0.021664
Epoch 15
Loss = 1.8479e-01, PNorm = 34.8590, GNorm = 1.0448, lr_0 = 5.6133e-04
Loss = 1.2857e-01, PNorm = 34.8869, GNorm = 1.6307, lr_0 = 5.4143e-04
Loss = 4.1702e-02, PNorm = 34.8898, GNorm = 1.8125, lr_0 = 5.3948e-04
Validation rmse = 0.147193
Validation r2 = 0.818171
Validation mse = 0.021666
Epoch 16
Loss = 1.4262e-01, PNorm = 34.9105, GNorm = 0.8997, lr_0 = 5.2036e-04
Validation rmse = 0.145054
Validation r2 = 0.823418
Validation mse = 0.021041
Epoch 17
Loss = 1.2721e-01, PNorm = 34.9408, GNorm = 0.6260, lr_0 = 5.0010e-04
Validation rmse = 0.158244
Validation r2 = 0.789843
Validation mse = 0.025041
Epoch 18
Loss = 1.3317e-01, PNorm = 34.9553, GNorm = 1.7847, lr_0 = 4.8238e-04
Validation rmse = 0.149499
Validation r2 = 0.812429
Validation mse = 0.022350
Epoch 19
Loss = 1.5344e-01, PNorm = 34.9792, GNorm = 3.4336, lr_0 = 4.6360e-04
Validation rmse = 0.149287
Validation r2 = 0.812962
Validation mse = 0.022287
Epoch 20
Loss = 1.2021e-01, PNorm = 34.9963, GNorm = 2.0394, lr_0 = 4.4556e-04
Validation rmse = 0.142517
Validation r2 = 0.829541
Validation mse = 0.020311
Epoch 21
Loss = 1.4463e-01, PNorm = 35.0156, GNorm = 1.9753, lr_0 = 4.2821e-04
Validation rmse = 0.153418
Validation r2 = 0.802468
Validation mse = 0.023537
Epoch 22
Loss = 1.5909e-01, PNorm = 35.0321, GNorm = 3.0341, lr_0 = 4.1304e-04
Validation rmse = 0.141614
Validation r2 = 0.831694
Validation mse = 0.020054
Epoch 23
Loss = 9.8881e-02, PNorm = 35.0473, GNorm = 2.5992, lr_0 = 3.9696e-04
Loss = 1.1085e-01, PNorm = 35.0613, GNorm = 1.1397, lr_0 = 3.8289e-04
Loss = 7.6492e-02, PNorm = 35.0629, GNorm = 2.6090, lr_0 = 3.8151e-04
Validation rmse = 0.140750
Validation r2 = 0.833742
Validation mse = 0.019810
Epoch 24
Loss = 1.0301e-01, PNorm = 35.0753, GNorm = 2.1132, lr_0 = 3.6799e-04
Validation rmse = 0.142236
Validation r2 = 0.830213
Validation mse = 0.020231
Epoch 25
Loss = 1.1069e-01, PNorm = 35.0887, GNorm = 0.7366, lr_0 = 3.5494e-04
Validation rmse = 0.146617
Validation r2 = 0.819591
Validation mse = 0.021497
Epoch 26
Loss = 1.0561e-01, PNorm = 35.1017, GNorm = 0.9193, lr_0 = 3.4113e-04
Validation rmse = 0.143570
Validation r2 = 0.827013
Validation mse = 0.020612
Epoch 27
Loss = 1.0213e-01, PNorm = 35.1116, GNorm = 1.2907, lr_0 = 3.2785e-04
Validation rmse = 0.156151
Validation r2 = 0.795367
Validation mse = 0.024383
Epoch 28
Loss = 9.8027e-02, PNorm = 35.1220, GNorm = 0.7224, lr_0 = 3.1509e-04
Validation rmse = 0.144192
Validation r2 = 0.825511
Validation mse = 0.020791
Epoch 29
Loss = 9.6795e-02, PNorm = 35.1318, GNorm = 1.3505, lr_0 = 3.0392e-04
Validation rmse = 0.141651
Validation r2 = 0.831607
Validation mse = 0.020065
Epoch 30
Loss = 1.0451e-01, PNorm = 35.1425, GNorm = 0.3730, lr_0 = 2.9209e-04
Validation rmse = 0.144019
Validation r2 = 0.825928
Validation mse = 0.020742
Epoch 31
Loss = 9.9515e-02, PNorm = 35.1517, GNorm = 1.5611, lr_0 = 2.8072e-04
Loss = 9.5265e-02, PNorm = 35.1591, GNorm = 1.6922, lr_0 = 2.7077e-04
Loss = 9.3916e-02, PNorm = 35.1599, GNorm = 2.4502, lr_0 = 2.6980e-04
Validation rmse = 0.143716
Validation r2 = 0.826661
Validation mse = 0.020654
Epoch 32
Loss = 9.3633e-02, PNorm = 35.1673, GNorm = 0.4864, lr_0 = 2.6023e-04
Validation rmse = 0.143298
Validation r2 = 0.827667
Validation mse = 0.020534
Epoch 33
Loss = 9.4597e-02, PNorm = 35.1753, GNorm = 1.5093, lr_0 = 2.5101e-04
Validation rmse = 0.143511
Validation r2 = 0.827154
Validation mse = 0.020595
Epoch 34
Loss = 9.1666e-02, PNorm = 35.1847, GNorm = 2.0668, lr_0 = 2.4124e-04
Validation rmse = 0.141643
Validation r2 = 0.831624
Validation mse = 0.020063
Epoch 35
Loss = 7.7528e-02, PNorm = 35.1930, GNorm = 0.7723, lr_0 = 2.3185e-04
Validation rmse = 0.146698
Validation r2 = 0.819392
Validation mse = 0.021520
Epoch 36
Loss = 9.1234e-02, PNorm = 35.1997, GNorm = 1.6178, lr_0 = 2.2363e-04
Validation rmse = 0.141504
Validation r2 = 0.831955
Validation mse = 0.020023
Epoch 37
Loss = 8.5491e-02, PNorm = 35.2068, GNorm = 2.1104, lr_0 = 2.1493e-04
Validation rmse = 0.145675
Validation r2 = 0.821903
Validation mse = 0.021221
Epoch 38
Loss = 7.6278e-02, PNorm = 35.2124, GNorm = 2.5833, lr_0 = 2.0656e-04
Validation rmse = 0.147243
Validation r2 = 0.818049
Validation mse = 0.021680
Epoch 39
Loss = 1.2021e-01, PNorm = 35.2191, GNorm = 0.7989, lr_0 = 1.9852e-04
Loss = 8.6136e-02, PNorm = 35.2255, GNorm = 1.4988, lr_0 = 1.9148e-04
Validation rmse = 0.142261
Validation r2 = 0.830152
Validation mse = 0.020238
Epoch 40
Loss = 9.2786e-02, PNorm = 35.2306, GNorm = 0.8516, lr_0 = 1.8470e-04
Validation rmse = 0.141373
Validation r2 = 0.832266
Validation mse = 0.019986
Epoch 41
Loss = 8.5569e-02, PNorm = 35.2366, GNorm = 1.1295, lr_0 = 1.7751e-04
Validation rmse = 0.141020
Validation r2 = 0.833103
Validation mse = 0.019887
Epoch 42
Loss = 8.8034e-02, PNorm = 35.2422, GNorm = 0.8481, lr_0 = 1.7060e-04
Validation rmse = 0.141154
Validation r2 = 0.832786
Validation mse = 0.019924
Epoch 43
Loss = 8.7854e-02, PNorm = 35.2464, GNorm = 0.8086, lr_0 = 1.6455e-04
Validation rmse = 0.143581
Validation r2 = 0.826986
Validation mse = 0.020616
Epoch 44
Loss = 8.6521e-02, PNorm = 35.2513, GNorm = 1.9266, lr_0 = 1.5815e-04
Validation rmse = 0.146543
Validation r2 = 0.819773
Validation mse = 0.021475
Epoch 45
Loss = 1.0712e-01, PNorm = 35.2558, GNorm = 0.8186, lr_0 = 1.5199e-04
Validation rmse = 0.141458
Validation r2 = 0.832063
Validation mse = 0.020010
Epoch 46
Loss = 8.9218e-02, PNorm = 35.2600, GNorm = 0.7922, lr_0 = 1.4608e-04
Loss = 8.3573e-02, PNorm = 35.2639, GNorm = 0.8917, lr_0 = 1.4090e-04
Validation rmse = 0.141821
Validation r2 = 0.831201
Validation mse = 0.020113
Epoch 47
Loss = 8.2249e-02, PNorm = 35.2682, GNorm = 0.6966, lr_0 = 1.3590e-04
Validation rmse = 0.143229
Validation r2 = 0.827833
Validation mse = 0.020515
Epoch 48
Loss = 8.7630e-02, PNorm = 35.2726, GNorm = 1.3112, lr_0 = 1.3061e-04
Validation rmse = 0.142190
Validation r2 = 0.830321
Validation mse = 0.020218
Epoch 49
Loss = 7.6010e-02, PNorm = 35.2774, GNorm = 0.6813, lr_0 = 1.2553e-04
Validation rmse = 0.146269
Validation r2 = 0.820448
Validation mse = 0.021395
Epoch 50
Loss = 8.0174e-02, PNorm = 35.2806, GNorm = 0.5860, lr_0 = 1.2108e-04
Validation rmse = 0.144190
Validation r2 = 0.825515
Validation mse = 0.020791
Epoch 51
Loss = 8.2375e-02, PNorm = 35.2852, GNorm = 0.7410, lr_0 = 1.1637e-04
Validation rmse = 0.141842
Validation r2 = 0.831151
Validation mse = 0.020119
Epoch 52
Loss = 8.8853e-02, PNorm = 35.2889, GNorm = 0.8259, lr_0 = 1.1184e-04
Validation rmse = 0.141295
Validation r2 = 0.832451
Validation mse = 0.019964
Epoch 53
Loss = 8.5976e-02, PNorm = 35.2922, GNorm = 1.0345, lr_0 = 1.0749e-04
Validation rmse = 0.141617
Validation r2 = 0.831687
Validation mse = 0.020055
Epoch 54
Loss = 5.2239e-02, PNorm = 35.2954, GNorm = 0.4285, lr_0 = 1.0367e-04
Loss = 8.4034e-02, PNorm = 35.2982, GNorm = 1.8327, lr_0 = 1.0000e-04
Loss = 8.9060e-02, PNorm = 35.2985, GNorm = 2.6649, lr_0 = 1.0000e-04
Validation rmse = 0.143678
Validation r2 = 0.826751
Validation mse = 0.020643
Epoch 55
Loss = 7.8365e-02, PNorm = 35.3017, GNorm = 0.5240, lr_0 = 1.0000e-04
Validation rmse = 0.140836
Validation r2 = 0.833539
Validation mse = 0.019835
Epoch 56
Loss = 7.6079e-02, PNorm = 35.3042, GNorm = 0.6551, lr_0 = 1.0000e-04
Validation rmse = 0.143773
Validation r2 = 0.826522
Validation mse = 0.020671
Epoch 57
Loss = 7.6974e-02, PNorm = 35.3078, GNorm = 0.7938, lr_0 = 1.0000e-04
Validation rmse = 0.142338
Validation r2 = 0.829968
Validation mse = 0.020260
Epoch 58
Loss = 8.9403e-02, PNorm = 35.3108, GNorm = 0.8130, lr_0 = 1.0000e-04
Validation rmse = 0.141803
Validation r2 = 0.831245
Validation mse = 0.020108
Epoch 59
Loss = 5.9825e-02, PNorm = 35.3145, GNorm = 0.6033, lr_0 = 1.0000e-04
Validation rmse = 0.141546
Validation r2 = 0.831856
Validation mse = 0.020035
Model 0 best validation rmse = 0.140750 on epoch 23
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.158896
Model 0 test r2 = 0.637554
Model 0 test mse = 0.025248
Ensemble test rmse = 0.158896
Ensemble test r2 = 0.637554
Ensemble test mse = 0.025248
Fold 8
Splitting data with seed 8
Total size = 705 | train size = 564 | val size = 141 | test size = 317
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.4379e-01, PNorm = 34.0190, GNorm = 6.5809, lr_0 = 5.5000e-04
Validation rmse = 0.312292
Validation r2 = 0.265048
Validation mse = 0.097526
Epoch 1
Loss = 6.8628e-01, PNorm = 34.0696, GNorm = 7.3425, lr_0 = 1.0000e-03
Validation rmse = 0.290448
Validation r2 = 0.364265
Validation mse = 0.084360
Epoch 2
Loss = 4.8776e-01, PNorm = 34.1423, GNorm = 6.1635, lr_0 = 9.6108e-04
Validation rmse = 0.231656
Validation r2 = 0.595586
Validation mse = 0.053665
Epoch 3
Loss = 4.1132e-01, PNorm = 34.2175, GNorm = 4.4891, lr_0 = 9.2367e-04
Validation rmse = 0.249721
Validation r2 = 0.530052
Validation mse = 0.062361
Epoch 4
Loss = 4.1193e-01, PNorm = 34.2769, GNorm = 5.6876, lr_0 = 8.9093e-04
Validation rmse = 0.216238
Validation r2 = 0.647627
Validation mse = 0.046759
Epoch 5
Loss = 3.0122e-01, PNorm = 34.3283, GNorm = 1.0016, lr_0 = 8.5625e-04
Validation rmse = 0.210454
Validation r2 = 0.666225
Validation mse = 0.044291
Epoch 6
Loss = 2.9046e-01, PNorm = 34.3883, GNorm = 6.9499, lr_0 = 8.2293e-04
Validation rmse = 0.179273
Validation r2 = 0.757802
Validation mse = 0.032139
Epoch 7
Loss = 2.5411e-01, PNorm = 34.4370, GNorm = 1.3246, lr_0 = 7.9090e-04
Loss = 2.3158e-01, PNorm = 34.4782, GNorm = 4.2550, lr_0 = 7.6286e-04
Validation rmse = 0.174781
Validation r2 = 0.769788
Validation mse = 0.030548
Epoch 8
Loss = 2.0992e-01, PNorm = 34.5168, GNorm = 0.9461, lr_0 = 7.3582e-04
Validation rmse = 0.169238
Validation r2 = 0.784158
Validation mse = 0.028642
Epoch 9
Loss = 1.8085e-01, PNorm = 34.5606, GNorm = 1.5030, lr_0 = 7.0718e-04
Validation rmse = 0.178070
Validation r2 = 0.761044
Validation mse = 0.031709
Epoch 10
Loss = 1.7619e-01, PNorm = 34.6035, GNorm = 1.8502, lr_0 = 6.7965e-04
Validation rmse = 0.158571
Validation r2 = 0.810509
Validation mse = 0.025145
Epoch 11
Loss = 1.4228e-01, PNorm = 34.6433, GNorm = 0.9182, lr_0 = 6.5556e-04
Validation rmse = 0.164015
Validation r2 = 0.797275
Validation mse = 0.026901
Epoch 12
Loss = 1.4813e-01, PNorm = 34.6759, GNorm = 0.8424, lr_0 = 6.3005e-04
Validation rmse = 0.190773
Validation r2 = 0.725733
Validation mse = 0.036394
Epoch 13
Loss = 2.2389e-01, PNorm = 34.7059, GNorm = 8.5183, lr_0 = 6.0552e-04
Validation rmse = 0.200395
Validation r2 = 0.697371
Validation mse = 0.040158
Epoch 14
Loss = 1.7318e-01, PNorm = 34.7388, GNorm = 2.4907, lr_0 = 5.8196e-04
Validation rmse = 0.175536
Validation r2 = 0.767796
Validation mse = 0.030813
Epoch 15
Loss = 2.6095e-01, PNorm = 34.7673, GNorm = 5.6974, lr_0 = 5.6133e-04
Loss = 1.5772e-01, PNorm = 34.7926, GNorm = 4.3785, lr_0 = 5.4143e-04
Loss = 1.2081e-01, PNorm = 34.7946, GNorm = 1.5048, lr_0 = 5.3948e-04
Validation rmse = 0.148427
Validation r2 = 0.833978
Validation mse = 0.022031
Epoch 16
Loss = 1.2841e-01, PNorm = 34.8162, GNorm = 0.9785, lr_0 = 5.2036e-04
Validation rmse = 0.149365
Validation r2 = 0.831873
Validation mse = 0.022310
Epoch 17
Loss = 1.4079e-01, PNorm = 34.8378, GNorm = 2.5068, lr_0 = 5.0010e-04
Validation rmse = 0.148148
Validation r2 = 0.834602
Validation mse = 0.021948
Epoch 18
Loss = 1.1887e-01, PNorm = 34.8513, GNorm = 1.9688, lr_0 = 4.8238e-04
Validation rmse = 0.152091
Validation r2 = 0.825681
Validation mse = 0.023132
Epoch 19
Loss = 1.1339e-01, PNorm = 34.8719, GNorm = 1.9718, lr_0 = 4.6360e-04
Validation rmse = 0.153641
Validation r2 = 0.822109
Validation mse = 0.023606
Epoch 20
Loss = 1.1970e-01, PNorm = 34.8882, GNorm = 1.9387, lr_0 = 4.4556e-04
Validation rmse = 0.149936
Validation r2 = 0.830585
Validation mse = 0.022481
Epoch 21
Loss = 8.7410e-02, PNorm = 34.9038, GNorm = 0.6010, lr_0 = 4.2821e-04
Validation rmse = 0.150986
Validation r2 = 0.828205
Validation mse = 0.022797
Epoch 22
Loss = 9.9251e-02, PNorm = 34.9151, GNorm = 2.6086, lr_0 = 4.1304e-04
Validation rmse = 0.148341
Validation r2 = 0.834170
Validation mse = 0.022005
Epoch 23
Loss = 1.0441e-01, PNorm = 34.9277, GNorm = 1.7772, lr_0 = 3.9696e-04
Loss = 1.1881e-01, PNorm = 34.9387, GNorm = 1.3712, lr_0 = 3.8289e-04
Loss = 4.3968e-02, PNorm = 34.9394, GNorm = 1.4769, lr_0 = 3.8151e-04
Validation rmse = 0.154712
Validation r2 = 0.819622
Validation mse = 0.023936
Epoch 24
Loss = 1.1664e-01, PNorm = 34.9497, GNorm = 1.4801, lr_0 = 3.6799e-04
Validation rmse = 0.158453
Validation r2 = 0.810792
Validation mse = 0.025107
Epoch 25
Loss = 1.0071e-01, PNorm = 34.9635, GNorm = 0.8317, lr_0 = 3.5494e-04
Validation rmse = 0.145664
Validation r2 = 0.840102
Validation mse = 0.021218
Epoch 26
Loss = 1.0437e-01, PNorm = 34.9755, GNorm = 1.1362, lr_0 = 3.4113e-04
Validation rmse = 0.146583
Validation r2 = 0.838078
Validation mse = 0.021487
Epoch 27
Loss = 1.0085e-01, PNorm = 34.9866, GNorm = 0.4485, lr_0 = 3.2785e-04
Validation rmse = 0.152648
Validation r2 = 0.824402
Validation mse = 0.023301
Epoch 28
Loss = 1.1433e-01, PNorm = 34.9959, GNorm = 1.6496, lr_0 = 3.1509e-04
Validation rmse = 0.145841
Validation r2 = 0.839712
Validation mse = 0.021270
Epoch 29
Loss = 1.2016e-01, PNorm = 35.0075, GNorm = 0.9431, lr_0 = 3.0392e-04
Validation rmse = 0.153195
Validation r2 = 0.823141
Validation mse = 0.023469
Epoch 30
Loss = 8.5555e-02, PNorm = 35.0166, GNorm = 3.2191, lr_0 = 2.9209e-04
Validation rmse = 0.147466
Validation r2 = 0.836122
Validation mse = 0.021746
Epoch 31
Loss = 9.8645e-02, PNorm = 35.0259, GNorm = 2.4556, lr_0 = 2.8072e-04
Loss = 1.0342e-01, PNorm = 35.0332, GNorm = 1.0239, lr_0 = 2.7077e-04
Loss = 5.0852e-02, PNorm = 35.0342, GNorm = 2.2457, lr_0 = 2.6980e-04
Validation rmse = 0.146944
Validation r2 = 0.837280
Validation mse = 0.021592
Epoch 32
Loss = 1.0455e-01, PNorm = 35.0425, GNorm = 0.4294, lr_0 = 2.6023e-04
Validation rmse = 0.149013
Validation r2 = 0.832666
Validation mse = 0.022205
Epoch 33
Loss = 1.0879e-01, PNorm = 35.0505, GNorm = 2.0860, lr_0 = 2.5101e-04
Validation rmse = 0.143595
Validation r2 = 0.844611
Validation mse = 0.020620
Epoch 34
Loss = 1.0164e-01, PNorm = 35.0594, GNorm = 1.5615, lr_0 = 2.4124e-04
Validation rmse = 0.146047
Validation r2 = 0.839261
Validation mse = 0.021330
Epoch 35
Loss = 1.0029e-01, PNorm = 35.0675, GNorm = 2.4085, lr_0 = 2.3185e-04
Validation rmse = 0.142674
Validation r2 = 0.846599
Validation mse = 0.020356
Epoch 36
Loss = 8.4662e-02, PNorm = 35.0747, GNorm = 0.7918, lr_0 = 2.2363e-04
Validation rmse = 0.146508
Validation r2 = 0.838244
Validation mse = 0.021465
Epoch 37
Loss = 7.7504e-02, PNorm = 35.0824, GNorm = 3.1013, lr_0 = 2.1493e-04
Validation rmse = 0.144832
Validation r2 = 0.841923
Validation mse = 0.020976
Epoch 38
Loss = 7.2246e-02, PNorm = 35.0902, GNorm = 1.6540, lr_0 = 2.0656e-04
Validation rmse = 0.142259
Validation r2 = 0.847491
Validation mse = 0.020238
Epoch 39
Loss = 9.7475e-02, PNorm = 35.0983, GNorm = 0.5468, lr_0 = 1.9852e-04
Loss = 9.1152e-02, PNorm = 35.1030, GNorm = 0.8676, lr_0 = 1.9148e-04
Validation rmse = 0.144767
Validation r2 = 0.842065
Validation mse = 0.020958
Epoch 40
Loss = 1.0368e-01, PNorm = 35.1084, GNorm = 0.4656, lr_0 = 1.8470e-04
Validation rmse = 0.141594
Validation r2 = 0.848913
Validation mse = 0.020049
Epoch 41
Loss = 1.0614e-01, PNorm = 35.1151, GNorm = 1.3839, lr_0 = 1.7751e-04
Validation rmse = 0.142973
Validation r2 = 0.845954
Validation mse = 0.020441
Epoch 42
Loss = 9.1950e-02, PNorm = 35.1201, GNorm = 1.5986, lr_0 = 1.7060e-04
Validation rmse = 0.142463
Validation r2 = 0.847053
Validation mse = 0.020296
Epoch 43
Loss = 8.4022e-02, PNorm = 35.1255, GNorm = 0.6641, lr_0 = 1.6455e-04
Validation rmse = 0.142272
Validation r2 = 0.847463
Validation mse = 0.020241
Epoch 44
Loss = 8.0187e-02, PNorm = 35.1306, GNorm = 1.0335, lr_0 = 1.5815e-04
Validation rmse = 0.142092
Validation r2 = 0.847849
Validation mse = 0.020190
Epoch 45
Loss = 8.6027e-02, PNorm = 35.1358, GNorm = 0.8506, lr_0 = 1.5199e-04
Validation rmse = 0.142541
Validation r2 = 0.846885
Validation mse = 0.020318
Epoch 46
Loss = 7.2375e-02, PNorm = 35.1412, GNorm = 1.0564, lr_0 = 1.4608e-04
Loss = 8.6010e-02, PNorm = 35.1457, GNorm = 1.7325, lr_0 = 1.4090e-04
Validation rmse = 0.142025
Validation r2 = 0.847990
Validation mse = 0.020171
Epoch 47
Loss = 8.6350e-02, PNorm = 35.1496, GNorm = 1.3239, lr_0 = 1.3590e-04
Validation rmse = 0.142181
Validation r2 = 0.847657
Validation mse = 0.020215
Epoch 48
Loss = 9.4714e-02, PNorm = 35.1531, GNorm = 0.4416, lr_0 = 1.3061e-04
Validation rmse = 0.141651
Validation r2 = 0.848792
Validation mse = 0.020065
Epoch 49
Loss = 9.2499e-02, PNorm = 35.1576, GNorm = 1.3250, lr_0 = 1.2553e-04
Validation rmse = 0.142426
Validation r2 = 0.847132
Validation mse = 0.020285
Epoch 50
Loss = 7.6450e-02, PNorm = 35.1614, GNorm = 0.3853, lr_0 = 1.2108e-04
Validation rmse = 0.141299
Validation r2 = 0.849541
Validation mse = 0.019965
Epoch 51
Loss = 9.0417e-02, PNorm = 35.1659, GNorm = 1.0541, lr_0 = 1.1637e-04
Validation rmse = 0.142652
Validation r2 = 0.846647
Validation mse = 0.020349
Epoch 52
Loss = 8.4233e-02, PNorm = 35.1704, GNorm = 0.6885, lr_0 = 1.1184e-04
Validation rmse = 0.143536
Validation r2 = 0.844739
Validation mse = 0.020603
Epoch 53
Loss = 9.0397e-02, PNorm = 35.1741, GNorm = 1.6213, lr_0 = 1.0749e-04
Validation rmse = 0.142020
Validation r2 = 0.848003
Validation mse = 0.020170
Epoch 54
Loss = 8.2574e-02, PNorm = 35.1770, GNorm = 1.0933, lr_0 = 1.0367e-04
Loss = 8.2000e-02, PNorm = 35.1802, GNorm = 0.5074, lr_0 = 1.0000e-04
Loss = 6.4073e-02, PNorm = 35.1805, GNorm = 1.6130, lr_0 = 1.0000e-04
Validation rmse = 0.140849
Validation r2 = 0.850498
Validation mse = 0.019839
Epoch 55
Loss = 8.3441e-02, PNorm = 35.1832, GNorm = 1.0913, lr_0 = 1.0000e-04
Validation rmse = 0.141356
Validation r2 = 0.849420
Validation mse = 0.019982
Epoch 56
Loss = 7.8176e-02, PNorm = 35.1863, GNorm = 1.9162, lr_0 = 1.0000e-04
Validation rmse = 0.140840
Validation r2 = 0.850516
Validation mse = 0.019836
Epoch 57
Loss = 8.4013e-02, PNorm = 35.1901, GNorm = 0.5238, lr_0 = 1.0000e-04
Validation rmse = 0.146432
Validation r2 = 0.838410
Validation mse = 0.021442
Epoch 58
Loss = 8.6187e-02, PNorm = 35.1932, GNorm = 1.0560, lr_0 = 1.0000e-04
Validation rmse = 0.141365
Validation r2 = 0.849402
Validation mse = 0.019984
Epoch 59
Loss = 7.7648e-02, PNorm = 35.1963, GNorm = 1.9538, lr_0 = 1.0000e-04
Validation rmse = 0.141028
Validation r2 = 0.850117
Validation mse = 0.019889
Model 0 best validation rmse = 0.140840 on epoch 56
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.159890
Model 0 test r2 = 0.633008
Model 0 test mse = 0.025565
Ensemble test rmse = 0.159890
Ensemble test r2 = 0.633008
Ensemble test mse = 0.025565
Fold 9
Splitting data with seed 9
Total size = 705 | train size = 564 | val size = 141 | test size = 317
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.2911e-01, PNorm = 34.0197, GNorm = 1.2036, lr_0 = 5.5000e-04
Validation rmse = 0.347988
Validation r2 = 0.078681
Validation mse = 0.121096
Epoch 1
Loss = 6.6691e-01, PNorm = 34.0761, GNorm = 13.9056, lr_0 = 1.0000e-03
Validation rmse = 0.302983
Validation r2 = 0.301580
Validation mse = 0.091798
Epoch 2
Loss = 4.7454e-01, PNorm = 34.1455, GNorm = 2.3658, lr_0 = 9.6108e-04
Validation rmse = 0.239906
Validation r2 = 0.562113
Validation mse = 0.057555
Epoch 3
Loss = 3.9455e-01, PNorm = 34.2182, GNorm = 4.5198, lr_0 = 9.2367e-04
Validation rmse = 0.239547
Validation r2 = 0.563421
Validation mse = 0.057383
Epoch 4
Loss = 3.4384e-01, PNorm = 34.2730, GNorm = 5.3462, lr_0 = 8.9093e-04
Validation rmse = 0.216171
Validation r2 = 0.644469
Validation mse = 0.046730
Epoch 5
Loss = 2.9723e-01, PNorm = 34.3295, GNorm = 3.9168, lr_0 = 8.5625e-04
Validation rmse = 0.231831
Validation r2 = 0.591092
Validation mse = 0.053746
Epoch 6
Loss = 2.1803e-01, PNorm = 34.3780, GNorm = 2.4285, lr_0 = 8.2293e-04
Validation rmse = 0.265380
Validation r2 = 0.464182
Validation mse = 0.070427
Epoch 7
Loss = 3.9480e-01, PNorm = 34.4150, GNorm = 7.3829, lr_0 = 7.9090e-04
Loss = 3.0414e-01, PNorm = 34.4563, GNorm = 4.8600, lr_0 = 7.6286e-04
Validation rmse = 0.213577
Validation r2 = 0.652951
Validation mse = 0.045615
Epoch 8
Loss = 2.7628e-01, PNorm = 34.4909, GNorm = 3.0411, lr_0 = 7.3582e-04
Validation rmse = 0.208619
Validation r2 = 0.668878
Validation mse = 0.043522
Epoch 9
Loss = 2.4398e-01, PNorm = 34.5291, GNorm = 2.0504, lr_0 = 7.0718e-04
Validation rmse = 0.189519
Validation r2 = 0.726734
Validation mse = 0.035917
Epoch 10
Loss = 2.0377e-01, PNorm = 34.5657, GNorm = 3.4729, lr_0 = 6.7965e-04
Validation rmse = 0.192541
Validation r2 = 0.717949
Validation mse = 0.037072
Epoch 11
Loss = 1.7678e-01, PNorm = 34.5972, GNorm = 1.7873, lr_0 = 6.5556e-04
Validation rmse = 0.180860
Validation r2 = 0.751133
Validation mse = 0.032710
Epoch 12
Loss = 1.6770e-01, PNorm = 34.6297, GNorm = 0.8562, lr_0 = 6.3005e-04
Validation rmse = 0.173373
Validation r2 = 0.771311
Validation mse = 0.030058
Epoch 13
Loss = 1.4372e-01, PNorm = 34.6619, GNorm = 1.8333, lr_0 = 6.0552e-04
Validation rmse = 0.163389
Validation r2 = 0.796893
Validation mse = 0.026696
Epoch 14
Loss = 1.3491e-01, PNorm = 34.6887, GNorm = 0.5751, lr_0 = 5.8196e-04
Validation rmse = 0.169122
Validation r2 = 0.782388
Validation mse = 0.028602
Epoch 15
Loss = 7.0371e-02, PNorm = 34.7136, GNorm = 1.0381, lr_0 = 5.6133e-04
Loss = 1.4530e-01, PNorm = 34.7380, GNorm = 1.0966, lr_0 = 5.4143e-04
Loss = 2.3124e-01, PNorm = 34.7409, GNorm = 2.0262, lr_0 = 5.3948e-04
Validation rmse = 0.158502
Validation r2 = 0.808860
Validation mse = 0.025123
Epoch 16
Loss = 1.3564e-01, PNorm = 34.7680, GNorm = 1.4195, lr_0 = 5.2036e-04
Validation rmse = 0.159466
Validation r2 = 0.806529
Validation mse = 0.025429
Epoch 17
Loss = 1.1970e-01, PNorm = 34.7924, GNorm = 0.8034, lr_0 = 5.0010e-04
Validation rmse = 0.163958
Validation r2 = 0.795474
Validation mse = 0.026882
Epoch 18
Loss = 1.2312e-01, PNorm = 34.8133, GNorm = 0.7383, lr_0 = 4.8238e-04
Validation rmse = 0.156998
Validation r2 = 0.812471
Validation mse = 0.024648
Epoch 19
Loss = 1.3054e-01, PNorm = 34.8332, GNorm = 3.4085, lr_0 = 4.6360e-04
Validation rmse = 0.154317
Validation r2 = 0.818820
Validation mse = 0.023814
Epoch 20
Loss = 1.1279e-01, PNorm = 34.8550, GNorm = 0.7727, lr_0 = 4.4556e-04
Validation rmse = 0.159448
Validation r2 = 0.806573
Validation mse = 0.025424
Epoch 21
Loss = 1.2088e-01, PNorm = 34.8732, GNorm = 2.0069, lr_0 = 4.2821e-04
Validation rmse = 0.158094
Validation r2 = 0.809843
Validation mse = 0.024994
Epoch 22
Loss = 1.0100e-01, PNorm = 34.8904, GNorm = 1.6892, lr_0 = 4.1304e-04
Validation rmse = 0.151804
Validation r2 = 0.824674
Validation mse = 0.023044
Epoch 23
Loss = 1.2279e-01, PNorm = 34.9078, GNorm = 1.1250, lr_0 = 3.9696e-04
Loss = 1.0308e-01, PNorm = 34.9212, GNorm = 1.4120, lr_0 = 3.8289e-04
Loss = 1.5431e-01, PNorm = 34.9221, GNorm = 1.5394, lr_0 = 3.8151e-04
Validation rmse = 0.150262
Validation r2 = 0.828218
Validation mse = 0.022579
Epoch 24
Loss = 1.0399e-01, PNorm = 34.9342, GNorm = 2.6141, lr_0 = 3.6799e-04
Validation rmse = 0.152671
Validation r2 = 0.822666
Validation mse = 0.023308
Epoch 25
Loss = 1.0762e-01, PNorm = 34.9457, GNorm = 0.9001, lr_0 = 3.5494e-04
Validation rmse = 0.151228
Validation r2 = 0.826002
Validation mse = 0.022870
Epoch 26
Loss = 9.3175e-02, PNorm = 34.9574, GNorm = 1.7583, lr_0 = 3.4113e-04
Validation rmse = 0.170351
Validation r2 = 0.779216
Validation mse = 0.029019
Epoch 27
Loss = 1.0246e-01, PNorm = 34.9714, GNorm = 1.5402, lr_0 = 3.2785e-04
Validation rmse = 0.150784
Validation r2 = 0.827022
Validation mse = 0.022736
Epoch 28
Loss = 1.0968e-01, PNorm = 34.9846, GNorm = 3.3206, lr_0 = 3.1509e-04
Validation rmse = 0.150881
Validation r2 = 0.826798
Validation mse = 0.022765
Epoch 29
Loss = 1.0094e-01, PNorm = 34.9962, GNorm = 0.5552, lr_0 = 3.0392e-04
Validation rmse = 0.159317
Validation r2 = 0.806890
Validation mse = 0.025382
Epoch 30
Loss = 7.5726e-02, PNorm = 35.0090, GNorm = 3.1263, lr_0 = 2.9209e-04
Validation rmse = 0.149522
Validation r2 = 0.829904
Validation mse = 0.022357
Epoch 31
Loss = 5.8267e-02, PNorm = 35.0197, GNorm = 1.1516, lr_0 = 2.8072e-04
Loss = 1.0057e-01, PNorm = 35.0278, GNorm = 1.3985, lr_0 = 2.7077e-04
Loss = 9.8243e-02, PNorm = 35.0283, GNorm = 3.4873, lr_0 = 2.6980e-04
Validation rmse = 0.154065
Validation r2 = 0.819411
Validation mse = 0.023736
Epoch 32
Loss = 9.8121e-02, PNorm = 35.0385, GNorm = 0.6826, lr_0 = 2.6023e-04
Validation rmse = 0.150680
Validation r2 = 0.827261
Validation mse = 0.022704
Epoch 33
Loss = 8.6967e-02, PNorm = 35.0457, GNorm = 1.4416, lr_0 = 2.5101e-04
Validation rmse = 0.151627
Validation r2 = 0.825082
Validation mse = 0.022991
Epoch 34
Loss = 7.9934e-02, PNorm = 35.0562, GNorm = 1.0411, lr_0 = 2.4124e-04
Validation rmse = 0.151233
Validation r2 = 0.825991
Validation mse = 0.022871
Epoch 35
Loss = 9.6434e-02, PNorm = 35.0669, GNorm = 0.6249, lr_0 = 2.3185e-04
Validation rmse = 0.146662
Validation r2 = 0.836350
Validation mse = 0.021510
Epoch 36
Loss = 8.5385e-02, PNorm = 35.0745, GNorm = 0.9399, lr_0 = 2.2363e-04
Validation rmse = 0.148290
Validation r2 = 0.832697
Validation mse = 0.021990
Epoch 37
Loss = 1.0318e-01, PNorm = 35.0821, GNorm = 1.8523, lr_0 = 2.1493e-04
Validation rmse = 0.148030
Validation r2 = 0.833284
Validation mse = 0.021913
Epoch 38
Loss = 8.0257e-02, PNorm = 35.0901, GNorm = 2.0934, lr_0 = 2.0656e-04
Validation rmse = 0.146957
Validation r2 = 0.835691
Validation mse = 0.021596
Epoch 39
Loss = 7.5953e-02, PNorm = 35.0960, GNorm = 1.7119, lr_0 = 1.9852e-04
Loss = 9.1211e-02, PNorm = 35.1013, GNorm = 1.1013, lr_0 = 1.9148e-04
Validation rmse = 0.148680
Validation r2 = 0.831815
Validation mse = 0.022106
Epoch 40
Loss = 8.2594e-02, PNorm = 35.1076, GNorm = 0.6608, lr_0 = 1.8470e-04
Validation rmse = 0.148591
Validation r2 = 0.832016
Validation mse = 0.022079
Epoch 41
Loss = 8.7828e-02, PNorm = 35.1132, GNorm = 1.6978, lr_0 = 1.7751e-04
Validation rmse = 0.149304
Validation r2 = 0.830401
Validation mse = 0.022292
Epoch 42
Loss = 1.0878e-01, PNorm = 35.1185, GNorm = 3.9383, lr_0 = 1.7060e-04
Validation rmse = 0.152390
Validation r2 = 0.823316
Validation mse = 0.023223
Epoch 43
Loss = 9.4009e-02, PNorm = 35.1250, GNorm = 1.5082, lr_0 = 1.6455e-04
Validation rmse = 0.149333
Validation r2 = 0.830335
Validation mse = 0.022300
Epoch 44
Loss = 8.5678e-02, PNorm = 35.1319, GNorm = 1.6680, lr_0 = 1.5815e-04
Validation rmse = 0.148935
Validation r2 = 0.831238
Validation mse = 0.022182
Epoch 45
Loss = 6.9455e-02, PNorm = 35.1373, GNorm = 2.4509, lr_0 = 1.5199e-04
Validation rmse = 0.152189
Validation r2 = 0.823783
Validation mse = 0.023161
Epoch 46
Loss = 8.1377e-02, PNorm = 35.1419, GNorm = 1.7642, lr_0 = 1.4608e-04
Loss = 8.1659e-02, PNorm = 35.1469, GNorm = 1.3887, lr_0 = 1.4090e-04
Validation rmse = 0.148785
Validation r2 = 0.831577
Validation mse = 0.022137
Epoch 47
Loss = 7.6848e-02, PNorm = 35.1523, GNorm = 0.8569, lr_0 = 1.3590e-04
Validation rmse = 0.150437
Validation r2 = 0.827818
Validation mse = 0.022631
Epoch 48
Loss = 8.1735e-02, PNorm = 35.1567, GNorm = 1.6750, lr_0 = 1.3061e-04
Validation rmse = 0.152368
Validation r2 = 0.823369
Validation mse = 0.023216
Epoch 49
Loss = 8.0573e-02, PNorm = 35.1633, GNorm = 2.2384, lr_0 = 1.2553e-04
Validation rmse = 0.150141
Validation r2 = 0.828495
Validation mse = 0.022542
Epoch 50
Loss = 9.1272e-02, PNorm = 35.1661, GNorm = 1.0116, lr_0 = 1.2108e-04
Validation rmse = 0.148489
Validation r2 = 0.832247
Validation mse = 0.022049
Epoch 51
Loss = 8.1911e-02, PNorm = 35.1696, GNorm = 2.0576, lr_0 = 1.1637e-04
Validation rmse = 0.149857
Validation r2 = 0.829141
Validation mse = 0.022457
Epoch 52
Loss = 9.0770e-02, PNorm = 35.1734, GNorm = 1.4370, lr_0 = 1.1184e-04
Validation rmse = 0.153828
Validation r2 = 0.819967
Validation mse = 0.023663
Epoch 53
Loss = 7.0132e-02, PNorm = 35.1772, GNorm = 0.7104, lr_0 = 1.0749e-04
Validation rmse = 0.152981
Validation r2 = 0.821944
Validation mse = 0.023403
Epoch 54
Loss = 8.4173e-02, PNorm = 35.1802, GNorm = 3.0132, lr_0 = 1.0367e-04
Loss = 8.0606e-02, PNorm = 35.1839, GNorm = 0.8899, lr_0 = 1.0000e-04
Loss = 8.5703e-02, PNorm = 35.1842, GNorm = 2.6309, lr_0 = 1.0000e-04
Validation rmse = 0.149979
Validation r2 = 0.828864
Validation mse = 0.022494
Epoch 55
Loss = 7.1895e-02, PNorm = 35.1871, GNorm = 1.0723, lr_0 = 1.0000e-04
Validation rmse = 0.147751
Validation r2 = 0.833911
Validation mse = 0.021830
Epoch 56
Loss = 8.3565e-02, PNorm = 35.1904, GNorm = 0.5136, lr_0 = 1.0000e-04
Validation rmse = 0.147273
Validation r2 = 0.834984
Validation mse = 0.021689
Epoch 57
Loss = 8.1382e-02, PNorm = 35.1940, GNorm = 0.9990, lr_0 = 1.0000e-04
Validation rmse = 0.148116
Validation r2 = 0.833088
Validation mse = 0.021938
Epoch 58
Loss = 7.3827e-02, PNorm = 35.1972, GNorm = 0.9845, lr_0 = 1.0000e-04
Validation rmse = 0.147479
Validation r2 = 0.834521
Validation mse = 0.021750
Epoch 59
Loss = 8.4985e-02, PNorm = 35.2013, GNorm = 0.7185, lr_0 = 1.0000e-04
Validation rmse = 0.147492
Validation r2 = 0.834491
Validation mse = 0.021754
Model 0 best validation rmse = 0.146662 on epoch 35
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.168134
Model 0 test r2 = 0.594184
Model 0 test mse = 0.028269
Ensemble test rmse = 0.168134
Ensemble test r2 = 0.594184
Ensemble test mse = 0.028269
10-fold cross validation
	Seed 0 ==> test rmse = 0.166109
	Seed 0 ==> test r2 = 0.603901
	Seed 0 ==> test mse = 0.027592
	Seed 1 ==> test rmse = 0.180713
	Seed 1 ==> test r2 = 0.531193
	Seed 1 ==> test mse = 0.032657
	Seed 2 ==> test rmse = 0.167278
	Seed 2 ==> test r2 = 0.598308
	Seed 2 ==> test mse = 0.027982
	Seed 3 ==> test rmse = 0.173278
	Seed 3 ==> test r2 = 0.568973
	Seed 3 ==> test mse = 0.030025
	Seed 4 ==> test rmse = 0.160369
	Seed 4 ==> test r2 = 0.630806
	Seed 4 ==> test mse = 0.025718
	Seed 5 ==> test rmse = 0.177941
	Seed 5 ==> test r2 = 0.545464
	Seed 5 ==> test mse = 0.031663
	Seed 6 ==> test rmse = 0.159815
	Seed 6 ==> test r2 = 0.633350
	Seed 6 ==> test mse = 0.025541
	Seed 7 ==> test rmse = 0.158896
	Seed 7 ==> test r2 = 0.637554
	Seed 7 ==> test mse = 0.025248
	Seed 8 ==> test rmse = 0.159890
	Seed 8 ==> test r2 = 0.633008
	Seed 8 ==> test mse = 0.025565
	Seed 9 ==> test rmse = 0.168134
	Seed 9 ==> test r2 = 0.594184
	Seed 9 ==> test mse = 0.028269
Overall test rmse = 0.167242 +/- 0.007487
Overall test r2 = 0.597674 +/- 0.036373
Overall test mse = 0.028026 +/- 0.002534
Elapsed time = 0:05:18
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-1d5c3576-9790-4896-9034-9bb28ba18d8e.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/EtOH_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2', 'mse'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2', 'mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/generalization_3/EtOH_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/EtOH_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 966 | train size = 772 | val size = 194 | test size = 56
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.3126e-01, PNorm = 34.0160, GNorm = 3.6573, lr_0 = 4.3000e-04
Validation rmse = 0.298809
Validation r2 = 0.275349
Validation mse = 0.089287
Epoch 1
Loss = 7.1992e-01, PNorm = 34.0451, GNorm = 2.8509, lr_0 = 7.6000e-04
Loss = 6.4800e-01, PNorm = 34.1011, GNorm = 2.0422, lr_0 = 9.9472e-04
Loss = 8.9903e-01, PNorm = 34.1066, GNorm = 8.2538, lr_0 = 9.9209e-04
Validation rmse = 0.253104
Validation r2 = 0.480077
Validation mse = 0.064062
Epoch 2
Loss = 5.6024e-01, PNorm = 34.1687, GNorm = 2.3572, lr_0 = 9.6618e-04
Validation rmse = 0.212144
Validation r2 = 0.634739
Validation mse = 0.045005
Epoch 3
Loss = 4.4064e-01, PNorm = 34.2343, GNorm = 7.5170, lr_0 = 9.4094e-04
Loss = 4.7192e-01, PNorm = 34.2954, GNorm = 3.1717, lr_0 = 9.1637e-04
Validation rmse = 0.202197
Validation r2 = 0.668189
Validation mse = 0.040884
Epoch 4
Loss = 3.3163e-01, PNorm = 34.3689, GNorm = 1.3390, lr_0 = 8.9007e-04
Validation rmse = 0.176959
Validation r2 = 0.745851
Validation mse = 0.031315
Epoch 5
Loss = 2.4686e-01, PNorm = 34.4275, GNorm = 3.3266, lr_0 = 8.6682e-04
Loss = 2.5863e-01, PNorm = 34.4813, GNorm = 4.5762, lr_0 = 8.4418e-04
Validation rmse = 0.177682
Validation r2 = 0.743771
Validation mse = 0.031571
Epoch 6
Loss = 2.5487e-01, PNorm = 34.5313, GNorm = 5.1026, lr_0 = 8.1996e-04
Validation rmse = 0.149937
Validation r2 = 0.817543
Validation mse = 0.022481
Epoch 7
Loss = 1.5462e-01, PNorm = 34.5750, GNorm = 2.3840, lr_0 = 7.9854e-04
Loss = 2.0331e-01, PNorm = 34.6162, GNorm = 3.3843, lr_0 = 7.7769e-04
Validation rmse = 0.157193
Validation r2 = 0.799457
Validation mse = 0.024710
Epoch 8
Loss = 1.4562e-01, PNorm = 34.6551, GNorm = 1.3723, lr_0 = 7.5537e-04
Validation rmse = 0.148816
Validation r2 = 0.820261
Validation mse = 0.022146
Epoch 9
Loss = 1.0453e-01, PNorm = 34.6922, GNorm = 3.4736, lr_0 = 7.3370e-04
Loss = 1.5695e-01, PNorm = 34.7282, GNorm = 3.4272, lr_0 = 7.1453e-04
Validation rmse = 0.187929
Validation r2 = 0.713364
Validation mse = 0.035317
Epoch 10
Loss = 1.7653e-01, PNorm = 34.7560, GNorm = 1.1279, lr_0 = 6.9587e-04
Validation rmse = 0.156790
Validation r2 = 0.800483
Validation mse = 0.024583
Epoch 11
Loss = 1.7821e-01, PNorm = 34.7820, GNorm = 6.5003, lr_0 = 6.7590e-04
Loss = 1.4033e-01, PNorm = 34.8054, GNorm = 3.4915, lr_0 = 6.5825e-04
Validation rmse = 0.134550
Validation r2 = 0.853071
Validation mse = 0.018104
Epoch 12
Loss = 1.2080e-01, PNorm = 34.8301, GNorm = 3.4265, lr_0 = 6.4106e-04
Loss = 1.3420e-01, PNorm = 34.8503, GNorm = 1.2030, lr_0 = 6.2431e-04
Loss = 1.8093e-01, PNorm = 34.8517, GNorm = 4.9899, lr_0 = 6.2266e-04
Validation rmse = 0.132398
Validation r2 = 0.857734
Validation mse = 0.017529
Epoch 13
Loss = 1.3585e-01, PNorm = 34.8689, GNorm = 3.3214, lr_0 = 6.0640e-04
Validation rmse = 0.130183
Validation r2 = 0.862453
Validation mse = 0.016948
Epoch 14
Loss = 1.0173e-01, PNorm = 34.8838, GNorm = 0.7107, lr_0 = 5.9056e-04
Loss = 1.2089e-01, PNorm = 34.9035, GNorm = 0.5945, lr_0 = 5.7514e-04
Validation rmse = 0.145820
Validation r2 = 0.827425
Validation mse = 0.021264
Epoch 15
Loss = 1.5319e-01, PNorm = 34.9213, GNorm = 0.4831, lr_0 = 5.5863e-04
Validation rmse = 0.130944
Validation r2 = 0.860841
Validation mse = 0.017146
Epoch 16
Loss = 9.6419e-02, PNorm = 34.9362, GNorm = 0.7840, lr_0 = 5.4404e-04
Loss = 1.1693e-01, PNorm = 34.9546, GNorm = 2.2672, lr_0 = 5.2983e-04
Validation rmse = 0.128851
Validation r2 = 0.865253
Validation mse = 0.016603
Epoch 17
Loss = 1.0143e-01, PNorm = 34.9658, GNorm = 1.3255, lr_0 = 5.1463e-04
Validation rmse = 0.129699
Validation r2 = 0.863473
Validation mse = 0.016822
Epoch 18
Loss = 1.2218e-01, PNorm = 34.9839, GNorm = 1.0862, lr_0 = 4.9986e-04
Loss = 9.8866e-02, PNorm = 34.9972, GNorm = 3.4419, lr_0 = 4.8681e-04
Validation rmse = 0.133000
Validation r2 = 0.856436
Validation mse = 0.017689
Epoch 19
Loss = 1.1619e-01, PNorm = 35.0131, GNorm = 1.2855, lr_0 = 4.7409e-04
Validation rmse = 0.126303
Validation r2 = 0.870529
Validation mse = 0.015953
Epoch 20
Loss = 8.7057e-02, PNorm = 35.0274, GNorm = 0.8595, lr_0 = 4.6049e-04
Loss = 1.0928e-01, PNorm = 35.0440, GNorm = 2.0530, lr_0 = 4.4846e-04
Validation rmse = 0.127166
Validation r2 = 0.868756
Validation mse = 0.016171
Epoch 21
Loss = 1.0478e-01, PNorm = 35.0573, GNorm = 0.9414, lr_0 = 4.3675e-04
Validation rmse = 0.132934
Validation r2 = 0.856579
Validation mse = 0.017671
Epoch 22
Loss = 8.0732e-02, PNorm = 35.0713, GNorm = 1.8914, lr_0 = 4.2422e-04
Loss = 1.1605e-01, PNorm = 35.0877, GNorm = 2.8067, lr_0 = 4.1313e-04
Validation rmse = 0.144501
Validation r2 = 0.830533
Validation mse = 0.020881
Epoch 23
Loss = 1.2297e-01, PNorm = 35.1020, GNorm = 3.6388, lr_0 = 4.0234e-04
Loss = 1.1390e-01, PNorm = 35.1159, GNorm = 1.6972, lr_0 = 3.9184e-04
Loss = 7.7299e-02, PNorm = 35.1177, GNorm = 1.9452, lr_0 = 3.9080e-04
Validation rmse = 0.129788
Validation r2 = 0.863288
Validation mse = 0.016845
Epoch 24
Loss = 1.0035e-01, PNorm = 35.1309, GNorm = 2.1003, lr_0 = 3.8059e-04
Validation rmse = 0.127928
Validation r2 = 0.867176
Validation mse = 0.016366
Epoch 25
Loss = 8.7625e-02, PNorm = 35.1433, GNorm = 0.8924, lr_0 = 3.7065e-04
Loss = 1.0121e-01, PNorm = 35.1549, GNorm = 1.4731, lr_0 = 3.6097e-04
Validation rmse = 0.128519
Validation r2 = 0.865948
Validation mse = 0.016517
Epoch 26
Loss = 9.1728e-02, PNorm = 35.1674, GNorm = 1.2830, lr_0 = 3.5061e-04
Validation rmse = 0.127913
Validation r2 = 0.867209
Validation mse = 0.016362
Epoch 27
Loss = 9.9992e-02, PNorm = 35.1799, GNorm = 2.4043, lr_0 = 3.4055e-04
Loss = 9.9003e-02, PNorm = 35.1909, GNorm = 1.0169, lr_0 = 3.3166e-04
Validation rmse = 0.133057
Validation r2 = 0.856314
Validation mse = 0.017704
Epoch 28
Loss = 9.7300e-02, PNorm = 35.2028, GNorm = 0.9624, lr_0 = 3.2299e-04
Validation rmse = 0.127579
Validation r2 = 0.867902
Validation mse = 0.016276
Epoch 29
Loss = 1.0830e-01, PNorm = 35.2174, GNorm = 2.5640, lr_0 = 3.1373e-04
Loss = 1.0225e-01, PNorm = 35.2290, GNorm = 4.0783, lr_0 = 3.0553e-04
Validation rmse = 0.135586
Validation r2 = 0.850798
Validation mse = 0.018384
Epoch 30
Loss = 1.2339e-01, PNorm = 35.2409, GNorm = 3.8200, lr_0 = 2.9755e-04
Validation rmse = 0.131580
Validation r2 = 0.859486
Validation mse = 0.017313
Epoch 31
Loss = 8.5187e-02, PNorm = 35.2515, GNorm = 0.6099, lr_0 = 2.8901e-04
Loss = 1.0022e-01, PNorm = 35.2622, GNorm = 2.0675, lr_0 = 2.8147e-04
Validation rmse = 0.125465
Validation r2 = 0.872243
Validation mse = 0.015741
Epoch 32
Loss = 7.9532e-02, PNorm = 35.2730, GNorm = 0.7778, lr_0 = 2.7411e-04
Validation rmse = 0.125152
Validation r2 = 0.872879
Validation mse = 0.015663
Epoch 33
Loss = 9.9582e-02, PNorm = 35.2832, GNorm = 0.6225, lr_0 = 2.6625e-04
Loss = 9.2068e-02, PNorm = 35.2922, GNorm = 0.4977, lr_0 = 2.5929e-04
Validation rmse = 0.126666
Validation r2 = 0.869784
Validation mse = 0.016044
Epoch 34
Loss = 9.6306e-02, PNorm = 35.3023, GNorm = 2.8030, lr_0 = 2.5185e-04
Loss = 8.0378e-02, PNorm = 35.3106, GNorm = 1.0900, lr_0 = 2.4528e-04
Validation rmse = 0.126554
Validation r2 = 0.870014
Validation mse = 0.016016
Epoch 35
Loss = 8.9455e-02, PNorm = 35.3183, GNorm = 1.8133, lr_0 = 2.3887e-04
Validation rmse = 0.124625
Validation r2 = 0.873948
Validation mse = 0.015531
Epoch 36
Loss = 8.1910e-02, PNorm = 35.3270, GNorm = 0.5392, lr_0 = 2.3202e-04
Loss = 9.0651e-02, PNorm = 35.3334, GNorm = 1.2717, lr_0 = 2.2596e-04
Validation rmse = 0.123841
Validation r2 = 0.875529
Validation mse = 0.015337
Epoch 37
Loss = 8.9136e-02, PNorm = 35.3413, GNorm = 2.3169, lr_0 = 2.2005e-04
Validation rmse = 0.125056
Validation r2 = 0.873073
Validation mse = 0.015639
Epoch 38
Loss = 8.5509e-02, PNorm = 35.3468, GNorm = 0.7500, lr_0 = 2.1374e-04
Loss = 8.5535e-02, PNorm = 35.3550, GNorm = 0.8480, lr_0 = 2.0816e-04
Validation rmse = 0.125730
Validation r2 = 0.871703
Validation mse = 0.015808
Epoch 39
Loss = 8.4014e-02, PNorm = 35.3624, GNorm = 1.0509, lr_0 = 2.0272e-04
Validation rmse = 0.124621
Validation r2 = 0.873955
Validation mse = 0.015530
Epoch 40
Loss = 8.4937e-02, PNorm = 35.3697, GNorm = 3.2364, lr_0 = 1.9690e-04
Loss = 9.1852e-02, PNorm = 35.3759, GNorm = 3.1949, lr_0 = 1.9176e-04
Validation rmse = 0.128244
Validation r2 = 0.866521
Validation mse = 0.016446
Epoch 41
Loss = 9.8877e-02, PNorm = 35.3840, GNorm = 0.9822, lr_0 = 1.8675e-04
Validation rmse = 0.123882
Validation r2 = 0.875446
Validation mse = 0.015347
Epoch 42
Loss = 7.5730e-02, PNorm = 35.3911, GNorm = 1.1366, lr_0 = 1.8139e-04
Loss = 8.1247e-02, PNorm = 35.3973, GNorm = 1.2045, lr_0 = 1.7666e-04
Validation rmse = 0.125986
Validation r2 = 0.871179
Validation mse = 0.015872
Epoch 43
Loss = 7.4925e-02, PNorm = 35.4030, GNorm = 0.8820, lr_0 = 1.7159e-04
Validation rmse = 0.126702
Validation r2 = 0.869711
Validation mse = 0.016053
Epoch 44
Loss = 1.3051e-01, PNorm = 35.4090, GNorm = 0.8953, lr_0 = 1.6710e-04
Loss = 6.9960e-02, PNorm = 35.4143, GNorm = 1.0385, lr_0 = 1.6274e-04
Validation rmse = 0.123299
Validation r2 = 0.876615
Validation mse = 0.015203
Epoch 45
Loss = 8.4213e-02, PNorm = 35.4208, GNorm = 1.0793, lr_0 = 1.5807e-04
Loss = 8.5688e-02, PNorm = 35.4267, GNorm = 4.5327, lr_0 = 1.5394e-04
Validation rmse = 0.125305
Validation r2 = 0.872568
Validation mse = 0.015701
Epoch 46
Loss = 7.8120e-02, PNorm = 35.4326, GNorm = 2.0276, lr_0 = 1.4992e-04
Validation rmse = 0.123356
Validation r2 = 0.876502
Validation mse = 0.015217
Epoch 47
Loss = 8.2151e-02, PNorm = 35.4374, GNorm = 1.1947, lr_0 = 1.4562e-04
Loss = 7.5810e-02, PNorm = 35.4425, GNorm = 0.8321, lr_0 = 1.4182e-04
Validation rmse = 0.124123
Validation r2 = 0.874960
Validation mse = 0.015407
Epoch 48
Loss = 7.5487e-02, PNorm = 35.4486, GNorm = 0.6919, lr_0 = 1.3811e-04
Validation rmse = 0.125766
Validation r2 = 0.871629
Validation mse = 0.015817
Epoch 49
Loss = 7.0602e-02, PNorm = 35.4543, GNorm = 1.1285, lr_0 = 1.3415e-04
Loss = 8.2901e-02, PNorm = 35.4602, GNorm = 2.2980, lr_0 = 1.3064e-04
Validation rmse = 0.125414
Validation r2 = 0.872346
Validation mse = 0.015729
Epoch 50
Loss = 8.7622e-02, PNorm = 35.4655, GNorm = 1.4558, lr_0 = 1.2723e-04
Validation rmse = 0.124983
Validation r2 = 0.873221
Validation mse = 0.015621
Epoch 51
Loss = 7.2844e-02, PNorm = 35.4701, GNorm = 0.9391, lr_0 = 1.2358e-04
Loss = 7.7571e-02, PNorm = 35.4737, GNorm = 2.0794, lr_0 = 1.2035e-04
Validation rmse = 0.123283
Validation r2 = 0.876649
Validation mse = 0.015199
Epoch 52
Loss = 7.1610e-02, PNorm = 35.4801, GNorm = 0.5566, lr_0 = 1.1690e-04
Validation rmse = 0.126214
Validation r2 = 0.870713
Validation mse = 0.015930
Epoch 53
Loss = 6.5829e-02, PNorm = 35.4845, GNorm = 0.7094, lr_0 = 1.1385e-04
Loss = 7.6840e-02, PNorm = 35.4879, GNorm = 0.6750, lr_0 = 1.1087e-04
Validation rmse = 0.124773
Validation r2 = 0.873648
Validation mse = 0.015568
Epoch 54
Loss = 7.8439e-02, PNorm = 35.4920, GNorm = 0.6017, lr_0 = 1.0769e-04
Validation rmse = 0.124280
Validation r2 = 0.874645
Validation mse = 0.015445
Epoch 55
Loss = 5.9082e-02, PNorm = 35.4964, GNorm = 1.5429, lr_0 = 1.0488e-04
Loss = 7.4535e-02, PNorm = 35.4995, GNorm = 0.5647, lr_0 = 1.0214e-04
Validation rmse = 0.123704
Validation r2 = 0.875803
Validation mse = 0.015303
Epoch 56
Loss = 8.4421e-02, PNorm = 35.5038, GNorm = 1.9535, lr_0 = 1.0000e-04
Loss = 6.8691e-02, PNorm = 35.5078, GNorm = 2.2817, lr_0 = 1.0000e-04
Validation rmse = 0.124420
Validation r2 = 0.874362
Validation mse = 0.015480
Epoch 57
Loss = 6.9817e-02, PNorm = 35.5112, GNorm = 0.5957, lr_0 = 1.0000e-04
Validation rmse = 0.123946
Validation r2 = 0.875317
Validation mse = 0.015363
Epoch 58
Loss = 7.7957e-02, PNorm = 35.5151, GNorm = 0.5394, lr_0 = 1.0000e-04
Loss = 7.0391e-02, PNorm = 35.5194, GNorm = 1.2242, lr_0 = 1.0000e-04
Loss = 6.5198e-02, PNorm = 35.5198, GNorm = 1.7854, lr_0 = 1.0000e-04
Validation rmse = 0.124066
Validation r2 = 0.875076
Validation mse = 0.015392
Epoch 59
Loss = 7.2910e-02, PNorm = 35.5235, GNorm = 1.7217, lr_0 = 1.0000e-04
Validation rmse = 0.125069
Validation r2 = 0.873048
Validation mse = 0.015642
Model 0 best validation rmse = 0.123283 on epoch 51
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.166874
Model 0 test r2 = 0.642825
Model 0 test mse = 0.027847
Ensemble test rmse = 0.166874
Ensemble test r2 = 0.642825
Ensemble test mse = 0.027847
Fold 1
Splitting data with seed 1
Total size = 966 | train size = 772 | val size = 194 | test size = 56
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.8845e-01, PNorm = 34.0146, GNorm = 2.2736, lr_0 = 4.3000e-04
Validation rmse = 0.308568
Validation r2 = 0.179302
Validation mse = 0.095214
Epoch 1
Loss = 8.3229e-01, PNorm = 34.0419, GNorm = 6.7128, lr_0 = 7.6000e-04
Loss = 6.6388e-01, PNorm = 34.1000, GNorm = 3.4563, lr_0 = 9.9472e-04
Loss = 7.8221e-01, PNorm = 34.1044, GNorm = 9.6616, lr_0 = 9.9209e-04
Validation rmse = 0.272417
Validation r2 = 0.360336
Validation mse = 0.074211
Epoch 2
Loss = 5.3868e-01, PNorm = 34.1692, GNorm = 1.5565, lr_0 = 9.6618e-04
Validation rmse = 0.218200
Validation r2 = 0.589613
Validation mse = 0.047611
Epoch 3
Loss = 3.6944e-01, PNorm = 34.2567, GNorm = 1.8214, lr_0 = 9.4094e-04
Loss = 3.8736e-01, PNorm = 34.3187, GNorm = 5.3583, lr_0 = 9.1637e-04
Validation rmse = 0.204741
Validation r2 = 0.638678
Validation mse = 0.041919
Epoch 4
Loss = 2.9800e-01, PNorm = 34.3973, GNorm = 0.7280, lr_0 = 8.9007e-04
Validation rmse = 0.190406
Validation r2 = 0.687504
Validation mse = 0.036254
Epoch 5
Loss = 3.3896e-01, PNorm = 34.4521, GNorm = 1.0903, lr_0 = 8.6682e-04
Loss = 2.0426e-01, PNorm = 34.5126, GNorm = 2.0411, lr_0 = 8.4418e-04
Validation rmse = 0.154157
Validation r2 = 0.795163
Validation mse = 0.023764
Epoch 6
Loss = 2.1901e-01, PNorm = 34.5711, GNorm = 3.7925, lr_0 = 8.1996e-04
Validation rmse = 0.183173
Validation r2 = 0.710796
Validation mse = 0.033552
Epoch 7
Loss = 2.4199e-01, PNorm = 34.6170, GNorm = 1.1515, lr_0 = 7.9854e-04
Loss = 2.0780e-01, PNorm = 34.6590, GNorm = 2.9721, lr_0 = 7.7769e-04
Validation rmse = 0.161774
Validation r2 = 0.774421
Validation mse = 0.026171
Epoch 8
Loss = 1.9308e-01, PNorm = 34.7030, GNorm = 1.3565, lr_0 = 7.5537e-04
Validation rmse = 0.178575
Validation r2 = 0.725132
Validation mse = 0.031889
Epoch 9
Loss = 1.9481e-01, PNorm = 34.7348, GNorm = 4.6519, lr_0 = 7.3370e-04
Loss = 1.7160e-01, PNorm = 34.7641, GNorm = 2.8291, lr_0 = 7.1453e-04
Validation rmse = 0.136845
Validation r2 = 0.838586
Validation mse = 0.018727
Epoch 10
Loss = 1.3848e-01, PNorm = 34.7916, GNorm = 1.2098, lr_0 = 6.9587e-04
Validation rmse = 0.140479
Validation r2 = 0.829900
Validation mse = 0.019734
Epoch 11
Loss = 9.1608e-02, PNorm = 34.8182, GNorm = 2.1208, lr_0 = 6.7590e-04
Loss = 1.4693e-01, PNorm = 34.8398, GNorm = 6.0527, lr_0 = 6.5825e-04
Validation rmse = 0.145543
Validation r2 = 0.817415
Validation mse = 0.021183
Epoch 12
Loss = 1.5046e-01, PNorm = 34.8647, GNorm = 4.3162, lr_0 = 6.4106e-04
Loss = 1.3123e-01, PNorm = 34.8891, GNorm = 1.4046, lr_0 = 6.2431e-04
Loss = 1.3680e-01, PNorm = 34.8914, GNorm = 1.1144, lr_0 = 6.2266e-04
Validation rmse = 0.122789
Validation r2 = 0.870042
Validation mse = 0.015077
Epoch 13
Loss = 1.4363e-01, PNorm = 34.9116, GNorm = 3.6437, lr_0 = 6.0640e-04
Validation rmse = 0.125591
Validation r2 = 0.864044
Validation mse = 0.015773
Epoch 14
Loss = 1.0917e-01, PNorm = 34.9287, GNorm = 1.8353, lr_0 = 5.9056e-04
Loss = 1.2048e-01, PNorm = 34.9469, GNorm = 0.8537, lr_0 = 5.7514e-04
Validation rmse = 0.125470
Validation r2 = 0.864305
Validation mse = 0.015743
Epoch 15
Loss = 1.0555e-01, PNorm = 34.9671, GNorm = 0.8717, lr_0 = 5.5863e-04
Validation rmse = 0.124766
Validation r2 = 0.865825
Validation mse = 0.015566
Epoch 16
Loss = 1.3174e-01, PNorm = 34.9817, GNorm = 1.9789, lr_0 = 5.4404e-04
Loss = 1.0422e-01, PNorm = 34.9981, GNorm = 0.6858, lr_0 = 5.2983e-04
Validation rmse = 0.123645
Validation r2 = 0.868224
Validation mse = 0.015288
Epoch 17
Loss = 9.5177e-02, PNorm = 35.0176, GNorm = 0.8589, lr_0 = 5.1463e-04
Validation rmse = 0.125611
Validation r2 = 0.864000
Validation mse = 0.015778
Epoch 18
Loss = 1.1584e-01, PNorm = 35.0312, GNorm = 1.0552, lr_0 = 4.9986e-04
Loss = 1.1686e-01, PNorm = 35.0474, GNorm = 1.4218, lr_0 = 4.8681e-04
Validation rmse = 0.122675
Validation r2 = 0.870283
Validation mse = 0.015049
Epoch 19
Loss = 1.0334e-01, PNorm = 35.0610, GNorm = 0.8410, lr_0 = 4.7409e-04
Validation rmse = 0.120486
Validation r2 = 0.874873
Validation mse = 0.014517
Epoch 20
Loss = 1.2183e-01, PNorm = 35.0754, GNorm = 0.9116, lr_0 = 4.6049e-04
Loss = 9.9735e-02, PNorm = 35.0887, GNorm = 4.2848, lr_0 = 4.4846e-04
Validation rmse = 0.134499
Validation r2 = 0.844073
Validation mse = 0.018090
Epoch 21
Loss = 1.0586e-01, PNorm = 35.1014, GNorm = 4.3360, lr_0 = 4.3675e-04
Validation rmse = 0.123117
Validation r2 = 0.869347
Validation mse = 0.015158
Epoch 22
Loss = 9.7335e-02, PNorm = 35.1147, GNorm = 1.3928, lr_0 = 4.2422e-04
Loss = 9.8126e-02, PNorm = 35.1313, GNorm = 1.3202, lr_0 = 4.1313e-04
Validation rmse = 0.121682
Validation r2 = 0.872376
Validation mse = 0.014806
Epoch 23
Loss = 1.1122e-01, PNorm = 35.1460, GNorm = 1.9605, lr_0 = 4.0234e-04
Loss = 8.7991e-02, PNorm = 35.1582, GNorm = 2.8636, lr_0 = 3.9184e-04
Loss = 1.3488e-01, PNorm = 35.1594, GNorm = 2.5016, lr_0 = 3.9080e-04
Validation rmse = 0.122128
Validation r2 = 0.871438
Validation mse = 0.014915
Epoch 24
Loss = 9.7463e-02, PNorm = 35.1697, GNorm = 0.7890, lr_0 = 3.8059e-04
Validation rmse = 0.127724
Validation r2 = 0.859387
Validation mse = 0.016313
Epoch 25
Loss = 9.4004e-02, PNorm = 35.1804, GNorm = 1.7672, lr_0 = 3.7065e-04
Loss = 1.0039e-01, PNorm = 35.1917, GNorm = 3.3629, lr_0 = 3.6097e-04
Validation rmse = 0.122239
Validation r2 = 0.871204
Validation mse = 0.014942
Epoch 26
Loss = 8.5133e-02, PNorm = 35.2010, GNorm = 0.9366, lr_0 = 3.5061e-04
Validation rmse = 0.118014
Validation r2 = 0.879954
Validation mse = 0.013927
Epoch 27
Loss = 9.4480e-02, PNorm = 35.2124, GNorm = 2.4452, lr_0 = 3.4055e-04
Loss = 9.5570e-02, PNorm = 35.2229, GNorm = 2.0639, lr_0 = 3.3166e-04
Validation rmse = 0.121831
Validation r2 = 0.872064
Validation mse = 0.014843
Epoch 28
Loss = 8.6020e-02, PNorm = 35.2336, GNorm = 0.8210, lr_0 = 3.2299e-04
Validation rmse = 0.119052
Validation r2 = 0.877833
Validation mse = 0.014173
Epoch 29
Loss = 7.7370e-02, PNorm = 35.2421, GNorm = 0.7610, lr_0 = 3.1373e-04
Loss = 9.8902e-02, PNorm = 35.2496, GNorm = 3.0518, lr_0 = 3.0553e-04
Validation rmse = 0.118847
Validation r2 = 0.878253
Validation mse = 0.014125
Epoch 30
Loss = 9.4557e-02, PNorm = 35.2592, GNorm = 1.4822, lr_0 = 2.9755e-04
Validation rmse = 0.121030
Validation r2 = 0.873738
Validation mse = 0.014648
Epoch 31
Loss = 9.7219e-02, PNorm = 35.2697, GNorm = 1.4919, lr_0 = 2.8901e-04
Loss = 8.2794e-02, PNorm = 35.2785, GNorm = 1.5715, lr_0 = 2.8147e-04
Validation rmse = 0.119197
Validation r2 = 0.877534
Validation mse = 0.014208
Epoch 32
Loss = 8.8595e-02, PNorm = 35.2871, GNorm = 0.8751, lr_0 = 2.7411e-04
Validation rmse = 0.129682
Validation r2 = 0.855042
Validation mse = 0.016817
Epoch 33
Loss = 4.8096e-02, PNorm = 35.2940, GNorm = 1.7609, lr_0 = 2.6625e-04
Loss = 9.6653e-02, PNorm = 35.3034, GNorm = 1.4724, lr_0 = 2.5929e-04
Validation rmse = 0.121366
Validation r2 = 0.873036
Validation mse = 0.014730
Epoch 34
Loss = 9.2823e-02, PNorm = 35.3124, GNorm = 2.2178, lr_0 = 2.5185e-04
Loss = 8.3868e-02, PNorm = 35.3209, GNorm = 0.9619, lr_0 = 2.4528e-04
Validation rmse = 0.118544
Validation r2 = 0.878872
Validation mse = 0.014053
Epoch 35
Loss = 8.5332e-02, PNorm = 35.3277, GNorm = 1.1714, lr_0 = 2.3887e-04
Validation rmse = 0.124125
Validation r2 = 0.867198
Validation mse = 0.015407
Epoch 36
Loss = 6.6602e-02, PNorm = 35.3343, GNorm = 0.5911, lr_0 = 2.3202e-04
Loss = 8.7797e-02, PNorm = 35.3396, GNorm = 1.5441, lr_0 = 2.2596e-04
Validation rmse = 0.118459
Validation r2 = 0.879047
Validation mse = 0.014032
Epoch 37
Loss = 8.8722e-02, PNorm = 35.3474, GNorm = 1.3376, lr_0 = 2.2005e-04
Validation rmse = 0.125283
Validation r2 = 0.864709
Validation mse = 0.015696
Epoch 38
Loss = 9.2693e-02, PNorm = 35.3567, GNorm = 0.6106, lr_0 = 2.1374e-04
Loss = 8.7822e-02, PNorm = 35.3642, GNorm = 1.1192, lr_0 = 2.0816e-04
Validation rmse = 0.121390
Validation r2 = 0.872986
Validation mse = 0.014736
Epoch 39
Loss = 7.6035e-02, PNorm = 35.3708, GNorm = 1.2216, lr_0 = 2.0272e-04
Validation rmse = 0.122746
Validation r2 = 0.870134
Validation mse = 0.015067
Epoch 40
Loss = 7.8864e-02, PNorm = 35.3763, GNorm = 0.9468, lr_0 = 1.9690e-04
Loss = 7.6484e-02, PNorm = 35.3815, GNorm = 0.8130, lr_0 = 1.9176e-04
Validation rmse = 0.118123
Validation r2 = 0.879731
Validation mse = 0.013953
Epoch 41
Loss = 7.5768e-02, PNorm = 35.3874, GNorm = 1.1260, lr_0 = 1.8675e-04
Validation rmse = 0.125886
Validation r2 = 0.863405
Validation mse = 0.015847
Epoch 42
Loss = 9.8707e-02, PNorm = 35.3944, GNorm = 2.3006, lr_0 = 1.8139e-04
Loss = 8.0774e-02, PNorm = 35.4005, GNorm = 1.8879, lr_0 = 1.7666e-04
Validation rmse = 0.118464
Validation r2 = 0.879037
Validation mse = 0.014034
Epoch 43
Loss = 8.5806e-02, PNorm = 35.4073, GNorm = 1.7760, lr_0 = 1.7159e-04
Validation rmse = 0.124066
Validation r2 = 0.867325
Validation mse = 0.015392
Epoch 44
Loss = 7.1356e-02, PNorm = 35.4123, GNorm = 0.7921, lr_0 = 1.6710e-04
Loss = 8.0686e-02, PNorm = 35.4176, GNorm = 0.7758, lr_0 = 1.6274e-04
Validation rmse = 0.120492
Validation r2 = 0.874860
Validation mse = 0.014518
Epoch 45
Loss = 8.7774e-02, PNorm = 35.4226, GNorm = 0.6225, lr_0 = 1.5807e-04
Loss = 8.9300e-02, PNorm = 35.4286, GNorm = 3.8081, lr_0 = 1.5394e-04
Validation rmse = 0.127757
Validation r2 = 0.859314
Validation mse = 0.016322
Epoch 46
Loss = 9.2224e-02, PNorm = 35.4342, GNorm = 1.7349, lr_0 = 1.4992e-04
Validation rmse = 0.120701
Validation r2 = 0.874424
Validation mse = 0.014569
Epoch 47
Loss = 8.8767e-02, PNorm = 35.4395, GNorm = 1.7212, lr_0 = 1.4562e-04
Loss = 7.7210e-02, PNorm = 35.4452, GNorm = 1.6079, lr_0 = 1.4182e-04
Validation rmse = 0.117949
Validation r2 = 0.880085
Validation mse = 0.013912
Epoch 48
Loss = 8.1756e-02, PNorm = 35.4500, GNorm = 1.6980, lr_0 = 1.3811e-04
Validation rmse = 0.120709
Validation r2 = 0.874408
Validation mse = 0.014571
Epoch 49
Loss = 6.5393e-02, PNorm = 35.4546, GNorm = 0.4246, lr_0 = 1.3415e-04
Loss = 8.1494e-02, PNorm = 35.4585, GNorm = 0.6550, lr_0 = 1.3064e-04
Validation rmse = 0.119385
Validation r2 = 0.877148
Validation mse = 0.014253
Epoch 50
Loss = 6.8782e-02, PNorm = 35.4618, GNorm = 1.1817, lr_0 = 1.2723e-04
Validation rmse = 0.117995
Validation r2 = 0.879993
Validation mse = 0.013923
Epoch 51
Loss = 8.4825e-02, PNorm = 35.4669, GNorm = 0.7763, lr_0 = 1.2358e-04
Loss = 7.4749e-02, PNorm = 35.4708, GNorm = 0.5580, lr_0 = 1.2035e-04
Validation rmse = 0.120680
Validation r2 = 0.874468
Validation mse = 0.014564
Epoch 52
Loss = 7.4820e-02, PNorm = 35.4747, GNorm = 0.9346, lr_0 = 1.1690e-04
Validation rmse = 0.122293
Validation r2 = 0.871091
Validation mse = 0.014956
Epoch 53
Loss = 7.6856e-02, PNorm = 35.4776, GNorm = 1.8786, lr_0 = 1.1385e-04
Loss = 7.4747e-02, PNorm = 35.4814, GNorm = 1.9014, lr_0 = 1.1087e-04
Validation rmse = 0.119015
Validation r2 = 0.877909
Validation mse = 0.014165
Epoch 54
Loss = 7.0357e-02, PNorm = 35.4848, GNorm = 2.1498, lr_0 = 1.0769e-04
Validation rmse = 0.118351
Validation r2 = 0.879267
Validation mse = 0.014007
Epoch 55
Loss = 5.9057e-02, PNorm = 35.4878, GNorm = 0.3859, lr_0 = 1.0488e-04
Loss = 6.7111e-02, PNorm = 35.4911, GNorm = 1.4809, lr_0 = 1.0214e-04
Validation rmse = 0.128938
Validation r2 = 0.856701
Validation mse = 0.016625
Epoch 56
Loss = 8.9121e-02, PNorm = 35.4947, GNorm = 1.8372, lr_0 = 1.0000e-04
Loss = 7.0936e-02, PNorm = 35.4977, GNorm = 1.2448, lr_0 = 1.0000e-04
Validation rmse = 0.118275
Validation r2 = 0.879421
Validation mse = 0.013989
Epoch 57
Loss = 7.7764e-02, PNorm = 35.5000, GNorm = 1.0059, lr_0 = 1.0000e-04
Validation rmse = 0.117903
Validation r2 = 0.880180
Validation mse = 0.013901
Epoch 58
Loss = 6.5134e-02, PNorm = 35.5037, GNorm = 0.6075, lr_0 = 1.0000e-04
Loss = 7.5816e-02, PNorm = 35.5077, GNorm = 0.9110, lr_0 = 1.0000e-04
Loss = 5.5729e-02, PNorm = 35.5081, GNorm = 0.7238, lr_0 = 1.0000e-04
Validation rmse = 0.118074
Validation r2 = 0.879831
Validation mse = 0.013942
Epoch 59
Loss = 7.5003e-02, PNorm = 35.5119, GNorm = 0.7813, lr_0 = 1.0000e-04
Validation rmse = 0.118561
Validation r2 = 0.878838
Validation mse = 0.014057
Model 0 best validation rmse = 0.117903 on epoch 57
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.162763
Model 0 test r2 = 0.660210
Model 0 test mse = 0.026492
Ensemble test rmse = 0.162763
Ensemble test r2 = 0.660210
Ensemble test mse = 0.026492
Fold 2
Splitting data with seed 2
Total size = 966 | train size = 772 | val size = 194 | test size = 56
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.0012e-01, PNorm = 34.0181, GNorm = 5.7497, lr_0 = 4.3000e-04
Validation rmse = 0.305202
Validation r2 = 0.233474
Validation mse = 0.093148
Epoch 1
Loss = 7.3305e-01, PNorm = 34.0527, GNorm = 7.0216, lr_0 = 7.6000e-04
Loss = 7.2748e-01, PNorm = 34.1014, GNorm = 1.5366, lr_0 = 9.9472e-04
Loss = 5.0953e-01, PNorm = 34.1071, GNorm = 8.7801, lr_0 = 9.9209e-04
Validation rmse = 0.287453
Validation r2 = 0.320036
Validation mse = 0.082629
Epoch 2
Loss = 5.3416e-01, PNorm = 34.1794, GNorm = 1.9844, lr_0 = 9.6618e-04
Validation rmse = 0.196967
Validation r2 = 0.680743
Validation mse = 0.038796
Epoch 3
Loss = 3.6852e-01, PNorm = 34.2529, GNorm = 0.8958, lr_0 = 9.4094e-04
Loss = 3.8117e-01, PNorm = 34.3241, GNorm = 1.2906, lr_0 = 9.1637e-04
Validation rmse = 0.172241
Validation r2 = 0.755867
Validation mse = 0.029667
Epoch 4
Loss = 2.4355e-01, PNorm = 34.3903, GNorm = 3.5646, lr_0 = 8.9007e-04
Validation rmse = 0.171000
Validation r2 = 0.759374
Validation mse = 0.029241
Epoch 5
Loss = 3.2282e-01, PNorm = 34.4500, GNorm = 2.2936, lr_0 = 8.6682e-04
Loss = 2.6247e-01, PNorm = 34.5056, GNorm = 2.8973, lr_0 = 8.4418e-04
Validation rmse = 0.150335
Validation r2 = 0.814017
Validation mse = 0.022601
Epoch 6
Loss = 2.2805e-01, PNorm = 34.5641, GNorm = 1.0650, lr_0 = 8.1996e-04
Validation rmse = 0.166465
Validation r2 = 0.771968
Validation mse = 0.027710
Epoch 7
Loss = 2.6396e-01, PNorm = 34.6018, GNorm = 10.0562, lr_0 = 7.9854e-04
Loss = 2.0702e-01, PNorm = 34.6365, GNorm = 4.5233, lr_0 = 7.7769e-04
Validation rmse = 0.162746
Validation r2 = 0.782042
Validation mse = 0.026486
Epoch 8
Loss = 1.9080e-01, PNorm = 34.6757, GNorm = 2.8542, lr_0 = 7.5537e-04
Validation rmse = 0.138371
Validation r2 = 0.842442
Validation mse = 0.019146
Epoch 9
Loss = 1.2600e-01, PNorm = 34.7103, GNorm = 2.4597, lr_0 = 7.3370e-04
Loss = 1.7890e-01, PNorm = 34.7381, GNorm = 5.1322, lr_0 = 7.1453e-04
Validation rmse = 0.135330
Validation r2 = 0.849292
Validation mse = 0.018314
Epoch 10
Loss = 1.5309e-01, PNorm = 34.7621, GNorm = 1.6125, lr_0 = 6.9587e-04
Validation rmse = 0.129638
Validation r2 = 0.861702
Validation mse = 0.016806
Epoch 11
Loss = 1.2214e-01, PNorm = 34.7926, GNorm = 1.7785, lr_0 = 6.7590e-04
Loss = 1.4447e-01, PNorm = 34.8074, GNorm = 1.0533, lr_0 = 6.5825e-04
Validation rmse = 0.143184
Validation r2 = 0.831289
Validation mse = 0.020502
Epoch 12
Loss = 1.4623e-01, PNorm = 34.8301, GNorm = 2.6741, lr_0 = 6.4106e-04
Loss = 1.4462e-01, PNorm = 34.8461, GNorm = 3.5813, lr_0 = 6.2431e-04
Loss = 3.0848e-01, PNorm = 34.8482, GNorm = 3.4220, lr_0 = 6.2266e-04
Validation rmse = 0.144068
Validation r2 = 0.829199
Validation mse = 0.020756
Epoch 13
Loss = 1.3007e-01, PNorm = 34.8760, GNorm = 2.5148, lr_0 = 6.0640e-04
Validation rmse = 0.136680
Validation r2 = 0.846269
Validation mse = 0.018681
Epoch 14
Loss = 1.5257e-01, PNorm = 34.8921, GNorm = 0.9019, lr_0 = 5.9056e-04
Loss = 1.2508e-01, PNorm = 34.9065, GNorm = 1.2118, lr_0 = 5.7514e-04
Validation rmse = 0.143768
Validation r2 = 0.829911
Validation mse = 0.020669
Epoch 15
Loss = 1.3757e-01, PNorm = 34.9234, GNorm = 4.5984, lr_0 = 5.5863e-04
Validation rmse = 0.153580
Validation r2 = 0.805902
Validation mse = 0.023587
Epoch 16
Loss = 1.1659e-01, PNorm = 34.9375, GNorm = 1.0199, lr_0 = 5.4404e-04
Loss = 1.2326e-01, PNorm = 34.9520, GNorm = 3.4006, lr_0 = 5.2983e-04
Validation rmse = 0.134796
Validation r2 = 0.850477
Validation mse = 0.018170
Epoch 17
Loss = 1.2105e-01, PNorm = 34.9680, GNorm = 1.9084, lr_0 = 5.1463e-04
Validation rmse = 0.150785
Validation r2 = 0.812903
Validation mse = 0.022736
Epoch 18
Loss = 1.2222e-01, PNorm = 34.9836, GNorm = 4.2844, lr_0 = 4.9986e-04
Loss = 1.2500e-01, PNorm = 34.9949, GNorm = 2.4286, lr_0 = 4.8681e-04
Validation rmse = 0.143729
Validation r2 = 0.830002
Validation mse = 0.020658
Epoch 19
Loss = 1.3562e-01, PNorm = 35.0105, GNorm = 3.8720, lr_0 = 4.7409e-04
Validation rmse = 0.144301
Validation r2 = 0.828646
Validation mse = 0.020823
Epoch 20
Loss = 1.1692e-01, PNorm = 35.0211, GNorm = 2.1841, lr_0 = 4.6049e-04
Loss = 1.1801e-01, PNorm = 35.0306, GNorm = 2.3514, lr_0 = 4.4846e-04
Validation rmse = 0.131079
Validation r2 = 0.858609
Validation mse = 0.017182
Epoch 21
Loss = 1.2404e-01, PNorm = 35.0447, GNorm = 4.7448, lr_0 = 4.3675e-04
Validation rmse = 0.129570
Validation r2 = 0.861846
Validation mse = 0.016788
Epoch 22
Loss = 6.5868e-02, PNorm = 35.0575, GNorm = 0.6513, lr_0 = 4.2422e-04
Loss = 1.0371e-01, PNorm = 35.0693, GNorm = 2.1055, lr_0 = 4.1313e-04
Validation rmse = 0.132745
Validation r2 = 0.854993
Validation mse = 0.017621
Epoch 23
Loss = 9.0843e-02, PNorm = 35.0796, GNorm = 1.4823, lr_0 = 4.0234e-04
Loss = 1.0772e-01, PNorm = 35.0923, GNorm = 1.4887, lr_0 = 3.9184e-04
Loss = 1.1667e-01, PNorm = 35.0935, GNorm = 2.2238, lr_0 = 3.9080e-04
Validation rmse = 0.129901
Validation r2 = 0.861140
Validation mse = 0.016874
Epoch 24
Loss = 1.1529e-01, PNorm = 35.1026, GNorm = 3.1391, lr_0 = 3.8059e-04
Validation rmse = 0.128403
Validation r2 = 0.864324
Validation mse = 0.016487
Epoch 25
Loss = 8.9505e-02, PNorm = 35.1134, GNorm = 1.7613, lr_0 = 3.7065e-04
Loss = 1.1239e-01, PNorm = 35.1236, GNorm = 1.0682, lr_0 = 3.6097e-04
Validation rmse = 0.129903
Validation r2 = 0.861136
Validation mse = 0.016875
Epoch 26
Loss = 9.1896e-02, PNorm = 35.1359, GNorm = 3.1550, lr_0 = 3.5061e-04
Validation rmse = 0.130298
Validation r2 = 0.860290
Validation mse = 0.016978
Epoch 27
Loss = 1.0249e-01, PNorm = 35.1445, GNorm = 1.0019, lr_0 = 3.4055e-04
Loss = 9.2693e-02, PNorm = 35.1546, GNorm = 0.6505, lr_0 = 3.3166e-04
Validation rmse = 0.126681
Validation r2 = 0.867938
Validation mse = 0.016048
Epoch 28
Loss = 9.3408e-02, PNorm = 35.1621, GNorm = 0.4957, lr_0 = 3.2299e-04
Validation rmse = 0.130402
Validation r2 = 0.860067
Validation mse = 0.017005
Epoch 29
Loss = 1.0028e-01, PNorm = 35.1703, GNorm = 1.5079, lr_0 = 3.1373e-04
Loss = 1.1294e-01, PNorm = 35.1801, GNorm = 3.3824, lr_0 = 3.0553e-04
Validation rmse = 0.129392
Validation r2 = 0.862226
Validation mse = 0.016742
Epoch 30
Loss = 1.0681e-01, PNorm = 35.1869, GNorm = 3.5347, lr_0 = 2.9755e-04
Validation rmse = 0.142730
Validation r2 = 0.832358
Validation mse = 0.020372
Epoch 31
Loss = 1.0744e-01, PNorm = 35.1977, GNorm = 2.5115, lr_0 = 2.8901e-04
Loss = 1.0759e-01, PNorm = 35.2080, GNorm = 1.1828, lr_0 = 2.8147e-04
Validation rmse = 0.128182
Validation r2 = 0.864791
Validation mse = 0.016431
Epoch 32
Loss = 8.8090e-02, PNorm = 35.2161, GNorm = 1.6078, lr_0 = 2.7411e-04
Validation rmse = 0.127347
Validation r2 = 0.866547
Validation mse = 0.016217
Epoch 33
Loss = 8.5690e-02, PNorm = 35.2239, GNorm = 0.8926, lr_0 = 2.6625e-04
Loss = 8.9111e-02, PNorm = 35.2300, GNorm = 0.5341, lr_0 = 2.5929e-04
Validation rmse = 0.125666
Validation r2 = 0.870047
Validation mse = 0.015792
Epoch 34
Loss = 8.2430e-02, PNorm = 35.2382, GNorm = 1.1488, lr_0 = 2.5185e-04
Loss = 9.7777e-02, PNorm = 35.2442, GNorm = 1.3170, lr_0 = 2.4528e-04
Validation rmse = 0.136749
Validation r2 = 0.846114
Validation mse = 0.018700
Epoch 35
Loss = 8.6848e-02, PNorm = 35.2531, GNorm = 1.6041, lr_0 = 2.3887e-04
Validation rmse = 0.130872
Validation r2 = 0.859056
Validation mse = 0.017128
Epoch 36
Loss = 9.7357e-02, PNorm = 35.2595, GNorm = 0.5172, lr_0 = 2.3202e-04
Loss = 8.2038e-02, PNorm = 35.2653, GNorm = 0.7559, lr_0 = 2.2596e-04
Validation rmse = 0.126783
Validation r2 = 0.867727
Validation mse = 0.016074
Epoch 37
Loss = 9.4046e-02, PNorm = 35.2702, GNorm = 2.5574, lr_0 = 2.2005e-04
Validation rmse = 0.127120
Validation r2 = 0.867022
Validation mse = 0.016159
Epoch 38
Loss = 7.7804e-02, PNorm = 35.2776, GNorm = 0.5742, lr_0 = 2.1374e-04
Loss = 8.6874e-02, PNorm = 35.2824, GNorm = 0.6866, lr_0 = 2.0816e-04
Validation rmse = 0.128593
Validation r2 = 0.863923
Validation mse = 0.016536
Epoch 39
Loss = 8.8406e-02, PNorm = 35.2881, GNorm = 0.5552, lr_0 = 2.0272e-04
Validation rmse = 0.125902
Validation r2 = 0.869558
Validation mse = 0.015851
Epoch 40
Loss = 7.9760e-02, PNorm = 35.2944, GNorm = 1.1156, lr_0 = 1.9690e-04
Loss = 9.1064e-02, PNorm = 35.2992, GNorm = 0.9220, lr_0 = 1.9176e-04
Validation rmse = 0.128002
Validation r2 = 0.865170
Validation mse = 0.016385
Epoch 41
Loss = 8.8825e-02, PNorm = 35.3040, GNorm = 1.6447, lr_0 = 1.8675e-04
Validation rmse = 0.127505
Validation r2 = 0.866216
Validation mse = 0.016257
Epoch 42
Loss = 8.5088e-02, PNorm = 35.3092, GNorm = 0.8043, lr_0 = 1.8139e-04
Loss = 8.5526e-02, PNorm = 35.3152, GNorm = 0.5615, lr_0 = 1.7666e-04
Validation rmse = 0.127143
Validation r2 = 0.866975
Validation mse = 0.016165
Epoch 43
Loss = 9.0264e-02, PNorm = 35.3205, GNorm = 0.6041, lr_0 = 1.7159e-04
Validation rmse = 0.125870
Validation r2 = 0.869625
Validation mse = 0.015843
Epoch 44
Loss = 7.1852e-02, PNorm = 35.3256, GNorm = 0.6507, lr_0 = 1.6710e-04
Loss = 8.4968e-02, PNorm = 35.3300, GNorm = 1.2798, lr_0 = 1.6274e-04
Validation rmse = 0.126869
Validation r2 = 0.867546
Validation mse = 0.016096
Epoch 45
Loss = 7.2888e-02, PNorm = 35.3352, GNorm = 0.9451, lr_0 = 1.5807e-04
Loss = 8.8598e-02, PNorm = 35.3390, GNorm = 1.2590, lr_0 = 1.5394e-04
Validation rmse = 0.128248
Validation r2 = 0.864651
Validation mse = 0.016448
Epoch 46
Loss = 8.0878e-02, PNorm = 35.3431, GNorm = 1.3869, lr_0 = 1.4992e-04
Validation rmse = 0.131389
Validation r2 = 0.857941
Validation mse = 0.017263
Epoch 47
Loss = 8.5662e-02, PNorm = 35.3487, GNorm = 0.9491, lr_0 = 1.4562e-04
Loss = 8.1346e-02, PNorm = 35.3529, GNorm = 0.7193, lr_0 = 1.4182e-04
Validation rmse = 0.126950
Validation r2 = 0.867378
Validation mse = 0.016116
Epoch 48
Loss = 7.7889e-02, PNorm = 35.3572, GNorm = 0.8044, lr_0 = 1.3811e-04
Validation rmse = 0.127627
Validation r2 = 0.865960
Validation mse = 0.016289
Epoch 49
Loss = 8.4200e-02, PNorm = 35.3610, GNorm = 1.7323, lr_0 = 1.3415e-04
Loss = 7.9043e-02, PNorm = 35.3647, GNorm = 1.1922, lr_0 = 1.3064e-04
Validation rmse = 0.126000
Validation r2 = 0.869355
Validation mse = 0.015876
Epoch 50
Loss = 9.0018e-02, PNorm = 35.3682, GNorm = 0.8100, lr_0 = 1.2723e-04
Validation rmse = 0.127181
Validation r2 = 0.866895
Validation mse = 0.016175
Epoch 51
Loss = 7.3070e-02, PNorm = 35.3717, GNorm = 2.1734, lr_0 = 1.2358e-04
Loss = 7.3965e-02, PNorm = 35.3743, GNorm = 1.2705, lr_0 = 1.2035e-04
Validation rmse = 0.126513
Validation r2 = 0.868288
Validation mse = 0.016006
Epoch 52
Loss = 7.5456e-02, PNorm = 35.3786, GNorm = 0.8554, lr_0 = 1.1690e-04
Validation rmse = 0.127200
Validation r2 = 0.866854
Validation mse = 0.016180
Epoch 53
Loss = 7.6064e-02, PNorm = 35.3817, GNorm = 0.7938, lr_0 = 1.1385e-04
Loss = 7.9685e-02, PNorm = 35.3849, GNorm = 1.3672, lr_0 = 1.1087e-04
Validation rmse = 0.125325
Validation r2 = 0.870751
Validation mse = 0.015706
Epoch 54
Loss = 7.4855e-02, PNorm = 35.3882, GNorm = 1.6721, lr_0 = 1.0769e-04
Validation rmse = 0.125955
Validation r2 = 0.869449
Validation mse = 0.015865
Epoch 55
Loss = 1.1630e-01, PNorm = 35.3917, GNorm = 1.0385, lr_0 = 1.0488e-04
Loss = 7.4869e-02, PNorm = 35.3943, GNorm = 0.9203, lr_0 = 1.0214e-04
Validation rmse = 0.125325
Validation r2 = 0.870750
Validation mse = 0.015706
Epoch 56
Loss = 6.6782e-02, PNorm = 35.3979, GNorm = 1.0629, lr_0 = 1.0000e-04
Loss = 8.1376e-02, PNorm = 35.4004, GNorm = 0.7663, lr_0 = 1.0000e-04
Validation rmse = 0.130438
Validation r2 = 0.859989
Validation mse = 0.017014
Epoch 57
Loss = 7.1730e-02, PNorm = 35.4032, GNorm = 0.5724, lr_0 = 1.0000e-04
Validation rmse = 0.128338
Validation r2 = 0.864462
Validation mse = 0.016471
Epoch 58
Loss = 9.2004e-02, PNorm = 35.4069, GNorm = 1.1035, lr_0 = 1.0000e-04
Loss = 6.8460e-02, PNorm = 35.4098, GNorm = 0.6713, lr_0 = 1.0000e-04
Loss = 7.2860e-02, PNorm = 35.4100, GNorm = 0.8074, lr_0 = 1.0000e-04
Validation rmse = 0.126801
Validation r2 = 0.867689
Validation mse = 0.016078
Epoch 59
Loss = 7.9524e-02, PNorm = 35.4133, GNorm = 0.8099, lr_0 = 1.0000e-04
Validation rmse = 0.127663
Validation r2 = 0.865883
Validation mse = 0.016298
Model 0 best validation rmse = 0.125325 on epoch 53
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.179501
Model 0 test r2 = 0.586728
Model 0 test mse = 0.032221
Ensemble test rmse = 0.179501
Ensemble test r2 = 0.586728
Ensemble test mse = 0.032221
Fold 3
Splitting data with seed 3
Total size = 966 | train size = 772 | val size = 194 | test size = 56
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.2407e-01, PNorm = 34.0177, GNorm = 3.9740, lr_0 = 4.3000e-04
Validation rmse = 0.302748
Validation r2 = 0.200293
Validation mse = 0.091656
Epoch 1
Loss = 7.3102e-01, PNorm = 34.0476, GNorm = 3.1194, lr_0 = 7.6000e-04
Loss = 6.4681e-01, PNorm = 34.1112, GNorm = 7.7394, lr_0 = 9.9472e-04
Loss = 3.9860e-01, PNorm = 34.1199, GNorm = 1.4258, lr_0 = 9.9209e-04
Validation rmse = 0.264829
Validation r2 = 0.388072
Validation mse = 0.070134
Epoch 2
Loss = 5.2374e-01, PNorm = 34.1919, GNorm = 3.1598, lr_0 = 9.6618e-04
Validation rmse = 0.197522
Validation r2 = 0.659593
Validation mse = 0.039015
Epoch 3
Loss = 4.8426e-01, PNorm = 34.2624, GNorm = 0.9926, lr_0 = 9.4094e-04
Loss = 3.3397e-01, PNorm = 34.3302, GNorm = 4.2584, lr_0 = 9.1637e-04
Validation rmse = 0.180463
Validation r2 = 0.715851
Validation mse = 0.032567
Epoch 4
Loss = 3.0771e-01, PNorm = 34.3983, GNorm = 5.0335, lr_0 = 8.9007e-04
Validation rmse = 0.223664
Validation r2 = 0.563522
Validation mse = 0.050026
Epoch 5
Loss = 3.5921e-01, PNorm = 34.4487, GNorm = 3.9887, lr_0 = 8.6682e-04
Loss = 3.4225e-01, PNorm = 34.4971, GNorm = 1.4010, lr_0 = 8.4418e-04
Validation rmse = 0.158564
Validation r2 = 0.780631
Validation mse = 0.025142
Epoch 6
Loss = 2.6803e-01, PNorm = 34.5469, GNorm = 6.0541, lr_0 = 8.1996e-04
Validation rmse = 0.160464
Validation r2 = 0.775341
Validation mse = 0.025749
Epoch 7
Loss = 2.1320e-01, PNorm = 34.5917, GNorm = 3.8835, lr_0 = 7.9854e-04
Loss = 2.1655e-01, PNorm = 34.6333, GNorm = 3.5481, lr_0 = 7.7769e-04
Validation rmse = 0.132281
Validation r2 = 0.847327
Validation mse = 0.017498
Epoch 8
Loss = 2.0473e-01, PNorm = 34.6720, GNorm = 1.5202, lr_0 = 7.5537e-04
Validation rmse = 0.138410
Validation r2 = 0.832852
Validation mse = 0.019157
Epoch 9
Loss = 2.5471e-01, PNorm = 34.7086, GNorm = 5.3932, lr_0 = 7.3370e-04
Loss = 1.7451e-01, PNorm = 34.7410, GNorm = 2.1291, lr_0 = 7.1453e-04
Validation rmse = 0.128137
Validation r2 = 0.856742
Validation mse = 0.016419
Epoch 10
Loss = 1.6735e-01, PNorm = 34.7710, GNorm = 1.7382, lr_0 = 6.9587e-04
Validation rmse = 0.133141
Validation r2 = 0.845335
Validation mse = 0.017726
Epoch 11
Loss = 1.6405e-01, PNorm = 34.7972, GNorm = 1.8154, lr_0 = 6.7590e-04
Loss = 1.4787e-01, PNorm = 34.8150, GNorm = 0.5805, lr_0 = 6.5825e-04
Validation rmse = 0.115003
Validation r2 = 0.884605
Validation mse = 0.013226
Epoch 12
Loss = 1.2847e-01, PNorm = 34.8387, GNorm = 3.5968, lr_0 = 6.4106e-04
Loss = 1.5189e-01, PNorm = 34.8646, GNorm = 4.1546, lr_0 = 6.2431e-04
Loss = 1.3904e-01, PNorm = 34.8664, GNorm = 1.1168, lr_0 = 6.2266e-04
Validation rmse = 0.115721
Validation r2 = 0.883160
Validation mse = 0.013391
Epoch 13
Loss = 1.3861e-01, PNorm = 34.8822, GNorm = 1.7371, lr_0 = 6.0640e-04
Validation rmse = 0.111107
Validation r2 = 0.892292
Validation mse = 0.012345
Epoch 14
Loss = 1.8504e-01, PNorm = 34.9091, GNorm = 2.5673, lr_0 = 5.9056e-04
Loss = 1.4696e-01, PNorm = 34.9396, GNorm = 1.5398, lr_0 = 5.7514e-04
Validation rmse = 0.119659
Validation r2 = 0.875073
Validation mse = 0.014318
Epoch 15
Loss = 1.2877e-01, PNorm = 34.9553, GNorm = 1.1300, lr_0 = 5.5863e-04
Validation rmse = 0.117536
Validation r2 = 0.879466
Validation mse = 0.013815
Epoch 16
Loss = 1.2931e-01, PNorm = 34.9765, GNorm = 2.4589, lr_0 = 5.4404e-04
Loss = 1.1585e-01, PNorm = 34.9936, GNorm = 0.7281, lr_0 = 5.2983e-04
Validation rmse = 0.111710
Validation r2 = 0.891119
Validation mse = 0.012479
Epoch 17
Loss = 1.3362e-01, PNorm = 35.0112, GNorm = 4.3018, lr_0 = 5.1463e-04
Validation rmse = 0.130853
Validation r2 = 0.850604
Validation mse = 0.017123
Epoch 18
Loss = 1.4476e-01, PNorm = 35.0287, GNorm = 1.0251, lr_0 = 4.9986e-04
Loss = 1.3729e-01, PNorm = 35.0457, GNorm = 3.3315, lr_0 = 4.8681e-04
Validation rmse = 0.110765
Validation r2 = 0.892953
Validation mse = 0.012269
Epoch 19
Loss = 1.1751e-01, PNorm = 35.0630, GNorm = 1.2896, lr_0 = 4.7409e-04
Validation rmse = 0.125898
Validation r2 = 0.861704
Validation mse = 0.015850
Epoch 20
Loss = 1.0449e-01, PNorm = 35.0823, GNorm = 2.6151, lr_0 = 4.6049e-04
Loss = 1.3972e-01, PNorm = 35.0959, GNorm = 0.9378, lr_0 = 4.4846e-04
Validation rmse = 0.108810
Validation r2 = 0.896699
Validation mse = 0.011840
Epoch 21
Loss = 9.8929e-02, PNorm = 35.1111, GNorm = 1.1715, lr_0 = 4.3675e-04
Validation rmse = 0.110089
Validation r2 = 0.894256
Validation mse = 0.012120
Epoch 22
Loss = 6.8383e-02, PNorm = 35.1243, GNorm = 0.6116, lr_0 = 4.2422e-04
Loss = 1.1682e-01, PNorm = 35.1377, GNorm = 2.9456, lr_0 = 4.1313e-04
Validation rmse = 0.115147
Validation r2 = 0.884316
Validation mse = 0.013259
Epoch 23
Loss = 1.0814e-01, PNorm = 35.1521, GNorm = 2.3605, lr_0 = 4.0234e-04
Loss = 1.0372e-01, PNorm = 35.1631, GNorm = 1.1620, lr_0 = 3.9184e-04
Loss = 7.3625e-02, PNorm = 35.1645, GNorm = 0.9265, lr_0 = 3.9080e-04
Validation rmse = 0.110419
Validation r2 = 0.893621
Validation mse = 0.012192
Epoch 24
Loss = 1.0216e-01, PNorm = 35.1781, GNorm = 0.9255, lr_0 = 3.8059e-04
Validation rmse = 0.108146
Validation r2 = 0.897956
Validation mse = 0.011696
Epoch 25
Loss = 1.0512e-01, PNorm = 35.1892, GNorm = 3.0499, lr_0 = 3.7065e-04
Loss = 1.1269e-01, PNorm = 35.2008, GNorm = 1.0572, lr_0 = 3.6097e-04
Validation rmse = 0.112384
Validation r2 = 0.889802
Validation mse = 0.012630
Epoch 26
Loss = 9.8928e-02, PNorm = 35.2127, GNorm = 0.6626, lr_0 = 3.5061e-04
Validation rmse = 0.113401
Validation r2 = 0.887797
Validation mse = 0.012860
Epoch 27
Loss = 1.1015e-01, PNorm = 35.2266, GNorm = 1.1356, lr_0 = 3.4055e-04
Loss = 1.0210e-01, PNorm = 35.2386, GNorm = 1.2310, lr_0 = 3.3166e-04
Validation rmse = 0.122698
Validation r2 = 0.868646
Validation mse = 0.015055
Epoch 28
Loss = 1.1981e-01, PNorm = 35.2482, GNorm = 2.6966, lr_0 = 3.2299e-04
Validation rmse = 0.115995
Validation r2 = 0.882606
Validation mse = 0.013455
Epoch 29
Loss = 1.1017e-01, PNorm = 35.2613, GNorm = 1.5518, lr_0 = 3.1373e-04
Loss = 9.8386e-02, PNorm = 35.2710, GNorm = 0.6951, lr_0 = 3.0553e-04
Validation rmse = 0.112803
Validation r2 = 0.888978
Validation mse = 0.012725
Epoch 30
Loss = 9.1517e-02, PNorm = 35.2812, GNorm = 1.8578, lr_0 = 2.9755e-04
Validation rmse = 0.110270
Validation r2 = 0.893909
Validation mse = 0.012159
Epoch 31
Loss = 8.1230e-02, PNorm = 35.2921, GNorm = 0.5545, lr_0 = 2.8901e-04
Loss = 9.4921e-02, PNorm = 35.3009, GNorm = 1.1152, lr_0 = 2.8147e-04
Validation rmse = 0.109512
Validation r2 = 0.895361
Validation mse = 0.011993
Epoch 32
Loss = 9.2272e-02, PNorm = 35.3105, GNorm = 0.7473, lr_0 = 2.7411e-04
Validation rmse = 0.109939
Validation r2 = 0.894544
Validation mse = 0.012087
Epoch 33
Loss = 5.6721e-02, PNorm = 35.3204, GNorm = 0.7560, lr_0 = 2.6625e-04
Loss = 9.8181e-02, PNorm = 35.3306, GNorm = 2.1126, lr_0 = 2.5929e-04
Validation rmse = 0.112120
Validation r2 = 0.890318
Validation mse = 0.012571
Epoch 34
Loss = 9.3598e-02, PNorm = 35.3389, GNorm = 1.1702, lr_0 = 2.5185e-04
Loss = 9.5710e-02, PNorm = 35.3476, GNorm = 2.3445, lr_0 = 2.4528e-04
Validation rmse = 0.110542
Validation r2 = 0.893384
Validation mse = 0.012220
Epoch 35
Loss = 8.4143e-02, PNorm = 35.3563, GNorm = 0.7013, lr_0 = 2.3887e-04
Validation rmse = 0.108871
Validation r2 = 0.896583
Validation mse = 0.011853
Epoch 36
Loss = 8.0988e-02, PNorm = 35.3658, GNorm = 1.6000, lr_0 = 2.3202e-04
Loss = 8.9555e-02, PNorm = 35.3736, GNorm = 2.1234, lr_0 = 2.2596e-04
Validation rmse = 0.110693
Validation r2 = 0.893092
Validation mse = 0.012253
Epoch 37
Loss = 8.4902e-02, PNorm = 35.3822, GNorm = 0.9099, lr_0 = 2.2005e-04
Validation rmse = 0.112100
Validation r2 = 0.890357
Validation mse = 0.012566
Epoch 38
Loss = 6.3826e-02, PNorm = 35.3903, GNorm = 0.9248, lr_0 = 2.1374e-04
Loss = 9.0009e-02, PNorm = 35.3972, GNorm = 2.2826, lr_0 = 2.0816e-04
Validation rmse = 0.111230
Validation r2 = 0.892052
Validation mse = 0.012372
Epoch 39
Loss = 9.3206e-02, PNorm = 35.4037, GNorm = 1.8316, lr_0 = 2.0272e-04
Validation rmse = 0.110366
Validation r2 = 0.893722
Validation mse = 0.012181
Epoch 40
Loss = 9.3714e-02, PNorm = 35.4137, GNorm = 0.7038, lr_0 = 1.9690e-04
Loss = 8.1501e-02, PNorm = 35.4200, GNorm = 2.6507, lr_0 = 1.9176e-04
Validation rmse = 0.119245
Validation r2 = 0.875935
Validation mse = 0.014219
Epoch 41
Loss = 8.7401e-02, PNorm = 35.4275, GNorm = 1.7293, lr_0 = 1.8675e-04
Validation rmse = 0.115768
Validation r2 = 0.883066
Validation mse = 0.013402
Epoch 42
Loss = 1.1600e-01, PNorm = 35.4349, GNorm = 2.6830, lr_0 = 1.8139e-04
Loss = 7.7769e-02, PNorm = 35.4404, GNorm = 0.9387, lr_0 = 1.7666e-04
Validation rmse = 0.111779
Validation r2 = 0.890984
Validation mse = 0.012495
Epoch 43
Loss = 8.0891e-02, PNorm = 35.4475, GNorm = 0.7654, lr_0 = 1.7159e-04
Validation rmse = 0.115637
Validation r2 = 0.883330
Validation mse = 0.013372
Epoch 44
Loss = 8.4206e-02, PNorm = 35.4528, GNorm = 0.9702, lr_0 = 1.6710e-04
Loss = 7.6291e-02, PNorm = 35.4583, GNorm = 0.9369, lr_0 = 1.6274e-04
Validation rmse = 0.110971
Validation r2 = 0.892554
Validation mse = 0.012315
Epoch 45
Loss = 7.4276e-02, PNorm = 35.4649, GNorm = 0.7000, lr_0 = 1.5807e-04
Loss = 7.8657e-02, PNorm = 35.4706, GNorm = 1.8141, lr_0 = 1.5394e-04
Validation rmse = 0.110910
Validation r2 = 0.892673
Validation mse = 0.012301
Epoch 46
Loss = 7.9293e-02, PNorm = 35.4756, GNorm = 0.6470, lr_0 = 1.4992e-04
Validation rmse = 0.110872
Validation r2 = 0.892746
Validation mse = 0.012293
Epoch 47
Loss = 7.9294e-02, PNorm = 35.4804, GNorm = 0.8807, lr_0 = 1.4562e-04
Loss = 7.8970e-02, PNorm = 35.4860, GNorm = 1.6201, lr_0 = 1.4182e-04
Validation rmse = 0.113492
Validation r2 = 0.887618
Validation mse = 0.012880
Epoch 48
Loss = 7.6122e-02, PNorm = 35.4916, GNorm = 0.7772, lr_0 = 1.3811e-04
Validation rmse = 0.116082
Validation r2 = 0.882429
Validation mse = 0.013475
Epoch 49
Loss = 8.2301e-02, PNorm = 35.4962, GNorm = 0.8291, lr_0 = 1.3415e-04
Loss = 7.5675e-02, PNorm = 35.5003, GNorm = 0.8950, lr_0 = 1.3064e-04
Validation rmse = 0.113064
Validation r2 = 0.888463
Validation mse = 0.012784
Epoch 50
Loss = 8.0473e-02, PNorm = 35.5052, GNorm = 1.0219, lr_0 = 1.2723e-04
Validation rmse = 0.115207
Validation r2 = 0.884195
Validation mse = 0.013273
Epoch 51
Loss = 7.2605e-02, PNorm = 35.5109, GNorm = 1.4168, lr_0 = 1.2358e-04
Loss = 8.3672e-02, PNorm = 35.5143, GNorm = 0.5380, lr_0 = 1.2035e-04
Validation rmse = 0.113041
Validation r2 = 0.888508
Validation mse = 0.012778
Epoch 52
Loss = 7.1160e-02, PNorm = 35.5186, GNorm = 0.8899, lr_0 = 1.1690e-04
Validation rmse = 0.113292
Validation r2 = 0.888014
Validation mse = 0.012835
Epoch 53
Loss = 9.6171e-02, PNorm = 35.5237, GNorm = 1.8433, lr_0 = 1.1385e-04
Loss = 7.6945e-02, PNorm = 35.5271, GNorm = 1.1743, lr_0 = 1.1087e-04
Validation rmse = 0.111273
Validation r2 = 0.891969
Validation mse = 0.012382
Epoch 54
Loss = 6.8614e-02, PNorm = 35.5304, GNorm = 0.9363, lr_0 = 1.0769e-04
Validation rmse = 0.112004
Validation r2 = 0.890544
Validation mse = 0.012545
Epoch 55
Loss = 7.9360e-02, PNorm = 35.5347, GNorm = 1.3050, lr_0 = 1.0488e-04
Loss = 7.4754e-02, PNorm = 35.5380, GNorm = 2.1682, lr_0 = 1.0214e-04
Validation rmse = 0.111889
Validation r2 = 0.890771
Validation mse = 0.012519
Epoch 56
Loss = 6.2423e-02, PNorm = 35.5427, GNorm = 0.7931, lr_0 = 1.0000e-04
Loss = 8.4133e-02, PNorm = 35.5463, GNorm = 1.9161, lr_0 = 1.0000e-04
Validation rmse = 0.111428
Validation r2 = 0.891668
Validation mse = 0.012416
Epoch 57
Loss = 6.9829e-02, PNorm = 35.5491, GNorm = 0.5729, lr_0 = 1.0000e-04
Validation rmse = 0.111828
Validation r2 = 0.890889
Validation mse = 0.012505
Epoch 58
Loss = 5.8409e-02, PNorm = 35.5530, GNorm = 0.4242, lr_0 = 1.0000e-04
Loss = 7.7217e-02, PNorm = 35.5563, GNorm = 0.7700, lr_0 = 1.0000e-04
Loss = 1.4263e-01, PNorm = 35.5566, GNorm = 2.5997, lr_0 = 1.0000e-04
Validation rmse = 0.112986
Validation r2 = 0.888617
Validation mse = 0.012766
Epoch 59
Loss = 7.5832e-02, PNorm = 35.5601, GNorm = 0.7680, lr_0 = 1.0000e-04
Validation rmse = 0.114301
Validation r2 = 0.886010
Validation mse = 0.013065
Model 0 best validation rmse = 0.108146 on epoch 24
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.170579
Model 0 test r2 = 0.626792
Model 0 test mse = 0.029097
Ensemble test rmse = 0.170579
Ensemble test r2 = 0.626792
Ensemble test mse = 0.029097
Fold 4
Splitting data with seed 4
Total size = 966 | train size = 772 | val size = 194 | test size = 56
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1020e-01, PNorm = 34.0170, GNorm = 5.2942, lr_0 = 4.3000e-04
Validation rmse = 0.327256
Validation r2 = 0.187898
Validation mse = 0.107096
Epoch 1
Loss = 7.3571e-01, PNorm = 34.0515, GNorm = 5.0832, lr_0 = 7.6000e-04
Loss = 5.5903e-01, PNorm = 34.1101, GNorm = 3.0219, lr_0 = 9.9472e-04
Loss = 4.2372e-01, PNorm = 34.1177, GNorm = 2.6454, lr_0 = 9.9209e-04
Validation rmse = 0.240968
Validation r2 = 0.559693
Validation mse = 0.058066
Epoch 2
Loss = 4.5094e-01, PNorm = 34.1985, GNorm = 3.7358, lr_0 = 9.6618e-04
Validation rmse = 0.231724
Validation r2 = 0.592827
Validation mse = 0.053696
Epoch 3
Loss = 4.0733e-01, PNorm = 34.2655, GNorm = 3.2252, lr_0 = 9.4094e-04
Loss = 4.2795e-01, PNorm = 34.3276, GNorm = 5.7063, lr_0 = 9.1637e-04
Validation rmse = 0.190931
Validation r2 = 0.723568
Validation mse = 0.036455
Epoch 4
Loss = 3.1422e-01, PNorm = 34.3894, GNorm = 1.6087, lr_0 = 8.9007e-04
Validation rmse = 0.172616
Validation r2 = 0.774058
Validation mse = 0.029796
Epoch 5
Loss = 1.8521e-01, PNorm = 34.4411, GNorm = 4.2709, lr_0 = 8.6682e-04
Loss = 2.7187e-01, PNorm = 34.4823, GNorm = 2.8665, lr_0 = 8.4418e-04
Validation rmse = 0.180453
Validation r2 = 0.753075
Validation mse = 0.032563
Epoch 6
Loss = 2.5381e-01, PNorm = 34.5365, GNorm = 1.9326, lr_0 = 8.1996e-04
Validation rmse = 0.146702
Validation r2 = 0.836805
Validation mse = 0.021521
Epoch 7
Loss = 1.2942e-01, PNorm = 34.5784, GNorm = 0.9533, lr_0 = 7.9854e-04
Loss = 2.0419e-01, PNorm = 34.6126, GNorm = 1.1097, lr_0 = 7.7769e-04
Validation rmse = 0.147625
Validation r2 = 0.834745
Validation mse = 0.021793
Epoch 8
Loss = 1.7285e-01, PNorm = 34.6465, GNorm = 1.9922, lr_0 = 7.5537e-04
Validation rmse = 0.148377
Validation r2 = 0.833057
Validation mse = 0.022016
Epoch 9
Loss = 2.3394e-01, PNorm = 34.6803, GNorm = 4.8128, lr_0 = 7.3370e-04
Loss = 1.4311e-01, PNorm = 34.7135, GNorm = 2.7869, lr_0 = 7.1453e-04
Validation rmse = 0.134705
Validation r2 = 0.862404
Validation mse = 0.018146
Epoch 10
Loss = 1.5394e-01, PNorm = 34.7392, GNorm = 2.7136, lr_0 = 6.9587e-04
Validation rmse = 0.139577
Validation r2 = 0.852272
Validation mse = 0.019482
Epoch 11
Loss = 1.3374e-01, PNorm = 34.7642, GNorm = 1.6819, lr_0 = 6.7590e-04
Loss = 1.3507e-01, PNorm = 34.7893, GNorm = 1.8379, lr_0 = 6.5825e-04
Validation rmse = 0.144290
Validation r2 = 0.842127
Validation mse = 0.020820
Epoch 12
Loss = 1.2308e-01, PNorm = 34.8096, GNorm = 5.6858, lr_0 = 6.4106e-04
Loss = 1.5885e-01, PNorm = 34.8334, GNorm = 5.9667, lr_0 = 6.2431e-04
Loss = 9.6609e-02, PNorm = 34.8341, GNorm = 2.9102, lr_0 = 6.2266e-04
Validation rmse = 0.143468
Validation r2 = 0.843921
Validation mse = 0.020583
Epoch 13
Loss = 1.4021e-01, PNorm = 34.8490, GNorm = 1.3068, lr_0 = 6.0640e-04
Validation rmse = 0.131723
Validation r2 = 0.868430
Validation mse = 0.017351
Epoch 14
Loss = 1.5833e-01, PNorm = 34.8699, GNorm = 1.4176, lr_0 = 5.9056e-04
Loss = 1.0880e-01, PNorm = 34.8897, GNorm = 1.7870, lr_0 = 5.7514e-04
Validation rmse = 0.131865
Validation r2 = 0.868145
Validation mse = 0.017388
Epoch 15
Loss = 1.3978e-01, PNorm = 34.9048, GNorm = 3.0761, lr_0 = 5.5863e-04
Validation rmse = 0.140552
Validation r2 = 0.850201
Validation mse = 0.019755
Epoch 16
Loss = 9.6336e-02, PNorm = 34.9163, GNorm = 4.1097, lr_0 = 5.4404e-04
Loss = 1.3753e-01, PNorm = 34.9344, GNorm = 0.5865, lr_0 = 5.2983e-04
Validation rmse = 0.135508
Validation r2 = 0.860760
Validation mse = 0.018362
Epoch 17
Loss = 1.1142e-01, PNorm = 34.9522, GNorm = 3.2847, lr_0 = 5.1463e-04
Validation rmse = 0.135027
Validation r2 = 0.861747
Validation mse = 0.018232
Epoch 18
Loss = 1.0100e-01, PNorm = 34.9706, GNorm = 0.5903, lr_0 = 4.9986e-04
Loss = 1.1114e-01, PNorm = 34.9862, GNorm = 1.5820, lr_0 = 4.8681e-04
Validation rmse = 0.132657
Validation r2 = 0.866556
Validation mse = 0.017598
Epoch 19
Loss = 1.1447e-01, PNorm = 35.0001, GNorm = 0.6608, lr_0 = 4.7409e-04
Validation rmse = 0.136966
Validation r2 = 0.857748
Validation mse = 0.018760
Epoch 20
Loss = 1.2045e-01, PNorm = 35.0133, GNorm = 5.6835, lr_0 = 4.6049e-04
Loss = 1.2783e-01, PNorm = 35.0280, GNorm = 2.9767, lr_0 = 4.4846e-04
Validation rmse = 0.139462
Validation r2 = 0.852516
Validation mse = 0.019450
Epoch 21
Loss = 1.1728e-01, PNorm = 35.0407, GNorm = 1.1012, lr_0 = 4.3675e-04
Validation rmse = 0.136156
Validation r2 = 0.859426
Validation mse = 0.018538
Epoch 22
Loss = 1.0856e-01, PNorm = 35.0540, GNorm = 3.6618, lr_0 = 4.2422e-04
Loss = 9.7779e-02, PNorm = 35.0651, GNorm = 2.8900, lr_0 = 4.1313e-04
Validation rmse = 0.137008
Validation r2 = 0.857660
Validation mse = 0.018771
Epoch 23
Loss = 1.1724e-01, PNorm = 35.0758, GNorm = 4.7931, lr_0 = 4.0234e-04
Loss = 1.1298e-01, PNorm = 35.0891, GNorm = 2.1277, lr_0 = 3.9184e-04
Loss = 5.0881e-02, PNorm = 35.0904, GNorm = 0.9842, lr_0 = 3.9080e-04
Validation rmse = 0.138723
Validation r2 = 0.854073
Validation mse = 0.019244
Epoch 24
Loss = 9.8286e-02, PNorm = 35.1013, GNorm = 1.5038, lr_0 = 3.8059e-04
Validation rmse = 0.135765
Validation r2 = 0.860231
Validation mse = 0.018432
Epoch 25
Loss = 1.2996e-01, PNorm = 35.1125, GNorm = 1.3765, lr_0 = 3.7065e-04
Loss = 1.1162e-01, PNorm = 35.1244, GNorm = 3.3591, lr_0 = 3.6097e-04
Validation rmse = 0.137387
Validation r2 = 0.856872
Validation mse = 0.018875
Epoch 26
Loss = 9.4714e-02, PNorm = 35.1370, GNorm = 0.9972, lr_0 = 3.5061e-04
Validation rmse = 0.138148
Validation r2 = 0.855282
Validation mse = 0.019085
Epoch 27
Loss = 9.2753e-02, PNorm = 35.1463, GNorm = 1.0624, lr_0 = 3.4055e-04
Loss = 1.0559e-01, PNorm = 35.1598, GNorm = 3.8104, lr_0 = 3.3166e-04
Validation rmse = 0.138330
Validation r2 = 0.854899
Validation mse = 0.019135
Epoch 28
Loss = 9.8722e-02, PNorm = 35.1711, GNorm = 2.9685, lr_0 = 3.2299e-04
Validation rmse = 0.143689
Validation r2 = 0.843439
Validation mse = 0.020647
Epoch 29
Loss = 1.3154e-01, PNorm = 35.1813, GNorm = 2.8985, lr_0 = 3.1373e-04
Loss = 1.0381e-01, PNorm = 35.1906, GNorm = 1.1233, lr_0 = 3.0553e-04
Validation rmse = 0.134859
Validation r2 = 0.862091
Validation mse = 0.018187
Epoch 30
Loss = 8.5140e-02, PNorm = 35.1994, GNorm = 0.6807, lr_0 = 2.9755e-04
Validation rmse = 0.135288
Validation r2 = 0.861212
Validation mse = 0.018303
Epoch 31
Loss = 7.6890e-02, PNorm = 35.2090, GNorm = 1.5491, lr_0 = 2.8901e-04
Loss = 8.8844e-02, PNorm = 35.2170, GNorm = 0.7400, lr_0 = 2.8147e-04
Validation rmse = 0.136592
Validation r2 = 0.858522
Validation mse = 0.018657
Epoch 32
Loss = 9.7874e-02, PNorm = 35.2243, GNorm = 1.5697, lr_0 = 2.7411e-04
Validation rmse = 0.135891
Validation r2 = 0.859971
Validation mse = 0.018466
Epoch 33
Loss = 9.5877e-02, PNorm = 35.2346, GNorm = 0.9458, lr_0 = 2.6625e-04
Loss = 8.7661e-02, PNorm = 35.2442, GNorm = 0.6926, lr_0 = 2.5929e-04
Validation rmse = 0.139858
Validation r2 = 0.851677
Validation mse = 0.019560
Epoch 34
Loss = 8.3642e-02, PNorm = 35.2532, GNorm = 1.2079, lr_0 = 2.5185e-04
Loss = 8.6574e-02, PNorm = 35.2591, GNorm = 0.9389, lr_0 = 2.4528e-04
Validation rmse = 0.135381
Validation r2 = 0.861021
Validation mse = 0.018328
Epoch 35
Loss = 8.1708e-02, PNorm = 35.2658, GNorm = 0.8712, lr_0 = 2.3887e-04
Validation rmse = 0.135273
Validation r2 = 0.861242
Validation mse = 0.018299
Epoch 36
Loss = 9.0820e-02, PNorm = 35.2731, GNorm = 1.5468, lr_0 = 2.3202e-04
Loss = 7.6780e-02, PNorm = 35.2810, GNorm = 1.3226, lr_0 = 2.2596e-04
Validation rmse = 0.137915
Validation r2 = 0.855770
Validation mse = 0.019020
Epoch 37
Loss = 7.8977e-02, PNorm = 35.2882, GNorm = 1.7044, lr_0 = 2.2005e-04
Validation rmse = 0.136348
Validation r2 = 0.859029
Validation mse = 0.018591
Epoch 38
Loss = 8.2022e-02, PNorm = 35.2949, GNorm = 2.8890, lr_0 = 2.1374e-04
Loss = 8.7672e-02, PNorm = 35.3011, GNorm = 0.6323, lr_0 = 2.0816e-04
Validation rmse = 0.138195
Validation r2 = 0.855182
Validation mse = 0.019098
Epoch 39
Loss = 8.4619e-02, PNorm = 35.3070, GNorm = 0.5654, lr_0 = 2.0272e-04
Validation rmse = 0.135859
Validation r2 = 0.860038
Validation mse = 0.018458
Epoch 40
Loss = 7.7534e-02, PNorm = 35.3141, GNorm = 2.8839, lr_0 = 1.9690e-04
Loss = 8.3731e-02, PNorm = 35.3213, GNorm = 1.5342, lr_0 = 1.9176e-04
Validation rmse = 0.135718
Validation r2 = 0.860328
Validation mse = 0.018419
Epoch 41
Loss = 7.3026e-02, PNorm = 35.3263, GNorm = 1.5814, lr_0 = 1.8675e-04
Validation rmse = 0.145452
Validation r2 = 0.839573
Validation mse = 0.021156
Epoch 42
Loss = 1.0873e-01, PNorm = 35.3311, GNorm = 3.0898, lr_0 = 1.8139e-04
Loss = 8.1368e-02, PNorm = 35.3378, GNorm = 2.5044, lr_0 = 1.7666e-04
Validation rmse = 0.139714
Validation r2 = 0.851982
Validation mse = 0.019520
Epoch 43
Loss = 8.3277e-02, PNorm = 35.3437, GNorm = 1.2728, lr_0 = 1.7159e-04
Validation rmse = 0.141731
Validation r2 = 0.847678
Validation mse = 0.020088
Epoch 44
Loss = 9.9946e-02, PNorm = 35.3493, GNorm = 0.9280, lr_0 = 1.6710e-04
Loss = 7.3345e-02, PNorm = 35.3523, GNorm = 0.7938, lr_0 = 1.6274e-04
Validation rmse = 0.135395
Validation r2 = 0.860992
Validation mse = 0.018332
Epoch 45
Loss = 8.0183e-02, PNorm = 35.3587, GNorm = 2.4358, lr_0 = 1.5807e-04
Loss = 7.3859e-02, PNorm = 35.3641, GNorm = 1.0864, lr_0 = 1.5394e-04
Validation rmse = 0.138110
Validation r2 = 0.855360
Validation mse = 0.019074
Epoch 46
Loss = 7.6549e-02, PNorm = 35.3692, GNorm = 1.8598, lr_0 = 1.4992e-04
Validation rmse = 0.134895
Validation r2 = 0.862016
Validation mse = 0.018197
Epoch 47
Loss = 6.8367e-02, PNorm = 35.3741, GNorm = 0.5611, lr_0 = 1.4562e-04
Loss = 7.9538e-02, PNorm = 35.3791, GNorm = 1.7462, lr_0 = 1.4182e-04
Validation rmse = 0.136685
Validation r2 = 0.858329
Validation mse = 0.018683
Epoch 48
Loss = 7.3283e-02, PNorm = 35.3824, GNorm = 2.3227, lr_0 = 1.3811e-04
Validation rmse = 0.135596
Validation r2 = 0.860579
Validation mse = 0.018386
Epoch 49
Loss = 8.5347e-02, PNorm = 35.3864, GNorm = 2.8680, lr_0 = 1.3415e-04
Loss = 7.5216e-02, PNorm = 35.3913, GNorm = 1.7267, lr_0 = 1.3064e-04
Validation rmse = 0.138461
Validation r2 = 0.854624
Validation mse = 0.019171
Epoch 50
Loss = 7.4548e-02, PNorm = 35.3953, GNorm = 0.4212, lr_0 = 1.2723e-04
Validation rmse = 0.139395
Validation r2 = 0.852657
Validation mse = 0.019431
Epoch 51
Loss = 7.5039e-02, PNorm = 35.3998, GNorm = 1.3030, lr_0 = 1.2358e-04
Loss = 7.8431e-02, PNorm = 35.4037, GNorm = 0.8269, lr_0 = 1.2035e-04
Validation rmse = 0.136611
Validation r2 = 0.858484
Validation mse = 0.018662
Epoch 52
Loss = 8.1101e-02, PNorm = 35.4080, GNorm = 1.6839, lr_0 = 1.1690e-04
Validation rmse = 0.141421
Validation r2 = 0.848343
Validation mse = 0.020000
Epoch 53
Loss = 7.1990e-02, PNorm = 35.4112, GNorm = 1.9126, lr_0 = 1.1385e-04
Loss = 7.9843e-02, PNorm = 35.4151, GNorm = 0.9184, lr_0 = 1.1087e-04
Validation rmse = 0.135910
Validation r2 = 0.859932
Validation mse = 0.018472
Epoch 54
Loss = 7.9480e-02, PNorm = 35.4190, GNorm = 1.1241, lr_0 = 1.0769e-04
Validation rmse = 0.136544
Validation r2 = 0.858623
Validation mse = 0.018644
Epoch 55
Loss = 1.0652e-01, PNorm = 35.4214, GNorm = 1.1140, lr_0 = 1.0488e-04
Loss = 7.2044e-02, PNorm = 35.4255, GNorm = 0.9182, lr_0 = 1.0214e-04
Validation rmse = 0.140414
Validation r2 = 0.850495
Validation mse = 0.019716
Epoch 56
Loss = 6.4332e-02, PNorm = 35.4291, GNorm = 0.6682, lr_0 = 1.0000e-04
Loss = 7.7724e-02, PNorm = 35.4318, GNorm = 3.2880, lr_0 = 1.0000e-04
Validation rmse = 0.141857
Validation r2 = 0.847406
Validation mse = 0.020123
Epoch 57
Loss = 7.5630e-02, PNorm = 35.4354, GNorm = 0.9116, lr_0 = 1.0000e-04
Validation rmse = 0.141437
Validation r2 = 0.848308
Validation mse = 0.020004
Epoch 58
Loss = 7.5673e-02, PNorm = 35.4390, GNorm = 0.9711, lr_0 = 1.0000e-04
Loss = 7.0992e-02, PNorm = 35.4412, GNorm = 0.6025, lr_0 = 1.0000e-04
Loss = 6.5848e-02, PNorm = 35.4417, GNorm = 1.4875, lr_0 = 1.0000e-04
Validation rmse = 0.139697
Validation r2 = 0.852017
Validation mse = 0.019515
Epoch 59
Loss = 7.2088e-02, PNorm = 35.4457, GNorm = 1.5323, lr_0 = 1.0000e-04
Validation rmse = 0.138230
Validation r2 = 0.855110
Validation mse = 0.019107
Model 0 best validation rmse = 0.131723 on epoch 13
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.179483
Model 0 test r2 = 0.586813
Model 0 test mse = 0.032214
Ensemble test rmse = 0.179483
Ensemble test r2 = 0.586813
Ensemble test mse = 0.032214
Fold 5
Splitting data with seed 5
Total size = 966 | train size = 772 | val size = 194 | test size = 56
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.0537e-01, PNorm = 34.0169, GNorm = 4.0777, lr_0 = 4.3000e-04
Validation rmse = 0.334476
Validation r2 = 0.124619
Validation mse = 0.111874
Epoch 1
Loss = 7.9497e-01, PNorm = 34.0471, GNorm = 8.2969, lr_0 = 7.6000e-04
Loss = 7.5250e-01, PNorm = 34.0897, GNorm = 4.1287, lr_0 = 9.9472e-04
Loss = 6.5086e-01, PNorm = 34.0958, GNorm = 3.7827, lr_0 = 9.9209e-04
Validation rmse = 0.321609
Validation r2 = 0.190675
Validation mse = 0.103432
Epoch 2
Loss = 5.2508e-01, PNorm = 34.1665, GNorm = 2.1426, lr_0 = 9.6618e-04
Validation rmse = 0.272126
Validation r2 = 0.420561
Validation mse = 0.074053
Epoch 3
Loss = 3.9834e-01, PNorm = 34.2287, GNorm = 2.3402, lr_0 = 9.4094e-04
Loss = 4.1041e-01, PNorm = 34.3012, GNorm = 2.6800, lr_0 = 9.1637e-04
Validation rmse = 0.229382
Validation r2 = 0.588297
Validation mse = 0.052616
Epoch 4
Loss = 3.2222e-01, PNorm = 34.3681, GNorm = 3.3374, lr_0 = 8.9007e-04
Validation rmse = 0.200044
Validation r2 = 0.686875
Validation mse = 0.040018
Epoch 5
Loss = 2.5936e-01, PNorm = 34.4318, GNorm = 1.8945, lr_0 = 8.6682e-04
Loss = 2.8389e-01, PNorm = 34.4839, GNorm = 4.9187, lr_0 = 8.4418e-04
Validation rmse = 0.220686
Validation r2 = 0.618919
Validation mse = 0.048702
Epoch 6
Loss = 2.4590e-01, PNorm = 34.5441, GNorm = 2.3211, lr_0 = 8.1996e-04
Validation rmse = 0.163734
Validation r2 = 0.790230
Validation mse = 0.026809
Epoch 7
Loss = 1.5335e-01, PNorm = 34.5926, GNorm = 3.0495, lr_0 = 7.9854e-04
Loss = 1.8662e-01, PNorm = 34.6396, GNorm = 4.1342, lr_0 = 7.7769e-04
Validation rmse = 0.156904
Validation r2 = 0.807364
Validation mse = 0.024619
Epoch 8
Loss = 2.4725e-01, PNorm = 34.6825, GNorm = 3.2359, lr_0 = 7.5537e-04
Validation rmse = 0.155311
Validation r2 = 0.811257
Validation mse = 0.024121
Epoch 9
Loss = 1.5889e-01, PNorm = 34.7252, GNorm = 1.9142, lr_0 = 7.3370e-04
Loss = 1.6575e-01, PNorm = 34.7550, GNorm = 1.8369, lr_0 = 7.1453e-04
Validation rmse = 0.161261
Validation r2 = 0.796519
Validation mse = 0.026005
Epoch 10
Loss = 1.7199e-01, PNorm = 34.7857, GNorm = 0.5661, lr_0 = 6.9587e-04
Validation rmse = 0.146291
Validation r2 = 0.832543
Validation mse = 0.021401
Epoch 11
Loss = 1.3699e-01, PNorm = 34.8146, GNorm = 1.6410, lr_0 = 6.7590e-04
Loss = 1.5261e-01, PNorm = 34.8334, GNorm = 1.5773, lr_0 = 6.5825e-04
Validation rmse = 0.141727
Validation r2 = 0.842829
Validation mse = 0.020087
Epoch 12
Loss = 1.3269e-01, PNorm = 34.8551, GNorm = 1.9517, lr_0 = 6.4106e-04
Loss = 1.3805e-01, PNorm = 34.8720, GNorm = 2.2161, lr_0 = 6.2431e-04
Loss = 8.5076e-02, PNorm = 34.8746, GNorm = 1.4671, lr_0 = 6.2266e-04
Validation rmse = 0.135901
Validation r2 = 0.855485
Validation mse = 0.018469
Epoch 13
Loss = 1.1605e-01, PNorm = 34.8923, GNorm = 0.6699, lr_0 = 6.0640e-04
Validation rmse = 0.171998
Validation r2 = 0.768520
Validation mse = 0.029583
Epoch 14
Loss = 1.8144e-01, PNorm = 34.9122, GNorm = 1.8255, lr_0 = 5.9056e-04
Loss = 1.5154e-01, PNorm = 34.9291, GNorm = 3.9011, lr_0 = 5.7514e-04
Validation rmse = 0.172324
Validation r2 = 0.767642
Validation mse = 0.029695
Epoch 15
Loss = 1.3707e-01, PNorm = 34.9442, GNorm = 1.0290, lr_0 = 5.5863e-04
Validation rmse = 0.138498
Validation r2 = 0.849909
Validation mse = 0.019182
Epoch 16
Loss = 1.0320e-01, PNorm = 34.9617, GNorm = 5.2034, lr_0 = 5.4404e-04
Loss = 1.4187e-01, PNorm = 34.9751, GNorm = 0.5904, lr_0 = 5.2983e-04
Validation rmse = 0.135435
Validation r2 = 0.856474
Validation mse = 0.018343
Epoch 17
Loss = 1.3442e-01, PNorm = 34.9934, GNorm = 0.8125, lr_0 = 5.1463e-04
Validation rmse = 0.132364
Validation r2 = 0.862910
Validation mse = 0.017520
Epoch 18
Loss = 9.3614e-02, PNorm = 35.0130, GNorm = 0.8280, lr_0 = 4.9986e-04
Loss = 1.1014e-01, PNorm = 35.0225, GNorm = 0.8112, lr_0 = 4.8681e-04
Validation rmse = 0.137440
Validation r2 = 0.852193
Validation mse = 0.018890
Epoch 19
Loss = 1.0588e-01, PNorm = 35.0366, GNorm = 1.2846, lr_0 = 4.7409e-04
Validation rmse = 0.136771
Validation r2 = 0.853628
Validation mse = 0.018706
Epoch 20
Loss = 1.3630e-01, PNorm = 35.0477, GNorm = 1.3706, lr_0 = 4.6049e-04
Loss = 1.2494e-01, PNorm = 35.0639, GNorm = 4.5761, lr_0 = 4.4846e-04
Validation rmse = 0.133039
Validation r2 = 0.861508
Validation mse = 0.017699
Epoch 21
Loss = 1.2047e-01, PNorm = 35.0756, GNorm = 1.5030, lr_0 = 4.3675e-04
Validation rmse = 0.141998
Validation r2 = 0.842227
Validation mse = 0.020163
Epoch 22
Loss = 1.4520e-01, PNorm = 35.0901, GNorm = 2.5343, lr_0 = 4.2422e-04
Loss = 1.1748e-01, PNorm = 35.1023, GNorm = 1.8002, lr_0 = 4.1313e-04
Validation rmse = 0.130689
Validation r2 = 0.866358
Validation mse = 0.017080
Epoch 23
Loss = 1.1718e-01, PNorm = 35.1149, GNorm = 1.8451, lr_0 = 4.0234e-04
Loss = 9.5347e-02, PNorm = 35.1244, GNorm = 0.6927, lr_0 = 3.9184e-04
Loss = 1.1104e-01, PNorm = 35.1254, GNorm = 0.9598, lr_0 = 3.9080e-04
Validation rmse = 0.132235
Validation r2 = 0.863177
Validation mse = 0.017486
Epoch 24
Loss = 1.0270e-01, PNorm = 35.1355, GNorm = 1.1947, lr_0 = 3.8059e-04
Validation rmse = 0.138128
Validation r2 = 0.850711
Validation mse = 0.019079
Epoch 25
Loss = 1.1266e-01, PNorm = 35.1451, GNorm = 2.9738, lr_0 = 3.7065e-04
Loss = 1.2809e-01, PNorm = 35.1554, GNorm = 3.4246, lr_0 = 3.6097e-04
Validation rmse = 0.132744
Validation r2 = 0.862122
Validation mse = 0.017621
Epoch 26
Loss = 9.8323e-02, PNorm = 35.1675, GNorm = 2.3447, lr_0 = 3.5061e-04
Validation rmse = 0.134731
Validation r2 = 0.857962
Validation mse = 0.018153
Epoch 27
Loss = 9.1772e-02, PNorm = 35.1765, GNorm = 0.6259, lr_0 = 3.4055e-04
Loss = 9.9641e-02, PNorm = 35.1850, GNorm = 1.4578, lr_0 = 3.3166e-04
Validation rmse = 0.131326
Validation r2 = 0.865051
Validation mse = 0.017247
Epoch 28
Loss = 9.1783e-02, PNorm = 35.1943, GNorm = 0.5713, lr_0 = 3.2299e-04
Validation rmse = 0.130988
Validation r2 = 0.865744
Validation mse = 0.017158
Epoch 29
Loss = 1.1245e-01, PNorm = 35.2035, GNorm = 1.1225, lr_0 = 3.1373e-04
Loss = 9.5786e-02, PNorm = 35.2127, GNorm = 4.0440, lr_0 = 3.0553e-04
Validation rmse = 0.133033
Validation r2 = 0.861520
Validation mse = 0.017698
Epoch 30
Loss = 9.6370e-02, PNorm = 35.2186, GNorm = 2.3365, lr_0 = 2.9755e-04
Validation rmse = 0.131261
Validation r2 = 0.865185
Validation mse = 0.017229
Epoch 31
Loss = 8.5806e-02, PNorm = 35.2285, GNorm = 0.7405, lr_0 = 2.8901e-04
Loss = 9.9147e-02, PNorm = 35.2372, GNorm = 2.1088, lr_0 = 2.8147e-04
Validation rmse = 0.130054
Validation r2 = 0.867653
Validation mse = 0.016914
Epoch 32
Loss = 1.0945e-01, PNorm = 35.2458, GNorm = 1.9892, lr_0 = 2.7411e-04
Validation rmse = 0.130905
Validation r2 = 0.865916
Validation mse = 0.017136
Epoch 33
Loss = 8.3248e-02, PNorm = 35.2530, GNorm = 1.3463, lr_0 = 2.6625e-04
Loss = 9.1563e-02, PNorm = 35.2612, GNorm = 0.4124, lr_0 = 2.5929e-04
Validation rmse = 0.130034
Validation r2 = 0.867694
Validation mse = 0.016909
Epoch 34
Loss = 9.4840e-02, PNorm = 35.2700, GNorm = 0.7030, lr_0 = 2.5185e-04
Loss = 9.9810e-02, PNorm = 35.2767, GNorm = 2.0021, lr_0 = 2.4528e-04
Validation rmse = 0.127854
Validation r2 = 0.872094
Validation mse = 0.016347
Epoch 35
Loss = 1.0658e-01, PNorm = 35.2854, GNorm = 2.1557, lr_0 = 2.3887e-04
Validation rmse = 0.128794
Validation r2 = 0.870204
Validation mse = 0.016588
Epoch 36
Loss = 1.0409e-01, PNorm = 35.2922, GNorm = 1.8543, lr_0 = 2.3202e-04
Loss = 8.2529e-02, PNorm = 35.2972, GNorm = 0.7104, lr_0 = 2.2596e-04
Validation rmse = 0.130168
Validation r2 = 0.867421
Validation mse = 0.016944
Epoch 37
Loss = 8.3996e-02, PNorm = 35.3054, GNorm = 1.3277, lr_0 = 2.2005e-04
Validation rmse = 0.128961
Validation r2 = 0.869867
Validation mse = 0.016631
Epoch 38
Loss = 8.4977e-02, PNorm = 35.3123, GNorm = 2.9196, lr_0 = 2.1374e-04
Loss = 9.1449e-02, PNorm = 35.3189, GNorm = 2.1870, lr_0 = 2.0816e-04
Validation rmse = 0.129679
Validation r2 = 0.868415
Validation mse = 0.016817
Epoch 39
Loss = 9.7007e-02, PNorm = 35.3244, GNorm = 3.1272, lr_0 = 2.0272e-04
Validation rmse = 0.129645
Validation r2 = 0.868485
Validation mse = 0.016808
Epoch 40
Loss = 7.4786e-02, PNorm = 35.3320, GNorm = 1.6008, lr_0 = 1.9690e-04
Loss = 8.6996e-02, PNorm = 35.3369, GNorm = 0.7670, lr_0 = 1.9176e-04
Validation rmse = 0.131283
Validation r2 = 0.865139
Validation mse = 0.017235
Epoch 41
Loss = 8.7721e-02, PNorm = 35.3441, GNorm = 0.7276, lr_0 = 1.8675e-04
Validation rmse = 0.129064
Validation r2 = 0.869660
Validation mse = 0.016658
Epoch 42
Loss = 6.9034e-02, PNorm = 35.3494, GNorm = 0.4807, lr_0 = 1.8139e-04
Loss = 8.1241e-02, PNorm = 35.3556, GNorm = 1.5353, lr_0 = 1.7666e-04
Validation rmse = 0.131480
Validation r2 = 0.864736
Validation mse = 0.017287
Epoch 43
Loss = 8.0932e-02, PNorm = 35.3618, GNorm = 0.6178, lr_0 = 1.7159e-04
Validation rmse = 0.129748
Validation r2 = 0.868274
Validation mse = 0.016835
Epoch 44
Loss = 8.6084e-02, PNorm = 35.3657, GNorm = 1.5662, lr_0 = 1.6710e-04
Loss = 8.1436e-02, PNorm = 35.3718, GNorm = 0.6282, lr_0 = 1.6274e-04
Validation rmse = 0.129749
Validation r2 = 0.868274
Validation mse = 0.016835
Epoch 45
Loss = 9.0337e-02, PNorm = 35.3778, GNorm = 1.8053, lr_0 = 1.5807e-04
Loss = 7.6616e-02, PNorm = 35.3824, GNorm = 0.5813, lr_0 = 1.5394e-04
Validation rmse = 0.129334
Validation r2 = 0.869115
Validation mse = 0.016727
Epoch 46
Loss = 7.3246e-02, PNorm = 35.3868, GNorm = 1.4957, lr_0 = 1.4992e-04
Validation rmse = 0.129483
Validation r2 = 0.868812
Validation mse = 0.016766
Epoch 47
Loss = 7.5542e-02, PNorm = 35.3908, GNorm = 1.2927, lr_0 = 1.4562e-04
Loss = 8.7653e-02, PNorm = 35.3957, GNorm = 1.1192, lr_0 = 1.4182e-04
Validation rmse = 0.130126
Validation r2 = 0.867506
Validation mse = 0.016933
Epoch 48
Loss = 7.6528e-02, PNorm = 35.4001, GNorm = 0.6708, lr_0 = 1.3811e-04
Validation rmse = 0.128228
Validation r2 = 0.871344
Validation mse = 0.016442
Epoch 49
Loss = 1.0256e-01, PNorm = 35.4046, GNorm = 0.5631, lr_0 = 1.3415e-04
Loss = 7.0849e-02, PNorm = 35.4091, GNorm = 2.1866, lr_0 = 1.3064e-04
Validation rmse = 0.130391
Validation r2 = 0.866966
Validation mse = 0.017002
Epoch 50
Loss = 8.6112e-02, PNorm = 35.4121, GNorm = 1.5683, lr_0 = 1.2723e-04
Validation rmse = 0.130552
Validation r2 = 0.866638
Validation mse = 0.017044
Epoch 51
Loss = 8.6021e-02, PNorm = 35.4169, GNorm = 1.1380, lr_0 = 1.2358e-04
Loss = 7.9339e-02, PNorm = 35.4210, GNorm = 0.5881, lr_0 = 1.2035e-04
Validation rmse = 0.129368
Validation r2 = 0.869045
Validation mse = 0.016736
Epoch 52
Loss = 7.3919e-02, PNorm = 35.4257, GNorm = 2.0682, lr_0 = 1.1690e-04
Validation rmse = 0.128005
Validation r2 = 0.871789
Validation mse = 0.016385
Epoch 53
Loss = 6.2902e-02, PNorm = 35.4294, GNorm = 2.4092, lr_0 = 1.1385e-04
Loss = 8.2041e-02, PNorm = 35.4327, GNorm = 1.0208, lr_0 = 1.1087e-04
Validation rmse = 0.128694
Validation r2 = 0.870407
Validation mse = 0.016562
Epoch 54
Loss = 7.9995e-02, PNorm = 35.4361, GNorm = 1.0535, lr_0 = 1.0769e-04
Validation rmse = 0.128645
Validation r2 = 0.870505
Validation mse = 0.016550
Epoch 55
Loss = 9.4481e-02, PNorm = 35.4390, GNorm = 1.6855, lr_0 = 1.0488e-04
Loss = 7.8933e-02, PNorm = 35.4417, GNorm = 0.5851, lr_0 = 1.0214e-04
Validation rmse = 0.128009
Validation r2 = 0.871782
Validation mse = 0.016386
Epoch 56
Loss = 8.4760e-02, PNorm = 35.4449, GNorm = 1.8019, lr_0 = 1.0000e-04
Loss = 7.2649e-02, PNorm = 35.4484, GNorm = 1.4450, lr_0 = 1.0000e-04
Validation rmse = 0.129209
Validation r2 = 0.869367
Validation mse = 0.016695
Epoch 57
Loss = 8.0849e-02, PNorm = 35.4514, GNorm = 0.8776, lr_0 = 1.0000e-04
Validation rmse = 0.130896
Validation r2 = 0.865933
Validation mse = 0.017134
Epoch 58
Loss = 6.9410e-02, PNorm = 35.4546, GNorm = 1.2385, lr_0 = 1.0000e-04
Loss = 8.2360e-02, PNorm = 35.4576, GNorm = 0.9481, lr_0 = 1.0000e-04
Loss = 8.3694e-02, PNorm = 35.4579, GNorm = 1.4120, lr_0 = 1.0000e-04
Validation rmse = 0.129093
Validation r2 = 0.869601
Validation mse = 0.016665
Epoch 59
Loss = 7.5958e-02, PNorm = 35.4608, GNorm = 0.8728, lr_0 = 1.0000e-04
Validation rmse = 0.128623
Validation r2 = 0.870549
Validation mse = 0.016544
Model 0 best validation rmse = 0.127854 on epoch 34
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.167701
Model 0 test r2 = 0.639277
Model 0 test mse = 0.028124
Ensemble test rmse = 0.167701
Ensemble test r2 = 0.639277
Ensemble test mse = 0.028124
Fold 6
Splitting data with seed 6
Total size = 966 | train size = 772 | val size = 194 | test size = 56
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.3287e-01, PNorm = 34.0168, GNorm = 2.8857, lr_0 = 4.3000e-04
Validation rmse = 0.271126
Validation r2 = 0.332808
Validation mse = 0.073509
Epoch 1
Loss = 6.6161e-01, PNorm = 34.0540, GNorm = 1.6377, lr_0 = 7.6000e-04
Loss = 5.9815e-01, PNorm = 34.1153, GNorm = 8.4839, lr_0 = 9.9472e-04
Loss = 3.3340e-01, PNorm = 34.1231, GNorm = 4.7445, lr_0 = 9.9209e-04
Validation rmse = 0.232269
Validation r2 = 0.510344
Validation mse = 0.053949
Epoch 2
Loss = 4.6836e-01, PNorm = 34.2070, GNorm = 6.8395, lr_0 = 9.6618e-04
Validation rmse = 0.255614
Validation r2 = 0.406971
Validation mse = 0.065338
Epoch 3
Loss = 5.5063e-01, PNorm = 34.2743, GNorm = 8.7809, lr_0 = 9.4094e-04
Loss = 3.9008e-01, PNorm = 34.3489, GNorm = 6.1468, lr_0 = 9.1637e-04
Validation rmse = 0.181562
Validation r2 = 0.700801
Validation mse = 0.032965
Epoch 4
Loss = 3.8869e-01, PNorm = 34.4057, GNorm = 3.9454, lr_0 = 8.9007e-04
Validation rmse = 0.190454
Validation r2 = 0.670779
Validation mse = 0.036273
Epoch 5
Loss = 2.6736e-01, PNorm = 34.4544, GNorm = 0.6958, lr_0 = 8.6682e-04
Loss = 2.5884e-01, PNorm = 34.5041, GNorm = 3.8045, lr_0 = 8.4418e-04
Validation rmse = 0.171836
Validation r2 = 0.731997
Validation mse = 0.029528
Epoch 6
Loss = 2.2834e-01, PNorm = 34.5584, GNorm = 2.5309, lr_0 = 8.1996e-04
Validation rmse = 0.159025
Validation r2 = 0.770469
Validation mse = 0.025289
Epoch 7
Loss = 2.9023e-01, PNorm = 34.5961, GNorm = 3.5968, lr_0 = 7.9854e-04
Loss = 2.1160e-01, PNorm = 34.6357, GNorm = 1.9251, lr_0 = 7.7769e-04
Validation rmse = 0.146056
Validation r2 = 0.806381
Validation mse = 0.021332
Epoch 8
Loss = 1.5284e-01, PNorm = 34.6691, GNorm = 1.1228, lr_0 = 7.5537e-04
Validation rmse = 0.139922
Validation r2 = 0.822303
Validation mse = 0.019578
Epoch 9
Loss = 1.8571e-01, PNorm = 34.7071, GNorm = 3.8096, lr_0 = 7.3370e-04
Loss = 1.7133e-01, PNorm = 34.7318, GNorm = 4.2315, lr_0 = 7.1453e-04
Validation rmse = 0.165798
Validation r2 = 0.750503
Validation mse = 0.027489
Epoch 10
Loss = 1.9103e-01, PNorm = 34.7572, GNorm = 8.1362, lr_0 = 6.9587e-04
Validation rmse = 0.140352
Validation r2 = 0.821209
Validation mse = 0.019699
Epoch 11
Loss = 1.5795e-01, PNorm = 34.7880, GNorm = 3.2417, lr_0 = 6.7590e-04
Loss = 1.6022e-01, PNorm = 34.8209, GNorm = 0.5151, lr_0 = 6.5825e-04
Validation rmse = 0.137536
Validation r2 = 0.828311
Validation mse = 0.018916
Epoch 12
Loss = 1.5040e-01, PNorm = 34.8463, GNorm = 1.2599, lr_0 = 6.4106e-04
Loss = 1.5443e-01, PNorm = 34.8685, GNorm = 3.7494, lr_0 = 6.2431e-04
Loss = 1.6025e-01, PNorm = 34.8698, GNorm = 3.8576, lr_0 = 6.2266e-04
Validation rmse = 0.123272
Validation r2 = 0.862077
Validation mse = 0.015196
Epoch 13
Loss = 1.3107e-01, PNorm = 34.8850, GNorm = 2.8763, lr_0 = 6.0640e-04
Validation rmse = 0.128179
Validation r2 = 0.850877
Validation mse = 0.016430
Epoch 14
Loss = 1.4373e-01, PNorm = 34.9040, GNorm = 0.5703, lr_0 = 5.9056e-04
Loss = 1.2641e-01, PNorm = 34.9180, GNorm = 1.4212, lr_0 = 5.7514e-04
Validation rmse = 0.136165
Validation r2 = 0.831717
Validation mse = 0.018541
Epoch 15
Loss = 1.4548e-01, PNorm = 34.9346, GNorm = 0.5898, lr_0 = 5.5863e-04
Validation rmse = 0.122899
Validation r2 = 0.862911
Validation mse = 0.015104
Epoch 16
Loss = 1.3209e-01, PNorm = 34.9520, GNorm = 2.7997, lr_0 = 5.4404e-04
Loss = 1.2067e-01, PNorm = 34.9690, GNorm = 2.6095, lr_0 = 5.2983e-04
Validation rmse = 0.143452
Validation r2 = 0.813224
Validation mse = 0.020578
Epoch 17
Loss = 1.2972e-01, PNorm = 34.9866, GNorm = 1.1205, lr_0 = 5.1463e-04
Validation rmse = 0.143853
Validation r2 = 0.812177
Validation mse = 0.020694
Epoch 18
Loss = 1.6610e-01, PNorm = 35.0016, GNorm = 0.6893, lr_0 = 4.9986e-04
Loss = 1.2382e-01, PNorm = 35.0178, GNorm = 1.9262, lr_0 = 4.8681e-04
Validation rmse = 0.119416
Validation r2 = 0.870569
Validation mse = 0.014260
Epoch 19
Loss = 1.1540e-01, PNorm = 35.0281, GNorm = 0.5530, lr_0 = 4.7409e-04
Validation rmse = 0.119826
Validation r2 = 0.869680
Validation mse = 0.014358
Epoch 20
Loss = 1.0948e-01, PNorm = 35.0421, GNorm = 2.4763, lr_0 = 4.6049e-04
Loss = 1.1109e-01, PNorm = 35.0504, GNorm = 2.1124, lr_0 = 4.4846e-04
Validation rmse = 0.118816
Validation r2 = 0.871867
Validation mse = 0.014117
Epoch 21
Loss = 1.2446e-01, PNorm = 35.0654, GNorm = 2.6013, lr_0 = 4.3675e-04
Validation rmse = 0.129502
Validation r2 = 0.847782
Validation mse = 0.016771
Epoch 22
Loss = 1.8153e-01, PNorm = 35.0763, GNorm = 3.9261, lr_0 = 4.2422e-04
Loss = 1.0866e-01, PNorm = 35.0863, GNorm = 2.7385, lr_0 = 4.1313e-04
Validation rmse = 0.135011
Validation r2 = 0.834558
Validation mse = 0.018228
Epoch 23
Loss = 1.5708e-01, PNorm = 35.0944, GNorm = 5.2938, lr_0 = 4.0234e-04
Loss = 1.4058e-01, PNorm = 35.1133, GNorm = 1.6742, lr_0 = 3.9184e-04
Loss = 1.0939e-01, PNorm = 35.1150, GNorm = 2.4769, lr_0 = 3.9080e-04
Validation rmse = 0.127617
Validation r2 = 0.852183
Validation mse = 0.016286
Epoch 24
Loss = 1.1615e-01, PNorm = 35.1253, GNorm = 1.9252, lr_0 = 3.8059e-04
Validation rmse = 0.115205
Validation r2 = 0.879537
Validation mse = 0.013272
Epoch 25
Loss = 9.9495e-02, PNorm = 35.1375, GNorm = 1.4579, lr_0 = 3.7065e-04
Loss = 1.0533e-01, PNorm = 35.1499, GNorm = 0.9072, lr_0 = 3.6097e-04
Validation rmse = 0.118141
Validation r2 = 0.873320
Validation mse = 0.013957
Epoch 26
Loss = 1.1307e-01, PNorm = 35.1599, GNorm = 1.1228, lr_0 = 3.5061e-04
Validation rmse = 0.116000
Validation r2 = 0.877869
Validation mse = 0.013456
Epoch 27
Loss = 1.2166e-01, PNorm = 35.1679, GNorm = 0.7506, lr_0 = 3.4055e-04
Loss = 8.8760e-02, PNorm = 35.1770, GNorm = 1.0861, lr_0 = 3.3166e-04
Validation rmse = 0.115279
Validation r2 = 0.879384
Validation mse = 0.013289
Epoch 28
Loss = 1.0155e-01, PNorm = 35.1870, GNorm = 1.1963, lr_0 = 3.2299e-04
Validation rmse = 0.118164
Validation r2 = 0.873271
Validation mse = 0.013963
Epoch 29
Loss = 7.8037e-02, PNorm = 35.1963, GNorm = 1.1998, lr_0 = 3.1373e-04
Loss = 9.8465e-02, PNorm = 35.2021, GNorm = 0.6976, lr_0 = 3.0553e-04
Validation rmse = 0.118097
Validation r2 = 0.873413
Validation mse = 0.013947
Epoch 30
Loss = 9.7860e-02, PNorm = 35.2117, GNorm = 1.3840, lr_0 = 2.9755e-04
Validation rmse = 0.119925
Validation r2 = 0.869464
Validation mse = 0.014382
Epoch 31
Loss = 8.5698e-02, PNorm = 35.2222, GNorm = 1.1235, lr_0 = 2.8901e-04
Loss = 9.1142e-02, PNorm = 35.2305, GNorm = 0.6149, lr_0 = 2.8147e-04
Validation rmse = 0.119071
Validation r2 = 0.871318
Validation mse = 0.014178
Epoch 32
Loss = 1.0255e-01, PNorm = 35.2388, GNorm = 0.8389, lr_0 = 2.7411e-04
Validation rmse = 0.115045
Validation r2 = 0.879872
Validation mse = 0.013235
Epoch 33
Loss = 1.1011e-01, PNorm = 35.2476, GNorm = 0.6924, lr_0 = 2.6625e-04
Loss = 8.8137e-02, PNorm = 35.2552, GNorm = 0.5573, lr_0 = 2.5929e-04
Validation rmse = 0.119130
Validation r2 = 0.871189
Validation mse = 0.014192
Epoch 34
Loss = 9.2097e-02, PNorm = 35.2636, GNorm = 1.0781, lr_0 = 2.5185e-04
Loss = 9.4675e-02, PNorm = 35.2706, GNorm = 1.2076, lr_0 = 2.4528e-04
Validation rmse = 0.115057
Validation r2 = 0.879847
Validation mse = 0.013238
Epoch 35
Loss = 8.9730e-02, PNorm = 35.2787, GNorm = 1.2237, lr_0 = 2.3887e-04
Validation rmse = 0.117498
Validation r2 = 0.874694
Validation mse = 0.013806
Epoch 36
Loss = 9.3885e-02, PNorm = 35.2866, GNorm = 1.3529, lr_0 = 2.3202e-04
Loss = 9.2792e-02, PNorm = 35.2936, GNorm = 1.9845, lr_0 = 2.2596e-04
Validation rmse = 0.126929
Validation r2 = 0.853772
Validation mse = 0.016111
Epoch 37
Loss = 9.2139e-02, PNorm = 35.3015, GNorm = 0.7977, lr_0 = 2.2005e-04
Validation rmse = 0.125748
Validation r2 = 0.856481
Validation mse = 0.015812
Epoch 38
Loss = 1.1124e-01, PNorm = 35.3091, GNorm = 1.2807, lr_0 = 2.1374e-04
Loss = 8.4995e-02, PNorm = 35.3151, GNorm = 0.6920, lr_0 = 2.0816e-04
Validation rmse = 0.123576
Validation r2 = 0.861396
Validation mse = 0.015271
Epoch 39
Loss = 8.9883e-02, PNorm = 35.3224, GNorm = 1.9040, lr_0 = 2.0272e-04
Validation rmse = 0.118222
Validation r2 = 0.873145
Validation mse = 0.013977
Epoch 40
Loss = 7.3119e-02, PNorm = 35.3292, GNorm = 1.5911, lr_0 = 1.9690e-04
Loss = 9.2720e-02, PNorm = 35.3355, GNorm = 1.0684, lr_0 = 1.9176e-04
Validation rmse = 0.115558
Validation r2 = 0.878799
Validation mse = 0.013354
Epoch 41
Loss = 8.6448e-02, PNorm = 35.3425, GNorm = 1.9511, lr_0 = 1.8675e-04
Validation rmse = 0.122913
Validation r2 = 0.862879
Validation mse = 0.015108
Epoch 42
Loss = 9.6922e-02, PNorm = 35.3500, GNorm = 4.2774, lr_0 = 1.8139e-04
Loss = 8.9119e-02, PNorm = 35.3540, GNorm = 1.4449, lr_0 = 1.7666e-04
Validation rmse = 0.114295
Validation r2 = 0.881433
Validation mse = 0.013063
Epoch 43
Loss = 8.1853e-02, PNorm = 35.3603, GNorm = 1.2821, lr_0 = 1.7159e-04
Validation rmse = 0.116128
Validation r2 = 0.877600
Validation mse = 0.013486
Epoch 44
Loss = 1.1417e-01, PNorm = 35.3665, GNorm = 1.1549, lr_0 = 1.6710e-04
Loss = 7.8127e-02, PNorm = 35.3725, GNorm = 1.4732, lr_0 = 1.6274e-04
Validation rmse = 0.113218
Validation r2 = 0.883658
Validation mse = 0.012818
Epoch 45
Loss = 8.3202e-02, PNorm = 35.3781, GNorm = 2.4153, lr_0 = 1.5807e-04
Loss = 8.6575e-02, PNorm = 35.3823, GNorm = 3.6262, lr_0 = 1.5394e-04
Validation rmse = 0.114528
Validation r2 = 0.880949
Validation mse = 0.013117
Epoch 46
Loss = 8.6712e-02, PNorm = 35.3883, GNorm = 3.9286, lr_0 = 1.4992e-04
Validation rmse = 0.113746
Validation r2 = 0.882569
Validation mse = 0.012938
Epoch 47
Loss = 8.0533e-02, PNorm = 35.3941, GNorm = 1.5218, lr_0 = 1.4562e-04
Loss = 8.4129e-02, PNorm = 35.3987, GNorm = 1.1707, lr_0 = 1.4182e-04
Validation rmse = 0.118023
Validation r2 = 0.873572
Validation mse = 0.013929
Epoch 48
Loss = 7.0094e-02, PNorm = 35.4023, GNorm = 0.5366, lr_0 = 1.3811e-04
Validation rmse = 0.113880
Validation r2 = 0.882293
Validation mse = 0.012969
Epoch 49
Loss = 8.9696e-02, PNorm = 35.4072, GNorm = 1.7091, lr_0 = 1.3415e-04
Loss = 8.3050e-02, PNorm = 35.4121, GNorm = 1.7884, lr_0 = 1.3064e-04
Validation rmse = 0.113491
Validation r2 = 0.883095
Validation mse = 0.012880
Epoch 50
Loss = 8.6718e-02, PNorm = 35.4164, GNorm = 1.2447, lr_0 = 1.2723e-04
Validation rmse = 0.118728
Validation r2 = 0.872058
Validation mse = 0.014096
Epoch 51
Loss = 6.9882e-02, PNorm = 35.4210, GNorm = 1.9944, lr_0 = 1.2358e-04
Loss = 8.1875e-02, PNorm = 35.4255, GNorm = 0.7314, lr_0 = 1.2035e-04
Validation rmse = 0.118088
Validation r2 = 0.873433
Validation mse = 0.013945
Epoch 52
Loss = 8.8061e-02, PNorm = 35.4283, GNorm = 1.8632, lr_0 = 1.1690e-04
Validation rmse = 0.115791
Validation r2 = 0.878308
Validation mse = 0.013408
Epoch 53
Loss = 6.0399e-02, PNorm = 35.4320, GNorm = 0.8108, lr_0 = 1.1385e-04
Loss = 8.7998e-02, PNorm = 35.4363, GNorm = 0.8699, lr_0 = 1.1087e-04
Validation rmse = 0.113902
Validation r2 = 0.882247
Validation mse = 0.012974
Epoch 54
Loss = 8.6932e-02, PNorm = 35.4408, GNorm = 1.3872, lr_0 = 1.0769e-04
Validation rmse = 0.114900
Validation r2 = 0.880176
Validation mse = 0.013202
Epoch 55
Loss = 5.2337e-02, PNorm = 35.4443, GNorm = 0.7842, lr_0 = 1.0488e-04
Loss = 7.9501e-02, PNorm = 35.4472, GNorm = 0.6706, lr_0 = 1.0214e-04
Validation rmse = 0.113377
Validation r2 = 0.883329
Validation mse = 0.012854
Epoch 56
Loss = 7.6169e-02, PNorm = 35.4509, GNorm = 0.6693, lr_0 = 1.0000e-04
Loss = 7.9787e-02, PNorm = 35.4540, GNorm = 1.7168, lr_0 = 1.0000e-04
Validation rmse = 0.113692
Validation r2 = 0.882682
Validation mse = 0.012926
Epoch 57
Loss = 8.2916e-02, PNorm = 35.4576, GNorm = 1.1713, lr_0 = 1.0000e-04
Validation rmse = 0.115267
Validation r2 = 0.879408
Validation mse = 0.013287
Epoch 58
Loss = 8.1190e-02, PNorm = 35.4615, GNorm = 0.4849, lr_0 = 1.0000e-04
Loss = 7.8701e-02, PNorm = 35.4651, GNorm = 0.5835, lr_0 = 1.0000e-04
Loss = 6.0470e-02, PNorm = 35.4655, GNorm = 0.8079, lr_0 = 1.0000e-04
Validation rmse = 0.113458
Validation r2 = 0.883164
Validation mse = 0.012873
Epoch 59
Loss = 7.5740e-02, PNorm = 35.4687, GNorm = 0.8266, lr_0 = 1.0000e-04
Validation rmse = 0.113186
Validation r2 = 0.883722
Validation mse = 0.012811
Model 0 best validation rmse = 0.113186 on epoch 59
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.195728
Model 0 test r2 = 0.508631
Model 0 test mse = 0.038310
Ensemble test rmse = 0.195728
Ensemble test r2 = 0.508631
Ensemble test mse = 0.038310
Fold 7
Splitting data with seed 7
Total size = 966 | train size = 772 | val size = 194 | test size = 56
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.5192e-01, PNorm = 34.0158, GNorm = 4.5014, lr_0 = 4.3000e-04
Validation rmse = 0.311964
Validation r2 = 0.218185
Validation mse = 0.097322
Epoch 1
Loss = 6.3595e-01, PNorm = 34.0512, GNorm = 0.9547, lr_0 = 7.6000e-04
Loss = 5.6810e-01, PNorm = 34.1139, GNorm = 1.2536, lr_0 = 9.9472e-04
Loss = 7.0591e-01, PNorm = 34.1207, GNorm = 2.2147, lr_0 = 9.9209e-04
Validation rmse = 0.267512
Validation r2 = 0.425117
Validation mse = 0.071562
Epoch 2
Loss = 4.8772e-01, PNorm = 34.1855, GNorm = 6.9904, lr_0 = 9.6618e-04
Validation rmse = 0.257881
Validation r2 = 0.465764
Validation mse = 0.066503
Epoch 3
Loss = 3.6390e-01, PNorm = 34.2437, GNorm = 2.7564, lr_0 = 9.4094e-04
Loss = 3.5373e-01, PNorm = 34.3098, GNorm = 3.1951, lr_0 = 9.1637e-04
Validation rmse = 0.246252
Validation r2 = 0.512862
Validation mse = 0.060640
Epoch 4
Loss = 3.6312e-01, PNorm = 34.3607, GNorm = 5.6300, lr_0 = 8.9007e-04
Validation rmse = 0.207510
Validation r2 = 0.654081
Validation mse = 0.043061
Epoch 5
Loss = 2.4448e-01, PNorm = 34.4170, GNorm = 1.6149, lr_0 = 8.6682e-04
Loss = 2.4673e-01, PNorm = 34.4615, GNorm = 2.9363, lr_0 = 8.4418e-04
Validation rmse = 0.192842
Validation r2 = 0.701259
Validation mse = 0.037188
Epoch 6
Loss = 2.1647e-01, PNorm = 34.5135, GNorm = 4.0686, lr_0 = 8.1996e-04
Validation rmse = 0.181310
Validation r2 = 0.735919
Validation mse = 0.032873
Epoch 7
Loss = 2.0653e-01, PNorm = 34.5494, GNorm = 4.8508, lr_0 = 7.9854e-04
Loss = 2.0680e-01, PNorm = 34.5862, GNorm = 12.6340, lr_0 = 7.7769e-04
Validation rmse = 0.194243
Validation r2 = 0.696901
Validation mse = 0.037730
Epoch 8
Loss = 2.3828e-01, PNorm = 34.6298, GNorm = 2.9959, lr_0 = 7.5537e-04
Validation rmse = 0.181146
Validation r2 = 0.736396
Validation mse = 0.032814
Epoch 9
Loss = 1.3053e-01, PNorm = 34.6636, GNorm = 1.1171, lr_0 = 7.3370e-04
Loss = 1.9043e-01, PNorm = 34.6946, GNorm = 5.0653, lr_0 = 7.1453e-04
Validation rmse = 0.169024
Validation r2 = 0.770496
Validation mse = 0.028569
Epoch 10
Loss = 1.3305e-01, PNorm = 34.7291, GNorm = 1.4432, lr_0 = 6.9587e-04
Validation rmse = 0.154731
Validation r2 = 0.807669
Validation mse = 0.023942
Epoch 11
Loss = 1.4586e-01, PNorm = 34.7580, GNorm = 0.8871, lr_0 = 6.7590e-04
Loss = 1.3096e-01, PNorm = 34.7796, GNorm = 5.3758, lr_0 = 6.5825e-04
Validation rmse = 0.172161
Validation r2 = 0.761898
Validation mse = 0.029639
Epoch 12
Loss = 1.4840e-01, PNorm = 34.7992, GNorm = 0.6983, lr_0 = 6.4106e-04
Loss = 1.3553e-01, PNorm = 34.8192, GNorm = 1.9426, lr_0 = 6.2431e-04
Loss = 1.2983e-01, PNorm = 34.8217, GNorm = 3.7371, lr_0 = 6.2266e-04
Validation rmse = 0.151082
Validation r2 = 0.816633
Validation mse = 0.022826
Epoch 13
Loss = 1.2166e-01, PNorm = 34.8383, GNorm = 1.9183, lr_0 = 6.0640e-04
Validation rmse = 0.150815
Validation r2 = 0.817282
Validation mse = 0.022745
Epoch 14
Loss = 1.0575e-01, PNorm = 34.8565, GNorm = 0.6769, lr_0 = 5.9056e-04
Loss = 1.1864e-01, PNorm = 34.8760, GNorm = 2.0292, lr_0 = 5.7514e-04
Validation rmse = 0.154893
Validation r2 = 0.807266
Validation mse = 0.023992
Epoch 15
Loss = 1.1906e-01, PNorm = 34.8859, GNorm = 1.4727, lr_0 = 5.5863e-04
Validation rmse = 0.147979
Validation r2 = 0.824089
Validation mse = 0.021898
Epoch 16
Loss = 1.6341e-01, PNorm = 34.9053, GNorm = 5.4602, lr_0 = 5.4404e-04
Loss = 1.1746e-01, PNorm = 34.9228, GNorm = 4.3005, lr_0 = 5.2983e-04
Validation rmse = 0.157992
Validation r2 = 0.799478
Validation mse = 0.024961
Epoch 17
Loss = 1.1185e-01, PNorm = 34.9379, GNorm = 0.6805, lr_0 = 5.1463e-04
Validation rmse = 0.149631
Validation r2 = 0.820139
Validation mse = 0.022389
Epoch 18
Loss = 1.0980e-01, PNorm = 34.9500, GNorm = 1.7526, lr_0 = 4.9986e-04
Loss = 1.2362e-01, PNorm = 34.9650, GNorm = 4.3125, lr_0 = 4.8681e-04
Validation rmse = 0.156661
Validation r2 = 0.802842
Validation mse = 0.024543
Epoch 19
Loss = 1.0707e-01, PNorm = 34.9757, GNorm = 1.3210, lr_0 = 4.7409e-04
Validation rmse = 0.174087
Validation r2 = 0.756540
Validation mse = 0.030306
Epoch 20
Loss = 1.4372e-01, PNorm = 34.9913, GNorm = 3.1079, lr_0 = 4.6049e-04
Loss = 1.1726e-01, PNorm = 35.0051, GNorm = 1.6995, lr_0 = 4.4846e-04
Validation rmse = 0.148961
Validation r2 = 0.821745
Validation mse = 0.022190
Epoch 21
Loss = 1.0344e-01, PNorm = 35.0164, GNorm = 2.7320, lr_0 = 4.3675e-04
Validation rmse = 0.156648
Validation r2 = 0.802874
Validation mse = 0.024539
Epoch 22
Loss = 7.8517e-02, PNorm = 35.0291, GNorm = 3.1150, lr_0 = 4.2422e-04
Loss = 1.0901e-01, PNorm = 35.0417, GNorm = 0.7424, lr_0 = 4.1313e-04
Validation rmse = 0.151700
Validation r2 = 0.815130
Validation mse = 0.023013
Epoch 23
Loss = 1.0033e-01, PNorm = 35.0527, GNorm = 2.5322, lr_0 = 4.0234e-04
Loss = 9.9903e-02, PNorm = 35.0626, GNorm = 2.8979, lr_0 = 3.9184e-04
Loss = 1.8048e-01, PNorm = 35.0641, GNorm = 1.7951, lr_0 = 3.9080e-04
Validation rmse = 0.143881
Validation r2 = 0.833697
Validation mse = 0.020702
Epoch 24
Loss = 9.5464e-02, PNorm = 35.0780, GNorm = 0.9654, lr_0 = 3.8059e-04
Validation rmse = 0.139982
Validation r2 = 0.842588
Validation mse = 0.019595
Epoch 25
Loss = 7.5088e-02, PNorm = 35.0853, GNorm = 1.0919, lr_0 = 3.7065e-04
Loss = 9.7612e-02, PNorm = 35.0933, GNorm = 2.6081, lr_0 = 3.6097e-04
Validation rmse = 0.142613
Validation r2 = 0.836616
Validation mse = 0.020338
Epoch 26
Loss = 9.2396e-02, PNorm = 35.1065, GNorm = 1.2182, lr_0 = 3.5061e-04
Validation rmse = 0.154182
Validation r2 = 0.809030
Validation mse = 0.023772
Epoch 27
Loss = 9.5351e-02, PNorm = 35.1180, GNorm = 1.8296, lr_0 = 3.4055e-04
Loss = 1.0468e-01, PNorm = 35.1285, GNorm = 3.1440, lr_0 = 3.3166e-04
Validation rmse = 0.149222
Validation r2 = 0.821120
Validation mse = 0.022267
Epoch 28
Loss = 8.7094e-02, PNorm = 35.1361, GNorm = 0.7074, lr_0 = 3.2299e-04
Validation rmse = 0.141112
Validation r2 = 0.840035
Validation mse = 0.019913
Epoch 29
Loss = 8.7504e-02, PNorm = 35.1469, GNorm = 1.1247, lr_0 = 3.1373e-04
Loss = 9.8396e-02, PNorm = 35.1545, GNorm = 1.2397, lr_0 = 3.0553e-04
Validation rmse = 0.145031
Validation r2 = 0.831028
Validation mse = 0.021034
Epoch 30
Loss = 9.0629e-02, PNorm = 35.1660, GNorm = 2.2460, lr_0 = 2.9755e-04
Validation rmse = 0.140174
Validation r2 = 0.842155
Validation mse = 0.019649
Epoch 31
Loss = 7.8274e-02, PNorm = 35.1745, GNorm = 0.5738, lr_0 = 2.8901e-04
Loss = 9.0457e-02, PNorm = 35.1828, GNorm = 0.9394, lr_0 = 2.8147e-04
Validation rmse = 0.140881
Validation r2 = 0.840560
Validation mse = 0.019847
Epoch 32
Loss = 8.8524e-02, PNorm = 35.1897, GNorm = 0.9169, lr_0 = 2.7411e-04
Validation rmse = 0.146601
Validation r2 = 0.827349
Validation mse = 0.021492
Epoch 33
Loss = 1.1672e-01, PNorm = 35.1985, GNorm = 3.6456, lr_0 = 2.6625e-04
Loss = 1.0276e-01, PNorm = 35.2067, GNorm = 3.6320, lr_0 = 2.5929e-04
Validation rmse = 0.140829
Validation r2 = 0.840677
Validation mse = 0.019833
Epoch 34
Loss = 9.0179e-02, PNorm = 35.2172, GNorm = 0.6611, lr_0 = 2.5185e-04
Loss = 8.9963e-02, PNorm = 35.2231, GNorm = 4.1997, lr_0 = 2.4528e-04
Validation rmse = 0.141420
Validation r2 = 0.839337
Validation mse = 0.020000
Epoch 35
Loss = 8.9383e-02, PNorm = 35.2309, GNorm = 1.2518, lr_0 = 2.3887e-04
Validation rmse = 0.148258
Validation r2 = 0.823424
Validation mse = 0.021980
Epoch 36
Loss = 9.4305e-02, PNorm = 35.2375, GNorm = 1.4426, lr_0 = 2.3202e-04
Loss = 8.6284e-02, PNorm = 35.2440, GNorm = 2.3921, lr_0 = 2.2596e-04
Validation rmse = 0.145332
Validation r2 = 0.830326
Validation mse = 0.021121
Epoch 37
Loss = 8.0963e-02, PNorm = 35.2506, GNorm = 1.2594, lr_0 = 2.2005e-04
Validation rmse = 0.141337
Validation r2 = 0.839526
Validation mse = 0.019976
Epoch 38
Loss = 8.2799e-02, PNorm = 35.2568, GNorm = 1.8015, lr_0 = 2.1374e-04
Loss = 8.6150e-02, PNorm = 35.2615, GNorm = 1.7256, lr_0 = 2.0816e-04
Validation rmse = 0.137550
Validation r2 = 0.848009
Validation mse = 0.018920
Epoch 39
Loss = 6.9511e-02, PNorm = 35.2672, GNorm = 1.5026, lr_0 = 2.0272e-04
Validation rmse = 0.140698
Validation r2 = 0.840974
Validation mse = 0.019796
Epoch 40
Loss = 9.8117e-02, PNorm = 35.2736, GNorm = 0.6457, lr_0 = 1.9690e-04
Loss = 7.9547e-02, PNorm = 35.2792, GNorm = 0.4721, lr_0 = 1.9176e-04
Validation rmse = 0.139711
Validation r2 = 0.843198
Validation mse = 0.019519
Epoch 41
Loss = 8.6065e-02, PNorm = 35.2843, GNorm = 1.6355, lr_0 = 1.8675e-04
Validation rmse = 0.139866
Validation r2 = 0.842848
Validation mse = 0.019563
Epoch 42
Loss = 6.4109e-02, PNorm = 35.2898, GNorm = 0.6789, lr_0 = 1.8139e-04
Loss = 8.6155e-02, PNorm = 35.2959, GNorm = 3.9826, lr_0 = 1.7666e-04
Validation rmse = 0.141805
Validation r2 = 0.838462
Validation mse = 0.020109
Epoch 43
Loss = 8.3187e-02, PNorm = 35.3001, GNorm = 2.3902, lr_0 = 1.7159e-04
Validation rmse = 0.138842
Validation r2 = 0.845142
Validation mse = 0.019277
Epoch 44
Loss = 7.8182e-02, PNorm = 35.3062, GNorm = 2.4338, lr_0 = 1.6710e-04
Loss = 8.2217e-02, PNorm = 35.3116, GNorm = 4.0636, lr_0 = 1.6274e-04
Validation rmse = 0.138976
Validation r2 = 0.844843
Validation mse = 0.019314
Epoch 45
Loss = 8.6077e-02, PNorm = 35.3159, GNorm = 1.2282, lr_0 = 1.5807e-04
Loss = 7.0129e-02, PNorm = 35.3204, GNorm = 1.6189, lr_0 = 1.5394e-04
Validation rmse = 0.139788
Validation r2 = 0.843023
Validation mse = 0.019541
Epoch 46
Loss = 8.1136e-02, PNorm = 35.3252, GNorm = 1.4510, lr_0 = 1.4992e-04
Validation rmse = 0.139998
Validation r2 = 0.842552
Validation mse = 0.019599
Epoch 47
Loss = 8.5518e-02, PNorm = 35.3299, GNorm = 0.6301, lr_0 = 1.4562e-04
Loss = 7.0550e-02, PNorm = 35.3339, GNorm = 0.4490, lr_0 = 1.4182e-04
Validation rmse = 0.139170
Validation r2 = 0.844410
Validation mse = 0.019368
Epoch 48
Loss = 8.2379e-02, PNorm = 35.3388, GNorm = 0.5723, lr_0 = 1.3811e-04
Validation rmse = 0.137795
Validation r2 = 0.847468
Validation mse = 0.018987
Epoch 49
Loss = 7.0831e-02, PNorm = 35.3426, GNorm = 0.7103, lr_0 = 1.3415e-04
Loss = 7.9766e-02, PNorm = 35.3463, GNorm = 2.9878, lr_0 = 1.3064e-04
Validation rmse = 0.139048
Validation r2 = 0.844681
Validation mse = 0.019334
Epoch 50
Loss = 7.0490e-02, PNorm = 35.3494, GNorm = 1.3274, lr_0 = 1.2723e-04
Validation rmse = 0.138169
Validation r2 = 0.846638
Validation mse = 0.019091
Epoch 51
Loss = 7.9146e-02, PNorm = 35.3539, GNorm = 1.9826, lr_0 = 1.2358e-04
Loss = 6.9606e-02, PNorm = 35.3568, GNorm = 1.2336, lr_0 = 1.2035e-04
Validation rmse = 0.137153
Validation r2 = 0.848886
Validation mse = 0.018811
Epoch 52
Loss = 7.1063e-02, PNorm = 35.3612, GNorm = 0.9118, lr_0 = 1.1690e-04
Validation rmse = 0.137934
Validation r2 = 0.847161
Validation mse = 0.019026
Epoch 53
Loss = 6.1238e-02, PNorm = 35.3643, GNorm = 1.4564, lr_0 = 1.1385e-04
Loss = 7.9788e-02, PNorm = 35.3677, GNorm = 1.4773, lr_0 = 1.1087e-04
Validation rmse = 0.138956
Validation r2 = 0.844886
Validation mse = 0.019309
Epoch 54
Loss = 7.1526e-02, PNorm = 35.3715, GNorm = 0.8161, lr_0 = 1.0769e-04
Validation rmse = 0.138999
Validation r2 = 0.844790
Validation mse = 0.019321
Epoch 55
Loss = 6.4038e-02, PNorm = 35.3746, GNorm = 1.0749, lr_0 = 1.0488e-04
Loss = 7.2144e-02, PNorm = 35.3782, GNorm = 0.8001, lr_0 = 1.0214e-04
Validation rmse = 0.137758
Validation r2 = 0.847551
Validation mse = 0.018977
Epoch 56
Loss = 7.6003e-02, PNorm = 35.3806, GNorm = 1.2123, lr_0 = 1.0000e-04
Loss = 7.5493e-02, PNorm = 35.3840, GNorm = 1.7475, lr_0 = 1.0000e-04
Validation rmse = 0.138008
Validation r2 = 0.846996
Validation mse = 0.019046
Epoch 57
Loss = 7.3208e-02, PNorm = 35.3866, GNorm = 0.8092, lr_0 = 1.0000e-04
Validation rmse = 0.137717
Validation r2 = 0.847641
Validation mse = 0.018966
Epoch 58
Loss = 8.3010e-02, PNorm = 35.3899, GNorm = 0.7142, lr_0 = 1.0000e-04
Loss = 6.8897e-02, PNorm = 35.3938, GNorm = 1.2392, lr_0 = 1.0000e-04
Loss = 3.1178e-02, PNorm = 35.3940, GNorm = 1.0204, lr_0 = 1.0000e-04
Validation rmse = 0.138238
Validation r2 = 0.846487
Validation mse = 0.019110
Epoch 59
Loss = 6.8789e-02, PNorm = 35.3969, GNorm = 1.0069, lr_0 = 1.0000e-04
Validation rmse = 0.139026
Validation r2 = 0.844729
Validation mse = 0.019328
Model 0 best validation rmse = 0.137153 on epoch 51
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.149785
Model 0 test r2 = 0.712237
Model 0 test mse = 0.022435
Ensemble test rmse = 0.149785
Ensemble test r2 = 0.712237
Ensemble test mse = 0.022435
Fold 8
Splitting data with seed 8
Total size = 966 | train size = 772 | val size = 194 | test size = 56
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.9747e-01, PNorm = 34.0172, GNorm = 2.5162, lr_0 = 4.3000e-04
Validation rmse = 0.378852
Validation r2 = -0.233246
Validation mse = 0.143529
Epoch 1
Loss = 9.5847e-01, PNorm = 34.0453, GNorm = 17.4114, lr_0 = 7.6000e-04
Loss = 8.1263e-01, PNorm = 34.0876, GNorm = 4.2590, lr_0 = 9.9472e-04
Loss = 1.1231e+00, PNorm = 34.0923, GNorm = 8.5601, lr_0 = 9.9209e-04
Validation rmse = 0.316596
Validation r2 = 0.138765
Validation mse = 0.100233
Epoch 2
Loss = 6.8495e-01, PNorm = 34.1569, GNorm = 0.9525, lr_0 = 9.6618e-04
Validation rmse = 0.288858
Validation r2 = 0.283069
Validation mse = 0.083439
Epoch 3
Loss = 4.6677e-01, PNorm = 34.2305, GNorm = 3.1455, lr_0 = 9.4094e-04
Loss = 3.7380e-01, PNorm = 34.2977, GNorm = 2.8852, lr_0 = 9.1637e-04
Validation rmse = 0.248192
Validation r2 = 0.470720
Validation mse = 0.061599
Epoch 4
Loss = 3.0561e-01, PNorm = 34.3761, GNorm = 1.3893, lr_0 = 8.9007e-04
Validation rmse = 0.210570
Validation r2 = 0.619021
Validation mse = 0.044340
Epoch 5
Loss = 1.8863e-01, PNorm = 34.4392, GNorm = 1.5071, lr_0 = 8.6682e-04
Loss = 2.5427e-01, PNorm = 34.4970, GNorm = 3.5443, lr_0 = 8.4418e-04
Validation rmse = 0.218125
Validation r2 = 0.591190
Validation mse = 0.047579
Epoch 6
Loss = 2.0249e-01, PNorm = 34.5508, GNorm = 1.1950, lr_0 = 8.1996e-04
Validation rmse = 0.176024
Validation r2 = 0.733772
Validation mse = 0.030984
Epoch 7
Loss = 1.6416e-01, PNorm = 34.5966, GNorm = 1.5786, lr_0 = 7.9854e-04
Loss = 1.9340e-01, PNorm = 34.6400, GNorm = 3.8763, lr_0 = 7.7769e-04
Validation rmse = 0.170693
Validation r2 = 0.749653
Validation mse = 0.029136
Epoch 8
Loss = 1.5480e-01, PNorm = 34.6770, GNorm = 2.7259, lr_0 = 7.5537e-04
Validation rmse = 0.164182
Validation r2 = 0.768388
Validation mse = 0.026956
Epoch 9
Loss = 9.6046e-02, PNorm = 34.7101, GNorm = 1.4810, lr_0 = 7.3370e-04
Loss = 1.5843e-01, PNorm = 34.7371, GNorm = 3.9899, lr_0 = 7.1453e-04
Validation rmse = 0.179427
Validation r2 = 0.723379
Validation mse = 0.032194
Epoch 10
Loss = 1.3819e-01, PNorm = 34.7608, GNorm = 2.3837, lr_0 = 6.9587e-04
Validation rmse = 0.155608
Validation r2 = 0.791948
Validation mse = 0.024214
Epoch 11
Loss = 9.7313e-02, PNorm = 34.7884, GNorm = 2.2553, lr_0 = 6.7590e-04
Loss = 1.2291e-01, PNorm = 34.8044, GNorm = 0.8201, lr_0 = 6.5825e-04
Validation rmse = 0.161532
Validation r2 = 0.775805
Validation mse = 0.026093
Epoch 12
Loss = 1.0217e-01, PNorm = 34.8236, GNorm = 2.5876, lr_0 = 6.4106e-04
Loss = 1.5213e-01, PNorm = 34.8425, GNorm = 3.0874, lr_0 = 6.2431e-04
Loss = 2.2127e-01, PNorm = 34.8442, GNorm = 5.7459, lr_0 = 6.2266e-04
Validation rmse = 0.174967
Validation r2 = 0.736960
Validation mse = 0.030613
Epoch 13
Loss = 1.4773e-01, PNorm = 34.8586, GNorm = 3.5397, lr_0 = 6.0640e-04
Validation rmse = 0.161948
Validation r2 = 0.774649
Validation mse = 0.026227
Epoch 14
Loss = 1.0518e-01, PNorm = 34.8771, GNorm = 1.6807, lr_0 = 5.9056e-04
Loss = 1.1859e-01, PNorm = 34.8966, GNorm = 0.8751, lr_0 = 5.7514e-04
Validation rmse = 0.161930
Validation r2 = 0.774699
Validation mse = 0.026221
Epoch 15
Loss = 1.1075e-01, PNorm = 34.9119, GNorm = 1.2262, lr_0 = 5.5863e-04
Validation rmse = 0.184431
Validation r2 = 0.707735
Validation mse = 0.034015
Epoch 16
Loss = 1.4820e-01, PNorm = 34.9295, GNorm = 0.6579, lr_0 = 5.4404e-04
Loss = 1.3630e-01, PNorm = 34.9439, GNorm = 3.5328, lr_0 = 5.2983e-04
Validation rmse = 0.170784
Validation r2 = 0.749386
Validation mse = 0.029167
Epoch 17
Loss = 9.9873e-02, PNorm = 34.9613, GNorm = 1.4268, lr_0 = 5.1463e-04
Validation rmse = 0.167413
Validation r2 = 0.759183
Validation mse = 0.028027
Epoch 18
Loss = 1.2673e-01, PNorm = 34.9737, GNorm = 1.1722, lr_0 = 4.9986e-04
Loss = 1.1275e-01, PNorm = 34.9859, GNorm = 2.2497, lr_0 = 4.8681e-04
Validation rmse = 0.161728
Validation r2 = 0.775260
Validation mse = 0.026156
Epoch 19
Loss = 1.0203e-01, PNorm = 34.9961, GNorm = 0.9810, lr_0 = 4.7409e-04
Validation rmse = 0.149994
Validation r2 = 0.806689
Validation mse = 0.022498
Epoch 20
Loss = 9.1135e-02, PNorm = 35.0100, GNorm = 1.1982, lr_0 = 4.6049e-04
Loss = 9.5101e-02, PNorm = 35.0202, GNorm = 0.5171, lr_0 = 4.4846e-04
Validation rmse = 0.153368
Validation r2 = 0.797893
Validation mse = 0.023522
Epoch 21
Loss = 1.1829e-01, PNorm = 35.0278, GNorm = 2.4364, lr_0 = 4.3675e-04
Validation rmse = 0.158061
Validation r2 = 0.785337
Validation mse = 0.024983
Epoch 22
Loss = 6.5796e-02, PNorm = 35.0409, GNorm = 0.5906, lr_0 = 4.2422e-04
Loss = 9.6349e-02, PNorm = 35.0501, GNorm = 1.6316, lr_0 = 4.1313e-04
Validation rmse = 0.161168
Validation r2 = 0.776814
Validation mse = 0.025975
Epoch 23
Loss = 9.7953e-02, PNorm = 35.0633, GNorm = 0.5407, lr_0 = 4.0234e-04
Loss = 9.1842e-02, PNorm = 35.0727, GNorm = 0.5595, lr_0 = 3.9184e-04
Loss = 8.1233e-02, PNorm = 35.0738, GNorm = 1.2941, lr_0 = 3.9080e-04
Validation rmse = 0.151871
Validation r2 = 0.801819
Validation mse = 0.023065
Epoch 24
Loss = 9.8037e-02, PNorm = 35.0849, GNorm = 2.3052, lr_0 = 3.8059e-04
Validation rmse = 0.158831
Validation r2 = 0.783239
Validation mse = 0.025227
Epoch 25
Loss = 7.7894e-02, PNorm = 35.0931, GNorm = 1.6535, lr_0 = 3.7065e-04
Loss = 1.0326e-01, PNorm = 35.1035, GNorm = 3.9817, lr_0 = 3.6097e-04
Validation rmse = 0.178848
Validation r2 = 0.725163
Validation mse = 0.031986
Epoch 26
Loss = 1.1690e-01, PNorm = 35.1110, GNorm = 1.3645, lr_0 = 3.5061e-04
Validation rmse = 0.155604
Validation r2 = 0.791957
Validation mse = 0.024213
Epoch 27
Loss = 1.0862e-01, PNorm = 35.1228, GNorm = 1.7370, lr_0 = 3.4055e-04
Loss = 9.6560e-02, PNorm = 35.1334, GNorm = 2.8489, lr_0 = 3.3166e-04
Validation rmse = 0.153020
Validation r2 = 0.798809
Validation mse = 0.023415
Epoch 28
Loss = 1.0249e-01, PNorm = 35.1426, GNorm = 0.7294, lr_0 = 3.2299e-04
Validation rmse = 0.154414
Validation r2 = 0.795128
Validation mse = 0.023844
Epoch 29
Loss = 9.4464e-02, PNorm = 35.1534, GNorm = 1.3026, lr_0 = 3.1373e-04
Loss = 8.6840e-02, PNorm = 35.1614, GNorm = 0.9555, lr_0 = 3.0553e-04
Validation rmse = 0.150718
Validation r2 = 0.804817
Validation mse = 0.022716
Epoch 30
Loss = 8.8843e-02, PNorm = 35.1702, GNorm = 1.7106, lr_0 = 2.9755e-04
Validation rmse = 0.153494
Validation r2 = 0.797563
Validation mse = 0.023560
Epoch 31
Loss = 8.7554e-02, PNorm = 35.1772, GNorm = 1.4022, lr_0 = 2.8901e-04
Loss = 7.6834e-02, PNorm = 35.1842, GNorm = 0.4223, lr_0 = 2.8147e-04
Validation rmse = 0.154044
Validation r2 = 0.796108
Validation mse = 0.023730
Epoch 32
Loss = 9.1920e-02, PNorm = 35.1936, GNorm = 1.6434, lr_0 = 2.7411e-04
Validation rmse = 0.148105
Validation r2 = 0.811527
Validation mse = 0.021935
Epoch 33
Loss = 7.4911e-02, PNorm = 35.2015, GNorm = 0.6085, lr_0 = 2.6625e-04
Loss = 8.6185e-02, PNorm = 35.2092, GNorm = 0.6549, lr_0 = 2.5929e-04
Validation rmse = 0.165138
Validation r2 = 0.765684
Validation mse = 0.027270
Epoch 34
Loss = 9.9269e-02, PNorm = 35.2152, GNorm = 0.5854, lr_0 = 2.5185e-04
Loss = 9.9838e-02, PNorm = 35.2209, GNorm = 1.1755, lr_0 = 2.4528e-04
Validation rmse = 0.150498
Validation r2 = 0.805387
Validation mse = 0.022650
Epoch 35
Loss = 7.5374e-02, PNorm = 35.2284, GNorm = 2.2259, lr_0 = 2.3887e-04
Validation rmse = 0.156679
Validation r2 = 0.789073
Validation mse = 0.024548
Epoch 36
Loss = 6.6941e-02, PNorm = 35.2359, GNorm = 1.3066, lr_0 = 2.3202e-04
Loss = 8.7526e-02, PNorm = 35.2423, GNorm = 0.8268, lr_0 = 2.2596e-04
Validation rmse = 0.154688
Validation r2 = 0.794401
Validation mse = 0.023928
Epoch 37
Loss = 8.0404e-02, PNorm = 35.2494, GNorm = 0.7375, lr_0 = 2.2005e-04
Validation rmse = 0.149843
Validation r2 = 0.807078
Validation mse = 0.022453
Epoch 38
Loss = 8.3400e-02, PNorm = 35.2566, GNorm = 0.5463, lr_0 = 2.1374e-04
Loss = 8.4412e-02, PNorm = 35.2628, GNorm = 1.6698, lr_0 = 2.0816e-04
Validation rmse = 0.162728
Validation r2 = 0.772472
Validation mse = 0.026480
Epoch 39
Loss = 8.2648e-02, PNorm = 35.2691, GNorm = 0.5602, lr_0 = 2.0272e-04
Validation rmse = 0.154118
Validation r2 = 0.795913
Validation mse = 0.023752
Epoch 40
Loss = 8.2793e-02, PNorm = 35.2742, GNorm = 0.5639, lr_0 = 1.9690e-04
Loss = 8.0733e-02, PNorm = 35.2785, GNorm = 1.0820, lr_0 = 1.9176e-04
Validation rmse = 0.154841
Validation r2 = 0.793993
Validation mse = 0.023976
Epoch 41
Loss = 8.4154e-02, PNorm = 35.2846, GNorm = 1.7399, lr_0 = 1.8675e-04
Validation rmse = 0.151196
Validation r2 = 0.803579
Validation mse = 0.022860
Epoch 42
Loss = 5.4499e-02, PNorm = 35.2898, GNorm = 0.6818, lr_0 = 1.8139e-04
Loss = 7.7380e-02, PNorm = 35.2953, GNorm = 0.5210, lr_0 = 1.7666e-04
Validation rmse = 0.150636
Validation r2 = 0.805029
Validation mse = 0.022691
Epoch 43
Loss = 8.0364e-02, PNorm = 35.3003, GNorm = 0.8954, lr_0 = 1.7159e-04
Validation rmse = 0.151903
Validation r2 = 0.801736
Validation mse = 0.023075
Epoch 44
Loss = 5.4140e-02, PNorm = 35.3061, GNorm = 0.6354, lr_0 = 1.6710e-04
Loss = 8.3210e-02, PNorm = 35.3114, GNorm = 1.2338, lr_0 = 1.6274e-04
Validation rmse = 0.152748
Validation r2 = 0.799526
Validation mse = 0.023332
Epoch 45
Loss = 6.9305e-02, PNorm = 35.3172, GNorm = 1.5385, lr_0 = 1.5807e-04
Loss = 8.1079e-02, PNorm = 35.3210, GNorm = 1.1615, lr_0 = 1.5394e-04
Validation rmse = 0.150627
Validation r2 = 0.805053
Validation mse = 0.022689
Epoch 46
Loss = 8.3552e-02, PNorm = 35.3247, GNorm = 0.8113, lr_0 = 1.4992e-04
Validation rmse = 0.155045
Validation r2 = 0.793449
Validation mse = 0.024039
Epoch 47
Loss = 8.2517e-02, PNorm = 35.3297, GNorm = 2.4772, lr_0 = 1.4562e-04
Loss = 7.3643e-02, PNorm = 35.3334, GNorm = 1.2062, lr_0 = 1.4182e-04
Validation rmse = 0.167288
Validation r2 = 0.759543
Validation mse = 0.027985
Epoch 48
Loss = 7.7755e-02, PNorm = 35.3378, GNorm = 0.9041, lr_0 = 1.3811e-04
Validation rmse = 0.150082
Validation r2 = 0.806461
Validation mse = 0.022525
Epoch 49
Loss = 8.9450e-02, PNorm = 35.3418, GNorm = 0.5272, lr_0 = 1.3415e-04
Loss = 7.3133e-02, PNorm = 35.3460, GNorm = 0.3151, lr_0 = 1.3064e-04
Validation rmse = 0.152747
Validation r2 = 0.799528
Validation mse = 0.023332
Epoch 50
Loss = 7.5085e-02, PNorm = 35.3492, GNorm = 0.6495, lr_0 = 1.2723e-04
Validation rmse = 0.151164
Validation r2 = 0.803660
Validation mse = 0.022851
Epoch 51
Loss = 8.1810e-02, PNorm = 35.3543, GNorm = 0.9626, lr_0 = 1.2358e-04
Loss = 6.9562e-02, PNorm = 35.3575, GNorm = 2.6287, lr_0 = 1.2035e-04
Validation rmse = 0.155020
Validation r2 = 0.793517
Validation mse = 0.024031
Epoch 52
Loss = 6.5737e-02, PNorm = 35.3610, GNorm = 0.6108, lr_0 = 1.1690e-04
Validation rmse = 0.165338
Validation r2 = 0.765115
Validation mse = 0.027337
Epoch 53
Loss = 9.4217e-02, PNorm = 35.3638, GNorm = 2.2224, lr_0 = 1.1385e-04
Loss = 7.4023e-02, PNorm = 35.3676, GNorm = 0.7427, lr_0 = 1.1087e-04
Validation rmse = 0.158110
Validation r2 = 0.785202
Validation mse = 0.024999
Epoch 54
Loss = 7.1399e-02, PNorm = 35.3715, GNorm = 0.5604, lr_0 = 1.0769e-04
Validation rmse = 0.156448
Validation r2 = 0.789695
Validation mse = 0.024476
Epoch 55
Loss = 7.3028e-02, PNorm = 35.3750, GNorm = 1.4887, lr_0 = 1.0488e-04
Loss = 7.7864e-02, PNorm = 35.3774, GNorm = 0.9076, lr_0 = 1.0214e-04
Validation rmse = 0.152683
Validation r2 = 0.799694
Validation mse = 0.023312
Epoch 56
Loss = 6.9922e-02, PNorm = 35.3814, GNorm = 0.7120, lr_0 = 1.0000e-04
Loss = 7.4052e-02, PNorm = 35.3845, GNorm = 1.5459, lr_0 = 1.0000e-04
Validation rmse = 0.150047
Validation r2 = 0.806551
Validation mse = 0.022514
Epoch 57
Loss = 6.9603e-02, PNorm = 35.3878, GNorm = 1.0690, lr_0 = 1.0000e-04
Validation rmse = 0.154421
Validation r2 = 0.795109
Validation mse = 0.023846
Epoch 58
Loss = 7.3417e-02, PNorm = 35.3915, GNorm = 0.6491, lr_0 = 1.0000e-04
Loss = 7.0564e-02, PNorm = 35.3945, GNorm = 0.8558, lr_0 = 1.0000e-04
Loss = 2.2038e-02, PNorm = 35.3947, GNorm = 0.5762, lr_0 = 1.0000e-04
Validation rmse = 0.152995
Validation r2 = 0.798875
Validation mse = 0.023408
Epoch 59
Loss = 7.0392e-02, PNorm = 35.3974, GNorm = 1.2876, lr_0 = 1.0000e-04
Validation rmse = 0.155588
Validation r2 = 0.792002
Validation mse = 0.024208
Model 0 best validation rmse = 0.148105 on epoch 32
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.154320
Model 0 test r2 = 0.694548
Model 0 test mse = 0.023815
Ensemble test rmse = 0.154320
Ensemble test r2 = 0.694548
Ensemble test mse = 0.023815
Fold 9
Splitting data with seed 9
Total size = 966 | train size = 772 | val size = 194 | test size = 56
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.3955e-01, PNorm = 34.0146, GNorm = 8.0765, lr_0 = 4.3000e-04
Validation rmse = 0.360721
Validation r2 = -0.105568
Validation mse = 0.130119
Epoch 1
Loss = 8.0795e-01, PNorm = 34.0365, GNorm = 2.8673, lr_0 = 7.6000e-04
Loss = 7.5456e-01, PNorm = 34.0908, GNorm = 1.5358, lr_0 = 9.9472e-04
Loss = 5.3828e-01, PNorm = 34.0981, GNorm = 2.4726, lr_0 = 9.9209e-04
Validation rmse = 0.300441
Validation r2 = 0.233061
Validation mse = 0.090265
Epoch 2
Loss = 6.2599e-01, PNorm = 34.1704, GNorm = 4.3016, lr_0 = 9.6618e-04
Validation rmse = 0.243750
Validation r2 = 0.495186
Validation mse = 0.059414
Epoch 3
Loss = 3.9438e-01, PNorm = 34.2567, GNorm = 0.7825, lr_0 = 9.4094e-04
Loss = 3.9165e-01, PNorm = 34.3293, GNorm = 4.5374, lr_0 = 9.1637e-04
Validation rmse = 0.213523
Validation r2 = 0.612623
Validation mse = 0.045592
Epoch 4
Loss = 3.4590e-01, PNorm = 34.4086, GNorm = 5.5758, lr_0 = 8.9007e-04
Validation rmse = 0.234391
Validation r2 = 0.533204
Validation mse = 0.054939
Epoch 5
Loss = 3.4476e-01, PNorm = 34.4669, GNorm = 1.0190, lr_0 = 8.6682e-04
Loss = 2.9585e-01, PNorm = 34.5202, GNorm = 3.0278, lr_0 = 8.4418e-04
Validation rmse = 0.185028
Validation r2 = 0.709117
Validation mse = 0.034235
Epoch 6
Loss = 2.3157e-01, PNorm = 34.5731, GNorm = 2.2470, lr_0 = 8.1996e-04
Validation rmse = 0.190730
Validation r2 = 0.690913
Validation mse = 0.036378
Epoch 7
Loss = 2.7633e-01, PNorm = 34.6193, GNorm = 1.0935, lr_0 = 7.9854e-04
Loss = 2.4115e-01, PNorm = 34.6641, GNorm = 5.3029, lr_0 = 7.7769e-04
Validation rmse = 0.180124
Validation r2 = 0.724330
Validation mse = 0.032445
Epoch 8
Loss = 1.6820e-01, PNorm = 34.7078, GNorm = 1.4924, lr_0 = 7.5537e-04
Validation rmse = 0.152297
Validation r2 = 0.802926
Validation mse = 0.023195
Epoch 9
Loss = 1.7592e-01, PNorm = 34.7470, GNorm = 4.5331, lr_0 = 7.3370e-04
Loss = 1.6432e-01, PNorm = 34.7780, GNorm = 2.5371, lr_0 = 7.1453e-04
Validation rmse = 0.149264
Validation r2 = 0.810698
Validation mse = 0.022280
Epoch 10
Loss = 1.3138e-01, PNorm = 34.8044, GNorm = 0.7845, lr_0 = 6.9587e-04
Validation rmse = 0.143801
Validation r2 = 0.824302
Validation mse = 0.020679
Epoch 11
Loss = 1.2793e-01, PNorm = 34.8322, GNorm = 1.2684, lr_0 = 6.7590e-04
Loss = 1.4028e-01, PNorm = 34.8595, GNorm = 1.0185, lr_0 = 6.5825e-04
Validation rmse = 0.144714
Validation r2 = 0.822063
Validation mse = 0.020942
Epoch 12
Loss = 1.1961e-01, PNorm = 34.8799, GNorm = 2.9516, lr_0 = 6.4106e-04
Loss = 1.5408e-01, PNorm = 34.9045, GNorm = 3.2231, lr_0 = 6.2431e-04
Loss = 2.7219e-01, PNorm = 34.9059, GNorm = 8.3822, lr_0 = 6.2266e-04
Validation rmse = 0.147864
Validation r2 = 0.814232
Validation mse = 0.021864
Epoch 13
Loss = 1.2340e-01, PNorm = 34.9264, GNorm = 2.1043, lr_0 = 6.0640e-04
Validation rmse = 0.154088
Validation r2 = 0.798265
Validation mse = 0.023743
Epoch 14
Loss = 1.2140e-01, PNorm = 34.9500, GNorm = 0.8108, lr_0 = 5.9056e-04
Loss = 1.2805e-01, PNorm = 34.9716, GNorm = 3.7157, lr_0 = 5.7514e-04
Validation rmse = 0.139538
Validation r2 = 0.834564
Validation mse = 0.019471
Epoch 15
Loss = 1.0909e-01, PNorm = 34.9956, GNorm = 1.0808, lr_0 = 5.5863e-04
Validation rmse = 0.138683
Validation r2 = 0.836585
Validation mse = 0.019233
Epoch 16
Loss = 1.2713e-01, PNorm = 35.0129, GNorm = 1.0321, lr_0 = 5.4404e-04
Loss = 1.1914e-01, PNorm = 35.0317, GNorm = 1.1321, lr_0 = 5.2983e-04
Validation rmse = 0.142610
Validation r2 = 0.827199
Validation mse = 0.020338
Epoch 17
Loss = 9.9157e-02, PNorm = 35.0479, GNorm = 0.8759, lr_0 = 5.1463e-04
Validation rmse = 0.138840
Validation r2 = 0.836215
Validation mse = 0.019277
Epoch 18
Loss = 1.2498e-01, PNorm = 35.0640, GNorm = 1.6120, lr_0 = 4.9986e-04
Loss = 1.0843e-01, PNorm = 35.0800, GNorm = 1.4188, lr_0 = 4.8681e-04
Validation rmse = 0.137148
Validation r2 = 0.840184
Validation mse = 0.018810
Epoch 19
Loss = 1.0140e-01, PNorm = 35.0961, GNorm = 0.9500, lr_0 = 4.7409e-04
Validation rmse = 0.137234
Validation r2 = 0.839984
Validation mse = 0.018833
Epoch 20
Loss = 1.1792e-01, PNorm = 35.1142, GNorm = 1.8864, lr_0 = 4.6049e-04
Loss = 9.8004e-02, PNorm = 35.1275, GNorm = 0.4911, lr_0 = 4.4846e-04
Validation rmse = 0.134994
Validation r2 = 0.845164
Validation mse = 0.018223
Epoch 21
Loss = 9.9710e-02, PNorm = 35.1383, GNorm = 0.8477, lr_0 = 4.3675e-04
Validation rmse = 0.140419
Validation r2 = 0.832469
Validation mse = 0.019717
Epoch 22
Loss = 8.8024e-02, PNorm = 35.1514, GNorm = 0.9860, lr_0 = 4.2422e-04
Loss = 9.7499e-02, PNorm = 35.1687, GNorm = 1.2837, lr_0 = 4.1313e-04
Validation rmse = 0.135213
Validation r2 = 0.844661
Validation mse = 0.018283
Epoch 23
Loss = 8.5954e-02, PNorm = 35.1814, GNorm = 0.7024, lr_0 = 4.0234e-04
Loss = 9.4807e-02, PNorm = 35.1947, GNorm = 0.5462, lr_0 = 3.9184e-04
Loss = 1.1329e-01, PNorm = 35.1956, GNorm = 0.8977, lr_0 = 3.9080e-04
Validation rmse = 0.134601
Validation r2 = 0.846064
Validation mse = 0.018117
Epoch 24
Loss = 9.5727e-02, PNorm = 35.2081, GNorm = 1.0542, lr_0 = 3.8059e-04
Validation rmse = 0.146905
Validation r2 = 0.816636
Validation mse = 0.021581
Epoch 25
Loss = 1.0860e-01, PNorm = 35.2201, GNorm = 2.7059, lr_0 = 3.7065e-04
Loss = 1.0217e-01, PNorm = 35.2323, GNorm = 1.7669, lr_0 = 3.6097e-04
Validation rmse = 0.136701
Validation r2 = 0.841222
Validation mse = 0.018687
Epoch 26
Loss = 9.6967e-02, PNorm = 35.2408, GNorm = 1.2939, lr_0 = 3.5061e-04
Validation rmse = 0.137156
Validation r2 = 0.840165
Validation mse = 0.018812
Epoch 27
Loss = 1.0462e-01, PNorm = 35.2561, GNorm = 0.8879, lr_0 = 3.4055e-04
Loss = 9.5865e-02, PNorm = 35.2686, GNorm = 1.5835, lr_0 = 3.3166e-04
Validation rmse = 0.132901
Validation r2 = 0.849927
Validation mse = 0.017663
Epoch 28
Loss = 9.2521e-02, PNorm = 35.2797, GNorm = 0.4740, lr_0 = 3.2299e-04
Validation rmse = 0.137287
Validation r2 = 0.839860
Validation mse = 0.018848
Epoch 29
Loss = 8.2786e-02, PNorm = 35.2904, GNorm = 1.0599, lr_0 = 3.1373e-04
Loss = 8.7797e-02, PNorm = 35.3013, GNorm = 1.0148, lr_0 = 3.0553e-04
Validation rmse = 0.133347
Validation r2 = 0.848920
Validation mse = 0.017781
Epoch 30
Loss = 9.5248e-02, PNorm = 35.3100, GNorm = 1.6398, lr_0 = 2.9755e-04
Validation rmse = 0.138308
Validation r2 = 0.837467
Validation mse = 0.019129
Epoch 31
Loss = 8.2222e-02, PNorm = 35.3182, GNorm = 0.9098, lr_0 = 2.8901e-04
Loss = 8.8045e-02, PNorm = 35.3278, GNorm = 0.5919, lr_0 = 2.8147e-04
Validation rmse = 0.133192
Validation r2 = 0.849271
Validation mse = 0.017740
Epoch 32
Loss = 7.9305e-02, PNorm = 35.3372, GNorm = 0.8649, lr_0 = 2.7411e-04
Validation rmse = 0.136785
Validation r2 = 0.841027
Validation mse = 0.018710
Epoch 33
Loss = 6.6794e-02, PNorm = 35.3465, GNorm = 1.2455, lr_0 = 2.6625e-04
Loss = 8.3475e-02, PNorm = 35.3545, GNorm = 1.9880, lr_0 = 2.5929e-04
Validation rmse = 0.133524
Validation r2 = 0.848517
Validation mse = 0.017829
Epoch 34
Loss = 7.1507e-02, PNorm = 35.3644, GNorm = 1.2606, lr_0 = 2.5185e-04
Loss = 9.2730e-02, PNorm = 35.3720, GNorm = 3.0713, lr_0 = 2.4528e-04
Validation rmse = 0.133249
Validation r2 = 0.849140
Validation mse = 0.017755
Epoch 35
Loss = 8.1471e-02, PNorm = 35.3791, GNorm = 2.0741, lr_0 = 2.3887e-04
Validation rmse = 0.137590
Validation r2 = 0.839152
Validation mse = 0.018931
Epoch 36
Loss = 9.2163e-02, PNorm = 35.3869, GNorm = 1.2059, lr_0 = 2.3202e-04
Loss = 7.9916e-02, PNorm = 35.3959, GNorm = 0.5290, lr_0 = 2.2596e-04
Validation rmse = 0.133812
Validation r2 = 0.847864
Validation mse = 0.017906
Epoch 37
Loss = 7.6064e-02, PNorm = 35.4029, GNorm = 0.9948, lr_0 = 2.2005e-04
Validation rmse = 0.135896
Validation r2 = 0.843088
Validation mse = 0.018468
Epoch 38
Loss = 8.1702e-02, PNorm = 35.4112, GNorm = 1.1871, lr_0 = 2.1374e-04
Loss = 8.0427e-02, PNorm = 35.4179, GNorm = 1.2706, lr_0 = 2.0816e-04
Validation rmse = 0.135366
Validation r2 = 0.844309
Validation mse = 0.018324
Epoch 39
Loss = 7.5158e-02, PNorm = 35.4238, GNorm = 1.4968, lr_0 = 2.0272e-04
Validation rmse = 0.135347
Validation r2 = 0.844352
Validation mse = 0.018319
Epoch 40
Loss = 8.6621e-02, PNorm = 35.4298, GNorm = 1.5442, lr_0 = 1.9690e-04
Loss = 7.7281e-02, PNorm = 35.4363, GNorm = 0.6378, lr_0 = 1.9176e-04
Validation rmse = 0.136816
Validation r2 = 0.840955
Validation mse = 0.018719
Epoch 41
Loss = 6.8005e-02, PNorm = 35.4433, GNorm = 1.3378, lr_0 = 1.8675e-04
Validation rmse = 0.135329
Validation r2 = 0.844395
Validation mse = 0.018314
Epoch 42
Loss = 8.2346e-02, PNorm = 35.4506, GNorm = 2.0293, lr_0 = 1.8139e-04
Loss = 8.1026e-02, PNorm = 35.4566, GNorm = 2.5601, lr_0 = 1.7666e-04
Validation rmse = 0.133413
Validation r2 = 0.848770
Validation mse = 0.017799
Epoch 43
Loss = 6.9415e-02, PNorm = 35.4615, GNorm = 0.5567, lr_0 = 1.7159e-04
Validation rmse = 0.136034
Validation r2 = 0.842769
Validation mse = 0.018505
Epoch 44
Loss = 4.2112e-02, PNorm = 35.4673, GNorm = 0.4780, lr_0 = 1.6710e-04
Loss = 6.8150e-02, PNorm = 35.4734, GNorm = 0.5650, lr_0 = 1.6274e-04
Validation rmse = 0.136015
Validation r2 = 0.842812
Validation mse = 0.018500
Epoch 45
Loss = 6.5788e-02, PNorm = 35.4781, GNorm = 0.9252, lr_0 = 1.5807e-04
Loss = 7.8911e-02, PNorm = 35.4830, GNorm = 1.4842, lr_0 = 1.5394e-04
Validation rmse = 0.134424
Validation r2 = 0.846467
Validation mse = 0.018070
Epoch 46
Loss = 7.0400e-02, PNorm = 35.4885, GNorm = 1.4158, lr_0 = 1.4992e-04
Validation rmse = 0.137193
Validation r2 = 0.840078
Validation mse = 0.018822
Epoch 47
Loss = 8.0528e-02, PNorm = 35.4930, GNorm = 1.5499, lr_0 = 1.4562e-04
Loss = 7.2846e-02, PNorm = 35.4982, GNorm = 1.4352, lr_0 = 1.4182e-04
Validation rmse = 0.134563
Validation r2 = 0.846151
Validation mse = 0.018107
Epoch 48
Loss = 7.6325e-02, PNorm = 35.5039, GNorm = 0.5301, lr_0 = 1.3811e-04
Validation rmse = 0.136628
Validation r2 = 0.841394
Validation mse = 0.018667
Epoch 49
Loss = 8.7137e-02, PNorm = 35.5075, GNorm = 2.0088, lr_0 = 1.3415e-04
Loss = 8.1821e-02, PNorm = 35.5129, GNorm = 1.6246, lr_0 = 1.3064e-04
Validation rmse = 0.135067
Validation r2 = 0.844996
Validation mse = 0.018243
Epoch 50
Loss = 8.1101e-02, PNorm = 35.5170, GNorm = 1.3001, lr_0 = 1.2723e-04
Validation rmse = 0.135082
Validation r2 = 0.844961
Validation mse = 0.018247
Epoch 51
Loss = 7.2507e-02, PNorm = 35.5218, GNorm = 0.6368, lr_0 = 1.2358e-04
Loss = 7.3044e-02, PNorm = 35.5258, GNorm = 0.8695, lr_0 = 1.2035e-04
Validation rmse = 0.134579
Validation r2 = 0.846115
Validation mse = 0.018111
Epoch 52
Loss = 7.3998e-02, PNorm = 35.5301, GNorm = 0.8854, lr_0 = 1.1690e-04
Validation rmse = 0.134845
Validation r2 = 0.845506
Validation mse = 0.018183
Epoch 53
Loss = 5.7952e-02, PNorm = 35.5343, GNorm = 0.6158, lr_0 = 1.1385e-04
Loss = 7.1803e-02, PNorm = 35.5373, GNorm = 0.8472, lr_0 = 1.1087e-04
Validation rmse = 0.134063
Validation r2 = 0.847292
Validation mse = 0.017973
Epoch 54
Loss = 5.5640e-02, PNorm = 35.5412, GNorm = 0.7752, lr_0 = 1.0769e-04
Validation rmse = 0.134989
Validation r2 = 0.845175
Validation mse = 0.018222
Epoch 55
Loss = 8.4001e-02, PNorm = 35.5444, GNorm = 1.5056, lr_0 = 1.0488e-04
Loss = 7.1623e-02, PNorm = 35.5481, GNorm = 2.1506, lr_0 = 1.0214e-04
Validation rmse = 0.133932
Validation r2 = 0.847590
Validation mse = 0.017938
Epoch 56
Loss = 6.3289e-02, PNorm = 35.5519, GNorm = 0.4261, lr_0 = 1.0000e-04
Loss = 7.5961e-02, PNorm = 35.5556, GNorm = 1.6673, lr_0 = 1.0000e-04
Validation rmse = 0.134395
Validation r2 = 0.846534
Validation mse = 0.018062
Epoch 57
Loss = 6.7044e-02, PNorm = 35.5588, GNorm = 1.3190, lr_0 = 1.0000e-04
Validation rmse = 0.135135
Validation r2 = 0.844841
Validation mse = 0.018261
Epoch 58
Loss = 6.7185e-02, PNorm = 35.5625, GNorm = 2.3941, lr_0 = 1.0000e-04
Loss = 7.4181e-02, PNorm = 35.5665, GNorm = 1.9799, lr_0 = 1.0000e-04
Loss = 2.4304e-02, PNorm = 35.5668, GNorm = 0.6468, lr_0 = 1.0000e-04
Validation rmse = 0.133674
Validation r2 = 0.848177
Validation mse = 0.017869
Epoch 59
Loss = 7.2302e-02, PNorm = 35.5698, GNorm = 0.5022, lr_0 = 1.0000e-04
Validation rmse = 0.135166
Validation r2 = 0.844768
Validation mse = 0.018270
Model 0 best validation rmse = 0.132901 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.174883
Model 0 test r2 = 0.607719
Model 0 test mse = 0.030584
Ensemble test rmse = 0.174883
Ensemble test r2 = 0.607719
Ensemble test mse = 0.030584
10-fold cross validation
	Seed 0 ==> test rmse = 0.166874
	Seed 0 ==> test r2 = 0.642825
	Seed 0 ==> test mse = 0.027847
	Seed 1 ==> test rmse = 0.162763
	Seed 1 ==> test r2 = 0.660210
	Seed 1 ==> test mse = 0.026492
	Seed 2 ==> test rmse = 0.179501
	Seed 2 ==> test r2 = 0.586728
	Seed 2 ==> test mse = 0.032221
	Seed 3 ==> test rmse = 0.170579
	Seed 3 ==> test r2 = 0.626792
	Seed 3 ==> test mse = 0.029097
	Seed 4 ==> test rmse = 0.179483
	Seed 4 ==> test r2 = 0.586813
	Seed 4 ==> test mse = 0.032214
	Seed 5 ==> test rmse = 0.167701
	Seed 5 ==> test r2 = 0.639277
	Seed 5 ==> test mse = 0.028124
	Seed 6 ==> test rmse = 0.195728
	Seed 6 ==> test r2 = 0.508631
	Seed 6 ==> test mse = 0.038310
	Seed 7 ==> test rmse = 0.149785
	Seed 7 ==> test r2 = 0.712237
	Seed 7 ==> test mse = 0.022435
	Seed 8 ==> test rmse = 0.154320
	Seed 8 ==> test r2 = 0.694548
	Seed 8 ==> test mse = 0.023815
	Seed 9 ==> test rmse = 0.174883
	Seed 9 ==> test r2 = 0.607719
	Seed 9 ==> test mse = 0.030584
Overall test rmse = 0.170162 +/- 0.012602
Overall test r2 = 0.626578 +/- 0.055633
Overall test mse = 0.029114 +/- 0.004337
Elapsed time = 0:06:51
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-1d5c3576-9790-4896-9034-9bb28ba18d8e.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/IPA_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2', 'mse'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2', 'mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/generalization_3/IPA_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/IPA_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 965 | train size = 772 | val size = 193 | test size = 57
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.4451e-01, PNorm = 34.0167, GNorm = 5.6223, lr_0 = 4.3000e-04
Validation rmse = 0.318770
Validation r2 = 0.212443
Validation mse = 0.101615
Epoch 1
Loss = 7.5395e-01, PNorm = 34.0436, GNorm = 3.9536, lr_0 = 7.6000e-04
Loss = 7.2309e-01, PNorm = 34.0949, GNorm = 11.7912, lr_0 = 9.9472e-04
Loss = 7.0984e-01, PNorm = 34.1018, GNorm = 10.0819, lr_0 = 9.9209e-04
Validation rmse = 0.253973
Validation r2 = 0.500078
Validation mse = 0.064502
Epoch 2
Loss = 6.3672e-01, PNorm = 34.1700, GNorm = 2.9730, lr_0 = 9.6618e-04
Validation rmse = 0.219350
Validation r2 = 0.627093
Validation mse = 0.048114
Epoch 3
Loss = 3.8533e-01, PNorm = 34.2501, GNorm = 3.6187, lr_0 = 9.4094e-04
Loss = 3.5456e-01, PNorm = 34.3133, GNorm = 1.0250, lr_0 = 9.1637e-04
Validation rmse = 0.231346
Validation r2 = 0.585191
Validation mse = 0.053521
Epoch 4
Loss = 4.3402e-01, PNorm = 34.3923, GNorm = 9.0036, lr_0 = 8.9007e-04
Validation rmse = 0.188947
Validation r2 = 0.723302
Validation mse = 0.035701
Epoch 5
Loss = 2.5077e-01, PNorm = 34.4470, GNorm = 2.0566, lr_0 = 8.6682e-04
Loss = 3.0470e-01, PNorm = 34.5027, GNorm = 1.1215, lr_0 = 8.4418e-04
Validation rmse = 0.171644
Validation r2 = 0.771659
Validation mse = 0.029462
Epoch 6
Loss = 2.0638e-01, PNorm = 34.5521, GNorm = 1.0474, lr_0 = 8.1996e-04
Validation rmse = 0.196492
Validation r2 = 0.700762
Validation mse = 0.038609
Epoch 7
Loss = 2.4192e-01, PNorm = 34.5954, GNorm = 8.0946, lr_0 = 7.9854e-04
Loss = 2.2354e-01, PNorm = 34.6355, GNorm = 1.3704, lr_0 = 7.7769e-04
Validation rmse = 0.177393
Validation r2 = 0.756107
Validation mse = 0.031468
Epoch 8
Loss = 1.8187e-01, PNorm = 34.6719, GNorm = 1.3105, lr_0 = 7.5537e-04
Validation rmse = 0.144142
Validation r2 = 0.838969
Validation mse = 0.020777
Epoch 9
Loss = 1.4595e-01, PNorm = 34.7082, GNorm = 1.9972, lr_0 = 7.3370e-04
Loss = 2.3144e-01, PNorm = 34.7414, GNorm = 3.4479, lr_0 = 7.1453e-04
Validation rmse = 0.145845
Validation r2 = 0.835141
Validation mse = 0.021271
Epoch 10
Loss = 1.5325e-01, PNorm = 34.7763, GNorm = 4.4172, lr_0 = 6.9587e-04
Validation rmse = 0.133899
Validation r2 = 0.861042
Validation mse = 0.017929
Epoch 11
Loss = 1.0275e-01, PNorm = 34.8099, GNorm = 0.8798, lr_0 = 6.7590e-04
Loss = 1.4233e-01, PNorm = 34.8433, GNorm = 1.3650, lr_0 = 6.5825e-04
Validation rmse = 0.126020
Validation r2 = 0.876916
Validation mse = 0.015881
Epoch 12
Loss = 1.2425e-01, PNorm = 34.8671, GNorm = 0.9143, lr_0 = 6.4106e-04
Loss = 1.4977e-01, PNorm = 34.8877, GNorm = 2.4091, lr_0 = 6.2431e-04
Loss = 1.1658e-01, PNorm = 34.8898, GNorm = 1.7156, lr_0 = 6.2266e-04
Validation rmse = 0.143915
Validation r2 = 0.839476
Validation mse = 0.020712
Epoch 13
Loss = 1.4822e-01, PNorm = 34.9064, GNorm = 0.5253, lr_0 = 6.0640e-04
Validation rmse = 0.122758
Validation r2 = 0.883204
Validation mse = 0.015070
Epoch 14
Loss = 8.5596e-02, PNorm = 34.9280, GNorm = 1.6227, lr_0 = 5.9056e-04
Loss = 1.3221e-01, PNorm = 34.9502, GNorm = 2.5125, lr_0 = 5.7514e-04
Validation rmse = 0.133220
Validation r2 = 0.862448
Validation mse = 0.017748
Epoch 15
Loss = 1.4889e-01, PNorm = 34.9643, GNorm = 4.6458, lr_0 = 5.5863e-04
Validation rmse = 0.121099
Validation r2 = 0.886340
Validation mse = 0.014665
Epoch 16
Loss = 1.0608e-01, PNorm = 34.9841, GNorm = 2.6548, lr_0 = 5.4404e-04
Loss = 1.2415e-01, PNorm = 35.0045, GNorm = 2.1576, lr_0 = 5.2983e-04
Validation rmse = 0.120693
Validation r2 = 0.887101
Validation mse = 0.014567
Epoch 17
Loss = 1.1607e-01, PNorm = 35.0266, GNorm = 1.4135, lr_0 = 5.1463e-04
Validation rmse = 0.122607
Validation r2 = 0.883492
Validation mse = 0.015032
Epoch 18
Loss = 1.2622e-01, PNorm = 35.0410, GNorm = 1.1911, lr_0 = 4.9986e-04
Loss = 1.0581e-01, PNorm = 35.0529, GNorm = 1.0507, lr_0 = 4.8681e-04
Validation rmse = 0.121445
Validation r2 = 0.885691
Validation mse = 0.014749
Epoch 19
Loss = 1.1353e-01, PNorm = 35.0704, GNorm = 1.5816, lr_0 = 4.7409e-04
Validation rmse = 0.123667
Validation r2 = 0.881469
Validation mse = 0.015294
Epoch 20
Loss = 1.0960e-01, PNorm = 35.0868, GNorm = 2.3236, lr_0 = 4.6049e-04
Loss = 1.1389e-01, PNorm = 35.0995, GNorm = 3.6133, lr_0 = 4.4846e-04
Validation rmse = 0.122036
Validation r2 = 0.884574
Validation mse = 0.014893
Epoch 21
Loss = 9.7913e-02, PNorm = 35.1137, GNorm = 2.1695, lr_0 = 4.3675e-04
Validation rmse = 0.119234
Validation r2 = 0.889815
Validation mse = 0.014217
Epoch 22
Loss = 8.2951e-02, PNorm = 35.1230, GNorm = 1.0954, lr_0 = 4.2422e-04
Loss = 9.7881e-02, PNorm = 35.1399, GNorm = 2.8941, lr_0 = 4.1313e-04
Validation rmse = 0.121287
Validation r2 = 0.885987
Validation mse = 0.014711
Epoch 23
Loss = 8.4758e-02, PNorm = 35.1466, GNorm = 0.7334, lr_0 = 4.0234e-04
Loss = 1.1078e-01, PNorm = 35.1586, GNorm = 1.0216, lr_0 = 3.9184e-04
Loss = 1.5169e-01, PNorm = 35.1598, GNorm = 2.6810, lr_0 = 3.9080e-04
Validation rmse = 0.119440
Validation r2 = 0.889433
Validation mse = 0.014266
Epoch 24
Loss = 1.0361e-01, PNorm = 35.1738, GNorm = 0.8062, lr_0 = 3.8059e-04
Validation rmse = 0.118180
Validation r2 = 0.891753
Validation mse = 0.013967
Epoch 25
Loss = 1.0295e-01, PNorm = 35.1874, GNorm = 0.6681, lr_0 = 3.7065e-04
Loss = 9.1295e-02, PNorm = 35.1994, GNorm = 1.5649, lr_0 = 3.6097e-04
Validation rmse = 0.118205
Validation r2 = 0.891707
Validation mse = 0.013972
Epoch 26
Loss = 9.2875e-02, PNorm = 35.2112, GNorm = 0.5256, lr_0 = 3.5061e-04
Validation rmse = 0.118508
Validation r2 = 0.891152
Validation mse = 0.014044
Epoch 27
Loss = 9.3234e-02, PNorm = 35.2225, GNorm = 2.0073, lr_0 = 3.4055e-04
Loss = 9.2397e-02, PNorm = 35.2327, GNorm = 0.5467, lr_0 = 3.3166e-04
Validation rmse = 0.115315
Validation r2 = 0.896939
Validation mse = 0.013297
Epoch 28
Loss = 7.8859e-02, PNorm = 35.2430, GNorm = 0.9713, lr_0 = 3.2299e-04
Validation rmse = 0.116092
Validation r2 = 0.895545
Validation mse = 0.013477
Epoch 29
Loss = 9.3704e-02, PNorm = 35.2564, GNorm = 1.4974, lr_0 = 3.1373e-04
Loss = 9.8650e-02, PNorm = 35.2687, GNorm = 1.3890, lr_0 = 3.0553e-04
Validation rmse = 0.115845
Validation r2 = 0.895989
Validation mse = 0.013420
Epoch 30
Loss = 9.5704e-02, PNorm = 35.2776, GNorm = 3.3262, lr_0 = 2.9755e-04
Validation rmse = 0.117873
Validation r2 = 0.892314
Validation mse = 0.013894
Epoch 31
Loss = 8.8488e-02, PNorm = 35.2886, GNorm = 1.4416, lr_0 = 2.8901e-04
Loss = 8.9372e-02, PNorm = 35.2967, GNorm = 1.8274, lr_0 = 2.8147e-04
Validation rmse = 0.115064
Validation r2 = 0.897386
Validation mse = 0.013240
Epoch 32
Loss = 7.9596e-02, PNorm = 35.3069, GNorm = 0.7352, lr_0 = 2.7411e-04
Validation rmse = 0.117870
Validation r2 = 0.892320
Validation mse = 0.013893
Epoch 33
Loss = 1.2124e-01, PNorm = 35.3190, GNorm = 1.5848, lr_0 = 2.6625e-04
Loss = 8.7882e-02, PNorm = 35.3293, GNorm = 0.9092, lr_0 = 2.5929e-04
Validation rmse = 0.116368
Validation r2 = 0.895047
Validation mse = 0.013542
Epoch 34
Loss = 8.2757e-02, PNorm = 35.3373, GNorm = 0.5952, lr_0 = 2.5185e-04
Loss = 8.7822e-02, PNorm = 35.3436, GNorm = 1.8980, lr_0 = 2.4528e-04
Validation rmse = 0.123029
Validation r2 = 0.882688
Validation mse = 0.015136
Epoch 35
Loss = 8.4856e-02, PNorm = 35.3537, GNorm = 2.3797, lr_0 = 2.3887e-04
Validation rmse = 0.114049
Validation r2 = 0.899189
Validation mse = 0.013007
Epoch 36
Loss = 7.6789e-02, PNorm = 35.3632, GNorm = 1.5452, lr_0 = 2.3202e-04
Loss = 9.0734e-02, PNorm = 35.3702, GNorm = 1.2993, lr_0 = 2.2596e-04
Validation rmse = 0.113758
Validation r2 = 0.899703
Validation mse = 0.012941
Epoch 37
Loss = 8.0854e-02, PNorm = 35.3785, GNorm = 1.1512, lr_0 = 2.2005e-04
Validation rmse = 0.114506
Validation r2 = 0.898379
Validation mse = 0.013112
Epoch 38
Loss = 7.8904e-02, PNorm = 35.3855, GNorm = 2.3023, lr_0 = 2.1374e-04
Loss = 8.8794e-02, PNorm = 35.3924, GNorm = 2.8834, lr_0 = 2.0816e-04
Validation rmse = 0.115870
Validation r2 = 0.895944
Validation mse = 0.013426
Epoch 39
Loss = 8.8565e-02, PNorm = 35.4015, GNorm = 1.9448, lr_0 = 2.0272e-04
Validation rmse = 0.125277
Validation r2 = 0.878363
Validation mse = 0.015694
Epoch 40
Loss = 9.0289e-02, PNorm = 35.4086, GNorm = 1.8621, lr_0 = 1.9690e-04
Loss = 8.8876e-02, PNorm = 35.4141, GNorm = 2.7658, lr_0 = 1.9176e-04
Validation rmse = 0.116917
Validation r2 = 0.894055
Validation mse = 0.013670
Epoch 41
Loss = 7.9939e-02, PNorm = 35.4211, GNorm = 1.0814, lr_0 = 1.8675e-04
Validation rmse = 0.118120
Validation r2 = 0.891863
Validation mse = 0.013952
Epoch 42
Loss = 7.2516e-02, PNorm = 35.4287, GNorm = 1.3148, lr_0 = 1.8139e-04
Loss = 8.3684e-02, PNorm = 35.4356, GNorm = 1.8722, lr_0 = 1.7666e-04
Validation rmse = 0.113187
Validation r2 = 0.900707
Validation mse = 0.012811
Epoch 43
Loss = 7.3544e-02, PNorm = 35.4408, GNorm = 1.3911, lr_0 = 1.7159e-04
Validation rmse = 0.113375
Validation r2 = 0.900377
Validation mse = 0.012854
Epoch 44
Loss = 7.2370e-02, PNorm = 35.4460, GNorm = 1.2419, lr_0 = 1.6710e-04
Loss = 8.1779e-02, PNorm = 35.4505, GNorm = 0.7078, lr_0 = 1.6274e-04
Validation rmse = 0.114343
Validation r2 = 0.898668
Validation mse = 0.013074
Epoch 45
Loss = 8.3592e-02, PNorm = 35.4567, GNorm = 0.5630, lr_0 = 1.5807e-04
Loss = 7.6703e-02, PNorm = 35.4615, GNorm = 1.7615, lr_0 = 1.5394e-04
Validation rmse = 0.114370
Validation r2 = 0.898621
Validation mse = 0.013080
Epoch 46
Loss = 7.9277e-02, PNorm = 35.4674, GNorm = 1.2731, lr_0 = 1.4992e-04
Validation rmse = 0.114326
Validation r2 = 0.898698
Validation mse = 0.013071
Epoch 47
Loss = 7.2349e-02, PNorm = 35.4724, GNorm = 1.3696, lr_0 = 1.4562e-04
Loss = 7.6934e-02, PNorm = 35.4775, GNorm = 1.4208, lr_0 = 1.4182e-04
Validation rmse = 0.116056
Validation r2 = 0.895610
Validation mse = 0.013469
Epoch 48
Loss = 7.2665e-02, PNorm = 35.4836, GNorm = 1.0014, lr_0 = 1.3811e-04
Validation rmse = 0.114351
Validation r2 = 0.898654
Validation mse = 0.013076
Epoch 49
Loss = 6.2105e-02, PNorm = 35.4884, GNorm = 1.0511, lr_0 = 1.3415e-04
Loss = 7.7991e-02, PNorm = 35.4927, GNorm = 0.6092, lr_0 = 1.3064e-04
Validation rmse = 0.113652
Validation r2 = 0.899889
Validation mse = 0.012917
Epoch 50
Loss = 8.0875e-02, PNorm = 35.4985, GNorm = 1.8349, lr_0 = 1.2723e-04
Validation rmse = 0.114496
Validation r2 = 0.898397
Validation mse = 0.013109
Epoch 51
Loss = 7.1321e-02, PNorm = 35.5029, GNorm = 1.7995, lr_0 = 1.2358e-04
Loss = 7.4003e-02, PNorm = 35.5058, GNorm = 1.3227, lr_0 = 1.2035e-04
Validation rmse = 0.113725
Validation r2 = 0.899761
Validation mse = 0.012933
Epoch 52
Loss = 7.9607e-02, PNorm = 35.5102, GNorm = 1.4782, lr_0 = 1.1690e-04
Validation rmse = 0.112942
Validation r2 = 0.901136
Validation mse = 0.012756
Epoch 53
Loss = 5.8383e-02, PNorm = 35.5139, GNorm = 0.5376, lr_0 = 1.1385e-04
Loss = 6.9910e-02, PNorm = 35.5178, GNorm = 1.7683, lr_0 = 1.1087e-04
Validation rmse = 0.118099
Validation r2 = 0.891901
Validation mse = 0.013947
Epoch 54
Loss = 8.1076e-02, PNorm = 35.5220, GNorm = 1.0971, lr_0 = 1.0769e-04
Validation rmse = 0.115414
Validation r2 = 0.896761
Validation mse = 0.013320
Epoch 55
Loss = 5.5950e-02, PNorm = 35.5252, GNorm = 1.1964, lr_0 = 1.0488e-04
Loss = 7.6654e-02, PNorm = 35.5286, GNorm = 1.4019, lr_0 = 1.0214e-04
Validation rmse = 0.113472
Validation r2 = 0.900206
Validation mse = 0.012876
Epoch 56
Loss = 8.0579e-02, PNorm = 35.5320, GNorm = 0.7621, lr_0 = 1.0000e-04
Loss = 6.5116e-02, PNorm = 35.5352, GNorm = 2.8427, lr_0 = 1.0000e-04
Validation rmse = 0.113504
Validation r2 = 0.900150
Validation mse = 0.012883
Epoch 57
Loss = 7.6284e-02, PNorm = 35.5385, GNorm = 0.9445, lr_0 = 1.0000e-04
Validation rmse = 0.112929
Validation r2 = 0.901159
Validation mse = 0.012753
Epoch 58
Loss = 7.9071e-02, PNorm = 35.5420, GNorm = 0.5803, lr_0 = 1.0000e-04
Loss = 6.7541e-02, PNorm = 35.5456, GNorm = 0.3882, lr_0 = 1.0000e-04
Loss = 5.6953e-02, PNorm = 35.5459, GNorm = 0.6937, lr_0 = 1.0000e-04
Validation rmse = 0.113515
Validation r2 = 0.900131
Validation mse = 0.012886
Epoch 59
Loss = 7.0073e-02, PNorm = 35.5496, GNorm = 1.1482, lr_0 = 1.0000e-04
Validation rmse = 0.113023
Validation r2 = 0.900995
Validation mse = 0.012774
Model 0 best validation rmse = 0.112929 on epoch 57
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.204801
Model 0 test r2 = 0.618817
Model 0 test mse = 0.041943
Ensemble test rmse = 0.204801
Ensemble test r2 = 0.618817
Ensemble test mse = 0.041943
Fold 1
Splitting data with seed 1
Total size = 965 | train size = 772 | val size = 193 | test size = 57
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.7903e-01, PNorm = 34.0167, GNorm = 5.5166, lr_0 = 4.3000e-04
Validation rmse = 0.304469
Validation r2 = 0.252147
Validation mse = 0.092701
Epoch 1
Loss = 6.8385e-01, PNorm = 34.0473, GNorm = 1.0164, lr_0 = 7.6000e-04
Loss = 5.9909e-01, PNorm = 34.1198, GNorm = 2.5544, lr_0 = 9.9472e-04
Loss = 4.0687e-01, PNorm = 34.1281, GNorm = 3.1654, lr_0 = 9.9209e-04
Validation rmse = 0.243549
Validation r2 = 0.521477
Validation mse = 0.059316
Epoch 2
Loss = 5.0149e-01, PNorm = 34.2033, GNorm = 1.6582, lr_0 = 9.6618e-04
Validation rmse = 0.218190
Validation r2 = 0.615939
Validation mse = 0.047607
Epoch 3
Loss = 3.2814e-01, PNorm = 34.2688, GNorm = 0.8156, lr_0 = 9.4094e-04
Loss = 2.9488e-01, PNorm = 34.3406, GNorm = 0.8687, lr_0 = 9.1637e-04
Validation rmse = 0.187667
Validation r2 = 0.715878
Validation mse = 0.035219
Epoch 4
Loss = 2.4581e-01, PNorm = 34.4070, GNorm = 5.6947, lr_0 = 8.9007e-04
Validation rmse = 0.185230
Validation r2 = 0.723208
Validation mse = 0.034310
Epoch 5
Loss = 3.2908e-01, PNorm = 34.4531, GNorm = 1.3996, lr_0 = 8.6682e-04
Loss = 1.8896e-01, PNorm = 34.5055, GNorm = 3.2573, lr_0 = 8.4418e-04
Validation rmse = 0.167711
Validation r2 = 0.773090
Validation mse = 0.028127
Epoch 6
Loss = 1.6686e-01, PNorm = 34.5526, GNorm = 2.7297, lr_0 = 8.1996e-04
Validation rmse = 0.176429
Validation r2 = 0.748884
Validation mse = 0.031127
Epoch 7
Loss = 1.4390e-01, PNorm = 34.5900, GNorm = 2.6980, lr_0 = 7.9854e-04
Loss = 1.7284e-01, PNorm = 34.6320, GNorm = 2.0501, lr_0 = 7.7769e-04
Validation rmse = 0.157012
Validation r2 = 0.801118
Validation mse = 0.024653
Epoch 8
Loss = 1.5574e-01, PNorm = 34.6728, GNorm = 6.4131, lr_0 = 7.5537e-04
Validation rmse = 0.163668
Validation r2 = 0.783897
Validation mse = 0.026787
Epoch 9
Loss = 1.2555e-01, PNorm = 34.7049, GNorm = 5.4043, lr_0 = 7.3370e-04
Loss = 1.3679e-01, PNorm = 34.7267, GNorm = 4.2133, lr_0 = 7.1453e-04
Validation rmse = 0.166811
Validation r2 = 0.775519
Validation mse = 0.027826
Epoch 10
Loss = 1.5515e-01, PNorm = 34.7493, GNorm = 6.0477, lr_0 = 6.9587e-04
Validation rmse = 0.160982
Validation r2 = 0.790933
Validation mse = 0.025915
Epoch 11
Loss = 1.2818e-01, PNorm = 34.7737, GNorm = 1.8775, lr_0 = 6.7590e-04
Loss = 1.4031e-01, PNorm = 34.7894, GNorm = 5.9696, lr_0 = 6.5825e-04
Validation rmse = 0.159777
Validation r2 = 0.794051
Validation mse = 0.025529
Epoch 12
Loss = 1.3948e-01, PNorm = 34.8089, GNorm = 1.2630, lr_0 = 6.4106e-04
Loss = 1.2364e-01, PNorm = 34.8269, GNorm = 2.5636, lr_0 = 6.2431e-04
Loss = 1.4532e-01, PNorm = 34.8279, GNorm = 2.9271, lr_0 = 6.2266e-04
Validation rmse = 0.191471
Validation r2 = 0.704240
Validation mse = 0.036661
Epoch 13
Loss = 1.4371e-01, PNorm = 34.8466, GNorm = 2.5902, lr_0 = 6.0640e-04
Validation rmse = 0.148917
Validation r2 = 0.821095
Validation mse = 0.022176
Epoch 14
Loss = 9.2720e-02, PNorm = 34.8627, GNorm = 0.6857, lr_0 = 5.9056e-04
Loss = 1.0555e-01, PNorm = 34.8811, GNorm = 1.1175, lr_0 = 5.7514e-04
Validation rmse = 0.148028
Validation r2 = 0.823225
Validation mse = 0.021912
Epoch 15
Loss = 8.8425e-02, PNorm = 34.8902, GNorm = 1.2255, lr_0 = 5.5863e-04
Validation rmse = 0.151621
Validation r2 = 0.814540
Validation mse = 0.022989
Epoch 16
Loss = 1.2265e-01, PNorm = 34.9013, GNorm = 1.7541, lr_0 = 5.4404e-04
Loss = 1.0378e-01, PNorm = 34.9117, GNorm = 1.8267, lr_0 = 5.2983e-04
Validation rmse = 0.152737
Validation r2 = 0.811800
Validation mse = 0.023329
Epoch 17
Loss = 9.9264e-02, PNorm = 34.9278, GNorm = 1.3819, lr_0 = 5.1463e-04
Validation rmse = 0.152351
Validation r2 = 0.812750
Validation mse = 0.023211
Epoch 18
Loss = 9.4476e-02, PNorm = 34.9417, GNorm = 0.8306, lr_0 = 4.9986e-04
Loss = 9.6775e-02, PNorm = 34.9524, GNorm = 0.6637, lr_0 = 4.8681e-04
Validation rmse = 0.153836
Validation r2 = 0.809081
Validation mse = 0.023666
Epoch 19
Loss = 9.8942e-02, PNorm = 34.9647, GNorm = 3.7454, lr_0 = 4.7409e-04
Validation rmse = 0.147822
Validation r2 = 0.823718
Validation mse = 0.021851
Epoch 20
Loss = 1.1149e-01, PNorm = 34.9780, GNorm = 2.5316, lr_0 = 4.6049e-04
Loss = 9.7336e-02, PNorm = 34.9904, GNorm = 1.0535, lr_0 = 4.4846e-04
Validation rmse = 0.145495
Validation r2 = 0.829223
Validation mse = 0.021169
Epoch 21
Loss = 1.0202e-01, PNorm = 34.9977, GNorm = 3.3075, lr_0 = 4.3675e-04
Validation rmse = 0.146492
Validation r2 = 0.826875
Validation mse = 0.021460
Epoch 22
Loss = 7.1594e-02, PNorm = 35.0097, GNorm = 2.1045, lr_0 = 4.2422e-04
Loss = 1.0162e-01, PNorm = 35.0197, GNorm = 0.5809, lr_0 = 4.1313e-04
Validation rmse = 0.150152
Validation r2 = 0.818116
Validation mse = 0.022546
Epoch 23
Loss = 1.0055e-01, PNorm = 35.0322, GNorm = 1.4618, lr_0 = 4.0234e-04
Loss = 9.5306e-02, PNorm = 35.0414, GNorm = 1.1617, lr_0 = 3.9184e-04
Loss = 6.2069e-02, PNorm = 35.0423, GNorm = 0.5141, lr_0 = 3.9080e-04
Validation rmse = 0.151096
Validation r2 = 0.815822
Validation mse = 0.022830
Epoch 24
Loss = 8.8526e-02, PNorm = 35.0528, GNorm = 0.6892, lr_0 = 3.8059e-04
Validation rmse = 0.147312
Validation r2 = 0.824933
Validation mse = 0.021701
Epoch 25
Loss = 8.1130e-02, PNorm = 35.0610, GNorm = 2.1009, lr_0 = 3.7065e-04
Loss = 9.3354e-02, PNorm = 35.0693, GNorm = 1.2899, lr_0 = 3.6097e-04
Validation rmse = 0.145597
Validation r2 = 0.828983
Validation mse = 0.021199
Epoch 26
Loss = 8.0189e-02, PNorm = 35.0805, GNorm = 1.2972, lr_0 = 3.5061e-04
Validation rmse = 0.146187
Validation r2 = 0.827595
Validation mse = 0.021371
Epoch 27
Loss = 9.1172e-02, PNorm = 35.0914, GNorm = 1.4306, lr_0 = 3.4055e-04
Loss = 8.5578e-02, PNorm = 35.1000, GNorm = 0.9008, lr_0 = 3.3166e-04
Validation rmse = 0.157909
Validation r2 = 0.798838
Validation mse = 0.024935
Epoch 28
Loss = 8.2118e-02, PNorm = 35.1092, GNorm = 0.7706, lr_0 = 3.2299e-04
Validation rmse = 0.146025
Validation r2 = 0.827978
Validation mse = 0.021323
Epoch 29
Loss = 8.5237e-02, PNorm = 35.1162, GNorm = 3.0532, lr_0 = 3.1373e-04
Loss = 9.3655e-02, PNorm = 35.1249, GNorm = 2.5939, lr_0 = 3.0553e-04
Validation rmse = 0.152627
Validation r2 = 0.812071
Validation mse = 0.023295
Epoch 30
Loss = 8.7824e-02, PNorm = 35.1299, GNorm = 1.2740, lr_0 = 2.9755e-04
Validation rmse = 0.147366
Validation r2 = 0.824802
Validation mse = 0.021717
Epoch 31
Loss = 6.8886e-02, PNorm = 35.1391, GNorm = 0.6320, lr_0 = 2.8901e-04
Loss = 8.1501e-02, PNorm = 35.1479, GNorm = 1.4618, lr_0 = 2.8147e-04
Validation rmse = 0.145314
Validation r2 = 0.829647
Validation mse = 0.021116
Epoch 32
Loss = 6.8421e-02, PNorm = 35.1551, GNorm = 0.5826, lr_0 = 2.7411e-04
Validation rmse = 0.145262
Validation r2 = 0.829771
Validation mse = 0.021101
Epoch 33
Loss = 4.5666e-02, PNorm = 35.1622, GNorm = 0.2863, lr_0 = 2.6625e-04
Loss = 7.8745e-02, PNorm = 35.1679, GNorm = 0.7437, lr_0 = 2.5929e-04
Validation rmse = 0.145159
Validation r2 = 0.830012
Validation mse = 0.021071
Epoch 34
Loss = 7.4928e-02, PNorm = 35.1784, GNorm = 1.4616, lr_0 = 2.5185e-04
Loss = 7.7014e-02, PNorm = 35.1857, GNorm = 2.7021, lr_0 = 2.4528e-04
Validation rmse = 0.149271
Validation r2 = 0.820245
Validation mse = 0.022282
Epoch 35
Loss = 8.0918e-02, PNorm = 35.1903, GNorm = 0.6123, lr_0 = 2.3887e-04
Validation rmse = 0.146291
Validation r2 = 0.827349
Validation mse = 0.021401
Epoch 36
Loss = 6.3220e-02, PNorm = 35.1985, GNorm = 0.7711, lr_0 = 2.3202e-04
Loss = 8.1184e-02, PNorm = 35.2052, GNorm = 1.4073, lr_0 = 2.2596e-04
Validation rmse = 0.146860
Validation r2 = 0.826004
Validation mse = 0.021568
Epoch 37
Loss = 6.8554e-02, PNorm = 35.2112, GNorm = 1.3054, lr_0 = 2.2005e-04
Validation rmse = 0.141973
Validation r2 = 0.837391
Validation mse = 0.020156
Epoch 38
Loss = 8.7821e-02, PNorm = 35.2182, GNorm = 0.8985, lr_0 = 2.1374e-04
Loss = 6.7504e-02, PNorm = 35.2231, GNorm = 1.6522, lr_0 = 2.0816e-04
Validation rmse = 0.145674
Validation r2 = 0.828802
Validation mse = 0.021221
Epoch 39
Loss = 7.7678e-02, PNorm = 35.2289, GNorm = 1.0658, lr_0 = 2.0272e-04
Validation rmse = 0.145567
Validation r2 = 0.829055
Validation mse = 0.021190
Epoch 40
Loss = 7.2322e-02, PNorm = 35.2348, GNorm = 0.4771, lr_0 = 1.9690e-04
Loss = 7.1354e-02, PNorm = 35.2411, GNorm = 0.4993, lr_0 = 1.9176e-04
Validation rmse = 0.144404
Validation r2 = 0.831775
Validation mse = 0.020853
Epoch 41
Loss = 7.3733e-02, PNorm = 35.2458, GNorm = 1.3535, lr_0 = 1.8675e-04
Validation rmse = 0.146342
Validation r2 = 0.827229
Validation mse = 0.021416
Epoch 42
Loss = 6.9609e-02, PNorm = 35.2517, GNorm = 1.5693, lr_0 = 1.8139e-04
Loss = 7.8541e-02, PNorm = 35.2571, GNorm = 1.1930, lr_0 = 1.7666e-04
Validation rmse = 0.144421
Validation r2 = 0.831736
Validation mse = 0.020857
Epoch 43
Loss = 7.0060e-02, PNorm = 35.2637, GNorm = 0.8430, lr_0 = 1.7159e-04
Validation rmse = 0.143097
Validation r2 = 0.834807
Validation mse = 0.020477
Epoch 44
Loss = 4.7786e-02, PNorm = 35.2693, GNorm = 0.6298, lr_0 = 1.6710e-04
Loss = 8.2117e-02, PNorm = 35.2731, GNorm = 1.5984, lr_0 = 1.6274e-04
Validation rmse = 0.149496
Validation r2 = 0.819701
Validation mse = 0.022349
Epoch 45
Loss = 7.2192e-02, PNorm = 35.2787, GNorm = 1.3914, lr_0 = 1.5807e-04
Loss = 8.4721e-02, PNorm = 35.2844, GNorm = 1.6524, lr_0 = 1.5394e-04
Validation rmse = 0.144412
Validation r2 = 0.831758
Validation mse = 0.020855
Epoch 46
Loss = 7.0007e-02, PNorm = 35.2890, GNorm = 1.3022, lr_0 = 1.4992e-04
Validation rmse = 0.142867
Validation r2 = 0.835337
Validation mse = 0.020411
Epoch 47
Loss = 7.8084e-02, PNorm = 35.2938, GNorm = 1.3295, lr_0 = 1.4562e-04
Loss = 6.5013e-02, PNorm = 35.2982, GNorm = 0.8697, lr_0 = 1.4182e-04
Validation rmse = 0.142985
Validation r2 = 0.835066
Validation mse = 0.020445
Epoch 48
Loss = 6.8603e-02, PNorm = 35.3036, GNorm = 1.8738, lr_0 = 1.3811e-04
Validation rmse = 0.144427
Validation r2 = 0.831723
Validation mse = 0.020859
Epoch 49
Loss = 6.6058e-02, PNorm = 35.3073, GNorm = 0.9994, lr_0 = 1.3415e-04
Loss = 7.3111e-02, PNorm = 35.3113, GNorm = 0.7653, lr_0 = 1.3064e-04
Validation rmse = 0.143803
Validation r2 = 0.833174
Validation mse = 0.020679
Epoch 50
Loss = 6.6704e-02, PNorm = 35.3156, GNorm = 0.7704, lr_0 = 1.2723e-04
Validation rmse = 0.149036
Validation r2 = 0.820811
Validation mse = 0.022212
Epoch 51
Loss = 7.4181e-02, PNorm = 35.3200, GNorm = 2.4038, lr_0 = 1.2358e-04
Loss = 6.3749e-02, PNorm = 35.3233, GNorm = 0.9183, lr_0 = 1.2035e-04
Validation rmse = 0.142412
Validation r2 = 0.836383
Validation mse = 0.020281
Epoch 52
Loss = 5.4187e-02, PNorm = 35.3277, GNorm = 2.4692, lr_0 = 1.1690e-04
Validation rmse = 0.142545
Validation r2 = 0.836079
Validation mse = 0.020319
Epoch 53
Loss = 5.8099e-02, PNorm = 35.3313, GNorm = 0.5750, lr_0 = 1.1385e-04
Loss = 6.9175e-02, PNorm = 35.3344, GNorm = 1.2879, lr_0 = 1.1087e-04
Validation rmse = 0.142822
Validation r2 = 0.835442
Validation mse = 0.020398
Epoch 54
Loss = 7.1321e-02, PNorm = 35.3386, GNorm = 0.4723, lr_0 = 1.0769e-04
Validation rmse = 0.144755
Validation r2 = 0.830956
Validation mse = 0.020954
Epoch 55
Loss = 4.2421e-02, PNorm = 35.3419, GNorm = 0.9075, lr_0 = 1.0488e-04
Loss = 6.7379e-02, PNorm = 35.3456, GNorm = 1.0066, lr_0 = 1.0214e-04
Validation rmse = 0.142576
Validation r2 = 0.836007
Validation mse = 0.020328
Epoch 56
Loss = 6.9462e-02, PNorm = 35.3495, GNorm = 0.3873, lr_0 = 1.0000e-04
Loss = 6.4722e-02, PNorm = 35.3526, GNorm = 0.9130, lr_0 = 1.0000e-04
Validation rmse = 0.141691
Validation r2 = 0.838036
Validation mse = 0.020076
Epoch 57
Loss = 6.4685e-02, PNorm = 35.3557, GNorm = 0.7841, lr_0 = 1.0000e-04
Validation rmse = 0.144021
Validation r2 = 0.832667
Validation mse = 0.020742
Epoch 58
Loss = 6.6123e-02, PNorm = 35.3588, GNorm = 0.7436, lr_0 = 1.0000e-04
Loss = 6.5873e-02, PNorm = 35.3618, GNorm = 1.0889, lr_0 = 1.0000e-04
Loss = 6.1154e-02, PNorm = 35.3620, GNorm = 1.4714, lr_0 = 1.0000e-04
Validation rmse = 0.142953
Validation r2 = 0.835138
Validation mse = 0.020436
Epoch 59
Loss = 6.9608e-02, PNorm = 35.3650, GNorm = 2.7678, lr_0 = 1.0000e-04
Validation rmse = 0.142687
Validation r2 = 0.835751
Validation mse = 0.020360
Model 0 best validation rmse = 0.141691 on epoch 56
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.223428
Model 0 test r2 = 0.546322
Model 0 test mse = 0.049920
Ensemble test rmse = 0.223428
Ensemble test r2 = 0.546322
Ensemble test mse = 0.049920
Fold 2
Splitting data with seed 2
Total size = 965 | train size = 772 | val size = 193 | test size = 57
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 1.0226e+00, PNorm = 34.0160, GNorm = 1.6557, lr_0 = 4.3000e-04
Validation rmse = 0.324783
Validation r2 = 0.125491
Validation mse = 0.105484
Epoch 1
Loss = 7.5216e-01, PNorm = 34.0354, GNorm = 2.8641, lr_0 = 7.6000e-04
Loss = 7.4257e-01, PNorm = 34.0933, GNorm = 2.2907, lr_0 = 9.9472e-04
Loss = 7.5012e-01, PNorm = 34.0991, GNorm = 9.8073, lr_0 = 9.9209e-04
Validation rmse = 0.260787
Validation r2 = 0.436169
Validation mse = 0.068010
Epoch 2
Loss = 6.7450e-01, PNorm = 34.1584, GNorm = 8.7129, lr_0 = 9.6618e-04
Validation rmse = 0.247975
Validation r2 = 0.490208
Validation mse = 0.061492
Epoch 3
Loss = 4.9902e-01, PNorm = 34.2248, GNorm = 2.0120, lr_0 = 9.4094e-04
Loss = 3.7086e-01, PNorm = 34.3026, GNorm = 1.0492, lr_0 = 9.1637e-04
Validation rmse = 0.200909
Validation r2 = 0.665362
Validation mse = 0.040364
Epoch 4
Loss = 3.1071e-01, PNorm = 34.3789, GNorm = 3.1140, lr_0 = 8.9007e-04
Validation rmse = 0.194554
Validation r2 = 0.686197
Validation mse = 0.037851
Epoch 5
Loss = 3.5183e-01, PNorm = 34.4387, GNorm = 10.8197, lr_0 = 8.6682e-04
Loss = 2.6816e-01, PNorm = 34.4900, GNorm = 1.2525, lr_0 = 8.4418e-04
Validation rmse = 0.172084
Validation r2 = 0.754496
Validation mse = 0.029613
Epoch 6
Loss = 2.2927e-01, PNorm = 34.5517, GNorm = 2.0125, lr_0 = 8.1996e-04
Validation rmse = 0.168367
Validation r2 = 0.764989
Validation mse = 0.028347
Epoch 7
Loss = 1.6530e-01, PNorm = 34.5905, GNorm = 1.6649, lr_0 = 7.9854e-04
Loss = 1.9717e-01, PNorm = 34.6347, GNorm = 5.6446, lr_0 = 7.7769e-04
Validation rmse = 0.152540
Validation r2 = 0.807094
Validation mse = 0.023269
Epoch 8
Loss = 1.8794e-01, PNorm = 34.6748, GNorm = 3.2929, lr_0 = 7.5537e-04
Validation rmse = 0.154805
Validation r2 = 0.801325
Validation mse = 0.023964
Epoch 9
Loss = 1.3866e-01, PNorm = 34.7091, GNorm = 2.3177, lr_0 = 7.3370e-04
Loss = 1.3756e-01, PNorm = 34.7416, GNorm = 3.1930, lr_0 = 7.1453e-04
Validation rmse = 0.162130
Validation r2 = 0.782076
Validation mse = 0.026286
Epoch 10
Loss = 1.7699e-01, PNorm = 34.7701, GNorm = 3.2912, lr_0 = 6.9587e-04
Validation rmse = 0.141833
Validation r2 = 0.833225
Validation mse = 0.020117
Epoch 11
Loss = 9.3604e-02, PNorm = 34.7997, GNorm = 1.2494, lr_0 = 6.7590e-04
Loss = 1.2240e-01, PNorm = 34.8238, GNorm = 2.6877, lr_0 = 6.5825e-04
Validation rmse = 0.147019
Validation r2 = 0.820806
Validation mse = 0.021615
Epoch 12
Loss = 1.1198e-01, PNorm = 34.8462, GNorm = 1.0885, lr_0 = 6.4106e-04
Loss = 1.2416e-01, PNorm = 34.8649, GNorm = 1.4247, lr_0 = 6.2431e-04
Loss = 1.5823e-01, PNorm = 34.8666, GNorm = 2.0513, lr_0 = 6.2266e-04
Validation rmse = 0.147949
Validation r2 = 0.818532
Validation mse = 0.021889
Epoch 13
Loss = 1.1855e-01, PNorm = 34.8858, GNorm = 3.5413, lr_0 = 6.0640e-04
Validation rmse = 0.170224
Validation r2 = 0.759776
Validation mse = 0.028976
Epoch 14
Loss = 1.6503e-01, PNorm = 34.9047, GNorm = 0.7770, lr_0 = 5.9056e-04
Loss = 1.1925e-01, PNorm = 34.9247, GNorm = 0.9048, lr_0 = 5.7514e-04
Validation rmse = 0.137281
Validation r2 = 0.843759
Validation mse = 0.018846
Epoch 15
Loss = 1.1500e-01, PNorm = 34.9455, GNorm = 1.4119, lr_0 = 5.5863e-04
Validation rmse = 0.147394
Validation r2 = 0.819892
Validation mse = 0.021725
Epoch 16
Loss = 1.4740e-01, PNorm = 34.9655, GNorm = 4.6787, lr_0 = 5.4404e-04
Loss = 1.2705e-01, PNorm = 34.9831, GNorm = 1.7392, lr_0 = 5.2983e-04
Validation rmse = 0.137464
Validation r2 = 0.843342
Validation mse = 0.018896
Epoch 17
Loss = 1.0376e-01, PNorm = 35.0016, GNorm = 0.9414, lr_0 = 5.1463e-04
Validation rmse = 0.142260
Validation r2 = 0.832219
Validation mse = 0.020238
Epoch 18
Loss = 1.0757e-01, PNorm = 35.0199, GNorm = 3.1826, lr_0 = 4.9986e-04
Loss = 9.6975e-02, PNorm = 35.0365, GNorm = 1.1257, lr_0 = 4.8681e-04
Validation rmse = 0.136151
Validation r2 = 0.846319
Validation mse = 0.018537
Epoch 19
Loss = 9.3223e-02, PNorm = 35.0493, GNorm = 1.1959, lr_0 = 4.7409e-04
Validation rmse = 0.137326
Validation r2 = 0.843656
Validation mse = 0.018858
Epoch 20
Loss = 1.0862e-01, PNorm = 35.0644, GNorm = 1.9888, lr_0 = 4.6049e-04
Loss = 9.7466e-02, PNorm = 35.0766, GNorm = 1.8803, lr_0 = 4.4846e-04
Validation rmse = 0.134623
Validation r2 = 0.849750
Validation mse = 0.018123
Epoch 21
Loss = 9.5769e-02, PNorm = 35.0898, GNorm = 1.0471, lr_0 = 4.3675e-04
Validation rmse = 0.134965
Validation r2 = 0.848985
Validation mse = 0.018216
Epoch 22
Loss = 8.4024e-02, PNorm = 35.1034, GNorm = 0.6992, lr_0 = 4.2422e-04
Loss = 1.0176e-01, PNorm = 35.1158, GNorm = 0.7465, lr_0 = 4.1313e-04
Validation rmse = 0.167896
Validation r2 = 0.766300
Validation mse = 0.028189
Epoch 23
Loss = 1.2596e-01, PNorm = 35.1302, GNorm = 0.6934, lr_0 = 4.0234e-04
Loss = 1.0857e-01, PNorm = 35.1444, GNorm = 1.6175, lr_0 = 3.9184e-04
Loss = 1.0160e-01, PNorm = 35.1455, GNorm = 2.3707, lr_0 = 3.9080e-04
Validation rmse = 0.155759
Validation r2 = 0.798867
Validation mse = 0.024261
Epoch 24
Loss = 1.0898e-01, PNorm = 35.1602, GNorm = 4.6889, lr_0 = 3.8059e-04
Validation rmse = 0.134784
Validation r2 = 0.849390
Validation mse = 0.018167
Epoch 25
Loss = 8.6107e-02, PNorm = 35.1719, GNorm = 3.5434, lr_0 = 3.7065e-04
Loss = 9.3572e-02, PNorm = 35.1823, GNorm = 1.1030, lr_0 = 3.6097e-04
Validation rmse = 0.139787
Validation r2 = 0.838002
Validation mse = 0.019540
Epoch 26
Loss = 8.7826e-02, PNorm = 35.1959, GNorm = 1.8013, lr_0 = 3.5061e-04
Validation rmse = 0.134879
Validation r2 = 0.849177
Validation mse = 0.018192
Epoch 27
Loss = 7.4805e-02, PNorm = 35.2068, GNorm = 0.4774, lr_0 = 3.4055e-04
Loss = 9.3627e-02, PNorm = 35.2169, GNorm = 2.3537, lr_0 = 3.3166e-04
Validation rmse = 0.136244
Validation r2 = 0.846110
Validation mse = 0.018562
Epoch 28
Loss = 9.0427e-02, PNorm = 35.2276, GNorm = 1.1876, lr_0 = 3.2299e-04
Validation rmse = 0.135456
Validation r2 = 0.847884
Validation mse = 0.018348
Epoch 29
Loss = 7.8687e-02, PNorm = 35.2387, GNorm = 0.7621, lr_0 = 3.1373e-04
Loss = 8.4666e-02, PNorm = 35.2490, GNorm = 0.6355, lr_0 = 3.0553e-04
Validation rmse = 0.135791
Validation r2 = 0.847131
Validation mse = 0.018439
Epoch 30
Loss = 8.5433e-02, PNorm = 35.2563, GNorm = 0.5839, lr_0 = 2.9755e-04
Validation rmse = 0.141082
Validation r2 = 0.834986
Validation mse = 0.019904
Epoch 31
Loss = 1.1044e-01, PNorm = 35.2683, GNorm = 1.9012, lr_0 = 2.8901e-04
Loss = 8.2661e-02, PNorm = 35.2762, GNorm = 1.8620, lr_0 = 2.8147e-04
Validation rmse = 0.135741
Validation r2 = 0.847243
Validation mse = 0.018426
Epoch 32
Loss = 9.9398e-02, PNorm = 35.2893, GNorm = 3.0704, lr_0 = 2.7411e-04
Validation rmse = 0.134145
Validation r2 = 0.850814
Validation mse = 0.017995
Epoch 33
Loss = 5.8473e-02, PNorm = 35.2989, GNorm = 0.4738, lr_0 = 2.6625e-04
Loss = 8.3694e-02, PNorm = 35.3087, GNorm = 2.3209, lr_0 = 2.5929e-04
Validation rmse = 0.133769
Validation r2 = 0.851651
Validation mse = 0.017894
Epoch 34
Loss = 7.7464e-02, PNorm = 35.3171, GNorm = 1.4193, lr_0 = 2.5185e-04
Loss = 8.2591e-02, PNorm = 35.3237, GNorm = 2.7047, lr_0 = 2.4528e-04
Validation rmse = 0.132979
Validation r2 = 0.853397
Validation mse = 0.017683
Epoch 35
Loss = 7.8303e-02, PNorm = 35.3324, GNorm = 1.4497, lr_0 = 2.3887e-04
Validation rmse = 0.136310
Validation r2 = 0.845961
Validation mse = 0.018580
Epoch 36
Loss = 7.5073e-02, PNorm = 35.3405, GNorm = 0.6316, lr_0 = 2.3202e-04
Loss = 7.5059e-02, PNorm = 35.3479, GNorm = 2.1045, lr_0 = 2.2596e-04
Validation rmse = 0.134747
Validation r2 = 0.849472
Validation mse = 0.018157
Epoch 37
Loss = 7.7597e-02, PNorm = 35.3555, GNorm = 0.8520, lr_0 = 2.2005e-04
Validation rmse = 0.133533
Validation r2 = 0.852173
Validation mse = 0.017831
Epoch 38
Loss = 6.8968e-02, PNorm = 35.3640, GNorm = 1.5910, lr_0 = 2.1374e-04
Loss = 7.8694e-02, PNorm = 35.3700, GNorm = 0.9110, lr_0 = 2.0816e-04
Validation rmse = 0.134169
Validation r2 = 0.850762
Validation mse = 0.018001
Epoch 39
Loss = 7.1250e-02, PNorm = 35.3772, GNorm = 0.7492, lr_0 = 2.0272e-04
Validation rmse = 0.133168
Validation r2 = 0.852979
Validation mse = 0.017734
Epoch 40
Loss = 8.4077e-02, PNorm = 35.3857, GNorm = 2.4260, lr_0 = 1.9690e-04
Loss = 7.4856e-02, PNorm = 35.3914, GNorm = 2.8285, lr_0 = 1.9176e-04
Validation rmse = 0.136876
Validation r2 = 0.844679
Validation mse = 0.018735
Epoch 41
Loss = 7.6594e-02, PNorm = 35.3981, GNorm = 0.5781, lr_0 = 1.8675e-04
Validation rmse = 0.134367
Validation r2 = 0.850322
Validation mse = 0.018054
Epoch 42
Loss = 8.2222e-02, PNorm = 35.4048, GNorm = 1.6587, lr_0 = 1.8139e-04
Loss = 7.0851e-02, PNorm = 35.4112, GNorm = 1.6489, lr_0 = 1.7666e-04
Validation rmse = 0.134172
Validation r2 = 0.850755
Validation mse = 0.018002
Epoch 43
Loss = 6.6261e-02, PNorm = 35.4179, GNorm = 1.3404, lr_0 = 1.7159e-04
Validation rmse = 0.134046
Validation r2 = 0.851036
Validation mse = 0.017968
Epoch 44
Loss = 6.6776e-02, PNorm = 35.4229, GNorm = 1.3032, lr_0 = 1.6710e-04
Loss = 6.9859e-02, PNorm = 35.4291, GNorm = 1.4260, lr_0 = 1.6274e-04
Validation rmse = 0.137664
Validation r2 = 0.842886
Validation mse = 0.018951
Epoch 45
Loss = 6.9937e-02, PNorm = 35.4347, GNorm = 0.6485, lr_0 = 1.5807e-04
Loss = 7.6647e-02, PNorm = 35.4406, GNorm = 0.7224, lr_0 = 1.5394e-04
Validation rmse = 0.135841
Validation r2 = 0.847019
Validation mse = 0.018453
Epoch 46
Loss = 6.6681e-02, PNorm = 35.4461, GNorm = 1.5960, lr_0 = 1.4992e-04
Validation rmse = 0.137431
Validation r2 = 0.843416
Validation mse = 0.018887
Epoch 47
Loss = 7.3707e-02, PNorm = 35.4527, GNorm = 1.4257, lr_0 = 1.4562e-04
Loss = 7.9161e-02, PNorm = 35.4568, GNorm = 1.6926, lr_0 = 1.4182e-04
Validation rmse = 0.138558
Validation r2 = 0.840839
Validation mse = 0.019198
Epoch 48
Loss = 7.9730e-02, PNorm = 35.4617, GNorm = 2.7972, lr_0 = 1.3811e-04
Validation rmse = 0.135574
Validation r2 = 0.847620
Validation mse = 0.018380
Epoch 49
Loss = 6.4345e-02, PNorm = 35.4664, GNorm = 1.7091, lr_0 = 1.3415e-04
Loss = 7.1083e-02, PNorm = 35.4712, GNorm = 0.8292, lr_0 = 1.3064e-04
Validation rmse = 0.133571
Validation r2 = 0.852089
Validation mse = 0.017841
Epoch 50
Loss = 6.5769e-02, PNorm = 35.4755, GNorm = 0.4752, lr_0 = 1.2723e-04
Validation rmse = 0.134981
Validation r2 = 0.848949
Validation mse = 0.018220
Epoch 51
Loss = 4.9806e-02, PNorm = 35.4801, GNorm = 1.4160, lr_0 = 1.2358e-04
Loss = 7.5723e-02, PNorm = 35.4844, GNorm = 1.7158, lr_0 = 1.2035e-04
Validation rmse = 0.136906
Validation r2 = 0.844610
Validation mse = 0.018743
Epoch 52
Loss = 7.4798e-02, PNorm = 35.4887, GNorm = 2.2534, lr_0 = 1.1690e-04
Validation rmse = 0.137065
Validation r2 = 0.844250
Validation mse = 0.018787
Epoch 53
Loss = 6.3670e-02, PNorm = 35.4931, GNorm = 2.0328, lr_0 = 1.1385e-04
Loss = 7.0087e-02, PNorm = 35.4967, GNorm = 0.7354, lr_0 = 1.1087e-04
Validation rmse = 0.134435
Validation r2 = 0.850170
Validation mse = 0.018073
Epoch 54
Loss = 7.6379e-02, PNorm = 35.5011, GNorm = 0.8583, lr_0 = 1.0769e-04
Validation rmse = 0.136328
Validation r2 = 0.845919
Validation mse = 0.018585
Epoch 55
Loss = 8.5502e-02, PNorm = 35.5047, GNorm = 1.4221, lr_0 = 1.0488e-04
Loss = 6.2325e-02, PNorm = 35.5083, GNorm = 0.7017, lr_0 = 1.0214e-04
Validation rmse = 0.134353
Validation r2 = 0.850352
Validation mse = 0.018051
Epoch 56
Loss = 6.7989e-02, PNorm = 35.5120, GNorm = 1.0178, lr_0 = 1.0000e-04
Loss = 6.9943e-02, PNorm = 35.5151, GNorm = 1.2457, lr_0 = 1.0000e-04
Validation rmse = 0.133671
Validation r2 = 0.851866
Validation mse = 0.017868
Epoch 57
Loss = 6.4920e-02, PNorm = 35.5186, GNorm = 0.9521, lr_0 = 1.0000e-04
Validation rmse = 0.133971
Validation r2 = 0.851203
Validation mse = 0.017948
Epoch 58
Loss = 6.1020e-02, PNorm = 35.5220, GNorm = 2.0376, lr_0 = 1.0000e-04
Loss = 6.6717e-02, PNorm = 35.5249, GNorm = 0.3614, lr_0 = 1.0000e-04
Loss = 9.6861e-02, PNorm = 35.5253, GNorm = 0.7149, lr_0 = 1.0000e-04
Validation rmse = 0.133863
Validation r2 = 0.851440
Validation mse = 0.017919
Epoch 59
Loss = 6.7368e-02, PNorm = 35.5292, GNorm = 0.6427, lr_0 = 1.0000e-04
Validation rmse = 0.133667
Validation r2 = 0.851877
Validation mse = 0.017867
Model 0 best validation rmse = 0.132979 on epoch 34
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.199411
Model 0 test r2 = 0.638616
Model 0 test mse = 0.039765
Ensemble test rmse = 0.199411
Ensemble test r2 = 0.638616
Ensemble test mse = 0.039765
Fold 3
Splitting data with seed 3
Total size = 965 | train size = 772 | val size = 193 | test size = 57
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.0229e-01, PNorm = 34.0180, GNorm = 1.5264, lr_0 = 4.3000e-04
Validation rmse = 0.291011
Validation r2 = 0.310647
Validation mse = 0.084687
Epoch 1
Loss = 6.2289e-01, PNorm = 34.0482, GNorm = 1.1676, lr_0 = 7.6000e-04
Loss = 6.6811e-01, PNorm = 34.1059, GNorm = 5.2201, lr_0 = 9.9472e-04
Loss = 6.0015e-01, PNorm = 34.1125, GNorm = 6.7767, lr_0 = 9.9209e-04
Validation rmse = 0.246129
Validation r2 = 0.506882
Validation mse = 0.060580
Epoch 2
Loss = 5.0184e-01, PNorm = 34.1860, GNorm = 4.4466, lr_0 = 9.6618e-04
Validation rmse = 0.214004
Validation r2 = 0.627207
Validation mse = 0.045798
Epoch 3
Loss = 4.3722e-01, PNorm = 34.2663, GNorm = 6.5090, lr_0 = 9.4094e-04
Loss = 3.1919e-01, PNorm = 34.3436, GNorm = 2.6757, lr_0 = 9.1637e-04
Validation rmse = 0.183021
Validation r2 = 0.727337
Validation mse = 0.033497
Epoch 4
Loss = 3.2990e-01, PNorm = 34.4034, GNorm = 1.5659, lr_0 = 8.9007e-04
Validation rmse = 0.160670
Validation r2 = 0.789867
Validation mse = 0.025815
Epoch 5
Loss = 2.0977e-01, PNorm = 34.4632, GNorm = 5.0840, lr_0 = 8.6682e-04
Loss = 2.3912e-01, PNorm = 34.5125, GNorm = 1.7108, lr_0 = 8.4418e-04
Validation rmse = 0.157571
Validation r2 = 0.797896
Validation mse = 0.024829
Epoch 6
Loss = 1.9946e-01, PNorm = 34.5639, GNorm = 4.1465, lr_0 = 8.1996e-04
Validation rmse = 0.143515
Validation r2 = 0.832343
Validation mse = 0.020597
Epoch 7
Loss = 1.4998e-01, PNorm = 34.6044, GNorm = 0.9071, lr_0 = 7.9854e-04
Loss = 1.6183e-01, PNorm = 34.6480, GNorm = 1.5251, lr_0 = 7.7769e-04
Validation rmse = 0.148896
Validation r2 = 0.819537
Validation mse = 0.022170
Epoch 8
Loss = 1.8874e-01, PNorm = 34.6906, GNorm = 9.5666, lr_0 = 7.5537e-04
Validation rmse = 0.156658
Validation r2 = 0.800230
Validation mse = 0.024542
Epoch 9
Loss = 2.2056e-01, PNorm = 34.7229, GNorm = 7.4903, lr_0 = 7.3370e-04
Loss = 1.8100e-01, PNorm = 34.7518, GNorm = 2.7589, lr_0 = 7.1453e-04
Validation rmse = 0.133096
Validation r2 = 0.855803
Validation mse = 0.017715
Epoch 10
Loss = 1.2744e-01, PNorm = 34.7792, GNorm = 1.4058, lr_0 = 6.9587e-04
Validation rmse = 0.131627
Validation r2 = 0.858970
Validation mse = 0.017326
Epoch 11
Loss = 1.3871e-01, PNorm = 34.8052, GNorm = 1.6948, lr_0 = 6.7590e-04
Loss = 1.2955e-01, PNorm = 34.8190, GNorm = 1.4650, lr_0 = 6.5825e-04
Validation rmse = 0.127721
Validation r2 = 0.867216
Validation mse = 0.016313
Epoch 12
Loss = 1.0789e-01, PNorm = 34.8451, GNorm = 2.6578, lr_0 = 6.4106e-04
Loss = 1.5198e-01, PNorm = 34.8614, GNorm = 5.7039, lr_0 = 6.2431e-04
Loss = 1.9375e-01, PNorm = 34.8634, GNorm = 3.8532, lr_0 = 6.2266e-04
Validation rmse = 0.123978
Validation r2 = 0.874884
Validation mse = 0.015371
Epoch 13
Loss = 1.3833e-01, PNorm = 34.8802, GNorm = 0.6895, lr_0 = 6.0640e-04
Validation rmse = 0.128840
Validation r2 = 0.864879
Validation mse = 0.016600
Epoch 14
Loss = 1.1743e-01, PNorm = 34.8980, GNorm = 1.2566, lr_0 = 5.9056e-04
Loss = 1.1653e-01, PNorm = 34.9153, GNorm = 2.4225, lr_0 = 5.7514e-04
Validation rmse = 0.121333
Validation r2 = 0.880165
Validation mse = 0.014722
Epoch 15
Loss = 1.0890e-01, PNorm = 34.9331, GNorm = 1.4822, lr_0 = 5.5863e-04
Validation rmse = 0.138665
Validation r2 = 0.843486
Validation mse = 0.019228
Epoch 16
Loss = 1.2643e-01, PNorm = 34.9457, GNorm = 0.6872, lr_0 = 5.4404e-04
Loss = 1.2373e-01, PNorm = 34.9597, GNorm = 1.4557, lr_0 = 5.2983e-04
Validation rmse = 0.125970
Validation r2 = 0.870831
Validation mse = 0.015868
Epoch 17
Loss = 1.0689e-01, PNorm = 34.9788, GNorm = 0.9990, lr_0 = 5.1463e-04
Validation rmse = 0.130909
Validation r2 = 0.860503
Validation mse = 0.017137
Epoch 18
Loss = 1.4840e-01, PNorm = 34.9908, GNorm = 4.6726, lr_0 = 4.9986e-04
Loss = 1.2981e-01, PNorm = 35.0044, GNorm = 3.5076, lr_0 = 4.8681e-04
Validation rmse = 0.121052
Validation r2 = 0.880721
Validation mse = 0.014654
Epoch 19
Loss = 1.1902e-01, PNorm = 35.0195, GNorm = 2.4909, lr_0 = 4.7409e-04
Validation rmse = 0.121258
Validation r2 = 0.880315
Validation mse = 0.014703
Epoch 20
Loss = 1.1115e-01, PNorm = 35.0384, GNorm = 1.1188, lr_0 = 4.6049e-04
Loss = 1.1082e-01, PNorm = 35.0491, GNorm = 0.8908, lr_0 = 4.4846e-04
Validation rmse = 0.124060
Validation r2 = 0.874718
Validation mse = 0.015391
Epoch 21
Loss = 9.7280e-02, PNorm = 35.0589, GNorm = 2.7438, lr_0 = 4.3675e-04
Validation rmse = 0.120293
Validation r2 = 0.882212
Validation mse = 0.014470
Epoch 22
Loss = 7.7848e-02, PNorm = 35.0706, GNorm = 2.0095, lr_0 = 4.2422e-04
Loss = 1.0679e-01, PNorm = 35.0791, GNorm = 1.1637, lr_0 = 4.1313e-04
Validation rmse = 0.123400
Validation r2 = 0.876048
Validation mse = 0.015228
Epoch 23
Loss = 1.2914e-01, PNorm = 35.0899, GNorm = 1.5114, lr_0 = 4.0234e-04
Loss = 9.1857e-02, PNorm = 35.1008, GNorm = 2.1565, lr_0 = 3.9184e-04
Loss = 4.5195e-02, PNorm = 35.1013, GNorm = 0.7431, lr_0 = 3.9080e-04
Validation rmse = 0.124387
Validation r2 = 0.874057
Validation mse = 0.015472
Epoch 24
Loss = 9.8495e-02, PNorm = 35.1103, GNorm = 2.2464, lr_0 = 3.8059e-04
Validation rmse = 0.137208
Validation r2 = 0.846756
Validation mse = 0.018826
Epoch 25
Loss = 1.0666e-01, PNorm = 35.1202, GNorm = 2.4517, lr_0 = 3.7065e-04
Loss = 1.1238e-01, PNorm = 35.1302, GNorm = 3.3405, lr_0 = 3.6097e-04
Validation rmse = 0.143138
Validation r2 = 0.833223
Validation mse = 0.020489
Epoch 26
Loss = 1.3454e-01, PNorm = 35.1384, GNorm = 2.6696, lr_0 = 3.5061e-04
Validation rmse = 0.126850
Validation r2 = 0.869020
Validation mse = 0.016091
Epoch 27
Loss = 1.2027e-01, PNorm = 35.1536, GNorm = 2.9584, lr_0 = 3.4055e-04
Loss = 1.3286e-01, PNorm = 35.1656, GNorm = 3.3594, lr_0 = 3.3166e-04
Validation rmse = 0.120993
Validation r2 = 0.880836
Validation mse = 0.014639
Epoch 28
Loss = 9.7085e-02, PNorm = 35.1764, GNorm = 2.6797, lr_0 = 3.2299e-04
Validation rmse = 0.118112
Validation r2 = 0.886443
Validation mse = 0.013950
Epoch 29
Loss = 9.4807e-02, PNorm = 35.1876, GNorm = 3.4436, lr_0 = 3.1373e-04
Loss = 1.0411e-01, PNorm = 35.1976, GNorm = 0.7955, lr_0 = 3.0553e-04
Validation rmse = 0.124570
Validation r2 = 0.873687
Validation mse = 0.015518
Epoch 30
Loss = 8.4161e-02, PNorm = 35.2060, GNorm = 1.5348, lr_0 = 2.9755e-04
Validation rmse = 0.117669
Validation r2 = 0.887294
Validation mse = 0.013846
Epoch 31
Loss = 7.7139e-02, PNorm = 35.2142, GNorm = 1.4613, lr_0 = 2.8901e-04
Loss = 8.3969e-02, PNorm = 35.2227, GNorm = 1.1370, lr_0 = 2.8147e-04
Validation rmse = 0.125179
Validation r2 = 0.872447
Validation mse = 0.015670
Epoch 32
Loss = 7.9551e-02, PNorm = 35.2296, GNorm = 1.5429, lr_0 = 2.7411e-04
Validation rmse = 0.116737
Validation r2 = 0.889073
Validation mse = 0.013627
Epoch 33
Loss = 7.3762e-02, PNorm = 35.2379, GNorm = 0.4970, lr_0 = 2.6625e-04
Loss = 9.0652e-02, PNorm = 35.2466, GNorm = 0.5265, lr_0 = 2.5929e-04
Validation rmse = 0.121598
Validation r2 = 0.879642
Validation mse = 0.014786
Epoch 34
Loss = 8.4094e-02, PNorm = 35.2553, GNorm = 0.7301, lr_0 = 2.5185e-04
Loss = 8.9354e-02, PNorm = 35.2625, GNorm = 1.0601, lr_0 = 2.4528e-04
Validation rmse = 0.123051
Validation r2 = 0.876748
Validation mse = 0.015141
Epoch 35
Loss = 8.5569e-02, PNorm = 35.2686, GNorm = 1.5739, lr_0 = 2.3887e-04
Validation rmse = 0.119297
Validation r2 = 0.884153
Validation mse = 0.014232
Epoch 36
Loss = 7.6773e-02, PNorm = 35.2757, GNorm = 2.2627, lr_0 = 2.3202e-04
Loss = 8.9534e-02, PNorm = 35.2823, GNorm = 2.0722, lr_0 = 2.2596e-04
Validation rmse = 0.117216
Validation r2 = 0.888160
Validation mse = 0.013740
Epoch 37
Loss = 7.8930e-02, PNorm = 35.2891, GNorm = 2.0614, lr_0 = 2.2005e-04
Validation rmse = 0.121368
Validation r2 = 0.880096
Validation mse = 0.014730
Epoch 38
Loss = 6.4669e-02, PNorm = 35.2957, GNorm = 1.7182, lr_0 = 2.1374e-04
Loss = 9.2953e-02, PNorm = 35.3015, GNorm = 1.3138, lr_0 = 2.0816e-04
Validation rmse = 0.117378
Validation r2 = 0.887851
Validation mse = 0.013777
Epoch 39
Loss = 8.5012e-02, PNorm = 35.3078, GNorm = 0.5978, lr_0 = 2.0272e-04
Validation rmse = 0.124260
Validation r2 = 0.874315
Validation mse = 0.015440
Epoch 40
Loss = 1.1696e-01, PNorm = 35.3144, GNorm = 1.2262, lr_0 = 1.9690e-04
Loss = 8.0923e-02, PNorm = 35.3188, GNorm = 0.7505, lr_0 = 1.9176e-04
Validation rmse = 0.117806
Validation r2 = 0.887031
Validation mse = 0.013878
Epoch 41
Loss = 9.4053e-02, PNorm = 35.3246, GNorm = 3.0885, lr_0 = 1.8675e-04
Validation rmse = 0.124661
Validation r2 = 0.873501
Validation mse = 0.015540
Epoch 42
Loss = 8.0095e-02, PNorm = 35.3305, GNorm = 2.6517, lr_0 = 1.8139e-04
Loss = 8.8018e-02, PNorm = 35.3354, GNorm = 2.1042, lr_0 = 1.7666e-04
Validation rmse = 0.119184
Validation r2 = 0.884372
Validation mse = 0.014205
Epoch 43
Loss = 8.1544e-02, PNorm = 35.3422, GNorm = 1.5067, lr_0 = 1.7159e-04
Validation rmse = 0.118636
Validation r2 = 0.885434
Validation mse = 0.014074
Epoch 44
Loss = 1.1684e-01, PNorm = 35.3476, GNorm = 0.9483, lr_0 = 1.6710e-04
Loss = 7.3575e-02, PNorm = 35.3531, GNorm = 0.8176, lr_0 = 1.6274e-04
Validation rmse = 0.118041
Validation r2 = 0.886580
Validation mse = 0.013934
Epoch 45
Loss = 7.5119e-02, PNorm = 35.3577, GNorm = 1.9411, lr_0 = 1.5807e-04
Loss = 8.6098e-02, PNorm = 35.3613, GNorm = 4.1726, lr_0 = 1.5394e-04
Validation rmse = 0.117761
Validation r2 = 0.887117
Validation mse = 0.013868
Epoch 46
Loss = 7.7173e-02, PNorm = 35.3659, GNorm = 1.2541, lr_0 = 1.4992e-04
Validation rmse = 0.117917
Validation r2 = 0.886818
Validation mse = 0.013904
Epoch 47
Loss = 7.6326e-02, PNorm = 35.3713, GNorm = 0.6678, lr_0 = 1.4562e-04
Loss = 7.6688e-02, PNorm = 35.3759, GNorm = 1.1880, lr_0 = 1.4182e-04
Validation rmse = 0.119648
Validation r2 = 0.883471
Validation mse = 0.014316
Epoch 48
Loss = 6.8328e-02, PNorm = 35.3800, GNorm = 0.8175, lr_0 = 1.3811e-04
Validation rmse = 0.118670
Validation r2 = 0.885368
Validation mse = 0.014083
Epoch 49
Loss = 7.1775e-02, PNorm = 35.3844, GNorm = 0.7114, lr_0 = 1.3415e-04
Loss = 7.8177e-02, PNorm = 35.3895, GNorm = 3.2912, lr_0 = 1.3064e-04
Validation rmse = 0.118927
Validation r2 = 0.884871
Validation mse = 0.014144
Epoch 50
Loss = 7.8921e-02, PNorm = 35.3928, GNorm = 1.8125, lr_0 = 1.2723e-04
Validation rmse = 0.117190
Validation r2 = 0.888209
Validation mse = 0.013734
Epoch 51
Loss = 8.8269e-02, PNorm = 35.3965, GNorm = 1.9010, lr_0 = 1.2358e-04
Loss = 7.3972e-02, PNorm = 35.4001, GNorm = 1.0494, lr_0 = 1.2035e-04
Validation rmse = 0.118379
Validation r2 = 0.885930
Validation mse = 0.014014
Epoch 52
Loss = 7.3880e-02, PNorm = 35.4045, GNorm = 0.7996, lr_0 = 1.1690e-04
Validation rmse = 0.118415
Validation r2 = 0.885861
Validation mse = 0.014022
Epoch 53
Loss = 9.1279e-02, PNorm = 35.4082, GNorm = 1.0976, lr_0 = 1.1385e-04
Loss = 7.5754e-02, PNorm = 35.4122, GNorm = 0.5390, lr_0 = 1.1087e-04
Validation rmse = 0.118494
Validation r2 = 0.885707
Validation mse = 0.014041
Epoch 54
Loss = 6.6684e-02, PNorm = 35.4161, GNorm = 0.9383, lr_0 = 1.0769e-04
Validation rmse = 0.119291
Validation r2 = 0.884166
Validation mse = 0.014230
Epoch 55
Loss = 1.3848e-01, PNorm = 35.4190, GNorm = 2.7697, lr_0 = 1.0488e-04
Loss = 7.0709e-02, PNorm = 35.4223, GNorm = 1.7640, lr_0 = 1.0214e-04
Validation rmse = 0.117520
Validation r2 = 0.887578
Validation mse = 0.013811
Epoch 56
Loss = 7.2837e-02, PNorm = 35.4257, GNorm = 1.3342, lr_0 = 1.0000e-04
Loss = 6.9712e-02, PNorm = 35.4289, GNorm = 0.5095, lr_0 = 1.0000e-04
Validation rmse = 0.119016
Validation r2 = 0.884699
Validation mse = 0.014165
Epoch 57
Loss = 7.1673e-02, PNorm = 35.4315, GNorm = 0.7489, lr_0 = 1.0000e-04
Validation rmse = 0.117873
Validation r2 = 0.886902
Validation mse = 0.013894
Epoch 58
Loss = 6.2454e-02, PNorm = 35.4352, GNorm = 1.2288, lr_0 = 1.0000e-04
Loss = 7.3086e-02, PNorm = 35.4388, GNorm = 0.8355, lr_0 = 1.0000e-04
Loss = 1.9166e-01, PNorm = 35.4390, GNorm = 3.3635, lr_0 = 1.0000e-04
Validation rmse = 0.118819
Validation r2 = 0.885079
Validation mse = 0.014118
Epoch 59
Loss = 7.1860e-02, PNorm = 35.4413, GNorm = 0.3843, lr_0 = 1.0000e-04
Validation rmse = 0.117578
Validation r2 = 0.887468
Validation mse = 0.013825
Model 0 best validation rmse = 0.116737 on epoch 32
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.193161
Model 0 test r2 = 0.660914
Model 0 test mse = 0.037311
Ensemble test rmse = 0.193161
Ensemble test r2 = 0.660914
Ensemble test mse = 0.037311
Fold 4
Splitting data with seed 4
Total size = 965 | train size = 772 | val size = 193 | test size = 57
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.9856e-01, PNorm = 34.0179, GNorm = 2.9859, lr_0 = 4.3000e-04
Validation rmse = 0.301603
Validation r2 = 0.335357
Validation mse = 0.090964
Epoch 1
Loss = 6.7999e-01, PNorm = 34.0602, GNorm = 13.1442, lr_0 = 7.6000e-04
Loss = 5.7248e-01, PNorm = 34.1125, GNorm = 4.0834, lr_0 = 9.9472e-04
Loss = 7.0876e-01, PNorm = 34.1190, GNorm = 6.7985, lr_0 = 9.9209e-04
Validation rmse = 0.260133
Validation r2 = 0.505568
Validation mse = 0.067669
Epoch 2
Loss = 4.5266e-01, PNorm = 34.1920, GNorm = 8.6171, lr_0 = 9.6618e-04
Validation rmse = 0.210129
Validation r2 = 0.677381
Validation mse = 0.044154
Epoch 3
Loss = 2.8662e-01, PNorm = 34.2664, GNorm = 1.4445, lr_0 = 9.4094e-04
Loss = 4.0314e-01, PNorm = 34.3313, GNorm = 15.2620, lr_0 = 9.1637e-04
Validation rmse = 0.203177
Validation r2 = 0.698377
Validation mse = 0.041281
Epoch 4
Loss = 3.2024e-01, PNorm = 34.3910, GNorm = 3.2932, lr_0 = 8.9007e-04
Validation rmse = 0.184282
Validation r2 = 0.751868
Validation mse = 0.033960
Epoch 5
Loss = 1.6916e-01, PNorm = 34.4405, GNorm = 0.7041, lr_0 = 8.6682e-04
Loss = 2.3928e-01, PNorm = 34.4820, GNorm = 2.5162, lr_0 = 8.4418e-04
Validation rmse = 0.169488
Validation r2 = 0.790110
Validation mse = 0.028726
Epoch 6
Loss = 1.9811e-01, PNorm = 34.5282, GNorm = 5.5515, lr_0 = 8.1996e-04
Validation rmse = 0.178771
Validation r2 = 0.766487
Validation mse = 0.031959
Epoch 7
Loss = 2.4659e-01, PNorm = 34.5694, GNorm = 6.5664, lr_0 = 7.9854e-04
Loss = 1.8628e-01, PNorm = 34.6034, GNorm = 3.2823, lr_0 = 7.7769e-04
Validation rmse = 0.156716
Validation r2 = 0.820550
Validation mse = 0.024560
Epoch 8
Loss = 1.8916e-01, PNorm = 34.6348, GNorm = 2.2897, lr_0 = 7.5537e-04
Validation rmse = 0.147224
Validation r2 = 0.841630
Validation mse = 0.021675
Epoch 9
Loss = 1.9820e-01, PNorm = 34.6659, GNorm = 5.4364, lr_0 = 7.3370e-04
Loss = 1.7396e-01, PNorm = 34.6936, GNorm = 2.2307, lr_0 = 7.1453e-04
Validation rmse = 0.150958
Validation r2 = 0.833495
Validation mse = 0.022788
Epoch 10
Loss = 1.6415e-01, PNorm = 34.7243, GNorm = 2.8808, lr_0 = 6.9587e-04
Validation rmse = 0.147292
Validation r2 = 0.841484
Validation mse = 0.021695
Epoch 11
Loss = 1.5486e-01, PNorm = 34.7521, GNorm = 6.2514, lr_0 = 6.7590e-04
Loss = 1.3510e-01, PNorm = 34.7776, GNorm = 3.5124, lr_0 = 6.5825e-04
Validation rmse = 0.141377
Validation r2 = 0.853960
Validation mse = 0.019987
Epoch 12
Loss = 1.5139e-01, PNorm = 34.7965, GNorm = 6.6467, lr_0 = 6.4106e-04
Loss = 1.9375e-01, PNorm = 34.8160, GNorm = 4.9928, lr_0 = 6.2431e-04
Loss = 1.2064e-01, PNorm = 34.8180, GNorm = 2.1639, lr_0 = 6.2266e-04
Validation rmse = 0.144027
Validation r2 = 0.848434
Validation mse = 0.020744
Epoch 13
Loss = 1.4942e-01, PNorm = 34.8386, GNorm = 1.3106, lr_0 = 6.0640e-04
Validation rmse = 0.133018
Validation r2 = 0.870718
Validation mse = 0.017694
Epoch 14
Loss = 1.3695e-01, PNorm = 34.8593, GNorm = 2.8977, lr_0 = 5.9056e-04
Loss = 1.2614e-01, PNorm = 34.8788, GNorm = 3.7489, lr_0 = 5.7514e-04
Validation rmse = 0.127533
Validation r2 = 0.881160
Validation mse = 0.016265
Epoch 15
Loss = 1.1911e-01, PNorm = 34.8913, GNorm = 0.6538, lr_0 = 5.5863e-04
Validation rmse = 0.131242
Validation r2 = 0.874147
Validation mse = 0.017225
Epoch 16
Loss = 1.1912e-01, PNorm = 34.9077, GNorm = 1.4275, lr_0 = 5.4404e-04
Loss = 1.4503e-01, PNorm = 34.9190, GNorm = 2.0372, lr_0 = 5.2983e-04
Validation rmse = 0.128865
Validation r2 = 0.878664
Validation mse = 0.016606
Epoch 17
Loss = 1.3278e-01, PNorm = 34.9320, GNorm = 3.7748, lr_0 = 5.1463e-04
Validation rmse = 0.138587
Validation r2 = 0.859666
Validation mse = 0.019206
Epoch 18
Loss = 1.3082e-01, PNorm = 34.9483, GNorm = 2.6915, lr_0 = 4.9986e-04
Loss = 1.1933e-01, PNorm = 34.9663, GNorm = 6.4357, lr_0 = 4.8681e-04
Validation rmse = 0.127435
Validation r2 = 0.881342
Validation mse = 0.016240
Epoch 19
Loss = 1.3647e-01, PNorm = 34.9772, GNorm = 5.2203, lr_0 = 4.7409e-04
Validation rmse = 0.127679
Validation r2 = 0.880888
Validation mse = 0.016302
Epoch 20
Loss = 1.2742e-01, PNorm = 34.9914, GNorm = 6.0321, lr_0 = 4.6049e-04
Loss = 1.1513e-01, PNorm = 35.0074, GNorm = 1.0025, lr_0 = 4.4846e-04
Validation rmse = 0.128945
Validation r2 = 0.878514
Validation mse = 0.016627
Epoch 21
Loss = 1.1028e-01, PNorm = 35.0208, GNorm = 0.7231, lr_0 = 4.3675e-04
Validation rmse = 0.126174
Validation r2 = 0.883679
Validation mse = 0.015920
Epoch 22
Loss = 1.0119e-01, PNorm = 35.0334, GNorm = 2.1808, lr_0 = 4.2422e-04
Loss = 1.0010e-01, PNorm = 35.0433, GNorm = 1.5447, lr_0 = 4.1313e-04
Validation rmse = 0.128651
Validation r2 = 0.879067
Validation mse = 0.016551
Epoch 23
Loss = 1.0670e-01, PNorm = 35.0537, GNorm = 1.1568, lr_0 = 4.0234e-04
Loss = 1.1052e-01, PNorm = 35.0647, GNorm = 0.8313, lr_0 = 3.9184e-04
Loss = 5.3885e-02, PNorm = 35.0659, GNorm = 1.0701, lr_0 = 3.9080e-04
Validation rmse = 0.134390
Validation r2 = 0.868037
Validation mse = 0.018061
Epoch 24
Loss = 1.0569e-01, PNorm = 35.0763, GNorm = 1.5085, lr_0 = 3.8059e-04
Validation rmse = 0.127829
Validation r2 = 0.880609
Validation mse = 0.016340
Epoch 25
Loss = 1.1244e-01, PNorm = 35.0874, GNorm = 1.1006, lr_0 = 3.7065e-04
Loss = 1.1479e-01, PNorm = 35.0987, GNorm = 2.7748, lr_0 = 3.6097e-04
Validation rmse = 0.130693
Validation r2 = 0.875199
Validation mse = 0.017081
Epoch 26
Loss = 1.0675e-01, PNorm = 35.1080, GNorm = 4.1597, lr_0 = 3.5061e-04
Validation rmse = 0.125997
Validation r2 = 0.884005
Validation mse = 0.015875
Epoch 27
Loss = 9.1952e-02, PNorm = 35.1199, GNorm = 0.4172, lr_0 = 3.4055e-04
Loss = 1.0087e-01, PNorm = 35.1301, GNorm = 1.1148, lr_0 = 3.3166e-04
Validation rmse = 0.121953
Validation r2 = 0.891332
Validation mse = 0.014872
Epoch 28
Loss = 8.1404e-02, PNorm = 35.1399, GNorm = 1.7023, lr_0 = 3.2299e-04
Validation rmse = 0.125990
Validation r2 = 0.884019
Validation mse = 0.015873
Epoch 29
Loss = 1.3124e-01, PNorm = 35.1494, GNorm = 0.9478, lr_0 = 3.1373e-04
Loss = 9.0827e-02, PNorm = 35.1556, GNorm = 0.5531, lr_0 = 3.0553e-04
Validation rmse = 0.127166
Validation r2 = 0.881844
Validation mse = 0.016171
Epoch 30
Loss = 9.9888e-02, PNorm = 35.1647, GNorm = 2.1808, lr_0 = 2.9755e-04
Validation rmse = 0.123592
Validation r2 = 0.888392
Validation mse = 0.015275
Epoch 31
Loss = 7.7941e-02, PNorm = 35.1728, GNorm = 3.1706, lr_0 = 2.8901e-04
Loss = 9.3560e-02, PNorm = 35.1814, GNorm = 1.8248, lr_0 = 2.8147e-04
Validation rmse = 0.132673
Validation r2 = 0.871388
Validation mse = 0.017602
Epoch 32
Loss = 1.2085e-01, PNorm = 35.1896, GNorm = 2.3840, lr_0 = 2.7411e-04
Validation rmse = 0.123053
Validation r2 = 0.889363
Validation mse = 0.015142
Epoch 33
Loss = 9.2085e-02, PNorm = 35.1994, GNorm = 0.9838, lr_0 = 2.6625e-04
Loss = 1.0447e-01, PNorm = 35.2069, GNorm = 4.4603, lr_0 = 2.5929e-04
Validation rmse = 0.123368
Validation r2 = 0.888796
Validation mse = 0.015220
Epoch 34
Loss = 1.0978e-01, PNorm = 35.2145, GNorm = 2.7245, lr_0 = 2.5185e-04
Loss = 8.6290e-02, PNorm = 35.2219, GNorm = 1.4694, lr_0 = 2.4528e-04
Validation rmse = 0.122782
Validation r2 = 0.889850
Validation mse = 0.015075
Epoch 35
Loss = 9.5266e-02, PNorm = 35.2291, GNorm = 1.1494, lr_0 = 2.3887e-04
Validation rmse = 0.132817
Validation r2 = 0.871108
Validation mse = 0.017640
Epoch 36
Loss = 1.0497e-01, PNorm = 35.2359, GNorm = 2.9285, lr_0 = 2.3202e-04
Loss = 8.9835e-02, PNorm = 35.2442, GNorm = 0.9556, lr_0 = 2.2596e-04
Validation rmse = 0.121438
Validation r2 = 0.892248
Validation mse = 0.014747
Epoch 37
Loss = 7.8120e-02, PNorm = 35.2508, GNorm = 1.7647, lr_0 = 2.2005e-04
Validation rmse = 0.122476
Validation r2 = 0.890398
Validation mse = 0.015000
Epoch 38
Loss = 8.8888e-02, PNorm = 35.2574, GNorm = 1.7887, lr_0 = 2.1374e-04
Loss = 9.2698e-02, PNorm = 35.2639, GNorm = 1.9153, lr_0 = 2.0816e-04
Validation rmse = 0.128134
Validation r2 = 0.880038
Validation mse = 0.016418
Epoch 39
Loss = 9.7821e-02, PNorm = 35.2700, GNorm = 0.7364, lr_0 = 2.0272e-04
Validation rmse = 0.120308
Validation r2 = 0.894244
Validation mse = 0.014474
Epoch 40
Loss = 1.0087e-01, PNorm = 35.2757, GNorm = 0.5247, lr_0 = 1.9690e-04
Loss = 7.8078e-02, PNorm = 35.2804, GNorm = 0.7674, lr_0 = 1.9176e-04
Validation rmse = 0.121545
Validation r2 = 0.892057
Validation mse = 0.014773
Epoch 41
Loss = 7.7829e-02, PNorm = 35.2857, GNorm = 2.2977, lr_0 = 1.8675e-04
Validation rmse = 0.123733
Validation r2 = 0.888137
Validation mse = 0.015310
Epoch 42
Loss = 6.8128e-02, PNorm = 35.2923, GNorm = 0.6160, lr_0 = 1.8139e-04
Loss = 9.1796e-02, PNorm = 35.2981, GNorm = 1.0023, lr_0 = 1.7666e-04
Validation rmse = 0.121009
Validation r2 = 0.893008
Validation mse = 0.014643
Epoch 43
Loss = 7.4752e-02, PNorm = 35.3034, GNorm = 0.6212, lr_0 = 1.7159e-04
Validation rmse = 0.120187
Validation r2 = 0.894457
Validation mse = 0.014445
Epoch 44
Loss = 1.0503e-01, PNorm = 35.3077, GNorm = 1.3194, lr_0 = 1.6710e-04
Loss = 7.9440e-02, PNorm = 35.3114, GNorm = 0.8733, lr_0 = 1.6274e-04
Validation rmse = 0.124010
Validation r2 = 0.887635
Validation mse = 0.015379
Epoch 45
Loss = 7.1941e-02, PNorm = 35.3180, GNorm = 1.6993, lr_0 = 1.5807e-04
Loss = 9.3894e-02, PNorm = 35.3224, GNorm = 1.1250, lr_0 = 1.5394e-04
Validation rmse = 0.128080
Validation r2 = 0.880139
Validation mse = 0.016404
Epoch 46
Loss = 8.7900e-02, PNorm = 35.3278, GNorm = 2.9150, lr_0 = 1.4992e-04
Validation rmse = 0.121484
Validation r2 = 0.892167
Validation mse = 0.014758
Epoch 47
Loss = 7.9828e-02, PNorm = 35.3333, GNorm = 1.7602, lr_0 = 1.4562e-04
Loss = 9.0077e-02, PNorm = 35.3380, GNorm = 1.7347, lr_0 = 1.4182e-04
Validation rmse = 0.122252
Validation r2 = 0.890798
Validation mse = 0.014946
Epoch 48
Loss = 7.7637e-02, PNorm = 35.3423, GNorm = 1.7594, lr_0 = 1.3811e-04
Validation rmse = 0.119660
Validation r2 = 0.895380
Validation mse = 0.014318
Epoch 49
Loss = 9.0090e-02, PNorm = 35.3463, GNorm = 1.6175, lr_0 = 1.3415e-04
Loss = 7.7524e-02, PNorm = 35.3507, GNorm = 1.1899, lr_0 = 1.3064e-04
Validation rmse = 0.120036
Validation r2 = 0.894721
Validation mse = 0.014409
Epoch 50
Loss = 7.9647e-02, PNorm = 35.3537, GNorm = 0.8501, lr_0 = 1.2723e-04
Validation rmse = 0.121221
Validation r2 = 0.892633
Validation mse = 0.014694
Epoch 51
Loss = 7.7807e-02, PNorm = 35.3574, GNorm = 1.8082, lr_0 = 1.2358e-04
Loss = 8.3703e-02, PNorm = 35.3615, GNorm = 1.1228, lr_0 = 1.2035e-04
Validation rmse = 0.121063
Validation r2 = 0.892912
Validation mse = 0.014656
Epoch 52
Loss = 9.0511e-02, PNorm = 35.3657, GNorm = 0.7756, lr_0 = 1.1690e-04
Validation rmse = 0.120181
Validation r2 = 0.894467
Validation mse = 0.014444
Epoch 53
Loss = 7.6139e-02, PNorm = 35.3689, GNorm = 0.9411, lr_0 = 1.1385e-04
Loss = 7.7822e-02, PNorm = 35.3725, GNorm = 0.9510, lr_0 = 1.1087e-04
Validation rmse = 0.120626
Validation r2 = 0.893683
Validation mse = 0.014551
Epoch 54
Loss = 9.7050e-02, PNorm = 35.3762, GNorm = 0.5854, lr_0 = 1.0769e-04
Validation rmse = 0.119628
Validation r2 = 0.895436
Validation mse = 0.014311
Epoch 55
Loss = 8.9024e-02, PNorm = 35.3791, GNorm = 1.2097, lr_0 = 1.0488e-04
Loss = 7.5762e-02, PNorm = 35.3827, GNorm = 1.1532, lr_0 = 1.0214e-04
Validation rmse = 0.120990
Validation r2 = 0.893041
Validation mse = 0.014639
Epoch 56
Loss = 7.4788e-02, PNorm = 35.3859, GNorm = 0.9671, lr_0 = 1.0000e-04
Loss = 8.4851e-02, PNorm = 35.3883, GNorm = 1.2518, lr_0 = 1.0000e-04
Validation rmse = 0.121227
Validation r2 = 0.892622
Validation mse = 0.014696
Epoch 57
Loss = 7.4813e-02, PNorm = 35.3914, GNorm = 0.6334, lr_0 = 1.0000e-04
Validation rmse = 0.119718
Validation r2 = 0.895279
Validation mse = 0.014332
Epoch 58
Loss = 8.0475e-02, PNorm = 35.3947, GNorm = 2.5730, lr_0 = 1.0000e-04
Loss = 7.7791e-02, PNorm = 35.3979, GNorm = 0.8438, lr_0 = 1.0000e-04
Loss = 7.3711e-02, PNorm = 35.3981, GNorm = 1.0319, lr_0 = 1.0000e-04
Validation rmse = 0.119474
Validation r2 = 0.895704
Validation mse = 0.014274
Epoch 59
Loss = 7.2834e-02, PNorm = 35.4013, GNorm = 0.6956, lr_0 = 1.0000e-04
Validation rmse = 0.119012
Validation r2 = 0.896511
Validation mse = 0.014164
Model 0 best validation rmse = 0.119012 on epoch 59
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.213242
Model 0 test r2 = 0.586748
Model 0 test mse = 0.045472
Ensemble test rmse = 0.213242
Ensemble test r2 = 0.586748
Ensemble test mse = 0.045472
Fold 5
Splitting data with seed 5
Total size = 965 | train size = 772 | val size = 193 | test size = 57
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.5917e-01, PNorm = 34.0153, GNorm = 2.5693, lr_0 = 4.3000e-04
Validation rmse = 0.284226
Validation r2 = 0.315296
Validation mse = 0.080784
Epoch 1
Loss = 6.2409e-01, PNorm = 34.0551, GNorm = 7.0891, lr_0 = 7.6000e-04
Loss = 6.2823e-01, PNorm = 34.1136, GNorm = 5.9055, lr_0 = 9.9472e-04
Loss = 4.8767e-01, PNorm = 34.1216, GNorm = 9.1368, lr_0 = 9.9209e-04
Validation rmse = 0.264207
Validation r2 = 0.408351
Validation mse = 0.069805
Epoch 2
Loss = 4.3331e-01, PNorm = 34.2009, GNorm = 1.5734, lr_0 = 9.6618e-04
Validation rmse = 0.222503
Validation r2 = 0.580389
Validation mse = 0.049508
Epoch 3
Loss = 3.6532e-01, PNorm = 34.2740, GNorm = 1.0259, lr_0 = 9.4094e-04
Loss = 3.0373e-01, PNorm = 34.3457, GNorm = 2.9782, lr_0 = 9.1637e-04
Validation rmse = 0.177418
Validation r2 = 0.733211
Validation mse = 0.031477
Epoch 4
Loss = 3.3339e-01, PNorm = 34.4093, GNorm = 3.1671, lr_0 = 8.9007e-04
Validation rmse = 0.204772
Validation r2 = 0.644600
Validation mse = 0.041932
Epoch 5
Loss = 3.4990e-01, PNorm = 34.4554, GNorm = 4.3313, lr_0 = 8.6682e-04
Loss = 2.4110e-01, PNorm = 34.5033, GNorm = 2.4178, lr_0 = 8.4418e-04
Validation rmse = 0.159890
Validation r2 = 0.783321
Validation mse = 0.025565
Epoch 6
Loss = 2.1759e-01, PNorm = 34.5463, GNorm = 5.9863, lr_0 = 8.1996e-04
Validation rmse = 0.153981
Validation r2 = 0.799041
Validation mse = 0.023710
Epoch 7
Loss = 2.1003e-01, PNorm = 34.5815, GNorm = 3.3650, lr_0 = 7.9854e-04
Loss = 1.7261e-01, PNorm = 34.6166, GNorm = 2.5254, lr_0 = 7.7769e-04
Validation rmse = 0.168519
Validation r2 = 0.759301
Validation mse = 0.028399
Epoch 8
Loss = 2.0001e-01, PNorm = 34.6535, GNorm = 2.4191, lr_0 = 7.5537e-04
Validation rmse = 0.135419
Validation r2 = 0.844570
Validation mse = 0.018338
Epoch 9
Loss = 1.4233e-01, PNorm = 34.6830, GNorm = 4.6263, lr_0 = 7.3370e-04
Loss = 1.4569e-01, PNorm = 34.7102, GNorm = 3.4713, lr_0 = 7.1453e-04
Validation rmse = 0.129637
Validation r2 = 0.857559
Validation mse = 0.016806
Epoch 10
Loss = 1.6233e-01, PNorm = 34.7376, GNorm = 6.5454, lr_0 = 6.9587e-04
Validation rmse = 0.124955
Validation r2 = 0.867663
Validation mse = 0.015614
Epoch 11
Loss = 1.1446e-01, PNorm = 34.7632, GNorm = 1.4287, lr_0 = 6.7590e-04
Loss = 1.6192e-01, PNorm = 34.7883, GNorm = 1.1682, lr_0 = 6.5825e-04
Validation rmse = 0.126278
Validation r2 = 0.864846
Validation mse = 0.015946
Epoch 12
Loss = 1.1529e-01, PNorm = 34.8022, GNorm = 0.7417, lr_0 = 6.4106e-04
Loss = 1.3016e-01, PNorm = 34.8201, GNorm = 0.8876, lr_0 = 6.2431e-04
Loss = 4.8956e-02, PNorm = 34.8219, GNorm = 0.7143, lr_0 = 6.2266e-04
Validation rmse = 0.124893
Validation r2 = 0.867793
Validation mse = 0.015598
Epoch 13
Loss = 1.3974e-01, PNorm = 34.8362, GNorm = 4.7005, lr_0 = 6.0640e-04
Validation rmse = 0.132722
Validation r2 = 0.850700
Validation mse = 0.017615
Epoch 14
Loss = 1.1423e-01, PNorm = 34.8522, GNorm = 2.4919, lr_0 = 5.9056e-04
Loss = 1.3937e-01, PNorm = 34.8704, GNorm = 0.9002, lr_0 = 5.7514e-04
Validation rmse = 0.125870
Validation r2 = 0.865718
Validation mse = 0.015843
Epoch 15
Loss = 1.3408e-01, PNorm = 34.8883, GNorm = 0.5500, lr_0 = 5.5863e-04
Validation rmse = 0.123590
Validation r2 = 0.870537
Validation mse = 0.015275
Epoch 16
Loss = 9.8902e-02, PNorm = 34.9019, GNorm = 1.9038, lr_0 = 5.4404e-04
Loss = 1.1239e-01, PNorm = 34.9157, GNorm = 0.9252, lr_0 = 5.2983e-04
Validation rmse = 0.124051
Validation r2 = 0.869571
Validation mse = 0.015389
Epoch 17
Loss = 1.0292e-01, PNorm = 34.9286, GNorm = 1.3343, lr_0 = 5.1463e-04
Validation rmse = 0.119168
Validation r2 = 0.879636
Validation mse = 0.014201
Epoch 18
Loss = 1.0717e-01, PNorm = 34.9414, GNorm = 2.4920, lr_0 = 4.9986e-04
Loss = 1.2319e-01, PNorm = 34.9543, GNorm = 4.6481, lr_0 = 4.8681e-04
Validation rmse = 0.130944
Validation r2 = 0.854673
Validation mse = 0.017146
Epoch 19
Loss = 1.0590e-01, PNorm = 34.9683, GNorm = 0.7811, lr_0 = 4.7409e-04
Validation rmse = 0.120383
Validation r2 = 0.877169
Validation mse = 0.014492
Epoch 20
Loss = 1.0947e-01, PNorm = 34.9837, GNorm = 1.3591, lr_0 = 4.6049e-04
Loss = 1.0870e-01, PNorm = 34.9939, GNorm = 0.7007, lr_0 = 4.4846e-04
Validation rmse = 0.119004
Validation r2 = 0.879967
Validation mse = 0.014162
Epoch 21
Loss = 1.3252e-01, PNorm = 35.0063, GNorm = 3.4811, lr_0 = 4.3675e-04
Validation rmse = 0.120111
Validation r2 = 0.877724
Validation mse = 0.014427
Epoch 22
Loss = 1.0707e-01, PNorm = 35.0177, GNorm = 2.1283, lr_0 = 4.2422e-04
Loss = 1.0516e-01, PNorm = 35.0307, GNorm = 3.1372, lr_0 = 4.1313e-04
Validation rmse = 0.120704
Validation r2 = 0.876514
Validation mse = 0.014569
Epoch 23
Loss = 8.9218e-02, PNorm = 35.0389, GNorm = 0.6745, lr_0 = 4.0234e-04
Loss = 1.0876e-01, PNorm = 35.0483, GNorm = 1.2399, lr_0 = 3.9184e-04
Loss = 1.3417e-01, PNorm = 35.0493, GNorm = 1.1679, lr_0 = 3.9080e-04
Validation rmse = 0.116011
Validation r2 = 0.885930
Validation mse = 0.013458
Epoch 24
Loss = 1.0840e-01, PNorm = 35.0597, GNorm = 3.1315, lr_0 = 3.8059e-04
Validation rmse = 0.126009
Validation r2 = 0.865420
Validation mse = 0.015878
Epoch 25
Loss = 1.0584e-01, PNorm = 35.0691, GNorm = 1.4788, lr_0 = 3.7065e-04
Loss = 1.2436e-01, PNorm = 35.0789, GNorm = 5.4991, lr_0 = 3.6097e-04
Validation rmse = 0.117247
Validation r2 = 0.883486
Validation mse = 0.013747
Epoch 26
Loss = 9.9938e-02, PNorm = 35.0872, GNorm = 0.7532, lr_0 = 3.5061e-04
Validation rmse = 0.116479
Validation r2 = 0.885008
Validation mse = 0.013567
Epoch 27
Loss = 8.7830e-02, PNorm = 35.0978, GNorm = 1.5867, lr_0 = 3.4055e-04
Loss = 1.0267e-01, PNorm = 35.1060, GNorm = 3.4636, lr_0 = 3.3166e-04
Validation rmse = 0.120922
Validation r2 = 0.876068
Validation mse = 0.014622
Epoch 28
Loss = 9.4610e-02, PNorm = 35.1131, GNorm = 1.0918, lr_0 = 3.2299e-04
Validation rmse = 0.119294
Validation r2 = 0.879383
Validation mse = 0.014231
Epoch 29
Loss = 7.5639e-02, PNorm = 35.1216, GNorm = 2.1067, lr_0 = 3.1373e-04
Loss = 1.0331e-01, PNorm = 35.1311, GNorm = 0.6329, lr_0 = 3.0553e-04
Validation rmse = 0.116199
Validation r2 = 0.885560
Validation mse = 0.013502
Epoch 30
Loss = 7.5161e-02, PNorm = 35.1382, GNorm = 0.6231, lr_0 = 2.9755e-04
Validation rmse = 0.119432
Validation r2 = 0.879103
Validation mse = 0.014264
Epoch 31
Loss = 9.5591e-02, PNorm = 35.1464, GNorm = 1.2353, lr_0 = 2.8901e-04
Loss = 9.3157e-02, PNorm = 35.1525, GNorm = 1.4428, lr_0 = 2.8147e-04
Validation rmse = 0.116446
Validation r2 = 0.885072
Validation mse = 0.013560
Epoch 32
Loss = 9.2189e-02, PNorm = 35.1597, GNorm = 2.5711, lr_0 = 2.7411e-04
Validation rmse = 0.116548
Validation r2 = 0.884870
Validation mse = 0.013584
Epoch 33
Loss = 7.8261e-02, PNorm = 35.1685, GNorm = 0.5668, lr_0 = 2.6625e-04
Loss = 9.0967e-02, PNorm = 35.1767, GNorm = 1.2523, lr_0 = 2.5929e-04
Validation rmse = 0.117005
Validation r2 = 0.883966
Validation mse = 0.013690
Epoch 34
Loss = 9.2440e-02, PNorm = 35.1833, GNorm = 1.4617, lr_0 = 2.5185e-04
Loss = 8.7470e-02, PNorm = 35.1906, GNorm = 3.4522, lr_0 = 2.4528e-04
Validation rmse = 0.117132
Validation r2 = 0.883715
Validation mse = 0.013720
Epoch 35
Loss = 8.7932e-02, PNorm = 35.1995, GNorm = 0.8426, lr_0 = 2.3887e-04
Validation rmse = 0.117641
Validation r2 = 0.882702
Validation mse = 0.013839
Epoch 36
Loss = 9.5641e-02, PNorm = 35.2042, GNorm = 1.9916, lr_0 = 2.3202e-04
Loss = 8.9315e-02, PNorm = 35.2094, GNorm = 1.0068, lr_0 = 2.2596e-04
Validation rmse = 0.117214
Validation r2 = 0.883552
Validation mse = 0.013739
Epoch 37
Loss = 9.7691e-02, PNorm = 35.2160, GNorm = 0.9871, lr_0 = 2.2005e-04
Validation rmse = 0.117081
Validation r2 = 0.883815
Validation mse = 0.013708
Epoch 38
Loss = 7.8251e-02, PNorm = 35.2231, GNorm = 0.9436, lr_0 = 2.1374e-04
Loss = 9.4500e-02, PNorm = 35.2285, GNorm = 0.5221, lr_0 = 2.0816e-04
Validation rmse = 0.115863
Validation r2 = 0.886221
Validation mse = 0.013424
Epoch 39
Loss = 8.3786e-02, PNorm = 35.2350, GNorm = 1.5037, lr_0 = 2.0272e-04
Validation rmse = 0.115460
Validation r2 = 0.887011
Validation mse = 0.013331
Epoch 40
Loss = 9.9392e-02, PNorm = 35.2406, GNorm = 1.3187, lr_0 = 1.9690e-04
Loss = 8.0866e-02, PNorm = 35.2449, GNorm = 0.9551, lr_0 = 1.9176e-04
Validation rmse = 0.115835
Validation r2 = 0.886276
Validation mse = 0.013418
Epoch 41
Loss = 9.4815e-02, PNorm = 35.2501, GNorm = 0.9929, lr_0 = 1.8675e-04
Validation rmse = 0.118185
Validation r2 = 0.881614
Validation mse = 0.013968
Epoch 42
Loss = 7.9407e-02, PNorm = 35.2552, GNorm = 1.0556, lr_0 = 1.8139e-04
Loss = 8.4665e-02, PNorm = 35.2583, GNorm = 2.4599, lr_0 = 1.7666e-04
Validation rmse = 0.114754
Validation r2 = 0.888388
Validation mse = 0.013169
Epoch 43
Loss = 8.3309e-02, PNorm = 35.2639, GNorm = 0.7016, lr_0 = 1.7159e-04
Validation rmse = 0.115326
Validation r2 = 0.887273
Validation mse = 0.013300
Epoch 44
Loss = 8.7299e-02, PNorm = 35.2689, GNorm = 0.9927, lr_0 = 1.6710e-04
Loss = 7.4247e-02, PNorm = 35.2729, GNorm = 1.1521, lr_0 = 1.6274e-04
Validation rmse = 0.114744
Validation r2 = 0.888408
Validation mse = 0.013166
Epoch 45
Loss = 8.5772e-02, PNorm = 35.2773, GNorm = 1.8278, lr_0 = 1.5807e-04
Loss = 8.2957e-02, PNorm = 35.2816, GNorm = 2.9499, lr_0 = 1.5394e-04
Validation rmse = 0.114215
Validation r2 = 0.889433
Validation mse = 0.013045
Epoch 46
Loss = 8.8082e-02, PNorm = 35.2869, GNorm = 0.5576, lr_0 = 1.4992e-04
Validation rmse = 0.115607
Validation r2 = 0.886724
Validation mse = 0.013365
Epoch 47
Loss = 7.1436e-02, PNorm = 35.2929, GNorm = 0.7525, lr_0 = 1.4562e-04
Loss = 8.2783e-02, PNorm = 35.2967, GNorm = 0.6972, lr_0 = 1.4182e-04
Validation rmse = 0.115437
Validation r2 = 0.887056
Validation mse = 0.013326
Epoch 48
Loss = 7.7676e-02, PNorm = 35.3019, GNorm = 2.0683, lr_0 = 1.3811e-04
Validation rmse = 0.115513
Validation r2 = 0.886907
Validation mse = 0.013343
Epoch 49
Loss = 6.1265e-02, PNorm = 35.3062, GNorm = 0.4557, lr_0 = 1.3415e-04
Loss = 8.2788e-02, PNorm = 35.3103, GNorm = 0.7434, lr_0 = 1.3064e-04
Validation rmse = 0.115024
Validation r2 = 0.887863
Validation mse = 0.013230
Epoch 50
Loss = 7.8729e-02, PNorm = 35.3135, GNorm = 1.1480, lr_0 = 1.2723e-04
Validation rmse = 0.114781
Validation r2 = 0.888336
Validation mse = 0.013175
Epoch 51
Loss = 8.7360e-02, PNorm = 35.3168, GNorm = 1.2263, lr_0 = 1.2358e-04
Loss = 8.2527e-02, PNorm = 35.3207, GNorm = 0.8130, lr_0 = 1.2035e-04
Validation rmse = 0.115241
Validation r2 = 0.887438
Validation mse = 0.013281
Epoch 52
Loss = 8.6682e-02, PNorm = 35.3239, GNorm = 1.7672, lr_0 = 1.1690e-04
Validation rmse = 0.113680
Validation r2 = 0.890468
Validation mse = 0.012923
Epoch 53
Loss = 7.6184e-02, PNorm = 35.3276, GNorm = 1.1997, lr_0 = 1.1385e-04
Loss = 8.7042e-02, PNorm = 35.3311, GNorm = 0.5048, lr_0 = 1.1087e-04
Validation rmse = 0.115085
Validation r2 = 0.887744
Validation mse = 0.013245
Epoch 54
Loss = 9.1935e-02, PNorm = 35.3341, GNorm = 0.6225, lr_0 = 1.0769e-04
Validation rmse = 0.114870
Validation r2 = 0.888162
Validation mse = 0.013195
Epoch 55
Loss = 5.8791e-02, PNorm = 35.3368, GNorm = 1.0818, lr_0 = 1.0488e-04
Loss = 7.8322e-02, PNorm = 35.3402, GNorm = 0.6601, lr_0 = 1.0214e-04
Validation rmse = 0.114521
Validation r2 = 0.888842
Validation mse = 0.013115
Epoch 56
Loss = 7.0311e-02, PNorm = 35.3427, GNorm = 0.5790, lr_0 = 1.0000e-04
Loss = 8.3828e-02, PNorm = 35.3456, GNorm = 1.1451, lr_0 = 1.0000e-04
Validation rmse = 0.113399
Validation r2 = 0.891008
Validation mse = 0.012859
Epoch 57
Loss = 7.3775e-02, PNorm = 35.3489, GNorm = 0.7655, lr_0 = 1.0000e-04
Validation rmse = 0.114234
Validation r2 = 0.889397
Validation mse = 0.013049
Epoch 58
Loss = 5.9633e-02, PNorm = 35.3519, GNorm = 1.2446, lr_0 = 1.0000e-04
Loss = 8.4634e-02, PNorm = 35.3539, GNorm = 0.9821, lr_0 = 1.0000e-04
Loss = 8.3482e-02, PNorm = 35.3542, GNorm = 2.2129, lr_0 = 1.0000e-04
Validation rmse = 0.114867
Validation r2 = 0.888168
Validation mse = 0.013194
Epoch 59
Loss = 7.9868e-02, PNorm = 35.3573, GNorm = 1.7510, lr_0 = 1.0000e-04
Validation rmse = 0.115187
Validation r2 = 0.887544
Validation mse = 0.013268
Model 0 best validation rmse = 0.113399 on epoch 56
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.210195
Model 0 test r2 = 0.598471
Model 0 test mse = 0.044182
Ensemble test rmse = 0.210195
Ensemble test r2 = 0.598471
Ensemble test mse = 0.044182
Fold 6
Splitting data with seed 6
Total size = 965 | train size = 772 | val size = 193 | test size = 57
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 1.0074e+00, PNorm = 34.0146, GNorm = 1.0430, lr_0 = 4.3000e-04
Validation rmse = 0.300187
Validation r2 = 0.168052
Validation mse = 0.090112
Epoch 1
Loss = 6.8641e-01, PNorm = 34.0433, GNorm = 2.7450, lr_0 = 7.6000e-04
Loss = 6.7973e-01, PNorm = 34.0996, GNorm = 4.1815, lr_0 = 9.9472e-04
Loss = 7.8080e-01, PNorm = 34.1065, GNorm = 7.9487, lr_0 = 9.9209e-04
Validation rmse = 0.281010
Validation r2 = 0.270953
Validation mse = 0.078967
Epoch 2
Loss = 5.4879e-01, PNorm = 34.1823, GNorm = 3.5363, lr_0 = 9.6618e-04
Validation rmse = 0.200718
Validation r2 = 0.628051
Validation mse = 0.040288
Epoch 3
Loss = 3.6899e-01, PNorm = 34.2642, GNorm = 1.3303, lr_0 = 9.4094e-04
Loss = 3.3074e-01, PNorm = 34.3275, GNorm = 2.1075, lr_0 = 9.1637e-04
Validation rmse = 0.178517
Validation r2 = 0.705781
Validation mse = 0.031868
Epoch 4
Loss = 2.9634e-01, PNorm = 34.3988, GNorm = 2.8697, lr_0 = 8.9007e-04
Validation rmse = 0.172339
Validation r2 = 0.725791
Validation mse = 0.029701
Epoch 5
Loss = 1.6579e-01, PNorm = 34.4537, GNorm = 2.7212, lr_0 = 8.6682e-04
Loss = 2.2543e-01, PNorm = 34.5078, GNorm = 1.3174, lr_0 = 8.4418e-04
Validation rmse = 0.165383
Validation r2 = 0.747482
Validation mse = 0.027351
Epoch 6
Loss = 2.0559e-01, PNorm = 34.5610, GNorm = 1.7339, lr_0 = 8.1996e-04
Validation rmse = 0.156232
Validation r2 = 0.774653
Validation mse = 0.024408
Epoch 7
Loss = 1.5187e-01, PNorm = 34.6052, GNorm = 5.6937, lr_0 = 7.9854e-04
Loss = 1.9386e-01, PNorm = 34.6407, GNorm = 1.6935, lr_0 = 7.7769e-04
Validation rmse = 0.164257
Validation r2 = 0.750907
Validation mse = 0.026980
Epoch 8
Loss = 1.8013e-01, PNorm = 34.6823, GNorm = 1.2202, lr_0 = 7.5537e-04
Validation rmse = 0.136616
Validation r2 = 0.827688
Validation mse = 0.018664
Epoch 9
Loss = 1.3754e-01, PNorm = 34.7211, GNorm = 1.9685, lr_0 = 7.3370e-04
Loss = 1.3873e-01, PNorm = 34.7521, GNorm = 0.6388, lr_0 = 7.1453e-04
Validation rmse = 0.128289
Validation r2 = 0.848053
Validation mse = 0.016458
Epoch 10
Loss = 1.1686e-01, PNorm = 34.7770, GNorm = 4.5573, lr_0 = 6.9587e-04
Validation rmse = 0.125102
Validation r2 = 0.855509
Validation mse = 0.015651
Epoch 11
Loss = 1.0653e-01, PNorm = 34.8032, GNorm = 0.4976, lr_0 = 6.7590e-04
Loss = 1.2500e-01, PNorm = 34.8252, GNorm = 0.6907, lr_0 = 6.5825e-04
Validation rmse = 0.126179
Validation r2 = 0.853010
Validation mse = 0.015921
Epoch 12
Loss = 1.0185e-01, PNorm = 34.8420, GNorm = 1.2221, lr_0 = 6.4106e-04
Loss = 1.2594e-01, PNorm = 34.8579, GNorm = 1.5597, lr_0 = 6.2431e-04
Loss = 6.6342e-02, PNorm = 34.8595, GNorm = 1.0512, lr_0 = 6.2266e-04
Validation rmse = 0.127388
Validation r2 = 0.850179
Validation mse = 0.016228
Epoch 13
Loss = 1.1812e-01, PNorm = 34.8786, GNorm = 3.0172, lr_0 = 6.0640e-04
Validation rmse = 0.138689
Validation r2 = 0.822419
Validation mse = 0.019235
Epoch 14
Loss = 1.4201e-01, PNorm = 34.8967, GNorm = 5.9045, lr_0 = 5.9056e-04
Loss = 1.1781e-01, PNorm = 34.9157, GNorm = 1.2825, lr_0 = 5.7514e-04
Validation rmse = 0.134673
Validation r2 = 0.832555
Validation mse = 0.018137
Epoch 15
Loss = 1.1885e-01, PNorm = 34.9322, GNorm = 1.8359, lr_0 = 5.5863e-04
Validation rmse = 0.120485
Validation r2 = 0.865977
Validation mse = 0.014517
Epoch 16
Loss = 1.3379e-01, PNorm = 34.9514, GNorm = 0.5089, lr_0 = 5.4404e-04
Loss = 9.9683e-02, PNorm = 34.9661, GNorm = 1.3636, lr_0 = 5.2983e-04
Validation rmse = 0.127664
Validation r2 = 0.849530
Validation mse = 0.016298
Epoch 17
Loss = 1.2499e-01, PNorm = 34.9843, GNorm = 4.5094, lr_0 = 5.1463e-04
Validation rmse = 0.119757
Validation r2 = 0.867593
Validation mse = 0.014342
Epoch 18
Loss = 1.0182e-01, PNorm = 34.9980, GNorm = 2.8504, lr_0 = 4.9986e-04
Loss = 1.0310e-01, PNorm = 35.0080, GNorm = 3.1308, lr_0 = 4.8681e-04
Validation rmse = 0.133570
Validation r2 = 0.835287
Validation mse = 0.017841
Epoch 19
Loss = 1.0574e-01, PNorm = 35.0236, GNorm = 1.7245, lr_0 = 4.7409e-04
Validation rmse = 0.122448
Validation r2 = 0.861574
Validation mse = 0.014994
Epoch 20
Loss = 1.0832e-01, PNorm = 35.0384, GNorm = 1.6699, lr_0 = 4.6049e-04
Loss = 1.0971e-01, PNorm = 35.0508, GNorm = 2.1282, lr_0 = 4.4846e-04
Validation rmse = 0.134978
Validation r2 = 0.831795
Validation mse = 0.018219
Epoch 21
Loss = 1.0877e-01, PNorm = 35.0607, GNorm = 2.2268, lr_0 = 4.3675e-04
Validation rmse = 0.121088
Validation r2 = 0.864632
Validation mse = 0.014662
Epoch 22
Loss = 7.5701e-02, PNorm = 35.0718, GNorm = 0.5339, lr_0 = 4.2422e-04
Loss = 1.1015e-01, PNorm = 35.0882, GNorm = 2.2391, lr_0 = 4.1313e-04
Validation rmse = 0.119172
Validation r2 = 0.868881
Validation mse = 0.014202
Epoch 23
Loss = 9.8216e-02, PNorm = 35.0966, GNorm = 2.2405, lr_0 = 4.0234e-04
Loss = 9.1459e-02, PNorm = 35.1067, GNorm = 2.8469, lr_0 = 3.9184e-04
Loss = 6.3944e-02, PNorm = 35.1075, GNorm = 0.9760, lr_0 = 3.9080e-04
Validation rmse = 0.136511
Validation r2 = 0.827953
Validation mse = 0.018635
Epoch 24
Loss = 1.0025e-01, PNorm = 35.1182, GNorm = 1.1594, lr_0 = 3.8059e-04
Validation rmse = 0.122270
Validation r2 = 0.861978
Validation mse = 0.014950
Epoch 25
Loss = 9.7970e-02, PNorm = 35.1312, GNorm = 2.9773, lr_0 = 3.7065e-04
Loss = 9.2823e-02, PNorm = 35.1416, GNorm = 0.7311, lr_0 = 3.6097e-04
Validation rmse = 0.118480
Validation r2 = 0.870401
Validation mse = 0.014037
Epoch 26
Loss = 8.7242e-02, PNorm = 35.1552, GNorm = 2.4814, lr_0 = 3.5061e-04
Validation rmse = 0.120224
Validation r2 = 0.866558
Validation mse = 0.014454
Epoch 27
Loss = 9.3540e-02, PNorm = 35.1647, GNorm = 0.9651, lr_0 = 3.4055e-04
Loss = 8.3028e-02, PNorm = 35.1746, GNorm = 2.8512, lr_0 = 3.3166e-04
Validation rmse = 0.116460
Validation r2 = 0.874783
Validation mse = 0.013563
Epoch 28
Loss = 8.1943e-02, PNorm = 35.1829, GNorm = 1.0329, lr_0 = 3.2299e-04
Validation rmse = 0.124515
Validation r2 = 0.856861
Validation mse = 0.015504
Epoch 29
Loss = 1.1622e-01, PNorm = 35.1910, GNorm = 4.3165, lr_0 = 3.1373e-04
Loss = 9.0475e-02, PNorm = 35.2000, GNorm = 0.8810, lr_0 = 3.0553e-04
Validation rmse = 0.126016
Validation r2 = 0.853390
Validation mse = 0.015880
Epoch 30
Loss = 1.1370e-01, PNorm = 35.2107, GNorm = 2.6834, lr_0 = 2.9755e-04
Validation rmse = 0.115991
Validation r2 = 0.875790
Validation mse = 0.013454
Epoch 31
Loss = 9.7209e-02, PNorm = 35.2226, GNorm = 0.8909, lr_0 = 2.8901e-04
Loss = 8.1644e-02, PNorm = 35.2283, GNorm = 2.2391, lr_0 = 2.8147e-04
Validation rmse = 0.122497
Validation r2 = 0.861464
Validation mse = 0.015005
Epoch 32
Loss = 8.9276e-02, PNorm = 35.2360, GNorm = 1.9619, lr_0 = 2.7411e-04
Validation rmse = 0.117683
Validation r2 = 0.872139
Validation mse = 0.013849
Epoch 33
Loss = 1.0084e-01, PNorm = 35.2449, GNorm = 1.4350, lr_0 = 2.6625e-04
Loss = 7.7204e-02, PNorm = 35.2531, GNorm = 1.6640, lr_0 = 2.5929e-04
Validation rmse = 0.117271
Validation r2 = 0.873032
Validation mse = 0.013752
Epoch 34
Loss = 8.4686e-02, PNorm = 35.2601, GNorm = 1.8274, lr_0 = 2.5185e-04
Loss = 1.0685e-01, PNorm = 35.2677, GNorm = 3.2819, lr_0 = 2.4528e-04
Validation rmse = 0.113803
Validation r2 = 0.880431
Validation mse = 0.012951
Epoch 35
Loss = 8.5981e-02, PNorm = 35.2759, GNorm = 0.5606, lr_0 = 2.3887e-04
Validation rmse = 0.118991
Validation r2 = 0.869281
Validation mse = 0.014159
Epoch 36
Loss = 6.4974e-02, PNorm = 35.2842, GNorm = 1.6963, lr_0 = 2.3202e-04
Loss = 9.8997e-02, PNorm = 35.2909, GNorm = 0.7133, lr_0 = 2.2596e-04
Validation rmse = 0.115247
Validation r2 = 0.877377
Validation mse = 0.013282
Epoch 37
Loss = 8.0518e-02, PNorm = 35.2979, GNorm = 1.1444, lr_0 = 2.2005e-04
Validation rmse = 0.115004
Validation r2 = 0.877893
Validation mse = 0.013226
Epoch 38
Loss = 6.7357e-02, PNorm = 35.3030, GNorm = 0.4418, lr_0 = 2.1374e-04
Loss = 8.5662e-02, PNorm = 35.3074, GNorm = 1.4613, lr_0 = 2.0816e-04
Validation rmse = 0.113508
Validation r2 = 0.881050
Validation mse = 0.012884
Epoch 39
Loss = 8.1823e-02, PNorm = 35.3140, GNorm = 1.0518, lr_0 = 2.0272e-04
Validation rmse = 0.112695
Validation r2 = 0.882748
Validation mse = 0.012700
Epoch 40
Loss = 7.3937e-02, PNorm = 35.3192, GNorm = 1.2014, lr_0 = 1.9690e-04
Loss = 7.4502e-02, PNorm = 35.3244, GNorm = 1.3861, lr_0 = 1.9176e-04
Validation rmse = 0.114359
Validation r2 = 0.879260
Validation mse = 0.013078
Epoch 41
Loss = 7.1228e-02, PNorm = 35.3288, GNorm = 0.6819, lr_0 = 1.8675e-04
Validation rmse = 0.114761
Validation r2 = 0.878408
Validation mse = 0.013170
Epoch 42
Loss = 5.7772e-02, PNorm = 35.3344, GNorm = 0.8066, lr_0 = 1.8139e-04
Loss = 8.1578e-02, PNorm = 35.3397, GNorm = 0.6646, lr_0 = 1.7666e-04
Validation rmse = 0.113605
Validation r2 = 0.880846
Validation mse = 0.012906
Epoch 43
Loss = 7.4728e-02, PNorm = 35.3467, GNorm = 0.5334, lr_0 = 1.7159e-04
Validation rmse = 0.112756
Validation r2 = 0.882621
Validation mse = 0.012714
Epoch 44
Loss = 6.0110e-02, PNorm = 35.3506, GNorm = 0.6706, lr_0 = 1.6710e-04
Loss = 7.5098e-02, PNorm = 35.3546, GNorm = 1.1046, lr_0 = 1.6274e-04
Validation rmse = 0.112465
Validation r2 = 0.883226
Validation mse = 0.012648
Epoch 45
Loss = 8.3806e-02, PNorm = 35.3591, GNorm = 0.9297, lr_0 = 1.5807e-04
Loss = 7.3805e-02, PNorm = 35.3641, GNorm = 1.4319, lr_0 = 1.5394e-04
Validation rmse = 0.111885
Validation r2 = 0.884428
Validation mse = 0.012518
Epoch 46
Loss = 7.0896e-02, PNorm = 35.3679, GNorm = 1.0122, lr_0 = 1.4992e-04
Validation rmse = 0.115712
Validation r2 = 0.876385
Validation mse = 0.013389
Epoch 47
Loss = 8.6808e-02, PNorm = 35.3717, GNorm = 0.9382, lr_0 = 1.4562e-04
Loss = 7.4711e-02, PNorm = 35.3763, GNorm = 0.5048, lr_0 = 1.4182e-04
Validation rmse = 0.115867
Validation r2 = 0.876055
Validation mse = 0.013425
Epoch 48
Loss = 8.3357e-02, PNorm = 35.3801, GNorm = 1.9402, lr_0 = 1.3811e-04
Validation rmse = 0.112832
Validation r2 = 0.882462
Validation mse = 0.012731
Epoch 49
Loss = 7.4851e-02, PNorm = 35.3843, GNorm = 1.4677, lr_0 = 1.3415e-04
Loss = 7.4693e-02, PNorm = 35.3881, GNorm = 2.4549, lr_0 = 1.3064e-04
Validation rmse = 0.112593
Validation r2 = 0.882961
Validation mse = 0.012677
Epoch 50
Loss = 7.2264e-02, PNorm = 35.3915, GNorm = 0.5205, lr_0 = 1.2723e-04
Validation rmse = 0.112797
Validation r2 = 0.882536
Validation mse = 0.012723
Epoch 51
Loss = 6.4156e-02, PNorm = 35.3955, GNorm = 0.8311, lr_0 = 1.2358e-04
Loss = 7.8930e-02, PNorm = 35.3976, GNorm = 1.2771, lr_0 = 1.2035e-04
Validation rmse = 0.112640
Validation r2 = 0.882861
Validation mse = 0.012688
Epoch 52
Loss = 6.5546e-02, PNorm = 35.4014, GNorm = 0.7629, lr_0 = 1.1690e-04
Validation rmse = 0.112862
Validation r2 = 0.882399
Validation mse = 0.012738
Epoch 53
Loss = 5.6659e-02, PNorm = 35.4050, GNorm = 0.5020, lr_0 = 1.1385e-04
Loss = 7.5106e-02, PNorm = 35.4083, GNorm = 1.7744, lr_0 = 1.1087e-04
Validation rmse = 0.111346
Validation r2 = 0.885538
Validation mse = 0.012398
Epoch 54
Loss = 7.0822e-02, PNorm = 35.4115, GNorm = 1.0054, lr_0 = 1.0769e-04
Validation rmse = 0.111123
Validation r2 = 0.885995
Validation mse = 0.012348
Epoch 55
Loss = 5.5952e-02, PNorm = 35.4146, GNorm = 1.0066, lr_0 = 1.0488e-04
Loss = 7.1270e-02, PNorm = 35.4181, GNorm = 0.5582, lr_0 = 1.0214e-04
Validation rmse = 0.111302
Validation r2 = 0.885629
Validation mse = 0.012388
Epoch 56
Loss = 6.9351e-02, PNorm = 35.4208, GNorm = 2.7150, lr_0 = 1.0000e-04
Loss = 7.6474e-02, PNorm = 35.4237, GNorm = 2.1397, lr_0 = 1.0000e-04
Validation rmse = 0.111125
Validation r2 = 0.885992
Validation mse = 0.012349
Epoch 57
Loss = 8.3000e-02, PNorm = 35.4259, GNorm = 1.3714, lr_0 = 1.0000e-04
Validation rmse = 0.111162
Validation r2 = 0.885915
Validation mse = 0.012357
Epoch 58
Loss = 6.7866e-02, PNorm = 35.4290, GNorm = 1.6494, lr_0 = 1.0000e-04
Loss = 7.3362e-02, PNorm = 35.4326, GNorm = 1.2036, lr_0 = 1.0000e-04
Loss = 7.6609e-02, PNorm = 35.4329, GNorm = 1.3778, lr_0 = 1.0000e-04
Validation rmse = 0.111237
Validation r2 = 0.885763
Validation mse = 0.012374
Epoch 59
Loss = 7.3899e-02, PNorm = 35.4358, GNorm = 0.9188, lr_0 = 1.0000e-04
Validation rmse = 0.110970
Validation r2 = 0.886309
Validation mse = 0.012314
Model 0 best validation rmse = 0.110970 on epoch 59
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.217614
Model 0 test r2 = 0.569626
Model 0 test mse = 0.047356
Ensemble test rmse = 0.217614
Ensemble test r2 = 0.569626
Ensemble test mse = 0.047356
Fold 7
Splitting data with seed 7
Total size = 965 | train size = 772 | val size = 193 | test size = 57
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1754e-01, PNorm = 34.0165, GNorm = 3.8312, lr_0 = 4.3000e-04
Validation rmse = 0.291040
Validation r2 = 0.290037
Validation mse = 0.084704
Epoch 1
Loss = 6.1064e-01, PNorm = 34.0456, GNorm = 3.8503, lr_0 = 7.6000e-04
Loss = 6.1733e-01, PNorm = 34.1069, GNorm = 2.8683, lr_0 = 9.9472e-04
Loss = 6.1189e-01, PNorm = 34.1154, GNorm = 7.2396, lr_0 = 9.9209e-04
Validation rmse = 0.251887
Validation r2 = 0.468205
Validation mse = 0.063447
Epoch 2
Loss = 5.2490e-01, PNorm = 34.1930, GNorm = 12.9416, lr_0 = 9.6618e-04
Validation rmse = 0.295174
Validation r2 = 0.269724
Validation mse = 0.087128
Epoch 3
Loss = 5.6647e-01, PNorm = 34.2490, GNorm = 1.9372, lr_0 = 9.4094e-04
Loss = 4.8638e-01, PNorm = 34.3053, GNorm = 5.5082, lr_0 = 9.1637e-04
Validation rmse = 0.200029
Validation r2 = 0.664636
Validation mse = 0.040012
Epoch 4
Loss = 2.9814e-01, PNorm = 34.3727, GNorm = 1.1872, lr_0 = 8.9007e-04
Validation rmse = 0.200404
Validation r2 = 0.663378
Validation mse = 0.040162
Epoch 5
Loss = 2.7550e-01, PNorm = 34.4256, GNorm = 3.3145, lr_0 = 8.6682e-04
Loss = 3.0795e-01, PNorm = 34.4777, GNorm = 2.1986, lr_0 = 8.4418e-04
Validation rmse = 0.163129
Validation r2 = 0.776954
Validation mse = 0.026611
Epoch 6
Loss = 2.5380e-01, PNorm = 34.5305, GNorm = 1.3410, lr_0 = 8.1996e-04
Validation rmse = 0.157069
Validation r2 = 0.793218
Validation mse = 0.024671
Epoch 7
Loss = 2.1550e-01, PNorm = 34.5783, GNorm = 2.6184, lr_0 = 7.9854e-04
Loss = 1.7403e-01, PNorm = 34.6196, GNorm = 1.7390, lr_0 = 7.7769e-04
Validation rmse = 0.170262
Validation r2 = 0.757022
Validation mse = 0.028989
Epoch 8
Loss = 2.0353e-01, PNorm = 34.6674, GNorm = 2.2086, lr_0 = 7.5537e-04
Validation rmse = 0.151389
Validation r2 = 0.807904
Validation mse = 0.022919
Epoch 9
Loss = 1.3479e-01, PNorm = 34.7093, GNorm = 1.9517, lr_0 = 7.3370e-04
Loss = 1.7806e-01, PNorm = 34.7407, GNorm = 2.6610, lr_0 = 7.1453e-04
Validation rmse = 0.140261
Validation r2 = 0.835106
Validation mse = 0.019673
Epoch 10
Loss = 1.2673e-01, PNorm = 34.7712, GNorm = 2.2732, lr_0 = 6.9587e-04
Validation rmse = 0.143849
Validation r2 = 0.826561
Validation mse = 0.020693
Epoch 11
Loss = 1.3969e-01, PNorm = 34.8044, GNorm = 1.3168, lr_0 = 6.7590e-04
Loss = 1.3925e-01, PNorm = 34.8263, GNorm = 6.2641, lr_0 = 6.5825e-04
Validation rmse = 0.143712
Validation r2 = 0.826893
Validation mse = 0.020653
Epoch 12
Loss = 1.2353e-01, PNorm = 34.8511, GNorm = 0.7373, lr_0 = 6.4106e-04
Loss = 1.2278e-01, PNorm = 34.8787, GNorm = 1.5310, lr_0 = 6.2431e-04
Loss = 1.1572e-01, PNorm = 34.8806, GNorm = 1.4130, lr_0 = 6.2266e-04
Validation rmse = 0.138457
Validation r2 = 0.839320
Validation mse = 0.019170
Epoch 13
Loss = 1.2753e-01, PNorm = 34.9015, GNorm = 2.1304, lr_0 = 6.0640e-04
Validation rmse = 0.138356
Validation r2 = 0.839555
Validation mse = 0.019142
Epoch 14
Loss = 1.0651e-01, PNorm = 34.9213, GNorm = 1.4865, lr_0 = 5.9056e-04
Loss = 1.0968e-01, PNorm = 34.9416, GNorm = 3.1995, lr_0 = 5.7514e-04
Validation rmse = 0.134411
Validation r2 = 0.848574
Validation mse = 0.018066
Epoch 15
Loss = 1.0602e-01, PNorm = 34.9598, GNorm = 1.8220, lr_0 = 5.5863e-04
Validation rmse = 0.135506
Validation r2 = 0.846097
Validation mse = 0.018362
Epoch 16
Loss = 1.2019e-01, PNorm = 34.9769, GNorm = 3.3048, lr_0 = 5.4404e-04
Loss = 1.0670e-01, PNorm = 34.9939, GNorm = 1.6932, lr_0 = 5.2983e-04
Validation rmse = 0.137580
Validation r2 = 0.841350
Validation mse = 0.018928
Epoch 17
Loss = 1.1774e-01, PNorm = 35.0131, GNorm = 4.4941, lr_0 = 5.1463e-04
Validation rmse = 0.138318
Validation r2 = 0.839642
Validation mse = 0.019132
Epoch 18
Loss = 9.6173e-02, PNorm = 35.0278, GNorm = 3.1779, lr_0 = 4.9986e-04
Loss = 9.8237e-02, PNorm = 35.0415, GNorm = 1.9868, lr_0 = 4.8681e-04
Validation rmse = 0.138174
Validation r2 = 0.839977
Validation mse = 0.019092
Epoch 19
Loss = 9.6683e-02, PNorm = 35.0549, GNorm = 1.0464, lr_0 = 4.7409e-04
Validation rmse = 0.143313
Validation r2 = 0.827853
Validation mse = 0.020539
Epoch 20
Loss = 8.2460e-02, PNorm = 35.0727, GNorm = 0.8868, lr_0 = 4.6049e-04
Loss = 1.1825e-01, PNorm = 35.0850, GNorm = 2.7621, lr_0 = 4.4846e-04
Validation rmse = 0.135342
Validation r2 = 0.846470
Validation mse = 0.018317
Epoch 21
Loss = 8.1178e-02, PNorm = 35.0996, GNorm = 0.5816, lr_0 = 4.3675e-04
Validation rmse = 0.135453
Validation r2 = 0.846216
Validation mse = 0.018348
Epoch 22
Loss = 7.2231e-02, PNorm = 35.1138, GNorm = 0.9764, lr_0 = 4.2422e-04
Loss = 9.1475e-02, PNorm = 35.1266, GNorm = 1.2591, lr_0 = 4.1313e-04
Validation rmse = 0.133362
Validation r2 = 0.850929
Validation mse = 0.017785
Epoch 23
Loss = 1.0125e-01, PNorm = 35.1408, GNorm = 4.1699, lr_0 = 4.0234e-04
Loss = 9.4348e-02, PNorm = 35.1529, GNorm = 1.7911, lr_0 = 3.9184e-04
Loss = 1.4505e-01, PNorm = 35.1543, GNorm = 6.3131, lr_0 = 3.9080e-04
Validation rmse = 0.144578
Validation r2 = 0.824798
Validation mse = 0.020903
Epoch 24
Loss = 9.7654e-02, PNorm = 35.1655, GNorm = 1.2506, lr_0 = 3.8059e-04
Validation rmse = 0.142938
Validation r2 = 0.828752
Validation mse = 0.020431
Epoch 25
Loss = 8.2872e-02, PNorm = 35.1767, GNorm = 0.4122, lr_0 = 3.7065e-04
Loss = 1.1498e-01, PNorm = 35.1887, GNorm = 5.1387, lr_0 = 3.6097e-04
Validation rmse = 0.134043
Validation r2 = 0.849402
Validation mse = 0.017968
Epoch 26
Loss = 1.0232e-01, PNorm = 35.2024, GNorm = 0.7646, lr_0 = 3.5061e-04
Validation rmse = 0.133071
Validation r2 = 0.851579
Validation mse = 0.017708
Epoch 27
Loss = 7.5956e-02, PNorm = 35.2174, GNorm = 0.5156, lr_0 = 3.4055e-04
Loss = 8.6191e-02, PNorm = 35.2283, GNorm = 0.5957, lr_0 = 3.3166e-04
Validation rmse = 0.139116
Validation r2 = 0.837787
Validation mse = 0.019353
Epoch 28
Loss = 7.5429e-02, PNorm = 35.2358, GNorm = 1.3315, lr_0 = 3.2299e-04
Validation rmse = 0.138333
Validation r2 = 0.839608
Validation mse = 0.019136
Epoch 29
Loss = 8.9060e-02, PNorm = 35.2465, GNorm = 1.4171, lr_0 = 3.1373e-04
Loss = 7.8796e-02, PNorm = 35.2559, GNorm = 1.2493, lr_0 = 3.0553e-04
Validation rmse = 0.141861
Validation r2 = 0.831323
Validation mse = 0.020124
Epoch 30
Loss = 7.2944e-02, PNorm = 35.2645, GNorm = 1.9422, lr_0 = 2.9755e-04
Validation rmse = 0.134654
Validation r2 = 0.848026
Validation mse = 0.018132
Epoch 31
Loss = 6.2847e-02, PNorm = 35.2747, GNorm = 0.6869, lr_0 = 2.8901e-04
Loss = 8.2286e-02, PNorm = 35.2836, GNorm = 2.8892, lr_0 = 2.8147e-04
Validation rmse = 0.133535
Validation r2 = 0.850542
Validation mse = 0.017831
Epoch 32
Loss = 7.4157e-02, PNorm = 35.2931, GNorm = 0.4684, lr_0 = 2.7411e-04
Validation rmse = 0.140555
Validation r2 = 0.834415
Validation mse = 0.019756
Epoch 33
Loss = 1.3554e-01, PNorm = 35.3023, GNorm = 3.8870, lr_0 = 2.6625e-04
Loss = 8.7636e-02, PNorm = 35.3114, GNorm = 2.4032, lr_0 = 2.5929e-04
Validation rmse = 0.134402
Validation r2 = 0.848593
Validation mse = 0.018064
Epoch 34
Loss = 8.1250e-02, PNorm = 35.3208, GNorm = 0.6266, lr_0 = 2.5185e-04
Loss = 7.9912e-02, PNorm = 35.3291, GNorm = 2.6562, lr_0 = 2.4528e-04
Validation rmse = 0.134693
Validation r2 = 0.847937
Validation mse = 0.018142
Epoch 35
Loss = 7.7429e-02, PNorm = 35.3366, GNorm = 0.6075, lr_0 = 2.3887e-04
Validation rmse = 0.137616
Validation r2 = 0.841265
Validation mse = 0.018938
Epoch 36
Loss = 7.1874e-02, PNorm = 35.3445, GNorm = 0.3846, lr_0 = 2.3202e-04
Loss = 7.9593e-02, PNorm = 35.3513, GNorm = 1.4609, lr_0 = 2.2596e-04
Validation rmse = 0.135271
Validation r2 = 0.846630
Validation mse = 0.018298
Epoch 37
Loss = 6.8905e-02, PNorm = 35.3584, GNorm = 1.0687, lr_0 = 2.2005e-04
Validation rmse = 0.133785
Validation r2 = 0.849982
Validation mse = 0.017898
Epoch 38
Loss = 6.0079e-02, PNorm = 35.3672, GNorm = 0.6409, lr_0 = 2.1374e-04
Loss = 8.0435e-02, PNorm = 35.3741, GNorm = 3.9755, lr_0 = 2.0816e-04
Validation rmse = 0.138309
Validation r2 = 0.839664
Validation mse = 0.019129
Epoch 39
Loss = 6.5887e-02, PNorm = 35.3810, GNorm = 1.4126, lr_0 = 2.0272e-04
Validation rmse = 0.134234
Validation r2 = 0.848972
Validation mse = 0.018019
Epoch 40
Loss = 8.4007e-02, PNorm = 35.3881, GNorm = 1.3691, lr_0 = 1.9690e-04
Loss = 6.9282e-02, PNorm = 35.3941, GNorm = 2.1731, lr_0 = 1.9176e-04
Validation rmse = 0.135943
Validation r2 = 0.845101
Validation mse = 0.018481
Epoch 41
Loss = 8.2658e-02, PNorm = 35.4004, GNorm = 1.5739, lr_0 = 1.8675e-04
Validation rmse = 0.135957
Validation r2 = 0.845070
Validation mse = 0.018484
Epoch 42
Loss = 6.6177e-02, PNorm = 35.4062, GNorm = 0.5550, lr_0 = 1.8139e-04
Loss = 7.6618e-02, PNorm = 35.4125, GNorm = 2.9908, lr_0 = 1.7666e-04
Validation rmse = 0.135551
Validation r2 = 0.845995
Validation mse = 0.018374
Epoch 43
Loss = 5.6190e-02, PNorm = 35.4168, GNorm = 0.8844, lr_0 = 1.7159e-04
Validation rmse = 0.133599
Validation r2 = 0.850397
Validation mse = 0.017849
Epoch 44
Loss = 7.7075e-02, PNorm = 35.4224, GNorm = 0.9284, lr_0 = 1.6710e-04
Loss = 6.5948e-02, PNorm = 35.4285, GNorm = 1.2624, lr_0 = 1.6274e-04
Validation rmse = 0.136515
Validation r2 = 0.843797
Validation mse = 0.018636
Epoch 45
Loss = 7.1210e-02, PNorm = 35.4333, GNorm = 0.6681, lr_0 = 1.5807e-04
Loss = 6.6203e-02, PNorm = 35.4381, GNorm = 0.5094, lr_0 = 1.5394e-04
Validation rmse = 0.134700
Validation r2 = 0.847923
Validation mse = 0.018144
Epoch 46
Loss = 6.8868e-02, PNorm = 35.4426, GNorm = 0.8627, lr_0 = 1.4992e-04
Validation rmse = 0.136493
Validation r2 = 0.843846
Validation mse = 0.018630
Epoch 47
Loss = 7.1059e-02, PNorm = 35.4475, GNorm = 0.6472, lr_0 = 1.4562e-04
Loss = 6.7267e-02, PNorm = 35.4514, GNorm = 0.6876, lr_0 = 1.4182e-04
Validation rmse = 0.136073
Validation r2 = 0.844806
Validation mse = 0.018516
Epoch 48
Loss = 6.7764e-02, PNorm = 35.4553, GNorm = 0.9936, lr_0 = 1.3811e-04
Validation rmse = 0.135459
Validation r2 = 0.846203
Validation mse = 0.018349
Epoch 49
Loss = 4.3877e-02, PNorm = 35.4615, GNorm = 1.3631, lr_0 = 1.3415e-04
Loss = 7.4398e-02, PNorm = 35.4652, GNorm = 0.6571, lr_0 = 1.3064e-04
Validation rmse = 0.136448
Validation r2 = 0.843950
Validation mse = 0.018618
Epoch 50
Loss = 6.7312e-02, PNorm = 35.4695, GNorm = 1.6771, lr_0 = 1.2723e-04
Validation rmse = 0.137615
Validation r2 = 0.841269
Validation mse = 0.018938
Epoch 51
Loss = 1.0446e-01, PNorm = 35.4751, GNorm = 4.4203, lr_0 = 1.2358e-04
Loss = 6.6773e-02, PNorm = 35.4782, GNorm = 0.3885, lr_0 = 1.2035e-04
Validation rmse = 0.138096
Validation r2 = 0.840157
Validation mse = 0.019071
Epoch 52
Loss = 6.8588e-02, PNorm = 35.4812, GNorm = 1.2435, lr_0 = 1.1690e-04
Validation rmse = 0.135746
Validation r2 = 0.845551
Validation mse = 0.018427
Epoch 53
Loss = 5.2517e-02, PNorm = 35.4852, GNorm = 0.8209, lr_0 = 1.1385e-04
Loss = 6.7641e-02, PNorm = 35.4888, GNorm = 2.8454, lr_0 = 1.1087e-04
Validation rmse = 0.137417
Validation r2 = 0.841724
Validation mse = 0.018883
Epoch 54
Loss = 6.3460e-02, PNorm = 35.4921, GNorm = 1.6654, lr_0 = 1.0769e-04
Validation rmse = 0.135320
Validation r2 = 0.846520
Validation mse = 0.018311
Epoch 55
Loss = 6.1108e-02, PNorm = 35.4958, GNorm = 0.7130, lr_0 = 1.0488e-04
Loss = 6.8687e-02, PNorm = 35.4991, GNorm = 0.6902, lr_0 = 1.0214e-04
Validation rmse = 0.135855
Validation r2 = 0.845304
Validation mse = 0.018456
Epoch 56
Loss = 7.6693e-02, PNorm = 35.5019, GNorm = 0.6068, lr_0 = 1.0000e-04
Loss = 5.8444e-02, PNorm = 35.5053, GNorm = 1.1203, lr_0 = 1.0000e-04
Validation rmse = 0.135292
Validation r2 = 0.846583
Validation mse = 0.018304
Epoch 57
Loss = 6.7744e-02, PNorm = 35.5083, GNorm = 0.4346, lr_0 = 1.0000e-04
Validation rmse = 0.135849
Validation r2 = 0.845316
Validation mse = 0.018455
Epoch 58
Loss = 6.5470e-02, PNorm = 35.5111, GNorm = 0.9202, lr_0 = 1.0000e-04
Loss = 6.3781e-02, PNorm = 35.5141, GNorm = 1.4526, lr_0 = 1.0000e-04
Loss = 5.5996e-02, PNorm = 35.5144, GNorm = 1.3952, lr_0 = 1.0000e-04
Validation rmse = 0.136483
Validation r2 = 0.843869
Validation mse = 0.018628
Epoch 59
Loss = 6.2504e-02, PNorm = 35.5174, GNorm = 1.1105, lr_0 = 1.0000e-04
Validation rmse = 0.135966
Validation r2 = 0.845051
Validation mse = 0.018487
Model 0 best validation rmse = 0.133071 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.209081
Model 0 test r2 = 0.602718
Model 0 test mse = 0.043715
Ensemble test rmse = 0.209081
Ensemble test r2 = 0.602718
Ensemble test mse = 0.043715
Fold 8
Splitting data with seed 8
Total size = 965 | train size = 772 | val size = 193 | test size = 57
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.2119e-01, PNorm = 34.0195, GNorm = 3.3529, lr_0 = 4.3000e-04
Validation rmse = 0.288257
Validation r2 = 0.205630
Validation mse = 0.083092
Epoch 1
Loss = 6.1416e-01, PNorm = 34.0584, GNorm = 1.0711, lr_0 = 7.6000e-04
Loss = 5.2740e-01, PNorm = 34.1180, GNorm = 3.1512, lr_0 = 9.9472e-04
Loss = 5.6030e-01, PNorm = 34.1253, GNorm = 3.2649, lr_0 = 9.9209e-04
Validation rmse = 0.242882
Validation r2 = 0.436033
Validation mse = 0.058992
Epoch 2
Loss = 4.0867e-01, PNorm = 34.1949, GNorm = 1.3649, lr_0 = 9.6618e-04
Validation rmse = 0.236278
Validation r2 = 0.466286
Validation mse = 0.055827
Epoch 3
Loss = 2.7056e-01, PNorm = 34.2687, GNorm = 2.2064, lr_0 = 9.4094e-04
Loss = 3.1713e-01, PNorm = 34.3265, GNorm = 3.8514, lr_0 = 9.1637e-04
Validation rmse = 0.192620
Validation r2 = 0.645296
Validation mse = 0.037103
Epoch 4
Loss = 2.4079e-01, PNorm = 34.3932, GNorm = 0.8282, lr_0 = 8.9007e-04
Validation rmse = 0.197448
Validation r2 = 0.627294
Validation mse = 0.038986
Epoch 5
Loss = 1.8743e-01, PNorm = 34.4434, GNorm = 9.2031, lr_0 = 8.6682e-04
Loss = 2.4599e-01, PNorm = 34.4849, GNorm = 5.0217, lr_0 = 8.4418e-04
Validation rmse = 0.196347
Validation r2 = 0.631438
Validation mse = 0.038552
Epoch 6
Loss = 2.0940e-01, PNorm = 34.5321, GNorm = 2.0272, lr_0 = 8.1996e-04
Validation rmse = 0.197315
Validation r2 = 0.627796
Validation mse = 0.038933
Epoch 7
Loss = 2.3108e-01, PNorm = 34.5725, GNorm = 0.6580, lr_0 = 7.9854e-04
Loss = 1.6721e-01, PNorm = 34.6032, GNorm = 3.2064, lr_0 = 7.7769e-04
Validation rmse = 0.175557
Validation r2 = 0.705357
Validation mse = 0.030820
Epoch 8
Loss = 1.4414e-01, PNorm = 34.6415, GNorm = 4.3539, lr_0 = 7.5537e-04
Validation rmse = 0.155225
Validation r2 = 0.769651
Validation mse = 0.024095
Epoch 9
Loss = 1.6005e-01, PNorm = 34.6744, GNorm = 3.8844, lr_0 = 7.3370e-04
Loss = 1.3726e-01, PNorm = 34.7014, GNorm = 3.9001, lr_0 = 7.1453e-04
Validation rmse = 0.153883
Validation r2 = 0.773616
Validation mse = 0.023680
Epoch 10
Loss = 1.2979e-01, PNorm = 34.7279, GNorm = 0.9694, lr_0 = 6.9587e-04
Validation rmse = 0.164434
Validation r2 = 0.741508
Validation mse = 0.027039
Epoch 11
Loss = 1.1133e-01, PNorm = 34.7533, GNorm = 2.4618, lr_0 = 6.7590e-04
Loss = 1.1240e-01, PNorm = 34.7751, GNorm = 0.8067, lr_0 = 6.5825e-04
Validation rmse = 0.148784
Validation r2 = 0.788372
Validation mse = 0.022137
Epoch 12
Loss = 1.1096e-01, PNorm = 34.7973, GNorm = 0.6167, lr_0 = 6.4106e-04
Loss = 1.1773e-01, PNorm = 34.8116, GNorm = 0.9996, lr_0 = 6.2431e-04
Loss = 1.4617e-01, PNorm = 34.8135, GNorm = 4.4026, lr_0 = 6.2266e-04
Validation rmse = 0.173682
Validation r2 = 0.711614
Validation mse = 0.030166
Epoch 13
Loss = 1.4924e-01, PNorm = 34.8347, GNorm = 5.6969, lr_0 = 6.0640e-04
Validation rmse = 0.144867
Validation r2 = 0.799367
Validation mse = 0.020986
Epoch 14
Loss = 1.0329e-01, PNorm = 34.8522, GNorm = 1.0080, lr_0 = 5.9056e-04
Loss = 1.1911e-01, PNorm = 34.8688, GNorm = 0.8835, lr_0 = 5.7514e-04
Validation rmse = 0.151067
Validation r2 = 0.781828
Validation mse = 0.022821
Epoch 15
Loss = 1.3342e-01, PNorm = 34.8849, GNorm = 5.0144, lr_0 = 5.5863e-04
Validation rmse = 0.159824
Validation r2 = 0.755800
Validation mse = 0.025544
Epoch 16
Loss = 1.2510e-01, PNorm = 34.9014, GNorm = 2.1663, lr_0 = 5.4404e-04
Loss = 1.0861e-01, PNorm = 34.9133, GNorm = 1.6690, lr_0 = 5.2983e-04
Validation rmse = 0.146255
Validation r2 = 0.795505
Validation mse = 0.021390
Epoch 17
Loss = 1.0739e-01, PNorm = 34.9315, GNorm = 1.0792, lr_0 = 5.1463e-04
Validation rmse = 0.143960
Validation r2 = 0.801873
Validation mse = 0.020724
Epoch 18
Loss = 1.3761e-01, PNorm = 34.9430, GNorm = 2.8916, lr_0 = 4.9986e-04
Loss = 1.0880e-01, PNorm = 34.9549, GNorm = 0.9543, lr_0 = 4.8681e-04
Validation rmse = 0.149600
Validation r2 = 0.786043
Validation mse = 0.022380
Epoch 19
Loss = 1.0099e-01, PNorm = 34.9632, GNorm = 1.0362, lr_0 = 4.7409e-04
Validation rmse = 0.151331
Validation r2 = 0.781062
Validation mse = 0.022901
Epoch 20
Loss = 8.2620e-02, PNorm = 34.9778, GNorm = 1.0660, lr_0 = 4.6049e-04
Loss = 1.0655e-01, PNorm = 34.9878, GNorm = 4.6450, lr_0 = 4.4846e-04
Validation rmse = 0.144192
Validation r2 = 0.801232
Validation mse = 0.020791
Epoch 21
Loss = 9.7897e-02, PNorm = 34.9991, GNorm = 0.5312, lr_0 = 4.3675e-04
Validation rmse = 0.148869
Validation r2 = 0.788129
Validation mse = 0.022162
Epoch 22
Loss = 1.3348e-01, PNorm = 35.0098, GNorm = 2.4741, lr_0 = 4.2422e-04
Loss = 8.4292e-02, PNorm = 35.0202, GNorm = 0.8344, lr_0 = 4.1313e-04
Validation rmse = 0.147180
Validation r2 = 0.792909
Validation mse = 0.021662
Epoch 23
Loss = 1.0153e-01, PNorm = 35.0282, GNorm = 0.9474, lr_0 = 4.0234e-04
Loss = 9.1407e-02, PNorm = 35.0400, GNorm = 1.5050, lr_0 = 3.9184e-04
Loss = 1.0638e-01, PNorm = 35.0414, GNorm = 0.7066, lr_0 = 3.9080e-04
Validation rmse = 0.146080
Validation r2 = 0.795993
Validation mse = 0.021339
Epoch 24
Loss = 1.0771e-01, PNorm = 35.0496, GNorm = 3.3106, lr_0 = 3.8059e-04
Validation rmse = 0.146643
Validation r2 = 0.794419
Validation mse = 0.021504
Epoch 25
Loss = 9.1638e-02, PNorm = 35.0612, GNorm = 0.6114, lr_0 = 3.7065e-04
Loss = 9.2980e-02, PNorm = 35.0685, GNorm = 0.8758, lr_0 = 3.6097e-04
Validation rmse = 0.143992
Validation r2 = 0.801785
Validation mse = 0.020734
Epoch 26
Loss = 9.2814e-02, PNorm = 35.0802, GNorm = 2.0280, lr_0 = 3.5061e-04
Validation rmse = 0.172961
Validation r2 = 0.714003
Validation mse = 0.029916
Epoch 27
Loss = 1.0254e-01, PNorm = 35.0896, GNorm = 0.6196, lr_0 = 3.4055e-04
Loss = 9.4461e-02, PNorm = 35.0984, GNorm = 2.5783, lr_0 = 3.3166e-04
Validation rmse = 0.148096
Validation r2 = 0.790325
Validation mse = 0.021932
Epoch 28
Loss = 8.3126e-02, PNorm = 35.1094, GNorm = 0.7960, lr_0 = 3.2299e-04
Validation rmse = 0.143021
Validation r2 = 0.804448
Validation mse = 0.020455
Epoch 29
Loss = 1.2970e-01, PNorm = 35.1182, GNorm = 2.7736, lr_0 = 3.1373e-04
Loss = 7.8220e-02, PNorm = 35.1262, GNorm = 1.5885, lr_0 = 3.0553e-04
Validation rmse = 0.148110
Validation r2 = 0.790284
Validation mse = 0.021937
Epoch 30
Loss = 8.6589e-02, PNorm = 35.1342, GNorm = 1.2265, lr_0 = 2.9755e-04
Validation rmse = 0.154308
Validation r2 = 0.772364
Validation mse = 0.023811
Epoch 31
Loss = 6.8183e-02, PNorm = 35.1423, GNorm = 0.8460, lr_0 = 2.8901e-04
Loss = 7.8272e-02, PNorm = 35.1493, GNorm = 0.5718, lr_0 = 2.8147e-04
Validation rmse = 0.142549
Validation r2 = 0.805736
Validation mse = 0.020320
Epoch 32
Loss = 8.4905e-02, PNorm = 35.1575, GNorm = 2.1612, lr_0 = 2.7411e-04
Validation rmse = 0.148848
Validation r2 = 0.788188
Validation mse = 0.022156
Epoch 33
Loss = 5.3600e-02, PNorm = 35.1637, GNorm = 1.9320, lr_0 = 2.6625e-04
Loss = 8.7661e-02, PNorm = 35.1709, GNorm = 1.1961, lr_0 = 2.5929e-04
Validation rmse = 0.141883
Validation r2 = 0.807547
Validation mse = 0.020131
Epoch 34
Loss = 7.5811e-02, PNorm = 35.1777, GNorm = 0.7666, lr_0 = 2.5185e-04
Loss = 8.0433e-02, PNorm = 35.1845, GNorm = 1.1280, lr_0 = 2.4528e-04
Validation rmse = 0.153948
Validation r2 = 0.773426
Validation mse = 0.023700
Epoch 35
Loss = 7.9686e-02, PNorm = 35.1907, GNorm = 0.4931, lr_0 = 2.3887e-04
Validation rmse = 0.147497
Validation r2 = 0.792017
Validation mse = 0.021755
Epoch 36
Loss = 7.2094e-02, PNorm = 35.1976, GNorm = 1.4001, lr_0 = 2.3202e-04
Loss = 8.7336e-02, PNorm = 35.2029, GNorm = 1.0527, lr_0 = 2.2596e-04
Validation rmse = 0.141088
Validation r2 = 0.809698
Validation mse = 0.019906
Epoch 37
Loss = 8.3452e-02, PNorm = 35.2101, GNorm = 0.9336, lr_0 = 2.2005e-04
Validation rmse = 0.156721
Validation r2 = 0.765190
Validation mse = 0.024561
Epoch 38
Loss = 7.6765e-02, PNorm = 35.2164, GNorm = 1.1993, lr_0 = 2.1374e-04
Loss = 8.0347e-02, PNorm = 35.2225, GNorm = 1.1378, lr_0 = 2.0816e-04
Validation rmse = 0.142214
Validation r2 = 0.806649
Validation mse = 0.020225
Epoch 39
Loss = 7.7265e-02, PNorm = 35.2297, GNorm = 2.3733, lr_0 = 2.0272e-04
Validation rmse = 0.144647
Validation r2 = 0.799976
Validation mse = 0.020923
Epoch 40
Loss = 7.0058e-02, PNorm = 35.2371, GNorm = 0.5624, lr_0 = 1.9690e-04
Loss = 7.6305e-02, PNorm = 35.2432, GNorm = 1.2285, lr_0 = 1.9176e-04
Validation rmse = 0.149161
Validation r2 = 0.787296
Validation mse = 0.022249
Epoch 41
Loss = 7.5154e-02, PNorm = 35.2475, GNorm = 1.1377, lr_0 = 1.8675e-04
Validation rmse = 0.144275
Validation r2 = 0.801003
Validation mse = 0.020815
Epoch 42
Loss = 6.9823e-02, PNorm = 35.2537, GNorm = 2.5854, lr_0 = 1.8139e-04
Loss = 8.2065e-02, PNorm = 35.2580, GNorm = 2.1604, lr_0 = 1.7666e-04
Validation rmse = 0.141339
Validation r2 = 0.809021
Validation mse = 0.019977
Epoch 43
Loss = 7.4012e-02, PNorm = 35.2627, GNorm = 0.8699, lr_0 = 1.7159e-04
Validation rmse = 0.157758
Validation r2 = 0.762071
Validation mse = 0.024888
Epoch 44
Loss = 8.1373e-02, PNorm = 35.2679, GNorm = 2.4617, lr_0 = 1.6710e-04
Loss = 7.8069e-02, PNorm = 35.2717, GNorm = 3.8548, lr_0 = 1.6274e-04
Validation rmse = 0.141978
Validation r2 = 0.807290
Validation mse = 0.020158
Epoch 45
Loss = 7.8076e-02, PNorm = 35.2771, GNorm = 3.0405, lr_0 = 1.5807e-04
Loss = 7.5540e-02, PNorm = 35.2817, GNorm = 3.7541, lr_0 = 1.5394e-04
Validation rmse = 0.153084
Validation r2 = 0.775962
Validation mse = 0.023435
Epoch 46
Loss = 7.5301e-02, PNorm = 35.2867, GNorm = 0.8370, lr_0 = 1.4992e-04
Validation rmse = 0.142110
Validation r2 = 0.806931
Validation mse = 0.020195
Epoch 47
Loss = 7.9914e-02, PNorm = 35.2916, GNorm = 0.7251, lr_0 = 1.4562e-04
Loss = 7.0432e-02, PNorm = 35.2952, GNorm = 1.6940, lr_0 = 1.4182e-04
Validation rmse = 0.150417
Validation r2 = 0.783701
Validation mse = 0.022625
Epoch 48
Loss = 7.4761e-02, PNorm = 35.2999, GNorm = 2.4697, lr_0 = 1.3811e-04
Validation rmse = 0.145088
Validation r2 = 0.798754
Validation mse = 0.021051
Epoch 49
Loss = 7.9910e-02, PNorm = 35.3045, GNorm = 2.1256, lr_0 = 1.3415e-04
Loss = 7.3759e-02, PNorm = 35.3082, GNorm = 0.9625, lr_0 = 1.3064e-04
Validation rmse = 0.142476
Validation r2 = 0.805937
Validation mse = 0.020299
Epoch 50
Loss = 7.9679e-02, PNorm = 35.3114, GNorm = 1.8277, lr_0 = 1.2723e-04
Validation rmse = 0.140785
Validation r2 = 0.810516
Validation mse = 0.019820
Epoch 51
Loss = 7.2780e-02, PNorm = 35.3153, GNorm = 0.4252, lr_0 = 1.2358e-04
Loss = 6.9742e-02, PNorm = 35.3190, GNorm = 3.6468, lr_0 = 1.2035e-04
Validation rmse = 0.152573
Validation r2 = 0.777456
Validation mse = 0.023278
Epoch 52
Loss = 7.3922e-02, PNorm = 35.3231, GNorm = 0.8986, lr_0 = 1.1690e-04
Validation rmse = 0.149060
Validation r2 = 0.787586
Validation mse = 0.022219
Epoch 53
Loss = 6.4197e-02, PNorm = 35.3263, GNorm = 0.7832, lr_0 = 1.1385e-04
Loss = 6.9994e-02, PNorm = 35.3295, GNorm = 0.6723, lr_0 = 1.1087e-04
Validation rmse = 0.147284
Validation r2 = 0.792617
Validation mse = 0.021693
Epoch 54
Loss = 7.6789e-02, PNorm = 35.3333, GNorm = 1.7569, lr_0 = 1.0769e-04
Validation rmse = 0.140204
Validation r2 = 0.812076
Validation mse = 0.019657
Epoch 55
Loss = 4.7309e-02, PNorm = 35.3366, GNorm = 1.6882, lr_0 = 1.0488e-04
Loss = 7.3495e-02, PNorm = 35.3393, GNorm = 1.8713, lr_0 = 1.0214e-04
Validation rmse = 0.147871
Validation r2 = 0.790959
Validation mse = 0.021866
Epoch 56
Loss = 7.2684e-02, PNorm = 35.3427, GNorm = 1.1887, lr_0 = 1.0000e-04
Loss = 6.7475e-02, PNorm = 35.3459, GNorm = 1.4889, lr_0 = 1.0000e-04
Validation rmse = 0.143620
Validation r2 = 0.802806
Validation mse = 0.020627
Epoch 57
Loss = 5.9184e-02, PNorm = 35.3479, GNorm = 1.3052, lr_0 = 1.0000e-04
Validation rmse = 0.147214
Validation r2 = 0.792813
Validation mse = 0.021672
Epoch 58
Loss = 6.8941e-02, PNorm = 35.3526, GNorm = 1.9235, lr_0 = 1.0000e-04
Loss = 6.8334e-02, PNorm = 35.3553, GNorm = 0.5616, lr_0 = 1.0000e-04
Loss = 1.0408e-01, PNorm = 35.3557, GNorm = 1.3932, lr_0 = 1.0000e-04
Validation rmse = 0.141173
Validation r2 = 0.809469
Validation mse = 0.019930
Epoch 59
Loss = 6.5952e-02, PNorm = 35.3591, GNorm = 0.9855, lr_0 = 1.0000e-04
Validation rmse = 0.140828
Validation r2 = 0.810400
Validation mse = 0.019832
Model 0 best validation rmse = 0.140204 on epoch 54
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.224790
Model 0 test r2 = 0.540776
Model 0 test mse = 0.050531
Ensemble test rmse = 0.224790
Ensemble test r2 = 0.540776
Ensemble test mse = 0.050531
Fold 9
Splitting data with seed 9
Total size = 965 | train size = 772 | val size = 193 | test size = 57
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.5676e-01, PNorm = 34.0175, GNorm = 3.9582, lr_0 = 4.3000e-04
Validation rmse = 0.280011
Validation r2 = 0.345144
Validation mse = 0.078406
Epoch 1
Loss = 6.4029e-01, PNorm = 34.0511, GNorm = 7.1463, lr_0 = 7.6000e-04
Loss = 6.3943e-01, PNorm = 34.1124, GNorm = 1.4837, lr_0 = 9.9472e-04
Loss = 6.3185e-01, PNorm = 34.1209, GNorm = 1.3387, lr_0 = 9.9209e-04
Validation rmse = 0.233056
Validation r2 = 0.546352
Validation mse = 0.054315
Epoch 2
Loss = 5.3063e-01, PNorm = 34.1958, GNorm = 7.8715, lr_0 = 9.6618e-04
Validation rmse = 0.194336
Validation r2 = 0.684569
Validation mse = 0.037767
Epoch 3
Loss = 3.3462e-01, PNorm = 34.2662, GNorm = 2.5950, lr_0 = 9.4094e-04
Loss = 3.3914e-01, PNorm = 34.3302, GNorm = 10.3902, lr_0 = 9.1637e-04
Validation rmse = 0.182707
Validation r2 = 0.721192
Validation mse = 0.033382
Epoch 4
Loss = 2.8522e-01, PNorm = 34.3942, GNorm = 4.3809, lr_0 = 8.9007e-04
Validation rmse = 0.221545
Validation r2 = 0.590058
Validation mse = 0.049082
Epoch 5
Loss = 3.4346e-01, PNorm = 34.4360, GNorm = 1.9743, lr_0 = 8.6682e-04
Loss = 3.6654e-01, PNorm = 34.4857, GNorm = 1.5088, lr_0 = 8.4418e-04
Validation rmse = 0.165945
Validation r2 = 0.770001
Validation mse = 0.027538
Epoch 6
Loss = 2.1838e-01, PNorm = 34.5361, GNorm = 1.6399, lr_0 = 8.1996e-04
Validation rmse = 0.157218
Validation r2 = 0.793557
Validation mse = 0.024717
Epoch 7
Loss = 1.9213e-01, PNorm = 34.5762, GNorm = 6.3045, lr_0 = 7.9854e-04
Loss = 1.8024e-01, PNorm = 34.6137, GNorm = 1.1421, lr_0 = 7.7769e-04
Validation rmse = 0.185831
Validation r2 = 0.711574
Validation mse = 0.034533
Epoch 8
Loss = 2.0759e-01, PNorm = 34.6541, GNorm = 4.1319, lr_0 = 7.5537e-04
Validation rmse = 0.142137
Validation r2 = 0.831262
Validation mse = 0.020203
Epoch 9
Loss = 1.2281e-01, PNorm = 34.6937, GNorm = 1.7662, lr_0 = 7.3370e-04
Loss = 1.7274e-01, PNorm = 34.7235, GNorm = 4.3006, lr_0 = 7.1453e-04
Validation rmse = 0.179229
Validation r2 = 0.731704
Validation mse = 0.032123
Epoch 10
Loss = 2.0339e-01, PNorm = 34.7539, GNorm = 3.2925, lr_0 = 6.9587e-04
Validation rmse = 0.167579
Validation r2 = 0.765448
Validation mse = 0.028083
Epoch 11
Loss = 2.2910e-01, PNorm = 34.7809, GNorm = 6.1008, lr_0 = 6.7590e-04
Loss = 1.9277e-01, PNorm = 34.8048, GNorm = 2.3158, lr_0 = 6.5825e-04
Validation rmse = 0.167619
Validation r2 = 0.765339
Validation mse = 0.028096
Epoch 12
Loss = 1.8157e-01, PNorm = 34.8345, GNorm = 6.1686, lr_0 = 6.4106e-04
Loss = 1.6327e-01, PNorm = 34.8602, GNorm = 1.2147, lr_0 = 6.2431e-04
Loss = 9.3017e-02, PNorm = 34.8614, GNorm = 1.2103, lr_0 = 6.2266e-04
Validation rmse = 0.157965
Validation r2 = 0.791589
Validation mse = 0.024953
Epoch 13
Loss = 1.3596e-01, PNorm = 34.8813, GNorm = 0.8467, lr_0 = 6.0640e-04
Validation rmse = 0.130067
Validation r2 = 0.858703
Validation mse = 0.016918
Epoch 14
Loss = 1.0760e-01, PNorm = 34.8961, GNorm = 0.7577, lr_0 = 5.9056e-04
Loss = 1.3913e-01, PNorm = 34.9115, GNorm = 3.8988, lr_0 = 5.7514e-04
Validation rmse = 0.131667
Validation r2 = 0.855206
Validation mse = 0.017336
Epoch 15
Loss = 1.1589e-01, PNorm = 34.9299, GNorm = 2.7505, lr_0 = 5.5863e-04
Validation rmse = 0.127764
Validation r2 = 0.863663
Validation mse = 0.016324
Epoch 16
Loss = 1.4407e-01, PNorm = 34.9457, GNorm = 2.3623, lr_0 = 5.4404e-04
Loss = 1.0626e-01, PNorm = 34.9612, GNorm = 0.8172, lr_0 = 5.2983e-04
Validation rmse = 0.128782
Validation r2 = 0.861483
Validation mse = 0.016585
Epoch 17
Loss = 1.1354e-01, PNorm = 34.9729, GNorm = 1.4816, lr_0 = 5.1463e-04
Validation rmse = 0.133512
Validation r2 = 0.851120
Validation mse = 0.017825
Epoch 18
Loss = 9.7249e-02, PNorm = 34.9902, GNorm = 0.8494, lr_0 = 4.9986e-04
Loss = 1.2134e-01, PNorm = 35.0026, GNorm = 4.0436, lr_0 = 4.8681e-04
Validation rmse = 0.134940
Validation r2 = 0.847918
Validation mse = 0.018209
Epoch 19
Loss = 1.0793e-01, PNorm = 35.0168, GNorm = 2.8845, lr_0 = 4.7409e-04
Validation rmse = 0.134483
Validation r2 = 0.848946
Validation mse = 0.018086
Epoch 20
Loss = 1.3586e-01, PNorm = 35.0313, GNorm = 2.1957, lr_0 = 4.6049e-04
Loss = 1.1837e-01, PNorm = 35.0459, GNorm = 1.7152, lr_0 = 4.4846e-04
Validation rmse = 0.126728
Validation r2 = 0.865866
Validation mse = 0.016060
Epoch 21
Loss = 1.0999e-01, PNorm = 35.0561, GNorm = 2.9106, lr_0 = 4.3675e-04
Validation rmse = 0.127811
Validation r2 = 0.863563
Validation mse = 0.016336
Epoch 22
Loss = 6.8987e-02, PNorm = 35.0686, GNorm = 1.5356, lr_0 = 4.2422e-04
Loss = 9.4366e-02, PNorm = 35.0781, GNorm = 0.8869, lr_0 = 4.1313e-04
Validation rmse = 0.130966
Validation r2 = 0.856743
Validation mse = 0.017152
Epoch 23
Loss = 9.4207e-02, PNorm = 35.0891, GNorm = 1.3367, lr_0 = 4.0234e-04
Loss = 1.0522e-01, PNorm = 35.1009, GNorm = 1.2388, lr_0 = 3.9184e-04
Loss = 3.6987e-02, PNorm = 35.1023, GNorm = 1.9462, lr_0 = 3.9080e-04
Validation rmse = 0.125584
Validation r2 = 0.868276
Validation mse = 0.015771
Epoch 24
Loss = 9.0452e-02, PNorm = 35.1154, GNorm = 1.0532, lr_0 = 3.8059e-04
Validation rmse = 0.133377
Validation r2 = 0.851420
Validation mse = 0.017789
Epoch 25
Loss = 9.9002e-02, PNorm = 35.1249, GNorm = 0.7787, lr_0 = 3.7065e-04
Loss = 9.5363e-02, PNorm = 35.1332, GNorm = 1.2391, lr_0 = 3.6097e-04
Validation rmse = 0.131527
Validation r2 = 0.855514
Validation mse = 0.017299
Epoch 26
Loss = 9.3612e-02, PNorm = 35.1415, GNorm = 1.5468, lr_0 = 3.5061e-04
Validation rmse = 0.127665
Validation r2 = 0.863874
Validation mse = 0.016298
Epoch 27
Loss = 1.0642e-01, PNorm = 35.1511, GNorm = 0.9137, lr_0 = 3.4055e-04
Loss = 8.9999e-02, PNorm = 35.1630, GNorm = 1.7328, lr_0 = 3.3166e-04
Validation rmse = 0.127685
Validation r2 = 0.863831
Validation mse = 0.016303
Epoch 28
Loss = 1.0826e-01, PNorm = 35.1742, GNorm = 0.9988, lr_0 = 3.2299e-04
Validation rmse = 0.124412
Validation r2 = 0.870722
Validation mse = 0.015478
Epoch 29
Loss = 9.5766e-02, PNorm = 35.1849, GNorm = 1.7431, lr_0 = 3.1373e-04
Loss = 8.2539e-02, PNorm = 35.1943, GNorm = 2.5161, lr_0 = 3.0553e-04
Validation rmse = 0.127041
Validation r2 = 0.865202
Validation mse = 0.016139
Epoch 30
Loss = 9.2091e-02, PNorm = 35.2039, GNorm = 0.7481, lr_0 = 2.9755e-04
Validation rmse = 0.124743
Validation r2 = 0.870035
Validation mse = 0.015561
Epoch 31
Loss = 6.6249e-02, PNorm = 35.2135, GNorm = 1.7206, lr_0 = 2.8901e-04
Loss = 9.6004e-02, PNorm = 35.2209, GNorm = 1.8026, lr_0 = 2.8147e-04
Validation rmse = 0.127943
Validation r2 = 0.863280
Validation mse = 0.016370
Epoch 32
Loss = 8.2701e-02, PNorm = 35.2316, GNorm = 1.0563, lr_0 = 2.7411e-04
Validation rmse = 0.125292
Validation r2 = 0.868888
Validation mse = 0.015698
Epoch 33
Loss = 7.4256e-02, PNorm = 35.2394, GNorm = 1.2234, lr_0 = 2.6625e-04
Loss = 9.6375e-02, PNorm = 35.2471, GNorm = 2.6999, lr_0 = 2.5929e-04
Validation rmse = 0.141215
Validation r2 = 0.833445
Validation mse = 0.019942
Epoch 34
Loss = 1.0347e-01, PNorm = 35.2540, GNorm = 2.5679, lr_0 = 2.5185e-04
Loss = 8.4686e-02, PNorm = 35.2625, GNorm = 2.4514, lr_0 = 2.4528e-04
Validation rmse = 0.124418
Validation r2 = 0.870711
Validation mse = 0.015480
Epoch 35
Loss = 8.0223e-02, PNorm = 35.2698, GNorm = 1.5775, lr_0 = 2.3887e-04
Validation rmse = 0.125463
Validation r2 = 0.868529
Validation mse = 0.015741
Epoch 36
Loss = 8.7513e-02, PNorm = 35.2778, GNorm = 0.7452, lr_0 = 2.3202e-04
Loss = 8.9268e-02, PNorm = 35.2851, GNorm = 2.7947, lr_0 = 2.2596e-04
Validation rmse = 0.123585
Validation r2 = 0.872435
Validation mse = 0.015273
Epoch 37
Loss = 8.5492e-02, PNorm = 35.2924, GNorm = 2.1239, lr_0 = 2.2005e-04
Validation rmse = 0.125020
Validation r2 = 0.869457
Validation mse = 0.015630
Epoch 38
Loss = 7.9346e-02, PNorm = 35.2988, GNorm = 0.4594, lr_0 = 2.1374e-04
Loss = 7.8869e-02, PNorm = 35.3059, GNorm = 0.3877, lr_0 = 2.0816e-04
Validation rmse = 0.123162
Validation r2 = 0.873308
Validation mse = 0.015169
Epoch 39
Loss = 7.3282e-02, PNorm = 35.3113, GNorm = 1.6885, lr_0 = 2.0272e-04
Validation rmse = 0.123722
Validation r2 = 0.872153
Validation mse = 0.015307
Epoch 40
Loss = 9.2600e-02, PNorm = 35.3172, GNorm = 1.5798, lr_0 = 1.9690e-04
Loss = 8.4022e-02, PNorm = 35.3224, GNorm = 1.1317, lr_0 = 1.9176e-04
Validation rmse = 0.122965
Validation r2 = 0.873713
Validation mse = 0.015120
Epoch 41
Loss = 7.8946e-02, PNorm = 35.3281, GNorm = 1.3315, lr_0 = 1.8675e-04
Validation rmse = 0.131333
Validation r2 = 0.855940
Validation mse = 0.017248
Epoch 42
Loss = 9.8650e-02, PNorm = 35.3347, GNorm = 3.2300, lr_0 = 1.8139e-04
Loss = 9.9723e-02, PNorm = 35.3403, GNorm = 2.5403, lr_0 = 1.7666e-04
Validation rmse = 0.126796
Validation r2 = 0.865721
Validation mse = 0.016077
Epoch 43
Loss = 8.8775e-02, PNorm = 35.3475, GNorm = 2.5778, lr_0 = 1.7159e-04
Validation rmse = 0.123890
Validation r2 = 0.871806
Validation mse = 0.015349
Epoch 44
Loss = 5.8439e-02, PNorm = 35.3531, GNorm = 1.2260, lr_0 = 1.6710e-04
Loss = 8.0376e-02, PNorm = 35.3572, GNorm = 0.6851, lr_0 = 1.6274e-04
Validation rmse = 0.122573
Validation r2 = 0.874516
Validation mse = 0.015024
Epoch 45
Loss = 7.9113e-02, PNorm = 35.3632, GNorm = 0.6085, lr_0 = 1.5807e-04
Loss = 7.9022e-02, PNorm = 35.3674, GNorm = 0.6984, lr_0 = 1.5394e-04
Validation rmse = 0.126758
Validation r2 = 0.865802
Validation mse = 0.016068
Epoch 46
Loss = 7.7446e-02, PNorm = 35.3729, GNorm = 2.5623, lr_0 = 1.4992e-04
Validation rmse = 0.123970
Validation r2 = 0.871641
Validation mse = 0.015368
Epoch 47
Loss = 9.1046e-02, PNorm = 35.3773, GNorm = 0.8892, lr_0 = 1.4562e-04
Loss = 7.2282e-02, PNorm = 35.3815, GNorm = 0.8970, lr_0 = 1.4182e-04
Validation rmse = 0.122853
Validation r2 = 0.873943
Validation mse = 0.015093
Epoch 48
Loss = 7.9847e-02, PNorm = 35.3849, GNorm = 1.8999, lr_0 = 1.3811e-04
Validation rmse = 0.122512
Validation r2 = 0.874640
Validation mse = 0.015009
Epoch 49
Loss = 7.9100e-02, PNorm = 35.3897, GNorm = 0.7831, lr_0 = 1.3415e-04
Loss = 7.7367e-02, PNorm = 35.3945, GNorm = 1.0682, lr_0 = 1.3064e-04
Validation rmse = 0.123514
Validation r2 = 0.872581
Validation mse = 0.015256
Epoch 50
Loss = 8.1927e-02, PNorm = 35.3974, GNorm = 1.9391, lr_0 = 1.2723e-04
Validation rmse = 0.121339
Validation r2 = 0.877030
Validation mse = 0.014723
Epoch 51
Loss = 7.0741e-02, PNorm = 35.4015, GNorm = 2.2539, lr_0 = 1.2358e-04
Loss = 8.0580e-02, PNorm = 35.4057, GNorm = 1.0176, lr_0 = 1.2035e-04
Validation rmse = 0.124135
Validation r2 = 0.871298
Validation mse = 0.015410
Epoch 52
Loss = 8.5234e-02, PNorm = 35.4090, GNorm = 2.1712, lr_0 = 1.1690e-04
Validation rmse = 0.121791
Validation r2 = 0.876112
Validation mse = 0.014833
Epoch 53
Loss = 4.6953e-02, PNorm = 35.4130, GNorm = 0.5515, lr_0 = 1.1385e-04
Loss = 8.4096e-02, PNorm = 35.4165, GNorm = 0.7358, lr_0 = 1.1087e-04
Validation rmse = 0.123665
Validation r2 = 0.872270
Validation mse = 0.015293
Epoch 54
Loss = 7.7806e-02, PNorm = 35.4202, GNorm = 0.5445, lr_0 = 1.0769e-04
Validation rmse = 0.122576
Validation r2 = 0.874509
Validation mse = 0.015025
Epoch 55
Loss = 7.5812e-02, PNorm = 35.4233, GNorm = 0.5239, lr_0 = 1.0488e-04
Loss = 7.5296e-02, PNorm = 35.4268, GNorm = 0.7374, lr_0 = 1.0214e-04
Validation rmse = 0.122844
Validation r2 = 0.873961
Validation mse = 0.015091
Epoch 56
Loss = 8.6127e-02, PNorm = 35.4310, GNorm = 0.7695, lr_0 = 1.0000e-04
Loss = 6.7742e-02, PNorm = 35.4339, GNorm = 1.3616, lr_0 = 1.0000e-04
Validation rmse = 0.122265
Validation r2 = 0.875145
Validation mse = 0.014949
Epoch 57
Loss = 7.6047e-02, PNorm = 35.4371, GNorm = 1.4301, lr_0 = 1.0000e-04
Validation rmse = 0.121471
Validation r2 = 0.876762
Validation mse = 0.014755
Epoch 58
Loss = 6.2307e-02, PNorm = 35.4397, GNorm = 1.2066, lr_0 = 1.0000e-04
Loss = 7.9002e-02, PNorm = 35.4426, GNorm = 0.3608, lr_0 = 1.0000e-04
Loss = 6.9996e-02, PNorm = 35.4429, GNorm = 1.5584, lr_0 = 1.0000e-04
Validation rmse = 0.123556
Validation r2 = 0.872497
Validation mse = 0.015266
Epoch 59
Loss = 7.6428e-02, PNorm = 35.4462, GNorm = 1.3705, lr_0 = 1.0000e-04
Validation rmse = 0.122207
Validation r2 = 0.875265
Validation mse = 0.014935
Model 0 best validation rmse = 0.121339 on epoch 50
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.230762
Model 0 test r2 = 0.516051
Model 0 test mse = 0.053251
Ensemble test rmse = 0.230762
Ensemble test r2 = 0.516051
Ensemble test mse = 0.053251
10-fold cross validation
	Seed 0 ==> test rmse = 0.204801
	Seed 0 ==> test r2 = 0.618817
	Seed 0 ==> test mse = 0.041943
	Seed 1 ==> test rmse = 0.223428
	Seed 1 ==> test r2 = 0.546322
	Seed 1 ==> test mse = 0.049920
	Seed 2 ==> test rmse = 0.199411
	Seed 2 ==> test r2 = 0.638616
	Seed 2 ==> test mse = 0.039765
	Seed 3 ==> test rmse = 0.193161
	Seed 3 ==> test r2 = 0.660914
	Seed 3 ==> test mse = 0.037311
	Seed 4 ==> test rmse = 0.213242
	Seed 4 ==> test r2 = 0.586748
	Seed 4 ==> test mse = 0.045472
	Seed 5 ==> test rmse = 0.210195
	Seed 5 ==> test r2 = 0.598471
	Seed 5 ==> test mse = 0.044182
	Seed 6 ==> test rmse = 0.217614
	Seed 6 ==> test r2 = 0.569626
	Seed 6 ==> test mse = 0.047356
	Seed 7 ==> test rmse = 0.209081
	Seed 7 ==> test r2 = 0.602718
	Seed 7 ==> test mse = 0.043715
	Seed 8 ==> test rmse = 0.224790
	Seed 8 ==> test r2 = 0.540776
	Seed 8 ==> test mse = 0.050531
	Seed 9 ==> test rmse = 0.230762
	Seed 9 ==> test r2 = 0.516051
	Seed 9 ==> test mse = 0.053251
Overall test rmse = 0.212649 +/- 0.011190
Overall test r2 = 0.587906 +/- 0.043171
Overall test mse = 0.045345 +/- 0.004750
Elapsed time = 0:06:54
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-1d5c3576-9790-4896-9034-9bb28ba18d8e.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/Tol_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2', 'mse'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2', 'mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/generalization_3/Tol_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/Tol_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 974 | train size = 779 | val size = 195 | test size = 48
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.8481e-01, PNorm = 34.0173, GNorm = 5.6020, lr_0 = 4.3000e-04
Validation rmse = 0.319294
Validation r2 = 0.113967
Validation mse = 0.101948
Epoch 1
Loss = 9.3806e-01, PNorm = 34.0446, GNorm = 15.4588, lr_0 = 7.6000e-04
Loss = 6.3846e-01, PNorm = 34.0882, GNorm = 1.6578, lr_0 = 9.9472e-04
Validation rmse = 0.231331
Validation r2 = 0.534909
Validation mse = 0.053514
Epoch 2
Loss = 4.4431e-01, PNorm = 34.1597, GNorm = 0.9805, lr_0 = 9.6874e-04
Validation rmse = 0.174270
Validation r2 = 0.736055
Validation mse = 0.030370
Epoch 3
Loss = 3.9031e-01, PNorm = 34.2396, GNorm = 4.7908, lr_0 = 9.4094e-04
Loss = 3.8416e-01, PNorm = 34.2936, GNorm = 5.9912, lr_0 = 9.1637e-04
Validation rmse = 0.224516
Validation r2 = 0.561910
Validation mse = 0.050407
Epoch 4
Loss = 3.0786e-01, PNorm = 34.3407, GNorm = 2.6875, lr_0 = 8.9243e-04
Validation rmse = 0.165520
Validation r2 = 0.761895
Validation mse = 0.027397
Epoch 5
Loss = 2.9979e-01, PNorm = 34.3899, GNorm = 3.5304, lr_0 = 8.6682e-04
Loss = 2.1080e-01, PNorm = 34.4298, GNorm = 1.3460, lr_0 = 8.4418e-04
Validation rmse = 0.143905
Validation r2 = 0.820021
Validation mse = 0.020709
Epoch 6
Loss = 2.4264e-01, PNorm = 34.4672, GNorm = 2.0521, lr_0 = 8.2213e-04
Validation rmse = 0.136412
Validation r2 = 0.838277
Validation mse = 0.018608
Epoch 7
Loss = 2.0765e-01, PNorm = 34.5044, GNorm = 5.3500, lr_0 = 8.0066e-04
Loss = 2.1880e-01, PNorm = 34.5433, GNorm = 5.0968, lr_0 = 7.7975e-04
Validation rmse = 0.147074
Validation r2 = 0.812008
Validation mse = 0.021631
Epoch 8
Loss = 2.0015e-01, PNorm = 34.5734, GNorm = 4.9886, lr_0 = 7.5737e-04
Loss = 1.9331e-01, PNorm = 34.6015, GNorm = 1.0331, lr_0 = 7.3759e-04
Validation rmse = 0.162914
Validation r2 = 0.769333
Validation mse = 0.026541
Epoch 9
Loss = 2.0282e-01, PNorm = 34.6328, GNorm = 5.2194, lr_0 = 7.1833e-04
Validation rmse = 0.140912
Validation r2 = 0.827431
Validation mse = 0.019856
Epoch 10
Loss = 1.7500e-01, PNorm = 34.6611, GNorm = 2.7147, lr_0 = 6.9772e-04
Loss = 1.4537e-01, PNorm = 34.6860, GNorm = 0.5367, lr_0 = 6.7949e-04
Validation rmse = 0.138837
Validation r2 = 0.832476
Validation mse = 0.019276
Epoch 11
Loss = 1.6107e-01, PNorm = 34.7147, GNorm = 1.6257, lr_0 = 6.6174e-04
Validation rmse = 0.121480
Validation r2 = 0.871744
Validation mse = 0.014757
Epoch 12
Loss = 1.5908e-01, PNorm = 34.7392, GNorm = 1.2995, lr_0 = 6.4276e-04
Loss = 1.4682e-01, PNorm = 34.7630, GNorm = 3.2630, lr_0 = 6.2597e-04
Validation rmse = 0.119018
Validation r2 = 0.876889
Validation mse = 0.014165
Epoch 13
Loss = 1.6186e-01, PNorm = 34.7788, GNorm = 2.3654, lr_0 = 6.0962e-04
Validation rmse = 0.129606
Validation r2 = 0.854011
Validation mse = 0.016798
Epoch 14
Loss = 1.0463e-01, PNorm = 34.7966, GNorm = 1.0016, lr_0 = 5.9369e-04
Loss = 1.3304e-01, PNorm = 34.8126, GNorm = 2.4116, lr_0 = 5.7819e-04
Validation rmse = 0.117609
Validation r2 = 0.879788
Validation mse = 0.013832
Epoch 15
Loss = 1.3796e-01, PNorm = 34.8340, GNorm = 0.7490, lr_0 = 5.6160e-04
Validation rmse = 0.115497
Validation r2 = 0.884066
Validation mse = 0.013340
Epoch 16
Loss = 1.5478e-01, PNorm = 34.8512, GNorm = 2.7338, lr_0 = 5.4693e-04
Loss = 1.2972e-01, PNorm = 34.8714, GNorm = 2.9954, lr_0 = 5.3264e-04
Validation rmse = 0.110059
Validation r2 = 0.894727
Validation mse = 0.012113
Epoch 17
Loss = 1.1355e-01, PNorm = 34.8862, GNorm = 0.9009, lr_0 = 5.1736e-04
Loss = 1.3485e-01, PNorm = 34.9025, GNorm = 2.4642, lr_0 = 5.0385e-04
Validation rmse = 0.121485
Validation r2 = 0.871733
Validation mse = 0.014759
Epoch 18
Loss = 1.1746e-01, PNorm = 34.9193, GNorm = 1.8267, lr_0 = 4.9069e-04
Validation rmse = 0.134025
Validation r2 = 0.843886
Validation mse = 0.017963
Epoch 19
Loss = 1.1179e-01, PNorm = 34.9364, GNorm = 1.3969, lr_0 = 4.7787e-04
Loss = 1.4994e-01, PNorm = 34.9512, GNorm = 3.8492, lr_0 = 4.6539e-04
Validation rmse = 0.115100
Validation r2 = 0.884862
Validation mse = 0.013248
Epoch 20
Loss = 1.1451e-01, PNorm = 34.9668, GNorm = 2.1063, lr_0 = 4.5204e-04
Validation rmse = 0.122176
Validation r2 = 0.870270
Validation mse = 0.014927
Epoch 21
Loss = 1.2823e-01, PNorm = 34.9820, GNorm = 2.4415, lr_0 = 4.4023e-04
Loss = 1.2155e-01, PNorm = 34.9966, GNorm = 1.7958, lr_0 = 4.2873e-04
Validation rmse = 0.117294
Validation r2 = 0.880431
Validation mse = 0.013758
Epoch 22
Loss = 1.0791e-01, PNorm = 35.0120, GNorm = 1.5644, lr_0 = 4.1643e-04
Validation rmse = 0.113272
Validation r2 = 0.888490
Validation mse = 0.012830
Epoch 23
Loss = 1.1340e-01, PNorm = 35.0262, GNorm = 2.5003, lr_0 = 4.0555e-04
Loss = 1.1135e-01, PNorm = 35.0397, GNorm = 2.7316, lr_0 = 3.9496e-04
Validation rmse = 0.105673
Validation r2 = 0.902950
Validation mse = 0.011167
Epoch 24
Loss = 9.7041e-02, PNorm = 35.0521, GNorm = 0.6999, lr_0 = 3.8363e-04
Validation rmse = 0.115861
Validation r2 = 0.883335
Validation mse = 0.013424
Epoch 25
Loss = 8.4601e-02, PNorm = 35.0655, GNorm = 0.4228, lr_0 = 3.7361e-04
Loss = 1.0716e-01, PNorm = 35.0775, GNorm = 1.0813, lr_0 = 3.6385e-04
Validation rmse = 0.105382
Validation r2 = 0.903484
Validation mse = 0.011105
Epoch 26
Loss = 1.0288e-01, PNorm = 35.0894, GNorm = 2.6181, lr_0 = 3.5434e-04
Loss = 1.0105e-01, PNorm = 35.1022, GNorm = 0.8623, lr_0 = 3.4509e-04
Loss = 1.0350e-01, PNorm = 35.1032, GNorm = 1.6817, lr_0 = 3.4418e-04
Validation rmse = 0.113121
Validation r2 = 0.888786
Validation mse = 0.012796
Epoch 27
Loss = 1.0921e-01, PNorm = 35.1161, GNorm = 1.8944, lr_0 = 3.3519e-04
Validation rmse = 0.111632
Validation r2 = 0.891696
Validation mse = 0.012462
Epoch 28
Loss = 9.4029e-02, PNorm = 35.1284, GNorm = 1.9764, lr_0 = 3.2643e-04
Loss = 1.1126e-01, PNorm = 35.1390, GNorm = 1.0297, lr_0 = 3.1791e-04
Validation rmse = 0.106501
Validation r2 = 0.901422
Validation mse = 0.011343
Epoch 29
Loss = 1.0186e-01, PNorm = 35.1544, GNorm = 1.6160, lr_0 = 3.0878e-04
Validation rmse = 0.106418
Validation r2 = 0.901576
Validation mse = 0.011325
Epoch 30
Loss = 7.5017e-02, PNorm = 35.1654, GNorm = 0.8789, lr_0 = 3.0072e-04
Loss = 1.0322e-01, PNorm = 35.1759, GNorm = 1.9707, lr_0 = 2.9286e-04
Validation rmse = 0.116831
Validation r2 = 0.881373
Validation mse = 0.013649
Epoch 31
Loss = 9.8741e-02, PNorm = 35.1899, GNorm = 1.0755, lr_0 = 2.8446e-04
Validation rmse = 0.106383
Validation r2 = 0.901640
Validation mse = 0.011317
Epoch 32
Loss = 1.1844e-01, PNorm = 35.2018, GNorm = 0.8954, lr_0 = 2.7703e-04
Loss = 1.1165e-01, PNorm = 35.2104, GNorm = 1.2313, lr_0 = 2.6980e-04
Validation rmse = 0.103697
Validation r2 = 0.906546
Validation mse = 0.010753
Epoch 33
Loss = 1.1321e-01, PNorm = 35.2217, GNorm = 0.8383, lr_0 = 2.6275e-04
Validation rmse = 0.109974
Validation r2 = 0.894889
Validation mse = 0.012094
Epoch 34
Loss = 1.4895e-01, PNorm = 35.2328, GNorm = 1.1587, lr_0 = 2.5521e-04
Loss = 9.8389e-02, PNorm = 35.2417, GNorm = 1.5935, lr_0 = 2.4854e-04
Validation rmse = 0.103196
Validation r2 = 0.907445
Validation mse = 0.010649
Epoch 35
Loss = 9.5010e-02, PNorm = 35.2509, GNorm = 1.0527, lr_0 = 2.4205e-04
Loss = 9.2191e-02, PNorm = 35.2603, GNorm = 2.2547, lr_0 = 2.3573e-04
Loss = 1.2641e-01, PNorm = 35.2612, GNorm = 1.3334, lr_0 = 2.3511e-04
Validation rmse = 0.102812
Validation r2 = 0.908133
Validation mse = 0.010570
Epoch 36
Loss = 9.1547e-02, PNorm = 35.2704, GNorm = 1.8060, lr_0 = 2.2897e-04
Validation rmse = 0.109803
Validation r2 = 0.895216
Validation mse = 0.012057
Epoch 37
Loss = 8.0706e-02, PNorm = 35.2800, GNorm = 0.5478, lr_0 = 2.2299e-04
Loss = 9.3190e-02, PNorm = 35.2880, GNorm = 0.8953, lr_0 = 2.1716e-04
Validation rmse = 0.106863
Validation r2 = 0.900752
Validation mse = 0.011420
Epoch 38
Loss = 9.4923e-02, PNorm = 35.2951, GNorm = 1.8665, lr_0 = 2.1149e-04
Validation rmse = 0.104035
Validation r2 = 0.905935
Validation mse = 0.010823
Epoch 39
Loss = 8.7738e-02, PNorm = 35.3035, GNorm = 0.9471, lr_0 = 2.0542e-04
Loss = 8.7400e-02, PNorm = 35.3105, GNorm = 0.8483, lr_0 = 2.0006e-04
Validation rmse = 0.102340
Validation r2 = 0.908975
Validation mse = 0.010473
Epoch 40
Loss = 7.9871e-02, PNorm = 35.3192, GNorm = 1.5695, lr_0 = 1.9483e-04
Validation rmse = 0.102488
Validation r2 = 0.908711
Validation mse = 0.010504
Epoch 41
Loss = 7.7026e-02, PNorm = 35.3268, GNorm = 0.6707, lr_0 = 1.8924e-04
Loss = 8.3752e-02, PNorm = 35.3335, GNorm = 2.3863, lr_0 = 1.8430e-04
Validation rmse = 0.106314
Validation r2 = 0.901768
Validation mse = 0.011303
Epoch 42
Loss = 9.2301e-02, PNorm = 35.3415, GNorm = 1.1629, lr_0 = 1.7948e-04
Validation rmse = 0.102714
Validation r2 = 0.908309
Validation mse = 0.010550
Epoch 43
Loss = 5.9124e-02, PNorm = 35.3493, GNorm = 0.6083, lr_0 = 1.7433e-04
Loss = 8.4327e-02, PNorm = 35.3551, GNorm = 0.7574, lr_0 = 1.6978e-04
Validation rmse = 0.102901
Validation r2 = 0.907975
Validation mse = 0.010589
Epoch 44
Loss = 9.1768e-02, PNorm = 35.3624, GNorm = 0.7082, lr_0 = 1.6534e-04
Loss = 8.1404e-02, PNorm = 35.3682, GNorm = 0.8767, lr_0 = 1.6103e-04
Validation rmse = 0.101297
Validation r2 = 0.910821
Validation mse = 0.010261
Epoch 45
Loss = 7.9997e-02, PNorm = 35.3739, GNorm = 1.1820, lr_0 = 1.5682e-04
Validation rmse = 0.102896
Validation r2 = 0.907984
Validation mse = 0.010588
Epoch 46
Loss = 9.2139e-02, PNorm = 35.3804, GNorm = 1.0770, lr_0 = 1.5232e-04
Loss = 8.3261e-02, PNorm = 35.3859, GNorm = 1.0053, lr_0 = 1.4834e-04
Validation rmse = 0.103237
Validation r2 = 0.907373
Validation mse = 0.010658
Epoch 47
Loss = 8.0734e-02, PNorm = 35.3917, GNorm = 1.1491, lr_0 = 1.4447e-04
Validation rmse = 0.103329
Validation r2 = 0.907207
Validation mse = 0.010677
Epoch 48
Loss = 7.5513e-02, PNorm = 35.3981, GNorm = 1.0003, lr_0 = 1.4032e-04
Loss = 8.5546e-02, PNorm = 35.4036, GNorm = 3.6100, lr_0 = 1.3666e-04
Validation rmse = 0.103722
Validation r2 = 0.906500
Validation mse = 0.010758
Epoch 49
Loss = 7.8235e-02, PNorm = 35.4085, GNorm = 1.0090, lr_0 = 1.3309e-04
Validation rmse = 0.104103
Validation r2 = 0.905811
Validation mse = 0.010838
Epoch 50
Loss = 5.9056e-02, PNorm = 35.4129, GNorm = 0.9614, lr_0 = 1.2961e-04
Loss = 8.3706e-02, PNorm = 35.4173, GNorm = 2.0217, lr_0 = 1.2623e-04
Validation rmse = 0.103061
Validation r2 = 0.907689
Validation mse = 0.010622
Epoch 51
Loss = 9.0450e-02, PNorm = 35.4224, GNorm = 1.3465, lr_0 = 1.2260e-04
Loss = 7.4891e-02, PNorm = 35.4267, GNorm = 1.6996, lr_0 = 1.1940e-04
Validation rmse = 0.105826
Validation r2 = 0.902669
Validation mse = 0.011199
Epoch 52
Loss = 8.5467e-02, PNorm = 35.4313, GNorm = 1.2927, lr_0 = 1.1628e-04
Validation rmse = 0.102584
Validation r2 = 0.908541
Validation mse = 0.010523
Epoch 53
Loss = 7.5146e-02, PNorm = 35.4363, GNorm = 1.1799, lr_0 = 1.1295e-04
Loss = 8.1444e-02, PNorm = 35.4409, GNorm = 1.1679, lr_0 = 1.1000e-04
Validation rmse = 0.100926
Validation r2 = 0.911474
Validation mse = 0.010186
Epoch 54
Loss = 7.9219e-02, PNorm = 35.4446, GNorm = 0.9680, lr_0 = 1.0712e-04
Validation rmse = 0.102073
Validation r2 = 0.909449
Validation mse = 0.010419
Epoch 55
Loss = 8.6122e-02, PNorm = 35.4498, GNorm = 0.5510, lr_0 = 1.0405e-04
Loss = 7.6192e-02, PNorm = 35.4540, GNorm = 1.1753, lr_0 = 1.0133e-04
Validation rmse = 0.101878
Validation r2 = 0.909796
Validation mse = 0.010379
Epoch 56
Loss = 7.2666e-02, PNorm = 35.4583, GNorm = 0.8475, lr_0 = 1.0000e-04
Validation rmse = 0.101449
Validation r2 = 0.910554
Validation mse = 0.010292
Epoch 57
Loss = 6.7445e-02, PNorm = 35.4614, GNorm = 1.4140, lr_0 = 1.0000e-04
Loss = 7.9707e-02, PNorm = 35.4655, GNorm = 1.1166, lr_0 = 1.0000e-04
Validation rmse = 0.102133
Validation r2 = 0.909344
Validation mse = 0.010431
Epoch 58
Loss = 7.8130e-02, PNorm = 35.4693, GNorm = 1.0571, lr_0 = 1.0000e-04
Validation rmse = 0.101840
Validation r2 = 0.909863
Validation mse = 0.010371
Epoch 59
Loss = 6.1730e-02, PNorm = 35.4730, GNorm = 0.7336, lr_0 = 1.0000e-04
Loss = 7.6033e-02, PNorm = 35.4770, GNorm = 1.2379, lr_0 = 1.0000e-04
Validation rmse = 0.101151
Validation r2 = 0.911077
Validation mse = 0.010232
Model 0 best validation rmse = 0.100926 on epoch 53
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.575041
Model 0 test r2 = -3.395582
Model 0 test mse = 0.330672
Ensemble test rmse = 0.575041
Ensemble test r2 = -3.395582
Ensemble test mse = 0.330672
Fold 1
Splitting data with seed 1
Total size = 974 | train size = 779 | val size = 195 | test size = 48
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.5377e-01, PNorm = 34.0152, GNorm = 1.0043, lr_0 = 4.3000e-04
Validation rmse = 0.302262
Validation r2 = 0.113960
Validation mse = 0.091362
Epoch 1
Loss = 7.5711e-01, PNorm = 34.0469, GNorm = 6.1592, lr_0 = 7.6000e-04
Loss = 5.8622e-01, PNorm = 34.1103, GNorm = 1.9287, lr_0 = 9.9472e-04
Validation rmse = 0.280132
Validation r2 = 0.238953
Validation mse = 0.078474
Epoch 2
Loss = 4.2948e-01, PNorm = 34.1857, GNorm = 2.0051, lr_0 = 9.6874e-04
Validation rmse = 0.192992
Validation r2 = 0.638786
Validation mse = 0.037246
Epoch 3
Loss = 3.2783e-01, PNorm = 34.2567, GNorm = 1.6045, lr_0 = 9.4094e-04
Loss = 2.8893e-01, PNorm = 34.3161, GNorm = 1.8759, lr_0 = 9.1637e-04
Validation rmse = 0.179626
Validation r2 = 0.687087
Validation mse = 0.032265
Epoch 4
Loss = 2.4548e-01, PNorm = 34.3637, GNorm = 4.7879, lr_0 = 8.9243e-04
Validation rmse = 0.183056
Validation r2 = 0.675021
Validation mse = 0.033510
Epoch 5
Loss = 3.0431e-01, PNorm = 34.4104, GNorm = 3.9641, lr_0 = 8.6682e-04
Loss = 1.9600e-01, PNorm = 34.4535, GNorm = 2.5112, lr_0 = 8.4418e-04
Validation rmse = 0.158522
Validation r2 = 0.756295
Validation mse = 0.025129
Epoch 6
Loss = 1.9535e-01, PNorm = 34.4898, GNorm = 1.5596, lr_0 = 8.2213e-04
Validation rmse = 0.156185
Validation r2 = 0.763427
Validation mse = 0.024394
Epoch 7
Loss = 2.1200e-01, PNorm = 34.5298, GNorm = 4.8109, lr_0 = 8.0066e-04
Loss = 1.4756e-01, PNorm = 34.5603, GNorm = 3.0921, lr_0 = 7.7975e-04
Validation rmse = 0.161256
Validation r2 = 0.747816
Validation mse = 0.026003
Epoch 8
Loss = 2.0464e-01, PNorm = 34.5914, GNorm = 2.1501, lr_0 = 7.5737e-04
Loss = 1.9185e-01, PNorm = 34.6252, GNorm = 1.0448, lr_0 = 7.3759e-04
Validation rmse = 0.151407
Validation r2 = 0.777680
Validation mse = 0.022924
Epoch 9
Loss = 1.4797e-01, PNorm = 34.6483, GNorm = 4.3069, lr_0 = 7.1833e-04
Validation rmse = 0.137797
Validation r2 = 0.815852
Validation mse = 0.018988
Epoch 10
Loss = 1.4707e-01, PNorm = 34.6794, GNorm = 0.7321, lr_0 = 6.9772e-04
Loss = 1.3131e-01, PNorm = 34.7053, GNorm = 1.1283, lr_0 = 6.7949e-04
Validation rmse = 0.132741
Validation r2 = 0.829117
Validation mse = 0.017620
Epoch 11
Loss = 1.2278e-01, PNorm = 34.7257, GNorm = 1.3164, lr_0 = 6.6174e-04
Validation rmse = 0.130095
Validation r2 = 0.835863
Validation mse = 0.016925
Epoch 12
Loss = 1.1918e-01, PNorm = 34.7507, GNorm = 5.3906, lr_0 = 6.4276e-04
Loss = 1.5724e-01, PNorm = 34.7667, GNorm = 2.3048, lr_0 = 6.2597e-04
Validation rmse = 0.129756
Validation r2 = 0.836716
Validation mse = 0.016837
Epoch 13
Loss = 1.5099e-01, PNorm = 34.7926, GNorm = 2.6932, lr_0 = 6.0962e-04
Validation rmse = 0.125930
Validation r2 = 0.846203
Validation mse = 0.015858
Epoch 14
Loss = 1.1983e-01, PNorm = 34.8129, GNorm = 1.8337, lr_0 = 5.9369e-04
Loss = 1.2266e-01, PNorm = 34.8303, GNorm = 0.6063, lr_0 = 5.7819e-04
Validation rmse = 0.137692
Validation r2 = 0.816132
Validation mse = 0.018959
Epoch 15
Loss = 9.9546e-02, PNorm = 34.8483, GNorm = 0.6330, lr_0 = 5.6160e-04
Validation rmse = 0.125453
Validation r2 = 0.847367
Validation mse = 0.015738
Epoch 16
Loss = 1.2203e-01, PNorm = 34.8672, GNorm = 2.1097, lr_0 = 5.4693e-04
Loss = 1.0080e-01, PNorm = 34.8845, GNorm = 0.6823, lr_0 = 5.3264e-04
Validation rmse = 0.126217
Validation r2 = 0.845501
Validation mse = 0.015931
Epoch 17
Loss = 1.0862e-01, PNorm = 34.9015, GNorm = 2.0952, lr_0 = 5.1736e-04
Loss = 1.1845e-01, PNorm = 34.9151, GNorm = 3.4323, lr_0 = 5.0385e-04
Validation rmse = 0.124932
Validation r2 = 0.848633
Validation mse = 0.015608
Epoch 18
Loss = 1.2452e-01, PNorm = 34.9331, GNorm = 1.3958, lr_0 = 4.9069e-04
Validation rmse = 0.123511
Validation r2 = 0.852055
Validation mse = 0.015255
Epoch 19
Loss = 1.0641e-01, PNorm = 34.9478, GNorm = 1.4208, lr_0 = 4.7787e-04
Loss = 1.1631e-01, PNorm = 34.9644, GNorm = 1.4326, lr_0 = 4.6539e-04
Validation rmse = 0.131611
Validation r2 = 0.832015
Validation mse = 0.017321
Epoch 20
Loss = 9.7509e-02, PNorm = 34.9784, GNorm = 0.9962, lr_0 = 4.5204e-04
Validation rmse = 0.123815
Validation r2 = 0.851327
Validation mse = 0.015330
Epoch 21
Loss = 9.7950e-02, PNorm = 34.9916, GNorm = 1.3385, lr_0 = 4.4023e-04
Loss = 1.2056e-01, PNorm = 35.0059, GNorm = 2.9223, lr_0 = 4.2873e-04
Validation rmse = 0.134941
Validation r2 = 0.823406
Validation mse = 0.018209
Epoch 22
Loss = 1.1029e-01, PNorm = 35.0225, GNorm = 1.1062, lr_0 = 4.1643e-04
Validation rmse = 0.124235
Validation r2 = 0.850316
Validation mse = 0.015434
Epoch 23
Loss = 7.4275e-02, PNorm = 35.0364, GNorm = 1.2989, lr_0 = 4.0555e-04
Loss = 1.0527e-01, PNorm = 35.0491, GNorm = 0.5613, lr_0 = 3.9496e-04
Validation rmse = 0.123683
Validation r2 = 0.851643
Validation mse = 0.015298
Epoch 24
Loss = 8.9618e-02, PNorm = 35.0639, GNorm = 1.2005, lr_0 = 3.8363e-04
Validation rmse = 0.124741
Validation r2 = 0.849094
Validation mse = 0.015560
Epoch 25
Loss = 9.0936e-02, PNorm = 35.0765, GNorm = 1.9308, lr_0 = 3.7361e-04
Loss = 8.5270e-02, PNorm = 35.0881, GNorm = 2.2333, lr_0 = 3.6385e-04
Validation rmse = 0.121024
Validation r2 = 0.857955
Validation mse = 0.014647
Epoch 26
Loss = 8.7595e-02, PNorm = 35.1013, GNorm = 0.7486, lr_0 = 3.5434e-04
Loss = 9.0844e-02, PNorm = 35.1135, GNorm = 1.9712, lr_0 = 3.4509e-04
Loss = 3.6816e-02, PNorm = 35.1145, GNorm = 0.5083, lr_0 = 3.4418e-04
Validation rmse = 0.130044
Validation r2 = 0.835992
Validation mse = 0.016911
Epoch 27
Loss = 9.1316e-02, PNorm = 35.1267, GNorm = 0.9213, lr_0 = 3.3519e-04
Validation rmse = 0.122724
Validation r2 = 0.853936
Validation mse = 0.015061
Epoch 28
Loss = 7.1051e-02, PNorm = 35.1375, GNorm = 0.6893, lr_0 = 3.2643e-04
Loss = 9.0625e-02, PNorm = 35.1468, GNorm = 1.9638, lr_0 = 3.1791e-04
Validation rmse = 0.122055
Validation r2 = 0.855523
Validation mse = 0.014897
Epoch 29
Loss = 9.4307e-02, PNorm = 35.1610, GNorm = 2.3083, lr_0 = 3.0878e-04
Validation rmse = 0.128291
Validation r2 = 0.840384
Validation mse = 0.016458
Epoch 30
Loss = 9.7754e-02, PNorm = 35.1717, GNorm = 1.1453, lr_0 = 3.0072e-04
Loss = 8.4509e-02, PNorm = 35.1820, GNorm = 0.6949, lr_0 = 2.9286e-04
Validation rmse = 0.123238
Validation r2 = 0.852709
Validation mse = 0.015188
Epoch 31
Loss = 8.6305e-02, PNorm = 35.1927, GNorm = 1.4360, lr_0 = 2.8446e-04
Validation rmse = 0.123721
Validation r2 = 0.851553
Validation mse = 0.015307
Epoch 32
Loss = 7.4886e-02, PNorm = 35.2037, GNorm = 0.6080, lr_0 = 2.7703e-04
Loss = 8.0098e-02, PNorm = 35.2138, GNorm = 0.6194, lr_0 = 2.6980e-04
Validation rmse = 0.122347
Validation r2 = 0.854830
Validation mse = 0.014969
Epoch 33
Loss = 8.0214e-02, PNorm = 35.2226, GNorm = 1.3648, lr_0 = 2.6275e-04
Validation rmse = 0.123547
Validation r2 = 0.851969
Validation mse = 0.015264
Epoch 34
Loss = 6.8015e-02, PNorm = 35.2320, GNorm = 1.6453, lr_0 = 2.5521e-04
Loss = 8.3342e-02, PNorm = 35.2426, GNorm = 1.5646, lr_0 = 2.4854e-04
Validation rmse = 0.124858
Validation r2 = 0.848811
Validation mse = 0.015590
Epoch 35
Loss = 8.7555e-02, PNorm = 35.2498, GNorm = 1.0438, lr_0 = 2.4205e-04
Loss = 7.2567e-02, PNorm = 35.2585, GNorm = 0.8743, lr_0 = 2.3573e-04
Loss = 9.9429e-02, PNorm = 35.2593, GNorm = 0.9521, lr_0 = 2.3511e-04
Validation rmse = 0.124464
Validation r2 = 0.849764
Validation mse = 0.015491
Epoch 36
Loss = 8.0703e-02, PNorm = 35.2667, GNorm = 0.7190, lr_0 = 2.2897e-04
Validation rmse = 0.119825
Validation r2 = 0.860754
Validation mse = 0.014358
Epoch 37
Loss = 6.8348e-02, PNorm = 35.2749, GNorm = 0.7986, lr_0 = 2.2299e-04
Loss = 8.2126e-02, PNorm = 35.2831, GNorm = 2.0961, lr_0 = 2.1716e-04
Validation rmse = 0.120554
Validation r2 = 0.859055
Validation mse = 0.014533
Epoch 38
Loss = 8.0574e-02, PNorm = 35.2899, GNorm = 1.8780, lr_0 = 2.1149e-04
Validation rmse = 0.122024
Validation r2 = 0.855597
Validation mse = 0.014890
Epoch 39
Loss = 7.0204e-02, PNorm = 35.2977, GNorm = 1.2594, lr_0 = 2.0542e-04
Loss = 7.8496e-02, PNorm = 35.3051, GNorm = 1.3313, lr_0 = 2.0006e-04
Validation rmse = 0.122085
Validation r2 = 0.855453
Validation mse = 0.014905
Epoch 40
Loss = 8.1465e-02, PNorm = 35.3124, GNorm = 0.9379, lr_0 = 1.9483e-04
Validation rmse = 0.121071
Validation r2 = 0.857844
Validation mse = 0.014658
Epoch 41
Loss = 6.6003e-02, PNorm = 35.3202, GNorm = 0.5310, lr_0 = 1.8924e-04
Loss = 7.9571e-02, PNorm = 35.3274, GNorm = 0.5452, lr_0 = 1.8430e-04
Validation rmse = 0.121379
Validation r2 = 0.857119
Validation mse = 0.014733
Epoch 42
Loss = 6.5298e-02, PNorm = 35.3331, GNorm = 1.5207, lr_0 = 1.7948e-04
Validation rmse = 0.123190
Validation r2 = 0.852823
Validation mse = 0.015176
Epoch 43
Loss = 7.4673e-02, PNorm = 35.3409, GNorm = 0.9876, lr_0 = 1.7433e-04
Loss = 7.5385e-02, PNorm = 35.3470, GNorm = 1.0449, lr_0 = 1.6978e-04
Validation rmse = 0.124330
Validation r2 = 0.850087
Validation mse = 0.015458
Epoch 44
Loss = 7.5967e-02, PNorm = 35.3534, GNorm = 1.7548, lr_0 = 1.6534e-04
Loss = 7.4323e-02, PNorm = 35.3599, GNorm = 1.5403, lr_0 = 1.6103e-04
Validation rmse = 0.120820
Validation r2 = 0.858432
Validation mse = 0.014597
Epoch 45
Loss = 6.4983e-02, PNorm = 35.3662, GNorm = 1.2994, lr_0 = 1.5682e-04
Validation rmse = 0.122570
Validation r2 = 0.854302
Validation mse = 0.015023
Epoch 46
Loss = 7.1467e-02, PNorm = 35.3721, GNorm = 0.5501, lr_0 = 1.5232e-04
Loss = 7.4183e-02, PNorm = 35.3770, GNorm = 1.3302, lr_0 = 1.4834e-04
Validation rmse = 0.121271
Validation r2 = 0.857374
Validation mse = 0.014707
Epoch 47
Loss = 6.6505e-02, PNorm = 35.3815, GNorm = 2.1550, lr_0 = 1.4447e-04
Validation rmse = 0.121246
Validation r2 = 0.857431
Validation mse = 0.014701
Epoch 48
Loss = 5.3498e-02, PNorm = 35.3865, GNorm = 0.6142, lr_0 = 1.4032e-04
Loss = 7.1466e-02, PNorm = 35.3922, GNorm = 0.7107, lr_0 = 1.3666e-04
Validation rmse = 0.120737
Validation r2 = 0.858628
Validation mse = 0.014577
Epoch 49
Loss = 7.1580e-02, PNorm = 35.3966, GNorm = 0.5191, lr_0 = 1.3309e-04
Validation rmse = 0.121038
Validation r2 = 0.857921
Validation mse = 0.014650
Epoch 50
Loss = 7.3275e-02, PNorm = 35.4014, GNorm = 0.7037, lr_0 = 1.2961e-04
Loss = 6.7886e-02, PNorm = 35.4059, GNorm = 0.7173, lr_0 = 1.2623e-04
Validation rmse = 0.122687
Validation r2 = 0.854023
Validation mse = 0.015052
Epoch 51
Loss = 5.3727e-02, PNorm = 35.4104, GNorm = 1.6866, lr_0 = 1.2260e-04
Loss = 7.9563e-02, PNorm = 35.4139, GNorm = 0.6080, lr_0 = 1.1940e-04
Validation rmse = 0.124520
Validation r2 = 0.849629
Validation mse = 0.015505
Epoch 52
Loss = 7.0430e-02, PNorm = 35.4189, GNorm = 2.1316, lr_0 = 1.1628e-04
Validation rmse = 0.120672
Validation r2 = 0.858778
Validation mse = 0.014562
Epoch 53
Loss = 6.8905e-02, PNorm = 35.4233, GNorm = 2.8032, lr_0 = 1.1295e-04
Loss = 6.4319e-02, PNorm = 35.4272, GNorm = 0.9714, lr_0 = 1.1000e-04
Validation rmse = 0.122535
Validation r2 = 0.854383
Validation mse = 0.015015
Epoch 54
Loss = 6.3055e-02, PNorm = 35.4311, GNorm = 1.5129, lr_0 = 1.0712e-04
Validation rmse = 0.121176
Validation r2 = 0.857597
Validation mse = 0.014684
Epoch 55
Loss = 6.7321e-02, PNorm = 35.4355, GNorm = 0.7793, lr_0 = 1.0405e-04
Loss = 6.3117e-02, PNorm = 35.4392, GNorm = 0.5283, lr_0 = 1.0133e-04
Validation rmse = 0.120905
Validation r2 = 0.858233
Validation mse = 0.014618
Epoch 56
Loss = 6.1353e-02, PNorm = 35.4428, GNorm = 0.8013, lr_0 = 1.0000e-04
Validation rmse = 0.120930
Validation r2 = 0.858175
Validation mse = 0.014624
Epoch 57
Loss = 5.1182e-02, PNorm = 35.4460, GNorm = 1.6017, lr_0 = 1.0000e-04
Loss = 6.9539e-02, PNorm = 35.4488, GNorm = 0.5569, lr_0 = 1.0000e-04
Validation rmse = 0.121993
Validation r2 = 0.855669
Validation mse = 0.014882
Epoch 58
Loss = 6.7969e-02, PNorm = 35.4528, GNorm = 0.4366, lr_0 = 1.0000e-04
Validation rmse = 0.123440
Validation r2 = 0.852226
Validation mse = 0.015237
Epoch 59
Loss = 5.9830e-02, PNorm = 35.4568, GNorm = 1.7057, lr_0 = 1.0000e-04
Loss = 6.3725e-02, PNorm = 35.4602, GNorm = 0.4899, lr_0 = 1.0000e-04
Validation rmse = 0.120403
Validation r2 = 0.859409
Validation mse = 0.014497
Model 0 best validation rmse = 0.119825 on epoch 36
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.575920
Model 0 test r2 = -3.409036
Model 0 test mse = 0.331684
Ensemble test rmse = 0.575920
Ensemble test r2 = -3.409036
Ensemble test mse = 0.331684
Fold 2
Splitting data with seed 2
Total size = 974 | train size = 779 | val size = 195 | test size = 48
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.2698e-01, PNorm = 34.0174, GNorm = 3.7513, lr_0 = 4.3000e-04
Validation rmse = 0.295588
Validation r2 = 0.261528
Validation mse = 0.087372
Epoch 1
Loss = 6.7367e-01, PNorm = 34.0576, GNorm = 1.9559, lr_0 = 7.6000e-04
Loss = 6.6060e-01, PNorm = 34.1048, GNorm = 9.2685, lr_0 = 9.9472e-04
Validation rmse = 0.282457
Validation r2 = 0.325681
Validation mse = 0.079782
Epoch 2
Loss = 5.4577e-01, PNorm = 34.1654, GNorm = 5.4607, lr_0 = 9.6874e-04
Validation rmse = 0.215307
Validation r2 = 0.608190
Validation mse = 0.046357
Epoch 3
Loss = 3.2193e-01, PNorm = 34.2366, GNorm = 1.1392, lr_0 = 9.4094e-04
Loss = 3.3293e-01, PNorm = 34.2947, GNorm = 3.9490, lr_0 = 9.1637e-04
Validation rmse = 0.181398
Validation r2 = 0.721884
Validation mse = 0.032905
Epoch 4
Loss = 2.4166e-01, PNorm = 34.3467, GNorm = 3.8505, lr_0 = 8.9243e-04
Validation rmse = 0.167982
Validation r2 = 0.761501
Validation mse = 0.028218
Epoch 5
Loss = 1.7524e-01, PNorm = 34.3990, GNorm = 0.8838, lr_0 = 8.6682e-04
Loss = 2.3144e-01, PNorm = 34.4464, GNorm = 6.6780, lr_0 = 8.4418e-04
Validation rmse = 0.155664
Validation r2 = 0.795197
Validation mse = 0.024231
Epoch 6
Loss = 2.2202e-01, PNorm = 34.4867, GNorm = 3.0379, lr_0 = 8.2213e-04
Validation rmse = 0.167318
Validation r2 = 0.763383
Validation mse = 0.027995
Epoch 7
Loss = 1.8782e-01, PNorm = 34.5207, GNorm = 6.0081, lr_0 = 8.0066e-04
Loss = 1.7666e-01, PNorm = 34.5517, GNorm = 4.1435, lr_0 = 7.7975e-04
Validation rmse = 0.174192
Validation r2 = 0.743541
Validation mse = 0.030343
Epoch 8
Loss = 2.0841e-01, PNorm = 34.5923, GNorm = 0.7957, lr_0 = 7.5737e-04
Loss = 1.5358e-01, PNorm = 34.6240, GNorm = 6.3408, lr_0 = 7.3759e-04
Validation rmse = 0.139728
Validation r2 = 0.834983
Validation mse = 0.019524
Epoch 9
Loss = 1.6067e-01, PNorm = 34.6530, GNorm = 1.1058, lr_0 = 7.1833e-04
Validation rmse = 0.139077
Validation r2 = 0.836517
Validation mse = 0.019342
Epoch 10
Loss = 1.1959e-01, PNorm = 34.6784, GNorm = 1.2137, lr_0 = 6.9772e-04
Loss = 1.4353e-01, PNorm = 34.7011, GNorm = 0.7703, lr_0 = 6.7949e-04
Validation rmse = 0.147207
Validation r2 = 0.816846
Validation mse = 0.021670
Epoch 11
Loss = 1.5799e-01, PNorm = 34.7247, GNorm = 1.6872, lr_0 = 6.6174e-04
Validation rmse = 0.143862
Validation r2 = 0.825074
Validation mse = 0.020696
Epoch 12
Loss = 1.5119e-01, PNorm = 34.7470, GNorm = 1.5792, lr_0 = 6.4276e-04
Loss = 1.3291e-01, PNorm = 34.7706, GNorm = 2.8805, lr_0 = 6.2597e-04
Validation rmse = 0.132487
Validation r2 = 0.851644
Validation mse = 0.017553
Epoch 13
Loss = 1.2561e-01, PNorm = 34.7917, GNorm = 0.6479, lr_0 = 6.0962e-04
Validation rmse = 0.140171
Validation r2 = 0.833936
Validation mse = 0.019648
Epoch 14
Loss = 1.5179e-01, PNorm = 34.8096, GNorm = 2.8367, lr_0 = 5.9369e-04
Loss = 1.1713e-01, PNorm = 34.8251, GNorm = 4.0186, lr_0 = 5.7819e-04
Validation rmse = 0.141480
Validation r2 = 0.830821
Validation mse = 0.020016
Epoch 15
Loss = 1.5327e-01, PNorm = 34.8466, GNorm = 3.4542, lr_0 = 5.6160e-04
Validation rmse = 0.149392
Validation r2 = 0.811367
Validation mse = 0.022318
Epoch 16
Loss = 2.0169e-01, PNorm = 34.8654, GNorm = 3.7787, lr_0 = 5.4693e-04
Loss = 1.3004e-01, PNorm = 34.8822, GNorm = 3.4038, lr_0 = 5.3264e-04
Validation rmse = 0.128518
Validation r2 = 0.860399
Validation mse = 0.016517
Epoch 17
Loss = 1.0753e-01, PNorm = 34.8985, GNorm = 1.4091, lr_0 = 5.1736e-04
Loss = 1.2131e-01, PNorm = 34.9156, GNorm = 2.4944, lr_0 = 5.0385e-04
Validation rmse = 0.136758
Validation r2 = 0.841924
Validation mse = 0.018703
Epoch 18
Loss = 1.0971e-01, PNorm = 34.9240, GNorm = 1.0769, lr_0 = 4.9069e-04
Validation rmse = 0.139751
Validation r2 = 0.834928
Validation mse = 0.019530
Epoch 19
Loss = 9.1206e-02, PNorm = 34.9378, GNorm = 0.3696, lr_0 = 4.7787e-04
Loss = 1.1866e-01, PNorm = 34.9512, GNorm = 1.2534, lr_0 = 4.6539e-04
Validation rmse = 0.134621
Validation r2 = 0.846826
Validation mse = 0.018123
Epoch 20
Loss = 1.0138e-01, PNorm = 34.9710, GNorm = 0.6525, lr_0 = 4.5204e-04
Validation rmse = 0.129466
Validation r2 = 0.858331
Validation mse = 0.016762
Epoch 21
Loss = 9.8151e-02, PNorm = 34.9820, GNorm = 2.7305, lr_0 = 4.4023e-04
Loss = 1.1481e-01, PNorm = 34.9929, GNorm = 1.7703, lr_0 = 4.2873e-04
Validation rmse = 0.131590
Validation r2 = 0.853647
Validation mse = 0.017316
Epoch 22
Loss = 9.6618e-02, PNorm = 35.0085, GNorm = 0.8312, lr_0 = 4.1643e-04
Validation rmse = 0.131980
Validation r2 = 0.852776
Validation mse = 0.017419
Epoch 23
Loss = 9.3346e-02, PNorm = 35.0204, GNorm = 0.9950, lr_0 = 4.0555e-04
Loss = 9.1661e-02, PNorm = 35.0291, GNorm = 1.1827, lr_0 = 3.9496e-04
Validation rmse = 0.133689
Validation r2 = 0.848939
Validation mse = 0.017873
Epoch 24
Loss = 1.0440e-01, PNorm = 35.0419, GNorm = 1.7716, lr_0 = 3.8363e-04
Validation rmse = 0.129030
Validation r2 = 0.859286
Validation mse = 0.016649
Epoch 25
Loss = 9.2229e-02, PNorm = 35.0533, GNorm = 1.1211, lr_0 = 3.7361e-04
Loss = 9.5825e-02, PNorm = 35.0647, GNorm = 1.0101, lr_0 = 3.6385e-04
Validation rmse = 0.128397
Validation r2 = 0.860663
Validation mse = 0.016486
Epoch 26
Loss = 9.5545e-02, PNorm = 35.0756, GNorm = 2.5234, lr_0 = 3.5434e-04
Loss = 9.9145e-02, PNorm = 35.0846, GNorm = 1.1859, lr_0 = 3.4509e-04
Loss = 1.3530e-01, PNorm = 35.0857, GNorm = 1.2111, lr_0 = 3.4418e-04
Validation rmse = 0.133619
Validation r2 = 0.849098
Validation mse = 0.017854
Epoch 27
Loss = 9.0359e-02, PNorm = 35.0961, GNorm = 2.0683, lr_0 = 3.3519e-04
Validation rmse = 0.135322
Validation r2 = 0.845227
Validation mse = 0.018312
Epoch 28
Loss = 8.4671e-02, PNorm = 35.1060, GNorm = 1.7019, lr_0 = 3.2643e-04
Loss = 1.0253e-01, PNorm = 35.1163, GNorm = 1.2879, lr_0 = 3.1791e-04
Validation rmse = 0.132391
Validation r2 = 0.851858
Validation mse = 0.017527
Epoch 29
Loss = 1.0127e-01, PNorm = 35.1268, GNorm = 0.7345, lr_0 = 3.0878e-04
Validation rmse = 0.129963
Validation r2 = 0.857243
Validation mse = 0.016890
Epoch 30
Loss = 8.4890e-02, PNorm = 35.1371, GNorm = 1.5245, lr_0 = 3.0072e-04
Loss = 9.7348e-02, PNorm = 35.1483, GNorm = 0.6703, lr_0 = 2.9286e-04
Validation rmse = 0.129434
Validation r2 = 0.858402
Validation mse = 0.016753
Epoch 31
Loss = 8.0770e-02, PNorm = 35.1571, GNorm = 0.5435, lr_0 = 2.8446e-04
Validation rmse = 0.128031
Validation r2 = 0.861456
Validation mse = 0.016392
Epoch 32
Loss = 9.4541e-02, PNorm = 35.1661, GNorm = 0.5886, lr_0 = 2.7703e-04
Loss = 8.9491e-02, PNorm = 35.1722, GNorm = 2.4726, lr_0 = 2.6980e-04
Validation rmse = 0.137067
Validation r2 = 0.841210
Validation mse = 0.018787
Epoch 33
Loss = 9.4213e-02, PNorm = 35.1808, GNorm = 1.3890, lr_0 = 2.6275e-04
Validation rmse = 0.135065
Validation r2 = 0.845813
Validation mse = 0.018243
Epoch 34
Loss = 6.7127e-02, PNorm = 35.1891, GNorm = 0.7842, lr_0 = 2.5521e-04
Loss = 9.1237e-02, PNorm = 35.1965, GNorm = 0.4772, lr_0 = 2.4854e-04
Validation rmse = 0.131651
Validation r2 = 0.853511
Validation mse = 0.017332
Epoch 35
Loss = 8.6914e-02, PNorm = 35.2045, GNorm = 1.3593, lr_0 = 2.4205e-04
Loss = 8.0358e-02, PNorm = 35.2115, GNorm = 1.0745, lr_0 = 2.3573e-04
Loss = 1.3481e-01, PNorm = 35.2121, GNorm = 1.2166, lr_0 = 2.3511e-04
Validation rmse = 0.130211
Validation r2 = 0.856696
Validation mse = 0.016955
Epoch 36
Loss = 7.7442e-02, PNorm = 35.2186, GNorm = 1.1689, lr_0 = 2.2897e-04
Validation rmse = 0.128875
Validation r2 = 0.859622
Validation mse = 0.016609
Epoch 37
Loss = 7.4583e-02, PNorm = 35.2250, GNorm = 0.7339, lr_0 = 2.2299e-04
Loss = 8.6513e-02, PNorm = 35.2313, GNorm = 0.6297, lr_0 = 2.1716e-04
Validation rmse = 0.127889
Validation r2 = 0.861763
Validation mse = 0.016356
Epoch 38
Loss = 7.6653e-02, PNorm = 35.2378, GNorm = 2.4464, lr_0 = 2.1149e-04
Validation rmse = 0.129748
Validation r2 = 0.857714
Validation mse = 0.016835
Epoch 39
Loss = 8.3576e-02, PNorm = 35.2459, GNorm = 0.7757, lr_0 = 2.0542e-04
Loss = 8.4563e-02, PNorm = 35.2521, GNorm = 0.5110, lr_0 = 2.0006e-04
Validation rmse = 0.134482
Validation r2 = 0.847142
Validation mse = 0.018085
Epoch 40
Loss = 9.3826e-02, PNorm = 35.2568, GNorm = 0.9333, lr_0 = 1.9483e-04
Validation rmse = 0.128899
Validation r2 = 0.859570
Validation mse = 0.016615
Epoch 41
Loss = 7.1767e-02, PNorm = 35.2622, GNorm = 0.9917, lr_0 = 1.8924e-04
Loss = 9.1778e-02, PNorm = 35.2676, GNorm = 2.3530, lr_0 = 1.8430e-04
Validation rmse = 0.134093
Validation r2 = 0.848026
Validation mse = 0.017981
Epoch 42
Loss = 8.4442e-02, PNorm = 35.2730, GNorm = 0.8649, lr_0 = 1.7948e-04
Validation rmse = 0.128993
Validation r2 = 0.859366
Validation mse = 0.016639
Epoch 43
Loss = 1.0501e-01, PNorm = 35.2791, GNorm = 0.9106, lr_0 = 1.7433e-04
Loss = 8.1952e-02, PNorm = 35.2843, GNorm = 1.3205, lr_0 = 1.6978e-04
Validation rmse = 0.128357
Validation r2 = 0.860750
Validation mse = 0.016475
Epoch 44
Loss = 8.0220e-02, PNorm = 35.2896, GNorm = 0.9765, lr_0 = 1.6534e-04
Loss = 7.5570e-02, PNorm = 35.2938, GNorm = 1.2540, lr_0 = 1.6103e-04
Validation rmse = 0.135744
Validation r2 = 0.844261
Validation mse = 0.018426
Epoch 45
Loss = 8.5869e-02, PNorm = 35.2987, GNorm = 0.7576, lr_0 = 1.5682e-04
Validation rmse = 0.128072
Validation r2 = 0.861367
Validation mse = 0.016402
Epoch 46
Loss = 6.9359e-02, PNorm = 35.3043, GNorm = 0.9979, lr_0 = 1.5232e-04
Loss = 8.2614e-02, PNorm = 35.3090, GNorm = 0.7359, lr_0 = 1.4834e-04
Validation rmse = 0.129361
Validation r2 = 0.858562
Validation mse = 0.016734
Epoch 47
Loss = 8.1898e-02, PNorm = 35.3144, GNorm = 2.1111, lr_0 = 1.4447e-04
Validation rmse = 0.129674
Validation r2 = 0.857876
Validation mse = 0.016815
Epoch 48
Loss = 7.5807e-02, PNorm = 35.3190, GNorm = 0.6191, lr_0 = 1.4032e-04
Loss = 7.3159e-02, PNorm = 35.3228, GNorm = 2.1378, lr_0 = 1.3666e-04
Validation rmse = 0.130168
Validation r2 = 0.856791
Validation mse = 0.016944
Epoch 49
Loss = 7.6763e-02, PNorm = 35.3274, GNorm = 0.9308, lr_0 = 1.3309e-04
Validation rmse = 0.129559
Validation r2 = 0.858129
Validation mse = 0.016786
Epoch 50
Loss = 5.3252e-02, PNorm = 35.3313, GNorm = 0.8125, lr_0 = 1.2961e-04
Loss = 7.5368e-02, PNorm = 35.3359, GNorm = 1.5059, lr_0 = 1.2623e-04
Validation rmse = 0.128825
Validation r2 = 0.859732
Validation mse = 0.016596
Epoch 51
Loss = 6.9171e-02, PNorm = 35.3397, GNorm = 0.4268, lr_0 = 1.2260e-04
Loss = 7.8634e-02, PNorm = 35.3427, GNorm = 1.7852, lr_0 = 1.1940e-04
Validation rmse = 0.130246
Validation r2 = 0.856619
Validation mse = 0.016964
Epoch 52
Loss = 7.6659e-02, PNorm = 35.3466, GNorm = 0.5219, lr_0 = 1.1628e-04
Validation rmse = 0.127679
Validation r2 = 0.862216
Validation mse = 0.016302
Epoch 53
Loss = 6.8015e-02, PNorm = 35.3509, GNorm = 1.3179, lr_0 = 1.1295e-04
Loss = 7.7285e-02, PNorm = 35.3543, GNorm = 0.4771, lr_0 = 1.1000e-04
Validation rmse = 0.128031
Validation r2 = 0.861454
Validation mse = 0.016392
Epoch 54
Loss = 6.4674e-02, PNorm = 35.3577, GNorm = 1.2453, lr_0 = 1.0712e-04
Validation rmse = 0.129015
Validation r2 = 0.859317
Validation mse = 0.016645
Epoch 55
Loss = 6.7902e-02, PNorm = 35.3610, GNorm = 1.4257, lr_0 = 1.0405e-04
Loss = 7.6195e-02, PNorm = 35.3643, GNorm = 2.0689, lr_0 = 1.0133e-04
Validation rmse = 0.128602
Validation r2 = 0.860218
Validation mse = 0.016538
Epoch 56
Loss = 7.5145e-02, PNorm = 35.3674, GNorm = 0.9735, lr_0 = 1.0000e-04
Validation rmse = 0.128124
Validation r2 = 0.861253
Validation mse = 0.016416
Epoch 57
Loss = 8.6371e-02, PNorm = 35.3705, GNorm = 1.3499, lr_0 = 1.0000e-04
Loss = 6.9192e-02, PNorm = 35.3737, GNorm = 0.6977, lr_0 = 1.0000e-04
Validation rmse = 0.127288
Validation r2 = 0.863060
Validation mse = 0.016202
Epoch 58
Loss = 7.9771e-02, PNorm = 35.3773, GNorm = 2.0657, lr_0 = 1.0000e-04
Validation rmse = 0.128547
Validation r2 = 0.860337
Validation mse = 0.016524
Epoch 59
Loss = 1.0445e-01, PNorm = 35.3803, GNorm = 1.0688, lr_0 = 1.0000e-04
Loss = 6.7743e-02, PNorm = 35.3831, GNorm = 1.6580, lr_0 = 1.0000e-04
Validation rmse = 0.126350
Validation r2 = 0.865069
Validation mse = 0.015964
Model 0 best validation rmse = 0.126350 on epoch 59
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.557234
Model 0 test r2 = -3.127567
Model 0 test mse = 0.310510
Ensemble test rmse = 0.557234
Ensemble test r2 = -3.127567
Ensemble test mse = 0.310510
Fold 3
Splitting data with seed 3
Total size = 974 | train size = 779 | val size = 195 | test size = 48
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1234e-01, PNorm = 34.0167, GNorm = 0.9064, lr_0 = 4.3000e-04
Validation rmse = 0.281858
Validation r2 = 0.270536
Validation mse = 0.079444
Epoch 1
Loss = 8.2646e-01, PNorm = 34.0450, GNorm = 4.5425, lr_0 = 7.6000e-04
Loss = 6.5440e-01, PNorm = 34.0978, GNorm = 5.8250, lr_0 = 9.9472e-04
Validation rmse = 0.221323
Validation r2 = 0.550223
Validation mse = 0.048984
Epoch 2
Loss = 4.5224e-01, PNorm = 34.1721, GNorm = 5.0115, lr_0 = 9.6874e-04
Validation rmse = 0.185949
Validation r2 = 0.682509
Validation mse = 0.034577
Epoch 3
Loss = 3.1313e-01, PNorm = 34.2435, GNorm = 1.2587, lr_0 = 9.4094e-04
Loss = 3.1987e-01, PNorm = 34.3068, GNorm = 1.0187, lr_0 = 9.1637e-04
Validation rmse = 0.174147
Validation r2 = 0.721533
Validation mse = 0.030327
Epoch 4
Loss = 3.3411e-01, PNorm = 34.3503, GNorm = 0.9273, lr_0 = 8.9243e-04
Validation rmse = 0.152964
Validation r2 = 0.785158
Validation mse = 0.023398
Epoch 5
Loss = 3.3254e-01, PNorm = 34.3998, GNorm = 6.3115, lr_0 = 8.6682e-04
Loss = 2.6022e-01, PNorm = 34.4354, GNorm = 4.5940, lr_0 = 8.4418e-04
Validation rmse = 0.144008
Validation r2 = 0.809578
Validation mse = 0.020738
Epoch 6
Loss = 2.1844e-01, PNorm = 34.4765, GNorm = 1.4077, lr_0 = 8.2213e-04
Validation rmse = 0.127777
Validation r2 = 0.850083
Validation mse = 0.016327
Epoch 7
Loss = 2.0737e-01, PNorm = 34.5144, GNorm = 2.1117, lr_0 = 8.0066e-04
Loss = 2.0959e-01, PNorm = 34.5496, GNorm = 1.0055, lr_0 = 7.7975e-04
Validation rmse = 0.136087
Validation r2 = 0.829951
Validation mse = 0.018520
Epoch 8
Loss = 1.5265e-01, PNorm = 34.5788, GNorm = 1.8878, lr_0 = 7.5737e-04
Loss = 1.6920e-01, PNorm = 34.6100, GNorm = 2.9029, lr_0 = 7.3759e-04
Validation rmse = 0.121465
Validation r2 = 0.864528
Validation mse = 0.014754
Epoch 9
Loss = 1.6143e-01, PNorm = 34.6414, GNorm = 4.2828, lr_0 = 7.1833e-04
Validation rmse = 0.122808
Validation r2 = 0.861517
Validation mse = 0.015082
Epoch 10
Loss = 1.3689e-01, PNorm = 34.6686, GNorm = 1.9961, lr_0 = 6.9772e-04
Loss = 1.4163e-01, PNorm = 34.6927, GNorm = 0.8690, lr_0 = 6.7949e-04
Validation rmse = 0.121616
Validation r2 = 0.864193
Validation mse = 0.014790
Epoch 11
Loss = 1.3025e-01, PNorm = 34.7193, GNorm = 1.5241, lr_0 = 6.6174e-04
Validation rmse = 0.118506
Validation r2 = 0.871049
Validation mse = 0.014044
Epoch 12
Loss = 1.5291e-01, PNorm = 34.7431, GNorm = 2.8408, lr_0 = 6.4276e-04
Loss = 1.2822e-01, PNorm = 34.7590, GNorm = 2.3944, lr_0 = 6.2597e-04
Validation rmse = 0.126281
Validation r2 = 0.853574
Validation mse = 0.015947
Epoch 13
Loss = 1.5603e-01, PNorm = 34.7786, GNorm = 2.5339, lr_0 = 6.0962e-04
Validation rmse = 0.119485
Validation r2 = 0.868910
Validation mse = 0.014277
Epoch 14
Loss = 1.3185e-01, PNorm = 34.7979, GNorm = 2.6061, lr_0 = 5.9369e-04
Loss = 1.3462e-01, PNorm = 34.8188, GNorm = 4.0483, lr_0 = 5.7819e-04
Validation rmse = 0.123058
Validation r2 = 0.860952
Validation mse = 0.015143
Epoch 15
Loss = 1.1608e-01, PNorm = 34.8342, GNorm = 1.6179, lr_0 = 5.6160e-04
Validation rmse = 0.114529
Validation r2 = 0.879559
Validation mse = 0.013117
Epoch 16
Loss = 1.3099e-01, PNorm = 34.8519, GNorm = 2.4047, lr_0 = 5.4693e-04
Loss = 1.3070e-01, PNorm = 34.8722, GNorm = 2.5487, lr_0 = 5.3264e-04
Validation rmse = 0.125478
Validation r2 = 0.855429
Validation mse = 0.015745
Epoch 17
Loss = 1.1118e-01, PNorm = 34.8887, GNorm = 3.6962, lr_0 = 5.1736e-04
Loss = 1.2013e-01, PNorm = 34.9014, GNorm = 0.8272, lr_0 = 5.0385e-04
Validation rmse = 0.123104
Validation r2 = 0.860850
Validation mse = 0.015154
Epoch 18
Loss = 1.0577e-01, PNorm = 34.9183, GNorm = 2.4367, lr_0 = 4.9069e-04
Validation rmse = 0.117234
Validation r2 = 0.873803
Validation mse = 0.013744
Epoch 19
Loss = 1.1323e-01, PNorm = 34.9327, GNorm = 1.0201, lr_0 = 4.7787e-04
Loss = 1.2232e-01, PNorm = 34.9472, GNorm = 1.1582, lr_0 = 4.6539e-04
Validation rmse = 0.123535
Validation r2 = 0.859872
Validation mse = 0.015261
Epoch 20
Loss = 1.2237e-01, PNorm = 34.9594, GNorm = 1.2262, lr_0 = 4.5204e-04
Validation rmse = 0.113365
Validation r2 = 0.881995
Validation mse = 0.012852
Epoch 21
Loss = 1.3938e-01, PNorm = 34.9710, GNorm = 3.4562, lr_0 = 4.4023e-04
Loss = 1.0367e-01, PNorm = 34.9860, GNorm = 0.7888, lr_0 = 4.2873e-04
Validation rmse = 0.107996
Validation r2 = 0.892907
Validation mse = 0.011663
Epoch 22
Loss = 1.2463e-01, PNorm = 34.9976, GNorm = 1.3198, lr_0 = 4.1643e-04
Validation rmse = 0.115338
Validation r2 = 0.877851
Validation mse = 0.013303
Epoch 23
Loss = 1.3114e-01, PNorm = 35.0086, GNorm = 1.3354, lr_0 = 4.0555e-04
Loss = 9.4476e-02, PNorm = 35.0232, GNorm = 0.6365, lr_0 = 3.9496e-04
Validation rmse = 0.120321
Validation r2 = 0.867068
Validation mse = 0.014477
Epoch 24
Loss = 8.8886e-02, PNorm = 35.0351, GNorm = 0.6081, lr_0 = 3.8363e-04
Validation rmse = 0.109642
Validation r2 = 0.889617
Validation mse = 0.012021
Epoch 25
Loss = 1.6879e-01, PNorm = 35.0458, GNorm = 1.7461, lr_0 = 3.7361e-04
Loss = 1.0522e-01, PNorm = 35.0557, GNorm = 0.7247, lr_0 = 3.6385e-04
Validation rmse = 0.113150
Validation r2 = 0.882442
Validation mse = 0.012803
Epoch 26
Loss = 1.0773e-01, PNorm = 35.0674, GNorm = 1.0099, lr_0 = 3.5434e-04
Loss = 1.0968e-01, PNorm = 35.0801, GNorm = 1.5678, lr_0 = 3.4509e-04
Loss = 1.0349e-01, PNorm = 35.0813, GNorm = 1.0453, lr_0 = 3.4418e-04
Validation rmse = 0.111165
Validation r2 = 0.886531
Validation mse = 0.012358
Epoch 27
Loss = 1.0396e-01, PNorm = 35.0938, GNorm = 1.7382, lr_0 = 3.3519e-04
Validation rmse = 0.126267
Validation r2 = 0.853605
Validation mse = 0.015943
Epoch 28
Loss = 1.0381e-01, PNorm = 35.1047, GNorm = 1.3415, lr_0 = 3.2643e-04
Loss = 1.0516e-01, PNorm = 35.1132, GNorm = 3.2360, lr_0 = 3.1791e-04
Validation rmse = 0.114045
Validation r2 = 0.880576
Validation mse = 0.013006
Epoch 29
Loss = 1.1468e-01, PNorm = 35.1256, GNorm = 1.1765, lr_0 = 3.0878e-04
Validation rmse = 0.110215
Validation r2 = 0.888461
Validation mse = 0.012147
Epoch 30
Loss = 7.5671e-02, PNorm = 35.1356, GNorm = 1.1484, lr_0 = 3.0072e-04
Loss = 1.0155e-01, PNorm = 35.1428, GNorm = 1.5381, lr_0 = 2.9286e-04
Validation rmse = 0.110624
Validation r2 = 0.887632
Validation mse = 0.012238
Epoch 31
Loss = 8.0653e-02, PNorm = 35.1543, GNorm = 1.1529, lr_0 = 2.8446e-04
Validation rmse = 0.111128
Validation r2 = 0.886607
Validation mse = 0.012349
Epoch 32
Loss = 1.0340e-01, PNorm = 35.1622, GNorm = 1.2552, lr_0 = 2.7703e-04
Loss = 1.0671e-01, PNorm = 35.1700, GNorm = 2.7907, lr_0 = 2.6980e-04
Validation rmse = 0.117847
Validation r2 = 0.872480
Validation mse = 0.013888
Epoch 33
Loss = 1.1021e-01, PNorm = 35.1797, GNorm = 3.2110, lr_0 = 2.6275e-04
Validation rmse = 0.111207
Validation r2 = 0.886444
Validation mse = 0.012367
Epoch 34
Loss = 1.0263e-01, PNorm = 35.1897, GNorm = 1.1418, lr_0 = 2.5521e-04
Loss = 9.0766e-02, PNorm = 35.1982, GNorm = 1.8017, lr_0 = 2.4854e-04
Validation rmse = 0.108878
Validation r2 = 0.891151
Validation mse = 0.011854
Epoch 35
Loss = 7.7721e-02, PNorm = 35.2051, GNorm = 2.6639, lr_0 = 2.4205e-04
Loss = 1.0106e-01, PNorm = 35.2122, GNorm = 2.2382, lr_0 = 2.3573e-04
Loss = 1.0117e-01, PNorm = 35.2132, GNorm = 1.3104, lr_0 = 2.3511e-04
Validation rmse = 0.114540
Validation r2 = 0.879536
Validation mse = 0.013119
Epoch 36
Loss = 8.2163e-02, PNorm = 35.2225, GNorm = 2.3638, lr_0 = 2.2897e-04
Validation rmse = 0.112847
Validation r2 = 0.883071
Validation mse = 0.012734
Epoch 37
Loss = 9.0180e-02, PNorm = 35.2285, GNorm = 2.5411, lr_0 = 2.2299e-04
Loss = 1.0489e-01, PNorm = 35.2361, GNorm = 2.4253, lr_0 = 2.1716e-04
Validation rmse = 0.114072
Validation r2 = 0.880519
Validation mse = 0.013012
Epoch 38
Loss = 1.0072e-01, PNorm = 35.2448, GNorm = 4.5331, lr_0 = 2.1149e-04
Validation rmse = 0.120345
Validation r2 = 0.867016
Validation mse = 0.014483
Epoch 39
Loss = 1.1359e-01, PNorm = 35.2534, GNorm = 4.5776, lr_0 = 2.0542e-04
Loss = 9.2091e-02, PNorm = 35.2589, GNorm = 1.7867, lr_0 = 2.0006e-04
Validation rmse = 0.112092
Validation r2 = 0.884630
Validation mse = 0.012565
Epoch 40
Loss = 9.3863e-02, PNorm = 35.2649, GNorm = 0.6492, lr_0 = 1.9483e-04
Validation rmse = 0.107199
Validation r2 = 0.894482
Validation mse = 0.011492
Epoch 41
Loss = 9.0144e-02, PNorm = 35.2724, GNorm = 0.8623, lr_0 = 1.8924e-04
Loss = 8.6845e-02, PNorm = 35.2787, GNorm = 1.9498, lr_0 = 1.8430e-04
Validation rmse = 0.110961
Validation r2 = 0.886946
Validation mse = 0.012312
Epoch 42
Loss = 7.3942e-02, PNorm = 35.2851, GNorm = 1.3196, lr_0 = 1.7948e-04
Validation rmse = 0.109449
Validation r2 = 0.890006
Validation mse = 0.011979
Epoch 43
Loss = 5.5182e-02, PNorm = 35.2916, GNorm = 0.7300, lr_0 = 1.7433e-04
Loss = 7.8019e-02, PNorm = 35.2970, GNorm = 1.8981, lr_0 = 1.6978e-04
Validation rmse = 0.110609
Validation r2 = 0.887662
Validation mse = 0.012234
Epoch 44
Loss = 6.3158e-02, PNorm = 35.3031, GNorm = 0.9196, lr_0 = 1.6534e-04
Loss = 9.1636e-02, PNorm = 35.3090, GNorm = 0.5640, lr_0 = 1.6103e-04
Validation rmse = 0.114631
Validation r2 = 0.879345
Validation mse = 0.013140
Epoch 45
Loss = 8.1248e-02, PNorm = 35.3143, GNorm = 1.4845, lr_0 = 1.5682e-04
Validation rmse = 0.111684
Validation r2 = 0.885468
Validation mse = 0.012473
Epoch 46
Loss = 9.2358e-02, PNorm = 35.3198, GNorm = 0.8306, lr_0 = 1.5232e-04
Loss = 7.2245e-02, PNorm = 35.3242, GNorm = 0.9937, lr_0 = 1.4834e-04
Validation rmse = 0.107525
Validation r2 = 0.893839
Validation mse = 0.011562
Epoch 47
Loss = 8.6693e-02, PNorm = 35.3292, GNorm = 2.2858, lr_0 = 1.4447e-04
Validation rmse = 0.108431
Validation r2 = 0.892043
Validation mse = 0.011757
Epoch 48
Loss = 7.5657e-02, PNorm = 35.3343, GNorm = 0.8067, lr_0 = 1.4032e-04
Loss = 7.7943e-02, PNorm = 35.3391, GNorm = 0.6948, lr_0 = 1.3666e-04
Validation rmse = 0.115538
Validation r2 = 0.877427
Validation mse = 0.013349
Epoch 49
Loss = 8.4804e-02, PNorm = 35.3447, GNorm = 2.0896, lr_0 = 1.3309e-04
Validation rmse = 0.111440
Validation r2 = 0.885968
Validation mse = 0.012419
Epoch 50
Loss = 6.6826e-02, PNorm = 35.3486, GNorm = 1.5459, lr_0 = 1.2961e-04
Loss = 6.9255e-02, PNorm = 35.3532, GNorm = 1.1081, lr_0 = 1.2623e-04
Validation rmse = 0.108730
Validation r2 = 0.891446
Validation mse = 0.011822
Epoch 51
Loss = 7.3096e-02, PNorm = 35.3577, GNorm = 0.7957, lr_0 = 1.2260e-04
Loss = 7.7977e-02, PNorm = 35.3621, GNorm = 1.1469, lr_0 = 1.1940e-04
Validation rmse = 0.108587
Validation r2 = 0.891733
Validation mse = 0.011791
Epoch 52
Loss = 7.2387e-02, PNorm = 35.3664, GNorm = 2.5415, lr_0 = 1.1628e-04
Validation rmse = 0.108665
Validation r2 = 0.891577
Validation mse = 0.011808
Epoch 53
Loss = 6.9972e-02, PNorm = 35.3705, GNorm = 1.4989, lr_0 = 1.1295e-04
Loss = 8.3865e-02, PNorm = 35.3743, GNorm = 1.8279, lr_0 = 1.1000e-04
Validation rmse = 0.118150
Validation r2 = 0.871822
Validation mse = 0.013959
Epoch 54
Loss = 8.0633e-02, PNorm = 35.3777, GNorm = 2.4175, lr_0 = 1.0712e-04
Validation rmse = 0.106877
Validation r2 = 0.895116
Validation mse = 0.011423
Epoch 55
Loss = 6.8391e-02, PNorm = 35.3823, GNorm = 0.8984, lr_0 = 1.0405e-04
Loss = 7.5770e-02, PNorm = 35.3864, GNorm = 1.0470, lr_0 = 1.0133e-04
Validation rmse = 0.110630
Validation r2 = 0.887620
Validation mse = 0.012239
Epoch 56
Loss = 7.2489e-02, PNorm = 35.3900, GNorm = 1.0074, lr_0 = 1.0000e-04
Validation rmse = 0.115092
Validation r2 = 0.878373
Validation mse = 0.013246
Epoch 57
Loss = 8.4573e-02, PNorm = 35.3934, GNorm = 1.5995, lr_0 = 1.0000e-04
Loss = 6.8727e-02, PNorm = 35.3960, GNorm = 1.0089, lr_0 = 1.0000e-04
Validation rmse = 0.110085
Validation r2 = 0.888725
Validation mse = 0.012119
Epoch 58
Loss = 7.0631e-02, PNorm = 35.4006, GNorm = 2.2033, lr_0 = 1.0000e-04
Validation rmse = 0.108903
Validation r2 = 0.891101
Validation mse = 0.011860
Epoch 59
Loss = 8.4372e-02, PNorm = 35.4041, GNorm = 0.4037, lr_0 = 1.0000e-04
Loss = 7.7806e-02, PNorm = 35.4074, GNorm = 1.3870, lr_0 = 1.0000e-04
Validation rmse = 0.111188
Validation r2 = 0.886483
Validation mse = 0.012363
Model 0 best validation rmse = 0.106877 on epoch 54
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.568788
Model 0 test r2 = -3.300514
Model 0 test mse = 0.323520
Ensemble test rmse = 0.568788
Ensemble test r2 = -3.300514
Ensemble test mse = 0.323520
Fold 4
Splitting data with seed 4
Total size = 974 | train size = 779 | val size = 195 | test size = 48
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.5182e-01, PNorm = 34.0158, GNorm = 4.2373, lr_0 = 4.3000e-04
Validation rmse = 0.315789
Validation r2 = 0.265373
Validation mse = 0.099723
Epoch 1
Loss = 6.9437e-01, PNorm = 34.0472, GNorm = 6.5796, lr_0 = 7.6000e-04
Loss = 5.6916e-01, PNorm = 34.1107, GNorm = 4.5915, lr_0 = 9.9472e-04
Validation rmse = 0.235045
Validation r2 = 0.593018
Validation mse = 0.055246
Epoch 2
Loss = 4.3312e-01, PNorm = 34.1896, GNorm = 6.9596, lr_0 = 9.6874e-04
Validation rmse = 0.217570
Validation r2 = 0.651284
Validation mse = 0.047337
Epoch 3
Loss = 4.1031e-01, PNorm = 34.2536, GNorm = 5.0520, lr_0 = 9.4094e-04
Loss = 3.6938e-01, PNorm = 34.3035, GNorm = 11.2859, lr_0 = 9.1637e-04
Validation rmse = 0.255947
Validation r2 = 0.517417
Validation mse = 0.065509
Epoch 4
Loss = 4.3346e-01, PNorm = 34.3450, GNorm = 3.7955, lr_0 = 8.9243e-04
Validation rmse = 0.169499
Validation r2 = 0.788357
Validation mse = 0.028730
Epoch 5
Loss = 2.4844e-01, PNorm = 34.3919, GNorm = 4.9002, lr_0 = 8.6682e-04
Loss = 2.7419e-01, PNorm = 34.4301, GNorm = 3.2969, lr_0 = 8.4418e-04
Validation rmse = 0.190406
Validation r2 = 0.732925
Validation mse = 0.036254
Epoch 6
Loss = 2.4714e-01, PNorm = 34.4632, GNorm = 1.7041, lr_0 = 8.2213e-04
Validation rmse = 0.155619
Validation r2 = 0.821599
Validation mse = 0.024217
Epoch 7
Loss = 1.9327e-01, PNorm = 34.4986, GNorm = 1.2175, lr_0 = 8.0066e-04
Loss = 1.8240e-01, PNorm = 34.5291, GNorm = 1.6003, lr_0 = 7.7975e-04
Validation rmse = 0.145737
Validation r2 = 0.843536
Validation mse = 0.021239
Epoch 8
Loss = 1.3910e-01, PNorm = 34.5632, GNorm = 1.0122, lr_0 = 7.5737e-04
Loss = 1.6393e-01, PNorm = 34.5892, GNorm = 2.1637, lr_0 = 7.3759e-04
Validation rmse = 0.160478
Validation r2 = 0.810285
Validation mse = 0.025753
Epoch 9
Loss = 1.7032e-01, PNorm = 34.6110, GNorm = 3.4913, lr_0 = 7.1833e-04
Validation rmse = 0.155437
Validation r2 = 0.822016
Validation mse = 0.024161
Epoch 10
Loss = 1.3228e-01, PNorm = 34.6393, GNorm = 2.9533, lr_0 = 6.9772e-04
Loss = 1.6967e-01, PNorm = 34.6644, GNorm = 3.2058, lr_0 = 6.7949e-04
Validation rmse = 0.142861
Validation r2 = 0.849653
Validation mse = 0.020409
Epoch 11
Loss = 1.3556e-01, PNorm = 34.6896, GNorm = 2.0332, lr_0 = 6.6174e-04
Validation rmse = 0.132823
Validation r2 = 0.870037
Validation mse = 0.017642
Epoch 12
Loss = 1.4507e-01, PNorm = 34.7089, GNorm = 2.6558, lr_0 = 6.4276e-04
Loss = 1.2153e-01, PNorm = 34.7288, GNorm = 1.0337, lr_0 = 6.2597e-04
Validation rmse = 0.134765
Validation r2 = 0.866209
Validation mse = 0.018162
Epoch 13
Loss = 1.1814e-01, PNorm = 34.7472, GNorm = 0.9101, lr_0 = 6.0962e-04
Validation rmse = 0.131849
Validation r2 = 0.871937
Validation mse = 0.017384
Epoch 14
Loss = 1.2861e-01, PNorm = 34.7646, GNorm = 1.8762, lr_0 = 5.9369e-04
Loss = 1.1391e-01, PNorm = 34.7796, GNorm = 1.2436, lr_0 = 5.7819e-04
Validation rmse = 0.136411
Validation r2 = 0.862921
Validation mse = 0.018608
Epoch 15
Loss = 1.2303e-01, PNorm = 34.7958, GNorm = 2.7442, lr_0 = 5.6160e-04
Validation rmse = 0.143476
Validation r2 = 0.848355
Validation mse = 0.020585
Epoch 16
Loss = 1.2719e-01, PNorm = 34.8125, GNorm = 1.2155, lr_0 = 5.4693e-04
Loss = 1.2247e-01, PNorm = 34.8314, GNorm = 1.4493, lr_0 = 5.3264e-04
Validation rmse = 0.142200
Validation r2 = 0.851039
Validation mse = 0.020221
Epoch 17
Loss = 1.2245e-01, PNorm = 34.8478, GNorm = 1.3857, lr_0 = 5.1736e-04
Loss = 1.1076e-01, PNorm = 34.8636, GNorm = 1.0101, lr_0 = 5.0385e-04
Validation rmse = 0.130601
Validation r2 = 0.874348
Validation mse = 0.017057
Epoch 18
Loss = 9.6384e-02, PNorm = 34.8773, GNorm = 2.7668, lr_0 = 4.9069e-04
Validation rmse = 0.133191
Validation r2 = 0.869316
Validation mse = 0.017740
Epoch 19
Loss = 8.2962e-02, PNorm = 34.8912, GNorm = 0.5371, lr_0 = 4.7787e-04
Loss = 1.1756e-01, PNorm = 34.9035, GNorm = 0.6336, lr_0 = 4.6539e-04
Validation rmse = 0.130656
Validation r2 = 0.874244
Validation mse = 0.017071
Epoch 20
Loss = 1.0818e-01, PNorm = 34.9170, GNorm = 1.6317, lr_0 = 4.5204e-04
Validation rmse = 0.136892
Validation r2 = 0.861953
Validation mse = 0.018739
Epoch 21
Loss = 1.0721e-01, PNorm = 34.9292, GNorm = 1.2789, lr_0 = 4.4023e-04
Loss = 9.6874e-02, PNorm = 34.9427, GNorm = 0.6042, lr_0 = 4.2873e-04
Validation rmse = 0.132347
Validation r2 = 0.870967
Validation mse = 0.017516
Epoch 22
Loss = 1.0119e-01, PNorm = 34.9548, GNorm = 1.2912, lr_0 = 4.1643e-04
Validation rmse = 0.134038
Validation r2 = 0.867650
Validation mse = 0.017966
Epoch 23
Loss = 8.8414e-02, PNorm = 34.9660, GNorm = 1.2892, lr_0 = 4.0555e-04
Loss = 1.1112e-01, PNorm = 34.9803, GNorm = 1.9761, lr_0 = 3.9496e-04
Validation rmse = 0.132243
Validation r2 = 0.871170
Validation mse = 0.017488
Epoch 24
Loss = 1.0197e-01, PNorm = 34.9950, GNorm = 0.7068, lr_0 = 3.8363e-04
Validation rmse = 0.133205
Validation r2 = 0.869290
Validation mse = 0.017743
Epoch 25
Loss = 1.2112e-01, PNorm = 35.0051, GNorm = 1.2174, lr_0 = 3.7361e-04
Loss = 9.2231e-02, PNorm = 35.0143, GNorm = 1.5327, lr_0 = 3.6385e-04
Validation rmse = 0.132636
Validation r2 = 0.870403
Validation mse = 0.017592
Epoch 26
Loss = 8.9513e-02, PNorm = 35.0251, GNorm = 0.8496, lr_0 = 3.5434e-04
Loss = 9.4934e-02, PNorm = 35.0349, GNorm = 3.7379, lr_0 = 3.4509e-04
Loss = 1.2464e-01, PNorm = 35.0361, GNorm = 1.6250, lr_0 = 3.4418e-04
Validation rmse = 0.133749
Validation r2 = 0.868219
Validation mse = 0.017889
Epoch 27
Loss = 1.0048e-01, PNorm = 35.0483, GNorm = 0.6377, lr_0 = 3.3519e-04
Validation rmse = 0.130098
Validation r2 = 0.875316
Validation mse = 0.016925
Epoch 28
Loss = 1.0937e-01, PNorm = 35.0590, GNorm = 5.0423, lr_0 = 3.2643e-04
Loss = 1.0200e-01, PNorm = 35.0684, GNorm = 1.0956, lr_0 = 3.1791e-04
Validation rmse = 0.134700
Validation r2 = 0.866338
Validation mse = 0.018144
Epoch 29
Loss = 9.0208e-02, PNorm = 35.0787, GNorm = 1.3163, lr_0 = 3.0878e-04
Validation rmse = 0.128452
Validation r2 = 0.878450
Validation mse = 0.016500
Epoch 30
Loss = 7.6591e-02, PNorm = 35.0871, GNorm = 0.7262, lr_0 = 3.0072e-04
Loss = 9.3223e-02, PNorm = 35.0965, GNorm = 0.5191, lr_0 = 2.9286e-04
Validation rmse = 0.132243
Validation r2 = 0.871169
Validation mse = 0.017488
Epoch 31
Loss = 1.0299e-01, PNorm = 35.1057, GNorm = 1.8984, lr_0 = 2.8446e-04
Validation rmse = 0.131863
Validation r2 = 0.871909
Validation mse = 0.017388
Epoch 32
Loss = 1.1861e-01, PNorm = 35.1132, GNorm = 0.9040, lr_0 = 2.7703e-04
Loss = 9.1468e-02, PNorm = 35.1211, GNorm = 1.6205, lr_0 = 2.6980e-04
Validation rmse = 0.131428
Validation r2 = 0.872754
Validation mse = 0.017273
Epoch 33
Loss = 1.0852e-01, PNorm = 35.1300, GNorm = 1.7340, lr_0 = 2.6275e-04
Validation rmse = 0.132979
Validation r2 = 0.869732
Validation mse = 0.017683
Epoch 34
Loss = 6.8745e-02, PNorm = 35.1394, GNorm = 1.4712, lr_0 = 2.5521e-04
Loss = 9.5622e-02, PNorm = 35.1463, GNorm = 3.3620, lr_0 = 2.4854e-04
Validation rmse = 0.134661
Validation r2 = 0.866417
Validation mse = 0.018133
Epoch 35
Loss = 7.9109e-02, PNorm = 35.1524, GNorm = 1.8302, lr_0 = 2.4205e-04
Loss = 9.2260e-02, PNorm = 35.1598, GNorm = 1.3918, lr_0 = 2.3573e-04
Loss = 7.5294e-02, PNorm = 35.1605, GNorm = 1.0320, lr_0 = 2.3511e-04
Validation rmse = 0.128688
Validation r2 = 0.878003
Validation mse = 0.016561
Epoch 36
Loss = 9.5239e-02, PNorm = 35.1692, GNorm = 0.7638, lr_0 = 2.2897e-04
Validation rmse = 0.129581
Validation r2 = 0.876305
Validation mse = 0.016791
Epoch 37
Loss = 8.7972e-02, PNorm = 35.1744, GNorm = 0.7844, lr_0 = 2.2299e-04
Loss = 8.2770e-02, PNorm = 35.1795, GNorm = 1.0758, lr_0 = 2.1716e-04
Validation rmse = 0.134454
Validation r2 = 0.866827
Validation mse = 0.018078
Epoch 38
Loss = 9.5297e-02, PNorm = 35.1862, GNorm = 1.3072, lr_0 = 2.1149e-04
Validation rmse = 0.128861
Validation r2 = 0.877675
Validation mse = 0.016605
Epoch 39
Loss = 9.4448e-02, PNorm = 35.1931, GNorm = 1.6580, lr_0 = 2.0542e-04
Loss = 8.2792e-02, PNorm = 35.1978, GNorm = 1.3276, lr_0 = 2.0006e-04
Validation rmse = 0.130991
Validation r2 = 0.873598
Validation mse = 0.017159
Epoch 40
Loss = 7.9213e-02, PNorm = 35.2042, GNorm = 1.1857, lr_0 = 1.9483e-04
Validation rmse = 0.129638
Validation r2 = 0.876196
Validation mse = 0.016806
Epoch 41
Loss = 8.6062e-02, PNorm = 35.2110, GNorm = 1.5507, lr_0 = 1.8924e-04
Loss = 7.7909e-02, PNorm = 35.2167, GNorm = 1.1294, lr_0 = 1.8430e-04
Validation rmse = 0.130106
Validation r2 = 0.875301
Validation mse = 0.016927
Epoch 42
Loss = 7.0590e-02, PNorm = 35.2217, GNorm = 0.4217, lr_0 = 1.7948e-04
Validation rmse = 0.127191
Validation r2 = 0.880824
Validation mse = 0.016178
Epoch 43
Loss = 8.0272e-02, PNorm = 35.2277, GNorm = 0.8254, lr_0 = 1.7433e-04
Loss = 8.2023e-02, PNorm = 35.2327, GNorm = 1.1276, lr_0 = 1.6978e-04
Validation rmse = 0.128932
Validation r2 = 0.877541
Validation mse = 0.016623
Epoch 44
Loss = 8.0028e-02, PNorm = 35.2370, GNorm = 1.0726, lr_0 = 1.6534e-04
Loss = 7.9699e-02, PNorm = 35.2414, GNorm = 0.6234, lr_0 = 1.6103e-04
Validation rmse = 0.127914
Validation r2 = 0.879466
Validation mse = 0.016362
Epoch 45
Loss = 8.3084e-02, PNorm = 35.2467, GNorm = 0.9976, lr_0 = 1.5682e-04
Validation rmse = 0.128325
Validation r2 = 0.878690
Validation mse = 0.016467
Epoch 46
Loss = 8.5978e-02, PNorm = 35.2519, GNorm = 2.2974, lr_0 = 1.5232e-04
Loss = 7.0560e-02, PNorm = 35.2567, GNorm = 1.7473, lr_0 = 1.4834e-04
Validation rmse = 0.129635
Validation r2 = 0.876202
Validation mse = 0.016805
Epoch 47
Loss = 7.6989e-02, PNorm = 35.2605, GNorm = 1.2327, lr_0 = 1.4447e-04
Validation rmse = 0.127930
Validation r2 = 0.879436
Validation mse = 0.016366
Epoch 48
Loss = 8.8436e-02, PNorm = 35.2655, GNorm = 1.2443, lr_0 = 1.4032e-04
Loss = 7.2530e-02, PNorm = 35.2701, GNorm = 1.1669, lr_0 = 1.3666e-04
Validation rmse = 0.128409
Validation r2 = 0.878532
Validation mse = 0.016489
Epoch 49
Loss = 6.8761e-02, PNorm = 35.2738, GNorm = 0.8423, lr_0 = 1.3309e-04
Validation rmse = 0.128074
Validation r2 = 0.879164
Validation mse = 0.016403
Epoch 50
Loss = 5.7609e-02, PNorm = 35.2778, GNorm = 1.0401, lr_0 = 1.2961e-04
Loss = 7.5867e-02, PNorm = 35.2818, GNorm = 0.6606, lr_0 = 1.2623e-04
Validation rmse = 0.129454
Validation r2 = 0.876546
Validation mse = 0.016758
Epoch 51
Loss = 7.7610e-02, PNorm = 35.2858, GNorm = 0.6062, lr_0 = 1.2260e-04
Loss = 7.3015e-02, PNorm = 35.2898, GNorm = 1.9746, lr_0 = 1.1940e-04
Validation rmse = 0.130974
Validation r2 = 0.873630
Validation mse = 0.017154
Epoch 52
Loss = 8.0899e-02, PNorm = 35.2937, GNorm = 1.3594, lr_0 = 1.1628e-04
Validation rmse = 0.129074
Validation r2 = 0.877271
Validation mse = 0.016660
Epoch 53
Loss = 7.4259e-02, PNorm = 35.2973, GNorm = 0.8083, lr_0 = 1.1295e-04
Loss = 7.3141e-02, PNorm = 35.3005, GNorm = 1.1662, lr_0 = 1.1000e-04
Validation rmse = 0.127930
Validation r2 = 0.879436
Validation mse = 0.016366
Epoch 54
Loss = 6.4516e-02, PNorm = 35.3035, GNorm = 1.3616, lr_0 = 1.0712e-04
Validation rmse = 0.129204
Validation r2 = 0.877023
Validation mse = 0.016694
Epoch 55
Loss = 5.7461e-02, PNorm = 35.3076, GNorm = 2.9832, lr_0 = 1.0405e-04
Loss = 8.2246e-02, PNorm = 35.3106, GNorm = 0.8243, lr_0 = 1.0133e-04
Validation rmse = 0.128148
Validation r2 = 0.879026
Validation mse = 0.016422
Epoch 56
Loss = 7.8456e-02, PNorm = 35.3139, GNorm = 2.5725, lr_0 = 1.0000e-04
Validation rmse = 0.128647
Validation r2 = 0.878081
Validation mse = 0.016550
Epoch 57
Loss = 7.6764e-02, PNorm = 35.3168, GNorm = 1.6443, lr_0 = 1.0000e-04
Loss = 7.6400e-02, PNorm = 35.3198, GNorm = 2.2492, lr_0 = 1.0000e-04
Validation rmse = 0.128809
Validation r2 = 0.877774
Validation mse = 0.016592
Epoch 58
Loss = 6.6628e-02, PNorm = 35.3234, GNorm = 0.8282, lr_0 = 1.0000e-04
Validation rmse = 0.127546
Validation r2 = 0.880160
Validation mse = 0.016268
Epoch 59
Loss = 7.6115e-02, PNorm = 35.3265, GNorm = 0.8154, lr_0 = 1.0000e-04
Loss = 6.9209e-02, PNorm = 35.3296, GNorm = 1.1191, lr_0 = 1.0000e-04
Validation rmse = 0.128684
Validation r2 = 0.878011
Validation mse = 0.016560
Model 0 best validation rmse = 0.127191 on epoch 42
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.548005
Model 0 test r2 = -2.991979
Model 0 test mse = 0.300310
Ensemble test rmse = 0.548005
Ensemble test r2 = -2.991979
Ensemble test mse = 0.300310
Fold 5
Splitting data with seed 5
Total size = 974 | train size = 779 | val size = 195 | test size = 48
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.7335e-01, PNorm = 34.0170, GNorm = 1.0182, lr_0 = 4.3000e-04
Validation rmse = 0.318270
Validation r2 = 0.194543
Validation mse = 0.101296
Epoch 1
Loss = 6.5032e-01, PNorm = 34.0538, GNorm = 8.0360, lr_0 = 7.6000e-04
Loss = 5.1212e-01, PNorm = 34.1188, GNorm = 8.7325, lr_0 = 9.9472e-04
Validation rmse = 0.248012
Validation r2 = 0.510903
Validation mse = 0.061510
Epoch 2
Loss = 4.5440e-01, PNorm = 34.1887, GNorm = 1.9612, lr_0 = 9.6874e-04
Validation rmse = 0.217804
Validation r2 = 0.622791
Validation mse = 0.047438
Epoch 3
Loss = 3.1053e-01, PNorm = 34.2503, GNorm = 4.3256, lr_0 = 9.4094e-04
Loss = 2.8781e-01, PNorm = 34.2931, GNorm = 4.3842, lr_0 = 9.1637e-04
Validation rmse = 0.190905
Validation r2 = 0.710207
Validation mse = 0.036445
Epoch 4
Loss = 2.3295e-01, PNorm = 34.3418, GNorm = 3.3566, lr_0 = 8.9243e-04
Validation rmse = 0.210807
Validation r2 = 0.646636
Validation mse = 0.044440
Epoch 5
Loss = 2.6770e-01, PNorm = 34.3805, GNorm = 3.8213, lr_0 = 8.6682e-04
Loss = 2.3837e-01, PNorm = 34.4186, GNorm = 5.5877, lr_0 = 8.4418e-04
Validation rmse = 0.176330
Validation r2 = 0.752769
Validation mse = 0.031092
Epoch 6
Loss = 2.2030e-01, PNorm = 34.4586, GNorm = 0.8282, lr_0 = 8.2213e-04
Validation rmse = 0.161195
Validation r2 = 0.793389
Validation mse = 0.025984
Epoch 7
Loss = 2.1604e-01, PNorm = 34.4947, GNorm = 3.4031, lr_0 = 8.0066e-04
Loss = 2.0978e-01, PNorm = 34.5303, GNorm = 2.7450, lr_0 = 7.7975e-04
Validation rmse = 0.171800
Validation r2 = 0.765307
Validation mse = 0.029515
Epoch 8
Loss = 1.7307e-01, PNorm = 34.5603, GNorm = 3.7318, lr_0 = 7.5737e-04
Loss = 1.7268e-01, PNorm = 34.5863, GNorm = 0.7699, lr_0 = 7.3759e-04
Validation rmse = 0.154810
Validation r2 = 0.809431
Validation mse = 0.023966
Epoch 9
Loss = 1.5780e-01, PNorm = 34.6110, GNorm = 1.4983, lr_0 = 7.1833e-04
Validation rmse = 0.148462
Validation r2 = 0.824741
Validation mse = 0.022041
Epoch 10
Loss = 1.7145e-01, PNorm = 34.6397, GNorm = 2.0362, lr_0 = 6.9772e-04
Loss = 1.3459e-01, PNorm = 34.6623, GNorm = 3.1994, lr_0 = 6.7949e-04
Validation rmse = 0.146673
Validation r2 = 0.828939
Validation mse = 0.021513
Epoch 11
Loss = 1.3119e-01, PNorm = 34.6791, GNorm = 3.6752, lr_0 = 6.6174e-04
Validation rmse = 0.146428
Validation r2 = 0.829509
Validation mse = 0.021441
Epoch 12
Loss = 1.6054e-01, PNorm = 34.7018, GNorm = 1.1008, lr_0 = 6.4276e-04
Loss = 1.2710e-01, PNorm = 34.7241, GNorm = 2.8379, lr_0 = 6.2597e-04
Validation rmse = 0.144786
Validation r2 = 0.833312
Validation mse = 0.020963
Epoch 13
Loss = 1.2617e-01, PNorm = 34.7411, GNorm = 1.2892, lr_0 = 6.0962e-04
Validation rmse = 0.129808
Validation r2 = 0.866016
Validation mse = 0.016850
Epoch 14
Loss = 1.3026e-01, PNorm = 34.7582, GNorm = 1.4224, lr_0 = 5.9369e-04
Loss = 1.2701e-01, PNorm = 34.7769, GNorm = 1.1300, lr_0 = 5.7819e-04
Validation rmse = 0.128983
Validation r2 = 0.867713
Validation mse = 0.016637
Epoch 15
Loss = 1.1408e-01, PNorm = 34.7934, GNorm = 2.2362, lr_0 = 5.6160e-04
Validation rmse = 0.136331
Validation r2 = 0.852211
Validation mse = 0.018586
Epoch 16
Loss = 1.2866e-01, PNorm = 34.8090, GNorm = 1.8101, lr_0 = 5.4693e-04
Loss = 1.1937e-01, PNorm = 34.8235, GNorm = 2.1870, lr_0 = 5.3264e-04
Validation rmse = 0.135494
Validation r2 = 0.854021
Validation mse = 0.018359
Epoch 17
Loss = 1.3631e-01, PNorm = 34.8407, GNorm = 2.3110, lr_0 = 5.1736e-04
Loss = 1.2745e-01, PNorm = 34.8575, GNorm = 0.7931, lr_0 = 5.0385e-04
Validation rmse = 0.130022
Validation r2 = 0.865573
Validation mse = 0.016906
Epoch 18
Loss = 1.2033e-01, PNorm = 34.8730, GNorm = 3.4115, lr_0 = 4.9069e-04
Validation rmse = 0.149772
Validation r2 = 0.821633
Validation mse = 0.022432
Epoch 19
Loss = 1.2480e-01, PNorm = 34.8869, GNorm = 2.2791, lr_0 = 4.7787e-04
Loss = 1.3409e-01, PNorm = 34.9025, GNorm = 1.5254, lr_0 = 4.6539e-04
Validation rmse = 0.167886
Validation r2 = 0.775879
Validation mse = 0.028186
Epoch 20
Loss = 1.1658e-01, PNorm = 34.9175, GNorm = 2.4151, lr_0 = 4.5204e-04
Validation rmse = 0.161798
Validation r2 = 0.791839
Validation mse = 0.026179
Epoch 21
Loss = 1.1549e-01, PNorm = 34.9310, GNorm = 1.0047, lr_0 = 4.4023e-04
Loss = 1.1171e-01, PNorm = 34.9467, GNorm = 1.2555, lr_0 = 4.2873e-04
Validation rmse = 0.144292
Validation r2 = 0.834447
Validation mse = 0.020820
Epoch 22
Loss = 1.2020e-01, PNorm = 34.9610, GNorm = 2.0249, lr_0 = 4.1643e-04
Validation rmse = 0.126455
Validation r2 = 0.872849
Validation mse = 0.015991
Epoch 23
Loss = 1.2852e-01, PNorm = 34.9712, GNorm = 1.4819, lr_0 = 4.0555e-04
Loss = 1.3739e-01, PNorm = 34.9846, GNorm = 0.9239, lr_0 = 3.9496e-04
Validation rmse = 0.131909
Validation r2 = 0.861642
Validation mse = 0.017400
Epoch 24
Loss = 1.0338e-01, PNorm = 35.0002, GNorm = 0.7632, lr_0 = 3.8363e-04
Validation rmse = 0.126596
Validation r2 = 0.872565
Validation mse = 0.016026
Epoch 25
Loss = 9.2255e-02, PNorm = 35.0142, GNorm = 1.4983, lr_0 = 3.7361e-04
Loss = 9.8778e-02, PNorm = 35.0266, GNorm = 1.3613, lr_0 = 3.6385e-04
Validation rmse = 0.136294
Validation r2 = 0.852292
Validation mse = 0.018576
Epoch 26
Loss = 1.0784e-01, PNorm = 35.0364, GNorm = 2.9010, lr_0 = 3.5434e-04
Loss = 1.1117e-01, PNorm = 35.0478, GNorm = 1.0890, lr_0 = 3.4509e-04
Loss = 1.5507e-01, PNorm = 35.0488, GNorm = 2.8461, lr_0 = 3.4418e-04
Validation rmse = 0.133366
Validation r2 = 0.858569
Validation mse = 0.017787
Epoch 27
Loss = 1.0473e-01, PNorm = 35.0613, GNorm = 0.6518, lr_0 = 3.3519e-04
Validation rmse = 0.138703
Validation r2 = 0.847024
Validation mse = 0.019238
Epoch 28
Loss = 9.8684e-02, PNorm = 35.0716, GNorm = 1.8490, lr_0 = 3.2643e-04
Loss = 1.1223e-01, PNorm = 35.0828, GNorm = 3.9348, lr_0 = 3.1791e-04
Validation rmse = 0.148657
Validation r2 = 0.824279
Validation mse = 0.022099
Epoch 29
Loss = 9.8547e-02, PNorm = 35.0905, GNorm = 0.7827, lr_0 = 3.0878e-04
Validation rmse = 0.120941
Validation r2 = 0.883694
Validation mse = 0.014627
Epoch 30
Loss = 1.0915e-01, PNorm = 35.1001, GNorm = 2.1537, lr_0 = 3.0072e-04
Loss = 1.0930e-01, PNorm = 35.1119, GNorm = 3.0032, lr_0 = 2.9286e-04
Validation rmse = 0.120616
Validation r2 = 0.884320
Validation mse = 0.014548
Epoch 31
Loss = 1.0907e-01, PNorm = 35.1265, GNorm = 3.9186, lr_0 = 2.8446e-04
Validation rmse = 0.130391
Validation r2 = 0.864809
Validation mse = 0.017002
Epoch 32
Loss = 8.1538e-02, PNorm = 35.1368, GNorm = 0.3872, lr_0 = 2.7703e-04
Loss = 9.6836e-02, PNorm = 35.1465, GNorm = 1.2736, lr_0 = 2.6980e-04
Validation rmse = 0.125621
Validation r2 = 0.874520
Validation mse = 0.015781
Epoch 33
Loss = 1.1018e-01, PNorm = 35.1556, GNorm = 4.7866, lr_0 = 2.6275e-04
Validation rmse = 0.153624
Validation r2 = 0.812340
Validation mse = 0.023600
Epoch 34
Loss = 1.2919e-01, PNorm = 35.1646, GNorm = 3.7721, lr_0 = 2.5521e-04
Loss = 1.0660e-01, PNorm = 35.1738, GNorm = 2.5099, lr_0 = 2.4854e-04
Validation rmse = 0.119995
Validation r2 = 0.885508
Validation mse = 0.014399
Epoch 35
Loss = 1.0172e-01, PNorm = 35.1841, GNorm = 1.3415, lr_0 = 2.4205e-04
Loss = 9.6103e-02, PNorm = 35.1941, GNorm = 1.1332, lr_0 = 2.3573e-04
Loss = 4.9611e-02, PNorm = 35.1950, GNorm = 1.0280, lr_0 = 2.3511e-04
Validation rmse = 0.126356
Validation r2 = 0.873048
Validation mse = 0.015966
Epoch 36
Loss = 8.7376e-02, PNorm = 35.2031, GNorm = 2.1200, lr_0 = 2.2897e-04
Validation rmse = 0.124534
Validation r2 = 0.876681
Validation mse = 0.015509
Epoch 37
Loss = 8.8854e-02, PNorm = 35.2103, GNorm = 1.8444, lr_0 = 2.2299e-04
Loss = 9.0155e-02, PNorm = 35.2170, GNorm = 1.4697, lr_0 = 2.1716e-04
Validation rmse = 0.121881
Validation r2 = 0.881881
Validation mse = 0.014855
Epoch 38
Loss = 9.4097e-02, PNorm = 35.2247, GNorm = 2.7630, lr_0 = 2.1149e-04
Validation rmse = 0.126360
Validation r2 = 0.873039
Validation mse = 0.015967
Epoch 39
Loss = 8.9641e-02, PNorm = 35.2329, GNorm = 1.6958, lr_0 = 2.0542e-04
Loss = 9.3452e-02, PNorm = 35.2412, GNorm = 1.1018, lr_0 = 2.0006e-04
Validation rmse = 0.117734
Validation r2 = 0.889782
Validation mse = 0.013861
Epoch 40
Loss = 9.7253e-02, PNorm = 35.2471, GNorm = 1.4106, lr_0 = 1.9483e-04
Validation rmse = 0.125822
Validation r2 = 0.874118
Validation mse = 0.015831
Epoch 41
Loss = 8.0549e-02, PNorm = 35.2555, GNorm = 0.5246, lr_0 = 1.8924e-04
Loss = 8.7121e-02, PNorm = 35.2609, GNorm = 1.2385, lr_0 = 1.8430e-04
Validation rmse = 0.124889
Validation r2 = 0.875979
Validation mse = 0.015597
Epoch 42
Loss = 1.0016e-01, PNorm = 35.2670, GNorm = 1.9651, lr_0 = 1.7948e-04
Validation rmse = 0.131912
Validation r2 = 0.861636
Validation mse = 0.017401
Epoch 43
Loss = 6.7793e-02, PNorm = 35.2737, GNorm = 1.8627, lr_0 = 1.7433e-04
Loss = 9.1594e-02, PNorm = 35.2811, GNorm = 0.8402, lr_0 = 1.6978e-04
Validation rmse = 0.120959
Validation r2 = 0.883660
Validation mse = 0.014631
Epoch 44
Loss = 8.1944e-02, PNorm = 35.2875, GNorm = 0.6497, lr_0 = 1.6534e-04
Loss = 8.3312e-02, PNorm = 35.2935, GNorm = 1.2904, lr_0 = 1.6103e-04
Validation rmse = 0.123255
Validation r2 = 0.879203
Validation mse = 0.015192
Epoch 45
Loss = 8.7641e-02, PNorm = 35.2980, GNorm = 2.5700, lr_0 = 1.5682e-04
Validation rmse = 0.131356
Validation r2 = 0.862801
Validation mse = 0.017254
Epoch 46
Loss = 8.8642e-02, PNorm = 35.3040, GNorm = 1.7631, lr_0 = 1.5232e-04
Loss = 8.4547e-02, PNorm = 35.3096, GNorm = 1.5279, lr_0 = 1.4834e-04
Validation rmse = 0.121709
Validation r2 = 0.882213
Validation mse = 0.014813
Epoch 47
Loss = 7.1412e-02, PNorm = 35.3137, GNorm = 0.9255, lr_0 = 1.4447e-04
Validation rmse = 0.118709
Validation r2 = 0.887949
Validation mse = 0.014092
Epoch 48
Loss = 6.6963e-02, PNorm = 35.3191, GNorm = 0.6967, lr_0 = 1.4032e-04
Loss = 7.8727e-02, PNorm = 35.3243, GNorm = 1.5280, lr_0 = 1.3666e-04
Validation rmse = 0.120882
Validation r2 = 0.883809
Validation mse = 0.014612
Epoch 49
Loss = 7.5390e-02, PNorm = 35.3290, GNorm = 1.3803, lr_0 = 1.3309e-04
Validation rmse = 0.121745
Validation r2 = 0.882143
Validation mse = 0.014822
Epoch 50
Loss = 6.3257e-02, PNorm = 35.3338, GNorm = 1.0792, lr_0 = 1.2961e-04
Loss = 7.9174e-02, PNorm = 35.3386, GNorm = 2.2221, lr_0 = 1.2623e-04
Validation rmse = 0.126578
Validation r2 = 0.872601
Validation mse = 0.016022
Epoch 51
Loss = 8.4508e-02, PNorm = 35.3433, GNorm = 0.7826, lr_0 = 1.2260e-04
Loss = 7.4543e-02, PNorm = 35.3484, GNorm = 1.2193, lr_0 = 1.1940e-04
Validation rmse = 0.125222
Validation r2 = 0.875316
Validation mse = 0.015680
Epoch 52
Loss = 6.7655e-02, PNorm = 35.3524, GNorm = 1.7625, lr_0 = 1.1628e-04
Validation rmse = 0.127252
Validation r2 = 0.871240
Validation mse = 0.016193
Epoch 53
Loss = 7.2378e-02, PNorm = 35.3567, GNorm = 0.4915, lr_0 = 1.1295e-04
Loss = 8.0439e-02, PNorm = 35.3615, GNorm = 1.5296, lr_0 = 1.1000e-04
Validation rmse = 0.118703
Validation r2 = 0.887959
Validation mse = 0.014090
Epoch 54
Loss = 8.0105e-02, PNorm = 35.3641, GNorm = 0.6082, lr_0 = 1.0712e-04
Validation rmse = 0.121104
Validation r2 = 0.883380
Validation mse = 0.014666
Epoch 55
Loss = 6.4936e-02, PNorm = 35.3686, GNorm = 1.2357, lr_0 = 1.0405e-04
Loss = 7.8616e-02, PNorm = 35.3727, GNorm = 1.9908, lr_0 = 1.0133e-04
Validation rmse = 0.122395
Validation r2 = 0.880882
Validation mse = 0.014980
Epoch 56
Loss = 7.8582e-02, PNorm = 35.3766, GNorm = 0.3939, lr_0 = 1.0000e-04
Validation rmse = 0.121293
Validation r2 = 0.883018
Validation mse = 0.014712
Epoch 57
Loss = 7.7012e-02, PNorm = 35.3804, GNorm = 1.6796, lr_0 = 1.0000e-04
Loss = 7.6597e-02, PNorm = 35.3835, GNorm = 1.2007, lr_0 = 1.0000e-04
Validation rmse = 0.121366
Validation r2 = 0.882876
Validation mse = 0.014730
Epoch 58
Loss = 6.9463e-02, PNorm = 35.3879, GNorm = 1.7409, lr_0 = 1.0000e-04
Validation rmse = 0.125423
Validation r2 = 0.874914
Validation mse = 0.015731
Epoch 59
Loss = 5.8818e-02, PNorm = 35.3916, GNorm = 0.6426, lr_0 = 1.0000e-04
Loss = 7.8769e-02, PNorm = 35.3956, GNorm = 0.9304, lr_0 = 1.0000e-04
Validation rmse = 0.122972
Validation r2 = 0.879755
Validation mse = 0.015122
Model 0 best validation rmse = 0.117734 on epoch 39
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.524526
Model 0 test r2 = -2.657241
Model 0 test mse = 0.275128
Ensemble test rmse = 0.524526
Ensemble test r2 = -2.657241
Ensemble test mse = 0.275128
Fold 6
Splitting data with seed 6
Total size = 974 | train size = 779 | val size = 195 | test size = 48
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.4044e-01, PNorm = 34.0180, GNorm = 6.7555, lr_0 = 4.3000e-04
Validation rmse = 0.306856
Validation r2 = 0.117764
Validation mse = 0.094161
Epoch 1
Loss = 6.8192e-01, PNorm = 34.0481, GNorm = 5.9352, lr_0 = 7.6000e-04
Loss = 5.6739e-01, PNorm = 34.1127, GNorm = 6.6415, lr_0 = 9.9472e-04
Validation rmse = 0.230499
Validation r2 = 0.502203
Validation mse = 0.053130
Epoch 2
Loss = 3.9928e-01, PNorm = 34.1904, GNorm = 3.9368, lr_0 = 9.6874e-04
Validation rmse = 0.193525
Validation r2 = 0.649094
Validation mse = 0.037452
Epoch 3
Loss = 2.8259e-01, PNorm = 34.2621, GNorm = 3.6055, lr_0 = 9.4094e-04
Loss = 3.1878e-01, PNorm = 34.3203, GNorm = 4.5770, lr_0 = 9.1637e-04
Validation rmse = 0.167810
Validation r2 = 0.736152
Validation mse = 0.028160
Epoch 4
Loss = 2.4573e-01, PNorm = 34.3733, GNorm = 2.9525, lr_0 = 8.9243e-04
Validation rmse = 0.158749
Validation r2 = 0.763878
Validation mse = 0.025201
Epoch 5
Loss = 2.4006e-01, PNorm = 34.4173, GNorm = 0.9116, lr_0 = 8.6682e-04
Loss = 2.2328e-01, PNorm = 34.4576, GNorm = 1.9389, lr_0 = 8.4418e-04
Validation rmse = 0.190408
Validation r2 = 0.660307
Validation mse = 0.036255
Epoch 6
Loss = 2.1184e-01, PNorm = 34.4955, GNorm = 1.6702, lr_0 = 8.2213e-04
Validation rmse = 0.141803
Validation r2 = 0.811597
Validation mse = 0.020108
Epoch 7
Loss = 2.1941e-01, PNorm = 34.5273, GNorm = 4.9514, lr_0 = 8.0066e-04
Loss = 2.0449e-01, PNorm = 34.5585, GNorm = 0.7543, lr_0 = 7.7975e-04
Validation rmse = 0.144618
Validation r2 = 0.804043
Validation mse = 0.020914
Epoch 8
Loss = 1.6316e-01, PNorm = 34.5916, GNorm = 2.2790, lr_0 = 7.5737e-04
Loss = 1.6988e-01, PNorm = 34.6198, GNorm = 1.5755, lr_0 = 7.3759e-04
Validation rmse = 0.136062
Validation r2 = 0.826544
Validation mse = 0.018513
Epoch 9
Loss = 1.9016e-01, PNorm = 34.6477, GNorm = 5.8156, lr_0 = 7.1833e-04
Validation rmse = 0.148021
Validation r2 = 0.794714
Validation mse = 0.021910
Epoch 10
Loss = 2.0589e-01, PNorm = 34.6736, GNorm = 4.0288, lr_0 = 6.9772e-04
Loss = 1.6406e-01, PNorm = 34.6956, GNorm = 2.1022, lr_0 = 6.7949e-04
Validation rmse = 0.135370
Validation r2 = 0.828305
Validation mse = 0.018325
Epoch 11
Loss = 1.7956e-01, PNorm = 34.7188, GNorm = 2.9452, lr_0 = 6.6174e-04
Validation rmse = 0.134204
Validation r2 = 0.831250
Validation mse = 0.018011
Epoch 12
Loss = 1.1882e-01, PNorm = 34.7452, GNorm = 0.7701, lr_0 = 6.4276e-04
Loss = 1.5964e-01, PNorm = 34.7669, GNorm = 2.9733, lr_0 = 6.2597e-04
Validation rmse = 0.126979
Validation r2 = 0.848929
Validation mse = 0.016124
Epoch 13
Loss = 1.1725e-01, PNorm = 34.7848, GNorm = 0.7355, lr_0 = 6.0962e-04
Validation rmse = 0.125535
Validation r2 = 0.852345
Validation mse = 0.015759
Epoch 14
Loss = 9.7314e-02, PNorm = 34.8023, GNorm = 0.8508, lr_0 = 5.9369e-04
Loss = 1.2767e-01, PNorm = 34.8197, GNorm = 1.9517, lr_0 = 5.7819e-04
Validation rmse = 0.115807
Validation r2 = 0.874343
Validation mse = 0.013411
Epoch 15
Loss = 1.1789e-01, PNorm = 34.8368, GNorm = 2.9746, lr_0 = 5.6160e-04
Validation rmse = 0.121643
Validation r2 = 0.861360
Validation mse = 0.014797
Epoch 16
Loss = 9.0481e-02, PNorm = 34.8512, GNorm = 1.2690, lr_0 = 5.4693e-04
Loss = 1.3117e-01, PNorm = 34.8679, GNorm = 2.1178, lr_0 = 5.3264e-04
Validation rmse = 0.136254
Validation r2 = 0.826055
Validation mse = 0.018565
Epoch 17
Loss = 1.4850e-01, PNorm = 34.8887, GNorm = 2.3813, lr_0 = 5.1736e-04
Loss = 1.2579e-01, PNorm = 34.9043, GNorm = 3.7819, lr_0 = 5.0385e-04
Validation rmse = 0.120925
Validation r2 = 0.862991
Validation mse = 0.014623
Epoch 18
Loss = 1.2806e-01, PNorm = 34.9205, GNorm = 1.3599, lr_0 = 4.9069e-04
Validation rmse = 0.117161
Validation r2 = 0.871388
Validation mse = 0.013727
Epoch 19
Loss = 1.1485e-01, PNorm = 34.9363, GNorm = 1.9650, lr_0 = 4.7787e-04
Loss = 1.2692e-01, PNorm = 34.9551, GNorm = 2.8183, lr_0 = 4.6539e-04
Validation rmse = 0.119661
Validation r2 = 0.865840
Validation mse = 0.014319
Epoch 20
Loss = 1.0352e-01, PNorm = 34.9692, GNorm = 0.6623, lr_0 = 4.5204e-04
Validation rmse = 0.123210
Validation r2 = 0.857764
Validation mse = 0.015181
Epoch 21
Loss = 1.0528e-01, PNorm = 34.9848, GNorm = 0.6391, lr_0 = 4.4023e-04
Loss = 1.0280e-01, PNorm = 34.9992, GNorm = 0.6435, lr_0 = 4.2873e-04
Validation rmse = 0.114940
Validation r2 = 0.876218
Validation mse = 0.013211
Epoch 22
Loss = 1.3066e-01, PNorm = 35.0150, GNorm = 3.5005, lr_0 = 4.1643e-04
Validation rmse = 0.120261
Validation r2 = 0.864491
Validation mse = 0.014463
Epoch 23
Loss = 1.1354e-01, PNorm = 35.0278, GNorm = 0.8457, lr_0 = 4.0555e-04
Loss = 9.4368e-02, PNorm = 35.0423, GNorm = 1.2394, lr_0 = 3.9496e-04
Validation rmse = 0.124622
Validation r2 = 0.854485
Validation mse = 0.015531
Epoch 24
Loss = 1.1766e-01, PNorm = 35.0551, GNorm = 3.3649, lr_0 = 3.8363e-04
Validation rmse = 0.113098
Validation r2 = 0.880153
Validation mse = 0.012791
Epoch 25
Loss = 9.2566e-02, PNorm = 35.0686, GNorm = 1.5673, lr_0 = 3.7361e-04
Loss = 1.0014e-01, PNorm = 35.0830, GNorm = 1.4403, lr_0 = 3.6385e-04
Validation rmse = 0.117324
Validation r2 = 0.871029
Validation mse = 0.013765
Epoch 26
Loss = 8.4872e-02, PNorm = 35.0958, GNorm = 1.0806, lr_0 = 3.5434e-04
Loss = 1.0572e-01, PNorm = 35.1087, GNorm = 4.3084, lr_0 = 3.4509e-04
Loss = 9.2927e-02, PNorm = 35.1097, GNorm = 2.6989, lr_0 = 3.4418e-04
Validation rmse = 0.113250
Validation r2 = 0.879831
Validation mse = 0.012826
Epoch 27
Loss = 9.9951e-02, PNorm = 35.1202, GNorm = 0.6740, lr_0 = 3.3519e-04
Validation rmse = 0.118421
Validation r2 = 0.868607
Validation mse = 0.014024
Epoch 28
Loss = 8.5398e-02, PNorm = 35.1323, GNorm = 1.1932, lr_0 = 3.2643e-04
Loss = 9.9798e-02, PNorm = 35.1443, GNorm = 1.1476, lr_0 = 3.1791e-04
Validation rmse = 0.114435
Validation r2 = 0.877304
Validation mse = 0.013095
Epoch 29
Loss = 9.8048e-02, PNorm = 35.1564, GNorm = 2.4858, lr_0 = 3.0878e-04
Validation rmse = 0.117624
Validation r2 = 0.870369
Validation mse = 0.013835
Epoch 30
Loss = 1.0856e-01, PNorm = 35.1677, GNorm = 1.0172, lr_0 = 3.0072e-04
Loss = 8.9004e-02, PNorm = 35.1792, GNorm = 2.4158, lr_0 = 2.9286e-04
Validation rmse = 0.117116
Validation r2 = 0.871487
Validation mse = 0.013716
Epoch 31
Loss = 9.8870e-02, PNorm = 35.1907, GNorm = 0.5778, lr_0 = 2.8446e-04
Validation rmse = 0.112142
Validation r2 = 0.882171
Validation mse = 0.012576
Epoch 32
Loss = 8.6642e-02, PNorm = 35.1995, GNorm = 0.8060, lr_0 = 2.7703e-04
Loss = 1.0107e-01, PNorm = 35.2093, GNorm = 0.5077, lr_0 = 2.6980e-04
Validation rmse = 0.114184
Validation r2 = 0.877841
Validation mse = 0.013038
Epoch 33
Loss = 8.1713e-02, PNorm = 35.2178, GNorm = 0.7638, lr_0 = 2.6275e-04
Validation rmse = 0.112418
Validation r2 = 0.881590
Validation mse = 0.012638
Epoch 34
Loss = 5.5947e-02, PNorm = 35.2277, GNorm = 0.8442, lr_0 = 2.5521e-04
Loss = 9.4817e-02, PNorm = 35.2378, GNorm = 0.8225, lr_0 = 2.4854e-04
Validation rmse = 0.111726
Validation r2 = 0.883044
Validation mse = 0.012483
Epoch 35
Loss = 8.9188e-02, PNorm = 35.2452, GNorm = 1.1854, lr_0 = 2.4205e-04
Loss = 8.3217e-02, PNorm = 35.2543, GNorm = 0.6350, lr_0 = 2.3573e-04
Loss = 8.9934e-02, PNorm = 35.2551, GNorm = 1.7132, lr_0 = 2.3511e-04
Validation rmse = 0.113769
Validation r2 = 0.878728
Validation mse = 0.012943
Epoch 36
Loss = 8.7350e-02, PNorm = 35.2634, GNorm = 0.9452, lr_0 = 2.2897e-04
Validation rmse = 0.111267
Validation r2 = 0.884002
Validation mse = 0.012380
Epoch 37
Loss = 7.4812e-02, PNorm = 35.2716, GNorm = 0.3627, lr_0 = 2.2299e-04
Loss = 8.6393e-02, PNorm = 35.2798, GNorm = 1.5923, lr_0 = 2.1716e-04
Validation rmse = 0.111983
Validation r2 = 0.882506
Validation mse = 0.012540
Epoch 38
Loss = 7.6792e-02, PNorm = 35.2866, GNorm = 1.1876, lr_0 = 2.1149e-04
Validation rmse = 0.112895
Validation r2 = 0.880583
Validation mse = 0.012745
Epoch 39
Loss = 8.9508e-02, PNorm = 35.2946, GNorm = 1.8921, lr_0 = 2.0542e-04
Loss = 8.7134e-02, PNorm = 35.3026, GNorm = 1.6349, lr_0 = 2.0006e-04
Validation rmse = 0.112462
Validation r2 = 0.881498
Validation mse = 0.012648
Epoch 40
Loss = 8.3327e-02, PNorm = 35.3090, GNorm = 0.8712, lr_0 = 1.9483e-04
Validation rmse = 0.117388
Validation r2 = 0.870889
Validation mse = 0.013780
Epoch 41
Loss = 8.3708e-02, PNorm = 35.3168, GNorm = 0.9141, lr_0 = 1.8924e-04
Loss = 8.2524e-02, PNorm = 35.3237, GNorm = 1.0707, lr_0 = 1.8430e-04
Validation rmse = 0.112515
Validation r2 = 0.881385
Validation mse = 0.012660
Epoch 42
Loss = 7.8829e-02, PNorm = 35.3303, GNorm = 2.2426, lr_0 = 1.7948e-04
Validation rmse = 0.111763
Validation r2 = 0.882965
Validation mse = 0.012491
Epoch 43
Loss = 5.6774e-02, PNorm = 35.3375, GNorm = 0.5402, lr_0 = 1.7433e-04
Loss = 7.3384e-02, PNorm = 35.3444, GNorm = 1.5529, lr_0 = 1.6978e-04
Validation rmse = 0.113355
Validation r2 = 0.879608
Validation mse = 0.012849
Epoch 44
Loss = 7.0697e-02, PNorm = 35.3502, GNorm = 1.3641, lr_0 = 1.6534e-04
Loss = 8.5201e-02, PNorm = 35.3557, GNorm = 0.6604, lr_0 = 1.6103e-04
Validation rmse = 0.111490
Validation r2 = 0.883536
Validation mse = 0.012430
Epoch 45
Loss = 7.7784e-02, PNorm = 35.3614, GNorm = 0.4113, lr_0 = 1.5682e-04
Validation rmse = 0.112301
Validation r2 = 0.881837
Validation mse = 0.012612
Epoch 46
Loss = 7.7217e-02, PNorm = 35.3675, GNorm = 1.0070, lr_0 = 1.5232e-04
Loss = 7.9387e-02, PNorm = 35.3726, GNorm = 0.6306, lr_0 = 1.4834e-04
Validation rmse = 0.112823
Validation r2 = 0.880736
Validation mse = 0.012729
Epoch 47
Loss = 8.4411e-02, PNorm = 35.3775, GNorm = 0.8626, lr_0 = 1.4447e-04
Validation rmse = 0.112087
Validation r2 = 0.882286
Validation mse = 0.012564
Epoch 48
Loss = 7.7254e-02, PNorm = 35.3835, GNorm = 1.5514, lr_0 = 1.4032e-04
Loss = 8.3198e-02, PNorm = 35.3880, GNorm = 0.8105, lr_0 = 1.3666e-04
Validation rmse = 0.112000
Validation r2 = 0.882469
Validation mse = 0.012544
Epoch 49
Loss = 7.5973e-02, PNorm = 35.3933, GNorm = 1.1214, lr_0 = 1.3309e-04
Validation rmse = 0.113581
Validation r2 = 0.879127
Validation mse = 0.012901
Epoch 50
Loss = 7.1752e-02, PNorm = 35.3974, GNorm = 0.8807, lr_0 = 1.2961e-04
Loss = 7.7917e-02, PNorm = 35.4025, GNorm = 0.9051, lr_0 = 1.2623e-04
Validation rmse = 0.113492
Validation r2 = 0.879316
Validation mse = 0.012881
Epoch 51
Loss = 8.4033e-02, PNorm = 35.4074, GNorm = 0.7448, lr_0 = 1.2260e-04
Loss = 7.4818e-02, PNorm = 35.4118, GNorm = 1.5069, lr_0 = 1.1940e-04
Validation rmse = 0.111713
Validation r2 = 0.883071
Validation mse = 0.012480
Epoch 52
Loss = 7.7041e-02, PNorm = 35.4170, GNorm = 0.3017, lr_0 = 1.1628e-04
Validation rmse = 0.111537
Validation r2 = 0.883440
Validation mse = 0.012440
Epoch 53
Loss = 7.7574e-02, PNorm = 35.4214, GNorm = 0.8624, lr_0 = 1.1295e-04
Loss = 7.4351e-02, PNorm = 35.4250, GNorm = 0.8114, lr_0 = 1.1000e-04
Validation rmse = 0.114588
Validation r2 = 0.876975
Validation mse = 0.013130
Epoch 54
Loss = 7.9282e-02, PNorm = 35.4283, GNorm = 0.9851, lr_0 = 1.0712e-04
Validation rmse = 0.111863
Validation r2 = 0.882756
Validation mse = 0.012513
Epoch 55
Loss = 7.7377e-02, PNorm = 35.4333, GNorm = 1.6356, lr_0 = 1.0405e-04
Loss = 7.7274e-02, PNorm = 35.4375, GNorm = 1.0196, lr_0 = 1.0133e-04
Validation rmse = 0.111827
Validation r2 = 0.882831
Validation mse = 0.012505
Epoch 56
Loss = 7.0676e-02, PNorm = 35.4412, GNorm = 0.8299, lr_0 = 1.0000e-04
Validation rmse = 0.112677
Validation r2 = 0.881045
Validation mse = 0.012696
Epoch 57
Loss = 8.0854e-02, PNorm = 35.4450, GNorm = 2.0750, lr_0 = 1.0000e-04
Loss = 8.0646e-02, PNorm = 35.4490, GNorm = 0.9799, lr_0 = 1.0000e-04
Validation rmse = 0.112454
Validation r2 = 0.881514
Validation mse = 0.012646
Epoch 58
Loss = 6.7364e-02, PNorm = 35.4524, GNorm = 0.5794, lr_0 = 1.0000e-04
Validation rmse = 0.111542
Validation r2 = 0.883428
Validation mse = 0.012442
Epoch 59
Loss = 6.9466e-02, PNorm = 35.4563, GNorm = 0.7532, lr_0 = 1.0000e-04
Loss = 7.1482e-02, PNorm = 35.4602, GNorm = 0.6605, lr_0 = 1.0000e-04
Validation rmse = 0.112898
Validation r2 = 0.880576
Validation mse = 0.012746
Model 0 best validation rmse = 0.111267 on epoch 36
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.558000
Model 0 test r2 = -3.138918
Model 0 test mse = 0.311364
Ensemble test rmse = 0.558000
Ensemble test r2 = -3.138918
Ensemble test mse = 0.311364
Fold 7
Splitting data with seed 7
Total size = 974 | train size = 779 | val size = 195 | test size = 48
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.5245e-01, PNorm = 34.0148, GNorm = 1.2329, lr_0 = 4.3000e-04
Validation rmse = 0.327935
Validation r2 = 0.131179
Validation mse = 0.107541
Epoch 1
Loss = 7.7285e-01, PNorm = 34.0414, GNorm = 4.4528, lr_0 = 7.6000e-04
Loss = 6.3202e-01, PNorm = 34.1010, GNorm = 9.0339, lr_0 = 9.9472e-04
Validation rmse = 0.236048
Validation r2 = 0.549853
Validation mse = 0.055719
Epoch 2
Loss = 4.6219e-01, PNorm = 34.1666, GNorm = 4.8734, lr_0 = 9.6874e-04
Validation rmse = 0.195882
Validation r2 = 0.690014
Validation mse = 0.038370
Epoch 3
Loss = 3.8919e-01, PNorm = 34.2482, GNorm = 3.7056, lr_0 = 9.4094e-04
Loss = 3.4539e-01, PNorm = 34.3129, GNorm = 8.8125, lr_0 = 9.1637e-04
Validation rmse = 0.211905
Validation r2 = 0.637225
Validation mse = 0.044904
Epoch 4
Loss = 3.1822e-01, PNorm = 34.3693, GNorm = 0.9317, lr_0 = 8.9243e-04
Validation rmse = 0.167680
Validation r2 = 0.772847
Validation mse = 0.028117
Epoch 5
Loss = 2.2461e-01, PNorm = 34.4246, GNorm = 2.0590, lr_0 = 8.6682e-04
Loss = 2.2379e-01, PNorm = 34.4710, GNorm = 3.2026, lr_0 = 8.4418e-04
Validation rmse = 0.154759
Validation r2 = 0.806506
Validation mse = 0.023950
Epoch 6
Loss = 2.2626e-01, PNorm = 34.5076, GNorm = 4.4186, lr_0 = 8.2213e-04
Validation rmse = 0.147889
Validation r2 = 0.823305
Validation mse = 0.021871
Epoch 7
Loss = 1.3483e-01, PNorm = 34.5451, GNorm = 2.3561, lr_0 = 8.0066e-04
Loss = 1.5179e-01, PNorm = 34.5735, GNorm = 1.5856, lr_0 = 7.7975e-04
Validation rmse = 0.149477
Validation r2 = 0.819488
Validation mse = 0.022343
Epoch 8
Loss = 1.6424e-01, PNorm = 34.6121, GNorm = 3.5916, lr_0 = 7.5737e-04
Loss = 1.6014e-01, PNorm = 34.6377, GNorm = 4.7210, lr_0 = 7.3759e-04
Validation rmse = 0.145498
Validation r2 = 0.828971
Validation mse = 0.021170
Epoch 9
Loss = 1.3789e-01, PNorm = 34.6652, GNorm = 4.9783, lr_0 = 7.1833e-04
Validation rmse = 0.134077
Validation r2 = 0.854768
Validation mse = 0.017977
Epoch 10
Loss = 1.4440e-01, PNorm = 34.6913, GNorm = 0.7157, lr_0 = 6.9772e-04
Loss = 1.2928e-01, PNorm = 34.7139, GNorm = 1.3367, lr_0 = 6.7949e-04
Validation rmse = 0.161581
Validation r2 = 0.789073
Validation mse = 0.026108
Epoch 11
Loss = 1.5122e-01, PNorm = 34.7389, GNorm = 1.3151, lr_0 = 6.6174e-04
Validation rmse = 0.150228
Validation r2 = 0.817672
Validation mse = 0.022568
Epoch 12
Loss = 1.5219e-01, PNorm = 34.7591, GNorm = 4.6352, lr_0 = 6.4276e-04
Loss = 1.3780e-01, PNorm = 34.7792, GNorm = 1.5755, lr_0 = 6.2597e-04
Validation rmse = 0.137400
Validation r2 = 0.847480
Validation mse = 0.018879
Epoch 13
Loss = 1.1569e-01, PNorm = 34.7972, GNorm = 0.5910, lr_0 = 6.0962e-04
Validation rmse = 0.165048
Validation r2 = 0.779922
Validation mse = 0.027241
Epoch 14
Loss = 1.6914e-01, PNorm = 34.8173, GNorm = 4.1615, lr_0 = 5.9369e-04
Loss = 1.2609e-01, PNorm = 34.8349, GNorm = 2.7377, lr_0 = 5.7819e-04
Validation rmse = 0.151585
Validation r2 = 0.814362
Validation mse = 0.022978
Epoch 15
Loss = 1.3386e-01, PNorm = 34.8542, GNorm = 1.8391, lr_0 = 5.6160e-04
Validation rmse = 0.139657
Validation r2 = 0.842429
Validation mse = 0.019504
Epoch 16
Loss = 9.8469e-02, PNorm = 34.8737, GNorm = 0.6955, lr_0 = 5.4693e-04
Loss = 1.0627e-01, PNorm = 34.8914, GNorm = 0.8446, lr_0 = 5.3264e-04
Validation rmse = 0.135186
Validation r2 = 0.852355
Validation mse = 0.018275
Epoch 17
Loss = 8.6741e-02, PNorm = 34.9090, GNorm = 1.5218, lr_0 = 5.1736e-04
Loss = 1.3108e-01, PNorm = 34.9201, GNorm = 2.2904, lr_0 = 5.0385e-04
Validation rmse = 0.137457
Validation r2 = 0.847353
Validation mse = 0.018894
Epoch 18
Loss = 1.1601e-01, PNorm = 34.9337, GNorm = 1.0634, lr_0 = 4.9069e-04
Validation rmse = 0.136923
Validation r2 = 0.848537
Validation mse = 0.018748
Epoch 19
Loss = 1.1215e-01, PNorm = 34.9511, GNorm = 1.6057, lr_0 = 4.7787e-04
Loss = 1.1605e-01, PNorm = 34.9673, GNorm = 1.1734, lr_0 = 4.6539e-04
Validation rmse = 0.157570
Validation r2 = 0.799415
Validation mse = 0.024828
Epoch 20
Loss = 1.0840e-01, PNorm = 34.9836, GNorm = 2.2896, lr_0 = 4.5204e-04
Validation rmse = 0.141383
Validation r2 = 0.838509
Validation mse = 0.019989
Epoch 21
Loss = 9.3476e-02, PNorm = 34.9960, GNorm = 0.6879, lr_0 = 4.4023e-04
Loss = 1.0559e-01, PNorm = 35.0103, GNorm = 2.2670, lr_0 = 4.2873e-04
Validation rmse = 0.134281
Validation r2 = 0.854325
Validation mse = 0.018031
Epoch 22
Loss = 9.5778e-02, PNorm = 35.0267, GNorm = 1.4231, lr_0 = 4.1643e-04
Validation rmse = 0.130806
Validation r2 = 0.861768
Validation mse = 0.017110
Epoch 23
Loss = 7.4618e-02, PNorm = 35.0405, GNorm = 0.7264, lr_0 = 4.0555e-04
Loss = 9.8942e-02, PNorm = 35.0517, GNorm = 1.7990, lr_0 = 3.9496e-04
Validation rmse = 0.130564
Validation r2 = 0.862278
Validation mse = 0.017047
Epoch 24
Loss = 1.0068e-01, PNorm = 35.0647, GNorm = 0.5211, lr_0 = 3.8363e-04
Validation rmse = 0.129357
Validation r2 = 0.864812
Validation mse = 0.016733
Epoch 25
Loss = 9.0888e-02, PNorm = 35.0781, GNorm = 0.6797, lr_0 = 3.7361e-04
Loss = 9.4697e-02, PNorm = 35.0889, GNorm = 2.4801, lr_0 = 3.6385e-04
Validation rmse = 0.140233
Validation r2 = 0.841126
Validation mse = 0.019665
Epoch 26
Loss = 8.9894e-02, PNorm = 35.1005, GNorm = 2.8287, lr_0 = 3.5434e-04
Loss = 1.1335e-01, PNorm = 35.1106, GNorm = 3.6162, lr_0 = 3.4509e-04
Loss = 7.2053e-02, PNorm = 35.1113, GNorm = 1.0388, lr_0 = 3.4418e-04
Validation rmse = 0.136847
Validation r2 = 0.848705
Validation mse = 0.018727
Epoch 27
Loss = 9.7627e-02, PNorm = 35.1216, GNorm = 1.2450, lr_0 = 3.3519e-04
Validation rmse = 0.128259
Validation r2 = 0.867098
Validation mse = 0.016450
Epoch 28
Loss = 9.2765e-02, PNorm = 35.1339, GNorm = 1.5625, lr_0 = 3.2643e-04
Loss = 8.9119e-02, PNorm = 35.1459, GNorm = 1.0704, lr_0 = 3.1791e-04
Validation rmse = 0.136625
Validation r2 = 0.849194
Validation mse = 0.018667
Epoch 29
Loss = 9.1918e-02, PNorm = 35.1559, GNorm = 1.3930, lr_0 = 3.0878e-04
Validation rmse = 0.129558
Validation r2 = 0.864393
Validation mse = 0.016785
Epoch 30
Loss = 7.3241e-02, PNorm = 35.1645, GNorm = 1.2192, lr_0 = 3.0072e-04
Loss = 8.2386e-02, PNorm = 35.1726, GNorm = 0.7912, lr_0 = 2.9286e-04
Validation rmse = 0.136730
Validation r2 = 0.848964
Validation mse = 0.018695
Epoch 31
Loss = 9.3416e-02, PNorm = 35.1834, GNorm = 2.6958, lr_0 = 2.8446e-04
Validation rmse = 0.129993
Validation r2 = 0.863481
Validation mse = 0.016898
Epoch 32
Loss = 7.6908e-02, PNorm = 35.1927, GNorm = 1.0054, lr_0 = 2.7703e-04
Loss = 8.4477e-02, PNorm = 35.2023, GNorm = 1.4259, lr_0 = 2.6980e-04
Validation rmse = 0.128830
Validation r2 = 0.865912
Validation mse = 0.016597
Epoch 33
Loss = 1.0974e-01, PNorm = 35.2107, GNorm = 2.3223, lr_0 = 2.6275e-04
Validation rmse = 0.130524
Validation r2 = 0.862362
Validation mse = 0.017037
Epoch 34
Loss = 6.1893e-02, PNorm = 35.2196, GNorm = 1.7945, lr_0 = 2.5521e-04
Loss = 7.8893e-02, PNorm = 35.2266, GNorm = 0.9877, lr_0 = 2.4854e-04
Validation rmse = 0.132483
Validation r2 = 0.858201
Validation mse = 0.017552
Epoch 35
Loss = 7.1486e-02, PNorm = 35.2347, GNorm = 1.1295, lr_0 = 2.4205e-04
Loss = 8.8062e-02, PNorm = 35.2422, GNorm = 0.9421, lr_0 = 2.3573e-04
Loss = 8.9238e-02, PNorm = 35.2429, GNorm = 2.0660, lr_0 = 2.3511e-04
Validation rmse = 0.128678
Validation r2 = 0.866229
Validation mse = 0.016558
Epoch 36
Loss = 8.7127e-02, PNorm = 35.2493, GNorm = 1.1039, lr_0 = 2.2897e-04
Validation rmse = 0.127873
Validation r2 = 0.867897
Validation mse = 0.016352
Epoch 37
Loss = 7.1196e-02, PNorm = 35.2577, GNorm = 1.2420, lr_0 = 2.2299e-04
Loss = 8.3792e-02, PNorm = 35.2640, GNorm = 1.6552, lr_0 = 2.1716e-04
Validation rmse = 0.133437
Validation r2 = 0.856151
Validation mse = 0.017805
Epoch 38
Loss = 9.1013e-02, PNorm = 35.2710, GNorm = 2.0794, lr_0 = 2.1149e-04
Validation rmse = 0.128186
Validation r2 = 0.867250
Validation mse = 0.016432
Epoch 39
Loss = 7.0195e-02, PNorm = 35.2787, GNorm = 0.8950, lr_0 = 2.0542e-04
Loss = 7.8740e-02, PNorm = 35.2848, GNorm = 1.4036, lr_0 = 2.0006e-04
Validation rmse = 0.135891
Validation r2 = 0.850811
Validation mse = 0.018466
Epoch 40
Loss = 7.8196e-02, PNorm = 35.2921, GNorm = 2.4809, lr_0 = 1.9483e-04
Validation rmse = 0.129022
Validation r2 = 0.865513
Validation mse = 0.016647
Epoch 41
Loss = 7.8714e-02, PNorm = 35.2981, GNorm = 1.3539, lr_0 = 1.8924e-04
Loss = 8.6603e-02, PNorm = 35.3050, GNorm = 1.1025, lr_0 = 1.8430e-04
Validation rmse = 0.127770
Validation r2 = 0.868110
Validation mse = 0.016325
Epoch 42
Loss = 7.9527e-02, PNorm = 35.3110, GNorm = 1.1396, lr_0 = 1.7948e-04
Validation rmse = 0.132179
Validation r2 = 0.858850
Validation mse = 0.017471
Epoch 43
Loss = 8.5428e-02, PNorm = 35.3176, GNorm = 2.2916, lr_0 = 1.7433e-04
Loss = 7.5530e-02, PNorm = 35.3225, GNorm = 0.5533, lr_0 = 1.6978e-04
Validation rmse = 0.128373
Validation r2 = 0.866862
Validation mse = 0.016480
Epoch 44
Loss = 7.8994e-02, PNorm = 35.3277, GNorm = 0.7791, lr_0 = 1.6534e-04
Loss = 8.6439e-02, PNorm = 35.3325, GNorm = 2.0384, lr_0 = 1.6103e-04
Validation rmse = 0.129795
Validation r2 = 0.863896
Validation mse = 0.016847
Epoch 45
Loss = 7.1819e-02, PNorm = 35.3379, GNorm = 0.7813, lr_0 = 1.5682e-04
Validation rmse = 0.129222
Validation r2 = 0.865094
Validation mse = 0.016698
Epoch 46
Loss = 7.3337e-02, PNorm = 35.3436, GNorm = 0.7201, lr_0 = 1.5232e-04
Loss = 7.8154e-02, PNorm = 35.3484, GNorm = 1.7175, lr_0 = 1.4834e-04
Validation rmse = 0.127563
Validation r2 = 0.868536
Validation mse = 0.016272
Epoch 47
Loss = 7.5932e-02, PNorm = 35.3535, GNorm = 0.6560, lr_0 = 1.4447e-04
Validation rmse = 0.129429
Validation r2 = 0.864663
Validation mse = 0.016752
Epoch 48
Loss = 7.7587e-02, PNorm = 35.3583, GNorm = 1.1701, lr_0 = 1.4032e-04
Loss = 7.2016e-02, PNorm = 35.3626, GNorm = 1.2621, lr_0 = 1.3666e-04
Validation rmse = 0.128202
Validation r2 = 0.867217
Validation mse = 0.016436
Epoch 49
Loss = 7.1963e-02, PNorm = 35.3667, GNorm = 0.5179, lr_0 = 1.3309e-04
Validation rmse = 0.129317
Validation r2 = 0.864896
Validation mse = 0.016723
Epoch 50
Loss = 7.6479e-02, PNorm = 35.3713, GNorm = 1.6189, lr_0 = 1.2961e-04
Loss = 8.0449e-02, PNorm = 35.3755, GNorm = 1.0362, lr_0 = 1.2623e-04
Validation rmse = 0.127650
Validation r2 = 0.868357
Validation mse = 0.016295
Epoch 51
Loss = 7.5042e-02, PNorm = 35.3793, GNorm = 0.7241, lr_0 = 1.2260e-04
Loss = 6.8421e-02, PNorm = 35.3828, GNorm = 1.0554, lr_0 = 1.1940e-04
Validation rmse = 0.127497
Validation r2 = 0.868672
Validation mse = 0.016256
Epoch 52
Loss = 6.9253e-02, PNorm = 35.3859, GNorm = 0.5566, lr_0 = 1.1628e-04
Validation rmse = 0.127070
Validation r2 = 0.869550
Validation mse = 0.016147
Epoch 53
Loss = 8.4689e-02, PNorm = 35.3900, GNorm = 0.6259, lr_0 = 1.1295e-04
Loss = 6.3441e-02, PNorm = 35.3931, GNorm = 1.3650, lr_0 = 1.1000e-04
Validation rmse = 0.127702
Validation r2 = 0.868251
Validation mse = 0.016308
Epoch 54
Loss = 6.9940e-02, PNorm = 35.3972, GNorm = 0.7773, lr_0 = 1.0712e-04
Validation rmse = 0.127709
Validation r2 = 0.868236
Validation mse = 0.016310
Epoch 55
Loss = 8.7736e-02, PNorm = 35.4010, GNorm = 0.5352, lr_0 = 1.0405e-04
Loss = 6.8557e-02, PNorm = 35.4046, GNorm = 0.6006, lr_0 = 1.0133e-04
Validation rmse = 0.127850
Validation r2 = 0.867945
Validation mse = 0.016346
Epoch 56
Loss = 6.6375e-02, PNorm = 35.4078, GNorm = 0.9641, lr_0 = 1.0000e-04
Validation rmse = 0.126670
Validation r2 = 0.870371
Validation mse = 0.016045
Epoch 57
Loss = 7.7332e-02, PNorm = 35.4106, GNorm = 1.4166, lr_0 = 1.0000e-04
Loss = 6.7913e-02, PNorm = 35.4135, GNorm = 1.1341, lr_0 = 1.0000e-04
Validation rmse = 0.126525
Validation r2 = 0.870668
Validation mse = 0.016008
Epoch 58
Loss = 6.6069e-02, PNorm = 35.4173, GNorm = 0.7723, lr_0 = 1.0000e-04
Validation rmse = 0.126754
Validation r2 = 0.870199
Validation mse = 0.016067
Epoch 59
Loss = 8.0601e-02, PNorm = 35.4207, GNorm = 0.5970, lr_0 = 1.0000e-04
Loss = 6.7653e-02, PNorm = 35.4242, GNorm = 0.5901, lr_0 = 1.0000e-04
Validation rmse = 0.125938
Validation r2 = 0.871865
Validation mse = 0.015860
Model 0 best validation rmse = 0.125938 on epoch 59
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.527136
Model 0 test r2 = -2.693726
Model 0 test mse = 0.277873
Ensemble test rmse = 0.527136
Ensemble test r2 = -2.693726
Ensemble test mse = 0.277873
Fold 8
Splitting data with seed 8
Total size = 974 | train size = 779 | val size = 195 | test size = 48
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.0808e-01, PNorm = 34.0176, GNorm = 3.0642, lr_0 = 4.3000e-04
Validation rmse = 0.259937
Validation r2 = 0.367847
Validation mse = 0.067567
Epoch 1
Loss = 6.6492e-01, PNorm = 34.0557, GNorm = 10.2107, lr_0 = 7.6000e-04
Loss = 5.8874e-01, PNorm = 34.1086, GNorm = 5.2426, lr_0 = 9.9472e-04
Validation rmse = 0.213876
Validation r2 = 0.572031
Validation mse = 0.045743
Epoch 2
Loss = 4.6383e-01, PNorm = 34.1828, GNorm = 9.7815, lr_0 = 9.6874e-04
Validation rmse = 0.184495
Validation r2 = 0.681540
Validation mse = 0.034038
Epoch 3
Loss = 3.7059e-01, PNorm = 34.2561, GNorm = 0.6115, lr_0 = 9.4094e-04
Loss = 3.5820e-01, PNorm = 34.3066, GNorm = 10.3567, lr_0 = 9.1637e-04
Validation rmse = 0.211394
Validation r2 = 0.581906
Validation mse = 0.044688
Epoch 4
Loss = 2.8767e-01, PNorm = 34.3532, GNorm = 1.0879, lr_0 = 8.9243e-04
Validation rmse = 0.182064
Validation r2 = 0.689876
Validation mse = 0.033147
Epoch 5
Loss = 2.9103e-01, PNorm = 34.3964, GNorm = 2.3362, lr_0 = 8.6682e-04
Loss = 2.0981e-01, PNorm = 34.4367, GNorm = 2.7767, lr_0 = 8.4418e-04
Validation rmse = 0.149605
Validation r2 = 0.790599
Validation mse = 0.022382
Epoch 6
Loss = 2.0080e-01, PNorm = 34.4710, GNorm = 2.2333, lr_0 = 8.2213e-04
Validation rmse = 0.142981
Validation r2 = 0.808730
Validation mse = 0.020444
Epoch 7
Loss = 1.6908e-01, PNorm = 34.5079, GNorm = 0.9378, lr_0 = 8.0066e-04
Loss = 1.8074e-01, PNorm = 34.5448, GNorm = 0.9342, lr_0 = 7.7975e-04
Validation rmse = 0.139070
Validation r2 = 0.819053
Validation mse = 0.019340
Epoch 8
Loss = 1.5153e-01, PNorm = 34.5795, GNorm = 1.5168, lr_0 = 7.5737e-04
Loss = 1.7453e-01, PNorm = 34.6075, GNorm = 2.9126, lr_0 = 7.3759e-04
Validation rmse = 0.139144
Validation r2 = 0.818859
Validation mse = 0.019361
Epoch 9
Loss = 1.5091e-01, PNorm = 34.6342, GNorm = 4.8792, lr_0 = 7.1833e-04
Validation rmse = 0.131691
Validation r2 = 0.837745
Validation mse = 0.017342
Epoch 10
Loss = 1.2788e-01, PNorm = 34.6665, GNorm = 2.7548, lr_0 = 6.9772e-04
Loss = 1.4956e-01, PNorm = 34.6963, GNorm = 2.7605, lr_0 = 6.7949e-04
Validation rmse = 0.146954
Validation r2 = 0.797954
Validation mse = 0.021596
Epoch 11
Loss = 1.4747e-01, PNorm = 34.7182, GNorm = 3.0229, lr_0 = 6.6174e-04
Validation rmse = 0.132983
Validation r2 = 0.834544
Validation mse = 0.017685
Epoch 12
Loss = 1.3402e-01, PNorm = 34.7423, GNorm = 4.4165, lr_0 = 6.4276e-04
Loss = 1.5163e-01, PNorm = 34.7638, GNorm = 2.7573, lr_0 = 6.2597e-04
Validation rmse = 0.150789
Validation r2 = 0.787271
Validation mse = 0.022737
Epoch 13
Loss = 1.4283e-01, PNorm = 34.7877, GNorm = 1.6395, lr_0 = 6.0962e-04
Validation rmse = 0.126351
Validation r2 = 0.850637
Validation mse = 0.015965
Epoch 14
Loss = 1.0317e-01, PNorm = 34.8044, GNorm = 2.6455, lr_0 = 5.9369e-04
Loss = 1.2939e-01, PNorm = 34.8271, GNorm = 1.3370, lr_0 = 5.7819e-04
Validation rmse = 0.124111
Validation r2 = 0.855886
Validation mse = 0.015404
Epoch 15
Loss = 1.0871e-01, PNorm = 34.8435, GNorm = 1.6990, lr_0 = 5.6160e-04
Validation rmse = 0.125046
Validation r2 = 0.853706
Validation mse = 0.015636
Epoch 16
Loss = 8.2018e-02, PNorm = 34.8606, GNorm = 0.9458, lr_0 = 5.4693e-04
Loss = 1.2407e-01, PNorm = 34.8746, GNorm = 6.6148, lr_0 = 5.3264e-04
Validation rmse = 0.124117
Validation r2 = 0.855872
Validation mse = 0.015405
Epoch 17
Loss = 1.3804e-01, PNorm = 34.8926, GNorm = 2.9169, lr_0 = 5.1736e-04
Loss = 1.0290e-01, PNorm = 34.9131, GNorm = 1.3634, lr_0 = 5.0385e-04
Validation rmse = 0.124745
Validation r2 = 0.854409
Validation mse = 0.015561
Epoch 18
Loss = 1.0192e-01, PNorm = 34.9316, GNorm = 1.3224, lr_0 = 4.9069e-04
Validation rmse = 0.124687
Validation r2 = 0.854545
Validation mse = 0.015547
Epoch 19
Loss = 9.8805e-02, PNorm = 34.9451, GNorm = 1.0094, lr_0 = 4.7787e-04
Loss = 1.0109e-01, PNorm = 34.9617, GNorm = 0.8361, lr_0 = 4.6539e-04
Validation rmse = 0.128434
Validation r2 = 0.845672
Validation mse = 0.016495
Epoch 20
Loss = 1.0724e-01, PNorm = 34.9764, GNorm = 1.5099, lr_0 = 4.5204e-04
Validation rmse = 0.139356
Validation r2 = 0.818308
Validation mse = 0.019420
Epoch 21
Loss = 1.1090e-01, PNorm = 34.9922, GNorm = 1.0623, lr_0 = 4.4023e-04
Loss = 1.1369e-01, PNorm = 35.0094, GNorm = 0.5990, lr_0 = 4.2873e-04
Validation rmse = 0.127717
Validation r2 = 0.847388
Validation mse = 0.016312
Epoch 22
Loss = 1.0311e-01, PNorm = 35.0258, GNorm = 2.4090, lr_0 = 4.1643e-04
Validation rmse = 0.126118
Validation r2 = 0.851187
Validation mse = 0.015906
Epoch 23
Loss = 5.5994e-02, PNorm = 35.0369, GNorm = 0.6694, lr_0 = 4.0555e-04
Loss = 9.4107e-02, PNorm = 35.0517, GNorm = 1.2774, lr_0 = 3.9496e-04
Validation rmse = 0.137555
Validation r2 = 0.822972
Validation mse = 0.018921
Epoch 24
Loss = 1.0243e-01, PNorm = 35.0648, GNorm = 1.3008, lr_0 = 3.8363e-04
Validation rmse = 0.127000
Validation r2 = 0.849098
Validation mse = 0.016129
Epoch 25
Loss = 1.5220e-01, PNorm = 35.0775, GNorm = 3.1179, lr_0 = 3.7361e-04
Loss = 9.7546e-02, PNorm = 35.0911, GNorm = 1.1593, lr_0 = 3.6385e-04
Validation rmse = 0.138062
Validation r2 = 0.821666
Validation mse = 0.019061
Epoch 26
Loss = 1.1796e-01, PNorm = 35.1023, GNorm = 2.4524, lr_0 = 3.5434e-04
Loss = 9.6273e-02, PNorm = 35.1138, GNorm = 1.4894, lr_0 = 3.4509e-04
Loss = 1.1534e-01, PNorm = 35.1152, GNorm = 2.2672, lr_0 = 3.4418e-04
Validation rmse = 0.122671
Validation r2 = 0.859211
Validation mse = 0.015048
Epoch 27
Loss = 9.2159e-02, PNorm = 35.1275, GNorm = 0.9139, lr_0 = 3.3519e-04
Validation rmse = 0.123597
Validation r2 = 0.857077
Validation mse = 0.015276
Epoch 28
Loss = 7.1966e-02, PNorm = 35.1397, GNorm = 1.1137, lr_0 = 3.2643e-04
Loss = 9.0915e-02, PNorm = 35.1517, GNorm = 1.3165, lr_0 = 3.1791e-04
Validation rmse = 0.122370
Validation r2 = 0.859901
Validation mse = 0.014974
Epoch 29
Loss = 8.9756e-02, PNorm = 35.1643, GNorm = 1.3370, lr_0 = 3.0878e-04
Validation rmse = 0.120624
Validation r2 = 0.863869
Validation mse = 0.014550
Epoch 30
Loss = 7.2653e-02, PNorm = 35.1751, GNorm = 1.4335, lr_0 = 3.0072e-04
Loss = 9.3931e-02, PNorm = 35.1842, GNorm = 2.7267, lr_0 = 2.9286e-04
Validation rmse = 0.123503
Validation r2 = 0.857294
Validation mse = 0.015253
Epoch 31
Loss = 9.4145e-02, PNorm = 35.1959, GNorm = 1.5331, lr_0 = 2.8446e-04
Validation rmse = 0.121550
Validation r2 = 0.861773
Validation mse = 0.014774
Epoch 32
Loss = 8.2594e-02, PNorm = 35.2068, GNorm = 0.7748, lr_0 = 2.7703e-04
Loss = 8.9694e-02, PNorm = 35.2143, GNorm = 1.0394, lr_0 = 2.6980e-04
Validation rmse = 0.123472
Validation r2 = 0.857366
Validation mse = 0.015245
Epoch 33
Loss = 8.2761e-02, PNorm = 35.2236, GNorm = 2.3842, lr_0 = 2.6275e-04
Validation rmse = 0.122845
Validation r2 = 0.858810
Validation mse = 0.015091
Epoch 34
Loss = 5.9534e-02, PNorm = 35.2339, GNorm = 0.9073, lr_0 = 2.5521e-04
Loss = 1.0034e-01, PNorm = 35.2441, GNorm = 1.8427, lr_0 = 2.4854e-04
Validation rmse = 0.123415
Validation r2 = 0.857497
Validation mse = 0.015231
Epoch 35
Loss = 8.2959e-02, PNorm = 35.2522, GNorm = 1.4728, lr_0 = 2.4205e-04
Loss = 8.5693e-02, PNorm = 35.2609, GNorm = 0.7299, lr_0 = 2.3573e-04
Loss = 7.9174e-02, PNorm = 35.2616, GNorm = 1.6626, lr_0 = 2.3511e-04
Validation rmse = 0.120030
Validation r2 = 0.865206
Validation mse = 0.014407
Epoch 36
Loss = 8.0956e-02, PNorm = 35.2692, GNorm = 0.8147, lr_0 = 2.2897e-04
Validation rmse = 0.123385
Validation r2 = 0.857567
Validation mse = 0.015224
Epoch 37
Loss = 7.2656e-02, PNorm = 35.2769, GNorm = 0.5496, lr_0 = 2.2299e-04
Loss = 8.6445e-02, PNorm = 35.2853, GNorm = 2.0020, lr_0 = 2.1716e-04
Validation rmse = 0.120765
Validation r2 = 0.863552
Validation mse = 0.014584
Epoch 38
Loss = 7.8316e-02, PNorm = 35.2941, GNorm = 1.7325, lr_0 = 2.1149e-04
Validation rmse = 0.120504
Validation r2 = 0.864141
Validation mse = 0.014521
Epoch 39
Loss = 6.3868e-02, PNorm = 35.3018, GNorm = 1.4988, lr_0 = 2.0542e-04
Loss = 8.9338e-02, PNorm = 35.3090, GNorm = 2.9321, lr_0 = 2.0006e-04
Validation rmse = 0.121323
Validation r2 = 0.862287
Validation mse = 0.014719
Epoch 40
Loss = 7.8172e-02, PNorm = 35.3167, GNorm = 0.7892, lr_0 = 1.9483e-04
Validation rmse = 0.120306
Validation r2 = 0.864586
Validation mse = 0.014474
Epoch 41
Loss = 6.6170e-02, PNorm = 35.3239, GNorm = 1.2081, lr_0 = 1.8924e-04
Loss = 7.4142e-02, PNorm = 35.3299, GNorm = 1.8753, lr_0 = 1.8430e-04
Validation rmse = 0.123408
Validation r2 = 0.857514
Validation mse = 0.015229
Epoch 42
Loss = 7.5112e-02, PNorm = 35.3366, GNorm = 2.1560, lr_0 = 1.7948e-04
Validation rmse = 0.121850
Validation r2 = 0.861088
Validation mse = 0.014848
Epoch 43
Loss = 6.9109e-02, PNorm = 35.3441, GNorm = 1.0568, lr_0 = 1.7433e-04
Loss = 8.4382e-02, PNorm = 35.3496, GNorm = 0.6976, lr_0 = 1.6978e-04
Validation rmse = 0.119844
Validation r2 = 0.865625
Validation mse = 0.014363
Epoch 44
Loss = 7.4045e-02, PNorm = 35.3556, GNorm = 0.8502, lr_0 = 1.6534e-04
Loss = 7.2507e-02, PNorm = 35.3619, GNorm = 1.0907, lr_0 = 1.6103e-04
Validation rmse = 0.120401
Validation r2 = 0.864372
Validation mse = 0.014496
Epoch 45
Loss = 7.5968e-02, PNorm = 35.3675, GNorm = 1.2316, lr_0 = 1.5682e-04
Validation rmse = 0.120824
Validation r2 = 0.863419
Validation mse = 0.014598
Epoch 46
Loss = 8.3097e-02, PNorm = 35.3742, GNorm = 1.1157, lr_0 = 1.5232e-04
Loss = 7.4399e-02, PNorm = 35.3801, GNorm = 1.8595, lr_0 = 1.4834e-04
Validation rmse = 0.121916
Validation r2 = 0.860937
Validation mse = 0.014864
Epoch 47
Loss = 7.3307e-02, PNorm = 35.3848, GNorm = 0.8534, lr_0 = 1.4447e-04
Validation rmse = 0.119942
Validation r2 = 0.865404
Validation mse = 0.014386
Epoch 48
Loss = 6.8589e-02, PNorm = 35.3906, GNorm = 0.6202, lr_0 = 1.4032e-04
Loss = 7.4910e-02, PNorm = 35.3960, GNorm = 0.9455, lr_0 = 1.3666e-04
Validation rmse = 0.119584
Validation r2 = 0.866208
Validation mse = 0.014300
Epoch 49
Loss = 7.2843e-02, PNorm = 35.4002, GNorm = 1.1561, lr_0 = 1.3309e-04
Validation rmse = 0.119548
Validation r2 = 0.866289
Validation mse = 0.014292
Epoch 50
Loss = 6.8999e-02, PNorm = 35.4045, GNorm = 0.7426, lr_0 = 1.2961e-04
Loss = 6.8590e-02, PNorm = 35.4099, GNorm = 0.5221, lr_0 = 1.2623e-04
Validation rmse = 0.122055
Validation r2 = 0.860621
Validation mse = 0.014897
Epoch 51
Loss = 5.9315e-02, PNorm = 35.4141, GNorm = 0.3165, lr_0 = 1.2260e-04
Loss = 7.4293e-02, PNorm = 35.4182, GNorm = 0.6919, lr_0 = 1.1940e-04
Validation rmse = 0.119327
Validation r2 = 0.866783
Validation mse = 0.014239
Epoch 52
Loss = 6.2158e-02, PNorm = 35.4227, GNorm = 0.9093, lr_0 = 1.1628e-04
Validation rmse = 0.120854
Validation r2 = 0.863350
Validation mse = 0.014606
Epoch 53
Loss = 6.8968e-02, PNorm = 35.4277, GNorm = 0.5897, lr_0 = 1.1295e-04
Loss = 6.8926e-02, PNorm = 35.4316, GNorm = 0.7165, lr_0 = 1.1000e-04
Validation rmse = 0.119954
Validation r2 = 0.865377
Validation mse = 0.014389
Epoch 54
Loss = 7.1865e-02, PNorm = 35.4353, GNorm = 0.4614, lr_0 = 1.0712e-04
Validation rmse = 0.119663
Validation r2 = 0.866031
Validation mse = 0.014319
Epoch 55
Loss = 4.7913e-02, PNorm = 35.4395, GNorm = 0.7780, lr_0 = 1.0405e-04
Loss = 7.9065e-02, PNorm = 35.4428, GNorm = 0.9144, lr_0 = 1.0133e-04
Validation rmse = 0.119863
Validation r2 = 0.865583
Validation mse = 0.014367
Epoch 56
Loss = 6.3185e-02, PNorm = 35.4464, GNorm = 1.1752, lr_0 = 1.0000e-04
Validation rmse = 0.122445
Validation r2 = 0.859728
Validation mse = 0.014993
Epoch 57
Loss = 6.3940e-02, PNorm = 35.4498, GNorm = 1.6034, lr_0 = 1.0000e-04
Loss = 6.5343e-02, PNorm = 35.4536, GNorm = 1.9234, lr_0 = 1.0000e-04
Validation rmse = 0.122856
Validation r2 = 0.858785
Validation mse = 0.015094
Epoch 58
Loss = 7.1355e-02, PNorm = 35.4577, GNorm = 0.9105, lr_0 = 1.0000e-04
Validation rmse = 0.120354
Validation r2 = 0.864479
Validation mse = 0.014485
Epoch 59
Loss = 5.3311e-02, PNorm = 35.4614, GNorm = 0.4509, lr_0 = 1.0000e-04
Loss = 6.7459e-02, PNorm = 35.4650, GNorm = 0.5889, lr_0 = 1.0000e-04
Validation rmse = 0.122384
Validation r2 = 0.859869
Validation mse = 0.014978
Model 0 best validation rmse = 0.119327 on epoch 51
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.559945
Model 0 test r2 = -3.167827
Model 0 test mse = 0.313539
Ensemble test rmse = 0.559945
Ensemble test r2 = -3.167827
Ensemble test mse = 0.313539
Fold 9
Splitting data with seed 9
Total size = 974 | train size = 779 | val size = 195 | test size = 48
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1963e-01, PNorm = 34.0178, GNorm = 0.9191, lr_0 = 4.3000e-04
Validation rmse = 0.315811
Validation r2 = 0.188312
Validation mse = 0.099736
Epoch 1
Loss = 7.5797e-01, PNorm = 34.0422, GNorm = 3.6903, lr_0 = 7.6000e-04
Loss = 5.9347e-01, PNorm = 34.1004, GNorm = 8.7329, lr_0 = 9.9472e-04
Validation rmse = 0.257500
Validation r2 = 0.460377
Validation mse = 0.066306
Epoch 2
Loss = 4.9114e-01, PNorm = 34.1675, GNorm = 7.0103, lr_0 = 9.6874e-04
Validation rmse = 0.196556
Validation r2 = 0.685580
Validation mse = 0.038634
Epoch 3
Loss = 4.0470e-01, PNorm = 34.2376, GNorm = 4.3695, lr_0 = 9.4094e-04
Loss = 2.6687e-01, PNorm = 34.2958, GNorm = 1.1166, lr_0 = 9.1637e-04
Validation rmse = 0.165198
Validation r2 = 0.777902
Validation mse = 0.027290
Epoch 4
Loss = 2.6434e-01, PNorm = 34.3498, GNorm = 1.3082, lr_0 = 8.9243e-04
Validation rmse = 0.233340
Validation r2 = 0.556886
Validation mse = 0.054448
Epoch 5
Loss = 3.7590e-01, PNorm = 34.3994, GNorm = 7.2905, lr_0 = 8.6682e-04
Loss = 2.5989e-01, PNorm = 34.4401, GNorm = 3.2373, lr_0 = 8.4418e-04
Validation rmse = 0.143022
Validation r2 = 0.833529
Validation mse = 0.020455
Epoch 6
Loss = 2.1425e-01, PNorm = 34.4785, GNorm = 3.5846, lr_0 = 8.2213e-04
Validation rmse = 0.136826
Validation r2 = 0.847640
Validation mse = 0.018721
Epoch 7
Loss = 1.3326e-01, PNorm = 34.5157, GNorm = 1.3773, lr_0 = 8.0066e-04
Loss = 1.9535e-01, PNorm = 34.5454, GNorm = 4.4691, lr_0 = 7.7975e-04
Validation rmse = 0.141121
Validation r2 = 0.837924
Validation mse = 0.019915
Epoch 8
Loss = 1.5624e-01, PNorm = 34.5840, GNorm = 1.6906, lr_0 = 7.5737e-04
Loss = 1.6853e-01, PNorm = 34.6090, GNorm = 1.6579, lr_0 = 7.3759e-04
Validation rmse = 0.160551
Validation r2 = 0.790220
Validation mse = 0.025777
Epoch 9
Loss = 1.7036e-01, PNorm = 34.6373, GNorm = 6.0708, lr_0 = 7.1833e-04
Validation rmse = 0.166263
Validation r2 = 0.775030
Validation mse = 0.027643
Epoch 10
Loss = 1.9532e-01, PNorm = 34.6650, GNorm = 7.0139, lr_0 = 6.9772e-04
Loss = 1.4272e-01, PNorm = 34.6928, GNorm = 1.6603, lr_0 = 6.7949e-04
Validation rmse = 0.126834
Validation r2 = 0.869079
Validation mse = 0.016087
Epoch 11
Loss = 1.3196e-01, PNorm = 34.7177, GNorm = 1.0389, lr_0 = 6.6174e-04
Validation rmse = 0.128147
Validation r2 = 0.866355
Validation mse = 0.016422
Epoch 12
Loss = 1.0503e-01, PNorm = 34.7424, GNorm = 3.0123, lr_0 = 6.4276e-04
Loss = 1.3869e-01, PNorm = 34.7597, GNorm = 1.7019, lr_0 = 6.2597e-04
Validation rmse = 0.134921
Validation r2 = 0.851853
Validation mse = 0.018204
Epoch 13
Loss = 1.5487e-01, PNorm = 34.7773, GNorm = 1.5851, lr_0 = 6.0962e-04
Validation rmse = 0.129669
Validation r2 = 0.863161
Validation mse = 0.016814
Epoch 14
Loss = 1.1384e-01, PNorm = 34.7972, GNorm = 1.3560, lr_0 = 5.9369e-04
Loss = 1.2792e-01, PNorm = 34.8130, GNorm = 1.9384, lr_0 = 5.7819e-04
Validation rmse = 0.123592
Validation r2 = 0.875686
Validation mse = 0.015275
Epoch 15
Loss = 1.2037e-01, PNorm = 34.8312, GNorm = 0.6217, lr_0 = 5.6160e-04
Validation rmse = 0.142677
Validation r2 = 0.834331
Validation mse = 0.020357
Epoch 16
Loss = 1.8945e-01, PNorm = 34.8479, GNorm = 5.5682, lr_0 = 5.4693e-04
Loss = 1.2664e-01, PNorm = 34.8612, GNorm = 2.7110, lr_0 = 5.3264e-04
Validation rmse = 0.126004
Validation r2 = 0.870788
Validation mse = 0.015877
Epoch 17
Loss = 1.3695e-01, PNorm = 34.8770, GNorm = 1.8104, lr_0 = 5.1736e-04
Loss = 1.0082e-01, PNorm = 34.8903, GNorm = 1.6706, lr_0 = 5.0385e-04
Validation rmse = 0.132102
Validation r2 = 0.857979
Validation mse = 0.017451
Epoch 18
Loss = 1.1328e-01, PNorm = 34.9029, GNorm = 1.0616, lr_0 = 4.9069e-04
Validation rmse = 0.131904
Validation r2 = 0.858404
Validation mse = 0.017399
Epoch 19
Loss = 1.0579e-01, PNorm = 34.9185, GNorm = 0.9251, lr_0 = 4.7787e-04
Loss = 1.0953e-01, PNorm = 34.9307, GNorm = 1.1238, lr_0 = 4.6539e-04
Validation rmse = 0.123036
Validation r2 = 0.876804
Validation mse = 0.015138
Epoch 20
Loss = 1.0864e-01, PNorm = 34.9432, GNorm = 3.0455, lr_0 = 4.5204e-04
Validation rmse = 0.132999
Validation r2 = 0.856042
Validation mse = 0.017689
Epoch 21
Loss = 1.5810e-01, PNorm = 34.9571, GNorm = 3.2591, lr_0 = 4.4023e-04
Loss = 1.1648e-01, PNorm = 34.9709, GNorm = 3.2974, lr_0 = 4.2873e-04
Validation rmse = 0.124487
Validation r2 = 0.873880
Validation mse = 0.015497
Epoch 22
Loss = 1.0543e-01, PNorm = 34.9846, GNorm = 2.6715, lr_0 = 4.1643e-04
Validation rmse = 0.129968
Validation r2 = 0.862531
Validation mse = 0.016892
Epoch 23
Loss = 1.0628e-01, PNorm = 34.9950, GNorm = 2.9196, lr_0 = 4.0555e-04
Loss = 1.1336e-01, PNorm = 35.0090, GNorm = 2.3276, lr_0 = 3.9496e-04
Validation rmse = 0.119174
Validation r2 = 0.884415
Validation mse = 0.014203
Epoch 24
Loss = 1.0421e-01, PNorm = 35.0237, GNorm = 0.8357, lr_0 = 3.8363e-04
Validation rmse = 0.120261
Validation r2 = 0.882297
Validation mse = 0.014463
Epoch 25
Loss = 1.1254e-01, PNorm = 35.0350, GNorm = 1.1269, lr_0 = 3.7361e-04
Loss = 1.0738e-01, PNorm = 35.0457, GNorm = 4.4975, lr_0 = 3.6385e-04
Validation rmse = 0.126751
Validation r2 = 0.869251
Validation mse = 0.016066
Epoch 26
Loss = 9.4095e-02, PNorm = 35.0565, GNorm = 1.7660, lr_0 = 3.5434e-04
Loss = 1.0008e-01, PNorm = 35.0659, GNorm = 0.5817, lr_0 = 3.4509e-04
Loss = 1.1351e-01, PNorm = 35.0671, GNorm = 0.9538, lr_0 = 3.4418e-04
Validation rmse = 0.125827
Validation r2 = 0.871151
Validation mse = 0.015832
Epoch 27
Loss = 9.2761e-02, PNorm = 35.0776, GNorm = 2.3716, lr_0 = 3.3519e-04
Validation rmse = 0.124692
Validation r2 = 0.873465
Validation mse = 0.015548
Epoch 28
Loss = 7.7836e-02, PNorm = 35.0862, GNorm = 2.5578, lr_0 = 3.2643e-04
Loss = 1.0172e-01, PNorm = 35.0939, GNorm = 0.7750, lr_0 = 3.1791e-04
Validation rmse = 0.121303
Validation r2 = 0.880248
Validation mse = 0.014715
Epoch 29
Loss = 1.0047e-01, PNorm = 35.1047, GNorm = 1.8992, lr_0 = 3.0878e-04
Validation rmse = 0.128368
Validation r2 = 0.865893
Validation mse = 0.016478
Epoch 30
Loss = 9.1821e-02, PNorm = 35.1136, GNorm = 0.7423, lr_0 = 3.0072e-04
Loss = 9.5819e-02, PNorm = 35.1229, GNorm = 1.5476, lr_0 = 2.9286e-04
Validation rmse = 0.121344
Validation r2 = 0.880168
Validation mse = 0.014724
Epoch 31
Loss = 9.2694e-02, PNorm = 35.1324, GNorm = 1.2337, lr_0 = 2.8446e-04
Validation rmse = 0.120847
Validation r2 = 0.881148
Validation mse = 0.014604
Epoch 32
Loss = 1.0632e-01, PNorm = 35.1412, GNorm = 3.2073, lr_0 = 2.7703e-04
Loss = 9.0765e-02, PNorm = 35.1495, GNorm = 0.9580, lr_0 = 2.6980e-04
Validation rmse = 0.123704
Validation r2 = 0.875461
Validation mse = 0.015303
Epoch 33
Loss = 9.6888e-02, PNorm = 35.1575, GNorm = 1.1457, lr_0 = 2.6275e-04
Validation rmse = 0.122672
Validation r2 = 0.877531
Validation mse = 0.015048
Epoch 34
Loss = 6.8497e-02, PNorm = 35.1670, GNorm = 1.5240, lr_0 = 2.5521e-04
Loss = 9.3791e-02, PNorm = 35.1738, GNorm = 2.8487, lr_0 = 2.4854e-04
Validation rmse = 0.121734
Validation r2 = 0.879397
Validation mse = 0.014819
Epoch 35
Loss = 1.0538e-01, PNorm = 35.1814, GNorm = 4.0562, lr_0 = 2.4205e-04
Loss = 9.0449e-02, PNorm = 35.1888, GNorm = 1.5196, lr_0 = 2.3573e-04
Loss = 8.4336e-02, PNorm = 35.1895, GNorm = 2.9539, lr_0 = 2.3511e-04
Validation rmse = 0.123160
Validation r2 = 0.876555
Validation mse = 0.015168
Epoch 36
Loss = 8.9571e-02, PNorm = 35.1972, GNorm = 2.5332, lr_0 = 2.2897e-04
Validation rmse = 0.125806
Validation r2 = 0.871194
Validation mse = 0.015827
Epoch 37
Loss = 8.8175e-02, PNorm = 35.2042, GNorm = 0.9428, lr_0 = 2.2299e-04
Loss = 9.4690e-02, PNorm = 35.2101, GNorm = 1.3046, lr_0 = 2.1716e-04
Validation rmse = 0.125095
Validation r2 = 0.872646
Validation mse = 0.015649
Epoch 38
Loss = 8.5219e-02, PNorm = 35.2182, GNorm = 2.1242, lr_0 = 2.1149e-04
Validation rmse = 0.118996
Validation r2 = 0.884761
Validation mse = 0.014160
Epoch 39
Loss = 9.5314e-02, PNorm = 35.2245, GNorm = 1.0278, lr_0 = 2.0542e-04
Loss = 7.5207e-02, PNorm = 35.2298, GNorm = 0.8043, lr_0 = 2.0006e-04
Validation rmse = 0.120649
Validation r2 = 0.881536
Validation mse = 0.014556
Epoch 40
Loss = 7.7650e-02, PNorm = 35.2357, GNorm = 0.9165, lr_0 = 1.9483e-04
Validation rmse = 0.120097
Validation r2 = 0.882618
Validation mse = 0.014423
Epoch 41
Loss = 7.2366e-02, PNorm = 35.2425, GNorm = 2.5882, lr_0 = 1.8924e-04
Loss = 8.3084e-02, PNorm = 35.2467, GNorm = 0.9414, lr_0 = 1.8430e-04
Validation rmse = 0.123028
Validation r2 = 0.876818
Validation mse = 0.015136
Epoch 42
Loss = 8.1255e-02, PNorm = 35.2527, GNorm = 0.4339, lr_0 = 1.7948e-04
Validation rmse = 0.119757
Validation r2 = 0.883283
Validation mse = 0.014342
Epoch 43
Loss = 6.4062e-02, PNorm = 35.2594, GNorm = 1.1587, lr_0 = 1.7433e-04
Loss = 9.2688e-02, PNorm = 35.2646, GNorm = 1.2073, lr_0 = 1.6978e-04
Validation rmse = 0.121819
Validation r2 = 0.879228
Validation mse = 0.014840
Epoch 44
Loss = 8.6974e-02, PNorm = 35.2695, GNorm = 1.7759, lr_0 = 1.6534e-04
Loss = 7.9340e-02, PNorm = 35.2740, GNorm = 1.7983, lr_0 = 1.6103e-04
Validation rmse = 0.118863
Validation r2 = 0.885017
Validation mse = 0.014129
Epoch 45
Loss = 8.3205e-02, PNorm = 35.2798, GNorm = 1.3340, lr_0 = 1.5682e-04
Validation rmse = 0.120598
Validation r2 = 0.881637
Validation mse = 0.014544
Epoch 46
Loss = 7.3459e-02, PNorm = 35.2851, GNorm = 0.8438, lr_0 = 1.5232e-04
Loss = 8.1094e-02, PNorm = 35.2899, GNorm = 1.4689, lr_0 = 1.4834e-04
Validation rmse = 0.119705
Validation r2 = 0.883383
Validation mse = 0.014329
Epoch 47
Loss = 8.9520e-02, PNorm = 35.2947, GNorm = 1.6246, lr_0 = 1.4447e-04
Validation rmse = 0.121049
Validation r2 = 0.880750
Validation mse = 0.014653
Epoch 48
Loss = 9.2738e-02, PNorm = 35.2991, GNorm = 0.8738, lr_0 = 1.4032e-04
Loss = 7.4110e-02, PNorm = 35.3036, GNorm = 0.6806, lr_0 = 1.3666e-04
Validation rmse = 0.120934
Validation r2 = 0.880977
Validation mse = 0.014625
Epoch 49
Loss = 8.2967e-02, PNorm = 35.3075, GNorm = 1.0138, lr_0 = 1.3309e-04
Validation rmse = 0.123101
Validation r2 = 0.876674
Validation mse = 0.015154
Epoch 50
Loss = 7.9207e-02, PNorm = 35.3114, GNorm = 0.7494, lr_0 = 1.2961e-04
Loss = 8.2574e-02, PNorm = 35.3151, GNorm = 0.5571, lr_0 = 1.2623e-04
Validation rmse = 0.118552
Validation r2 = 0.885620
Validation mse = 0.014055
Epoch 51
Loss = 7.7217e-02, PNorm = 35.3195, GNorm = 1.1954, lr_0 = 1.2260e-04
Loss = 7.7308e-02, PNorm = 35.3230, GNorm = 1.7324, lr_0 = 1.1940e-04
Validation rmse = 0.121403
Validation r2 = 0.880052
Validation mse = 0.014739
Epoch 52
Loss = 7.6428e-02, PNorm = 35.3265, GNorm = 1.3519, lr_0 = 1.1628e-04
Validation rmse = 0.118220
Validation r2 = 0.886259
Validation mse = 0.013976
Epoch 53
Loss = 7.2699e-02, PNorm = 35.3313, GNorm = 0.7650, lr_0 = 1.1295e-04
Loss = 8.2149e-02, PNorm = 35.3347, GNorm = 2.5578, lr_0 = 1.1000e-04
Validation rmse = 0.121354
Validation r2 = 0.880148
Validation mse = 0.014727
Epoch 54
Loss = 6.5802e-02, PNorm = 35.3377, GNorm = 0.8547, lr_0 = 1.0712e-04
Validation rmse = 0.119574
Validation r2 = 0.883638
Validation mse = 0.014298
Epoch 55
Loss = 8.2949e-02, PNorm = 35.3418, GNorm = 1.0802, lr_0 = 1.0405e-04
Loss = 7.2394e-02, PNorm = 35.3448, GNorm = 0.7257, lr_0 = 1.0133e-04
Validation rmse = 0.120283
Validation r2 = 0.882255
Validation mse = 0.014468
Epoch 56
Loss = 6.7134e-02, PNorm = 35.3483, GNorm = 2.6914, lr_0 = 1.0000e-04
Validation rmse = 0.118989
Validation r2 = 0.884775
Validation mse = 0.014158
Epoch 57
Loss = 5.8460e-02, PNorm = 35.3512, GNorm = 2.5176, lr_0 = 1.0000e-04
Loss = 7.1081e-02, PNorm = 35.3550, GNorm = 0.5737, lr_0 = 1.0000e-04
Validation rmse = 0.120146
Validation r2 = 0.882522
Validation mse = 0.014435
Epoch 58
Loss = 8.0187e-02, PNorm = 35.3583, GNorm = 2.0401, lr_0 = 1.0000e-04
Validation rmse = 0.122280
Validation r2 = 0.878312
Validation mse = 0.014952
Epoch 59
Loss = 8.4610e-02, PNorm = 35.3613, GNorm = 1.1750, lr_0 = 1.0000e-04
Loss = 7.9055e-02, PNorm = 35.3649, GNorm = 0.4534, lr_0 = 1.0000e-04
Validation rmse = 0.120401
Validation r2 = 0.882024
Validation mse = 0.014496
Model 0 best validation rmse = 0.118220 on epoch 52
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.515849
Model 0 test r2 = -2.537231
Model 0 test mse = 0.266100
Ensemble test rmse = 0.515849
Ensemble test r2 = -2.537231
Ensemble test mse = 0.266100
10-fold cross validation
	Seed 0 ==> test rmse = 0.575041
	Seed 0 ==> test r2 = -3.395582
	Seed 0 ==> test mse = 0.330672
	Seed 1 ==> test rmse = 0.575920
	Seed 1 ==> test r2 = -3.409036
	Seed 1 ==> test mse = 0.331684
	Seed 2 ==> test rmse = 0.557234
	Seed 2 ==> test r2 = -3.127567
	Seed 2 ==> test mse = 0.310510
	Seed 3 ==> test rmse = 0.568788
	Seed 3 ==> test r2 = -3.300514
	Seed 3 ==> test mse = 0.323520
	Seed 4 ==> test rmse = 0.548005
	Seed 4 ==> test r2 = -2.991979
	Seed 4 ==> test mse = 0.300310
	Seed 5 ==> test rmse = 0.524526
	Seed 5 ==> test r2 = -2.657241
	Seed 5 ==> test mse = 0.275128
	Seed 6 ==> test rmse = 0.558000
	Seed 6 ==> test r2 = -3.138918
	Seed 6 ==> test mse = 0.311364
	Seed 7 ==> test rmse = 0.527136
	Seed 7 ==> test r2 = -2.693726
	Seed 7 ==> test mse = 0.277873
	Seed 8 ==> test rmse = 0.559945
	Seed 8 ==> test r2 = -3.167827
	Seed 8 ==> test mse = 0.313539
	Seed 9 ==> test rmse = 0.515849
	Seed 9 ==> test r2 = -2.537231
	Seed 9 ==> test mse = 0.266100
Overall test rmse = 0.551045 +/- 0.020489
Overall test r2 = -3.041962 +/- 0.297614
Overall test mse = 0.304070 +/- 0.022389
Elapsed time = 0:06:45
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-1d5c3576-9790-4896-9034-9bb28ba18d8e.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/Hept_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2', 'mse'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2', 'mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/generalization_3/Hept_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/Hept_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 973 | train size = 778 | val size = 195 | test size = 49
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.6595e-01, PNorm = 34.0160, GNorm = 1.1499, lr_0 = 4.3000e-04
Validation rmse = 0.276541
Validation r2 = 0.236605
Validation mse = 0.076475
Epoch 1
Loss = 7.4917e-01, PNorm = 34.0506, GNorm = 15.1849, lr_0 = 7.6000e-04
Loss = 5.7590e-01, PNorm = 34.1003, GNorm = 1.5052, lr_0 = 9.9472e-04
Validation rmse = 0.249121
Validation r2 = 0.380486
Validation mse = 0.062061
Epoch 2
Loss = 4.8710e-01, PNorm = 34.1656, GNorm = 4.0036, lr_0 = 9.6874e-04
Validation rmse = 0.226903
Validation r2 = 0.486062
Validation mse = 0.051485
Epoch 3
Loss = 4.3339e-01, PNorm = 34.2432, GNorm = 10.1932, lr_0 = 9.4094e-04
Loss = 4.5598e-01, PNorm = 34.3006, GNorm = 9.6177, lr_0 = 9.1637e-04
Validation rmse = 0.201036
Validation r2 = 0.596561
Validation mse = 0.040416
Epoch 4
Loss = 3.2159e-01, PNorm = 34.3537, GNorm = 1.7660, lr_0 = 8.9243e-04
Validation rmse = 0.180692
Validation r2 = 0.674081
Validation mse = 0.032650
Epoch 5
Loss = 1.9434e-01, PNorm = 34.4137, GNorm = 2.4650, lr_0 = 8.6682e-04
Loss = 2.6912e-01, PNorm = 34.4600, GNorm = 1.0408, lr_0 = 8.4418e-04
Validation rmse = 0.167710
Validation r2 = 0.719234
Validation mse = 0.028126
Epoch 6
Loss = 2.0435e-01, PNorm = 34.5030, GNorm = 1.8748, lr_0 = 8.2213e-04
Validation rmse = 0.159651
Validation r2 = 0.745568
Validation mse = 0.025488
Epoch 7
Loss = 1.6632e-01, PNorm = 34.5496, GNorm = 2.1395, lr_0 = 7.9854e-04
Loss = 1.9595e-01, PNorm = 34.5839, GNorm = 1.6087, lr_0 = 7.7769e-04
Validation rmse = 0.153644
Validation r2 = 0.764354
Validation mse = 0.023606
Epoch 8
Loss = 1.8510e-01, PNorm = 34.6160, GNorm = 7.2155, lr_0 = 7.5737e-04
Loss = 2.2670e-01, PNorm = 34.6482, GNorm = 3.2003, lr_0 = 7.3759e-04
Validation rmse = 0.169986
Validation r2 = 0.711559
Validation mse = 0.028895
Epoch 9
Loss = 1.8353e-01, PNorm = 34.6819, GNorm = 1.0393, lr_0 = 7.1833e-04
Validation rmse = 0.164773
Validation r2 = 0.728981
Validation mse = 0.027150
Epoch 10
Loss = 2.0866e-01, PNorm = 34.7150, GNorm = 5.7528, lr_0 = 6.9772e-04
Loss = 1.5524e-01, PNorm = 34.7393, GNorm = 1.4081, lr_0 = 6.7949e-04
Validation rmse = 0.144264
Validation r2 = 0.792249
Validation mse = 0.020812
Epoch 11
Loss = 1.4171e-01, PNorm = 34.7651, GNorm = 2.7420, lr_0 = 6.6174e-04
Validation rmse = 0.151779
Validation r2 = 0.770039
Validation mse = 0.023037
Epoch 12
Loss = 1.3596e-01, PNorm = 34.7899, GNorm = 5.1249, lr_0 = 6.4276e-04
Loss = 1.7256e-01, PNorm = 34.8110, GNorm = 2.4765, lr_0 = 6.2597e-04
Validation rmse = 0.169618
Validation r2 = 0.712806
Validation mse = 0.028770
Epoch 13
Loss = 1.7549e-01, PNorm = 34.8323, GNorm = 7.5582, lr_0 = 6.0962e-04
Validation rmse = 0.144030
Validation r2 = 0.792922
Validation mse = 0.020745
Epoch 14
Loss = 1.6162e-01, PNorm = 34.8596, GNorm = 4.5154, lr_0 = 5.9213e-04
Loss = 1.6059e-01, PNorm = 34.8789, GNorm = 2.0610, lr_0 = 5.7666e-04
Validation rmse = 0.150413
Validation r2 = 0.774159
Validation mse = 0.022624
Epoch 15
Loss = 1.7726e-01, PNorm = 34.9039, GNorm = 1.2413, lr_0 = 5.6160e-04
Validation rmse = 0.142088
Validation r2 = 0.798466
Validation mse = 0.020189
Epoch 16
Loss = 9.9511e-02, PNorm = 34.9255, GNorm = 0.4640, lr_0 = 5.4548e-04
Loss = 1.4541e-01, PNorm = 34.9481, GNorm = 1.7650, lr_0 = 5.3124e-04
Validation rmse = 0.148748
Validation r2 = 0.779133
Validation mse = 0.022126
Epoch 17
Loss = 1.3276e-01, PNorm = 34.9589, GNorm = 3.6432, lr_0 = 5.1736e-04
Loss = 1.5822e-01, PNorm = 34.9746, GNorm = 3.8630, lr_0 = 5.0385e-04
Validation rmse = 0.160974
Validation r2 = 0.741332
Validation mse = 0.025913
Epoch 18
Loss = 1.4912e-01, PNorm = 34.9915, GNorm = 3.7182, lr_0 = 4.9069e-04
Validation rmse = 0.146016
Validation r2 = 0.787172
Validation mse = 0.021321
Epoch 19
Loss = 1.2453e-01, PNorm = 35.0097, GNorm = 1.5189, lr_0 = 4.7661e-04
Loss = 1.3527e-01, PNorm = 35.0244, GNorm = 0.7376, lr_0 = 4.6416e-04
Validation rmse = 0.141459
Validation r2 = 0.800249
Validation mse = 0.020011
Epoch 20
Loss = 1.2575e-01, PNorm = 35.0394, GNorm = 1.5671, lr_0 = 4.5204e-04
Validation rmse = 0.138644
Validation r2 = 0.808119
Validation mse = 0.019222
Epoch 21
Loss = 9.8610e-02, PNorm = 35.0554, GNorm = 0.8153, lr_0 = 4.3906e-04
Loss = 1.3227e-01, PNorm = 35.0683, GNorm = 1.0332, lr_0 = 4.2760e-04
Validation rmse = 0.138374
Validation r2 = 0.808866
Validation mse = 0.019147
Epoch 22
Loss = 1.0899e-01, PNorm = 35.0808, GNorm = 2.1204, lr_0 = 4.1643e-04
Validation rmse = 0.144327
Validation r2 = 0.792067
Validation mse = 0.020830
Epoch 23
Loss = 1.2201e-01, PNorm = 35.0947, GNorm = 1.1964, lr_0 = 4.0448e-04
Loss = 1.1791e-01, PNorm = 35.1063, GNorm = 0.8930, lr_0 = 3.9391e-04
Validation rmse = 0.137514
Validation r2 = 0.811233
Validation mse = 0.018910
Epoch 24
Loss = 1.1988e-01, PNorm = 35.1173, GNorm = 4.5472, lr_0 = 3.8363e-04
Validation rmse = 0.139313
Validation r2 = 0.806262
Validation mse = 0.019408
Epoch 25
Loss = 7.0703e-02, PNorm = 35.1285, GNorm = 2.1610, lr_0 = 3.7361e-04
Loss = 1.2696e-01, PNorm = 35.1387, GNorm = 1.3115, lr_0 = 3.6385e-04
Validation rmse = 0.147324
Validation r2 = 0.783341
Validation mse = 0.021704
Epoch 26
Loss = 1.4563e-01, PNorm = 35.1549, GNorm = 2.7714, lr_0 = 3.5341e-04
Loss = 1.1776e-01, PNorm = 35.1668, GNorm = 0.5506, lr_0 = 3.4418e-04
Validation rmse = 0.133574
Validation r2 = 0.821897
Validation mse = 0.017842
Epoch 27
Loss = 1.1110e-01, PNorm = 35.1791, GNorm = 1.9821, lr_0 = 3.3519e-04
Validation rmse = 0.135853
Validation r2 = 0.815766
Validation mse = 0.018456
Epoch 28
Loss = 9.8041e-02, PNorm = 35.1909, GNorm = 0.8744, lr_0 = 3.2557e-04
Loss = 1.1321e-01, PNorm = 35.2013, GNorm = 0.7883, lr_0 = 3.1707e-04
Validation rmse = 0.134788
Validation r2 = 0.818644
Validation mse = 0.018168
Epoch 29
Loss = 1.0347e-01, PNorm = 35.2093, GNorm = 1.1909, lr_0 = 3.0878e-04
Validation rmse = 0.133509
Validation r2 = 0.822068
Validation mse = 0.017825
Epoch 30
Loss = 8.5165e-02, PNorm = 35.2193, GNorm = 0.5814, lr_0 = 2.9992e-04
Loss = 1.0921e-01, PNorm = 35.2289, GNorm = 2.5521, lr_0 = 2.9209e-04
Validation rmse = 0.132864
Validation r2 = 0.823784
Validation mse = 0.017653
Epoch 31
Loss = 1.0113e-01, PNorm = 35.2390, GNorm = 1.4708, lr_0 = 2.8446e-04
Validation rmse = 0.137117
Validation r2 = 0.812324
Validation mse = 0.018801
Epoch 32
Loss = 1.1286e-01, PNorm = 35.2473, GNorm = 0.7207, lr_0 = 2.7630e-04
Loss = 1.0258e-01, PNorm = 35.2551, GNorm = 1.9002, lr_0 = 2.6908e-04
Validation rmse = 0.136043
Validation r2 = 0.815251
Validation mse = 0.018508
Epoch 33
Loss = 1.1599e-01, PNorm = 35.2648, GNorm = 1.0515, lr_0 = 2.6205e-04
Validation rmse = 0.135155
Validation r2 = 0.817654
Validation mse = 0.018267
Epoch 34
Loss = 1.0910e-01, PNorm = 35.2735, GNorm = 0.6282, lr_0 = 2.5521e-04
Loss = 1.0564e-01, PNorm = 35.2811, GNorm = 0.7323, lr_0 = 2.4854e-04
Validation rmse = 0.135228
Validation r2 = 0.817458
Validation mse = 0.018287
Epoch 35
Loss = 8.6026e-02, PNorm = 35.2883, GNorm = 0.9600, lr_0 = 2.4141e-04
Loss = 1.0597e-01, PNorm = 35.2956, GNorm = 2.1321, lr_0 = 2.3511e-04
Validation rmse = 0.135172
Validation r2 = 0.817609
Validation mse = 0.018272
Epoch 36
Loss = 9.8893e-02, PNorm = 35.3028, GNorm = 0.4880, lr_0 = 2.2897e-04
Validation rmse = 0.133449
Validation r2 = 0.822228
Validation mse = 0.017809
Epoch 37
Loss = 1.0115e-01, PNorm = 35.3104, GNorm = 0.4269, lr_0 = 2.2240e-04
Loss = 9.4704e-02, PNorm = 35.3175, GNorm = 2.1400, lr_0 = 2.1659e-04
Validation rmse = 0.137383
Validation r2 = 0.811593
Validation mse = 0.018874
Epoch 38
Loss = 1.0110e-01, PNorm = 35.3254, GNorm = 0.9332, lr_0 = 2.1093e-04
Validation rmse = 0.133988
Validation r2 = 0.820790
Validation mse = 0.017953
Epoch 39
Loss = 1.1125e-01, PNorm = 35.3320, GNorm = 0.4156, lr_0 = 2.0488e-04
Loss = 8.5071e-02, PNorm = 35.3376, GNorm = 1.5688, lr_0 = 1.9953e-04
Validation rmse = 0.134902
Validation r2 = 0.818337
Validation mse = 0.018199
Epoch 40
Loss = 9.7187e-02, PNorm = 35.3457, GNorm = 0.3697, lr_0 = 1.9431e-04
Validation rmse = 0.134153
Validation r2 = 0.820348
Validation mse = 0.017997
Epoch 41
Loss = 8.6056e-02, PNorm = 35.3526, GNorm = 1.3564, lr_0 = 1.8874e-04
Loss = 9.1831e-02, PNorm = 35.3582, GNorm = 0.6882, lr_0 = 1.8381e-04
Validation rmse = 0.133536
Validation r2 = 0.821996
Validation mse = 0.017832
Epoch 42
Loss = 9.0328e-02, PNorm = 35.3644, GNorm = 0.5671, lr_0 = 1.7901e-04
Validation rmse = 0.133413
Validation r2 = 0.822324
Validation mse = 0.017799
Epoch 43
Loss = 1.2463e-01, PNorm = 35.3698, GNorm = 1.8219, lr_0 = 1.7433e-04
Loss = 9.1461e-02, PNorm = 35.3747, GNorm = 1.0330, lr_0 = 1.6978e-04
Validation rmse = 0.135126
Validation r2 = 0.817732
Validation mse = 0.018259
Epoch 44
Loss = 7.6037e-02, PNorm = 35.3829, GNorm = 2.3662, lr_0 = 1.6491e-04
Loss = 1.0284e-01, PNorm = 35.3871, GNorm = 2.5245, lr_0 = 1.6060e-04
Validation rmse = 0.131446
Validation r2 = 0.827526
Validation mse = 0.017278
Epoch 45
Loss = 8.7097e-02, PNorm = 35.3922, GNorm = 0.5582, lr_0 = 1.5641e-04
Validation rmse = 0.135652
Validation r2 = 0.816310
Validation mse = 0.018402
Epoch 46
Loss = 8.2721e-02, PNorm = 35.3992, GNorm = 0.8886, lr_0 = 1.5192e-04
Loss = 1.0154e-01, PNorm = 35.4034, GNorm = 0.7682, lr_0 = 1.4795e-04
Validation rmse = 0.135061
Validation r2 = 0.817909
Validation mse = 0.018241
Epoch 47
Loss = 8.6295e-02, PNorm = 35.4078, GNorm = 1.8546, lr_0 = 1.4409e-04
Validation rmse = 0.131965
Validation r2 = 0.826162
Validation mse = 0.017415
Epoch 48
Loss = 9.5156e-02, PNorm = 35.4137, GNorm = 1.5508, lr_0 = 1.3995e-04
Loss = 9.9945e-02, PNorm = 35.4197, GNorm = 4.1480, lr_0 = 1.3630e-04
Validation rmse = 0.133053
Validation r2 = 0.823284
Validation mse = 0.017703
Epoch 49
Loss = 9.1457e-02, PNorm = 35.4247, GNorm = 0.8763, lr_0 = 1.3274e-04
Validation rmse = 0.137619
Validation r2 = 0.810944
Validation mse = 0.018939
Epoch 50
Loss = 1.0228e-01, PNorm = 35.4283, GNorm = 1.4282, lr_0 = 1.2927e-04
Loss = 9.9821e-02, PNorm = 35.4318, GNorm = 4.0485, lr_0 = 1.2589e-04
Validation rmse = 0.136622
Validation r2 = 0.813676
Validation mse = 0.018665
Epoch 51
Loss = 9.3225e-02, PNorm = 35.4370, GNorm = 1.5714, lr_0 = 1.2228e-04
Validation rmse = 0.131520
Validation r2 = 0.827332
Validation mse = 0.017297
Epoch 52
Loss = 6.7643e-02, PNorm = 35.4414, GNorm = 0.4641, lr_0 = 1.1909e-04
Loss = 8.5185e-02, PNorm = 35.4453, GNorm = 2.1945, lr_0 = 1.1598e-04
Validation rmse = 0.132849
Validation r2 = 0.823825
Validation mse = 0.017649
Epoch 53
Loss = 9.3471e-02, PNorm = 35.4494, GNorm = 1.0802, lr_0 = 1.1265e-04
Loss = 8.6154e-02, PNorm = 35.4526, GNorm = 2.9695, lr_0 = 1.0971e-04
Validation rmse = 0.132847
Validation r2 = 0.823829
Validation mse = 0.017648
Epoch 54
Loss = 8.5540e-02, PNorm = 35.4556, GNorm = 3.5874, lr_0 = 1.0684e-04
Validation rmse = 0.132432
Validation r2 = 0.824927
Validation mse = 0.017538
Epoch 55
Loss = 8.0743e-02, PNorm = 35.4594, GNorm = 1.4274, lr_0 = 1.0377e-04
Loss = 9.0170e-02, PNorm = 35.4624, GNorm = 0.8876, lr_0 = 1.0106e-04
Validation rmse = 0.133314
Validation r2 = 0.822588
Validation mse = 0.017773
Epoch 56
Loss = 8.8846e-02, PNorm = 35.4659, GNorm = 0.9277, lr_0 = 1.0000e-04
Validation rmse = 0.131835
Validation r2 = 0.826504
Validation mse = 0.017380
Epoch 57
Loss = 7.6525e-02, PNorm = 35.4693, GNorm = 1.5562, lr_0 = 1.0000e-04
Loss = 8.3052e-02, PNorm = 35.4723, GNorm = 1.1306, lr_0 = 1.0000e-04
Validation rmse = 0.132495
Validation r2 = 0.824763
Validation mse = 0.017555
Epoch 58
Loss = 8.9034e-02, PNorm = 35.4752, GNorm = 0.8969, lr_0 = 1.0000e-04
Validation rmse = 0.133240
Validation r2 = 0.822785
Validation mse = 0.017753
Epoch 59
Loss = 9.8119e-02, PNorm = 35.4789, GNorm = 2.0499, lr_0 = 1.0000e-04
Loss = 8.7416e-02, PNorm = 35.4813, GNorm = 1.9091, lr_0 = 1.0000e-04
Validation rmse = 0.134653
Validation r2 = 0.819008
Validation mse = 0.018131
Model 0 best validation rmse = 0.131446 on epoch 44
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.656258
Model 0 test r2 = -119.308710
Model 0 test mse = 0.430675
Ensemble test rmse = 0.656258
Ensemble test r2 = -119.308710
Ensemble test mse = 0.430675
Fold 1
Splitting data with seed 1
Total size = 973 | train size = 778 | val size = 195 | test size = 49
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.8659e-01, PNorm = 34.0151, GNorm = 3.3456, lr_0 = 4.3000e-04
Validation rmse = 0.285561
Validation r2 = 0.185143
Validation mse = 0.081545
Epoch 1
Loss = 7.4488e-01, PNorm = 34.0403, GNorm = 4.9388, lr_0 = 7.6000e-04
Loss = 6.1045e-01, PNorm = 34.0992, GNorm = 1.8354, lr_0 = 9.9472e-04
Validation rmse = 0.266777
Validation r2 = 0.288820
Validation mse = 0.071170
Epoch 2
Loss = 6.9317e-01, PNorm = 34.1556, GNorm = 9.1978, lr_0 = 9.6874e-04
Validation rmse = 0.218658
Validation r2 = 0.522238
Validation mse = 0.047811
Epoch 3
Loss = 4.2986e-01, PNorm = 34.2257, GNorm = 3.0976, lr_0 = 9.4094e-04
Loss = 3.7619e-01, PNorm = 34.2928, GNorm = 1.9556, lr_0 = 9.1637e-04
Validation rmse = 0.179895
Validation r2 = 0.676616
Validation mse = 0.032362
Epoch 4
Loss = 3.3683e-01, PNorm = 34.3596, GNorm = 5.0386, lr_0 = 8.9243e-04
Validation rmse = 0.159319
Validation r2 = 0.746361
Validation mse = 0.025382
Epoch 5
Loss = 3.3192e-01, PNorm = 34.4231, GNorm = 5.0023, lr_0 = 8.6682e-04
Loss = 2.4410e-01, PNorm = 34.4734, GNorm = 1.6689, lr_0 = 8.4418e-04
Validation rmse = 0.183764
Validation r2 = 0.662556
Validation mse = 0.033769
Epoch 6
Loss = 2.3341e-01, PNorm = 34.5255, GNorm = 2.4981, lr_0 = 8.2213e-04
Validation rmse = 0.144417
Validation r2 = 0.791589
Validation mse = 0.020856
Epoch 7
Loss = 1.8913e-01, PNorm = 34.5737, GNorm = 4.8399, lr_0 = 7.9854e-04
Loss = 1.9189e-01, PNorm = 34.6119, GNorm = 1.3505, lr_0 = 7.7769e-04
Validation rmse = 0.165566
Validation r2 = 0.726079
Validation mse = 0.027412
Epoch 8
Loss = 2.1810e-01, PNorm = 34.6474, GNorm = 6.4740, lr_0 = 7.5737e-04
Loss = 1.7658e-01, PNorm = 34.6809, GNorm = 3.6821, lr_0 = 7.3759e-04
Validation rmse = 0.141237
Validation r2 = 0.800666
Validation mse = 0.019948
Epoch 9
Loss = 1.8580e-01, PNorm = 34.7144, GNorm = 1.0865, lr_0 = 7.1833e-04
Validation rmse = 0.135917
Validation r2 = 0.815400
Validation mse = 0.018474
Epoch 10
Loss = 1.3750e-01, PNorm = 34.7408, GNorm = 0.6960, lr_0 = 6.9772e-04
Loss = 1.5620e-01, PNorm = 34.7651, GNorm = 2.8901, lr_0 = 6.7949e-04
Validation rmse = 0.130324
Validation r2 = 0.830280
Validation mse = 0.016984
Epoch 11
Loss = 1.6608e-01, PNorm = 34.7865, GNorm = 2.7311, lr_0 = 6.6174e-04
Validation rmse = 0.169124
Validation r2 = 0.714179
Validation mse = 0.028603
Epoch 12
Loss = 1.6135e-01, PNorm = 34.8139, GNorm = 3.5297, lr_0 = 6.4276e-04
Loss = 1.6897e-01, PNorm = 34.8354, GNorm = 4.6683, lr_0 = 6.2597e-04
Validation rmse = 0.130723
Validation r2 = 0.829239
Validation mse = 0.017089
Epoch 13
Loss = 1.4161e-01, PNorm = 34.8603, GNorm = 1.9022, lr_0 = 6.0962e-04
Validation rmse = 0.135796
Validation r2 = 0.815729
Validation mse = 0.018441
Epoch 14
Loss = 1.6100e-01, PNorm = 34.8788, GNorm = 2.0952, lr_0 = 5.9213e-04
Loss = 1.4896e-01, PNorm = 34.9024, GNorm = 1.4784, lr_0 = 5.7666e-04
Validation rmse = 0.125432
Validation r2 = 0.842783
Validation mse = 0.015733
Epoch 15
Loss = 1.1915e-01, PNorm = 34.9176, GNorm = 1.3263, lr_0 = 5.6160e-04
Validation rmse = 0.134554
Validation r2 = 0.819085
Validation mse = 0.018105
Epoch 16
Loss = 1.0148e-01, PNorm = 34.9390, GNorm = 1.0963, lr_0 = 5.4548e-04
Loss = 1.3923e-01, PNorm = 34.9563, GNorm = 2.8103, lr_0 = 5.3124e-04
Validation rmse = 0.139070
Validation r2 = 0.806737
Validation mse = 0.019340
Epoch 17
Loss = 1.4763e-01, PNorm = 34.9732, GNorm = 2.3489, lr_0 = 5.1736e-04
Loss = 1.2072e-01, PNorm = 34.9888, GNorm = 0.9951, lr_0 = 5.0385e-04
Validation rmse = 0.128521
Validation r2 = 0.834945
Validation mse = 0.016518
Epoch 18
Loss = 1.1300e-01, PNorm = 35.0049, GNorm = 2.7527, lr_0 = 4.9069e-04
Validation rmse = 0.129972
Validation r2 = 0.831197
Validation mse = 0.016893
Epoch 19
Loss = 1.0305e-01, PNorm = 35.0204, GNorm = 0.7317, lr_0 = 4.7661e-04
Loss = 1.2753e-01, PNorm = 35.0369, GNorm = 2.1105, lr_0 = 4.6416e-04
Validation rmse = 0.121424
Validation r2 = 0.852671
Validation mse = 0.014744
Epoch 20
Loss = 1.3370e-01, PNorm = 35.0499, GNorm = 1.5900, lr_0 = 4.5204e-04
Validation rmse = 0.126668
Validation r2 = 0.839668
Validation mse = 0.016045
Epoch 21
Loss = 1.2773e-01, PNorm = 35.0668, GNorm = 0.9694, lr_0 = 4.3906e-04
Loss = 1.1194e-01, PNorm = 35.0831, GNorm = 0.8182, lr_0 = 4.2760e-04
Validation rmse = 0.130989
Validation r2 = 0.828543
Validation mse = 0.017158
Epoch 22
Loss = 1.1827e-01, PNorm = 35.0959, GNorm = 3.3191, lr_0 = 4.1643e-04
Validation rmse = 0.126281
Validation r2 = 0.840647
Validation mse = 0.015947
Epoch 23
Loss = 1.1449e-01, PNorm = 35.1099, GNorm = 2.0779, lr_0 = 4.0448e-04
Loss = 1.1169e-01, PNorm = 35.1225, GNorm = 1.1828, lr_0 = 3.9391e-04
Validation rmse = 0.122902
Validation r2 = 0.849062
Validation mse = 0.015105
Epoch 24
Loss = 1.1751e-01, PNorm = 35.1359, GNorm = 4.7354, lr_0 = 3.8363e-04
Validation rmse = 0.124900
Validation r2 = 0.844113
Validation mse = 0.015600
Epoch 25
Loss = 1.6854e-01, PNorm = 35.1503, GNorm = 3.6328, lr_0 = 3.7361e-04
Loss = 1.3202e-01, PNorm = 35.1646, GNorm = 2.0941, lr_0 = 3.6385e-04
Validation rmse = 0.127011
Validation r2 = 0.838799
Validation mse = 0.016132
Epoch 26
Loss = 1.0531e-01, PNorm = 35.1796, GNorm = 0.7234, lr_0 = 3.5341e-04
Loss = 1.0994e-01, PNorm = 35.1909, GNorm = 4.2461, lr_0 = 3.4418e-04
Validation rmse = 0.122523
Validation r2 = 0.849991
Validation mse = 0.015012
Epoch 27
Loss = 1.1749e-01, PNorm = 35.1992, GNorm = 0.9823, lr_0 = 3.3519e-04
Validation rmse = 0.122109
Validation r2 = 0.851003
Validation mse = 0.014911
Epoch 28
Loss = 1.0944e-01, PNorm = 35.2111, GNorm = 1.8316, lr_0 = 3.2557e-04
Loss = 1.0403e-01, PNorm = 35.2203, GNorm = 2.0237, lr_0 = 3.1707e-04
Validation rmse = 0.125801
Validation r2 = 0.841856
Validation mse = 0.015826
Epoch 29
Loss = 1.0847e-01, PNorm = 35.2297, GNorm = 2.3740, lr_0 = 3.0878e-04
Validation rmse = 0.120149
Validation r2 = 0.855747
Validation mse = 0.014436
Epoch 30
Loss = 1.1215e-01, PNorm = 35.2404, GNorm = 1.2216, lr_0 = 2.9992e-04
Loss = 9.9922e-02, PNorm = 35.2499, GNorm = 1.5681, lr_0 = 2.9209e-04
Validation rmse = 0.121519
Validation r2 = 0.852439
Validation mse = 0.014767
Epoch 31
Loss = 9.5208e-02, PNorm = 35.2553, GNorm = 1.6131, lr_0 = 2.8446e-04
Validation rmse = 0.142213
Validation r2 = 0.797903
Validation mse = 0.020225
Epoch 32
Loss = 1.0254e-01, PNorm = 35.2669, GNorm = 1.1368, lr_0 = 2.7630e-04
Loss = 1.1779e-01, PNorm = 35.2761, GNorm = 0.5204, lr_0 = 2.6908e-04
Validation rmse = 0.121625
Validation r2 = 0.852182
Validation mse = 0.014793
Epoch 33
Loss = 1.0440e-01, PNorm = 35.2843, GNorm = 1.4945, lr_0 = 2.6205e-04
Validation rmse = 0.123932
Validation r2 = 0.846522
Validation mse = 0.015359
Epoch 34
Loss = 7.7322e-02, PNorm = 35.2933, GNorm = 0.5728, lr_0 = 2.5521e-04
Loss = 9.5331e-02, PNorm = 35.3038, GNorm = 0.7017, lr_0 = 2.4854e-04
Validation rmse = 0.124823
Validation r2 = 0.844306
Validation mse = 0.015581
Epoch 35
Loss = 8.8484e-02, PNorm = 35.3101, GNorm = 1.6564, lr_0 = 2.4141e-04
Loss = 1.0238e-01, PNorm = 35.3177, GNorm = 0.5481, lr_0 = 2.3511e-04
Validation rmse = 0.120179
Validation r2 = 0.855677
Validation mse = 0.014443
Epoch 36
Loss = 1.0408e-01, PNorm = 35.3249, GNorm = 0.5685, lr_0 = 2.2897e-04
Validation rmse = 0.119579
Validation r2 = 0.857113
Validation mse = 0.014299
Epoch 37
Loss = 9.2237e-02, PNorm = 35.3320, GNorm = 1.1780, lr_0 = 2.2240e-04
Loss = 9.6849e-02, PNorm = 35.3368, GNorm = 1.2041, lr_0 = 2.1659e-04
Validation rmse = 0.127211
Validation r2 = 0.838293
Validation mse = 0.016183
Epoch 38
Loss = 8.8365e-02, PNorm = 35.3451, GNorm = 1.0304, lr_0 = 2.1093e-04
Validation rmse = 0.120501
Validation r2 = 0.854901
Validation mse = 0.014520
Epoch 39
Loss = 9.2578e-02, PNorm = 35.3497, GNorm = 1.4178, lr_0 = 2.0488e-04
Loss = 9.8317e-02, PNorm = 35.3570, GNorm = 0.7030, lr_0 = 1.9953e-04
Validation rmse = 0.122993
Validation r2 = 0.848838
Validation mse = 0.015127
Epoch 40
Loss = 9.4270e-02, PNorm = 35.3612, GNorm = 1.1589, lr_0 = 1.9431e-04
Validation rmse = 0.125421
Validation r2 = 0.842812
Validation mse = 0.015730
Epoch 41
Loss = 1.0575e-01, PNorm = 35.3688, GNorm = 0.6732, lr_0 = 1.8874e-04
Loss = 8.1795e-02, PNorm = 35.3746, GNorm = 2.0076, lr_0 = 1.8381e-04
Validation rmse = 0.118551
Validation r2 = 0.859560
Validation mse = 0.014054
Epoch 42
Loss = 9.0418e-02, PNorm = 35.3793, GNorm = 2.2268, lr_0 = 1.7901e-04
Validation rmse = 0.123030
Validation r2 = 0.848747
Validation mse = 0.015136
Epoch 43
Loss = 1.0151e-01, PNorm = 35.3860, GNorm = 1.1546, lr_0 = 1.7433e-04
Loss = 9.0790e-02, PNorm = 35.3937, GNorm = 1.3986, lr_0 = 1.6978e-04
Validation rmse = 0.125554
Validation r2 = 0.842476
Validation mse = 0.015764
Epoch 44
Loss = 9.4482e-02, PNorm = 35.3991, GNorm = 1.0408, lr_0 = 1.6491e-04
Loss = 9.8431e-02, PNorm = 35.4046, GNorm = 0.4103, lr_0 = 1.6060e-04
Validation rmse = 0.118988
Validation r2 = 0.858521
Validation mse = 0.014158
Epoch 45
Loss = 9.0946e-02, PNorm = 35.4105, GNorm = 1.8835, lr_0 = 1.5641e-04
Validation rmse = 0.129241
Validation r2 = 0.833089
Validation mse = 0.016703
Epoch 46
Loss = 9.6561e-02, PNorm = 35.4143, GNorm = 1.0625, lr_0 = 1.5192e-04
Loss = 9.5203e-02, PNorm = 35.4202, GNorm = 1.5846, lr_0 = 1.4795e-04
Validation rmse = 0.118555
Validation r2 = 0.859550
Validation mse = 0.014055
Epoch 47
Loss = 9.0923e-02, PNorm = 35.4236, GNorm = 0.6587, lr_0 = 1.4409e-04
Validation rmse = 0.120791
Validation r2 = 0.854201
Validation mse = 0.014591
Epoch 48
Loss = 8.6181e-02, PNorm = 35.4283, GNorm = 0.9983, lr_0 = 1.3995e-04
Loss = 9.1204e-02, PNorm = 35.4333, GNorm = 0.9561, lr_0 = 1.3630e-04
Validation rmse = 0.123273
Validation r2 = 0.848149
Validation mse = 0.015196
Epoch 49
Loss = 9.9068e-02, PNorm = 35.4374, GNorm = 0.8412, lr_0 = 1.3274e-04
Validation rmse = 0.119737
Validation r2 = 0.856736
Validation mse = 0.014337
Epoch 50
Loss = 7.3328e-02, PNorm = 35.4416, GNorm = 0.7746, lr_0 = 1.2927e-04
Loss = 9.2060e-02, PNorm = 35.4468, GNorm = 1.4422, lr_0 = 1.2589e-04
Validation rmse = 0.118420
Validation r2 = 0.859869
Validation mse = 0.014023
Epoch 51
Loss = 8.2946e-02, PNorm = 35.4503, GNorm = 1.4410, lr_0 = 1.2228e-04
Validation rmse = 0.123084
Validation r2 = 0.848615
Validation mse = 0.015150
Epoch 52
Loss = 8.4449e-02, PNorm = 35.4542, GNorm = 0.8237, lr_0 = 1.1909e-04
Loss = 8.1672e-02, PNorm = 35.4576, GNorm = 1.5186, lr_0 = 1.1598e-04
Validation rmse = 0.118663
Validation r2 = 0.859294
Validation mse = 0.014081
Epoch 53
Loss = 8.0832e-02, PNorm = 35.4617, GNorm = 1.1478, lr_0 = 1.1265e-04
Loss = 1.0314e-01, PNorm = 35.4658, GNorm = 3.8627, lr_0 = 1.0971e-04
Validation rmse = 0.119417
Validation r2 = 0.857499
Validation mse = 0.014260
Epoch 54
Loss = 8.5793e-02, PNorm = 35.4690, GNorm = 1.1831, lr_0 = 1.0684e-04
Validation rmse = 0.122206
Validation r2 = 0.850766
Validation mse = 0.014934
Epoch 55
Loss = 8.6784e-02, PNorm = 35.4730, GNorm = 0.9069, lr_0 = 1.0377e-04
Loss = 8.2768e-02, PNorm = 35.4768, GNorm = 1.0958, lr_0 = 1.0106e-04
Validation rmse = 0.118808
Validation r2 = 0.858951
Validation mse = 0.014115
Epoch 56
Loss = 8.5791e-02, PNorm = 35.4789, GNorm = 0.9151, lr_0 = 1.0000e-04
Validation rmse = 0.123673
Validation r2 = 0.847161
Validation mse = 0.015295
Epoch 57
Loss = 9.7965e-02, PNorm = 35.4833, GNorm = 0.5415, lr_0 = 1.0000e-04
Loss = 8.3132e-02, PNorm = 35.4861, GNorm = 0.8158, lr_0 = 1.0000e-04
Validation rmse = 0.122228
Validation r2 = 0.850712
Validation mse = 0.014940
Epoch 58
Loss = 7.7637e-02, PNorm = 35.4895, GNorm = 1.1091, lr_0 = 1.0000e-04
Validation rmse = 0.124204
Validation r2 = 0.845846
Validation mse = 0.015427
Epoch 59
Loss = 6.1256e-02, PNorm = 35.4925, GNorm = 0.8642, lr_0 = 1.0000e-04
Loss = 7.7141e-02, PNorm = 35.4959, GNorm = 0.4465, lr_0 = 1.0000e-04
Validation rmse = 0.119439
Validation r2 = 0.857446
Validation mse = 0.014266
Model 0 best validation rmse = 0.118420 on epoch 50
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.630118
Model 0 test r2 = -109.915255
Model 0 test mse = 0.397049
Ensemble test rmse = 0.630118
Ensemble test r2 = -109.915255
Ensemble test mse = 0.397049
Fold 2
Splitting data with seed 2
Total size = 973 | train size = 778 | val size = 195 | test size = 49
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.4301e-01, PNorm = 34.0182, GNorm = 1.2469, lr_0 = 4.3000e-04
Validation rmse = 0.277636
Validation r2 = 0.315386
Validation mse = 0.077082
Epoch 1
Loss = 6.7320e-01, PNorm = 34.0506, GNorm = 1.6376, lr_0 = 7.6000e-04
Loss = 6.3562e-01, PNorm = 34.1065, GNorm = 7.8465, lr_0 = 9.9472e-04
Validation rmse = 0.238550
Validation r2 = 0.494580
Validation mse = 0.056906
Epoch 2
Loss = 5.6072e-01, PNorm = 34.1693, GNorm = 13.2510, lr_0 = 9.6874e-04
Validation rmse = 0.209799
Validation r2 = 0.609069
Validation mse = 0.044016
Epoch 3
Loss = 4.5155e-01, PNorm = 34.2424, GNorm = 7.9078, lr_0 = 9.4094e-04
Loss = 4.5004e-01, PNorm = 34.3066, GNorm = 3.4348, lr_0 = 9.1637e-04
Validation rmse = 0.198833
Validation r2 = 0.648870
Validation mse = 0.039534
Epoch 4
Loss = 3.3036e-01, PNorm = 34.3612, GNorm = 4.7405, lr_0 = 8.9243e-04
Validation rmse = 0.201755
Validation r2 = 0.638472
Validation mse = 0.040705
Epoch 5
Loss = 3.3634e-01, PNorm = 34.4205, GNorm = 1.8885, lr_0 = 8.6682e-04
Loss = 2.6502e-01, PNorm = 34.4678, GNorm = 1.1161, lr_0 = 8.4418e-04
Validation rmse = 0.181545
Validation r2 = 0.707275
Validation mse = 0.032959
Epoch 6
Loss = 2.5139e-01, PNorm = 34.5027, GNorm = 3.4256, lr_0 = 8.2213e-04
Validation rmse = 0.149493
Validation r2 = 0.801511
Validation mse = 0.022348
Epoch 7
Loss = 2.4623e-01, PNorm = 34.5474, GNorm = 3.2949, lr_0 = 7.9854e-04
Loss = 2.1155e-01, PNorm = 34.5843, GNorm = 2.9226, lr_0 = 7.7769e-04
Validation rmse = 0.151573
Validation r2 = 0.795951
Validation mse = 0.022974
Epoch 8
Loss = 2.0352e-01, PNorm = 34.6238, GNorm = 0.7463, lr_0 = 7.5737e-04
Loss = 1.9425e-01, PNorm = 34.6607, GNorm = 1.8573, lr_0 = 7.3759e-04
Validation rmse = 0.140338
Validation r2 = 0.825078
Validation mse = 0.019695
Epoch 9
Loss = 1.8623e-01, PNorm = 34.6911, GNorm = 1.9114, lr_0 = 7.1833e-04
Validation rmse = 0.142869
Validation r2 = 0.818711
Validation mse = 0.020412
Epoch 10
Loss = 1.7895e-01, PNorm = 34.7248, GNorm = 2.1647, lr_0 = 6.9772e-04
Loss = 2.0815e-01, PNorm = 34.7462, GNorm = 2.1157, lr_0 = 6.7949e-04
Validation rmse = 0.164906
Validation r2 = 0.758473
Validation mse = 0.027194
Epoch 11
Loss = 2.1170e-01, PNorm = 34.7716, GNorm = 6.6072, lr_0 = 6.6174e-04
Validation rmse = 0.147695
Validation r2 = 0.806258
Validation mse = 0.021814
Epoch 12
Loss = 1.9150e-01, PNorm = 34.8011, GNorm = 4.7735, lr_0 = 6.4276e-04
Loss = 1.8655e-01, PNorm = 34.8275, GNorm = 0.9807, lr_0 = 6.2597e-04
Validation rmse = 0.130899
Validation r2 = 0.847818
Validation mse = 0.017134
Epoch 13
Loss = 1.6341e-01, PNorm = 34.8507, GNorm = 3.4511, lr_0 = 6.0962e-04
Validation rmse = 0.134617
Validation r2 = 0.839049
Validation mse = 0.018122
Epoch 14
Loss = 2.3075e-01, PNorm = 34.8739, GNorm = 3.7426, lr_0 = 5.9213e-04
Loss = 1.6035e-01, PNorm = 34.8967, GNorm = 0.8300, lr_0 = 5.7666e-04
Validation rmse = 0.132619
Validation r2 = 0.843792
Validation mse = 0.017588
Epoch 15
Loss = 1.5410e-01, PNorm = 34.9160, GNorm = 1.8685, lr_0 = 5.6160e-04
Validation rmse = 0.142315
Validation r2 = 0.820117
Validation mse = 0.020253
Epoch 16
Loss = 2.0352e-01, PNorm = 34.9366, GNorm = 6.8476, lr_0 = 5.4548e-04
Loss = 1.8025e-01, PNorm = 34.9531, GNorm = 0.8546, lr_0 = 5.3124e-04
Validation rmse = 0.129591
Validation r2 = 0.850842
Validation mse = 0.016794
Epoch 17
Loss = 1.6877e-01, PNorm = 34.9733, GNorm = 3.0188, lr_0 = 5.1736e-04
Loss = 1.4582e-01, PNorm = 34.9885, GNorm = 3.0288, lr_0 = 5.0385e-04
Validation rmse = 0.129787
Validation r2 = 0.850393
Validation mse = 0.016845
Epoch 18
Loss = 1.3859e-01, PNorm = 35.0012, GNorm = 0.7372, lr_0 = 4.9069e-04
Validation rmse = 0.125488
Validation r2 = 0.860139
Validation mse = 0.015747
Epoch 19
Loss = 1.2454e-01, PNorm = 35.0158, GNorm = 2.5600, lr_0 = 4.7661e-04
Loss = 1.3463e-01, PNorm = 35.0297, GNorm = 2.1540, lr_0 = 4.6416e-04
Validation rmse = 0.132421
Validation r2 = 0.844259
Validation mse = 0.017535
Epoch 20
Loss = 1.3903e-01, PNorm = 35.0440, GNorm = 4.7589, lr_0 = 4.5204e-04
Validation rmse = 0.131682
Validation r2 = 0.845991
Validation mse = 0.017340
Epoch 21
Loss = 1.6148e-01, PNorm = 35.0583, GNorm = 1.3996, lr_0 = 4.3906e-04
Loss = 1.3197e-01, PNorm = 35.0731, GNorm = 1.3219, lr_0 = 4.2760e-04
Validation rmse = 0.123963
Validation r2 = 0.863517
Validation mse = 0.015367
Epoch 22
Loss = 1.3620e-01, PNorm = 35.0868, GNorm = 3.6926, lr_0 = 4.1643e-04
Validation rmse = 0.125133
Validation r2 = 0.860929
Validation mse = 0.015658
Epoch 23
Loss = 9.6981e-02, PNorm = 35.1020, GNorm = 2.4830, lr_0 = 4.0448e-04
Loss = 1.2569e-01, PNorm = 35.1143, GNorm = 1.7204, lr_0 = 3.9391e-04
Validation rmse = 0.129999
Validation r2 = 0.849903
Validation mse = 0.016900
Epoch 24
Loss = 1.3938e-01, PNorm = 35.1257, GNorm = 6.0970, lr_0 = 3.8363e-04
Validation rmse = 0.124932
Validation r2 = 0.861375
Validation mse = 0.015608
Epoch 25
Loss = 1.0054e-01, PNorm = 35.1357, GNorm = 1.1370, lr_0 = 3.7361e-04
Loss = 1.3207e-01, PNorm = 35.1497, GNorm = 0.6699, lr_0 = 3.6385e-04
Validation rmse = 0.128211
Validation r2 = 0.854003
Validation mse = 0.016438
Epoch 26
Loss = 1.0645e-01, PNorm = 35.1631, GNorm = 2.7000, lr_0 = 3.5341e-04
Loss = 1.3082e-01, PNorm = 35.1739, GNorm = 1.9216, lr_0 = 3.4418e-04
Validation rmse = 0.123157
Validation r2 = 0.865288
Validation mse = 0.015168
Epoch 27
Loss = 1.2028e-01, PNorm = 35.1849, GNorm = 2.7358, lr_0 = 3.3519e-04
Validation rmse = 0.125548
Validation r2 = 0.860005
Validation mse = 0.015762
Epoch 28
Loss = 1.3477e-01, PNorm = 35.1977, GNorm = 1.2251, lr_0 = 3.2557e-04
Loss = 1.1765e-01, PNorm = 35.2081, GNorm = 0.7834, lr_0 = 3.1707e-04
Validation rmse = 0.121560
Validation r2 = 0.868759
Validation mse = 0.014777
Epoch 29
Loss = 1.2626e-01, PNorm = 35.2177, GNorm = 1.2197, lr_0 = 3.0878e-04
Validation rmse = 0.122773
Validation r2 = 0.866126
Validation mse = 0.015073
Epoch 30
Loss = 9.5765e-02, PNorm = 35.2284, GNorm = 0.5680, lr_0 = 2.9992e-04
Loss = 1.1793e-01, PNorm = 35.2392, GNorm = 1.0308, lr_0 = 2.9209e-04
Validation rmse = 0.121932
Validation r2 = 0.867953
Validation mse = 0.014867
Epoch 31
Loss = 1.0866e-01, PNorm = 35.2474, GNorm = 0.8348, lr_0 = 2.8446e-04
Validation rmse = 0.120854
Validation r2 = 0.870278
Validation mse = 0.014606
Epoch 32
Loss = 9.6625e-02, PNorm = 35.2584, GNorm = 0.8083, lr_0 = 2.7630e-04
Loss = 1.1256e-01, PNorm = 35.2660, GNorm = 1.9095, lr_0 = 2.6908e-04
Validation rmse = 0.121734
Validation r2 = 0.868382
Validation mse = 0.014819
Epoch 33
Loss = 1.1874e-01, PNorm = 35.2762, GNorm = 0.8551, lr_0 = 2.6205e-04
Validation rmse = 0.121872
Validation r2 = 0.868083
Validation mse = 0.014853
Epoch 34
Loss = 8.2613e-02, PNorm = 35.2850, GNorm = 1.2636, lr_0 = 2.5521e-04
Loss = 1.1126e-01, PNorm = 35.2929, GNorm = 0.9698, lr_0 = 2.4854e-04
Validation rmse = 0.125118
Validation r2 = 0.860962
Validation mse = 0.015655
Epoch 35
Loss = 1.0726e-01, PNorm = 35.3035, GNorm = 2.6926, lr_0 = 2.4141e-04
Loss = 1.1327e-01, PNorm = 35.3114, GNorm = 1.9406, lr_0 = 2.3511e-04
Validation rmse = 0.123146
Validation r2 = 0.865311
Validation mse = 0.015165
Epoch 36
Loss = 1.0653e-01, PNorm = 35.3200, GNorm = 2.4070, lr_0 = 2.2897e-04
Validation rmse = 0.122297
Validation r2 = 0.867162
Validation mse = 0.014957
Epoch 37
Loss = 9.3051e-02, PNorm = 35.3298, GNorm = 0.6702, lr_0 = 2.2240e-04
Loss = 1.1754e-01, PNorm = 35.3370, GNorm = 1.1870, lr_0 = 2.1659e-04
Validation rmse = 0.122800
Validation r2 = 0.866066
Validation mse = 0.015080
Epoch 38
Loss = 1.0786e-01, PNorm = 35.3450, GNorm = 1.0526, lr_0 = 2.1093e-04
Validation rmse = 0.120242
Validation r2 = 0.871587
Validation mse = 0.014458
Epoch 39
Loss = 9.1008e-02, PNorm = 35.3516, GNorm = 0.7172, lr_0 = 2.0488e-04
Loss = 1.0663e-01, PNorm = 35.3584, GNorm = 1.6785, lr_0 = 1.9953e-04
Validation rmse = 0.120983
Validation r2 = 0.870001
Validation mse = 0.014637
Epoch 40
Loss = 1.1081e-01, PNorm = 35.3657, GNorm = 1.5584, lr_0 = 1.9431e-04
Validation rmse = 0.120842
Validation r2 = 0.870302
Validation mse = 0.014603
Epoch 41
Loss = 7.9103e-02, PNorm = 35.3736, GNorm = 0.9433, lr_0 = 1.8874e-04
Loss = 1.0648e-01, PNorm = 35.3787, GNorm = 0.6837, lr_0 = 1.8381e-04
Validation rmse = 0.121256
Validation r2 = 0.869413
Validation mse = 0.014703
Epoch 42
Loss = 1.0546e-01, PNorm = 35.3852, GNorm = 1.7469, lr_0 = 1.7901e-04
Validation rmse = 0.119490
Validation r2 = 0.873189
Validation mse = 0.014278
Epoch 43
Loss = 1.2404e-01, PNorm = 35.3925, GNorm = 0.7898, lr_0 = 1.7433e-04
Loss = 1.0748e-01, PNorm = 35.3985, GNorm = 3.4612, lr_0 = 1.6978e-04
Validation rmse = 0.119613
Validation r2 = 0.872928
Validation mse = 0.014307
Epoch 44
Loss = 9.2855e-02, PNorm = 35.4054, GNorm = 1.1649, lr_0 = 1.6491e-04
Loss = 1.0029e-01, PNorm = 35.4109, GNorm = 1.3863, lr_0 = 1.6060e-04
Validation rmse = 0.119399
Validation r2 = 0.873382
Validation mse = 0.014256
Epoch 45
Loss = 9.2260e-02, PNorm = 35.4163, GNorm = 0.9733, lr_0 = 1.5641e-04
Validation rmse = 0.119456
Validation r2 = 0.873262
Validation mse = 0.014270
Epoch 46
Loss = 8.8767e-02, PNorm = 35.4213, GNorm = 0.7407, lr_0 = 1.5192e-04
Loss = 1.0266e-01, PNorm = 35.4266, GNorm = 1.2648, lr_0 = 1.4795e-04
Validation rmse = 0.119053
Validation r2 = 0.874115
Validation mse = 0.014174
Epoch 47
Loss = 9.4252e-02, PNorm = 35.4326, GNorm = 0.9982, lr_0 = 1.4409e-04
Validation rmse = 0.122880
Validation r2 = 0.865893
Validation mse = 0.015099
Epoch 48
Loss = 7.1829e-02, PNorm = 35.4371, GNorm = 1.8007, lr_0 = 1.3995e-04
Loss = 1.0709e-01, PNorm = 35.4422, GNorm = 1.8894, lr_0 = 1.3630e-04
Validation rmse = 0.120710
Validation r2 = 0.870587
Validation mse = 0.014571
Epoch 49
Loss = 9.1113e-02, PNorm = 35.4457, GNorm = 2.6011, lr_0 = 1.3274e-04
Validation rmse = 0.118957
Validation r2 = 0.874319
Validation mse = 0.014151
Epoch 50
Loss = 8.3924e-02, PNorm = 35.4505, GNorm = 0.5837, lr_0 = 1.2927e-04
Loss = 1.1025e-01, PNorm = 35.4555, GNorm = 0.8667, lr_0 = 1.2589e-04
Validation rmse = 0.119092
Validation r2 = 0.874032
Validation mse = 0.014183
Epoch 51
Loss = 9.5229e-02, PNorm = 35.4600, GNorm = 1.2909, lr_0 = 1.2228e-04
Validation rmse = 0.122052
Validation r2 = 0.867694
Validation mse = 0.014897
Epoch 52
Loss = 8.9624e-02, PNorm = 35.4638, GNorm = 1.5438, lr_0 = 1.1909e-04
Loss = 9.8957e-02, PNorm = 35.4684, GNorm = 0.8672, lr_0 = 1.1598e-04
Validation rmse = 0.118925
Validation r2 = 0.874386
Validation mse = 0.014143
Epoch 53
Loss = 9.3576e-02, PNorm = 35.4725, GNorm = 0.9033, lr_0 = 1.1265e-04
Loss = 9.5545e-02, PNorm = 35.4760, GNorm = 2.1726, lr_0 = 1.0971e-04
Validation rmse = 0.118372
Validation r2 = 0.875551
Validation mse = 0.014012
Epoch 54
Loss = 1.0512e-01, PNorm = 35.4796, GNorm = 2.7981, lr_0 = 1.0684e-04
Validation rmse = 0.121269
Validation r2 = 0.869385
Validation mse = 0.014706
Epoch 55
Loss = 9.3202e-02, PNorm = 35.4841, GNorm = 2.0983, lr_0 = 1.0377e-04
Loss = 9.7703e-02, PNorm = 35.4873, GNorm = 2.1846, lr_0 = 1.0106e-04
Validation rmse = 0.118661
Validation r2 = 0.874943
Validation mse = 0.014080
Epoch 56
Loss = 9.5833e-02, PNorm = 35.4912, GNorm = 0.9629, lr_0 = 1.0000e-04
Validation rmse = 0.118727
Validation r2 = 0.874804
Validation mse = 0.014096
Epoch 57
Loss = 7.9706e-02, PNorm = 35.4946, GNorm = 1.0293, lr_0 = 1.0000e-04
Loss = 1.0028e-01, PNorm = 35.4985, GNorm = 0.7017, lr_0 = 1.0000e-04
Validation rmse = 0.119961
Validation r2 = 0.872188
Validation mse = 0.014391
Epoch 58
Loss = 9.0452e-02, PNorm = 35.5008, GNorm = 0.9172, lr_0 = 1.0000e-04
Validation rmse = 0.120306
Validation r2 = 0.871452
Validation mse = 0.014473
Epoch 59
Loss = 8.2541e-02, PNorm = 35.5047, GNorm = 0.6632, lr_0 = 1.0000e-04
Loss = 8.5357e-02, PNorm = 35.5083, GNorm = 0.9497, lr_0 = 1.0000e-04
Validation rmse = 0.119459
Validation r2 = 0.873256
Validation mse = 0.014270
Model 0 best validation rmse = 0.118372 on epoch 53
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.700407
Model 0 test r2 = -136.040447
Model 0 test mse = 0.490570
Ensemble test rmse = 0.700407
Ensemble test r2 = -136.040447
Ensemble test mse = 0.490570
Fold 3
Splitting data with seed 3
Total size = 973 | train size = 778 | val size = 195 | test size = 49
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.8890e-01, PNorm = 34.0159, GNorm = 5.1916, lr_0 = 4.3000e-04
Validation rmse = 0.316140
Validation r2 = 0.084146
Validation mse = 0.099944
Epoch 1
Loss = 8.5382e-01, PNorm = 34.0422, GNorm = 11.2085, lr_0 = 7.6000e-04
Loss = 7.8568e-01, PNorm = 34.0865, GNorm = 3.4987, lr_0 = 9.9472e-04
Validation rmse = 0.281605
Validation r2 = 0.273308
Validation mse = 0.079302
Epoch 2
Loss = 6.4815e-01, PNorm = 34.1553, GNorm = 9.7674, lr_0 = 9.6874e-04
Validation rmse = 0.234050
Validation r2 = 0.498022
Validation mse = 0.054779
Epoch 3
Loss = 5.2721e-01, PNorm = 34.2419, GNorm = 2.5166, lr_0 = 9.4094e-04
Loss = 4.4787e-01, PNorm = 34.3135, GNorm = 4.6555, lr_0 = 9.1637e-04
Validation rmse = 0.196477
Validation r2 = 0.646252
Validation mse = 0.038603
Epoch 4
Loss = 3.3149e-01, PNorm = 34.3865, GNorm = 2.9970, lr_0 = 8.9243e-04
Validation rmse = 0.175683
Validation r2 = 0.717168
Validation mse = 0.030865
Epoch 5
Loss = 2.4999e-01, PNorm = 34.4523, GNorm = 2.2268, lr_0 = 8.6682e-04
Loss = 2.8087e-01, PNorm = 34.5156, GNorm = 1.3433, lr_0 = 8.4418e-04
Validation rmse = 0.158255
Validation r2 = 0.770501
Validation mse = 0.025045
Epoch 6
Loss = 2.5116e-01, PNorm = 34.5735, GNorm = 2.0834, lr_0 = 8.2213e-04
Validation rmse = 0.173108
Validation r2 = 0.725398
Validation mse = 0.029966
Epoch 7
Loss = 3.3745e-01, PNorm = 34.6193, GNorm = 4.2102, lr_0 = 7.9854e-04
Loss = 2.0716e-01, PNorm = 34.6687, GNorm = 2.1603, lr_0 = 7.7769e-04
Validation rmse = 0.140175
Validation r2 = 0.819943
Validation mse = 0.019649
Epoch 8
Loss = 1.7802e-01, PNorm = 34.7049, GNorm = 0.6890, lr_0 = 7.5737e-04
Loss = 1.8073e-01, PNorm = 34.7353, GNorm = 0.9726, lr_0 = 7.3759e-04
Validation rmse = 0.133591
Validation r2 = 0.836461
Validation mse = 0.017847
Epoch 9
Loss = 1.7525e-01, PNorm = 34.7760, GNorm = 1.1290, lr_0 = 7.1833e-04
Validation rmse = 0.131629
Validation r2 = 0.841228
Validation mse = 0.017326
Epoch 10
Loss = 1.5418e-01, PNorm = 34.8046, GNorm = 2.5927, lr_0 = 6.9772e-04
Loss = 1.5811e-01, PNorm = 34.8299, GNorm = 2.5123, lr_0 = 6.7949e-04
Validation rmse = 0.126811
Validation r2 = 0.852639
Validation mse = 0.016081
Epoch 11
Loss = 1.4750e-01, PNorm = 34.8516, GNorm = 0.6634, lr_0 = 6.6174e-04
Validation rmse = 0.135961
Validation r2 = 0.830607
Validation mse = 0.018485
Epoch 12
Loss = 1.6159e-01, PNorm = 34.8758, GNorm = 1.9774, lr_0 = 6.4276e-04
Loss = 1.3813e-01, PNorm = 34.9016, GNorm = 1.6151, lr_0 = 6.2597e-04
Validation rmse = 0.133185
Validation r2 = 0.837453
Validation mse = 0.017738
Epoch 13
Loss = 1.5415e-01, PNorm = 34.9263, GNorm = 1.1995, lr_0 = 6.0962e-04
Validation rmse = 0.131601
Validation r2 = 0.841297
Validation mse = 0.017319
Epoch 14
Loss = 1.3143e-01, PNorm = 34.9486, GNorm = 4.2869, lr_0 = 5.9213e-04
Loss = 1.5373e-01, PNorm = 34.9664, GNorm = 2.3815, lr_0 = 5.7666e-04
Validation rmse = 0.123801
Validation r2 = 0.859551
Validation mse = 0.015327
Epoch 15
Loss = 1.4870e-01, PNorm = 34.9844, GNorm = 2.5657, lr_0 = 5.6160e-04
Validation rmse = 0.163310
Validation r2 = 0.755603
Validation mse = 0.026670
Epoch 16
Loss = 1.5479e-01, PNorm = 35.0069, GNorm = 2.4900, lr_0 = 5.4548e-04
Loss = 1.7918e-01, PNorm = 35.0241, GNorm = 5.4272, lr_0 = 5.3124e-04
Validation rmse = 0.144278
Validation r2 = 0.809248
Validation mse = 0.020816
Epoch 17
Loss = 1.4458e-01, PNorm = 35.0398, GNorm = 3.5098, lr_0 = 5.1736e-04
Loss = 1.4731e-01, PNorm = 35.0563, GNorm = 0.7501, lr_0 = 5.0385e-04
Validation rmse = 0.126316
Validation r2 = 0.853787
Validation mse = 0.015956
Epoch 18
Loss = 1.1256e-01, PNorm = 35.0716, GNorm = 1.3733, lr_0 = 4.9069e-04
Validation rmse = 0.128138
Validation r2 = 0.849538
Validation mse = 0.016419
Epoch 19
Loss = 1.3209e-01, PNorm = 35.0908, GNorm = 1.9104, lr_0 = 4.7661e-04
Loss = 1.3324e-01, PNorm = 35.1054, GNorm = 1.3271, lr_0 = 4.6416e-04
Validation rmse = 0.132275
Validation r2 = 0.839667
Validation mse = 0.017497
Epoch 20
Loss = 1.2493e-01, PNorm = 35.1149, GNorm = 3.8460, lr_0 = 4.5204e-04
Validation rmse = 0.124014
Validation r2 = 0.859068
Validation mse = 0.015380
Epoch 21
Loss = 1.3429e-01, PNorm = 35.1305, GNorm = 1.0981, lr_0 = 4.3906e-04
Loss = 1.1958e-01, PNorm = 35.1453, GNorm = 1.8284, lr_0 = 4.2760e-04
Validation rmse = 0.120679
Validation r2 = 0.866545
Validation mse = 0.014563
Epoch 22
Loss = 1.3602e-01, PNorm = 35.1577, GNorm = 2.8883, lr_0 = 4.1643e-04
Validation rmse = 0.120036
Validation r2 = 0.867965
Validation mse = 0.014409
Epoch 23
Loss = 1.3315e-01, PNorm = 35.1718, GNorm = 1.2052, lr_0 = 4.0448e-04
Loss = 1.1031e-01, PNorm = 35.1821, GNorm = 2.3036, lr_0 = 3.9391e-04
Validation rmse = 0.120124
Validation r2 = 0.867771
Validation mse = 0.014430
Epoch 24
Loss = 1.2357e-01, PNorm = 35.1940, GNorm = 1.4165, lr_0 = 3.8363e-04
Validation rmse = 0.137016
Validation r2 = 0.827968
Validation mse = 0.018773
Epoch 25
Loss = 1.2612e-01, PNorm = 35.2046, GNorm = 4.6050, lr_0 = 3.7361e-04
Loss = 1.2938e-01, PNorm = 35.2151, GNorm = 1.7802, lr_0 = 3.6385e-04
Validation rmse = 0.119207
Validation r2 = 0.869782
Validation mse = 0.014210
Epoch 26
Loss = 1.1724e-01, PNorm = 35.2324, GNorm = 0.6981, lr_0 = 3.5341e-04
Loss = 1.2128e-01, PNorm = 35.2408, GNorm = 1.4073, lr_0 = 3.4418e-04
Validation rmse = 0.121039
Validation r2 = 0.865749
Validation mse = 0.014650
Epoch 27
Loss = 1.1223e-01, PNorm = 35.2536, GNorm = 0.9656, lr_0 = 3.3519e-04
Validation rmse = 0.121270
Validation r2 = 0.865236
Validation mse = 0.014706
Epoch 28
Loss = 1.0605e-01, PNorm = 35.2633, GNorm = 1.5342, lr_0 = 3.2557e-04
Loss = 1.1691e-01, PNorm = 35.2723, GNorm = 0.8514, lr_0 = 3.1707e-04
Validation rmse = 0.122693
Validation r2 = 0.862054
Validation mse = 0.015054
Epoch 29
Loss = 1.0849e-01, PNorm = 35.2817, GNorm = 0.7640, lr_0 = 3.0878e-04
Validation rmse = 0.118426
Validation r2 = 0.871482
Validation mse = 0.014025
Epoch 30
Loss = 9.5510e-02, PNorm = 35.2913, GNorm = 1.2095, lr_0 = 2.9992e-04
Loss = 1.1830e-01, PNorm = 35.3005, GNorm = 3.5526, lr_0 = 2.9209e-04
Validation rmse = 0.118639
Validation r2 = 0.871019
Validation mse = 0.014075
Epoch 31
Loss = 9.0182e-02, PNorm = 35.3104, GNorm = 1.5357, lr_0 = 2.8446e-04
Validation rmse = 0.118865
Validation r2 = 0.870529
Validation mse = 0.014129
Epoch 32
Loss = 1.4395e-01, PNorm = 35.3197, GNorm = 1.1672, lr_0 = 2.7630e-04
Loss = 9.6323e-02, PNorm = 35.3266, GNorm = 2.3978, lr_0 = 2.6908e-04
Validation rmse = 0.117093
Validation r2 = 0.874359
Validation mse = 0.013711
Epoch 33
Loss = 1.0721e-01, PNorm = 35.3376, GNorm = 0.6362, lr_0 = 2.6205e-04
Validation rmse = 0.121150
Validation r2 = 0.865502
Validation mse = 0.014677
Epoch 34
Loss = 9.6011e-02, PNorm = 35.3465, GNorm = 2.3593, lr_0 = 2.5521e-04
Loss = 1.1719e-01, PNorm = 35.3566, GNorm = 1.8087, lr_0 = 2.4854e-04
Validation rmse = 0.121522
Validation r2 = 0.864676
Validation mse = 0.014767
Epoch 35
Loss = 1.0121e-01, PNorm = 35.3653, GNorm = 2.7305, lr_0 = 2.4141e-04
Loss = 1.0118e-01, PNorm = 35.3726, GNorm = 1.4468, lr_0 = 2.3511e-04
Validation rmse = 0.117848
Validation r2 = 0.872734
Validation mse = 0.013888
Epoch 36
Loss = 9.8811e-02, PNorm = 35.3814, GNorm = 0.8508, lr_0 = 2.2897e-04
Validation rmse = 0.118500
Validation r2 = 0.871321
Validation mse = 0.014042
Epoch 37
Loss = 1.1505e-01, PNorm = 35.3902, GNorm = 1.4476, lr_0 = 2.2240e-04
Loss = 9.6783e-02, PNorm = 35.3980, GNorm = 1.2401, lr_0 = 2.1659e-04
Validation rmse = 0.117430
Validation r2 = 0.873635
Validation mse = 0.013790
Epoch 38
Loss = 9.6939e-02, PNorm = 35.4046, GNorm = 2.2637, lr_0 = 2.1093e-04
Validation rmse = 0.120582
Validation r2 = 0.866760
Validation mse = 0.014540
Epoch 39
Loss = 1.1014e-01, PNorm = 35.4112, GNorm = 2.0603, lr_0 = 2.0488e-04
Loss = 1.0391e-01, PNorm = 35.4188, GNorm = 1.2926, lr_0 = 1.9953e-04
Validation rmse = 0.117601
Validation r2 = 0.873268
Validation mse = 0.013830
Epoch 40
Loss = 1.1501e-01, PNorm = 35.4248, GNorm = 2.3482, lr_0 = 1.9431e-04
Validation rmse = 0.118046
Validation r2 = 0.872306
Validation mse = 0.013935
Epoch 41
Loss = 1.0360e-01, PNorm = 35.4337, GNorm = 2.2219, lr_0 = 1.8874e-04
Loss = 1.0074e-01, PNorm = 35.4407, GNorm = 2.9018, lr_0 = 1.8381e-04
Validation rmse = 0.120905
Validation r2 = 0.866045
Validation mse = 0.014618
Epoch 42
Loss = 1.0001e-01, PNorm = 35.4477, GNorm = 2.9313, lr_0 = 1.7901e-04
Validation rmse = 0.118932
Validation r2 = 0.870381
Validation mse = 0.014145
Epoch 43
Loss = 1.0908e-01, PNorm = 35.4541, GNorm = 1.6757, lr_0 = 1.7433e-04
Loss = 9.2737e-02, PNorm = 35.4585, GNorm = 0.7492, lr_0 = 1.6978e-04
Validation rmse = 0.117189
Validation r2 = 0.874154
Validation mse = 0.013733
Epoch 44
Loss = 8.4040e-02, PNorm = 35.4656, GNorm = 1.7666, lr_0 = 1.6491e-04
Loss = 1.0710e-01, PNorm = 35.4713, GNorm = 3.4893, lr_0 = 1.6060e-04
Validation rmse = 0.118380
Validation r2 = 0.871582
Validation mse = 0.014014
Epoch 45
Loss = 1.0156e-01, PNorm = 35.4764, GNorm = 2.0434, lr_0 = 1.5641e-04
Validation rmse = 0.116882
Validation r2 = 0.874812
Validation mse = 0.013661
Epoch 46
Loss = 9.0461e-02, PNorm = 35.4825, GNorm = 2.1683, lr_0 = 1.5192e-04
Loss = 9.0702e-02, PNorm = 35.4872, GNorm = 1.4823, lr_0 = 1.4795e-04
Validation rmse = 0.117653
Validation r2 = 0.873154
Validation mse = 0.013842
Epoch 47
Loss = 9.6493e-02, PNorm = 35.4918, GNorm = 2.2195, lr_0 = 1.4409e-04
Validation rmse = 0.118264
Validation r2 = 0.871834
Validation mse = 0.013986
Epoch 48
Loss = 7.4176e-02, PNorm = 35.4972, GNorm = 1.6654, lr_0 = 1.3995e-04
Loss = 9.7055e-02, PNorm = 35.5014, GNorm = 0.8114, lr_0 = 1.3630e-04
Validation rmse = 0.117395
Validation r2 = 0.873710
Validation mse = 0.013782
Epoch 49
Loss = 9.3183e-02, PNorm = 35.5074, GNorm = 0.7856, lr_0 = 1.3274e-04
Validation rmse = 0.116926
Validation r2 = 0.874718
Validation mse = 0.013672
Epoch 50
Loss = 1.0432e-01, PNorm = 35.5110, GNorm = 0.8118, lr_0 = 1.2927e-04
Loss = 7.9222e-02, PNorm = 35.5159, GNorm = 1.5585, lr_0 = 1.2589e-04
Validation rmse = 0.116803
Validation r2 = 0.874980
Validation mse = 0.013643
Epoch 51
Loss = 9.6580e-02, PNorm = 35.5197, GNorm = 1.8133, lr_0 = 1.2228e-04
Validation rmse = 0.117308
Validation r2 = 0.873897
Validation mse = 0.013761
Epoch 52
Loss = 8.1785e-02, PNorm = 35.5239, GNorm = 0.7457, lr_0 = 1.1909e-04
Loss = 9.1406e-02, PNorm = 35.5275, GNorm = 1.7584, lr_0 = 1.1598e-04
Validation rmse = 0.117087
Validation r2 = 0.874373
Validation mse = 0.013709
Epoch 53
Loss = 9.6423e-02, PNorm = 35.5318, GNorm = 1.9054, lr_0 = 1.1265e-04
Loss = 8.4154e-02, PNorm = 35.5354, GNorm = 1.2494, lr_0 = 1.0971e-04
Validation rmse = 0.116244
Validation r2 = 0.876175
Validation mse = 0.013513
Epoch 54
Loss = 7.7303e-02, PNorm = 35.5381, GNorm = 0.9895, lr_0 = 1.0684e-04
Validation rmse = 0.116457
Validation r2 = 0.875721
Validation mse = 0.013562
Epoch 55
Loss = 8.8904e-02, PNorm = 35.5426, GNorm = 0.7453, lr_0 = 1.0377e-04
Loss = 8.4020e-02, PNorm = 35.5465, GNorm = 1.2134, lr_0 = 1.0106e-04
Validation rmse = 0.116405
Validation r2 = 0.875831
Validation mse = 0.013550
Epoch 56
Loss = 9.3861e-02, PNorm = 35.5498, GNorm = 2.3572, lr_0 = 1.0000e-04
Validation rmse = 0.116432
Validation r2 = 0.875774
Validation mse = 0.013556
Epoch 57
Loss = 8.1359e-02, PNorm = 35.5536, GNorm = 1.0197, lr_0 = 1.0000e-04
Loss = 8.9898e-02, PNorm = 35.5577, GNorm = 1.8939, lr_0 = 1.0000e-04
Validation rmse = 0.116022
Validation r2 = 0.876646
Validation mse = 0.013461
Epoch 58
Loss = 7.8003e-02, PNorm = 35.5610, GNorm = 1.5662, lr_0 = 1.0000e-04
Validation rmse = 0.116603
Validation r2 = 0.875408
Validation mse = 0.013596
Epoch 59
Loss = 1.1044e-01, PNorm = 35.5641, GNorm = 1.5832, lr_0 = 1.0000e-04
Loss = 8.4729e-02, PNorm = 35.5682, GNorm = 0.5350, lr_0 = 1.0000e-04
Validation rmse = 0.117297
Validation r2 = 0.873922
Validation mse = 0.013759
Model 0 best validation rmse = 0.116022 on epoch 57
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.639730
Model 0 test r2 = -113.324983
Model 0 test mse = 0.409255
Ensemble test rmse = 0.639730
Ensemble test r2 = -113.324983
Ensemble test mse = 0.409255
Fold 4
Splitting data with seed 4
Total size = 973 | train size = 778 | val size = 195 | test size = 49
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.5478e-01, PNorm = 34.0168, GNorm = 3.0135, lr_0 = 4.3000e-04
Validation rmse = 0.308342
Validation r2 = 0.174880
Validation mse = 0.095075
Epoch 1
Loss = 7.5468e-01, PNorm = 34.0505, GNorm = 1.5845, lr_0 = 7.6000e-04
Loss = 6.2763e-01, PNorm = 34.1016, GNorm = 5.0305, lr_0 = 9.9472e-04
Validation rmse = 0.255130
Validation r2 = 0.435094
Validation mse = 0.065091
Epoch 2
Loss = 5.5010e-01, PNorm = 34.1670, GNorm = 10.1546, lr_0 = 9.6874e-04
Validation rmse = 0.237844
Validation r2 = 0.509049
Validation mse = 0.056570
Epoch 3
Loss = 4.4084e-01, PNorm = 34.2405, GNorm = 8.6844, lr_0 = 9.4094e-04
Loss = 3.9032e-01, PNorm = 34.3035, GNorm = 7.6260, lr_0 = 9.1637e-04
Validation rmse = 0.219490
Validation r2 = 0.581900
Validation mse = 0.048176
Epoch 4
Loss = 3.3618e-01, PNorm = 34.3611, GNorm = 3.5897, lr_0 = 8.9243e-04
Validation rmse = 0.189633
Validation r2 = 0.687911
Validation mse = 0.035961
Epoch 5
Loss = 2.3775e-01, PNorm = 34.4105, GNorm = 2.6635, lr_0 = 8.6682e-04
Loss = 2.7009e-01, PNorm = 34.4580, GNorm = 5.1356, lr_0 = 8.4418e-04
Validation rmse = 0.205411
Validation r2 = 0.633817
Validation mse = 0.042194
Epoch 6
Loss = 3.2921e-01, PNorm = 34.5003, GNorm = 1.9908, lr_0 = 8.2213e-04
Validation rmse = 0.218301
Validation r2 = 0.586415
Validation mse = 0.047655
Epoch 7
Loss = 4.0387e-01, PNorm = 34.5495, GNorm = 3.1894, lr_0 = 7.9854e-04
Loss = 2.5203e-01, PNorm = 34.5962, GNorm = 0.8207, lr_0 = 7.7769e-04
Validation rmse = 0.169188
Validation r2 = 0.751578
Validation mse = 0.028625
Epoch 8
Loss = 2.4202e-01, PNorm = 34.6323, GNorm = 3.1157, lr_0 = 7.5737e-04
Loss = 2.0905e-01, PNorm = 34.6643, GNorm = 7.5212, lr_0 = 7.3759e-04
Validation rmse = 0.153338
Validation r2 = 0.795943
Validation mse = 0.023513
Epoch 9
Loss = 2.3058e-01, PNorm = 34.6904, GNorm = 5.2577, lr_0 = 7.1833e-04
Validation rmse = 0.149689
Validation r2 = 0.805540
Validation mse = 0.022407
Epoch 10
Loss = 1.8213e-01, PNorm = 34.7234, GNorm = 3.4719, lr_0 = 6.9772e-04
Loss = 1.9926e-01, PNorm = 34.7526, GNorm = 3.2892, lr_0 = 6.7949e-04
Validation rmse = 0.151849
Validation r2 = 0.799886
Validation mse = 0.023058
Epoch 11
Loss = 1.9162e-01, PNorm = 34.7796, GNorm = 1.4829, lr_0 = 6.6174e-04
Validation rmse = 0.145990
Validation r2 = 0.815031
Validation mse = 0.021313
Epoch 12
Loss = 1.7068e-01, PNorm = 34.8095, GNorm = 0.6841, lr_0 = 6.4276e-04
Loss = 1.6303e-01, PNorm = 34.8343, GNorm = 0.8022, lr_0 = 6.2597e-04
Validation rmse = 0.140844
Validation r2 = 0.827843
Validation mse = 0.019837
Epoch 13
Loss = 1.4973e-01, PNorm = 34.8542, GNorm = 1.5873, lr_0 = 6.0962e-04
Validation rmse = 0.141405
Validation r2 = 0.826467
Validation mse = 0.019995
Epoch 14
Loss = 1.0458e-01, PNorm = 34.8786, GNorm = 0.6659, lr_0 = 5.9213e-04
Loss = 1.5142e-01, PNorm = 34.8956, GNorm = 1.3747, lr_0 = 5.7666e-04
Validation rmse = 0.137324
Validation r2 = 0.836338
Validation mse = 0.018858
Epoch 15
Loss = 1.6170e-01, PNorm = 34.9233, GNorm = 1.3824, lr_0 = 5.6160e-04
Validation rmse = 0.137631
Validation r2 = 0.835607
Validation mse = 0.018942
Epoch 16
Loss = 1.0881e-01, PNorm = 34.9409, GNorm = 2.6411, lr_0 = 5.4548e-04
Loss = 1.4679e-01, PNorm = 34.9623, GNorm = 1.2303, lr_0 = 5.3124e-04
Validation rmse = 0.136827
Validation r2 = 0.837521
Validation mse = 0.018722
Epoch 17
Loss = 1.9285e-01, PNorm = 34.9765, GNorm = 5.3751, lr_0 = 5.1736e-04
Loss = 1.4549e-01, PNorm = 35.0015, GNorm = 1.0036, lr_0 = 5.0385e-04
Validation rmse = 0.140895
Validation r2 = 0.827716
Validation mse = 0.019851
Epoch 18
Loss = 1.3449e-01, PNorm = 35.0222, GNorm = 1.0975, lr_0 = 4.9069e-04
Validation rmse = 0.144613
Validation r2 = 0.818504
Validation mse = 0.020913
Epoch 19
Loss = 1.2284e-01, PNorm = 35.0394, GNorm = 0.7386, lr_0 = 4.7661e-04
Loss = 1.3387e-01, PNorm = 35.0594, GNorm = 1.7069, lr_0 = 4.6416e-04
Validation rmse = 0.141009
Validation r2 = 0.827439
Validation mse = 0.019883
Epoch 20
Loss = 1.3050e-01, PNorm = 35.0756, GNorm = 1.5038, lr_0 = 4.5204e-04
Validation rmse = 0.135933
Validation r2 = 0.839638
Validation mse = 0.018478
Epoch 21
Loss = 1.3670e-01, PNorm = 35.0927, GNorm = 1.6799, lr_0 = 4.3906e-04
Loss = 1.1268e-01, PNorm = 35.1097, GNorm = 1.6103, lr_0 = 4.2760e-04
Validation rmse = 0.134725
Validation r2 = 0.842476
Validation mse = 0.018151
Epoch 22
Loss = 1.1686e-01, PNorm = 35.1244, GNorm = 0.8402, lr_0 = 4.1643e-04
Validation rmse = 0.132431
Validation r2 = 0.847795
Validation mse = 0.017538
Epoch 23
Loss = 1.1994e-01, PNorm = 35.1403, GNorm = 1.5067, lr_0 = 4.0448e-04
Loss = 1.2416e-01, PNorm = 35.1525, GNorm = 2.4892, lr_0 = 3.9391e-04
Validation rmse = 0.135981
Validation r2 = 0.839526
Validation mse = 0.018491
Epoch 24
Loss = 1.2492e-01, PNorm = 35.1729, GNorm = 1.5813, lr_0 = 3.8363e-04
Validation rmse = 0.134974
Validation r2 = 0.841893
Validation mse = 0.018218
Epoch 25
Loss = 8.3737e-02, PNorm = 35.1892, GNorm = 1.2133, lr_0 = 3.7361e-04
Loss = 1.3194e-01, PNorm = 35.2037, GNorm = 3.0414, lr_0 = 3.6385e-04
Validation rmse = 0.145546
Validation r2 = 0.816155
Validation mse = 0.021184
Epoch 26
Loss = 1.1529e-01, PNorm = 35.2195, GNorm = 2.1354, lr_0 = 3.5341e-04
Loss = 1.1785e-01, PNorm = 35.2310, GNorm = 3.7986, lr_0 = 3.4418e-04
Validation rmse = 0.139272
Validation r2 = 0.831663
Validation mse = 0.019397
Epoch 27
Loss = 1.1083e-01, PNorm = 35.2472, GNorm = 0.9153, lr_0 = 3.3519e-04
Validation rmse = 0.131396
Validation r2 = 0.850164
Validation mse = 0.017265
Epoch 28
Loss = 9.4184e-02, PNorm = 35.2616, GNorm = 1.6882, lr_0 = 3.2557e-04
Loss = 1.1998e-01, PNorm = 35.2719, GNorm = 2.8687, lr_0 = 3.1707e-04
Validation rmse = 0.139386
Validation r2 = 0.831388
Validation mse = 0.019428
Epoch 29
Loss = 1.1439e-01, PNorm = 35.2850, GNorm = 3.5971, lr_0 = 3.0878e-04
Validation rmse = 0.140202
Validation r2 = 0.829406
Validation mse = 0.019657
Epoch 30
Loss = 1.0203e-01, PNorm = 35.2990, GNorm = 1.1025, lr_0 = 2.9992e-04
Loss = 1.0159e-01, PNorm = 35.3095, GNorm = 0.7751, lr_0 = 2.9209e-04
Validation rmse = 0.133167
Validation r2 = 0.846099
Validation mse = 0.017733
Epoch 31
Loss = 9.0945e-02, PNorm = 35.3195, GNorm = 0.8382, lr_0 = 2.8446e-04
Validation rmse = 0.135607
Validation r2 = 0.840407
Validation mse = 0.018389
Epoch 32
Loss = 9.9252e-02, PNorm = 35.3319, GNorm = 1.3855, lr_0 = 2.7630e-04
Loss = 9.8318e-02, PNorm = 35.3438, GNorm = 0.8758, lr_0 = 2.6908e-04
Validation rmse = 0.133255
Validation r2 = 0.845894
Validation mse = 0.017757
Epoch 33
Loss = 9.1484e-02, PNorm = 35.3539, GNorm = 0.3281, lr_0 = 2.6205e-04
Validation rmse = 0.141426
Validation r2 = 0.826416
Validation mse = 0.020001
Epoch 34
Loss = 1.0192e-01, PNorm = 35.3630, GNorm = 1.4021, lr_0 = 2.5521e-04
Loss = 1.0642e-01, PNorm = 35.3739, GNorm = 3.1252, lr_0 = 2.4854e-04
Validation rmse = 0.137149
Validation r2 = 0.836757
Validation mse = 0.018810
Epoch 35
Loss = 1.1205e-01, PNorm = 35.3849, GNorm = 1.2695, lr_0 = 2.4141e-04
Loss = 1.0601e-01, PNorm = 35.3944, GNorm = 0.8392, lr_0 = 2.3511e-04
Validation rmse = 0.134697
Validation r2 = 0.842541
Validation mse = 0.018143
Epoch 36
Loss = 9.7615e-02, PNorm = 35.4051, GNorm = 0.5637, lr_0 = 2.2897e-04
Validation rmse = 0.135857
Validation r2 = 0.839817
Validation mse = 0.018457
Epoch 37
Loss = 1.0504e-01, PNorm = 35.4153, GNorm = 2.8049, lr_0 = 2.2240e-04
Loss = 9.9732e-02, PNorm = 35.4234, GNorm = 3.4773, lr_0 = 2.1659e-04
Validation rmse = 0.152748
Validation r2 = 0.797511
Validation mse = 0.023332
Epoch 38
Loss = 1.0821e-01, PNorm = 35.4328, GNorm = 1.7869, lr_0 = 2.1093e-04
Validation rmse = 0.132730
Validation r2 = 0.847106
Validation mse = 0.017617
Epoch 39
Loss = 9.5361e-02, PNorm = 35.4428, GNorm = 0.7232, lr_0 = 2.0488e-04
Loss = 1.0256e-01, PNorm = 35.4506, GNorm = 0.7883, lr_0 = 1.9953e-04
Validation rmse = 0.138606
Validation r2 = 0.833269
Validation mse = 0.019212
Epoch 40
Loss = 1.0089e-01, PNorm = 35.4579, GNorm = 1.4845, lr_0 = 1.9431e-04
Validation rmse = 0.137935
Validation r2 = 0.834879
Validation mse = 0.019026
Epoch 41
Loss = 9.0100e-02, PNorm = 35.4656, GNorm = 1.0210, lr_0 = 1.8874e-04
Loss = 9.8175e-02, PNorm = 35.4727, GNorm = 0.8000, lr_0 = 1.8381e-04
Validation rmse = 0.133077
Validation r2 = 0.846306
Validation mse = 0.017709
Epoch 42
Loss = 8.5694e-02, PNorm = 35.4793, GNorm = 2.7900, lr_0 = 1.7901e-04
Validation rmse = 0.136637
Validation r2 = 0.837972
Validation mse = 0.018670
Epoch 43
Loss = 8.5048e-02, PNorm = 35.4864, GNorm = 0.7602, lr_0 = 1.7433e-04
Loss = 9.4136e-02, PNorm = 35.4931, GNorm = 1.0724, lr_0 = 1.6978e-04
Validation rmse = 0.138111
Validation r2 = 0.834457
Validation mse = 0.019075
Epoch 44
Loss = 8.2583e-02, PNorm = 35.4996, GNorm = 0.7029, lr_0 = 1.6491e-04
Loss = 9.8148e-02, PNorm = 35.5066, GNorm = 0.9541, lr_0 = 1.6060e-04
Validation rmse = 0.134127
Validation r2 = 0.843871
Validation mse = 0.017990
Epoch 45
Loss = 9.6303e-02, PNorm = 35.5125, GNorm = 1.4694, lr_0 = 1.5641e-04
Validation rmse = 0.139149
Validation r2 = 0.831961
Validation mse = 0.019362
Epoch 46
Loss = 9.8616e-02, PNorm = 35.5175, GNorm = 1.4081, lr_0 = 1.5192e-04
Loss = 9.3039e-02, PNorm = 35.5235, GNorm = 2.3564, lr_0 = 1.4795e-04
Validation rmse = 0.143132
Validation r2 = 0.822203
Validation mse = 0.020487
Epoch 47
Loss = 9.1255e-02, PNorm = 35.5299, GNorm = 1.6663, lr_0 = 1.4409e-04
Validation rmse = 0.133867
Validation r2 = 0.844476
Validation mse = 0.017920
Epoch 48
Loss = 9.9524e-02, PNorm = 35.5366, GNorm = 0.9384, lr_0 = 1.3995e-04
Loss = 8.4427e-02, PNorm = 35.5415, GNorm = 0.4732, lr_0 = 1.3630e-04
Validation rmse = 0.137523
Validation r2 = 0.835864
Validation mse = 0.018913
Epoch 49
Loss = 8.4523e-02, PNorm = 35.5466, GNorm = 0.6797, lr_0 = 1.3274e-04
Validation rmse = 0.136104
Validation r2 = 0.839234
Validation mse = 0.018524
Epoch 50
Loss = 8.9627e-02, PNorm = 35.5520, GNorm = 1.1900, lr_0 = 1.2927e-04
Loss = 8.8960e-02, PNorm = 35.5571, GNorm = 1.7362, lr_0 = 1.2589e-04
Validation rmse = 0.139620
Validation r2 = 0.830821
Validation mse = 0.019494
Epoch 51
Loss = 8.3540e-02, PNorm = 35.5619, GNorm = 0.7523, lr_0 = 1.2228e-04
Validation rmse = 0.140520
Validation r2 = 0.828632
Validation mse = 0.019746
Epoch 52
Loss = 5.3181e-02, PNorm = 35.5659, GNorm = 1.2278, lr_0 = 1.1909e-04
Loss = 8.9039e-02, PNorm = 35.5709, GNorm = 1.9341, lr_0 = 1.1598e-04
Validation rmse = 0.136334
Validation r2 = 0.838691
Validation mse = 0.018587
Epoch 53
Loss = 9.3698e-02, PNorm = 35.5753, GNorm = 1.6012, lr_0 = 1.1265e-04
Loss = 8.0010e-02, PNorm = 35.5800, GNorm = 1.4624, lr_0 = 1.0971e-04
Validation rmse = 0.136003
Validation r2 = 0.839472
Validation mse = 0.018497
Epoch 54
Loss = 8.7064e-02, PNorm = 35.5846, GNorm = 0.9006, lr_0 = 1.0684e-04
Validation rmse = 0.133928
Validation r2 = 0.844335
Validation mse = 0.017937
Epoch 55
Loss = 8.8476e-02, PNorm = 35.5887, GNorm = 0.7027, lr_0 = 1.0377e-04
Loss = 8.5232e-02, PNorm = 35.5927, GNorm = 1.8035, lr_0 = 1.0106e-04
Validation rmse = 0.138945
Validation r2 = 0.832453
Validation mse = 0.019306
Epoch 56
Loss = 8.9128e-02, PNorm = 35.5963, GNorm = 1.4791, lr_0 = 1.0000e-04
Validation rmse = 0.139271
Validation r2 = 0.831666
Validation mse = 0.019396
Epoch 57
Loss = 8.2139e-02, PNorm = 35.6008, GNorm = 1.7796, lr_0 = 1.0000e-04
Loss = 8.3808e-02, PNorm = 35.6046, GNorm = 0.6028, lr_0 = 1.0000e-04
Validation rmse = 0.136656
Validation r2 = 0.837927
Validation mse = 0.018675
Epoch 58
Loss = 7.4978e-02, PNorm = 35.6088, GNorm = 1.2309, lr_0 = 1.0000e-04
Validation rmse = 0.139096
Validation r2 = 0.832088
Validation mse = 0.019348
Epoch 59
Loss = 8.1269e-02, PNorm = 35.6125, GNorm = 0.6570, lr_0 = 1.0000e-04
Loss = 8.3235e-02, PNorm = 35.6164, GNorm = 0.7327, lr_0 = 1.0000e-04
Validation rmse = 0.140911
Validation r2 = 0.827678
Validation mse = 0.019856
Model 0 best validation rmse = 0.131396 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.657498
Model 0 test r2 = -119.763487
Model 0 test mse = 0.432303
Ensemble test rmse = 0.657498
Ensemble test r2 = -119.763487
Ensemble test mse = 0.432303
Fold 5
Splitting data with seed 5
Total size = 973 | train size = 778 | val size = 195 | test size = 49
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.8213e-01, PNorm = 34.0146, GNorm = 7.3686, lr_0 = 4.3000e-04
Validation rmse = 0.301642
Validation r2 = 0.176906
Validation mse = 0.090988
Epoch 1
Loss = 7.9219e-01, PNorm = 34.0450, GNorm = 2.3077, lr_0 = 7.6000e-04
Loss = 7.4008e-01, PNorm = 34.0950, GNorm = 1.4434, lr_0 = 9.9472e-04
Validation rmse = 0.254958
Validation r2 = 0.411964
Validation mse = 0.065004
Epoch 2
Loss = 5.7347e-01, PNorm = 34.1746, GNorm = 6.4941, lr_0 = 9.6874e-04
Validation rmse = 0.210489
Validation r2 = 0.599202
Validation mse = 0.044306
Epoch 3
Loss = 3.8517e-01, PNorm = 34.2772, GNorm = 4.4602, lr_0 = 9.4094e-04
Loss = 3.6769e-01, PNorm = 34.3616, GNorm = 13.1040, lr_0 = 9.1637e-04
Validation rmse = 0.232139
Validation r2 = 0.512513
Validation mse = 0.053889
Epoch 4
Loss = 4.7243e-01, PNorm = 34.4171, GNorm = 2.7994, lr_0 = 8.9243e-04
Validation rmse = 0.192031
Validation r2 = 0.666411
Validation mse = 0.036876
Epoch 5
Loss = 3.1799e-01, PNorm = 34.4763, GNorm = 1.4765, lr_0 = 8.6682e-04
Loss = 2.7578e-01, PNorm = 34.5308, GNorm = 1.3547, lr_0 = 8.4418e-04
Validation rmse = 0.171347
Validation r2 = 0.734405
Validation mse = 0.029360
Epoch 6
Loss = 1.9713e-01, PNorm = 34.5721, GNorm = 1.3612, lr_0 = 8.2213e-04
Validation rmse = 0.162349
Validation r2 = 0.761568
Validation mse = 0.026357
Epoch 7
Loss = 1.5163e-01, PNorm = 34.6210, GNorm = 0.8695, lr_0 = 7.9854e-04
Loss = 1.9527e-01, PNorm = 34.6589, GNorm = 2.1373, lr_0 = 7.7769e-04
Validation rmse = 0.169066
Validation r2 = 0.741430
Validation mse = 0.028583
Epoch 8
Loss = 1.7877e-01, PNorm = 34.6968, GNorm = 2.2839, lr_0 = 7.5737e-04
Loss = 1.6802e-01, PNorm = 34.7302, GNorm = 1.2756, lr_0 = 7.3759e-04
Validation rmse = 0.150819
Validation r2 = 0.794230
Validation mse = 0.022747
Epoch 9
Loss = 1.6133e-01, PNorm = 34.7604, GNorm = 2.5440, lr_0 = 7.1833e-04
Validation rmse = 0.158995
Validation r2 = 0.771316
Validation mse = 0.025280
Epoch 10
Loss = 1.2757e-01, PNorm = 34.7881, GNorm = 3.0839, lr_0 = 6.9772e-04
Loss = 1.4563e-01, PNorm = 34.8118, GNorm = 0.9773, lr_0 = 6.7949e-04
Validation rmse = 0.148963
Validation r2 = 0.799265
Validation mse = 0.022190
Epoch 11
Loss = 1.2507e-01, PNorm = 34.8412, GNorm = 1.9261, lr_0 = 6.6174e-04
Validation rmse = 0.185371
Validation r2 = 0.689151
Validation mse = 0.034362
Epoch 12
Loss = 1.9220e-01, PNorm = 34.8677, GNorm = 5.0039, lr_0 = 6.4276e-04
Loss = 1.3843e-01, PNorm = 34.8924, GNorm = 2.1273, lr_0 = 6.2597e-04
Validation rmse = 0.149508
Validation r2 = 0.797793
Validation mse = 0.022353
Epoch 13
Loss = 1.2205e-01, PNorm = 34.9201, GNorm = 0.7325, lr_0 = 6.0962e-04
Validation rmse = 0.156712
Validation r2 = 0.777838
Validation mse = 0.024559
Epoch 14
Loss = 8.1608e-02, PNorm = 34.9420, GNorm = 1.2826, lr_0 = 5.9213e-04
Loss = 1.4205e-01, PNorm = 34.9594, GNorm = 0.7206, lr_0 = 5.7666e-04
Validation rmse = 0.163491
Validation r2 = 0.758200
Validation mse = 0.026729
Epoch 15
Loss = 1.2306e-01, PNorm = 34.9762, GNorm = 0.8749, lr_0 = 5.6160e-04
Validation rmse = 0.157126
Validation r2 = 0.776663
Validation mse = 0.024688
Epoch 16
Loss = 1.2059e-01, PNorm = 34.9959, GNorm = 1.3292, lr_0 = 5.4548e-04
Loss = 1.1187e-01, PNorm = 35.0130, GNorm = 0.4682, lr_0 = 5.3124e-04
Validation rmse = 0.149127
Validation r2 = 0.798822
Validation mse = 0.022239
Epoch 17
Loss = 1.1306e-01, PNorm = 35.0288, GNorm = 2.8602, lr_0 = 5.1736e-04
Loss = 1.4207e-01, PNorm = 35.0479, GNorm = 1.6607, lr_0 = 5.0385e-04
Validation rmse = 0.150352
Validation r2 = 0.795503
Validation mse = 0.022606
Epoch 18
Loss = 1.3820e-01, PNorm = 35.0644, GNorm = 1.6081, lr_0 = 4.9069e-04
Validation rmse = 0.148484
Validation r2 = 0.800553
Validation mse = 0.022048
Epoch 19
Loss = 1.0192e-01, PNorm = 35.0864, GNorm = 2.5165, lr_0 = 4.7661e-04
Loss = 1.3000e-01, PNorm = 35.1004, GNorm = 1.0853, lr_0 = 4.6416e-04
Validation rmse = 0.149822
Validation r2 = 0.796944
Validation mse = 0.022447
Epoch 20
Loss = 1.0129e-01, PNorm = 35.1201, GNorm = 0.9905, lr_0 = 4.5204e-04
Validation rmse = 0.151767
Validation r2 = 0.791638
Validation mse = 0.023033
Epoch 21
Loss = 8.0562e-02, PNorm = 35.1308, GNorm = 1.4555, lr_0 = 4.3906e-04
Loss = 1.1076e-01, PNorm = 35.1447, GNorm = 3.4265, lr_0 = 4.2760e-04
Validation rmse = 0.151887
Validation r2 = 0.791308
Validation mse = 0.023070
Epoch 22
Loss = 1.0851e-01, PNorm = 35.1578, GNorm = 1.0798, lr_0 = 4.1643e-04
Validation rmse = 0.148786
Validation r2 = 0.799742
Validation mse = 0.022137
Epoch 23
Loss = 9.8356e-02, PNorm = 35.1744, GNorm = 1.9914, lr_0 = 4.0448e-04
Loss = 9.7434e-02, PNorm = 35.1882, GNorm = 0.9110, lr_0 = 3.9391e-04
Validation rmse = 0.150628
Validation r2 = 0.794753
Validation mse = 0.022689
Epoch 24
Loss = 9.8037e-02, PNorm = 35.1974, GNorm = 2.1361, lr_0 = 3.8363e-04
Validation rmse = 0.155524
Validation r2 = 0.781192
Validation mse = 0.024188
Epoch 25
Loss = 6.8499e-02, PNorm = 35.2101, GNorm = 0.8773, lr_0 = 3.7361e-04
Loss = 9.9618e-02, PNorm = 35.2218, GNorm = 3.0963, lr_0 = 3.6385e-04
Validation rmse = 0.150943
Validation r2 = 0.793894
Validation mse = 0.022784
Epoch 26
Loss = 9.1930e-02, PNorm = 35.2361, GNorm = 3.4601, lr_0 = 3.5341e-04
Loss = 9.8368e-02, PNorm = 35.2469, GNorm = 1.5637, lr_0 = 3.4418e-04
Validation rmse = 0.148956
Validation r2 = 0.799283
Validation mse = 0.022188
Epoch 27
Loss = 9.5628e-02, PNorm = 35.2578, GNorm = 0.6961, lr_0 = 3.3519e-04
Validation rmse = 0.148661
Validation r2 = 0.800079
Validation mse = 0.022100
Epoch 28
Loss = 9.2299e-02, PNorm = 35.2699, GNorm = 1.0155, lr_0 = 3.2557e-04
Loss = 8.8345e-02, PNorm = 35.2805, GNorm = 2.0162, lr_0 = 3.1707e-04
Validation rmse = 0.150034
Validation r2 = 0.796368
Validation mse = 0.022510
Epoch 29
Loss = 9.4710e-02, PNorm = 35.2901, GNorm = 1.7316, lr_0 = 3.0878e-04
Validation rmse = 0.151984
Validation r2 = 0.791041
Validation mse = 0.023099
Epoch 30
Loss = 1.0162e-01, PNorm = 35.3004, GNorm = 1.9555, lr_0 = 2.9992e-04
Loss = 9.6180e-02, PNorm = 35.3114, GNorm = 1.4746, lr_0 = 2.9209e-04
Validation rmse = 0.149813
Validation r2 = 0.796967
Validation mse = 0.022444
Epoch 31
Loss = 8.6296e-02, PNorm = 35.3219, GNorm = 0.5241, lr_0 = 2.8446e-04
Validation rmse = 0.153275
Validation r2 = 0.787475
Validation mse = 0.023493
Epoch 32
Loss = 8.7461e-02, PNorm = 35.3302, GNorm = 3.6713, lr_0 = 2.7630e-04
Loss = 9.2020e-02, PNorm = 35.3393, GNorm = 0.8212, lr_0 = 2.6908e-04
Validation rmse = 0.158377
Validation r2 = 0.773091
Validation mse = 0.025083
Epoch 33
Loss = 8.7701e-02, PNorm = 35.3453, GNorm = 0.7412, lr_0 = 2.6205e-04
Validation rmse = 0.149379
Validation r2 = 0.798141
Validation mse = 0.022314
Epoch 34
Loss = 1.1843e-01, PNorm = 35.3541, GNorm = 1.6305, lr_0 = 2.5521e-04
Loss = 8.9933e-02, PNorm = 35.3644, GNorm = 1.5559, lr_0 = 2.4854e-04
Validation rmse = 0.157964
Validation r2 = 0.774274
Validation mse = 0.024953
Epoch 35
Loss = 7.1237e-02, PNorm = 35.3718, GNorm = 0.6832, lr_0 = 2.4141e-04
Loss = 9.4484e-02, PNorm = 35.3804, GNorm = 0.6851, lr_0 = 2.3511e-04
Validation rmse = 0.152216
Validation r2 = 0.790401
Validation mse = 0.023170
Epoch 36
Loss = 9.2444e-02, PNorm = 35.3884, GNorm = 0.7116, lr_0 = 2.2897e-04
Validation rmse = 0.151463
Validation r2 = 0.792472
Validation mse = 0.022941
Epoch 37
Loss = 8.1082e-02, PNorm = 35.3945, GNorm = 0.8461, lr_0 = 2.2240e-04
Loss = 9.1195e-02, PNorm = 35.4041, GNorm = 1.7666, lr_0 = 2.1659e-04
Validation rmse = 0.150757
Validation r2 = 0.794402
Validation mse = 0.022728
Epoch 38
Loss = 7.7418e-02, PNorm = 35.4096, GNorm = 0.7879, lr_0 = 2.1093e-04
Validation rmse = 0.151186
Validation r2 = 0.793230
Validation mse = 0.022857
Epoch 39
Loss = 7.6424e-02, PNorm = 35.4176, GNorm = 0.9464, lr_0 = 2.0488e-04
Loss = 9.4601e-02, PNorm = 35.4243, GNorm = 0.8531, lr_0 = 1.9953e-04
Validation rmse = 0.158883
Validation r2 = 0.771640
Validation mse = 0.025244
Epoch 40
Loss = 8.2616e-02, PNorm = 35.4296, GNorm = 0.9529, lr_0 = 1.9431e-04
Validation rmse = 0.150036
Validation r2 = 0.796363
Validation mse = 0.022511
Epoch 41
Loss = 7.7443e-02, PNorm = 35.4372, GNorm = 0.8850, lr_0 = 1.8874e-04
Loss = 8.4713e-02, PNorm = 35.4434, GNorm = 2.1482, lr_0 = 1.8381e-04
Validation rmse = 0.151013
Validation r2 = 0.793701
Validation mse = 0.022805
Epoch 42
Loss = 8.3207e-02, PNorm = 35.4489, GNorm = 0.6256, lr_0 = 1.7901e-04
Validation rmse = 0.149724
Validation r2 = 0.797210
Validation mse = 0.022417
Epoch 43
Loss = 9.0735e-02, PNorm = 35.4546, GNorm = 1.1829, lr_0 = 1.7433e-04
Loss = 7.0610e-02, PNorm = 35.4597, GNorm = 2.3769, lr_0 = 1.6978e-04
Validation rmse = 0.154407
Validation r2 = 0.784325
Validation mse = 0.023841
Epoch 44
Loss = 8.6311e-02, PNorm = 35.4651, GNorm = 0.9539, lr_0 = 1.6491e-04
Loss = 7.7180e-02, PNorm = 35.4709, GNorm = 0.8028, lr_0 = 1.6060e-04
Validation rmse = 0.148939
Validation r2 = 0.799330
Validation mse = 0.022183
Epoch 45
Loss = 7.3956e-02, PNorm = 35.4772, GNorm = 2.6371, lr_0 = 1.5641e-04
Validation rmse = 0.154586
Validation r2 = 0.783823
Validation mse = 0.023897
Epoch 46
Loss = 9.7093e-02, PNorm = 35.4816, GNorm = 0.8407, lr_0 = 1.5192e-04
Loss = 6.8880e-02, PNorm = 35.4862, GNorm = 0.7318, lr_0 = 1.4795e-04
Validation rmse = 0.151094
Validation r2 = 0.793479
Validation mse = 0.022830
Epoch 47
Loss = 7.7365e-02, PNorm = 35.4904, GNorm = 1.9085, lr_0 = 1.4409e-04
Validation rmse = 0.151567
Validation r2 = 0.792186
Validation mse = 0.022972
Epoch 48
Loss = 6.6713e-02, PNorm = 35.4961, GNorm = 0.8471, lr_0 = 1.3995e-04
Loss = 7.7911e-02, PNorm = 35.5016, GNorm = 0.4734, lr_0 = 1.3630e-04
Validation rmse = 0.157915
Validation r2 = 0.774413
Validation mse = 0.024937
Epoch 49
Loss = 8.3746e-02, PNorm = 35.5044, GNorm = 1.4859, lr_0 = 1.3274e-04
Validation rmse = 0.151504
Validation r2 = 0.792359
Validation mse = 0.022953
Epoch 50
Loss = 4.3314e-02, PNorm = 35.5085, GNorm = 0.7604, lr_0 = 1.2927e-04
Loss = 8.7485e-02, PNorm = 35.5124, GNorm = 0.7532, lr_0 = 1.2589e-04
Validation rmse = 0.152908
Validation r2 = 0.788491
Validation mse = 0.023381
Epoch 51
Loss = 5.9877e-02, PNorm = 35.5172, GNorm = 1.3072, lr_0 = 1.2228e-04
Validation rmse = 0.152268
Validation r2 = 0.790260
Validation mse = 0.023185
Epoch 52
Loss = 6.0570e-02, PNorm = 35.5206, GNorm = 1.0266, lr_0 = 1.1909e-04
Loss = 8.4014e-02, PNorm = 35.5251, GNorm = 0.7888, lr_0 = 1.1598e-04
Validation rmse = 0.150270
Validation r2 = 0.795727
Validation mse = 0.022581
Epoch 53
Loss = 6.9498e-02, PNorm = 35.5288, GNorm = 2.9129, lr_0 = 1.1265e-04
Loss = 8.2108e-02, PNorm = 35.5328, GNorm = 1.7105, lr_0 = 1.0971e-04
Validation rmse = 0.152290
Validation r2 = 0.790197
Validation mse = 0.023192
Epoch 54
Loss = 7.4173e-02, PNorm = 35.5366, GNorm = 2.3487, lr_0 = 1.0684e-04
Validation rmse = 0.155956
Validation r2 = 0.779974
Validation mse = 0.024322
Epoch 55
Loss = 9.1790e-02, PNorm = 35.5403, GNorm = 1.5675, lr_0 = 1.0377e-04
Loss = 6.9466e-02, PNorm = 35.5439, GNorm = 1.3856, lr_0 = 1.0106e-04
Validation rmse = 0.151140
Validation r2 = 0.793355
Validation mse = 0.022843
Epoch 56
Loss = 6.5031e-02, PNorm = 35.5457, GNorm = 0.7269, lr_0 = 1.0000e-04
Validation rmse = 0.150555
Validation r2 = 0.794950
Validation mse = 0.022667
Epoch 57
Loss = 7.8361e-02, PNorm = 35.5496, GNorm = 0.7905, lr_0 = 1.0000e-04
Loss = 7.6646e-02, PNorm = 35.5529, GNorm = 1.6584, lr_0 = 1.0000e-04
Validation rmse = 0.154408
Validation r2 = 0.784323
Validation mse = 0.023842
Epoch 58
Loss = 7.3213e-02, PNorm = 35.5558, GNorm = 0.8361, lr_0 = 1.0000e-04
Validation rmse = 0.149535
Validation r2 = 0.797719
Validation mse = 0.022361
Epoch 59
Loss = 1.2115e-01, PNorm = 35.5592, GNorm = 1.2240, lr_0 = 1.0000e-04
Loss = 6.9568e-02, PNorm = 35.5628, GNorm = 0.8582, lr_0 = 1.0000e-04
Validation rmse = 0.155077
Validation r2 = 0.782450
Validation mse = 0.024049
Model 0 best validation rmse = 0.148484 on epoch 18
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.611327
Model 0 test r2 = -103.398420
Model 0 test mse = 0.373720
Ensemble test rmse = 0.611327
Ensemble test r2 = -103.398420
Ensemble test mse = 0.373720
Fold 6
Splitting data with seed 6
Total size = 973 | train size = 778 | val size = 195 | test size = 49
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.0348e-01, PNorm = 34.0174, GNorm = 2.2573, lr_0 = 4.3000e-04
Validation rmse = 0.273105
Validation r2 = 0.258719
Validation mse = 0.074587
Epoch 1
Loss = 6.5310e-01, PNorm = 34.0507, GNorm = 4.8869, lr_0 = 7.6000e-04
Loss = 6.9260e-01, PNorm = 34.1022, GNorm = 4.3726, lr_0 = 9.9472e-04
Validation rmse = 0.234300
Validation r2 = 0.454411
Validation mse = 0.054896
Epoch 2
Loss = 5.0140e-01, PNorm = 34.1853, GNorm = 7.0808, lr_0 = 9.6874e-04
Validation rmse = 0.250802
Validation r2 = 0.374851
Validation mse = 0.062902
Epoch 3
Loss = 4.6270e-01, PNorm = 34.2630, GNorm = 7.8816, lr_0 = 9.4094e-04
Loss = 4.1478e-01, PNorm = 34.3266, GNorm = 2.4623, lr_0 = 9.1637e-04
Validation rmse = 0.205594
Validation r2 = 0.579910
Validation mse = 0.042269
Epoch 4
Loss = 3.3705e-01, PNorm = 34.3841, GNorm = 6.4758, lr_0 = 8.9243e-04
Validation rmse = 0.181072
Validation r2 = 0.674143
Validation mse = 0.032787
Epoch 5
Loss = 2.5401e-01, PNorm = 34.4439, GNorm = 5.4276, lr_0 = 8.6682e-04
Loss = 2.7545e-01, PNorm = 34.4947, GNorm = 4.3027, lr_0 = 8.4418e-04
Validation rmse = 0.166930
Validation r2 = 0.723056
Validation mse = 0.027866
Epoch 6
Loss = 2.2649e-01, PNorm = 34.5380, GNorm = 4.1501, lr_0 = 8.2213e-04
Validation rmse = 0.200403
Validation r2 = 0.600853
Validation mse = 0.040162
Epoch 7
Loss = 2.9867e-01, PNorm = 34.5890, GNorm = 5.9613, lr_0 = 7.9854e-04
Loss = 2.6896e-01, PNorm = 34.6278, GNorm = 1.2280, lr_0 = 7.7769e-04
Validation rmse = 0.165665
Validation r2 = 0.727238
Validation mse = 0.027445
Epoch 8
Loss = 1.9849e-01, PNorm = 34.6693, GNorm = 0.5908, lr_0 = 7.5737e-04
Loss = 1.8837e-01, PNorm = 34.7016, GNorm = 1.5475, lr_0 = 7.3759e-04
Validation rmse = 0.154915
Validation r2 = 0.761488
Validation mse = 0.023999
Epoch 9
Loss = 1.8383e-01, PNorm = 34.7367, GNorm = 1.3143, lr_0 = 7.1833e-04
Validation rmse = 0.154506
Validation r2 = 0.762747
Validation mse = 0.023872
Epoch 10
Loss = 1.5618e-01, PNorm = 34.7651, GNorm = 0.5302, lr_0 = 6.9772e-04
Loss = 1.5902e-01, PNorm = 34.7938, GNorm = 0.8263, lr_0 = 6.7949e-04
Validation rmse = 0.158458
Validation r2 = 0.750455
Validation mse = 0.025109
Epoch 11
Loss = 1.6103e-01, PNorm = 34.8204, GNorm = 1.0851, lr_0 = 6.6174e-04
Validation rmse = 0.155200
Validation r2 = 0.760610
Validation mse = 0.024087
Epoch 12
Loss = 1.3157e-01, PNorm = 34.8384, GNorm = 3.3249, lr_0 = 6.4276e-04
Loss = 1.6070e-01, PNorm = 34.8578, GNorm = 1.0215, lr_0 = 6.2597e-04
Validation rmse = 0.144808
Validation r2 = 0.791596
Validation mse = 0.020969
Epoch 13
Loss = 1.3388e-01, PNorm = 34.8785, GNorm = 2.8328, lr_0 = 6.0962e-04
Validation rmse = 0.150904
Validation r2 = 0.773678
Validation mse = 0.022772
Epoch 14
Loss = 1.3085e-01, PNorm = 34.9008, GNorm = 0.7291, lr_0 = 5.9213e-04
Loss = 1.4413e-01, PNorm = 34.9199, GNorm = 4.1993, lr_0 = 5.7666e-04
Validation rmse = 0.145625
Validation r2 = 0.789239
Validation mse = 0.021207
Epoch 15
Loss = 1.3981e-01, PNorm = 34.9359, GNorm = 1.1177, lr_0 = 5.6160e-04
Validation rmse = 0.146833
Validation r2 = 0.785726
Validation mse = 0.021560
Epoch 16
Loss = 1.5917e-01, PNorm = 34.9536, GNorm = 5.1648, lr_0 = 5.4548e-04
Loss = 1.4908e-01, PNorm = 34.9734, GNorm = 4.0566, lr_0 = 5.3124e-04
Validation rmse = 0.159626
Validation r2 = 0.746760
Validation mse = 0.025481
Epoch 17
Loss = 1.5313e-01, PNorm = 34.9923, GNorm = 3.5767, lr_0 = 5.1736e-04
Loss = 1.1600e-01, PNorm = 35.0100, GNorm = 0.7893, lr_0 = 5.0385e-04
Validation rmse = 0.144714
Validation r2 = 0.791867
Validation mse = 0.020942
Epoch 18
Loss = 1.1698e-01, PNorm = 35.0259, GNorm = 2.0116, lr_0 = 4.9069e-04
Validation rmse = 0.141707
Validation r2 = 0.800425
Validation mse = 0.020081
Epoch 19
Loss = 1.3560e-01, PNorm = 35.0438, GNorm = 0.5203, lr_0 = 4.7661e-04
Loss = 1.1453e-01, PNorm = 35.0562, GNorm = 1.0888, lr_0 = 4.6416e-04
Validation rmse = 0.142384
Validation r2 = 0.798514
Validation mse = 0.020273
Epoch 20
Loss = 1.1700e-01, PNorm = 35.0686, GNorm = 2.7785, lr_0 = 4.5204e-04
Validation rmse = 0.142928
Validation r2 = 0.796971
Validation mse = 0.020428
Epoch 21
Loss = 1.2437e-01, PNorm = 35.0834, GNorm = 3.2916, lr_0 = 4.3906e-04
Loss = 1.2401e-01, PNorm = 35.0952, GNorm = 1.6756, lr_0 = 4.2760e-04
Validation rmse = 0.141662
Validation r2 = 0.800553
Validation mse = 0.020068
Epoch 22
Loss = 9.8845e-02, PNorm = 35.1117, GNorm = 0.8718, lr_0 = 4.1643e-04
Validation rmse = 0.140982
Validation r2 = 0.802462
Validation mse = 0.019876
Epoch 23
Loss = 9.6307e-02, PNorm = 35.1267, GNorm = 0.8330, lr_0 = 4.0448e-04
Loss = 1.1504e-01, PNorm = 35.1384, GNorm = 4.1557, lr_0 = 3.9391e-04
Validation rmse = 0.142862
Validation r2 = 0.797160
Validation mse = 0.020409
Epoch 24
Loss = 1.1110e-01, PNorm = 35.1502, GNorm = 0.6524, lr_0 = 3.8363e-04
Validation rmse = 0.144859
Validation r2 = 0.791448
Validation mse = 0.020984
Epoch 25
Loss = 1.3107e-01, PNorm = 35.1648, GNorm = 2.4819, lr_0 = 3.7361e-04
Loss = 9.9698e-02, PNorm = 35.1795, GNorm = 0.5409, lr_0 = 3.6385e-04
Validation rmse = 0.141888
Validation r2 = 0.799917
Validation mse = 0.020132
Epoch 26
Loss = 8.2649e-02, PNorm = 35.1910, GNorm = 0.7471, lr_0 = 3.5341e-04
Loss = 1.1653e-01, PNorm = 35.2012, GNorm = 1.0782, lr_0 = 3.4418e-04
Validation rmse = 0.142277
Validation r2 = 0.798817
Validation mse = 0.020243
Epoch 27
Loss = 1.0351e-01, PNorm = 35.2106, GNorm = 0.9458, lr_0 = 3.3519e-04
Validation rmse = 0.141089
Validation r2 = 0.802162
Validation mse = 0.019906
Epoch 28
Loss = 1.0617e-01, PNorm = 35.2242, GNorm = 1.1978, lr_0 = 3.2557e-04
Loss = 1.0895e-01, PNorm = 35.2355, GNorm = 6.0211, lr_0 = 3.1707e-04
Validation rmse = 0.140926
Validation r2 = 0.802619
Validation mse = 0.019860
Epoch 29
Loss = 9.5161e-02, PNorm = 35.2467, GNorm = 3.0012, lr_0 = 3.0878e-04
Validation rmse = 0.142156
Validation r2 = 0.799159
Validation mse = 0.020208
Epoch 30
Loss = 1.1104e-01, PNorm = 35.2574, GNorm = 1.1202, lr_0 = 2.9992e-04
Loss = 1.0895e-01, PNorm = 35.2676, GNorm = 4.5313, lr_0 = 2.9209e-04
Validation rmse = 0.143191
Validation r2 = 0.796223
Validation mse = 0.020504
Epoch 31
Loss = 1.0257e-01, PNorm = 35.2768, GNorm = 2.1265, lr_0 = 2.8446e-04
Validation rmse = 0.141308
Validation r2 = 0.801547
Validation mse = 0.019968
Epoch 32
Loss = 1.0052e-01, PNorm = 35.2875, GNorm = 0.6344, lr_0 = 2.7630e-04
Loss = 9.4229e-02, PNorm = 35.2955, GNorm = 2.7040, lr_0 = 2.6908e-04
Validation rmse = 0.140550
Validation r2 = 0.803673
Validation mse = 0.019754
Epoch 33
Loss = 9.7385e-02, PNorm = 35.3055, GNorm = 0.6149, lr_0 = 2.6205e-04
Validation rmse = 0.140572
Validation r2 = 0.803610
Validation mse = 0.019760
Epoch 34
Loss = 7.7931e-02, PNorm = 35.3135, GNorm = 0.4334, lr_0 = 2.5521e-04
Loss = 1.0448e-01, PNorm = 35.3217, GNorm = 0.7669, lr_0 = 2.4854e-04
Validation rmse = 0.140232
Validation r2 = 0.804559
Validation mse = 0.019665
Epoch 35
Loss = 1.0333e-01, PNorm = 35.3305, GNorm = 2.2795, lr_0 = 2.4141e-04
Loss = 9.4997e-02, PNorm = 35.3394, GNorm = 2.7502, lr_0 = 2.3511e-04
Validation rmse = 0.145011
Validation r2 = 0.791011
Validation mse = 0.021028
Epoch 36
Loss = 9.7669e-02, PNorm = 35.3477, GNorm = 3.4355, lr_0 = 2.2897e-04
Validation rmse = 0.139332
Validation r2 = 0.807060
Validation mse = 0.019413
Epoch 37
Loss = 8.5073e-02, PNorm = 35.3546, GNorm = 1.0840, lr_0 = 2.2240e-04
Loss = 1.0295e-01, PNorm = 35.3630, GNorm = 1.7277, lr_0 = 2.1659e-04
Validation rmse = 0.141586
Validation r2 = 0.800768
Validation mse = 0.020046
Epoch 38
Loss = 8.8931e-02, PNorm = 35.3684, GNorm = 1.4153, lr_0 = 2.1093e-04
Validation rmse = 0.144756
Validation r2 = 0.791745
Validation mse = 0.020954
Epoch 39
Loss = 9.2330e-02, PNorm = 35.3766, GNorm = 1.7941, lr_0 = 2.0488e-04
Loss = 9.2388e-02, PNorm = 35.3824, GNorm = 1.6530, lr_0 = 1.9953e-04
Validation rmse = 0.139529
Validation r2 = 0.806512
Validation mse = 0.019468
Epoch 40
Loss = 9.0455e-02, PNorm = 35.3891, GNorm = 2.5592, lr_0 = 1.9431e-04
Validation rmse = 0.141262
Validation r2 = 0.801676
Validation mse = 0.019955
Epoch 41
Loss = 1.0180e-01, PNorm = 35.3968, GNorm = 1.9358, lr_0 = 1.8874e-04
Loss = 9.4479e-02, PNorm = 35.4029, GNorm = 0.8001, lr_0 = 1.8381e-04
Validation rmse = 0.139044
Validation r2 = 0.807857
Validation mse = 0.019333
Epoch 42
Loss = 9.4437e-02, PNorm = 35.4089, GNorm = 0.7495, lr_0 = 1.7901e-04
Validation rmse = 0.144277
Validation r2 = 0.793121
Validation mse = 0.020816
Epoch 43
Loss = 1.1320e-01, PNorm = 35.4147, GNorm = 2.1267, lr_0 = 1.7433e-04
Loss = 8.8202e-02, PNorm = 35.4199, GNorm = 0.8092, lr_0 = 1.6978e-04
Validation rmse = 0.140946
Validation r2 = 0.802563
Validation mse = 0.019866
Epoch 44
Loss = 8.4871e-02, PNorm = 35.4263, GNorm = 0.4918, lr_0 = 1.6491e-04
Loss = 9.0358e-02, PNorm = 35.4316, GNorm = 0.7712, lr_0 = 1.6060e-04
Validation rmse = 0.139028
Validation r2 = 0.807901
Validation mse = 0.019329
Epoch 45
Loss = 8.7297e-02, PNorm = 35.4367, GNorm = 1.9078, lr_0 = 1.5641e-04
Validation rmse = 0.139883
Validation r2 = 0.805531
Validation mse = 0.019567
Epoch 46
Loss = 8.4059e-02, PNorm = 35.4409, GNorm = 1.5386, lr_0 = 1.5192e-04
Loss = 8.8340e-02, PNorm = 35.4464, GNorm = 0.5243, lr_0 = 1.4795e-04
Validation rmse = 0.140842
Validation r2 = 0.802855
Validation mse = 0.019836
Epoch 47
Loss = 9.8665e-02, PNorm = 35.4510, GNorm = 1.7563, lr_0 = 1.4409e-04
Validation rmse = 0.139986
Validation r2 = 0.805243
Validation mse = 0.019596
Epoch 48
Loss = 9.6926e-02, PNorm = 35.4555, GNorm = 0.7041, lr_0 = 1.3995e-04
Loss = 8.6151e-02, PNorm = 35.4595, GNorm = 1.0402, lr_0 = 1.3630e-04
Validation rmse = 0.143697
Validation r2 = 0.794780
Validation mse = 0.020649
Epoch 49
Loss = 9.2765e-02, PNorm = 35.4647, GNorm = 0.8431, lr_0 = 1.3274e-04
Validation rmse = 0.139626
Validation r2 = 0.806244
Validation mse = 0.019495
Epoch 50
Loss = 9.5822e-02, PNorm = 35.4687, GNorm = 1.8408, lr_0 = 1.2927e-04
Loss = 8.2043e-02, PNorm = 35.4732, GNorm = 1.0374, lr_0 = 1.2589e-04
Validation rmse = 0.139027
Validation r2 = 0.807903
Validation mse = 0.019329
Epoch 51
Loss = 8.2335e-02, PNorm = 35.4774, GNorm = 1.1620, lr_0 = 1.2228e-04
Validation rmse = 0.140557
Validation r2 = 0.803653
Validation mse = 0.019756
Epoch 52
Loss = 6.7549e-02, PNorm = 35.4805, GNorm = 0.7641, lr_0 = 1.1909e-04
Loss = 8.1382e-02, PNorm = 35.4837, GNorm = 0.8552, lr_0 = 1.1598e-04
Validation rmse = 0.140269
Validation r2 = 0.804456
Validation mse = 0.019675
Epoch 53
Loss = 8.3126e-02, PNorm = 35.4887, GNorm = 1.5214, lr_0 = 1.1265e-04
Loss = 8.6712e-02, PNorm = 35.4926, GNorm = 2.4264, lr_0 = 1.0971e-04
Validation rmse = 0.141120
Validation r2 = 0.802077
Validation mse = 0.019915
Epoch 54
Loss = 8.6451e-02, PNorm = 35.4963, GNorm = 1.0903, lr_0 = 1.0684e-04
Validation rmse = 0.140596
Validation r2 = 0.803543
Validation mse = 0.019767
Epoch 55
Loss = 9.1337e-02, PNorm = 35.4996, GNorm = 1.1084, lr_0 = 1.0377e-04
Loss = 8.0896e-02, PNorm = 35.5034, GNorm = 0.8305, lr_0 = 1.0106e-04
Validation rmse = 0.139980
Validation r2 = 0.805261
Validation mse = 0.019594
Epoch 56
Loss = 6.8092e-02, PNorm = 35.5068, GNorm = 0.8060, lr_0 = 1.0000e-04
Validation rmse = 0.139774
Validation r2 = 0.805833
Validation mse = 0.019537
Epoch 57
Loss = 6.8125e-02, PNorm = 35.5095, GNorm = 1.5857, lr_0 = 1.0000e-04
Loss = 9.0266e-02, PNorm = 35.5131, GNorm = 0.7689, lr_0 = 1.0000e-04
Validation rmse = 0.139888
Validation r2 = 0.805517
Validation mse = 0.019569
Epoch 58
Loss = 7.4586e-02, PNorm = 35.5162, GNorm = 0.5652, lr_0 = 1.0000e-04
Validation rmse = 0.139186
Validation r2 = 0.807464
Validation mse = 0.019373
Epoch 59
Loss = 9.8694e-02, PNorm = 35.5193, GNorm = 2.0597, lr_0 = 1.0000e-04
Loss = 8.6855e-02, PNorm = 35.5233, GNorm = 0.9823, lr_0 = 1.0000e-04
Validation rmse = 0.138874
Validation r2 = 0.808325
Validation mse = 0.019286
Model 0 best validation rmse = 0.138874 on epoch 59
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.647790
Model 0 test r2 = -116.223809
Model 0 test mse = 0.419632
Ensemble test rmse = 0.647790
Ensemble test r2 = -116.223809
Ensemble test mse = 0.419632
Fold 7
Splitting data with seed 7
Total size = 973 | train size = 778 | val size = 195 | test size = 49
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.4376e-01, PNorm = 34.0177, GNorm = 2.2954, lr_0 = 4.3000e-04
Validation rmse = 0.273638
Validation r2 = 0.286072
Validation mse = 0.074878
Epoch 1
Loss = 8.2102e-01, PNorm = 34.0453, GNorm = 6.9121, lr_0 = 7.6000e-04
Loss = 6.4685e-01, PNorm = 34.0975, GNorm = 9.5588, lr_0 = 9.9472e-04
Validation rmse = 0.249766
Validation r2 = 0.405202
Validation mse = 0.062383
Epoch 2
Loss = 5.1274e-01, PNorm = 34.1789, GNorm = 1.4092, lr_0 = 9.6874e-04
Validation rmse = 0.212007
Validation r2 = 0.571447
Validation mse = 0.044947
Epoch 3
Loss = 3.8997e-01, PNorm = 34.2580, GNorm = 7.8067, lr_0 = 9.4094e-04
Loss = 3.9658e-01, PNorm = 34.3260, GNorm = 5.5140, lr_0 = 9.1637e-04
Validation rmse = 0.208251
Validation r2 = 0.586498
Validation mse = 0.043369
Epoch 4
Loss = 3.6240e-01, PNorm = 34.3877, GNorm = 3.8670, lr_0 = 8.9243e-04
Validation rmse = 0.190177
Validation r2 = 0.655159
Validation mse = 0.036167
Epoch 5
Loss = 2.8649e-01, PNorm = 34.4426, GNorm = 1.7768, lr_0 = 8.6682e-04
Loss = 2.1983e-01, PNorm = 34.4871, GNorm = 0.9137, lr_0 = 8.4418e-04
Validation rmse = 0.168587
Validation r2 = 0.729013
Validation mse = 0.028421
Epoch 6
Loss = 2.1534e-01, PNorm = 34.5364, GNorm = 0.8661, lr_0 = 8.2213e-04
Validation rmse = 0.158477
Validation r2 = 0.760540
Validation mse = 0.025115
Epoch 7
Loss = 1.7880e-01, PNorm = 34.5791, GNorm = 1.8148, lr_0 = 7.9854e-04
Loss = 2.0548e-01, PNorm = 34.6105, GNorm = 10.6556, lr_0 = 7.7769e-04
Validation rmse = 0.152576
Validation r2 = 0.778041
Validation mse = 0.023279
Epoch 8
Loss = 1.6156e-01, PNorm = 34.6499, GNorm = 0.9827, lr_0 = 7.5737e-04
Loss = 2.1789e-01, PNorm = 34.6784, GNorm = 7.7671, lr_0 = 7.3759e-04
Validation rmse = 0.147799
Validation r2 = 0.791720
Validation mse = 0.021845
Epoch 9
Loss = 1.6729e-01, PNorm = 34.7056, GNorm = 1.0723, lr_0 = 7.1833e-04
Validation rmse = 0.148936
Validation r2 = 0.788505
Validation mse = 0.022182
Epoch 10
Loss = 1.7274e-01, PNorm = 34.7377, GNorm = 0.9167, lr_0 = 6.9772e-04
Loss = 1.5950e-01, PNorm = 34.7618, GNorm = 2.6571, lr_0 = 6.7949e-04
Validation rmse = 0.147571
Validation r2 = 0.792362
Validation mse = 0.021777
Epoch 11
Loss = 1.3205e-01, PNorm = 34.7862, GNorm = 2.4157, lr_0 = 6.6174e-04
Validation rmse = 0.142320
Validation r2 = 0.806877
Validation mse = 0.020255
Epoch 12
Loss = 1.4561e-01, PNorm = 34.8063, GNorm = 2.6826, lr_0 = 6.4276e-04
Loss = 1.4281e-01, PNorm = 34.8215, GNorm = 2.5587, lr_0 = 6.2597e-04
Validation rmse = 0.143555
Validation r2 = 0.803511
Validation mse = 0.020608
Epoch 13
Loss = 1.3777e-01, PNorm = 34.8374, GNorm = 1.0702, lr_0 = 6.0962e-04
Validation rmse = 0.154368
Validation r2 = 0.772796
Validation mse = 0.023829
Epoch 14
Loss = 1.3599e-01, PNorm = 34.8618, GNorm = 0.5959, lr_0 = 5.9213e-04
Loss = 1.4272e-01, PNorm = 34.8798, GNorm = 1.0466, lr_0 = 5.7666e-04
Validation rmse = 0.141413
Validation r2 = 0.809330
Validation mse = 0.019998
Epoch 15
Loss = 1.1673e-01, PNorm = 34.8962, GNorm = 3.4315, lr_0 = 5.6160e-04
Validation rmse = 0.143373
Validation r2 = 0.804009
Validation mse = 0.020556
Epoch 16
Loss = 1.2433e-01, PNorm = 34.9117, GNorm = 1.5690, lr_0 = 5.4548e-04
Loss = 1.2986e-01, PNorm = 34.9247, GNorm = 1.9879, lr_0 = 5.3124e-04
Validation rmse = 0.142939
Validation r2 = 0.805195
Validation mse = 0.020431
Epoch 17
Loss = 1.0399e-01, PNorm = 34.9418, GNorm = 0.8918, lr_0 = 5.1736e-04
Loss = 1.4310e-01, PNorm = 34.9564, GNorm = 3.2204, lr_0 = 5.0385e-04
Validation rmse = 0.159642
Validation r2 = 0.757006
Validation mse = 0.025485
Epoch 18
Loss = 1.3174e-01, PNorm = 34.9674, GNorm = 1.8181, lr_0 = 4.9069e-04
Validation rmse = 0.140884
Validation r2 = 0.810756
Validation mse = 0.019848
Epoch 19
Loss = 1.2852e-01, PNorm = 34.9886, GNorm = 3.7821, lr_0 = 4.7661e-04
Loss = 1.2936e-01, PNorm = 35.0047, GNorm = 2.8566, lr_0 = 4.6416e-04
Validation rmse = 0.146607
Validation r2 = 0.795068
Validation mse = 0.021494
Epoch 20
Loss = 1.1739e-01, PNorm = 35.0155, GNorm = 3.4186, lr_0 = 4.5204e-04
Validation rmse = 0.151671
Validation r2 = 0.780664
Validation mse = 0.023004
Epoch 21
Loss = 1.4218e-01, PNorm = 35.0273, GNorm = 6.6598, lr_0 = 4.3906e-04
Loss = 1.2963e-01, PNorm = 35.0365, GNorm = 2.4181, lr_0 = 4.2760e-04
Validation rmse = 0.138035
Validation r2 = 0.818332
Validation mse = 0.019054
Epoch 22
Loss = 1.2937e-01, PNorm = 35.0510, GNorm = 1.6996, lr_0 = 4.1643e-04
Validation rmse = 0.145977
Validation r2 = 0.796826
Validation mse = 0.021309
Epoch 23
Loss = 1.1039e-01, PNorm = 35.0631, GNorm = 0.6161, lr_0 = 4.0448e-04
Loss = 1.1642e-01, PNorm = 35.0712, GNorm = 1.1854, lr_0 = 3.9391e-04
Validation rmse = 0.136970
Validation r2 = 0.821124
Validation mse = 0.018761
Epoch 24
Loss = 1.1236e-01, PNorm = 35.0814, GNorm = 0.6166, lr_0 = 3.8363e-04
Validation rmse = 0.140953
Validation r2 = 0.810570
Validation mse = 0.019868
Epoch 25
Loss = 7.9622e-02, PNorm = 35.0933, GNorm = 1.3091, lr_0 = 3.7361e-04
Loss = 1.2032e-01, PNorm = 35.1043, GNorm = 3.3496, lr_0 = 3.6385e-04
Validation rmse = 0.139233
Validation r2 = 0.815164
Validation mse = 0.019386
Epoch 26
Loss = 9.0389e-02, PNorm = 35.1135, GNorm = 0.7895, lr_0 = 3.5341e-04
Loss = 1.3576e-01, PNorm = 35.1230, GNorm = 1.6673, lr_0 = 3.4418e-04
Validation rmse = 0.147387
Validation r2 = 0.792881
Validation mse = 0.021723
Epoch 27
Loss = 1.2592e-01, PNorm = 35.1331, GNorm = 4.4332, lr_0 = 3.3519e-04
Validation rmse = 0.137469
Validation r2 = 0.819818
Validation mse = 0.018898
Epoch 28
Loss = 1.0558e-01, PNorm = 35.1442, GNorm = 0.9814, lr_0 = 3.2557e-04
Loss = 9.7265e-02, PNorm = 35.1547, GNorm = 1.0626, lr_0 = 3.1707e-04
Validation rmse = 0.138573
Validation r2 = 0.816912
Validation mse = 0.019202
Epoch 29
Loss = 9.1223e-02, PNorm = 35.1625, GNorm = 0.8710, lr_0 = 3.0878e-04
Validation rmse = 0.141617
Validation r2 = 0.808781
Validation mse = 0.020055
Epoch 30
Loss = 1.0663e-01, PNorm = 35.1710, GNorm = 2.2433, lr_0 = 2.9992e-04
Loss = 1.0575e-01, PNorm = 35.1793, GNorm = 5.1754, lr_0 = 2.9209e-04
Validation rmse = 0.153002
Validation r2 = 0.776799
Validation mse = 0.023410
Epoch 31
Loss = 1.0370e-01, PNorm = 35.1903, GNorm = 2.9115, lr_0 = 2.8446e-04
Validation rmse = 0.141977
Validation r2 = 0.807807
Validation mse = 0.020157
Epoch 32
Loss = 8.8774e-02, PNorm = 35.1989, GNorm = 0.8800, lr_0 = 2.7630e-04
Loss = 1.1191e-01, PNorm = 35.2054, GNorm = 0.8325, lr_0 = 2.6908e-04
Validation rmse = 0.136159
Validation r2 = 0.823236
Validation mse = 0.018539
Epoch 33
Loss = 1.0222e-01, PNorm = 35.2121, GNorm = 0.6006, lr_0 = 2.6205e-04
Validation rmse = 0.142974
Validation r2 = 0.805097
Validation mse = 0.020442
Epoch 34
Loss = 5.4455e-02, PNorm = 35.2189, GNorm = 1.9287, lr_0 = 2.5521e-04
Loss = 1.0124e-01, PNorm = 35.2253, GNorm = 4.0286, lr_0 = 2.4854e-04
Validation rmse = 0.138276
Validation r2 = 0.817697
Validation mse = 0.019120
Epoch 35
Loss = 9.3857e-02, PNorm = 35.2340, GNorm = 1.3182, lr_0 = 2.4141e-04
Loss = 9.5183e-02, PNorm = 35.2397, GNorm = 1.6394, lr_0 = 2.3511e-04
Validation rmse = 0.136999
Validation r2 = 0.821048
Validation mse = 0.018769
Epoch 36
Loss = 1.0291e-01, PNorm = 35.2433, GNorm = 1.5130, lr_0 = 2.2897e-04
Validation rmse = 0.138310
Validation r2 = 0.817607
Validation mse = 0.019130
Epoch 37
Loss = 9.3344e-02, PNorm = 35.2529, GNorm = 0.7647, lr_0 = 2.2240e-04
Loss = 1.0668e-01, PNorm = 35.2586, GNorm = 2.1358, lr_0 = 2.1659e-04
Validation rmse = 0.137923
Validation r2 = 0.818627
Validation mse = 0.019023
Epoch 38
Loss = 9.4713e-02, PNorm = 35.2640, GNorm = 2.3336, lr_0 = 2.1093e-04
Validation rmse = 0.135959
Validation r2 = 0.823754
Validation mse = 0.018485
Epoch 39
Loss = 7.7626e-02, PNorm = 35.2699, GNorm = 1.5030, lr_0 = 2.0488e-04
Loss = 1.0061e-01, PNorm = 35.2746, GNorm = 1.5097, lr_0 = 1.9953e-04
Validation rmse = 0.137471
Validation r2 = 0.819812
Validation mse = 0.018898
Epoch 40
Loss = 9.2891e-02, PNorm = 35.2810, GNorm = 2.0995, lr_0 = 1.9431e-04
Validation rmse = 0.140308
Validation r2 = 0.812298
Validation mse = 0.019686
Epoch 41
Loss = 1.0024e-01, PNorm = 35.2881, GNorm = 3.4638, lr_0 = 1.8874e-04
Loss = 9.1643e-02, PNorm = 35.2935, GNorm = 2.8926, lr_0 = 1.8381e-04
Validation rmse = 0.137102
Validation r2 = 0.820780
Validation mse = 0.018797
Epoch 42
Loss = 8.1238e-02, PNorm = 35.2989, GNorm = 2.9395, lr_0 = 1.7901e-04
Validation rmse = 0.138988
Validation r2 = 0.815813
Validation mse = 0.019318
Epoch 43
Loss = 8.8606e-02, PNorm = 35.3047, GNorm = 2.2200, lr_0 = 1.7433e-04
Loss = 9.0811e-02, PNorm = 35.3098, GNorm = 1.1309, lr_0 = 1.6978e-04
Validation rmse = 0.138377
Validation r2 = 0.817430
Validation mse = 0.019148
Epoch 44
Loss = 8.5707e-02, PNorm = 35.3152, GNorm = 1.0848, lr_0 = 1.6491e-04
Loss = 9.2839e-02, PNorm = 35.3197, GNorm = 1.7303, lr_0 = 1.6060e-04
Validation rmse = 0.137422
Validation r2 = 0.819941
Validation mse = 0.018885
Epoch 45
Loss = 8.4544e-02, PNorm = 35.3251, GNorm = 2.3679, lr_0 = 1.5641e-04
Validation rmse = 0.140040
Validation r2 = 0.813014
Validation mse = 0.019611
Epoch 46
Loss = 9.0595e-02, PNorm = 35.3300, GNorm = 0.6073, lr_0 = 1.5192e-04
Loss = 8.5945e-02, PNorm = 35.3338, GNorm = 0.5628, lr_0 = 1.4795e-04
Validation rmse = 0.137311
Validation r2 = 0.820230
Validation mse = 0.018854
Epoch 47
Loss = 8.9962e-02, PNorm = 35.3392, GNorm = 0.5857, lr_0 = 1.4409e-04
Validation rmse = 0.138759
Validation r2 = 0.816421
Validation mse = 0.019254
Epoch 48
Loss = 6.8339e-02, PNorm = 35.3438, GNorm = 0.6242, lr_0 = 1.3995e-04
Loss = 9.1614e-02, PNorm = 35.3477, GNorm = 1.6643, lr_0 = 1.3630e-04
Validation rmse = 0.136991
Validation r2 = 0.821068
Validation mse = 0.018767
Epoch 49
Loss = 7.9650e-02, PNorm = 35.3504, GNorm = 3.2495, lr_0 = 1.3274e-04
Validation rmse = 0.142764
Validation r2 = 0.805671
Validation mse = 0.020381
Epoch 50
Loss = 8.6054e-02, PNorm = 35.3546, GNorm = 1.4866, lr_0 = 1.2927e-04
Loss = 9.4286e-02, PNorm = 35.3583, GNorm = 1.1359, lr_0 = 1.2589e-04
Validation rmse = 0.136475
Validation r2 = 0.822414
Validation mse = 0.018625
Epoch 51
Loss = 8.5657e-02, PNorm = 35.3624, GNorm = 1.4898, lr_0 = 1.2228e-04
Validation rmse = 0.136921
Validation r2 = 0.821251
Validation mse = 0.018747
Epoch 52
Loss = 7.3067e-02, PNorm = 35.3666, GNorm = 0.8960, lr_0 = 1.1909e-04
Loss = 9.0482e-02, PNorm = 35.3697, GNorm = 1.4054, lr_0 = 1.1598e-04
Validation rmse = 0.138714
Validation r2 = 0.816540
Validation mse = 0.019241
Epoch 53
Loss = 7.7585e-02, PNorm = 35.3733, GNorm = 0.5261, lr_0 = 1.1265e-04
Loss = 8.9014e-02, PNorm = 35.3763, GNorm = 2.0498, lr_0 = 1.0971e-04
Validation rmse = 0.136757
Validation r2 = 0.821681
Validation mse = 0.018702
Epoch 54
Loss = 8.7799e-02, PNorm = 35.3802, GNorm = 1.1202, lr_0 = 1.0684e-04
Validation rmse = 0.137180
Validation r2 = 0.820576
Validation mse = 0.018818
Epoch 55
Loss = 9.0564e-02, PNorm = 35.3828, GNorm = 2.0882, lr_0 = 1.0377e-04
Loss = 8.0654e-02, PNorm = 35.3862, GNorm = 1.0940, lr_0 = 1.0106e-04
Validation rmse = 0.138201
Validation r2 = 0.817894
Validation mse = 0.019100
Epoch 56
Loss = 7.7060e-02, PNorm = 35.3885, GNorm = 1.7650, lr_0 = 1.0000e-04
Validation rmse = 0.140241
Validation r2 = 0.812477
Validation mse = 0.019668
Epoch 57
Loss = 9.8244e-02, PNorm = 35.3913, GNorm = 0.7097, lr_0 = 1.0000e-04
Loss = 7.0704e-02, PNorm = 35.3943, GNorm = 0.8793, lr_0 = 1.0000e-04
Validation rmse = 0.137746
Validation r2 = 0.819090
Validation mse = 0.018974
Epoch 58
Loss = 7.9942e-02, PNorm = 35.3972, GNorm = 1.1910, lr_0 = 1.0000e-04
Validation rmse = 0.136815
Validation r2 = 0.821527
Validation mse = 0.018718
Epoch 59
Loss = 1.2240e-01, PNorm = 35.4004, GNorm = 0.7894, lr_0 = 1.0000e-04
Loss = 7.5258e-02, PNorm = 35.4041, GNorm = 1.7047, lr_0 = 1.0000e-04
Validation rmse = 0.138058
Validation r2 = 0.818271
Validation mse = 0.019060
Model 0 best validation rmse = 0.135959 on epoch 38
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.639985
Model 0 test r2 = -113.416107
Model 0 test mse = 0.409581
Ensemble test rmse = 0.639985
Ensemble test r2 = -113.416107
Ensemble test mse = 0.409581
Fold 8
Splitting data with seed 8
Total size = 973 | train size = 778 | val size = 195 | test size = 49
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.7747e-01, PNorm = 34.0169, GNorm = 6.4388, lr_0 = 4.3000e-04
Validation rmse = 0.273862
Validation r2 = 0.241921
Validation mse = 0.075000
Epoch 1
Loss = 5.9058e-01, PNorm = 34.0518, GNorm = 4.2210, lr_0 = 7.6000e-04
Loss = 6.7697e-01, PNorm = 34.1025, GNorm = 4.1940, lr_0 = 9.9472e-04
Validation rmse = 0.243022
Validation r2 = 0.403043
Validation mse = 0.059060
Epoch 2
Loss = 5.3737e-01, PNorm = 34.1689, GNorm = 15.4321, lr_0 = 9.6874e-04
Validation rmse = 0.208506
Validation r2 = 0.560572
Validation mse = 0.043475
Epoch 3
Loss = 4.1638e-01, PNorm = 34.2443, GNorm = 3.7021, lr_0 = 9.4094e-04
Loss = 4.6497e-01, PNorm = 34.3079, GNorm = 1.4198, lr_0 = 9.1637e-04
Validation rmse = 0.203130
Validation r2 = 0.582941
Validation mse = 0.041262
Epoch 4
Loss = 3.5906e-01, PNorm = 34.3688, GNorm = 8.3410, lr_0 = 8.9243e-04
Validation rmse = 0.191356
Validation r2 = 0.629885
Validation mse = 0.036617
Epoch 5
Loss = 4.1451e-01, PNorm = 34.4213, GNorm = 8.9694, lr_0 = 8.6682e-04
Loss = 3.2124e-01, PNorm = 34.4700, GNorm = 1.4151, lr_0 = 8.4418e-04
Validation rmse = 0.173591
Validation r2 = 0.695416
Validation mse = 0.030134
Epoch 6
Loss = 2.5992e-01, PNorm = 34.5228, GNorm = 3.6005, lr_0 = 8.2213e-04
Validation rmse = 0.160147
Validation r2 = 0.740769
Validation mse = 0.025647
Epoch 7
Loss = 2.2270e-01, PNorm = 34.5669, GNorm = 1.8470, lr_0 = 7.9854e-04
Loss = 2.3259e-01, PNorm = 34.6131, GNorm = 5.6355, lr_0 = 7.7769e-04
Validation rmse = 0.144884
Validation r2 = 0.787826
Validation mse = 0.020991
Epoch 8
Loss = 1.8092e-01, PNorm = 34.6474, GNorm = 2.4292, lr_0 = 7.5737e-04
Loss = 1.8715e-01, PNorm = 34.6819, GNorm = 4.3056, lr_0 = 7.3759e-04
Validation rmse = 0.141317
Validation r2 = 0.798145
Validation mse = 0.019970
Epoch 9
Loss = 1.9793e-01, PNorm = 34.7111, GNorm = 4.8294, lr_0 = 7.1833e-04
Validation rmse = 0.139357
Validation r2 = 0.803706
Validation mse = 0.019420
Epoch 10
Loss = 1.5515e-01, PNorm = 34.7453, GNorm = 1.1208, lr_0 = 6.9772e-04
Loss = 1.5182e-01, PNorm = 34.7744, GNorm = 1.7051, lr_0 = 6.7949e-04
Validation rmse = 0.136305
Validation r2 = 0.812209
Validation mse = 0.018579
Epoch 11
Loss = 1.3571e-01, PNorm = 34.8004, GNorm = 1.8530, lr_0 = 6.6174e-04
Validation rmse = 0.140732
Validation r2 = 0.799811
Validation mse = 0.019806
Epoch 12
Loss = 1.3963e-01, PNorm = 34.8274, GNorm = 2.5869, lr_0 = 6.4276e-04
Loss = 1.6158e-01, PNorm = 34.8481, GNorm = 3.8788, lr_0 = 6.2597e-04
Validation rmse = 0.142325
Validation r2 = 0.795254
Validation mse = 0.020256
Epoch 13
Loss = 1.3919e-01, PNorm = 34.8694, GNorm = 3.9744, lr_0 = 6.0962e-04
Validation rmse = 0.151763
Validation r2 = 0.767200
Validation mse = 0.023032
Epoch 14
Loss = 1.5769e-01, PNorm = 34.8915, GNorm = 3.6019, lr_0 = 5.9213e-04
Loss = 1.4108e-01, PNorm = 34.9141, GNorm = 5.6855, lr_0 = 5.7666e-04
Validation rmse = 0.131806
Validation r2 = 0.824402
Validation mse = 0.017373
Epoch 15
Loss = 1.2290e-01, PNorm = 34.9322, GNorm = 2.5939, lr_0 = 5.6160e-04
Validation rmse = 0.138303
Validation r2 = 0.806663
Validation mse = 0.019128
Epoch 16
Loss = 1.5546e-01, PNorm = 34.9499, GNorm = 0.9156, lr_0 = 5.4548e-04
Loss = 1.2007e-01, PNorm = 34.9666, GNorm = 0.7792, lr_0 = 5.3124e-04
Validation rmse = 0.143074
Validation r2 = 0.793095
Validation mse = 0.020470
Epoch 17
Loss = 1.5102e-01, PNorm = 34.9790, GNorm = 2.4363, lr_0 = 5.1736e-04
Loss = 1.2404e-01, PNorm = 34.9954, GNorm = 3.8669, lr_0 = 5.0385e-04
Validation rmse = 0.131795
Validation r2 = 0.824432
Validation mse = 0.017370
Epoch 18
Loss = 1.4493e-01, PNorm = 35.0114, GNorm = 6.9689, lr_0 = 4.9069e-04
Validation rmse = 0.131273
Validation r2 = 0.825817
Validation mse = 0.017233
Epoch 19
Loss = 1.0542e-01, PNorm = 35.0308, GNorm = 1.8846, lr_0 = 4.7661e-04
Loss = 1.3330e-01, PNorm = 35.0437, GNorm = 2.9859, lr_0 = 4.6416e-04
Validation rmse = 0.134866
Validation r2 = 0.816153
Validation mse = 0.018189
Epoch 20
Loss = 1.1805e-01, PNorm = 35.0556, GNorm = 1.4623, lr_0 = 4.5204e-04
Validation rmse = 0.134539
Validation r2 = 0.817045
Validation mse = 0.018101
Epoch 21
Loss = 1.3337e-01, PNorm = 35.0730, GNorm = 2.4270, lr_0 = 4.3906e-04
Loss = 1.1828e-01, PNorm = 35.0839, GNorm = 0.7990, lr_0 = 4.2760e-04
Validation rmse = 0.131686
Validation r2 = 0.824720
Validation mse = 0.017341
Epoch 22
Loss = 1.2305e-01, PNorm = 35.0997, GNorm = 2.9583, lr_0 = 4.1643e-04
Validation rmse = 0.132925
Validation r2 = 0.821407
Validation mse = 0.017669
Epoch 23
Loss = 1.1684e-01, PNorm = 35.1127, GNorm = 1.0108, lr_0 = 4.0448e-04
Loss = 1.2449e-01, PNorm = 35.1254, GNorm = 4.0628, lr_0 = 3.9391e-04
Validation rmse = 0.141033
Validation r2 = 0.798955
Validation mse = 0.019890
Epoch 24
Loss = 1.2400e-01, PNorm = 35.1347, GNorm = 2.0715, lr_0 = 3.8363e-04
Validation rmse = 0.130775
Validation r2 = 0.827137
Validation mse = 0.017102
Epoch 25
Loss = 1.3018e-01, PNorm = 35.1460, GNorm = 1.2485, lr_0 = 3.7361e-04
Loss = 1.1516e-01, PNorm = 35.1599, GNorm = 4.9925, lr_0 = 3.6385e-04
Validation rmse = 0.131115
Validation r2 = 0.826237
Validation mse = 0.017191
Epoch 26
Loss = 9.0896e-02, PNorm = 35.1685, GNorm = 0.5326, lr_0 = 3.5341e-04
Loss = 1.3017e-01, PNorm = 35.1791, GNorm = 1.1795, lr_0 = 3.4418e-04
Validation rmse = 0.141323
Validation r2 = 0.798128
Validation mse = 0.019972
Epoch 27
Loss = 1.2596e-01, PNorm = 35.1900, GNorm = 1.7459, lr_0 = 3.3519e-04
Validation rmse = 0.140380
Validation r2 = 0.800813
Validation mse = 0.019706
Epoch 28
Loss = 1.1229e-01, PNorm = 35.2009, GNorm = 3.5123, lr_0 = 3.2557e-04
Loss = 1.2718e-01, PNorm = 35.2091, GNorm = 1.8494, lr_0 = 3.1707e-04
Validation rmse = 0.145623
Validation r2 = 0.785657
Validation mse = 0.021206
Epoch 29
Loss = 1.1577e-01, PNorm = 35.2201, GNorm = 0.6806, lr_0 = 3.0878e-04
Validation rmse = 0.134012
Validation r2 = 0.818474
Validation mse = 0.017959
Epoch 30
Loss = 9.8913e-02, PNorm = 35.2301, GNorm = 1.9996, lr_0 = 2.9992e-04
Loss = 1.0941e-01, PNorm = 35.2390, GNorm = 1.3436, lr_0 = 2.9209e-04
Validation rmse = 0.132225
Validation r2 = 0.823282
Validation mse = 0.017484
Epoch 31
Loss = 1.0117e-01, PNorm = 35.2473, GNorm = 1.8189, lr_0 = 2.8446e-04
Validation rmse = 0.129208
Validation r2 = 0.831254
Validation mse = 0.016695
Epoch 32
Loss = 7.3754e-02, PNorm = 35.2547, GNorm = 0.7247, lr_0 = 2.7630e-04
Loss = 9.8889e-02, PNorm = 35.2642, GNorm = 1.5721, lr_0 = 2.6908e-04
Validation rmse = 0.129613
Validation r2 = 0.830196
Validation mse = 0.016799
Epoch 33
Loss = 1.0035e-01, PNorm = 35.2699, GNorm = 1.0914, lr_0 = 2.6205e-04
Validation rmse = 0.130653
Validation r2 = 0.827460
Validation mse = 0.017070
Epoch 34
Loss = 1.1944e-01, PNorm = 35.2761, GNorm = 1.3501, lr_0 = 2.5521e-04
Loss = 9.9351e-02, PNorm = 35.2827, GNorm = 1.5919, lr_0 = 2.4854e-04
Validation rmse = 0.130920
Validation r2 = 0.826755
Validation mse = 0.017140
Epoch 35
Loss = 7.5054e-02, PNorm = 35.2903, GNorm = 0.8889, lr_0 = 2.4141e-04
Loss = 1.1101e-01, PNorm = 35.2967, GNorm = 1.1587, lr_0 = 2.3511e-04
Validation rmse = 0.128955
Validation r2 = 0.831915
Validation mse = 0.016629
Epoch 36
Loss = 1.0445e-01, PNorm = 35.3035, GNorm = 0.8410, lr_0 = 2.2897e-04
Validation rmse = 0.129300
Validation r2 = 0.831015
Validation mse = 0.016718
Epoch 37
Loss = 1.0083e-01, PNorm = 35.3106, GNorm = 0.6492, lr_0 = 2.2240e-04
Loss = 9.1104e-02, PNorm = 35.3182, GNorm = 2.4072, lr_0 = 2.1659e-04
Validation rmse = 0.129212
Validation r2 = 0.831246
Validation mse = 0.016696
Epoch 38
Loss = 8.8010e-02, PNorm = 35.3251, GNorm = 0.6090, lr_0 = 2.1093e-04
Validation rmse = 0.130906
Validation r2 = 0.826792
Validation mse = 0.017136
Epoch 39
Loss = 1.0494e-01, PNorm = 35.3314, GNorm = 1.0927, lr_0 = 2.0488e-04
Loss = 9.0501e-02, PNorm = 35.3379, GNorm = 0.7370, lr_0 = 1.9953e-04
Validation rmse = 0.129458
Validation r2 = 0.830602
Validation mse = 0.016759
Epoch 40
Loss = 9.1201e-02, PNorm = 35.3446, GNorm = 1.4815, lr_0 = 1.9431e-04
Validation rmse = 0.131159
Validation r2 = 0.826121
Validation mse = 0.017203
Epoch 41
Loss = 8.2892e-02, PNorm = 35.3509, GNorm = 0.7088, lr_0 = 1.8874e-04
Loss = 9.6346e-02, PNorm = 35.3557, GNorm = 0.6166, lr_0 = 1.8381e-04
Validation rmse = 0.129422
Validation r2 = 0.830697
Validation mse = 0.016750
Epoch 42
Loss = 8.2702e-02, PNorm = 35.3625, GNorm = 0.9512, lr_0 = 1.7901e-04
Validation rmse = 0.129286
Validation r2 = 0.831051
Validation mse = 0.016715
Epoch 43
Loss = 1.1373e-01, PNorm = 35.3670, GNorm = 0.8176, lr_0 = 1.7433e-04
Loss = 8.5375e-02, PNorm = 35.3726, GNorm = 0.6738, lr_0 = 1.6978e-04
Validation rmse = 0.129469
Validation r2 = 0.830573
Validation mse = 0.016762
Epoch 44
Loss = 8.8665e-02, PNorm = 35.3794, GNorm = 0.9056, lr_0 = 1.6491e-04
Loss = 8.9747e-02, PNorm = 35.3834, GNorm = 2.8489, lr_0 = 1.6060e-04
Validation rmse = 0.131464
Validation r2 = 0.825310
Validation mse = 0.017283
Epoch 45
Loss = 8.9304e-02, PNorm = 35.3884, GNorm = 0.6100, lr_0 = 1.5641e-04
Validation rmse = 0.129786
Validation r2 = 0.829741
Validation mse = 0.016845
Epoch 46
Loss = 8.2913e-02, PNorm = 35.3944, GNorm = 2.3594, lr_0 = 1.5192e-04
Loss = 9.1860e-02, PNorm = 35.3987, GNorm = 1.1605, lr_0 = 1.4795e-04
Validation rmse = 0.130080
Validation r2 = 0.828969
Validation mse = 0.016921
Epoch 47
Loss = 8.5803e-02, PNorm = 35.4028, GNorm = 1.4654, lr_0 = 1.4409e-04
Validation rmse = 0.128397
Validation r2 = 0.833366
Validation mse = 0.016486
Epoch 48
Loss = 7.8714e-02, PNorm = 35.4084, GNorm = 0.7603, lr_0 = 1.3995e-04
Loss = 8.8576e-02, PNorm = 35.4129, GNorm = 1.0869, lr_0 = 1.3630e-04
Validation rmse = 0.130848
Validation r2 = 0.826945
Validation mse = 0.017121
Epoch 49
Loss = 9.7255e-02, PNorm = 35.4171, GNorm = 1.1494, lr_0 = 1.3274e-04
Validation rmse = 0.128981
Validation r2 = 0.831847
Validation mse = 0.016636
Epoch 50
Loss = 8.0545e-02, PNorm = 35.4213, GNorm = 0.6663, lr_0 = 1.2927e-04
Loss = 9.2013e-02, PNorm = 35.4246, GNorm = 1.0249, lr_0 = 1.2589e-04
Validation rmse = 0.129713
Validation r2 = 0.829934
Validation mse = 0.016825
Epoch 51
Loss = 7.4220e-02, PNorm = 35.4302, GNorm = 1.2630, lr_0 = 1.2228e-04
Validation rmse = 0.132418
Validation r2 = 0.822766
Validation mse = 0.017535
Epoch 52
Loss = 1.1045e-01, PNorm = 35.4326, GNorm = 2.0914, lr_0 = 1.1909e-04
Loss = 8.6252e-02, PNorm = 35.4365, GNorm = 0.7716, lr_0 = 1.1598e-04
Validation rmse = 0.128934
Validation r2 = 0.831969
Validation mse = 0.016624
Epoch 53
Loss = 9.2583e-02, PNorm = 35.4402, GNorm = 1.7795, lr_0 = 1.1265e-04
Loss = 7.8258e-02, PNorm = 35.4438, GNorm = 0.7831, lr_0 = 1.0971e-04
Validation rmse = 0.128179
Validation r2 = 0.833933
Validation mse = 0.016430
Epoch 54
Loss = 8.7184e-02, PNorm = 35.4476, GNorm = 0.5895, lr_0 = 1.0684e-04
Validation rmse = 0.130087
Validation r2 = 0.828951
Validation mse = 0.016923
Epoch 55
Loss = 8.0617e-02, PNorm = 35.4517, GNorm = 2.3200, lr_0 = 1.0377e-04
Loss = 8.5765e-02, PNorm = 35.4546, GNorm = 0.8501, lr_0 = 1.0106e-04
Validation rmse = 0.128644
Validation r2 = 0.832726
Validation mse = 0.016549
Epoch 56
Loss = 7.7296e-02, PNorm = 35.4578, GNorm = 0.7362, lr_0 = 1.0000e-04
Validation rmse = 0.129074
Validation r2 = 0.831604
Validation mse = 0.016660
Epoch 57
Loss = 8.3758e-02, PNorm = 35.4610, GNorm = 0.6149, lr_0 = 1.0000e-04
Loss = 8.3761e-02, PNorm = 35.4643, GNorm = 1.1575, lr_0 = 1.0000e-04
Validation rmse = 0.128871
Validation r2 = 0.832134
Validation mse = 0.016608
Epoch 58
Loss = 7.7346e-02, PNorm = 35.4671, GNorm = 0.5504, lr_0 = 1.0000e-04
Validation rmse = 0.132360
Validation r2 = 0.822922
Validation mse = 0.017519
Epoch 59
Loss = 1.1654e-01, PNorm = 35.4707, GNorm = 1.7993, lr_0 = 1.0000e-04
Loss = 7.9114e-02, PNorm = 35.4749, GNorm = 0.9810, lr_0 = 1.0000e-04
Validation rmse = 0.130588
Validation r2 = 0.827632
Validation mse = 0.017053
Model 0 best validation rmse = 0.128179 on epoch 53
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.676831
Model 0 test r2 = -126.969887
Model 0 test mse = 0.458100
Ensemble test rmse = 0.676831
Ensemble test r2 = -126.969887
Ensemble test mse = 0.458100
Fold 9
Splitting data with seed 9
Total size = 973 | train size = 778 | val size = 195 | test size = 49
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.2069e-01, PNorm = 34.0154, GNorm = 2.1722, lr_0 = 4.3000e-04
Validation rmse = 0.318435
Validation r2 = 0.090396
Validation mse = 0.101401
Epoch 1
Loss = 9.7834e-01, PNorm = 34.0415, GNorm = 12.7246, lr_0 = 7.6000e-04
Loss = 6.5637e-01, PNorm = 34.0880, GNorm = 2.4858, lr_0 = 9.9472e-04
Validation rmse = 0.286260
Validation r2 = 0.264925
Validation mse = 0.081945
Epoch 2
Loss = 6.9218e-01, PNorm = 34.1519, GNorm = 5.4480, lr_0 = 9.6874e-04
Validation rmse = 0.247616
Validation r2 = 0.449993
Validation mse = 0.061314
Epoch 3
Loss = 3.8324e-01, PNorm = 34.2394, GNorm = 1.1192, lr_0 = 9.4094e-04
Loss = 4.2635e-01, PNorm = 34.3057, GNorm = 4.0354, lr_0 = 9.1637e-04
Validation rmse = 0.212928
Validation r2 = 0.593300
Validation mse = 0.045338
Epoch 4
Loss = 4.3898e-01, PNorm = 34.3771, GNorm = 7.5947, lr_0 = 8.9243e-04
Validation rmse = 0.185496
Validation r2 = 0.691341
Validation mse = 0.034409
Epoch 5
Loss = 3.3124e-01, PNorm = 34.4425, GNorm = 6.4335, lr_0 = 8.6682e-04
Loss = 2.9108e-01, PNorm = 34.4971, GNorm = 1.2255, lr_0 = 8.4418e-04
Validation rmse = 0.188285
Validation r2 = 0.681990
Validation mse = 0.035451
Epoch 6
Loss = 2.8719e-01, PNorm = 34.5483, GNorm = 1.7286, lr_0 = 8.2213e-04
Validation rmse = 0.165875
Validation r2 = 0.753185
Validation mse = 0.027515
Epoch 7
Loss = 2.7778e-01, PNorm = 34.5971, GNorm = 2.3824, lr_0 = 7.9854e-04
Loss = 1.8256e-01, PNorm = 34.6364, GNorm = 0.6833, lr_0 = 7.7769e-04
Validation rmse = 0.168586
Validation r2 = 0.745052
Validation mse = 0.028421
Epoch 8
Loss = 2.0635e-01, PNorm = 34.6748, GNorm = 3.8702, lr_0 = 7.5737e-04
Loss = 2.1162e-01, PNorm = 34.7020, GNorm = 3.2614, lr_0 = 7.3759e-04
Validation rmse = 0.165144
Validation r2 = 0.755355
Validation mse = 0.027273
Epoch 9
Loss = 1.9282e-01, PNorm = 34.7293, GNorm = 4.4271, lr_0 = 7.1833e-04
Validation rmse = 0.167344
Validation r2 = 0.748793
Validation mse = 0.028004
Epoch 10
Loss = 1.7614e-01, PNorm = 34.7650, GNorm = 2.6419, lr_0 = 6.9772e-04
Loss = 1.7499e-01, PNorm = 34.7898, GNorm = 1.0344, lr_0 = 6.7949e-04
Validation rmse = 0.149331
Validation r2 = 0.799962
Validation mse = 0.022300
Epoch 11
Loss = 1.7030e-01, PNorm = 34.8154, GNorm = 0.9299, lr_0 = 6.6174e-04
Validation rmse = 0.139009
Validation r2 = 0.826662
Validation mse = 0.019323
Epoch 12
Loss = 1.5824e-01, PNorm = 34.8391, GNorm = 4.6405, lr_0 = 6.4276e-04
Loss = 1.6086e-01, PNorm = 34.8605, GNorm = 1.1713, lr_0 = 6.2597e-04
Validation rmse = 0.149079
Validation r2 = 0.800637
Validation mse = 0.022225
Epoch 13
Loss = 1.6712e-01, PNorm = 34.8837, GNorm = 1.5703, lr_0 = 6.0962e-04
Validation rmse = 0.132839
Validation r2 = 0.841706
Validation mse = 0.017646
Epoch 14
Loss = 1.1885e-01, PNorm = 34.9083, GNorm = 2.4731, lr_0 = 5.9213e-04
Loss = 1.5882e-01, PNorm = 34.9279, GNorm = 1.7494, lr_0 = 5.7666e-04
Validation rmse = 0.133899
Validation r2 = 0.839171
Validation mse = 0.017929
Epoch 15
Loss = 1.2230e-01, PNorm = 34.9443, GNorm = 1.0559, lr_0 = 5.6160e-04
Validation rmse = 0.136416
Validation r2 = 0.833067
Validation mse = 0.018609
Epoch 16
Loss = 1.1762e-01, PNorm = 34.9657, GNorm = 1.9021, lr_0 = 5.4548e-04
Loss = 1.4599e-01, PNorm = 34.9838, GNorm = 1.4831, lr_0 = 5.3124e-04
Validation rmse = 0.135967
Validation r2 = 0.834164
Validation mse = 0.018487
Epoch 17
Loss = 1.4969e-01, PNorm = 35.0029, GNorm = 3.7470, lr_0 = 5.1736e-04
Loss = 1.4563e-01, PNorm = 35.0207, GNorm = 1.5971, lr_0 = 5.0385e-04
Validation rmse = 0.133208
Validation r2 = 0.840827
Validation mse = 0.017744
Epoch 18
Loss = 1.2710e-01, PNorm = 35.0394, GNorm = 0.7127, lr_0 = 4.9069e-04
Validation rmse = 0.129559
Validation r2 = 0.849427
Validation mse = 0.016786
Epoch 19
Loss = 1.3401e-01, PNorm = 35.0531, GNorm = 0.6333, lr_0 = 4.7661e-04
Loss = 1.3026e-01, PNorm = 35.0682, GNorm = 2.1289, lr_0 = 4.6416e-04
Validation rmse = 0.134210
Validation r2 = 0.838424
Validation mse = 0.018012
Epoch 20
Loss = 1.2439e-01, PNorm = 35.0846, GNorm = 1.0186, lr_0 = 4.5204e-04
Validation rmse = 0.125879
Validation r2 = 0.857860
Validation mse = 0.015845
Epoch 21
Loss = 1.2033e-01, PNorm = 35.1032, GNorm = 0.6034, lr_0 = 4.3906e-04
Loss = 1.1954e-01, PNorm = 35.1161, GNorm = 1.6706, lr_0 = 4.2760e-04
Validation rmse = 0.143519
Validation r2 = 0.815230
Validation mse = 0.020598
Epoch 22
Loss = 1.3654e-01, PNorm = 35.1310, GNorm = 1.5865, lr_0 = 4.1643e-04
Validation rmse = 0.141947
Validation r2 = 0.819257
Validation mse = 0.020149
Epoch 23
Loss = 1.4858e-01, PNorm = 35.1474, GNorm = 3.0409, lr_0 = 4.0448e-04
Loss = 1.3751e-01, PNorm = 35.1621, GNorm = 1.2174, lr_0 = 3.9391e-04
Validation rmse = 0.126372
Validation r2 = 0.856743
Validation mse = 0.015970
Epoch 24
Loss = 1.3207e-01, PNorm = 35.1763, GNorm = 0.8577, lr_0 = 3.8363e-04
Validation rmse = 0.126309
Validation r2 = 0.856887
Validation mse = 0.015954
Epoch 25
Loss = 1.5607e-01, PNorm = 35.1897, GNorm = 4.0100, lr_0 = 3.7361e-04
Loss = 1.1862e-01, PNorm = 35.2025, GNorm = 3.9937, lr_0 = 3.6385e-04
Validation rmse = 0.126436
Validation r2 = 0.856599
Validation mse = 0.015986
Epoch 26
Loss = 1.2229e-01, PNorm = 35.2134, GNorm = 2.3233, lr_0 = 3.5341e-04
Loss = 1.1895e-01, PNorm = 35.2262, GNorm = 1.9848, lr_0 = 3.4418e-04
Validation rmse = 0.125334
Validation r2 = 0.859088
Validation mse = 0.015709
Epoch 27
Loss = 1.0538e-01, PNorm = 35.2393, GNorm = 1.4442, lr_0 = 3.3519e-04
Validation rmse = 0.124145
Validation r2 = 0.861748
Validation mse = 0.015412
Epoch 28
Loss = 1.0976e-01, PNorm = 35.2497, GNorm = 1.0943, lr_0 = 3.2557e-04
Loss = 1.1778e-01, PNorm = 35.2619, GNorm = 0.7581, lr_0 = 3.1707e-04
Validation rmse = 0.125721
Validation r2 = 0.858217
Validation mse = 0.015806
Epoch 29
Loss = 1.1316e-01, PNorm = 35.2742, GNorm = 0.9446, lr_0 = 3.0878e-04
Validation rmse = 0.130874
Validation r2 = 0.846355
Validation mse = 0.017128
Epoch 30
Loss = 1.1531e-01, PNorm = 35.2836, GNorm = 0.7970, lr_0 = 2.9992e-04
Loss = 1.0714e-01, PNorm = 35.2916, GNorm = 1.2758, lr_0 = 2.9209e-04
Validation rmse = 0.124083
Validation r2 = 0.861886
Validation mse = 0.015397
Epoch 31
Loss = 1.0187e-01, PNorm = 35.3028, GNorm = 0.4781, lr_0 = 2.8446e-04
Validation rmse = 0.122994
Validation r2 = 0.864301
Validation mse = 0.015128
Epoch 32
Loss = 1.2083e-01, PNorm = 35.3143, GNorm = 0.7280, lr_0 = 2.7630e-04
Loss = 1.0013e-01, PNorm = 35.3241, GNorm = 0.9767, lr_0 = 2.6908e-04
Validation rmse = 0.122371
Validation r2 = 0.865672
Validation mse = 0.014975
Epoch 33
Loss = 1.0298e-01, PNorm = 35.3316, GNorm = 1.1105, lr_0 = 2.6205e-04
Validation rmse = 0.129094
Validation r2 = 0.850508
Validation mse = 0.016665
Epoch 34
Loss = 7.0345e-02, PNorm = 35.3416, GNorm = 1.8077, lr_0 = 2.5521e-04
Loss = 1.1161e-01, PNorm = 35.3501, GNorm = 1.2448, lr_0 = 2.4854e-04
Validation rmse = 0.127159
Validation r2 = 0.854953
Validation mse = 0.016170
Epoch 35
Loss = 1.1584e-01, PNorm = 35.3608, GNorm = 2.0812, lr_0 = 2.4141e-04
Loss = 9.8890e-02, PNorm = 35.3692, GNorm = 0.7919, lr_0 = 2.3511e-04
Validation rmse = 0.128639
Validation r2 = 0.851559
Validation mse = 0.016548
Epoch 36
Loss = 9.9981e-02, PNorm = 35.3751, GNorm = 0.6854, lr_0 = 2.2897e-04
Validation rmse = 0.124082
Validation r2 = 0.861890
Validation mse = 0.015396
Epoch 37
Loss = 1.2393e-01, PNorm = 35.3861, GNorm = 0.6595, lr_0 = 2.2240e-04
Loss = 8.9281e-02, PNorm = 35.3940, GNorm = 0.8881, lr_0 = 2.1659e-04
Validation rmse = 0.123244
Validation r2 = 0.863747
Validation mse = 0.015189
Epoch 38
Loss = 9.0590e-02, PNorm = 35.4013, GNorm = 1.8443, lr_0 = 2.1093e-04
Validation rmse = 0.123727
Validation r2 = 0.862678
Validation mse = 0.015308
Epoch 39
Loss = 1.1099e-01, PNorm = 35.4098, GNorm = 0.6828, lr_0 = 2.0488e-04
Loss = 1.0156e-01, PNorm = 35.4167, GNorm = 1.5643, lr_0 = 1.9953e-04
Validation rmse = 0.123692
Validation r2 = 0.862757
Validation mse = 0.015300
Epoch 40
Loss = 8.6673e-02, PNorm = 35.4235, GNorm = 2.8476, lr_0 = 1.9431e-04
Validation rmse = 0.121835
Validation r2 = 0.866846
Validation mse = 0.014844
Epoch 41
Loss = 8.1124e-02, PNorm = 35.4323, GNorm = 2.0136, lr_0 = 1.8874e-04
Loss = 1.0509e-01, PNorm = 35.4386, GNorm = 0.6498, lr_0 = 1.8381e-04
Validation rmse = 0.121686
Validation r2 = 0.867171
Validation mse = 0.014808
Epoch 42
Loss = 1.0828e-01, PNorm = 35.4452, GNorm = 1.9802, lr_0 = 1.7901e-04
Validation rmse = 0.122838
Validation r2 = 0.864644
Validation mse = 0.015089
Epoch 43
Loss = 6.5168e-02, PNorm = 35.4532, GNorm = 0.6267, lr_0 = 1.7433e-04
Loss = 9.2366e-02, PNorm = 35.4596, GNorm = 1.0498, lr_0 = 1.6978e-04
Validation rmse = 0.120912
Validation r2 = 0.868856
Validation mse = 0.014620
Epoch 44
Loss = 8.5571e-02, PNorm = 35.4672, GNorm = 1.3211, lr_0 = 1.6491e-04
Loss = 1.0481e-01, PNorm = 35.4718, GNorm = 1.9204, lr_0 = 1.6060e-04
Validation rmse = 0.122942
Validation r2 = 0.864416
Validation mse = 0.015115
Epoch 45
Loss = 9.3088e-02, PNorm = 35.4776, GNorm = 1.2206, lr_0 = 1.5641e-04
Validation rmse = 0.120907
Validation r2 = 0.868866
Validation mse = 0.014619
Epoch 46
Loss = 9.9705e-02, PNorm = 35.4841, GNorm = 0.6664, lr_0 = 1.5192e-04
Loss = 9.4436e-02, PNorm = 35.4900, GNorm = 1.0624, lr_0 = 1.4795e-04
Validation rmse = 0.125035
Validation r2 = 0.859760
Validation mse = 0.015634
Epoch 47
Loss = 1.0398e-01, PNorm = 35.4947, GNorm = 0.9484, lr_0 = 1.4409e-04
Validation rmse = 0.121222
Validation r2 = 0.868182
Validation mse = 0.014695
Epoch 48
Loss = 7.9135e-02, PNorm = 35.5000, GNorm = 1.2534, lr_0 = 1.3995e-04
Loss = 1.0457e-01, PNorm = 35.5051, GNorm = 1.2584, lr_0 = 1.3630e-04
Validation rmse = 0.125612
Validation r2 = 0.858462
Validation mse = 0.015778
Epoch 49
Loss = 8.7278e-02, PNorm = 35.5106, GNorm = 0.5450, lr_0 = 1.3274e-04
Validation rmse = 0.123515
Validation r2 = 0.863149
Validation mse = 0.015256
Epoch 50
Loss = 7.8016e-02, PNorm = 35.5144, GNorm = 0.5991, lr_0 = 1.2927e-04
Loss = 9.5771e-02, PNorm = 35.5193, GNorm = 1.1290, lr_0 = 1.2589e-04
Validation rmse = 0.120840
Validation r2 = 0.869013
Validation mse = 0.014602
Epoch 51
Loss = 9.6612e-02, PNorm = 35.5245, GNorm = 0.8690, lr_0 = 1.2228e-04
Validation rmse = 0.123406
Validation r2 = 0.863390
Validation mse = 0.015229
Epoch 52
Loss = 1.0540e-01, PNorm = 35.5294, GNorm = 1.6136, lr_0 = 1.1909e-04
Loss = 9.0904e-02, PNorm = 35.5344, GNorm = 2.1176, lr_0 = 1.1598e-04
Validation rmse = 0.125293
Validation r2 = 0.859180
Validation mse = 0.015698
Epoch 53
Loss = 1.0273e-01, PNorm = 35.5383, GNorm = 1.3191, lr_0 = 1.1265e-04
Loss = 8.3798e-02, PNorm = 35.5435, GNorm = 0.6369, lr_0 = 1.0971e-04
Validation rmse = 0.121225
Validation r2 = 0.868176
Validation mse = 0.014695
Epoch 54
Loss = 8.7498e-02, PNorm = 35.5470, GNorm = 0.6408, lr_0 = 1.0684e-04
Validation rmse = 0.122311
Validation r2 = 0.865804
Validation mse = 0.014960
Epoch 55
Loss = 8.6311e-02, PNorm = 35.5515, GNorm = 0.7052, lr_0 = 1.0377e-04
Loss = 9.3762e-02, PNorm = 35.5551, GNorm = 0.6679, lr_0 = 1.0106e-04
Validation rmse = 0.122568
Validation r2 = 0.865239
Validation mse = 0.015023
Epoch 56
Loss = 8.8021e-02, PNorm = 35.5595, GNorm = 0.5763, lr_0 = 1.0000e-04
Validation rmse = 0.121727
Validation r2 = 0.867082
Validation mse = 0.014817
Epoch 57
Loss = 8.6065e-02, PNorm = 35.5635, GNorm = 0.6796, lr_0 = 1.0000e-04
Loss = 8.7806e-02, PNorm = 35.5677, GNorm = 0.8644, lr_0 = 1.0000e-04
Validation rmse = 0.121371
Validation r2 = 0.867859
Validation mse = 0.014731
Epoch 58
Loss = 8.7528e-02, PNorm = 35.5704, GNorm = 0.9306, lr_0 = 1.0000e-04
Validation rmse = 0.125657
Validation r2 = 0.858361
Validation mse = 0.015790
Epoch 59
Loss = 6.1201e-02, PNorm = 35.5745, GNorm = 1.2411, lr_0 = 1.0000e-04
Loss = 8.9576e-02, PNorm = 35.5780, GNorm = 2.5783, lr_0 = 1.0000e-04
Validation rmse = 0.122111
Validation r2 = 0.866243
Validation mse = 0.014911
Model 0 best validation rmse = 0.120840 on epoch 50
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.603013
Model 0 test r2 = -100.578159
Model 0 test mse = 0.363624
Ensemble test rmse = 0.603013
Ensemble test r2 = -100.578159
Ensemble test mse = 0.363624
10-fold cross validation
	Seed 0 ==> test rmse = 0.656258
	Seed 0 ==> test r2 = -119.308710
	Seed 0 ==> test mse = 0.430675
	Seed 1 ==> test rmse = 0.630118
	Seed 1 ==> test r2 = -109.915255
	Seed 1 ==> test mse = 0.397049
	Seed 2 ==> test rmse = 0.700407
	Seed 2 ==> test r2 = -136.040447
	Seed 2 ==> test mse = 0.490570
	Seed 3 ==> test rmse = 0.639730
	Seed 3 ==> test r2 = -113.324983
	Seed 3 ==> test mse = 0.409255
	Seed 4 ==> test rmse = 0.657498
	Seed 4 ==> test r2 = -119.763487
	Seed 4 ==> test mse = 0.432303
	Seed 5 ==> test rmse = 0.611327
	Seed 5 ==> test r2 = -103.398420
	Seed 5 ==> test mse = 0.373720
	Seed 6 ==> test rmse = 0.647790
	Seed 6 ==> test r2 = -116.223809
	Seed 6 ==> test mse = 0.419632
	Seed 7 ==> test rmse = 0.639985
	Seed 7 ==> test r2 = -113.416107
	Seed 7 ==> test mse = 0.409581
	Seed 8 ==> test rmse = 0.676831
	Seed 8 ==> test r2 = -126.969887
	Seed 8 ==> test mse = 0.458100
	Seed 9 ==> test rmse = 0.603013
	Seed 9 ==> test r2 = -100.578159
	Seed 9 ==> test mse = 0.363624
Overall test rmse = 0.646296 +/- 0.027438
Overall test r2 = -115.893926 +/- 9.972443
Overall test mse = 0.418451 +/- 0.035699
Elapsed time = 0:06:50
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-1d5c3576-9790-4896-9034-9bb28ba18d8e.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/Acet_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2', 'mse'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2', 'mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/generalization_3/Acet_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/Acet_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 926 | train size = 740 | val size = 186 | test size = 96
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.5787e-01, PNorm = 34.0163, GNorm = 1.7554, lr_0 = 4.5357e-04
Validation rmse = 0.346551
Validation r2 = 0.160086
Validation mse = 0.120098
Epoch 1
Loss = 7.0691e-01, PNorm = 34.0494, GNorm = 9.9879, lr_0 = 8.0714e-04
Validation rmse = 0.313954
Validation r2 = 0.310662
Validation mse = 0.098567
Epoch 2
Loss = 4.3055e-01, PNorm = 34.1054, GNorm = 7.9295, lr_0 = 9.8872e-04
Loss = 4.7054e-01, PNorm = 34.1732, GNorm = 4.2918, lr_0 = 9.6108e-04
Validation rmse = 0.287931
Validation r2 = 0.420201
Validation mse = 0.082904
Epoch 3
Loss = 3.7807e-01, PNorm = 34.2438, GNorm = 4.6539, lr_0 = 9.3421e-04
Validation rmse = 0.257245
Validation r2 = 0.537201
Validation mse = 0.066175
Epoch 4
Loss = 2.4878e-01, PNorm = 34.3060, GNorm = 1.5856, lr_0 = 9.0809e-04
Loss = 3.1745e-01, PNorm = 34.3614, GNorm = 2.3584, lr_0 = 8.8270e-04
Validation rmse = 0.250093
Validation r2 = 0.562575
Validation mse = 0.062547
Epoch 5
Loss = 2.9556e-01, PNorm = 34.4097, GNorm = 2.8683, lr_0 = 8.5802e-04
Validation rmse = 0.229157
Validation r2 = 0.632746
Validation mse = 0.052513
Epoch 6
Loss = 2.1248e-01, PNorm = 34.4639, GNorm = 3.1885, lr_0 = 8.3167e-04
Loss = 2.0773e-01, PNorm = 34.5081, GNorm = 1.9491, lr_0 = 8.0842e-04
Validation rmse = 0.203059
Validation r2 = 0.711634
Validation mse = 0.041233
Epoch 7
Loss = 1.8373e-01, PNorm = 34.5495, GNorm = 2.0951, lr_0 = 7.8581e-04
Validation rmse = 0.187272
Validation r2 = 0.754728
Validation mse = 0.035071
Epoch 8
Loss = 1.7263e-01, PNorm = 34.5898, GNorm = 1.5394, lr_0 = 7.6384e-04
Loss = 1.5915e-01, PNorm = 34.6275, GNorm = 0.7449, lr_0 = 7.4249e-04
Validation rmse = 0.178291
Validation r2 = 0.777691
Validation mse = 0.031788
Epoch 9
Loss = 1.5724e-01, PNorm = 34.6628, GNorm = 1.9841, lr_0 = 7.2173e-04
Validation rmse = 0.179065
Validation r2 = 0.775756
Validation mse = 0.032064
Epoch 10
Loss = 1.5474e-01, PNorm = 34.6925, GNorm = 3.0141, lr_0 = 7.0155e-04
Loss = 1.4657e-01, PNorm = 34.7241, GNorm = 3.1930, lr_0 = 6.8194e-04
Validation rmse = 0.170108
Validation r2 = 0.797627
Validation mse = 0.028937
Epoch 11
Loss = 1.2702e-01, PNorm = 34.7531, GNorm = 1.0381, lr_0 = 6.6099e-04
Validation rmse = 0.167778
Validation r2 = 0.803135
Validation mse = 0.028149
Epoch 12
Loss = 1.4951e-01, PNorm = 34.7831, GNorm = 5.6682, lr_0 = 6.4251e-04
Loss = 1.2384e-01, PNorm = 34.8094, GNorm = 2.4992, lr_0 = 6.2455e-04
Validation rmse = 0.161595
Validation r2 = 0.817378
Validation mse = 0.026113
Epoch 13
Loss = 1.2226e-01, PNorm = 34.8304, GNorm = 1.2876, lr_0 = 6.0709e-04
Validation rmse = 0.164561
Validation r2 = 0.810612
Validation mse = 0.027080
Epoch 14
Loss = 1.0092e-01, PNorm = 34.8518, GNorm = 0.7305, lr_0 = 5.9011e-04
Loss = 1.2560e-01, PNorm = 34.8766, GNorm = 0.7777, lr_0 = 5.7362e-04
Validation rmse = 0.169026
Validation r2 = 0.800195
Validation mse = 0.028570
Epoch 15
Loss = 1.4469e-01, PNorm = 34.8970, GNorm = 3.0308, lr_0 = 5.5758e-04
Validation rmse = 0.167934
Validation r2 = 0.802769
Validation mse = 0.028202
Epoch 16
Loss = 1.1349e-01, PNorm = 34.9194, GNorm = 4.9214, lr_0 = 5.4045e-04
Loss = 1.2370e-01, PNorm = 34.9410, GNorm = 0.7133, lr_0 = 5.2534e-04
Validation rmse = 0.162057
Validation r2 = 0.816332
Validation mse = 0.026262
Epoch 17
Loss = 1.0668e-01, PNorm = 34.9588, GNorm = 1.2806, lr_0 = 5.1066e-04
Validation rmse = 0.155335
Validation r2 = 0.831252
Validation mse = 0.024129
Epoch 18
Loss = 7.8596e-02, PNorm = 34.9735, GNorm = 1.3269, lr_0 = 4.9638e-04
Loss = 1.1603e-01, PNorm = 34.9921, GNorm = 2.0289, lr_0 = 4.8250e-04
Validation rmse = 0.159367
Validation r2 = 0.822377
Validation mse = 0.025398
Epoch 19
Loss = 9.6893e-02, PNorm = 35.0070, GNorm = 1.4923, lr_0 = 4.6901e-04
Validation rmse = 0.153783
Validation r2 = 0.834608
Validation mse = 0.023649
Epoch 20
Loss = 7.9384e-02, PNorm = 35.0207, GNorm = 0.4338, lr_0 = 4.5590e-04
Loss = 1.0976e-01, PNorm = 35.0356, GNorm = 1.8050, lr_0 = 4.4315e-04
Loss = 9.7875e-02, PNorm = 35.0369, GNorm = 1.7827, lr_0 = 4.4190e-04
Validation rmse = 0.157141
Validation r2 = 0.827305
Validation mse = 0.024693
Epoch 21
Loss = 9.7174e-02, PNorm = 35.0494, GNorm = 3.0060, lr_0 = 4.2954e-04
Validation rmse = 0.156516
Validation r2 = 0.828677
Validation mse = 0.024497
Epoch 22
Loss = 9.8275e-02, PNorm = 35.0636, GNorm = 1.8644, lr_0 = 4.1753e-04
Loss = 1.1040e-01, PNorm = 35.0748, GNorm = 2.8441, lr_0 = 4.0586e-04
Validation rmse = 0.156059
Validation r2 = 0.829676
Validation mse = 0.024354
Epoch 23
Loss = 9.5686e-02, PNorm = 35.0889, GNorm = 0.8325, lr_0 = 3.9451e-04
Validation rmse = 0.167496
Validation r2 = 0.803796
Validation mse = 0.028055
Epoch 24
Loss = 1.0023e-01, PNorm = 35.1013, GNorm = 2.5402, lr_0 = 3.8348e-04
Loss = 1.0991e-01, PNorm = 35.1142, GNorm = 3.1559, lr_0 = 3.7276e-04
Validation rmse = 0.162989
Validation r2 = 0.814213
Validation mse = 0.026565
Epoch 25
Loss = 9.8015e-02, PNorm = 35.1254, GNorm = 1.1240, lr_0 = 3.6234e-04
Validation rmse = 0.153236
Validation r2 = 0.835782
Validation mse = 0.023481
Epoch 26
Loss = 1.0323e-01, PNorm = 35.1365, GNorm = 1.4793, lr_0 = 3.5121e-04
Validation rmse = 0.152501
Validation r2 = 0.837353
Validation mse = 0.023257
Epoch 27
Loss = 6.8884e-02, PNorm = 35.1463, GNorm = 0.7345, lr_0 = 3.4139e-04
Loss = 8.7361e-02, PNorm = 35.1551, GNorm = 1.4155, lr_0 = 3.3185e-04
Validation rmse = 0.160452
Validation r2 = 0.819951
Validation mse = 0.025745
Epoch 28
Loss = 1.0663e-01, PNorm = 35.1665, GNorm = 3.2923, lr_0 = 3.2257e-04
Validation rmse = 0.153403
Validation r2 = 0.835424
Validation mse = 0.023532
Epoch 29
Loss = 9.5501e-02, PNorm = 35.1757, GNorm = 0.8821, lr_0 = 3.1355e-04
Loss = 9.0870e-02, PNorm = 35.1844, GNorm = 0.5337, lr_0 = 3.0478e-04
Validation rmse = 0.151359
Validation r2 = 0.839779
Validation mse = 0.022910
Epoch 30
Loss = 9.6513e-02, PNorm = 35.1935, GNorm = 0.7782, lr_0 = 2.9626e-04
Validation rmse = 0.154963
Validation r2 = 0.832060
Validation mse = 0.024013
Epoch 31
Loss = 7.9211e-02, PNorm = 35.2020, GNorm = 1.3797, lr_0 = 2.8716e-04
Loss = 8.3201e-02, PNorm = 35.2095, GNorm = 2.2979, lr_0 = 2.7913e-04
Validation rmse = 0.155146
Validation r2 = 0.831662
Validation mse = 0.024070
Epoch 32
Loss = 7.6042e-02, PNorm = 35.2181, GNorm = 1.0087, lr_0 = 2.7133e-04
Validation rmse = 0.152941
Validation r2 = 0.836413
Validation mse = 0.023391
Epoch 33
Loss = 8.5050e-02, PNorm = 35.2262, GNorm = 1.0307, lr_0 = 2.6374e-04
Loss = 8.8268e-02, PNorm = 35.2356, GNorm = 0.7764, lr_0 = 2.5637e-04
Validation rmse = 0.154375
Validation r2 = 0.833332
Validation mse = 0.023831
Epoch 34
Loss = 8.0552e-02, PNorm = 35.2418, GNorm = 0.8485, lr_0 = 2.4920e-04
Validation rmse = 0.158122
Validation r2 = 0.825142
Validation mse = 0.025003
Epoch 35
Loss = 7.3228e-02, PNorm = 35.2510, GNorm = 1.5837, lr_0 = 2.4223e-04
Loss = 8.6480e-02, PNorm = 35.2585, GNorm = 1.9751, lr_0 = 2.3546e-04
Validation rmse = 0.151639
Validation r2 = 0.839187
Validation mse = 0.022994
Epoch 36
Loss = 8.4444e-02, PNorm = 35.2678, GNorm = 2.6986, lr_0 = 2.2823e-04
Validation rmse = 0.156498
Validation r2 = 0.828716
Validation mse = 0.024492
Epoch 37
Loss = 8.1157e-02, PNorm = 35.2749, GNorm = 2.0533, lr_0 = 2.2185e-04
Loss = 8.9006e-02, PNorm = 35.2814, GNorm = 4.0291, lr_0 = 2.1565e-04
Validation rmse = 0.165733
Validation r2 = 0.807904
Validation mse = 0.027467
Epoch 38
Loss = 8.5953e-02, PNorm = 35.2877, GNorm = 1.8551, lr_0 = 2.0962e-04
Validation rmse = 0.156853
Validation r2 = 0.827937
Validation mse = 0.024603
Epoch 39
Loss = 8.2355e-02, PNorm = 35.2938, GNorm = 1.8843, lr_0 = 2.0376e-04
Loss = 8.2790e-02, PNorm = 35.3004, GNorm = 1.7689, lr_0 = 1.9806e-04
Validation rmse = 0.156148
Validation r2 = 0.829482
Validation mse = 0.024382
Epoch 40
Loss = 8.0585e-02, PNorm = 35.3069, GNorm = 2.3781, lr_0 = 1.9252e-04
Validation rmse = 0.153456
Validation r2 = 0.835310
Validation mse = 0.023549
Epoch 41
Loss = 9.3437e-02, PNorm = 35.3119, GNorm = 1.1387, lr_0 = 1.8661e-04
Loss = 6.6963e-02, PNorm = 35.3174, GNorm = 1.5441, lr_0 = 1.8139e-04
Validation rmse = 0.158207
Validation r2 = 0.824953
Validation mse = 0.025030
Epoch 42
Loss = 9.0418e-02, PNorm = 35.3228, GNorm = 1.3056, lr_0 = 1.7632e-04
Validation rmse = 0.160542
Validation r2 = 0.819750
Validation mse = 0.025774
Epoch 43
Loss = 7.4503e-02, PNorm = 35.3284, GNorm = 2.0894, lr_0 = 1.7139e-04
Loss = 8.8442e-02, PNorm = 35.3329, GNorm = 1.4642, lr_0 = 1.6660e-04
Validation rmse = 0.155067
Validation r2 = 0.831834
Validation mse = 0.024046
Epoch 44
Loss = 7.3506e-02, PNorm = 35.3369, GNorm = 0.8149, lr_0 = 1.6194e-04
Validation rmse = 0.157700
Validation r2 = 0.826073
Validation mse = 0.024869
Epoch 45
Loss = 7.9125e-02, PNorm = 35.3424, GNorm = 0.4939, lr_0 = 1.5741e-04
Loss = 7.2791e-02, PNorm = 35.3476, GNorm = 0.6317, lr_0 = 1.5301e-04
Loss = 9.6085e-02, PNorm = 35.3481, GNorm = 1.8868, lr_0 = 1.5258e-04
Validation rmse = 0.151547
Validation r2 = 0.839381
Validation mse = 0.022967
Epoch 46
Loss = 7.1695e-02, PNorm = 35.3529, GNorm = 1.0756, lr_0 = 1.4831e-04
Validation rmse = 0.153261
Validation r2 = 0.835729
Validation mse = 0.023489
Epoch 47
Loss = 7.6320e-02, PNorm = 35.3567, GNorm = 0.8369, lr_0 = 1.4417e-04
Loss = 7.1760e-02, PNorm = 35.3621, GNorm = 0.5914, lr_0 = 1.4014e-04
Validation rmse = 0.154136
Validation r2 = 0.833847
Validation mse = 0.023758
Epoch 48
Loss = 7.2429e-02, PNorm = 35.3663, GNorm = 1.5327, lr_0 = 1.3622e-04
Validation rmse = 0.155692
Validation r2 = 0.830476
Validation mse = 0.024240
Epoch 49
Loss = 7.5887e-02, PNorm = 35.3701, GNorm = 1.0315, lr_0 = 1.3241e-04
Loss = 7.1641e-02, PNorm = 35.3744, GNorm = 1.3837, lr_0 = 1.2871e-04
Validation rmse = 0.154575
Validation r2 = 0.832898
Validation mse = 0.023894
Epoch 50
Loss = 7.0330e-02, PNorm = 35.3775, GNorm = 0.8502, lr_0 = 1.2511e-04
Validation rmse = 0.155025
Validation r2 = 0.831925
Validation mse = 0.024033
Epoch 51
Loss = 7.4185e-02, PNorm = 35.3815, GNorm = 0.6211, lr_0 = 1.2127e-04
Validation rmse = 0.153165
Validation r2 = 0.835934
Validation mse = 0.023459
Epoch 52
Loss = 6.2240e-02, PNorm = 35.3858, GNorm = 0.8587, lr_0 = 1.1788e-04
Loss = 7.3803e-02, PNorm = 35.3900, GNorm = 0.6745, lr_0 = 1.1458e-04
Validation rmse = 0.153148
Validation r2 = 0.835971
Validation mse = 0.023454
Epoch 53
Loss = 6.1908e-02, PNorm = 35.3928, GNorm = 0.3821, lr_0 = 1.1138e-04
Validation rmse = 0.153865
Validation r2 = 0.834430
Validation mse = 0.023674
Epoch 54
Loss = 6.5169e-02, PNorm = 35.3964, GNorm = 1.9712, lr_0 = 1.0826e-04
Loss = 6.9174e-02, PNorm = 35.3998, GNorm = 1.1057, lr_0 = 1.0524e-04
Validation rmse = 0.152254
Validation r2 = 0.837879
Validation mse = 0.023181
Epoch 55
Loss = 8.1686e-02, PNorm = 35.4025, GNorm = 1.6447, lr_0 = 1.0229e-04
Validation rmse = 0.151559
Validation r2 = 0.839357
Validation mse = 0.022970
Epoch 56
Loss = 7.8754e-02, PNorm = 35.4061, GNorm = 0.5637, lr_0 = 1.0000e-04
Loss = 6.9308e-02, PNorm = 35.4090, GNorm = 0.8759, lr_0 = 1.0000e-04
Validation rmse = 0.152986
Validation r2 = 0.836318
Validation mse = 0.023405
Epoch 57
Loss = 6.4230e-02, PNorm = 35.4124, GNorm = 0.8770, lr_0 = 1.0000e-04
Validation rmse = 0.152314
Validation r2 = 0.837751
Validation mse = 0.023200
Epoch 58
Loss = 7.0162e-02, PNorm = 35.4153, GNorm = 0.8550, lr_0 = 1.0000e-04
Loss = 6.2666e-02, PNorm = 35.4188, GNorm = 0.7393, lr_0 = 1.0000e-04
Validation rmse = 0.153365
Validation r2 = 0.835505
Validation mse = 0.023521
Epoch 59
Loss = 7.5626e-02, PNorm = 35.4210, GNorm = 0.7590, lr_0 = 1.0000e-04
Validation rmse = 0.153542
Validation r2 = 0.835124
Validation mse = 0.023575
Model 0 best validation rmse = 0.151359 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.324839
Model 0 test r2 = -1.676608
Model 0 test mse = 0.105520
Ensemble test rmse = 0.324839
Ensemble test r2 = -1.676608
Ensemble test mse = 0.105520
Fold 1
Splitting data with seed 1
Total size = 926 | train size = 740 | val size = 186 | test size = 96
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1355e-01, PNorm = 34.0187, GNorm = 2.7760, lr_0 = 4.5357e-04
Validation rmse = 0.306917
Validation r2 = 0.215643
Validation mse = 0.094198
Epoch 1
Loss = 6.6254e-01, PNorm = 34.0576, GNorm = 1.4605, lr_0 = 8.0714e-04
Validation rmse = 0.234419
Validation r2 = 0.542432
Validation mse = 0.054952
Epoch 2
Loss = 5.6143e-01, PNorm = 34.1289, GNorm = 3.4776, lr_0 = 9.8872e-04
Loss = 6.5345e-01, PNorm = 34.1853, GNorm = 1.5761, lr_0 = 9.6108e-04
Validation rmse = 0.226878
Validation r2 = 0.571395
Validation mse = 0.051474
Epoch 3
Loss = 3.7138e-01, PNorm = 34.2594, GNorm = 1.9237, lr_0 = 9.3421e-04
Validation rmse = 0.201501
Validation r2 = 0.661913
Validation mse = 0.040603
Epoch 4
Loss = 5.4306e-01, PNorm = 34.3149, GNorm = 3.3543, lr_0 = 9.0809e-04
Loss = 3.1273e-01, PNorm = 34.3711, GNorm = 1.7338, lr_0 = 8.8270e-04
Validation rmse = 0.189272
Validation r2 = 0.701705
Validation mse = 0.035824
Epoch 5
Loss = 2.9662e-01, PNorm = 34.4134, GNorm = 1.2829, lr_0 = 8.5802e-04
Validation rmse = 0.215916
Validation r2 = 0.611813
Validation mse = 0.046620
Epoch 6
Loss = 3.1118e-01, PNorm = 34.4629, GNorm = 4.0161, lr_0 = 8.3167e-04
Loss = 2.4842e-01, PNorm = 34.4972, GNorm = 1.5376, lr_0 = 8.0842e-04
Validation rmse = 0.163243
Validation r2 = 0.778107
Validation mse = 0.026648
Epoch 7
Loss = 2.1392e-01, PNorm = 34.5351, GNorm = 2.7032, lr_0 = 7.8581e-04
Validation rmse = 0.176746
Validation r2 = 0.739882
Validation mse = 0.031239
Epoch 8
Loss = 2.8186e-01, PNorm = 34.5740, GNorm = 6.9061, lr_0 = 7.6384e-04
Loss = 2.0666e-01, PNorm = 34.6062, GNorm = 5.1416, lr_0 = 7.4249e-04
Validation rmse = 0.156494
Validation r2 = 0.796078
Validation mse = 0.024490
Epoch 9
Loss = 1.8679e-01, PNorm = 34.6438, GNorm = 0.7153, lr_0 = 7.2173e-04
Validation rmse = 0.147999
Validation r2 = 0.817615
Validation mse = 0.021904
Epoch 10
Loss = 1.4047e-01, PNorm = 34.6769, GNorm = 0.9212, lr_0 = 7.0155e-04
Loss = 1.3271e-01, PNorm = 34.7066, GNorm = 1.0832, lr_0 = 6.8194e-04
Validation rmse = 0.171563
Validation r2 = 0.754915
Validation mse = 0.029434
Epoch 11
Loss = 1.5952e-01, PNorm = 34.7418, GNorm = 5.0153, lr_0 = 6.6099e-04
Validation rmse = 0.143916
Validation r2 = 0.827539
Validation mse = 0.020712
Epoch 12
Loss = 1.8516e-01, PNorm = 34.7654, GNorm = 3.7906, lr_0 = 6.4251e-04
Loss = 1.2146e-01, PNorm = 34.7884, GNorm = 1.0485, lr_0 = 6.2455e-04
Validation rmse = 0.144058
Validation r2 = 0.827198
Validation mse = 0.020753
Epoch 13
Loss = 1.2753e-01, PNorm = 34.8153, GNorm = 2.2993, lr_0 = 6.0709e-04
Validation rmse = 0.156700
Validation r2 = 0.795540
Validation mse = 0.024555
Epoch 14
Loss = 1.2499e-01, PNorm = 34.8386, GNorm = 2.8020, lr_0 = 5.9011e-04
Loss = 1.4962e-01, PNorm = 34.8529, GNorm = 1.6171, lr_0 = 5.7362e-04
Validation rmse = 0.151249
Validation r2 = 0.809517
Validation mse = 0.022876
Epoch 15
Loss = 1.5107e-01, PNorm = 34.8734, GNorm = 4.4364, lr_0 = 5.5758e-04
Validation rmse = 0.146171
Validation r2 = 0.822091
Validation mse = 0.021366
Epoch 16
Loss = 1.1600e-01, PNorm = 34.8950, GNorm = 1.5450, lr_0 = 5.4045e-04
Loss = 1.1842e-01, PNorm = 34.9123, GNorm = 1.1143, lr_0 = 5.2534e-04
Validation rmse = 0.141396
Validation r2 = 0.833525
Validation mse = 0.019993
Epoch 17
Loss = 1.2059e-01, PNorm = 34.9277, GNorm = 1.9050, lr_0 = 5.1066e-04
Validation rmse = 0.148990
Validation r2 = 0.815163
Validation mse = 0.022198
Epoch 18
Loss = 9.4053e-02, PNorm = 34.9398, GNorm = 0.8347, lr_0 = 4.9638e-04
Loss = 1.2197e-01, PNorm = 34.9563, GNorm = 1.2859, lr_0 = 4.8250e-04
Validation rmse = 0.141155
Validation r2 = 0.834092
Validation mse = 0.019925
Epoch 19
Loss = 1.0954e-01, PNorm = 34.9718, GNorm = 4.1049, lr_0 = 4.6901e-04
Validation rmse = 0.142709
Validation r2 = 0.830420
Validation mse = 0.020366
Epoch 20
Loss = 1.0088e-01, PNorm = 34.9870, GNorm = 2.1660, lr_0 = 4.5590e-04
Loss = 1.0590e-01, PNorm = 35.0019, GNorm = 3.9395, lr_0 = 4.4315e-04
Loss = 8.0535e-02, PNorm = 35.0026, GNorm = 1.8416, lr_0 = 4.4190e-04
Validation rmse = 0.141626
Validation r2 = 0.832984
Validation mse = 0.020058
Epoch 21
Loss = 1.1132e-01, PNorm = 35.0151, GNorm = 2.2696, lr_0 = 4.2954e-04
Validation rmse = 0.139267
Validation r2 = 0.838503
Validation mse = 0.019395
Epoch 22
Loss = 1.0349e-01, PNorm = 35.0290, GNorm = 1.4464, lr_0 = 4.1753e-04
Loss = 9.5540e-02, PNorm = 35.0412, GNorm = 0.6716, lr_0 = 4.0586e-04
Validation rmse = 0.146034
Validation r2 = 0.822427
Validation mse = 0.021326
Epoch 23
Loss = 1.1096e-01, PNorm = 35.0530, GNorm = 1.5428, lr_0 = 3.9451e-04
Validation rmse = 0.140978
Validation r2 = 0.834510
Validation mse = 0.019875
Epoch 24
Loss = 1.0054e-01, PNorm = 35.0669, GNorm = 1.4124, lr_0 = 3.8348e-04
Loss = 1.0030e-01, PNorm = 35.0791, GNorm = 0.7138, lr_0 = 3.7276e-04
Validation rmse = 0.146328
Validation r2 = 0.821709
Validation mse = 0.021412
Epoch 25
Loss = 9.5343e-02, PNorm = 35.0895, GNorm = 0.9239, lr_0 = 3.6234e-04
Validation rmse = 0.139562
Validation r2 = 0.837816
Validation mse = 0.019478
Epoch 26
Loss = 9.3222e-02, PNorm = 35.1006, GNorm = 1.8771, lr_0 = 3.5121e-04
Validation rmse = 0.137149
Validation r2 = 0.843376
Validation mse = 0.018810
Epoch 27
Loss = 7.2928e-02, PNorm = 35.1109, GNorm = 1.2943, lr_0 = 3.4139e-04
Loss = 9.4834e-02, PNorm = 35.1189, GNorm = 0.9378, lr_0 = 3.3185e-04
Validation rmse = 0.146153
Validation r2 = 0.822136
Validation mse = 0.021361
Epoch 28
Loss = 9.8783e-02, PNorm = 35.1272, GNorm = 1.0626, lr_0 = 3.2257e-04
Validation rmse = 0.142589
Validation r2 = 0.830704
Validation mse = 0.020332
Epoch 29
Loss = 8.2454e-02, PNorm = 35.1365, GNorm = 2.6352, lr_0 = 3.1355e-04
Loss = 8.6103e-02, PNorm = 35.1471, GNorm = 1.5563, lr_0 = 3.0478e-04
Validation rmse = 0.137810
Validation r2 = 0.841864
Validation mse = 0.018992
Epoch 30
Loss = 9.0015e-02, PNorm = 35.1571, GNorm = 0.3848, lr_0 = 2.9626e-04
Validation rmse = 0.139374
Validation r2 = 0.838253
Validation mse = 0.019425
Epoch 31
Loss = 1.1607e-01, PNorm = 35.1665, GNorm = 2.5417, lr_0 = 2.8716e-04
Loss = 8.1140e-02, PNorm = 35.1725, GNorm = 0.9316, lr_0 = 2.7913e-04
Validation rmse = 0.138833
Validation r2 = 0.839506
Validation mse = 0.019275
Epoch 32
Loss = 8.7285e-02, PNorm = 35.1813, GNorm = 1.3701, lr_0 = 2.7133e-04
Validation rmse = 0.138790
Validation r2 = 0.839606
Validation mse = 0.019263
Epoch 33
Loss = 8.4582e-02, PNorm = 35.1898, GNorm = 0.9538, lr_0 = 2.6374e-04
Loss = 8.0850e-02, PNorm = 35.1966, GNorm = 1.9709, lr_0 = 2.5637e-04
Validation rmse = 0.137526
Validation r2 = 0.842515
Validation mse = 0.018913
Epoch 34
Loss = 8.2311e-02, PNorm = 35.2043, GNorm = 1.4482, lr_0 = 2.4920e-04
Validation rmse = 0.137112
Validation r2 = 0.843461
Validation mse = 0.018800
Epoch 35
Loss = 6.6632e-02, PNorm = 35.2116, GNorm = 1.3483, lr_0 = 2.4223e-04
Loss = 8.7352e-02, PNorm = 35.2194, GNorm = 1.0910, lr_0 = 2.3546e-04
Validation rmse = 0.136368
Validation r2 = 0.845155
Validation mse = 0.018596
Epoch 36
Loss = 8.1587e-02, PNorm = 35.2267, GNorm = 0.8203, lr_0 = 2.2823e-04
Validation rmse = 0.139980
Validation r2 = 0.836844
Validation mse = 0.019594
Epoch 37
Loss = 6.7444e-02, PNorm = 35.2339, GNorm = 0.6707, lr_0 = 2.2185e-04
Loss = 8.7138e-02, PNorm = 35.2412, GNorm = 3.0764, lr_0 = 2.1565e-04
Validation rmse = 0.135665
Validation r2 = 0.846747
Validation mse = 0.018405
Epoch 38
Loss = 7.6473e-02, PNorm = 35.2469, GNorm = 0.8779, lr_0 = 2.0962e-04
Validation rmse = 0.143631
Validation r2 = 0.828221
Validation mse = 0.020630
Epoch 39
Loss = 1.0599e-01, PNorm = 35.2543, GNorm = 0.9377, lr_0 = 2.0376e-04
Loss = 7.4003e-02, PNorm = 35.2613, GNorm = 3.4425, lr_0 = 1.9806e-04
Validation rmse = 0.135769
Validation r2 = 0.846513
Validation mse = 0.018433
Epoch 40
Loss = 7.9485e-02, PNorm = 35.2651, GNorm = 1.6413, lr_0 = 1.9252e-04
Validation rmse = 0.137715
Validation r2 = 0.842082
Validation mse = 0.018965
Epoch 41
Loss = 8.0492e-02, PNorm = 35.2714, GNorm = 1.2748, lr_0 = 1.8661e-04
Loss = 8.2099e-02, PNorm = 35.2773, GNorm = 1.8551, lr_0 = 1.8139e-04
Validation rmse = 0.135889
Validation r2 = 0.846241
Validation mse = 0.018466
Epoch 42
Loss = 8.0882e-02, PNorm = 35.2823, GNorm = 0.5953, lr_0 = 1.7632e-04
Validation rmse = 0.134585
Validation r2 = 0.849179
Validation mse = 0.018113
Epoch 43
Loss = 7.8411e-02, PNorm = 35.2875, GNorm = 0.7136, lr_0 = 1.7139e-04
Loss = 7.4525e-02, PNorm = 35.2925, GNorm = 1.5403, lr_0 = 1.6660e-04
Validation rmse = 0.135125
Validation r2 = 0.847965
Validation mse = 0.018259
Epoch 44
Loss = 7.3185e-02, PNorm = 35.2982, GNorm = 1.9479, lr_0 = 1.6194e-04
Validation rmse = 0.134797
Validation r2 = 0.848701
Validation mse = 0.018170
Epoch 45
Loss = 8.4188e-02, PNorm = 35.3030, GNorm = 2.3624, lr_0 = 1.5741e-04
Loss = 7.6790e-02, PNorm = 35.3072, GNorm = 1.6073, lr_0 = 1.5301e-04
Loss = 6.8334e-02, PNorm = 35.3078, GNorm = 1.2777, lr_0 = 1.5258e-04
Validation rmse = 0.135012
Validation r2 = 0.848220
Validation mse = 0.018228
Epoch 46
Loss = 7.2984e-02, PNorm = 35.3125, GNorm = 0.4272, lr_0 = 1.4831e-04
Validation rmse = 0.134431
Validation r2 = 0.849523
Validation mse = 0.018072
Epoch 47
Loss = 6.9745e-02, PNorm = 35.3164, GNorm = 1.2864, lr_0 = 1.4417e-04
Loss = 7.9890e-02, PNorm = 35.3205, GNorm = 1.0766, lr_0 = 1.4014e-04
Validation rmse = 0.134272
Validation r2 = 0.849878
Validation mse = 0.018029
Epoch 48
Loss = 7.3337e-02, PNorm = 35.3242, GNorm = 1.5612, lr_0 = 1.3622e-04
Validation rmse = 0.135112
Validation r2 = 0.847995
Validation mse = 0.018255
Epoch 49
Loss = 5.8372e-02, PNorm = 35.3293, GNorm = 1.5819, lr_0 = 1.3241e-04
Loss = 8.3361e-02, PNorm = 35.3335, GNorm = 1.6502, lr_0 = 1.2871e-04
Validation rmse = 0.134479
Validation r2 = 0.849416
Validation mse = 0.018084
Epoch 50
Loss = 7.0589e-02, PNorm = 35.3374, GNorm = 1.4663, lr_0 = 1.2511e-04
Validation rmse = 0.133889
Validation r2 = 0.850733
Validation mse = 0.017926
Epoch 51
Loss = 7.8306e-02, PNorm = 35.3406, GNorm = 0.7114, lr_0 = 1.2127e-04
Validation rmse = 0.135514
Validation r2 = 0.847088
Validation mse = 0.018364
Epoch 52
Loss = 7.3226e-02, PNorm = 35.3444, GNorm = 1.5042, lr_0 = 1.1788e-04
Loss = 7.0489e-02, PNorm = 35.3477, GNorm = 1.0076, lr_0 = 1.1458e-04
Validation rmse = 0.133544
Validation r2 = 0.851502
Validation mse = 0.017834
Epoch 53
Loss = 7.5447e-02, PNorm = 35.3516, GNorm = 0.8960, lr_0 = 1.1138e-04
Validation rmse = 0.134817
Validation r2 = 0.848657
Validation mse = 0.018176
Epoch 54
Loss = 4.2897e-02, PNorm = 35.3546, GNorm = 0.6602, lr_0 = 1.0826e-04
Loss = 7.2777e-02, PNorm = 35.3571, GNorm = 1.2923, lr_0 = 1.0524e-04
Validation rmse = 0.133194
Validation r2 = 0.852279
Validation mse = 0.017741
Epoch 55
Loss = 7.6219e-02, PNorm = 35.3607, GNorm = 1.8260, lr_0 = 1.0229e-04
Validation rmse = 0.134099
Validation r2 = 0.850265
Validation mse = 0.017983
Epoch 56
Loss = 6.3784e-02, PNorm = 35.3641, GNorm = 0.4830, lr_0 = 1.0000e-04
Loss = 7.9519e-02, PNorm = 35.3670, GNorm = 1.6027, lr_0 = 1.0000e-04
Validation rmse = 0.138431
Validation r2 = 0.840434
Validation mse = 0.019163
Epoch 57
Loss = 7.3672e-02, PNorm = 35.3698, GNorm = 2.8730, lr_0 = 1.0000e-04
Validation rmse = 0.135276
Validation r2 = 0.847626
Validation mse = 0.018299
Epoch 58
Loss = 8.2063e-02, PNorm = 35.3726, GNorm = 1.6026, lr_0 = 1.0000e-04
Loss = 7.5357e-02, PNorm = 35.3760, GNorm = 1.8545, lr_0 = 1.0000e-04
Validation rmse = 0.134458
Validation r2 = 0.849463
Validation mse = 0.018079
Epoch 59
Loss = 7.2435e-02, PNorm = 35.3789, GNorm = 0.8343, lr_0 = 1.0000e-04
Validation rmse = 0.133339
Validation r2 = 0.851957
Validation mse = 0.017779
Model 0 best validation rmse = 0.133194 on epoch 54
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.300707
Model 0 test r2 = -1.293692
Model 0 test mse = 0.090425
Ensemble test rmse = 0.300707
Ensemble test r2 = -1.293692
Ensemble test mse = 0.090425
Fold 2
Splitting data with seed 2
Total size = 926 | train size = 740 | val size = 186 | test size = 96
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.5751e-01, PNorm = 34.0177, GNorm = 11.0455, lr_0 = 4.5357e-04
Validation rmse = 0.326294
Validation r2 = 0.187851
Validation mse = 0.106468
Epoch 1
Loss = 8.8260e-01, PNorm = 34.0463, GNorm = 12.3551, lr_0 = 8.0714e-04
Validation rmse = 0.267892
Validation r2 = 0.452563
Validation mse = 0.071766
Epoch 2
Loss = 6.3405e-01, PNorm = 34.1033, GNorm = 5.0545, lr_0 = 9.8872e-04
Loss = 6.0327e-01, PNorm = 34.1739, GNorm = 2.6436, lr_0 = 9.6108e-04
Validation rmse = 0.247722
Validation r2 = 0.531893
Validation mse = 0.061366
Epoch 3
Loss = 4.7171e-01, PNorm = 34.2473, GNorm = 3.0357, lr_0 = 9.3421e-04
Validation rmse = 0.206861
Validation r2 = 0.673581
Validation mse = 0.042792
Epoch 4
Loss = 3.8542e-01, PNorm = 34.3202, GNorm = 6.5267, lr_0 = 9.0809e-04
Loss = 3.4139e-01, PNorm = 34.3796, GNorm = 1.0102, lr_0 = 8.8270e-04
Validation rmse = 0.205514
Validation r2 = 0.677819
Validation mse = 0.042236
Epoch 5
Loss = 2.8091e-01, PNorm = 34.4411, GNorm = 2.1774, lr_0 = 8.5802e-04
Validation rmse = 0.168917
Validation r2 = 0.782348
Validation mse = 0.028533
Epoch 6
Loss = 3.2627e-01, PNorm = 34.5017, GNorm = 0.7975, lr_0 = 8.3167e-04
Loss = 2.5064e-01, PNorm = 34.5564, GNorm = 2.7311, lr_0 = 8.0842e-04
Validation rmse = 0.158762
Validation r2 = 0.807731
Validation mse = 0.025205
Epoch 7
Loss = 1.9083e-01, PNorm = 34.6061, GNorm = 3.4391, lr_0 = 7.8581e-04
Validation rmse = 0.147051
Validation r2 = 0.835050
Validation mse = 0.021624
Epoch 8
Loss = 1.5222e-01, PNorm = 34.6453, GNorm = 0.7524, lr_0 = 7.6384e-04
Loss = 1.7857e-01, PNorm = 34.6921, GNorm = 1.3954, lr_0 = 7.4249e-04
Validation rmse = 0.148980
Validation r2 = 0.830693
Validation mse = 0.022195
Epoch 9
Loss = 1.8035e-01, PNorm = 34.7305, GNorm = 2.9616, lr_0 = 7.2173e-04
Validation rmse = 0.130853
Validation r2 = 0.869389
Validation mse = 0.017122
Epoch 10
Loss = 1.2925e-01, PNorm = 34.7650, GNorm = 0.7561, lr_0 = 7.0155e-04
Loss = 1.5454e-01, PNorm = 34.7985, GNorm = 0.7014, lr_0 = 6.8194e-04
Validation rmse = 0.124924
Validation r2 = 0.880955
Validation mse = 0.015606
Epoch 11
Loss = 1.5198e-01, PNorm = 34.8307, GNorm = 3.6248, lr_0 = 6.6099e-04
Validation rmse = 0.124000
Validation r2 = 0.882710
Validation mse = 0.015376
Epoch 12
Loss = 1.6840e-01, PNorm = 34.8558, GNorm = 2.3755, lr_0 = 6.4251e-04
Loss = 1.2825e-01, PNorm = 34.8800, GNorm = 3.4512, lr_0 = 6.2455e-04
Validation rmse = 0.121933
Validation r2 = 0.886589
Validation mse = 0.014868
Epoch 13
Loss = 1.3362e-01, PNorm = 34.9052, GNorm = 1.7960, lr_0 = 6.0709e-04
Validation rmse = 0.130457
Validation r2 = 0.870176
Validation mse = 0.017019
Epoch 14
Loss = 1.4256e-01, PNorm = 34.9263, GNorm = 3.0487, lr_0 = 5.9011e-04
Loss = 1.3127e-01, PNorm = 34.9466, GNorm = 2.0055, lr_0 = 5.7362e-04
Validation rmse = 0.124488
Validation r2 = 0.881786
Validation mse = 0.015497
Epoch 15
Loss = 1.1350e-01, PNorm = 34.9682, GNorm = 1.2998, lr_0 = 5.5758e-04
Validation rmse = 0.131168
Validation r2 = 0.868758
Validation mse = 0.017205
Epoch 16
Loss = 1.6275e-01, PNorm = 34.9868, GNorm = 4.4921, lr_0 = 5.4045e-04
Loss = 1.3178e-01, PNorm = 35.0067, GNorm = 2.4878, lr_0 = 5.2534e-04
Validation rmse = 0.117718
Validation r2 = 0.894294
Validation mse = 0.013857
Epoch 17
Loss = 1.1672e-01, PNorm = 35.0246, GNorm = 0.9640, lr_0 = 5.1066e-04
Validation rmse = 0.115762
Validation r2 = 0.897777
Validation mse = 0.013401
Epoch 18
Loss = 1.0926e-01, PNorm = 35.0419, GNorm = 3.3183, lr_0 = 4.9638e-04
Loss = 1.1848e-01, PNorm = 35.0556, GNorm = 2.8004, lr_0 = 4.8250e-04
Validation rmse = 0.120846
Validation r2 = 0.888602
Validation mse = 0.014604
Epoch 19
Loss = 1.0818e-01, PNorm = 35.0708, GNorm = 2.1192, lr_0 = 4.6901e-04
Validation rmse = 0.117190
Validation r2 = 0.895240
Validation mse = 0.013733
Epoch 20
Loss = 1.1776e-01, PNorm = 35.0849, GNorm = 3.4366, lr_0 = 4.5590e-04
Loss = 1.1366e-01, PNorm = 35.1013, GNorm = 1.5842, lr_0 = 4.4315e-04
Loss = 1.1641e-01, PNorm = 35.1026, GNorm = 4.2476, lr_0 = 4.4190e-04
Validation rmse = 0.127946
Validation r2 = 0.875126
Validation mse = 0.016370
Epoch 21
Loss = 1.1809e-01, PNorm = 35.1141, GNorm = 1.3805, lr_0 = 4.2954e-04
Validation rmse = 0.121367
Validation r2 = 0.887638
Validation mse = 0.014730
Epoch 22
Loss = 1.1290e-01, PNorm = 35.1291, GNorm = 4.1367, lr_0 = 4.1753e-04
Loss = 1.1760e-01, PNorm = 35.1474, GNorm = 2.7468, lr_0 = 4.0586e-04
Validation rmse = 0.127709
Validation r2 = 0.875589
Validation mse = 0.016310
Epoch 23
Loss = 9.8266e-02, PNorm = 35.1585, GNorm = 1.1161, lr_0 = 3.9451e-04
Validation rmse = 0.116949
Validation r2 = 0.895671
Validation mse = 0.013677
Epoch 24
Loss = 8.9688e-02, PNorm = 35.1719, GNorm = 1.2405, lr_0 = 3.8348e-04
Loss = 1.1209e-01, PNorm = 35.1889, GNorm = 1.4729, lr_0 = 3.7276e-04
Validation rmse = 0.111584
Validation r2 = 0.905023
Validation mse = 0.012451
Epoch 25
Loss = 1.0580e-01, PNorm = 35.2022, GNorm = 0.7531, lr_0 = 3.6234e-04
Validation rmse = 0.112409
Validation r2 = 0.903612
Validation mse = 0.012636
Epoch 26
Loss = 1.1132e-01, PNorm = 35.2133, GNorm = 0.5930, lr_0 = 3.5121e-04
Validation rmse = 0.113473
Validation r2 = 0.901780
Validation mse = 0.012876
Epoch 27
Loss = 1.0815e-01, PNorm = 35.2263, GNorm = 1.9456, lr_0 = 3.4139e-04
Loss = 1.0470e-01, PNorm = 35.2395, GNorm = 0.8748, lr_0 = 3.3185e-04
Validation rmse = 0.113278
Validation r2 = 0.902116
Validation mse = 0.012832
Epoch 28
Loss = 1.0574e-01, PNorm = 35.2510, GNorm = 3.5560, lr_0 = 3.2257e-04
Validation rmse = 0.116541
Validation r2 = 0.896396
Validation mse = 0.013582
Epoch 29
Loss = 8.0237e-02, PNorm = 35.2624, GNorm = 1.5884, lr_0 = 3.1355e-04
Loss = 1.0341e-01, PNorm = 35.2729, GNorm = 0.7115, lr_0 = 3.0478e-04
Validation rmse = 0.112096
Validation r2 = 0.904148
Validation mse = 0.012566
Epoch 30
Loss = 9.2908e-02, PNorm = 35.2837, GNorm = 1.1812, lr_0 = 2.9626e-04
Validation rmse = 0.116944
Validation r2 = 0.895679
Validation mse = 0.013676
Epoch 31
Loss = 1.0616e-01, PNorm = 35.2952, GNorm = 1.2516, lr_0 = 2.8716e-04
Loss = 9.7432e-02, PNorm = 35.3037, GNorm = 1.1014, lr_0 = 2.7913e-04
Validation rmse = 0.110476
Validation r2 = 0.906899
Validation mse = 0.012205
Epoch 32
Loss = 9.7221e-02, PNorm = 35.3126, GNorm = 2.8126, lr_0 = 2.7133e-04
Validation rmse = 0.114345
Validation r2 = 0.900265
Validation mse = 0.013075
Epoch 33
Loss = 9.8363e-02, PNorm = 35.3224, GNorm = 2.8632, lr_0 = 2.6374e-04
Loss = 9.0131e-02, PNorm = 35.3314, GNorm = 1.5351, lr_0 = 2.5637e-04
Validation rmse = 0.110007
Validation r2 = 0.907688
Validation mse = 0.012102
Epoch 34
Loss = 9.4941e-02, PNorm = 35.3404, GNorm = 0.7968, lr_0 = 2.4920e-04
Validation rmse = 0.109974
Validation r2 = 0.907743
Validation mse = 0.012094
Epoch 35
Loss = 5.5201e-02, PNorm = 35.3492, GNorm = 1.6665, lr_0 = 2.4223e-04
Loss = 8.8385e-02, PNorm = 35.3558, GNorm = 0.8783, lr_0 = 2.3546e-04
Validation rmse = 0.120292
Validation r2 = 0.889620
Validation mse = 0.014470
Epoch 36
Loss = 8.4819e-02, PNorm = 35.3665, GNorm = 0.5916, lr_0 = 2.2823e-04
Validation rmse = 0.109443
Validation r2 = 0.908632
Validation mse = 0.011978
Epoch 37
Loss = 1.0242e-01, PNorm = 35.3753, GNorm = 0.7125, lr_0 = 2.2185e-04
Loss = 8.0993e-02, PNorm = 35.3843, GNorm = 0.7850, lr_0 = 2.1565e-04
Validation rmse = 0.109329
Validation r2 = 0.908822
Validation mse = 0.011953
Epoch 38
Loss = 8.3883e-02, PNorm = 35.3914, GNorm = 1.1289, lr_0 = 2.0962e-04
Validation rmse = 0.112400
Validation r2 = 0.903628
Validation mse = 0.012634
Epoch 39
Loss = 9.2785e-02, PNorm = 35.3989, GNorm = 0.6733, lr_0 = 2.0376e-04
Loss = 8.1100e-02, PNorm = 35.4060, GNorm = 0.4628, lr_0 = 1.9806e-04
Validation rmse = 0.109842
Validation r2 = 0.907965
Validation mse = 0.012065
Epoch 40
Loss = 8.3200e-02, PNorm = 35.4107, GNorm = 1.9353, lr_0 = 1.9252e-04
Validation rmse = 0.113842
Validation r2 = 0.901140
Validation mse = 0.012960
Epoch 41
Loss = 8.5297e-02, PNorm = 35.4182, GNorm = 1.1597, lr_0 = 1.8661e-04
Loss = 9.6692e-02, PNorm = 35.4253, GNorm = 2.7854, lr_0 = 1.8139e-04
Validation rmse = 0.112113
Validation r2 = 0.904121
Validation mse = 0.012569
Epoch 42
Loss = 8.9043e-02, PNorm = 35.4325, GNorm = 1.0730, lr_0 = 1.7632e-04
Validation rmse = 0.108608
Validation r2 = 0.910021
Validation mse = 0.011796
Epoch 43
Loss = 8.3514e-02, PNorm = 35.4391, GNorm = 1.3920, lr_0 = 1.7139e-04
Loss = 8.2800e-02, PNorm = 35.4442, GNorm = 1.7595, lr_0 = 1.6660e-04
Validation rmse = 0.112385
Validation r2 = 0.903655
Validation mse = 0.012630
Epoch 44
Loss = 8.6825e-02, PNorm = 35.4514, GNorm = 0.6836, lr_0 = 1.6194e-04
Validation rmse = 0.107911
Validation r2 = 0.911172
Validation mse = 0.011645
Epoch 45
Loss = 8.1297e-02, PNorm = 35.4569, GNorm = 0.5514, lr_0 = 1.5741e-04
Loss = 8.1677e-02, PNorm = 35.4625, GNorm = 1.6007, lr_0 = 1.5301e-04
Loss = 6.2913e-02, PNorm = 35.4632, GNorm = 1.0820, lr_0 = 1.5258e-04
Validation rmse = 0.107818
Validation r2 = 0.911326
Validation mse = 0.011625
Epoch 46
Loss = 7.7182e-02, PNorm = 35.4673, GNorm = 0.7351, lr_0 = 1.4831e-04
Validation rmse = 0.107709
Validation r2 = 0.911505
Validation mse = 0.011601
Epoch 47
Loss = 9.2158e-02, PNorm = 35.4722, GNorm = 1.3381, lr_0 = 1.4417e-04
Loss = 6.9075e-02, PNorm = 35.4777, GNorm = 1.6348, lr_0 = 1.4014e-04
Validation rmse = 0.108997
Validation r2 = 0.909375
Validation mse = 0.011880
Epoch 48
Loss = 7.6214e-02, PNorm = 35.4824, GNorm = 1.8382, lr_0 = 1.3622e-04
Validation rmse = 0.107658
Validation r2 = 0.911589
Validation mse = 0.011590
Epoch 49
Loss = 6.4260e-02, PNorm = 35.4880, GNorm = 0.7611, lr_0 = 1.3241e-04
Loss = 8.2905e-02, PNorm = 35.4923, GNorm = 0.9034, lr_0 = 1.2871e-04
Validation rmse = 0.107832
Validation r2 = 0.911303
Validation mse = 0.011628
Epoch 50
Loss = 8.6160e-02, PNorm = 35.4964, GNorm = 1.6917, lr_0 = 1.2511e-04
Validation rmse = 0.108730
Validation r2 = 0.909819
Validation mse = 0.011822
Epoch 51
Loss = 7.4824e-02, PNorm = 35.5017, GNorm = 1.6347, lr_0 = 1.2127e-04
Validation rmse = 0.107611
Validation r2 = 0.911665
Validation mse = 0.011580
Epoch 52
Loss = 9.9637e-02, PNorm = 35.5065, GNorm = 1.0734, lr_0 = 1.1788e-04
Loss = 7.0368e-02, PNorm = 35.5104, GNorm = 0.7410, lr_0 = 1.1458e-04
Validation rmse = 0.108847
Validation r2 = 0.909625
Validation mse = 0.011848
Epoch 53
Loss = 8.0740e-02, PNorm = 35.5137, GNorm = 0.9601, lr_0 = 1.1138e-04
Validation rmse = 0.106702
Validation r2 = 0.913152
Validation mse = 0.011385
Epoch 54
Loss = 6.0739e-02, PNorm = 35.5180, GNorm = 0.5771, lr_0 = 1.0826e-04
Loss = 7.8744e-02, PNorm = 35.5225, GNorm = 0.7995, lr_0 = 1.0524e-04
Validation rmse = 0.109269
Validation r2 = 0.908923
Validation mse = 0.011940
Epoch 55
Loss = 7.3796e-02, PNorm = 35.5253, GNorm = 1.4247, lr_0 = 1.0229e-04
Validation rmse = 0.107272
Validation r2 = 0.912222
Validation mse = 0.011507
Epoch 56
Loss = 7.6976e-02, PNorm = 35.5296, GNorm = 0.6295, lr_0 = 1.0000e-04
Loss = 7.4236e-02, PNorm = 35.5329, GNorm = 1.6216, lr_0 = 1.0000e-04
Validation rmse = 0.108784
Validation r2 = 0.909730
Validation mse = 0.011834
Epoch 57
Loss = 6.9497e-02, PNorm = 35.5369, GNorm = 0.4382, lr_0 = 1.0000e-04
Validation rmse = 0.112341
Validation r2 = 0.903730
Validation mse = 0.012620
Epoch 58
Loss = 7.4940e-02, PNorm = 35.5397, GNorm = 1.3324, lr_0 = 1.0000e-04
Loss = 7.6959e-02, PNorm = 35.5433, GNorm = 0.7649, lr_0 = 1.0000e-04
Validation rmse = 0.110092
Validation r2 = 0.907546
Validation mse = 0.012120
Epoch 59
Loss = 6.4067e-02, PNorm = 35.5474, GNorm = 1.5207, lr_0 = 1.0000e-04
Validation rmse = 0.107685
Validation r2 = 0.911543
Validation mse = 0.011596
Model 0 best validation rmse = 0.106702 on epoch 53
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.289108
Model 0 test r2 = -1.120157
Model 0 test mse = 0.083583
Ensemble test rmse = 0.289108
Ensemble test r2 = -1.120157
Ensemble test mse = 0.083583
Fold 3
Splitting data with seed 3
Total size = 926 | train size = 740 | val size = 186 | test size = 96
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1255e-01, PNorm = 34.0190, GNorm = 2.3546, lr_0 = 4.5357e-04
Validation rmse = 0.277568
Validation r2 = 0.331043
Validation mse = 0.077044
Epoch 1
Loss = 6.9604e-01, PNorm = 34.0516, GNorm = 3.7117, lr_0 = 8.0714e-04
Validation rmse = 0.268089
Validation r2 = 0.375952
Validation mse = 0.071872
Epoch 2
Loss = 6.7732e-01, PNorm = 34.1170, GNorm = 7.6165, lr_0 = 9.8872e-04
Loss = 4.4087e-01, PNorm = 34.1963, GNorm = 4.4211, lr_0 = 9.6108e-04
Validation rmse = 0.204233
Validation r2 = 0.637830
Validation mse = 0.041711
Epoch 3
Loss = 3.3672e-01, PNorm = 34.2782, GNorm = 2.8087, lr_0 = 9.3421e-04
Validation rmse = 0.228349
Validation r2 = 0.547252
Validation mse = 0.052143
Epoch 4
Loss = 4.3930e-01, PNorm = 34.3459, GNorm = 7.6392, lr_0 = 9.0809e-04
Loss = 3.4135e-01, PNorm = 34.4032, GNorm = 5.9412, lr_0 = 8.8270e-04
Validation rmse = 0.196394
Validation r2 = 0.665098
Validation mse = 0.038571
Epoch 5
Loss = 2.7228e-01, PNorm = 34.4559, GNorm = 1.3494, lr_0 = 8.5802e-04
Validation rmse = 0.158867
Validation r2 = 0.780857
Validation mse = 0.025239
Epoch 6
Loss = 1.4384e-01, PNorm = 34.5136, GNorm = 1.1520, lr_0 = 8.3167e-04
Loss = 2.1059e-01, PNorm = 34.5580, GNorm = 1.6593, lr_0 = 8.0842e-04
Validation rmse = 0.157480
Validation r2 = 0.784666
Validation mse = 0.024800
Epoch 7
Loss = 1.9111e-01, PNorm = 34.5978, GNorm = 4.9101, lr_0 = 7.8581e-04
Validation rmse = 0.153607
Validation r2 = 0.795128
Validation mse = 0.023595
Epoch 8
Loss = 1.5325e-01, PNorm = 34.6391, GNorm = 1.3900, lr_0 = 7.6384e-04
Loss = 1.6614e-01, PNorm = 34.6748, GNorm = 2.9986, lr_0 = 7.4249e-04
Validation rmse = 0.148408
Validation r2 = 0.808761
Validation mse = 0.022025
Epoch 9
Loss = 1.2453e-01, PNorm = 34.7084, GNorm = 1.5042, lr_0 = 7.2173e-04
Validation rmse = 0.133266
Validation r2 = 0.845796
Validation mse = 0.017760
Epoch 10
Loss = 1.4328e-01, PNorm = 34.7364, GNorm = 4.4121, lr_0 = 7.0155e-04
Loss = 1.6533e-01, PNorm = 34.7616, GNorm = 1.5709, lr_0 = 6.8194e-04
Validation rmse = 0.133765
Validation r2 = 0.844637
Validation mse = 0.017893
Epoch 11
Loss = 1.4081e-01, PNorm = 34.7957, GNorm = 0.8591, lr_0 = 6.6099e-04
Validation rmse = 0.129134
Validation r2 = 0.855209
Validation mse = 0.016676
Epoch 12
Loss = 1.5063e-01, PNorm = 34.8206, GNorm = 2.7338, lr_0 = 6.4251e-04
Loss = 1.2919e-01, PNorm = 34.8446, GNorm = 1.7913, lr_0 = 6.2455e-04
Validation rmse = 0.126696
Validation r2 = 0.860624
Validation mse = 0.016052
Epoch 13
Loss = 1.1658e-01, PNorm = 34.8610, GNorm = 1.5892, lr_0 = 6.0709e-04
Validation rmse = 0.130945
Validation r2 = 0.851120
Validation mse = 0.017147
Epoch 14
Loss = 1.3011e-01, PNorm = 34.8820, GNorm = 0.7750, lr_0 = 5.9011e-04
Loss = 1.3100e-01, PNorm = 34.9012, GNorm = 2.8461, lr_0 = 5.7362e-04
Validation rmse = 0.149076
Validation r2 = 0.807036
Validation mse = 0.022224
Epoch 15
Loss = 1.4861e-01, PNorm = 34.9145, GNorm = 4.9166, lr_0 = 5.5758e-04
Validation rmse = 0.139656
Validation r2 = 0.830652
Validation mse = 0.019504
Epoch 16
Loss = 1.3234e-01, PNorm = 34.9391, GNorm = 2.0638, lr_0 = 5.4045e-04
Loss = 1.1779e-01, PNorm = 34.9549, GNorm = 1.7435, lr_0 = 5.2534e-04
Validation rmse = 0.126265
Validation r2 = 0.861571
Validation mse = 0.015943
Epoch 17
Loss = 1.1545e-01, PNorm = 34.9737, GNorm = 0.7678, lr_0 = 5.1066e-04
Validation rmse = 0.122179
Validation r2 = 0.870386
Validation mse = 0.014928
Epoch 18
Loss = 1.3807e-01, PNorm = 34.9906, GNorm = 3.8774, lr_0 = 4.9638e-04
Loss = 1.0349e-01, PNorm = 35.0052, GNorm = 1.1437, lr_0 = 4.8250e-04
Validation rmse = 0.134809
Validation r2 = 0.842204
Validation mse = 0.018173
Epoch 19
Loss = 1.1947e-01, PNorm = 35.0184, GNorm = 3.6468, lr_0 = 4.6901e-04
Validation rmse = 0.133638
Validation r2 = 0.844933
Validation mse = 0.017859
Epoch 20
Loss = 1.0127e-01, PNorm = 35.0319, GNorm = 2.9726, lr_0 = 4.5590e-04
Loss = 1.0719e-01, PNorm = 35.0460, GNorm = 0.7914, lr_0 = 4.4315e-04
Loss = 1.2510e-01, PNorm = 35.0474, GNorm = 1.0705, lr_0 = 4.4190e-04
Validation rmse = 0.122767
Validation r2 = 0.869136
Validation mse = 0.015072
Epoch 21
Loss = 9.0503e-02, PNorm = 35.0594, GNorm = 1.7354, lr_0 = 4.2954e-04
Validation rmse = 0.125593
Validation r2 = 0.863040
Validation mse = 0.015774
Epoch 22
Loss = 9.3762e-02, PNorm = 35.0699, GNorm = 0.6210, lr_0 = 4.1753e-04
Loss = 1.0932e-01, PNorm = 35.0815, GNorm = 0.8017, lr_0 = 4.0586e-04
Validation rmse = 0.141425
Validation r2 = 0.826335
Validation mse = 0.020001
Epoch 23
Loss = 1.1069e-01, PNorm = 35.0939, GNorm = 3.1933, lr_0 = 3.9451e-04
Validation rmse = 0.123105
Validation r2 = 0.868413
Validation mse = 0.015155
Epoch 24
Loss = 9.4522e-02, PNorm = 35.1047, GNorm = 1.4564, lr_0 = 3.8348e-04
Loss = 9.8777e-02, PNorm = 35.1149, GNorm = 1.6009, lr_0 = 3.7276e-04
Validation rmse = 0.118931
Validation r2 = 0.877184
Validation mse = 0.014145
Epoch 25
Loss = 8.8790e-02, PNorm = 35.1283, GNorm = 0.8432, lr_0 = 3.6234e-04
Validation rmse = 0.118983
Validation r2 = 0.877077
Validation mse = 0.014157
Epoch 26
Loss = 6.8560e-02, PNorm = 35.1384, GNorm = 1.0631, lr_0 = 3.5121e-04
Validation rmse = 0.119346
Validation r2 = 0.876328
Validation mse = 0.014243
Epoch 27
Loss = 7.7121e-02, PNorm = 35.1494, GNorm = 1.7617, lr_0 = 3.4139e-04
Loss = 8.4334e-02, PNorm = 35.1600, GNorm = 2.6986, lr_0 = 3.3185e-04
Validation rmse = 0.123414
Validation r2 = 0.867753
Validation mse = 0.015231
Epoch 28
Loss = 8.8603e-02, PNorm = 35.1695, GNorm = 0.7302, lr_0 = 3.2257e-04
Validation rmse = 0.118919
Validation r2 = 0.877209
Validation mse = 0.014142
Epoch 29
Loss = 6.6560e-02, PNorm = 35.1807, GNorm = 2.6174, lr_0 = 3.1355e-04
Loss = 9.5909e-02, PNorm = 35.1905, GNorm = 1.5278, lr_0 = 3.0478e-04
Validation rmse = 0.117830
Validation r2 = 0.879449
Validation mse = 0.013884
Epoch 30
Loss = 7.7785e-02, PNorm = 35.1991, GNorm = 0.6117, lr_0 = 2.9626e-04
Validation rmse = 0.119012
Validation r2 = 0.877018
Validation mse = 0.014164
Epoch 31
Loss = 7.6219e-02, PNorm = 35.2098, GNorm = 1.0258, lr_0 = 2.8716e-04
Loss = 8.7336e-02, PNorm = 35.2192, GNorm = 1.1213, lr_0 = 2.7913e-04
Validation rmse = 0.118577
Validation r2 = 0.877915
Validation mse = 0.014061
Epoch 32
Loss = 8.7603e-02, PNorm = 35.2286, GNorm = 2.6997, lr_0 = 2.7133e-04
Validation rmse = 0.120012
Validation r2 = 0.874944
Validation mse = 0.014403
Epoch 33
Loss = 9.2085e-02, PNorm = 35.2371, GNorm = 0.6197, lr_0 = 2.6374e-04
Loss = 8.7882e-02, PNorm = 35.2472, GNorm = 1.7157, lr_0 = 2.5637e-04
Validation rmse = 0.120522
Validation r2 = 0.873877
Validation mse = 0.014526
Epoch 34
Loss = 8.0687e-02, PNorm = 35.2549, GNorm = 1.3648, lr_0 = 2.4920e-04
Validation rmse = 0.121841
Validation r2 = 0.871103
Validation mse = 0.014845
Epoch 35
Loss = 1.0540e-01, PNorm = 35.2627, GNorm = 0.6623, lr_0 = 2.4223e-04
Loss = 8.5108e-02, PNorm = 35.2710, GNorm = 2.4985, lr_0 = 2.3546e-04
Validation rmse = 0.120761
Validation r2 = 0.873378
Validation mse = 0.014583
Epoch 36
Loss = 9.4520e-02, PNorm = 35.2790, GNorm = 1.4242, lr_0 = 2.2823e-04
Validation rmse = 0.119535
Validation r2 = 0.875935
Validation mse = 0.014289
Epoch 37
Loss = 7.9326e-02, PNorm = 35.2870, GNorm = 0.7988, lr_0 = 2.2185e-04
Loss = 8.1684e-02, PNorm = 35.2944, GNorm = 0.8977, lr_0 = 2.1565e-04
Validation rmse = 0.117272
Validation r2 = 0.880588
Validation mse = 0.013753
Epoch 38
Loss = 7.8101e-02, PNorm = 35.3013, GNorm = 1.1056, lr_0 = 2.0962e-04
Validation rmse = 0.121562
Validation r2 = 0.871692
Validation mse = 0.014777
Epoch 39
Loss = 1.0347e-01, PNorm = 35.3071, GNorm = 0.9871, lr_0 = 2.0376e-04
Loss = 8.1381e-02, PNorm = 35.3142, GNorm = 1.3827, lr_0 = 1.9806e-04
Validation rmse = 0.118837
Validation r2 = 0.877380
Validation mse = 0.014122
Epoch 40
Loss = 6.8868e-02, PNorm = 35.3200, GNorm = 0.5290, lr_0 = 1.9252e-04
Validation rmse = 0.118497
Validation r2 = 0.878080
Validation mse = 0.014042
Epoch 41
Loss = 8.7419e-02, PNorm = 35.3268, GNorm = 1.5660, lr_0 = 1.8661e-04
Loss = 8.6382e-02, PNorm = 35.3322, GNorm = 0.5611, lr_0 = 1.8139e-04
Validation rmse = 0.116501
Validation r2 = 0.882153
Validation mse = 0.013572
Epoch 42
Loss = 8.9590e-02, PNorm = 35.3383, GNorm = 0.7326, lr_0 = 1.7632e-04
Validation rmse = 0.122678
Validation r2 = 0.869324
Validation mse = 0.015050
Epoch 43
Loss = 6.6685e-02, PNorm = 35.3436, GNorm = 0.9319, lr_0 = 1.7139e-04
Loss = 8.0659e-02, PNorm = 35.3480, GNorm = 1.0100, lr_0 = 1.6660e-04
Validation rmse = 0.117207
Validation r2 = 0.880720
Validation mse = 0.013738
Epoch 44
Loss = 7.9663e-02, PNorm = 35.3537, GNorm = 0.7775, lr_0 = 1.6194e-04
Validation rmse = 0.116822
Validation r2 = 0.881503
Validation mse = 0.013647
Epoch 45
Loss = 6.4108e-02, PNorm = 35.3593, GNorm = 0.9429, lr_0 = 1.5741e-04
Loss = 8.4482e-02, PNorm = 35.3645, GNorm = 1.4454, lr_0 = 1.5301e-04
Loss = 6.1209e-02, PNorm = 35.3649, GNorm = 0.7121, lr_0 = 1.5258e-04
Validation rmse = 0.116998
Validation r2 = 0.881145
Validation mse = 0.013689
Epoch 46
Loss = 7.5828e-02, PNorm = 35.3697, GNorm = 1.4024, lr_0 = 1.4831e-04
Validation rmse = 0.118092
Validation r2 = 0.878912
Validation mse = 0.013946
Epoch 47
Loss = 6.4181e-02, PNorm = 35.3747, GNorm = 0.4666, lr_0 = 1.4417e-04
Loss = 8.5354e-02, PNorm = 35.3796, GNorm = 0.7956, lr_0 = 1.4014e-04
Validation rmse = 0.117689
Validation r2 = 0.879737
Validation mse = 0.013851
Epoch 48
Loss = 7.4398e-02, PNorm = 35.3848, GNorm = 0.4206, lr_0 = 1.3622e-04
Validation rmse = 0.125035
Validation r2 = 0.864255
Validation mse = 0.015634
Epoch 49
Loss = 6.0503e-02, PNorm = 35.3889, GNorm = 1.2176, lr_0 = 1.3241e-04
Loss = 8.3154e-02, PNorm = 35.3938, GNorm = 0.6997, lr_0 = 1.2871e-04
Validation rmse = 0.117383
Validation r2 = 0.880362
Validation mse = 0.013779
Epoch 50
Loss = 7.5923e-02, PNorm = 35.3988, GNorm = 1.7669, lr_0 = 1.2511e-04
Validation rmse = 0.116822
Validation r2 = 0.881503
Validation mse = 0.013647
Epoch 51
Loss = 7.5808e-02, PNorm = 35.4030, GNorm = 1.3793, lr_0 = 1.2127e-04
Validation rmse = 0.116813
Validation r2 = 0.881520
Validation mse = 0.013645
Epoch 52
Loss = 7.2782e-02, PNorm = 35.4068, GNorm = 0.7568, lr_0 = 1.1788e-04
Loss = 7.6094e-02, PNorm = 35.4102, GNorm = 0.8937, lr_0 = 1.1458e-04
Validation rmse = 0.115916
Validation r2 = 0.883333
Validation mse = 0.013437
Epoch 53
Loss = 6.4361e-02, PNorm = 35.4146, GNorm = 0.8240, lr_0 = 1.1138e-04
Validation rmse = 0.116213
Validation r2 = 0.882735
Validation mse = 0.013505
Epoch 54
Loss = 8.0129e-02, PNorm = 35.4182, GNorm = 0.5590, lr_0 = 1.0826e-04
Loss = 7.3403e-02, PNorm = 35.4217, GNorm = 1.9246, lr_0 = 1.0524e-04
Validation rmse = 0.121209
Validation r2 = 0.872435
Validation mse = 0.014692
Epoch 55
Loss = 6.6794e-02, PNorm = 35.4251, GNorm = 0.8511, lr_0 = 1.0229e-04
Validation rmse = 0.115643
Validation r2 = 0.883882
Validation mse = 0.013373
Epoch 56
Loss = 5.7977e-02, PNorm = 35.4289, GNorm = 0.6480, lr_0 = 1.0000e-04
Loss = 7.8311e-02, PNorm = 35.4317, GNorm = 0.9271, lr_0 = 1.0000e-04
Validation rmse = 0.116248
Validation r2 = 0.882664
Validation mse = 0.013514
Epoch 57
Loss = 8.0640e-02, PNorm = 35.4354, GNorm = 0.8532, lr_0 = 1.0000e-04
Validation rmse = 0.118324
Validation r2 = 0.878436
Validation mse = 0.014001
Epoch 58
Loss = 7.4182e-02, PNorm = 35.4393, GNorm = 3.8863, lr_0 = 1.0000e-04
Loss = 6.6616e-02, PNorm = 35.4429, GNorm = 1.0458, lr_0 = 1.0000e-04
Validation rmse = 0.118637
Validation r2 = 0.877793
Validation mse = 0.014075
Epoch 59
Loss = 6.4755e-02, PNorm = 35.4458, GNorm = 0.7604, lr_0 = 1.0000e-04
Validation rmse = 0.119197
Validation r2 = 0.876635
Validation mse = 0.014208
Model 0 best validation rmse = 0.115643 on epoch 55
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.305798
Model 0 test r2 = -1.372019
Model 0 test mse = 0.093512
Ensemble test rmse = 0.305798
Ensemble test r2 = -1.372019
Ensemble test mse = 0.093512
Fold 4
Splitting data with seed 4
Total size = 926 | train size = 740 | val size = 186 | test size = 96
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.5414e-01, PNorm = 34.0194, GNorm = 1.7295, lr_0 = 4.5357e-04
Validation rmse = 0.357897
Validation r2 = 0.075980
Validation mse = 0.128090
Epoch 1
Loss = 6.7724e-01, PNorm = 34.0473, GNorm = 4.0456, lr_0 = 8.0714e-04
Validation rmse = 0.283407
Validation r2 = 0.420591
Validation mse = 0.080319
Epoch 2
Loss = 5.1763e-01, PNorm = 34.1031, GNorm = 1.2980, lr_0 = 9.8872e-04
Loss = 4.6081e-01, PNorm = 34.1790, GNorm = 10.7894, lr_0 = 9.6108e-04
Validation rmse = 0.287769
Validation r2 = 0.402616
Validation mse = 0.082811
Epoch 3
Loss = 4.1926e-01, PNorm = 34.2476, GNorm = 2.9211, lr_0 = 9.3421e-04
Validation rmse = 0.210851
Validation r2 = 0.679288
Validation mse = 0.044458
Epoch 4
Loss = 2.5131e-01, PNorm = 34.3118, GNorm = 1.0537, lr_0 = 9.0809e-04
Loss = 2.9080e-01, PNorm = 34.3702, GNorm = 2.3860, lr_0 = 8.8270e-04
Validation rmse = 0.195630
Validation r2 = 0.723919
Validation mse = 0.038271
Epoch 5
Loss = 2.2639e-01, PNorm = 34.4285, GNorm = 1.5094, lr_0 = 8.5802e-04
Validation rmse = 0.175710
Validation r2 = 0.777280
Validation mse = 0.030874
Epoch 6
Loss = 1.9473e-01, PNorm = 34.4781, GNorm = 1.5158, lr_0 = 8.3167e-04
Loss = 2.1720e-01, PNorm = 34.5204, GNorm = 2.0745, lr_0 = 8.0842e-04
Validation rmse = 0.163158
Validation r2 = 0.807964
Validation mse = 0.026621
Epoch 7
Loss = 1.4660e-01, PNorm = 34.5636, GNorm = 0.7050, lr_0 = 7.8581e-04
Validation rmse = 0.173257
Validation r2 = 0.783456
Validation mse = 0.030018
Epoch 8
Loss = 2.6085e-01, PNorm = 34.6033, GNorm = 3.5555, lr_0 = 7.6384e-04
Loss = 1.7579e-01, PNorm = 34.6413, GNorm = 1.2641, lr_0 = 7.4249e-04
Validation rmse = 0.155820
Validation r2 = 0.824849
Validation mse = 0.024280
Epoch 9
Loss = 1.7079e-01, PNorm = 34.6719, GNorm = 4.9116, lr_0 = 7.2173e-04
Validation rmse = 0.182169
Validation r2 = 0.760605
Validation mse = 0.033186
Epoch 10
Loss = 1.7630e-01, PNorm = 34.6996, GNorm = 1.7172, lr_0 = 7.0155e-04
Loss = 1.6087e-01, PNorm = 34.7264, GNorm = 2.5622, lr_0 = 6.8194e-04
Validation rmse = 0.156656
Validation r2 = 0.822965
Validation mse = 0.024541
Epoch 11
Loss = 1.4172e-01, PNorm = 34.7522, GNorm = 4.9245, lr_0 = 6.6099e-04
Validation rmse = 0.151087
Validation r2 = 0.835329
Validation mse = 0.022827
Epoch 12
Loss = 1.3103e-01, PNorm = 34.7777, GNorm = 1.4049, lr_0 = 6.4251e-04
Loss = 1.3064e-01, PNorm = 34.8029, GNorm = 1.1722, lr_0 = 6.2455e-04
Validation rmse = 0.147260
Validation r2 = 0.843565
Validation mse = 0.021686
Epoch 13
Loss = 1.2241e-01, PNorm = 34.8226, GNorm = 0.5625, lr_0 = 6.0709e-04
Validation rmse = 0.139422
Validation r2 = 0.859774
Validation mse = 0.019438
Epoch 14
Loss = 1.1339e-01, PNorm = 34.8411, GNorm = 3.1634, lr_0 = 5.9011e-04
Loss = 1.3181e-01, PNorm = 34.8581, GNorm = 2.2402, lr_0 = 5.7362e-04
Validation rmse = 0.137537
Validation r2 = 0.863541
Validation mse = 0.018916
Epoch 15
Loss = 1.2106e-01, PNorm = 34.8755, GNorm = 2.3960, lr_0 = 5.5758e-04
Validation rmse = 0.134904
Validation r2 = 0.868715
Validation mse = 0.018199
Epoch 16
Loss = 1.4119e-01, PNorm = 34.8935, GNorm = 3.0849, lr_0 = 5.4045e-04
Loss = 1.2242e-01, PNorm = 34.9091, GNorm = 1.4189, lr_0 = 5.2534e-04
Validation rmse = 0.132395
Validation r2 = 0.873553
Validation mse = 0.017529
Epoch 17
Loss = 1.0634e-01, PNorm = 34.9268, GNorm = 3.2609, lr_0 = 5.1066e-04
Validation rmse = 0.131792
Validation r2 = 0.874703
Validation mse = 0.017369
Epoch 18
Loss = 1.1864e-01, PNorm = 34.9410, GNorm = 3.1403, lr_0 = 4.9638e-04
Loss = 1.1567e-01, PNorm = 34.9571, GNorm = 4.6467, lr_0 = 4.8250e-04
Validation rmse = 0.134157
Validation r2 = 0.870165
Validation mse = 0.017998
Epoch 19
Loss = 1.2924e-01, PNorm = 34.9696, GNorm = 3.9395, lr_0 = 4.6901e-04
Validation rmse = 0.133066
Validation r2 = 0.872268
Validation mse = 0.017707
Epoch 20
Loss = 9.0814e-02, PNorm = 34.9850, GNorm = 0.6524, lr_0 = 4.5590e-04
Loss = 1.0810e-01, PNorm = 34.9987, GNorm = 0.6439, lr_0 = 4.4315e-04
Loss = 9.0207e-02, PNorm = 35.0000, GNorm = 0.9471, lr_0 = 4.4190e-04
Validation rmse = 0.133240
Validation r2 = 0.871935
Validation mse = 0.017753
Epoch 21
Loss = 1.1231e-01, PNorm = 35.0148, GNorm = 2.1405, lr_0 = 4.2954e-04
Validation rmse = 0.144325
Validation r2 = 0.849739
Validation mse = 0.020830
Epoch 22
Loss = 1.3190e-01, PNorm = 35.0265, GNorm = 1.4499, lr_0 = 4.1753e-04
Loss = 9.1454e-02, PNorm = 35.0379, GNorm = 2.3008, lr_0 = 4.0586e-04
Validation rmse = 0.134742
Validation r2 = 0.869030
Validation mse = 0.018155
Epoch 23
Loss = 9.5570e-02, PNorm = 35.0492, GNorm = 2.0983, lr_0 = 3.9451e-04
Validation rmse = 0.131021
Validation r2 = 0.876165
Validation mse = 0.017166
Epoch 24
Loss = 8.9149e-02, PNorm = 35.0618, GNorm = 0.4610, lr_0 = 3.8348e-04
Loss = 9.8719e-02, PNorm = 35.0732, GNorm = 1.5679, lr_0 = 3.7276e-04
Validation rmse = 0.131114
Validation r2 = 0.875987
Validation mse = 0.017191
Epoch 25
Loss = 9.2783e-02, PNorm = 35.0870, GNorm = 0.9311, lr_0 = 3.6234e-04
Validation rmse = 0.129230
Validation r2 = 0.879526
Validation mse = 0.016700
Epoch 26
Loss = 9.8840e-02, PNorm = 35.0981, GNorm = 1.8568, lr_0 = 3.5121e-04
Validation rmse = 0.133854
Validation r2 = 0.870750
Validation mse = 0.017917
Epoch 27
Loss = 1.2347e-01, PNorm = 35.1060, GNorm = 3.9300, lr_0 = 3.4139e-04
Loss = 9.1076e-02, PNorm = 35.1151, GNorm = 0.5993, lr_0 = 3.3185e-04
Validation rmse = 0.136219
Validation r2 = 0.866143
Validation mse = 0.018556
Epoch 28
Loss = 9.4738e-02, PNorm = 35.1261, GNorm = 3.7396, lr_0 = 3.2257e-04
Validation rmse = 0.130969
Validation r2 = 0.876261
Validation mse = 0.017153
Epoch 29
Loss = 1.2295e-01, PNorm = 35.1360, GNorm = 1.2500, lr_0 = 3.1355e-04
Loss = 9.9649e-02, PNorm = 35.1484, GNorm = 1.6645, lr_0 = 3.0478e-04
Validation rmse = 0.130411
Validation r2 = 0.877315
Validation mse = 0.017007
Epoch 30
Loss = 9.7153e-02, PNorm = 35.1584, GNorm = 1.2404, lr_0 = 2.9626e-04
Validation rmse = 0.129846
Validation r2 = 0.878374
Validation mse = 0.016860
Epoch 31
Loss = 8.9822e-02, PNorm = 35.1679, GNorm = 0.7564, lr_0 = 2.8716e-04
Loss = 8.5389e-02, PNorm = 35.1758, GNorm = 1.6997, lr_0 = 2.7913e-04
Validation rmse = 0.127437
Validation r2 = 0.882847
Validation mse = 0.016240
Epoch 32
Loss = 8.2207e-02, PNorm = 35.1841, GNorm = 2.1294, lr_0 = 2.7133e-04
Validation rmse = 0.128957
Validation r2 = 0.880036
Validation mse = 0.016630
Epoch 33
Loss = 7.1074e-02, PNorm = 35.1947, GNorm = 3.5413, lr_0 = 2.6374e-04
Loss = 8.8688e-02, PNorm = 35.2022, GNorm = 1.9937, lr_0 = 2.5637e-04
Validation rmse = 0.128227
Validation r2 = 0.881389
Validation mse = 0.016442
Epoch 34
Loss = 8.5962e-02, PNorm = 35.2100, GNorm = 1.7215, lr_0 = 2.4920e-04
Validation rmse = 0.129247
Validation r2 = 0.879495
Validation mse = 0.016705
Epoch 35
Loss = 8.2475e-02, PNorm = 35.2175, GNorm = 2.1267, lr_0 = 2.4223e-04
Loss = 9.3745e-02, PNorm = 35.2258, GNorm = 3.9980, lr_0 = 2.3546e-04
Validation rmse = 0.127215
Validation r2 = 0.883254
Validation mse = 0.016184
Epoch 36
Loss = 8.2208e-02, PNorm = 35.2351, GNorm = 0.7933, lr_0 = 2.2823e-04
Validation rmse = 0.127369
Validation r2 = 0.882972
Validation mse = 0.016223
Epoch 37
Loss = 7.8153e-02, PNorm = 35.2427, GNorm = 0.9038, lr_0 = 2.2185e-04
Loss = 9.1720e-02, PNorm = 35.2504, GNorm = 1.7313, lr_0 = 2.1565e-04
Validation rmse = 0.127220
Validation r2 = 0.883245
Validation mse = 0.016185
Epoch 38
Loss = 8.6002e-02, PNorm = 35.2568, GNorm = 0.8746, lr_0 = 2.0962e-04
Validation rmse = 0.129823
Validation r2 = 0.878419
Validation mse = 0.016854
Epoch 39
Loss = 8.5673e-02, PNorm = 35.2638, GNorm = 0.8401, lr_0 = 2.0376e-04
Loss = 8.1635e-02, PNorm = 35.2698, GNorm = 2.3445, lr_0 = 1.9806e-04
Validation rmse = 0.127376
Validation r2 = 0.882959
Validation mse = 0.016225
Epoch 40
Loss = 8.5606e-02, PNorm = 35.2770, GNorm = 1.0292, lr_0 = 1.9252e-04
Validation rmse = 0.128011
Validation r2 = 0.881789
Validation mse = 0.016387
Epoch 41
Loss = 7.6763e-02, PNorm = 35.2833, GNorm = 0.7718, lr_0 = 1.8661e-04
Loss = 7.6062e-02, PNorm = 35.2895, GNorm = 2.0966, lr_0 = 1.8139e-04
Validation rmse = 0.129441
Validation r2 = 0.879132
Validation mse = 0.016755
Epoch 42
Loss = 8.4583e-02, PNorm = 35.2948, GNorm = 2.9327, lr_0 = 1.7632e-04
Validation rmse = 0.126511
Validation r2 = 0.884544
Validation mse = 0.016005
Epoch 43
Loss = 6.4573e-02, PNorm = 35.3009, GNorm = 1.5146, lr_0 = 1.7139e-04
Loss = 8.5369e-02, PNorm = 35.3071, GNorm = 1.0149, lr_0 = 1.6660e-04
Validation rmse = 0.128618
Validation r2 = 0.880666
Validation mse = 0.016542
Epoch 44
Loss = 8.0556e-02, PNorm = 35.3127, GNorm = 0.8500, lr_0 = 1.6194e-04
Validation rmse = 0.129609
Validation r2 = 0.878819
Validation mse = 0.016799
Epoch 45
Loss = 7.9771e-02, PNorm = 35.3183, GNorm = 2.5053, lr_0 = 1.5741e-04
Loss = 7.7537e-02, PNorm = 35.3222, GNorm = 3.6732, lr_0 = 1.5301e-04
Loss = 7.5857e-02, PNorm = 35.3229, GNorm = 2.0341, lr_0 = 1.5258e-04
Validation rmse = 0.129352
Validation r2 = 0.879298
Validation mse = 0.016732
Epoch 46
Loss = 6.8902e-02, PNorm = 35.3283, GNorm = 1.9809, lr_0 = 1.4831e-04
Validation rmse = 0.128104
Validation r2 = 0.881618
Validation mse = 0.016411
Epoch 47
Loss = 7.5793e-02, PNorm = 35.3335, GNorm = 0.5148, lr_0 = 1.4417e-04
Loss = 8.2459e-02, PNorm = 35.3381, GNorm = 0.8001, lr_0 = 1.4014e-04
Validation rmse = 0.129922
Validation r2 = 0.878233
Validation mse = 0.016880
Epoch 48
Loss = 7.3284e-02, PNorm = 35.3420, GNorm = 1.9340, lr_0 = 1.3622e-04
Validation rmse = 0.127636
Validation r2 = 0.882479
Validation mse = 0.016291
Epoch 49
Loss = 8.0195e-02, PNorm = 35.3477, GNorm = 1.4792, lr_0 = 1.3241e-04
Loss = 7.9332e-02, PNorm = 35.3530, GNorm = 1.3075, lr_0 = 1.2871e-04
Validation rmse = 0.129817
Validation r2 = 0.878429
Validation mse = 0.016852
Epoch 50
Loss = 6.7320e-02, PNorm = 35.3575, GNorm = 0.5023, lr_0 = 1.2511e-04
Validation rmse = 0.126276
Validation r2 = 0.884972
Validation mse = 0.015946
Epoch 51
Loss = 7.3420e-02, PNorm = 35.3616, GNorm = 1.9273, lr_0 = 1.2127e-04
Validation rmse = 0.128178
Validation r2 = 0.881480
Validation mse = 0.016430
Epoch 52
Loss = 5.0605e-02, PNorm = 35.3653, GNorm = 1.0025, lr_0 = 1.1788e-04
Loss = 7.5265e-02, PNorm = 35.3685, GNorm = 1.3685, lr_0 = 1.1458e-04
Validation rmse = 0.129087
Validation r2 = 0.879793
Validation mse = 0.016663
Epoch 53
Loss = 7.6618e-02, PNorm = 35.3723, GNorm = 2.3458, lr_0 = 1.1138e-04
Validation rmse = 0.127118
Validation r2 = 0.883433
Validation mse = 0.016159
Epoch 54
Loss = 6.3162e-02, PNorm = 35.3759, GNorm = 0.6015, lr_0 = 1.0826e-04
Loss = 7.1172e-02, PNorm = 35.3793, GNorm = 2.3523, lr_0 = 1.0524e-04
Validation rmse = 0.128518
Validation r2 = 0.880851
Validation mse = 0.016517
Epoch 55
Loss = 7.7245e-02, PNorm = 35.3828, GNorm = 0.5732, lr_0 = 1.0229e-04
Validation rmse = 0.126657
Validation r2 = 0.884277
Validation mse = 0.016042
Epoch 56
Loss = 5.9370e-02, PNorm = 35.3861, GNorm = 1.4717, lr_0 = 1.0000e-04
Loss = 7.2990e-02, PNorm = 35.3890, GNorm = 0.4114, lr_0 = 1.0000e-04
Validation rmse = 0.128237
Validation r2 = 0.881370
Validation mse = 0.016445
Epoch 57
Loss = 6.8985e-02, PNorm = 35.3929, GNorm = 2.0938, lr_0 = 1.0000e-04
Validation rmse = 0.128700
Validation r2 = 0.880513
Validation mse = 0.016564
Epoch 58
Loss = 9.7266e-02, PNorm = 35.3962, GNorm = 1.0553, lr_0 = 1.0000e-04
Loss = 6.9123e-02, PNorm = 35.3994, GNorm = 0.6298, lr_0 = 1.0000e-04
Validation rmse = 0.127430
Validation r2 = 0.882859
Validation mse = 0.016238
Epoch 59
Loss = 6.2036e-02, PNorm = 35.4031, GNorm = 0.9399, lr_0 = 1.0000e-04
Validation rmse = 0.126470
Validation r2 = 0.884618
Validation mse = 0.015995
Model 0 best validation rmse = 0.126276 on epoch 50
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.295750
Model 0 test r2 = -1.218696
Model 0 test mse = 0.087468
Ensemble test rmse = 0.295750
Ensemble test r2 = -1.218696
Ensemble test mse = 0.087468
Fold 5
Splitting data with seed 5
Total size = 926 | train size = 740 | val size = 186 | test size = 96
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.5642e-01, PNorm = 34.0167, GNorm = 1.4714, lr_0 = 4.5357e-04
Validation rmse = 0.308330
Validation r2 = 0.239284
Validation mse = 0.095068
Epoch 1
Loss = 6.2459e-01, PNorm = 34.0571, GNorm = 1.7533, lr_0 = 8.0714e-04
Validation rmse = 0.294084
Validation r2 = 0.307957
Validation mse = 0.086485
Epoch 2
Loss = 4.1032e-01, PNorm = 34.1121, GNorm = 8.6767, lr_0 = 9.8872e-04
Loss = 4.4262e-01, PNorm = 34.1823, GNorm = 2.8194, lr_0 = 9.6108e-04
Validation rmse = 0.222886
Validation r2 = 0.602483
Validation mse = 0.049678
Epoch 3
Loss = 4.3467e-01, PNorm = 34.2488, GNorm = 8.8127, lr_0 = 9.3421e-04
Validation rmse = 0.254488
Validation r2 = 0.481766
Validation mse = 0.064764
Epoch 4
Loss = 3.7979e-01, PNorm = 34.3028, GNorm = 6.7685, lr_0 = 9.0809e-04
Loss = 2.8335e-01, PNorm = 34.3568, GNorm = 0.7863, lr_0 = 8.8270e-04
Validation rmse = 0.209934
Validation r2 = 0.647340
Validation mse = 0.044072
Epoch 5
Loss = 2.9438e-01, PNorm = 34.4087, GNorm = 2.6484, lr_0 = 8.5802e-04
Validation rmse = 0.183944
Validation r2 = 0.729253
Validation mse = 0.033836
Epoch 6
Loss = 1.9199e-01, PNorm = 34.4630, GNorm = 5.6949, lr_0 = 8.3167e-04
Loss = 2.7695e-01, PNorm = 34.4965, GNorm = 7.3655, lr_0 = 8.0842e-04
Validation rmse = 0.223226
Validation r2 = 0.601270
Validation mse = 0.049830
Epoch 7
Loss = 2.4469e-01, PNorm = 34.5473, GNorm = 1.7989, lr_0 = 7.8581e-04
Validation rmse = 0.177928
Validation r2 = 0.746674
Validation mse = 0.031658
Epoch 8
Loss = 2.4593e-01, PNorm = 34.5823, GNorm = 5.3021, lr_0 = 7.6384e-04
Loss = 1.8239e-01, PNorm = 34.6218, GNorm = 0.8347, lr_0 = 7.4249e-04
Validation rmse = 0.164560
Validation r2 = 0.783311
Validation mse = 0.027080
Epoch 9
Loss = 1.6696e-01, PNorm = 34.6555, GNorm = 2.0904, lr_0 = 7.2173e-04
Validation rmse = 0.154289
Validation r2 = 0.809515
Validation mse = 0.023805
Epoch 10
Loss = 1.7174e-01, PNorm = 34.6922, GNorm = 0.7043, lr_0 = 7.0155e-04
Loss = 1.5200e-01, PNorm = 34.7267, GNorm = 2.1658, lr_0 = 6.8194e-04
Validation rmse = 0.153504
Validation r2 = 0.811448
Validation mse = 0.023564
Epoch 11
Loss = 1.3968e-01, PNorm = 34.7498, GNorm = 1.9464, lr_0 = 6.6099e-04
Validation rmse = 0.151985
Validation r2 = 0.815163
Validation mse = 0.023099
Epoch 12
Loss = 9.8766e-02, PNorm = 34.7779, GNorm = 0.6768, lr_0 = 6.4251e-04
Loss = 1.4505e-01, PNorm = 34.8003, GNorm = 1.7694, lr_0 = 6.2455e-04
Validation rmse = 0.150003
Validation r2 = 0.819950
Validation mse = 0.022501
Epoch 13
Loss = 1.1147e-01, PNorm = 34.8216, GNorm = 1.6146, lr_0 = 6.0709e-04
Validation rmse = 0.151782
Validation r2 = 0.815655
Validation mse = 0.023038
Epoch 14
Loss = 1.4625e-01, PNorm = 34.8436, GNorm = 1.7350, lr_0 = 5.9011e-04
Loss = 1.1449e-01, PNorm = 34.8627, GNorm = 2.4890, lr_0 = 5.7362e-04
Validation rmse = 0.142828
Validation r2 = 0.836763
Validation mse = 0.020400
Epoch 15
Loss = 1.0477e-01, PNorm = 34.8838, GNorm = 1.9854, lr_0 = 5.5758e-04
Validation rmse = 0.143426
Validation r2 = 0.835393
Validation mse = 0.020571
Epoch 16
Loss = 1.0288e-01, PNorm = 34.9077, GNorm = 0.8025, lr_0 = 5.4045e-04
Loss = 1.0865e-01, PNorm = 34.9225, GNorm = 1.1627, lr_0 = 5.2534e-04
Validation rmse = 0.142915
Validation r2 = 0.836565
Validation mse = 0.020425
Epoch 17
Loss = 1.0831e-01, PNorm = 34.9416, GNorm = 3.2361, lr_0 = 5.1066e-04
Validation rmse = 0.144515
Validation r2 = 0.832885
Validation mse = 0.020885
Epoch 18
Loss = 1.1793e-01, PNorm = 34.9604, GNorm = 1.4163, lr_0 = 4.9638e-04
Loss = 1.0264e-01, PNorm = 34.9759, GNorm = 1.1955, lr_0 = 4.8250e-04
Validation rmse = 0.138239
Validation r2 = 0.847086
Validation mse = 0.019110
Epoch 19
Loss = 9.6939e-02, PNorm = 34.9895, GNorm = 0.6677, lr_0 = 4.6901e-04
Validation rmse = 0.145693
Validation r2 = 0.830150
Validation mse = 0.021226
Epoch 20
Loss = 9.9609e-02, PNorm = 35.0067, GNorm = 2.6997, lr_0 = 4.5590e-04
Loss = 1.4466e-01, PNorm = 35.0201, GNorm = 2.1695, lr_0 = 4.4315e-04
Loss = 1.7997e-01, PNorm = 35.0219, GNorm = 4.1896, lr_0 = 4.4190e-04
Validation rmse = 0.142815
Validation r2 = 0.836794
Validation mse = 0.020396
Epoch 21
Loss = 1.1097e-01, PNorm = 35.0388, GNorm = 1.5339, lr_0 = 4.2954e-04
Validation rmse = 0.153519
Validation r2 = 0.811411
Validation mse = 0.023568
Epoch 22
Loss = 1.1875e-01, PNorm = 35.0554, GNorm = 3.0946, lr_0 = 4.1753e-04
Loss = 9.9134e-02, PNorm = 35.0721, GNorm = 2.0129, lr_0 = 4.0586e-04
Validation rmse = 0.143770
Validation r2 = 0.834603
Validation mse = 0.020670
Epoch 23
Loss = 9.8606e-02, PNorm = 35.0828, GNorm = 1.2750, lr_0 = 3.9451e-04
Validation rmse = 0.144640
Validation r2 = 0.832595
Validation mse = 0.020921
Epoch 24
Loss = 9.3804e-02, PNorm = 35.0935, GNorm = 1.7025, lr_0 = 3.8348e-04
Loss = 9.6405e-02, PNorm = 35.1062, GNorm = 1.9678, lr_0 = 3.7276e-04
Validation rmse = 0.137189
Validation r2 = 0.849398
Validation mse = 0.018821
Epoch 25
Loss = 9.2181e-02, PNorm = 35.1165, GNorm = 0.7699, lr_0 = 3.6234e-04
Validation rmse = 0.135683
Validation r2 = 0.852688
Validation mse = 0.018410
Epoch 26
Loss = 8.8052e-02, PNorm = 35.1273, GNorm = 1.1427, lr_0 = 3.5121e-04
Validation rmse = 0.145972
Validation r2 = 0.829499
Validation mse = 0.021308
Epoch 27
Loss = 1.0079e-01, PNorm = 35.1363, GNorm = 2.2658, lr_0 = 3.4139e-04
Loss = 1.0117e-01, PNorm = 35.1480, GNorm = 3.9961, lr_0 = 3.3185e-04
Validation rmse = 0.138498
Validation r2 = 0.846512
Validation mse = 0.019182
Epoch 28
Loss = 1.0067e-01, PNorm = 35.1575, GNorm = 2.8515, lr_0 = 3.2257e-04
Validation rmse = 0.141783
Validation r2 = 0.839144
Validation mse = 0.020102
Epoch 29
Loss = 1.1580e-01, PNorm = 35.1672, GNorm = 2.4584, lr_0 = 3.1355e-04
Loss = 8.4763e-02, PNorm = 35.1776, GNorm = 1.2371, lr_0 = 3.0478e-04
Validation rmse = 0.135631
Validation r2 = 0.852800
Validation mse = 0.018396
Epoch 30
Loss = 8.7286e-02, PNorm = 35.1893, GNorm = 0.7565, lr_0 = 2.9626e-04
Validation rmse = 0.136849
Validation r2 = 0.850144
Validation mse = 0.018728
Epoch 31
Loss = 1.0121e-01, PNorm = 35.1997, GNorm = 1.5390, lr_0 = 2.8716e-04
Loss = 9.1362e-02, PNorm = 35.2067, GNorm = 1.6604, lr_0 = 2.7913e-04
Validation rmse = 0.133047
Validation r2 = 0.858356
Validation mse = 0.017701
Epoch 32
Loss = 9.2098e-02, PNorm = 35.2162, GNorm = 1.3967, lr_0 = 2.7133e-04
Validation rmse = 0.133834
Validation r2 = 0.856675
Validation mse = 0.017912
Epoch 33
Loss = 7.0972e-02, PNorm = 35.2228, GNorm = 1.7530, lr_0 = 2.6374e-04
Loss = 9.2483e-02, PNorm = 35.2319, GNorm = 1.9699, lr_0 = 2.5637e-04
Validation rmse = 0.132214
Validation r2 = 0.860124
Validation mse = 0.017480
Epoch 34
Loss = 8.0530e-02, PNorm = 35.2390, GNorm = 0.8918, lr_0 = 2.4920e-04
Validation rmse = 0.134860
Validation r2 = 0.854468
Validation mse = 0.018187
Epoch 35
Loss = 9.8264e-02, PNorm = 35.2480, GNorm = 1.3351, lr_0 = 2.4223e-04
Loss = 8.1980e-02, PNorm = 35.2555, GNorm = 0.4098, lr_0 = 2.3546e-04
Validation rmse = 0.131473
Validation r2 = 0.861687
Validation mse = 0.017285
Epoch 36
Loss = 7.8167e-02, PNorm = 35.2623, GNorm = 0.7355, lr_0 = 2.2823e-04
Validation rmse = 0.134581
Validation r2 = 0.855069
Validation mse = 0.018112
Epoch 37
Loss = 8.5478e-02, PNorm = 35.2693, GNorm = 1.7761, lr_0 = 2.2185e-04
Loss = 7.9420e-02, PNorm = 35.2764, GNorm = 0.8115, lr_0 = 2.1565e-04
Validation rmse = 0.131732
Validation r2 = 0.861142
Validation mse = 0.017353
Epoch 38
Loss = 7.3950e-02, PNorm = 35.2823, GNorm = 1.4742, lr_0 = 2.0962e-04
Validation rmse = 0.131458
Validation r2 = 0.861719
Validation mse = 0.017281
Epoch 39
Loss = 7.3308e-02, PNorm = 35.2883, GNorm = 1.1258, lr_0 = 2.0376e-04
Loss = 7.9643e-02, PNorm = 35.2947, GNorm = 1.4939, lr_0 = 1.9806e-04
Validation rmse = 0.135725
Validation r2 = 0.852596
Validation mse = 0.018421
Epoch 40
Loss = 8.0037e-02, PNorm = 35.3009, GNorm = 1.3647, lr_0 = 1.9252e-04
Validation rmse = 0.131266
Validation r2 = 0.862122
Validation mse = 0.017231
Epoch 41
Loss = 6.9282e-02, PNorm = 35.3071, GNorm = 1.1063, lr_0 = 1.8661e-04
Loss = 8.1631e-02, PNorm = 35.3124, GNorm = 0.8074, lr_0 = 1.8139e-04
Validation rmse = 0.140119
Validation r2 = 0.842896
Validation mse = 0.019633
Epoch 42
Loss = 8.1271e-02, PNorm = 35.3193, GNorm = 0.9402, lr_0 = 1.7632e-04
Validation rmse = 0.130451
Validation r2 = 0.863829
Validation mse = 0.017017
Epoch 43
Loss = 8.3034e-02, PNorm = 35.3247, GNorm = 1.0015, lr_0 = 1.7139e-04
Loss = 7.0008e-02, PNorm = 35.3299, GNorm = 1.0729, lr_0 = 1.6660e-04
Validation rmse = 0.129946
Validation r2 = 0.864881
Validation mse = 0.016886
Epoch 44
Loss = 6.9849e-02, PNorm = 35.3337, GNorm = 1.6251, lr_0 = 1.6194e-04
Validation rmse = 0.131606
Validation r2 = 0.861407
Validation mse = 0.017320
Epoch 45
Loss = 8.4703e-02, PNorm = 35.3387, GNorm = 1.8470, lr_0 = 1.5741e-04
Loss = 7.0786e-02, PNorm = 35.3440, GNorm = 0.6316, lr_0 = 1.5301e-04
Loss = 8.4964e-02, PNorm = 35.3444, GNorm = 2.7126, lr_0 = 1.5258e-04
Validation rmse = 0.129580
Validation r2 = 0.865642
Validation mse = 0.016791
Epoch 46
Loss = 7.7580e-02, PNorm = 35.3500, GNorm = 2.1880, lr_0 = 1.4831e-04
Validation rmse = 0.129982
Validation r2 = 0.864806
Validation mse = 0.016895
Epoch 47
Loss = 7.7068e-02, PNorm = 35.3547, GNorm = 0.8635, lr_0 = 1.4417e-04
Loss = 6.9250e-02, PNorm = 35.3592, GNorm = 0.4526, lr_0 = 1.4014e-04
Validation rmse = 0.133068
Validation r2 = 0.858310
Validation mse = 0.017707
Epoch 48
Loss = 7.0880e-02, PNorm = 35.3619, GNorm = 2.0060, lr_0 = 1.3622e-04
Validation rmse = 0.129305
Validation r2 = 0.866210
Validation mse = 0.016720
Epoch 49
Loss = 7.5444e-02, PNorm = 35.3667, GNorm = 1.3292, lr_0 = 1.3241e-04
Loss = 7.1597e-02, PNorm = 35.3706, GNorm = 1.5416, lr_0 = 1.2871e-04
Validation rmse = 0.129588
Validation r2 = 0.865625
Validation mse = 0.016793
Epoch 50
Loss = 7.1805e-02, PNorm = 35.3752, GNorm = 1.2826, lr_0 = 1.2511e-04
Validation rmse = 0.128898
Validation r2 = 0.867053
Validation mse = 0.016615
Epoch 51
Loss = 5.4312e-02, PNorm = 35.3790, GNorm = 1.4103, lr_0 = 1.2127e-04
Validation rmse = 0.128523
Validation r2 = 0.867825
Validation mse = 0.016518
Epoch 52
Loss = 5.4140e-02, PNorm = 35.3826, GNorm = 1.0236, lr_0 = 1.1788e-04
Loss = 7.2633e-02, PNorm = 35.3870, GNorm = 0.7530, lr_0 = 1.1458e-04
Validation rmse = 0.129015
Validation r2 = 0.866811
Validation mse = 0.016645
Epoch 53
Loss = 6.3797e-02, PNorm = 35.3901, GNorm = 1.5049, lr_0 = 1.1138e-04
Validation rmse = 0.128527
Validation r2 = 0.867815
Validation mse = 0.016519
Epoch 54
Loss = 4.1192e-02, PNorm = 35.3937, GNorm = 0.4225, lr_0 = 1.0826e-04
Loss = 6.8709e-02, PNorm = 35.3969, GNorm = 0.8016, lr_0 = 1.0524e-04
Validation rmse = 0.128092
Validation r2 = 0.868710
Validation mse = 0.016407
Epoch 55
Loss = 7.5265e-02, PNorm = 35.4002, GNorm = 2.0360, lr_0 = 1.0229e-04
Validation rmse = 0.129237
Validation r2 = 0.866351
Validation mse = 0.016702
Epoch 56
Loss = 8.0545e-02, PNorm = 35.4035, GNorm = 1.2414, lr_0 = 1.0000e-04
Loss = 6.9628e-02, PNorm = 35.4071, GNorm = 2.5955, lr_0 = 1.0000e-04
Validation rmse = 0.133424
Validation r2 = 0.857550
Validation mse = 0.017802
Epoch 57
Loss = 6.9929e-02, PNorm = 35.4110, GNorm = 2.1076, lr_0 = 1.0000e-04
Validation rmse = 0.128357
Validation r2 = 0.868165
Validation mse = 0.016476
Epoch 58
Loss = 6.0772e-02, PNorm = 35.4135, GNorm = 0.8626, lr_0 = 1.0000e-04
Loss = 7.1947e-02, PNorm = 35.4164, GNorm = 0.9222, lr_0 = 1.0000e-04
Validation rmse = 0.129331
Validation r2 = 0.866157
Validation mse = 0.016727
Epoch 59
Loss = 7.0508e-02, PNorm = 35.4204, GNorm = 0.5117, lr_0 = 1.0000e-04
Validation rmse = 0.130419
Validation r2 = 0.863895
Validation mse = 0.017009
Model 0 best validation rmse = 0.128092 on epoch 54
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.325739
Model 0 test r2 = -1.691470
Model 0 test mse = 0.106106
Ensemble test rmse = 0.325739
Ensemble test r2 = -1.691470
Ensemble test mse = 0.106106
Fold 6
Splitting data with seed 6
Total size = 926 | train size = 740 | val size = 186 | test size = 96
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.6988e-01, PNorm = 34.0162, GNorm = 2.5904, lr_0 = 4.5357e-04
Validation rmse = 0.333640
Validation r2 = 0.160554
Validation mse = 0.111316
Epoch 1
Loss = 6.6468e-01, PNorm = 34.0493, GNorm = 5.4768, lr_0 = 8.0714e-04
Validation rmse = 0.302025
Validation r2 = 0.312103
Validation mse = 0.091219
Epoch 2
Loss = 8.1585e-01, PNorm = 34.1041, GNorm = 7.6303, lr_0 = 9.8872e-04
Loss = 4.7616e-01, PNorm = 34.1821, GNorm = 2.3962, lr_0 = 9.6108e-04
Validation rmse = 0.275265
Validation r2 = 0.428601
Validation mse = 0.075771
Epoch 3
Loss = 3.8516e-01, PNorm = 34.2451, GNorm = 0.6430, lr_0 = 9.3421e-04
Validation rmse = 0.229160
Validation r2 = 0.603982
Validation mse = 0.052514
Epoch 4
Loss = 2.2220e-01, PNorm = 34.3095, GNorm = 1.0676, lr_0 = 9.0809e-04
Loss = 2.6915e-01, PNorm = 34.3682, GNorm = 1.4596, lr_0 = 8.8270e-04
Validation rmse = 0.212950
Validation r2 = 0.658028
Validation mse = 0.045348
Epoch 5
Loss = 2.4219e-01, PNorm = 34.4266, GNorm = 5.8683, lr_0 = 8.5802e-04
Validation rmse = 0.193922
Validation r2 = 0.716410
Validation mse = 0.037606
Epoch 6
Loss = 2.1564e-01, PNorm = 34.4730, GNorm = 0.7378, lr_0 = 8.3167e-04
Loss = 1.7912e-01, PNorm = 34.5124, GNorm = 2.6053, lr_0 = 8.0842e-04
Validation rmse = 0.191429
Validation r2 = 0.723654
Validation mse = 0.036645
Epoch 7
Loss = 1.8889e-01, PNorm = 34.5562, GNorm = 1.5610, lr_0 = 7.8581e-04
Validation rmse = 0.189185
Validation r2 = 0.730095
Validation mse = 0.035791
Epoch 8
Loss = 1.5797e-01, PNorm = 34.5903, GNorm = 2.1926, lr_0 = 7.6384e-04
Loss = 1.6656e-01, PNorm = 34.6220, GNorm = 1.6543, lr_0 = 7.4249e-04
Validation rmse = 0.178256
Validation r2 = 0.760378
Validation mse = 0.031775
Epoch 9
Loss = 1.4979e-01, PNorm = 34.6523, GNorm = 4.4099, lr_0 = 7.2173e-04
Validation rmse = 0.168677
Validation r2 = 0.785441
Validation mse = 0.028452
Epoch 10
Loss = 1.2565e-01, PNorm = 34.6834, GNorm = 4.2459, lr_0 = 7.0155e-04
Loss = 1.6402e-01, PNorm = 34.7092, GNorm = 1.0533, lr_0 = 6.8194e-04
Validation rmse = 0.170640
Validation r2 = 0.780418
Validation mse = 0.029118
Epoch 11
Loss = 1.2207e-01, PNorm = 34.7354, GNorm = 3.3605, lr_0 = 6.6099e-04
Validation rmse = 0.164293
Validation r2 = 0.796448
Validation mse = 0.026992
Epoch 12
Loss = 1.3228e-01, PNorm = 34.7572, GNorm = 3.0935, lr_0 = 6.4251e-04
Loss = 1.4444e-01, PNorm = 34.7777, GNorm = 5.8209, lr_0 = 6.2455e-04
Validation rmse = 0.186456
Validation r2 = 0.737825
Validation mse = 0.034766
Epoch 13
Loss = 1.7458e-01, PNorm = 34.8030, GNorm = 1.5344, lr_0 = 6.0709e-04
Validation rmse = 0.170078
Validation r2 = 0.781862
Validation mse = 0.028926
Epoch 14
Loss = 1.4895e-01, PNorm = 34.8247, GNorm = 4.5523, lr_0 = 5.9011e-04
Loss = 1.4280e-01, PNorm = 34.8438, GNorm = 3.5199, lr_0 = 5.7362e-04
Validation rmse = 0.170316
Validation r2 = 0.781250
Validation mse = 0.029008
Epoch 15
Loss = 1.3843e-01, PNorm = 34.8639, GNorm = 1.1675, lr_0 = 5.5758e-04
Validation rmse = 0.161892
Validation r2 = 0.802355
Validation mse = 0.026209
Epoch 16
Loss = 8.8122e-02, PNorm = 34.8825, GNorm = 0.8059, lr_0 = 5.4045e-04
Loss = 1.1542e-01, PNorm = 34.8965, GNorm = 2.2657, lr_0 = 5.2534e-04
Validation rmse = 0.162046
Validation r2 = 0.801977
Validation mse = 0.026259
Epoch 17
Loss = 1.0658e-01, PNorm = 34.9093, GNorm = 1.4923, lr_0 = 5.1066e-04
Validation rmse = 0.157867
Validation r2 = 0.812059
Validation mse = 0.024922
Epoch 18
Loss = 9.4594e-02, PNorm = 34.9216, GNorm = 0.3886, lr_0 = 4.9638e-04
Loss = 1.0404e-01, PNorm = 34.9354, GNorm = 0.9778, lr_0 = 4.8250e-04
Validation rmse = 0.158505
Validation r2 = 0.810539
Validation mse = 0.025124
Epoch 19
Loss = 9.9347e-02, PNorm = 34.9486, GNorm = 1.1077, lr_0 = 4.6901e-04
Validation rmse = 0.156714
Validation r2 = 0.814795
Validation mse = 0.024559
Epoch 20
Loss = 1.0216e-01, PNorm = 34.9584, GNorm = 2.6565, lr_0 = 4.5590e-04
Loss = 9.8846e-02, PNorm = 34.9687, GNorm = 2.3819, lr_0 = 4.4315e-04
Loss = 1.1381e-01, PNorm = 34.9695, GNorm = 2.6778, lr_0 = 4.4190e-04
Validation rmse = 0.157186
Validation r2 = 0.813677
Validation mse = 0.024708
Epoch 21
Loss = 1.0249e-01, PNorm = 34.9810, GNorm = 0.4434, lr_0 = 4.2954e-04
Validation rmse = 0.156854
Validation r2 = 0.814465
Validation mse = 0.024603
Epoch 22
Loss = 1.0735e-01, PNorm = 34.9934, GNorm = 0.8959, lr_0 = 4.1753e-04
Loss = 9.3272e-02, PNorm = 35.0035, GNorm = 0.5476, lr_0 = 4.0586e-04
Validation rmse = 0.160315
Validation r2 = 0.806187
Validation mse = 0.025701
Epoch 23
Loss = 9.5408e-02, PNorm = 35.0130, GNorm = 1.5989, lr_0 = 3.9451e-04
Validation rmse = 0.155627
Validation r2 = 0.817355
Validation mse = 0.024220
Epoch 24
Loss = 9.7353e-02, PNorm = 35.0234, GNorm = 1.4634, lr_0 = 3.8348e-04
Loss = 8.4565e-02, PNorm = 35.0317, GNorm = 1.5937, lr_0 = 3.7276e-04
Validation rmse = 0.161990
Validation r2 = 0.802114
Validation mse = 0.026241
Epoch 25
Loss = 9.5293e-02, PNorm = 35.0416, GNorm = 0.7252, lr_0 = 3.6234e-04
Validation rmse = 0.154640
Validation r2 = 0.819666
Validation mse = 0.023913
Epoch 26
Loss = 9.7827e-02, PNorm = 35.0541, GNorm = 0.6548, lr_0 = 3.5121e-04
Validation rmse = 0.156899
Validation r2 = 0.814358
Validation mse = 0.024617
Epoch 27
Loss = 9.3075e-02, PNorm = 35.0642, GNorm = 2.8528, lr_0 = 3.4139e-04
Loss = 1.0348e-01, PNorm = 35.0725, GNorm = 2.4012, lr_0 = 3.3185e-04
Validation rmse = 0.157363
Validation r2 = 0.813257
Validation mse = 0.024763
Epoch 28
Loss = 8.0743e-02, PNorm = 35.0828, GNorm = 2.0084, lr_0 = 3.2257e-04
Validation rmse = 0.158695
Validation r2 = 0.810083
Validation mse = 0.025184
Epoch 29
Loss = 8.7368e-02, PNorm = 35.0912, GNorm = 1.9537, lr_0 = 3.1355e-04
Loss = 8.5251e-02, PNorm = 35.0998, GNorm = 1.9620, lr_0 = 3.0478e-04
Validation rmse = 0.154499
Validation r2 = 0.819994
Validation mse = 0.023870
Epoch 30
Loss = 8.1919e-02, PNorm = 35.1079, GNorm = 1.8763, lr_0 = 2.9626e-04
Validation rmse = 0.154291
Validation r2 = 0.820478
Validation mse = 0.023806
Epoch 31
Loss = 6.3018e-02, PNorm = 35.1183, GNorm = 1.7780, lr_0 = 2.8716e-04
Loss = 9.1673e-02, PNorm = 35.1253, GNorm = 1.7429, lr_0 = 2.7913e-04
Validation rmse = 0.153313
Validation r2 = 0.822747
Validation mse = 0.023505
Epoch 32
Loss = 8.0989e-02, PNorm = 35.1327, GNorm = 3.1727, lr_0 = 2.7133e-04
Validation rmse = 0.152816
Validation r2 = 0.823894
Validation mse = 0.023353
Epoch 33
Loss = 8.2069e-02, PNorm = 35.1403, GNorm = 1.6923, lr_0 = 2.6374e-04
Loss = 8.6758e-02, PNorm = 35.1476, GNorm = 0.8643, lr_0 = 2.5637e-04
Validation rmse = 0.156035
Validation r2 = 0.816397
Validation mse = 0.024347
Epoch 34
Loss = 8.6436e-02, PNorm = 35.1556, GNorm = 1.5955, lr_0 = 2.4920e-04
Validation rmse = 0.154320
Validation r2 = 0.820411
Validation mse = 0.023815
Epoch 35
Loss = 9.0872e-02, PNorm = 35.1624, GNorm = 0.7775, lr_0 = 2.4223e-04
Loss = 7.5245e-02, PNorm = 35.1698, GNorm = 0.7943, lr_0 = 2.3546e-04
Validation rmse = 0.154122
Validation r2 = 0.820871
Validation mse = 0.023754
Epoch 36
Loss = 7.3357e-02, PNorm = 35.1767, GNorm = 0.7664, lr_0 = 2.2823e-04
Validation rmse = 0.153459
Validation r2 = 0.822410
Validation mse = 0.023550
Epoch 37
Loss = 8.3958e-02, PNorm = 35.1829, GNorm = 0.5558, lr_0 = 2.2185e-04
Loss = 7.7946e-02, PNorm = 35.1908, GNorm = 1.7026, lr_0 = 2.1565e-04
Validation rmse = 0.153064
Validation r2 = 0.823321
Validation mse = 0.023429
Epoch 38
Loss = 8.1620e-02, PNorm = 35.1964, GNorm = 1.7131, lr_0 = 2.0962e-04
Validation rmse = 0.153082
Validation r2 = 0.823279
Validation mse = 0.023434
Epoch 39
Loss = 7.0705e-02, PNorm = 35.2023, GNorm = 1.3045, lr_0 = 2.0376e-04
Loss = 8.0179e-02, PNorm = 35.2082, GNorm = 1.9526, lr_0 = 1.9806e-04
Validation rmse = 0.154675
Validation r2 = 0.819584
Validation mse = 0.023924
Epoch 40
Loss = 8.6277e-02, PNorm = 35.2150, GNorm = 0.6903, lr_0 = 1.9252e-04
Validation rmse = 0.156609
Validation r2 = 0.815044
Validation mse = 0.024526
Epoch 41
Loss = 7.0166e-02, PNorm = 35.2192, GNorm = 2.7619, lr_0 = 1.8661e-04
Loss = 9.8340e-02, PNorm = 35.2259, GNorm = 1.1369, lr_0 = 1.8139e-04
Validation rmse = 0.165700
Validation r2 = 0.792947
Validation mse = 0.027457
Epoch 42
Loss = 8.7003e-02, PNorm = 35.2317, GNorm = 0.8144, lr_0 = 1.7632e-04
Validation rmse = 0.154287
Validation r2 = 0.820487
Validation mse = 0.023805
Epoch 43
Loss = 6.5810e-02, PNorm = 35.2372, GNorm = 0.6134, lr_0 = 1.7139e-04
Loss = 8.1894e-02, PNorm = 35.2429, GNorm = 0.9487, lr_0 = 1.6660e-04
Validation rmse = 0.152542
Validation r2 = 0.824525
Validation mse = 0.023269
Epoch 44
Loss = 7.3305e-02, PNorm = 35.2474, GNorm = 1.0382, lr_0 = 1.6194e-04
Validation rmse = 0.152911
Validation r2 = 0.823674
Validation mse = 0.023382
Epoch 45
Loss = 8.2659e-02, PNorm = 35.2528, GNorm = 1.1863, lr_0 = 1.5741e-04
Loss = 7.3010e-02, PNorm = 35.2572, GNorm = 1.2732, lr_0 = 1.5301e-04
Loss = 6.6428e-02, PNorm = 35.2575, GNorm = 0.8399, lr_0 = 1.5258e-04
Validation rmse = 0.152025
Validation r2 = 0.825712
Validation mse = 0.023112
Epoch 46
Loss = 6.9979e-02, PNorm = 35.2621, GNorm = 1.0503, lr_0 = 1.4831e-04
Validation rmse = 0.153747
Validation r2 = 0.821742
Validation mse = 0.023638
Epoch 47
Loss = 6.8765e-02, PNorm = 35.2663, GNorm = 0.9657, lr_0 = 1.4417e-04
Loss = 7.4740e-02, PNorm = 35.2713, GNorm = 0.7647, lr_0 = 1.4014e-04
Validation rmse = 0.151388
Validation r2 = 0.827170
Validation mse = 0.022918
Epoch 48
Loss = 7.0122e-02, PNorm = 35.2755, GNorm = 0.8873, lr_0 = 1.3622e-04
Validation rmse = 0.152313
Validation r2 = 0.825051
Validation mse = 0.023199
Epoch 49
Loss = 5.7316e-02, PNorm = 35.2780, GNorm = 0.6677, lr_0 = 1.3241e-04
Loss = 8.0837e-02, PNorm = 35.2822, GNorm = 0.5884, lr_0 = 1.2871e-04
Validation rmse = 0.152148
Validation r2 = 0.825431
Validation mse = 0.023149
Epoch 50
Loss = 7.4090e-02, PNorm = 35.2861, GNorm = 1.5666, lr_0 = 1.2511e-04
Validation rmse = 0.151801
Validation r2 = 0.826226
Validation mse = 0.023044
Epoch 51
Loss = 6.5155e-02, PNorm = 35.2901, GNorm = 1.5118, lr_0 = 1.2127e-04
Validation rmse = 0.151354
Validation r2 = 0.827247
Validation mse = 0.022908
Epoch 52
Loss = 4.3184e-02, PNorm = 35.2940, GNorm = 0.5058, lr_0 = 1.1788e-04
Loss = 7.1527e-02, PNorm = 35.2978, GNorm = 1.9430, lr_0 = 1.1458e-04
Validation rmse = 0.155655
Validation r2 = 0.817289
Validation mse = 0.024229
Epoch 53
Loss = 8.7027e-02, PNorm = 35.3014, GNorm = 1.6242, lr_0 = 1.1138e-04
Validation rmse = 0.152193
Validation r2 = 0.825326
Validation mse = 0.023163
Epoch 54
Loss = 7.3200e-02, PNorm = 35.3046, GNorm = 1.2455, lr_0 = 1.0826e-04
Loss = 7.0889e-02, PNorm = 35.3078, GNorm = 0.8438, lr_0 = 1.0524e-04
Validation rmse = 0.152209
Validation r2 = 0.825291
Validation mse = 0.023167
Epoch 55
Loss = 7.7862e-02, PNorm = 35.3111, GNorm = 2.6611, lr_0 = 1.0229e-04
Validation rmse = 0.151070
Validation r2 = 0.827895
Validation mse = 0.022822
Epoch 56
Loss = 7.2399e-02, PNorm = 35.3142, GNorm = 0.6341, lr_0 = 1.0000e-04
Loss = 7.1776e-02, PNorm = 35.3169, GNorm = 1.9405, lr_0 = 1.0000e-04
Validation rmse = 0.151142
Validation r2 = 0.827731
Validation mse = 0.022844
Epoch 57
Loss = 7.0742e-02, PNorm = 35.3207, GNorm = 0.4906, lr_0 = 1.0000e-04
Validation rmse = 0.151902
Validation r2 = 0.825994
Validation mse = 0.023074
Epoch 58
Loss = 5.1282e-02, PNorm = 35.3238, GNorm = 0.7253, lr_0 = 1.0000e-04
Loss = 6.7719e-02, PNorm = 35.3262, GNorm = 1.2089, lr_0 = 1.0000e-04
Validation rmse = 0.152303
Validation r2 = 0.825075
Validation mse = 0.023196
Epoch 59
Loss = 7.1530e-02, PNorm = 35.3293, GNorm = 1.1629, lr_0 = 1.0000e-04
Validation rmse = 0.153417
Validation r2 = 0.822506
Validation mse = 0.023537
Model 0 best validation rmse = 0.151070 on epoch 55
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.303406
Model 0 test r2 = -1.335058
Model 0 test mse = 0.092055
Ensemble test rmse = 0.303406
Ensemble test r2 = -1.335058
Ensemble test mse = 0.092055
Fold 7
Splitting data with seed 7
Total size = 926 | train size = 740 | val size = 186 | test size = 96
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.3474e-01, PNorm = 34.0191, GNorm = 1.6281, lr_0 = 4.5357e-04
Validation rmse = 0.310897
Validation r2 = 0.229081
Validation mse = 0.096657
Epoch 1
Loss = 7.9315e-01, PNorm = 34.0497, GNorm = 7.7440, lr_0 = 8.0714e-04
Validation rmse = 0.251149
Validation r2 = 0.496919
Validation mse = 0.063076
Epoch 2
Loss = 5.2374e-01, PNorm = 34.1102, GNorm = 2.2331, lr_0 = 9.8872e-04
Loss = 4.7565e-01, PNorm = 34.1831, GNorm = 1.7130, lr_0 = 9.6108e-04
Validation rmse = 0.209103
Validation r2 = 0.651265
Validation mse = 0.043724
Epoch 3
Loss = 3.2692e-01, PNorm = 34.2602, GNorm = 1.4315, lr_0 = 9.3421e-04
Validation rmse = 0.198909
Validation r2 = 0.684438
Validation mse = 0.039565
Epoch 4
Loss = 3.4651e-01, PNorm = 34.3217, GNorm = 4.5337, lr_0 = 9.0809e-04
Loss = 2.8738e-01, PNorm = 34.3912, GNorm = 1.4751, lr_0 = 8.8270e-04
Validation rmse = 0.177910
Validation r2 = 0.747549
Validation mse = 0.031652
Epoch 5
Loss = 2.2552e-01, PNorm = 34.4500, GNorm = 4.0602, lr_0 = 8.5802e-04
Validation rmse = 0.183003
Validation r2 = 0.732890
Validation mse = 0.033490
Epoch 6
Loss = 2.2786e-01, PNorm = 34.5008, GNorm = 2.8378, lr_0 = 8.3167e-04
Loss = 1.6870e-01, PNorm = 34.5460, GNorm = 2.4636, lr_0 = 8.0842e-04
Validation rmse = 0.196174
Validation r2 = 0.693057
Validation mse = 0.038484
Epoch 7
Loss = 1.8574e-01, PNorm = 34.5877, GNorm = 6.8667, lr_0 = 7.8581e-04
Validation rmse = 0.161255
Validation r2 = 0.792604
Validation mse = 0.026003
Epoch 8
Loss = 1.5000e-01, PNorm = 34.6280, GNorm = 2.2938, lr_0 = 7.6384e-04
Loss = 1.5695e-01, PNorm = 34.6621, GNorm = 1.4457, lr_0 = 7.4249e-04
Validation rmse = 0.162868
Validation r2 = 0.788434
Validation mse = 0.026526
Epoch 9
Loss = 1.7059e-01, PNorm = 34.6964, GNorm = 4.0236, lr_0 = 7.2173e-04
Validation rmse = 0.149172
Validation r2 = 0.822519
Validation mse = 0.022252
Epoch 10
Loss = 1.3419e-01, PNorm = 34.7261, GNorm = 6.3149, lr_0 = 7.0155e-04
Loss = 1.6283e-01, PNorm = 34.7487, GNorm = 4.3840, lr_0 = 6.8194e-04
Validation rmse = 0.149340
Validation r2 = 0.822120
Validation mse = 0.022302
Epoch 11
Loss = 1.6271e-01, PNorm = 34.7803, GNorm = 4.9631, lr_0 = 6.6099e-04
Validation rmse = 0.165951
Validation r2 = 0.780349
Validation mse = 0.027540
Epoch 12
Loss = 1.2137e-01, PNorm = 34.8040, GNorm = 1.9550, lr_0 = 6.4251e-04
Loss = 1.6920e-01, PNorm = 34.8280, GNorm = 3.8042, lr_0 = 6.2455e-04
Validation rmse = 0.157701
Validation r2 = 0.801644
Validation mse = 0.024870
Epoch 13
Loss = 1.3219e-01, PNorm = 34.8504, GNorm = 2.4064, lr_0 = 6.0709e-04
Validation rmse = 0.145208
Validation r2 = 0.831827
Validation mse = 0.021085
Epoch 14
Loss = 1.4470e-01, PNorm = 34.8687, GNorm = 2.5566, lr_0 = 5.9011e-04
Loss = 1.1169e-01, PNorm = 34.8906, GNorm = 3.7653, lr_0 = 5.7362e-04
Validation rmse = 0.148644
Validation r2 = 0.823774
Validation mse = 0.022095
Epoch 15
Loss = 1.1283e-01, PNorm = 34.9064, GNorm = 0.9325, lr_0 = 5.5758e-04
Validation rmse = 0.142606
Validation r2 = 0.837800
Validation mse = 0.020336
Epoch 16
Loss = 9.4007e-02, PNorm = 34.9219, GNorm = 0.8231, lr_0 = 5.4045e-04
Loss = 1.1695e-01, PNorm = 34.9372, GNorm = 1.0666, lr_0 = 5.2534e-04
Validation rmse = 0.146359
Validation r2 = 0.829150
Validation mse = 0.021421
Epoch 17
Loss = 1.0150e-01, PNorm = 34.9503, GNorm = 1.2412, lr_0 = 5.1066e-04
Validation rmse = 0.140090
Validation r2 = 0.843473
Validation mse = 0.019625
Epoch 18
Loss = 9.2956e-02, PNorm = 34.9663, GNorm = 2.4854, lr_0 = 4.9638e-04
Loss = 1.1303e-01, PNorm = 34.9784, GNorm = 1.6803, lr_0 = 4.8250e-04
Validation rmse = 0.144919
Validation r2 = 0.832496
Validation mse = 0.021001
Epoch 19
Loss = 1.0177e-01, PNorm = 34.9934, GNorm = 5.0028, lr_0 = 4.6901e-04
Validation rmse = 0.140747
Validation r2 = 0.842002
Validation mse = 0.019810
Epoch 20
Loss = 9.3500e-02, PNorm = 35.0084, GNorm = 3.5174, lr_0 = 4.5590e-04
Loss = 1.0851e-01, PNorm = 35.0194, GNorm = 1.4298, lr_0 = 4.4315e-04
Loss = 1.7035e-01, PNorm = 35.0209, GNorm = 3.0898, lr_0 = 4.4190e-04
Validation rmse = 0.140327
Validation r2 = 0.842943
Validation mse = 0.019692
Epoch 21
Loss = 1.1333e-01, PNorm = 35.0352, GNorm = 1.7336, lr_0 = 4.2954e-04
Validation rmse = 0.151409
Validation r2 = 0.817156
Validation mse = 0.022925
Epoch 22
Loss = 1.1894e-01, PNorm = 35.0480, GNorm = 1.8651, lr_0 = 4.1753e-04
Loss = 9.0320e-02, PNorm = 35.0599, GNorm = 0.8857, lr_0 = 4.0586e-04
Validation rmse = 0.139530
Validation r2 = 0.844721
Validation mse = 0.019469
Epoch 23
Loss = 9.2893e-02, PNorm = 35.0723, GNorm = 0.7210, lr_0 = 3.9451e-04
Validation rmse = 0.138075
Validation r2 = 0.847944
Validation mse = 0.019065
Epoch 24
Loss = 8.9956e-02, PNorm = 35.0834, GNorm = 2.0254, lr_0 = 3.8348e-04
Loss = 8.9965e-02, PNorm = 35.0967, GNorm = 0.5088, lr_0 = 3.7276e-04
Validation rmse = 0.140305
Validation r2 = 0.842992
Validation mse = 0.019686
Epoch 25
Loss = 9.6321e-02, PNorm = 35.1076, GNorm = 2.5726, lr_0 = 3.6234e-04
Validation rmse = 0.137188
Validation r2 = 0.849892
Validation mse = 0.018820
Epoch 26
Loss = 7.4878e-02, PNorm = 35.1176, GNorm = 1.2314, lr_0 = 3.5121e-04
Validation rmse = 0.134951
Validation r2 = 0.854747
Validation mse = 0.018212
Epoch 27
Loss = 6.2687e-02, PNorm = 35.1259, GNorm = 2.1554, lr_0 = 3.4139e-04
Loss = 9.3107e-02, PNorm = 35.1384, GNorm = 2.9921, lr_0 = 3.3185e-04
Validation rmse = 0.138976
Validation r2 = 0.845951
Validation mse = 0.019314
Epoch 28
Loss = 1.0819e-01, PNorm = 35.1492, GNorm = 3.9941, lr_0 = 3.2257e-04
Validation rmse = 0.159423
Validation r2 = 0.797290
Validation mse = 0.025416
Epoch 29
Loss = 1.1124e-01, PNorm = 35.1623, GNorm = 4.3299, lr_0 = 3.1355e-04
Loss = 1.1336e-01, PNorm = 35.1721, GNorm = 2.5460, lr_0 = 3.0478e-04
Validation rmse = 0.138425
Validation r2 = 0.847172
Validation mse = 0.019161
Epoch 30
Loss = 8.7433e-02, PNorm = 35.1826, GNorm = 1.5542, lr_0 = 2.9626e-04
Validation rmse = 0.134555
Validation r2 = 0.855598
Validation mse = 0.018105
Epoch 31
Loss = 9.0666e-02, PNorm = 35.1937, GNorm = 3.7188, lr_0 = 2.8716e-04
Loss = 1.0002e-01, PNorm = 35.2016, GNorm = 2.3032, lr_0 = 2.7913e-04
Validation rmse = 0.140776
Validation r2 = 0.841936
Validation mse = 0.019818
Epoch 32
Loss = 1.0006e-01, PNorm = 35.2132, GNorm = 4.0229, lr_0 = 2.7133e-04
Validation rmse = 0.152135
Validation r2 = 0.815400
Validation mse = 0.023145
Epoch 33
Loss = 1.2734e-01, PNorm = 35.2215, GNorm = 4.2178, lr_0 = 2.6374e-04
Loss = 9.2806e-02, PNorm = 35.2294, GNorm = 0.5057, lr_0 = 2.5637e-04
Validation rmse = 0.136647
Validation r2 = 0.851073
Validation mse = 0.018672
Epoch 34
Loss = 9.8380e-02, PNorm = 35.2369, GNorm = 4.8549, lr_0 = 2.4920e-04
Validation rmse = 0.135393
Validation r2 = 0.853794
Validation mse = 0.018331
Epoch 35
Loss = 7.7043e-02, PNorm = 35.2465, GNorm = 2.0397, lr_0 = 2.4223e-04
Loss = 9.3197e-02, PNorm = 35.2549, GNorm = 1.9583, lr_0 = 2.3546e-04
Validation rmse = 0.133527
Validation r2 = 0.857796
Validation mse = 0.017829
Epoch 36
Loss = 7.7731e-02, PNorm = 35.2626, GNorm = 2.7764, lr_0 = 2.2823e-04
Validation rmse = 0.135419
Validation r2 = 0.853737
Validation mse = 0.018338
Epoch 37
Loss = 7.8708e-02, PNorm = 35.2694, GNorm = 1.7069, lr_0 = 2.2185e-04
Loss = 7.8883e-02, PNorm = 35.2759, GNorm = 1.1461, lr_0 = 2.1565e-04
Validation rmse = 0.132733
Validation r2 = 0.859482
Validation mse = 0.017618
Epoch 38
Loss = 7.3849e-02, PNorm = 35.2831, GNorm = 1.5256, lr_0 = 2.0962e-04
Validation rmse = 0.132066
Validation r2 = 0.860891
Validation mse = 0.017441
Epoch 39
Loss = 7.0549e-02, PNorm = 35.2891, GNorm = 0.6984, lr_0 = 2.0376e-04
Loss = 8.2029e-02, PNorm = 35.2960, GNorm = 0.9468, lr_0 = 1.9806e-04
Validation rmse = 0.136647
Validation r2 = 0.851073
Validation mse = 0.018672
Epoch 40
Loss = 6.7718e-02, PNorm = 35.3011, GNorm = 2.8168, lr_0 = 1.9252e-04
Validation rmse = 0.133348
Validation r2 = 0.858176
Validation mse = 0.017782
Epoch 41
Loss = 8.4578e-02, PNorm = 35.3072, GNorm = 1.2888, lr_0 = 1.8661e-04
Loss = 7.4730e-02, PNorm = 35.3136, GNorm = 1.0260, lr_0 = 1.8139e-04
Validation rmse = 0.132971
Validation r2 = 0.858976
Validation mse = 0.017681
Epoch 42
Loss = 7.8217e-02, PNorm = 35.3182, GNorm = 1.3241, lr_0 = 1.7632e-04
Validation rmse = 0.132086
Validation r2 = 0.860847
Validation mse = 0.017447
Epoch 43
Loss = 8.6598e-02, PNorm = 35.3239, GNorm = 0.8703, lr_0 = 1.7139e-04
Loss = 6.7390e-02, PNorm = 35.3291, GNorm = 0.9545, lr_0 = 1.6660e-04
Validation rmse = 0.131810
Validation r2 = 0.861428
Validation mse = 0.017374
Epoch 44
Loss = 7.6984e-02, PNorm = 35.3343, GNorm = 3.7987, lr_0 = 1.6194e-04
Validation rmse = 0.131801
Validation r2 = 0.861449
Validation mse = 0.017371
Epoch 45
Loss = 6.7696e-02, PNorm = 35.3386, GNorm = 0.7015, lr_0 = 1.5741e-04
Loss = 8.4105e-02, PNorm = 35.3446, GNorm = 0.7106, lr_0 = 1.5301e-04
Loss = 4.7162e-02, PNorm = 35.3451, GNorm = 0.3938, lr_0 = 1.5258e-04
Validation rmse = 0.133666
Validation r2 = 0.857500
Validation mse = 0.017866
Epoch 46
Loss = 7.9755e-02, PNorm = 35.3495, GNorm = 0.6266, lr_0 = 1.4831e-04
Validation rmse = 0.134757
Validation r2 = 0.855163
Validation mse = 0.018159
Epoch 47
Loss = 7.9612e-02, PNorm = 35.3533, GNorm = 1.5911, lr_0 = 1.4417e-04
Loss = 7.7763e-02, PNorm = 35.3580, GNorm = 1.5439, lr_0 = 1.4014e-04
Validation rmse = 0.130770
Validation r2 = 0.863608
Validation mse = 0.017101
Epoch 48
Loss = 7.1614e-02, PNorm = 35.3633, GNorm = 0.9760, lr_0 = 1.3622e-04
Validation rmse = 0.132154
Validation r2 = 0.860704
Validation mse = 0.017465
Epoch 49
Loss = 7.7781e-02, PNorm = 35.3673, GNorm = 1.5005, lr_0 = 1.3241e-04
Loss = 6.8989e-02, PNorm = 35.3717, GNorm = 1.0376, lr_0 = 1.2871e-04
Validation rmse = 0.132624
Validation r2 = 0.859711
Validation mse = 0.017589
Epoch 50
Loss = 6.8220e-02, PNorm = 35.3751, GNorm = 1.5095, lr_0 = 1.2511e-04
Validation rmse = 0.130600
Validation r2 = 0.863961
Validation mse = 0.017056
Epoch 51
Loss = 8.2865e-02, PNorm = 35.3794, GNorm = 1.6863, lr_0 = 1.2127e-04
Validation rmse = 0.131046
Validation r2 = 0.863031
Validation mse = 0.017173
Epoch 52
Loss = 7.7070e-02, PNorm = 35.3831, GNorm = 0.8758, lr_0 = 1.1788e-04
Loss = 7.1376e-02, PNorm = 35.3864, GNorm = 0.5187, lr_0 = 1.1458e-04
Validation rmse = 0.131237
Validation r2 = 0.862631
Validation mse = 0.017223
Epoch 53
Loss = 6.8447e-02, PNorm = 35.3902, GNorm = 1.6659, lr_0 = 1.1138e-04
Validation rmse = 0.129990
Validation r2 = 0.865228
Validation mse = 0.016898
Epoch 54
Loss = 4.5520e-02, PNorm = 35.3936, GNorm = 1.2172, lr_0 = 1.0826e-04
Loss = 7.1029e-02, PNorm = 35.3970, GNorm = 0.6731, lr_0 = 1.0524e-04
Validation rmse = 0.131020
Validation r2 = 0.863084
Validation mse = 0.017166
Epoch 55
Loss = 7.0141e-02, PNorm = 35.4000, GNorm = 1.0365, lr_0 = 1.0229e-04
Validation rmse = 0.131707
Validation r2 = 0.861646
Validation mse = 0.017347
Epoch 56
Loss = 6.4600e-02, PNorm = 35.4036, GNorm = 1.5593, lr_0 = 1.0000e-04
Loss = 6.4707e-02, PNorm = 35.4064, GNorm = 0.7678, lr_0 = 1.0000e-04
Validation rmse = 0.130737
Validation r2 = 0.863675
Validation mse = 0.017092
Epoch 57
Loss = 8.0969e-02, PNorm = 35.4094, GNorm = 2.1529, lr_0 = 1.0000e-04
Validation rmse = 0.134244
Validation r2 = 0.856263
Validation mse = 0.018022
Epoch 58
Loss = 5.7073e-02, PNorm = 35.4133, GNorm = 0.6092, lr_0 = 1.0000e-04
Loss = 6.3035e-02, PNorm = 35.4163, GNorm = 1.8215, lr_0 = 1.0000e-04
Validation rmse = 0.132958
Validation r2 = 0.859005
Validation mse = 0.017678
Epoch 59
Loss = 7.1351e-02, PNorm = 35.4197, GNorm = 2.4111, lr_0 = 1.0000e-04
Validation rmse = 0.129256
Validation r2 = 0.866746
Validation mse = 0.016707
Model 0 best validation rmse = 0.129256 on epoch 59
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.309890
Model 0 test r2 = -1.435918
Model 0 test mse = 0.096032
Ensemble test rmse = 0.309890
Ensemble test r2 = -1.435918
Ensemble test mse = 0.096032
Fold 8
Splitting data with seed 8
Total size = 926 | train size = 740 | val size = 186 | test size = 96
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.0013e-01, PNorm = 34.0189, GNorm = 1.2745, lr_0 = 4.5357e-04
Validation rmse = 0.307928
Validation r2 = 0.173631
Validation mse = 0.094820
Epoch 1
Loss = 6.9118e-01, PNorm = 34.0599, GNorm = 1.9155, lr_0 = 8.0714e-04
Validation rmse = 0.247765
Validation r2 = 0.464998
Validation mse = 0.061387
Epoch 2
Loss = 5.6714e-01, PNorm = 34.1154, GNorm = 3.9714, lr_0 = 9.8872e-04
Loss = 4.6884e-01, PNorm = 34.1880, GNorm = 9.8700, lr_0 = 9.6108e-04
Validation rmse = 0.216571
Validation r2 = 0.591233
Validation mse = 0.046903
Epoch 3
Loss = 4.0507e-01, PNorm = 34.2498, GNorm = 8.1018, lr_0 = 9.3421e-04
Validation rmse = 0.200989
Validation r2 = 0.647937
Validation mse = 0.040397
Epoch 4
Loss = 3.1655e-01, PNorm = 34.3182, GNorm = 0.6389, lr_0 = 9.0809e-04
Loss = 3.1160e-01, PNorm = 34.3762, GNorm = 4.1924, lr_0 = 8.8270e-04
Validation rmse = 0.191381
Validation r2 = 0.680792
Validation mse = 0.036627
Epoch 5
Loss = 2.3206e-01, PNorm = 34.4338, GNorm = 6.1954, lr_0 = 8.5802e-04
Validation rmse = 0.187318
Validation r2 = 0.694202
Validation mse = 0.035088
Epoch 6
Loss = 1.8075e-01, PNorm = 34.4916, GNorm = 2.3947, lr_0 = 8.3167e-04
Loss = 2.3286e-01, PNorm = 34.5344, GNorm = 0.9089, lr_0 = 8.0842e-04
Validation rmse = 0.174051
Validation r2 = 0.735985
Validation mse = 0.030294
Epoch 7
Loss = 2.1613e-01, PNorm = 34.5785, GNorm = 3.0390, lr_0 = 7.8581e-04
Validation rmse = 0.171624
Validation r2 = 0.743297
Validation mse = 0.029455
Epoch 8
Loss = 1.4559e-01, PNorm = 34.6220, GNorm = 1.5688, lr_0 = 7.6384e-04
Loss = 1.5212e-01, PNorm = 34.6566, GNorm = 1.5772, lr_0 = 7.4249e-04
Validation rmse = 0.171732
Validation r2 = 0.742973
Validation mse = 0.029492
Epoch 9
Loss = 1.6586e-01, PNorm = 34.6862, GNorm = 1.5261, lr_0 = 7.2173e-04
Validation rmse = 0.155855
Validation r2 = 0.788301
Validation mse = 0.024291
Epoch 10
Loss = 8.8140e-02, PNorm = 34.7209, GNorm = 1.9087, lr_0 = 7.0155e-04
Loss = 1.4540e-01, PNorm = 34.7411, GNorm = 2.4622, lr_0 = 6.8194e-04
Validation rmse = 0.154669
Validation r2 = 0.791511
Validation mse = 0.023923
Epoch 11
Loss = 1.2627e-01, PNorm = 34.7734, GNorm = 3.8426, lr_0 = 6.6099e-04
Validation rmse = 0.153609
Validation r2 = 0.794360
Validation mse = 0.023596
Epoch 12
Loss = 1.2832e-01, PNorm = 34.7944, GNorm = 4.2239, lr_0 = 6.4251e-04
Loss = 1.0889e-01, PNorm = 34.8149, GNorm = 4.0085, lr_0 = 6.2455e-04
Validation rmse = 0.153923
Validation r2 = 0.793517
Validation mse = 0.023692
Epoch 13
Loss = 1.2340e-01, PNorm = 34.8340, GNorm = 3.1236, lr_0 = 6.0709e-04
Validation rmse = 0.151641
Validation r2 = 0.799596
Validation mse = 0.022995
Epoch 14
Loss = 1.3424e-01, PNorm = 34.8525, GNorm = 1.9710, lr_0 = 5.9011e-04
Loss = 1.1082e-01, PNorm = 34.8721, GNorm = 1.5451, lr_0 = 5.7362e-04
Validation rmse = 0.163779
Validation r2 = 0.766228
Validation mse = 0.026824
Epoch 15
Loss = 1.2991e-01, PNorm = 34.8894, GNorm = 3.1209, lr_0 = 5.5758e-04
Validation rmse = 0.157582
Validation r2 = 0.783585
Validation mse = 0.024832
Epoch 16
Loss = 1.0313e-01, PNorm = 34.9069, GNorm = 3.4395, lr_0 = 5.4045e-04
Loss = 1.0857e-01, PNorm = 34.9246, GNorm = 1.1656, lr_0 = 5.2534e-04
Validation rmse = 0.151284
Validation r2 = 0.800537
Validation mse = 0.022887
Epoch 17
Loss = 1.0921e-01, PNorm = 34.9416, GNorm = 0.5838, lr_0 = 5.1066e-04
Validation rmse = 0.144771
Validation r2 = 0.817343
Validation mse = 0.020959
Epoch 18
Loss = 1.0370e-01, PNorm = 34.9548, GNorm = 0.7278, lr_0 = 4.9638e-04
Loss = 1.0399e-01, PNorm = 34.9655, GNorm = 1.0526, lr_0 = 4.8250e-04
Validation rmse = 0.152284
Validation r2 = 0.797890
Validation mse = 0.023191
Epoch 19
Loss = 1.0580e-01, PNorm = 34.9829, GNorm = 0.6063, lr_0 = 4.6901e-04
Validation rmse = 0.154335
Validation r2 = 0.792410
Validation mse = 0.023819
Epoch 20
Loss = 1.0389e-01, PNorm = 34.9947, GNorm = 1.6620, lr_0 = 4.5590e-04
Loss = 9.6758e-02, PNorm = 35.0055, GNorm = 1.8350, lr_0 = 4.4315e-04
Loss = 1.4572e-01, PNorm = 35.0064, GNorm = 1.5554, lr_0 = 4.4190e-04
Validation rmse = 0.145560
Validation r2 = 0.815345
Validation mse = 0.021188
Epoch 21
Loss = 1.0355e-01, PNorm = 35.0189, GNorm = 0.8158, lr_0 = 4.2954e-04
Validation rmse = 0.144286
Validation r2 = 0.818565
Validation mse = 0.020818
Epoch 22
Loss = 8.9170e-02, PNorm = 35.0308, GNorm = 1.0219, lr_0 = 4.1753e-04
Loss = 9.4770e-02, PNorm = 35.0425, GNorm = 0.5416, lr_0 = 4.0586e-04
Validation rmse = 0.144291
Validation r2 = 0.818552
Validation mse = 0.020820
Epoch 23
Loss = 8.4856e-02, PNorm = 35.0554, GNorm = 0.9749, lr_0 = 3.9451e-04
Validation rmse = 0.140836
Validation r2 = 0.827137
Validation mse = 0.019835
Epoch 24
Loss = 1.0549e-01, PNorm = 35.0672, GNorm = 0.7749, lr_0 = 3.8348e-04
Loss = 1.0932e-01, PNorm = 35.0753, GNorm = 4.9018, lr_0 = 3.7276e-04
Validation rmse = 0.150580
Validation r2 = 0.802390
Validation mse = 0.022674
Epoch 25
Loss = 1.0198e-01, PNorm = 35.0899, GNorm = 2.5772, lr_0 = 3.6234e-04
Validation rmse = 0.148784
Validation r2 = 0.807076
Validation mse = 0.022137
Epoch 26
Loss = 9.0198e-02, PNorm = 35.1016, GNorm = 1.1233, lr_0 = 3.5121e-04
Validation rmse = 0.142710
Validation r2 = 0.822504
Validation mse = 0.020366
Epoch 27
Loss = 1.0189e-01, PNorm = 35.1119, GNorm = 1.1024, lr_0 = 3.4139e-04
Loss = 8.5907e-02, PNorm = 35.1239, GNorm = 1.6095, lr_0 = 3.3185e-04
Validation rmse = 0.139467
Validation r2 = 0.830480
Validation mse = 0.019451
Epoch 28
Loss = 8.0667e-02, PNorm = 35.1315, GNorm = 0.8462, lr_0 = 3.2257e-04
Validation rmse = 0.148774
Validation r2 = 0.807102
Validation mse = 0.022134
Epoch 29
Loss = 1.0285e-01, PNorm = 35.1404, GNorm = 1.8861, lr_0 = 3.1355e-04
Loss = 8.7362e-02, PNorm = 35.1473, GNorm = 1.5999, lr_0 = 3.0478e-04
Validation rmse = 0.140641
Validation r2 = 0.827614
Validation mse = 0.019780
Epoch 30
Loss = 8.4357e-02, PNorm = 35.1565, GNorm = 1.5095, lr_0 = 2.9626e-04
Validation rmse = 0.140426
Validation r2 = 0.828141
Validation mse = 0.019719
Epoch 31
Loss = 1.0201e-01, PNorm = 35.1660, GNorm = 1.0856, lr_0 = 2.8716e-04
Loss = 7.4258e-02, PNorm = 35.1735, GNorm = 1.2296, lr_0 = 2.7913e-04
Validation rmse = 0.143328
Validation r2 = 0.820964
Validation mse = 0.020543
Epoch 32
Loss = 8.6318e-02, PNorm = 35.1816, GNorm = 1.9113, lr_0 = 2.7133e-04
Validation rmse = 0.139385
Validation r2 = 0.830680
Validation mse = 0.019428
Epoch 33
Loss = 7.8882e-02, PNorm = 35.1886, GNorm = 1.5373, lr_0 = 2.6374e-04
Loss = 7.8275e-02, PNorm = 35.1981, GNorm = 0.8005, lr_0 = 2.5637e-04
Validation rmse = 0.140266
Validation r2 = 0.828533
Validation mse = 0.019675
Epoch 34
Loss = 9.1133e-02, PNorm = 35.2066, GNorm = 4.1845, lr_0 = 2.4920e-04
Validation rmse = 0.142716
Validation r2 = 0.822491
Validation mse = 0.020368
Epoch 35
Loss = 5.4604e-02, PNorm = 35.2125, GNorm = 0.8383, lr_0 = 2.4223e-04
Loss = 8.3464e-02, PNorm = 35.2200, GNorm = 0.7017, lr_0 = 2.3546e-04
Validation rmse = 0.139369
Validation r2 = 0.830719
Validation mse = 0.019424
Epoch 36
Loss = 8.0132e-02, PNorm = 35.2269, GNorm = 2.0122, lr_0 = 2.2823e-04
Validation rmse = 0.138645
Validation r2 = 0.832472
Validation mse = 0.019223
Epoch 37
Loss = 7.3610e-02, PNorm = 35.2325, GNorm = 2.4804, lr_0 = 2.2185e-04
Loss = 7.7231e-02, PNorm = 35.2390, GNorm = 1.8235, lr_0 = 2.1565e-04
Validation rmse = 0.139038
Validation r2 = 0.831522
Validation mse = 0.019332
Epoch 38
Loss = 6.6149e-02, PNorm = 35.2450, GNorm = 0.5539, lr_0 = 2.0962e-04
Validation rmse = 0.137709
Validation r2 = 0.834729
Validation mse = 0.018964
Epoch 39
Loss = 7.3365e-02, PNorm = 35.2508, GNorm = 0.7862, lr_0 = 2.0376e-04
Loss = 7.4707e-02, PNorm = 35.2558, GNorm = 0.5512, lr_0 = 1.9806e-04
Validation rmse = 0.138376
Validation r2 = 0.833122
Validation mse = 0.019148
Epoch 40
Loss = 6.9980e-02, PNorm = 35.2619, GNorm = 3.0609, lr_0 = 1.9252e-04
Validation rmse = 0.146300
Validation r2 = 0.813462
Validation mse = 0.021404
Epoch 41
Loss = 8.0830e-02, PNorm = 35.2687, GNorm = 2.4004, lr_0 = 1.8661e-04
Loss = 8.1147e-02, PNorm = 35.2743, GNorm = 0.9587, lr_0 = 1.8139e-04
Validation rmse = 0.138883
Validation r2 = 0.831898
Validation mse = 0.019288
Epoch 42
Loss = 7.6449e-02, PNorm = 35.2786, GNorm = 0.8542, lr_0 = 1.7632e-04
Validation rmse = 0.138792
Validation r2 = 0.832118
Validation mse = 0.019263
Epoch 43
Loss = 9.5916e-02, PNorm = 35.2832, GNorm = 0.5281, lr_0 = 1.7139e-04
Loss = 6.3871e-02, PNorm = 35.2881, GNorm = 0.9559, lr_0 = 1.6660e-04
Validation rmse = 0.137667
Validation r2 = 0.834829
Validation mse = 0.018952
Epoch 44
Loss = 7.1071e-02, PNorm = 35.2913, GNorm = 2.5377, lr_0 = 1.6194e-04
Validation rmse = 0.138406
Validation r2 = 0.833051
Validation mse = 0.019156
Epoch 45
Loss = 7.0711e-02, PNorm = 35.2973, GNorm = 0.4970, lr_0 = 1.5741e-04
Loss = 7.5173e-02, PNorm = 35.3022, GNorm = 0.9853, lr_0 = 1.5301e-04
Loss = 4.2163e-02, PNorm = 35.3026, GNorm = 0.4857, lr_0 = 1.5258e-04
Validation rmse = 0.137816
Validation r2 = 0.834470
Validation mse = 0.018993
Epoch 46
Loss = 7.9085e-02, PNorm = 35.3067, GNorm = 0.5677, lr_0 = 1.4831e-04
Validation rmse = 0.137094
Validation r2 = 0.836201
Validation mse = 0.018795
Epoch 47
Loss = 7.6130e-02, PNorm = 35.3114, GNorm = 2.2786, lr_0 = 1.4417e-04
Loss = 7.2878e-02, PNorm = 35.3164, GNorm = 1.4096, lr_0 = 1.4014e-04
Validation rmse = 0.139973
Validation r2 = 0.829249
Validation mse = 0.019592
Epoch 48
Loss = 6.9108e-02, PNorm = 35.3190, GNorm = 1.2918, lr_0 = 1.3622e-04
Validation rmse = 0.138598
Validation r2 = 0.832587
Validation mse = 0.019209
Epoch 49
Loss = 7.3608e-02, PNorm = 35.3234, GNorm = 3.5254, lr_0 = 1.3241e-04
Loss = 7.4473e-02, PNorm = 35.3263, GNorm = 1.3701, lr_0 = 1.2871e-04
Validation rmse = 0.136799
Validation r2 = 0.836906
Validation mse = 0.018714
Epoch 50
Loss = 7.1656e-02, PNorm = 35.3303, GNorm = 1.1989, lr_0 = 1.2511e-04
Validation rmse = 0.138209
Validation r2 = 0.833525
Validation mse = 0.019102
Epoch 51
Loss = 7.1192e-02, PNorm = 35.3336, GNorm = 0.8180, lr_0 = 1.2127e-04
Validation rmse = 0.137824
Validation r2 = 0.834451
Validation mse = 0.018995
Epoch 52
Loss = 6.8111e-02, PNorm = 35.3377, GNorm = 0.8930, lr_0 = 1.1788e-04
Loss = 6.6589e-02, PNorm = 35.3414, GNorm = 0.6877, lr_0 = 1.1458e-04
Validation rmse = 0.137596
Validation r2 = 0.835000
Validation mse = 0.018933
Epoch 53
Loss = 6.7989e-02, PNorm = 35.3443, GNorm = 0.9409, lr_0 = 1.1138e-04
Validation rmse = 0.137190
Validation r2 = 0.835972
Validation mse = 0.018821
Epoch 54
Loss = 7.2083e-02, PNorm = 35.3469, GNorm = 2.5332, lr_0 = 1.0826e-04
Loss = 7.1811e-02, PNorm = 35.3495, GNorm = 0.8050, lr_0 = 1.0524e-04
Validation rmse = 0.137223
Validation r2 = 0.835892
Validation mse = 0.018830
Epoch 55
Loss = 7.2866e-02, PNorm = 35.3529, GNorm = 2.5831, lr_0 = 1.0229e-04
Validation rmse = 0.141607
Validation r2 = 0.825238
Validation mse = 0.020053
Epoch 56
Loss = 6.5540e-02, PNorm = 35.3569, GNorm = 0.8153, lr_0 = 1.0000e-04
Loss = 7.7793e-02, PNorm = 35.3600, GNorm = 0.5518, lr_0 = 1.0000e-04
Validation rmse = 0.138951
Validation r2 = 0.831732
Validation mse = 0.019307
Epoch 57
Loss = 7.4800e-02, PNorm = 35.3628, GNorm = 0.9334, lr_0 = 1.0000e-04
Validation rmse = 0.138826
Validation r2 = 0.832036
Validation mse = 0.019273
Epoch 58
Loss = 4.3244e-02, PNorm = 35.3661, GNorm = 0.4019, lr_0 = 1.0000e-04
Loss = 7.1690e-02, PNorm = 35.3688, GNorm = 1.2475, lr_0 = 1.0000e-04
Validation rmse = 0.137278
Validation r2 = 0.835760
Validation mse = 0.018845
Epoch 59
Loss = 6.1990e-02, PNorm = 35.3713, GNorm = 1.7708, lr_0 = 1.0000e-04
Validation rmse = 0.136781
Validation r2 = 0.836948
Validation mse = 0.018709
Model 0 best validation rmse = 0.136781 on epoch 59
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.331970
Model 0 test r2 = -1.795418
Model 0 test mse = 0.110204
Ensemble test rmse = 0.331970
Ensemble test r2 = -1.795418
Ensemble test mse = 0.110204
Fold 9
Splitting data with seed 9
Total size = 926 | train size = 740 | val size = 186 | test size = 96
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.0388e-01, PNorm = 34.0189, GNorm = 0.8471, lr_0 = 4.5357e-04
Validation rmse = 0.293229
Validation r2 = 0.300969
Validation mse = 0.085983
Epoch 1
Loss = 6.2858e-01, PNorm = 34.0609, GNorm = 0.7791, lr_0 = 8.0714e-04
Validation rmse = 0.259369
Validation r2 = 0.453087
Validation mse = 0.067272
Epoch 2
Loss = 5.6580e-01, PNorm = 34.1167, GNorm = 1.8299, lr_0 = 9.8872e-04
Loss = 4.3577e-01, PNorm = 34.1872, GNorm = 2.1114, lr_0 = 9.6108e-04
Validation rmse = 0.243697
Validation r2 = 0.517181
Validation mse = 0.059388
Epoch 3
Loss = 4.0512e-01, PNorm = 34.2460, GNorm = 0.8381, lr_0 = 9.3421e-04
Validation rmse = 0.221178
Validation r2 = 0.602289
Validation mse = 0.048920
Epoch 4
Loss = 3.9311e-01, PNorm = 34.3011, GNorm = 7.2872, lr_0 = 9.0809e-04
Loss = 3.0247e-01, PNorm = 34.3551, GNorm = 1.4811, lr_0 = 8.8270e-04
Validation rmse = 0.203661
Validation r2 = 0.662790
Validation mse = 0.041478
Epoch 5
Loss = 2.5824e-01, PNorm = 34.4091, GNorm = 3.8032, lr_0 = 8.5802e-04
Validation rmse = 0.194593
Validation r2 = 0.692150
Validation mse = 0.037867
Epoch 6
Loss = 2.2045e-01, PNorm = 34.4614, GNorm = 1.4257, lr_0 = 8.3167e-04
Loss = 2.1175e-01, PNorm = 34.5092, GNorm = 1.9562, lr_0 = 8.0842e-04
Validation rmse = 0.197908
Validation r2 = 0.681573
Validation mse = 0.039168
Epoch 7
Loss = 2.3386e-01, PNorm = 34.5492, GNorm = 1.4145, lr_0 = 7.8581e-04
Validation rmse = 0.180893
Validation r2 = 0.733973
Validation mse = 0.032722
Epoch 8
Loss = 2.2729e-01, PNorm = 34.5862, GNorm = 0.7594, lr_0 = 7.6384e-04
Loss = 1.7463e-01, PNorm = 34.6250, GNorm = 1.3958, lr_0 = 7.4249e-04
Validation rmse = 0.163179
Validation r2 = 0.783524
Validation mse = 0.026627
Epoch 9
Loss = 1.3101e-01, PNorm = 34.6545, GNorm = 2.6922, lr_0 = 7.2173e-04
Validation rmse = 0.164901
Validation r2 = 0.778932
Validation mse = 0.027192
Epoch 10
Loss = 1.3904e-01, PNorm = 34.6848, GNorm = 2.5902, lr_0 = 7.0155e-04
Loss = 1.3085e-01, PNorm = 34.7107, GNorm = 2.4917, lr_0 = 6.8194e-04
Validation rmse = 0.156187
Validation r2 = 0.801677
Validation mse = 0.024394
Epoch 11
Loss = 1.2813e-01, PNorm = 34.7407, GNorm = 2.1792, lr_0 = 6.6099e-04
Validation rmse = 0.154018
Validation r2 = 0.807147
Validation mse = 0.023722
Epoch 12
Loss = 1.2224e-01, PNorm = 34.7620, GNorm = 0.6889, lr_0 = 6.4251e-04
Loss = 1.2951e-01, PNorm = 34.7836, GNorm = 2.2706, lr_0 = 6.2455e-04
Validation rmse = 0.153183
Validation r2 = 0.809234
Validation mse = 0.023465
Epoch 13
Loss = 1.1510e-01, PNorm = 34.8011, GNorm = 1.6463, lr_0 = 6.0709e-04
Validation rmse = 0.143222
Validation r2 = 0.833237
Validation mse = 0.020512
Epoch 14
Loss = 1.0423e-01, PNorm = 34.8202, GNorm = 0.5295, lr_0 = 5.9011e-04
Loss = 1.1352e-01, PNorm = 34.8398, GNorm = 2.0772, lr_0 = 5.7362e-04
Validation rmse = 0.140764
Validation r2 = 0.838912
Validation mse = 0.019814
Epoch 15
Loss = 1.1385e-01, PNorm = 34.8529, GNorm = 4.9163, lr_0 = 5.5758e-04
Validation rmse = 0.147784
Validation r2 = 0.822443
Validation mse = 0.021840
Epoch 16
Loss = 1.1508e-01, PNorm = 34.8684, GNorm = 1.1971, lr_0 = 5.4045e-04
Loss = 1.2611e-01, PNorm = 34.8830, GNorm = 2.3384, lr_0 = 5.2534e-04
Validation rmse = 0.143446
Validation r2 = 0.832715
Validation mse = 0.020577
Epoch 17
Loss = 1.2168e-01, PNorm = 34.8987, GNorm = 3.3760, lr_0 = 5.1066e-04
Validation rmse = 0.143305
Validation r2 = 0.833043
Validation mse = 0.020536
Epoch 18
Loss = 1.0301e-01, PNorm = 34.9124, GNorm = 0.8342, lr_0 = 4.9638e-04
Loss = 1.0968e-01, PNorm = 34.9287, GNorm = 1.4370, lr_0 = 4.8250e-04
Validation rmse = 0.142068
Validation r2 = 0.835912
Validation mse = 0.020183
Epoch 19
Loss = 1.0217e-01, PNorm = 34.9433, GNorm = 3.1533, lr_0 = 4.6901e-04
Validation rmse = 0.138890
Validation r2 = 0.843171
Validation mse = 0.019290
Epoch 20
Loss = 8.8304e-02, PNorm = 34.9550, GNorm = 2.8178, lr_0 = 4.5590e-04
Loss = 1.0014e-01, PNorm = 34.9686, GNorm = 1.9436, lr_0 = 4.4315e-04
Loss = 6.6034e-02, PNorm = 34.9700, GNorm = 0.8553, lr_0 = 4.4190e-04
Validation rmse = 0.142514
Validation r2 = 0.834880
Validation mse = 0.020310
Epoch 21
Loss = 9.9353e-02, PNorm = 34.9833, GNorm = 5.3973, lr_0 = 4.2954e-04
Validation rmse = 0.143550
Validation r2 = 0.832470
Validation mse = 0.020607
Epoch 22
Loss = 8.4499e-02, PNorm = 34.9975, GNorm = 1.2207, lr_0 = 4.1753e-04
Loss = 9.7896e-02, PNorm = 35.0106, GNorm = 1.3391, lr_0 = 4.0586e-04
Validation rmse = 0.154500
Validation r2 = 0.805938
Validation mse = 0.023870
Epoch 23
Loss = 1.0699e-01, PNorm = 35.0205, GNorm = 2.8364, lr_0 = 3.9451e-04
Validation rmse = 0.142001
Validation r2 = 0.836068
Validation mse = 0.020164
Epoch 24
Loss = 1.0100e-01, PNorm = 35.0324, GNorm = 1.3613, lr_0 = 3.8348e-04
Loss = 8.6480e-02, PNorm = 35.0455, GNorm = 1.1753, lr_0 = 3.7276e-04
Validation rmse = 0.137736
Validation r2 = 0.845766
Validation mse = 0.018971
Epoch 25
Loss = 9.0838e-02, PNorm = 35.0543, GNorm = 0.8435, lr_0 = 3.6234e-04
Validation rmse = 0.140761
Validation r2 = 0.838918
Validation mse = 0.019814
Epoch 26
Loss = 9.2788e-02, PNorm = 35.0667, GNorm = 1.0724, lr_0 = 3.5121e-04
Validation rmse = 0.140850
Validation r2 = 0.838715
Validation mse = 0.019839
Epoch 27
Loss = 9.4087e-02, PNorm = 35.0766, GNorm = 0.8743, lr_0 = 3.4139e-04
Loss = 9.0311e-02, PNorm = 35.0877, GNorm = 1.4349, lr_0 = 3.3185e-04
Validation rmse = 0.137337
Validation r2 = 0.846660
Validation mse = 0.018861
Epoch 28
Loss = 8.5338e-02, PNorm = 35.0959, GNorm = 2.7400, lr_0 = 3.2257e-04
Validation rmse = 0.138184
Validation r2 = 0.844762
Validation mse = 0.019095
Epoch 29
Loss = 7.5726e-02, PNorm = 35.1060, GNorm = 2.7695, lr_0 = 3.1355e-04
Loss = 1.0706e-01, PNorm = 35.1165, GNorm = 3.7768, lr_0 = 3.0478e-04
Validation rmse = 0.135542
Validation r2 = 0.850640
Validation mse = 0.018372
Epoch 30
Loss = 8.2267e-02, PNorm = 35.1250, GNorm = 2.0744, lr_0 = 2.9626e-04
Validation rmse = 0.137891
Validation r2 = 0.845421
Validation mse = 0.019014
Epoch 31
Loss = 8.7919e-02, PNorm = 35.1367, GNorm = 1.5829, lr_0 = 2.8716e-04
Loss = 8.6333e-02, PNorm = 35.1453, GNorm = 0.8857, lr_0 = 2.7913e-04
Validation rmse = 0.137738
Validation r2 = 0.845763
Validation mse = 0.018972
Epoch 32
Loss = 7.7036e-02, PNorm = 35.1529, GNorm = 1.0396, lr_0 = 2.7133e-04
Validation rmse = 0.135170
Validation r2 = 0.851460
Validation mse = 0.018271
Epoch 33
Loss = 8.7694e-02, PNorm = 35.1604, GNorm = 2.6825, lr_0 = 2.6374e-04
Loss = 7.7550e-02, PNorm = 35.1683, GNorm = 1.0887, lr_0 = 2.5637e-04
Validation rmse = 0.139952
Validation r2 = 0.840764
Validation mse = 0.019587
Epoch 34
Loss = 7.7805e-02, PNorm = 35.1755, GNorm = 1.0114, lr_0 = 2.4920e-04
Validation rmse = 0.137788
Validation r2 = 0.845651
Validation mse = 0.018985
Epoch 35
Loss = 8.8186e-02, PNorm = 35.1823, GNorm = 0.8561, lr_0 = 2.4223e-04
Loss = 8.3060e-02, PNorm = 35.1903, GNorm = 2.6975, lr_0 = 2.3546e-04
Validation rmse = 0.134961
Validation r2 = 0.851919
Validation mse = 0.018215
Epoch 36
Loss = 7.3190e-02, PNorm = 35.1980, GNorm = 1.3288, lr_0 = 2.2823e-04
Validation rmse = 0.136658
Validation r2 = 0.848172
Validation mse = 0.018675
Epoch 37
Loss = 6.6181e-02, PNorm = 35.2050, GNorm = 1.4063, lr_0 = 2.2185e-04
Loss = 7.7330e-02, PNorm = 35.2118, GNorm = 4.4360, lr_0 = 2.1565e-04
Validation rmse = 0.136586
Validation r2 = 0.848332
Validation mse = 0.018656
Epoch 38
Loss = 7.8973e-02, PNorm = 35.2175, GNorm = 1.5688, lr_0 = 2.0962e-04
Validation rmse = 0.138370
Validation r2 = 0.844344
Validation mse = 0.019146
Epoch 39
Loss = 7.2247e-02, PNorm = 35.2235, GNorm = 1.5687, lr_0 = 2.0376e-04
Loss = 7.9839e-02, PNorm = 35.2293, GNorm = 1.1646, lr_0 = 1.9806e-04
Validation rmse = 0.136313
Validation r2 = 0.848937
Validation mse = 0.018581
Epoch 40
Loss = 8.0749e-02, PNorm = 35.2358, GNorm = 1.3071, lr_0 = 1.9252e-04
Validation rmse = 0.136792
Validation r2 = 0.847874
Validation mse = 0.018712
Epoch 41
Loss = 8.0102e-02, PNorm = 35.2430, GNorm = 1.1228, lr_0 = 1.8661e-04
Loss = 6.9782e-02, PNorm = 35.2489, GNorm = 2.4792, lr_0 = 1.8139e-04
Validation rmse = 0.134878
Validation r2 = 0.852102
Validation mse = 0.018192
Epoch 42
Loss = 7.0224e-02, PNorm = 35.2538, GNorm = 1.1145, lr_0 = 1.7632e-04
Validation rmse = 0.136386
Validation r2 = 0.848776
Validation mse = 0.018601
Epoch 43
Loss = 6.6168e-02, PNorm = 35.2587, GNorm = 3.1082, lr_0 = 1.7139e-04
Loss = 8.1388e-02, PNorm = 35.2640, GNorm = 3.3901, lr_0 = 1.6660e-04
Validation rmse = 0.136454
Validation r2 = 0.848624
Validation mse = 0.018620
Epoch 44
Loss = 6.9598e-02, PNorm = 35.2703, GNorm = 1.7482, lr_0 = 1.6194e-04
Validation rmse = 0.135420
Validation r2 = 0.850911
Validation mse = 0.018339
Epoch 45
Loss = 7.7267e-02, PNorm = 35.2756, GNorm = 1.3572, lr_0 = 1.5741e-04
Loss = 7.1664e-02, PNorm = 35.2812, GNorm = 1.5698, lr_0 = 1.5301e-04
Loss = 1.0747e-01, PNorm = 35.2816, GNorm = 1.2355, lr_0 = 1.5258e-04
Validation rmse = 0.134834
Validation r2 = 0.852197
Validation mse = 0.018180
Epoch 46
Loss = 7.3413e-02, PNorm = 35.2861, GNorm = 1.7686, lr_0 = 1.4831e-04
Validation rmse = 0.137345
Validation r2 = 0.846641
Validation mse = 0.018864
Epoch 47
Loss = 6.3780e-02, PNorm = 35.2900, GNorm = 0.8486, lr_0 = 1.4417e-04
Loss = 7.9751e-02, PNorm = 35.2941, GNorm = 0.8918, lr_0 = 1.4014e-04
Validation rmse = 0.135362
Validation r2 = 0.851038
Validation mse = 0.018323
Epoch 48
Loss = 7.3341e-02, PNorm = 35.2989, GNorm = 1.9492, lr_0 = 1.3622e-04
Validation rmse = 0.136698
Validation r2 = 0.848084
Validation mse = 0.018686
Epoch 49
Loss = 7.6263e-02, PNorm = 35.3035, GNorm = 1.1578, lr_0 = 1.3241e-04
Loss = 7.1323e-02, PNorm = 35.3082, GNorm = 3.1619, lr_0 = 1.2871e-04
Validation rmse = 0.135323
Validation r2 = 0.851123
Validation mse = 0.018312
Epoch 50
Loss = 7.0228e-02, PNorm = 35.3118, GNorm = 2.0044, lr_0 = 1.2511e-04
Validation rmse = 0.134917
Validation r2 = 0.852016
Validation mse = 0.018203
Epoch 51
Loss = 8.1489e-02, PNorm = 35.3158, GNorm = 0.7212, lr_0 = 1.2127e-04
Validation rmse = 0.135342
Validation r2 = 0.851083
Validation mse = 0.018317
Epoch 52
Loss = 5.4772e-02, PNorm = 35.3197, GNorm = 0.4289, lr_0 = 1.1788e-04
Loss = 6.1262e-02, PNorm = 35.3229, GNorm = 1.1018, lr_0 = 1.1458e-04
Validation rmse = 0.134787
Validation r2 = 0.852302
Validation mse = 0.018167
Epoch 53
Loss = 6.4417e-02, PNorm = 35.3263, GNorm = 1.0818, lr_0 = 1.1138e-04
Validation rmse = 0.134044
Validation r2 = 0.853925
Validation mse = 0.017968
Epoch 54
Loss = 5.4378e-02, PNorm = 35.3294, GNorm = 0.8966, lr_0 = 1.0826e-04
Loss = 7.6706e-02, PNorm = 35.3328, GNorm = 1.8676, lr_0 = 1.0524e-04
Validation rmse = 0.141681
Validation r2 = 0.836805
Validation mse = 0.020074
Epoch 55
Loss = 7.2348e-02, PNorm = 35.3364, GNorm = 0.6264, lr_0 = 1.0229e-04
Validation rmse = 0.140781
Validation r2 = 0.838872
Validation mse = 0.019819
Epoch 56
Loss = 6.4511e-02, PNorm = 35.3400, GNorm = 2.0852, lr_0 = 1.0000e-04
Loss = 7.2685e-02, PNorm = 35.3429, GNorm = 0.6058, lr_0 = 1.0000e-04
Validation rmse = 0.134937
Validation r2 = 0.851971
Validation mse = 0.018208
Epoch 57
Loss = 6.8263e-02, PNorm = 35.3459, GNorm = 2.8270, lr_0 = 1.0000e-04
Validation rmse = 0.133558
Validation r2 = 0.854982
Validation mse = 0.017838
Epoch 58
Loss = 6.8569e-02, PNorm = 35.3493, GNorm = 0.9787, lr_0 = 1.0000e-04
Loss = 6.5283e-02, PNorm = 35.3529, GNorm = 0.5279, lr_0 = 1.0000e-04
Validation rmse = 0.135391
Validation r2 = 0.850973
Validation mse = 0.018331
Epoch 59
Loss = 6.5546e-02, PNorm = 35.3558, GNorm = 0.6457, lr_0 = 1.0000e-04
Validation rmse = 0.134635
Validation r2 = 0.852634
Validation mse = 0.018127
Model 0 best validation rmse = 0.133558 on epoch 57
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.297770
Model 0 test r2 = -1.249116
Model 0 test mse = 0.088667
Ensemble test rmse = 0.297770
Ensemble test r2 = -1.249116
Ensemble test mse = 0.088667
10-fold cross validation
	Seed 0 ==> test rmse = 0.324839
	Seed 0 ==> test r2 = -1.676608
	Seed 0 ==> test mse = 0.105520
	Seed 1 ==> test rmse = 0.300707
	Seed 1 ==> test r2 = -1.293692
	Seed 1 ==> test mse = 0.090425
	Seed 2 ==> test rmse = 0.289108
	Seed 2 ==> test r2 = -1.120157
	Seed 2 ==> test mse = 0.083583
	Seed 3 ==> test rmse = 0.305798
	Seed 3 ==> test r2 = -1.372019
	Seed 3 ==> test mse = 0.093512
	Seed 4 ==> test rmse = 0.295750
	Seed 4 ==> test r2 = -1.218696
	Seed 4 ==> test mse = 0.087468
	Seed 5 ==> test rmse = 0.325739
	Seed 5 ==> test r2 = -1.691470
	Seed 5 ==> test mse = 0.106106
	Seed 6 ==> test rmse = 0.303406
	Seed 6 ==> test r2 = -1.335058
	Seed 6 ==> test mse = 0.092055
	Seed 7 ==> test rmse = 0.309890
	Seed 7 ==> test r2 = -1.435918
	Seed 7 ==> test mse = 0.096032
	Seed 8 ==> test rmse = 0.331970
	Seed 8 ==> test r2 = -1.795418
	Seed 8 ==> test mse = 0.110204
	Seed 9 ==> test rmse = 0.297770
	Seed 9 ==> test r2 = -1.249116
	Seed 9 ==> test mse = 0.088667
Overall test rmse = 0.308498 +/- 0.013655
Overall test r2 = -1.418815 +/- 0.215829
Overall test mse = 0.095357 +/- 0.008509
Elapsed time = 0:06:34
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-1d5c3576-9790-4896-9034-9bb28ba18d8e.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/MeCN_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2', 'mse'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2', 'mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/generalization_3/MeCN_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/MeCN_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 901 | train size = 720 | val size = 181 | test size = 121
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.9544e-01, PNorm = 34.0184, GNorm = 1.3350, lr_0 = 4.5357e-04
Validation rmse = 0.299262
Validation r2 = 0.263133
Validation mse = 0.089558
Epoch 1
Loss = 6.9021e-01, PNorm = 34.0576, GNorm = 10.4227, lr_0 = 8.0714e-04
Validation rmse = 0.262384
Validation r2 = 0.433552
Validation mse = 0.068845
Epoch 2
Loss = 6.7839e-01, PNorm = 34.1300, GNorm = 10.3165, lr_0 = 9.8592e-04
Loss = 4.5412e-01, PNorm = 34.2032, GNorm = 2.2427, lr_0 = 9.5836e-04
Validation rmse = 0.235293
Validation r2 = 0.544484
Validation mse = 0.055363
Epoch 3
Loss = 4.3179e-01, PNorm = 34.2709, GNorm = 4.7597, lr_0 = 9.3156e-04
Validation rmse = 0.192690
Validation r2 = 0.694507
Validation mse = 0.037129
Epoch 4
Loss = 4.2268e-01, PNorm = 34.3358, GNorm = 5.4093, lr_0 = 9.0295e-04
Loss = 2.9442e-01, PNorm = 34.3949, GNorm = 1.3238, lr_0 = 8.7771e-04
Validation rmse = 0.179016
Validation r2 = 0.736325
Validation mse = 0.032047
Epoch 5
Loss = 2.6656e-01, PNorm = 34.4404, GNorm = 1.0392, lr_0 = 8.5317e-04
Validation rmse = 0.160665
Validation r2 = 0.787612
Validation mse = 0.025813
Epoch 6
Loss = 2.1117e-01, PNorm = 34.4918, GNorm = 1.6113, lr_0 = 8.2697e-04
Loss = 2.0506e-01, PNorm = 34.5342, GNorm = 4.0201, lr_0 = 8.0385e-04
Loss = 2.6793e-01, PNorm = 34.5389, GNorm = 4.9815, lr_0 = 8.0157e-04
Validation rmse = 0.152889
Validation r2 = 0.807674
Validation mse = 0.023375
Epoch 7
Loss = 2.0042e-01, PNorm = 34.5846, GNorm = 3.5426, lr_0 = 7.7916e-04
Validation rmse = 0.166335
Validation r2 = 0.772357
Validation mse = 0.027667
Epoch 8
Loss = 1.9451e-01, PNorm = 34.6195, GNorm = 5.7185, lr_0 = 7.5737e-04
Validation rmse = 0.150943
Validation r2 = 0.812538
Validation mse = 0.022784
Epoch 9
Loss = 1.4678e-01, PNorm = 34.6538, GNorm = 4.5829, lr_0 = 7.3411e-04
Loss = 1.9571e-01, PNorm = 34.6908, GNorm = 4.1516, lr_0 = 7.1359e-04
Validation rmse = 0.134150
Validation r2 = 0.851930
Validation mse = 0.017996
Epoch 10
Loss = 1.5522e-01, PNorm = 34.7168, GNorm = 1.8423, lr_0 = 6.9364e-04
Validation rmse = 0.142653
Validation r2 = 0.832565
Validation mse = 0.020350
Epoch 11
Loss = 1.6211e-01, PNorm = 34.7466, GNorm = 6.4785, lr_0 = 6.7234e-04
Loss = 1.7950e-01, PNorm = 34.7661, GNorm = 4.0455, lr_0 = 6.5354e-04
Validation rmse = 0.154894
Validation r2 = 0.802597
Validation mse = 0.023992
Epoch 12
Loss = 1.7802e-01, PNorm = 34.7955, GNorm = 5.0099, lr_0 = 6.3347e-04
Validation rmse = 0.129359
Validation r2 = 0.862318
Validation mse = 0.016734
Epoch 13
Loss = 1.2781e-01, PNorm = 34.8204, GNorm = 3.6532, lr_0 = 6.1576e-04
Loss = 1.4424e-01, PNorm = 34.8421, GNorm = 5.4610, lr_0 = 5.9854e-04
Validation rmse = 0.132656
Validation r2 = 0.855210
Validation mse = 0.017598
Epoch 14
Loss = 1.3191e-01, PNorm = 34.8618, GNorm = 2.6485, lr_0 = 5.8016e-04
Validation rmse = 0.122436
Validation r2 = 0.876660
Validation mse = 0.014991
Epoch 15
Loss = 1.2222e-01, PNorm = 34.8778, GNorm = 0.9165, lr_0 = 5.6394e-04
Loss = 1.2218e-01, PNorm = 34.8930, GNorm = 2.2172, lr_0 = 5.4817e-04
Loss = 1.7860e-01, PNorm = 34.8945, GNorm = 4.7979, lr_0 = 5.4662e-04
Validation rmse = 0.129263
Validation r2 = 0.862521
Validation mse = 0.016709
Epoch 16
Loss = 1.1913e-01, PNorm = 34.9086, GNorm = 2.7895, lr_0 = 5.3134e-04
Validation rmse = 0.120137
Validation r2 = 0.881248
Validation mse = 0.014433
Epoch 17
Loss = 1.3097e-01, PNorm = 34.9256, GNorm = 3.3688, lr_0 = 5.1502e-04
Validation rmse = 0.124678
Validation r2 = 0.872101
Validation mse = 0.015545
Epoch 18
Loss = 1.2834e-01, PNorm = 34.9420, GNorm = 4.1510, lr_0 = 5.0062e-04
Loss = 1.2413e-01, PNorm = 34.9563, GNorm = 2.3283, lr_0 = 4.8662e-04
Validation rmse = 0.121197
Validation r2 = 0.879144
Validation mse = 0.014689
Epoch 19
Loss = 1.2328e-01, PNorm = 34.9679, GNorm = 3.0270, lr_0 = 4.7168e-04
Validation rmse = 0.123160
Validation r2 = 0.875198
Validation mse = 0.015168
Epoch 20
Loss = 1.2070e-01, PNorm = 34.9800, GNorm = 1.0165, lr_0 = 4.5849e-04
Loss = 1.1469e-01, PNorm = 34.9918, GNorm = 0.8308, lr_0 = 4.4567e-04
Validation rmse = 0.121508
Validation r2 = 0.878524
Validation mse = 0.014764
Epoch 21
Loss = 1.1245e-01, PNorm = 35.0054, GNorm = 1.7636, lr_0 = 4.3198e-04
Validation rmse = 0.119106
Validation r2 = 0.883279
Validation mse = 0.014186
Epoch 22
Loss = 1.1630e-01, PNorm = 35.0181, GNorm = 0.7448, lr_0 = 4.1872e-04
Loss = 1.1205e-01, PNorm = 35.0290, GNorm = 3.8390, lr_0 = 4.0701e-04
Validation rmse = 0.134473
Validation r2 = 0.851217
Validation mse = 0.018083
Epoch 23
Loss = 1.1610e-01, PNorm = 35.0386, GNorm = 3.4636, lr_0 = 3.9563e-04
Validation rmse = 0.129535
Validation r2 = 0.861944
Validation mse = 0.016779
Epoch 24
Loss = 1.1691e-01, PNorm = 35.0486, GNorm = 2.1757, lr_0 = 3.8348e-04
Loss = 1.0720e-01, PNorm = 35.0584, GNorm = 1.0125, lr_0 = 3.7276e-04
Validation rmse = 0.125281
Validation r2 = 0.870862
Validation mse = 0.015695
Epoch 25
Loss = 1.0479e-01, PNorm = 35.0712, GNorm = 3.4813, lr_0 = 3.6234e-04
Validation rmse = 0.119631
Validation r2 = 0.882248
Validation mse = 0.014311
Epoch 26
Loss = 1.2122e-01, PNorm = 35.0805, GNorm = 3.5986, lr_0 = 3.5121e-04
Validation rmse = 0.124975
Validation r2 = 0.871493
Validation mse = 0.015619
Epoch 27
Loss = 9.5632e-02, PNorm = 35.0938, GNorm = 0.4848, lr_0 = 3.4042e-04
Loss = 1.2267e-01, PNorm = 35.1053, GNorm = 3.5725, lr_0 = 3.3091e-04
Validation rmse = 0.119840
Validation r2 = 0.881835
Validation mse = 0.014362
Epoch 28
Loss = 1.0410e-01, PNorm = 35.1123, GNorm = 1.3481, lr_0 = 3.2165e-04
Validation rmse = 0.118561
Validation r2 = 0.884344
Validation mse = 0.014057
Epoch 29
Loss = 9.5360e-02, PNorm = 35.1224, GNorm = 1.2673, lr_0 = 3.1178e-04
Loss = 1.0362e-01, PNorm = 35.1310, GNorm = 1.8584, lr_0 = 3.0306e-04
Validation rmse = 0.118464
Validation r2 = 0.884533
Validation mse = 0.014034
Epoch 30
Loss = 1.0334e-01, PNorm = 35.1404, GNorm = 0.9682, lr_0 = 2.9459e-04
Validation rmse = 0.117657
Validation r2 = 0.886101
Validation mse = 0.013843
Epoch 31
Loss = 8.5693e-02, PNorm = 35.1502, GNorm = 0.9457, lr_0 = 2.8554e-04
Loss = 1.0506e-01, PNorm = 35.1578, GNorm = 2.2928, lr_0 = 2.7756e-04
Loss = 5.8226e-02, PNorm = 35.1583, GNorm = 1.6690, lr_0 = 2.7677e-04
Validation rmse = 0.119631
Validation r2 = 0.882247
Validation mse = 0.014311
Epoch 32
Loss = 9.4035e-02, PNorm = 35.1660, GNorm = 1.7363, lr_0 = 2.6903e-04
Validation rmse = 0.118754
Validation r2 = 0.883966
Validation mse = 0.014103
Epoch 33
Loss = 8.8997e-02, PNorm = 35.1733, GNorm = 2.6759, lr_0 = 2.6151e-04
Validation rmse = 0.123454
Validation r2 = 0.874601
Validation mse = 0.015241
Epoch 34
Loss = 9.6661e-02, PNorm = 35.1815, GNorm = 1.3843, lr_0 = 2.5348e-04
Loss = 1.0384e-01, PNorm = 35.1898, GNorm = 3.1996, lr_0 = 2.4639e-04
Validation rmse = 0.118517
Validation r2 = 0.884430
Validation mse = 0.014046
Epoch 35
Loss = 9.8795e-02, PNorm = 35.1969, GNorm = 1.1458, lr_0 = 2.3950e-04
Validation rmse = 0.119319
Validation r2 = 0.882860
Validation mse = 0.014237
Epoch 36
Loss = 1.0358e-01, PNorm = 35.2060, GNorm = 2.9288, lr_0 = 2.3215e-04
Loss = 8.8711e-02, PNorm = 35.2139, GNorm = 1.1359, lr_0 = 2.2566e-04
Validation rmse = 0.120373
Validation r2 = 0.880781
Validation mse = 0.014490
Epoch 37
Loss = 8.7827e-02, PNorm = 35.2220, GNorm = 1.0001, lr_0 = 2.1873e-04
Validation rmse = 0.120307
Validation r2 = 0.880913
Validation mse = 0.014474
Epoch 38
Loss = 7.3835e-02, PNorm = 35.2273, GNorm = 1.1060, lr_0 = 2.1261e-04
Loss = 9.3759e-02, PNorm = 35.2339, GNorm = 2.6291, lr_0 = 2.0667e-04
Validation rmse = 0.122639
Validation r2 = 0.876250
Validation mse = 0.015040
Epoch 39
Loss = 1.0650e-01, PNorm = 35.2409, GNorm = 5.7130, lr_0 = 2.0032e-04
Validation rmse = 0.121484
Validation r2 = 0.878571
Validation mse = 0.014758
Epoch 40
Loss = 9.9155e-02, PNorm = 35.2467, GNorm = 2.1341, lr_0 = 1.9472e-04
Loss = 8.8930e-02, PNorm = 35.2534, GNorm = 0.5909, lr_0 = 1.8928e-04
Loss = 1.2128e-01, PNorm = 35.2539, GNorm = 2.4080, lr_0 = 1.8874e-04
Validation rmse = 0.126465
Validation r2 = 0.868409
Validation mse = 0.015993
Epoch 41
Loss = 9.3122e-02, PNorm = 35.2583, GNorm = 0.4942, lr_0 = 1.8346e-04
Validation rmse = 0.122819
Validation r2 = 0.875887
Validation mse = 0.015084
Epoch 42
Loss = 9.7635e-02, PNorm = 35.2652, GNorm = 3.1352, lr_0 = 1.7783e-04
Validation rmse = 0.117362
Validation r2 = 0.886671
Validation mse = 0.013774
Epoch 43
Loss = 7.0989e-02, PNorm = 35.2708, GNorm = 0.5692, lr_0 = 1.7286e-04
Loss = 9.3936e-02, PNorm = 35.2760, GNorm = 1.3253, lr_0 = 1.6802e-04
Validation rmse = 0.120196
Validation r2 = 0.881133
Validation mse = 0.014447
Epoch 44
Loss = 9.0056e-02, PNorm = 35.2813, GNorm = 3.3653, lr_0 = 1.6286e-04
Validation rmse = 0.116433
Validation r2 = 0.888459
Validation mse = 0.013557
Epoch 45
Loss = 8.1349e-02, PNorm = 35.2867, GNorm = 1.6761, lr_0 = 1.5831e-04
Loss = 9.2640e-02, PNorm = 35.2911, GNorm = 1.1286, lr_0 = 1.5388e-04
Validation rmse = 0.118756
Validation r2 = 0.883962
Validation mse = 0.014103
Epoch 46
Loss = 9.4344e-02, PNorm = 35.2951, GNorm = 3.1752, lr_0 = 1.4916e-04
Validation rmse = 0.125637
Validation r2 = 0.870127
Validation mse = 0.015785
Epoch 47
Loss = 1.0087e-01, PNorm = 35.2997, GNorm = 2.0399, lr_0 = 1.4458e-04
Loss = 8.4378e-02, PNorm = 35.3042, GNorm = 1.2046, lr_0 = 1.4053e-04
Validation rmse = 0.116734
Validation r2 = 0.887881
Validation mse = 0.013627
Epoch 48
Loss = 9.2227e-02, PNorm = 35.3085, GNorm = 2.2274, lr_0 = 1.3661e-04
Validation rmse = 0.117550
Validation r2 = 0.886308
Validation mse = 0.013818
Epoch 49
Loss = 8.0942e-02, PNorm = 35.3141, GNorm = 0.8644, lr_0 = 1.3241e-04
Loss = 8.7766e-02, PNorm = 35.3192, GNorm = 1.6934, lr_0 = 1.2871e-04
Validation rmse = 0.116959
Validation r2 = 0.887447
Validation mse = 0.013680
Epoch 50
Loss = 8.8492e-02, PNorm = 35.3226, GNorm = 0.7298, lr_0 = 1.2511e-04
Validation rmse = 0.117827
Validation r2 = 0.885772
Validation mse = 0.013883
Epoch 51
Loss = 7.9217e-02, PNorm = 35.3266, GNorm = 1.0710, lr_0 = 1.2127e-04
Validation rmse = 0.117458
Validation r2 = 0.886485
Validation mse = 0.013796
Epoch 52
Loss = 1.0928e-01, PNorm = 35.3302, GNorm = 1.6753, lr_0 = 1.1754e-04
Loss = 7.6732e-02, PNorm = 35.3332, GNorm = 0.5083, lr_0 = 1.1426e-04
Validation rmse = 0.117278
Validation r2 = 0.886833
Validation mse = 0.013754
Epoch 53
Loss = 8.7509e-02, PNorm = 35.3368, GNorm = 0.9713, lr_0 = 1.1106e-04
Validation rmse = 0.117102
Validation r2 = 0.887172
Validation mse = 0.013713
Epoch 54
Loss = 8.6053e-02, PNorm = 35.3406, GNorm = 0.6522, lr_0 = 1.0765e-04
Loss = 7.9667e-02, PNorm = 35.3440, GNorm = 0.5038, lr_0 = 1.0464e-04
Validation rmse = 0.117780
Validation r2 = 0.885863
Validation mse = 0.013872
Epoch 55
Loss = 7.5373e-02, PNorm = 35.3469, GNorm = 1.9676, lr_0 = 1.0172e-04
Validation rmse = 0.116957
Validation r2 = 0.887451
Validation mse = 0.013679
Epoch 56
Loss = 8.4041e-02, PNorm = 35.3503, GNorm = 2.4318, lr_0 = 1.0000e-04
Loss = 8.5190e-02, PNorm = 35.3538, GNorm = 2.6346, lr_0 = 1.0000e-04
Loss = 4.1160e-02, PNorm = 35.3541, GNorm = 1.5036, lr_0 = 1.0000e-04
Validation rmse = 0.117940
Validation r2 = 0.885552
Validation mse = 0.013910
Epoch 57
Loss = 7.9758e-02, PNorm = 35.3573, GNorm = 1.2081, lr_0 = 1.0000e-04
Validation rmse = 0.116930
Validation r2 = 0.887504
Validation mse = 0.013673
Epoch 58
Loss = 8.8819e-02, PNorm = 35.3599, GNorm = 2.5918, lr_0 = 1.0000e-04
Validation rmse = 0.121256
Validation r2 = 0.879026
Validation mse = 0.014703
Epoch 59
Loss = 6.7320e-02, PNorm = 35.3626, GNorm = 0.5492, lr_0 = 1.0000e-04
Loss = 8.1182e-02, PNorm = 35.3664, GNorm = 1.6222, lr_0 = 1.0000e-04
Validation rmse = 0.117149
Validation r2 = 0.887082
Validation mse = 0.013724
Model 0 best validation rmse = 0.116433 on epoch 44
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.224283
Model 0 test r2 = -0.131464
Model 0 test mse = 0.050303
Ensemble test rmse = 0.224283
Ensemble test r2 = -0.131464
Ensemble test mse = 0.050303
Fold 1
Splitting data with seed 1
Total size = 901 | train size = 720 | val size = 181 | test size = 121
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.7219e-01, PNorm = 34.0169, GNorm = 2.7923, lr_0 = 4.5357e-04
Validation rmse = 0.308742
Validation r2 = 0.200921
Validation mse = 0.095321
Epoch 1
Loss = 7.3425e-01, PNorm = 34.0508, GNorm = 10.5103, lr_0 = 8.0714e-04
Validation rmse = 0.266513
Validation r2 = 0.404564
Validation mse = 0.071029
Epoch 2
Loss = 4.3607e-01, PNorm = 34.1252, GNorm = 1.9328, lr_0 = 9.8592e-04
Loss = 4.7862e-01, PNorm = 34.1944, GNorm = 6.3573, lr_0 = 9.5836e-04
Validation rmse = 0.220328
Validation r2 = 0.593053
Validation mse = 0.048544
Epoch 3
Loss = 3.6389e-01, PNorm = 34.2666, GNorm = 8.1954, lr_0 = 9.3156e-04
Validation rmse = 0.198203
Validation r2 = 0.670680
Validation mse = 0.039284
Epoch 4
Loss = 4.2035e-01, PNorm = 34.3378, GNorm = 7.1053, lr_0 = 9.0295e-04
Loss = 2.7863e-01, PNorm = 34.3967, GNorm = 2.4589, lr_0 = 8.7771e-04
Validation rmse = 0.189052
Validation r2 = 0.700387
Validation mse = 0.035741
Epoch 5
Loss = 2.8565e-01, PNorm = 34.4469, GNorm = 3.2981, lr_0 = 8.5317e-04
Validation rmse = 0.182752
Validation r2 = 0.720023
Validation mse = 0.033398
Epoch 6
Loss = 2.5338e-01, PNorm = 34.4942, GNorm = 1.8412, lr_0 = 8.2697e-04
Loss = 2.0552e-01, PNorm = 34.5408, GNorm = 1.4451, lr_0 = 8.0385e-04
Loss = 2.1673e-01, PNorm = 34.5447, GNorm = 3.7910, lr_0 = 8.0157e-04
Validation rmse = 0.175588
Validation r2 = 0.741544
Validation mse = 0.030831
Epoch 7
Loss = 1.8009e-01, PNorm = 34.5868, GNorm = 1.3796, lr_0 = 7.7916e-04
Validation rmse = 0.173220
Validation r2 = 0.748468
Validation mse = 0.030005
Epoch 8
Loss = 1.6808e-01, PNorm = 34.6231, GNorm = 4.9584, lr_0 = 7.5737e-04
Validation rmse = 0.151740
Validation r2 = 0.806982
Validation mse = 0.023025
Epoch 9
Loss = 1.6900e-01, PNorm = 34.6549, GNorm = 3.0168, lr_0 = 7.3411e-04
Loss = 1.4906e-01, PNorm = 34.6863, GNorm = 0.6496, lr_0 = 7.1359e-04
Validation rmse = 0.149646
Validation r2 = 0.812271
Validation mse = 0.022394
Epoch 10
Loss = 1.6585e-01, PNorm = 34.7140, GNorm = 3.5399, lr_0 = 6.9364e-04
Validation rmse = 0.143911
Validation r2 = 0.826384
Validation mse = 0.020710
Epoch 11
Loss = 1.3984e-01, PNorm = 34.7358, GNorm = 2.2336, lr_0 = 6.7234e-04
Loss = 1.2037e-01, PNorm = 34.7547, GNorm = 1.2292, lr_0 = 6.5354e-04
Validation rmse = 0.137779
Validation r2 = 0.840865
Validation mse = 0.018983
Epoch 12
Loss = 1.3559e-01, PNorm = 34.7773, GNorm = 1.0773, lr_0 = 6.3347e-04
Validation rmse = 0.142978
Validation r2 = 0.828629
Validation mse = 0.020443
Epoch 13
Loss = 1.1096e-01, PNorm = 34.7942, GNorm = 0.7491, lr_0 = 6.1576e-04
Loss = 1.2851e-01, PNorm = 34.8099, GNorm = 4.2999, lr_0 = 5.9854e-04
Validation rmse = 0.136534
Validation r2 = 0.843728
Validation mse = 0.018642
Epoch 14
Loss = 1.2953e-01, PNorm = 34.8343, GNorm = 1.7916, lr_0 = 5.8016e-04
Validation rmse = 0.141001
Validation r2 = 0.833334
Validation mse = 0.019881
Epoch 15
Loss = 1.1900e-01, PNorm = 34.8474, GNorm = 1.3916, lr_0 = 5.6394e-04
Loss = 1.2751e-01, PNorm = 34.8656, GNorm = 3.1227, lr_0 = 5.4817e-04
Loss = 1.2451e-01, PNorm = 34.8667, GNorm = 2.3980, lr_0 = 5.4662e-04
Validation rmse = 0.158336
Validation r2 = 0.789836
Validation mse = 0.025070
Epoch 16
Loss = 1.6760e-01, PNorm = 34.8832, GNorm = 6.3791, lr_0 = 5.3134e-04
Validation rmse = 0.154740
Validation r2 = 0.799273
Validation mse = 0.023945
Epoch 17
Loss = 1.3847e-01, PNorm = 34.8979, GNorm = 1.5096, lr_0 = 5.1502e-04
Validation rmse = 0.159013
Validation r2 = 0.788034
Validation mse = 0.025285
Epoch 18
Loss = 1.3648e-01, PNorm = 34.9147, GNorm = 4.8015, lr_0 = 5.0062e-04
Loss = 1.3108e-01, PNorm = 34.9348, GNorm = 0.8218, lr_0 = 4.8662e-04
Validation rmse = 0.140399
Validation r2 = 0.834754
Validation mse = 0.019712
Epoch 19
Loss = 1.0953e-01, PNorm = 34.9521, GNorm = 0.8745, lr_0 = 4.7168e-04
Validation rmse = 0.138895
Validation r2 = 0.838278
Validation mse = 0.019292
Epoch 20
Loss = 9.5882e-02, PNorm = 34.9658, GNorm = 2.5053, lr_0 = 4.5849e-04
Loss = 1.0937e-01, PNorm = 34.9750, GNorm = 3.9861, lr_0 = 4.4567e-04
Validation rmse = 0.145217
Validation r2 = 0.823220
Validation mse = 0.021088
Epoch 21
Loss = 1.2279e-01, PNorm = 34.9906, GNorm = 2.1398, lr_0 = 4.3198e-04
Validation rmse = 0.133516
Validation r2 = 0.850561
Validation mse = 0.017826
Epoch 22
Loss = 8.3645e-02, PNorm = 35.0026, GNorm = 0.6383, lr_0 = 4.1872e-04
Loss = 1.1102e-01, PNorm = 35.0136, GNorm = 4.9818, lr_0 = 4.0701e-04
Validation rmse = 0.137984
Validation r2 = 0.840391
Validation mse = 0.019040
Epoch 23
Loss = 1.1163e-01, PNorm = 35.0254, GNorm = 0.6996, lr_0 = 3.9563e-04
Validation rmse = 0.149607
Validation r2 = 0.812370
Validation mse = 0.022382
Epoch 24
Loss = 1.2353e-01, PNorm = 35.0372, GNorm = 5.0106, lr_0 = 3.8348e-04
Loss = 9.9931e-02, PNorm = 35.0477, GNorm = 2.6796, lr_0 = 3.7276e-04
Validation rmse = 0.132185
Validation r2 = 0.853525
Validation mse = 0.017473
Epoch 25
Loss = 1.1486e-01, PNorm = 35.0588, GNorm = 2.0891, lr_0 = 3.6234e-04
Validation rmse = 0.133268
Validation r2 = 0.851114
Validation mse = 0.017760
Epoch 26
Loss = 9.1210e-02, PNorm = 35.0704, GNorm = 1.7178, lr_0 = 3.5121e-04
Validation rmse = 0.134078
Validation r2 = 0.849300
Validation mse = 0.017977
Epoch 27
Loss = 7.9616e-02, PNorm = 35.0796, GNorm = 0.8520, lr_0 = 3.4042e-04
Loss = 1.0612e-01, PNorm = 35.0897, GNorm = 1.7017, lr_0 = 3.3091e-04
Validation rmse = 0.143497
Validation r2 = 0.827383
Validation mse = 0.020591
Epoch 28
Loss = 1.1493e-01, PNorm = 35.0986, GNorm = 2.0426, lr_0 = 3.2165e-04
Validation rmse = 0.135760
Validation r2 = 0.845495
Validation mse = 0.018431
Epoch 29
Loss = 8.7009e-02, PNorm = 35.1092, GNorm = 0.9751, lr_0 = 3.1178e-04
Loss = 9.3465e-02, PNorm = 35.1178, GNorm = 1.5583, lr_0 = 3.0306e-04
Validation rmse = 0.134256
Validation r2 = 0.848900
Validation mse = 0.018025
Epoch 30
Loss = 8.7530e-02, PNorm = 35.1253, GNorm = 1.1563, lr_0 = 2.9459e-04
Validation rmse = 0.133317
Validation r2 = 0.851006
Validation mse = 0.017773
Epoch 31
Loss = 1.0381e-01, PNorm = 35.1338, GNorm = 2.6062, lr_0 = 2.8554e-04
Loss = 9.0547e-02, PNorm = 35.1432, GNorm = 1.7438, lr_0 = 2.7756e-04
Loss = 1.0903e-01, PNorm = 35.1443, GNorm = 1.2075, lr_0 = 2.7677e-04
Validation rmse = 0.132336
Validation r2 = 0.853190
Validation mse = 0.017513
Epoch 32
Loss = 8.9712e-02, PNorm = 35.1517, GNorm = 1.4544, lr_0 = 2.6903e-04
Validation rmse = 0.133051
Validation r2 = 0.851599
Validation mse = 0.017703
Epoch 33
Loss = 8.7182e-02, PNorm = 35.1584, GNorm = 0.6657, lr_0 = 2.6151e-04
Validation rmse = 0.137029
Validation r2 = 0.842592
Validation mse = 0.018777
Epoch 34
Loss = 9.3910e-02, PNorm = 35.1673, GNorm = 0.7295, lr_0 = 2.5348e-04
Loss = 8.3303e-02, PNorm = 35.1752, GNorm = 2.3921, lr_0 = 2.4639e-04
Validation rmse = 0.131253
Validation r2 = 0.855582
Validation mse = 0.017227
Epoch 35
Loss = 1.0827e-01, PNorm = 35.1816, GNorm = 1.5295, lr_0 = 2.3950e-04
Validation rmse = 0.138071
Validation r2 = 0.840189
Validation mse = 0.019064
Epoch 36
Loss = 1.0459e-01, PNorm = 35.1902, GNorm = 0.8602, lr_0 = 2.3215e-04
Loss = 8.5293e-02, PNorm = 35.1971, GNorm = 1.4694, lr_0 = 2.2566e-04
Validation rmse = 0.134517
Validation r2 = 0.848310
Validation mse = 0.018095
Epoch 37
Loss = 8.4826e-02, PNorm = 35.2032, GNorm = 0.9021, lr_0 = 2.1873e-04
Validation rmse = 0.131427
Validation r2 = 0.855200
Validation mse = 0.017273
Epoch 38
Loss = 7.7859e-02, PNorm = 35.2098, GNorm = 2.7765, lr_0 = 2.1261e-04
Loss = 9.5528e-02, PNorm = 35.2162, GNorm = 1.8823, lr_0 = 2.0667e-04
Validation rmse = 0.132812
Validation r2 = 0.852132
Validation mse = 0.017639
Epoch 39
Loss = 8.1704e-02, PNorm = 35.2234, GNorm = 1.4489, lr_0 = 2.0032e-04
Validation rmse = 0.129940
Validation r2 = 0.858458
Validation mse = 0.016884
Epoch 40
Loss = 8.4593e-02, PNorm = 35.2292, GNorm = 0.6389, lr_0 = 1.9472e-04
Loss = 8.1150e-02, PNorm = 35.2357, GNorm = 0.5894, lr_0 = 1.8928e-04
Loss = 1.1917e-01, PNorm = 35.2361, GNorm = 1.1880, lr_0 = 1.8874e-04
Validation rmse = 0.134458
Validation r2 = 0.848444
Validation mse = 0.018079
Epoch 41
Loss = 8.8407e-02, PNorm = 35.2421, GNorm = 1.9147, lr_0 = 1.8346e-04
Validation rmse = 0.131542
Validation r2 = 0.854946
Validation mse = 0.017303
Epoch 42
Loss = 6.5136e-02, PNorm = 35.2477, GNorm = 2.1776, lr_0 = 1.7783e-04
Validation rmse = 0.132156
Validation r2 = 0.853589
Validation mse = 0.017465
Epoch 43
Loss = 1.1084e-01, PNorm = 35.2532, GNorm = 2.6270, lr_0 = 1.7286e-04
Loss = 8.0905e-02, PNorm = 35.2585, GNorm = 1.3309, lr_0 = 1.6802e-04
Validation rmse = 0.131899
Validation r2 = 0.854159
Validation mse = 0.017397
Epoch 44
Loss = 7.6490e-02, PNorm = 35.2661, GNorm = 0.6800, lr_0 = 1.6286e-04
Validation rmse = 0.129642
Validation r2 = 0.859107
Validation mse = 0.016807
Epoch 45
Loss = 5.8517e-02, PNorm = 35.2708, GNorm = 0.6253, lr_0 = 1.5831e-04
Loss = 7.9102e-02, PNorm = 35.2754, GNorm = 1.0972, lr_0 = 1.5388e-04
Validation rmse = 0.133732
Validation r2 = 0.850077
Validation mse = 0.017884
Epoch 46
Loss = 7.2813e-02, PNorm = 35.2810, GNorm = 0.7851, lr_0 = 1.4916e-04
Validation rmse = 0.129630
Validation r2 = 0.859132
Validation mse = 0.016804
Epoch 47
Loss = 6.7681e-02, PNorm = 35.2858, GNorm = 1.0181, lr_0 = 1.4458e-04
Loss = 7.9735e-02, PNorm = 35.2905, GNorm = 0.7108, lr_0 = 1.4053e-04
Validation rmse = 0.131758
Validation r2 = 0.854470
Validation mse = 0.017360
Epoch 48
Loss = 7.1923e-02, PNorm = 35.2954, GNorm = 0.6204, lr_0 = 1.3661e-04
Validation rmse = 0.131318
Validation r2 = 0.855440
Validation mse = 0.017244
Epoch 49
Loss = 7.4041e-02, PNorm = 35.3004, GNorm = 0.5554, lr_0 = 1.3241e-04
Loss = 8.3126e-02, PNorm = 35.3039, GNorm = 1.1887, lr_0 = 1.2871e-04
Validation rmse = 0.128502
Validation r2 = 0.861574
Validation mse = 0.016513
Epoch 50
Loss = 7.6191e-02, PNorm = 35.3083, GNorm = 0.7332, lr_0 = 1.2511e-04
Validation rmse = 0.130467
Validation r2 = 0.857307
Validation mse = 0.017022
Epoch 51
Loss = 7.5811e-02, PNorm = 35.3126, GNorm = 2.2786, lr_0 = 1.2127e-04
Validation rmse = 0.128792
Validation r2 = 0.860947
Validation mse = 0.016587
Epoch 52
Loss = 7.6829e-02, PNorm = 35.3163, GNorm = 0.7098, lr_0 = 1.1754e-04
Loss = 7.6068e-02, PNorm = 35.3204, GNorm = 0.9155, lr_0 = 1.1426e-04
Validation rmse = 0.131427
Validation r2 = 0.855201
Validation mse = 0.017273
Epoch 53
Loss = 8.3498e-02, PNorm = 35.3236, GNorm = 1.5822, lr_0 = 1.1106e-04
Validation rmse = 0.131889
Validation r2 = 0.854180
Validation mse = 0.017395
Epoch 54
Loss = 9.0369e-02, PNorm = 35.3279, GNorm = 1.5257, lr_0 = 1.0765e-04
Loss = 7.1141e-02, PNorm = 35.3318, GNorm = 1.4472, lr_0 = 1.0464e-04
Validation rmse = 0.129544
Validation r2 = 0.859320
Validation mse = 0.016782
Epoch 55
Loss = 6.5903e-02, PNorm = 35.3347, GNorm = 0.7231, lr_0 = 1.0172e-04
Validation rmse = 0.130178
Validation r2 = 0.857938
Validation mse = 0.016946
Epoch 56
Loss = 6.4690e-02, PNorm = 35.3388, GNorm = 0.6645, lr_0 = 1.0000e-04
Loss = 7.9721e-02, PNorm = 35.3412, GNorm = 0.9653, lr_0 = 1.0000e-04
Loss = 4.8430e-02, PNorm = 35.3416, GNorm = 1.1810, lr_0 = 1.0000e-04
Validation rmse = 0.133742
Validation r2 = 0.850054
Validation mse = 0.017887
Epoch 57
Loss = 7.6750e-02, PNorm = 35.3446, GNorm = 1.0347, lr_0 = 1.0000e-04
Validation rmse = 0.129048
Validation r2 = 0.860395
Validation mse = 0.016653
Epoch 58
Loss = 5.5344e-02, PNorm = 35.3487, GNorm = 0.4797, lr_0 = 1.0000e-04
Validation rmse = 0.128057
Validation r2 = 0.862530
Validation mse = 0.016399
Epoch 59
Loss = 7.6849e-02, PNorm = 35.3520, GNorm = 1.2905, lr_0 = 1.0000e-04
Loss = 7.7221e-02, PNorm = 35.3552, GNorm = 0.6329, lr_0 = 1.0000e-04
Validation rmse = 0.129745
Validation r2 = 0.858882
Validation mse = 0.016834
Model 0 best validation rmse = 0.128057 on epoch 58
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.190696
Model 0 test r2 = 0.182043
Model 0 test mse = 0.036365
Ensemble test rmse = 0.190696
Ensemble test r2 = 0.182043
Ensemble test mse = 0.036365
Fold 2
Splitting data with seed 2
Total size = 901 | train size = 720 | val size = 181 | test size = 121
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1932e-01, PNorm = 34.0193, GNorm = 3.8071, lr_0 = 4.5357e-04
Validation rmse = 0.282367
Validation r2 = 0.346440
Validation mse = 0.079731
Epoch 1
Loss = 6.5849e-01, PNorm = 34.0585, GNorm = 1.0421, lr_0 = 8.0714e-04
Validation rmse = 0.265494
Validation r2 = 0.422213
Validation mse = 0.070487
Epoch 2
Loss = 6.5029e-01, PNorm = 34.1193, GNorm = 7.5299, lr_0 = 9.8592e-04
Loss = 4.5143e-01, PNorm = 34.1947, GNorm = 4.9095, lr_0 = 9.5836e-04
Validation rmse = 0.220863
Validation r2 = 0.600143
Validation mse = 0.048781
Epoch 3
Loss = 3.7880e-01, PNorm = 34.2760, GNorm = 4.1076, lr_0 = 9.3156e-04
Validation rmse = 0.244120
Validation r2 = 0.511501
Validation mse = 0.059594
Epoch 4
Loss = 3.4491e-01, PNorm = 34.3602, GNorm = 4.4309, lr_0 = 9.0295e-04
Loss = 3.7124e-01, PNorm = 34.4091, GNorm = 1.5147, lr_0 = 8.7771e-04
Validation rmse = 0.219883
Validation r2 = 0.603683
Validation mse = 0.048349
Epoch 5
Loss = 2.8419e-01, PNorm = 34.4711, GNorm = 1.1683, lr_0 = 8.5317e-04
Validation rmse = 0.181161
Validation r2 = 0.730978
Validation mse = 0.032819
Epoch 6
Loss = 2.2309e-01, PNorm = 34.5243, GNorm = 1.8786, lr_0 = 8.2697e-04
Loss = 2.4397e-01, PNorm = 34.5696, GNorm = 2.1922, lr_0 = 8.0385e-04
Loss = 2.2941e-01, PNorm = 34.5747, GNorm = 5.9101, lr_0 = 8.0157e-04
Validation rmse = 0.169684
Validation r2 = 0.763985
Validation mse = 0.028793
Epoch 7
Loss = 1.9396e-01, PNorm = 34.6204, GNorm = 5.6615, lr_0 = 7.7916e-04
Validation rmse = 0.162392
Validation r2 = 0.783833
Validation mse = 0.026371
Epoch 8
Loss = 1.8136e-01, PNorm = 34.6556, GNorm = 3.6553, lr_0 = 7.5737e-04
Validation rmse = 0.157627
Validation r2 = 0.796335
Validation mse = 0.024846
Epoch 9
Loss = 1.1655e-01, PNorm = 34.6903, GNorm = 2.3424, lr_0 = 7.3411e-04
Loss = 1.5694e-01, PNorm = 34.7162, GNorm = 3.2676, lr_0 = 7.1359e-04
Validation rmse = 0.161148
Validation r2 = 0.787134
Validation mse = 0.025969
Epoch 10
Loss = 1.4808e-01, PNorm = 34.7452, GNorm = 1.9330, lr_0 = 6.9364e-04
Validation rmse = 0.161807
Validation r2 = 0.785389
Validation mse = 0.026181
Epoch 11
Loss = 1.7322e-01, PNorm = 34.7716, GNorm = 1.9125, lr_0 = 6.7234e-04
Loss = 1.2578e-01, PNorm = 34.7964, GNorm = 1.4289, lr_0 = 6.5354e-04
Validation rmse = 0.167383
Validation r2 = 0.770343
Validation mse = 0.028017
Epoch 12
Loss = 1.2990e-01, PNorm = 34.8224, GNorm = 1.6540, lr_0 = 6.3347e-04
Validation rmse = 0.149522
Validation r2 = 0.816741
Validation mse = 0.022357
Epoch 13
Loss = 1.3066e-01, PNorm = 34.8429, GNorm = 1.3017, lr_0 = 6.1576e-04
Loss = 1.2399e-01, PNorm = 34.8637, GNorm = 2.3221, lr_0 = 5.9854e-04
Validation rmse = 0.153428
Validation r2 = 0.807040
Validation mse = 0.023540
Epoch 14
Loss = 1.2850e-01, PNorm = 34.8858, GNorm = 1.2632, lr_0 = 5.8016e-04
Validation rmse = 0.157000
Validation r2 = 0.797951
Validation mse = 0.024649
Epoch 15
Loss = 1.1807e-01, PNorm = 34.9010, GNorm = 1.1606, lr_0 = 5.6394e-04
Loss = 1.1652e-01, PNorm = 34.9147, GNorm = 1.2880, lr_0 = 5.4817e-04
Loss = 7.8989e-02, PNorm = 34.9159, GNorm = 2.9479, lr_0 = 5.4662e-04
Validation rmse = 0.147030
Validation r2 = 0.822798
Validation mse = 0.021618
Epoch 16
Loss = 1.1308e-01, PNorm = 34.9354, GNorm = 0.5910, lr_0 = 5.3134e-04
Validation rmse = 0.147733
Validation r2 = 0.821098
Validation mse = 0.021825
Epoch 17
Loss = 1.3686e-01, PNorm = 34.9520, GNorm = 1.0189, lr_0 = 5.1502e-04
Validation rmse = 0.146586
Validation r2 = 0.823867
Validation mse = 0.021487
Epoch 18
Loss = 8.1571e-02, PNorm = 34.9675, GNorm = 2.4882, lr_0 = 5.0062e-04
Loss = 1.1142e-01, PNorm = 34.9839, GNorm = 0.9916, lr_0 = 4.8662e-04
Validation rmse = 0.146654
Validation r2 = 0.823702
Validation mse = 0.021507
Epoch 19
Loss = 1.2103e-01, PNorm = 35.0003, GNorm = 0.8439, lr_0 = 4.7168e-04
Validation rmse = 0.145138
Validation r2 = 0.827327
Validation mse = 0.021065
Epoch 20
Loss = 9.2198e-02, PNorm = 35.0104, GNorm = 0.8476, lr_0 = 4.5849e-04
Loss = 1.1031e-01, PNorm = 35.0238, GNorm = 1.5361, lr_0 = 4.4567e-04
Validation rmse = 0.145759
Validation r2 = 0.825847
Validation mse = 0.021246
Epoch 21
Loss = 1.0211e-01, PNorm = 35.0341, GNorm = 3.3125, lr_0 = 4.3198e-04
Validation rmse = 0.144226
Validation r2 = 0.829492
Validation mse = 0.020801
Epoch 22
Loss = 1.3674e-01, PNorm = 35.0489, GNorm = 5.6328, lr_0 = 4.1872e-04
Loss = 1.0504e-01, PNorm = 35.0621, GNorm = 2.0894, lr_0 = 4.0701e-04
Validation rmse = 0.147268
Validation r2 = 0.822224
Validation mse = 0.021688
Epoch 23
Loss = 1.0341e-01, PNorm = 35.0735, GNorm = 1.5675, lr_0 = 3.9563e-04
Validation rmse = 0.147728
Validation r2 = 0.821112
Validation mse = 0.021823
Epoch 24
Loss = 9.5554e-02, PNorm = 35.0893, GNorm = 0.8215, lr_0 = 3.8348e-04
Loss = 1.0248e-01, PNorm = 35.1018, GNorm = 3.5565, lr_0 = 3.7276e-04
Validation rmse = 0.147377
Validation r2 = 0.821959
Validation mse = 0.021720
Epoch 25
Loss = 9.9899e-02, PNorm = 35.1127, GNorm = 2.1797, lr_0 = 3.6234e-04
Validation rmse = 0.142652
Validation r2 = 0.833192
Validation mse = 0.020350
Epoch 26
Loss = 8.6604e-02, PNorm = 35.1230, GNorm = 1.6117, lr_0 = 3.5121e-04
Validation rmse = 0.151296
Validation r2 = 0.812365
Validation mse = 0.022891
Epoch 27
Loss = 1.0044e-01, PNorm = 35.1345, GNorm = 4.3021, lr_0 = 3.4042e-04
Loss = 9.5316e-02, PNorm = 35.1449, GNorm = 1.2621, lr_0 = 3.3091e-04
Validation rmse = 0.144676
Validation r2 = 0.828426
Validation mse = 0.020931
Epoch 28
Loss = 1.0877e-01, PNorm = 35.1557, GNorm = 3.0314, lr_0 = 3.2165e-04
Validation rmse = 0.144769
Validation r2 = 0.828206
Validation mse = 0.020958
Epoch 29
Loss = 1.0043e-01, PNorm = 35.1647, GNorm = 1.6192, lr_0 = 3.1178e-04
Loss = 7.9076e-02, PNorm = 35.1738, GNorm = 0.7013, lr_0 = 3.0306e-04
Validation rmse = 0.142644
Validation r2 = 0.833212
Validation mse = 0.020347
Epoch 30
Loss = 8.4241e-02, PNorm = 35.1817, GNorm = 2.3532, lr_0 = 2.9459e-04
Validation rmse = 0.146945
Validation r2 = 0.823003
Validation mse = 0.021593
Epoch 31
Loss = 9.5964e-02, PNorm = 35.1907, GNorm = 0.8980, lr_0 = 2.8554e-04
Loss = 8.9576e-02, PNorm = 35.1975, GNorm = 1.6774, lr_0 = 2.7756e-04
Loss = 6.0696e-02, PNorm = 35.1987, GNorm = 2.3548, lr_0 = 2.7677e-04
Validation rmse = 0.144044
Validation r2 = 0.829923
Validation mse = 0.020749
Epoch 32
Loss = 8.8367e-02, PNorm = 35.2074, GNorm = 3.0204, lr_0 = 2.6903e-04
Validation rmse = 0.146505
Validation r2 = 0.824061
Validation mse = 0.021464
Epoch 33
Loss = 8.2494e-02, PNorm = 35.2157, GNorm = 1.5497, lr_0 = 2.6151e-04
Validation rmse = 0.143519
Validation r2 = 0.831159
Validation mse = 0.020598
Epoch 34
Loss = 7.3566e-02, PNorm = 35.2243, GNorm = 0.9821, lr_0 = 2.5348e-04
Loss = 8.9431e-02, PNorm = 35.2310, GNorm = 1.7346, lr_0 = 2.4639e-04
Validation rmse = 0.144206
Validation r2 = 0.829538
Validation mse = 0.020795
Epoch 35
Loss = 8.8697e-02, PNorm = 35.2399, GNorm = 1.4489, lr_0 = 2.3950e-04
Validation rmse = 0.144354
Validation r2 = 0.829190
Validation mse = 0.020838
Epoch 36
Loss = 8.6427e-02, PNorm = 35.2470, GNorm = 1.0560, lr_0 = 2.3215e-04
Loss = 8.5117e-02, PNorm = 35.2543, GNorm = 1.6561, lr_0 = 2.2566e-04
Validation rmse = 0.143327
Validation r2 = 0.831610
Validation mse = 0.020543
Epoch 37
Loss = 9.0325e-02, PNorm = 35.2599, GNorm = 1.6882, lr_0 = 2.1873e-04
Validation rmse = 0.145731
Validation r2 = 0.825916
Validation mse = 0.021237
Epoch 38
Loss = 1.0546e-01, PNorm = 35.2660, GNorm = 1.5747, lr_0 = 2.1261e-04
Loss = 7.6931e-02, PNorm = 35.2721, GNorm = 2.0573, lr_0 = 2.0667e-04
Validation rmse = 0.143184
Validation r2 = 0.831946
Validation mse = 0.020502
Epoch 39
Loss = 8.6794e-02, PNorm = 35.2788, GNorm = 0.7415, lr_0 = 2.0032e-04
Validation rmse = 0.142908
Validation r2 = 0.832594
Validation mse = 0.020423
Epoch 40
Loss = 6.9127e-02, PNorm = 35.2852, GNorm = 1.4432, lr_0 = 1.9472e-04
Loss = 8.6489e-02, PNorm = 35.2910, GNorm = 1.8090, lr_0 = 1.8928e-04
Loss = 5.3068e-02, PNorm = 35.2915, GNorm = 1.3761, lr_0 = 1.8874e-04
Validation rmse = 0.144327
Validation r2 = 0.829254
Validation mse = 0.020830
Epoch 41
Loss = 8.8060e-02, PNorm = 35.2984, GNorm = 0.6380, lr_0 = 1.8346e-04
Validation rmse = 0.147842
Validation r2 = 0.820835
Validation mse = 0.021857
Epoch 42
Loss = 9.1791e-02, PNorm = 35.3054, GNorm = 2.5453, lr_0 = 1.7783e-04
Validation rmse = 0.146088
Validation r2 = 0.825060
Validation mse = 0.021342
Epoch 43
Loss = 6.1206e-02, PNorm = 35.3109, GNorm = 2.1667, lr_0 = 1.7286e-04
Loss = 8.1524e-02, PNorm = 35.3163, GNorm = 1.8239, lr_0 = 1.6802e-04
Validation rmse = 0.150414
Validation r2 = 0.814547
Validation mse = 0.022624
Epoch 44
Loss = 7.1142e-02, PNorm = 35.3219, GNorm = 2.2853, lr_0 = 1.6286e-04
Validation rmse = 0.142728
Validation r2 = 0.833015
Validation mse = 0.020371
Epoch 45
Loss = 6.2561e-02, PNorm = 35.3266, GNorm = 1.8303, lr_0 = 1.5831e-04
Loss = 8.2555e-02, PNorm = 35.3314, GNorm = 0.8606, lr_0 = 1.5388e-04
Validation rmse = 0.142758
Validation r2 = 0.832945
Validation mse = 0.020380
Epoch 46
Loss = 8.4815e-02, PNorm = 35.3371, GNorm = 0.8509, lr_0 = 1.4916e-04
Validation rmse = 0.146393
Validation r2 = 0.824328
Validation mse = 0.021431
Epoch 47
Loss = 7.7958e-02, PNorm = 35.3417, GNorm = 0.7217, lr_0 = 1.4458e-04
Loss = 7.5211e-02, PNorm = 35.3467, GNorm = 1.5312, lr_0 = 1.4053e-04
Validation rmse = 0.143057
Validation r2 = 0.832245
Validation mse = 0.020465
Epoch 48
Loss = 7.3059e-02, PNorm = 35.3502, GNorm = 1.9446, lr_0 = 1.3661e-04
Validation rmse = 0.144540
Validation r2 = 0.828748
Validation mse = 0.020892
Epoch 49
Loss = 8.0533e-02, PNorm = 35.3550, GNorm = 1.4802, lr_0 = 1.3241e-04
Loss = 7.1298e-02, PNorm = 35.3583, GNorm = 2.5674, lr_0 = 1.2871e-04
Validation rmse = 0.144230
Validation r2 = 0.829483
Validation mse = 0.020802
Epoch 50
Loss = 7.5355e-02, PNorm = 35.3622, GNorm = 1.8205, lr_0 = 1.2511e-04
Validation rmse = 0.142342
Validation r2 = 0.833918
Validation mse = 0.020261
Epoch 51
Loss = 8.1016e-02, PNorm = 35.3663, GNorm = 0.6968, lr_0 = 1.2127e-04
Validation rmse = 0.144943
Validation r2 = 0.827792
Validation mse = 0.021009
Epoch 52
Loss = 6.9969e-02, PNorm = 35.3706, GNorm = 1.5561, lr_0 = 1.1754e-04
Loss = 7.2991e-02, PNorm = 35.3747, GNorm = 1.5922, lr_0 = 1.1426e-04
Validation rmse = 0.143952
Validation r2 = 0.830139
Validation mse = 0.020722
Epoch 53
Loss = 7.3000e-02, PNorm = 35.3778, GNorm = 1.0393, lr_0 = 1.1106e-04
Validation rmse = 0.147021
Validation r2 = 0.822819
Validation mse = 0.021615
Epoch 54
Loss = 6.4959e-02, PNorm = 35.3812, GNorm = 0.8733, lr_0 = 1.0765e-04
Loss = 8.2671e-02, PNorm = 35.3851, GNorm = 1.4994, lr_0 = 1.0464e-04
Validation rmse = 0.144597
Validation r2 = 0.828613
Validation mse = 0.020908
Epoch 55
Loss = 7.1942e-02, PNorm = 35.3877, GNorm = 1.1775, lr_0 = 1.0172e-04
Validation rmse = 0.143281
Validation r2 = 0.831718
Validation mse = 0.020530
Epoch 56
Loss = 6.5999e-02, PNorm = 35.3912, GNorm = 0.6542, lr_0 = 1.0000e-04
Loss = 7.7575e-02, PNorm = 35.3941, GNorm = 1.8525, lr_0 = 1.0000e-04
Loss = 6.2922e-02, PNorm = 35.3945, GNorm = 1.3745, lr_0 = 1.0000e-04
Validation rmse = 0.143977
Validation r2 = 0.830080
Validation mse = 0.020729
Epoch 57
Loss = 7.1896e-02, PNorm = 35.3978, GNorm = 0.6546, lr_0 = 1.0000e-04
Validation rmse = 0.143121
Validation r2 = 0.832095
Validation mse = 0.020484
Epoch 58
Loss = 7.7784e-02, PNorm = 35.4011, GNorm = 0.5638, lr_0 = 1.0000e-04
Validation rmse = 0.142308
Validation r2 = 0.833996
Validation mse = 0.020252
Epoch 59
Loss = 6.4708e-02, PNorm = 35.4048, GNorm = 0.6983, lr_0 = 1.0000e-04
Loss = 6.9995e-02, PNorm = 35.4076, GNorm = 2.2419, lr_0 = 1.0000e-04
Validation rmse = 0.142827
Validation r2 = 0.832784
Validation mse = 0.020399
Model 0 best validation rmse = 0.142308 on epoch 58
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.201278
Model 0 test r2 = 0.088745
Model 0 test mse = 0.040513
Ensemble test rmse = 0.201278
Ensemble test r2 = 0.088745
Ensemble test mse = 0.040513
Fold 3
Splitting data with seed 3
Total size = 901 | train size = 720 | val size = 181 | test size = 121
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.6399e-01, PNorm = 34.0158, GNorm = 6.6075, lr_0 = 4.5357e-04
Validation rmse = 0.328639
Validation r2 = 0.148243
Validation mse = 0.108003
Epoch 1
Loss = 6.6034e-01, PNorm = 34.0455, GNorm = 1.4873, lr_0 = 8.0714e-04
Validation rmse = 0.288983
Validation r2 = 0.341397
Validation mse = 0.083511
Epoch 2
Loss = 5.6115e-01, PNorm = 34.1074, GNorm = 5.2915, lr_0 = 9.8592e-04
Loss = 4.8657e-01, PNorm = 34.1790, GNorm = 0.6847, lr_0 = 9.5836e-04
Validation rmse = 0.245080
Validation r2 = 0.526311
Validation mse = 0.060064
Epoch 3
Loss = 3.6332e-01, PNorm = 34.2510, GNorm = 2.4714, lr_0 = 9.3156e-04
Validation rmse = 0.236675
Validation r2 = 0.558244
Validation mse = 0.056015
Epoch 4
Loss = 3.3335e-01, PNorm = 34.3209, GNorm = 3.1502, lr_0 = 9.0295e-04
Loss = 2.6619e-01, PNorm = 34.3772, GNorm = 2.3175, lr_0 = 8.7771e-04
Validation rmse = 0.210907
Validation r2 = 0.649200
Validation mse = 0.044482
Epoch 5
Loss = 2.7244e-01, PNorm = 34.4273, GNorm = 2.4936, lr_0 = 8.5317e-04
Validation rmse = 0.177813
Validation r2 = 0.750652
Validation mse = 0.031618
Epoch 6
Loss = 1.8100e-01, PNorm = 34.4797, GNorm = 1.1641, lr_0 = 8.2697e-04
Loss = 1.9557e-01, PNorm = 34.5197, GNorm = 3.7696, lr_0 = 8.0385e-04
Loss = 2.5139e-01, PNorm = 34.5230, GNorm = 5.4105, lr_0 = 8.0157e-04
Validation rmse = 0.179674
Validation r2 = 0.745406
Validation mse = 0.032283
Epoch 7
Loss = 1.8988e-01, PNorm = 34.5607, GNorm = 5.2753, lr_0 = 7.7916e-04
Validation rmse = 0.187531
Validation r2 = 0.722653
Validation mse = 0.035168
Epoch 8
Loss = 2.1014e-01, PNorm = 34.5874, GNorm = 2.1487, lr_0 = 7.5737e-04
Validation rmse = 0.158025
Validation r2 = 0.803062
Validation mse = 0.024972
Epoch 9
Loss = 1.5098e-01, PNorm = 34.6174, GNorm = 1.3263, lr_0 = 7.3411e-04
Loss = 1.5224e-01, PNorm = 34.6509, GNorm = 1.7819, lr_0 = 7.1359e-04
Validation rmse = 0.157835
Validation r2 = 0.803535
Validation mse = 0.024912
Epoch 10
Loss = 1.5437e-01, PNorm = 34.6733, GNorm = 1.6221, lr_0 = 6.9364e-04
Validation rmse = 0.169960
Validation r2 = 0.772191
Validation mse = 0.028886
Epoch 11
Loss = 1.9581e-01, PNorm = 34.6944, GNorm = 5.9895, lr_0 = 6.7234e-04
Loss = 2.0754e-01, PNorm = 34.7134, GNorm = 4.1573, lr_0 = 6.5354e-04
Validation rmse = 0.175803
Validation r2 = 0.756259
Validation mse = 0.030907
Epoch 12
Loss = 1.7471e-01, PNorm = 34.7403, GNorm = 2.5724, lr_0 = 6.3347e-04
Validation rmse = 0.148793
Validation r2 = 0.825400
Validation mse = 0.022139
Epoch 13
Loss = 1.1510e-01, PNorm = 34.7630, GNorm = 0.8435, lr_0 = 6.1576e-04
Loss = 1.4097e-01, PNorm = 34.7825, GNorm = 4.1472, lr_0 = 5.9854e-04
Validation rmse = 0.158577
Validation r2 = 0.801684
Validation mse = 0.025147
Epoch 14
Loss = 1.3246e-01, PNorm = 34.7986, GNorm = 1.0742, lr_0 = 5.8016e-04
Validation rmse = 0.149264
Validation r2 = 0.824293
Validation mse = 0.022280
Epoch 15
Loss = 1.4190e-01, PNorm = 34.8119, GNorm = 3.9945, lr_0 = 5.6394e-04
Loss = 1.2912e-01, PNorm = 34.8229, GNorm = 3.4072, lr_0 = 5.4817e-04
Loss = 1.8491e-01, PNorm = 34.8240, GNorm = 2.2402, lr_0 = 5.4662e-04
Validation rmse = 0.148433
Validation r2 = 0.826245
Validation mse = 0.022032
Epoch 16
Loss = 1.3581e-01, PNorm = 34.8352, GNorm = 2.7010, lr_0 = 5.3134e-04
Validation rmse = 0.146060
Validation r2 = 0.831755
Validation mse = 0.021334
Epoch 17
Loss = 1.3927e-01, PNorm = 34.8485, GNorm = 2.7504, lr_0 = 5.1502e-04
Validation rmse = 0.148958
Validation r2 = 0.825012
Validation mse = 0.022189
Epoch 18
Loss = 6.5164e-02, PNorm = 34.8625, GNorm = 0.4681, lr_0 = 5.0062e-04
Loss = 1.1157e-01, PNorm = 34.8740, GNorm = 0.9426, lr_0 = 4.8662e-04
Validation rmse = 0.142409
Validation r2 = 0.840061
Validation mse = 0.020280
Epoch 19
Loss = 1.3497e-01, PNorm = 34.8858, GNorm = 1.8624, lr_0 = 4.7168e-04
Validation rmse = 0.150005
Validation r2 = 0.822546
Validation mse = 0.022501
Epoch 20
Loss = 8.8236e-02, PNorm = 34.8947, GNorm = 2.8294, lr_0 = 4.5849e-04
Loss = 1.0808e-01, PNorm = 34.9072, GNorm = 1.5790, lr_0 = 4.4567e-04
Validation rmse = 0.157116
Validation r2 = 0.805322
Validation mse = 0.024685
Epoch 21
Loss = 1.2678e-01, PNorm = 34.9158, GNorm = 3.1937, lr_0 = 4.3198e-04
Validation rmse = 0.139560
Validation r2 = 0.846396
Validation mse = 0.019477
Epoch 22
Loss = 8.7725e-02, PNorm = 34.9252, GNorm = 1.9233, lr_0 = 4.1872e-04
Loss = 1.1978e-01, PNorm = 34.9358, GNorm = 2.3524, lr_0 = 4.0701e-04
Validation rmse = 0.145172
Validation r2 = 0.833796
Validation mse = 0.021075
Epoch 23
Loss = 1.2492e-01, PNorm = 34.9456, GNorm = 0.9844, lr_0 = 3.9563e-04
Validation rmse = 0.140644
Validation r2 = 0.844001
Validation mse = 0.019781
Epoch 24
Loss = 1.4018e-01, PNorm = 34.9571, GNorm = 1.3581, lr_0 = 3.8348e-04
Loss = 1.0216e-01, PNorm = 34.9642, GNorm = 1.4526, lr_0 = 3.7276e-04
Validation rmse = 0.140596
Validation r2 = 0.844109
Validation mse = 0.019767
Epoch 25
Loss = 1.0346e-01, PNorm = 34.9739, GNorm = 0.7587, lr_0 = 3.6234e-04
Validation rmse = 0.140660
Validation r2 = 0.843966
Validation mse = 0.019785
Epoch 26
Loss = 9.8136e-02, PNorm = 34.9816, GNorm = 1.6555, lr_0 = 3.5121e-04
Validation rmse = 0.170742
Validation r2 = 0.770089
Validation mse = 0.029153
Epoch 27
Loss = 1.5223e-01, PNorm = 34.9905, GNorm = 7.4814, lr_0 = 3.4042e-04
Loss = 1.3221e-01, PNorm = 34.9983, GNorm = 2.5798, lr_0 = 3.3091e-04
Validation rmse = 0.143807
Validation r2 = 0.836907
Validation mse = 0.020680
Epoch 28
Loss = 1.0667e-01, PNorm = 35.0065, GNorm = 1.2007, lr_0 = 3.2165e-04
Validation rmse = 0.141937
Validation r2 = 0.841120
Validation mse = 0.020146
Epoch 29
Loss = 9.8659e-02, PNorm = 35.0150, GNorm = 0.9333, lr_0 = 3.1178e-04
Loss = 9.9605e-02, PNorm = 35.0242, GNorm = 1.5657, lr_0 = 3.0306e-04
Validation rmse = 0.142021
Validation r2 = 0.840932
Validation mse = 0.020170
Epoch 30
Loss = 1.0185e-01, PNorm = 35.0335, GNorm = 2.1298, lr_0 = 2.9459e-04
Validation rmse = 0.140873
Validation r2 = 0.843492
Validation mse = 0.019845
Epoch 31
Loss = 1.0920e-01, PNorm = 35.0401, GNorm = 2.1377, lr_0 = 2.8554e-04
Loss = 1.0577e-01, PNorm = 35.0464, GNorm = 3.3670, lr_0 = 2.7756e-04
Loss = 7.4351e-02, PNorm = 35.0476, GNorm = 4.0760, lr_0 = 2.7677e-04
Validation rmse = 0.145521
Validation r2 = 0.832995
Validation mse = 0.021176
Epoch 32
Loss = 1.1232e-01, PNorm = 35.0535, GNorm = 2.2582, lr_0 = 2.6903e-04
Validation rmse = 0.141382
Validation r2 = 0.842361
Validation mse = 0.019989
Epoch 33
Loss = 1.0366e-01, PNorm = 35.0615, GNorm = 4.4354, lr_0 = 2.6151e-04
Validation rmse = 0.143364
Validation r2 = 0.837910
Validation mse = 0.020553
Epoch 34
Loss = 1.3584e-01, PNorm = 35.0699, GNorm = 1.9828, lr_0 = 2.5348e-04
Loss = 9.4094e-02, PNorm = 35.0763, GNorm = 1.5112, lr_0 = 2.4639e-04
Validation rmse = 0.139773
Validation r2 = 0.845927
Validation mse = 0.019537
Epoch 35
Loss = 9.4043e-02, PNorm = 35.0813, GNorm = 0.4785, lr_0 = 2.3950e-04
Validation rmse = 0.139761
Validation r2 = 0.845955
Validation mse = 0.019533
Epoch 36
Loss = 8.7010e-02, PNorm = 35.0880, GNorm = 0.4790, lr_0 = 2.3215e-04
Loss = 1.0433e-01, PNorm = 35.0928, GNorm = 1.6221, lr_0 = 2.2566e-04
Validation rmse = 0.138388
Validation r2 = 0.848966
Validation mse = 0.019151
Epoch 37
Loss = 9.7562e-02, PNorm = 35.1016, GNorm = 0.5390, lr_0 = 2.1873e-04
Validation rmse = 0.138083
Validation r2 = 0.849630
Validation mse = 0.019067
Epoch 38
Loss = 9.0590e-02, PNorm = 35.1063, GNorm = 0.5882, lr_0 = 2.1261e-04
Loss = 1.0267e-01, PNorm = 35.1121, GNorm = 1.3554, lr_0 = 2.0667e-04
Validation rmse = 0.141012
Validation r2 = 0.843183
Validation mse = 0.019885
Epoch 39
Loss = 9.6820e-02, PNorm = 35.1180, GNorm = 0.9167, lr_0 = 2.0032e-04
Validation rmse = 0.138308
Validation r2 = 0.849139
Validation mse = 0.019129
Epoch 40
Loss = 9.4649e-02, PNorm = 35.1223, GNorm = 1.5647, lr_0 = 1.9472e-04
Loss = 9.5791e-02, PNorm = 35.1280, GNorm = 1.1849, lr_0 = 1.8928e-04
Loss = 5.6419e-02, PNorm = 35.1287, GNorm = 1.7863, lr_0 = 1.8874e-04
Validation rmse = 0.140370
Validation r2 = 0.844608
Validation mse = 0.019704
Epoch 41
Loss = 8.9689e-02, PNorm = 35.1338, GNorm = 1.7861, lr_0 = 1.8346e-04
Validation rmse = 0.138337
Validation r2 = 0.849078
Validation mse = 0.019137
Epoch 42
Loss = 8.1601e-02, PNorm = 35.1392, GNorm = 0.7960, lr_0 = 1.7783e-04
Validation rmse = 0.139058
Validation r2 = 0.847499
Validation mse = 0.019337
Epoch 43
Loss = 6.7601e-02, PNorm = 35.1435, GNorm = 0.4264, lr_0 = 1.7286e-04
Loss = 9.1567e-02, PNorm = 35.1489, GNorm = 1.5389, lr_0 = 1.6802e-04
Validation rmse = 0.138169
Validation r2 = 0.849444
Validation mse = 0.019091
Epoch 44
Loss = 9.3605e-02, PNorm = 35.1540, GNorm = 1.2959, lr_0 = 1.6286e-04
Validation rmse = 0.139163
Validation r2 = 0.847270
Validation mse = 0.019366
Epoch 45
Loss = 7.4633e-02, PNorm = 35.1589, GNorm = 0.7453, lr_0 = 1.5831e-04
Loss = 9.4599e-02, PNorm = 35.1628, GNorm = 0.8199, lr_0 = 1.5388e-04
Validation rmse = 0.138567
Validation r2 = 0.848576
Validation mse = 0.019201
Epoch 46
Loss = 7.9484e-02, PNorm = 35.1679, GNorm = 0.7652, lr_0 = 1.4916e-04
Validation rmse = 0.140046
Validation r2 = 0.845326
Validation mse = 0.019613
Epoch 47
Loss = 8.9924e-02, PNorm = 35.1726, GNorm = 0.7360, lr_0 = 1.4458e-04
Loss = 8.6121e-02, PNorm = 35.1759, GNorm = 1.2401, lr_0 = 1.4053e-04
Validation rmse = 0.137333
Validation r2 = 0.851260
Validation mse = 0.018860
Epoch 48
Loss = 8.5426e-02, PNorm = 35.1798, GNorm = 1.9486, lr_0 = 1.3661e-04
Validation rmse = 0.140204
Validation r2 = 0.844977
Validation mse = 0.019657
Epoch 49
Loss = 7.5434e-02, PNorm = 35.1846, GNorm = 1.7828, lr_0 = 1.3241e-04
Loss = 1.0848e-01, PNorm = 35.1882, GNorm = 4.1891, lr_0 = 1.2871e-04
Validation rmse = 0.143372
Validation r2 = 0.837890
Validation mse = 0.020556
Epoch 50
Loss = 9.8619e-02, PNorm = 35.1919, GNorm = 0.7810, lr_0 = 1.2511e-04
Validation rmse = 0.138636
Validation r2 = 0.848425
Validation mse = 0.019220
Epoch 51
Loss = 7.9742e-02, PNorm = 35.1960, GNorm = 0.8280, lr_0 = 1.2127e-04
Validation rmse = 0.145555
Validation r2 = 0.832917
Validation mse = 0.021186
Epoch 52
Loss = 9.2482e-02, PNorm = 35.2001, GNorm = 2.2951, lr_0 = 1.1754e-04
Loss = 8.8126e-02, PNorm = 35.2031, GNorm = 0.5148, lr_0 = 1.1426e-04
Validation rmse = 0.139791
Validation r2 = 0.845889
Validation mse = 0.019541
Epoch 53
Loss = 9.3119e-02, PNorm = 35.2070, GNorm = 1.2211, lr_0 = 1.1106e-04
Validation rmse = 0.136404
Validation r2 = 0.853265
Validation mse = 0.018606
Epoch 54
Loss = 8.0070e-02, PNorm = 35.2097, GNorm = 1.2704, lr_0 = 1.0765e-04
Loss = 8.9264e-02, PNorm = 35.2128, GNorm = 2.4137, lr_0 = 1.0464e-04
Validation rmse = 0.137977
Validation r2 = 0.849861
Validation mse = 0.019038
Epoch 55
Loss = 8.8862e-02, PNorm = 35.2158, GNorm = 0.7150, lr_0 = 1.0172e-04
Validation rmse = 0.139377
Validation r2 = 0.846800
Validation mse = 0.019426
Epoch 56
Loss = 8.6394e-02, PNorm = 35.2195, GNorm = 0.6718, lr_0 = 1.0000e-04
Loss = 8.6879e-02, PNorm = 35.2222, GNorm = 0.9626, lr_0 = 1.0000e-04
Loss = 4.8710e-02, PNorm = 35.2225, GNorm = 2.3697, lr_0 = 1.0000e-04
Validation rmse = 0.137297
Validation r2 = 0.851338
Validation mse = 0.018850
Epoch 57
Loss = 8.6055e-02, PNorm = 35.2250, GNorm = 2.0935, lr_0 = 1.0000e-04
Validation rmse = 0.136569
Validation r2 = 0.852909
Validation mse = 0.018651
Epoch 58
Loss = 7.4141e-02, PNorm = 35.2274, GNorm = 0.7264, lr_0 = 1.0000e-04
Validation rmse = 0.136089
Validation r2 = 0.853942
Validation mse = 0.018520
Epoch 59
Loss = 9.7436e-02, PNorm = 35.2305, GNorm = 1.9213, lr_0 = 1.0000e-04
Loss = 8.2812e-02, PNorm = 35.2336, GNorm = 0.6876, lr_0 = 1.0000e-04
Validation rmse = 0.137283
Validation r2 = 0.851368
Validation mse = 0.018847
Model 0 best validation rmse = 0.136089 on epoch 58
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.205956
Model 0 test r2 = 0.045894
Model 0 test mse = 0.042418
Ensemble test rmse = 0.205956
Ensemble test r2 = 0.045894
Ensemble test mse = 0.042418
Fold 4
Splitting data with seed 4
Total size = 901 | train size = 720 | val size = 181 | test size = 121
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 1.0066e+00, PNorm = 34.0154, GNorm = 1.3787, lr_0 = 4.5357e-04
Validation rmse = 0.324778
Validation r2 = 0.215322
Validation mse = 0.105481
Epoch 1
Loss = 8.7307e-01, PNorm = 34.0411, GNorm = 5.2393, lr_0 = 8.0714e-04
Validation rmse = 0.289675
Validation r2 = 0.375775
Validation mse = 0.083912
Epoch 2
Loss = 4.6753e-01, PNorm = 34.1072, GNorm = 1.6756, lr_0 = 9.8592e-04
Loss = 4.8459e-01, PNorm = 34.1915, GNorm = 5.8233, lr_0 = 9.5836e-04
Validation rmse = 0.267435
Validation r2 = 0.467949
Validation mse = 0.071521
Epoch 3
Loss = 3.7652e-01, PNorm = 34.2672, GNorm = 2.4928, lr_0 = 9.3156e-04
Validation rmse = 0.249069
Validation r2 = 0.538516
Validation mse = 0.062035
Epoch 4
Loss = 3.5957e-01, PNorm = 34.3362, GNorm = 2.4088, lr_0 = 9.0295e-04
Loss = 2.9012e-01, PNorm = 34.3910, GNorm = 1.1029, lr_0 = 8.7771e-04
Validation rmse = 0.209450
Validation r2 = 0.673654
Validation mse = 0.043869
Epoch 5
Loss = 2.5921e-01, PNorm = 34.4448, GNorm = 2.3231, lr_0 = 8.5317e-04
Validation rmse = 0.190028
Validation r2 = 0.731370
Validation mse = 0.036111
Epoch 6
Loss = 2.0044e-01, PNorm = 34.4909, GNorm = 2.1093, lr_0 = 8.2697e-04
Loss = 1.8249e-01, PNorm = 34.5348, GNorm = 1.0656, lr_0 = 8.0385e-04
Loss = 1.4764e-01, PNorm = 34.5389, GNorm = 3.4650, lr_0 = 8.0157e-04
Validation rmse = 0.182429
Validation r2 = 0.752425
Validation mse = 0.033280
Epoch 7
Loss = 1.7256e-01, PNorm = 34.5740, GNorm = 1.4410, lr_0 = 7.7916e-04
Validation rmse = 0.181591
Validation r2 = 0.754696
Validation mse = 0.032975
Epoch 8
Loss = 1.4981e-01, PNorm = 34.6026, GNorm = 2.9033, lr_0 = 7.5737e-04
Validation rmse = 0.198364
Validation r2 = 0.707287
Validation mse = 0.039348
Epoch 9
Loss = 2.1193e-01, PNorm = 34.6347, GNorm = 5.5496, lr_0 = 7.3411e-04
Loss = 1.8451e-01, PNorm = 34.6606, GNorm = 1.3944, lr_0 = 7.1359e-04
Validation rmse = 0.179921
Validation r2 = 0.759186
Validation mse = 0.032372
Epoch 10
Loss = 1.5006e-01, PNorm = 34.6845, GNorm = 2.3325, lr_0 = 6.9364e-04
Validation rmse = 0.173253
Validation r2 = 0.776705
Validation mse = 0.030017
Epoch 11
Loss = 1.3470e-01, PNorm = 34.7160, GNorm = 6.0486, lr_0 = 6.7234e-04
Loss = 1.5618e-01, PNorm = 34.7369, GNorm = 6.0311, lr_0 = 6.5354e-04
Validation rmse = 0.187150
Validation r2 = 0.739447
Validation mse = 0.035025
Epoch 12
Loss = 1.5628e-01, PNorm = 34.7642, GNorm = 1.4817, lr_0 = 6.3347e-04
Validation rmse = 0.173738
Validation r2 = 0.775453
Validation mse = 0.030185
Epoch 13
Loss = 1.4374e-01, PNorm = 34.7836, GNorm = 2.5760, lr_0 = 6.1576e-04
Loss = 1.1978e-01, PNorm = 34.8004, GNorm = 2.4253, lr_0 = 5.9854e-04
Validation rmse = 0.163939
Validation r2 = 0.800067
Validation mse = 0.026876
Epoch 14
Loss = 1.1384e-01, PNorm = 34.8199, GNorm = 0.3429, lr_0 = 5.8016e-04
Validation rmse = 0.187771
Validation r2 = 0.737714
Validation mse = 0.035258
Epoch 15
Loss = 1.4991e-01, PNorm = 34.8385, GNorm = 5.0667, lr_0 = 5.6394e-04
Loss = 1.1732e-01, PNorm = 34.8525, GNorm = 2.5345, lr_0 = 5.4817e-04
Loss = 1.5800e-01, PNorm = 34.8541, GNorm = 2.7772, lr_0 = 5.4662e-04
Validation rmse = 0.166079
Validation r2 = 0.794814
Validation mse = 0.027582
Epoch 16
Loss = 1.1305e-01, PNorm = 34.8727, GNorm = 1.2309, lr_0 = 5.3134e-04
Validation rmse = 0.162295
Validation r2 = 0.804058
Validation mse = 0.026340
Epoch 17
Loss = 9.4198e-02, PNorm = 34.8861, GNorm = 1.3381, lr_0 = 5.1502e-04
Validation rmse = 0.166233
Validation r2 = 0.794435
Validation mse = 0.027633
Epoch 18
Loss = 1.0757e-01, PNorm = 34.8968, GNorm = 3.0145, lr_0 = 5.0062e-04
Loss = 1.0480e-01, PNorm = 34.9095, GNorm = 0.5874, lr_0 = 4.8662e-04
Validation rmse = 0.162311
Validation r2 = 0.804019
Validation mse = 0.026345
Epoch 19
Loss = 1.0390e-01, PNorm = 34.9191, GNorm = 2.8056, lr_0 = 4.7168e-04
Validation rmse = 0.164092
Validation r2 = 0.799694
Validation mse = 0.026926
Epoch 20
Loss = 9.8289e-02, PNorm = 34.9318, GNorm = 1.1425, lr_0 = 4.5849e-04
Loss = 9.9636e-02, PNorm = 34.9422, GNorm = 0.5937, lr_0 = 4.4567e-04
Validation rmse = 0.164620
Validation r2 = 0.798404
Validation mse = 0.027100
Epoch 21
Loss = 1.0967e-01, PNorm = 34.9560, GNorm = 3.0171, lr_0 = 4.3198e-04
Validation rmse = 0.161952
Validation r2 = 0.804884
Validation mse = 0.026229
Epoch 22
Loss = 8.6255e-02, PNorm = 34.9674, GNorm = 0.6968, lr_0 = 4.1872e-04
Loss = 1.0917e-01, PNorm = 34.9791, GNorm = 1.7457, lr_0 = 4.0701e-04
Validation rmse = 0.163286
Validation r2 = 0.801657
Validation mse = 0.026662
Epoch 23
Loss = 9.0186e-02, PNorm = 34.9890, GNorm = 1.0920, lr_0 = 3.9563e-04
Validation rmse = 0.163174
Validation r2 = 0.801930
Validation mse = 0.026626
Epoch 24
Loss = 9.1192e-02, PNorm = 35.0005, GNorm = 1.1333, lr_0 = 3.8348e-04
Loss = 8.8749e-02, PNorm = 35.0089, GNorm = 0.8902, lr_0 = 3.7276e-04
Validation rmse = 0.161412
Validation r2 = 0.806183
Validation mse = 0.026054
Epoch 25
Loss = 8.1191e-02, PNorm = 35.0195, GNorm = 0.6894, lr_0 = 3.6234e-04
Validation rmse = 0.161508
Validation r2 = 0.805954
Validation mse = 0.026085
Epoch 26
Loss = 7.6597e-02, PNorm = 35.0304, GNorm = 1.3605, lr_0 = 3.5121e-04
Validation rmse = 0.163531
Validation r2 = 0.801061
Validation mse = 0.026742
Epoch 27
Loss = 1.2259e-01, PNorm = 35.0414, GNorm = 2.2884, lr_0 = 3.4042e-04
Loss = 8.9920e-02, PNorm = 35.0508, GNorm = 0.9814, lr_0 = 3.3091e-04
Validation rmse = 0.165480
Validation r2 = 0.796293
Validation mse = 0.027383
Epoch 28
Loss = 8.8807e-02, PNorm = 35.0580, GNorm = 1.2377, lr_0 = 3.2165e-04
Validation rmse = 0.162283
Validation r2 = 0.804086
Validation mse = 0.026336
Epoch 29
Loss = 9.0621e-02, PNorm = 35.0673, GNorm = 2.4379, lr_0 = 3.1178e-04
Loss = 8.7226e-02, PNorm = 35.0762, GNorm = 0.7691, lr_0 = 3.0306e-04
Validation rmse = 0.160782
Validation r2 = 0.807695
Validation mse = 0.025851
Epoch 30
Loss = 8.7671e-02, PNorm = 35.0834, GNorm = 0.6718, lr_0 = 2.9459e-04
Validation rmse = 0.163942
Validation r2 = 0.800061
Validation mse = 0.026877
Epoch 31
Loss = 9.2923e-02, PNorm = 35.0924, GNorm = 0.4555, lr_0 = 2.8554e-04
Loss = 8.4212e-02, PNorm = 35.1015, GNorm = 0.9386, lr_0 = 2.7756e-04
Loss = 4.7030e-02, PNorm = 35.1024, GNorm = 0.7170, lr_0 = 2.7677e-04
Validation rmse = 0.165151
Validation r2 = 0.797101
Validation mse = 0.027275
Epoch 32
Loss = 8.9363e-02, PNorm = 35.1082, GNorm = 1.2216, lr_0 = 2.6903e-04
Validation rmse = 0.163521
Validation r2 = 0.801087
Validation mse = 0.026739
Epoch 33
Loss = 8.1951e-02, PNorm = 35.1165, GNorm = 2.0389, lr_0 = 2.6151e-04
Validation rmse = 0.170296
Validation r2 = 0.784262
Validation mse = 0.029001
Epoch 34
Loss = 1.0461e-01, PNorm = 35.1242, GNorm = 3.5644, lr_0 = 2.5348e-04
Loss = 8.9798e-02, PNorm = 35.1313, GNorm = 0.8155, lr_0 = 2.4639e-04
Validation rmse = 0.164348
Validation r2 = 0.799069
Validation mse = 0.027010
Epoch 35
Loss = 8.1425e-02, PNorm = 35.1382, GNorm = 2.0268, lr_0 = 2.3950e-04
Validation rmse = 0.168415
Validation r2 = 0.789001
Validation mse = 0.028364
Epoch 36
Loss = 7.4784e-02, PNorm = 35.1458, GNorm = 0.9425, lr_0 = 2.3215e-04
Loss = 8.7118e-02, PNorm = 35.1512, GNorm = 1.7148, lr_0 = 2.2566e-04
Validation rmse = 0.161915
Validation r2 = 0.804975
Validation mse = 0.026216
Epoch 37
Loss = 8.9585e-02, PNorm = 35.1610, GNorm = 2.5615, lr_0 = 2.1873e-04
Validation rmse = 0.161044
Validation r2 = 0.807068
Validation mse = 0.025935
Epoch 38
Loss = 9.2735e-02, PNorm = 35.1656, GNorm = 3.5379, lr_0 = 2.1261e-04
Loss = 8.3814e-02, PNorm = 35.1715, GNorm = 3.0859, lr_0 = 2.0667e-04
Validation rmse = 0.167374
Validation r2 = 0.791602
Validation mse = 0.028014
Epoch 39
Loss = 8.7779e-02, PNorm = 35.1790, GNorm = 0.7368, lr_0 = 2.0032e-04
Validation rmse = 0.161586
Validation r2 = 0.805765
Validation mse = 0.026110
Epoch 40
Loss = 8.2721e-02, PNorm = 35.1848, GNorm = 2.6431, lr_0 = 1.9472e-04
Loss = 8.4825e-02, PNorm = 35.1913, GNorm = 1.2989, lr_0 = 1.8928e-04
Loss = 3.1722e-02, PNorm = 35.1919, GNorm = 1.1143, lr_0 = 1.8874e-04
Validation rmse = 0.164269
Validation r2 = 0.799263
Validation mse = 0.026984
Epoch 41
Loss = 7.4337e-02, PNorm = 35.1971, GNorm = 1.5788, lr_0 = 1.8346e-04
Validation rmse = 0.166381
Validation r2 = 0.794067
Validation mse = 0.027683
Epoch 42
Loss = 7.3089e-02, PNorm = 35.2028, GNorm = 1.7311, lr_0 = 1.7783e-04
Validation rmse = 0.160838
Validation r2 = 0.807559
Validation mse = 0.025869
Epoch 43
Loss = 7.8480e-02, PNorm = 35.2068, GNorm = 1.0812, lr_0 = 1.7286e-04
Loss = 7.3677e-02, PNorm = 35.2113, GNorm = 1.2249, lr_0 = 1.6802e-04
Validation rmse = 0.162134
Validation r2 = 0.804447
Validation mse = 0.026287
Epoch 44
Loss = 7.3552e-02, PNorm = 35.2166, GNorm = 1.2401, lr_0 = 1.6286e-04
Validation rmse = 0.163395
Validation r2 = 0.801393
Validation mse = 0.026698
Epoch 45
Loss = 7.0854e-02, PNorm = 35.2214, GNorm = 1.7602, lr_0 = 1.5831e-04
Loss = 7.6509e-02, PNorm = 35.2259, GNorm = 2.4973, lr_0 = 1.5388e-04
Validation rmse = 0.165714
Validation r2 = 0.795716
Validation mse = 0.027461
Epoch 46
Loss = 7.4588e-02, PNorm = 35.2307, GNorm = 1.2170, lr_0 = 1.4916e-04
Validation rmse = 0.162002
Validation r2 = 0.804764
Validation mse = 0.026245
Epoch 47
Loss = 9.1526e-02, PNorm = 35.2357, GNorm = 1.6662, lr_0 = 1.4458e-04
Loss = 7.0713e-02, PNorm = 35.2406, GNorm = 1.2265, lr_0 = 1.4053e-04
Validation rmse = 0.163147
Validation r2 = 0.801995
Validation mse = 0.026617
Epoch 48
Loss = 6.6262e-02, PNorm = 35.2436, GNorm = 0.5346, lr_0 = 1.3661e-04
Validation rmse = 0.163323
Validation r2 = 0.801568
Validation mse = 0.026674
Epoch 49
Loss = 7.4157e-02, PNorm = 35.2474, GNorm = 0.6986, lr_0 = 1.3241e-04
Loss = 7.3406e-02, PNorm = 35.2516, GNorm = 1.7479, lr_0 = 1.2871e-04
Validation rmse = 0.164349
Validation r2 = 0.799067
Validation mse = 0.027011
Epoch 50
Loss = 7.8614e-02, PNorm = 35.2554, GNorm = 2.0444, lr_0 = 1.2511e-04
Validation rmse = 0.162863
Validation r2 = 0.802683
Validation mse = 0.026524
Epoch 51
Loss = 6.9769e-02, PNorm = 35.2600, GNorm = 1.5861, lr_0 = 1.2127e-04
Validation rmse = 0.162635
Validation r2 = 0.803236
Validation mse = 0.026450
Epoch 52
Loss = 8.1715e-02, PNorm = 35.2628, GNorm = 1.7131, lr_0 = 1.1754e-04
Loss = 7.1369e-02, PNorm = 35.2675, GNorm = 0.8068, lr_0 = 1.1426e-04
Validation rmse = 0.162561
Validation r2 = 0.803414
Validation mse = 0.026426
Epoch 53
Loss = 7.2209e-02, PNorm = 35.2704, GNorm = 2.5010, lr_0 = 1.1106e-04
Validation rmse = 0.162499
Validation r2 = 0.803565
Validation mse = 0.026406
Epoch 54
Loss = 6.5055e-02, PNorm = 35.2740, GNorm = 1.2003, lr_0 = 1.0765e-04
Loss = 7.6564e-02, PNorm = 35.2769, GNorm = 0.4543, lr_0 = 1.0464e-04
Validation rmse = 0.164398
Validation r2 = 0.798948
Validation mse = 0.027027
Epoch 55
Loss = 7.3705e-02, PNorm = 35.2797, GNorm = 0.9325, lr_0 = 1.0172e-04
Validation rmse = 0.162565
Validation r2 = 0.803405
Validation mse = 0.026427
Epoch 56
Loss = 7.3391e-02, PNorm = 35.2838, GNorm = 2.4737, lr_0 = 1.0000e-04
Loss = 7.5849e-02, PNorm = 35.2868, GNorm = 0.6628, lr_0 = 1.0000e-04
Loss = 6.1260e-02, PNorm = 35.2872, GNorm = 1.1314, lr_0 = 1.0000e-04
Validation rmse = 0.161707
Validation r2 = 0.805476
Validation mse = 0.026149
Epoch 57
Loss = 7.3364e-02, PNorm = 35.2904, GNorm = 0.4015, lr_0 = 1.0000e-04
Validation rmse = 0.161408
Validation r2 = 0.806194
Validation mse = 0.026053
Epoch 58
Loss = 6.1502e-02, PNorm = 35.2932, GNorm = 1.3964, lr_0 = 1.0000e-04
Validation rmse = 0.164268
Validation r2 = 0.799265
Validation mse = 0.026984
Epoch 59
Loss = 5.5726e-02, PNorm = 35.2968, GNorm = 0.5703, lr_0 = 1.0000e-04
Loss = 7.7236e-02, PNorm = 35.2991, GNorm = 1.0253, lr_0 = 1.0000e-04
Validation rmse = 0.166979
Validation r2 = 0.792585
Validation mse = 0.027882
Model 0 best validation rmse = 0.160782 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.149203
Model 0 test r2 = 0.499268
Model 0 test mse = 0.022262
Ensemble test rmse = 0.149203
Ensemble test r2 = 0.499268
Ensemble test mse = 0.022262
Fold 5
Splitting data with seed 5
Total size = 901 | train size = 720 | val size = 181 | test size = 121
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.3932e-01, PNorm = 34.0186, GNorm = 1.4262, lr_0 = 4.5357e-04
Validation rmse = 0.303935
Validation r2 = 0.251980
Validation mse = 0.092376
Epoch 1
Loss = 5.9910e-01, PNorm = 34.0612, GNorm = 5.2725, lr_0 = 8.0714e-04
Validation rmse = 0.247326
Validation r2 = 0.504672
Validation mse = 0.061170
Epoch 2
Loss = 6.0418e-01, PNorm = 34.1336, GNorm = 15.2500, lr_0 = 9.8592e-04
Loss = 5.1565e-01, PNorm = 34.1898, GNorm = 6.7862, lr_0 = 9.5836e-04
Validation rmse = 0.297229
Validation r2 = 0.284623
Validation mse = 0.088345
Epoch 3
Loss = 4.3924e-01, PNorm = 34.2468, GNorm = 2.1596, lr_0 = 9.3156e-04
Validation rmse = 0.228278
Validation r2 = 0.578030
Validation mse = 0.052111
Epoch 4
Loss = 3.2348e-01, PNorm = 34.3042, GNorm = 4.2910, lr_0 = 9.0295e-04
Loss = 3.4817e-01, PNorm = 34.3573, GNorm = 6.0218, lr_0 = 8.7771e-04
Validation rmse = 0.217539
Validation r2 = 0.616798
Validation mse = 0.047323
Epoch 5
Loss = 2.5893e-01, PNorm = 34.4147, GNorm = 1.6302, lr_0 = 8.5317e-04
Validation rmse = 0.209920
Validation r2 = 0.643172
Validation mse = 0.044066
Epoch 6
Loss = 2.8230e-01, PNorm = 34.4641, GNorm = 2.9783, lr_0 = 8.2697e-04
Loss = 2.8758e-01, PNorm = 34.5063, GNorm = 1.1717, lr_0 = 8.0385e-04
Loss = 2.4588e-01, PNorm = 34.5101, GNorm = 5.1918, lr_0 = 8.0157e-04
Validation rmse = 0.231952
Validation r2 = 0.564338
Validation mse = 0.053802
Epoch 7
Loss = 2.3745e-01, PNorm = 34.5567, GNorm = 6.5144, lr_0 = 7.7916e-04
Validation rmse = 0.211897
Validation r2 = 0.636420
Validation mse = 0.044900
Epoch 8
Loss = 2.1618e-01, PNorm = 34.5947, GNorm = 3.5417, lr_0 = 7.5737e-04
Validation rmse = 0.196836
Validation r2 = 0.686265
Validation mse = 0.038745
Epoch 9
Loss = 2.6704e-01, PNorm = 34.6385, GNorm = 2.8759, lr_0 = 7.3411e-04
Loss = 1.5591e-01, PNorm = 34.6756, GNorm = 1.3914, lr_0 = 7.1359e-04
Validation rmse = 0.181642
Validation r2 = 0.732832
Validation mse = 0.032994
Epoch 10
Loss = 1.4043e-01, PNorm = 34.7097, GNorm = 0.6238, lr_0 = 6.9364e-04
Validation rmse = 0.176680
Validation r2 = 0.747230
Validation mse = 0.031216
Epoch 11
Loss = 1.3217e-01, PNorm = 34.7414, GNorm = 1.9316, lr_0 = 6.7234e-04
Loss = 1.2418e-01, PNorm = 34.7695, GNorm = 0.9869, lr_0 = 6.5354e-04
Validation rmse = 0.174454
Validation r2 = 0.753559
Validation mse = 0.030434
Epoch 12
Loss = 1.3366e-01, PNorm = 34.7955, GNorm = 1.4664, lr_0 = 6.3347e-04
Validation rmse = 0.173462
Validation r2 = 0.756352
Validation mse = 0.030089
Epoch 13
Loss = 1.3135e-01, PNorm = 34.8205, GNorm = 1.0795, lr_0 = 6.1576e-04
Loss = 1.2482e-01, PNorm = 34.8408, GNorm = 1.0813, lr_0 = 5.9854e-04
Validation rmse = 0.175426
Validation r2 = 0.750803
Validation mse = 0.030774
Epoch 14
Loss = 1.2365e-01, PNorm = 34.8657, GNorm = 0.4767, lr_0 = 5.8016e-04
Validation rmse = 0.169705
Validation r2 = 0.766794
Validation mse = 0.028800
Epoch 15
Loss = 1.1241e-01, PNorm = 34.8862, GNorm = 3.9182, lr_0 = 5.6394e-04
Loss = 1.3142e-01, PNorm = 34.9065, GNorm = 1.6283, lr_0 = 5.4817e-04
Loss = 1.8004e-01, PNorm = 34.9089, GNorm = 2.0421, lr_0 = 5.4662e-04
Validation rmse = 0.165264
Validation r2 = 0.778840
Validation mse = 0.027312
Epoch 16
Loss = 1.1480e-01, PNorm = 34.9265, GNorm = 0.8722, lr_0 = 5.3134e-04
Validation rmse = 0.167724
Validation r2 = 0.772206
Validation mse = 0.028131
Epoch 17
Loss = 1.2180e-01, PNorm = 34.9395, GNorm = 1.3275, lr_0 = 5.1502e-04
Validation rmse = 0.163252
Validation r2 = 0.784190
Validation mse = 0.026651
Epoch 18
Loss = 1.1373e-01, PNorm = 34.9548, GNorm = 1.2242, lr_0 = 5.0062e-04
Loss = 1.0185e-01, PNorm = 34.9715, GNorm = 0.8330, lr_0 = 4.8662e-04
Validation rmse = 0.159825
Validation r2 = 0.793157
Validation mse = 0.025544
Epoch 19
Loss = 9.4621e-02, PNorm = 34.9863, GNorm = 1.2761, lr_0 = 4.7168e-04
Validation rmse = 0.170690
Validation r2 = 0.764078
Validation mse = 0.029135
Epoch 20
Loss = 8.3210e-02, PNorm = 34.9994, GNorm = 3.4596, lr_0 = 4.5849e-04
Loss = 1.1750e-01, PNorm = 35.0096, GNorm = 0.9476, lr_0 = 4.4567e-04
Validation rmse = 0.161950
Validation r2 = 0.787619
Validation mse = 0.026228
Epoch 21
Loss = 9.7815e-02, PNorm = 35.0294, GNorm = 1.5209, lr_0 = 4.3198e-04
Validation rmse = 0.160109
Validation r2 = 0.792420
Validation mse = 0.025635
Epoch 22
Loss = 1.0009e-01, PNorm = 35.0410, GNorm = 0.8186, lr_0 = 4.1872e-04
Loss = 1.0100e-01, PNorm = 35.0535, GNorm = 1.7879, lr_0 = 4.0701e-04
Validation rmse = 0.170227
Validation r2 = 0.765356
Validation mse = 0.028977
Epoch 23
Loss = 1.1366e-01, PNorm = 35.0660, GNorm = 2.2542, lr_0 = 3.9563e-04
Validation rmse = 0.165125
Validation r2 = 0.779209
Validation mse = 0.027266
Epoch 24
Loss = 1.0530e-01, PNorm = 35.0798, GNorm = 1.0827, lr_0 = 3.8348e-04
Loss = 9.1915e-02, PNorm = 35.0903, GNorm = 2.4570, lr_0 = 3.7276e-04
Validation rmse = 0.159404
Validation r2 = 0.794246
Validation mse = 0.025410
Epoch 25
Loss = 9.8257e-02, PNorm = 35.1008, GNorm = 0.5496, lr_0 = 3.6234e-04
Validation rmse = 0.162752
Validation r2 = 0.785511
Validation mse = 0.026488
Epoch 26
Loss = 9.3148e-02, PNorm = 35.1106, GNorm = 1.3971, lr_0 = 3.5121e-04
Validation rmse = 0.157618
Validation r2 = 0.798830
Validation mse = 0.024843
Epoch 27
Loss = 8.6296e-02, PNorm = 35.1226, GNorm = 1.4475, lr_0 = 3.4042e-04
Loss = 8.9740e-02, PNorm = 35.1344, GNorm = 1.3002, lr_0 = 3.3091e-04
Validation rmse = 0.157226
Validation r2 = 0.799828
Validation mse = 0.024720
Epoch 28
Loss = 9.4004e-02, PNorm = 35.1452, GNorm = 1.7076, lr_0 = 3.2165e-04
Validation rmse = 0.158518
Validation r2 = 0.796524
Validation mse = 0.025128
Epoch 29
Loss = 7.8746e-02, PNorm = 35.1564, GNorm = 0.6748, lr_0 = 3.1178e-04
Loss = 9.6888e-02, PNorm = 35.1645, GNorm = 1.0912, lr_0 = 3.0306e-04
Validation rmse = 0.157468
Validation r2 = 0.799213
Validation mse = 0.024796
Epoch 30
Loss = 8.8560e-02, PNorm = 35.1751, GNorm = 0.6826, lr_0 = 2.9459e-04
Validation rmse = 0.158773
Validation r2 = 0.795870
Validation mse = 0.025209
Epoch 31
Loss = 8.5085e-02, PNorm = 35.1865, GNorm = 1.9936, lr_0 = 2.8554e-04
Loss = 9.1044e-02, PNorm = 35.1927, GNorm = 2.5577, lr_0 = 2.7756e-04
Loss = 1.3216e-01, PNorm = 35.1937, GNorm = 3.7175, lr_0 = 2.7677e-04
Validation rmse = 0.155965
Validation r2 = 0.803026
Validation mse = 0.024325
Epoch 32
Loss = 8.4224e-02, PNorm = 35.2035, GNorm = 0.8226, lr_0 = 2.6903e-04
Validation rmse = 0.153749
Validation r2 = 0.808585
Validation mse = 0.023639
Epoch 33
Loss = 8.3422e-02, PNorm = 35.2106, GNorm = 1.0834, lr_0 = 2.6151e-04
Validation rmse = 0.162417
Validation r2 = 0.786394
Validation mse = 0.026379
Epoch 34
Loss = 8.0935e-02, PNorm = 35.2200, GNorm = 2.4516, lr_0 = 2.5348e-04
Loss = 8.8204e-02, PNorm = 35.2294, GNorm = 1.0817, lr_0 = 2.4639e-04
Validation rmse = 0.157447
Validation r2 = 0.799266
Validation mse = 0.024789
Epoch 35
Loss = 8.6681e-02, PNorm = 35.2365, GNorm = 2.3607, lr_0 = 2.3950e-04
Validation rmse = 0.155340
Validation r2 = 0.804603
Validation mse = 0.024130
Epoch 36
Loss = 8.7144e-02, PNorm = 35.2444, GNorm = 1.8133, lr_0 = 2.3215e-04
Loss = 8.3288e-02, PNorm = 35.2529, GNorm = 0.5942, lr_0 = 2.2566e-04
Validation rmse = 0.156391
Validation r2 = 0.801950
Validation mse = 0.024458
Epoch 37
Loss = 8.6297e-02, PNorm = 35.2607, GNorm = 0.4868, lr_0 = 2.1873e-04
Validation rmse = 0.156427
Validation r2 = 0.801857
Validation mse = 0.024470
Epoch 38
Loss = 9.0625e-02, PNorm = 35.2672, GNorm = 1.8305, lr_0 = 2.1261e-04
Loss = 8.0655e-02, PNorm = 35.2739, GNorm = 0.9196, lr_0 = 2.0667e-04
Validation rmse = 0.156816
Validation r2 = 0.800871
Validation mse = 0.024591
Epoch 39
Loss = 9.1895e-02, PNorm = 35.2803, GNorm = 1.2888, lr_0 = 2.0032e-04
Validation rmse = 0.158958
Validation r2 = 0.795396
Validation mse = 0.025267
Epoch 40
Loss = 9.0180e-02, PNorm = 35.2849, GNorm = 3.2046, lr_0 = 1.9472e-04
Loss = 8.2218e-02, PNorm = 35.2912, GNorm = 0.6653, lr_0 = 1.8928e-04
Loss = 6.1381e-02, PNorm = 35.2920, GNorm = 2.7443, lr_0 = 1.8874e-04
Validation rmse = 0.155610
Validation r2 = 0.803922
Validation mse = 0.024214
Epoch 41
Loss = 7.4460e-02, PNorm = 35.2984, GNorm = 0.7462, lr_0 = 1.8346e-04
Validation rmse = 0.155639
Validation r2 = 0.803848
Validation mse = 0.024224
Epoch 42
Loss = 8.0947e-02, PNorm = 35.3047, GNorm = 1.2657, lr_0 = 1.7783e-04
Validation rmse = 0.155133
Validation r2 = 0.805122
Validation mse = 0.024066
Epoch 43
Loss = 9.7024e-02, PNorm = 35.3097, GNorm = 1.2941, lr_0 = 1.7286e-04
Loss = 8.5452e-02, PNorm = 35.3149, GNorm = 2.0777, lr_0 = 1.6802e-04
Validation rmse = 0.154880
Validation r2 = 0.805759
Validation mse = 0.023988
Epoch 44
Loss = 8.4640e-02, PNorm = 35.3203, GNorm = 1.1865, lr_0 = 1.6286e-04
Validation rmse = 0.154713
Validation r2 = 0.806175
Validation mse = 0.023936
Epoch 45
Loss = 8.9194e-02, PNorm = 35.3260, GNorm = 1.1440, lr_0 = 1.5831e-04
Loss = 7.3810e-02, PNorm = 35.3311, GNorm = 1.7947, lr_0 = 1.5388e-04
Validation rmse = 0.155732
Validation r2 = 0.803615
Validation mse = 0.024252
Epoch 46
Loss = 7.9043e-02, PNorm = 35.3369, GNorm = 0.4913, lr_0 = 1.4916e-04
Validation rmse = 0.153982
Validation r2 = 0.808003
Validation mse = 0.023710
Epoch 47
Loss = 8.6502e-02, PNorm = 35.3426, GNorm = 1.4401, lr_0 = 1.4458e-04
Loss = 6.9875e-02, PNorm = 35.3483, GNorm = 0.8669, lr_0 = 1.4053e-04
Validation rmse = 0.155102
Validation r2 = 0.805200
Validation mse = 0.024057
Epoch 48
Loss = 7.4094e-02, PNorm = 35.3515, GNorm = 0.5855, lr_0 = 1.3661e-04
Validation rmse = 0.154647
Validation r2 = 0.806341
Validation mse = 0.023916
Epoch 49
Loss = 7.2557e-02, PNorm = 35.3573, GNorm = 1.4876, lr_0 = 1.3241e-04
Loss = 8.1816e-02, PNorm = 35.3617, GNorm = 2.5664, lr_0 = 1.2871e-04
Validation rmse = 0.153628
Validation r2 = 0.808885
Validation mse = 0.023602
Epoch 50
Loss = 7.4744e-02, PNorm = 35.3652, GNorm = 2.4106, lr_0 = 1.2511e-04
Validation rmse = 0.154643
Validation r2 = 0.806352
Validation mse = 0.023914
Epoch 51
Loss = 6.0244e-02, PNorm = 35.3712, GNorm = 0.3951, lr_0 = 1.2127e-04
Validation rmse = 0.154131
Validation r2 = 0.807632
Validation mse = 0.023756
Epoch 52
Loss = 7.8222e-02, PNorm = 35.3760, GNorm = 2.4210, lr_0 = 1.1754e-04
Loss = 7.9654e-02, PNorm = 35.3803, GNorm = 0.7382, lr_0 = 1.1426e-04
Validation rmse = 0.155706
Validation r2 = 0.803680
Validation mse = 0.024244
Epoch 53
Loss = 7.2343e-02, PNorm = 35.3832, GNorm = 1.6821, lr_0 = 1.1106e-04
Validation rmse = 0.154190
Validation r2 = 0.807484
Validation mse = 0.023775
Epoch 54
Loss = 6.9372e-02, PNorm = 35.3877, GNorm = 0.5016, lr_0 = 1.0765e-04
Loss = 7.6053e-02, PNorm = 35.3914, GNorm = 1.4387, lr_0 = 1.0464e-04
Validation rmse = 0.153875
Validation r2 = 0.808270
Validation mse = 0.023678
Epoch 55
Loss = 7.7727e-02, PNorm = 35.3962, GNorm = 0.7823, lr_0 = 1.0172e-04
Validation rmse = 0.154698
Validation r2 = 0.806213
Validation mse = 0.023932
Epoch 56
Loss = 6.7017e-02, PNorm = 35.3998, GNorm = 0.4595, lr_0 = 1.0000e-04
Loss = 7.6349e-02, PNorm = 35.4034, GNorm = 1.1077, lr_0 = 1.0000e-04
Loss = 7.0447e-02, PNorm = 35.4037, GNorm = 3.5929, lr_0 = 1.0000e-04
Validation rmse = 0.154426
Validation r2 = 0.806895
Validation mse = 0.023847
Epoch 57
Loss = 7.3898e-02, PNorm = 35.4070, GNorm = 0.5484, lr_0 = 1.0000e-04
Validation rmse = 0.157235
Validation r2 = 0.799806
Validation mse = 0.024723
Epoch 58
Loss = 7.5047e-02, PNorm = 35.4105, GNorm = 0.3346, lr_0 = 1.0000e-04
Validation rmse = 0.155629
Validation r2 = 0.803876
Validation mse = 0.024220
Epoch 59
Loss = 7.2838e-02, PNorm = 35.4150, GNorm = 0.5916, lr_0 = 1.0000e-04
Loss = 7.1588e-02, PNorm = 35.4177, GNorm = 0.6490, lr_0 = 1.0000e-04
Validation rmse = 0.153716
Validation r2 = 0.808667
Validation mse = 0.023629
Model 0 best validation rmse = 0.153628 on epoch 49
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.229042
Model 0 test r2 = -0.179989
Model 0 test mse = 0.052460
Ensemble test rmse = 0.229042
Ensemble test r2 = -0.179989
Ensemble test mse = 0.052460
Fold 6
Splitting data with seed 6
Total size = 901 | train size = 720 | val size = 181 | test size = 121
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.9369e-01, PNorm = 34.0175, GNorm = 3.3533, lr_0 = 4.5357e-04
Validation rmse = 0.315462
Validation r2 = 0.213463
Validation mse = 0.099516
Epoch 1
Loss = 7.5585e-01, PNorm = 34.0554, GNorm = 2.2372, lr_0 = 8.0714e-04
Validation rmse = 0.237545
Validation r2 = 0.554019
Validation mse = 0.056427
Epoch 2
Loss = 4.7799e-01, PNorm = 34.1301, GNorm = 3.6820, lr_0 = 9.8592e-04
Loss = 5.6797e-01, PNorm = 34.1955, GNorm = 2.5186, lr_0 = 9.5836e-04
Validation rmse = 0.231860
Validation r2 = 0.575108
Validation mse = 0.053759
Epoch 3
Loss = 3.6561e-01, PNorm = 34.2657, GNorm = 2.3243, lr_0 = 9.3156e-04
Validation rmse = 0.202357
Validation r2 = 0.676359
Validation mse = 0.040948
Epoch 4
Loss = 2.8576e-01, PNorm = 34.3378, GNorm = 0.7340, lr_0 = 9.0295e-04
Loss = 2.8366e-01, PNorm = 34.4034, GNorm = 6.1978, lr_0 = 8.7771e-04
Validation rmse = 0.201166
Validation r2 = 0.680159
Validation mse = 0.040468
Epoch 5
Loss = 2.4684e-01, PNorm = 34.4594, GNorm = 4.3812, lr_0 = 8.5317e-04
Validation rmse = 0.180701
Validation r2 = 0.741925
Validation mse = 0.032653
Epoch 6
Loss = 1.8588e-01, PNorm = 34.5089, GNorm = 2.9915, lr_0 = 8.2697e-04
Loss = 2.0735e-01, PNorm = 34.5464, GNorm = 4.3628, lr_0 = 8.0385e-04
Loss = 3.1130e-01, PNorm = 34.5517, GNorm = 1.6916, lr_0 = 8.0157e-04
Validation rmse = 0.175791
Validation r2 = 0.755760
Validation mse = 0.030902
Epoch 7
Loss = 1.7643e-01, PNorm = 34.5984, GNorm = 1.3494, lr_0 = 7.7916e-04
Validation rmse = 0.188201
Validation r2 = 0.720057
Validation mse = 0.035420
Epoch 8
Loss = 2.2727e-01, PNorm = 34.6309, GNorm = 2.7370, lr_0 = 7.5737e-04
Validation rmse = 0.183539
Validation r2 = 0.733755
Validation mse = 0.033686
Epoch 9
Loss = 1.8613e-01, PNorm = 34.6696, GNorm = 5.8800, lr_0 = 7.3411e-04
Loss = 2.2636e-01, PNorm = 34.7056, GNorm = 1.0330, lr_0 = 7.1359e-04
Validation rmse = 0.170697
Validation r2 = 0.769708
Validation mse = 0.029138
Epoch 10
Loss = 1.6567e-01, PNorm = 34.7384, GNorm = 5.0556, lr_0 = 6.9364e-04
Validation rmse = 0.158836
Validation r2 = 0.800600
Validation mse = 0.025229
Epoch 11
Loss = 1.3365e-01, PNorm = 34.7717, GNorm = 3.2036, lr_0 = 6.7234e-04
Loss = 1.6496e-01, PNorm = 34.7983, GNorm = 2.3387, lr_0 = 6.5354e-04
Validation rmse = 0.148945
Validation r2 = 0.824661
Validation mse = 0.022185
Epoch 12
Loss = 1.3572e-01, PNorm = 34.8204, GNorm = 2.6324, lr_0 = 6.3347e-04
Validation rmse = 0.154603
Validation r2 = 0.811086
Validation mse = 0.023902
Epoch 13
Loss = 1.1424e-01, PNorm = 34.8416, GNorm = 0.9568, lr_0 = 6.1576e-04
Loss = 1.2196e-01, PNorm = 34.8611, GNorm = 2.0656, lr_0 = 5.9854e-04
Validation rmse = 0.147610
Validation r2 = 0.827790
Validation mse = 0.021789
Epoch 14
Loss = 1.1857e-01, PNorm = 34.8768, GNorm = 1.6596, lr_0 = 5.8016e-04
Validation rmse = 0.147435
Validation r2 = 0.828198
Validation mse = 0.021737
Epoch 15
Loss = 9.8288e-02, PNorm = 34.8924, GNorm = 1.1882, lr_0 = 5.6394e-04
Loss = 1.2243e-01, PNorm = 34.9066, GNorm = 2.4601, lr_0 = 5.4817e-04
Loss = 1.0620e-01, PNorm = 34.9080, GNorm = 1.4077, lr_0 = 5.4662e-04
Validation rmse = 0.157970
Validation r2 = 0.802768
Validation mse = 0.024955
Epoch 16
Loss = 1.4595e-01, PNorm = 34.9238, GNorm = 6.0675, lr_0 = 5.3134e-04
Validation rmse = 0.154110
Validation r2 = 0.812290
Validation mse = 0.023750
Epoch 17
Loss = 1.3543e-01, PNorm = 34.9415, GNorm = 3.4086, lr_0 = 5.1502e-04
Validation rmse = 0.146846
Validation r2 = 0.829568
Validation mse = 0.021564
Epoch 18
Loss = 8.1510e-02, PNorm = 34.9571, GNorm = 0.5721, lr_0 = 5.0062e-04
Loss = 1.1038e-01, PNorm = 34.9667, GNorm = 1.0807, lr_0 = 4.8662e-04
Validation rmse = 0.141745
Validation r2 = 0.841202
Validation mse = 0.020092
Epoch 19
Loss = 1.0164e-01, PNorm = 34.9826, GNorm = 1.4397, lr_0 = 4.7168e-04
Validation rmse = 0.145052
Validation r2 = 0.833707
Validation mse = 0.021040
Epoch 20
Loss = 8.4009e-02, PNorm = 34.9969, GNorm = 2.7866, lr_0 = 4.5849e-04
Loss = 1.1323e-01, PNorm = 35.0093, GNorm = 3.0117, lr_0 = 4.4567e-04
Validation rmse = 0.142844
Validation r2 = 0.838732
Validation mse = 0.020404
Epoch 21
Loss = 1.0929e-01, PNorm = 35.0220, GNorm = 1.1814, lr_0 = 4.3198e-04
Validation rmse = 0.144833
Validation r2 = 0.834209
Validation mse = 0.020977
Epoch 22
Loss = 1.0259e-01, PNorm = 35.0354, GNorm = 1.3668, lr_0 = 4.1872e-04
Loss = 9.8093e-02, PNorm = 35.0473, GNorm = 1.0620, lr_0 = 4.0701e-04
Validation rmse = 0.153161
Validation r2 = 0.814595
Validation mse = 0.023458
Epoch 23
Loss = 1.3116e-01, PNorm = 35.0593, GNorm = 4.4679, lr_0 = 3.9563e-04
Validation rmse = 0.141286
Validation r2 = 0.842231
Validation mse = 0.019962
Epoch 24
Loss = 9.3443e-02, PNorm = 35.0754, GNorm = 1.1873, lr_0 = 3.8348e-04
Loss = 1.0766e-01, PNorm = 35.0886, GNorm = 1.0032, lr_0 = 3.7276e-04
Validation rmse = 0.146321
Validation r2 = 0.830784
Validation mse = 0.021410
Epoch 25
Loss = 1.0364e-01, PNorm = 35.0990, GNorm = 1.8670, lr_0 = 3.6234e-04
Validation rmse = 0.145213
Validation r2 = 0.833339
Validation mse = 0.021087
Epoch 26
Loss = 9.2566e-02, PNorm = 35.1104, GNorm = 0.6680, lr_0 = 3.5121e-04
Validation rmse = 0.144928
Validation r2 = 0.833990
Validation mse = 0.021004
Epoch 27
Loss = 8.9797e-02, PNorm = 35.1199, GNorm = 1.8739, lr_0 = 3.4042e-04
Loss = 9.9150e-02, PNorm = 35.1279, GNorm = 0.7746, lr_0 = 3.3091e-04
Validation rmse = 0.141164
Validation r2 = 0.842503
Validation mse = 0.019927
Epoch 28
Loss = 8.1745e-02, PNorm = 35.1349, GNorm = 0.4744, lr_0 = 3.2165e-04
Validation rmse = 0.150108
Validation r2 = 0.821913
Validation mse = 0.022532
Epoch 29
Loss = 9.6686e-02, PNorm = 35.1464, GNorm = 0.9133, lr_0 = 3.1178e-04
Loss = 9.5753e-02, PNorm = 35.1561, GNorm = 0.6094, lr_0 = 3.0306e-04
Validation rmse = 0.142707
Validation r2 = 0.839042
Validation mse = 0.020365
Epoch 30
Loss = 9.1601e-02, PNorm = 35.1646, GNorm = 1.4855, lr_0 = 2.9459e-04
Validation rmse = 0.146971
Validation r2 = 0.829279
Validation mse = 0.021600
Epoch 31
Loss = 1.0063e-01, PNorm = 35.1733, GNorm = 2.3065, lr_0 = 2.8554e-04
Loss = 8.9587e-02, PNorm = 35.1817, GNorm = 2.3309, lr_0 = 2.7756e-04
Loss = 5.8757e-02, PNorm = 35.1827, GNorm = 1.1194, lr_0 = 2.7677e-04
Validation rmse = 0.143243
Validation r2 = 0.837828
Validation mse = 0.020519
Epoch 32
Loss = 9.8673e-02, PNorm = 35.1912, GNorm = 0.7874, lr_0 = 2.6903e-04
Validation rmse = 0.141872
Validation r2 = 0.840920
Validation mse = 0.020128
Epoch 33
Loss = 8.5064e-02, PNorm = 35.1992, GNorm = 1.5251, lr_0 = 2.6151e-04
Validation rmse = 0.144022
Validation r2 = 0.836061
Validation mse = 0.020742
Epoch 34
Loss = 7.8671e-02, PNorm = 35.2085, GNorm = 0.8756, lr_0 = 2.5348e-04
Loss = 9.5890e-02, PNorm = 35.2162, GNorm = 0.6525, lr_0 = 2.4639e-04
Validation rmse = 0.144021
Validation r2 = 0.836062
Validation mse = 0.020742
Epoch 35
Loss = 7.7473e-02, PNorm = 35.2226, GNorm = 0.6734, lr_0 = 2.3950e-04
Validation rmse = 0.142360
Validation r2 = 0.839823
Validation mse = 0.020266
Epoch 36
Loss = 6.4624e-02, PNorm = 35.2312, GNorm = 1.3641, lr_0 = 2.3215e-04
Loss = 8.9582e-02, PNorm = 35.2378, GNorm = 1.5761, lr_0 = 2.2566e-04
Validation rmse = 0.145946
Validation r2 = 0.831650
Validation mse = 0.021300
Epoch 37
Loss = 8.2553e-02, PNorm = 35.2441, GNorm = 1.5174, lr_0 = 2.1873e-04
Validation rmse = 0.143640
Validation r2 = 0.836930
Validation mse = 0.020632
Epoch 38
Loss = 6.9610e-02, PNorm = 35.2515, GNorm = 0.5185, lr_0 = 2.1261e-04
Loss = 9.0106e-02, PNorm = 35.2593, GNorm = 3.0977, lr_0 = 2.0667e-04
Validation rmse = 0.143331
Validation r2 = 0.837631
Validation mse = 0.020544
Epoch 39
Loss = 8.3901e-02, PNorm = 35.2659, GNorm = 3.0555, lr_0 = 2.0032e-04
Validation rmse = 0.145197
Validation r2 = 0.833374
Validation mse = 0.021082
Epoch 40
Loss = 9.1961e-02, PNorm = 35.2724, GNorm = 0.9134, lr_0 = 1.9472e-04
Loss = 8.3196e-02, PNorm = 35.2773, GNorm = 1.1555, lr_0 = 1.8928e-04
Loss = 5.2993e-02, PNorm = 35.2783, GNorm = 2.5588, lr_0 = 1.8874e-04
Validation rmse = 0.143248
Validation r2 = 0.837818
Validation mse = 0.020520
Epoch 41
Loss = 8.8107e-02, PNorm = 35.2856, GNorm = 1.0464, lr_0 = 1.8346e-04
Validation rmse = 0.144417
Validation r2 = 0.835160
Validation mse = 0.020856
Epoch 42
Loss = 8.2471e-02, PNorm = 35.2905, GNorm = 3.5434, lr_0 = 1.7783e-04
Validation rmse = 0.144196
Validation r2 = 0.835664
Validation mse = 0.020792
Epoch 43
Loss = 6.4297e-02, PNorm = 35.2967, GNorm = 2.1635, lr_0 = 1.7286e-04
Loss = 8.1965e-02, PNorm = 35.3013, GNorm = 1.0939, lr_0 = 1.6802e-04
Validation rmse = 0.145221
Validation r2 = 0.833318
Validation mse = 0.021089
Epoch 44
Loss = 8.3606e-02, PNorm = 35.3070, GNorm = 1.7660, lr_0 = 1.6286e-04
Validation rmse = 0.143660
Validation r2 = 0.836884
Validation mse = 0.020638
Epoch 45
Loss = 6.5202e-02, PNorm = 35.3125, GNorm = 0.9059, lr_0 = 1.5831e-04
Loss = 8.1747e-02, PNorm = 35.3176, GNorm = 0.4063, lr_0 = 1.5388e-04
Validation rmse = 0.145559
Validation r2 = 0.832543
Validation mse = 0.021187
Epoch 46
Loss = 7.5951e-02, PNorm = 35.3233, GNorm = 0.7691, lr_0 = 1.4916e-04
Validation rmse = 0.145744
Validation r2 = 0.832117
Validation mse = 0.021241
Epoch 47
Loss = 9.4999e-02, PNorm = 35.3280, GNorm = 2.6765, lr_0 = 1.4458e-04
Loss = 7.4290e-02, PNorm = 35.3320, GNorm = 0.5908, lr_0 = 1.4053e-04
Validation rmse = 0.144210
Validation r2 = 0.835632
Validation mse = 0.020797
Epoch 48
Loss = 8.2584e-02, PNorm = 35.3365, GNorm = 1.5686, lr_0 = 1.3661e-04
Validation rmse = 0.144421
Validation r2 = 0.835151
Validation mse = 0.020857
Epoch 49
Loss = 7.9828e-02, PNorm = 35.3408, GNorm = 1.8389, lr_0 = 1.3241e-04
Loss = 7.5436e-02, PNorm = 35.3457, GNorm = 1.4485, lr_0 = 1.2871e-04
Validation rmse = 0.144311
Validation r2 = 0.835403
Validation mse = 0.020826
Epoch 50
Loss = 7.7414e-02, PNorm = 35.3499, GNorm = 1.4210, lr_0 = 1.2511e-04
Validation rmse = 0.144915
Validation r2 = 0.834021
Validation mse = 0.021000
Epoch 51
Loss = 7.2204e-02, PNorm = 35.3545, GNorm = 1.5054, lr_0 = 1.2127e-04
Validation rmse = 0.144039
Validation r2 = 0.836022
Validation mse = 0.020747
Epoch 52
Loss = 7.0825e-02, PNorm = 35.3589, GNorm = 2.3293, lr_0 = 1.1754e-04
Loss = 7.6654e-02, PNorm = 35.3626, GNorm = 0.5086, lr_0 = 1.1426e-04
Validation rmse = 0.145143
Validation r2 = 0.833497
Validation mse = 0.021067
Epoch 53
Loss = 8.5178e-02, PNorm = 35.3657, GNorm = 2.3450, lr_0 = 1.1106e-04
Validation rmse = 0.145093
Validation r2 = 0.833612
Validation mse = 0.021052
Epoch 54
Loss = 7.0759e-02, PNorm = 35.3703, GNorm = 0.7034, lr_0 = 1.0765e-04
Loss = 7.6855e-02, PNorm = 35.3738, GNorm = 1.4241, lr_0 = 1.0464e-04
Validation rmse = 0.144217
Validation r2 = 0.835616
Validation mse = 0.020799
Epoch 55
Loss = 6.6032e-02, PNorm = 35.3760, GNorm = 1.7148, lr_0 = 1.0172e-04
Validation rmse = 0.143505
Validation r2 = 0.837235
Validation mse = 0.020594
Epoch 56
Loss = 7.4497e-02, PNorm = 35.3796, GNorm = 1.1056, lr_0 = 1.0000e-04
Loss = 7.8701e-02, PNorm = 35.3824, GNorm = 0.6607, lr_0 = 1.0000e-04
Loss = 4.6389e-02, PNorm = 35.3828, GNorm = 1.1514, lr_0 = 1.0000e-04
Validation rmse = 0.144348
Validation r2 = 0.835318
Validation mse = 0.020836
Epoch 57
Loss = 7.9404e-02, PNorm = 35.3865, GNorm = 1.0104, lr_0 = 1.0000e-04
Validation rmse = 0.144555
Validation r2 = 0.834845
Validation mse = 0.020896
Epoch 58
Loss = 7.6533e-02, PNorm = 35.3892, GNorm = 0.7695, lr_0 = 1.0000e-04
Validation rmse = 0.143140
Validation r2 = 0.838062
Validation mse = 0.020489
Epoch 59
Loss = 7.8453e-02, PNorm = 35.3929, GNorm = 1.5211, lr_0 = 1.0000e-04
Loss = 7.1841e-02, PNorm = 35.3955, GNorm = 1.8125, lr_0 = 1.0000e-04
Validation rmse = 0.144530
Validation r2 = 0.834901
Validation mse = 0.020889
Model 0 best validation rmse = 0.141164 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.211849
Model 0 test r2 = -0.009487
Model 0 test mse = 0.044880
Ensemble test rmse = 0.211849
Ensemble test r2 = -0.009487
Ensemble test mse = 0.044880
Fold 7
Splitting data with seed 7
Total size = 901 | train size = 720 | val size = 181 | test size = 121
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.8630e-01, PNorm = 34.0179, GNorm = 1.3332, lr_0 = 4.5357e-04
Validation rmse = 0.297829
Validation r2 = 0.265970
Validation mse = 0.088702
Epoch 1
Loss = 6.0778e-01, PNorm = 34.0551, GNorm = 6.4942, lr_0 = 8.0714e-04
Validation rmse = 0.315400
Validation r2 = 0.176801
Validation mse = 0.099477
Epoch 2
Loss = 8.5625e-01, PNorm = 34.1127, GNorm = 5.7411, lr_0 = 9.8592e-04
Loss = 5.9434e-01, PNorm = 34.1825, GNorm = 3.0292, lr_0 = 9.5836e-04
Validation rmse = 0.229307
Validation r2 = 0.564873
Validation mse = 0.052582
Epoch 3
Loss = 4.0156e-01, PNorm = 34.2595, GNorm = 0.8703, lr_0 = 9.3156e-04
Validation rmse = 0.225882
Validation r2 = 0.577774
Validation mse = 0.051023
Epoch 4
Loss = 4.6962e-01, PNorm = 34.3364, GNorm = 4.7884, lr_0 = 9.0295e-04
Loss = 3.2007e-01, PNorm = 34.3990, GNorm = 2.8689, lr_0 = 8.7771e-04
Validation rmse = 0.189910
Validation r2 = 0.701547
Validation mse = 0.036066
Epoch 5
Loss = 2.5817e-01, PNorm = 34.4578, GNorm = 1.8506, lr_0 = 8.5317e-04
Validation rmse = 0.174561
Validation r2 = 0.747840
Validation mse = 0.030472
Epoch 6
Loss = 2.2208e-01, PNorm = 34.5081, GNorm = 2.5445, lr_0 = 8.2697e-04
Loss = 2.1516e-01, PNorm = 34.5651, GNorm = 3.9545, lr_0 = 8.0385e-04
Loss = 1.7751e-01, PNorm = 34.5694, GNorm = 1.2086, lr_0 = 8.0157e-04
Validation rmse = 0.154142
Validation r2 = 0.803382
Validation mse = 0.023760
Epoch 7
Loss = 1.8403e-01, PNorm = 34.6112, GNorm = 0.8349, lr_0 = 7.7916e-04
Validation rmse = 0.147728
Validation r2 = 0.819406
Validation mse = 0.021823
Epoch 8
Loss = 1.6333e-01, PNorm = 34.6544, GNorm = 3.5400, lr_0 = 7.5737e-04
Validation rmse = 0.150394
Validation r2 = 0.812827
Validation mse = 0.022618
Epoch 9
Loss = 2.3672e-01, PNorm = 34.6883, GNorm = 4.7337, lr_0 = 7.3411e-04
Loss = 1.7826e-01, PNorm = 34.7238, GNorm = 3.3472, lr_0 = 7.1359e-04
Validation rmse = 0.143095
Validation r2 = 0.830554
Validation mse = 0.020476
Epoch 10
Loss = 1.5443e-01, PNorm = 34.7493, GNorm = 4.1978, lr_0 = 6.9364e-04
Validation rmse = 0.193589
Validation r2 = 0.689870
Validation mse = 0.037477
Epoch 11
Loss = 2.6262e-01, PNorm = 34.7791, GNorm = 3.8572, lr_0 = 6.7234e-04
Loss = 1.8880e-01, PNorm = 34.8049, GNorm = 4.5712, lr_0 = 6.5354e-04
Validation rmse = 0.149446
Validation r2 = 0.815180
Validation mse = 0.022334
Epoch 12
Loss = 1.7062e-01, PNorm = 34.8310, GNorm = 3.7627, lr_0 = 6.3347e-04
Validation rmse = 0.149696
Validation r2 = 0.814560
Validation mse = 0.022409
Epoch 13
Loss = 1.8039e-01, PNorm = 34.8499, GNorm = 2.0178, lr_0 = 6.1576e-04
Loss = 1.2446e-01, PNorm = 34.8714, GNorm = 1.7041, lr_0 = 5.9854e-04
Validation rmse = 0.141047
Validation r2 = 0.835371
Validation mse = 0.019894
Epoch 14
Loss = 1.2574e-01, PNorm = 34.8928, GNorm = 0.5130, lr_0 = 5.8016e-04
Validation rmse = 0.139860
Validation r2 = 0.838129
Validation mse = 0.019561
Epoch 15
Loss = 1.0465e-01, PNorm = 34.9084, GNorm = 1.1908, lr_0 = 5.6394e-04
Loss = 1.2552e-01, PNorm = 34.9236, GNorm = 1.3665, lr_0 = 5.4817e-04
Loss = 1.1648e-01, PNorm = 34.9253, GNorm = 2.6502, lr_0 = 5.4662e-04
Validation rmse = 0.139264
Validation r2 = 0.839505
Validation mse = 0.019395
Epoch 16
Loss = 1.1407e-01, PNorm = 34.9439, GNorm = 0.8585, lr_0 = 5.3134e-04
Validation rmse = 0.135487
Validation r2 = 0.848093
Validation mse = 0.018357
Epoch 17
Loss = 1.0705e-01, PNorm = 34.9597, GNorm = 1.8799, lr_0 = 5.1502e-04
Validation rmse = 0.135711
Validation r2 = 0.847591
Validation mse = 0.018418
Epoch 18
Loss = 9.2413e-02, PNorm = 34.9715, GNorm = 0.7543, lr_0 = 5.0062e-04
Loss = 1.1062e-01, PNorm = 34.9811, GNorm = 0.9930, lr_0 = 4.8662e-04
Validation rmse = 0.134769
Validation r2 = 0.849699
Validation mse = 0.018163
Epoch 19
Loss = 9.8442e-02, PNorm = 34.9975, GNorm = 1.4334, lr_0 = 4.7168e-04
Validation rmse = 0.143096
Validation r2 = 0.830553
Validation mse = 0.020476
Epoch 20
Loss = 1.4058e-01, PNorm = 35.0111, GNorm = 4.4564, lr_0 = 4.5849e-04
Loss = 1.1195e-01, PNorm = 35.0248, GNorm = 1.5814, lr_0 = 4.4567e-04
Validation rmse = 0.138953
Validation r2 = 0.840221
Validation mse = 0.019308
Epoch 21
Loss = 1.0028e-01, PNorm = 35.0373, GNorm = 2.4212, lr_0 = 4.3198e-04
Validation rmse = 0.136064
Validation r2 = 0.846796
Validation mse = 0.018514
Epoch 22
Loss = 9.8856e-02, PNorm = 35.0525, GNorm = 1.1366, lr_0 = 4.1872e-04
Loss = 1.0876e-01, PNorm = 35.0642, GNorm = 0.6953, lr_0 = 4.0701e-04
Validation rmse = 0.139794
Validation r2 = 0.838281
Validation mse = 0.019542
Epoch 23
Loss = 1.0924e-01, PNorm = 35.0757, GNorm = 1.2908, lr_0 = 3.9563e-04
Validation rmse = 0.143030
Validation r2 = 0.830708
Validation mse = 0.020458
Epoch 24
Loss = 1.0044e-01, PNorm = 35.0878, GNorm = 2.5920, lr_0 = 3.8348e-04
Loss = 1.0642e-01, PNorm = 35.0969, GNorm = 1.2134, lr_0 = 3.7276e-04
Validation rmse = 0.163063
Validation r2 = 0.779965
Validation mse = 0.026590
Epoch 25
Loss = 1.0949e-01, PNorm = 35.1091, GNorm = 3.3243, lr_0 = 3.6234e-04
Validation rmse = 0.135605
Validation r2 = 0.847828
Validation mse = 0.018389
Epoch 26
Loss = 1.0069e-01, PNorm = 35.1215, GNorm = 0.8807, lr_0 = 3.5121e-04
Validation rmse = 0.133980
Validation r2 = 0.851455
Validation mse = 0.017951
Epoch 27
Loss = 7.7577e-02, PNorm = 35.1340, GNorm = 2.6996, lr_0 = 3.4042e-04
Loss = 1.0171e-01, PNorm = 35.1429, GNorm = 1.4654, lr_0 = 3.3091e-04
Validation rmse = 0.135312
Validation r2 = 0.848487
Validation mse = 0.018309
Epoch 28
Loss = 9.0607e-02, PNorm = 35.1516, GNorm = 0.6714, lr_0 = 3.2165e-04
Validation rmse = 0.134606
Validation r2 = 0.850063
Validation mse = 0.018119
Epoch 29
Loss = 7.2834e-02, PNorm = 35.1627, GNorm = 0.4823, lr_0 = 3.1178e-04
Loss = 9.1818e-02, PNorm = 35.1744, GNorm = 1.6867, lr_0 = 3.0306e-04
Validation rmse = 0.134656
Validation r2 = 0.849951
Validation mse = 0.018132
Epoch 30
Loss = 8.0622e-02, PNorm = 35.1807, GNorm = 0.6429, lr_0 = 2.9459e-04
Validation rmse = 0.133353
Validation r2 = 0.852842
Validation mse = 0.017783
Epoch 31
Loss = 7.3121e-02, PNorm = 35.1901, GNorm = 1.4501, lr_0 = 2.8554e-04
Loss = 1.0179e-01, PNorm = 35.2000, GNorm = 2.5589, lr_0 = 2.7756e-04
Loss = 8.2867e-02, PNorm = 35.2013, GNorm = 3.3373, lr_0 = 2.7677e-04
Validation rmse = 0.137073
Validation r2 = 0.844517
Validation mse = 0.018789
Epoch 32
Loss = 1.0273e-01, PNorm = 35.2100, GNorm = 1.1157, lr_0 = 2.6903e-04
Validation rmse = 0.136553
Validation r2 = 0.845693
Validation mse = 0.018647
Epoch 33
Loss = 8.7086e-02, PNorm = 35.2191, GNorm = 0.7603, lr_0 = 2.6151e-04
Validation rmse = 0.139860
Validation r2 = 0.838129
Validation mse = 0.019561
Epoch 34
Loss = 7.0157e-02, PNorm = 35.2276, GNorm = 3.0696, lr_0 = 2.5348e-04
Loss = 8.8240e-02, PNorm = 35.2382, GNorm = 1.1101, lr_0 = 2.4639e-04
Validation rmse = 0.135884
Validation r2 = 0.847203
Validation mse = 0.018464
Epoch 35
Loss = 7.6928e-02, PNorm = 35.2458, GNorm = 1.4849, lr_0 = 2.3950e-04
Validation rmse = 0.133878
Validation r2 = 0.851680
Validation mse = 0.017923
Epoch 36
Loss = 6.0184e-02, PNorm = 35.2531, GNorm = 0.6727, lr_0 = 2.3215e-04
Loss = 8.1698e-02, PNorm = 35.2607, GNorm = 1.0455, lr_0 = 2.2566e-04
Validation rmse = 0.135775
Validation r2 = 0.847447
Validation mse = 0.018435
Epoch 37
Loss = 7.9169e-02, PNorm = 35.2677, GNorm = 0.7871, lr_0 = 2.1873e-04
Validation rmse = 0.135404
Validation r2 = 0.848281
Validation mse = 0.018334
Epoch 38
Loss = 7.3919e-02, PNorm = 35.2740, GNorm = 0.7169, lr_0 = 2.1261e-04
Loss = 8.3819e-02, PNorm = 35.2798, GNorm = 1.3378, lr_0 = 2.0667e-04
Validation rmse = 0.134437
Validation r2 = 0.850439
Validation mse = 0.018073
Epoch 39
Loss = 7.6055e-02, PNorm = 35.2864, GNorm = 1.9519, lr_0 = 2.0032e-04
Validation rmse = 0.134862
Validation r2 = 0.849493
Validation mse = 0.018188
Epoch 40
Loss = 6.9858e-02, PNorm = 35.2920, GNorm = 0.5260, lr_0 = 1.9472e-04
Loss = 8.4174e-02, PNorm = 35.2979, GNorm = 0.5682, lr_0 = 1.8928e-04
Loss = 5.5096e-02, PNorm = 35.2985, GNorm = 1.1027, lr_0 = 1.8874e-04
Validation rmse = 0.145897
Validation r2 = 0.823854
Validation mse = 0.021286
Epoch 41
Loss = 8.4965e-02, PNorm = 35.3046, GNorm = 0.6839, lr_0 = 1.8346e-04
Validation rmse = 0.133939
Validation r2 = 0.851545
Validation mse = 0.017940
Epoch 42
Loss = 8.1337e-02, PNorm = 35.3100, GNorm = 0.4371, lr_0 = 1.7783e-04
Validation rmse = 0.135521
Validation r2 = 0.848018
Validation mse = 0.018366
Epoch 43
Loss = 5.0891e-02, PNorm = 35.3150, GNorm = 0.8994, lr_0 = 1.7286e-04
Loss = 8.2117e-02, PNorm = 35.3204, GNorm = 1.4969, lr_0 = 1.6802e-04
Validation rmse = 0.134591
Validation r2 = 0.850096
Validation mse = 0.018115
Epoch 44
Loss = 8.4213e-02, PNorm = 35.3261, GNorm = 1.5221, lr_0 = 1.6286e-04
Validation rmse = 0.133923
Validation r2 = 0.851580
Validation mse = 0.017935
Epoch 45
Loss = 7.4719e-02, PNorm = 35.3310, GNorm = 1.6670, lr_0 = 1.5831e-04
Loss = 8.3078e-02, PNorm = 35.3364, GNorm = 0.6440, lr_0 = 1.5388e-04
Validation rmse = 0.134190
Validation r2 = 0.850987
Validation mse = 0.018007
Epoch 46
Loss = 7.9295e-02, PNorm = 35.3421, GNorm = 2.4843, lr_0 = 1.4916e-04
Validation rmse = 0.135425
Validation r2 = 0.848233
Validation mse = 0.018340
Epoch 47
Loss = 8.5633e-02, PNorm = 35.3459, GNorm = 1.7300, lr_0 = 1.4458e-04
Loss = 7.5522e-02, PNorm = 35.3501, GNorm = 1.1818, lr_0 = 1.4053e-04
Validation rmse = 0.134391
Validation r2 = 0.850542
Validation mse = 0.018061
Epoch 48
Loss = 8.0312e-02, PNorm = 35.3545, GNorm = 0.4477, lr_0 = 1.3661e-04
Validation rmse = 0.134552
Validation r2 = 0.850183
Validation mse = 0.018104
Epoch 49
Loss = 7.0314e-02, PNorm = 35.3595, GNorm = 1.6314, lr_0 = 1.3241e-04
Loss = 7.8694e-02, PNorm = 35.3633, GNorm = 1.1690, lr_0 = 1.2871e-04
Validation rmse = 0.133893
Validation r2 = 0.851647
Validation mse = 0.017927
Epoch 50
Loss = 7.9446e-02, PNorm = 35.3672, GNorm = 2.2573, lr_0 = 1.2511e-04
Validation rmse = 0.137468
Validation r2 = 0.843618
Validation mse = 0.018898
Epoch 51
Loss = 7.3601e-02, PNorm = 35.3722, GNorm = 0.7473, lr_0 = 1.2127e-04
Validation rmse = 0.134404
Validation r2 = 0.850512
Validation mse = 0.018064
Epoch 52
Loss = 7.1172e-02, PNorm = 35.3767, GNorm = 2.4588, lr_0 = 1.1754e-04
Loss = 8.0129e-02, PNorm = 35.3802, GNorm = 0.7977, lr_0 = 1.1426e-04
Validation rmse = 0.134244
Validation r2 = 0.850869
Validation mse = 0.018021
Epoch 53
Loss = 7.5165e-02, PNorm = 35.3839, GNorm = 0.7505, lr_0 = 1.1106e-04
Validation rmse = 0.135734
Validation r2 = 0.847540
Validation mse = 0.018424
Epoch 54
Loss = 8.1664e-02, PNorm = 35.3878, GNorm = 0.9058, lr_0 = 1.0765e-04
Loss = 6.9879e-02, PNorm = 35.3908, GNorm = 0.6768, lr_0 = 1.0464e-04
Validation rmse = 0.134048
Validation r2 = 0.851304
Validation mse = 0.017969
Epoch 55
Loss = 6.5195e-02, PNorm = 35.3936, GNorm = 0.6888, lr_0 = 1.0172e-04
Validation rmse = 0.133720
Validation r2 = 0.852031
Validation mse = 0.017881
Epoch 56
Loss = 5.8155e-02, PNorm = 35.3971, GNorm = 1.1397, lr_0 = 1.0000e-04
Loss = 7.7231e-02, PNorm = 35.4000, GNorm = 0.9305, lr_0 = 1.0000e-04
Loss = 9.1485e-02, PNorm = 35.4002, GNorm = 1.7352, lr_0 = 1.0000e-04
Validation rmse = 0.136823
Validation r2 = 0.845083
Validation mse = 0.018721
Epoch 57
Loss = 7.4487e-02, PNorm = 35.4034, GNorm = 1.8676, lr_0 = 1.0000e-04
Validation rmse = 0.137565
Validation r2 = 0.843398
Validation mse = 0.018924
Epoch 58
Loss = 7.5460e-02, PNorm = 35.4068, GNorm = 0.7931, lr_0 = 1.0000e-04
Validation rmse = 0.135215
Validation r2 = 0.848702
Validation mse = 0.018283
Epoch 59
Loss = 8.0530e-02, PNorm = 35.4096, GNorm = 2.7150, lr_0 = 1.0000e-04
Loss = 6.9253e-02, PNorm = 35.4127, GNorm = 1.4271, lr_0 = 1.0000e-04
Validation rmse = 0.137656
Validation r2 = 0.843192
Validation mse = 0.018949
Model 0 best validation rmse = 0.133353 on epoch 30
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.233136
Model 0 test r2 = -0.222547
Model 0 test mse = 0.054352
Ensemble test rmse = 0.233136
Ensemble test r2 = -0.222547
Ensemble test mse = 0.054352
Fold 8
Splitting data with seed 8
Total size = 901 | train size = 720 | val size = 181 | test size = 121
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.9424e-01, PNorm = 34.0153, GNorm = 3.5581, lr_0 = 4.5357e-04
Validation rmse = 0.300789
Validation r2 = 0.264038
Validation mse = 0.090474
Epoch 1
Loss = 6.9438e-01, PNorm = 34.0556, GNorm = 3.3572, lr_0 = 8.0714e-04
Validation rmse = 0.261331
Validation r2 = 0.444462
Validation mse = 0.068294
Epoch 2
Loss = 4.6600e-01, PNorm = 34.1195, GNorm = 1.4756, lr_0 = 9.8592e-04
Loss = 4.5611e-01, PNorm = 34.1916, GNorm = 7.1031, lr_0 = 9.5836e-04
Validation rmse = 0.261538
Validation r2 = 0.443582
Validation mse = 0.068402
Epoch 3
Loss = 3.5242e-01, PNorm = 34.2553, GNorm = 1.3209, lr_0 = 9.3156e-04
Validation rmse = 0.224145
Validation r2 = 0.591313
Validation mse = 0.050241
Epoch 4
Loss = 4.6124e-01, PNorm = 34.3277, GNorm = 10.4187, lr_0 = 9.0295e-04
Loss = 4.1034e-01, PNorm = 34.3839, GNorm = 6.3116, lr_0 = 8.7771e-04
Validation rmse = 0.241856
Validation r2 = 0.524178
Validation mse = 0.058494
Epoch 5
Loss = 3.8317e-01, PNorm = 34.4365, GNorm = 5.0957, lr_0 = 8.5317e-04
Validation rmse = 0.191884
Validation r2 = 0.700493
Validation mse = 0.036819
Epoch 6
Loss = 3.2184e-01, PNorm = 34.4927, GNorm = 3.6128, lr_0 = 8.2697e-04
Loss = 2.4542e-01, PNorm = 34.5319, GNorm = 4.0672, lr_0 = 8.0385e-04
Loss = 3.1193e-01, PNorm = 34.5368, GNorm = 6.1988, lr_0 = 8.0157e-04
Validation rmse = 0.175336
Validation r2 = 0.749923
Validation mse = 0.030743
Epoch 7
Loss = 1.9660e-01, PNorm = 34.5791, GNorm = 2.8986, lr_0 = 7.7916e-04
Validation rmse = 0.201259
Validation r2 = 0.670511
Validation mse = 0.040505
Epoch 8
Loss = 1.7861e-01, PNorm = 34.6134, GNorm = 3.1046, lr_0 = 7.5737e-04
Validation rmse = 0.174486
Validation r2 = 0.752341
Validation mse = 0.030445
Epoch 9
Loss = 1.8784e-01, PNorm = 34.6465, GNorm = 1.4288, lr_0 = 7.3411e-04
Loss = 1.9238e-01, PNorm = 34.6795, GNorm = 1.3390, lr_0 = 7.1359e-04
Validation rmse = 0.170664
Validation r2 = 0.763073
Validation mse = 0.029126
Epoch 10
Loss = 1.4863e-01, PNorm = 34.7117, GNorm = 2.1380, lr_0 = 6.9364e-04
Validation rmse = 0.170797
Validation r2 = 0.762703
Validation mse = 0.029172
Epoch 11
Loss = 1.7921e-01, PNorm = 34.7393, GNorm = 2.1413, lr_0 = 6.7234e-04
Loss = 1.4519e-01, PNorm = 34.7675, GNorm = 2.1114, lr_0 = 6.5354e-04
Validation rmse = 0.154525
Validation r2 = 0.805763
Validation mse = 0.023878
Epoch 12
Loss = 1.2066e-01, PNorm = 34.7908, GNorm = 1.3763, lr_0 = 6.3347e-04
Validation rmse = 0.182169
Validation r2 = 0.730052
Validation mse = 0.033185
Epoch 13
Loss = 1.5473e-01, PNorm = 34.8084, GNorm = 0.8255, lr_0 = 6.1576e-04
Loss = 1.3678e-01, PNorm = 34.8326, GNorm = 1.5580, lr_0 = 5.9854e-04
Validation rmse = 0.158330
Validation r2 = 0.796080
Validation mse = 0.025068
Epoch 14
Loss = 1.2502e-01, PNorm = 34.8513, GNorm = 1.1120, lr_0 = 5.8016e-04
Validation rmse = 0.153579
Validation r2 = 0.808136
Validation mse = 0.023586
Epoch 15
Loss = 1.3715e-01, PNorm = 34.8682, GNorm = 3.5031, lr_0 = 5.6394e-04
Loss = 1.7951e-01, PNorm = 34.8875, GNorm = 5.9305, lr_0 = 5.4817e-04
Loss = 1.5812e-01, PNorm = 34.8903, GNorm = 6.1141, lr_0 = 5.4662e-04
Validation rmse = 0.159347
Validation r2 = 0.793452
Validation mse = 0.025392
Epoch 16
Loss = 1.4554e-01, PNorm = 34.9081, GNorm = 0.8582, lr_0 = 5.3134e-04
Validation rmse = 0.157439
Validation r2 = 0.798368
Validation mse = 0.024787
Epoch 17
Loss = 1.2757e-01, PNorm = 34.9276, GNorm = 2.9717, lr_0 = 5.1502e-04
Validation rmse = 0.161875
Validation r2 = 0.786846
Validation mse = 0.026204
Epoch 18
Loss = 1.0110e-01, PNorm = 34.9440, GNorm = 3.0908, lr_0 = 5.0062e-04
Loss = 1.2580e-01, PNorm = 34.9592, GNorm = 3.2720, lr_0 = 4.8662e-04
Validation rmse = 0.153565
Validation r2 = 0.808169
Validation mse = 0.023582
Epoch 19
Loss = 1.1301e-01, PNorm = 34.9725, GNorm = 1.1236, lr_0 = 4.7168e-04
Validation rmse = 0.150558
Validation r2 = 0.815608
Validation mse = 0.022668
Epoch 20
Loss = 1.1323e-01, PNorm = 34.9851, GNorm = 1.9850, lr_0 = 4.5849e-04
Loss = 1.1916e-01, PNorm = 35.0000, GNorm = 0.8546, lr_0 = 4.4567e-04
Validation rmse = 0.166986
Validation r2 = 0.773173
Validation mse = 0.027884
Epoch 21
Loss = 1.0899e-01, PNorm = 35.0103, GNorm = 0.9225, lr_0 = 4.3198e-04
Validation rmse = 0.150758
Validation r2 = 0.815119
Validation mse = 0.022728
Epoch 22
Loss = 1.0637e-01, PNorm = 35.0227, GNorm = 1.1545, lr_0 = 4.1872e-04
Loss = 1.0912e-01, PNorm = 35.0335, GNorm = 1.2785, lr_0 = 4.0701e-04
Validation rmse = 0.150487
Validation r2 = 0.815784
Validation mse = 0.022646
Epoch 23
Loss = 1.0695e-01, PNorm = 35.0466, GNorm = 1.9265, lr_0 = 3.9563e-04
Validation rmse = 0.149793
Validation r2 = 0.817477
Validation mse = 0.022438
Epoch 24
Loss = 9.1938e-02, PNorm = 35.0590, GNorm = 1.5476, lr_0 = 3.8348e-04
Loss = 1.0477e-01, PNorm = 35.0701, GNorm = 0.7967, lr_0 = 3.7276e-04
Validation rmse = 0.151590
Validation r2 = 0.813074
Validation mse = 0.022979
Epoch 25
Loss = 1.0282e-01, PNorm = 35.0802, GNorm = 0.6870, lr_0 = 3.6234e-04
Validation rmse = 0.150085
Validation r2 = 0.816765
Validation mse = 0.022526
Epoch 26
Loss = 9.4324e-02, PNorm = 35.0930, GNorm = 1.7456, lr_0 = 3.5121e-04
Validation rmse = 0.147843
Validation r2 = 0.822198
Validation mse = 0.021858
Epoch 27
Loss = 1.1598e-01, PNorm = 35.1035, GNorm = 3.2274, lr_0 = 3.4042e-04
Loss = 1.1135e-01, PNorm = 35.1139, GNorm = 2.3615, lr_0 = 3.3091e-04
Validation rmse = 0.151443
Validation r2 = 0.813435
Validation mse = 0.022935
Epoch 28
Loss = 9.0876e-02, PNorm = 35.1239, GNorm = 1.3379, lr_0 = 3.2165e-04
Validation rmse = 0.147754
Validation r2 = 0.822414
Validation mse = 0.021831
Epoch 29
Loss = 1.0078e-01, PNorm = 35.1366, GNorm = 1.1023, lr_0 = 3.1178e-04
Loss = 8.8771e-02, PNorm = 35.1475, GNorm = 0.7971, lr_0 = 3.0306e-04
Validation rmse = 0.147651
Validation r2 = 0.822662
Validation mse = 0.021801
Epoch 30
Loss = 9.7163e-02, PNorm = 35.1551, GNorm = 1.3517, lr_0 = 2.9459e-04
Validation rmse = 0.150538
Validation r2 = 0.815658
Validation mse = 0.022662
Epoch 31
Loss = 1.0336e-01, PNorm = 35.1651, GNorm = 1.5924, lr_0 = 2.8554e-04
Loss = 8.7895e-02, PNorm = 35.1738, GNorm = 1.4251, lr_0 = 2.7756e-04
Loss = 9.8160e-02, PNorm = 35.1748, GNorm = 1.1116, lr_0 = 2.7677e-04
Validation rmse = 0.149827
Validation r2 = 0.817394
Validation mse = 0.022448
Epoch 32
Loss = 9.0466e-02, PNorm = 35.1825, GNorm = 1.2458, lr_0 = 2.6903e-04
Validation rmse = 0.148378
Validation r2 = 0.820911
Validation mse = 0.022016
Epoch 33
Loss = 7.2682e-02, PNorm = 35.1918, GNorm = 0.5046, lr_0 = 2.6151e-04
Validation rmse = 0.146359
Validation r2 = 0.825750
Validation mse = 0.021421
Epoch 34
Loss = 8.1918e-02, PNorm = 35.2030, GNorm = 1.4614, lr_0 = 2.5348e-04
Loss = 9.4275e-02, PNorm = 35.2139, GNorm = 0.7918, lr_0 = 2.4639e-04
Validation rmse = 0.152595
Validation r2 = 0.810587
Validation mse = 0.023285
Epoch 35
Loss = 9.0659e-02, PNorm = 35.2210, GNorm = 0.7697, lr_0 = 2.3950e-04
Validation rmse = 0.149177
Validation r2 = 0.818975
Validation mse = 0.022254
Epoch 36
Loss = 1.1817e-01, PNorm = 35.2285, GNorm = 2.4494, lr_0 = 2.3215e-04
Loss = 8.7805e-02, PNorm = 35.2356, GNorm = 1.3993, lr_0 = 2.2566e-04
Validation rmse = 0.148987
Validation r2 = 0.819436
Validation mse = 0.022197
Epoch 37
Loss = 8.5596e-02, PNorm = 35.2439, GNorm = 1.1219, lr_0 = 2.1873e-04
Validation rmse = 0.145743
Validation r2 = 0.827214
Validation mse = 0.021241
Epoch 38
Loss = 7.8605e-02, PNorm = 35.2514, GNorm = 1.2675, lr_0 = 2.1261e-04
Loss = 8.9438e-02, PNorm = 35.2594, GNorm = 0.8923, lr_0 = 2.0667e-04
Validation rmse = 0.147081
Validation r2 = 0.824028
Validation mse = 0.021633
Epoch 39
Loss = 7.9241e-02, PNorm = 35.2667, GNorm = 0.7698, lr_0 = 2.0032e-04
Validation rmse = 0.146484
Validation r2 = 0.825453
Validation mse = 0.021458
Epoch 40
Loss = 7.4443e-02, PNorm = 35.2738, GNorm = 1.6602, lr_0 = 1.9472e-04
Loss = 8.6496e-02, PNorm = 35.2800, GNorm = 1.3509, lr_0 = 1.8928e-04
Loss = 9.8700e-02, PNorm = 35.2806, GNorm = 2.4964, lr_0 = 1.8874e-04
Validation rmse = 0.147673
Validation r2 = 0.822608
Validation mse = 0.021807
Epoch 41
Loss = 7.9399e-02, PNorm = 35.2854, GNorm = 0.4554, lr_0 = 1.8346e-04
Validation rmse = 0.145816
Validation r2 = 0.827042
Validation mse = 0.021262
Epoch 42
Loss = 8.4096e-02, PNorm = 35.2914, GNorm = 1.1443, lr_0 = 1.7783e-04
Validation rmse = 0.149330
Validation r2 = 0.818606
Validation mse = 0.022299
Epoch 43
Loss = 9.6014e-02, PNorm = 35.2971, GNorm = 1.8725, lr_0 = 1.7286e-04
Loss = 8.2734e-02, PNorm = 35.3045, GNorm = 0.5048, lr_0 = 1.6802e-04
Validation rmse = 0.145351
Validation r2 = 0.828143
Validation mse = 0.021127
Epoch 44
Loss = 8.2031e-02, PNorm = 35.3110, GNorm = 1.2595, lr_0 = 1.6286e-04
Validation rmse = 0.146749
Validation r2 = 0.824821
Validation mse = 0.021535
Epoch 45
Loss = 9.5510e-02, PNorm = 35.3168, GNorm = 0.6572, lr_0 = 1.5831e-04
Loss = 7.5790e-02, PNorm = 35.3225, GNorm = 1.2733, lr_0 = 1.5388e-04
Validation rmse = 0.145106
Validation r2 = 0.828722
Validation mse = 0.021056
Epoch 46
Loss = 7.4066e-02, PNorm = 35.3283, GNorm = 2.3220, lr_0 = 1.4916e-04
Validation rmse = 0.146018
Validation r2 = 0.826561
Validation mse = 0.021321
Epoch 47
Loss = 7.2585e-02, PNorm = 35.3337, GNorm = 0.8385, lr_0 = 1.4458e-04
Loss = 8.2155e-02, PNorm = 35.3384, GNorm = 0.7647, lr_0 = 1.4053e-04
Validation rmse = 0.146886
Validation r2 = 0.824495
Validation mse = 0.021575
Epoch 48
Loss = 8.8255e-02, PNorm = 35.3441, GNorm = 3.6592, lr_0 = 1.3661e-04
Validation rmse = 0.144062
Validation r2 = 0.831176
Validation mse = 0.020754
Epoch 49
Loss = 8.2930e-02, PNorm = 35.3483, GNorm = 0.9075, lr_0 = 1.3241e-04
Loss = 8.0064e-02, PNorm = 35.3532, GNorm = 0.6422, lr_0 = 1.2871e-04
Validation rmse = 0.146104
Validation r2 = 0.826357
Validation mse = 0.021346
Epoch 50
Loss = 7.8804e-02, PNorm = 35.3573, GNorm = 0.5768, lr_0 = 1.2511e-04
Validation rmse = 0.145982
Validation r2 = 0.826647
Validation mse = 0.021311
Epoch 51
Loss = 7.6574e-02, PNorm = 35.3615, GNorm = 0.9669, lr_0 = 1.2127e-04
Validation rmse = 0.145459
Validation r2 = 0.827887
Validation mse = 0.021158
Epoch 52
Loss = 1.1428e-01, PNorm = 35.3660, GNorm = 1.8882, lr_0 = 1.1754e-04
Loss = 7.3272e-02, PNorm = 35.3710, GNorm = 1.5055, lr_0 = 1.1426e-04
Validation rmse = 0.143527
Validation r2 = 0.832429
Validation mse = 0.020600
Epoch 53
Loss = 7.7487e-02, PNorm = 35.3747, GNorm = 1.7706, lr_0 = 1.1106e-04
Validation rmse = 0.145588
Validation r2 = 0.827581
Validation mse = 0.021196
Epoch 54
Loss = 8.8642e-02, PNorm = 35.3783, GNorm = 0.8995, lr_0 = 1.0765e-04
Loss = 8.1827e-02, PNorm = 35.3828, GNorm = 1.0851, lr_0 = 1.0464e-04
Validation rmse = 0.143770
Validation r2 = 0.831862
Validation mse = 0.020670
Epoch 55
Loss = 7.2684e-02, PNorm = 35.3855, GNorm = 2.0822, lr_0 = 1.0172e-04
Validation rmse = 0.145293
Validation r2 = 0.828280
Validation mse = 0.021110
Epoch 56
Loss = 7.6136e-02, PNorm = 35.3895, GNorm = 0.7608, lr_0 = 1.0000e-04
Loss = 7.7475e-02, PNorm = 35.3935, GNorm = 0.6940, lr_0 = 1.0000e-04
Loss = 6.9596e-02, PNorm = 35.3939, GNorm = 1.1862, lr_0 = 1.0000e-04
Validation rmse = 0.146798
Validation r2 = 0.824705
Validation mse = 0.021550
Epoch 57
Loss = 8.4303e-02, PNorm = 35.3966, GNorm = 0.6916, lr_0 = 1.0000e-04
Validation rmse = 0.145488
Validation r2 = 0.827819
Validation mse = 0.021167
Epoch 58
Loss = 6.5551e-02, PNorm = 35.4001, GNorm = 1.1170, lr_0 = 1.0000e-04
Validation rmse = 0.144107
Validation r2 = 0.831071
Validation mse = 0.020767
Epoch 59
Loss = 1.1146e-01, PNorm = 35.4041, GNorm = 1.9462, lr_0 = 1.0000e-04
Loss = 7.3611e-02, PNorm = 35.4076, GNorm = 0.8630, lr_0 = 1.0000e-04
Validation rmse = 0.146053
Validation r2 = 0.826479
Validation mse = 0.021331
Model 0 best validation rmse = 0.143527 on epoch 52
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.223200
Model 0 test r2 = -0.120561
Model 0 test mse = 0.049818
Ensemble test rmse = 0.223200
Ensemble test r2 = -0.120561
Ensemble test mse = 0.049818
Fold 9
Splitting data with seed 9
Total size = 901 | train size = 720 | val size = 181 | test size = 121
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.5930e-01, PNorm = 34.0194, GNorm = 1.5979, lr_0 = 4.5357e-04
Validation rmse = 0.307382
Validation r2 = 0.267600
Validation mse = 0.094483
Epoch 1
Loss = 7.2722e-01, PNorm = 34.0605, GNorm = 8.9998, lr_0 = 8.0714e-04
Validation rmse = 0.281538
Validation r2 = 0.385578
Validation mse = 0.079264
Epoch 2
Loss = 6.0235e-01, PNorm = 34.1173, GNorm = 8.6082, lr_0 = 9.8592e-04
Loss = 4.5844e-01, PNorm = 34.1924, GNorm = 0.7144, lr_0 = 9.5836e-04
Validation rmse = 0.276808
Validation r2 = 0.406050
Validation mse = 0.076623
Epoch 3
Loss = 4.0819e-01, PNorm = 34.2582, GNorm = 7.8057, lr_0 = 9.3156e-04
Validation rmse = 0.240545
Validation r2 = 0.551476
Validation mse = 0.057862
Epoch 4
Loss = 3.7128e-01, PNorm = 34.3250, GNorm = 6.1319, lr_0 = 9.0295e-04
Loss = 3.1707e-01, PNorm = 34.3830, GNorm = 6.3173, lr_0 = 8.7771e-04
Validation rmse = 0.225249
Validation r2 = 0.606706
Validation mse = 0.050737
Epoch 5
Loss = 2.6915e-01, PNorm = 34.4376, GNorm = 5.0608, lr_0 = 8.5317e-04
Validation rmse = 0.212231
Validation r2 = 0.650851
Validation mse = 0.045042
Epoch 6
Loss = 2.2045e-01, PNorm = 34.4938, GNorm = 2.9769, lr_0 = 8.2697e-04
Loss = 2.2248e-01, PNorm = 34.5388, GNorm = 5.2887, lr_0 = 8.0385e-04
Loss = 2.9777e-01, PNorm = 34.5421, GNorm = 6.9381, lr_0 = 8.0157e-04
Validation rmse = 0.195087
Validation r2 = 0.704981
Validation mse = 0.038059
Epoch 7
Loss = 2.1369e-01, PNorm = 34.5831, GNorm = 4.6258, lr_0 = 7.7916e-04
Validation rmse = 0.191653
Validation r2 = 0.715277
Validation mse = 0.036731
Epoch 8
Loss = 1.7632e-01, PNorm = 34.6215, GNorm = 4.3268, lr_0 = 7.5737e-04
Validation rmse = 0.193065
Validation r2 = 0.711066
Validation mse = 0.037274
Epoch 9
Loss = 1.1883e-01, PNorm = 34.6595, GNorm = 2.3441, lr_0 = 7.3411e-04
Loss = 1.5437e-01, PNorm = 34.6856, GNorm = 1.7665, lr_0 = 7.1359e-04
Validation rmse = 0.189695
Validation r2 = 0.721064
Validation mse = 0.035984
Epoch 10
Loss = 1.4099e-01, PNorm = 34.7208, GNorm = 1.4585, lr_0 = 6.9364e-04
Validation rmse = 0.180059
Validation r2 = 0.748682
Validation mse = 0.032421
Epoch 11
Loss = 1.2364e-01, PNorm = 34.7542, GNorm = 1.2412, lr_0 = 6.7234e-04
Loss = 1.6436e-01, PNorm = 34.7813, GNorm = 0.9200, lr_0 = 6.5354e-04
Validation rmse = 0.186012
Validation r2 = 0.731789
Validation mse = 0.034601
Epoch 12
Loss = 1.5223e-01, PNorm = 34.8178, GNorm = 2.3228, lr_0 = 6.3347e-04
Validation rmse = 0.164751
Validation r2 = 0.789599
Validation mse = 0.027143
Epoch 13
Loss = 1.0988e-01, PNorm = 34.8356, GNorm = 2.0888, lr_0 = 6.1576e-04
Loss = 1.3455e-01, PNorm = 34.8579, GNorm = 2.1239, lr_0 = 5.9854e-04
Validation rmse = 0.168012
Validation r2 = 0.781186
Validation mse = 0.028228
Epoch 14
Loss = 1.0599e-01, PNorm = 34.8835, GNorm = 1.6184, lr_0 = 5.8016e-04
Validation rmse = 0.173444
Validation r2 = 0.766808
Validation mse = 0.030083
Epoch 15
Loss = 1.1768e-01, PNorm = 34.9026, GNorm = 2.0813, lr_0 = 5.6394e-04
Loss = 1.4423e-01, PNorm = 34.9203, GNorm = 1.3885, lr_0 = 5.4817e-04
Loss = 1.0634e-01, PNorm = 34.9221, GNorm = 2.7803, lr_0 = 5.4662e-04
Validation rmse = 0.163049
Validation r2 = 0.793925
Validation mse = 0.026585
Epoch 16
Loss = 1.2132e-01, PNorm = 34.9377, GNorm = 1.4498, lr_0 = 5.3134e-04
Validation rmse = 0.160380
Validation r2 = 0.800615
Validation mse = 0.025722
Epoch 17
Loss = 1.0544e-01, PNorm = 34.9560, GNorm = 0.9423, lr_0 = 5.1502e-04
Validation rmse = 0.172445
Validation r2 = 0.769489
Validation mse = 0.029737
Epoch 18
Loss = 1.1129e-01, PNorm = 34.9708, GNorm = 1.8116, lr_0 = 5.0062e-04
Loss = 1.0316e-01, PNorm = 34.9845, GNorm = 0.7716, lr_0 = 4.8662e-04
Validation rmse = 0.158707
Validation r2 = 0.804753
Validation mse = 0.025188
Epoch 19
Loss = 1.3072e-01, PNorm = 35.0000, GNorm = 2.1566, lr_0 = 4.7168e-04
Validation rmse = 0.165358
Validation r2 = 0.788044
Validation mse = 0.027343
Epoch 20
Loss = 1.1250e-01, PNorm = 35.0117, GNorm = 1.8901, lr_0 = 4.5849e-04
Loss = 1.1138e-01, PNorm = 35.0265, GNorm = 1.4220, lr_0 = 4.4567e-04
Validation rmse = 0.161400
Validation r2 = 0.798070
Validation mse = 0.026050
Epoch 21
Loss = 1.1128e-01, PNorm = 35.0381, GNorm = 2.3626, lr_0 = 4.3198e-04
Validation rmse = 0.161612
Validation r2 = 0.797541
Validation mse = 0.026118
Epoch 22
Loss = 1.3391e-01, PNorm = 35.0507, GNorm = 1.3114, lr_0 = 4.1872e-04
Loss = 1.0508e-01, PNorm = 35.0646, GNorm = 3.0884, lr_0 = 4.0701e-04
Validation rmse = 0.157045
Validation r2 = 0.808821
Validation mse = 0.024663
Epoch 23
Loss = 1.0892e-01, PNorm = 35.0754, GNorm = 1.3662, lr_0 = 3.9563e-04
Validation rmse = 0.182952
Validation r2 = 0.740542
Validation mse = 0.033471
Epoch 24
Loss = 1.2514e-01, PNorm = 35.0888, GNorm = 4.2768, lr_0 = 3.8348e-04
Loss = 1.0471e-01, PNorm = 35.1007, GNorm = 2.9199, lr_0 = 3.7276e-04
Validation rmse = 0.160031
Validation r2 = 0.801483
Validation mse = 0.025610
Epoch 25
Loss = 1.0879e-01, PNorm = 35.1136, GNorm = 2.3630, lr_0 = 3.6234e-04
Validation rmse = 0.158011
Validation r2 = 0.806462
Validation mse = 0.024967
Epoch 26
Loss = 7.8591e-02, PNorm = 35.1244, GNorm = 1.3324, lr_0 = 3.5121e-04
Validation rmse = 0.160199
Validation r2 = 0.801065
Validation mse = 0.025664
Epoch 27
Loss = 6.5729e-02, PNorm = 35.1339, GNorm = 1.3395, lr_0 = 3.4042e-04
Loss = 9.5714e-02, PNorm = 35.1422, GNorm = 0.8779, lr_0 = 3.3091e-04
Validation rmse = 0.160763
Validation r2 = 0.799662
Validation mse = 0.025845
Epoch 28
Loss = 9.5232e-02, PNorm = 35.1505, GNorm = 1.9457, lr_0 = 3.2165e-04
Validation rmse = 0.160419
Validation r2 = 0.800517
Validation mse = 0.025734
Epoch 29
Loss = 8.7857e-02, PNorm = 35.1596, GNorm = 1.8235, lr_0 = 3.1178e-04
Loss = 1.0073e-01, PNorm = 35.1680, GNorm = 3.4366, lr_0 = 3.0306e-04
Validation rmse = 0.166382
Validation r2 = 0.785411
Validation mse = 0.027683
Epoch 30
Loss = 8.9602e-02, PNorm = 35.1739, GNorm = 0.6272, lr_0 = 2.9459e-04
Validation rmse = 0.162338
Validation r2 = 0.795716
Validation mse = 0.026354
Epoch 31
Loss = 8.6535e-02, PNorm = 35.1824, GNorm = 2.1389, lr_0 = 2.8554e-04
Loss = 9.4187e-02, PNorm = 35.1899, GNorm = 1.7105, lr_0 = 2.7756e-04
Loss = 6.2473e-02, PNorm = 35.1906, GNorm = 3.1152, lr_0 = 2.7677e-04
Validation rmse = 0.159138
Validation r2 = 0.803692
Validation mse = 0.025325
Epoch 32
Loss = 9.0317e-02, PNorm = 35.1990, GNorm = 2.9483, lr_0 = 2.6903e-04
Validation rmse = 0.162525
Validation r2 = 0.795245
Validation mse = 0.026414
Epoch 33
Loss = 6.2892e-02, PNorm = 35.2050, GNorm = 1.4473, lr_0 = 2.6151e-04
Validation rmse = 0.166172
Validation r2 = 0.785953
Validation mse = 0.027613
Epoch 34
Loss = 9.8295e-02, PNorm = 35.2120, GNorm = 3.3077, lr_0 = 2.5348e-04
Loss = 8.5791e-02, PNorm = 35.2178, GNorm = 1.2546, lr_0 = 2.4639e-04
Validation rmse = 0.162603
Validation r2 = 0.795048
Validation mse = 0.026440
Epoch 35
Loss = 7.9030e-02, PNorm = 35.2255, GNorm = 1.0913, lr_0 = 2.3950e-04
Validation rmse = 0.156939
Validation r2 = 0.809078
Validation mse = 0.024630
Epoch 36
Loss = 5.8014e-02, PNorm = 35.2318, GNorm = 0.5929, lr_0 = 2.3215e-04
Loss = 8.9671e-02, PNorm = 35.2389, GNorm = 1.2658, lr_0 = 2.2566e-04
Validation rmse = 0.162541
Validation r2 = 0.795206
Validation mse = 0.026420
Epoch 37
Loss = 7.9356e-02, PNorm = 35.2466, GNorm = 1.7128, lr_0 = 2.1873e-04
Validation rmse = 0.159296
Validation r2 = 0.803302
Validation mse = 0.025375
Epoch 38
Loss = 1.1160e-01, PNorm = 35.2532, GNorm = 1.0380, lr_0 = 2.1261e-04
Loss = 7.7740e-02, PNorm = 35.2589, GNorm = 1.3108, lr_0 = 2.0667e-04
Validation rmse = 0.161216
Validation r2 = 0.798532
Validation mse = 0.025990
Epoch 39
Loss = 8.3017e-02, PNorm = 35.2636, GNorm = 0.8752, lr_0 = 2.0032e-04
Validation rmse = 0.159863
Validation r2 = 0.801899
Validation mse = 0.025556
Epoch 40
Loss = 7.8423e-02, PNorm = 35.2703, GNorm = 0.6543, lr_0 = 1.9472e-04
Loss = 8.5992e-02, PNorm = 35.2766, GNorm = 0.6218, lr_0 = 1.8928e-04
Loss = 4.5289e-02, PNorm = 35.2772, GNorm = 0.8222, lr_0 = 1.8874e-04
Validation rmse = 0.157831
Validation r2 = 0.806901
Validation mse = 0.024911
Epoch 41
Loss = 8.4466e-02, PNorm = 35.2820, GNorm = 0.8039, lr_0 = 1.8346e-04
Validation rmse = 0.159105
Validation r2 = 0.803772
Validation mse = 0.025314
Epoch 42
Loss = 8.2124e-02, PNorm = 35.2868, GNorm = 3.4391, lr_0 = 1.7783e-04
Validation rmse = 0.175406
Validation r2 = 0.761503
Validation mse = 0.030767
Epoch 43
Loss = 9.3629e-02, PNorm = 35.2911, GNorm = 4.1337, lr_0 = 1.7286e-04
Loss = 9.0791e-02, PNorm = 35.2963, GNorm = 3.1527, lr_0 = 1.6802e-04
Validation rmse = 0.159951
Validation r2 = 0.801681
Validation mse = 0.025584
Epoch 44
Loss = 7.9232e-02, PNorm = 35.3023, GNorm = 2.2210, lr_0 = 1.6286e-04
Validation rmse = 0.162227
Validation r2 = 0.795997
Validation mse = 0.026317
Epoch 45
Loss = 7.6808e-02, PNorm = 35.3068, GNorm = 1.9405, lr_0 = 1.5831e-04
Loss = 8.2628e-02, PNorm = 35.3109, GNorm = 0.8195, lr_0 = 1.5388e-04
Validation rmse = 0.163480
Validation r2 = 0.792832
Validation mse = 0.026726
Epoch 46
Loss = 7.7499e-02, PNorm = 35.3167, GNorm = 1.6959, lr_0 = 1.4916e-04
Validation rmse = 0.162543
Validation r2 = 0.795200
Validation mse = 0.026420
Epoch 47
Loss = 8.2230e-02, PNorm = 35.3209, GNorm = 0.9123, lr_0 = 1.4458e-04
Loss = 8.0298e-02, PNorm = 35.3250, GNorm = 1.2858, lr_0 = 1.4053e-04
Validation rmse = 0.159727
Validation r2 = 0.802234
Validation mse = 0.025513
Epoch 48
Loss = 8.0242e-02, PNorm = 35.3294, GNorm = 1.0243, lr_0 = 1.3661e-04
Validation rmse = 0.157456
Validation r2 = 0.807819
Validation mse = 0.024792
Epoch 49
Loss = 6.8890e-02, PNorm = 35.3318, GNorm = 0.8245, lr_0 = 1.3241e-04
Loss = 9.4331e-02, PNorm = 35.3358, GNorm = 3.2646, lr_0 = 1.2871e-04
Validation rmse = 0.164437
Validation r2 = 0.790400
Validation mse = 0.027039
Epoch 50
Loss = 8.0510e-02, PNorm = 35.3405, GNorm = 1.1965, lr_0 = 1.2511e-04
Validation rmse = 0.164762
Validation r2 = 0.789571
Validation mse = 0.027146
Epoch 51
Loss = 9.5411e-02, PNorm = 35.3458, GNorm = 0.5816, lr_0 = 1.2127e-04
Validation rmse = 0.169158
Validation r2 = 0.778191
Validation mse = 0.028614
Epoch 52
Loss = 9.0189e-02, PNorm = 35.3495, GNorm = 2.6295, lr_0 = 1.1754e-04
Loss = 7.7661e-02, PNorm = 35.3540, GNorm = 1.1229, lr_0 = 1.1426e-04
Validation rmse = 0.166585
Validation r2 = 0.784887
Validation mse = 0.027751
Epoch 53
Loss = 8.7886e-02, PNorm = 35.3566, GNorm = 0.8141, lr_0 = 1.1106e-04
Validation rmse = 0.159659
Validation r2 = 0.802404
Validation mse = 0.025491
Epoch 54
Loss = 7.6926e-02, PNorm = 35.3600, GNorm = 1.4155, lr_0 = 1.0765e-04
Loss = 7.5169e-02, PNorm = 35.3633, GNorm = 0.5618, lr_0 = 1.0464e-04
Validation rmse = 0.158340
Validation r2 = 0.805655
Validation mse = 0.025071
Epoch 55
Loss = 7.4745e-02, PNorm = 35.3659, GNorm = 0.7143, lr_0 = 1.0172e-04
Validation rmse = 0.159206
Validation r2 = 0.803523
Validation mse = 0.025347
Epoch 56
Loss = 7.0461e-02, PNorm = 35.3698, GNorm = 0.8271, lr_0 = 1.0000e-04
Loss = 8.1894e-02, PNorm = 35.3722, GNorm = 2.5694, lr_0 = 1.0000e-04
Loss = 5.2567e-02, PNorm = 35.3727, GNorm = 0.7832, lr_0 = 1.0000e-04
Validation rmse = 0.158761
Validation r2 = 0.804620
Validation mse = 0.025205
Epoch 57
Loss = 7.5088e-02, PNorm = 35.3752, GNorm = 0.5618, lr_0 = 1.0000e-04
Validation rmse = 0.159074
Validation r2 = 0.803849
Validation mse = 0.025304
Epoch 58
Loss = 7.0832e-02, PNorm = 35.3789, GNorm = 0.3680, lr_0 = 1.0000e-04
Validation rmse = 0.159015
Validation r2 = 0.803994
Validation mse = 0.025286
Epoch 59
Loss = 6.3797e-02, PNorm = 35.3820, GNorm = 0.5647, lr_0 = 1.0000e-04
Loss = 7.5174e-02, PNorm = 35.3838, GNorm = 0.8485, lr_0 = 1.0000e-04
Validation rmse = 0.157835
Validation r2 = 0.806892
Validation mse = 0.024912
Model 0 best validation rmse = 0.156939 on epoch 35
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.203668
Model 0 test r2 = 0.066979
Model 0 test mse = 0.041481
Ensemble test rmse = 0.203668
Ensemble test r2 = 0.066979
Ensemble test mse = 0.041481
10-fold cross validation
	Seed 0 ==> test rmse = 0.224283
	Seed 0 ==> test r2 = -0.131464
	Seed 0 ==> test mse = 0.050303
	Seed 1 ==> test rmse = 0.190696
	Seed 1 ==> test r2 = 0.182043
	Seed 1 ==> test mse = 0.036365
	Seed 2 ==> test rmse = 0.201278
	Seed 2 ==> test r2 = 0.088745
	Seed 2 ==> test mse = 0.040513
	Seed 3 ==> test rmse = 0.205956
	Seed 3 ==> test r2 = 0.045894
	Seed 3 ==> test mse = 0.042418
	Seed 4 ==> test rmse = 0.149203
	Seed 4 ==> test r2 = 0.499268
	Seed 4 ==> test mse = 0.022262
	Seed 5 ==> test rmse = 0.229042
	Seed 5 ==> test r2 = -0.179989
	Seed 5 ==> test mse = 0.052460
	Seed 6 ==> test rmse = 0.211849
	Seed 6 ==> test r2 = -0.009487
	Seed 6 ==> test mse = 0.044880
	Seed 7 ==> test rmse = 0.233136
	Seed 7 ==> test r2 = -0.222547
	Seed 7 ==> test mse = 0.054352
	Seed 8 ==> test rmse = 0.223200
	Seed 8 ==> test r2 = -0.120561
	Seed 8 ==> test mse = 0.049818
	Seed 9 ==> test rmse = 0.203668
	Seed 9 ==> test r2 = 0.066979
	Seed 9 ==> test mse = 0.041481
Overall test rmse = 0.207231 +/- 0.023247
Overall test r2 = 0.021888 +/- 0.201474
Overall test mse = 0.043485 +/- 0.008957
Elapsed time = 0:06:22
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-1d5c3576-9790-4896-9034-9bb28ba18d8e.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/MTBE_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2', 'mse'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2', 'mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/generalization_3/MTBE_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/MTBE_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 971 | train size = 776 | val size = 195 | test size = 51
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.4874e-01, PNorm = 34.0137, GNorm = 2.3249, lr_0 = 4.3000e-04
Validation rmse = 0.274037
Validation r2 = 0.327113
Validation mse = 0.075096
Epoch 1
Loss = 7.5139e-01, PNorm = 34.0439, GNorm = 6.6967, lr_0 = 7.6000e-04
Loss = 6.3907e-01, PNorm = 34.0868, GNorm = 1.6192, lr_0 = 9.9472e-04
Validation rmse = 0.240355
Validation r2 = 0.482358
Validation mse = 0.057770
Epoch 2
Loss = 4.6021e-01, PNorm = 34.1554, GNorm = 5.2738, lr_0 = 9.6874e-04
Validation rmse = 0.214157
Validation r2 = 0.589049
Validation mse = 0.045863
Epoch 3
Loss = 5.6687e-01, PNorm = 34.2348, GNorm = 1.3621, lr_0 = 9.4094e-04
Loss = 3.3349e-01, PNorm = 34.2977, GNorm = 1.4269, lr_0 = 9.1637e-04
Validation rmse = 0.176991
Validation r2 = 0.719310
Validation mse = 0.031326
Epoch 4
Loss = 3.7941e-01, PNorm = 34.3498, GNorm = 3.3034, lr_0 = 8.9243e-04
Validation rmse = 0.185671
Validation r2 = 0.691105
Validation mse = 0.034474
Epoch 5
Loss = 3.3330e-01, PNorm = 34.4033, GNorm = 6.1900, lr_0 = 8.6682e-04
Loss = 3.3243e-01, PNorm = 34.4509, GNorm = 6.8055, lr_0 = 8.4418e-04
Validation rmse = 0.175454
Validation r2 = 0.724165
Validation mse = 0.030784
Epoch 6
Loss = 2.9349e-01, PNorm = 34.5027, GNorm = 3.7709, lr_0 = 8.2213e-04
Validation rmse = 0.156692
Validation r2 = 0.780004
Validation mse = 0.024552
Epoch 7
Loss = 2.3090e-01, PNorm = 34.5586, GNorm = 4.8495, lr_0 = 7.9854e-04
Loss = 2.3223e-01, PNorm = 34.6068, GNorm = 1.0467, lr_0 = 7.7769e-04
Validation rmse = 0.146629
Validation r2 = 0.807353
Validation mse = 0.021500
Epoch 8
Loss = 2.0920e-01, PNorm = 34.6522, GNorm = 1.8810, lr_0 = 7.5737e-04
Validation rmse = 0.143336
Validation r2 = 0.815907
Validation mse = 0.020545
Epoch 9
Loss = 1.5204e-01, PNorm = 34.6899, GNorm = 2.1223, lr_0 = 7.3564e-04
Loss = 1.9305e-01, PNorm = 34.7271, GNorm = 1.7906, lr_0 = 7.1643e-04
Validation rmse = 0.147988
Validation r2 = 0.803764
Validation mse = 0.021901
Epoch 10
Loss = 1.7853e-01, PNorm = 34.7677, GNorm = 1.5888, lr_0 = 6.9772e-04
Loss = 1.5992e-01, PNorm = 34.8037, GNorm = 4.3939, lr_0 = 6.7949e-04
Loss = 1.9818e-01, PNorm = 34.8079, GNorm = 5.0309, lr_0 = 6.7770e-04
Validation rmse = 0.132801
Validation r2 = 0.841974
Validation mse = 0.017636
Epoch 11
Loss = 1.6278e-01, PNorm = 34.8397, GNorm = 4.4827, lr_0 = 6.5999e-04
Validation rmse = 0.134743
Validation r2 = 0.837319
Validation mse = 0.018156
Epoch 12
Loss = 1.3151e-01, PNorm = 34.8659, GNorm = 4.1080, lr_0 = 6.4276e-04
Loss = 1.7055e-01, PNorm = 34.8933, GNorm = 1.2993, lr_0 = 6.2597e-04
Validation rmse = 0.131448
Validation r2 = 0.845178
Validation mse = 0.017279
Epoch 13
Loss = 1.5150e-01, PNorm = 34.9279, GNorm = 0.9025, lr_0 = 6.0801e-04
Validation rmse = 0.129435
Validation r2 = 0.849885
Validation mse = 0.016753
Epoch 14
Loss = 1.0283e-01, PNorm = 34.9511, GNorm = 1.1867, lr_0 = 5.9213e-04
Loss = 1.4316e-01, PNorm = 34.9744, GNorm = 1.3465, lr_0 = 5.7666e-04
Validation rmse = 0.128644
Validation r2 = 0.851714
Validation mse = 0.016549
Epoch 15
Loss = 1.4296e-01, PNorm = 34.9933, GNorm = 2.9500, lr_0 = 5.6011e-04
Validation rmse = 0.133202
Validation r2 = 0.841019
Validation mse = 0.017743
Epoch 16
Loss = 1.0717e-01, PNorm = 35.0165, GNorm = 2.7507, lr_0 = 5.4548e-04
Loss = 1.3540e-01, PNorm = 35.0439, GNorm = 1.2237, lr_0 = 5.3124e-04
Validation rmse = 0.131008
Validation r2 = 0.846214
Validation mse = 0.017163
Epoch 17
Loss = 1.1754e-01, PNorm = 35.0634, GNorm = 2.9231, lr_0 = 5.1599e-04
Validation rmse = 0.132616
Validation r2 = 0.842415
Validation mse = 0.017587
Epoch 18
Loss = 6.7747e-02, PNorm = 35.0793, GNorm = 2.7163, lr_0 = 5.0252e-04
Loss = 1.0103e-01, PNorm = 35.0955, GNorm = 1.9940, lr_0 = 4.8939e-04
Validation rmse = 0.126739
Validation r2 = 0.856072
Validation mse = 0.016063
Epoch 19
Loss = 1.1471e-01, PNorm = 35.1134, GNorm = 0.8996, lr_0 = 4.7535e-04
Loss = 1.1683e-01, PNorm = 35.1310, GNorm = 0.8007, lr_0 = 4.6293e-04
Validation rmse = 0.124152
Validation r2 = 0.861888
Validation mse = 0.015414
Epoch 20
Loss = 1.1654e-01, PNorm = 35.1490, GNorm = 1.1270, lr_0 = 4.5084e-04
Validation rmse = 0.127304
Validation r2 = 0.854786
Validation mse = 0.016206
Epoch 21
Loss = 1.0217e-01, PNorm = 35.1666, GNorm = 3.8644, lr_0 = 4.3790e-04
Loss = 1.2800e-01, PNorm = 35.1827, GNorm = 1.2269, lr_0 = 4.2647e-04
Validation rmse = 0.127667
Validation r2 = 0.853957
Validation mse = 0.016299
Epoch 22
Loss = 1.1186e-01, PNorm = 35.1958, GNorm = 0.7150, lr_0 = 4.1533e-04
Validation rmse = 0.125270
Validation r2 = 0.859389
Validation mse = 0.015693
Epoch 23
Loss = 1.0602e-01, PNorm = 35.2134, GNorm = 1.7937, lr_0 = 4.0341e-04
Loss = 1.2133e-01, PNorm = 35.2246, GNorm = 0.9007, lr_0 = 3.9287e-04
Validation rmse = 0.132243
Validation r2 = 0.843299
Validation mse = 0.017488
Epoch 24
Loss = 1.2783e-01, PNorm = 35.2364, GNorm = 4.5187, lr_0 = 3.8261e-04
Validation rmse = 0.125204
Validation r2 = 0.859538
Validation mse = 0.015676
Epoch 25
Loss = 8.9405e-02, PNorm = 35.2502, GNorm = 0.9795, lr_0 = 3.7262e-04
Loss = 1.1384e-01, PNorm = 35.2625, GNorm = 0.5633, lr_0 = 3.6289e-04
Validation rmse = 0.128967
Validation r2 = 0.850968
Validation mse = 0.016632
Epoch 26
Loss = 1.0204e-01, PNorm = 35.2763, GNorm = 1.4819, lr_0 = 3.5247e-04
Validation rmse = 0.125359
Validation r2 = 0.859189
Validation mse = 0.015715
Epoch 27
Loss = 9.9655e-02, PNorm = 35.2870, GNorm = 0.8169, lr_0 = 3.4327e-04
Loss = 1.0022e-01, PNorm = 35.2986, GNorm = 0.7615, lr_0 = 3.3430e-04
Validation rmse = 0.131110
Validation r2 = 0.845972
Validation mse = 0.017190
Epoch 28
Loss = 1.0340e-01, PNorm = 35.3116, GNorm = 2.1629, lr_0 = 3.2471e-04
Loss = 1.1190e-01, PNorm = 35.3210, GNorm = 1.7547, lr_0 = 3.1623e-04
Validation rmse = 0.126951
Validation r2 = 0.855591
Validation mse = 0.016116
Epoch 29
Loss = 1.0375e-01, PNorm = 35.3311, GNorm = 0.6421, lr_0 = 3.0797e-04
Validation rmse = 0.133095
Validation r2 = 0.841273
Validation mse = 0.017714
Epoch 30
Loss = 1.0141e-01, PNorm = 35.3437, GNorm = 1.0791, lr_0 = 2.9913e-04
Loss = 1.1293e-01, PNorm = 35.3532, GNorm = 4.2119, lr_0 = 2.9132e-04
Validation rmse = 0.124335
Validation r2 = 0.861480
Validation mse = 0.015459
Epoch 31
Loss = 1.0313e-01, PNorm = 35.3621, GNorm = 2.8678, lr_0 = 2.8371e-04
Validation rmse = 0.132951
Validation r2 = 0.841617
Validation mse = 0.017676
Epoch 32
Loss = 1.0447e-01, PNorm = 35.3728, GNorm = 3.7098, lr_0 = 2.7557e-04
Loss = 1.1016e-01, PNorm = 35.3806, GNorm = 3.3100, lr_0 = 2.6837e-04
Validation rmse = 0.124348
Validation r2 = 0.861452
Validation mse = 0.015462
Epoch 33
Loss = 1.1637e-01, PNorm = 35.3937, GNorm = 4.1883, lr_0 = 2.6136e-04
Validation rmse = 0.128562
Validation r2 = 0.851902
Validation mse = 0.016528
Epoch 34
Loss = 1.3374e-01, PNorm = 35.4048, GNorm = 1.4420, lr_0 = 2.5386e-04
Loss = 8.4770e-02, PNorm = 35.4163, GNorm = 0.9947, lr_0 = 2.4723e-04
Validation rmse = 0.125326
Validation r2 = 0.859265
Validation mse = 0.015706
Epoch 35
Loss = 7.7612e-02, PNorm = 35.4253, GNorm = 0.6174, lr_0 = 2.4077e-04
Validation rmse = 0.132397
Validation r2 = 0.842935
Validation mse = 0.017529
Epoch 36
Loss = 9.6178e-02, PNorm = 35.4331, GNorm = 2.9565, lr_0 = 2.3387e-04
Loss = 9.5505e-02, PNorm = 35.4408, GNorm = 3.1122, lr_0 = 2.2776e-04
Validation rmse = 0.127931
Validation r2 = 0.853351
Validation mse = 0.016366
Epoch 37
Loss = 1.0115e-01, PNorm = 35.4478, GNorm = 2.1577, lr_0 = 2.2181e-04
Validation rmse = 0.123550
Validation r2 = 0.863225
Validation mse = 0.015264
Epoch 38
Loss = 5.5561e-02, PNorm = 35.4554, GNorm = 1.4059, lr_0 = 2.1544e-04
Loss = 9.9251e-02, PNorm = 35.4614, GNorm = 0.6789, lr_0 = 2.0982e-04
Validation rmse = 0.124977
Validation r2 = 0.860047
Validation mse = 0.015619
Epoch 39
Loss = 9.8750e-02, PNorm = 35.4669, GNorm = 0.8799, lr_0 = 2.0434e-04
Loss = 8.3779e-02, PNorm = 35.4748, GNorm = 0.7892, lr_0 = 1.9900e-04
Loss = 1.1472e-01, PNorm = 35.4758, GNorm = 1.4608, lr_0 = 1.9847e-04
Validation rmse = 0.128296
Validation r2 = 0.852515
Validation mse = 0.016460
Epoch 40
Loss = 8.8394e-02, PNorm = 35.4824, GNorm = 1.0796, lr_0 = 1.9329e-04
Validation rmse = 0.121930
Validation r2 = 0.866787
Validation mse = 0.014867
Epoch 41
Loss = 7.0106e-02, PNorm = 35.4898, GNorm = 1.3518, lr_0 = 1.8824e-04
Loss = 9.7954e-02, PNorm = 35.4956, GNorm = 1.1212, lr_0 = 1.8332e-04
Validation rmse = 0.125136
Validation r2 = 0.859689
Validation mse = 0.015659
Epoch 42
Loss = 8.5537e-02, PNorm = 35.5027, GNorm = 0.8967, lr_0 = 1.7806e-04
Validation rmse = 0.125901
Validation r2 = 0.857969
Validation mse = 0.015851
Epoch 43
Loss = 1.0590e-01, PNorm = 35.5095, GNorm = 2.2179, lr_0 = 1.7341e-04
Loss = 8.8663e-02, PNorm = 35.5154, GNorm = 0.8715, lr_0 = 1.6888e-04
Validation rmse = 0.123457
Validation r2 = 0.863429
Validation mse = 0.015242
Epoch 44
Loss = 8.0169e-02, PNorm = 35.5207, GNorm = 1.5071, lr_0 = 1.6404e-04
Validation rmse = 0.121759
Validation r2 = 0.867161
Validation mse = 0.014825
Epoch 45
Loss = 1.0654e-01, PNorm = 35.5258, GNorm = 2.6263, lr_0 = 1.5975e-04
Loss = 8.4964e-02, PNorm = 35.5316, GNorm = 1.9778, lr_0 = 1.5558e-04
Validation rmse = 0.123340
Validation r2 = 0.863689
Validation mse = 0.015213
Epoch 46
Loss = 8.3959e-02, PNorm = 35.5374, GNorm = 0.5850, lr_0 = 1.5112e-04
Validation rmse = 0.122117
Validation r2 = 0.866378
Validation mse = 0.014913
Epoch 47
Loss = 7.5204e-02, PNorm = 35.5420, GNorm = 0.8573, lr_0 = 1.4717e-04
Loss = 8.9342e-02, PNorm = 35.5469, GNorm = 1.1519, lr_0 = 1.4332e-04
Validation rmse = 0.122525
Validation r2 = 0.865485
Validation mse = 0.015012
Epoch 48
Loss = 8.1757e-02, PNorm = 35.5534, GNorm = 0.6478, lr_0 = 1.3921e-04
Loss = 8.6225e-02, PNorm = 35.5573, GNorm = 3.7258, lr_0 = 1.3558e-04
Validation rmse = 0.123911
Validation r2 = 0.862424
Validation mse = 0.015354
Epoch 49
Loss = 9.2816e-02, PNorm = 35.5625, GNorm = 2.6910, lr_0 = 1.3204e-04
Validation rmse = 0.122404
Validation r2 = 0.865749
Validation mse = 0.014983
Epoch 50
Loss = 9.1897e-02, PNorm = 35.5666, GNorm = 2.5201, lr_0 = 1.2859e-04
Loss = 8.1243e-02, PNorm = 35.5714, GNorm = 0.7164, lr_0 = 1.2523e-04
Validation rmse = 0.124327
Validation r2 = 0.861499
Validation mse = 0.015457
Epoch 51
Loss = 9.2140e-02, PNorm = 35.5758, GNorm = 0.7716, lr_0 = 1.2163e-04
Validation rmse = 0.122260
Validation r2 = 0.866065
Validation mse = 0.014948
Epoch 52
Loss = 6.2779e-02, PNorm = 35.5797, GNorm = 0.3998, lr_0 = 1.1846e-04
Loss = 8.2942e-02, PNorm = 35.5827, GNorm = 0.6548, lr_0 = 1.1536e-04
Validation rmse = 0.122209
Validation r2 = 0.866178
Validation mse = 0.014935
Epoch 53
Loss = 8.6748e-02, PNorm = 35.5888, GNorm = 1.8345, lr_0 = 1.1205e-04
Validation rmse = 0.124815
Validation r2 = 0.860408
Validation mse = 0.015579
Epoch 54
Loss = 8.3004e-02, PNorm = 35.5928, GNorm = 1.0371, lr_0 = 1.0913e-04
Loss = 8.2670e-02, PNorm = 35.5955, GNorm = 0.8994, lr_0 = 1.0628e-04
Validation rmse = 0.122580
Validation r2 = 0.865363
Validation mse = 0.015026
Epoch 55
Loss = 7.7436e-02, PNorm = 35.5993, GNorm = 1.2594, lr_0 = 1.0323e-04
Validation rmse = 0.122345
Validation r2 = 0.865880
Validation mse = 0.014968
Epoch 56
Loss = 8.5804e-02, PNorm = 35.6025, GNorm = 0.5806, lr_0 = 1.0053e-04
Loss = 8.2774e-02, PNorm = 35.6063, GNorm = 0.8596, lr_0 = 1.0000e-04
Validation rmse = 0.122328
Validation r2 = 0.865916
Validation mse = 0.014964
Epoch 57
Loss = 8.2775e-02, PNorm = 35.6092, GNorm = 2.0054, lr_0 = 1.0000e-04
Loss = 8.0516e-02, PNorm = 35.6129, GNorm = 1.3611, lr_0 = 1.0000e-04
Validation rmse = 0.122232
Validation r2 = 0.866128
Validation mse = 0.014941
Epoch 58
Loss = 8.0810e-02, PNorm = 35.6159, GNorm = 0.9386, lr_0 = 1.0000e-04
Validation rmse = 0.122369
Validation r2 = 0.865827
Validation mse = 0.014974
Epoch 59
Loss = 9.1427e-02, PNorm = 35.6198, GNorm = 1.3669, lr_0 = 1.0000e-04
Loss = 7.1728e-02, PNorm = 35.6238, GNorm = 1.7789, lr_0 = 1.0000e-04
Validation rmse = 0.122876
Validation r2 = 0.864713
Validation mse = 0.015098
Model 0 best validation rmse = 0.121759 on epoch 44
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.430674
Model 0 test r2 = -3.401634
Model 0 test mse = 0.185480
Ensemble test rmse = 0.430674
Ensemble test r2 = -3.401634
Ensemble test mse = 0.185480
Fold 1
Splitting data with seed 1
Total size = 971 | train size = 776 | val size = 195 | test size = 51
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.0480e-01, PNorm = 34.0142, GNorm = 1.0439, lr_0 = 4.3000e-04
Validation rmse = 0.265798
Validation r2 = 0.255182
Validation mse = 0.070648
Epoch 1
Loss = 6.6949e-01, PNorm = 34.0495, GNorm = 2.7075, lr_0 = 7.6000e-04
Loss = 7.2603e-01, PNorm = 34.0827, GNorm = 3.8084, lr_0 = 9.9472e-04
Validation rmse = 0.279850
Validation r2 = 0.174344
Validation mse = 0.078316
Epoch 2
Loss = 6.5469e-01, PNorm = 34.1245, GNorm = 8.9935, lr_0 = 9.6874e-04
Validation rmse = 0.213335
Validation r2 = 0.520189
Validation mse = 0.045512
Epoch 3
Loss = 4.4073e-01, PNorm = 34.1814, GNorm = 2.8806, lr_0 = 9.4094e-04
Loss = 4.0723e-01, PNorm = 34.2325, GNorm = 1.2859, lr_0 = 9.1637e-04
Validation rmse = 0.208574
Validation r2 = 0.541366
Validation mse = 0.043503
Epoch 4
Loss = 3.7834e-01, PNorm = 34.2899, GNorm = 8.5064, lr_0 = 8.9243e-04
Validation rmse = 0.203860
Validation r2 = 0.561863
Validation mse = 0.041559
Epoch 5
Loss = 3.2400e-01, PNorm = 34.3547, GNorm = 1.0681, lr_0 = 8.6682e-04
Loss = 2.9532e-01, PNorm = 34.4091, GNorm = 2.3961, lr_0 = 8.4418e-04
Validation rmse = 0.165143
Validation r2 = 0.712478
Validation mse = 0.027272
Epoch 6
Loss = 2.3708e-01, PNorm = 34.4655, GNorm = 7.1601, lr_0 = 8.2213e-04
Validation rmse = 0.164819
Validation r2 = 0.713608
Validation mse = 0.027165
Epoch 7
Loss = 3.2067e-01, PNorm = 34.5241, GNorm = 4.0130, lr_0 = 7.9854e-04
Loss = 2.4962e-01, PNorm = 34.5738, GNorm = 7.3009, lr_0 = 7.7769e-04
Validation rmse = 0.148479
Validation r2 = 0.767578
Validation mse = 0.022046
Epoch 8
Loss = 1.9357e-01, PNorm = 34.6139, GNorm = 1.0368, lr_0 = 7.5737e-04
Validation rmse = 0.145868
Validation r2 = 0.775679
Validation mse = 0.021278
Epoch 9
Loss = 1.6786e-01, PNorm = 34.6595, GNorm = 1.1477, lr_0 = 7.3564e-04
Loss = 2.2036e-01, PNorm = 34.6966, GNorm = 4.3013, lr_0 = 7.1643e-04
Validation rmse = 0.156426
Validation r2 = 0.742031
Validation mse = 0.024469
Epoch 10
Loss = 1.7113e-01, PNorm = 34.7341, GNorm = 0.8288, lr_0 = 6.9772e-04
Loss = 1.7198e-01, PNorm = 34.7666, GNorm = 1.3187, lr_0 = 6.7949e-04
Loss = 8.5704e-02, PNorm = 34.7700, GNorm = 0.9841, lr_0 = 6.7770e-04
Validation rmse = 0.166588
Validation r2 = 0.707427
Validation mse = 0.027752
Epoch 11
Loss = 2.0459e-01, PNorm = 34.7991, GNorm = 2.5620, lr_0 = 6.5999e-04
Validation rmse = 0.144539
Validation r2 = 0.779750
Validation mse = 0.020891
Epoch 12
Loss = 1.6951e-01, PNorm = 34.8250, GNorm = 2.2067, lr_0 = 6.4276e-04
Loss = 1.5108e-01, PNorm = 34.8454, GNorm = 1.3065, lr_0 = 6.2597e-04
Validation rmse = 0.129232
Validation r2 = 0.823928
Validation mse = 0.016701
Epoch 13
Loss = 1.5852e-01, PNorm = 34.8741, GNorm = 3.6730, lr_0 = 6.0801e-04
Validation rmse = 0.126240
Validation r2 = 0.831987
Validation mse = 0.015937
Epoch 14
Loss = 1.2990e-01, PNorm = 34.8951, GNorm = 3.8411, lr_0 = 5.9213e-04
Loss = 1.3083e-01, PNorm = 34.9159, GNorm = 2.0016, lr_0 = 5.7666e-04
Validation rmse = 0.132786
Validation r2 = 0.814111
Validation mse = 0.017632
Epoch 15
Loss = 1.2470e-01, PNorm = 34.9406, GNorm = 2.5178, lr_0 = 5.6011e-04
Validation rmse = 0.126663
Validation r2 = 0.830860
Validation mse = 0.016043
Epoch 16
Loss = 1.3731e-01, PNorm = 34.9596, GNorm = 2.5564, lr_0 = 5.4548e-04
Loss = 1.3466e-01, PNorm = 34.9766, GNorm = 1.6497, lr_0 = 5.3124e-04
Validation rmse = 0.135982
Validation r2 = 0.805055
Validation mse = 0.018491
Epoch 17
Loss = 1.1423e-01, PNorm = 35.0023, GNorm = 1.0964, lr_0 = 5.1599e-04
Validation rmse = 0.140555
Validation r2 = 0.791723
Validation mse = 0.019756
Epoch 18
Loss = 2.5345e-01, PNorm = 35.0215, GNorm = 5.4356, lr_0 = 5.0252e-04
Loss = 1.3093e-01, PNorm = 35.0378, GNorm = 2.9080, lr_0 = 4.8939e-04
Validation rmse = 0.121860
Validation r2 = 0.843443
Validation mse = 0.014850
Epoch 19
Loss = 1.1524e-01, PNorm = 35.0539, GNorm = 0.7397, lr_0 = 4.7535e-04
Loss = 1.2207e-01, PNorm = 35.0701, GNorm = 1.4779, lr_0 = 4.6293e-04
Validation rmse = 0.121607
Validation r2 = 0.844093
Validation mse = 0.014788
Epoch 20
Loss = 1.2336e-01, PNorm = 35.0851, GNorm = 1.1317, lr_0 = 4.5084e-04
Validation rmse = 0.123499
Validation r2 = 0.839205
Validation mse = 0.015252
Epoch 21
Loss = 1.2221e-01, PNorm = 35.1037, GNorm = 1.7035, lr_0 = 4.3790e-04
Loss = 1.0703e-01, PNorm = 35.1169, GNorm = 0.5327, lr_0 = 4.2647e-04
Validation rmse = 0.128769
Validation r2 = 0.825187
Validation mse = 0.016582
Epoch 22
Loss = 1.0663e-01, PNorm = 35.1303, GNorm = 2.7644, lr_0 = 4.1533e-04
Validation rmse = 0.128509
Validation r2 = 0.825892
Validation mse = 0.016515
Epoch 23
Loss = 1.1228e-01, PNorm = 35.1459, GNorm = 4.0938, lr_0 = 4.0341e-04
Loss = 1.1773e-01, PNorm = 35.1594, GNorm = 2.6499, lr_0 = 3.9287e-04
Validation rmse = 0.118620
Validation r2 = 0.851659
Validation mse = 0.014071
Epoch 24
Loss = 9.9407e-02, PNorm = 35.1735, GNorm = 1.3155, lr_0 = 3.8261e-04
Validation rmse = 0.119865
Validation r2 = 0.848527
Validation mse = 0.014368
Epoch 25
Loss = 9.8343e-02, PNorm = 35.1859, GNorm = 2.3527, lr_0 = 3.7262e-04
Loss = 9.7731e-02, PNorm = 35.1983, GNorm = 0.6634, lr_0 = 3.6289e-04
Validation rmse = 0.118713
Validation r2 = 0.851425
Validation mse = 0.014093
Epoch 26
Loss = 1.2864e-01, PNorm = 35.2095, GNorm = 4.7085, lr_0 = 3.5247e-04
Validation rmse = 0.117633
Validation r2 = 0.854117
Validation mse = 0.013838
Epoch 27
Loss = 6.2026e-02, PNorm = 35.2216, GNorm = 1.4348, lr_0 = 3.4327e-04
Loss = 1.2131e-01, PNorm = 35.2308, GNorm = 1.0545, lr_0 = 3.3430e-04
Validation rmse = 0.123600
Validation r2 = 0.838940
Validation mse = 0.015277
Epoch 28
Loss = 1.3538e-01, PNorm = 35.2404, GNorm = 3.6984, lr_0 = 3.2471e-04
Loss = 1.4660e-01, PNorm = 35.2542, GNorm = 5.9872, lr_0 = 3.1623e-04
Validation rmse = 0.133145
Validation r2 = 0.813105
Validation mse = 0.017728
Epoch 29
Loss = 1.2478e-01, PNorm = 35.2688, GNorm = 4.3402, lr_0 = 3.0797e-04
Validation rmse = 0.126836
Validation r2 = 0.830397
Validation mse = 0.016087
Epoch 30
Loss = 1.3306e-01, PNorm = 35.2807, GNorm = 1.0831, lr_0 = 2.9913e-04
Loss = 9.9224e-02, PNorm = 35.2914, GNorm = 2.9843, lr_0 = 2.9132e-04
Validation rmse = 0.115403
Validation r2 = 0.859596
Validation mse = 0.013318
Epoch 31
Loss = 1.0006e-01, PNorm = 35.3011, GNorm = 1.0666, lr_0 = 2.8371e-04
Validation rmse = 0.137451
Validation r2 = 0.800820
Validation mse = 0.018893
Epoch 32
Loss = 1.1808e-01, PNorm = 35.3110, GNorm = 1.9710, lr_0 = 2.7557e-04
Loss = 1.0600e-01, PNorm = 35.3199, GNorm = 1.7067, lr_0 = 2.6837e-04
Validation rmse = 0.118972
Validation r2 = 0.850776
Validation mse = 0.014154
Epoch 33
Loss = 1.0278e-01, PNorm = 35.3299, GNorm = 0.6340, lr_0 = 2.6136e-04
Validation rmse = 0.130833
Validation r2 = 0.819541
Validation mse = 0.017117
Epoch 34
Loss = 1.1012e-01, PNorm = 35.3384, GNorm = 1.2730, lr_0 = 2.5386e-04
Loss = 9.1751e-02, PNorm = 35.3457, GNorm = 0.9408, lr_0 = 2.4723e-04
Validation rmse = 0.116771
Validation r2 = 0.856246
Validation mse = 0.013636
Epoch 35
Loss = 7.8149e-02, PNorm = 35.3554, GNorm = 0.9988, lr_0 = 2.4077e-04
Validation rmse = 0.116274
Validation r2 = 0.857468
Validation mse = 0.013520
Epoch 36
Loss = 8.6730e-02, PNorm = 35.3631, GNorm = 1.0333, lr_0 = 2.3387e-04
Loss = 8.9167e-02, PNorm = 35.3692, GNorm = 0.9480, lr_0 = 2.2776e-04
Validation rmse = 0.117254
Validation r2 = 0.855054
Validation mse = 0.013749
Epoch 37
Loss = 8.1340e-02, PNorm = 35.3761, GNorm = 0.9705, lr_0 = 2.2181e-04
Validation rmse = 0.119231
Validation r2 = 0.850126
Validation mse = 0.014216
Epoch 38
Loss = 5.3926e-02, PNorm = 35.3831, GNorm = 1.6222, lr_0 = 2.1544e-04
Loss = 9.6483e-02, PNorm = 35.3899, GNorm = 1.0796, lr_0 = 2.0982e-04
Validation rmse = 0.115426
Validation r2 = 0.859539
Validation mse = 0.013323
Epoch 39
Loss = 9.0725e-02, PNorm = 35.3963, GNorm = 1.0536, lr_0 = 2.0434e-04
Loss = 8.6659e-02, PNorm = 35.4022, GNorm = 1.0905, lr_0 = 1.9900e-04
Loss = 1.2124e-01, PNorm = 35.4028, GNorm = 3.1170, lr_0 = 1.9847e-04
Validation rmse = 0.116545
Validation r2 = 0.856803
Validation mse = 0.013583
Epoch 40
Loss = 8.1265e-02, PNorm = 35.4078, GNorm = 2.0268, lr_0 = 1.9329e-04
Validation rmse = 0.114861
Validation r2 = 0.860911
Validation mse = 0.013193
Epoch 41
Loss = 9.4060e-02, PNorm = 35.4150, GNorm = 0.9334, lr_0 = 1.8824e-04
Loss = 8.0372e-02, PNorm = 35.4217, GNorm = 0.5126, lr_0 = 1.8332e-04
Validation rmse = 0.115567
Validation r2 = 0.859197
Validation mse = 0.013356
Epoch 42
Loss = 7.7120e-02, PNorm = 35.4264, GNorm = 0.7222, lr_0 = 1.7806e-04
Validation rmse = 0.115717
Validation r2 = 0.858829
Validation mse = 0.013390
Epoch 43
Loss = 1.1056e-01, PNorm = 35.4320, GNorm = 1.3007, lr_0 = 1.7341e-04
Loss = 7.9864e-02, PNorm = 35.4369, GNorm = 1.8255, lr_0 = 1.6888e-04
Validation rmse = 0.114068
Validation r2 = 0.862824
Validation mse = 0.013012
Epoch 44
Loss = 9.2593e-02, PNorm = 35.4431, GNorm = 2.0491, lr_0 = 1.6404e-04
Validation rmse = 0.115792
Validation r2 = 0.858646
Validation mse = 0.013408
Epoch 45
Loss = 6.8765e-02, PNorm = 35.4486, GNorm = 0.8852, lr_0 = 1.5975e-04
Loss = 8.7578e-02, PNorm = 35.4534, GNorm = 0.7873, lr_0 = 1.5558e-04
Validation rmse = 0.114959
Validation r2 = 0.860672
Validation mse = 0.013216
Epoch 46
Loss = 9.1021e-02, PNorm = 35.4578, GNorm = 1.4124, lr_0 = 1.5112e-04
Validation rmse = 0.114480
Validation r2 = 0.861832
Validation mse = 0.013106
Epoch 47
Loss = 7.3451e-02, PNorm = 35.4628, GNorm = 0.6036, lr_0 = 1.4717e-04
Loss = 8.1489e-02, PNorm = 35.4670, GNorm = 1.4141, lr_0 = 1.4332e-04
Validation rmse = 0.114175
Validation r2 = 0.862568
Validation mse = 0.013036
Epoch 48
Loss = 8.7455e-02, PNorm = 35.4722, GNorm = 0.7968, lr_0 = 1.3921e-04
Loss = 8.4737e-02, PNorm = 35.4769, GNorm = 2.5618, lr_0 = 1.3558e-04
Validation rmse = 0.121173
Validation r2 = 0.845203
Validation mse = 0.014683
Epoch 49
Loss = 7.5352e-02, PNorm = 35.4810, GNorm = 2.1310, lr_0 = 1.3204e-04
Validation rmse = 0.114389
Validation r2 = 0.862052
Validation mse = 0.013085
Epoch 50
Loss = 6.9396e-02, PNorm = 35.4846, GNorm = 0.8636, lr_0 = 1.2859e-04
Loss = 8.6006e-02, PNorm = 35.4888, GNorm = 1.4642, lr_0 = 1.2523e-04
Validation rmse = 0.115258
Validation r2 = 0.859948
Validation mse = 0.013284
Epoch 51
Loss = 8.0360e-02, PNorm = 35.4934, GNorm = 1.0445, lr_0 = 1.2163e-04
Validation rmse = 0.115025
Validation r2 = 0.860513
Validation mse = 0.013231
Epoch 52
Loss = 7.3465e-02, PNorm = 35.4968, GNorm = 0.5979, lr_0 = 1.1846e-04
Loss = 7.2428e-02, PNorm = 35.4997, GNorm = 0.6665, lr_0 = 1.1536e-04
Validation rmse = 0.113497
Validation r2 = 0.864195
Validation mse = 0.012882
Epoch 53
Loss = 7.9119e-02, PNorm = 35.5049, GNorm = 1.2510, lr_0 = 1.1205e-04
Validation rmse = 0.115440
Validation r2 = 0.859505
Validation mse = 0.013326
Epoch 54
Loss = 9.9904e-02, PNorm = 35.5079, GNorm = 1.6794, lr_0 = 1.0913e-04
Loss = 7.4736e-02, PNorm = 35.5107, GNorm = 0.7962, lr_0 = 1.0628e-04
Validation rmse = 0.122445
Validation r2 = 0.841937
Validation mse = 0.014993
Epoch 55
Loss = 7.5843e-02, PNorm = 35.5151, GNorm = 1.4132, lr_0 = 1.0323e-04
Validation rmse = 0.113961
Validation r2 = 0.863083
Validation mse = 0.012987
Epoch 56
Loss = 1.0235e-01, PNorm = 35.5179, GNorm = 1.9361, lr_0 = 1.0053e-04
Loss = 8.6639e-02, PNorm = 35.5212, GNorm = 1.6019, lr_0 = 1.0000e-04
Validation rmse = 0.116622
Validation r2 = 0.856614
Validation mse = 0.013601
Epoch 57
Loss = 6.6367e-02, PNorm = 35.5247, GNorm = 3.5002, lr_0 = 1.0000e-04
Loss = 8.6968e-02, PNorm = 35.5281, GNorm = 1.3907, lr_0 = 1.0000e-04
Validation rmse = 0.115016
Validation r2 = 0.860535
Validation mse = 0.013229
Epoch 58
Loss = 7.6953e-02, PNorm = 35.5314, GNorm = 1.1974, lr_0 = 1.0000e-04
Validation rmse = 0.113395
Validation r2 = 0.864438
Validation mse = 0.012858
Epoch 59
Loss = 8.0950e-02, PNorm = 35.5346, GNorm = 0.4853, lr_0 = 1.0000e-04
Loss = 7.2569e-02, PNorm = 35.5376, GNorm = 1.6953, lr_0 = 1.0000e-04
Validation rmse = 0.115782
Validation r2 = 0.858672
Validation mse = 0.013405
Model 0 best validation rmse = 0.113395 on epoch 58
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.507135
Model 0 test r2 = -5.103270
Model 0 test mse = 0.257186
Ensemble test rmse = 0.507135
Ensemble test r2 = -5.103270
Ensemble test mse = 0.257186
Fold 2
Splitting data with seed 2
Total size = 971 | train size = 776 | val size = 195 | test size = 51
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.6959e-01, PNorm = 34.0150, GNorm = 7.0417, lr_0 = 4.3000e-04
Validation rmse = 0.274114
Validation r2 = 0.325508
Validation mse = 0.075138
Epoch 1
Loss = 5.9191e-01, PNorm = 34.0516, GNorm = 1.1218, lr_0 = 7.6000e-04
Loss = 6.2700e-01, PNorm = 34.0970, GNorm = 1.9609, lr_0 = 9.9472e-04
Validation rmse = 0.247442
Validation r2 = 0.450382
Validation mse = 0.061227
Epoch 2
Loss = 4.5437e-01, PNorm = 34.1478, GNorm = 0.7096, lr_0 = 9.6874e-04
Validation rmse = 0.214770
Validation r2 = 0.585943
Validation mse = 0.046126
Epoch 3
Loss = 3.0723e-01, PNorm = 34.2134, GNorm = 3.6437, lr_0 = 9.4094e-04
Loss = 3.5520e-01, PNorm = 34.2728, GNorm = 1.1844, lr_0 = 9.1637e-04
Validation rmse = 0.186953
Validation r2 = 0.686252
Validation mse = 0.034952
Epoch 4
Loss = 2.8821e-01, PNorm = 34.3300, GNorm = 7.8321, lr_0 = 8.9243e-04
Validation rmse = 0.170823
Validation r2 = 0.738056
Validation mse = 0.029181
Epoch 5
Loss = 2.6375e-01, PNorm = 34.3860, GNorm = 3.4450, lr_0 = 8.6682e-04
Loss = 2.4917e-01, PNorm = 34.4372, GNorm = 7.1751, lr_0 = 8.4418e-04
Validation rmse = 0.192805
Validation r2 = 0.666303
Validation mse = 0.037174
Epoch 6
Loss = 2.4528e-01, PNorm = 34.4765, GNorm = 3.6008, lr_0 = 8.2213e-04
Validation rmse = 0.180653
Validation r2 = 0.707042
Validation mse = 0.032636
Epoch 7
Loss = 2.6629e-01, PNorm = 34.5199, GNorm = 4.6031, lr_0 = 7.9854e-04
Loss = 2.2413e-01, PNorm = 34.5554, GNorm = 1.0212, lr_0 = 7.7769e-04
Validation rmse = 0.160423
Validation r2 = 0.768981
Validation mse = 0.025736
Epoch 8
Loss = 2.1402e-01, PNorm = 34.5874, GNorm = 1.7773, lr_0 = 7.5737e-04
Validation rmse = 0.148516
Validation r2 = 0.802002
Validation mse = 0.022057
Epoch 9
Loss = 1.9556e-01, PNorm = 34.6247, GNorm = 0.6318, lr_0 = 7.3564e-04
Loss = 2.1005e-01, PNorm = 34.6538, GNorm = 8.9355, lr_0 = 7.1643e-04
Validation rmse = 0.197482
Validation r2 = 0.649917
Validation mse = 0.038999
Epoch 10
Loss = 2.5775e-01, PNorm = 34.6849, GNorm = 10.1676, lr_0 = 6.9772e-04
Loss = 2.1863e-01, PNorm = 34.7127, GNorm = 6.8682, lr_0 = 6.7949e-04
Loss = 2.6784e-01, PNorm = 34.7162, GNorm = 6.0735, lr_0 = 6.7770e-04
Validation rmse = 0.152508
Validation r2 = 0.791214
Validation mse = 0.023259
Epoch 11
Loss = 1.8060e-01, PNorm = 34.7473, GNorm = 3.0459, lr_0 = 6.5999e-04
Validation rmse = 0.151417
Validation r2 = 0.794191
Validation mse = 0.022927
Epoch 12
Loss = 1.5266e-01, PNorm = 34.7697, GNorm = 1.9232, lr_0 = 6.4276e-04
Loss = 1.5661e-01, PNorm = 34.7899, GNorm = 1.1427, lr_0 = 6.2597e-04
Validation rmse = 0.136340
Validation r2 = 0.833138
Validation mse = 0.018588
Epoch 13
Loss = 1.3581e-01, PNorm = 34.8149, GNorm = 2.6997, lr_0 = 6.0801e-04
Validation rmse = 0.145127
Validation r2 = 0.810934
Validation mse = 0.021062
Epoch 14
Loss = 1.4754e-01, PNorm = 34.8309, GNorm = 2.4660, lr_0 = 5.9213e-04
Loss = 1.5030e-01, PNorm = 34.8517, GNorm = 3.0785, lr_0 = 5.7666e-04
Validation rmse = 0.144766
Validation r2 = 0.811873
Validation mse = 0.020957
Epoch 15
Loss = 1.4627e-01, PNorm = 34.8757, GNorm = 4.1112, lr_0 = 5.6011e-04
Validation rmse = 0.142765
Validation r2 = 0.817040
Validation mse = 0.020382
Epoch 16
Loss = 1.6257e-01, PNorm = 34.8954, GNorm = 2.7279, lr_0 = 5.4548e-04
Loss = 1.2242e-01, PNorm = 34.9122, GNorm = 1.5013, lr_0 = 5.3124e-04
Validation rmse = 0.138587
Validation r2 = 0.827590
Validation mse = 0.019206
Epoch 17
Loss = 1.3358e-01, PNorm = 34.9355, GNorm = 2.6676, lr_0 = 5.1599e-04
Validation rmse = 0.138431
Validation r2 = 0.827979
Validation mse = 0.019163
Epoch 18
Loss = 1.7783e-01, PNorm = 34.9542, GNorm = 5.1979, lr_0 = 5.0252e-04
Loss = 1.2582e-01, PNorm = 34.9690, GNorm = 2.5560, lr_0 = 4.8939e-04
Validation rmse = 0.129499
Validation r2 = 0.849461
Validation mse = 0.016770
Epoch 19
Loss = 9.9927e-02, PNorm = 34.9833, GNorm = 1.2870, lr_0 = 4.7535e-04
Loss = 1.4021e-01, PNorm = 35.0025, GNorm = 4.0229, lr_0 = 4.6293e-04
Validation rmse = 0.130281
Validation r2 = 0.847638
Validation mse = 0.016973
Epoch 20
Loss = 1.0753e-01, PNorm = 35.0181, GNorm = 0.6667, lr_0 = 4.5084e-04
Validation rmse = 0.136685
Validation r2 = 0.832291
Validation mse = 0.018683
Epoch 21
Loss = 1.3898e-01, PNorm = 35.0348, GNorm = 2.7084, lr_0 = 4.3790e-04
Loss = 1.2054e-01, PNorm = 35.0519, GNorm = 1.3655, lr_0 = 4.2647e-04
Validation rmse = 0.124784
Validation r2 = 0.860225
Validation mse = 0.015571
Epoch 22
Loss = 1.0787e-01, PNorm = 35.0686, GNorm = 1.1219, lr_0 = 4.1533e-04
Validation rmse = 0.127848
Validation r2 = 0.853275
Validation mse = 0.016345
Epoch 23
Loss = 1.0692e-01, PNorm = 35.0829, GNorm = 1.4212, lr_0 = 4.0341e-04
Loss = 1.0802e-01, PNorm = 35.0956, GNorm = 0.5893, lr_0 = 3.9287e-04
Validation rmse = 0.128759
Validation r2 = 0.851177
Validation mse = 0.016579
Epoch 24
Loss = 1.0461e-01, PNorm = 35.1083, GNorm = 0.7695, lr_0 = 3.8261e-04
Validation rmse = 0.133161
Validation r2 = 0.840827
Validation mse = 0.017732
Epoch 25
Loss = 1.1855e-01, PNorm = 35.1193, GNorm = 0.8361, lr_0 = 3.7262e-04
Loss = 9.8818e-02, PNorm = 35.1312, GNorm = 0.9751, lr_0 = 3.6289e-04
Validation rmse = 0.125367
Validation r2 = 0.858916
Validation mse = 0.015717
Epoch 26
Loss = 1.1037e-01, PNorm = 35.1469, GNorm = 2.6765, lr_0 = 3.5247e-04
Validation rmse = 0.124004
Validation r2 = 0.861967
Validation mse = 0.015377
Epoch 27
Loss = 1.5895e-01, PNorm = 35.1583, GNorm = 3.3088, lr_0 = 3.4327e-04
Loss = 9.1076e-02, PNorm = 35.1665, GNorm = 1.1693, lr_0 = 3.3430e-04
Validation rmse = 0.126171
Validation r2 = 0.857100
Validation mse = 0.015919
Epoch 28
Loss = 1.1060e-01, PNorm = 35.1800, GNorm = 1.4763, lr_0 = 3.2471e-04
Loss = 9.9138e-02, PNorm = 35.1919, GNorm = 3.1449, lr_0 = 3.1623e-04
Validation rmse = 0.131425
Validation r2 = 0.844951
Validation mse = 0.017272
Epoch 29
Loss = 1.0773e-01, PNorm = 35.2012, GNorm = 4.7471, lr_0 = 3.0797e-04
Validation rmse = 0.131935
Validation r2 = 0.843744
Validation mse = 0.017407
Epoch 30
Loss = 8.9457e-02, PNorm = 35.2118, GNorm = 0.7448, lr_0 = 2.9913e-04
Loss = 1.0537e-01, PNorm = 35.2228, GNorm = 2.4690, lr_0 = 2.9132e-04
Validation rmse = 0.126855
Validation r2 = 0.855546
Validation mse = 0.016092
Epoch 31
Loss = 8.9965e-02, PNorm = 35.2320, GNorm = 0.6239, lr_0 = 2.8371e-04
Validation rmse = 0.125304
Validation r2 = 0.859057
Validation mse = 0.015701
Epoch 32
Loss = 9.9025e-02, PNorm = 35.2429, GNorm = 2.8498, lr_0 = 2.7557e-04
Loss = 1.0028e-01, PNorm = 35.2515, GNorm = 0.8774, lr_0 = 2.6837e-04
Validation rmse = 0.124806
Validation r2 = 0.860175
Validation mse = 0.015577
Epoch 33
Loss = 9.4140e-02, PNorm = 35.2589, GNorm = 2.0557, lr_0 = 2.6136e-04
Validation rmse = 0.128067
Validation r2 = 0.852772
Validation mse = 0.016401
Epoch 34
Loss = 9.1801e-02, PNorm = 35.2687, GNorm = 2.2181, lr_0 = 2.5386e-04
Loss = 8.7025e-02, PNorm = 35.2767, GNorm = 1.0443, lr_0 = 2.4723e-04
Validation rmse = 0.136126
Validation r2 = 0.833661
Validation mse = 0.018530
Epoch 35
Loss = 9.4140e-02, PNorm = 35.2860, GNorm = 2.4678, lr_0 = 2.4077e-04
Validation rmse = 0.128835
Validation r2 = 0.851002
Validation mse = 0.016598
Epoch 36
Loss = 1.0511e-01, PNorm = 35.2937, GNorm = 1.6788, lr_0 = 2.3387e-04
Loss = 8.4894e-02, PNorm = 35.3014, GNorm = 1.1836, lr_0 = 2.2776e-04
Validation rmse = 0.129497
Validation r2 = 0.849466
Validation mse = 0.016769
Epoch 37
Loss = 1.0266e-01, PNorm = 35.3094, GNorm = 1.9723, lr_0 = 2.2181e-04
Validation rmse = 0.124152
Validation r2 = 0.861636
Validation mse = 0.015414
Epoch 38
Loss = 1.1584e-01, PNorm = 35.3175, GNorm = 0.7808, lr_0 = 2.1544e-04
Loss = 8.5247e-02, PNorm = 35.3244, GNorm = 0.7608, lr_0 = 2.0982e-04
Validation rmse = 0.130280
Validation r2 = 0.847640
Validation mse = 0.016973
Epoch 39
Loss = 9.7338e-02, PNorm = 35.3302, GNorm = 5.5104, lr_0 = 2.0434e-04
Loss = 9.4897e-02, PNorm = 35.3367, GNorm = 0.9011, lr_0 = 1.9900e-04
Loss = 9.1019e-02, PNorm = 35.3377, GNorm = 1.5788, lr_0 = 1.9847e-04
Validation rmse = 0.124704
Validation r2 = 0.860403
Validation mse = 0.015551
Epoch 40
Loss = 7.2119e-02, PNorm = 35.3435, GNorm = 0.6728, lr_0 = 1.9329e-04
Validation rmse = 0.127302
Validation r2 = 0.854526
Validation mse = 0.016206
Epoch 41
Loss = 1.0000e-01, PNorm = 35.3495, GNorm = 0.8721, lr_0 = 1.8824e-04
Loss = 8.5980e-02, PNorm = 35.3567, GNorm = 0.8749, lr_0 = 1.8332e-04
Validation rmse = 0.127199
Validation r2 = 0.854762
Validation mse = 0.016180
Epoch 42
Loss = 7.9224e-02, PNorm = 35.3627, GNorm = 0.6433, lr_0 = 1.7806e-04
Validation rmse = 0.127088
Validation r2 = 0.855016
Validation mse = 0.016151
Epoch 43
Loss = 1.0272e-01, PNorm = 35.3688, GNorm = 2.0139, lr_0 = 1.7341e-04
Loss = 8.4986e-02, PNorm = 35.3751, GNorm = 2.6960, lr_0 = 1.6888e-04
Validation rmse = 0.125389
Validation r2 = 0.858866
Validation mse = 0.015722
Epoch 44
Loss = 8.6929e-02, PNorm = 35.3801, GNorm = 0.6524, lr_0 = 1.6404e-04
Validation rmse = 0.128271
Validation r2 = 0.852303
Validation mse = 0.016453
Epoch 45
Loss = 8.0321e-02, PNorm = 35.3848, GNorm = 0.5272, lr_0 = 1.5975e-04
Loss = 9.0350e-02, PNorm = 35.3912, GNorm = 1.2206, lr_0 = 1.5558e-04
Validation rmse = 0.125975
Validation r2 = 0.857543
Validation mse = 0.015870
Epoch 46
Loss = 9.7661e-02, PNorm = 35.3964, GNorm = 2.8842, lr_0 = 1.5112e-04
Validation rmse = 0.125701
Validation r2 = 0.858162
Validation mse = 0.015801
Epoch 47
Loss = 5.9732e-02, PNorm = 35.4012, GNorm = 1.0634, lr_0 = 1.4717e-04
Loss = 8.3818e-02, PNorm = 35.4053, GNorm = 2.3732, lr_0 = 1.4332e-04
Validation rmse = 0.126003
Validation r2 = 0.857479
Validation mse = 0.015877
Epoch 48
Loss = 8.1050e-02, PNorm = 35.4113, GNorm = 0.9177, lr_0 = 1.3921e-04
Loss = 8.7363e-02, PNorm = 35.4145, GNorm = 2.1587, lr_0 = 1.3558e-04
Validation rmse = 0.127087
Validation r2 = 0.855017
Validation mse = 0.016151
Epoch 49
Loss = 7.7799e-02, PNorm = 35.4190, GNorm = 1.3182, lr_0 = 1.3204e-04
Validation rmse = 0.125089
Validation r2 = 0.859541
Validation mse = 0.015647
Epoch 50
Loss = 7.3110e-02, PNorm = 35.4237, GNorm = 1.1488, lr_0 = 1.2859e-04
Loss = 8.6798e-02, PNorm = 35.4272, GNorm = 2.4536, lr_0 = 1.2523e-04
Validation rmse = 0.127437
Validation r2 = 0.854218
Validation mse = 0.016240
Epoch 51
Loss = 8.7198e-02, PNorm = 35.4320, GNorm = 1.1649, lr_0 = 1.2163e-04
Validation rmse = 0.125857
Validation r2 = 0.857810
Validation mse = 0.015840
Epoch 52
Loss = 8.1335e-02, PNorm = 35.4350, GNorm = 0.7657, lr_0 = 1.1846e-04
Loss = 8.4856e-02, PNorm = 35.4382, GNorm = 1.1162, lr_0 = 1.1536e-04
Validation rmse = 0.124703
Validation r2 = 0.860405
Validation mse = 0.015551
Epoch 53
Loss = 8.6884e-02, PNorm = 35.4418, GNorm = 1.7869, lr_0 = 1.1205e-04
Validation rmse = 0.125233
Validation r2 = 0.859217
Validation mse = 0.015683
Epoch 54
Loss = 9.4613e-02, PNorm = 35.4459, GNorm = 0.6056, lr_0 = 1.0913e-04
Loss = 8.8108e-02, PNorm = 35.4493, GNorm = 4.3961, lr_0 = 1.0628e-04
Validation rmse = 0.127631
Validation r2 = 0.853772
Validation mse = 0.016290
Epoch 55
Loss = 6.8751e-02, PNorm = 35.4526, GNorm = 1.8465, lr_0 = 1.0323e-04
Validation rmse = 0.127759
Validation r2 = 0.853481
Validation mse = 0.016322
Epoch 56
Loss = 1.3116e-01, PNorm = 35.4554, GNorm = 0.8923, lr_0 = 1.0053e-04
Loss = 7.6958e-02, PNorm = 35.4589, GNorm = 2.3727, lr_0 = 1.0000e-04
Validation rmse = 0.125667
Validation r2 = 0.858238
Validation mse = 0.015792
Epoch 57
Loss = 7.1768e-02, PNorm = 35.4627, GNorm = 1.2031, lr_0 = 1.0000e-04
Loss = 8.8706e-02, PNorm = 35.4664, GNorm = 1.5640, lr_0 = 1.0000e-04
Validation rmse = 0.125577
Validation r2 = 0.858442
Validation mse = 0.015770
Epoch 58
Loss = 8.0717e-02, PNorm = 35.4694, GNorm = 0.5779, lr_0 = 1.0000e-04
Validation rmse = 0.129764
Validation r2 = 0.848845
Validation mse = 0.016839
Epoch 59
Loss = 7.5127e-02, PNorm = 35.4721, GNorm = 1.1963, lr_0 = 1.0000e-04
Loss = 8.4311e-02, PNorm = 35.4757, GNorm = 1.1505, lr_0 = 1.0000e-04
Validation rmse = 0.124508
Validation r2 = 0.860841
Validation mse = 0.015502
Model 0 best validation rmse = 0.124004 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.455541
Model 0 test r2 = -3.924606
Model 0 test mse = 0.207518
Ensemble test rmse = 0.455541
Ensemble test r2 = -3.924606
Ensemble test mse = 0.207518
Fold 3
Splitting data with seed 3
Total size = 971 | train size = 776 | val size = 195 | test size = 51
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.8168e-01, PNorm = 34.0151, GNorm = 7.1947, lr_0 = 4.3000e-04
Validation rmse = 0.294765
Validation r2 = 0.225185
Validation mse = 0.086886
Epoch 1
Loss = 8.7347e-01, PNorm = 34.0351, GNorm = 1.3942, lr_0 = 7.6000e-04
Loss = 6.0949e-01, PNorm = 34.0850, GNorm = 1.1926, lr_0 = 9.9472e-04
Validation rmse = 0.234262
Validation r2 = 0.510615
Validation mse = 0.054879
Epoch 2
Loss = 4.9001e-01, PNorm = 34.1516, GNorm = 7.8765, lr_0 = 9.6874e-04
Validation rmse = 0.201330
Validation r2 = 0.638538
Validation mse = 0.040534
Epoch 3
Loss = 4.0705e-01, PNorm = 34.2272, GNorm = 5.5816, lr_0 = 9.4094e-04
Loss = 3.3737e-01, PNorm = 34.2871, GNorm = 2.7210, lr_0 = 9.1637e-04
Validation rmse = 0.187122
Validation r2 = 0.687753
Validation mse = 0.035015
Epoch 4
Loss = 2.7314e-01, PNorm = 34.3530, GNorm = 1.0975, lr_0 = 8.9243e-04
Validation rmse = 0.188518
Validation r2 = 0.683079
Validation mse = 0.035539
Epoch 5
Loss = 2.6223e-01, PNorm = 34.4047, GNorm = 2.8827, lr_0 = 8.6682e-04
Loss = 3.3922e-01, PNorm = 34.4479, GNorm = 5.7515, lr_0 = 8.4418e-04
Validation rmse = 0.168147
Validation r2 = 0.747869
Validation mse = 0.028274
Epoch 6
Loss = 2.0575e-01, PNorm = 34.4889, GNorm = 5.2652, lr_0 = 8.2213e-04
Validation rmse = 0.186836
Validation r2 = 0.688708
Validation mse = 0.034908
Epoch 7
Loss = 2.2649e-01, PNorm = 34.5350, GNorm = 1.9136, lr_0 = 7.9854e-04
Loss = 2.3565e-01, PNorm = 34.5706, GNorm = 5.6704, lr_0 = 7.7769e-04
Validation rmse = 0.148084
Validation r2 = 0.804448
Validation mse = 0.021929
Epoch 8
Loss = 2.0313e-01, PNorm = 34.6087, GNorm = 6.6324, lr_0 = 7.5737e-04
Validation rmse = 0.144944
Validation r2 = 0.812653
Validation mse = 0.021009
Epoch 9
Loss = 1.9592e-01, PNorm = 34.6473, GNorm = 4.5562, lr_0 = 7.3564e-04
Loss = 1.8196e-01, PNorm = 34.6806, GNorm = 1.4848, lr_0 = 7.1643e-04
Validation rmse = 0.139566
Validation r2 = 0.826297
Validation mse = 0.019479
Epoch 10
Loss = 1.7984e-01, PNorm = 34.7017, GNorm = 1.4582, lr_0 = 6.9772e-04
Loss = 2.0828e-01, PNorm = 34.7323, GNorm = 2.1211, lr_0 = 6.7949e-04
Loss = 3.2279e-01, PNorm = 34.7353, GNorm = 5.0534, lr_0 = 6.7770e-04
Validation rmse = 0.147006
Validation r2 = 0.807285
Validation mse = 0.021611
Epoch 11
Loss = 1.6734e-01, PNorm = 34.7609, GNorm = 5.3347, lr_0 = 6.5999e-04
Validation rmse = 0.136238
Validation r2 = 0.834483
Validation mse = 0.018561
Epoch 12
Loss = 1.5052e-01, PNorm = 34.7881, GNorm = 1.2575, lr_0 = 6.4276e-04
Loss = 1.5664e-01, PNorm = 34.8173, GNorm = 1.0841, lr_0 = 6.2597e-04
Validation rmse = 0.137573
Validation r2 = 0.831222
Validation mse = 0.018926
Epoch 13
Loss = 1.5674e-01, PNorm = 34.8403, GNorm = 3.9483, lr_0 = 6.0801e-04
Validation rmse = 0.131676
Validation r2 = 0.845382
Validation mse = 0.017339
Epoch 14
Loss = 1.4157e-01, PNorm = 34.8646, GNorm = 4.7847, lr_0 = 5.9213e-04
Loss = 1.4416e-01, PNorm = 34.8854, GNorm = 1.3443, lr_0 = 5.7666e-04
Validation rmse = 0.138220
Validation r2 = 0.829632
Validation mse = 0.019105
Epoch 15
Loss = 1.5151e-01, PNorm = 34.9098, GNorm = 3.2005, lr_0 = 5.6011e-04
Validation rmse = 0.132388
Validation r2 = 0.843705
Validation mse = 0.017527
Epoch 16
Loss = 1.6737e-01, PNorm = 34.9303, GNorm = 1.7533, lr_0 = 5.4548e-04
Loss = 1.3995e-01, PNorm = 34.9509, GNorm = 1.2907, lr_0 = 5.3124e-04
Validation rmse = 0.139629
Validation r2 = 0.826140
Validation mse = 0.019496
Epoch 17
Loss = 1.5594e-01, PNorm = 34.9717, GNorm = 2.9152, lr_0 = 5.1599e-04
Validation rmse = 0.132401
Validation r2 = 0.843674
Validation mse = 0.017530
Epoch 18
Loss = 1.0788e-01, PNorm = 34.9901, GNorm = 2.8439, lr_0 = 5.0252e-04
Loss = 1.2792e-01, PNorm = 35.0077, GNorm = 2.8415, lr_0 = 4.8939e-04
Validation rmse = 0.126623
Validation r2 = 0.857020
Validation mse = 0.016033
Epoch 19
Loss = 1.2673e-01, PNorm = 35.0253, GNorm = 1.3028, lr_0 = 4.7535e-04
Loss = 1.1350e-01, PNorm = 35.0409, GNorm = 1.3073, lr_0 = 4.6293e-04
Validation rmse = 0.124939
Validation r2 = 0.860799
Validation mse = 0.015610
Epoch 20
Loss = 1.1505e-01, PNorm = 35.0525, GNorm = 2.1527, lr_0 = 4.5084e-04
Validation rmse = 0.127844
Validation r2 = 0.854250
Validation mse = 0.016344
Epoch 21
Loss = 1.1407e-01, PNorm = 35.0720, GNorm = 0.4653, lr_0 = 4.3790e-04
Loss = 1.0900e-01, PNorm = 35.0874, GNorm = 2.1482, lr_0 = 4.2647e-04
Validation rmse = 0.124178
Validation r2 = 0.862490
Validation mse = 0.015420
Epoch 22
Loss = 1.1294e-01, PNorm = 35.1021, GNorm = 0.8318, lr_0 = 4.1533e-04
Validation rmse = 0.127258
Validation r2 = 0.855583
Validation mse = 0.016195
Epoch 23
Loss = 1.0925e-01, PNorm = 35.1156, GNorm = 1.3764, lr_0 = 4.0341e-04
Loss = 1.0309e-01, PNorm = 35.1287, GNorm = 3.1991, lr_0 = 3.9287e-04
Validation rmse = 0.127450
Validation r2 = 0.855147
Validation mse = 0.016244
Epoch 24
Loss = 1.1230e-01, PNorm = 35.1426, GNorm = 3.9964, lr_0 = 3.8261e-04
Validation rmse = 0.131167
Validation r2 = 0.846575
Validation mse = 0.017205
Epoch 25
Loss = 9.6574e-02, PNorm = 35.1544, GNorm = 1.1491, lr_0 = 3.7262e-04
Loss = 1.1259e-01, PNorm = 35.1657, GNorm = 2.5031, lr_0 = 3.6289e-04
Validation rmse = 0.125710
Validation r2 = 0.859074
Validation mse = 0.015803
Epoch 26
Loss = 1.1376e-01, PNorm = 35.1827, GNorm = 3.7944, lr_0 = 3.5247e-04
Validation rmse = 0.131310
Validation r2 = 0.846241
Validation mse = 0.017242
Epoch 27
Loss = 1.0253e-01, PNorm = 35.1932, GNorm = 3.6121, lr_0 = 3.4327e-04
Loss = 1.0733e-01, PNorm = 35.2028, GNorm = 1.8202, lr_0 = 3.3430e-04
Validation rmse = 0.122238
Validation r2 = 0.866751
Validation mse = 0.014942
Epoch 28
Loss = 1.0147e-01, PNorm = 35.2149, GNorm = 2.7842, lr_0 = 3.2471e-04
Loss = 1.0540e-01, PNorm = 35.2246, GNorm = 2.4626, lr_0 = 3.1623e-04
Validation rmse = 0.126227
Validation r2 = 0.857915
Validation mse = 0.015933
Epoch 29
Loss = 9.7146e-02, PNorm = 35.2360, GNorm = 1.9317, lr_0 = 3.0797e-04
Validation rmse = 0.120659
Validation r2 = 0.870173
Validation mse = 0.014559
Epoch 30
Loss = 1.1615e-01, PNorm = 35.2464, GNorm = 0.9481, lr_0 = 2.9913e-04
Loss = 9.1729e-02, PNorm = 35.2571, GNorm = 1.6451, lr_0 = 2.9132e-04
Validation rmse = 0.122404
Validation r2 = 0.866391
Validation mse = 0.014983
Epoch 31
Loss = 1.0773e-01, PNorm = 35.2671, GNorm = 1.9821, lr_0 = 2.8371e-04
Validation rmse = 0.122888
Validation r2 = 0.865332
Validation mse = 0.015101
Epoch 32
Loss = 1.0043e-01, PNorm = 35.2760, GNorm = 1.4085, lr_0 = 2.7557e-04
Loss = 9.9553e-02, PNorm = 35.2849, GNorm = 2.0795, lr_0 = 2.6837e-04
Validation rmse = 0.120401
Validation r2 = 0.870727
Validation mse = 0.014496
Epoch 33
Loss = 8.8223e-02, PNorm = 35.2935, GNorm = 0.4785, lr_0 = 2.6136e-04
Validation rmse = 0.120813
Validation r2 = 0.869841
Validation mse = 0.014596
Epoch 34
Loss = 1.0285e-01, PNorm = 35.3028, GNorm = 2.1153, lr_0 = 2.5386e-04
Loss = 1.0234e-01, PNorm = 35.3105, GNorm = 1.4888, lr_0 = 2.4723e-04
Validation rmse = 0.128983
Validation r2 = 0.851642
Validation mse = 0.016637
Epoch 35
Loss = 1.0522e-01, PNorm = 35.3185, GNorm = 1.3000, lr_0 = 2.4077e-04
Validation rmse = 0.118693
Validation r2 = 0.874368
Validation mse = 0.014088
Epoch 36
Loss = 1.0742e-01, PNorm = 35.3275, GNorm = 1.7231, lr_0 = 2.3387e-04
Loss = 8.8635e-02, PNorm = 35.3345, GNorm = 1.4705, lr_0 = 2.2776e-04
Validation rmse = 0.120568
Validation r2 = 0.870367
Validation mse = 0.014537
Epoch 37
Loss = 9.1156e-02, PNorm = 35.3398, GNorm = 1.4826, lr_0 = 2.2181e-04
Validation rmse = 0.119843
Validation r2 = 0.871922
Validation mse = 0.014362
Epoch 38
Loss = 1.3966e-01, PNorm = 35.3471, GNorm = 1.1892, lr_0 = 2.1544e-04
Loss = 8.8696e-02, PNorm = 35.3536, GNorm = 2.5836, lr_0 = 2.0982e-04
Validation rmse = 0.119072
Validation r2 = 0.873565
Validation mse = 0.014178
Epoch 39
Loss = 9.5609e-02, PNorm = 35.3596, GNorm = 0.8784, lr_0 = 2.0434e-04
Loss = 8.7340e-02, PNorm = 35.3657, GNorm = 0.7379, lr_0 = 1.9900e-04
Loss = 7.4365e-02, PNorm = 35.3664, GNorm = 1.6699, lr_0 = 1.9847e-04
Validation rmse = 0.119465
Validation r2 = 0.872730
Validation mse = 0.014272
Epoch 40
Loss = 9.1913e-02, PNorm = 35.3721, GNorm = 1.0001, lr_0 = 1.9329e-04
Validation rmse = 0.119433
Validation r2 = 0.872797
Validation mse = 0.014264
Epoch 41
Loss = 1.1322e-01, PNorm = 35.3780, GNorm = 3.1608, lr_0 = 1.8824e-04
Loss = 8.1263e-02, PNorm = 35.3840, GNorm = 1.4949, lr_0 = 1.8332e-04
Validation rmse = 0.119578
Validation r2 = 0.872489
Validation mse = 0.014299
Epoch 42
Loss = 9.0368e-02, PNorm = 35.3899, GNorm = 4.7749, lr_0 = 1.7806e-04
Validation rmse = 0.120371
Validation r2 = 0.870791
Validation mse = 0.014489
Epoch 43
Loss = 7.1648e-02, PNorm = 35.3946, GNorm = 1.4679, lr_0 = 1.7341e-04
Loss = 9.1478e-02, PNorm = 35.3996, GNorm = 0.7709, lr_0 = 1.6888e-04
Validation rmse = 0.118283
Validation r2 = 0.875235
Validation mse = 0.013991
Epoch 44
Loss = 9.9030e-02, PNorm = 35.4066, GNorm = 1.1581, lr_0 = 1.6404e-04
Validation rmse = 0.120654
Validation r2 = 0.870183
Validation mse = 0.014557
Epoch 45
Loss = 1.0604e-01, PNorm = 35.4110, GNorm = 0.7442, lr_0 = 1.5975e-04
Loss = 8.7579e-02, PNorm = 35.4157, GNorm = 1.1446, lr_0 = 1.5558e-04
Validation rmse = 0.123719
Validation r2 = 0.863504
Validation mse = 0.015306
Epoch 46
Loss = 1.0769e-01, PNorm = 35.4204, GNorm = 3.4094, lr_0 = 1.5112e-04
Validation rmse = 0.120477
Validation r2 = 0.870564
Validation mse = 0.014515
Epoch 47
Loss = 7.6285e-02, PNorm = 35.4252, GNorm = 2.5753, lr_0 = 1.4717e-04
Loss = 7.9896e-02, PNorm = 35.4300, GNorm = 0.7430, lr_0 = 1.4332e-04
Validation rmse = 0.118829
Validation r2 = 0.874081
Validation mse = 0.014120
Epoch 48
Loss = 8.8720e-02, PNorm = 35.4348, GNorm = 0.7500, lr_0 = 1.3921e-04
Loss = 8.1536e-02, PNorm = 35.4386, GNorm = 1.4271, lr_0 = 1.3558e-04
Validation rmse = 0.117910
Validation r2 = 0.876021
Validation mse = 0.013903
Epoch 49
Loss = 7.4389e-02, PNorm = 35.4426, GNorm = 1.5207, lr_0 = 1.3204e-04
Validation rmse = 0.118883
Validation r2 = 0.873966
Validation mse = 0.014133
Epoch 50
Loss = 8.2535e-02, PNorm = 35.4468, GNorm = 1.2545, lr_0 = 1.2859e-04
Loss = 8.8131e-02, PNorm = 35.4505, GNorm = 1.0283, lr_0 = 1.2523e-04
Validation rmse = 0.118040
Validation r2 = 0.875747
Validation mse = 0.013934
Epoch 51
Loss = 8.0660e-02, PNorm = 35.4556, GNorm = 1.4318, lr_0 = 1.2163e-04
Validation rmse = 0.119596
Validation r2 = 0.872449
Validation mse = 0.014303
Epoch 52
Loss = 8.2917e-02, PNorm = 35.4590, GNorm = 1.8972, lr_0 = 1.1846e-04
Loss = 8.9745e-02, PNorm = 35.4622, GNorm = 1.0879, lr_0 = 1.1536e-04
Validation rmse = 0.118792
Validation r2 = 0.874159
Validation mse = 0.014112
Epoch 53
Loss = 9.0840e-02, PNorm = 35.4657, GNorm = 1.7909, lr_0 = 1.1205e-04
Validation rmse = 0.117970
Validation r2 = 0.875895
Validation mse = 0.013917
Epoch 54
Loss = 1.1374e-01, PNorm = 35.4694, GNorm = 1.4179, lr_0 = 1.0913e-04
Loss = 7.0239e-02, PNorm = 35.4721, GNorm = 0.9347, lr_0 = 1.0628e-04
Validation rmse = 0.118102
Validation r2 = 0.875617
Validation mse = 0.013948
Epoch 55
Loss = 7.7702e-02, PNorm = 35.4756, GNorm = 1.0089, lr_0 = 1.0323e-04
Validation rmse = 0.119028
Validation r2 = 0.873658
Validation mse = 0.014168
Epoch 56
Loss = 5.6827e-02, PNorm = 35.4789, GNorm = 0.7659, lr_0 = 1.0053e-04
Loss = 8.1406e-02, PNorm = 35.4809, GNorm = 1.3632, lr_0 = 1.0000e-04
Validation rmse = 0.118006
Validation r2 = 0.875819
Validation mse = 0.013925
Epoch 57
Loss = 7.9970e-02, PNorm = 35.4846, GNorm = 1.0246, lr_0 = 1.0000e-04
Loss = 8.2242e-02, PNorm = 35.4880, GNorm = 1.4667, lr_0 = 1.0000e-04
Validation rmse = 0.117806
Validation r2 = 0.876240
Validation mse = 0.013878
Epoch 58
Loss = 7.9960e-02, PNorm = 35.4908, GNorm = 2.4207, lr_0 = 1.0000e-04
Validation rmse = 0.117795
Validation r2 = 0.876262
Validation mse = 0.013876
Epoch 59
Loss = 1.0335e-01, PNorm = 35.4941, GNorm = 1.0750, lr_0 = 1.0000e-04
Loss = 7.0033e-02, PNorm = 35.4974, GNorm = 1.2786, lr_0 = 1.0000e-04
Validation rmse = 0.118069
Validation r2 = 0.875686
Validation mse = 0.013940
Model 0 best validation rmse = 0.117795 on epoch 58
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.457542
Model 0 test r2 = -3.967960
Model 0 test mse = 0.209345
Ensemble test rmse = 0.457542
Ensemble test r2 = -3.967960
Ensemble test mse = 0.209345
Fold 4
Splitting data with seed 4
Total size = 971 | train size = 776 | val size = 195 | test size = 51
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.3979e-01, PNorm = 34.0168, GNorm = 2.6001, lr_0 = 4.3000e-04
Validation rmse = 0.300557
Validation r2 = 0.257415
Validation mse = 0.090335
Epoch 1
Loss = 6.6453e-01, PNorm = 34.0527, GNorm = 1.3400, lr_0 = 7.6000e-04
Loss = 5.6132e-01, PNorm = 34.0986, GNorm = 3.5178, lr_0 = 9.9472e-04
Validation rmse = 0.261872
Validation r2 = 0.436272
Validation mse = 0.068577
Epoch 2
Loss = 4.4611e-01, PNorm = 34.1541, GNorm = 1.9573, lr_0 = 9.6874e-04
Validation rmse = 0.222084
Validation r2 = 0.594559
Validation mse = 0.049321
Epoch 3
Loss = 3.7440e-01, PNorm = 34.2231, GNorm = 8.7777, lr_0 = 9.4094e-04
Loss = 3.8859e-01, PNorm = 34.2832, GNorm = 7.9145, lr_0 = 9.1637e-04
Validation rmse = 0.221509
Validation r2 = 0.596658
Validation mse = 0.049066
Epoch 4
Loss = 3.4954e-01, PNorm = 34.3338, GNorm = 3.4270, lr_0 = 8.9243e-04
Validation rmse = 0.204084
Validation r2 = 0.657620
Validation mse = 0.041650
Epoch 5
Loss = 2.4404e-01, PNorm = 34.3811, GNorm = 1.5905, lr_0 = 8.6682e-04
Loss = 2.3645e-01, PNorm = 34.4287, GNorm = 2.2273, lr_0 = 8.4418e-04
Validation rmse = 0.184698
Validation r2 = 0.719577
Validation mse = 0.034113
Epoch 6
Loss = 2.2756e-01, PNorm = 34.4823, GNorm = 3.7942, lr_0 = 8.2213e-04
Validation rmse = 0.189243
Validation r2 = 0.705604
Validation mse = 0.035813
Epoch 7
Loss = 2.0948e-01, PNorm = 34.5297, GNorm = 1.7820, lr_0 = 7.9854e-04
Loss = 2.4351e-01, PNorm = 34.5731, GNorm = 6.9818, lr_0 = 7.7769e-04
Validation rmse = 0.168648
Validation r2 = 0.766194
Validation mse = 0.028442
Epoch 8
Loss = 2.2201e-01, PNorm = 34.6135, GNorm = 8.0091, lr_0 = 7.5737e-04
Validation rmse = 0.170564
Validation r2 = 0.760852
Validation mse = 0.029092
Epoch 9
Loss = 1.9246e-01, PNorm = 34.6497, GNorm = 5.8690, lr_0 = 7.3564e-04
Loss = 1.6960e-01, PNorm = 34.6792, GNorm = 3.0471, lr_0 = 7.1643e-04
Validation rmse = 0.168489
Validation r2 = 0.766636
Validation mse = 0.028388
Epoch 10
Loss = 1.8336e-01, PNorm = 34.7121, GNorm = 1.5785, lr_0 = 6.9772e-04
Loss = 1.4479e-01, PNorm = 34.7477, GNorm = 2.7598, lr_0 = 6.7949e-04
Loss = 1.7750e-01, PNorm = 34.7504, GNorm = 1.2597, lr_0 = 6.7770e-04
Validation rmse = 0.158406
Validation r2 = 0.793730
Validation mse = 0.025093
Epoch 11
Loss = 1.5941e-01, PNorm = 34.7729, GNorm = 2.1057, lr_0 = 6.5999e-04
Validation rmse = 0.154622
Validation r2 = 0.803469
Validation mse = 0.023908
Epoch 12
Loss = 1.6269e-01, PNorm = 34.8035, GNorm = 3.4531, lr_0 = 6.4276e-04
Loss = 1.1561e-01, PNorm = 34.8321, GNorm = 0.7160, lr_0 = 6.2597e-04
Validation rmse = 0.154073
Validation r2 = 0.804861
Validation mse = 0.023738
Epoch 13
Loss = 1.4458e-01, PNorm = 34.8504, GNorm = 4.6365, lr_0 = 6.0801e-04
Validation rmse = 0.151995
Validation r2 = 0.810088
Validation mse = 0.023103
Epoch 14
Loss = 1.1234e-01, PNorm = 34.8720, GNorm = 3.1681, lr_0 = 5.9213e-04
Loss = 1.3746e-01, PNorm = 34.8958, GNorm = 2.8220, lr_0 = 5.7666e-04
Validation rmse = 0.151615
Validation r2 = 0.811038
Validation mse = 0.022987
Epoch 15
Loss = 1.1255e-01, PNorm = 34.9185, GNorm = 3.0359, lr_0 = 5.6011e-04
Validation rmse = 0.158296
Validation r2 = 0.794016
Validation mse = 0.025058
Epoch 16
Loss = 1.3724e-01, PNorm = 34.9384, GNorm = 2.7228, lr_0 = 5.4548e-04
Loss = 1.0591e-01, PNorm = 34.9570, GNorm = 1.2111, lr_0 = 5.3124e-04
Validation rmse = 0.162310
Validation r2 = 0.783439
Validation mse = 0.026344
Epoch 17
Loss = 1.3479e-01, PNorm = 34.9762, GNorm = 5.3595, lr_0 = 5.1599e-04
Validation rmse = 0.160008
Validation r2 = 0.789537
Validation mse = 0.025603
Epoch 18
Loss = 1.4167e-01, PNorm = 34.9948, GNorm = 6.3908, lr_0 = 5.0252e-04
Loss = 1.1709e-01, PNorm = 35.0155, GNorm = 0.8667, lr_0 = 4.8939e-04
Validation rmse = 0.157761
Validation r2 = 0.795408
Validation mse = 0.024888
Epoch 19
Loss = 1.0804e-01, PNorm = 35.0302, GNorm = 5.0819, lr_0 = 4.7535e-04
Loss = 1.2796e-01, PNorm = 35.0476, GNorm = 5.4601, lr_0 = 4.6293e-04
Validation rmse = 0.164081
Validation r2 = 0.778686
Validation mse = 0.026923
Epoch 20
Loss = 1.2279e-01, PNorm = 35.0631, GNorm = 1.7973, lr_0 = 4.5084e-04
Validation rmse = 0.152812
Validation r2 = 0.808042
Validation mse = 0.023351
Epoch 21
Loss = 1.0992e-01, PNorm = 35.0805, GNorm = 2.0348, lr_0 = 4.3790e-04
Loss = 8.9733e-02, PNorm = 35.0931, GNorm = 1.8491, lr_0 = 4.2647e-04
Validation rmse = 0.152085
Validation r2 = 0.809864
Validation mse = 0.023130
Epoch 22
Loss = 8.8763e-02, PNorm = 35.1055, GNorm = 4.1017, lr_0 = 4.1533e-04
Validation rmse = 0.151440
Validation r2 = 0.811474
Validation mse = 0.022934
Epoch 23
Loss = 9.1149e-02, PNorm = 35.1189, GNorm = 3.5228, lr_0 = 4.0341e-04
Loss = 1.0214e-01, PNorm = 35.1315, GNorm = 1.0142, lr_0 = 3.9287e-04
Validation rmse = 0.153930
Validation r2 = 0.805224
Validation mse = 0.023694
Epoch 24
Loss = 1.2408e-01, PNorm = 35.1454, GNorm = 4.5140, lr_0 = 3.8261e-04
Validation rmse = 0.151990
Validation r2 = 0.810101
Validation mse = 0.023101
Epoch 25
Loss = 1.1484e-01, PNorm = 35.1548, GNorm = 1.0390, lr_0 = 3.7262e-04
Loss = 1.1568e-01, PNorm = 35.1677, GNorm = 3.6156, lr_0 = 3.6289e-04
Validation rmse = 0.153715
Validation r2 = 0.805767
Validation mse = 0.023628
Epoch 26
Loss = 8.5856e-02, PNorm = 35.1830, GNorm = 1.2056, lr_0 = 3.5247e-04
Validation rmse = 0.152446
Validation r2 = 0.808960
Validation mse = 0.023240
Epoch 27
Loss = 1.1802e-01, PNorm = 35.1955, GNorm = 2.5514, lr_0 = 3.4327e-04
Loss = 9.2243e-02, PNorm = 35.2071, GNorm = 2.4539, lr_0 = 3.3430e-04
Validation rmse = 0.151775
Validation r2 = 0.810638
Validation mse = 0.023036
Epoch 28
Loss = 8.7566e-02, PNorm = 35.2192, GNorm = 1.6220, lr_0 = 3.2471e-04
Loss = 1.0181e-01, PNorm = 35.2287, GNorm = 4.9555, lr_0 = 3.1623e-04
Validation rmse = 0.152798
Validation r2 = 0.808078
Validation mse = 0.023347
Epoch 29
Loss = 9.7420e-02, PNorm = 35.2381, GNorm = 1.5566, lr_0 = 3.0797e-04
Validation rmse = 0.157397
Validation r2 = 0.796349
Validation mse = 0.024774
Epoch 30
Loss = 9.6821e-02, PNorm = 35.2488, GNorm = 0.7158, lr_0 = 2.9913e-04
Loss = 7.8032e-02, PNorm = 35.2558, GNorm = 0.7027, lr_0 = 2.9132e-04
Validation rmse = 0.149967
Validation r2 = 0.815123
Validation mse = 0.022490
Epoch 31
Loss = 8.4026e-02, PNorm = 35.2647, GNorm = 1.5223, lr_0 = 2.8371e-04
Validation rmse = 0.149924
Validation r2 = 0.815230
Validation mse = 0.022477
Epoch 32
Loss = 7.2646e-02, PNorm = 35.2747, GNorm = 0.7559, lr_0 = 2.7557e-04
Loss = 8.8553e-02, PNorm = 35.2827, GNorm = 1.4787, lr_0 = 2.6837e-04
Validation rmse = 0.149265
Validation r2 = 0.816849
Validation mse = 0.022280
Epoch 33
Loss = 7.0128e-02, PNorm = 35.2908, GNorm = 0.5605, lr_0 = 2.6136e-04
Validation rmse = 0.148479
Validation r2 = 0.818774
Validation mse = 0.022046
Epoch 34
Loss = 7.7976e-02, PNorm = 35.2973, GNorm = 1.5574, lr_0 = 2.5386e-04
Loss = 7.9275e-02, PNorm = 35.3051, GNorm = 1.0111, lr_0 = 2.4723e-04
Validation rmse = 0.150991
Validation r2 = 0.812590
Validation mse = 0.022798
Epoch 35
Loss = 7.9519e-02, PNorm = 35.3109, GNorm = 0.9357, lr_0 = 2.4077e-04
Validation rmse = 0.149067
Validation r2 = 0.817334
Validation mse = 0.022221
Epoch 36
Loss = 7.0193e-02, PNorm = 35.3184, GNorm = 0.9558, lr_0 = 2.3387e-04
Loss = 8.5292e-02, PNorm = 35.3258, GNorm = 0.8025, lr_0 = 2.2776e-04
Validation rmse = 0.150158
Validation r2 = 0.814653
Validation mse = 0.022547
Epoch 37
Loss = 9.0474e-02, PNorm = 35.3336, GNorm = 1.3248, lr_0 = 2.2181e-04
Validation rmse = 0.149500
Validation r2 = 0.816272
Validation mse = 0.022350
Epoch 38
Loss = 6.1916e-02, PNorm = 35.3408, GNorm = 0.5243, lr_0 = 2.1544e-04
Loss = 8.2747e-02, PNorm = 35.3471, GNorm = 0.9493, lr_0 = 2.0982e-04
Validation rmse = 0.148909
Validation r2 = 0.817722
Validation mse = 0.022174
Epoch 39
Loss = 6.7316e-02, PNorm = 35.3535, GNorm = 1.1491, lr_0 = 2.0434e-04
Loss = 8.0628e-02, PNorm = 35.3605, GNorm = 1.7925, lr_0 = 1.9900e-04
Loss = 1.4746e-01, PNorm = 35.3607, GNorm = 1.8498, lr_0 = 1.9847e-04
Validation rmse = 0.148945
Validation r2 = 0.817635
Validation mse = 0.022184
Epoch 40
Loss = 8.2556e-02, PNorm = 35.3660, GNorm = 0.9862, lr_0 = 1.9329e-04
Validation rmse = 0.148507
Validation r2 = 0.818705
Validation mse = 0.022054
Epoch 41
Loss = 7.4716e-02, PNorm = 35.3715, GNorm = 1.7106, lr_0 = 1.8824e-04
Loss = 7.4172e-02, PNorm = 35.3768, GNorm = 2.1378, lr_0 = 1.8332e-04
Validation rmse = 0.147816
Validation r2 = 0.820389
Validation mse = 0.021849
Epoch 42
Loss = 8.2685e-02, PNorm = 35.3819, GNorm = 1.9031, lr_0 = 1.7806e-04
Validation rmse = 0.157784
Validation r2 = 0.795346
Validation mse = 0.024896
Epoch 43
Loss = 8.2648e-02, PNorm = 35.3883, GNorm = 1.8719, lr_0 = 1.7341e-04
Loss = 6.7843e-02, PNorm = 35.3940, GNorm = 0.5324, lr_0 = 1.6888e-04
Validation rmse = 0.147410
Validation r2 = 0.821374
Validation mse = 0.021730
Epoch 44
Loss = 7.0490e-02, PNorm = 35.3997, GNorm = 1.5572, lr_0 = 1.6404e-04
Validation rmse = 0.152260
Validation r2 = 0.809425
Validation mse = 0.023183
Epoch 45
Loss = 7.8777e-02, PNorm = 35.4046, GNorm = 5.1273, lr_0 = 1.5975e-04
Loss = 7.9076e-02, PNorm = 35.4090, GNorm = 0.9862, lr_0 = 1.5558e-04
Validation rmse = 0.147874
Validation r2 = 0.820248
Validation mse = 0.021867
Epoch 46
Loss = 5.9743e-02, PNorm = 35.4140, GNorm = 1.7786, lr_0 = 1.5112e-04
Validation rmse = 0.150419
Validation r2 = 0.814007
Validation mse = 0.022626
Epoch 47
Loss = 7.8672e-02, PNorm = 35.4180, GNorm = 1.4282, lr_0 = 1.4717e-04
Loss = 6.8680e-02, PNorm = 35.4230, GNorm = 1.4457, lr_0 = 1.4332e-04
Validation rmse = 0.149270
Validation r2 = 0.816838
Validation mse = 0.022281
Epoch 48
Loss = 7.7614e-02, PNorm = 35.4284, GNorm = 3.8558, lr_0 = 1.3921e-04
Loss = 7.2199e-02, PNorm = 35.4330, GNorm = 1.2544, lr_0 = 1.3558e-04
Validation rmse = 0.147732
Validation r2 = 0.820591
Validation mse = 0.021825
Epoch 49
Loss = 6.8431e-02, PNorm = 35.4370, GNorm = 1.0629, lr_0 = 1.3204e-04
Validation rmse = 0.150328
Validation r2 = 0.814233
Validation mse = 0.022598
Epoch 50
Loss = 9.8428e-02, PNorm = 35.4408, GNorm = 2.6403, lr_0 = 1.2859e-04
Loss = 6.9051e-02, PNorm = 35.4451, GNorm = 2.1124, lr_0 = 1.2523e-04
Validation rmse = 0.149981
Validation r2 = 0.815087
Validation mse = 0.022494
Epoch 51
Loss = 7.7193e-02, PNorm = 35.4495, GNorm = 2.0727, lr_0 = 1.2163e-04
Validation rmse = 0.151250
Validation r2 = 0.811947
Validation mse = 0.022876
Epoch 52
Loss = 7.1629e-02, PNorm = 35.4523, GNorm = 0.9869, lr_0 = 1.1846e-04
Loss = 7.8491e-02, PNorm = 35.4556, GNorm = 0.8182, lr_0 = 1.1536e-04
Validation rmse = 0.147843
Validation r2 = 0.820324
Validation mse = 0.021857
Epoch 53
Loss = 8.0092e-02, PNorm = 35.4592, GNorm = 3.3926, lr_0 = 1.1205e-04
Validation rmse = 0.148038
Validation r2 = 0.819848
Validation mse = 0.021915
Epoch 54
Loss = 6.6317e-02, PNorm = 35.4628, GNorm = 0.5183, lr_0 = 1.0913e-04
Loss = 7.3132e-02, PNorm = 35.4653, GNorm = 0.8634, lr_0 = 1.0628e-04
Validation rmse = 0.149031
Validation r2 = 0.817424
Validation mse = 0.022210
Epoch 55
Loss = 8.7939e-02, PNorm = 35.4695, GNorm = 2.0581, lr_0 = 1.0323e-04
Validation rmse = 0.148105
Validation r2 = 0.819686
Validation mse = 0.021935
Epoch 56
Loss = 3.7901e-02, PNorm = 35.4728, GNorm = 0.8614, lr_0 = 1.0053e-04
Loss = 6.9221e-02, PNorm = 35.4750, GNorm = 0.8577, lr_0 = 1.0000e-04
Validation rmse = 0.146988
Validation r2 = 0.822396
Validation mse = 0.021605
Epoch 57
Loss = 6.6899e-02, PNorm = 35.4785, GNorm = 1.7222, lr_0 = 1.0000e-04
Loss = 6.8694e-02, PNorm = 35.4818, GNorm = 1.4675, lr_0 = 1.0000e-04
Validation rmse = 0.148006
Validation r2 = 0.819927
Validation mse = 0.021906
Epoch 58
Loss = 6.7409e-02, PNorm = 35.4842, GNorm = 0.6127, lr_0 = 1.0000e-04
Validation rmse = 0.147743
Validation r2 = 0.820566
Validation mse = 0.021828
Epoch 59
Loss = 7.3200e-02, PNorm = 35.4871, GNorm = 1.1972, lr_0 = 1.0000e-04
Loss = 7.0365e-02, PNorm = 35.4909, GNorm = 1.4925, lr_0 = 1.0000e-04
Validation rmse = 0.147183
Validation r2 = 0.821923
Validation mse = 0.021663
Model 0 best validation rmse = 0.146988 on epoch 56
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.463478
Model 0 test r2 = -4.097689
Model 0 test mse = 0.214812
Ensemble test rmse = 0.463478
Ensemble test r2 = -4.097689
Ensemble test mse = 0.214812
Fold 5
Splitting data with seed 5
Total size = 971 | train size = 776 | val size = 195 | test size = 51
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.2558e-01, PNorm = 34.0163, GNorm = 11.6503, lr_0 = 4.3000e-04
Validation rmse = 0.294197
Validation r2 = 0.247252
Validation mse = 0.086552
Epoch 1
Loss = 7.2533e-01, PNorm = 34.0423, GNorm = 6.1592, lr_0 = 7.6000e-04
Loss = 6.2326e-01, PNorm = 34.0928, GNorm = 7.1768, lr_0 = 9.9472e-04
Validation rmse = 0.250985
Validation r2 = 0.452141
Validation mse = 0.062994
Epoch 2
Loss = 4.6870e-01, PNorm = 34.1633, GNorm = 1.0132, lr_0 = 9.6874e-04
Validation rmse = 0.229655
Validation r2 = 0.541305
Validation mse = 0.052741
Epoch 3
Loss = 4.1546e-01, PNorm = 34.2323, GNorm = 7.8099, lr_0 = 9.4094e-04
Loss = 3.2692e-01, PNorm = 34.3012, GNorm = 2.0993, lr_0 = 9.1637e-04
Validation rmse = 0.240537
Validation r2 = 0.496805
Validation mse = 0.057858
Epoch 4
Loss = 3.3776e-01, PNorm = 34.3575, GNorm = 2.0647, lr_0 = 8.9243e-04
Validation rmse = 0.186947
Validation r2 = 0.696045
Validation mse = 0.034949
Epoch 5
Loss = 2.3522e-01, PNorm = 34.4192, GNorm = 1.7317, lr_0 = 8.6682e-04
Loss = 2.6523e-01, PNorm = 34.4790, GNorm = 6.1163, lr_0 = 8.4418e-04
Validation rmse = 0.173646
Validation r2 = 0.737758
Validation mse = 0.030153
Epoch 6
Loss = 2.2758e-01, PNorm = 34.5199, GNorm = 2.9162, lr_0 = 8.2213e-04
Validation rmse = 0.213457
Validation r2 = 0.603727
Validation mse = 0.045564
Epoch 7
Loss = 3.3212e-01, PNorm = 34.5618, GNorm = 8.0892, lr_0 = 7.9854e-04
Loss = 2.6015e-01, PNorm = 34.5993, GNorm = 4.0979, lr_0 = 7.7769e-04
Validation rmse = 0.200196
Validation r2 = 0.651437
Validation mse = 0.040078
Epoch 8
Loss = 2.2982e-01, PNorm = 34.6450, GNorm = 1.1657, lr_0 = 7.5737e-04
Validation rmse = 0.178730
Validation r2 = 0.722177
Validation mse = 0.031945
Epoch 9
Loss = 2.4429e-01, PNorm = 34.6837, GNorm = 4.4290, lr_0 = 7.3564e-04
Loss = 2.0883e-01, PNorm = 34.7121, GNorm = 7.4519, lr_0 = 7.1643e-04
Validation rmse = 0.157606
Validation r2 = 0.783969
Validation mse = 0.024840
Epoch 10
Loss = 1.5623e-01, PNorm = 34.7414, GNorm = 2.1731, lr_0 = 6.9772e-04
Loss = 1.7939e-01, PNorm = 34.7707, GNorm = 3.5469, lr_0 = 6.7949e-04
Loss = 1.4156e-01, PNorm = 34.7732, GNorm = 2.2539, lr_0 = 6.7770e-04
Validation rmse = 0.147268
Validation r2 = 0.811380
Validation mse = 0.021688
Epoch 11
Loss = 1.3188e-01, PNorm = 34.8003, GNorm = 1.0533, lr_0 = 6.5999e-04
Validation rmse = 0.143745
Validation r2 = 0.820297
Validation mse = 0.020663
Epoch 12
Loss = 1.2122e-01, PNorm = 34.8294, GNorm = 3.1581, lr_0 = 6.4276e-04
Loss = 1.3921e-01, PNorm = 34.8489, GNorm = 1.1445, lr_0 = 6.2597e-04
Validation rmse = 0.141582
Validation r2 = 0.825662
Validation mse = 0.020046
Epoch 13
Loss = 1.3211e-01, PNorm = 34.8772, GNorm = 0.7281, lr_0 = 6.0801e-04
Validation rmse = 0.139619
Validation r2 = 0.830465
Validation mse = 0.019493
Epoch 14
Loss = 1.3178e-01, PNorm = 34.8958, GNorm = 1.1950, lr_0 = 5.9213e-04
Loss = 1.1526e-01, PNorm = 34.9159, GNorm = 2.3893, lr_0 = 5.7666e-04
Validation rmse = 0.170565
Validation r2 = 0.746982
Validation mse = 0.029092
Epoch 15
Loss = 1.5842e-01, PNorm = 34.9358, GNorm = 4.0212, lr_0 = 5.6011e-04
Validation rmse = 0.143878
Validation r2 = 0.819964
Validation mse = 0.020701
Epoch 16
Loss = 1.4775e-01, PNorm = 34.9598, GNorm = 2.1930, lr_0 = 5.4548e-04
Loss = 1.1245e-01, PNorm = 34.9799, GNorm = 2.0848, lr_0 = 5.3124e-04
Validation rmse = 0.134466
Validation r2 = 0.842748
Validation mse = 0.018081
Epoch 17
Loss = 1.2014e-01, PNorm = 34.9956, GNorm = 2.9110, lr_0 = 5.1599e-04
Validation rmse = 0.133891
Validation r2 = 0.844091
Validation mse = 0.017927
Epoch 18
Loss = 1.0147e-01, PNorm = 35.0118, GNorm = 0.8464, lr_0 = 5.0252e-04
Loss = 1.1251e-01, PNorm = 35.0298, GNorm = 1.0073, lr_0 = 4.8939e-04
Validation rmse = 0.134730
Validation r2 = 0.842129
Validation mse = 0.018152
Epoch 19
Loss = 1.0377e-01, PNorm = 35.0418, GNorm = 2.5566, lr_0 = 4.7535e-04
Loss = 1.1877e-01, PNorm = 35.0575, GNorm = 2.8476, lr_0 = 4.6293e-04
Validation rmse = 0.135737
Validation r2 = 0.839762
Validation mse = 0.018424
Epoch 20
Loss = 1.1330e-01, PNorm = 35.0716, GNorm = 0.9656, lr_0 = 4.5084e-04
Validation rmse = 0.135506
Validation r2 = 0.840306
Validation mse = 0.018362
Epoch 21
Loss = 1.0135e-01, PNorm = 35.0897, GNorm = 2.2289, lr_0 = 4.3790e-04
Loss = 1.2003e-01, PNorm = 35.1020, GNorm = 2.0451, lr_0 = 4.2647e-04
Validation rmse = 0.139160
Validation r2 = 0.831577
Validation mse = 0.019366
Epoch 22
Loss = 1.1914e-01, PNorm = 35.1162, GNorm = 0.7793, lr_0 = 4.1533e-04
Validation rmse = 0.130969
Validation r2 = 0.850821
Validation mse = 0.017153
Epoch 23
Loss = 1.2547e-01, PNorm = 35.1304, GNorm = 0.8721, lr_0 = 4.0341e-04
Loss = 9.4819e-02, PNorm = 35.1392, GNorm = 2.6012, lr_0 = 3.9287e-04
Validation rmse = 0.132815
Validation r2 = 0.846587
Validation mse = 0.017640
Epoch 24
Loss = 1.0560e-01, PNorm = 35.1536, GNorm = 3.0513, lr_0 = 3.8261e-04
Validation rmse = 0.134751
Validation r2 = 0.842080
Validation mse = 0.018158
Epoch 25
Loss = 8.6334e-02, PNorm = 35.1670, GNorm = 0.6812, lr_0 = 3.7262e-04
Loss = 1.0124e-01, PNorm = 35.1764, GNorm = 0.6141, lr_0 = 3.6289e-04
Validation rmse = 0.135354
Validation r2 = 0.840664
Validation mse = 0.018321
Epoch 26
Loss = 1.0553e-01, PNorm = 35.1889, GNorm = 3.1296, lr_0 = 3.5247e-04
Validation rmse = 0.130681
Validation r2 = 0.851476
Validation mse = 0.017077
Epoch 27
Loss = 8.2204e-02, PNorm = 35.1997, GNorm = 2.5782, lr_0 = 3.4327e-04
Loss = 1.1317e-01, PNorm = 35.2117, GNorm = 1.7496, lr_0 = 3.3430e-04
Validation rmse = 0.131089
Validation r2 = 0.850547
Validation mse = 0.017184
Epoch 28
Loss = 9.6948e-02, PNorm = 35.2237, GNorm = 2.5353, lr_0 = 3.2471e-04
Loss = 1.1936e-01, PNorm = 35.2349, GNorm = 1.8774, lr_0 = 3.1623e-04
Validation rmse = 0.129990
Validation r2 = 0.853042
Validation mse = 0.016897
Epoch 29
Loss = 9.9250e-02, PNorm = 35.2443, GNorm = 3.4094, lr_0 = 3.0797e-04
Validation rmse = 0.137841
Validation r2 = 0.834756
Validation mse = 0.019000
Epoch 30
Loss = 1.3118e-01, PNorm = 35.2541, GNorm = 2.2623, lr_0 = 2.9913e-04
Loss = 9.7685e-02, PNorm = 35.2658, GNorm = 3.1744, lr_0 = 2.9132e-04
Validation rmse = 0.132418
Validation r2 = 0.847502
Validation mse = 0.017534
Epoch 31
Loss = 9.7914e-02, PNorm = 35.2752, GNorm = 1.3501, lr_0 = 2.8371e-04
Validation rmse = 0.130508
Validation r2 = 0.851870
Validation mse = 0.017032
Epoch 32
Loss = 9.3409e-02, PNorm = 35.2858, GNorm = 1.4911, lr_0 = 2.7557e-04
Loss = 9.9648e-02, PNorm = 35.2927, GNorm = 1.6350, lr_0 = 2.6837e-04
Validation rmse = 0.133338
Validation r2 = 0.845374
Validation mse = 0.017779
Epoch 33
Loss = 9.9735e-02, PNorm = 35.3015, GNorm = 2.3584, lr_0 = 2.6136e-04
Validation rmse = 0.128196
Validation r2 = 0.857071
Validation mse = 0.016434
Epoch 34
Loss = 7.7795e-02, PNorm = 35.3122, GNorm = 2.3981, lr_0 = 2.5386e-04
Loss = 9.3251e-02, PNorm = 35.3197, GNorm = 0.9268, lr_0 = 2.4723e-04
Validation rmse = 0.127423
Validation r2 = 0.858789
Validation mse = 0.016237
Epoch 35
Loss = 1.0029e-01, PNorm = 35.3266, GNorm = 4.1273, lr_0 = 2.4077e-04
Validation rmse = 0.128803
Validation r2 = 0.855714
Validation mse = 0.016590
Epoch 36
Loss = 1.0025e-01, PNorm = 35.3350, GNorm = 1.1835, lr_0 = 2.3387e-04
Loss = 8.4997e-02, PNorm = 35.3417, GNorm = 0.7354, lr_0 = 2.2776e-04
Validation rmse = 0.133386
Validation r2 = 0.845263
Validation mse = 0.017792
Epoch 37
Loss = 7.2979e-02, PNorm = 35.3489, GNorm = 1.1271, lr_0 = 2.2181e-04
Validation rmse = 0.127429
Validation r2 = 0.858775
Validation mse = 0.016238
Epoch 38
Loss = 1.0450e-01, PNorm = 35.3562, GNorm = 0.8671, lr_0 = 2.1544e-04
Loss = 8.0564e-02, PNorm = 35.3624, GNorm = 1.6169, lr_0 = 2.0982e-04
Validation rmse = 0.134022
Validation r2 = 0.843784
Validation mse = 0.017962
Epoch 39
Loss = 9.0655e-02, PNorm = 35.3683, GNorm = 0.8234, lr_0 = 2.0434e-04
Loss = 8.7514e-02, PNorm = 35.3758, GNorm = 0.7733, lr_0 = 1.9900e-04
Loss = 8.3443e-02, PNorm = 35.3764, GNorm = 2.1940, lr_0 = 1.9847e-04
Validation rmse = 0.127314
Validation r2 = 0.859030
Validation mse = 0.016209
Epoch 40
Loss = 9.5447e-02, PNorm = 35.3814, GNorm = 2.4219, lr_0 = 1.9329e-04
Validation rmse = 0.135280
Validation r2 = 0.840838
Validation mse = 0.018301
Epoch 41
Loss = 9.4515e-02, PNorm = 35.3876, GNorm = 1.9439, lr_0 = 1.8824e-04
Loss = 9.0069e-02, PNorm = 35.3928, GNorm = 2.3881, lr_0 = 1.8332e-04
Validation rmse = 0.127735
Validation r2 = 0.858097
Validation mse = 0.016316
Epoch 42
Loss = 8.7405e-02, PNorm = 35.3994, GNorm = 2.2099, lr_0 = 1.7806e-04
Validation rmse = 0.133376
Validation r2 = 0.845288
Validation mse = 0.017789
Epoch 43
Loss = 9.8639e-02, PNorm = 35.4041, GNorm = 1.6855, lr_0 = 1.7341e-04
Loss = 7.9614e-02, PNorm = 35.4104, GNorm = 1.5685, lr_0 = 1.6888e-04
Validation rmse = 0.126613
Validation r2 = 0.860578
Validation mse = 0.016031
Epoch 44
Loss = 8.6205e-02, PNorm = 35.4152, GNorm = 0.4093, lr_0 = 1.6404e-04
Validation rmse = 0.126693
Validation r2 = 0.860402
Validation mse = 0.016051
Epoch 45
Loss = 6.8331e-02, PNorm = 35.4200, GNorm = 0.5418, lr_0 = 1.5975e-04
Loss = 8.5533e-02, PNorm = 35.4249, GNorm = 1.8425, lr_0 = 1.5558e-04
Validation rmse = 0.126963
Validation r2 = 0.859807
Validation mse = 0.016120
Epoch 46
Loss = 8.9592e-02, PNorm = 35.4305, GNorm = 0.9099, lr_0 = 1.5112e-04
Validation rmse = 0.127466
Validation r2 = 0.858693
Validation mse = 0.016248
Epoch 47
Loss = 6.8196e-02, PNorm = 35.4353, GNorm = 0.8891, lr_0 = 1.4717e-04
Loss = 9.2203e-02, PNorm = 35.4394, GNorm = 0.9044, lr_0 = 1.4332e-04
Validation rmse = 0.127642
Validation r2 = 0.858303
Validation mse = 0.016293
Epoch 48
Loss = 7.7027e-02, PNorm = 35.4444, GNorm = 0.9118, lr_0 = 1.3921e-04
Loss = 8.3526e-02, PNorm = 35.4490, GNorm = 2.1184, lr_0 = 1.3558e-04
Validation rmse = 0.129252
Validation r2 = 0.854706
Validation mse = 0.016706
Epoch 49
Loss = 8.2626e-02, PNorm = 35.4529, GNorm = 2.0013, lr_0 = 1.3204e-04
Validation rmse = 0.126048
Validation r2 = 0.861820
Validation mse = 0.015888
Epoch 50
Loss = 8.5170e-02, PNorm = 35.4566, GNorm = 1.8616, lr_0 = 1.2859e-04
Loss = 8.0150e-02, PNorm = 35.4597, GNorm = 1.7964, lr_0 = 1.2523e-04
Validation rmse = 0.126454
Validation r2 = 0.860930
Validation mse = 0.015991
Epoch 51
Loss = 7.2221e-02, PNorm = 35.4649, GNorm = 0.9214, lr_0 = 1.2163e-04
Validation rmse = 0.127300
Validation r2 = 0.859061
Validation mse = 0.016205
Epoch 52
Loss = 9.3010e-02, PNorm = 35.4690, GNorm = 1.3616, lr_0 = 1.1846e-04
Loss = 7.5444e-02, PNorm = 35.4729, GNorm = 1.2860, lr_0 = 1.1536e-04
Validation rmse = 0.127078
Validation r2 = 0.859553
Validation mse = 0.016149
Epoch 53
Loss = 6.8312e-02, PNorm = 35.4757, GNorm = 1.0100, lr_0 = 1.1205e-04
Validation rmse = 0.134347
Validation r2 = 0.843026
Validation mse = 0.018049
Epoch 54
Loss = 7.4940e-02, PNorm = 35.4797, GNorm = 2.2115, lr_0 = 1.0913e-04
Loss = 8.9326e-02, PNorm = 35.4830, GNorm = 1.0892, lr_0 = 1.0628e-04
Validation rmse = 0.128145
Validation r2 = 0.857184
Validation mse = 0.016421
Epoch 55
Loss = 7.6549e-02, PNorm = 35.4859, GNorm = 0.7645, lr_0 = 1.0323e-04
Validation rmse = 0.137406
Validation r2 = 0.835797
Validation mse = 0.018880
Epoch 56
Loss = 9.1963e-02, PNorm = 35.4896, GNorm = 2.1959, lr_0 = 1.0053e-04
Loss = 7.6229e-02, PNorm = 35.4927, GNorm = 0.8019, lr_0 = 1.0000e-04
Validation rmse = 0.130754
Validation r2 = 0.851310
Validation mse = 0.017097
Epoch 57
Loss = 6.4463e-02, PNorm = 35.4959, GNorm = 1.1884, lr_0 = 1.0000e-04
Loss = 8.5466e-02, PNorm = 35.4991, GNorm = 1.3321, lr_0 = 1.0000e-04
Validation rmse = 0.125278
Validation r2 = 0.863505
Validation mse = 0.015694
Epoch 58
Loss = 6.9672e-02, PNorm = 35.5023, GNorm = 1.0285, lr_0 = 1.0000e-04
Validation rmse = 0.126457
Validation r2 = 0.860922
Validation mse = 0.015991
Epoch 59
Loss = 1.0338e-01, PNorm = 35.5052, GNorm = 0.6534, lr_0 = 1.0000e-04
Loss = 6.5802e-02, PNorm = 35.5089, GNorm = 1.5984, lr_0 = 1.0000e-04
Validation rmse = 0.125059
Validation r2 = 0.863980
Validation mse = 0.015640
Model 0 best validation rmse = 0.125059 on epoch 59
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.393794
Model 0 test r2 = -2.680045
Model 0 test mse = 0.155073
Ensemble test rmse = 0.393794
Ensemble test r2 = -2.680045
Ensemble test mse = 0.155073
Fold 6
Splitting data with seed 6
Total size = 971 | train size = 776 | val size = 195 | test size = 51
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.0305e-01, PNorm = 34.0158, GNorm = 3.4913, lr_0 = 4.3000e-04
Validation rmse = 0.262818
Validation r2 = 0.358174
Validation mse = 0.069073
Epoch 1
Loss = 6.8324e-01, PNorm = 34.0501, GNorm = 1.1114, lr_0 = 7.6000e-04
Loss = 5.4662e-01, PNorm = 34.1034, GNorm = 6.0491, lr_0 = 9.9472e-04
Validation rmse = 0.227838
Validation r2 = 0.517651
Validation mse = 0.051910
Epoch 2
Loss = 4.3470e-01, PNorm = 34.1637, GNorm = 2.9923, lr_0 = 9.6874e-04
Validation rmse = 0.204516
Validation r2 = 0.611346
Validation mse = 0.041827
Epoch 3
Loss = 4.3882e-01, PNorm = 34.2230, GNorm = 1.5401, lr_0 = 9.4094e-04
Loss = 3.8012e-01, PNorm = 34.2787, GNorm = 1.2130, lr_0 = 9.1637e-04
Validation rmse = 0.187825
Validation r2 = 0.672196
Validation mse = 0.035278
Epoch 4
Loss = 3.0768e-01, PNorm = 34.3312, GNorm = 0.9310, lr_0 = 8.9243e-04
Validation rmse = 0.184762
Validation r2 = 0.682801
Validation mse = 0.034137
Epoch 5
Loss = 3.0000e-01, PNorm = 34.3836, GNorm = 7.4520, lr_0 = 8.6682e-04
Loss = 2.9940e-01, PNorm = 34.4275, GNorm = 2.6075, lr_0 = 8.4418e-04
Validation rmse = 0.162725
Validation r2 = 0.753953
Validation mse = 0.026479
Epoch 6
Loss = 2.4990e-01, PNorm = 34.4752, GNorm = 2.8807, lr_0 = 8.2213e-04
Validation rmse = 0.153642
Validation r2 = 0.780655
Validation mse = 0.023606
Epoch 7
Loss = 1.7087e-01, PNorm = 34.5180, GNorm = 2.1402, lr_0 = 7.9854e-04
Loss = 2.1839e-01, PNorm = 34.5537, GNorm = 3.4940, lr_0 = 7.7769e-04
Validation rmse = 0.146406
Validation r2 = 0.800828
Validation mse = 0.021435
Epoch 8
Loss = 1.7433e-01, PNorm = 34.5877, GNorm = 0.6711, lr_0 = 7.5737e-04
Validation rmse = 0.140608
Validation r2 = 0.816291
Validation mse = 0.019771
Epoch 9
Loss = 2.0256e-01, PNorm = 34.6255, GNorm = 2.4539, lr_0 = 7.3564e-04
Loss = 1.9458e-01, PNorm = 34.6556, GNorm = 2.9612, lr_0 = 7.1643e-04
Validation rmse = 0.142482
Validation r2 = 0.811364
Validation mse = 0.020301
Epoch 10
Loss = 2.0101e-01, PNorm = 34.6862, GNorm = 6.2278, lr_0 = 6.9772e-04
Loss = 2.1749e-01, PNorm = 34.7164, GNorm = 1.2352, lr_0 = 6.7949e-04
Loss = 2.4122e-01, PNorm = 34.7194, GNorm = 6.2647, lr_0 = 6.7770e-04
Validation rmse = 0.141364
Validation r2 = 0.814310
Validation mse = 0.019984
Epoch 11
Loss = 1.8132e-01, PNorm = 34.7493, GNorm = 1.0837, lr_0 = 6.5999e-04
Validation rmse = 0.145957
Validation r2 = 0.802049
Validation mse = 0.021303
Epoch 12
Loss = 2.0131e-01, PNorm = 34.7764, GNorm = 4.7720, lr_0 = 6.4276e-04
Loss = 1.5941e-01, PNorm = 34.8021, GNorm = 4.4000, lr_0 = 6.2597e-04
Validation rmse = 0.134566
Validation r2 = 0.831740
Validation mse = 0.018108
Epoch 13
Loss = 1.7014e-01, PNorm = 34.8246, GNorm = 0.9148, lr_0 = 6.0801e-04
Validation rmse = 0.153157
Validation r2 = 0.782037
Validation mse = 0.023457
Epoch 14
Loss = 2.0772e-01, PNorm = 34.8475, GNorm = 5.0145, lr_0 = 5.9213e-04
Loss = 1.9457e-01, PNorm = 34.8708, GNorm = 4.0411, lr_0 = 5.7666e-04
Validation rmse = 0.132880
Validation r2 = 0.835932
Validation mse = 0.017657
Epoch 15
Loss = 1.7762e-01, PNorm = 34.8953, GNorm = 2.2084, lr_0 = 5.6011e-04
Validation rmse = 0.128181
Validation r2 = 0.847329
Validation mse = 0.016430
Epoch 16
Loss = 1.2616e-01, PNorm = 34.9155, GNorm = 0.8900, lr_0 = 5.4548e-04
Loss = 1.4226e-01, PNorm = 34.9318, GNorm = 2.1114, lr_0 = 5.3124e-04
Validation rmse = 0.130303
Validation r2 = 0.842233
Validation mse = 0.016979
Epoch 17
Loss = 1.3038e-01, PNorm = 34.9518, GNorm = 2.8169, lr_0 = 5.1599e-04
Validation rmse = 0.125619
Validation r2 = 0.853372
Validation mse = 0.015780
Epoch 18
Loss = 1.0161e-01, PNorm = 34.9693, GNorm = 1.0948, lr_0 = 5.0252e-04
Loss = 1.1965e-01, PNorm = 34.9834, GNorm = 2.2886, lr_0 = 4.8939e-04
Validation rmse = 0.138178
Validation r2 = 0.822587
Validation mse = 0.019093
Epoch 19
Loss = 1.1213e-01, PNorm = 35.0010, GNorm = 3.6976, lr_0 = 4.7535e-04
Loss = 1.3217e-01, PNorm = 35.0155, GNorm = 4.2088, lr_0 = 4.6293e-04
Validation rmse = 0.129155
Validation r2 = 0.845000
Validation mse = 0.016681
Epoch 20
Loss = 1.1168e-01, PNorm = 35.0307, GNorm = 2.1273, lr_0 = 4.5084e-04
Validation rmse = 0.125811
Validation r2 = 0.852922
Validation mse = 0.015828
Epoch 21
Loss = 1.1176e-01, PNorm = 35.0457, GNorm = 3.8673, lr_0 = 4.3790e-04
Loss = 1.1688e-01, PNorm = 35.0582, GNorm = 1.0094, lr_0 = 4.2647e-04
Validation rmse = 0.128992
Validation r2 = 0.845391
Validation mse = 0.016639
Epoch 22
Loss = 1.2924e-01, PNorm = 35.0704, GNorm = 4.3148, lr_0 = 4.1533e-04
Validation rmse = 0.135117
Validation r2 = 0.830359
Validation mse = 0.018257
Epoch 23
Loss = 1.2790e-01, PNorm = 35.0879, GNorm = 2.1372, lr_0 = 4.0341e-04
Loss = 1.0656e-01, PNorm = 35.0993, GNorm = 1.2786, lr_0 = 3.9287e-04
Validation rmse = 0.131362
Validation r2 = 0.839659
Validation mse = 0.017256
Epoch 24
Loss = 1.1075e-01, PNorm = 35.1107, GNorm = 1.2844, lr_0 = 3.8261e-04
Validation rmse = 0.129943
Validation r2 = 0.843103
Validation mse = 0.016885
Epoch 25
Loss = 9.2235e-02, PNorm = 35.1248, GNorm = 1.4482, lr_0 = 3.7262e-04
Loss = 1.1097e-01, PNorm = 35.1354, GNorm = 2.5130, lr_0 = 3.6289e-04
Validation rmse = 0.146230
Validation r2 = 0.801307
Validation mse = 0.021383
Epoch 26
Loss = 1.3131e-01, PNorm = 35.1489, GNorm = 2.2232, lr_0 = 3.5247e-04
Validation rmse = 0.125652
Validation r2 = 0.853294
Validation mse = 0.015788
Epoch 27
Loss = 1.9138e-01, PNorm = 35.1616, GNorm = 1.4530, lr_0 = 3.4327e-04
Loss = 1.0822e-01, PNorm = 35.1740, GNorm = 1.6610, lr_0 = 3.3430e-04
Validation rmse = 0.127086
Validation r2 = 0.849926
Validation mse = 0.016151
Epoch 28
Loss = 1.1890e-01, PNorm = 35.1855, GNorm = 3.4746, lr_0 = 3.2471e-04
Loss = 9.3815e-02, PNorm = 35.1947, GNorm = 0.8540, lr_0 = 3.1623e-04
Validation rmse = 0.129673
Validation r2 = 0.843755
Validation mse = 0.016815
Epoch 29
Loss = 1.0756e-01, PNorm = 35.2049, GNorm = 1.0450, lr_0 = 3.0797e-04
Validation rmse = 0.125751
Validation r2 = 0.853063
Validation mse = 0.015813
Epoch 30
Loss = 1.1578e-01, PNorm = 35.2127, GNorm = 4.7999, lr_0 = 2.9913e-04
Loss = 1.0834e-01, PNorm = 35.2221, GNorm = 2.0454, lr_0 = 2.9132e-04
Validation rmse = 0.129424
Validation r2 = 0.844354
Validation mse = 0.016751
Epoch 31
Loss = 1.0494e-01, PNorm = 35.2321, GNorm = 0.7175, lr_0 = 2.8371e-04
Validation rmse = 0.128323
Validation r2 = 0.846992
Validation mse = 0.016467
Epoch 32
Loss = 8.7951e-02, PNorm = 35.2418, GNorm = 1.4542, lr_0 = 2.7557e-04
Loss = 1.1147e-01, PNorm = 35.2500, GNorm = 0.6852, lr_0 = 2.6837e-04
Validation rmse = 0.127227
Validation r2 = 0.849593
Validation mse = 0.016187
Epoch 33
Loss = 9.3770e-02, PNorm = 35.2583, GNorm = 1.4096, lr_0 = 2.6136e-04
Validation rmse = 0.128758
Validation r2 = 0.845951
Validation mse = 0.016579
Epoch 34
Loss = 8.7936e-02, PNorm = 35.2686, GNorm = 1.5218, lr_0 = 2.5386e-04
Loss = 1.0591e-01, PNorm = 35.2789, GNorm = 1.1258, lr_0 = 2.4723e-04
Validation rmse = 0.127974
Validation r2 = 0.847823
Validation mse = 0.016377
Epoch 35
Loss = 1.0330e-01, PNorm = 35.2885, GNorm = 4.0496, lr_0 = 2.4077e-04
Validation rmse = 0.125778
Validation r2 = 0.853000
Validation mse = 0.015820
Epoch 36
Loss = 8.5017e-02, PNorm = 35.2963, GNorm = 0.5504, lr_0 = 2.3387e-04
Loss = 9.2013e-02, PNorm = 35.3031, GNorm = 1.4387, lr_0 = 2.2776e-04
Validation rmse = 0.125886
Validation r2 = 0.852747
Validation mse = 0.015847
Epoch 37
Loss = 8.7519e-02, PNorm = 35.3100, GNorm = 2.0755, lr_0 = 2.2181e-04
Validation rmse = 0.127240
Validation r2 = 0.849563
Validation mse = 0.016190
Epoch 38
Loss = 6.3345e-02, PNorm = 35.3169, GNorm = 2.3512, lr_0 = 2.1544e-04
Loss = 8.7849e-02, PNorm = 35.3253, GNorm = 1.0136, lr_0 = 2.0982e-04
Validation rmse = 0.132712
Validation r2 = 0.836345
Validation mse = 0.017612
Epoch 39
Loss = 9.8688e-02, PNorm = 35.3316, GNorm = 3.4178, lr_0 = 2.0434e-04
Loss = 9.9620e-02, PNorm = 35.3368, GNorm = 0.7972, lr_0 = 1.9900e-04
Loss = 4.6148e-02, PNorm = 35.3376, GNorm = 1.2959, lr_0 = 1.9847e-04
Validation rmse = 0.125820
Validation r2 = 0.852902
Validation mse = 0.015831
Epoch 40
Loss = 9.8972e-02, PNorm = 35.3442, GNorm = 2.9388, lr_0 = 1.9329e-04
Validation rmse = 0.127468
Validation r2 = 0.849024
Validation mse = 0.016248
Epoch 41
Loss = 7.5275e-02, PNorm = 35.3504, GNorm = 0.9324, lr_0 = 1.8824e-04
Loss = 9.6449e-02, PNorm = 35.3558, GNorm = 1.0285, lr_0 = 1.8332e-04
Validation rmse = 0.127747
Validation r2 = 0.848361
Validation mse = 0.016319
Epoch 42
Loss = 8.6782e-02, PNorm = 35.3612, GNorm = 0.8750, lr_0 = 1.7806e-04
Validation rmse = 0.125674
Validation r2 = 0.853244
Validation mse = 0.015794
Epoch 43
Loss = 9.0303e-02, PNorm = 35.3674, GNorm = 1.9975, lr_0 = 1.7341e-04
Loss = 9.1353e-02, PNorm = 35.3720, GNorm = 1.1075, lr_0 = 1.6888e-04
Validation rmse = 0.127025
Validation r2 = 0.850071
Validation mse = 0.016135
Epoch 44
Loss = 8.5370e-02, PNorm = 35.3780, GNorm = 1.5573, lr_0 = 1.6404e-04
Validation rmse = 0.126526
Validation r2 = 0.851247
Validation mse = 0.016009
Epoch 45
Loss = 1.0154e-01, PNorm = 35.3829, GNorm = 1.8368, lr_0 = 1.5975e-04
Loss = 9.2762e-02, PNorm = 35.3870, GNorm = 3.3108, lr_0 = 1.5558e-04
Validation rmse = 0.127791
Validation r2 = 0.848257
Validation mse = 0.016331
Epoch 46
Loss = 1.0719e-01, PNorm = 35.3925, GNorm = 1.2409, lr_0 = 1.5112e-04
Validation rmse = 0.127690
Validation r2 = 0.848497
Validation mse = 0.016305
Epoch 47
Loss = 1.0282e-01, PNorm = 35.3967, GNorm = 3.7677, lr_0 = 1.4717e-04
Loss = 9.6032e-02, PNorm = 35.4012, GNorm = 4.0621, lr_0 = 1.4332e-04
Validation rmse = 0.127669
Validation r2 = 0.848547
Validation mse = 0.016299
Epoch 48
Loss = 7.6109e-02, PNorm = 35.4065, GNorm = 1.8389, lr_0 = 1.3921e-04
Loss = 9.4732e-02, PNorm = 35.4110, GNorm = 0.7525, lr_0 = 1.3558e-04
Validation rmse = 0.125752
Validation r2 = 0.853062
Validation mse = 0.015813
Epoch 49
Loss = 9.3638e-02, PNorm = 35.4155, GNorm = 0.6892, lr_0 = 1.3204e-04
Validation rmse = 0.125151
Validation r2 = 0.854462
Validation mse = 0.015663
Epoch 50
Loss = 8.7150e-02, PNorm = 35.4195, GNorm = 0.6347, lr_0 = 1.2859e-04
Loss = 8.6814e-02, PNorm = 35.4241, GNorm = 0.7363, lr_0 = 1.2523e-04
Validation rmse = 0.126302
Validation r2 = 0.851772
Validation mse = 0.015952
Epoch 51
Loss = 8.2245e-02, PNorm = 35.4277, GNorm = 0.6924, lr_0 = 1.2163e-04
Validation rmse = 0.125454
Validation r2 = 0.853756
Validation mse = 0.015739
Epoch 52
Loss = 6.4911e-02, PNorm = 35.4323, GNorm = 0.5300, lr_0 = 1.1846e-04
Loss = 9.0592e-02, PNorm = 35.4362, GNorm = 0.8077, lr_0 = 1.1536e-04
Validation rmse = 0.126409
Validation r2 = 0.851520
Validation mse = 0.015979
Epoch 53
Loss = 8.1844e-02, PNorm = 35.4389, GNorm = 3.0280, lr_0 = 1.1205e-04
Validation rmse = 0.129055
Validation r2 = 0.845241
Validation mse = 0.016655
Epoch 54
Loss = 7.8211e-02, PNorm = 35.4426, GNorm = 3.1574, lr_0 = 1.0913e-04
Loss = 8.9616e-02, PNorm = 35.4461, GNorm = 1.1888, lr_0 = 1.0628e-04
Validation rmse = 0.130179
Validation r2 = 0.842534
Validation mse = 0.016946
Epoch 55
Loss = 9.9111e-02, PNorm = 35.4498, GNorm = 1.1626, lr_0 = 1.0323e-04
Validation rmse = 0.124829
Validation r2 = 0.855209
Validation mse = 0.015582
Epoch 56
Loss = 9.4580e-02, PNorm = 35.4530, GNorm = 1.5383, lr_0 = 1.0053e-04
Loss = 8.8559e-02, PNorm = 35.4562, GNorm = 2.3823, lr_0 = 1.0000e-04
Validation rmse = 0.127465
Validation r2 = 0.849030
Validation mse = 0.016247
Epoch 57
Loss = 6.8530e-02, PNorm = 35.4595, GNorm = 1.8620, lr_0 = 1.0000e-04
Loss = 9.3841e-02, PNorm = 35.4621, GNorm = 1.7294, lr_0 = 1.0000e-04
Validation rmse = 0.126038
Validation r2 = 0.852393
Validation mse = 0.015885
Epoch 58
Loss = 8.0945e-02, PNorm = 35.4656, GNorm = 0.8881, lr_0 = 1.0000e-04
Validation rmse = 0.125624
Validation r2 = 0.853359
Validation mse = 0.015781
Epoch 59
Loss = 8.2762e-02, PNorm = 35.4691, GNorm = 0.9748, lr_0 = 1.0000e-04
Loss = 8.1380e-02, PNorm = 35.4719, GNorm = 1.4316, lr_0 = 1.0000e-04
Validation rmse = 0.127002
Validation r2 = 0.850126
Validation mse = 0.016129
Model 0 best validation rmse = 0.124829 on epoch 55
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.438288
Model 0 test r2 = -3.558642
Model 0 test mse = 0.192097
Ensemble test rmse = 0.438288
Ensemble test r2 = -3.558642
Ensemble test mse = 0.192097
Fold 7
Splitting data with seed 7
Total size = 971 | train size = 776 | val size = 195 | test size = 51
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.2206e-01, PNorm = 34.0170, GNorm = 1.4707, lr_0 = 4.3000e-04
Validation rmse = 0.295152
Validation r2 = 0.223439
Validation mse = 0.087114
Epoch 1
Loss = 6.8170e-01, PNorm = 34.0525, GNorm = 5.9848, lr_0 = 7.6000e-04
Loss = 6.1246e-01, PNorm = 34.0970, GNorm = 11.5200, lr_0 = 9.9472e-04
Validation rmse = 0.236824
Validation r2 = 0.500040
Validation mse = 0.056085
Epoch 2
Loss = 4.6384e-01, PNorm = 34.1630, GNorm = 7.9615, lr_0 = 9.6874e-04
Validation rmse = 0.226606
Validation r2 = 0.542249
Validation mse = 0.051350
Epoch 3
Loss = 3.9562e-01, PNorm = 34.2394, GNorm = 9.4956, lr_0 = 9.4094e-04
Loss = 3.8776e-01, PNorm = 34.2994, GNorm = 2.2740, lr_0 = 9.1637e-04
Validation rmse = 0.207746
Validation r2 = 0.615276
Validation mse = 0.043158
Epoch 4
Loss = 3.4050e-01, PNorm = 34.3591, GNorm = 5.3629, lr_0 = 8.9243e-04
Validation rmse = 0.187277
Validation r2 = 0.687353
Validation mse = 0.035073
Epoch 5
Loss = 1.5717e-01, PNorm = 34.4252, GNorm = 1.2901, lr_0 = 8.6682e-04
Loss = 2.4510e-01, PNorm = 34.4759, GNorm = 2.3886, lr_0 = 8.4418e-04
Validation rmse = 0.174907
Validation r2 = 0.727292
Validation mse = 0.030592
Epoch 6
Loss = 2.5335e-01, PNorm = 34.5283, GNorm = 2.9640, lr_0 = 8.2213e-04
Validation rmse = 0.164456
Validation r2 = 0.758907
Validation mse = 0.027046
Epoch 7
Loss = 1.9126e-01, PNorm = 34.5827, GNorm = 1.1201, lr_0 = 7.9854e-04
Loss = 1.7804e-01, PNorm = 34.6205, GNorm = 1.2292, lr_0 = 7.7769e-04
Validation rmse = 0.167915
Validation r2 = 0.748659
Validation mse = 0.028195
Epoch 8
Loss = 1.8099e-01, PNorm = 34.6592, GNorm = 1.5982, lr_0 = 7.5737e-04
Validation rmse = 0.152439
Validation r2 = 0.792852
Validation mse = 0.023238
Epoch 9
Loss = 1.6054e-01, PNorm = 34.6993, GNorm = 4.1400, lr_0 = 7.3564e-04
Loss = 1.6132e-01, PNorm = 34.7250, GNorm = 3.5931, lr_0 = 7.1643e-04
Validation rmse = 0.162192
Validation r2 = 0.765500
Validation mse = 0.026306
Epoch 10
Loss = 1.9409e-01, PNorm = 34.7519, GNorm = 3.4873, lr_0 = 6.9772e-04
Loss = 1.3719e-01, PNorm = 34.7777, GNorm = 0.8212, lr_0 = 6.7949e-04
Loss = 1.2926e-01, PNorm = 34.7798, GNorm = 4.1944, lr_0 = 6.7770e-04
Validation rmse = 0.160974
Validation r2 = 0.769009
Validation mse = 0.025912
Epoch 11
Loss = 1.2971e-01, PNorm = 34.8048, GNorm = 5.4189, lr_0 = 6.5999e-04
Validation rmse = 0.157968
Validation r2 = 0.777556
Validation mse = 0.024954
Epoch 12
Loss = 1.3693e-01, PNorm = 34.8241, GNorm = 3.2201, lr_0 = 6.4276e-04
Loss = 1.4879e-01, PNorm = 34.8463, GNorm = 5.2672, lr_0 = 6.2597e-04
Validation rmse = 0.156692
Validation r2 = 0.781133
Validation mse = 0.024552
Epoch 13
Loss = 1.3725e-01, PNorm = 34.8737, GNorm = 0.8147, lr_0 = 6.0801e-04
Validation rmse = 0.150338
Validation r2 = 0.798524
Validation mse = 0.022602
Epoch 14
Loss = 1.3076e-01, PNorm = 34.8878, GNorm = 2.0355, lr_0 = 5.9213e-04
Loss = 1.1901e-01, PNorm = 34.9072, GNorm = 1.1508, lr_0 = 5.7666e-04
Validation rmse = 0.150825
Validation r2 = 0.797217
Validation mse = 0.022748
Epoch 15
Loss = 1.1404e-01, PNorm = 34.9330, GNorm = 3.3549, lr_0 = 5.6011e-04
Validation rmse = 0.154534
Validation r2 = 0.787121
Validation mse = 0.023881
Epoch 16
Loss = 1.1149e-01, PNorm = 34.9511, GNorm = 3.3615, lr_0 = 5.4548e-04
Loss = 1.2482e-01, PNorm = 34.9679, GNorm = 1.9990, lr_0 = 5.3124e-04
Validation rmse = 0.157089
Validation r2 = 0.780023
Validation mse = 0.024677
Epoch 17
Loss = 1.0806e-01, PNorm = 34.9879, GNorm = 1.2054, lr_0 = 5.1599e-04
Validation rmse = 0.165480
Validation r2 = 0.755895
Validation mse = 0.027384
Epoch 18
Loss = 9.7077e-02, PNorm = 35.0063, GNorm = 3.9479, lr_0 = 5.0252e-04
Loss = 1.2303e-01, PNorm = 35.0219, GNorm = 3.8217, lr_0 = 4.8939e-04
Validation rmse = 0.144490
Validation r2 = 0.813894
Validation mse = 0.020877
Epoch 19
Loss = 9.5958e-02, PNorm = 35.0381, GNorm = 1.3609, lr_0 = 4.7535e-04
Loss = 1.1267e-01, PNorm = 35.0553, GNorm = 4.7605, lr_0 = 4.6293e-04
Validation rmse = 0.150399
Validation r2 = 0.798360
Validation mse = 0.022620
Epoch 20
Loss = 9.8906e-02, PNorm = 35.0688, GNorm = 1.1758, lr_0 = 4.5084e-04
Validation rmse = 0.145006
Validation r2 = 0.812562
Validation mse = 0.021027
Epoch 21
Loss = 1.0114e-01, PNorm = 35.0831, GNorm = 2.7945, lr_0 = 4.3790e-04
Loss = 1.1355e-01, PNorm = 35.0951, GNorm = 1.2562, lr_0 = 4.2647e-04
Validation rmse = 0.147648
Validation r2 = 0.805671
Validation mse = 0.021800
Epoch 22
Loss = 1.0087e-01, PNorm = 35.1108, GNorm = 2.8741, lr_0 = 4.1533e-04
Validation rmse = 0.147678
Validation r2 = 0.805590
Validation mse = 0.021809
Epoch 23
Loss = 8.5140e-02, PNorm = 35.1250, GNorm = 3.3511, lr_0 = 4.0341e-04
Loss = 1.0763e-01, PNorm = 35.1366, GNorm = 2.2613, lr_0 = 3.9287e-04
Validation rmse = 0.154729
Validation r2 = 0.786583
Validation mse = 0.023941
Epoch 24
Loss = 1.0818e-01, PNorm = 35.1478, GNorm = 4.0181, lr_0 = 3.8261e-04
Validation rmse = 0.147778
Validation r2 = 0.805327
Validation mse = 0.021838
Epoch 25
Loss = 1.0451e-01, PNorm = 35.1605, GNorm = 1.4826, lr_0 = 3.7262e-04
Loss = 9.6056e-02, PNorm = 35.1723, GNorm = 2.5479, lr_0 = 3.6289e-04
Validation rmse = 0.144850
Validation r2 = 0.812966
Validation mse = 0.020981
Epoch 26
Loss = 8.3199e-02, PNorm = 35.1837, GNorm = 0.6691, lr_0 = 3.5247e-04
Validation rmse = 0.152652
Validation r2 = 0.792274
Validation mse = 0.023303
Epoch 27
Loss = 1.1901e-01, PNorm = 35.1931, GNorm = 2.9727, lr_0 = 3.4327e-04
Loss = 9.4940e-02, PNorm = 35.2032, GNorm = 2.5872, lr_0 = 3.3430e-04
Validation rmse = 0.148068
Validation r2 = 0.804561
Validation mse = 0.021924
Epoch 28
Loss = 7.8111e-02, PNorm = 35.2154, GNorm = 1.1951, lr_0 = 3.2471e-04
Loss = 1.0156e-01, PNorm = 35.2239, GNorm = 1.2217, lr_0 = 3.1623e-04
Validation rmse = 0.144743
Validation r2 = 0.813241
Validation mse = 0.020951
Epoch 29
Loss = 8.2720e-02, PNorm = 35.2372, GNorm = 1.3555, lr_0 = 3.0797e-04
Validation rmse = 0.153159
Validation r2 = 0.790891
Validation mse = 0.023458
Epoch 30
Loss = 7.3731e-02, PNorm = 35.2477, GNorm = 1.8939, lr_0 = 2.9913e-04
Loss = 9.8607e-02, PNorm = 35.2564, GNorm = 1.0538, lr_0 = 2.9132e-04
Validation rmse = 0.146902
Validation r2 = 0.807628
Validation mse = 0.021580
Epoch 31
Loss = 8.8449e-02, PNorm = 35.2644, GNorm = 1.3546, lr_0 = 2.8371e-04
Validation rmse = 0.153463
Validation r2 = 0.790061
Validation mse = 0.023551
Epoch 32
Loss = 8.2685e-02, PNorm = 35.2740, GNorm = 0.9120, lr_0 = 2.7557e-04
Loss = 9.0271e-02, PNorm = 35.2841, GNorm = 2.2749, lr_0 = 2.6837e-04
Validation rmse = 0.142878
Validation r2 = 0.818022
Validation mse = 0.020414
Epoch 33
Loss = 7.9657e-02, PNorm = 35.2908, GNorm = 1.2844, lr_0 = 2.6136e-04
Validation rmse = 0.149797
Validation r2 = 0.799972
Validation mse = 0.022439
Epoch 34
Loss = 9.7741e-02, PNorm = 35.2995, GNorm = 2.3954, lr_0 = 2.5386e-04
Loss = 8.5668e-02, PNorm = 35.3077, GNorm = 1.1794, lr_0 = 2.4723e-04
Validation rmse = 0.145129
Validation r2 = 0.812244
Validation mse = 0.021062
Epoch 35
Loss = 8.9106e-02, PNorm = 35.3166, GNorm = 1.3192, lr_0 = 2.4077e-04
Validation rmse = 0.146381
Validation r2 = 0.808991
Validation mse = 0.021427
Epoch 36
Loss = 8.3499e-02, PNorm = 35.3254, GNorm = 2.1384, lr_0 = 2.3387e-04
Loss = 8.0050e-02, PNorm = 35.3340, GNorm = 0.8540, lr_0 = 2.2776e-04
Validation rmse = 0.143646
Validation r2 = 0.816063
Validation mse = 0.020634
Epoch 37
Loss = 7.6576e-02, PNorm = 35.3401, GNorm = 0.7936, lr_0 = 2.2181e-04
Validation rmse = 0.145715
Validation r2 = 0.810725
Validation mse = 0.021233
Epoch 38
Loss = 6.4081e-02, PNorm = 35.3476, GNorm = 1.0893, lr_0 = 2.1544e-04
Loss = 8.2137e-02, PNorm = 35.3542, GNorm = 1.8198, lr_0 = 2.0982e-04
Validation rmse = 0.145193
Validation r2 = 0.812079
Validation mse = 0.021081
Epoch 39
Loss = 8.4491e-02, PNorm = 35.3614, GNorm = 1.0729, lr_0 = 2.0434e-04
Loss = 7.2063e-02, PNorm = 35.3673, GNorm = 0.7484, lr_0 = 1.9900e-04
Loss = 6.6447e-02, PNorm = 35.3679, GNorm = 2.0360, lr_0 = 1.9847e-04
Validation rmse = 0.145161
Validation r2 = 0.812162
Validation mse = 0.021072
Epoch 40
Loss = 7.4127e-02, PNorm = 35.3745, GNorm = 2.7841, lr_0 = 1.9329e-04
Validation rmse = 0.144323
Validation r2 = 0.814324
Validation mse = 0.020829
Epoch 41
Loss = 7.5652e-02, PNorm = 35.3807, GNorm = 0.7691, lr_0 = 1.8824e-04
Loss = 7.5184e-02, PNorm = 35.3871, GNorm = 0.3806, lr_0 = 1.8332e-04
Validation rmse = 0.143005
Validation r2 = 0.817700
Validation mse = 0.020450
Epoch 42
Loss = 7.0038e-02, PNorm = 35.3933, GNorm = 2.8112, lr_0 = 1.7806e-04
Validation rmse = 0.145986
Validation r2 = 0.810020
Validation mse = 0.021312
Epoch 43
Loss = 7.6515e-02, PNorm = 35.3985, GNorm = 3.3173, lr_0 = 1.7341e-04
Loss = 7.3957e-02, PNorm = 35.4041, GNorm = 1.6287, lr_0 = 1.6888e-04
Validation rmse = 0.144208
Validation r2 = 0.814618
Validation mse = 0.020796
Epoch 44
Loss = 7.6995e-02, PNorm = 35.4099, GNorm = 3.2561, lr_0 = 1.6404e-04
Validation rmse = 0.150737
Validation r2 = 0.797455
Validation mse = 0.022722
Epoch 45
Loss = 1.0384e-01, PNorm = 35.4154, GNorm = 2.0378, lr_0 = 1.5975e-04
Loss = 7.0502e-02, PNorm = 35.4214, GNorm = 1.4392, lr_0 = 1.5558e-04
Validation rmse = 0.143107
Validation r2 = 0.817440
Validation mse = 0.020480
Epoch 46
Loss = 8.7930e-02, PNorm = 35.4259, GNorm = 1.1485, lr_0 = 1.5112e-04
Validation rmse = 0.145988
Validation r2 = 0.810015
Validation mse = 0.021312
Epoch 47
Loss = 5.7924e-02, PNorm = 35.4303, GNorm = 2.4634, lr_0 = 1.4717e-04
Loss = 7.4236e-02, PNorm = 35.4347, GNorm = 1.7727, lr_0 = 1.4332e-04
Validation rmse = 0.144390
Validation r2 = 0.814151
Validation mse = 0.020849
Epoch 48
Loss = 8.0580e-02, PNorm = 35.4393, GNorm = 5.0593, lr_0 = 1.3921e-04
Loss = 7.2651e-02, PNorm = 35.4435, GNorm = 2.8968, lr_0 = 1.3558e-04
Validation rmse = 0.145116
Validation r2 = 0.812279
Validation mse = 0.021059
Epoch 49
Loss = 5.9630e-02, PNorm = 35.4469, GNorm = 0.4152, lr_0 = 1.3204e-04
Validation rmse = 0.144411
Validation r2 = 0.814096
Validation mse = 0.020855
Epoch 50
Loss = 5.7812e-02, PNorm = 35.4510, GNorm = 0.5180, lr_0 = 1.2859e-04
Loss = 7.4807e-02, PNorm = 35.4553, GNorm = 0.7019, lr_0 = 1.2523e-04
Validation rmse = 0.146601
Validation r2 = 0.808417
Validation mse = 0.021492
Epoch 51
Loss = 7.5105e-02, PNorm = 35.4589, GNorm = 2.3689, lr_0 = 1.2163e-04
Validation rmse = 0.144124
Validation r2 = 0.814836
Validation mse = 0.020772
Epoch 52
Loss = 7.4418e-02, PNorm = 35.4626, GNorm = 1.4715, lr_0 = 1.1846e-04
Loss = 7.0948e-02, PNorm = 35.4667, GNorm = 0.4608, lr_0 = 1.1536e-04
Validation rmse = 0.144855
Validation r2 = 0.812952
Validation mse = 0.020983
Epoch 53
Loss = 6.9617e-02, PNorm = 35.4707, GNorm = 0.8548, lr_0 = 1.1205e-04
Validation rmse = 0.144057
Validation r2 = 0.815008
Validation mse = 0.020752
Epoch 54
Loss = 5.9451e-02, PNorm = 35.4731, GNorm = 0.9707, lr_0 = 1.0913e-04
Loss = 7.8437e-02, PNorm = 35.4760, GNorm = 1.6295, lr_0 = 1.0628e-04
Validation rmse = 0.145324
Validation r2 = 0.811738
Validation mse = 0.021119
Epoch 55
Loss = 7.6581e-02, PNorm = 35.4796, GNorm = 2.5215, lr_0 = 1.0323e-04
Validation rmse = 0.145323
Validation r2 = 0.811741
Validation mse = 0.021119
Epoch 56
Loss = 3.4474e-02, PNorm = 35.4825, GNorm = 2.0101, lr_0 = 1.0053e-04
Loss = 7.4178e-02, PNorm = 35.4855, GNorm = 1.2466, lr_0 = 1.0000e-04
Validation rmse = 0.146795
Validation r2 = 0.807910
Validation mse = 0.021549
Epoch 57
Loss = 6.7135e-02, PNorm = 35.4896, GNorm = 1.3281, lr_0 = 1.0000e-04
Loss = 7.4087e-02, PNorm = 35.4920, GNorm = 2.1247, lr_0 = 1.0000e-04
Validation rmse = 0.143511
Validation r2 = 0.816406
Validation mse = 0.020596
Epoch 58
Loss = 7.2725e-02, PNorm = 35.4946, GNorm = 3.5454, lr_0 = 1.0000e-04
Validation rmse = 0.144367
Validation r2 = 0.814210
Validation mse = 0.020842
Epoch 59
Loss = 7.5780e-02, PNorm = 35.4976, GNorm = 2.4094, lr_0 = 1.0000e-04
Loss = 6.8541e-02, PNorm = 35.5012, GNorm = 3.2174, lr_0 = 1.0000e-04
Validation rmse = 0.145047
Validation r2 = 0.812455
Validation mse = 0.021039
Model 0 best validation rmse = 0.142878 on epoch 32
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.420530
Model 0 test r2 = -3.196720
Model 0 test mse = 0.176846
Ensemble test rmse = 0.420530
Ensemble test r2 = -3.196720
Ensemble test mse = 0.176846
Fold 8
Splitting data with seed 8
Total size = 971 | train size = 776 | val size = 195 | test size = 51
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1188e-01, PNorm = 34.0167, GNorm = 2.9822, lr_0 = 4.3000e-04
Validation rmse = 0.257842
Validation r2 = 0.333595
Validation mse = 0.066483
Epoch 1
Loss = 6.3085e-01, PNorm = 34.0475, GNorm = 4.6133, lr_0 = 7.6000e-04
Loss = 5.1751e-01, PNorm = 34.1022, GNorm = 4.3975, lr_0 = 9.9472e-04
Validation rmse = 0.218974
Validation r2 = 0.519364
Validation mse = 0.047950
Epoch 2
Loss = 4.4884e-01, PNorm = 34.1625, GNorm = 3.2936, lr_0 = 9.6874e-04
Validation rmse = 0.201195
Validation r2 = 0.594247
Validation mse = 0.040479
Epoch 3
Loss = 3.7986e-01, PNorm = 34.2203, GNorm = 2.3108, lr_0 = 9.4094e-04
Loss = 3.9425e-01, PNorm = 34.2750, GNorm = 2.6228, lr_0 = 9.1637e-04
Validation rmse = 0.186163
Validation r2 = 0.652612
Validation mse = 0.034657
Epoch 4
Loss = 3.2693e-01, PNorm = 34.3281, GNorm = 3.8249, lr_0 = 8.9243e-04
Validation rmse = 0.173208
Validation r2 = 0.699280
Validation mse = 0.030001
Epoch 5
Loss = 2.8586e-01, PNorm = 34.3886, GNorm = 7.3818, lr_0 = 8.6682e-04
Loss = 2.5615e-01, PNorm = 34.4404, GNorm = 1.3633, lr_0 = 8.4418e-04
Validation rmse = 0.164201
Validation r2 = 0.729741
Validation mse = 0.026962
Epoch 6
Loss = 2.0443e-01, PNorm = 34.4848, GNorm = 1.5234, lr_0 = 8.2213e-04
Validation rmse = 0.195934
Validation r2 = 0.615188
Validation mse = 0.038390
Epoch 7
Loss = 3.8789e-01, PNorm = 34.5327, GNorm = 10.2188, lr_0 = 7.9854e-04
Loss = 2.5243e-01, PNorm = 34.5755, GNorm = 1.4940, lr_0 = 7.7769e-04
Validation rmse = 0.178542
Validation r2 = 0.680471
Validation mse = 0.031877
Epoch 8
Loss = 2.6241e-01, PNorm = 34.6218, GNorm = 9.8937, lr_0 = 7.5737e-04
Validation rmse = 0.166401
Validation r2 = 0.722450
Validation mse = 0.027689
Epoch 9
Loss = 1.2489e-01, PNorm = 34.6636, GNorm = 2.0800, lr_0 = 7.3564e-04
Loss = 2.1010e-01, PNorm = 34.6969, GNorm = 4.3096, lr_0 = 7.1643e-04
Validation rmse = 0.151793
Validation r2 = 0.769042
Validation mse = 0.023041
Epoch 10
Loss = 1.5008e-01, PNorm = 34.7289, GNorm = 1.8338, lr_0 = 6.9772e-04
Loss = 1.6402e-01, PNorm = 34.7532, GNorm = 1.4285, lr_0 = 6.7949e-04
Loss = 2.9908e-01, PNorm = 34.7562, GNorm = 4.6735, lr_0 = 6.7770e-04
Validation rmse = 0.143712
Validation r2 = 0.792979
Validation mse = 0.020653
Epoch 11
Loss = 1.5540e-01, PNorm = 34.7882, GNorm = 0.7054, lr_0 = 6.5999e-04
Validation rmse = 0.156279
Validation r2 = 0.755189
Validation mse = 0.024423
Epoch 12
Loss = 1.4944e-01, PNorm = 34.8173, GNorm = 4.5862, lr_0 = 6.4276e-04
Loss = 1.4957e-01, PNorm = 34.8417, GNorm = 3.0543, lr_0 = 6.2597e-04
Validation rmse = 0.139609
Validation r2 = 0.804631
Validation mse = 0.019491
Epoch 13
Loss = 1.4960e-01, PNorm = 34.8714, GNorm = 2.1950, lr_0 = 6.0801e-04
Validation rmse = 0.139401
Validation r2 = 0.805212
Validation mse = 0.019433
Epoch 14
Loss = 1.2024e-01, PNorm = 34.8976, GNorm = 4.3560, lr_0 = 5.9213e-04
Loss = 1.4850e-01, PNorm = 34.9207, GNorm = 4.8154, lr_0 = 5.7666e-04
Validation rmse = 0.153875
Validation r2 = 0.762663
Validation mse = 0.023678
Epoch 15
Loss = 1.3177e-01, PNorm = 34.9442, GNorm = 2.4182, lr_0 = 5.6011e-04
Validation rmse = 0.144370
Validation r2 = 0.791078
Validation mse = 0.020843
Epoch 16
Loss = 1.4518e-01, PNorm = 34.9650, GNorm = 0.9866, lr_0 = 5.4548e-04
Loss = 1.3527e-01, PNorm = 34.9866, GNorm = 3.2723, lr_0 = 5.3124e-04
Validation rmse = 0.146190
Validation r2 = 0.785777
Validation mse = 0.021372
Epoch 17
Loss = 1.2158e-01, PNorm = 35.0110, GNorm = 2.1141, lr_0 = 5.1599e-04
Validation rmse = 0.171686
Validation r2 = 0.704540
Validation mse = 0.029476
Epoch 18
Loss = 1.7753e-01, PNorm = 35.0311, GNorm = 6.4262, lr_0 = 5.0252e-04
Loss = 1.5471e-01, PNorm = 35.0518, GNorm = 3.4822, lr_0 = 4.8939e-04
Validation rmse = 0.133751
Validation r2 = 0.820683
Validation mse = 0.017889
Epoch 19
Loss = 1.1827e-01, PNorm = 35.0741, GNorm = 1.2048, lr_0 = 4.7535e-04
Loss = 1.2057e-01, PNorm = 35.0893, GNorm = 2.2312, lr_0 = 4.6293e-04
Validation rmse = 0.135220
Validation r2 = 0.816721
Validation mse = 0.018284
Epoch 20
Loss = 1.2498e-01, PNorm = 35.1067, GNorm = 1.0882, lr_0 = 4.5084e-04
Validation rmse = 0.136280
Validation r2 = 0.813836
Validation mse = 0.018572
Epoch 21
Loss = 1.0043e-01, PNorm = 35.1274, GNorm = 0.8317, lr_0 = 4.3790e-04
Loss = 1.1250e-01, PNorm = 35.1429, GNorm = 1.2497, lr_0 = 4.2647e-04
Validation rmse = 0.135786
Validation r2 = 0.815186
Validation mse = 0.018438
Epoch 22
Loss = 1.0730e-01, PNorm = 35.1594, GNorm = 0.7518, lr_0 = 4.1533e-04
Validation rmse = 0.133123
Validation r2 = 0.822361
Validation mse = 0.017722
Epoch 23
Loss = 9.9972e-02, PNorm = 35.1759, GNorm = 2.9260, lr_0 = 4.0341e-04
Loss = 1.2814e-01, PNorm = 35.1894, GNorm = 1.0100, lr_0 = 3.9287e-04
Validation rmse = 0.137823
Validation r2 = 0.809598
Validation mse = 0.018995
Epoch 24
Loss = 1.0709e-01, PNorm = 35.2066, GNorm = 3.1201, lr_0 = 3.8261e-04
Validation rmse = 0.132229
Validation r2 = 0.824741
Validation mse = 0.017484
Epoch 25
Loss = 1.1986e-01, PNorm = 35.2203, GNorm = 3.6358, lr_0 = 3.7262e-04
Loss = 1.1004e-01, PNorm = 35.2320, GNorm = 3.4684, lr_0 = 3.6289e-04
Validation rmse = 0.137998
Validation r2 = 0.809114
Validation mse = 0.019043
Epoch 26
Loss = 9.5305e-02, PNorm = 35.2466, GNorm = 1.9756, lr_0 = 3.5247e-04
Validation rmse = 0.132481
Validation r2 = 0.824072
Validation mse = 0.017551
Epoch 27
Loss = 8.1897e-02, PNorm = 35.2600, GNorm = 0.6106, lr_0 = 3.4327e-04
Loss = 1.0191e-01, PNorm = 35.2715, GNorm = 1.6971, lr_0 = 3.3430e-04
Validation rmse = 0.130584
Validation r2 = 0.829073
Validation mse = 0.017052
Epoch 28
Loss = 9.2507e-02, PNorm = 35.2827, GNorm = 2.2670, lr_0 = 3.2471e-04
Loss = 1.0240e-01, PNorm = 35.2940, GNorm = 2.5846, lr_0 = 3.1623e-04
Validation rmse = 0.130167
Validation r2 = 0.830162
Validation mse = 0.016944
Epoch 29
Loss = 9.9065e-02, PNorm = 35.3068, GNorm = 1.2673, lr_0 = 3.0797e-04
Validation rmse = 0.135815
Validation r2 = 0.815106
Validation mse = 0.018446
Epoch 30
Loss = 1.0925e-01, PNorm = 35.3177, GNorm = 0.6986, lr_0 = 2.9913e-04
Loss = 8.0372e-02, PNorm = 35.3289, GNorm = 0.6944, lr_0 = 2.9132e-04
Validation rmse = 0.140310
Validation r2 = 0.802663
Validation mse = 0.019687
Epoch 31
Loss = 9.8226e-02, PNorm = 35.3398, GNorm = 1.8867, lr_0 = 2.8371e-04
Validation rmse = 0.144170
Validation r2 = 0.791656
Validation mse = 0.020785
Epoch 32
Loss = 8.8167e-02, PNorm = 35.3510, GNorm = 1.0685, lr_0 = 2.7557e-04
Loss = 9.9942e-02, PNorm = 35.3596, GNorm = 1.0285, lr_0 = 2.6837e-04
Validation rmse = 0.129576
Validation r2 = 0.831703
Validation mse = 0.016790
Epoch 33
Loss = 8.7095e-02, PNorm = 35.3696, GNorm = 0.5596, lr_0 = 2.6136e-04
Validation rmse = 0.130261
Validation r2 = 0.829918
Validation mse = 0.016968
Epoch 34
Loss = 9.0801e-02, PNorm = 35.3815, GNorm = 3.8749, lr_0 = 2.5386e-04
Loss = 1.0145e-01, PNorm = 35.3915, GNorm = 2.0919, lr_0 = 2.4723e-04
Validation rmse = 0.136658
Validation r2 = 0.812802
Validation mse = 0.018675
Epoch 35
Loss = 9.7561e-02, PNorm = 35.4000, GNorm = 2.1220, lr_0 = 2.4077e-04
Validation rmse = 0.130757
Validation r2 = 0.828621
Validation mse = 0.017097
Epoch 36
Loss = 9.8090e-02, PNorm = 35.4115, GNorm = 3.7229, lr_0 = 2.3387e-04
Loss = 9.7119e-02, PNorm = 35.4199, GNorm = 3.4771, lr_0 = 2.2776e-04
Validation rmse = 0.133468
Validation r2 = 0.821439
Validation mse = 0.017814
Epoch 37
Loss = 8.4026e-02, PNorm = 35.4263, GNorm = 2.4512, lr_0 = 2.2181e-04
Validation rmse = 0.131061
Validation r2 = 0.827821
Validation mse = 0.017177
Epoch 38
Loss = 6.2958e-02, PNorm = 35.4354, GNorm = 0.9452, lr_0 = 2.1544e-04
Loss = 9.1433e-02, PNorm = 35.4434, GNorm = 1.4773, lr_0 = 2.0982e-04
Validation rmse = 0.134649
Validation r2 = 0.818267
Validation mse = 0.018130
Epoch 39
Loss = 8.3588e-02, PNorm = 35.4503, GNorm = 1.8034, lr_0 = 2.0434e-04
Loss = 9.1582e-02, PNorm = 35.4574, GNorm = 1.1112, lr_0 = 1.9900e-04
Loss = 5.9612e-02, PNorm = 35.4581, GNorm = 0.7165, lr_0 = 1.9847e-04
Validation rmse = 0.129821
Validation r2 = 0.831065
Validation mse = 0.016854
Epoch 40
Loss = 8.3076e-02, PNorm = 35.4643, GNorm = 1.4500, lr_0 = 1.9329e-04
Validation rmse = 0.129974
Validation r2 = 0.830668
Validation mse = 0.016893
Epoch 41
Loss = 9.2804e-02, PNorm = 35.4711, GNorm = 3.0816, lr_0 = 1.8824e-04
Loss = 8.0071e-02, PNorm = 35.4774, GNorm = 1.0590, lr_0 = 1.8332e-04
Validation rmse = 0.133617
Validation r2 = 0.821041
Validation mse = 0.017854
Epoch 42
Loss = 7.7427e-02, PNorm = 35.4850, GNorm = 1.9856, lr_0 = 1.7806e-04
Validation rmse = 0.132207
Validation r2 = 0.824799
Validation mse = 0.017479
Epoch 43
Loss = 1.0149e-01, PNorm = 35.4913, GNorm = 1.1978, lr_0 = 1.7341e-04
Loss = 7.0747e-02, PNorm = 35.4980, GNorm = 0.8482, lr_0 = 1.6888e-04
Validation rmse = 0.129775
Validation r2 = 0.831186
Validation mse = 0.016841
Epoch 44
Loss = 7.0632e-02, PNorm = 35.5035, GNorm = 1.2238, lr_0 = 1.6404e-04
Validation rmse = 0.133145
Validation r2 = 0.822302
Validation mse = 0.017728
Epoch 45
Loss = 6.5391e-02, PNorm = 35.5103, GNorm = 0.6141, lr_0 = 1.5975e-04
Loss = 7.9043e-02, PNorm = 35.5157, GNorm = 1.0532, lr_0 = 1.5558e-04
Validation rmse = 0.130366
Validation r2 = 0.829643
Validation mse = 0.016995
Epoch 46
Loss = 9.2336e-02, PNorm = 35.5218, GNorm = 0.5246, lr_0 = 1.5112e-04
Validation rmse = 0.130326
Validation r2 = 0.829749
Validation mse = 0.016985
Epoch 47
Loss = 6.6237e-02, PNorm = 35.5267, GNorm = 0.5441, lr_0 = 1.4717e-04
Loss = 7.4158e-02, PNorm = 35.5318, GNorm = 0.5002, lr_0 = 1.4332e-04
Validation rmse = 0.131775
Validation r2 = 0.825943
Validation mse = 0.017365
Epoch 48
Loss = 8.4096e-02, PNorm = 35.5377, GNorm = 0.7905, lr_0 = 1.3921e-04
Loss = 7.6085e-02, PNorm = 35.5427, GNorm = 2.4394, lr_0 = 1.3558e-04
Validation rmse = 0.128636
Validation r2 = 0.834135
Validation mse = 0.016547
Epoch 49
Loss = 8.6625e-02, PNorm = 35.5464, GNorm = 1.4505, lr_0 = 1.3204e-04
Validation rmse = 0.134552
Validation r2 = 0.818528
Validation mse = 0.018104
Epoch 50
Loss = 7.3856e-02, PNorm = 35.5512, GNorm = 2.9752, lr_0 = 1.2859e-04
Loss = 8.9874e-02, PNorm = 35.5548, GNorm = 1.7583, lr_0 = 1.2523e-04
Validation rmse = 0.127610
Validation r2 = 0.836771
Validation mse = 0.016284
Epoch 51
Loss = 7.5786e-02, PNorm = 35.5612, GNorm = 0.5250, lr_0 = 1.2163e-04
Validation rmse = 0.129166
Validation r2 = 0.832766
Validation mse = 0.016684
Epoch 52
Loss = 8.0316e-02, PNorm = 35.5655, GNorm = 1.1554, lr_0 = 1.1846e-04
Loss = 7.6539e-02, PNorm = 35.5694, GNorm = 0.4690, lr_0 = 1.1536e-04
Validation rmse = 0.130398
Validation r2 = 0.829561
Validation mse = 0.017004
Epoch 53
Loss = 7.7251e-02, PNorm = 35.5741, GNorm = 1.7266, lr_0 = 1.1205e-04
Validation rmse = 0.130642
Validation r2 = 0.828921
Validation mse = 0.017067
Epoch 54
Loss = 6.0418e-02, PNorm = 35.5777, GNorm = 0.5845, lr_0 = 1.0913e-04
Loss = 7.1917e-02, PNorm = 35.5812, GNorm = 1.3259, lr_0 = 1.0628e-04
Validation rmse = 0.127668
Validation r2 = 0.836622
Validation mse = 0.016299
Epoch 55
Loss = 7.1270e-02, PNorm = 35.5851, GNorm = 0.8879, lr_0 = 1.0323e-04
Validation rmse = 0.131180
Validation r2 = 0.827509
Validation mse = 0.017208
Epoch 56
Loss = 6.1337e-02, PNorm = 35.5884, GNorm = 0.6394, lr_0 = 1.0053e-04
Loss = 8.0075e-02, PNorm = 35.5922, GNorm = 0.5268, lr_0 = 1.0000e-04
Validation rmse = 0.131869
Validation r2 = 0.825693
Validation mse = 0.017389
Epoch 57
Loss = 7.2127e-02, PNorm = 35.5958, GNorm = 1.8574, lr_0 = 1.0000e-04
Loss = 7.8053e-02, PNorm = 35.5993, GNorm = 2.6866, lr_0 = 1.0000e-04
Validation rmse = 0.128970
Validation r2 = 0.833273
Validation mse = 0.016633
Epoch 58
Loss = 7.5998e-02, PNorm = 35.6028, GNorm = 0.7131, lr_0 = 1.0000e-04
Validation rmse = 0.127725
Validation r2 = 0.836476
Validation mse = 0.016314
Epoch 59
Loss = 6.7528e-02, PNorm = 35.6067, GNorm = 1.4530, lr_0 = 1.0000e-04
Loss = 7.7711e-02, PNorm = 35.6098, GNorm = 1.3358, lr_0 = 1.0000e-04
Validation rmse = 0.134444
Validation r2 = 0.818818
Validation mse = 0.018075
Model 0 best validation rmse = 0.127610 on epoch 50
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.449533
Model 0 test r2 = -3.795562
Model 0 test mse = 0.202080
Ensemble test rmse = 0.449533
Ensemble test r2 = -3.795562
Ensemble test mse = 0.202080
Fold 9
Splitting data with seed 9
Total size = 971 | train size = 776 | val size = 195 | test size = 51
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.2670e-01, PNorm = 34.0166, GNorm = 3.3901, lr_0 = 4.3000e-04
Validation rmse = 0.275473
Validation r2 = 0.341689
Validation mse = 0.075885
Epoch 1
Loss = 6.7103e-01, PNorm = 34.0549, GNorm = 4.5575, lr_0 = 7.6000e-04
Loss = 7.2535e-01, PNorm = 34.0909, GNorm = 13.4395, lr_0 = 9.9472e-04
Validation rmse = 0.250482
Validation r2 = 0.455717
Validation mse = 0.062741
Epoch 2
Loss = 5.3708e-01, PNorm = 34.1420, GNorm = 0.9361, lr_0 = 9.6874e-04
Validation rmse = 0.207762
Validation r2 = 0.625542
Validation mse = 0.043165
Epoch 3
Loss = 3.5137e-01, PNorm = 34.2083, GNorm = 0.8773, lr_0 = 9.4094e-04
Loss = 3.9138e-01, PNorm = 34.2677, GNorm = 1.3419, lr_0 = 9.1637e-04
Validation rmse = 0.188044
Validation r2 = 0.693244
Validation mse = 0.035361
Epoch 4
Loss = 3.3963e-01, PNorm = 34.3317, GNorm = 2.3003, lr_0 = 8.9243e-04
Validation rmse = 0.168817
Validation r2 = 0.752766
Validation mse = 0.028499
Epoch 5
Loss = 3.8974e-01, PNorm = 34.4018, GNorm = 12.7144, lr_0 = 8.6682e-04
Loss = 2.8863e-01, PNorm = 34.4532, GNorm = 4.1265, lr_0 = 8.4418e-04
Validation rmse = 0.168458
Validation r2 = 0.753817
Validation mse = 0.028378
Epoch 6
Loss = 2.3649e-01, PNorm = 34.5085, GNorm = 8.1395, lr_0 = 8.2213e-04
Validation rmse = 0.164659
Validation r2 = 0.764795
Validation mse = 0.027113
Epoch 7
Loss = 2.2239e-01, PNorm = 34.5523, GNorm = 2.1049, lr_0 = 7.9854e-04
Loss = 2.2261e-01, PNorm = 34.5965, GNorm = 3.7421, lr_0 = 7.7769e-04
Validation rmse = 0.164732
Validation r2 = 0.764587
Validation mse = 0.027137
Epoch 8
Loss = 2.1022e-01, PNorm = 34.6297, GNorm = 5.0404, lr_0 = 7.5737e-04
Validation rmse = 0.149780
Validation r2 = 0.805384
Validation mse = 0.022434
Epoch 9
Loss = 2.0517e-01, PNorm = 34.6669, GNorm = 3.9038, lr_0 = 7.3564e-04
Loss = 1.5872e-01, PNorm = 34.6936, GNorm = 3.7104, lr_0 = 7.1643e-04
Validation rmse = 0.140735
Validation r2 = 0.828179
Validation mse = 0.019806
Epoch 10
Loss = 1.5437e-01, PNorm = 34.7259, GNorm = 5.2820, lr_0 = 6.9772e-04
Loss = 1.5812e-01, PNorm = 34.7486, GNorm = 2.5782, lr_0 = 6.7949e-04
Loss = 1.0122e-01, PNorm = 34.7512, GNorm = 0.7496, lr_0 = 6.7770e-04
Validation rmse = 0.144212
Validation r2 = 0.819585
Validation mse = 0.020797
Epoch 11
Loss = 1.4627e-01, PNorm = 34.7761, GNorm = 1.1009, lr_0 = 6.5999e-04
Validation rmse = 0.152426
Validation r2 = 0.798446
Validation mse = 0.023234
Epoch 12
Loss = 1.7503e-01, PNorm = 34.8007, GNorm = 5.7102, lr_0 = 6.4276e-04
Loss = 1.6325e-01, PNorm = 34.8223, GNorm = 2.4794, lr_0 = 6.2597e-04
Validation rmse = 0.166329
Validation r2 = 0.760001
Validation mse = 0.027665
Epoch 13
Loss = 1.5569e-01, PNorm = 34.8442, GNorm = 4.0120, lr_0 = 6.0801e-04
Validation rmse = 0.134462
Validation r2 = 0.843155
Validation mse = 0.018080
Epoch 14
Loss = 1.1919e-01, PNorm = 34.8717, GNorm = 1.4480, lr_0 = 5.9213e-04
Loss = 1.3656e-01, PNorm = 34.8969, GNorm = 2.0189, lr_0 = 5.7666e-04
Validation rmse = 0.131441
Validation r2 = 0.850123
Validation mse = 0.017277
Epoch 15
Loss = 1.1460e-01, PNorm = 34.9172, GNorm = 1.9010, lr_0 = 5.6011e-04
Validation rmse = 0.128532
Validation r2 = 0.856683
Validation mse = 0.016521
Epoch 16
Loss = 1.0053e-01, PNorm = 34.9359, GNorm = 0.6842, lr_0 = 5.4548e-04
Loss = 1.1065e-01, PNorm = 34.9534, GNorm = 2.6857, lr_0 = 5.3124e-04
Validation rmse = 0.126642
Validation r2 = 0.860867
Validation mse = 0.016038
Epoch 17
Loss = 1.3216e-01, PNorm = 34.9701, GNorm = 4.7360, lr_0 = 5.1599e-04
Validation rmse = 0.130695
Validation r2 = 0.851819
Validation mse = 0.017081
Epoch 18
Loss = 8.3969e-02, PNorm = 34.9893, GNorm = 2.2256, lr_0 = 5.0252e-04
Loss = 1.2919e-01, PNorm = 35.0089, GNorm = 2.0095, lr_0 = 4.8939e-04
Validation rmse = 0.127258
Validation r2 = 0.859510
Validation mse = 0.016195
Epoch 19
Loss = 1.2137e-01, PNorm = 35.0266, GNorm = 1.9830, lr_0 = 4.7535e-04
Loss = 1.2242e-01, PNorm = 35.0396, GNorm = 1.0809, lr_0 = 4.6293e-04
Validation rmse = 0.128120
Validation r2 = 0.857601
Validation mse = 0.016415
Epoch 20
Loss = 1.0696e-01, PNorm = 35.0518, GNorm = 1.6293, lr_0 = 4.5084e-04
Validation rmse = 0.126222
Validation r2 = 0.861789
Validation mse = 0.015932
Epoch 21
Loss = 1.1533e-01, PNorm = 35.0677, GNorm = 3.0284, lr_0 = 4.3790e-04
Loss = 1.1291e-01, PNorm = 35.0822, GNorm = 3.3445, lr_0 = 4.2647e-04
Validation rmse = 0.123547
Validation r2 = 0.867585
Validation mse = 0.015264
Epoch 22
Loss = 1.1048e-01, PNorm = 35.0962, GNorm = 3.7827, lr_0 = 4.1533e-04
Validation rmse = 0.125039
Validation r2 = 0.864367
Validation mse = 0.015635
Epoch 23
Loss = 1.0743e-01, PNorm = 35.1103, GNorm = 3.0584, lr_0 = 4.0341e-04
Loss = 1.2974e-01, PNorm = 35.1219, GNorm = 3.3811, lr_0 = 3.9287e-04
Validation rmse = 0.126741
Validation r2 = 0.860650
Validation mse = 0.016063
Epoch 24
Loss = 1.1305e-01, PNorm = 35.1348, GNorm = 2.8364, lr_0 = 3.8261e-04
Validation rmse = 0.123817
Validation r2 = 0.867006
Validation mse = 0.015331
Epoch 25
Loss = 1.2596e-01, PNorm = 35.1478, GNorm = 1.8749, lr_0 = 3.7262e-04
Loss = 1.0879e-01, PNorm = 35.1613, GNorm = 3.3228, lr_0 = 3.6289e-04
Validation rmse = 0.123550
Validation r2 = 0.867579
Validation mse = 0.015265
Epoch 26
Loss = 1.2785e-01, PNorm = 35.1713, GNorm = 5.3565, lr_0 = 3.5247e-04
Validation rmse = 0.125175
Validation r2 = 0.864073
Validation mse = 0.015669
Epoch 27
Loss = 8.9075e-02, PNorm = 35.1820, GNorm = 0.5400, lr_0 = 3.4327e-04
Loss = 1.0798e-01, PNorm = 35.1919, GNorm = 1.4383, lr_0 = 3.3430e-04
Validation rmse = 0.126905
Validation r2 = 0.860288
Validation mse = 0.016105
Epoch 28
Loss = 1.0041e-01, PNorm = 35.2049, GNorm = 0.8370, lr_0 = 3.2471e-04
Loss = 1.0560e-01, PNorm = 35.2135, GNorm = 2.3974, lr_0 = 3.1623e-04
Validation rmse = 0.123176
Validation r2 = 0.868380
Validation mse = 0.015172
Epoch 29
Loss = 1.0144e-01, PNorm = 35.2247, GNorm = 0.8888, lr_0 = 3.0797e-04
Validation rmse = 0.125292
Validation r2 = 0.863817
Validation mse = 0.015698
Epoch 30
Loss = 1.0438e-01, PNorm = 35.2335, GNorm = 1.2580, lr_0 = 2.9913e-04
Loss = 1.0537e-01, PNorm = 35.2410, GNorm = 4.7222, lr_0 = 2.9132e-04
Validation rmse = 0.123550
Validation r2 = 0.867579
Validation mse = 0.015265
Epoch 31
Loss = 1.0595e-01, PNorm = 35.2521, GNorm = 1.1986, lr_0 = 2.8371e-04
Validation rmse = 0.124630
Validation r2 = 0.865253
Validation mse = 0.015533
Epoch 32
Loss = 1.3758e-01, PNorm = 35.2610, GNorm = 4.9094, lr_0 = 2.7557e-04
Loss = 1.0634e-01, PNorm = 35.2691, GNorm = 2.9232, lr_0 = 2.6837e-04
Validation rmse = 0.135797
Validation r2 = 0.840025
Validation mse = 0.018441
Epoch 33
Loss = 1.0359e-01, PNorm = 35.2780, GNorm = 1.7387, lr_0 = 2.6136e-04
Validation rmse = 0.122625
Validation r2 = 0.869554
Validation mse = 0.015037
Epoch 34
Loss = 8.4568e-02, PNorm = 35.2888, GNorm = 2.3174, lr_0 = 2.5386e-04
Loss = 9.4633e-02, PNorm = 35.2947, GNorm = 2.6087, lr_0 = 2.4723e-04
Validation rmse = 0.121550
Validation r2 = 0.871830
Validation mse = 0.014774
Epoch 35
Loss = 1.2117e-01, PNorm = 35.3034, GNorm = 2.2529, lr_0 = 2.4077e-04
Validation rmse = 0.124881
Validation r2 = 0.864711
Validation mse = 0.015595
Epoch 36
Loss = 9.6592e-02, PNorm = 35.3116, GNorm = 1.5569, lr_0 = 2.3387e-04
Loss = 9.9199e-02, PNorm = 35.3167, GNorm = 2.4324, lr_0 = 2.2776e-04
Validation rmse = 0.122855
Validation r2 = 0.869065
Validation mse = 0.015093
Epoch 37
Loss = 9.3526e-02, PNorm = 35.3241, GNorm = 0.8838, lr_0 = 2.2181e-04
Validation rmse = 0.120437
Validation r2 = 0.874167
Validation mse = 0.014505
Epoch 38
Loss = 7.6161e-02, PNorm = 35.3303, GNorm = 1.4641, lr_0 = 2.1544e-04
Loss = 9.0274e-02, PNorm = 35.3361, GNorm = 1.6171, lr_0 = 2.0982e-04
Validation rmse = 0.120826
Validation r2 = 0.873354
Validation mse = 0.014599
Epoch 39
Loss = 9.4200e-02, PNorm = 35.3427, GNorm = 1.7056, lr_0 = 2.0434e-04
Loss = 9.4344e-02, PNorm = 35.3480, GNorm = 1.8775, lr_0 = 1.9900e-04
Loss = 6.2209e-02, PNorm = 35.3489, GNorm = 2.9226, lr_0 = 1.9847e-04
Validation rmse = 0.121017
Validation r2 = 0.872952
Validation mse = 0.014645
Epoch 40
Loss = 1.0734e-01, PNorm = 35.3545, GNorm = 1.0553, lr_0 = 1.9329e-04
Validation rmse = 0.120862
Validation r2 = 0.873277
Validation mse = 0.014608
Epoch 41
Loss = 7.7903e-02, PNorm = 35.3601, GNorm = 1.0521, lr_0 = 1.8824e-04
Loss = 9.6336e-02, PNorm = 35.3654, GNorm = 0.5287, lr_0 = 1.8332e-04
Validation rmse = 0.119967
Validation r2 = 0.875149
Validation mse = 0.014392
Epoch 42
Loss = 8.0933e-02, PNorm = 35.3709, GNorm = 2.6762, lr_0 = 1.7806e-04
Validation rmse = 0.120979
Validation r2 = 0.873033
Validation mse = 0.014636
Epoch 43
Loss = 8.2879e-02, PNorm = 35.3765, GNorm = 2.1943, lr_0 = 1.7341e-04
Loss = 9.2392e-02, PNorm = 35.3806, GNorm = 0.9989, lr_0 = 1.6888e-04
Validation rmse = 0.121335
Validation r2 = 0.872284
Validation mse = 0.014722
Epoch 44
Loss = 9.8619e-02, PNorm = 35.3861, GNorm = 2.4231, lr_0 = 1.6404e-04
Validation rmse = 0.120411
Validation r2 = 0.874221
Validation mse = 0.014499
Epoch 45
Loss = 7.5720e-02, PNorm = 35.3907, GNorm = 1.8221, lr_0 = 1.5975e-04
Loss = 8.9037e-02, PNorm = 35.3959, GNorm = 1.8251, lr_0 = 1.5558e-04
Validation rmse = 0.119487
Validation r2 = 0.876145
Validation mse = 0.014277
Epoch 46
Loss = 8.8243e-02, PNorm = 35.4007, GNorm = 1.5750, lr_0 = 1.5112e-04
Validation rmse = 0.121235
Validation r2 = 0.872494
Validation mse = 0.014698
Epoch 47
Loss = 1.1199e-01, PNorm = 35.4044, GNorm = 0.8241, lr_0 = 1.4717e-04
Loss = 8.6147e-02, PNorm = 35.4086, GNorm = 2.0186, lr_0 = 1.4332e-04
Validation rmse = 0.119699
Validation r2 = 0.875705
Validation mse = 0.014328
Epoch 48
Loss = 9.5250e-02, PNorm = 35.4123, GNorm = 1.3404, lr_0 = 1.3921e-04
Loss = 7.8759e-02, PNorm = 35.4170, GNorm = 1.8390, lr_0 = 1.3558e-04
Validation rmse = 0.120326
Validation r2 = 0.874399
Validation mse = 0.014478
Epoch 49
Loss = 9.1511e-02, PNorm = 35.4212, GNorm = 0.6739, lr_0 = 1.3204e-04
Validation rmse = 0.121265
Validation r2 = 0.872432
Validation mse = 0.014705
Epoch 50
Loss = 7.6980e-02, PNorm = 35.4245, GNorm = 2.3103, lr_0 = 1.2859e-04
Loss = 8.9805e-02, PNorm = 35.4282, GNorm = 0.6389, lr_0 = 1.2523e-04
Validation rmse = 0.120938
Validation r2 = 0.873118
Validation mse = 0.014626
Epoch 51
Loss = 8.5071e-02, PNorm = 35.4322, GNorm = 0.9978, lr_0 = 1.2163e-04
Validation rmse = 0.119548
Validation r2 = 0.876018
Validation mse = 0.014292
Epoch 52
Loss = 8.8345e-02, PNorm = 35.4358, GNorm = 0.6013, lr_0 = 1.1846e-04
Loss = 8.8976e-02, PNorm = 35.4403, GNorm = 2.3133, lr_0 = 1.1536e-04
Validation rmse = 0.120954
Validation r2 = 0.873085
Validation mse = 0.014630
Epoch 53
Loss = 8.1021e-02, PNorm = 35.4439, GNorm = 0.9735, lr_0 = 1.1205e-04
Validation rmse = 0.122806
Validation r2 = 0.869169
Validation mse = 0.015081
Epoch 54
Loss = 7.3917e-02, PNorm = 35.4460, GNorm = 1.3938, lr_0 = 1.0913e-04
Loss = 8.4111e-02, PNorm = 35.4499, GNorm = 1.3529, lr_0 = 1.0628e-04
Validation rmse = 0.121036
Validation r2 = 0.872913
Validation mse = 0.014650
Epoch 55
Loss = 7.9707e-02, PNorm = 35.4541, GNorm = 3.2918, lr_0 = 1.0323e-04
Validation rmse = 0.120403
Validation r2 = 0.874239
Validation mse = 0.014497
Epoch 56
Loss = 5.2155e-02, PNorm = 35.4573, GNorm = 1.0333, lr_0 = 1.0053e-04
Loss = 9.8048e-02, PNorm = 35.4603, GNorm = 4.0562, lr_0 = 1.0000e-04
Validation rmse = 0.120367
Validation r2 = 0.874314
Validation mse = 0.014488
Epoch 57
Loss = 8.4441e-02, PNorm = 35.4638, GNorm = 0.9909, lr_0 = 1.0000e-04
Loss = 8.2691e-02, PNorm = 35.4667, GNorm = 0.8076, lr_0 = 1.0000e-04
Validation rmse = 0.121141
Validation r2 = 0.872692
Validation mse = 0.014675
Epoch 58
Loss = 7.5530e-02, PNorm = 35.4697, GNorm = 0.5675, lr_0 = 1.0000e-04
Validation rmse = 0.119327
Validation r2 = 0.876476
Validation mse = 0.014239
Epoch 59
Loss = 8.0218e-02, PNorm = 35.4733, GNorm = 0.7473, lr_0 = 1.0000e-04
Loss = 8.6346e-02, PNorm = 35.4761, GNorm = 1.2224, lr_0 = 1.0000e-04
Validation rmse = 0.119196
Validation r2 = 0.876747
Validation mse = 0.014208
Model 0 best validation rmse = 0.119196 on epoch 59
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.511010
Model 0 test r2 = -5.196907
Model 0 test mse = 0.261131
Ensemble test rmse = 0.511010
Ensemble test r2 = -5.196907
Ensemble test mse = 0.261131
10-fold cross validation
	Seed 0 ==> test rmse = 0.430674
	Seed 0 ==> test r2 = -3.401634
	Seed 0 ==> test mse = 0.185480
	Seed 1 ==> test rmse = 0.507135
	Seed 1 ==> test r2 = -5.103270
	Seed 1 ==> test mse = 0.257186
	Seed 2 ==> test rmse = 0.455541
	Seed 2 ==> test r2 = -3.924606
	Seed 2 ==> test mse = 0.207518
	Seed 3 ==> test rmse = 0.457542
	Seed 3 ==> test r2 = -3.967960
	Seed 3 ==> test mse = 0.209345
	Seed 4 ==> test rmse = 0.463478
	Seed 4 ==> test r2 = -4.097689
	Seed 4 ==> test mse = 0.214812
	Seed 5 ==> test rmse = 0.393794
	Seed 5 ==> test r2 = -2.680045
	Seed 5 ==> test mse = 0.155073
	Seed 6 ==> test rmse = 0.438288
	Seed 6 ==> test r2 = -3.558642
	Seed 6 ==> test mse = 0.192097
	Seed 7 ==> test rmse = 0.420530
	Seed 7 ==> test r2 = -3.196720
	Seed 7 ==> test mse = 0.176846
	Seed 8 ==> test rmse = 0.449533
	Seed 8 ==> test r2 = -3.795562
	Seed 8 ==> test mse = 0.202080
	Seed 9 ==> test rmse = 0.511010
	Seed 9 ==> test r2 = -5.196907
	Seed 9 ==> test mse = 0.261131
Overall test rmse = 0.452753 +/- 0.034232
Overall test r2 = -3.892304 +/- 0.743790
Overall test mse = 0.206157 +/- 0.031343
Elapsed time = 0:06:53
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-1d5c3576-9790-4896-9034-9bb28ba18d8e.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/MeTHF_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2', 'mse'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2', 'mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/generalization_3/MeTHF_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/MeTHF_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 963 | train size = 770 | val size = 193 | test size = 59
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.0056e-01, PNorm = 34.0174, GNorm = 3.3523, lr_0 = 4.3000e-04
Validation rmse = 0.278089
Validation r2 = 0.331808
Validation mse = 0.077334
Epoch 1
Loss = 7.0505e-01, PNorm = 34.0483, GNorm = 6.2962, lr_0 = 7.6000e-04
Loss = 5.7212e-01, PNorm = 34.1170, GNorm = 7.1477, lr_0 = 9.9472e-04
Loss = 7.8627e-01, PNorm = 34.1238, GNorm = 3.9882, lr_0 = 9.9209e-04
Validation rmse = 0.219544
Validation r2 = 0.583539
Validation mse = 0.048199
Epoch 2
Loss = 4.9269e-01, PNorm = 34.1978, GNorm = 3.2873, lr_0 = 9.6618e-04
Validation rmse = 0.234379
Validation r2 = 0.525355
Validation mse = 0.054933
Epoch 3
Loss = 3.7477e-01, PNorm = 34.2673, GNorm = 2.2941, lr_0 = 9.4094e-04
Loss = 3.6816e-01, PNorm = 34.3299, GNorm = 8.9806, lr_0 = 9.1637e-04
Validation rmse = 0.233887
Validation r2 = 0.527344
Validation mse = 0.054703
Epoch 4
Loss = 3.9458e-01, PNorm = 34.3860, GNorm = 3.7730, lr_0 = 8.9007e-04
Validation rmse = 0.204077
Validation r2 = 0.640150
Validation mse = 0.041647
Epoch 5
Loss = 2.8581e-01, PNorm = 34.4322, GNorm = 3.3488, lr_0 = 8.6682e-04
Loss = 2.6195e-01, PNorm = 34.4776, GNorm = 4.1132, lr_0 = 8.4418e-04
Validation rmse = 0.157599
Validation r2 = 0.785395
Validation mse = 0.024837
Epoch 6
Loss = 1.8912e-01, PNorm = 34.5214, GNorm = 2.7423, lr_0 = 8.1996e-04
Validation rmse = 0.143026
Validation r2 = 0.823249
Validation mse = 0.020456
Epoch 7
Loss = 2.2057e-01, PNorm = 34.5688, GNorm = 6.4517, lr_0 = 7.9643e-04
Loss = 2.0987e-01, PNorm = 34.6078, GNorm = 5.3880, lr_0 = 7.7563e-04
Validation rmse = 0.152920
Validation r2 = 0.797948
Validation mse = 0.023385
Epoch 8
Loss = 1.5317e-01, PNorm = 34.6362, GNorm = 2.5192, lr_0 = 7.5537e-04
Validation rmse = 0.140679
Validation r2 = 0.829002
Validation mse = 0.019791
Epoch 9
Loss = 1.5087e-01, PNorm = 34.6720, GNorm = 1.9922, lr_0 = 7.3370e-04
Loss = 1.4933e-01, PNorm = 34.7032, GNorm = 2.9555, lr_0 = 7.1453e-04
Validation rmse = 0.133044
Validation r2 = 0.847059
Validation mse = 0.017701
Epoch 10
Loss = 1.4175e-01, PNorm = 34.7322, GNorm = 1.3706, lr_0 = 6.9587e-04
Validation rmse = 0.126951
Validation r2 = 0.860746
Validation mse = 0.016117
Epoch 11
Loss = 1.2236e-01, PNorm = 34.7578, GNorm = 0.7773, lr_0 = 6.7590e-04
Loss = 1.2335e-01, PNorm = 34.7816, GNorm = 2.8616, lr_0 = 6.5825e-04
Validation rmse = 0.125730
Validation r2 = 0.863413
Validation mse = 0.015808
Epoch 12
Loss = 1.2136e-01, PNorm = 34.8009, GNorm = 4.2302, lr_0 = 6.3936e-04
Loss = 1.3772e-01, PNorm = 34.8234, GNorm = 7.4310, lr_0 = 6.2266e-04
Validation rmse = 0.127459
Validation r2 = 0.859629
Validation mse = 0.016246
Epoch 13
Loss = 1.2925e-01, PNorm = 34.8414, GNorm = 1.3666, lr_0 = 6.0640e-04
Validation rmse = 0.121137
Validation r2 = 0.873211
Validation mse = 0.014674
Epoch 14
Loss = 1.3318e-01, PNorm = 34.8633, GNorm = 1.4463, lr_0 = 5.8900e-04
Loss = 1.0654e-01, PNorm = 34.8791, GNorm = 0.6780, lr_0 = 5.7362e-04
Validation rmse = 0.125325
Validation r2 = 0.864292
Validation mse = 0.015706
Epoch 15
Loss = 1.0950e-01, PNorm = 34.8974, GNorm = 2.5981, lr_0 = 5.5863e-04
Validation rmse = 0.120442
Validation r2 = 0.874659
Validation mse = 0.014506
Epoch 16
Loss = 1.0291e-01, PNorm = 34.9124, GNorm = 2.3664, lr_0 = 5.4260e-04
Loss = 1.0631e-01, PNorm = 34.9268, GNorm = 2.2948, lr_0 = 5.2843e-04
Validation rmse = 0.118999
Validation r2 = 0.877646
Validation mse = 0.014161
Epoch 17
Loss = 9.5576e-02, PNorm = 34.9426, GNorm = 0.9788, lr_0 = 5.1327e-04
Validation rmse = 0.120337
Validation r2 = 0.874879
Validation mse = 0.014481
Epoch 18
Loss = 1.3511e-01, PNorm = 34.9580, GNorm = 5.0755, lr_0 = 4.9986e-04
Loss = 1.3251e-01, PNorm = 34.9768, GNorm = 7.8178, lr_0 = 4.8681e-04
Validation rmse = 0.171269
Validation r2 = 0.746550
Validation mse = 0.029333
Epoch 19
Loss = 1.8751e-01, PNorm = 34.9984, GNorm = 5.3121, lr_0 = 4.7284e-04
Validation rmse = 0.142668
Validation r2 = 0.824132
Validation mse = 0.020354
Epoch 20
Loss = 1.4649e-01, PNorm = 35.0143, GNorm = 3.6494, lr_0 = 4.6049e-04
Loss = 1.2084e-01, PNorm = 35.0330, GNorm = 0.7656, lr_0 = 4.4846e-04
Validation rmse = 0.122872
Validation r2 = 0.869552
Validation mse = 0.015098
Epoch 21
Loss = 1.0700e-01, PNorm = 35.0495, GNorm = 3.5446, lr_0 = 4.3559e-04
Validation rmse = 0.143227
Validation r2 = 0.822751
Validation mse = 0.020514
Epoch 22
Loss = 1.4902e-01, PNorm = 35.0667, GNorm = 5.1778, lr_0 = 4.2309e-04
Loss = 9.6507e-02, PNorm = 35.0792, GNorm = 0.9416, lr_0 = 4.1204e-04
Validation rmse = 0.117242
Validation r2 = 0.881232
Validation mse = 0.013746
Epoch 23
Loss = 1.0175e-01, PNorm = 35.0950, GNorm = 2.2045, lr_0 = 4.0128e-04
Validation rmse = 0.119505
Validation r2 = 0.876603
Validation mse = 0.014281
Epoch 24
Loss = 5.7858e-02, PNorm = 35.1092, GNorm = 0.6567, lr_0 = 3.8977e-04
Loss = 1.0104e-01, PNorm = 35.1224, GNorm = 1.5281, lr_0 = 3.7959e-04
Validation rmse = 0.122750
Validation r2 = 0.869811
Validation mse = 0.015068
Epoch 25
Loss = 1.1141e-01, PNorm = 35.1343, GNorm = 0.8845, lr_0 = 3.6967e-04
Loss = 1.0295e-01, PNorm = 35.1472, GNorm = 0.9422, lr_0 = 3.6002e-04
Loss = 6.9036e-02, PNorm = 35.1480, GNorm = 2.4629, lr_0 = 3.5906e-04
Validation rmse = 0.115413
Validation r2 = 0.884908
Validation mse = 0.013320
Epoch 26
Loss = 9.4589e-02, PNorm = 35.1574, GNorm = 1.0590, lr_0 = 3.4969e-04
Validation rmse = 0.119110
Validation r2 = 0.877417
Validation mse = 0.014187
Epoch 27
Loss = 8.2235e-02, PNorm = 35.1698, GNorm = 0.5659, lr_0 = 3.3965e-04
Loss = 9.1370e-02, PNorm = 35.1815, GNorm = 1.4838, lr_0 = 3.3078e-04
Validation rmse = 0.115875
Validation r2 = 0.883985
Validation mse = 0.013427
Epoch 28
Loss = 9.3468e-02, PNorm = 35.1917, GNorm = 2.4779, lr_0 = 3.2214e-04
Validation rmse = 0.118317
Validation r2 = 0.879044
Validation mse = 0.013999
Epoch 29
Loss = 9.6072e-02, PNorm = 35.2037, GNorm = 2.5457, lr_0 = 3.1290e-04
Loss = 9.4902e-02, PNorm = 35.2136, GNorm = 3.1049, lr_0 = 3.0472e-04
Validation rmse = 0.112684
Validation r2 = 0.890288
Validation mse = 0.012698
Epoch 30
Loss = 9.3482e-02, PNorm = 35.2256, GNorm = 3.2682, lr_0 = 2.9677e-04
Validation rmse = 0.114503
Validation r2 = 0.886716
Validation mse = 0.013111
Epoch 31
Loss = 1.1533e-01, PNorm = 35.2360, GNorm = 3.4306, lr_0 = 2.8825e-04
Loss = 9.2957e-02, PNorm = 35.2460, GNorm = 0.8816, lr_0 = 2.8072e-04
Validation rmse = 0.113984
Validation r2 = 0.887741
Validation mse = 0.012992
Epoch 32
Loss = 9.3762e-02, PNorm = 35.2561, GNorm = 2.6521, lr_0 = 2.7267e-04
Validation rmse = 0.114741
Validation r2 = 0.886245
Validation mse = 0.013166
Epoch 33
Loss = 7.4094e-02, PNorm = 35.2666, GNorm = 1.6514, lr_0 = 2.6554e-04
Loss = 8.5293e-02, PNorm = 35.2748, GNorm = 0.8779, lr_0 = 2.5861e-04
Validation rmse = 0.111735
Validation r2 = 0.892127
Validation mse = 0.012485
Epoch 34
Loss = 8.4834e-02, PNorm = 35.2845, GNorm = 1.4376, lr_0 = 2.5119e-04
Validation rmse = 0.112791
Validation r2 = 0.890078
Validation mse = 0.012722
Epoch 35
Loss = 7.5769e-02, PNorm = 35.2924, GNorm = 1.3181, lr_0 = 2.4463e-04
Loss = 7.3912e-02, PNorm = 35.3025, GNorm = 0.8386, lr_0 = 2.3824e-04
Validation rmse = 0.113456
Validation r2 = 0.888779
Validation mse = 0.012872
Epoch 36
Loss = 8.2384e-02, PNorm = 35.3111, GNorm = 1.8193, lr_0 = 2.3140e-04
Validation rmse = 0.112869
Validation r2 = 0.889927
Validation mse = 0.012739
Epoch 37
Loss = 8.7902e-02, PNorm = 35.3195, GNorm = 1.3019, lr_0 = 2.2476e-04
Loss = 8.3729e-02, PNorm = 35.3273, GNorm = 0.5120, lr_0 = 2.1889e-04
Validation rmse = 0.115809
Validation r2 = 0.884117
Validation mse = 0.013412
Epoch 38
Loss = 9.2530e-02, PNorm = 35.3362, GNorm = 2.1222, lr_0 = 2.1317e-04
Loss = 7.6375e-02, PNorm = 35.3437, GNorm = 2.1200, lr_0 = 2.0761e-04
Loss = 4.5180e-02, PNorm = 35.3445, GNorm = 1.7587, lr_0 = 2.0706e-04
Validation rmse = 0.111302
Validation r2 = 0.892962
Validation mse = 0.012388
Epoch 39
Loss = 6.9189e-02, PNorm = 35.3521, GNorm = 2.1496, lr_0 = 2.0165e-04
Validation rmse = 0.111269
Validation r2 = 0.893025
Validation mse = 0.012381
Epoch 40
Loss = 6.8119e-02, PNorm = 35.3590, GNorm = 3.1113, lr_0 = 1.9638e-04
Loss = 8.2667e-02, PNorm = 35.3663, GNorm = 1.2955, lr_0 = 1.9125e-04
Validation rmse = 0.111504
Validation r2 = 0.892573
Validation mse = 0.012433
Epoch 41
Loss = 7.6883e-02, PNorm = 35.3745, GNorm = 2.0133, lr_0 = 1.8577e-04
Validation rmse = 0.111196
Validation r2 = 0.893165
Validation mse = 0.012365
Epoch 42
Loss = 7.5568e-02, PNorm = 35.3812, GNorm = 0.6281, lr_0 = 1.8044e-04
Loss = 7.6154e-02, PNorm = 35.3872, GNorm = 2.5656, lr_0 = 1.7572e-04
Validation rmse = 0.111833
Validation r2 = 0.891939
Validation mse = 0.012507
Epoch 43
Loss = 8.2782e-02, PNorm = 35.3942, GNorm = 1.2293, lr_0 = 1.7113e-04
Validation rmse = 0.111577
Validation r2 = 0.892432
Validation mse = 0.012449
Epoch 44
Loss = 8.2933e-02, PNorm = 35.4006, GNorm = 0.7196, lr_0 = 1.6622e-04
Loss = 7.2997e-02, PNorm = 35.4062, GNorm = 1.3785, lr_0 = 1.6188e-04
Validation rmse = 0.110415
Validation r2 = 0.894661
Validation mse = 0.012191
Epoch 45
Loss = 6.8888e-02, PNorm = 35.4119, GNorm = 0.9962, lr_0 = 1.5765e-04
Validation rmse = 0.113047
Validation r2 = 0.889580
Validation mse = 0.012780
Epoch 46
Loss = 8.0304e-02, PNorm = 35.4184, GNorm = 1.6570, lr_0 = 1.5313e-04
Loss = 6.8429e-02, PNorm = 35.4241, GNorm = 1.5940, lr_0 = 1.4913e-04
Validation rmse = 0.110901
Validation r2 = 0.893733
Validation mse = 0.012299
Epoch 47
Loss = 6.5304e-02, PNorm = 35.4300, GNorm = 1.1151, lr_0 = 1.4485e-04
Validation rmse = 0.111039
Validation r2 = 0.893467
Validation mse = 0.012330
Epoch 48
Loss = 5.8756e-02, PNorm = 35.4356, GNorm = 0.4765, lr_0 = 1.4107e-04
Loss = 7.1433e-02, PNorm = 35.4408, GNorm = 1.3098, lr_0 = 1.3738e-04
Validation rmse = 0.111257
Validation r2 = 0.893048
Validation mse = 0.012378
Epoch 49
Loss = 7.2136e-02, PNorm = 35.4460, GNorm = 0.8446, lr_0 = 1.3344e-04
Loss = 7.2484e-02, PNorm = 35.4510, GNorm = 3.0113, lr_0 = 1.2996e-04
Validation rmse = 0.111275
Validation r2 = 0.893014
Validation mse = 0.012382
Epoch 50
Loss = 7.1417e-02, PNorm = 35.4560, GNorm = 1.6243, lr_0 = 1.2656e-04
Validation rmse = 0.110440
Validation r2 = 0.894614
Validation mse = 0.012197
Epoch 51
Loss = 6.0765e-02, PNorm = 35.4608, GNorm = 2.8730, lr_0 = 1.2293e-04
Loss = 7.4393e-02, PNorm = 35.4657, GNorm = 1.3108, lr_0 = 1.1972e-04
Loss = 7.4026e-02, PNorm = 35.4663, GNorm = 3.0415, lr_0 = 1.1940e-04
Validation rmse = 0.111007
Validation r2 = 0.893529
Validation mse = 0.012322
Epoch 52
Loss = 7.0250e-02, PNorm = 35.4705, GNorm = 2.4257, lr_0 = 1.1628e-04
Validation rmse = 0.112447
Validation r2 = 0.890748
Validation mse = 0.012644
Epoch 53
Loss = 6.1255e-02, PNorm = 35.4749, GNorm = 0.5298, lr_0 = 1.1325e-04
Loss = 7.6680e-02, PNorm = 35.4784, GNorm = 1.5746, lr_0 = 1.1029e-04
Validation rmse = 0.111217
Validation r2 = 0.893126
Validation mse = 0.012369
Epoch 54
Loss = 7.1008e-02, PNorm = 35.4828, GNorm = 0.9738, lr_0 = 1.0712e-04
Validation rmse = 0.113677
Validation r2 = 0.888346
Validation mse = 0.012922
Epoch 55
Loss = 8.0800e-02, PNorm = 35.4868, GNorm = 2.7558, lr_0 = 1.0433e-04
Loss = 7.1762e-02, PNorm = 35.4911, GNorm = 0.5743, lr_0 = 1.0160e-04
Validation rmse = 0.111319
Validation r2 = 0.892929
Validation mse = 0.012392
Epoch 56
Loss = 6.6327e-02, PNorm = 35.4955, GNorm = 0.8658, lr_0 = 1.0000e-04
Validation rmse = 0.112552
Validation r2 = 0.890544
Validation mse = 0.012668
Epoch 57
Loss = 6.3878e-02, PNorm = 35.4992, GNorm = 0.8398, lr_0 = 1.0000e-04
Loss = 6.9506e-02, PNorm = 35.5024, GNorm = 1.8979, lr_0 = 1.0000e-04
Validation rmse = 0.110073
Validation r2 = 0.895313
Validation mse = 0.012116
Epoch 58
Loss = 6.4835e-02, PNorm = 35.5061, GNorm = 0.5681, lr_0 = 1.0000e-04
Validation rmse = 0.110971
Validation r2 = 0.893597
Validation mse = 0.012315
Epoch 59
Loss = 5.8406e-02, PNorm = 35.5103, GNorm = 0.9655, lr_0 = 1.0000e-04
Loss = 6.8976e-02, PNorm = 35.5141, GNorm = 0.4095, lr_0 = 1.0000e-04
Validation rmse = 0.110225
Validation r2 = 0.895023
Validation mse = 0.012150
Model 0 best validation rmse = 0.110073 on epoch 57
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.213981
Model 0 test r2 = 0.331227
Model 0 test mse = 0.045788
Ensemble test rmse = 0.213981
Ensemble test r2 = 0.331227
Ensemble test mse = 0.045788
Fold 1
Splitting data with seed 1
Total size = 963 | train size = 770 | val size = 193 | test size = 59
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.0640e-01, PNorm = 34.0169, GNorm = 3.6711, lr_0 = 4.3000e-04
Validation rmse = 0.310521
Validation r2 = 0.155812
Validation mse = 0.096423
Epoch 1
Loss = 6.8097e-01, PNorm = 34.0482, GNorm = 2.5084, lr_0 = 7.6000e-04
Loss = 5.8246e-01, PNorm = 34.1103, GNorm = 0.8302, lr_0 = 9.9472e-04
Loss = 3.9869e-01, PNorm = 34.1191, GNorm = 3.8634, lr_0 = 9.9209e-04
Validation rmse = 0.239046
Validation r2 = 0.499712
Validation mse = 0.057143
Epoch 2
Loss = 4.1992e-01, PNorm = 34.2077, GNorm = 3.5361, lr_0 = 9.6618e-04
Validation rmse = 0.237759
Validation r2 = 0.505083
Validation mse = 0.056529
Epoch 3
Loss = 5.7026e-01, PNorm = 34.2763, GNorm = 10.6581, lr_0 = 9.4094e-04
Loss = 3.3304e-01, PNorm = 34.3398, GNorm = 2.0280, lr_0 = 9.1637e-04
Validation rmse = 0.206969
Validation r2 = 0.624967
Validation mse = 0.042836
Epoch 4
Loss = 3.1124e-01, PNorm = 34.4025, GNorm = 2.1615, lr_0 = 8.9007e-04
Validation rmse = 0.172513
Validation r2 = 0.739443
Validation mse = 0.029761
Epoch 5
Loss = 2.3249e-01, PNorm = 34.4560, GNorm = 6.0074, lr_0 = 8.6682e-04
Loss = 2.5474e-01, PNorm = 34.5061, GNorm = 3.5962, lr_0 = 8.4418e-04
Validation rmse = 0.170942
Validation r2 = 0.744167
Validation mse = 0.029221
Epoch 6
Loss = 1.9541e-01, PNorm = 34.5520, GNorm = 1.0850, lr_0 = 8.1996e-04
Validation rmse = 0.146160
Validation r2 = 0.812967
Validation mse = 0.021363
Epoch 7
Loss = 1.4224e-01, PNorm = 34.5959, GNorm = 1.4133, lr_0 = 7.9643e-04
Loss = 1.7048e-01, PNorm = 34.6314, GNorm = 1.1225, lr_0 = 7.7563e-04
Validation rmse = 0.150431
Validation r2 = 0.801878
Validation mse = 0.022629
Epoch 8
Loss = 1.6790e-01, PNorm = 34.6691, GNorm = 1.7047, lr_0 = 7.5537e-04
Validation rmse = 0.152891
Validation r2 = 0.795345
Validation mse = 0.023376
Epoch 9
Loss = 1.5514e-01, PNorm = 34.7022, GNorm = 1.3757, lr_0 = 7.3370e-04
Loss = 1.7276e-01, PNorm = 34.7287, GNorm = 1.1069, lr_0 = 7.1453e-04
Validation rmse = 0.184867
Validation r2 = 0.700789
Validation mse = 0.034176
Epoch 10
Loss = 2.2301e-01, PNorm = 34.7502, GNorm = 6.1676, lr_0 = 6.9587e-04
Validation rmse = 0.139912
Validation r2 = 0.828616
Validation mse = 0.019575
Epoch 11
Loss = 8.6033e-02, PNorm = 34.7821, GNorm = 1.1022, lr_0 = 6.7590e-04
Loss = 1.5878e-01, PNorm = 34.8049, GNorm = 1.5994, lr_0 = 6.5825e-04
Validation rmse = 0.142540
Validation r2 = 0.822118
Validation mse = 0.020318
Epoch 12
Loss = 1.6906e-01, PNorm = 34.8353, GNorm = 1.0322, lr_0 = 6.3936e-04
Loss = 1.6417e-01, PNorm = 34.8611, GNorm = 4.8210, lr_0 = 6.2266e-04
Validation rmse = 0.154838
Validation r2 = 0.790101
Validation mse = 0.023975
Epoch 13
Loss = 1.5283e-01, PNorm = 34.8849, GNorm = 1.2967, lr_0 = 6.0640e-04
Validation rmse = 0.128148
Validation r2 = 0.856225
Validation mse = 0.016422
Epoch 14
Loss = 1.3169e-01, PNorm = 34.9095, GNorm = 2.2820, lr_0 = 5.8900e-04
Loss = 1.2349e-01, PNorm = 34.9317, GNorm = 1.4181, lr_0 = 5.7362e-04
Validation rmse = 0.125545
Validation r2 = 0.862007
Validation mse = 0.015762
Epoch 15
Loss = 1.2204e-01, PNorm = 34.9437, GNorm = 0.9954, lr_0 = 5.5863e-04
Validation rmse = 0.126302
Validation r2 = 0.860338
Validation mse = 0.015952
Epoch 16
Loss = 9.7809e-02, PNorm = 34.9613, GNorm = 0.5542, lr_0 = 5.4260e-04
Loss = 1.1003e-01, PNorm = 34.9773, GNorm = 2.3410, lr_0 = 5.2843e-04
Validation rmse = 0.135676
Validation r2 = 0.838838
Validation mse = 0.018408
Epoch 17
Loss = 1.1290e-01, PNorm = 34.9948, GNorm = 1.7186, lr_0 = 5.1327e-04
Validation rmse = 0.127287
Validation r2 = 0.858150
Validation mse = 0.016202
Epoch 18
Loss = 7.5807e-02, PNorm = 35.0073, GNorm = 1.2363, lr_0 = 4.9986e-04
Loss = 1.2291e-01, PNorm = 35.0186, GNorm = 2.8290, lr_0 = 4.8681e-04
Validation rmse = 0.133970
Validation r2 = 0.842864
Validation mse = 0.017948
Epoch 19
Loss = 1.0495e-01, PNorm = 35.0352, GNorm = 0.5858, lr_0 = 4.7284e-04
Validation rmse = 0.135758
Validation r2 = 0.838643
Validation mse = 0.018430
Epoch 20
Loss = 8.8592e-02, PNorm = 35.0505, GNorm = 2.7815, lr_0 = 4.6049e-04
Loss = 9.7458e-02, PNorm = 35.0644, GNorm = 0.9498, lr_0 = 4.4846e-04
Validation rmse = 0.128014
Validation r2 = 0.856526
Validation mse = 0.016388
Epoch 21
Loss = 1.1112e-01, PNorm = 35.0792, GNorm = 4.2394, lr_0 = 4.3559e-04
Validation rmse = 0.121651
Validation r2 = 0.870434
Validation mse = 0.014799
Epoch 22
Loss = 1.0399e-01, PNorm = 35.0919, GNorm = 0.7863, lr_0 = 4.2309e-04
Loss = 9.4461e-02, PNorm = 35.1034, GNorm = 0.8841, lr_0 = 4.1204e-04
Validation rmse = 0.125256
Validation r2 = 0.862643
Validation mse = 0.015689
Epoch 23
Loss = 9.4748e-02, PNorm = 35.1156, GNorm = 0.6548, lr_0 = 4.0128e-04
Validation rmse = 0.123585
Validation r2 = 0.866281
Validation mse = 0.015273
Epoch 24
Loss = 1.0988e-01, PNorm = 35.1282, GNorm = 1.0115, lr_0 = 3.8977e-04
Loss = 9.2909e-02, PNorm = 35.1381, GNorm = 1.2656, lr_0 = 3.7959e-04
Validation rmse = 0.133773
Validation r2 = 0.843327
Validation mse = 0.017895
Epoch 25
Loss = 9.0798e-02, PNorm = 35.1492, GNorm = 2.2084, lr_0 = 3.6967e-04
Loss = 9.5840e-02, PNorm = 35.1619, GNorm = 1.9026, lr_0 = 3.6002e-04
Loss = 5.9603e-02, PNorm = 35.1631, GNorm = 0.8372, lr_0 = 3.5906e-04
Validation rmse = 0.121672
Validation r2 = 0.870390
Validation mse = 0.014804
Epoch 26
Loss = 8.4746e-02, PNorm = 35.1721, GNorm = 3.0043, lr_0 = 3.4969e-04
Validation rmse = 0.122367
Validation r2 = 0.868906
Validation mse = 0.014974
Epoch 27
Loss = 9.3310e-02, PNorm = 35.1854, GNorm = 1.4113, lr_0 = 3.3965e-04
Loss = 8.5772e-02, PNorm = 35.1942, GNorm = 1.8020, lr_0 = 3.3078e-04
Validation rmse = 0.125194
Validation r2 = 0.862779
Validation mse = 0.015673
Epoch 28
Loss = 9.1348e-02, PNorm = 35.2068, GNorm = 1.4971, lr_0 = 3.2214e-04
Validation rmse = 0.124973
Validation r2 = 0.863262
Validation mse = 0.015618
Epoch 29
Loss = 1.0878e-01, PNorm = 35.2171, GNorm = 0.5922, lr_0 = 3.1290e-04
Loss = 8.9005e-02, PNorm = 35.2276, GNorm = 1.1848, lr_0 = 3.0472e-04
Validation rmse = 0.143380
Validation r2 = 0.820014
Validation mse = 0.020558
Epoch 30
Loss = 9.4837e-02, PNorm = 35.2356, GNorm = 0.7895, lr_0 = 2.9677e-04
Validation rmse = 0.123226
Validation r2 = 0.867059
Validation mse = 0.015185
Epoch 31
Loss = 7.6809e-02, PNorm = 35.2483, GNorm = 1.5096, lr_0 = 2.8825e-04
Loss = 9.5121e-02, PNorm = 35.2565, GNorm = 0.8065, lr_0 = 2.8072e-04
Validation rmse = 0.129546
Validation r2 = 0.853072
Validation mse = 0.016782
Epoch 32
Loss = 8.1311e-02, PNorm = 35.2708, GNorm = 0.8103, lr_0 = 2.7267e-04
Validation rmse = 0.121066
Validation r2 = 0.871678
Validation mse = 0.014657
Epoch 33
Loss = 1.0679e-01, PNorm = 35.2813, GNorm = 2.1845, lr_0 = 2.6554e-04
Loss = 8.5162e-02, PNorm = 35.2893, GNorm = 2.9126, lr_0 = 2.5861e-04
Validation rmse = 0.132929
Validation r2 = 0.845297
Validation mse = 0.017670
Epoch 34
Loss = 9.2599e-02, PNorm = 35.2987, GNorm = 3.0573, lr_0 = 2.5119e-04
Validation rmse = 0.118990
Validation r2 = 0.876041
Validation mse = 0.014159
Epoch 35
Loss = 6.6336e-02, PNorm = 35.3069, GNorm = 1.0912, lr_0 = 2.4463e-04
Loss = 7.6780e-02, PNorm = 35.3159, GNorm = 0.5489, lr_0 = 2.3824e-04
Validation rmse = 0.119872
Validation r2 = 0.874197
Validation mse = 0.014369
Epoch 36
Loss = 7.5135e-02, PNorm = 35.3258, GNorm = 0.7529, lr_0 = 2.3140e-04
Validation rmse = 0.117866
Validation r2 = 0.878371
Validation mse = 0.013892
Epoch 37
Loss = 9.9727e-02, PNorm = 35.3330, GNorm = 1.1454, lr_0 = 2.2476e-04
Loss = 7.7348e-02, PNorm = 35.3398, GNorm = 2.2868, lr_0 = 2.1889e-04
Validation rmse = 0.124393
Validation r2 = 0.864528
Validation mse = 0.015474
Epoch 38
Loss = 7.4291e-02, PNorm = 35.3472, GNorm = 0.4831, lr_0 = 2.1317e-04
Loss = 7.6960e-02, PNorm = 35.3531, GNorm = 1.1796, lr_0 = 2.0761e-04
Loss = 1.0232e-01, PNorm = 35.3538, GNorm = 2.4172, lr_0 = 2.0706e-04
Validation rmse = 0.119436
Validation r2 = 0.875110
Validation mse = 0.014265
Epoch 39
Loss = 7.7460e-02, PNorm = 35.3614, GNorm = 1.9242, lr_0 = 2.0165e-04
Validation rmse = 0.119903
Validation r2 = 0.874130
Validation mse = 0.014377
Epoch 40
Loss = 8.0900e-02, PNorm = 35.3674, GNorm = 0.6618, lr_0 = 1.9638e-04
Loss = 7.4674e-02, PNorm = 35.3739, GNorm = 1.6977, lr_0 = 1.9125e-04
Validation rmse = 0.120117
Validation r2 = 0.873682
Validation mse = 0.014428
Epoch 41
Loss = 7.3875e-02, PNorm = 35.3803, GNorm = 0.5417, lr_0 = 1.8577e-04
Validation rmse = 0.118120
Validation r2 = 0.877847
Validation mse = 0.013952
Epoch 42
Loss = 7.0197e-02, PNorm = 35.3867, GNorm = 0.8489, lr_0 = 1.8044e-04
Loss = 7.2643e-02, PNorm = 35.3924, GNorm = 0.7494, lr_0 = 1.7572e-04
Validation rmse = 0.117017
Validation r2 = 0.880118
Validation mse = 0.013693
Epoch 43
Loss = 7.1758e-02, PNorm = 35.3974, GNorm = 1.3954, lr_0 = 1.7113e-04
Validation rmse = 0.122114
Validation r2 = 0.869446
Validation mse = 0.014912
Epoch 44
Loss = 7.4552e-02, PNorm = 35.4037, GNorm = 1.1378, lr_0 = 1.6622e-04
Loss = 7.6241e-02, PNorm = 35.4092, GNorm = 1.5629, lr_0 = 1.6188e-04
Validation rmse = 0.119494
Validation r2 = 0.874990
Validation mse = 0.014279
Epoch 45
Loss = 6.1051e-02, PNorm = 35.4156, GNorm = 0.5534, lr_0 = 1.5765e-04
Validation rmse = 0.116994
Validation r2 = 0.880164
Validation mse = 0.013688
Epoch 46
Loss = 7.4852e-02, PNorm = 35.4220, GNorm = 1.8768, lr_0 = 1.5313e-04
Loss = 7.0673e-02, PNorm = 35.4271, GNorm = 0.4282, lr_0 = 1.4913e-04
Validation rmse = 0.117038
Validation r2 = 0.880074
Validation mse = 0.013698
Epoch 47
Loss = 6.6051e-02, PNorm = 35.4315, GNorm = 1.4790, lr_0 = 1.4485e-04
Validation rmse = 0.121327
Validation r2 = 0.871123
Validation mse = 0.014720
Epoch 48
Loss = 7.6092e-02, PNorm = 35.4378, GNorm = 0.9746, lr_0 = 1.4107e-04
Loss = 6.8302e-02, PNorm = 35.4417, GNorm = 1.1840, lr_0 = 1.3738e-04
Validation rmse = 0.120696
Validation r2 = 0.872461
Validation mse = 0.014568
Epoch 49
Loss = 6.7697e-02, PNorm = 35.4475, GNorm = 0.5560, lr_0 = 1.3344e-04
Loss = 6.9871e-02, PNorm = 35.4518, GNorm = 1.3685, lr_0 = 1.2996e-04
Validation rmse = 0.122005
Validation r2 = 0.869679
Validation mse = 0.014885
Epoch 50
Loss = 6.5344e-02, PNorm = 35.4559, GNorm = 0.5061, lr_0 = 1.2656e-04
Validation rmse = 0.118270
Validation r2 = 0.877537
Validation mse = 0.013988
Epoch 51
Loss = 6.1039e-02, PNorm = 35.4614, GNorm = 1.6556, lr_0 = 1.2293e-04
Loss = 7.5326e-02, PNorm = 35.4654, GNorm = 1.9421, lr_0 = 1.1972e-04
Loss = 5.8334e-02, PNorm = 35.4658, GNorm = 2.0104, lr_0 = 1.1940e-04
Validation rmse = 0.116787
Validation r2 = 0.880589
Validation mse = 0.013639
Epoch 52
Loss = 7.0608e-02, PNorm = 35.4704, GNorm = 1.1045, lr_0 = 1.1628e-04
Validation rmse = 0.118640
Validation r2 = 0.876769
Validation mse = 0.014075
Epoch 53
Loss = 6.6625e-02, PNorm = 35.4739, GNorm = 0.8808, lr_0 = 1.1325e-04
Loss = 6.8297e-02, PNorm = 35.4776, GNorm = 0.7454, lr_0 = 1.1029e-04
Validation rmse = 0.125334
Validation r2 = 0.862471
Validation mse = 0.015709
Epoch 54
Loss = 6.9760e-02, PNorm = 35.4827, GNorm = 1.9643, lr_0 = 1.0712e-04
Validation rmse = 0.121356
Validation r2 = 0.871062
Validation mse = 0.014727
Epoch 55
Loss = 6.1832e-02, PNorm = 35.4854, GNorm = 0.7247, lr_0 = 1.0433e-04
Loss = 6.9107e-02, PNorm = 35.4893, GNorm = 0.6904, lr_0 = 1.0160e-04
Validation rmse = 0.116623
Validation r2 = 0.880923
Validation mse = 0.013601
Epoch 56
Loss = 6.8122e-02, PNorm = 35.4933, GNorm = 0.6048, lr_0 = 1.0000e-04
Validation rmse = 0.117811
Validation r2 = 0.878484
Validation mse = 0.013880
Epoch 57
Loss = 8.8538e-02, PNorm = 35.4973, GNorm = 0.5168, lr_0 = 1.0000e-04
Loss = 5.6741e-02, PNorm = 35.5004, GNorm = 0.7982, lr_0 = 1.0000e-04
Validation rmse = 0.116208
Validation r2 = 0.881770
Validation mse = 0.013504
Epoch 58
Loss = 7.0945e-02, PNorm = 35.5042, GNorm = 0.8446, lr_0 = 1.0000e-04
Validation rmse = 0.121115
Validation r2 = 0.871575
Validation mse = 0.014669
Epoch 59
Loss = 6.5212e-02, PNorm = 35.5078, GNorm = 1.6388, lr_0 = 1.0000e-04
Loss = 6.6881e-02, PNorm = 35.5117, GNorm = 1.3602, lr_0 = 1.0000e-04
Validation rmse = 0.121437
Validation r2 = 0.870891
Validation mse = 0.014747
Model 0 best validation rmse = 0.116208 on epoch 57
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.179838
Model 0 test r2 = 0.527618
Model 0 test mse = 0.032342
Ensemble test rmse = 0.179838
Ensemble test r2 = 0.527618
Ensemble test mse = 0.032342
Fold 2
Splitting data with seed 2
Total size = 963 | train size = 770 | val size = 193 | test size = 59
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.3262e-01, PNorm = 34.0184, GNorm = 1.4199, lr_0 = 4.3000e-04
Validation rmse = 0.315832
Validation r2 = 0.200250
Validation mse = 0.099750
Epoch 1
Loss = 7.1159e-01, PNorm = 34.0480, GNorm = 2.0910, lr_0 = 7.6000e-04
Loss = 6.3331e-01, PNorm = 34.1095, GNorm = 2.4765, lr_0 = 9.9472e-04
Loss = 7.8012e-01, PNorm = 34.1165, GNorm = 9.4372, lr_0 = 9.9209e-04
Validation rmse = 0.291500
Validation r2 = 0.318734
Validation mse = 0.084972
Epoch 2
Loss = 4.7188e-01, PNorm = 34.1907, GNorm = 1.4671, lr_0 = 9.6618e-04
Validation rmse = 0.205224
Validation r2 = 0.662327
Validation mse = 0.042117
Epoch 3
Loss = 3.4132e-01, PNorm = 34.2725, GNorm = 1.3748, lr_0 = 9.4094e-04
Loss = 3.3219e-01, PNorm = 34.3549, GNorm = 6.3441, lr_0 = 9.1637e-04
Validation rmse = 0.182801
Validation r2 = 0.732083
Validation mse = 0.033416
Epoch 4
Loss = 3.1485e-01, PNorm = 34.4118, GNorm = 6.7772, lr_0 = 8.9007e-04
Validation rmse = 0.199289
Validation r2 = 0.681574
Validation mse = 0.039716
Epoch 5
Loss = 3.0283e-01, PNorm = 34.4631, GNorm = 3.8971, lr_0 = 8.6682e-04
Loss = 2.6331e-01, PNorm = 34.5188, GNorm = 2.7253, lr_0 = 8.4418e-04
Validation rmse = 0.173334
Validation r2 = 0.759116
Validation mse = 0.030045
Epoch 6
Loss = 2.3254e-01, PNorm = 34.5675, GNorm = 1.9464, lr_0 = 8.1996e-04
Validation rmse = 0.159793
Validation r2 = 0.795282
Validation mse = 0.025534
Epoch 7
Loss = 1.7937e-01, PNorm = 34.6154, GNorm = 1.2611, lr_0 = 7.9643e-04
Loss = 1.4978e-01, PNorm = 34.6586, GNorm = 3.4182, lr_0 = 7.7563e-04
Validation rmse = 0.142019
Validation r2 = 0.838292
Validation mse = 0.020169
Epoch 8
Loss = 1.4571e-01, PNorm = 34.6941, GNorm = 4.1383, lr_0 = 7.5537e-04
Validation rmse = 0.134607
Validation r2 = 0.854730
Validation mse = 0.018119
Epoch 9
Loss = 1.1376e-01, PNorm = 34.7252, GNorm = 0.8424, lr_0 = 7.3370e-04
Loss = 1.3597e-01, PNorm = 34.7579, GNorm = 0.9775, lr_0 = 7.1453e-04
Validation rmse = 0.133973
Validation r2 = 0.856096
Validation mse = 0.017949
Epoch 10
Loss = 1.2361e-01, PNorm = 34.7816, GNorm = 1.3000, lr_0 = 6.9587e-04
Validation rmse = 0.127703
Validation r2 = 0.869248
Validation mse = 0.016308
Epoch 11
Loss = 9.4148e-02, PNorm = 34.8068, GNorm = 0.9637, lr_0 = 6.7590e-04
Loss = 1.2816e-01, PNorm = 34.8295, GNorm = 0.9822, lr_0 = 6.5825e-04
Validation rmse = 0.133005
Validation r2 = 0.858167
Validation mse = 0.017690
Epoch 12
Loss = 1.1596e-01, PNorm = 34.8550, GNorm = 1.0700, lr_0 = 6.3936e-04
Loss = 1.5931e-01, PNorm = 34.8734, GNorm = 8.1366, lr_0 = 6.2266e-04
Validation rmse = 0.141767
Validation r2 = 0.838864
Validation mse = 0.020098
Epoch 13
Loss = 1.5515e-01, PNorm = 34.8977, GNorm = 0.9392, lr_0 = 6.0640e-04
Validation rmse = 0.123566
Validation r2 = 0.877584
Validation mse = 0.015269
Epoch 14
Loss = 1.2161e-01, PNorm = 34.9208, GNorm = 2.2044, lr_0 = 5.8900e-04
Loss = 1.1289e-01, PNorm = 34.9396, GNorm = 1.4099, lr_0 = 5.7362e-04
Validation rmse = 0.135497
Validation r2 = 0.852802
Validation mse = 0.018360
Epoch 15
Loss = 1.1221e-01, PNorm = 34.9596, GNorm = 1.6750, lr_0 = 5.5863e-04
Validation rmse = 0.134405
Validation r2 = 0.855166
Validation mse = 0.018065
Epoch 16
Loss = 1.1460e-01, PNorm = 34.9807, GNorm = 2.3100, lr_0 = 5.4260e-04
Loss = 1.0450e-01, PNorm = 34.9969, GNorm = 0.8784, lr_0 = 5.2843e-04
Validation rmse = 0.130614
Validation r2 = 0.863221
Validation mse = 0.017060
Epoch 17
Loss = 1.0425e-01, PNorm = 35.0163, GNorm = 1.8195, lr_0 = 5.1327e-04
Validation rmse = 0.124560
Validation r2 = 0.875607
Validation mse = 0.015515
Epoch 18
Loss = 9.0220e-02, PNorm = 35.0310, GNorm = 1.4894, lr_0 = 4.9986e-04
Loss = 1.0166e-01, PNorm = 35.0468, GNorm = 2.2160, lr_0 = 4.8681e-04
Validation rmse = 0.124349
Validation r2 = 0.876026
Validation mse = 0.015463
Epoch 19
Loss = 1.0216e-01, PNorm = 35.0663, GNorm = 1.2016, lr_0 = 4.7284e-04
Validation rmse = 0.129830
Validation r2 = 0.864858
Validation mse = 0.016856
Epoch 20
Loss = 8.9376e-02, PNorm = 35.0769, GNorm = 0.7298, lr_0 = 4.6049e-04
Loss = 9.5797e-02, PNorm = 35.0896, GNorm = 1.1777, lr_0 = 4.4846e-04
Validation rmse = 0.139035
Validation r2 = 0.845015
Validation mse = 0.019331
Epoch 21
Loss = 1.0310e-01, PNorm = 35.1054, GNorm = 3.4058, lr_0 = 4.3559e-04
Validation rmse = 0.131962
Validation r2 = 0.860382
Validation mse = 0.017414
Epoch 22
Loss = 9.0644e-02, PNorm = 35.1218, GNorm = 0.9737, lr_0 = 4.2309e-04
Loss = 9.5240e-02, PNorm = 35.1340, GNorm = 1.3255, lr_0 = 4.1204e-04
Validation rmse = 0.130128
Validation r2 = 0.864236
Validation mse = 0.016933
Epoch 23
Loss = 8.5185e-02, PNorm = 35.1461, GNorm = 0.7205, lr_0 = 4.0128e-04
Validation rmse = 0.128538
Validation r2 = 0.867534
Validation mse = 0.016522
Epoch 24
Loss = 9.7073e-02, PNorm = 35.1612, GNorm = 0.9476, lr_0 = 3.8977e-04
Loss = 8.9360e-02, PNorm = 35.1740, GNorm = 1.5835, lr_0 = 3.7959e-04
Validation rmse = 0.132109
Validation r2 = 0.860071
Validation mse = 0.017453
Epoch 25
Loss = 8.9283e-02, PNorm = 35.1851, GNorm = 2.1074, lr_0 = 3.6967e-04
Loss = 9.2010e-02, PNorm = 35.1964, GNorm = 2.7319, lr_0 = 3.6002e-04
Loss = 7.9310e-02, PNorm = 35.1978, GNorm = 1.8718, lr_0 = 3.5906e-04
Validation rmse = 0.128539
Validation r2 = 0.867532
Validation mse = 0.016522
Epoch 26
Loss = 8.5188e-02, PNorm = 35.2105, GNorm = 0.6913, lr_0 = 3.4969e-04
Validation rmse = 0.137644
Validation r2 = 0.848100
Validation mse = 0.018946
Epoch 27
Loss = 7.8052e-02, PNorm = 35.2240, GNorm = 2.8915, lr_0 = 3.3965e-04
Loss = 1.0648e-01, PNorm = 35.2366, GNorm = 4.0854, lr_0 = 3.3078e-04
Validation rmse = 0.122529
Validation r2 = 0.879630
Validation mse = 0.015013
Epoch 28
Loss = 8.8642e-02, PNorm = 35.2493, GNorm = 2.3634, lr_0 = 3.2214e-04
Validation rmse = 0.124162
Validation r2 = 0.876401
Validation mse = 0.015416
Epoch 29
Loss = 8.2095e-02, PNorm = 35.2617, GNorm = 2.6905, lr_0 = 3.1290e-04
Loss = 8.2427e-02, PNorm = 35.2716, GNorm = 1.1001, lr_0 = 3.0472e-04
Validation rmse = 0.124007
Validation r2 = 0.876709
Validation mse = 0.015378
Epoch 30
Loss = 9.0506e-02, PNorm = 35.2831, GNorm = 3.8162, lr_0 = 2.9677e-04
Validation rmse = 0.132058
Validation r2 = 0.860180
Validation mse = 0.017439
Epoch 31
Loss = 7.4951e-02, PNorm = 35.2937, GNorm = 2.1380, lr_0 = 2.8825e-04
Loss = 8.6983e-02, PNorm = 35.3034, GNorm = 1.8209, lr_0 = 2.8072e-04
Validation rmse = 0.125565
Validation r2 = 0.873592
Validation mse = 0.015766
Epoch 32
Loss = 6.5823e-02, PNorm = 35.3123, GNorm = 0.6731, lr_0 = 2.7267e-04
Validation rmse = 0.122867
Validation r2 = 0.878964
Validation mse = 0.015096
Epoch 33
Loss = 6.8503e-02, PNorm = 35.3200, GNorm = 1.1797, lr_0 = 2.6554e-04
Loss = 7.3368e-02, PNorm = 35.3289, GNorm = 1.5722, lr_0 = 2.5861e-04
Validation rmse = 0.123495
Validation r2 = 0.877725
Validation mse = 0.015251
Epoch 34
Loss = 7.1897e-02, PNorm = 35.3371, GNorm = 1.2928, lr_0 = 2.5119e-04
Validation rmse = 0.123377
Validation r2 = 0.877957
Validation mse = 0.015222
Epoch 35
Loss = 5.9938e-02, PNorm = 35.3462, GNorm = 2.2104, lr_0 = 2.4463e-04
Loss = 7.4737e-02, PNorm = 35.3544, GNorm = 1.2879, lr_0 = 2.3824e-04
Validation rmse = 0.122292
Validation r2 = 0.880094
Validation mse = 0.014955
Epoch 36
Loss = 6.3772e-02, PNorm = 35.3622, GNorm = 1.1489, lr_0 = 2.3140e-04
Validation rmse = 0.125609
Validation r2 = 0.873503
Validation mse = 0.015778
Epoch 37
Loss = 6.7945e-02, PNorm = 35.3704, GNorm = 1.4030, lr_0 = 2.2476e-04
Loss = 8.0181e-02, PNorm = 35.3785, GNorm = 1.2449, lr_0 = 2.1889e-04
Validation rmse = 0.123575
Validation r2 = 0.877565
Validation mse = 0.015271
Epoch 38
Loss = 8.1354e-02, PNorm = 35.3862, GNorm = 3.9355, lr_0 = 2.1317e-04
Loss = 7.7271e-02, PNorm = 35.3941, GNorm = 2.5126, lr_0 = 2.0761e-04
Loss = 7.6683e-02, PNorm = 35.3952, GNorm = 0.9839, lr_0 = 2.0706e-04
Validation rmse = 0.122014
Validation r2 = 0.880640
Validation mse = 0.014887
Epoch 39
Loss = 7.0280e-02, PNorm = 35.4017, GNorm = 0.7025, lr_0 = 2.0165e-04
Validation rmse = 0.125299
Validation r2 = 0.874125
Validation mse = 0.015700
Epoch 40
Loss = 7.3967e-02, PNorm = 35.4087, GNorm = 0.9543, lr_0 = 1.9638e-04
Loss = 6.5552e-02, PNorm = 35.4143, GNorm = 1.9058, lr_0 = 1.9125e-04
Validation rmse = 0.122703
Validation r2 = 0.879288
Validation mse = 0.015056
Epoch 41
Loss = 6.4946e-02, PNorm = 35.4219, GNorm = 0.7021, lr_0 = 1.8577e-04
Validation rmse = 0.121201
Validation r2 = 0.882226
Validation mse = 0.014690
Epoch 42
Loss = 5.6461e-02, PNorm = 35.4286, GNorm = 1.3687, lr_0 = 1.8044e-04
Loss = 7.5028e-02, PNorm = 35.4340, GNorm = 0.9505, lr_0 = 1.7572e-04
Validation rmse = 0.122175
Validation r2 = 0.880324
Validation mse = 0.014927
Epoch 43
Loss = 7.0188e-02, PNorm = 35.4405, GNorm = 1.4863, lr_0 = 1.7113e-04
Validation rmse = 0.123271
Validation r2 = 0.878168
Validation mse = 0.015196
Epoch 44
Loss = 6.4818e-02, PNorm = 35.4466, GNorm = 0.8004, lr_0 = 1.6622e-04
Loss = 6.4450e-02, PNorm = 35.4515, GNorm = 0.4276, lr_0 = 1.6188e-04
Validation rmse = 0.121909
Validation r2 = 0.880845
Validation mse = 0.014862
Epoch 45
Loss = 6.8756e-02, PNorm = 35.4569, GNorm = 1.4151, lr_0 = 1.5765e-04
Validation rmse = 0.126306
Validation r2 = 0.872095
Validation mse = 0.015953
Epoch 46
Loss = 8.2841e-02, PNorm = 35.4628, GNorm = 0.9640, lr_0 = 1.5313e-04
Loss = 6.8066e-02, PNorm = 35.4685, GNorm = 1.0463, lr_0 = 1.4913e-04
Validation rmse = 0.122906
Validation r2 = 0.878889
Validation mse = 0.015106
Epoch 47
Loss = 6.3678e-02, PNorm = 35.4744, GNorm = 1.8904, lr_0 = 1.4485e-04
Validation rmse = 0.123781
Validation r2 = 0.877156
Validation mse = 0.015322
Epoch 48
Loss = 4.4516e-02, PNorm = 35.4786, GNorm = 0.6423, lr_0 = 1.4107e-04
Loss = 6.6756e-02, PNorm = 35.4840, GNorm = 1.0424, lr_0 = 1.3738e-04
Validation rmse = 0.123360
Validation r2 = 0.877991
Validation mse = 0.015218
Epoch 49
Loss = 6.2992e-02, PNorm = 35.4891, GNorm = 1.3863, lr_0 = 1.3344e-04
Loss = 6.2252e-02, PNorm = 35.4941, GNorm = 1.2806, lr_0 = 1.2996e-04
Validation rmse = 0.121284
Validation r2 = 0.882063
Validation mse = 0.014710
Epoch 50
Loss = 6.3661e-02, PNorm = 35.4983, GNorm = 1.4435, lr_0 = 1.2656e-04
Validation rmse = 0.120728
Validation r2 = 0.883142
Validation mse = 0.014575
Epoch 51
Loss = 6.4149e-02, PNorm = 35.5031, GNorm = 1.5905, lr_0 = 1.2293e-04
Loss = 6.3165e-02, PNorm = 35.5065, GNorm = 2.0365, lr_0 = 1.1972e-04
Loss = 4.4860e-02, PNorm = 35.5070, GNorm = 1.1266, lr_0 = 1.1940e-04
Validation rmse = 0.120495
Validation r2 = 0.883594
Validation mse = 0.014519
Epoch 52
Loss = 6.2358e-02, PNorm = 35.5121, GNorm = 0.5558, lr_0 = 1.1628e-04
Validation rmse = 0.122438
Validation r2 = 0.879809
Validation mse = 0.014991
Epoch 53
Loss = 6.6856e-02, PNorm = 35.5158, GNorm = 0.4241, lr_0 = 1.1325e-04
Loss = 5.7791e-02, PNorm = 35.5194, GNorm = 1.7662, lr_0 = 1.1029e-04
Validation rmse = 0.123642
Validation r2 = 0.877433
Validation mse = 0.015287
Epoch 54
Loss = 6.4957e-02, PNorm = 35.5235, GNorm = 1.7097, lr_0 = 1.0712e-04
Validation rmse = 0.122587
Validation r2 = 0.879516
Validation mse = 0.015028
Epoch 55
Loss = 6.9093e-02, PNorm = 35.5279, GNorm = 1.9262, lr_0 = 1.0433e-04
Loss = 6.0981e-02, PNorm = 35.5310, GNorm = 1.3425, lr_0 = 1.0160e-04
Validation rmse = 0.124194
Validation r2 = 0.876335
Validation mse = 0.015424
Epoch 56
Loss = 6.1000e-02, PNorm = 35.5345, GNorm = 1.9391, lr_0 = 1.0000e-04
Validation rmse = 0.121858
Validation r2 = 0.880945
Validation mse = 0.014849
Epoch 57
Loss = 7.5113e-02, PNorm = 35.5384, GNorm = 1.4219, lr_0 = 1.0000e-04
Loss = 6.3032e-02, PNorm = 35.5425, GNorm = 1.2168, lr_0 = 1.0000e-04
Validation rmse = 0.124299
Validation r2 = 0.876128
Validation mse = 0.015450
Epoch 58
Loss = 6.3859e-02, PNorm = 35.5464, GNorm = 1.4505, lr_0 = 1.0000e-04
Validation rmse = 0.121797
Validation r2 = 0.881064
Validation mse = 0.014834
Epoch 59
Loss = 5.6592e-02, PNorm = 35.5504, GNorm = 2.7677, lr_0 = 1.0000e-04
Loss = 6.2344e-02, PNorm = 35.5537, GNorm = 0.8648, lr_0 = 1.0000e-04
Validation rmse = 0.122593
Validation r2 = 0.879504
Validation mse = 0.015029
Model 0 best validation rmse = 0.120495 on epoch 51
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.185524
Model 0 test r2 = 0.497279
Model 0 test mse = 0.034419
Ensemble test rmse = 0.185524
Ensemble test r2 = 0.497279
Ensemble test mse = 0.034419
Fold 3
Splitting data with seed 3
Total size = 963 | train size = 770 | val size = 193 | test size = 59
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.9413e-01, PNorm = 34.0176, GNorm = 6.9043, lr_0 = 4.3000e-04
Validation rmse = 0.288855
Validation r2 = 0.327969
Validation mse = 0.083437
Epoch 1
Loss = 7.7573e-01, PNorm = 34.0462, GNorm = 5.0379, lr_0 = 7.6000e-04
Loss = 7.7361e-01, PNorm = 34.0958, GNorm = 4.7332, lr_0 = 9.9472e-04
Loss = 6.7031e-01, PNorm = 34.1023, GNorm = 4.6601, lr_0 = 9.9209e-04
Validation rmse = 0.287591
Validation r2 = 0.333838
Validation mse = 0.082708
Epoch 2
Loss = 5.2328e-01, PNorm = 34.1752, GNorm = 1.9565, lr_0 = 9.6618e-04
Validation rmse = 0.223426
Validation r2 = 0.597932
Validation mse = 0.049919
Epoch 3
Loss = 3.8611e-01, PNorm = 34.2461, GNorm = 1.5798, lr_0 = 9.4094e-04
Loss = 4.4445e-01, PNorm = 34.3101, GNorm = 4.8410, lr_0 = 9.1637e-04
Validation rmse = 0.194315
Validation r2 = 0.695882
Validation mse = 0.037758
Epoch 4
Loss = 2.9579e-01, PNorm = 34.3724, GNorm = 3.4039, lr_0 = 8.9007e-04
Validation rmse = 0.171143
Validation r2 = 0.764088
Validation mse = 0.029290
Epoch 5
Loss = 3.5265e-01, PNorm = 34.4364, GNorm = 1.3270, lr_0 = 8.6682e-04
Loss = 2.6604e-01, PNorm = 34.4979, GNorm = 6.6840, lr_0 = 8.4418e-04
Validation rmse = 0.155066
Validation r2 = 0.806329
Validation mse = 0.024045
Epoch 6
Loss = 2.4636e-01, PNorm = 34.5401, GNorm = 2.9313, lr_0 = 8.1996e-04
Validation rmse = 0.150873
Validation r2 = 0.816662
Validation mse = 0.022763
Epoch 7
Loss = 2.3459e-01, PNorm = 34.5846, GNorm = 1.6016, lr_0 = 7.9643e-04
Loss = 2.0111e-01, PNorm = 34.6297, GNorm = 0.8209, lr_0 = 7.7563e-04
Validation rmse = 0.145084
Validation r2 = 0.830462
Validation mse = 0.021049
Epoch 8
Loss = 1.7053e-01, PNorm = 34.6718, GNorm = 2.2756, lr_0 = 7.5537e-04
Validation rmse = 0.130757
Validation r2 = 0.862292
Validation mse = 0.017097
Epoch 9
Loss = 1.7345e-01, PNorm = 34.7090, GNorm = 0.8364, lr_0 = 7.3370e-04
Loss = 1.6408e-01, PNorm = 34.7393, GNorm = 5.2794, lr_0 = 7.1453e-04
Validation rmse = 0.133721
Validation r2 = 0.855978
Validation mse = 0.017881
Epoch 10
Loss = 1.6297e-01, PNorm = 34.7669, GNorm = 3.5640, lr_0 = 6.9587e-04
Validation rmse = 0.121162
Validation r2 = 0.881761
Validation mse = 0.014680
Epoch 11
Loss = 9.0298e-02, PNorm = 34.7993, GNorm = 0.7565, lr_0 = 6.7590e-04
Loss = 1.6651e-01, PNorm = 34.8207, GNorm = 2.9667, lr_0 = 6.5825e-04
Validation rmse = 0.124160
Validation r2 = 0.875836
Validation mse = 0.015416
Epoch 12
Loss = 1.5692e-01, PNorm = 34.8563, GNorm = 5.2111, lr_0 = 6.3936e-04
Loss = 1.3958e-01, PNorm = 34.8814, GNorm = 1.8181, lr_0 = 6.2266e-04
Validation rmse = 0.147173
Validation r2 = 0.825544
Validation mse = 0.021660
Epoch 13
Loss = 1.5426e-01, PNorm = 34.8960, GNorm = 2.2552, lr_0 = 6.0640e-04
Validation rmse = 0.123851
Validation r2 = 0.876454
Validation mse = 0.015339
Epoch 14
Loss = 1.2440e-01, PNorm = 34.9172, GNorm = 1.3061, lr_0 = 5.8900e-04
Loss = 1.2591e-01, PNorm = 34.9356, GNorm = 0.8365, lr_0 = 5.7362e-04
Validation rmse = 0.118240
Validation r2 = 0.887395
Validation mse = 0.013981
Epoch 15
Loss = 1.2982e-01, PNorm = 34.9526, GNorm = 1.8849, lr_0 = 5.5863e-04
Validation rmse = 0.123069
Validation r2 = 0.878010
Validation mse = 0.015146
Epoch 16
Loss = 1.2682e-01, PNorm = 34.9710, GNorm = 3.9894, lr_0 = 5.4260e-04
Loss = 1.4154e-01, PNorm = 34.9841, GNorm = 3.0505, lr_0 = 5.2843e-04
Validation rmse = 0.125009
Validation r2 = 0.874134
Validation mse = 0.015627
Epoch 17
Loss = 1.3072e-01, PNorm = 35.0035, GNorm = 1.4786, lr_0 = 5.1327e-04
Validation rmse = 0.118456
Validation r2 = 0.886983
Validation mse = 0.014032
Epoch 18
Loss = 1.2830e-01, PNorm = 35.0186, GNorm = 1.6542, lr_0 = 4.9986e-04
Loss = 1.0557e-01, PNorm = 35.0332, GNorm = 1.0016, lr_0 = 4.8681e-04
Validation rmse = 0.114626
Validation r2 = 0.894173
Validation mse = 0.013139
Epoch 19
Loss = 1.0647e-01, PNorm = 35.0490, GNorm = 1.2160, lr_0 = 4.7284e-04
Validation rmse = 0.117827
Validation r2 = 0.888179
Validation mse = 0.013883
Epoch 20
Loss = 1.2772e-01, PNorm = 35.0629, GNorm = 2.8566, lr_0 = 4.6049e-04
Loss = 1.1789e-01, PNorm = 35.0753, GNorm = 5.1096, lr_0 = 4.4846e-04
Validation rmse = 0.112500
Validation r2 = 0.898062
Validation mse = 0.012656
Epoch 21
Loss = 1.1499e-01, PNorm = 35.0908, GNorm = 4.1241, lr_0 = 4.3559e-04
Validation rmse = 0.132295
Validation r2 = 0.859033
Validation mse = 0.017502
Epoch 22
Loss = 1.5489e-01, PNorm = 35.1005, GNorm = 1.8832, lr_0 = 4.2309e-04
Loss = 1.1316e-01, PNorm = 35.1120, GNorm = 1.5741, lr_0 = 4.1204e-04
Validation rmse = 0.110854
Validation r2 = 0.901023
Validation mse = 0.012289
Epoch 23
Loss = 1.3561e-01, PNorm = 35.1233, GNorm = 1.2230, lr_0 = 4.0128e-04
Validation rmse = 0.125343
Validation r2 = 0.873460
Validation mse = 0.015711
Epoch 24
Loss = 1.2279e-01, PNorm = 35.1396, GNorm = 3.7205, lr_0 = 3.8977e-04
Loss = 1.1131e-01, PNorm = 35.1511, GNorm = 1.7323, lr_0 = 3.7959e-04
Validation rmse = 0.120705
Validation r2 = 0.882651
Validation mse = 0.014570
Epoch 25
Loss = 1.0098e-01, PNorm = 35.1614, GNorm = 1.8866, lr_0 = 3.6967e-04
Loss = 1.1421e-01, PNorm = 35.1752, GNorm = 2.2108, lr_0 = 3.6002e-04
Loss = 8.0822e-02, PNorm = 35.1768, GNorm = 1.7568, lr_0 = 3.5906e-04
Validation rmse = 0.118739
Validation r2 = 0.886443
Validation mse = 0.014099
Epoch 26
Loss = 1.0203e-01, PNorm = 35.1847, GNorm = 1.7625, lr_0 = 3.4969e-04
Validation rmse = 0.121393
Validation r2 = 0.881309
Validation mse = 0.014736
Epoch 27
Loss = 1.1640e-01, PNorm = 35.1958, GNorm = 1.6371, lr_0 = 3.3965e-04
Loss = 9.1727e-02, PNorm = 35.2043, GNorm = 0.5467, lr_0 = 3.3078e-04
Validation rmse = 0.109747
Validation r2 = 0.902991
Validation mse = 0.012044
Epoch 28
Loss = 8.2248e-02, PNorm = 35.2158, GNorm = 0.6145, lr_0 = 3.2214e-04
Validation rmse = 0.109990
Validation r2 = 0.902560
Validation mse = 0.012098
Epoch 29
Loss = 8.8619e-02, PNorm = 35.2273, GNorm = 0.9369, lr_0 = 3.1290e-04
Loss = 9.3159e-02, PNorm = 35.2373, GNorm = 0.6106, lr_0 = 3.0472e-04
Validation rmse = 0.108483
Validation r2 = 0.905212
Validation mse = 0.011769
Epoch 30
Loss = 8.9730e-02, PNorm = 35.2471, GNorm = 0.6608, lr_0 = 2.9677e-04
Validation rmse = 0.107870
Validation r2 = 0.906280
Validation mse = 0.011636
Epoch 31
Loss = 1.1226e-01, PNorm = 35.2544, GNorm = 1.3298, lr_0 = 2.8825e-04
Loss = 8.6301e-02, PNorm = 35.2628, GNorm = 0.7686, lr_0 = 2.8072e-04
Validation rmse = 0.113692
Validation r2 = 0.895891
Validation mse = 0.012926
Epoch 32
Loss = 1.0556e-01, PNorm = 35.2715, GNorm = 2.0059, lr_0 = 2.7267e-04
Validation rmse = 0.108275
Validation r2 = 0.905575
Validation mse = 0.011723
Epoch 33
Loss = 9.8666e-02, PNorm = 35.2793, GNorm = 1.5897, lr_0 = 2.6554e-04
Loss = 9.1910e-02, PNorm = 35.2877, GNorm = 0.7524, lr_0 = 2.5861e-04
Validation rmse = 0.109424
Validation r2 = 0.903560
Validation mse = 0.011974
Epoch 34
Loss = 8.4462e-02, PNorm = 35.2954, GNorm = 2.4177, lr_0 = 2.5119e-04
Validation rmse = 0.106621
Validation r2 = 0.908438
Validation mse = 0.011368
Epoch 35
Loss = 6.9440e-02, PNorm = 35.3018, GNorm = 0.9033, lr_0 = 2.4463e-04
Loss = 8.7958e-02, PNorm = 35.3081, GNorm = 1.1449, lr_0 = 2.3824e-04
Validation rmse = 0.108635
Validation r2 = 0.904945
Validation mse = 0.011802
Epoch 36
Loss = 9.3322e-02, PNorm = 35.3166, GNorm = 2.0559, lr_0 = 2.3140e-04
Validation rmse = 0.107858
Validation r2 = 0.906302
Validation mse = 0.011633
Epoch 37
Loss = 1.0137e-01, PNorm = 35.3269, GNorm = 0.9996, lr_0 = 2.2476e-04
Loss = 8.6824e-02, PNorm = 35.3347, GNorm = 1.1445, lr_0 = 2.1889e-04
Validation rmse = 0.105575
Validation r2 = 0.910226
Validation mse = 0.011146
Epoch 38
Loss = 9.1673e-02, PNorm = 35.3415, GNorm = 2.2898, lr_0 = 2.1317e-04
Loss = 7.8652e-02, PNorm = 35.3480, GNorm = 0.4539, lr_0 = 2.0761e-04
Loss = 9.0896e-02, PNorm = 35.3487, GNorm = 2.6361, lr_0 = 2.0706e-04
Validation rmse = 0.106085
Validation r2 = 0.909355
Validation mse = 0.011254
Epoch 39
Loss = 8.1340e-02, PNorm = 35.3550, GNorm = 0.5225, lr_0 = 2.0165e-04
Validation rmse = 0.109699
Validation r2 = 0.903075
Validation mse = 0.012034
Epoch 40
Loss = 7.6698e-02, PNorm = 35.3619, GNorm = 1.5512, lr_0 = 1.9638e-04
Loss = 8.0971e-02, PNorm = 35.3686, GNorm = 0.9470, lr_0 = 1.9125e-04
Validation rmse = 0.105334
Validation r2 = 0.910635
Validation mse = 0.011095
Epoch 41
Loss = 7.4177e-02, PNorm = 35.3729, GNorm = 0.9316, lr_0 = 1.8577e-04
Validation rmse = 0.104808
Validation r2 = 0.911525
Validation mse = 0.010985
Epoch 42
Loss = 8.2954e-02, PNorm = 35.3803, GNorm = 1.6326, lr_0 = 1.8044e-04
Loss = 7.7907e-02, PNorm = 35.3861, GNorm = 1.7096, lr_0 = 1.7572e-04
Validation rmse = 0.104369
Validation r2 = 0.912265
Validation mse = 0.010893
Epoch 43
Loss = 7.4273e-02, PNorm = 35.3926, GNorm = 0.5830, lr_0 = 1.7113e-04
Validation rmse = 0.104830
Validation r2 = 0.911488
Validation mse = 0.010989
Epoch 44
Loss = 7.5543e-02, PNorm = 35.3984, GNorm = 0.8610, lr_0 = 1.6622e-04
Loss = 7.7544e-02, PNorm = 35.4038, GNorm = 1.5759, lr_0 = 1.6188e-04
Validation rmse = 0.107876
Validation r2 = 0.906269
Validation mse = 0.011637
Epoch 45
Loss = 8.3619e-02, PNorm = 35.4095, GNorm = 1.2788, lr_0 = 1.5765e-04
Validation rmse = 0.103622
Validation r2 = 0.913517
Validation mse = 0.010737
Epoch 46
Loss = 7.9227e-02, PNorm = 35.4149, GNorm = 1.0108, lr_0 = 1.5313e-04
Loss = 8.5133e-02, PNorm = 35.4211, GNorm = 0.5947, lr_0 = 1.4913e-04
Validation rmse = 0.108704
Validation r2 = 0.904825
Validation mse = 0.011817
Epoch 47
Loss = 7.7479e-02, PNorm = 35.4253, GNorm = 3.3371, lr_0 = 1.4485e-04
Validation rmse = 0.105471
Validation r2 = 0.910402
Validation mse = 0.011124
Epoch 48
Loss = 4.9498e-02, PNorm = 35.4305, GNorm = 2.4245, lr_0 = 1.4107e-04
Loss = 8.5166e-02, PNorm = 35.4345, GNorm = 1.5737, lr_0 = 1.3738e-04
Validation rmse = 0.106208
Validation r2 = 0.909145
Validation mse = 0.011280
Epoch 49
Loss = 9.1383e-02, PNorm = 35.4395, GNorm = 1.5318, lr_0 = 1.3344e-04
Loss = 6.7399e-02, PNorm = 35.4440, GNorm = 1.1412, lr_0 = 1.2996e-04
Validation rmse = 0.105884
Validation r2 = 0.909699
Validation mse = 0.011211
Epoch 50
Loss = 7.5213e-02, PNorm = 35.4485, GNorm = 1.0017, lr_0 = 1.2656e-04
Validation rmse = 0.105404
Validation r2 = 0.910516
Validation mse = 0.011110
Epoch 51
Loss = 7.6733e-02, PNorm = 35.4535, GNorm = 1.8365, lr_0 = 1.2293e-04
Loss = 7.8352e-02, PNorm = 35.4581, GNorm = 0.8528, lr_0 = 1.1972e-04
Loss = 6.1412e-02, PNorm = 35.4584, GNorm = 0.7007, lr_0 = 1.1940e-04
Validation rmse = 0.103486
Validation r2 = 0.913743
Validation mse = 0.010709
Epoch 52
Loss = 7.4684e-02, PNorm = 35.4630, GNorm = 0.7821, lr_0 = 1.1628e-04
Validation rmse = 0.103923
Validation r2 = 0.913014
Validation mse = 0.010800
Epoch 53
Loss = 8.1891e-02, PNorm = 35.4661, GNorm = 0.8801, lr_0 = 1.1325e-04
Loss = 7.4781e-02, PNorm = 35.4696, GNorm = 1.6740, lr_0 = 1.1029e-04
Validation rmse = 0.103809
Validation r2 = 0.913204
Validation mse = 0.010776
Epoch 54
Loss = 7.3760e-02, PNorm = 35.4734, GNorm = 1.1585, lr_0 = 1.0712e-04
Validation rmse = 0.103336
Validation r2 = 0.913993
Validation mse = 0.010678
Epoch 55
Loss = 7.8346e-02, PNorm = 35.4772, GNorm = 0.7306, lr_0 = 1.0433e-04
Loss = 7.1428e-02, PNorm = 35.4806, GNorm = 2.3156, lr_0 = 1.0160e-04
Validation rmse = 0.106318
Validation r2 = 0.908957
Validation mse = 0.011304
Epoch 56
Loss = 8.9219e-02, PNorm = 35.4851, GNorm = 1.1571, lr_0 = 1.0000e-04
Validation rmse = 0.103666
Validation r2 = 0.913442
Validation mse = 0.010747
Epoch 57
Loss = 6.5937e-02, PNorm = 35.4887, GNorm = 0.4096, lr_0 = 1.0000e-04
Loss = 7.6907e-02, PNorm = 35.4923, GNorm = 0.7642, lr_0 = 1.0000e-04
Validation rmse = 0.103065
Validation r2 = 0.914444
Validation mse = 0.010622
Epoch 58
Loss = 5.7789e-02, PNorm = 35.4962, GNorm = 0.4466, lr_0 = 1.0000e-04
Validation rmse = 0.103955
Validation r2 = 0.912959
Validation mse = 0.010807
Epoch 59
Loss = 1.2440e-01, PNorm = 35.5001, GNorm = 0.6945, lr_0 = 1.0000e-04
Loss = 6.4424e-02, PNorm = 35.5038, GNorm = 0.6808, lr_0 = 1.0000e-04
Validation rmse = 0.104561
Validation r2 = 0.911942
Validation mse = 0.010933
Model 0 best validation rmse = 0.103065 on epoch 57
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.175750
Model 0 test r2 = 0.548852
Model 0 test mse = 0.030888
Ensemble test rmse = 0.175750
Ensemble test r2 = 0.548852
Ensemble test mse = 0.030888
Fold 4
Splitting data with seed 4
Total size = 963 | train size = 770 | val size = 193 | test size = 59
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.3528e-01, PNorm = 34.0155, GNorm = 8.1594, lr_0 = 4.3000e-04
Validation rmse = 0.329418
Validation r2 = 0.186276
Validation mse = 0.108516
Epoch 1
Loss = 7.6497e-01, PNorm = 34.0423, GNorm = 2.4295, lr_0 = 7.6000e-04
Loss = 6.1134e-01, PNorm = 34.1020, GNorm = 0.8978, lr_0 = 9.9472e-04
Loss = 8.6877e-01, PNorm = 34.1097, GNorm = 9.2854, lr_0 = 9.9209e-04
Validation rmse = 0.273713
Validation r2 = 0.438212
Validation mse = 0.074919
Epoch 2
Loss = 4.2223e-01, PNorm = 34.1890, GNorm = 5.4064, lr_0 = 9.6618e-04
Validation rmse = 0.267460
Validation r2 = 0.463586
Validation mse = 0.071535
Epoch 3
Loss = 3.1862e-01, PNorm = 34.2589, GNorm = 4.2449, lr_0 = 9.4094e-04
Loss = 3.3525e-01, PNorm = 34.3230, GNorm = 1.5875, lr_0 = 9.1637e-04
Validation rmse = 0.228185
Validation r2 = 0.609557
Validation mse = 0.052068
Epoch 4
Loss = 3.3373e-01, PNorm = 34.3758, GNorm = 2.7205, lr_0 = 8.9007e-04
Validation rmse = 0.216120
Validation r2 = 0.649755
Validation mse = 0.046708
Epoch 5
Loss = 2.2635e-01, PNorm = 34.4191, GNorm = 1.0359, lr_0 = 8.6682e-04
Loss = 2.7601e-01, PNorm = 34.4649, GNorm = 1.6966, lr_0 = 8.4418e-04
Validation rmse = 0.219653
Validation r2 = 0.638209
Validation mse = 0.048247
Epoch 6
Loss = 3.0041e-01, PNorm = 34.5149, GNorm = 4.7774, lr_0 = 8.1996e-04
Validation rmse = 0.192346
Validation r2 = 0.722572
Validation mse = 0.036997
Epoch 7
Loss = 2.2412e-01, PNorm = 34.5599, GNorm = 6.3306, lr_0 = 7.9643e-04
Loss = 1.8232e-01, PNorm = 34.5991, GNorm = 1.6129, lr_0 = 7.7563e-04
Validation rmse = 0.190894
Validation r2 = 0.726746
Validation mse = 0.036440
Epoch 8
Loss = 1.7525e-01, PNorm = 34.6367, GNorm = 5.6436, lr_0 = 7.5537e-04
Validation rmse = 0.193400
Validation r2 = 0.719523
Validation mse = 0.037404
Epoch 9
Loss = 2.1882e-01, PNorm = 34.6723, GNorm = 4.2650, lr_0 = 7.3370e-04
Loss = 1.8725e-01, PNorm = 34.7075, GNorm = 4.8824, lr_0 = 7.1453e-04
Validation rmse = 0.197207
Validation r2 = 0.708375
Validation mse = 0.038890
Epoch 10
Loss = 1.7034e-01, PNorm = 34.7423, GNorm = 2.9873, lr_0 = 6.9587e-04
Validation rmse = 0.169304
Validation r2 = 0.785059
Validation mse = 0.028664
Epoch 11
Loss = 1.0420e-01, PNorm = 34.7756, GNorm = 0.7024, lr_0 = 6.7590e-04
Loss = 1.3245e-01, PNorm = 34.8039, GNorm = 3.0003, lr_0 = 6.5825e-04
Validation rmse = 0.168801
Validation r2 = 0.786336
Validation mse = 0.028494
Epoch 12
Loss = 1.2230e-01, PNorm = 34.8257, GNorm = 1.0153, lr_0 = 6.3936e-04
Loss = 1.1349e-01, PNorm = 34.8425, GNorm = 2.1568, lr_0 = 6.2266e-04
Validation rmse = 0.162239
Validation r2 = 0.802625
Validation mse = 0.026322
Epoch 13
Loss = 1.1885e-01, PNorm = 34.8620, GNorm = 0.5011, lr_0 = 6.0640e-04
Validation rmse = 0.164496
Validation r2 = 0.797094
Validation mse = 0.027059
Epoch 14
Loss = 1.2743e-01, PNorm = 34.8796, GNorm = 1.3579, lr_0 = 5.8900e-04
Loss = 9.7988e-02, PNorm = 34.8943, GNorm = 1.2041, lr_0 = 5.7362e-04
Validation rmse = 0.163225
Validation r2 = 0.800218
Validation mse = 0.026642
Epoch 15
Loss = 1.0340e-01, PNorm = 34.9141, GNorm = 1.4823, lr_0 = 5.5863e-04
Validation rmse = 0.162218
Validation r2 = 0.802676
Validation mse = 0.026315
Epoch 16
Loss = 1.0877e-01, PNorm = 34.9301, GNorm = 1.8975, lr_0 = 5.4260e-04
Loss = 1.0307e-01, PNorm = 34.9461, GNorm = 0.6347, lr_0 = 5.2843e-04
Validation rmse = 0.170682
Validation r2 = 0.781547
Validation mse = 0.029132
Epoch 17
Loss = 9.3417e-02, PNorm = 34.9621, GNorm = 0.7897, lr_0 = 5.1327e-04
Validation rmse = 0.163459
Validation r2 = 0.799646
Validation mse = 0.026719
Epoch 18
Loss = 1.0410e-01, PNorm = 34.9770, GNorm = 0.8606, lr_0 = 4.9986e-04
Loss = 9.0261e-02, PNorm = 34.9894, GNorm = 2.3321, lr_0 = 4.8681e-04
Validation rmse = 0.173810
Validation r2 = 0.773466
Validation mse = 0.030210
Epoch 19
Loss = 1.0405e-01, PNorm = 35.0027, GNorm = 1.0863, lr_0 = 4.7284e-04
Validation rmse = 0.165197
Validation r2 = 0.795362
Validation mse = 0.027290
Epoch 20
Loss = 1.1989e-01, PNorm = 35.0153, GNorm = 1.8252, lr_0 = 4.6049e-04
Loss = 9.0770e-02, PNorm = 35.0275, GNorm = 1.0138, lr_0 = 4.4846e-04
Validation rmse = 0.178632
Validation r2 = 0.760724
Validation mse = 0.031909
Epoch 21
Loss = 1.4334e-01, PNorm = 35.0394, GNorm = 4.4814, lr_0 = 4.3559e-04
Validation rmse = 0.191019
Validation r2 = 0.726389
Validation mse = 0.036488
Epoch 22
Loss = 9.1828e-02, PNorm = 35.0592, GNorm = 1.9355, lr_0 = 4.2309e-04
Loss = 9.6137e-02, PNorm = 35.0744, GNorm = 0.4848, lr_0 = 4.1204e-04
Validation rmse = 0.167392
Validation r2 = 0.789888
Validation mse = 0.028020
Epoch 23
Loss = 8.0805e-02, PNorm = 35.0871, GNorm = 1.0746, lr_0 = 4.0128e-04
Validation rmse = 0.163305
Validation r2 = 0.800021
Validation mse = 0.026669
Epoch 24
Loss = 8.4648e-02, PNorm = 35.0975, GNorm = 0.4319, lr_0 = 3.8977e-04
Loss = 8.0027e-02, PNorm = 35.1121, GNorm = 1.4287, lr_0 = 3.7959e-04
Validation rmse = 0.166759
Validation r2 = 0.791474
Validation mse = 0.027809
Epoch 25
Loss = 8.1625e-02, PNorm = 35.1197, GNorm = 2.9398, lr_0 = 3.6967e-04
Loss = 1.0386e-01, PNorm = 35.1306, GNorm = 0.5287, lr_0 = 3.6002e-04
Loss = 7.5090e-02, PNorm = 35.1316, GNorm = 2.4695, lr_0 = 3.5906e-04
Validation rmse = 0.173014
Validation r2 = 0.775538
Validation mse = 0.029934
Epoch 26
Loss = 8.7072e-02, PNorm = 35.1424, GNorm = 1.2928, lr_0 = 3.4969e-04
Validation rmse = 0.161132
Validation r2 = 0.805309
Validation mse = 0.025963
Epoch 27
Loss = 6.3336e-02, PNorm = 35.1550, GNorm = 0.4109, lr_0 = 3.3965e-04
Loss = 8.3533e-02, PNorm = 35.1642, GNorm = 0.8437, lr_0 = 3.3078e-04
Validation rmse = 0.166021
Validation r2 = 0.793316
Validation mse = 0.027563
Epoch 28
Loss = 7.9924e-02, PNorm = 35.1755, GNorm = 2.2116, lr_0 = 3.2214e-04
Validation rmse = 0.164518
Validation r2 = 0.797039
Validation mse = 0.027066
Epoch 29
Loss = 8.4755e-02, PNorm = 35.1854, GNorm = 4.2138, lr_0 = 3.1290e-04
Loss = 8.5364e-02, PNorm = 35.1948, GNorm = 1.8499, lr_0 = 3.0472e-04
Validation rmse = 0.166349
Validation r2 = 0.792497
Validation mse = 0.027672
Epoch 30
Loss = 7.5545e-02, PNorm = 35.2053, GNorm = 1.6827, lr_0 = 2.9677e-04
Validation rmse = 0.164603
Validation r2 = 0.796832
Validation mse = 0.027094
Epoch 31
Loss = 6.7626e-02, PNorm = 35.2139, GNorm = 0.7753, lr_0 = 2.8825e-04
Loss = 7.3642e-02, PNorm = 35.2227, GNorm = 1.0045, lr_0 = 2.8072e-04
Validation rmse = 0.162022
Validation r2 = 0.803151
Validation mse = 0.026251
Epoch 32
Loss = 8.4476e-02, PNorm = 35.2285, GNorm = 1.2951, lr_0 = 2.7267e-04
Validation rmse = 0.163893
Validation r2 = 0.798580
Validation mse = 0.026861
Epoch 33
Loss = 8.1285e-02, PNorm = 35.2360, GNorm = 1.2039, lr_0 = 2.6554e-04
Loss = 7.3928e-02, PNorm = 35.2451, GNorm = 0.8998, lr_0 = 2.5861e-04
Validation rmse = 0.166296
Validation r2 = 0.792629
Validation mse = 0.027654
Epoch 34
Loss = 7.0783e-02, PNorm = 35.2529, GNorm = 1.0967, lr_0 = 2.5119e-04
Validation rmse = 0.163539
Validation r2 = 0.799450
Validation mse = 0.026745
Epoch 35
Loss = 6.8251e-02, PNorm = 35.2610, GNorm = 1.0208, lr_0 = 2.4463e-04
Loss = 7.2581e-02, PNorm = 35.2674, GNorm = 0.9956, lr_0 = 2.3824e-04
Validation rmse = 0.166630
Validation r2 = 0.791795
Validation mse = 0.027766
Epoch 36
Loss = 6.8393e-02, PNorm = 35.2748, GNorm = 1.3087, lr_0 = 2.3140e-04
Validation rmse = 0.169243
Validation r2 = 0.785216
Validation mse = 0.028643
Epoch 37
Loss = 2.7814e-02, PNorm = 35.2822, GNorm = 0.6791, lr_0 = 2.2476e-04
Loss = 7.4078e-02, PNorm = 35.2882, GNorm = 3.1097, lr_0 = 2.1889e-04
Validation rmse = 0.168383
Validation r2 = 0.787391
Validation mse = 0.028353
Epoch 38
Loss = 5.9336e-02, PNorm = 35.2945, GNorm = 0.7649, lr_0 = 2.1317e-04
Loss = 7.0921e-02, PNorm = 35.3001, GNorm = 0.5100, lr_0 = 2.0761e-04
Loss = 1.4010e-01, PNorm = 35.3008, GNorm = 1.2006, lr_0 = 2.0706e-04
Validation rmse = 0.162804
Validation r2 = 0.801247
Validation mse = 0.026505
Epoch 39
Loss = 6.5210e-02, PNorm = 35.3065, GNorm = 0.4989, lr_0 = 2.0165e-04
Validation rmse = 0.163510
Validation r2 = 0.799521
Validation mse = 0.026735
Epoch 40
Loss = 6.8237e-02, PNorm = 35.3126, GNorm = 0.3519, lr_0 = 1.9638e-04
Loss = 6.6953e-02, PNorm = 35.3180, GNorm = 0.5609, lr_0 = 1.9125e-04
Validation rmse = 0.164702
Validation r2 = 0.796587
Validation mse = 0.027127
Epoch 41
Loss = 6.0312e-02, PNorm = 35.3243, GNorm = 1.6500, lr_0 = 1.8577e-04
Validation rmse = 0.164510
Validation r2 = 0.797060
Validation mse = 0.027064
Epoch 42
Loss = 5.7090e-02, PNorm = 35.3296, GNorm = 0.9986, lr_0 = 1.8044e-04
Loss = 6.9707e-02, PNorm = 35.3347, GNorm = 0.7112, lr_0 = 1.7572e-04
Validation rmse = 0.165176
Validation r2 = 0.795414
Validation mse = 0.027283
Epoch 43
Loss = 7.2862e-02, PNorm = 35.3391, GNorm = 2.7302, lr_0 = 1.7113e-04
Validation rmse = 0.165079
Validation r2 = 0.795653
Validation mse = 0.027251
Epoch 44
Loss = 7.5898e-02, PNorm = 35.3452, GNorm = 2.3422, lr_0 = 1.6622e-04
Loss = 6.7648e-02, PNorm = 35.3511, GNorm = 1.0070, lr_0 = 1.6188e-04
Validation rmse = 0.164074
Validation r2 = 0.798135
Validation mse = 0.026920
Epoch 45
Loss = 6.2012e-02, PNorm = 35.3559, GNorm = 0.9731, lr_0 = 1.5765e-04
Validation rmse = 0.165223
Validation r2 = 0.795298
Validation mse = 0.027299
Epoch 46
Loss = 5.9737e-02, PNorm = 35.3609, GNorm = 1.1013, lr_0 = 1.5313e-04
Loss = 6.4707e-02, PNorm = 35.3650, GNorm = 2.1774, lr_0 = 1.4913e-04
Validation rmse = 0.162575
Validation r2 = 0.801806
Validation mse = 0.026431
Epoch 47
Loss = 6.9890e-02, PNorm = 35.3697, GNorm = 0.8778, lr_0 = 1.4485e-04
Validation rmse = 0.171982
Validation r2 = 0.778207
Validation mse = 0.029578
Epoch 48
Loss = 6.2830e-02, PNorm = 35.3734, GNorm = 1.7290, lr_0 = 1.4107e-04
Loss = 6.4760e-02, PNorm = 35.3772, GNorm = 1.4054, lr_0 = 1.3738e-04
Validation rmse = 0.165782
Validation r2 = 0.793909
Validation mse = 0.027484
Epoch 49
Loss = 6.0946e-02, PNorm = 35.3819, GNorm = 0.4844, lr_0 = 1.3344e-04
Loss = 6.3257e-02, PNorm = 35.3863, GNorm = 1.3944, lr_0 = 1.2996e-04
Validation rmse = 0.164223
Validation r2 = 0.797767
Validation mse = 0.026969
Epoch 50
Loss = 6.3718e-02, PNorm = 35.3904, GNorm = 0.9799, lr_0 = 1.2656e-04
Validation rmse = 0.163247
Validation r2 = 0.800166
Validation mse = 0.026649
Epoch 51
Loss = 6.3623e-02, PNorm = 35.3946, GNorm = 0.6838, lr_0 = 1.2293e-04
Loss = 6.0791e-02, PNorm = 35.3978, GNorm = 0.5966, lr_0 = 1.1972e-04
Loss = 5.6524e-02, PNorm = 35.3981, GNorm = 1.3924, lr_0 = 1.1940e-04
Validation rmse = 0.163785
Validation r2 = 0.798844
Validation mse = 0.026826
Epoch 52
Loss = 6.2938e-02, PNorm = 35.4022, GNorm = 0.6096, lr_0 = 1.1628e-04
Validation rmse = 0.164046
Validation r2 = 0.798203
Validation mse = 0.026911
Epoch 53
Loss = 5.9254e-02, PNorm = 35.4054, GNorm = 0.6428, lr_0 = 1.1325e-04
Loss = 6.0924e-02, PNorm = 35.4081, GNorm = 1.3952, lr_0 = 1.1029e-04
Validation rmse = 0.169885
Validation r2 = 0.783583
Validation mse = 0.028861
Epoch 54
Loss = 5.6763e-02, PNorm = 35.4117, GNorm = 0.6031, lr_0 = 1.0712e-04
Validation rmse = 0.165762
Validation r2 = 0.793961
Validation mse = 0.027477
Epoch 55
Loss = 6.1106e-02, PNorm = 35.4156, GNorm = 0.4239, lr_0 = 1.0433e-04
Loss = 5.4136e-02, PNorm = 35.4188, GNorm = 0.6505, lr_0 = 1.0160e-04
Validation rmse = 0.168000
Validation r2 = 0.788358
Validation mse = 0.028224
Epoch 56
Loss = 5.7818e-02, PNorm = 35.4223, GNorm = 1.0559, lr_0 = 1.0000e-04
Validation rmse = 0.165909
Validation r2 = 0.793593
Validation mse = 0.027526
Epoch 57
Loss = 5.6546e-02, PNorm = 35.4252, GNorm = 0.5085, lr_0 = 1.0000e-04
Loss = 6.3178e-02, PNorm = 35.4280, GNorm = 1.7612, lr_0 = 1.0000e-04
Validation rmse = 0.165614
Validation r2 = 0.794327
Validation mse = 0.027428
Epoch 58
Loss = 7.6992e-02, PNorm = 35.4319, GNorm = 1.3701, lr_0 = 1.0000e-04
Validation rmse = 0.163582
Validation r2 = 0.799345
Validation mse = 0.026759
Epoch 59
Loss = 5.0808e-02, PNorm = 35.4349, GNorm = 1.5532, lr_0 = 1.0000e-04
Loss = 5.7906e-02, PNorm = 35.4382, GNorm = 0.5375, lr_0 = 1.0000e-04
Validation rmse = 0.166061
Validation r2 = 0.793215
Validation mse = 0.027576
Model 0 best validation rmse = 0.161132 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.173429
Model 0 test r2 = 0.560688
Model 0 test mse = 0.030078
Ensemble test rmse = 0.173429
Ensemble test r2 = 0.560688
Ensemble test mse = 0.030078
Fold 5
Splitting data with seed 5
Total size = 963 | train size = 770 | val size = 193 | test size = 59
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.9891e-01, PNorm = 34.0180, GNorm = 2.2919, lr_0 = 4.3000e-04
Validation rmse = 0.300322
Validation r2 = 0.317598
Validation mse = 0.090193
Epoch 1
Loss = 6.2764e-01, PNorm = 34.0541, GNorm = 4.4427, lr_0 = 7.6000e-04
Loss = 6.5620e-01, PNorm = 34.1101, GNorm = 4.7292, lr_0 = 9.9472e-04
Loss = 3.6463e-01, PNorm = 34.1160, GNorm = 5.7115, lr_0 = 9.9209e-04
Validation rmse = 0.267978
Validation r2 = 0.456670
Validation mse = 0.071812
Epoch 2
Loss = 4.6007e-01, PNorm = 34.1936, GNorm = 6.5636, lr_0 = 9.6618e-04
Validation rmse = 0.222324
Validation r2 = 0.626028
Validation mse = 0.049428
Epoch 3
Loss = 3.7555e-01, PNorm = 34.2646, GNorm = 3.4096, lr_0 = 9.4094e-04
Loss = 3.4192e-01, PNorm = 34.3341, GNorm = 6.4915, lr_0 = 9.1637e-04
Validation rmse = 0.206648
Validation r2 = 0.676906
Validation mse = 0.042704
Epoch 4
Loss = 2.4116e-01, PNorm = 34.4006, GNorm = 5.3708, lr_0 = 8.9007e-04
Validation rmse = 0.195717
Validation r2 = 0.710184
Validation mse = 0.038305
Epoch 5
Loss = 2.2764e-01, PNorm = 34.4619, GNorm = 1.1573, lr_0 = 8.6682e-04
Loss = 2.1780e-01, PNorm = 34.5192, GNorm = 2.4241, lr_0 = 8.4418e-04
Validation rmse = 0.179113
Validation r2 = 0.757271
Validation mse = 0.032082
Epoch 6
Loss = 1.9767e-01, PNorm = 34.5656, GNorm = 2.3770, lr_0 = 8.1996e-04
Validation rmse = 0.186312
Validation r2 = 0.737368
Validation mse = 0.034712
Epoch 7
Loss = 1.7102e-01, PNorm = 34.6159, GNorm = 8.5223, lr_0 = 7.9643e-04
Loss = 2.0479e-01, PNorm = 34.6531, GNorm = 8.6038, lr_0 = 7.7563e-04
Validation rmse = 0.178385
Validation r2 = 0.759240
Validation mse = 0.031821
Epoch 8
Loss = 1.5965e-01, PNorm = 34.6869, GNorm = 2.5645, lr_0 = 7.5537e-04
Validation rmse = 0.167606
Validation r2 = 0.787457
Validation mse = 0.028092
Epoch 9
Loss = 1.7833e-01, PNorm = 34.7188, GNorm = 1.9163, lr_0 = 7.3370e-04
Loss = 1.2293e-01, PNorm = 34.7412, GNorm = 3.1690, lr_0 = 7.1453e-04
Validation rmse = 0.164137
Validation r2 = 0.796165
Validation mse = 0.026941
Epoch 10
Loss = 1.2745e-01, PNorm = 34.7600, GNorm = 4.7164, lr_0 = 6.9587e-04
Validation rmse = 0.153141
Validation r2 = 0.822562
Validation mse = 0.023452
Epoch 11
Loss = 1.0443e-01, PNorm = 34.7867, GNorm = 0.6022, lr_0 = 6.7590e-04
Loss = 1.1679e-01, PNorm = 34.8024, GNorm = 3.8699, lr_0 = 6.5825e-04
Validation rmse = 0.149421
Validation r2 = 0.831077
Validation mse = 0.022327
Epoch 12
Loss = 1.0103e-01, PNorm = 34.8221, GNorm = 1.3277, lr_0 = 6.3936e-04
Loss = 1.2226e-01, PNorm = 34.8393, GNorm = 0.8465, lr_0 = 6.2266e-04
Validation rmse = 0.150733
Validation r2 = 0.828098
Validation mse = 0.022720
Epoch 13
Loss = 9.8775e-02, PNorm = 34.8530, GNorm = 1.8657, lr_0 = 6.0640e-04
Validation rmse = 0.157817
Validation r2 = 0.811560
Validation mse = 0.024906
Epoch 14
Loss = 1.1821e-01, PNorm = 34.8773, GNorm = 3.3663, lr_0 = 5.8900e-04
Loss = 1.1628e-01, PNorm = 34.8918, GNorm = 0.5210, lr_0 = 5.7362e-04
Validation rmse = 0.161730
Validation r2 = 0.802099
Validation mse = 0.026157
Epoch 15
Loss = 1.1556e-01, PNorm = 34.9077, GNorm = 1.8122, lr_0 = 5.5863e-04
Validation rmse = 0.149145
Validation r2 = 0.831701
Validation mse = 0.022244
Epoch 16
Loss = 1.1422e-01, PNorm = 34.9223, GNorm = 1.5600, lr_0 = 5.4260e-04
Loss = 1.0955e-01, PNorm = 34.9343, GNorm = 2.0804, lr_0 = 5.2843e-04
Validation rmse = 0.147733
Validation r2 = 0.834872
Validation mse = 0.021825
Epoch 17
Loss = 1.2055e-01, PNorm = 34.9503, GNorm = 0.7176, lr_0 = 5.1327e-04
Validation rmse = 0.146973
Validation r2 = 0.836567
Validation mse = 0.021601
Epoch 18
Loss = 8.9964e-02, PNorm = 34.9652, GNorm = 0.6473, lr_0 = 4.9986e-04
Loss = 1.0107e-01, PNorm = 34.9781, GNorm = 1.6988, lr_0 = 4.8681e-04
Validation rmse = 0.146575
Validation r2 = 0.837450
Validation mse = 0.021484
Epoch 19
Loss = 8.5254e-02, PNorm = 34.9907, GNorm = 1.7730, lr_0 = 4.7284e-04
Validation rmse = 0.148136
Validation r2 = 0.833971
Validation mse = 0.021944
Epoch 20
Loss = 1.1366e-01, PNorm = 35.0022, GNorm = 5.2966, lr_0 = 4.6049e-04
Loss = 8.8301e-02, PNorm = 35.0122, GNorm = 0.7913, lr_0 = 4.4846e-04
Validation rmse = 0.145736
Validation r2 = 0.839305
Validation mse = 0.021239
Epoch 21
Loss = 9.2464e-02, PNorm = 35.0227, GNorm = 3.2761, lr_0 = 4.3559e-04
Validation rmse = 0.146444
Validation r2 = 0.837741
Validation mse = 0.021446
Epoch 22
Loss = 1.2818e-01, PNorm = 35.0358, GNorm = 6.6429, lr_0 = 4.2309e-04
Loss = 1.0746e-01, PNorm = 35.0492, GNorm = 0.9006, lr_0 = 4.1204e-04
Validation rmse = 0.141979
Validation r2 = 0.847485
Validation mse = 0.020158
Epoch 23
Loss = 7.8738e-02, PNorm = 35.0597, GNorm = 2.3195, lr_0 = 4.0128e-04
Validation rmse = 0.156865
Validation r2 = 0.813826
Validation mse = 0.024607
Epoch 24
Loss = 9.6724e-02, PNorm = 35.0718, GNorm = 3.8794, lr_0 = 3.8977e-04
Loss = 8.8041e-02, PNorm = 35.0824, GNorm = 0.5444, lr_0 = 3.7959e-04
Validation rmse = 0.149132
Validation r2 = 0.831729
Validation mse = 0.022240
Epoch 25
Loss = 1.0191e-01, PNorm = 35.0946, GNorm = 1.7626, lr_0 = 3.6967e-04
Loss = 8.1622e-02, PNorm = 35.1044, GNorm = 0.7964, lr_0 = 3.6002e-04
Loss = 1.5537e-01, PNorm = 35.1054, GNorm = 4.5339, lr_0 = 3.5906e-04
Validation rmse = 0.148503
Validation r2 = 0.833146
Validation mse = 0.022053
Epoch 26
Loss = 8.1830e-02, PNorm = 35.1142, GNorm = 1.3970, lr_0 = 3.4969e-04
Validation rmse = 0.146380
Validation r2 = 0.837882
Validation mse = 0.021427
Epoch 27
Loss = 7.9287e-02, PNorm = 35.1245, GNorm = 1.1289, lr_0 = 3.3965e-04
Loss = 8.9142e-02, PNorm = 35.1333, GNorm = 4.2048, lr_0 = 3.3078e-04
Validation rmse = 0.145684
Validation r2 = 0.839421
Validation mse = 0.021224
Epoch 28
Loss = 8.0221e-02, PNorm = 35.1404, GNorm = 0.7945, lr_0 = 3.2214e-04
Validation rmse = 0.147357
Validation r2 = 0.835711
Validation mse = 0.021714
Epoch 29
Loss = 7.3542e-02, PNorm = 35.1490, GNorm = 1.0021, lr_0 = 3.1290e-04
Loss = 8.7115e-02, PNorm = 35.1556, GNorm = 2.6179, lr_0 = 3.0472e-04
Validation rmse = 0.144374
Validation r2 = 0.842295
Validation mse = 0.020844
Epoch 30
Loss = 8.2253e-02, PNorm = 35.1645, GNorm = 2.4618, lr_0 = 2.9677e-04
Validation rmse = 0.146799
Validation r2 = 0.836954
Validation mse = 0.021550
Epoch 31
Loss = 9.9382e-02, PNorm = 35.1745, GNorm = 3.3871, lr_0 = 2.8825e-04
Loss = 8.2980e-02, PNorm = 35.1800, GNorm = 0.9627, lr_0 = 2.8072e-04
Validation rmse = 0.144489
Validation r2 = 0.842044
Validation mse = 0.020877
Epoch 32
Loss = 8.5257e-02, PNorm = 35.1889, GNorm = 2.1351, lr_0 = 2.7267e-04
Validation rmse = 0.141667
Validation r2 = 0.848154
Validation mse = 0.020070
Epoch 33
Loss = 7.1325e-02, PNorm = 35.1975, GNorm = 2.5560, lr_0 = 2.6554e-04
Loss = 8.3738e-02, PNorm = 35.2030, GNorm = 2.9190, lr_0 = 2.5861e-04
Validation rmse = 0.141377
Validation r2 = 0.848775
Validation mse = 0.019988
Epoch 34
Loss = 7.4848e-02, PNorm = 35.2081, GNorm = 2.4743, lr_0 = 2.5119e-04
Validation rmse = 0.150031
Validation r2 = 0.829696
Validation mse = 0.022509
Epoch 35
Loss = 1.0508e-01, PNorm = 35.2134, GNorm = 4.5615, lr_0 = 2.4463e-04
Loss = 8.5330e-02, PNorm = 35.2202, GNorm = 1.4512, lr_0 = 2.3824e-04
Validation rmse = 0.143551
Validation r2 = 0.844089
Validation mse = 0.020607
Epoch 36
Loss = 7.1470e-02, PNorm = 35.2270, GNorm = 1.3844, lr_0 = 2.3140e-04
Validation rmse = 0.140606
Validation r2 = 0.850421
Validation mse = 0.019770
Epoch 37
Loss = 6.5502e-02, PNorm = 35.2340, GNorm = 1.3624, lr_0 = 2.2476e-04
Loss = 7.3322e-02, PNorm = 35.2389, GNorm = 1.7168, lr_0 = 2.1889e-04
Validation rmse = 0.144317
Validation r2 = 0.842419
Validation mse = 0.020828
Epoch 38
Loss = 7.9060e-02, PNorm = 35.2440, GNorm = 1.6204, lr_0 = 2.1317e-04
Loss = 7.5942e-02, PNorm = 35.2494, GNorm = 1.9373, lr_0 = 2.0761e-04
Loss = 7.5568e-02, PNorm = 35.2499, GNorm = 3.0955, lr_0 = 2.0706e-04
Validation rmse = 0.141629
Validation r2 = 0.848235
Validation mse = 0.020059
Epoch 39
Loss = 7.2016e-02, PNorm = 35.2551, GNorm = 0.4634, lr_0 = 2.0165e-04
Validation rmse = 0.141008
Validation r2 = 0.849564
Validation mse = 0.019883
Epoch 40
Loss = 6.8418e-02, PNorm = 35.2613, GNorm = 2.6058, lr_0 = 1.9638e-04
Loss = 7.5061e-02, PNorm = 35.2670, GNorm = 1.1510, lr_0 = 1.9125e-04
Validation rmse = 0.144367
Validation r2 = 0.842310
Validation mse = 0.020842
Epoch 41
Loss = 7.0455e-02, PNorm = 35.2723, GNorm = 3.1575, lr_0 = 1.8577e-04
Validation rmse = 0.140077
Validation r2 = 0.851544
Validation mse = 0.019621
Epoch 42
Loss = 6.5833e-02, PNorm = 35.2767, GNorm = 0.6997, lr_0 = 1.8044e-04
Loss = 7.3214e-02, PNorm = 35.2817, GNorm = 0.6856, lr_0 = 1.7572e-04
Validation rmse = 0.140175
Validation r2 = 0.851336
Validation mse = 0.019649
Epoch 43
Loss = 6.6630e-02, PNorm = 35.2865, GNorm = 0.9841, lr_0 = 1.7113e-04
Validation rmse = 0.140211
Validation r2 = 0.851259
Validation mse = 0.019659
Epoch 44
Loss = 7.4167e-02, PNorm = 35.2912, GNorm = 2.5410, lr_0 = 1.6622e-04
Loss = 6.9947e-02, PNorm = 35.2954, GNorm = 2.2217, lr_0 = 1.6188e-04
Validation rmse = 0.140323
Validation r2 = 0.851022
Validation mse = 0.019691
Epoch 45
Loss = 7.4383e-02, PNorm = 35.2997, GNorm = 1.0060, lr_0 = 1.5765e-04
Validation rmse = 0.139515
Validation r2 = 0.852733
Validation mse = 0.019464
Epoch 46
Loss = 8.8752e-02, PNorm = 35.3037, GNorm = 1.0033, lr_0 = 1.5313e-04
Loss = 6.7929e-02, PNorm = 35.3080, GNorm = 0.8079, lr_0 = 1.4913e-04
Validation rmse = 0.144669
Validation r2 = 0.841650
Validation mse = 0.020929
Epoch 47
Loss = 7.4048e-02, PNorm = 35.3120, GNorm = 1.0429, lr_0 = 1.4485e-04
Validation rmse = 0.139979
Validation r2 = 0.851751
Validation mse = 0.019594
Epoch 48
Loss = 9.7053e-02, PNorm = 35.3162, GNorm = 1.6274, lr_0 = 1.4107e-04
Loss = 6.4957e-02, PNorm = 35.3201, GNorm = 1.9112, lr_0 = 1.3738e-04
Validation rmse = 0.142055
Validation r2 = 0.847321
Validation mse = 0.020180
Epoch 49
Loss = 6.6699e-02, PNorm = 35.3236, GNorm = 1.4794, lr_0 = 1.3344e-04
Loss = 6.8552e-02, PNorm = 35.3274, GNorm = 1.3156, lr_0 = 1.2996e-04
Validation rmse = 0.139627
Validation r2 = 0.852497
Validation mse = 0.019496
Epoch 50
Loss = 6.2300e-02, PNorm = 35.3302, GNorm = 1.4740, lr_0 = 1.2656e-04
Validation rmse = 0.138694
Validation r2 = 0.854461
Validation mse = 0.019236
Epoch 51
Loss = 6.3418e-02, PNorm = 35.3337, GNorm = 1.1420, lr_0 = 1.2293e-04
Loss = 6.9019e-02, PNorm = 35.3372, GNorm = 2.3577, lr_0 = 1.1972e-04
Loss = 9.8636e-02, PNorm = 35.3377, GNorm = 3.8680, lr_0 = 1.1940e-04
Validation rmse = 0.139022
Validation r2 = 0.853772
Validation mse = 0.019327
Epoch 52
Loss = 6.8362e-02, PNorm = 35.3410, GNorm = 1.4689, lr_0 = 1.1628e-04
Validation rmse = 0.145018
Validation r2 = 0.840886
Validation mse = 0.021030
Epoch 53
Loss = 6.5521e-02, PNorm = 35.3441, GNorm = 1.4056, lr_0 = 1.1325e-04
Loss = 7.1667e-02, PNorm = 35.3471, GNorm = 0.5247, lr_0 = 1.1029e-04
Validation rmse = 0.138770
Validation r2 = 0.854301
Validation mse = 0.019257
Epoch 54
Loss = 6.9378e-02, PNorm = 35.3499, GNorm = 2.0615, lr_0 = 1.0712e-04
Validation rmse = 0.138331
Validation r2 = 0.855221
Validation mse = 0.019135
Epoch 55
Loss = 6.2665e-02, PNorm = 35.3528, GNorm = 2.1568, lr_0 = 1.0433e-04
Loss = 6.6001e-02, PNorm = 35.3561, GNorm = 0.4497, lr_0 = 1.0160e-04
Validation rmse = 0.138746
Validation r2 = 0.854352
Validation mse = 0.019250
Epoch 56
Loss = 7.0755e-02, PNorm = 35.3594, GNorm = 0.5407, lr_0 = 1.0000e-04
Validation rmse = 0.139449
Validation r2 = 0.852872
Validation mse = 0.019446
Epoch 57
Loss = 6.6568e-02, PNorm = 35.3625, GNorm = 1.0350, lr_0 = 1.0000e-04
Loss = 6.6974e-02, PNorm = 35.3644, GNorm = 1.9724, lr_0 = 1.0000e-04
Validation rmse = 0.137705
Validation r2 = 0.856529
Validation mse = 0.018963
Epoch 58
Loss = 5.8546e-02, PNorm = 35.3672, GNorm = 0.9269, lr_0 = 1.0000e-04
Validation rmse = 0.138631
Validation r2 = 0.854593
Validation mse = 0.019218
Epoch 59
Loss = 5.8331e-02, PNorm = 35.3704, GNorm = 0.7778, lr_0 = 1.0000e-04
Loss = 6.1857e-02, PNorm = 35.3731, GNorm = 1.0486, lr_0 = 1.0000e-04
Validation rmse = 0.138334
Validation r2 = 0.855216
Validation mse = 0.019136
Model 0 best validation rmse = 0.137705 on epoch 57
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.260626
Model 0 test r2 = 0.007881
Model 0 test mse = 0.067926
Ensemble test rmse = 0.260626
Ensemble test r2 = 0.007881
Ensemble test mse = 0.067926
Fold 6
Splitting data with seed 6
Total size = 963 | train size = 770 | val size = 193 | test size = 59
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.3949e-01, PNorm = 34.0170, GNorm = 5.2600, lr_0 = 4.3000e-04
Validation rmse = 0.337290
Validation r2 = -0.000173
Validation mse = 0.113765
Epoch 1
Loss = 7.6904e-01, PNorm = 34.0452, GNorm = 9.2516, lr_0 = 7.6000e-04
Loss = 8.3458e-01, PNorm = 34.0929, GNorm = 4.6240, lr_0 = 9.9472e-04
Loss = 6.5171e-01, PNorm = 34.0986, GNorm = 2.4230, lr_0 = 9.9209e-04
Validation rmse = 0.273248
Validation r2 = 0.343578
Validation mse = 0.074665
Epoch 2
Loss = 5.3754e-01, PNorm = 34.1799, GNorm = 3.6400, lr_0 = 9.6618e-04
Validation rmse = 0.222670
Validation r2 = 0.564095
Validation mse = 0.049582
Epoch 3
Loss = 3.9513e-01, PNorm = 34.2597, GNorm = 2.2286, lr_0 = 9.4094e-04
Loss = 3.7147e-01, PNorm = 34.3351, GNorm = 3.1984, lr_0 = 9.1637e-04
Validation rmse = 0.194378
Validation r2 = 0.667828
Validation mse = 0.037783
Epoch 4
Loss = 3.1391e-01, PNorm = 34.4104, GNorm = 2.1482, lr_0 = 8.9007e-04
Validation rmse = 0.207906
Validation r2 = 0.619984
Validation mse = 0.043225
Epoch 5
Loss = 2.5995e-01, PNorm = 34.4653, GNorm = 3.3685, lr_0 = 8.6682e-04
Loss = 2.4694e-01, PNorm = 34.5145, GNorm = 5.1886, lr_0 = 8.4418e-04
Validation rmse = 0.169567
Validation r2 = 0.747215
Validation mse = 0.028753
Epoch 6
Loss = 1.7588e-01, PNorm = 34.5656, GNorm = 1.5688, lr_0 = 8.1996e-04
Validation rmse = 0.158024
Validation r2 = 0.780459
Validation mse = 0.024972
Epoch 7
Loss = 1.9542e-01, PNorm = 34.6141, GNorm = 1.8039, lr_0 = 7.9643e-04
Loss = 1.7057e-01, PNorm = 34.6569, GNorm = 0.8040, lr_0 = 7.7563e-04
Validation rmse = 0.146596
Validation r2 = 0.811064
Validation mse = 0.021490
Epoch 8
Loss = 1.6906e-01, PNorm = 34.6970, GNorm = 4.6003, lr_0 = 7.5537e-04
Validation rmse = 0.180159
Validation r2 = 0.714648
Validation mse = 0.032457
Epoch 9
Loss = 2.4996e-01, PNorm = 34.7324, GNorm = 3.8697, lr_0 = 7.3370e-04
Loss = 1.7192e-01, PNorm = 34.7666, GNorm = 3.7674, lr_0 = 7.1453e-04
Validation rmse = 0.146491
Validation r2 = 0.811336
Validation mse = 0.021460
Epoch 10
Loss = 1.5067e-01, PNorm = 34.7955, GNorm = 1.8818, lr_0 = 6.9587e-04
Validation rmse = 0.148412
Validation r2 = 0.806356
Validation mse = 0.022026
Epoch 11
Loss = 1.5283e-01, PNorm = 34.8271, GNorm = 2.4842, lr_0 = 6.7590e-04
Loss = 1.1130e-01, PNorm = 34.8494, GNorm = 2.8529, lr_0 = 6.5825e-04
Validation rmse = 0.139305
Validation r2 = 0.829392
Validation mse = 0.019406
Epoch 12
Loss = 1.0715e-01, PNorm = 34.8753, GNorm = 0.8425, lr_0 = 6.3936e-04
Loss = 1.6098e-01, PNorm = 34.9005, GNorm = 4.4179, lr_0 = 6.2266e-04
Validation rmse = 0.147908
Validation r2 = 0.807668
Validation mse = 0.021877
Epoch 13
Loss = 1.2395e-01, PNorm = 34.9208, GNorm = 3.6831, lr_0 = 6.0640e-04
Validation rmse = 0.134714
Validation r2 = 0.840452
Validation mse = 0.018148
Epoch 14
Loss = 1.0008e-01, PNorm = 34.9441, GNorm = 1.4540, lr_0 = 5.8900e-04
Loss = 1.1843e-01, PNorm = 34.9640, GNorm = 2.2376, lr_0 = 5.7362e-04
Validation rmse = 0.130118
Validation r2 = 0.851152
Validation mse = 0.016931
Epoch 15
Loss = 1.0344e-01, PNorm = 34.9863, GNorm = 1.0700, lr_0 = 5.5863e-04
Validation rmse = 0.135997
Validation r2 = 0.837397
Validation mse = 0.018495
Epoch 16
Loss = 1.0278e-01, PNorm = 35.0045, GNorm = 3.2994, lr_0 = 5.4260e-04
Loss = 1.0616e-01, PNorm = 35.0179, GNorm = 1.4222, lr_0 = 5.2843e-04
Validation rmse = 0.127488
Validation r2 = 0.857107
Validation mse = 0.016253
Epoch 17
Loss = 1.0152e-01, PNorm = 35.0418, GNorm = 1.7896, lr_0 = 5.1327e-04
Validation rmse = 0.130247
Validation r2 = 0.850856
Validation mse = 0.016964
Epoch 18
Loss = 9.9740e-02, PNorm = 35.0574, GNorm = 0.7796, lr_0 = 4.9986e-04
Loss = 9.0747e-02, PNorm = 35.0728, GNorm = 0.6067, lr_0 = 4.8681e-04
Validation rmse = 0.133114
Validation r2 = 0.844219
Validation mse = 0.017719
Epoch 19
Loss = 1.0396e-01, PNorm = 35.0876, GNorm = 0.5570, lr_0 = 4.7284e-04
Validation rmse = 0.125823
Validation r2 = 0.860816
Validation mse = 0.015832
Epoch 20
Loss = 9.1792e-02, PNorm = 35.1031, GNorm = 2.7348, lr_0 = 4.6049e-04
Loss = 9.7985e-02, PNorm = 35.1171, GNorm = 0.7097, lr_0 = 4.4846e-04
Validation rmse = 0.126926
Validation r2 = 0.858366
Validation mse = 0.016110
Epoch 21
Loss = 9.3811e-02, PNorm = 35.1337, GNorm = 1.3010, lr_0 = 4.3559e-04
Validation rmse = 0.125569
Validation r2 = 0.861377
Validation mse = 0.015768
Epoch 22
Loss = 9.2569e-02, PNorm = 35.1492, GNorm = 1.2246, lr_0 = 4.2309e-04
Loss = 1.0046e-01, PNorm = 35.1637, GNorm = 1.1815, lr_0 = 4.1204e-04
Validation rmse = 0.131641
Validation r2 = 0.847647
Validation mse = 0.017329
Epoch 23
Loss = 1.0743e-01, PNorm = 35.1770, GNorm = 3.2323, lr_0 = 4.0128e-04
Validation rmse = 0.124030
Validation r2 = 0.864756
Validation mse = 0.015383
Epoch 24
Loss = 1.2426e-01, PNorm = 35.1901, GNorm = 2.0963, lr_0 = 3.8977e-04
Loss = 8.7840e-02, PNorm = 35.2033, GNorm = 0.9030, lr_0 = 3.7959e-04
Validation rmse = 0.126640
Validation r2 = 0.859002
Validation mse = 0.016038
Epoch 25
Loss = 8.4411e-02, PNorm = 35.2174, GNorm = 0.9801, lr_0 = 3.6967e-04
Loss = 8.7620e-02, PNorm = 35.2297, GNorm = 1.0137, lr_0 = 3.6002e-04
Loss = 5.8444e-02, PNorm = 35.2308, GNorm = 0.7941, lr_0 = 3.5906e-04
Validation rmse = 0.122518
Validation r2 = 0.868031
Validation mse = 0.015011
Epoch 26
Loss = 8.5947e-02, PNorm = 35.2418, GNorm = 1.2203, lr_0 = 3.4969e-04
Validation rmse = 0.135642
Validation r2 = 0.838245
Validation mse = 0.018399
Epoch 27
Loss = 9.9802e-02, PNorm = 35.2540, GNorm = 3.6250, lr_0 = 3.3965e-04
Loss = 1.0253e-01, PNorm = 35.2668, GNorm = 1.1774, lr_0 = 3.3078e-04
Validation rmse = 0.125933
Validation r2 = 0.860572
Validation mse = 0.015859
Epoch 28
Loss = 7.2068e-02, PNorm = 35.2784, GNorm = 0.9686, lr_0 = 3.2214e-04
Validation rmse = 0.125473
Validation r2 = 0.861590
Validation mse = 0.015743
Epoch 29
Loss = 8.2010e-02, PNorm = 35.2900, GNorm = 1.5885, lr_0 = 3.1290e-04
Loss = 8.2516e-02, PNorm = 35.3011, GNorm = 1.9731, lr_0 = 3.0472e-04
Validation rmse = 0.129065
Validation r2 = 0.853551
Validation mse = 0.016658
Epoch 30
Loss = 7.7976e-02, PNorm = 35.3124, GNorm = 0.7548, lr_0 = 2.9677e-04
Validation rmse = 0.122687
Validation r2 = 0.867669
Validation mse = 0.015052
Epoch 31
Loss = 5.2984e-02, PNorm = 35.3223, GNorm = 1.1551, lr_0 = 2.8825e-04
Loss = 8.4167e-02, PNorm = 35.3310, GNorm = 0.9694, lr_0 = 2.8072e-04
Validation rmse = 0.123376
Validation r2 = 0.866176
Validation mse = 0.015222
Epoch 32
Loss = 7.6591e-02, PNorm = 35.3438, GNorm = 0.6845, lr_0 = 2.7267e-04
Validation rmse = 0.123647
Validation r2 = 0.865589
Validation mse = 0.015289
Epoch 33
Loss = 6.0671e-02, PNorm = 35.3512, GNorm = 1.3420, lr_0 = 2.6554e-04
Loss = 8.6340e-02, PNorm = 35.3590, GNorm = 4.2283, lr_0 = 2.5861e-04
Validation rmse = 0.122623
Validation r2 = 0.867806
Validation mse = 0.015036
Epoch 34
Loss = 6.5062e-02, PNorm = 35.3667, GNorm = 0.5965, lr_0 = 2.5119e-04
Validation rmse = 0.123179
Validation r2 = 0.866604
Validation mse = 0.015173
Epoch 35
Loss = 5.9359e-02, PNorm = 35.3756, GNorm = 0.4802, lr_0 = 2.4463e-04
Loss = 9.6781e-02, PNorm = 35.3862, GNorm = 2.9441, lr_0 = 2.3824e-04
Validation rmse = 0.122933
Validation r2 = 0.867136
Validation mse = 0.015113
Epoch 36
Loss = 7.2189e-02, PNorm = 35.3949, GNorm = 1.6228, lr_0 = 2.3140e-04
Validation rmse = 0.122715
Validation r2 = 0.867607
Validation mse = 0.015059
Epoch 37
Loss = 9.4934e-02, PNorm = 35.4040, GNorm = 0.7252, lr_0 = 2.2476e-04
Loss = 7.1013e-02, PNorm = 35.4102, GNorm = 1.0431, lr_0 = 2.1889e-04
Validation rmse = 0.121993
Validation r2 = 0.869161
Validation mse = 0.014882
Epoch 38
Loss = 6.8040e-02, PNorm = 35.4166, GNorm = 0.9159, lr_0 = 2.1317e-04
Loss = 7.7388e-02, PNorm = 35.4235, GNorm = 0.8193, lr_0 = 2.0761e-04
Loss = 7.6912e-02, PNorm = 35.4240, GNorm = 2.0534, lr_0 = 2.0706e-04
Validation rmse = 0.128974
Validation r2 = 0.853757
Validation mse = 0.016634
Epoch 39
Loss = 7.5050e-02, PNorm = 35.4296, GNorm = 1.7922, lr_0 = 2.0165e-04
Validation rmse = 0.123138
Validation r2 = 0.866694
Validation mse = 0.015163
Epoch 40
Loss = 7.5345e-02, PNorm = 35.4366, GNorm = 2.8600, lr_0 = 1.9638e-04
Loss = 6.8472e-02, PNorm = 35.4426, GNorm = 0.5794, lr_0 = 1.9125e-04
Validation rmse = 0.122083
Validation r2 = 0.868967
Validation mse = 0.014904
Epoch 41
Loss = 7.3500e-02, PNorm = 35.4500, GNorm = 1.9525, lr_0 = 1.8577e-04
Validation rmse = 0.122753
Validation r2 = 0.867526
Validation mse = 0.015068
Epoch 42
Loss = 6.4104e-02, PNorm = 35.4568, GNorm = 0.9421, lr_0 = 1.8044e-04
Loss = 6.9598e-02, PNorm = 35.4621, GNorm = 1.2756, lr_0 = 1.7572e-04
Validation rmse = 0.122079
Validation r2 = 0.868976
Validation mse = 0.014903
Epoch 43
Loss = 6.0734e-02, PNorm = 35.4675, GNorm = 0.7071, lr_0 = 1.7113e-04
Validation rmse = 0.121152
Validation r2 = 0.870959
Validation mse = 0.014678
Epoch 44
Loss = 6.5299e-02, PNorm = 35.4734, GNorm = 1.3941, lr_0 = 1.6622e-04
Loss = 6.8021e-02, PNorm = 35.4789, GNorm = 0.8630, lr_0 = 1.6188e-04
Validation rmse = 0.121585
Validation r2 = 0.870034
Validation mse = 0.014783
Epoch 45
Loss = 6.5805e-02, PNorm = 35.4831, GNorm = 0.7014, lr_0 = 1.5765e-04
Validation rmse = 0.120879
Validation r2 = 0.871539
Validation mse = 0.014612
Epoch 46
Loss = 6.0039e-02, PNorm = 35.4884, GNorm = 0.6241, lr_0 = 1.5313e-04
Loss = 7.4045e-02, PNorm = 35.4953, GNorm = 2.0316, lr_0 = 1.4913e-04
Validation rmse = 0.125546
Validation r2 = 0.861428
Validation mse = 0.015762
Epoch 47
Loss = 7.0936e-02, PNorm = 35.4997, GNorm = 1.6375, lr_0 = 1.4485e-04
Validation rmse = 0.121331
Validation r2 = 0.870576
Validation mse = 0.014721
Epoch 48
Loss = 5.7066e-02, PNorm = 35.5037, GNorm = 1.0399, lr_0 = 1.4107e-04
Loss = 7.2072e-02, PNorm = 35.5087, GNorm = 0.7562, lr_0 = 1.3738e-04
Validation rmse = 0.123607
Validation r2 = 0.865676
Validation mse = 0.015279
Epoch 49
Loss = 9.4550e-02, PNorm = 35.5140, GNorm = 1.3730, lr_0 = 1.3344e-04
Loss = 5.3769e-02, PNorm = 35.5185, GNorm = 0.9781, lr_0 = 1.2996e-04
Validation rmse = 0.126725
Validation r2 = 0.858815
Validation mse = 0.016059
Epoch 50
Loss = 7.0836e-02, PNorm = 35.5227, GNorm = 1.1748, lr_0 = 1.2656e-04
Validation rmse = 0.122819
Validation r2 = 0.867384
Validation mse = 0.015084
Epoch 51
Loss = 6.5753e-02, PNorm = 35.5274, GNorm = 0.9552, lr_0 = 1.2293e-04
Loss = 6.4474e-02, PNorm = 35.5315, GNorm = 0.8162, lr_0 = 1.1972e-04
Loss = 8.3996e-02, PNorm = 35.5319, GNorm = 1.6986, lr_0 = 1.1940e-04
Validation rmse = 0.121567
Validation r2 = 0.870072
Validation mse = 0.014779
Epoch 52
Loss = 7.1105e-02, PNorm = 35.5361, GNorm = 0.7163, lr_0 = 1.1628e-04
Validation rmse = 0.123647
Validation r2 = 0.865589
Validation mse = 0.015289
Epoch 53
Loss = 5.6453e-02, PNorm = 35.5400, GNorm = 0.5805, lr_0 = 1.1325e-04
Loss = 7.1234e-02, PNorm = 35.5431, GNorm = 1.0901, lr_0 = 1.1029e-04
Validation rmse = 0.121423
Validation r2 = 0.870380
Validation mse = 0.014744
Epoch 54
Loss = 6.3196e-02, PNorm = 35.5481, GNorm = 0.5870, lr_0 = 1.0712e-04
Validation rmse = 0.122845
Validation r2 = 0.867326
Validation mse = 0.015091
Epoch 55
Loss = 6.8154e-02, PNorm = 35.5522, GNorm = 0.6428, lr_0 = 1.0433e-04
Loss = 5.7510e-02, PNorm = 35.5558, GNorm = 1.5068, lr_0 = 1.0160e-04
Validation rmse = 0.120469
Validation r2 = 0.872408
Validation mse = 0.014513
Epoch 56
Loss = 6.5869e-02, PNorm = 35.5601, GNorm = 0.7633, lr_0 = 1.0000e-04
Validation rmse = 0.123235
Validation r2 = 0.866484
Validation mse = 0.015187
Epoch 57
Loss = 6.2446e-02, PNorm = 35.5639, GNorm = 0.7749, lr_0 = 1.0000e-04
Loss = 7.0260e-02, PNorm = 35.5670, GNorm = 0.6815, lr_0 = 1.0000e-04
Validation rmse = 0.121693
Validation r2 = 0.869804
Validation mse = 0.014809
Epoch 58
Loss = 6.1115e-02, PNorm = 35.5710, GNorm = 0.5779, lr_0 = 1.0000e-04
Validation rmse = 0.129081
Validation r2 = 0.853514
Validation mse = 0.016662
Epoch 59
Loss = 6.5146e-02, PNorm = 35.5744, GNorm = 2.5181, lr_0 = 1.0000e-04
Loss = 6.3506e-02, PNorm = 35.5776, GNorm = 0.3813, lr_0 = 1.0000e-04
Validation rmse = 0.120567
Validation r2 = 0.872202
Validation mse = 0.014536
Model 0 best validation rmse = 0.120469 on epoch 55
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.182901
Model 0 test r2 = 0.511390
Model 0 test mse = 0.033453
Ensemble test rmse = 0.182901
Ensemble test r2 = 0.511390
Ensemble test mse = 0.033453
Fold 7
Splitting data with seed 7
Total size = 963 | train size = 770 | val size = 193 | test size = 59
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.3188e-01, PNorm = 34.0181, GNorm = 0.8643, lr_0 = 4.3000e-04
Validation rmse = 0.282621
Validation r2 = 0.307211
Validation mse = 0.079875
Epoch 1
Loss = 6.3851e-01, PNorm = 34.0478, GNorm = 1.3750, lr_0 = 7.6000e-04
Loss = 5.9597e-01, PNorm = 34.1153, GNorm = 12.2771, lr_0 = 9.9472e-04
Loss = 4.9744e-01, PNorm = 34.1229, GNorm = 3.7295, lr_0 = 9.9209e-04
Validation rmse = 0.277649
Validation r2 = 0.331371
Validation mse = 0.077089
Epoch 2
Loss = 5.3281e-01, PNorm = 34.1939, GNorm = 7.5774, lr_0 = 9.6618e-04
Validation rmse = 0.227775
Validation r2 = 0.550007
Validation mse = 0.051882
Epoch 3
Loss = 3.5999e-01, PNorm = 34.2623, GNorm = 1.3222, lr_0 = 9.4094e-04
Loss = 3.6501e-01, PNorm = 34.3225, GNorm = 1.5931, lr_0 = 9.1637e-04
Validation rmse = 0.217722
Validation r2 = 0.588855
Validation mse = 0.047403
Epoch 4
Loss = 2.9797e-01, PNorm = 34.3904, GNorm = 4.3510, lr_0 = 8.9007e-04
Validation rmse = 0.168333
Validation r2 = 0.754229
Validation mse = 0.028336
Epoch 5
Loss = 2.5884e-01, PNorm = 34.4466, GNorm = 2.1265, lr_0 = 8.6682e-04
Loss = 1.9291e-01, PNorm = 34.5042, GNorm = 2.8153, lr_0 = 8.4418e-04
Validation rmse = 0.192886
Validation r2 = 0.677304
Validation mse = 0.037205
Epoch 6
Loss = 2.1840e-01, PNorm = 34.5515, GNorm = 3.3742, lr_0 = 8.1996e-04
Validation rmse = 0.161151
Validation r2 = 0.774755
Validation mse = 0.025970
Epoch 7
Loss = 1.3822e-01, PNorm = 34.5984, GNorm = 0.8068, lr_0 = 7.9643e-04
Loss = 1.8268e-01, PNorm = 34.6373, GNorm = 2.3520, lr_0 = 7.7563e-04
Validation rmse = 0.171846
Validation r2 = 0.743864
Validation mse = 0.029531
Epoch 8
Loss = 1.6536e-01, PNorm = 34.6733, GNorm = 0.9518, lr_0 = 7.5537e-04
Validation rmse = 0.146222
Validation r2 = 0.814553
Validation mse = 0.021381
Epoch 9
Loss = 1.4784e-01, PNorm = 34.7120, GNorm = 0.9253, lr_0 = 7.3370e-04
Loss = 1.5132e-01, PNorm = 34.7401, GNorm = 1.1060, lr_0 = 7.1453e-04
Validation rmse = 0.155034
Validation r2 = 0.791529
Validation mse = 0.024036
Epoch 10
Loss = 1.3163e-01, PNorm = 34.7696, GNorm = 2.2578, lr_0 = 6.9587e-04
Validation rmse = 0.154868
Validation r2 = 0.791974
Validation mse = 0.023984
Epoch 11
Loss = 2.1105e-01, PNorm = 34.7985, GNorm = 3.6675, lr_0 = 6.7590e-04
Loss = 1.1761e-01, PNorm = 34.8235, GNorm = 1.9131, lr_0 = 6.5825e-04
Validation rmse = 0.151494
Validation r2 = 0.800941
Validation mse = 0.022950
Epoch 12
Loss = 1.1374e-01, PNorm = 34.8462, GNorm = 0.7516, lr_0 = 6.3936e-04
Loss = 1.2641e-01, PNorm = 34.8665, GNorm = 1.0387, lr_0 = 6.2266e-04
Validation rmse = 0.138084
Validation r2 = 0.834621
Validation mse = 0.019067
Epoch 13
Loss = 1.1323e-01, PNorm = 34.8879, GNorm = 1.1859, lr_0 = 6.0640e-04
Validation rmse = 0.144337
Validation r2 = 0.819305
Validation mse = 0.020833
Epoch 14
Loss = 1.1741e-01, PNorm = 34.9062, GNorm = 0.6852, lr_0 = 5.8900e-04
Loss = 1.0949e-01, PNorm = 34.9235, GNorm = 0.4706, lr_0 = 5.7362e-04
Validation rmse = 0.162054
Validation r2 = 0.772223
Validation mse = 0.026261
Epoch 15
Loss = 1.2186e-01, PNorm = 34.9348, GNorm = 2.6017, lr_0 = 5.5863e-04
Validation rmse = 0.140570
Validation r2 = 0.828613
Validation mse = 0.019760
Epoch 16
Loss = 8.7473e-02, PNorm = 34.9531, GNorm = 2.1437, lr_0 = 5.4260e-04
Loss = 1.0760e-01, PNorm = 34.9718, GNorm = 1.6399, lr_0 = 5.2843e-04
Validation rmse = 0.141748
Validation r2 = 0.825729
Validation mse = 0.020093
Epoch 17
Loss = 1.0559e-01, PNorm = 34.9836, GNorm = 3.0114, lr_0 = 5.1327e-04
Validation rmse = 0.148679
Validation r2 = 0.808269
Validation mse = 0.022106
Epoch 18
Loss = 1.1108e-01, PNorm = 35.0007, GNorm = 1.3010, lr_0 = 4.9986e-04
Loss = 1.0480e-01, PNorm = 35.0160, GNorm = 0.8543, lr_0 = 4.8681e-04
Validation rmse = 0.143389
Validation r2 = 0.821671
Validation mse = 0.020560
Epoch 19
Loss = 9.4060e-02, PNorm = 35.0330, GNorm = 2.2007, lr_0 = 4.7284e-04
Validation rmse = 0.140111
Validation r2 = 0.829732
Validation mse = 0.019631
Epoch 20
Loss = 7.9959e-02, PNorm = 35.0453, GNorm = 1.0423, lr_0 = 4.6049e-04
Loss = 9.0960e-02, PNorm = 35.0573, GNorm = 1.6617, lr_0 = 4.4846e-04
Validation rmse = 0.136871
Validation r2 = 0.837514
Validation mse = 0.018734
Epoch 21
Loss = 8.0102e-02, PNorm = 35.0738, GNorm = 2.4803, lr_0 = 4.3559e-04
Validation rmse = 0.142279
Validation r2 = 0.824422
Validation mse = 0.020243
Epoch 22
Loss = 1.1010e-01, PNorm = 35.0836, GNorm = 1.3269, lr_0 = 4.2309e-04
Loss = 8.9705e-02, PNorm = 35.0950, GNorm = 2.1600, lr_0 = 4.1204e-04
Validation rmse = 0.139117
Validation r2 = 0.832137
Validation mse = 0.019354
Epoch 23
Loss = 8.6252e-02, PNorm = 35.1062, GNorm = 0.8467, lr_0 = 4.0128e-04
Validation rmse = 0.140326
Validation r2 = 0.829208
Validation mse = 0.019691
Epoch 24
Loss = 1.1327e-01, PNorm = 35.1184, GNorm = 2.6450, lr_0 = 3.8977e-04
Loss = 7.6096e-02, PNorm = 35.1285, GNorm = 2.1739, lr_0 = 3.7959e-04
Validation rmse = 0.135598
Validation r2 = 0.840524
Validation mse = 0.018387
Epoch 25
Loss = 7.2114e-02, PNorm = 35.1419, GNorm = 0.9668, lr_0 = 3.6967e-04
Loss = 8.3936e-02, PNorm = 35.1562, GNorm = 1.4878, lr_0 = 3.6002e-04
Loss = 9.7574e-02, PNorm = 35.1569, GNorm = 2.4024, lr_0 = 3.5906e-04
Validation rmse = 0.140699
Validation r2 = 0.828298
Validation mse = 0.019796
Epoch 26
Loss = 7.8185e-02, PNorm = 35.1658, GNorm = 0.7337, lr_0 = 3.4969e-04
Validation rmse = 0.137100
Validation r2 = 0.836970
Validation mse = 0.018796
Epoch 27
Loss = 8.0106e-02, PNorm = 35.1749, GNorm = 1.5824, lr_0 = 3.3965e-04
Loss = 8.5343e-02, PNorm = 35.1862, GNorm = 2.2102, lr_0 = 3.3078e-04
Validation rmse = 0.135921
Validation r2 = 0.839763
Validation mse = 0.018474
Epoch 28
Loss = 8.0868e-02, PNorm = 35.1946, GNorm = 0.7505, lr_0 = 3.2214e-04
Validation rmse = 0.138052
Validation r2 = 0.834700
Validation mse = 0.019058
Epoch 29
Loss = 8.2132e-02, PNorm = 35.2055, GNorm = 1.0465, lr_0 = 3.1290e-04
Loss = 7.9909e-02, PNorm = 35.2145, GNorm = 0.9612, lr_0 = 3.0472e-04
Validation rmse = 0.138593
Validation r2 = 0.833401
Validation mse = 0.019208
Epoch 30
Loss = 8.3336e-02, PNorm = 35.2226, GNorm = 3.8439, lr_0 = 2.9677e-04
Validation rmse = 0.148700
Validation r2 = 0.808216
Validation mse = 0.022112
Epoch 31
Loss = 7.7935e-02, PNorm = 35.2314, GNorm = 0.8885, lr_0 = 2.8825e-04
Loss = 8.4688e-02, PNorm = 35.2414, GNorm = 2.0997, lr_0 = 2.8072e-04
Validation rmse = 0.136400
Validation r2 = 0.838631
Validation mse = 0.018605
Epoch 32
Loss = 8.5170e-02, PNorm = 35.2500, GNorm = 1.5658, lr_0 = 2.7267e-04
Validation rmse = 0.135595
Validation r2 = 0.840531
Validation mse = 0.018386
Epoch 33
Loss = 7.0511e-02, PNorm = 35.2589, GNorm = 0.9707, lr_0 = 2.6554e-04
Loss = 6.9479e-02, PNorm = 35.2668, GNorm = 1.4711, lr_0 = 2.5861e-04
Validation rmse = 0.135513
Validation r2 = 0.840723
Validation mse = 0.018364
Epoch 34
Loss = 6.3611e-02, PNorm = 35.2740, GNorm = 0.9973, lr_0 = 2.5119e-04
Validation rmse = 0.137159
Validation r2 = 0.836829
Validation mse = 0.018813
Epoch 35
Loss = 8.8172e-02, PNorm = 35.2804, GNorm = 1.8135, lr_0 = 2.4463e-04
Loss = 7.7486e-02, PNorm = 35.2865, GNorm = 3.5501, lr_0 = 2.3824e-04
Validation rmse = 0.136642
Validation r2 = 0.838057
Validation mse = 0.018671
Epoch 36
Loss = 6.9903e-02, PNorm = 35.2958, GNorm = 0.7054, lr_0 = 2.3140e-04
Validation rmse = 0.135984
Validation r2 = 0.839614
Validation mse = 0.018492
Epoch 37
Loss = 4.0630e-02, PNorm = 35.3022, GNorm = 1.0261, lr_0 = 2.2476e-04
Loss = 6.9682e-02, PNorm = 35.3092, GNorm = 2.7176, lr_0 = 2.1889e-04
Validation rmse = 0.139000
Validation r2 = 0.832420
Validation mse = 0.019321
Epoch 38
Loss = 7.3354e-02, PNorm = 35.3151, GNorm = 3.2700, lr_0 = 2.1317e-04
Loss = 7.6776e-02, PNorm = 35.3224, GNorm = 2.5305, lr_0 = 2.0761e-04
Loss = 5.2413e-02, PNorm = 35.3233, GNorm = 0.7666, lr_0 = 2.0706e-04
Validation rmse = 0.141297
Validation r2 = 0.826836
Validation mse = 0.019965
Epoch 39
Loss = 7.5308e-02, PNorm = 35.3290, GNorm = 1.6030, lr_0 = 2.0165e-04
Validation rmse = 0.136215
Validation r2 = 0.839067
Validation mse = 0.018555
Epoch 40
Loss = 6.1458e-02, PNorm = 35.3348, GNorm = 2.4521, lr_0 = 1.9638e-04
Loss = 6.7100e-02, PNorm = 35.3412, GNorm = 1.1256, lr_0 = 1.9125e-04
Validation rmse = 0.139180
Validation r2 = 0.831986
Validation mse = 0.019371
Epoch 41
Loss = 7.0953e-02, PNorm = 35.3473, GNorm = 1.0690, lr_0 = 1.8577e-04
Validation rmse = 0.135097
Validation r2 = 0.841700
Validation mse = 0.018251
Epoch 42
Loss = 8.2589e-02, PNorm = 35.3530, GNorm = 2.3599, lr_0 = 1.8044e-04
Loss = 6.9050e-02, PNorm = 35.3587, GNorm = 3.0210, lr_0 = 1.7572e-04
Validation rmse = 0.137275
Validation r2 = 0.836555
Validation mse = 0.018844
Epoch 43
Loss = 6.6762e-02, PNorm = 35.3625, GNorm = 0.7735, lr_0 = 1.7113e-04
Validation rmse = 0.135376
Validation r2 = 0.841045
Validation mse = 0.018327
Epoch 44
Loss = 7.5273e-02, PNorm = 35.3671, GNorm = 1.9261, lr_0 = 1.6622e-04
Loss = 6.0006e-02, PNorm = 35.3718, GNorm = 0.6627, lr_0 = 1.6188e-04
Validation rmse = 0.133777
Validation r2 = 0.844777
Validation mse = 0.017896
Epoch 45
Loss = 6.5245e-02, PNorm = 35.3761, GNorm = 0.4331, lr_0 = 1.5765e-04
Validation rmse = 0.133906
Validation r2 = 0.844478
Validation mse = 0.017931
Epoch 46
Loss = 6.7245e-02, PNorm = 35.3805, GNorm = 0.6994, lr_0 = 1.5313e-04
Loss = 6.9475e-02, PNorm = 35.3851, GNorm = 0.8796, lr_0 = 1.4913e-04
Validation rmse = 0.134364
Validation r2 = 0.843413
Validation mse = 0.018054
Epoch 47
Loss = 5.5720e-02, PNorm = 35.3900, GNorm = 0.9926, lr_0 = 1.4485e-04
Validation rmse = 0.133641
Validation r2 = 0.845093
Validation mse = 0.017860
Epoch 48
Loss = 8.2864e-02, PNorm = 35.3934, GNorm = 0.5398, lr_0 = 1.4107e-04
Loss = 5.6361e-02, PNorm = 35.3971, GNorm = 1.7925, lr_0 = 1.3738e-04
Validation rmse = 0.135119
Validation r2 = 0.841647
Validation mse = 0.018257
Epoch 49
Loss = 6.1349e-02, PNorm = 35.4023, GNorm = 0.8722, lr_0 = 1.3344e-04
Loss = 6.4235e-02, PNorm = 35.4066, GNorm = 1.4000, lr_0 = 1.2996e-04
Validation rmse = 0.134619
Validation r2 = 0.842817
Validation mse = 0.018122
Epoch 50
Loss = 6.3543e-02, PNorm = 35.4109, GNorm = 1.9404, lr_0 = 1.2656e-04
Validation rmse = 0.134893
Validation r2 = 0.842177
Validation mse = 0.018196
Epoch 51
Loss = 6.9046e-02, PNorm = 35.4147, GNorm = 0.9607, lr_0 = 1.2293e-04
Loss = 5.9395e-02, PNorm = 35.4183, GNorm = 1.4347, lr_0 = 1.1972e-04
Loss = 6.7352e-02, PNorm = 35.4186, GNorm = 1.9013, lr_0 = 1.1940e-04
Validation rmse = 0.137210
Validation r2 = 0.836709
Validation mse = 0.018827
Epoch 52
Loss = 5.4508e-02, PNorm = 35.4214, GNorm = 0.8476, lr_0 = 1.1628e-04
Validation rmse = 0.135558
Validation r2 = 0.840617
Validation mse = 0.018376
Epoch 53
Loss = 6.7221e-02, PNorm = 35.4247, GNorm = 0.9739, lr_0 = 1.1325e-04
Loss = 6.0604e-02, PNorm = 35.4277, GNorm = 1.2832, lr_0 = 1.1029e-04
Validation rmse = 0.134122
Validation r2 = 0.843977
Validation mse = 0.017989
Epoch 54
Loss = 5.5111e-02, PNorm = 35.4311, GNorm = 1.9454, lr_0 = 1.0712e-04
Validation rmse = 0.134517
Validation r2 = 0.843056
Validation mse = 0.018095
Epoch 55
Loss = 5.4289e-02, PNorm = 35.4338, GNorm = 0.5012, lr_0 = 1.0433e-04
Loss = 6.6908e-02, PNorm = 35.4370, GNorm = 0.9551, lr_0 = 1.0160e-04
Validation rmse = 0.137316
Validation r2 = 0.836456
Validation mse = 0.018856
Epoch 56
Loss = 5.9112e-02, PNorm = 35.4404, GNorm = 2.0537, lr_0 = 1.0000e-04
Validation rmse = 0.134090
Validation r2 = 0.844051
Validation mse = 0.017980
Epoch 57
Loss = 7.1591e-02, PNorm = 35.4436, GNorm = 1.2284, lr_0 = 1.0000e-04
Loss = 6.0929e-02, PNorm = 35.4465, GNorm = 0.8784, lr_0 = 1.0000e-04
Validation rmse = 0.134407
Validation r2 = 0.843313
Validation mse = 0.018065
Epoch 58
Loss = 6.0000e-02, PNorm = 35.4495, GNorm = 1.1614, lr_0 = 1.0000e-04
Validation rmse = 0.135220
Validation r2 = 0.841410
Validation mse = 0.018285
Epoch 59
Loss = 5.7975e-02, PNorm = 35.4528, GNorm = 1.2492, lr_0 = 1.0000e-04
Loss = 6.0940e-02, PNorm = 35.4552, GNorm = 0.5418, lr_0 = 1.0000e-04
Validation rmse = 0.133775
Validation r2 = 0.844783
Validation mse = 0.017896
Model 0 best validation rmse = 0.133641 on epoch 47
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.186198
Model 0 test r2 = 0.493620
Model 0 test mse = 0.034670
Ensemble test rmse = 0.186198
Ensemble test r2 = 0.493620
Ensemble test mse = 0.034670
Fold 8
Splitting data with seed 8
Total size = 963 | train size = 770 | val size = 193 | test size = 59
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.5711e-01, PNorm = 34.0158, GNorm = 3.4091, lr_0 = 4.3000e-04
Validation rmse = 0.302862
Validation r2 = 0.266579
Validation mse = 0.091725
Epoch 1
Loss = 7.9718e-01, PNorm = 34.0451, GNorm = 3.9081, lr_0 = 7.6000e-04
Loss = 6.9012e-01, PNorm = 34.0942, GNorm = 3.0505, lr_0 = 9.9472e-04
Loss = 1.6335e-01, PNorm = 34.1011, GNorm = 2.4483, lr_0 = 9.9209e-04
Validation rmse = 0.327568
Validation r2 = 0.142037
Validation mse = 0.107301
Epoch 2
Loss = 5.7755e-01, PNorm = 34.1585, GNorm = 6.2716, lr_0 = 9.6618e-04
Validation rmse = 0.251843
Validation r2 = 0.492863
Validation mse = 0.063425
Epoch 3
Loss = 3.7484e-01, PNorm = 34.2279, GNorm = 1.4607, lr_0 = 9.4094e-04
Loss = 3.4458e-01, PNorm = 34.2989, GNorm = 1.7531, lr_0 = 9.1637e-04
Validation rmse = 0.214735
Validation r2 = 0.631302
Validation mse = 0.046111
Epoch 4
Loss = 2.6733e-01, PNorm = 34.3739, GNorm = 1.8495, lr_0 = 8.9007e-04
Validation rmse = 0.216625
Validation r2 = 0.624782
Validation mse = 0.046927
Epoch 5
Loss = 2.5860e-01, PNorm = 34.4323, GNorm = 1.2993, lr_0 = 8.6682e-04
Loss = 2.8212e-01, PNorm = 34.4748, GNorm = 4.6539, lr_0 = 8.4418e-04
Validation rmse = 0.197178
Validation r2 = 0.689128
Validation mse = 0.038879
Epoch 6
Loss = 2.0709e-01, PNorm = 34.5271, GNorm = 3.0152, lr_0 = 8.1996e-04
Validation rmse = 0.179143
Validation r2 = 0.743396
Validation mse = 0.032092
Epoch 7
Loss = 1.7458e-01, PNorm = 34.5776, GNorm = 3.9639, lr_0 = 7.9643e-04
Loss = 1.8491e-01, PNorm = 34.6166, GNorm = 0.6039, lr_0 = 7.7563e-04
Validation rmse = 0.193442
Validation r2 = 0.700798
Validation mse = 0.037420
Epoch 8
Loss = 1.8991e-01, PNorm = 34.6586, GNorm = 2.9945, lr_0 = 7.5537e-04
Validation rmse = 0.164395
Validation r2 = 0.783907
Validation mse = 0.027026
Epoch 9
Loss = 1.2837e-01, PNorm = 34.6932, GNorm = 2.4172, lr_0 = 7.3370e-04
Loss = 1.4680e-01, PNorm = 34.7299, GNorm = 1.9873, lr_0 = 7.1453e-04
Validation rmse = 0.158619
Validation r2 = 0.798825
Validation mse = 0.025160
Epoch 10
Loss = 1.1744e-01, PNorm = 34.7586, GNorm = 0.7949, lr_0 = 6.9587e-04
Validation rmse = 0.161709
Validation r2 = 0.790911
Validation mse = 0.026150
Epoch 11
Loss = 1.1833e-01, PNorm = 34.7840, GNorm = 2.4538, lr_0 = 6.7590e-04
Loss = 1.3154e-01, PNorm = 34.8067, GNorm = 2.5304, lr_0 = 6.5825e-04
Validation rmse = 0.155220
Validation r2 = 0.807353
Validation mse = 0.024093
Epoch 12
Loss = 1.2536e-01, PNorm = 34.8290, GNorm = 1.9771, lr_0 = 6.3936e-04
Loss = 1.5229e-01, PNorm = 34.8544, GNorm = 5.8183, lr_0 = 6.2266e-04
Validation rmse = 0.154785
Validation r2 = 0.808433
Validation mse = 0.023958
Epoch 13
Loss = 1.2568e-01, PNorm = 34.8808, GNorm = 2.4445, lr_0 = 6.0640e-04
Validation rmse = 0.158496
Validation r2 = 0.799137
Validation mse = 0.025121
Epoch 14
Loss = 1.0428e-01, PNorm = 34.9034, GNorm = 2.0073, lr_0 = 5.8900e-04
Loss = 1.1090e-01, PNorm = 34.9202, GNorm = 0.7658, lr_0 = 5.7362e-04
Validation rmse = 0.161857
Validation r2 = 0.790527
Validation mse = 0.026198
Epoch 15
Loss = 1.1888e-01, PNorm = 34.9352, GNorm = 5.8139, lr_0 = 5.5863e-04
Validation rmse = 0.150734
Validation r2 = 0.818329
Validation mse = 0.022721
Epoch 16
Loss = 1.0454e-01, PNorm = 34.9544, GNorm = 1.9348, lr_0 = 5.4260e-04
Loss = 1.0925e-01, PNorm = 34.9705, GNorm = 3.9352, lr_0 = 5.2843e-04
Validation rmse = 0.160776
Validation r2 = 0.793315
Validation mse = 0.025849
Epoch 17
Loss = 1.0659e-01, PNorm = 34.9887, GNorm = 2.3738, lr_0 = 5.1327e-04
Validation rmse = 0.156279
Validation r2 = 0.804718
Validation mse = 0.024423
Epoch 18
Loss = 1.1834e-01, PNorm = 35.0024, GNorm = 5.1655, lr_0 = 4.9986e-04
Loss = 1.1166e-01, PNorm = 35.0194, GNorm = 0.6891, lr_0 = 4.8681e-04
Validation rmse = 0.159503
Validation r2 = 0.796577
Validation mse = 0.025441
Epoch 19
Loss = 1.0173e-01, PNorm = 35.0311, GNorm = 0.8736, lr_0 = 4.7284e-04
Validation rmse = 0.149662
Validation r2 = 0.820904
Validation mse = 0.022399
Epoch 20
Loss = 1.0154e-01, PNorm = 35.0454, GNorm = 1.9734, lr_0 = 4.6049e-04
Loss = 9.2744e-02, PNorm = 35.0593, GNorm = 1.5917, lr_0 = 4.4846e-04
Validation rmse = 0.150963
Validation r2 = 0.817776
Validation mse = 0.022790
Epoch 21
Loss = 9.5969e-02, PNorm = 35.0737, GNorm = 3.2902, lr_0 = 4.3559e-04
Validation rmse = 0.150712
Validation r2 = 0.818382
Validation mse = 0.022714
Epoch 22
Loss = 5.8160e-02, PNorm = 35.0862, GNorm = 1.2627, lr_0 = 4.2309e-04
Loss = 9.7666e-02, PNorm = 35.0970, GNorm = 3.9822, lr_0 = 4.1204e-04
Validation rmse = 0.159038
Validation r2 = 0.797761
Validation mse = 0.025293
Epoch 23
Loss = 1.0464e-01, PNorm = 35.1074, GNorm = 2.8005, lr_0 = 4.0128e-04
Validation rmse = 0.160735
Validation r2 = 0.793420
Validation mse = 0.025836
Epoch 24
Loss = 9.6399e-02, PNorm = 35.1216, GNorm = 3.3416, lr_0 = 3.8977e-04
Loss = 1.1986e-01, PNorm = 35.1306, GNorm = 3.8916, lr_0 = 3.7959e-04
Validation rmse = 0.154760
Validation r2 = 0.808494
Validation mse = 0.023951
Epoch 25
Loss = 9.4527e-02, PNorm = 35.1422, GNorm = 1.9097, lr_0 = 3.6967e-04
Loss = 9.6289e-02, PNorm = 35.1528, GNorm = 1.1665, lr_0 = 3.6002e-04
Loss = 1.0964e-01, PNorm = 35.1536, GNorm = 1.5038, lr_0 = 3.5906e-04
Validation rmse = 0.153943
Validation r2 = 0.810510
Validation mse = 0.023699
Epoch 26
Loss = 8.5768e-02, PNorm = 35.1625, GNorm = 1.4598, lr_0 = 3.4969e-04
Validation rmse = 0.151314
Validation r2 = 0.816929
Validation mse = 0.022896
Epoch 27
Loss = 7.0994e-02, PNorm = 35.1737, GNorm = 1.9174, lr_0 = 3.3965e-04
Loss = 8.7182e-02, PNorm = 35.1836, GNorm = 0.7199, lr_0 = 3.3078e-04
Validation rmse = 0.149703
Validation r2 = 0.820805
Validation mse = 0.022411
Epoch 28
Loss = 8.0110e-02, PNorm = 35.1919, GNorm = 1.3698, lr_0 = 3.2214e-04
Validation rmse = 0.150278
Validation r2 = 0.819427
Validation mse = 0.022583
Epoch 29
Loss = 7.7211e-02, PNorm = 35.2007, GNorm = 2.0350, lr_0 = 3.1290e-04
Loss = 8.9997e-02, PNorm = 35.2096, GNorm = 0.3772, lr_0 = 3.0472e-04
Validation rmse = 0.155241
Validation r2 = 0.807301
Validation mse = 0.024100
Epoch 30
Loss = 7.8936e-02, PNorm = 35.2177, GNorm = 0.7844, lr_0 = 2.9677e-04
Validation rmse = 0.151934
Validation r2 = 0.815425
Validation mse = 0.023084
Epoch 31
Loss = 9.5355e-02, PNorm = 35.2265, GNorm = 1.6455, lr_0 = 2.8825e-04
Loss = 7.7428e-02, PNorm = 35.2335, GNorm = 1.1160, lr_0 = 2.8072e-04
Validation rmse = 0.150847
Validation r2 = 0.818057
Validation mse = 0.022755
Epoch 32
Loss = 8.6029e-02, PNorm = 35.2427, GNorm = 1.3423, lr_0 = 2.7267e-04
Validation rmse = 0.150626
Validation r2 = 0.818590
Validation mse = 0.022688
Epoch 33
Loss = 9.2320e-02, PNorm = 35.2506, GNorm = 2.0641, lr_0 = 2.6554e-04
Loss = 7.1962e-02, PNorm = 35.2584, GNorm = 0.7142, lr_0 = 2.5861e-04
Validation rmse = 0.149238
Validation r2 = 0.821917
Validation mse = 0.022272
Epoch 34
Loss = 8.0411e-02, PNorm = 35.2660, GNorm = 0.4874, lr_0 = 2.5119e-04
Validation rmse = 0.153889
Validation r2 = 0.810645
Validation mse = 0.023682
Epoch 35
Loss = 8.5478e-02, PNorm = 35.2736, GNorm = 2.0325, lr_0 = 2.4463e-04
Loss = 8.6424e-02, PNorm = 35.2790, GNorm = 0.4569, lr_0 = 2.3824e-04
Validation rmse = 0.149365
Validation r2 = 0.821613
Validation mse = 0.022310
Epoch 36
Loss = 8.3944e-02, PNorm = 35.2876, GNorm = 0.5975, lr_0 = 2.3140e-04
Validation rmse = 0.150236
Validation r2 = 0.819527
Validation mse = 0.022571
Epoch 37
Loss = 9.8177e-02, PNorm = 35.2950, GNorm = 0.8723, lr_0 = 2.2476e-04
Loss = 6.7450e-02, PNorm = 35.3014, GNorm = 0.9824, lr_0 = 2.1889e-04
Validation rmse = 0.152559
Validation r2 = 0.813902
Validation mse = 0.023274
Epoch 38
Loss = 7.5894e-02, PNorm = 35.3077, GNorm = 0.7904, lr_0 = 2.1317e-04
Loss = 7.6173e-02, PNorm = 35.3143, GNorm = 1.4105, lr_0 = 2.0761e-04
Loss = 5.0709e-02, PNorm = 35.3150, GNorm = 0.8724, lr_0 = 2.0706e-04
Validation rmse = 0.148517
Validation r2 = 0.823634
Validation mse = 0.022057
Epoch 39
Loss = 7.2962e-02, PNorm = 35.3205, GNorm = 0.6191, lr_0 = 2.0165e-04
Validation rmse = 0.149184
Validation r2 = 0.822044
Validation mse = 0.022256
Epoch 40
Loss = 5.7545e-02, PNorm = 35.3261, GNorm = 0.5455, lr_0 = 1.9638e-04
Loss = 7.7364e-02, PNorm = 35.3330, GNorm = 1.3042, lr_0 = 1.9125e-04
Validation rmse = 0.151338
Validation r2 = 0.816870
Validation mse = 0.022903
Epoch 41
Loss = 7.0007e-02, PNorm = 35.3376, GNorm = 1.5851, lr_0 = 1.8577e-04
Validation rmse = 0.151491
Validation r2 = 0.816500
Validation mse = 0.022949
Epoch 42
Loss = 7.8063e-02, PNorm = 35.3438, GNorm = 2.1679, lr_0 = 1.8044e-04
Loss = 7.4378e-02, PNorm = 35.3476, GNorm = 1.8276, lr_0 = 1.7572e-04
Validation rmse = 0.147717
Validation r2 = 0.825527
Validation mse = 0.021820
Epoch 43
Loss = 7.7051e-02, PNorm = 35.3545, GNorm = 1.1416, lr_0 = 1.7113e-04
Validation rmse = 0.150143
Validation r2 = 0.819749
Validation mse = 0.022543
Epoch 44
Loss = 7.0489e-02, PNorm = 35.3611, GNorm = 1.1259, lr_0 = 1.6622e-04
Loss = 7.1897e-02, PNorm = 35.3654, GNorm = 1.2237, lr_0 = 1.6188e-04
Validation rmse = 0.152177
Validation r2 = 0.814834
Validation mse = 0.023158
Epoch 45
Loss = 6.2927e-02, PNorm = 35.3711, GNorm = 0.3885, lr_0 = 1.5765e-04
Validation rmse = 0.148396
Validation r2 = 0.823920
Validation mse = 0.022021
Epoch 46
Loss = 4.7400e-02, PNorm = 35.3758, GNorm = 0.9784, lr_0 = 1.5313e-04
Loss = 7.6003e-02, PNorm = 35.3794, GNorm = 1.5503, lr_0 = 1.4913e-04
Validation rmse = 0.148792
Validation r2 = 0.822979
Validation mse = 0.022139
Epoch 47
Loss = 7.6263e-02, PNorm = 35.3856, GNorm = 1.3640, lr_0 = 1.4485e-04
Validation rmse = 0.150633
Validation r2 = 0.818572
Validation mse = 0.022690
Epoch 48
Loss = 9.9582e-02, PNorm = 35.3899, GNorm = 0.8492, lr_0 = 1.4107e-04
Loss = 7.2204e-02, PNorm = 35.3934, GNorm = 0.4436, lr_0 = 1.3738e-04
Validation rmse = 0.150289
Validation r2 = 0.819399
Validation mse = 0.022587
Epoch 49
Loss = 7.3554e-02, PNorm = 35.3981, GNorm = 0.7346, lr_0 = 1.3344e-04
Loss = 6.4160e-02, PNorm = 35.4018, GNorm = 1.2662, lr_0 = 1.2996e-04
Validation rmse = 0.149643
Validation r2 = 0.820950
Validation mse = 0.022393
Epoch 50
Loss = 6.4175e-02, PNorm = 35.4070, GNorm = 0.3438, lr_0 = 1.2656e-04
Validation rmse = 0.149902
Validation r2 = 0.820328
Validation mse = 0.022471
Epoch 51
Loss = 7.1779e-02, PNorm = 35.4103, GNorm = 1.1683, lr_0 = 1.2293e-04
Loss = 6.9656e-02, PNorm = 35.4133, GNorm = 1.4931, lr_0 = 1.1972e-04
Loss = 4.2075e-02, PNorm = 35.4137, GNorm = 0.8979, lr_0 = 1.1940e-04
Validation rmse = 0.151826
Validation r2 = 0.815687
Validation mse = 0.023051
Epoch 52
Loss = 6.6459e-02, PNorm = 35.4183, GNorm = 0.8152, lr_0 = 1.1628e-04
Validation rmse = 0.147092
Validation r2 = 0.827002
Validation mse = 0.021636
Epoch 53
Loss = 7.6531e-02, PNorm = 35.4210, GNorm = 0.6633, lr_0 = 1.1325e-04
Loss = 6.2097e-02, PNorm = 35.4251, GNorm = 1.1604, lr_0 = 1.1029e-04
Validation rmse = 0.151604
Validation r2 = 0.816225
Validation mse = 0.022984
Epoch 54
Loss = 6.5093e-02, PNorm = 35.4291, GNorm = 0.6740, lr_0 = 1.0712e-04
Validation rmse = 0.148447
Validation r2 = 0.823800
Validation mse = 0.022036
Epoch 55
Loss = 5.5577e-02, PNorm = 35.4316, GNorm = 0.9020, lr_0 = 1.0433e-04
Loss = 6.9313e-02, PNorm = 35.4346, GNorm = 0.6398, lr_0 = 1.0160e-04
Validation rmse = 0.149165
Validation r2 = 0.822091
Validation mse = 0.022250
Epoch 56
Loss = 6.7161e-02, PNorm = 35.4389, GNorm = 1.0293, lr_0 = 1.0000e-04
Validation rmse = 0.147357
Validation r2 = 0.826377
Validation mse = 0.021714
Epoch 57
Loss = 6.8596e-02, PNorm = 35.4417, GNorm = 1.8617, lr_0 = 1.0000e-04
Loss = 6.0867e-02, PNorm = 35.4447, GNorm = 0.9266, lr_0 = 1.0000e-04
Validation rmse = 0.149034
Validation r2 = 0.822402
Validation mse = 0.022211
Epoch 58
Loss = 5.5579e-02, PNorm = 35.4475, GNorm = 0.7342, lr_0 = 1.0000e-04
Validation rmse = 0.152138
Validation r2 = 0.814929
Validation mse = 0.023146
Epoch 59
Loss = 6.7949e-02, PNorm = 35.4518, GNorm = 3.2397, lr_0 = 1.0000e-04
Loss = 6.9752e-02, PNorm = 35.4541, GNorm = 0.7649, lr_0 = 1.0000e-04
Validation rmse = 0.148301
Validation r2 = 0.824146
Validation mse = 0.021993
Model 0 best validation rmse = 0.147092 on epoch 52
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.213119
Model 0 test r2 = 0.336604
Model 0 test mse = 0.045420
Ensemble test rmse = 0.213119
Ensemble test r2 = 0.336604
Ensemble test mse = 0.045420
Fold 9
Splitting data with seed 9
Total size = 963 | train size = 770 | val size = 193 | test size = 59
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.2650e-01, PNorm = 34.0142, GNorm = 1.2536, lr_0 = 4.3000e-04
Validation rmse = 0.326363
Validation r2 = 0.195523
Validation mse = 0.106513
Epoch 1
Loss = 6.7756e-01, PNorm = 34.0427, GNorm = 3.1469, lr_0 = 7.6000e-04
Loss = 6.3519e-01, PNorm = 34.1054, GNorm = 8.5585, lr_0 = 9.9472e-04
Loss = 6.3869e-01, PNorm = 34.1122, GNorm = 5.0001, lr_0 = 9.9209e-04
Validation rmse = 0.260359
Validation r2 = 0.488013
Validation mse = 0.067787
Epoch 2
Loss = 5.1633e-01, PNorm = 34.1862, GNorm = 3.4565, lr_0 = 9.6618e-04
Validation rmse = 0.226297
Validation r2 = 0.613213
Validation mse = 0.051211
Epoch 3
Loss = 3.5400e-01, PNorm = 34.2606, GNorm = 2.0977, lr_0 = 9.4094e-04
Loss = 3.3282e-01, PNorm = 34.3217, GNorm = 2.1167, lr_0 = 9.1637e-04
Validation rmse = 0.201490
Validation r2 = 0.693368
Validation mse = 0.040598
Epoch 4
Loss = 2.9380e-01, PNorm = 34.3806, GNorm = 3.3793, lr_0 = 8.9007e-04
Validation rmse = 0.184593
Validation r2 = 0.742638
Validation mse = 0.034075
Epoch 5
Loss = 2.4432e-01, PNorm = 34.4410, GNorm = 3.9359, lr_0 = 8.6682e-04
Loss = 1.9918e-01, PNorm = 34.4969, GNorm = 2.3729, lr_0 = 8.4418e-04
Validation rmse = 0.171089
Validation r2 = 0.778917
Validation mse = 0.029271
Epoch 6
Loss = 1.5480e-01, PNorm = 34.5423, GNorm = 3.4383, lr_0 = 8.1996e-04
Validation rmse = 0.154611
Validation r2 = 0.819452
Validation mse = 0.023905
Epoch 7
Loss = 1.3187e-01, PNorm = 34.5920, GNorm = 3.2912, lr_0 = 7.9643e-04
Loss = 1.7275e-01, PNorm = 34.6310, GNorm = 6.1378, lr_0 = 7.7563e-04
Validation rmse = 0.182694
Validation r2 = 0.747907
Validation mse = 0.033377
Epoch 8
Loss = 1.6859e-01, PNorm = 34.6636, GNorm = 0.8119, lr_0 = 7.5537e-04
Validation rmse = 0.178027
Validation r2 = 0.760621
Validation mse = 0.031694
Epoch 9
Loss = 2.6339e-01, PNorm = 34.6958, GNorm = 5.7683, lr_0 = 7.3370e-04
Loss = 1.7310e-01, PNorm = 34.7275, GNorm = 4.2592, lr_0 = 7.1453e-04
Validation rmse = 0.152359
Validation r2 = 0.824674
Validation mse = 0.023213
Epoch 10
Loss = 1.4618e-01, PNorm = 34.7568, GNorm = 0.8944, lr_0 = 6.9587e-04
Validation rmse = 0.156483
Validation r2 = 0.815052
Validation mse = 0.024487
Epoch 11
Loss = 2.9621e-01, PNorm = 34.7846, GNorm = 4.6723, lr_0 = 6.7590e-04
Loss = 1.0397e-01, PNorm = 34.8034, GNorm = 0.6718, lr_0 = 6.5825e-04
Validation rmse = 0.139327
Validation r2 = 0.853384
Validation mse = 0.019412
Epoch 12
Loss = 1.3648e-01, PNorm = 34.8284, GNorm = 3.6250, lr_0 = 6.3936e-04
Loss = 1.6251e-01, PNorm = 34.8483, GNorm = 4.7051, lr_0 = 6.2266e-04
Validation rmse = 0.169123
Validation r2 = 0.783967
Validation mse = 0.028603
Epoch 13
Loss = 1.5865e-01, PNorm = 34.8707, GNorm = 2.1981, lr_0 = 6.0640e-04
Validation rmse = 0.135755
Validation r2 = 0.860805
Validation mse = 0.018429
Epoch 14
Loss = 1.1727e-01, PNorm = 34.8910, GNorm = 2.4237, lr_0 = 5.8900e-04
Loss = 1.1832e-01, PNorm = 34.9090, GNorm = 1.0665, lr_0 = 5.7362e-04
Validation rmse = 0.134303
Validation r2 = 0.863766
Validation mse = 0.018037
Epoch 15
Loss = 1.0853e-01, PNorm = 34.9258, GNorm = 0.9891, lr_0 = 5.5863e-04
Validation rmse = 0.140549
Validation r2 = 0.850800
Validation mse = 0.019754
Epoch 16
Loss = 1.0689e-01, PNorm = 34.9400, GNorm = 1.0128, lr_0 = 5.4260e-04
Loss = 1.0480e-01, PNorm = 34.9532, GNorm = 1.7841, lr_0 = 5.2843e-04
Validation rmse = 0.137944
Validation r2 = 0.856280
Validation mse = 0.019028
Epoch 17
Loss = 1.0671e-01, PNorm = 34.9679, GNorm = 2.2084, lr_0 = 5.1327e-04
Validation rmse = 0.140917
Validation r2 = 0.850018
Validation mse = 0.019858
Epoch 18
Loss = 1.0850e-01, PNorm = 34.9822, GNorm = 1.2086, lr_0 = 4.9986e-04
Loss = 9.3344e-02, PNorm = 34.9951, GNorm = 0.9059, lr_0 = 4.8681e-04
Validation rmse = 0.132070
Validation r2 = 0.868258
Validation mse = 0.017443
Epoch 19
Loss = 1.0259e-01, PNorm = 35.0130, GNorm = 3.3104, lr_0 = 4.7284e-04
Validation rmse = 0.131925
Validation r2 = 0.868549
Validation mse = 0.017404
Epoch 20
Loss = 9.6369e-02, PNorm = 35.0254, GNorm = 2.5328, lr_0 = 4.6049e-04
Loss = 1.0088e-01, PNorm = 35.0353, GNorm = 2.3914, lr_0 = 4.4846e-04
Validation rmse = 0.130459
Validation r2 = 0.871453
Validation mse = 0.017020
Epoch 21
Loss = 8.4016e-02, PNorm = 35.0499, GNorm = 0.6200, lr_0 = 4.3559e-04
Validation rmse = 0.130866
Validation r2 = 0.870650
Validation mse = 0.017126
Epoch 22
Loss = 9.1331e-02, PNorm = 35.0641, GNorm = 2.2578, lr_0 = 4.2309e-04
Loss = 9.6005e-02, PNorm = 35.0757, GNorm = 0.6414, lr_0 = 4.1204e-04
Validation rmse = 0.134337
Validation r2 = 0.863698
Validation mse = 0.018046
Epoch 23
Loss = 8.3925e-02, PNorm = 35.0899, GNorm = 1.5210, lr_0 = 4.0128e-04
Validation rmse = 0.134143
Validation r2 = 0.864091
Validation mse = 0.017994
Epoch 24
Loss = 7.9708e-02, PNorm = 35.1054, GNorm = 1.0753, lr_0 = 3.8977e-04
Loss = 9.9220e-02, PNorm = 35.1181, GNorm = 1.4328, lr_0 = 3.7959e-04
Validation rmse = 0.130064
Validation r2 = 0.872232
Validation mse = 0.016917
Epoch 25
Loss = 8.3894e-02, PNorm = 35.1280, GNorm = 0.6568, lr_0 = 3.6967e-04
Loss = 8.3480e-02, PNorm = 35.1392, GNorm = 1.0087, lr_0 = 3.6002e-04
Loss = 1.1232e-01, PNorm = 35.1402, GNorm = 2.0962, lr_0 = 3.5906e-04
Validation rmse = 0.132131
Validation r2 = 0.868137
Validation mse = 0.017459
Epoch 26
Loss = 9.8658e-02, PNorm = 35.1508, GNorm = 0.8051, lr_0 = 3.4969e-04
Validation rmse = 0.129058
Validation r2 = 0.874201
Validation mse = 0.016656
Epoch 27
Loss = 8.6176e-02, PNorm = 35.1640, GNorm = 2.8173, lr_0 = 3.3965e-04
Loss = 8.1000e-02, PNorm = 35.1759, GNorm = 0.6353, lr_0 = 3.3078e-04
Validation rmse = 0.131876
Validation r2 = 0.868646
Validation mse = 0.017391
Epoch 28
Loss = 9.7748e-02, PNorm = 35.1858, GNorm = 0.5968, lr_0 = 3.2214e-04
Validation rmse = 0.129160
Validation r2 = 0.874001
Validation mse = 0.016682
Epoch 29
Loss = 8.7537e-02, PNorm = 35.1967, GNorm = 1.6147, lr_0 = 3.1290e-04
Loss = 7.9419e-02, PNorm = 35.2074, GNorm = 1.1985, lr_0 = 3.0472e-04
Validation rmse = 0.127821
Validation r2 = 0.876599
Validation mse = 0.016338
Epoch 30
Loss = 8.0488e-02, PNorm = 35.2182, GNorm = 0.7199, lr_0 = 2.9677e-04
Validation rmse = 0.134035
Validation r2 = 0.864309
Validation mse = 0.017966
Epoch 31
Loss = 7.3608e-02, PNorm = 35.2281, GNorm = 0.8539, lr_0 = 2.8825e-04
Loss = 8.2542e-02, PNorm = 35.2365, GNorm = 1.6936, lr_0 = 2.8072e-04
Validation rmse = 0.126947
Validation r2 = 0.878282
Validation mse = 0.016115
Epoch 32
Loss = 8.0926e-02, PNorm = 35.2487, GNorm = 1.3689, lr_0 = 2.7267e-04
Validation rmse = 0.129232
Validation r2 = 0.873860
Validation mse = 0.016701
Epoch 33
Loss = 9.9089e-02, PNorm = 35.2569, GNorm = 1.4844, lr_0 = 2.6554e-04
Loss = 8.0857e-02, PNorm = 35.2658, GNorm = 0.7839, lr_0 = 2.5861e-04
Validation rmse = 0.127281
Validation r2 = 0.877641
Validation mse = 0.016200
Epoch 34
Loss = 7.7067e-02, PNorm = 35.2733, GNorm = 0.6426, lr_0 = 2.5119e-04
Validation rmse = 0.135676
Validation r2 = 0.860967
Validation mse = 0.018408
Epoch 35
Loss = 1.0573e-01, PNorm = 35.2802, GNorm = 1.3506, lr_0 = 2.4463e-04
Loss = 8.5573e-02, PNorm = 35.2893, GNorm = 2.8573, lr_0 = 2.3824e-04
Validation rmse = 0.127598
Validation r2 = 0.877030
Validation mse = 0.016281
Epoch 36
Loss = 8.9385e-02, PNorm = 35.2968, GNorm = 2.4863, lr_0 = 2.3140e-04
Validation rmse = 0.127545
Validation r2 = 0.877132
Validation mse = 0.016268
Epoch 37
Loss = 7.0161e-02, PNorm = 35.3048, GNorm = 0.4148, lr_0 = 2.2476e-04
Loss = 7.5408e-02, PNorm = 35.3123, GNorm = 0.4847, lr_0 = 2.1889e-04
Validation rmse = 0.137339
Validation r2 = 0.857538
Validation mse = 0.018862
Epoch 38
Loss = 8.3791e-02, PNorm = 35.3195, GNorm = 0.7279, lr_0 = 2.1317e-04
Loss = 8.8211e-02, PNorm = 35.3246, GNorm = 2.9776, lr_0 = 2.0761e-04
Loss = 1.4215e-01, PNorm = 35.3252, GNorm = 4.9162, lr_0 = 2.0706e-04
Validation rmse = 0.128625
Validation r2 = 0.875042
Validation mse = 0.016544
Epoch 39
Loss = 8.0488e-02, PNorm = 35.3341, GNorm = 1.0381, lr_0 = 2.0165e-04
Validation rmse = 0.129772
Validation r2 = 0.872804
Validation mse = 0.016841
Epoch 40
Loss = 6.0550e-02, PNorm = 35.3404, GNorm = 0.7803, lr_0 = 1.9638e-04
Loss = 7.5110e-02, PNorm = 35.3455, GNorm = 1.8711, lr_0 = 1.9125e-04
Validation rmse = 0.137959
Validation r2 = 0.856249
Validation mse = 0.019033
Epoch 41
Loss = 7.2541e-02, PNorm = 35.3525, GNorm = 0.7597, lr_0 = 1.8577e-04
Validation rmse = 0.125173
Validation r2 = 0.881660
Validation mse = 0.015668
Epoch 42
Loss = 7.1463e-02, PNorm = 35.3591, GNorm = 2.6372, lr_0 = 1.8044e-04
Loss = 7.5589e-02, PNorm = 35.3656, GNorm = 1.4510, lr_0 = 1.7572e-04
Validation rmse = 0.128605
Validation r2 = 0.875081
Validation mse = 0.016539
Epoch 43
Loss = 7.5009e-02, PNorm = 35.3709, GNorm = 0.6636, lr_0 = 1.7113e-04
Validation rmse = 0.125441
Validation r2 = 0.881153
Validation mse = 0.015735
Epoch 44
Loss = 6.1609e-02, PNorm = 35.3768, GNorm = 0.8181, lr_0 = 1.6622e-04
Loss = 7.2229e-02, PNorm = 35.3814, GNorm = 1.2677, lr_0 = 1.6188e-04
Validation rmse = 0.127435
Validation r2 = 0.877343
Validation mse = 0.016240
Epoch 45
Loss = 6.5473e-02, PNorm = 35.3868, GNorm = 0.3101, lr_0 = 1.5765e-04
Validation rmse = 0.129728
Validation r2 = 0.872890
Validation mse = 0.016829
Epoch 46
Loss = 9.1210e-02, PNorm = 35.3918, GNorm = 2.2372, lr_0 = 1.5313e-04
Loss = 6.4187e-02, PNorm = 35.3970, GNorm = 0.4009, lr_0 = 1.4913e-04
Validation rmse = 0.125880
Validation r2 = 0.880319
Validation mse = 0.015846
Epoch 47
Loss = 7.8612e-02, PNorm = 35.4019, GNorm = 3.2284, lr_0 = 1.4485e-04
Validation rmse = 0.129199
Validation r2 = 0.873925
Validation mse = 0.016692
Epoch 48
Loss = 8.2951e-02, PNorm = 35.4064, GNorm = 0.7677, lr_0 = 1.4107e-04
Loss = 7.4004e-02, PNorm = 35.4108, GNorm = 2.2253, lr_0 = 1.3738e-04
Validation rmse = 0.129929
Validation r2 = 0.872496
Validation mse = 0.016882
Epoch 49
Loss = 7.3424e-02, PNorm = 35.4163, GNorm = 1.4278, lr_0 = 1.3344e-04
Loss = 6.6678e-02, PNorm = 35.4198, GNorm = 1.8856, lr_0 = 1.2996e-04
Validation rmse = 0.127039
Validation r2 = 0.878104
Validation mse = 0.016139
Epoch 50
Loss = 7.3461e-02, PNorm = 35.4237, GNorm = 1.4004, lr_0 = 1.2656e-04
Validation rmse = 0.125817
Validation r2 = 0.880439
Validation mse = 0.015830
Epoch 51
Loss = 6.7560e-02, PNorm = 35.4277, GNorm = 1.7342, lr_0 = 1.2293e-04
Loss = 6.9176e-02, PNorm = 35.4314, GNorm = 3.1265, lr_0 = 1.1972e-04
Loss = 7.2196e-02, PNorm = 35.4318, GNorm = 2.0829, lr_0 = 1.1940e-04
Validation rmse = 0.127720
Validation r2 = 0.876794
Validation mse = 0.016312
Epoch 52
Loss = 7.2429e-02, PNorm = 35.4350, GNorm = 3.5027, lr_0 = 1.1628e-04
Validation rmse = 0.127322
Validation r2 = 0.877560
Validation mse = 0.016211
Epoch 53
Loss = 5.7831e-02, PNorm = 35.4383, GNorm = 0.7625, lr_0 = 1.1325e-04
Loss = 6.7726e-02, PNorm = 35.4419, GNorm = 0.8635, lr_0 = 1.1029e-04
Validation rmse = 0.127396
Validation r2 = 0.877419
Validation mse = 0.016230
Epoch 54
Loss = 6.6691e-02, PNorm = 35.4459, GNorm = 0.5903, lr_0 = 1.0712e-04
Validation rmse = 0.127149
Validation r2 = 0.877893
Validation mse = 0.016167
Epoch 55
Loss = 7.1592e-02, PNorm = 35.4484, GNorm = 0.9278, lr_0 = 1.0433e-04
Loss = 6.0570e-02, PNorm = 35.4519, GNorm = 0.6978, lr_0 = 1.0160e-04
Validation rmse = 0.131199
Validation r2 = 0.869992
Validation mse = 0.017213
Epoch 56
Loss = 6.9348e-02, PNorm = 35.4555, GNorm = 1.2839, lr_0 = 1.0000e-04
Validation rmse = 0.129850
Validation r2 = 0.872651
Validation mse = 0.016861
Epoch 57
Loss = 7.3296e-02, PNorm = 35.4590, GNorm = 1.8810, lr_0 = 1.0000e-04
Loss = 6.4298e-02, PNorm = 35.4624, GNorm = 1.6459, lr_0 = 1.0000e-04
Validation rmse = 0.128973
Validation r2 = 0.874364
Validation mse = 0.016634
Epoch 58
Loss = 6.2473e-02, PNorm = 35.4651, GNorm = 1.1084, lr_0 = 1.0000e-04
Validation rmse = 0.127312
Validation r2 = 0.877580
Validation mse = 0.016208
Epoch 59
Loss = 7.6348e-02, PNorm = 35.4689, GNorm = 1.2139, lr_0 = 1.0000e-04
Loss = 6.8692e-02, PNorm = 35.4719, GNorm = 1.1300, lr_0 = 1.0000e-04
Validation rmse = 0.126696
Validation r2 = 0.878761
Validation mse = 0.016052
Model 0 best validation rmse = 0.125173 on epoch 41
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.192651
Model 0 test r2 = 0.457913
Model 0 test mse = 0.037114
Ensemble test rmse = 0.192651
Ensemble test r2 = 0.457913
Ensemble test mse = 0.037114
10-fold cross validation
	Seed 0 ==> test rmse = 0.213981
	Seed 0 ==> test r2 = 0.331227
	Seed 0 ==> test mse = 0.045788
	Seed 1 ==> test rmse = 0.179838
	Seed 1 ==> test r2 = 0.527618
	Seed 1 ==> test mse = 0.032342
	Seed 2 ==> test rmse = 0.185524
	Seed 2 ==> test r2 = 0.497279
	Seed 2 ==> test mse = 0.034419
	Seed 3 ==> test rmse = 0.175750
	Seed 3 ==> test r2 = 0.548852
	Seed 3 ==> test mse = 0.030888
	Seed 4 ==> test rmse = 0.173429
	Seed 4 ==> test r2 = 0.560688
	Seed 4 ==> test mse = 0.030078
	Seed 5 ==> test rmse = 0.260626
	Seed 5 ==> test r2 = 0.007881
	Seed 5 ==> test mse = 0.067926
	Seed 6 ==> test rmse = 0.182901
	Seed 6 ==> test r2 = 0.511390
	Seed 6 ==> test mse = 0.033453
	Seed 7 ==> test rmse = 0.186198
	Seed 7 ==> test r2 = 0.493620
	Seed 7 ==> test mse = 0.034670
	Seed 8 ==> test rmse = 0.213119
	Seed 8 ==> test r2 = 0.336604
	Seed 8 ==> test mse = 0.045420
	Seed 9 ==> test rmse = 0.192651
	Seed 9 ==> test r2 = 0.457913
	Seed 9 ==> test mse = 0.037114
Overall test rmse = 0.196402 +/- 0.025220
Overall test r2 = 0.427307 +/- 0.159155
Overall test mse = 0.039210 +/- 0.010897
Elapsed time = 0:06:46
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-1d5c3576-9790-4896-9034-9bb28ba18d8e.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/DMF_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2', 'mse'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2', 'mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/generalization_3/DMF_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/DMF_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 919 | train size = 735 | val size = 184 | test size = 103
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1631e-01, PNorm = 34.0155, GNorm = 1.7111, lr_0 = 4.5357e-04
Validation rmse = 0.301232
Validation r2 = 0.232632
Validation mse = 0.090741
Epoch 1
Loss = 6.9728e-01, PNorm = 34.0543, GNorm = 5.7459, lr_0 = 8.0714e-04
Validation rmse = 0.317442
Validation r2 = 0.147823
Validation mse = 0.100769
Epoch 2
Loss = 5.7241e-01, PNorm = 34.1119, GNorm = 7.8964, lr_0 = 9.8872e-04
Loss = 5.4367e-01, PNorm = 34.1913, GNorm = 5.0310, lr_0 = 9.6108e-04
Validation rmse = 0.225699
Validation r2 = 0.569213
Validation mse = 0.050940
Epoch 3
Loss = 4.8229e-01, PNorm = 34.2517, GNorm = 6.3308, lr_0 = 9.3421e-04
Validation rmse = 0.255972
Validation r2 = 0.445901
Validation mse = 0.065522
Epoch 4
Loss = 4.0994e-01, PNorm = 34.3232, GNorm = 1.5237, lr_0 = 9.0552e-04
Loss = 3.6585e-01, PNorm = 34.3856, GNorm = 5.6032, lr_0 = 8.8020e-04
Validation rmse = 0.211914
Validation r2 = 0.620229
Validation mse = 0.044908
Epoch 5
Loss = 3.0760e-01, PNorm = 34.4392, GNorm = 1.5034, lr_0 = 8.5559e-04
Validation rmse = 0.191679
Validation r2 = 0.689294
Validation mse = 0.036741
Epoch 6
Loss = 3.4138e-01, PNorm = 34.4877, GNorm = 5.3447, lr_0 = 8.3167e-04
Loss = 2.0696e-01, PNorm = 34.5354, GNorm = 2.7006, lr_0 = 8.0842e-04
Validation rmse = 0.165828
Validation r2 = 0.767450
Validation mse = 0.027499
Epoch 7
Loss = 2.1873e-01, PNorm = 34.5819, GNorm = 3.5985, lr_0 = 7.8359e-04
Validation rmse = 0.148928
Validation r2 = 0.812432
Validation mse = 0.022180
Epoch 8
Loss = 2.2672e-01, PNorm = 34.6243, GNorm = 1.8172, lr_0 = 7.6168e-04
Loss = 1.5276e-01, PNorm = 34.6668, GNorm = 1.2502, lr_0 = 7.4039e-04
Validation rmse = 0.133032
Validation r2 = 0.850337
Validation mse = 0.017697
Epoch 9
Loss = 1.6617e-01, PNorm = 34.7029, GNorm = 1.8568, lr_0 = 7.1969e-04
Validation rmse = 0.144500
Validation r2 = 0.823422
Validation mse = 0.020880
Epoch 10
Loss = 1.9542e-01, PNorm = 34.7373, GNorm = 2.6387, lr_0 = 6.9956e-04
Loss = 1.5957e-01, PNorm = 34.7671, GNorm = 1.6307, lr_0 = 6.8001e-04
Validation rmse = 0.131732
Validation r2 = 0.853248
Validation mse = 0.017353
Epoch 11
Loss = 1.4836e-01, PNorm = 34.7949, GNorm = 3.9841, lr_0 = 6.5912e-04
Validation rmse = 0.139061
Validation r2 = 0.836465
Validation mse = 0.019338
Epoch 12
Loss = 1.2351e-01, PNorm = 34.8217, GNorm = 2.1061, lr_0 = 6.4069e-04
Loss = 1.4304e-01, PNorm = 34.8467, GNorm = 3.3915, lr_0 = 6.2278e-04
Validation rmse = 0.120907
Validation r2 = 0.876375
Validation mse = 0.014619
Epoch 13
Loss = 1.3320e-01, PNorm = 34.8673, GNorm = 1.5559, lr_0 = 6.0537e-04
Validation rmse = 0.118341
Validation r2 = 0.881566
Validation mse = 0.014005
Epoch 14
Loss = 1.1977e-01, PNorm = 34.8868, GNorm = 2.1164, lr_0 = 5.8678e-04
Loss = 1.2539e-01, PNorm = 34.9059, GNorm = 1.2437, lr_0 = 5.7037e-04
Validation rmse = 0.122888
Validation r2 = 0.872291
Validation mse = 0.015102
Epoch 15
Loss = 1.3227e-01, PNorm = 34.9269, GNorm = 3.1844, lr_0 = 5.5442e-04
Validation rmse = 0.128754
Validation r2 = 0.859808
Validation mse = 0.016578
Epoch 16
Loss = 1.4509e-01, PNorm = 34.9441, GNorm = 3.2742, lr_0 = 5.3892e-04
Validation rmse = 0.131367
Validation r2 = 0.854060
Validation mse = 0.017257
Epoch 17
Loss = 1.5106e-01, PNorm = 34.9665, GNorm = 3.4723, lr_0 = 5.2237e-04
Loss = 1.2914e-01, PNorm = 34.9836, GNorm = 0.9162, lr_0 = 5.0777e-04
Validation rmse = 0.122589
Validation r2 = 0.872912
Validation mse = 0.015028
Epoch 18
Loss = 1.3029e-01, PNorm = 34.9966, GNorm = 3.3493, lr_0 = 4.9357e-04
Validation rmse = 0.112273
Validation r2 = 0.893402
Validation mse = 0.012605
Epoch 19
Loss = 7.9472e-02, PNorm = 35.0154, GNorm = 1.0346, lr_0 = 4.7977e-04
Loss = 1.1693e-01, PNorm = 35.0302, GNorm = 0.7225, lr_0 = 4.6636e-04
Validation rmse = 0.118340
Validation r2 = 0.881570
Validation mse = 0.014004
Epoch 20
Loss = 1.1108e-01, PNorm = 35.0430, GNorm = 1.0079, lr_0 = 4.5332e-04
Validation rmse = 0.120439
Validation r2 = 0.877330
Validation mse = 0.014506
Epoch 21
Loss = 1.2506e-01, PNorm = 35.0566, GNorm = 4.7972, lr_0 = 4.3940e-04
Loss = 1.1109e-01, PNorm = 35.0722, GNorm = 1.0886, lr_0 = 4.2711e-04
Validation rmse = 0.112705
Validation r2 = 0.892579
Validation mse = 0.012702
Epoch 22
Loss = 1.0502e-01, PNorm = 35.0827, GNorm = 1.6713, lr_0 = 4.1517e-04
Validation rmse = 0.113946
Validation r2 = 0.890200
Validation mse = 0.012984
Epoch 23
Loss = 1.3973e-01, PNorm = 35.0951, GNorm = 1.3335, lr_0 = 4.0356e-04
Loss = 9.8533e-02, PNorm = 35.1102, GNorm = 1.9194, lr_0 = 3.9228e-04
Validation rmse = 0.110765
Validation r2 = 0.896246
Validation mse = 0.012269
Epoch 24
Loss = 1.1219e-01, PNorm = 35.1231, GNorm = 0.6680, lr_0 = 3.8023e-04
Validation rmse = 0.111166
Validation r2 = 0.895494
Validation mse = 0.012358
Epoch 25
Loss = 1.0927e-01, PNorm = 35.1302, GNorm = 0.7665, lr_0 = 3.6960e-04
Loss = 9.9469e-02, PNorm = 35.1402, GNorm = 0.9364, lr_0 = 3.5927e-04
Validation rmse = 0.113670
Validation r2 = 0.890732
Validation mse = 0.012921
Epoch 26
Loss = 9.4684e-02, PNorm = 35.1506, GNorm = 1.3205, lr_0 = 3.4922e-04
Validation rmse = 0.113896
Validation r2 = 0.890297
Validation mse = 0.012972
Epoch 27
Loss = 1.0043e-01, PNorm = 35.1627, GNorm = 0.6933, lr_0 = 3.3850e-04
Loss = 1.0258e-01, PNorm = 35.1743, GNorm = 2.8113, lr_0 = 3.2903e-04
Validation rmse = 0.118408
Validation r2 = 0.881433
Validation mse = 0.014020
Epoch 28
Loss = 8.8881e-02, PNorm = 35.1822, GNorm = 0.4698, lr_0 = 3.1984e-04
Validation rmse = 0.118370
Validation r2 = 0.881508
Validation mse = 0.014012
Epoch 29
Loss = 1.0260e-01, PNorm = 35.1911, GNorm = 0.6499, lr_0 = 3.1089e-04
Loss = 8.9469e-02, PNorm = 35.2006, GNorm = 2.4098, lr_0 = 3.0220e-04
Validation rmse = 0.112752
Validation r2 = 0.892489
Validation mse = 0.012713
Epoch 30
Loss = 8.3528e-02, PNorm = 35.2120, GNorm = 0.8784, lr_0 = 2.9375e-04
Validation rmse = 0.110674
Validation r2 = 0.896417
Validation mse = 0.012249
Epoch 31
Loss = 1.0213e-01, PNorm = 35.2202, GNorm = 0.6511, lr_0 = 2.8473e-04
Loss = 8.4460e-02, PNorm = 35.2286, GNorm = 1.5954, lr_0 = 2.7677e-04
Validation rmse = 0.110210
Validation r2 = 0.897282
Validation mse = 0.012146
Epoch 32
Loss = 8.4916e-02, PNorm = 35.2358, GNorm = 1.2370, lr_0 = 2.6903e-04
Validation rmse = 0.111113
Validation r2 = 0.895593
Validation mse = 0.012346
Epoch 33
Loss = 7.8808e-02, PNorm = 35.2430, GNorm = 0.3680, lr_0 = 2.6151e-04
Validation rmse = 0.112388
Validation r2 = 0.893183
Validation mse = 0.012631
Epoch 34
Loss = 5.2010e-02, PNorm = 35.2533, GNorm = 1.6572, lr_0 = 2.5348e-04
Loss = 9.7461e-02, PNorm = 35.2610, GNorm = 0.5901, lr_0 = 2.4639e-04
Validation rmse = 0.110160
Validation r2 = 0.897376
Validation mse = 0.012135
Epoch 35
Loss = 8.1919e-02, PNorm = 35.2675, GNorm = 0.7021, lr_0 = 2.3950e-04
Validation rmse = 0.110869
Validation r2 = 0.896051
Validation mse = 0.012292
Epoch 36
Loss = 4.1702e-02, PNorm = 35.2738, GNorm = 0.3316, lr_0 = 2.3281e-04
Loss = 8.6784e-02, PNorm = 35.2794, GNorm = 0.7575, lr_0 = 2.2630e-04
Validation rmse = 0.110991
Validation r2 = 0.895821
Validation mse = 0.012319
Epoch 37
Loss = 8.9320e-02, PNorm = 35.2877, GNorm = 1.2547, lr_0 = 2.1935e-04
Validation rmse = 0.108976
Validation r2 = 0.899570
Validation mse = 0.011876
Epoch 38
Loss = 8.5362e-02, PNorm = 35.2942, GNorm = 1.3611, lr_0 = 2.1321e-04
Loss = 9.1393e-02, PNorm = 35.3005, GNorm = 0.5081, lr_0 = 2.0725e-04
Validation rmse = 0.110318
Validation r2 = 0.897082
Validation mse = 0.012170
Epoch 39
Loss = 7.6038e-02, PNorm = 35.3054, GNorm = 0.8747, lr_0 = 2.0146e-04
Validation rmse = 0.110866
Validation r2 = 0.896055
Validation mse = 0.012291
Epoch 40
Loss = 6.0979e-02, PNorm = 35.3126, GNorm = 0.6767, lr_0 = 1.9583e-04
Loss = 8.4701e-02, PNorm = 35.3200, GNorm = 0.7621, lr_0 = 1.9035e-04
Validation rmse = 0.108613
Validation r2 = 0.900238
Validation mse = 0.011797
Epoch 41
Loss = 7.4624e-02, PNorm = 35.3263, GNorm = 0.6235, lr_0 = 1.8451e-04
Validation rmse = 0.109646
Validation r2 = 0.898332
Validation mse = 0.012022
Epoch 42
Loss = 6.3731e-02, PNorm = 35.3319, GNorm = 1.8597, lr_0 = 1.7935e-04
Loss = 9.1334e-02, PNorm = 35.3374, GNorm = 0.4863, lr_0 = 1.7433e-04
Validation rmse = 0.111603
Validation r2 = 0.894669
Validation mse = 0.012455
Epoch 43
Loss = 8.2600e-02, PNorm = 35.3424, GNorm = 1.2607, lr_0 = 1.6946e-04
Validation rmse = 0.110757
Validation r2 = 0.896261
Validation mse = 0.012267
Epoch 44
Loss = 7.8153e-02, PNorm = 35.3485, GNorm = 0.6070, lr_0 = 1.6425e-04
Loss = 8.0970e-02, PNorm = 35.3525, GNorm = 1.3464, lr_0 = 1.5966e-04
Validation rmse = 0.114212
Validation r2 = 0.889687
Validation mse = 0.013044
Epoch 45
Loss = 8.3417e-02, PNorm = 35.3581, GNorm = 0.5117, lr_0 = 1.5520e-04
Validation rmse = 0.109913
Validation r2 = 0.897835
Validation mse = 0.012081
Epoch 46
Loss = 7.7308e-02, PNorm = 35.3628, GNorm = 0.5959, lr_0 = 1.5086e-04
Loss = 7.9196e-02, PNorm = 35.3670, GNorm = 1.8295, lr_0 = 1.4664e-04
Loss = 6.2400e-02, PNorm = 35.3676, GNorm = 0.7833, lr_0 = 1.4623e-04
Validation rmse = 0.109645
Validation r2 = 0.898333
Validation mse = 0.012022
Epoch 47
Loss = 8.9965e-02, PNorm = 35.3730, GNorm = 3.2192, lr_0 = 1.4214e-04
Validation rmse = 0.110071
Validation r2 = 0.897541
Validation mse = 0.012116
Epoch 48
Loss = 6.9794e-02, PNorm = 35.3772, GNorm = 2.5478, lr_0 = 1.3816e-04
Loss = 8.7331e-02, PNorm = 35.3823, GNorm = 3.2353, lr_0 = 1.3430e-04
Validation rmse = 0.113351
Validation r2 = 0.891345
Validation mse = 0.012848
Epoch 49
Loss = 7.8210e-02, PNorm = 35.3873, GNorm = 0.7657, lr_0 = 1.3055e-04
Validation rmse = 0.108409
Validation r2 = 0.900612
Validation mse = 0.011753
Epoch 50
Loss = 8.1872e-02, PNorm = 35.3924, GNorm = 2.5439, lr_0 = 1.2690e-04
Validation rmse = 0.109466
Validation r2 = 0.898664
Validation mse = 0.011983
Epoch 51
Loss = 1.3500e-01, PNorm = 35.3974, GNorm = 1.9454, lr_0 = 1.2300e-04
Loss = 7.5058e-02, PNorm = 35.4015, GNorm = 0.8933, lr_0 = 1.1956e-04
Validation rmse = 0.110326
Validation r2 = 0.897067
Validation mse = 0.012172
Epoch 52
Loss = 6.8291e-02, PNorm = 35.4044, GNorm = 2.1028, lr_0 = 1.1622e-04
Validation rmse = 0.118772
Validation r2 = 0.880703
Validation mse = 0.014107
Epoch 53
Loss = 8.9631e-02, PNorm = 35.4067, GNorm = 3.0722, lr_0 = 1.1297e-04
Loss = 8.1996e-02, PNorm = 35.4105, GNorm = 0.7182, lr_0 = 1.0981e-04
Validation rmse = 0.111849
Validation r2 = 0.894204
Validation mse = 0.012510
Epoch 54
Loss = 7.6301e-02, PNorm = 35.4144, GNorm = 1.7421, lr_0 = 1.0644e-04
Validation rmse = 0.110512
Validation r2 = 0.896718
Validation mse = 0.012213
Epoch 55
Loss = 7.5593e-02, PNorm = 35.4180, GNorm = 0.6083, lr_0 = 1.0346e-04
Loss = 7.9811e-02, PNorm = 35.4209, GNorm = 1.4064, lr_0 = 1.0057e-04
Validation rmse = 0.108918
Validation r2 = 0.899677
Validation mse = 0.011863
Epoch 56
Loss = 7.7891e-02, PNorm = 35.4237, GNorm = 1.2653, lr_0 = 1.0000e-04
Validation rmse = 0.110576
Validation r2 = 0.896600
Validation mse = 0.012227
Epoch 57
Loss = 7.3039e-02, PNorm = 35.4272, GNorm = 1.1687, lr_0 = 1.0000e-04
Loss = 6.7075e-02, PNorm = 35.4305, GNorm = 1.1172, lr_0 = 1.0000e-04
Validation rmse = 0.108767
Validation r2 = 0.899954
Validation mse = 0.011830
Epoch 58
Loss = 6.9945e-02, PNorm = 35.4334, GNorm = 0.7152, lr_0 = 1.0000e-04
Validation rmse = 0.109935
Validation r2 = 0.897794
Validation mse = 0.012086
Epoch 59
Loss = 6.4138e-02, PNorm = 35.4369, GNorm = 0.6317, lr_0 = 1.0000e-04
Loss = 7.8238e-02, PNorm = 35.4397, GNorm = 0.5343, lr_0 = 1.0000e-04
Validation rmse = 0.108932
Validation r2 = 0.899652
Validation mse = 0.011866
Model 0 best validation rmse = 0.108409 on epoch 49
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.182008
Model 0 test r2 = 0.450020
Model 0 test mse = 0.033127
Ensemble test rmse = 0.182008
Ensemble test r2 = 0.450020
Ensemble test mse = 0.033127
Fold 1
Splitting data with seed 1
Total size = 919 | train size = 735 | val size = 184 | test size = 103
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.9469e-01, PNorm = 34.0183, GNorm = 6.7161, lr_0 = 4.5357e-04
Validation rmse = 0.295740
Validation r2 = 0.263892
Validation mse = 0.087462
Epoch 1
Loss = 6.7455e-01, PNorm = 34.0517, GNorm = 3.2472, lr_0 = 8.0714e-04
Validation rmse = 0.288322
Validation r2 = 0.300356
Validation mse = 0.083130
Epoch 2
Loss = 4.4462e-01, PNorm = 34.1193, GNorm = 4.4923, lr_0 = 9.8872e-04
Loss = 7.0354e-01, PNorm = 34.1850, GNorm = 2.3644, lr_0 = 9.6108e-04
Validation rmse = 0.240174
Validation r2 = 0.514517
Validation mse = 0.057684
Epoch 3
Loss = 4.1241e-01, PNorm = 34.2593, GNorm = 2.3588, lr_0 = 9.3421e-04
Validation rmse = 0.213572
Validation r2 = 0.616107
Validation mse = 0.045613
Epoch 4
Loss = 4.5624e-01, PNorm = 34.3348, GNorm = 1.1740, lr_0 = 9.0552e-04
Loss = 3.0356e-01, PNorm = 34.4025, GNorm = 0.9630, lr_0 = 8.8020e-04
Validation rmse = 0.195410
Validation r2 = 0.678624
Validation mse = 0.038185
Epoch 5
Loss = 2.8401e-01, PNorm = 34.4572, GNorm = 5.7499, lr_0 = 8.5559e-04
Validation rmse = 0.184967
Validation r2 = 0.712055
Validation mse = 0.034213
Epoch 6
Loss = 2.6643e-01, PNorm = 34.5086, GNorm = 5.6713, lr_0 = 8.3167e-04
Loss = 2.2351e-01, PNorm = 34.5529, GNorm = 3.2162, lr_0 = 8.0842e-04
Validation rmse = 0.163567
Validation r2 = 0.774829
Validation mse = 0.026754
Epoch 7
Loss = 2.1271e-01, PNorm = 34.6062, GNorm = 5.2869, lr_0 = 7.8359e-04
Validation rmse = 0.154926
Validation r2 = 0.797990
Validation mse = 0.024002
Epoch 8
Loss = 2.0122e-01, PNorm = 34.6383, GNorm = 6.2525, lr_0 = 7.6168e-04
Loss = 1.4760e-01, PNorm = 34.6726, GNorm = 3.4778, lr_0 = 7.4039e-04
Validation rmse = 0.157356
Validation r2 = 0.791605
Validation mse = 0.024761
Epoch 9
Loss = 1.5162e-01, PNorm = 34.7109, GNorm = 1.3678, lr_0 = 7.1969e-04
Validation rmse = 0.160093
Validation r2 = 0.784293
Validation mse = 0.025630
Epoch 10
Loss = 1.2554e-01, PNorm = 34.7394, GNorm = 5.5239, lr_0 = 6.9956e-04
Loss = 1.4775e-01, PNorm = 34.7673, GNorm = 1.9376, lr_0 = 6.8001e-04
Validation rmse = 0.142228
Validation r2 = 0.829749
Validation mse = 0.020229
Epoch 11
Loss = 1.2101e-01, PNorm = 34.7941, GNorm = 2.2433, lr_0 = 6.5912e-04
Validation rmse = 0.148353
Validation r2 = 0.814769
Validation mse = 0.022009
Epoch 12
Loss = 1.2261e-01, PNorm = 34.8192, GNorm = 2.8241, lr_0 = 6.4069e-04
Loss = 1.1806e-01, PNorm = 34.8382, GNorm = 1.3376, lr_0 = 6.2278e-04
Validation rmse = 0.138277
Validation r2 = 0.839077
Validation mse = 0.019120
Epoch 13
Loss = 1.1231e-01, PNorm = 34.8607, GNorm = 1.3316, lr_0 = 6.0537e-04
Validation rmse = 0.180739
Validation r2 = 0.725067
Validation mse = 0.032667
Epoch 14
Loss = 1.3921e-01, PNorm = 34.8794, GNorm = 3.4829, lr_0 = 5.8678e-04
Loss = 1.3143e-01, PNorm = 34.9029, GNorm = 1.2076, lr_0 = 5.7037e-04
Validation rmse = 0.144137
Validation r2 = 0.825147
Validation mse = 0.020775
Epoch 15
Loss = 1.0732e-01, PNorm = 34.9235, GNorm = 1.8666, lr_0 = 5.5442e-04
Validation rmse = 0.186243
Validation r2 = 0.708068
Validation mse = 0.034687
Epoch 16
Loss = 1.7350e-01, PNorm = 34.9397, GNorm = 8.4693, lr_0 = 5.3892e-04
Validation rmse = 0.144162
Validation r2 = 0.825087
Validation mse = 0.020783
Epoch 17
Loss = 6.1522e-02, PNorm = 34.9584, GNorm = 1.1359, lr_0 = 5.2237e-04
Loss = 1.1412e-01, PNorm = 34.9779, GNorm = 1.3902, lr_0 = 5.0777e-04
Validation rmse = 0.135391
Validation r2 = 0.845722
Validation mse = 0.018331
Epoch 18
Loss = 1.0555e-01, PNorm = 34.9934, GNorm = 2.2112, lr_0 = 4.9357e-04
Validation rmse = 0.143130
Validation r2 = 0.827583
Validation mse = 0.020486
Epoch 19
Loss = 9.0767e-02, PNorm = 35.0085, GNorm = 2.1393, lr_0 = 4.7977e-04
Loss = 1.0342e-01, PNorm = 35.0220, GNorm = 1.2421, lr_0 = 4.6636e-04
Validation rmse = 0.139227
Validation r2 = 0.836857
Validation mse = 0.019384
Epoch 20
Loss = 1.1405e-01, PNorm = 35.0350, GNorm = 2.7865, lr_0 = 4.5332e-04
Validation rmse = 0.135340
Validation r2 = 0.845839
Validation mse = 0.018317
Epoch 21
Loss = 6.8254e-02, PNorm = 35.0487, GNorm = 1.1948, lr_0 = 4.3940e-04
Loss = 1.0310e-01, PNorm = 35.0625, GNorm = 1.7597, lr_0 = 4.2711e-04
Validation rmse = 0.136863
Validation r2 = 0.842351
Validation mse = 0.018731
Epoch 22
Loss = 9.0368e-02, PNorm = 35.0727, GNorm = 2.6707, lr_0 = 4.1517e-04
Validation rmse = 0.145289
Validation r2 = 0.822340
Validation mse = 0.021109
Epoch 23
Loss = 9.4892e-02, PNorm = 35.0832, GNorm = 1.3276, lr_0 = 4.0356e-04
Loss = 9.6015e-02, PNorm = 35.0986, GNorm = 0.7658, lr_0 = 3.9228e-04
Validation rmse = 0.137372
Validation r2 = 0.841174
Validation mse = 0.018871
Epoch 24
Loss = 9.5057e-02, PNorm = 35.1085, GNorm = 0.8359, lr_0 = 3.8023e-04
Validation rmse = 0.135609
Validation r2 = 0.845227
Validation mse = 0.018390
Epoch 25
Loss = 8.7776e-02, PNorm = 35.1169, GNorm = 2.3250, lr_0 = 3.6960e-04
Loss = 8.7174e-02, PNorm = 35.1243, GNorm = 0.6854, lr_0 = 3.5927e-04
Validation rmse = 0.131837
Validation r2 = 0.853717
Validation mse = 0.017381
Epoch 26
Loss = 7.8268e-02, PNorm = 35.1365, GNorm = 0.8211, lr_0 = 3.4922e-04
Validation rmse = 0.136506
Validation r2 = 0.843171
Validation mse = 0.018634
Epoch 27
Loss = 7.4102e-02, PNorm = 35.1482, GNorm = 1.3355, lr_0 = 3.3850e-04
Loss = 9.1057e-02, PNorm = 35.1571, GNorm = 0.9447, lr_0 = 3.2903e-04
Validation rmse = 0.133241
Validation r2 = 0.850584
Validation mse = 0.017753
Epoch 28
Loss = 8.7888e-02, PNorm = 35.1644, GNorm = 3.1045, lr_0 = 3.1984e-04
Validation rmse = 0.137109
Validation r2 = 0.841783
Validation mse = 0.018799
Epoch 29
Loss = 8.0449e-02, PNorm = 35.1764, GNorm = 3.4267, lr_0 = 3.1089e-04
Loss = 9.1815e-02, PNorm = 35.1846, GNorm = 1.7866, lr_0 = 3.0220e-04
Validation rmse = 0.133612
Validation r2 = 0.849752
Validation mse = 0.017852
Epoch 30
Loss = 7.9556e-02, PNorm = 35.1942, GNorm = 0.6162, lr_0 = 2.9375e-04
Validation rmse = 0.130992
Validation r2 = 0.855585
Validation mse = 0.017159
Epoch 31
Loss = 7.6536e-02, PNorm = 35.2040, GNorm = 1.2372, lr_0 = 2.8473e-04
Loss = 8.7269e-02, PNorm = 35.2110, GNorm = 0.9154, lr_0 = 2.7677e-04
Validation rmse = 0.136701
Validation r2 = 0.842723
Validation mse = 0.018687
Epoch 32
Loss = 8.2879e-02, PNorm = 35.2200, GNorm = 0.9353, lr_0 = 2.6903e-04
Validation rmse = 0.134447
Validation r2 = 0.847868
Validation mse = 0.018076
Epoch 33
Loss = 9.3697e-02, PNorm = 35.2274, GNorm = 0.7500, lr_0 = 2.6151e-04
Validation rmse = 0.139884
Validation r2 = 0.835313
Validation mse = 0.019568
Epoch 34
Loss = 8.9701e-02, PNorm = 35.2354, GNorm = 4.3628, lr_0 = 2.5348e-04
Loss = 8.6129e-02, PNorm = 35.2413, GNorm = 2.2113, lr_0 = 2.4639e-04
Validation rmse = 0.129569
Validation r2 = 0.858707
Validation mse = 0.016788
Epoch 35
Loss = 7.5619e-02, PNorm = 35.2482, GNorm = 0.5127, lr_0 = 2.3950e-04
Validation rmse = 0.130043
Validation r2 = 0.857671
Validation mse = 0.016911
Epoch 36
Loss = 5.5674e-02, PNorm = 35.2537, GNorm = 0.4283, lr_0 = 2.3281e-04
Loss = 7.6859e-02, PNorm = 35.2600, GNorm = 0.5318, lr_0 = 2.2630e-04
Validation rmse = 0.134133
Validation r2 = 0.848576
Validation mse = 0.017992
Epoch 37
Loss = 7.9328e-02, PNorm = 35.2669, GNorm = 1.7916, lr_0 = 2.1935e-04
Validation rmse = 0.130305
Validation r2 = 0.857096
Validation mse = 0.016979
Epoch 38
Loss = 8.9489e-02, PNorm = 35.2734, GNorm = 0.7439, lr_0 = 2.1321e-04
Loss = 7.8212e-02, PNorm = 35.2796, GNorm = 0.8108, lr_0 = 2.0725e-04
Validation rmse = 0.130353
Validation r2 = 0.856992
Validation mse = 0.016992
Epoch 39
Loss = 7.7157e-02, PNorm = 35.2857, GNorm = 1.5966, lr_0 = 2.0146e-04
Validation rmse = 0.132011
Validation r2 = 0.853329
Validation mse = 0.017427
Epoch 40
Loss = 6.0428e-02, PNorm = 35.2913, GNorm = 0.6058, lr_0 = 1.9583e-04
Loss = 7.2296e-02, PNorm = 35.2966, GNorm = 1.3578, lr_0 = 1.9035e-04
Validation rmse = 0.133443
Validation r2 = 0.850131
Validation mse = 0.017807
Epoch 41
Loss = 6.3204e-02, PNorm = 35.3008, GNorm = 1.5800, lr_0 = 1.8451e-04
Validation rmse = 0.130633
Validation r2 = 0.856376
Validation mse = 0.017065
Epoch 42
Loss = 7.1636e-02, PNorm = 35.3064, GNorm = 2.2938, lr_0 = 1.7935e-04
Loss = 8.4807e-02, PNorm = 35.3124, GNorm = 1.7941, lr_0 = 1.7433e-04
Validation rmse = 0.132392
Validation r2 = 0.852482
Validation mse = 0.017528
Epoch 43
Loss = 8.0739e-02, PNorm = 35.3171, GNorm = 1.0877, lr_0 = 1.6946e-04
Validation rmse = 0.128923
Validation r2 = 0.860111
Validation mse = 0.016621
Epoch 44
Loss = 6.6937e-02, PNorm = 35.3220, GNorm = 0.5851, lr_0 = 1.6425e-04
Loss = 7.5585e-02, PNorm = 35.3260, GNorm = 1.6881, lr_0 = 1.5966e-04
Validation rmse = 0.129905
Validation r2 = 0.857972
Validation mse = 0.016875
Epoch 45
Loss = 6.8571e-02, PNorm = 35.3298, GNorm = 0.4371, lr_0 = 1.5520e-04
Validation rmse = 0.131056
Validation r2 = 0.855444
Validation mse = 0.017176
Epoch 46
Loss = 8.5264e-02, PNorm = 35.3352, GNorm = 1.3606, lr_0 = 1.5086e-04
Loss = 6.6347e-02, PNorm = 35.3403, GNorm = 1.4943, lr_0 = 1.4664e-04
Loss = 7.7595e-02, PNorm = 35.3406, GNorm = 2.0096, lr_0 = 1.4623e-04
Validation rmse = 0.130829
Validation r2 = 0.855944
Validation mse = 0.017116
Epoch 47
Loss = 7.2866e-02, PNorm = 35.3444, GNorm = 5.2151, lr_0 = 1.4214e-04
Validation rmse = 0.131248
Validation r2 = 0.855020
Validation mse = 0.017226
Epoch 48
Loss = 6.5057e-02, PNorm = 35.3485, GNorm = 2.1202, lr_0 = 1.3816e-04
Loss = 7.6823e-02, PNorm = 35.3522, GNorm = 1.3460, lr_0 = 1.3430e-04
Validation rmse = 0.130082
Validation r2 = 0.857586
Validation mse = 0.016921
Epoch 49
Loss = 7.3069e-02, PNorm = 35.3567, GNorm = 0.6176, lr_0 = 1.3055e-04
Validation rmse = 0.129340
Validation r2 = 0.859205
Validation mse = 0.016729
Epoch 50
Loss = 5.7378e-02, PNorm = 35.3604, GNorm = 0.8876, lr_0 = 1.2690e-04
Validation rmse = 0.129735
Validation r2 = 0.858344
Validation mse = 0.016831
Epoch 51
Loss = 6.0952e-02, PNorm = 35.3639, GNorm = 0.8519, lr_0 = 1.2300e-04
Loss = 7.5602e-02, PNorm = 35.3671, GNorm = 0.8223, lr_0 = 1.1956e-04
Validation rmse = 0.128762
Validation r2 = 0.860461
Validation mse = 0.016580
Epoch 52
Loss = 7.6604e-02, PNorm = 35.3709, GNorm = 1.3909, lr_0 = 1.1622e-04
Validation rmse = 0.130363
Validation r2 = 0.856969
Validation mse = 0.016994
Epoch 53
Loss = 9.4190e-02, PNorm = 35.3746, GNorm = 1.9930, lr_0 = 1.1297e-04
Loss = 7.6410e-02, PNorm = 35.3775, GNorm = 0.8132, lr_0 = 1.0981e-04
Validation rmse = 0.130774
Validation r2 = 0.856066
Validation mse = 0.017102
Epoch 54
Loss = 6.9700e-02, PNorm = 35.3803, GNorm = 1.5353, lr_0 = 1.0644e-04
Validation rmse = 0.130187
Validation r2 = 0.857354
Validation mse = 0.016949
Epoch 55
Loss = 7.5447e-02, PNorm = 35.3830, GNorm = 1.0455, lr_0 = 1.0346e-04
Loss = 6.6427e-02, PNorm = 35.3861, GNorm = 2.7381, lr_0 = 1.0057e-04
Validation rmse = 0.130402
Validation r2 = 0.856883
Validation mse = 0.017005
Epoch 56
Loss = 6.6731e-02, PNorm = 35.3893, GNorm = 0.5055, lr_0 = 1.0000e-04
Validation rmse = 0.129137
Validation r2 = 0.859646
Validation mse = 0.016676
Epoch 57
Loss = 7.0895e-02, PNorm = 35.3922, GNorm = 0.6917, lr_0 = 1.0000e-04
Loss = 7.0298e-02, PNorm = 35.3948, GNorm = 0.7929, lr_0 = 1.0000e-04
Validation rmse = 0.128808
Validation r2 = 0.860360
Validation mse = 0.016592
Epoch 58
Loss = 6.4142e-02, PNorm = 35.3981, GNorm = 0.6714, lr_0 = 1.0000e-04
Validation rmse = 0.130242
Validation r2 = 0.857234
Validation mse = 0.016963
Epoch 59
Loss = 5.8048e-02, PNorm = 35.4004, GNorm = 0.5726, lr_0 = 1.0000e-04
Loss = 7.0135e-02, PNorm = 35.4028, GNorm = 0.8113, lr_0 = 1.0000e-04
Validation rmse = 0.129472
Validation r2 = 0.858918
Validation mse = 0.016763
Model 0 best validation rmse = 0.128762 on epoch 51
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.228372
Model 0 test r2 = 0.134138
Model 0 test mse = 0.052154
Ensemble test rmse = 0.228372
Ensemble test r2 = 0.134138
Ensemble test mse = 0.052154
Fold 2
Splitting data with seed 2
Total size = 919 | train size = 735 | val size = 184 | test size = 103
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.4008e-01, PNorm = 34.0181, GNorm = 1.5699, lr_0 = 4.5357e-04
Validation rmse = 0.283105
Validation r2 = 0.361200
Validation mse = 0.080149
Epoch 1
Loss = 7.3044e-01, PNorm = 34.0587, GNorm = 1.2868, lr_0 = 8.0714e-04
Validation rmse = 0.272911
Validation r2 = 0.406375
Validation mse = 0.074481
Epoch 2
Loss = 7.6717e-01, PNorm = 34.1239, GNorm = 11.4925, lr_0 = 9.8872e-04
Loss = 5.9079e-01, PNorm = 34.1881, GNorm = 7.7694, lr_0 = 9.6108e-04
Validation rmse = 0.234267
Validation r2 = 0.562586
Validation mse = 0.054881
Epoch 3
Loss = 4.2873e-01, PNorm = 34.2599, GNorm = 2.0463, lr_0 = 9.3421e-04
Validation rmse = 0.207113
Validation r2 = 0.658111
Validation mse = 0.042896
Epoch 4
Loss = 4.1115e-01, PNorm = 34.3444, GNorm = 8.6222, lr_0 = 9.0552e-04
Loss = 3.1532e-01, PNorm = 34.4079, GNorm = 1.1613, lr_0 = 8.8020e-04
Validation rmse = 0.201871
Validation r2 = 0.675199
Validation mse = 0.040752
Epoch 5
Loss = 2.5989e-01, PNorm = 34.4673, GNorm = 3.2246, lr_0 = 8.5559e-04
Validation rmse = 0.176784
Validation r2 = 0.750911
Validation mse = 0.031252
Epoch 6
Loss = 2.4065e-01, PNorm = 34.5183, GNorm = 1.4504, lr_0 = 8.3167e-04
Loss = 1.9717e-01, PNorm = 34.5654, GNorm = 1.5067, lr_0 = 8.0842e-04
Validation rmse = 0.155945
Validation r2 = 0.806175
Validation mse = 0.024319
Epoch 7
Loss = 2.0667e-01, PNorm = 34.6148, GNorm = 8.7427, lr_0 = 7.8359e-04
Validation rmse = 0.149235
Validation r2 = 0.822495
Validation mse = 0.022271
Epoch 8
Loss = 1.4507e-01, PNorm = 34.6521, GNorm = 3.0839, lr_0 = 7.6168e-04
Loss = 1.6857e-01, PNorm = 34.6908, GNorm = 0.9202, lr_0 = 7.4039e-04
Validation rmse = 0.140881
Validation r2 = 0.841812
Validation mse = 0.019847
Epoch 9
Loss = 1.4584e-01, PNorm = 34.7220, GNorm = 1.3841, lr_0 = 7.1969e-04
Validation rmse = 0.170009
Validation r2 = 0.769638
Validation mse = 0.028903
Epoch 10
Loss = 1.6949e-01, PNorm = 34.7513, GNorm = 5.7179, lr_0 = 6.9956e-04
Loss = 1.4830e-01, PNorm = 34.7790, GNorm = 1.3948, lr_0 = 6.8001e-04
Validation rmse = 0.152199
Validation r2 = 0.815375
Validation mse = 0.023164
Epoch 11
Loss = 1.5687e-01, PNorm = 34.8067, GNorm = 0.5735, lr_0 = 6.5912e-04
Validation rmse = 0.142746
Validation r2 = 0.837595
Validation mse = 0.020377
Epoch 12
Loss = 1.2610e-01, PNorm = 34.8267, GNorm = 1.1515, lr_0 = 6.4069e-04
Loss = 1.2313e-01, PNorm = 34.8471, GNorm = 1.5179, lr_0 = 6.2278e-04
Validation rmse = 0.143175
Validation r2 = 0.836619
Validation mse = 0.020499
Epoch 13
Loss = 1.3335e-01, PNorm = 34.8640, GNorm = 0.5044, lr_0 = 6.0537e-04
Validation rmse = 0.132085
Validation r2 = 0.860948
Validation mse = 0.017446
Epoch 14
Loss = 1.0790e-01, PNorm = 34.8825, GNorm = 2.6228, lr_0 = 5.8678e-04
Loss = 1.1557e-01, PNorm = 34.8968, GNorm = 1.8076, lr_0 = 5.7037e-04
Validation rmse = 0.144836
Validation r2 = 0.832806
Validation mse = 0.020977
Epoch 15
Loss = 1.2408e-01, PNorm = 34.9150, GNorm = 3.9837, lr_0 = 5.5442e-04
Validation rmse = 0.132515
Validation r2 = 0.860041
Validation mse = 0.017560
Epoch 16
Loss = 1.1377e-01, PNorm = 34.9287, GNorm = 1.1508, lr_0 = 5.3892e-04
Validation rmse = 0.130155
Validation r2 = 0.864983
Validation mse = 0.016940
Epoch 17
Loss = 7.1830e-02, PNorm = 34.9465, GNorm = 0.5136, lr_0 = 5.2237e-04
Loss = 1.0404e-01, PNorm = 34.9625, GNorm = 4.1579, lr_0 = 5.0777e-04
Validation rmse = 0.132063
Validation r2 = 0.860995
Validation mse = 0.017441
Epoch 18
Loss = 9.6212e-02, PNorm = 34.9763, GNorm = 2.1889, lr_0 = 4.9357e-04
Validation rmse = 0.135940
Validation r2 = 0.852712
Validation mse = 0.018480
Epoch 19
Loss = 8.1983e-02, PNorm = 34.9899, GNorm = 1.4588, lr_0 = 4.7977e-04
Loss = 1.0808e-01, PNorm = 35.0021, GNorm = 3.0546, lr_0 = 4.6636e-04
Validation rmse = 0.133441
Validation r2 = 0.858078
Validation mse = 0.017807
Epoch 20
Loss = 9.9355e-02, PNorm = 35.0173, GNorm = 1.9428, lr_0 = 4.5332e-04
Validation rmse = 0.131455
Validation r2 = 0.862272
Validation mse = 0.017280
Epoch 21
Loss = 1.1439e-01, PNorm = 35.0311, GNorm = 1.4905, lr_0 = 4.3940e-04
Loss = 1.1100e-01, PNorm = 35.0452, GNorm = 1.0374, lr_0 = 4.2711e-04
Validation rmse = 0.132861
Validation r2 = 0.859310
Validation mse = 0.017652
Epoch 22
Loss = 1.1089e-01, PNorm = 35.0574, GNorm = 1.7273, lr_0 = 4.1517e-04
Validation rmse = 0.137581
Validation r2 = 0.849136
Validation mse = 0.018929
Epoch 23
Loss = 1.2019e-01, PNorm = 35.0703, GNorm = 2.1913, lr_0 = 4.0356e-04
Loss = 1.2137e-01, PNorm = 35.0833, GNorm = 2.7222, lr_0 = 3.9228e-04
Validation rmse = 0.140695
Validation r2 = 0.842229
Validation mse = 0.019795
Epoch 24
Loss = 1.1313e-01, PNorm = 35.1017, GNorm = 2.2342, lr_0 = 3.8023e-04
Validation rmse = 0.131338
Validation r2 = 0.862518
Validation mse = 0.017250
Epoch 25
Loss = 1.1223e-01, PNorm = 35.1124, GNorm = 1.9370, lr_0 = 3.6960e-04
Loss = 8.2778e-02, PNorm = 35.1234, GNorm = 1.2385, lr_0 = 3.5927e-04
Validation rmse = 0.136775
Validation r2 = 0.850898
Validation mse = 0.018707
Epoch 26
Loss = 9.7143e-02, PNorm = 35.1302, GNorm = 0.7434, lr_0 = 3.4922e-04
Validation rmse = 0.128404
Validation r2 = 0.868591
Validation mse = 0.016487
Epoch 27
Loss = 8.3897e-02, PNorm = 35.1410, GNorm = 0.8992, lr_0 = 3.3850e-04
Loss = 8.8974e-02, PNorm = 35.1502, GNorm = 1.7796, lr_0 = 3.2903e-04
Validation rmse = 0.126941
Validation r2 = 0.871569
Validation mse = 0.016114
Epoch 28
Loss = 8.2378e-02, PNorm = 35.1613, GNorm = 1.2989, lr_0 = 3.1984e-04
Validation rmse = 0.130435
Validation r2 = 0.864401
Validation mse = 0.017013
Epoch 29
Loss = 6.8893e-02, PNorm = 35.1690, GNorm = 2.2246, lr_0 = 3.1089e-04
Loss = 9.2103e-02, PNorm = 35.1772, GNorm = 1.7976, lr_0 = 3.0220e-04
Validation rmse = 0.131594
Validation r2 = 0.861980
Validation mse = 0.017317
Epoch 30
Loss = 8.2087e-02, PNorm = 35.1866, GNorm = 1.0581, lr_0 = 2.9375e-04
Validation rmse = 0.130633
Validation r2 = 0.863989
Validation mse = 0.017065
Epoch 31
Loss = 7.4212e-02, PNorm = 35.1941, GNorm = 2.4176, lr_0 = 2.8473e-04
Loss = 8.7574e-02, PNorm = 35.2020, GNorm = 1.0203, lr_0 = 2.7677e-04
Validation rmse = 0.129249
Validation r2 = 0.866856
Validation mse = 0.016705
Epoch 32
Loss = 7.5427e-02, PNorm = 35.2110, GNorm = 2.3435, lr_0 = 2.6903e-04
Validation rmse = 0.130501
Validation r2 = 0.864264
Validation mse = 0.017030
Epoch 33
Loss = 7.6902e-02, PNorm = 35.2177, GNorm = 1.2265, lr_0 = 2.6151e-04
Validation rmse = 0.129950
Validation r2 = 0.865407
Validation mse = 0.016887
Epoch 34
Loss = 1.1231e-01, PNorm = 35.2263, GNorm = 1.7299, lr_0 = 2.5348e-04
Loss = 8.1472e-02, PNorm = 35.2334, GNorm = 2.4719, lr_0 = 2.4639e-04
Validation rmse = 0.131977
Validation r2 = 0.861175
Validation mse = 0.017418
Epoch 35
Loss = 7.5275e-02, PNorm = 35.2392, GNorm = 2.1412, lr_0 = 2.3950e-04
Validation rmse = 0.132569
Validation r2 = 0.859928
Validation mse = 0.017574
Epoch 36
Loss = 7.1996e-02, PNorm = 35.2458, GNorm = 1.0707, lr_0 = 2.3281e-04
Loss = 7.7497e-02, PNorm = 35.2531, GNorm = 1.6576, lr_0 = 2.2630e-04
Validation rmse = 0.129947
Validation r2 = 0.865413
Validation mse = 0.016886
Epoch 37
Loss = 8.1930e-02, PNorm = 35.2603, GNorm = 1.1898, lr_0 = 2.1935e-04
Validation rmse = 0.132168
Validation r2 = 0.860772
Validation mse = 0.017469
Epoch 38
Loss = 5.3362e-02, PNorm = 35.2660, GNorm = 1.0370, lr_0 = 2.1321e-04
Loss = 7.6907e-02, PNorm = 35.2719, GNorm = 1.1047, lr_0 = 2.0725e-04
Validation rmse = 0.127576
Validation r2 = 0.870279
Validation mse = 0.016276
Epoch 39
Loss = 7.3275e-02, PNorm = 35.2770, GNorm = 1.2429, lr_0 = 2.0146e-04
Validation rmse = 0.128905
Validation r2 = 0.867562
Validation mse = 0.016617
Epoch 40
Loss = 6.0482e-02, PNorm = 35.2823, GNorm = 0.7137, lr_0 = 1.9583e-04
Loss = 7.6766e-02, PNorm = 35.2873, GNorm = 1.0246, lr_0 = 1.9035e-04
Validation rmse = 0.128416
Validation r2 = 0.868566
Validation mse = 0.016491
Epoch 41
Loss = 7.4291e-02, PNorm = 35.2937, GNorm = 0.8688, lr_0 = 1.8451e-04
Validation rmse = 0.128267
Validation r2 = 0.868870
Validation mse = 0.016453
Epoch 42
Loss = 6.1185e-02, PNorm = 35.2995, GNorm = 0.5398, lr_0 = 1.7935e-04
Loss = 7.5274e-02, PNorm = 35.3046, GNorm = 1.0821, lr_0 = 1.7433e-04
Validation rmse = 0.127778
Validation r2 = 0.869870
Validation mse = 0.016327
Epoch 43
Loss = 6.9050e-02, PNorm = 35.3090, GNorm = 1.2251, lr_0 = 1.6946e-04
Validation rmse = 0.129857
Validation r2 = 0.865600
Validation mse = 0.016863
Epoch 44
Loss = 7.6481e-02, PNorm = 35.3148, GNorm = 1.3239, lr_0 = 1.6425e-04
Loss = 7.0736e-02, PNorm = 35.3199, GNorm = 2.4237, lr_0 = 1.5966e-04
Validation rmse = 0.128151
Validation r2 = 0.869107
Validation mse = 0.016423
Epoch 45
Loss = 6.9068e-02, PNorm = 35.3244, GNorm = 0.8032, lr_0 = 1.5520e-04
Validation rmse = 0.129515
Validation r2 = 0.866307
Validation mse = 0.016774
Epoch 46
Loss = 7.3883e-02, PNorm = 35.3278, GNorm = 0.6938, lr_0 = 1.5086e-04
Loss = 7.0740e-02, PNorm = 35.3322, GNorm = 0.8367, lr_0 = 1.4664e-04
Loss = 5.9355e-02, PNorm = 35.3328, GNorm = 1.7344, lr_0 = 1.4623e-04
Validation rmse = 0.132828
Validation r2 = 0.859379
Validation mse = 0.017643
Epoch 47
Loss = 7.2690e-02, PNorm = 35.3373, GNorm = 0.7583, lr_0 = 1.4214e-04
Validation rmse = 0.132736
Validation r2 = 0.859574
Validation mse = 0.017619
Epoch 48
Loss = 7.5351e-02, PNorm = 35.3413, GNorm = 0.7204, lr_0 = 1.3816e-04
Loss = 7.1105e-02, PNorm = 35.3453, GNorm = 1.8007, lr_0 = 1.3430e-04
Validation rmse = 0.128545
Validation r2 = 0.868302
Validation mse = 0.016524
Epoch 49
Loss = 6.8683e-02, PNorm = 35.3491, GNorm = 1.6448, lr_0 = 1.3055e-04
Validation rmse = 0.128527
Validation r2 = 0.868339
Validation mse = 0.016519
Epoch 50
Loss = 8.1242e-02, PNorm = 35.3529, GNorm = 1.1110, lr_0 = 1.2690e-04
Validation rmse = 0.127943
Validation r2 = 0.869533
Validation mse = 0.016369
Epoch 51
Loss = 7.6532e-02, PNorm = 35.3571, GNorm = 0.9952, lr_0 = 1.2300e-04
Loss = 6.9330e-02, PNorm = 35.3600, GNorm = 1.4391, lr_0 = 1.1956e-04
Validation rmse = 0.132516
Validation r2 = 0.860039
Validation mse = 0.017560
Epoch 52
Loss = 7.6529e-02, PNorm = 35.3631, GNorm = 1.2087, lr_0 = 1.1622e-04
Validation rmse = 0.133519
Validation r2 = 0.857912
Validation mse = 0.017827
Epoch 53
Loss = 7.4293e-02, PNorm = 35.3673, GNorm = 4.0640, lr_0 = 1.1297e-04
Loss = 6.6926e-02, PNorm = 35.3701, GNorm = 1.4836, lr_0 = 1.0981e-04
Validation rmse = 0.127377
Validation r2 = 0.870684
Validation mse = 0.016225
Epoch 54
Loss = 6.5116e-02, PNorm = 35.3740, GNorm = 0.9937, lr_0 = 1.0644e-04
Validation rmse = 0.127952
Validation r2 = 0.869514
Validation mse = 0.016372
Epoch 55
Loss = 6.6898e-02, PNorm = 35.3773, GNorm = 0.4022, lr_0 = 1.0346e-04
Loss = 7.1855e-02, PNorm = 35.3807, GNorm = 0.8016, lr_0 = 1.0057e-04
Validation rmse = 0.129357
Validation r2 = 0.866633
Validation mse = 0.016733
Epoch 56
Loss = 6.8011e-02, PNorm = 35.3826, GNorm = 0.9348, lr_0 = 1.0000e-04
Validation rmse = 0.131434
Validation r2 = 0.862315
Validation mse = 0.017275
Epoch 57
Loss = 7.8416e-02, PNorm = 35.3858, GNorm = 4.4185, lr_0 = 1.0000e-04
Loss = 6.6246e-02, PNorm = 35.3888, GNorm = 0.6288, lr_0 = 1.0000e-04
Validation rmse = 0.129586
Validation r2 = 0.866161
Validation mse = 0.016792
Epoch 58
Loss = 6.3140e-02, PNorm = 35.3912, GNorm = 0.7601, lr_0 = 1.0000e-04
Validation rmse = 0.127369
Validation r2 = 0.870700
Validation mse = 0.016223
Epoch 59
Loss = 6.1841e-02, PNorm = 35.3945, GNorm = 0.8773, lr_0 = 1.0000e-04
Loss = 6.8859e-02, PNorm = 35.3975, GNorm = 0.6256, lr_0 = 1.0000e-04
Validation rmse = 0.128887
Validation r2 = 0.867600
Validation mse = 0.016612
Model 0 best validation rmse = 0.126941 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.188686
Model 0 test r2 = 0.408923
Model 0 test mse = 0.035602
Ensemble test rmse = 0.188686
Ensemble test r2 = 0.408923
Ensemble test mse = 0.035602
Fold 3
Splitting data with seed 3
Total size = 919 | train size = 735 | val size = 184 | test size = 103
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1459e-01, PNorm = 34.0166, GNorm = 1.0046, lr_0 = 4.5357e-04
Validation rmse = 0.306323
Validation r2 = 0.229290
Validation mse = 0.093834
Epoch 1
Loss = 5.8698e-01, PNorm = 34.0633, GNorm = 5.4426, lr_0 = 8.0714e-04
Validation rmse = 0.289931
Validation r2 = 0.309569
Validation mse = 0.084060
Epoch 2
Loss = 5.4102e-01, PNorm = 34.1118, GNorm = 6.5521, lr_0 = 9.8872e-04
Loss = 5.5791e-01, PNorm = 34.1745, GNorm = 7.4642, lr_0 = 9.6108e-04
Validation rmse = 0.312977
Validation r2 = 0.195446
Validation mse = 0.097955
Epoch 3
Loss = 5.0157e-01, PNorm = 34.2375, GNorm = 7.7067, lr_0 = 9.3421e-04
Validation rmse = 0.260299
Validation r2 = 0.443488
Validation mse = 0.067755
Epoch 4
Loss = 3.2817e-01, PNorm = 34.2985, GNorm = 3.4332, lr_0 = 9.0552e-04
Loss = 3.7376e-01, PNorm = 34.3562, GNorm = 5.7144, lr_0 = 8.8020e-04
Validation rmse = 0.225274
Validation r2 = 0.583175
Validation mse = 0.050748
Epoch 5
Loss = 2.8701e-01, PNorm = 34.4071, GNorm = 1.2892, lr_0 = 8.5559e-04
Validation rmse = 0.190690
Validation r2 = 0.701335
Validation mse = 0.036363
Epoch 6
Loss = 2.1188e-01, PNorm = 34.4612, GNorm = 4.0752, lr_0 = 8.3167e-04
Loss = 2.2214e-01, PNorm = 34.5120, GNorm = 1.6087, lr_0 = 8.0842e-04
Validation rmse = 0.173077
Validation r2 = 0.753957
Validation mse = 0.029956
Epoch 7
Loss = 2.1381e-01, PNorm = 34.5599, GNorm = 1.2640, lr_0 = 7.8359e-04
Validation rmse = 0.181204
Validation r2 = 0.730308
Validation mse = 0.032835
Epoch 8
Loss = 2.0818e-01, PNorm = 34.6040, GNorm = 1.0779, lr_0 = 7.6168e-04
Loss = 1.7827e-01, PNorm = 34.6439, GNorm = 4.8545, lr_0 = 7.4039e-04
Validation rmse = 0.173085
Validation r2 = 0.753935
Validation mse = 0.029958
Epoch 9
Loss = 1.8425e-01, PNorm = 34.6763, GNorm = 0.8503, lr_0 = 7.1969e-04
Validation rmse = 0.148854
Validation r2 = 0.818008
Validation mse = 0.022158
Epoch 10
Loss = 1.2026e-01, PNorm = 34.7068, GNorm = 0.9425, lr_0 = 6.9956e-04
Loss = 1.4620e-01, PNorm = 34.7363, GNorm = 2.7021, lr_0 = 6.8001e-04
Validation rmse = 0.141413
Validation r2 = 0.835749
Validation mse = 0.019998
Epoch 11
Loss = 1.2168e-01, PNorm = 34.7699, GNorm = 2.2852, lr_0 = 6.5912e-04
Validation rmse = 0.156313
Validation r2 = 0.799313
Validation mse = 0.024434
Epoch 12
Loss = 1.4528e-01, PNorm = 34.7898, GNorm = 4.2071, lr_0 = 6.4069e-04
Loss = 1.2590e-01, PNorm = 34.8108, GNorm = 0.7930, lr_0 = 6.2278e-04
Validation rmse = 0.139537
Validation r2 = 0.840078
Validation mse = 0.019471
Epoch 13
Loss = 1.1949e-01, PNorm = 34.8306, GNorm = 1.0299, lr_0 = 6.0537e-04
Validation rmse = 0.138207
Validation r2 = 0.843112
Validation mse = 0.019101
Epoch 14
Loss = 1.0531e-01, PNorm = 34.8557, GNorm = 3.3077, lr_0 = 5.8678e-04
Loss = 1.3756e-01, PNorm = 34.8722, GNorm = 1.2823, lr_0 = 5.7037e-04
Validation rmse = 0.133580
Validation r2 = 0.853440
Validation mse = 0.017844
Epoch 15
Loss = 1.0195e-01, PNorm = 34.8878, GNorm = 1.1467, lr_0 = 5.5442e-04
Validation rmse = 0.140252
Validation r2 = 0.838435
Validation mse = 0.019671
Epoch 16
Loss = 1.5283e-01, PNorm = 34.9017, GNorm = 6.6111, lr_0 = 5.3892e-04
Validation rmse = 0.158658
Validation r2 = 0.793246
Validation mse = 0.025172
Epoch 17
Loss = 1.8965e-01, PNorm = 34.9192, GNorm = 5.1824, lr_0 = 5.2237e-04
Loss = 1.1078e-01, PNorm = 34.9327, GNorm = 3.7455, lr_0 = 5.0777e-04
Validation rmse = 0.148852
Validation r2 = 0.818014
Validation mse = 0.022157
Epoch 18
Loss = 1.4144e-01, PNorm = 34.9466, GNorm = 3.3756, lr_0 = 4.9357e-04
Validation rmse = 0.156787
Validation r2 = 0.798094
Validation mse = 0.024582
Epoch 19
Loss = 1.2487e-01, PNorm = 34.9636, GNorm = 4.0995, lr_0 = 4.7977e-04
Loss = 1.3159e-01, PNorm = 34.9759, GNorm = 1.5302, lr_0 = 4.6636e-04
Validation rmse = 0.136909
Validation r2 = 0.846044
Validation mse = 0.018744
Epoch 20
Loss = 1.2438e-01, PNorm = 34.9866, GNorm = 1.2832, lr_0 = 4.5332e-04
Validation rmse = 0.141732
Validation r2 = 0.835006
Validation mse = 0.020088
Epoch 21
Loss = 1.0661e-01, PNorm = 35.0010, GNorm = 2.3651, lr_0 = 4.3940e-04
Loss = 1.1057e-01, PNorm = 35.0133, GNorm = 1.3111, lr_0 = 4.2711e-04
Validation rmse = 0.137207
Validation r2 = 0.845374
Validation mse = 0.018826
Epoch 22
Loss = 1.0042e-01, PNorm = 35.0262, GNorm = 2.4659, lr_0 = 4.1517e-04
Validation rmse = 0.130664
Validation r2 = 0.859769
Validation mse = 0.017073
Epoch 23
Loss = 9.4430e-02, PNorm = 35.0372, GNorm = 1.7425, lr_0 = 4.0356e-04
Loss = 1.0378e-01, PNorm = 35.0464, GNorm = 0.8756, lr_0 = 3.9228e-04
Validation rmse = 0.130871
Validation r2 = 0.859324
Validation mse = 0.017127
Epoch 24
Loss = 9.6324e-02, PNorm = 35.0577, GNorm = 1.6314, lr_0 = 3.8023e-04
Validation rmse = 0.132311
Validation r2 = 0.856211
Validation mse = 0.017506
Epoch 25
Loss = 8.8219e-02, PNorm = 35.0689, GNorm = 2.1818, lr_0 = 3.6960e-04
Loss = 1.0976e-01, PNorm = 35.0767, GNorm = 3.4733, lr_0 = 3.5927e-04
Validation rmse = 0.132125
Validation r2 = 0.856617
Validation mse = 0.017457
Epoch 26
Loss = 8.4786e-02, PNorm = 35.0851, GNorm = 2.3868, lr_0 = 3.4922e-04
Validation rmse = 0.139646
Validation r2 = 0.839829
Validation mse = 0.019501
Epoch 27
Loss = 1.1333e-01, PNorm = 35.0957, GNorm = 0.7137, lr_0 = 3.3850e-04
Loss = 9.4641e-02, PNorm = 35.1025, GNorm = 1.2075, lr_0 = 3.2903e-04
Validation rmse = 0.130096
Validation r2 = 0.860985
Validation mse = 0.016925
Epoch 28
Loss = 8.6227e-02, PNorm = 35.1127, GNorm = 2.0400, lr_0 = 3.1984e-04
Validation rmse = 0.131025
Validation r2 = 0.858994
Validation mse = 0.017167
Epoch 29
Loss = 9.9963e-02, PNorm = 35.1211, GNorm = 1.4495, lr_0 = 3.1089e-04
Loss = 9.4444e-02, PNorm = 35.1296, GNorm = 1.9042, lr_0 = 3.0220e-04
Validation rmse = 0.135875
Validation r2 = 0.848361
Validation mse = 0.018462
Epoch 30
Loss = 9.6607e-02, PNorm = 35.1392, GNorm = 1.4521, lr_0 = 2.9375e-04
Validation rmse = 0.127994
Validation r2 = 0.865441
Validation mse = 0.016383
Epoch 31
Loss = 8.3458e-02, PNorm = 35.1469, GNorm = 1.1275, lr_0 = 2.8473e-04
Loss = 9.7662e-02, PNorm = 35.1532, GNorm = 1.5150, lr_0 = 2.7677e-04
Validation rmse = 0.133017
Validation r2 = 0.854674
Validation mse = 0.017693
Epoch 32
Loss = 8.8165e-02, PNorm = 35.1609, GNorm = 1.7918, lr_0 = 2.6903e-04
Validation rmse = 0.128196
Validation r2 = 0.865017
Validation mse = 0.016434
Epoch 33
Loss = 8.8358e-02, PNorm = 35.1678, GNorm = 1.6349, lr_0 = 2.6151e-04
Validation rmse = 0.142111
Validation r2 = 0.834123
Validation mse = 0.020195
Epoch 34
Loss = 9.1652e-02, PNorm = 35.1773, GNorm = 1.3989, lr_0 = 2.5348e-04
Loss = 1.0324e-01, PNorm = 35.1836, GNorm = 1.9120, lr_0 = 2.4639e-04
Validation rmse = 0.125123
Validation r2 = 0.871410
Validation mse = 0.015656
Epoch 35
Loss = 8.9184e-02, PNorm = 35.1916, GNorm = 1.6872, lr_0 = 2.3950e-04
Validation rmse = 0.125867
Validation r2 = 0.869877
Validation mse = 0.015843
Epoch 36
Loss = 8.9691e-02, PNorm = 35.1975, GNorm = 0.6295, lr_0 = 2.3281e-04
Loss = 9.9839e-02, PNorm = 35.2032, GNorm = 1.0351, lr_0 = 2.2630e-04
Validation rmse = 0.128603
Validation r2 = 0.864159
Validation mse = 0.016539
Epoch 37
Loss = 9.2505e-02, PNorm = 35.2111, GNorm = 1.6959, lr_0 = 2.1935e-04
Validation rmse = 0.124940
Validation r2 = 0.871786
Validation mse = 0.015610
Epoch 38
Loss = 9.0907e-02, PNorm = 35.2165, GNorm = 0.7648, lr_0 = 2.1321e-04
Loss = 8.4652e-02, PNorm = 35.2221, GNorm = 0.5761, lr_0 = 2.0725e-04
Validation rmse = 0.129613
Validation r2 = 0.862016
Validation mse = 0.016800
Epoch 39
Loss = 8.0751e-02, PNorm = 35.2273, GNorm = 0.4965, lr_0 = 2.0146e-04
Validation rmse = 0.124088
Validation r2 = 0.873530
Validation mse = 0.015398
Epoch 40
Loss = 9.1664e-02, PNorm = 35.2326, GNorm = 1.6572, lr_0 = 1.9583e-04
Loss = 8.5764e-02, PNorm = 35.2386, GNorm = 2.6509, lr_0 = 1.9035e-04
Validation rmse = 0.125928
Validation r2 = 0.869751
Validation mse = 0.015858
Epoch 41
Loss = 8.8483e-02, PNorm = 35.2424, GNorm = 2.2699, lr_0 = 1.8451e-04
Validation rmse = 0.124552
Validation r2 = 0.872581
Validation mse = 0.015513
Epoch 42
Loss = 8.8278e-02, PNorm = 35.2472, GNorm = 1.4229, lr_0 = 1.7935e-04
Loss = 8.3219e-02, PNorm = 35.2528, GNorm = 0.5127, lr_0 = 1.7433e-04
Validation rmse = 0.124866
Validation r2 = 0.871939
Validation mse = 0.015591
Epoch 43
Loss = 8.7977e-02, PNorm = 35.2574, GNorm = 2.1110, lr_0 = 1.6946e-04
Validation rmse = 0.124511
Validation r2 = 0.872666
Validation mse = 0.015503
Epoch 44
Loss = 7.0611e-02, PNorm = 35.2625, GNorm = 1.0120, lr_0 = 1.6425e-04
Loss = 8.8411e-02, PNorm = 35.2671, GNorm = 1.9037, lr_0 = 1.5966e-04
Validation rmse = 0.125270
Validation r2 = 0.871107
Validation mse = 0.015693
Epoch 45
Loss = 8.4597e-02, PNorm = 35.2717, GNorm = 1.6515, lr_0 = 1.5520e-04
Validation rmse = 0.126764
Validation r2 = 0.868015
Validation mse = 0.016069
Epoch 46
Loss = 8.3158e-02, PNorm = 35.2756, GNorm = 0.7735, lr_0 = 1.5086e-04
Loss = 8.4581e-02, PNorm = 35.2806, GNorm = 1.0101, lr_0 = 1.4664e-04
Loss = 3.8800e-02, PNorm = 35.2810, GNorm = 0.8827, lr_0 = 1.4623e-04
Validation rmse = 0.127685
Validation r2 = 0.866091
Validation mse = 0.016303
Epoch 47
Loss = 8.6664e-02, PNorm = 35.2853, GNorm = 2.0234, lr_0 = 1.4214e-04
Validation rmse = 0.124066
Validation r2 = 0.873573
Validation mse = 0.015392
Epoch 48
Loss = 7.4638e-02, PNorm = 35.2887, GNorm = 0.6310, lr_0 = 1.3816e-04
Loss = 8.5075e-02, PNorm = 35.2924, GNorm = 1.1212, lr_0 = 1.3430e-04
Validation rmse = 0.127882
Validation r2 = 0.865676
Validation mse = 0.016354
Epoch 49
Loss = 8.0180e-02, PNorm = 35.2974, GNorm = 1.9789, lr_0 = 1.3055e-04
Validation rmse = 0.126880
Validation r2 = 0.867773
Validation mse = 0.016099
Epoch 50
Loss = 8.2532e-02, PNorm = 35.2999, GNorm = 1.5381, lr_0 = 1.2690e-04
Validation rmse = 0.125371
Validation r2 = 0.870901
Validation mse = 0.015718
Epoch 51
Loss = 5.9408e-02, PNorm = 35.3046, GNorm = 0.6060, lr_0 = 1.2300e-04
Loss = 7.1865e-02, PNorm = 35.3068, GNorm = 1.5989, lr_0 = 1.1956e-04
Validation rmse = 0.122078
Validation r2 = 0.877594
Validation mse = 0.014903
Epoch 52
Loss = 7.4999e-02, PNorm = 35.3099, GNorm = 1.5850, lr_0 = 1.1622e-04
Validation rmse = 0.124332
Validation r2 = 0.873031
Validation mse = 0.015458
Epoch 53
Loss = 6.7828e-02, PNorm = 35.3135, GNorm = 0.5990, lr_0 = 1.1297e-04
Loss = 7.9122e-02, PNorm = 35.3170, GNorm = 0.9930, lr_0 = 1.0981e-04
Validation rmse = 0.123720
Validation r2 = 0.874278
Validation mse = 0.015307
Epoch 54
Loss = 8.3056e-02, PNorm = 35.3206, GNorm = 0.6505, lr_0 = 1.0644e-04
Validation rmse = 0.122392
Validation r2 = 0.876963
Validation mse = 0.014980
Epoch 55
Loss = 9.7637e-02, PNorm = 35.3236, GNorm = 1.3560, lr_0 = 1.0346e-04
Loss = 7.3178e-02, PNorm = 35.3266, GNorm = 1.0400, lr_0 = 1.0057e-04
Validation rmse = 0.124207
Validation r2 = 0.873286
Validation mse = 0.015427
Epoch 56
Loss = 8.1268e-02, PNorm = 35.3297, GNorm = 2.1410, lr_0 = 1.0000e-04
Validation rmse = 0.125033
Validation r2 = 0.871596
Validation mse = 0.015633
Epoch 57
Loss = 7.5264e-02, PNorm = 35.3333, GNorm = 0.6061, lr_0 = 1.0000e-04
Loss = 8.1958e-02, PNorm = 35.3361, GNorm = 0.7346, lr_0 = 1.0000e-04
Validation rmse = 0.125932
Validation r2 = 0.869743
Validation mse = 0.015859
Epoch 58
Loss = 7.8904e-02, PNorm = 35.3396, GNorm = 0.7328, lr_0 = 1.0000e-04
Validation rmse = 0.122932
Validation r2 = 0.875875
Validation mse = 0.015112
Epoch 59
Loss = 5.1493e-02, PNorm = 35.3424, GNorm = 1.4821, lr_0 = 1.0000e-04
Loss = 8.1476e-02, PNorm = 35.3446, GNorm = 1.4028, lr_0 = 1.0000e-04
Validation rmse = 0.122974
Validation r2 = 0.875790
Validation mse = 0.015123
Model 0 best validation rmse = 0.122078 on epoch 51
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.159683
Model 0 test r2 = 0.576669
Model 0 test mse = 0.025499
Ensemble test rmse = 0.159683
Ensemble test r2 = 0.576669
Ensemble test mse = 0.025499
Fold 4
Splitting data with seed 4
Total size = 919 | train size = 735 | val size = 184 | test size = 103
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.0836e-01, PNorm = 34.0178, GNorm = 6.7895, lr_0 = 4.5357e-04
Validation rmse = 0.311166
Validation r2 = 0.271750
Validation mse = 0.096824
Epoch 1
Loss = 8.0687e-01, PNorm = 34.0490, GNorm = 12.4520, lr_0 = 8.0714e-04
Validation rmse = 0.291394
Validation r2 = 0.361359
Validation mse = 0.084910
Epoch 2
Loss = 5.2763e-01, PNorm = 34.0978, GNorm = 4.2470, lr_0 = 9.8872e-04
Loss = 5.7511e-01, PNorm = 34.1734, GNorm = 3.2409, lr_0 = 9.6108e-04
Validation rmse = 0.242254
Validation r2 = 0.558595
Validation mse = 0.058687
Epoch 3
Loss = 3.6676e-01, PNorm = 34.2556, GNorm = 3.9211, lr_0 = 9.3421e-04
Validation rmse = 0.223210
Validation r2 = 0.625267
Validation mse = 0.049823
Epoch 4
Loss = 3.5105e-01, PNorm = 34.3340, GNorm = 3.0798, lr_0 = 9.0552e-04
Loss = 2.9729e-01, PNorm = 34.4010, GNorm = 4.9676, lr_0 = 8.8020e-04
Validation rmse = 0.199560
Validation r2 = 0.700469
Validation mse = 0.039824
Epoch 5
Loss = 2.6271e-01, PNorm = 34.4626, GNorm = 2.3859, lr_0 = 8.5559e-04
Validation rmse = 0.190566
Validation r2 = 0.726859
Validation mse = 0.036315
Epoch 6
Loss = 2.2884e-01, PNorm = 34.5070, GNorm = 1.0464, lr_0 = 8.3167e-04
Loss = 2.1038e-01, PNorm = 34.5515, GNorm = 5.5883, lr_0 = 8.0842e-04
Validation rmse = 0.161010
Validation r2 = 0.805015
Validation mse = 0.025924
Epoch 7
Loss = 1.8702e-01, PNorm = 34.5971, GNorm = 2.8112, lr_0 = 7.8359e-04
Validation rmse = 0.158684
Validation r2 = 0.810608
Validation mse = 0.025181
Epoch 8
Loss = 1.6742e-01, PNorm = 34.6337, GNorm = 4.4642, lr_0 = 7.6168e-04
Loss = 1.7462e-01, PNorm = 34.6700, GNorm = 3.0013, lr_0 = 7.4039e-04
Validation rmse = 0.143910
Validation r2 = 0.844233
Validation mse = 0.020710
Epoch 9
Loss = 1.5706e-01, PNorm = 34.7046, GNorm = 4.7004, lr_0 = 7.1969e-04
Validation rmse = 0.152407
Validation r2 = 0.825294
Validation mse = 0.023228
Epoch 10
Loss = 1.5555e-01, PNorm = 34.7315, GNorm = 3.5628, lr_0 = 6.9956e-04
Loss = 1.6080e-01, PNorm = 34.7541, GNorm = 3.5313, lr_0 = 6.8001e-04
Validation rmse = 0.145173
Validation r2 = 0.841487
Validation mse = 0.021075
Epoch 11
Loss = 1.3836e-01, PNorm = 34.7849, GNorm = 2.6157, lr_0 = 6.5912e-04
Validation rmse = 0.138204
Validation r2 = 0.856339
Validation mse = 0.019100
Epoch 12
Loss = 1.1184e-01, PNorm = 34.8067, GNorm = 1.7271, lr_0 = 6.4069e-04
Loss = 1.4200e-01, PNorm = 34.8316, GNorm = 1.4802, lr_0 = 6.2278e-04
Validation rmse = 0.135045
Validation r2 = 0.862832
Validation mse = 0.018237
Epoch 13
Loss = 1.1465e-01, PNorm = 34.8457, GNorm = 1.6231, lr_0 = 6.0537e-04
Validation rmse = 0.133879
Validation r2 = 0.865190
Validation mse = 0.017924
Epoch 14
Loss = 1.2248e-01, PNorm = 34.8663, GNorm = 3.8533, lr_0 = 5.8678e-04
Loss = 1.4003e-01, PNorm = 34.8814, GNorm = 5.3619, lr_0 = 5.7037e-04
Validation rmse = 0.156806
Validation r2 = 0.815064
Validation mse = 0.024588
Epoch 15
Loss = 1.4119e-01, PNorm = 34.9025, GNorm = 2.8347, lr_0 = 5.5442e-04
Validation rmse = 0.130186
Validation r2 = 0.872526
Validation mse = 0.016948
Epoch 16
Loss = 1.0904e-01, PNorm = 34.9221, GNorm = 0.8350, lr_0 = 5.3892e-04
Validation rmse = 0.144778
Validation r2 = 0.842348
Validation mse = 0.020961
Epoch 17
Loss = 1.0116e-01, PNorm = 34.9390, GNorm = 4.8911, lr_0 = 5.2237e-04
Loss = 1.0650e-01, PNorm = 34.9564, GNorm = 1.7866, lr_0 = 5.0777e-04
Validation rmse = 0.131964
Validation r2 = 0.869019
Validation mse = 0.017415
Epoch 18
Loss = 1.0174e-01, PNorm = 34.9713, GNorm = 1.0221, lr_0 = 4.9357e-04
Validation rmse = 0.136746
Validation r2 = 0.859355
Validation mse = 0.018699
Epoch 19
Loss = 9.6103e-02, PNorm = 34.9829, GNorm = 3.6949, lr_0 = 4.7977e-04
Loss = 1.2036e-01, PNorm = 34.9957, GNorm = 4.6759, lr_0 = 4.6636e-04
Validation rmse = 0.133038
Validation r2 = 0.866880
Validation mse = 0.017699
Epoch 20
Loss = 1.0838e-01, PNorm = 35.0096, GNorm = 0.9006, lr_0 = 4.5332e-04
Validation rmse = 0.134837
Validation r2 = 0.863254
Validation mse = 0.018181
Epoch 21
Loss = 1.0880e-01, PNorm = 35.0235, GNorm = 2.0012, lr_0 = 4.3940e-04
Loss = 1.0681e-01, PNorm = 35.0360, GNorm = 1.7557, lr_0 = 4.2711e-04
Validation rmse = 0.134019
Validation r2 = 0.864908
Validation mse = 0.017961
Epoch 22
Loss = 8.3409e-02, PNorm = 35.0462, GNorm = 0.5870, lr_0 = 4.1517e-04
Validation rmse = 0.132358
Validation r2 = 0.868236
Validation mse = 0.017519
Epoch 23
Loss = 9.2196e-02, PNorm = 35.0601, GNorm = 2.5089, lr_0 = 4.0356e-04
Loss = 9.8953e-02, PNorm = 35.0734, GNorm = 1.9699, lr_0 = 3.9228e-04
Validation rmse = 0.130828
Validation r2 = 0.871265
Validation mse = 0.017116
Epoch 24
Loss = 8.9296e-02, PNorm = 35.0838, GNorm = 1.3299, lr_0 = 3.8023e-04
Validation rmse = 0.133925
Validation r2 = 0.865098
Validation mse = 0.017936
Epoch 25
Loss = 1.0780e-01, PNorm = 35.0953, GNorm = 2.7064, lr_0 = 3.6960e-04
Loss = 9.3182e-02, PNorm = 35.1084, GNorm = 2.9929, lr_0 = 3.5927e-04
Validation rmse = 0.138258
Validation r2 = 0.856228
Validation mse = 0.019115
Epoch 26
Loss = 9.1546e-02, PNorm = 35.1147, GNorm = 2.0330, lr_0 = 3.4922e-04
Validation rmse = 0.130354
Validation r2 = 0.872195
Validation mse = 0.016992
Epoch 27
Loss = 7.2270e-02, PNorm = 35.1256, GNorm = 2.0586, lr_0 = 3.3850e-04
Loss = 8.9068e-02, PNorm = 35.1366, GNorm = 0.9206, lr_0 = 3.2903e-04
Validation rmse = 0.132428
Validation r2 = 0.868097
Validation mse = 0.017537
Epoch 28
Loss = 8.6260e-02, PNorm = 35.1472, GNorm = 0.9512, lr_0 = 3.1984e-04
Validation rmse = 0.141726
Validation r2 = 0.848925
Validation mse = 0.020086
Epoch 29
Loss = 9.8824e-02, PNorm = 35.1550, GNorm = 0.7821, lr_0 = 3.1089e-04
Loss = 8.4127e-02, PNorm = 35.1631, GNorm = 0.8568, lr_0 = 3.0220e-04
Validation rmse = 0.131553
Validation r2 = 0.869834
Validation mse = 0.017306
Epoch 30
Loss = 8.2283e-02, PNorm = 35.1716, GNorm = 1.8906, lr_0 = 2.9375e-04
Validation rmse = 0.129866
Validation r2 = 0.873151
Validation mse = 0.016865
Epoch 31
Loss = 8.3070e-02, PNorm = 35.1805, GNorm = 1.8665, lr_0 = 2.8473e-04
Loss = 8.9413e-02, PNorm = 35.1891, GNorm = 1.2361, lr_0 = 2.7677e-04
Validation rmse = 0.137723
Validation r2 = 0.857337
Validation mse = 0.018968
Epoch 32
Loss = 8.9643e-02, PNorm = 35.1969, GNorm = 2.7357, lr_0 = 2.6903e-04
Validation rmse = 0.131532
Validation r2 = 0.869875
Validation mse = 0.017301
Epoch 33
Loss = 9.6569e-02, PNorm = 35.2034, GNorm = 1.3811, lr_0 = 2.6151e-04
Validation rmse = 0.141297
Validation r2 = 0.849837
Validation mse = 0.019965
Epoch 34
Loss = 7.7476e-02, PNorm = 35.2109, GNorm = 3.4296, lr_0 = 2.5348e-04
Loss = 8.1902e-02, PNorm = 35.2177, GNorm = 3.3199, lr_0 = 2.4639e-04
Validation rmse = 0.132024
Validation r2 = 0.868901
Validation mse = 0.017430
Epoch 35
Loss = 6.9011e-02, PNorm = 35.2256, GNorm = 2.1179, lr_0 = 2.3950e-04
Validation rmse = 0.131196
Validation r2 = 0.870539
Validation mse = 0.017212
Epoch 36
Loss = 8.7300e-02, PNorm = 35.2318, GNorm = 0.6414, lr_0 = 2.3281e-04
Loss = 7.7310e-02, PNorm = 35.2379, GNorm = 2.8921, lr_0 = 2.2630e-04
Validation rmse = 0.130816
Validation r2 = 0.871288
Validation mse = 0.017113
Epoch 37
Loss = 7.2174e-02, PNorm = 35.2438, GNorm = 1.2544, lr_0 = 2.1935e-04
Validation rmse = 0.130122
Validation r2 = 0.872651
Validation mse = 0.016932
Epoch 38
Loss = 8.0503e-02, PNorm = 35.2501, GNorm = 1.9020, lr_0 = 2.1321e-04
Loss = 7.8016e-02, PNorm = 35.2557, GNorm = 2.4798, lr_0 = 2.0725e-04
Validation rmse = 0.138482
Validation r2 = 0.855760
Validation mse = 0.019177
Epoch 39
Loss = 8.3755e-02, PNorm = 35.2626, GNorm = 1.9324, lr_0 = 2.0146e-04
Validation rmse = 0.131250
Validation r2 = 0.870433
Validation mse = 0.017227
Epoch 40
Loss = 7.3159e-02, PNorm = 35.2668, GNorm = 0.6769, lr_0 = 1.9583e-04
Loss = 7.6736e-02, PNorm = 35.2724, GNorm = 3.2597, lr_0 = 1.9035e-04
Validation rmse = 0.144949
Validation r2 = 0.841975
Validation mse = 0.021010
Epoch 41
Loss = 9.4157e-02, PNorm = 35.2781, GNorm = 0.5746, lr_0 = 1.8451e-04
Validation rmse = 0.131558
Validation r2 = 0.869823
Validation mse = 0.017308
Epoch 42
Loss = 8.6994e-02, PNorm = 35.2832, GNorm = 1.8905, lr_0 = 1.7935e-04
Loss = 7.2687e-02, PNorm = 35.2899, GNorm = 2.4025, lr_0 = 1.7433e-04
Validation rmse = 0.131710
Validation r2 = 0.869523
Validation mse = 0.017348
Epoch 43
Loss = 6.2078e-02, PNorm = 35.2941, GNorm = 0.6094, lr_0 = 1.6946e-04
Validation rmse = 0.135058
Validation r2 = 0.862805
Validation mse = 0.018241
Epoch 44
Loss = 1.0165e-01, PNorm = 35.2987, GNorm = 1.2575, lr_0 = 1.6425e-04
Loss = 6.9703e-02, PNorm = 35.3021, GNorm = 1.4582, lr_0 = 1.5966e-04
Validation rmse = 0.133058
Validation r2 = 0.866840
Validation mse = 0.017704
Epoch 45
Loss = 8.3251e-02, PNorm = 35.3064, GNorm = 2.4577, lr_0 = 1.5520e-04
Validation rmse = 0.131166
Validation r2 = 0.870599
Validation mse = 0.017205
Epoch 46
Loss = 6.8783e-02, PNorm = 35.3116, GNorm = 1.3224, lr_0 = 1.5086e-04
Loss = 7.3432e-02, PNorm = 35.3156, GNorm = 0.7695, lr_0 = 1.4664e-04
Loss = 5.9942e-02, PNorm = 35.3160, GNorm = 0.6605, lr_0 = 1.4623e-04
Validation rmse = 0.131827
Validation r2 = 0.869292
Validation mse = 0.017378
Epoch 47
Loss = 6.7570e-02, PNorm = 35.3200, GNorm = 1.4011, lr_0 = 1.4214e-04
Validation rmse = 0.132091
Validation r2 = 0.868767
Validation mse = 0.017448
Epoch 48
Loss = 7.5894e-02, PNorm = 35.3241, GNorm = 0.8346, lr_0 = 1.3816e-04
Loss = 6.6987e-02, PNorm = 35.3279, GNorm = 0.8072, lr_0 = 1.3430e-04
Validation rmse = 0.130807
Validation r2 = 0.871306
Validation mse = 0.017111
Epoch 49
Loss = 6.9976e-02, PNorm = 35.3310, GNorm = 1.4658, lr_0 = 1.3055e-04
Validation rmse = 0.130552
Validation r2 = 0.871808
Validation mse = 0.017044
Epoch 50
Loss = 6.7527e-02, PNorm = 35.3346, GNorm = 0.6577, lr_0 = 1.2690e-04
Validation rmse = 0.129829
Validation r2 = 0.873223
Validation mse = 0.016856
Epoch 51
Loss = 8.1460e-02, PNorm = 35.3384, GNorm = 1.6531, lr_0 = 1.2300e-04
Loss = 6.5897e-02, PNorm = 35.3424, GNorm = 1.6242, lr_0 = 1.1956e-04
Validation rmse = 0.133298
Validation r2 = 0.866359
Validation mse = 0.017768
Epoch 52
Loss = 7.3168e-02, PNorm = 35.3454, GNorm = 0.5602, lr_0 = 1.1622e-04
Validation rmse = 0.132573
Validation r2 = 0.867807
Validation mse = 0.017576
Epoch 53
Loss = 5.4446e-02, PNorm = 35.3480, GNorm = 0.6908, lr_0 = 1.1297e-04
Loss = 6.9219e-02, PNorm = 35.3510, GNorm = 1.3355, lr_0 = 1.0981e-04
Validation rmse = 0.134686
Validation r2 = 0.863561
Validation mse = 0.018140
Epoch 54
Loss = 6.9098e-02, PNorm = 35.3555, GNorm = 0.6864, lr_0 = 1.0644e-04
Validation rmse = 0.132992
Validation r2 = 0.866970
Validation mse = 0.017687
Epoch 55
Loss = 6.1817e-02, PNorm = 35.3581, GNorm = 2.2099, lr_0 = 1.0346e-04
Loss = 6.5553e-02, PNorm = 35.3599, GNorm = 0.4768, lr_0 = 1.0057e-04
Validation rmse = 0.133181
Validation r2 = 0.866592
Validation mse = 0.017737
Epoch 56
Loss = 7.4164e-02, PNorm = 35.3633, GNorm = 2.1420, lr_0 = 1.0000e-04
Validation rmse = 0.130851
Validation r2 = 0.871220
Validation mse = 0.017122
Epoch 57
Loss = 5.8314e-02, PNorm = 35.3668, GNorm = 1.1772, lr_0 = 1.0000e-04
Loss = 7.3064e-02, PNorm = 35.3694, GNorm = 0.5247, lr_0 = 1.0000e-04
Validation rmse = 0.130057
Validation r2 = 0.872777
Validation mse = 0.016915
Epoch 58
Loss = 6.6601e-02, PNorm = 35.3718, GNorm = 1.7332, lr_0 = 1.0000e-04
Validation rmse = 0.131022
Validation r2 = 0.870883
Validation mse = 0.017167
Epoch 59
Loss = 8.1067e-02, PNorm = 35.3747, GNorm = 0.8013, lr_0 = 1.0000e-04
Loss = 6.3282e-02, PNorm = 35.3777, GNorm = 1.4745, lr_0 = 1.0000e-04
Validation rmse = 0.131513
Validation r2 = 0.869914
Validation mse = 0.017296
Model 0 best validation rmse = 0.129829 on epoch 50
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.173183
Model 0 test r2 = 0.502059
Model 0 test mse = 0.029993
Ensemble test rmse = 0.173183
Ensemble test r2 = 0.502059
Ensemble test mse = 0.029993
Fold 5
Splitting data with seed 5
Total size = 919 | train size = 735 | val size = 184 | test size = 103
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1154e-01, PNorm = 34.0167, GNorm = 6.2238, lr_0 = 4.5357e-04
Validation rmse = 0.313366
Validation r2 = 0.223489
Validation mse = 0.098198
Epoch 1
Loss = 6.4813e-01, PNorm = 34.0588, GNorm = 3.4526, lr_0 = 8.0714e-04
Validation rmse = 0.266739
Validation r2 = 0.437378
Validation mse = 0.071150
Epoch 2
Loss = 4.9262e-01, PNorm = 34.1245, GNorm = 6.6410, lr_0 = 9.8872e-04
Loss = 5.7877e-01, PNorm = 34.1997, GNorm = 8.5895, lr_0 = 9.6108e-04
Validation rmse = 0.227753
Validation r2 = 0.589821
Validation mse = 0.051872
Epoch 3
Loss = 3.6547e-01, PNorm = 34.2701, GNorm = 6.3008, lr_0 = 9.3421e-04
Validation rmse = 0.213397
Validation r2 = 0.639901
Validation mse = 0.045538
Epoch 4
Loss = 2.7183e-01, PNorm = 34.3427, GNorm = 1.3853, lr_0 = 9.0552e-04
Loss = 3.1113e-01, PNorm = 34.4020, GNorm = 6.0671, lr_0 = 8.8020e-04
Validation rmse = 0.208196
Validation r2 = 0.657239
Validation mse = 0.043346
Epoch 5
Loss = 2.3027e-01, PNorm = 34.4481, GNorm = 3.8106, lr_0 = 8.5559e-04
Validation rmse = 0.180455
Validation r2 = 0.742497
Validation mse = 0.032564
Epoch 6
Loss = 1.3464e-01, PNorm = 34.4964, GNorm = 0.7445, lr_0 = 8.3167e-04
Loss = 1.9735e-01, PNorm = 34.5373, GNorm = 1.8758, lr_0 = 8.0842e-04
Validation rmse = 0.179410
Validation r2 = 0.745472
Validation mse = 0.032188
Epoch 7
Loss = 2.0485e-01, PNorm = 34.5806, GNorm = 4.2813, lr_0 = 7.8359e-04
Validation rmse = 0.190416
Validation r2 = 0.713284
Validation mse = 0.036258
Epoch 8
Loss = 2.1530e-01, PNorm = 34.6147, GNorm = 4.3519, lr_0 = 7.6168e-04
Loss = 1.5331e-01, PNorm = 34.6468, GNorm = 4.3232, lr_0 = 7.4039e-04
Validation rmse = 0.157718
Validation r2 = 0.803298
Validation mse = 0.024875
Epoch 9
Loss = 1.3115e-01, PNorm = 34.6761, GNorm = 4.4855, lr_0 = 7.1969e-04
Validation rmse = 0.151652
Validation r2 = 0.818138
Validation mse = 0.022998
Epoch 10
Loss = 1.0897e-01, PNorm = 34.7019, GNorm = 0.9406, lr_0 = 6.9956e-04
Loss = 1.4899e-01, PNorm = 34.7290, GNorm = 6.9984, lr_0 = 6.8001e-04
Validation rmse = 0.174003
Validation r2 = 0.760582
Validation mse = 0.030277
Epoch 11
Loss = 1.6700e-01, PNorm = 34.7504, GNorm = 3.6326, lr_0 = 6.5912e-04
Validation rmse = 0.164509
Validation r2 = 0.785996
Validation mse = 0.027063
Epoch 12
Loss = 1.5472e-01, PNorm = 34.7728, GNorm = 2.6531, lr_0 = 6.4069e-04
Loss = 1.2787e-01, PNorm = 34.7898, GNorm = 1.4308, lr_0 = 6.2278e-04
Validation rmse = 0.154797
Validation r2 = 0.810517
Validation mse = 0.023962
Epoch 13
Loss = 1.3740e-01, PNorm = 34.8114, GNorm = 1.6107, lr_0 = 6.0537e-04
Validation rmse = 0.144175
Validation r2 = 0.835629
Validation mse = 0.020786
Epoch 14
Loss = 1.1652e-01, PNorm = 34.8301, GNorm = 0.6022, lr_0 = 5.8678e-04
Loss = 1.2202e-01, PNorm = 34.8433, GNorm = 3.9422, lr_0 = 5.7037e-04
Validation rmse = 0.142496
Validation r2 = 0.839435
Validation mse = 0.020305
Epoch 15
Loss = 1.1009e-01, PNorm = 34.8558, GNorm = 0.7677, lr_0 = 5.5442e-04
Validation rmse = 0.138351
Validation r2 = 0.848641
Validation mse = 0.019141
Epoch 16
Loss = 1.1107e-01, PNorm = 34.8682, GNorm = 1.2782, lr_0 = 5.3892e-04
Validation rmse = 0.144523
Validation r2 = 0.834834
Validation mse = 0.020887
Epoch 17
Loss = 8.5166e-02, PNorm = 34.8830, GNorm = 2.1578, lr_0 = 5.2237e-04
Loss = 1.2805e-01, PNorm = 34.8931, GNorm = 3.4436, lr_0 = 5.0777e-04
Validation rmse = 0.164235
Validation r2 = 0.786708
Validation mse = 0.026973
Epoch 18
Loss = 1.4695e-01, PNorm = 34.9054, GNorm = 5.7507, lr_0 = 4.9357e-04
Validation rmse = 0.141158
Validation r2 = 0.842438
Validation mse = 0.019925
Epoch 19
Loss = 9.3610e-02, PNorm = 34.9221, GNorm = 0.5959, lr_0 = 4.7977e-04
Loss = 1.3739e-01, PNorm = 34.9350, GNorm = 1.8728, lr_0 = 4.6636e-04
Validation rmse = 0.152435
Validation r2 = 0.816255
Validation mse = 0.023237
Epoch 20
Loss = 1.3975e-01, PNorm = 34.9507, GNorm = 2.0054, lr_0 = 4.5332e-04
Validation rmse = 0.139915
Validation r2 = 0.845199
Validation mse = 0.019576
Epoch 21
Loss = 8.4994e-02, PNorm = 34.9640, GNorm = 1.9877, lr_0 = 4.3940e-04
Loss = 1.0791e-01, PNorm = 34.9729, GNorm = 0.6798, lr_0 = 4.2711e-04
Validation rmse = 0.135874
Validation r2 = 0.854012
Validation mse = 0.018462
Epoch 22
Loss = 9.3122e-02, PNorm = 34.9836, GNorm = 1.4209, lr_0 = 4.1517e-04
Validation rmse = 0.136484
Validation r2 = 0.852698
Validation mse = 0.018628
Epoch 23
Loss = 8.4657e-02, PNorm = 34.9927, GNorm = 0.8830, lr_0 = 4.0356e-04
Loss = 9.8839e-02, PNorm = 35.0010, GNorm = 3.1370, lr_0 = 3.9228e-04
Validation rmse = 0.138421
Validation r2 = 0.848488
Validation mse = 0.019160
Epoch 24
Loss = 8.9168e-02, PNorm = 35.0130, GNorm = 1.8613, lr_0 = 3.8023e-04
Validation rmse = 0.141118
Validation r2 = 0.842526
Validation mse = 0.019914
Epoch 25
Loss = 6.4718e-02, PNorm = 35.0221, GNorm = 1.5153, lr_0 = 3.6960e-04
Loss = 9.3197e-02, PNorm = 35.0293, GNorm = 0.3757, lr_0 = 3.5927e-04
Validation rmse = 0.134435
Validation r2 = 0.857088
Validation mse = 0.018073
Epoch 26
Loss = 9.6413e-02, PNorm = 35.0375, GNorm = 4.0143, lr_0 = 3.4922e-04
Validation rmse = 0.136907
Validation r2 = 0.851784
Validation mse = 0.018744
Epoch 27
Loss = 9.2439e-02, PNorm = 35.0469, GNorm = 1.8898, lr_0 = 3.3850e-04
Loss = 8.6439e-02, PNorm = 35.0552, GNorm = 0.6002, lr_0 = 3.2903e-04
Validation rmse = 0.141357
Validation r2 = 0.841993
Validation mse = 0.019982
Epoch 28
Loss = 8.6418e-02, PNorm = 35.0628, GNorm = 2.3669, lr_0 = 3.1984e-04
Validation rmse = 0.133669
Validation r2 = 0.858713
Validation mse = 0.017867
Epoch 29
Loss = 8.2174e-02, PNorm = 35.0697, GNorm = 1.8492, lr_0 = 3.1089e-04
Loss = 9.0807e-02, PNorm = 35.0771, GNorm = 1.0420, lr_0 = 3.0220e-04
Validation rmse = 0.138728
Validation r2 = 0.847815
Validation mse = 0.019245
Epoch 30
Loss = 7.9692e-02, PNorm = 35.0856, GNorm = 0.6116, lr_0 = 2.9375e-04
Validation rmse = 0.137068
Validation r2 = 0.851434
Validation mse = 0.018788
Epoch 31
Loss = 8.9184e-02, PNorm = 35.0936, GNorm = 2.2327, lr_0 = 2.8473e-04
Loss = 9.7164e-02, PNorm = 35.1011, GNorm = 1.7509, lr_0 = 2.7677e-04
Validation rmse = 0.136614
Validation r2 = 0.852418
Validation mse = 0.018663
Epoch 32
Loss = 8.0982e-02, PNorm = 35.1090, GNorm = 0.6366, lr_0 = 2.6903e-04
Validation rmse = 0.132954
Validation r2 = 0.860220
Validation mse = 0.017677
Epoch 33
Loss = 7.3630e-02, PNorm = 35.1162, GNorm = 2.7739, lr_0 = 2.6151e-04
Validation rmse = 0.136161
Validation r2 = 0.853396
Validation mse = 0.018540
Epoch 34
Loss = 9.6224e-02, PNorm = 35.1218, GNorm = 0.7745, lr_0 = 2.5348e-04
Loss = 8.0848e-02, PNorm = 35.1302, GNorm = 0.4780, lr_0 = 2.4639e-04
Validation rmse = 0.134810
Validation r2 = 0.856289
Validation mse = 0.018174
Epoch 35
Loss = 7.7617e-02, PNorm = 35.1345, GNorm = 0.6268, lr_0 = 2.3950e-04
Validation rmse = 0.131915
Validation r2 = 0.862397
Validation mse = 0.017401
Epoch 36
Loss = 8.7157e-02, PNorm = 35.1411, GNorm = 0.5999, lr_0 = 2.3281e-04
Loss = 8.6106e-02, PNorm = 35.1472, GNorm = 1.9611, lr_0 = 2.2630e-04
Validation rmse = 0.136128
Validation r2 = 0.853467
Validation mse = 0.018531
Epoch 37
Loss = 7.5600e-02, PNorm = 35.1539, GNorm = 0.8779, lr_0 = 2.1935e-04
Validation rmse = 0.137837
Validation r2 = 0.849764
Validation mse = 0.018999
Epoch 38
Loss = 8.3238e-02, PNorm = 35.1589, GNorm = 0.6100, lr_0 = 2.1321e-04
Loss = 7.8209e-02, PNorm = 35.1656, GNorm = 1.6632, lr_0 = 2.0725e-04
Validation rmse = 0.135722
Validation r2 = 0.854338
Validation mse = 0.018421
Epoch 39
Loss = 8.1519e-02, PNorm = 35.1706, GNorm = 2.3983, lr_0 = 2.0146e-04
Validation rmse = 0.133846
Validation r2 = 0.858339
Validation mse = 0.017915
Epoch 40
Loss = 1.0282e-01, PNorm = 35.1754, GNorm = 1.2396, lr_0 = 1.9583e-04
Loss = 7.8951e-02, PNorm = 35.1795, GNorm = 0.8336, lr_0 = 1.9035e-04
Validation rmse = 0.132414
Validation r2 = 0.861352
Validation mse = 0.017533
Epoch 41
Loss = 7.5793e-02, PNorm = 35.1845, GNorm = 1.5128, lr_0 = 1.8451e-04
Validation rmse = 0.136207
Validation r2 = 0.853296
Validation mse = 0.018552
Epoch 42
Loss = 7.7047e-02, PNorm = 35.1892, GNorm = 1.0385, lr_0 = 1.7935e-04
Loss = 7.4679e-02, PNorm = 35.1950, GNorm = 0.6782, lr_0 = 1.7433e-04
Validation rmse = 0.134183
Validation r2 = 0.857624
Validation mse = 0.018005
Epoch 43
Loss = 7.4675e-02, PNorm = 35.1986, GNorm = 1.9296, lr_0 = 1.6946e-04
Validation rmse = 0.134386
Validation r2 = 0.857192
Validation mse = 0.018060
Epoch 44
Loss = 7.7456e-02, PNorm = 35.2040, GNorm = 0.6028, lr_0 = 1.6425e-04
Loss = 7.0638e-02, PNorm = 35.2085, GNorm = 0.6285, lr_0 = 1.5966e-04
Validation rmse = 0.133088
Validation r2 = 0.859937
Validation mse = 0.017712
Epoch 45
Loss = 6.5561e-02, PNorm = 35.2138, GNorm = 2.1433, lr_0 = 1.5520e-04
Validation rmse = 0.131938
Validation r2 = 0.862348
Validation mse = 0.017408
Epoch 46
Loss = 7.6912e-02, PNorm = 35.2166, GNorm = 1.5757, lr_0 = 1.5086e-04
Loss = 7.4690e-02, PNorm = 35.2207, GNorm = 1.1156, lr_0 = 1.4664e-04
Loss = 6.6857e-02, PNorm = 35.2210, GNorm = 0.8853, lr_0 = 1.4623e-04
Validation rmse = 0.132207
Validation r2 = 0.861785
Validation mse = 0.017479
Epoch 47
Loss = 7.2931e-02, PNorm = 35.2249, GNorm = 1.2110, lr_0 = 1.4214e-04
Validation rmse = 0.131806
Validation r2 = 0.862624
Validation mse = 0.017373
Epoch 48
Loss = 7.1383e-02, PNorm = 35.2286, GNorm = 0.8116, lr_0 = 1.3816e-04
Loss = 7.3610e-02, PNorm = 35.2318, GNorm = 1.8019, lr_0 = 1.3430e-04
Validation rmse = 0.133734
Validation r2 = 0.858574
Validation mse = 0.017885
Epoch 49
Loss = 7.7690e-02, PNorm = 35.2356, GNorm = 0.9595, lr_0 = 1.3055e-04
Validation rmse = 0.130618
Validation r2 = 0.865087
Validation mse = 0.017061
Epoch 50
Loss = 6.4359e-02, PNorm = 35.2395, GNorm = 1.3428, lr_0 = 1.2690e-04
Validation rmse = 0.131673
Validation r2 = 0.862901
Validation mse = 0.017338
Epoch 51
Loss = 7.6062e-02, PNorm = 35.2432, GNorm = 0.8156, lr_0 = 1.2300e-04
Loss = 6.9071e-02, PNorm = 35.2467, GNorm = 2.1507, lr_0 = 1.1956e-04
Validation rmse = 0.136326
Validation r2 = 0.853040
Validation mse = 0.018585
Epoch 52
Loss = 7.0974e-02, PNorm = 35.2498, GNorm = 1.5448, lr_0 = 1.1622e-04
Validation rmse = 0.131542
Validation r2 = 0.863172
Validation mse = 0.017303
Epoch 53
Loss = 9.3044e-02, PNorm = 35.2521, GNorm = 1.3613, lr_0 = 1.1297e-04
Loss = 6.3827e-02, PNorm = 35.2553, GNorm = 0.9252, lr_0 = 1.0981e-04
Validation rmse = 0.132034
Validation r2 = 0.862147
Validation mse = 0.017433
Epoch 54
Loss = 6.6612e-02, PNorm = 35.2591, GNorm = 0.6153, lr_0 = 1.0644e-04
Validation rmse = 0.131494
Validation r2 = 0.863273
Validation mse = 0.017291
Epoch 55
Loss = 7.9153e-02, PNorm = 35.2614, GNorm = 0.9105, lr_0 = 1.0346e-04
Loss = 7.1965e-02, PNorm = 35.2649, GNorm = 0.7011, lr_0 = 1.0057e-04
Validation rmse = 0.131670
Validation r2 = 0.862906
Validation mse = 0.017337
Epoch 56
Loss = 6.6511e-02, PNorm = 35.2675, GNorm = 2.0464, lr_0 = 1.0000e-04
Validation rmse = 0.131210
Validation r2 = 0.863863
Validation mse = 0.017216
Epoch 57
Loss = 7.0033e-02, PNorm = 35.2703, GNorm = 1.0313, lr_0 = 1.0000e-04
Loss = 6.6400e-02, PNorm = 35.2731, GNorm = 0.7741, lr_0 = 1.0000e-04
Validation rmse = 0.130950
Validation r2 = 0.864401
Validation mse = 0.017148
Epoch 58
Loss = 6.6773e-02, PNorm = 35.2762, GNorm = 1.3725, lr_0 = 1.0000e-04
Validation rmse = 0.135466
Validation r2 = 0.854887
Validation mse = 0.018351
Epoch 59
Loss = 5.5012e-02, PNorm = 35.2791, GNorm = 0.3447, lr_0 = 1.0000e-04
Loss = 7.3892e-02, PNorm = 35.2822, GNorm = 1.5331, lr_0 = 1.0000e-04
Validation rmse = 0.132665
Validation r2 = 0.860826
Validation mse = 0.017600
Model 0 best validation rmse = 0.130618 on epoch 49
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.202772
Model 0 test r2 = 0.317378
Model 0 test mse = 0.041116
Ensemble test rmse = 0.202772
Ensemble test r2 = 0.317378
Ensemble test mse = 0.041116
Fold 6
Splitting data with seed 6
Total size = 919 | train size = 735 | val size = 184 | test size = 103
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.5158e-01, PNorm = 34.0178, GNorm = 8.5577, lr_0 = 4.5357e-04
Validation rmse = 0.289207
Validation r2 = 0.311089
Validation mse = 0.083641
Epoch 1
Loss = 6.7328e-01, PNorm = 34.0511, GNorm = 2.2391, lr_0 = 8.0714e-04
Validation rmse = 0.260070
Validation r2 = 0.442906
Validation mse = 0.067637
Epoch 2
Loss = 5.0514e-01, PNorm = 34.1236, GNorm = 7.1654, lr_0 = 9.8872e-04
Loss = 5.4850e-01, PNorm = 34.2046, GNorm = 1.7457, lr_0 = 9.6108e-04
Validation rmse = 0.207192
Validation r2 = 0.646416
Validation mse = 0.042929
Epoch 3
Loss = 3.9537e-01, PNorm = 34.2831, GNorm = 5.1494, lr_0 = 9.3421e-04
Validation rmse = 0.213778
Validation r2 = 0.623579
Validation mse = 0.045701
Epoch 4
Loss = 3.2229e-01, PNorm = 34.3521, GNorm = 1.4590, lr_0 = 9.0552e-04
Loss = 3.0732e-01, PNorm = 34.4146, GNorm = 2.3875, lr_0 = 8.8020e-04
Validation rmse = 0.187944
Validation r2 = 0.709059
Validation mse = 0.035323
Epoch 5
Loss = 2.4398e-01, PNorm = 34.4663, GNorm = 1.0928, lr_0 = 8.5559e-04
Validation rmse = 0.165685
Validation r2 = 0.773895
Validation mse = 0.027451
Epoch 6
Loss = 1.8649e-01, PNorm = 34.5195, GNorm = 3.6516, lr_0 = 8.3167e-04
Loss = 2.5632e-01, PNorm = 34.5621, GNorm = 1.3860, lr_0 = 8.0842e-04
Validation rmse = 0.167076
Validation r2 = 0.770080
Validation mse = 0.027915
Epoch 7
Loss = 1.8782e-01, PNorm = 34.6128, GNorm = 1.7623, lr_0 = 7.8359e-04
Validation rmse = 0.155240
Validation r2 = 0.801504
Validation mse = 0.024099
Epoch 8
Loss = 1.5743e-01, PNorm = 34.6546, GNorm = 3.5378, lr_0 = 7.6168e-04
Loss = 1.7025e-01, PNorm = 34.6869, GNorm = 1.5871, lr_0 = 7.4039e-04
Validation rmse = 0.160948
Validation r2 = 0.786638
Validation mse = 0.025904
Epoch 9
Loss = 1.4674e-01, PNorm = 34.7189, GNorm = 1.1532, lr_0 = 7.1969e-04
Validation rmse = 0.145440
Validation r2 = 0.825775
Validation mse = 0.021153
Epoch 10
Loss = 1.1490e-01, PNorm = 34.7525, GNorm = 0.9817, lr_0 = 6.9956e-04
Loss = 1.4163e-01, PNorm = 34.7831, GNorm = 1.1512, lr_0 = 6.8001e-04
Validation rmse = 0.146475
Validation r2 = 0.823284
Validation mse = 0.021455
Epoch 11
Loss = 1.6995e-01, PNorm = 34.8140, GNorm = 3.1089, lr_0 = 6.5912e-04
Validation rmse = 0.138703
Validation r2 = 0.841540
Validation mse = 0.019239
Epoch 12
Loss = 2.0897e-01, PNorm = 34.8390, GNorm = 2.5043, lr_0 = 6.4069e-04
Loss = 1.3467e-01, PNorm = 34.8605, GNorm = 2.6483, lr_0 = 6.2278e-04
Validation rmse = 0.151259
Validation r2 = 0.811554
Validation mse = 0.022879
Epoch 13
Loss = 1.3312e-01, PNorm = 34.8822, GNorm = 4.5586, lr_0 = 6.0537e-04
Validation rmse = 0.169459
Validation r2 = 0.763476
Validation mse = 0.028716
Epoch 14
Loss = 1.4796e-01, PNorm = 34.8999, GNorm = 7.1761, lr_0 = 5.8678e-04
Loss = 1.4976e-01, PNorm = 34.9222, GNorm = 0.7250, lr_0 = 5.7037e-04
Validation rmse = 0.134594
Validation r2 = 0.850790
Validation mse = 0.018116
Epoch 15
Loss = 1.1908e-01, PNorm = 34.9446, GNorm = 0.6484, lr_0 = 5.5442e-04
Validation rmse = 0.132442
Validation r2 = 0.855522
Validation mse = 0.017541
Epoch 16
Loss = 1.0970e-01, PNorm = 34.9648, GNorm = 3.7788, lr_0 = 5.3892e-04
Validation rmse = 0.136345
Validation r2 = 0.846883
Validation mse = 0.018590
Epoch 17
Loss = 9.1550e-02, PNorm = 34.9807, GNorm = 1.7103, lr_0 = 5.2237e-04
Loss = 1.1791e-01, PNorm = 34.9969, GNorm = 2.2090, lr_0 = 5.0777e-04
Validation rmse = 0.136836
Validation r2 = 0.845777
Validation mse = 0.018724
Epoch 18
Loss = 1.0857e-01, PNorm = 35.0079, GNorm = 0.7778, lr_0 = 4.9357e-04
Validation rmse = 0.127288
Validation r2 = 0.866548
Validation mse = 0.016202
Epoch 19
Loss = 8.7628e-02, PNorm = 35.0224, GNorm = 1.8153, lr_0 = 4.7977e-04
Loss = 1.0579e-01, PNorm = 35.0386, GNorm = 1.5426, lr_0 = 4.6636e-04
Validation rmse = 0.124642
Validation r2 = 0.872039
Validation mse = 0.015536
Epoch 20
Loss = 8.9960e-02, PNorm = 35.0514, GNorm = 1.0781, lr_0 = 4.5332e-04
Validation rmse = 0.130061
Validation r2 = 0.860672
Validation mse = 0.016916
Epoch 21
Loss = 1.2623e-01, PNorm = 35.0631, GNorm = 3.1898, lr_0 = 4.3940e-04
Loss = 9.6109e-02, PNorm = 35.0772, GNorm = 0.9315, lr_0 = 4.2711e-04
Validation rmse = 0.132054
Validation r2 = 0.856368
Validation mse = 0.017438
Epoch 22
Loss = 9.3178e-02, PNorm = 35.0880, GNorm = 2.6170, lr_0 = 4.1517e-04
Validation rmse = 0.125429
Validation r2 = 0.870418
Validation mse = 0.015733
Epoch 23
Loss = 6.1302e-02, PNorm = 35.1007, GNorm = 0.7161, lr_0 = 4.0356e-04
Loss = 1.0396e-01, PNorm = 35.1118, GNorm = 0.8462, lr_0 = 3.9228e-04
Validation rmse = 0.125521
Validation r2 = 0.870228
Validation mse = 0.015756
Epoch 24
Loss = 8.3457e-02, PNorm = 35.1243, GNorm = 0.5823, lr_0 = 3.8023e-04
Validation rmse = 0.125848
Validation r2 = 0.869552
Validation mse = 0.015838
Epoch 25
Loss = 9.1950e-02, PNorm = 35.1352, GNorm = 0.4122, lr_0 = 3.6960e-04
Loss = 9.5947e-02, PNorm = 35.1442, GNorm = 4.1167, lr_0 = 3.5927e-04
Validation rmse = 0.128146
Validation r2 = 0.864743
Validation mse = 0.016422
Epoch 26
Loss = 8.9491e-02, PNorm = 35.1573, GNorm = 1.5752, lr_0 = 3.4922e-04
Validation rmse = 0.124819
Validation r2 = 0.871676
Validation mse = 0.015580
Epoch 27
Loss = 9.9784e-02, PNorm = 35.1698, GNorm = 1.2133, lr_0 = 3.3850e-04
Loss = 8.5410e-02, PNorm = 35.1805, GNorm = 0.7031, lr_0 = 3.2903e-04
Validation rmse = 0.124226
Validation r2 = 0.872893
Validation mse = 0.015432
Epoch 28
Loss = 8.6933e-02, PNorm = 35.1888, GNorm = 0.6997, lr_0 = 3.1984e-04
Validation rmse = 0.132305
Validation r2 = 0.855821
Validation mse = 0.017505
Epoch 29
Loss = 8.9577e-02, PNorm = 35.1982, GNorm = 2.3667, lr_0 = 3.1089e-04
Loss = 8.7142e-02, PNorm = 35.2078, GNorm = 0.6961, lr_0 = 3.0220e-04
Validation rmse = 0.121944
Validation r2 = 0.877519
Validation mse = 0.014870
Epoch 30
Loss = 8.4267e-02, PNorm = 35.2167, GNorm = 0.6798, lr_0 = 2.9375e-04
Validation rmse = 0.124036
Validation r2 = 0.873281
Validation mse = 0.015385
Epoch 31
Loss = 9.0281e-02, PNorm = 35.2249, GNorm = 0.8751, lr_0 = 2.8473e-04
Loss = 7.9600e-02, PNorm = 35.2334, GNorm = 2.2115, lr_0 = 2.7677e-04
Validation rmse = 0.135514
Validation r2 = 0.848742
Validation mse = 0.018364
Epoch 32
Loss = 9.2408e-02, PNorm = 35.2414, GNorm = 3.7317, lr_0 = 2.6903e-04
Validation rmse = 0.124539
Validation r2 = 0.872251
Validation mse = 0.015510
Epoch 33
Loss = 7.3270e-02, PNorm = 35.2502, GNorm = 0.8908, lr_0 = 2.6151e-04
Validation rmse = 0.126992
Validation r2 = 0.867169
Validation mse = 0.016127
Epoch 34
Loss = 7.7373e-02, PNorm = 35.2585, GNorm = 1.3410, lr_0 = 2.5348e-04
Loss = 8.9852e-02, PNorm = 35.2667, GNorm = 0.6291, lr_0 = 2.4639e-04
Validation rmse = 0.122537
Validation r2 = 0.876326
Validation mse = 0.015015
Epoch 35
Loss = 5.9921e-02, PNorm = 35.2740, GNorm = 0.5190, lr_0 = 2.3950e-04
Validation rmse = 0.123649
Validation r2 = 0.874071
Validation mse = 0.015289
Epoch 36
Loss = 6.5224e-02, PNorm = 35.2816, GNorm = 1.2655, lr_0 = 2.3281e-04
Loss = 8.2489e-02, PNorm = 35.2886, GNorm = 1.2732, lr_0 = 2.2630e-04
Validation rmse = 0.122368
Validation r2 = 0.876666
Validation mse = 0.014974
Epoch 37
Loss = 8.2819e-02, PNorm = 35.2969, GNorm = 1.5636, lr_0 = 2.1935e-04
Validation rmse = 0.123549
Validation r2 = 0.874273
Validation mse = 0.015264
Epoch 38
Loss = 6.8133e-02, PNorm = 35.3036, GNorm = 1.1400, lr_0 = 2.1321e-04
Loss = 7.8868e-02, PNorm = 35.3100, GNorm = 1.6908, lr_0 = 2.0725e-04
Validation rmse = 0.125304
Validation r2 = 0.870676
Validation mse = 0.015701
Epoch 39
Loss = 8.5970e-02, PNorm = 35.3171, GNorm = 3.1057, lr_0 = 2.0146e-04
Validation rmse = 0.123077
Validation r2 = 0.875232
Validation mse = 0.015148
Epoch 40
Loss = 7.5610e-02, PNorm = 35.3234, GNorm = 2.2679, lr_0 = 1.9583e-04
Loss = 7.5051e-02, PNorm = 35.3299, GNorm = 1.4892, lr_0 = 1.9035e-04
Validation rmse = 0.122312
Validation r2 = 0.876780
Validation mse = 0.014960
Epoch 41
Loss = 7.2893e-02, PNorm = 35.3360, GNorm = 1.0417, lr_0 = 1.8451e-04
Validation rmse = 0.125353
Validation r2 = 0.870575
Validation mse = 0.015713
Epoch 42
Loss = 7.8033e-02, PNorm = 35.3409, GNorm = 2.1081, lr_0 = 1.7935e-04
Loss = 7.6285e-02, PNorm = 35.3461, GNorm = 0.9619, lr_0 = 1.7433e-04
Validation rmse = 0.122987
Validation r2 = 0.875416
Validation mse = 0.015126
Epoch 43
Loss = 7.8656e-02, PNorm = 35.3528, GNorm = 2.3227, lr_0 = 1.6946e-04
Validation rmse = 0.121758
Validation r2 = 0.877892
Validation mse = 0.014825
Epoch 44
Loss = 7.5515e-02, PNorm = 35.3585, GNorm = 1.9170, lr_0 = 1.6425e-04
Loss = 7.2784e-02, PNorm = 35.3639, GNorm = 0.6395, lr_0 = 1.5966e-04
Validation rmse = 0.126241
Validation r2 = 0.868735
Validation mse = 0.015937
Epoch 45
Loss = 7.1662e-02, PNorm = 35.3679, GNorm = 0.5016, lr_0 = 1.5520e-04
Validation rmse = 0.122095
Validation r2 = 0.877215
Validation mse = 0.014907
Epoch 46
Loss = 6.7912e-02, PNorm = 35.3722, GNorm = 0.8922, lr_0 = 1.5086e-04
Loss = 7.4668e-02, PNorm = 35.3762, GNorm = 2.0665, lr_0 = 1.4664e-04
Loss = 7.4088e-02, PNorm = 35.3767, GNorm = 1.9980, lr_0 = 1.4623e-04
Validation rmse = 0.127003
Validation r2 = 0.867145
Validation mse = 0.016130
Epoch 47
Loss = 7.2556e-02, PNorm = 35.3822, GNorm = 1.0860, lr_0 = 1.4214e-04
Validation rmse = 0.122670
Validation r2 = 0.876057
Validation mse = 0.015048
Epoch 48
Loss = 6.3791e-02, PNorm = 35.3856, GNorm = 0.7925, lr_0 = 1.3816e-04
Loss = 7.5420e-02, PNorm = 35.3894, GNorm = 1.6309, lr_0 = 1.3430e-04
Validation rmse = 0.123099
Validation r2 = 0.875189
Validation mse = 0.015153
Epoch 49
Loss = 7.4920e-02, PNorm = 35.3950, GNorm = 1.3872, lr_0 = 1.3055e-04
Validation rmse = 0.123734
Validation r2 = 0.873898
Validation mse = 0.015310
Epoch 50
Loss = 6.7435e-02, PNorm = 35.3989, GNorm = 0.5546, lr_0 = 1.2690e-04
Validation rmse = 0.125076
Validation r2 = 0.871146
Validation mse = 0.015644
Epoch 51
Loss = 6.6997e-02, PNorm = 35.4027, GNorm = 2.4915, lr_0 = 1.2300e-04
Loss = 7.1689e-02, PNorm = 35.4064, GNorm = 1.8567, lr_0 = 1.1956e-04
Validation rmse = 0.122277
Validation r2 = 0.876849
Validation mse = 0.014952
Epoch 52
Loss = 8.7577e-02, PNorm = 35.4107, GNorm = 1.5951, lr_0 = 1.1622e-04
Validation rmse = 0.121482
Validation r2 = 0.878446
Validation mse = 0.014758
Epoch 53
Loss = 8.1469e-02, PNorm = 35.4143, GNorm = 1.0947, lr_0 = 1.1297e-04
Loss = 6.5417e-02, PNorm = 35.4174, GNorm = 0.4809, lr_0 = 1.0981e-04
Validation rmse = 0.120819
Validation r2 = 0.879769
Validation mse = 0.014597
Epoch 54
Loss = 6.7522e-02, PNorm = 35.4214, GNorm = 0.7344, lr_0 = 1.0644e-04
Validation rmse = 0.128423
Validation r2 = 0.864158
Validation mse = 0.016492
Epoch 55
Loss = 6.7929e-02, PNorm = 35.4246, GNorm = 1.1522, lr_0 = 1.0346e-04
Loss = 6.2398e-02, PNorm = 35.4277, GNorm = 0.8971, lr_0 = 1.0057e-04
Validation rmse = 0.124238
Validation r2 = 0.872868
Validation mse = 0.015435
Epoch 56
Loss = 7.6021e-02, PNorm = 35.4305, GNorm = 1.6555, lr_0 = 1.0000e-04
Validation rmse = 0.125848
Validation r2 = 0.869552
Validation mse = 0.015838
Epoch 57
Loss = 6.6800e-02, PNorm = 35.4343, GNorm = 0.4724, lr_0 = 1.0000e-04
Loss = 6.9766e-02, PNorm = 35.4377, GNorm = 1.9796, lr_0 = 1.0000e-04
Validation rmse = 0.122183
Validation r2 = 0.877040
Validation mse = 0.014929
Epoch 58
Loss = 7.6240e-02, PNorm = 35.4419, GNorm = 1.0303, lr_0 = 1.0000e-04
Validation rmse = 0.122805
Validation r2 = 0.875783
Validation mse = 0.015081
Epoch 59
Loss = 6.0558e-02, PNorm = 35.4447, GNorm = 1.4235, lr_0 = 1.0000e-04
Loss = 7.2431e-02, PNorm = 35.4475, GNorm = 0.6350, lr_0 = 1.0000e-04
Validation rmse = 0.120898
Validation r2 = 0.879612
Validation mse = 0.014616
Model 0 best validation rmse = 0.120819 on epoch 53
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.196927
Model 0 test r2 = 0.356165
Model 0 test mse = 0.038780
Ensemble test rmse = 0.196927
Ensemble test r2 = 0.356165
Ensemble test mse = 0.038780
Fold 7
Splitting data with seed 7
Total size = 919 | train size = 735 | val size = 184 | test size = 103
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.3584e-01, PNorm = 34.0166, GNorm = 3.3314, lr_0 = 4.5357e-04
Validation rmse = 0.294432
Validation r2 = 0.267521
Validation mse = 0.086690
Epoch 1
Loss = 7.2372e-01, PNorm = 34.0521, GNorm = 8.0598, lr_0 = 8.0714e-04
Validation rmse = 0.258419
Validation r2 = 0.435745
Validation mse = 0.066781
Epoch 2
Loss = 5.3269e-01, PNorm = 34.1186, GNorm = 1.9658, lr_0 = 9.8872e-04
Loss = 5.3376e-01, PNorm = 34.1936, GNorm = 6.5249, lr_0 = 9.6108e-04
Validation rmse = 0.210405
Validation r2 = 0.625943
Validation mse = 0.044270
Epoch 3
Loss = 3.9221e-01, PNorm = 34.2688, GNorm = 1.9220, lr_0 = 9.3421e-04
Validation rmse = 0.193217
Validation r2 = 0.684561
Validation mse = 0.037333
Epoch 4
Loss = 3.3232e-01, PNorm = 34.3495, GNorm = 1.8797, lr_0 = 9.0552e-04
Loss = 2.7218e-01, PNorm = 34.4103, GNorm = 1.0802, lr_0 = 8.8020e-04
Validation rmse = 0.173718
Validation r2 = 0.745014
Validation mse = 0.030178
Epoch 5
Loss = 2.5347e-01, PNorm = 34.4712, GNorm = 0.7466, lr_0 = 8.5559e-04
Validation rmse = 0.200813
Validation r2 = 0.659270
Validation mse = 0.040326
Epoch 6
Loss = 2.0359e-01, PNorm = 34.5195, GNorm = 6.3716, lr_0 = 8.3167e-04
Loss = 2.1693e-01, PNorm = 34.5597, GNorm = 0.7819, lr_0 = 8.0842e-04
Validation rmse = 0.208896
Validation r2 = 0.631290
Validation mse = 0.043637
Epoch 7
Loss = 2.4630e-01, PNorm = 34.6017, GNorm = 3.3256, lr_0 = 7.8359e-04
Validation rmse = 0.163356
Validation r2 = 0.774527
Validation mse = 0.026685
Epoch 8
Loss = 1.3485e-01, PNorm = 34.6412, GNorm = 1.9638, lr_0 = 7.6168e-04
Loss = 1.7928e-01, PNorm = 34.6777, GNorm = 3.8532, lr_0 = 7.4039e-04
Validation rmse = 0.152004
Validation r2 = 0.804774
Validation mse = 0.023105
Epoch 9
Loss = 1.2923e-01, PNorm = 34.7047, GNorm = 1.1157, lr_0 = 7.1969e-04
Validation rmse = 0.143516
Validation r2 = 0.825968
Validation mse = 0.020597
Epoch 10
Loss = 1.0238e-01, PNorm = 34.7344, GNorm = 1.2158, lr_0 = 6.9956e-04
Loss = 1.7032e-01, PNorm = 34.7571, GNorm = 1.1715, lr_0 = 6.8001e-04
Validation rmse = 0.154162
Validation r2 = 0.799191
Validation mse = 0.023766
Epoch 11
Loss = 1.5221e-01, PNorm = 34.7920, GNorm = 1.2573, lr_0 = 6.5912e-04
Validation rmse = 0.149209
Validation r2 = 0.811888
Validation mse = 0.022263
Epoch 12
Loss = 1.4250e-01, PNorm = 34.8142, GNorm = 5.8521, lr_0 = 6.4069e-04
Loss = 1.2262e-01, PNorm = 34.8364, GNorm = 2.8063, lr_0 = 6.2278e-04
Validation rmse = 0.139025
Validation r2 = 0.836691
Validation mse = 0.019328
Epoch 13
Loss = 1.1063e-01, PNorm = 34.8552, GNorm = 1.5545, lr_0 = 6.0537e-04
Validation rmse = 0.155050
Validation r2 = 0.796874
Validation mse = 0.024040
Epoch 14
Loss = 1.1801e-01, PNorm = 34.8738, GNorm = 3.0153, lr_0 = 5.8678e-04
Loss = 1.2977e-01, PNorm = 34.8908, GNorm = 5.5145, lr_0 = 5.7037e-04
Validation rmse = 0.143195
Validation r2 = 0.826747
Validation mse = 0.020505
Epoch 15
Loss = 1.3609e-01, PNorm = 34.9073, GNorm = 7.3341, lr_0 = 5.5442e-04
Validation rmse = 0.147357
Validation r2 = 0.816530
Validation mse = 0.021714
Epoch 16
Loss = 1.1214e-01, PNorm = 34.9233, GNorm = 1.2879, lr_0 = 5.3892e-04
Validation rmse = 0.141605
Validation r2 = 0.830574
Validation mse = 0.020052
Epoch 17
Loss = 1.1429e-01, PNorm = 34.9407, GNorm = 2.5124, lr_0 = 5.2237e-04
Loss = 9.7785e-02, PNorm = 34.9549, GNorm = 1.6130, lr_0 = 5.0777e-04
Validation rmse = 0.145199
Validation r2 = 0.821863
Validation mse = 0.021083
Epoch 18
Loss = 1.0147e-01, PNorm = 34.9672, GNorm = 1.4297, lr_0 = 4.9357e-04
Validation rmse = 0.147152
Validation r2 = 0.817039
Validation mse = 0.021654
Epoch 19
Loss = 1.0555e-01, PNorm = 34.9810, GNorm = 4.1733, lr_0 = 4.7977e-04
Loss = 1.1922e-01, PNorm = 34.9941, GNorm = 4.1471, lr_0 = 4.6636e-04
Validation rmse = 0.168626
Validation r2 = 0.759745
Validation mse = 0.028435
Epoch 20
Loss = 1.4152e-01, PNorm = 35.0079, GNorm = 3.5545, lr_0 = 4.5332e-04
Validation rmse = 0.138895
Validation r2 = 0.836996
Validation mse = 0.019292
Epoch 21
Loss = 8.5870e-02, PNorm = 35.0213, GNorm = 0.4658, lr_0 = 4.3940e-04
Loss = 1.0603e-01, PNorm = 35.0357, GNorm = 2.5990, lr_0 = 4.2711e-04
Validation rmse = 0.139015
Validation r2 = 0.836715
Validation mse = 0.019325
Epoch 22
Loss = 1.1196e-01, PNorm = 35.0443, GNorm = 1.8420, lr_0 = 4.1517e-04
Validation rmse = 0.137063
Validation r2 = 0.841267
Validation mse = 0.018786
Epoch 23
Loss = 7.9531e-02, PNorm = 35.0563, GNorm = 1.4754, lr_0 = 4.0356e-04
Loss = 9.2170e-02, PNorm = 35.0661, GNorm = 0.6994, lr_0 = 3.9228e-04
Validation rmse = 0.135306
Validation r2 = 0.845311
Validation mse = 0.018308
Epoch 24
Loss = 8.6424e-02, PNorm = 35.0795, GNorm = 1.2539, lr_0 = 3.8023e-04
Validation rmse = 0.136951
Validation r2 = 0.841528
Validation mse = 0.018755
Epoch 25
Loss = 8.5100e-02, PNorm = 35.0873, GNorm = 1.0168, lr_0 = 3.6960e-04
Loss = 9.3217e-02, PNorm = 35.0968, GNorm = 4.9495, lr_0 = 3.5927e-04
Validation rmse = 0.143922
Validation r2 = 0.824982
Validation mse = 0.020714
Epoch 26
Loss = 9.3639e-02, PNorm = 35.1043, GNorm = 3.4858, lr_0 = 3.4922e-04
Validation rmse = 0.134008
Validation r2 = 0.848265
Validation mse = 0.017958
Epoch 27
Loss = 9.0243e-02, PNorm = 35.1160, GNorm = 4.0550, lr_0 = 3.3850e-04
Loss = 9.7304e-02, PNorm = 35.1263, GNorm = 0.9084, lr_0 = 3.2903e-04
Validation rmse = 0.138430
Validation r2 = 0.838084
Validation mse = 0.019163
Epoch 28
Loss = 9.1631e-02, PNorm = 35.1348, GNorm = 1.2328, lr_0 = 3.1984e-04
Validation rmse = 0.139580
Validation r2 = 0.835384
Validation mse = 0.019483
Epoch 29
Loss = 9.7618e-02, PNorm = 35.1419, GNorm = 1.6168, lr_0 = 3.1089e-04
Loss = 8.1484e-02, PNorm = 35.1510, GNorm = 0.9247, lr_0 = 3.0220e-04
Validation rmse = 0.136843
Validation r2 = 0.841776
Validation mse = 0.018726
Epoch 30
Loss = 8.5708e-02, PNorm = 35.1595, GNorm = 2.5022, lr_0 = 2.9375e-04
Validation rmse = 0.135798
Validation r2 = 0.844184
Validation mse = 0.018441
Epoch 31
Loss = 8.9381e-02, PNorm = 35.1685, GNorm = 1.3071, lr_0 = 2.8473e-04
Loss = 8.2458e-02, PNorm = 35.1773, GNorm = 1.2637, lr_0 = 2.7677e-04
Validation rmse = 0.139667
Validation r2 = 0.835180
Validation mse = 0.019507
Epoch 32
Loss = 8.4719e-02, PNorm = 35.1836, GNorm = 1.6940, lr_0 = 2.6903e-04
Validation rmse = 0.134942
Validation r2 = 0.846143
Validation mse = 0.018209
Epoch 33
Loss = 8.6683e-02, PNorm = 35.1916, GNorm = 2.0070, lr_0 = 2.6151e-04
Validation rmse = 0.134978
Validation r2 = 0.846059
Validation mse = 0.018219
Epoch 34
Loss = 6.5876e-02, PNorm = 35.2001, GNorm = 1.4140, lr_0 = 2.5348e-04
Loss = 7.3098e-02, PNorm = 35.2063, GNorm = 0.7025, lr_0 = 2.4639e-04
Validation rmse = 0.134969
Validation r2 = 0.846080
Validation mse = 0.018217
Epoch 35
Loss = 6.8210e-02, PNorm = 35.2131, GNorm = 1.2402, lr_0 = 2.3950e-04
Validation rmse = 0.135422
Validation r2 = 0.845045
Validation mse = 0.018339
Epoch 36
Loss = 5.5614e-02, PNorm = 35.2184, GNorm = 0.4583, lr_0 = 2.3281e-04
Loss = 7.7436e-02, PNorm = 35.2258, GNorm = 2.4035, lr_0 = 2.2630e-04
Validation rmse = 0.136218
Validation r2 = 0.843219
Validation mse = 0.018555
Epoch 37
Loss = 9.2420e-02, PNorm = 35.2327, GNorm = 0.5025, lr_0 = 2.1935e-04
Validation rmse = 0.135899
Validation r2 = 0.843953
Validation mse = 0.018468
Epoch 38
Loss = 6.7202e-02, PNorm = 35.2387, GNorm = 0.9437, lr_0 = 2.1321e-04
Loss = 8.1732e-02, PNorm = 35.2465, GNorm = 1.9680, lr_0 = 2.0725e-04
Validation rmse = 0.135369
Validation r2 = 0.845167
Validation mse = 0.018325
Epoch 39
Loss = 8.0989e-02, PNorm = 35.2504, GNorm = 1.2299, lr_0 = 2.0146e-04
Validation rmse = 0.133634
Validation r2 = 0.849111
Validation mse = 0.017858
Epoch 40
Loss = 8.1365e-02, PNorm = 35.2561, GNorm = 0.9091, lr_0 = 1.9583e-04
Loss = 7.0466e-02, PNorm = 35.2622, GNorm = 1.5592, lr_0 = 1.9035e-04
Validation rmse = 0.134228
Validation r2 = 0.847766
Validation mse = 0.018017
Epoch 41
Loss = 7.7830e-02, PNorm = 35.2681, GNorm = 1.0526, lr_0 = 1.8451e-04
Validation rmse = 0.136397
Validation r2 = 0.842806
Validation mse = 0.018604
Epoch 42
Loss = 8.9196e-02, PNorm = 35.2737, GNorm = 1.7354, lr_0 = 1.7935e-04
Loss = 7.0399e-02, PNorm = 35.2771, GNorm = 2.2677, lr_0 = 1.7433e-04
Validation rmse = 0.135245
Validation r2 = 0.845451
Validation mse = 0.018291
Epoch 43
Loss = 7.3354e-02, PNorm = 35.2836, GNorm = 1.3550, lr_0 = 1.6946e-04
Validation rmse = 0.135013
Validation r2 = 0.845979
Validation mse = 0.018229
Epoch 44
Loss = 7.4729e-02, PNorm = 35.2878, GNorm = 0.6082, lr_0 = 1.6425e-04
Loss = 7.3948e-02, PNorm = 35.2929, GNorm = 0.4303, lr_0 = 1.5966e-04
Validation rmse = 0.134915
Validation r2 = 0.846203
Validation mse = 0.018202
Epoch 45
Loss = 6.9813e-02, PNorm = 35.2971, GNorm = 1.9727, lr_0 = 1.5520e-04
Validation rmse = 0.134263
Validation r2 = 0.847686
Validation mse = 0.018027
Epoch 46
Loss = 6.9041e-02, PNorm = 35.3015, GNorm = 0.8794, lr_0 = 1.5086e-04
Loss = 7.3433e-02, PNorm = 35.3052, GNorm = 1.2479, lr_0 = 1.4664e-04
Loss = 9.5306e-02, PNorm = 35.3056, GNorm = 1.5890, lr_0 = 1.4623e-04
Validation rmse = 0.133866
Validation r2 = 0.848586
Validation mse = 0.017920
Epoch 47
Loss = 7.0002e-02, PNorm = 35.3103, GNorm = 1.2450, lr_0 = 1.4214e-04
Validation rmse = 0.134798
Validation r2 = 0.846470
Validation mse = 0.018171
Epoch 48
Loss = 7.1669e-02, PNorm = 35.3144, GNorm = 0.8626, lr_0 = 1.3816e-04
Loss = 7.3330e-02, PNorm = 35.3183, GNorm = 0.6397, lr_0 = 1.3430e-04
Validation rmse = 0.134464
Validation r2 = 0.847230
Validation mse = 0.018081
Epoch 49
Loss = 7.2032e-02, PNorm = 35.3217, GNorm = 0.6794, lr_0 = 1.3055e-04
Validation rmse = 0.134311
Validation r2 = 0.847578
Validation mse = 0.018039
Epoch 50
Loss = 7.5236e-02, PNorm = 35.3257, GNorm = 1.5796, lr_0 = 1.2690e-04
Validation rmse = 0.134564
Validation r2 = 0.847004
Validation mse = 0.018107
Epoch 51
Loss = 8.9608e-02, PNorm = 35.3301, GNorm = 0.8561, lr_0 = 1.2300e-04
Loss = 7.1804e-02, PNorm = 35.3332, GNorm = 0.6652, lr_0 = 1.1956e-04
Validation rmse = 0.134414
Validation r2 = 0.847344
Validation mse = 0.018067
Epoch 52
Loss = 7.5451e-02, PNorm = 35.3366, GNorm = 0.6711, lr_0 = 1.1622e-04
Validation rmse = 0.137656
Validation r2 = 0.839892
Validation mse = 0.018949
Epoch 53
Loss = 8.2227e-02, PNorm = 35.3408, GNorm = 1.4710, lr_0 = 1.1297e-04
Loss = 7.6010e-02, PNorm = 35.3441, GNorm = 0.6521, lr_0 = 1.0981e-04
Validation rmse = 0.133451
Validation r2 = 0.849524
Validation mse = 0.017809
Epoch 54
Loss = 7.2824e-02, PNorm = 35.3478, GNorm = 0.5946, lr_0 = 1.0644e-04
Validation rmse = 0.135919
Validation r2 = 0.843906
Validation mse = 0.018474
Epoch 55
Loss = 4.8226e-02, PNorm = 35.3506, GNorm = 1.4520, lr_0 = 1.0346e-04
Loss = 7.4268e-02, PNorm = 35.3530, GNorm = 1.6504, lr_0 = 1.0057e-04
Validation rmse = 0.133770
Validation r2 = 0.848803
Validation mse = 0.017894
Epoch 56
Loss = 6.3547e-02, PNorm = 35.3566, GNorm = 0.5905, lr_0 = 1.0000e-04
Validation rmse = 0.133623
Validation r2 = 0.849135
Validation mse = 0.017855
Epoch 57
Loss = 5.7043e-02, PNorm = 35.3602, GNorm = 0.8837, lr_0 = 1.0000e-04
Loss = 7.5718e-02, PNorm = 35.3634, GNorm = 0.7688, lr_0 = 1.0000e-04
Validation rmse = 0.134269
Validation r2 = 0.847674
Validation mse = 0.018028
Epoch 58
Loss = 6.7871e-02, PNorm = 35.3659, GNorm = 1.1440, lr_0 = 1.0000e-04
Validation rmse = 0.134158
Validation r2 = 0.847926
Validation mse = 0.017998
Epoch 59
Loss = 5.8608e-02, PNorm = 35.3688, GNorm = 0.9060, lr_0 = 1.0000e-04
Loss = 7.2799e-02, PNorm = 35.3712, GNorm = 1.7417, lr_0 = 1.0000e-04
Validation rmse = 0.132755
Validation r2 = 0.851088
Validation mse = 0.017624
Model 0 best validation rmse = 0.132755 on epoch 59
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.208514
Model 0 test r2 = 0.278171
Model 0 test mse = 0.043478
Ensemble test rmse = 0.208514
Ensemble test r2 = 0.278171
Ensemble test mse = 0.043478
Fold 8
Splitting data with seed 8
Total size = 919 | train size = 735 | val size = 184 | test size = 103
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.9601e-01, PNorm = 34.0171, GNorm = 4.1667, lr_0 = 4.5357e-04
Validation rmse = 0.299533
Validation r2 = 0.268889
Validation mse = 0.089720
Epoch 1
Loss = 6.4167e-01, PNorm = 34.0604, GNorm = 1.7790, lr_0 = 8.0714e-04
Validation rmse = 0.252642
Validation r2 = 0.479879
Validation mse = 0.063828
Epoch 2
Loss = 6.5003e-01, PNorm = 34.1184, GNorm = 3.8635, lr_0 = 9.8872e-04
Loss = 4.4085e-01, PNorm = 34.1887, GNorm = 8.0998, lr_0 = 9.6108e-04
Validation rmse = 0.270538
Validation r2 = 0.403584
Validation mse = 0.073191
Epoch 3
Loss = 4.1645e-01, PNorm = 34.2569, GNorm = 2.1151, lr_0 = 9.3421e-04
Validation rmse = 0.200868
Validation r2 = 0.671211
Validation mse = 0.040348
Epoch 4
Loss = 2.7896e-01, PNorm = 34.3269, GNorm = 1.8693, lr_0 = 9.0552e-04
Loss = 2.9273e-01, PNorm = 34.3900, GNorm = 7.0727, lr_0 = 8.8020e-04
Validation rmse = 0.179467
Validation r2 = 0.737540
Validation mse = 0.032208
Epoch 5
Loss = 3.2734e-01, PNorm = 34.4473, GNorm = 2.5039, lr_0 = 8.5559e-04
Validation rmse = 0.184445
Validation r2 = 0.722779
Validation mse = 0.034020
Epoch 6
Loss = 2.3002e-01, PNorm = 34.4971, GNorm = 5.2570, lr_0 = 8.3167e-04
Loss = 2.5090e-01, PNorm = 34.5458, GNorm = 2.9538, lr_0 = 8.0842e-04
Validation rmse = 0.166441
Validation r2 = 0.774258
Validation mse = 0.027702
Epoch 7
Loss = 1.7293e-01, PNorm = 34.5908, GNorm = 1.9103, lr_0 = 7.8359e-04
Validation rmse = 0.151911
Validation r2 = 0.811952
Validation mse = 0.023077
Epoch 8
Loss = 1.3922e-01, PNorm = 34.6296, GNorm = 3.5465, lr_0 = 7.6168e-04
Loss = 1.5792e-01, PNorm = 34.6634, GNorm = 3.8059, lr_0 = 7.4039e-04
Validation rmse = 0.147898
Validation r2 = 0.821755
Validation mse = 0.021874
Epoch 9
Loss = 1.3727e-01, PNorm = 34.6916, GNorm = 1.2189, lr_0 = 7.1969e-04
Validation rmse = 0.180982
Validation r2 = 0.733089
Validation mse = 0.032755
Epoch 10
Loss = 1.8642e-01, PNorm = 34.7208, GNorm = 3.0317, lr_0 = 6.9956e-04
Loss = 1.6256e-01, PNorm = 34.7480, GNorm = 2.2757, lr_0 = 6.8001e-04
Validation rmse = 0.145530
Validation r2 = 0.827416
Validation mse = 0.021179
Epoch 11
Loss = 1.3202e-01, PNorm = 34.7741, GNorm = 1.3750, lr_0 = 6.5912e-04
Validation rmse = 0.146782
Validation r2 = 0.824434
Validation mse = 0.021545
Epoch 12
Loss = 1.4907e-01, PNorm = 34.8013, GNorm = 1.5605, lr_0 = 6.4069e-04
Loss = 1.3762e-01, PNorm = 34.8211, GNorm = 2.3764, lr_0 = 6.2278e-04
Validation rmse = 0.156880
Validation r2 = 0.799447
Validation mse = 0.024611
Epoch 13
Loss = 1.3699e-01, PNorm = 34.8479, GNorm = 5.7160, lr_0 = 6.0537e-04
Validation rmse = 0.158590
Validation r2 = 0.795052
Validation mse = 0.025151
Epoch 14
Loss = 1.6623e-01, PNorm = 34.8753, GNorm = 7.4344, lr_0 = 5.8678e-04
Loss = 1.4034e-01, PNorm = 34.8992, GNorm = 2.2066, lr_0 = 5.7037e-04
Validation rmse = 0.149184
Validation r2 = 0.818641
Validation mse = 0.022256
Epoch 15
Loss = 1.2709e-01, PNorm = 34.9150, GNorm = 0.5998, lr_0 = 5.5442e-04
Validation rmse = 0.165223
Validation r2 = 0.777550
Validation mse = 0.027299
Epoch 16
Loss = 1.3065e-01, PNorm = 34.9311, GNorm = 6.4740, lr_0 = 5.3892e-04
Validation rmse = 0.140949
Validation r2 = 0.838111
Validation mse = 0.019867
Epoch 17
Loss = 1.1536e-01, PNorm = 34.9500, GNorm = 1.6342, lr_0 = 5.2237e-04
Loss = 1.0748e-01, PNorm = 34.9644, GNorm = 1.1727, lr_0 = 5.0777e-04
Validation rmse = 0.140978
Validation r2 = 0.838045
Validation mse = 0.019875
Epoch 18
Loss = 8.3127e-02, PNorm = 34.9803, GNorm = 3.0634, lr_0 = 4.9357e-04
Validation rmse = 0.136741
Validation r2 = 0.847633
Validation mse = 0.018698
Epoch 19
Loss = 9.2132e-02, PNorm = 34.9928, GNorm = 0.9806, lr_0 = 4.7977e-04
Loss = 9.8214e-02, PNorm = 35.0044, GNorm = 0.5411, lr_0 = 4.6636e-04
Validation rmse = 0.134568
Validation r2 = 0.852436
Validation mse = 0.018109
Epoch 20
Loss = 8.5095e-02, PNorm = 35.0176, GNorm = 2.5047, lr_0 = 4.5332e-04
Validation rmse = 0.133702
Validation r2 = 0.854330
Validation mse = 0.017876
Epoch 21
Loss = 8.9145e-02, PNorm = 35.0278, GNorm = 1.3471, lr_0 = 4.3940e-04
Loss = 9.6441e-02, PNorm = 35.0391, GNorm = 1.7632, lr_0 = 4.2711e-04
Validation rmse = 0.137140
Validation r2 = 0.846743
Validation mse = 0.018807
Epoch 22
Loss = 8.7276e-02, PNorm = 35.0505, GNorm = 1.8904, lr_0 = 4.1517e-04
Validation rmse = 0.134764
Validation r2 = 0.852006
Validation mse = 0.018161
Epoch 23
Loss = 1.0591e-01, PNorm = 35.0610, GNorm = 0.4633, lr_0 = 4.0356e-04
Loss = 8.7269e-02, PNorm = 35.0717, GNorm = 0.9588, lr_0 = 3.9228e-04
Validation rmse = 0.133533
Validation r2 = 0.854698
Validation mse = 0.017831
Epoch 24
Loss = 1.0136e-01, PNorm = 35.0854, GNorm = 1.7128, lr_0 = 3.8023e-04
Validation rmse = 0.137735
Validation r2 = 0.845409
Validation mse = 0.018971
Epoch 25
Loss = 8.2141e-02, PNorm = 35.0955, GNorm = 0.5573, lr_0 = 3.6960e-04
Loss = 9.3725e-02, PNorm = 35.1032, GNorm = 1.0451, lr_0 = 3.5927e-04
Validation rmse = 0.139169
Validation r2 = 0.842173
Validation mse = 0.019368
Epoch 26
Loss = 8.8242e-02, PNorm = 35.1125, GNorm = 1.0892, lr_0 = 3.4922e-04
Validation rmse = 0.138159
Validation r2 = 0.844456
Validation mse = 0.019088
Epoch 27
Loss = 9.9934e-02, PNorm = 35.1245, GNorm = 0.9919, lr_0 = 3.3850e-04
Loss = 8.5440e-02, PNorm = 35.1336, GNorm = 1.0528, lr_0 = 3.2903e-04
Validation rmse = 0.135101
Validation r2 = 0.851266
Validation mse = 0.018252
Epoch 28
Loss = 9.7380e-02, PNorm = 35.1426, GNorm = 1.5171, lr_0 = 3.1984e-04
Validation rmse = 0.135241
Validation r2 = 0.850958
Validation mse = 0.018290
Epoch 29
Loss = 1.1152e-01, PNorm = 35.1502, GNorm = 2.0094, lr_0 = 3.1089e-04
Loss = 9.4288e-02, PNorm = 35.1596, GNorm = 1.3662, lr_0 = 3.0220e-04
Validation rmse = 0.132647
Validation r2 = 0.856621
Validation mse = 0.017595
Epoch 30
Loss = 8.7990e-02, PNorm = 35.1679, GNorm = 1.5444, lr_0 = 2.9375e-04
Validation rmse = 0.132606
Validation r2 = 0.856708
Validation mse = 0.017584
Epoch 31
Loss = 8.2189e-02, PNorm = 35.1779, GNorm = 1.4368, lr_0 = 2.8473e-04
Loss = 8.8365e-02, PNorm = 35.1855, GNorm = 1.4377, lr_0 = 2.7677e-04
Validation rmse = 0.137989
Validation r2 = 0.844838
Validation mse = 0.019041
Epoch 32
Loss = 8.1645e-02, PNorm = 35.1927, GNorm = 0.7399, lr_0 = 2.6903e-04
Validation rmse = 0.137935
Validation r2 = 0.844959
Validation mse = 0.019026
Epoch 33
Loss = 9.5712e-02, PNorm = 35.2000, GNorm = 1.1092, lr_0 = 2.6151e-04
Validation rmse = 0.134287
Validation r2 = 0.853053
Validation mse = 0.018033
Epoch 34
Loss = 6.9236e-02, PNorm = 35.2079, GNorm = 0.6905, lr_0 = 2.5348e-04
Loss = 7.8287e-02, PNorm = 35.2124, GNorm = 1.5463, lr_0 = 2.4639e-04
Validation rmse = 0.132389
Validation r2 = 0.857177
Validation mse = 0.017527
Epoch 35
Loss = 7.8238e-02, PNorm = 35.2206, GNorm = 1.1781, lr_0 = 2.3950e-04
Validation rmse = 0.133478
Validation r2 = 0.854818
Validation mse = 0.017816
Epoch 36
Loss = 9.9550e-02, PNorm = 35.2275, GNorm = 1.6557, lr_0 = 2.3281e-04
Loss = 7.6293e-02, PNorm = 35.2341, GNorm = 1.2227, lr_0 = 2.2630e-04
Validation rmse = 0.132671
Validation r2 = 0.856569
Validation mse = 0.017602
Epoch 37
Loss = 7.6938e-02, PNorm = 35.2401, GNorm = 2.2088, lr_0 = 2.1935e-04
Validation rmse = 0.139064
Validation r2 = 0.842412
Validation mse = 0.019339
Epoch 38
Loss = 1.0605e-01, PNorm = 35.2444, GNorm = 3.3678, lr_0 = 2.1321e-04
Loss = 7.8844e-02, PNorm = 35.2512, GNorm = 1.8603, lr_0 = 2.0725e-04
Validation rmse = 0.132509
Validation r2 = 0.856919
Validation mse = 0.017559
Epoch 39
Loss = 7.3856e-02, PNorm = 35.2573, GNorm = 2.9742, lr_0 = 2.0146e-04
Validation rmse = 0.139821
Validation r2 = 0.840693
Validation mse = 0.019550
Epoch 40
Loss = 6.1648e-02, PNorm = 35.2627, GNorm = 2.6221, lr_0 = 1.9583e-04
Loss = 8.7420e-02, PNorm = 35.2664, GNorm = 2.1772, lr_0 = 1.9035e-04
Validation rmse = 0.131629
Validation r2 = 0.858812
Validation mse = 0.017326
Epoch 41
Loss = 8.8002e-02, PNorm = 35.2728, GNorm = 2.0416, lr_0 = 1.8451e-04
Validation rmse = 0.132070
Validation r2 = 0.857864
Validation mse = 0.017443
Epoch 42
Loss = 7.8684e-02, PNorm = 35.2784, GNorm = 1.1475, lr_0 = 1.7935e-04
Loss = 7.8105e-02, PNorm = 35.2831, GNorm = 0.9013, lr_0 = 1.7433e-04
Validation rmse = 0.133474
Validation r2 = 0.854827
Validation mse = 0.017815
Epoch 43
Loss = 7.1317e-02, PNorm = 35.2872, GNorm = 1.2589, lr_0 = 1.6946e-04
Validation rmse = 0.131057
Validation r2 = 0.860037
Validation mse = 0.017176
Epoch 44
Loss = 6.7458e-02, PNorm = 35.2924, GNorm = 0.6640, lr_0 = 1.6425e-04
Loss = 8.0498e-02, PNorm = 35.2975, GNorm = 0.6828, lr_0 = 1.5966e-04
Validation rmse = 0.131909
Validation r2 = 0.858210
Validation mse = 0.017400
Epoch 45
Loss = 7.5531e-02, PNorm = 35.3021, GNorm = 0.6661, lr_0 = 1.5520e-04
Validation rmse = 0.135601
Validation r2 = 0.850162
Validation mse = 0.018388
Epoch 46
Loss = 8.4271e-02, PNorm = 35.3062, GNorm = 0.6896, lr_0 = 1.5086e-04
Loss = 7.2436e-02, PNorm = 35.3097, GNorm = 1.1971, lr_0 = 1.4664e-04
Loss = 6.1460e-02, PNorm = 35.3101, GNorm = 2.0222, lr_0 = 1.4623e-04
Validation rmse = 0.131310
Validation r2 = 0.859496
Validation mse = 0.017242
Epoch 47
Loss = 7.1066e-02, PNorm = 35.3144, GNorm = 3.0070, lr_0 = 1.4214e-04
Validation rmse = 0.131875
Validation r2 = 0.858284
Validation mse = 0.017391
Epoch 48
Loss = 6.5149e-02, PNorm = 35.3191, GNorm = 1.0118, lr_0 = 1.3816e-04
Loss = 7.6684e-02, PNorm = 35.3228, GNorm = 2.2000, lr_0 = 1.3430e-04
Validation rmse = 0.130951
Validation r2 = 0.860264
Validation mse = 0.017148
Epoch 49
Loss = 7.5752e-02, PNorm = 35.3269, GNorm = 1.5999, lr_0 = 1.3055e-04
Validation rmse = 0.132770
Validation r2 = 0.856354
Validation mse = 0.017628
Epoch 50
Loss = 6.2675e-02, PNorm = 35.3311, GNorm = 1.0074, lr_0 = 1.2690e-04
Validation rmse = 0.133458
Validation r2 = 0.854861
Validation mse = 0.017811
Epoch 51
Loss = 9.2571e-02, PNorm = 35.3341, GNorm = 1.9503, lr_0 = 1.2300e-04
Loss = 7.2525e-02, PNorm = 35.3381, GNorm = 0.9490, lr_0 = 1.1956e-04
Validation rmse = 0.131568
Validation r2 = 0.858943
Validation mse = 0.017310
Epoch 52
Loss = 7.4313e-02, PNorm = 35.3409, GNorm = 0.6806, lr_0 = 1.1622e-04
Validation rmse = 0.130163
Validation r2 = 0.861940
Validation mse = 0.016942
Epoch 53
Loss = 6.2954e-02, PNorm = 35.3442, GNorm = 0.5770, lr_0 = 1.1297e-04
Loss = 6.7117e-02, PNorm = 35.3466, GNorm = 0.9829, lr_0 = 1.0981e-04
Validation rmse = 0.132609
Validation r2 = 0.856702
Validation mse = 0.017585
Epoch 54
Loss = 7.5579e-02, PNorm = 35.3508, GNorm = 1.6226, lr_0 = 1.0644e-04
Validation rmse = 0.130609
Validation r2 = 0.860992
Validation mse = 0.017059
Epoch 55
Loss = 6.4684e-02, PNorm = 35.3536, GNorm = 0.6037, lr_0 = 1.0346e-04
Loss = 7.1897e-02, PNorm = 35.3563, GNorm = 0.5918, lr_0 = 1.0057e-04
Validation rmse = 0.130589
Validation r2 = 0.861034
Validation mse = 0.017053
Epoch 56
Loss = 7.3586e-02, PNorm = 35.3587, GNorm = 0.4891, lr_0 = 1.0000e-04
Validation rmse = 0.130543
Validation r2 = 0.861132
Validation mse = 0.017041
Epoch 57
Loss = 7.3688e-02, PNorm = 35.3618, GNorm = 0.8059, lr_0 = 1.0000e-04
Loss = 7.5126e-02, PNorm = 35.3648, GNorm = 1.3657, lr_0 = 1.0000e-04
Validation rmse = 0.130161
Validation r2 = 0.861945
Validation mse = 0.016942
Epoch 58
Loss = 7.3891e-02, PNorm = 35.3674, GNorm = 2.5291, lr_0 = 1.0000e-04
Validation rmse = 0.130101
Validation r2 = 0.862071
Validation mse = 0.016926
Epoch 59
Loss = 6.3392e-02, PNorm = 35.3705, GNorm = 0.7152, lr_0 = 1.0000e-04
Loss = 6.7970e-02, PNorm = 35.3733, GNorm = 0.3113, lr_0 = 1.0000e-04
Validation rmse = 0.130783
Validation r2 = 0.860622
Validation mse = 0.017104
Model 0 best validation rmse = 0.130101 on epoch 58
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.176405
Model 0 test r2 = 0.483363
Model 0 test mse = 0.031119
Ensemble test rmse = 0.176405
Ensemble test r2 = 0.483363
Ensemble test mse = 0.031119
Fold 9
Splitting data with seed 9
Total size = 919 | train size = 735 | val size = 184 | test size = 103
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.4531e-01, PNorm = 34.0174, GNorm = 1.4110, lr_0 = 4.5357e-04
Validation rmse = 0.327473
Validation r2 = 0.148543
Validation mse = 0.107239
Epoch 1
Loss = 6.2367e-01, PNorm = 34.0536, GNorm = 2.8194, lr_0 = 8.0714e-04
Validation rmse = 0.308126
Validation r2 = 0.246178
Validation mse = 0.094942
Epoch 2
Loss = 7.2764e-01, PNorm = 34.1184, GNorm = 5.8201, lr_0 = 9.8872e-04
Loss = 4.9489e-01, PNorm = 34.1962, GNorm = 4.8707, lr_0 = 9.6108e-04
Validation rmse = 0.289217
Validation r2 = 0.335860
Validation mse = 0.083646
Epoch 3
Loss = 4.3994e-01, PNorm = 34.2621, GNorm = 3.6187, lr_0 = 9.3421e-04
Validation rmse = 0.241494
Validation r2 = 0.536952
Validation mse = 0.058320
Epoch 4
Loss = 3.4248e-01, PNorm = 34.3395, GNorm = 4.7369, lr_0 = 9.0552e-04
Loss = 3.0698e-01, PNorm = 34.3966, GNorm = 8.2259, lr_0 = 8.8020e-04
Validation rmse = 0.210859
Validation r2 = 0.646982
Validation mse = 0.044462
Epoch 5
Loss = 2.3421e-01, PNorm = 34.4633, GNorm = 2.9889, lr_0 = 8.5559e-04
Validation rmse = 0.193091
Validation r2 = 0.703968
Validation mse = 0.037284
Epoch 6
Loss = 2.0900e-01, PNorm = 34.5152, GNorm = 4.1314, lr_0 = 8.3167e-04
Loss = 1.8514e-01, PNorm = 34.5659, GNorm = 1.8585, lr_0 = 8.0842e-04
Validation rmse = 0.201317
Validation r2 = 0.678209
Validation mse = 0.040529
Epoch 7
Loss = 1.6495e-01, PNorm = 34.6160, GNorm = 1.6899, lr_0 = 7.8359e-04
Validation rmse = 0.183056
Validation r2 = 0.733939
Validation mse = 0.033510
Epoch 8
Loss = 1.0748e-01, PNorm = 34.6564, GNorm = 0.7965, lr_0 = 7.6168e-04
Loss = 1.7924e-01, PNorm = 34.6930, GNorm = 0.9644, lr_0 = 7.4039e-04
Validation rmse = 0.168263
Validation r2 = 0.775203
Validation mse = 0.028313
Epoch 9
Loss = 1.3452e-01, PNorm = 34.7269, GNorm = 1.0359, lr_0 = 7.1969e-04
Validation rmse = 0.170704
Validation r2 = 0.768633
Validation mse = 0.029140
Epoch 10
Loss = 1.5050e-01, PNorm = 34.7562, GNorm = 4.5767, lr_0 = 6.9956e-04
Loss = 1.1969e-01, PNorm = 34.7851, GNorm = 0.8237, lr_0 = 6.8001e-04
Validation rmse = 0.157317
Validation r2 = 0.803499
Validation mse = 0.024749
Epoch 11
Loss = 1.2443e-01, PNorm = 34.8111, GNorm = 1.7043, lr_0 = 6.5912e-04
Validation rmse = 0.167310
Validation r2 = 0.777743
Validation mse = 0.027993
Epoch 12
Loss = 1.2783e-01, PNorm = 34.8324, GNorm = 3.2855, lr_0 = 6.4069e-04
Loss = 1.2943e-01, PNorm = 34.8529, GNorm = 4.9565, lr_0 = 6.2278e-04
Validation rmse = 0.159586
Validation r2 = 0.797791
Validation mse = 0.025468
Epoch 13
Loss = 1.2394e-01, PNorm = 34.8690, GNorm = 1.7828, lr_0 = 6.0537e-04
Validation rmse = 0.161111
Validation r2 = 0.793908
Validation mse = 0.025957
Epoch 14
Loss = 1.3060e-01, PNorm = 34.8883, GNorm = 2.4164, lr_0 = 5.8678e-04
Loss = 1.2377e-01, PNorm = 34.9070, GNorm = 3.6970, lr_0 = 5.7037e-04
Validation rmse = 0.162716
Validation r2 = 0.789781
Validation mse = 0.026476
Epoch 15
Loss = 1.1414e-01, PNorm = 34.9261, GNorm = 1.6387, lr_0 = 5.5442e-04
Validation rmse = 0.154517
Validation r2 = 0.810431
Validation mse = 0.023876
Epoch 16
Loss = 1.0320e-01, PNorm = 34.9418, GNorm = 1.4479, lr_0 = 5.3892e-04
Validation rmse = 0.154053
Validation r2 = 0.811568
Validation mse = 0.023732
Epoch 17
Loss = 1.6060e-01, PNorm = 34.9535, GNorm = 1.9600, lr_0 = 5.2237e-04
Loss = 9.4494e-02, PNorm = 34.9659, GNorm = 2.4673, lr_0 = 5.0777e-04
Validation rmse = 0.153352
Validation r2 = 0.813280
Validation mse = 0.023517
Epoch 18
Loss = 9.1253e-02, PNorm = 34.9795, GNorm = 0.7199, lr_0 = 4.9357e-04
Validation rmse = 0.158509
Validation r2 = 0.800510
Validation mse = 0.025125
Epoch 19
Loss = 5.9704e-02, PNorm = 34.9912, GNorm = 2.1051, lr_0 = 4.7977e-04
Loss = 1.0866e-01, PNorm = 35.0043, GNorm = 1.3977, lr_0 = 4.6636e-04
Validation rmse = 0.158394
Validation r2 = 0.800800
Validation mse = 0.025089
Epoch 20
Loss = 9.5771e-02, PNorm = 35.0163, GNorm = 0.6518, lr_0 = 4.5332e-04
Validation rmse = 0.152440
Validation r2 = 0.815494
Validation mse = 0.023238
Epoch 21
Loss = 9.8123e-02, PNorm = 35.0301, GNorm = 3.3258, lr_0 = 4.3940e-04
Loss = 9.8165e-02, PNorm = 35.0369, GNorm = 2.4515, lr_0 = 4.2711e-04
Validation rmse = 0.152505
Validation r2 = 0.815337
Validation mse = 0.023258
Epoch 22
Loss = 1.0010e-01, PNorm = 35.0485, GNorm = 3.4342, lr_0 = 4.1517e-04
Validation rmse = 0.151283
Validation r2 = 0.818285
Validation mse = 0.022887
Epoch 23
Loss = 7.8002e-02, PNorm = 35.0593, GNorm = 0.6214, lr_0 = 4.0356e-04
Loss = 1.0090e-01, PNorm = 35.0694, GNorm = 4.0955, lr_0 = 3.9228e-04
Validation rmse = 0.162224
Validation r2 = 0.791049
Validation mse = 0.026317
Epoch 24
Loss = 8.7339e-02, PNorm = 35.0796, GNorm = 2.9943, lr_0 = 3.8023e-04
Validation rmse = 0.155413
Validation r2 = 0.808228
Validation mse = 0.024153
Epoch 25
Loss = 7.8987e-02, PNorm = 35.0899, GNorm = 0.8927, lr_0 = 3.6960e-04
Loss = 9.0647e-02, PNorm = 35.1008, GNorm = 0.9715, lr_0 = 3.5927e-04
Validation rmse = 0.150788
Validation r2 = 0.819470
Validation mse = 0.022737
Epoch 26
Loss = 8.6012e-02, PNorm = 35.1098, GNorm = 1.6606, lr_0 = 3.4922e-04
Validation rmse = 0.151656
Validation r2 = 0.817387
Validation mse = 0.023000
Epoch 27
Loss = 9.5921e-02, PNorm = 35.1179, GNorm = 4.0627, lr_0 = 3.3850e-04
Loss = 9.0757e-02, PNorm = 35.1260, GNorm = 3.3127, lr_0 = 3.2903e-04
Validation rmse = 0.148874
Validation r2 = 0.824026
Validation mse = 0.022163
Epoch 28
Loss = 8.5353e-02, PNorm = 35.1348, GNorm = 0.6336, lr_0 = 3.1984e-04
Validation rmse = 0.151828
Validation r2 = 0.816972
Validation mse = 0.023052
Epoch 29
Loss = 8.2074e-02, PNorm = 35.1419, GNorm = 3.4706, lr_0 = 3.1089e-04
Loss = 8.2133e-02, PNorm = 35.1486, GNorm = 2.2667, lr_0 = 3.0220e-04
Validation rmse = 0.147181
Validation r2 = 0.828004
Validation mse = 0.021662
Epoch 30
Loss = 7.6750e-02, PNorm = 35.1562, GNorm = 0.5813, lr_0 = 2.9375e-04
Validation rmse = 0.151242
Validation r2 = 0.818384
Validation mse = 0.022874
Epoch 31
Loss = 6.6553e-02, PNorm = 35.1640, GNorm = 1.8003, lr_0 = 2.8473e-04
Loss = 8.7873e-02, PNorm = 35.1715, GNorm = 1.4339, lr_0 = 2.7677e-04
Validation rmse = 0.148703
Validation r2 = 0.824429
Validation mse = 0.022113
Epoch 32
Loss = 8.1064e-02, PNorm = 35.1794, GNorm = 2.8563, lr_0 = 2.6903e-04
Validation rmse = 0.146352
Validation r2 = 0.829936
Validation mse = 0.021419
Epoch 33
Loss = 7.6926e-02, PNorm = 35.1857, GNorm = 2.7224, lr_0 = 2.6151e-04
Validation rmse = 0.146557
Validation r2 = 0.829460
Validation mse = 0.021479
Epoch 34
Loss = 4.4277e-02, PNorm = 35.1922, GNorm = 0.6646, lr_0 = 2.5348e-04
Loss = 8.0732e-02, PNorm = 35.1977, GNorm = 1.9984, lr_0 = 2.4639e-04
Validation rmse = 0.151750
Validation r2 = 0.817162
Validation mse = 0.023028
Epoch 35
Loss = 8.8663e-02, PNorm = 35.2042, GNorm = 4.4911, lr_0 = 2.3950e-04
Validation rmse = 0.147892
Validation r2 = 0.826340
Validation mse = 0.021872
Epoch 36
Loss = 7.5537e-02, PNorm = 35.2097, GNorm = 1.4142, lr_0 = 2.3281e-04
Loss = 8.0928e-02, PNorm = 35.2147, GNorm = 1.9897, lr_0 = 2.2630e-04
Validation rmse = 0.147270
Validation r2 = 0.827796
Validation mse = 0.021689
Epoch 37
Loss = 7.8143e-02, PNorm = 35.2223, GNorm = 0.9309, lr_0 = 2.1935e-04
Validation rmse = 0.146866
Validation r2 = 0.828741
Validation mse = 0.021570
Epoch 38
Loss = 5.3333e-02, PNorm = 35.2279, GNorm = 1.6690, lr_0 = 2.1321e-04
Loss = 6.5346e-02, PNorm = 35.2331, GNorm = 1.0721, lr_0 = 2.0725e-04
Validation rmse = 0.151697
Validation r2 = 0.817288
Validation mse = 0.023012
Epoch 39
Loss = 8.7776e-02, PNorm = 35.2393, GNorm = 0.7444, lr_0 = 2.0146e-04
Validation rmse = 0.146226
Validation r2 = 0.830229
Validation mse = 0.021382
Epoch 40
Loss = 7.5529e-02, PNorm = 35.2447, GNorm = 0.7720, lr_0 = 1.9583e-04
Loss = 7.2263e-02, PNorm = 35.2488, GNorm = 1.3562, lr_0 = 1.9035e-04
Validation rmse = 0.152493
Validation r2 = 0.815365
Validation mse = 0.023254
Epoch 41
Loss = 7.4929e-02, PNorm = 35.2549, GNorm = 1.8532, lr_0 = 1.8451e-04
Validation rmse = 0.146713
Validation r2 = 0.829097
Validation mse = 0.021525
Epoch 42
Loss = 8.2839e-02, PNorm = 35.2600, GNorm = 2.1581, lr_0 = 1.7935e-04
Loss = 7.1117e-02, PNorm = 35.2651, GNorm = 0.8001, lr_0 = 1.7433e-04
Validation rmse = 0.147434
Validation r2 = 0.827414
Validation mse = 0.021737
Epoch 43
Loss = 7.8265e-02, PNorm = 35.2680, GNorm = 0.7662, lr_0 = 1.6946e-04
Validation rmse = 0.148369
Validation r2 = 0.825218
Validation mse = 0.022013
Epoch 44
Loss = 8.4179e-02, PNorm = 35.2741, GNorm = 1.4242, lr_0 = 1.6425e-04
Loss = 6.8113e-02, PNorm = 35.2779, GNorm = 1.1581, lr_0 = 1.5966e-04
Validation rmse = 0.146070
Validation r2 = 0.830592
Validation mse = 0.021336
Epoch 45
Loss = 7.3455e-02, PNorm = 35.2824, GNorm = 1.0006, lr_0 = 1.5520e-04
Validation rmse = 0.146492
Validation r2 = 0.829611
Validation mse = 0.021460
Epoch 46
Loss = 7.5785e-02, PNorm = 35.2850, GNorm = 0.8890, lr_0 = 1.5086e-04
Loss = 6.7682e-02, PNorm = 35.2893, GNorm = 1.2269, lr_0 = 1.4664e-04
Loss = 7.3881e-02, PNorm = 35.2896, GNorm = 1.1110, lr_0 = 1.4623e-04
Validation rmse = 0.148411
Validation r2 = 0.825117
Validation mse = 0.022026
Epoch 47
Loss = 7.2902e-02, PNorm = 35.2938, GNorm = 0.5539, lr_0 = 1.4214e-04
Validation rmse = 0.147390
Validation r2 = 0.827515
Validation mse = 0.021724
Epoch 48
Loss = 7.5713e-02, PNorm = 35.2976, GNorm = 0.6038, lr_0 = 1.3816e-04
Loss = 6.4096e-02, PNorm = 35.3012, GNorm = 0.5269, lr_0 = 1.3430e-04
Validation rmse = 0.145472
Validation r2 = 0.831977
Validation mse = 0.021162
Epoch 49
Loss = 6.9847e-02, PNorm = 35.3048, GNorm = 1.4857, lr_0 = 1.3055e-04
Validation rmse = 0.146194
Validation r2 = 0.830303
Validation mse = 0.021373
Epoch 50
Loss = 6.7813e-02, PNorm = 35.3078, GNorm = 1.9854, lr_0 = 1.2690e-04
Validation rmse = 0.145252
Validation r2 = 0.832484
Validation mse = 0.021098
Epoch 51
Loss = 6.6378e-02, PNorm = 35.3118, GNorm = 1.7241, lr_0 = 1.2300e-04
Loss = 6.8646e-02, PNorm = 35.3149, GNorm = 1.0329, lr_0 = 1.1956e-04
Validation rmse = 0.145538
Validation r2 = 0.831823
Validation mse = 0.021181
Epoch 52
Loss = 6.9007e-02, PNorm = 35.3179, GNorm = 2.6115, lr_0 = 1.1622e-04
Validation rmse = 0.146324
Validation r2 = 0.830002
Validation mse = 0.021411
Epoch 53
Loss = 7.1621e-02, PNorm = 35.3208, GNorm = 2.2372, lr_0 = 1.1297e-04
Loss = 6.6688e-02, PNorm = 35.3241, GNorm = 2.3726, lr_0 = 1.0981e-04
Validation rmse = 0.146084
Validation r2 = 0.830559
Validation mse = 0.021341
Epoch 54
Loss = 6.2795e-02, PNorm = 35.3269, GNorm = 1.0924, lr_0 = 1.0644e-04
Validation rmse = 0.146601
Validation r2 = 0.829357
Validation mse = 0.021492
Epoch 55
Loss = 5.5584e-02, PNorm = 35.3295, GNorm = 0.6186, lr_0 = 1.0346e-04
Loss = 6.4070e-02, PNorm = 35.3321, GNorm = 1.6236, lr_0 = 1.0057e-04
Validation rmse = 0.146712
Validation r2 = 0.829100
Validation mse = 0.021524
Epoch 56
Loss = 6.0544e-02, PNorm = 35.3352, GNorm = 0.7895, lr_0 = 1.0000e-04
Validation rmse = 0.151343
Validation r2 = 0.818141
Validation mse = 0.022905
Epoch 57
Loss = 5.7192e-02, PNorm = 35.3387, GNorm = 0.5233, lr_0 = 1.0000e-04
Loss = 7.5751e-02, PNorm = 35.3410, GNorm = 2.5810, lr_0 = 1.0000e-04
Validation rmse = 0.145179
Validation r2 = 0.832652
Validation mse = 0.021077
Epoch 58
Loss = 6.7646e-02, PNorm = 35.3434, GNorm = 1.0605, lr_0 = 1.0000e-04
Validation rmse = 0.147087
Validation r2 = 0.828225
Validation mse = 0.021635
Epoch 59
Loss = 6.6839e-02, PNorm = 35.3467, GNorm = 0.6983, lr_0 = 1.0000e-04
Loss = 6.7039e-02, PNorm = 35.3490, GNorm = 1.1496, lr_0 = 1.0000e-04
Validation rmse = 0.145863
Validation r2 = 0.831071
Validation mse = 0.021276
Model 0 best validation rmse = 0.145179 on epoch 57
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.224749
Model 0 test r2 = 0.161392
Model 0 test mse = 0.050512
Ensemble test rmse = 0.224749
Ensemble test r2 = 0.161392
Ensemble test mse = 0.050512
10-fold cross validation
	Seed 0 ==> test rmse = 0.182008
	Seed 0 ==> test r2 = 0.450020
	Seed 0 ==> test mse = 0.033127
	Seed 1 ==> test rmse = 0.228372
	Seed 1 ==> test r2 = 0.134138
	Seed 1 ==> test mse = 0.052154
	Seed 2 ==> test rmse = 0.188686
	Seed 2 ==> test r2 = 0.408923
	Seed 2 ==> test mse = 0.035602
	Seed 3 ==> test rmse = 0.159683
	Seed 3 ==> test r2 = 0.576669
	Seed 3 ==> test mse = 0.025499
	Seed 4 ==> test rmse = 0.173183
	Seed 4 ==> test r2 = 0.502059
	Seed 4 ==> test mse = 0.029993
	Seed 5 ==> test rmse = 0.202772
	Seed 5 ==> test r2 = 0.317378
	Seed 5 ==> test mse = 0.041116
	Seed 6 ==> test rmse = 0.196927
	Seed 6 ==> test r2 = 0.356165
	Seed 6 ==> test mse = 0.038780
	Seed 7 ==> test rmse = 0.208514
	Seed 7 ==> test r2 = 0.278171
	Seed 7 ==> test mse = 0.043478
	Seed 8 ==> test rmse = 0.176405
	Seed 8 ==> test r2 = 0.483363
	Seed 8 ==> test mse = 0.031119
	Seed 9 ==> test rmse = 0.224749
	Seed 9 ==> test r2 = 0.161392
	Seed 9 ==> test mse = 0.050512
Overall test rmse = 0.194130 +/- 0.021250
Overall test r2 = 0.366828 +/- 0.138334
Overall test mse = 0.038138 +/- 0.008332
Elapsed time = 0:06:25
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-1d5c3576-9790-4896-9034-9bb28ba18d8e.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/EtOAc_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2', 'mse'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2', 'mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/generalization_3/EtOAc_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/EtOAc_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 957 | train size = 765 | val size = 192 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.5686e-01, PNorm = 34.0154, GNorm = 2.6747, lr_0 = 4.3000e-04
Validation rmse = 0.290499
Validation r2 = 0.286434
Validation mse = 0.084390
Epoch 1
Loss = 7.2423e-01, PNorm = 34.0488, GNorm = 4.9892, lr_0 = 7.6000e-04
Loss = 6.7942e-01, PNorm = 34.0950, GNorm = 3.7535, lr_0 = 9.9472e-04
Loss = 5.5326e-01, PNorm = 34.1013, GNorm = 5.6768, lr_0 = 9.9209e-04
Validation rmse = 0.257162
Validation r2 = 0.440808
Validation mse = 0.066133
Epoch 2
Loss = 4.8724e-01, PNorm = 34.1715, GNorm = 4.4792, lr_0 = 9.6618e-04
Validation rmse = 0.234773
Validation r2 = 0.533938
Validation mse = 0.055119
Epoch 3
Loss = 3.9803e-01, PNorm = 34.2517, GNorm = 5.4547, lr_0 = 9.3846e-04
Loss = 3.3751e-01, PNorm = 34.3203, GNorm = 1.1781, lr_0 = 9.1394e-04
Validation rmse = 0.201939
Validation r2 = 0.655183
Validation mse = 0.040780
Epoch 4
Loss = 2.4936e-01, PNorm = 34.3787, GNorm = 4.8868, lr_0 = 8.9007e-04
Validation rmse = 0.177110
Validation r2 = 0.734766
Validation mse = 0.031368
Epoch 5
Loss = 2.2911e-01, PNorm = 34.4408, GNorm = 5.5085, lr_0 = 8.6453e-04
Loss = 2.3476e-01, PNorm = 34.4916, GNorm = 4.7234, lr_0 = 8.4195e-04
Validation rmse = 0.220308
Validation r2 = 0.589601
Validation mse = 0.048536
Epoch 6
Loss = 3.0473e-01, PNorm = 34.5413, GNorm = 2.1217, lr_0 = 8.1779e-04
Validation rmse = 0.149639
Validation r2 = 0.810663
Validation mse = 0.022392
Epoch 7
Loss = 2.3043e-01, PNorm = 34.5831, GNorm = 3.9963, lr_0 = 7.9643e-04
Loss = 1.9645e-01, PNorm = 34.6298, GNorm = 1.8334, lr_0 = 7.7563e-04
Validation rmse = 0.179791
Validation r2 = 0.726674
Validation mse = 0.032325
Epoch 8
Loss = 1.9120e-01, PNorm = 34.6631, GNorm = 3.2057, lr_0 = 7.5338e-04
Validation rmse = 0.154613
Validation r2 = 0.797866
Validation mse = 0.023905
Epoch 9
Loss = 1.4949e-01, PNorm = 34.6994, GNorm = 1.0432, lr_0 = 7.3176e-04
Loss = 1.6794e-01, PNorm = 34.7243, GNorm = 4.7107, lr_0 = 7.1265e-04
Validation rmse = 0.137144
Validation r2 = 0.840963
Validation mse = 0.018808
Epoch 10
Loss = 1.7860e-01, PNorm = 34.7589, GNorm = 1.4687, lr_0 = 6.9403e-04
Validation rmse = 0.132594
Validation r2 = 0.851340
Validation mse = 0.017581
Epoch 11
Loss = 1.7005e-01, PNorm = 34.7887, GNorm = 2.7964, lr_0 = 6.7412e-04
Loss = 1.4732e-01, PNorm = 34.8177, GNorm = 1.4932, lr_0 = 6.5651e-04
Validation rmse = 0.134762
Validation r2 = 0.846439
Validation mse = 0.018161
Epoch 12
Loss = 1.2805e-01, PNorm = 34.8395, GNorm = 0.8885, lr_0 = 6.3767e-04
Validation rmse = 0.127313
Validation r2 = 0.862946
Validation mse = 0.016209
Epoch 13
Loss = 1.4620e-01, PNorm = 34.8587, GNorm = 0.5022, lr_0 = 6.1938e-04
Loss = 1.1436e-01, PNorm = 34.8789, GNorm = 1.3701, lr_0 = 6.0320e-04
Validation rmse = 0.126770
Validation r2 = 0.864113
Validation mse = 0.016071
Epoch 14
Loss = 1.2884e-01, PNorm = 34.8969, GNorm = 1.0431, lr_0 = 5.8744e-04
Validation rmse = 0.130530
Validation r2 = 0.855933
Validation mse = 0.017038
Epoch 15
Loss = 1.0969e-01, PNorm = 34.9157, GNorm = 1.1823, lr_0 = 5.7059e-04
Loss = 1.2521e-01, PNorm = 34.9288, GNorm = 1.1360, lr_0 = 5.5568e-04
Validation rmse = 0.129937
Validation r2 = 0.857238
Validation mse = 0.016884
Epoch 16
Loss = 1.3495e-01, PNorm = 34.9495, GNorm = 3.0275, lr_0 = 5.3974e-04
Loss = 1.1885e-01, PNorm = 34.9639, GNorm = 6.3127, lr_0 = 5.2564e-04
Validation rmse = 0.127849
Validation r2 = 0.861790
Validation mse = 0.016345
Epoch 17
Loss = 1.2915e-01, PNorm = 34.9773, GNorm = 2.8913, lr_0 = 5.1191e-04
Validation rmse = 0.123778
Validation r2 = 0.870452
Validation mse = 0.015321
Epoch 18
Loss = 1.1310e-01, PNorm = 34.9922, GNorm = 2.0635, lr_0 = 4.9722e-04
Loss = 1.1450e-01, PNorm = 35.0086, GNorm = 1.3162, lr_0 = 4.8424e-04
Loss = 1.3897e-01, PNorm = 35.0105, GNorm = 2.4107, lr_0 = 4.8296e-04
Validation rmse = 0.129923
Validation r2 = 0.857270
Validation mse = 0.016880
Epoch 19
Loss = 1.2408e-01, PNorm = 35.0282, GNorm = 1.5193, lr_0 = 4.7034e-04
Validation rmse = 0.137488
Validation r2 = 0.840163
Validation mse = 0.018903
Epoch 20
Loss = 1.0015e-01, PNorm = 35.0443, GNorm = 2.1210, lr_0 = 4.5806e-04
Loss = 1.1339e-01, PNorm = 35.0598, GNorm = 0.6669, lr_0 = 4.4609e-04
Validation rmse = 0.123336
Validation r2 = 0.871375
Validation mse = 0.015212
Epoch 21
Loss = 1.0759e-01, PNorm = 35.0780, GNorm = 2.6056, lr_0 = 4.3329e-04
Validation rmse = 0.123454
Validation r2 = 0.871128
Validation mse = 0.015241
Epoch 22
Loss = 9.6073e-02, PNorm = 35.0931, GNorm = 0.4946, lr_0 = 4.2086e-04
Loss = 1.0279e-01, PNorm = 35.1064, GNorm = 2.7327, lr_0 = 4.0987e-04
Validation rmse = 0.126264
Validation r2 = 0.865194
Validation mse = 0.015943
Epoch 23
Loss = 1.0893e-01, PNorm = 35.1196, GNorm = 2.4120, lr_0 = 3.9811e-04
Validation rmse = 0.119517
Validation r2 = 0.879218
Validation mse = 0.014284
Epoch 24
Loss = 8.2318e-02, PNorm = 35.1292, GNorm = 3.5806, lr_0 = 3.8771e-04
Loss = 1.1327e-01, PNorm = 35.1414, GNorm = 2.1197, lr_0 = 3.7758e-04
Validation rmse = 0.126951
Validation r2 = 0.863725
Validation mse = 0.016117
Epoch 25
Loss = 9.7983e-02, PNorm = 35.1518, GNorm = 0.9106, lr_0 = 3.6675e-04
Validation rmse = 0.118087
Validation r2 = 0.882091
Validation mse = 0.013944
Epoch 26
Loss = 9.8533e-02, PNorm = 35.1642, GNorm = 1.0996, lr_0 = 3.5622e-04
Loss = 1.0078e-01, PNorm = 35.1741, GNorm = 0.8829, lr_0 = 3.4692e-04
Validation rmse = 0.120964
Validation r2 = 0.876275
Validation mse = 0.014632
Epoch 27
Loss = 9.9987e-02, PNorm = 35.1824, GNorm = 2.4328, lr_0 = 3.3786e-04
Validation rmse = 0.134317
Validation r2 = 0.847452
Validation mse = 0.018041
Epoch 28
Loss = 9.0346e-02, PNorm = 35.1935, GNorm = 1.0287, lr_0 = 3.2816e-04
Loss = 8.6186e-02, PNorm = 35.2051, GNorm = 1.2435, lr_0 = 3.1959e-04
Validation rmse = 0.123097
Validation r2 = 0.871873
Validation mse = 0.015153
Epoch 29
Loss = 1.3089e-01, PNorm = 35.2163, GNorm = 3.2226, lr_0 = 3.1042e-04
Validation rmse = 0.119510
Validation r2 = 0.879231
Validation mse = 0.014283
Epoch 30
Loss = 1.0240e-01, PNorm = 35.2261, GNorm = 2.5185, lr_0 = 3.0232e-04
Loss = 8.0014e-02, PNorm = 35.2363, GNorm = 0.8564, lr_0 = 2.9442e-04
Validation rmse = 0.120322
Validation r2 = 0.877584
Validation mse = 0.014477
Epoch 31
Loss = 8.3043e-02, PNorm = 35.2465, GNorm = 1.5418, lr_0 = 2.8597e-04
Validation rmse = 0.119283
Validation r2 = 0.879689
Validation mse = 0.014229
Epoch 32
Loss = 6.5153e-02, PNorm = 35.2542, GNorm = 1.0629, lr_0 = 2.7777e-04
Loss = 1.0658e-01, PNorm = 35.2616, GNorm = 0.9445, lr_0 = 2.7051e-04
Validation rmse = 0.138956
Validation r2 = 0.836733
Validation mse = 0.019309
Epoch 33
Loss = 8.4799e-02, PNorm = 35.2705, GNorm = 1.4889, lr_0 = 2.6275e-04
Loss = 9.8966e-02, PNorm = 35.2795, GNorm = 1.6797, lr_0 = 2.5589e-04
Validation rmse = 0.119341
Validation r2 = 0.879574
Validation mse = 0.014242
Epoch 34
Loss = 8.2218e-02, PNorm = 35.2878, GNorm = 0.5631, lr_0 = 2.4920e-04
Validation rmse = 0.121135
Validation r2 = 0.875924
Validation mse = 0.014674
Epoch 35
Loss = 7.3037e-02, PNorm = 35.2946, GNorm = 1.9644, lr_0 = 2.4205e-04
Loss = 9.2392e-02, PNorm = 35.3018, GNorm = 1.0795, lr_0 = 2.3573e-04
Loss = 5.4392e-02, PNorm = 35.3024, GNorm = 1.0868, lr_0 = 2.3511e-04
Validation rmse = 0.119449
Validation r2 = 0.879354
Validation mse = 0.014268
Epoch 36
Loss = 8.8192e-02, PNorm = 35.3097, GNorm = 1.8385, lr_0 = 2.2897e-04
Validation rmse = 0.119890
Validation r2 = 0.878463
Validation mse = 0.014374
Epoch 37
Loss = 7.8950e-02, PNorm = 35.3158, GNorm = 0.5718, lr_0 = 2.2299e-04
Loss = 9.2996e-02, PNorm = 35.3226, GNorm = 0.8613, lr_0 = 2.1716e-04
Validation rmse = 0.126735
Validation r2 = 0.864187
Validation mse = 0.016062
Epoch 38
Loss = 9.0959e-02, PNorm = 35.3280, GNorm = 0.9438, lr_0 = 2.1093e-04
Validation rmse = 0.119727
Validation r2 = 0.878793
Validation mse = 0.014334
Epoch 39
Loss = 8.3367e-02, PNorm = 35.3354, GNorm = 0.8361, lr_0 = 2.0488e-04
Loss = 8.3691e-02, PNorm = 35.3427, GNorm = 2.0436, lr_0 = 1.9953e-04
Validation rmse = 0.134041
Validation r2 = 0.848078
Validation mse = 0.017967
Epoch 40
Loss = 9.9850e-02, PNorm = 35.3486, GNorm = 4.4134, lr_0 = 1.9431e-04
Validation rmse = 0.119987
Validation r2 = 0.878266
Validation mse = 0.014397
Epoch 41
Loss = 1.0992e-01, PNorm = 35.3569, GNorm = 2.4470, lr_0 = 1.8874e-04
Loss = 8.5770e-02, PNorm = 35.3637, GNorm = 1.3251, lr_0 = 1.8381e-04
Validation rmse = 0.118111
Validation r2 = 0.882041
Validation mse = 0.013950
Epoch 42
Loss = 7.4630e-02, PNorm = 35.3703, GNorm = 0.9830, lr_0 = 1.7854e-04
Validation rmse = 0.127607
Validation r2 = 0.862313
Validation mse = 0.016284
Epoch 43
Loss = 8.3595e-02, PNorm = 35.3757, GNorm = 2.1605, lr_0 = 1.7341e-04
Loss = 8.2089e-02, PNorm = 35.3811, GNorm = 1.1147, lr_0 = 1.6888e-04
Validation rmse = 0.118350
Validation r2 = 0.881564
Validation mse = 0.014007
Epoch 44
Loss = 8.1932e-02, PNorm = 35.3854, GNorm = 1.7270, lr_0 = 1.6447e-04
Validation rmse = 0.117640
Validation r2 = 0.882982
Validation mse = 0.013839
Epoch 45
Loss = 6.3871e-02, PNorm = 35.3912, GNorm = 1.4270, lr_0 = 1.5975e-04
Loss = 7.6931e-02, PNorm = 35.3957, GNorm = 0.7882, lr_0 = 1.5558e-04
Validation rmse = 0.122191
Validation r2 = 0.873751
Validation mse = 0.014931
Epoch 46
Loss = 7.1741e-02, PNorm = 35.4014, GNorm = 0.4036, lr_0 = 1.5112e-04
Validation rmse = 0.117894
Validation r2 = 0.882475
Validation mse = 0.013899
Epoch 47
Loss = 6.9950e-02, PNorm = 35.4064, GNorm = 0.8819, lr_0 = 1.4717e-04
Loss = 7.8544e-02, PNorm = 35.4106, GNorm = 0.8968, lr_0 = 1.4332e-04
Validation rmse = 0.126196
Validation r2 = 0.865341
Validation mse = 0.015925
Epoch 48
Loss = 7.2315e-02, PNorm = 35.4158, GNorm = 0.9213, lr_0 = 1.3921e-04
Validation rmse = 0.117546
Validation r2 = 0.883168
Validation mse = 0.013817
Epoch 49
Loss = 7.8882e-02, PNorm = 35.4212, GNorm = 1.3169, lr_0 = 1.3522e-04
Loss = 8.0374e-02, PNorm = 35.4246, GNorm = 0.8701, lr_0 = 1.3169e-04
Validation rmse = 0.122309
Validation r2 = 0.873507
Validation mse = 0.014960
Epoch 50
Loss = 7.4154e-02, PNorm = 35.4289, GNorm = 2.0852, lr_0 = 1.2825e-04
Loss = 8.1623e-02, PNorm = 35.4325, GNorm = 0.8808, lr_0 = 1.2490e-04
Loss = 4.5566e-02, PNorm = 35.4327, GNorm = 0.9450, lr_0 = 1.2457e-04
Validation rmse = 0.119553
Validation r2 = 0.879145
Validation mse = 0.014293
Epoch 51
Loss = 8.2004e-02, PNorm = 35.4372, GNorm = 2.4125, lr_0 = 1.2131e-04
Validation rmse = 0.119557
Validation r2 = 0.879137
Validation mse = 0.014294
Epoch 52
Loss = 7.1485e-02, PNorm = 35.4410, GNorm = 1.3963, lr_0 = 1.1783e-04
Loss = 7.4631e-02, PNorm = 35.4445, GNorm = 0.4985, lr_0 = 1.1475e-04
Loss = 1.0998e-01, PNorm = 35.4448, GNorm = 3.1654, lr_0 = 1.1445e-04
Validation rmse = 0.116859
Validation r2 = 0.884530
Validation mse = 0.013656
Epoch 53
Loss = 7.7009e-02, PNorm = 35.4490, GNorm = 1.3898, lr_0 = 1.1146e-04
Validation rmse = 0.120000
Validation r2 = 0.878239
Validation mse = 0.014400
Epoch 54
Loss = 8.4518e-02, PNorm = 35.4527, GNorm = 0.8329, lr_0 = 1.0855e-04
Loss = 6.8145e-02, PNorm = 35.4560, GNorm = 0.7625, lr_0 = 1.0572e-04
Validation rmse = 0.119755
Validation r2 = 0.878735
Validation mse = 0.014341
Epoch 55
Loss = 6.4185e-02, PNorm = 35.4596, GNorm = 1.0620, lr_0 = 1.0268e-04
Validation rmse = 0.122811
Validation r2 = 0.872468
Validation mse = 0.015082
Epoch 56
Loss = 5.7962e-02, PNorm = 35.4630, GNorm = 0.6337, lr_0 = 1.0000e-04
Loss = 8.0234e-02, PNorm = 35.4666, GNorm = 3.0813, lr_0 = 1.0000e-04
Validation rmse = 0.117646
Validation r2 = 0.882969
Validation mse = 0.013841
Epoch 57
Loss = 7.7180e-02, PNorm = 35.4698, GNorm = 0.9952, lr_0 = 1.0000e-04
Validation rmse = 0.116764
Validation r2 = 0.884717
Validation mse = 0.013634
Epoch 58
Loss = 7.3577e-02, PNorm = 35.4734, GNorm = 1.6931, lr_0 = 1.0000e-04
Loss = 7.4578e-02, PNorm = 35.4770, GNorm = 0.4941, lr_0 = 1.0000e-04
Validation rmse = 0.115983
Validation r2 = 0.886254
Validation mse = 0.013452
Epoch 59
Loss = 7.0712e-02, PNorm = 35.4805, GNorm = 1.0006, lr_0 = 1.0000e-04
Validation rmse = 0.117977
Validation r2 = 0.882311
Validation mse = 0.013918
Model 0 best validation rmse = 0.115983 on epoch 58
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.271958
Model 0 test r2 = -0.493729
Model 0 test mse = 0.073961
Ensemble test rmse = 0.271958
Ensemble test r2 = -0.493729
Ensemble test mse = 0.073961
Fold 1
Splitting data with seed 1
Total size = 957 | train size = 765 | val size = 192 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.3167e-01, PNorm = 34.0180, GNorm = 8.9399, lr_0 = 4.3000e-04
Validation rmse = 0.300003
Validation r2 = 0.214503
Validation mse = 0.090002
Epoch 1
Loss = 6.7193e-01, PNorm = 34.0517, GNorm = 7.2697, lr_0 = 7.6000e-04
Loss = 6.7674e-01, PNorm = 34.1034, GNorm = 6.2501, lr_0 = 9.9472e-04
Loss = 6.1999e-01, PNorm = 34.1099, GNorm = 6.6561, lr_0 = 9.9209e-04
Validation rmse = 0.276046
Validation r2 = 0.334946
Validation mse = 0.076202
Epoch 2
Loss = 4.5633e-01, PNorm = 34.1833, GNorm = 4.7322, lr_0 = 9.6618e-04
Validation rmse = 0.268836
Validation r2 = 0.369235
Validation mse = 0.072273
Epoch 3
Loss = 4.4766e-01, PNorm = 34.2602, GNorm = 3.3128, lr_0 = 9.3846e-04
Loss = 3.6965e-01, PNorm = 34.3168, GNorm = 2.8311, lr_0 = 9.1394e-04
Validation rmse = 0.222250
Validation r2 = 0.568900
Validation mse = 0.049395
Epoch 4
Loss = 2.9642e-01, PNorm = 34.3729, GNorm = 1.2307, lr_0 = 8.9007e-04
Validation rmse = 0.199122
Validation r2 = 0.653957
Validation mse = 0.039649
Epoch 5
Loss = 2.5300e-01, PNorm = 34.4280, GNorm = 1.7907, lr_0 = 8.6453e-04
Loss = 2.4713e-01, PNorm = 34.4714, GNorm = 0.6576, lr_0 = 8.4195e-04
Validation rmse = 0.198190
Validation r2 = 0.657190
Validation mse = 0.039279
Epoch 6
Loss = 2.2091e-01, PNorm = 34.5139, GNorm = 0.6148, lr_0 = 8.1779e-04
Validation rmse = 0.182745
Validation r2 = 0.708536
Validation mse = 0.033396
Epoch 7
Loss = 1.2244e-01, PNorm = 34.5568, GNorm = 0.8209, lr_0 = 7.9643e-04
Loss = 2.5884e-01, PNorm = 34.5936, GNorm = 4.8786, lr_0 = 7.7563e-04
Validation rmse = 0.177434
Validation r2 = 0.725231
Validation mse = 0.031483
Epoch 8
Loss = 1.8476e-01, PNorm = 34.6379, GNorm = 2.2637, lr_0 = 7.5338e-04
Validation rmse = 0.198682
Validation r2 = 0.655484
Validation mse = 0.039475
Epoch 9
Loss = 2.1446e-01, PNorm = 34.6733, GNorm = 2.7033, lr_0 = 7.3176e-04
Loss = 1.6345e-01, PNorm = 34.7078, GNorm = 2.7280, lr_0 = 7.1265e-04
Validation rmse = 0.170191
Validation r2 = 0.747206
Validation mse = 0.028965
Epoch 10
Loss = 1.7410e-01, PNorm = 34.7396, GNorm = 2.4322, lr_0 = 6.9403e-04
Validation rmse = 0.165479
Validation r2 = 0.761010
Validation mse = 0.027383
Epoch 11
Loss = 1.6144e-01, PNorm = 34.7741, GNorm = 3.9500, lr_0 = 6.7412e-04
Loss = 1.4909e-01, PNorm = 34.7984, GNorm = 5.1419, lr_0 = 6.5651e-04
Validation rmse = 0.164686
Validation r2 = 0.763295
Validation mse = 0.027122
Epoch 12
Loss = 1.3286e-01, PNorm = 34.8272, GNorm = 1.4260, lr_0 = 6.3767e-04
Validation rmse = 0.160223
Validation r2 = 0.775951
Validation mse = 0.025671
Epoch 13
Loss = 1.4922e-01, PNorm = 34.8524, GNorm = 0.7112, lr_0 = 6.1938e-04
Loss = 1.2590e-01, PNorm = 34.8734, GNorm = 1.1719, lr_0 = 6.0320e-04
Validation rmse = 0.152360
Validation r2 = 0.797402
Validation mse = 0.023214
Epoch 14
Loss = 1.2637e-01, PNorm = 34.8889, GNorm = 2.0624, lr_0 = 5.8744e-04
Validation rmse = 0.152748
Validation r2 = 0.796371
Validation mse = 0.023332
Epoch 15
Loss = 1.1382e-01, PNorm = 34.9074, GNorm = 0.8127, lr_0 = 5.7059e-04
Loss = 1.2109e-01, PNorm = 34.9286, GNorm = 2.8856, lr_0 = 5.5568e-04
Validation rmse = 0.155694
Validation r2 = 0.788437
Validation mse = 0.024241
Epoch 16
Loss = 1.3220e-01, PNorm = 34.9486, GNorm = 0.6850, lr_0 = 5.3974e-04
Loss = 1.0461e-01, PNorm = 34.9621, GNorm = 0.7312, lr_0 = 5.2564e-04
Validation rmse = 0.151212
Validation r2 = 0.800445
Validation mse = 0.022865
Epoch 17
Loss = 9.9104e-02, PNorm = 34.9792, GNorm = 1.4648, lr_0 = 5.1191e-04
Validation rmse = 0.149970
Validation r2 = 0.803708
Validation mse = 0.022491
Epoch 18
Loss = 1.0144e-01, PNorm = 34.9953, GNorm = 1.9972, lr_0 = 4.9722e-04
Loss = 1.1268e-01, PNorm = 35.0076, GNorm = 2.7126, lr_0 = 4.8424e-04
Loss = 1.5374e-01, PNorm = 35.0088, GNorm = 2.6348, lr_0 = 4.8296e-04
Validation rmse = 0.148533
Validation r2 = 0.807452
Validation mse = 0.022062
Epoch 19
Loss = 1.0691e-01, PNorm = 35.0242, GNorm = 3.8174, lr_0 = 4.7034e-04
Validation rmse = 0.153052
Validation r2 = 0.795559
Validation mse = 0.023425
Epoch 20
Loss = 9.2266e-02, PNorm = 35.0380, GNorm = 0.9939, lr_0 = 4.5806e-04
Loss = 1.1179e-01, PNorm = 35.0543, GNorm = 1.3972, lr_0 = 4.4609e-04
Validation rmse = 0.150670
Validation r2 = 0.801873
Validation mse = 0.022701
Epoch 21
Loss = 9.7755e-02, PNorm = 35.0647, GNorm = 1.9492, lr_0 = 4.3329e-04
Validation rmse = 0.151660
Validation r2 = 0.799258
Validation mse = 0.023001
Epoch 22
Loss = 9.1935e-02, PNorm = 35.0775, GNorm = 0.5992, lr_0 = 4.2086e-04
Loss = 1.0298e-01, PNorm = 35.0899, GNorm = 0.4786, lr_0 = 4.0987e-04
Validation rmse = 0.156748
Validation r2 = 0.785564
Validation mse = 0.024570
Epoch 23
Loss = 9.5174e-02, PNorm = 35.1063, GNorm = 3.1781, lr_0 = 3.9811e-04
Validation rmse = 0.145363
Validation r2 = 0.815583
Validation mse = 0.021130
Epoch 24
Loss = 1.0266e-01, PNorm = 35.1174, GNorm = 3.2808, lr_0 = 3.8771e-04
Loss = 9.4315e-02, PNorm = 35.1293, GNorm = 2.5592, lr_0 = 3.7758e-04
Validation rmse = 0.147004
Validation r2 = 0.811396
Validation mse = 0.021610
Epoch 25
Loss = 7.6499e-02, PNorm = 35.1395, GNorm = 0.6589, lr_0 = 3.6675e-04
Validation rmse = 0.147262
Validation r2 = 0.810735
Validation mse = 0.021686
Epoch 26
Loss = 9.2498e-02, PNorm = 35.1500, GNorm = 0.8226, lr_0 = 3.5622e-04
Loss = 9.6977e-02, PNorm = 35.1609, GNorm = 1.7105, lr_0 = 3.4692e-04
Validation rmse = 0.160141
Validation r2 = 0.776180
Validation mse = 0.025645
Epoch 27
Loss = 9.5797e-02, PNorm = 35.1725, GNorm = 1.8949, lr_0 = 3.3786e-04
Validation rmse = 0.147701
Validation r2 = 0.809604
Validation mse = 0.021815
Epoch 28
Loss = 7.6273e-02, PNorm = 35.1832, GNorm = 1.8026, lr_0 = 3.2816e-04
Loss = 9.0422e-02, PNorm = 35.1938, GNorm = 0.9770, lr_0 = 3.1959e-04
Validation rmse = 0.146842
Validation r2 = 0.811811
Validation mse = 0.021563
Epoch 29
Loss = 9.3711e-02, PNorm = 35.2030, GNorm = 2.6973, lr_0 = 3.1042e-04
Validation rmse = 0.144478
Validation r2 = 0.817822
Validation mse = 0.020874
Epoch 30
Loss = 8.3043e-02, PNorm = 35.2122, GNorm = 0.9024, lr_0 = 3.0232e-04
Loss = 8.1974e-02, PNorm = 35.2229, GNorm = 1.2168, lr_0 = 2.9442e-04
Validation rmse = 0.145363
Validation r2 = 0.815584
Validation mse = 0.021130
Epoch 31
Loss = 8.7315e-02, PNorm = 35.2305, GNorm = 1.9638, lr_0 = 2.8597e-04
Validation rmse = 0.145654
Validation r2 = 0.814845
Validation mse = 0.021215
Epoch 32
Loss = 8.3688e-02, PNorm = 35.2402, GNorm = 0.6267, lr_0 = 2.7777e-04
Loss = 9.0560e-02, PNorm = 35.2484, GNorm = 1.7908, lr_0 = 2.7051e-04
Validation rmse = 0.144471
Validation r2 = 0.817840
Validation mse = 0.020872
Epoch 33
Loss = 8.8266e-02, PNorm = 35.2572, GNorm = 1.3082, lr_0 = 2.6275e-04
Loss = 8.0961e-02, PNorm = 35.2652, GNorm = 1.5854, lr_0 = 2.5589e-04
Validation rmse = 0.146248
Validation r2 = 0.813332
Validation mse = 0.021388
Epoch 34
Loss = 8.6726e-02, PNorm = 35.2730, GNorm = 0.5458, lr_0 = 2.4920e-04
Validation rmse = 0.146437
Validation r2 = 0.812848
Validation mse = 0.021444
Epoch 35
Loss = 7.0104e-02, PNorm = 35.2804, GNorm = 0.5709, lr_0 = 2.4205e-04
Loss = 9.1417e-02, PNorm = 35.2855, GNorm = 1.1147, lr_0 = 2.3573e-04
Loss = 3.0401e-02, PNorm = 35.2859, GNorm = 0.9205, lr_0 = 2.3511e-04
Validation rmse = 0.145239
Validation r2 = 0.815898
Validation mse = 0.021094
Epoch 36
Loss = 7.9794e-02, PNorm = 35.2917, GNorm = 1.2150, lr_0 = 2.2897e-04
Validation rmse = 0.143787
Validation r2 = 0.819560
Validation mse = 0.020675
Epoch 37
Loss = 9.3709e-02, PNorm = 35.2995, GNorm = 1.1390, lr_0 = 2.2299e-04
Loss = 6.9441e-02, PNorm = 35.3062, GNorm = 1.7534, lr_0 = 2.1716e-04
Validation rmse = 0.144701
Validation r2 = 0.817259
Validation mse = 0.020938
Epoch 38
Loss = 8.7057e-02, PNorm = 35.3119, GNorm = 1.0961, lr_0 = 2.1093e-04
Validation rmse = 0.143424
Validation r2 = 0.820471
Validation mse = 0.020570
Epoch 39
Loss = 8.2381e-02, PNorm = 35.3198, GNorm = 1.0448, lr_0 = 2.0488e-04
Loss = 7.6576e-02, PNorm = 35.3271, GNorm = 1.0929, lr_0 = 1.9953e-04
Validation rmse = 0.144745
Validation r2 = 0.817147
Validation mse = 0.020951
Epoch 40
Loss = 7.3404e-02, PNorm = 35.3315, GNorm = 1.3327, lr_0 = 1.9431e-04
Validation rmse = 0.143451
Validation r2 = 0.820404
Validation mse = 0.020578
Epoch 41
Loss = 6.4448e-02, PNorm = 35.3383, GNorm = 0.7695, lr_0 = 1.8874e-04
Loss = 7.8957e-02, PNorm = 35.3439, GNorm = 0.7064, lr_0 = 1.8381e-04
Validation rmse = 0.144002
Validation r2 = 0.819019
Validation mse = 0.020737
Epoch 42
Loss = 7.6562e-02, PNorm = 35.3502, GNorm = 1.0112, lr_0 = 1.7854e-04
Validation rmse = 0.142589
Validation r2 = 0.822555
Validation mse = 0.020332
Epoch 43
Loss = 6.3253e-02, PNorm = 35.3557, GNorm = 0.8365, lr_0 = 1.7341e-04
Loss = 8.2648e-02, PNorm = 35.3604, GNorm = 0.7133, lr_0 = 1.6888e-04
Validation rmse = 0.143695
Validation r2 = 0.819792
Validation mse = 0.020648
Epoch 44
Loss = 7.5760e-02, PNorm = 35.3664, GNorm = 1.5131, lr_0 = 1.6447e-04
Validation rmse = 0.142861
Validation r2 = 0.821877
Validation mse = 0.020409
Epoch 45
Loss = 7.9087e-02, PNorm = 35.3724, GNorm = 0.7198, lr_0 = 1.5975e-04
Loss = 7.0843e-02, PNorm = 35.3775, GNorm = 1.6499, lr_0 = 1.5558e-04
Validation rmse = 0.143431
Validation r2 = 0.820453
Validation mse = 0.020572
Epoch 46
Loss = 6.8902e-02, PNorm = 35.3823, GNorm = 0.6470, lr_0 = 1.5112e-04
Validation rmse = 0.142781
Validation r2 = 0.822077
Validation mse = 0.020386
Epoch 47
Loss = 6.6370e-02, PNorm = 35.3865, GNorm = 1.3813, lr_0 = 1.4717e-04
Loss = 7.1074e-02, PNorm = 35.3912, GNorm = 1.4985, lr_0 = 1.4332e-04
Validation rmse = 0.142118
Validation r2 = 0.823724
Validation mse = 0.020198
Epoch 48
Loss = 7.2324e-02, PNorm = 35.3964, GNorm = 0.3415, lr_0 = 1.3921e-04
Validation rmse = 0.143393
Validation r2 = 0.820549
Validation mse = 0.020561
Epoch 49
Loss = 4.1013e-02, PNorm = 35.4014, GNorm = 0.6703, lr_0 = 1.3522e-04
Loss = 7.5630e-02, PNorm = 35.4048, GNorm = 0.8128, lr_0 = 1.3169e-04
Validation rmse = 0.145233
Validation r2 = 0.815912
Validation mse = 0.021093
Epoch 50
Loss = 7.6430e-02, PNorm = 35.4079, GNorm = 1.4728, lr_0 = 1.2825e-04
Loss = 6.9739e-02, PNorm = 35.4127, GNorm = 1.9184, lr_0 = 1.2490e-04
Loss = 6.7992e-02, PNorm = 35.4131, GNorm = 1.3375, lr_0 = 1.2457e-04
Validation rmse = 0.144625
Validation r2 = 0.817451
Validation mse = 0.020916
Epoch 51
Loss = 6.8360e-02, PNorm = 35.4177, GNorm = 0.8854, lr_0 = 1.2131e-04
Validation rmse = 0.141707
Validation r2 = 0.824743
Validation mse = 0.020081
Epoch 52
Loss = 6.9596e-02, PNorm = 35.4215, GNorm = 0.9192, lr_0 = 1.1783e-04
Loss = 7.0588e-02, PNorm = 35.4256, GNorm = 0.5726, lr_0 = 1.1475e-04
Loss = 8.0277e-02, PNorm = 35.4259, GNorm = 3.3731, lr_0 = 1.1445e-04
Validation rmse = 0.144847
Validation r2 = 0.816891
Validation mse = 0.020981
Epoch 53
Loss = 6.9343e-02, PNorm = 35.4292, GNorm = 0.5767, lr_0 = 1.1146e-04
Validation rmse = 0.141445
Validation r2 = 0.825390
Validation mse = 0.020007
Epoch 54
Loss = 7.0708e-02, PNorm = 35.4324, GNorm = 0.6561, lr_0 = 1.0855e-04
Loss = 6.7681e-02, PNorm = 35.4362, GNorm = 0.9471, lr_0 = 1.0572e-04
Validation rmse = 0.143078
Validation r2 = 0.821336
Validation mse = 0.020471
Epoch 55
Loss = 6.9975e-02, PNorm = 35.4402, GNorm = 0.6370, lr_0 = 1.0268e-04
Validation rmse = 0.143378
Validation r2 = 0.820585
Validation mse = 0.020557
Epoch 56
Loss = 7.9591e-02, PNorm = 35.4435, GNorm = 0.6306, lr_0 = 1.0000e-04
Loss = 6.0986e-02, PNorm = 35.4464, GNorm = 0.3338, lr_0 = 1.0000e-04
Validation rmse = 0.143644
Validation r2 = 0.819920
Validation mse = 0.020634
Epoch 57
Loss = 7.1540e-02, PNorm = 35.4499, GNorm = 2.0662, lr_0 = 1.0000e-04
Validation rmse = 0.144085
Validation r2 = 0.818812
Validation mse = 0.020760
Epoch 58
Loss = 6.0438e-02, PNorm = 35.4539, GNorm = 0.6405, lr_0 = 1.0000e-04
Loss = 6.7767e-02, PNorm = 35.4574, GNorm = 0.5471, lr_0 = 1.0000e-04
Validation rmse = 0.142669
Validation r2 = 0.822356
Validation mse = 0.020354
Epoch 59
Loss = 6.8154e-02, PNorm = 35.4610, GNorm = 0.5349, lr_0 = 1.0000e-04
Validation rmse = 0.143356
Validation r2 = 0.820640
Validation mse = 0.020551
Model 0 best validation rmse = 0.141445 on epoch 53
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.276821
Model 0 test r2 = -0.547632
Model 0 test mse = 0.076630
Ensemble test rmse = 0.276821
Ensemble test r2 = -0.547632
Ensemble test mse = 0.076630
Fold 2
Splitting data with seed 2
Total size = 957 | train size = 765 | val size = 192 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1395e-01, PNorm = 34.0183, GNorm = 0.9107, lr_0 = 4.3000e-04
Validation rmse = 0.276718
Validation r2 = 0.321109
Validation mse = 0.076573
Epoch 1
Loss = 6.3472e-01, PNorm = 34.0545, GNorm = 7.8657, lr_0 = 7.6000e-04
Loss = 6.7671e-01, PNorm = 34.1060, GNorm = 3.3747, lr_0 = 9.9472e-04
Loss = 7.7338e-01, PNorm = 34.1131, GNorm = 9.2495, lr_0 = 9.9209e-04
Validation rmse = 0.252994
Validation r2 = 0.432526
Validation mse = 0.064006
Epoch 2
Loss = 5.6122e-01, PNorm = 34.1834, GNorm = 6.5878, lr_0 = 9.6618e-04
Validation rmse = 0.217475
Validation r2 = 0.580684
Validation mse = 0.047295
Epoch 3
Loss = 4.1265e-01, PNorm = 34.2597, GNorm = 0.7741, lr_0 = 9.3846e-04
Loss = 3.8661e-01, PNorm = 34.3225, GNorm = 1.6693, lr_0 = 9.1394e-04
Validation rmse = 0.195049
Validation r2 = 0.662704
Validation mse = 0.038044
Epoch 4
Loss = 3.0632e-01, PNorm = 34.3752, GNorm = 4.6682, lr_0 = 8.9007e-04
Validation rmse = 0.171946
Validation r2 = 0.737875
Validation mse = 0.029565
Epoch 5
Loss = 2.4505e-01, PNorm = 34.4312, GNorm = 3.0260, lr_0 = 8.6453e-04
Loss = 2.3519e-01, PNorm = 34.4805, GNorm = 3.3598, lr_0 = 8.4195e-04
Validation rmse = 0.159935
Validation r2 = 0.773217
Validation mse = 0.025579
Epoch 6
Loss = 2.1941e-01, PNorm = 34.5381, GNorm = 2.5743, lr_0 = 8.1779e-04
Validation rmse = 0.154666
Validation r2 = 0.787913
Validation mse = 0.023922
Epoch 7
Loss = 1.7151e-01, PNorm = 34.5835, GNorm = 1.2749, lr_0 = 7.9643e-04
Loss = 1.8106e-01, PNorm = 34.6279, GNorm = 4.0021, lr_0 = 7.7563e-04
Validation rmse = 0.139458
Validation r2 = 0.827570
Validation mse = 0.019449
Epoch 8
Loss = 1.8335e-01, PNorm = 34.6741, GNorm = 2.6239, lr_0 = 7.5338e-04
Validation rmse = 0.134186
Validation r2 = 0.840361
Validation mse = 0.018006
Epoch 9
Loss = 1.4621e-01, PNorm = 34.7186, GNorm = 3.1748, lr_0 = 7.3176e-04
Loss = 1.6565e-01, PNorm = 34.7465, GNorm = 3.8462, lr_0 = 7.1265e-04
Validation rmse = 0.150148
Validation r2 = 0.800122
Validation mse = 0.022544
Epoch 10
Loss = 1.5822e-01, PNorm = 34.7863, GNorm = 1.1036, lr_0 = 6.9403e-04
Validation rmse = 0.127765
Validation r2 = 0.855274
Validation mse = 0.016324
Epoch 11
Loss = 1.1439e-01, PNorm = 34.8192, GNorm = 4.0713, lr_0 = 6.7412e-04
Loss = 1.5977e-01, PNorm = 34.8441, GNorm = 1.7871, lr_0 = 6.5651e-04
Validation rmse = 0.138861
Validation r2 = 0.829043
Validation mse = 0.019282
Epoch 12
Loss = 1.1805e-01, PNorm = 34.8755, GNorm = 1.8636, lr_0 = 6.3767e-04
Validation rmse = 0.128470
Validation r2 = 0.853671
Validation mse = 0.016505
Epoch 13
Loss = 1.0799e-01, PNorm = 34.8986, GNorm = 2.1424, lr_0 = 6.1938e-04
Loss = 1.2381e-01, PNorm = 34.9175, GNorm = 0.5974, lr_0 = 6.0320e-04
Validation rmse = 0.131017
Validation r2 = 0.847812
Validation mse = 0.017165
Epoch 14
Loss = 1.1925e-01, PNorm = 34.9376, GNorm = 3.4788, lr_0 = 5.8744e-04
Validation rmse = 0.168940
Validation r2 = 0.746960
Validation mse = 0.028541
Epoch 15
Loss = 1.1915e-01, PNorm = 34.9556, GNorm = 3.9967, lr_0 = 5.7059e-04
Loss = 1.2583e-01, PNorm = 34.9729, GNorm = 2.3799, lr_0 = 5.5568e-04
Validation rmse = 0.134867
Validation r2 = 0.838737
Validation mse = 0.018189
Epoch 16
Loss = 1.2864e-01, PNorm = 34.9978, GNorm = 1.9091, lr_0 = 5.3974e-04
Loss = 1.2932e-01, PNorm = 35.0202, GNorm = 4.6746, lr_0 = 5.2564e-04
Validation rmse = 0.135298
Validation r2 = 0.837704
Validation mse = 0.018306
Epoch 17
Loss = 1.1738e-01, PNorm = 35.0387, GNorm = 1.0546, lr_0 = 5.1191e-04
Validation rmse = 0.132479
Validation r2 = 0.844397
Validation mse = 0.017551
Epoch 18
Loss = 1.0495e-01, PNorm = 35.0528, GNorm = 1.1353, lr_0 = 4.9722e-04
Loss = 1.0030e-01, PNorm = 35.0649, GNorm = 0.4795, lr_0 = 4.8424e-04
Loss = 2.2734e-01, PNorm = 35.0660, GNorm = 4.6664, lr_0 = 4.8296e-04
Validation rmse = 0.143428
Validation r2 = 0.817614
Validation mse = 0.020572
Epoch 19
Loss = 1.1525e-01, PNorm = 35.0824, GNorm = 2.6660, lr_0 = 4.7034e-04
Validation rmse = 0.135178
Validation r2 = 0.837991
Validation mse = 0.018273
Epoch 20
Loss = 8.8693e-02, PNorm = 35.0987, GNorm = 0.8334, lr_0 = 4.5806e-04
Loss = 1.0523e-01, PNorm = 35.1122, GNorm = 0.5629, lr_0 = 4.4609e-04
Validation rmse = 0.123969
Validation r2 = 0.863746
Validation mse = 0.015368
Epoch 21
Loss = 1.0671e-01, PNorm = 35.1267, GNorm = 1.2181, lr_0 = 4.3329e-04
Validation rmse = 0.124422
Validation r2 = 0.862747
Validation mse = 0.015481
Epoch 22
Loss = 9.0214e-02, PNorm = 35.1401, GNorm = 2.3491, lr_0 = 4.2086e-04
Loss = 1.0073e-01, PNorm = 35.1513, GNorm = 2.0533, lr_0 = 4.0987e-04
Validation rmse = 0.126023
Validation r2 = 0.859194
Validation mse = 0.015882
Epoch 23
Loss = 9.8222e-02, PNorm = 35.1653, GNorm = 0.4938, lr_0 = 3.9811e-04
Validation rmse = 0.127844
Validation r2 = 0.855094
Validation mse = 0.016344
Epoch 24
Loss = 9.9918e-02, PNorm = 35.1778, GNorm = 2.3968, lr_0 = 3.8771e-04
Loss = 9.6497e-02, PNorm = 35.1888, GNorm = 1.3065, lr_0 = 3.7758e-04
Validation rmse = 0.127141
Validation r2 = 0.856683
Validation mse = 0.016165
Epoch 25
Loss = 1.1036e-01, PNorm = 35.2025, GNorm = 1.7114, lr_0 = 3.6675e-04
Validation rmse = 0.124371
Validation r2 = 0.862860
Validation mse = 0.015468
Epoch 26
Loss = 1.0220e-01, PNorm = 35.2161, GNorm = 2.8954, lr_0 = 3.5622e-04
Loss = 9.3178e-02, PNorm = 35.2272, GNorm = 1.5803, lr_0 = 3.4692e-04
Validation rmse = 0.122869
Validation r2 = 0.866154
Validation mse = 0.015097
Epoch 27
Loss = 9.0165e-02, PNorm = 35.2384, GNorm = 1.9110, lr_0 = 3.3786e-04
Validation rmse = 0.126504
Validation r2 = 0.858116
Validation mse = 0.016003
Epoch 28
Loss = 7.3503e-02, PNorm = 35.2486, GNorm = 0.6518, lr_0 = 3.2816e-04
Loss = 9.2860e-02, PNorm = 35.2590, GNorm = 1.5562, lr_0 = 3.1959e-04
Validation rmse = 0.123491
Validation r2 = 0.864795
Validation mse = 0.015250
Epoch 29
Loss = 8.9406e-02, PNorm = 35.2688, GNorm = 2.9888, lr_0 = 3.1042e-04
Validation rmse = 0.142404
Validation r2 = 0.820208
Validation mse = 0.020279
Epoch 30
Loss = 9.8487e-02, PNorm = 35.2765, GNorm = 3.2700, lr_0 = 3.0232e-04
Loss = 8.4876e-02, PNorm = 35.2862, GNorm = 0.6982, lr_0 = 2.9442e-04
Validation rmse = 0.123132
Validation r2 = 0.865579
Validation mse = 0.015161
Epoch 31
Loss = 9.8545e-02, PNorm = 35.2977, GNorm = 2.1458, lr_0 = 2.8597e-04
Validation rmse = 0.127026
Validation r2 = 0.856944
Validation mse = 0.016136
Epoch 32
Loss = 7.1751e-02, PNorm = 35.3067, GNorm = 2.6081, lr_0 = 2.7777e-04
Loss = 8.5151e-02, PNorm = 35.3144, GNorm = 0.8428, lr_0 = 2.7051e-04
Validation rmse = 0.124506
Validation r2 = 0.862563
Validation mse = 0.015502
Epoch 33
Loss = 8.0337e-02, PNorm = 35.3250, GNorm = 0.9965, lr_0 = 2.6275e-04
Loss = 8.5250e-02, PNorm = 35.3320, GNorm = 1.7651, lr_0 = 2.5589e-04
Validation rmse = 0.128293
Validation r2 = 0.854076
Validation mse = 0.016459
Epoch 34
Loss = 8.6677e-02, PNorm = 35.3387, GNorm = 0.7915, lr_0 = 2.4920e-04
Validation rmse = 0.122537
Validation r2 = 0.866875
Validation mse = 0.015015
Epoch 35
Loss = 8.1625e-02, PNorm = 35.3487, GNorm = 0.7904, lr_0 = 2.4205e-04
Loss = 8.0743e-02, PNorm = 35.3563, GNorm = 0.9015, lr_0 = 2.3573e-04
Loss = 9.6922e-02, PNorm = 35.3569, GNorm = 2.0646, lr_0 = 2.3511e-04
Validation rmse = 0.125435
Validation r2 = 0.860504
Validation mse = 0.015734
Epoch 36
Loss = 8.9849e-02, PNorm = 35.3660, GNorm = 1.4654, lr_0 = 2.2897e-04
Validation rmse = 0.122900
Validation r2 = 0.866085
Validation mse = 0.015104
Epoch 37
Loss = 8.9155e-02, PNorm = 35.3714, GNorm = 1.9231, lr_0 = 2.2299e-04
Loss = 7.6065e-02, PNorm = 35.3783, GNorm = 1.9716, lr_0 = 2.1716e-04
Validation rmse = 0.123981
Validation r2 = 0.863719
Validation mse = 0.015371
Epoch 38
Loss = 8.0001e-02, PNorm = 35.3863, GNorm = 0.5399, lr_0 = 2.1093e-04
Validation rmse = 0.129961
Validation r2 = 0.850256
Validation mse = 0.016890
Epoch 39
Loss = 9.0996e-02, PNorm = 35.3934, GNorm = 1.2312, lr_0 = 2.0488e-04
Loss = 7.0693e-02, PNorm = 35.4003, GNorm = 0.5692, lr_0 = 1.9953e-04
Validation rmse = 0.122092
Validation r2 = 0.867840
Validation mse = 0.014906
Epoch 40
Loss = 8.0990e-02, PNorm = 35.4047, GNorm = 2.3451, lr_0 = 1.9431e-04
Validation rmse = 0.126056
Validation r2 = 0.859120
Validation mse = 0.015890
Epoch 41
Loss = 7.3787e-02, PNorm = 35.4122, GNorm = 1.7291, lr_0 = 1.8874e-04
Loss = 8.0749e-02, PNorm = 35.4169, GNorm = 0.9195, lr_0 = 1.8381e-04
Validation rmse = 0.126571
Validation r2 = 0.857965
Validation mse = 0.016020
Epoch 42
Loss = 9.4463e-02, PNorm = 35.4244, GNorm = 0.6207, lr_0 = 1.7854e-04
Validation rmse = 0.123526
Validation r2 = 0.864717
Validation mse = 0.015259
Epoch 43
Loss = 7.2523e-02, PNorm = 35.4308, GNorm = 0.9806, lr_0 = 1.7341e-04
Loss = 6.9185e-02, PNorm = 35.4365, GNorm = 1.2229, lr_0 = 1.6888e-04
Validation rmse = 0.123293
Validation r2 = 0.865226
Validation mse = 0.015201
Epoch 44
Loss = 7.8809e-02, PNorm = 35.4409, GNorm = 0.7311, lr_0 = 1.6447e-04
Validation rmse = 0.126175
Validation r2 = 0.858854
Validation mse = 0.015920
Epoch 45
Loss = 5.8896e-02, PNorm = 35.4460, GNorm = 2.1024, lr_0 = 1.5975e-04
Loss = 7.9053e-02, PNorm = 35.4519, GNorm = 2.5783, lr_0 = 1.5558e-04
Validation rmse = 0.130223
Validation r2 = 0.849650
Validation mse = 0.016958
Epoch 46
Loss = 7.8026e-02, PNorm = 35.4572, GNorm = 0.9102, lr_0 = 1.5112e-04
Validation rmse = 0.127831
Validation r2 = 0.855125
Validation mse = 0.016341
Epoch 47
Loss = 1.2146e-01, PNorm = 35.4615, GNorm = 2.5992, lr_0 = 1.4717e-04
Loss = 6.7929e-02, PNorm = 35.4669, GNorm = 1.0158, lr_0 = 1.4332e-04
Validation rmse = 0.123141
Validation r2 = 0.865560
Validation mse = 0.015164
Epoch 48
Loss = 7.1308e-02, PNorm = 35.4721, GNorm = 0.4126, lr_0 = 1.3921e-04
Validation rmse = 0.123242
Validation r2 = 0.865340
Validation mse = 0.015188
Epoch 49
Loss = 5.9679e-02, PNorm = 35.4771, GNorm = 2.0661, lr_0 = 1.3522e-04
Loss = 8.3074e-02, PNorm = 35.4810, GNorm = 1.6706, lr_0 = 1.3169e-04
Validation rmse = 0.127905
Validation r2 = 0.854955
Validation mse = 0.016360
Epoch 50
Loss = 8.2993e-02, PNorm = 35.4844, GNorm = 1.4149, lr_0 = 1.2825e-04
Loss = 6.6937e-02, PNorm = 35.4878, GNorm = 2.2922, lr_0 = 1.2490e-04
Loss = 6.4588e-02, PNorm = 35.4884, GNorm = 2.2229, lr_0 = 1.2457e-04
Validation rmse = 0.122085
Validation r2 = 0.867855
Validation mse = 0.014905
Epoch 51
Loss = 7.8770e-02, PNorm = 35.4917, GNorm = 1.0215, lr_0 = 1.2131e-04
Validation rmse = 0.123137
Validation r2 = 0.865568
Validation mse = 0.015163
Epoch 52
Loss = 7.9352e-02, PNorm = 35.4963, GNorm = 1.7410, lr_0 = 1.1783e-04
Loss = 6.7790e-02, PNorm = 35.5006, GNorm = 0.4661, lr_0 = 1.1475e-04
Loss = 7.5054e-02, PNorm = 35.5009, GNorm = 1.4720, lr_0 = 1.1445e-04
Validation rmse = 0.123530
Validation r2 = 0.864708
Validation mse = 0.015260
Epoch 53
Loss = 6.7417e-02, PNorm = 35.5039, GNorm = 2.7481, lr_0 = 1.1146e-04
Validation rmse = 0.122559
Validation r2 = 0.866827
Validation mse = 0.015021
Epoch 54
Loss = 5.9584e-02, PNorm = 35.5076, GNorm = 0.9037, lr_0 = 1.0855e-04
Loss = 7.8177e-02, PNorm = 35.5108, GNorm = 1.1497, lr_0 = 1.0572e-04
Validation rmse = 0.129048
Validation r2 = 0.852351
Validation mse = 0.016654
Epoch 55
Loss = 6.8822e-02, PNorm = 35.5146, GNorm = 0.8072, lr_0 = 1.0268e-04
Validation rmse = 0.127813
Validation r2 = 0.855165
Validation mse = 0.016336
Epoch 56
Loss = 8.4819e-02, PNorm = 35.5187, GNorm = 1.8236, lr_0 = 1.0000e-04
Loss = 6.8136e-02, PNorm = 35.5222, GNorm = 1.8124, lr_0 = 1.0000e-04
Validation rmse = 0.123509
Validation r2 = 0.864754
Validation mse = 0.015255
Epoch 57
Loss = 7.7734e-02, PNorm = 35.5243, GNorm = 1.3312, lr_0 = 1.0000e-04
Validation rmse = 0.121526
Validation r2 = 0.869063
Validation mse = 0.014768
Epoch 58
Loss = 7.6680e-02, PNorm = 35.5284, GNorm = 0.7387, lr_0 = 1.0000e-04
Loss = 6.8327e-02, PNorm = 35.5310, GNorm = 0.5744, lr_0 = 1.0000e-04
Validation rmse = 0.122690
Validation r2 = 0.866543
Validation mse = 0.015053
Epoch 59
Loss = 7.2260e-02, PNorm = 35.5342, GNorm = 0.4595, lr_0 = 1.0000e-04
Validation rmse = 0.122880
Validation r2 = 0.866129
Validation mse = 0.015099
Model 0 best validation rmse = 0.121526 on epoch 57
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.290860
Model 0 test r2 = -0.708586
Model 0 test mse = 0.084600
Ensemble test rmse = 0.290860
Ensemble test r2 = -0.708586
Ensemble test mse = 0.084600
Fold 3
Splitting data with seed 3
Total size = 957 | train size = 765 | val size = 192 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.7695e-01, PNorm = 34.0182, GNorm = 4.6804, lr_0 = 4.3000e-04
Validation rmse = 0.285871
Validation r2 = 0.337030
Validation mse = 0.081722
Epoch 1
Loss = 6.7527e-01, PNorm = 34.0535, GNorm = 5.4358, lr_0 = 7.6000e-04
Loss = 7.4953e-01, PNorm = 34.0989, GNorm = 4.8329, lr_0 = 9.9472e-04
Loss = 6.0153e-01, PNorm = 34.1040, GNorm = 3.9074, lr_0 = 9.9209e-04
Validation rmse = 0.362103
Validation r2 = -0.063697
Validation mse = 0.131118
Epoch 2
Loss = 7.0396e-01, PNorm = 34.1623, GNorm = 1.0275, lr_0 = 9.6618e-04
Validation rmse = 0.209782
Validation r2 = 0.642981
Validation mse = 0.044008
Epoch 3
Loss = 3.8310e-01, PNorm = 34.2402, GNorm = 0.9291, lr_0 = 9.3846e-04
Loss = 3.9693e-01, PNorm = 34.3095, GNorm = 5.4752, lr_0 = 9.1394e-04
Validation rmse = 0.183897
Validation r2 = 0.725652
Validation mse = 0.033818
Epoch 4
Loss = 2.9044e-01, PNorm = 34.3660, GNorm = 3.2940, lr_0 = 8.9007e-04
Validation rmse = 0.209177
Validation r2 = 0.645036
Validation mse = 0.043755
Epoch 5
Loss = 2.9385e-01, PNorm = 34.4281, GNorm = 6.9298, lr_0 = 8.6453e-04
Loss = 2.8361e-01, PNorm = 34.4748, GNorm = 0.8560, lr_0 = 8.4195e-04
Validation rmse = 0.169290
Validation r2 = 0.767502
Validation mse = 0.028659
Epoch 6
Loss = 1.9717e-01, PNorm = 34.5242, GNorm = 2.8520, lr_0 = 8.1779e-04
Validation rmse = 0.165666
Validation r2 = 0.777351
Validation mse = 0.027445
Epoch 7
Loss = 1.5008e-01, PNorm = 34.5686, GNorm = 0.4314, lr_0 = 7.9643e-04
Loss = 1.9133e-01, PNorm = 34.6107, GNorm = 1.2575, lr_0 = 7.7563e-04
Validation rmse = 0.157339
Validation r2 = 0.799172
Validation mse = 0.024755
Epoch 8
Loss = 1.6778e-01, PNorm = 34.6488, GNorm = 0.5706, lr_0 = 7.5338e-04
Validation rmse = 0.146632
Validation r2 = 0.825573
Validation mse = 0.021501
Epoch 9
Loss = 1.3994e-01, PNorm = 34.6911, GNorm = 0.7515, lr_0 = 7.3176e-04
Loss = 1.4793e-01, PNorm = 34.7215, GNorm = 2.7146, lr_0 = 7.1265e-04
Validation rmse = 0.143956
Validation r2 = 0.831882
Validation mse = 0.020723
Epoch 10
Loss = 1.3049e-01, PNorm = 34.7505, GNorm = 1.9938, lr_0 = 6.9403e-04
Validation rmse = 0.161888
Validation r2 = 0.787390
Validation mse = 0.026208
Epoch 11
Loss = 1.7195e-01, PNorm = 34.7850, GNorm = 3.4286, lr_0 = 6.7412e-04
Loss = 1.3024e-01, PNorm = 34.8091, GNorm = 0.7591, lr_0 = 6.5651e-04
Validation rmse = 0.137308
Validation r2 = 0.847051
Validation mse = 0.018854
Epoch 12
Loss = 1.1211e-01, PNorm = 34.8308, GNorm = 1.2189, lr_0 = 6.3767e-04
Validation rmse = 0.143782
Validation r2 = 0.832288
Validation mse = 0.020673
Epoch 13
Loss = 1.1281e-01, PNorm = 34.8540, GNorm = 1.5383, lr_0 = 6.1938e-04
Loss = 1.2679e-01, PNorm = 34.8754, GNorm = 4.4126, lr_0 = 6.0320e-04
Validation rmse = 0.139810
Validation r2 = 0.841426
Validation mse = 0.019547
Epoch 14
Loss = 1.2921e-01, PNorm = 34.8916, GNorm = 2.4811, lr_0 = 5.8744e-04
Validation rmse = 0.143842
Validation r2 = 0.832147
Validation mse = 0.020691
Epoch 15
Loss = 1.2025e-01, PNorm = 34.9084, GNorm = 3.0316, lr_0 = 5.7059e-04
Loss = 1.1540e-01, PNorm = 34.9254, GNorm = 3.8295, lr_0 = 5.5568e-04
Validation rmse = 0.144382
Validation r2 = 0.830886
Validation mse = 0.020846
Epoch 16
Loss = 1.3463e-01, PNorm = 34.9454, GNorm = 0.9721, lr_0 = 5.3974e-04
Loss = 1.0743e-01, PNorm = 34.9575, GNorm = 2.3284, lr_0 = 5.2564e-04
Validation rmse = 0.139002
Validation r2 = 0.843254
Validation mse = 0.019322
Epoch 17
Loss = 1.2665e-01, PNorm = 34.9740, GNorm = 1.5857, lr_0 = 5.1191e-04
Validation rmse = 0.138220
Validation r2 = 0.845013
Validation mse = 0.019105
Epoch 18
Loss = 1.0360e-01, PNorm = 34.9860, GNorm = 3.0328, lr_0 = 4.9722e-04
Loss = 1.2009e-01, PNorm = 35.0009, GNorm = 1.1216, lr_0 = 4.8424e-04
Loss = 1.2963e-01, PNorm = 35.0018, GNorm = 1.6912, lr_0 = 4.8296e-04
Validation rmse = 0.137928
Validation r2 = 0.845666
Validation mse = 0.019024
Epoch 19
Loss = 1.0969e-01, PNorm = 35.0100, GNorm = 3.2286, lr_0 = 4.7034e-04
Validation rmse = 0.134842
Validation r2 = 0.852496
Validation mse = 0.018182
Epoch 20
Loss = 1.1980e-01, PNorm = 35.0246, GNorm = 4.3095, lr_0 = 4.5806e-04
Loss = 1.1636e-01, PNorm = 35.0396, GNorm = 1.2673, lr_0 = 4.4609e-04
Validation rmse = 0.136371
Validation r2 = 0.849132
Validation mse = 0.018597
Epoch 21
Loss = 1.2504e-01, PNorm = 35.0518, GNorm = 2.6829, lr_0 = 4.3329e-04
Validation rmse = 0.134338
Validation r2 = 0.853596
Validation mse = 0.018047
Epoch 22
Loss = 1.2641e-01, PNorm = 35.0667, GNorm = 2.0647, lr_0 = 4.2086e-04
Loss = 8.9584e-02, PNorm = 35.0779, GNorm = 1.0438, lr_0 = 4.0987e-04
Validation rmse = 0.134537
Validation r2 = 0.853161
Validation mse = 0.018100
Epoch 23
Loss = 9.9181e-02, PNorm = 35.0880, GNorm = 2.2610, lr_0 = 3.9811e-04
Validation rmse = 0.136641
Validation r2 = 0.848533
Validation mse = 0.018671
Epoch 24
Loss = 8.8861e-02, PNorm = 35.0981, GNorm = 3.1043, lr_0 = 3.8771e-04
Loss = 1.0200e-01, PNorm = 35.1070, GNorm = 2.4950, lr_0 = 3.7758e-04
Validation rmse = 0.136023
Validation r2 = 0.849900
Validation mse = 0.018502
Epoch 25
Loss = 1.1499e-01, PNorm = 35.1185, GNorm = 4.8421, lr_0 = 3.6675e-04
Validation rmse = 0.132743
Validation r2 = 0.857052
Validation mse = 0.017621
Epoch 26
Loss = 1.1663e-01, PNorm = 35.1276, GNorm = 0.8926, lr_0 = 3.5622e-04
Loss = 9.6128e-02, PNorm = 35.1359, GNorm = 1.1768, lr_0 = 3.4692e-04
Validation rmse = 0.130471
Validation r2 = 0.861904
Validation mse = 0.017023
Epoch 27
Loss = 1.0384e-01, PNorm = 35.1434, GNorm = 0.8460, lr_0 = 3.3786e-04
Validation rmse = 0.137819
Validation r2 = 0.845911
Validation mse = 0.018994
Epoch 28
Loss = 1.0610e-01, PNorm = 35.1554, GNorm = 3.2682, lr_0 = 3.2816e-04
Loss = 9.4821e-02, PNorm = 35.1637, GNorm = 0.7271, lr_0 = 3.1959e-04
Validation rmse = 0.131084
Validation r2 = 0.860602
Validation mse = 0.017183
Epoch 29
Loss = 9.3539e-02, PNorm = 35.1718, GNorm = 0.6623, lr_0 = 3.1042e-04
Validation rmse = 0.134754
Validation r2 = 0.852688
Validation mse = 0.018159
Epoch 30
Loss = 7.6360e-02, PNorm = 35.1809, GNorm = 2.4310, lr_0 = 3.0232e-04
Loss = 9.0542e-02, PNorm = 35.1882, GNorm = 0.7883, lr_0 = 2.9442e-04
Validation rmse = 0.132338
Validation r2 = 0.857924
Validation mse = 0.017513
Epoch 31
Loss = 7.8805e-02, PNorm = 35.1967, GNorm = 0.9050, lr_0 = 2.8597e-04
Validation rmse = 0.129556
Validation r2 = 0.863833
Validation mse = 0.016785
Epoch 32
Loss = 8.6274e-02, PNorm = 35.2032, GNorm = 0.5982, lr_0 = 2.7777e-04
Loss = 9.2134e-02, PNorm = 35.2108, GNorm = 2.3031, lr_0 = 2.7051e-04
Validation rmse = 0.130841
Validation r2 = 0.861119
Validation mse = 0.017119
Epoch 33
Loss = 1.0666e-01, PNorm = 35.2182, GNorm = 1.7348, lr_0 = 2.6275e-04
Loss = 8.0692e-02, PNorm = 35.2258, GNorm = 2.0930, lr_0 = 2.5589e-04
Validation rmse = 0.129883
Validation r2 = 0.863146
Validation mse = 0.016870
Epoch 34
Loss = 9.4659e-02, PNorm = 35.2326, GNorm = 0.7614, lr_0 = 2.4920e-04
Validation rmse = 0.131792
Validation r2 = 0.859093
Validation mse = 0.017369
Epoch 35
Loss = 9.0481e-02, PNorm = 35.2414, GNorm = 1.1163, lr_0 = 2.4205e-04
Loss = 1.0653e-01, PNorm = 35.2483, GNorm = 2.0114, lr_0 = 2.3573e-04
Loss = 1.0461e-01, PNorm = 35.2492, GNorm = 2.1069, lr_0 = 2.3511e-04
Validation rmse = 0.131469
Validation r2 = 0.859782
Validation mse = 0.017284
Epoch 36
Loss = 8.6058e-02, PNorm = 35.2572, GNorm = 2.5179, lr_0 = 2.2897e-04
Validation rmse = 0.136333
Validation r2 = 0.849215
Validation mse = 0.018587
Epoch 37
Loss = 8.8569e-02, PNorm = 35.2638, GNorm = 0.8756, lr_0 = 2.2299e-04
Loss = 8.7073e-02, PNorm = 35.2698, GNorm = 1.0546, lr_0 = 2.1716e-04
Validation rmse = 0.131677
Validation r2 = 0.859338
Validation mse = 0.017339
Epoch 38
Loss = 9.1750e-02, PNorm = 35.2766, GNorm = 1.5151, lr_0 = 2.1093e-04
Validation rmse = 0.131050
Validation r2 = 0.860675
Validation mse = 0.017174
Epoch 39
Loss = 1.0311e-01, PNorm = 35.2832, GNorm = 2.1126, lr_0 = 2.0488e-04
Loss = 7.1740e-02, PNorm = 35.2888, GNorm = 1.2808, lr_0 = 1.9953e-04
Validation rmse = 0.129907
Validation r2 = 0.863095
Validation mse = 0.016876
Epoch 40
Loss = 7.5221e-02, PNorm = 35.2959, GNorm = 0.7841, lr_0 = 1.9431e-04
Validation rmse = 0.128370
Validation r2 = 0.866316
Validation mse = 0.016479
Epoch 41
Loss = 5.8353e-02, PNorm = 35.3015, GNorm = 1.4281, lr_0 = 1.8874e-04
Loss = 8.8438e-02, PNorm = 35.3068, GNorm = 1.8769, lr_0 = 1.8381e-04
Validation rmse = 0.133328
Validation r2 = 0.855790
Validation mse = 0.017776
Epoch 42
Loss = 7.9083e-02, PNorm = 35.3124, GNorm = 0.7516, lr_0 = 1.7854e-04
Validation rmse = 0.133723
Validation r2 = 0.854932
Validation mse = 0.017882
Epoch 43
Loss = 9.7376e-02, PNorm = 35.3178, GNorm = 1.2639, lr_0 = 1.7341e-04
Loss = 8.8830e-02, PNorm = 35.3227, GNorm = 1.9476, lr_0 = 1.6888e-04
Validation rmse = 0.130023
Validation r2 = 0.862849
Validation mse = 0.016906
Epoch 44
Loss = 7.4862e-02, PNorm = 35.3269, GNorm = 1.6042, lr_0 = 1.6447e-04
Validation rmse = 0.126723
Validation r2 = 0.869723
Validation mse = 0.016059
Epoch 45
Loss = 7.6008e-02, PNorm = 35.3314, GNorm = 1.2791, lr_0 = 1.5975e-04
Loss = 8.3215e-02, PNorm = 35.3354, GNorm = 2.1935, lr_0 = 1.5558e-04
Validation rmse = 0.126620
Validation r2 = 0.869936
Validation mse = 0.016033
Epoch 46
Loss = 8.0237e-02, PNorm = 35.3408, GNorm = 0.8456, lr_0 = 1.5112e-04
Validation rmse = 0.128362
Validation r2 = 0.866331
Validation mse = 0.016477
Epoch 47
Loss = 8.2421e-02, PNorm = 35.3443, GNorm = 1.3429, lr_0 = 1.4717e-04
Loss = 7.4252e-02, PNorm = 35.3494, GNorm = 1.5195, lr_0 = 1.4332e-04
Validation rmse = 0.134167
Validation r2 = 0.853968
Validation mse = 0.018001
Epoch 48
Loss = 8.0174e-02, PNorm = 35.3534, GNorm = 1.8635, lr_0 = 1.3921e-04
Validation rmse = 0.127791
Validation r2 = 0.867519
Validation mse = 0.016330
Epoch 49
Loss = 5.2689e-02, PNorm = 35.3570, GNorm = 1.5039, lr_0 = 1.3522e-04
Loss = 8.9995e-02, PNorm = 35.3611, GNorm = 1.3490, lr_0 = 1.3169e-04
Validation rmse = 0.130782
Validation r2 = 0.861245
Validation mse = 0.017104
Epoch 50
Loss = 7.7059e-02, PNorm = 35.3650, GNorm = 0.7865, lr_0 = 1.2825e-04
Loss = 7.9793e-02, PNorm = 35.3677, GNorm = 1.0321, lr_0 = 1.2490e-04
Loss = 3.7632e-02, PNorm = 35.3681, GNorm = 0.6814, lr_0 = 1.2457e-04
Validation rmse = 0.126701
Validation r2 = 0.869768
Validation mse = 0.016053
Epoch 51
Loss = 7.2706e-02, PNorm = 35.3710, GNorm = 0.8954, lr_0 = 1.2131e-04
Validation rmse = 0.126628
Validation r2 = 0.869918
Validation mse = 0.016035
Epoch 52
Loss = 8.3678e-02, PNorm = 35.3749, GNorm = 0.7928, lr_0 = 1.1783e-04
Loss = 7.2365e-02, PNorm = 35.3783, GNorm = 1.0470, lr_0 = 1.1475e-04
Loss = 1.1424e-01, PNorm = 35.3786, GNorm = 2.3269, lr_0 = 1.1445e-04
Validation rmse = 0.126422
Validation r2 = 0.870342
Validation mse = 0.015983
Epoch 53
Loss = 7.4225e-02, PNorm = 35.3822, GNorm = 2.6965, lr_0 = 1.1146e-04
Validation rmse = 0.127459
Validation r2 = 0.868206
Validation mse = 0.016246
Epoch 54
Loss = 9.1310e-02, PNorm = 35.3851, GNorm = 1.9566, lr_0 = 1.0855e-04
Loss = 7.0610e-02, PNorm = 35.3884, GNorm = 0.4822, lr_0 = 1.0572e-04
Validation rmse = 0.131235
Validation r2 = 0.860281
Validation mse = 0.017223
Epoch 55
Loss = 7.4068e-02, PNorm = 35.3908, GNorm = 1.5895, lr_0 = 1.0268e-04
Validation rmse = 0.127543
Validation r2 = 0.868032
Validation mse = 0.016267
Epoch 56
Loss = 7.3171e-02, PNorm = 35.3941, GNorm = 0.8645, lr_0 = 1.0000e-04
Loss = 7.6827e-02, PNorm = 35.3969, GNorm = 0.7565, lr_0 = 1.0000e-04
Validation rmse = 0.126622
Validation r2 = 0.869932
Validation mse = 0.016033
Epoch 57
Loss = 7.4004e-02, PNorm = 35.3993, GNorm = 0.6968, lr_0 = 1.0000e-04
Validation rmse = 0.127980
Validation r2 = 0.867125
Validation mse = 0.016379
Epoch 58
Loss = 5.4160e-02, PNorm = 35.4029, GNorm = 0.7000, lr_0 = 1.0000e-04
Loss = 8.2604e-02, PNorm = 35.4059, GNorm = 0.4113, lr_0 = 1.0000e-04
Validation rmse = 0.125335
Validation r2 = 0.872562
Validation mse = 0.015709
Epoch 59
Loss = 6.5952e-02, PNorm = 35.4091, GNorm = 0.4631, lr_0 = 1.0000e-04
Validation rmse = 0.128034
Validation r2 = 0.867014
Validation mse = 0.016393
Model 0 best validation rmse = 0.125335 on epoch 58
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.249793
Model 0 test r2 = -0.260171
Model 0 test mse = 0.062397
Ensemble test rmse = 0.249793
Ensemble test r2 = -0.260171
Ensemble test mse = 0.062397
Fold 4
Splitting data with seed 4
Total size = 957 | train size = 765 | val size = 192 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.3082e-01, PNorm = 34.0180, GNorm = 0.6677, lr_0 = 4.3000e-04
Validation rmse = 0.350293
Validation r2 = 0.139007
Validation mse = 0.122705
Epoch 1
Loss = 6.2914e-01, PNorm = 34.0595, GNorm = 1.2682, lr_0 = 7.6000e-04
Loss = 6.0289e-01, PNorm = 34.1136, GNorm = 2.7795, lr_0 = 9.9472e-04
Loss = 2.8536e-01, PNorm = 34.1196, GNorm = 3.9348, lr_0 = 9.9209e-04
Validation rmse = 0.326071
Validation r2 = 0.253961
Validation mse = 0.106322
Epoch 2
Loss = 4.2218e-01, PNorm = 34.1824, GNorm = 5.0241, lr_0 = 9.6618e-04
Validation rmse = 0.263841
Validation r2 = 0.511548
Validation mse = 0.069612
Epoch 3
Loss = 3.1303e-01, PNorm = 34.2584, GNorm = 1.3727, lr_0 = 9.3846e-04
Loss = 3.2960e-01, PNorm = 34.3202, GNorm = 8.1821, lr_0 = 9.1394e-04
Validation rmse = 0.216192
Validation r2 = 0.672044
Validation mse = 0.046739
Epoch 4
Loss = 2.7113e-01, PNorm = 34.3783, GNorm = 1.2975, lr_0 = 8.9007e-04
Validation rmse = 0.192592
Validation r2 = 0.739737
Validation mse = 0.037092
Epoch 5
Loss = 2.0293e-01, PNorm = 34.4265, GNorm = 3.5392, lr_0 = 8.6453e-04
Loss = 2.3693e-01, PNorm = 34.4771, GNorm = 3.3569, lr_0 = 8.4195e-04
Validation rmse = 0.189287
Validation r2 = 0.748592
Validation mse = 0.035830
Epoch 6
Loss = 2.4838e-01, PNorm = 34.5279, GNorm = 5.1093, lr_0 = 8.1779e-04
Validation rmse = 0.173300
Validation r2 = 0.789267
Validation mse = 0.030033
Epoch 7
Loss = 2.0731e-01, PNorm = 34.5672, GNorm = 6.5215, lr_0 = 7.9643e-04
Loss = 1.7733e-01, PNorm = 34.6066, GNorm = 2.1662, lr_0 = 7.7563e-04
Validation rmse = 0.160697
Validation r2 = 0.818802
Validation mse = 0.025824
Epoch 8
Loss = 1.5756e-01, PNorm = 34.6449, GNorm = 2.7657, lr_0 = 7.5338e-04
Validation rmse = 0.166337
Validation r2 = 0.805861
Validation mse = 0.027668
Epoch 9
Loss = 1.3443e-01, PNorm = 34.6818, GNorm = 2.1747, lr_0 = 7.3176e-04
Loss = 1.6731e-01, PNorm = 34.7112, GNorm = 0.7283, lr_0 = 7.1265e-04
Validation rmse = 0.228064
Validation r2 = 0.635037
Validation mse = 0.052013
Epoch 10
Loss = 3.0209e-01, PNorm = 34.7443, GNorm = 4.1647, lr_0 = 6.9403e-04
Validation rmse = 0.153561
Validation r2 = 0.834537
Validation mse = 0.023581
Epoch 11
Loss = 1.5326e-01, PNorm = 34.7783, GNorm = 1.7865, lr_0 = 6.7412e-04
Loss = 1.4459e-01, PNorm = 34.8035, GNorm = 2.4746, lr_0 = 6.5651e-04
Validation rmse = 0.137519
Validation r2 = 0.867302
Validation mse = 0.018912
Epoch 12
Loss = 1.3601e-01, PNorm = 34.8303, GNorm = 0.7805, lr_0 = 6.3767e-04
Validation rmse = 0.135916
Validation r2 = 0.870379
Validation mse = 0.018473
Epoch 13
Loss = 1.2844e-01, PNorm = 34.8563, GNorm = 4.7570, lr_0 = 6.1938e-04
Loss = 1.3862e-01, PNorm = 34.8790, GNorm = 1.9871, lr_0 = 6.0320e-04
Validation rmse = 0.133576
Validation r2 = 0.874803
Validation mse = 0.017843
Epoch 14
Loss = 1.2333e-01, PNorm = 34.8974, GNorm = 3.7357, lr_0 = 5.8744e-04
Validation rmse = 0.132223
Validation r2 = 0.877327
Validation mse = 0.017483
Epoch 15
Loss = 1.6038e-01, PNorm = 34.9164, GNorm = 1.2662, lr_0 = 5.7059e-04
Loss = 1.5677e-01, PNorm = 34.9381, GNorm = 3.1778, lr_0 = 5.5568e-04
Validation rmse = 0.134568
Validation r2 = 0.872936
Validation mse = 0.018109
Epoch 16
Loss = 1.3503e-01, PNorm = 34.9527, GNorm = 3.7130, lr_0 = 5.3974e-04
Loss = 1.2780e-01, PNorm = 34.9687, GNorm = 1.3858, lr_0 = 5.2564e-04
Validation rmse = 0.148468
Validation r2 = 0.845332
Validation mse = 0.022043
Epoch 17
Loss = 1.1677e-01, PNorm = 34.9846, GNorm = 1.2630, lr_0 = 5.1191e-04
Validation rmse = 0.168825
Validation r2 = 0.800010
Validation mse = 0.028502
Epoch 18
Loss = 1.5152e-01, PNorm = 35.0008, GNorm = 4.2365, lr_0 = 4.9722e-04
Loss = 1.2256e-01, PNorm = 35.0157, GNorm = 1.4195, lr_0 = 4.8424e-04
Loss = 1.7590e-01, PNorm = 35.0166, GNorm = 7.1843, lr_0 = 4.8296e-04
Validation rmse = 0.132631
Validation r2 = 0.876568
Validation mse = 0.017591
Epoch 19
Loss = 1.1407e-01, PNorm = 35.0316, GNorm = 2.1294, lr_0 = 4.7034e-04
Validation rmse = 0.129195
Validation r2 = 0.882880
Validation mse = 0.016691
Epoch 20
Loss = 1.0863e-01, PNorm = 35.0465, GNorm = 0.7117, lr_0 = 4.5806e-04
Loss = 1.0647e-01, PNorm = 35.0603, GNorm = 2.8479, lr_0 = 4.4609e-04
Validation rmse = 0.132608
Validation r2 = 0.876611
Validation mse = 0.017585
Epoch 21
Loss = 1.1868e-01, PNorm = 35.0703, GNorm = 1.1741, lr_0 = 4.3329e-04
Validation rmse = 0.135894
Validation r2 = 0.870420
Validation mse = 0.018467
Epoch 22
Loss = 1.2906e-01, PNorm = 35.0856, GNorm = 4.2694, lr_0 = 4.2086e-04
Loss = 1.2394e-01, PNorm = 35.0996, GNorm = 1.9352, lr_0 = 4.0987e-04
Validation rmse = 0.137290
Validation r2 = 0.867744
Validation mse = 0.018849
Epoch 23
Loss = 1.1073e-01, PNorm = 35.1130, GNorm = 1.3859, lr_0 = 3.9811e-04
Validation rmse = 0.135237
Validation r2 = 0.871671
Validation mse = 0.018289
Epoch 24
Loss = 1.1011e-01, PNorm = 35.1244, GNorm = 0.7948, lr_0 = 3.8771e-04
Loss = 1.0917e-01, PNorm = 35.1352, GNorm = 2.4939, lr_0 = 3.7758e-04
Validation rmse = 0.141093
Validation r2 = 0.860316
Validation mse = 0.019907
Epoch 25
Loss = 9.8652e-02, PNorm = 35.1451, GNorm = 1.3152, lr_0 = 3.6675e-04
Validation rmse = 0.128545
Validation r2 = 0.884056
Validation mse = 0.016524
Epoch 26
Loss = 8.9065e-02, PNorm = 35.1591, GNorm = 0.4429, lr_0 = 3.5622e-04
Loss = 1.0985e-01, PNorm = 35.1714, GNorm = 3.8318, lr_0 = 3.4692e-04
Validation rmse = 0.134249
Validation r2 = 0.873538
Validation mse = 0.018023
Epoch 27
Loss = 9.5467e-02, PNorm = 35.1794, GNorm = 1.3530, lr_0 = 3.3786e-04
Validation rmse = 0.133087
Validation r2 = 0.875719
Validation mse = 0.017712
Epoch 28
Loss = 9.8781e-02, PNorm = 35.1913, GNorm = 3.5873, lr_0 = 3.2816e-04
Loss = 9.8189e-02, PNorm = 35.2017, GNorm = 1.8543, lr_0 = 3.1959e-04
Validation rmse = 0.135133
Validation r2 = 0.871868
Validation mse = 0.018261
Epoch 29
Loss = 9.8263e-02, PNorm = 35.2096, GNorm = 0.7388, lr_0 = 3.1042e-04
Validation rmse = 0.129233
Validation r2 = 0.882812
Validation mse = 0.016701
Epoch 30
Loss = 8.4494e-02, PNorm = 35.2188, GNorm = 1.5536, lr_0 = 3.0232e-04
Loss = 9.6328e-02, PNorm = 35.2266, GNorm = 1.8652, lr_0 = 2.9442e-04
Validation rmse = 0.131496
Validation r2 = 0.878671
Validation mse = 0.017291
Epoch 31
Loss = 8.7138e-02, PNorm = 35.2358, GNorm = 1.7578, lr_0 = 2.8597e-04
Validation rmse = 0.131692
Validation r2 = 0.878309
Validation mse = 0.017343
Epoch 32
Loss = 7.8328e-02, PNorm = 35.2460, GNorm = 0.9114, lr_0 = 2.7777e-04
Loss = 9.0655e-02, PNorm = 35.2573, GNorm = 1.2240, lr_0 = 2.7051e-04
Validation rmse = 0.140970
Validation r2 = 0.860559
Validation mse = 0.019873
Epoch 33
Loss = 1.0780e-01, PNorm = 35.2653, GNorm = 5.7316, lr_0 = 2.6275e-04
Loss = 1.1060e-01, PNorm = 35.2734, GNorm = 4.5941, lr_0 = 2.5589e-04
Validation rmse = 0.132625
Validation r2 = 0.876580
Validation mse = 0.017589
Epoch 34
Loss = 9.5177e-02, PNorm = 35.2834, GNorm = 1.2451, lr_0 = 2.4920e-04
Validation rmse = 0.148671
Validation r2 = 0.844908
Validation mse = 0.022103
Epoch 35
Loss = 1.1614e-01, PNorm = 35.2916, GNorm = 1.6838, lr_0 = 2.4205e-04
Loss = 9.4446e-02, PNorm = 35.2996, GNorm = 0.7501, lr_0 = 2.3573e-04
Loss = 7.8822e-02, PNorm = 35.3002, GNorm = 1.4139, lr_0 = 2.3511e-04
Validation rmse = 0.136996
Validation r2 = 0.868309
Validation mse = 0.018768
Epoch 36
Loss = 9.2378e-02, PNorm = 35.3071, GNorm = 0.6282, lr_0 = 2.2897e-04
Validation rmse = 0.128718
Validation r2 = 0.883743
Validation mse = 0.016568
Epoch 37
Loss = 9.6889e-02, PNorm = 35.3158, GNorm = 0.8784, lr_0 = 2.2299e-04
Loss = 8.5281e-02, PNorm = 35.3238, GNorm = 1.9412, lr_0 = 2.1716e-04
Validation rmse = 0.136249
Validation r2 = 0.869742
Validation mse = 0.018564
Epoch 38
Loss = 8.6368e-02, PNorm = 35.3323, GNorm = 0.6138, lr_0 = 2.1093e-04
Validation rmse = 0.127758
Validation r2 = 0.885472
Validation mse = 0.016322
Epoch 39
Loss = 1.1731e-01, PNorm = 35.3397, GNorm = 2.8931, lr_0 = 2.0488e-04
Loss = 9.9550e-02, PNorm = 35.3457, GNorm = 2.3288, lr_0 = 1.9953e-04
Validation rmse = 0.134202
Validation r2 = 0.873627
Validation mse = 0.018010
Epoch 40
Loss = 8.6630e-02, PNorm = 35.3518, GNorm = 3.5548, lr_0 = 1.9431e-04
Validation rmse = 0.129846
Validation r2 = 0.881697
Validation mse = 0.016860
Epoch 41
Loss = 6.0703e-02, PNorm = 35.3596, GNorm = 1.6294, lr_0 = 1.8874e-04
Loss = 8.5207e-02, PNorm = 35.3670, GNorm = 0.4943, lr_0 = 1.8381e-04
Validation rmse = 0.128334
Validation r2 = 0.884437
Validation mse = 0.016470
Epoch 42
Loss = 8.5083e-02, PNorm = 35.3718, GNorm = 3.0463, lr_0 = 1.7854e-04
Validation rmse = 0.129629
Validation r2 = 0.882093
Validation mse = 0.016804
Epoch 43
Loss = 8.4662e-02, PNorm = 35.3782, GNorm = 0.8463, lr_0 = 1.7341e-04
Loss = 8.2873e-02, PNorm = 35.3836, GNorm = 2.2160, lr_0 = 1.6888e-04
Validation rmse = 0.128460
Validation r2 = 0.884210
Validation mse = 0.016502
Epoch 44
Loss = 7.9220e-02, PNorm = 35.3886, GNorm = 1.5813, lr_0 = 1.6447e-04
Validation rmse = 0.127576
Validation r2 = 0.885798
Validation mse = 0.016276
Epoch 45
Loss = 6.7681e-02, PNorm = 35.3948, GNorm = 1.0381, lr_0 = 1.5975e-04
Loss = 8.3285e-02, PNorm = 35.3989, GNorm = 0.9668, lr_0 = 1.5558e-04
Validation rmse = 0.131414
Validation r2 = 0.878822
Validation mse = 0.017270
Epoch 46
Loss = 6.5451e-02, PNorm = 35.4045, GNorm = 1.5347, lr_0 = 1.5112e-04
Validation rmse = 0.128978
Validation r2 = 0.883273
Validation mse = 0.016635
Epoch 47
Loss = 1.0030e-01, PNorm = 35.4096, GNorm = 1.0807, lr_0 = 1.4717e-04
Loss = 7.8508e-02, PNorm = 35.4145, GNorm = 0.7279, lr_0 = 1.4332e-04
Validation rmse = 0.128844
Validation r2 = 0.883517
Validation mse = 0.016601
Epoch 48
Loss = 7.2131e-02, PNorm = 35.4192, GNorm = 1.5524, lr_0 = 1.3921e-04
Validation rmse = 0.129075
Validation r2 = 0.883098
Validation mse = 0.016660
Epoch 49
Loss = 8.5635e-02, PNorm = 35.4237, GNorm = 1.2991, lr_0 = 1.3522e-04
Loss = 8.0007e-02, PNorm = 35.4295, GNorm = 1.7739, lr_0 = 1.3169e-04
Validation rmse = 0.132432
Validation r2 = 0.876939
Validation mse = 0.017538
Epoch 50
Loss = 8.4300e-02, PNorm = 35.4328, GNorm = 1.1290, lr_0 = 1.2825e-04
Loss = 7.3873e-02, PNorm = 35.4367, GNorm = 0.6190, lr_0 = 1.2490e-04
Loss = 7.7559e-02, PNorm = 35.4371, GNorm = 1.6206, lr_0 = 1.2457e-04
Validation rmse = 0.127869
Validation r2 = 0.885272
Validation mse = 0.016351
Epoch 51
Loss = 7.0591e-02, PNorm = 35.4408, GNorm = 0.5198, lr_0 = 1.2131e-04
Validation rmse = 0.127893
Validation r2 = 0.885229
Validation mse = 0.016357
Epoch 52
Loss = 8.2519e-02, PNorm = 35.4455, GNorm = 2.0335, lr_0 = 1.1783e-04
Loss = 6.9588e-02, PNorm = 35.4498, GNorm = 1.1238, lr_0 = 1.1475e-04
Loss = 1.6278e-01, PNorm = 35.4502, GNorm = 2.9650, lr_0 = 1.1445e-04
Validation rmse = 0.129818
Validation r2 = 0.881748
Validation mse = 0.016853
Epoch 53
Loss = 7.8556e-02, PNorm = 35.4533, GNorm = 1.0062, lr_0 = 1.1146e-04
Validation rmse = 0.128579
Validation r2 = 0.883996
Validation mse = 0.016532
Epoch 54
Loss = 8.1365e-02, PNorm = 35.4566, GNorm = 2.0523, lr_0 = 1.0855e-04
Loss = 7.0022e-02, PNorm = 35.4600, GNorm = 0.8793, lr_0 = 1.0572e-04
Validation rmse = 0.128607
Validation r2 = 0.883945
Validation mse = 0.016540
Epoch 55
Loss = 8.2268e-02, PNorm = 35.4638, GNorm = 2.6316, lr_0 = 1.0268e-04
Validation rmse = 0.127902
Validation r2 = 0.885214
Validation mse = 0.016359
Epoch 56
Loss = 7.5898e-02, PNorm = 35.4681, GNorm = 1.6490, lr_0 = 1.0000e-04
Loss = 7.0524e-02, PNorm = 35.4712, GNorm = 0.9489, lr_0 = 1.0000e-04
Validation rmse = 0.128388
Validation r2 = 0.884340
Validation mse = 0.016483
Epoch 57
Loss = 7.0152e-02, PNorm = 35.4748, GNorm = 2.0481, lr_0 = 1.0000e-04
Validation rmse = 0.127083
Validation r2 = 0.886678
Validation mse = 0.016150
Epoch 58
Loss = 7.3960e-02, PNorm = 35.4785, GNorm = 1.3139, lr_0 = 1.0000e-04
Loss = 7.3801e-02, PNorm = 35.4821, GNorm = 0.5216, lr_0 = 1.0000e-04
Validation rmse = 0.129200
Validation r2 = 0.882872
Validation mse = 0.016693
Epoch 59
Loss = 7.9144e-02, PNorm = 35.4862, GNorm = 0.8619, lr_0 = 1.0000e-04
Validation rmse = 0.127225
Validation r2 = 0.886425
Validation mse = 0.016186
Model 0 best validation rmse = 0.127083 on epoch 57
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.252244
Model 0 test r2 = -0.285020
Model 0 test mse = 0.063627
Ensemble test rmse = 0.252244
Ensemble test r2 = -0.285020
Ensemble test mse = 0.063627
Fold 5
Splitting data with seed 5
Total size = 957 | train size = 765 | val size = 192 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.6058e-01, PNorm = 34.0170, GNorm = 4.4147, lr_0 = 4.3000e-04
Validation rmse = 0.316418
Validation r2 = 0.167843
Validation mse = 0.100120
Epoch 1
Loss = 5.9013e-01, PNorm = 34.0488, GNorm = 0.6389, lr_0 = 7.6000e-04
Loss = 6.5446e-01, PNorm = 34.1044, GNorm = 2.1051, lr_0 = 9.9472e-04
Loss = 3.0952e-01, PNorm = 34.1119, GNorm = 3.2229, lr_0 = 9.9209e-04
Validation rmse = 0.272029
Validation r2 = 0.384943
Validation mse = 0.074000
Epoch 2
Loss = 4.0586e-01, PNorm = 34.1933, GNorm = 3.9625, lr_0 = 9.6618e-04
Validation rmse = 0.297590
Validation r2 = 0.263928
Validation mse = 0.088560
Epoch 3
Loss = 4.9249e-01, PNorm = 34.2631, GNorm = 9.9574, lr_0 = 9.3846e-04
Loss = 4.1344e-01, PNorm = 34.3155, GNorm = 2.7109, lr_0 = 9.1394e-04
Validation rmse = 0.250921
Validation r2 = 0.476690
Validation mse = 0.062961
Epoch 4
Loss = 3.4846e-01, PNorm = 34.3674, GNorm = 5.8652, lr_0 = 8.9007e-04
Validation rmse = 0.220811
Validation r2 = 0.594747
Validation mse = 0.048758
Epoch 5
Loss = 2.7863e-01, PNorm = 34.4201, GNorm = 1.5254, lr_0 = 8.6453e-04
Loss = 2.4353e-01, PNorm = 34.4671, GNorm = 0.6939, lr_0 = 8.4195e-04
Validation rmse = 0.211637
Validation r2 = 0.627721
Validation mse = 0.044790
Epoch 6
Loss = 2.2011e-01, PNorm = 34.5071, GNorm = 1.7298, lr_0 = 8.1779e-04
Validation rmse = 0.189744
Validation r2 = 0.700761
Validation mse = 0.036003
Epoch 7
Loss = 1.9684e-01, PNorm = 34.5421, GNorm = 1.6314, lr_0 = 7.9643e-04
Loss = 1.7433e-01, PNorm = 34.5756, GNorm = 2.3515, lr_0 = 7.7563e-04
Validation rmse = 0.203237
Validation r2 = 0.656689
Validation mse = 0.041305
Epoch 8
Loss = 2.5316e-01, PNorm = 34.6092, GNorm = 6.8741, lr_0 = 7.5338e-04
Validation rmse = 0.185417
Validation r2 = 0.714251
Validation mse = 0.034380
Epoch 9
Loss = 1.7592e-01, PNorm = 34.6417, GNorm = 3.7446, lr_0 = 7.3176e-04
Loss = 1.8353e-01, PNorm = 34.6712, GNorm = 3.3218, lr_0 = 7.1265e-04
Validation rmse = 0.180088
Validation r2 = 0.730443
Validation mse = 0.032432
Epoch 10
Loss = 1.6384e-01, PNorm = 34.7005, GNorm = 1.3510, lr_0 = 6.9403e-04
Validation rmse = 0.163729
Validation r2 = 0.777190
Validation mse = 0.026807
Epoch 11
Loss = 1.0168e-01, PNorm = 34.7318, GNorm = 1.5095, lr_0 = 6.7412e-04
Loss = 1.4385e-01, PNorm = 34.7539, GNorm = 0.6837, lr_0 = 6.5651e-04
Validation rmse = 0.162318
Validation r2 = 0.781013
Validation mse = 0.026347
Epoch 12
Loss = 1.3323e-01, PNorm = 34.7816, GNorm = 1.0855, lr_0 = 6.3767e-04
Validation rmse = 0.159479
Validation r2 = 0.788607
Validation mse = 0.025434
Epoch 13
Loss = 8.9142e-02, PNorm = 34.8084, GNorm = 0.5223, lr_0 = 6.1938e-04
Loss = 1.0976e-01, PNorm = 34.8234, GNorm = 3.7885, lr_0 = 6.0320e-04
Validation rmse = 0.155612
Validation r2 = 0.798735
Validation mse = 0.024215
Epoch 14
Loss = 1.1738e-01, PNorm = 34.8402, GNorm = 2.8213, lr_0 = 5.8744e-04
Validation rmse = 0.152925
Validation r2 = 0.805624
Validation mse = 0.023386
Epoch 15
Loss = 1.1477e-01, PNorm = 34.8630, GNorm = 1.7686, lr_0 = 5.7059e-04
Loss = 1.1632e-01, PNorm = 34.8860, GNorm = 0.5332, lr_0 = 5.5568e-04
Validation rmse = 0.150222
Validation r2 = 0.812434
Validation mse = 0.022567
Epoch 16
Loss = 1.0556e-01, PNorm = 34.9024, GNorm = 1.1064, lr_0 = 5.3974e-04
Loss = 1.1100e-01, PNorm = 34.9196, GNorm = 3.0078, lr_0 = 5.2564e-04
Validation rmse = 0.150086
Validation r2 = 0.812774
Validation mse = 0.022526
Epoch 17
Loss = 9.6191e-02, PNorm = 34.9364, GNorm = 0.9243, lr_0 = 5.1191e-04
Validation rmse = 0.160502
Validation r2 = 0.785887
Validation mse = 0.025761
Epoch 18
Loss = 1.0426e-01, PNorm = 34.9562, GNorm = 1.3202, lr_0 = 4.9722e-04
Loss = 1.1366e-01, PNorm = 34.9726, GNorm = 0.6886, lr_0 = 4.8424e-04
Loss = 2.5437e-02, PNorm = 34.9743, GNorm = 1.2663, lr_0 = 4.8296e-04
Validation rmse = 0.152990
Validation r2 = 0.805461
Validation mse = 0.023406
Epoch 19
Loss = 1.0758e-01, PNorm = 34.9893, GNorm = 1.7484, lr_0 = 4.7034e-04
Validation rmse = 0.144967
Validation r2 = 0.825328
Validation mse = 0.021015
Epoch 20
Loss = 8.7305e-02, PNorm = 35.0029, GNorm = 1.4771, lr_0 = 4.5806e-04
Loss = 9.4759e-02, PNorm = 35.0146, GNorm = 0.8731, lr_0 = 4.4609e-04
Validation rmse = 0.147640
Validation r2 = 0.818828
Validation mse = 0.021798
Epoch 21
Loss = 9.4792e-02, PNorm = 35.0324, GNorm = 0.9963, lr_0 = 4.3329e-04
Validation rmse = 0.145148
Validation r2 = 0.824892
Validation mse = 0.021068
Epoch 22
Loss = 7.2370e-02, PNorm = 35.0466, GNorm = 2.5923, lr_0 = 4.2086e-04
Loss = 1.0135e-01, PNorm = 35.0584, GNorm = 1.2839, lr_0 = 4.0987e-04
Validation rmse = 0.146820
Validation r2 = 0.820836
Validation mse = 0.021556
Epoch 23
Loss = 9.2227e-02, PNorm = 35.0746, GNorm = 0.8065, lr_0 = 3.9811e-04
Validation rmse = 0.144064
Validation r2 = 0.827498
Validation mse = 0.020754
Epoch 24
Loss = 9.2535e-02, PNorm = 35.0865, GNorm = 1.5852, lr_0 = 3.8771e-04
Loss = 8.7893e-02, PNorm = 35.0995, GNorm = 1.5354, lr_0 = 3.7758e-04
Validation rmse = 0.141166
Validation r2 = 0.834367
Validation mse = 0.019928
Epoch 25
Loss = 9.5944e-02, PNorm = 35.1106, GNorm = 2.9132, lr_0 = 3.6675e-04
Validation rmse = 0.144624
Validation r2 = 0.826153
Validation mse = 0.020916
Epoch 26
Loss = 1.0226e-01, PNorm = 35.1257, GNorm = 3.4287, lr_0 = 3.5622e-04
Loss = 9.8998e-02, PNorm = 35.1378, GNorm = 4.2823, lr_0 = 3.4692e-04
Validation rmse = 0.144217
Validation r2 = 0.827131
Validation mse = 0.020799
Epoch 27
Loss = 9.6233e-02, PNorm = 35.1489, GNorm = 0.8237, lr_0 = 3.3786e-04
Validation rmse = 0.143259
Validation r2 = 0.829421
Validation mse = 0.020523
Epoch 28
Loss = 8.0774e-02, PNorm = 35.1600, GNorm = 1.1877, lr_0 = 3.2816e-04
Loss = 9.0717e-02, PNorm = 35.1700, GNorm = 2.4918, lr_0 = 3.1959e-04
Validation rmse = 0.145577
Validation r2 = 0.823854
Validation mse = 0.021193
Epoch 29
Loss = 7.4670e-02, PNorm = 35.1802, GNorm = 0.8660, lr_0 = 3.1042e-04
Validation rmse = 0.142348
Validation r2 = 0.831582
Validation mse = 0.020263
Epoch 30
Loss = 6.7161e-02, PNorm = 35.1907, GNorm = 0.7858, lr_0 = 3.0232e-04
Loss = 7.4262e-02, PNorm = 35.1999, GNorm = 0.7770, lr_0 = 2.9442e-04
Validation rmse = 0.140674
Validation r2 = 0.835521
Validation mse = 0.019789
Epoch 31
Loss = 8.2068e-02, PNorm = 35.2097, GNorm = 2.0851, lr_0 = 2.8597e-04
Validation rmse = 0.144513
Validation r2 = 0.826420
Validation mse = 0.020884
Epoch 32
Loss = 1.2203e-01, PNorm = 35.2200, GNorm = 2.8631, lr_0 = 2.7777e-04
Loss = 8.3606e-02, PNorm = 35.2288, GNorm = 0.8222, lr_0 = 2.7051e-04
Validation rmse = 0.140330
Validation r2 = 0.836325
Validation mse = 0.019692
Epoch 33
Loss = 8.9596e-02, PNorm = 35.2387, GNorm = 1.1732, lr_0 = 2.6275e-04
Loss = 7.4082e-02, PNorm = 35.2477, GNorm = 1.4469, lr_0 = 2.5589e-04
Validation rmse = 0.142524
Validation r2 = 0.831166
Validation mse = 0.020313
Epoch 34
Loss = 7.2155e-02, PNorm = 35.2550, GNorm = 0.5710, lr_0 = 2.4920e-04
Validation rmse = 0.142679
Validation r2 = 0.830798
Validation mse = 0.020357
Epoch 35
Loss = 5.8721e-02, PNorm = 35.2632, GNorm = 1.5638, lr_0 = 2.4205e-04
Loss = 8.5901e-02, PNorm = 35.2706, GNorm = 1.8955, lr_0 = 2.3573e-04
Loss = 6.3973e-02, PNorm = 35.2715, GNorm = 1.9288, lr_0 = 2.3511e-04
Validation rmse = 0.141477
Validation r2 = 0.833637
Validation mse = 0.020016
Epoch 36
Loss = 7.2362e-02, PNorm = 35.2799, GNorm = 0.6523, lr_0 = 2.2897e-04
Validation rmse = 0.139510
Validation r2 = 0.838231
Validation mse = 0.019463
Epoch 37
Loss = 8.2754e-02, PNorm = 35.2870, GNorm = 1.0843, lr_0 = 2.2299e-04
Loss = 8.1307e-02, PNorm = 35.2935, GNorm = 2.0325, lr_0 = 2.1716e-04
Validation rmse = 0.139990
Validation r2 = 0.837116
Validation mse = 0.019597
Epoch 38
Loss = 7.1203e-02, PNorm = 35.3021, GNorm = 2.3825, lr_0 = 2.1093e-04
Validation rmse = 0.146324
Validation r2 = 0.822044
Validation mse = 0.021411
Epoch 39
Loss = 8.3357e-02, PNorm = 35.3095, GNorm = 0.9840, lr_0 = 2.0488e-04
Loss = 7.0069e-02, PNorm = 35.3161, GNorm = 0.7088, lr_0 = 1.9953e-04
Validation rmse = 0.140474
Validation r2 = 0.835988
Validation mse = 0.019733
Epoch 40
Loss = 7.4401e-02, PNorm = 35.3211, GNorm = 0.6187, lr_0 = 1.9431e-04
Validation rmse = 0.140722
Validation r2 = 0.835407
Validation mse = 0.019803
Epoch 41
Loss = 5.2718e-02, PNorm = 35.3281, GNorm = 1.7949, lr_0 = 1.8874e-04
Loss = 7.6633e-02, PNorm = 35.3342, GNorm = 0.7776, lr_0 = 1.8381e-04
Validation rmse = 0.146024
Validation r2 = 0.822772
Validation mse = 0.021323
Epoch 42
Loss = 7.6498e-02, PNorm = 35.3413, GNorm = 2.2628, lr_0 = 1.7854e-04
Validation rmse = 0.141619
Validation r2 = 0.833304
Validation mse = 0.020056
Epoch 43
Loss = 9.0117e-02, PNorm = 35.3472, GNorm = 0.9025, lr_0 = 1.7341e-04
Loss = 6.2697e-02, PNorm = 35.3520, GNorm = 1.9896, lr_0 = 1.6888e-04
Validation rmse = 0.140400
Validation r2 = 0.836162
Validation mse = 0.019712
Epoch 44
Loss = 7.5961e-02, PNorm = 35.3571, GNorm = 1.8365, lr_0 = 1.6447e-04
Validation rmse = 0.139410
Validation r2 = 0.838464
Validation mse = 0.019435
Epoch 45
Loss = 5.8483e-02, PNorm = 35.3631, GNorm = 1.7460, lr_0 = 1.5975e-04
Loss = 6.9090e-02, PNorm = 35.3687, GNorm = 0.8404, lr_0 = 1.5558e-04
Validation rmse = 0.141367
Validation r2 = 0.833896
Validation mse = 0.019985
Epoch 46
Loss = 6.1943e-02, PNorm = 35.3738, GNorm = 0.6192, lr_0 = 1.5112e-04
Validation rmse = 0.141500
Validation r2 = 0.833583
Validation mse = 0.020022
Epoch 47
Loss = 4.0321e-02, PNorm = 35.3786, GNorm = 0.7452, lr_0 = 1.4717e-04
Loss = 7.1819e-02, PNorm = 35.3835, GNorm = 0.8413, lr_0 = 1.4332e-04
Validation rmse = 0.142656
Validation r2 = 0.830852
Validation mse = 0.020351
Epoch 48
Loss = 6.3778e-02, PNorm = 35.3879, GNorm = 0.9740, lr_0 = 1.3921e-04
Validation rmse = 0.144034
Validation r2 = 0.827569
Validation mse = 0.020746
Epoch 49
Loss = 7.0801e-02, PNorm = 35.3931, GNorm = 0.4710, lr_0 = 1.3522e-04
Loss = 6.7103e-02, PNorm = 35.3976, GNorm = 0.9822, lr_0 = 1.3169e-04
Validation rmse = 0.142356
Validation r2 = 0.831563
Validation mse = 0.020265
Epoch 50
Loss = 5.0352e-02, PNorm = 35.4015, GNorm = 0.6510, lr_0 = 1.2825e-04
Loss = 7.5983e-02, PNorm = 35.4054, GNorm = 0.6354, lr_0 = 1.2490e-04
Loss = 4.7866e-02, PNorm = 35.4060, GNorm = 1.3879, lr_0 = 1.2457e-04
Validation rmse = 0.141215
Validation r2 = 0.834253
Validation mse = 0.019942
Epoch 51
Loss = 6.0158e-02, PNorm = 35.4105, GNorm = 0.6824, lr_0 = 1.2131e-04
Validation rmse = 0.139908
Validation r2 = 0.837308
Validation mse = 0.019574
Epoch 52
Loss = 6.9873e-02, PNorm = 35.4149, GNorm = 0.9903, lr_0 = 1.1783e-04
Loss = 6.2922e-02, PNorm = 35.4188, GNorm = 0.5968, lr_0 = 1.1475e-04
Loss = 7.8131e-02, PNorm = 35.4192, GNorm = 2.7147, lr_0 = 1.1445e-04
Validation rmse = 0.141385
Validation r2 = 0.833855
Validation mse = 0.019990
Epoch 53
Loss = 5.9807e-02, PNorm = 35.4230, GNorm = 1.1535, lr_0 = 1.1146e-04
Validation rmse = 0.140142
Validation r2 = 0.836763
Validation mse = 0.019640
Epoch 54
Loss = 7.9107e-02, PNorm = 35.4267, GNorm = 0.4821, lr_0 = 1.0855e-04
Loss = 6.4112e-02, PNorm = 35.4299, GNorm = 0.7047, lr_0 = 1.0572e-04
Validation rmse = 0.142315
Validation r2 = 0.831661
Validation mse = 0.020254
Epoch 55
Loss = 6.7512e-02, PNorm = 35.4335, GNorm = 0.6353, lr_0 = 1.0268e-04
Validation rmse = 0.139855
Validation r2 = 0.837430
Validation mse = 0.019559
Epoch 56
Loss = 5.9778e-02, PNorm = 35.4367, GNorm = 0.4387, lr_0 = 1.0000e-04
Loss = 6.6823e-02, PNorm = 35.4394, GNorm = 1.6243, lr_0 = 1.0000e-04
Validation rmse = 0.139548
Validation r2 = 0.838143
Validation mse = 0.019474
Epoch 57
Loss = 6.5419e-02, PNorm = 35.4436, GNorm = 0.5406, lr_0 = 1.0000e-04
Validation rmse = 0.140235
Validation r2 = 0.836547
Validation mse = 0.019666
Epoch 58
Loss = 7.1577e-02, PNorm = 35.4461, GNorm = 1.1187, lr_0 = 1.0000e-04
Loss = 6.1928e-02, PNorm = 35.4488, GNorm = 1.2285, lr_0 = 1.0000e-04
Validation rmse = 0.141471
Validation r2 = 0.833653
Validation mse = 0.020014
Epoch 59
Loss = 6.9234e-02, PNorm = 35.4515, GNorm = 1.2737, lr_0 = 1.0000e-04
Validation rmse = 0.147950
Validation r2 = 0.818066
Validation mse = 0.021889
Model 0 best validation rmse = 0.139410 on epoch 44
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.280140
Model 0 test r2 = -0.584964
Model 0 test mse = 0.078479
Ensemble test rmse = 0.280140
Ensemble test r2 = -0.584964
Ensemble test mse = 0.078479
Fold 6
Splitting data with seed 6
Total size = 957 | train size = 765 | val size = 192 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1711e-01, PNorm = 34.0180, GNorm = 1.7163, lr_0 = 4.3000e-04
Validation rmse = 0.291223
Validation r2 = 0.250878
Validation mse = 0.084811
Epoch 1
Loss = 6.5103e-01, PNorm = 34.0575, GNorm = 10.1528, lr_0 = 7.6000e-04
Loss = 5.0299e-01, PNorm = 34.1211, GNorm = 1.5819, lr_0 = 9.9472e-04
Loss = 4.7970e-01, PNorm = 34.1292, GNorm = 5.2784, lr_0 = 9.9209e-04
Validation rmse = 0.261979
Validation r2 = 0.393776
Validation mse = 0.068633
Epoch 2
Loss = 4.6569e-01, PNorm = 34.1939, GNorm = 3.5550, lr_0 = 9.6618e-04
Validation rmse = 0.253178
Validation r2 = 0.433825
Validation mse = 0.064099
Epoch 3
Loss = 4.5914e-01, PNorm = 34.2552, GNorm = 9.4391, lr_0 = 9.3846e-04
Loss = 3.2688e-01, PNorm = 34.3117, GNorm = 1.3439, lr_0 = 9.1394e-04
Validation rmse = 0.196499
Validation r2 = 0.658949
Validation mse = 0.038612
Epoch 4
Loss = 2.7158e-01, PNorm = 34.3647, GNorm = 3.5662, lr_0 = 8.9007e-04
Validation rmse = 0.190062
Validation r2 = 0.680928
Validation mse = 0.036123
Epoch 5
Loss = 2.8626e-01, PNorm = 34.4204, GNorm = 4.2079, lr_0 = 8.6453e-04
Loss = 2.2853e-01, PNorm = 34.4645, GNorm = 2.8014, lr_0 = 8.4195e-04
Validation rmse = 0.164992
Validation r2 = 0.759548
Validation mse = 0.027223
Epoch 6
Loss = 1.8667e-01, PNorm = 34.5063, GNorm = 4.4429, lr_0 = 8.1779e-04
Validation rmse = 0.160703
Validation r2 = 0.771889
Validation mse = 0.025825
Epoch 7
Loss = 1.9412e-01, PNorm = 34.5400, GNorm = 3.8562, lr_0 = 7.9643e-04
Loss = 1.6473e-01, PNorm = 34.5782, GNorm = 1.6464, lr_0 = 7.7563e-04
Validation rmse = 0.146750
Validation r2 = 0.809780
Validation mse = 0.021536
Epoch 8
Loss = 1.5061e-01, PNorm = 34.6129, GNorm = 5.4159, lr_0 = 7.5338e-04
Validation rmse = 0.159972
Validation r2 = 0.773958
Validation mse = 0.025591
Epoch 9
Loss = 1.7493e-01, PNorm = 34.6473, GNorm = 4.4180, lr_0 = 7.3176e-04
Loss = 1.4686e-01, PNorm = 34.6747, GNorm = 0.8454, lr_0 = 7.1265e-04
Validation rmse = 0.140423
Validation r2 = 0.825830
Validation mse = 0.019719
Epoch 10
Loss = 1.3614e-01, PNorm = 34.7057, GNorm = 2.0699, lr_0 = 6.9403e-04
Validation rmse = 0.133575
Validation r2 = 0.842403
Validation mse = 0.017842
Epoch 11
Loss = 1.4182e-01, PNorm = 34.7341, GNorm = 2.0313, lr_0 = 6.7412e-04
Loss = 1.3256e-01, PNorm = 34.7541, GNorm = 1.8090, lr_0 = 6.5651e-04
Validation rmse = 0.137045
Validation r2 = 0.834108
Validation mse = 0.018781
Epoch 12
Loss = 1.2281e-01, PNorm = 34.7735, GNorm = 1.9693, lr_0 = 6.3767e-04
Validation rmse = 0.139277
Validation r2 = 0.828659
Validation mse = 0.019398
Epoch 13
Loss = 1.5044e-01, PNorm = 34.7952, GNorm = 1.8053, lr_0 = 6.1938e-04
Loss = 1.4052e-01, PNorm = 34.8162, GNorm = 3.3926, lr_0 = 6.0320e-04
Validation rmse = 0.147986
Validation r2 = 0.806562
Validation mse = 0.021900
Epoch 14
Loss = 1.1969e-01, PNorm = 34.8332, GNorm = 3.6133, lr_0 = 5.8744e-04
Validation rmse = 0.172226
Validation r2 = 0.738001
Validation mse = 0.029662
Epoch 15
Loss = 1.7713e-01, PNorm = 34.8518, GNorm = 8.4353, lr_0 = 5.7059e-04
Loss = 1.4165e-01, PNorm = 34.8697, GNorm = 5.2150, lr_0 = 5.5568e-04
Validation rmse = 0.146072
Validation r2 = 0.811533
Validation mse = 0.021337
Epoch 16
Loss = 1.4032e-01, PNorm = 34.8900, GNorm = 1.6011, lr_0 = 5.3974e-04
Loss = 1.2648e-01, PNorm = 34.9050, GNorm = 2.6099, lr_0 = 5.2564e-04
Validation rmse = 0.135281
Validation r2 = 0.838351
Validation mse = 0.018301
Epoch 17
Loss = 1.0604e-01, PNorm = 34.9165, GNorm = 1.4312, lr_0 = 5.1191e-04
Validation rmse = 0.126286
Validation r2 = 0.859133
Validation mse = 0.015948
Epoch 18
Loss = 1.0936e-01, PNorm = 34.9304, GNorm = 0.8989, lr_0 = 4.9722e-04
Loss = 1.0120e-01, PNorm = 34.9438, GNorm = 1.9057, lr_0 = 4.8424e-04
Loss = 4.8152e-02, PNorm = 34.9451, GNorm = 1.4161, lr_0 = 4.8296e-04
Validation rmse = 0.133470
Validation r2 = 0.842649
Validation mse = 0.017814
Epoch 19
Loss = 9.8751e-02, PNorm = 34.9549, GNorm = 3.4430, lr_0 = 4.7034e-04
Validation rmse = 0.136903
Validation r2 = 0.834452
Validation mse = 0.018742
Epoch 20
Loss = 1.0003e-01, PNorm = 34.9684, GNorm = 2.0809, lr_0 = 4.5806e-04
Loss = 1.2793e-01, PNorm = 34.9789, GNorm = 2.6590, lr_0 = 4.4609e-04
Validation rmse = 0.136200
Validation r2 = 0.836147
Validation mse = 0.018550
Epoch 21
Loss = 9.6721e-02, PNorm = 34.9934, GNorm = 2.8075, lr_0 = 4.3329e-04
Validation rmse = 0.143266
Validation r2 = 0.818706
Validation mse = 0.020525
Epoch 22
Loss = 1.1605e-01, PNorm = 35.0080, GNorm = 1.1177, lr_0 = 4.2086e-04
Loss = 1.1776e-01, PNorm = 35.0181, GNorm = 1.4077, lr_0 = 4.0987e-04
Validation rmse = 0.140406
Validation r2 = 0.825871
Validation mse = 0.019714
Epoch 23
Loss = 9.3514e-02, PNorm = 35.0311, GNorm = 2.0267, lr_0 = 3.9811e-04
Validation rmse = 0.126649
Validation r2 = 0.858323
Validation mse = 0.016040
Epoch 24
Loss = 9.4938e-02, PNorm = 35.0421, GNorm = 1.6756, lr_0 = 3.8771e-04
Loss = 1.0078e-01, PNorm = 35.0541, GNorm = 1.2972, lr_0 = 3.7758e-04
Validation rmse = 0.133330
Validation r2 = 0.842979
Validation mse = 0.017777
Epoch 25
Loss = 1.0573e-01, PNorm = 35.0635, GNorm = 2.1609, lr_0 = 3.6675e-04
Validation rmse = 0.125861
Validation r2 = 0.860079
Validation mse = 0.015841
Epoch 26
Loss = 9.1455e-02, PNorm = 35.0743, GNorm = 1.9101, lr_0 = 3.5622e-04
Loss = 9.1460e-02, PNorm = 35.0812, GNorm = 1.2710, lr_0 = 3.4692e-04
Validation rmse = 0.141027
Validation r2 = 0.824328
Validation mse = 0.019889
Epoch 27
Loss = 9.9718e-02, PNorm = 35.0906, GNorm = 1.9793, lr_0 = 3.3786e-04
Validation rmse = 0.139826
Validation r2 = 0.827305
Validation mse = 0.019551
Epoch 28
Loss = 1.0847e-01, PNorm = 35.1009, GNorm = 4.1393, lr_0 = 3.2816e-04
Loss = 9.3626e-02, PNorm = 35.1117, GNorm = 1.2088, lr_0 = 3.1959e-04
Validation rmse = 0.127115
Validation r2 = 0.857277
Validation mse = 0.016158
Epoch 29
Loss = 8.5933e-02, PNorm = 35.1190, GNorm = 1.6291, lr_0 = 3.1042e-04
Validation rmse = 0.125877
Validation r2 = 0.860044
Validation mse = 0.015845
Epoch 30
Loss = 7.4559e-02, PNorm = 35.1277, GNorm = 0.5612, lr_0 = 3.0232e-04
Loss = 9.4268e-02, PNorm = 35.1355, GNorm = 3.5855, lr_0 = 2.9442e-04
Validation rmse = 0.131997
Validation r2 = 0.846103
Validation mse = 0.017423
Epoch 31
Loss = 9.7516e-02, PNorm = 35.1439, GNorm = 3.2234, lr_0 = 2.8597e-04
Validation rmse = 0.133543
Validation r2 = 0.842477
Validation mse = 0.017834
Epoch 32
Loss = 6.4367e-02, PNorm = 35.1523, GNorm = 1.3205, lr_0 = 2.7777e-04
Loss = 9.1723e-02, PNorm = 35.1583, GNorm = 0.6977, lr_0 = 2.7051e-04
Validation rmse = 0.135580
Validation r2 = 0.837635
Validation mse = 0.018382
Epoch 33
Loss = 1.0558e-01, PNorm = 35.1671, GNorm = 2.7716, lr_0 = 2.6275e-04
Loss = 8.7607e-02, PNorm = 35.1749, GNorm = 2.4824, lr_0 = 2.5589e-04
Validation rmse = 0.125416
Validation r2 = 0.861068
Validation mse = 0.015729
Epoch 34
Loss = 8.7079e-02, PNorm = 35.1822, GNorm = 2.2403, lr_0 = 2.4920e-04
Validation rmse = 0.126672
Validation r2 = 0.858269
Validation mse = 0.016046
Epoch 35
Loss = 8.4197e-02, PNorm = 35.1899, GNorm = 0.7347, lr_0 = 2.4205e-04
Loss = 9.7243e-02, PNorm = 35.1966, GNorm = 1.6471, lr_0 = 2.3573e-04
Loss = 6.6335e-02, PNorm = 35.1975, GNorm = 2.8647, lr_0 = 2.3511e-04
Validation rmse = 0.124138
Validation r2 = 0.863884
Validation mse = 0.015410
Epoch 36
Loss = 8.0000e-02, PNorm = 35.2026, GNorm = 0.9513, lr_0 = 2.2897e-04
Validation rmse = 0.124700
Validation r2 = 0.862649
Validation mse = 0.015550
Epoch 37
Loss = 8.8960e-02, PNorm = 35.2100, GNorm = 0.7670, lr_0 = 2.2299e-04
Loss = 8.0710e-02, PNorm = 35.2172, GNorm = 0.7221, lr_0 = 2.1716e-04
Validation rmse = 0.128200
Validation r2 = 0.854829
Validation mse = 0.016435
Epoch 38
Loss = 7.5633e-02, PNorm = 35.2240, GNorm = 1.3910, lr_0 = 2.1093e-04
Validation rmse = 0.123880
Validation r2 = 0.864448
Validation mse = 0.015346
Epoch 39
Loss = 7.2173e-02, PNorm = 35.2298, GNorm = 0.6827, lr_0 = 2.0488e-04
Loss = 8.5448e-02, PNorm = 35.2343, GNorm = 1.6557, lr_0 = 1.9953e-04
Validation rmse = 0.126794
Validation r2 = 0.857998
Validation mse = 0.016077
Epoch 40
Loss = 6.7556e-02, PNorm = 35.2404, GNorm = 1.1117, lr_0 = 1.9431e-04
Validation rmse = 0.124196
Validation r2 = 0.863756
Validation mse = 0.015425
Epoch 41
Loss = 7.8869e-02, PNorm = 35.2465, GNorm = 0.7539, lr_0 = 1.8874e-04
Loss = 7.9618e-02, PNorm = 35.2515, GNorm = 0.8544, lr_0 = 1.8381e-04
Validation rmse = 0.124834
Validation r2 = 0.862353
Validation mse = 0.015584
Epoch 42
Loss = 7.1373e-02, PNorm = 35.2567, GNorm = 0.7899, lr_0 = 1.7854e-04
Validation rmse = 0.123792
Validation r2 = 0.864642
Validation mse = 0.015324
Epoch 43
Loss = 7.7181e-02, PNorm = 35.2622, GNorm = 0.7247, lr_0 = 1.7341e-04
Loss = 7.6332e-02, PNorm = 35.2652, GNorm = 1.0244, lr_0 = 1.6888e-04
Validation rmse = 0.128226
Validation r2 = 0.854770
Validation mse = 0.016442
Epoch 44
Loss = 8.9166e-02, PNorm = 35.2711, GNorm = 0.7531, lr_0 = 1.6447e-04
Validation rmse = 0.124930
Validation r2 = 0.862141
Validation mse = 0.015608
Epoch 45
Loss = 5.8047e-02, PNorm = 35.2753, GNorm = 1.0826, lr_0 = 1.5975e-04
Loss = 7.2218e-02, PNorm = 35.2790, GNorm = 1.9668, lr_0 = 1.5558e-04
Validation rmse = 0.132823
Validation r2 = 0.844171
Validation mse = 0.017642
Epoch 46
Loss = 8.2123e-02, PNorm = 35.2845, GNorm = 2.7930, lr_0 = 1.5112e-04
Validation rmse = 0.125767
Validation r2 = 0.860289
Validation mse = 0.015817
Epoch 47
Loss = 1.0138e-01, PNorm = 35.2889, GNorm = 1.3634, lr_0 = 1.4717e-04
Loss = 7.6979e-02, PNorm = 35.2949, GNorm = 1.4180, lr_0 = 1.4332e-04
Validation rmse = 0.125634
Validation r2 = 0.860584
Validation mse = 0.015784
Epoch 48
Loss = 8.6046e-02, PNorm = 35.2983, GNorm = 2.2325, lr_0 = 1.3921e-04
Validation rmse = 0.123969
Validation r2 = 0.864254
Validation mse = 0.015368
Epoch 49
Loss = 3.6299e-02, PNorm = 35.3028, GNorm = 0.4595, lr_0 = 1.3522e-04
Loss = 7.6879e-02, PNorm = 35.3061, GNorm = 0.5775, lr_0 = 1.3169e-04
Validation rmse = 0.125021
Validation r2 = 0.861940
Validation mse = 0.015630
Epoch 50
Loss = 7.1966e-02, PNorm = 35.3094, GNorm = 1.0956, lr_0 = 1.2825e-04
Loss = 7.6640e-02, PNorm = 35.3134, GNorm = 1.8687, lr_0 = 1.2490e-04
Loss = 1.9062e-01, PNorm = 35.3137, GNorm = 3.9819, lr_0 = 1.2457e-04
Validation rmse = 0.124706
Validation r2 = 0.862635
Validation mse = 0.015552
Epoch 51
Loss = 7.3350e-02, PNorm = 35.3177, GNorm = 0.8951, lr_0 = 1.2131e-04
Validation rmse = 0.125142
Validation r2 = 0.861672
Validation mse = 0.015661
Epoch 52
Loss = 8.1764e-02, PNorm = 35.3219, GNorm = 0.6795, lr_0 = 1.1783e-04
Loss = 7.5311e-02, PNorm = 35.3251, GNorm = 0.9709, lr_0 = 1.1475e-04
Loss = 8.5924e-02, PNorm = 35.3254, GNorm = 2.1051, lr_0 = 1.1445e-04
Validation rmse = 0.125090
Validation r2 = 0.861788
Validation mse = 0.015648
Epoch 53
Loss = 7.4385e-02, PNorm = 35.3275, GNorm = 0.6091, lr_0 = 1.1146e-04
Validation rmse = 0.125636
Validation r2 = 0.860578
Validation mse = 0.015784
Epoch 54
Loss = 8.4770e-02, PNorm = 35.3308, GNorm = 0.6491, lr_0 = 1.0855e-04
Loss = 6.5028e-02, PNorm = 35.3340, GNorm = 0.7438, lr_0 = 1.0572e-04
Validation rmse = 0.123217
Validation r2 = 0.865896
Validation mse = 0.015182
Epoch 55
Loss = 7.4032e-02, PNorm = 35.3368, GNorm = 1.0048, lr_0 = 1.0268e-04
Validation rmse = 0.135377
Validation r2 = 0.838122
Validation mse = 0.018327
Epoch 56
Loss = 7.2843e-02, PNorm = 35.3401, GNorm = 2.7343, lr_0 = 1.0000e-04
Loss = 8.1894e-02, PNorm = 35.3431, GNorm = 0.9966, lr_0 = 1.0000e-04
Validation rmse = 0.134359
Validation r2 = 0.840546
Validation mse = 0.018052
Epoch 57
Loss = 7.7725e-02, PNorm = 35.3460, GNorm = 2.3906, lr_0 = 1.0000e-04
Validation rmse = 0.131043
Validation r2 = 0.848320
Validation mse = 0.017172
Epoch 58
Loss = 8.2437e-02, PNorm = 35.3490, GNorm = 0.9696, lr_0 = 1.0000e-04
Loss = 7.4043e-02, PNorm = 35.3516, GNorm = 2.3669, lr_0 = 1.0000e-04
Validation rmse = 0.124379
Validation r2 = 0.863355
Validation mse = 0.015470
Epoch 59
Loss = 7.0996e-02, PNorm = 35.3551, GNorm = 0.8984, lr_0 = 1.0000e-04
Validation rmse = 0.123837
Validation r2 = 0.864544
Validation mse = 0.015335
Model 0 best validation rmse = 0.123217 on epoch 54
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.270843
Model 0 test r2 = -0.481508
Model 0 test mse = 0.073356
Ensemble test rmse = 0.270843
Ensemble test r2 = -0.481508
Ensemble test mse = 0.073356
Fold 7
Splitting data with seed 7
Total size = 957 | train size = 765 | val size = 192 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.5980e-01, PNorm = 34.0162, GNorm = 7.3300, lr_0 = 4.3000e-04
Validation rmse = 0.315666
Validation r2 = 0.152838
Validation mse = 0.099645
Epoch 1
Loss = 7.7724e-01, PNorm = 34.0435, GNorm = 1.0380, lr_0 = 7.6000e-04
Loss = 5.7075e-01, PNorm = 34.1102, GNorm = 5.0995, lr_0 = 9.9472e-04
Loss = 2.9672e-01, PNorm = 34.1185, GNorm = 6.3104, lr_0 = 9.9209e-04
Validation rmse = 0.261014
Validation r2 = 0.420787
Validation mse = 0.068128
Epoch 2
Loss = 4.5296e-01, PNorm = 34.1937, GNorm = 1.7697, lr_0 = 9.6618e-04
Validation rmse = 0.209662
Validation r2 = 0.626276
Validation mse = 0.043958
Epoch 3
Loss = 5.0058e-01, PNorm = 34.2595, GNorm = 10.8003, lr_0 = 9.3846e-04
Loss = 3.1407e-01, PNorm = 34.3154, GNorm = 1.2747, lr_0 = 9.1394e-04
Validation rmse = 0.198715
Validation r2 = 0.664282
Validation mse = 0.039488
Epoch 4
Loss = 3.4462e-01, PNorm = 34.3624, GNorm = 6.3264, lr_0 = 8.9007e-04
Validation rmse = 0.216444
Validation r2 = 0.601707
Validation mse = 0.046848
Epoch 5
Loss = 3.3602e-01, PNorm = 34.4182, GNorm = 5.3292, lr_0 = 8.6453e-04
Loss = 2.3094e-01, PNorm = 34.4622, GNorm = 0.6912, lr_0 = 8.4195e-04
Validation rmse = 0.167435
Validation r2 = 0.761657
Validation mse = 0.028034
Epoch 6
Loss = 2.6134e-01, PNorm = 34.5054, GNorm = 4.8300, lr_0 = 8.1779e-04
Validation rmse = 0.160254
Validation r2 = 0.781661
Validation mse = 0.025681
Epoch 7
Loss = 1.9923e-01, PNorm = 34.5473, GNorm = 4.4636, lr_0 = 7.9643e-04
Loss = 1.9116e-01, PNorm = 34.5883, GNorm = 3.4744, lr_0 = 7.7563e-04
Validation rmse = 0.157827
Validation r2 = 0.788225
Validation mse = 0.024909
Epoch 8
Loss = 1.7816e-01, PNorm = 34.6267, GNorm = 1.7195, lr_0 = 7.5338e-04
Validation rmse = 0.166121
Validation r2 = 0.765384
Validation mse = 0.027596
Epoch 9
Loss = 1.7346e-01, PNorm = 34.6619, GNorm = 2.5549, lr_0 = 7.3176e-04
Loss = 1.4705e-01, PNorm = 34.6947, GNorm = 0.8853, lr_0 = 7.1265e-04
Validation rmse = 0.150399
Validation r2 = 0.807689
Validation mse = 0.022620
Epoch 10
Loss = 1.3579e-01, PNorm = 34.7241, GNorm = 1.3385, lr_0 = 6.9403e-04
Validation rmse = 0.148843
Validation r2 = 0.811649
Validation mse = 0.022154
Epoch 11
Loss = 1.1411e-01, PNorm = 34.7580, GNorm = 4.3729, lr_0 = 6.7412e-04
Loss = 1.2069e-01, PNorm = 34.7814, GNorm = 1.3902, lr_0 = 6.5651e-04
Validation rmse = 0.140909
Validation r2 = 0.831194
Validation mse = 0.019855
Epoch 12
Loss = 1.2193e-01, PNorm = 34.8015, GNorm = 1.2917, lr_0 = 6.3767e-04
Validation rmse = 0.136113
Validation r2 = 0.842490
Validation mse = 0.018527
Epoch 13
Loss = 9.6957e-02, PNorm = 34.8241, GNorm = 1.3382, lr_0 = 6.1938e-04
Loss = 1.2711e-01, PNorm = 34.8480, GNorm = 0.8925, lr_0 = 6.0320e-04
Validation rmse = 0.155181
Validation r2 = 0.795267
Validation mse = 0.024081
Epoch 14
Loss = 1.3369e-01, PNorm = 34.8676, GNorm = 2.0691, lr_0 = 5.8744e-04
Validation rmse = 0.139509
Validation r2 = 0.834532
Validation mse = 0.019463
Epoch 15
Loss = 1.1617e-01, PNorm = 34.8851, GNorm = 0.9069, lr_0 = 5.7059e-04
Loss = 1.2615e-01, PNorm = 34.9015, GNorm = 0.7128, lr_0 = 5.5568e-04
Validation rmse = 0.140039
Validation r2 = 0.833272
Validation mse = 0.019611
Epoch 16
Loss = 9.3944e-02, PNorm = 34.9194, GNorm = 0.9626, lr_0 = 5.3974e-04
Loss = 1.1699e-01, PNorm = 34.9350, GNorm = 3.0611, lr_0 = 5.2564e-04
Validation rmse = 0.138367
Validation r2 = 0.837228
Validation mse = 0.019146
Epoch 17
Loss = 1.0492e-01, PNorm = 34.9469, GNorm = 0.9404, lr_0 = 5.1191e-04
Validation rmse = 0.141282
Validation r2 = 0.830299
Validation mse = 0.019961
Epoch 18
Loss = 9.5042e-02, PNorm = 34.9616, GNorm = 0.7955, lr_0 = 4.9722e-04
Loss = 1.1612e-01, PNorm = 34.9770, GNorm = 0.4220, lr_0 = 4.8424e-04
Loss = 5.8231e-02, PNorm = 34.9784, GNorm = 2.7384, lr_0 = 4.8296e-04
Validation rmse = 0.142680
Validation r2 = 0.826924
Validation mse = 0.020358
Epoch 19
Loss = 1.0228e-01, PNorm = 34.9930, GNorm = 0.8909, lr_0 = 4.7034e-04
Validation rmse = 0.138060
Validation r2 = 0.837951
Validation mse = 0.019061
Epoch 20
Loss = 9.8619e-02, PNorm = 35.0055, GNorm = 0.7300, lr_0 = 4.5806e-04
Loss = 1.0405e-01, PNorm = 35.0170, GNorm = 2.4558, lr_0 = 4.4609e-04
Validation rmse = 0.132951
Validation r2 = 0.849723
Validation mse = 0.017676
Epoch 21
Loss = 8.7987e-02, PNorm = 35.0299, GNorm = 0.7500, lr_0 = 4.3329e-04
Validation rmse = 0.132290
Validation r2 = 0.851212
Validation mse = 0.017501
Epoch 22
Loss = 1.1928e-01, PNorm = 35.0446, GNorm = 1.3274, lr_0 = 4.2086e-04
Loss = 9.7603e-02, PNorm = 35.0573, GNorm = 0.7981, lr_0 = 4.0987e-04
Validation rmse = 0.133102
Validation r2 = 0.849382
Validation mse = 0.017716
Epoch 23
Loss = 9.2443e-02, PNorm = 35.0698, GNorm = 0.6669, lr_0 = 3.9811e-04
Validation rmse = 0.136434
Validation r2 = 0.841746
Validation mse = 0.018614
Epoch 24
Loss = 7.4966e-02, PNorm = 35.0808, GNorm = 0.5280, lr_0 = 3.8771e-04
Loss = 8.9451e-02, PNorm = 35.0887, GNorm = 1.5065, lr_0 = 3.7758e-04
Validation rmse = 0.136084
Validation r2 = 0.842555
Validation mse = 0.018519
Epoch 25
Loss = 1.0168e-01, PNorm = 35.1007, GNorm = 5.0034, lr_0 = 3.6675e-04
Validation rmse = 0.130802
Validation r2 = 0.854540
Validation mse = 0.017109
Epoch 26
Loss = 7.6630e-02, PNorm = 35.1118, GNorm = 1.8485, lr_0 = 3.5622e-04
Loss = 9.1516e-02, PNorm = 35.1197, GNorm = 1.5309, lr_0 = 3.4692e-04
Validation rmse = 0.132788
Validation r2 = 0.850090
Validation mse = 0.017633
Epoch 27
Loss = 9.8298e-02, PNorm = 35.1292, GNorm = 0.4390, lr_0 = 3.3786e-04
Validation rmse = 0.133103
Validation r2 = 0.849378
Validation mse = 0.017717
Epoch 28
Loss = 7.9453e-02, PNorm = 35.1378, GNorm = 0.5881, lr_0 = 3.2816e-04
Loss = 8.4855e-02, PNorm = 35.1456, GNorm = 1.6835, lr_0 = 3.1959e-04
Validation rmse = 0.137745
Validation r2 = 0.838689
Validation mse = 0.018974
Epoch 29
Loss = 9.5029e-02, PNorm = 35.1549, GNorm = 1.1431, lr_0 = 3.1042e-04
Validation rmse = 0.129430
Validation r2 = 0.857577
Validation mse = 0.016752
Epoch 30
Loss = 6.1166e-02, PNorm = 35.1628, GNorm = 0.5229, lr_0 = 3.0232e-04
Loss = 7.9744e-02, PNorm = 35.1707, GNorm = 0.9556, lr_0 = 2.9442e-04
Validation rmse = 0.130082
Validation r2 = 0.856139
Validation mse = 0.016921
Epoch 31
Loss = 8.9843e-02, PNorm = 35.1799, GNorm = 0.8646, lr_0 = 2.8597e-04
Validation rmse = 0.137204
Validation r2 = 0.839954
Validation mse = 0.018825
Epoch 32
Loss = 8.2675e-02, PNorm = 35.1889, GNorm = 1.5452, lr_0 = 2.7777e-04
Loss = 8.7575e-02, PNorm = 35.1950, GNorm = 0.7544, lr_0 = 2.7051e-04
Validation rmse = 0.133908
Validation r2 = 0.847551
Validation mse = 0.017931
Epoch 33
Loss = 7.3907e-02, PNorm = 35.2034, GNorm = 1.7218, lr_0 = 2.6275e-04
Loss = 8.7993e-02, PNorm = 35.2108, GNorm = 2.8703, lr_0 = 2.5589e-04
Validation rmse = 0.136860
Validation r2 = 0.840755
Validation mse = 0.018731
Epoch 34
Loss = 8.8610e-02, PNorm = 35.2169, GNorm = 1.0567, lr_0 = 2.4920e-04
Validation rmse = 0.129532
Validation r2 = 0.857352
Validation mse = 0.016779
Epoch 35
Loss = 8.6629e-02, PNorm = 35.2225, GNorm = 1.4247, lr_0 = 2.4205e-04
Loss = 8.0174e-02, PNorm = 35.2283, GNorm = 0.9658, lr_0 = 2.3573e-04
Loss = 3.4733e-02, PNorm = 35.2289, GNorm = 0.7943, lr_0 = 2.3511e-04
Validation rmse = 0.128678
Validation r2 = 0.859226
Validation mse = 0.016558
Epoch 36
Loss = 8.2381e-02, PNorm = 35.2340, GNorm = 1.3219, lr_0 = 2.2897e-04
Validation rmse = 0.127545
Validation r2 = 0.861694
Validation mse = 0.016268
Epoch 37
Loss = 8.6701e-02, PNorm = 35.2402, GNorm = 0.6264, lr_0 = 2.2299e-04
Loss = 7.8377e-02, PNorm = 35.2467, GNorm = 0.8802, lr_0 = 2.1716e-04
Validation rmse = 0.129688
Validation r2 = 0.857009
Validation mse = 0.016819
Epoch 38
Loss = 8.4087e-02, PNorm = 35.2535, GNorm = 2.2780, lr_0 = 2.1093e-04
Validation rmse = 0.132436
Validation r2 = 0.850884
Validation mse = 0.017539
Epoch 39
Loss = 6.4203e-02, PNorm = 35.2594, GNorm = 0.7616, lr_0 = 2.0488e-04
Loss = 8.6140e-02, PNorm = 35.2651, GNorm = 0.7926, lr_0 = 1.9953e-04
Validation rmse = 0.129275
Validation r2 = 0.857917
Validation mse = 0.016712
Epoch 40
Loss = 7.7577e-02, PNorm = 35.2704, GNorm = 0.7936, lr_0 = 1.9431e-04
Validation rmse = 0.127191
Validation r2 = 0.862461
Validation mse = 0.016178
Epoch 41
Loss = 8.3525e-02, PNorm = 35.2754, GNorm = 1.5838, lr_0 = 1.8874e-04
Loss = 7.5288e-02, PNorm = 35.2790, GNorm = 0.8073, lr_0 = 1.8381e-04
Validation rmse = 0.129217
Validation r2 = 0.858046
Validation mse = 0.016697
Epoch 42
Loss = 7.8191e-02, PNorm = 35.2858, GNorm = 1.0054, lr_0 = 1.7854e-04
Validation rmse = 0.126797
Validation r2 = 0.863312
Validation mse = 0.016078
Epoch 43
Loss = 6.5570e-02, PNorm = 35.2905, GNorm = 1.3569, lr_0 = 1.7341e-04
Loss = 7.5560e-02, PNorm = 35.2951, GNorm = 0.9659, lr_0 = 1.6888e-04
Validation rmse = 0.126788
Validation r2 = 0.863331
Validation mse = 0.016075
Epoch 44
Loss = 7.7621e-02, PNorm = 35.2992, GNorm = 0.6337, lr_0 = 1.6447e-04
Validation rmse = 0.133588
Validation r2 = 0.848280
Validation mse = 0.017846
Epoch 45
Loss = 7.6121e-02, PNorm = 35.3046, GNorm = 1.5840, lr_0 = 1.5975e-04
Loss = 7.5895e-02, PNorm = 35.3110, GNorm = 1.2351, lr_0 = 1.5558e-04
Validation rmse = 0.130203
Validation r2 = 0.855871
Validation mse = 0.016953
Epoch 46
Loss = 7.4635e-02, PNorm = 35.3158, GNorm = 1.3436, lr_0 = 1.5112e-04
Validation rmse = 0.128590
Validation r2 = 0.859418
Validation mse = 0.016536
Epoch 47
Loss = 7.2446e-02, PNorm = 35.3202, GNorm = 0.9245, lr_0 = 1.4717e-04
Loss = 7.9120e-02, PNorm = 35.3237, GNorm = 2.6042, lr_0 = 1.4332e-04
Validation rmse = 0.126736
Validation r2 = 0.863443
Validation mse = 0.016062
Epoch 48
Loss = 7.7814e-02, PNorm = 35.3279, GNorm = 1.5728, lr_0 = 1.3921e-04
Validation rmse = 0.127160
Validation r2 = 0.862529
Validation mse = 0.016170
Epoch 49
Loss = 1.1324e-01, PNorm = 35.3315, GNorm = 0.7124, lr_0 = 1.3522e-04
Loss = 6.9601e-02, PNorm = 35.3359, GNorm = 1.4430, lr_0 = 1.3169e-04
Validation rmse = 0.130294
Validation r2 = 0.855669
Validation mse = 0.016977
Epoch 50
Loss = 7.3188e-02, PNorm = 35.3384, GNorm = 2.0590, lr_0 = 1.2825e-04
Loss = 7.3067e-02, PNorm = 35.3426, GNorm = 1.2818, lr_0 = 1.2490e-04
Loss = 4.0515e-02, PNorm = 35.3429, GNorm = 1.6171, lr_0 = 1.2457e-04
Validation rmse = 0.125710
Validation r2 = 0.865646
Validation mse = 0.015803
Epoch 51
Loss = 6.8084e-02, PNorm = 35.3461, GNorm = 0.5971, lr_0 = 1.2131e-04
Validation rmse = 0.127088
Validation r2 = 0.862684
Validation mse = 0.016151
Epoch 52
Loss = 6.7206e-02, PNorm = 35.3498, GNorm = 0.8746, lr_0 = 1.1783e-04
Loss = 7.5482e-02, PNorm = 35.3532, GNorm = 0.8962, lr_0 = 1.1475e-04
Loss = 3.0484e-02, PNorm = 35.3534, GNorm = 0.7471, lr_0 = 1.1445e-04
Validation rmse = 0.128376
Validation r2 = 0.859888
Validation mse = 0.016480
Epoch 53
Loss = 6.5602e-02, PNorm = 35.3564, GNorm = 0.5234, lr_0 = 1.1146e-04
Validation rmse = 0.126587
Validation r2 = 0.863765
Validation mse = 0.016024
Epoch 54
Loss = 6.4194e-02, PNorm = 35.3603, GNorm = 1.4189, lr_0 = 1.0855e-04
Loss = 7.1197e-02, PNorm = 35.3643, GNorm = 0.7408, lr_0 = 1.0572e-04
Validation rmse = 0.136290
Validation r2 = 0.842078
Validation mse = 0.018575
Epoch 55
Loss = 7.7186e-02, PNorm = 35.3670, GNorm = 1.4373, lr_0 = 1.0268e-04
Validation rmse = 0.131013
Validation r2 = 0.854072
Validation mse = 0.017164
Epoch 56
Loss = 6.8703e-02, PNorm = 35.3698, GNorm = 0.7709, lr_0 = 1.0000e-04
Loss = 7.4494e-02, PNorm = 35.3731, GNorm = 0.6220, lr_0 = 1.0000e-04
Validation rmse = 0.126503
Validation r2 = 0.863945
Validation mse = 0.016003
Epoch 57
Loss = 6.5582e-02, PNorm = 35.3763, GNorm = 0.7622, lr_0 = 1.0000e-04
Validation rmse = 0.127128
Validation r2 = 0.862597
Validation mse = 0.016162
Epoch 58
Loss = 6.4734e-02, PNorm = 35.3790, GNorm = 0.7134, lr_0 = 1.0000e-04
Loss = 7.1161e-02, PNorm = 35.3817, GNorm = 0.7735, lr_0 = 1.0000e-04
Validation rmse = 0.128851
Validation r2 = 0.858849
Validation mse = 0.016602
Epoch 59
Loss = 7.1575e-02, PNorm = 35.3848, GNorm = 1.4062, lr_0 = 1.0000e-04
Validation rmse = 0.127105
Validation r2 = 0.862647
Validation mse = 0.016156
Model 0 best validation rmse = 0.125710 on epoch 50
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.279553
Model 0 test r2 = -0.578325
Model 0 test mse = 0.078150
Ensemble test rmse = 0.279553
Ensemble test r2 = -0.578325
Ensemble test mse = 0.078150
Fold 8
Splitting data with seed 8
Total size = 957 | train size = 765 | val size = 192 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.5901e-01, PNorm = 34.0149, GNorm = 0.9893, lr_0 = 4.3000e-04
Validation rmse = 0.343687
Validation r2 = 0.000307
Validation mse = 0.118121
Epoch 1
Loss = 8.8319e-01, PNorm = 34.0413, GNorm = 9.6705, lr_0 = 7.6000e-04
Loss = 6.1251e-01, PNorm = 34.1014, GNorm = 2.9259, lr_0 = 9.9472e-04
Loss = 2.7026e-01, PNorm = 34.1096, GNorm = 2.7606, lr_0 = 9.9209e-04
Validation rmse = 0.248589
Validation r2 = 0.476996
Validation mse = 0.061796
Epoch 2
Loss = 4.6396e-01, PNorm = 34.1933, GNorm = 2.6581, lr_0 = 9.6618e-04
Validation rmse = 0.259458
Validation r2 = 0.430263
Validation mse = 0.067318
Epoch 3
Loss = 4.3271e-01, PNorm = 34.2696, GNorm = 3.9868, lr_0 = 9.3846e-04
Loss = 2.7910e-01, PNorm = 34.3317, GNorm = 3.7407, lr_0 = 9.1394e-04
Validation rmse = 0.187742
Validation r2 = 0.701692
Validation mse = 0.035247
Epoch 4
Loss = 2.5380e-01, PNorm = 34.3795, GNorm = 3.6855, lr_0 = 8.9007e-04
Validation rmse = 0.187405
Validation r2 = 0.702763
Validation mse = 0.035121
Epoch 5
Loss = 2.3489e-01, PNorm = 34.4305, GNorm = 1.0753, lr_0 = 8.6453e-04
Loss = 2.2598e-01, PNorm = 34.4669, GNorm = 9.1718, lr_0 = 8.4195e-04
Validation rmse = 0.244744
Validation r2 = 0.493049
Validation mse = 0.059900
Epoch 6
Loss = 2.5793e-01, PNorm = 34.5090, GNorm = 3.2531, lr_0 = 8.1779e-04
Validation rmse = 0.170775
Validation r2 = 0.753175
Validation mse = 0.029164
Epoch 7
Loss = 2.5875e-01, PNorm = 34.5494, GNorm = 4.0280, lr_0 = 7.9643e-04
Loss = 1.8093e-01, PNorm = 34.5862, GNorm = 1.7150, lr_0 = 7.7563e-04
Validation rmse = 0.170516
Validation r2 = 0.753923
Validation mse = 0.029076
Epoch 8
Loss = 1.6619e-01, PNorm = 34.6248, GNorm = 3.0487, lr_0 = 7.5338e-04
Validation rmse = 0.155565
Validation r2 = 0.795183
Validation mse = 0.024201
Epoch 9
Loss = 1.8803e-01, PNorm = 34.6644, GNorm = 4.7449, lr_0 = 7.3176e-04
Loss = 1.4308e-01, PNorm = 34.6935, GNorm = 1.9397, lr_0 = 7.1265e-04
Validation rmse = 0.147248
Validation r2 = 0.816500
Validation mse = 0.021682
Epoch 10
Loss = 1.4117e-01, PNorm = 34.7238, GNorm = 2.5413, lr_0 = 6.9403e-04
Validation rmse = 0.148025
Validation r2 = 0.814558
Validation mse = 0.021911
Epoch 11
Loss = 1.1873e-01, PNorm = 34.7567, GNorm = 4.5966, lr_0 = 6.7412e-04
Loss = 1.5425e-01, PNorm = 34.7808, GNorm = 1.8950, lr_0 = 6.5651e-04
Validation rmse = 0.152241
Validation r2 = 0.803843
Validation mse = 0.023177
Epoch 12
Loss = 1.3305e-01, PNorm = 34.8104, GNorm = 2.7453, lr_0 = 6.3767e-04
Validation rmse = 0.152708
Validation r2 = 0.802639
Validation mse = 0.023320
Epoch 13
Loss = 1.9842e-01, PNorm = 34.8391, GNorm = 6.2019, lr_0 = 6.1938e-04
Loss = 1.4668e-01, PNorm = 34.8606, GNorm = 2.3836, lr_0 = 6.0320e-04
Validation rmse = 0.163093
Validation r2 = 0.774880
Validation mse = 0.026599
Epoch 14
Loss = 1.1712e-01, PNorm = 34.8771, GNorm = 0.9128, lr_0 = 5.8744e-04
Validation rmse = 0.141919
Validation r2 = 0.829541
Validation mse = 0.020141
Epoch 15
Loss = 8.9592e-02, PNorm = 34.8931, GNorm = 0.6496, lr_0 = 5.7059e-04
Loss = 1.1340e-01, PNorm = 34.9107, GNorm = 2.4789, lr_0 = 5.5568e-04
Validation rmse = 0.143905
Validation r2 = 0.824736
Validation mse = 0.020709
Epoch 16
Loss = 1.1047e-01, PNorm = 34.9261, GNorm = 1.6403, lr_0 = 5.3974e-04
Loss = 1.0645e-01, PNorm = 34.9413, GNorm = 4.4313, lr_0 = 5.2564e-04
Validation rmse = 0.143479
Validation r2 = 0.825772
Validation mse = 0.020586
Epoch 17
Loss = 1.0467e-01, PNorm = 34.9541, GNorm = 1.3633, lr_0 = 5.1191e-04
Validation rmse = 0.140463
Validation r2 = 0.833020
Validation mse = 0.019730
Epoch 18
Loss = 1.3868e-01, PNorm = 34.9674, GNorm = 2.1972, lr_0 = 4.9722e-04
Loss = 1.0570e-01, PNorm = 34.9826, GNorm = 3.8768, lr_0 = 4.8424e-04
Loss = 8.6102e-02, PNorm = 34.9834, GNorm = 4.1920, lr_0 = 4.8296e-04
Validation rmse = 0.140411
Validation r2 = 0.833144
Validation mse = 0.019715
Epoch 19
Loss = 1.1222e-01, PNorm = 34.9930, GNorm = 2.7059, lr_0 = 4.7034e-04
Validation rmse = 0.141654
Validation r2 = 0.830176
Validation mse = 0.020066
Epoch 20
Loss = 1.2870e-01, PNorm = 35.0102, GNorm = 1.8220, lr_0 = 4.5806e-04
Loss = 1.0557e-01, PNorm = 35.0226, GNorm = 0.6665, lr_0 = 4.4609e-04
Validation rmse = 0.141365
Validation r2 = 0.830869
Validation mse = 0.019984
Epoch 21
Loss = 9.7555e-02, PNorm = 35.0431, GNorm = 2.4156, lr_0 = 4.3329e-04
Validation rmse = 0.139981
Validation r2 = 0.834165
Validation mse = 0.019595
Epoch 22
Loss = 1.0834e-01, PNorm = 35.0554, GNorm = 1.6912, lr_0 = 4.2086e-04
Loss = 9.6924e-02, PNorm = 35.0679, GNorm = 1.0290, lr_0 = 4.0987e-04
Validation rmse = 0.144816
Validation r2 = 0.822510
Validation mse = 0.020972
Epoch 23
Loss = 1.0750e-01, PNorm = 35.0812, GNorm = 1.2832, lr_0 = 3.9811e-04
Validation rmse = 0.134898
Validation r2 = 0.845990
Validation mse = 0.018197
Epoch 24
Loss = 6.3021e-02, PNorm = 35.0923, GNorm = 2.0792, lr_0 = 3.8771e-04
Loss = 1.0463e-01, PNorm = 35.1063, GNorm = 1.1925, lr_0 = 3.7758e-04
Validation rmse = 0.138842
Validation r2 = 0.836852
Validation mse = 0.019277
Epoch 25
Loss = 9.6124e-02, PNorm = 35.1171, GNorm = 1.5837, lr_0 = 3.6675e-04
Validation rmse = 0.138144
Validation r2 = 0.838488
Validation mse = 0.019084
Epoch 26
Loss = 8.4113e-02, PNorm = 35.1258, GNorm = 2.2278, lr_0 = 3.5622e-04
Loss = 1.0854e-01, PNorm = 35.1344, GNorm = 2.5368, lr_0 = 3.4692e-04
Validation rmse = 0.147507
Validation r2 = 0.815852
Validation mse = 0.021758
Epoch 27
Loss = 9.7906e-02, PNorm = 35.1460, GNorm = 0.7422, lr_0 = 3.3786e-04
Validation rmse = 0.141074
Validation r2 = 0.831563
Validation mse = 0.019902
Epoch 28
Loss = 9.7045e-02, PNorm = 35.1570, GNorm = 1.4455, lr_0 = 3.2816e-04
Loss = 8.7469e-02, PNorm = 35.1685, GNorm = 1.1972, lr_0 = 3.1959e-04
Validation rmse = 0.139301
Validation r2 = 0.835772
Validation mse = 0.019405
Epoch 29
Loss = 8.7481e-02, PNorm = 35.1755, GNorm = 0.8116, lr_0 = 3.1042e-04
Validation rmse = 0.138116
Validation r2 = 0.838553
Validation mse = 0.019076
Epoch 30
Loss = 8.7173e-02, PNorm = 35.1859, GNorm = 1.5064, lr_0 = 3.0232e-04
Loss = 8.2376e-02, PNorm = 35.1959, GNorm = 1.3897, lr_0 = 2.9442e-04
Validation rmse = 0.133172
Validation r2 = 0.849905
Validation mse = 0.017735
Epoch 31
Loss = 8.4530e-02, PNorm = 35.2088, GNorm = 0.5563, lr_0 = 2.8597e-04
Validation rmse = 0.134300
Validation r2 = 0.847352
Validation mse = 0.018036
Epoch 32
Loss = 6.6886e-02, PNorm = 35.2180, GNorm = 2.1102, lr_0 = 2.7777e-04
Loss = 8.2492e-02, PNorm = 35.2255, GNorm = 2.8876, lr_0 = 2.7051e-04
Validation rmse = 0.132983
Validation r2 = 0.850330
Validation mse = 0.017684
Epoch 33
Loss = 8.6071e-02, PNorm = 35.2360, GNorm = 0.6201, lr_0 = 2.6275e-04
Loss = 8.3413e-02, PNorm = 35.2450, GNorm = 4.3851, lr_0 = 2.5589e-04
Validation rmse = 0.140793
Validation r2 = 0.832234
Validation mse = 0.019823
Epoch 34
Loss = 8.4820e-02, PNorm = 35.2534, GNorm = 1.6345, lr_0 = 2.4920e-04
Validation rmse = 0.135711
Validation r2 = 0.844126
Validation mse = 0.018418
Epoch 35
Loss = 8.6662e-02, PNorm = 35.2627, GNorm = 0.8413, lr_0 = 2.4205e-04
Loss = 8.0041e-02, PNorm = 35.2700, GNorm = 0.7777, lr_0 = 2.3573e-04
Loss = 3.4099e-02, PNorm = 35.2709, GNorm = 1.2601, lr_0 = 2.3511e-04
Validation rmse = 0.150085
Validation r2 = 0.809358
Validation mse = 0.022526
Epoch 36
Loss = 8.7296e-02, PNorm = 35.2808, GNorm = 2.0221, lr_0 = 2.2897e-04
Validation rmse = 0.142362
Validation r2 = 0.828474
Validation mse = 0.020267
Epoch 37
Loss = 9.6217e-02, PNorm = 35.2876, GNorm = 2.5706, lr_0 = 2.2299e-04
Loss = 7.7934e-02, PNorm = 35.2945, GNorm = 2.7217, lr_0 = 2.1716e-04
Validation rmse = 0.137268
Validation r2 = 0.840530
Validation mse = 0.018842
Epoch 38
Loss = 9.3337e-02, PNorm = 35.3033, GNorm = 1.5200, lr_0 = 2.1093e-04
Validation rmse = 0.137339
Validation r2 = 0.840365
Validation mse = 0.018862
Epoch 39
Loss = 7.6407e-02, PNorm = 35.3093, GNorm = 0.6400, lr_0 = 2.0488e-04
Loss = 7.8250e-02, PNorm = 35.3161, GNorm = 0.5395, lr_0 = 1.9953e-04
Validation rmse = 0.135109
Validation r2 = 0.845506
Validation mse = 0.018255
Epoch 40
Loss = 8.5495e-02, PNorm = 35.3226, GNorm = 1.8150, lr_0 = 1.9431e-04
Validation rmse = 0.138770
Validation r2 = 0.837020
Validation mse = 0.019257
Epoch 41
Loss = 8.6485e-02, PNorm = 35.3291, GNorm = 3.0198, lr_0 = 1.8874e-04
Loss = 7.6913e-02, PNorm = 35.3356, GNorm = 0.6538, lr_0 = 1.8381e-04
Validation rmse = 0.136020
Validation r2 = 0.843417
Validation mse = 0.018501
Epoch 42
Loss = 6.8200e-02, PNorm = 35.3419, GNorm = 0.8627, lr_0 = 1.7854e-04
Validation rmse = 0.136833
Validation r2 = 0.841539
Validation mse = 0.018723
Epoch 43
Loss = 8.6892e-02, PNorm = 35.3482, GNorm = 2.4694, lr_0 = 1.7341e-04
Loss = 7.5011e-02, PNorm = 35.3538, GNorm = 1.8185, lr_0 = 1.6888e-04
Validation rmse = 0.134285
Validation r2 = 0.847384
Validation mse = 0.018033
Epoch 44
Loss = 7.4680e-02, PNorm = 35.3599, GNorm = 0.4525, lr_0 = 1.6447e-04
Validation rmse = 0.134799
Validation r2 = 0.846214
Validation mse = 0.018171
Epoch 45
Loss = 7.5827e-02, PNorm = 35.3662, GNorm = 0.7861, lr_0 = 1.5975e-04
Loss = 7.8195e-02, PNorm = 35.3709, GNorm = 0.7652, lr_0 = 1.5558e-04
Validation rmse = 0.134204
Validation r2 = 0.847571
Validation mse = 0.018011
Epoch 46
Loss = 8.0297e-02, PNorm = 35.3757, GNorm = 1.4517, lr_0 = 1.5112e-04
Validation rmse = 0.134816
Validation r2 = 0.846176
Validation mse = 0.018175
Epoch 47
Loss = 8.2879e-02, PNorm = 35.3816, GNorm = 0.8098, lr_0 = 1.4717e-04
Loss = 7.7937e-02, PNorm = 35.3870, GNorm = 1.1982, lr_0 = 1.4332e-04
Validation rmse = 0.133683
Validation r2 = 0.848750
Validation mse = 0.017871
Epoch 48
Loss = 8.4620e-02, PNorm = 35.3922, GNorm = 0.7084, lr_0 = 1.3921e-04
Validation rmse = 0.134258
Validation r2 = 0.847447
Validation mse = 0.018025
Epoch 49
Loss = 5.9762e-02, PNorm = 35.3970, GNorm = 0.4735, lr_0 = 1.3522e-04
Loss = 6.9678e-02, PNorm = 35.4021, GNorm = 0.7869, lr_0 = 1.3169e-04
Validation rmse = 0.133803
Validation r2 = 0.848480
Validation mse = 0.017903
Epoch 50
Loss = 7.3964e-02, PNorm = 35.4070, GNorm = 2.6286, lr_0 = 1.2825e-04
Loss = 7.4312e-02, PNorm = 35.4117, GNorm = 0.8288, lr_0 = 1.2490e-04
Loss = 1.1456e-01, PNorm = 35.4121, GNorm = 1.3440, lr_0 = 1.2457e-04
Validation rmse = 0.142987
Validation r2 = 0.826966
Validation mse = 0.020445
Epoch 51
Loss = 7.6708e-02, PNorm = 35.4159, GNorm = 0.9445, lr_0 = 1.2131e-04
Validation rmse = 0.138538
Validation r2 = 0.837565
Validation mse = 0.019193
Epoch 52
Loss = 7.3651e-02, PNorm = 35.4205, GNorm = 1.4953, lr_0 = 1.1783e-04
Loss = 6.9514e-02, PNorm = 35.4250, GNorm = 0.3291, lr_0 = 1.1475e-04
Loss = 6.1634e-02, PNorm = 35.4254, GNorm = 1.2891, lr_0 = 1.1445e-04
Validation rmse = 0.135254
Validation r2 = 0.845175
Validation mse = 0.018294
Epoch 53
Loss = 7.7415e-02, PNorm = 35.4295, GNorm = 1.1008, lr_0 = 1.1146e-04
Validation rmse = 0.134003
Validation r2 = 0.848026
Validation mse = 0.017957
Epoch 54
Loss = 6.4450e-02, PNorm = 35.4323, GNorm = 0.4572, lr_0 = 1.0855e-04
Loss = 6.9183e-02, PNorm = 35.4356, GNorm = 0.5694, lr_0 = 1.0572e-04
Validation rmse = 0.133622
Validation r2 = 0.848889
Validation mse = 0.017855
Epoch 55
Loss = 7.7176e-02, PNorm = 35.4403, GNorm = 0.4595, lr_0 = 1.0268e-04
Validation rmse = 0.132896
Validation r2 = 0.850527
Validation mse = 0.017661
Epoch 56
Loss = 5.0490e-02, PNorm = 35.4436, GNorm = 1.4122, lr_0 = 1.0000e-04
Loss = 7.5618e-02, PNorm = 35.4470, GNorm = 1.3791, lr_0 = 1.0000e-04
Validation rmse = 0.133161
Validation r2 = 0.849929
Validation mse = 0.017732
Epoch 57
Loss = 5.8742e-02, PNorm = 35.4506, GNorm = 0.6585, lr_0 = 1.0000e-04
Validation rmse = 0.132959
Validation r2 = 0.850384
Validation mse = 0.017678
Epoch 58
Loss = 6.4061e-02, PNorm = 35.4543, GNorm = 2.8056, lr_0 = 1.0000e-04
Loss = 7.3078e-02, PNorm = 35.4580, GNorm = 1.2500, lr_0 = 1.0000e-04
Validation rmse = 0.133840
Validation r2 = 0.848395
Validation mse = 0.017913
Epoch 59
Loss = 6.9348e-02, PNorm = 35.4620, GNorm = 1.0000, lr_0 = 1.0000e-04
Validation rmse = 0.133112
Validation r2 = 0.850040
Validation mse = 0.017719
Model 0 best validation rmse = 0.132896 on epoch 55
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.266027
Model 0 test r2 = -0.429294
Model 0 test mse = 0.070771
Ensemble test rmse = 0.266027
Ensemble test r2 = -0.429294
Ensemble test mse = 0.070771
Fold 9
Splitting data with seed 9
Total size = 957 | train size = 765 | val size = 192 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.3054e-01, PNorm = 34.0162, GNorm = 1.1627, lr_0 = 4.3000e-04
Validation rmse = 0.301666
Validation r2 = 0.209309
Validation mse = 0.091002
Epoch 1
Loss = 5.8965e-01, PNorm = 34.0551, GNorm = 2.7692, lr_0 = 7.6000e-04
Loss = 6.0228e-01, PNorm = 34.1114, GNorm = 4.7453, lr_0 = 9.9472e-04
Loss = 6.0214e-01, PNorm = 34.1183, GNorm = 4.5200, lr_0 = 9.9209e-04
Validation rmse = 0.251413
Validation r2 = 0.450800
Validation mse = 0.063209
Epoch 2
Loss = 4.3677e-01, PNorm = 34.1908, GNorm = 2.7632, lr_0 = 9.6618e-04
Validation rmse = 0.245511
Validation r2 = 0.476281
Validation mse = 0.060276
Epoch 3
Loss = 4.0948e-01, PNorm = 34.2655, GNorm = 7.7854, lr_0 = 9.3846e-04
Loss = 3.3237e-01, PNorm = 34.3274, GNorm = 7.9269, lr_0 = 9.1394e-04
Validation rmse = 0.189538
Validation r2 = 0.687863
Validation mse = 0.035924
Epoch 4
Loss = 2.7139e-01, PNorm = 34.3868, GNorm = 5.2611, lr_0 = 8.9007e-04
Validation rmse = 0.172380
Validation r2 = 0.741818
Validation mse = 0.029715
Epoch 5
Loss = 2.8477e-01, PNorm = 34.4433, GNorm = 1.4014, lr_0 = 8.6453e-04
Loss = 2.0394e-01, PNorm = 34.4924, GNorm = 1.3230, lr_0 = 8.4195e-04
Validation rmse = 0.161365
Validation r2 = 0.773758
Validation mse = 0.026039
Epoch 6
Loss = 1.7754e-01, PNorm = 34.5423, GNorm = 2.6273, lr_0 = 8.1779e-04
Validation rmse = 0.178833
Validation r2 = 0.722124
Validation mse = 0.031981
Epoch 7
Loss = 2.0221e-01, PNorm = 34.5808, GNorm = 1.0033, lr_0 = 7.9643e-04
Loss = 1.9562e-01, PNorm = 34.6157, GNorm = 1.6197, lr_0 = 7.7563e-04
Validation rmse = 0.148928
Validation r2 = 0.807289
Validation mse = 0.022179
Epoch 8
Loss = 2.0700e-01, PNorm = 34.6564, GNorm = 3.4760, lr_0 = 7.5338e-04
Validation rmse = 0.178935
Validation r2 = 0.721809
Validation mse = 0.032018
Epoch 9
Loss = 1.8629e-01, PNorm = 34.6991, GNorm = 2.7270, lr_0 = 7.3176e-04
Loss = 1.7666e-01, PNorm = 34.7277, GNorm = 3.7464, lr_0 = 7.1265e-04
Validation rmse = 0.140750
Validation r2 = 0.827872
Validation mse = 0.019811
Epoch 10
Loss = 1.4163e-01, PNorm = 34.7519, GNorm = 3.0352, lr_0 = 6.9403e-04
Validation rmse = 0.159687
Validation r2 = 0.778439
Validation mse = 0.025500
Epoch 11
Loss = 1.6043e-01, PNorm = 34.7765, GNorm = 3.7337, lr_0 = 6.7412e-04
Loss = 1.4821e-01, PNorm = 34.7970, GNorm = 2.4421, lr_0 = 6.5651e-04
Validation rmse = 0.135663
Validation r2 = 0.840089
Validation mse = 0.018404
Epoch 12
Loss = 1.3105e-01, PNorm = 34.8192, GNorm = 3.0116, lr_0 = 6.3767e-04
Validation rmse = 0.139831
Validation r2 = 0.830112
Validation mse = 0.019553
Epoch 13
Loss = 1.3398e-01, PNorm = 34.8427, GNorm = 2.3291, lr_0 = 6.1938e-04
Loss = 1.2671e-01, PNorm = 34.8609, GNorm = 2.9528, lr_0 = 6.0320e-04
Validation rmse = 0.131104
Validation r2 = 0.850655
Validation mse = 0.017188
Epoch 14
Loss = 1.1730e-01, PNorm = 34.8777, GNorm = 1.3719, lr_0 = 5.8744e-04
Validation rmse = 0.130004
Validation r2 = 0.853151
Validation mse = 0.016901
Epoch 15
Loss = 6.8050e-02, PNorm = 34.8966, GNorm = 0.8350, lr_0 = 5.7059e-04
Loss = 1.2712e-01, PNorm = 34.9052, GNorm = 3.3877, lr_0 = 5.5568e-04
Validation rmse = 0.129398
Validation r2 = 0.854518
Validation mse = 0.016744
Epoch 16
Loss = 1.0534e-01, PNorm = 34.9188, GNorm = 3.0497, lr_0 = 5.3974e-04
Loss = 1.2240e-01, PNorm = 34.9324, GNorm = 2.7360, lr_0 = 5.2564e-04
Validation rmse = 0.128874
Validation r2 = 0.855693
Validation mse = 0.016609
Epoch 17
Loss = 1.1248e-01, PNorm = 34.9454, GNorm = 0.9779, lr_0 = 5.1191e-04
Validation rmse = 0.133596
Validation r2 = 0.844926
Validation mse = 0.017848
Epoch 18
Loss = 1.1662e-01, PNorm = 34.9604, GNorm = 0.6994, lr_0 = 4.9722e-04
Loss = 1.3361e-01, PNorm = 34.9761, GNorm = 0.4678, lr_0 = 4.8424e-04
Loss = 6.1584e-02, PNorm = 34.9778, GNorm = 0.8772, lr_0 = 4.8296e-04
Validation rmse = 0.131232
Validation r2 = 0.850364
Validation mse = 0.017222
Epoch 19
Loss = 1.1652e-01, PNorm = 34.9950, GNorm = 0.5779, lr_0 = 4.7034e-04
Validation rmse = 0.126034
Validation r2 = 0.861983
Validation mse = 0.015885
Epoch 20
Loss = 8.0661e-02, PNorm = 35.0056, GNorm = 1.5599, lr_0 = 4.5806e-04
Loss = 1.1215e-01, PNorm = 35.0160, GNorm = 1.7673, lr_0 = 4.4609e-04
Validation rmse = 0.128726
Validation r2 = 0.856025
Validation mse = 0.016570
Epoch 21
Loss = 9.9632e-02, PNorm = 35.0323, GNorm = 4.7306, lr_0 = 4.3329e-04
Validation rmse = 0.127338
Validation r2 = 0.859113
Validation mse = 0.016215
Epoch 22
Loss = 9.7500e-02, PNorm = 35.0475, GNorm = 1.3309, lr_0 = 4.2086e-04
Loss = 1.0344e-01, PNorm = 35.0595, GNorm = 0.7348, lr_0 = 4.0987e-04
Validation rmse = 0.127241
Validation r2 = 0.859328
Validation mse = 0.016190
Epoch 23
Loss = 9.6248e-02, PNorm = 35.0730, GNorm = 1.6307, lr_0 = 3.9811e-04
Validation rmse = 0.131343
Validation r2 = 0.850112
Validation mse = 0.017251
Epoch 24
Loss = 9.6622e-02, PNorm = 35.0813, GNorm = 1.0390, lr_0 = 3.8771e-04
Loss = 1.0948e-01, PNorm = 35.0925, GNorm = 3.7644, lr_0 = 3.7758e-04
Validation rmse = 0.132119
Validation r2 = 0.848336
Validation mse = 0.017455
Epoch 25
Loss = 9.9100e-02, PNorm = 35.1055, GNorm = 0.7642, lr_0 = 3.6675e-04
Validation rmse = 0.129641
Validation r2 = 0.853970
Validation mse = 0.016807
Epoch 26
Loss = 1.0199e-01, PNorm = 35.1182, GNorm = 1.7696, lr_0 = 3.5622e-04
Loss = 9.7340e-02, PNorm = 35.1289, GNorm = 1.2592, lr_0 = 3.4692e-04
Validation rmse = 0.128692
Validation r2 = 0.856101
Validation mse = 0.016562
Epoch 27
Loss = 9.2739e-02, PNorm = 35.1385, GNorm = 1.1004, lr_0 = 3.3786e-04
Validation rmse = 0.124104
Validation r2 = 0.866177
Validation mse = 0.015402
Epoch 28
Loss = 9.5150e-02, PNorm = 35.1453, GNorm = 1.5461, lr_0 = 3.2816e-04
Loss = 1.0108e-01, PNorm = 35.1539, GNorm = 3.6685, lr_0 = 3.1959e-04
Validation rmse = 0.129112
Validation r2 = 0.855160
Validation mse = 0.016670
Epoch 29
Loss = 9.8623e-02, PNorm = 35.1637, GNorm = 3.5992, lr_0 = 3.1042e-04
Validation rmse = 0.122920
Validation r2 = 0.868720
Validation mse = 0.015109
Epoch 30
Loss = 7.1227e-02, PNorm = 35.1717, GNorm = 1.6551, lr_0 = 3.0232e-04
Loss = 9.7681e-02, PNorm = 35.1810, GNorm = 3.0510, lr_0 = 2.9442e-04
Validation rmse = 0.126160
Validation r2 = 0.861707
Validation mse = 0.015916
Epoch 31
Loss = 1.0517e-01, PNorm = 35.1916, GNorm = 1.7041, lr_0 = 2.8597e-04
Validation rmse = 0.128660
Validation r2 = 0.856174
Validation mse = 0.016553
Epoch 32
Loss = 6.6216e-02, PNorm = 35.2000, GNorm = 0.8092, lr_0 = 2.7777e-04
Loss = 9.0851e-02, PNorm = 35.2113, GNorm = 1.1649, lr_0 = 2.7051e-04
Validation rmse = 0.150888
Validation r2 = 0.802183
Validation mse = 0.022767
Epoch 33
Loss = 9.9059e-02, PNorm = 35.2177, GNorm = 2.8504, lr_0 = 2.6275e-04
Loss = 1.0377e-01, PNorm = 35.2255, GNorm = 1.7372, lr_0 = 2.5589e-04
Validation rmse = 0.124061
Validation r2 = 0.866270
Validation mse = 0.015391
Epoch 34
Loss = 8.6893e-02, PNorm = 35.2325, GNorm = 2.5068, lr_0 = 2.4920e-04
Validation rmse = 0.125840
Validation r2 = 0.862409
Validation mse = 0.015836
Epoch 35
Loss = 9.8931e-02, PNorm = 35.2411, GNorm = 0.7672, lr_0 = 2.4205e-04
Loss = 8.0302e-02, PNorm = 35.2472, GNorm = 0.3781, lr_0 = 2.3573e-04
Loss = 4.5533e-02, PNorm = 35.2475, GNorm = 1.0183, lr_0 = 2.3511e-04
Validation rmse = 0.125029
Validation r2 = 0.864176
Validation mse = 0.015632
Epoch 36
Loss = 9.2265e-02, PNorm = 35.2532, GNorm = 1.6922, lr_0 = 2.2897e-04
Validation rmse = 0.122747
Validation r2 = 0.869089
Validation mse = 0.015067
Epoch 37
Loss = 6.3425e-02, PNorm = 35.2580, GNorm = 0.7955, lr_0 = 2.2299e-04
Loss = 9.2034e-02, PNorm = 35.2644, GNorm = 1.0272, lr_0 = 2.1716e-04
Validation rmse = 0.135675
Validation r2 = 0.840060
Validation mse = 0.018408
Epoch 38
Loss = 9.8374e-02, PNorm = 35.2714, GNorm = 1.1120, lr_0 = 2.1093e-04
Validation rmse = 0.124542
Validation r2 = 0.865232
Validation mse = 0.015511
Epoch 39
Loss = 7.7949e-02, PNorm = 35.2776, GNorm = 0.5969, lr_0 = 2.0488e-04
Loss = 8.7071e-02, PNorm = 35.2835, GNorm = 0.9043, lr_0 = 1.9953e-04
Validation rmse = 0.123348
Validation r2 = 0.867803
Validation mse = 0.015215
Epoch 40
Loss = 7.8584e-02, PNorm = 35.2885, GNorm = 2.6513, lr_0 = 1.9431e-04
Validation rmse = 0.125483
Validation r2 = 0.863188
Validation mse = 0.015746
Epoch 41
Loss = 9.5654e-02, PNorm = 35.2944, GNorm = 1.1665, lr_0 = 1.8874e-04
Loss = 8.4085e-02, PNorm = 35.2988, GNorm = 0.8328, lr_0 = 1.8381e-04
Validation rmse = 0.126732
Validation r2 = 0.860451
Validation mse = 0.016061
Epoch 42
Loss = 8.6679e-02, PNorm = 35.3048, GNorm = 2.5879, lr_0 = 1.7854e-04
Validation rmse = 0.130597
Validation r2 = 0.851809
Validation mse = 0.017056
Epoch 43
Loss = 8.9241e-02, PNorm = 35.3103, GNorm = 0.7019, lr_0 = 1.7341e-04
Loss = 8.7258e-02, PNorm = 35.3154, GNorm = 2.7156, lr_0 = 1.6888e-04
Validation rmse = 0.125599
Validation r2 = 0.862935
Validation mse = 0.015775
Epoch 44
Loss = 8.0851e-02, PNorm = 35.3208, GNorm = 0.5405, lr_0 = 1.6447e-04
Validation rmse = 0.123132
Validation r2 = 0.868265
Validation mse = 0.015162
Epoch 45
Loss = 9.5417e-02, PNorm = 35.3258, GNorm = 0.9581, lr_0 = 1.5975e-04
Loss = 7.4775e-02, PNorm = 35.3296, GNorm = 1.0857, lr_0 = 1.5558e-04
Validation rmse = 0.124915
Validation r2 = 0.864423
Validation mse = 0.015604
Epoch 46
Loss = 8.8174e-02, PNorm = 35.3365, GNorm = 1.5370, lr_0 = 1.5112e-04
Validation rmse = 0.127705
Validation r2 = 0.858299
Validation mse = 0.016309
Epoch 47
Loss = 8.5050e-02, PNorm = 35.3411, GNorm = 0.9472, lr_0 = 1.4717e-04
Loss = 6.8344e-02, PNorm = 35.3446, GNorm = 1.3472, lr_0 = 1.4332e-04
Validation rmse = 0.125233
Validation r2 = 0.863733
Validation mse = 0.015683
Epoch 48
Loss = 6.6136e-02, PNorm = 35.3509, GNorm = 0.7082, lr_0 = 1.3921e-04
Validation rmse = 0.124523
Validation r2 = 0.865273
Validation mse = 0.015506
Epoch 49
Loss = 8.5266e-02, PNorm = 35.3559, GNorm = 2.0143, lr_0 = 1.3522e-04
Loss = 7.5183e-02, PNorm = 35.3598, GNorm = 0.9713, lr_0 = 1.3169e-04
Validation rmse = 0.124066
Validation r2 = 0.866261
Validation mse = 0.015392
Epoch 50
Loss = 8.5888e-02, PNorm = 35.3639, GNorm = 0.6348, lr_0 = 1.2825e-04
Loss = 7.9674e-02, PNorm = 35.3682, GNorm = 2.6631, lr_0 = 1.2490e-04
Loss = 1.7732e-02, PNorm = 35.3683, GNorm = 0.5913, lr_0 = 1.2457e-04
Validation rmse = 0.129075
Validation r2 = 0.855243
Validation mse = 0.016660
Epoch 51
Loss = 8.2690e-02, PNorm = 35.3713, GNorm = 2.6594, lr_0 = 1.2131e-04
Validation rmse = 0.123728
Validation r2 = 0.866989
Validation mse = 0.015309
Epoch 52
Loss = 9.5290e-02, PNorm = 35.3758, GNorm = 0.8892, lr_0 = 1.1783e-04
Loss = 6.9863e-02, PNorm = 35.3786, GNorm = 0.9103, lr_0 = 1.1475e-04
Loss = 1.5263e-01, PNorm = 35.3791, GNorm = 2.0694, lr_0 = 1.1445e-04
Validation rmse = 0.123041
Validation r2 = 0.868461
Validation mse = 0.015139
Epoch 53
Loss = 7.2754e-02, PNorm = 35.3833, GNorm = 0.6999, lr_0 = 1.1146e-04
Validation rmse = 0.125242
Validation r2 = 0.863713
Validation mse = 0.015686
Epoch 54
Loss = 8.6026e-02, PNorm = 35.3862, GNorm = 2.2898, lr_0 = 1.0855e-04
Loss = 7.7040e-02, PNorm = 35.3893, GNorm = 1.4470, lr_0 = 1.0572e-04
Validation rmse = 0.128505
Validation r2 = 0.856520
Validation mse = 0.016513
Epoch 55
Loss = 6.5753e-02, PNorm = 35.3936, GNorm = 2.1560, lr_0 = 1.0268e-04
Validation rmse = 0.128711
Validation r2 = 0.856058
Validation mse = 0.016567
Epoch 56
Loss = 7.6099e-02, PNorm = 35.3973, GNorm = 0.5777, lr_0 = 1.0000e-04
Loss = 7.6713e-02, PNorm = 35.4004, GNorm = 0.5491, lr_0 = 1.0000e-04
Validation rmse = 0.124992
Validation r2 = 0.864257
Validation mse = 0.015623
Epoch 57
Loss = 7.9482e-02, PNorm = 35.4029, GNorm = 0.7608, lr_0 = 1.0000e-04
Validation rmse = 0.123541
Validation r2 = 0.867390
Validation mse = 0.015262
Epoch 58
Loss = 8.6798e-02, PNorm = 35.4059, GNorm = 0.5640, lr_0 = 1.0000e-04
Loss = 7.2246e-02, PNorm = 35.4086, GNorm = 0.4768, lr_0 = 1.0000e-04
Validation rmse = 0.126004
Validation r2 = 0.862049
Validation mse = 0.015877
Epoch 59
Loss = 6.9875e-02, PNorm = 35.4114, GNorm = 1.0906, lr_0 = 1.0000e-04
Validation rmse = 0.123995
Validation r2 = 0.866413
Validation mse = 0.015375
Model 0 best validation rmse = 0.122747 on epoch 36
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.236757
Model 0 test r2 = -0.132071
Model 0 test mse = 0.056054
Ensemble test rmse = 0.236757
Ensemble test r2 = -0.132071
Ensemble test mse = 0.056054
10-fold cross validation
	Seed 0 ==> test rmse = 0.271958
	Seed 0 ==> test r2 = -0.493729
	Seed 0 ==> test mse = 0.073961
	Seed 1 ==> test rmse = 0.276821
	Seed 1 ==> test r2 = -0.547632
	Seed 1 ==> test mse = 0.076630
	Seed 2 ==> test rmse = 0.290860
	Seed 2 ==> test r2 = -0.708586
	Seed 2 ==> test mse = 0.084600
	Seed 3 ==> test rmse = 0.249793
	Seed 3 ==> test r2 = -0.260171
	Seed 3 ==> test mse = 0.062397
	Seed 4 ==> test rmse = 0.252244
	Seed 4 ==> test r2 = -0.285020
	Seed 4 ==> test mse = 0.063627
	Seed 5 ==> test rmse = 0.280140
	Seed 5 ==> test r2 = -0.584964
	Seed 5 ==> test mse = 0.078479
	Seed 6 ==> test rmse = 0.270843
	Seed 6 ==> test r2 = -0.481508
	Seed 6 ==> test mse = 0.073356
	Seed 7 ==> test rmse = 0.279553
	Seed 7 ==> test r2 = -0.578325
	Seed 7 ==> test mse = 0.078150
	Seed 8 ==> test rmse = 0.266027
	Seed 8 ==> test r2 = -0.429294
	Seed 8 ==> test mse = 0.070771
	Seed 9 ==> test rmse = 0.236757
	Seed 9 ==> test r2 = -0.132071
	Seed 9 ==> test mse = 0.056054
Overall test rmse = 0.267500 +/- 0.015692
Overall test r2 = -0.450130 +/- 0.166957
Overall test mse = 0.071802 +/- 0.008267
Elapsed time = 0:06:48
