Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-fb03ea67-e9f1-456d-bb00-313f16904d4e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 2,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': [''],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300--smiles_column', 'full_smiles'],
 'task_names': ['dm300--smiles_column', 'full_smiles'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-fb03ea67-e9f1-456d-bb00-313f16904d4e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,170 | train size = 930 | val size = 234 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.4346e-01, PNorm = 34.0153, GNorm = 4.0111, lr_0 = 3.7500e-04
Validation rmse = 0.323457
Epoch 1
Loss = 6.8934e-01, PNorm = 34.0439, GNorm = 10.0716, lr_0 = 6.5000e-04
Loss = 6.8462e-01, PNorm = 34.0809, GNorm = 1.5600, lr_0 = 9.0000e-04
Validation rmse = 0.268341
Epoch 2
Loss = 4.8750e-01, PNorm = 34.1318, GNorm = 2.1056, lr_0 = 4.6416e-04
Loss = 4.7035e-01, PNorm = 34.1531, GNorm = 0.9417, lr_0 = 1.2915e-04
Validation rmse = 0.253878
Model 0 best validation rmse = 0.253878 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.265408
Ensemble test rmse = 0.265408
1-fold cross validation
	Seed 0 ==> test rmse = 0.265408
Overall test rmse = 0.265408 +/- 0.000000
Elapsed time = 0:00:03
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-fb03ea67-e9f1-456d-bb00-313f16904d4e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,170 | train size = 930 | val size = 234 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.4346e-01, PNorm = 34.0153, GNorm = 4.0111, lr_0 = 3.7500e-04
Validation rmse = 0.323457
Epoch 1
Loss = 6.8934e-01, PNorm = 34.0439, GNorm = 10.0716, lr_0 = 6.5000e-04
Loss = 6.8462e-01, PNorm = 34.0809, GNorm = 1.5600, lr_0 = 9.0000e-04
Validation rmse = 0.268341
Epoch 2
Loss = 4.8750e-01, PNorm = 34.1318, GNorm = 2.1056, lr_0 = 4.6416e-04
Loss = 4.7035e-01, PNorm = 34.1531, GNorm = 0.9417, lr_0 = 1.2915e-04
Validation rmse = 0.253878
Model 0 best validation rmse = 0.253878 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.265408
Ensemble test rmse = 0.265408
1-fold cross validation
	Seed 0 ==> test rmse = 0.265408
Overall test rmse = 0.265408 +/- 0.000000
Elapsed time = 0:00:02
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-fb03ea67-e9f1-456d-bb00-313f16904d4e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,170 | train size = 930 | val size = 234 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.4346e-01, PNorm = 34.0153, GNorm = 4.0111, lr_0 = 3.7500e-04
Validation rmse = 0.323457
Epoch 1
Loss = 6.8934e-01, PNorm = 34.0439, GNorm = 10.0716, lr_0 = 6.5000e-04
Loss = 6.8462e-01, PNorm = 34.0809, GNorm = 1.5600, lr_0 = 9.0000e-04
Validation rmse = 0.268341
Epoch 2
Loss = 4.8750e-01, PNorm = 34.1318, GNorm = 2.1056, lr_0 = 4.6416e-04
Loss = 4.7035e-01, PNorm = 34.1531, GNorm = 0.9417, lr_0 = 1.2915e-04
Validation rmse = 0.253878
Model 0 best validation rmse = 0.253878 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.265408
Ensemble test rmse = 0.265408
1-fold cross validation
	Seed 0 ==> test rmse = 0.265408
Overall test rmse = 0.265408 +/- 0.000000
Elapsed time = 0:00:02
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-fb03ea67-e9f1-456d-bb00-313f16904d4e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,170 | train size = 930 | val size = 234 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.4346e-01, PNorm = 34.0153, GNorm = 4.0111, lr_0 = 3.7500e-04
Validation rmse = 0.323457
Epoch 1
Loss = 6.8934e-01, PNorm = 34.0439, GNorm = 10.0716, lr_0 = 6.5000e-04
Loss = 6.8462e-01, PNorm = 34.0809, GNorm = 1.5600, lr_0 = 9.0000e-04
Validation rmse = 0.268341
Epoch 2
Loss = 4.8750e-01, PNorm = 34.1318, GNorm = 2.1056, lr_0 = 4.6416e-04
Loss = 4.7035e-01, PNorm = 34.1531, GNorm = 0.9417, lr_0 = 1.2915e-04
Validation rmse = 0.253878
Model 0 best validation rmse = 0.253878 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.265408
Ensemble test rmse = 0.265408
1-fold cross validation
	Seed 0 ==> test rmse = 0.265408
Overall test rmse = 0.265408 +/- 0.000000
Elapsed time = 0:00:02
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-fb03ea67-e9f1-456d-bb00-313f16904d4e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,170 | train size = 930 | val size = 234 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.4346e-01, PNorm = 34.0153, GNorm = 4.0111, lr_0 = 3.7500e-04
Validation rmse = 0.323457
Epoch 1
Loss = 6.8934e-01, PNorm = 34.0439, GNorm = 10.0716, lr_0 = 6.5000e-04
Loss = 6.8462e-01, PNorm = 34.0809, GNorm = 1.5600, lr_0 = 9.0000e-04
Validation rmse = 0.268341
Epoch 2
Loss = 4.8750e-01, PNorm = 34.1318, GNorm = 2.1056, lr_0 = 4.6416e-04
Loss = 4.7035e-01, PNorm = 34.1531, GNorm = 0.9417, lr_0 = 1.2915e-04
Validation rmse = 0.253878
Model 0 best validation rmse = 0.253878 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.265408
Ensemble test rmse = 0.265408
1-fold cross validation
	Seed 0 ==> test rmse = 0.265408
Overall test rmse = 0.265408 +/- 0.000000
Elapsed time = 0:00:02
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-fb03ea67-e9f1-456d-bb00-313f16904d4e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/_train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 2,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': [''],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300--smiles_column', 'full_smiles'],
 'task_names': ['dm300--smiles_column', 'full_smiles'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-fb03ea67-e9f1-456d-bb00-313f16904d4e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/_train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,170 | train size = 930 | val size = 234 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.4346e-01, PNorm = 34.0153, GNorm = 4.0111, lr_0 = 3.7500e-04
Validation rmse = 0.323456
Epoch 1
Loss = 6.8934e-01, PNorm = 34.0439, GNorm = 10.0708, lr_0 = 6.5000e-04
Loss = 6.8461e-01, PNorm = 34.0809, GNorm = 1.5702, lr_0 = 9.0000e-04
Validation rmse = 0.268221
Epoch 2
Loss = 4.8719e-01, PNorm = 34.1317, GNorm = 2.0929, lr_0 = 4.6416e-04
Loss = 4.6972e-01, PNorm = 34.1531, GNorm = 0.9245, lr_0 = 1.2915e-04
Validation rmse = 0.253850
Model 0 best validation rmse = 0.253850 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.265198
Ensemble test rmse = 0.265198
1-fold cross validation
	Seed 0 ==> test rmse = 0.265198
Overall test rmse = 0.265198 +/- 0.000000
Elapsed time = 0:00:02
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-fb03ea67-e9f1-456d-bb00-313f16904d4e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/_train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,160 | train size = 922 | val size = 232 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.4726e-01, PNorm = 34.0149, GNorm = 2.6635, lr_0 = 3.7500e-04
Validation rmse = 0.295110
Epoch 1
Loss = 5.6914e-01, PNorm = 34.0426, GNorm = 2.2884, lr_0 = 6.5000e-04
Loss = 6.3689e-01, PNorm = 34.0887, GNorm = 9.9895, lr_0 = 9.0000e-04
Validation rmse = 0.262618
Epoch 2
Loss = 5.1985e-01, PNorm = 34.1389, GNorm = 5.5237, lr_0 = 4.0842e-04
Loss = 4.4856e-01, PNorm = 34.1561, GNorm = 2.9894, lr_0 = 1.1365e-04
Validation rmse = 0.250922
Model 0 best validation rmse = 0.250922 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.297608
Ensemble test rmse = 0.297608
1-fold cross validation
	Seed 0 ==> test rmse = 0.297608
Overall test rmse = 0.297608 +/- 0.000000
Elapsed time = 0:00:02
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-fb03ea67-e9f1-456d-bb00-313f16904d4e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/_train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,150 | train size = 914 | val size = 230 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 8.9774e-01, PNorm = 34.0164, GNorm = 5.2234, lr_0 = 3.7500e-04
Validation rmse = 0.274313
Epoch 1
Loss = 6.6088e-01, PNorm = 34.0411, GNorm = 4.7976, lr_0 = 6.5000e-04
Loss = 7.4832e-01, PNorm = 34.0808, GNorm = 10.5694, lr_0 = 9.0000e-04
Validation rmse = 0.258450
Epoch 2
Loss = 5.7655e-01, PNorm = 34.1322, GNorm = 3.8644, lr_0 = 4.0842e-04
Loss = 5.1990e-01, PNorm = 34.1495, GNorm = 1.4857, lr_0 = 1.1365e-04
Validation rmse = 0.232187
Model 0 best validation rmse = 0.232187 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.217268
Ensemble test rmse = 0.217268
1-fold cross validation
	Seed 0 ==> test rmse = 0.217268
Overall test rmse = 0.217268 +/- 0.000000
Elapsed time = 0:00:02
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-fb03ea67-e9f1-456d-bb00-313f16904d4e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/_train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,140 | train size = 906 | val size = 228 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.8115e-01, PNorm = 34.0146, GNorm = 0.7173, lr_0 = 3.7500e-04
Validation rmse = 0.308748
Epoch 1
Loss = 9.4004e-01, PNorm = 34.0381, GNorm = 10.1024, lr_0 = 6.5000e-04
Loss = 6.4735e-01, PNorm = 34.0750, GNorm = 1.8009, lr_0 = 9.0000e-04
Validation rmse = 0.246496
Epoch 2
Loss = 4.7153e-01, PNorm = 34.1354, GNorm = 0.9679, lr_0 = 4.0842e-04
Loss = 4.7550e-01, PNorm = 34.1517, GNorm = 1.3526, lr_0 = 1.1365e-04
Validation rmse = 0.234911
Model 0 best validation rmse = 0.234911 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.258458
Ensemble test rmse = 0.258458
1-fold cross validation
	Seed 0 ==> test rmse = 0.258458
Overall test rmse = 0.258458 +/- 0.000000
Elapsed time = 0:00:03
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-fb03ea67-e9f1-456d-bb00-313f16904d4e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/_train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,130 | train size = 898 | val size = 226 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.0139e+00, PNorm = 34.0137, GNorm = 1.0887, lr_0 = 3.9118e-04
Validation rmse = 0.298810
Epoch 1
Loss = 6.4361e-01, PNorm = 34.0386, GNorm = 3.9413, lr_0 = 6.8235e-04
Loss = 6.7416e-01, PNorm = 34.0866, GNorm = 7.5757, lr_0 = 9.4706e-04
Validation rmse = 0.245063
Epoch 2
Loss = 6.7776e-01, PNorm = 34.1237, GNorm = 7.0833, lr_0 = 3.3839e-04
Loss = 5.6424e-01, PNorm = 34.1341, GNorm = 3.4603, lr_0 = 1.0000e-04
Validation rmse = 0.236971
Model 0 best validation rmse = 0.236971 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.181309
Ensemble test rmse = 0.181309
1-fold cross validation
	Seed 0 ==> test rmse = 0.181309
Overall test rmse = 0.181309 +/- 0.000000
Elapsed time = 0:00:02
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/bin/chemprop_train --data_path ./data/test_train_dm300_full.csv --dataset_type regression --save_dir ./data/train_results/removal --quiet --metric rmse --split_sizes 0.795 0.2 0.005 --smiles_columns full_smiles --target_columns dm300 --epochs 50
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/test_train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 50,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 770 | train size = 612 | val size = 154 | test size = 4
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.7117e-01, PNorm = 34.0148, GNorm = 6.9475, lr_0 = 5.1250e-04
Validation rmse = 0.235896
Epoch 1
Loss = 9.3639e-01, PNorm = 34.0368, GNorm = 5.4105, lr_0 = 9.2500e-04
Validation rmse = 0.228147
Epoch 2
Loss = 7.2103e-01, PNorm = 34.0821, GNorm = 1.6866, lr_0 = 9.6466e-04
Validation rmse = 0.235400
Epoch 3
Loss = 7.7723e-01, PNorm = 34.1264, GNorm = 6.9573, lr_0 = 9.2316e-04
Validation rmse = 0.202813
Epoch 4
Loss = 8.1232e-01, PNorm = 34.1767, GNorm = 10.6384, lr_0 = 8.8345e-04
Loss = 6.1455e-01, PNorm = 34.2259, GNorm = 2.3839, lr_0 = 8.4883e-04
Validation rmse = 0.190614
Epoch 5
Loss = 5.2671e-01, PNorm = 34.2790, GNorm = 1.5930, lr_0 = 8.1556e-04
Validation rmse = 0.189457
Epoch 6
Loss = 5.9731e-01, PNorm = 34.3280, GNorm = 7.4728, lr_0 = 7.8048e-04
Validation rmse = 0.175789
Epoch 7
Loss = 4.6527e-01, PNorm = 34.3753, GNorm = 6.7581, lr_0 = 7.4690e-04
Validation rmse = 0.194810
Epoch 8
Loss = 6.5054e-01, PNorm = 34.4191, GNorm = 6.5577, lr_0 = 7.1477e-04
Loss = 4.0733e-01, PNorm = 34.4640, GNorm = 12.4044, lr_0 = 6.8676e-04
Validation rmse = 0.171017
Epoch 9
Loss = 4.7446e-01, PNorm = 34.4953, GNorm = 6.2714, lr_0 = 6.5985e-04
Validation rmse = 0.177688
Epoch 10
Loss = 4.8403e-01, PNorm = 34.5350, GNorm = 7.1428, lr_0 = 6.3146e-04
Validation rmse = 0.175289
Epoch 11
Loss = 4.7155e-01, PNorm = 34.5699, GNorm = 7.1514, lr_0 = 6.0430e-04
Validation rmse = 0.169953
Epoch 12
Loss = 3.4391e-01, PNorm = 34.6041, GNorm = 3.3749, lr_0 = 5.7830e-04
Validation rmse = 0.151988
Epoch 13
Loss = 4.0004e-01, PNorm = 34.6349, GNorm = 1.5496, lr_0 = 5.5564e-04
Loss = 3.1448e-01, PNorm = 34.6659, GNorm = 4.4116, lr_0 = 5.3386e-04
Validation rmse = 0.151444
Epoch 14
Loss = 2.9565e-01, PNorm = 34.6890, GNorm = 4.0696, lr_0 = 5.1090e-04
Validation rmse = 0.142495
Epoch 15
Loss = 2.9018e-01, PNorm = 34.7187, GNorm = 2.4800, lr_0 = 4.8892e-04
Validation rmse = 0.146459
Epoch 16
Loss = 3.1361e-01, PNorm = 34.7490, GNorm = 5.3914, lr_0 = 4.6788e-04
Validation rmse = 0.135712
Epoch 17
Loss = 4.1113e-01, PNorm = 34.7732, GNorm = 6.4410, lr_0 = 4.4955e-04
Loss = 2.6658e-01, PNorm = 34.7949, GNorm = 3.1052, lr_0 = 4.3193e-04
Loss = 1.0248e-01, PNorm = 34.7975, GNorm = 2.4767, lr_0 = 4.3021e-04
Validation rmse = 0.161165
Epoch 18
Loss = 3.3299e-01, PNorm = 34.8197, GNorm = 7.7566, lr_0 = 4.1335e-04
Validation rmse = 0.148890
Epoch 19
Loss = 2.9635e-01, PNorm = 34.8387, GNorm = 1.6859, lr_0 = 3.9557e-04
Validation rmse = 0.128118
Epoch 20
Loss = 2.1522e-01, PNorm = 34.8598, GNorm = 2.6670, lr_0 = 3.7855e-04
Validation rmse = 0.134416
Epoch 21
Loss = 2.5408e-01, PNorm = 34.8755, GNorm = 5.0919, lr_0 = 3.6372e-04
Validation rmse = 0.134079
Epoch 22
Loss = 3.4676e-01, PNorm = 34.8952, GNorm = 3.9026, lr_0 = 3.4807e-04
Loss = 2.1878e-01, PNorm = 34.9103, GNorm = 1.1440, lr_0 = 3.3443e-04
Validation rmse = 0.129617
Epoch 23
Loss = 2.4180e-01, PNorm = 34.9286, GNorm = 1.1579, lr_0 = 3.2004e-04
Validation rmse = 0.127529
Epoch 24
Loss = 2.2974e-01, PNorm = 34.9430, GNorm = 7.4449, lr_0 = 3.0627e-04
Validation rmse = 0.131542
Epoch 25
Loss = 1.7833e-01, PNorm = 34.9551, GNorm = 1.2416, lr_0 = 2.9427e-04
Validation rmse = 0.128522
Epoch 26
Loss = 2.2119e-01, PNorm = 34.9700, GNorm = 1.7565, lr_0 = 2.8161e-04
Loss = 2.3182e-01, PNorm = 34.9833, GNorm = 2.5820, lr_0 = 2.7058e-04
Loss = 9.7813e-01, PNorm = 34.9843, GNorm = 7.3458, lr_0 = 2.6950e-04
Validation rmse = 0.130583
Epoch 27
Loss = 2.3641e-01, PNorm = 34.9951, GNorm = 1.0583, lr_0 = 2.5894e-04
Validation rmse = 0.126544
Epoch 28
Loss = 2.5424e-01, PNorm = 35.0084, GNorm = 4.7786, lr_0 = 2.4780e-04
Validation rmse = 0.127587
Epoch 29
Loss = 1.8388e-01, PNorm = 35.0208, GNorm = 0.9504, lr_0 = 2.3714e-04
Validation rmse = 0.127030
Epoch 30
Loss = 1.5916e-01, PNorm = 35.0305, GNorm = 0.5274, lr_0 = 2.2784e-04
Validation rmse = 0.128452
Epoch 31
Loss = 1.4803e-01, PNorm = 35.0405, GNorm = 2.3350, lr_0 = 2.1804e-04
Loss = 2.1809e-01, PNorm = 35.0492, GNorm = 0.9226, lr_0 = 2.0950e-04
Validation rmse = 0.126265
Epoch 32
Loss = 2.1467e-01, PNorm = 35.0604, GNorm = 2.6442, lr_0 = 2.0049e-04
Validation rmse = 0.125066
Epoch 33
Loss = 2.2920e-01, PNorm = 35.0706, GNorm = 1.0672, lr_0 = 1.9186e-04
Validation rmse = 0.125876
Epoch 34
Loss = 2.4152e-01, PNorm = 35.0782, GNorm = 5.3310, lr_0 = 1.8434e-04
Validation rmse = 0.125039
Epoch 35
Loss = 1.9512e-01, PNorm = 35.0868, GNorm = 1.0151, lr_0 = 1.7641e-04
Loss = 1.9566e-01, PNorm = 35.0944, GNorm = 1.0651, lr_0 = 1.6950e-04
Loss = 1.4621e-01, PNorm = 35.0954, GNorm = 5.0724, lr_0 = 1.6882e-04
Validation rmse = 0.123261
Epoch 36
Loss = 2.0725e-01, PNorm = 35.1049, GNorm = 3.2213, lr_0 = 1.6221e-04
Validation rmse = 0.129742
Epoch 37
Loss = 1.9953e-01, PNorm = 35.1119, GNorm = 5.2462, lr_0 = 1.5523e-04
Validation rmse = 0.122689
Epoch 38
Loss = 2.0464e-01, PNorm = 35.1184, GNorm = 2.5037, lr_0 = 1.4915e-04
Validation rmse = 0.123362
Epoch 39
Loss = 1.3485e-01, PNorm = 35.1258, GNorm = 4.1674, lr_0 = 1.4273e-04
Validation rmse = 0.126222
Epoch 40
Loss = 1.7974e-01, PNorm = 35.1329, GNorm = 1.5388, lr_0 = 1.3659e-04
Loss = 1.9632e-01, PNorm = 35.1379, GNorm = 3.2602, lr_0 = 1.3124e-04
Validation rmse = 0.122326
Epoch 41
Loss = 2.0761e-01, PNorm = 35.1449, GNorm = 3.4619, lr_0 = 1.2559e-04
Validation rmse = 0.123737
Epoch 42
Loss = 1.7803e-01, PNorm = 35.1500, GNorm = 1.3735, lr_0 = 1.2067e-04
Validation rmse = 0.125828
Epoch 43
Loss = 2.1880e-01, PNorm = 35.1552, GNorm = 1.4307, lr_0 = 1.1548e-04
Validation rmse = 0.126093
Epoch 44
Loss = 1.4975e-01, PNorm = 35.1617, GNorm = 1.1946, lr_0 = 1.1051e-04
Loss = 1.9610e-01, PNorm = 35.1665, GNorm = 3.2602, lr_0 = 1.0618e-04
Loss = 6.1651e-02, PNorm = 35.1669, GNorm = 2.6987, lr_0 = 1.0576e-04
Validation rmse = 0.122354
Epoch 45
Loss = 1.9677e-01, PNorm = 35.1709, GNorm = 2.3648, lr_0 = 1.0161e-04
Validation rmse = 0.126790
Epoch 46
Loss = 1.4248e-01, PNorm = 35.1749, GNorm = 0.7334, lr_0 = 1.0000e-04
Validation rmse = 0.122444
Epoch 47
Loss = 1.8722e-01, PNorm = 35.1793, GNorm = 1.1924, lr_0 = 1.0000e-04
Validation rmse = 0.121842
Epoch 48
Loss = 1.2142e-01, PNorm = 35.1846, GNorm = 1.2424, lr_0 = 1.0000e-04
Validation rmse = 0.121502
Epoch 49
Loss = 2.7030e-01, PNorm = 35.1897, GNorm = 1.8516, lr_0 = 1.0000e-04
Loss = 1.7090e-01, PNorm = 35.1945, GNorm = 1.3394, lr_0 = 1.0000e-04
Validation rmse = 0.122150
Model 0 best validation rmse = 0.121502 on epoch 48
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.042473
Ensemble test rmse = 0.042473
1-fold cross validation
	Seed 0 ==> test rmse = 0.042473
Overall test rmse = 0.042473 +/- 0.000000
Elapsed time = 0:00:24
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/bin/chemprop_train --data_path ./data/test_train_dm300_full.csv --dataset_type regression --save_dir ./data/train_results/removal --quiet --metric rmse --split_sizes 0.795 0.2 0.005 --smiles_columns full_smiles --target_columns dm300 --epochs 80
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/test_train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 80,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 770 | train size = 612 | val size = 154 | test size = 4
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.7117e-01, PNorm = 34.0148, GNorm = 6.9475, lr_0 = 5.1250e-04
Validation rmse = 0.235896
Epoch 1
Loss = 9.3639e-01, PNorm = 34.0368, GNorm = 5.4105, lr_0 = 9.2500e-04
Validation rmse = 0.228147
Epoch 2
Loss = 7.2092e-01, PNorm = 34.0824, GNorm = 1.5568, lr_0 = 9.7810e-04
Validation rmse = 0.235774
Epoch 3
Loss = 7.8110e-01, PNorm = 34.1278, GNorm = 7.4297, lr_0 = 9.5199e-04
Validation rmse = 0.204637
Epoch 4
Loss = 8.2880e-01, PNorm = 34.1803, GNorm = 10.9163, lr_0 = 9.2657e-04
Loss = 6.2241e-01, PNorm = 34.2314, GNorm = 1.8725, lr_0 = 9.0406e-04
Validation rmse = 0.190445
Epoch 5
Loss = 5.2810e-01, PNorm = 34.2868, GNorm = 1.5456, lr_0 = 8.8209e-04
Validation rmse = 0.188856
Epoch 6
Loss = 6.1997e-01, PNorm = 34.3383, GNorm = 9.0736, lr_0 = 8.5854e-04
Validation rmse = 0.178231
Epoch 7
Loss = 4.7011e-01, PNorm = 34.3912, GNorm = 5.6858, lr_0 = 8.3562e-04
Validation rmse = 0.195656
Epoch 8
Loss = 6.5466e-01, PNorm = 34.4402, GNorm = 6.4930, lr_0 = 8.1331e-04
Loss = 4.1495e-01, PNorm = 34.4909, GNorm = 12.5431, lr_0 = 7.9355e-04
Validation rmse = 0.172206
Epoch 9
Loss = 4.8257e-01, PNorm = 34.5280, GNorm = 6.5870, lr_0 = 7.7426e-04
Validation rmse = 0.176933
Epoch 10
Loss = 4.8429e-01, PNorm = 34.5756, GNorm = 7.4210, lr_0 = 7.5359e-04
Validation rmse = 0.170327
Epoch 11
Loss = 4.5066e-01, PNorm = 34.6187, GNorm = 6.0951, lr_0 = 7.3347e-04
Validation rmse = 0.166248
Epoch 12
Loss = 3.3372e-01, PNorm = 34.6601, GNorm = 1.1864, lr_0 = 7.1389e-04
Validation rmse = 0.147196
Epoch 13
Loss = 3.8193e-01, PNorm = 34.6984, GNorm = 0.9486, lr_0 = 6.9654e-04
Loss = 2.9470e-01, PNorm = 34.7356, GNorm = 1.7520, lr_0 = 6.7962e-04
Validation rmse = 0.153284
Epoch 14
Loss = 2.7573e-01, PNorm = 34.7685, GNorm = 0.8544, lr_0 = 6.6147e-04
Validation rmse = 0.136980
Epoch 15
Loss = 2.6896e-01, PNorm = 34.8064, GNorm = 4.1910, lr_0 = 6.4381e-04
Validation rmse = 0.143216
Epoch 16
Loss = 2.8472e-01, PNorm = 34.8452, GNorm = 7.3308, lr_0 = 6.2663e-04
Validation rmse = 0.136265
Epoch 17
Loss = 4.2794e-01, PNorm = 34.8776, GNorm = 11.6866, lr_0 = 6.1140e-04
Loss = 2.5066e-01, PNorm = 34.9107, GNorm = 1.6851, lr_0 = 5.9654e-04
Loss = 1.3477e-01, PNorm = 34.9142, GNorm = 6.8526, lr_0 = 5.9508e-04
Validation rmse = 0.136446
Epoch 18
Loss = 2.5274e-01, PNorm = 34.9457, GNorm = 2.6656, lr_0 = 5.8062e-04
Validation rmse = 0.129743
Epoch 19
Loss = 2.8308e-01, PNorm = 34.9727, GNorm = 5.6909, lr_0 = 5.6511e-04
Validation rmse = 0.124293
Epoch 20
Loss = 2.1942e-01, PNorm = 34.9974, GNorm = 4.0937, lr_0 = 5.5003e-04
Validation rmse = 0.133766
Epoch 21
Loss = 2.8510e-01, PNorm = 35.0184, GNorm = 8.6473, lr_0 = 5.3666e-04
Validation rmse = 0.146254
Epoch 22
Loss = 3.6543e-01, PNorm = 35.0474, GNorm = 6.9071, lr_0 = 5.2233e-04
Loss = 2.1612e-01, PNorm = 35.0711, GNorm = 2.3753, lr_0 = 5.0964e-04
Validation rmse = 0.130306
Epoch 23
Loss = 2.3045e-01, PNorm = 35.0989, GNorm = 0.8043, lr_0 = 4.9604e-04
Validation rmse = 0.125098
Epoch 24
Loss = 2.2476e-01, PNorm = 35.1197, GNorm = 7.0623, lr_0 = 4.8279e-04
Validation rmse = 0.138095
Epoch 25
Loss = 2.1078e-01, PNorm = 35.1386, GNorm = 5.3795, lr_0 = 4.7106e-04
Validation rmse = 0.125522
Epoch 26
Loss = 2.0218e-01, PNorm = 35.1612, GNorm = 2.5548, lr_0 = 4.5848e-04
Loss = 2.0459e-01, PNorm = 35.1845, GNorm = 1.3610, lr_0 = 4.4734e-04
Loss = 9.5135e-01, PNorm = 35.1862, GNorm = 4.7303, lr_0 = 4.4624e-04
Validation rmse = 0.138566
Epoch 27
Loss = 2.2310e-01, PNorm = 35.2049, GNorm = 2.2894, lr_0 = 4.3540e-04
Validation rmse = 0.133990
Epoch 28
Loss = 2.4174e-01, PNorm = 35.2278, GNorm = 2.7340, lr_0 = 4.2378e-04
Validation rmse = 0.141617
Epoch 29
Loss = 2.1556e-01, PNorm = 35.2464, GNorm = 0.9382, lr_0 = 4.1246e-04
Validation rmse = 0.121752
Epoch 30
Loss = 1.5262e-01, PNorm = 35.2649, GNorm = 2.3138, lr_0 = 4.0244e-04
Validation rmse = 0.127131
Epoch 31
Loss = 1.3724e-01, PNorm = 35.2834, GNorm = 2.0489, lr_0 = 3.9170e-04
Loss = 1.9914e-01, PNorm = 35.3002, GNorm = 1.1550, lr_0 = 3.8218e-04
Validation rmse = 0.124820
Epoch 32
Loss = 1.9680e-01, PNorm = 35.3200, GNorm = 1.2917, lr_0 = 3.7197e-04
Validation rmse = 0.120940
Epoch 33
Loss = 2.0478e-01, PNorm = 35.3364, GNorm = 1.1109, lr_0 = 3.6204e-04
Validation rmse = 0.127142
Epoch 34
Loss = 2.1135e-01, PNorm = 35.3520, GNorm = 3.3747, lr_0 = 3.5325e-04
Validation rmse = 0.120871
Epoch 35
Loss = 1.8441e-01, PNorm = 35.3693, GNorm = 3.4505, lr_0 = 3.4381e-04
Loss = 1.8887e-01, PNorm = 35.3825, GNorm = 2.0410, lr_0 = 3.3546e-04
Loss = 1.5484e-01, PNorm = 35.3845, GNorm = 6.2552, lr_0 = 3.3464e-04
Validation rmse = 0.125954
Epoch 36
Loss = 1.8586e-01, PNorm = 35.4022, GNorm = 1.6048, lr_0 = 3.2650e-04
Validation rmse = 0.126168
Epoch 37
Loss = 1.6851e-01, PNorm = 35.4188, GNorm = 1.2636, lr_0 = 3.1779e-04
Validation rmse = 0.129334
Epoch 38
Loss = 1.8444e-01, PNorm = 35.4328, GNorm = 3.1504, lr_0 = 3.1007e-04
Validation rmse = 0.128838
Epoch 39
Loss = 1.3155e-01, PNorm = 35.4474, GNorm = 4.5324, lr_0 = 3.0179e-04
Validation rmse = 0.122866
Epoch 40
Loss = 1.5854e-01, PNorm = 35.4609, GNorm = 1.8472, lr_0 = 2.9373e-04
Loss = 1.7446e-01, PNorm = 35.4728, GNorm = 2.0523, lr_0 = 2.8659e-04
Validation rmse = 0.122684
Epoch 41
Loss = 1.8569e-01, PNorm = 35.4890, GNorm = 3.1737, lr_0 = 2.7894e-04
Validation rmse = 0.120938
Epoch 42
Loss = 1.6299e-01, PNorm = 35.4990, GNorm = 2.5483, lr_0 = 2.7216e-04
Validation rmse = 0.124001
Epoch 43
Loss = 1.8997e-01, PNorm = 35.5105, GNorm = 1.1030, lr_0 = 2.6490e-04
Validation rmse = 0.122047
Epoch 44
Loss = 1.3497e-01, PNorm = 35.5241, GNorm = 1.9740, lr_0 = 2.5782e-04
Loss = 1.7258e-01, PNorm = 35.5328, GNorm = 1.2232, lr_0 = 2.5156e-04
Loss = 4.7177e-02, PNorm = 35.5337, GNorm = 2.4333, lr_0 = 2.5094e-04
Validation rmse = 0.122431
Epoch 45
Loss = 1.7439e-01, PNorm = 35.5450, GNorm = 3.1951, lr_0 = 2.4484e-04
Validation rmse = 0.121147
Epoch 46
Loss = 1.1882e-01, PNorm = 35.5540, GNorm = 1.8168, lr_0 = 2.3889e-04
Validation rmse = 0.121844
Epoch 47
Loss = 1.5857e-01, PNorm = 35.5631, GNorm = 1.6047, lr_0 = 2.3252e-04
Validation rmse = 0.120554
Epoch 48
Loss = 9.5687e-02, PNorm = 35.5764, GNorm = 1.1008, lr_0 = 2.2631e-04
Validation rmse = 0.121024
Epoch 49
Loss = 2.0491e-01, PNorm = 35.5860, GNorm = 2.0312, lr_0 = 2.2027e-04
Loss = 1.5114e-01, PNorm = 35.5965, GNorm = 1.6921, lr_0 = 2.1491e-04
Validation rmse = 0.120631
Epoch 50
Loss = 1.5511e-01, PNorm = 35.6031, GNorm = 1.4160, lr_0 = 2.0969e-04
Validation rmse = 0.124112
Epoch 51
Loss = 1.7505e-01, PNorm = 35.6136, GNorm = 4.4068, lr_0 = 2.0409e-04
Validation rmse = 0.120098
Epoch 52
Loss = 1.9935e-01, PNorm = 35.6236, GNorm = 4.1207, lr_0 = 1.9864e-04
Validation rmse = 0.123128
Epoch 53
Loss = 1.3576e-01, PNorm = 35.6318, GNorm = 1.9170, lr_0 = 1.9334e-04
Loss = 1.5092e-01, PNorm = 35.6409, GNorm = 1.0046, lr_0 = 1.8864e-04
Loss = 8.3867e-02, PNorm = 35.6415, GNorm = 2.9246, lr_0 = 1.8818e-04
Validation rmse = 0.123964
Epoch 54
Loss = 1.5782e-01, PNorm = 35.6485, GNorm = 2.7408, lr_0 = 1.8361e-04
Validation rmse = 0.123502
Epoch 55
Loss = 1.5924e-01, PNorm = 35.6548, GNorm = 2.4475, lr_0 = 1.7915e-04
Validation rmse = 0.121842
Epoch 56
Loss = 1.4626e-01, PNorm = 35.6627, GNorm = 3.0625, lr_0 = 1.7436e-04
Validation rmse = 0.123516
Epoch 57
Loss = 1.4145e-01, PNorm = 35.6712, GNorm = 3.7541, lr_0 = 1.6971e-04
Validation rmse = 0.121327
Epoch 58
Loss = 4.2092e-02, PNorm = 35.6793, GNorm = 1.3271, lr_0 = 1.6518e-04
Loss = 1.6393e-01, PNorm = 35.6858, GNorm = 3.1626, lr_0 = 1.6116e-04
Validation rmse = 0.123553
Epoch 59
Loss = 1.4473e-01, PNorm = 35.6943, GNorm = 1.5604, lr_0 = 1.5725e-04
Validation rmse = 0.122274
Epoch 60
Loss = 1.3909e-01, PNorm = 35.7006, GNorm = 4.9121, lr_0 = 1.5305e-04
Validation rmse = 0.121770
Epoch 61
Loss = 1.5290e-01, PNorm = 35.7081, GNorm = 3.3318, lr_0 = 1.4896e-04
Validation rmse = 0.121481
Epoch 62
Loss = 9.8201e-02, PNorm = 35.7158, GNorm = 5.1940, lr_0 = 1.4499e-04
Loss = 1.5167e-01, PNorm = 35.7210, GNorm = 2.1680, lr_0 = 1.4146e-04
Validation rmse = 0.121333
Epoch 63
Loss = 1.3760e-01, PNorm = 35.7271, GNorm = 4.3521, lr_0 = 1.3802e-04
Validation rmse = 0.120738
Epoch 64
Loss = 1.2273e-01, PNorm = 35.7347, GNorm = 5.4264, lr_0 = 1.3434e-04
Validation rmse = 0.122201
Epoch 65
Loss = 1.3592e-01, PNorm = 35.7406, GNorm = 1.9554, lr_0 = 1.3075e-04
Validation rmse = 0.121920
Epoch 66
Loss = 2.0899e-01, PNorm = 35.7471, GNorm = 1.3198, lr_0 = 1.2726e-04
Loss = 1.3199e-01, PNorm = 35.7526, GNorm = 5.0457, lr_0 = 1.2417e-04
Validation rmse = 0.123617
Epoch 67
Loss = 1.3682e-01, PNorm = 35.7581, GNorm = 0.7740, lr_0 = 1.2115e-04
Validation rmse = 0.121368
Epoch 68
Loss = 1.5430e-01, PNorm = 35.7636, GNorm = 1.1934, lr_0 = 1.1792e-04
Validation rmse = 0.122184
Epoch 69
Loss = 1.3795e-01, PNorm = 35.7675, GNorm = 1.1048, lr_0 = 1.1477e-04
Validation rmse = 0.122227
Epoch 70
Loss = 8.0603e-02, PNorm = 35.7721, GNorm = 0.6059, lr_0 = 1.1171e-04
Validation rmse = 0.124280
Epoch 71
Loss = 1.1329e-01, PNorm = 35.7765, GNorm = 1.2961, lr_0 = 1.0899e-04
Loss = 1.4559e-01, PNorm = 35.7812, GNorm = 1.7033, lr_0 = 1.0634e-04
Validation rmse = 0.123713
Epoch 72
Loss = 1.3101e-01, PNorm = 35.7864, GNorm = 2.9313, lr_0 = 1.0350e-04
Validation rmse = 0.121636
Epoch 73
Loss = 1.6327e-01, PNorm = 35.7897, GNorm = 1.4036, lr_0 = 1.0074e-04
Validation rmse = 0.124177
Epoch 74
Loss = 1.0462e-01, PNorm = 35.7944, GNorm = 0.6832, lr_0 = 1.0000e-04
Validation rmse = 0.126437
Epoch 75
Loss = 1.8879e-01, PNorm = 35.7990, GNorm = 4.9902, lr_0 = 1.0000e-04
Loss = 1.2168e-01, PNorm = 35.8033, GNorm = 2.9966, lr_0 = 1.0000e-04
Loss = 1.9093e-01, PNorm = 35.8037, GNorm = 5.4502, lr_0 = 1.0000e-04
Validation rmse = 0.121900
Epoch 76
Loss = 1.2522e-01, PNorm = 35.8084, GNorm = 2.0170, lr_0 = 1.0000e-04
Validation rmse = 0.121172
Epoch 77
Loss = 1.1584e-01, PNorm = 35.8126, GNorm = 1.5678, lr_0 = 1.0000e-04
Validation rmse = 0.121649
Epoch 78
Loss = 1.0335e-01, PNorm = 35.8175, GNorm = 2.8114, lr_0 = 1.0000e-04
Validation rmse = 0.122454
Epoch 79
Loss = 1.7076e-01, PNorm = 35.8223, GNorm = 1.1064, lr_0 = 1.0000e-04
Validation rmse = 0.123848
Model 0 best validation rmse = 0.120098 on epoch 51
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.055604
Ensemble test rmse = 0.055604
1-fold cross validation
	Seed 0 ==> test rmse = 0.055604
Overall test rmse = 0.055604 +/- 0.000000
Elapsed time = 0:00:38
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/bin/chemprop_train --data_path ./data/test_train_dm300_reduced_meoh.csv --dataset_type regression --save_dir ./data/train_results/removal --quiet --metric rmse --split_sizes 0.795 0.2 0.005 --smiles_columns full_smiles --target_columns dm300 --epochs 60
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/test_train_dm300_reduced_meoh.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/bin/chemprop_train --data_path ./data/train_dm300_reduced_meoh.csv --dataset_type regression --save_dir ./data/train_results/removal --quiet --metric rmse --split_sizes 0.795 0.2 0.005 --smiles_columns full_smiles --target_columns dm300 --epochs 60
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/train_dm300_reduced_meoh.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,081 | train size = 859 | val size = 216 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.9916e-01, PNorm = 34.0144, GNorm = 6.9784, lr_0 = 3.9118e-04
Validation rmse = 0.317480
Epoch 1
Loss = 7.2271e-01, PNorm = 34.0358, GNorm = 1.6679, lr_0 = 6.8235e-04
Loss = 6.8747e-01, PNorm = 34.0826, GNorm = 6.4557, lr_0 = 9.4706e-04
Validation rmse = 0.236733
Epoch 2
Loss = 5.3354e-01, PNorm = 34.1562, GNorm = 2.9616, lr_0 = 9.7920e-04
Loss = 4.2188e-01, PNorm = 34.2322, GNorm = 3.0483, lr_0 = 9.5660e-04
Validation rmse = 0.240986
Epoch 3
Loss = 4.9360e-01, PNorm = 34.3027, GNorm = 4.3406, lr_0 = 9.3234e-04
Validation rmse = 0.276160
Epoch 4
Loss = 6.2007e-01, PNorm = 34.3644, GNorm = 5.9181, lr_0 = 9.0869e-04
Loss = 3.9965e-01, PNorm = 34.4264, GNorm = 0.8458, lr_0 = 8.8772e-04
Validation rmse = 0.183737
Epoch 5
Loss = 3.4368e-01, PNorm = 34.4868, GNorm = 2.3391, lr_0 = 8.6521e-04
Loss = 2.4271e-01, PNorm = 34.5410, GNorm = 2.4112, lr_0 = 8.4524e-04
Validation rmse = 0.180654
Epoch 6
Loss = 2.3557e-01, PNorm = 34.5799, GNorm = 1.1960, lr_0 = 8.2573e-04
Loss = 2.3772e-01, PNorm = 34.6188, GNorm = 1.3084, lr_0 = 8.0667e-04
Loss = 1.6013e-01, PNorm = 34.6219, GNorm = 1.9040, lr_0 = 8.0478e-04
Validation rmse = 0.156153
Epoch 7
Loss = 1.8271e-01, PNorm = 34.6504, GNorm = 0.5707, lr_0 = 7.8621e-04
Validation rmse = 0.184342
Epoch 8
Loss = 2.0675e-01, PNorm = 34.6934, GNorm = 0.5834, lr_0 = 7.6627e-04
Loss = 2.1625e-01, PNorm = 34.7260, GNorm = 5.1104, lr_0 = 7.4858e-04
Validation rmse = 0.154211
Epoch 9
Loss = 2.3014e-01, PNorm = 34.7555, GNorm = 2.4834, lr_0 = 7.2960e-04
Loss = 1.6030e-01, PNorm = 34.7821, GNorm = 1.5868, lr_0 = 7.1276e-04
Validation rmse = 0.158678
Epoch 10
Loss = 1.6373e-01, PNorm = 34.8097, GNorm = 1.7597, lr_0 = 6.9468e-04
Validation rmse = 0.140074
Epoch 11
Loss = 1.4969e-01, PNorm = 34.8360, GNorm = 1.1949, lr_0 = 6.7706e-04
Loss = 1.4893e-01, PNorm = 34.8578, GNorm = 1.5329, lr_0 = 6.6143e-04
Validation rmse = 0.151553
Epoch 12
Loss = 1.5213e-01, PNorm = 34.8882, GNorm = 2.2379, lr_0 = 6.4617e-04
Loss = 1.6373e-01, PNorm = 34.9133, GNorm = 4.0669, lr_0 = 6.3125e-04
Validation rmse = 0.132383
Epoch 13
Loss = 1.8187e-01, PNorm = 34.9333, GNorm = 4.3404, lr_0 = 6.1524e-04
Loss = 1.6372e-01, PNorm = 34.9506, GNorm = 2.2385, lr_0 = 6.0104e-04
Loss = 8.8673e-02, PNorm = 34.9522, GNorm = 1.3152, lr_0 = 5.9964e-04
Validation rmse = 0.134481
Epoch 14
Loss = 1.4850e-01, PNorm = 34.9665, GNorm = 1.4269, lr_0 = 5.8580e-04
Validation rmse = 0.130952
Epoch 15
Loss = 1.4821e-01, PNorm = 34.9887, GNorm = 1.1557, lr_0 = 5.7094e-04
Loss = 1.5528e-01, PNorm = 35.0032, GNorm = 0.5250, lr_0 = 5.5776e-04
Validation rmse = 0.131517
Epoch 16
Loss = 1.3553e-01, PNorm = 35.0206, GNorm = 1.9729, lr_0 = 5.4362e-04
Loss = 1.3502e-01, PNorm = 35.0343, GNorm = 0.6666, lr_0 = 5.3107e-04
Validation rmse = 0.139733
Epoch 17
Loss = 1.2731e-01, PNorm = 35.0424, GNorm = 1.7279, lr_0 = 5.1881e-04
Validation rmse = 0.140962
Epoch 18
Loss = 1.3506e-01, PNorm = 35.0562, GNorm = 3.3374, lr_0 = 5.0565e-04
Loss = 1.4158e-01, PNorm = 35.0664, GNorm = 0.7799, lr_0 = 4.9398e-04
Validation rmse = 0.133557
Epoch 19
Loss = 1.1071e-01, PNorm = 35.0810, GNorm = 3.5065, lr_0 = 4.8146e-04
Loss = 1.3339e-01, PNorm = 35.0932, GNorm = 0.6493, lr_0 = 4.7034e-04
Validation rmse = 0.141844
Epoch 20
Loss = 1.3353e-01, PNorm = 35.1057, GNorm = 3.8598, lr_0 = 4.5841e-04
Loss = 1.3662e-01, PNorm = 35.1148, GNorm = 1.9166, lr_0 = 4.4783e-04
Loss = 1.9149e-01, PNorm = 35.1159, GNorm = 1.8383, lr_0 = 4.4679e-04
Validation rmse = 0.139911
Epoch 21
Loss = 1.4026e-01, PNorm = 35.1312, GNorm = 1.6011, lr_0 = 4.3648e-04
Validation rmse = 0.131865
Epoch 22
Loss = 1.0279e-01, PNorm = 35.1393, GNorm = 0.9059, lr_0 = 4.2541e-04
Loss = 1.3642e-01, PNorm = 35.1473, GNorm = 0.9924, lr_0 = 4.1559e-04
Validation rmse = 0.132710
Epoch 23
Loss = 1.3667e-01, PNorm = 35.1590, GNorm = 2.4175, lr_0 = 4.0599e-04
Loss = 1.3087e-01, PNorm = 35.1692, GNorm = 1.6000, lr_0 = 3.9662e-04
Validation rmse = 0.139626
Epoch 24
Loss = 1.1982e-01, PNorm = 35.1793, GNorm = 1.5828, lr_0 = 3.8656e-04
Validation rmse = 0.152138
Epoch 25
Loss = 1.6226e-01, PNorm = 35.1895, GNorm = 4.3140, lr_0 = 3.7676e-04
Loss = 1.3179e-01, PNorm = 35.2020, GNorm = 0.6931, lr_0 = 3.6806e-04
Validation rmse = 0.157096
Epoch 26
Loss = 1.1200e-01, PNorm = 35.2128, GNorm = 1.1088, lr_0 = 3.5873e-04
Loss = 1.3286e-01, PNorm = 35.2236, GNorm = 0.7964, lr_0 = 3.5045e-04
Validation rmse = 0.142934
Epoch 27
Loss = 1.2874e-01, PNorm = 35.2328, GNorm = 1.8813, lr_0 = 3.4156e-04
Loss = 1.1786e-01, PNorm = 35.2426, GNorm = 2.1464, lr_0 = 3.3368e-04
Validation rmse = 0.133903
Epoch 28
Loss = 1.1265e-01, PNorm = 35.2532, GNorm = 2.0034, lr_0 = 3.2598e-04
Validation rmse = 0.133352
Epoch 29
Loss = 9.5840e-02, PNorm = 35.2641, GNorm = 1.5204, lr_0 = 3.1771e-04
Loss = 1.0610e-01, PNorm = 35.2722, GNorm = 1.6983, lr_0 = 3.1037e-04
Validation rmse = 0.130720
Epoch 30
Loss = 1.1782e-01, PNorm = 35.2815, GNorm = 0.8599, lr_0 = 3.0250e-04
Loss = 1.1810e-01, PNorm = 35.2870, GNorm = 1.0231, lr_0 = 2.9552e-04
Validation rmse = 0.136009
Epoch 31
Loss = 1.1369e-01, PNorm = 35.2943, GNorm = 3.9552, lr_0 = 2.8803e-04
Validation rmse = 0.143646
Epoch 32
Loss = 2.1696e-01, PNorm = 35.3062, GNorm = 1.2876, lr_0 = 2.8072e-04
Loss = 1.0695e-01, PNorm = 35.3158, GNorm = 0.8393, lr_0 = 2.7424e-04
Validation rmse = 0.130497
Epoch 33
Loss = 1.3990e-01, PNorm = 35.3229, GNorm = 0.8503, lr_0 = 2.6729e-04
Loss = 1.0663e-01, PNorm = 35.3294, GNorm = 0.9350, lr_0 = 2.6112e-04
Validation rmse = 0.132877
Epoch 34
Loss = 1.1309e-01, PNorm = 35.3379, GNorm = 1.7946, lr_0 = 2.5509e-04
Loss = 1.1114e-01, PNorm = 35.3458, GNorm = 0.9516, lr_0 = 2.4920e-04
Validation rmse = 0.133829
Epoch 35
Loss = 1.0372e-01, PNorm = 35.3498, GNorm = 0.9039, lr_0 = 2.4288e-04
Validation rmse = 0.139837
Epoch 36
Loss = 1.4665e-01, PNorm = 35.3552, GNorm = 1.2106, lr_0 = 2.3672e-04
Loss = 1.0712e-01, PNorm = 35.3630, GNorm = 1.2892, lr_0 = 2.3126e-04
Validation rmse = 0.134965
Epoch 37
Loss = 1.3826e-01, PNorm = 35.3701, GNorm = 1.0887, lr_0 = 2.2539e-04
Loss = 1.0584e-01, PNorm = 35.3762, GNorm = 0.9181, lr_0 = 2.2019e-04
Validation rmse = 0.134238
Epoch 38
Loss = 9.9754e-02, PNorm = 35.3821, GNorm = 0.9259, lr_0 = 2.1461e-04
Loss = 1.1047e-01, PNorm = 35.3885, GNorm = 1.2581, lr_0 = 2.0965e-04
Validation rmse = 0.131241
Epoch 39
Loss = 1.3048e-01, PNorm = 35.3941, GNorm = 2.4607, lr_0 = 2.0481e-04
Validation rmse = 0.134004
Epoch 40
Loss = 9.1020e-02, PNorm = 35.4012, GNorm = 2.4137, lr_0 = 1.9962e-04
Loss = 9.7370e-02, PNorm = 35.4060, GNorm = 0.6208, lr_0 = 1.9501e-04
Validation rmse = 0.133264
Epoch 41
Loss = 1.1235e-01, PNorm = 35.4107, GNorm = 0.5699, lr_0 = 1.9007e-04
Loss = 1.0346e-01, PNorm = 35.4151, GNorm = 1.3667, lr_0 = 1.8568e-04
Validation rmse = 0.134140
Epoch 42
Loss = 9.0517e-02, PNorm = 35.4224, GNorm = 1.0779, lr_0 = 1.8097e-04
Validation rmse = 0.133929
Epoch 43
Loss = 1.5346e-01, PNorm = 35.4270, GNorm = 2.2569, lr_0 = 1.7638e-04
Loss = 9.7473e-02, PNorm = 35.4316, GNorm = 1.6703, lr_0 = 1.7231e-04
Validation rmse = 0.131928
Epoch 44
Loss = 9.7492e-02, PNorm = 35.4383, GNorm = 1.0188, lr_0 = 1.6794e-04
Loss = 1.0969e-01, PNorm = 35.4432, GNorm = 0.7119, lr_0 = 1.6406e-04
Validation rmse = 0.143097
Epoch 45
Loss = 1.1066e-01, PNorm = 35.4481, GNorm = 1.1021, lr_0 = 1.6028e-04
Loss = 1.0507e-01, PNorm = 35.4531, GNorm = 3.7357, lr_0 = 1.5658e-04
Loss = 7.6385e-02, PNorm = 35.4536, GNorm = 2.3735, lr_0 = 1.5621e-04
Validation rmse = 0.132076
Epoch 46
Loss = 9.2044e-02, PNorm = 35.4575, GNorm = 1.4404, lr_0 = 1.5261e-04
Validation rmse = 0.138499
Epoch 47
Loss = 1.2077e-01, PNorm = 35.4623, GNorm = 2.4931, lr_0 = 1.4874e-04
Loss = 9.9888e-02, PNorm = 35.4657, GNorm = 2.1777, lr_0 = 1.4530e-04
Validation rmse = 0.130237
Epoch 48
Loss = 1.1091e-01, PNorm = 35.4717, GNorm = 0.8566, lr_0 = 1.4162e-04
Loss = 9.5041e-02, PNorm = 35.4759, GNorm = 0.5319, lr_0 = 1.3835e-04
Validation rmse = 0.134879
Epoch 49
Loss = 1.0206e-01, PNorm = 35.4801, GNorm = 1.8636, lr_0 = 1.3484e-04
Validation rmse = 0.130126
Epoch 50
Loss = 6.2675e-02, PNorm = 35.4845, GNorm = 0.7869, lr_0 = 1.3173e-04
Loss = 1.0143e-01, PNorm = 35.4877, GNorm = 1.4117, lr_0 = 1.2869e-04
Validation rmse = 0.133601
Epoch 51
Loss = 1.2020e-01, PNorm = 35.4919, GNorm = 2.7161, lr_0 = 1.2542e-04
Loss = 1.0233e-01, PNorm = 35.4969, GNorm = 2.7219, lr_0 = 1.2253e-04
Validation rmse = 0.133463
Epoch 52
Loss = 9.1053e-02, PNorm = 35.5004, GNorm = 0.5912, lr_0 = 1.1942e-04
Loss = 1.0537e-01, PNorm = 35.5035, GNorm = 2.3648, lr_0 = 1.1666e-04
Loss = 8.3141e-02, PNorm = 35.5038, GNorm = 1.1644, lr_0 = 1.1639e-04
Validation rmse = 0.130468
Epoch 53
Loss = 1.0413e-01, PNorm = 35.5073, GNorm = 1.7173, lr_0 = 1.1371e-04
Validation rmse = 0.131915
Epoch 54
Loss = 1.0832e-01, PNorm = 35.5099, GNorm = 0.9689, lr_0 = 1.1082e-04
Loss = 9.6291e-02, PNorm = 35.5126, GNorm = 1.1933, lr_0 = 1.0826e-04
Validation rmse = 0.136700
Epoch 55
Loss = 1.0247e-01, PNorm = 35.5161, GNorm = 0.7979, lr_0 = 1.0552e-04
Loss = 1.0295e-01, PNorm = 35.5190, GNorm = 1.7817, lr_0 = 1.0308e-04
Validation rmse = 0.132267
Epoch 56
Loss = 1.1024e-01, PNorm = 35.5221, GNorm = 0.8595, lr_0 = 1.0070e-04
Validation rmse = 0.130922
Epoch 57
Loss = 8.7324e-02, PNorm = 35.5247, GNorm = 1.4633, lr_0 = 1.0000e-04
Loss = 9.1575e-02, PNorm = 35.5276, GNorm = 0.8370, lr_0 = 1.0000e-04
Validation rmse = 0.133918
Epoch 58
Loss = 8.3281e-02, PNorm = 35.5303, GNorm = 0.5935, lr_0 = 1.0000e-04
Loss = 1.0789e-01, PNorm = 35.5339, GNorm = 1.1085, lr_0 = 1.0000e-04
Validation rmse = 0.129042
Epoch 59
Loss = 1.1210e-01, PNorm = 35.5362, GNorm = 1.5721, lr_0 = 1.0000e-04
Loss = 8.7142e-02, PNorm = 35.5396, GNorm = 1.1208, lr_0 = 1.0000e-04
Loss = 6.6483e-02, PNorm = 35.5398, GNorm = 1.7929, lr_0 = 1.0000e-04
Validation rmse = 0.129790
Model 0 best validation rmse = 0.129042 on epoch 58
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.142398
Ensemble test rmse = 0.142398
1-fold cross validation
	Seed 0 ==> test rmse = 0.142398
Overall test rmse = 0.142398 +/- 0.000000
Elapsed time = 0:00:42
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/bin/chemprop_train --data_path ./data/train_dm300_reduced_meoh.csv --dataset_type regression --save_dir ./data/train_results/removal/ --quiet --metric rmse --smiles_columns full_smiles --target_columns dm300 --epochs 60 --extra_metrics r2
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/train_dm300_reduced_meoh.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,081 | train size = 864 | val size = 108 | test size = 109
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.0025e+00, PNorm = 34.0165, GNorm = 1.9060, lr_0 = 3.9118e-04
Validation rmse = 0.282909
Validation r2 = 0.298722
Epoch 1
Loss = 7.5041e-01, PNorm = 34.0408, GNorm = 7.7764, lr_0 = 6.8235e-04
Loss = 6.4612e-01, PNorm = 34.0871, GNorm = 12.1670, lr_0 = 9.4706e-04
Validation rmse = 0.223949
Validation r2 = 0.560565
Epoch 2
Loss = 4.7623e-01, PNorm = 34.1634, GNorm = 0.9150, lr_0 = 9.7920e-04
Loss = 4.5796e-01, PNorm = 34.2322, GNorm = 7.5490, lr_0 = 9.5660e-04
Validation rmse = 0.199466
Validation r2 = 0.651395
Epoch 3
Loss = 4.1485e-01, PNorm = 34.3033, GNorm = 5.8426, lr_0 = 9.3234e-04
Validation rmse = 0.163956
Validation r2 = 0.764467
Epoch 4
Loss = 3.5407e-01, PNorm = 34.3662, GNorm = 1.3724, lr_0 = 9.1082e-04
Loss = 3.2507e-01, PNorm = 34.4198, GNorm = 4.9995, lr_0 = 8.8980e-04
Validation rmse = 0.155461
Validation r2 = 0.788241
Epoch 5
Loss = 2.9312e-01, PNorm = 34.4762, GNorm = 4.1132, lr_0 = 8.6723e-04
Loss = 2.6561e-01, PNorm = 34.5340, GNorm = 6.0176, lr_0 = 8.4721e-04
Validation rmse = 0.167107
Validation r2 = 0.755328
Epoch 6
Loss = 2.3205e-01, PNorm = 34.5790, GNorm = 2.4897, lr_0 = 8.2573e-04
Loss = 2.1892e-01, PNorm = 34.6188, GNorm = 2.9984, lr_0 = 8.0667e-04
Loss = 1.8315e-01, PNorm = 34.6215, GNorm = 1.4915, lr_0 = 8.0478e-04
Validation rmse = 0.170313
Validation r2 = 0.745849
Epoch 7
Loss = 2.5390e-01, PNorm = 34.6504, GNorm = 1.2694, lr_0 = 7.8621e-04
Validation rmse = 0.178127
Validation r2 = 0.721992
Epoch 8
Loss = 1.9346e-01, PNorm = 34.6898, GNorm = 0.9699, lr_0 = 7.6806e-04
Loss = 2.3342e-01, PNorm = 34.7312, GNorm = 6.6997, lr_0 = 7.5033e-04
Validation rmse = 0.141763
Validation r2 = 0.823915
Epoch 9
Loss = 2.0804e-01, PNorm = 34.7579, GNorm = 4.7546, lr_0 = 7.3130e-04
Loss = 2.0886e-01, PNorm = 34.7898, GNorm = 1.6854, lr_0 = 7.1442e-04
Validation rmse = 0.172690
Validation r2 = 0.738706
Epoch 10
Loss = 1.7139e-01, PNorm = 34.8171, GNorm = 4.3461, lr_0 = 6.9630e-04
Loss = 1.9923e-01, PNorm = 34.8485, GNorm = 2.7947, lr_0 = 6.8023e-04
Validation rmse = 0.151339
Validation r2 = 0.799323
Epoch 11
Loss = 1.7092e-01, PNorm = 34.8731, GNorm = 1.8644, lr_0 = 6.6453e-04
Validation rmse = 0.133765
Validation r2 = 0.843223
Epoch 12
Loss = 1.7075e-01, PNorm = 34.9019, GNorm = 0.8045, lr_0 = 6.4768e-04
Loss = 1.5247e-01, PNorm = 34.9228, GNorm = 4.6753, lr_0 = 6.3273e-04
Validation rmse = 0.129243
Validation r2 = 0.853644
Epoch 13
Loss = 1.4953e-01, PNorm = 34.9416, GNorm = 1.4799, lr_0 = 6.1668e-04
Loss = 1.3851e-01, PNorm = 34.9580, GNorm = 1.6067, lr_0 = 6.0245e-04
Validation rmse = 0.145972
Validation r2 = 0.813303
Epoch 14
Loss = 1.3147e-01, PNorm = 34.9707, GNorm = 1.5322, lr_0 = 5.8717e-04
Validation rmse = 0.144085
Validation r2 = 0.818099
Epoch 15
Loss = 1.6719e-01, PNorm = 34.9887, GNorm = 0.9082, lr_0 = 5.7362e-04
Loss = 1.3418e-01, PNorm = 35.0077, GNorm = 1.0854, lr_0 = 5.6037e-04
Validation rmse = 0.135108
Validation r2 = 0.840059
Epoch 16
Loss = 1.2666e-01, PNorm = 35.0271, GNorm = 1.0984, lr_0 = 5.4616e-04
Loss = 1.5098e-01, PNorm = 35.0462, GNorm = 0.8781, lr_0 = 5.3356e-04
Validation rmse = 0.144642
Validation r2 = 0.816689
Epoch 17
Loss = 1.1770e-01, PNorm = 35.0586, GNorm = 1.2122, lr_0 = 5.2003e-04
Loss = 1.5307e-01, PNorm = 35.0725, GNorm = 2.8093, lr_0 = 5.0802e-04
Validation rmse = 0.143140
Validation r2 = 0.820478
Epoch 18
Loss = 1.3896e-01, PNorm = 35.0893, GNorm = 4.7057, lr_0 = 4.9630e-04
Validation rmse = 0.133056
Validation r2 = 0.844881
Epoch 19
Loss = 1.2059e-01, PNorm = 35.1024, GNorm = 3.0091, lr_0 = 4.8371e-04
Loss = 1.2950e-01, PNorm = 35.1145, GNorm = 1.1662, lr_0 = 4.7254e-04
Validation rmse = 0.136082
Validation r2 = 0.837746
Epoch 20
Loss = 1.2449e-01, PNorm = 35.1329, GNorm = 0.8488, lr_0 = 4.6056e-04
Loss = 1.4119e-01, PNorm = 35.1467, GNorm = 2.2987, lr_0 = 4.4993e-04
Validation rmse = 0.140751
Validation r2 = 0.826421
Epoch 21
Loss = 1.3616e-01, PNorm = 35.1625, GNorm = 1.3878, lr_0 = 4.3852e-04
Loss = 1.0283e-01, PNorm = 35.1739, GNorm = 1.5461, lr_0 = 4.2840e-04
Validation rmse = 0.133912
Validation r2 = 0.842878
Epoch 22
Loss = 1.2011e-01, PNorm = 35.1850, GNorm = 1.9353, lr_0 = 4.1851e-04
Validation rmse = 0.159430
Validation r2 = 0.777292
Epoch 23
Loss = 1.4476e-01, PNorm = 35.1991, GNorm = 0.7244, lr_0 = 4.0789e-04
Loss = 1.2883e-01, PNorm = 35.2105, GNorm = 0.8915, lr_0 = 3.9848e-04
Validation rmse = 0.142184
Validation r2 = 0.822869
Epoch 24
Loss = 1.1363e-01, PNorm = 35.2206, GNorm = 1.6926, lr_0 = 3.8837e-04
Loss = 1.2749e-01, PNorm = 35.2311, GNorm = 2.8643, lr_0 = 3.7941e-04
Validation rmse = 0.173219
Validation r2 = 0.737102
Epoch 25
Loss = 1.2795e-01, PNorm = 35.2448, GNorm = 0.9480, lr_0 = 3.7065e-04
Validation rmse = 0.140470
Validation r2 = 0.827112
Epoch 26
Loss = 6.9241e-02, PNorm = 35.2568, GNorm = 1.7039, lr_0 = 3.6125e-04
Loss = 1.2697e-01, PNorm = 35.2691, GNorm = 2.8838, lr_0 = 3.5291e-04
Validation rmse = 0.153957
Validation r2 = 0.792320
Epoch 27
Loss = 1.6121e-01, PNorm = 35.2801, GNorm = 4.7202, lr_0 = 3.4396e-04
Loss = 1.5757e-01, PNorm = 35.2947, GNorm = 3.5363, lr_0 = 3.3602e-04
Validation rmse = 0.136610
Validation r2 = 0.836485
Epoch 28
Loss = 1.0993e-01, PNorm = 35.3071, GNorm = 1.8820, lr_0 = 3.2750e-04
Loss = 1.3235e-01, PNorm = 35.3187, GNorm = 1.2689, lr_0 = 3.1994e-04
Validation rmse = 0.137001
Validation r2 = 0.835546
Epoch 29
Loss = 9.3858e-02, PNorm = 35.3282, GNorm = 0.5692, lr_0 = 3.1256e-04
Validation rmse = 0.133349
Validation r2 = 0.844198
Epoch 30
Loss = 5.9315e-02, PNorm = 35.3374, GNorm = 1.1463, lr_0 = 3.0463e-04
Loss = 1.1668e-01, PNorm = 35.3450, GNorm = 1.4223, lr_0 = 2.9760e-04
Validation rmse = 0.151614
Validation r2 = 0.798593
Epoch 31
Loss = 1.0162e-01, PNorm = 35.3548, GNorm = 1.0594, lr_0 = 2.9005e-04
Loss = 1.0614e-01, PNorm = 35.3632, GNorm = 2.9205, lr_0 = 2.8336e-04
Validation rmse = 0.158369
Validation r2 = 0.780246
Epoch 32
Loss = 1.2602e-01, PNorm = 35.3757, GNorm = 1.8853, lr_0 = 2.7617e-04
Loss = 1.0503e-01, PNorm = 35.3843, GNorm = 2.2351, lr_0 = 2.6980e-04
Validation rmse = 0.130756
Validation r2 = 0.850196
Epoch 33
Loss = 1.1020e-01, PNorm = 35.3915, GNorm = 1.3977, lr_0 = 2.6357e-04
Validation rmse = 0.139824
Validation r2 = 0.828699
Epoch 34
Loss = 1.2432e-01, PNorm = 35.3994, GNorm = 1.1778, lr_0 = 2.5688e-04
Loss = 1.0259e-01, PNorm = 35.4069, GNorm = 0.7319, lr_0 = 2.5095e-04
Validation rmse = 0.136640
Validation r2 = 0.836412
Epoch 35
Loss = 1.1400e-01, PNorm = 35.4137, GNorm = 0.7983, lr_0 = 2.4459e-04
Loss = 9.2457e-02, PNorm = 35.4196, GNorm = 1.0986, lr_0 = 2.3894e-04
Validation rmse = 0.153046
Validation r2 = 0.794769
Epoch 36
Loss = 1.3416e-01, PNorm = 35.4276, GNorm = 3.5826, lr_0 = 2.3343e-04
Validation rmse = 0.131942
Validation r2 = 0.847466
Epoch 37
Loss = 1.5714e-01, PNorm = 35.4354, GNorm = 2.3596, lr_0 = 2.2751e-04
Loss = 1.1785e-01, PNorm = 35.4447, GNorm = 0.9753, lr_0 = 2.2226e-04
Validation rmse = 0.148831
Validation r2 = 0.805919
Epoch 38
Loss = 9.8980e-02, PNorm = 35.4539, GNorm = 2.3354, lr_0 = 2.1662e-04
Loss = 1.1183e-01, PNorm = 35.4583, GNorm = 1.2526, lr_0 = 2.1162e-04
Validation rmse = 0.129834
Validation r2 = 0.852303
Epoch 39
Loss = 1.1245e-01, PNorm = 35.4686, GNorm = 1.5769, lr_0 = 2.0625e-04
Loss = 9.9597e-02, PNorm = 35.4741, GNorm = 1.3889, lr_0 = 2.0149e-04
Validation rmse = 0.131074
Validation r2 = 0.849467
Epoch 40
Loss = 9.5837e-02, PNorm = 35.4789, GNorm = 1.0866, lr_0 = 1.9684e-04
Validation rmse = 0.144839
Validation r2 = 0.816190
Epoch 41
Loss = 9.2109e-02, PNorm = 35.4848, GNorm = 0.8238, lr_0 = 1.9185e-04
Loss = 1.0679e-01, PNorm = 35.4897, GNorm = 1.9765, lr_0 = 1.8742e-04
Validation rmse = 0.136693
Validation r2 = 0.836285
Epoch 42
Loss = 8.1705e-02, PNorm = 35.4952, GNorm = 0.7829, lr_0 = 1.8267e-04
Loss = 1.0313e-01, PNorm = 35.4995, GNorm = 0.5863, lr_0 = 1.7845e-04
Validation rmse = 0.138391
Validation r2 = 0.832192
Epoch 43
Loss = 9.1019e-02, PNorm = 35.5064, GNorm = 0.6781, lr_0 = 1.7433e-04
Loss = 1.0491e-01, PNorm = 35.5127, GNorm = 2.0155, lr_0 = 1.7031e-04
Loss = 2.4462e-01, PNorm = 35.5137, GNorm = 3.8392, lr_0 = 1.6991e-04
Validation rmse = 0.129832
Validation r2 = 0.852307
Epoch 44
Loss = 1.0614e-01, PNorm = 35.5189, GNorm = 1.7656, lr_0 = 1.6599e-04
Validation rmse = 0.137742
Validation r2 = 0.833763
Epoch 45
Loss = 1.0555e-01, PNorm = 35.5254, GNorm = 3.4527, lr_0 = 1.6178e-04
Loss = 1.0599e-01, PNorm = 35.5305, GNorm = 3.4067, lr_0 = 1.5805e-04
Validation rmse = 0.145262
Validation r2 = 0.815116
Epoch 46
Loss = 1.0563e-01, PNorm = 35.5376, GNorm = 3.3637, lr_0 = 1.5404e-04
Loss = 1.0547e-01, PNorm = 35.5424, GNorm = 1.3847, lr_0 = 1.5048e-04
Validation rmse = 0.136016
Validation r2 = 0.837902
Epoch 47
Loss = 1.0535e-01, PNorm = 35.5482, GNorm = 1.3666, lr_0 = 1.4701e-04
Validation rmse = 0.141268
Validation r2 = 0.825143
Epoch 48
Loss = 7.6201e-02, PNorm = 35.5543, GNorm = 0.8973, lr_0 = 1.4328e-04
Loss = 1.1006e-01, PNorm = 35.5587, GNorm = 2.7283, lr_0 = 1.3997e-04
Validation rmse = 0.128715
Validation r2 = 0.854837
Epoch 49
Loss = 9.7440e-02, PNorm = 35.5627, GNorm = 1.1728, lr_0 = 1.3642e-04
Loss = 1.0647e-01, PNorm = 35.5676, GNorm = 1.3285, lr_0 = 1.3327e-04
Validation rmse = 0.138640
Validation r2 = 0.831587
Epoch 50
Loss = 9.5655e-02, PNorm = 35.5707, GNorm = 0.5938, lr_0 = 1.3020e-04
Loss = 9.9731e-02, PNorm = 35.5738, GNorm = 1.1270, lr_0 = 1.2719e-04
Validation rmse = 0.145890
Validation r2 = 0.813514
Epoch 51
Loss = 1.1488e-01, PNorm = 35.5791, GNorm = 1.7371, lr_0 = 1.2397e-04
Validation rmse = 0.137901
Validation r2 = 0.833378
Epoch 52
Loss = 1.3953e-01, PNorm = 35.5832, GNorm = 1.8545, lr_0 = 1.2082e-04
Loss = 8.5016e-02, PNorm = 35.5869, GNorm = 0.6980, lr_0 = 1.1803e-04
Validation rmse = 0.129307
Validation r2 = 0.853500
Epoch 53
Loss = 1.0222e-01, PNorm = 35.5908, GNorm = 0.7599, lr_0 = 1.1504e-04
Loss = 1.0419e-01, PNorm = 35.5961, GNorm = 1.7200, lr_0 = 1.1239e-04
Validation rmse = 0.136404
Validation r2 = 0.836976
Epoch 54
Loss = 1.0202e-01, PNorm = 35.5978, GNorm = 1.5604, lr_0 = 1.0979e-04
Loss = 9.0775e-02, PNorm = 35.6010, GNorm = 0.5564, lr_0 = 1.0726e-04
Loss = 6.1930e-02, PNorm = 35.6010, GNorm = 1.0463, lr_0 = 1.0701e-04
Validation rmse = 0.138180
Validation r2 = 0.832704
Epoch 55
Loss = 8.8854e-02, PNorm = 35.6045, GNorm = 0.9374, lr_0 = 1.0454e-04
Validation rmse = 0.135710
Validation r2 = 0.838631
Epoch 56
Loss = 9.2245e-02, PNorm = 35.6079, GNorm = 1.3771, lr_0 = 1.0189e-04
Loss = 9.4373e-02, PNorm = 35.6114, GNorm = 2.3224, lr_0 = 1.0000e-04
Validation rmse = 0.132628
Validation r2 = 0.845877
Epoch 57
Loss = 9.2514e-02, PNorm = 35.6145, GNorm = 1.0501, lr_0 = 1.0000e-04
Loss = 9.3822e-02, PNorm = 35.6173, GNorm = 0.6889, lr_0 = 1.0000e-04
Validation rmse = 0.137367
Validation r2 = 0.834667
Epoch 58
Loss = 9.3873e-02, PNorm = 35.6211, GNorm = 0.5671, lr_0 = 1.0000e-04
Validation rmse = 0.137408
Validation r2 = 0.834568
Epoch 59
Loss = 8.1547e-02, PNorm = 35.6244, GNorm = 1.0759, lr_0 = 1.0000e-04
Loss = 9.6761e-02, PNorm = 35.6281, GNorm = 1.5603, lr_0 = 1.0000e-04
Validation rmse = 0.132587
Validation r2 = 0.845972
Model 0 best validation rmse = 0.128715 on epoch 48
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.133221
Model 0 test r2 = 0.868221
Ensemble test rmse = 0.133221
Ensemble test r2 = 0.868221
1-fold cross validation
	Seed 0 ==> test rmse = 0.133221
	Seed 0 ==> test r2 = 0.868221
Overall test rmse = 0.133221 +/- 0.000000
Overall test r2 = 0.868221 +/- 0.000000
Elapsed time = 0:00:39
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/bin/chemprop_train --data_path ./data/train_dm300_reduced_meoh_z.csv --dataset_type regression --save_dir ./data/train_results/removal/ --quiet --metric rmse --smiles_columns full_smiles --target_columns z_dm300 --epochs 60 --extra_metrics r2
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/train_dm300_reduced_meoh_z.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['z_dm300'],
 'task_names': ['z_dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,081 | train size = 864 | val size = 108 | test size = 109
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.0025e+00, PNorm = 34.0165, GNorm = 1.9060, lr_0 = 3.9118e-04
Validation rmse = 0.793462
Validation r2 = 0.298722
Epoch 1
Loss = 7.5041e-01, PNorm = 34.0408, GNorm = 7.7764, lr_0 = 6.8235e-04
Loss = 6.4612e-01, PNorm = 34.0871, GNorm = 12.1670, lr_0 = 9.4706e-04
Validation rmse = 0.628099
Validation r2 = 0.560565
Epoch 2
Loss = 4.7619e-01, PNorm = 34.1634, GNorm = 0.9118, lr_0 = 9.7920e-04
Loss = 4.5585e-01, PNorm = 34.2325, GNorm = 7.3958, lr_0 = 9.5660e-04
Validation rmse = 0.557818
Validation r2 = 0.653404
Epoch 3
Loss = 4.1655e-01, PNorm = 34.3045, GNorm = 6.1577, lr_0 = 9.3234e-04
Validation rmse = 0.464012
Validation r2 = 0.760173
Epoch 4
Loss = 3.5179e-01, PNorm = 34.3668, GNorm = 1.0128, lr_0 = 9.1082e-04
Loss = 3.4178e-01, PNorm = 34.4197, GNorm = 6.3873, lr_0 = 8.8980e-04
Validation rmse = 0.449063
Validation r2 = 0.775378
Epoch 5
Loss = 3.2700e-01, PNorm = 34.4741, GNorm = 5.8040, lr_0 = 8.6723e-04
Loss = 2.9222e-01, PNorm = 34.5333, GNorm = 2.6914, lr_0 = 8.4721e-04
Validation rmse = 0.522141
Validation r2 = 0.696321
Epoch 6
Loss = 2.5662e-01, PNorm = 34.5768, GNorm = 1.2523, lr_0 = 8.2573e-04
Loss = 2.4949e-01, PNorm = 34.6151, GNorm = 1.9826, lr_0 = 8.0667e-04
Loss = 1.8236e-01, PNorm = 34.6188, GNorm = 0.9081, lr_0 = 8.0478e-04
Validation rmse = 0.419267
Validation r2 = 0.804197
Epoch 7
Loss = 2.5788e-01, PNorm = 34.6495, GNorm = 2.9084, lr_0 = 7.8621e-04
Validation rmse = 0.431043
Validation r2 = 0.793043
Epoch 8
Loss = 1.7684e-01, PNorm = 34.6898, GNorm = 1.1989, lr_0 = 7.6806e-04
Loss = 2.2559e-01, PNorm = 34.7329, GNorm = 4.5329, lr_0 = 7.5033e-04
Validation rmse = 0.365484
Validation r2 = 0.851209
Epoch 9
Loss = 1.8282e-01, PNorm = 34.7621, GNorm = 3.2944, lr_0 = 7.3130e-04
Loss = 1.9910e-01, PNorm = 34.7910, GNorm = 0.8757, lr_0 = 7.1442e-04
Validation rmse = 0.443698
Validation r2 = 0.780713
Epoch 10
Loss = 1.5638e-01, PNorm = 34.8215, GNorm = 3.7780, lr_0 = 6.9630e-04
Loss = 1.9553e-01, PNorm = 34.8526, GNorm = 3.5239, lr_0 = 6.8023e-04
Validation rmse = 0.431197
Validation r2 = 0.792896
Epoch 11
Loss = 1.7162e-01, PNorm = 34.8796, GNorm = 1.2174, lr_0 = 6.6453e-04
Validation rmse = 0.378306
Validation r2 = 0.840587
Epoch 12
Loss = 1.7065e-01, PNorm = 34.9116, GNorm = 0.8200, lr_0 = 6.4768e-04
Loss = 1.5459e-01, PNorm = 34.9346, GNorm = 4.9638, lr_0 = 6.3273e-04
Validation rmse = 0.363069
Validation r2 = 0.853169
Epoch 13
Loss = 1.5153e-01, PNorm = 34.9570, GNorm = 1.6026, lr_0 = 6.1668e-04
Loss = 1.3855e-01, PNorm = 34.9759, GNorm = 1.6460, lr_0 = 6.0245e-04
Validation rmse = 0.412866
Validation r2 = 0.810130
Epoch 14
Loss = 1.3141e-01, PNorm = 34.9905, GNorm = 1.5763, lr_0 = 5.8717e-04
Validation rmse = 0.404978
Validation r2 = 0.817316
Epoch 15
Loss = 1.6979e-01, PNorm = 35.0105, GNorm = 0.9016, lr_0 = 5.7362e-04
Loss = 1.3327e-01, PNorm = 35.0312, GNorm = 1.1183, lr_0 = 5.6037e-04
Validation rmse = 0.377264
Validation r2 = 0.841464
Epoch 16
Loss = 1.2764e-01, PNorm = 35.0526, GNorm = 1.0954, lr_0 = 5.4616e-04
Loss = 1.5066e-01, PNorm = 35.0722, GNorm = 0.8901, lr_0 = 5.3356e-04
Validation rmse = 0.404549
Validation r2 = 0.817703
Epoch 17
Loss = 1.1926e-01, PNorm = 35.0847, GNorm = 1.0455, lr_0 = 5.2003e-04
Loss = 1.5215e-01, PNorm = 35.0998, GNorm = 2.7141, lr_0 = 5.0802e-04
Validation rmse = 0.390687
Validation r2 = 0.829982
Epoch 18
Loss = 1.3716e-01, PNorm = 35.1172, GNorm = 4.4388, lr_0 = 4.9630e-04
Validation rmse = 0.374664
Validation r2 = 0.843641
Epoch 19
Loss = 1.1752e-01, PNorm = 35.1307, GNorm = 2.7858, lr_0 = 4.8371e-04
Loss = 1.2706e-01, PNorm = 35.1432, GNorm = 1.2126, lr_0 = 4.7254e-04
Validation rmse = 0.378685
Validation r2 = 0.840268
Epoch 20
Loss = 1.2266e-01, PNorm = 35.1626, GNorm = 0.8472, lr_0 = 4.6056e-04
Loss = 1.3957e-01, PNorm = 35.1775, GNorm = 2.1375, lr_0 = 4.4993e-04
Validation rmse = 0.391111
Validation r2 = 0.829612
Epoch 21
Loss = 1.3639e-01, PNorm = 35.1943, GNorm = 1.3417, lr_0 = 4.3852e-04
Loss = 1.0273e-01, PNorm = 35.2062, GNorm = 1.6741, lr_0 = 4.2840e-04
Validation rmse = 0.372570
Validation r2 = 0.845384
Epoch 22
Loss = 1.1992e-01, PNorm = 35.2176, GNorm = 1.9237, lr_0 = 4.1851e-04
Validation rmse = 0.445580
Validation r2 = 0.778849
Epoch 23
Loss = 1.4456e-01, PNorm = 35.2330, GNorm = 0.7009, lr_0 = 4.0789e-04
Loss = 1.2905e-01, PNorm = 35.2460, GNorm = 0.8719, lr_0 = 3.9848e-04
Validation rmse = 0.397445
Validation r2 = 0.824049
Epoch 24
Loss = 1.1237e-01, PNorm = 35.2569, GNorm = 1.7484, lr_0 = 3.8837e-04
Loss = 1.2831e-01, PNorm = 35.2679, GNorm = 2.8714, lr_0 = 3.7941e-04
Validation rmse = 0.485486
Validation r2 = 0.737462
Epoch 25
Loss = 1.2892e-01, PNorm = 35.2819, GNorm = 0.9616, lr_0 = 3.7065e-04
Validation rmse = 0.389534
Validation r2 = 0.830983
Epoch 26
Loss = 7.2474e-02, PNorm = 35.2940, GNorm = 1.6734, lr_0 = 3.6125e-04
Loss = 1.2822e-01, PNorm = 35.3070, GNorm = 2.4957, lr_0 = 3.5291e-04
Validation rmse = 0.418814
Validation r2 = 0.804620
Epoch 27
Loss = 1.6162e-01, PNorm = 35.3194, GNorm = 5.0545, lr_0 = 3.4396e-04
Loss = 1.5780e-01, PNorm = 35.3346, GNorm = 3.5462, lr_0 = 3.3602e-04
Validation rmse = 0.383209
Validation r2 = 0.836428
Epoch 28
Loss = 1.1005e-01, PNorm = 35.3479, GNorm = 2.0165, lr_0 = 3.2750e-04
Loss = 1.3038e-01, PNorm = 35.3600, GNorm = 1.1976, lr_0 = 3.1994e-04
Validation rmse = 0.385379
Validation r2 = 0.834570
Epoch 29
Loss = 9.2837e-02, PNorm = 35.3710, GNorm = 0.6162, lr_0 = 3.1256e-04
Validation rmse = 0.372691
Validation r2 = 0.845284
Epoch 30
Loss = 6.0063e-02, PNorm = 35.3809, GNorm = 1.2671, lr_0 = 3.0463e-04
Loss = 1.1663e-01, PNorm = 35.3892, GNorm = 1.4631, lr_0 = 2.9760e-04
Validation rmse = 0.420905
Validation r2 = 0.802664
Epoch 31
Loss = 1.0217e-01, PNorm = 35.3991, GNorm = 1.0415, lr_0 = 2.9005e-04
Loss = 1.0561e-01, PNorm = 35.4073, GNorm = 2.7809, lr_0 = 2.8336e-04
Validation rmse = 0.439512
Validation r2 = 0.784831
Epoch 32
Loss = 1.2562e-01, PNorm = 35.4196, GNorm = 2.0312, lr_0 = 2.7617e-04
Loss = 1.0414e-01, PNorm = 35.4282, GNorm = 2.2438, lr_0 = 2.6980e-04
Validation rmse = 0.364039
Validation r2 = 0.852384
Epoch 33
Loss = 1.1021e-01, PNorm = 35.4363, GNorm = 1.3267, lr_0 = 2.6357e-04
Validation rmse = 0.389716
Validation r2 = 0.830826
Epoch 34
Loss = 1.2273e-01, PNorm = 35.4444, GNorm = 1.1162, lr_0 = 2.5688e-04
Loss = 1.0235e-01, PNorm = 35.4528, GNorm = 0.7867, lr_0 = 2.5095e-04
Validation rmse = 0.381164
Validation r2 = 0.838169
Epoch 35
Loss = 1.1427e-01, PNorm = 35.4593, GNorm = 0.7755, lr_0 = 2.4459e-04
Loss = 9.2246e-02, PNorm = 35.4654, GNorm = 1.0544, lr_0 = 2.3894e-04
Validation rmse = 0.423557
Validation r2 = 0.800170
Epoch 36
Loss = 1.3389e-01, PNorm = 35.4741, GNorm = 3.5567, lr_0 = 2.3343e-04
Validation rmse = 0.365209
Validation r2 = 0.851434
Epoch 37
Loss = 1.5827e-01, PNorm = 35.4824, GNorm = 2.3493, lr_0 = 2.2751e-04
Loss = 1.1741e-01, PNorm = 35.4928, GNorm = 0.8302, lr_0 = 2.2226e-04
Validation rmse = 0.419781
Validation r2 = 0.803717
Epoch 38
Loss = 9.6288e-02, PNorm = 35.5024, GNorm = 2.0041, lr_0 = 2.1662e-04
Loss = 1.1135e-01, PNorm = 35.5075, GNorm = 1.5603, lr_0 = 2.1162e-04
Validation rmse = 0.360055
Validation r2 = 0.855597
Epoch 39
Loss = 1.1347e-01, PNorm = 35.5178, GNorm = 1.7423, lr_0 = 2.0625e-04
Loss = 9.9756e-02, PNorm = 35.5235, GNorm = 1.2545, lr_0 = 2.0149e-04
Validation rmse = 0.365707
Validation r2 = 0.851028
Epoch 40
Loss = 9.5342e-02, PNorm = 35.5283, GNorm = 1.2631, lr_0 = 1.9684e-04
Validation rmse = 0.403688
Validation r2 = 0.818478
Epoch 41
Loss = 8.9963e-02, PNorm = 35.5344, GNorm = 0.7924, lr_0 = 1.9185e-04
Loss = 1.0740e-01, PNorm = 35.5398, GNorm = 1.9514, lr_0 = 1.8742e-04
Validation rmse = 0.383082
Validation r2 = 0.836536
Epoch 42
Loss = 8.1669e-02, PNorm = 35.5457, GNorm = 0.7890, lr_0 = 1.8267e-04
Loss = 1.0217e-01, PNorm = 35.5504, GNorm = 0.5868, lr_0 = 1.7845e-04
Validation rmse = 0.385889
Validation r2 = 0.834132
Epoch 43
Loss = 9.1484e-02, PNorm = 35.5578, GNorm = 0.7463, lr_0 = 1.7433e-04
Loss = 1.0420e-01, PNorm = 35.5644, GNorm = 1.9854, lr_0 = 1.7031e-04
Loss = 2.3974e-01, PNorm = 35.5655, GNorm = 3.7027, lr_0 = 1.6991e-04
Validation rmse = 0.365023
Validation r2 = 0.851584
Epoch 44
Loss = 1.0318e-01, PNorm = 35.5710, GNorm = 1.4827, lr_0 = 1.6599e-04
Validation rmse = 0.381631
Validation r2 = 0.837772
Epoch 45
Loss = 1.0016e-01, PNorm = 35.5776, GNorm = 2.9652, lr_0 = 1.6178e-04
Loss = 1.0365e-01, PNorm = 35.5832, GNorm = 3.4769, lr_0 = 1.5805e-04
Validation rmse = 0.407536
Validation r2 = 0.815001
Epoch 46
Loss = 1.0480e-01, PNorm = 35.5906, GNorm = 3.2459, lr_0 = 1.5404e-04
Loss = 1.0442e-01, PNorm = 35.5958, GNorm = 1.3795, lr_0 = 1.5048e-04
Validation rmse = 0.379413
Validation r2 = 0.839652
Epoch 47
Loss = 1.0440e-01, PNorm = 35.6017, GNorm = 1.3645, lr_0 = 1.4701e-04
Validation rmse = 0.394979
Validation r2 = 0.826225
Epoch 48
Loss = 7.3687e-02, PNorm = 35.6080, GNorm = 0.8537, lr_0 = 1.4328e-04
Loss = 1.0909e-01, PNorm = 35.6128, GNorm = 2.4843, lr_0 = 1.3997e-04
Validation rmse = 0.359545
Validation r2 = 0.856006
Epoch 49
Loss = 9.7221e-02, PNorm = 35.6173, GNorm = 1.0207, lr_0 = 1.3642e-04
Loss = 1.0593e-01, PNorm = 35.6227, GNorm = 1.2153, lr_0 = 1.3327e-04
Validation rmse = 0.387404
Validation r2 = 0.832827
Epoch 50
Loss = 9.5008e-02, PNorm = 35.6261, GNorm = 0.5847, lr_0 = 1.3020e-04
Loss = 9.9909e-02, PNorm = 35.6295, GNorm = 1.1695, lr_0 = 1.2719e-04
Validation rmse = 0.409767
Validation r2 = 0.812970
Epoch 51
Loss = 1.1421e-01, PNorm = 35.6355, GNorm = 1.7466, lr_0 = 1.2397e-04
Validation rmse = 0.387428
Validation r2 = 0.832806
Epoch 52
Loss = 1.3970e-01, PNorm = 35.6396, GNorm = 1.8238, lr_0 = 1.2082e-04
Loss = 8.4315e-02, PNorm = 35.6437, GNorm = 0.6571, lr_0 = 1.1803e-04
Validation rmse = 0.361495
Validation r2 = 0.854440
Epoch 53
Loss = 1.0117e-01, PNorm = 35.6480, GNorm = 0.7743, lr_0 = 1.1504e-04
Loss = 1.0366e-01, PNorm = 35.6536, GNorm = 1.7920, lr_0 = 1.1239e-04
Validation rmse = 0.381350
Validation r2 = 0.838011
Epoch 54
Loss = 1.0193e-01, PNorm = 35.6556, GNorm = 1.5992, lr_0 = 1.0979e-04
Loss = 9.0405e-02, PNorm = 35.6591, GNorm = 0.5637, lr_0 = 1.0726e-04
Loss = 6.3416e-02, PNorm = 35.6591, GNorm = 0.9792, lr_0 = 1.0701e-04
Validation rmse = 0.385678
Validation r2 = 0.834313
Epoch 55
Loss = 8.8097e-02, PNorm = 35.6629, GNorm = 0.9592, lr_0 = 1.0454e-04
Validation rmse = 0.380312
Validation r2 = 0.838892
Epoch 56
Loss = 9.1100e-02, PNorm = 35.6664, GNorm = 1.2189, lr_0 = 1.0189e-04
Loss = 9.4043e-02, PNorm = 35.6700, GNorm = 2.2378, lr_0 = 1.0000e-04
Validation rmse = 0.372010
Validation r2 = 0.845849
Epoch 57
Loss = 9.2077e-02, PNorm = 35.6735, GNorm = 1.0655, lr_0 = 1.0000e-04
Loss = 9.2698e-02, PNorm = 35.6767, GNorm = 0.6560, lr_0 = 1.0000e-04
Validation rmse = 0.382250
Validation r2 = 0.837245
Epoch 58
Loss = 9.3199e-02, PNorm = 35.6808, GNorm = 0.5971, lr_0 = 1.0000e-04
Validation rmse = 0.385635
Validation r2 = 0.834350
Epoch 59
Loss = 8.1780e-02, PNorm = 35.6844, GNorm = 1.1237, lr_0 = 1.0000e-04
Loss = 9.6578e-02, PNorm = 35.6883, GNorm = 1.4958, lr_0 = 1.0000e-04
Validation rmse = 0.370673
Validation r2 = 0.846955
Model 0 best validation rmse = 0.359545 on epoch 48
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.373741
Model 0 test r2 = 0.868149
Ensemble test rmse = 0.373741
Ensemble test r2 = 0.868149
1-fold cross validation
	Seed 0 ==> test rmse = 0.373741
	Seed 0 ==> test r2 = 0.868149
Overall test rmse = 0.373741 +/- 0.000000
Overall test r2 = 0.868149 +/- 0.000000
Elapsed time = 0:00:37
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/bin/chemprop_train --data_path ./data/train_dm300_reduced_meoh.csv --dataset_type regression --save_dir ./data/train_results/removal/ --quiet --metric rmse --smiles_columns full_smiles --target_columns dm300 --epochs 60 --extra_metrics r2
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/train_dm300_reduced_meoh.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,081 | train size = 864 | val size = 108 | test size = 109
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.0025e+00, PNorm = 34.0165, GNorm = 1.9060, lr_0 = 3.9118e-04
Validation rmse = 0.282909
Validation r2 = 0.298722
Epoch 1
Loss = 7.5041e-01, PNorm = 34.0408, GNorm = 7.7764, lr_0 = 6.8235e-04
Loss = 6.4612e-01, PNorm = 34.0871, GNorm = 12.1670, lr_0 = 9.4706e-04
Validation rmse = 0.223949
Validation r2 = 0.560565
Epoch 2
Loss = 4.7623e-01, PNorm = 34.1634, GNorm = 0.9150, lr_0 = 9.7920e-04
Loss = 4.5796e-01, PNorm = 34.2322, GNorm = 7.5490, lr_0 = 9.5660e-04
Validation rmse = 0.199466
Validation r2 = 0.651395
Epoch 3
Loss = 4.1485e-01, PNorm = 34.3033, GNorm = 5.8427, lr_0 = 9.3234e-04
Validation rmse = 0.163954
Validation r2 = 0.764472
Epoch 4
Loss = 3.5407e-01, PNorm = 34.3662, GNorm = 1.3710, lr_0 = 9.1082e-04
Loss = 3.2509e-01, PNorm = 34.4199, GNorm = 5.0119, lr_0 = 8.8980e-04
Validation rmse = 0.155457
Validation r2 = 0.788254
Epoch 5
Loss = 2.9302e-01, PNorm = 34.4762, GNorm = 4.1223, lr_0 = 8.6723e-04
Loss = 2.6540e-01, PNorm = 34.5342, GNorm = 6.0018, lr_0 = 8.4721e-04
Validation rmse = 0.166073
Validation r2 = 0.758347
Epoch 6
Loss = 2.3181e-01, PNorm = 34.5793, GNorm = 2.4326, lr_0 = 8.2573e-04
Loss = 2.2003e-01, PNorm = 34.6185, GNorm = 2.8319, lr_0 = 8.0667e-04
Loss = 1.8287e-01, PNorm = 34.6212, GNorm = 1.5123, lr_0 = 8.0478e-04
Validation rmse = 0.171880
Validation r2 = 0.741152
Epoch 7
Loss = 2.5664e-01, PNorm = 34.6493, GNorm = 1.1001, lr_0 = 7.8621e-04
Validation rmse = 0.181250
Validation r2 = 0.712161
Epoch 8
Loss = 1.9587e-01, PNorm = 34.6891, GNorm = 1.2340, lr_0 = 7.6806e-04
Loss = 2.3480e-01, PNorm = 34.7318, GNorm = 6.7171, lr_0 = 7.5033e-04
Validation rmse = 0.140198
Validation r2 = 0.827781
Epoch 9
Loss = 2.0784e-01, PNorm = 34.7575, GNorm = 4.9010, lr_0 = 7.3130e-04
Loss = 2.0897e-01, PNorm = 34.7879, GNorm = 1.1820, lr_0 = 7.1442e-04
Validation rmse = 0.169463
Validation r2 = 0.748380
Epoch 10
Loss = 1.6988e-01, PNorm = 34.8156, GNorm = 3.9387, lr_0 = 6.9630e-04
Loss = 1.9744e-01, PNorm = 34.8466, GNorm = 2.7545, lr_0 = 6.8023e-04
Validation rmse = 0.152133
Validation r2 = 0.797212
Epoch 11
Loss = 1.6948e-01, PNorm = 34.8706, GNorm = 1.7552, lr_0 = 6.6453e-04
Validation rmse = 0.134601
Validation r2 = 0.841258
Epoch 12
Loss = 1.7009e-01, PNorm = 34.8982, GNorm = 0.7989, lr_0 = 6.4768e-04
Loss = 1.5229e-01, PNorm = 34.9196, GNorm = 4.6830, lr_0 = 6.3273e-04
Validation rmse = 0.130437
Validation r2 = 0.850927
Epoch 13
Loss = 1.4936e-01, PNorm = 34.9392, GNorm = 1.4055, lr_0 = 6.1668e-04
Loss = 1.3806e-01, PNorm = 34.9565, GNorm = 1.4229, lr_0 = 6.0245e-04
Validation rmse = 0.146387
Validation r2 = 0.812241
Epoch 14
Loss = 1.3056e-01, PNorm = 34.9705, GNorm = 1.5780, lr_0 = 5.8717e-04
Validation rmse = 0.140660
Validation r2 = 0.826645
Epoch 15
Loss = 1.7087e-01, PNorm = 34.9889, GNorm = 1.2716, lr_0 = 5.7362e-04
Loss = 1.3430e-01, PNorm = 35.0073, GNorm = 1.1464, lr_0 = 5.6037e-04
Validation rmse = 0.134444
Validation r2 = 0.841627
Epoch 16
Loss = 1.2572e-01, PNorm = 35.0269, GNorm = 0.9116, lr_0 = 5.4616e-04
Loss = 1.5008e-01, PNorm = 35.0448, GNorm = 0.8820, lr_0 = 5.3356e-04
Validation rmse = 0.144556
Validation r2 = 0.816908
Epoch 17
Loss = 1.1620e-01, PNorm = 35.0568, GNorm = 1.2946, lr_0 = 5.2003e-04
Loss = 1.5161e-01, PNorm = 35.0701, GNorm = 2.6325, lr_0 = 5.0802e-04
Validation rmse = 0.143680
Validation r2 = 0.819120
Epoch 18
Loss = 1.3909e-01, PNorm = 35.0862, GNorm = 4.9022, lr_0 = 4.9630e-04
Validation rmse = 0.133655
Validation r2 = 0.843481
Epoch 19
Loss = 1.2289e-01, PNorm = 35.0984, GNorm = 3.2255, lr_0 = 4.8371e-04
Loss = 1.2989e-01, PNorm = 35.1106, GNorm = 1.0759, lr_0 = 4.7254e-04
Validation rmse = 0.136040
Validation r2 = 0.837844
Epoch 20
Loss = 1.2571e-01, PNorm = 35.1293, GNorm = 0.8776, lr_0 = 4.6056e-04
Loss = 1.4166e-01, PNorm = 35.1432, GNorm = 2.3507, lr_0 = 4.4993e-04
Validation rmse = 0.140960
Validation r2 = 0.825904
Epoch 21
Loss = 1.3588e-01, PNorm = 35.1589, GNorm = 1.2665, lr_0 = 4.3852e-04
Loss = 1.0279e-01, PNorm = 35.1700, GNorm = 1.6642, lr_0 = 4.2840e-04
Validation rmse = 0.133264
Validation r2 = 0.844397
Epoch 22
Loss = 1.1891e-01, PNorm = 35.1801, GNorm = 1.8122, lr_0 = 4.1851e-04
Validation rmse = 0.158657
Validation r2 = 0.779447
Epoch 23
Loss = 1.4335e-01, PNorm = 35.1940, GNorm = 0.7354, lr_0 = 4.0789e-04
Loss = 1.2868e-01, PNorm = 35.2049, GNorm = 0.8744, lr_0 = 3.9848e-04
Validation rmse = 0.141301
Validation r2 = 0.825062
Epoch 24
Loss = 1.1459e-01, PNorm = 35.2144, GNorm = 1.4150, lr_0 = 3.8837e-04
Loss = 1.2577e-01, PNorm = 35.2240, GNorm = 2.6215, lr_0 = 3.7941e-04
Validation rmse = 0.171185
Validation r2 = 0.743241
Epoch 25
Loss = 1.2567e-01, PNorm = 35.2368, GNorm = 1.0039, lr_0 = 3.7065e-04
Validation rmse = 0.142546
Validation r2 = 0.821964
Epoch 26
Loss = 7.1710e-02, PNorm = 35.2479, GNorm = 1.9089, lr_0 = 3.6125e-04
Loss = 1.2569e-01, PNorm = 35.2604, GNorm = 3.0672, lr_0 = 3.5291e-04
Validation rmse = 0.157974
Validation r2 = 0.781342
Epoch 27
Loss = 1.6134e-01, PNorm = 35.2710, GNorm = 4.3447, lr_0 = 3.4396e-04
Loss = 1.5772e-01, PNorm = 35.2849, GNorm = 3.3142, lr_0 = 3.3602e-04
Validation rmse = 0.136980
Validation r2 = 0.835598
Epoch 28
Loss = 1.1088e-01, PNorm = 35.2960, GNorm = 1.5031, lr_0 = 3.2750e-04
Loss = 1.3575e-01, PNorm = 35.3066, GNorm = 1.3412, lr_0 = 3.1994e-04
Validation rmse = 0.135690
Validation r2 = 0.838678
Epoch 29
Loss = 9.4011e-02, PNorm = 35.3159, GNorm = 0.5627, lr_0 = 3.1256e-04
Validation rmse = 0.133171
Validation r2 = 0.844612
Epoch 30
Loss = 6.0156e-02, PNorm = 35.3244, GNorm = 1.1258, lr_0 = 3.0463e-04
Loss = 1.1677e-01, PNorm = 35.3315, GNorm = 1.3479, lr_0 = 2.9760e-04
Validation rmse = 0.151763
Validation r2 = 0.798197
Epoch 31
Loss = 1.0320e-01, PNorm = 35.3403, GNorm = 1.1485, lr_0 = 2.9005e-04
Loss = 1.0636e-01, PNorm = 35.3475, GNorm = 2.9855, lr_0 = 2.8336e-04
Validation rmse = 0.158020
Validation r2 = 0.781213
Epoch 32
Loss = 1.2669e-01, PNorm = 35.3589, GNorm = 2.0008, lr_0 = 2.7617e-04
Loss = 1.0456e-01, PNorm = 35.3667, GNorm = 2.3333, lr_0 = 2.6980e-04
Validation rmse = 0.130928
Validation r2 = 0.849802
Epoch 33
Loss = 1.0999e-01, PNorm = 35.3736, GNorm = 1.3389, lr_0 = 2.6357e-04
Validation rmse = 0.139248
Validation r2 = 0.830108
Epoch 34
Loss = 1.2288e-01, PNorm = 35.3809, GNorm = 1.1415, lr_0 = 2.5688e-04
Loss = 1.0260e-01, PNorm = 35.3876, GNorm = 0.7401, lr_0 = 2.5095e-04
Validation rmse = 0.136054
Validation r2 = 0.837812
Epoch 35
Loss = 1.1418e-01, PNorm = 35.3933, GNorm = 0.7633, lr_0 = 2.4459e-04
Loss = 9.2097e-02, PNorm = 35.3982, GNorm = 1.1517, lr_0 = 2.3894e-04
Validation rmse = 0.152020
Validation r2 = 0.797513
Epoch 36
Loss = 1.3323e-01, PNorm = 35.4053, GNorm = 3.5898, lr_0 = 2.3343e-04
Validation rmse = 0.131570
Validation r2 = 0.848327
Epoch 37
Loss = 1.5632e-01, PNorm = 35.4125, GNorm = 2.3272, lr_0 = 2.2751e-04
Loss = 1.1808e-01, PNorm = 35.4213, GNorm = 0.9714, lr_0 = 2.2226e-04
Validation rmse = 0.148357
Validation r2 = 0.807152
Epoch 38
Loss = 9.7397e-02, PNorm = 35.4302, GNorm = 2.3774, lr_0 = 2.1662e-04
Loss = 1.1160e-01, PNorm = 35.4344, GNorm = 1.1746, lr_0 = 2.1162e-04
Validation rmse = 0.129714
Validation r2 = 0.852574
Epoch 39
Loss = 1.1176e-01, PNorm = 35.4442, GNorm = 1.6552, lr_0 = 2.0625e-04
Loss = 9.9482e-02, PNorm = 35.4492, GNorm = 1.2020, lr_0 = 2.0149e-04
Validation rmse = 0.130979
Validation r2 = 0.849687
Epoch 40
Loss = 9.5898e-02, PNorm = 35.4534, GNorm = 1.2097, lr_0 = 1.9684e-04
Validation rmse = 0.144354
Validation r2 = 0.817420
Epoch 41
Loss = 9.1136e-02, PNorm = 35.4591, GNorm = 0.8080, lr_0 = 1.9185e-04
Loss = 1.0712e-01, PNorm = 35.4637, GNorm = 1.9428, lr_0 = 1.8742e-04
Validation rmse = 0.137074
Validation r2 = 0.835370
Epoch 42
Loss = 8.1473e-02, PNorm = 35.4688, GNorm = 0.7902, lr_0 = 1.8267e-04
Loss = 1.0357e-01, PNorm = 35.4730, GNorm = 0.5951, lr_0 = 1.7845e-04
Validation rmse = 0.138360
Validation r2 = 0.832266
Epoch 43
Loss = 9.1224e-02, PNorm = 35.4798, GNorm = 0.6787, lr_0 = 1.7433e-04
Loss = 1.0467e-01, PNorm = 35.4856, GNorm = 1.9663, lr_0 = 1.7031e-04
Loss = 2.4822e-01, PNorm = 35.4865, GNorm = 3.7719, lr_0 = 1.6991e-04
Validation rmse = 0.129908
Validation r2 = 0.852134
Epoch 44
Loss = 1.0506e-01, PNorm = 35.4912, GNorm = 1.6586, lr_0 = 1.6599e-04
Validation rmse = 0.138641
Validation r2 = 0.831585
Epoch 45
Loss = 1.0511e-01, PNorm = 35.4970, GNorm = 3.3946, lr_0 = 1.6178e-04
Loss = 1.0526e-01, PNorm = 35.5015, GNorm = 3.2670, lr_0 = 1.5805e-04
Validation rmse = 0.144066
Validation r2 = 0.818149
Epoch 46
Loss = 1.0574e-01, PNorm = 35.5081, GNorm = 3.4047, lr_0 = 1.5404e-04
Loss = 1.0543e-01, PNorm = 35.5126, GNorm = 1.6455, lr_0 = 1.5048e-04
Validation rmse = 0.135793
Validation r2 = 0.838434
Epoch 47
Loss = 1.0617e-01, PNorm = 35.5180, GNorm = 1.3665, lr_0 = 1.4701e-04
Validation rmse = 0.141449
Validation r2 = 0.824694
Epoch 48
Loss = 7.6234e-02, PNorm = 35.5236, GNorm = 0.9529, lr_0 = 1.4328e-04
Loss = 1.1032e-01, PNorm = 35.5275, GNorm = 2.6889, lr_0 = 1.3997e-04
Validation rmse = 0.128569
Validation r2 = 0.855166
Epoch 49
Loss = 9.8086e-02, PNorm = 35.5313, GNorm = 1.0738, lr_0 = 1.3642e-04
Loss = 1.0680e-01, PNorm = 35.5362, GNorm = 1.3195, lr_0 = 1.3327e-04
Validation rmse = 0.138556
Validation r2 = 0.831793
Epoch 50
Loss = 9.5795e-02, PNorm = 35.5390, GNorm = 0.5696, lr_0 = 1.3020e-04
Loss = 1.0001e-01, PNorm = 35.5420, GNorm = 1.1810, lr_0 = 1.2719e-04
Validation rmse = 0.146338
Validation r2 = 0.812367
Epoch 51
Loss = 1.1515e-01, PNorm = 35.5470, GNorm = 1.7383, lr_0 = 1.2397e-04
Validation rmse = 0.138226
Validation r2 = 0.832592
Epoch 52
Loss = 1.3929e-01, PNorm = 35.5507, GNorm = 1.7213, lr_0 = 1.2082e-04
Loss = 8.5525e-02, PNorm = 35.5540, GNorm = 0.6306, lr_0 = 1.1803e-04
Validation rmse = 0.129360
Validation r2 = 0.853380
Epoch 53
Loss = 1.0191e-01, PNorm = 35.5576, GNorm = 0.7776, lr_0 = 1.1504e-04
Loss = 1.0454e-01, PNorm = 35.5626, GNorm = 1.7440, lr_0 = 1.1239e-04
Validation rmse = 0.136819
Validation r2 = 0.835984
Epoch 54
Loss = 1.0209e-01, PNorm = 35.5641, GNorm = 1.4938, lr_0 = 1.0979e-04
Loss = 9.1280e-02, PNorm = 35.5672, GNorm = 0.5767, lr_0 = 1.0726e-04
Loss = 6.2932e-02, PNorm = 35.5672, GNorm = 1.0114, lr_0 = 1.0701e-04
Validation rmse = 0.138736
Validation r2 = 0.831354
Epoch 55
Loss = 8.9168e-02, PNorm = 35.5704, GNorm = 0.8856, lr_0 = 1.0454e-04
Validation rmse = 0.135652
Validation r2 = 0.838768
Epoch 56
Loss = 9.2363e-02, PNorm = 35.5734, GNorm = 1.3883, lr_0 = 1.0189e-04
Loss = 9.4684e-02, PNorm = 35.5767, GNorm = 2.3072, lr_0 = 1.0000e-04
Validation rmse = 0.132800
Validation r2 = 0.845476
Epoch 57
Loss = 9.2666e-02, PNorm = 35.5794, GNorm = 1.0327, lr_0 = 1.0000e-04
Loss = 9.4195e-02, PNorm = 35.5819, GNorm = 0.6186, lr_0 = 1.0000e-04
Validation rmse = 0.137196
Validation r2 = 0.835077
Epoch 58
Loss = 9.4177e-02, PNorm = 35.5854, GNorm = 0.5489, lr_0 = 1.0000e-04
Validation rmse = 0.137939
Validation r2 = 0.833285
Epoch 59
Loss = 8.2812e-02, PNorm = 35.5885, GNorm = 1.0452, lr_0 = 1.0000e-04
Loss = 9.7204e-02, PNorm = 35.5919, GNorm = 1.6170, lr_0 = 1.0000e-04
Validation rmse = 0.133074
Validation r2 = 0.844839
Model 0 best validation rmse = 0.128569 on epoch 48
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.134078
Model 0 test r2 = 0.866519
Ensemble test rmse = 0.134078
Ensemble test r2 = 0.866519
1-fold cross validation
	Seed 0 ==> test rmse = 0.134078
	Seed 0 ==> test r2 = 0.866519
Overall test rmse = 0.134078 +/- 0.000000
Overall test r2 = 0.866519 +/- 0.000000
Elapsed time = 0:00:38
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-af88558e-fd54-4032-8f82-74be2f326bc6.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/_train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,120 | train size = 890 | val size = 224 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.7358e-01, PNorm = 34.0157, GNorm = 9.2237, lr_0 = 3.9118e-04
Validation rmse = 0.280660
Epoch 1
Loss = 6.6180e-01, PNorm = 34.0409, GNorm = 2.4649, lr_0 = 6.8235e-04
Loss = 6.7082e-01, PNorm = 34.0860, GNorm = 6.1692, lr_0 = 9.4706e-04
Validation rmse = 0.250069
Epoch 2
Loss = 5.4151e-01, PNorm = 34.1265, GNorm = 1.0382, lr_0 = 3.3839e-04
Loss = 5.6146e-01, PNorm = 34.1382, GNorm = 6.9395, lr_0 = 1.0000e-04
Validation rmse = 0.233144
Model 0 best validation rmse = 0.233144 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.253343
Ensemble test rmse = 0.253343
1-fold cross validation
	Seed 0 ==> test rmse = 0.253343
Overall test rmse = 0.253343 +/- 0.000000
Elapsed time = 0:00:03
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-af88558e-fd54-4032-8f82-74be2f326bc6.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/_train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,110 | train size = 882 | val size = 222 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.8806e-01, PNorm = 34.0130, GNorm = 6.3456, lr_0 = 3.9118e-04
Validation rmse = 0.302776
Epoch 1
Loss = 8.5303e-01, PNorm = 34.0314, GNorm = 1.7428, lr_0 = 6.8235e-04
Loss = 7.7435e-01, PNorm = 34.0760, GNorm = 6.8068, lr_0 = 9.4706e-04
Validation rmse = 0.266426
Epoch 2
Loss = 5.5242e-01, PNorm = 34.1194, GNorm = 7.4010, lr_0 = 3.3839e-04
Loss = 5.4614e-01, PNorm = 34.1288, GNorm = 2.7691, lr_0 = 1.0000e-04
Validation rmse = 0.237763
Model 0 best validation rmse = 0.237763 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.213104
Ensemble test rmse = 0.213104
1-fold cross validation
	Seed 0 ==> test rmse = 0.213104
Overall test rmse = 0.213104 +/- 0.000000
Elapsed time = 0:00:03
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,100 | train size = 874 | val size = 220 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.7050e-01, PNorm = 34.0150, GNorm = 6.4939, lr_0 = 3.9118e-04
Validation rmse = 0.320249
Epoch 1
Loss = 8.3051e-01, PNorm = 34.0333, GNorm = 3.1762, lr_0 = 6.8235e-04
Loss = 7.4981e-01, PNorm = 34.0680, GNorm = 3.2264, lr_0 = 9.4706e-04
Validation rmse = 0.257294
Epoch 2
Loss = 6.2996e-01, PNorm = 34.1198, GNorm = 1.0107, lr_0 = 2.9552e-04
Loss = 5.0715e-01, PNorm = 34.1336, GNorm = 2.5374, lr_0 = 1.0000e-04
Validation rmse = 0.236068
Model 0 best validation rmse = 0.236068 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.275837
Ensemble test rmse = 0.275837
1-fold cross validation
	Seed 0 ==> test rmse = 0.275837
Overall test rmse = 0.275837 +/- 0.000000
Elapsed time = 0:00:18
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,090 | train size = 866 | val size = 218 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 1.0085e+00, PNorm = 34.0140, GNorm = 5.8849, lr_0 = 3.9118e-04
Validation rmse = 0.295955
Epoch 1
Loss = 8.9379e-01, PNorm = 34.0317, GNorm = 3.5235, lr_0 = 6.8235e-04
Loss = 7.4978e-01, PNorm = 34.0758, GNorm = 7.0463, lr_0 = 9.4706e-04
Validation rmse = 0.243348
Epoch 2
Loss = 5.1262e-01, PNorm = 34.1181, GNorm = 1.4529, lr_0 = 2.9552e-04
Loss = 5.3575e-01, PNorm = 34.1310, GNorm = 2.0406, lr_0 = 1.0000e-04
Validation rmse = 0.233708
Model 0 best validation rmse = 0.233708 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.270370
Ensemble test rmse = 0.270370
1-fold cross validation
	Seed 0 ==> test rmse = 0.270370
Overall test rmse = 0.270370 +/- 0.000000
Elapsed time = 0:00:02
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,167 | train size = 927 | val size = 234 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.9265e-01, PNorm = 34.0157, GNorm = 3.5732, lr_0 = 3.7500e-04
Validation rmse = 0.284287
Epoch 1
Loss = 6.9237e-01, PNorm = 34.0439, GNorm = 6.4419, lr_0 = 6.5000e-04
Loss = 7.6370e-01, PNorm = 34.0834, GNorm = 3.2127, lr_0 = 9.0000e-04
Validation rmse = 0.276076
Epoch 2
Loss = 6.7314e-01, PNorm = 34.1345, GNorm = 9.5480, lr_0 = 9.8685e-04
Loss = 6.1951e-01, PNorm = 34.1978, GNorm = 5.0209, lr_0 = 9.6533e-04
Validation rmse = 0.269459
Epoch 3
Loss = 5.1259e-01, PNorm = 34.2688, GNorm = 3.1730, lr_0 = 9.4219e-04
Loss = 4.2713e-01, PNorm = 34.3315, GNorm = 0.9495, lr_0 = 9.2164e-04
Validation rmse = 0.220252
Epoch 4
Loss = 4.3168e-01, PNorm = 34.3854, GNorm = 1.1895, lr_0 = 9.0153e-04
Loss = 3.3432e-01, PNorm = 34.4440, GNorm = 1.4405, lr_0 = 8.8187e-04
Validation rmse = 0.202246
Epoch 5
Loss = 3.1771e-01, PNorm = 34.5043, GNorm = 3.7437, lr_0 = 8.6073e-04
Loss = 2.7348e-01, PNorm = 34.5597, GNorm = 1.2422, lr_0 = 8.4195e-04
Validation rmse = 0.192759
Epoch 6
Loss = 3.0171e-01, PNorm = 34.5974, GNorm = 3.1940, lr_0 = 8.2359e-04
Validation rmse = 0.203950
Epoch 7
Loss = 2.3114e-01, PNorm = 34.6402, GNorm = 3.1854, lr_0 = 8.0385e-04
Loss = 2.9869e-01, PNorm = 34.6764, GNorm = 3.1500, lr_0 = 7.8631e-04
Validation rmse = 0.182153
Epoch 8
Loss = 2.3745e-01, PNorm = 34.7076, GNorm = 3.3473, lr_0 = 7.6916e-04
Loss = 2.3528e-01, PNorm = 34.7387, GNorm = 2.5176, lr_0 = 7.5238e-04
Validation rmse = 0.192723
Epoch 9
Loss = 2.9674e-01, PNorm = 34.7730, GNorm = 2.9750, lr_0 = 7.3435e-04
Loss = 2.0076e-01, PNorm = 34.8018, GNorm = 1.6889, lr_0 = 7.1833e-04
Validation rmse = 0.180295
Epoch 10
Loss = 2.4705e-01, PNorm = 34.8207, GNorm = 6.4111, lr_0 = 7.0266e-04
Loss = 1.9375e-01, PNorm = 34.8405, GNorm = 1.7200, lr_0 = 6.8733e-04
Validation rmse = 0.183608
Epoch 11
Loss = 2.0415e-01, PNorm = 34.8686, GNorm = 2.9754, lr_0 = 6.7085e-04
Loss = 2.1697e-01, PNorm = 34.8848, GNorm = 4.1613, lr_0 = 6.5622e-04
Validation rmse = 0.188509
Epoch 12
Loss = 2.2012e-01, PNorm = 34.8972, GNorm = 3.5552, lr_0 = 6.4191e-04
Loss = 2.2965e-01, PNorm = 34.9173, GNorm = 5.7362, lr_0 = 6.2790e-04
Validation rmse = 0.204483
Epoch 13
Loss = 2.8796e-01, PNorm = 34.9405, GNorm = 5.3188, lr_0 = 6.1421e-04
Validation rmse = 0.179039
Epoch 14
Loss = 1.4279e-01, PNorm = 34.9594, GNorm = 1.0837, lr_0 = 5.9948e-04
Loss = 2.2034e-01, PNorm = 34.9758, GNorm = 2.3080, lr_0 = 5.8641e-04
Validation rmse = 0.180362
Epoch 15
Loss = 2.2067e-01, PNorm = 34.9939, GNorm = 1.2055, lr_0 = 5.7362e-04
Loss = 1.8122e-01, PNorm = 35.0144, GNorm = 0.8529, lr_0 = 5.6110e-04
Validation rmse = 0.177991
Epoch 16
Loss = 2.1465e-01, PNorm = 35.0306, GNorm = 4.5794, lr_0 = 5.4765e-04
Loss = 1.9484e-01, PNorm = 35.0460, GNorm = 2.5516, lr_0 = 5.3571e-04
Validation rmse = 0.171141
Epoch 17
Loss = 1.8998e-01, PNorm = 35.0620, GNorm = 0.5859, lr_0 = 5.2402e-04
Loss = 1.9711e-01, PNorm = 35.0763, GNorm = 1.7564, lr_0 = 5.1259e-04
Validation rmse = 0.176026
Epoch 18
Loss = 2.1431e-01, PNorm = 35.0910, GNorm = 3.5714, lr_0 = 5.0030e-04
Loss = 1.7310e-01, PNorm = 35.1054, GNorm = 1.6203, lr_0 = 4.8939e-04
Validation rmse = 0.171705
Epoch 19
Loss = 1.9624e-01, PNorm = 35.1178, GNorm = 4.4561, lr_0 = 4.7871e-04
Loss = 1.9053e-01, PNorm = 35.1294, GNorm = 2.0023, lr_0 = 4.6827e-04
Loss = 1.5750e-01, PNorm = 35.1304, GNorm = 2.8476, lr_0 = 4.6724e-04
Validation rmse = 0.173443
Epoch 20
Loss = 2.0209e-01, PNorm = 35.1423, GNorm = 3.1221, lr_0 = 4.5705e-04
Validation rmse = 0.169778
Epoch 21
Loss = 1.4874e-01, PNorm = 35.1550, GNorm = 0.6877, lr_0 = 4.4708e-04
Loss = 1.8025e-01, PNorm = 35.1636, GNorm = 0.7994, lr_0 = 4.3733e-04
Validation rmse = 0.174322
Epoch 22
Loss = 2.2085e-01, PNorm = 35.1776, GNorm = 1.6449, lr_0 = 4.2684e-04
Loss = 1.6001e-01, PNorm = 35.1872, GNorm = 2.2993, lr_0 = 4.1753e-04
Validation rmse = 0.170730
Epoch 23
Loss = 1.5614e-01, PNorm = 35.2002, GNorm = 0.6445, lr_0 = 4.0842e-04
Loss = 1.7577e-01, PNorm = 35.2100, GNorm = 0.7523, lr_0 = 3.9951e-04
Validation rmse = 0.174579
Epoch 24
Loss = 1.7265e-01, PNorm = 35.2208, GNorm = 3.0519, lr_0 = 3.8994e-04
Loss = 1.7079e-01, PNorm = 35.2322, GNorm = 1.3363, lr_0 = 3.8143e-04
Validation rmse = 0.173018
Epoch 25
Loss = 2.0087e-01, PNorm = 35.2413, GNorm = 1.5169, lr_0 = 3.7311e-04
Loss = 1.5594e-01, PNorm = 35.2516, GNorm = 2.4765, lr_0 = 3.6497e-04
Validation rmse = 0.172438
Epoch 26
Loss = 2.1108e-01, PNorm = 35.2612, GNorm = 3.6538, lr_0 = 3.5701e-04
Loss = 1.5621e-01, PNorm = 35.2729, GNorm = 2.5607, lr_0 = 3.4922e-04
Loss = 1.3827e-01, PNorm = 35.2740, GNorm = 1.7851, lr_0 = 3.4845e-04
Validation rmse = 0.178137
Epoch 27
Loss = 1.7669e-01, PNorm = 35.2835, GNorm = 2.8596, lr_0 = 3.4085e-04
Validation rmse = 0.172509
Epoch 28
Loss = 1.9055e-01, PNorm = 35.2912, GNorm = 2.0076, lr_0 = 3.3342e-04
Loss = 1.6243e-01, PNorm = 35.2994, GNorm = 3.0402, lr_0 = 3.2614e-04
Validation rmse = 0.181458
Epoch 29
Loss = 1.7778e-01, PNorm = 35.3084, GNorm = 2.0128, lr_0 = 3.1833e-04
Loss = 1.7045e-01, PNorm = 35.3187, GNorm = 2.2724, lr_0 = 3.1138e-04
Validation rmse = 0.176708
Epoch 30
Loss = 1.5501e-01, PNorm = 35.3267, GNorm = 0.8777, lr_0 = 3.0459e-04
Loss = 1.8441e-01, PNorm = 35.3331, GNorm = 1.4591, lr_0 = 2.9795e-04
Validation rmse = 0.173742
Epoch 31
Loss = 1.7680e-01, PNorm = 35.3450, GNorm = 1.7448, lr_0 = 2.9080e-04
Loss = 1.7736e-01, PNorm = 35.3515, GNorm = 1.0848, lr_0 = 2.8446e-04
Validation rmse = 0.174490
Epoch 32
Loss = 1.5466e-01, PNorm = 35.3588, GNorm = 3.3085, lr_0 = 2.7826e-04
Loss = 1.6983e-01, PNorm = 35.3659, GNorm = 0.7833, lr_0 = 2.7219e-04
Validation rmse = 0.172906
Epoch 33
Loss = 1.6824e-01, PNorm = 35.3751, GNorm = 1.6709, lr_0 = 2.6566e-04
Loss = 1.5135e-01, PNorm = 35.3826, GNorm = 0.9338, lr_0 = 2.5987e-04
Validation rmse = 0.170867
Epoch 34
Loss = 1.5530e-01, PNorm = 35.3911, GNorm = 1.3409, lr_0 = 2.5420e-04
Validation rmse = 0.168861
Epoch 35
Loss = 1.4773e-01, PNorm = 35.3971, GNorm = 1.5997, lr_0 = 2.4811e-04
Loss = 1.5992e-01, PNorm = 35.4039, GNorm = 2.4261, lr_0 = 2.4269e-04
Validation rmse = 0.172358
Epoch 36
Loss = 1.6943e-01, PNorm = 35.4105, GNorm = 1.9014, lr_0 = 2.3740e-04
Loss = 1.6160e-01, PNorm = 35.4159, GNorm = 1.5875, lr_0 = 2.3222e-04
Validation rmse = 0.174354
Epoch 37
Loss = 1.8865e-01, PNorm = 35.4240, GNorm = 5.3036, lr_0 = 2.2665e-04
Loss = 1.5386e-01, PNorm = 35.4315, GNorm = 2.3767, lr_0 = 2.2171e-04
Validation rmse = 0.169372
Epoch 38
Loss = 1.2792e-01, PNorm = 35.4372, GNorm = 1.7062, lr_0 = 2.1687e-04
Loss = 1.6392e-01, PNorm = 35.4441, GNorm = 2.2261, lr_0 = 2.1214e-04
Validation rmse = 0.174968
Epoch 39
Loss = 1.7198e-01, PNorm = 35.4510, GNorm = 2.5501, lr_0 = 2.0752e-04
Loss = 1.5923e-01, PNorm = 35.4570, GNorm = 1.0743, lr_0 = 2.0299e-04
Validation rmse = 0.169569
Epoch 40
Loss = 1.4742e-01, PNorm = 35.4630, GNorm = 3.2692, lr_0 = 1.9812e-04
Loss = 1.5372e-01, PNorm = 35.4679, GNorm = 3.5525, lr_0 = 1.9380e-04
Validation rmse = 0.170899
Epoch 41
Loss = 1.6707e-01, PNorm = 35.4722, GNorm = 2.6062, lr_0 = 1.8957e-04
Validation rmse = 0.169836
Epoch 42
Loss = 1.5634e-01, PNorm = 35.4794, GNorm = 1.2778, lr_0 = 1.8503e-04
Loss = 1.2545e-01, PNorm = 35.4843, GNorm = 1.4732, lr_0 = 1.8099e-04
Validation rmse = 0.166297
Epoch 43
Loss = 1.3567e-01, PNorm = 35.4892, GNorm = 1.1782, lr_0 = 1.7705e-04
Loss = 1.6559e-01, PNorm = 35.4961, GNorm = 1.4580, lr_0 = 1.7318e-04
Validation rmse = 0.172241
Epoch 44
Loss = 1.5994e-01, PNorm = 35.5017, GNorm = 1.6174, lr_0 = 1.6903e-04
Loss = 1.5445e-01, PNorm = 35.5065, GNorm = 1.7924, lr_0 = 1.6534e-04
Validation rmse = 0.175350
Epoch 45
Loss = 1.5660e-01, PNorm = 35.5115, GNorm = 2.3700, lr_0 = 1.6174e-04
Loss = 1.4112e-01, PNorm = 35.5158, GNorm = 2.0960, lr_0 = 1.5821e-04
Validation rmse = 0.167962
Epoch 46
Loss = 1.6007e-01, PNorm = 35.5211, GNorm = 1.5302, lr_0 = 1.5442e-04
Loss = 1.3659e-01, PNorm = 35.5256, GNorm = 0.6721, lr_0 = 1.5105e-04
Validation rmse = 0.171344
Epoch 47
Loss = 1.5515e-01, PNorm = 35.5318, GNorm = 0.9561, lr_0 = 1.4775e-04
Validation rmse = 0.167838
Epoch 48
Loss = 1.0019e-01, PNorm = 35.5367, GNorm = 0.7278, lr_0 = 1.4421e-04
Loss = 1.4859e-01, PNorm = 35.5403, GNorm = 0.9347, lr_0 = 1.4107e-04
Validation rmse = 0.167944
Epoch 49
Loss = 1.3019e-01, PNorm = 35.5438, GNorm = 1.5883, lr_0 = 1.3799e-04
Loss = 1.3488e-01, PNorm = 35.5487, GNorm = 1.0810, lr_0 = 1.3498e-04
Validation rmse = 0.169615
Epoch 50
Loss = 1.5492e-01, PNorm = 35.5534, GNorm = 2.0758, lr_0 = 1.3204e-04
Loss = 1.4906e-01, PNorm = 35.5582, GNorm = 1.0572, lr_0 = 1.2915e-04
Validation rmse = 0.165864
Epoch 51
Loss = 1.4663e-01, PNorm = 35.5617, GNorm = 1.7490, lr_0 = 1.2606e-04
Loss = 1.4223e-01, PNorm = 35.5656, GNorm = 0.9205, lr_0 = 1.2331e-04
Validation rmse = 0.167240
Epoch 52
Loss = 1.6000e-01, PNorm = 35.5691, GNorm = 0.9896, lr_0 = 1.2062e-04
Loss = 1.3560e-01, PNorm = 35.5736, GNorm = 2.7695, lr_0 = 1.1799e-04
Validation rmse = 0.168947
Epoch 53
Loss = 1.4720e-01, PNorm = 35.5772, GNorm = 2.0316, lr_0 = 1.1516e-04
Loss = 1.3225e-01, PNorm = 35.5804, GNorm = 1.2727, lr_0 = 1.1265e-04
Validation rmse = 0.167954
Epoch 54
Loss = 1.4720e-01, PNorm = 35.5837, GNorm = 1.3157, lr_0 = 1.1019e-04
Validation rmse = 0.166449
Epoch 55
Loss = 1.3127e-01, PNorm = 35.5877, GNorm = 0.9294, lr_0 = 1.0755e-04
Loss = 1.3478e-01, PNorm = 35.5909, GNorm = 2.0926, lr_0 = 1.0520e-04
Validation rmse = 0.173292
Epoch 56
Loss = 1.2808e-01, PNorm = 35.5936, GNorm = 1.2305, lr_0 = 1.0291e-04
Loss = 1.3947e-01, PNorm = 35.5976, GNorm = 1.5469, lr_0 = 1.0066e-04
Validation rmse = 0.167979
Epoch 57
Loss = 1.2894e-01, PNorm = 35.6017, GNorm = 0.6229, lr_0 = 1.0000e-04
Loss = 1.3667e-01, PNorm = 35.6043, GNorm = 1.1650, lr_0 = 1.0000e-04
Validation rmse = 0.169543
Epoch 58
Loss = 1.2135e-01, PNorm = 35.6075, GNorm = 0.9384, lr_0 = 1.0000e-04
Loss = 1.3376e-01, PNorm = 35.6100, GNorm = 1.6333, lr_0 = 1.0000e-04
Validation rmse = 0.168477
Epoch 59
Loss = 1.3500e-01, PNorm = 35.6145, GNorm = 1.7445, lr_0 = 1.0000e-04
Loss = 1.4596e-01, PNorm = 35.6183, GNorm = 1.4350, lr_0 = 1.0000e-04
Validation rmse = 0.167638
Model 0 best validation rmse = 0.165864 on epoch 50
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.256773
Ensemble test rmse = 0.256773
1-fold cross validation
	Seed 0 ==> test rmse = 0.256773
Overall test rmse = 0.256773 +/- 0.000000
Elapsed time = 0:00:33
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,157 | train size = 919 | val size = 232 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.9364e-01, PNorm = 34.0158, GNorm = 1.2459, lr_0 = 3.7500e-04
Validation rmse = 0.288264
Epoch 1
Loss = 5.5288e-01, PNorm = 34.0420, GNorm = 0.8149, lr_0 = 6.5000e-04
Loss = 7.0876e-01, PNorm = 34.0807, GNorm = 7.9896, lr_0 = 9.0000e-04
Validation rmse = 0.254815
Epoch 2
Loss = 5.8595e-01, PNorm = 34.1503, GNorm = 2.2624, lr_0 = 9.8468e-04
Loss = 5.3312e-01, PNorm = 34.2244, GNorm = 3.4276, lr_0 = 9.6320e-04
Validation rmse = 0.228172
Epoch 3
Loss = 3.6117e-01, PNorm = 34.2923, GNorm = 3.1014, lr_0 = 9.4219e-04
Loss = 4.2199e-01, PNorm = 34.3525, GNorm = 8.2303, lr_0 = 9.2164e-04
Validation rmse = 0.208995
Epoch 4
Loss = 3.8276e-01, PNorm = 34.4132, GNorm = 5.2573, lr_0 = 8.9955e-04
Loss = 3.5933e-01, PNorm = 34.4650, GNorm = 2.1094, lr_0 = 8.7992e-04
Validation rmse = 0.197542
Epoch 5
Loss = 2.8562e-01, PNorm = 34.5194, GNorm = 0.9886, lr_0 = 8.5883e-04
Loss = 2.5864e-01, PNorm = 34.5604, GNorm = 3.8437, lr_0 = 8.4010e-04
Validation rmse = 0.207660
Epoch 6
Loss = 2.9312e-01, PNorm = 34.6020, GNorm = 5.8617, lr_0 = 8.2177e-04
Validation rmse = 0.181435
Epoch 7
Loss = 1.8445e-01, PNorm = 34.6460, GNorm = 2.8683, lr_0 = 8.0207e-04
Loss = 2.4541e-01, PNorm = 34.6862, GNorm = 2.7758, lr_0 = 7.8458e-04
Validation rmse = 0.178203
Epoch 8
Loss = 3.0950e-01, PNorm = 34.7230, GNorm = 1.4859, lr_0 = 7.6746e-04
Loss = 1.9902e-01, PNorm = 34.7527, GNorm = 3.2444, lr_0 = 7.5072e-04
Validation rmse = 0.176693
Epoch 9
Loss = 1.9481e-01, PNorm = 34.7918, GNorm = 0.9399, lr_0 = 7.3273e-04
Loss = 2.1173e-01, PNorm = 34.8277, GNorm = 1.4544, lr_0 = 7.1674e-04
Validation rmse = 0.206214
Epoch 10
Loss = 2.2431e-01, PNorm = 34.8555, GNorm = 0.9935, lr_0 = 6.9956e-04
Loss = 1.9712e-01, PNorm = 34.8799, GNorm = 2.4120, lr_0 = 6.8430e-04
Validation rmse = 0.172154
Epoch 11
Loss = 1.8523e-01, PNorm = 34.9003, GNorm = 2.2193, lr_0 = 6.6938e-04
Loss = 1.8898e-01, PNorm = 34.9233, GNorm = 1.1844, lr_0 = 6.5477e-04
Loss = 2.1974e-01, PNorm = 34.9251, GNorm = 1.8221, lr_0 = 6.5333e-04
Validation rmse = 0.168474
Epoch 12
Loss = 1.7642e-01, PNorm = 34.9455, GNorm = 1.8241, lr_0 = 6.3908e-04
Validation rmse = 0.166337
Epoch 13
Loss = 1.8250e-01, PNorm = 34.9710, GNorm = 4.7004, lr_0 = 6.2376e-04
Loss = 1.9793e-01, PNorm = 34.9940, GNorm = 1.2313, lr_0 = 6.1016e-04
Validation rmse = 0.180150
Epoch 14
Loss = 2.1527e-01, PNorm = 35.0172, GNorm = 2.0708, lr_0 = 5.9685e-04
Loss = 1.8953e-01, PNorm = 35.0361, GNorm = 4.0073, lr_0 = 5.8383e-04
Validation rmse = 0.177865
Epoch 15
Loss = 1.9490e-01, PNorm = 35.0580, GNorm = 3.4128, lr_0 = 5.6983e-04
Loss = 1.8996e-01, PNorm = 35.0798, GNorm = 2.3046, lr_0 = 5.5740e-04
Validation rmse = 0.178678
Epoch 16
Loss = 2.1433e-01, PNorm = 35.1006, GNorm = 5.2346, lr_0 = 5.4524e-04
Loss = 1.7313e-01, PNorm = 35.1204, GNorm = 2.1297, lr_0 = 5.3335e-04
Validation rmse = 0.167502
Epoch 17
Loss = 1.6250e-01, PNorm = 35.1377, GNorm = 1.8642, lr_0 = 5.2057e-04
Loss = 1.8938e-01, PNorm = 35.1539, GNorm = 1.7859, lr_0 = 5.0921e-04
Loss = 1.7989e-01, PNorm = 35.1553, GNorm = 1.1033, lr_0 = 5.0809e-04
Validation rmse = 0.166653
Epoch 18
Loss = 1.5605e-01, PNorm = 35.1699, GNorm = 1.5855, lr_0 = 4.9700e-04
Validation rmse = 0.162890
Epoch 19
Loss = 1.6602e-01, PNorm = 35.1873, GNorm = 2.0944, lr_0 = 4.8616e-04
Loss = 1.5248e-01, PNorm = 35.2014, GNorm = 0.7179, lr_0 = 4.7556e-04
Validation rmse = 0.160018
Epoch 20
Loss = 1.0658e-01, PNorm = 35.2173, GNorm = 1.0231, lr_0 = 4.6416e-04
Loss = 1.7109e-01, PNorm = 35.2289, GNorm = 1.0892, lr_0 = 4.5403e-04
Validation rmse = 0.168445
Epoch 21
Loss = 1.3691e-01, PNorm = 35.2449, GNorm = 2.7875, lr_0 = 4.4315e-04
Loss = 1.5854e-01, PNorm = 35.2601, GNorm = 1.1709, lr_0 = 4.3348e-04
Validation rmse = 0.173296
Epoch 22
Loss = 1.5109e-01, PNorm = 35.2757, GNorm = 2.1225, lr_0 = 4.2403e-04
Loss = 1.7581e-01, PNorm = 35.2898, GNorm = 1.7738, lr_0 = 4.1478e-04
Validation rmse = 0.163529
Epoch 23
Loss = 1.5950e-01, PNorm = 35.3027, GNorm = 2.0735, lr_0 = 4.0484e-04
Loss = 1.4822e-01, PNorm = 35.3180, GNorm = 0.8792, lr_0 = 3.9601e-04
Validation rmse = 0.158593
Epoch 24
Loss = 1.3078e-01, PNorm = 35.3310, GNorm = 0.9313, lr_0 = 3.8737e-04
Validation rmse = 0.161318
Epoch 25
Loss = 1.1872e-01, PNorm = 35.3464, GNorm = 1.2053, lr_0 = 3.7808e-04
Loss = 1.4727e-01, PNorm = 35.3570, GNorm = 0.9547, lr_0 = 3.6983e-04
Validation rmse = 0.157708
Epoch 26
Loss = 1.4664e-01, PNorm = 35.3699, GNorm = 1.0409, lr_0 = 3.6097e-04
Loss = 1.4161e-01, PNorm = 35.3818, GNorm = 1.7774, lr_0 = 3.5310e-04
Validation rmse = 0.160510
Epoch 27
Loss = 1.1022e-01, PNorm = 35.3913, GNorm = 2.1393, lr_0 = 3.4539e-04
Loss = 1.6309e-01, PNorm = 35.4016, GNorm = 0.8095, lr_0 = 3.3786e-04
Validation rmse = 0.157881
Epoch 28
Loss = 1.2503e-01, PNorm = 35.4168, GNorm = 0.9198, lr_0 = 3.2976e-04
Loss = 1.5314e-01, PNorm = 35.4245, GNorm = 4.6763, lr_0 = 3.2257e-04
Validation rmse = 0.157581
Epoch 29
Loss = 1.3825e-01, PNorm = 35.4343, GNorm = 1.6485, lr_0 = 3.1553e-04
Loss = 1.4933e-01, PNorm = 35.4467, GNorm = 1.9164, lr_0 = 3.0865e-04
Validation rmse = 0.158177
Epoch 30
Loss = 1.3689e-01, PNorm = 35.4596, GNorm = 1.3429, lr_0 = 3.0125e-04
Validation rmse = 0.158091
Epoch 31
Loss = 1.1001e-01, PNorm = 35.4693, GNorm = 1.9273, lr_0 = 2.9403e-04
Loss = 1.4525e-01, PNorm = 35.4802, GNorm = 2.3967, lr_0 = 2.8762e-04
Validation rmse = 0.159219
Epoch 32
Loss = 1.2015e-01, PNorm = 35.4883, GNorm = 1.5325, lr_0 = 2.8134e-04
Loss = 1.2423e-01, PNorm = 35.4973, GNorm = 0.7546, lr_0 = 2.7520e-04
Validation rmse = 0.158359
Epoch 33
Loss = 1.3605e-01, PNorm = 35.5088, GNorm = 1.3062, lr_0 = 2.6861e-04
Loss = 1.5222e-01, PNorm = 35.5199, GNorm = 3.8464, lr_0 = 2.6275e-04
Validation rmse = 0.160849
Epoch 34
Loss = 1.4503e-01, PNorm = 35.5280, GNorm = 0.6123, lr_0 = 2.5645e-04
Loss = 1.1821e-01, PNorm = 35.5363, GNorm = 0.9506, lr_0 = 2.5086e-04
Validation rmse = 0.158380
Epoch 35
Loss = 1.2484e-01, PNorm = 35.5443, GNorm = 0.5494, lr_0 = 2.4538e-04
Loss = 1.3335e-01, PNorm = 35.5521, GNorm = 1.3266, lr_0 = 2.4003e-04
Validation rmse = 0.157853
Epoch 36
Loss = 1.2269e-01, PNorm = 35.5620, GNorm = 1.9566, lr_0 = 2.3428e-04
Loss = 1.3718e-01, PNorm = 35.5692, GNorm = 4.1297, lr_0 = 2.2917e-04
Validation rmse = 0.157589
Epoch 37
Loss = 1.1160e-01, PNorm = 35.5791, GNorm = 0.9543, lr_0 = 2.2417e-04
Validation rmse = 0.155999
Epoch 38
Loss = 1.7859e-01, PNorm = 35.5873, GNorm = 3.0243, lr_0 = 2.1880e-04
Loss = 1.2080e-01, PNorm = 35.5940, GNorm = 0.8582, lr_0 = 2.1402e-04
Validation rmse = 0.156485
Epoch 39
Loss = 1.2540e-01, PNorm = 35.6018, GNorm = 1.3740, lr_0 = 2.0889e-04
Loss = 1.1708e-01, PNorm = 35.6094, GNorm = 1.9903, lr_0 = 2.0434e-04
Validation rmse = 0.156534
Epoch 40
Loss = 1.4490e-01, PNorm = 35.6154, GNorm = 0.9852, lr_0 = 1.9988e-04
Loss = 1.2401e-01, PNorm = 35.6223, GNorm = 1.3748, lr_0 = 1.9552e-04
Validation rmse = 0.157777
Epoch 41
Loss = 1.1140e-01, PNorm = 35.6299, GNorm = 0.7866, lr_0 = 1.9083e-04
Loss = 1.3130e-01, PNorm = 35.6359, GNorm = 0.9592, lr_0 = 1.8667e-04
Validation rmse = 0.157172
Epoch 42
Loss = 1.2332e-01, PNorm = 35.6440, GNorm = 0.7807, lr_0 = 1.8219e-04
Loss = 1.1681e-01, PNorm = 35.6498, GNorm = 1.7169, lr_0 = 1.7822e-04
Validation rmse = 0.157873
Epoch 43
Loss = 1.1250e-01, PNorm = 35.6556, GNorm = 0.9826, lr_0 = 1.7433e-04
Validation rmse = 0.155175
Epoch 44
Loss = 1.3516e-01, PNorm = 35.6619, GNorm = 1.3011, lr_0 = 1.7015e-04
Loss = 1.1661e-01, PNorm = 35.6669, GNorm = 0.7735, lr_0 = 1.6644e-04
Validation rmse = 0.155527
Epoch 45
Loss = 1.2390e-01, PNorm = 35.6729, GNorm = 1.0249, lr_0 = 1.6281e-04
Loss = 1.1455e-01, PNorm = 35.6811, GNorm = 1.7029, lr_0 = 1.5926e-04
Validation rmse = 0.156475
Epoch 46
Loss = 9.3610e-02, PNorm = 35.6871, GNorm = 2.4662, lr_0 = 1.5544e-04
Loss = 1.3147e-01, PNorm = 35.6922, GNorm = 2.7810, lr_0 = 1.5205e-04
Validation rmse = 0.157059
Epoch 47
Loss = 1.1943e-01, PNorm = 35.6985, GNorm = 0.7829, lr_0 = 1.4841e-04
Loss = 1.1770e-01, PNorm = 35.7043, GNorm = 2.3974, lr_0 = 1.4517e-04
Validation rmse = 0.155027
Epoch 48
Loss = 1.3598e-01, PNorm = 35.7089, GNorm = 0.7787, lr_0 = 1.4200e-04
Loss = 1.0196e-01, PNorm = 35.7144, GNorm = 0.9992, lr_0 = 1.3891e-04
Loss = 1.0332e-01, PNorm = 35.7148, GNorm = 3.3201, lr_0 = 1.3860e-04
Validation rmse = 0.157658
Epoch 49
Loss = 1.1755e-01, PNorm = 35.7190, GNorm = 1.5061, lr_0 = 1.3558e-04
Validation rmse = 0.157262
Epoch 50
Loss = 7.8968e-02, PNorm = 35.7239, GNorm = 1.1758, lr_0 = 1.3262e-04
Loss = 1.0598e-01, PNorm = 35.7281, GNorm = 1.6635, lr_0 = 1.2973e-04
Validation rmse = 0.155835
Epoch 51
Loss = 1.3332e-01, PNorm = 35.7333, GNorm = 0.7043, lr_0 = 1.2662e-04
Loss = 1.1449e-01, PNorm = 35.7383, GNorm = 0.5812, lr_0 = 1.2385e-04
Validation rmse = 0.155696
Epoch 52
Loss = 9.9001e-02, PNorm = 35.7430, GNorm = 1.3385, lr_0 = 1.2089e-04
Loss = 1.1611e-01, PNorm = 35.7467, GNorm = 1.2230, lr_0 = 1.1825e-04
Validation rmse = 0.155970
Epoch 53
Loss = 1.1497e-01, PNorm = 35.7504, GNorm = 1.6132, lr_0 = 1.1567e-04
Loss = 1.1195e-01, PNorm = 35.7549, GNorm = 1.3801, lr_0 = 1.1315e-04
Validation rmse = 0.156581
Epoch 54
Loss = 1.1007e-01, PNorm = 35.7586, GNorm = 1.1964, lr_0 = 1.1043e-04
Loss = 1.1622e-01, PNorm = 35.7626, GNorm = 2.2594, lr_0 = 1.0803e-04
Loss = 1.6587e-01, PNorm = 35.7630, GNorm = 1.4976, lr_0 = 1.0779e-04
Validation rmse = 0.157801
Epoch 55
Loss = 1.1986e-01, PNorm = 35.7659, GNorm = 2.6542, lr_0 = 1.0544e-04
Validation rmse = 0.155436
Epoch 56
Loss = 1.1193e-01, PNorm = 35.7699, GNorm = 0.8619, lr_0 = 1.0314e-04
Loss = 1.1341e-01, PNorm = 35.7736, GNorm = 2.8223, lr_0 = 1.0089e-04
Validation rmse = 0.156296
Epoch 57
Loss = 9.9110e-02, PNorm = 35.7776, GNorm = 2.1848, lr_0 = 1.0000e-04
Loss = 1.2720e-01, PNorm = 35.7808, GNorm = 3.8270, lr_0 = 1.0000e-04
Validation rmse = 0.163050
Epoch 58
Loss = 1.5793e-01, PNorm = 35.7855, GNorm = 1.3496, lr_0 = 1.0000e-04
Loss = 1.0487e-01, PNorm = 35.7895, GNorm = 2.2137, lr_0 = 1.0000e-04
Validation rmse = 0.155625
Epoch 59
Loss = 9.3747e-02, PNorm = 35.7930, GNorm = 0.7182, lr_0 = 1.0000e-04
Loss = 1.0574e-01, PNorm = 35.7967, GNorm = 1.0073, lr_0 = 1.0000e-04
Validation rmse = 0.158005
Model 0 best validation rmse = 0.155027 on epoch 47
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.129367
Ensemble test rmse = 0.129367
1-fold cross validation
	Seed 0 ==> test rmse = 0.129367
Overall test rmse = 0.129367 +/- 0.000000
Elapsed time = 0:00:33
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,147 | train size = 911 | val size = 230 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.5301e-01, PNorm = 34.0154, GNorm = 1.4281, lr_0 = 3.7500e-04
Validation rmse = 0.282432
Epoch 1
Loss = 6.8752e-01, PNorm = 34.0418, GNorm = 5.5217, lr_0 = 6.5000e-04
Loss = 6.3951e-01, PNorm = 34.0867, GNorm = 3.6125, lr_0 = 9.0000e-04
Validation rmse = 0.302941
Epoch 2
Loss = 5.6761e-01, PNorm = 34.1594, GNorm = 4.5599, lr_0 = 9.8468e-04
Loss = 5.1218e-01, PNorm = 34.2149, GNorm = 7.0096, lr_0 = 9.6320e-04
Validation rmse = 0.221237
Epoch 3
Loss = 4.2846e-01, PNorm = 34.2791, GNorm = 4.7704, lr_0 = 9.4011e-04
Loss = 3.6290e-01, PNorm = 34.3326, GNorm = 5.4214, lr_0 = 9.1961e-04
Validation rmse = 0.276520
Epoch 4
Loss = 4.3743e-01, PNorm = 34.3908, GNorm = 1.2199, lr_0 = 8.9756e-04
Loss = 2.9966e-01, PNorm = 34.4317, GNorm = 5.1662, lr_0 = 8.7798e-04
Validation rmse = 0.204530
Epoch 5
Loss = 2.5323e-01, PNorm = 34.4725, GNorm = 0.8539, lr_0 = 8.5883e-04
Validation rmse = 0.184091
Epoch 6
Loss = 2.0221e-01, PNorm = 34.5131, GNorm = 0.6336, lr_0 = 8.3825e-04
Loss = 2.4690e-01, PNorm = 34.5500, GNorm = 1.3559, lr_0 = 8.1996e-04
Validation rmse = 0.186178
Epoch 7
Loss = 2.2880e-01, PNorm = 34.5919, GNorm = 1.0587, lr_0 = 8.0031e-04
Loss = 2.4266e-01, PNorm = 34.6271, GNorm = 2.1077, lr_0 = 7.8285e-04
Validation rmse = 0.177559
Epoch 8
Loss = 2.2694e-01, PNorm = 34.6584, GNorm = 1.8798, lr_0 = 7.6409e-04
Loss = 1.9498e-01, PNorm = 34.6882, GNorm = 1.1936, lr_0 = 7.4742e-04
Validation rmse = 0.172452
Epoch 9
Loss = 2.3175e-01, PNorm = 34.7236, GNorm = 3.4525, lr_0 = 7.2950e-04
Loss = 2.1119e-01, PNorm = 34.7499, GNorm = 2.1960, lr_0 = 7.1359e-04
Validation rmse = 0.171957
Epoch 10
Loss = 2.1141e-01, PNorm = 34.7737, GNorm = 1.6610, lr_0 = 6.9802e-04
Loss = 1.9676e-01, PNorm = 34.7969, GNorm = 4.1114, lr_0 = 6.8280e-04
Loss = 1.2444e-01, PNorm = 34.7989, GNorm = 2.7331, lr_0 = 6.8129e-04
Validation rmse = 0.165607
Epoch 11
Loss = 1.8592e-01, PNorm = 34.8230, GNorm = 1.6519, lr_0 = 6.6643e-04
Validation rmse = 0.168705
Epoch 12
Loss = 1.5239e-01, PNorm = 34.8447, GNorm = 0.7807, lr_0 = 6.5046e-04
Loss = 1.9866e-01, PNorm = 34.8714, GNorm = 1.1515, lr_0 = 6.3627e-04
Validation rmse = 0.164278
Epoch 13
Loss = 2.0748e-01, PNorm = 34.8920, GNorm = 4.4185, lr_0 = 6.2102e-04
Loss = 1.8341e-01, PNorm = 34.9121, GNorm = 5.3896, lr_0 = 6.0747e-04
Validation rmse = 0.169246
Epoch 14
Loss = 2.2445e-01, PNorm = 34.9345, GNorm = 5.2911, lr_0 = 5.9422e-04
Loss = 2.0717e-01, PNorm = 34.9578, GNorm = 2.7322, lr_0 = 5.8126e-04
Validation rmse = 0.160450
Epoch 15
Loss = 1.8446e-01, PNorm = 34.9802, GNorm = 0.9722, lr_0 = 5.6732e-04
Loss = 1.6003e-01, PNorm = 34.9975, GNorm = 1.5408, lr_0 = 5.5495e-04
Validation rmse = 0.162265
Epoch 16
Loss = 1.6763e-01, PNorm = 35.0187, GNorm = 1.0145, lr_0 = 5.4165e-04
Validation rmse = 0.164608
Epoch 17
Loss = 1.3033e-01, PNorm = 35.0382, GNorm = 2.8831, lr_0 = 5.2866e-04
Loss = 1.6563e-01, PNorm = 35.0564, GNorm = 3.0356, lr_0 = 5.1713e-04
Validation rmse = 0.158725
Epoch 18
Loss = 1.2988e-01, PNorm = 35.0714, GNorm = 1.1141, lr_0 = 5.0474e-04
Loss = 1.6543e-01, PNorm = 35.0842, GNorm = 0.8401, lr_0 = 4.9373e-04
Validation rmse = 0.157239
Epoch 19
Loss = 1.7415e-01, PNorm = 35.0952, GNorm = 4.5122, lr_0 = 4.8296e-04
Loss = 1.7794e-01, PNorm = 35.1088, GNorm = 3.2963, lr_0 = 4.7242e-04
Validation rmse = 0.166220
Epoch 20
Loss = 1.8755e-01, PNorm = 35.1281, GNorm = 0.6460, lr_0 = 4.6110e-04
Loss = 1.6990e-01, PNorm = 35.1456, GNorm = 5.6102, lr_0 = 4.5104e-04
Validation rmse = 0.164614
Epoch 21
Loss = 1.6368e-01, PNorm = 35.1568, GNorm = 1.3063, lr_0 = 4.4023e-04
Loss = 1.8469e-01, PNorm = 35.1707, GNorm = 3.8024, lr_0 = 4.3063e-04
Loss = 1.0793e-01, PNorm = 35.1723, GNorm = 2.7233, lr_0 = 4.2968e-04
Validation rmse = 0.163221
Epoch 22
Loss = 1.5897e-01, PNorm = 35.1839, GNorm = 1.3022, lr_0 = 4.2030e-04
Validation rmse = 0.156507
Epoch 23
Loss = 1.3880e-01, PNorm = 35.1985, GNorm = 0.9382, lr_0 = 4.1114e-04
Loss = 1.7948e-01, PNorm = 35.2096, GNorm = 3.7213, lr_0 = 4.0217e-04
Validation rmse = 0.164961
Epoch 24
Loss = 1.3984e-01, PNorm = 35.2252, GNorm = 2.0251, lr_0 = 3.9253e-04
Loss = 1.6355e-01, PNorm = 35.2387, GNorm = 2.4268, lr_0 = 3.8396e-04
Validation rmse = 0.156769
Epoch 25
Loss = 1.2379e-01, PNorm = 35.2501, GNorm = 0.6379, lr_0 = 3.7476e-04
Loss = 1.6546e-01, PNorm = 35.2613, GNorm = 4.7799, lr_0 = 3.6659e-04
Validation rmse = 0.171561
Epoch 26
Loss = 1.5183e-01, PNorm = 35.2744, GNorm = 5.5671, lr_0 = 3.5780e-04
Loss = 1.6738e-01, PNorm = 35.2837, GNorm = 3.8605, lr_0 = 3.4999e-04
Validation rmse = 0.156175
Epoch 27
Loss = 1.4172e-01, PNorm = 35.2970, GNorm = 3.3978, lr_0 = 3.4161e-04
Loss = 1.3151e-01, PNorm = 35.3065, GNorm = 0.9578, lr_0 = 3.3415e-04
Validation rmse = 0.160126
Epoch 28
Loss = 1.4901e-01, PNorm = 35.3170, GNorm = 2.3546, lr_0 = 3.2686e-04
Validation rmse = 0.162714
Epoch 29
Loss = 1.5158e-01, PNorm = 35.3279, GNorm = 3.3107, lr_0 = 3.1903e-04
Loss = 1.3910e-01, PNorm = 35.3381, GNorm = 2.2438, lr_0 = 3.1207e-04
Validation rmse = 0.159112
Epoch 30
Loss = 1.4226e-01, PNorm = 35.3481, GNorm = 1.1086, lr_0 = 3.0459e-04
Loss = 1.2641e-01, PNorm = 35.3593, GNorm = 0.9945, lr_0 = 2.9795e-04
Validation rmse = 0.173783
Epoch 31
Loss = 1.6508e-01, PNorm = 35.3693, GNorm = 1.6609, lr_0 = 2.9080e-04
Loss = 1.5454e-01, PNorm = 35.3793, GNorm = 4.1451, lr_0 = 2.8446e-04
Validation rmse = 0.161885
Epoch 32
Loss = 1.3095e-01, PNorm = 35.3886, GNorm = 0.9871, lr_0 = 2.7826e-04
Loss = 1.3883e-01, PNorm = 35.3980, GNorm = 1.5446, lr_0 = 2.7219e-04
Validation rmse = 0.158003
Epoch 33
Loss = 1.2301e-01, PNorm = 35.4092, GNorm = 1.9110, lr_0 = 2.6566e-04
Validation rmse = 0.157222
Epoch 34
Loss = 1.0220e-01, PNorm = 35.4179, GNorm = 0.7533, lr_0 = 2.5929e-04
Loss = 1.3905e-01, PNorm = 35.4243, GNorm = 1.1835, lr_0 = 2.5364e-04
Validation rmse = 0.155604
Epoch 35
Loss = 1.2920e-01, PNorm = 35.4355, GNorm = 3.5026, lr_0 = 2.4756e-04
Loss = 1.2870e-01, PNorm = 35.4451, GNorm = 1.8849, lr_0 = 2.4216e-04
Validation rmse = 0.155946
Epoch 36
Loss = 1.2407e-01, PNorm = 35.4533, GNorm = 3.3037, lr_0 = 2.3635e-04
Loss = 1.2196e-01, PNorm = 35.4612, GNorm = 3.0621, lr_0 = 2.3120e-04
Validation rmse = 0.159603
Epoch 37
Loss = 1.3463e-01, PNorm = 35.4694, GNorm = 1.1800, lr_0 = 2.2615e-04
Loss = 1.2129e-01, PNorm = 35.4780, GNorm = 1.1945, lr_0 = 2.2122e-04
Validation rmse = 0.155854
Epoch 38
Loss = 1.1153e-01, PNorm = 35.4854, GNorm = 0.8695, lr_0 = 2.1592e-04
Loss = 1.3374e-01, PNorm = 35.4923, GNorm = 1.8502, lr_0 = 2.1121e-04
Loss = 1.7521e-01, PNorm = 35.4926, GNorm = 2.7788, lr_0 = 2.1074e-04
Validation rmse = 0.156164
Epoch 39
Loss = 1.2981e-01, PNorm = 35.4977, GNorm = 4.6128, lr_0 = 2.0615e-04
Validation rmse = 0.174989
Epoch 40
Loss = 1.7906e-01, PNorm = 35.5059, GNorm = 3.9906, lr_0 = 2.0121e-04
Loss = 1.3389e-01, PNorm = 35.5142, GNorm = 1.7737, lr_0 = 1.9682e-04
Validation rmse = 0.160891
Epoch 41
Loss = 8.3192e-02, PNorm = 35.5196, GNorm = 1.3223, lr_0 = 1.9252e-04
Loss = 1.4691e-01, PNorm = 35.5261, GNorm = 0.6561, lr_0 = 1.8832e-04
Validation rmse = 0.157910
Epoch 42
Loss = 1.2741e-01, PNorm = 35.5331, GNorm = 1.2093, lr_0 = 1.8381e-04
Loss = 1.1701e-01, PNorm = 35.5399, GNorm = 2.6688, lr_0 = 1.7980e-04
Validation rmse = 0.159400
Epoch 43
Loss = 1.2299e-01, PNorm = 35.5473, GNorm = 1.5160, lr_0 = 1.7549e-04
Loss = 1.2565e-01, PNorm = 35.5528, GNorm = 0.6533, lr_0 = 1.7166e-04
Validation rmse = 0.156520
Epoch 44
Loss = 1.1271e-01, PNorm = 35.5585, GNorm = 1.1875, lr_0 = 1.6755e-04
Validation rmse = 0.156904
Epoch 45
Loss = 1.0706e-01, PNorm = 35.5644, GNorm = 0.7981, lr_0 = 1.6353e-04
Loss = 1.1450e-01, PNorm = 35.5707, GNorm = 2.4043, lr_0 = 1.5996e-04
Validation rmse = 0.162301
Epoch 46
Loss = 1.2175e-01, PNorm = 35.5753, GNorm = 2.9945, lr_0 = 1.5647e-04
Loss = 1.1791e-01, PNorm = 35.5800, GNorm = 0.9708, lr_0 = 1.5306e-04
Validation rmse = 0.156584
Epoch 47
Loss = 1.0634e-01, PNorm = 35.5864, GNorm = 0.7474, lr_0 = 1.4939e-04
Loss = 1.1131e-01, PNorm = 35.5909, GNorm = 1.2725, lr_0 = 1.4613e-04
Validation rmse = 0.155487
Epoch 48
Loss = 1.0732e-01, PNorm = 35.5980, GNorm = 0.3837, lr_0 = 1.4263e-04
Loss = 1.2246e-01, PNorm = 35.6035, GNorm = 1.7601, lr_0 = 1.3952e-04
Validation rmse = 0.157477
Epoch 49
Loss = 1.2144e-01, PNorm = 35.6089, GNorm = 0.9480, lr_0 = 1.3618e-04
Loss = 1.1233e-01, PNorm = 35.6143, GNorm = 2.0789, lr_0 = 1.3321e-04
Validation rmse = 0.158294
Epoch 50
Loss = 1.3072e-01, PNorm = 35.6188, GNorm = 2.2606, lr_0 = 1.3030e-04
Validation rmse = 0.159107
Epoch 51
Loss = 7.9328e-02, PNorm = 35.6234, GNorm = 1.1781, lr_0 = 1.2718e-04
Loss = 1.0830e-01, PNorm = 35.6273, GNorm = 1.1613, lr_0 = 1.2440e-04
Validation rmse = 0.160397
Epoch 52
Loss = 1.2862e-01, PNorm = 35.6316, GNorm = 0.6186, lr_0 = 1.2142e-04
Loss = 9.9305e-02, PNorm = 35.6362, GNorm = 1.0089, lr_0 = 1.1877e-04
Validation rmse = 0.156057
Epoch 53
Loss = 1.1806e-01, PNorm = 35.6406, GNorm = 0.5850, lr_0 = 1.1592e-04
Loss = 1.1025e-01, PNorm = 35.6446, GNorm = 0.8334, lr_0 = 1.1340e-04
Validation rmse = 0.157279
Epoch 54
Loss = 1.1711e-01, PNorm = 35.6495, GNorm = 1.2314, lr_0 = 1.1068e-04
Loss = 1.1827e-01, PNorm = 35.6536, GNorm = 2.3254, lr_0 = 1.0826e-04
Validation rmse = 0.157700
Epoch 55
Loss = 1.0551e-01, PNorm = 35.6568, GNorm = 1.4162, lr_0 = 1.0590e-04
Loss = 1.1320e-01, PNorm = 35.6609, GNorm = 1.3275, lr_0 = 1.0359e-04
Loss = 1.4824e-01, PNorm = 35.6611, GNorm = 1.6454, lr_0 = 1.0336e-04
Validation rmse = 0.159594
Epoch 56
Loss = 1.0852e-01, PNorm = 35.6635, GNorm = 1.4268, lr_0 = 1.0111e-04
Validation rmse = 0.157658
Epoch 57
Loss = 1.1869e-01, PNorm = 35.6664, GNorm = 0.7844, lr_0 = 1.0000e-04
Loss = 1.1423e-01, PNorm = 35.6705, GNorm = 1.8058, lr_0 = 1.0000e-04
Validation rmse = 0.157792
Epoch 58
Loss = 1.1584e-01, PNorm = 35.6741, GNorm = 0.5981, lr_0 = 1.0000e-04
Loss = 1.1146e-01, PNorm = 35.6771, GNorm = 0.6913, lr_0 = 1.0000e-04
Validation rmse = 0.156748
Epoch 59
Loss = 1.0827e-01, PNorm = 35.6807, GNorm = 0.7396, lr_0 = 1.0000e-04
Loss = 1.1211e-01, PNorm = 35.6833, GNorm = 0.8464, lr_0 = 1.0000e-04
Validation rmse = 0.156439
Model 0 best validation rmse = 0.155487 on epoch 47
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.129782
Ensemble test rmse = 0.129782
1-fold cross validation
	Seed 0 ==> test rmse = 0.129782
Overall test rmse = 0.129782 +/- 0.000000
Elapsed time = 0:00:32
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,137 | train size = 903 | val size = 228 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.7077e-01, PNorm = 34.0138, GNorm = 2.6245, lr_0 = 3.7500e-04
Validation rmse = 0.297317
Epoch 1
Loss = 8.5199e-01, PNorm = 34.0344, GNorm = 6.2906, lr_0 = 6.5000e-04
Loss = 6.7345e-01, PNorm = 34.0733, GNorm = 2.7503, lr_0 = 9.0000e-04
Validation rmse = 0.276866
Epoch 2
Loss = 7.5963e-01, PNorm = 34.1350, GNorm = 12.8921, lr_0 = 9.8468e-04
Loss = 8.6555e-01, PNorm = 34.1847, GNorm = 3.6103, lr_0 = 9.6320e-04
Validation rmse = 0.266271
Epoch 3
Loss = 5.7322e-01, PNorm = 34.2492, GNorm = 2.9223, lr_0 = 9.4011e-04
Loss = 5.1534e-01, PNorm = 34.3148, GNorm = 3.3107, lr_0 = 9.1961e-04
Validation rmse = 0.234112
Epoch 4
Loss = 4.2163e-01, PNorm = 34.3649, GNorm = 1.9750, lr_0 = 8.9756e-04
Loss = 3.6468e-01, PNorm = 34.4127, GNorm = 2.5415, lr_0 = 8.7798e-04
Loss = 7.8852e-02, PNorm = 34.4186, GNorm = 2.8596, lr_0 = 8.7605e-04
Validation rmse = 0.197590
Epoch 5
Loss = 3.4554e-01, PNorm = 34.4655, GNorm = 4.1494, lr_0 = 8.5694e-04
Validation rmse = 0.230532
Epoch 6
Loss = 4.9173e-01, PNorm = 34.5021, GNorm = 4.3044, lr_0 = 8.3640e-04
Loss = 3.1658e-01, PNorm = 34.5373, GNorm = 1.1323, lr_0 = 8.1815e-04
Validation rmse = 0.188595
Epoch 7
Loss = 2.6093e-01, PNorm = 34.5859, GNorm = 0.6583, lr_0 = 7.9854e-04
Loss = 2.6093e-01, PNorm = 34.6250, GNorm = 2.2837, lr_0 = 7.8112e-04
Validation rmse = 0.172734
Epoch 8
Loss = 2.6437e-01, PNorm = 34.6631, GNorm = 1.0442, lr_0 = 7.6240e-04
Loss = 2.7206e-01, PNorm = 34.7038, GNorm = 4.5456, lr_0 = 7.4577e-04
Validation rmse = 0.181180
Epoch 9
Loss = 2.7389e-01, PNorm = 34.7403, GNorm = 1.5731, lr_0 = 7.2790e-04
Loss = 2.3461e-01, PNorm = 34.7724, GNorm = 3.1784, lr_0 = 7.1202e-04
Loss = 2.1972e-01, PNorm = 34.7764, GNorm = 8.3258, lr_0 = 7.1045e-04
Validation rmse = 0.168386
Epoch 10
Loss = 2.2525e-01, PNorm = 34.8079, GNorm = 0.7881, lr_0 = 6.9495e-04
Validation rmse = 0.175475
Epoch 11
Loss = 2.3186e-01, PNorm = 34.8287, GNorm = 6.7624, lr_0 = 6.7829e-04
Loss = 2.9605e-01, PNorm = 34.8504, GNorm = 5.9030, lr_0 = 6.6350e-04
Validation rmse = 0.177373
Epoch 12
Loss = 2.4171e-01, PNorm = 34.8761, GNorm = 0.8586, lr_0 = 6.4759e-04
Loss = 2.1926e-01, PNorm = 34.9016, GNorm = 1.1457, lr_0 = 6.3347e-04
Validation rmse = 0.184393
Epoch 13
Loss = 2.8443e-01, PNorm = 34.9261, GNorm = 3.2041, lr_0 = 6.1828e-04
Loss = 2.1645e-01, PNorm = 34.9441, GNorm = 1.1009, lr_0 = 6.0480e-04
Validation rmse = 0.170135
Epoch 14
Loss = 2.0741e-01, PNorm = 34.9704, GNorm = 3.8532, lr_0 = 5.9030e-04
Loss = 2.1223e-01, PNorm = 34.9974, GNorm = 3.3479, lr_0 = 5.7742e-04
Loss = 9.2466e-01, PNorm = 34.9989, GNorm = 13.4942, lr_0 = 5.7615e-04
Validation rmse = 0.166733
Epoch 15
Loss = 2.3382e-01, PNorm = 35.0242, GNorm = 4.1037, lr_0 = 5.6358e-04
Validation rmse = 0.168390
Epoch 16
Loss = 2.2192e-01, PNorm = 35.0518, GNorm = 6.4840, lr_0 = 5.5007e-04
Loss = 2.2433e-01, PNorm = 35.0760, GNorm = 1.5842, lr_0 = 5.3808e-04
Validation rmse = 0.167125
Epoch 17
Loss = 2.4919e-01, PNorm = 35.0956, GNorm = 5.0589, lr_0 = 5.2634e-04
Loss = 1.9653e-01, PNorm = 35.1134, GNorm = 3.9205, lr_0 = 5.1486e-04
Validation rmse = 0.168952
Epoch 18
Loss = 1.7375e-01, PNorm = 35.1297, GNorm = 4.3549, lr_0 = 5.0252e-04
Loss = 1.7333e-01, PNorm = 35.1452, GNorm = 1.1213, lr_0 = 4.9155e-04
Validation rmse = 0.158028
Epoch 19
Loss = 1.9166e-01, PNorm = 35.1587, GNorm = 3.6776, lr_0 = 4.7977e-04
Loss = 1.7005e-01, PNorm = 35.1712, GNorm = 2.0353, lr_0 = 4.6931e-04
Validation rmse = 0.157861
Epoch 20
Loss = 1.8460e-01, PNorm = 35.1851, GNorm = 2.5617, lr_0 = 4.5806e-04
Validation rmse = 0.160090
Epoch 21
Loss = 1.5206e-01, PNorm = 35.1965, GNorm = 2.7109, lr_0 = 4.4708e-04
Loss = 1.6455e-01, PNorm = 35.2113, GNorm = 2.6389, lr_0 = 4.3733e-04
Validation rmse = 0.187803
Epoch 22
Loss = 2.8714e-01, PNorm = 35.2222, GNorm = 6.7242, lr_0 = 4.2684e-04
Loss = 2.0384e-01, PNorm = 35.2323, GNorm = 1.7555, lr_0 = 4.1753e-04
Validation rmse = 0.159986
Epoch 23
Loss = 1.8491e-01, PNorm = 35.2539, GNorm = 1.6557, lr_0 = 4.0752e-04
Loss = 1.7130e-01, PNorm = 35.2616, GNorm = 1.4569, lr_0 = 3.9863e-04
Validation rmse = 0.162379
Epoch 24
Loss = 1.6265e-01, PNorm = 35.2717, GNorm = 0.8225, lr_0 = 3.8908e-04
Loss = 1.5419e-01, PNorm = 35.2829, GNorm = 1.0734, lr_0 = 3.8059e-04
Validation rmse = 0.157180
Epoch 25
Loss = 1.7158e-01, PNorm = 35.2965, GNorm = 3.7326, lr_0 = 3.7147e-04
Validation rmse = 0.160402
Epoch 26
Loss = 1.3087e-01, PNorm = 35.3093, GNorm = 2.5577, lr_0 = 3.6257e-04
Loss = 1.5234e-01, PNorm = 35.3215, GNorm = 1.2580, lr_0 = 3.5466e-04
Validation rmse = 0.159878
Epoch 27
Loss = 1.4431e-01, PNorm = 35.3268, GNorm = 0.8127, lr_0 = 3.4616e-04
Loss = 1.5857e-01, PNorm = 35.3360, GNorm = 1.0832, lr_0 = 3.3861e-04
Validation rmse = 0.155832
Epoch 28
Loss = 1.8627e-01, PNorm = 35.3531, GNorm = 3.0713, lr_0 = 3.3049e-04
Loss = 1.5970e-01, PNorm = 35.3651, GNorm = 0.8595, lr_0 = 3.2328e-04
Validation rmse = 0.156427
Epoch 29
Loss = 1.7031e-01, PNorm = 35.3753, GNorm = 0.7049, lr_0 = 3.1553e-04
Loss = 1.3586e-01, PNorm = 35.3859, GNorm = 2.5454, lr_0 = 3.0865e-04
Validation rmse = 0.153842
Epoch 30
Loss = 1.4802e-01, PNorm = 35.3901, GNorm = 1.5548, lr_0 = 3.0125e-04
Validation rmse = 0.153284
Epoch 31
Loss = 1.2899e-01, PNorm = 35.3987, GNorm = 0.6737, lr_0 = 2.9403e-04
Loss = 1.3085e-01, PNorm = 35.4078, GNorm = 0.9585, lr_0 = 2.8762e-04
Validation rmse = 0.153234
Epoch 32
Loss = 1.5613e-01, PNorm = 35.4164, GNorm = 1.9125, lr_0 = 2.8072e-04
Loss = 1.3623e-01, PNorm = 35.4214, GNorm = 0.8609, lr_0 = 2.7460e-04
Validation rmse = 0.153327
Epoch 33
Loss = 1.4892e-01, PNorm = 35.4281, GNorm = 0.6944, lr_0 = 2.6802e-04
Loss = 1.2271e-01, PNorm = 35.4341, GNorm = 1.2436, lr_0 = 2.6217e-04
Validation rmse = 0.164208
Epoch 34
Loss = 1.6097e-01, PNorm = 35.4445, GNorm = 1.5425, lr_0 = 2.5645e-04
Loss = 1.4925e-01, PNorm = 35.4510, GNorm = 0.6220, lr_0 = 2.5086e-04
Validation rmse = 0.153221
Epoch 35
Loss = 1.3132e-01, PNorm = 35.4577, GNorm = 0.7235, lr_0 = 2.4484e-04
Loss = 1.3919e-01, PNorm = 35.4631, GNorm = 1.7812, lr_0 = 2.3950e-04
Loss = 4.8528e-02, PNorm = 35.4636, GNorm = 1.4001, lr_0 = 2.3898e-04
Validation rmse = 0.155207
Epoch 36
Loss = 1.2771e-01, PNorm = 35.4701, GNorm = 0.6095, lr_0 = 2.3376e-04
Validation rmse = 0.153138
Epoch 37
Loss = 9.7866e-02, PNorm = 35.4767, GNorm = 0.6851, lr_0 = 2.2816e-04
Loss = 1.2666e-01, PNorm = 35.4825, GNorm = 0.6711, lr_0 = 2.2318e-04
Validation rmse = 0.155302
Epoch 38
Loss = 1.4118e-01, PNorm = 35.4885, GNorm = 0.6198, lr_0 = 2.1783e-04
Loss = 1.2797e-01, PNorm = 35.4937, GNorm = 1.4766, lr_0 = 2.1308e-04
Validation rmse = 0.154510
Epoch 39
Loss = 1.2019e-01, PNorm = 35.5005, GNorm = 3.0215, lr_0 = 2.0797e-04
Loss = 1.4052e-01, PNorm = 35.5077, GNorm = 1.2735, lr_0 = 2.0344e-04
Validation rmse = 0.156238
Epoch 40
Loss = 1.2391e-01, PNorm = 35.5132, GNorm = 1.0258, lr_0 = 1.9856e-04
Loss = 1.3360e-01, PNorm = 35.5191, GNorm = 1.5438, lr_0 = 1.9423e-04
Loss = 3.3766e-02, PNorm = 35.5195, GNorm = 2.0671, lr_0 = 1.9380e-04
Validation rmse = 0.153042
Epoch 41
Loss = 1.2220e-01, PNorm = 35.5251, GNorm = 1.6578, lr_0 = 1.8957e-04
Validation rmse = 0.153275
Epoch 42
Loss = 1.4166e-01, PNorm = 35.5308, GNorm = 1.4087, lr_0 = 1.8503e-04
Loss = 1.2542e-01, PNorm = 35.5353, GNorm = 2.4230, lr_0 = 1.8099e-04
Validation rmse = 0.153551
Epoch 43
Loss = 1.1106e-01, PNorm = 35.5411, GNorm = 0.7652, lr_0 = 1.7666e-04
Loss = 1.2302e-01, PNorm = 35.5460, GNorm = 1.6086, lr_0 = 1.7280e-04
Validation rmse = 0.152638
Epoch 44
Loss = 1.1600e-01, PNorm = 35.5528, GNorm = 1.1129, lr_0 = 1.6866e-04
Loss = 1.2672e-01, PNorm = 35.5584, GNorm = 1.4412, lr_0 = 1.6498e-04
Validation rmse = 0.154567
Epoch 45
Loss = 1.1493e-01, PNorm = 35.5616, GNorm = 0.8596, lr_0 = 1.6103e-04
Loss = 1.2870e-01, PNorm = 35.5668, GNorm = 1.1590, lr_0 = 1.5751e-04
Loss = 8.2212e-02, PNorm = 35.5670, GNorm = 2.5862, lr_0 = 1.5717e-04
Validation rmse = 0.152448
Epoch 46
Loss = 1.2454e-01, PNorm = 35.5702, GNorm = 1.7949, lr_0 = 1.5374e-04
Validation rmse = 0.154889
Epoch 47
Loss = 1.8202e-01, PNorm = 35.5766, GNorm = 1.0054, lr_0 = 1.5005e-04
Loss = 1.3491e-01, PNorm = 35.5835, GNorm = 1.9667, lr_0 = 1.4678e-04
Validation rmse = 0.155721
Epoch 48
Loss = 1.4377e-01, PNorm = 35.5861, GNorm = 0.7594, lr_0 = 1.4326e-04
Loss = 1.1786e-01, PNorm = 35.5892, GNorm = 0.9251, lr_0 = 1.4014e-04
Validation rmse = 0.155903
Epoch 49
Loss = 1.1469e-01, PNorm = 35.5930, GNorm = 1.8530, lr_0 = 1.3678e-04
Loss = 1.2581e-01, PNorm = 35.5962, GNorm = 0.9006, lr_0 = 1.3379e-04
Validation rmse = 0.153400
Epoch 50
Loss = 1.3330e-01, PNorm = 35.6011, GNorm = 1.1429, lr_0 = 1.3088e-04
Loss = 1.0872e-01, PNorm = 35.6048, GNorm = 0.7752, lr_0 = 1.2802e-04
Validation rmse = 0.153426
Epoch 51
Loss = 1.2430e-01, PNorm = 35.6092, GNorm = 0.8735, lr_0 = 1.2495e-04
Validation rmse = 0.152618
Epoch 52
Loss = 1.3056e-01, PNorm = 35.6134, GNorm = 0.9260, lr_0 = 1.2196e-04
Loss = 1.2094e-01, PNorm = 35.6174, GNorm = 3.9692, lr_0 = 1.1930e-04
Validation rmse = 0.152832
Epoch 53
Loss = 1.3258e-01, PNorm = 35.6207, GNorm = 0.6074, lr_0 = 1.1644e-04
Loss = 1.1239e-01, PNorm = 35.6225, GNorm = 2.2277, lr_0 = 1.1390e-04
Validation rmse = 0.152496
Epoch 54
Loss = 1.0939e-01, PNorm = 35.6289, GNorm = 1.8650, lr_0 = 1.1117e-04
Loss = 1.1823e-01, PNorm = 35.6321, GNorm = 0.6831, lr_0 = 1.0874e-04
Validation rmse = 0.155452
Epoch 55
Loss = 1.2338e-01, PNorm = 35.6332, GNorm = 0.8589, lr_0 = 1.0614e-04
Loss = 1.1321e-01, PNorm = 35.6365, GNorm = 1.0384, lr_0 = 1.0382e-04
Validation rmse = 0.153837
Epoch 56
Loss = 9.5791e-02, PNorm = 35.6405, GNorm = 1.3150, lr_0 = 1.0133e-04
Validation rmse = 0.156541
Epoch 57
Loss = 9.7631e-02, PNorm = 35.6439, GNorm = 2.7572, lr_0 = 1.0000e-04
Loss = 1.2315e-01, PNorm = 35.6495, GNorm = 2.9408, lr_0 = 1.0000e-04
Validation rmse = 0.157193
Epoch 58
Loss = 1.3035e-01, PNorm = 35.6525, GNorm = 1.4551, lr_0 = 1.0000e-04
Loss = 1.1570e-01, PNorm = 35.6546, GNorm = 1.0432, lr_0 = 1.0000e-04
Validation rmse = 0.155123
Epoch 59
Loss = 1.1771e-01, PNorm = 35.6595, GNorm = 0.6167, lr_0 = 1.0000e-04
Loss = 1.1271e-01, PNorm = 35.6628, GNorm = 0.8243, lr_0 = 1.0000e-04
Validation rmse = 0.153190
Model 0 best validation rmse = 0.152448 on epoch 45
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.158327
Ensemble test rmse = 0.158327
1-fold cross validation
	Seed 0 ==> test rmse = 0.158327
Overall test rmse = 0.158327 +/- 0.000000
Elapsed time = 0:00:33
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,127 | train size = 895 | val size = 226 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.4898e-01, PNorm = 34.0159, GNorm = 1.7684, lr_0 = 3.9118e-04
Validation rmse = 0.309219
Epoch 1
Loss = 8.2426e-01, PNorm = 34.0423, GNorm = 12.2293, lr_0 = 6.8235e-04
Loss = 7.3631e-01, PNorm = 34.0863, GNorm = 5.0117, lr_0 = 9.4706e-04
Validation rmse = 0.265106
Epoch 2
Loss = 4.9516e-01, PNorm = 34.1603, GNorm = 8.0311, lr_0 = 9.8149e-04
Loss = 4.2286e-01, PNorm = 34.2326, GNorm = 5.4260, lr_0 = 9.5884e-04
Validation rmse = 0.235342
Epoch 3
Loss = 3.8367e-01, PNorm = 34.2915, GNorm = 1.2062, lr_0 = 9.3670e-04
Loss = 3.6171e-01, PNorm = 34.3428, GNorm = 2.0689, lr_0 = 9.1508e-04
Validation rmse = 0.222816
Epoch 4
Loss = 3.3187e-01, PNorm = 34.4014, GNorm = 5.7166, lr_0 = 8.9396e-04
Validation rmse = 0.206418
Epoch 5
Loss = 2.4775e-01, PNorm = 34.4472, GNorm = 2.2996, lr_0 = 8.7333e-04
Loss = 2.7814e-01, PNorm = 34.4938, GNorm = 0.8678, lr_0 = 8.5317e-04
Validation rmse = 0.201591
Epoch 6
Loss = 2.3292e-01, PNorm = 34.5410, GNorm = 3.4673, lr_0 = 8.3347e-04
Loss = 2.5698e-01, PNorm = 34.5755, GNorm = 0.7018, lr_0 = 8.1424e-04
Validation rmse = 0.176898
Epoch 7
Loss = 1.6966e-01, PNorm = 34.6157, GNorm = 3.3875, lr_0 = 7.9544e-04
Loss = 2.5819e-01, PNorm = 34.6496, GNorm = 5.7711, lr_0 = 7.7708e-04
Validation rmse = 0.185414
Epoch 8
Loss = 2.2079e-01, PNorm = 34.6880, GNorm = 1.7551, lr_0 = 7.5914e-04
Loss = 2.1143e-01, PNorm = 34.7192, GNorm = 4.0840, lr_0 = 7.4162e-04
Validation rmse = 0.175851
Epoch 9
Loss = 2.1235e-01, PNorm = 34.7531, GNorm = 1.9132, lr_0 = 7.2450e-04
Validation rmse = 0.170757
Epoch 10
Loss = 1.5965e-01, PNorm = 34.7780, GNorm = 1.6651, lr_0 = 7.0778e-04
Loss = 2.0067e-01, PNorm = 34.8116, GNorm = 1.3539, lr_0 = 6.9144e-04
Validation rmse = 0.191982
Epoch 11
Loss = 2.1909e-01, PNorm = 34.8390, GNorm = 4.7527, lr_0 = 6.7391e-04
Loss = 2.0939e-01, PNorm = 34.8646, GNorm = 2.4403, lr_0 = 6.5835e-04
Validation rmse = 0.155309
Epoch 12
Loss = 1.4815e-01, PNorm = 34.8917, GNorm = 1.3319, lr_0 = 6.4316e-04
Loss = 1.9151e-01, PNorm = 34.9169, GNorm = 1.3542, lr_0 = 6.2831e-04
Validation rmse = 0.161295
Epoch 13
Loss = 1.4689e-01, PNorm = 34.9366, GNorm = 0.7370, lr_0 = 6.1381e-04
Loss = 1.8921e-01, PNorm = 34.9580, GNorm = 2.9895, lr_0 = 5.9964e-04
Validation rmse = 0.156265
Epoch 14
Loss = 1.6802e-01, PNorm = 34.9763, GNorm = 1.9436, lr_0 = 5.8580e-04
Validation rmse = 0.183428
Epoch 15
Loss = 2.2736e-01, PNorm = 34.9982, GNorm = 5.7957, lr_0 = 5.7228e-04
Loss = 1.8357e-01, PNorm = 35.0202, GNorm = 3.3538, lr_0 = 5.5907e-04
Validation rmse = 0.171869
Epoch 16
Loss = 1.9029e-01, PNorm = 35.0406, GNorm = 0.9151, lr_0 = 5.4616e-04
Loss = 1.5590e-01, PNorm = 35.0635, GNorm = 0.5703, lr_0 = 5.3356e-04
Validation rmse = 0.152545
Epoch 17
Loss = 1.3827e-01, PNorm = 35.0822, GNorm = 1.0223, lr_0 = 5.2124e-04
Loss = 1.4906e-01, PNorm = 35.1021, GNorm = 0.8579, lr_0 = 5.0921e-04
Validation rmse = 0.151913
Epoch 18
Loss = 1.6663e-01, PNorm = 35.1163, GNorm = 2.6642, lr_0 = 4.9746e-04
Loss = 1.4983e-01, PNorm = 35.1335, GNorm = 1.0171, lr_0 = 4.8597e-04
Validation rmse = 0.152232
Epoch 19
Loss = 1.5102e-01, PNorm = 35.1516, GNorm = 3.9545, lr_0 = 4.7476e-04
Validation rmse = 0.152479
Epoch 20
Loss = 1.4922e-01, PNorm = 35.1670, GNorm = 0.9112, lr_0 = 4.6380e-04
Loss = 1.2592e-01, PNorm = 35.1852, GNorm = 1.2941, lr_0 = 4.5309e-04
Validation rmse = 0.148845
Epoch 21
Loss = 1.3954e-01, PNorm = 35.2036, GNorm = 1.0112, lr_0 = 4.4160e-04
Loss = 1.4778e-01, PNorm = 35.2201, GNorm = 2.8292, lr_0 = 4.3141e-04
Validation rmse = 0.150318
Epoch 22
Loss = 1.4131e-01, PNorm = 35.2345, GNorm = 2.2199, lr_0 = 4.2145e-04
Loss = 1.2857e-01, PNorm = 35.2505, GNorm = 1.4392, lr_0 = 4.1172e-04
Validation rmse = 0.152212
Epoch 23
Loss = 1.5484e-01, PNorm = 35.2615, GNorm = 1.1278, lr_0 = 4.0222e-04
Validation rmse = 0.161243
Epoch 24
Loss = 1.0328e-01, PNorm = 35.2744, GNorm = 2.3210, lr_0 = 3.9293e-04
Loss = 1.4268e-01, PNorm = 35.2905, GNorm = 1.5291, lr_0 = 3.8386e-04
Validation rmse = 0.150859
Epoch 25
Loss = 1.1843e-01, PNorm = 35.3043, GNorm = 2.7415, lr_0 = 3.7500e-04
Loss = 1.2460e-01, PNorm = 35.3154, GNorm = 5.0333, lr_0 = 3.6635e-04
Validation rmse = 0.150698
Epoch 26
Loss = 1.1267e-01, PNorm = 35.3294, GNorm = 0.8747, lr_0 = 3.5789e-04
Loss = 1.2609e-01, PNorm = 35.3420, GNorm = 0.9427, lr_0 = 3.4963e-04
Validation rmse = 0.148123
Epoch 27
Loss = 1.3055e-01, PNorm = 35.3514, GNorm = 0.5873, lr_0 = 3.4156e-04
Loss = 1.1557e-01, PNorm = 35.3646, GNorm = 1.9774, lr_0 = 3.3368e-04
Validation rmse = 0.151286
Epoch 28
Loss = 1.3641e-01, PNorm = 35.3744, GNorm = 2.7600, lr_0 = 3.2598e-04
Validation rmse = 0.149362
Epoch 29
Loss = 1.5132e-01, PNorm = 35.3866, GNorm = 2.2980, lr_0 = 3.1845e-04
Loss = 1.1601e-01, PNorm = 35.3983, GNorm = 0.8450, lr_0 = 3.1110e-04
Validation rmse = 0.152254
Epoch 30
Loss = 1.1074e-01, PNorm = 35.4071, GNorm = 2.0212, lr_0 = 3.0392e-04
Loss = 1.1940e-01, PNorm = 35.4154, GNorm = 0.6711, lr_0 = 2.9690e-04
Validation rmse = 0.151098
Epoch 31
Loss = 9.9477e-02, PNorm = 35.4258, GNorm = 2.1856, lr_0 = 2.8937e-04
Loss = 1.3114e-01, PNorm = 35.4370, GNorm = 1.5902, lr_0 = 2.8270e-04
Validation rmse = 0.149692
Epoch 32
Loss = 1.1799e-01, PNorm = 35.4469, GNorm = 1.4366, lr_0 = 2.7617e-04
Loss = 1.1814e-01, PNorm = 35.4553, GNorm = 0.8757, lr_0 = 2.6980e-04
Validation rmse = 0.150746
Epoch 33
Loss = 1.2065e-01, PNorm = 35.4631, GNorm = 3.1732, lr_0 = 2.6357e-04
Validation rmse = 0.149949
Epoch 34
Loss = 8.4662e-02, PNorm = 35.4742, GNorm = 0.7696, lr_0 = 2.5748e-04
Loss = 1.1858e-01, PNorm = 35.4808, GNorm = 2.0535, lr_0 = 2.5154e-04
Validation rmse = 0.149322
Epoch 35
Loss = 9.8124e-02, PNorm = 35.4911, GNorm = 0.9359, lr_0 = 2.4573e-04
Loss = 1.1102e-01, PNorm = 35.4986, GNorm = 1.4034, lr_0 = 2.4006e-04
Validation rmse = 0.149445
Epoch 36
Loss = 1.1034e-01, PNorm = 35.5063, GNorm = 1.8016, lr_0 = 2.3452e-04
Loss = 1.1023e-01, PNorm = 35.5152, GNorm = 0.6526, lr_0 = 2.2911e-04
Validation rmse = 0.153503
Epoch 37
Loss = 1.1497e-01, PNorm = 35.5238, GNorm = 1.6620, lr_0 = 2.2382e-04
Loss = 1.2456e-01, PNorm = 35.5299, GNorm = 0.7787, lr_0 = 2.1865e-04
Validation rmse = 0.149142
Epoch 38
Loss = 1.0402e-01, PNorm = 35.5382, GNorm = 1.1349, lr_0 = 2.1361e-04
Validation rmse = 0.151610
Epoch 39
Loss = 7.8052e-02, PNorm = 35.5459, GNorm = 1.1283, lr_0 = 2.0868e-04
Loss = 1.1236e-01, PNorm = 35.5523, GNorm = 1.6488, lr_0 = 2.0386e-04
Validation rmse = 0.159750
Epoch 40
Loss = 1.0770e-01, PNorm = 35.5596, GNorm = 0.9376, lr_0 = 1.9915e-04
Loss = 1.3070e-01, PNorm = 35.5656, GNorm = 1.5013, lr_0 = 1.9456e-04
Validation rmse = 0.154827
Epoch 41
Loss = 1.1487e-01, PNorm = 35.5729, GNorm = 0.7292, lr_0 = 1.8962e-04
Loss = 1.0600e-01, PNorm = 35.5801, GNorm = 1.3620, lr_0 = 1.8525e-04
Validation rmse = 0.151165
Epoch 42
Loss = 1.1196e-01, PNorm = 35.5851, GNorm = 0.6558, lr_0 = 1.8097e-04
Validation rmse = 0.149619
Epoch 43
Loss = 1.5357e-01, PNorm = 35.5909, GNorm = 0.8249, lr_0 = 1.7679e-04
Loss = 1.0564e-01, PNorm = 35.5967, GNorm = 3.0782, lr_0 = 1.7271e-04
Validation rmse = 0.150620
Epoch 44
Loss = 9.0973e-02, PNorm = 35.6022, GNorm = 1.7138, lr_0 = 1.6873e-04
Loss = 1.0538e-01, PNorm = 35.6089, GNorm = 0.5906, lr_0 = 1.6483e-04
Validation rmse = 0.150797
Epoch 45
Loss = 9.9292e-02, PNorm = 35.6134, GNorm = 0.9772, lr_0 = 1.6103e-04
Loss = 1.0937e-01, PNorm = 35.6178, GNorm = 1.5493, lr_0 = 1.5731e-04
Validation rmse = 0.153355
Epoch 46
Loss = 9.6569e-02, PNorm = 35.6241, GNorm = 1.7523, lr_0 = 1.5368e-04
Loss = 1.0599e-01, PNorm = 35.6293, GNorm = 1.2219, lr_0 = 1.5013e-04
Validation rmse = 0.150438
Epoch 47
Loss = 1.1100e-01, PNorm = 35.6344, GNorm = 3.0462, lr_0 = 1.4667e-04
Validation rmse = 0.150110
Epoch 48
Loss = 1.2882e-01, PNorm = 35.6394, GNorm = 0.7357, lr_0 = 1.4328e-04
Loss = 9.6241e-02, PNorm = 35.6440, GNorm = 1.6557, lr_0 = 1.3997e-04
Validation rmse = 0.153747
Epoch 49
Loss = 1.1662e-01, PNorm = 35.6486, GNorm = 1.0677, lr_0 = 1.3674e-04
Loss = 1.0871e-01, PNorm = 35.6527, GNorm = 3.7029, lr_0 = 1.3359e-04
Validation rmse = 0.151811
Epoch 50
Loss = 1.1498e-01, PNorm = 35.6576, GNorm = 2.0835, lr_0 = 1.3050e-04
Loss = 1.0717e-01, PNorm = 35.6618, GNorm = 3.5252, lr_0 = 1.2749e-04
Validation rmse = 0.154863
Epoch 51
Loss = 1.1752e-01, PNorm = 35.6666, GNorm = 1.2194, lr_0 = 1.2426e-04
Loss = 9.6565e-02, PNorm = 35.6710, GNorm = 1.6008, lr_0 = 1.2139e-04
Validation rmse = 0.151402
Epoch 52
Loss = 9.7693e-02, PNorm = 35.6756, GNorm = 1.0512, lr_0 = 1.1859e-04
Validation rmse = 0.149826
Epoch 53
Loss = 6.9970e-02, PNorm = 35.6793, GNorm = 0.6387, lr_0 = 1.1585e-04
Loss = 1.0389e-01, PNorm = 35.6823, GNorm = 1.0606, lr_0 = 1.1318e-04
Validation rmse = 0.151220
Epoch 54
Loss = 9.1263e-02, PNorm = 35.6860, GNorm = 0.9745, lr_0 = 1.1056e-04
Loss = 1.0504e-01, PNorm = 35.6902, GNorm = 2.6381, lr_0 = 1.0801e-04
Validation rmse = 0.151146
Epoch 55
Loss = 1.0160e-01, PNorm = 35.6932, GNorm = 1.0049, lr_0 = 1.0552e-04
Loss = 9.3434e-02, PNorm = 35.6968, GNorm = 1.9345, lr_0 = 1.0308e-04
Validation rmse = 0.151974
Epoch 56
Loss = 9.0155e-02, PNorm = 35.7010, GNorm = 1.6900, lr_0 = 1.0070e-04
Loss = 1.0590e-01, PNorm = 35.7040, GNorm = 0.8442, lr_0 = 1.0000e-04
Validation rmse = 0.150334
Epoch 57
Loss = 1.0234e-01, PNorm = 35.7070, GNorm = 2.9376, lr_0 = 1.0000e-04
Validation rmse = 0.151000
Epoch 58
Loss = 8.3514e-02, PNorm = 35.7105, GNorm = 0.7086, lr_0 = 1.0000e-04
Loss = 9.7066e-02, PNorm = 35.7143, GNorm = 2.2740, lr_0 = 1.0000e-04
Validation rmse = 0.151482
Epoch 59
Loss = 1.1357e-01, PNorm = 35.7169, GNorm = 0.6844, lr_0 = 1.0000e-04
Loss = 8.7182e-02, PNorm = 35.7201, GNorm = 0.5928, lr_0 = 1.0000e-04
Validation rmse = 0.150727
Model 0 best validation rmse = 0.148123 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.143832
Ensemble test rmse = 0.143832
1-fold cross validation
	Seed 0 ==> test rmse = 0.143832
Overall test rmse = 0.143832 +/- 0.000000
Elapsed time = 0:00:33
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,117 | train size = 888 | val size = 223 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.9362e-01, PNorm = 34.0133, GNorm = 4.2284, lr_0 = 3.9118e-04
Validation rmse = 0.303678
Epoch 1
Loss = 7.9043e-01, PNorm = 34.0405, GNorm = 2.0097, lr_0 = 6.8235e-04
Loss = 6.0678e-01, PNorm = 34.0919, GNorm = 1.1151, lr_0 = 9.4706e-04
Validation rmse = 0.265551
Epoch 2
Loss = 5.1627e-01, PNorm = 34.1496, GNorm = 3.8199, lr_0 = 9.8149e-04
Loss = 4.8519e-01, PNorm = 34.2242, GNorm = 0.9510, lr_0 = 9.5884e-04
Validation rmse = 0.232761
Epoch 3
Loss = 4.3634e-01, PNorm = 34.2815, GNorm = 5.3473, lr_0 = 9.3670e-04
Loss = 4.4456e-01, PNorm = 34.3328, GNorm = 12.0225, lr_0 = 9.1508e-04
Validation rmse = 0.221164
Epoch 4
Loss = 3.6725e-01, PNorm = 34.3836, GNorm = 1.6589, lr_0 = 8.9396e-04
Validation rmse = 0.197308
Epoch 5
Loss = 3.0612e-01, PNorm = 34.4372, GNorm = 4.4382, lr_0 = 8.7129e-04
Loss = 2.6208e-01, PNorm = 34.4891, GNorm = 2.3366, lr_0 = 8.5118e-04
Validation rmse = 0.185932
Epoch 6
Loss = 2.7378e-01, PNorm = 34.5269, GNorm = 1.1163, lr_0 = 8.3153e-04
Loss = 2.5571e-01, PNorm = 34.5733, GNorm = 3.6783, lr_0 = 8.1234e-04
Validation rmse = 0.193778
Epoch 7
Loss = 2.2714e-01, PNorm = 34.6121, GNorm = 3.8844, lr_0 = 7.9359e-04
Loss = 2.3150e-01, PNorm = 34.6514, GNorm = 2.0691, lr_0 = 7.7527e-04
Validation rmse = 0.169777
Epoch 8
Loss = 1.9825e-01, PNorm = 34.6875, GNorm = 0.7171, lr_0 = 7.5737e-04
Validation rmse = 0.170838
Epoch 9
Loss = 2.9782e-01, PNorm = 34.7230, GNorm = 4.9467, lr_0 = 7.3817e-04
Loss = 1.7828e-01, PNorm = 34.7554, GNorm = 2.9063, lr_0 = 7.2113e-04
Validation rmse = 0.160412
Epoch 10
Loss = 1.6535e-01, PNorm = 34.7879, GNorm = 0.5738, lr_0 = 7.0448e-04
Loss = 1.9617e-01, PNorm = 34.8142, GNorm = 3.4620, lr_0 = 6.8822e-04
Validation rmse = 0.158249
Epoch 11
Loss = 2.0349e-01, PNorm = 34.8466, GNorm = 3.4260, lr_0 = 6.7234e-04
Loss = 1.6237e-01, PNorm = 34.8755, GNorm = 0.8270, lr_0 = 6.5682e-04
Validation rmse = 0.159167
Epoch 12
Loss = 1.7266e-01, PNorm = 34.8985, GNorm = 0.9071, lr_0 = 6.4166e-04
Loss = 1.4346e-01, PNorm = 34.9205, GNorm = 0.8474, lr_0 = 6.2685e-04
Loss = 2.7342e-01, PNorm = 34.9223, GNorm = 2.7168, lr_0 = 6.2538e-04
Validation rmse = 0.172902
Epoch 13
Loss = 1.7397e-01, PNorm = 34.9464, GNorm = 0.8968, lr_0 = 6.1095e-04
Validation rmse = 0.156675
Epoch 14
Loss = 1.7075e-01, PNorm = 34.9646, GNorm = 1.4228, lr_0 = 5.9685e-04
Loss = 1.7680e-01, PNorm = 34.9894, GNorm = 2.8021, lr_0 = 5.8307e-04
Validation rmse = 0.158884
Epoch 15
Loss = 1.7315e-01, PNorm = 35.0093, GNorm = 2.6165, lr_0 = 5.6961e-04
Loss = 1.5280e-01, PNorm = 35.0307, GNorm = 2.1263, lr_0 = 5.5646e-04
Validation rmse = 0.152237
Epoch 16
Loss = 1.7697e-01, PNorm = 35.0468, GNorm = 3.2573, lr_0 = 5.4362e-04
Loss = 1.6497e-01, PNorm = 35.0661, GNorm = 6.6679, lr_0 = 5.3107e-04
Validation rmse = 0.177339
Epoch 17
Loss = 1.7806e-01, PNorm = 35.0910, GNorm = 2.8015, lr_0 = 5.1760e-04
Validation rmse = 0.155090
Epoch 18
Loss = 9.9931e-02, PNorm = 35.1111, GNorm = 0.9937, lr_0 = 5.0565e-04
Loss = 1.4893e-01, PNorm = 35.1293, GNorm = 2.7456, lr_0 = 4.9398e-04
Validation rmse = 0.155260
Epoch 19
Loss = 1.5587e-01, PNorm = 35.1422, GNorm = 1.6686, lr_0 = 4.8258e-04
Loss = 1.4173e-01, PNorm = 35.1595, GNorm = 1.9059, lr_0 = 4.7144e-04
Validation rmse = 0.153254
Epoch 20
Loss = 1.2150e-01, PNorm = 35.1767, GNorm = 0.6361, lr_0 = 4.6056e-04
Loss = 1.2512e-01, PNorm = 35.1924, GNorm = 1.1056, lr_0 = 4.4993e-04
Validation rmse = 0.155990
Epoch 21
Loss = 1.3875e-01, PNorm = 35.2069, GNorm = 2.1732, lr_0 = 4.3852e-04
Loss = 1.3567e-01, PNorm = 35.2212, GNorm = 4.7860, lr_0 = 4.2840e-04
Validation rmse = 0.149287
Epoch 22
Loss = 1.3290e-01, PNorm = 35.2346, GNorm = 2.7788, lr_0 = 4.1851e-04
Validation rmse = 0.155163
Epoch 23
Loss = 1.3724e-01, PNorm = 35.2508, GNorm = 4.0278, lr_0 = 4.0885e-04
Loss = 1.2611e-01, PNorm = 35.2656, GNorm = 0.7007, lr_0 = 3.9941e-04
Validation rmse = 0.162315
Epoch 24
Loss = 1.0549e-01, PNorm = 35.2769, GNorm = 3.1010, lr_0 = 3.9019e-04
Loss = 1.3672e-01, PNorm = 35.2859, GNorm = 4.1971, lr_0 = 3.8119e-04
Validation rmse = 0.155914
Epoch 25
Loss = 1.2335e-01, PNorm = 35.2993, GNorm = 1.8551, lr_0 = 3.7239e-04
Loss = 1.2738e-01, PNorm = 35.3114, GNorm = 4.3385, lr_0 = 3.6379e-04
Validation rmse = 0.149719
Epoch 26
Loss = 1.1883e-01, PNorm = 35.3262, GNorm = 0.8059, lr_0 = 3.5456e-04
Validation rmse = 0.152478
Epoch 27
Loss = 8.8094e-02, PNorm = 35.3366, GNorm = 2.1777, lr_0 = 3.4638e-04
Loss = 1.2303e-01, PNorm = 35.3497, GNorm = 0.8043, lr_0 = 3.3839e-04
Validation rmse = 0.152258
Epoch 28
Loss = 1.0471e-01, PNorm = 35.3587, GNorm = 0.8902, lr_0 = 3.3057e-04
Loss = 1.1849e-01, PNorm = 35.3685, GNorm = 1.1932, lr_0 = 3.2294e-04
Validation rmse = 0.155106
Epoch 29
Loss = 1.1639e-01, PNorm = 35.3768, GNorm = 1.6685, lr_0 = 3.1549e-04
Loss = 1.1166e-01, PNorm = 35.3878, GNorm = 1.5183, lr_0 = 3.0821e-04
Validation rmse = 0.162870
Epoch 30
Loss = 1.1182e-01, PNorm = 35.3996, GNorm = 0.8006, lr_0 = 3.0039e-04
Loss = 1.1991e-01, PNorm = 35.4091, GNorm = 0.8077, lr_0 = 2.9346e-04
Validation rmse = 0.150206
Epoch 31
Loss = 1.1851e-01, PNorm = 35.4189, GNorm = 0.7050, lr_0 = 2.8668e-04
Validation rmse = 0.151672
Epoch 32
Loss = 7.0897e-02, PNorm = 35.4296, GNorm = 1.3829, lr_0 = 2.8007e-04
Loss = 9.5718e-02, PNorm = 35.4370, GNorm = 3.0639, lr_0 = 2.7360e-04
Validation rmse = 0.154973
Epoch 33
Loss = 1.0797e-01, PNorm = 35.4461, GNorm = 1.8318, lr_0 = 2.6729e-04
Loss = 1.1172e-01, PNorm = 35.4532, GNorm = 1.3150, lr_0 = 2.6112e-04
Validation rmse = 0.154593
Epoch 34
Loss = 1.1003e-01, PNorm = 35.4642, GNorm = 0.7258, lr_0 = 2.5450e-04
Loss = 1.0995e-01, PNorm = 35.4736, GNorm = 0.5546, lr_0 = 2.4862e-04
Validation rmse = 0.150585
Epoch 35
Loss = 1.1838e-01, PNorm = 35.4793, GNorm = 5.2232, lr_0 = 2.4288e-04
Validation rmse = 0.163331
Epoch 36
Loss = 1.8644e-01, PNorm = 35.4879, GNorm = 3.9015, lr_0 = 2.3728e-04
Loss = 9.3339e-02, PNorm = 35.4975, GNorm = 1.0174, lr_0 = 2.3180e-04
Validation rmse = 0.153451
Epoch 37
Loss = 9.8329e-02, PNorm = 35.5058, GNorm = 0.9282, lr_0 = 2.2645e-04
Loss = 1.0387e-01, PNorm = 35.5137, GNorm = 1.9201, lr_0 = 2.2122e-04
Validation rmse = 0.150790
Epoch 38
Loss = 8.7398e-02, PNorm = 35.5211, GNorm = 1.6138, lr_0 = 2.1561e-04
Loss = 1.1675e-01, PNorm = 35.5277, GNorm = 0.7551, lr_0 = 2.1063e-04
Validation rmse = 0.150078
Epoch 39
Loss = 1.0762e-01, PNorm = 35.5326, GNorm = 1.2010, lr_0 = 2.0577e-04
Loss = 9.9103e-02, PNorm = 35.5392, GNorm = 2.1310, lr_0 = 2.0102e-04
Validation rmse = 0.156130
Epoch 40
Loss = 9.8203e-02, PNorm = 35.5465, GNorm = 1.1699, lr_0 = 1.9638e-04
Validation rmse = 0.153320
Epoch 41
Loss = 7.3908e-02, PNorm = 35.5533, GNorm = 1.5957, lr_0 = 1.9185e-04
Loss = 1.0950e-01, PNorm = 35.5595, GNorm = 3.1058, lr_0 = 1.8742e-04
Validation rmse = 0.155069
Epoch 42
Loss = 1.2049e-01, PNorm = 35.5656, GNorm = 3.0064, lr_0 = 1.8267e-04
Loss = 1.0087e-01, PNorm = 35.5724, GNorm = 0.9422, lr_0 = 1.7845e-04
Validation rmse = 0.150465
Epoch 43
Loss = 1.0525e-01, PNorm = 35.5790, GNorm = 0.5345, lr_0 = 1.7433e-04
Loss = 9.9276e-02, PNorm = 35.5852, GNorm = 1.0243, lr_0 = 1.7031e-04
Validation rmse = 0.152549
Epoch 44
Loss = 9.6636e-02, PNorm = 35.5912, GNorm = 1.4029, lr_0 = 1.6638e-04
Validation rmse = 0.152477
Epoch 45
Loss = 8.2125e-02, PNorm = 35.5950, GNorm = 0.7924, lr_0 = 1.6254e-04
Loss = 1.1440e-01, PNorm = 35.6004, GNorm = 1.3556, lr_0 = 1.5879e-04
Validation rmse = 0.150751
Epoch 46
Loss = 8.7632e-02, PNorm = 35.6063, GNorm = 1.3230, lr_0 = 1.5476e-04
Loss = 1.1224e-01, PNorm = 35.6116, GNorm = 0.8578, lr_0 = 1.5119e-04
Validation rmse = 0.153009
Epoch 47
Loss = 1.0412e-01, PNorm = 35.6165, GNorm = 2.1636, lr_0 = 1.4770e-04
Loss = 9.4674e-02, PNorm = 35.6207, GNorm = 2.3450, lr_0 = 1.4429e-04
Validation rmse = 0.153306
Epoch 48
Loss = 9.8035e-02, PNorm = 35.6254, GNorm = 1.5166, lr_0 = 1.4096e-04
Loss = 9.6785e-02, PNorm = 35.6305, GNorm = 1.0718, lr_0 = 1.3770e-04
Validation rmse = 0.151220
Epoch 49
Loss = 9.7464e-02, PNorm = 35.6335, GNorm = 2.2681, lr_0 = 1.3453e-04
Validation rmse = 0.151865
Epoch 50
Loss = 8.0990e-02, PNorm = 35.6378, GNorm = 0.8065, lr_0 = 1.3142e-04
Loss = 1.0057e-01, PNorm = 35.6421, GNorm = 2.1921, lr_0 = 1.2839e-04
Validation rmse = 0.148947
Epoch 51
Loss = 1.1217e-01, PNorm = 35.6467, GNorm = 3.2256, lr_0 = 1.2513e-04
Loss = 9.2306e-02, PNorm = 35.6507, GNorm = 2.6670, lr_0 = 1.2224e-04
Validation rmse = 0.154123
Epoch 52
Loss = 9.3020e-02, PNorm = 35.6549, GNorm = 1.6593, lr_0 = 1.1942e-04
Loss = 1.0697e-01, PNorm = 35.6578, GNorm = 3.2972, lr_0 = 1.1666e-04
Validation rmse = 0.153338
Epoch 53
Loss = 9.4808e-02, PNorm = 35.6635, GNorm = 1.9918, lr_0 = 1.1397e-04
Validation rmse = 0.151244
Epoch 54
Loss = 6.1994e-02, PNorm = 35.6668, GNorm = 0.8930, lr_0 = 1.1134e-04
Loss = 1.0925e-01, PNorm = 35.6687, GNorm = 2.3686, lr_0 = 1.0877e-04
Validation rmse = 0.149994
Epoch 55
Loss = 1.0666e-01, PNorm = 35.6740, GNorm = 0.8693, lr_0 = 1.0601e-04
Loss = 1.0430e-01, PNorm = 35.6782, GNorm = 1.5943, lr_0 = 1.0356e-04
Validation rmse = 0.152285
Epoch 56
Loss = 9.1733e-02, PNorm = 35.6809, GNorm = 1.8399, lr_0 = 1.0117e-04
Loss = 9.7855e-02, PNorm = 35.6836, GNorm = 2.0754, lr_0 = 1.0000e-04
Validation rmse = 0.150090
Epoch 57
Loss = 9.4440e-02, PNorm = 35.6874, GNorm = 1.5413, lr_0 = 1.0000e-04
Loss = 9.2109e-02, PNorm = 35.6908, GNorm = 1.0958, lr_0 = 1.0000e-04
Validation rmse = 0.151973
Epoch 58
Loss = 9.3971e-02, PNorm = 35.6939, GNorm = 0.8321, lr_0 = 1.0000e-04
Validation rmse = 0.152390
Epoch 59
Loss = 9.5206e-02, PNorm = 35.6971, GNorm = 1.3340, lr_0 = 1.0000e-04
Loss = 9.3491e-02, PNorm = 35.7001, GNorm = 1.2439, lr_0 = 1.0000e-04
Validation rmse = 0.151518
Model 0 best validation rmse = 0.148947 on epoch 50
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.136863
Ensemble test rmse = 0.136863
1-fold cross validation
	Seed 0 ==> test rmse = 0.136863
Overall test rmse = 0.136863 +/- 0.000000
Elapsed time = 0:00:32
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,107 | train size = 880 | val size = 221 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.2543e-01, PNorm = 34.0159, GNorm = 2.2295, lr_0 = 3.9118e-04
Validation rmse = 0.265916
Epoch 1
Loss = 6.8940e-01, PNorm = 34.0436, GNorm = 1.3479, lr_0 = 6.8235e-04
Loss = 6.0633e-01, PNorm = 34.0960, GNorm = 2.7042, lr_0 = 9.4706e-04
Validation rmse = 0.238912
Epoch 2
Loss = 5.2260e-01, PNorm = 34.1750, GNorm = 6.8259, lr_0 = 9.8149e-04
Loss = 4.2273e-01, PNorm = 34.2395, GNorm = 3.9581, lr_0 = 9.5884e-04
Validation rmse = 0.272765
Epoch 3
Loss = 4.6816e-01, PNorm = 34.3019, GNorm = 11.0225, lr_0 = 9.3452e-04
Loss = 4.6700e-01, PNorm = 34.3585, GNorm = 3.8987, lr_0 = 9.1295e-04
Validation rmse = 0.231615
Epoch 4
Loss = 4.6343e-01, PNorm = 34.4052, GNorm = 1.0661, lr_0 = 8.9188e-04
Validation rmse = 0.208178
Epoch 5
Loss = 3.8199e-01, PNorm = 34.4503, GNorm = 1.4075, lr_0 = 8.7129e-04
Loss = 2.8192e-01, PNorm = 34.4958, GNorm = 3.2586, lr_0 = 8.5118e-04
Validation rmse = 0.185845
Epoch 6
Loss = 2.7403e-01, PNorm = 34.5510, GNorm = 4.4375, lr_0 = 8.2959e-04
Loss = 2.5358e-01, PNorm = 34.5907, GNorm = 3.1148, lr_0 = 8.1044e-04
Validation rmse = 0.182052
Epoch 7
Loss = 2.6123e-01, PNorm = 34.6282, GNorm = 1.8860, lr_0 = 7.9174e-04
Loss = 2.1102e-01, PNorm = 34.6650, GNorm = 1.9974, lr_0 = 7.7346e-04
Loss = 9.2833e-02, PNorm = 34.6689, GNorm = 0.7744, lr_0 = 7.7166e-04
Validation rmse = 0.161221
Epoch 8
Loss = 1.8687e-01, PNorm = 34.7068, GNorm = 1.6525, lr_0 = 7.5384e-04
Validation rmse = 0.186960
Epoch 9
Loss = 2.4419e-01, PNorm = 34.7424, GNorm = 5.1149, lr_0 = 7.3644e-04
Loss = 2.1977e-01, PNorm = 34.7764, GNorm = 1.2721, lr_0 = 7.1945e-04
Validation rmse = 0.161670
Epoch 10
Loss = 2.0270e-01, PNorm = 34.8051, GNorm = 2.1907, lr_0 = 7.0284e-04
Loss = 1.9180e-01, PNorm = 34.8317, GNorm = 0.9020, lr_0 = 6.8662e-04
Validation rmse = 0.163297
Epoch 11
Loss = 1.8155e-01, PNorm = 34.8581, GNorm = 1.3246, lr_0 = 6.6920e-04
Loss = 1.8147e-01, PNorm = 34.8850, GNorm = 1.2951, lr_0 = 6.5376e-04
Validation rmse = 0.170223
Epoch 12
Loss = 1.7814e-01, PNorm = 34.9106, GNorm = 2.7025, lr_0 = 6.3867e-04
Validation rmse = 0.155306
Epoch 13
Loss = 1.1789e-01, PNorm = 34.9388, GNorm = 0.5422, lr_0 = 6.2247e-04
Loss = 1.7125e-01, PNorm = 34.9591, GNorm = 3.1446, lr_0 = 6.0810e-04
Validation rmse = 0.155889
Epoch 14
Loss = 1.4780e-01, PNorm = 34.9795, GNorm = 1.0355, lr_0 = 5.9406e-04
Loss = 1.4297e-01, PNorm = 34.9998, GNorm = 0.7072, lr_0 = 5.8035e-04
Validation rmse = 0.158491
Epoch 15
Loss = 1.3580e-01, PNorm = 35.0170, GNorm = 1.1125, lr_0 = 5.6696e-04
Loss = 1.5716e-01, PNorm = 35.0386, GNorm = 2.3187, lr_0 = 5.5387e-04
Validation rmse = 0.172266
Epoch 16
Loss = 1.4783e-01, PNorm = 35.0626, GNorm = 0.6314, lr_0 = 5.3982e-04
Validation rmse = 0.159643
Epoch 17
Loss = 1.6439e-01, PNorm = 35.0782, GNorm = 1.1232, lr_0 = 5.2736e-04
Loss = 1.4000e-01, PNorm = 35.0963, GNorm = 1.1513, lr_0 = 5.1519e-04
Validation rmse = 0.153323
Epoch 18
Loss = 1.5913e-01, PNorm = 35.1201, GNorm = 5.3265, lr_0 = 5.0212e-04
Loss = 1.4131e-01, PNorm = 35.1403, GNorm = 4.5197, lr_0 = 4.9053e-04
Validation rmse = 0.160892
Epoch 19
Loss = 1.2631e-01, PNorm = 35.1625, GNorm = 1.9060, lr_0 = 4.7921e-04
Loss = 1.4605e-01, PNorm = 35.1794, GNorm = 2.5902, lr_0 = 4.6815e-04
Validation rmse = 0.166319
Epoch 20
Loss = 1.5068e-01, PNorm = 35.1984, GNorm = 2.4749, lr_0 = 4.5734e-04
Validation rmse = 0.155606
Epoch 21
Loss = 1.1511e-01, PNorm = 35.2147, GNorm = 2.7207, lr_0 = 4.4575e-04
Loss = 1.2573e-01, PNorm = 35.2282, GNorm = 0.8670, lr_0 = 4.3546e-04
Validation rmse = 0.153043
Epoch 22
Loss = 1.0527e-01, PNorm = 35.2444, GNorm = 1.0140, lr_0 = 4.2541e-04
Loss = 1.1967e-01, PNorm = 35.2604, GNorm = 1.4608, lr_0 = 4.1559e-04
Validation rmse = 0.153795
Epoch 23
Loss = 9.8669e-02, PNorm = 35.2718, GNorm = 0.4587, lr_0 = 4.0505e-04
Loss = 1.2934e-01, PNorm = 35.2847, GNorm = 1.5272, lr_0 = 3.9570e-04
Validation rmse = 0.155347
Epoch 24
Loss = 1.0716e-01, PNorm = 35.3022, GNorm = 1.0373, lr_0 = 3.8656e-04
Loss = 1.1748e-01, PNorm = 35.3150, GNorm = 3.4409, lr_0 = 3.7764e-04
Validation rmse = 0.157430
Epoch 25
Loss = 1.0963e-01, PNorm = 35.3283, GNorm = 1.7437, lr_0 = 3.6892e-04
Validation rmse = 0.165793
Epoch 26
Loss = 1.5001e-01, PNorm = 35.3436, GNorm = 6.6045, lr_0 = 3.5957e-04
Loss = 1.1736e-01, PNorm = 35.3561, GNorm = 2.1407, lr_0 = 3.5127e-04
Validation rmse = 0.157182
Epoch 27
Loss = 1.1212e-01, PNorm = 35.3676, GNorm = 1.8881, lr_0 = 3.4316e-04
Loss = 1.0812e-01, PNorm = 35.3787, GNorm = 1.3356, lr_0 = 3.3524e-04
Validation rmse = 0.158243
Epoch 28
Loss = 1.1513e-01, PNorm = 35.3938, GNorm = 1.0407, lr_0 = 3.2674e-04
Loss = 9.7340e-02, PNorm = 35.4051, GNorm = 0.8939, lr_0 = 3.1920e-04
Validation rmse = 0.157774
Epoch 29
Loss = 1.0100e-01, PNorm = 35.4155, GNorm = 0.5531, lr_0 = 3.1183e-04
Validation rmse = 0.170061
Epoch 30
Loss = 1.2979e-01, PNorm = 35.4260, GNorm = 2.3583, lr_0 = 3.0463e-04
Loss = 1.1136e-01, PNorm = 35.4354, GNorm = 2.0875, lr_0 = 2.9760e-04
Validation rmse = 0.158881
Epoch 31
Loss = 1.0436e-01, PNorm = 35.4494, GNorm = 0.9383, lr_0 = 2.9005e-04
Loss = 1.0032e-01, PNorm = 35.4600, GNorm = 0.8962, lr_0 = 2.8336e-04
Validation rmse = 0.160558
Epoch 32
Loss = 8.5115e-02, PNorm = 35.4699, GNorm = 0.9854, lr_0 = 2.7682e-04
Loss = 1.0688e-01, PNorm = 35.4809, GNorm = 0.7568, lr_0 = 2.7043e-04
Loss = 1.1207e-01, PNorm = 35.4817, GNorm = 1.1214, lr_0 = 2.6980e-04
Validation rmse = 0.163694
Epoch 33
Loss = 9.8489e-02, PNorm = 35.4912, GNorm = 0.7306, lr_0 = 2.6357e-04
Validation rmse = 0.156037
Epoch 34
Loss = 1.2892e-01, PNorm = 35.5001, GNorm = 0.6574, lr_0 = 2.5748e-04
Loss = 8.3948e-02, PNorm = 35.5076, GNorm = 1.0878, lr_0 = 2.5154e-04
Validation rmse = 0.161300
Epoch 35
Loss = 8.8638e-02, PNorm = 35.5156, GNorm = 0.5241, lr_0 = 2.4573e-04
Loss = 9.8268e-02, PNorm = 35.5245, GNorm = 1.2540, lr_0 = 2.4006e-04
Validation rmse = 0.157462
Epoch 36
Loss = 1.1089e-01, PNorm = 35.5323, GNorm = 0.9845, lr_0 = 2.3397e-04
Loss = 9.0350e-02, PNorm = 35.5416, GNorm = 1.1562, lr_0 = 2.2857e-04
Validation rmse = 0.162110
Epoch 37
Loss = 7.8521e-02, PNorm = 35.5470, GNorm = 1.2392, lr_0 = 2.2330e-04
Validation rmse = 0.159413
Epoch 38
Loss = 1.1742e-01, PNorm = 35.5568, GNorm = 0.8703, lr_0 = 2.1763e-04
Loss = 8.7887e-02, PNorm = 35.5636, GNorm = 0.5130, lr_0 = 2.1261e-04
Validation rmse = 0.160080
Epoch 39
Loss = 8.8288e-02, PNorm = 35.5707, GNorm = 0.7624, lr_0 = 2.0770e-04
Loss = 1.0136e-01, PNorm = 35.5767, GNorm = 1.2914, lr_0 = 2.0291e-04
Validation rmse = 0.157264
Epoch 40
Loss = 8.6713e-02, PNorm = 35.5829, GNorm = 0.6589, lr_0 = 1.9823e-04
Loss = 9.0753e-02, PNorm = 35.5891, GNorm = 0.8733, lr_0 = 1.9365e-04
Validation rmse = 0.161313
Epoch 41
Loss = 8.9784e-02, PNorm = 35.5961, GNorm = 0.4296, lr_0 = 1.8874e-04
Validation rmse = 0.157995
Epoch 42
Loss = 9.8635e-02, PNorm = 35.6023, GNorm = 1.2844, lr_0 = 1.8438e-04
Loss = 9.1464e-02, PNorm = 35.6079, GNorm = 1.1742, lr_0 = 1.8013e-04
Validation rmse = 0.158512
Epoch 43
Loss = 8.9730e-02, PNorm = 35.6139, GNorm = 1.1581, lr_0 = 1.7556e-04
Loss = 9.5356e-02, PNorm = 35.6207, GNorm = 1.0050, lr_0 = 1.7151e-04
Validation rmse = 0.159877
Epoch 44
Loss = 8.9368e-02, PNorm = 35.6258, GNorm = 1.8406, lr_0 = 1.6755e-04
Loss = 9.4508e-02, PNorm = 35.6309, GNorm = 0.9402, lr_0 = 1.6368e-04
Validation rmse = 0.156718
Epoch 45
Loss = 9.2747e-02, PNorm = 35.6362, GNorm = 0.7849, lr_0 = 1.5990e-04
Validation rmse = 0.160663
Epoch 46
Loss = 8.5400e-02, PNorm = 35.6436, GNorm = 0.5775, lr_0 = 1.5585e-04
Loss = 9.0863e-02, PNorm = 35.6475, GNorm = 2.3755, lr_0 = 1.5225e-04
Validation rmse = 0.159149
Epoch 47
Loss = 1.0661e-01, PNorm = 35.6533, GNorm = 0.6338, lr_0 = 1.4874e-04
Loss = 7.6537e-02, PNorm = 35.6578, GNorm = 2.3329, lr_0 = 1.4530e-04
Validation rmse = 0.162957
Epoch 48
Loss = 7.9433e-02, PNorm = 35.6627, GNorm = 1.1668, lr_0 = 1.4162e-04
Loss = 9.3102e-02, PNorm = 35.6670, GNorm = 0.6491, lr_0 = 1.3835e-04
Validation rmse = 0.159611
Epoch 49
Loss = 7.9501e-02, PNorm = 35.6713, GNorm = 1.0102, lr_0 = 1.3515e-04
Loss = 8.7858e-02, PNorm = 35.6762, GNorm = 1.5606, lr_0 = 1.3204e-04
Validation rmse = 0.159376
Epoch 50
Loss = 8.8579e-02, PNorm = 35.6800, GNorm = 2.0917, lr_0 = 1.2899e-04
Validation rmse = 0.158184
Epoch 51
Loss = 8.1676e-02, PNorm = 35.6849, GNorm = 1.5269, lr_0 = 1.2572e-04
Loss = 8.0967e-02, PNorm = 35.6888, GNorm = 0.9400, lr_0 = 1.2281e-04
Validation rmse = 0.158812
Epoch 52
Loss = 7.8388e-02, PNorm = 35.6921, GNorm = 0.5156, lr_0 = 1.1998e-04
Loss = 9.0745e-02, PNorm = 35.6959, GNorm = 1.1482, lr_0 = 1.1721e-04
Validation rmse = 0.158728
Epoch 53
Loss = 7.5442e-02, PNorm = 35.7003, GNorm = 0.5408, lr_0 = 1.1424e-04
Loss = 8.7261e-02, PNorm = 35.7039, GNorm = 1.2324, lr_0 = 1.1160e-04
Validation rmse = 0.160911
Epoch 54
Loss = 8.7304e-02, PNorm = 35.7079, GNorm = 2.7632, lr_0 = 1.0902e-04
Validation rmse = 0.160233
Epoch 55
Loss = 7.2849e-02, PNorm = 35.7112, GNorm = 1.9423, lr_0 = 1.0651e-04
Loss = 7.8780e-02, PNorm = 35.7148, GNorm = 1.1156, lr_0 = 1.0405e-04
Validation rmse = 0.158634
Epoch 56
Loss = 8.0552e-02, PNorm = 35.7178, GNorm = 2.0959, lr_0 = 1.0141e-04
Loss = 8.5501e-02, PNorm = 35.7218, GNorm = 0.5799, lr_0 = 1.0000e-04
Validation rmse = 0.160131
Epoch 57
Loss = 7.4738e-02, PNorm = 35.7247, GNorm = 1.2639, lr_0 = 1.0000e-04
Loss = 8.8086e-02, PNorm = 35.7270, GNorm = 0.8538, lr_0 = 1.0000e-04
Loss = 5.6102e-02, PNorm = 35.7272, GNorm = 1.7803, lr_0 = 1.0000e-04
Validation rmse = 0.162109
Epoch 58
Loss = 8.0256e-02, PNorm = 35.7313, GNorm = 1.5211, lr_0 = 1.0000e-04
Validation rmse = 0.162253
Epoch 59
Loss = 7.8174e-02, PNorm = 35.7341, GNorm = 0.7926, lr_0 = 1.0000e-04
Loss = 7.9788e-02, PNorm = 35.7370, GNorm = 2.2541, lr_0 = 1.0000e-04
Validation rmse = 0.159904
Model 0 best validation rmse = 0.153043 on epoch 21
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.179543
Ensemble test rmse = 0.179543
1-fold cross validation
	Seed 0 ==> test rmse = 0.179543
Overall test rmse = 0.179543 +/- 0.000000
Elapsed time = 0:00:31
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,097 | train size = 872 | val size = 219 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.6844e-01, PNorm = 34.0173, GNorm = 3.0120, lr_0 = 3.9118e-04
Validation rmse = 0.304800
Epoch 1
Loss = 8.6977e-01, PNorm = 34.0468, GNorm = 13.7490, lr_0 = 6.8235e-04
Loss = 5.1564e-01, PNorm = 34.0914, GNorm = 1.6828, lr_0 = 9.4706e-04
Validation rmse = 0.369735
Epoch 2
Loss = 8.3260e-01, PNorm = 34.1548, GNorm = 1.2653, lr_0 = 9.7920e-04
Loss = 5.6039e-01, PNorm = 34.2159, GNorm = 1.6575, lr_0 = 9.5660e-04
Validation rmse = 0.243841
Epoch 3
Loss = 4.2509e-01, PNorm = 34.2772, GNorm = 2.3152, lr_0 = 9.3452e-04
Validation rmse = 0.219074
Epoch 4
Loss = 3.9929e-01, PNorm = 34.3380, GNorm = 2.7345, lr_0 = 9.1082e-04
Loss = 3.1631e-01, PNorm = 34.3881, GNorm = 1.1633, lr_0 = 8.8980e-04
Validation rmse = 0.200213
Epoch 5
Loss = 3.3443e-01, PNorm = 34.4332, GNorm = 3.9524, lr_0 = 8.6926e-04
Loss = 2.5274e-01, PNorm = 34.4790, GNorm = 4.3589, lr_0 = 8.4919e-04
Validation rmse = 0.212940
Epoch 6
Loss = 3.0632e-01, PNorm = 34.5243, GNorm = 1.1645, lr_0 = 8.2766e-04
Loss = 2.2175e-01, PNorm = 34.5652, GNorm = 2.3835, lr_0 = 8.0855e-04
Validation rmse = 0.179673
Epoch 7
Loss = 2.5148e-01, PNorm = 34.6058, GNorm = 2.7330, lr_0 = 7.8989e-04
Validation rmse = 0.185808
Epoch 8
Loss = 2.4471e-01, PNorm = 34.6414, GNorm = 3.3509, lr_0 = 7.6986e-04
Loss = 2.0403e-01, PNorm = 34.6789, GNorm = 2.7679, lr_0 = 7.5209e-04
Validation rmse = 0.165323
Epoch 9
Loss = 1.5926e-01, PNorm = 34.7123, GNorm = 1.0601, lr_0 = 7.3301e-04
Loss = 1.7768e-01, PNorm = 34.7457, GNorm = 1.2067, lr_0 = 7.1609e-04
Validation rmse = 0.163216
Epoch 10
Loss = 1.6330e-01, PNorm = 34.7767, GNorm = 1.4648, lr_0 = 6.9956e-04
Loss = 1.6139e-01, PNorm = 34.8043, GNorm = 1.1731, lr_0 = 6.8342e-04
Validation rmse = 0.160736
Epoch 11
Loss = 1.6049e-01, PNorm = 34.8333, GNorm = 1.5142, lr_0 = 6.6608e-04
Validation rmse = 0.168634
Epoch 12
Loss = 2.0261e-01, PNorm = 34.8604, GNorm = 2.8856, lr_0 = 6.5071e-04
Loss = 1.6050e-01, PNorm = 34.8838, GNorm = 1.0518, lr_0 = 6.3569e-04
Validation rmse = 0.158634
Epoch 13
Loss = 1.3045e-01, PNorm = 34.9122, GNorm = 0.8270, lr_0 = 6.1957e-04
Loss = 1.6309e-01, PNorm = 34.9261, GNorm = 3.8906, lr_0 = 6.0527e-04
Validation rmse = 0.159511
Epoch 14
Loss = 1.3100e-01, PNorm = 34.9474, GNorm = 1.6083, lr_0 = 5.9130e-04
Loss = 1.5704e-01, PNorm = 34.9683, GNorm = 4.3181, lr_0 = 5.7765e-04
Validation rmse = 0.161705
Epoch 15
Loss = 1.3215e-01, PNorm = 34.9912, GNorm = 1.6104, lr_0 = 5.6300e-04
Validation rmse = 0.156213
Epoch 16
Loss = 1.5001e-01, PNorm = 35.0047, GNorm = 1.9692, lr_0 = 5.5000e-04
Loss = 1.4058e-01, PNorm = 35.0236, GNorm = 1.4623, lr_0 = 5.3731e-04
Validation rmse = 0.157947
Epoch 17
Loss = 1.2897e-01, PNorm = 35.0424, GNorm = 3.0320, lr_0 = 5.2368e-04
Loss = 1.2141e-01, PNorm = 35.0578, GNorm = 1.0421, lr_0 = 5.1159e-04
Validation rmse = 0.155997
Epoch 18
Loss = 1.3999e-01, PNorm = 35.0818, GNorm = 1.3248, lr_0 = 4.9862e-04
Loss = 1.2386e-01, PNorm = 35.0953, GNorm = 1.3872, lr_0 = 4.8711e-04
Validation rmse = 0.156425
Epoch 19
Loss = 1.3226e-01, PNorm = 35.1118, GNorm = 1.2110, lr_0 = 4.7587e-04
Validation rmse = 0.154680
Epoch 20
Loss = 8.3775e-02, PNorm = 35.1275, GNorm = 2.0719, lr_0 = 4.6380e-04
Loss = 1.3873e-01, PNorm = 35.1415, GNorm = 1.3160, lr_0 = 4.5309e-04
Validation rmse = 0.153803
Epoch 21
Loss = 1.1267e-01, PNorm = 35.1546, GNorm = 0.8304, lr_0 = 4.4263e-04
Loss = 1.1678e-01, PNorm = 35.1673, GNorm = 1.0142, lr_0 = 4.3242e-04
Validation rmse = 0.152361
Epoch 22
Loss = 1.2940e-01, PNorm = 35.1827, GNorm = 0.8897, lr_0 = 4.2145e-04
Loss = 1.0740e-01, PNorm = 35.1948, GNorm = 0.8676, lr_0 = 4.1172e-04
Validation rmse = 0.154985
Epoch 23
Loss = 1.2339e-01, PNorm = 35.2079, GNorm = 2.0917, lr_0 = 4.0222e-04
Validation rmse = 0.156903
Epoch 24
Loss = 1.0483e-01, PNorm = 35.2206, GNorm = 2.1264, lr_0 = 3.9202e-04
Loss = 1.2745e-01, PNorm = 35.2320, GNorm = 2.7946, lr_0 = 3.8297e-04
Validation rmse = 0.153703
Epoch 25
Loss = 9.4882e-02, PNorm = 35.2454, GNorm = 0.7469, lr_0 = 3.7413e-04
Loss = 1.1554e-01, PNorm = 35.2546, GNorm = 2.2461, lr_0 = 3.6549e-04
Validation rmse = 0.151503
Epoch 26
Loss = 1.0362e-01, PNorm = 35.2691, GNorm = 0.8703, lr_0 = 3.5622e-04
Loss = 1.1245e-01, PNorm = 35.2792, GNorm = 2.9823, lr_0 = 3.4800e-04
Loss = 9.8441e-02, PNorm = 35.2800, GNorm = 1.3483, lr_0 = 3.4719e-04
Validation rmse = 0.151114
Epoch 27
Loss = 1.1329e-01, PNorm = 35.2907, GNorm = 0.8454, lr_0 = 3.3918e-04
Validation rmse = 0.151470
Epoch 28
Loss = 9.3481e-02, PNorm = 35.3007, GNorm = 1.1289, lr_0 = 3.3135e-04
Loss = 1.1725e-01, PNorm = 35.3105, GNorm = 0.7754, lr_0 = 3.2370e-04
Validation rmse = 0.152067
Epoch 29
Loss = 1.2213e-01, PNorm = 35.3253, GNorm = 3.2536, lr_0 = 3.1549e-04
Loss = 1.1009e-01, PNorm = 35.3336, GNorm = 1.2645, lr_0 = 3.0821e-04
Validation rmse = 0.150169
Epoch 30
Loss = 1.0804e-01, PNorm = 35.3416, GNorm = 0.5990, lr_0 = 3.0109e-04
Loss = 1.0669e-01, PNorm = 35.3521, GNorm = 2.7232, lr_0 = 2.9414e-04
Loss = 1.2146e-01, PNorm = 35.3526, GNorm = 1.8722, lr_0 = 2.9346e-04
Validation rmse = 0.149636
Epoch 31
Loss = 1.1436e-01, PNorm = 35.3611, GNorm = 0.8941, lr_0 = 2.8668e-04
Validation rmse = 0.149004
Epoch 32
Loss = 6.3733e-02, PNorm = 35.3705, GNorm = 0.7047, lr_0 = 2.8007e-04
Loss = 9.6305e-02, PNorm = 35.3771, GNorm = 0.9240, lr_0 = 2.7360e-04
Validation rmse = 0.151204
Epoch 33
Loss = 1.0568e-01, PNorm = 35.3853, GNorm = 0.6535, lr_0 = 2.6666e-04
Loss = 1.0187e-01, PNorm = 35.3946, GNorm = 2.0318, lr_0 = 2.6051e-04
Validation rmse = 0.151154
Epoch 34
Loss = 1.1948e-01, PNorm = 35.4065, GNorm = 3.2698, lr_0 = 2.5390e-04
Loss = 1.0314e-01, PNorm = 35.4135, GNorm = 1.2864, lr_0 = 2.4804e-04
Validation rmse = 0.152182
Epoch 35
Loss = 9.9511e-02, PNorm = 35.4210, GNorm = 1.6566, lr_0 = 2.4232e-04
Validation rmse = 0.148544
Epoch 36
Loss = 8.9017e-02, PNorm = 35.4289, GNorm = 1.1126, lr_0 = 2.3617e-04
Loss = 1.0515e-01, PNorm = 35.4348, GNorm = 2.0535, lr_0 = 2.3072e-04
Validation rmse = 0.149475
Epoch 37
Loss = 1.1416e-01, PNorm = 35.4416, GNorm = 1.7174, lr_0 = 2.2539e-04
Loss = 9.5027e-02, PNorm = 35.4474, GNorm = 0.8673, lr_0 = 2.2019e-04
Validation rmse = 0.150841
Epoch 38
Loss = 1.1178e-01, PNorm = 35.4565, GNorm = 2.5853, lr_0 = 2.1461e-04
Loss = 1.0366e-01, PNorm = 35.4629, GNorm = 3.1258, lr_0 = 2.0965e-04
Validation rmse = 0.150242
Epoch 39
Loss = 1.0680e-01, PNorm = 35.4696, GNorm = 2.6138, lr_0 = 2.0481e-04
Validation rmse = 0.151280
Epoch 40
Loss = 9.1205e-02, PNorm = 35.4766, GNorm = 0.9175, lr_0 = 1.9962e-04
Loss = 8.8261e-02, PNorm = 35.4835, GNorm = 2.6115, lr_0 = 1.9501e-04
Validation rmse = 0.148097
Epoch 41
Loss = 9.8873e-02, PNorm = 35.4886, GNorm = 2.2069, lr_0 = 1.9051e-04
Loss = 1.0119e-01, PNorm = 35.4931, GNorm = 1.6298, lr_0 = 1.8611e-04
Validation rmse = 0.147828
Epoch 42
Loss = 9.5513e-02, PNorm = 35.4990, GNorm = 1.9982, lr_0 = 1.8139e-04
Validation rmse = 0.148789
Epoch 43
Loss = 7.1191e-02, PNorm = 35.5041, GNorm = 0.5704, lr_0 = 1.7679e-04
Loss = 9.6622e-02, PNorm = 35.5091, GNorm = 2.3704, lr_0 = 1.7271e-04
Validation rmse = 0.148125
Epoch 44
Loss = 1.1454e-01, PNorm = 35.5149, GNorm = 2.1315, lr_0 = 1.6873e-04
Loss = 8.9954e-02, PNorm = 35.5197, GNorm = 0.8302, lr_0 = 1.6483e-04
Validation rmse = 0.149832
Epoch 45
Loss = 9.6778e-02, PNorm = 35.5251, GNorm = 1.0800, lr_0 = 1.6065e-04
Loss = 8.5462e-02, PNorm = 35.5296, GNorm = 1.7719, lr_0 = 1.5694e-04
Validation rmse = 0.149432
Epoch 46
Loss = 9.4532e-02, PNorm = 35.5353, GNorm = 0.7700, lr_0 = 1.5332e-04
Validation rmse = 0.148045
Epoch 47
Loss = 7.5412e-02, PNorm = 35.5398, GNorm = 0.4770, lr_0 = 1.4943e-04
Loss = 9.3825e-02, PNorm = 35.5434, GNorm = 0.8289, lr_0 = 1.4598e-04
Validation rmse = 0.148688
Epoch 48
Loss = 7.3209e-02, PNorm = 35.5482, GNorm = 1.0887, lr_0 = 1.4261e-04
Loss = 9.3303e-02, PNorm = 35.5529, GNorm = 0.7978, lr_0 = 1.3932e-04
Validation rmse = 0.147989
Epoch 49
Loss = 1.0097e-01, PNorm = 35.5566, GNorm = 0.8246, lr_0 = 1.3579e-04
Loss = 8.4173e-02, PNorm = 35.5602, GNorm = 1.9469, lr_0 = 1.3265e-04
Validation rmse = 0.147916
Epoch 50
Loss = 8.8802e-02, PNorm = 35.5642, GNorm = 1.3758, lr_0 = 1.2959e-04
Validation rmse = 0.147898
Epoch 51
Loss = 8.9791e-02, PNorm = 35.5677, GNorm = 0.7816, lr_0 = 1.2630e-04
Loss = 8.4518e-02, PNorm = 35.5701, GNorm = 0.8688, lr_0 = 1.2339e-04
Validation rmse = 0.148923
Epoch 52
Loss = 8.7816e-02, PNorm = 35.5750, GNorm = 0.8739, lr_0 = 1.2026e-04
Loss = 9.3201e-02, PNorm = 35.5784, GNorm = 2.1262, lr_0 = 1.1748e-04
Validation rmse = 0.149314
Epoch 53
Loss = 8.4749e-02, PNorm = 35.5819, GNorm = 0.6748, lr_0 = 1.1477e-04
Loss = 9.2349e-02, PNorm = 35.5850, GNorm = 1.1294, lr_0 = 1.1212e-04
Validation rmse = 0.147628
Epoch 54
Loss = 9.0027e-02, PNorm = 35.5891, GNorm = 0.5781, lr_0 = 1.0928e-04
Validation rmse = 0.148025
Epoch 55
Loss = 1.2805e-01, PNorm = 35.5921, GNorm = 2.0561, lr_0 = 1.0676e-04
Loss = 8.9104e-02, PNorm = 35.5949, GNorm = 0.8932, lr_0 = 1.0429e-04
Validation rmse = 0.149058
Epoch 56
Loss = 9.1255e-02, PNorm = 35.5981, GNorm = 2.7811, lr_0 = 1.0165e-04
Loss = 8.4723e-02, PNorm = 35.6018, GNorm = 1.6654, lr_0 = 1.0000e-04
Validation rmse = 0.147658
Epoch 57
Loss = 8.4829e-02, PNorm = 35.6045, GNorm = 1.3182, lr_0 = 1.0000e-04
Loss = 9.4502e-02, PNorm = 35.6063, GNorm = 1.1297, lr_0 = 1.0000e-04
Validation rmse = 0.147885
Epoch 58
Loss = 8.7006e-02, PNorm = 35.6103, GNorm = 1.1857, lr_0 = 1.0000e-04
Validation rmse = 0.147182
Epoch 59
Loss = 6.7815e-02, PNorm = 35.6136, GNorm = 1.0012, lr_0 = 1.0000e-04
Loss = 8.8954e-02, PNorm = 35.6160, GNorm = 0.7031, lr_0 = 1.0000e-04
Validation rmse = 0.146892
Model 0 best validation rmse = 0.146892 on epoch 59
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.145650
Ensemble test rmse = 0.145650
1-fold cross validation
	Seed 0 ==> test rmse = 0.145650
Overall test rmse = 0.145650 +/- 0.000000
Elapsed time = 0:00:32
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,087 | train size = 864 | val size = 217 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1607e-01, PNorm = 34.0173, GNorm = 2.8974, lr_0 = 3.9118e-04
Validation rmse = 0.289827
Epoch 1
Loss = 6.3723e-01, PNorm = 34.0490, GNorm = 4.5927, lr_0 = 6.8235e-04
Loss = 6.1177e-01, PNorm = 34.0975, GNorm = 4.6972, lr_0 = 9.4706e-04
Validation rmse = 0.257786
Epoch 2
Loss = 4.4997e-01, PNorm = 34.1747, GNorm = 2.0835, lr_0 = 9.7920e-04
Loss = 4.4674e-01, PNorm = 34.2367, GNorm = 3.5376, lr_0 = 9.5660e-04
Validation rmse = 0.247226
Epoch 3
Loss = 4.0422e-01, PNorm = 34.3026, GNorm = 6.3756, lr_0 = 9.3234e-04
Validation rmse = 0.204621
Epoch 4
Loss = 3.8278e-01, PNorm = 34.3575, GNorm = 1.8099, lr_0 = 9.1082e-04
Loss = 3.1167e-01, PNorm = 34.4104, GNorm = 5.2681, lr_0 = 8.8980e-04
Validation rmse = 0.231219
Epoch 5
Loss = 3.1281e-01, PNorm = 34.4585, GNorm = 8.4449, lr_0 = 8.6723e-04
Loss = 3.1174e-01, PNorm = 34.5024, GNorm = 1.1553, lr_0 = 8.4721e-04
Validation rmse = 0.212431
Epoch 6
Loss = 2.9057e-01, PNorm = 34.5534, GNorm = 3.0117, lr_0 = 8.2573e-04
Loss = 2.8688e-01, PNorm = 34.5915, GNorm = 2.2973, lr_0 = 8.0667e-04
Loss = 3.4349e-01, PNorm = 34.5949, GNorm = 7.4291, lr_0 = 8.0478e-04
Validation rmse = 0.197198
Epoch 7
Loss = 2.3406e-01, PNorm = 34.6323, GNorm = 2.8713, lr_0 = 7.8621e-04
Validation rmse = 0.199289
Epoch 8
Loss = 2.6897e-01, PNorm = 34.6695, GNorm = 2.5566, lr_0 = 7.6806e-04
Loss = 1.8657e-01, PNorm = 34.7035, GNorm = 0.7636, lr_0 = 7.5033e-04
Validation rmse = 0.174234
Epoch 9
Loss = 1.9156e-01, PNorm = 34.7368, GNorm = 0.9023, lr_0 = 7.3130e-04
Loss = 1.7347e-01, PNorm = 34.7698, GNorm = 1.4484, lr_0 = 7.1442e-04
Validation rmse = 0.167889
Epoch 10
Loss = 1.5585e-01, PNorm = 34.7979, GNorm = 1.0925, lr_0 = 6.9630e-04
Loss = 1.6286e-01, PNorm = 34.8263, GNorm = 1.2724, lr_0 = 6.8023e-04
Validation rmse = 0.171269
Epoch 11
Loss = 1.6251e-01, PNorm = 34.8516, GNorm = 1.8003, lr_0 = 6.6453e-04
Validation rmse = 0.160147
Epoch 12
Loss = 1.1583e-01, PNorm = 34.8785, GNorm = 2.7164, lr_0 = 6.4768e-04
Loss = 1.6449e-01, PNorm = 34.8951, GNorm = 2.5176, lr_0 = 6.3273e-04
Validation rmse = 0.160605
Epoch 13
Loss = 1.5825e-01, PNorm = 34.9200, GNorm = 2.4410, lr_0 = 6.1668e-04
Loss = 1.3732e-01, PNorm = 34.9447, GNorm = 0.9889, lr_0 = 6.0245e-04
Validation rmse = 0.173090
Epoch 14
Loss = 1.5984e-01, PNorm = 34.9608, GNorm = 0.7833, lr_0 = 5.8717e-04
Validation rmse = 0.162665
Epoch 15
Loss = 1.5539e-01, PNorm = 34.9863, GNorm = 0.9287, lr_0 = 5.7362e-04
Loss = 1.7285e-01, PNorm = 35.0065, GNorm = 1.0870, lr_0 = 5.6037e-04
Validation rmse = 0.163499
Epoch 16
Loss = 1.5410e-01, PNorm = 35.0315, GNorm = 3.5900, lr_0 = 5.4616e-04
Loss = 1.2605e-01, PNorm = 35.0519, GNorm = 1.4775, lr_0 = 5.3356e-04
Validation rmse = 0.159456
Epoch 17
Loss = 1.2778e-01, PNorm = 35.0701, GNorm = 1.4352, lr_0 = 5.2003e-04
Loss = 1.2850e-01, PNorm = 35.0881, GNorm = 2.7070, lr_0 = 5.0802e-04
Validation rmse = 0.152528
Epoch 18
Loss = 1.1050e-01, PNorm = 35.1049, GNorm = 1.8516, lr_0 = 4.9630e-04
Validation rmse = 0.152393
Epoch 19
Loss = 1.2546e-01, PNorm = 35.1234, GNorm = 1.8760, lr_0 = 4.8371e-04
Loss = 1.0951e-01, PNorm = 35.1374, GNorm = 1.4875, lr_0 = 4.7254e-04
Validation rmse = 0.156666
Epoch 20
Loss = 9.3641e-02, PNorm = 35.1530, GNorm = 2.0194, lr_0 = 4.6056e-04
Loss = 1.1955e-01, PNorm = 35.1682, GNorm = 1.6588, lr_0 = 4.4993e-04
Validation rmse = 0.150090
Epoch 21
Loss = 1.3148e-01, PNorm = 35.1854, GNorm = 3.1461, lr_0 = 4.3852e-04
Loss = 1.1396e-01, PNorm = 35.2002, GNorm = 1.9985, lr_0 = 4.2840e-04
Validation rmse = 0.152437
Epoch 22
Loss = 1.0059e-01, PNorm = 35.2131, GNorm = 0.8280, lr_0 = 4.1851e-04
Validation rmse = 0.151561
Epoch 23
Loss = 1.2667e-01, PNorm = 35.2284, GNorm = 2.1603, lr_0 = 4.0789e-04
Loss = 1.1606e-01, PNorm = 35.2425, GNorm = 1.2738, lr_0 = 3.9848e-04
Validation rmse = 0.162025
Epoch 24
Loss = 1.5435e-01, PNorm = 35.2570, GNorm = 5.8957, lr_0 = 3.8837e-04
Loss = 1.1768e-01, PNorm = 35.2733, GNorm = 0.8674, lr_0 = 3.7941e-04
Validation rmse = 0.153167
Epoch 25
Loss = 1.1251e-01, PNorm = 35.2825, GNorm = 1.4617, lr_0 = 3.7065e-04
Validation rmse = 0.146918
Epoch 26
Loss = 9.4150e-02, PNorm = 35.2964, GNorm = 0.7319, lr_0 = 3.6125e-04
Loss = 9.8480e-02, PNorm = 35.3075, GNorm = 3.4221, lr_0 = 3.5291e-04
Validation rmse = 0.148903
Epoch 27
Loss = 1.1831e-01, PNorm = 35.3197, GNorm = 3.8985, lr_0 = 3.4396e-04
Loss = 1.0410e-01, PNorm = 35.3298, GNorm = 1.2615, lr_0 = 3.3602e-04
Validation rmse = 0.148387
Epoch 28
Loss = 1.0354e-01, PNorm = 35.3417, GNorm = 0.6225, lr_0 = 3.2750e-04
Loss = 1.0742e-01, PNorm = 35.3531, GNorm = 2.6294, lr_0 = 3.1994e-04
Validation rmse = 0.146993
Epoch 29
Loss = 1.0517e-01, PNorm = 35.3617, GNorm = 0.6725, lr_0 = 3.1256e-04
Validation rmse = 0.148914
Epoch 30
Loss = 1.0337e-01, PNorm = 35.3735, GNorm = 1.3575, lr_0 = 3.0463e-04
Loss = 9.1890e-02, PNorm = 35.3833, GNorm = 0.9639, lr_0 = 2.9760e-04
Validation rmse = 0.146784
Epoch 31
Loss = 8.2679e-02, PNorm = 35.3934, GNorm = 1.3770, lr_0 = 2.9005e-04
Loss = 9.5878e-02, PNorm = 35.4003, GNorm = 0.7335, lr_0 = 2.8336e-04
Validation rmse = 0.147757
Epoch 32
Loss = 8.3605e-02, PNorm = 35.4138, GNorm = 0.6881, lr_0 = 2.7617e-04
Loss = 1.0866e-01, PNorm = 35.4228, GNorm = 2.6204, lr_0 = 2.6980e-04
Validation rmse = 0.145749
Epoch 33
Loss = 9.3463e-02, PNorm = 35.4318, GNorm = 0.6928, lr_0 = 2.6357e-04
Validation rmse = 0.147135
Epoch 34
Loss = 1.1141e-01, PNorm = 35.4399, GNorm = 2.0526, lr_0 = 2.5688e-04
Loss = 8.3166e-02, PNorm = 35.4471, GNorm = 2.4939, lr_0 = 2.5095e-04
Validation rmse = 0.149400
Epoch 35
Loss = 1.0650e-01, PNorm = 35.4549, GNorm = 2.8795, lr_0 = 2.4459e-04
Loss = 9.7474e-02, PNorm = 35.4644, GNorm = 2.2455, lr_0 = 2.3894e-04
Validation rmse = 0.147508
Epoch 36
Loss = 1.0440e-01, PNorm = 35.4732, GNorm = 2.0358, lr_0 = 2.3343e-04
Validation rmse = 0.145488
Epoch 37
Loss = 9.4130e-02, PNorm = 35.4801, GNorm = 2.5211, lr_0 = 2.2751e-04
Loss = 9.1327e-02, PNorm = 35.4874, GNorm = 1.2282, lr_0 = 2.2226e-04
Validation rmse = 0.145711
Epoch 38
Loss = 8.9476e-02, PNorm = 35.4945, GNorm = 0.7837, lr_0 = 2.1662e-04
Loss = 9.5547e-02, PNorm = 35.5020, GNorm = 0.8502, lr_0 = 2.1162e-04
Validation rmse = 0.147456
Epoch 39
Loss = 8.3669e-02, PNorm = 35.5080, GNorm = 1.2113, lr_0 = 2.0625e-04
Loss = 1.0017e-01, PNorm = 35.5141, GNorm = 0.9307, lr_0 = 2.0149e-04
Validation rmse = 0.146164
Epoch 40
Loss = 9.4940e-02, PNorm = 35.5206, GNorm = 1.4867, lr_0 = 1.9684e-04
Validation rmse = 0.147363
Epoch 41
Loss = 6.8081e-02, PNorm = 35.5288, GNorm = 0.6140, lr_0 = 1.9185e-04
Loss = 9.5604e-02, PNorm = 35.5355, GNorm = 0.7703, lr_0 = 1.8742e-04
Validation rmse = 0.145663
Epoch 42
Loss = 8.7892e-02, PNorm = 35.5412, GNorm = 0.6257, lr_0 = 1.8267e-04
Loss = 8.8959e-02, PNorm = 35.5469, GNorm = 1.2609, lr_0 = 1.7845e-04
Validation rmse = 0.146436
Epoch 43
Loss = 7.4761e-02, PNorm = 35.5516, GNorm = 0.6132, lr_0 = 1.7433e-04
Loss = 9.4611e-02, PNorm = 35.5568, GNorm = 1.6808, lr_0 = 1.7031e-04
Loss = 6.4392e-02, PNorm = 35.5575, GNorm = 1.4978, lr_0 = 1.6991e-04
Validation rmse = 0.146495
Epoch 44
Loss = 8.8829e-02, PNorm = 35.5630, GNorm = 1.8524, lr_0 = 1.6599e-04
Validation rmse = 0.145818
Epoch 45
Loss = 9.1322e-02, PNorm = 35.5683, GNorm = 1.0171, lr_0 = 1.6178e-04
Loss = 7.2998e-02, PNorm = 35.5744, GNorm = 0.4016, lr_0 = 1.5805e-04
Validation rmse = 0.145034
Epoch 46
Loss = 8.7179e-02, PNorm = 35.5788, GNorm = 1.4947, lr_0 = 1.5404e-04
Loss = 8.5290e-02, PNorm = 35.5839, GNorm = 0.9399, lr_0 = 1.5048e-04
Validation rmse = 0.146162
Epoch 47
Loss = 8.4488e-02, PNorm = 35.5883, GNorm = 1.0775, lr_0 = 1.4701e-04
Validation rmse = 0.145648
Epoch 48
Loss = 6.0686e-02, PNorm = 35.5926, GNorm = 0.8867, lr_0 = 1.4328e-04
Loss = 9.4627e-02, PNorm = 35.5984, GNorm = 0.9680, lr_0 = 1.3997e-04
Validation rmse = 0.144369
Epoch 49
Loss = 6.4201e-02, PNorm = 35.6026, GNorm = 1.5868, lr_0 = 1.3642e-04
Loss = 8.4203e-02, PNorm = 35.6063, GNorm = 0.6229, lr_0 = 1.3327e-04
Validation rmse = 0.146769
Epoch 50
Loss = 8.7473e-02, PNorm = 35.6098, GNorm = 2.1312, lr_0 = 1.3020e-04
Loss = 7.7246e-02, PNorm = 35.6132, GNorm = 1.0408, lr_0 = 1.2719e-04
Validation rmse = 0.145922
Epoch 51
Loss = 8.4044e-02, PNorm = 35.6179, GNorm = 0.5970, lr_0 = 1.2397e-04
Validation rmse = 0.148224
Epoch 52
Loss = 8.6731e-02, PNorm = 35.6230, GNorm = 2.1668, lr_0 = 1.2082e-04
Loss = 7.7460e-02, PNorm = 35.6262, GNorm = 1.1866, lr_0 = 1.1803e-04
Validation rmse = 0.147858
Epoch 53
Loss = 8.1567e-02, PNorm = 35.6296, GNorm = 0.9667, lr_0 = 1.1504e-04
Loss = 7.7064e-02, PNorm = 35.6333, GNorm = 1.4453, lr_0 = 1.1239e-04
Validation rmse = 0.144929
Epoch 54
Loss = 7.8207e-02, PNorm = 35.6362, GNorm = 0.9300, lr_0 = 1.0979e-04
Loss = 8.6094e-02, PNorm = 35.6398, GNorm = 1.0030, lr_0 = 1.0726e-04
Loss = 1.2779e-01, PNorm = 35.6399, GNorm = 2.6459, lr_0 = 1.0701e-04
Validation rmse = 0.147202
Epoch 55
Loss = 7.4592e-02, PNorm = 35.6426, GNorm = 1.0905, lr_0 = 1.0454e-04
Validation rmse = 0.145312
Epoch 56
Loss = 7.8250e-02, PNorm = 35.6458, GNorm = 0.7186, lr_0 = 1.0189e-04
Loss = 7.3801e-02, PNorm = 35.6487, GNorm = 2.1018, lr_0 = 1.0000e-04
Validation rmse = 0.145011
Epoch 57
Loss = 8.0225e-02, PNorm = 35.6535, GNorm = 2.2809, lr_0 = 1.0000e-04
Loss = 8.2597e-02, PNorm = 35.6560, GNorm = 0.9494, lr_0 = 1.0000e-04
Validation rmse = 0.145784
Epoch 58
Loss = 8.4679e-02, PNorm = 35.6589, GNorm = 0.5843, lr_0 = 1.0000e-04
Validation rmse = 0.148821
Epoch 59
Loss = 4.7472e-02, PNorm = 35.6628, GNorm = 0.3978, lr_0 = 1.0000e-04
Loss = 8.2044e-02, PNorm = 35.6664, GNorm = 0.6267, lr_0 = 1.0000e-04
Validation rmse = 0.146154
Model 0 best validation rmse = 0.144369 on epoch 48
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.166082
Ensemble test rmse = 0.166082
1-fold cross validation
	Seed 0 ==> test rmse = 0.166082
Overall test rmse = 0.166082 +/- 0.000000
Elapsed time = 0:00:32
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,077 | train size = 856 | val size = 215 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.4341e-01, PNorm = 34.0156, GNorm = 4.4766, lr_0 = 3.9118e-04
Validation rmse = 0.313282
Epoch 1
Loss = 8.3269e-01, PNorm = 34.0392, GNorm = 11.6887, lr_0 = 6.8235e-04
Loss = 6.8802e-01, PNorm = 34.0788, GNorm = 1.2533, lr_0 = 9.4706e-04
Validation rmse = 0.305203
Epoch 2
Loss = 5.5714e-01, PNorm = 34.1527, GNorm = 5.8343, lr_0 = 9.7920e-04
Loss = 4.1446e-01, PNorm = 34.2257, GNorm = 2.4379, lr_0 = 9.5660e-04
Validation rmse = 0.218117
Epoch 3
Loss = 4.3495e-01, PNorm = 34.2989, GNorm = 2.7477, lr_0 = 9.3234e-04
Validation rmse = 0.204426
Epoch 4
Loss = 3.0568e-01, PNorm = 34.3593, GNorm = 2.3004, lr_0 = 9.0869e-04
Loss = 3.1216e-01, PNorm = 34.4083, GNorm = 6.8079, lr_0 = 8.8772e-04
Validation rmse = 0.186432
Epoch 5
Loss = 2.7820e-01, PNorm = 34.4612, GNorm = 1.8039, lr_0 = 8.6521e-04
Loss = 2.7042e-01, PNorm = 34.5144, GNorm = 3.9150, lr_0 = 8.4524e-04
Validation rmse = 0.190538
Epoch 6
Loss = 2.5051e-01, PNorm = 34.5548, GNorm = 5.3934, lr_0 = 8.2380e-04
Validation rmse = 0.168520
Epoch 7
Loss = 1.6477e-01, PNorm = 34.6003, GNorm = 1.3903, lr_0 = 8.0291e-04
Loss = 2.3211e-01, PNorm = 34.6323, GNorm = 0.8822, lr_0 = 7.8437e-04
Validation rmse = 0.178987
Epoch 8
Loss = 2.4372e-01, PNorm = 34.6626, GNorm = 2.8500, lr_0 = 7.6448e-04
Loss = 2.9712e-01, PNorm = 34.7023, GNorm = 5.4049, lr_0 = 7.4684e-04
Validation rmse = 0.172659
Epoch 9
Loss = 2.3889e-01, PNorm = 34.7421, GNorm = 0.7905, lr_0 = 7.2960e-04
Loss = 1.8625e-01, PNorm = 34.7704, GNorm = 2.4992, lr_0 = 7.1276e-04
Validation rmse = 0.172547
Epoch 10
Loss = 1.7224e-01, PNorm = 34.7938, GNorm = 2.3903, lr_0 = 6.9468e-04
Validation rmse = 0.154595
Epoch 11
Loss = 1.2507e-01, PNorm = 34.8259, GNorm = 2.3858, lr_0 = 6.7706e-04
Loss = 1.7414e-01, PNorm = 34.8500, GNorm = 1.1361, lr_0 = 6.6143e-04
Validation rmse = 0.150784
Epoch 12
Loss = 1.9793e-01, PNorm = 34.8763, GNorm = 0.9127, lr_0 = 6.4466e-04
Loss = 1.3605e-01, PNorm = 34.8946, GNorm = 0.7094, lr_0 = 6.2978e-04
Validation rmse = 0.149493
Epoch 13
Loss = 1.4057e-01, PNorm = 34.9119, GNorm = 0.5070, lr_0 = 6.1381e-04
Validation rmse = 0.146958
Epoch 14
Loss = 1.5418e-01, PNorm = 34.9340, GNorm = 3.4332, lr_0 = 5.9824e-04
Loss = 1.4752e-01, PNorm = 34.9542, GNorm = 1.6909, lr_0 = 5.8443e-04
Validation rmse = 0.173502
Epoch 15
Loss = 1.7166e-01, PNorm = 34.9759, GNorm = 1.1338, lr_0 = 5.6961e-04
Loss = 1.5035e-01, PNorm = 34.9940, GNorm = 1.1275, lr_0 = 5.5646e-04
Validation rmse = 0.146551
Epoch 16
Loss = 1.4420e-01, PNorm = 35.0140, GNorm = 1.9339, lr_0 = 5.4235e-04
Loss = 1.3600e-01, PNorm = 35.0304, GNorm = 2.5530, lr_0 = 5.2983e-04
Validation rmse = 0.141944
Epoch 17
Loss = 1.2336e-01, PNorm = 35.0440, GNorm = 2.2566, lr_0 = 5.1760e-04
Validation rmse = 0.141242
Epoch 18
Loss = 1.3044e-01, PNorm = 35.0586, GNorm = 1.5368, lr_0 = 5.0448e-04
Loss = 1.3734e-01, PNorm = 35.0772, GNorm = 2.6713, lr_0 = 4.9283e-04
Validation rmse = 0.141697
Epoch 19
Loss = 1.3727e-01, PNorm = 35.0918, GNorm = 1.2530, lr_0 = 4.8033e-04
Loss = 1.2154e-01, PNorm = 35.1065, GNorm = 1.1940, lr_0 = 4.6924e-04
Validation rmse = 0.143436
Epoch 20
Loss = 1.2660e-01, PNorm = 35.1262, GNorm = 3.4197, lr_0 = 4.5734e-04
Validation rmse = 0.141105
Epoch 21
Loss = 1.4395e-01, PNorm = 35.1385, GNorm = 1.7777, lr_0 = 4.4575e-04
Loss = 1.1859e-01, PNorm = 35.1518, GNorm = 3.1718, lr_0 = 4.3546e-04
Validation rmse = 0.144948
Epoch 22
Loss = 2.4456e-01, PNorm = 35.1660, GNorm = 2.2530, lr_0 = 4.2441e-04
Loss = 1.6545e-01, PNorm = 35.1830, GNorm = 3.2574, lr_0 = 4.1462e-04
Validation rmse = 0.151568
Epoch 23
Loss = 1.3338e-01, PNorm = 35.1952, GNorm = 2.8222, lr_0 = 4.0410e-04
Loss = 1.3420e-01, PNorm = 35.2122, GNorm = 1.6568, lr_0 = 3.9477e-04
Loss = 1.1792e-01, PNorm = 35.2141, GNorm = 4.2317, lr_0 = 3.9385e-04
Validation rmse = 0.141544
Epoch 24
Loss = 1.4350e-01, PNorm = 35.2273, GNorm = 1.6769, lr_0 = 3.8476e-04
Validation rmse = 0.136374
Epoch 25
Loss = 1.7588e-01, PNorm = 35.2403, GNorm = 3.1258, lr_0 = 3.7588e-04
Loss = 1.0880e-01, PNorm = 35.2522, GNorm = 0.5646, lr_0 = 3.6721e-04
Validation rmse = 0.135900
Epoch 26
Loss = 1.1843e-01, PNorm = 35.2651, GNorm = 0.9951, lr_0 = 3.5789e-04
Loss = 1.2086e-01, PNorm = 35.2754, GNorm = 0.9653, lr_0 = 3.4963e-04
Validation rmse = 0.136838
Epoch 27
Loss = 1.0840e-01, PNorm = 35.2849, GNorm = 1.0360, lr_0 = 3.4076e-04
Validation rmse = 0.136084
Epoch 28
Loss = 1.1601e-01, PNorm = 35.2958, GNorm = 0.9104, lr_0 = 3.3212e-04
Loss = 1.0631e-01, PNorm = 35.3057, GNorm = 0.9874, lr_0 = 3.2446e-04
Validation rmse = 0.135448
Epoch 29
Loss = 1.3690e-01, PNorm = 35.3167, GNorm = 1.1362, lr_0 = 3.1623e-04
Loss = 1.0382e-01, PNorm = 35.3253, GNorm = 1.4805, lr_0 = 3.0893e-04
Validation rmse = 0.132136
Epoch 30
Loss = 1.0554e-01, PNorm = 35.3392, GNorm = 0.7043, lr_0 = 3.0109e-04
Loss = 1.1210e-01, PNorm = 35.3506, GNorm = 2.7970, lr_0 = 2.9414e-04
Loss = 2.3254e-02, PNorm = 35.3513, GNorm = 1.5480, lr_0 = 2.9346e-04
Validation rmse = 0.135181
Epoch 31
Loss = 9.3721e-02, PNorm = 35.3595, GNorm = 1.7222, lr_0 = 2.8668e-04
Validation rmse = 0.136971
Epoch 32
Loss = 8.7692e-02, PNorm = 35.3682, GNorm = 0.4954, lr_0 = 2.7941e-04
Loss = 1.1869e-01, PNorm = 35.3805, GNorm = 2.0831, lr_0 = 2.7296e-04
Validation rmse = 0.133077
Epoch 33
Loss = 9.7401e-02, PNorm = 35.3898, GNorm = 3.0430, lr_0 = 2.6604e-04
Loss = 1.2277e-01, PNorm = 35.3987, GNorm = 0.4363, lr_0 = 2.5990e-04
Validation rmse = 0.134066
Epoch 34
Loss = 1.1969e-01, PNorm = 35.4069, GNorm = 2.0310, lr_0 = 2.5390e-04
Validation rmse = 0.148353
Epoch 35
Loss = 5.7569e-02, PNorm = 35.4164, GNorm = 0.8093, lr_0 = 2.4746e-04
Loss = 1.3559e-01, PNorm = 35.4265, GNorm = 1.2304, lr_0 = 2.4175e-04
Validation rmse = 0.138699
Epoch 36
Loss = 1.2607e-01, PNorm = 35.4347, GNorm = 0.6158, lr_0 = 2.3562e-04
Loss = 9.3485e-02, PNorm = 35.4415, GNorm = 2.8112, lr_0 = 2.3018e-04
Validation rmse = 0.133334
Epoch 37
Loss = 1.0224e-01, PNorm = 35.4496, GNorm = 1.1780, lr_0 = 2.2434e-04
Loss = 1.0692e-01, PNorm = 35.4560, GNorm = 1.9230, lr_0 = 2.1916e-04
Loss = 2.3957e-02, PNorm = 35.4568, GNorm = 1.2121, lr_0 = 2.1865e-04
Validation rmse = 0.137701
Epoch 38
Loss = 1.2325e-01, PNorm = 35.4622, GNorm = 3.1026, lr_0 = 2.1361e-04
Validation rmse = 0.133941
Epoch 39
Loss = 1.0326e-01, PNorm = 35.4696, GNorm = 2.9971, lr_0 = 2.0819e-04
Loss = 1.2236e-01, PNorm = 35.4788, GNorm = 1.3206, lr_0 = 2.0338e-04
Validation rmse = 0.134952
Epoch 40
Loss = 8.9511e-02, PNorm = 35.4868, GNorm = 0.9588, lr_0 = 1.9823e-04
Loss = 1.1855e-01, PNorm = 35.4906, GNorm = 1.9761, lr_0 = 1.9365e-04
Validation rmse = 0.133774
Epoch 41
Loss = 1.1154e-01, PNorm = 35.5001, GNorm = 1.7469, lr_0 = 1.8874e-04
Validation rmse = 0.132697
Epoch 42
Loss = 7.5100e-02, PNorm = 35.5053, GNorm = 0.7324, lr_0 = 1.8438e-04
Loss = 9.1873e-02, PNorm = 35.5110, GNorm = 0.8940, lr_0 = 1.8013e-04
Validation rmse = 0.132120
Epoch 43
Loss = 8.8645e-02, PNorm = 35.5169, GNorm = 1.0204, lr_0 = 1.7556e-04
Loss = 1.1139e-01, PNorm = 35.5222, GNorm = 2.1142, lr_0 = 1.7151e-04
Validation rmse = 0.135176
Epoch 44
Loss = 8.7300e-02, PNorm = 35.5267, GNorm = 0.4020, lr_0 = 1.6716e-04
Loss = 1.0056e-01, PNorm = 35.5317, GNorm = 2.3584, lr_0 = 1.6330e-04
Loss = 2.7850e-01, PNorm = 35.5322, GNorm = 5.2966, lr_0 = 1.6292e-04
Validation rmse = 0.132274
Epoch 45
Loss = 8.9807e-02, PNorm = 35.5391, GNorm = 2.9166, lr_0 = 1.5916e-04
Validation rmse = 0.132942
Epoch 46
Loss = 1.1497e-01, PNorm = 35.5440, GNorm = 3.1177, lr_0 = 1.5512e-04
Loss = 1.2248e-01, PNorm = 35.5517, GNorm = 0.8309, lr_0 = 1.5154e-04
Validation rmse = 0.133272
Epoch 47
Loss = 9.0698e-02, PNorm = 35.5592, GNorm = 1.3153, lr_0 = 1.4770e-04
Loss = 8.7120e-02, PNorm = 35.5636, GNorm = 1.1240, lr_0 = 1.4429e-04
Validation rmse = 0.133965
Epoch 48
Loss = 9.4078e-02, PNorm = 35.5675, GNorm = 1.2437, lr_0 = 1.4063e-04
Validation rmse = 0.131113
Epoch 49
Loss = 1.1094e-01, PNorm = 35.5713, GNorm = 1.7091, lr_0 = 1.3706e-04
Loss = 1.0687e-01, PNorm = 35.5755, GNorm = 0.5448, lr_0 = 1.3390e-04
Validation rmse = 0.132855
Epoch 50
Loss = 8.7390e-02, PNorm = 35.5804, GNorm = 2.1984, lr_0 = 1.3081e-04
Loss = 9.5411e-02, PNorm = 35.5853, GNorm = 0.8490, lr_0 = 1.2779e-04
Validation rmse = 0.132354
Epoch 51
Loss = 8.5197e-02, PNorm = 35.5892, GNorm = 0.5366, lr_0 = 1.2455e-04
Loss = 9.9207e-02, PNorm = 35.5914, GNorm = 0.5831, lr_0 = 1.2167e-04
Loss = 4.1408e-02, PNorm = 35.5916, GNorm = 1.4432, lr_0 = 1.2139e-04
Validation rmse = 0.131598
Epoch 52
Loss = 1.0590e-01, PNorm = 35.5953, GNorm = 0.8552, lr_0 = 1.1859e-04
Validation rmse = 0.132190
Epoch 53
Loss = 1.1704e-01, PNorm = 35.5993, GNorm = 1.0341, lr_0 = 1.1558e-04
Loss = 9.1126e-02, PNorm = 35.6027, GNorm = 0.6970, lr_0 = 1.1291e-04
Validation rmse = 0.133845
Epoch 54
Loss = 9.4021e-02, PNorm = 35.6065, GNorm = 1.3204, lr_0 = 1.1005e-04
Loss = 9.9282e-02, PNorm = 35.6112, GNorm = 0.9631, lr_0 = 1.0751e-04
Validation rmse = 0.137242
Epoch 55
Loss = 8.8763e-02, PNorm = 35.6146, GNorm = 2.3784, lr_0 = 1.0478e-04
Validation rmse = 0.132772
Epoch 56
Loss = 9.1041e-02, PNorm = 35.6177, GNorm = 0.8629, lr_0 = 1.0212e-04
Loss = 8.0235e-02, PNorm = 35.6210, GNorm = 0.7335, lr_0 = 1.0000e-04
Validation rmse = 0.131092
Epoch 57
Loss = 7.9448e-02, PNorm = 35.6247, GNorm = 1.0516, lr_0 = 1.0000e-04
Loss = 1.0170e-01, PNorm = 35.6273, GNorm = 0.8059, lr_0 = 1.0000e-04
Validation rmse = 0.131470
Epoch 58
Loss = 9.3208e-02, PNorm = 35.6326, GNorm = 0.8949, lr_0 = 1.0000e-04
Loss = 8.9775e-02, PNorm = 35.6357, GNorm = 4.3513, lr_0 = 1.0000e-04
Validation rmse = 0.131812
Epoch 59
Loss = 9.1292e-02, PNorm = 35.6393, GNorm = 1.0099, lr_0 = 1.0000e-04
Validation rmse = 0.131193
Model 0 best validation rmse = 0.131092 on epoch 56
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.285155
Ensemble test rmse = 0.285155
1-fold cross validation
	Seed 0 ==> test rmse = 0.285155
Overall test rmse = 0.285155 +/- 0.000000
Elapsed time = 0:00:31
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,067 | train size = 848 | val size = 213 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.6307e-01, PNorm = 34.0162, GNorm = 1.5212, lr_0 = 4.0937e-04
Validation rmse = 0.305676
Epoch 1
Loss = 6.6573e-01, PNorm = 34.0519, GNorm = 1.7755, lr_0 = 7.1875e-04
Loss = 5.4887e-01, PNorm = 34.1062, GNorm = 5.2585, lr_0 = 1.0000e-03
Validation rmse = 0.260380
Epoch 2
Loss = 4.0411e-01, PNorm = 34.1789, GNorm = 5.8079, lr_0 = 9.7549e-04
Loss = 5.9368e-01, PNorm = 34.2257, GNorm = 12.1950, lr_0 = 9.5159e-04
Validation rmse = 0.253788
Epoch 3
Loss = 4.7267e-01, PNorm = 34.2769, GNorm = 2.8296, lr_0 = 9.2827e-04
Validation rmse = 0.251765
Epoch 4
Loss = 3.9913e-01, PNorm = 34.3293, GNorm = 1.0812, lr_0 = 9.0552e-04
Loss = 3.4265e-01, PNorm = 34.3762, GNorm = 4.5894, lr_0 = 8.8333e-04
Validation rmse = 0.211513
Epoch 5
Loss = 2.6416e-01, PNorm = 34.4214, GNorm = 1.3348, lr_0 = 8.6168e-04
Loss = 2.5777e-01, PNorm = 34.4682, GNorm = 2.0460, lr_0 = 8.4056e-04
Validation rmse = 0.205616
Epoch 6
Loss = 2.6593e-01, PNorm = 34.5113, GNorm = 7.7930, lr_0 = 8.1996e-04
Validation rmse = 0.218769
Epoch 7
Loss = 1.6644e-01, PNorm = 34.5460, GNorm = 6.5246, lr_0 = 7.9987e-04
Loss = 2.3348e-01, PNorm = 34.5806, GNorm = 4.2172, lr_0 = 7.8026e-04
Validation rmse = 0.180810
Epoch 8
Loss = 1.9451e-01, PNorm = 34.6190, GNorm = 0.6309, lr_0 = 7.6114e-04
Loss = 1.8654e-01, PNorm = 34.6541, GNorm = 1.5664, lr_0 = 7.4249e-04
Validation rmse = 0.169728
Epoch 9
Loss = 1.7819e-01, PNorm = 34.6883, GNorm = 2.8704, lr_0 = 7.2429e-04
Validation rmse = 0.196500
Epoch 10
Loss = 1.1512e-01, PNorm = 34.7213, GNorm = 3.9630, lr_0 = 7.0654e-04
Loss = 2.0164e-01, PNorm = 34.7501, GNorm = 5.5085, lr_0 = 6.8923e-04
Validation rmse = 0.180427
Epoch 11
Loss = 2.0804e-01, PNorm = 34.7834, GNorm = 5.7610, lr_0 = 6.7234e-04
Loss = 2.3508e-01, PNorm = 34.8123, GNorm = 4.7756, lr_0 = 6.5586e-04
Validation rmse = 0.175609
Epoch 12
Loss = 1.7431e-01, PNorm = 34.8393, GNorm = 3.3712, lr_0 = 6.3979e-04
Loss = 1.6486e-01, PNorm = 34.8645, GNorm = 1.4746, lr_0 = 6.2411e-04
Validation rmse = 0.166316
Epoch 13
Loss = 1.5198e-01, PNorm = 34.8895, GNorm = 2.2717, lr_0 = 6.0881e-04
Validation rmse = 0.160567
Epoch 14
Loss = 1.4890e-01, PNorm = 34.9096, GNorm = 1.6872, lr_0 = 5.9389e-04
Loss = 1.5007e-01, PNorm = 34.9323, GNorm = 3.8010, lr_0 = 5.7934e-04
Validation rmse = 0.159415
Epoch 15
Loss = 1.2929e-01, PNorm = 34.9521, GNorm = 1.2198, lr_0 = 5.6514e-04
Loss = 1.4210e-01, PNorm = 34.9691, GNorm = 1.7912, lr_0 = 5.5129e-04
Validation rmse = 0.152138
Epoch 16
Loss = 1.2739e-01, PNorm = 34.9886, GNorm = 2.7955, lr_0 = 5.3778e-04
Validation rmse = 0.155446
Epoch 17
Loss = 1.5804e-01, PNorm = 35.0090, GNorm = 3.3069, lr_0 = 5.2460e-04
Loss = 1.1581e-01, PNorm = 35.0284, GNorm = 0.6572, lr_0 = 5.1174e-04
Validation rmse = 0.151490
Epoch 18
Loss = 1.0804e-01, PNorm = 35.0440, GNorm = 3.3162, lr_0 = 4.9920e-04
Loss = 1.5610e-01, PNorm = 35.0605, GNorm = 2.6073, lr_0 = 4.8697e-04
Validation rmse = 0.182089
Epoch 19
Loss = 1.4676e-01, PNorm = 35.0764, GNorm = 3.6152, lr_0 = 4.7503e-04
Validation rmse = 0.164324
Epoch 20
Loss = 1.4927e-01, PNorm = 35.0911, GNorm = 3.4732, lr_0 = 4.6339e-04
Loss = 1.3490e-01, PNorm = 35.1077, GNorm = 0.8387, lr_0 = 4.5204e-04
Validation rmse = 0.151327
Epoch 21
Loss = 1.1580e-01, PNorm = 35.1231, GNorm = 1.3050, lr_0 = 4.4096e-04
Loss = 1.1921e-01, PNorm = 35.1353, GNorm = 1.0936, lr_0 = 4.3015e-04
Validation rmse = 0.148084
Epoch 22
Loss = 1.1886e-01, PNorm = 35.1487, GNorm = 1.0638, lr_0 = 4.1961e-04
Loss = 1.1246e-01, PNorm = 35.1602, GNorm = 1.6417, lr_0 = 4.0933e-04
Validation rmse = 0.148119
Epoch 23
Loss = 1.1591e-01, PNorm = 35.1766, GNorm = 0.7094, lr_0 = 3.9929e-04
Validation rmse = 0.149107
Epoch 24
Loss = 9.5353e-02, PNorm = 35.1883, GNorm = 1.1318, lr_0 = 3.8951e-04
Loss = 1.2499e-01, PNorm = 35.1996, GNorm = 0.8517, lr_0 = 3.7996e-04
Validation rmse = 0.146995
Epoch 25
Loss = 1.0854e-01, PNorm = 35.2099, GNorm = 1.6092, lr_0 = 3.7065e-04
Loss = 1.2304e-01, PNorm = 35.2224, GNorm = 3.2464, lr_0 = 3.6157e-04
Loss = 1.0430e-01, PNorm = 35.2242, GNorm = 1.8117, lr_0 = 3.6067e-04
Validation rmse = 0.147335
Epoch 26
Loss = 1.1041e-01, PNorm = 35.2354, GNorm = 1.9002, lr_0 = 3.5183e-04
Validation rmse = 0.145398
Epoch 27
Loss = 1.4082e-01, PNorm = 35.2479, GNorm = 0.5090, lr_0 = 3.4321e-04
Loss = 1.0623e-01, PNorm = 35.2609, GNorm = 0.5849, lr_0 = 3.3480e-04
Validation rmse = 0.147958
Epoch 28
Loss = 9.3099e-02, PNorm = 35.2700, GNorm = 1.7527, lr_0 = 3.2659e-04
Loss = 1.2808e-01, PNorm = 35.2791, GNorm = 1.9249, lr_0 = 3.1859e-04
Validation rmse = 0.148110
Epoch 29
Loss = 9.9711e-02, PNorm = 35.2892, GNorm = 1.9107, lr_0 = 3.1078e-04
Validation rmse = 0.148417
Epoch 30
Loss = 1.0405e-01, PNorm = 35.2980, GNorm = 1.2042, lr_0 = 3.0317e-04
Loss = 8.4092e-02, PNorm = 35.3079, GNorm = 1.6264, lr_0 = 2.9574e-04
Validation rmse = 0.144689
Epoch 31
Loss = 7.0218e-02, PNorm = 35.3170, GNorm = 1.2665, lr_0 = 2.8849e-04
Loss = 1.1506e-01, PNorm = 35.3250, GNorm = 1.7766, lr_0 = 2.8142e-04
Validation rmse = 0.145009
Epoch 32
Loss = 9.9679e-02, PNorm = 35.3350, GNorm = 1.0420, lr_0 = 2.7452e-04
Validation rmse = 0.147819
Epoch 33
Loss = 1.4773e-01, PNorm = 35.3439, GNorm = 2.6670, lr_0 = 2.6779e-04
Loss = 9.0598e-02, PNorm = 35.3535, GNorm = 1.3487, lr_0 = 2.6123e-04
Validation rmse = 0.144647
Epoch 34
Loss = 9.1644e-02, PNorm = 35.3611, GNorm = 3.0980, lr_0 = 2.5483e-04
Loss = 9.7057e-02, PNorm = 35.3697, GNorm = 0.8516, lr_0 = 2.4858e-04
Validation rmse = 0.148218
Epoch 35
Loss = 1.0077e-01, PNorm = 35.3775, GNorm = 2.1651, lr_0 = 2.4249e-04
Loss = 9.2594e-02, PNorm = 35.3852, GNorm = 1.0658, lr_0 = 2.3655e-04
Validation rmse = 0.145376
Epoch 36
Loss = 8.4314e-02, PNorm = 35.3933, GNorm = 0.9069, lr_0 = 2.3075e-04
Validation rmse = 0.143432
Epoch 37
Loss = 7.2506e-02, PNorm = 35.3998, GNorm = 2.4269, lr_0 = 2.2510e-04
Loss = 1.0571e-01, PNorm = 35.4071, GNorm = 0.8318, lr_0 = 2.1958e-04
Validation rmse = 0.145303
Epoch 38
Loss = 7.3769e-02, PNorm = 35.4137, GNorm = 1.3038, lr_0 = 2.1420e-04
Loss = 1.1805e-01, PNorm = 35.4205, GNorm = 1.9040, lr_0 = 2.0895e-04
Validation rmse = 0.145850
Epoch 39
Loss = 1.0214e-01, PNorm = 35.4269, GNorm = 2.5634, lr_0 = 2.0383e-04
Validation rmse = 0.143709
Epoch 40
Loss = 8.0398e-02, PNorm = 35.4340, GNorm = 2.6772, lr_0 = 1.9883e-04
Loss = 9.8724e-02, PNorm = 35.4416, GNorm = 2.1430, lr_0 = 1.9396e-04
Validation rmse = 0.150288
Epoch 41
Loss = 8.5285e-02, PNorm = 35.4476, GNorm = 2.0243, lr_0 = 1.8921e-04
Loss = 9.9182e-02, PNorm = 35.4539, GNorm = 1.1451, lr_0 = 1.8457e-04
Validation rmse = 0.144994
Epoch 42
Loss = 8.7714e-02, PNorm = 35.4592, GNorm = 1.4709, lr_0 = 1.8005e-04
Validation rmse = 0.144230
Epoch 43
Loss = 7.8206e-02, PNorm = 35.4645, GNorm = 1.0691, lr_0 = 1.7564e-04
Loss = 9.3321e-02, PNorm = 35.4708, GNorm = 0.8841, lr_0 = 1.7133e-04
Validation rmse = 0.144137
Epoch 44
Loss = 1.0171e-01, PNorm = 35.4761, GNorm = 1.9691, lr_0 = 1.6713e-04
Loss = 8.6309e-02, PNorm = 35.4804, GNorm = 0.9479, lr_0 = 1.6304e-04
Validation rmse = 0.143948
Epoch 45
Loss = 7.1664e-02, PNorm = 35.4869, GNorm = 0.5108, lr_0 = 1.5904e-04
Loss = 1.0111e-01, PNorm = 35.4909, GNorm = 1.5540, lr_0 = 1.5514e-04
Validation rmse = 0.147565
Epoch 46
Loss = 9.1703e-02, PNorm = 35.4948, GNorm = 1.1504, lr_0 = 1.5134e-04
Validation rmse = 0.143294
Epoch 47
Loss = 6.2509e-02, PNorm = 35.5001, GNorm = 0.5537, lr_0 = 1.4763e-04
Loss = 8.9781e-02, PNorm = 35.5044, GNorm = 1.5277, lr_0 = 1.4401e-04
Validation rmse = 0.146464
Epoch 48
Loss = 8.7600e-02, PNorm = 35.5096, GNorm = 1.2854, lr_0 = 1.4048e-04
Loss = 8.9659e-02, PNorm = 35.5145, GNorm = 1.3116, lr_0 = 1.3704e-04
Validation rmse = 0.144320
Epoch 49
Loss = 7.9873e-02, PNorm = 35.5181, GNorm = 1.1109, lr_0 = 1.3368e-04
Validation rmse = 0.146707
Epoch 50
Loss = 1.1687e-01, PNorm = 35.5233, GNorm = 2.3107, lr_0 = 1.3041e-04
Loss = 7.1946e-02, PNorm = 35.5285, GNorm = 0.3955, lr_0 = 1.2721e-04
Validation rmse = 0.144139
Epoch 51
Loss = 8.1929e-02, PNorm = 35.5326, GNorm = 1.7566, lr_0 = 1.2379e-04
Loss = 8.5506e-02, PNorm = 35.5367, GNorm = 0.6690, lr_0 = 1.2075e-04
Validation rmse = 0.144549
Epoch 52
Loss = 8.0597e-02, PNorm = 35.5408, GNorm = 1.7444, lr_0 = 1.1779e-04
Validation rmse = 0.146293
Epoch 53
Loss = 6.3108e-02, PNorm = 35.5448, GNorm = 2.6329, lr_0 = 1.1491e-04
Loss = 9.1409e-02, PNorm = 35.5480, GNorm = 0.5277, lr_0 = 1.1209e-04
Validation rmse = 0.143530
Epoch 54
Loss = 1.0244e-01, PNorm = 35.5514, GNorm = 1.6984, lr_0 = 1.0934e-04
Loss = 7.4791e-02, PNorm = 35.5542, GNorm = 1.6486, lr_0 = 1.0666e-04
Validation rmse = 0.143597
Epoch 55
Loss = 7.9135e-02, PNorm = 35.5576, GNorm = 1.2756, lr_0 = 1.0405e-04
Validation rmse = 0.145920
Epoch 56
Loss = 7.0089e-02, PNorm = 35.5613, GNorm = 0.8177, lr_0 = 1.0150e-04
Loss = 9.0701e-02, PNorm = 35.5641, GNorm = 0.7088, lr_0 = 1.0000e-04
Validation rmse = 0.143416
Epoch 57
Loss = 1.1456e-01, PNorm = 35.5669, GNorm = 1.6318, lr_0 = 1.0000e-04
Loss = 6.7612e-02, PNorm = 35.5707, GNorm = 0.7947, lr_0 = 1.0000e-04
Validation rmse = 0.144418
Epoch 58
Loss = 8.8248e-02, PNorm = 35.5733, GNorm = 1.3848, lr_0 = 1.0000e-04
Loss = 7.7626e-02, PNorm = 35.5775, GNorm = 0.9505, lr_0 = 1.0000e-04
Validation rmse = 0.146442
Epoch 59
Loss = 9.2676e-02, PNorm = 35.5813, GNorm = 0.9104, lr_0 = 1.0000e-04
Validation rmse = 0.143441
Model 0 best validation rmse = 0.143294 on epoch 46
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.237115
Ensemble test rmse = 0.237115
1-fold cross validation
	Seed 0 ==> test rmse = 0.237115
Overall test rmse = 0.237115 +/- 0.000000
Elapsed time = 0:00:31
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,057 | train size = 840 | val size = 211 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.2223e-01, PNorm = 34.0156, GNorm = 2.2008, lr_0 = 4.0937e-04
Validation rmse = 0.299114
Epoch 1
Loss = 6.9617e-01, PNorm = 34.0441, GNorm = 3.4953, lr_0 = 7.1875e-04
Loss = 7.1411e-01, PNorm = 34.0972, GNorm = 19.3607, lr_0 = 1.0000e-03
Validation rmse = 0.306450
Epoch 2
Loss = 6.0272e-01, PNorm = 34.1469, GNorm = 4.0346, lr_0 = 9.7549e-04
Loss = 4.6670e-01, PNorm = 34.2082, GNorm = 4.0736, lr_0 = 9.5159e-04
Validation rmse = 0.220182
Epoch 3
Loss = 4.0285e-01, PNorm = 34.2761, GNorm = 3.9855, lr_0 = 9.2827e-04
Validation rmse = 0.217561
Epoch 4
Loss = 2.8567e-01, PNorm = 34.3378, GNorm = 0.8620, lr_0 = 9.0552e-04
Loss = 3.8411e-01, PNorm = 34.3853, GNorm = 1.2446, lr_0 = 8.8333e-04
Validation rmse = 0.215570
Epoch 5
Loss = 2.6497e-01, PNorm = 34.4366, GNorm = 5.5682, lr_0 = 8.6168e-04
Loss = 2.9455e-01, PNorm = 34.4879, GNorm = 1.0713, lr_0 = 8.4056e-04
Loss = 3.7262e-01, PNorm = 34.4913, GNorm = 4.2998, lr_0 = 8.3848e-04
Validation rmse = 0.179157
Epoch 6
Loss = 2.2393e-01, PNorm = 34.5324, GNorm = 0.8093, lr_0 = 8.1793e-04
Validation rmse = 0.170425
Epoch 7
Loss = 2.2356e-01, PNorm = 34.5733, GNorm = 3.5272, lr_0 = 7.9788e-04
Loss = 2.0557e-01, PNorm = 34.6068, GNorm = 2.0602, lr_0 = 7.7833e-04
Validation rmse = 0.165261
Epoch 8
Loss = 2.2647e-01, PNorm = 34.6444, GNorm = 3.0964, lr_0 = 7.5926e-04
Loss = 1.9963e-01, PNorm = 34.6780, GNorm = 6.0704, lr_0 = 7.4065e-04
Validation rmse = 0.174019
Epoch 9
Loss = 2.2936e-01, PNorm = 34.7105, GNorm = 2.0412, lr_0 = 7.2250e-04
Validation rmse = 0.153008
Epoch 10
Loss = 1.5819e-01, PNorm = 34.7463, GNorm = 2.8546, lr_0 = 7.0479e-04
Loss = 1.9167e-01, PNorm = 34.7743, GNorm = 5.1879, lr_0 = 6.8752e-04
Validation rmse = 0.148024
Epoch 11
Loss = 1.5575e-01, PNorm = 34.8065, GNorm = 2.0523, lr_0 = 6.6901e-04
Loss = 1.8735e-01, PNorm = 34.8293, GNorm = 9.5127, lr_0 = 6.5261e-04
Validation rmse = 0.148677
Epoch 12
Loss = 2.4193e-01, PNorm = 34.8551, GNorm = 0.9370, lr_0 = 6.3662e-04
Validation rmse = 0.146678
Epoch 13
Loss = 1.1789e-01, PNorm = 34.8823, GNorm = 2.2509, lr_0 = 6.2102e-04
Loss = 1.6948e-01, PNorm = 34.9076, GNorm = 1.4932, lr_0 = 6.0580e-04
Validation rmse = 0.142144
Epoch 14
Loss = 1.3214e-01, PNorm = 34.9302, GNorm = 1.7909, lr_0 = 5.9095e-04
Loss = 1.3828e-01, PNorm = 34.9514, GNorm = 1.1692, lr_0 = 5.7647e-04
Validation rmse = 0.137652
Epoch 15
Loss = 1.4895e-01, PNorm = 34.9672, GNorm = 1.6192, lr_0 = 5.6234e-04
Validation rmse = 0.141435
Epoch 16
Loss = 1.6478e-01, PNorm = 34.9892, GNorm = 2.6539, lr_0 = 5.4720e-04
Loss = 1.4193e-01, PNorm = 35.0065, GNorm = 1.9283, lr_0 = 5.3379e-04
Validation rmse = 0.138681
Epoch 17
Loss = 9.6533e-02, PNorm = 35.0223, GNorm = 1.8642, lr_0 = 5.2071e-04
Loss = 1.3877e-01, PNorm = 35.0380, GNorm = 3.6291, lr_0 = 5.0795e-04
Validation rmse = 0.138716
Epoch 18
Loss = 1.2928e-01, PNorm = 35.0541, GNorm = 1.9217, lr_0 = 4.9550e-04
Validation rmse = 0.149510
Epoch 19
Loss = 2.4177e-01, PNorm = 35.0703, GNorm = 4.0137, lr_0 = 4.8336e-04
Loss = 1.2936e-01, PNorm = 35.0844, GNorm = 2.4250, lr_0 = 4.7151e-04
Validation rmse = 0.138866
Epoch 20
Loss = 1.1147e-01, PNorm = 35.0982, GNorm = 1.1670, lr_0 = 4.5996e-04
Loss = 1.1375e-01, PNorm = 35.1107, GNorm = 1.6840, lr_0 = 4.4868e-04
Validation rmse = 0.130363
Epoch 21
Loss = 1.0909e-01, PNorm = 35.1253, GNorm = 0.5418, lr_0 = 4.3660e-04
Validation rmse = 0.132755
Epoch 22
Loss = 8.1429e-02, PNorm = 35.1405, GNorm = 1.6495, lr_0 = 4.2590e-04
Loss = 1.1820e-01, PNorm = 35.1530, GNorm = 1.5638, lr_0 = 4.1547e-04
Validation rmse = 0.131773
Epoch 23
Loss = 1.1566e-01, PNorm = 35.1668, GNorm = 2.2920, lr_0 = 4.0528e-04
Loss = 1.2402e-01, PNorm = 35.1814, GNorm = 1.0966, lr_0 = 3.9535e-04
Validation rmse = 0.135161
Epoch 24
Loss = 1.2509e-01, PNorm = 35.1942, GNorm = 2.2065, lr_0 = 3.8566e-04
Loss = 1.0034e-01, PNorm = 35.2056, GNorm = 0.9760, lr_0 = 3.7621e-04
Validation rmse = 0.129557
Epoch 25
Loss = 1.0768e-01, PNorm = 35.2147, GNorm = 4.5911, lr_0 = 3.6699e-04
Validation rmse = 0.134837
Epoch 26
Loss = 1.0769e-01, PNorm = 35.2277, GNorm = 1.0008, lr_0 = 3.5711e-04
Loss = 1.1810e-01, PNorm = 35.2381, GNorm = 0.7265, lr_0 = 3.4836e-04
Validation rmse = 0.127928
Epoch 27
Loss = 9.7782e-02, PNorm = 35.2513, GNorm = 4.1953, lr_0 = 3.3982e-04
Loss = 1.2000e-01, PNorm = 35.2611, GNorm = 1.3755, lr_0 = 3.3149e-04
Validation rmse = 0.128962
Epoch 28
Loss = 1.0916e-01, PNorm = 35.2714, GNorm = 2.3655, lr_0 = 3.2337e-04
Validation rmse = 0.126910
Epoch 29
Loss = 1.2518e-01, PNorm = 35.2808, GNorm = 4.5454, lr_0 = 3.1544e-04
Loss = 1.1669e-01, PNorm = 35.2907, GNorm = 3.8616, lr_0 = 3.0771e-04
Validation rmse = 0.130931
Epoch 30
Loss = 7.7832e-02, PNorm = 35.2994, GNorm = 0.6310, lr_0 = 3.0017e-04
Loss = 1.2308e-01, PNorm = 35.3086, GNorm = 2.5939, lr_0 = 2.9282e-04
Loss = 8.9531e-02, PNorm = 35.3096, GNorm = 2.8515, lr_0 = 2.9209e-04
Validation rmse = 0.129762
Epoch 31
Loss = 9.1191e-02, PNorm = 35.3209, GNorm = 2.1106, lr_0 = 2.8493e-04
Validation rmse = 0.126552
Epoch 32
Loss = 9.4337e-02, PNorm = 35.3298, GNorm = 1.7794, lr_0 = 2.7795e-04
Loss = 9.3752e-02, PNorm = 35.3381, GNorm = 1.3189, lr_0 = 2.7114e-04
Validation rmse = 0.126615
Epoch 33
Loss = 9.8949e-02, PNorm = 35.3459, GNorm = 1.5101, lr_0 = 2.6449e-04
Loss = 9.5203e-02, PNorm = 35.3542, GNorm = 1.1401, lr_0 = 2.5801e-04
Validation rmse = 0.126904
Epoch 34
Loss = 9.3435e-02, PNorm = 35.3618, GNorm = 1.5349, lr_0 = 2.5169e-04
Validation rmse = 0.128781
Epoch 35
Loss = 9.8431e-02, PNorm = 35.3698, GNorm = 4.5698, lr_0 = 2.4552e-04
Loss = 1.0398e-01, PNorm = 35.3774, GNorm = 0.7491, lr_0 = 2.3950e-04
Validation rmse = 0.126048
Epoch 36
Loss = 9.2525e-02, PNorm = 35.3851, GNorm = 3.7331, lr_0 = 2.3305e-04
Loss = 1.0377e-01, PNorm = 35.3918, GNorm = 3.1818, lr_0 = 2.2734e-04
Validation rmse = 0.124960
Epoch 37
Loss = 9.8923e-02, PNorm = 35.3988, GNorm = 3.3262, lr_0 = 2.2177e-04
Validation rmse = 0.124665
Epoch 38
Loss = 4.2403e-02, PNorm = 35.4062, GNorm = 0.5989, lr_0 = 2.1634e-04
Loss = 8.9417e-02, PNorm = 35.4127, GNorm = 0.8580, lr_0 = 2.1103e-04
Validation rmse = 0.124120
Epoch 39
Loss = 8.5532e-02, PNorm = 35.4195, GNorm = 1.1491, lr_0 = 2.0586e-04
Loss = 8.9760e-02, PNorm = 35.4265, GNorm = 1.2914, lr_0 = 2.0082e-04
Validation rmse = 0.125510
Epoch 40
Loss = 1.0233e-01, PNorm = 35.4312, GNorm = 3.9588, lr_0 = 1.9590e-04
Validation rmse = 0.130881
Epoch 41
Loss = 1.3246e-01, PNorm = 35.4377, GNorm = 3.3662, lr_0 = 1.9062e-04
Loss = 9.1576e-02, PNorm = 35.4433, GNorm = 0.7375, lr_0 = 1.8595e-04
Validation rmse = 0.130052
Epoch 42
Loss = 9.6177e-02, PNorm = 35.4497, GNorm = 0.7594, lr_0 = 1.8139e-04
Loss = 9.0608e-02, PNorm = 35.4549, GNorm = 0.7444, lr_0 = 1.7695e-04
Validation rmse = 0.128508
Epoch 43
Loss = 7.6803e-02, PNorm = 35.4609, GNorm = 1.1741, lr_0 = 1.7261e-04
Validation rmse = 0.123903
Epoch 44
Loss = 8.6590e-02, PNorm = 35.4646, GNorm = 1.8047, lr_0 = 1.6838e-04
Loss = 9.3734e-02, PNorm = 35.4697, GNorm = 0.5547, lr_0 = 1.6425e-04
Validation rmse = 0.124005
Epoch 45
Loss = 1.0448e-01, PNorm = 35.4745, GNorm = 2.3966, lr_0 = 1.6023e-04
Loss = 8.6287e-02, PNorm = 35.4793, GNorm = 3.0214, lr_0 = 1.5630e-04
Validation rmse = 0.123730
Epoch 46
Loss = 6.5402e-02, PNorm = 35.4847, GNorm = 1.5592, lr_0 = 1.5209e-04
Validation rmse = 0.124421
Epoch 47
Loss = 1.2547e-01, PNorm = 35.4884, GNorm = 0.8206, lr_0 = 1.4837e-04
Loss = 8.7864e-02, PNorm = 35.4933, GNorm = 1.3816, lr_0 = 1.4473e-04
Validation rmse = 0.123579
Epoch 48
Loss = 9.9132e-02, PNorm = 35.4974, GNorm = 0.8005, lr_0 = 1.4118e-04
Loss = 8.2666e-02, PNorm = 35.5016, GNorm = 1.1121, lr_0 = 1.3772e-04
Validation rmse = 0.123317
Epoch 49
Loss = 7.5919e-02, PNorm = 35.5052, GNorm = 1.0478, lr_0 = 1.3435e-04
Loss = 9.1936e-02, PNorm = 35.5087, GNorm = 1.9138, lr_0 = 1.3106e-04
Validation rmse = 0.123615
Epoch 50
Loss = 8.6189e-02, PNorm = 35.5122, GNorm = 0.4555, lr_0 = 1.2784e-04
Validation rmse = 0.123696
Epoch 51
Loss = 7.1523e-02, PNorm = 35.5168, GNorm = 0.5957, lr_0 = 1.2440e-04
Loss = 9.7694e-02, PNorm = 35.5209, GNorm = 1.6858, lr_0 = 1.2135e-04
Validation rmse = 0.126580
Epoch 52
Loss = 7.4039e-02, PNorm = 35.5234, GNorm = 0.6630, lr_0 = 1.1838e-04
Loss = 9.4608e-02, PNorm = 35.5273, GNorm = 0.8454, lr_0 = 1.1548e-04
Validation rmse = 0.124530
Epoch 53
Loss = 7.3475e-02, PNorm = 35.5306, GNorm = 2.3552, lr_0 = 1.1265e-04
Validation rmse = 0.122990
Epoch 54
Loss = 8.5745e-02, PNorm = 35.5332, GNorm = 0.9114, lr_0 = 1.0989e-04
Loss = 8.3753e-02, PNorm = 35.5374, GNorm = 0.4427, lr_0 = 1.0719e-04
Validation rmse = 0.122779
Epoch 55
Loss = 8.9157e-02, PNorm = 35.5407, GNorm = 1.6164, lr_0 = 1.0457e-04
Loss = 8.1947e-02, PNorm = 35.5439, GNorm = 0.7603, lr_0 = 1.0200e-04
Loss = 5.6474e-02, PNorm = 35.5442, GNorm = 1.2050, lr_0 = 1.0175e-04
Validation rmse = 0.123988
Epoch 56
Loss = 9.5639e-02, PNorm = 35.5472, GNorm = 2.1718, lr_0 = 1.0000e-04
Validation rmse = 0.125584
Epoch 57
Loss = 1.0632e-01, PNorm = 35.5500, GNorm = 1.1556, lr_0 = 1.0000e-04
Loss = 8.2034e-02, PNorm = 35.5529, GNorm = 1.1681, lr_0 = 1.0000e-04
Validation rmse = 0.124037
Epoch 58
Loss = 1.0056e-01, PNorm = 35.5556, GNorm = 0.8926, lr_0 = 1.0000e-04
Loss = 7.1831e-02, PNorm = 35.5591, GNorm = 0.9101, lr_0 = 1.0000e-04
Validation rmse = 0.123108
Epoch 59
Loss = 7.6697e-02, PNorm = 35.5621, GNorm = 0.6554, lr_0 = 1.0000e-04
Validation rmse = 0.122628
Model 0 best validation rmse = 0.122628 on epoch 59
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.216952
Ensemble test rmse = 0.216952
1-fold cross validation
	Seed 0 ==> test rmse = 0.216952
Overall test rmse = 0.216952 +/- 0.000000
Elapsed time = 0:00:32
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,047 | train size = 832 | val size = 209 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.7891e-01, PNorm = 34.0178, GNorm = 1.0750, lr_0 = 4.0937e-04
Validation rmse = 0.290879
Epoch 1
Loss = 6.5693e-01, PNorm = 34.0562, GNorm = 7.1910, lr_0 = 7.1875e-04
Loss = 5.5548e-01, PNorm = 34.0999, GNorm = 2.9728, lr_0 = 1.0000e-03
Validation rmse = 0.256048
Epoch 2
Loss = 4.5083e-01, PNorm = 34.1650, GNorm = 3.6176, lr_0 = 9.7549e-04
Validation rmse = 0.192792
Epoch 3
Loss = 3.8468e-01, PNorm = 34.2318, GNorm = 3.6020, lr_0 = 9.4923e-04
Loss = 3.7320e-01, PNorm = 34.2946, GNorm = 6.4995, lr_0 = 9.2597e-04
Validation rmse = 0.234235
Epoch 4
Loss = 2.7661e-01, PNorm = 34.3388, GNorm = 6.2687, lr_0 = 9.0327e-04
Loss = 3.0651e-01, PNorm = 34.3924, GNorm = 1.3589, lr_0 = 8.8114e-04
Validation rmse = 0.179645
Epoch 5
Loss = 3.5580e-01, PNorm = 34.4350, GNorm = 11.8261, lr_0 = 8.5954e-04
Validation rmse = 0.205256
Epoch 6
Loss = 3.6915e-01, PNorm = 34.4823, GNorm = 8.5559, lr_0 = 8.3640e-04
Loss = 2.5645e-01, PNorm = 34.5212, GNorm = 6.2005, lr_0 = 8.1590e-04
Validation rmse = 0.161047
Epoch 7
Loss = 1.9764e-01, PNorm = 34.5591, GNorm = 2.9388, lr_0 = 7.9591e-04
Loss = 2.1207e-01, PNorm = 34.5922, GNorm = 3.8430, lr_0 = 7.7640e-04
Validation rmse = 0.148268
Epoch 8
Loss = 1.8955e-01, PNorm = 34.6298, GNorm = 1.8742, lr_0 = 7.5737e-04
Validation rmse = 0.160104
Epoch 9
Loss = 1.3998e-01, PNorm = 34.6698, GNorm = 2.0913, lr_0 = 7.3698e-04
Loss = 1.9992e-01, PNorm = 34.6936, GNorm = 2.8340, lr_0 = 7.1892e-04
Validation rmse = 0.139836
Epoch 10
Loss = 2.2138e-01, PNorm = 34.7281, GNorm = 6.4830, lr_0 = 7.0130e-04
Loss = 1.7839e-01, PNorm = 34.7594, GNorm = 4.4840, lr_0 = 6.8412e-04
Validation rmse = 0.138753
Epoch 11
Loss = 1.6958e-01, PNorm = 34.7870, GNorm = 5.4522, lr_0 = 6.6735e-04
Validation rmse = 0.134984
Epoch 12
Loss = 1.2383e-01, PNorm = 34.8140, GNorm = 1.4414, lr_0 = 6.4938e-04
Loss = 1.5920e-01, PNorm = 34.8376, GNorm = 1.9621, lr_0 = 6.3347e-04
Validation rmse = 0.136683
Epoch 13
Loss = 1.4636e-01, PNorm = 34.8624, GNorm = 1.8400, lr_0 = 6.1794e-04
Loss = 1.4879e-01, PNorm = 34.8856, GNorm = 2.7828, lr_0 = 6.0280e-04
Validation rmse = 0.138234
Epoch 14
Loss = 1.2747e-01, PNorm = 34.9091, GNorm = 2.2469, lr_0 = 5.8657e-04
Validation rmse = 0.130980
Epoch 15
Loss = 1.4160e-01, PNorm = 34.9307, GNorm = 0.9546, lr_0 = 5.7219e-04
Loss = 1.4325e-01, PNorm = 34.9477, GNorm = 3.4482, lr_0 = 5.5817e-04
Validation rmse = 0.156294
Epoch 16
Loss = 1.3952e-01, PNorm = 34.9696, GNorm = 2.4044, lr_0 = 5.4449e-04
Loss = 1.5550e-01, PNorm = 34.9910, GNorm = 4.3346, lr_0 = 5.3115e-04
Validation rmse = 0.150673
Epoch 17
Loss = 1.5116e-01, PNorm = 35.0145, GNorm = 5.0778, lr_0 = 5.1685e-04
Validation rmse = 0.127069
Epoch 18
Loss = 9.4717e-02, PNorm = 35.0341, GNorm = 0.8856, lr_0 = 5.0418e-04
Loss = 1.4331e-01, PNorm = 35.0535, GNorm = 3.4699, lr_0 = 4.9182e-04
Validation rmse = 0.128849
Epoch 19
Loss = 1.7214e-01, PNorm = 35.0720, GNorm = 5.5167, lr_0 = 4.7977e-04
Loss = 1.3623e-01, PNorm = 35.0931, GNorm = 2.7659, lr_0 = 4.6801e-04
Validation rmse = 0.140651
Epoch 20
Loss = 9.7668e-02, PNorm = 35.1081, GNorm = 0.8360, lr_0 = 4.5541e-04
Validation rmse = 0.127353
Epoch 21
Loss = 1.0167e-01, PNorm = 35.1239, GNorm = 1.4247, lr_0 = 4.4425e-04
Loss = 1.2091e-01, PNorm = 35.1386, GNorm = 1.5434, lr_0 = 4.3336e-04
Validation rmse = 0.127689
Epoch 22
Loss = 1.2709e-01, PNorm = 35.1507, GNorm = 0.9699, lr_0 = 4.2274e-04
Loss = 1.1620e-01, PNorm = 35.1630, GNorm = 1.2442, lr_0 = 4.1238e-04
Validation rmse = 0.124202
Epoch 23
Loss = 9.5582e-02, PNorm = 35.1763, GNorm = 0.5307, lr_0 = 4.0128e-04
Validation rmse = 0.130956
Epoch 24
Loss = 1.4158e-01, PNorm = 35.1874, GNorm = 1.3166, lr_0 = 3.9145e-04
Loss = 1.1483e-01, PNorm = 35.1984, GNorm = 1.2351, lr_0 = 3.8185e-04
Validation rmse = 0.124193
Epoch 25
Loss = 1.4657e-01, PNorm = 35.2110, GNorm = 2.5399, lr_0 = 3.7250e-04
Loss = 9.8662e-02, PNorm = 35.2228, GNorm = 0.6121, lr_0 = 3.6337e-04
Validation rmse = 0.127253
Epoch 26
Loss = 1.0887e-01, PNorm = 35.2320, GNorm = 4.1177, lr_0 = 3.5358e-04
Validation rmse = 0.125674
Epoch 27
Loss = 1.0135e-01, PNorm = 35.2435, GNorm = 1.3292, lr_0 = 3.4492e-04
Loss = 1.1247e-01, PNorm = 35.2545, GNorm = 2.7494, lr_0 = 3.3646e-04
Validation rmse = 0.122941
Epoch 28
Loss = 1.3128e-01, PNorm = 35.2652, GNorm = 1.5187, lr_0 = 3.2741e-04
Loss = 9.2583e-02, PNorm = 35.2756, GNorm = 1.0183, lr_0 = 3.1938e-04
Validation rmse = 0.123733
Epoch 29
Loss = 1.0470e-01, PNorm = 35.2855, GNorm = 3.4710, lr_0 = 3.1155e-04
Validation rmse = 0.126861
Epoch 30
Loss = 9.9587e-02, PNorm = 35.2949, GNorm = 1.3115, lr_0 = 3.0392e-04
Loss = 9.8640e-02, PNorm = 35.3035, GNorm = 0.5796, lr_0 = 2.9647e-04
Validation rmse = 0.122879
Epoch 31
Loss = 1.0459e-01, PNorm = 35.3131, GNorm = 2.7174, lr_0 = 2.8849e-04
Loss = 9.9394e-02, PNorm = 35.3226, GNorm = 0.8587, lr_0 = 2.8142e-04
Validation rmse = 0.124101
Epoch 32
Loss = 1.0758e-01, PNorm = 35.3306, GNorm = 1.8704, lr_0 = 2.7452e-04
Validation rmse = 0.121876
Epoch 33
Loss = 1.0376e-01, PNorm = 35.3396, GNorm = 1.4050, lr_0 = 2.6779e-04
Loss = 1.0379e-01, PNorm = 35.3473, GNorm = 0.6853, lr_0 = 2.6123e-04
Validation rmse = 0.121101
Epoch 34
Loss = 1.0802e-01, PNorm = 35.3578, GNorm = 1.8277, lr_0 = 2.5420e-04
Loss = 9.7480e-02, PNorm = 35.3643, GNorm = 1.2011, lr_0 = 2.4797e-04
Validation rmse = 0.120244
Epoch 35
Loss = 8.3533e-02, PNorm = 35.3722, GNorm = 0.8310, lr_0 = 2.4189e-04
Validation rmse = 0.127497
Epoch 36
Loss = 1.0027e-01, PNorm = 35.3807, GNorm = 1.4265, lr_0 = 2.3596e-04
Loss = 9.1429e-02, PNorm = 35.3884, GNorm = 1.7475, lr_0 = 2.3018e-04
Validation rmse = 0.120823
Epoch 37
Loss = 8.6480e-02, PNorm = 35.3959, GNorm = 0.9322, lr_0 = 2.2398e-04
Loss = 8.8318e-02, PNorm = 35.4026, GNorm = 2.3993, lr_0 = 2.1849e-04
Validation rmse = 0.129281
Epoch 38
Loss = 9.8422e-02, PNorm = 35.4097, GNorm = 0.5120, lr_0 = 2.1314e-04
Validation rmse = 0.122995
Epoch 39
Loss = 5.9237e-02, PNorm = 35.4177, GNorm = 1.2748, lr_0 = 2.0740e-04
Loss = 9.7321e-02, PNorm = 35.4243, GNorm = 0.7659, lr_0 = 2.0232e-04
Validation rmse = 0.123804
Epoch 40
Loss = 1.0125e-01, PNorm = 35.4313, GNorm = 0.9244, lr_0 = 1.9736e-04
Loss = 9.1213e-02, PNorm = 35.4372, GNorm = 0.5628, lr_0 = 1.9252e-04
Validation rmse = 0.119983
Epoch 41
Loss = 1.0120e-01, PNorm = 35.4441, GNorm = 0.5387, lr_0 = 1.8780e-04
Validation rmse = 0.127251
Epoch 42
Loss = 1.1184e-01, PNorm = 35.4502, GNorm = 2.8873, lr_0 = 1.8275e-04
Loss = 8.8821e-02, PNorm = 35.4565, GNorm = 1.1144, lr_0 = 1.7827e-04
Validation rmse = 0.121582
Epoch 43
Loss = 7.2730e-02, PNorm = 35.4627, GNorm = 0.4793, lr_0 = 1.7390e-04
Loss = 1.0373e-01, PNorm = 35.4685, GNorm = 2.8929, lr_0 = 1.6964e-04
Validation rmse = 0.119790
Epoch 44
Loss = 1.0136e-01, PNorm = 35.4743, GNorm = 2.6729, lr_0 = 1.6548e-04
Validation rmse = 0.128253
Epoch 45
Loss = 5.8317e-02, PNorm = 35.4806, GNorm = 1.3582, lr_0 = 1.6103e-04
Loss = 8.4287e-02, PNorm = 35.4856, GNorm = 1.0001, lr_0 = 1.5708e-04
Validation rmse = 0.122356
Epoch 46
Loss = 7.7600e-02, PNorm = 35.4906, GNorm = 0.9546, lr_0 = 1.5323e-04
Loss = 9.6663e-02, PNorm = 35.4953, GNorm = 1.7954, lr_0 = 1.4948e-04
Validation rmse = 0.126755
Epoch 47
Loss = 8.8779e-02, PNorm = 35.4998, GNorm = 3.3371, lr_0 = 1.4581e-04
Validation rmse = 0.120794
Epoch 48
Loss = 1.4140e-01, PNorm = 35.5039, GNorm = 1.3913, lr_0 = 1.4189e-04
Loss = 8.2108e-02, PNorm = 35.5102, GNorm = 1.1163, lr_0 = 1.3841e-04
Validation rmse = 0.120528
Epoch 49
Loss = 7.6448e-02, PNorm = 35.5141, GNorm = 0.8821, lr_0 = 1.3502e-04
Loss = 9.4167e-02, PNorm = 35.5178, GNorm = 1.6623, lr_0 = 1.3171e-04
Validation rmse = 0.120938
Epoch 50
Loss = 7.3850e-02, PNorm = 35.5229, GNorm = 2.6948, lr_0 = 1.2848e-04
Validation rmse = 0.119136
Epoch 51
Loss = 5.3032e-02, PNorm = 35.5270, GNorm = 0.6283, lr_0 = 1.2502e-04
Loss = 7.4913e-02, PNorm = 35.5307, GNorm = 0.7303, lr_0 = 1.2196e-04
Validation rmse = 0.120839
Epoch 52
Loss = 7.7756e-02, PNorm = 35.5348, GNorm = 0.6049, lr_0 = 1.1897e-04
Loss = 8.8742e-02, PNorm = 35.5385, GNorm = 2.9606, lr_0 = 1.1605e-04
Validation rmse = 0.120016
Epoch 53
Loss = 7.7868e-02, PNorm = 35.5422, GNorm = 0.5008, lr_0 = 1.1293e-04
Validation rmse = 0.120250
Epoch 54
Loss = 8.4811e-02, PNorm = 35.5455, GNorm = 0.8156, lr_0 = 1.1016e-04
Loss = 8.5818e-02, PNorm = 35.5483, GNorm = 0.8817, lr_0 = 1.0746e-04
Validation rmse = 0.120263
Epoch 55
Loss = 1.0176e-01, PNorm = 35.5525, GNorm = 3.2597, lr_0 = 1.0483e-04
Loss = 7.4532e-02, PNorm = 35.5551, GNorm = 1.3191, lr_0 = 1.0226e-04
Validation rmse = 0.119391
Epoch 56
Loss = 8.9438e-02, PNorm = 35.5588, GNorm = 1.4446, lr_0 = 1.0000e-04
Validation rmse = 0.120143
Epoch 57
Loss = 8.3441e-02, PNorm = 35.5621, GNorm = 1.3489, lr_0 = 1.0000e-04
Loss = 8.1006e-02, PNorm = 35.5654, GNorm = 0.6783, lr_0 = 1.0000e-04
Validation rmse = 0.119351
Epoch 58
Loss = 6.7391e-02, PNorm = 35.5676, GNorm = 1.8341, lr_0 = 1.0000e-04
Loss = 8.6204e-02, PNorm = 35.5713, GNorm = 0.5721, lr_0 = 1.0000e-04
Validation rmse = 0.122266
Epoch 59
Loss = 7.5093e-02, PNorm = 35.5747, GNorm = 0.7997, lr_0 = 1.0000e-04
Validation rmse = 0.120155
Model 0 best validation rmse = 0.119136 on epoch 50
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.140795
Ensemble test rmse = 0.140795
1-fold cross validation
	Seed 0 ==> test rmse = 0.140795
Overall test rmse = 0.140795 +/- 0.000000
Elapsed time = 0:00:30
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,037 | train size = 824 | val size = 207 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.3616e-01, PNorm = 34.0153, GNorm = 1.6407, lr_0 = 4.0937e-04
Validation rmse = 0.310620
Epoch 1
Loss = 7.2742e-01, PNorm = 34.0491, GNorm = 4.3890, lr_0 = 7.1875e-04
Loss = 6.9646e-01, PNorm = 34.0975, GNorm = 16.4053, lr_0 = 1.0000e-03
Validation rmse = 0.284185
Epoch 2
Loss = 7.1902e-01, PNorm = 34.1528, GNorm = 11.0494, lr_0 = 9.7308e-04
Validation rmse = 0.246629
Epoch 3
Loss = 5.5542e-01, PNorm = 34.2152, GNorm = 5.8503, lr_0 = 9.4923e-04
Loss = 4.8254e-01, PNorm = 34.2769, GNorm = 5.0754, lr_0 = 9.2597e-04
Validation rmse = 0.260616
Epoch 4
Loss = 4.8363e-01, PNorm = 34.3354, GNorm = 5.3763, lr_0 = 9.0103e-04
Loss = 4.1359e-01, PNorm = 34.3922, GNorm = 1.8873, lr_0 = 8.7895e-04
Validation rmse = 0.209796
Epoch 5
Loss = 3.6291e-01, PNorm = 34.4533, GNorm = 3.3942, lr_0 = 8.5741e-04
Validation rmse = 0.218248
Epoch 6
Loss = 2.4395e-01, PNorm = 34.5085, GNorm = 0.6907, lr_0 = 8.3433e-04
Loss = 2.8793e-01, PNorm = 34.5474, GNorm = 3.0073, lr_0 = 8.1388e-04
Validation rmse = 0.195372
Epoch 7
Loss = 2.2634e-01, PNorm = 34.5913, GNorm = 0.8495, lr_0 = 7.9393e-04
Loss = 2.3122e-01, PNorm = 34.6341, GNorm = 2.2589, lr_0 = 7.7448e-04
Validation rmse = 0.168987
Epoch 8
Loss = 2.3254e-01, PNorm = 34.6710, GNorm = 3.5863, lr_0 = 7.5362e-04
Validation rmse = 0.159860
Epoch 9
Loss = 1.3382e-01, PNorm = 34.7047, GNorm = 2.6256, lr_0 = 7.3516e-04
Loss = 2.0104e-01, PNorm = 34.7425, GNorm = 4.0203, lr_0 = 7.1714e-04
Validation rmse = 0.159495
Epoch 10
Loss = 1.9183e-01, PNorm = 34.7801, GNorm = 0.5638, lr_0 = 6.9783e-04
Loss = 1.5428e-01, PNorm = 34.8124, GNorm = 2.1201, lr_0 = 6.8073e-04
Validation rmse = 0.172529
Epoch 11
Loss = 1.7062e-01, PNorm = 34.8480, GNorm = 1.0658, lr_0 = 6.6405e-04
Validation rmse = 0.152620
Epoch 12
Loss = 1.7294e-01, PNorm = 34.8788, GNorm = 1.3410, lr_0 = 6.4617e-04
Loss = 1.6870e-01, PNorm = 34.9046, GNorm = 5.3084, lr_0 = 6.3033e-04
Validation rmse = 0.149315
Epoch 13
Loss = 1.2154e-01, PNorm = 34.9270, GNorm = 5.2511, lr_0 = 6.1488e-04
Loss = 1.7993e-01, PNorm = 34.9544, GNorm = 3.4997, lr_0 = 5.9981e-04
Loss = 1.7692e-01, PNorm = 34.9571, GNorm = 3.8088, lr_0 = 5.9833e-04
Validation rmse = 0.147519
Epoch 14
Loss = 1.1840e-01, PNorm = 34.9840, GNorm = 2.5298, lr_0 = 5.8367e-04
Validation rmse = 0.142986
Epoch 15
Loss = 1.1242e-01, PNorm = 35.0055, GNorm = 0.7376, lr_0 = 5.6936e-04
Loss = 1.4645e-01, PNorm = 35.0267, GNorm = 0.6632, lr_0 = 5.5541e-04
Validation rmse = 0.157362
Epoch 16
Loss = 1.2274e-01, PNorm = 35.0516, GNorm = 1.0228, lr_0 = 5.4045e-04
Loss = 1.6301e-01, PNorm = 35.0672, GNorm = 2.1995, lr_0 = 5.2721e-04
Validation rmse = 0.141480
Epoch 17
Loss = 1.4163e-01, PNorm = 35.0838, GNorm = 5.0928, lr_0 = 5.1429e-04
Validation rmse = 0.144103
Epoch 18
Loss = 1.2825e-01, PNorm = 35.1025, GNorm = 3.0809, lr_0 = 5.0044e-04
Loss = 1.2700e-01, PNorm = 35.1213, GNorm = 2.4286, lr_0 = 4.8818e-04
Validation rmse = 0.140371
Epoch 19
Loss = 1.1115e-01, PNorm = 35.1360, GNorm = 1.2993, lr_0 = 4.7621e-04
Validation rmse = 0.139212
Epoch 20
Loss = 1.2311e-01, PNorm = 35.1562, GNorm = 0.5374, lr_0 = 4.6339e-04
Loss = 1.1452e-01, PNorm = 35.1706, GNorm = 1.5747, lr_0 = 4.5204e-04
Validation rmse = 0.139478
Epoch 21
Loss = 1.0330e-01, PNorm = 35.1855, GNorm = 2.5118, lr_0 = 4.4096e-04
Loss = 1.3106e-01, PNorm = 35.1982, GNorm = 2.9776, lr_0 = 4.3015e-04
Validation rmse = 0.136713
Epoch 22
Loss = 1.2716e-01, PNorm = 35.2139, GNorm = 0.9801, lr_0 = 4.1857e-04
Validation rmse = 0.145708
Epoch 23
Loss = 1.5748e-01, PNorm = 35.2272, GNorm = 3.0109, lr_0 = 4.0831e-04
Loss = 1.1241e-01, PNorm = 35.2411, GNorm = 2.1866, lr_0 = 3.9830e-04
Validation rmse = 0.144075
Epoch 24
Loss = 9.6150e-02, PNorm = 35.2533, GNorm = 0.8884, lr_0 = 3.8758e-04
Loss = 1.1595e-01, PNorm = 35.2662, GNorm = 4.3708, lr_0 = 3.7808e-04
Validation rmse = 0.140540
Epoch 25
Loss = 1.1538e-01, PNorm = 35.2751, GNorm = 1.1947, lr_0 = 3.6882e-04
Validation rmse = 0.150044
Epoch 26
Loss = 8.7800e-02, PNorm = 35.2874, GNorm = 3.5945, lr_0 = 3.5889e-04
Loss = 1.1083e-01, PNorm = 35.2956, GNorm = 1.8590, lr_0 = 3.5009e-04
Validation rmse = 0.152685
Epoch 27
Loss = 1.1213e-01, PNorm = 35.3101, GNorm = 1.2483, lr_0 = 3.4067e-04
Loss = 1.2002e-01, PNorm = 35.3199, GNorm = 1.4527, lr_0 = 3.3232e-04
Validation rmse = 0.145412
Epoch 28
Loss = 1.1623e-01, PNorm = 35.3322, GNorm = 4.4830, lr_0 = 3.2417e-04
Validation rmse = 0.155386
Epoch 29
Loss = 8.5405e-02, PNorm = 35.3406, GNorm = 1.0752, lr_0 = 3.1544e-04
Loss = 1.0565e-01, PNorm = 35.3520, GNorm = 1.2617, lr_0 = 3.0771e-04
Validation rmse = 0.139631
Epoch 30
Loss = 9.7757e-02, PNorm = 35.3612, GNorm = 0.3986, lr_0 = 3.0017e-04
Loss = 1.0027e-01, PNorm = 35.3697, GNorm = 1.3059, lr_0 = 2.9282e-04
Loss = 5.0645e-02, PNorm = 35.3701, GNorm = 1.0509, lr_0 = 2.9209e-04
Validation rmse = 0.139329
Epoch 31
Loss = 1.0591e-01, PNorm = 35.3780, GNorm = 1.5136, lr_0 = 2.8493e-04
Validation rmse = 0.144384
Epoch 32
Loss = 8.3224e-02, PNorm = 35.3861, GNorm = 2.3960, lr_0 = 2.7795e-04
Loss = 1.0780e-01, PNorm = 35.3943, GNorm = 4.0280, lr_0 = 2.7114e-04
Validation rmse = 0.137041
Epoch 33
Loss = 1.0399e-01, PNorm = 35.4012, GNorm = 1.2398, lr_0 = 2.6384e-04
Loss = 9.3476e-02, PNorm = 35.4104, GNorm = 1.1514, lr_0 = 2.5737e-04
Validation rmse = 0.144965
Epoch 34
Loss = 9.4436e-02, PNorm = 35.4181, GNorm = 1.6068, lr_0 = 2.5106e-04
Validation rmse = 0.142862
Epoch 35
Loss = 1.0467e-01, PNorm = 35.4262, GNorm = 1.1761, lr_0 = 2.4430e-04
Loss = 9.1300e-02, PNorm = 35.4335, GNorm = 3.3905, lr_0 = 2.3832e-04
Validation rmse = 0.140415
Epoch 36
Loss = 9.2090e-02, PNorm = 35.4412, GNorm = 1.6385, lr_0 = 2.3248e-04
Validation rmse = 0.147975
Epoch 37
Loss = 9.0955e-02, PNorm = 35.4480, GNorm = 2.3365, lr_0 = 2.2622e-04
Loss = 1.0426e-01, PNorm = 35.4541, GNorm = 0.8807, lr_0 = 2.2067e-04
Validation rmse = 0.143356
Epoch 38
Loss = 1.2452e-01, PNorm = 35.4603, GNorm = 0.7363, lr_0 = 2.1527e-04
Loss = 8.1633e-02, PNorm = 35.4659, GNorm = 1.2721, lr_0 = 2.0999e-04
Validation rmse = 0.139527
Epoch 39
Loss = 9.5951e-02, PNorm = 35.4727, GNorm = 3.4652, lr_0 = 2.0434e-04
Validation rmse = 0.149160
Epoch 40
Loss = 8.0682e-02, PNorm = 35.4775, GNorm = 2.4408, lr_0 = 1.9933e-04
Loss = 1.0814e-01, PNorm = 35.4832, GNorm = 4.6551, lr_0 = 1.9444e-04
Validation rmse = 0.138602
Epoch 41
Loss = 8.4412e-02, PNorm = 35.4886, GNorm = 0.6949, lr_0 = 1.8921e-04
Loss = 9.5086e-02, PNorm = 35.4935, GNorm = 2.0742, lr_0 = 1.8457e-04
Validation rmse = 0.137653
Epoch 42
Loss = 8.1780e-02, PNorm = 35.4998, GNorm = 1.9340, lr_0 = 1.8005e-04
Validation rmse = 0.140075
Epoch 43
Loss = 8.4059e-02, PNorm = 35.5069, GNorm = 0.9412, lr_0 = 1.7520e-04
Loss = 8.2733e-02, PNorm = 35.5117, GNorm = 2.3338, lr_0 = 1.7091e-04
Validation rmse = 0.139879
Epoch 44
Loss = 7.6168e-02, PNorm = 35.5162, GNorm = 1.6541, lr_0 = 1.6672e-04
Loss = 9.2915e-02, PNorm = 35.5213, GNorm = 2.0921, lr_0 = 1.6263e-04
Validation rmse = 0.138747
Epoch 45
Loss = 8.7581e-02, PNorm = 35.5260, GNorm = 0.4808, lr_0 = 1.5825e-04
Validation rmse = 0.138915
Epoch 46
Loss = 1.1909e-01, PNorm = 35.5308, GNorm = 2.0112, lr_0 = 1.5438e-04
Loss = 8.3573e-02, PNorm = 35.5347, GNorm = 1.1206, lr_0 = 1.5059e-04
Validation rmse = 0.144860
Epoch 47
Loss = 8.2159e-02, PNorm = 35.5395, GNorm = 1.4339, lr_0 = 1.4654e-04
Loss = 8.6650e-02, PNorm = 35.5440, GNorm = 0.7028, lr_0 = 1.4295e-04
Validation rmse = 0.139874
Epoch 48
Loss = 8.6969e-02, PNorm = 35.5477, GNorm = 1.1232, lr_0 = 1.3944e-04
Validation rmse = 0.137260
Epoch 49
Loss = 8.4955e-02, PNorm = 35.5511, GNorm = 0.6174, lr_0 = 1.3569e-04
Loss = 8.8156e-02, PNorm = 35.5549, GNorm = 1.4523, lr_0 = 1.3236e-04
Validation rmse = 0.139645
Epoch 50
Loss = 8.0101e-02, PNorm = 35.5588, GNorm = 0.4461, lr_0 = 1.2912e-04
Loss = 8.8817e-02, PNorm = 35.5624, GNorm = 0.9944, lr_0 = 1.2596e-04
Loss = 4.8592e-02, PNorm = 35.5627, GNorm = 1.3831, lr_0 = 1.2564e-04
Validation rmse = 0.137865
Epoch 51
Loss = 8.4532e-02, PNorm = 35.5658, GNorm = 1.5631, lr_0 = 1.2256e-04
Validation rmse = 0.142865
Epoch 52
Loss = 8.8976e-02, PNorm = 35.5702, GNorm = 2.0451, lr_0 = 1.1926e-04
Loss = 8.3399e-02, PNorm = 35.5734, GNorm = 1.8142, lr_0 = 1.1634e-04
Validation rmse = 0.141420
Epoch 53
Loss = 9.3890e-02, PNorm = 35.5773, GNorm = 2.4614, lr_0 = 1.1349e-04
Validation rmse = 0.137025
Epoch 54
Loss = 1.6140e-01, PNorm = 35.5816, GNorm = 2.1543, lr_0 = 1.1043e-04
Loss = 7.4638e-02, PNorm = 35.5854, GNorm = 1.1920, lr_0 = 1.0773e-04
Validation rmse = 0.138085
Epoch 55
Loss = 9.9976e-02, PNorm = 35.5878, GNorm = 1.5200, lr_0 = 1.0509e-04
Loss = 7.5333e-02, PNorm = 35.5905, GNorm = 0.9091, lr_0 = 1.0251e-04
Validation rmse = 0.136869
Epoch 56
Loss = 6.9684e-02, PNorm = 35.5936, GNorm = 0.6248, lr_0 = 1.0000e-04
Validation rmse = 0.138528
Epoch 57
Loss = 4.2427e-02, PNorm = 35.5965, GNorm = 0.4642, lr_0 = 1.0000e-04
Loss = 7.6710e-02, PNorm = 35.5992, GNorm = 1.6090, lr_0 = 1.0000e-04
Validation rmse = 0.139206
Epoch 58
Loss = 7.3199e-02, PNorm = 35.6019, GNorm = 1.9230, lr_0 = 1.0000e-04
Loss = 8.8740e-02, PNorm = 35.6047, GNorm = 0.9932, lr_0 = 1.0000e-04
Validation rmse = 0.138230
Epoch 59
Loss = 8.9895e-02, PNorm = 35.6084, GNorm = 0.5147, lr_0 = 1.0000e-04
Validation rmse = 0.136947
Model 0 best validation rmse = 0.136713 on epoch 21
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.116753
Ensemble test rmse = 0.116753
1-fold cross validation
	Seed 0 ==> test rmse = 0.116753
Overall test rmse = 0.116753 +/- 0.000000
Elapsed time = 0:00:30
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,027 | train size = 816 | val size = 205 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.8985e-01, PNorm = 34.0170, GNorm = 4.2939, lr_0 = 4.0937e-04
Validation rmse = 0.286416
Epoch 1
Loss = 7.3724e-01, PNorm = 34.0523, GNorm = 4.0310, lr_0 = 7.1875e-04
Loss = 6.9252e-01, PNorm = 34.0961, GNorm = 12.7387, lr_0 = 1.0000e-03
Validation rmse = 0.266086
Epoch 2
Loss = 5.6058e-01, PNorm = 34.1579, GNorm = 13.2908, lr_0 = 9.7308e-04
Validation rmse = 0.237655
Epoch 3
Loss = 4.0158e-01, PNorm = 34.2168, GNorm = 1.0050, lr_0 = 9.4688e-04
Loss = 4.5670e-01, PNorm = 34.2754, GNorm = 7.1173, lr_0 = 9.2367e-04
Validation rmse = 0.251881
Epoch 4
Loss = 3.8856e-01, PNorm = 34.3271, GNorm = 4.2152, lr_0 = 9.0103e-04
Loss = 3.7764e-01, PNorm = 34.3747, GNorm = 1.8205, lr_0 = 8.7895e-04
Validation rmse = 0.205973
Epoch 5
Loss = 2.4270e-01, PNorm = 34.4226, GNorm = 3.3506, lr_0 = 8.5529e-04
Validation rmse = 0.196580
Epoch 6
Loss = 2.5464e-01, PNorm = 34.4753, GNorm = 1.5511, lr_0 = 8.3226e-04
Loss = 2.1705e-01, PNorm = 34.5192, GNorm = 2.4591, lr_0 = 8.1186e-04
Validation rmse = 0.189491
Epoch 7
Loss = 2.3035e-01, PNorm = 34.5580, GNorm = 4.5120, lr_0 = 7.9197e-04
Loss = 1.8779e-01, PNorm = 34.6009, GNorm = 3.3196, lr_0 = 7.7256e-04
Loss = 2.2705e-01, PNorm = 34.6059, GNorm = 2.3365, lr_0 = 7.7064e-04
Validation rmse = 0.175847
Epoch 8
Loss = 1.8728e-01, PNorm = 34.6435, GNorm = 3.2017, lr_0 = 7.5176e-04
Validation rmse = 0.162677
Epoch 9
Loss = 2.1196e-01, PNorm = 34.6795, GNorm = 3.2218, lr_0 = 7.3152e-04
Loss = 1.8685e-01, PNorm = 34.7144, GNorm = 2.7028, lr_0 = 7.1359e-04
Validation rmse = 0.161401
Epoch 10
Loss = 1.6866e-01, PNorm = 34.7496, GNorm = 3.9176, lr_0 = 6.9610e-04
Validation rmse = 0.162744
Epoch 11
Loss = 9.5737e-02, PNorm = 34.7807, GNorm = 1.1429, lr_0 = 6.7736e-04
Loss = 1.6190e-01, PNorm = 34.8101, GNorm = 5.0530, lr_0 = 6.6076e-04
Validation rmse = 0.156376
Epoch 12
Loss = 1.2757e-01, PNorm = 34.8364, GNorm = 1.3849, lr_0 = 6.4297e-04
Loss = 1.3966e-01, PNorm = 34.8617, GNorm = 1.6478, lr_0 = 6.2721e-04
Validation rmse = 0.149194
Epoch 13
Loss = 1.3244e-01, PNorm = 34.8832, GNorm = 2.2403, lr_0 = 6.1184e-04
Validation rmse = 0.146005
Epoch 14
Loss = 1.2846e-01, PNorm = 34.9105, GNorm = 1.7734, lr_0 = 5.9537e-04
Loss = 1.2138e-01, PNorm = 34.9322, GNorm = 4.0521, lr_0 = 5.8078e-04
Validation rmse = 0.146665
Epoch 15
Loss = 1.2452e-01, PNorm = 34.9542, GNorm = 1.9497, lr_0 = 5.6514e-04
Loss = 1.4047e-01, PNorm = 34.9763, GNorm = 0.8231, lr_0 = 5.5129e-04
Validation rmse = 0.148903
Epoch 16
Loss = 1.2176e-01, PNorm = 34.9978, GNorm = 0.6622, lr_0 = 5.3778e-04
Validation rmse = 0.162000
Epoch 17
Loss = 1.5029e-01, PNorm = 35.0166, GNorm = 1.9842, lr_0 = 5.2330e-04
Loss = 1.3414e-01, PNorm = 35.0333, GNorm = 4.1336, lr_0 = 5.1047e-04
Validation rmse = 0.160195
Epoch 18
Loss = 1.1750e-01, PNorm = 35.0546, GNorm = 0.8347, lr_0 = 4.9673e-04
Loss = 1.2169e-01, PNorm = 35.0700, GNorm = 4.0452, lr_0 = 4.8456e-04
Validation rmse = 0.144254
Epoch 19
Loss = 1.2497e-01, PNorm = 35.0855, GNorm = 1.2741, lr_0 = 4.7268e-04
Validation rmse = 0.141253
Epoch 20
Loss = 8.7960e-02, PNorm = 35.1030, GNorm = 1.1625, lr_0 = 4.5996e-04
Loss = 1.1718e-01, PNorm = 35.1169, GNorm = 1.6211, lr_0 = 4.4868e-04
Validation rmse = 0.139369
Epoch 21
Loss = 1.2385e-01, PNorm = 35.1318, GNorm = 4.1097, lr_0 = 4.3660e-04
Validation rmse = 0.141632
Epoch 22
Loss = 7.1271e-02, PNorm = 35.1454, GNorm = 1.6095, lr_0 = 4.2590e-04
Loss = 9.5222e-02, PNorm = 35.1579, GNorm = 1.2617, lr_0 = 4.1547e-04
Validation rmse = 0.155640
Epoch 23
Loss = 9.8363e-02, PNorm = 35.1740, GNorm = 0.4352, lr_0 = 4.0428e-04
Loss = 1.1295e-01, PNorm = 35.1851, GNorm = 2.1653, lr_0 = 3.9437e-04
Validation rmse = 0.142487
Epoch 24
Loss = 9.4694e-02, PNorm = 35.1975, GNorm = 1.1328, lr_0 = 3.8375e-04
Validation rmse = 0.138579
Epoch 25
Loss = 1.0367e-01, PNorm = 35.2106, GNorm = 1.2138, lr_0 = 3.7435e-04
Loss = 8.5690e-02, PNorm = 35.2239, GNorm = 0.6523, lr_0 = 3.6517e-04
Validation rmse = 0.141664
Epoch 26
Loss = 7.6536e-02, PNorm = 35.2361, GNorm = 1.1870, lr_0 = 3.5534e-04
Loss = 1.1610e-01, PNorm = 35.2448, GNorm = 1.9844, lr_0 = 3.4663e-04
Loss = 1.2690e-01, PNorm = 35.2459, GNorm = 5.2411, lr_0 = 3.4577e-04
Validation rmse = 0.145229
Epoch 27
Loss = 1.0549e-01, PNorm = 35.2561, GNorm = 2.8608, lr_0 = 3.3730e-04
Validation rmse = 0.137983
Epoch 28
Loss = 7.4110e-02, PNorm = 35.2698, GNorm = 1.8944, lr_0 = 3.2822e-04
Loss = 1.1550e-01, PNorm = 35.2801, GNorm = 0.8154, lr_0 = 3.2018e-04
Validation rmse = 0.149539
Epoch 29
Loss = 9.2580e-02, PNorm = 35.2921, GNorm = 0.9509, lr_0 = 3.1233e-04
Validation rmse = 0.137191
Epoch 30
Loss = 8.1707e-02, PNorm = 35.3020, GNorm = 1.0233, lr_0 = 3.0392e-04
Loss = 9.5524e-02, PNorm = 35.3103, GNorm = 2.6528, lr_0 = 2.9647e-04
Validation rmse = 0.143634
Epoch 31
Loss = 1.0288e-01, PNorm = 35.3206, GNorm = 1.4373, lr_0 = 2.8849e-04
Loss = 8.2509e-02, PNorm = 35.3287, GNorm = 1.0912, lr_0 = 2.8142e-04
Validation rmse = 0.142391
Epoch 32
Loss = 9.4812e-02, PNorm = 35.3374, GNorm = 0.8967, lr_0 = 2.7452e-04
Validation rmse = 0.142543
Epoch 33
Loss = 8.7024e-02, PNorm = 35.3452, GNorm = 2.2940, lr_0 = 2.6713e-04
Loss = 8.7075e-02, PNorm = 35.3542, GNorm = 0.8222, lr_0 = 2.6058e-04
Validation rmse = 0.144886
Epoch 34
Loss = 7.7066e-02, PNorm = 35.3623, GNorm = 1.2505, lr_0 = 2.5357e-04
Loss = 9.2060e-02, PNorm = 35.3711, GNorm = 0.4734, lr_0 = 2.4735e-04
Validation rmse = 0.137617
Epoch 35
Loss = 7.2351e-02, PNorm = 35.3772, GNorm = 0.6310, lr_0 = 2.4129e-04
Validation rmse = 0.147071
Epoch 36
Loss = 7.8471e-02, PNorm = 35.3858, GNorm = 1.1353, lr_0 = 2.3480e-04
Loss = 8.7064e-02, PNorm = 35.3932, GNorm = 0.6468, lr_0 = 2.2904e-04
Validation rmse = 0.140665
Epoch 37
Loss = 8.9238e-02, PNorm = 35.3997, GNorm = 0.9085, lr_0 = 2.2287e-04
Loss = 8.1585e-02, PNorm = 35.4075, GNorm = 2.1288, lr_0 = 2.1741e-04
Validation rmse = 0.139369
Epoch 38
Loss = 8.5530e-02, PNorm = 35.4148, GNorm = 0.6578, lr_0 = 2.1208e-04
Validation rmse = 0.145178
Epoch 39
Loss = 8.2173e-02, PNorm = 35.4219, GNorm = 2.0622, lr_0 = 2.0637e-04
Loss = 8.2088e-02, PNorm = 35.4282, GNorm = 0.9433, lr_0 = 2.0132e-04
Validation rmse = 0.137557
Epoch 40
Loss = 7.3446e-02, PNorm = 35.4347, GNorm = 0.8770, lr_0 = 1.9590e-04
Validation rmse = 0.140830
Epoch 41
Loss = 1.6486e-01, PNorm = 35.4401, GNorm = 0.9803, lr_0 = 1.9110e-04
Loss = 7.5368e-02, PNorm = 35.4468, GNorm = 2.3725, lr_0 = 1.8641e-04
Validation rmse = 0.149861
Epoch 42
Loss = 6.4802e-02, PNorm = 35.4529, GNorm = 0.6894, lr_0 = 1.8139e-04
Loss = 8.1673e-02, PNorm = 35.4586, GNorm = 0.8113, lr_0 = 1.7695e-04
Validation rmse = 0.136905
Epoch 43
Loss = 6.2442e-02, PNorm = 35.4638, GNorm = 0.9664, lr_0 = 1.7218e-04
Validation rmse = 0.139264
Epoch 44
Loss = 6.2876e-02, PNorm = 35.4690, GNorm = 0.8034, lr_0 = 1.6796e-04
Loss = 7.6011e-02, PNorm = 35.4734, GNorm = 0.8071, lr_0 = 1.6385e-04
Validation rmse = 0.142133
Epoch 45
Loss = 8.1724e-02, PNorm = 35.4792, GNorm = 0.5993, lr_0 = 1.5944e-04
Loss = 7.5487e-02, PNorm = 35.4850, GNorm = 1.0051, lr_0 = 1.5553e-04
Loss = 1.8321e-02, PNorm = 35.4857, GNorm = 1.4310, lr_0 = 1.5514e-04
Validation rmse = 0.140455
Epoch 46
Loss = 8.1865e-02, PNorm = 35.4902, GNorm = 1.0736, lr_0 = 1.5134e-04
Validation rmse = 0.141308
Epoch 47
Loss = 6.4077e-02, PNorm = 35.4951, GNorm = 1.2867, lr_0 = 1.4763e-04
Loss = 8.0875e-02, PNorm = 35.4994, GNorm = 0.9321, lr_0 = 1.4401e-04
Validation rmse = 0.140094
Epoch 48
Loss = 6.3761e-02, PNorm = 35.5041, GNorm = 0.9282, lr_0 = 1.4014e-04
Validation rmse = 0.142984
Epoch 49
Loss = 1.1520e-01, PNorm = 35.5091, GNorm = 1.6136, lr_0 = 1.3636e-04
Loss = 6.8021e-02, PNorm = 35.5130, GNorm = 0.8290, lr_0 = 1.3302e-04
Validation rmse = 0.141851
Epoch 50
Loss = 5.8148e-02, PNorm = 35.5165, GNorm = 0.8147, lr_0 = 1.2976e-04
Loss = 8.0897e-02, PNorm = 35.5205, GNorm = 0.5735, lr_0 = 1.2658e-04
Validation rmse = 0.141995
Epoch 51
Loss = 8.6220e-02, PNorm = 35.5242, GNorm = 0.6508, lr_0 = 1.2317e-04
Validation rmse = 0.139485
Epoch 52
Loss = 1.0451e-01, PNorm = 35.5286, GNorm = 2.0530, lr_0 = 1.1986e-04
Loss = 7.8709e-02, PNorm = 35.5328, GNorm = 1.9679, lr_0 = 1.1692e-04
Validation rmse = 0.137330
Epoch 53
Loss = 6.6122e-02, PNorm = 35.5371, GNorm = 1.0470, lr_0 = 1.1377e-04
Loss = 8.3767e-02, PNorm = 35.5403, GNorm = 0.4502, lr_0 = 1.1098e-04
Validation rmse = 0.145709
Epoch 54
Loss = 6.9024e-02, PNorm = 35.5428, GNorm = 2.8937, lr_0 = 1.0826e-04
Validation rmse = 0.143296
Epoch 55
Loss = 6.4763e-02, PNorm = 35.5472, GNorm = 1.0590, lr_0 = 1.0535e-04
Loss = 7.3179e-02, PNorm = 35.5507, GNorm = 1.6432, lr_0 = 1.0277e-04
Validation rmse = 0.138120
Epoch 56
Loss = 6.3705e-02, PNorm = 35.5547, GNorm = 0.4359, lr_0 = 1.0000e-04
Loss = 8.9661e-02, PNorm = 35.5570, GNorm = 1.6299, lr_0 = 1.0000e-04
Validation rmse = 0.139072
Epoch 57
Loss = 7.1981e-02, PNorm = 35.5609, GNorm = 2.8876, lr_0 = 1.0000e-04
Validation rmse = 0.138362
Epoch 58
Loss = 8.6495e-02, PNorm = 35.5632, GNorm = 2.3327, lr_0 = 1.0000e-04
Loss = 7.3196e-02, PNorm = 35.5661, GNorm = 2.0998, lr_0 = 1.0000e-04
Validation rmse = 0.145161
Epoch 59
Loss = 7.2702e-02, PNorm = 35.5696, GNorm = 1.1657, lr_0 = 1.0000e-04
Validation rmse = 0.142722
Model 0 best validation rmse = 0.136905 on epoch 42
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.140289
Ensemble test rmse = 0.140289
1-fold cross validation
	Seed 0 ==> test rmse = 0.140289
Overall test rmse = 0.140289 +/- 0.000000
Elapsed time = 0:00:31
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,017 | train size = 808 | val size = 203 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1156e-01, PNorm = 34.0166, GNorm = 1.5031, lr_0 = 4.0937e-04
Validation rmse = 0.300363
Epoch 1
Loss = 6.8667e-01, PNorm = 34.0498, GNorm = 11.6667, lr_0 = 7.1875e-04
Loss = 7.1924e-01, PNorm = 34.0912, GNorm = 4.9472, lr_0 = 1.0000e-03
Validation rmse = 0.316638
Epoch 2
Loss = 5.5368e-01, PNorm = 34.1594, GNorm = 3.5786, lr_0 = 9.7308e-04
Validation rmse = 0.247191
Epoch 3
Loss = 4.1679e-01, PNorm = 34.2313, GNorm = 3.2119, lr_0 = 9.4688e-04
Loss = 3.9426e-01, PNorm = 34.2904, GNorm = 1.1701, lr_0 = 9.2367e-04
Validation rmse = 0.213228
Epoch 4
Loss = 3.4933e-01, PNorm = 34.3587, GNorm = 3.6590, lr_0 = 8.9880e-04
Loss = 2.4858e-01, PNorm = 34.4064, GNorm = 1.6451, lr_0 = 8.7677e-04
Loss = 2.7141e-01, PNorm = 34.4112, GNorm = 9.9032, lr_0 = 8.7460e-04
Validation rmse = 0.257162
Epoch 5
Loss = 3.1118e-01, PNorm = 34.4489, GNorm = 2.1397, lr_0 = 8.5317e-04
Validation rmse = 0.185174
Epoch 6
Loss = 2.7640e-01, PNorm = 34.4884, GNorm = 1.2133, lr_0 = 8.3020e-04
Loss = 2.3922e-01, PNorm = 34.5355, GNorm = 2.6765, lr_0 = 8.0985e-04
Validation rmse = 0.168113
Epoch 7
Loss = 2.3733e-01, PNorm = 34.5724, GNorm = 6.3088, lr_0 = 7.9000e-04
Validation rmse = 0.170177
Epoch 8
Loss = 2.4614e-01, PNorm = 34.6098, GNorm = 3.7996, lr_0 = 7.6873e-04
Loss = 2.2984e-01, PNorm = 34.6400, GNorm = 5.0120, lr_0 = 7.4989e-04
Validation rmse = 0.159082
Epoch 9
Loss = 2.0337e-01, PNorm = 34.6700, GNorm = 1.0318, lr_0 = 7.2970e-04
Loss = 2.3471e-01, PNorm = 34.6992, GNorm = 6.3523, lr_0 = 7.1182e-04
Validation rmse = 0.164846
Epoch 10
Loss = 1.6480e-01, PNorm = 34.7304, GNorm = 3.3070, lr_0 = 6.9266e-04
Validation rmse = 0.162192
Epoch 11
Loss = 1.6260e-01, PNorm = 34.7570, GNorm = 1.8848, lr_0 = 6.7401e-04
Loss = 1.6045e-01, PNorm = 34.7850, GNorm = 0.9043, lr_0 = 6.5749e-04
Validation rmse = 0.150892
Epoch 12
Loss = 1.6201e-01, PNorm = 34.8181, GNorm = 0.9177, lr_0 = 6.3979e-04
Loss = 1.7388e-01, PNorm = 34.8369, GNorm = 6.7835, lr_0 = 6.2411e-04
Validation rmse = 0.153117
Epoch 13
Loss = 1.6598e-01, PNorm = 34.8615, GNorm = 1.0995, lr_0 = 6.0881e-04
Validation rmse = 0.139044
Epoch 14
Loss = 1.3737e-01, PNorm = 34.8808, GNorm = 1.8857, lr_0 = 5.9242e-04
Loss = 1.3873e-01, PNorm = 34.8973, GNorm = 1.6091, lr_0 = 5.7790e-04
Validation rmse = 0.139197
Epoch 15
Loss = 1.1882e-01, PNorm = 34.9162, GNorm = 1.8111, lr_0 = 5.6234e-04
Validation rmse = 0.135288
Epoch 16
Loss = 1.1079e-01, PNorm = 34.9384, GNorm = 1.6243, lr_0 = 5.4720e-04
Loss = 1.2810e-01, PNorm = 34.9594, GNorm = 4.4366, lr_0 = 5.3379e-04
Validation rmse = 0.142013
Epoch 17
Loss = 1.1852e-01, PNorm = 34.9753, GNorm = 2.2318, lr_0 = 5.1942e-04
Loss = 1.3866e-01, PNorm = 34.9908, GNorm = 1.9552, lr_0 = 5.0669e-04
Loss = 6.5677e-02, PNorm = 34.9919, GNorm = 4.3073, lr_0 = 5.0543e-04
Validation rmse = 0.158715
Epoch 18
Loss = 1.3658e-01, PNorm = 35.0023, GNorm = 1.3670, lr_0 = 4.9305e-04
Validation rmse = 0.148508
Epoch 19
Loss = 1.1330e-01, PNorm = 35.0181, GNorm = 1.1892, lr_0 = 4.8096e-04
Loss = 1.2548e-01, PNorm = 35.0320, GNorm = 0.9017, lr_0 = 4.6918e-04
Validation rmse = 0.134381
Epoch 20
Loss = 9.5514e-02, PNorm = 35.0495, GNorm = 2.1565, lr_0 = 4.5654e-04
Validation rmse = 0.135826
Epoch 21
Loss = 6.4846e-02, PNorm = 35.0657, GNorm = 2.9267, lr_0 = 4.4425e-04
Loss = 1.3073e-01, PNorm = 35.0796, GNorm = 1.7465, lr_0 = 4.3336e-04
Validation rmse = 0.144066
Epoch 22
Loss = 1.4527e-01, PNorm = 35.0981, GNorm = 4.1722, lr_0 = 4.2170e-04
Loss = 1.2315e-01, PNorm = 35.1111, GNorm = 1.8463, lr_0 = 4.1136e-04
Validation rmse = 0.142431
Epoch 23
Loss = 1.6432e-01, PNorm = 35.1286, GNorm = 1.4725, lr_0 = 4.0029e-04
Validation rmse = 0.142381
Epoch 24
Loss = 1.0937e-01, PNorm = 35.1432, GNorm = 3.0889, lr_0 = 3.8951e-04
Loss = 1.3293e-01, PNorm = 35.1548, GNorm = 1.2401, lr_0 = 3.7996e-04
Validation rmse = 0.138184
Epoch 25
Loss = 1.1006e-01, PNorm = 35.1688, GNorm = 2.6160, lr_0 = 3.7065e-04
Loss = 1.1765e-01, PNorm = 35.1807, GNorm = 0.8022, lr_0 = 3.6157e-04
Loss = 1.1033e-01, PNorm = 35.1815, GNorm = 2.1569, lr_0 = 3.6067e-04
Validation rmse = 0.139102
Epoch 26
Loss = 1.0406e-01, PNorm = 35.1917, GNorm = 1.5757, lr_0 = 3.5183e-04
Validation rmse = 0.139567
Epoch 27
Loss = 1.2406e-01, PNorm = 35.2042, GNorm = 1.3402, lr_0 = 3.4236e-04
Loss = 1.1059e-01, PNorm = 35.2183, GNorm = 0.9081, lr_0 = 3.3397e-04
Validation rmse = 0.147612
Epoch 28
Loss = 1.2069e-01, PNorm = 35.2279, GNorm = 0.8761, lr_0 = 3.2498e-04
Validation rmse = 0.132204
Epoch 29
Loss = 9.4401e-02, PNorm = 35.2366, GNorm = 0.7946, lr_0 = 3.1623e-04
Loss = 8.3496e-02, PNorm = 35.2434, GNorm = 0.6023, lr_0 = 3.0848e-04
Validation rmse = 0.132258
Epoch 30
Loss = 7.3229e-02, PNorm = 35.2535, GNorm = 1.3716, lr_0 = 3.0017e-04
Loss = 1.1026e-01, PNorm = 35.2635, GNorm = 1.9081, lr_0 = 2.9282e-04
Loss = 1.5076e-01, PNorm = 35.2640, GNorm = 2.8180, lr_0 = 2.9209e-04
Validation rmse = 0.127915
Epoch 31
Loss = 9.1674e-02, PNorm = 35.2715, GNorm = 1.4600, lr_0 = 2.8493e-04
Validation rmse = 0.134351
Epoch 32
Loss = 7.3340e-02, PNorm = 35.2792, GNorm = 1.1759, lr_0 = 2.7795e-04
Loss = 9.7059e-02, PNorm = 35.2864, GNorm = 0.7321, lr_0 = 2.7114e-04
Validation rmse = 0.129522
Epoch 33
Loss = 8.4174e-02, PNorm = 35.2932, GNorm = 1.9392, lr_0 = 2.6384e-04
Validation rmse = 0.135921
Epoch 34
Loss = 1.1294e-01, PNorm = 35.3015, GNorm = 2.0955, lr_0 = 2.5673e-04
Loss = 1.0543e-01, PNorm = 35.3098, GNorm = 1.9297, lr_0 = 2.5044e-04
Validation rmse = 0.131938
Epoch 35
Loss = 1.0873e-01, PNorm = 35.3172, GNorm = 1.2354, lr_0 = 2.4370e-04
Loss = 9.1570e-02, PNorm = 35.3241, GNorm = 0.5312, lr_0 = 2.3773e-04
Validation rmse = 0.130548
Epoch 36
Loss = 8.1999e-02, PNorm = 35.3289, GNorm = 1.5356, lr_0 = 2.3133e-04
Validation rmse = 0.128026
Epoch 37
Loss = 1.0036e-01, PNorm = 35.3371, GNorm = 1.5651, lr_0 = 2.2510e-04
Loss = 1.0229e-01, PNorm = 35.3446, GNorm = 2.3521, lr_0 = 2.1958e-04
Validation rmse = 0.134918
Epoch 38
Loss = 8.4175e-02, PNorm = 35.3500, GNorm = 2.0435, lr_0 = 2.1420e-04
Loss = 9.9666e-02, PNorm = 35.3548, GNorm = 2.6115, lr_0 = 2.0895e-04
Loss = 6.5237e-02, PNorm = 35.3553, GNorm = 2.6499, lr_0 = 2.0843e-04
Validation rmse = 0.137836
Epoch 39
Loss = 1.1049e-01, PNorm = 35.3622, GNorm = 2.3342, lr_0 = 2.0332e-04
Validation rmse = 0.143318
Epoch 40
Loss = 1.3429e-01, PNorm = 35.3696, GNorm = 0.6342, lr_0 = 1.9785e-04
Loss = 8.5989e-02, PNorm = 35.3757, GNorm = 3.6335, lr_0 = 1.9300e-04
Validation rmse = 0.126904
Epoch 41
Loss = 1.0075e-01, PNorm = 35.3836, GNorm = 2.2728, lr_0 = 1.8780e-04
Validation rmse = 0.128254
Epoch 42
Loss = 6.8815e-02, PNorm = 35.3903, GNorm = 0.4288, lr_0 = 1.8275e-04
Loss = 1.0020e-01, PNorm = 35.3937, GNorm = 2.5327, lr_0 = 1.7827e-04
Validation rmse = 0.134987
Epoch 43
Loss = 9.8096e-02, PNorm = 35.3988, GNorm = 2.6723, lr_0 = 1.7347e-04
Loss = 8.6019e-02, PNorm = 35.4038, GNorm = 1.5568, lr_0 = 1.6922e-04
Validation rmse = 0.131851
Epoch 44
Loss = 8.9062e-02, PNorm = 35.4090, GNorm = 0.5254, lr_0 = 1.6507e-04
Validation rmse = 0.136251
Epoch 45
Loss = 6.3720e-02, PNorm = 35.4142, GNorm = 2.4905, lr_0 = 1.6063e-04
Loss = 1.0166e-01, PNorm = 35.4185, GNorm = 0.8329, lr_0 = 1.5669e-04
Validation rmse = 0.132584
Epoch 46
Loss = 9.8506e-02, PNorm = 35.4239, GNorm = 0.6725, lr_0 = 1.5247e-04
Validation rmse = 0.126914
Epoch 47
Loss = 8.6115e-02, PNorm = 35.4281, GNorm = 0.9852, lr_0 = 1.4837e-04
Loss = 8.5002e-02, PNorm = 35.4310, GNorm = 0.4131, lr_0 = 1.4473e-04
Validation rmse = 0.127719
Epoch 48
Loss = 6.1370e-02, PNorm = 35.4359, GNorm = 0.6391, lr_0 = 1.4083e-04
Loss = 1.0273e-01, PNorm = 35.4412, GNorm = 2.2802, lr_0 = 1.3738e-04
Validation rmse = 0.131973
Epoch 49
Loss = 1.0176e-01, PNorm = 35.4456, GNorm = 1.1555, lr_0 = 1.3368e-04
Validation rmse = 0.137733
Epoch 50
Loss = 8.5289e-02, PNorm = 35.4505, GNorm = 2.4673, lr_0 = 1.3041e-04
Loss = 9.2152e-02, PNorm = 35.4542, GNorm = 0.8308, lr_0 = 1.2721e-04
Validation rmse = 0.128960
Epoch 51
Loss = 8.8302e-02, PNorm = 35.4579, GNorm = 1.2938, lr_0 = 1.2379e-04
Loss = 8.5517e-02, PNorm = 35.4617, GNorm = 1.0386, lr_0 = 1.2075e-04
Loss = 4.3418e-02, PNorm = 35.4619, GNorm = 2.1897, lr_0 = 1.2045e-04
Validation rmse = 0.126615
Epoch 52
Loss = 7.0013e-02, PNorm = 35.4649, GNorm = 0.7711, lr_0 = 1.1750e-04
Validation rmse = 0.127431
Epoch 53
Loss = 7.8659e-02, PNorm = 35.4690, GNorm = 0.6415, lr_0 = 1.1434e-04
Loss = 8.9435e-02, PNorm = 35.4728, GNorm = 1.2706, lr_0 = 1.1154e-04
Validation rmse = 0.126976
Epoch 54
Loss = 8.7530e-02, PNorm = 35.4761, GNorm = 0.8871, lr_0 = 1.0853e-04
Validation rmse = 0.131743
Epoch 55
Loss = 4.9931e-02, PNorm = 35.4792, GNorm = 0.7675, lr_0 = 1.0561e-04
Loss = 8.1219e-02, PNorm = 35.4822, GNorm = 1.8047, lr_0 = 1.0302e-04
Validation rmse = 0.127272
Epoch 56
Loss = 5.7299e-02, PNorm = 35.4860, GNorm = 0.4956, lr_0 = 1.0025e-04
Loss = 9.7606e-02, PNorm = 35.4890, GNorm = 1.8157, lr_0 = 1.0000e-04
Validation rmse = 0.130519
Epoch 57
Loss = 6.7667e-02, PNorm = 35.4922, GNorm = 0.9247, lr_0 = 1.0000e-04
Validation rmse = 0.127118
Epoch 58
Loss = 8.2088e-02, PNorm = 35.4950, GNorm = 0.7177, lr_0 = 1.0000e-04
Loss = 8.0639e-02, PNorm = 35.4981, GNorm = 1.0786, lr_0 = 1.0000e-04
Validation rmse = 0.128974
Epoch 59
Loss = 9.1814e-02, PNorm = 35.5010, GNorm = 1.0447, lr_0 = 1.0000e-04
Validation rmse = 0.128354
Model 0 best validation rmse = 0.126615 on epoch 51
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.118841
Ensemble test rmse = 0.118841
1-fold cross validation
	Seed 0 ==> test rmse = 0.118841
Overall test rmse = 0.118841 +/- 0.000000
Elapsed time = 0:00:30
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,007 | train size = 800 | val size = 201 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.9692e-01, PNorm = 34.0156, GNorm = 4.6190, lr_0 = 4.0937e-04
Validation rmse = 0.298614
Epoch 1
Loss = 6.6795e-01, PNorm = 34.0408, GNorm = 6.5556, lr_0 = 6.9063e-04
Loss = 7.1985e-01, PNorm = 34.0790, GNorm = 0.9906, lr_0 = 9.7187e-04
Validation rmse = 0.265619
Epoch 2
Loss = 5.5833e-01, PNorm = 34.1364, GNorm = 3.0162, lr_0 = 9.7792e-04
Validation rmse = 0.275140
Epoch 3
Loss = 5.8019e-01, PNorm = 34.2012, GNorm = 7.9108, lr_0 = 9.5395e-04
Loss = 4.4208e-01, PNorm = 34.2574, GNorm = 4.7305, lr_0 = 9.3057e-04
Validation rmse = 0.240861
Epoch 4
Loss = 4.4851e-01, PNorm = 34.3218, GNorm = 5.1199, lr_0 = 9.0777e-04
Loss = 3.1838e-01, PNorm = 34.3784, GNorm = 1.5371, lr_0 = 8.8552e-04
Validation rmse = 0.195367
Epoch 5
Loss = 2.7492e-01, PNorm = 34.4366, GNorm = 2.5892, lr_0 = 8.6382e-04
Validation rmse = 0.182169
Epoch 6
Loss = 2.3487e-01, PNorm = 34.4855, GNorm = 1.0966, lr_0 = 8.4265e-04
Loss = 2.2256e-01, PNorm = 34.5324, GNorm = 3.3849, lr_0 = 8.2200e-04
Validation rmse = 0.195832
Epoch 7
Loss = 2.1867e-01, PNorm = 34.5743, GNorm = 4.0760, lr_0 = 8.0185e-04
Validation rmse = 0.192301
Epoch 8
Loss = 1.6371e-01, PNorm = 34.6111, GNorm = 0.6612, lr_0 = 7.8220e-04
Loss = 1.9551e-01, PNorm = 34.6489, GNorm = 2.6572, lr_0 = 7.6303e-04
Validation rmse = 0.153769
Epoch 9
Loss = 1.4178e-01, PNorm = 34.6911, GNorm = 1.2167, lr_0 = 7.4433e-04
Loss = 1.9205e-01, PNorm = 34.7237, GNorm = 2.8239, lr_0 = 7.2609e-04
Validation rmse = 0.177191
Epoch 10
Loss = 2.0724e-01, PNorm = 34.7606, GNorm = 2.2750, lr_0 = 7.0830e-04
Validation rmse = 0.162399
Epoch 11
Loss = 2.0835e-01, PNorm = 34.7935, GNorm = 3.8241, lr_0 = 6.9094e-04
Loss = 1.5930e-01, PNorm = 34.8225, GNorm = 0.9724, lr_0 = 6.7401e-04
Validation rmse = 0.146356
Epoch 12
Loss = 1.2142e-01, PNorm = 34.8455, GNorm = 2.1219, lr_0 = 6.5749e-04
Validation rmse = 0.145742
Epoch 13
Loss = 9.7485e-02, PNorm = 34.8701, GNorm = 2.3336, lr_0 = 6.4138e-04
Loss = 1.2473e-01, PNorm = 34.8947, GNorm = 3.7158, lr_0 = 6.2566e-04
Validation rmse = 0.152384
Epoch 14
Loss = 1.2035e-01, PNorm = 34.9171, GNorm = 4.1110, lr_0 = 6.1032e-04
Loss = 1.4229e-01, PNorm = 34.9377, GNorm = 5.8547, lr_0 = 5.9537e-04
Validation rmse = 0.150089
Epoch 15
Loss = 1.2992e-01, PNorm = 34.9573, GNorm = 1.2579, lr_0 = 5.8078e-04
Validation rmse = 0.142305
Epoch 16
Loss = 1.1812e-01, PNorm = 34.9755, GNorm = 0.6613, lr_0 = 5.6654e-04
Loss = 1.2433e-01, PNorm = 34.9938, GNorm = 1.0808, lr_0 = 5.5266e-04
Validation rmse = 0.159845
Epoch 17
Loss = 9.3002e-02, PNorm = 35.0137, GNorm = 1.6097, lr_0 = 5.3911e-04
Validation rmse = 0.141458
Epoch 18
Loss = 8.8257e-02, PNorm = 35.0327, GNorm = 1.7312, lr_0 = 5.2590e-04
Loss = 1.1403e-01, PNorm = 35.0477, GNorm = 0.6863, lr_0 = 5.1301e-04
Validation rmse = 0.150053
Epoch 19
Loss = 1.1299e-01, PNorm = 35.0664, GNorm = 1.7127, lr_0 = 5.0044e-04
Loss = 1.0581e-01, PNorm = 35.0828, GNorm = 2.7528, lr_0 = 4.8818e-04
Validation rmse = 0.140649
Epoch 20
Loss = 1.0062e-01, PNorm = 35.1001, GNorm = 0.9501, lr_0 = 4.7621e-04
Validation rmse = 0.136511
Epoch 21
Loss = 1.2153e-01, PNorm = 35.1134, GNorm = 0.7585, lr_0 = 4.6454e-04
Loss = 1.0024e-01, PNorm = 35.1277, GNorm = 2.4387, lr_0 = 4.5316e-04
Validation rmse = 0.144515
Epoch 22
Loss = 9.4100e-02, PNorm = 35.1449, GNorm = 1.0178, lr_0 = 4.4205e-04
Validation rmse = 0.143250
Epoch 23
Loss = 1.3179e-01, PNorm = 35.1613, GNorm = 1.6726, lr_0 = 4.3122e-04
Loss = 9.4908e-02, PNorm = 35.1737, GNorm = 1.4797, lr_0 = 4.2065e-04
Validation rmse = 0.143488
Epoch 24
Loss = 7.9089e-02, PNorm = 35.1853, GNorm = 1.0761, lr_0 = 4.1034e-04
Loss = 1.1469e-01, PNorm = 35.1981, GNorm = 2.6369, lr_0 = 4.0029e-04
Validation rmse = 0.143867
Epoch 25
Loss = 9.3629e-02, PNorm = 35.2142, GNorm = 1.2609, lr_0 = 3.9048e-04
Validation rmse = 0.134663
Epoch 26
Loss = 8.6285e-02, PNorm = 35.2270, GNorm = 0.7024, lr_0 = 3.8091e-04
Loss = 9.2185e-02, PNorm = 35.2381, GNorm = 0.5949, lr_0 = 3.7157e-04
Validation rmse = 0.135492
Epoch 27
Loss = 1.0838e-01, PNorm = 35.2507, GNorm = 1.7893, lr_0 = 3.6247e-04
Validation rmse = 0.138221
Epoch 28
Loss = 8.0851e-02, PNorm = 35.2610, GNorm = 1.1979, lr_0 = 3.5358e-04
Loss = 9.2505e-02, PNorm = 35.2710, GNorm = 1.4816, lr_0 = 3.4492e-04
Validation rmse = 0.138810
Epoch 29
Loss = 7.8500e-02, PNorm = 35.2822, GNorm = 0.9842, lr_0 = 3.3646e-04
Loss = 9.1110e-02, PNorm = 35.2931, GNorm = 0.6347, lr_0 = 3.2822e-04
Validation rmse = 0.134315
Epoch 30
Loss = 8.9598e-02, PNorm = 35.3032, GNorm = 1.0216, lr_0 = 3.2018e-04
Validation rmse = 0.133422
Epoch 31
Loss = 7.6050e-02, PNorm = 35.3143, GNorm = 1.7921, lr_0 = 3.1233e-04
Loss = 9.4893e-02, PNorm = 35.3246, GNorm = 1.6283, lr_0 = 3.0467e-04
Validation rmse = 0.132746
Epoch 32
Loss = 9.3655e-02, PNorm = 35.3350, GNorm = 1.1627, lr_0 = 2.9721e-04
Validation rmse = 0.139573
Epoch 33
Loss = 7.0554e-02, PNorm = 35.3434, GNorm = 0.6900, lr_0 = 2.8992e-04
Loss = 1.0421e-01, PNorm = 35.3541, GNorm = 1.7090, lr_0 = 2.8282e-04
Validation rmse = 0.140993
Epoch 34
Loss = 8.5992e-02, PNorm = 35.3639, GNorm = 1.4279, lr_0 = 2.7589e-04
Loss = 8.2343e-02, PNorm = 35.3717, GNorm = 0.7772, lr_0 = 2.6913e-04
Validation rmse = 0.135665
Epoch 35
Loss = 8.1813e-02, PNorm = 35.3788, GNorm = 0.9843, lr_0 = 2.6253e-04
Validation rmse = 0.135021
Epoch 36
Loss = 5.5920e-02, PNorm = 35.3868, GNorm = 0.4311, lr_0 = 2.5610e-04
Loss = 9.3530e-02, PNorm = 35.3953, GNorm = 0.9553, lr_0 = 2.4982e-04
Validation rmse = 0.134207
Epoch 37
Loss = 7.1250e-02, PNorm = 35.4035, GNorm = 1.2283, lr_0 = 2.4370e-04
Validation rmse = 0.137278
Epoch 38
Loss = 1.2747e-01, PNorm = 35.4113, GNorm = 2.6509, lr_0 = 2.3773e-04
Loss = 7.5709e-02, PNorm = 35.4200, GNorm = 0.8489, lr_0 = 2.3190e-04
Validation rmse = 0.133896
Epoch 39
Loss = 8.4294e-02, PNorm = 35.4277, GNorm = 0.6974, lr_0 = 2.2622e-04
Loss = 7.3511e-02, PNorm = 35.4352, GNorm = 0.5952, lr_0 = 2.2067e-04
Validation rmse = 0.132952
Epoch 40
Loss = 7.5145e-02, PNorm = 35.4424, GNorm = 1.2581, lr_0 = 2.1527e-04
Validation rmse = 0.135076
Epoch 41
Loss = 1.3105e-01, PNorm = 35.4491, GNorm = 0.6085, lr_0 = 2.0999e-04
Loss = 6.9454e-02, PNorm = 35.4560, GNorm = 0.4090, lr_0 = 2.0484e-04
Validation rmse = 0.146175
Epoch 42
Loss = 7.5534e-02, PNorm = 35.4615, GNorm = 0.7742, lr_0 = 1.9982e-04
Validation rmse = 0.132625
Epoch 43
Loss = 8.4683e-02, PNorm = 35.4683, GNorm = 1.4372, lr_0 = 1.9493e-04
Loss = 7.3258e-02, PNorm = 35.4746, GNorm = 0.9218, lr_0 = 1.9015e-04
Validation rmse = 0.132485
Epoch 44
Loss = 7.5833e-02, PNorm = 35.4808, GNorm = 0.6500, lr_0 = 1.8549e-04
Loss = 7.5490e-02, PNorm = 35.4859, GNorm = 1.8275, lr_0 = 1.8094e-04
Validation rmse = 0.132688
Epoch 45
Loss = 6.8492e-02, PNorm = 35.4916, GNorm = 1.3600, lr_0 = 1.7651e-04
Validation rmse = 0.138568
Epoch 46
Loss = 9.6179e-02, PNorm = 35.4967, GNorm = 1.0254, lr_0 = 1.7218e-04
Loss = 7.3289e-02, PNorm = 35.5016, GNorm = 0.8921, lr_0 = 1.6796e-04
Validation rmse = 0.133173
Epoch 47
Loss = 6.1264e-02, PNorm = 35.5072, GNorm = 0.4808, lr_0 = 1.6385e-04
Validation rmse = 0.134781
Epoch 48
Loss = 7.1047e-02, PNorm = 35.5125, GNorm = 1.0006, lr_0 = 1.5983e-04
Loss = 7.6415e-02, PNorm = 35.5178, GNorm = 0.9774, lr_0 = 1.5592e-04
Validation rmse = 0.133436
Epoch 49
Loss = 7.5218e-02, PNorm = 35.5216, GNorm = 1.0940, lr_0 = 1.5209e-04
Loss = 6.9749e-02, PNorm = 35.5271, GNorm = 0.5597, lr_0 = 1.4837e-04
Validation rmse = 0.134734
Epoch 50
Loss = 5.9897e-02, PNorm = 35.5307, GNorm = 1.4535, lr_0 = 1.4473e-04
Validation rmse = 0.137904
Epoch 51
Loss = 6.7272e-02, PNorm = 35.5358, GNorm = 1.7309, lr_0 = 1.4118e-04
Loss = 6.7995e-02, PNorm = 35.5400, GNorm = 0.5146, lr_0 = 1.3772e-04
Validation rmse = 0.131835
Epoch 52
Loss = 6.9896e-02, PNorm = 35.5440, GNorm = 1.2966, lr_0 = 1.3435e-04
Validation rmse = 0.133542
Epoch 53
Loss = 7.6815e-02, PNorm = 35.5480, GNorm = 0.5359, lr_0 = 1.3106e-04
Loss = 7.1133e-02, PNorm = 35.5515, GNorm = 1.3524, lr_0 = 1.2784e-04
Validation rmse = 0.132071
Epoch 54
Loss = 8.6335e-02, PNorm = 35.5554, GNorm = 1.5076, lr_0 = 1.2471e-04
Loss = 6.1692e-02, PNorm = 35.5597, GNorm = 0.9982, lr_0 = 1.2165e-04
Validation rmse = 0.137814
Epoch 55
Loss = 7.8414e-02, PNorm = 35.5633, GNorm = 2.2341, lr_0 = 1.1867e-04
Validation rmse = 0.135557
Epoch 56
Loss = 5.0418e-02, PNorm = 35.5668, GNorm = 1.6279, lr_0 = 1.1577e-04
Loss = 7.5638e-02, PNorm = 35.5698, GNorm = 1.0416, lr_0 = 1.1293e-04
Validation rmse = 0.138939
Epoch 57
Loss = 7.3301e-02, PNorm = 35.5733, GNorm = 0.4614, lr_0 = 1.1016e-04
Validation rmse = 0.131722
Epoch 58
Loss = 6.5121e-02, PNorm = 35.5761, GNorm = 1.3496, lr_0 = 1.0746e-04
Loss = 8.1463e-02, PNorm = 35.5804, GNorm = 0.5884, lr_0 = 1.0483e-04
Validation rmse = 0.132849
Epoch 59
Loss = 6.3790e-02, PNorm = 35.5842, GNorm = 0.8284, lr_0 = 1.0226e-04
Loss = 7.0743e-02, PNorm = 35.5865, GNorm = 0.7718, lr_0 = 1.0000e-04
Validation rmse = 0.132434
Model 0 best validation rmse = 0.131722 on epoch 57
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.113821
Ensemble test rmse = 0.113821
1-fold cross validation
	Seed 0 ==> test rmse = 0.113821
Overall test rmse = 0.113821 +/- 0.000000
Elapsed time = 0:00:30
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 997 | train size = 792 | val size = 200 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.0976e-01, PNorm = 34.0167, GNorm = 2.1471, lr_0 = 4.3000e-04
Validation rmse = 0.294729
Epoch 1
Loss = 6.7935e-01, PNorm = 34.0464, GNorm = 9.6257, lr_0 = 7.6000e-04
Loss = 7.4934e-01, PNorm = 34.0909, GNorm = 7.7386, lr_0 = 9.9472e-04
Validation rmse = 0.262052
Epoch 2
Loss = 5.2869e-01, PNorm = 34.1588, GNorm = 3.1969, lr_0 = 9.6874e-04
Validation rmse = 0.220439
Epoch 3
Loss = 3.7022e-01, PNorm = 34.2349, GNorm = 2.5743, lr_0 = 9.4344e-04
Loss = 3.6233e-01, PNorm = 34.3054, GNorm = 1.3786, lr_0 = 9.1879e-04
Validation rmse = 0.194527
Epoch 4
Loss = 2.7885e-01, PNorm = 34.3704, GNorm = 3.3538, lr_0 = 8.9480e-04
Validation rmse = 0.177180
Epoch 5
Loss = 2.6418e-01, PNorm = 34.4238, GNorm = 1.1180, lr_0 = 8.7142e-04
Loss = 3.5158e-01, PNorm = 34.4768, GNorm = 4.6677, lr_0 = 8.4866e-04
Validation rmse = 0.172238
Epoch 6
Loss = 2.1451e-01, PNorm = 34.5209, GNorm = 1.3860, lr_0 = 8.2650e-04
Loss = 2.0538e-01, PNorm = 34.5651, GNorm = 1.0407, lr_0 = 8.0491e-04
Loss = 1.0494e-01, PNorm = 34.5697, GNorm = 0.7492, lr_0 = 8.0278e-04
Validation rmse = 0.171159
Epoch 7
Loss = 1.9617e-01, PNorm = 34.6092, GNorm = 2.2305, lr_0 = 7.8181e-04
Validation rmse = 0.156776
Epoch 8
Loss = 1.6784e-01, PNorm = 34.6479, GNorm = 2.9207, lr_0 = 7.6139e-04
Loss = 1.7622e-01, PNorm = 34.6833, GNorm = 5.1685, lr_0 = 7.4151e-04
Validation rmse = 0.171635
Epoch 9
Loss = 1.7776e-01, PNorm = 34.7137, GNorm = 0.8734, lr_0 = 7.2214e-04
Validation rmse = 0.155935
Epoch 10
Loss = 9.6449e-02, PNorm = 34.7459, GNorm = 1.5715, lr_0 = 7.0328e-04
Loss = 1.4446e-01, PNorm = 34.7726, GNorm = 0.8890, lr_0 = 6.8491e-04
Validation rmse = 0.148512
Epoch 11
Loss = 1.3215e-01, PNorm = 34.7945, GNorm = 3.1411, lr_0 = 6.6702e-04
Loss = 1.6375e-01, PNorm = 34.8228, GNorm = 2.5770, lr_0 = 6.4960e-04
Validation rmse = 0.153234
Epoch 12
Loss = 1.4814e-01, PNorm = 34.8495, GNorm = 3.6183, lr_0 = 6.3263e-04
Validation rmse = 0.150789
Epoch 13
Loss = 1.2643e-01, PNorm = 34.8731, GNorm = 2.6154, lr_0 = 6.1448e-04
Loss = 1.2937e-01, PNorm = 34.8964, GNorm = 2.5612, lr_0 = 5.9843e-04
Validation rmse = 0.137847
Epoch 14
Loss = 1.0891e-01, PNorm = 34.9148, GNorm = 0.8989, lr_0 = 5.8280e-04
Validation rmse = 0.134308
Epoch 15
Loss = 1.1532e-01, PNorm = 34.9373, GNorm = 0.3640, lr_0 = 5.6757e-04
Loss = 1.2913e-01, PNorm = 34.9553, GNorm = 0.9276, lr_0 = 5.5275e-04
Validation rmse = 0.154451
Epoch 16
Loss = 1.5343e-01, PNorm = 34.9774, GNorm = 2.9182, lr_0 = 5.3831e-04
Validation rmse = 0.155274
Epoch 17
Loss = 1.2848e-01, PNorm = 34.9994, GNorm = 2.6344, lr_0 = 5.2425e-04
Loss = 1.1539e-01, PNorm = 35.0176, GNorm = 1.4229, lr_0 = 5.1056e-04
Validation rmse = 0.135985
Epoch 18
Loss = 8.8191e-02, PNorm = 35.0348, GNorm = 0.4378, lr_0 = 4.9722e-04
Loss = 1.1838e-01, PNorm = 35.0496, GNorm = 2.1002, lr_0 = 4.8424e-04
Loss = 1.0099e-01, PNorm = 35.0509, GNorm = 2.8292, lr_0 = 4.8296e-04
Validation rmse = 0.142534
Epoch 19
Loss = 9.9088e-02, PNorm = 35.0675, GNorm = 1.3249, lr_0 = 4.7034e-04
Validation rmse = 0.142318
Epoch 20
Loss = 1.4077e-01, PNorm = 35.0821, GNorm = 2.2277, lr_0 = 4.5806e-04
Loss = 1.0493e-01, PNorm = 35.0972, GNorm = 2.0866, lr_0 = 4.4609e-04
Validation rmse = 0.133952
Epoch 21
Loss = 9.8888e-02, PNorm = 35.1127, GNorm = 4.1970, lr_0 = 4.3444e-04
Validation rmse = 0.132935
Epoch 22
Loss = 5.9259e-02, PNorm = 35.1271, GNorm = 0.6898, lr_0 = 4.2309e-04
Loss = 1.0558e-01, PNorm = 35.1420, GNorm = 0.8051, lr_0 = 4.1204e-04
Validation rmse = 0.130883
Epoch 23
Loss = 8.5169e-02, PNorm = 35.1533, GNorm = 0.6307, lr_0 = 4.0128e-04
Loss = 9.2516e-02, PNorm = 35.1660, GNorm = 1.3865, lr_0 = 3.9080e-04
Validation rmse = 0.136538
Epoch 24
Loss = 9.0139e-02, PNorm = 35.1786, GNorm = 1.0155, lr_0 = 3.8059e-04
Validation rmse = 0.134720
Epoch 25
Loss = 1.0755e-01, PNorm = 35.1896, GNorm = 1.2365, lr_0 = 3.7065e-04
Loss = 8.5638e-02, PNorm = 35.1998, GNorm = 4.5233, lr_0 = 3.6097e-04
Validation rmse = 0.131150
Epoch 26
Loss = 8.1457e-02, PNorm = 35.2148, GNorm = 2.3387, lr_0 = 3.5061e-04
Validation rmse = 0.136018
Epoch 27
Loss = 9.2441e-02, PNorm = 35.2264, GNorm = 0.7366, lr_0 = 3.4145e-04
Loss = 8.4668e-02, PNorm = 35.2366, GNorm = 0.6642, lr_0 = 3.3254e-04
Validation rmse = 0.133974
Epoch 28
Loss = 8.4551e-02, PNorm = 35.2472, GNorm = 0.8143, lr_0 = 3.2385e-04
Validation rmse = 0.135478
Epoch 29
Loss = 7.9508e-02, PNorm = 35.2583, GNorm = 3.8213, lr_0 = 3.1539e-04
Loss = 9.2757e-02, PNorm = 35.2695, GNorm = 3.2097, lr_0 = 3.0715e-04
Validation rmse = 0.134016
Epoch 30
Loss = 1.2064e-01, PNorm = 35.2797, GNorm = 3.2981, lr_0 = 2.9913e-04
Loss = 7.8445e-02, PNorm = 35.2902, GNorm = 1.7790, lr_0 = 2.9132e-04
Validation rmse = 0.133312
Epoch 31
Loss = 8.1825e-02, PNorm = 35.3019, GNorm = 2.1251, lr_0 = 2.8371e-04
Validation rmse = 0.129006
Epoch 32
Loss = 7.5645e-02, PNorm = 35.3112, GNorm = 1.2593, lr_0 = 2.7557e-04
Loss = 8.6908e-02, PNorm = 35.3187, GNorm = 0.9762, lr_0 = 2.6837e-04
Validation rmse = 0.130075
Epoch 33
Loss = 7.8570e-02, PNorm = 35.3274, GNorm = 2.1569, lr_0 = 2.6136e-04
Validation rmse = 0.129017
Epoch 34
Loss = 6.2122e-02, PNorm = 35.3373, GNorm = 0.5658, lr_0 = 2.5453e-04
Loss = 9.4588e-02, PNorm = 35.3462, GNorm = 0.8655, lr_0 = 2.4789e-04
Validation rmse = 0.131861
Epoch 35
Loss = 7.7063e-02, PNorm = 35.3552, GNorm = 0.4720, lr_0 = 2.4141e-04
Loss = 9.2407e-02, PNorm = 35.3643, GNorm = 1.4781, lr_0 = 2.3511e-04
Validation rmse = 0.134933
Epoch 36
Loss = 8.4482e-02, PNorm = 35.3728, GNorm = 0.5579, lr_0 = 2.2897e-04
Validation rmse = 0.130390
Epoch 37
Loss = 8.3766e-02, PNorm = 35.3799, GNorm = 0.9562, lr_0 = 2.2299e-04
Loss = 7.1672e-02, PNorm = 35.3875, GNorm = 0.6730, lr_0 = 2.1716e-04
Validation rmse = 0.127541
Epoch 38
Loss = 6.9427e-02, PNorm = 35.3948, GNorm = 0.4064, lr_0 = 2.1093e-04
Validation rmse = 0.135229
Epoch 39
Loss = 5.9899e-02, PNorm = 35.4019, GNorm = 1.2985, lr_0 = 2.0542e-04
Loss = 6.6730e-02, PNorm = 35.4078, GNorm = 0.9696, lr_0 = 2.0006e-04
Validation rmse = 0.131253
Epoch 40
Loss = 9.0963e-02, PNorm = 35.4155, GNorm = 1.6082, lr_0 = 1.9483e-04
Validation rmse = 0.138205
Epoch 41
Loss = 6.8479e-02, PNorm = 35.4220, GNorm = 1.7093, lr_0 = 1.8974e-04
Loss = 7.8658e-02, PNorm = 35.4280, GNorm = 1.5520, lr_0 = 1.8478e-04
Validation rmse = 0.128587
Epoch 42
Loss = 6.2445e-02, PNorm = 35.4335, GNorm = 0.5155, lr_0 = 1.7996e-04
Loss = 8.2825e-02, PNorm = 35.4396, GNorm = 0.7990, lr_0 = 1.7526e-04
Validation rmse = 0.132716
Epoch 43
Loss = 8.3057e-02, PNorm = 35.4447, GNorm = 2.9109, lr_0 = 1.7068e-04
Validation rmse = 0.137111
Epoch 44
Loss = 7.3785e-02, PNorm = 35.4514, GNorm = 1.5358, lr_0 = 1.6578e-04
Loss = 7.9609e-02, PNorm = 35.4567, GNorm = 0.8659, lr_0 = 1.6145e-04
Validation rmse = 0.128430
Epoch 45
Loss = 7.9239e-02, PNorm = 35.4628, GNorm = 0.7996, lr_0 = 1.5724e-04
Validation rmse = 0.132994
Epoch 46
Loss = 6.5313e-02, PNorm = 35.4672, GNorm = 1.3630, lr_0 = 1.5313e-04
Loss = 7.3692e-02, PNorm = 35.4726, GNorm = 0.4189, lr_0 = 1.4913e-04
Validation rmse = 0.128623
Epoch 47
Loss = 7.6284e-02, PNorm = 35.4769, GNorm = 0.8881, lr_0 = 1.4523e-04
Loss = 6.5040e-02, PNorm = 35.4817, GNorm = 1.3417, lr_0 = 1.4144e-04
Validation rmse = 0.133102
Epoch 48
Loss = 5.8674e-02, PNorm = 35.4864, GNorm = 0.6406, lr_0 = 1.3775e-04
Validation rmse = 0.128436
Epoch 49
Loss = 7.0636e-02, PNorm = 35.4913, GNorm = 0.8198, lr_0 = 1.3415e-04
Loss = 7.2980e-02, PNorm = 35.4958, GNorm = 0.7453, lr_0 = 1.3064e-04
Validation rmse = 0.132997
Epoch 50
Loss = 5.7386e-02, PNorm = 35.4997, GNorm = 0.9264, lr_0 = 1.2723e-04
Validation rmse = 0.130861
Epoch 51
Loss = 4.9986e-02, PNorm = 35.5048, GNorm = 1.5767, lr_0 = 1.2358e-04
Loss = 7.6677e-02, PNorm = 35.5088, GNorm = 1.0458, lr_0 = 1.2035e-04
Validation rmse = 0.130987
Epoch 52
Loss = 5.2187e-02, PNorm = 35.5130, GNorm = 0.9008, lr_0 = 1.1721e-04
Validation rmse = 0.132603
Epoch 53
Loss = 7.6876e-02, PNorm = 35.5172, GNorm = 0.5621, lr_0 = 1.1415e-04
Loss = 6.0313e-02, PNorm = 35.5214, GNorm = 2.1357, lr_0 = 1.1117e-04
Validation rmse = 0.127407
Epoch 54
Loss = 7.3159e-02, PNorm = 35.5248, GNorm = 1.8800, lr_0 = 1.0826e-04
Loss = 6.5285e-02, PNorm = 35.5288, GNorm = 0.9567, lr_0 = 1.0544e-04
Validation rmse = 0.129852
Epoch 55
Loss = 6.0447e-02, PNorm = 35.5323, GNorm = 0.5632, lr_0 = 1.0268e-04
Validation rmse = 0.133001
Epoch 56
Loss = 6.8385e-02, PNorm = 35.5361, GNorm = 1.5163, lr_0 = 1.0000e-04
Loss = 6.1674e-02, PNorm = 35.5397, GNorm = 2.0837, lr_0 = 1.0000e-04
Validation rmse = 0.129152
Epoch 57
Loss = 6.1744e-02, PNorm = 35.5429, GNorm = 0.9029, lr_0 = 1.0000e-04
Validation rmse = 0.130676
Epoch 58
Loss = 6.4007e-02, PNorm = 35.5463, GNorm = 0.6230, lr_0 = 1.0000e-04
Loss = 6.3497e-02, PNorm = 35.5500, GNorm = 0.8456, lr_0 = 1.0000e-04
Validation rmse = 0.129567
Epoch 59
Loss = 7.1998e-02, PNorm = 35.5536, GNorm = 1.1662, lr_0 = 1.0000e-04
Loss = 6.5559e-02, PNorm = 35.5574, GNorm = 1.6561, lr_0 = 1.0000e-04
Validation rmse = 0.138438
Model 0 best validation rmse = 0.127407 on epoch 53
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.089424
Ensemble test rmse = 0.089424
1-fold cross validation
	Seed 0 ==> test rmse = 0.089424
Overall test rmse = 0.089424 +/- 0.000000
Elapsed time = 0:00:29
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 987 | train size = 784 | val size = 198 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1688e-01, PNorm = 34.0165, GNorm = 3.7356, lr_0 = 4.3000e-04
Validation rmse = 0.284710
Epoch 1
Loss = 6.6490e-01, PNorm = 34.0562, GNorm = 4.7007, lr_0 = 7.6000e-04
Loss = 6.3432e-01, PNorm = 34.1078, GNorm = 11.7453, lr_0 = 9.9472e-04
Validation rmse = 0.310435
Epoch 2
Loss = 5.5384e-01, PNorm = 34.1621, GNorm = 6.7962, lr_0 = 9.6874e-04
Validation rmse = 0.234037
Epoch 3
Loss = 2.9741e-01, PNorm = 34.2249, GNorm = 2.2078, lr_0 = 9.4344e-04
Loss = 3.2992e-01, PNorm = 34.2848, GNorm = 2.5896, lr_0 = 9.1879e-04
Validation rmse = 0.209167
Epoch 4
Loss = 2.8944e-01, PNorm = 34.3461, GNorm = 3.0010, lr_0 = 8.9243e-04
Validation rmse = 0.201061
Epoch 5
Loss = 3.1523e-01, PNorm = 34.3923, GNorm = 3.6918, lr_0 = 8.6912e-04
Loss = 2.5012e-01, PNorm = 34.4315, GNorm = 0.8852, lr_0 = 8.4642e-04
Validation rmse = 0.180113
Epoch 6
Loss = 2.0554e-01, PNorm = 34.4762, GNorm = 2.2781, lr_0 = 8.2431e-04
Validation rmse = 0.173226
Epoch 7
Loss = 1.7641e-01, PNorm = 34.5179, GNorm = 2.6938, lr_0 = 8.0066e-04
Loss = 2.0181e-01, PNorm = 34.5578, GNorm = 5.3801, lr_0 = 7.7975e-04
Validation rmse = 0.173397
Epoch 8
Loss = 1.4696e-01, PNorm = 34.5926, GNorm = 2.3946, lr_0 = 7.5938e-04
Loss = 1.7060e-01, PNorm = 34.6242, GNorm = 1.9829, lr_0 = 7.3955e-04
Validation rmse = 0.175297
Epoch 9
Loss = 1.5234e-01, PNorm = 34.6567, GNorm = 0.9266, lr_0 = 7.2023e-04
Validation rmse = 0.162226
Epoch 10
Loss = 1.4762e-01, PNorm = 34.6899, GNorm = 3.3772, lr_0 = 6.9956e-04
Loss = 1.4292e-01, PNorm = 34.7141, GNorm = 3.8449, lr_0 = 6.8129e-04
Validation rmse = 0.155080
Epoch 11
Loss = 1.2410e-01, PNorm = 34.7444, GNorm = 1.0662, lr_0 = 6.6350e-04
Validation rmse = 0.156814
Epoch 12
Loss = 1.3395e-01, PNorm = 34.7694, GNorm = 3.3485, lr_0 = 6.4617e-04
Loss = 1.4835e-01, PNorm = 34.7911, GNorm = 1.1840, lr_0 = 6.2929e-04
Validation rmse = 0.146867
Epoch 13
Loss = 1.3296e-01, PNorm = 34.8199, GNorm = 1.0185, lr_0 = 6.1123e-04
Validation rmse = 0.155849
Epoch 14
Loss = 3.0883e-01, PNorm = 34.8419, GNorm = 5.2691, lr_0 = 5.9527e-04
Loss = 1.1440e-01, PNorm = 34.8603, GNorm = 1.0733, lr_0 = 5.7972e-04
Validation rmse = 0.148185
Epoch 15
Loss = 1.4229e-01, PNorm = 34.8793, GNorm = 2.5772, lr_0 = 5.6458e-04
Loss = 9.8293e-02, PNorm = 34.8975, GNorm = 0.5295, lr_0 = 5.4983e-04
Loss = 4.3766e-02, PNorm = 34.8995, GNorm = 0.3358, lr_0 = 5.4838e-04
Validation rmse = 0.160610
Epoch 16
Loss = 1.2972e-01, PNorm = 34.9169, GNorm = 3.4331, lr_0 = 5.3406e-04
Validation rmse = 0.143957
Epoch 17
Loss = 1.1717e-01, PNorm = 34.9337, GNorm = 1.8094, lr_0 = 5.2011e-04
Loss = 1.0652e-01, PNorm = 34.9483, GNorm = 2.1484, lr_0 = 5.0652e-04
Validation rmse = 0.142093
Epoch 18
Loss = 1.0525e-01, PNorm = 34.9638, GNorm = 2.9087, lr_0 = 4.9329e-04
Validation rmse = 0.154017
Epoch 19
Loss = 1.1489e-01, PNorm = 34.9783, GNorm = 1.0157, lr_0 = 4.7914e-04
Loss = 9.1642e-02, PNorm = 34.9920, GNorm = 1.7164, lr_0 = 4.6662e-04
Validation rmse = 0.138668
Epoch 20
Loss = 1.0441e-01, PNorm = 35.0060, GNorm = 0.5419, lr_0 = 4.5443e-04
Validation rmse = 0.134378
Epoch 21
Loss = 6.8808e-02, PNorm = 35.0192, GNorm = 0.5460, lr_0 = 4.4256e-04
Loss = 9.2939e-02, PNorm = 35.0327, GNorm = 2.1677, lr_0 = 4.3101e-04
Validation rmse = 0.137172
Epoch 22
Loss = 9.5227e-02, PNorm = 35.0478, GNorm = 1.2584, lr_0 = 4.1864e-04
Loss = 1.0160e-01, PNorm = 35.0588, GNorm = 2.9724, lr_0 = 4.0770e-04
Validation rmse = 0.134321
Epoch 23
Loss = 9.0578e-02, PNorm = 35.0698, GNorm = 1.2755, lr_0 = 3.9705e-04
Validation rmse = 0.134855
Epoch 24
Loss = 1.2082e-01, PNorm = 35.0815, GNorm = 4.1878, lr_0 = 3.8668e-04
Loss = 8.8169e-02, PNorm = 35.0942, GNorm = 0.8772, lr_0 = 3.7658e-04
Validation rmse = 0.135038
Epoch 25
Loss = 8.2121e-02, PNorm = 35.1036, GNorm = 0.9882, lr_0 = 3.6675e-04
Validation rmse = 0.134817
Epoch 26
Loss = 8.6588e-02, PNorm = 35.1149, GNorm = 2.2236, lr_0 = 3.5622e-04
Loss = 8.7944e-02, PNorm = 35.1257, GNorm = 4.6657, lr_0 = 3.4692e-04
Validation rmse = 0.134137
Epoch 27
Loss = 9.0890e-02, PNorm = 35.1379, GNorm = 3.4609, lr_0 = 3.3786e-04
Validation rmse = 0.133417
Epoch 28
Loss = 7.1886e-02, PNorm = 35.1474, GNorm = 0.6754, lr_0 = 3.2903e-04
Loss = 9.5229e-02, PNorm = 35.1579, GNorm = 0.5279, lr_0 = 3.2044e-04
Validation rmse = 0.131881
Epoch 29
Loss = 8.0315e-02, PNorm = 35.1691, GNorm = 1.8604, lr_0 = 3.1125e-04
Loss = 8.8113e-02, PNorm = 35.1780, GNorm = 0.8761, lr_0 = 3.0312e-04
Validation rmse = 0.132782
Epoch 30
Loss = 8.3899e-02, PNorm = 35.1866, GNorm = 2.2826, lr_0 = 2.9520e-04
Validation rmse = 0.131401
Epoch 31
Loss = 7.5165e-02, PNorm = 35.1945, GNorm = 0.5783, lr_0 = 2.8749e-04
Loss = 9.2611e-02, PNorm = 35.2042, GNorm = 0.7127, lr_0 = 2.7998e-04
Validation rmse = 0.130177
Epoch 32
Loss = 8.2973e-02, PNorm = 35.2124, GNorm = 1.9558, lr_0 = 2.7195e-04
Validation rmse = 0.131149
Epoch 33
Loss = 5.7670e-02, PNorm = 35.2218, GNorm = 1.1384, lr_0 = 2.6484e-04
Loss = 9.2030e-02, PNorm = 35.2307, GNorm = 0.7369, lr_0 = 2.5793e-04
Validation rmse = 0.133174
Epoch 34
Loss = 7.6778e-02, PNorm = 35.2378, GNorm = 1.7891, lr_0 = 2.5119e-04
Validation rmse = 0.129286
Epoch 35
Loss = 6.2316e-02, PNorm = 35.2466, GNorm = 0.5210, lr_0 = 2.4398e-04
Loss = 7.8741e-02, PNorm = 35.2547, GNorm = 0.8995, lr_0 = 2.3761e-04
Validation rmse = 0.130098
Epoch 36
Loss = 1.0054e-01, PNorm = 35.2622, GNorm = 3.2762, lr_0 = 2.3140e-04
Loss = 9.3547e-02, PNorm = 35.2696, GNorm = 4.7106, lr_0 = 2.2536e-04
Validation rmse = 0.136167
Epoch 37
Loss = 9.3935e-02, PNorm = 35.2777, GNorm = 1.4252, lr_0 = 2.1947e-04
Validation rmse = 0.132131
Epoch 38
Loss = 6.3809e-02, PNorm = 35.2857, GNorm = 1.0062, lr_0 = 2.1317e-04
Loss = 8.5254e-02, PNorm = 35.2923, GNorm = 0.8578, lr_0 = 2.0761e-04
Validation rmse = 0.131034
Epoch 39
Loss = 7.3448e-02, PNorm = 35.2986, GNorm = 1.1901, lr_0 = 2.0218e-04
Validation rmse = 0.129045
Epoch 40
Loss = 7.4529e-02, PNorm = 35.3047, GNorm = 0.7947, lr_0 = 1.9690e-04
Loss = 7.4838e-02, PNorm = 35.3103, GNorm = 1.1250, lr_0 = 1.9176e-04
Validation rmse = 0.128032
Epoch 41
Loss = 6.5219e-02, PNorm = 35.3172, GNorm = 0.8747, lr_0 = 1.8626e-04
Validation rmse = 0.129636
Epoch 42
Loss = 7.5898e-02, PNorm = 35.3227, GNorm = 2.2970, lr_0 = 1.8139e-04
Loss = 8.3651e-02, PNorm = 35.3284, GNorm = 1.4260, lr_0 = 1.7666e-04
Validation rmse = 0.131778
Epoch 43
Loss = 9.4336e-02, PNorm = 35.3347, GNorm = 1.2681, lr_0 = 1.7204e-04
Validation rmse = 0.127568
Epoch 44
Loss = 4.9922e-02, PNorm = 35.3407, GNorm = 0.5697, lr_0 = 1.6710e-04
Loss = 7.1886e-02, PNorm = 35.3456, GNorm = 0.8857, lr_0 = 1.6274e-04
Validation rmse = 0.129211
Epoch 45
Loss = 6.3819e-02, PNorm = 35.3502, GNorm = 0.5517, lr_0 = 1.5849e-04
Loss = 7.8852e-02, PNorm = 35.3559, GNorm = 1.7852, lr_0 = 1.5435e-04
Validation rmse = 0.130481
Epoch 46
Loss = 7.2276e-02, PNorm = 35.3600, GNorm = 1.3624, lr_0 = 1.5032e-04
Validation rmse = 0.128894
Epoch 47
Loss = 9.5111e-02, PNorm = 35.3652, GNorm = 0.8602, lr_0 = 1.4601e-04
Loss = 6.6567e-02, PNorm = 35.3707, GNorm = 0.7079, lr_0 = 1.4219e-04
Validation rmse = 0.128238
Epoch 48
Loss = 5.9688e-02, PNorm = 35.3745, GNorm = 1.5430, lr_0 = 1.3848e-04
Validation rmse = 0.128528
Epoch 49
Loss = 5.7150e-02, PNorm = 35.3786, GNorm = 0.6063, lr_0 = 1.3486e-04
Loss = 8.1073e-02, PNorm = 35.3830, GNorm = 1.4850, lr_0 = 1.3134e-04
Validation rmse = 0.126718
Epoch 50
Loss = 5.9210e-02, PNorm = 35.3874, GNorm = 0.8961, lr_0 = 1.2791e-04
Validation rmse = 0.127251
Epoch 51
Loss = 9.9904e-02, PNorm = 35.3917, GNorm = 0.9719, lr_0 = 1.2424e-04
Loss = 7.2508e-02, PNorm = 35.3959, GNorm = 1.1837, lr_0 = 1.2099e-04
Validation rmse = 0.130212
Epoch 52
Loss = 6.0657e-02, PNorm = 35.3994, GNorm = 0.7864, lr_0 = 1.1783e-04
Loss = 7.1876e-02, PNorm = 35.4031, GNorm = 1.0153, lr_0 = 1.1475e-04
Validation rmse = 0.127035
Epoch 53
Loss = 7.1643e-02, PNorm = 35.4068, GNorm = 1.6367, lr_0 = 1.1176e-04
Validation rmse = 0.129129
Epoch 54
Loss = 6.1387e-02, PNorm = 35.4112, GNorm = 0.7665, lr_0 = 1.0855e-04
Loss = 7.6377e-02, PNorm = 35.4150, GNorm = 0.6361, lr_0 = 1.0572e-04
Validation rmse = 0.129110
Epoch 55
Loss = 5.5632e-02, PNorm = 35.4180, GNorm = 0.5563, lr_0 = 1.0295e-04
Validation rmse = 0.127120
Epoch 56
Loss = 7.3141e-02, PNorm = 35.4211, GNorm = 1.5671, lr_0 = 1.0027e-04
Loss = 7.5153e-02, PNorm = 35.4242, GNorm = 2.7415, lr_0 = 1.0000e-04
Validation rmse = 0.131538
Epoch 57
Loss = 6.6846e-02, PNorm = 35.4284, GNorm = 0.5910, lr_0 = 1.0000e-04
Validation rmse = 0.126261
Epoch 58
Loss = 5.8984e-02, PNorm = 35.4319, GNorm = 0.8669, lr_0 = 1.0000e-04
Loss = 8.2057e-02, PNorm = 35.4351, GNorm = 2.4221, lr_0 = 1.0000e-04
Validation rmse = 0.133221
Epoch 59
Loss = 8.9338e-02, PNorm = 35.4382, GNorm = 0.6716, lr_0 = 1.0000e-04
Loss = 6.1866e-02, PNorm = 35.4416, GNorm = 0.5168, lr_0 = 1.0000e-04
Loss = 2.6575e-02, PNorm = 35.4419, GNorm = 0.7620, lr_0 = 1.0000e-04
Validation rmse = 0.125994
Model 0 best validation rmse = 0.125994 on epoch 59
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.140398
Ensemble test rmse = 0.140398
1-fold cross validation
	Seed 0 ==> test rmse = 0.140398
Overall test rmse = 0.140398 +/- 0.000000
Elapsed time = 0:00:30
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 977 | train size = 776 | val size = 196 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.0045e-01, PNorm = 34.0181, GNorm = 6.7826, lr_0 = 4.3000e-04
Validation rmse = 0.296154
Epoch 1
Loss = 5.8240e-01, PNorm = 34.0496, GNorm = 5.4795, lr_0 = 7.6000e-04
Loss = 6.4019e-01, PNorm = 34.1003, GNorm = 12.3637, lr_0 = 9.9472e-04
Validation rmse = 0.272723
Epoch 2
Loss = 5.4666e-01, PNorm = 34.1668, GNorm = 4.2956, lr_0 = 9.6874e-04
Validation rmse = 0.236762
Epoch 3
Loss = 3.7310e-01, PNorm = 34.2366, GNorm = 2.2063, lr_0 = 9.4094e-04
Loss = 5.1096e-01, PNorm = 34.2927, GNorm = 7.0588, lr_0 = 9.1637e-04
Validation rmse = 0.197385
Epoch 4
Loss = 3.6056e-01, PNorm = 34.3560, GNorm = 2.6197, lr_0 = 8.9243e-04
Validation rmse = 0.204331
Epoch 5
Loss = 2.9236e-01, PNorm = 34.4165, GNorm = 0.6952, lr_0 = 8.6682e-04
Loss = 2.7648e-01, PNorm = 34.4747, GNorm = 8.7606, lr_0 = 8.4418e-04
Validation rmse = 0.174273
Epoch 6
Loss = 2.0028e-01, PNorm = 34.5297, GNorm = 0.7828, lr_0 = 8.2213e-04
Validation rmse = 0.162370
Epoch 7
Loss = 1.8805e-01, PNorm = 34.5800, GNorm = 0.8197, lr_0 = 7.9854e-04
Loss = 2.1779e-01, PNorm = 34.6266, GNorm = 4.8386, lr_0 = 7.7769e-04
Validation rmse = 0.150170
Epoch 8
Loss = 1.8632e-01, PNorm = 34.6681, GNorm = 3.4926, lr_0 = 7.5737e-04
Validation rmse = 0.151834
Epoch 9
Loss = 1.7394e-01, PNorm = 34.7113, GNorm = 2.0536, lr_0 = 7.3564e-04
Loss = 1.6798e-01, PNorm = 34.7515, GNorm = 8.8638, lr_0 = 7.1643e-04
Validation rmse = 0.172921
Epoch 10
Loss = 1.5432e-01, PNorm = 34.7815, GNorm = 1.5216, lr_0 = 6.9772e-04
Loss = 1.4432e-01, PNorm = 34.8117, GNorm = 1.5044, lr_0 = 6.7949e-04
Loss = 1.1772e-01, PNorm = 34.8144, GNorm = 2.0727, lr_0 = 6.7770e-04
Validation rmse = 0.148506
Epoch 11
Loss = 1.2644e-01, PNorm = 34.8465, GNorm = 1.6257, lr_0 = 6.5999e-04
Validation rmse = 0.150999
Epoch 12
Loss = 1.3527e-01, PNorm = 34.8718, GNorm = 2.8622, lr_0 = 6.4276e-04
Loss = 1.2141e-01, PNorm = 34.8962, GNorm = 1.4806, lr_0 = 6.2597e-04
Validation rmse = 0.143013
Epoch 13
Loss = 1.1939e-01, PNorm = 34.9210, GNorm = 1.7157, lr_0 = 6.0801e-04
Validation rmse = 0.145019
Epoch 14
Loss = 1.2802e-01, PNorm = 34.9465, GNorm = 1.8327, lr_0 = 5.9213e-04
Loss = 1.0247e-01, PNorm = 34.9671, GNorm = 0.8369, lr_0 = 5.7666e-04
Validation rmse = 0.142176
Epoch 15
Loss = 1.1167e-01, PNorm = 34.9918, GNorm = 0.7157, lr_0 = 5.6011e-04
Validation rmse = 0.138108
Epoch 16
Loss = 8.7191e-02, PNorm = 35.0109, GNorm = 1.0390, lr_0 = 5.4548e-04
Loss = 9.7661e-02, PNorm = 35.0306, GNorm = 0.5165, lr_0 = 5.3124e-04
Validation rmse = 0.141696
Epoch 17
Loss = 9.3778e-02, PNorm = 35.0523, GNorm = 1.5853, lr_0 = 5.1599e-04
Validation rmse = 0.146422
Epoch 18
Loss = 6.5938e-02, PNorm = 35.0696, GNorm = 2.5479, lr_0 = 5.0252e-04
Loss = 1.2796e-01, PNorm = 35.0876, GNorm = 6.2629, lr_0 = 4.8939e-04
Validation rmse = 0.141279
Epoch 19
Loss = 1.0295e-01, PNorm = 35.1078, GNorm = 2.2385, lr_0 = 4.7535e-04
Loss = 9.8521e-02, PNorm = 35.1247, GNorm = 1.9305, lr_0 = 4.6293e-04
Validation rmse = 0.141829
Epoch 20
Loss = 9.0701e-02, PNorm = 35.1377, GNorm = 4.3499, lr_0 = 4.5084e-04
Validation rmse = 0.166116
Epoch 21
Loss = 1.1879e-01, PNorm = 35.1537, GNorm = 5.4306, lr_0 = 4.3790e-04
Loss = 1.0840e-01, PNorm = 35.1709, GNorm = 3.0105, lr_0 = 4.2647e-04
Validation rmse = 0.154140
Epoch 22
Loss = 1.0614e-01, PNorm = 35.1846, GNorm = 2.6435, lr_0 = 4.1533e-04
Validation rmse = 0.138668
Epoch 23
Loss = 1.0547e-01, PNorm = 35.1994, GNorm = 0.9004, lr_0 = 4.0341e-04
Loss = 7.4094e-02, PNorm = 35.2127, GNorm = 1.3805, lr_0 = 3.9287e-04
Validation rmse = 0.142304
Epoch 24
Loss = 8.3355e-02, PNorm = 35.2238, GNorm = 1.1798, lr_0 = 3.8261e-04
Validation rmse = 0.148814
Epoch 25
Loss = 1.1675e-01, PNorm = 35.2343, GNorm = 2.2502, lr_0 = 3.7262e-04
Loss = 8.5294e-02, PNorm = 35.2455, GNorm = 1.1910, lr_0 = 3.6289e-04
Validation rmse = 0.145603
Epoch 26
Loss = 7.4755e-02, PNorm = 35.2581, GNorm = 2.2336, lr_0 = 3.5247e-04
Validation rmse = 0.139946
Epoch 27
Loss = 4.6323e-02, PNorm = 35.2696, GNorm = 2.3410, lr_0 = 3.4327e-04
Loss = 7.9413e-02, PNorm = 35.2789, GNorm = 0.8489, lr_0 = 3.3430e-04
Validation rmse = 0.145135
Epoch 28
Loss = 6.9587e-02, PNorm = 35.2907, GNorm = 1.1414, lr_0 = 3.2471e-04
Loss = 8.7613e-02, PNorm = 35.2989, GNorm = 1.7536, lr_0 = 3.1623e-04
Validation rmse = 0.140665
Epoch 29
Loss = 7.9963e-02, PNorm = 35.3079, GNorm = 3.0075, lr_0 = 3.0797e-04
Validation rmse = 0.145848
Epoch 30
Loss = 9.8635e-02, PNorm = 35.3196, GNorm = 4.5985, lr_0 = 2.9913e-04
Loss = 9.0937e-02, PNorm = 35.3291, GNorm = 1.1989, lr_0 = 2.9132e-04
Validation rmse = 0.143671
Epoch 31
Loss = 7.7400e-02, PNorm = 35.3384, GNorm = 0.8009, lr_0 = 2.8371e-04
Validation rmse = 0.145957
Epoch 32
Loss = 6.6244e-02, PNorm = 35.3479, GNorm = 0.7696, lr_0 = 2.7557e-04
Loss = 7.8128e-02, PNorm = 35.3564, GNorm = 0.7706, lr_0 = 2.6837e-04
Validation rmse = 0.143602
Epoch 33
Loss = 7.0395e-02, PNorm = 35.3642, GNorm = 0.6778, lr_0 = 2.6136e-04
Validation rmse = 0.141365
Epoch 34
Loss = 5.5482e-02, PNorm = 35.3728, GNorm = 2.1628, lr_0 = 2.5386e-04
Loss = 7.6267e-02, PNorm = 35.3807, GNorm = 1.9918, lr_0 = 2.4723e-04
Validation rmse = 0.142006
Epoch 35
Loss = 7.6481e-02, PNorm = 35.3873, GNorm = 3.8343, lr_0 = 2.4077e-04
Validation rmse = 0.145958
Epoch 36
Loss = 5.9126e-02, PNorm = 35.3985, GNorm = 0.6016, lr_0 = 2.3387e-04
Loss = 7.6723e-02, PNorm = 35.4058, GNorm = 1.3075, lr_0 = 2.2776e-04
Validation rmse = 0.142692
Epoch 37
Loss = 6.7065e-02, PNorm = 35.4122, GNorm = 1.3326, lr_0 = 2.2181e-04
Validation rmse = 0.143919
Epoch 38
Loss = 9.7481e-02, PNorm = 35.4201, GNorm = 2.1601, lr_0 = 2.1544e-04
Loss = 6.8384e-02, PNorm = 35.4266, GNorm = 0.7238, lr_0 = 2.0982e-04
Validation rmse = 0.139935
Epoch 39
Loss = 6.2666e-02, PNorm = 35.4329, GNorm = 0.8270, lr_0 = 2.0434e-04
Loss = 6.3680e-02, PNorm = 35.4385, GNorm = 0.7174, lr_0 = 1.9900e-04
Loss = 2.0102e-01, PNorm = 35.4387, GNorm = 5.7282, lr_0 = 1.9847e-04
Validation rmse = 0.140752
Epoch 40
Loss = 7.0639e-02, PNorm = 35.4448, GNorm = 1.8260, lr_0 = 1.9329e-04
Validation rmse = 0.145171
Epoch 41
Loss = 8.8159e-02, PNorm = 35.4504, GNorm = 2.5562, lr_0 = 1.8824e-04
Loss = 7.4504e-02, PNorm = 35.4577, GNorm = 1.9480, lr_0 = 1.8332e-04
Validation rmse = 0.141240
Epoch 42
Loss = 6.5459e-02, PNorm = 35.4644, GNorm = 0.5866, lr_0 = 1.7806e-04
Validation rmse = 0.140518
Epoch 43
Loss = 5.8865e-02, PNorm = 35.4700, GNorm = 1.1649, lr_0 = 1.7341e-04
Loss = 6.4237e-02, PNorm = 35.4740, GNorm = 0.6737, lr_0 = 1.6888e-04
Validation rmse = 0.141430
Epoch 44
Loss = 6.5253e-02, PNorm = 35.4795, GNorm = 0.4021, lr_0 = 1.6404e-04
Validation rmse = 0.142178
Epoch 45
Loss = 5.2590e-02, PNorm = 35.4840, GNorm = 0.7483, lr_0 = 1.5975e-04
Loss = 6.9530e-02, PNorm = 35.4883, GNorm = 1.5820, lr_0 = 1.5558e-04
Validation rmse = 0.141563
Epoch 46
Loss = 7.0718e-02, PNorm = 35.4930, GNorm = 0.7779, lr_0 = 1.5112e-04
Validation rmse = 0.139967
Epoch 47
Loss = 8.1978e-02, PNorm = 35.4982, GNorm = 1.1187, lr_0 = 1.4717e-04
Loss = 6.3908e-02, PNorm = 35.5025, GNorm = 0.9213, lr_0 = 1.4332e-04
Validation rmse = 0.141690
Epoch 48
Loss = 6.7723e-02, PNorm = 35.5066, GNorm = 1.2929, lr_0 = 1.3921e-04
Loss = 6.3395e-02, PNorm = 35.5113, GNorm = 2.2005, lr_0 = 1.3558e-04
Validation rmse = 0.140502
Epoch 49
Loss = 6.3484e-02, PNorm = 35.5152, GNorm = 0.9469, lr_0 = 1.3204e-04
Validation rmse = 0.141623
Epoch 50
Loss = 6.4450e-02, PNorm = 35.5197, GNorm = 1.9525, lr_0 = 1.2859e-04
Loss = 6.1516e-02, PNorm = 35.5240, GNorm = 1.6991, lr_0 = 1.2523e-04
Validation rmse = 0.140891
Epoch 51
Loss = 5.7403e-02, PNorm = 35.5272, GNorm = 0.5754, lr_0 = 1.2163e-04
Validation rmse = 0.140014
Epoch 52
Loss = 6.3430e-02, PNorm = 35.5309, GNorm = 1.7100, lr_0 = 1.1846e-04
Loss = 6.1386e-02, PNorm = 35.5351, GNorm = 1.1628, lr_0 = 1.1536e-04
Validation rmse = 0.142268
Epoch 53
Loss = 6.9208e-02, PNorm = 35.5388, GNorm = 0.7329, lr_0 = 1.1205e-04
Validation rmse = 0.143111
Epoch 54
Loss = 8.5651e-02, PNorm = 35.5416, GNorm = 1.1225, lr_0 = 1.0913e-04
Loss = 6.0112e-02, PNorm = 35.5450, GNorm = 0.4132, lr_0 = 1.0628e-04
Validation rmse = 0.140943
Epoch 55
Loss = 6.4108e-02, PNorm = 35.5484, GNorm = 0.7620, lr_0 = 1.0323e-04
Validation rmse = 0.140943
Epoch 56
Loss = 4.5274e-02, PNorm = 35.5517, GNorm = 2.1919, lr_0 = 1.0053e-04
Loss = 6.3843e-02, PNorm = 35.5545, GNorm = 2.0178, lr_0 = 1.0000e-04
Validation rmse = 0.140632
Epoch 57
Loss = 6.3535e-02, PNorm = 35.5577, GNorm = 0.9617, lr_0 = 1.0000e-04
Loss = 5.6288e-02, PNorm = 35.5609, GNorm = 0.8962, lr_0 = 1.0000e-04
Validation rmse = 0.141341
Epoch 58
Loss = 6.1334e-02, PNorm = 35.5638, GNorm = 1.5856, lr_0 = 1.0000e-04
Validation rmse = 0.140317
Epoch 59
Loss = 7.0310e-02, PNorm = 35.5668, GNorm = 1.2811, lr_0 = 1.0000e-04
Loss = 5.8863e-02, PNorm = 35.5703, GNorm = 1.1336, lr_0 = 1.0000e-04
Validation rmse = 0.143279
Model 0 best validation rmse = 0.138108 on epoch 15
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.106980
Ensemble test rmse = 0.106980
1-fold cross validation
	Seed 0 ==> test rmse = 0.106980
Overall test rmse = 0.106980 +/- 0.000000
Elapsed time = 0:00:28
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 967 | train size = 768 | val size = 194 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.8903e-01, PNorm = 34.0183, GNorm = 4.0449, lr_0 = 4.3000e-04
Validation rmse = 0.312844
Epoch 1
Loss = 6.2549e-01, PNorm = 34.0533, GNorm = 2.1214, lr_0 = 7.6000e-04
Loss = 5.2924e-01, PNorm = 34.1141, GNorm = 1.3450, lr_0 = 9.9472e-04
Loss = 4.5931e-01, PNorm = 34.1202, GNorm = 11.8088, lr_0 = 9.9209e-04
Validation rmse = 0.250134
Epoch 2
Loss = 4.3785e-01, PNorm = 34.1781, GNorm = 8.6607, lr_0 = 9.6618e-04
Validation rmse = 0.227799
Epoch 3
Loss = 4.1601e-01, PNorm = 34.2306, GNorm = 2.5000, lr_0 = 9.4094e-04
Loss = 3.3896e-01, PNorm = 34.2880, GNorm = 1.8433, lr_0 = 9.1637e-04
Validation rmse = 0.206075
Epoch 4
Loss = 3.0705e-01, PNorm = 34.3363, GNorm = 8.1649, lr_0 = 8.9007e-04
Validation rmse = 0.219642
Epoch 5
Loss = 3.1896e-01, PNorm = 34.3876, GNorm = 8.4080, lr_0 = 8.6453e-04
Loss = 2.9229e-01, PNorm = 34.4339, GNorm = 3.6614, lr_0 = 8.4195e-04
Validation rmse = 0.183589
Epoch 6
Loss = 2.5201e-01, PNorm = 34.4743, GNorm = 1.6764, lr_0 = 8.1996e-04
Validation rmse = 0.179949
Epoch 7
Loss = 2.3817e-01, PNorm = 34.5176, GNorm = 2.2621, lr_0 = 7.9643e-04
Loss = 1.8257e-01, PNorm = 34.5584, GNorm = 2.3651, lr_0 = 7.7563e-04
Validation rmse = 0.190744
Epoch 8
Loss = 1.9020e-01, PNorm = 34.5966, GNorm = 0.9589, lr_0 = 7.5338e-04
Validation rmse = 0.173245
Epoch 9
Loss = 2.0680e-01, PNorm = 34.6330, GNorm = 8.2818, lr_0 = 7.3370e-04
Loss = 1.5581e-01, PNorm = 34.6661, GNorm = 4.0372, lr_0 = 7.1453e-04
Validation rmse = 0.160922
Epoch 10
Loss = 1.4508e-01, PNorm = 34.6965, GNorm = 3.8978, lr_0 = 6.9403e-04
Validation rmse = 0.157694
Epoch 11
Loss = 1.2004e-01, PNorm = 34.7242, GNorm = 1.2989, lr_0 = 6.7412e-04
Loss = 1.4323e-01, PNorm = 34.7523, GNorm = 1.1275, lr_0 = 6.5651e-04
Validation rmse = 0.157167
Epoch 12
Loss = 1.3081e-01, PNorm = 34.7782, GNorm = 2.8841, lr_0 = 6.3936e-04
Validation rmse = 0.156331
Epoch 13
Loss = 1.0670e-01, PNorm = 34.8043, GNorm = 2.3616, lr_0 = 6.2102e-04
Loss = 1.2939e-01, PNorm = 34.8336, GNorm = 3.6601, lr_0 = 6.0480e-04
Validation rmse = 0.153367
Epoch 14
Loss = 1.1897e-01, PNorm = 34.8557, GNorm = 2.3882, lr_0 = 5.8900e-04
Loss = 1.0710e-01, PNorm = 34.8749, GNorm = 0.8154, lr_0 = 5.7362e-04
Loss = 1.2971e-01, PNorm = 34.8758, GNorm = 2.2543, lr_0 = 5.7210e-04
Validation rmse = 0.149526
Epoch 15
Loss = 1.2086e-01, PNorm = 34.8950, GNorm = 5.7707, lr_0 = 5.5716e-04
Validation rmse = 0.146686
Epoch 16
Loss = 1.0233e-01, PNorm = 34.9094, GNorm = 1.1673, lr_0 = 5.4117e-04
Loss = 1.2676e-01, PNorm = 34.9273, GNorm = 2.4021, lr_0 = 5.2703e-04
Validation rmse = 0.151138
Epoch 17
Loss = 1.1203e-01, PNorm = 34.9440, GNorm = 2.6273, lr_0 = 5.1327e-04
Validation rmse = 0.149243
Epoch 18
Loss = 1.0214e-01, PNorm = 34.9655, GNorm = 1.2181, lr_0 = 4.9854e-04
Loss = 1.0540e-01, PNorm = 34.9789, GNorm = 3.0012, lr_0 = 4.8552e-04
Validation rmse = 0.146103
Epoch 19
Loss = 9.8986e-02, PNorm = 34.9966, GNorm = 3.2472, lr_0 = 4.7159e-04
Validation rmse = 0.149018
Epoch 20
Loss = 1.2200e-01, PNorm = 35.0096, GNorm = 2.3780, lr_0 = 4.5927e-04
Loss = 1.0001e-01, PNorm = 35.0220, GNorm = 2.6292, lr_0 = 4.4728e-04
Validation rmse = 0.144089
Epoch 21
Loss = 1.1750e-01, PNorm = 35.0343, GNorm = 0.8581, lr_0 = 4.3444e-04
Validation rmse = 0.147037
Epoch 22
Loss = 8.3826e-02, PNorm = 35.0542, GNorm = 1.9886, lr_0 = 4.2198e-04
Loss = 1.0339e-01, PNorm = 35.0665, GNorm = 0.6893, lr_0 = 4.1095e-04
Validation rmse = 0.152647
Epoch 23
Loss = 1.0326e-01, PNorm = 35.0803, GNorm = 2.3011, lr_0 = 4.0022e-04
Validation rmse = 0.170735
Epoch 24
Loss = 1.2782e-01, PNorm = 35.0904, GNorm = 2.5457, lr_0 = 3.8874e-04
Loss = 1.0490e-01, PNorm = 35.1047, GNorm = 1.2884, lr_0 = 3.7858e-04
Validation rmse = 0.159217
Epoch 25
Loss = 9.9638e-02, PNorm = 35.1169, GNorm = 4.6577, lr_0 = 3.6869e-04
Validation rmse = 0.153888
Epoch 26
Loss = 1.0422e-01, PNorm = 35.1312, GNorm = 3.7924, lr_0 = 3.5812e-04
Loss = 8.9513e-02, PNorm = 35.1414, GNorm = 2.1121, lr_0 = 3.4876e-04
Validation rmse = 0.143431
Epoch 27
Loss = 8.6905e-02, PNorm = 35.1518, GNorm = 2.3757, lr_0 = 3.3875e-04
Loss = 8.4770e-02, PNorm = 35.1613, GNorm = 1.7128, lr_0 = 3.2991e-04
Validation rmse = 0.151256
Epoch 28
Loss = 8.9931e-02, PNorm = 35.1711, GNorm = 2.3717, lr_0 = 3.2129e-04
Validation rmse = 0.146853
Epoch 29
Loss = 7.7431e-02, PNorm = 35.1792, GNorm = 3.8619, lr_0 = 3.1207e-04
Loss = 9.4341e-02, PNorm = 35.1892, GNorm = 1.3846, lr_0 = 3.0392e-04
Loss = 2.3208e-01, PNorm = 35.1898, GNorm = 8.0873, lr_0 = 3.0312e-04
Validation rmse = 0.144111
Epoch 30
Loss = 7.5656e-02, PNorm = 35.1983, GNorm = 1.7669, lr_0 = 2.9520e-04
Validation rmse = 0.145174
Epoch 31
Loss = 8.5304e-02, PNorm = 35.2069, GNorm = 2.2021, lr_0 = 2.8749e-04
Loss = 8.7443e-02, PNorm = 35.2153, GNorm = 3.9272, lr_0 = 2.7998e-04
Validation rmse = 0.152734
Epoch 32
Loss = 9.1523e-02, PNorm = 35.2244, GNorm = 3.8892, lr_0 = 2.7195e-04
Validation rmse = 0.141629
Epoch 33
Loss = 8.1357e-02, PNorm = 35.2309, GNorm = 0.6235, lr_0 = 2.6414e-04
Loss = 8.0411e-02, PNorm = 35.2369, GNorm = 2.0892, lr_0 = 2.5724e-04
Validation rmse = 0.148643
Epoch 34
Loss = 7.5565e-02, PNorm = 35.2449, GNorm = 0.7685, lr_0 = 2.5052e-04
Validation rmse = 0.145411
Epoch 35
Loss = 7.5271e-02, PNorm = 35.2511, GNorm = 0.9614, lr_0 = 2.4334e-04
Loss = 7.0435e-02, PNorm = 35.2579, GNorm = 0.7175, lr_0 = 2.3698e-04
Validation rmse = 0.144729
Epoch 36
Loss = 7.9500e-02, PNorm = 35.2646, GNorm = 1.2551, lr_0 = 2.3018e-04
Validation rmse = 0.143323
Epoch 37
Loss = 6.0448e-02, PNorm = 35.2702, GNorm = 0.4671, lr_0 = 2.2417e-04
Loss = 7.7933e-02, PNorm = 35.2773, GNorm = 2.0892, lr_0 = 2.1831e-04
Validation rmse = 0.150718
Epoch 38
Loss = 6.9880e-02, PNorm = 35.2836, GNorm = 1.1743, lr_0 = 2.1205e-04
Validation rmse = 0.143263
Epoch 39
Loss = 8.3715e-02, PNorm = 35.2890, GNorm = 2.7224, lr_0 = 2.0651e-04
Loss = 6.7803e-02, PNorm = 35.2946, GNorm = 0.7168, lr_0 = 2.0112e-04
Validation rmse = 0.145383
Epoch 40
Loss = 6.1816e-02, PNorm = 35.2993, GNorm = 1.0776, lr_0 = 1.9535e-04
Validation rmse = 0.147064
Epoch 41
Loss = 5.2385e-02, PNorm = 35.3044, GNorm = 3.9376, lr_0 = 1.8974e-04
Loss = 7.3036e-02, PNorm = 35.3111, GNorm = 1.2651, lr_0 = 1.8478e-04
Validation rmse = 0.144313
Epoch 42
Loss = 6.4597e-02, PNorm = 35.3154, GNorm = 0.7512, lr_0 = 1.7996e-04
Loss = 7.8177e-02, PNorm = 35.3203, GNorm = 0.5918, lr_0 = 1.7526e-04
Loss = 6.3403e-02, PNorm = 35.3207, GNorm = 3.9185, lr_0 = 1.7479e-04
Validation rmse = 0.145660
Epoch 43
Loss = 7.2191e-02, PNorm = 35.3253, GNorm = 1.9881, lr_0 = 1.7023e-04
Validation rmse = 0.145239
Epoch 44
Loss = 7.1621e-02, PNorm = 35.3297, GNorm = 1.4117, lr_0 = 1.6534e-04
Loss = 6.4788e-02, PNorm = 35.3345, GNorm = 1.2043, lr_0 = 1.6103e-04
Validation rmse = 0.142277
Epoch 45
Loss = 6.0141e-02, PNorm = 35.3381, GNorm = 1.1685, lr_0 = 1.5682e-04
Validation rmse = 0.146836
Epoch 46
Loss = 7.3214e-02, PNorm = 35.3431, GNorm = 3.1627, lr_0 = 1.5232e-04
Loss = 6.7528e-02, PNorm = 35.3468, GNorm = 2.7316, lr_0 = 1.4834e-04
Validation rmse = 0.142559
Epoch 47
Loss = 6.7036e-02, PNorm = 35.3516, GNorm = 0.5319, lr_0 = 1.4409e-04
Validation rmse = 0.142098
Epoch 48
Loss = 8.7076e-02, PNorm = 35.3554, GNorm = 1.7437, lr_0 = 1.4032e-04
Loss = 6.0422e-02, PNorm = 35.3595, GNorm = 1.7008, lr_0 = 1.3666e-04
Validation rmse = 0.146470
Epoch 49
Loss = 6.5053e-02, PNorm = 35.3625, GNorm = 0.6053, lr_0 = 1.3274e-04
Validation rmse = 0.142859
Epoch 50
Loss = 5.8788e-02, PNorm = 35.3656, GNorm = 0.5223, lr_0 = 1.2927e-04
Loss = 6.3775e-02, PNorm = 35.3697, GNorm = 0.8062, lr_0 = 1.2589e-04
Validation rmse = 0.144657
Epoch 51
Loss = 6.2952e-02, PNorm = 35.3735, GNorm = 0.5367, lr_0 = 1.2228e-04
Validation rmse = 0.142083
Epoch 52
Loss = 6.4084e-02, PNorm = 35.3766, GNorm = 0.5919, lr_0 = 1.1877e-04
Loss = 6.5192e-02, PNorm = 35.3799, GNorm = 0.9731, lr_0 = 1.1567e-04
Validation rmse = 0.142432
Epoch 53
Loss = 5.7768e-02, PNorm = 35.3821, GNorm = 0.9485, lr_0 = 1.1265e-04
Validation rmse = 0.143543
Epoch 54
Loss = 4.8886e-02, PNorm = 35.3850, GNorm = 0.7285, lr_0 = 1.0942e-04
Loss = 6.5640e-02, PNorm = 35.3891, GNorm = 0.7692, lr_0 = 1.0656e-04
Validation rmse = 0.141587
Epoch 55
Loss = 5.8181e-02, PNorm = 35.3911, GNorm = 1.6826, lr_0 = 1.0350e-04
Loss = 7.1750e-02, PNorm = 35.3936, GNorm = 1.3907, lr_0 = 1.0080e-04
Validation rmse = 0.143315
Epoch 56
Loss = 6.7202e-02, PNorm = 35.3965, GNorm = 2.3932, lr_0 = 1.0000e-04
Validation rmse = 0.143431
Epoch 57
Loss = 8.5351e-02, PNorm = 35.3984, GNorm = 2.8385, lr_0 = 1.0000e-04
Loss = 5.7452e-02, PNorm = 35.4015, GNorm = 4.0753, lr_0 = 1.0000e-04
Loss = 2.9767e-02, PNorm = 35.4016, GNorm = 0.6907, lr_0 = 1.0000e-04
Validation rmse = 0.141360
Epoch 58
Loss = 6.0903e-02, PNorm = 35.4041, GNorm = 0.9365, lr_0 = 1.0000e-04
Validation rmse = 0.142038
Epoch 59
Loss = 5.1442e-02, PNorm = 35.4064, GNorm = 2.7795, lr_0 = 1.0000e-04
Loss = 6.7163e-02, PNorm = 35.4090, GNorm = 1.4846, lr_0 = 1.0000e-04
Validation rmse = 0.143227
Model 0 best validation rmse = 0.141360 on epoch 57
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.120315
Ensemble test rmse = 0.120315
1-fold cross validation
	Seed 0 ==> test rmse = 0.120315
Overall test rmse = 0.120315 +/- 0.000000
Elapsed time = 0:00:29
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 957 | train size = 760 | val size = 192 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.2182e-01, PNorm = 34.0176, GNorm = 1.1419, lr_0 = 4.3000e-04
Validation rmse = 0.297180
Epoch 1
Loss = 5.8895e-01, PNorm = 34.0552, GNorm = 9.0457, lr_0 = 7.6000e-04
Loss = 8.5993e-01, PNorm = 34.0934, GNorm = 1.5924, lr_0 = 9.9472e-04
Loss = 3.5602e-01, PNorm = 34.0991, GNorm = 2.4871, lr_0 = 9.9209e-04
Validation rmse = 0.419393
Epoch 2
Loss = 9.0524e-01, PNorm = 34.1412, GNorm = 3.7005, lr_0 = 9.6618e-04
Validation rmse = 0.297541
Epoch 3
Loss = 5.7078e-01, PNorm = 34.2081, GNorm = 5.3242, lr_0 = 9.3846e-04
Loss = 5.0264e-01, PNorm = 34.2638, GNorm = 3.6894, lr_0 = 9.1394e-04
Loss = 2.8894e-01, PNorm = 34.2690, GNorm = 2.9653, lr_0 = 9.1153e-04
Validation rmse = 0.234282
Epoch 4
Loss = 3.7471e-01, PNorm = 34.3157, GNorm = 0.9789, lr_0 = 8.8772e-04
Validation rmse = 0.214413
Epoch 5
Loss = 3.5464e-01, PNorm = 34.3609, GNorm = 1.6249, lr_0 = 8.6453e-04
Loss = 3.2390e-01, PNorm = 34.3998, GNorm = 6.5705, lr_0 = 8.4195e-04
Validation rmse = 0.224093
Epoch 6
Loss = 3.3939e-01, PNorm = 34.4438, GNorm = 1.3514, lr_0 = 8.1779e-04
Validation rmse = 0.192214
Epoch 7
Loss = 2.7365e-01, PNorm = 34.4904, GNorm = 4.6717, lr_0 = 7.9433e-04
Loss = 2.5124e-01, PNorm = 34.5303, GNorm = 2.5720, lr_0 = 7.7358e-04
Validation rmse = 0.178133
Epoch 8
Loss = 2.1903e-01, PNorm = 34.5730, GNorm = 2.9993, lr_0 = 7.5138e-04
Validation rmse = 0.171224
Epoch 9
Loss = 2.2138e-01, PNorm = 34.6165, GNorm = 0.7940, lr_0 = 7.2982e-04
Loss = 1.9268e-01, PNorm = 34.6493, GNorm = 2.6116, lr_0 = 7.1076e-04
Validation rmse = 0.165050
Epoch 10
Loss = 1.4861e-01, PNorm = 34.6805, GNorm = 1.2587, lr_0 = 6.9220e-04
Validation rmse = 0.156239
Epoch 11
Loss = 2.0122e-01, PNorm = 34.7162, GNorm = 4.8742, lr_0 = 6.7234e-04
Loss = 1.5206e-01, PNorm = 34.7483, GNorm = 2.1583, lr_0 = 6.5477e-04
Validation rmse = 0.176845
Epoch 12
Loss = 1.9809e-01, PNorm = 34.7852, GNorm = 3.9870, lr_0 = 6.3599e-04
Validation rmse = 0.150342
Epoch 13
Loss = 1.8957e-01, PNorm = 34.8136, GNorm = 2.5369, lr_0 = 6.1774e-04
Loss = 1.5153e-01, PNorm = 34.8407, GNorm = 2.0765, lr_0 = 6.0160e-04
Validation rmse = 0.143143
Epoch 14
Loss = 1.4018e-01, PNorm = 34.8618, GNorm = 2.0030, lr_0 = 5.8434e-04
Validation rmse = 0.140312
Epoch 15
Loss = 1.2488e-01, PNorm = 34.8882, GNorm = 0.9655, lr_0 = 5.6908e-04
Loss = 1.2410e-01, PNorm = 34.9104, GNorm = 1.7625, lr_0 = 5.5421e-04
Validation rmse = 0.146939
Epoch 16
Loss = 1.5267e-01, PNorm = 34.9329, GNorm = 3.2596, lr_0 = 5.3831e-04
Validation rmse = 0.142978
Epoch 17
Loss = 1.0633e-01, PNorm = 34.9580, GNorm = 1.2309, lr_0 = 5.2287e-04
Loss = 1.2166e-01, PNorm = 34.9782, GNorm = 0.7600, lr_0 = 5.0921e-04
Validation rmse = 0.143500
Epoch 18
Loss = 1.2148e-01, PNorm = 34.9909, GNorm = 1.3458, lr_0 = 4.9460e-04
Validation rmse = 0.141996
Epoch 19
Loss = 8.9219e-02, PNorm = 35.0075, GNorm = 2.4176, lr_0 = 4.8041e-04
Loss = 1.2145e-01, PNorm = 35.0255, GNorm = 1.1790, lr_0 = 4.6786e-04
Validation rmse = 0.139323
Epoch 20
Loss = 1.0601e-01, PNorm = 35.0400, GNorm = 1.3067, lr_0 = 4.5564e-04
Validation rmse = 0.152465
Epoch 21
Loss = 1.3885e-01, PNorm = 35.0570, GNorm = 6.9490, lr_0 = 4.4256e-04
Loss = 1.2186e-01, PNorm = 35.0707, GNorm = 1.0424, lr_0 = 4.3101e-04
Validation rmse = 0.161371
Epoch 22
Loss = 1.3634e-01, PNorm = 35.0850, GNorm = 0.9265, lr_0 = 4.1864e-04
Validation rmse = 0.138601
Epoch 23
Loss = 7.6915e-02, PNorm = 35.1004, GNorm = 1.7730, lr_0 = 4.0663e-04
Loss = 1.0118e-01, PNorm = 35.1121, GNorm = 1.5886, lr_0 = 3.9601e-04
Validation rmse = 0.141985
Epoch 24
Loss = 1.0209e-01, PNorm = 35.1264, GNorm = 3.5586, lr_0 = 3.8464e-04
Loss = 9.9139e-02, PNorm = 35.1394, GNorm = 2.6320, lr_0 = 3.7460e-04
Validation rmse = 0.145121
Epoch 25
Loss = 1.1585e-01, PNorm = 35.1511, GNorm = 1.0732, lr_0 = 3.6481e-04
Validation rmse = 0.152809
Epoch 26
Loss = 1.4138e-01, PNorm = 35.1653, GNorm = 4.4119, lr_0 = 3.5434e-04
Loss = 9.1693e-02, PNorm = 35.1783, GNorm = 1.4005, lr_0 = 3.4509e-04
Loss = 3.0592e-02, PNorm = 35.1791, GNorm = 0.9444, lr_0 = 3.4418e-04
Validation rmse = 0.147953
Epoch 27
Loss = 9.2379e-02, PNorm = 35.1868, GNorm = 0.4519, lr_0 = 3.3519e-04
Validation rmse = 0.142716
Epoch 28
Loss = 9.1941e-02, PNorm = 35.1956, GNorm = 0.7896, lr_0 = 3.2557e-04
Loss = 8.9332e-02, PNorm = 35.2052, GNorm = 1.9884, lr_0 = 3.1707e-04
Loss = 8.6917e-02, PNorm = 35.2059, GNorm = 3.6960, lr_0 = 3.1623e-04
Validation rmse = 0.140107
Epoch 29
Loss = 9.2908e-02, PNorm = 35.2152, GNorm = 1.5948, lr_0 = 3.0797e-04
Validation rmse = 0.138773
Epoch 30
Loss = 1.2196e-01, PNorm = 35.2251, GNorm = 2.3883, lr_0 = 2.9992e-04
Loss = 9.3417e-02, PNorm = 35.2340, GNorm = 0.6727, lr_0 = 2.9209e-04
Validation rmse = 0.144203
Epoch 31
Loss = 9.3014e-02, PNorm = 35.2416, GNorm = 0.6525, lr_0 = 2.8371e-04
Validation rmse = 0.142100
Epoch 32
Loss = 6.5297e-02, PNorm = 35.2481, GNorm = 1.0271, lr_0 = 2.7557e-04
Loss = 9.5257e-02, PNorm = 35.2556, GNorm = 2.9095, lr_0 = 2.6837e-04
Validation rmse = 0.143471
Epoch 33
Loss = 9.4402e-02, PNorm = 35.2637, GNorm = 1.1652, lr_0 = 2.6067e-04
Validation rmse = 0.143583
Epoch 34
Loss = 1.0693e-01, PNorm = 35.2710, GNorm = 1.5220, lr_0 = 2.5319e-04
Loss = 7.6180e-02, PNorm = 35.2768, GNorm = 1.6306, lr_0 = 2.4658e-04
Validation rmse = 0.143692
Epoch 35
Loss = 8.2918e-02, PNorm = 35.2854, GNorm = 1.2640, lr_0 = 2.4014e-04
Validation rmse = 0.141731
Epoch 36
Loss = 7.0406e-02, PNorm = 35.2925, GNorm = 1.2534, lr_0 = 2.3325e-04
Loss = 8.5018e-02, PNorm = 35.2970, GNorm = 1.4926, lr_0 = 2.2715e-04
Validation rmse = 0.140233
Epoch 37
Loss = 6.7183e-02, PNorm = 35.3026, GNorm = 1.3873, lr_0 = 2.2064e-04
Validation rmse = 0.143151
Epoch 38
Loss = 6.3982e-02, PNorm = 35.3101, GNorm = 0.9006, lr_0 = 2.1431e-04
Loss = 8.5706e-02, PNorm = 35.3168, GNorm = 3.2000, lr_0 = 2.0871e-04
Validation rmse = 0.142172
Epoch 39
Loss = 7.0265e-02, PNorm = 35.3221, GNorm = 1.2125, lr_0 = 2.0272e-04
Validation rmse = 0.140731
Epoch 40
Loss = 7.2013e-02, PNorm = 35.3271, GNorm = 0.6452, lr_0 = 1.9743e-04
Loss = 8.1538e-02, PNorm = 35.3316, GNorm = 2.2204, lr_0 = 1.9227e-04
Validation rmse = 0.146068
Epoch 41
Loss = 8.2056e-02, PNorm = 35.3371, GNorm = 2.3194, lr_0 = 1.8675e-04
Validation rmse = 0.152126
Epoch 42
Loss = 1.2008e-01, PNorm = 35.3413, GNorm = 4.5284, lr_0 = 1.8139e-04
Loss = 8.3416e-02, PNorm = 35.3465, GNorm = 2.1850, lr_0 = 1.7666e-04
Validation rmse = 0.144306
Epoch 43
Loss = 8.6648e-02, PNorm = 35.3523, GNorm = 2.9642, lr_0 = 1.7159e-04
Validation rmse = 0.144694
Epoch 44
Loss = 9.1379e-02, PNorm = 35.3584, GNorm = 2.9461, lr_0 = 1.6666e-04
Loss = 7.0167e-02, PNorm = 35.3622, GNorm = 1.1861, lr_0 = 1.6231e-04
Validation rmse = 0.144389
Epoch 45
Loss = 6.7170e-02, PNorm = 35.3666, GNorm = 0.6125, lr_0 = 1.5807e-04
Validation rmse = 0.142227
Epoch 46
Loss = 9.0059e-02, PNorm = 35.3706, GNorm = 1.2014, lr_0 = 1.5353e-04
Loss = 8.2647e-02, PNorm = 35.3752, GNorm = 1.4828, lr_0 = 1.4952e-04
Validation rmse = 0.141153
Epoch 47
Loss = 6.0410e-02, PNorm = 35.3787, GNorm = 1.3433, lr_0 = 1.4523e-04
Validation rmse = 0.142222
Epoch 48
Loss = 1.8161e-01, PNorm = 35.3819, GNorm = 1.3536, lr_0 = 1.4107e-04
Loss = 7.0414e-02, PNorm = 35.3873, GNorm = 3.2400, lr_0 = 1.3738e-04
Validation rmse = 0.142170
Epoch 49
Loss = 6.5593e-02, PNorm = 35.3913, GNorm = 0.5467, lr_0 = 1.3344e-04
Loss = 7.9065e-02, PNorm = 35.3942, GNorm = 2.7182, lr_0 = 1.2996e-04
Validation rmse = 0.142907
Epoch 50
Loss = 6.9642e-02, PNorm = 35.3981, GNorm = 0.7791, lr_0 = 1.2656e-04
Validation rmse = 0.141659
Epoch 51
Loss = 8.7383e-02, PNorm = 35.4013, GNorm = 1.8384, lr_0 = 1.2293e-04
Loss = 6.6770e-02, PNorm = 35.4041, GNorm = 0.5055, lr_0 = 1.1972e-04
Loss = 1.7121e-02, PNorm = 35.4044, GNorm = 1.4303, lr_0 = 1.1940e-04
Validation rmse = 0.142342
Epoch 52
Loss = 6.7779e-02, PNorm = 35.4069, GNorm = 0.8815, lr_0 = 1.1628e-04
Validation rmse = 0.141533
Epoch 53
Loss = 7.5645e-02, PNorm = 35.4108, GNorm = 0.5290, lr_0 = 1.1295e-04
Loss = 6.8754e-02, PNorm = 35.4132, GNorm = 1.4703, lr_0 = 1.1000e-04
Loss = 1.3700e-01, PNorm = 35.4134, GNorm = 4.9741, lr_0 = 1.0971e-04
Validation rmse = 0.144936
Epoch 54
Loss = 6.9552e-02, PNorm = 35.4177, GNorm = 2.2431, lr_0 = 1.0684e-04
Validation rmse = 0.144860
Epoch 55
Loss = 6.6335e-02, PNorm = 35.4196, GNorm = 1.5625, lr_0 = 1.0405e-04
Loss = 7.8215e-02, PNorm = 35.4218, GNorm = 0.7364, lr_0 = 1.0133e-04
Validation rmse = 0.141978
Epoch 56
Loss = 7.9246e-02, PNorm = 35.4266, GNorm = 1.9595, lr_0 = 1.0000e-04
Validation rmse = 0.143023
Epoch 57
Loss = 5.5982e-02, PNorm = 35.4295, GNorm = 1.1391, lr_0 = 1.0000e-04
Loss = 8.4649e-02, PNorm = 35.4316, GNorm = 1.0712, lr_0 = 1.0000e-04
Validation rmse = 0.143069
Epoch 58
Loss = 7.5701e-02, PNorm = 35.4343, GNorm = 0.7621, lr_0 = 1.0000e-04
Validation rmse = 0.144212
Epoch 59
Loss = 7.7837e-02, PNorm = 35.4376, GNorm = 2.4717, lr_0 = 1.0000e-04
Loss = 7.9174e-02, PNorm = 35.4403, GNorm = 0.7637, lr_0 = 1.0000e-04
Validation rmse = 0.150010
Model 0 best validation rmse = 0.138601 on epoch 22
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.141959
Ensemble test rmse = 0.141959
1-fold cross validation
	Seed 0 ==> test rmse = 0.141959
Overall test rmse = 0.141959 +/- 0.000000
Elapsed time = 0:00:28
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 947 | train size = 752 | val size = 190 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.4669e-01, PNorm = 34.0168, GNorm = 8.6483, lr_0 = 4.3000e-04
Validation rmse = 0.295471
Epoch 1
Loss = 8.4997e-01, PNorm = 34.0397, GNorm = 4.4815, lr_0 = 7.6000e-04
Loss = 8.0849e-01, PNorm = 34.0835, GNorm = 5.0809, lr_0 = 9.9472e-04
Loss = 2.3131e+00, PNorm = 34.0870, GNorm = 13.2580, lr_0 = 9.9209e-04
Validation rmse = 0.283645
Epoch 2
Loss = 6.5536e-01, PNorm = 34.1467, GNorm = 8.5488, lr_0 = 9.6618e-04
Validation rmse = 0.259797
Epoch 3
Loss = 5.2606e-01, PNorm = 34.2108, GNorm = 1.5004, lr_0 = 9.3846e-04
Loss = 5.6676e-01, PNorm = 34.2635, GNorm = 3.0008, lr_0 = 9.1394e-04
Loss = 1.1525e+00, PNorm = 34.2689, GNorm = 6.7025, lr_0 = 9.1153e-04
Validation rmse = 0.281195
Epoch 4
Loss = 4.6970e-01, PNorm = 34.3184, GNorm = 6.4969, lr_0 = 8.8772e-04
Validation rmse = 0.220858
Epoch 5
Loss = 3.0476e-01, PNorm = 34.3673, GNorm = 1.9496, lr_0 = 8.6225e-04
Loss = 3.5474e-01, PNorm = 34.3955, GNorm = 1.5603, lr_0 = 8.3973e-04
Loss = 3.4083e-01, PNorm = 34.4005, GNorm = 4.3367, lr_0 = 8.3751e-04
Validation rmse = 0.204854
Epoch 6
Loss = 2.6461e-01, PNorm = 34.4431, GNorm = 1.0452, lr_0 = 8.1563e-04
Validation rmse = 0.213397
Epoch 7
Loss = 3.3255e-01, PNorm = 34.4823, GNorm = 1.5702, lr_0 = 7.9223e-04
Loss = 3.5053e-01, PNorm = 34.5152, GNorm = 0.9237, lr_0 = 7.7154e-04
Loss = 1.1893e-01, PNorm = 34.5187, GNorm = 4.5255, lr_0 = 7.6950e-04
Validation rmse = 0.211521
Epoch 8
Loss = 2.6331e-01, PNorm = 34.5562, GNorm = 3.1775, lr_0 = 7.4940e-04
Validation rmse = 0.185579
Epoch 9
Loss = 2.0672e-01, PNorm = 34.5826, GNorm = 1.5563, lr_0 = 7.2790e-04
Loss = 1.9865e-01, PNorm = 34.6111, GNorm = 4.7525, lr_0 = 7.0888e-04
Loss = 3.3922e-02, PNorm = 34.6138, GNorm = 3.8315, lr_0 = 7.0701e-04
Validation rmse = 0.174665
Epoch 10
Loss = 1.5866e-01, PNorm = 34.6449, GNorm = 1.0044, lr_0 = 6.8854e-04
Validation rmse = 0.186168
Epoch 11
Loss = 2.0045e-01, PNorm = 34.6774, GNorm = 4.2840, lr_0 = 6.6879e-04
Loss = 1.8934e-01, PNorm = 34.7066, GNorm = 3.0127, lr_0 = 6.5132e-04
Loss = 2.0160e-01, PNorm = 34.7112, GNorm = 8.3725, lr_0 = 6.4960e-04
Validation rmse = 0.187766
Epoch 12
Loss = 1.9804e-01, PNorm = 34.7389, GNorm = 0.9953, lr_0 = 6.3263e-04
Validation rmse = 0.197773
Epoch 13
Loss = 2.3045e-01, PNorm = 34.7682, GNorm = 3.7121, lr_0 = 6.1448e-04
Loss = 1.6543e-01, PNorm = 34.7939, GNorm = 2.7494, lr_0 = 5.9843e-04
Loss = 1.9850e-02, PNorm = 34.7963, GNorm = 1.8429, lr_0 = 5.9685e-04
Validation rmse = 0.183216
Epoch 14
Loss = 1.4872e-01, PNorm = 34.8182, GNorm = 1.2384, lr_0 = 5.8126e-04
Validation rmse = 0.155111
Epoch 15
Loss = 1.2642e-01, PNorm = 34.8372, GNorm = 1.4438, lr_0 = 5.6458e-04
Loss = 1.1474e-01, PNorm = 34.8544, GNorm = 1.8799, lr_0 = 5.4983e-04
Loss = 1.7231e-01, PNorm = 34.8576, GNorm = 5.7165, lr_0 = 5.4838e-04
Validation rmse = 0.157426
Epoch 16
Loss = 1.3619e-01, PNorm = 34.8804, GNorm = 1.3524, lr_0 = 5.3406e-04
Validation rmse = 0.155695
Epoch 17
Loss = 1.2003e-01, PNorm = 34.8951, GNorm = 0.8462, lr_0 = 5.1873e-04
Loss = 1.1631e-01, PNorm = 34.9123, GNorm = 1.7092, lr_0 = 5.0518e-04
Loss = 3.7095e-01, PNorm = 34.9135, GNorm = 10.9284, lr_0 = 5.0385e-04
Validation rmse = 0.158310
Epoch 18
Loss = 1.3554e-01, PNorm = 34.9353, GNorm = 3.2605, lr_0 = 4.9069e-04
Validation rmse = 0.178803
Epoch 19
Loss = 1.5340e-01, PNorm = 34.9582, GNorm = 1.4502, lr_0 = 4.7661e-04
Loss = 1.0965e-01, PNorm = 34.9768, GNorm = 0.6176, lr_0 = 4.6416e-04
Loss = 1.3635e-01, PNorm = 34.9780, GNorm = 5.1355, lr_0 = 4.6293e-04
Validation rmse = 0.147459
Epoch 20
Loss = 1.0659e-01, PNorm = 34.9901, GNorm = 0.6952, lr_0 = 4.5084e-04
Validation rmse = 0.165275
Epoch 21
Loss = 1.1799e-01, PNorm = 35.0042, GNorm = 1.5586, lr_0 = 4.3790e-04
Loss = 1.0261e-01, PNorm = 35.0159, GNorm = 1.2240, lr_0 = 4.2647e-04
Loss = 3.0884e-02, PNorm = 35.0169, GNorm = 2.9112, lr_0 = 4.2534e-04
Validation rmse = 0.151814
Epoch 22
Loss = 8.6040e-02, PNorm = 35.0255, GNorm = 1.6742, lr_0 = 4.1423e-04
Validation rmse = 0.160173
Epoch 23
Loss = 1.5046e-01, PNorm = 35.0417, GNorm = 0.7609, lr_0 = 4.0234e-04
Loss = 1.3467e-01, PNorm = 35.0577, GNorm = 1.2230, lr_0 = 3.9184e-04
Loss = 7.3820e-02, PNorm = 35.0602, GNorm = 6.7861, lr_0 = 3.9080e-04
Validation rmse = 0.184230
Epoch 24
Loss = 1.5752e-01, PNorm = 35.0694, GNorm = 1.6905, lr_0 = 3.8059e-04
Validation rmse = 0.154464
Epoch 25
Loss = 1.0131e-01, PNorm = 35.0818, GNorm = 2.9541, lr_0 = 3.7065e-04
Loss = 1.0097e-01, PNorm = 35.0937, GNorm = 1.2779, lr_0 = 3.6097e-04
Validation rmse = 0.147927
Epoch 26
Loss = 9.4628e-02, PNorm = 35.1021, GNorm = 1.5742, lr_0 = 3.5061e-04
Validation rmse = 0.153280
Epoch 27
Loss = 8.8615e-02, PNorm = 35.1107, GNorm = 1.4917, lr_0 = 3.4055e-04
Loss = 9.0657e-02, PNorm = 35.1191, GNorm = 1.7459, lr_0 = 3.3166e-04
Validation rmse = 0.147652
Epoch 28
Loss = 8.7992e-02, PNorm = 35.1271, GNorm = 0.4212, lr_0 = 3.2214e-04
Validation rmse = 0.146990
Epoch 29
Loss = 8.9007e-02, PNorm = 35.1340, GNorm = 2.0016, lr_0 = 3.1290e-04
Loss = 9.6786e-02, PNorm = 35.1413, GNorm = 2.2269, lr_0 = 3.0472e-04
Validation rmse = 0.148848
Epoch 30
Loss = 9.7762e-02, PNorm = 35.1485, GNorm = 1.5843, lr_0 = 2.9598e-04
Validation rmse = 0.158795
Epoch 31
Loss = 9.6548e-02, PNorm = 35.1569, GNorm = 0.6705, lr_0 = 2.8749e-04
Loss = 8.3938e-02, PNorm = 35.1663, GNorm = 0.9432, lr_0 = 2.7998e-04
Validation rmse = 0.150943
Epoch 32
Loss = 8.3882e-02, PNorm = 35.1721, GNorm = 0.9122, lr_0 = 2.7195e-04
Validation rmse = 0.156887
Epoch 33
Loss = 9.4656e-02, PNorm = 35.1796, GNorm = 0.4847, lr_0 = 2.6414e-04
Loss = 8.7909e-02, PNorm = 35.1870, GNorm = 2.3013, lr_0 = 2.5724e-04
Validation rmse = 0.154762
Epoch 34
Loss = 8.2362e-02, PNorm = 35.1913, GNorm = 2.3343, lr_0 = 2.4986e-04
Validation rmse = 0.145211
Epoch 35
Loss = 9.5866e-02, PNorm = 35.1987, GNorm = 2.2845, lr_0 = 2.4269e-04
Loss = 9.2933e-02, PNorm = 35.2049, GNorm = 2.8533, lr_0 = 2.3635e-04
Validation rmse = 0.150689
Epoch 36
Loss = 9.3523e-02, PNorm = 35.2100, GNorm = 2.7260, lr_0 = 2.2957e-04
Validation rmse = 0.147721
Epoch 37
Loss = 6.5015e-02, PNorm = 35.2168, GNorm = 1.7137, lr_0 = 2.2299e-04
Loss = 9.0528e-02, PNorm = 35.2228, GNorm = 1.0724, lr_0 = 2.1716e-04
Validation rmse = 0.146676
Epoch 38
Loss = 9.3649e-02, PNorm = 35.2320, GNorm = 0.9486, lr_0 = 2.1093e-04
Validation rmse = 0.151061
Epoch 39
Loss = 7.8448e-02, PNorm = 35.2388, GNorm = 3.0889, lr_0 = 2.0488e-04
Loss = 9.6252e-02, PNorm = 35.2457, GNorm = 1.2896, lr_0 = 1.9953e-04
Validation rmse = 0.149085
Epoch 40
Loss = 7.9479e-02, PNorm = 35.2522, GNorm = 1.0731, lr_0 = 1.9380e-04
Validation rmse = 0.147908
Epoch 41
Loss = 7.0622e-02, PNorm = 35.2564, GNorm = 0.5176, lr_0 = 1.8824e-04
Loss = 8.0314e-02, PNorm = 35.2584, GNorm = 0.5067, lr_0 = 1.8332e-04
Validation rmse = 0.150865
Epoch 42
Loss = 9.0254e-02, PNorm = 35.2623, GNorm = 2.7944, lr_0 = 1.7806e-04
Validation rmse = 0.167509
Epoch 43
Loss = 1.0469e-01, PNorm = 35.2671, GNorm = 1.6145, lr_0 = 1.7295e-04
Loss = 8.2996e-02, PNorm = 35.2710, GNorm = 0.8329, lr_0 = 1.6844e-04
Validation rmse = 0.148658
Epoch 44
Loss = 7.1775e-02, PNorm = 35.2743, GNorm = 1.1454, lr_0 = 1.6360e-04
Validation rmse = 0.143651
Epoch 45
Loss = 6.3900e-02, PNorm = 35.2787, GNorm = 1.6103, lr_0 = 1.5891e-04
Loss = 8.2449e-02, PNorm = 35.2832, GNorm = 1.3784, lr_0 = 1.5476e-04
Validation rmse = 0.144534
Epoch 46
Loss = 8.2264e-02, PNorm = 35.2900, GNorm = 1.3454, lr_0 = 1.5032e-04
Validation rmse = 0.143432
Epoch 47
Loss = 8.5648e-02, PNorm = 35.2929, GNorm = 1.1067, lr_0 = 1.4601e-04
Loss = 8.0610e-02, PNorm = 35.2962, GNorm = 0.7417, lr_0 = 1.4219e-04
Validation rmse = 0.143263
Epoch 48
Loss = 7.3322e-02, PNorm = 35.2992, GNorm = 1.0636, lr_0 = 1.3811e-04
Validation rmse = 0.143090
Epoch 49
Loss = 7.2104e-02, PNorm = 35.3017, GNorm = 0.7589, lr_0 = 1.3415e-04
Loss = 7.1320e-02, PNorm = 35.3042, GNorm = 0.4649, lr_0 = 1.3064e-04
Validation rmse = 0.143439
Epoch 50
Loss = 6.7647e-02, PNorm = 35.3066, GNorm = 0.5556, lr_0 = 1.2723e-04
Validation rmse = 0.144294
Epoch 51
Loss = 7.5785e-02, PNorm = 35.3090, GNorm = 0.7067, lr_0 = 1.2358e-04
Loss = 7.2790e-02, PNorm = 35.3124, GNorm = 0.4058, lr_0 = 1.2035e-04
Validation rmse = 0.147063
Epoch 52
Loss = 7.3175e-02, PNorm = 35.3145, GNorm = 1.5053, lr_0 = 1.1690e-04
Validation rmse = 0.148237
Epoch 53
Loss = 6.3964e-02, PNorm = 35.3170, GNorm = 0.4509, lr_0 = 1.1355e-04
Loss = 7.5121e-02, PNorm = 35.3193, GNorm = 0.7660, lr_0 = 1.1058e-04
Validation rmse = 0.149482
Epoch 54
Loss = 7.4360e-02, PNorm = 35.3223, GNorm = 0.7449, lr_0 = 1.0741e-04
Validation rmse = 0.144119
Epoch 55
Loss = 6.7582e-02, PNorm = 35.3248, GNorm = 0.7348, lr_0 = 1.0433e-04
Loss = 7.1630e-02, PNorm = 35.3285, GNorm = 0.7176, lr_0 = 1.0160e-04
Validation rmse = 0.146738
Epoch 56
Loss = 7.9683e-02, PNorm = 35.3313, GNorm = 0.7648, lr_0 = 1.0000e-04
Validation rmse = 0.148621
Epoch 57
Loss = 5.1499e-02, PNorm = 35.3341, GNorm = 0.7025, lr_0 = 1.0000e-04
Loss = 7.6741e-02, PNorm = 35.3353, GNorm = 2.3247, lr_0 = 1.0000e-04
Validation rmse = 0.144456
Epoch 58
Loss = 6.5656e-02, PNorm = 35.3380, GNorm = 0.7047, lr_0 = 1.0000e-04
Validation rmse = 0.143323
Epoch 59
Loss = 7.5500e-02, PNorm = 35.3408, GNorm = 0.6747, lr_0 = 1.0000e-04
Loss = 7.3331e-02, PNorm = 35.3427, GNorm = 1.0176, lr_0 = 1.0000e-04
Validation rmse = 0.143014
Model 0 best validation rmse = 0.143014 on epoch 59
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.111959
Ensemble test rmse = 0.111959
1-fold cross validation
	Seed 0 ==> test rmse = 0.111959
Overall test rmse = 0.111959 +/- 0.000000
Elapsed time = 0:00:28
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 937 | train size = 744 | val size = 188 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.2721e-01, PNorm = 34.0181, GNorm = 1.3874, lr_0 = 4.5357e-04
Validation rmse = 0.289071
Epoch 1
Loss = 6.0198e-01, PNorm = 34.0573, GNorm = 5.1647, lr_0 = 8.0714e-04
Validation rmse = 0.305932
Epoch 2
Loss = 7.3121e-01, PNorm = 34.1083, GNorm = 12.4195, lr_0 = 9.8872e-04
Loss = 4.7999e-01, PNorm = 34.1714, GNorm = 3.4980, lr_0 = 9.6108e-04
Validation rmse = 0.241232
Epoch 3
Loss = 3.4167e-01, PNorm = 34.2369, GNorm = 1.8042, lr_0 = 9.3421e-04
Validation rmse = 0.214852
Epoch 4
Loss = 3.7234e-01, PNorm = 34.2939, GNorm = 4.0563, lr_0 = 9.0809e-04
Loss = 2.9359e-01, PNorm = 34.3486, GNorm = 5.9002, lr_0 = 8.8270e-04
Validation rmse = 0.209043
Epoch 5
Loss = 2.6221e-01, PNorm = 34.3940, GNorm = 3.6617, lr_0 = 8.5802e-04
Validation rmse = 0.209424
Epoch 6
Loss = 2.2302e-01, PNorm = 34.4317, GNorm = 2.8139, lr_0 = 8.3403e-04
Loss = 2.2985e-01, PNorm = 34.4679, GNorm = 4.0720, lr_0 = 8.1071e-04
Validation rmse = 0.180370
Epoch 7
Loss = 2.0262e-01, PNorm = 34.5044, GNorm = 1.9270, lr_0 = 7.8805e-04
Validation rmse = 0.184010
Epoch 8
Loss = 1.9679e-01, PNorm = 34.5388, GNorm = 3.7688, lr_0 = 7.6601e-04
Loss = 2.1865e-01, PNorm = 34.5702, GNorm = 6.0892, lr_0 = 7.4460e-04
Validation rmse = 0.167991
Epoch 9
Loss = 1.7139e-01, PNorm = 34.6012, GNorm = 0.7775, lr_0 = 7.2173e-04
Validation rmse = 0.167347
Epoch 10
Loss = 2.5168e-01, PNorm = 34.6321, GNorm = 5.3354, lr_0 = 7.0155e-04
Loss = 1.4119e-01, PNorm = 34.6695, GNorm = 1.5319, lr_0 = 6.8194e-04
Validation rmse = 0.157869
Epoch 11
Loss = 1.4484e-01, PNorm = 34.6970, GNorm = 4.0556, lr_0 = 6.6287e-04
Validation rmse = 0.151222
Epoch 12
Loss = 1.7279e-01, PNorm = 34.7216, GNorm = 4.9744, lr_0 = 6.4434e-04
Loss = 1.4451e-01, PNorm = 34.7465, GNorm = 2.1764, lr_0 = 6.2632e-04
Validation rmse = 0.145097
Epoch 13
Loss = 1.2849e-01, PNorm = 34.7670, GNorm = 5.8541, lr_0 = 6.0881e-04
Validation rmse = 0.158266
Epoch 14
Loss = 1.5542e-01, PNorm = 34.7917, GNorm = 3.7664, lr_0 = 5.9179e-04
Loss = 1.4093e-01, PNorm = 34.8119, GNorm = 6.2624, lr_0 = 5.7524e-04
Validation rmse = 0.141028
Epoch 15
Loss = 1.5180e-01, PNorm = 34.8362, GNorm = 5.2739, lr_0 = 5.5916e-04
Validation rmse = 0.143502
Epoch 16
Loss = 1.3913e-01, PNorm = 34.8591, GNorm = 2.4244, lr_0 = 5.4353e-04
Loss = 1.4899e-01, PNorm = 34.8820, GNorm = 4.0761, lr_0 = 5.2833e-04
Validation rmse = 0.155816
Epoch 17
Loss = 1.2435e-01, PNorm = 34.9041, GNorm = 1.4295, lr_0 = 5.1211e-04
Validation rmse = 0.149928
Epoch 18
Loss = 1.0298e-01, PNorm = 34.9241, GNorm = 3.3210, lr_0 = 4.9779e-04
Loss = 1.1100e-01, PNorm = 34.9418, GNorm = 1.1716, lr_0 = 4.8387e-04
Validation rmse = 0.136619
Epoch 19
Loss = 1.1021e-01, PNorm = 34.9570, GNorm = 2.2565, lr_0 = 4.7034e-04
Validation rmse = 0.145737
Epoch 20
Loss = 1.0129e-01, PNorm = 34.9730, GNorm = 1.3138, lr_0 = 4.5719e-04
Loss = 1.0208e-01, PNorm = 34.9886, GNorm = 3.1200, lr_0 = 4.4441e-04
Validation rmse = 0.132297
Epoch 21
Loss = 7.6059e-02, PNorm = 35.0034, GNorm = 0.6309, lr_0 = 4.3198e-04
Validation rmse = 0.132114
Epoch 22
Loss = 6.1968e-02, PNorm = 35.0166, GNorm = 1.1182, lr_0 = 4.1991e-04
Loss = 1.0762e-01, PNorm = 35.0283, GNorm = 2.9823, lr_0 = 4.0817e-04
Validation rmse = 0.134373
Epoch 23
Loss = 8.7698e-02, PNorm = 35.0416, GNorm = 2.1502, lr_0 = 3.9675e-04
Validation rmse = 0.129296
Epoch 24
Loss = 9.7482e-02, PNorm = 35.0535, GNorm = 3.8408, lr_0 = 3.8566e-04
Loss = 9.9847e-02, PNorm = 35.0659, GNorm = 3.6658, lr_0 = 3.7488e-04
Validation rmse = 0.136042
Epoch 25
Loss = 1.0658e-01, PNorm = 35.0775, GNorm = 0.7975, lr_0 = 3.6440e-04
Validation rmse = 0.129274
Epoch 26
Loss = 1.0561e-01, PNorm = 35.0918, GNorm = 2.4542, lr_0 = 3.5321e-04
Loss = 8.4567e-02, PNorm = 35.1025, GNorm = 2.3523, lr_0 = 3.4333e-04
Validation rmse = 0.131995
Epoch 27
Loss = 8.9107e-02, PNorm = 35.1117, GNorm = 1.0516, lr_0 = 3.3373e-04
Validation rmse = 0.127765
Epoch 28
Loss = 9.2383e-02, PNorm = 35.1223, GNorm = 0.8610, lr_0 = 3.2440e-04
Loss = 7.9273e-02, PNorm = 35.1319, GNorm = 0.9665, lr_0 = 3.1533e-04
Validation rmse = 0.125106
Epoch 29
Loss = 7.5853e-02, PNorm = 35.1415, GNorm = 1.3356, lr_0 = 3.0652e-04
Validation rmse = 0.133519
Epoch 30
Loss = 8.9074e-02, PNorm = 35.1502, GNorm = 1.9266, lr_0 = 2.9795e-04
Loss = 8.8364e-02, PNorm = 35.1613, GNorm = 1.5967, lr_0 = 2.8962e-04
Validation rmse = 0.131095
Epoch 31
Loss = 9.4854e-02, PNorm = 35.1700, GNorm = 1.0654, lr_0 = 2.8152e-04
Validation rmse = 0.135659
Epoch 32
Loss = 6.5122e-02, PNorm = 35.1788, GNorm = 2.4004, lr_0 = 2.7365e-04
Loss = 9.5920e-02, PNorm = 35.1862, GNorm = 1.9597, lr_0 = 2.6600e-04
Validation rmse = 0.128404
Epoch 33
Loss = 8.8430e-02, PNorm = 35.1949, GNorm = 0.9630, lr_0 = 2.5856e-04
Validation rmse = 0.127799
Epoch 34
Loss = 7.4002e-02, PNorm = 35.2029, GNorm = 0.8109, lr_0 = 2.5062e-04
Loss = 8.8715e-02, PNorm = 35.2094, GNorm = 3.7979, lr_0 = 2.4361e-04
Validation rmse = 0.129144
Epoch 35
Loss = 9.4030e-02, PNorm = 35.2179, GNorm = 3.2750, lr_0 = 2.3680e-04
Validation rmse = 0.126871
Epoch 36
Loss = 7.3151e-02, PNorm = 35.2245, GNorm = 0.5598, lr_0 = 2.3018e-04
Loss = 7.9690e-02, PNorm = 35.2319, GNorm = 0.6707, lr_0 = 2.2375e-04
Validation rmse = 0.125166
Epoch 37
Loss = 7.0914e-02, PNorm = 35.2386, GNorm = 1.2001, lr_0 = 2.1749e-04
Validation rmse = 0.125291
Epoch 38
Loss = 6.6142e-02, PNorm = 35.2439, GNorm = 1.3583, lr_0 = 2.1141e-04
Loss = 7.6627e-02, PNorm = 35.2493, GNorm = 1.0317, lr_0 = 2.0550e-04
Validation rmse = 0.125557
Epoch 39
Loss = 6.6500e-02, PNorm = 35.2552, GNorm = 0.5787, lr_0 = 1.9975e-04
Validation rmse = 0.126173
Epoch 40
Loss = 6.7602e-02, PNorm = 35.2610, GNorm = 0.8172, lr_0 = 1.9417e-04
Loss = 7.4660e-02, PNorm = 35.2666, GNorm = 0.6150, lr_0 = 1.8874e-04
Validation rmse = 0.125177
Epoch 41
Loss = 7.6729e-02, PNorm = 35.2719, GNorm = 1.6493, lr_0 = 1.8346e-04
Validation rmse = 0.125202
Epoch 42
Loss = 8.2241e-02, PNorm = 35.2784, GNorm = 0.5421, lr_0 = 1.7783e-04
Validation rmse = 0.124576
Epoch 43
Loss = 1.6888e-01, PNorm = 35.2834, GNorm = 0.8996, lr_0 = 1.7286e-04
Loss = 6.5412e-02, PNorm = 35.2890, GNorm = 1.8644, lr_0 = 1.6802e-04
Validation rmse = 0.128878
Epoch 44
Loss = 5.6636e-02, PNorm = 35.2927, GNorm = 2.3854, lr_0 = 1.6333e-04
Validation rmse = 0.125176
Epoch 45
Loss = 1.0328e-01, PNorm = 35.2974, GNorm = 2.1115, lr_0 = 1.5876e-04
Loss = 7.0245e-02, PNorm = 35.3024, GNorm = 1.2533, lr_0 = 1.5432e-04
Validation rmse = 0.126184
Epoch 46
Loss = 5.5446e-02, PNorm = 35.3069, GNorm = 2.8128, lr_0 = 1.5001e-04
Validation rmse = 0.126137
Epoch 47
Loss = 4.0828e-02, PNorm = 35.3119, GNorm = 0.4110, lr_0 = 1.4581e-04
Loss = 6.5880e-02, PNorm = 35.3158, GNorm = 1.0476, lr_0 = 1.4174e-04
Validation rmse = 0.123259
Epoch 48
Loss = 7.6829e-02, PNorm = 35.3204, GNorm = 1.3296, lr_0 = 1.3777e-04
Validation rmse = 0.125218
Epoch 49
Loss = 7.6995e-02, PNorm = 35.3247, GNorm = 0.9041, lr_0 = 1.3392e-04
Loss = 7.0295e-02, PNorm = 35.3290, GNorm = 0.4053, lr_0 = 1.3018e-04
Validation rmse = 0.125908
Epoch 50
Loss = 7.3841e-02, PNorm = 35.3328, GNorm = 1.7184, lr_0 = 1.2654e-04
Validation rmse = 0.122738
Epoch 51
Loss = 6.9655e-02, PNorm = 35.3369, GNorm = 0.5076, lr_0 = 1.2265e-04
Loss = 6.5019e-02, PNorm = 35.3404, GNorm = 0.6380, lr_0 = 1.1922e-04
Validation rmse = 0.124762
Epoch 52
Loss = 8.1255e-02, PNorm = 35.3441, GNorm = 1.5003, lr_0 = 1.1589e-04
Validation rmse = 0.124658
Epoch 53
Loss = 7.7594e-02, PNorm = 35.3469, GNorm = 0.5560, lr_0 = 1.1265e-04
Loss = 6.2149e-02, PNorm = 35.3499, GNorm = 0.5280, lr_0 = 1.0950e-04
Validation rmse = 0.123962
Epoch 54
Loss = 5.8629e-02, PNorm = 35.3530, GNorm = 2.0105, lr_0 = 1.0644e-04
Validation rmse = 0.124167
Epoch 55
Loss = 4.8153e-02, PNorm = 35.3558, GNorm = 0.6630, lr_0 = 1.0346e-04
Loss = 6.4075e-02, PNorm = 35.3591, GNorm = 1.4105, lr_0 = 1.0057e-04
Validation rmse = 0.127074
Epoch 56
Loss = 6.3268e-02, PNorm = 35.3618, GNorm = 0.6480, lr_0 = 1.0000e-04
Validation rmse = 0.125944
Epoch 57
Loss = 3.7309e-02, PNorm = 35.3648, GNorm = 0.9655, lr_0 = 1.0000e-04
Loss = 7.5474e-02, PNorm = 35.3680, GNorm = 0.4444, lr_0 = 1.0000e-04
Validation rmse = 0.125380
Epoch 58
Loss = 7.0613e-02, PNorm = 35.3701, GNorm = 2.1320, lr_0 = 1.0000e-04
Validation rmse = 0.124473
Epoch 59
Loss = 5.3229e-02, PNorm = 35.3737, GNorm = 0.6952, lr_0 = 1.0000e-04
Loss = 6.9769e-02, PNorm = 35.3766, GNorm = 0.6090, lr_0 = 1.0000e-04
Validation rmse = 0.131309
Model 0 best validation rmse = 0.122738 on epoch 50
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.174357
Ensemble test rmse = 0.174357
1-fold cross validation
	Seed 0 ==> test rmse = 0.174357
Overall test rmse = 0.174357 +/- 0.000000
Elapsed time = 0:00:28
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 927 | train size = 736 | val size = 186 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.2031e-01, PNorm = 34.0188, GNorm = 2.8685, lr_0 = 4.5357e-04
Validation rmse = 0.301165
Epoch 1
Loss = 6.6717e-01, PNorm = 34.0524, GNorm = 2.0310, lr_0 = 8.0714e-04
Validation rmse = 0.262517
Epoch 2
Loss = 5.9522e-01, PNorm = 34.1148, GNorm = 5.3167, lr_0 = 9.8872e-04
Loss = 4.1427e-01, PNorm = 34.1827, GNorm = 4.3643, lr_0 = 9.6108e-04
Validation rmse = 0.220876
Epoch 3
Loss = 3.4998e-01, PNorm = 34.2453, GNorm = 3.4282, lr_0 = 9.3421e-04
Validation rmse = 0.247979
Epoch 4
Loss = 3.4681e-01, PNorm = 34.3015, GNorm = 2.9137, lr_0 = 9.0552e-04
Loss = 3.6629e-01, PNorm = 34.3473, GNorm = 4.9278, lr_0 = 8.8020e-04
Validation rmse = 0.214273
Epoch 5
Loss = 2.5795e-01, PNorm = 34.4026, GNorm = 2.0723, lr_0 = 8.5559e-04
Validation rmse = 0.179865
Epoch 6
Loss = 1.8169e-01, PNorm = 34.4558, GNorm = 2.5920, lr_0 = 8.3167e-04
Loss = 2.2051e-01, PNorm = 34.4954, GNorm = 0.9693, lr_0 = 8.0842e-04
Validation rmse = 0.172213
Epoch 7
Loss = 2.2314e-01, PNorm = 34.5413, GNorm = 4.9392, lr_0 = 7.8581e-04
Validation rmse = 0.167158
Epoch 8
Loss = 1.5096e-01, PNorm = 34.5844, GNorm = 1.2539, lr_0 = 7.6168e-04
Loss = 1.6059e-01, PNorm = 34.6188, GNorm = 4.0038, lr_0 = 7.4039e-04
Validation rmse = 0.171459
Epoch 9
Loss = 1.6387e-01, PNorm = 34.6580, GNorm = 2.1231, lr_0 = 7.1969e-04
Validation rmse = 0.155652
Epoch 10
Loss = 1.3211e-01, PNorm = 34.6933, GNorm = 0.5882, lr_0 = 6.9956e-04
Loss = 1.2775e-01, PNorm = 34.7247, GNorm = 0.6680, lr_0 = 6.8001e-04
Validation rmse = 0.158404
Epoch 11
Loss = 1.3566e-01, PNorm = 34.7635, GNorm = 3.2804, lr_0 = 6.5912e-04
Validation rmse = 0.153074
Epoch 12
Loss = 1.0894e-01, PNorm = 34.7939, GNorm = 1.2774, lr_0 = 6.4069e-04
Loss = 1.2125e-01, PNorm = 34.8247, GNorm = 1.8041, lr_0 = 6.2278e-04
Validation rmse = 0.149018
Epoch 13
Loss = 9.3918e-02, PNorm = 34.8537, GNorm = 1.4662, lr_0 = 6.0537e-04
Validation rmse = 0.154671
Epoch 14
Loss = 9.8129e-02, PNorm = 34.8716, GNorm = 1.1375, lr_0 = 5.8844e-04
Loss = 1.0838e-01, PNorm = 34.8956, GNorm = 0.7538, lr_0 = 5.7199e-04
Loss = 7.9352e-02, PNorm = 34.8982, GNorm = 1.7992, lr_0 = 5.7037e-04
Validation rmse = 0.166836
Epoch 15
Loss = 1.1582e-01, PNorm = 34.9166, GNorm = 0.7262, lr_0 = 5.5442e-04
Validation rmse = 0.143614
Epoch 16
Loss = 1.0002e-01, PNorm = 34.9376, GNorm = 1.3167, lr_0 = 5.3892e-04
Loss = 9.2793e-02, PNorm = 34.9573, GNorm = 3.7809, lr_0 = 5.2386e-04
Validation rmse = 0.144246
Epoch 17
Loss = 9.4770e-02, PNorm = 34.9777, GNorm = 0.6861, lr_0 = 5.0921e-04
Validation rmse = 0.140116
Epoch 18
Loss = 7.8053e-02, PNorm = 34.9945, GNorm = 1.1063, lr_0 = 4.9357e-04
Validation rmse = 0.140099
Epoch 19
Loss = 5.5783e-02, PNorm = 35.0124, GNorm = 1.1799, lr_0 = 4.7977e-04
Loss = 8.3196e-02, PNorm = 35.0290, GNorm = 0.9505, lr_0 = 4.6636e-04
Validation rmse = 0.140681
Epoch 20
Loss = 8.1362e-02, PNorm = 35.0446, GNorm = 0.5988, lr_0 = 4.5332e-04
Validation rmse = 0.138093
Epoch 21
Loss = 4.9517e-02, PNorm = 35.0588, GNorm = 2.9241, lr_0 = 4.4064e-04
Loss = 7.6480e-02, PNorm = 35.0688, GNorm = 0.8208, lr_0 = 4.2832e-04
Validation rmse = 0.137396
Epoch 22
Loss = 6.4382e-02, PNorm = 35.0877, GNorm = 1.6600, lr_0 = 4.1517e-04
Validation rmse = 0.166768
Epoch 23
Loss = 1.0969e-01, PNorm = 35.1019, GNorm = 5.2744, lr_0 = 4.0356e-04
Loss = 1.0789e-01, PNorm = 35.1129, GNorm = 5.8949, lr_0 = 3.9228e-04
Validation rmse = 0.175700
Epoch 24
Loss = 1.1162e-01, PNorm = 35.1269, GNorm = 1.0647, lr_0 = 3.8131e-04
Validation rmse = 0.137291
Epoch 25
Loss = 7.5946e-02, PNorm = 35.1398, GNorm = 1.6428, lr_0 = 3.7065e-04
Loss = 7.6658e-02, PNorm = 35.1521, GNorm = 1.8493, lr_0 = 3.6029e-04
Validation rmse = 0.138463
Epoch 26
Loss = 6.7002e-02, PNorm = 35.1628, GNorm = 0.9751, lr_0 = 3.4922e-04
Validation rmse = 0.142175
Epoch 27
Loss = 7.3655e-02, PNorm = 35.1736, GNorm = 1.8982, lr_0 = 3.3946e-04
Loss = 7.3871e-02, PNorm = 35.1827, GNorm = 1.8096, lr_0 = 3.2997e-04
Validation rmse = 0.137265
Epoch 28
Loss = 6.6371e-02, PNorm = 35.1942, GNorm = 1.4840, lr_0 = 3.2074e-04
Validation rmse = 0.135688
Epoch 29
Loss = 6.1257e-02, PNorm = 35.2041, GNorm = 0.8704, lr_0 = 3.1089e-04
Loss = 7.1863e-02, PNorm = 35.2136, GNorm = 0.8819, lr_0 = 3.0220e-04
Validation rmse = 0.135790
Epoch 30
Loss = 7.0942e-02, PNorm = 35.2222, GNorm = 2.1807, lr_0 = 2.9375e-04
Validation rmse = 0.134963
Epoch 31
Loss = 7.4510e-02, PNorm = 35.2325, GNorm = 1.9284, lr_0 = 2.8554e-04
Loss = 6.7951e-02, PNorm = 35.2406, GNorm = 0.9633, lr_0 = 2.7756e-04
Validation rmse = 0.142976
Epoch 32
Loss = 7.5174e-02, PNorm = 35.2494, GNorm = 3.0472, lr_0 = 2.6980e-04
Validation rmse = 0.134336
Epoch 33
Loss = 6.1937e-02, PNorm = 35.2578, GNorm = 2.1067, lr_0 = 2.6151e-04
Loss = 6.6402e-02, PNorm = 35.2644, GNorm = 0.6864, lr_0 = 2.5420e-04
Validation rmse = 0.135245
Epoch 34
Loss = 5.9457e-02, PNorm = 35.2717, GNorm = 0.6784, lr_0 = 2.4709e-04
Validation rmse = 0.138012
Epoch 35
Loss = 7.1375e-02, PNorm = 35.2778, GNorm = 1.3435, lr_0 = 2.4018e-04
Validation rmse = 0.134048
Epoch 36
Loss = 4.0068e-02, PNorm = 35.2871, GNorm = 1.2788, lr_0 = 2.3281e-04
Loss = 5.8697e-02, PNorm = 35.2928, GNorm = 0.9115, lr_0 = 2.2630e-04
Validation rmse = 0.134274
Epoch 37
Loss = 6.4838e-02, PNorm = 35.3004, GNorm = 1.1043, lr_0 = 2.1997e-04
Validation rmse = 0.137687
Epoch 38
Loss = 4.8213e-02, PNorm = 35.3070, GNorm = 0.6415, lr_0 = 2.1382e-04
Loss = 6.0927e-02, PNorm = 35.3126, GNorm = 0.5080, lr_0 = 2.0784e-04
Validation rmse = 0.135899
Epoch 39
Loss = 5.6415e-02, PNorm = 35.3188, GNorm = 2.1810, lr_0 = 2.0203e-04
Validation rmse = 0.132518
Epoch 40
Loss = 5.9137e-02, PNorm = 35.3251, GNorm = 1.4208, lr_0 = 1.9583e-04
Loss = 5.8969e-02, PNorm = 35.3309, GNorm = 1.5090, lr_0 = 1.9035e-04
Validation rmse = 0.135315
Epoch 41
Loss = 5.6287e-02, PNorm = 35.3359, GNorm = 0.5926, lr_0 = 1.8503e-04
Validation rmse = 0.132903
Epoch 42
Loss = 5.0657e-02, PNorm = 35.3419, GNorm = 1.3325, lr_0 = 1.7986e-04
Loss = 5.9445e-02, PNorm = 35.3470, GNorm = 0.7483, lr_0 = 1.7483e-04
Validation rmse = 0.134387
Epoch 43
Loss = 5.5574e-02, PNorm = 35.3530, GNorm = 0.7812, lr_0 = 1.6946e-04
Validation rmse = 0.134118
Epoch 44
Loss = 8.6621e-02, PNorm = 35.3585, GNorm = 2.2499, lr_0 = 1.6472e-04
Loss = 5.4105e-02, PNorm = 35.3638, GNorm = 0.6978, lr_0 = 1.6012e-04
Validation rmse = 0.134209
Epoch 45
Loss = 5.2239e-02, PNorm = 35.3671, GNorm = 1.2490, lr_0 = 1.5564e-04
Validation rmse = 0.133936
Epoch 46
Loss = 5.9273e-02, PNorm = 35.3726, GNorm = 1.0409, lr_0 = 1.5129e-04
Loss = 5.8626e-02, PNorm = 35.3764, GNorm = 1.2998, lr_0 = 1.4706e-04
Validation rmse = 0.133168
Epoch 47
Loss = 6.1833e-02, PNorm = 35.3823, GNorm = 1.2112, lr_0 = 1.4254e-04
Validation rmse = 0.137261
Epoch 48
Loss = 5.0263e-02, PNorm = 35.3859, GNorm = 0.6662, lr_0 = 1.3856e-04
Loss = 6.2334e-02, PNorm = 35.3901, GNorm = 3.3645, lr_0 = 1.3468e-04
Validation rmse = 0.134175
Epoch 49
Loss = 5.9848e-02, PNorm = 35.3939, GNorm = 0.7158, lr_0 = 1.3092e-04
Validation rmse = 0.133384
Epoch 50
Loss = 4.7918e-02, PNorm = 35.3980, GNorm = 0.5657, lr_0 = 1.2726e-04
Loss = 5.9145e-02, PNorm = 35.4010, GNorm = 1.1046, lr_0 = 1.2370e-04
Loss = 3.4019e-02, PNorm = 35.4015, GNorm = 1.0875, lr_0 = 1.2335e-04
Validation rmse = 0.133664
Epoch 51
Loss = 5.4540e-02, PNorm = 35.4050, GNorm = 0.9226, lr_0 = 1.1990e-04
Validation rmse = 0.132829
Epoch 52
Loss = 4.4916e-02, PNorm = 35.4081, GNorm = 0.5698, lr_0 = 1.1655e-04
Loss = 5.9118e-02, PNorm = 35.4121, GNorm = 0.7400, lr_0 = 1.1329e-04
Validation rmse = 0.137451
Epoch 53
Loss = 5.6267e-02, PNorm = 35.4150, GNorm = 1.1841, lr_0 = 1.1012e-04
Validation rmse = 0.132890
Epoch 54
Loss = 6.0169e-02, PNorm = 35.4185, GNorm = 1.3242, lr_0 = 1.0674e-04
Validation rmse = 0.134215
Epoch 55
Loss = 5.0771e-02, PNorm = 35.4218, GNorm = 0.5794, lr_0 = 1.0376e-04
Loss = 5.2517e-02, PNorm = 35.4245, GNorm = 1.6219, lr_0 = 1.0085e-04
Validation rmse = 0.133386
Epoch 56
Loss = 4.5739e-02, PNorm = 35.4275, GNorm = 0.7037, lr_0 = 1.0000e-04
Validation rmse = 0.132728
Epoch 57
Loss = 3.7119e-02, PNorm = 35.4303, GNorm = 1.4514, lr_0 = 1.0000e-04
Loss = 5.2225e-02, PNorm = 35.4333, GNorm = 0.7396, lr_0 = 1.0000e-04
Validation rmse = 0.133461
Epoch 58
Loss = 5.0305e-02, PNorm = 35.4365, GNorm = 1.0173, lr_0 = 1.0000e-04
Validation rmse = 0.133449
Epoch 59
Loss = 6.0862e-02, PNorm = 35.4390, GNorm = 1.0062, lr_0 = 1.0000e-04
Loss = 5.3643e-02, PNorm = 35.4417, GNorm = 0.7073, lr_0 = 1.0000e-04
Validation rmse = 0.132331
Model 0 best validation rmse = 0.132331 on epoch 59
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.200385
Ensemble test rmse = 0.200385
1-fold cross validation
	Seed 0 ==> test rmse = 0.200385
Overall test rmse = 0.200385 +/- 0.000000
Elapsed time = 0:00:26
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 917 | train size = 729 | val size = 183 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1292e-01, PNorm = 34.0175, GNorm = 2.6694, lr_0 = 4.5357e-04
Validation rmse = 0.326258
Epoch 1
Loss = 8.0548e-01, PNorm = 34.0518, GNorm = 8.1023, lr_0 = 8.0714e-04
Validation rmse = 0.247278
Epoch 2
Loss = 5.0318e-01, PNorm = 34.1100, GNorm = 3.5445, lr_0 = 9.8872e-04
Loss = 4.7929e-01, PNorm = 34.1725, GNorm = 4.5196, lr_0 = 9.6108e-04
Validation rmse = 0.214557
Epoch 3
Loss = 3.6172e-01, PNorm = 34.2364, GNorm = 4.2814, lr_0 = 9.3156e-04
Validation rmse = 0.194442
Epoch 4
Loss = 3.1954e-01, PNorm = 34.2952, GNorm = 1.7853, lr_0 = 9.0552e-04
Loss = 2.8718e-01, PNorm = 34.3583, GNorm = 2.2775, lr_0 = 8.8020e-04
Validation rmse = 0.183989
Epoch 5
Loss = 2.6774e-01, PNorm = 34.4145, GNorm = 3.2485, lr_0 = 8.5317e-04
Validation rmse = 0.183764
Epoch 6
Loss = 2.5991e-01, PNorm = 34.4584, GNorm = 6.2716, lr_0 = 8.2931e-04
Loss = 2.1896e-01, PNorm = 34.5032, GNorm = 1.5499, lr_0 = 8.0613e-04
Validation rmse = 0.204940
Epoch 7
Loss = 1.8327e-01, PNorm = 34.5437, GNorm = 1.4311, lr_0 = 7.8359e-04
Validation rmse = 0.171333
Epoch 8
Loss = 1.6093e-01, PNorm = 34.5845, GNorm = 2.1449, lr_0 = 7.5952e-04
Loss = 1.9262e-01, PNorm = 34.6155, GNorm = 10.0573, lr_0 = 7.3829e-04
Validation rmse = 0.166653
Epoch 9
Loss = 1.7993e-01, PNorm = 34.6487, GNorm = 5.0526, lr_0 = 7.1765e-04
Validation rmse = 0.158872
Epoch 10
Loss = 1.4096e-01, PNorm = 34.6770, GNorm = 2.1591, lr_0 = 6.9561e-04
Loss = 1.3076e-01, PNorm = 34.7078, GNorm = 0.4424, lr_0 = 6.7616e-04
Validation rmse = 0.167178
Epoch 11
Loss = 1.1495e-01, PNorm = 34.7354, GNorm = 1.6491, lr_0 = 6.5726e-04
Validation rmse = 0.167727
Epoch 12
Loss = 1.3308e-01, PNorm = 34.7627, GNorm = 1.8887, lr_0 = 6.3707e-04
Validation rmse = 0.179894
Epoch 13
Loss = 1.1091e-01, PNorm = 34.7928, GNorm = 4.9834, lr_0 = 6.1926e-04
Loss = 1.2550e-01, PNorm = 34.8159, GNorm = 2.9128, lr_0 = 6.0194e-04
Validation rmse = 0.152492
Epoch 14
Loss = 1.0664e-01, PNorm = 34.8392, GNorm = 1.3469, lr_0 = 5.8512e-04
Validation rmse = 0.147240
Epoch 15
Loss = 1.1366e-01, PNorm = 34.8636, GNorm = 0.6495, lr_0 = 5.6715e-04
Loss = 1.0131e-01, PNorm = 34.8854, GNorm = 0.9620, lr_0 = 5.5129e-04
Validation rmse = 0.148916
Epoch 16
Loss = 1.0518e-01, PNorm = 34.9058, GNorm = 5.7419, lr_0 = 5.3588e-04
Validation rmse = 0.153500
Epoch 17
Loss = 1.0040e-01, PNorm = 34.9275, GNorm = 3.9200, lr_0 = 5.1942e-04
Loss = 1.2217e-01, PNorm = 34.9452, GNorm = 3.8313, lr_0 = 5.0490e-04
Validation rmse = 0.165443
Epoch 18
Loss = 1.3031e-01, PNorm = 34.9665, GNorm = 1.0498, lr_0 = 4.9078e-04
Validation rmse = 0.157963
Epoch 19
Loss = 1.2767e-01, PNorm = 34.9839, GNorm = 0.7621, lr_0 = 4.7706e-04
Loss = 9.1638e-02, PNorm = 34.9996, GNorm = 1.7954, lr_0 = 4.6372e-04
Validation rmse = 0.146784
Epoch 20
Loss = 8.4898e-02, PNorm = 35.0101, GNorm = 1.0031, lr_0 = 4.4948e-04
Validation rmse = 0.144159
Epoch 21
Loss = 8.8776e-02, PNorm = 35.0241, GNorm = 0.6260, lr_0 = 4.3691e-04
Loss = 7.9029e-02, PNorm = 35.0357, GNorm = 0.9385, lr_0 = 4.2470e-04
Loss = 4.2003e-02, PNorm = 35.0368, GNorm = 1.1739, lr_0 = 4.2349e-04
Validation rmse = 0.145632
Epoch 22
Loss = 8.5581e-02, PNorm = 35.0488, GNorm = 5.2388, lr_0 = 4.1165e-04
Validation rmse = 0.145697
Epoch 23
Loss = 6.5230e-02, PNorm = 35.0587, GNorm = 2.1715, lr_0 = 4.0014e-04
Validation rmse = 0.144476
Epoch 24
Loss = 5.3340e-02, PNorm = 35.0696, GNorm = 2.0569, lr_0 = 3.8786e-04
Loss = 7.9736e-02, PNorm = 35.0816, GNorm = 2.0308, lr_0 = 3.7701e-04
Validation rmse = 0.144143
Epoch 25
Loss = 9.3031e-02, PNorm = 35.0922, GNorm = 2.1829, lr_0 = 3.6647e-04
Validation rmse = 0.148309
Epoch 26
Loss = 5.7335e-02, PNorm = 35.1030, GNorm = 1.2054, lr_0 = 3.5622e-04
Loss = 7.2001e-02, PNorm = 35.1120, GNorm = 0.3969, lr_0 = 3.4627e-04
Validation rmse = 0.143031
Epoch 27
Loss = 6.6784e-02, PNorm = 35.1218, GNorm = 0.6719, lr_0 = 3.3563e-04
Validation rmse = 0.142633
Epoch 28
Loss = 6.0929e-02, PNorm = 35.1323, GNorm = 1.8812, lr_0 = 3.2625e-04
Loss = 7.3025e-02, PNorm = 35.1420, GNorm = 0.9901, lr_0 = 3.1713e-04
Validation rmse = 0.142646
Epoch 29
Loss = 8.5363e-02, PNorm = 35.1515, GNorm = 6.5446, lr_0 = 3.0739e-04
Validation rmse = 0.143432
Epoch 30
Loss = 8.9873e-02, PNorm = 35.1609, GNorm = 2.7063, lr_0 = 2.9879e-04
Loss = 6.1824e-02, PNorm = 35.1695, GNorm = 1.6872, lr_0 = 2.9044e-04
Validation rmse = 0.141830
Epoch 31
Loss = 8.5703e-02, PNorm = 35.1800, GNorm = 1.3760, lr_0 = 2.8152e-04
Validation rmse = 0.161152
Epoch 32
Loss = 7.4661e-02, PNorm = 35.1859, GNorm = 0.8413, lr_0 = 2.7365e-04
Loss = 7.8738e-02, PNorm = 35.1936, GNorm = 3.6106, lr_0 = 2.6600e-04
Validation rmse = 0.142149
Epoch 33
Loss = 7.9485e-02, PNorm = 35.2029, GNorm = 2.1744, lr_0 = 2.5856e-04
Validation rmse = 0.141592
Epoch 34
Loss = 7.1257e-02, PNorm = 35.2090, GNorm = 2.0119, lr_0 = 2.5062e-04
Loss = 6.8902e-02, PNorm = 35.2151, GNorm = 0.7919, lr_0 = 2.4361e-04
Validation rmse = 0.153030
Epoch 35
Loss = 7.3647e-02, PNorm = 35.2217, GNorm = 2.0823, lr_0 = 2.3680e-04
Validation rmse = 0.141174
Epoch 36
Loss = 7.6063e-02, PNorm = 35.2285, GNorm = 2.0427, lr_0 = 2.2953e-04
Validation rmse = 0.141703
Epoch 37
Loss = 3.4841e-02, PNorm = 35.2348, GNorm = 1.5258, lr_0 = 2.2311e-04
Loss = 6.2877e-02, PNorm = 35.2403, GNorm = 2.2806, lr_0 = 2.1687e-04
Validation rmse = 0.141836
Epoch 38
Loss = 6.3346e-02, PNorm = 35.2458, GNorm = 0.9655, lr_0 = 2.1081e-04
Validation rmse = 0.142391
Epoch 39
Loss = 3.6944e-02, PNorm = 35.2513, GNorm = 0.4371, lr_0 = 2.0434e-04
Loss = 7.4573e-02, PNorm = 35.2572, GNorm = 2.5059, lr_0 = 1.9862e-04
Validation rmse = 0.141000
Epoch 40
Loss = 6.3701e-02, PNorm = 35.2623, GNorm = 3.2575, lr_0 = 1.9307e-04
Validation rmse = 0.140768
Epoch 41
Loss = 7.3661e-02, PNorm = 35.2676, GNorm = 2.3304, lr_0 = 1.8714e-04
Loss = 5.9396e-02, PNorm = 35.2711, GNorm = 2.0515, lr_0 = 1.8191e-04
Validation rmse = 0.141374
Epoch 42
Loss = 6.2207e-02, PNorm = 35.2765, GNorm = 0.8564, lr_0 = 1.7682e-04
Validation rmse = 0.142783
Epoch 43
Loss = 6.9388e-02, PNorm = 35.2824, GNorm = 0.8756, lr_0 = 1.7139e-04
Loss = 5.6658e-02, PNorm = 35.2864, GNorm = 1.4631, lr_0 = 1.6660e-04
Validation rmse = 0.142627
Epoch 44
Loss = 6.7031e-02, PNorm = 35.2920, GNorm = 1.1987, lr_0 = 1.6194e-04
Validation rmse = 0.141484
Epoch 45
Loss = 4.6172e-02, PNorm = 35.2961, GNorm = 0.4845, lr_0 = 1.5741e-04
Loss = 6.8865e-02, PNorm = 35.2993, GNorm = 0.4570, lr_0 = 1.5301e-04
Loss = 5.1120e-02, PNorm = 35.2998, GNorm = 1.1024, lr_0 = 1.5258e-04
Validation rmse = 0.146603
Epoch 46
Loss = 6.5019e-02, PNorm = 35.3045, GNorm = 3.7516, lr_0 = 1.4831e-04
Validation rmse = 0.140209
Epoch 47
Loss = 4.8087e-02, PNorm = 35.3082, GNorm = 2.3102, lr_0 = 1.4417e-04
Validation rmse = 0.145877
Epoch 48
Loss = 5.7872e-02, PNorm = 35.3116, GNorm = 1.6800, lr_0 = 1.3974e-04
Loss = 6.4047e-02, PNorm = 35.3163, GNorm = 0.6910, lr_0 = 1.3583e-04
Validation rmse = 0.142974
Epoch 49
Loss = 7.0073e-02, PNorm = 35.3195, GNorm = 1.0997, lr_0 = 1.3204e-04
Validation rmse = 0.144155
Epoch 50
Loss = 7.0067e-02, PNorm = 35.3236, GNorm = 2.0679, lr_0 = 1.2834e-04
Loss = 6.0254e-02, PNorm = 35.3276, GNorm = 1.8647, lr_0 = 1.2476e-04
Validation rmse = 0.140094
Epoch 51
Loss = 6.1857e-02, PNorm = 35.3296, GNorm = 0.7451, lr_0 = 1.2092e-04
Validation rmse = 0.143016
Epoch 52
Loss = 5.1896e-02, PNorm = 35.3334, GNorm = 1.0638, lr_0 = 1.1754e-04
Loss = 6.5259e-02, PNorm = 35.3363, GNorm = 2.2891, lr_0 = 1.1426e-04
Validation rmse = 0.142688
Epoch 53
Loss = 6.6944e-02, PNorm = 35.3393, GNorm = 1.0381, lr_0 = 1.1075e-04
Validation rmse = 0.143560
Epoch 54
Loss = 5.0694e-02, PNorm = 35.3424, GNorm = 0.8634, lr_0 = 1.0765e-04
Loss = 6.1667e-02, PNorm = 35.3449, GNorm = 1.6660, lr_0 = 1.0464e-04
Validation rmse = 0.140042
Epoch 55
Loss = 5.8851e-02, PNorm = 35.3483, GNorm = 0.8670, lr_0 = 1.0143e-04
Validation rmse = 0.140244
Epoch 56
Loss = 4.9457e-02, PNorm = 35.3508, GNorm = 0.7412, lr_0 = 1.0000e-04
Loss = 6.0242e-02, PNorm = 35.3533, GNorm = 0.9540, lr_0 = 1.0000e-04
Validation rmse = 0.140160
Epoch 57
Loss = 5.4936e-02, PNorm = 35.3561, GNorm = 1.2874, lr_0 = 1.0000e-04
Validation rmse = 0.141086
Epoch 58
Loss = 5.5580e-02, PNorm = 35.3590, GNorm = 2.9987, lr_0 = 1.0000e-04
Loss = 6.4035e-02, PNorm = 35.3616, GNorm = 2.7291, lr_0 = 1.0000e-04
Validation rmse = 0.140086
Epoch 59
Loss = 6.2822e-02, PNorm = 35.3640, GNorm = 1.9698, lr_0 = 1.0000e-04
Validation rmse = 0.149004
Model 0 best validation rmse = 0.140042 on epoch 54
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.180667
Ensemble test rmse = 0.180667
1-fold cross validation
	Seed 0 ==> test rmse = 0.180667
Overall test rmse = 0.180667 +/- 0.000000
Elapsed time = 0:00:27
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 907 | train size = 721 | val size = 181 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.5672e-01, PNorm = 34.0177, GNorm = 3.6284, lr_0 = 4.5357e-04
Validation rmse = 0.283403
Epoch 1
Loss = 5.7403e-01, PNorm = 34.0580, GNorm = 3.2366, lr_0 = 8.0714e-04
Validation rmse = 0.252766
Epoch 2
Loss = 4.3010e-01, PNorm = 34.1142, GNorm = 0.6701, lr_0 = 9.8592e-04
Loss = 4.8892e-01, PNorm = 34.1742, GNorm = 6.2100, lr_0 = 9.5836e-04
Validation rmse = 0.229826
Epoch 3
Loss = 4.6572e-01, PNorm = 34.2344, GNorm = 2.4838, lr_0 = 9.3156e-04
Validation rmse = 0.222134
Epoch 4
Loss = 4.9217e-01, PNorm = 34.3020, GNorm = 5.8150, lr_0 = 9.0295e-04
Loss = 2.7601e-01, PNorm = 34.3568, GNorm = 2.6276, lr_0 = 8.7771e-04
Validation rmse = 0.179835
Epoch 5
Loss = 2.2018e-01, PNorm = 34.4140, GNorm = 3.1527, lr_0 = 8.5317e-04
Validation rmse = 0.168559
Epoch 6
Loss = 2.2032e-01, PNorm = 34.4749, GNorm = 2.8167, lr_0 = 8.2697e-04
Loss = 2.0698e-01, PNorm = 34.5171, GNorm = 2.4067, lr_0 = 8.0385e-04
Loss = 1.1254e-01, PNorm = 34.5216, GNorm = 3.6076, lr_0 = 8.0157e-04
Validation rmse = 0.166607
Epoch 7
Loss = 1.9801e-01, PNorm = 34.5677, GNorm = 2.9164, lr_0 = 7.7916e-04
Validation rmse = 0.151075
Epoch 8
Loss = 1.8499e-01, PNorm = 34.6055, GNorm = 8.3944, lr_0 = 7.5737e-04
Validation rmse = 0.146642
Epoch 9
Loss = 1.3721e-01, PNorm = 34.6489, GNorm = 1.8216, lr_0 = 7.3411e-04
Loss = 1.4529e-01, PNorm = 34.6819, GNorm = 1.3739, lr_0 = 7.1359e-04
Validation rmse = 0.143631
Epoch 10
Loss = 1.4035e-01, PNorm = 34.7212, GNorm = 4.3291, lr_0 = 6.9364e-04
Validation rmse = 0.146932
Epoch 11
Loss = 1.2696e-01, PNorm = 34.7523, GNorm = 2.8986, lr_0 = 6.7234e-04
Loss = 1.3813e-01, PNorm = 34.7826, GNorm = 1.5462, lr_0 = 6.5354e-04
Validation rmse = 0.136344
Epoch 12
Loss = 9.6487e-02, PNorm = 34.8057, GNorm = 5.7756, lr_0 = 6.3527e-04
Validation rmse = 0.142103
Epoch 13
Loss = 1.2080e-01, PNorm = 34.8369, GNorm = 2.9060, lr_0 = 6.1576e-04
Loss = 1.4106e-01, PNorm = 34.8606, GNorm = 0.6309, lr_0 = 5.9854e-04
Validation rmse = 0.135950
Epoch 14
Loss = 1.1098e-01, PNorm = 34.8828, GNorm = 1.0388, lr_0 = 5.8016e-04
Validation rmse = 0.126743
Epoch 15
Loss = 8.1788e-02, PNorm = 34.9085, GNorm = 1.2481, lr_0 = 5.6394e-04
Loss = 1.1943e-01, PNorm = 34.9269, GNorm = 4.6782, lr_0 = 5.4817e-04
Loss = 1.5459e-01, PNorm = 34.9303, GNorm = 7.0200, lr_0 = 5.4662e-04
Validation rmse = 0.125457
Epoch 16
Loss = 1.5472e-01, PNorm = 34.9477, GNorm = 8.4371, lr_0 = 5.3134e-04
Validation rmse = 0.138878
Epoch 17
Loss = 1.2330e-01, PNorm = 34.9671, GNorm = 3.4868, lr_0 = 5.1648e-04
Validation rmse = 0.125988
Epoch 18
Loss = 6.7875e-02, PNorm = 34.9900, GNorm = 0.9149, lr_0 = 5.0062e-04
Loss = 8.7916e-02, PNorm = 35.0066, GNorm = 1.9739, lr_0 = 4.8662e-04
Validation rmse = 0.129984
Epoch 19
Loss = 9.6820e-02, PNorm = 35.0230, GNorm = 0.7050, lr_0 = 4.7168e-04
Validation rmse = 0.119977
Epoch 20
Loss = 5.1879e-02, PNorm = 35.0370, GNorm = 1.2481, lr_0 = 4.5849e-04
Loss = 1.0204e-01, PNorm = 35.0500, GNorm = 1.1964, lr_0 = 4.4567e-04
Validation rmse = 0.119413
Epoch 21
Loss = 8.9194e-02, PNorm = 35.0672, GNorm = 1.8753, lr_0 = 4.3198e-04
Validation rmse = 0.125055
Epoch 22
Loss = 1.0519e-01, PNorm = 35.0827, GNorm = 2.1961, lr_0 = 4.1991e-04
Loss = 7.5690e-02, PNorm = 35.0940, GNorm = 2.0970, lr_0 = 4.0817e-04
Validation rmse = 0.119511
Epoch 23
Loss = 9.8576e-02, PNorm = 35.1082, GNorm = 2.2543, lr_0 = 3.9563e-04
Validation rmse = 0.117903
Epoch 24
Loss = 1.0702e-01, PNorm = 35.1205, GNorm = 1.1189, lr_0 = 3.8457e-04
Loss = 7.5483e-02, PNorm = 35.1343, GNorm = 0.5277, lr_0 = 3.7382e-04
Loss = 5.5234e-02, PNorm = 35.1354, GNorm = 0.6177, lr_0 = 3.7276e-04
Validation rmse = 0.123091
Epoch 25
Loss = 8.6713e-02, PNorm = 35.1437, GNorm = 0.8073, lr_0 = 3.6234e-04
Validation rmse = 0.118674
Epoch 26
Loss = 9.6347e-02, PNorm = 35.1555, GNorm = 2.4352, lr_0 = 3.5121e-04
Validation rmse = 0.121318
Epoch 27
Loss = 6.6657e-02, PNorm = 35.1668, GNorm = 4.6531, lr_0 = 3.4139e-04
Loss = 8.1819e-02, PNorm = 35.1751, GNorm = 1.8116, lr_0 = 3.3185e-04
Validation rmse = 0.122569
Epoch 28
Loss = 8.2833e-02, PNorm = 35.1881, GNorm = 2.3089, lr_0 = 3.2165e-04
Validation rmse = 0.125494
Epoch 29
Loss = 5.6557e-02, PNorm = 35.1992, GNorm = 1.8429, lr_0 = 3.1266e-04
Loss = 8.5258e-02, PNorm = 35.2108, GNorm = 2.3900, lr_0 = 3.0392e-04
Validation rmse = 0.117924
Epoch 30
Loss = 7.2553e-02, PNorm = 35.2204, GNorm = 1.5577, lr_0 = 2.9459e-04
Validation rmse = 0.116113
Epoch 31
Loss = 6.8058e-02, PNorm = 35.2296, GNorm = 0.7010, lr_0 = 2.8635e-04
Loss = 8.0974e-02, PNorm = 35.2381, GNorm = 1.7519, lr_0 = 2.7834e-04
Validation rmse = 0.116560
Epoch 32
Loss = 6.9467e-02, PNorm = 35.2464, GNorm = 0.4697, lr_0 = 2.6980e-04
Validation rmse = 0.119333
Epoch 33
Loss = 6.9745e-02, PNorm = 35.2562, GNorm = 0.6289, lr_0 = 2.6151e-04
Loss = 7.7625e-02, PNorm = 35.2648, GNorm = 3.7584, lr_0 = 2.5420e-04
Validation rmse = 0.116193
Epoch 34
Loss = 7.8801e-02, PNorm = 35.2733, GNorm = 2.5628, lr_0 = 2.4709e-04
Validation rmse = 0.116210
Epoch 35
Loss = 7.8568e-02, PNorm = 35.2807, GNorm = 2.9221, lr_0 = 2.3950e-04
Validation rmse = 0.114581
Epoch 36
Loss = 6.0041e-02, PNorm = 35.2879, GNorm = 1.0411, lr_0 = 2.3281e-04
Loss = 6.8978e-02, PNorm = 35.2945, GNorm = 0.5514, lr_0 = 2.2630e-04
Validation rmse = 0.116470
Epoch 37
Loss = 6.5306e-02, PNorm = 35.3033, GNorm = 1.5181, lr_0 = 2.1935e-04
Validation rmse = 0.114486
Epoch 38
Loss = 6.3911e-02, PNorm = 35.3094, GNorm = 2.2521, lr_0 = 2.1261e-04
Loss = 6.9828e-02, PNorm = 35.3156, GNorm = 0.9035, lr_0 = 2.0667e-04
Validation rmse = 0.114855
Epoch 39
Loss = 6.2726e-02, PNorm = 35.3211, GNorm = 0.7139, lr_0 = 2.0089e-04
Validation rmse = 0.113759
Epoch 40
Loss = 5.2573e-02, PNorm = 35.3286, GNorm = 0.8471, lr_0 = 1.9472e-04
Loss = 7.3386e-02, PNorm = 35.3351, GNorm = 0.7039, lr_0 = 1.8928e-04
Validation rmse = 0.122932
Epoch 41
Loss = 6.8393e-02, PNorm = 35.3402, GNorm = 0.7485, lr_0 = 1.8398e-04
Validation rmse = 0.114877
Epoch 42
Loss = 6.4641e-02, PNorm = 35.3470, GNorm = 1.2682, lr_0 = 1.7833e-04
Loss = 6.6064e-02, PNorm = 35.3534, GNorm = 1.2149, lr_0 = 1.7335e-04
Validation rmse = 0.115797
Epoch 43
Loss = 6.8982e-02, PNorm = 35.3570, GNorm = 1.0207, lr_0 = 1.6850e-04
Validation rmse = 0.114977
Epoch 44
Loss = 5.8552e-02, PNorm = 35.3628, GNorm = 0.9915, lr_0 = 1.6333e-04
Validation rmse = 0.115626
Epoch 45
Loss = 6.7869e-02, PNorm = 35.3683, GNorm = 1.5740, lr_0 = 1.5831e-04
Loss = 6.2878e-02, PNorm = 35.3737, GNorm = 2.0177, lr_0 = 1.5388e-04
Validation rmse = 0.113921
Epoch 46
Loss = 5.2050e-02, PNorm = 35.3767, GNorm = 0.9088, lr_0 = 1.4958e-04
Validation rmse = 0.114999
Epoch 47
Loss = 7.7475e-02, PNorm = 35.3818, GNorm = 1.2652, lr_0 = 1.4499e-04
Loss = 6.5981e-02, PNorm = 35.3872, GNorm = 2.9661, lr_0 = 1.4093e-04
Validation rmse = 0.114008
Epoch 48
Loss = 7.1793e-02, PNorm = 35.3906, GNorm = 0.7943, lr_0 = 1.3699e-04
Validation rmse = 0.118820
Epoch 49
Loss = 6.2387e-02, PNorm = 35.3951, GNorm = 0.7679, lr_0 = 1.3279e-04
Loss = 6.6047e-02, PNorm = 35.3981, GNorm = 1.9880, lr_0 = 1.2907e-04
Validation rmse = 0.114874
Epoch 50
Loss = 5.2617e-02, PNorm = 35.4026, GNorm = 0.3538, lr_0 = 1.2546e-04
Validation rmse = 0.115437
Epoch 51
Loss = 6.7263e-02, PNorm = 35.4066, GNorm = 0.6274, lr_0 = 1.2161e-04
Validation rmse = 0.115203
Epoch 52
Loss = 7.6560e-02, PNorm = 35.4108, GNorm = 2.3875, lr_0 = 1.1788e-04
Loss = 7.1275e-02, PNorm = 35.4136, GNorm = 1.0221, lr_0 = 1.1458e-04
Validation rmse = 0.116345
Epoch 53
Loss = 5.2810e-02, PNorm = 35.4169, GNorm = 0.9266, lr_0 = 1.1138e-04
Validation rmse = 0.115467
Epoch 54
Loss = 7.9481e-02, PNorm = 35.4211, GNorm = 0.6834, lr_0 = 1.0796e-04
Loss = 6.1223e-02, PNorm = 35.4249, GNorm = 0.3951, lr_0 = 1.0494e-04
Validation rmse = 0.113740
Epoch 55
Loss = 6.5257e-02, PNorm = 35.4273, GNorm = 0.6116, lr_0 = 1.0200e-04
Validation rmse = 0.115599
Epoch 56
Loss = 4.8824e-02, PNorm = 35.4304, GNorm = 1.3828, lr_0 = 1.0000e-04
Loss = 6.7319e-02, PNorm = 35.4333, GNorm = 0.6069, lr_0 = 1.0000e-04
Validation rmse = 0.114708
Epoch 57
Loss = 5.6306e-02, PNorm = 35.4373, GNorm = 1.5297, lr_0 = 1.0000e-04
Validation rmse = 0.114404
Epoch 58
Loss = 4.8290e-02, PNorm = 35.4399, GNorm = 0.3220, lr_0 = 1.0000e-04
Loss = 6.7364e-02, PNorm = 35.4427, GNorm = 0.7929, lr_0 = 1.0000e-04
Loss = 3.5336e-02, PNorm = 35.4431, GNorm = 0.7548, lr_0 = 1.0000e-04
Validation rmse = 0.114484
Epoch 59
Loss = 6.2955e-02, PNorm = 35.4460, GNorm = 1.0382, lr_0 = 1.0000e-04
Validation rmse = 0.114688
Model 0 best validation rmse = 0.113740 on epoch 54
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.160083
Ensemble test rmse = 0.160083
1-fold cross validation
	Seed 0 ==> test rmse = 0.160083
Overall test rmse = 0.160083 +/- 0.000000
Elapsed time = 0:00:27
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 897 | train size = 713 | val size = 179 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.7838e-01, PNorm = 34.0204, GNorm = 4.7674, lr_0 = 4.5357e-04
Validation rmse = 0.278409
Epoch 1
Loss = 6.1946e-01, PNorm = 34.0578, GNorm = 6.5124, lr_0 = 8.0714e-04
Validation rmse = 0.264474
Epoch 2
Loss = 5.7407e-01, PNorm = 34.1203, GNorm = 2.6297, lr_0 = 9.8592e-04
Loss = 4.1631e-01, PNorm = 34.1906, GNorm = 6.7432, lr_0 = 9.5836e-04
Validation rmse = 0.227077
Epoch 3
Loss = 3.3007e-01, PNorm = 34.2564, GNorm = 0.9126, lr_0 = 9.2892e-04
Validation rmse = 0.218097
Epoch 4
Loss = 4.4849e-01, PNorm = 34.3184, GNorm = 10.2700, lr_0 = 9.0295e-04
Loss = 3.5051e-01, PNorm = 34.3693, GNorm = 6.3447, lr_0 = 8.7771e-04
Validation rmse = 0.204822
Epoch 5
Loss = 2.5425e-01, PNorm = 34.4237, GNorm = 8.3665, lr_0 = 8.5075e-04
Validation rmse = 0.196865
Epoch 6
Loss = 2.2711e-01, PNorm = 34.4771, GNorm = 6.0042, lr_0 = 8.2462e-04
Validation rmse = 0.175957
Epoch 7
Loss = 1.2999e-01, PNorm = 34.5231, GNorm = 3.3296, lr_0 = 7.9930e-04
Loss = 1.7693e-01, PNorm = 34.5563, GNorm = 0.9665, lr_0 = 7.7695e-04
Validation rmse = 0.166932
Epoch 8
Loss = 1.7046e-01, PNorm = 34.5896, GNorm = 1.1933, lr_0 = 7.5523e-04
Validation rmse = 0.161423
Epoch 9
Loss = 9.9742e-02, PNorm = 34.6294, GNorm = 0.5899, lr_0 = 7.3204e-04
Loss = 1.4393e-01, PNorm = 34.6606, GNorm = 1.2306, lr_0 = 7.1157e-04
Validation rmse = 0.157632
Epoch 10
Loss = 1.2527e-01, PNorm = 34.6942, GNorm = 1.4446, lr_0 = 6.8972e-04
Validation rmse = 0.166385
Epoch 11
Loss = 1.5728e-01, PNorm = 34.7237, GNorm = 2.0253, lr_0 = 6.6853e-04
Loss = 1.1944e-01, PNorm = 34.7506, GNorm = 0.8864, lr_0 = 6.4984e-04
Validation rmse = 0.153902
Epoch 12
Loss = 1.1304e-01, PNorm = 34.7717, GNorm = 3.9193, lr_0 = 6.3167e-04
Validation rmse = 0.141726
Epoch 13
Loss = 9.8079e-02, PNorm = 34.7975, GNorm = 2.6507, lr_0 = 6.1227e-04
Validation rmse = 0.140589
Epoch 14
Loss = 1.2333e-01, PNorm = 34.8187, GNorm = 1.7746, lr_0 = 5.9347e-04
Loss = 1.0055e-01, PNorm = 34.8407, GNorm = 0.5698, lr_0 = 5.7688e-04
Validation rmse = 0.178250
Epoch 15
Loss = 1.4639e-01, PNorm = 34.8540, GNorm = 3.9477, lr_0 = 5.5916e-04
Validation rmse = 0.161596
Epoch 16
Loss = 1.1776e-01, PNorm = 34.8737, GNorm = 4.0034, lr_0 = 5.4353e-04
Loss = 9.6249e-02, PNorm = 34.8906, GNorm = 1.2829, lr_0 = 5.2833e-04
Validation rmse = 0.144906
Epoch 17
Loss = 9.3557e-02, PNorm = 34.9097, GNorm = 1.6214, lr_0 = 5.1211e-04
Validation rmse = 0.136430
Epoch 18
Loss = 1.0912e-01, PNorm = 34.9252, GNorm = 3.8187, lr_0 = 4.9638e-04
Loss = 8.5556e-02, PNorm = 34.9407, GNorm = 0.9664, lr_0 = 4.8250e-04
Loss = 1.3487e-01, PNorm = 34.9415, GNorm = 4.6142, lr_0 = 4.8113e-04
Validation rmse = 0.137684
Epoch 19
Loss = 8.3220e-02, PNorm = 34.9534, GNorm = 3.8736, lr_0 = 4.6768e-04
Validation rmse = 0.136141
Epoch 20
Loss = 6.1761e-02, PNorm = 34.9684, GNorm = 1.4530, lr_0 = 4.5461e-04
Validation rmse = 0.144450
Epoch 21
Loss = 9.3506e-02, PNorm = 34.9840, GNorm = 3.0951, lr_0 = 4.4064e-04
Loss = 7.8380e-02, PNorm = 34.9945, GNorm = 0.7276, lr_0 = 4.2832e-04
Validation rmse = 0.143977
Epoch 22
Loss = 9.1882e-02, PNorm = 35.0074, GNorm = 2.1855, lr_0 = 4.1517e-04
Validation rmse = 0.137243
Epoch 23
Loss = 6.8329e-02, PNorm = 35.0186, GNorm = 1.5636, lr_0 = 4.0242e-04
Loss = 7.7349e-02, PNorm = 35.0298, GNorm = 1.9520, lr_0 = 3.9117e-04
Validation rmse = 0.133971
Epoch 24
Loss = 7.7755e-02, PNorm = 35.0397, GNorm = 1.2895, lr_0 = 3.8023e-04
Validation rmse = 0.140194
Epoch 25
Loss = 5.2133e-02, PNorm = 35.0500, GNorm = 0.8833, lr_0 = 3.6856e-04
Loss = 8.6888e-02, PNorm = 35.0571, GNorm = 1.7672, lr_0 = 3.5825e-04
Loss = 7.8672e-02, PNorm = 35.0585, GNorm = 4.7582, lr_0 = 3.5724e-04
Validation rmse = 0.134060
Epoch 26
Loss = 8.1814e-02, PNorm = 35.0681, GNorm = 1.2385, lr_0 = 3.4725e-04
Validation rmse = 0.134611
Epoch 27
Loss = 7.9982e-02, PNorm = 35.0770, GNorm = 2.7117, lr_0 = 3.3754e-04
Validation rmse = 0.153442
Epoch 28
Loss = 1.5040e-01, PNorm = 35.0861, GNorm = 5.8148, lr_0 = 3.2717e-04
Loss = 7.9251e-02, PNorm = 35.0944, GNorm = 0.7986, lr_0 = 3.1803e-04
Validation rmse = 0.136718
Epoch 29
Loss = 6.8722e-02, PNorm = 35.1012, GNorm = 1.0734, lr_0 = 3.0826e-04
Validation rmse = 0.132550
Epoch 30
Loss = 5.7493e-02, PNorm = 35.1108, GNorm = 1.4240, lr_0 = 2.9879e-04
Loss = 7.2921e-02, PNorm = 35.1179, GNorm = 1.3111, lr_0 = 2.9044e-04
Validation rmse = 0.132258
Epoch 31
Loss = 7.3024e-02, PNorm = 35.1260, GNorm = 1.2255, lr_0 = 2.8232e-04
Validation rmse = 0.137776
Epoch 32
Loss = 7.0416e-02, PNorm = 35.1321, GNorm = 1.0014, lr_0 = 2.7365e-04
Loss = 7.6228e-02, PNorm = 35.1389, GNorm = 2.3112, lr_0 = 2.6600e-04
Loss = 5.7121e-02, PNorm = 35.1395, GNorm = 3.3822, lr_0 = 2.6524e-04
Validation rmse = 0.138381
Epoch 33
Loss = 7.2634e-02, PNorm = 35.1460, GNorm = 2.4808, lr_0 = 2.5783e-04
Validation rmse = 0.136707
Epoch 34
Loss = 7.7850e-02, PNorm = 35.1541, GNorm = 0.7343, lr_0 = 2.4991e-04
Validation rmse = 0.132987
Epoch 35
Loss = 5.5171e-02, PNorm = 35.1590, GNorm = 3.2648, lr_0 = 2.4292e-04
Loss = 6.4110e-02, PNorm = 35.1639, GNorm = 1.2281, lr_0 = 2.3613e-04
Validation rmse = 0.128490
Epoch 36
Loss = 5.9001e-02, PNorm = 35.1699, GNorm = 0.6157, lr_0 = 2.2888e-04
Validation rmse = 0.129700
Epoch 37
Loss = 4.7650e-02, PNorm = 35.1751, GNorm = 0.9975, lr_0 = 2.2185e-04
Loss = 6.9566e-02, PNorm = 35.1799, GNorm = 0.6056, lr_0 = 2.1565e-04
Validation rmse = 0.135014
Epoch 38
Loss = 6.4696e-02, PNorm = 35.1854, GNorm = 1.1098, lr_0 = 2.0902e-04
Validation rmse = 0.130194
Epoch 39
Loss = 6.4785e-02, PNorm = 35.1907, GNorm = 1.2020, lr_0 = 2.0318e-04
Loss = 5.8878e-02, PNorm = 35.1951, GNorm = 1.2817, lr_0 = 1.9750e-04
Loss = 9.2683e-02, PNorm = 35.1952, GNorm = 3.5782, lr_0 = 1.9694e-04
Validation rmse = 0.128831
Epoch 40
Loss = 6.2178e-02, PNorm = 35.1984, GNorm = 1.3745, lr_0 = 1.9143e-04
Validation rmse = 0.129135
Epoch 41
Loss = 6.7948e-02, PNorm = 35.2037, GNorm = 2.6388, lr_0 = 1.8556e-04
Validation rmse = 0.130113
Epoch 42
Loss = 5.2150e-02, PNorm = 35.2081, GNorm = 2.2228, lr_0 = 1.7986e-04
Loss = 6.6825e-02, PNorm = 35.2126, GNorm = 1.2130, lr_0 = 1.7483e-04
Validation rmse = 0.132107
Epoch 43
Loss = 6.0026e-02, PNorm = 35.2157, GNorm = 2.5849, lr_0 = 1.6994e-04
Validation rmse = 0.133033
Epoch 44
Loss = 7.8555e-02, PNorm = 35.2196, GNorm = 0.5773, lr_0 = 1.6472e-04
Loss = 5.8227e-02, PNorm = 35.2244, GNorm = 1.6299, lr_0 = 1.6012e-04
Validation rmse = 0.129455
Epoch 45
Loss = 6.0717e-02, PNorm = 35.2287, GNorm = 2.0065, lr_0 = 1.5520e-04
Validation rmse = 0.128327
Epoch 46
Loss = 6.0579e-02, PNorm = 35.2330, GNorm = 1.4780, lr_0 = 1.5043e-04
Loss = 6.1225e-02, PNorm = 35.2370, GNorm = 1.4455, lr_0 = 1.4623e-04
Validation rmse = 0.131419
Epoch 47
Loss = 6.3347e-02, PNorm = 35.2394, GNorm = 1.0232, lr_0 = 1.4214e-04
Validation rmse = 0.128343
Epoch 48
Loss = 5.3948e-02, PNorm = 35.2429, GNorm = 0.6599, lr_0 = 1.3777e-04
Validation rmse = 0.128306
Epoch 49
Loss = 5.6218e-02, PNorm = 35.2466, GNorm = 0.7288, lr_0 = 1.3354e-04
Loss = 5.9809e-02, PNorm = 35.2497, GNorm = 0.3558, lr_0 = 1.2981e-04
Validation rmse = 0.127913
Epoch 50
Loss = 5.3972e-02, PNorm = 35.2534, GNorm = 0.6250, lr_0 = 1.2618e-04
Validation rmse = 0.132159
Epoch 51
Loss = 5.9176e-02, PNorm = 35.2569, GNorm = 0.7660, lr_0 = 1.2230e-04
Loss = 5.4398e-02, PNorm = 35.2606, GNorm = 2.2893, lr_0 = 1.1888e-04
Validation rmse = 0.130986
Epoch 52
Loss = 6.3337e-02, PNorm = 35.2636, GNorm = 0.5847, lr_0 = 1.1523e-04
Validation rmse = 0.127942
Epoch 53
Loss = 4.8214e-02, PNorm = 35.2665, GNorm = 1.1802, lr_0 = 1.1169e-04
Loss = 5.8817e-02, PNorm = 35.2689, GNorm = 2.0303, lr_0 = 1.0857e-04
Validation rmse = 0.129154
Epoch 54
Loss = 5.9010e-02, PNorm = 35.2709, GNorm = 1.0037, lr_0 = 1.0554e-04
Validation rmse = 0.132752
Epoch 55
Loss = 6.4013e-02, PNorm = 35.2746, GNorm = 0.6518, lr_0 = 1.0229e-04
Validation rmse = 0.130901
Epoch 56
Loss = 5.6550e-02, PNorm = 35.2774, GNorm = 0.7620, lr_0 = 1.0000e-04
Loss = 5.4022e-02, PNorm = 35.2802, GNorm = 1.5677, lr_0 = 1.0000e-04
Validation rmse = 0.127017
Epoch 57
Loss = 6.0302e-02, PNorm = 35.2829, GNorm = 0.9888, lr_0 = 1.0000e-04
Validation rmse = 0.129683
Epoch 58
Loss = 7.2518e-02, PNorm = 35.2852, GNorm = 1.1667, lr_0 = 1.0000e-04
Loss = 5.6761e-02, PNorm = 35.2880, GNorm = 1.2125, lr_0 = 1.0000e-04
Validation rmse = 0.128785
Epoch 59
Loss = 5.9818e-02, PNorm = 35.2909, GNorm = 1.9568, lr_0 = 1.0000e-04
Validation rmse = 0.127463
Model 0 best validation rmse = 0.127017 on epoch 56
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.203072
Ensemble test rmse = 0.203072
1-fold cross validation
	Seed 0 ==> test rmse = 0.203072
Overall test rmse = 0.203072 +/- 0.000000
Elapsed time = 0:00:27
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 887 | train size = 705 | val size = 177 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1030e-01, PNorm = 34.0155, GNorm = 3.2009, lr_0 = 4.5357e-04
Validation rmse = 0.336012
Epoch 1
Loss = 9.7501e-01, PNorm = 34.0448, GNorm = 11.6830, lr_0 = 8.0714e-04
Validation rmse = 0.278158
Epoch 2
Loss = 5.1979e-01, PNorm = 34.1003, GNorm = 3.3376, lr_0 = 9.8592e-04
Loss = 5.1505e-01, PNorm = 34.1634, GNorm = 9.9284, lr_0 = 9.5836e-04
Validation rmse = 0.227445
Epoch 3
Loss = 5.8163e-01, PNorm = 34.2315, GNorm = 6.4915, lr_0 = 9.2892e-04
Validation rmse = 0.241632
Epoch 4
Loss = 3.7535e-01, PNorm = 34.2947, GNorm = 3.7705, lr_0 = 9.0040e-04
Loss = 3.3331e-01, PNorm = 34.3486, GNorm = 2.6205, lr_0 = 8.7522e-04
Loss = 2.5476e-01, PNorm = 34.3515, GNorm = 5.3434, lr_0 = 8.7274e-04
Validation rmse = 0.210465
Epoch 5
Loss = 2.8781e-01, PNorm = 34.3897, GNorm = 4.0242, lr_0 = 8.4834e-04
Validation rmse = 0.217683
Epoch 6
Loss = 2.3824e-01, PNorm = 34.4369, GNorm = 1.6738, lr_0 = 8.2229e-04
Validation rmse = 0.187542
Epoch 7
Loss = 2.6835e-01, PNorm = 34.4883, GNorm = 3.1473, lr_0 = 7.9704e-04
Loss = 1.9755e-01, PNorm = 34.5331, GNorm = 0.5849, lr_0 = 7.7475e-04
Validation rmse = 0.175471
Epoch 8
Loss = 1.6590e-01, PNorm = 34.5739, GNorm = 0.5594, lr_0 = 7.5096e-04
Validation rmse = 0.160422
Epoch 9
Loss = 1.9823e-01, PNorm = 34.6114, GNorm = 2.7003, lr_0 = 7.2790e-04
Loss = 1.7378e-01, PNorm = 34.6428, GNorm = 1.2759, lr_0 = 7.0754e-04
Validation rmse = 0.195364
Epoch 10
Loss = 1.6337e-01, PNorm = 34.6684, GNorm = 3.1002, lr_0 = 6.8776e-04
Validation rmse = 0.159220
Epoch 11
Loss = 1.5086e-01, PNorm = 34.6970, GNorm = 2.1867, lr_0 = 6.6664e-04
Validation rmse = 0.193303
Epoch 12
Loss = 2.5104e-01, PNorm = 34.7181, GNorm = 8.2784, lr_0 = 6.4617e-04
Loss = 2.7404e-01, PNorm = 34.7507, GNorm = 1.9804, lr_0 = 6.2810e-04
Validation rmse = 0.155328
Epoch 13
Loss = 1.4061e-01, PNorm = 34.7790, GNorm = 2.3661, lr_0 = 6.0881e-04
Validation rmse = 0.162212
Epoch 14
Loss = 1.1050e-01, PNorm = 34.8014, GNorm = 3.1934, lr_0 = 5.9011e-04
Loss = 1.4725e-01, PNorm = 34.8189, GNorm = 0.7115, lr_0 = 5.7362e-04
Validation rmse = 0.143118
Epoch 15
Loss = 1.1597e-01, PNorm = 34.8390, GNorm = 0.7771, lr_0 = 5.5600e-04
Validation rmse = 0.134009
Epoch 16
Loss = 8.7426e-02, PNorm = 34.8599, GNorm = 1.5427, lr_0 = 5.3892e-04
Validation rmse = 0.138069
Epoch 17
Loss = 1.0953e-01, PNorm = 34.8769, GNorm = 0.9018, lr_0 = 5.2237e-04
Loss = 1.2159e-01, PNorm = 34.8929, GNorm = 1.4781, lr_0 = 5.0777e-04
Validation rmse = 0.138603
Epoch 18
Loss = 9.9685e-02, PNorm = 34.9054, GNorm = 3.0346, lr_0 = 4.9217e-04
Validation rmse = 0.137411
Epoch 19
Loss = 1.5494e-01, PNorm = 34.9221, GNorm = 2.8560, lr_0 = 4.7706e-04
Loss = 1.1499e-01, PNorm = 34.9312, GNorm = 1.8489, lr_0 = 4.6372e-04
Validation rmse = 0.127538
Epoch 20
Loss = 9.0578e-02, PNorm = 34.9436, GNorm = 1.0038, lr_0 = 4.5076e-04
Validation rmse = 0.128862
Epoch 21
Loss = 7.7200e-02, PNorm = 34.9579, GNorm = 0.5348, lr_0 = 4.3691e-04
Loss = 1.1293e-01, PNorm = 34.9692, GNorm = 0.6816, lr_0 = 4.2470e-04
Loss = 2.0193e-02, PNorm = 34.9701, GNorm = 1.1277, lr_0 = 4.2349e-04
Validation rmse = 0.129666
Epoch 22
Loss = 9.5833e-02, PNorm = 34.9807, GNorm = 1.8999, lr_0 = 4.1165e-04
Validation rmse = 0.129535
Epoch 23
Loss = 1.0175e-01, PNorm = 34.9973, GNorm = 2.8832, lr_0 = 3.9901e-04
Validation rmse = 0.138331
Epoch 24
Loss = 1.0172e-01, PNorm = 35.0087, GNorm = 1.0896, lr_0 = 3.8676e-04
Loss = 9.9260e-02, PNorm = 35.0188, GNorm = 0.7059, lr_0 = 3.7594e-04
Validation rmse = 0.128661
Epoch 25
Loss = 8.7556e-02, PNorm = 35.0312, GNorm = 0.7268, lr_0 = 3.6440e-04
Validation rmse = 0.127079
Epoch 26
Loss = 7.5106e-02, PNorm = 35.0421, GNorm = 1.1478, lr_0 = 3.5321e-04
Loss = 9.4132e-02, PNorm = 35.0510, GNorm = 1.6865, lr_0 = 3.4333e-04
Loss = 3.8308e-02, PNorm = 35.0524, GNorm = 1.8471, lr_0 = 3.4236e-04
Validation rmse = 0.127100
Epoch 27
Loss = 9.9473e-02, PNorm = 35.0624, GNorm = 3.1335, lr_0 = 3.3279e-04
Validation rmse = 0.121338
Epoch 28
Loss = 9.8591e-02, PNorm = 35.0710, GNorm = 3.0543, lr_0 = 3.2257e-04
Validation rmse = 0.118337
Epoch 29
Loss = 1.0087e-01, PNorm = 35.0798, GNorm = 0.5413, lr_0 = 3.1266e-04
Loss = 8.9052e-02, PNorm = 35.0884, GNorm = 3.4741, lr_0 = 3.0392e-04
Validation rmse = 0.128263
Epoch 30
Loss = 9.0269e-02, PNorm = 35.0941, GNorm = 0.8103, lr_0 = 2.9542e-04
Validation rmse = 0.126643
Epoch 31
Loss = 7.4263e-02, PNorm = 35.1032, GNorm = 1.5879, lr_0 = 2.8635e-04
Loss = 9.1942e-02, PNorm = 35.1097, GNorm = 2.0883, lr_0 = 2.7834e-04
Validation rmse = 0.121165
Epoch 32
Loss = 8.0491e-02, PNorm = 35.1188, GNorm = 1.4865, lr_0 = 2.6980e-04
Validation rmse = 0.118845
Epoch 33
Loss = 7.6890e-02, PNorm = 35.1260, GNorm = 0.9260, lr_0 = 2.6151e-04
Validation rmse = 0.117542
Epoch 34
Loss = 5.0744e-02, PNorm = 35.1328, GNorm = 1.7605, lr_0 = 2.5348e-04
Loss = 8.6688e-02, PNorm = 35.1397, GNorm = 1.3162, lr_0 = 2.4639e-04
Validation rmse = 0.116554
Epoch 35
Loss = 7.8242e-02, PNorm = 35.1460, GNorm = 0.7883, lr_0 = 2.3882e-04
Validation rmse = 0.117935
Epoch 36
Loss = 6.0223e-02, PNorm = 35.1533, GNorm = 0.7488, lr_0 = 2.3149e-04
Loss = 8.4399e-02, PNorm = 35.1603, GNorm = 1.0517, lr_0 = 2.2502e-04
Validation rmse = 0.124400
Epoch 37
Loss = 8.8178e-02, PNorm = 35.1674, GNorm = 1.4438, lr_0 = 2.1811e-04
Validation rmse = 0.117188
Epoch 38
Loss = 5.9410e-02, PNorm = 35.1730, GNorm = 1.2648, lr_0 = 2.1141e-04
Validation rmse = 0.118434
Epoch 39
Loss = 4.1481e-02, PNorm = 35.1795, GNorm = 0.3647, lr_0 = 2.0492e-04
Loss = 8.0569e-02, PNorm = 35.1867, GNorm = 1.1850, lr_0 = 1.9919e-04
Validation rmse = 0.113660
Epoch 40
Loss = 6.2854e-02, PNorm = 35.1900, GNorm = 0.7206, lr_0 = 1.9362e-04
Validation rmse = 0.115332
Epoch 41
Loss = 5.6924e-02, PNorm = 35.1949, GNorm = 0.9581, lr_0 = 1.8767e-04
Loss = 7.1795e-02, PNorm = 35.2009, GNorm = 1.3430, lr_0 = 1.8242e-04
Validation rmse = 0.114202
Epoch 42
Loss = 6.4213e-02, PNorm = 35.2057, GNorm = 1.2105, lr_0 = 1.7682e-04
Validation rmse = 0.114993
Epoch 43
Loss = 8.1664e-02, PNorm = 35.2105, GNorm = 2.5130, lr_0 = 1.7139e-04
Loss = 7.3069e-02, PNorm = 35.2149, GNorm = 2.6679, lr_0 = 1.6660e-04
Loss = 8.8130e-01, PNorm = 35.2154, GNorm = 5.2948, lr_0 = 1.6613e-04
Validation rmse = 0.126043
Epoch 44
Loss = 8.6220e-02, PNorm = 35.2218, GNorm = 0.7100, lr_0 = 1.6148e-04
Validation rmse = 0.118031
Epoch 45
Loss = 7.6499e-02, PNorm = 35.2267, GNorm = 1.5453, lr_0 = 1.5652e-04
Validation rmse = 0.117001
Epoch 46
Loss = 5.9186e-02, PNorm = 35.2318, GNorm = 0.9266, lr_0 = 1.5172e-04
Loss = 8.0975e-02, PNorm = 35.2375, GNorm = 1.6088, lr_0 = 1.4748e-04
Validation rmse = 0.116541
Epoch 47
Loss = 7.6777e-02, PNorm = 35.2424, GNorm = 1.7968, lr_0 = 1.4295e-04
Validation rmse = 0.117320
Epoch 48
Loss = 6.0601e-02, PNorm = 35.2464, GNorm = 2.5713, lr_0 = 1.3856e-04
Loss = 7.5265e-02, PNorm = 35.2496, GNorm = 0.6917, lr_0 = 1.3468e-04
Loss = 3.1583e-02, PNorm = 35.2502, GNorm = 1.2063, lr_0 = 1.3430e-04
Validation rmse = 0.115327
Epoch 49
Loss = 6.2068e-02, PNorm = 35.2538, GNorm = 0.7118, lr_0 = 1.3055e-04
Validation rmse = 0.114367
Epoch 50
Loss = 7.8378e-02, PNorm = 35.2580, GNorm = 2.8245, lr_0 = 1.2690e-04
Validation rmse = 0.121868
Epoch 51
Loss = 8.7731e-02, PNorm = 35.2624, GNorm = 3.0721, lr_0 = 1.2300e-04
Loss = 6.9502e-02, PNorm = 35.2663, GNorm = 0.8759, lr_0 = 1.1956e-04
Validation rmse = 0.113486
Epoch 52
Loss = 6.1941e-02, PNorm = 35.2708, GNorm = 0.4694, lr_0 = 1.1589e-04
Validation rmse = 0.114654
Epoch 53
Loss = 7.1931e-02, PNorm = 35.2752, GNorm = 1.6945, lr_0 = 1.1233e-04
Loss = 7.0319e-02, PNorm = 35.2782, GNorm = 2.9082, lr_0 = 1.0919e-04
Validation rmse = 0.113157
Epoch 54
Loss = 6.3344e-02, PNorm = 35.2807, GNorm = 0.7423, lr_0 = 1.0584e-04
Validation rmse = 0.113877
Epoch 55
Loss = 6.5069e-02, PNorm = 35.2830, GNorm = 0.6814, lr_0 = 1.0258e-04
Validation rmse = 0.113465
Epoch 56
Loss = 7.0414e-02, PNorm = 35.2854, GNorm = 1.1971, lr_0 = 1.0000e-04
Loss = 5.6879e-02, PNorm = 35.2874, GNorm = 0.6932, lr_0 = 1.0000e-04
Validation rmse = 0.112012
Epoch 57
Loss = 7.1138e-02, PNorm = 35.2914, GNorm = 2.6061, lr_0 = 1.0000e-04
Validation rmse = 0.113607
Epoch 58
Loss = 1.0538e-01, PNorm = 35.2956, GNorm = 3.4738, lr_0 = 1.0000e-04
Loss = 5.9771e-02, PNorm = 35.2984, GNorm = 0.6511, lr_0 = 1.0000e-04
Validation rmse = 0.111926
Epoch 59
Loss = 6.5784e-02, PNorm = 35.3027, GNorm = 1.0996, lr_0 = 1.0000e-04
Validation rmse = 0.114588
Model 0 best validation rmse = 0.111926 on epoch 58
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.181029
Ensemble test rmse = 0.181029
1-fold cross validation
	Seed 0 ==> test rmse = 0.181029
Overall test rmse = 0.181029 +/- 0.000000
Elapsed time = 0:00:26
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 877 | train size = 697 | val size = 175 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.8286e-01, PNorm = 34.0153, GNorm = 4.7305, lr_0 = 4.8077e-04
Validation rmse = 0.314648
Epoch 1
Loss = 7.1424e-01, PNorm = 34.0497, GNorm = 3.5580, lr_0 = 8.6154e-04
Validation rmse = 0.245560
Epoch 2
Loss = 5.0230e-01, PNorm = 34.1151, GNorm = 5.6641, lr_0 = 9.8184e-04
Loss = 4.0008e-01, PNorm = 34.1954, GNorm = 3.9598, lr_0 = 9.5231e-04
Validation rmse = 0.285273
Epoch 3
Loss = 5.1864e-01, PNorm = 34.2499, GNorm = 11.1944, lr_0 = 9.2367e-04
Validation rmse = 0.208832
Epoch 4
Loss = 3.5506e-01, PNorm = 34.3002, GNorm = 0.9583, lr_0 = 8.9589e-04
Validation rmse = 0.208364
Epoch 5
Loss = 2.3348e-01, PNorm = 34.3529, GNorm = 5.1014, lr_0 = 8.6894e-04
Loss = 2.4059e-01, PNorm = 34.3997, GNorm = 2.4414, lr_0 = 8.4281e-04
Validation rmse = 0.195714
Epoch 6
Loss = 2.3318e-01, PNorm = 34.4476, GNorm = 2.2086, lr_0 = 8.1746e-04
Validation rmse = 0.163990
Epoch 7
Loss = 1.8283e-01, PNorm = 34.4934, GNorm = 1.8588, lr_0 = 7.9287e-04
Loss = 1.6819e-01, PNorm = 34.5320, GNorm = 1.6201, lr_0 = 7.6903e-04
Validation rmse = 0.166297
Epoch 8
Loss = 1.5966e-01, PNorm = 34.5686, GNorm = 3.0537, lr_0 = 7.4590e-04
Validation rmse = 0.154114
Epoch 9
Loss = 1.5495e-01, PNorm = 34.6003, GNorm = 3.6210, lr_0 = 7.2346e-04
Validation rmse = 0.150608
Epoch 10
Loss = 1.3766e-01, PNorm = 34.6334, GNorm = 4.8352, lr_0 = 7.0170e-04
Loss = 1.5326e-01, PNorm = 34.6652, GNorm = 3.4552, lr_0 = 6.8060e-04
Validation rmse = 0.157944
Epoch 11
Loss = 1.2468e-01, PNorm = 34.6971, GNorm = 4.4771, lr_0 = 6.6013e-04
Validation rmse = 0.140112
Epoch 12
Loss = 1.1437e-01, PNorm = 34.7262, GNorm = 2.9442, lr_0 = 6.4027e-04
Loss = 1.0693e-01, PNorm = 34.7553, GNorm = 0.7846, lr_0 = 6.2102e-04
Validation rmse = 0.145310
Epoch 13
Loss = 9.7369e-02, PNorm = 34.7823, GNorm = 3.7483, lr_0 = 6.0234e-04
Validation rmse = 0.152504
Epoch 14
Loss = 1.0954e-01, PNorm = 34.8071, GNorm = 3.3592, lr_0 = 5.8422e-04
Validation rmse = 0.140495
Epoch 15
Loss = 1.1108e-01, PNorm = 34.8281, GNorm = 1.6740, lr_0 = 5.6665e-04
Loss = 1.0552e-01, PNorm = 34.8500, GNorm = 2.6489, lr_0 = 5.4961e-04
Validation rmse = 0.134347
Epoch 16
Loss = 9.5494e-02, PNorm = 34.8713, GNorm = 1.7339, lr_0 = 5.3308e-04
Validation rmse = 0.138505
Epoch 17
Loss = 9.4691e-02, PNorm = 34.8922, GNorm = 1.4145, lr_0 = 5.1547e-04
Loss = 8.3486e-02, PNorm = 34.9106, GNorm = 0.7483, lr_0 = 4.9996e-04
Validation rmse = 0.134916
Epoch 18
Loss = 8.3482e-02, PNorm = 34.9266, GNorm = 1.9849, lr_0 = 4.8493e-04
Validation rmse = 0.134454
Epoch 19
Loss = 8.1972e-02, PNorm = 34.9430, GNorm = 1.7837, lr_0 = 4.7034e-04
Validation rmse = 0.135792
Epoch 20
Loss = 6.7080e-02, PNorm = 34.9604, GNorm = 2.5521, lr_0 = 4.5620e-04
Loss = 9.6965e-02, PNorm = 34.9737, GNorm = 1.2176, lr_0 = 4.4247e-04
Validation rmse = 0.135974
Epoch 21
Loss = 8.3936e-02, PNorm = 34.9924, GNorm = 0.5845, lr_0 = 4.2917e-04
Validation rmse = 0.132105
Epoch 22
Loss = 7.3551e-02, PNorm = 35.0064, GNorm = 0.5646, lr_0 = 4.1626e-04
Loss = 8.9240e-02, PNorm = 35.0178, GNorm = 1.5101, lr_0 = 4.0374e-04
Validation rmse = 0.141249
Epoch 23
Loss = 8.2160e-02, PNorm = 35.0312, GNorm = 1.1922, lr_0 = 3.9160e-04
Validation rmse = 0.142848
Epoch 24
Loss = 7.4868e-02, PNorm = 35.0430, GNorm = 3.1275, lr_0 = 3.7982e-04
Validation rmse = 0.131479
Epoch 25
Loss = 6.5820e-02, PNorm = 35.0547, GNorm = 2.1315, lr_0 = 3.6839e-04
Loss = 1.0270e-01, PNorm = 35.0657, GNorm = 2.2741, lr_0 = 3.5731e-04
Validation rmse = 0.129708
Epoch 26
Loss = 6.7578e-02, PNorm = 35.0763, GNorm = 1.4555, lr_0 = 3.4657e-04
Validation rmse = 0.128370
Epoch 27
Loss = 7.0524e-02, PNorm = 35.0871, GNorm = 1.1237, lr_0 = 3.3614e-04
Loss = 8.4140e-02, PNorm = 35.0968, GNorm = 1.7832, lr_0 = 3.2603e-04
Validation rmse = 0.128736
Epoch 28
Loss = 7.0757e-02, PNorm = 35.1076, GNorm = 0.6583, lr_0 = 3.1623e-04
Validation rmse = 0.128280
Epoch 29
Loss = 6.9468e-02, PNorm = 35.1166, GNorm = 0.8757, lr_0 = 3.0672e-04
Validation rmse = 0.129942
Epoch 30
Loss = 9.6639e-02, PNorm = 35.1260, GNorm = 2.5219, lr_0 = 2.9749e-04
Loss = 6.8574e-02, PNorm = 35.1353, GNorm = 0.5761, lr_0 = 2.8854e-04
Validation rmse = 0.132536
Epoch 31
Loss = 6.2712e-02, PNorm = 35.1428, GNorm = 1.8818, lr_0 = 2.7987e-04
Validation rmse = 0.128626
Epoch 32
Loss = 7.2000e-02, PNorm = 35.1507, GNorm = 0.8236, lr_0 = 2.7145e-04
Loss = 6.1069e-02, PNorm = 35.1583, GNorm = 2.2039, lr_0 = 2.6328e-04
Validation rmse = 0.134974
Epoch 33
Loss = 6.3055e-02, PNorm = 35.1647, GNorm = 0.5695, lr_0 = 2.5537e-04
Validation rmse = 0.128210
Epoch 34
Loss = 6.2412e-02, PNorm = 35.1723, GNorm = 1.0911, lr_0 = 2.4693e-04
Validation rmse = 0.138938
Epoch 35
Loss = 6.4719e-02, PNorm = 35.1790, GNorm = 0.4117, lr_0 = 2.3950e-04
Loss = 6.5354e-02, PNorm = 35.1841, GNorm = 1.3962, lr_0 = 2.3230e-04
Validation rmse = 0.127460
Epoch 36
Loss = 5.7537e-02, PNorm = 35.1909, GNorm = 2.4259, lr_0 = 2.2531e-04
Validation rmse = 0.128000
Epoch 37
Loss = 6.0039e-02, PNorm = 35.1981, GNorm = 0.6558, lr_0 = 2.1854e-04
Validation rmse = 0.128450
Epoch 38
Loss = 9.4971e-02, PNorm = 35.2032, GNorm = 1.8498, lr_0 = 2.1196e-04
Loss = 6.1987e-02, PNorm = 35.2093, GNorm = 2.2338, lr_0 = 2.0559e-04
Validation rmse = 0.134696
Epoch 39
Loss = 5.8713e-02, PNorm = 35.2158, GNorm = 1.7956, lr_0 = 1.9940e-04
Validation rmse = 0.127186
Epoch 40
Loss = 6.6905e-02, PNorm = 35.2214, GNorm = 3.1574, lr_0 = 1.9341e-04
Loss = 5.7690e-02, PNorm = 35.2268, GNorm = 1.5653, lr_0 = 1.8759e-04
Validation rmse = 0.129416
Epoch 41
Loss = 5.4687e-02, PNorm = 35.2307, GNorm = 1.8303, lr_0 = 1.8195e-04
Validation rmse = 0.127340
Epoch 42
Loss = 6.4665e-02, PNorm = 35.2367, GNorm = 0.7188, lr_0 = 1.7648e-04
Validation rmse = 0.127536
Epoch 43
Loss = 6.9830e-02, PNorm = 35.2410, GNorm = 1.3551, lr_0 = 1.7117e-04
Loss = 5.6537e-02, PNorm = 35.2450, GNorm = 1.4245, lr_0 = 1.6602e-04
Validation rmse = 0.131053
Epoch 44
Loss = 6.7969e-02, PNorm = 35.2503, GNorm = 1.1908, lr_0 = 1.6103e-04
Validation rmse = 0.126566
Epoch 45
Loss = 5.0502e-02, PNorm = 35.2546, GNorm = 0.5550, lr_0 = 1.5618e-04
Loss = 6.1230e-02, PNorm = 35.2590, GNorm = 1.6221, lr_0 = 1.5149e-04
Validation rmse = 0.133947
Epoch 46
Loss = 5.2060e-02, PNorm = 35.2621, GNorm = 2.0350, lr_0 = 1.4693e-04
Validation rmse = 0.127937
Epoch 47
Loss = 5.5409e-02, PNorm = 35.2657, GNorm = 2.3246, lr_0 = 1.4251e-04
Validation rmse = 0.127368
Epoch 48
Loss = 5.6433e-02, PNorm = 35.2696, GNorm = 0.6825, lr_0 = 1.3822e-04
Loss = 5.1047e-02, PNorm = 35.2728, GNorm = 1.9893, lr_0 = 1.3407e-04
Validation rmse = 0.127640
Epoch 49
Loss = 6.3864e-02, PNorm = 35.2769, GNorm = 0.8751, lr_0 = 1.3003e-04
Validation rmse = 0.132798
Epoch 50
Loss = 6.2980e-02, PNorm = 35.2803, GNorm = 0.6132, lr_0 = 1.2612e-04
Loss = 5.0719e-02, PNorm = 35.2840, GNorm = 0.6729, lr_0 = 1.2233e-04
Loss = 9.0992e-02, PNorm = 35.2843, GNorm = 0.7561, lr_0 = 1.2196e-04
Validation rmse = 0.128668
Epoch 51
Loss = 5.2636e-02, PNorm = 35.2880, GNorm = 1.3251, lr_0 = 1.1829e-04
Validation rmse = 0.126560
Epoch 52
Loss = 5.7665e-02, PNorm = 35.2908, GNorm = 0.6017, lr_0 = 1.1473e-04
Validation rmse = 0.127126
Epoch 53
Loss = 5.8734e-02, PNorm = 35.2937, GNorm = 2.0063, lr_0 = 1.1128e-04
Loss = 5.6579e-02, PNorm = 35.2967, GNorm = 0.6543, lr_0 = 1.0793e-04
Validation rmse = 0.128964
Epoch 54
Loss = 5.4286e-02, PNorm = 35.2997, GNorm = 0.8063, lr_0 = 1.0469e-04
Validation rmse = 0.127014
Epoch 55
Loss = 5.0894e-02, PNorm = 35.3023, GNorm = 2.3481, lr_0 = 1.0154e-04
Loss = 5.8901e-02, PNorm = 35.3047, GNorm = 1.9959, lr_0 = 1.0000e-04
Validation rmse = 0.126613
Epoch 56
Loss = 5.6929e-02, PNorm = 35.3076, GNorm = 0.7170, lr_0 = 1.0000e-04
Validation rmse = 0.129887
Epoch 57
Loss = 5.5727e-02, PNorm = 35.3104, GNorm = 0.9036, lr_0 = 1.0000e-04
Validation rmse = 0.128083
Epoch 58
Loss = 4.4648e-02, PNorm = 35.3130, GNorm = 1.4920, lr_0 = 1.0000e-04
Loss = 5.3043e-02, PNorm = 35.3158, GNorm = 1.4051, lr_0 = 1.0000e-04
Validation rmse = 0.127759
Epoch 59
Loss = 5.5072e-02, PNorm = 35.3187, GNorm = 0.6978, lr_0 = 1.0000e-04
Validation rmse = 0.130419
Model 0 best validation rmse = 0.126560 on epoch 51
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.134372
Ensemble test rmse = 0.134372
1-fold cross validation
	Seed 0 ==> test rmse = 0.134372
Overall test rmse = 0.134372 +/- 0.000000
Elapsed time = 0:00:26
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 867 | train size = 689 | val size = 173 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1366e-01, PNorm = 34.0201, GNorm = 1.0732, lr_0 = 4.8077e-04
Validation rmse = 0.304158
Epoch 1
Loss = 6.9438e-01, PNorm = 34.0575, GNorm = 2.4030, lr_0 = 8.6154e-04
Validation rmse = 0.293924
Epoch 2
Loss = 5.4804e-01, PNorm = 34.1063, GNorm = 1.5696, lr_0 = 3.4551e-04
Loss = 4.6922e-01, PNorm = 34.1166, GNorm = 4.6698, lr_0 = 1.0000e-04
Validation rmse = 0.227073
Model 0 best validation rmse = 0.227073 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.247985
Ensemble test rmse = 0.247985
1-fold cross validation
	Seed 0 ==> test rmse = 0.247985
Overall test rmse = 0.247985 +/- 0.000000
Elapsed time = 0:00:03
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 857 | train size = 681 | val size = 171 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.3097e-01, PNorm = 34.0214, GNorm = 4.0939, lr_0 = 4.8077e-04
Validation rmse = 0.263587
Epoch 1
Loss = 6.8737e-01, PNorm = 34.0578, GNorm = 7.2955, lr_0 = 8.6154e-04
Validation rmse = 0.241964
Epoch 2
Loss = 4.7734e-01, PNorm = 34.0950, GNorm = 3.3322, lr_0 = 3.4551e-04
Loss = 5.1102e-01, PNorm = 34.1046, GNorm = 2.9548, lr_0 = 1.0000e-04
Loss = 2.6921e-01, PNorm = 34.1053, GNorm = 3.0610, lr_0 = 1.0000e-04
Validation rmse = 0.230735
Model 0 best validation rmse = 0.230735 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.287670
Ensemble test rmse = 0.287670
1-fold cross validation
	Seed 0 ==> test rmse = 0.287670
Overall test rmse = 0.287670 +/- 0.000000
Elapsed time = 0:00:02
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 847 | train size = 673 | val size = 169 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.7298e-01, PNorm = 34.0207, GNorm = 1.4157, lr_0 = 4.8077e-04
Validation rmse = 0.260102
Epoch 1
Loss = 6.0402e-01, PNorm = 34.0569, GNorm = 6.4687, lr_0 = 8.6154e-04
Validation rmse = 0.236320
Epoch 2
Loss = 5.9866e-01, PNorm = 34.0956, GNorm = 9.4550, lr_0 = 2.8943e-04
Loss = 4.3982e-01, PNorm = 34.1040, GNorm = 2.9757, lr_0 = 1.0000e-04
Validation rmse = 0.224546
Model 0 best validation rmse = 0.224546 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.242908
Ensemble test rmse = 0.242908
1-fold cross validation
	Seed 0 ==> test rmse = 0.242908
Overall test rmse = 0.242908 +/- 0.000000
Elapsed time = 0:00:02
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_mecn.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 116 | train size = 114 | val size = 1 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.022492
Model 0 best validation rmse = 0.022492 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.217004
Ensemble test rmse = 0.217004
1-fold cross validation
	Seed 0 ==> test rmse = 0.217004
Overall test rmse = 0.217004 +/- 0.000000
Elapsed time = 0:00:01
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_mecn.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 111 | train size = 109 | val size = 1 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.230139
Model 0 best validation rmse = 0.230139 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.030905
Ensemble test rmse = 0.030905
1-fold cross validation
	Seed 0 ==> test rmse = 0.030905
Overall test rmse = 0.030905 +/- 0.000000
Elapsed time = 0:00:00
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_mecn.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 106 | train size = 104 | val size = 1 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.022217
Model 0 best validation rmse = 0.022217 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.142241
Ensemble test rmse = 0.142241
1-fold cross validation
	Seed 0 ==> test rmse = 0.142241
Overall test rmse = 0.142241 +/- 0.000000
Elapsed time = 0:00:00
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_mecn.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 101 | train size = 99 | val size = 1 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.053861
Model 0 best validation rmse = 0.053861 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.181530
Ensemble test rmse = 0.181530
1-fold cross validation
	Seed 0 ==> test rmse = 0.181530
Overall test rmse = 0.181530 +/- 0.000000
Elapsed time = 0:00:00
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_mecn.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 96 | train size = 95 | val size = 0 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = nan
Model 0 best validation rmse = inf on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.119864
Ensemble test rmse = 0.119864
1-fold cross validation
	Seed 0 ==> test rmse = 0.119864
Overall test rmse = 0.119864 +/- 0.000000
Elapsed time = 0:00:00
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-d9f179e0-d3f3-4cdd-8b18-b3eabb183c9e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/_mecn.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.99, 0.005, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 91 | train size = 90 | val size = 0 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Validation rmse = nan
Epoch 1
Validation rmse = nan
Epoch 2
Validation rmse = nan
Epoch 3
Validation rmse = nan
Epoch 4
Validation rmse = nan
Epoch 5
Loss = 5.2522e-01, PNorm = 34.0488, GNorm = 4.2822, lr_0 = 6.7234e-04
Loss = 4.5898e-01, PNorm = 34.0516, GNorm = 3.5689, lr_0 = 6.4617e-04
Validation rmse = nan
Epoch 6
Validation rmse = nan
Epoch 7
Validation rmse = nan
Epoch 8
Validation rmse = nan
Epoch 9
Validation rmse = nan
Epoch 10
Validation rmse = nan
Epoch 11
Loss = 3.4415e-01, PNorm = 34.0820, GNorm = 0.8185, lr_0 = 4.1753e-04
Validation rmse = nan
Epoch 12
Validation rmse = nan
Epoch 13
Validation rmse = nan
Epoch 14
Validation rmse = nan
Epoch 15
Validation rmse = nan
Epoch 16
Loss = 2.9874e-01, PNorm = 34.1058, GNorm = 1.8543, lr_0 = 2.6980e-04
Validation rmse = nan
Epoch 17
Validation rmse = nan
Epoch 18
Validation rmse = nan
Epoch 19
Validation rmse = nan
Epoch 20
Validation rmse = nan
Epoch 21
Validation rmse = nan
Epoch 22
Loss = 2.7589e-01, PNorm = 34.1239, GNorm = 2.1634, lr_0 = 1.7433e-04
Validation rmse = nan
Epoch 23
Validation rmse = nan
Epoch 24
Validation rmse = nan
Epoch 25
Validation rmse = nan
Epoch 26
Validation rmse = nan
Epoch 27
Loss = 2.2696e-01, PNorm = 34.1363, GNorm = 1.4886, lr_0 = 1.1265e-04
Validation rmse = nan
Epoch 28
Validation rmse = nan
Epoch 29
Validation rmse = nan
Epoch 30
Validation rmse = nan
Epoch 31
Validation rmse = nan
Epoch 32
Validation rmse = nan
Epoch 33
Loss = 2.2642e-01, PNorm = 34.1452, GNorm = 2.0882, lr_0 = 1.0000e-04
Validation rmse = nan
Epoch 34
Validation rmse = nan
Epoch 35
Validation rmse = nan
Epoch 36
Validation rmse = nan
Epoch 37
Validation rmse = nan
Epoch 38
Loss = 1.8688e-01, PNorm = 34.1542, GNorm = 3.5523, lr_0 = 1.0000e-04
Validation rmse = nan
Epoch 39
Validation rmse = nan
Epoch 40
Validation rmse = nan
Epoch 41
Validation rmse = nan
Epoch 42
Validation rmse = nan
Epoch 43
Validation rmse = nan
Epoch 44
Loss = 1.6689e-01, PNorm = 34.1633, GNorm = 0.5444, lr_0 = 1.0000e-04
Validation rmse = nan
Epoch 45
Validation rmse = nan
Epoch 46
Validation rmse = nan
Epoch 47
Validation rmse = nan
Epoch 48
Validation rmse = nan
Epoch 49
Loss = 1.5201e-01, PNorm = 34.1728, GNorm = 1.2387, lr_0 = 1.0000e-04
Validation rmse = nan
Epoch 50
Validation rmse = nan
Epoch 51
Validation rmse = nan
Epoch 52
Validation rmse = nan
Epoch 53
Validation rmse = nan
Epoch 54
Validation rmse = nan
Epoch 55
Loss = 1.4264e-01, PNorm = 34.1827, GNorm = 1.4753, lr_0 = 1.0000e-04
Loss = 1.3645e-01, PNorm = 34.1836, GNorm = 0.8915, lr_0 = 1.0000e-04
Validation rmse = nan
Epoch 56
Validation rmse = nan
Epoch 57
Validation rmse = nan
Epoch 58
Validation rmse = nan
Epoch 59
Validation rmse = nan
Model 0 best validation rmse = inf on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.109940
Ensemble test rmse = 0.109940
1-fold cross validation
	Seed 0 ==> test rmse = 0.109940
Overall test rmse = 0.109940 +/- 0.000000
Elapsed time = 0:00:05
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-d9f179e0-d3f3-4cdd-8b18-b3eabb183c9e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/_mecn.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.99, 0.005, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 86 | train size = 85 | val size = 0 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Validation rmse = nan
Epoch 1
Validation rmse = nan
Epoch 2
Validation rmse = nan
Epoch 3
Validation rmse = nan
Epoch 4
Validation rmse = nan
Epoch 5
Loss = 5.5496e-01, PNorm = 34.0447, GNorm = 2.3690, lr_0 = 6.4617e-04
Validation rmse = nan
Epoch 6
Validation rmse = nan
Epoch 7
Validation rmse = nan
Epoch 8
Validation rmse = nan
Epoch 9
Validation rmse = nan
Epoch 10
Validation rmse = nan
Epoch 11
Loss = 4.3320e-01, PNorm = 34.0747, GNorm = 0.6881, lr_0 = 4.0128e-04
Validation rmse = nan
Epoch 12
Validation rmse = nan
Epoch 13
Validation rmse = nan
Epoch 14
Validation rmse = nan
Epoch 15
Validation rmse = nan
Epoch 16
Validation rmse = nan
Epoch 17
Loss = 3.8320e-01, PNorm = 34.0934, GNorm = 2.1680, lr_0 = 2.4920e-04
Validation rmse = nan
Epoch 18
Validation rmse = nan
Epoch 19
Validation rmse = nan
Epoch 20
Validation rmse = nan
Epoch 21
Validation rmse = nan
Epoch 22
Validation rmse = nan
Epoch 23
Loss = 3.1402e-01, PNorm = 34.1073, GNorm = 0.9284, lr_0 = 1.6103e-04
Loss = 3.3135e-01, PNorm = 34.1084, GNorm = 0.8628, lr_0 = 1.5476e-04
Validation rmse = nan
Epoch 24
Validation rmse = nan
Epoch 25
Validation rmse = nan
Epoch 26
Validation rmse = nan
Epoch 27
Validation rmse = nan
Epoch 28
Validation rmse = nan
Epoch 29
Loss = 3.7082e-01, PNorm = 34.1174, GNorm = 1.0725, lr_0 = 1.0000e-04
Validation rmse = nan
Epoch 30
Validation rmse = nan
Epoch 31
Validation rmse = nan
Epoch 32
Validation rmse = nan
Epoch 33
Validation rmse = nan
Epoch 34
Validation rmse = nan
Epoch 35
Loss = 2.5113e-01, PNorm = 34.1265, GNorm = 1.5169, lr_0 = 1.0000e-04
Validation rmse = nan
Epoch 36
Validation rmse = nan
Epoch 37
Validation rmse = nan
Epoch 38
Validation rmse = nan
Epoch 39
Validation rmse = nan
Epoch 40
Validation rmse = nan
Epoch 41
Loss = 2.6930e-01, PNorm = 34.1360, GNorm = 1.2564, lr_0 = 1.0000e-04
Validation rmse = nan
Epoch 42
Validation rmse = nan
Epoch 43
Validation rmse = nan
Epoch 44
Validation rmse = nan
Epoch 45
Validation rmse = nan
Epoch 46
Validation rmse = nan
Epoch 47
Loss = 2.1099e-01, PNorm = 34.1461, GNorm = 0.9514, lr_0 = 1.0000e-04
Validation rmse = nan
Epoch 48
Validation rmse = nan
Epoch 49
Validation rmse = nan
Epoch 50
Validation rmse = nan
Epoch 51
Validation rmse = nan
Epoch 52
Loss = 1.9235e-01, PNorm = 34.1557, GNorm = 0.9450, lr_0 = 1.0000e-04
Validation rmse = nan
Epoch 53
Validation rmse = nan
Epoch 54
Validation rmse = nan
Epoch 55
Validation rmse = nan
Epoch 56
Validation rmse = nan
Epoch 57
Validation rmse = nan
Epoch 58
Loss = 1.8859e-01, PNorm = 34.1667, GNorm = 3.1435, lr_0 = 1.0000e-04
Validation rmse = nan
Epoch 59
Validation rmse = nan
Model 0 best validation rmse = inf on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.138020
Ensemble test rmse = 0.138020
1-fold cross validation
	Seed 0 ==> test rmse = 0.138020
Overall test rmse = 0.138020 +/- 0.000000
Elapsed time = 0:00:05
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-d9f179e0-d3f3-4cdd-8b18-b3eabb183c9e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/_mecn.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.99, 0.005, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 81 | train size = 80 | val size = 0 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Validation rmse = nan
Epoch 1
Validation rmse = nan
Epoch 2
Validation rmse = nan
Epoch 3
Validation rmse = nan
Epoch 4
Validation rmse = nan
Epoch 5
Validation rmse = nan
Epoch 6
Loss = 5.0461e-01, PNorm = 34.0484, GNorm = 4.3276, lr_0 = 6.2102e-04
Validation rmse = nan
Epoch 7
Validation rmse = nan
Epoch 8
Validation rmse = nan
Epoch 9
Validation rmse = nan
Epoch 10
Validation rmse = nan
Epoch 11
Validation rmse = nan
Epoch 12
Loss = 4.0910e-01, PNorm = 34.0800, GNorm = 2.5460, lr_0 = 3.8566e-04
Loss = 3.5927e-01, PNorm = 34.0823, GNorm = 1.8981, lr_0 = 3.7065e-04
Validation rmse = nan
Epoch 13
Validation rmse = nan
Epoch 14
Validation rmse = nan
Epoch 15
Validation rmse = nan
Epoch 16
Validation rmse = nan
Epoch 17
Validation rmse = nan
Epoch 18
Loss = 2.8897e-01, PNorm = 34.1053, GNorm = 0.9717, lr_0 = 2.3018e-04
Validation rmse = nan
Epoch 19
Validation rmse = nan
Epoch 20
Validation rmse = nan
Epoch 21
Validation rmse = nan
Epoch 22
Validation rmse = nan
Epoch 23
Validation rmse = nan
Epoch 24
Loss = 2.7540e-01, PNorm = 34.1221, GNorm = 5.7898, lr_0 = 1.4295e-04
Validation rmse = nan
Epoch 25
Validation rmse = nan
Epoch 26
Validation rmse = nan
Epoch 27
Validation rmse = nan
Epoch 28
Validation rmse = nan
Epoch 29
Validation rmse = nan
Epoch 30
Validation rmse = nan
Epoch 31
Loss = 1.7994e-01, PNorm = 34.1337, GNorm = 0.5529, lr_0 = 1.0000e-04
Validation rmse = nan
Epoch 32
Validation rmse = nan
Epoch 33
Validation rmse = nan
Epoch 34
Validation rmse = nan
Epoch 35
Validation rmse = nan
Epoch 36
Validation rmse = nan
Epoch 37
Loss = 2.3915e-01, PNorm = 34.1437, GNorm = 0.7110, lr_0 = 1.0000e-04
Loss = 1.5265e-01, PNorm = 34.1446, GNorm = 2.4387, lr_0 = 1.0000e-04
Validation rmse = nan
Epoch 38
Validation rmse = nan
Epoch 39
Validation rmse = nan
Epoch 40
Validation rmse = nan
Epoch 41
Validation rmse = nan
Epoch 42
Validation rmse = nan
Epoch 43
Loss = 1.8424e-01, PNorm = 34.1553, GNorm = 1.0498, lr_0 = 1.0000e-04
Validation rmse = nan
Epoch 44
Validation rmse = nan
Epoch 45
Validation rmse = nan
Epoch 46
Validation rmse = nan
Epoch 47
Validation rmse = nan
Epoch 48
Validation rmse = nan
Epoch 49
Loss = 1.7730e-01, PNorm = 34.1663, GNorm = 1.8647, lr_0 = 1.0000e-04
Validation rmse = nan
Epoch 50
Validation rmse = nan
Epoch 51
Validation rmse = nan
Epoch 52
Validation rmse = nan
Epoch 53
Validation rmse = nan
Epoch 54
Validation rmse = nan
Epoch 55
Validation rmse = nan
Epoch 56
Loss = 1.5092e-01, PNorm = 34.1784, GNorm = 3.4309, lr_0 = 1.0000e-04
Validation rmse = nan
Epoch 57
Validation rmse = nan
Epoch 58
Validation rmse = nan
Epoch 59
Validation rmse = nan
Model 0 best validation rmse = inf on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.095980
Ensemble test rmse = 0.095980
1-fold cross validation
	Seed 0 ==> test rmse = 0.095980
Overall test rmse = 0.095980 +/- 0.000000
Elapsed time = 0:00:05
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-d9f179e0-d3f3-4cdd-8b18-b3eabb183c9e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/_mecn.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.99, 0.005, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 76 | train size = 75 | val size = 0 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Validation rmse = nan
Epoch 1
Validation rmse = nan
Epoch 2
Validation rmse = nan
Epoch 3
Validation rmse = nan
Epoch 4
Validation rmse = nan
Epoch 5
Validation rmse = nan
Epoch 6
Loss = 4.0068e-01, PNorm = 34.0542, GNorm = 2.0116, lr_0 = 6.2102e-04
Loss = 5.0333e-01, PNorm = 34.0578, GNorm = 1.1515, lr_0 = 5.9685e-04
Validation rmse = nan
Epoch 7
Validation rmse = nan
Epoch 8
Validation rmse = nan
Epoch 9
Validation rmse = nan
Epoch 10
Validation rmse = nan
Epoch 11
Validation rmse = nan
Epoch 12
Validation rmse = nan
Epoch 13
Loss = 3.8326e-01, PNorm = 34.0876, GNorm = 2.6270, lr_0 = 3.5622e-04
Validation rmse = nan
Epoch 14
Validation rmse = nan
Epoch 15
Validation rmse = nan
Epoch 16
Validation rmse = nan
Epoch 17
Validation rmse = nan
Epoch 18
Validation rmse = nan
Epoch 19
Loss = 2.5603e-01, PNorm = 34.1100, GNorm = 1.7204, lr_0 = 2.1261e-04
Validation rmse = nan
Epoch 20
Validation rmse = nan
Epoch 21
Validation rmse = nan
Epoch 22
Validation rmse = nan
Epoch 23
Validation rmse = nan
Epoch 24
Validation rmse = nan
Epoch 25
Validation rmse = nan
Epoch 26
Loss = 2.3824e-01, PNorm = 34.1267, GNorm = 1.9202, lr_0 = 1.2690e-04
Loss = 1.9650e-01, PNorm = 34.1277, GNorm = 0.8034, lr_0 = 1.2196e-04
Validation rmse = nan
Epoch 27
Validation rmse = nan
Epoch 28
Validation rmse = nan
Epoch 29
Validation rmse = nan
Epoch 30
Validation rmse = nan
Epoch 31
Validation rmse = nan
Epoch 32
Validation rmse = nan
Epoch 33
Loss = 2.0529e-01, PNorm = 34.1386, GNorm = 1.0703, lr_0 = 1.0000e-04
Validation rmse = nan
Epoch 34
Validation rmse = nan
Epoch 35
Validation rmse = nan
Epoch 36
Validation rmse = nan
Epoch 37
Validation rmse = nan
Epoch 38
Validation rmse = nan
Epoch 39
Loss = 1.9327e-01, PNorm = 34.1490, GNorm = 4.8811, lr_0 = 1.0000e-04
Validation rmse = nan
Epoch 40
Validation rmse = nan
Epoch 41
Validation rmse = nan
Epoch 42
Validation rmse = nan
Epoch 43
Validation rmse = nan
Epoch 44
Validation rmse = nan
Epoch 45
Validation rmse = nan
Epoch 46
Loss = 1.6450e-01, PNorm = 34.1595, GNorm = 3.9387, lr_0 = 1.0000e-04
Loss = 1.5874e-01, PNorm = 34.1604, GNorm = 1.8888, lr_0 = 1.0000e-04
Validation rmse = nan
Epoch 47
Validation rmse = nan
Epoch 48
Validation rmse = nan
Epoch 49
Validation rmse = nan
Epoch 50
Validation rmse = nan
Epoch 51
Validation rmse = nan
Epoch 52
Validation rmse = nan
Epoch 53
Loss = 1.3338e-01, PNorm = 34.1709, GNorm = 0.5174, lr_0 = 1.0000e-04
Validation rmse = nan
Epoch 54
Validation rmse = nan
Epoch 55
Validation rmse = nan
Epoch 56
Validation rmse = nan
Epoch 57
Validation rmse = nan
Epoch 58
Validation rmse = nan
Epoch 59
Loss = 1.1487e-01, PNorm = 34.1815, GNorm = 0.8358, lr_0 = 1.0000e-04
Validation rmse = nan
Model 0 best validation rmse = inf on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.079696
Ensemble test rmse = 0.079696
1-fold cross validation
	Seed 0 ==> test rmse = 0.079696
Overall test rmse = 0.079696 +/- 0.000000
Elapsed time = 0:00:05
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-d9f179e0-d3f3-4cdd-8b18-b3eabb183c9e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/_mecn.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.99, 0.005, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 71 | train size = 70 | val size = 0 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Validation rmse = nan
Epoch 1
Validation rmse = nan
Epoch 2
Validation rmse = nan
Epoch 3
Validation rmse = nan
Epoch 4
Validation rmse = nan
Epoch 5
Validation rmse = nan
Epoch 6
Validation rmse = nan
Epoch 7
Loss = 6.0504e-01, PNorm = 34.0533, GNorm = 6.2482, lr_0 = 5.7362e-04
Validation rmse = nan
Epoch 8
Validation rmse = nan
Epoch 9
Validation rmse = nan
Epoch 10
Validation rmse = nan
Epoch 11
Validation rmse = nan
Epoch 12
Validation rmse = nan
Epoch 13
Validation rmse = nan
Epoch 14
Loss = 3.5899e-01, PNorm = 34.0818, GNorm = 2.8083, lr_0 = 3.2903e-04
Validation rmse = nan
Epoch 15
Validation rmse = nan
Epoch 16
Validation rmse = nan
Epoch 17
Validation rmse = nan
Epoch 18
Validation rmse = nan
Epoch 19
Validation rmse = nan
Epoch 20
Validation rmse = nan
Epoch 21
Loss = 3.1754e-01, PNorm = 34.1026, GNorm = 1.5469, lr_0 = 1.8874e-04
Loss = 3.2870e-01, PNorm = 34.1040, GNorm = 1.0185, lr_0 = 1.8139e-04
Validation rmse = nan
Epoch 22
Validation rmse = nan
Epoch 23
Validation rmse = nan
Epoch 24
Validation rmse = nan
Epoch 25
Validation rmse = nan
Epoch 26
Validation rmse = nan
Epoch 27
Validation rmse = nan
Epoch 28
Loss = 3.2099e-01, PNorm = 34.1183, GNorm = 0.5647, lr_0 = 1.0826e-04
Loss = 1.6261e-01, PNorm = 34.1192, GNorm = 1.5415, lr_0 = 1.0405e-04
Validation rmse = nan
Epoch 29
Validation rmse = nan
Epoch 30
Validation rmse = nan
Epoch 31
Validation rmse = nan
Epoch 32
Validation rmse = nan
Epoch 33
Validation rmse = nan
Epoch 34
Validation rmse = nan
Epoch 35
Loss = 2.3510e-01, PNorm = 34.1297, GNorm = 0.6180, lr_0 = 1.0000e-04
Loss = 2.8570e-01, PNorm = 34.1306, GNorm = 5.1475, lr_0 = 1.0000e-04
Validation rmse = nan
Epoch 36
Validation rmse = nan
Epoch 37
Validation rmse = nan
Epoch 38
Validation rmse = nan
Epoch 39
Validation rmse = nan
Epoch 40
Validation rmse = nan
Epoch 41
Validation rmse = nan
Epoch 42
Loss = 2.2149e-01, PNorm = 34.1431, GNorm = 6.6091, lr_0 = 1.0000e-04
Validation rmse = nan
Epoch 43
Validation rmse = nan
Epoch 44
Validation rmse = nan
Epoch 45
Validation rmse = nan
Epoch 46
Validation rmse = nan
Epoch 47
Validation rmse = nan
Epoch 48
Validation rmse = nan
Epoch 49
Loss = 2.0128e-01, PNorm = 34.1545, GNorm = 1.2343, lr_0 = 1.0000e-04
Validation rmse = nan
Epoch 50
Validation rmse = nan
Epoch 51
Validation rmse = nan
Epoch 52
Validation rmse = nan
Epoch 53
Validation rmse = nan
Epoch 54
Validation rmse = nan
Epoch 55
Validation rmse = nan
Epoch 56
Validation rmse = nan
Epoch 57
Loss = 1.8105e-01, PNorm = 34.1669, GNorm = 1.5186, lr_0 = 1.0000e-04
Validation rmse = nan
Epoch 58
Validation rmse = nan
Epoch 59
Validation rmse = nan
Model 0 best validation rmse = inf on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.074353
Ensemble test rmse = 0.074353
1-fold cross validation
	Seed 0 ==> test rmse = 0.074353
Overall test rmse = 0.074353 +/- 0.000000
Elapsed time = 0:00:05
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-d9f179e0-d3f3-4cdd-8b18-b3eabb183c9e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/_mecn.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.99, 0.005, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 66 | train size = 65 | val size = 0 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Validation rmse = nan
Epoch 1
Validation rmse = nan
Epoch 2
Validation rmse = nan
Epoch 3
Validation rmse = nan
Epoch 4
Validation rmse = nan
Epoch 5
Validation rmse = nan
Epoch 6
Validation rmse = nan
Epoch 7
Loss = 4.8400e-01, PNorm = 34.0618, GNorm = 1.9894, lr_0 = 5.7362e-04
Loss = 3.9643e-01, PNorm = 34.0649, GNorm = 8.0825, lr_0 = 5.5129e-04
Validation rmse = nan
Epoch 8
Validation rmse = nan
Epoch 9
Validation rmse = nan
Epoch 10
Validation rmse = nan
Epoch 11
Validation rmse = nan
Epoch 12
Validation rmse = nan
Epoch 13
Validation rmse = nan
Epoch 14
Validation rmse = nan
Epoch 15
Loss = 3.7006e-01, PNorm = 34.0974, GNorm = 1.7514, lr_0 = 3.0392e-04
Loss = 3.2315e-01, PNorm = 34.0990, GNorm = 8.5191, lr_0 = 2.9209e-04
Validation rmse = nan
Epoch 16
Validation rmse = nan
Epoch 17
Validation rmse = nan
Epoch 18
Validation rmse = nan
Epoch 19
Validation rmse = nan
Epoch 20
Validation rmse = nan
Epoch 21
Validation rmse = nan
Epoch 22
Validation rmse = nan
Epoch 23
Loss = 3.1267e-01, PNorm = 34.1184, GNorm = 2.6135, lr_0 = 1.6103e-04
Validation rmse = nan
Epoch 24
Validation rmse = nan
Epoch 25
Validation rmse = nan
Epoch 26
Validation rmse = nan
Epoch 27
Validation rmse = nan
Epoch 28
Validation rmse = nan
Epoch 29
Validation rmse = nan
Epoch 30
Loss = 2.2118e-01, PNorm = 34.1304, GNorm = 1.8802, lr_0 = 1.0000e-04
Loss = 3.2875e-01, PNorm = 34.1312, GNorm = 2.5263, lr_0 = 1.0000e-04
Validation rmse = nan
Epoch 31
Validation rmse = nan
Epoch 32
Validation rmse = nan
Epoch 33
Validation rmse = nan
Epoch 34
Validation rmse = nan
Epoch 35
Validation rmse = nan
Epoch 36
Validation rmse = nan
Epoch 37
Validation rmse = nan
Epoch 38
Loss = 2.6064e-01, PNorm = 34.1427, GNorm = 1.4942, lr_0 = 1.0000e-04
Loss = 7.6729e-02, PNorm = 34.1435, GNorm = 1.6437, lr_0 = 1.0000e-04
Validation rmse = nan
Epoch 39
Validation rmse = nan
Epoch 40
Validation rmse = nan
Epoch 41
Validation rmse = nan
Epoch 42
Validation rmse = nan
Epoch 43
Validation rmse = nan
Epoch 44
Validation rmse = nan
Epoch 45
Validation rmse = nan
Epoch 46
Loss = 2.0590e-01, PNorm = 34.1551, GNorm = 3.8036, lr_0 = 1.0000e-04
Validation rmse = nan
Epoch 47
Validation rmse = nan
Epoch 48
Validation rmse = nan
Epoch 49
Validation rmse = nan
Epoch 50
Validation rmse = nan
Epoch 51
Validation rmse = nan
Epoch 52
Validation rmse = nan
Epoch 53
Loss = 1.7613e-01, PNorm = 34.1675, GNorm = 1.4976, lr_0 = 1.0000e-04
Validation rmse = nan
Epoch 54
Validation rmse = nan
Epoch 55
Validation rmse = nan
Epoch 56
Validation rmse = nan
Epoch 57
Validation rmse = nan
Epoch 58
Validation rmse = nan
Epoch 59
Validation rmse = nan
Model 0 best validation rmse = inf on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.049612
Ensemble test rmse = 0.049612
1-fold cross validation
	Seed 0 ==> test rmse = 0.049612
Overall test rmse = 0.049612 +/- 0.000000
Elapsed time = 0:00:05
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-d9f179e0-d3f3-4cdd-8b18-b3eabb183c9e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/_mecn.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.99, 0.005, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 146 | train size = 144 | val size = 1 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Validation rmse = 0.318613
Epoch 1
Validation rmse = 0.212154
Epoch 2
Validation rmse = 0.251800
Epoch 3
Loss = 6.6695e-01, PNorm = 34.0437, GNorm = 2.5461, lr_0 = 8.5317e-04
Validation rmse = 0.199529
Epoch 4
Validation rmse = 0.278703
Epoch 5
Validation rmse = 0.203560
Epoch 6
Loss = 5.4835e-01, PNorm = 34.0907, GNorm = 4.3346, lr_0 = 6.9956e-04
Validation rmse = 0.256955
Epoch 7
Validation rmse = 0.215679
Epoch 8
Validation rmse = 0.266386
Epoch 9
Validation rmse = 0.259755
Epoch 10
Loss = 3.9094e-01, PNorm = 34.1416, GNorm = 5.6885, lr_0 = 5.6234e-04
Validation rmse = 0.237770
Epoch 11
Validation rmse = 0.265128
Epoch 12
Validation rmse = 0.213201
Epoch 13
Loss = 3.5495e-01, PNorm = 34.1798, GNorm = 5.7266, lr_0 = 4.6110e-04
Validation rmse = 0.278729
Epoch 14
Validation rmse = 0.221943
Epoch 15
Validation rmse = 0.255494
Epoch 16
Validation rmse = 0.239883
Epoch 17
Loss = 2.9032e-01, PNorm = 34.2125, GNorm = 3.0352, lr_0 = 3.7065e-04
Validation rmse = 0.258595
Epoch 18
Validation rmse = 0.219943
Epoch 19
Validation rmse = 0.254694
Epoch 20
Loss = 2.6731e-01, PNorm = 34.2357, GNorm = 2.0481, lr_0 = 3.0392e-04
Validation rmse = 0.219238
Epoch 21
Validation rmse = 0.230341
Epoch 22
Validation rmse = 0.217131
Epoch 23
Validation rmse = 0.226211
Epoch 24
Loss = 3.7819e-01, PNorm = 34.2545, GNorm = 1.2110, lr_0 = 2.4920e-04
Validation rmse = 0.224996
Epoch 25
Validation rmse = 0.208658
Epoch 26
Validation rmse = 0.232071
Epoch 27
Loss = 2.2888e-01, PNorm = 34.2703, GNorm = 1.8091, lr_0 = 2.0032e-04
Validation rmse = 0.208939
Epoch 28
Validation rmse = 0.232885
Epoch 29
Validation rmse = 0.206019
Epoch 30
Validation rmse = 0.191335
Epoch 31
Loss = 1.7456e-01, PNorm = 34.2812, GNorm = 2.8487, lr_0 = 1.6425e-04
Validation rmse = 0.225962
Epoch 32
Validation rmse = 0.214121
Epoch 33
Validation rmse = 0.206551
Epoch 34
Loss = 2.0757e-01, PNorm = 34.2913, GNorm = 1.0566, lr_0 = 1.3204e-04
Validation rmse = 0.217911
Epoch 35
Validation rmse = 0.202954
Epoch 36
Validation rmse = 0.201986
Epoch 37
Validation rmse = 0.214391
Epoch 38
Loss = 3.4920e-01, PNorm = 34.2987, GNorm = 3.7216, lr_0 = 1.0826e-04
Validation rmse = 0.203224
Epoch 39
Validation rmse = 0.204423
Epoch 40
Validation rmse = 0.208802
Epoch 41
Loss = 2.4108e-01, PNorm = 34.3047, GNorm = 3.6803, lr_0 = 1.0000e-04
Loss = 1.1662e-01, PNorm = 34.3053, GNorm = 1.0639, lr_0 = 1.0000e-04
Validation rmse = 0.210433
Epoch 42
Validation rmse = 0.194613
Epoch 43
Validation rmse = 0.198454
Epoch 44
Validation rmse = 0.211156
Epoch 45
Loss = 1.8268e-01, PNorm = 34.3114, GNorm = 1.9223, lr_0 = 1.0000e-04
Validation rmse = 0.193931
Epoch 46
Validation rmse = 0.201549
Epoch 47
Validation rmse = 0.201789
Epoch 48
Loss = 2.3635e-01, PNorm = 34.3172, GNorm = 3.2355, lr_0 = 1.0000e-04
Validation rmse = 0.198695
Epoch 49
Validation rmse = 0.177370
Epoch 50
Validation rmse = 0.219201
Epoch 51
Validation rmse = 0.193753
Epoch 52
Loss = 1.1231e-01, PNorm = 34.3236, GNorm = 0.4957, lr_0 = 1.0000e-04
Validation rmse = 0.182721
Epoch 53
Validation rmse = 0.203133
Epoch 54
Validation rmse = 0.189316
Epoch 55
Loss = 2.1992e-01, PNorm = 34.3294, GNorm = 1.1718, lr_0 = 1.0000e-04
Validation rmse = 0.189543
Epoch 56
Validation rmse = 0.193425
Epoch 57
Validation rmse = 0.190496
Epoch 58
Validation rmse = 0.194000
Epoch 59
Loss = 2.8747e-01, PNorm = 34.3361, GNorm = 2.2153, lr_0 = 1.0000e-04
Validation rmse = 0.204249
Model 0 best validation rmse = 0.177370 on epoch 49
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.056719
Ensemble test rmse = 0.056719
1-fold cross validation
	Seed 0 ==> test rmse = 0.056719
Overall test rmse = 0.056719 +/- 0.000000
Elapsed time = 0:00:06
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-d9f179e0-d3f3-4cdd-8b18-b3eabb183c9e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/_mecn.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.99, 0.005, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 141 | train size = 139 | val size = 1 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Validation rmse = 0.089776
Epoch 1
Validation rmse = 0.038169
Epoch 2
Validation rmse = 0.086102
Epoch 3
Loss = 6.1342e-01, PNorm = 34.0446, GNorm = 4.9308, lr_0 = 8.5317e-04
Validation rmse = 0.022174
Epoch 4
Validation rmse = 0.015233
Epoch 5
Validation rmse = 0.104535
Epoch 6
Validation rmse = 0.008162
Epoch 7
Loss = 3.5577e-01, PNorm = 34.0898, GNorm = 2.9688, lr_0 = 6.8581e-04
Validation rmse = 0.053561
Epoch 8
Validation rmse = 0.102890
Epoch 9
Validation rmse = 0.005815
Epoch 10
Loss = 3.9922e-01, PNorm = 34.1324, GNorm = 1.2857, lr_0 = 5.5129e-04
Validation rmse = 0.074970
Epoch 11
Validation rmse = 0.051270
Epoch 12
Validation rmse = 0.028663
Epoch 13
Validation rmse = 0.098606
Epoch 14
Loss = 2.8905e-01, PNorm = 34.1738, GNorm = 2.3172, lr_0 = 4.4315e-04
Validation rmse = 0.015631
Epoch 15
Validation rmse = 0.089401
Epoch 16
Validation rmse = 0.049819
Epoch 17
Loss = 2.1379e-01, PNorm = 34.2050, GNorm = 1.3319, lr_0 = 3.6337e-04
Validation rmse = 0.053473
Epoch 18
Validation rmse = 0.066956
Epoch 19
Validation rmse = 0.059963
Epoch 20
Validation rmse = 0.067460
Epoch 21
Loss = 1.7754e-01, PNorm = 34.2333, GNorm = 0.5599, lr_0 = 2.9209e-04
Validation rmse = 0.072751
Epoch 22
Validation rmse = 0.066578
Epoch 23
Validation rmse = 0.077505
Epoch 24
Validation rmse = 0.056569
Epoch 25
Loss = 1.8603e-01, PNorm = 34.2538, GNorm = 0.8415, lr_0 = 2.3480e-04
Validation rmse = 0.053378
Epoch 26
Validation rmse = 0.073163
Epoch 27
Validation rmse = 0.025574
Epoch 28
Loss = 1.5105e-01, PNorm = 34.2682, GNorm = 3.7196, lr_0 = 1.8874e-04
Validation rmse = 0.065009
Epoch 29
Validation rmse = 0.043912
Epoch 30
Validation rmse = 0.057577
Epoch 31
Validation rmse = 0.066785
Epoch 32
Loss = 1.2655e-01, PNorm = 34.2792, GNorm = 0.8707, lr_0 = 1.5172e-04
Validation rmse = 0.043723
Epoch 33
Validation rmse = 0.056861
Epoch 34
Validation rmse = 0.048145
Epoch 35
Loss = 1.2505e-01, PNorm = 34.2873, GNorm = 2.2165, lr_0 = 1.2440e-04
Validation rmse = 0.058120
Epoch 36
Validation rmse = 0.052717
Epoch 37
Validation rmse = 0.037380
Epoch 38
Validation rmse = 0.053428
Epoch 39
Loss = 1.2996e-01, PNorm = 34.2941, GNorm = 4.4365, lr_0 = 1.0000e-04
Validation rmse = 0.053333
Epoch 40
Validation rmse = 0.028318
Epoch 41
Validation rmse = 0.035285
Epoch 42
Validation rmse = 0.056918
Epoch 43
Loss = 1.0412e-01, PNorm = 34.2998, GNorm = 0.7729, lr_0 = 1.0000e-04
Validation rmse = 0.044848
Epoch 44
Validation rmse = 0.020131
Epoch 45
Validation rmse = 0.058138
Epoch 46
Loss = 1.2314e-01, PNorm = 34.3049, GNorm = 6.2220, lr_0 = 1.0000e-04
Validation rmse = 0.051924
Epoch 47
Validation rmse = 0.018230
Epoch 48
Validation rmse = 0.048165
Epoch 49
Validation rmse = 0.054658
Epoch 50
Loss = 1.3196e-01, PNorm = 34.3097, GNorm = 1.1024, lr_0 = 1.0000e-04
Validation rmse = 0.027791
Epoch 51
Validation rmse = 0.029403
Epoch 52
Validation rmse = 0.067796
Epoch 53
Loss = 1.1811e-01, PNorm = 34.3146, GNorm = 7.6373, lr_0 = 1.0000e-04
Validation rmse = 0.028029
Epoch 54
Validation rmse = 0.005092
Epoch 55
Validation rmse = 0.074223
Epoch 56
Validation rmse = 0.041596
Epoch 57
Loss = 9.8578e-02, PNorm = 34.3193, GNorm = 1.5093, lr_0 = 1.0000e-04
Validation rmse = 0.004814
Epoch 58
Validation rmse = 0.056152
Epoch 59
Validation rmse = 0.043927
Model 0 best validation rmse = 0.004814 on epoch 57
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.052134
Ensemble test rmse = 0.052134
1-fold cross validation
	Seed 0 ==> test rmse = 0.052134
Overall test rmse = 0.052134 +/- 0.000000
Elapsed time = 0:00:06
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-d9f179e0-d3f3-4cdd-8b18-b3eabb183c9e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/_mecn.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.99, 0.005, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 136 | train size = 134 | val size = 1 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Validation rmse = 0.259973
Epoch 1
Validation rmse = 0.037922
Epoch 2
Validation rmse = 0.144853
Epoch 3
Loss = 5.8369e-01, PNorm = 34.0491, GNorm = 1.3166, lr_0 = 8.5317e-04
Loss = 8.3050e-01, PNorm = 34.0529, GNorm = 9.9273, lr_0 = 8.3640e-04
Validation rmse = 0.041179
Epoch 4
Validation rmse = 0.077912
Epoch 5
Validation rmse = 0.056803
Epoch 6
Validation rmse = 0.066703
Epoch 7
Loss = 3.8362e-01, PNorm = 34.1017, GNorm = 2.8058, lr_0 = 6.7234e-04
Validation rmse = 0.012299
Epoch 8
Validation rmse = 0.049793
Epoch 9
Validation rmse = 0.028006
Epoch 10
Validation rmse = 0.006902
Epoch 11
Loss = 2.8633e-01, PNorm = 34.1492, GNorm = 3.3307, lr_0 = 5.4045e-04
Validation rmse = 0.017838
Epoch 12
Validation rmse = 0.043101
Epoch 13
Validation rmse = 0.045428
Epoch 14
Loss = 2.3958e-01, PNorm = 34.1912, GNorm = 7.7704, lr_0 = 4.3444e-04
Validation rmse = 0.064822
Epoch 15
Validation rmse = 0.002847
Epoch 16
Validation rmse = 0.049025
Epoch 17
Validation rmse = 0.013179
Epoch 18
Loss = 1.7176e-01, PNorm = 34.2165, GNorm = 5.1557, lr_0 = 3.4922e-04
Loss = 1.7725e-01, PNorm = 34.2184, GNorm = 4.0498, lr_0 = 3.4236e-04
Validation rmse = 0.044105
Epoch 19
Validation rmse = 0.010083
Epoch 20
Validation rmse = 0.041984
Epoch 21
Validation rmse = 0.019292
Epoch 22
Loss = 1.3313e-01, PNorm = 34.2369, GNorm = 1.2428, lr_0 = 2.7520e-04
Validation rmse = 0.007786
Epoch 23
Validation rmse = 0.014137
Epoch 24
Validation rmse = 0.030462
Epoch 25
Validation rmse = 0.023314
Epoch 26
Loss = 1.2888e-01, PNorm = 34.2513, GNorm = 1.0275, lr_0 = 2.2122e-04
Validation rmse = 0.024458
Epoch 27
Validation rmse = 0.022577
Epoch 28
Validation rmse = 0.020662
Epoch 29
Loss = 1.0640e-01, PNorm = 34.2625, GNorm = 0.7247, lr_0 = 1.7783e-04
Validation rmse = 0.034554
Epoch 30
Validation rmse = 0.035390
Epoch 31
Validation rmse = 0.038846
Epoch 32
Validation rmse = 0.028775
Epoch 33
Loss = 1.0547e-01, PNorm = 34.2710, GNorm = 3.9421, lr_0 = 1.4295e-04
Validation rmse = 0.042057
Epoch 34
Validation rmse = 0.039733
Epoch 35
Validation rmse = 0.021095
Epoch 36
Validation rmse = 0.049072
Epoch 37
Loss = 1.0196e-01, PNorm = 34.2777, GNorm = 0.7651, lr_0 = 1.1491e-04
Validation rmse = 0.053661
Epoch 38
Validation rmse = 0.020968
Epoch 39
Validation rmse = 0.038149
Epoch 40
Validation rmse = 0.057499
Epoch 41
Loss = 1.0039e-01, PNorm = 34.2830, GNorm = 5.4207, lr_0 = 1.0000e-04
Validation rmse = 0.041875
Epoch 42
Validation rmse = 0.033497
Epoch 43
Validation rmse = 0.040394
Epoch 44
Loss = 9.3482e-02, PNorm = 34.2877, GNorm = 6.1156, lr_0 = 1.0000e-04
Validation rmse = 0.041994
Epoch 45
Validation rmse = 0.033233
Epoch 46
Validation rmse = 0.041275
Epoch 47
Validation rmse = 0.056636
Epoch 48
Loss = 9.1067e-02, PNorm = 34.2922, GNorm = 0.9334, lr_0 = 1.0000e-04
Validation rmse = 0.037070
Epoch 49
Validation rmse = 0.036595
Epoch 50
Validation rmse = 0.048045
Epoch 51
Validation rmse = 0.036149
Epoch 52
Loss = 9.0909e-02, PNorm = 34.2968, GNorm = 2.5454, lr_0 = 1.0000e-04
Validation rmse = 0.050537
Epoch 53
Validation rmse = 0.045257
Epoch 54
Validation rmse = 0.045190
Epoch 55
Loss = 8.8410e-02, PNorm = 34.3014, GNorm = 5.7627, lr_0 = 1.0000e-04
Validation rmse = 0.043695
Epoch 56
Validation rmse = 0.053777
Epoch 57
Validation rmse = 0.040402
Epoch 58
Validation rmse = 0.050743
Epoch 59
Loss = 8.1399e-02, PNorm = 34.3060, GNorm = 3.3488, lr_0 = 1.0000e-04
Loss = 8.7229e-02, PNorm = 34.3064, GNorm = 0.7029, lr_0 = 1.0000e-04
Validation rmse = 0.053086
Model 0 best validation rmse = 0.002847 on epoch 15
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.043424
Ensemble test rmse = 0.043424
1-fold cross validation
	Seed 0 ==> test rmse = 0.043424
Overall test rmse = 0.043424 +/- 0.000000
Elapsed time = 0:00:06
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-d9f179e0-d3f3-4cdd-8b18-b3eabb183c9e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/_mecn.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.99, 0.005, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 131 | train size = 129 | val size = 1 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Validation rmse = 0.005381
Epoch 1
Validation rmse = 0.016341
Epoch 2
Validation rmse = 0.025910
Epoch 3
Loss = 5.5385e-01, PNorm = 34.0584, GNorm = 5.9209, lr_0 = 8.3640e-04
Validation rmse = 0.069421
Epoch 4
Validation rmse = 0.023067
Epoch 5
Validation rmse = 0.001977
Epoch 6
Validation rmse = 0.018022
Epoch 7
Loss = 3.0263e-01, PNorm = 34.1198, GNorm = 6.6352, lr_0 = 6.7234e-04
Loss = 3.0506e-01, PNorm = 34.1256, GNorm = 1.8023, lr_0 = 6.5912e-04
Validation rmse = 0.065827
Epoch 8
Validation rmse = 0.044846
Epoch 9
Validation rmse = 0.033687
Epoch 10
Validation rmse = 0.008540
Epoch 11
Loss = 1.8334e-01, PNorm = 34.1737, GNorm = 1.3299, lr_0 = 5.2983e-04
Loss = 2.3670e-01, PNorm = 34.1771, GNorm = 5.5123, lr_0 = 5.1942e-04
Validation rmse = 0.024541
Epoch 12
Validation rmse = 0.049718
Epoch 13
Validation rmse = 0.019764
Epoch 14
Validation rmse = 0.043173
Epoch 15
Loss = 1.3300e-01, PNorm = 34.2100, GNorm = 1.2361, lr_0 = 4.1753e-04
Validation rmse = 0.017502
Epoch 16
Validation rmse = 0.049746
Epoch 17
Validation rmse = 0.067401
Epoch 18
Validation rmse = 0.051446
Epoch 19
Loss = 1.0541e-01, PNorm = 34.2327, GNorm = 2.0822, lr_0 = 3.3563e-04
Validation rmse = 0.065095
Epoch 20
Validation rmse = 0.073392
Epoch 21
Validation rmse = 0.088964
Epoch 22
Validation rmse = 0.071190
Epoch 23
Loss = 9.7683e-02, PNorm = 34.2510, GNorm = 1.9760, lr_0 = 2.6449e-04
Validation rmse = 0.088214
Epoch 24
Validation rmse = 0.083712
Epoch 25
Validation rmse = 0.115733
Epoch 26
Validation rmse = 0.072634
Epoch 27
Loss = 1.0398e-01, PNorm = 34.2639, GNorm = 4.1271, lr_0 = 2.0843e-04
Validation rmse = 0.078152
Epoch 28
Validation rmse = 0.092697
Epoch 29
Validation rmse = 0.078098
Epoch 30
Validation rmse = 0.090710
Epoch 31
Loss = 8.0603e-02, PNorm = 34.2735, GNorm = 1.0577, lr_0 = 1.6425e-04
Validation rmse = 0.125499
Epoch 32
Validation rmse = 0.062917
Epoch 33
Validation rmse = 0.101734
Epoch 34
Loss = 7.9699e-02, PNorm = 34.2797, GNorm = 1.3635, lr_0 = 1.3204e-04
Validation rmse = 0.090989
Epoch 35
Validation rmse = 0.095338
Epoch 36
Validation rmse = 0.107195
Epoch 37
Validation rmse = 0.091056
Epoch 38
Loss = 8.3716e-02, PNorm = 34.2848, GNorm = 4.4218, lr_0 = 1.0614e-04
Loss = 6.4599e-02, PNorm = 34.2852, GNorm = 1.3287, lr_0 = 1.0405e-04
Validation rmse = 0.099711
Epoch 39
Validation rmse = 0.103962
Epoch 40
Validation rmse = 0.096659
Epoch 41
Validation rmse = 0.099339
Epoch 42
Loss = 7.3580e-02, PNorm = 34.2895, GNorm = 3.5551, lr_0 = 1.0000e-04
Loss = 9.4961e-02, PNorm = 34.2899, GNorm = 3.6910, lr_0 = 1.0000e-04
Validation rmse = 0.113650
Epoch 43
Validation rmse = 0.085923
Epoch 44
Validation rmse = 0.099680
Epoch 45
Validation rmse = 0.092933
Epoch 46
Loss = 7.0826e-02, PNorm = 34.2940, GNorm = 1.0557, lr_0 = 1.0000e-04
Validation rmse = 0.112483
Epoch 47
Validation rmse = 0.084092
Epoch 48
Validation rmse = 0.106369
Epoch 49
Validation rmse = 0.111331
Epoch 50
Loss = 8.3202e-02, PNorm = 34.2979, GNorm = 0.5213, lr_0 = 1.0000e-04
Validation rmse = 0.092717
Epoch 51
Validation rmse = 0.095583
Epoch 52
Validation rmse = 0.104886
Epoch 53
Validation rmse = 0.086890
Epoch 54
Loss = 8.1718e-02, PNorm = 34.3024, GNorm = 2.8424, lr_0 = 1.0000e-04
Validation rmse = 0.104709
Epoch 55
Validation rmse = 0.092781
Epoch 56
Validation rmse = 0.098164
Epoch 57
Validation rmse = 0.106882
Epoch 58
Loss = 6.8462e-02, PNorm = 34.3070, GNorm = 1.2047, lr_0 = 1.0000e-04
Validation rmse = 0.095218
Epoch 59
Validation rmse = 0.098422
Model 0 best validation rmse = 0.001977 on epoch 5
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.089014
Ensemble test rmse = 0.089014
1-fold cross validation
	Seed 0 ==> test rmse = 0.089014
Overall test rmse = 0.089014 +/- 0.000000
Elapsed time = 0:00:06
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-d9f179e0-d3f3-4cdd-8b18-b3eabb183c9e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/_mecn.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.99, 0.005, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 126 | train size = 124 | val size = 1 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Validation rmse = 0.169058
Epoch 1
Validation rmse = 0.174417
Epoch 2
Validation rmse = 0.158354
Epoch 3
Validation rmse = 0.238519
Epoch 4
Loss = 6.9831e-01, PNorm = 34.0523, GNorm = 6.5081, lr_0 = 8.1996e-04
Validation rmse = 0.137787
Epoch 5
Validation rmse = 0.163114
Epoch 6
Validation rmse = 0.187516
Epoch 7
Validation rmse = 0.117219
Epoch 8
Loss = 3.6104e-01, PNorm = 34.1013, GNorm = 2.8493, lr_0 = 6.4617e-04
Validation rmse = 0.131349
Epoch 9
Validation rmse = 0.162122
Epoch 10
Validation rmse = 0.093871
Epoch 11
Validation rmse = 0.125228
Epoch 12
Loss = 3.2089e-01, PNorm = 34.1453, GNorm = 1.1565, lr_0 = 5.0921e-04
Validation rmse = 0.118751
Epoch 13
Validation rmse = 0.060234
Epoch 14
Validation rmse = 0.098142
Epoch 15
Validation rmse = 0.085499
Epoch 16
Loss = 1.9470e-01, PNorm = 34.1858, GNorm = 1.5163, lr_0 = 4.0128e-04
Validation rmse = 0.084773
Epoch 17
Validation rmse = 0.058603
Epoch 18
Validation rmse = 0.064684
Epoch 19
Validation rmse = 0.061430
Epoch 20
Loss = 1.7035e-01, PNorm = 34.2181, GNorm = 5.2232, lr_0 = 3.1623e-04
Validation rmse = 0.068642
Epoch 21
Validation rmse = 0.037722
Epoch 22
Validation rmse = 0.048145
Epoch 23
Validation rmse = 0.044409
Epoch 24
Loss = 1.7295e-01, PNorm = 34.2391, GNorm = 2.5270, lr_0 = 2.4920e-04
Validation rmse = 0.019274
Epoch 25
Validation rmse = 0.068841
Epoch 26
Validation rmse = 0.025823
Epoch 27
Validation rmse = 0.024129
Epoch 28
Loss = 1.4024e-01, PNorm = 34.2527, GNorm = 3.7104, lr_0 = 1.9638e-04
Validation rmse = 0.078033
Epoch 29
Validation rmse = 0.037847
Epoch 30
Validation rmse = 0.002453
Epoch 31
Validation rmse = 0.055592
Epoch 32
Loss = 1.3277e-01, PNorm = 34.2631, GNorm = 5.2610, lr_0 = 1.5476e-04
Validation rmse = 0.056104
Epoch 33
Validation rmse = 0.006919
Epoch 34
Validation rmse = 0.020363
Epoch 35
Validation rmse = 0.056565
Epoch 36
Loss = 1.1686e-01, PNorm = 34.2708, GNorm = 3.8004, lr_0 = 1.2196e-04
Validation rmse = 0.034801
Epoch 37
Validation rmse = 0.013105
Epoch 38
Validation rmse = 0.026161
Epoch 39
Validation rmse = 0.035199
Epoch 40
Loss = 1.0725e-01, PNorm = 34.2772, GNorm = 1.6759, lr_0 = 1.0000e-04
Validation rmse = 0.033138
Epoch 41
Validation rmse = 0.015153
Epoch 42
Validation rmse = 0.017840
Epoch 43
Validation rmse = 0.026753
Epoch 44
Loss = 1.1750e-01, PNorm = 34.2833, GNorm = 1.1918, lr_0 = 1.0000e-04
Validation rmse = 0.026411
Epoch 45
Validation rmse = 0.023217
Epoch 46
Validation rmse = 0.016712
Epoch 47
Validation rmse = 0.019068
Epoch 48
Loss = 8.6285e-02, PNorm = 34.2896, GNorm = 0.9273, lr_0 = 1.0000e-04
Validation rmse = 0.022880
Epoch 49
Validation rmse = 0.025839
Epoch 50
Validation rmse = 0.015572
Epoch 51
Validation rmse = 0.027743
Epoch 52
Loss = 1.0857e-01, PNorm = 34.2964, GNorm = 2.3234, lr_0 = 1.0000e-04
Validation rmse = 0.024102
Epoch 53
Validation rmse = 0.013803
Epoch 54
Validation rmse = 0.017254
Epoch 55
Validation rmse = 0.019650
Epoch 56
Loss = 9.2881e-02, PNorm = 34.3031, GNorm = 0.5817, lr_0 = 1.0000e-04
Validation rmse = 0.009068
Epoch 57
Validation rmse = 0.012400
Epoch 58
Validation rmse = 0.025814
Epoch 59
Validation rmse = 0.009679
Model 0 best validation rmse = 0.002453 on epoch 30
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.036193
Ensemble test rmse = 0.036193
1-fold cross validation
	Seed 0 ==> test rmse = 0.036193
Overall test rmse = 0.036193 +/- 0.000000
Elapsed time = 0:00:06
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-d9f179e0-d3f3-4cdd-8b18-b3eabb183c9e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/_mecn.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.99, 0.005, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 121 | train size = 119 | val size = 1 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Validation rmse = 0.239635
Epoch 1
Validation rmse = 0.015162
Epoch 2
Validation rmse = 0.091867
Epoch 3
Validation rmse = 0.113176
Epoch 4
Loss = 6.5872e-01, PNorm = 34.0493, GNorm = 4.1738, lr_0 = 8.1996e-04
Validation rmse = 0.024865
Epoch 5
Validation rmse = 0.023402
Epoch 6
Validation rmse = 0.040603
Epoch 7
Validation rmse = 0.001961
Epoch 8
Loss = 3.4177e-01, PNorm = 34.1055, GNorm = 1.0313, lr_0 = 6.4617e-04
Validation rmse = 0.040367
Epoch 9
Validation rmse = 0.002093
Epoch 10
Validation rmse = 0.068271
Epoch 11
Validation rmse = 0.030353
Epoch 12
Loss = 2.7602e-01, PNorm = 34.1566, GNorm = 3.8516, lr_0 = 4.9920e-04
Loss = 1.5946e-01, PNorm = 34.1598, GNorm = 2.3901, lr_0 = 4.8939e-04
Validation rmse = 0.052569
Epoch 13
Validation rmse = 0.028077
Epoch 14
Validation rmse = 0.043066
Epoch 15
Validation rmse = 0.098374
Epoch 16
Loss = 2.0263e-01, PNorm = 34.1902, GNorm = 5.6349, lr_0 = 3.9339e-04
Loss = 1.4265e-01, PNorm = 34.1923, GNorm = 1.0137, lr_0 = 3.8566e-04
Validation rmse = 0.052432
Epoch 17
Validation rmse = 0.057777
Epoch 18
Validation rmse = 0.050204
Epoch 19
Validation rmse = 0.072587
Epoch 20
Validation rmse = 0.085377
Epoch 21
Loss = 1.3167e-01, PNorm = 34.2142, GNorm = 3.4950, lr_0 = 2.9795e-04
Validation rmse = 0.055135
Epoch 22
Validation rmse = 0.054426
Epoch 23
Validation rmse = 0.057155
Epoch 24
Validation rmse = 0.071176
Epoch 25
Loss = 1.1205e-01, PNorm = 34.2293, GNorm = 0.4591, lr_0 = 2.3480e-04
Validation rmse = 0.077015
Epoch 26
Validation rmse = 0.071203
Epoch 27
Validation rmse = 0.061861
Epoch 28
Validation rmse = 0.060807
Epoch 29
Loss = 1.1788e-01, PNorm = 34.2419, GNorm = 0.6784, lr_0 = 1.8503e-04
Validation rmse = 0.073327
Epoch 30
Validation rmse = 0.073796
Epoch 31
Validation rmse = 0.075859
Epoch 32
Validation rmse = 0.072847
Epoch 33
Loss = 9.4273e-02, PNorm = 34.2524, GNorm = 2.0247, lr_0 = 1.4295e-04
Loss = 1.3025e-01, PNorm = 34.2530, GNorm = 1.9175, lr_0 = 1.4014e-04
Validation rmse = 0.055884
Epoch 34
Validation rmse = 0.067566
Epoch 35
Validation rmse = 0.073244
Epoch 36
Validation rmse = 0.068114
Epoch 37
Loss = 9.4525e-02, PNorm = 34.2597, GNorm = 2.5967, lr_0 = 1.1265e-04
Loss = 1.0847e-01, PNorm = 34.2603, GNorm = 1.7786, lr_0 = 1.1043e-04
Validation rmse = 0.088801
Epoch 38
Validation rmse = 0.084323
Epoch 39
Validation rmse = 0.069814
Epoch 40
Validation rmse = 0.076645
Epoch 41
Validation rmse = 0.091185
Epoch 42
Loss = 1.0100e-01, PNorm = 34.2672, GNorm = 2.3375, lr_0 = 1.0000e-04
Validation rmse = 0.085919
Epoch 43
Validation rmse = 0.070360
Epoch 44
Validation rmse = 0.076611
Epoch 45
Validation rmse = 0.084639
Epoch 46
Loss = 1.0043e-01, PNorm = 34.2735, GNorm = 2.0319, lr_0 = 1.0000e-04
Validation rmse = 0.075773
Epoch 47
Validation rmse = 0.075836
Epoch 48
Validation rmse = 0.096149
Epoch 49
Validation rmse = 0.084568
Epoch 50
Loss = 8.6076e-02, PNorm = 34.2796, GNorm = 2.4496, lr_0 = 1.0000e-04
Validation rmse = 0.074926
Epoch 51
Validation rmse = 0.072444
Epoch 52
Validation rmse = 0.089530
Epoch 53
Validation rmse = 0.088058
Epoch 54
Loss = 6.9549e-02, PNorm = 34.2865, GNorm = 1.0160, lr_0 = 1.0000e-04
Loss = 1.3484e-01, PNorm = 34.2870, GNorm = 3.9690, lr_0 = 1.0000e-04
Validation rmse = 0.077970
Epoch 55
Validation rmse = 0.096811
Epoch 56
Validation rmse = 0.093677
Epoch 57
Validation rmse = 0.075808
Epoch 58
Loss = 8.4124e-02, PNorm = 34.2931, GNorm = 2.1555, lr_0 = 1.0000e-04
Loss = 5.2979e-02, PNorm = 34.2936, GNorm = 0.6757, lr_0 = 1.0000e-04
Validation rmse = 0.086156
Epoch 59
Validation rmse = 0.088357
Model 0 best validation rmse = 0.001961 on epoch 7
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.161613
Ensemble test rmse = 0.161613
1-fold cross validation
	Seed 0 ==> test rmse = 0.161613
Overall test rmse = 0.161613 +/- 0.000000
Elapsed time = 0:00:05
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_mecn.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 146 | train size = 144 | val size = 1 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.318614
Epoch 1
Validation rmse = 0.212154
Epoch 2
Validation rmse = 0.251800
Epoch 3
Loss = 6.6695e-01, PNorm = 34.0438, GNorm = 2.5464, lr_0 = 8.5317e-04
Validation rmse = 0.199545
Epoch 4
Validation rmse = 0.278772
Epoch 5
Validation rmse = 0.203189
Epoch 6
Loss = 5.4867e-01, PNorm = 34.0907, GNorm = 4.3482, lr_0 = 6.9956e-04
Validation rmse = 0.257401
Epoch 7
Validation rmse = 0.215062
Epoch 8
Validation rmse = 0.266655
Epoch 9
Validation rmse = 0.258911
Epoch 10
Loss = 3.8990e-01, PNorm = 34.1417, GNorm = 5.6339, lr_0 = 5.6234e-04
Validation rmse = 0.238661
Epoch 11
Validation rmse = 0.264683
Epoch 12
Validation rmse = 0.213457
Epoch 13
Loss = 3.5408e-01, PNorm = 34.1800, GNorm = 5.6814, lr_0 = 4.6110e-04
Validation rmse = 0.278819
Epoch 14
Validation rmse = 0.223180
Epoch 15
Validation rmse = 0.257051
Epoch 16
Validation rmse = 0.241129
Epoch 17
Loss = 2.8965e-01, PNorm = 34.2127, GNorm = 3.0832, lr_0 = 3.7065e-04
Validation rmse = 0.260894
Epoch 18
Validation rmse = 0.220757
Epoch 19
Validation rmse = 0.256475
Epoch 20
Loss = 2.6730e-01, PNorm = 34.2358, GNorm = 2.1850, lr_0 = 3.0392e-04
Validation rmse = 0.219622
Epoch 21
Validation rmse = 0.232089
Epoch 22
Validation rmse = 0.217284
Epoch 23
Validation rmse = 0.227778
Epoch 24
Loss = 3.7697e-01, PNorm = 34.2541, GNorm = 1.1339, lr_0 = 2.4920e-04
Validation rmse = 0.225425
Epoch 25
Validation rmse = 0.209339
Epoch 26
Validation rmse = 0.234290
Epoch 27
Loss = 2.2890e-01, PNorm = 34.2698, GNorm = 1.8641, lr_0 = 2.0032e-04
Validation rmse = 0.209330
Epoch 28
Validation rmse = 0.234451
Epoch 29
Validation rmse = 0.207146
Epoch 30
Validation rmse = 0.191552
Epoch 31
Loss = 1.7392e-01, PNorm = 34.2807, GNorm = 2.9066, lr_0 = 1.6425e-04
Validation rmse = 0.227509
Epoch 32
Validation rmse = 0.215368
Epoch 33
Validation rmse = 0.206256
Epoch 34
Loss = 2.0752e-01, PNorm = 34.2905, GNorm = 1.0721, lr_0 = 1.3204e-04
Validation rmse = 0.219014
Epoch 35
Validation rmse = 0.203406
Epoch 36
Validation rmse = 0.201728
Epoch 37
Validation rmse = 0.215069
Epoch 38
Loss = 3.4973e-01, PNorm = 34.2978, GNorm = 3.8169, lr_0 = 1.0826e-04
Validation rmse = 0.203683
Epoch 39
Validation rmse = 0.203876
Epoch 40
Validation rmse = 0.208607
Epoch 41
Loss = 2.4054e-01, PNorm = 34.3037, GNorm = 3.6283, lr_0 = 1.0000e-04
Loss = 1.1723e-01, PNorm = 34.3043, GNorm = 1.0696, lr_0 = 1.0000e-04
Validation rmse = 0.210435
Epoch 42
Validation rmse = 0.194335
Epoch 43
Validation rmse = 0.198704
Epoch 44
Validation rmse = 0.212211
Epoch 45
Loss = 1.8197e-01, PNorm = 34.3103, GNorm = 1.9999, lr_0 = 1.0000e-04
Validation rmse = 0.194493
Epoch 46
Validation rmse = 0.202433
Epoch 47
Validation rmse = 0.202159
Epoch 48
Loss = 2.3590e-01, PNorm = 34.3160, GNorm = 3.1302, lr_0 = 1.0000e-04
Validation rmse = 0.199445
Epoch 49
Validation rmse = 0.178343
Epoch 50
Validation rmse = 0.219917
Epoch 51
Validation rmse = 0.194262
Epoch 52
Loss = 1.1254e-01, PNorm = 34.3224, GNorm = 0.5105, lr_0 = 1.0000e-04
Validation rmse = 0.184207
Epoch 53
Validation rmse = 0.204420
Epoch 54
Validation rmse = 0.189911
Epoch 55
Loss = 2.1945e-01, PNorm = 34.3282, GNorm = 1.1968, lr_0 = 1.0000e-04
Validation rmse = 0.191412
Epoch 56
Validation rmse = 0.194810
Epoch 57
Validation rmse = 0.191746
Epoch 58
Validation rmse = 0.195678
Epoch 59
Loss = 2.8852e-01, PNorm = 34.3347, GNorm = 2.1853, lr_0 = 1.0000e-04
Validation rmse = 0.204972
Model 0 best validation rmse = 0.178343 on epoch 49
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.054939
Ensemble test rmse = 0.054939
1-fold cross validation
	Seed 0 ==> test rmse = 0.054939
Overall test rmse = 0.054939 +/- 0.000000
Elapsed time = 0:00:10
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_mecn.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 141 | train size = 139 | val size = 1 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.222717
Epoch 1
Validation rmse = 0.120743
Epoch 2
Validation rmse = 0.126584
Epoch 3
Loss = 6.1895e-01, PNorm = 34.0432, GNorm = 2.7962, lr_0 = 8.5317e-04
Validation rmse = 0.091783
Epoch 4
Validation rmse = 0.168170
Epoch 5
Validation rmse = 0.071159
Epoch 6
Validation rmse = 0.083747
Epoch 7
Loss = 5.3241e-01, PNorm = 34.0862, GNorm = 1.6542, lr_0 = 6.8581e-04
Validation rmse = 0.140720
Epoch 8
Validation rmse = 0.061297
Epoch 9
Validation rmse = 0.058934
Epoch 10
Loss = 4.0535e-01, PNorm = 34.1299, GNorm = 4.2010, lr_0 = 5.5129e-04
Validation rmse = 0.089006
Epoch 11
Validation rmse = 0.016399
Epoch 12
Validation rmse = 0.052327
Epoch 13
Validation rmse = 0.023117
Epoch 14
Loss = 2.7697e-01, PNorm = 34.1735, GNorm = 1.6293, lr_0 = 4.4315e-04
Validation rmse = 0.018435
Epoch 15
Validation rmse = 0.005524
Epoch 16
Validation rmse = 0.013171
Epoch 17
Loss = 2.3173e-01, PNorm = 34.2085, GNorm = 1.0949, lr_0 = 3.6337e-04
Validation rmse = 0.025709
Epoch 18
Validation rmse = 0.022916
Epoch 19
Validation rmse = 0.000317
Epoch 20
Validation rmse = 0.010637
Epoch 21
Loss = 1.6592e-01, PNorm = 34.2349, GNorm = 4.6823, lr_0 = 2.9209e-04
Validation rmse = 0.012036
Epoch 22
Validation rmse = 0.000555
Epoch 23
Validation rmse = 0.018233
Epoch 24
Validation rmse = 0.006185
Epoch 25
Loss = 1.7128e-01, PNorm = 34.2543, GNorm = 1.5059, lr_0 = 2.3480e-04
Validation rmse = 0.003925
Epoch 26
Validation rmse = 0.002311
Epoch 27
Validation rmse = 0.017601
Epoch 28
Loss = 1.4979e-01, PNorm = 34.2681, GNorm = 5.6752, lr_0 = 1.8874e-04
Validation rmse = 0.012668
Epoch 29
Validation rmse = 0.017261
Epoch 30
Validation rmse = 0.009654
Epoch 31
Validation rmse = 0.000051
Epoch 32
Loss = 1.2381e-01, PNorm = 34.2780, GNorm = 3.1287, lr_0 = 1.5172e-04
Validation rmse = 0.013644
Epoch 33
Validation rmse = 0.006353
Epoch 34
Validation rmse = 0.006443
Epoch 35
Loss = 1.2685e-01, PNorm = 34.2852, GNorm = 5.4398, lr_0 = 1.2440e-04
Validation rmse = 0.013762
Epoch 36
Validation rmse = 0.007396
Epoch 37
Validation rmse = 0.005817
Epoch 38
Validation rmse = 0.009941
Epoch 39
Loss = 1.3324e-01, PNorm = 34.2916, GNorm = 3.7941, lr_0 = 1.0000e-04
Validation rmse = 0.007138
Epoch 40
Validation rmse = 0.010052
Epoch 41
Validation rmse = 0.008605
Epoch 42
Validation rmse = 0.004913
Epoch 43
Loss = 1.0879e-01, PNorm = 34.2972, GNorm = 0.4927, lr_0 = 1.0000e-04
Validation rmse = 0.000998
Epoch 44
Validation rmse = 0.011433
Epoch 45
Validation rmse = 0.005947
Epoch 46
Loss = 1.1504e-01, PNorm = 34.3026, GNorm = 1.7472, lr_0 = 1.0000e-04
Validation rmse = 0.000710
Epoch 47
Validation rmse = 0.007013
Epoch 48
Validation rmse = 0.002472
Epoch 49
Validation rmse = 0.004524
Epoch 50
Loss = 1.1522e-01, PNorm = 34.3078, GNorm = 1.0352, lr_0 = 1.0000e-04
Validation rmse = 0.002027
Epoch 51
Validation rmse = 0.016775
Epoch 52
Validation rmse = 0.010716
Epoch 53
Loss = 1.1415e-01, PNorm = 34.3132, GNorm = 3.5666, lr_0 = 1.0000e-04
Validation rmse = 0.002728
Epoch 54
Validation rmse = 0.015868
Epoch 55
Validation rmse = 0.012916
Epoch 56
Validation rmse = 0.002395
Epoch 57
Loss = 9.3443e-02, PNorm = 34.3182, GNorm = 2.9832, lr_0 = 1.0000e-04
Validation rmse = 0.011730
Epoch 58
Validation rmse = 0.006771
Epoch 59
Validation rmse = 0.004384
Model 0 best validation rmse = 0.000051 on epoch 31
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.100176
Ensemble test rmse = 0.100176
1-fold cross validation
	Seed 0 ==> test rmse = 0.100176
Overall test rmse = 0.100176 +/- 0.000000
Elapsed time = 0:00:08
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_mecn.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 136 | train size = 134 | val size = 1 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.097906
Epoch 1
Validation rmse = 0.019941
Epoch 2
Validation rmse = 0.173558
Epoch 3
Loss = 6.3978e-01, PNorm = 34.0509, GNorm = 5.6667, lr_0 = 8.5317e-04
Loss = 5.7007e-01, PNorm = 34.0562, GNorm = 2.9069, lr_0 = 8.3640e-04
Validation rmse = 0.016001
Epoch 4
Validation rmse = 0.146354
Epoch 5
Validation rmse = 0.109292
Epoch 6
Validation rmse = 0.012093
Epoch 7
Loss = 5.9230e-01, PNorm = 34.1014, GNorm = 6.3494, lr_0 = 6.7234e-04
Validation rmse = 0.089251
Epoch 8
Validation rmse = 0.115437
Epoch 9
Validation rmse = 0.011816
Epoch 10
Validation rmse = 0.058569
Epoch 11
Loss = 3.8366e-01, PNorm = 34.1422, GNorm = 2.5465, lr_0 = 5.4045e-04
Validation rmse = 0.098865
Epoch 12
Validation rmse = 0.012153
Epoch 13
Validation rmse = 0.061314
Epoch 14
Loss = 2.4630e-01, PNorm = 34.1801, GNorm = 4.2291, lr_0 = 4.3444e-04
Validation rmse = 0.079101
Epoch 15
Validation rmse = 0.019057
Epoch 16
Validation rmse = 0.066612
Epoch 17
Validation rmse = 0.051243
Epoch 18
Loss = 1.4833e-01, PNorm = 34.2128, GNorm = 0.9052, lr_0 = 3.4922e-04
Loss = 2.7244e-01, PNorm = 34.2154, GNorm = 3.2125, lr_0 = 3.4236e-04
Validation rmse = 0.012650
Epoch 19
Validation rmse = 0.056357
Epoch 20
Validation rmse = 0.026681
Epoch 21
Validation rmse = 0.023213
Epoch 22
Loss = 1.5231e-01, PNorm = 34.2407, GNorm = 1.4166, lr_0 = 2.7520e-04
Validation rmse = 0.035668
Epoch 23
Validation rmse = 0.023230
Epoch 24
Validation rmse = 0.028399
Epoch 25
Validation rmse = 0.017498
Epoch 26
Loss = 1.5371e-01, PNorm = 34.2596, GNorm = 4.1801, lr_0 = 2.2122e-04
Validation rmse = 0.020341
Epoch 27
Validation rmse = 0.026478
Epoch 28
Validation rmse = 0.032516
Epoch 29
Loss = 1.2017e-01, PNorm = 34.2733, GNorm = 3.3007, lr_0 = 1.7783e-04
Validation rmse = 0.018274
Epoch 30
Validation rmse = 0.028962
Epoch 31
Validation rmse = 0.028630
Epoch 32
Validation rmse = 0.027384
Epoch 33
Loss = 1.1084e-01, PNorm = 34.2841, GNorm = 0.5618, lr_0 = 1.4295e-04
Validation rmse = 0.025388
Epoch 34
Validation rmse = 0.025269
Epoch 35
Validation rmse = 0.033124
Epoch 36
Validation rmse = 0.019952
Epoch 37
Loss = 1.3098e-01, PNorm = 34.2921, GNorm = 2.7908, lr_0 = 1.1491e-04
Validation rmse = 0.025556
Epoch 38
Validation rmse = 0.037304
Epoch 39
Validation rmse = 0.025077
Epoch 40
Validation rmse = 0.025361
Epoch 41
Loss = 8.2832e-02, PNorm = 34.2986, GNorm = 0.8047, lr_0 = 1.0000e-04
Validation rmse = 0.040617
Epoch 42
Validation rmse = 0.029216
Epoch 43
Validation rmse = 0.020280
Epoch 44
Loss = 9.4161e-02, PNorm = 34.3043, GNorm = 1.9675, lr_0 = 1.0000e-04
Validation rmse = 0.033370
Epoch 45
Validation rmse = 0.039060
Epoch 46
Validation rmse = 0.024770
Epoch 47
Validation rmse = 0.025967
Epoch 48
Loss = 9.6734e-02, PNorm = 34.3100, GNorm = 4.3333, lr_0 = 1.0000e-04
Validation rmse = 0.039109
Epoch 49
Validation rmse = 0.026836
Epoch 50
Validation rmse = 0.033542
Epoch 51
Validation rmse = 0.029730
Epoch 52
Loss = 8.4820e-02, PNorm = 34.3154, GNorm = 0.8154, lr_0 = 1.0000e-04
Validation rmse = 0.026638
Epoch 53
Validation rmse = 0.035664
Epoch 54
Validation rmse = 0.027505
Epoch 55
Loss = 8.8681e-02, PNorm = 34.3209, GNorm = 0.9643, lr_0 = 1.0000e-04
Validation rmse = 0.034725
Epoch 56
Validation rmse = 0.031287
Epoch 57
Validation rmse = 0.022042
Epoch 58
Validation rmse = 0.031412
Epoch 59
Loss = 8.2265e-02, PNorm = 34.3264, GNorm = 2.6472, lr_0 = 1.0000e-04
Loss = 9.2131e-02, PNorm = 34.3269, GNorm = 3.4342, lr_0 = 1.0000e-04
Validation rmse = 0.032261
Model 0 best validation rmse = 0.011816 on epoch 9
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.097081
Ensemble test rmse = 0.097081
1-fold cross validation
	Seed 0 ==> test rmse = 0.097081
Overall test rmse = 0.097081 +/- 0.000000
Elapsed time = 0:00:07
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_mecn.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 131 | train size = 129 | val size = 1 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.033743
Epoch 1
Validation rmse = 0.204687
Epoch 2
Validation rmse = 0.025141
Epoch 3
Loss = 7.6894e-01, PNorm = 34.0480, GNorm = 2.1505, lr_0 = 8.3640e-04
Validation rmse = 0.103742
Epoch 4
Validation rmse = 0.137418
Epoch 5
Validation rmse = 0.034531
Epoch 6
Validation rmse = 0.047821
Epoch 7
Loss = 5.1880e-01, PNorm = 34.0908, GNorm = 1.9611, lr_0 = 6.7234e-04
Loss = 3.2677e-01, PNorm = 34.0949, GNorm = 2.9410, lr_0 = 6.5912e-04
Validation rmse = 0.083385
Epoch 8
Validation rmse = 0.000186
Epoch 9
Validation rmse = 0.016682
Epoch 10
Validation rmse = 0.012272
Epoch 11
Loss = 3.0990e-01, PNorm = 34.1407, GNorm = 3.3417, lr_0 = 5.2983e-04
Loss = 3.5063e-01, PNorm = 34.1448, GNorm = 3.5952, lr_0 = 5.1942e-04
Validation rmse = 0.002389
Epoch 12
Validation rmse = 0.008202
Epoch 13
Validation rmse = 0.050004
Epoch 14
Validation rmse = 0.018753
Epoch 15
Loss = 2.1275e-01, PNorm = 34.1861, GNorm = 1.4025, lr_0 = 4.1753e-04
Validation rmse = 0.031052
Epoch 16
Validation rmse = 0.008568
Epoch 17
Validation rmse = 0.041149
Epoch 18
Validation rmse = 0.026623
Epoch 19
Loss = 1.8765e-01, PNorm = 34.2158, GNorm = 3.5895, lr_0 = 3.3563e-04
Validation rmse = 0.007941
Epoch 20
Validation rmse = 0.017266
Epoch 21
Validation rmse = 0.022852
Epoch 22
Validation rmse = 0.012147
Epoch 23
Loss = 1.7033e-01, PNorm = 34.2378, GNorm = 3.2120, lr_0 = 2.6449e-04
Validation rmse = 0.008074
Epoch 24
Validation rmse = 0.014414
Epoch 25
Validation rmse = 0.014719
Epoch 26
Validation rmse = 0.018079
Epoch 27
Loss = 1.2181e-01, PNorm = 34.2533, GNorm = 2.6583, lr_0 = 2.0843e-04
Validation rmse = 0.000316
Epoch 28
Validation rmse = 0.005460
Epoch 29
Validation rmse = 0.014438
Epoch 30
Validation rmse = 0.019717
Epoch 31
Loss = 1.1353e-01, PNorm = 34.2655, GNorm = 1.5684, lr_0 = 1.6425e-04
Validation rmse = 0.003759
Epoch 32
Validation rmse = 0.003907
Epoch 33
Validation rmse = 0.017487
Epoch 34
Loss = 1.0503e-01, PNorm = 34.2737, GNorm = 0.6212, lr_0 = 1.3204e-04
Validation rmse = 0.009648
Epoch 35
Validation rmse = 0.011075
Epoch 36
Validation rmse = 0.000541
Epoch 37
Validation rmse = 0.001103
Epoch 38
Loss = 1.0196e-01, PNorm = 34.2803, GNorm = 1.2279, lr_0 = 1.0614e-04
Loss = 1.2844e-01, PNorm = 34.2808, GNorm = 9.2607, lr_0 = 1.0405e-04
Validation rmse = 0.010961
Epoch 39
Validation rmse = 0.026176
Epoch 40
Validation rmse = 0.004384
Epoch 41
Validation rmse = 0.008208
Epoch 42
Loss = 9.6882e-02, PNorm = 34.2858, GNorm = 1.2280, lr_0 = 1.0000e-04
Loss = 1.2059e-01, PNorm = 34.2862, GNorm = 6.1884, lr_0 = 1.0000e-04
Validation rmse = 0.007402
Epoch 43
Validation rmse = 0.003601
Epoch 44
Validation rmse = 0.011687
Epoch 45
Validation rmse = 0.013101
Epoch 46
Loss = 9.2421e-02, PNorm = 34.2913, GNorm = 1.1004, lr_0 = 1.0000e-04
Validation rmse = 0.005933
Epoch 47
Validation rmse = 0.010389
Epoch 48
Validation rmse = 0.006178
Epoch 49
Validation rmse = 0.006565
Epoch 50
Loss = 1.2308e-01, PNorm = 34.2962, GNorm = 1.6776, lr_0 = 1.0000e-04
Validation rmse = 0.010954
Epoch 51
Validation rmse = 0.014100
Epoch 52
Validation rmse = 0.009954
Epoch 53
Validation rmse = 0.012797
Epoch 54
Loss = 8.7815e-02, PNorm = 34.3015, GNorm = 1.5193, lr_0 = 1.0000e-04
Validation rmse = 0.003460
Epoch 55
Validation rmse = 0.001787
Epoch 56
Validation rmse = 0.016560
Epoch 57
Validation rmse = 0.000480
Epoch 58
Loss = 9.4749e-02, PNorm = 34.3069, GNorm = 2.2780, lr_0 = 1.0000e-04
Validation rmse = 0.003650
Epoch 59
Validation rmse = 0.017304
Model 0 best validation rmse = 0.000186 on epoch 8
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.024293
Ensemble test rmse = 0.024293
1-fold cross validation
	Seed 0 ==> test rmse = 0.024293
Overall test rmse = 0.024293 +/- 0.000000
Elapsed time = 0:00:07
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_mecn.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 126 | train size = 124 | val size = 1 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.253875
Epoch 1
Validation rmse = 0.107908
Epoch 2
Validation rmse = 0.181935
Epoch 3
Validation rmse = 0.160105
Epoch 4
Loss = 5.2320e-01, PNorm = 34.0536, GNorm = 0.9442, lr_0 = 8.1996e-04
Validation rmse = 0.122533
Epoch 5
Validation rmse = 0.142844
Epoch 6
Validation rmse = 0.091028
Epoch 7
Validation rmse = 0.170155
Epoch 8
Loss = 3.3028e-01, PNorm = 34.1039, GNorm = 4.2352, lr_0 = 6.4617e-04
Validation rmse = 0.154601
Epoch 9
Validation rmse = 0.075966
Epoch 10
Validation rmse = 0.171820
Epoch 11
Validation rmse = 0.145174
Epoch 12
Loss = 3.3327e-01, PNorm = 34.1412, GNorm = 4.5469, lr_0 = 5.0921e-04
Validation rmse = 0.088506
Epoch 13
Validation rmse = 0.128287
Epoch 14
Validation rmse = 0.107586
Epoch 15
Validation rmse = 0.074788
Epoch 16
Loss = 1.9484e-01, PNorm = 34.1748, GNorm = 2.8115, lr_0 = 4.0128e-04
Validation rmse = 0.104399
Epoch 17
Validation rmse = 0.077276
Epoch 18
Validation rmse = 0.062851
Epoch 19
Validation rmse = 0.080632
Epoch 20
Loss = 2.0240e-01, PNorm = 34.2033, GNorm = 3.7314, lr_0 = 3.1623e-04
Validation rmse = 0.062313
Epoch 21
Validation rmse = 0.064097
Epoch 22
Validation rmse = 0.045141
Epoch 23
Validation rmse = 0.050394
Epoch 24
Loss = 1.5759e-01, PNorm = 34.2251, GNorm = 1.8405, lr_0 = 2.4920e-04
Validation rmse = 0.052801
Epoch 25
Validation rmse = 0.034633
Epoch 26
Validation rmse = 0.054084
Epoch 27
Validation rmse = 0.040807
Epoch 28
Loss = 1.1056e-01, PNorm = 34.2417, GNorm = 0.7330, lr_0 = 1.9638e-04
Validation rmse = 0.037898
Epoch 29
Validation rmse = 0.037216
Epoch 30
Validation rmse = 0.025420
Epoch 31
Validation rmse = 0.032802
Epoch 32
Loss = 8.9823e-02, PNorm = 34.2543, GNorm = 0.5401, lr_0 = 1.5476e-04
Validation rmse = 0.028003
Epoch 33
Validation rmse = 0.041022
Epoch 34
Validation rmse = 0.036691
Epoch 35
Validation rmse = 0.029290
Epoch 36
Loss = 1.1228e-01, PNorm = 34.2639, GNorm = 0.4174, lr_0 = 1.2196e-04
Validation rmse = 0.025966
Epoch 37
Validation rmse = 0.033864
Epoch 38
Validation rmse = 0.032652
Epoch 39
Validation rmse = 0.028385
Epoch 40
Loss = 1.0215e-01, PNorm = 34.2711, GNorm = 0.6912, lr_0 = 1.0000e-04
Validation rmse = 0.030257
Epoch 41
Validation rmse = 0.036218
Epoch 42
Validation rmse = 0.023151
Epoch 43
Validation rmse = 0.021903
Epoch 44
Loss = 8.4354e-02, PNorm = 34.2775, GNorm = 0.3536, lr_0 = 1.0000e-04
Validation rmse = 0.034121
Epoch 45
Validation rmse = 0.030504
Epoch 46
Validation rmse = 0.024529
Epoch 47
Validation rmse = 0.028973
Epoch 48
Loss = 8.9222e-02, PNorm = 34.2840, GNorm = 0.7737, lr_0 = 1.0000e-04
Validation rmse = 0.033349
Epoch 49
Validation rmse = 0.014603
Epoch 50
Validation rmse = 0.025452
Epoch 51
Validation rmse = 0.040442
Epoch 52
Loss = 1.0742e-01, PNorm = 34.2910, GNorm = 2.3664, lr_0 = 1.0000e-04
Validation rmse = 0.026528
Epoch 53
Validation rmse = 0.027261
Epoch 54
Validation rmse = 0.029624
Epoch 55
Validation rmse = 0.021600
Epoch 56
Loss = 8.8228e-02, PNorm = 34.2978, GNorm = 1.8398, lr_0 = 1.0000e-04
Validation rmse = 0.014474
Epoch 57
Validation rmse = 0.023089
Epoch 58
Validation rmse = 0.030865
Epoch 59
Validation rmse = 0.033108
Model 0 best validation rmse = 0.014474 on epoch 56
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.048579
Ensemble test rmse = 0.048579
1-fold cross validation
	Seed 0 ==> test rmse = 0.048579
Overall test rmse = 0.048579 +/- 0.000000
Elapsed time = 0:00:07
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_mecn.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 121 | train size = 119 | val size = 1 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.174138
Epoch 1
Validation rmse = 0.162241
Epoch 2
Validation rmse = 0.211111
Epoch 3
Validation rmse = 0.164735
Epoch 4
Loss = 4.8371e-01, PNorm = 34.0574, GNorm = 2.9695, lr_0 = 8.1996e-04
Validation rmse = 0.251294
Epoch 5
Validation rmse = 0.103327
Epoch 6
Validation rmse = 0.196939
Epoch 7
Validation rmse = 0.169070
Epoch 8
Loss = 2.5603e-01, PNorm = 34.1048, GNorm = 3.1839, lr_0 = 6.4617e-04
Validation rmse = 0.128354
Epoch 9
Validation rmse = 0.206954
Epoch 10
Validation rmse = 0.107965
Epoch 11
Validation rmse = 0.145919
Epoch 12
Loss = 2.4477e-01, PNorm = 34.1484, GNorm = 6.2404, lr_0 = 4.9920e-04
Loss = 1.5961e-01, PNorm = 34.1512, GNorm = 1.5550, lr_0 = 4.8939e-04
Validation rmse = 0.145370
Epoch 13
Validation rmse = 0.114617
Epoch 14
Validation rmse = 0.165413
Epoch 15
Validation rmse = 0.082585
Epoch 16
Loss = 1.8492e-01, PNorm = 34.1780, GNorm = 2.0799, lr_0 = 3.9339e-04
Loss = 9.3914e-02, PNorm = 34.1801, GNorm = 1.6595, lr_0 = 3.8566e-04
Validation rmse = 0.139171
Epoch 17
Validation rmse = 0.087542
Epoch 18
Validation rmse = 0.122463
Epoch 19
Validation rmse = 0.110583
Epoch 20
Validation rmse = 0.091953
Epoch 21
Loss = 1.2458e-01, PNorm = 34.2051, GNorm = 3.1020, lr_0 = 2.9795e-04
Validation rmse = 0.105716
Epoch 22
Validation rmse = 0.081000
Epoch 23
Validation rmse = 0.104840
Epoch 24
Validation rmse = 0.084147
Epoch 25
Loss = 1.0337e-01, PNorm = 34.2238, GNorm = 0.9291, lr_0 = 2.3480e-04
Validation rmse = 0.087506
Epoch 26
Validation rmse = 0.105732
Epoch 27
Validation rmse = 0.074778
Epoch 28
Validation rmse = 0.100893
Epoch 29
Loss = 9.9796e-02, PNorm = 34.2371, GNorm = 0.5133, lr_0 = 1.8503e-04
Validation rmse = 0.082067
Epoch 30
Validation rmse = 0.067064
Epoch 31
Validation rmse = 0.094864
Epoch 32
Validation rmse = 0.078660
Epoch 33
Loss = 7.9186e-02, PNorm = 34.2468, GNorm = 0.9858, lr_0 = 1.4295e-04
Loss = 1.1470e-01, PNorm = 34.2474, GNorm = 4.3517, lr_0 = 1.4014e-04
Validation rmse = 0.071247
Epoch 34
Validation rmse = 0.073897
Epoch 35
Validation rmse = 0.091472
Epoch 36
Validation rmse = 0.086129
Epoch 37
Loss = 8.5262e-02, PNorm = 34.2535, GNorm = 2.2295, lr_0 = 1.1265e-04
Loss = 6.6964e-02, PNorm = 34.2539, GNorm = 4.4626, lr_0 = 1.1043e-04
Validation rmse = 0.080712
Epoch 38
Validation rmse = 0.090584
Epoch 39
Validation rmse = 0.071174
Epoch 40
Validation rmse = 0.075338
Epoch 41
Validation rmse = 0.088787
Epoch 42
Loss = 8.0778e-02, PNorm = 34.2595, GNorm = 1.4783, lr_0 = 1.0000e-04
Validation rmse = 0.080995
Epoch 43
Validation rmse = 0.081819
Epoch 44
Validation rmse = 0.090657
Epoch 45
Validation rmse = 0.072852
Epoch 46
Loss = 7.8571e-02, PNorm = 34.2645, GNorm = 1.9881, lr_0 = 1.0000e-04
Validation rmse = 0.086972
Epoch 47
Validation rmse = 0.094227
Epoch 48
Validation rmse = 0.078562
Epoch 49
Validation rmse = 0.073089
Epoch 50
Loss = 6.6559e-02, PNorm = 34.2695, GNorm = 0.3606, lr_0 = 1.0000e-04
Validation rmse = 0.091157
Epoch 51
Validation rmse = 0.082350
Epoch 52
Validation rmse = 0.063935
Epoch 53
Validation rmse = 0.101622
Epoch 54
Loss = 7.2886e-02, PNorm = 34.2746, GNorm = 4.1212, lr_0 = 1.0000e-04
Loss = 9.1328e-02, PNorm = 34.2750, GNorm = 2.0986, lr_0 = 1.0000e-04
Validation rmse = 0.090013
Epoch 55
Validation rmse = 0.067910
Epoch 56
Validation rmse = 0.075966
Epoch 57
Validation rmse = 0.086094
Epoch 58
Loss = 6.8622e-02, PNorm = 34.2795, GNorm = 1.5125, lr_0 = 1.0000e-04
Loss = 5.6659e-02, PNorm = 34.2799, GNorm = 0.7108, lr_0 = 1.0000e-04
Validation rmse = 0.069862
Epoch 59
Validation rmse = 0.080081
Model 0 best validation rmse = 0.063935 on epoch 52
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.012108
Ensemble test rmse = 0.012108
1-fold cross validation
	Seed 0 ==> test rmse = 0.012108
Overall test rmse = 0.012108 +/- 0.000000
Elapsed time = 0:00:07
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_mecn.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 146 | train size = 144 | val size = 1 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.318614
Epoch 1
Validation rmse = 0.212154
Epoch 2
Validation rmse = 0.251800
Epoch 3
Loss = 6.6695e-01, PNorm = 34.0438, GNorm = 2.5464, lr_0 = 8.5317e-04
Validation rmse = 0.199545
Epoch 4
Validation rmse = 0.278772
Epoch 5
Validation rmse = 0.203189
Epoch 6
Loss = 5.4867e-01, PNorm = 34.0907, GNorm = 4.3482, lr_0 = 6.9956e-04
Validation rmse = 0.257401
Epoch 7
Validation rmse = 0.215062
Epoch 8
Validation rmse = 0.266655
Epoch 9
Validation rmse = 0.258911
Epoch 10
Loss = 3.8990e-01, PNorm = 34.1417, GNorm = 5.6339, lr_0 = 5.6234e-04
Validation rmse = 0.238661
Epoch 11
Validation rmse = 0.264683
Epoch 12
Validation rmse = 0.213457
Epoch 13
Loss = 3.5408e-01, PNorm = 34.1800, GNorm = 5.6814, lr_0 = 4.6110e-04
Validation rmse = 0.278819
Epoch 14
Validation rmse = 0.223180
Epoch 15
Validation rmse = 0.257051
Epoch 16
Validation rmse = 0.241129
Epoch 17
Loss = 2.8965e-01, PNorm = 34.2127, GNorm = 3.0832, lr_0 = 3.7065e-04
Validation rmse = 0.260894
Epoch 18
Validation rmse = 0.220757
Epoch 19
Validation rmse = 0.256475
Epoch 20
Loss = 2.6730e-01, PNorm = 34.2358, GNorm = 2.1850, lr_0 = 3.0392e-04
Validation rmse = 0.219622
Epoch 21
Validation rmse = 0.232089
Epoch 22
Validation rmse = 0.217284
Epoch 23
Validation rmse = 0.227778
Epoch 24
Loss = 3.7697e-01, PNorm = 34.2541, GNorm = 1.1339, lr_0 = 2.4920e-04
Validation rmse = 0.225425
Epoch 25
Validation rmse = 0.209339
Epoch 26
Validation rmse = 0.234290
Epoch 27
Loss = 2.2890e-01, PNorm = 34.2698, GNorm = 1.8641, lr_0 = 2.0032e-04
Validation rmse = 0.209330
Epoch 28
Validation rmse = 0.234451
Epoch 29
Validation rmse = 0.207146
Epoch 30
Validation rmse = 0.191552
Epoch 31
Loss = 1.7392e-01, PNorm = 34.2807, GNorm = 2.9066, lr_0 = 1.6425e-04
Validation rmse = 0.227509
Epoch 32
Validation rmse = 0.215368
Epoch 33
Validation rmse = 0.206256
Epoch 34
Loss = 2.0752e-01, PNorm = 34.2905, GNorm = 1.0721, lr_0 = 1.3204e-04
Validation rmse = 0.219014
Epoch 35
Validation rmse = 0.203406
Epoch 36
Validation rmse = 0.201728
Epoch 37
Validation rmse = 0.215069
Epoch 38
Loss = 3.4973e-01, PNorm = 34.2978, GNorm = 3.8169, lr_0 = 1.0826e-04
Validation rmse = 0.203683
Epoch 39
Validation rmse = 0.203876
Epoch 40
Validation rmse = 0.208607
Epoch 41
Loss = 2.4054e-01, PNorm = 34.3037, GNorm = 3.6283, lr_0 = 1.0000e-04
Loss = 1.1723e-01, PNorm = 34.3043, GNorm = 1.0696, lr_0 = 1.0000e-04
Validation rmse = 0.210435
Epoch 42
Validation rmse = 0.194335
Epoch 43
Validation rmse = 0.198704
Epoch 44
Validation rmse = 0.212211
Epoch 45
Loss = 1.8197e-01, PNorm = 34.3103, GNorm = 1.9999, lr_0 = 1.0000e-04
Validation rmse = 0.194493
Epoch 46
Validation rmse = 0.202433
Epoch 47
Validation rmse = 0.202159
Epoch 48
Loss = 2.3590e-01, PNorm = 34.3160, GNorm = 3.1302, lr_0 = 1.0000e-04
Validation rmse = 0.199445
Epoch 49
Validation rmse = 0.178343
Epoch 50
Validation rmse = 0.219917
Epoch 51
Validation rmse = 0.194262
Epoch 52
Loss = 1.1254e-01, PNorm = 34.3224, GNorm = 0.5105, lr_0 = 1.0000e-04
Validation rmse = 0.184207
Epoch 53
Validation rmse = 0.204420
Epoch 54
Validation rmse = 0.189911
Epoch 55
Loss = 2.1945e-01, PNorm = 34.3282, GNorm = 1.1968, lr_0 = 1.0000e-04
Validation rmse = 0.191412
Epoch 56
Validation rmse = 0.194810
Epoch 57
Validation rmse = 0.191746
Epoch 58
Validation rmse = 0.195678
Epoch 59
Loss = 2.8852e-01, PNorm = 34.3347, GNorm = 2.1853, lr_0 = 1.0000e-04
Validation rmse = 0.204972
Model 0 best validation rmse = 0.178343 on epoch 49
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.054939
Ensemble test rmse = 0.054939
1-fold cross validation
	Seed 0 ==> test rmse = 0.054939
Overall test rmse = 0.054939 +/- 0.000000
Elapsed time = 0:00:08
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_mecn.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 141 | train size = 139 | val size = 1 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.222717
Epoch 1
Validation rmse = 0.120743
Epoch 2
Validation rmse = 0.126584
Epoch 3
Loss = 6.1895e-01, PNorm = 34.0432, GNorm = 2.7962, lr_0 = 8.5317e-04
Validation rmse = 0.091783
Epoch 4
Validation rmse = 0.168170
Epoch 5
Validation rmse = 0.071159
Epoch 6
Validation rmse = 0.083747
Epoch 7
Loss = 5.3241e-01, PNorm = 34.0862, GNorm = 1.6542, lr_0 = 6.8581e-04
Validation rmse = 0.140720
Epoch 8
Validation rmse = 0.061297
Epoch 9
Validation rmse = 0.058934
Epoch 10
Loss = 4.0535e-01, PNorm = 34.1299, GNorm = 4.2010, lr_0 = 5.5129e-04
Validation rmse = 0.089006
Epoch 11
Validation rmse = 0.016399
Epoch 12
Validation rmse = 0.052327
Epoch 13
Validation rmse = 0.023117
Epoch 14
Loss = 2.7697e-01, PNorm = 34.1735, GNorm = 1.6293, lr_0 = 4.4315e-04
Validation rmse = 0.018435
Epoch 15
Validation rmse = 0.005524
Epoch 16
Validation rmse = 0.013171
Epoch 17
Loss = 2.3173e-01, PNorm = 34.2085, GNorm = 1.0949, lr_0 = 3.6337e-04
Validation rmse = 0.025709
Epoch 18
Validation rmse = 0.022916
Epoch 19
Validation rmse = 0.000317
Epoch 20
Validation rmse = 0.010637
Epoch 21
Loss = 1.6592e-01, PNorm = 34.2349, GNorm = 4.6823, lr_0 = 2.9209e-04
Validation rmse = 0.012036
Epoch 22
Validation rmse = 0.000555
Epoch 23
Validation rmse = 0.018233
Epoch 24
Validation rmse = 0.006185
Epoch 25
Loss = 1.7128e-01, PNorm = 34.2543, GNorm = 1.5059, lr_0 = 2.3480e-04
Validation rmse = 0.003925
Epoch 26
Validation rmse = 0.002311
Epoch 27
Validation rmse = 0.017601
Epoch 28
Loss = 1.4979e-01, PNorm = 34.2681, GNorm = 5.6752, lr_0 = 1.8874e-04
Validation rmse = 0.012668
Epoch 29
Validation rmse = 0.017261
Epoch 30
Validation rmse = 0.009654
Epoch 31
Validation rmse = 0.000051
Epoch 32
Loss = 1.2381e-01, PNorm = 34.2780, GNorm = 3.1287, lr_0 = 1.5172e-04
Validation rmse = 0.013644
Epoch 33
Validation rmse = 0.006353
Epoch 34
Validation rmse = 0.006443
Epoch 35
Loss = 1.2685e-01, PNorm = 34.2852, GNorm = 5.4398, lr_0 = 1.2440e-04
Validation rmse = 0.013762
Epoch 36
Validation rmse = 0.007396
Epoch 37
Validation rmse = 0.005817
Epoch 38
Validation rmse = 0.009941
Epoch 39
Loss = 1.3324e-01, PNorm = 34.2916, GNorm = 3.7941, lr_0 = 1.0000e-04
Validation rmse = 0.007138
Epoch 40
Validation rmse = 0.010052
Epoch 41
Validation rmse = 0.008605
Epoch 42
Validation rmse = 0.004913
Epoch 43
Loss = 1.0879e-01, PNorm = 34.2972, GNorm = 0.4927, lr_0 = 1.0000e-04
Validation rmse = 0.000998
Epoch 44
Validation rmse = 0.011433
Epoch 45
Validation rmse = 0.005947
Epoch 46
Loss = 1.1504e-01, PNorm = 34.3026, GNorm = 1.7472, lr_0 = 1.0000e-04
Validation rmse = 0.000710
Epoch 47
Validation rmse = 0.007013
Epoch 48
Validation rmse = 0.002472
Epoch 49
Validation rmse = 0.004524
Epoch 50
Loss = 1.1522e-01, PNorm = 34.3078, GNorm = 1.0352, lr_0 = 1.0000e-04
Validation rmse = 0.002027
Epoch 51
Validation rmse = 0.016775
Epoch 52
Validation rmse = 0.010716
Epoch 53
Loss = 1.1415e-01, PNorm = 34.3132, GNorm = 3.5666, lr_0 = 1.0000e-04
Validation rmse = 0.002728
Epoch 54
Validation rmse = 0.015868
Epoch 55
Validation rmse = 0.012916
Epoch 56
Validation rmse = 0.002395
Epoch 57
Loss = 9.3443e-02, PNorm = 34.3182, GNorm = 2.9832, lr_0 = 1.0000e-04
Validation rmse = 0.011730
Epoch 58
Validation rmse = 0.006771
Epoch 59
Validation rmse = 0.004384
Model 0 best validation rmse = 0.000051 on epoch 31
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.100176
Ensemble test rmse = 0.100176
1-fold cross validation
	Seed 0 ==> test rmse = 0.100176
Overall test rmse = 0.100176 +/- 0.000000
Elapsed time = 0:00:07
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_mecn.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 136 | train size = 134 | val size = 1 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.097906
Epoch 1
Validation rmse = 0.019941
Epoch 2
Validation rmse = 0.173558
Epoch 3
Loss = 6.3978e-01, PNorm = 34.0509, GNorm = 5.6667, lr_0 = 8.5317e-04
Loss = 5.7007e-01, PNorm = 34.0562, GNorm = 2.9069, lr_0 = 8.3640e-04
Validation rmse = 0.016001
Epoch 4
Validation rmse = 0.146354
Epoch 5
Validation rmse = 0.109292
Epoch 6
Validation rmse = 0.012093
Epoch 7
Loss = 5.9230e-01, PNorm = 34.1014, GNorm = 6.3494, lr_0 = 6.7234e-04
Validation rmse = 0.089251
Epoch 8
Validation rmse = 0.115437
Epoch 9
Validation rmse = 0.011816
Epoch 10
Validation rmse = 0.058569
Epoch 11
Loss = 3.8366e-01, PNorm = 34.1422, GNorm = 2.5465, lr_0 = 5.4045e-04
Validation rmse = 0.098865
Epoch 12
Validation rmse = 0.012153
Epoch 13
Validation rmse = 0.061314
Epoch 14
Loss = 2.4630e-01, PNorm = 34.1801, GNorm = 4.2291, lr_0 = 4.3444e-04
Validation rmse = 0.079101
Epoch 15
Validation rmse = 0.019057
Epoch 16
Validation rmse = 0.066612
Epoch 17
Validation rmse = 0.051243
Epoch 18
Loss = 1.4833e-01, PNorm = 34.2128, GNorm = 0.9052, lr_0 = 3.4922e-04
Loss = 2.7244e-01, PNorm = 34.2154, GNorm = 3.2125, lr_0 = 3.4236e-04
Validation rmse = 0.012650
Epoch 19
Validation rmse = 0.056357
Epoch 20
Validation rmse = 0.026681
Epoch 21
Validation rmse = 0.023213
Epoch 22
Loss = 1.5231e-01, PNorm = 34.2407, GNorm = 1.4166, lr_0 = 2.7520e-04
Validation rmse = 0.035668
Epoch 23
Validation rmse = 0.023230
Epoch 24
Validation rmse = 0.028399
Epoch 25
Validation rmse = 0.017498
Epoch 26
Loss = 1.5371e-01, PNorm = 34.2596, GNorm = 4.1801, lr_0 = 2.2122e-04
Validation rmse = 0.020341
Epoch 27
Validation rmse = 0.026478
Epoch 28
Validation rmse = 0.032516
Epoch 29
Loss = 1.2017e-01, PNorm = 34.2733, GNorm = 3.3007, lr_0 = 1.7783e-04
Validation rmse = 0.018274
Epoch 30
Validation rmse = 0.028962
Epoch 31
Validation rmse = 0.028630
Epoch 32
Validation rmse = 0.027384
Epoch 33
Loss = 1.1084e-01, PNorm = 34.2841, GNorm = 0.5618, lr_0 = 1.4295e-04
Validation rmse = 0.025388
Epoch 34
Validation rmse = 0.025269
Epoch 35
Validation rmse = 0.033124
Epoch 36
Validation rmse = 0.019952
Epoch 37
Loss = 1.3098e-01, PNorm = 34.2921, GNorm = 2.7908, lr_0 = 1.1491e-04
Validation rmse = 0.025556
Epoch 38
Validation rmse = 0.037304
Epoch 39
Validation rmse = 0.025077
Epoch 40
Validation rmse = 0.025361
Epoch 41
Loss = 8.2832e-02, PNorm = 34.2986, GNorm = 0.8047, lr_0 = 1.0000e-04
Validation rmse = 0.040617
Epoch 42
Validation rmse = 0.029216
Epoch 43
Validation rmse = 0.020280
Epoch 44
Loss = 9.4161e-02, PNorm = 34.3043, GNorm = 1.9675, lr_0 = 1.0000e-04
Validation rmse = 0.033370
Epoch 45
Validation rmse = 0.039060
Epoch 46
Validation rmse = 0.024770
Epoch 47
Validation rmse = 0.025967
Epoch 48
Loss = 9.6734e-02, PNorm = 34.3100, GNorm = 4.3333, lr_0 = 1.0000e-04
Validation rmse = 0.039109
Epoch 49
Validation rmse = 0.026836
Epoch 50
Validation rmse = 0.033542
Epoch 51
Validation rmse = 0.029730
Epoch 52
Loss = 8.4820e-02, PNorm = 34.3154, GNorm = 0.8154, lr_0 = 1.0000e-04
Validation rmse = 0.026638
Epoch 53
Validation rmse = 0.035664
Epoch 54
Validation rmse = 0.027505
Epoch 55
Loss = 8.8681e-02, PNorm = 34.3209, GNorm = 0.9643, lr_0 = 1.0000e-04
Validation rmse = 0.034725
Epoch 56
Validation rmse = 0.031287
Epoch 57
Validation rmse = 0.022042
Epoch 58
Validation rmse = 0.031412
Epoch 59
Loss = 8.2265e-02, PNorm = 34.3264, GNorm = 2.6472, lr_0 = 1.0000e-04
Loss = 9.2131e-02, PNorm = 34.3269, GNorm = 3.4342, lr_0 = 1.0000e-04
Validation rmse = 0.032261
Model 0 best validation rmse = 0.011816 on epoch 9
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.097081
Ensemble test rmse = 0.097081
1-fold cross validation
	Seed 0 ==> test rmse = 0.097081
Overall test rmse = 0.097081 +/- 0.000000
Elapsed time = 0:00:06
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_mecn.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 131 | train size = 129 | val size = 1 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.033743
Epoch 1
Validation rmse = 0.204687
Epoch 2
Validation rmse = 0.025141
Epoch 3
Loss = 7.6894e-01, PNorm = 34.0480, GNorm = 2.1505, lr_0 = 8.3640e-04
Validation rmse = 0.103742
Epoch 4
Validation rmse = 0.137418
Epoch 5
Validation rmse = 0.034531
Epoch 6
Validation rmse = 0.047821
Epoch 7
Loss = 5.1880e-01, PNorm = 34.0908, GNorm = 1.9611, lr_0 = 6.7234e-04
Loss = 3.2677e-01, PNorm = 34.0949, GNorm = 2.9410, lr_0 = 6.5912e-04
Validation rmse = 0.083385
Epoch 8
Validation rmse = 0.000186
Epoch 9
Validation rmse = 0.016682
Epoch 10
Validation rmse = 0.012272
Epoch 11
Loss = 3.0990e-01, PNorm = 34.1407, GNorm = 3.3417, lr_0 = 5.2983e-04
Loss = 3.5063e-01, PNorm = 34.1448, GNorm = 3.5952, lr_0 = 5.1942e-04
Validation rmse = 0.002389
Epoch 12
Validation rmse = 0.008202
Epoch 13
Validation rmse = 0.050004
Epoch 14
Validation rmse = 0.018753
Epoch 15
Loss = 2.1275e-01, PNorm = 34.1861, GNorm = 1.4025, lr_0 = 4.1753e-04
Validation rmse = 0.031052
Epoch 16
Validation rmse = 0.008568
Epoch 17
Validation rmse = 0.041149
Epoch 18
Validation rmse = 0.026623
Epoch 19
Loss = 1.8765e-01, PNorm = 34.2158, GNorm = 3.5895, lr_0 = 3.3563e-04
Validation rmse = 0.007941
Epoch 20
Validation rmse = 0.017266
Epoch 21
Validation rmse = 0.022852
Epoch 22
Validation rmse = 0.012147
Epoch 23
Loss = 1.7033e-01, PNorm = 34.2378, GNorm = 3.2120, lr_0 = 2.6449e-04
Validation rmse = 0.008074
Epoch 24
Validation rmse = 0.014414
Epoch 25
Validation rmse = 0.014719
Epoch 26
Validation rmse = 0.018079
Epoch 27
Loss = 1.2181e-01, PNorm = 34.2533, GNorm = 2.6583, lr_0 = 2.0843e-04
Validation rmse = 0.000316
Epoch 28
Validation rmse = 0.005460
Epoch 29
Validation rmse = 0.014438
Epoch 30
Validation rmse = 0.019717
Epoch 31
Loss = 1.1353e-01, PNorm = 34.2655, GNorm = 1.5684, lr_0 = 1.6425e-04
Validation rmse = 0.003759
Epoch 32
Validation rmse = 0.003907
Epoch 33
Validation rmse = 0.017487
Epoch 34
Loss = 1.0503e-01, PNorm = 34.2737, GNorm = 0.6212, lr_0 = 1.3204e-04
Validation rmse = 0.009648
Epoch 35
Validation rmse = 0.011075
Epoch 36
Validation rmse = 0.000541
Epoch 37
Validation rmse = 0.001103
Epoch 38
Loss = 1.0196e-01, PNorm = 34.2803, GNorm = 1.2279, lr_0 = 1.0614e-04
Loss = 1.2844e-01, PNorm = 34.2808, GNorm = 9.2607, lr_0 = 1.0405e-04
Validation rmse = 0.010961
Epoch 39
Validation rmse = 0.026176
Epoch 40
Validation rmse = 0.004384
Epoch 41
Validation rmse = 0.008208
Epoch 42
Loss = 9.6882e-02, PNorm = 34.2858, GNorm = 1.2280, lr_0 = 1.0000e-04
Loss = 1.2059e-01, PNorm = 34.2862, GNorm = 6.1884, lr_0 = 1.0000e-04
Validation rmse = 0.007402
Epoch 43
Validation rmse = 0.003601
Epoch 44
Validation rmse = 0.011687
Epoch 45
Validation rmse = 0.013101
Epoch 46
Loss = 9.2421e-02, PNorm = 34.2913, GNorm = 1.1004, lr_0 = 1.0000e-04
Validation rmse = 0.005933
Epoch 47
Validation rmse = 0.010389
Epoch 48
Validation rmse = 0.006178
Epoch 49
Validation rmse = 0.006565
Epoch 50
Loss = 1.2308e-01, PNorm = 34.2962, GNorm = 1.6776, lr_0 = 1.0000e-04
Validation rmse = 0.010954
Epoch 51
Validation rmse = 0.014100
Epoch 52
Validation rmse = 0.009954
Epoch 53
Validation rmse = 0.012797
Epoch 54
Loss = 8.7815e-02, PNorm = 34.3015, GNorm = 1.5193, lr_0 = 1.0000e-04
Validation rmse = 0.003460
Epoch 55
Validation rmse = 0.001787
Epoch 56
Validation rmse = 0.016560
Epoch 57
Validation rmse = 0.000480
Epoch 58
Loss = 9.4749e-02, PNorm = 34.3069, GNorm = 2.2780, lr_0 = 1.0000e-04
Validation rmse = 0.003650
Epoch 59
Validation rmse = 0.017304
Model 0 best validation rmse = 0.000186 on epoch 8
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.024293
Ensemble test rmse = 0.024293
1-fold cross validation
	Seed 0 ==> test rmse = 0.024293
Overall test rmse = 0.024293 +/- 0.000000
Elapsed time = 0:00:07
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_mecn.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 126 | train size = 124 | val size = 1 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.253875
Epoch 1
Validation rmse = 0.107908
Epoch 2
Validation rmse = 0.181935
Epoch 3
Validation rmse = 0.160105
Epoch 4
Loss = 5.2320e-01, PNorm = 34.0536, GNorm = 0.9442, lr_0 = 8.1996e-04
Validation rmse = 0.122533
Epoch 5
Validation rmse = 0.142844
Epoch 6
Validation rmse = 0.091028
Epoch 7
Validation rmse = 0.170155
Epoch 8
Loss = 3.3028e-01, PNorm = 34.1039, GNorm = 4.2352, lr_0 = 6.4617e-04
Validation rmse = 0.154601
Epoch 9
Validation rmse = 0.075966
Epoch 10
Validation rmse = 0.171820
Epoch 11
Validation rmse = 0.145174
Epoch 12
Loss = 3.3327e-01, PNorm = 34.1412, GNorm = 4.5469, lr_0 = 5.0921e-04
Validation rmse = 0.088506
Epoch 13
Validation rmse = 0.128287
Epoch 14
Validation rmse = 0.107586
Epoch 15
Validation rmse = 0.074788
Epoch 16
Loss = 1.9484e-01, PNorm = 34.1748, GNorm = 2.8115, lr_0 = 4.0128e-04
Validation rmse = 0.104399
Epoch 17
Validation rmse = 0.077276
Epoch 18
Validation rmse = 0.062851
Epoch 19
Validation rmse = 0.080632
Epoch 20
Loss = 2.0240e-01, PNorm = 34.2033, GNorm = 3.7314, lr_0 = 3.1623e-04
Validation rmse = 0.062313
Epoch 21
Validation rmse = 0.064097
Epoch 22
Validation rmse = 0.045141
Epoch 23
Validation rmse = 0.050394
Epoch 24
Loss = 1.5759e-01, PNorm = 34.2251, GNorm = 1.8405, lr_0 = 2.4920e-04
Validation rmse = 0.052801
Epoch 25
Validation rmse = 0.034633
Epoch 26
Validation rmse = 0.054084
Epoch 27
Validation rmse = 0.040807
Epoch 28
Loss = 1.1056e-01, PNorm = 34.2417, GNorm = 0.7330, lr_0 = 1.9638e-04
Validation rmse = 0.037898
Epoch 29
Validation rmse = 0.037216
Epoch 30
Validation rmse = 0.025420
Epoch 31
Validation rmse = 0.032802
Epoch 32
Loss = 8.9823e-02, PNorm = 34.2543, GNorm = 0.5401, lr_0 = 1.5476e-04
Validation rmse = 0.028003
Epoch 33
Validation rmse = 0.041022
Epoch 34
Validation rmse = 0.036691
Epoch 35
Validation rmse = 0.029290
Epoch 36
Loss = 1.1228e-01, PNorm = 34.2639, GNorm = 0.4174, lr_0 = 1.2196e-04
Validation rmse = 0.025966
Epoch 37
Validation rmse = 0.033864
Epoch 38
Validation rmse = 0.032652
Epoch 39
Validation rmse = 0.028385
Epoch 40
Loss = 1.0215e-01, PNorm = 34.2711, GNorm = 0.6912, lr_0 = 1.0000e-04
Validation rmse = 0.030257
Epoch 41
Validation rmse = 0.036218
Epoch 42
Validation rmse = 0.023151
Epoch 43
Validation rmse = 0.021903
Epoch 44
Loss = 8.4354e-02, PNorm = 34.2775, GNorm = 0.3536, lr_0 = 1.0000e-04
Validation rmse = 0.034121
Epoch 45
Validation rmse = 0.030504
Epoch 46
Validation rmse = 0.024529
Epoch 47
Validation rmse = 0.028973
Epoch 48
Loss = 8.9222e-02, PNorm = 34.2840, GNorm = 0.7737, lr_0 = 1.0000e-04
Validation rmse = 0.033349
Epoch 49
Validation rmse = 0.014603
Epoch 50
Validation rmse = 0.025452
Epoch 51
Validation rmse = 0.040442
Epoch 52
Loss = 1.0742e-01, PNorm = 34.2910, GNorm = 2.3664, lr_0 = 1.0000e-04
Validation rmse = 0.026528
Epoch 53
Validation rmse = 0.027261
Epoch 54
Validation rmse = 0.029624
Epoch 55
Validation rmse = 0.021600
Epoch 56
Loss = 8.8228e-02, PNorm = 34.2978, GNorm = 1.8398, lr_0 = 1.0000e-04
Validation rmse = 0.014474
Epoch 57
Validation rmse = 0.023089
Epoch 58
Validation rmse = 0.030865
Epoch 59
Validation rmse = 0.033108
Model 0 best validation rmse = 0.014474 on epoch 56
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.048579
Ensemble test rmse = 0.048579
1-fold cross validation
	Seed 0 ==> test rmse = 0.048579
Overall test rmse = 0.048579 +/- 0.000000
Elapsed time = 0:00:06
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_mecn.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 121 | train size = 119 | val size = 1 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.174138
Epoch 1
Validation rmse = 0.162241
Epoch 2
Validation rmse = 0.211111
Epoch 3
Validation rmse = 0.164735
Epoch 4
Loss = 4.8371e-01, PNorm = 34.0574, GNorm = 2.9695, lr_0 = 8.1996e-04
Validation rmse = 0.251294
Epoch 5
Validation rmse = 0.103327
Epoch 6
Validation rmse = 0.196939
Epoch 7
Validation rmse = 0.169070
Epoch 8
Loss = 2.5603e-01, PNorm = 34.1048, GNorm = 3.1839, lr_0 = 6.4617e-04
Validation rmse = 0.128354
Epoch 9
Validation rmse = 0.206954
Epoch 10
Validation rmse = 0.107965
Epoch 11
Validation rmse = 0.145919
Epoch 12
Loss = 2.4477e-01, PNorm = 34.1484, GNorm = 6.2404, lr_0 = 4.9920e-04
Loss = 1.5961e-01, PNorm = 34.1512, GNorm = 1.5550, lr_0 = 4.8939e-04
Validation rmse = 0.145370
Epoch 13
Validation rmse = 0.114617
Epoch 14
Validation rmse = 0.165413
Epoch 15
Validation rmse = 0.082585
Epoch 16
Loss = 1.8492e-01, PNorm = 34.1780, GNorm = 2.0799, lr_0 = 3.9339e-04
Loss = 9.3914e-02, PNorm = 34.1801, GNorm = 1.6595, lr_0 = 3.8566e-04
Validation rmse = 0.139171
Epoch 17
Validation rmse = 0.087542
Epoch 18
Validation rmse = 0.122463
Epoch 19
Validation rmse = 0.110583
Epoch 20
Validation rmse = 0.091953
Epoch 21
Loss = 1.2458e-01, PNorm = 34.2051, GNorm = 3.1020, lr_0 = 2.9795e-04
Validation rmse = 0.105716
Epoch 22
Validation rmse = 0.081000
Epoch 23
Validation rmse = 0.104840
Epoch 24
Validation rmse = 0.084147
Epoch 25
Loss = 1.0337e-01, PNorm = 34.2238, GNorm = 0.9291, lr_0 = 2.3480e-04
Validation rmse = 0.087506
Epoch 26
Validation rmse = 0.105732
Epoch 27
Validation rmse = 0.074778
Epoch 28
Validation rmse = 0.100893
Epoch 29
Loss = 9.9796e-02, PNorm = 34.2371, GNorm = 0.5133, lr_0 = 1.8503e-04
Validation rmse = 0.082067
Epoch 30
Validation rmse = 0.067064
Epoch 31
Validation rmse = 0.094864
Epoch 32
Validation rmse = 0.078660
Epoch 33
Loss = 7.9186e-02, PNorm = 34.2468, GNorm = 0.9858, lr_0 = 1.4295e-04
Loss = 1.1470e-01, PNorm = 34.2474, GNorm = 4.3517, lr_0 = 1.4014e-04
Validation rmse = 0.071247
Epoch 34
Validation rmse = 0.073897
Epoch 35
Validation rmse = 0.091472
Epoch 36
Validation rmse = 0.086129
Epoch 37
Loss = 8.5262e-02, PNorm = 34.2535, GNorm = 2.2295, lr_0 = 1.1265e-04
Loss = 6.6964e-02, PNorm = 34.2539, GNorm = 4.4626, lr_0 = 1.1043e-04
Validation rmse = 0.080712
Epoch 38
Validation rmse = 0.090584
Epoch 39
Validation rmse = 0.071174
Epoch 40
Validation rmse = 0.075338
Epoch 41
Validation rmse = 0.088787
Epoch 42
Loss = 8.0778e-02, PNorm = 34.2595, GNorm = 1.4783, lr_0 = 1.0000e-04
Validation rmse = 0.080995
Epoch 43
Validation rmse = 0.081819
Epoch 44
Validation rmse = 0.090657
Epoch 45
Validation rmse = 0.072852
Epoch 46
Loss = 7.8571e-02, PNorm = 34.2645, GNorm = 1.9881, lr_0 = 1.0000e-04
Validation rmse = 0.086972
Epoch 47
Validation rmse = 0.094227
Epoch 48
Validation rmse = 0.078562
Epoch 49
Validation rmse = 0.073089
Epoch 50
Loss = 6.6559e-02, PNorm = 34.2695, GNorm = 0.3606, lr_0 = 1.0000e-04
Validation rmse = 0.091157
Epoch 51
Validation rmse = 0.082350
Epoch 52
Validation rmse = 0.063935
Epoch 53
Validation rmse = 0.101622
Epoch 54
Loss = 7.2886e-02, PNorm = 34.2746, GNorm = 4.1212, lr_0 = 1.0000e-04
Loss = 9.1328e-02, PNorm = 34.2750, GNorm = 2.0986, lr_0 = 1.0000e-04
Validation rmse = 0.090013
Epoch 55
Validation rmse = 0.067910
Epoch 56
Validation rmse = 0.075966
Epoch 57
Validation rmse = 0.086094
Epoch 58
Loss = 6.8622e-02, PNorm = 34.2795, GNorm = 1.5125, lr_0 = 1.0000e-04
Loss = 5.6659e-02, PNorm = 34.2799, GNorm = 0.7108, lr_0 = 1.0000e-04
Validation rmse = 0.069862
Epoch 59
Validation rmse = 0.080081
Model 0 best validation rmse = 0.063935 on epoch 52
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.012108
Ensemble test rmse = 0.012108
1-fold cross validation
	Seed 0 ==> test rmse = 0.012108
Overall test rmse = 0.012108 +/- 0.000000
Elapsed time = 0:00:07
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 417 | train size = 412 | val size = 2 | test size = 3
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.302486
Epoch 1
Loss = 6.9448e-01, PNorm = 34.0263, GNorm = 10.4726, lr_0 = 7.7500e-04
Validation rmse = 0.266605
Epoch 2
Loss = 5.7531e-01, PNorm = 34.0727, GNorm = 4.6743, lr_0 = 9.6586e-04
Validation rmse = 0.473141
Epoch 3
Loss = 5.9972e-01, PNorm = 34.1238, GNorm = 9.6162, lr_0 = 9.1455e-04
Validation rmse = 0.291439
Epoch 4
Loss = 4.9815e-01, PNorm = 34.1690, GNorm = 4.9659, lr_0 = 8.6596e-04
Validation rmse = 0.431240
Epoch 5
Validation rmse = 0.417590
Epoch 6
Loss = 5.9024e-01, PNorm = 34.2046, GNorm = 5.9036, lr_0 = 8.1996e-04
Validation rmse = 0.437419
Epoch 7
Loss = 4.6378e-01, PNorm = 34.2423, GNorm = 5.1006, lr_0 = 7.7640e-04
Validation rmse = 0.435246
Epoch 8
Loss = 4.1967e-01, PNorm = 34.2760, GNorm = 2.6444, lr_0 = 7.3516e-04
Validation rmse = 0.381931
Epoch 9
Loss = 4.6479e-01, PNorm = 34.3013, GNorm = 4.1168, lr_0 = 6.9956e-04
Validation rmse = 0.383374
Epoch 10
Loss = 3.8110e-01, PNorm = 34.3348, GNorm = 2.7143, lr_0 = 6.6240e-04
Loss = 2.8046e-01, PNorm = 34.3365, GNorm = 3.1968, lr_0 = 6.5912e-04
Validation rmse = 0.329067
Epoch 11
Validation rmse = 0.332437
Epoch 12
Loss = 4.4516e-01, PNorm = 34.3603, GNorm = 5.4448, lr_0 = 6.2411e-04
Validation rmse = 0.379623
Epoch 13
Loss = 5.2515e-01, PNorm = 34.3842, GNorm = 10.4184, lr_0 = 5.9389e-04
Validation rmse = 0.443932
Epoch 14
Loss = 3.9676e-01, PNorm = 34.4105, GNorm = 3.8746, lr_0 = 5.6234e-04
Validation rmse = 0.439670
Epoch 15
Loss = 3.7469e-01, PNorm = 34.4383, GNorm = 6.7635, lr_0 = 5.3247e-04
Validation rmse = 0.410594
Epoch 16
Loss = 3.4447e-01, PNorm = 34.4573, GNorm = 4.3078, lr_0 = 5.0418e-04
Validation rmse = 0.427848
Epoch 17
Validation rmse = 0.419135
Epoch 18
Loss = 3.6308e-01, PNorm = 34.4768, GNorm = 2.5166, lr_0 = 4.7740e-04
Validation rmse = 0.392225
Epoch 19
Loss = 3.4006e-01, PNorm = 34.4958, GNorm = 1.5772, lr_0 = 4.5204e-04
Validation rmse = 0.357487
Epoch 20
Loss = 3.6585e-01, PNorm = 34.5139, GNorm = 2.4784, lr_0 = 4.2802e-04
Validation rmse = 0.443725
Epoch 21
Loss = 3.2784e-01, PNorm = 34.5323, GNorm = 1.6920, lr_0 = 4.0730e-04
Validation rmse = 0.457531
Epoch 22
Validation rmse = 0.405626
Epoch 23
Loss = 2.8558e-01, PNorm = 34.5514, GNorm = 0.7230, lr_0 = 3.8375e-04
Validation rmse = 0.450078
Epoch 24
Loss = 3.2111e-01, PNorm = 34.5681, GNorm = 2.5665, lr_0 = 3.6337e-04
Validation rmse = 0.434334
Epoch 25
Loss = 3.0158e-01, PNorm = 34.5824, GNorm = 3.1724, lr_0 = 3.4577e-04
Validation rmse = 0.425760
Epoch 26
Loss = 3.1256e-01, PNorm = 34.5989, GNorm = 2.2217, lr_0 = 3.2741e-04
Validation rmse = 0.482665
Epoch 27
Loss = 3.1856e-01, PNorm = 34.6166, GNorm = 0.9283, lr_0 = 3.1001e-04
Loss = 2.1840e-01, PNorm = 34.6182, GNorm = 3.6299, lr_0 = 3.0848e-04
Validation rmse = 0.439920
Epoch 28
Validation rmse = 0.413941
Epoch 29
Loss = 2.9189e-01, PNorm = 34.6363, GNorm = 1.5028, lr_0 = 2.9209e-04
Validation rmse = 0.346736
Epoch 30
Loss = 3.2112e-01, PNorm = 34.6526, GNorm = 7.1901, lr_0 = 2.7795e-04
Validation rmse = 0.483795
Epoch 31
Loss = 3.5004e-01, PNorm = 34.6696, GNorm = 4.6804, lr_0 = 2.6318e-04
Validation rmse = 0.456573
Epoch 32
Loss = 2.8349e-01, PNorm = 34.6831, GNorm = 1.8319, lr_0 = 2.4920e-04
Validation rmse = 0.459336
Epoch 33
Loss = 3.1871e-01, PNorm = 34.6945, GNorm = 3.1620, lr_0 = 2.3596e-04
Validation rmse = 0.412250
Epoch 34
Validation rmse = 0.444259
Epoch 35
Loss = 2.6588e-01, PNorm = 34.7057, GNorm = 1.0501, lr_0 = 2.2343e-04
Validation rmse = 0.475568
Epoch 36
Loss = 2.4732e-01, PNorm = 34.7166, GNorm = 4.2877, lr_0 = 2.1156e-04
Validation rmse = 0.413993
Epoch 37
Loss = 2.6596e-01, PNorm = 34.7272, GNorm = 2.8984, lr_0 = 2.0032e-04
Validation rmse = 0.465699
Epoch 38
Loss = 2.7528e-01, PNorm = 34.7379, GNorm = 0.7953, lr_0 = 1.9062e-04
Validation rmse = 0.423127
Epoch 39
Validation rmse = 0.453163
Epoch 40
Loss = 2.3167e-01, PNorm = 34.7487, GNorm = 2.1665, lr_0 = 1.7960e-04
Validation rmse = 0.448148
Epoch 41
Loss = 2.0320e-01, PNorm = 34.7584, GNorm = 2.5075, lr_0 = 1.7006e-04
Validation rmse = 0.459819
Epoch 42
Loss = 2.9399e-01, PNorm = 34.7681, GNorm = 1.0555, lr_0 = 1.6183e-04
Validation rmse = 0.437052
Epoch 43
Loss = 2.8095e-01, PNorm = 34.7784, GNorm = 1.1029, lr_0 = 1.5323e-04
Validation rmse = 0.456699
Epoch 44
Loss = 2.6635e-01, PNorm = 34.7877, GNorm = 2.8978, lr_0 = 1.4509e-04
Loss = 4.4949e-01, PNorm = 34.7886, GNorm = 6.1410, lr_0 = 1.4437e-04
Validation rmse = 0.430560
Epoch 45
Validation rmse = 0.417094
Epoch 46
Loss = 1.9039e-01, PNorm = 34.7974, GNorm = 2.6303, lr_0 = 1.3738e-04
Validation rmse = 0.449943
Epoch 47
Loss = 2.6222e-01, PNorm = 34.8060, GNorm = 1.0387, lr_0 = 1.3008e-04
Validation rmse = 0.433880
Epoch 48
Loss = 2.7325e-01, PNorm = 34.8144, GNorm = 1.5022, lr_0 = 1.2317e-04
Validation rmse = 0.449938
Epoch 49
Loss = 2.5209e-01, PNorm = 34.8221, GNorm = 1.0571, lr_0 = 1.1663e-04
Validation rmse = 0.444704
Epoch 50
Loss = 2.6156e-01, PNorm = 34.8287, GNorm = 1.1436, lr_0 = 1.1098e-04
Loss = 4.5553e-02, PNorm = 34.8293, GNorm = 1.2218, lr_0 = 1.1043e-04
Validation rmse = 0.438572
Epoch 51
Validation rmse = 0.447500
Epoch 52
Loss = 2.9905e-01, PNorm = 34.8363, GNorm = 1.5337, lr_0 = 1.0457e-04
Validation rmse = 0.434863
Epoch 53
Loss = 3.0791e-01, PNorm = 34.8429, GNorm = 1.7909, lr_0 = 1.0000e-04
Validation rmse = 0.443784
Epoch 54
Loss = 2.1788e-01, PNorm = 34.8500, GNorm = 3.1364, lr_0 = 1.0000e-04
Validation rmse = 0.437748
Epoch 55
Loss = 2.4886e-01, PNorm = 34.8553, GNorm = 1.5269, lr_0 = 1.0000e-04
Validation rmse = 0.443838
Epoch 56
Validation rmse = 0.427054
Epoch 57
Loss = 2.8851e-01, PNorm = 34.8637, GNorm = 4.7756, lr_0 = 1.0000e-04
Validation rmse = 0.448635
Epoch 58
Loss = 2.1855e-01, PNorm = 34.8712, GNorm = 1.7299, lr_0 = 1.0000e-04
Validation rmse = 0.447411
Epoch 59
Loss = 1.9498e-01, PNorm = 34.8777, GNorm = 1.1700, lr_0 = 1.0000e-04
Validation rmse = 0.444653
Model 0 best validation rmse = 0.266605 on epoch 1
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.331675
Ensemble test rmse = 0.331675
1-fold cross validation
	Seed 0 ==> test rmse = 0.331675
Overall test rmse = 0.331675 +/- 0.000000
Elapsed time = 0:00:18
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 412 | train size = 407 | val size = 2 | test size = 3
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.171548
Epoch 1
Loss = 7.9804e-01, PNorm = 34.0257, GNorm = 5.5059, lr_0 = 7.7500e-04
Validation rmse = 0.306226
Epoch 2
Loss = 7.9511e-01, PNorm = 34.0645, GNorm = 1.7937, lr_0 = 9.6586e-04
Validation rmse = 0.190611
Epoch 3
Loss = 5.7351e-01, PNorm = 34.1116, GNorm = 7.1680, lr_0 = 9.1455e-04
Validation rmse = 0.209215
Epoch 4
Loss = 5.4543e-01, PNorm = 34.1590, GNorm = 9.6726, lr_0 = 8.6596e-04
Loss = 9.4661e-01, PNorm = 34.1623, GNorm = 10.9526, lr_0 = 8.6168e-04
Validation rmse = 0.051469
Epoch 5
Validation rmse = 0.083692
Epoch 6
Loss = 4.2853e-01, PNorm = 34.2041, GNorm = 2.8597, lr_0 = 8.1590e-04
Validation rmse = 0.060161
Epoch 7
Loss = 4.2249e-01, PNorm = 34.2352, GNorm = 2.1760, lr_0 = 7.7256e-04
Validation rmse = 0.100831
Epoch 8
Loss = 3.6763e-01, PNorm = 34.2652, GNorm = 2.8054, lr_0 = 7.3516e-04
Validation rmse = 0.057629
Epoch 9
Loss = 4.0045e-01, PNorm = 34.2852, GNorm = 1.5107, lr_0 = 6.9610e-04
Validation rmse = 0.073597
Epoch 10
Validation rmse = 0.061473
Epoch 11
Loss = 3.5074e-01, PNorm = 34.3156, GNorm = 1.6106, lr_0 = 6.5586e-04
Validation rmse = 0.060198
Epoch 12
Loss = 3.5768e-01, PNorm = 34.3476, GNorm = 2.5045, lr_0 = 6.2102e-04
Validation rmse = 0.119857
Epoch 13
Loss = 4.1722e-01, PNorm = 34.3699, GNorm = 2.4137, lr_0 = 5.8803e-04
Validation rmse = 0.184308
Epoch 14
Loss = 4.4872e-01, PNorm = 34.3925, GNorm = 7.0258, lr_0 = 5.5679e-04
Validation rmse = 0.109267
Epoch 15
Loss = 3.5825e-01, PNorm = 34.4133, GNorm = 1.2872, lr_0 = 5.2983e-04
Loss = 9.9875e-01, PNorm = 34.4147, GNorm = 9.7681, lr_0 = 5.2721e-04
Validation rmse = 0.045094
Epoch 16
Validation rmse = 0.132625
Epoch 17
Loss = 3.6824e-01, PNorm = 34.4270, GNorm = 1.4668, lr_0 = 4.9920e-04
Validation rmse = 0.108888
Epoch 18
Loss = 3.6512e-01, PNorm = 34.4476, GNorm = 0.7685, lr_0 = 4.7268e-04
Validation rmse = 0.108306
Epoch 19
Loss = 3.0773e-01, PNorm = 34.4644, GNorm = 1.4282, lr_0 = 4.4757e-04
Validation rmse = 0.047235
Epoch 20
Loss = 3.4122e-01, PNorm = 34.4811, GNorm = 2.9814, lr_0 = 4.2379e-04
Loss = 1.1416e+00, PNorm = 34.4823, GNorm = 4.4434, lr_0 = 4.2170e-04
Validation rmse = 0.082751
Epoch 21
Validation rmse = 0.081858
Epoch 22
Loss = 3.0311e-01, PNorm = 34.4953, GNorm = 0.8088, lr_0 = 4.0128e-04
Validation rmse = 0.091950
Epoch 23
Loss = 3.7160e-01, PNorm = 34.5122, GNorm = 0.8415, lr_0 = 3.7996e-04
Validation rmse = 0.109305
Epoch 24
Loss = 3.3056e-01, PNorm = 34.5284, GNorm = 0.9331, lr_0 = 3.5978e-04
Validation rmse = 0.136992
Epoch 25
Loss = 3.5465e-01, PNorm = 34.5439, GNorm = 3.9532, lr_0 = 3.4067e-04
Validation rmse = 0.043300
Epoch 26
Validation rmse = 0.145389
Epoch 27
Loss = 3.9112e-01, PNorm = 34.5588, GNorm = 5.8696, lr_0 = 3.2097e-04
Validation rmse = 0.120803
Epoch 28
Loss = 4.1547e-01, PNorm = 34.5758, GNorm = 4.0177, lr_0 = 3.0392e-04
Validation rmse = 0.114588
Epoch 29
Loss = 3.7859e-01, PNorm = 34.5878, GNorm = 4.1981, lr_0 = 2.8921e-04
Validation rmse = 0.049834
Epoch 30
Loss = 2.9164e-01, PNorm = 34.6013, GNorm = 3.5916, lr_0 = 2.7384e-04
Validation rmse = 0.070490
Epoch 31
Loss = 3.3215e-01, PNorm = 34.6153, GNorm = 1.3906, lr_0 = 2.5929e-04
Loss = 2.9375e-01, PNorm = 34.6165, GNorm = 1.9176, lr_0 = 2.5801e-04
Validation rmse = 0.166561
Epoch 32
Validation rmse = 0.076763
Epoch 33
Loss = 3.5868e-01, PNorm = 34.6291, GNorm = 1.9467, lr_0 = 2.4430e-04
Validation rmse = 0.061005
Epoch 34
Loss = 3.0259e-01, PNorm = 34.6422, GNorm = 1.8026, lr_0 = 2.3133e-04
Validation rmse = 0.142264
Epoch 35
Loss = 3.0000e-01, PNorm = 34.6522, GNorm = 3.9048, lr_0 = 2.1904e-04
Validation rmse = 0.095797
Epoch 36
Loss = 2.9398e-01, PNorm = 34.6626, GNorm = 1.6333, lr_0 = 2.0843e-04
Validation rmse = 0.048228
Epoch 37
Validation rmse = 0.107216
Epoch 38
Loss = 3.7135e-01, PNorm = 34.6746, GNorm = 1.9139, lr_0 = 1.9638e-04
Validation rmse = 0.061456
Epoch 39
Loss = 3.8614e-01, PNorm = 34.6834, GNorm = 6.3021, lr_0 = 1.8595e-04
Validation rmse = 0.085640
Epoch 40
Loss = 3.2417e-01, PNorm = 34.6931, GNorm = 2.2794, lr_0 = 1.7607e-04
Validation rmse = 0.105614
Epoch 41
Loss = 3.3158e-01, PNorm = 34.7033, GNorm = 2.1832, lr_0 = 1.6672e-04
Validation rmse = 0.048689
Epoch 42
Loss = 2.9664e-01, PNorm = 34.7107, GNorm = 7.0921, lr_0 = 1.5786e-04
Validation rmse = 0.105530
Epoch 43
Validation rmse = 0.081422
Epoch 44
Loss = 3.0965e-01, PNorm = 34.7181, GNorm = 0.8762, lr_0 = 1.4948e-04
Validation rmse = 0.085455
Epoch 45
Loss = 2.8800e-01, PNorm = 34.7268, GNorm = 4.9640, lr_0 = 1.4153e-04
Validation rmse = 0.078806
Epoch 46
Loss = 3.1361e-01, PNorm = 34.7347, GNorm = 1.5065, lr_0 = 1.3402e-04
Validation rmse = 0.073624
Epoch 47
Loss = 2.8598e-01, PNorm = 34.7418, GNorm = 1.1002, lr_0 = 1.2690e-04
Loss = 2.0501e-01, PNorm = 34.7424, GNorm = 5.9985, lr_0 = 1.2627e-04
Validation rmse = 0.076989
Epoch 48
Validation rmse = 0.100215
Epoch 49
Loss = 2.3927e-01, PNorm = 34.7483, GNorm = 2.9924, lr_0 = 1.1956e-04
Validation rmse = 0.081877
Epoch 50
Loss = 2.3854e-01, PNorm = 34.7540, GNorm = 1.2579, lr_0 = 1.1377e-04
Validation rmse = 0.089963
Epoch 51
Loss = 2.9399e-01, PNorm = 34.7604, GNorm = 2.7073, lr_0 = 1.0773e-04
Validation rmse = 0.088690
Epoch 52
Loss = 2.7603e-01, PNorm = 34.7659, GNorm = 2.1002, lr_0 = 1.0200e-04
Validation rmse = 0.095336
Epoch 53
Validation rmse = 0.074623
Epoch 54
Loss = 3.4822e-01, PNorm = 34.7721, GNorm = 0.8883, lr_0 = 1.0000e-04
Validation rmse = 0.091629
Epoch 55
Loss = 2.6609e-01, PNorm = 34.7783, GNorm = 4.3594, lr_0 = 1.0000e-04
Validation rmse = 0.085528
Epoch 56
Loss = 3.0122e-01, PNorm = 34.7847, GNorm = 4.6792, lr_0 = 1.0000e-04
Validation rmse = 0.073119
Epoch 57
Loss = 2.8545e-01, PNorm = 34.7903, GNorm = 2.2679, lr_0 = 1.0000e-04
Validation rmse = 0.089841
Epoch 58
Loss = 2.7269e-01, PNorm = 34.7957, GNorm = 3.1472, lr_0 = 1.0000e-04
Loss = 4.1584e-01, PNorm = 34.7963, GNorm = 10.8682, lr_0 = 1.0000e-04
Validation rmse = 0.066783
Epoch 59
Validation rmse = 0.114568
Model 0 best validation rmse = 0.043300 on epoch 25
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.048503
Ensemble test rmse = 0.048503
1-fold cross validation
	Seed 0 ==> test rmse = 0.048503
Overall test rmse = 0.048503 +/- 0.000000
Elapsed time = 0:00:17
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 407 | train size = 402 | val size = 2 | test size = 3
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.132616
Epoch 1
Loss = 1.0999e+00, PNorm = 34.0254, GNorm = 14.2226, lr_0 = 7.7500e-04
Validation rmse = 0.122398
Epoch 2
Loss = 7.3925e-01, PNorm = 34.0650, GNorm = 7.5002, lr_0 = 9.6586e-04
Validation rmse = 0.096511
Epoch 3
Loss = 7.6044e-01, PNorm = 34.1140, GNorm = 7.7439, lr_0 = 9.1455e-04
Validation rmse = 0.120596
Epoch 4
Loss = 5.1915e-01, PNorm = 34.1609, GNorm = 3.6204, lr_0 = 8.6596e-04
Loss = 1.2310e+00, PNorm = 34.1639, GNorm = 17.5960, lr_0 = 8.6168e-04
Validation rmse = 0.130085
Epoch 5
Validation rmse = 0.064522
Epoch 6
Loss = 4.7877e-01, PNorm = 34.1988, GNorm = 2.8083, lr_0 = 8.1590e-04
Validation rmse = 0.075274
Epoch 7
Loss = 5.6121e-01, PNorm = 34.2383, GNorm = 4.7532, lr_0 = 7.7256e-04
Validation rmse = 0.071968
Epoch 8
Loss = 4.7997e-01, PNorm = 34.2704, GNorm = 3.6920, lr_0 = 7.3152e-04
Validation rmse = 0.072348
Epoch 9
Loss = 4.5148e-01, PNorm = 34.2970, GNorm = 5.4315, lr_0 = 6.9266e-04
Loss = 7.8789e-02, PNorm = 34.2986, GNorm = 4.6567, lr_0 = 6.8923e-04
Validation rmse = 0.085134
Epoch 10
Validation rmse = 0.127081
Epoch 11
Loss = 6.1220e-01, PNorm = 34.3211, GNorm = 4.9866, lr_0 = 6.5261e-04
Validation rmse = 0.059499
Epoch 12
Loss = 4.9609e-01, PNorm = 34.3466, GNorm = 5.0335, lr_0 = 6.1794e-04
Validation rmse = 0.090689
Epoch 13
Loss = 4.3793e-01, PNorm = 34.3757, GNorm = 1.0517, lr_0 = 5.8512e-04
Validation rmse = 0.056519
Epoch 14
Loss = 4.3244e-01, PNorm = 34.4000, GNorm = 4.4036, lr_0 = 5.5403e-04
Loss = 5.6741e-01, PNorm = 34.4022, GNorm = 14.3638, lr_0 = 5.5129e-04
Validation rmse = 0.103410
Epoch 15
Validation rmse = 0.058066
Epoch 16
Loss = 3.5935e-01, PNorm = 34.4259, GNorm = 1.3112, lr_0 = 5.2200e-04
Validation rmse = 0.070599
Epoch 17
Loss = 3.9269e-01, PNorm = 34.4446, GNorm = 6.2671, lr_0 = 4.9427e-04
Validation rmse = 0.095071
Epoch 18
Loss = 3.7630e-01, PNorm = 34.4627, GNorm = 0.8854, lr_0 = 4.6801e-04
Validation rmse = 0.096399
Epoch 19
Loss = 4.0849e-01, PNorm = 34.4812, GNorm = 2.5553, lr_0 = 4.4315e-04
Loss = 1.9142e-01, PNorm = 34.4830, GNorm = 7.2300, lr_0 = 4.4096e-04
Validation rmse = 0.124257
Epoch 20
Validation rmse = 0.108500
Epoch 21
Loss = 4.9066e-01, PNorm = 34.4974, GNorm = 5.8879, lr_0 = 4.1753e-04
Validation rmse = 0.091830
Epoch 22
Loss = 3.0428e-01, PNorm = 34.5151, GNorm = 3.6492, lr_0 = 3.9535e-04
Validation rmse = 0.100789
Epoch 23
Loss = 3.6473e-01, PNorm = 34.5297, GNorm = 1.9527, lr_0 = 3.7435e-04
Validation rmse = 0.111016
Epoch 24
Loss = 3.6109e-01, PNorm = 34.5456, GNorm = 2.0588, lr_0 = 3.5446e-04
Validation rmse = 0.110979
Epoch 25
Validation rmse = 0.114030
Epoch 26
Loss = 3.0525e-01, PNorm = 34.5605, GNorm = 0.5918, lr_0 = 3.3563e-04
Validation rmse = 0.118074
Epoch 27
Loss = 3.7099e-01, PNorm = 34.5752, GNorm = 2.0159, lr_0 = 3.1780e-04
Validation rmse = 0.114726
Epoch 28
Loss = 3.6650e-01, PNorm = 34.5900, GNorm = 0.9943, lr_0 = 3.0092e-04
Validation rmse = 0.111879
Epoch 29
Loss = 3.1787e-01, PNorm = 34.6050, GNorm = 1.0193, lr_0 = 2.8493e-04
Validation rmse = 0.121230
Epoch 30
Validation rmse = 0.116119
Epoch 31
Loss = 2.9991e-01, PNorm = 34.6184, GNorm = 2.2625, lr_0 = 2.6846e-04
Validation rmse = 0.146385
Epoch 32
Loss = 3.7369e-01, PNorm = 34.6284, GNorm = 4.0179, lr_0 = 2.5420e-04
Validation rmse = 0.123814
Epoch 33
Loss = 3.1279e-01, PNorm = 34.6418, GNorm = 1.9676, lr_0 = 2.4069e-04
Validation rmse = 0.137104
Epoch 34
Loss = 3.3583e-01, PNorm = 34.6504, GNorm = 0.7774, lr_0 = 2.2791e-04
Validation rmse = 0.136282
Epoch 35
Validation rmse = 0.143336
Epoch 36
Loss = 2.0255e-01, PNorm = 34.6658, GNorm = 3.4310, lr_0 = 2.1473e-04
Validation rmse = 0.134804
Epoch 37
Loss = 3.1735e-01, PNorm = 34.6769, GNorm = 3.1391, lr_0 = 2.0332e-04
Validation rmse = 0.140462
Epoch 38
Loss = 3.0608e-01, PNorm = 34.6869, GNorm = 1.9861, lr_0 = 1.9252e-04
Validation rmse = 0.136527
Epoch 39
Loss = 3.2574e-01, PNorm = 34.6966, GNorm = 0.5386, lr_0 = 1.8230e-04
Validation rmse = 0.150602
Epoch 40
Validation rmse = 0.139301
Epoch 41
Loss = 3.6883e-01, PNorm = 34.7061, GNorm = 4.6227, lr_0 = 1.7176e-04
Validation rmse = 0.142549
Epoch 42
Loss = 2.4685e-01, PNorm = 34.7128, GNorm = 1.2586, lr_0 = 1.6263e-04
Validation rmse = 0.154557
Epoch 43
Loss = 3.0496e-01, PNorm = 34.7184, GNorm = 1.6392, lr_0 = 1.5399e-04
Validation rmse = 0.159629
Epoch 44
Loss = 2.9615e-01, PNorm = 34.7258, GNorm = 1.4954, lr_0 = 1.4581e-04
Validation rmse = 0.162524
Epoch 45
Validation rmse = 0.157457
Epoch 46
Loss = 2.7741e-01, PNorm = 34.7327, GNorm = 2.4061, lr_0 = 1.3738e-04
Validation rmse = 0.155297
Epoch 47
Loss = 3.1847e-01, PNorm = 34.7410, GNorm = 1.3381, lr_0 = 1.3008e-04
Validation rmse = 0.161212
Epoch 48
Loss = 3.0522e-01, PNorm = 34.7484, GNorm = 3.0702, lr_0 = 1.2317e-04
Validation rmse = 0.158199
Epoch 49
Loss = 2.9579e-01, PNorm = 34.7549, GNorm = 1.8569, lr_0 = 1.1663e-04
Validation rmse = 0.160625
Epoch 50
Loss = 2.9683e-01, PNorm = 34.7609, GNorm = 2.7742, lr_0 = 1.1098e-04
Loss = 8.2348e-02, PNorm = 34.7614, GNorm = 3.9767, lr_0 = 1.1043e-04
Validation rmse = 0.165966
Epoch 51
Validation rmse = 0.171167
Epoch 52
Loss = 2.8860e-01, PNorm = 34.7665, GNorm = 0.7702, lr_0 = 1.0457e-04
Validation rmse = 0.170908
Epoch 53
Loss = 3.1188e-01, PNorm = 34.7715, GNorm = 2.3078, lr_0 = 1.0000e-04
Validation rmse = 0.169061
Epoch 54
Loss = 2.9657e-01, PNorm = 34.7757, GNorm = 2.5359, lr_0 = 1.0000e-04
Validation rmse = 0.170625
Epoch 55
Loss = 2.9217e-01, PNorm = 34.7808, GNorm = 0.5157, lr_0 = 1.0000e-04
Loss = 9.1192e-02, PNorm = 34.7813, GNorm = 2.3626, lr_0 = 1.0000e-04
Validation rmse = 0.167704
Epoch 56
Validation rmse = 0.169811
Epoch 57
Loss = 3.1985e-01, PNorm = 34.7865, GNorm = 3.8623, lr_0 = 1.0000e-04
Validation rmse = 0.165860
Epoch 58
Loss = 3.0519e-01, PNorm = 34.7912, GNorm = 2.5278, lr_0 = 1.0000e-04
Validation rmse = 0.172957
Epoch 59
Loss = 2.9911e-01, PNorm = 34.7961, GNorm = 2.7515, lr_0 = 1.0000e-04
Validation rmse = 0.170681
Model 0 best validation rmse = 0.056519 on epoch 13
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.344940
Ensemble test rmse = 0.344940
1-fold cross validation
	Seed 0 ==> test rmse = 0.344940
Overall test rmse = 0.344940 +/- 0.000000
Elapsed time = 0:00:17
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 402 | train size = 397 | val size = 2 | test size = 3
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.172235
Epoch 1
Loss = 7.4958e-01, PNorm = 34.0289, GNorm = 1.7852, lr_0 = 8.7143e-04
Validation rmse = 0.155234
Epoch 2
Loss = 6.7134e-01, PNorm = 34.0773, GNorm = 6.3087, lr_0 = 9.5564e-04
Validation rmse = 0.160012
Epoch 3
Loss = 5.4134e-01, PNorm = 34.1204, GNorm = 3.0647, lr_0 = 9.0295e-04
Validation rmse = 0.129409
Epoch 4
Validation rmse = 0.118525
Epoch 5
Loss = 3.6525e-01, PNorm = 34.1585, GNorm = 1.3044, lr_0 = 8.5317e-04
Validation rmse = 0.102985
Epoch 6
Loss = 5.1599e-01, PNorm = 34.1937, GNorm = 8.7805, lr_0 = 8.0613e-04
Validation rmse = 0.130886
Epoch 7
Loss = 4.5945e-01, PNorm = 34.2337, GNorm = 5.3312, lr_0 = 7.6168e-04
Validation rmse = 0.121417
Epoch 8
Loss = 4.3363e-01, PNorm = 34.2644, GNorm = 1.6426, lr_0 = 7.1969e-04
Validation rmse = 0.122234
Epoch 9
Validation rmse = 0.091643
Epoch 10
Loss = 2.9286e-01, PNorm = 34.2933, GNorm = 2.5502, lr_0 = 6.8001e-04
Validation rmse = 0.095870
Epoch 11
Loss = 3.9785e-01, PNorm = 34.3213, GNorm = 3.9874, lr_0 = 6.4251e-04
Validation rmse = 0.079074
Epoch 12
Loss = 4.5460e-01, PNorm = 34.3477, GNorm = 3.0162, lr_0 = 6.0709e-04
Validation rmse = 0.106666
Epoch 13
Loss = 4.4386e-01, PNorm = 34.3748, GNorm = 1.1597, lr_0 = 5.7362e-04
Validation rmse = 0.106421
Epoch 14
Validation rmse = 0.131328
Epoch 15
Loss = 4.3903e-01, PNorm = 34.4046, GNorm = 1.8471, lr_0 = 5.4199e-04
Validation rmse = 0.113112
Epoch 16
Loss = 4.1498e-01, PNorm = 34.4308, GNorm = 0.9334, lr_0 = 5.1211e-04
Validation rmse = 0.098471
Epoch 17
Loss = 3.3408e-01, PNorm = 34.4585, GNorm = 2.1293, lr_0 = 4.8113e-04
Validation rmse = 0.098866
Epoch 18
Loss = 3.4276e-01, PNorm = 34.4824, GNorm = 1.1489, lr_0 = 4.5461e-04
Validation rmse = 0.129707
Epoch 19
Validation rmse = 0.125559
Epoch 20
Loss = 4.0234e-01, PNorm = 34.5040, GNorm = 5.8455, lr_0 = 4.2954e-04
Validation rmse = 0.090256
Epoch 21
Loss = 3.2219e-01, PNorm = 34.5260, GNorm = 2.9709, lr_0 = 4.0586e-04
Validation rmse = 0.086225
Epoch 22
Loss = 3.6204e-01, PNorm = 34.5478, GNorm = 2.1792, lr_0 = 3.8348e-04
Validation rmse = 0.080466
Epoch 23
Loss = 3.3214e-01, PNorm = 34.5697, GNorm = 1.9140, lr_0 = 3.6234e-04
Validation rmse = 0.116265
Epoch 24
Validation rmse = 0.100204
Epoch 25
Loss = 2.7006e-01, PNorm = 34.5899, GNorm = 0.6550, lr_0 = 3.4236e-04
Validation rmse = 0.090549
Epoch 26
Loss = 3.1070e-01, PNorm = 34.6101, GNorm = 1.4750, lr_0 = 3.2348e-04
Validation rmse = 0.120599
Epoch 27
Loss = 3.4237e-01, PNorm = 34.6309, GNorm = 7.3527, lr_0 = 3.0565e-04
Validation rmse = 0.090549
Epoch 28
Loss = 3.0798e-01, PNorm = 34.6490, GNorm = 1.4713, lr_0 = 2.8880e-04
Validation rmse = 0.085382
Epoch 29
Validation rmse = 0.117701
Epoch 30
Loss = 2.0639e-01, PNorm = 34.6675, GNorm = 0.5082, lr_0 = 2.7287e-04
Validation rmse = 0.094352
Epoch 31
Loss = 2.9424e-01, PNorm = 34.6847, GNorm = 1.3201, lr_0 = 2.5783e-04
Validation rmse = 0.080084
Epoch 32
Loss = 2.7935e-01, PNorm = 34.7003, GNorm = 1.4686, lr_0 = 2.4361e-04
Validation rmse = 0.104584
Epoch 33
Validation rmse = 0.083593
Epoch 34
Loss = 3.0933e-01, PNorm = 34.7196, GNorm = 2.5279, lr_0 = 2.2888e-04
Validation rmse = 0.114296
Epoch 35
Loss = 2.6462e-01, PNorm = 34.7347, GNorm = 2.4837, lr_0 = 2.1626e-04
Validation rmse = 0.094382
Epoch 36
Loss = 2.6058e-01, PNorm = 34.7496, GNorm = 2.8174, lr_0 = 2.0434e-04
Validation rmse = 0.101819
Epoch 37
Loss = 3.0724e-01, PNorm = 34.7632, GNorm = 2.8182, lr_0 = 1.9307e-04
Validation rmse = 0.103540
Epoch 38
Validation rmse = 0.082403
Epoch 39
Loss = 3.1362e-01, PNorm = 34.7772, GNorm = 2.5590, lr_0 = 1.8242e-04
Validation rmse = 0.097892
Epoch 40
Loss = 2.8173e-01, PNorm = 34.7899, GNorm = 0.8203, lr_0 = 1.7237e-04
Validation rmse = 0.089212
Epoch 41
Loss = 2.7585e-01, PNorm = 34.8018, GNorm = 2.0566, lr_0 = 1.6286e-04
Validation rmse = 0.090738
Epoch 42
Loss = 2.7572e-01, PNorm = 34.8132, GNorm = 2.2758, lr_0 = 1.5388e-04
Validation rmse = 0.092001
Epoch 43
Validation rmse = 0.087153
Epoch 44
Loss = 3.6091e-01, PNorm = 34.8245, GNorm = 1.9874, lr_0 = 1.4540e-04
Validation rmse = 0.091959
Epoch 45
Loss = 2.3960e-01, PNorm = 34.8359, GNorm = 1.2504, lr_0 = 1.3738e-04
Validation rmse = 0.092028
Epoch 46
Loss = 2.0111e-01, PNorm = 34.8457, GNorm = 1.5798, lr_0 = 1.2981e-04
Validation rmse = 0.095969
Epoch 47
Loss = 2.5954e-01, PNorm = 34.8553, GNorm = 1.4052, lr_0 = 1.2265e-04
Validation rmse = 0.091994
Epoch 48
Validation rmse = 0.095810
Epoch 49
Loss = 4.9594e-01, PNorm = 34.8646, GNorm = 0.8748, lr_0 = 1.1589e-04
Validation rmse = 0.087615
Epoch 50
Loss = 2.1373e-01, PNorm = 34.8738, GNorm = 3.6212, lr_0 = 1.0950e-04
Validation rmse = 0.100297
Epoch 51
Loss = 2.3295e-01, PNorm = 34.8830, GNorm = 2.0472, lr_0 = 1.0288e-04
Validation rmse = 0.092888
Epoch 52
Loss = 2.4775e-01, PNorm = 34.8913, GNorm = 1.5297, lr_0 = 1.0000e-04
Validation rmse = 0.094337
Epoch 53
Validation rmse = 0.087248
Epoch 54
Loss = 2.4429e-01, PNorm = 34.8993, GNorm = 0.8182, lr_0 = 1.0000e-04
Validation rmse = 0.097781
Epoch 55
Loss = 2.9263e-01, PNorm = 34.9071, GNorm = 1.3320, lr_0 = 1.0000e-04
Validation rmse = 0.098194
Epoch 56
Loss = 2.6509e-01, PNorm = 34.9155, GNorm = 3.9921, lr_0 = 1.0000e-04
Validation rmse = 0.094931
Epoch 57
Loss = 2.4428e-01, PNorm = 34.9229, GNorm = 1.1304, lr_0 = 1.0000e-04
Validation rmse = 0.092523
Epoch 58
Validation rmse = 0.107908
Epoch 59
Loss = 2.6490e-01, PNorm = 34.9315, GNorm = 2.0677, lr_0 = 1.0000e-04
Validation rmse = 0.086587
Model 0 best validation rmse = 0.079074 on epoch 11
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.238644
Ensemble test rmse = 0.238644
1-fold cross validation
	Seed 0 ==> test rmse = 0.238644
Overall test rmse = 0.238644 +/- 0.000000
Elapsed time = 0:00:17
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 397 | train size = 393 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.420896
Epoch 1
Loss = 8.3922e-01, PNorm = 34.0256, GNorm = 1.4292, lr_0 = 8.7143e-04
Validation rmse = 0.248536
Epoch 2
Loss = 6.6013e-01, PNorm = 34.0760, GNorm = 2.8430, lr_0 = 9.5564e-04
Validation rmse = 0.199580
Epoch 3
Loss = 5.7909e-01, PNorm = 34.1303, GNorm = 3.7481, lr_0 = 9.0295e-04
Validation rmse = 0.164316
Epoch 4
Validation rmse = 0.234213
Epoch 5
Loss = 3.8737e-01, PNorm = 34.1742, GNorm = 2.5105, lr_0 = 8.5317e-04
Validation rmse = 0.176144
Epoch 6
Loss = 4.2977e-01, PNorm = 34.2053, GNorm = 0.9368, lr_0 = 8.0613e-04
Validation rmse = 0.175172
Epoch 7
Loss = 3.8447e-01, PNorm = 34.2385, GNorm = 1.4429, lr_0 = 7.6168e-04
Validation rmse = 0.161231
Epoch 8
Loss = 4.1635e-01, PNorm = 34.2737, GNorm = 2.4734, lr_0 = 7.1562e-04
Validation rmse = 0.119459
Epoch 9
Validation rmse = 0.113159
Epoch 10
Loss = 4.8133e-01, PNorm = 34.2977, GNorm = 1.7626, lr_0 = 6.7616e-04
Validation rmse = 0.121926
Epoch 11
Loss = 3.7970e-01, PNorm = 34.3255, GNorm = 0.9184, lr_0 = 6.3888e-04
Validation rmse = 0.096937
Epoch 12
Loss = 3.8211e-01, PNorm = 34.3498, GNorm = 1.3059, lr_0 = 6.0365e-04
Validation rmse = 0.176515
Epoch 13
Loss = 4.5515e-01, PNorm = 34.3712, GNorm = 1.3599, lr_0 = 5.7037e-04
Validation rmse = 0.187660
Epoch 14
Validation rmse = 0.145785
Epoch 15
Loss = 3.8426e-01, PNorm = 34.4000, GNorm = 1.6686, lr_0 = 5.3588e-04
Validation rmse = 0.111549
Epoch 16
Loss = 3.7239e-01, PNorm = 34.4251, GNorm = 3.7386, lr_0 = 5.0633e-04
Validation rmse = 0.119631
Epoch 17
Loss = 3.4341e-01, PNorm = 34.4503, GNorm = 4.7988, lr_0 = 4.7841e-04
Validation rmse = 0.125114
Epoch 18
Validation rmse = 0.153996
Epoch 19
Loss = 2.7719e-01, PNorm = 34.4725, GNorm = 4.1118, lr_0 = 4.5204e-04
Validation rmse = 0.099133
Epoch 20
Loss = 2.6572e-01, PNorm = 34.4939, GNorm = 4.2464, lr_0 = 4.2711e-04
Validation rmse = 0.127796
Epoch 21
Loss = 3.0603e-01, PNorm = 34.5152, GNorm = 1.4796, lr_0 = 4.0356e-04
Validation rmse = 0.077255
Epoch 22
Loss = 3.4303e-01, PNorm = 34.5402, GNorm = 1.3036, lr_0 = 3.7916e-04
Validation rmse = 0.094179
Epoch 23
Validation rmse = 0.113820
Epoch 24
Loss = 3.6401e-01, PNorm = 34.5632, GNorm = 1.1478, lr_0 = 3.5825e-04
Validation rmse = 0.134950
Epoch 25
Loss = 3.2505e-01, PNorm = 34.5847, GNorm = 5.4061, lr_0 = 3.3850e-04
Validation rmse = 0.118480
Epoch 26
Loss = 3.2958e-01, PNorm = 34.6067, GNorm = 1.6581, lr_0 = 3.1984e-04
Validation rmse = 0.156163
Epoch 27
Loss = 3.3417e-01, PNorm = 34.6266, GNorm = 2.9723, lr_0 = 3.0220e-04
Validation rmse = 0.150537
Epoch 28
Validation rmse = 0.154820
Epoch 29
Loss = 3.2512e-01, PNorm = 34.6473, GNorm = 5.1333, lr_0 = 2.8392e-04
Validation rmse = 0.123532
Epoch 30
Loss = 2.5989e-01, PNorm = 34.6640, GNorm = 5.3326, lr_0 = 2.6827e-04
Validation rmse = 0.078929
Epoch 31
Loss = 2.9304e-01, PNorm = 34.6809, GNorm = 3.8153, lr_0 = 2.5348e-04
Validation rmse = 0.103387
Epoch 32
Validation rmse = 0.144165
Epoch 33
Loss = 2.4710e-01, PNorm = 34.6974, GNorm = 4.8763, lr_0 = 2.3950e-04
Validation rmse = 0.145877
Epoch 34
Loss = 2.6368e-01, PNorm = 34.7132, GNorm = 1.2021, lr_0 = 2.2630e-04
Validation rmse = 0.078268
Epoch 35
Loss = 2.7168e-01, PNorm = 34.7278, GNorm = 0.9712, lr_0 = 2.1382e-04
Validation rmse = 0.081772
Epoch 36
Loss = 2.7825e-01, PNorm = 34.7435, GNorm = 3.7228, lr_0 = 2.0089e-04
Validation rmse = 0.125142
Epoch 37
Validation rmse = 0.117184
Epoch 38
Loss = 2.2350e-01, PNorm = 34.7576, GNorm = 4.3744, lr_0 = 1.8981e-04
Validation rmse = 0.062006
Epoch 39
Loss = 2.9034e-01, PNorm = 34.7695, GNorm = 0.9746, lr_0 = 1.7935e-04
Validation rmse = 0.114506
Epoch 40
Loss = 2.6872e-01, PNorm = 34.7814, GNorm = 3.4783, lr_0 = 1.6946e-04
Validation rmse = 0.094768
Epoch 41
Loss = 2.6553e-01, PNorm = 34.7940, GNorm = 1.0165, lr_0 = 1.6012e-04
Validation rmse = 0.076135
Epoch 42
Validation rmse = 0.112736
Epoch 43
Loss = 2.4687e-01, PNorm = 34.8062, GNorm = 3.3992, lr_0 = 1.5043e-04
Validation rmse = 0.076677
Epoch 44
Loss = 2.4655e-01, PNorm = 34.8165, GNorm = 1.3239, lr_0 = 1.4214e-04
Validation rmse = 0.125669
Epoch 45
Loss = 2.7272e-01, PNorm = 34.8265, GNorm = 1.6975, lr_0 = 1.3430e-04
Validation rmse = 0.096184
Epoch 46
Validation rmse = 0.078303
Epoch 47
Loss = 2.7079e-01, PNorm = 34.8357, GNorm = 0.8961, lr_0 = 1.2690e-04
Validation rmse = 0.111893
Epoch 48
Loss = 2.7591e-01, PNorm = 34.8452, GNorm = 1.5059, lr_0 = 1.1990e-04
Validation rmse = 0.086631
Epoch 49
Loss = 2.9703e-01, PNorm = 34.8541, GNorm = 1.8065, lr_0 = 1.1329e-04
Validation rmse = 0.094015
Epoch 50
Loss = 2.4568e-01, PNorm = 34.8625, GNorm = 4.4597, lr_0 = 1.0704e-04
Loss = 2.5766e-01, PNorm = 34.8633, GNorm = 1.2708, lr_0 = 1.0644e-04
Validation rmse = 0.098131
Epoch 51
Validation rmse = 0.088780
Epoch 52
Loss = 1.6039e-01, PNorm = 34.8710, GNorm = 2.0650, lr_0 = 1.0057e-04
Validation rmse = 0.109576
Epoch 53
Loss = 2.0768e-01, PNorm = 34.8785, GNorm = 1.0479, lr_0 = 1.0000e-04
Validation rmse = 0.093375
Epoch 54
Loss = 2.5054e-01, PNorm = 34.8864, GNorm = 1.4160, lr_0 = 1.0000e-04
Validation rmse = 0.080165
Epoch 55
Loss = 2.5264e-01, PNorm = 34.8937, GNorm = 4.7362, lr_0 = 1.0000e-04
Validation rmse = 0.118517
Epoch 56
Validation rmse = 0.083670
Epoch 57
Loss = 2.1986e-01, PNorm = 34.9017, GNorm = 1.4676, lr_0 = 1.0000e-04
Validation rmse = 0.115501
Epoch 58
Loss = 2.3040e-01, PNorm = 34.9099, GNorm = 1.9250, lr_0 = 1.0000e-04
Validation rmse = 0.067668
Epoch 59
Loss = 2.3481e-01, PNorm = 34.9175, GNorm = 5.7605, lr_0 = 1.0000e-04
Validation rmse = 0.118110
Model 0 best validation rmse = 0.062006 on epoch 38
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.135017
Ensemble test rmse = 0.135017
1-fold cross validation
	Seed 0 ==> test rmse = 0.135017
Overall test rmse = 0.135017 +/- 0.000000
Elapsed time = 0:00:17
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 392 | train size = 388 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.155826
Epoch 1
Loss = 8.2004e-01, PNorm = 34.0277, GNorm = 4.7170, lr_0 = 8.7143e-04
Validation rmse = 0.163311
Epoch 2
Loss = 6.3007e-01, PNorm = 34.0756, GNorm = 6.2129, lr_0 = 9.5564e-04
Validation rmse = 0.077935
Epoch 3
Loss = 5.8699e-01, PNorm = 34.1306, GNorm = 6.8503, lr_0 = 9.0295e-04
Validation rmse = 0.105879
Epoch 4
Validation rmse = 0.105015
Epoch 5
Loss = 4.2379e-01, PNorm = 34.1743, GNorm = 0.9177, lr_0 = 8.4834e-04
Validation rmse = 0.073531
Epoch 6
Loss = 4.1085e-01, PNorm = 34.2165, GNorm = 1.4068, lr_0 = 8.0157e-04
Validation rmse = 0.017006
Epoch 7
Loss = 4.4212e-01, PNorm = 34.2470, GNorm = 5.4003, lr_0 = 7.5737e-04
Validation rmse = 0.062017
Epoch 8
Validation rmse = 0.052445
Epoch 9
Loss = 5.3718e-01, PNorm = 34.2841, GNorm = 2.7177, lr_0 = 7.1157e-04
Validation rmse = 0.042716
Epoch 10
Loss = 3.8005e-01, PNorm = 34.3112, GNorm = 2.1063, lr_0 = 6.7234e-04
Validation rmse = 0.047005
Epoch 11
Loss = 3.9081e-01, PNorm = 34.3393, GNorm = 1.3040, lr_0 = 6.3527e-04
Validation rmse = 0.061372
Epoch 12
Loss = 3.8947e-01, PNorm = 34.3621, GNorm = 3.4511, lr_0 = 6.0024e-04
Loss = 3.5045e-01, PNorm = 34.3644, GNorm = 2.6634, lr_0 = 5.9685e-04
Validation rmse = 0.056379
Epoch 13
Validation rmse = 0.048093
Epoch 14
Loss = 3.7042e-01, PNorm = 34.3893, GNorm = 0.7752, lr_0 = 5.6394e-04
Validation rmse = 0.067612
Epoch 15
Loss = 3.3662e-01, PNorm = 34.4144, GNorm = 1.8788, lr_0 = 5.3285e-04
Validation rmse = 0.071489
Epoch 16
Loss = 3.3357e-01, PNorm = 34.4415, GNorm = 1.7453, lr_0 = 5.0347e-04
Validation rmse = 0.079284
Epoch 17
Validation rmse = 0.084945
Epoch 18
Loss = 3.5014e-01, PNorm = 34.4696, GNorm = 1.6624, lr_0 = 4.7302e-04
Validation rmse = 0.121859
Epoch 19
Loss = 4.4953e-01, PNorm = 34.4950, GNorm = 3.4235, lr_0 = 4.4694e-04
Validation rmse = 0.131439
Epoch 20
Loss = 4.5584e-01, PNorm = 34.5159, GNorm = 2.1358, lr_0 = 4.2229e-04
Validation rmse = 0.042106
Epoch 21
Loss = 3.8738e-01, PNorm = 34.5429, GNorm = 2.4041, lr_0 = 3.9675e-04
Validation rmse = 0.054936
Epoch 22
Validation rmse = 0.088306
Epoch 23
Loss = 2.8384e-01, PNorm = 34.5625, GNorm = 2.3331, lr_0 = 3.7488e-04
Validation rmse = 0.102634
Epoch 24
Loss = 2.9892e-01, PNorm = 34.5824, GNorm = 0.8892, lr_0 = 3.5421e-04
Validation rmse = 0.074417
Epoch 25
Loss = 3.3098e-01, PNorm = 34.6036, GNorm = 1.5808, lr_0 = 3.3468e-04
Validation rmse = 0.080214
Epoch 26
Validation rmse = 0.093200
Epoch 27
Loss = 2.9202e-01, PNorm = 34.6229, GNorm = 1.3719, lr_0 = 3.1444e-04
Validation rmse = 0.088649
Epoch 28
Loss = 3.3472e-01, PNorm = 34.6417, GNorm = 1.7749, lr_0 = 2.9710e-04
Validation rmse = 0.109567
Epoch 29
Loss = 3.1051e-01, PNorm = 34.6606, GNorm = 1.5182, lr_0 = 2.8072e-04
Validation rmse = 0.097047
Epoch 30
Loss = 2.9948e-01, PNorm = 34.6805, GNorm = 6.7117, lr_0 = 2.6374e-04
Validation rmse = 0.100462
Epoch 31
Validation rmse = 0.081675
Epoch 32
Loss = 3.2272e-01, PNorm = 34.6974, GNorm = 2.5871, lr_0 = 2.4920e-04
Validation rmse = 0.129527
Epoch 33
Loss = 2.4065e-01, PNorm = 34.7139, GNorm = 2.0663, lr_0 = 2.3546e-04
Validation rmse = 0.092689
Epoch 34
Loss = 2.8905e-01, PNorm = 34.7300, GNorm = 1.9670, lr_0 = 2.2122e-04
Validation rmse = 0.085222
Epoch 35
Validation rmse = 0.109198
Epoch 36
Loss = 2.9765e-01, PNorm = 34.7461, GNorm = 6.5007, lr_0 = 2.0902e-04
Validation rmse = 0.098871
Epoch 37
Loss = 2.9587e-01, PNorm = 34.7608, GNorm = 1.8411, lr_0 = 1.9750e-04
Validation rmse = 0.095083
Epoch 38
Loss = 2.7299e-01, PNorm = 34.7773, GNorm = 1.1123, lr_0 = 1.8556e-04
Validation rmse = 0.103295
Epoch 39
Loss = 2.7198e-01, PNorm = 34.7912, GNorm = 3.0958, lr_0 = 1.7532e-04
Validation rmse = 0.110200
Epoch 40
Validation rmse = 0.093489
Epoch 41
Loss = 3.0916e-01, PNorm = 34.8040, GNorm = 6.6257, lr_0 = 1.6566e-04
Validation rmse = 0.107442
Epoch 42
Loss = 2.4071e-01, PNorm = 34.8180, GNorm = 3.8102, lr_0 = 1.5564e-04
Validation rmse = 0.113040
Epoch 43
Loss = 2.6522e-01, PNorm = 34.8295, GNorm = 5.4074, lr_0 = 1.4706e-04
Validation rmse = 0.107815
Epoch 44
Validation rmse = 0.097379
Epoch 45
Loss = 1.6510e-01, PNorm = 34.8402, GNorm = 0.7394, lr_0 = 1.3895e-04
Validation rmse = 0.110516
Epoch 46
Loss = 3.0667e-01, PNorm = 34.8520, GNorm = 4.4804, lr_0 = 1.3055e-04
Validation rmse = 0.096709
Epoch 47
Loss = 2.4519e-01, PNorm = 34.8623, GNorm = 1.3212, lr_0 = 1.2335e-04
Validation rmse = 0.110701
Epoch 48
Loss = 2.6324e-01, PNorm = 34.8715, GNorm = 2.5392, lr_0 = 1.1655e-04
Validation rmse = 0.106482
Epoch 49
Validation rmse = 0.103210
Epoch 50
Loss = 2.1546e-01, PNorm = 34.8809, GNorm = 1.2409, lr_0 = 1.1012e-04
Validation rmse = 0.109964
Epoch 51
Loss = 2.3056e-01, PNorm = 34.8901, GNorm = 1.9084, lr_0 = 1.0346e-04
Validation rmse = 0.107186
Epoch 52
Loss = 2.4753e-01, PNorm = 34.8981, GNorm = 3.2805, lr_0 = 1.0000e-04
Validation rmse = 0.103202
Epoch 53
Validation rmse = 0.103422
Epoch 54
Loss = 2.2911e-01, PNorm = 34.9060, GNorm = 4.7852, lr_0 = 1.0000e-04
Validation rmse = 0.103943
Epoch 55
Loss = 2.3592e-01, PNorm = 34.9150, GNorm = 3.4436, lr_0 = 1.0000e-04
Validation rmse = 0.107046
Epoch 56
Loss = 2.5206e-01, PNorm = 34.9228, GNorm = 0.8730, lr_0 = 1.0000e-04
Validation rmse = 0.099140
Epoch 57
Loss = 2.4446e-01, PNorm = 34.9311, GNorm = 2.0465, lr_0 = 1.0000e-04
Validation rmse = 0.107850
Epoch 58
Validation rmse = 0.106682
Epoch 59
Loss = 2.7139e-01, PNorm = 34.9402, GNorm = 0.9962, lr_0 = 1.0000e-04
Validation rmse = 0.110285
Model 0 best validation rmse = 0.017006 on epoch 6
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.159365
Ensemble test rmse = 0.159365
1-fold cross validation
	Seed 0 ==> test rmse = 0.159365
Overall test rmse = 0.159365 +/- 0.000000
Elapsed time = 0:00:17
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 387 | train size = 383 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.382931
Epoch 1
Loss = 7.4887e-01, PNorm = 34.0323, GNorm = 5.7070, lr_0 = 8.7143e-04
Validation rmse = 0.405420
Epoch 2
Loss = 7.0515e-01, PNorm = 34.0808, GNorm = 9.1930, lr_0 = 9.5564e-04
Validation rmse = 0.389120
Epoch 3
Loss = 5.3806e-01, PNorm = 34.1289, GNorm = 3.5091, lr_0 = 8.9785e-04
Validation rmse = 0.404748
Epoch 4
Validation rmse = 0.411072
Epoch 5
Loss = 4.6998e-01, PNorm = 34.1758, GNorm = 9.4041, lr_0 = 8.4834e-04
Validation rmse = 0.411738
Epoch 6
Loss = 4.4790e-01, PNorm = 34.2144, GNorm = 1.7382, lr_0 = 7.9704e-04
Validation rmse = 0.421178
Epoch 7
Loss = 4.6063e-01, PNorm = 34.2431, GNorm = 1.4653, lr_0 = 7.5309e-04
Validation rmse = 0.427113
Epoch 8
Validation rmse = 0.428906
Epoch 9
Loss = 4.0494e-01, PNorm = 34.2752, GNorm = 1.5678, lr_0 = 7.0754e-04
Validation rmse = 0.419108
Epoch 10
Loss = 3.9014e-01, PNorm = 34.3043, GNorm = 1.7662, lr_0 = 6.6853e-04
Validation rmse = 0.422037
Epoch 11
Loss = 3.8798e-01, PNorm = 34.3303, GNorm = 3.8123, lr_0 = 6.3167e-04
Validation rmse = 0.423232
Epoch 12
Validation rmse = 0.424067
Epoch 13
Loss = 2.9276e-01, PNorm = 34.3548, GNorm = 3.9523, lr_0 = 5.9347e-04
Validation rmse = 0.428840
Epoch 14
Loss = 3.9859e-01, PNorm = 34.3779, GNorm = 7.3137, lr_0 = 5.6075e-04
Validation rmse = 0.425944
Epoch 15
Loss = 3.6362e-01, PNorm = 34.4072, GNorm = 1.3082, lr_0 = 5.2684e-04
Validation rmse = 0.423396
Epoch 16
Loss = 3.8440e-01, PNorm = 34.4320, GNorm = 3.5024, lr_0 = 4.9779e-04
Validation rmse = 0.429159
Epoch 17
Validation rmse = 0.423532
Epoch 18
Loss = 3.2414e-01, PNorm = 34.4591, GNorm = 4.5373, lr_0 = 4.6768e-04
Validation rmse = 0.432179
Epoch 19
Loss = 4.1895e-01, PNorm = 34.4805, GNorm = 3.0136, lr_0 = 4.4190e-04
Validation rmse = 0.420783
Epoch 20
Loss = 3.5945e-01, PNorm = 34.5034, GNorm = 1.5870, lr_0 = 4.1753e-04
Loss = 4.3088e-01, PNorm = 34.5056, GNorm = 0.8620, lr_0 = 4.1517e-04
Validation rmse = 0.426707
Epoch 21
Validation rmse = 0.419715
Epoch 22
Loss = 3.3920e-01, PNorm = 34.5247, GNorm = 3.4450, lr_0 = 3.9228e-04
Validation rmse = 0.418039
Epoch 23
Loss = 3.2330e-01, PNorm = 34.5446, GNorm = 2.8642, lr_0 = 3.7065e-04
Validation rmse = 0.427112
Epoch 24
Loss = 3.4495e-01, PNorm = 34.5640, GNorm = 4.4361, lr_0 = 3.4823e-04
Validation rmse = 0.421619
Epoch 25
Validation rmse = 0.419167
Epoch 26
Loss = 3.3793e-01, PNorm = 34.5816, GNorm = 0.8977, lr_0 = 3.2903e-04
Validation rmse = 0.416018
Epoch 27
Loss = 2.9986e-01, PNorm = 34.6016, GNorm = 1.4848, lr_0 = 3.0913e-04
Validation rmse = 0.419398
Epoch 28
Loss = 3.3041e-01, PNorm = 34.6174, GNorm = 2.3621, lr_0 = 2.9209e-04
Validation rmse = 0.418879
Epoch 29
Validation rmse = 0.425028
Epoch 30
Loss = 1.9156e-01, PNorm = 34.6369, GNorm = 1.9877, lr_0 = 2.7442e-04
Validation rmse = 0.412648
Epoch 31
Loss = 3.0251e-01, PNorm = 34.6528, GNorm = 4.4514, lr_0 = 2.5929e-04
Validation rmse = 0.418713
Epoch 32
Loss = 2.9850e-01, PNorm = 34.6688, GNorm = 0.6791, lr_0 = 2.4500e-04
Validation rmse = 0.422683
Epoch 33
Loss = 3.1576e-01, PNorm = 34.6853, GNorm = 6.0416, lr_0 = 2.3018e-04
Validation rmse = 0.417287
Epoch 34
Validation rmse = 0.411546
Epoch 35
Loss = 3.0329e-01, PNorm = 34.6989, GNorm = 0.8651, lr_0 = 2.1749e-04
Validation rmse = 0.417263
Epoch 36
Loss = 3.2242e-01, PNorm = 34.7140, GNorm = 2.9269, lr_0 = 2.0434e-04
Validation rmse = 0.420476
Epoch 37
Loss = 2.7820e-01, PNorm = 34.7271, GNorm = 4.3314, lr_0 = 1.9307e-04
Validation rmse = 0.420896
Epoch 38
Validation rmse = 0.420707
Epoch 39
Loss = 2.9938e-01, PNorm = 34.7422, GNorm = 0.7911, lr_0 = 1.8139e-04
Validation rmse = 0.417802
Epoch 40
Loss = 2.9653e-01, PNorm = 34.7542, GNorm = 4.2327, lr_0 = 1.7139e-04
Validation rmse = 0.417253
Epoch 41
Loss = 2.9658e-01, PNorm = 34.7659, GNorm = 2.9168, lr_0 = 1.6194e-04
Validation rmse = 0.416138
Epoch 42
Validation rmse = 0.413497
Epoch 43
Loss = 2.4940e-01, PNorm = 34.7782, GNorm = 1.2784, lr_0 = 1.5215e-04
Validation rmse = 0.414669
Epoch 44
Loss = 2.4173e-01, PNorm = 34.7894, GNorm = 2.9350, lr_0 = 1.4376e-04
Validation rmse = 0.416236
Epoch 45
Loss = 2.6228e-01, PNorm = 34.8003, GNorm = 1.0275, lr_0 = 1.3506e-04
Validation rmse = 0.412445
Epoch 46
Loss = 2.6063e-01, PNorm = 34.8109, GNorm = 0.9365, lr_0 = 1.2762e-04
Validation rmse = 0.414501
Epoch 47
Validation rmse = 0.413966
Epoch 48
Loss = 2.1906e-01, PNorm = 34.8211, GNorm = 1.3695, lr_0 = 1.1990e-04
Validation rmse = 0.414590
Epoch 49
Loss = 2.6092e-01, PNorm = 34.8299, GNorm = 0.7877, lr_0 = 1.1329e-04
Validation rmse = 0.413713
Epoch 50
Loss = 2.5634e-01, PNorm = 34.8384, GNorm = 3.4799, lr_0 = 1.0704e-04
Loss = 2.7187e-01, PNorm = 34.8393, GNorm = 1.2803, lr_0 = 1.0644e-04
Validation rmse = 0.413274
Epoch 51
Validation rmse = 0.417273
Epoch 52
Loss = 2.0404e-01, PNorm = 34.8478, GNorm = 1.6081, lr_0 = 1.0057e-04
Validation rmse = 0.414271
Epoch 53
Loss = 2.8351e-01, PNorm = 34.8567, GNorm = 5.4893, lr_0 = 1.0000e-04
Validation rmse = 0.414012
Epoch 54
Loss = 2.5812e-01, PNorm = 34.8652, GNorm = 1.2408, lr_0 = 1.0000e-04
Validation rmse = 0.413650
Epoch 55
Validation rmse = 0.414349
Epoch 56
Loss = 2.6300e-01, PNorm = 34.8738, GNorm = 1.2310, lr_0 = 1.0000e-04
Validation rmse = 0.417539
Epoch 57
Loss = 2.3644e-01, PNorm = 34.8815, GNorm = 1.7769, lr_0 = 1.0000e-04
Validation rmse = 0.412719
Epoch 58
Loss = 2.4521e-01, PNorm = 34.8893, GNorm = 1.0986, lr_0 = 1.0000e-04
Validation rmse = 0.411467
Epoch 59
Validation rmse = 0.413099
Model 0 best validation rmse = 0.382931 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.188114
Ensemble test rmse = 0.188114
1-fold cross validation
	Seed 0 ==> test rmse = 0.188114
Overall test rmse = 0.188114 +/- 0.000000
Elapsed time = 0:00:16
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 382 | train size = 378 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.425033
Epoch 1
Loss = 6.7096e-01, PNorm = 34.0305, GNorm = 1.1742, lr_0 = 8.7143e-04
Validation rmse = 0.347078
Epoch 2
Loss = 5.9550e-01, PNorm = 34.0769, GNorm = 16.7819, lr_0 = 9.5564e-04
Validation rmse = 0.335140
Epoch 3
Loss = 5.2707e-01, PNorm = 34.1245, GNorm = 7.7112, lr_0 = 8.9785e-04
Validation rmse = 0.283311
Epoch 4
Validation rmse = 0.292246
Epoch 5
Loss = 4.5863e-01, PNorm = 34.1687, GNorm = 7.0820, lr_0 = 8.4355e-04
Validation rmse = 0.392049
Epoch 6
Loss = 4.6235e-01, PNorm = 34.2008, GNorm = 1.7536, lr_0 = 7.9704e-04
Validation rmse = 0.295937
Epoch 7
Loss = 4.0930e-01, PNorm = 34.2365, GNorm = 5.3430, lr_0 = 7.4883e-04
Validation rmse = 0.277549
Epoch 8
Validation rmse = 0.309677
Epoch 9
Loss = 3.5130e-01, PNorm = 34.2647, GNorm = 1.1187, lr_0 = 7.0754e-04
Validation rmse = 0.300477
Epoch 10
Loss = 3.7647e-01, PNorm = 34.2979, GNorm = 3.2281, lr_0 = 6.6475e-04
Validation rmse = 0.201137
Epoch 11
Loss = 4.2834e-01, PNorm = 34.3214, GNorm = 6.9583, lr_0 = 6.2810e-04
Loss = 3.3755e-01, PNorm = 34.3244, GNorm = 2.6775, lr_0 = 6.2455e-04
Validation rmse = 0.237231
Epoch 12
Validation rmse = 0.273561
Epoch 13
Loss = 3.2266e-01, PNorm = 34.3544, GNorm = 3.9446, lr_0 = 5.9011e-04
Validation rmse = 0.201853
Epoch 14
Loss = 4.2376e-01, PNorm = 34.3831, GNorm = 7.2115, lr_0 = 5.5442e-04
Validation rmse = 0.201725
Epoch 15
Loss = 3.4274e-01, PNorm = 34.4091, GNorm = 4.5029, lr_0 = 5.2386e-04
Loss = 6.5873e-01, PNorm = 34.4110, GNorm = 1.9293, lr_0 = 5.2089e-04
Validation rmse = 0.220211
Epoch 16
Validation rmse = 0.230622
Epoch 17
Loss = 3.6117e-01, PNorm = 34.4338, GNorm = 1.5388, lr_0 = 4.9217e-04
Validation rmse = 0.183904
Epoch 18
Loss = 3.8304e-01, PNorm = 34.4590, GNorm = 2.1983, lr_0 = 4.6504e-04
Validation rmse = 0.214065
Epoch 19
Loss = 3.2890e-01, PNorm = 34.4855, GNorm = 2.9702, lr_0 = 4.3691e-04
Validation rmse = 0.220642
Epoch 20
Validation rmse = 0.266863
Epoch 21
Loss = 3.0760e-01, PNorm = 34.5083, GNorm = 2.2831, lr_0 = 4.1049e-04
Validation rmse = 0.214832
Epoch 22
Loss = 2.4966e-01, PNorm = 34.5323, GNorm = 1.6407, lr_0 = 3.8786e-04
Validation rmse = 0.232469
Epoch 23
Loss = 3.2462e-01, PNorm = 34.5548, GNorm = 2.3960, lr_0 = 3.6440e-04
Validation rmse = 0.209660
Epoch 24
Validation rmse = 0.243346
Epoch 25
Loss = 2.2436e-01, PNorm = 34.5773, GNorm = 1.5270, lr_0 = 3.4431e-04
Validation rmse = 0.270723
Epoch 26
Loss = 3.1292e-01, PNorm = 34.5998, GNorm = 4.5645, lr_0 = 3.2348e-04
Validation rmse = 0.220636
Epoch 27
Loss = 3.3088e-01, PNorm = 34.6197, GNorm = 1.9999, lr_0 = 3.0565e-04
Validation rmse = 0.208456
Epoch 28
Validation rmse = 0.209225
Epoch 29
Loss = 3.0538e-01, PNorm = 34.6412, GNorm = 6.0992, lr_0 = 2.8716e-04
Validation rmse = 0.258218
Epoch 30
Loss = 3.0483e-01, PNorm = 34.6618, GNorm = 1.3201, lr_0 = 2.6980e-04
Validation rmse = 0.259749
Epoch 31
Loss = 3.0340e-01, PNorm = 34.6790, GNorm = 2.5290, lr_0 = 2.5492e-04
Validation rmse = 0.224414
Epoch 32
Validation rmse = 0.222001
Epoch 33
Loss = 1.7103e-01, PNorm = 34.6979, GNorm = 0.8427, lr_0 = 2.3950e-04
Validation rmse = 0.237730
Epoch 34
Loss = 3.0761e-01, PNorm = 34.7136, GNorm = 1.9282, lr_0 = 2.2630e-04
Validation rmse = 0.258472
Epoch 35
Loss = 2.4635e-01, PNorm = 34.7307, GNorm = 1.6069, lr_0 = 2.1261e-04
Validation rmse = 0.211668
Epoch 36
Validation rmse = 0.275429
Epoch 37
Loss = 2.5371e-01, PNorm = 34.7468, GNorm = 5.0104, lr_0 = 1.9975e-04
Validation rmse = 0.261778
Epoch 38
Loss = 2.5652e-01, PNorm = 34.7616, GNorm = 1.9712, lr_0 = 1.8874e-04
Validation rmse = 0.230369
Epoch 39
Loss = 2.4762e-01, PNorm = 34.7761, GNorm = 1.9220, lr_0 = 1.7732e-04
Validation rmse = 0.280275
Epoch 40
Validation rmse = 0.233470
Epoch 41
Loss = 1.8995e-01, PNorm = 34.7890, GNorm = 1.4171, lr_0 = 1.6660e-04
Validation rmse = 0.249236
Epoch 42
Loss = 2.5045e-01, PNorm = 34.8006, GNorm = 1.8548, lr_0 = 1.5741e-04
Validation rmse = 0.263314
Epoch 43
Loss = 2.5822e-01, PNorm = 34.8118, GNorm = 2.3889, lr_0 = 1.4874e-04
Validation rmse = 0.233038
Epoch 44
Loss = 2.4016e-01, PNorm = 34.8236, GNorm = 1.6546, lr_0 = 1.3974e-04
Validation rmse = 0.259887
Epoch 45
Validation rmse = 0.239435
Epoch 46
Loss = 2.2405e-01, PNorm = 34.8350, GNorm = 4.3793, lr_0 = 1.3129e-04
Validation rmse = 0.238693
Epoch 47
Loss = 2.3939e-01, PNorm = 34.8452, GNorm = 2.4416, lr_0 = 1.2405e-04
Validation rmse = 0.276585
Epoch 48
Loss = 2.4863e-01, PNorm = 34.8563, GNorm = 7.5735, lr_0 = 1.1655e-04
Validation rmse = 0.230382
Epoch 49
Validation rmse = 0.267190
Epoch 50
Loss = 2.1507e-01, PNorm = 34.8652, GNorm = 4.8608, lr_0 = 1.1012e-04
Validation rmse = 0.243379
Epoch 51
Loss = 2.6398e-01, PNorm = 34.8743, GNorm = 1.7108, lr_0 = 1.0346e-04
Validation rmse = 0.257443
Epoch 52
Loss = 2.3185e-01, PNorm = 34.8826, GNorm = 1.8701, lr_0 = 1.0000e-04
Loss = 2.9960e-01, PNorm = 34.8834, GNorm = 3.0262, lr_0 = 1.0000e-04
Validation rmse = 0.243340
Epoch 53
Validation rmse = 0.250649
Epoch 54
Loss = 2.3527e-01, PNorm = 34.8913, GNorm = 1.2248, lr_0 = 1.0000e-04
Validation rmse = 0.252202
Epoch 55
Loss = 2.3856e-01, PNorm = 34.8999, GNorm = 1.6632, lr_0 = 1.0000e-04
Validation rmse = 0.251245
Epoch 56
Loss = 2.3031e-01, PNorm = 34.9076, GNorm = 2.6189, lr_0 = 1.0000e-04
Loss = 2.4808e-01, PNorm = 34.9085, GNorm = 4.5352, lr_0 = 1.0000e-04
Validation rmse = 0.249610
Epoch 57
Validation rmse = 0.272676
Epoch 58
Loss = 3.3171e-01, PNorm = 34.9169, GNorm = 2.0269, lr_0 = 1.0000e-04
Validation rmse = 0.247267
Epoch 59
Loss = 2.5480e-01, PNorm = 34.9251, GNorm = 2.0288, lr_0 = 1.0000e-04
Validation rmse = 0.268008
Model 0 best validation rmse = 0.183904 on epoch 17
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.073483
Ensemble test rmse = 0.073483
1-fold cross validation
	Seed 0 ==> test rmse = 0.073483
Overall test rmse = 0.073483 +/- 0.000000
Elapsed time = 0:00:16
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 377 | train size = 373 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.226552
Epoch 1
Loss = 7.2026e-01, PNorm = 34.0261, GNorm = 8.0108, lr_0 = 8.7143e-04
Validation rmse = 0.306701
Epoch 2
Loss = 5.8139e-01, PNorm = 34.0856, GNorm = 0.7511, lr_0 = 9.5024e-04
Validation rmse = 0.230802
Epoch 3
Validation rmse = 0.290992
Epoch 4
Loss = 5.3014e-01, PNorm = 34.1422, GNorm = 2.0057, lr_0 = 8.9277e-04
Validation rmse = 0.175574
Epoch 5
Loss = 3.8756e-01, PNorm = 34.1851, GNorm = 3.2656, lr_0 = 8.4355e-04
Validation rmse = 0.120088
Epoch 6
Loss = 4.7793e-01, PNorm = 34.2220, GNorm = 1.6189, lr_0 = 7.9253e-04
Validation rmse = 0.125358
Epoch 7
Validation rmse = 0.109650
Epoch 8
Loss = 6.7924e-01, PNorm = 34.2563, GNorm = 9.3853, lr_0 = 7.4460e-04
Validation rmse = 0.183433
Epoch 9
Loss = 3.8461e-01, PNorm = 34.2846, GNorm = 1.3535, lr_0 = 7.0354e-04
Validation rmse = 0.264464
Epoch 10
Loss = 3.6488e-01, PNorm = 34.3210, GNorm = 5.3285, lr_0 = 6.6099e-04
Validation rmse = 0.253316
Epoch 11
Validation rmse = 0.132113
Epoch 12
Loss = 2.4192e-01, PNorm = 34.3518, GNorm = 1.1961, lr_0 = 6.2102e-04
Validation rmse = 0.171796
Epoch 13
Loss = 3.7272e-01, PNorm = 34.3823, GNorm = 2.2982, lr_0 = 5.8346e-04
Validation rmse = 0.210121
Epoch 14
Loss = 3.0771e-01, PNorm = 34.4074, GNorm = 1.3898, lr_0 = 5.5129e-04
Validation rmse = 0.227557
Epoch 15
Validation rmse = 0.225058
Epoch 16
Loss = 3.0317e-01, PNorm = 34.4342, GNorm = 3.4426, lr_0 = 5.1795e-04
Validation rmse = 0.127963
Epoch 17
Loss = 2.8965e-01, PNorm = 34.4613, GNorm = 0.6200, lr_0 = 4.8662e-04
Validation rmse = 0.174968
Epoch 18
Loss = 2.8158e-01, PNorm = 34.4847, GNorm = 1.3860, lr_0 = 4.5979e-04
Validation rmse = 0.208967
Epoch 19
Validation rmse = 0.175882
Epoch 20
Loss = 2.5670e-01, PNorm = 34.5114, GNorm = 2.0429, lr_0 = 4.3198e-04
Validation rmse = 0.171248
Epoch 21
Loss = 2.5840e-01, PNorm = 34.5356, GNorm = 0.6046, lr_0 = 4.0586e-04
Validation rmse = 0.132209
Epoch 22
Loss = 2.8721e-01, PNorm = 34.5586, GNorm = 3.1142, lr_0 = 3.8348e-04
Validation rmse = 0.121444
Epoch 23
Validation rmse = 0.179044
Epoch 24
Loss = 4.1160e-01, PNorm = 34.5836, GNorm = 3.6464, lr_0 = 3.6029e-04
Validation rmse = 0.185377
Epoch 25
Loss = 3.0412e-01, PNorm = 34.6077, GNorm = 3.0251, lr_0 = 3.3850e-04
Validation rmse = 0.137412
Epoch 26
Loss = 2.6081e-01, PNorm = 34.6319, GNorm = 0.7935, lr_0 = 3.1803e-04
Validation rmse = 0.117786
Epoch 27
Validation rmse = 0.132801
Epoch 28
Loss = 2.4803e-01, PNorm = 34.6532, GNorm = 0.6837, lr_0 = 2.9879e-04
Validation rmse = 0.150730
Epoch 29
Loss = 2.3541e-01, PNorm = 34.6747, GNorm = 1.3363, lr_0 = 2.8232e-04
Validation rmse = 0.120043
Epoch 30
Loss = 2.4515e-01, PNorm = 34.6964, GNorm = 3.1801, lr_0 = 2.6524e-04
Validation rmse = 0.142165
Epoch 31
Validation rmse = 0.124129
Epoch 32
Loss = 2.3070e-01, PNorm = 34.7173, GNorm = 1.2632, lr_0 = 2.4920e-04
Validation rmse = 0.118115
Epoch 33
Loss = 2.0511e-01, PNorm = 34.7353, GNorm = 2.9149, lr_0 = 2.3546e-04
Validation rmse = 0.134385
Epoch 34
Loss = 2.2708e-01, PNorm = 34.7540, GNorm = 2.1579, lr_0 = 2.2122e-04
Validation rmse = 0.120750
Epoch 35
Validation rmse = 0.142742
Epoch 36
Loss = 2.4920e-01, PNorm = 34.7719, GNorm = 0.8994, lr_0 = 2.0784e-04
Validation rmse = 0.140714
Epoch 37
Loss = 2.4559e-01, PNorm = 34.7878, GNorm = 1.6587, lr_0 = 1.9638e-04
Validation rmse = 0.128854
Epoch 38
Loss = 2.1778e-01, PNorm = 34.8042, GNorm = 0.8264, lr_0 = 1.8451e-04
Loss = 2.2769e-01, PNorm = 34.8056, GNorm = 5.8694, lr_0 = 1.8346e-04
Validation rmse = 0.129269
Epoch 39
Validation rmse = 0.150985
Epoch 40
Loss = 1.9744e-01, PNorm = 34.8192, GNorm = 1.5599, lr_0 = 1.7335e-04
Validation rmse = 0.127272
Epoch 41
Loss = 2.1371e-01, PNorm = 34.8332, GNorm = 1.1563, lr_0 = 1.6286e-04
Validation rmse = 0.131736
Epoch 42
Loss = 2.1306e-01, PNorm = 34.8462, GNorm = 1.5319, lr_0 = 1.5388e-04
Loss = 1.9785e-01, PNorm = 34.8475, GNorm = 1.1034, lr_0 = 1.5301e-04
Validation rmse = 0.103033
Epoch 43
Validation rmse = 0.164272
Epoch 44
Loss = 2.0150e-01, PNorm = 34.8594, GNorm = 4.5237, lr_0 = 1.4458e-04
Validation rmse = 0.134828
Epoch 45
Loss = 2.1513e-01, PNorm = 34.8724, GNorm = 1.9949, lr_0 = 1.3583e-04
Validation rmse = 0.102973
Epoch 46
Loss = 2.0795e-01, PNorm = 34.8831, GNorm = 1.0482, lr_0 = 1.2834e-04
Loss = 2.8571e-01, PNorm = 34.8841, GNorm = 5.5578, lr_0 = 1.2762e-04
Validation rmse = 0.140413
Epoch 47
Validation rmse = 0.123696
Epoch 48
Loss = 2.5295e-01, PNorm = 34.8939, GNorm = 0.8838, lr_0 = 1.2058e-04
Validation rmse = 0.119699
Epoch 49
Loss = 1.9677e-01, PNorm = 34.9041, GNorm = 3.3102, lr_0 = 1.1329e-04
Validation rmse = 0.149600
Epoch 50
Loss = 2.0486e-01, PNorm = 34.9124, GNorm = 0.9216, lr_0 = 1.0704e-04
Loss = 1.5654e-01, PNorm = 34.9131, GNorm = 2.1075, lr_0 = 1.0644e-04
Validation rmse = 0.108949
Epoch 51
Validation rmse = 0.144116
Epoch 52
Loss = 1.8868e-01, PNorm = 34.9218, GNorm = 3.3095, lr_0 = 1.0000e-04
Validation rmse = 0.116028
Epoch 53
Loss = 2.0509e-01, PNorm = 34.9293, GNorm = 1.7529, lr_0 = 1.0000e-04
Validation rmse = 0.126624
Epoch 54
Loss = 1.9859e-01, PNorm = 34.9377, GNorm = 3.7852, lr_0 = 1.0000e-04
Validation rmse = 0.128057
Epoch 55
Validation rmse = 0.110054
Epoch 56
Loss = 1.8824e-01, PNorm = 34.9465, GNorm = 1.5970, lr_0 = 1.0000e-04
Validation rmse = 0.127237
Epoch 57
Loss = 2.0423e-01, PNorm = 34.9541, GNorm = 3.5079, lr_0 = 1.0000e-04
Validation rmse = 0.131872
Epoch 58
Loss = 1.8574e-01, PNorm = 34.9632, GNorm = 1.6066, lr_0 = 1.0000e-04
Validation rmse = 0.123849
Epoch 59
Validation rmse = 0.129801
Model 0 best validation rmse = 0.102973 on epoch 45
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.114250
Ensemble test rmse = 0.114250
1-fold cross validation
	Seed 0 ==> test rmse = 0.114250
Overall test rmse = 0.114250 +/- 0.000000
Elapsed time = 0:00:16
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 372 | train size = 368 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.205985
Epoch 1
Loss = 7.4316e-01, PNorm = 34.0303, GNorm = 5.1462, lr_0 = 8.7143e-04
Validation rmse = 0.208863
Epoch 2
Loss = 5.4312e-01, PNorm = 34.0925, GNorm = 10.9335, lr_0 = 9.5024e-04
Validation rmse = 0.142057
Epoch 3
Validation rmse = 0.259529
Epoch 4
Loss = 3.8513e-01, PNorm = 34.1409, GNorm = 5.6922, lr_0 = 8.9277e-04
Validation rmse = 0.202902
Epoch 5
Loss = 3.4946e-01, PNorm = 34.1841, GNorm = 1.0539, lr_0 = 8.3877e-04
Validation rmse = 0.188366
Epoch 6
Loss = 3.3103e-01, PNorm = 34.2207, GNorm = 2.9503, lr_0 = 7.9253e-04
Validation rmse = 0.177239
Epoch 7
Validation rmse = 0.189401
Epoch 8
Loss = 2.7533e-01, PNorm = 34.2526, GNorm = 4.4969, lr_0 = 7.4039e-04
Validation rmse = 0.328239
Epoch 9
Loss = 4.5287e-01, PNorm = 34.2788, GNorm = 13.0101, lr_0 = 6.9956e-04
Validation rmse = 0.116092
Epoch 10
Loss = 3.9647e-01, PNorm = 34.3018, GNorm = 1.1597, lr_0 = 6.5726e-04
Loss = 4.5714e-01, PNorm = 34.3038, GNorm = 4.9079, lr_0 = 6.5354e-04
Validation rmse = 0.142059
Epoch 11
Validation rmse = 0.174573
Epoch 12
Loss = 2.7459e-01, PNorm = 34.3297, GNorm = 3.5714, lr_0 = 6.1750e-04
Validation rmse = 0.187492
Epoch 13
Loss = 3.1751e-01, PNorm = 34.3581, GNorm = 4.0569, lr_0 = 5.8016e-04
Validation rmse = 0.201445
Epoch 14
Loss = 2.8022e-01, PNorm = 34.3804, GNorm = 1.1017, lr_0 = 5.4817e-04
Loss = 2.4474e-01, PNorm = 34.3819, GNorm = 2.2855, lr_0 = 5.4507e-04
Validation rmse = 0.221308
Epoch 15
Validation rmse = 0.162884
Epoch 16
Loss = 2.4974e-01, PNorm = 34.4013, GNorm = 0.6298, lr_0 = 5.1211e-04
Validation rmse = 0.144526
Epoch 17
Loss = 2.7546e-01, PNorm = 34.4189, GNorm = 4.8171, lr_0 = 4.8387e-04
Validation rmse = 0.142298
Epoch 18
Validation rmse = 0.114678
Epoch 19
Loss = 4.3876e-01, PNorm = 34.4419, GNorm = 9.2927, lr_0 = 4.5204e-04
Validation rmse = 0.125184
Epoch 20
Loss = 2.6033e-01, PNorm = 34.4603, GNorm = 3.6773, lr_0 = 4.2711e-04
Validation rmse = 0.250413
Epoch 21
Loss = 2.6091e-01, PNorm = 34.4799, GNorm = 2.8140, lr_0 = 4.0128e-04
Validation rmse = 0.290404
Epoch 22
Validation rmse = 0.240247
Epoch 23
Loss = 2.1223e-01, PNorm = 34.4986, GNorm = 1.7530, lr_0 = 3.7701e-04
Validation rmse = 0.172925
Epoch 24
Loss = 2.1989e-01, PNorm = 34.5179, GNorm = 3.1241, lr_0 = 3.5421e-04
Validation rmse = 0.181099
Epoch 25
Loss = 2.4194e-01, PNorm = 34.5348, GNorm = 8.6476, lr_0 = 3.3468e-04
Validation rmse = 0.169290
Epoch 26
Validation rmse = 0.187014
Epoch 27
Loss = 2.3835e-01, PNorm = 34.5572, GNorm = 1.8436, lr_0 = 3.1266e-04
Validation rmse = 0.181301
Epoch 28
Loss = 2.4479e-01, PNorm = 34.5729, GNorm = 5.7405, lr_0 = 2.9542e-04
Validation rmse = 0.220332
Epoch 29
Loss = 2.1104e-01, PNorm = 34.5878, GNorm = 0.9955, lr_0 = 2.7756e-04
Loss = 3.5705e-01, PNorm = 34.5894, GNorm = 1.6484, lr_0 = 2.7599e-04
Validation rmse = 0.242553
Epoch 30
Validation rmse = 0.232273
Epoch 31
Loss = 2.0642e-01, PNorm = 34.6048, GNorm = 2.0070, lr_0 = 2.6077e-04
Validation rmse = 0.183481
Epoch 32
Loss = 2.3204e-01, PNorm = 34.6200, GNorm = 6.5800, lr_0 = 2.4500e-04
Validation rmse = 0.212787
Epoch 33
Loss = 2.0995e-01, PNorm = 34.6356, GNorm = 4.3414, lr_0 = 2.3018e-04
Validation rmse = 0.243581
Epoch 34
Validation rmse = 0.222974
Epoch 35
Loss = 2.3185e-01, PNorm = 34.6490, GNorm = 3.3115, lr_0 = 2.1626e-04
Validation rmse = 0.224874
Epoch 36
Loss = 1.9112e-01, PNorm = 34.6620, GNorm = 0.9838, lr_0 = 2.0318e-04
Validation rmse = 0.220554
Epoch 37
Validation rmse = 0.216566
Epoch 38
Loss = 1.8826e-01, PNorm = 34.6743, GNorm = 0.9349, lr_0 = 1.9089e-04
Validation rmse = 0.247623
Epoch 39
Loss = 1.6910e-01, PNorm = 34.6853, GNorm = 3.1612, lr_0 = 1.8037e-04
Validation rmse = 0.161981
Epoch 40
Loss = 1.9901e-01, PNorm = 34.6957, GNorm = 4.2526, lr_0 = 1.6946e-04
Validation rmse = 0.225443
Epoch 41
Validation rmse = 0.250751
Epoch 42
Loss = 1.5368e-01, PNorm = 34.7071, GNorm = 1.0452, lr_0 = 1.5921e-04
Validation rmse = 0.176701
Epoch 43
Loss = 1.8846e-01, PNorm = 34.7173, GNorm = 1.5896, lr_0 = 1.4958e-04
Validation rmse = 0.255480
Epoch 44
Loss = 1.8409e-01, PNorm = 34.7265, GNorm = 1.0714, lr_0 = 1.4053e-04
Validation rmse = 0.229251
Epoch 45
Validation rmse = 0.235576
Epoch 46
Loss = 2.0317e-01, PNorm = 34.7364, GNorm = 1.2845, lr_0 = 1.3204e-04
Validation rmse = 0.192600
Epoch 47
Loss = 2.1047e-01, PNorm = 34.7455, GNorm = 2.4091, lr_0 = 1.2405e-04
Validation rmse = 0.253040
Epoch 48
Loss = 1.8701e-01, PNorm = 34.7529, GNorm = 2.7787, lr_0 = 1.1721e-04
Loss = 7.1562e-02, PNorm = 34.7537, GNorm = 2.5312, lr_0 = 1.1655e-04
Validation rmse = 0.205247
Epoch 49
Validation rmse = 0.235783
Epoch 50
Loss = 1.6273e-01, PNorm = 34.7608, GNorm = 1.4731, lr_0 = 1.1012e-04
Validation rmse = 0.219741
Epoch 51
Loss = 1.6526e-01, PNorm = 34.7680, GNorm = 1.7248, lr_0 = 1.0346e-04
Validation rmse = 0.217312
Epoch 52
Loss = 1.7809e-01, PNorm = 34.7755, GNorm = 1.9584, lr_0 = 1.0000e-04
Validation rmse = 0.237818
Epoch 53
Validation rmse = 0.224104
Epoch 54
Loss = 1.6893e-01, PNorm = 34.7821, GNorm = 1.2412, lr_0 = 1.0000e-04
Validation rmse = 0.218025
Epoch 55
Loss = 1.7417e-01, PNorm = 34.7888, GNorm = 0.9836, lr_0 = 1.0000e-04
Validation rmse = 0.247401
Epoch 56
Validation rmse = 0.235697
Epoch 57
Loss = 1.5438e-01, PNorm = 34.7958, GNorm = 2.6267, lr_0 = 1.0000e-04
Validation rmse = 0.224082
Epoch 58
Loss = 1.9530e-01, PNorm = 34.8030, GNorm = 1.2584, lr_0 = 1.0000e-04
Validation rmse = 0.230441
Epoch 59
Loss = 1.7030e-01, PNorm = 34.8096, GNorm = 1.5479, lr_0 = 1.0000e-04
Validation rmse = 0.248220
Model 0 best validation rmse = 0.114678 on epoch 18
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.109711
Ensemble test rmse = 0.109711
1-fold cross validation
	Seed 0 ==> test rmse = 0.109711
Overall test rmse = 0.109711 +/- 0.000000
Elapsed time = 0:00:16
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 367 | train size = 363 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.280795
Epoch 1
Loss = 7.7406e-01, PNorm = 34.0270, GNorm = 3.5793, lr_0 = 8.7143e-04
Validation rmse = 0.302932
Epoch 2
Loss = 6.2996e-01, PNorm = 34.0837, GNorm = 6.0984, lr_0 = 9.5024e-04
Validation rmse = 0.308865
Epoch 3
Validation rmse = 0.295341
Epoch 4
Loss = 7.0630e-01, PNorm = 34.1366, GNorm = 9.6785, lr_0 = 8.9277e-04
Validation rmse = 0.273405
Epoch 5
Loss = 3.9703e-01, PNorm = 34.1895, GNorm = 2.4351, lr_0 = 8.3877e-04
Validation rmse = 0.298491
Epoch 6
Loss = 3.5129e-01, PNorm = 34.2357, GNorm = 2.8597, lr_0 = 7.8805e-04
Loss = 3.0686e-01, PNorm = 34.2392, GNorm = 3.8133, lr_0 = 7.8359e-04
Validation rmse = 0.280600
Epoch 7
Validation rmse = 0.253617
Epoch 8
Loss = 3.3093e-01, PNorm = 34.2717, GNorm = 6.7944, lr_0 = 7.4039e-04
Validation rmse = 0.238820
Epoch 9
Loss = 3.4408e-01, PNorm = 34.3043, GNorm = 6.8222, lr_0 = 6.9561e-04
Validation rmse = 0.229887
Epoch 10
Validation rmse = 0.243220
Epoch 11
Loss = 2.3802e-01, PNorm = 34.3362, GNorm = 1.9107, lr_0 = 6.4984e-04
Validation rmse = 0.238385
Epoch 12
Loss = 2.5353e-01, PNorm = 34.3627, GNorm = 3.3915, lr_0 = 6.1401e-04
Validation rmse = 0.216191
Epoch 13
Loss = 2.5300e-01, PNorm = 34.3868, GNorm = 0.8264, lr_0 = 5.7688e-04
Validation rmse = 0.226150
Epoch 14
Validation rmse = 0.240301
Epoch 15
Loss = 4.0068e-01, PNorm = 34.4099, GNorm = 7.9142, lr_0 = 5.3892e-04
Validation rmse = 0.231015
Epoch 16
Loss = 2.6439e-01, PNorm = 34.4302, GNorm = 0.8590, lr_0 = 5.0921e-04
Validation rmse = 0.220110
Epoch 17
Loss = 2.2801e-01, PNorm = 34.4525, GNorm = 1.9874, lr_0 = 4.7841e-04
Loss = 3.7624e-01, PNorm = 34.4542, GNorm = 2.7048, lr_0 = 4.7571e-04
Validation rmse = 0.200013
Epoch 18
Validation rmse = 0.215063
Epoch 19
Loss = 2.3333e-01, PNorm = 34.4738, GNorm = 5.6413, lr_0 = 4.4694e-04
Validation rmse = 0.198417
Epoch 20
Loss = 2.1360e-01, PNorm = 34.4917, GNorm = 1.1309, lr_0 = 4.2229e-04
Validation rmse = 0.209162
Epoch 21
Validation rmse = 0.183528
Epoch 22
Loss = 2.0862e-01, PNorm = 34.5119, GNorm = 0.5407, lr_0 = 3.9451e-04
Validation rmse = 0.194631
Epoch 23
Loss = 2.2231e-01, PNorm = 34.5299, GNorm = 3.5712, lr_0 = 3.7065e-04
Validation rmse = 0.204731
Epoch 24
Loss = 1.9146e-01, PNorm = 34.5474, GNorm = 0.9894, lr_0 = 3.5022e-04
Validation rmse = 0.214338
Epoch 25
Validation rmse = 0.201875
Epoch 26
Loss = 2.3970e-01, PNorm = 34.5656, GNorm = 0.6894, lr_0 = 3.2717e-04
Validation rmse = 0.209659
Epoch 27
Loss = 1.7377e-01, PNorm = 34.5840, GNorm = 1.0358, lr_0 = 3.0913e-04
Validation rmse = 0.209766
Epoch 28
Loss = 2.0306e-01, PNorm = 34.6009, GNorm = 1.0056, lr_0 = 2.9044e-04
Loss = 1.3525e-01, PNorm = 34.6022, GNorm = 1.8263, lr_0 = 2.8880e-04
Validation rmse = 0.196818
Epoch 29
Validation rmse = 0.207338
Epoch 30
Loss = 2.0483e-01, PNorm = 34.6172, GNorm = 6.5566, lr_0 = 2.7133e-04
Validation rmse = 0.199465
Epoch 31
Loss = 1.9179e-01, PNorm = 34.6299, GNorm = 1.5160, lr_0 = 2.5637e-04
Validation rmse = 0.215809
Epoch 32
Validation rmse = 0.219640
Epoch 33
Loss = 2.1143e-01, PNorm = 34.6457, GNorm = 5.6404, lr_0 = 2.3950e-04
Validation rmse = 0.203926
Epoch 34
Loss = 1.8995e-01, PNorm = 34.6592, GNorm = 1.8615, lr_0 = 2.2502e-04
Validation rmse = 0.213662
Epoch 35
Loss = 1.6921e-01, PNorm = 34.6708, GNorm = 3.0394, lr_0 = 2.1261e-04
Validation rmse = 0.200812
Epoch 36
Validation rmse = 0.196511
Epoch 37
Loss = 1.7541e-01, PNorm = 34.6847, GNorm = 0.9019, lr_0 = 1.9862e-04
Validation rmse = 0.201531
Epoch 38
Loss = 1.9609e-01, PNorm = 34.6972, GNorm = 2.4878, lr_0 = 1.8661e-04
Validation rmse = 0.213260
Epoch 39
Loss = 1.7070e-01, PNorm = 34.7070, GNorm = 0.7310, lr_0 = 1.7632e-04
Loss = 1.4166e-01, PNorm = 34.7081, GNorm = 2.1669, lr_0 = 1.7532e-04
Validation rmse = 0.208968
Epoch 40
Validation rmse = 0.193963
Epoch 41
Loss = 1.5834e-01, PNorm = 34.7196, GNorm = 0.7630, lr_0 = 1.6472e-04
Validation rmse = 0.204506
Epoch 42
Loss = 1.6435e-01, PNorm = 34.7296, GNorm = 1.1751, lr_0 = 1.5476e-04
Validation rmse = 0.188804
Epoch 43
Validation rmse = 0.204639
Epoch 44
Loss = 2.2843e-01, PNorm = 34.7385, GNorm = 2.5013, lr_0 = 1.4540e-04
Validation rmse = 0.196643
Epoch 45
Loss = 1.5905e-01, PNorm = 34.7478, GNorm = 1.3984, lr_0 = 1.3661e-04
Validation rmse = 0.189499
Epoch 46
Loss = 1.5887e-01, PNorm = 34.7563, GNorm = 0.7286, lr_0 = 1.2834e-04
Validation rmse = 0.199040
Epoch 47
Validation rmse = 0.191035
Epoch 48
Loss = 1.5930e-01, PNorm = 34.7638, GNorm = 1.5503, lr_0 = 1.2058e-04
Validation rmse = 0.205646
Epoch 49
Loss = 1.5849e-01, PNorm = 34.7711, GNorm = 1.6775, lr_0 = 1.1329e-04
Validation rmse = 0.206984
Epoch 50
Loss = 1.5582e-01, PNorm = 34.7780, GNorm = 0.6547, lr_0 = 1.0704e-04
Loss = 1.6528e-01, PNorm = 34.7785, GNorm = 1.5374, lr_0 = 1.0644e-04
Validation rmse = 0.205195
Epoch 51
Validation rmse = 0.207218
Epoch 52
Loss = 1.5957e-01, PNorm = 34.7853, GNorm = 0.6731, lr_0 = 1.0000e-04
Validation rmse = 0.201969
Epoch 53
Loss = 1.5802e-01, PNorm = 34.7930, GNorm = 0.9032, lr_0 = 1.0000e-04
Validation rmse = 0.206226
Epoch 54
Validation rmse = 0.209689
Epoch 55
Loss = 1.7003e-01, PNorm = 34.7993, GNorm = 1.2201, lr_0 = 1.0000e-04
Validation rmse = 0.203213
Epoch 56
Loss = 1.4652e-01, PNorm = 34.8062, GNorm = 1.1614, lr_0 = 1.0000e-04
Validation rmse = 0.207840
Epoch 57
Loss = 1.5217e-01, PNorm = 34.8125, GNorm = 0.7439, lr_0 = 1.0000e-04
Validation rmse = 0.198876
Epoch 58
Validation rmse = 0.217303
Epoch 59
Loss = 1.4215e-01, PNorm = 34.8193, GNorm = 3.6279, lr_0 = 1.0000e-04
Validation rmse = 0.199262
Model 0 best validation rmse = 0.183528 on epoch 21
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.132104
Ensemble test rmse = 0.132104
1-fold cross validation
	Seed 0 ==> test rmse = 0.132104
Overall test rmse = 0.132104 +/- 0.000000
Elapsed time = 0:00:16
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 362 | train size = 358 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.131558
Epoch 1
Loss = 7.1404e-01, PNorm = 34.0311, GNorm = 0.8767, lr_0 = 8.7143e-04
Validation rmse = 0.141468
Epoch 2
Loss = 4.5760e-01, PNorm = 34.1013, GNorm = 1.0929, lr_0 = 9.5024e-04
Validation rmse = 0.169045
Epoch 3
Validation rmse = 0.197239
Epoch 4
Loss = 4.4701e-01, PNorm = 34.1541, GNorm = 8.2579, lr_0 = 8.8772e-04
Validation rmse = 0.162747
Epoch 5
Loss = 3.6179e-01, PNorm = 34.1935, GNorm = 11.9425, lr_0 = 8.3403e-04
Validation rmse = 0.151703
Epoch 6
Loss = 3.5505e-01, PNorm = 34.2302, GNorm = 3.0424, lr_0 = 7.8359e-04
Validation rmse = 0.157195
Epoch 7
Validation rmse = 0.178168
Epoch 8
Loss = 3.1183e-01, PNorm = 34.2638, GNorm = 5.2426, lr_0 = 7.3620e-04
Validation rmse = 0.194950
Epoch 9
Loss = 3.2516e-01, PNorm = 34.2926, GNorm = 2.2133, lr_0 = 6.9167e-04
Validation rmse = 0.189094
Epoch 10
Validation rmse = 0.219584
Epoch 11
Loss = 4.4369e-01, PNorm = 34.3201, GNorm = 9.3894, lr_0 = 6.4617e-04
Validation rmse = 0.162833
Epoch 12
Loss = 3.2303e-01, PNorm = 34.3434, GNorm = 3.3644, lr_0 = 6.0709e-04
Validation rmse = 0.171349
Epoch 13
Loss = 2.6341e-01, PNorm = 34.3640, GNorm = 1.9143, lr_0 = 5.7362e-04
Loss = 1.7583e-01, PNorm = 34.3661, GNorm = 5.9643, lr_0 = 5.7037e-04
Validation rmse = 0.177917
Epoch 14
Validation rmse = 0.188356
Epoch 15
Loss = 2.5343e-01, PNorm = 34.3873, GNorm = 0.9734, lr_0 = 5.3588e-04
Validation rmse = 0.183506
Epoch 16
Loss = 2.1840e-01, PNorm = 34.4080, GNorm = 0.7354, lr_0 = 5.0347e-04
Validation rmse = 0.189345
Epoch 17
Validation rmse = 0.188851
Epoch 18
Loss = 2.4365e-01, PNorm = 34.4273, GNorm = 3.0660, lr_0 = 4.7034e-04
Validation rmse = 0.196993
Epoch 19
Loss = 2.1335e-01, PNorm = 34.4428, GNorm = 1.8443, lr_0 = 4.4441e-04
Validation rmse = 0.177651
Epoch 20
Loss = 2.0112e-01, PNorm = 34.4608, GNorm = 1.6350, lr_0 = 4.1753e-04
Loss = 3.1335e-01, PNorm = 34.4621, GNorm = 5.3222, lr_0 = 4.1517e-04
Validation rmse = 0.183583
Epoch 21
Validation rmse = 0.173695
Epoch 22
Loss = 2.1346e-01, PNorm = 34.4774, GNorm = 5.2599, lr_0 = 3.9006e-04
Validation rmse = 0.181493
Epoch 23
Loss = 1.9855e-01, PNorm = 34.4966, GNorm = 1.5292, lr_0 = 3.6647e-04
Validation rmse = 0.182063
Epoch 24
Validation rmse = 0.172133
Epoch 25
Loss = 1.4071e-01, PNorm = 34.5116, GNorm = 1.8176, lr_0 = 3.4431e-04
Validation rmse = 0.185868
Epoch 26
Loss = 1.9811e-01, PNorm = 34.5276, GNorm = 2.1163, lr_0 = 3.2348e-04
Validation rmse = 0.174109
Epoch 27
Loss = 1.8594e-01, PNorm = 34.5417, GNorm = 1.3630, lr_0 = 3.0392e-04
Loss = 7.2182e-02, PNorm = 34.5429, GNorm = 2.2332, lr_0 = 3.0220e-04
Validation rmse = 0.169284
Epoch 28
Validation rmse = 0.179113
Epoch 29
Loss = 1.4566e-01, PNorm = 34.5563, GNorm = 3.8535, lr_0 = 2.8392e-04
Validation rmse = 0.175139
Epoch 30
Loss = 1.7371e-01, PNorm = 34.5695, GNorm = 2.0173, lr_0 = 2.6675e-04
Validation rmse = 0.171955
Epoch 31
Validation rmse = 0.186640
Epoch 32
Loss = 1.7032e-01, PNorm = 34.5827, GNorm = 0.9432, lr_0 = 2.5062e-04
Validation rmse = 0.172131
Epoch 33
Loss = 1.8555e-01, PNorm = 34.5964, GNorm = 1.6570, lr_0 = 2.3546e-04
Validation rmse = 0.182374
Epoch 34
Loss = 1.8363e-01, PNorm = 34.6101, GNorm = 1.1401, lr_0 = 2.2122e-04
Loss = 2.4967e-01, PNorm = 34.6112, GNorm = 7.3959, lr_0 = 2.1997e-04
Validation rmse = 0.181389
Epoch 35
Validation rmse = 0.166273
Epoch 36
Loss = 1.5380e-01, PNorm = 34.6242, GNorm = 1.8615, lr_0 = 2.0667e-04
Validation rmse = 0.161884
Epoch 37
Loss = 1.6584e-01, PNorm = 34.6362, GNorm = 1.1450, lr_0 = 1.9417e-04
Validation rmse = 0.171320
Epoch 38
Validation rmse = 0.171920
Epoch 39
Loss = 1.5907e-01, PNorm = 34.6461, GNorm = 2.7072, lr_0 = 1.8242e-04
Validation rmse = 0.169139
Epoch 40
Loss = 1.5531e-01, PNorm = 34.6569, GNorm = 1.3981, lr_0 = 1.7139e-04
Validation rmse = 0.172333
Epoch 41
Loss = 1.6121e-01, PNorm = 34.6671, GNorm = 0.9729, lr_0 = 1.6103e-04
Loss = 8.5605e-02, PNorm = 34.6680, GNorm = 1.7345, lr_0 = 1.6012e-04
Validation rmse = 0.163002
Epoch 42
Validation rmse = 0.170389
Epoch 43
Loss = 1.8303e-01, PNorm = 34.6766, GNorm = 5.8539, lr_0 = 1.5043e-04
Validation rmse = 0.151006
Epoch 44
Loss = 1.4913e-01, PNorm = 34.6836, GNorm = 0.5711, lr_0 = 1.4214e-04
Validation rmse = 0.162756
Epoch 45
Validation rmse = 0.168091
Epoch 46
Loss = 1.8500e-01, PNorm = 34.6918, GNorm = 2.5319, lr_0 = 1.3279e-04
Validation rmse = 0.157200
Epoch 47
Loss = 1.6889e-01, PNorm = 34.6985, GNorm = 7.7303, lr_0 = 1.2476e-04
Validation rmse = 0.170843
Epoch 48
Loss = 1.5749e-01, PNorm = 34.7053, GNorm = 0.6103, lr_0 = 1.1721e-04
Loss = 1.1602e-01, PNorm = 34.7059, GNorm = 2.8127, lr_0 = 1.1655e-04
Validation rmse = 0.158399
Epoch 49
Validation rmse = 0.162966
Epoch 50
Loss = 1.4380e-01, PNorm = 34.7114, GNorm = 1.3940, lr_0 = 1.1012e-04
Validation rmse = 0.161100
Epoch 51
Loss = 1.4594e-01, PNorm = 34.7172, GNorm = 1.3325, lr_0 = 1.0346e-04
Validation rmse = 0.161830
Epoch 52
Validation rmse = 0.161486
Epoch 53
Loss = 1.4650e-01, PNorm = 34.7233, GNorm = 0.9101, lr_0 = 1.0000e-04
Validation rmse = 0.154903
Epoch 54
Loss = 1.4518e-01, PNorm = 34.7295, GNorm = 1.3404, lr_0 = 1.0000e-04
Validation rmse = 0.158168
Epoch 55
Loss = 1.4566e-01, PNorm = 34.7360, GNorm = 0.4970, lr_0 = 1.0000e-04
Loss = 4.0188e-02, PNorm = 34.7365, GNorm = 1.8533, lr_0 = 1.0000e-04
Validation rmse = 0.153375
Epoch 56
Validation rmse = 0.159192
Epoch 57
Loss = 1.6806e-01, PNorm = 34.7418, GNorm = 0.7178, lr_0 = 1.0000e-04
Validation rmse = 0.155494
Epoch 58
Loss = 1.3843e-01, PNorm = 34.7475, GNorm = 2.5198, lr_0 = 1.0000e-04
Validation rmse = 0.157156
Epoch 59
Validation rmse = 0.155349
Model 0 best validation rmse = 0.131558 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.173225
Ensemble test rmse = 0.173225
1-fold cross validation
	Seed 0 ==> test rmse = 0.173225
Overall test rmse = 0.173225 +/- 0.000000
Elapsed time = 0:00:15
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 417 | train size = 412 | val size = 2 | test size = 3
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.302486
Epoch 1
Loss = 6.9448e-01, PNorm = 34.0263, GNorm = 10.4726, lr_0 = 7.7500e-04
Validation rmse = 0.266605
Epoch 2
Loss = 5.7531e-01, PNorm = 34.0727, GNorm = 4.6743, lr_0 = 9.6586e-04
Validation rmse = 0.473141
Epoch 3
Loss = 5.9972e-01, PNorm = 34.1238, GNorm = 9.6162, lr_0 = 9.1455e-04
Validation rmse = 0.291439
Epoch 4
Loss = 4.9815e-01, PNorm = 34.1690, GNorm = 4.9659, lr_0 = 8.6596e-04
Validation rmse = 0.431240
Epoch 5
Validation rmse = 0.417590
Epoch 6
Loss = 5.9024e-01, PNorm = 34.2046, GNorm = 5.9036, lr_0 = 8.1996e-04
Validation rmse = 0.437419
Epoch 7
Loss = 4.6378e-01, PNorm = 34.2423, GNorm = 5.1006, lr_0 = 7.7640e-04
Validation rmse = 0.435246
Epoch 8
Loss = 4.1967e-01, PNorm = 34.2760, GNorm = 2.6444, lr_0 = 7.3516e-04
Validation rmse = 0.381931
Epoch 9
Loss = 4.6479e-01, PNorm = 34.3013, GNorm = 4.1168, lr_0 = 6.9956e-04
Validation rmse = 0.383374
Epoch 10
Loss = 3.8110e-01, PNorm = 34.3348, GNorm = 2.7143, lr_0 = 6.6240e-04
Loss = 2.8046e-01, PNorm = 34.3365, GNorm = 3.1968, lr_0 = 6.5912e-04
Validation rmse = 0.329067
Epoch 11
Validation rmse = 0.332437
Epoch 12
Loss = 4.4516e-01, PNorm = 34.3603, GNorm = 5.4448, lr_0 = 6.2411e-04
Validation rmse = 0.379623
Epoch 13
Loss = 5.2515e-01, PNorm = 34.3842, GNorm = 10.4184, lr_0 = 5.9389e-04
Validation rmse = 0.443932
Epoch 14
Loss = 3.9676e-01, PNorm = 34.4105, GNorm = 3.8746, lr_0 = 5.6234e-04
Validation rmse = 0.439670
Epoch 15
Loss = 3.7469e-01, PNorm = 34.4383, GNorm = 6.7635, lr_0 = 5.3247e-04
Validation rmse = 0.410594
Epoch 16
Loss = 3.4447e-01, PNorm = 34.4573, GNorm = 4.3078, lr_0 = 5.0418e-04
Validation rmse = 0.427848
Epoch 17
Validation rmse = 0.419135
Epoch 18
Loss = 3.6308e-01, PNorm = 34.4768, GNorm = 2.5166, lr_0 = 4.7740e-04
Validation rmse = 0.392225
Epoch 19
Loss = 3.4006e-01, PNorm = 34.4958, GNorm = 1.5772, lr_0 = 4.5204e-04
Validation rmse = 0.357487
Epoch 20
Loss = 3.6585e-01, PNorm = 34.5139, GNorm = 2.4784, lr_0 = 4.2802e-04
Validation rmse = 0.443725
Epoch 21
Loss = 3.2784e-01, PNorm = 34.5323, GNorm = 1.6920, lr_0 = 4.0730e-04
Validation rmse = 0.457531
Epoch 22
Validation rmse = 0.405626
Epoch 23
Loss = 2.8558e-01, PNorm = 34.5514, GNorm = 0.7230, lr_0 = 3.8375e-04
Validation rmse = 0.450078
Epoch 24
Loss = 3.2111e-01, PNorm = 34.5681, GNorm = 2.5665, lr_0 = 3.6337e-04
Validation rmse = 0.434334
Epoch 25
Loss = 3.0158e-01, PNorm = 34.5824, GNorm = 3.1724, lr_0 = 3.4577e-04
Validation rmse = 0.425760
Epoch 26
Loss = 3.1256e-01, PNorm = 34.5989, GNorm = 2.2217, lr_0 = 3.2741e-04
Validation rmse = 0.482665
Epoch 27
Loss = 3.1856e-01, PNorm = 34.6166, GNorm = 0.9283, lr_0 = 3.1001e-04
Loss = 2.1840e-01, PNorm = 34.6182, GNorm = 3.6299, lr_0 = 3.0848e-04
Validation rmse = 0.439920
Epoch 28
Validation rmse = 0.413941
Epoch 29
Loss = 2.9189e-01, PNorm = 34.6363, GNorm = 1.5028, lr_0 = 2.9209e-04
Validation rmse = 0.346736
Epoch 30
Loss = 3.2112e-01, PNorm = 34.6526, GNorm = 7.1901, lr_0 = 2.7795e-04
Validation rmse = 0.483795
Epoch 31
Loss = 3.5004e-01, PNorm = 34.6696, GNorm = 4.6804, lr_0 = 2.6318e-04
Validation rmse = 0.456573
Epoch 32
Loss = 2.8349e-01, PNorm = 34.6831, GNorm = 1.8319, lr_0 = 2.4920e-04
Validation rmse = 0.459336
Epoch 33
Loss = 3.1871e-01, PNorm = 34.6945, GNorm = 3.1620, lr_0 = 2.3596e-04
Validation rmse = 0.412250
Epoch 34
Validation rmse = 0.444259
Epoch 35
Loss = 2.6588e-01, PNorm = 34.7057, GNorm = 1.0501, lr_0 = 2.2343e-04
Validation rmse = 0.475568
Epoch 36
Loss = 2.4732e-01, PNorm = 34.7166, GNorm = 4.2877, lr_0 = 2.1156e-04
Validation rmse = 0.413993
Epoch 37
Loss = 2.6596e-01, PNorm = 34.7272, GNorm = 2.8984, lr_0 = 2.0032e-04
Validation rmse = 0.465699
Epoch 38
Loss = 2.7528e-01, PNorm = 34.7379, GNorm = 0.7953, lr_0 = 1.9062e-04
Validation rmse = 0.423127
Epoch 39
Validation rmse = 0.453163
Epoch 40
Loss = 2.3167e-01, PNorm = 34.7487, GNorm = 2.1665, lr_0 = 1.7960e-04
Validation rmse = 0.448148
Epoch 41
Loss = 2.0320e-01, PNorm = 34.7584, GNorm = 2.5075, lr_0 = 1.7006e-04
Validation rmse = 0.459819
Epoch 42
Loss = 2.9399e-01, PNorm = 34.7681, GNorm = 1.0555, lr_0 = 1.6183e-04
Validation rmse = 0.437052
Epoch 43
Loss = 2.8095e-01, PNorm = 34.7784, GNorm = 1.1029, lr_0 = 1.5323e-04
Validation rmse = 0.456699
Epoch 44
Loss = 2.6635e-01, PNorm = 34.7877, GNorm = 2.8978, lr_0 = 1.4509e-04
Loss = 4.4949e-01, PNorm = 34.7886, GNorm = 6.1410, lr_0 = 1.4437e-04
Validation rmse = 0.430560
Epoch 45
Validation rmse = 0.417094
Epoch 46
Loss = 1.9039e-01, PNorm = 34.7974, GNorm = 2.6303, lr_0 = 1.3738e-04
Validation rmse = 0.449943
Epoch 47
Loss = 2.6222e-01, PNorm = 34.8060, GNorm = 1.0387, lr_0 = 1.3008e-04
Validation rmse = 0.433880
Epoch 48
Loss = 2.7325e-01, PNorm = 34.8144, GNorm = 1.5022, lr_0 = 1.2317e-04
Validation rmse = 0.449938
Epoch 49
Loss = 2.5209e-01, PNorm = 34.8221, GNorm = 1.0571, lr_0 = 1.1663e-04
Validation rmse = 0.444704
Epoch 50
Loss = 2.6156e-01, PNorm = 34.8287, GNorm = 1.1436, lr_0 = 1.1098e-04
Loss = 4.5553e-02, PNorm = 34.8293, GNorm = 1.2218, lr_0 = 1.1043e-04
Validation rmse = 0.438572
Epoch 51
Validation rmse = 0.447500
Epoch 52
Loss = 2.9905e-01, PNorm = 34.8363, GNorm = 1.5337, lr_0 = 1.0457e-04
Validation rmse = 0.434863
Epoch 53
Loss = 3.0791e-01, PNorm = 34.8429, GNorm = 1.7909, lr_0 = 1.0000e-04
Validation rmse = 0.443784
Epoch 54
Loss = 2.1788e-01, PNorm = 34.8500, GNorm = 3.1364, lr_0 = 1.0000e-04
Validation rmse = 0.437748
Epoch 55
Loss = 2.4886e-01, PNorm = 34.8553, GNorm = 1.5269, lr_0 = 1.0000e-04
Validation rmse = 0.443838
Epoch 56
Validation rmse = 0.427054
Epoch 57
Loss = 2.8851e-01, PNorm = 34.8637, GNorm = 4.7756, lr_0 = 1.0000e-04
Validation rmse = 0.448635
Epoch 58
Loss = 2.1855e-01, PNorm = 34.8712, GNorm = 1.7299, lr_0 = 1.0000e-04
Validation rmse = 0.447411
Epoch 59
Loss = 1.9498e-01, PNorm = 34.8777, GNorm = 1.1700, lr_0 = 1.0000e-04
Validation rmse = 0.444653
Model 0 best validation rmse = 0.266605 on epoch 1
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.331675
Ensemble test rmse = 0.331675
1-fold cross validation
	Seed 0 ==> test rmse = 0.331675
Overall test rmse = 0.331675 +/- 0.000000
Elapsed time = 0:00:17
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 412 | train size = 407 | val size = 2 | test size = 3
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.304620
Epoch 1
Loss = 8.5912e-01, PNorm = 34.0214, GNorm = 3.4935, lr_0 = 7.7500e-04
Validation rmse = 0.325712
Epoch 2
Loss = 7.8754e-01, PNorm = 34.0648, GNorm = 4.2082, lr_0 = 9.6586e-04
Validation rmse = 0.310644
Epoch 3
Loss = 5.7048e-01, PNorm = 34.1139, GNorm = 3.4310, lr_0 = 9.1455e-04
Validation rmse = 0.294699
Epoch 4
Loss = 4.8857e-01, PNorm = 34.1682, GNorm = 7.5632, lr_0 = 8.6596e-04
Loss = 6.1904e-01, PNorm = 34.1739, GNorm = 3.1028, lr_0 = 8.6168e-04
Validation rmse = 0.344361
Epoch 5
Validation rmse = 0.306665
Epoch 6
Loss = 4.9375e-01, PNorm = 34.2215, GNorm = 1.4313, lr_0 = 8.1590e-04
Validation rmse = 0.261069
Epoch 7
Loss = 4.9884e-01, PNorm = 34.2589, GNorm = 3.5715, lr_0 = 7.7256e-04
Validation rmse = 0.266303
Epoch 8
Loss = 4.0185e-01, PNorm = 34.2877, GNorm = 1.6447, lr_0 = 7.3516e-04
Validation rmse = 0.267612
Epoch 9
Loss = 3.8667e-01, PNorm = 34.3176, GNorm = 1.3574, lr_0 = 6.9610e-04
Validation rmse = 0.253660
Epoch 10
Validation rmse = 0.252814
Epoch 11
Loss = 3.5805e-01, PNorm = 34.3479, GNorm = 4.2229, lr_0 = 6.5586e-04
Validation rmse = 0.263779
Epoch 12
Loss = 3.3736e-01, PNorm = 34.3748, GNorm = 2.3246, lr_0 = 6.2102e-04
Validation rmse = 0.281244
Epoch 13
Loss = 3.7276e-01, PNorm = 34.4006, GNorm = 4.5009, lr_0 = 5.8803e-04
Validation rmse = 0.283124
Epoch 14
Loss = 3.7075e-01, PNorm = 34.4267, GNorm = 3.0339, lr_0 = 5.5679e-04
Validation rmse = 0.307984
Epoch 15
Loss = 4.1607e-01, PNorm = 34.4495, GNorm = 1.0284, lr_0 = 5.2983e-04
Loss = 2.5451e-01, PNorm = 34.4517, GNorm = 1.9257, lr_0 = 5.2721e-04
Validation rmse = 0.279737
Epoch 16
Validation rmse = 0.246472
Epoch 17
Loss = 3.1261e-01, PNorm = 34.4771, GNorm = 1.5452, lr_0 = 4.9920e-04
Validation rmse = 0.242398
Epoch 18
Loss = 3.0941e-01, PNorm = 34.5013, GNorm = 2.0710, lr_0 = 4.7268e-04
Validation rmse = 0.264664
Epoch 19
Loss = 3.4623e-01, PNorm = 34.5225, GNorm = 2.8506, lr_0 = 4.4757e-04
Validation rmse = 0.251452
Epoch 20
Loss = 3.1966e-01, PNorm = 34.5456, GNorm = 1.3971, lr_0 = 4.2379e-04
Loss = 3.1703e-01, PNorm = 34.5472, GNorm = 2.3309, lr_0 = 4.2170e-04
Validation rmse = 0.238913
Epoch 21
Validation rmse = 0.284228
Epoch 22
Loss = 2.2527e-01, PNorm = 34.5640, GNorm = 1.6964, lr_0 = 4.0128e-04
Validation rmse = 0.236818
Epoch 23
Loss = 3.0676e-01, PNorm = 34.5837, GNorm = 0.7597, lr_0 = 3.7996e-04
Validation rmse = 0.234008
Epoch 24
Loss = 3.6284e-01, PNorm = 34.6007, GNorm = 3.6464, lr_0 = 3.5978e-04
Validation rmse = 0.272598
Epoch 25
Loss = 3.2844e-01, PNorm = 34.6189, GNorm = 2.2630, lr_0 = 3.4067e-04
Validation rmse = 0.243395
Epoch 26
Validation rmse = 0.235311
Epoch 27
Loss = 3.0744e-01, PNorm = 34.6402, GNorm = 3.3339, lr_0 = 3.2097e-04
Validation rmse = 0.238409
Epoch 28
Loss = 3.1622e-01, PNorm = 34.6574, GNorm = 0.9087, lr_0 = 3.0392e-04
Validation rmse = 0.247920
Epoch 29
Loss = 3.0316e-01, PNorm = 34.6739, GNorm = 0.8051, lr_0 = 2.8921e-04
Validation rmse = 0.265795
Epoch 30
Loss = 3.3626e-01, PNorm = 34.6885, GNorm = 2.3481, lr_0 = 2.7384e-04
Validation rmse = 0.245138
Epoch 31
Loss = 2.8932e-01, PNorm = 34.7031, GNorm = 2.0836, lr_0 = 2.5929e-04
Loss = 3.8060e-01, PNorm = 34.7045, GNorm = 7.7937, lr_0 = 2.5801e-04
Validation rmse = 0.260713
Epoch 32
Validation rmse = 0.236443
Epoch 33
Loss = 2.8502e-01, PNorm = 34.7192, GNorm = 0.7367, lr_0 = 2.4430e-04
Validation rmse = 0.233410
Epoch 34
Loss = 2.9617e-01, PNorm = 34.7322, GNorm = 5.0118, lr_0 = 2.3133e-04
Validation rmse = 0.247614
Epoch 35
Loss = 2.5454e-01, PNorm = 34.7458, GNorm = 1.0181, lr_0 = 2.1904e-04
Validation rmse = 0.252065
Epoch 36
Loss = 2.9068e-01, PNorm = 34.7586, GNorm = 2.6629, lr_0 = 2.0843e-04
Validation rmse = 0.229087
Epoch 37
Validation rmse = 0.249550
Epoch 38
Loss = 3.9596e-01, PNorm = 34.7741, GNorm = 3.5479, lr_0 = 1.9638e-04
Validation rmse = 0.234364
Epoch 39
Loss = 2.9628e-01, PNorm = 34.7853, GNorm = 2.9201, lr_0 = 1.8595e-04
Validation rmse = 0.243619
Epoch 40
Loss = 2.5709e-01, PNorm = 34.7963, GNorm = 0.6954, lr_0 = 1.7607e-04
Validation rmse = 0.237444
Epoch 41
Loss = 2.6738e-01, PNorm = 34.8061, GNorm = 1.5728, lr_0 = 1.6672e-04
Validation rmse = 0.250016
Epoch 42
Loss = 3.0224e-01, PNorm = 34.8177, GNorm = 5.4693, lr_0 = 1.5786e-04
Validation rmse = 0.253677
Epoch 43
Validation rmse = 0.248938
Epoch 44
Loss = 2.3563e-01, PNorm = 34.8283, GNorm = 0.5530, lr_0 = 1.4948e-04
Validation rmse = 0.247573
Epoch 45
Loss = 2.6430e-01, PNorm = 34.8368, GNorm = 2.5666, lr_0 = 1.4153e-04
Validation rmse = 0.251452
Epoch 46
Loss = 2.6136e-01, PNorm = 34.8455, GNorm = 4.5094, lr_0 = 1.3402e-04
Validation rmse = 0.244444
Epoch 47
Loss = 2.5329e-01, PNorm = 34.8543, GNorm = 1.1858, lr_0 = 1.2690e-04
Loss = 4.5062e-02, PNorm = 34.8551, GNorm = 1.3380, lr_0 = 1.2627e-04
Validation rmse = 0.244515
Epoch 48
Validation rmse = 0.243926
Epoch 49
Loss = 2.5393e-01, PNorm = 34.8627, GNorm = 1.7759, lr_0 = 1.1956e-04
Validation rmse = 0.247428
Epoch 50
Loss = 2.2538e-01, PNorm = 34.8687, GNorm = 0.9131, lr_0 = 1.1377e-04
Validation rmse = 0.247106
Epoch 51
Loss = 2.4281e-01, PNorm = 34.8757, GNorm = 0.7859, lr_0 = 1.0773e-04
Validation rmse = 0.250415
Epoch 52
Loss = 2.5280e-01, PNorm = 34.8821, GNorm = 0.9167, lr_0 = 1.0200e-04
Validation rmse = 0.244004
Epoch 53
Validation rmse = 0.246028
Epoch 54
Loss = 1.7726e-01, PNorm = 34.8892, GNorm = 1.4051, lr_0 = 1.0000e-04
Validation rmse = 0.245166
Epoch 55
Loss = 1.5669e-01, PNorm = 34.8953, GNorm = 0.6762, lr_0 = 1.0000e-04
Validation rmse = 0.243868
Epoch 56
Loss = 2.3126e-01, PNorm = 34.9017, GNorm = 1.3157, lr_0 = 1.0000e-04
Validation rmse = 0.245869
Epoch 57
Loss = 2.3373e-01, PNorm = 34.9081, GNorm = 1.5160, lr_0 = 1.0000e-04
Validation rmse = 0.247946
Epoch 58
Loss = 2.4064e-01, PNorm = 34.9142, GNorm = 1.1324, lr_0 = 1.0000e-04
Loss = 5.4260e-02, PNorm = 34.9148, GNorm = 2.7520, lr_0 = 1.0000e-04
Validation rmse = 0.245749
Epoch 59
Validation rmse = 0.249110
Model 0 best validation rmse = 0.229087 on epoch 36
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.097964
Ensemble test rmse = 0.097964
1-fold cross validation
	Seed 0 ==> test rmse = 0.097964
Overall test rmse = 0.097964 +/- 0.000000
Elapsed time = 0:00:17
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 407 | train size = 402 | val size = 2 | test size = 3
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.462420
Epoch 1
Loss = 1.4835e+00, PNorm = 34.0224, GNorm = 16.0918, lr_0 = 7.7500e-04
Validation rmse = 0.432283
Epoch 2
Loss = 1.0283e+00, PNorm = 34.0552, GNorm = 4.0836, lr_0 = 9.6586e-04
Validation rmse = 0.392397
Epoch 3
Loss = 8.4818e-01, PNorm = 34.0997, GNorm = 0.8536, lr_0 = 9.1455e-04
Validation rmse = 0.403575
Epoch 4
Loss = 6.4081e-01, PNorm = 34.1540, GNorm = 1.2888, lr_0 = 8.6596e-04
Loss = 8.0171e-02, PNorm = 34.1589, GNorm = 3.5188, lr_0 = 8.6168e-04
Validation rmse = 0.368542
Epoch 5
Validation rmse = 0.375123
Epoch 6
Loss = 5.5920e-01, PNorm = 34.2185, GNorm = 4.1327, lr_0 = 8.1590e-04
Validation rmse = 0.342928
Epoch 7
Loss = 3.7847e-01, PNorm = 34.2626, GNorm = 1.5167, lr_0 = 7.7256e-04
Validation rmse = 0.304957
Epoch 8
Loss = 4.1394e-01, PNorm = 34.3012, GNorm = 1.4494, lr_0 = 7.3152e-04
Validation rmse = 0.333215
Epoch 9
Loss = 3.5794e-01, PNorm = 34.3337, GNorm = 3.1792, lr_0 = 6.9266e-04
Loss = 1.3997e-01, PNorm = 34.3359, GNorm = 5.2308, lr_0 = 6.8923e-04
Validation rmse = 0.319586
Epoch 10
Validation rmse = 0.298246
Epoch 11
Loss = 6.1797e-01, PNorm = 34.3554, GNorm = 12.5669, lr_0 = 6.5261e-04
Validation rmse = 0.306657
Epoch 12
Loss = 5.9131e-01, PNorm = 34.3747, GNorm = 10.6976, lr_0 = 6.1794e-04
Validation rmse = 0.396391
Epoch 13
Loss = 3.9914e-01, PNorm = 34.4003, GNorm = 2.4666, lr_0 = 5.8512e-04
Validation rmse = 0.315600
Epoch 14
Loss = 3.7895e-01, PNorm = 34.4220, GNorm = 1.6872, lr_0 = 5.5403e-04
Loss = 2.7696e-01, PNorm = 34.4236, GNorm = 8.9484, lr_0 = 5.5129e-04
Validation rmse = 0.271196
Epoch 15
Validation rmse = 0.379811
Epoch 16
Loss = 4.0077e-01, PNorm = 34.4398, GNorm = 2.9571, lr_0 = 5.2200e-04
Validation rmse = 0.321445
Epoch 17
Loss = 3.3642e-01, PNorm = 34.4609, GNorm = 2.7248, lr_0 = 4.9427e-04
Validation rmse = 0.334167
Epoch 18
Loss = 2.8414e-01, PNorm = 34.4794, GNorm = 1.7384, lr_0 = 4.6801e-04
Validation rmse = 0.318536
Epoch 19
Loss = 3.1473e-01, PNorm = 34.4934, GNorm = 0.7870, lr_0 = 4.4315e-04
Loss = 8.8842e-02, PNorm = 34.4949, GNorm = 4.0213, lr_0 = 4.4096e-04
Validation rmse = 0.336001
Epoch 20
Validation rmse = 0.298892
Epoch 21
Loss = 2.9503e-01, PNorm = 34.5098, GNorm = 1.6919, lr_0 = 4.1753e-04
Validation rmse = 0.373696
Epoch 22
Loss = 3.1571e-01, PNorm = 34.5225, GNorm = 5.7267, lr_0 = 3.9535e-04
Validation rmse = 0.299827
Epoch 23
Loss = 3.3566e-01, PNorm = 34.5362, GNorm = 2.1267, lr_0 = 3.7435e-04
Validation rmse = 0.370971
Epoch 24
Loss = 3.1525e-01, PNorm = 34.5513, GNorm = 4.2787, lr_0 = 3.5446e-04
Validation rmse = 0.315287
Epoch 25
Validation rmse = 0.341830
Epoch 26
Loss = 3.2253e-01, PNorm = 34.5663, GNorm = 2.9839, lr_0 = 3.3563e-04
Validation rmse = 0.300277
Epoch 27
Loss = 2.8474e-01, PNorm = 34.5763, GNorm = 1.6592, lr_0 = 3.1780e-04
Validation rmse = 0.309893
Epoch 28
Loss = 3.0021e-01, PNorm = 34.5859, GNorm = 1.9985, lr_0 = 3.0092e-04
Validation rmse = 0.272480
Epoch 29
Loss = 3.0982e-01, PNorm = 34.5940, GNorm = 2.3531, lr_0 = 2.8493e-04
Validation rmse = 0.306186
Epoch 30
Validation rmse = 0.314720
Epoch 31
Loss = 3.1837e-01, PNorm = 34.6051, GNorm = 0.5759, lr_0 = 2.6846e-04
Validation rmse = 0.286288
Epoch 32
Loss = 2.8672e-01, PNorm = 34.6140, GNorm = 1.1622, lr_0 = 2.5420e-04
Validation rmse = 0.309793
Epoch 33
Loss = 2.5481e-01, PNorm = 34.6231, GNorm = 0.6312, lr_0 = 2.4069e-04
Validation rmse = 0.294835
Epoch 34
Loss = 2.7929e-01, PNorm = 34.6317, GNorm = 1.4205, lr_0 = 2.2791e-04
Validation rmse = 0.312186
Epoch 35
Validation rmse = 0.326236
Epoch 36
Loss = 2.8319e-01, PNorm = 34.6402, GNorm = 2.3514, lr_0 = 2.1473e-04
Validation rmse = 0.333318
Epoch 37
Loss = 2.7160e-01, PNorm = 34.6489, GNorm = 1.3625, lr_0 = 2.0332e-04
Validation rmse = 0.301927
Epoch 38
Loss = 2.4810e-01, PNorm = 34.6573, GNorm = 2.8562, lr_0 = 1.9252e-04
Validation rmse = 0.303706
Epoch 39
Loss = 2.7865e-01, PNorm = 34.6653, GNorm = 2.2474, lr_0 = 1.8230e-04
Validation rmse = 0.310225
Epoch 40
Validation rmse = 0.309744
Epoch 41
Loss = 2.9905e-01, PNorm = 34.6726, GNorm = 1.7434, lr_0 = 1.7176e-04
Validation rmse = 0.310500
Epoch 42
Loss = 2.3773e-01, PNorm = 34.6802, GNorm = 1.9244, lr_0 = 1.6263e-04
Validation rmse = 0.313336
Epoch 43
Loss = 2.8773e-01, PNorm = 34.6863, GNorm = 0.9558, lr_0 = 1.5399e-04
Validation rmse = 0.300355
Epoch 44
Loss = 2.7791e-01, PNorm = 34.6936, GNorm = 0.7203, lr_0 = 1.4581e-04
Validation rmse = 0.293919
Epoch 45
Validation rmse = 0.302349
Epoch 46
Loss = 2.6430e-01, PNorm = 34.7019, GNorm = 2.8962, lr_0 = 1.3738e-04
Validation rmse = 0.313777
Epoch 47
Loss = 2.4187e-01, PNorm = 34.7076, GNorm = 1.2019, lr_0 = 1.3008e-04
Validation rmse = 0.326330
Epoch 48
Loss = 2.8769e-01, PNorm = 34.7119, GNorm = 3.4528, lr_0 = 1.2317e-04
Validation rmse = 0.315968
Epoch 49
Loss = 2.5644e-01, PNorm = 34.7171, GNorm = 3.7191, lr_0 = 1.1663e-04
Validation rmse = 0.314596
Epoch 50
Loss = 2.6623e-01, PNorm = 34.7211, GNorm = 0.9706, lr_0 = 1.1098e-04
Loss = 3.4984e-01, PNorm = 34.7216, GNorm = 12.0818, lr_0 = 1.1043e-04
Validation rmse = 0.325020
Epoch 51
Validation rmse = 0.294741
Epoch 52
Loss = 1.9657e-01, PNorm = 34.7268, GNorm = 0.8200, lr_0 = 1.0457e-04
Validation rmse = 0.326017
Epoch 53
Loss = 2.4392e-01, PNorm = 34.7310, GNorm = 3.0531, lr_0 = 1.0000e-04
Validation rmse = 0.306284
Epoch 54
Loss = 2.7777e-01, PNorm = 34.7351, GNorm = 4.1134, lr_0 = 1.0000e-04
Validation rmse = 0.288114
Epoch 55
Loss = 2.4608e-01, PNorm = 34.7396, GNorm = 2.4052, lr_0 = 1.0000e-04
Loss = 5.2442e-01, PNorm = 34.7399, GNorm = 14.9398, lr_0 = 1.0000e-04
Validation rmse = 0.328888
Epoch 56
Validation rmse = 0.314743
Epoch 57
Loss = 2.5668e-01, PNorm = 34.7444, GNorm = 2.2307, lr_0 = 1.0000e-04
Validation rmse = 0.300565
Epoch 58
Loss = 2.6196e-01, PNorm = 34.7490, GNorm = 0.6482, lr_0 = 1.0000e-04
Validation rmse = 0.332200
Epoch 59
Loss = 2.5053e-01, PNorm = 34.7530, GNorm = 2.1895, lr_0 = 1.0000e-04
Validation rmse = 0.308019
Model 0 best validation rmse = 0.271196 on epoch 14
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.071595
Ensemble test rmse = 0.071595
1-fold cross validation
	Seed 0 ==> test rmse = 0.071595
Overall test rmse = 0.071595 +/- 0.000000
Elapsed time = 0:00:17
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 402 | train size = 397 | val size = 2 | test size = 3
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.172739
Epoch 1
Loss = 7.5441e-01, PNorm = 34.0310, GNorm = 3.7375, lr_0 = 8.7143e-04
Validation rmse = 0.203096
Epoch 2
Loss = 5.2780e-01, PNorm = 34.0792, GNorm = 1.5577, lr_0 = 9.5564e-04
Validation rmse = 0.198614
Epoch 3
Loss = 4.3487e-01, PNorm = 34.1360, GNorm = 5.3603, lr_0 = 9.0295e-04
Validation rmse = 0.272415
Epoch 4
Validation rmse = 0.199067
Epoch 5
Loss = 3.5434e-01, PNorm = 34.1806, GNorm = 7.8647, lr_0 = 8.5317e-04
Validation rmse = 0.157826
Epoch 6
Loss = 4.3095e-01, PNorm = 34.2116, GNorm = 0.8568, lr_0 = 8.0613e-04
Validation rmse = 0.147371
Epoch 7
Loss = 4.2003e-01, PNorm = 34.2384, GNorm = 2.0166, lr_0 = 7.6168e-04
Validation rmse = 0.186106
Epoch 8
Loss = 3.4042e-01, PNorm = 34.2687, GNorm = 2.3244, lr_0 = 7.1969e-04
Validation rmse = 0.184848
Epoch 9
Validation rmse = 0.158768
Epoch 10
Loss = 4.9862e-01, PNorm = 34.2932, GNorm = 9.5679, lr_0 = 6.8001e-04
Validation rmse = 0.189219
Epoch 11
Loss = 3.9237e-01, PNorm = 34.3183, GNorm = 5.4094, lr_0 = 6.4251e-04
Validation rmse = 0.173410
Epoch 12
Loss = 3.2002e-01, PNorm = 34.3420, GNorm = 3.2325, lr_0 = 6.0709e-04
Validation rmse = 0.149178
Epoch 13
Loss = 3.0541e-01, PNorm = 34.3641, GNorm = 3.5338, lr_0 = 5.7362e-04
Validation rmse = 0.169968
Epoch 14
Validation rmse = 0.160984
Epoch 15
Loss = 3.4259e-01, PNorm = 34.3836, GNorm = 0.5062, lr_0 = 5.4199e-04
Validation rmse = 0.173767
Epoch 16
Loss = 2.7400e-01, PNorm = 34.4042, GNorm = 0.6596, lr_0 = 5.1211e-04
Validation rmse = 0.162796
Epoch 17
Loss = 2.7787e-01, PNorm = 34.4264, GNorm = 1.9661, lr_0 = 4.8113e-04
Validation rmse = 0.160794
Epoch 18
Loss = 2.6115e-01, PNorm = 34.4464, GNorm = 4.7476, lr_0 = 4.5461e-04
Validation rmse = 0.197999
Epoch 19
Validation rmse = 0.184555
Epoch 20
Loss = 2.7765e-01, PNorm = 34.4665, GNorm = 7.5512, lr_0 = 4.2954e-04
Validation rmse = 0.130768
Epoch 21
Loss = 2.7850e-01, PNorm = 34.4837, GNorm = 6.3837, lr_0 = 4.0586e-04
Validation rmse = 0.133041
Epoch 22
Loss = 2.6866e-01, PNorm = 34.5027, GNorm = 6.0734, lr_0 = 3.8348e-04
Validation rmse = 0.163300
Epoch 23
Loss = 2.7673e-01, PNorm = 34.5211, GNorm = 4.9226, lr_0 = 3.6234e-04
Validation rmse = 0.225526
Epoch 24
Validation rmse = 0.193938
Epoch 25
Loss = 2.4950e-01, PNorm = 34.5404, GNorm = 2.3107, lr_0 = 3.4236e-04
Validation rmse = 0.158506
Epoch 26
Loss = 2.5197e-01, PNorm = 34.5560, GNorm = 1.5435, lr_0 = 3.2348e-04
Validation rmse = 0.205058
Epoch 27
Loss = 2.1648e-01, PNorm = 34.5728, GNorm = 1.0127, lr_0 = 3.0565e-04
Validation rmse = 0.143263
Epoch 28
Loss = 2.4269e-01, PNorm = 34.5877, GNorm = 3.6212, lr_0 = 2.8880e-04
Validation rmse = 0.164519
Epoch 29
Validation rmse = 0.146501
Epoch 30
Loss = 1.7809e-01, PNorm = 34.6035, GNorm = 0.5056, lr_0 = 2.7287e-04
Validation rmse = 0.175207
Epoch 31
Loss = 2.1115e-01, PNorm = 34.6183, GNorm = 0.7783, lr_0 = 2.5783e-04
Validation rmse = 0.167914
Epoch 32
Loss = 2.2223e-01, PNorm = 34.6325, GNorm = 1.2652, lr_0 = 2.4361e-04
Validation rmse = 0.164466
Epoch 33
Validation rmse = 0.124368
Epoch 34
Loss = 1.6506e-01, PNorm = 34.6481, GNorm = 1.3040, lr_0 = 2.2888e-04
Validation rmse = 0.191592
Epoch 35
Loss = 2.4872e-01, PNorm = 34.6611, GNorm = 2.1423, lr_0 = 2.1626e-04
Validation rmse = 0.168087
Epoch 36
Loss = 2.1711e-01, PNorm = 34.6741, GNorm = 4.4404, lr_0 = 2.0434e-04
Validation rmse = 0.144710
Epoch 37
Loss = 2.2371e-01, PNorm = 34.6866, GNorm = 2.2430, lr_0 = 1.9307e-04
Validation rmse = 0.143392
Epoch 38
Validation rmse = 0.150851
Epoch 39
Loss = 2.8713e-01, PNorm = 34.6979, GNorm = 3.7619, lr_0 = 1.8242e-04
Validation rmse = 0.142893
Epoch 40
Loss = 2.1507e-01, PNorm = 34.7082, GNorm = 1.7365, lr_0 = 1.7237e-04
Validation rmse = 0.154743
Epoch 41
Loss = 2.1351e-01, PNorm = 34.7190, GNorm = 3.1933, lr_0 = 1.6286e-04
Validation rmse = 0.187671
Epoch 42
Loss = 2.1259e-01, PNorm = 34.7288, GNorm = 0.9719, lr_0 = 1.5388e-04
Validation rmse = 0.133664
Epoch 43
Validation rmse = 0.173032
Epoch 44
Loss = 2.3451e-01, PNorm = 34.7384, GNorm = 2.8900, lr_0 = 1.4540e-04
Validation rmse = 0.151816
Epoch 45
Loss = 1.9103e-01, PNorm = 34.7476, GNorm = 0.7965, lr_0 = 1.3738e-04
Validation rmse = 0.165688
Epoch 46
Loss = 1.8719e-01, PNorm = 34.7562, GNorm = 4.0635, lr_0 = 1.2981e-04
Validation rmse = 0.168691
Epoch 47
Loss = 2.0924e-01, PNorm = 34.7646, GNorm = 1.3235, lr_0 = 1.2265e-04
Validation rmse = 0.141519
Epoch 48
Validation rmse = 0.176346
Epoch 49
Loss = 1.7509e-01, PNorm = 34.7726, GNorm = 1.3587, lr_0 = 1.1589e-04
Validation rmse = 0.137996
Epoch 50
Loss = 1.7252e-01, PNorm = 34.7797, GNorm = 4.0010, lr_0 = 1.0950e-04
Validation rmse = 0.181160
Epoch 51
Loss = 2.0559e-01, PNorm = 34.7871, GNorm = 1.1777, lr_0 = 1.0288e-04
Validation rmse = 0.139143
Epoch 52
Loss = 1.9689e-01, PNorm = 34.7940, GNorm = 1.8448, lr_0 = 1.0000e-04
Validation rmse = 0.161272
Epoch 53
Validation rmse = 0.147891
Epoch 54
Loss = 2.0217e-01, PNorm = 34.8010, GNorm = 1.7825, lr_0 = 1.0000e-04
Validation rmse = 0.165967
Epoch 55
Loss = 1.9109e-01, PNorm = 34.8077, GNorm = 2.1962, lr_0 = 1.0000e-04
Validation rmse = 0.138064
Epoch 56
Loss = 2.0420e-01, PNorm = 34.8147, GNorm = 0.6226, lr_0 = 1.0000e-04
Validation rmse = 0.161054
Epoch 57
Loss = 1.9232e-01, PNorm = 34.8215, GNorm = 1.0910, lr_0 = 1.0000e-04
Validation rmse = 0.148415
Epoch 58
Validation rmse = 0.149961
Epoch 59
Loss = 2.1225e-01, PNorm = 34.8287, GNorm = 3.2242, lr_0 = 1.0000e-04
Validation rmse = 0.151781
Model 0 best validation rmse = 0.124368 on epoch 33
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.052863
Ensemble test rmse = 0.052863
1-fold cross validation
	Seed 0 ==> test rmse = 0.052863
Overall test rmse = 0.052863 +/- 0.000000
Elapsed time = 0:00:17
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 397 | train size = 393 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.261848
Epoch 1
Loss = 6.5918e-01, PNorm = 34.0262, GNorm = 2.2361, lr_0 = 8.7143e-04
Validation rmse = 0.246323
Epoch 2
Loss = 6.0654e-01, PNorm = 34.0666, GNorm = 2.4267, lr_0 = 9.5564e-04
Validation rmse = 0.238788
Epoch 3
Loss = 4.7777e-01, PNorm = 34.1233, GNorm = 2.3456, lr_0 = 9.0295e-04
Validation rmse = 0.242216
Epoch 4
Validation rmse = 0.265244
Epoch 5
Loss = 3.7986e-01, PNorm = 34.1779, GNorm = 3.6436, lr_0 = 8.5317e-04
Validation rmse = 0.236101
Epoch 6
Loss = 3.3841e-01, PNorm = 34.2168, GNorm = 6.5248, lr_0 = 8.0613e-04
Validation rmse = 0.207508
Epoch 7
Loss = 3.3334e-01, PNorm = 34.2481, GNorm = 3.4561, lr_0 = 7.6168e-04
Validation rmse = 0.217220
Epoch 8
Loss = 2.8147e-01, PNorm = 34.2831, GNorm = 5.8459, lr_0 = 7.1562e-04
Validation rmse = 0.230486
Epoch 9
Validation rmse = 0.218384
Epoch 10
Loss = 2.3015e-01, PNorm = 34.3072, GNorm = 1.2749, lr_0 = 6.7616e-04
Validation rmse = 0.211390
Epoch 11
Loss = 2.4722e-01, PNorm = 34.3279, GNorm = 2.4113, lr_0 = 6.3888e-04
Validation rmse = 0.206995
Epoch 12
Loss = 2.5728e-01, PNorm = 34.3509, GNorm = 1.2120, lr_0 = 6.0365e-04
Validation rmse = 0.181957
Epoch 13
Loss = 2.4676e-01, PNorm = 34.3700, GNorm = 2.0422, lr_0 = 5.7037e-04
Validation rmse = 0.159692
Epoch 14
Validation rmse = 0.204494
Epoch 15
Loss = 2.1894e-01, PNorm = 34.3910, GNorm = 4.6042, lr_0 = 5.3588e-04
Validation rmse = 0.218139
Epoch 16
Loss = 2.7281e-01, PNorm = 34.4095, GNorm = 7.3500, lr_0 = 5.0633e-04
Validation rmse = 0.250910
Epoch 17
Loss = 2.3748e-01, PNorm = 34.4264, GNorm = 3.4063, lr_0 = 4.7841e-04
Validation rmse = 0.180240
Epoch 18
Validation rmse = 0.200126
Epoch 19
Loss = 1.5559e-01, PNorm = 34.4451, GNorm = 0.7557, lr_0 = 4.5204e-04
Validation rmse = 0.192898
Epoch 20
Loss = 2.5969e-01, PNorm = 34.4633, GNorm = 5.6180, lr_0 = 4.2711e-04
Validation rmse = 0.196359
Epoch 21
Loss = 2.0951e-01, PNorm = 34.4825, GNorm = 1.8384, lr_0 = 4.0356e-04
Validation rmse = 0.182693
Epoch 22
Loss = 2.0880e-01, PNorm = 34.5000, GNorm = 2.8149, lr_0 = 3.7916e-04
Validation rmse = 0.169488
Epoch 23
Validation rmse = 0.154661
Epoch 24
Loss = 2.0073e-01, PNorm = 34.5137, GNorm = 4.4169, lr_0 = 3.5825e-04
Validation rmse = 0.157454
Epoch 25
Loss = 2.2780e-01, PNorm = 34.5285, GNorm = 5.5549, lr_0 = 3.3850e-04
Validation rmse = 0.165020
Epoch 26
Loss = 1.9245e-01, PNorm = 34.5412, GNorm = 0.8037, lr_0 = 3.1984e-04
Validation rmse = 0.163026
Epoch 27
Loss = 2.0239e-01, PNorm = 34.5563, GNorm = 1.3008, lr_0 = 3.0220e-04
Validation rmse = 0.164153
Epoch 28
Validation rmse = 0.199340
Epoch 29
Loss = 1.9952e-01, PNorm = 34.5710, GNorm = 3.7357, lr_0 = 2.8392e-04
Validation rmse = 0.199680
Epoch 30
Loss = 1.7100e-01, PNorm = 34.5830, GNorm = 2.6301, lr_0 = 2.6827e-04
Validation rmse = 0.205913
Epoch 31
Loss = 2.3481e-01, PNorm = 34.5940, GNorm = 7.9309, lr_0 = 2.5348e-04
Validation rmse = 0.205439
Epoch 32
Validation rmse = 0.150396
Epoch 33
Loss = 2.7383e-01, PNorm = 34.6049, GNorm = 4.1267, lr_0 = 2.3950e-04
Validation rmse = 0.171011
Epoch 34
Loss = 2.1757e-01, PNorm = 34.6159, GNorm = 8.0987, lr_0 = 2.2630e-04
Validation rmse = 0.208953
Epoch 35
Loss = 1.9147e-01, PNorm = 34.6260, GNorm = 1.0744, lr_0 = 2.1382e-04
Validation rmse = 0.165316
Epoch 36
Loss = 1.8760e-01, PNorm = 34.6361, GNorm = 2.6202, lr_0 = 2.0089e-04
Validation rmse = 0.171978
Epoch 37
Validation rmse = 0.191394
Epoch 38
Loss = 1.8211e-01, PNorm = 34.6454, GNorm = 2.9056, lr_0 = 1.8981e-04
Validation rmse = 0.171254
Epoch 39
Loss = 1.4696e-01, PNorm = 34.6538, GNorm = 0.6790, lr_0 = 1.7935e-04
Validation rmse = 0.174375
Epoch 40
Loss = 1.7819e-01, PNorm = 34.6617, GNorm = 0.8090, lr_0 = 1.6946e-04
Validation rmse = 0.182502
Epoch 41
Loss = 1.7689e-01, PNorm = 34.6695, GNorm = 2.0777, lr_0 = 1.6012e-04
Validation rmse = 0.162841
Epoch 42
Validation rmse = 0.172604
Epoch 43
Loss = 1.5948e-01, PNorm = 34.6773, GNorm = 4.0737, lr_0 = 1.5043e-04
Validation rmse = 0.165218
Epoch 44
Loss = 1.7966e-01, PNorm = 34.6844, GNorm = 1.6544, lr_0 = 1.4214e-04
Validation rmse = 0.178523
Epoch 45
Loss = 1.7796e-01, PNorm = 34.6912, GNorm = 4.0943, lr_0 = 1.3430e-04
Validation rmse = 0.179432
Epoch 46
Validation rmse = 0.160636
Epoch 47
Loss = 1.1259e-01, PNorm = 34.6978, GNorm = 1.6743, lr_0 = 1.2690e-04
Validation rmse = 0.183367
Epoch 48
Loss = 1.7643e-01, PNorm = 34.7043, GNorm = 1.9390, lr_0 = 1.1990e-04
Validation rmse = 0.154809
Epoch 49
Loss = 1.9657e-01, PNorm = 34.7104, GNorm = 1.5806, lr_0 = 1.1329e-04
Validation rmse = 0.180924
Epoch 50
Loss = 1.5968e-01, PNorm = 34.7160, GNorm = 1.1915, lr_0 = 1.0704e-04
Loss = 2.7571e-01, PNorm = 34.7165, GNorm = 4.8362, lr_0 = 1.0644e-04
Validation rmse = 0.159118
Epoch 51
Validation rmse = 0.174463
Epoch 52
Loss = 1.7488e-01, PNorm = 34.7216, GNorm = 2.1695, lr_0 = 1.0057e-04
Validation rmse = 0.158169
Epoch 53
Loss = 1.7221e-01, PNorm = 34.7269, GNorm = 3.1597, lr_0 = 1.0000e-04
Validation rmse = 0.182688
Epoch 54
Loss = 1.5874e-01, PNorm = 34.7319, GNorm = 1.0959, lr_0 = 1.0000e-04
Validation rmse = 0.155238
Epoch 55
Loss = 1.6930e-01, PNorm = 34.7375, GNorm = 0.8457, lr_0 = 1.0000e-04
Validation rmse = 0.170016
Epoch 56
Validation rmse = 0.157634
Epoch 57
Loss = 2.0076e-01, PNorm = 34.7428, GNorm = 3.2496, lr_0 = 1.0000e-04
Validation rmse = 0.172060
Epoch 58
Loss = 1.5492e-01, PNorm = 34.7487, GNorm = 0.6290, lr_0 = 1.0000e-04
Validation rmse = 0.167213
Epoch 59
Loss = 1.6854e-01, PNorm = 34.7543, GNorm = 3.8509, lr_0 = 1.0000e-04
Validation rmse = 0.184137
Model 0 best validation rmse = 0.150396 on epoch 32
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.083201
Ensemble test rmse = 0.083201
1-fold cross validation
	Seed 0 ==> test rmse = 0.083201
Overall test rmse = 0.083201 +/- 0.000000
Elapsed time = 0:00:17
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 392 | train size = 388 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.015071
Epoch 1
Loss = 9.8735e-01, PNorm = 34.0267, GNorm = 8.8687, lr_0 = 8.7143e-04
Validation rmse = 0.010426
Epoch 2
Loss = 6.8553e-01, PNorm = 34.0661, GNorm = 3.6034, lr_0 = 9.5564e-04
Validation rmse = 0.123987
Epoch 3
Loss = 4.7965e-01, PNorm = 34.1257, GNorm = 0.9667, lr_0 = 9.0295e-04
Validation rmse = 0.180729
Epoch 4
Validation rmse = 0.169307
Epoch 5
Loss = 3.5001e-01, PNorm = 34.1895, GNorm = 0.8743, lr_0 = 8.4834e-04
Validation rmse = 0.196188
Epoch 6
Loss = 3.1863e-01, PNorm = 34.2297, GNorm = 4.5237, lr_0 = 8.0157e-04
Validation rmse = 0.238093
Epoch 7
Loss = 2.9734e-01, PNorm = 34.2609, GNorm = 3.4890, lr_0 = 7.5737e-04
Validation rmse = 0.263452
Epoch 8
Validation rmse = 0.204728
Epoch 9
Loss = 2.2327e-01, PNorm = 34.2899, GNorm = 0.9712, lr_0 = 7.1157e-04
Validation rmse = 0.271519
Epoch 10
Loss = 3.4705e-01, PNorm = 34.3157, GNorm = 6.8366, lr_0 = 6.7234e-04
Validation rmse = 0.218099
Epoch 11
Loss = 2.1665e-01, PNorm = 34.3386, GNorm = 0.8257, lr_0 = 6.3527e-04
Validation rmse = 0.211771
Epoch 12
Loss = 2.2689e-01, PNorm = 34.3594, GNorm = 1.4502, lr_0 = 6.0024e-04
Loss = 2.3003e-01, PNorm = 34.3619, GNorm = 1.8451, lr_0 = 5.9685e-04
Validation rmse = 0.218978
Epoch 13
Validation rmse = 0.220921
Epoch 14
Loss = 1.8802e-01, PNorm = 34.3829, GNorm = 1.6417, lr_0 = 5.6394e-04
Validation rmse = 0.264284
Epoch 15
Loss = 2.2846e-01, PNorm = 34.4024, GNorm = 4.3278, lr_0 = 5.3285e-04
Validation rmse = 0.254739
Epoch 16
Loss = 2.2253e-01, PNorm = 34.4203, GNorm = 2.4713, lr_0 = 5.0347e-04
Validation rmse = 0.231479
Epoch 17
Validation rmse = 0.196952
Epoch 18
Loss = 2.2603e-01, PNorm = 34.4397, GNorm = 4.2042, lr_0 = 4.7302e-04
Validation rmse = 0.205470
Epoch 19
Loss = 2.5531e-01, PNorm = 34.4566, GNorm = 2.9619, lr_0 = 4.4694e-04
Validation rmse = 0.217438
Epoch 20
Loss = 1.9386e-01, PNorm = 34.4741, GNorm = 1.9980, lr_0 = 4.2229e-04
Validation rmse = 0.240735
Epoch 21
Loss = 1.8877e-01, PNorm = 34.4920, GNorm = 0.7351, lr_0 = 3.9675e-04
Validation rmse = 0.235271
Epoch 22
Validation rmse = 0.212120
Epoch 23
Loss = 1.5031e-01, PNorm = 34.5066, GNorm = 1.0093, lr_0 = 3.7488e-04
Validation rmse = 0.224591
Epoch 24
Loss = 1.9616e-01, PNorm = 34.5207, GNorm = 2.6432, lr_0 = 3.5421e-04
Validation rmse = 0.220320
Epoch 25
Loss = 1.9392e-01, PNorm = 34.5335, GNorm = 2.3838, lr_0 = 3.3468e-04
Validation rmse = 0.215752
Epoch 26
Validation rmse = 0.219427
Epoch 27
Loss = 1.1591e-01, PNorm = 34.5483, GNorm = 1.5649, lr_0 = 3.1444e-04
Validation rmse = 0.246437
Epoch 28
Loss = 1.6825e-01, PNorm = 34.5605, GNorm = 1.0833, lr_0 = 2.9710e-04
Validation rmse = 0.248270
Epoch 29
Loss = 1.9987e-01, PNorm = 34.5721, GNorm = 5.2089, lr_0 = 2.8072e-04
Validation rmse = 0.233543
Epoch 30
Loss = 1.7778e-01, PNorm = 34.5854, GNorm = 3.1734, lr_0 = 2.6374e-04
Validation rmse = 0.237625
Epoch 31
Validation rmse = 0.223473
Epoch 32
Loss = 1.4394e-01, PNorm = 34.5965, GNorm = 0.9686, lr_0 = 2.4920e-04
Validation rmse = 0.219592
Epoch 33
Loss = 1.7135e-01, PNorm = 34.6070, GNorm = 0.7966, lr_0 = 2.3546e-04
Validation rmse = 0.226222
Epoch 34
Loss = 1.5853e-01, PNorm = 34.6183, GNorm = 1.3730, lr_0 = 2.2122e-04
Validation rmse = 0.230111
Epoch 35
Validation rmse = 0.227319
Epoch 36
Loss = 1.5130e-01, PNorm = 34.6279, GNorm = 1.1226, lr_0 = 2.0902e-04
Validation rmse = 0.204867
Epoch 37
Loss = 1.5306e-01, PNorm = 34.6366, GNorm = 2.2314, lr_0 = 1.9750e-04
Validation rmse = 0.228613
Epoch 38
Loss = 1.6001e-01, PNorm = 34.6464, GNorm = 1.1063, lr_0 = 1.8556e-04
Validation rmse = 0.223578
Epoch 39
Loss = 1.5917e-01, PNorm = 34.6558, GNorm = 0.6016, lr_0 = 1.7532e-04
Validation rmse = 0.217162
Epoch 40
Validation rmse = 0.235656
Epoch 41
Loss = 1.6862e-01, PNorm = 34.6632, GNorm = 1.1246, lr_0 = 1.6566e-04
Validation rmse = 0.210039
Epoch 42
Loss = 1.6704e-01, PNorm = 34.6715, GNorm = 3.1325, lr_0 = 1.5564e-04
Validation rmse = 0.214494
Epoch 43
Loss = 1.5361e-01, PNorm = 34.6784, GNorm = 2.0878, lr_0 = 1.4706e-04
Validation rmse = 0.215552
Epoch 44
Validation rmse = 0.225119
Epoch 45
Loss = 1.5504e-01, PNorm = 34.6858, GNorm = 1.3084, lr_0 = 1.3895e-04
Validation rmse = 0.215476
Epoch 46
Loss = 1.6968e-01, PNorm = 34.6930, GNorm = 0.6615, lr_0 = 1.3055e-04
Validation rmse = 0.219051
Epoch 47
Loss = 1.6400e-01, PNorm = 34.6995, GNorm = 0.5588, lr_0 = 1.2335e-04
Validation rmse = 0.232533
Epoch 48
Loss = 1.5436e-01, PNorm = 34.7054, GNorm = 2.2008, lr_0 = 1.1655e-04
Validation rmse = 0.218069
Epoch 49
Validation rmse = 0.213345
Epoch 50
Loss = 1.4961e-01, PNorm = 34.7110, GNorm = 3.0483, lr_0 = 1.1012e-04
Validation rmse = 0.221784
Epoch 51
Loss = 1.6480e-01, PNorm = 34.7167, GNorm = 1.7469, lr_0 = 1.0346e-04
Validation rmse = 0.213029
Epoch 52
Loss = 1.4755e-01, PNorm = 34.7217, GNorm = 2.5664, lr_0 = 1.0000e-04
Validation rmse = 0.226287
Epoch 53
Validation rmse = 0.219169
Epoch 54
Loss = 1.4578e-01, PNorm = 34.7266, GNorm = 0.4713, lr_0 = 1.0000e-04
Validation rmse = 0.213266
Epoch 55
Loss = 1.4758e-01, PNorm = 34.7322, GNorm = 0.6695, lr_0 = 1.0000e-04
Validation rmse = 0.213389
Epoch 56
Loss = 1.4300e-01, PNorm = 34.7372, GNorm = 1.4340, lr_0 = 1.0000e-04
Validation rmse = 0.218699
Epoch 57
Loss = 1.4526e-01, PNorm = 34.7421, GNorm = 3.3562, lr_0 = 1.0000e-04
Validation rmse = 0.215207
Epoch 58
Validation rmse = 0.206290
Epoch 59
Loss = 1.4473e-01, PNorm = 34.7478, GNorm = 2.0988, lr_0 = 1.0000e-04
Validation rmse = 0.217386
Model 0 best validation rmse = 0.010426 on epoch 1
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.011383
Ensemble test rmse = 0.011383
1-fold cross validation
	Seed 0 ==> test rmse = 0.011383
Overall test rmse = 0.011383 +/- 0.000000
Elapsed time = 0:00:16
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 417 | train size = 412 | val size = 2 | test size = 3
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.302486
Epoch 1
Loss = 6.9448e-01, PNorm = 34.0263, GNorm = 10.4726, lr_0 = 7.7500e-04
Validation rmse = 0.266605
Epoch 2
Loss = 5.7531e-01, PNorm = 34.0727, GNorm = 4.6743, lr_0 = 9.6586e-04
Validation rmse = 0.473141
Epoch 3
Loss = 5.9972e-01, PNorm = 34.1238, GNorm = 9.6162, lr_0 = 9.1455e-04
Validation rmse = 0.291439
Epoch 4
Loss = 4.9815e-01, PNorm = 34.1690, GNorm = 4.9659, lr_0 = 8.6596e-04
Validation rmse = 0.431240
Epoch 5
Validation rmse = 0.417590
Epoch 6
Loss = 5.9024e-01, PNorm = 34.2046, GNorm = 5.9036, lr_0 = 8.1996e-04
Validation rmse = 0.437419
Epoch 7
Loss = 4.6378e-01, PNorm = 34.2423, GNorm = 5.1006, lr_0 = 7.7640e-04
Validation rmse = 0.435246
Epoch 8
Loss = 4.1967e-01, PNorm = 34.2760, GNorm = 2.6444, lr_0 = 7.3516e-04
Validation rmse = 0.381931
Epoch 9
Loss = 4.6479e-01, PNorm = 34.3013, GNorm = 4.1168, lr_0 = 6.9956e-04
Validation rmse = 0.383374
Epoch 10
Loss = 3.8110e-01, PNorm = 34.3348, GNorm = 2.7143, lr_0 = 6.6240e-04
Loss = 2.8046e-01, PNorm = 34.3365, GNorm = 3.1968, lr_0 = 6.5912e-04
Validation rmse = 0.329067
Epoch 11
Validation rmse = 0.332437
Epoch 12
Loss = 4.4516e-01, PNorm = 34.3603, GNorm = 5.4448, lr_0 = 6.2411e-04
Validation rmse = 0.379623
Epoch 13
Loss = 5.2515e-01, PNorm = 34.3842, GNorm = 10.4184, lr_0 = 5.9389e-04
Validation rmse = 0.443932
Epoch 14
Loss = 3.9676e-01, PNorm = 34.4105, GNorm = 3.8746, lr_0 = 5.6234e-04
Validation rmse = 0.439670
Epoch 15
Loss = 3.7469e-01, PNorm = 34.4383, GNorm = 6.7635, lr_0 = 5.3247e-04
Validation rmse = 0.410594
Epoch 16
Loss = 3.4447e-01, PNorm = 34.4573, GNorm = 4.3078, lr_0 = 5.0418e-04
Validation rmse = 0.427848
Epoch 17
Validation rmse = 0.419135
Epoch 18
Loss = 3.6308e-01, PNorm = 34.4768, GNorm = 2.5166, lr_0 = 4.7740e-04
Validation rmse = 0.392225
Epoch 19
Loss = 3.4006e-01, PNorm = 34.4958, GNorm = 1.5772, lr_0 = 4.5204e-04
Validation rmse = 0.357487
Epoch 20
Loss = 3.6585e-01, PNorm = 34.5139, GNorm = 2.4784, lr_0 = 4.2802e-04
Validation rmse = 0.443725
Epoch 21
Loss = 3.2784e-01, PNorm = 34.5323, GNorm = 1.6920, lr_0 = 4.0730e-04
Validation rmse = 0.457531
Epoch 22
Validation rmse = 0.405626
Epoch 23
Loss = 2.8558e-01, PNorm = 34.5514, GNorm = 0.7230, lr_0 = 3.8375e-04
Validation rmse = 0.450078
Epoch 24
Loss = 3.2111e-01, PNorm = 34.5681, GNorm = 2.5665, lr_0 = 3.6337e-04
Validation rmse = 0.434334
Epoch 25
Loss = 3.0158e-01, PNorm = 34.5824, GNorm = 3.1724, lr_0 = 3.4577e-04
Validation rmse = 0.425760
Epoch 26
Loss = 3.1256e-01, PNorm = 34.5989, GNorm = 2.2217, lr_0 = 3.2741e-04
Validation rmse = 0.482665
Epoch 27
Loss = 3.1856e-01, PNorm = 34.6166, GNorm = 0.9283, lr_0 = 3.1001e-04
Loss = 2.1840e-01, PNorm = 34.6182, GNorm = 3.6299, lr_0 = 3.0848e-04
Validation rmse = 0.439920
Epoch 28
Validation rmse = 0.413941
Epoch 29
Loss = 2.9189e-01, PNorm = 34.6363, GNorm = 1.5028, lr_0 = 2.9209e-04
Validation rmse = 0.346736
Epoch 30
Loss = 3.2112e-01, PNorm = 34.6526, GNorm = 7.1901, lr_0 = 2.7795e-04
Validation rmse = 0.483795
Epoch 31
Loss = 3.5004e-01, PNorm = 34.6696, GNorm = 4.6804, lr_0 = 2.6318e-04
Validation rmse = 0.456573
Epoch 32
Loss = 2.8349e-01, PNorm = 34.6831, GNorm = 1.8319, lr_0 = 2.4920e-04
Validation rmse = 0.459336
Epoch 33
Loss = 3.1871e-01, PNorm = 34.6945, GNorm = 3.1620, lr_0 = 2.3596e-04
Validation rmse = 0.412250
Epoch 34
Validation rmse = 0.444259
Epoch 35
Loss = 2.6588e-01, PNorm = 34.7057, GNorm = 1.0501, lr_0 = 2.2343e-04
Validation rmse = 0.475568
Epoch 36
Loss = 2.4732e-01, PNorm = 34.7166, GNorm = 4.2877, lr_0 = 2.1156e-04
Validation rmse = 0.413993
Epoch 37
Loss = 2.6596e-01, PNorm = 34.7272, GNorm = 2.8984, lr_0 = 2.0032e-04
Validation rmse = 0.465699
Epoch 38
Loss = 2.7528e-01, PNorm = 34.7379, GNorm = 0.7953, lr_0 = 1.9062e-04
Validation rmse = 0.423127
Epoch 39
Validation rmse = 0.453163
Epoch 40
Loss = 2.3167e-01, PNorm = 34.7487, GNorm = 2.1665, lr_0 = 1.7960e-04
Validation rmse = 0.448148
Epoch 41
Loss = 2.0320e-01, PNorm = 34.7584, GNorm = 2.5075, lr_0 = 1.7006e-04
Validation rmse = 0.459819
Epoch 42
Loss = 2.9399e-01, PNorm = 34.7681, GNorm = 1.0555, lr_0 = 1.6183e-04
Validation rmse = 0.437052
Epoch 43
Loss = 2.8095e-01, PNorm = 34.7784, GNorm = 1.1029, lr_0 = 1.5323e-04
Validation rmse = 0.456699
Epoch 44
Loss = 2.6635e-01, PNorm = 34.7877, GNorm = 2.8978, lr_0 = 1.4509e-04
Loss = 4.4949e-01, PNorm = 34.7886, GNorm = 6.1410, lr_0 = 1.4437e-04
Validation rmse = 0.430560
Epoch 45
Validation rmse = 0.417094
Epoch 46
Loss = 1.9039e-01, PNorm = 34.7974, GNorm = 2.6303, lr_0 = 1.3738e-04
Validation rmse = 0.449943
Epoch 47
Loss = 2.6222e-01, PNorm = 34.8060, GNorm = 1.0387, lr_0 = 1.3008e-04
Validation rmse = 0.433880
Epoch 48
Loss = 2.7325e-01, PNorm = 34.8144, GNorm = 1.5022, lr_0 = 1.2317e-04
Validation rmse = 0.449938
Epoch 49
Loss = 2.5209e-01, PNorm = 34.8221, GNorm = 1.0571, lr_0 = 1.1663e-04
Validation rmse = 0.444704
Epoch 50
Loss = 2.6156e-01, PNorm = 34.8287, GNorm = 1.1436, lr_0 = 1.1098e-04
Loss = 4.5553e-02, PNorm = 34.8293, GNorm = 1.2218, lr_0 = 1.1043e-04
Validation rmse = 0.438572
Epoch 51
Validation rmse = 0.447500
Epoch 52
Loss = 2.9905e-01, PNorm = 34.8363, GNorm = 1.5337, lr_0 = 1.0457e-04
Validation rmse = 0.434863
Epoch 53
Loss = 3.0791e-01, PNorm = 34.8429, GNorm = 1.7909, lr_0 = 1.0000e-04
Validation rmse = 0.443784
Epoch 54
Loss = 2.1788e-01, PNorm = 34.8500, GNorm = 3.1364, lr_0 = 1.0000e-04
Validation rmse = 0.437748
Epoch 55
Loss = 2.4886e-01, PNorm = 34.8553, GNorm = 1.5269, lr_0 = 1.0000e-04
Validation rmse = 0.443838
Epoch 56
Validation rmse = 0.427054
Epoch 57
Loss = 2.8851e-01, PNorm = 34.8637, GNorm = 4.7756, lr_0 = 1.0000e-04
Validation rmse = 0.448635
Epoch 58
Loss = 2.1855e-01, PNorm = 34.8712, GNorm = 1.7299, lr_0 = 1.0000e-04
Validation rmse = 0.447411
Epoch 59
Loss = 1.9498e-01, PNorm = 34.8777, GNorm = 1.1700, lr_0 = 1.0000e-04
Validation rmse = 0.444653
Model 0 best validation rmse = 0.266605 on epoch 1
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.331675
Ensemble test rmse = 0.331675
1-fold cross validation
	Seed 0 ==> test rmse = 0.331675
Overall test rmse = 0.331675 +/- 0.000000
Elapsed time = 0:00:18
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 412 | train size = 407 | val size = 2 | test size = 3
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.304620
Epoch 1
Loss = 8.5912e-01, PNorm = 34.0214, GNorm = 3.4935, lr_0 = 7.7500e-04
Validation rmse = 0.325712
Epoch 2
Loss = 7.8754e-01, PNorm = 34.0648, GNorm = 4.2082, lr_0 = 9.6586e-04
Validation rmse = 0.310644
Epoch 3
Loss = 5.7048e-01, PNorm = 34.1139, GNorm = 3.4310, lr_0 = 9.1455e-04
Validation rmse = 0.294699
Epoch 4
Loss = 4.8857e-01, PNorm = 34.1682, GNorm = 7.5632, lr_0 = 8.6596e-04
Loss = 6.1904e-01, PNorm = 34.1739, GNorm = 3.1028, lr_0 = 8.6168e-04
Validation rmse = 0.344361
Epoch 5
Validation rmse = 0.306665
Epoch 6
Loss = 4.9375e-01, PNorm = 34.2215, GNorm = 1.4313, lr_0 = 8.1590e-04
Validation rmse = 0.261069
Epoch 7
Loss = 4.9884e-01, PNorm = 34.2589, GNorm = 3.5715, lr_0 = 7.7256e-04
Validation rmse = 0.266303
Epoch 8
Loss = 4.0185e-01, PNorm = 34.2877, GNorm = 1.6447, lr_0 = 7.3516e-04
Validation rmse = 0.267612
Epoch 9
Loss = 3.8667e-01, PNorm = 34.3176, GNorm = 1.3574, lr_0 = 6.9610e-04
Validation rmse = 0.253660
Epoch 10
Validation rmse = 0.252814
Epoch 11
Loss = 3.5805e-01, PNorm = 34.3479, GNorm = 4.2229, lr_0 = 6.5586e-04
Validation rmse = 0.263779
Epoch 12
Loss = 3.3736e-01, PNorm = 34.3748, GNorm = 2.3246, lr_0 = 6.2102e-04
Validation rmse = 0.281244
Epoch 13
Loss = 3.7276e-01, PNorm = 34.4006, GNorm = 4.5009, lr_0 = 5.8803e-04
Validation rmse = 0.283124
Epoch 14
Loss = 3.7075e-01, PNorm = 34.4267, GNorm = 3.0339, lr_0 = 5.5679e-04
Validation rmse = 0.307984
Epoch 15
Loss = 4.1607e-01, PNorm = 34.4495, GNorm = 1.0284, lr_0 = 5.2983e-04
Loss = 2.5451e-01, PNorm = 34.4517, GNorm = 1.9257, lr_0 = 5.2721e-04
Validation rmse = 0.279737
Epoch 16
Validation rmse = 0.246472
Epoch 17
Loss = 3.1261e-01, PNorm = 34.4771, GNorm = 1.5452, lr_0 = 4.9920e-04
Validation rmse = 0.242398
Epoch 18
Loss = 3.0941e-01, PNorm = 34.5013, GNorm = 2.0710, lr_0 = 4.7268e-04
Validation rmse = 0.264664
Epoch 19
Loss = 3.4623e-01, PNorm = 34.5225, GNorm = 2.8506, lr_0 = 4.4757e-04
Validation rmse = 0.251452
Epoch 20
Loss = 3.1966e-01, PNorm = 34.5456, GNorm = 1.3971, lr_0 = 4.2379e-04
Loss = 3.1703e-01, PNorm = 34.5472, GNorm = 2.3309, lr_0 = 4.2170e-04
Validation rmse = 0.238913
Epoch 21
Validation rmse = 0.284228
Epoch 22
Loss = 2.2527e-01, PNorm = 34.5640, GNorm = 1.6964, lr_0 = 4.0128e-04
Validation rmse = 0.236818
Epoch 23
Loss = 3.0676e-01, PNorm = 34.5837, GNorm = 0.7597, lr_0 = 3.7996e-04
Validation rmse = 0.234008
Epoch 24
Loss = 3.6284e-01, PNorm = 34.6007, GNorm = 3.6464, lr_0 = 3.5978e-04
Validation rmse = 0.272598
Epoch 25
Loss = 3.2844e-01, PNorm = 34.6189, GNorm = 2.2630, lr_0 = 3.4067e-04
Validation rmse = 0.243395
Epoch 26
Validation rmse = 0.235311
Epoch 27
Loss = 3.0744e-01, PNorm = 34.6402, GNorm = 3.3339, lr_0 = 3.2097e-04
Validation rmse = 0.238409
Epoch 28
Loss = 3.1622e-01, PNorm = 34.6574, GNorm = 0.9087, lr_0 = 3.0392e-04
Validation rmse = 0.247920
Epoch 29
Loss = 3.0316e-01, PNorm = 34.6739, GNorm = 0.8051, lr_0 = 2.8921e-04
Validation rmse = 0.265795
Epoch 30
Loss = 3.3626e-01, PNorm = 34.6885, GNorm = 2.3481, lr_0 = 2.7384e-04
Validation rmse = 0.245138
Epoch 31
Loss = 2.8932e-01, PNorm = 34.7031, GNorm = 2.0836, lr_0 = 2.5929e-04
Loss = 3.8060e-01, PNorm = 34.7045, GNorm = 7.7937, lr_0 = 2.5801e-04
Validation rmse = 0.260713
Epoch 32
Validation rmse = 0.236443
Epoch 33
Loss = 2.8502e-01, PNorm = 34.7192, GNorm = 0.7367, lr_0 = 2.4430e-04
Validation rmse = 0.233410
Epoch 34
Loss = 2.9617e-01, PNorm = 34.7322, GNorm = 5.0118, lr_0 = 2.3133e-04
Validation rmse = 0.247614
Epoch 35
Loss = 2.5454e-01, PNorm = 34.7458, GNorm = 1.0181, lr_0 = 2.1904e-04
Validation rmse = 0.252065
Epoch 36
Loss = 2.9068e-01, PNorm = 34.7586, GNorm = 2.6629, lr_0 = 2.0843e-04
Validation rmse = 0.229087
Epoch 37
Validation rmse = 0.249550
Epoch 38
Loss = 3.9596e-01, PNorm = 34.7741, GNorm = 3.5479, lr_0 = 1.9638e-04
Validation rmse = 0.234364
Epoch 39
Loss = 2.9628e-01, PNorm = 34.7853, GNorm = 2.9201, lr_0 = 1.8595e-04
Validation rmse = 0.243619
Epoch 40
Loss = 2.5709e-01, PNorm = 34.7963, GNorm = 0.6954, lr_0 = 1.7607e-04
Validation rmse = 0.237444
Epoch 41
Loss = 2.6738e-01, PNorm = 34.8061, GNorm = 1.5728, lr_0 = 1.6672e-04
Validation rmse = 0.250016
Epoch 42
Loss = 3.0224e-01, PNorm = 34.8177, GNorm = 5.4693, lr_0 = 1.5786e-04
Validation rmse = 0.253677
Epoch 43
Validation rmse = 0.248938
Epoch 44
Loss = 2.3563e-01, PNorm = 34.8283, GNorm = 0.5530, lr_0 = 1.4948e-04
Validation rmse = 0.247573
Epoch 45
Loss = 2.6430e-01, PNorm = 34.8368, GNorm = 2.5666, lr_0 = 1.4153e-04
Validation rmse = 0.251452
Epoch 46
Loss = 2.6136e-01, PNorm = 34.8455, GNorm = 4.5094, lr_0 = 1.3402e-04
Validation rmse = 0.244444
Epoch 47
Loss = 2.5329e-01, PNorm = 34.8543, GNorm = 1.1858, lr_0 = 1.2690e-04
Loss = 4.5062e-02, PNorm = 34.8551, GNorm = 1.3380, lr_0 = 1.2627e-04
Validation rmse = 0.244515
Epoch 48
Validation rmse = 0.243926
Epoch 49
Loss = 2.5393e-01, PNorm = 34.8627, GNorm = 1.7759, lr_0 = 1.1956e-04
Validation rmse = 0.247428
Epoch 50
Loss = 2.2538e-01, PNorm = 34.8687, GNorm = 0.9131, lr_0 = 1.1377e-04
Validation rmse = 0.247106
Epoch 51
Loss = 2.4281e-01, PNorm = 34.8757, GNorm = 0.7859, lr_0 = 1.0773e-04
Validation rmse = 0.250415
Epoch 52
Loss = 2.5280e-01, PNorm = 34.8821, GNorm = 0.9167, lr_0 = 1.0200e-04
Validation rmse = 0.244004
Epoch 53
Validation rmse = 0.246028
Epoch 54
Loss = 1.7726e-01, PNorm = 34.8892, GNorm = 1.4051, lr_0 = 1.0000e-04
Validation rmse = 0.245166
Epoch 55
Loss = 1.5669e-01, PNorm = 34.8953, GNorm = 0.6762, lr_0 = 1.0000e-04
Validation rmse = 0.243868
Epoch 56
Loss = 2.3126e-01, PNorm = 34.9017, GNorm = 1.3157, lr_0 = 1.0000e-04
Validation rmse = 0.245869
Epoch 57
Loss = 2.3373e-01, PNorm = 34.9081, GNorm = 1.5160, lr_0 = 1.0000e-04
Validation rmse = 0.247946
Epoch 58
Loss = 2.4064e-01, PNorm = 34.9142, GNorm = 1.1324, lr_0 = 1.0000e-04
Loss = 5.4260e-02, PNorm = 34.9148, GNorm = 2.7520, lr_0 = 1.0000e-04
Validation rmse = 0.245749
Epoch 59
Validation rmse = 0.249110
Model 0 best validation rmse = 0.229087 on epoch 36
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.097964
Ensemble test rmse = 0.097964
1-fold cross validation
	Seed 0 ==> test rmse = 0.097964
Overall test rmse = 0.097964 +/- 0.000000
Elapsed time = 0:00:17
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 407 | train size = 402 | val size = 2 | test size = 3
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.462420
Epoch 1
Loss = 1.4835e+00, PNorm = 34.0224, GNorm = 16.0918, lr_0 = 7.7500e-04
Validation rmse = 0.432283
Epoch 2
Loss = 1.0283e+00, PNorm = 34.0552, GNorm = 4.0836, lr_0 = 9.6586e-04
Validation rmse = 0.392397
Epoch 3
Loss = 8.4818e-01, PNorm = 34.0997, GNorm = 0.8536, lr_0 = 9.1455e-04
Validation rmse = 0.403575
Epoch 4
Loss = 6.4081e-01, PNorm = 34.1540, GNorm = 1.2888, lr_0 = 8.6596e-04
Loss = 8.0171e-02, PNorm = 34.1589, GNorm = 3.5188, lr_0 = 8.6168e-04
Validation rmse = 0.368542
Epoch 5
Validation rmse = 0.375123
Epoch 6
Loss = 5.5920e-01, PNorm = 34.2185, GNorm = 4.1327, lr_0 = 8.1590e-04
Validation rmse = 0.342928
Epoch 7
Loss = 3.7847e-01, PNorm = 34.2626, GNorm = 1.5167, lr_0 = 7.7256e-04
Validation rmse = 0.304957
Epoch 8
Loss = 4.1394e-01, PNorm = 34.3012, GNorm = 1.4494, lr_0 = 7.3152e-04
Validation rmse = 0.333215
Epoch 9
Loss = 3.5794e-01, PNorm = 34.3337, GNorm = 3.1792, lr_0 = 6.9266e-04
Loss = 1.3997e-01, PNorm = 34.3359, GNorm = 5.2308, lr_0 = 6.8923e-04
Validation rmse = 0.319586
Epoch 10
Validation rmse = 0.298246
Epoch 11
Loss = 6.1797e-01, PNorm = 34.3554, GNorm = 12.5669, lr_0 = 6.5261e-04
Validation rmse = 0.306657
Epoch 12
Loss = 5.9131e-01, PNorm = 34.3747, GNorm = 10.6976, lr_0 = 6.1794e-04
Validation rmse = 0.396391
Epoch 13
Loss = 3.9914e-01, PNorm = 34.4003, GNorm = 2.4666, lr_0 = 5.8512e-04
Validation rmse = 0.315600
Epoch 14
Loss = 3.7895e-01, PNorm = 34.4220, GNorm = 1.6872, lr_0 = 5.5403e-04
Loss = 2.7696e-01, PNorm = 34.4236, GNorm = 8.9484, lr_0 = 5.5129e-04
Validation rmse = 0.271196
Epoch 15
Validation rmse = 0.379811
Epoch 16
Loss = 4.0077e-01, PNorm = 34.4398, GNorm = 2.9571, lr_0 = 5.2200e-04
Validation rmse = 0.321445
Epoch 17
Loss = 3.3642e-01, PNorm = 34.4609, GNorm = 2.7248, lr_0 = 4.9427e-04
Validation rmse = 0.334167
Epoch 18
Loss = 2.8414e-01, PNorm = 34.4794, GNorm = 1.7384, lr_0 = 4.6801e-04
Validation rmse = 0.318536
Epoch 19
Loss = 3.1473e-01, PNorm = 34.4934, GNorm = 0.7870, lr_0 = 4.4315e-04
Loss = 8.8842e-02, PNorm = 34.4949, GNorm = 4.0213, lr_0 = 4.4096e-04
Validation rmse = 0.336001
Epoch 20
Validation rmse = 0.298892
Epoch 21
Loss = 2.9503e-01, PNorm = 34.5098, GNorm = 1.6919, lr_0 = 4.1753e-04
Validation rmse = 0.373696
Epoch 22
Loss = 3.1571e-01, PNorm = 34.5225, GNorm = 5.7267, lr_0 = 3.9535e-04
Validation rmse = 0.299827
Epoch 23
Loss = 3.3566e-01, PNorm = 34.5362, GNorm = 2.1267, lr_0 = 3.7435e-04
Validation rmse = 0.370971
Epoch 24
Loss = 3.1525e-01, PNorm = 34.5513, GNorm = 4.2787, lr_0 = 3.5446e-04
Validation rmse = 0.315287
Epoch 25
Validation rmse = 0.341830
Epoch 26
Loss = 3.2253e-01, PNorm = 34.5663, GNorm = 2.9839, lr_0 = 3.3563e-04
Validation rmse = 0.300277
Epoch 27
Loss = 2.8474e-01, PNorm = 34.5763, GNorm = 1.6592, lr_0 = 3.1780e-04
Validation rmse = 0.309893
Epoch 28
Loss = 3.0021e-01, PNorm = 34.5859, GNorm = 1.9985, lr_0 = 3.0092e-04
Validation rmse = 0.272480
Epoch 29
Loss = 3.0982e-01, PNorm = 34.5940, GNorm = 2.3531, lr_0 = 2.8493e-04
Validation rmse = 0.306186
Epoch 30
Validation rmse = 0.314720
Epoch 31
Loss = 3.1837e-01, PNorm = 34.6051, GNorm = 0.5759, lr_0 = 2.6846e-04
Validation rmse = 0.286288
Epoch 32
Loss = 2.8672e-01, PNorm = 34.6140, GNorm = 1.1622, lr_0 = 2.5420e-04
Validation rmse = 0.309793
Epoch 33
Loss = 2.5481e-01, PNorm = 34.6231, GNorm = 0.6312, lr_0 = 2.4069e-04
Validation rmse = 0.294835
Epoch 34
Loss = 2.7929e-01, PNorm = 34.6317, GNorm = 1.4205, lr_0 = 2.2791e-04
Validation rmse = 0.312186
Epoch 35
Validation rmse = 0.326236
Epoch 36
Loss = 2.8319e-01, PNorm = 34.6402, GNorm = 2.3514, lr_0 = 2.1473e-04
Validation rmse = 0.333318
Epoch 37
Loss = 2.7160e-01, PNorm = 34.6489, GNorm = 1.3625, lr_0 = 2.0332e-04
Validation rmse = 0.301927
Epoch 38
Loss = 2.4810e-01, PNorm = 34.6573, GNorm = 2.8562, lr_0 = 1.9252e-04
Validation rmse = 0.303706
Epoch 39
Loss = 2.7865e-01, PNorm = 34.6653, GNorm = 2.2474, lr_0 = 1.8230e-04
Validation rmse = 0.310225
Epoch 40
Validation rmse = 0.309744
Epoch 41
Loss = 2.9905e-01, PNorm = 34.6726, GNorm = 1.7434, lr_0 = 1.7176e-04
Validation rmse = 0.310500
Epoch 42
Loss = 2.3773e-01, PNorm = 34.6802, GNorm = 1.9244, lr_0 = 1.6263e-04
Validation rmse = 0.313336
Epoch 43
Loss = 2.8773e-01, PNorm = 34.6863, GNorm = 0.9558, lr_0 = 1.5399e-04
Validation rmse = 0.300355
Epoch 44
Loss = 2.7791e-01, PNorm = 34.6936, GNorm = 0.7203, lr_0 = 1.4581e-04
Validation rmse = 0.293919
Epoch 45
Validation rmse = 0.302349
Epoch 46
Loss = 2.6430e-01, PNorm = 34.7019, GNorm = 2.8962, lr_0 = 1.3738e-04
Validation rmse = 0.313777
Epoch 47
Loss = 2.4187e-01, PNorm = 34.7076, GNorm = 1.2019, lr_0 = 1.3008e-04
Validation rmse = 0.326330
Epoch 48
Loss = 2.8769e-01, PNorm = 34.7119, GNorm = 3.4528, lr_0 = 1.2317e-04
Validation rmse = 0.315968
Epoch 49
Loss = 2.5644e-01, PNorm = 34.7171, GNorm = 3.7191, lr_0 = 1.1663e-04
Validation rmse = 0.314596
Epoch 50
Loss = 2.6623e-01, PNorm = 34.7211, GNorm = 0.9706, lr_0 = 1.1098e-04
Loss = 3.4984e-01, PNorm = 34.7216, GNorm = 12.0818, lr_0 = 1.1043e-04
Validation rmse = 0.325020
Epoch 51
Validation rmse = 0.294741
Epoch 52
Loss = 1.9657e-01, PNorm = 34.7268, GNorm = 0.8200, lr_0 = 1.0457e-04
Validation rmse = 0.326017
Epoch 53
Loss = 2.4392e-01, PNorm = 34.7310, GNorm = 3.0531, lr_0 = 1.0000e-04
Validation rmse = 0.306284
Epoch 54
Loss = 2.7777e-01, PNorm = 34.7351, GNorm = 4.1134, lr_0 = 1.0000e-04
Validation rmse = 0.288114
Epoch 55
Loss = 2.4608e-01, PNorm = 34.7396, GNorm = 2.4052, lr_0 = 1.0000e-04
Loss = 5.2442e-01, PNorm = 34.7399, GNorm = 14.9398, lr_0 = 1.0000e-04
Validation rmse = 0.328888
Epoch 56
Validation rmse = 0.314743
Epoch 57
Loss = 2.5668e-01, PNorm = 34.7444, GNorm = 2.2307, lr_0 = 1.0000e-04
Validation rmse = 0.300565
Epoch 58
Loss = 2.6196e-01, PNorm = 34.7490, GNorm = 0.6482, lr_0 = 1.0000e-04
Validation rmse = 0.332200
Epoch 59
Loss = 2.5053e-01, PNorm = 34.7530, GNorm = 2.1895, lr_0 = 1.0000e-04
Validation rmse = 0.308019
Model 0 best validation rmse = 0.271196 on epoch 14
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.071595
Ensemble test rmse = 0.071595
1-fold cross validation
	Seed 0 ==> test rmse = 0.071595
Overall test rmse = 0.071595 +/- 0.000000
Elapsed time = 0:00:17
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 402 | train size = 397 | val size = 2 | test size = 3
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.172739
Epoch 1
Loss = 7.5441e-01, PNorm = 34.0310, GNorm = 3.7375, lr_0 = 8.7143e-04
Validation rmse = 0.203096
Epoch 2
Loss = 5.2780e-01, PNorm = 34.0792, GNorm = 1.5577, lr_0 = 9.5564e-04
Validation rmse = 0.198614
Epoch 3
Loss = 4.3487e-01, PNorm = 34.1360, GNorm = 5.3603, lr_0 = 9.0295e-04
Validation rmse = 0.272415
Epoch 4
Validation rmse = 0.199067
Epoch 5
Loss = 3.5434e-01, PNorm = 34.1806, GNorm = 7.8647, lr_0 = 8.5317e-04
Validation rmse = 0.157826
Epoch 6
Loss = 4.3095e-01, PNorm = 34.2116, GNorm = 0.8568, lr_0 = 8.0613e-04
Validation rmse = 0.147371
Epoch 7
Loss = 4.2003e-01, PNorm = 34.2384, GNorm = 2.0166, lr_0 = 7.6168e-04
Validation rmse = 0.186106
Epoch 8
Loss = 3.4042e-01, PNorm = 34.2687, GNorm = 2.3244, lr_0 = 7.1969e-04
Validation rmse = 0.184848
Epoch 9
Validation rmse = 0.158768
Epoch 10
Loss = 4.9862e-01, PNorm = 34.2932, GNorm = 9.5679, lr_0 = 6.8001e-04
Validation rmse = 0.189219
Epoch 11
Loss = 3.9237e-01, PNorm = 34.3183, GNorm = 5.4094, lr_0 = 6.4251e-04
Validation rmse = 0.173410
Epoch 12
Loss = 3.2002e-01, PNorm = 34.3420, GNorm = 3.2325, lr_0 = 6.0709e-04
Validation rmse = 0.149178
Epoch 13
Loss = 3.0541e-01, PNorm = 34.3641, GNorm = 3.5338, lr_0 = 5.7362e-04
Validation rmse = 0.169968
Epoch 14
Validation rmse = 0.160984
Epoch 15
Loss = 3.4259e-01, PNorm = 34.3836, GNorm = 0.5062, lr_0 = 5.4199e-04
Validation rmse = 0.173767
Epoch 16
Loss = 2.7400e-01, PNorm = 34.4042, GNorm = 0.6596, lr_0 = 5.1211e-04
Validation rmse = 0.162796
Epoch 17
Loss = 2.7787e-01, PNorm = 34.4264, GNorm = 1.9661, lr_0 = 4.8113e-04
Validation rmse = 0.160794
Epoch 18
Loss = 2.6115e-01, PNorm = 34.4464, GNorm = 4.7476, lr_0 = 4.5461e-04
Validation rmse = 0.197999
Epoch 19
Validation rmse = 0.184555
Epoch 20
Loss = 2.7765e-01, PNorm = 34.4665, GNorm = 7.5512, lr_0 = 4.2954e-04
Validation rmse = 0.130768
Epoch 21
Loss = 2.7850e-01, PNorm = 34.4837, GNorm = 6.3837, lr_0 = 4.0586e-04
Validation rmse = 0.133041
Epoch 22
Loss = 2.6866e-01, PNorm = 34.5027, GNorm = 6.0734, lr_0 = 3.8348e-04
Validation rmse = 0.163300
Epoch 23
Loss = 2.7673e-01, PNorm = 34.5211, GNorm = 4.9226, lr_0 = 3.6234e-04
Validation rmse = 0.225526
Epoch 24
Validation rmse = 0.193938
Epoch 25
Loss = 2.4950e-01, PNorm = 34.5404, GNorm = 2.3107, lr_0 = 3.4236e-04
Validation rmse = 0.158506
Epoch 26
Loss = 2.5197e-01, PNorm = 34.5560, GNorm = 1.5435, lr_0 = 3.2348e-04
Validation rmse = 0.205058
Epoch 27
Loss = 2.1648e-01, PNorm = 34.5728, GNorm = 1.0127, lr_0 = 3.0565e-04
Validation rmse = 0.143263
Epoch 28
Loss = 2.4269e-01, PNorm = 34.5877, GNorm = 3.6212, lr_0 = 2.8880e-04
Validation rmse = 0.164519
Epoch 29
Validation rmse = 0.146501
Epoch 30
Loss = 1.7809e-01, PNorm = 34.6035, GNorm = 0.5056, lr_0 = 2.7287e-04
Validation rmse = 0.175207
Epoch 31
Loss = 2.1115e-01, PNorm = 34.6183, GNorm = 0.7783, lr_0 = 2.5783e-04
Validation rmse = 0.167914
Epoch 32
Loss = 2.2223e-01, PNorm = 34.6325, GNorm = 1.2652, lr_0 = 2.4361e-04
Validation rmse = 0.164466
Epoch 33
Validation rmse = 0.124368
Epoch 34
Loss = 1.6506e-01, PNorm = 34.6481, GNorm = 1.3040, lr_0 = 2.2888e-04
Validation rmse = 0.191592
Epoch 35
Loss = 2.4872e-01, PNorm = 34.6611, GNorm = 2.1423, lr_0 = 2.1626e-04
Validation rmse = 0.168087
Epoch 36
Loss = 2.1711e-01, PNorm = 34.6741, GNorm = 4.4404, lr_0 = 2.0434e-04
Validation rmse = 0.144710
Epoch 37
Loss = 2.2371e-01, PNorm = 34.6866, GNorm = 2.2430, lr_0 = 1.9307e-04
Validation rmse = 0.143392
Epoch 38
Validation rmse = 0.150851
Epoch 39
Loss = 2.8713e-01, PNorm = 34.6979, GNorm = 3.7619, lr_0 = 1.8242e-04
Validation rmse = 0.142893
Epoch 40
Loss = 2.1507e-01, PNorm = 34.7082, GNorm = 1.7365, lr_0 = 1.7237e-04
Validation rmse = 0.154743
Epoch 41
Loss = 2.1351e-01, PNorm = 34.7190, GNorm = 3.1933, lr_0 = 1.6286e-04
Validation rmse = 0.187671
Epoch 42
Loss = 2.1259e-01, PNorm = 34.7288, GNorm = 0.9719, lr_0 = 1.5388e-04
Validation rmse = 0.133664
Epoch 43
Validation rmse = 0.173032
Epoch 44
Loss = 2.3451e-01, PNorm = 34.7384, GNorm = 2.8900, lr_0 = 1.4540e-04
Validation rmse = 0.151816
Epoch 45
Loss = 1.9103e-01, PNorm = 34.7476, GNorm = 0.7965, lr_0 = 1.3738e-04
Validation rmse = 0.165688
Epoch 46
Loss = 1.8719e-01, PNorm = 34.7562, GNorm = 4.0635, lr_0 = 1.2981e-04
Validation rmse = 0.168691
Epoch 47
Loss = 2.0924e-01, PNorm = 34.7646, GNorm = 1.3235, lr_0 = 1.2265e-04
Validation rmse = 0.141519
Epoch 48
Validation rmse = 0.176346
Epoch 49
Loss = 1.7509e-01, PNorm = 34.7726, GNorm = 1.3587, lr_0 = 1.1589e-04
Validation rmse = 0.137996
Epoch 50
Loss = 1.7252e-01, PNorm = 34.7797, GNorm = 4.0010, lr_0 = 1.0950e-04
Validation rmse = 0.181160
Epoch 51
Loss = 2.0559e-01, PNorm = 34.7871, GNorm = 1.1777, lr_0 = 1.0288e-04
Validation rmse = 0.139143
Epoch 52
Loss = 1.9689e-01, PNorm = 34.7940, GNorm = 1.8448, lr_0 = 1.0000e-04
Validation rmse = 0.161272
Epoch 53
Validation rmse = 0.147891
Epoch 54
Loss = 2.0217e-01, PNorm = 34.8010, GNorm = 1.7825, lr_0 = 1.0000e-04
Validation rmse = 0.165967
Epoch 55
Loss = 1.9109e-01, PNorm = 34.8077, GNorm = 2.1962, lr_0 = 1.0000e-04
Validation rmse = 0.138064
Epoch 56
Loss = 2.0420e-01, PNorm = 34.8147, GNorm = 0.6226, lr_0 = 1.0000e-04
Validation rmse = 0.161054
Epoch 57
Loss = 1.9232e-01, PNorm = 34.8215, GNorm = 1.0910, lr_0 = 1.0000e-04
Validation rmse = 0.148415
Epoch 58
Validation rmse = 0.149961
Epoch 59
Loss = 2.1225e-01, PNorm = 34.8287, GNorm = 3.2242, lr_0 = 1.0000e-04
Validation rmse = 0.151781
Model 0 best validation rmse = 0.124368 on epoch 33
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.052863
Ensemble test rmse = 0.052863
1-fold cross validation
	Seed 0 ==> test rmse = 0.052863
Overall test rmse = 0.052863 +/- 0.000000
Elapsed time = 0:00:16
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 397 | train size = 393 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.261848
Epoch 1
Loss = 6.5918e-01, PNorm = 34.0262, GNorm = 2.2361, lr_0 = 8.7143e-04
Validation rmse = 0.246323
Epoch 2
Loss = 6.0654e-01, PNorm = 34.0666, GNorm = 2.4267, lr_0 = 9.5564e-04
Validation rmse = 0.238788
Epoch 3
Loss = 4.7777e-01, PNorm = 34.1233, GNorm = 2.3456, lr_0 = 9.0295e-04
Validation rmse = 0.242216
Epoch 4
Validation rmse = 0.265244
Epoch 5
Loss = 3.7986e-01, PNorm = 34.1779, GNorm = 3.6436, lr_0 = 8.5317e-04
Validation rmse = 0.236101
Epoch 6
Loss = 3.3841e-01, PNorm = 34.2168, GNorm = 6.5248, lr_0 = 8.0613e-04
Validation rmse = 0.207508
Epoch 7
Loss = 3.3334e-01, PNorm = 34.2481, GNorm = 3.4561, lr_0 = 7.6168e-04
Validation rmse = 0.217220
Epoch 8
Loss = 2.8147e-01, PNorm = 34.2831, GNorm = 5.8459, lr_0 = 7.1562e-04
Validation rmse = 0.230486
Epoch 9
Validation rmse = 0.218384
Epoch 10
Loss = 2.3015e-01, PNorm = 34.3072, GNorm = 1.2749, lr_0 = 6.7616e-04
Validation rmse = 0.211390
Epoch 11
Loss = 2.4722e-01, PNorm = 34.3279, GNorm = 2.4113, lr_0 = 6.3888e-04
Validation rmse = 0.206995
Epoch 12
Loss = 2.5728e-01, PNorm = 34.3509, GNorm = 1.2120, lr_0 = 6.0365e-04
Validation rmse = 0.181957
Epoch 13
Loss = 2.4676e-01, PNorm = 34.3700, GNorm = 2.0422, lr_0 = 5.7037e-04
Validation rmse = 0.159692
Epoch 14
Validation rmse = 0.204494
Epoch 15
Loss = 2.1894e-01, PNorm = 34.3910, GNorm = 4.6042, lr_0 = 5.3588e-04
Validation rmse = 0.218139
Epoch 16
Loss = 2.7281e-01, PNorm = 34.4095, GNorm = 7.3500, lr_0 = 5.0633e-04
Validation rmse = 0.250910
Epoch 17
Loss = 2.3748e-01, PNorm = 34.4264, GNorm = 3.4063, lr_0 = 4.7841e-04
Validation rmse = 0.180240
Epoch 18
Validation rmse = 0.200126
Epoch 19
Loss = 1.5559e-01, PNorm = 34.4451, GNorm = 0.7557, lr_0 = 4.5204e-04
Validation rmse = 0.192898
Epoch 20
Loss = 2.5969e-01, PNorm = 34.4633, GNorm = 5.6180, lr_0 = 4.2711e-04
Validation rmse = 0.196359
Epoch 21
Loss = 2.0951e-01, PNorm = 34.4825, GNorm = 1.8384, lr_0 = 4.0356e-04
Validation rmse = 0.182693
Epoch 22
Loss = 2.0880e-01, PNorm = 34.5000, GNorm = 2.8149, lr_0 = 3.7916e-04
Validation rmse = 0.169488
Epoch 23
Validation rmse = 0.154661
Epoch 24
Loss = 2.0073e-01, PNorm = 34.5137, GNorm = 4.4169, lr_0 = 3.5825e-04
Validation rmse = 0.157454
Epoch 25
Loss = 2.2780e-01, PNorm = 34.5285, GNorm = 5.5549, lr_0 = 3.3850e-04
Validation rmse = 0.165020
Epoch 26
Loss = 1.9245e-01, PNorm = 34.5412, GNorm = 0.8037, lr_0 = 3.1984e-04
Validation rmse = 0.163026
Epoch 27
Loss = 2.0239e-01, PNorm = 34.5563, GNorm = 1.3008, lr_0 = 3.0220e-04
Validation rmse = 0.164153
Epoch 28
Validation rmse = 0.199340
Epoch 29
Loss = 1.9952e-01, PNorm = 34.5710, GNorm = 3.7357, lr_0 = 2.8392e-04
Validation rmse = 0.199680
Epoch 30
Loss = 1.7100e-01, PNorm = 34.5830, GNorm = 2.6301, lr_0 = 2.6827e-04
Validation rmse = 0.205913
Epoch 31
Loss = 2.3481e-01, PNorm = 34.5940, GNorm = 7.9309, lr_0 = 2.5348e-04
Validation rmse = 0.205439
Epoch 32
Validation rmse = 0.150396
Epoch 33
Loss = 2.7383e-01, PNorm = 34.6049, GNorm = 4.1267, lr_0 = 2.3950e-04
Validation rmse = 0.171011
Epoch 34
Loss = 2.1757e-01, PNorm = 34.6159, GNorm = 8.0987, lr_0 = 2.2630e-04
Validation rmse = 0.208953
Epoch 35
Loss = 1.9147e-01, PNorm = 34.6260, GNorm = 1.0744, lr_0 = 2.1382e-04
Validation rmse = 0.165316
Epoch 36
Loss = 1.8760e-01, PNorm = 34.6361, GNorm = 2.6202, lr_0 = 2.0089e-04
Validation rmse = 0.171978
Epoch 37
Validation rmse = 0.191394
Epoch 38
Loss = 1.8211e-01, PNorm = 34.6454, GNorm = 2.9056, lr_0 = 1.8981e-04
Validation rmse = 0.171254
Epoch 39
Loss = 1.4696e-01, PNorm = 34.6538, GNorm = 0.6790, lr_0 = 1.7935e-04
Validation rmse = 0.174375
Epoch 40
Loss = 1.7819e-01, PNorm = 34.6617, GNorm = 0.8090, lr_0 = 1.6946e-04
Validation rmse = 0.182502
Epoch 41
Loss = 1.7689e-01, PNorm = 34.6695, GNorm = 2.0777, lr_0 = 1.6012e-04
Validation rmse = 0.162841
Epoch 42
Validation rmse = 0.172604
Epoch 43
Loss = 1.5948e-01, PNorm = 34.6773, GNorm = 4.0737, lr_0 = 1.5043e-04
Validation rmse = 0.165218
Epoch 44
Loss = 1.7966e-01, PNorm = 34.6844, GNorm = 1.6544, lr_0 = 1.4214e-04
Validation rmse = 0.178523
Epoch 45
Loss = 1.7796e-01, PNorm = 34.6912, GNorm = 4.0943, lr_0 = 1.3430e-04
Validation rmse = 0.179432
Epoch 46
Validation rmse = 0.160636
Epoch 47
Loss = 1.1259e-01, PNorm = 34.6978, GNorm = 1.6743, lr_0 = 1.2690e-04
Validation rmse = 0.183367
Epoch 48
Loss = 1.7643e-01, PNorm = 34.7043, GNorm = 1.9390, lr_0 = 1.1990e-04
Validation rmse = 0.154809
Epoch 49
Loss = 1.9657e-01, PNorm = 34.7104, GNorm = 1.5806, lr_0 = 1.1329e-04
Validation rmse = 0.180924
Epoch 50
Loss = 1.5968e-01, PNorm = 34.7160, GNorm = 1.1915, lr_0 = 1.0704e-04
Loss = 2.7571e-01, PNorm = 34.7165, GNorm = 4.8362, lr_0 = 1.0644e-04
Validation rmse = 0.159118
Epoch 51
Validation rmse = 0.174463
Epoch 52
Loss = 1.7488e-01, PNorm = 34.7216, GNorm = 2.1695, lr_0 = 1.0057e-04
Validation rmse = 0.158169
Epoch 53
Loss = 1.7221e-01, PNorm = 34.7269, GNorm = 3.1597, lr_0 = 1.0000e-04
Validation rmse = 0.182688
Epoch 54
Loss = 1.5874e-01, PNorm = 34.7319, GNorm = 1.0959, lr_0 = 1.0000e-04
Validation rmse = 0.155238
Epoch 55
Loss = 1.6930e-01, PNorm = 34.7375, GNorm = 0.8457, lr_0 = 1.0000e-04
Validation rmse = 0.170016
Epoch 56
Validation rmse = 0.157634
Epoch 57
Loss = 2.0076e-01, PNorm = 34.7428, GNorm = 3.2496, lr_0 = 1.0000e-04
Validation rmse = 0.172060
Epoch 58
Loss = 1.5492e-01, PNorm = 34.7487, GNorm = 0.6290, lr_0 = 1.0000e-04
Validation rmse = 0.167213
Epoch 59
Loss = 1.6854e-01, PNorm = 34.7543, GNorm = 3.8509, lr_0 = 1.0000e-04
Validation rmse = 0.184137
Model 0 best validation rmse = 0.150396 on epoch 32
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.083201
Ensemble test rmse = 0.083201
1-fold cross validation
	Seed 0 ==> test rmse = 0.083201
Overall test rmse = 0.083201 +/- 0.000000
Elapsed time = 0:00:17
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 392 | train size = 388 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.015071
Epoch 1
Loss = 9.8735e-01, PNorm = 34.0267, GNorm = 8.8687, lr_0 = 8.7143e-04
Validation rmse = 0.010426
Epoch 2
Loss = 6.8553e-01, PNorm = 34.0661, GNorm = 3.6034, lr_0 = 9.5564e-04
Validation rmse = 0.123987
Epoch 3
Loss = 4.7965e-01, PNorm = 34.1257, GNorm = 0.9667, lr_0 = 9.0295e-04
Validation rmse = 0.180729
Epoch 4
Validation rmse = 0.169307
Epoch 5
Loss = 3.5001e-01, PNorm = 34.1895, GNorm = 0.8743, lr_0 = 8.4834e-04
Validation rmse = 0.196188
Epoch 6
Loss = 3.1863e-01, PNorm = 34.2297, GNorm = 4.5237, lr_0 = 8.0157e-04
Validation rmse = 0.238093
Epoch 7
Loss = 2.9734e-01, PNorm = 34.2609, GNorm = 3.4890, lr_0 = 7.5737e-04
Validation rmse = 0.263452
Epoch 8
Validation rmse = 0.204728
Epoch 9
Loss = 2.2327e-01, PNorm = 34.2899, GNorm = 0.9712, lr_0 = 7.1157e-04
Validation rmse = 0.271519
Epoch 10
Loss = 3.4705e-01, PNorm = 34.3157, GNorm = 6.8366, lr_0 = 6.7234e-04
Validation rmse = 0.218099
Epoch 11
Loss = 2.1665e-01, PNorm = 34.3386, GNorm = 0.8257, lr_0 = 6.3527e-04
Validation rmse = 0.211771
Epoch 12
Loss = 2.2689e-01, PNorm = 34.3594, GNorm = 1.4502, lr_0 = 6.0024e-04
Loss = 2.3003e-01, PNorm = 34.3619, GNorm = 1.8451, lr_0 = 5.9685e-04
Validation rmse = 0.218978
Epoch 13
Validation rmse = 0.220921
Epoch 14
Loss = 1.8802e-01, PNorm = 34.3829, GNorm = 1.6417, lr_0 = 5.6394e-04
Validation rmse = 0.264284
Epoch 15
Loss = 2.2846e-01, PNorm = 34.4024, GNorm = 4.3278, lr_0 = 5.3285e-04
Validation rmse = 0.254739
Epoch 16
Loss = 2.2253e-01, PNorm = 34.4203, GNorm = 2.4713, lr_0 = 5.0347e-04
Validation rmse = 0.231479
Epoch 17
Validation rmse = 0.196952
Epoch 18
Loss = 2.2603e-01, PNorm = 34.4397, GNorm = 4.2042, lr_0 = 4.7302e-04
Validation rmse = 0.205470
Epoch 19
Loss = 2.5531e-01, PNorm = 34.4566, GNorm = 2.9619, lr_0 = 4.4694e-04
Validation rmse = 0.217438
Epoch 20
Loss = 1.9386e-01, PNorm = 34.4741, GNorm = 1.9980, lr_0 = 4.2229e-04
Validation rmse = 0.240735
Epoch 21
Loss = 1.8877e-01, PNorm = 34.4920, GNorm = 0.7351, lr_0 = 3.9675e-04
Validation rmse = 0.235271
Epoch 22
Validation rmse = 0.212120
Epoch 23
Loss = 1.5031e-01, PNorm = 34.5066, GNorm = 1.0093, lr_0 = 3.7488e-04
Validation rmse = 0.224591
Epoch 24
Loss = 1.9616e-01, PNorm = 34.5207, GNorm = 2.6432, lr_0 = 3.5421e-04
Validation rmse = 0.220320
Epoch 25
Loss = 1.9392e-01, PNorm = 34.5335, GNorm = 2.3838, lr_0 = 3.3468e-04
Validation rmse = 0.215752
Epoch 26
Validation rmse = 0.219427
Epoch 27
Loss = 1.1591e-01, PNorm = 34.5483, GNorm = 1.5649, lr_0 = 3.1444e-04
Validation rmse = 0.246437
Epoch 28
Loss = 1.6825e-01, PNorm = 34.5605, GNorm = 1.0833, lr_0 = 2.9710e-04
Validation rmse = 0.248270
Epoch 29
Loss = 1.9987e-01, PNorm = 34.5721, GNorm = 5.2089, lr_0 = 2.8072e-04
Validation rmse = 0.233543
Epoch 30
Loss = 1.7778e-01, PNorm = 34.5854, GNorm = 3.1734, lr_0 = 2.6374e-04
Validation rmse = 0.237625
Epoch 31
Validation rmse = 0.223473
Epoch 32
Loss = 1.4394e-01, PNorm = 34.5965, GNorm = 0.9686, lr_0 = 2.4920e-04
Validation rmse = 0.219592
Epoch 33
Loss = 1.7135e-01, PNorm = 34.6070, GNorm = 0.7966, lr_0 = 2.3546e-04
Validation rmse = 0.226222
Epoch 34
Loss = 1.5853e-01, PNorm = 34.6183, GNorm = 1.3730, lr_0 = 2.2122e-04
Validation rmse = 0.230111
Epoch 35
Validation rmse = 0.227319
Epoch 36
Loss = 1.5130e-01, PNorm = 34.6279, GNorm = 1.1226, lr_0 = 2.0902e-04
Validation rmse = 0.204867
Epoch 37
Loss = 1.5306e-01, PNorm = 34.6366, GNorm = 2.2314, lr_0 = 1.9750e-04
Validation rmse = 0.228613
Epoch 38
Loss = 1.6001e-01, PNorm = 34.6464, GNorm = 1.1063, lr_0 = 1.8556e-04
Validation rmse = 0.223578
Epoch 39
Loss = 1.5917e-01, PNorm = 34.6558, GNorm = 0.6016, lr_0 = 1.7532e-04
Validation rmse = 0.217162
Epoch 40
Validation rmse = 0.235656
Epoch 41
Loss = 1.6862e-01, PNorm = 34.6632, GNorm = 1.1246, lr_0 = 1.6566e-04
Validation rmse = 0.210039
Epoch 42
Loss = 1.6704e-01, PNorm = 34.6715, GNorm = 3.1325, lr_0 = 1.5564e-04
Validation rmse = 0.214494
Epoch 43
Loss = 1.5361e-01, PNorm = 34.6784, GNorm = 2.0878, lr_0 = 1.4706e-04
Validation rmse = 0.215552
Epoch 44
Validation rmse = 0.225119
Epoch 45
Loss = 1.5504e-01, PNorm = 34.6858, GNorm = 1.3084, lr_0 = 1.3895e-04
Validation rmse = 0.215476
Epoch 46
Loss = 1.6968e-01, PNorm = 34.6930, GNorm = 0.6615, lr_0 = 1.3055e-04
Validation rmse = 0.219051
Epoch 47
Loss = 1.6400e-01, PNorm = 34.6995, GNorm = 0.5588, lr_0 = 1.2335e-04
Validation rmse = 0.232533
Epoch 48
Loss = 1.5436e-01, PNorm = 34.7054, GNorm = 2.2008, lr_0 = 1.1655e-04
Validation rmse = 0.218069
Epoch 49
Validation rmse = 0.213345
Epoch 50
Loss = 1.4961e-01, PNorm = 34.7110, GNorm = 3.0483, lr_0 = 1.1012e-04
Validation rmse = 0.221784
Epoch 51
Loss = 1.6480e-01, PNorm = 34.7167, GNorm = 1.7469, lr_0 = 1.0346e-04
Validation rmse = 0.213029
Epoch 52
Loss = 1.4755e-01, PNorm = 34.7217, GNorm = 2.5664, lr_0 = 1.0000e-04
Validation rmse = 0.226287
Epoch 53
Validation rmse = 0.219169
Epoch 54
Loss = 1.4578e-01, PNorm = 34.7266, GNorm = 0.4713, lr_0 = 1.0000e-04
Validation rmse = 0.213266
Epoch 55
Loss = 1.4758e-01, PNorm = 34.7322, GNorm = 0.6695, lr_0 = 1.0000e-04
Validation rmse = 0.213389
Epoch 56
Loss = 1.4300e-01, PNorm = 34.7372, GNorm = 1.4340, lr_0 = 1.0000e-04
Validation rmse = 0.218699
Epoch 57
Loss = 1.4526e-01, PNorm = 34.7421, GNorm = 3.3562, lr_0 = 1.0000e-04
Validation rmse = 0.215207
Epoch 58
Validation rmse = 0.206290
Epoch 59
Loss = 1.4473e-01, PNorm = 34.7478, GNorm = 2.0988, lr_0 = 1.0000e-04
Validation rmse = 0.217386
Model 0 best validation rmse = 0.010426 on epoch 1
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.011383
Ensemble test rmse = 0.011383
1-fold cross validation
	Seed 0 ==> test rmse = 0.011383
Overall test rmse = 0.011383 +/- 0.000000
Elapsed time = 0:00:16
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 417 | train size = 412 | val size = 2 | test size = 3
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.302486
Epoch 1
Loss = 6.9448e-01, PNorm = 34.0263, GNorm = 10.4726, lr_0 = 7.7500e-04
Validation rmse = 0.266605
Epoch 2
Loss = 5.7531e-01, PNorm = 34.0727, GNorm = 4.6743, lr_0 = 9.6586e-04
Validation rmse = 0.473141
Epoch 3
Loss = 5.9972e-01, PNorm = 34.1238, GNorm = 9.6162, lr_0 = 9.1455e-04
Validation rmse = 0.291439
Epoch 4
Loss = 4.9815e-01, PNorm = 34.1690, GNorm = 4.9659, lr_0 = 8.6596e-04
Validation rmse = 0.431240
Epoch 5
Validation rmse = 0.417590
Epoch 6
Loss = 5.9024e-01, PNorm = 34.2046, GNorm = 5.9036, lr_0 = 8.1996e-04
Validation rmse = 0.437419
Epoch 7
Loss = 4.6378e-01, PNorm = 34.2423, GNorm = 5.1006, lr_0 = 7.7640e-04
Validation rmse = 0.435246
Epoch 8
Loss = 4.1967e-01, PNorm = 34.2760, GNorm = 2.6444, lr_0 = 7.3516e-04
Validation rmse = 0.381931
Epoch 9
Loss = 4.6479e-01, PNorm = 34.3013, GNorm = 4.1168, lr_0 = 6.9956e-04
Validation rmse = 0.383374
Epoch 10
Loss = 3.8110e-01, PNorm = 34.3348, GNorm = 2.7143, lr_0 = 6.6240e-04
Loss = 2.8046e-01, PNorm = 34.3365, GNorm = 3.1968, lr_0 = 6.5912e-04
Validation rmse = 0.329067
Epoch 11
Validation rmse = 0.332437
Epoch 12
Loss = 4.4516e-01, PNorm = 34.3603, GNorm = 5.4448, lr_0 = 6.2411e-04
Validation rmse = 0.379623
Epoch 13
Loss = 5.2515e-01, PNorm = 34.3842, GNorm = 10.4184, lr_0 = 5.9389e-04
Validation rmse = 0.443932
Epoch 14
Loss = 3.9676e-01, PNorm = 34.4105, GNorm = 3.8746, lr_0 = 5.6234e-04
Validation rmse = 0.439670
Epoch 15
Loss = 3.7469e-01, PNorm = 34.4383, GNorm = 6.7635, lr_0 = 5.3247e-04
Validation rmse = 0.410594
Epoch 16
Loss = 3.4447e-01, PNorm = 34.4573, GNorm = 4.3078, lr_0 = 5.0418e-04
Validation rmse = 0.427848
Epoch 17
Validation rmse = 0.419135
Epoch 18
Loss = 3.6308e-01, PNorm = 34.4768, GNorm = 2.5166, lr_0 = 4.7740e-04
Validation rmse = 0.392225
Epoch 19
Loss = 3.4006e-01, PNorm = 34.4958, GNorm = 1.5772, lr_0 = 4.5204e-04
Validation rmse = 0.357487
Epoch 20
Loss = 3.6585e-01, PNorm = 34.5139, GNorm = 2.4784, lr_0 = 4.2802e-04
Validation rmse = 0.443725
Epoch 21
Loss = 3.2784e-01, PNorm = 34.5323, GNorm = 1.6920, lr_0 = 4.0730e-04
Validation rmse = 0.457531
Epoch 22
Validation rmse = 0.405626
Epoch 23
Loss = 2.8558e-01, PNorm = 34.5514, GNorm = 0.7230, lr_0 = 3.8375e-04
Validation rmse = 0.450078
Epoch 24
Loss = 3.2111e-01, PNorm = 34.5681, GNorm = 2.5665, lr_0 = 3.6337e-04
Validation rmse = 0.434334
Epoch 25
Loss = 3.0158e-01, PNorm = 34.5824, GNorm = 3.1724, lr_0 = 3.4577e-04
Validation rmse = 0.425760
Epoch 26
Loss = 3.1256e-01, PNorm = 34.5989, GNorm = 2.2217, lr_0 = 3.2741e-04
Validation rmse = 0.482665
Epoch 27
Loss = 3.1856e-01, PNorm = 34.6166, GNorm = 0.9283, lr_0 = 3.1001e-04
Loss = 2.1840e-01, PNorm = 34.6182, GNorm = 3.6299, lr_0 = 3.0848e-04
Validation rmse = 0.439920
Epoch 28
Validation rmse = 0.413941
Epoch 29
Loss = 2.9189e-01, PNorm = 34.6363, GNorm = 1.5028, lr_0 = 2.9209e-04
Validation rmse = 0.346736
Epoch 30
Loss = 3.2112e-01, PNorm = 34.6526, GNorm = 7.1901, lr_0 = 2.7795e-04
Validation rmse = 0.483795
Epoch 31
Loss = 3.5004e-01, PNorm = 34.6696, GNorm = 4.6804, lr_0 = 2.6318e-04
Validation rmse = 0.456573
Epoch 32
Loss = 2.8349e-01, PNorm = 34.6831, GNorm = 1.8319, lr_0 = 2.4920e-04
Validation rmse = 0.459336
Epoch 33
Loss = 3.1871e-01, PNorm = 34.6945, GNorm = 3.1620, lr_0 = 2.3596e-04
Validation rmse = 0.412250
Epoch 34
Validation rmse = 0.444259
Epoch 35
Loss = 2.6588e-01, PNorm = 34.7057, GNorm = 1.0501, lr_0 = 2.2343e-04
Validation rmse = 0.475568
Epoch 36
Loss = 2.4732e-01, PNorm = 34.7166, GNorm = 4.2877, lr_0 = 2.1156e-04
Validation rmse = 0.413993
Epoch 37
Loss = 2.6596e-01, PNorm = 34.7272, GNorm = 2.8984, lr_0 = 2.0032e-04
Validation rmse = 0.465699
Epoch 38
Loss = 2.7528e-01, PNorm = 34.7379, GNorm = 0.7953, lr_0 = 1.9062e-04
Validation rmse = 0.423127
Epoch 39
Validation rmse = 0.453163
Epoch 40
Loss = 2.3167e-01, PNorm = 34.7487, GNorm = 2.1665, lr_0 = 1.7960e-04
Validation rmse = 0.448148
Epoch 41
Loss = 2.0320e-01, PNorm = 34.7584, GNorm = 2.5075, lr_0 = 1.7006e-04
Validation rmse = 0.459819
Epoch 42
Loss = 2.9399e-01, PNorm = 34.7681, GNorm = 1.0555, lr_0 = 1.6183e-04
Validation rmse = 0.437052
Epoch 43
Loss = 2.8095e-01, PNorm = 34.7784, GNorm = 1.1029, lr_0 = 1.5323e-04
Validation rmse = 0.456699
Epoch 44
Loss = 2.6635e-01, PNorm = 34.7877, GNorm = 2.8978, lr_0 = 1.4509e-04
Loss = 4.4949e-01, PNorm = 34.7886, GNorm = 6.1410, lr_0 = 1.4437e-04
Validation rmse = 0.430560
Epoch 45
Validation rmse = 0.417094
Epoch 46
Loss = 1.9039e-01, PNorm = 34.7974, GNorm = 2.6303, lr_0 = 1.3738e-04
Validation rmse = 0.449943
Epoch 47
Loss = 2.6222e-01, PNorm = 34.8060, GNorm = 1.0387, lr_0 = 1.3008e-04
Validation rmse = 0.433880
Epoch 48
Loss = 2.7325e-01, PNorm = 34.8144, GNorm = 1.5022, lr_0 = 1.2317e-04
Validation rmse = 0.449938
Epoch 49
Loss = 2.5209e-01, PNorm = 34.8221, GNorm = 1.0571, lr_0 = 1.1663e-04
Validation rmse = 0.444704
Epoch 50
Loss = 2.6156e-01, PNorm = 34.8287, GNorm = 1.1436, lr_0 = 1.1098e-04
Loss = 4.5553e-02, PNorm = 34.8293, GNorm = 1.2218, lr_0 = 1.1043e-04
Validation rmse = 0.438572
Epoch 51
Validation rmse = 0.447500
Epoch 52
Loss = 2.9905e-01, PNorm = 34.8363, GNorm = 1.5337, lr_0 = 1.0457e-04
Validation rmse = 0.434863
Epoch 53
Loss = 3.0791e-01, PNorm = 34.8429, GNorm = 1.7909, lr_0 = 1.0000e-04
Validation rmse = 0.443784
Epoch 54
Loss = 2.1788e-01, PNorm = 34.8500, GNorm = 3.1364, lr_0 = 1.0000e-04
Validation rmse = 0.437748
Epoch 55
Loss = 2.4886e-01, PNorm = 34.8553, GNorm = 1.5269, lr_0 = 1.0000e-04
Validation rmse = 0.443838
Epoch 56
Validation rmse = 0.427054
Epoch 57
Loss = 2.8851e-01, PNorm = 34.8637, GNorm = 4.7756, lr_0 = 1.0000e-04
Validation rmse = 0.448635
Epoch 58
Loss = 2.1855e-01, PNorm = 34.8712, GNorm = 1.7299, lr_0 = 1.0000e-04
Validation rmse = 0.447411
Epoch 59
Loss = 1.9498e-01, PNorm = 34.8777, GNorm = 1.1700, lr_0 = 1.0000e-04
Validation rmse = 0.444653
Model 0 best validation rmse = 0.266605 on epoch 1
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.331675
Ensemble test rmse = 0.331675
1-fold cross validation
	Seed 0 ==> test rmse = 0.331675
Overall test rmse = 0.331675 +/- 0.000000
Elapsed time = 0:00:17
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 407 | train size = 402 | val size = 2 | test size = 3
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.300737
Epoch 1
Loss = 9.5515e-01, PNorm = 34.0211, GNorm = 12.3902, lr_0 = 7.7500e-04
Validation rmse = 0.286716
Epoch 2
Loss = 7.5289e-01, PNorm = 34.0577, GNorm = 5.3146, lr_0 = 9.6586e-04
Validation rmse = 0.283811
Epoch 3
Loss = 5.5421e-01, PNorm = 34.1137, GNorm = 7.2237, lr_0 = 9.1455e-04
Validation rmse = 0.280674
Epoch 4
Loss = 4.7877e-01, PNorm = 34.1658, GNorm = 5.7937, lr_0 = 8.6596e-04
Loss = 1.2524e-01, PNorm = 34.1693, GNorm = 6.6604, lr_0 = 8.6168e-04
Validation rmse = 0.300272
Epoch 5
Validation rmse = 0.356516
Epoch 6
Loss = 5.2875e-01, PNorm = 34.2046, GNorm = 1.0466, lr_0 = 8.1590e-04
Validation rmse = 0.282012
Epoch 7
Loss = 4.4710e-01, PNorm = 34.2332, GNorm = 4.7462, lr_0 = 7.7256e-04
Validation rmse = 0.312349
Epoch 8
Loss = 4.0799e-01, PNorm = 34.2621, GNorm = 3.1984, lr_0 = 7.3152e-04
Validation rmse = 0.258762
Epoch 9
Loss = 3.7514e-01, PNorm = 34.2877, GNorm = 0.7271, lr_0 = 6.9266e-04
Loss = 2.3711e-02, PNorm = 34.2899, GNorm = 3.5800, lr_0 = 6.8923e-04
Validation rmse = 0.299758
Epoch 10
Validation rmse = 0.397795
Epoch 11
Loss = 9.2932e-01, PNorm = 34.3099, GNorm = 20.8806, lr_0 = 6.5261e-04
Validation rmse = 0.246385
Epoch 12
Loss = 4.7608e-01, PNorm = 34.3262, GNorm = 3.6986, lr_0 = 6.1794e-04
Validation rmse = 0.266371
Epoch 13
Loss = 4.4968e-01, PNorm = 34.3532, GNorm = 1.9349, lr_0 = 5.8512e-04
Validation rmse = 0.316533
Epoch 14
Loss = 3.7787e-01, PNorm = 34.3760, GNorm = 2.8204, lr_0 = 5.5403e-04
Loss = 8.1053e-01, PNorm = 34.3778, GNorm = 18.8340, lr_0 = 5.5129e-04
Validation rmse = 0.311822
Epoch 15
Validation rmse = 0.243609
Epoch 16
Loss = 5.6385e-01, PNorm = 34.3990, GNorm = 5.1883, lr_0 = 5.2200e-04
Validation rmse = 0.325253
Epoch 17
Loss = 3.8356e-01, PNorm = 34.4203, GNorm = 3.3988, lr_0 = 4.9427e-04
Validation rmse = 0.298491
Epoch 18
Loss = 3.0361e-01, PNorm = 34.4386, GNorm = 2.1630, lr_0 = 4.6801e-04
Validation rmse = 0.309005
Epoch 19
Loss = 3.4723e-01, PNorm = 34.4504, GNorm = 1.0295, lr_0 = 4.4315e-04
Loss = 1.8030e-01, PNorm = 34.4517, GNorm = 7.1120, lr_0 = 4.4096e-04
Validation rmse = 0.281003
Epoch 20
Validation rmse = 0.336171
Epoch 21
Loss = 3.4187e-01, PNorm = 34.4670, GNorm = 0.9538, lr_0 = 4.1753e-04
Validation rmse = 0.265699
Epoch 22
Loss = 2.9522e-01, PNorm = 34.4837, GNorm = 5.0493, lr_0 = 3.9535e-04
Validation rmse = 0.311777
Epoch 23
Loss = 3.3955e-01, PNorm = 34.4953, GNorm = 2.1181, lr_0 = 3.7435e-04
Validation rmse = 0.290802
Epoch 24
Loss = 3.3372e-01, PNorm = 34.5078, GNorm = 0.7890, lr_0 = 3.5446e-04
Validation rmse = 0.338588
Epoch 25
Validation rmse = 0.305967
Epoch 26
Loss = 4.0689e-01, PNorm = 34.5207, GNorm = 1.6996, lr_0 = 3.3563e-04
Validation rmse = 0.319350
Epoch 27
Loss = 3.4641e-01, PNorm = 34.5327, GNorm = 0.7001, lr_0 = 3.1780e-04
Validation rmse = 0.307522
Epoch 28
Loss = 2.8768e-01, PNorm = 34.5430, GNorm = 0.5940, lr_0 = 3.0092e-04
Validation rmse = 0.307030
Epoch 29
Loss = 3.1631e-01, PNorm = 34.5544, GNorm = 1.5410, lr_0 = 2.8493e-04
Validation rmse = 0.294176
Epoch 30
Validation rmse = 0.320320
Epoch 31
Loss = 3.3299e-01, PNorm = 34.5675, GNorm = 3.2557, lr_0 = 2.6846e-04
Validation rmse = 0.305247
Epoch 32
Loss = 3.2438e-01, PNorm = 34.5790, GNorm = 1.2046, lr_0 = 2.5420e-04
Validation rmse = 0.319927
Epoch 33
Loss = 2.8307e-01, PNorm = 34.5881, GNorm = 0.7506, lr_0 = 2.4069e-04
Validation rmse = 0.310048
Epoch 34
Loss = 3.0378e-01, PNorm = 34.5974, GNorm = 1.7488, lr_0 = 2.2791e-04
Validation rmse = 0.318221
Epoch 35
Validation rmse = 0.311492
Epoch 36
Loss = 2.9070e-01, PNorm = 34.6079, GNorm = 2.1850, lr_0 = 2.1473e-04
Validation rmse = 0.312996
Epoch 37
Loss = 3.1116e-01, PNorm = 34.6184, GNorm = 1.3227, lr_0 = 2.0332e-04
Validation rmse = 0.324558
Epoch 38
Loss = 2.5519e-01, PNorm = 34.6305, GNorm = 1.6569, lr_0 = 1.9252e-04
Validation rmse = 0.317193
Epoch 39
Loss = 3.0860e-01, PNorm = 34.6392, GNorm = 1.8564, lr_0 = 1.8230e-04
Validation rmse = 0.321618
Epoch 40
Validation rmse = 0.307567
Epoch 41
Loss = 2.1742e-01, PNorm = 34.6475, GNorm = 1.1169, lr_0 = 1.7176e-04
Validation rmse = 0.333745
Epoch 42
Loss = 3.1259e-01, PNorm = 34.6545, GNorm = 2.6417, lr_0 = 1.6263e-04
Validation rmse = 0.311028
Epoch 43
Loss = 2.6943e-01, PNorm = 34.6603, GNorm = 1.5534, lr_0 = 1.5399e-04
Validation rmse = 0.305461
Epoch 44
Loss = 2.9763e-01, PNorm = 34.6678, GNorm = 4.2169, lr_0 = 1.4581e-04
Validation rmse = 0.329417
Epoch 45
Validation rmse = 0.300187
Epoch 46
Loss = 3.3192e-01, PNorm = 34.6743, GNorm = 1.8532, lr_0 = 1.3738e-04
Validation rmse = 0.292729
Epoch 47
Loss = 2.8340e-01, PNorm = 34.6810, GNorm = 1.8052, lr_0 = 1.3008e-04
Validation rmse = 0.284775
Epoch 48
Loss = 2.8202e-01, PNorm = 34.6882, GNorm = 2.4411, lr_0 = 1.2317e-04
Validation rmse = 0.301939
Epoch 49
Loss = 2.9095e-01, PNorm = 34.6949, GNorm = 1.0201, lr_0 = 1.1663e-04
Validation rmse = 0.315577
Epoch 50
Loss = 2.8143e-01, PNorm = 34.6996, GNorm = 2.2386, lr_0 = 1.1098e-04
Loss = 5.5434e-01, PNorm = 34.6999, GNorm = 16.2659, lr_0 = 1.1043e-04
Validation rmse = 0.294528
Epoch 51
Validation rmse = 0.325797
Epoch 52
Loss = 2.1987e-01, PNorm = 34.7038, GNorm = 3.5804, lr_0 = 1.0457e-04
Validation rmse = 0.280890
Epoch 53
Loss = 2.9652e-01, PNorm = 34.7084, GNorm = 2.6889, lr_0 = 1.0000e-04
Validation rmse = 0.323403
Epoch 54
Loss = 3.0180e-01, PNorm = 34.7132, GNorm = 1.1206, lr_0 = 1.0000e-04
Validation rmse = 0.309446
Epoch 55
Loss = 2.7316e-01, PNorm = 34.7176, GNorm = 5.7035, lr_0 = 1.0000e-04
Loss = 3.4704e-01, PNorm = 34.7182, GNorm = 13.6155, lr_0 = 1.0000e-04
Validation rmse = 0.312303
Epoch 56
Validation rmse = 0.318344
Epoch 57
Loss = 2.5467e-01, PNorm = 34.7230, GNorm = 2.6227, lr_0 = 1.0000e-04
Validation rmse = 0.333206
Epoch 58
Loss = 3.0345e-01, PNorm = 34.7276, GNorm = 1.9546, lr_0 = 1.0000e-04
Validation rmse = 0.288284
Epoch 59
Loss = 2.8701e-01, PNorm = 34.7322, GNorm = 0.6190, lr_0 = 1.0000e-04
Validation rmse = 0.328689
Model 0 best validation rmse = 0.243609 on epoch 15
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.180466
Ensemble test rmse = 0.180466
1-fold cross validation
	Seed 0 ==> test rmse = 0.180466
Overall test rmse = 0.180466 +/- 0.000000
Elapsed time = 0:00:17
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 397 | train size = 393 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.237720
Epoch 1
Loss = 6.9061e-01, PNorm = 34.0293, GNorm = 1.4864, lr_0 = 8.7143e-04
Validation rmse = 0.150920
Epoch 2
Loss = 4.7492e-01, PNorm = 34.0864, GNorm = 11.7608, lr_0 = 9.5564e-04
Validation rmse = 0.224365
Epoch 3
Loss = 4.9086e-01, PNorm = 34.1318, GNorm = 6.1395, lr_0 = 9.0295e-04
Validation rmse = 0.130170
Epoch 4
Validation rmse = 0.157934
Epoch 5
Loss = 4.5307e-01, PNorm = 34.1733, GNorm = 8.3431, lr_0 = 8.5317e-04
Validation rmse = 0.115249
Epoch 6
Loss = 4.1919e-01, PNorm = 34.2056, GNorm = 1.5731, lr_0 = 8.0613e-04
Validation rmse = 0.150630
Epoch 7
Loss = 3.3782e-01, PNorm = 34.2344, GNorm = 1.0472, lr_0 = 7.6168e-04
Validation rmse = 0.180752
Epoch 8
Loss = 3.3270e-01, PNorm = 34.2669, GNorm = 2.7191, lr_0 = 7.1562e-04
Validation rmse = 0.163810
Epoch 9
Validation rmse = 0.114016
Epoch 10
Loss = 2.7570e-01, PNorm = 34.2917, GNorm = 5.3070, lr_0 = 6.7616e-04
Validation rmse = 0.147369
Epoch 11
Loss = 2.9327e-01, PNorm = 34.3166, GNorm = 8.1380, lr_0 = 6.3888e-04
Validation rmse = 0.165048
Epoch 12
Loss = 3.1697e-01, PNorm = 34.3390, GNorm = 5.0557, lr_0 = 6.0365e-04
Validation rmse = 0.175556
Epoch 13
Loss = 3.1011e-01, PNorm = 34.3631, GNorm = 7.3649, lr_0 = 5.7037e-04
Validation rmse = 0.192890
Epoch 14
Validation rmse = 0.147543
Epoch 15
Loss = 2.3230e-01, PNorm = 34.3875, GNorm = 1.0093, lr_0 = 5.3588e-04
Validation rmse = 0.126473
Epoch 16
Loss = 2.8930e-01, PNorm = 34.4098, GNorm = 3.2858, lr_0 = 5.0633e-04
Validation rmse = 0.147027
Epoch 17
Loss = 2.5451e-01, PNorm = 34.4307, GNorm = 1.5810, lr_0 = 4.7841e-04
Validation rmse = 0.150704
Epoch 18
Validation rmse = 0.217613
Epoch 19
Loss = 2.2004e-01, PNorm = 34.4505, GNorm = 5.0993, lr_0 = 4.5204e-04
Validation rmse = 0.209679
Epoch 20
Loss = 3.3202e-01, PNorm = 34.4679, GNorm = 3.3182, lr_0 = 4.2711e-04
Validation rmse = 0.166216
Epoch 21
Loss = 2.3768e-01, PNorm = 34.4879, GNorm = 1.0920, lr_0 = 4.0356e-04
Validation rmse = 0.150427
Epoch 22
Loss = 2.4468e-01, PNorm = 34.5081, GNorm = 1.6461, lr_0 = 3.7916e-04
Validation rmse = 0.124833
Epoch 23
Validation rmse = 0.144087
Epoch 24
Loss = 1.9358e-01, PNorm = 34.5250, GNorm = 2.9422, lr_0 = 3.5825e-04
Validation rmse = 0.146152
Epoch 25
Loss = 2.4708e-01, PNorm = 34.5406, GNorm = 4.2337, lr_0 = 3.3850e-04
Validation rmse = 0.149359
Epoch 26
Loss = 2.5180e-01, PNorm = 34.5567, GNorm = 6.4324, lr_0 = 3.1984e-04
Validation rmse = 0.107793
Epoch 27
Loss = 2.5132e-01, PNorm = 34.5720, GNorm = 1.9795, lr_0 = 3.0220e-04
Validation rmse = 0.134902
Epoch 28
Validation rmse = 0.166716
Epoch 29
Loss = 2.7640e-01, PNorm = 34.5893, GNorm = 3.1956, lr_0 = 2.8392e-04
Validation rmse = 0.164981
Epoch 30
Loss = 2.2128e-01, PNorm = 34.6044, GNorm = 4.4412, lr_0 = 2.6827e-04
Validation rmse = 0.143458
Epoch 31
Loss = 2.2348e-01, PNorm = 34.6186, GNorm = 1.8537, lr_0 = 2.5348e-04
Validation rmse = 0.142521
Epoch 32
Validation rmse = 0.130073
Epoch 33
Loss = 2.7797e-01, PNorm = 34.6327, GNorm = 0.8690, lr_0 = 2.3950e-04
Validation rmse = 0.154362
Epoch 34
Loss = 1.8738e-01, PNorm = 34.6462, GNorm = 1.0283, lr_0 = 2.2630e-04
Validation rmse = 0.160218
Epoch 35
Loss = 2.0398e-01, PNorm = 34.6574, GNorm = 1.1137, lr_0 = 2.1382e-04
Validation rmse = 0.129000
Epoch 36
Loss = 2.1738e-01, PNorm = 34.6706, GNorm = 1.9130, lr_0 = 2.0089e-04
Validation rmse = 0.116486
Epoch 37
Validation rmse = 0.138348
Epoch 38
Loss = 2.2253e-01, PNorm = 34.6816, GNorm = 2.5068, lr_0 = 1.8981e-04
Validation rmse = 0.154300
Epoch 39
Loss = 1.6851e-01, PNorm = 34.6925, GNorm = 0.8231, lr_0 = 1.7935e-04
Validation rmse = 0.123765
Epoch 40
Loss = 1.9706e-01, PNorm = 34.7030, GNorm = 2.5353, lr_0 = 1.6946e-04
Validation rmse = 0.145802
Epoch 41
Loss = 2.0247e-01, PNorm = 34.7132, GNorm = 1.2033, lr_0 = 1.6012e-04
Validation rmse = 0.136225
Epoch 42
Validation rmse = 0.128849
Epoch 43
Loss = 2.1993e-01, PNorm = 34.7241, GNorm = 1.4378, lr_0 = 1.5043e-04
Validation rmse = 0.136361
Epoch 44
Loss = 1.7513e-01, PNorm = 34.7332, GNorm = 1.6512, lr_0 = 1.4214e-04
Validation rmse = 0.144461
Epoch 45
Loss = 2.1380e-01, PNorm = 34.7420, GNorm = 7.1980, lr_0 = 1.3430e-04
Validation rmse = 0.129572
Epoch 46
Validation rmse = 0.126769
Epoch 47
Loss = 1.5270e-01, PNorm = 34.7504, GNorm = 2.1089, lr_0 = 1.2690e-04
Validation rmse = 0.142012
Epoch 48
Loss = 2.0506e-01, PNorm = 34.7586, GNorm = 1.0715, lr_0 = 1.1990e-04
Validation rmse = 0.133800
Epoch 49
Loss = 1.8444e-01, PNorm = 34.7664, GNorm = 0.7238, lr_0 = 1.1329e-04
Validation rmse = 0.139788
Epoch 50
Loss = 1.9168e-01, PNorm = 34.7735, GNorm = 5.3418, lr_0 = 1.0704e-04
Loss = 2.3254e-01, PNorm = 34.7742, GNorm = 3.7940, lr_0 = 1.0644e-04
Validation rmse = 0.132447
Epoch 51
Validation rmse = 0.130304
Epoch 52
Loss = 1.4834e-01, PNorm = 34.7813, GNorm = 1.1847, lr_0 = 1.0057e-04
Validation rmse = 0.147999
Epoch 53
Loss = 2.2447e-01, PNorm = 34.7876, GNorm = 2.6258, lr_0 = 1.0000e-04
Validation rmse = 0.116998
Epoch 54
Loss = 1.8934e-01, PNorm = 34.7943, GNorm = 2.3874, lr_0 = 1.0000e-04
Validation rmse = 0.145897
Epoch 55
Loss = 1.8919e-01, PNorm = 34.8009, GNorm = 1.9062, lr_0 = 1.0000e-04
Validation rmse = 0.124153
Epoch 56
Validation rmse = 0.136912
Epoch 57
Loss = 1.8578e-01, PNorm = 34.8077, GNorm = 2.7297, lr_0 = 1.0000e-04
Validation rmse = 0.137092
Epoch 58
Loss = 1.8664e-01, PNorm = 34.8151, GNorm = 0.9532, lr_0 = 1.0000e-04
Validation rmse = 0.129580
Epoch 59
Loss = 1.8799e-01, PNorm = 34.8221, GNorm = 2.0446, lr_0 = 1.0000e-04
Validation rmse = 0.145517
Model 0 best validation rmse = 0.107793 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.099190
Ensemble test rmse = 0.099190
1-fold cross validation
	Seed 0 ==> test rmse = 0.099190
Overall test rmse = 0.099190 +/- 0.000000
Elapsed time = 0:00:17
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 387 | train size = 383 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.226833
Epoch 1
Loss = 7.6242e-01, PNorm = 34.0274, GNorm = 4.2028, lr_0 = 8.7143e-04
Validation rmse = 0.134589
Epoch 2
Loss = 5.3062e-01, PNorm = 34.0805, GNorm = 1.6468, lr_0 = 9.5564e-04
Validation rmse = 0.282936
Epoch 3
Loss = 4.2130e-01, PNorm = 34.1364, GNorm = 6.4298, lr_0 = 8.9785e-04
Validation rmse = 0.235798
Epoch 4
Validation rmse = 0.252275
Epoch 5
Loss = 3.8485e-01, PNorm = 34.1824, GNorm = 1.4916, lr_0 = 8.4834e-04
Validation rmse = 0.202206
Epoch 6
Loss = 2.7965e-01, PNorm = 34.2236, GNorm = 1.4843, lr_0 = 7.9704e-04
Validation rmse = 0.238252
Epoch 7
Loss = 2.8097e-01, PNorm = 34.2501, GNorm = 2.6210, lr_0 = 7.5309e-04
Validation rmse = 0.122688
Epoch 8
Validation rmse = 0.259476
Epoch 9
Loss = 2.5917e-01, PNorm = 34.2790, GNorm = 3.2819, lr_0 = 7.0754e-04
Validation rmse = 0.223141
Epoch 10
Loss = 2.0787e-01, PNorm = 34.3031, GNorm = 4.2256, lr_0 = 6.6853e-04
Validation rmse = 0.149332
Epoch 11
Loss = 2.2106e-01, PNorm = 34.3264, GNorm = 1.5405, lr_0 = 6.3167e-04
Validation rmse = 0.161051
Epoch 12
Validation rmse = 0.171943
Epoch 13
Loss = 2.1140e-01, PNorm = 34.3512, GNorm = 0.8350, lr_0 = 5.9347e-04
Validation rmse = 0.166831
Epoch 14
Loss = 1.9194e-01, PNorm = 34.3726, GNorm = 2.3042, lr_0 = 5.6075e-04
Validation rmse = 0.167791
Epoch 15
Loss = 2.1322e-01, PNorm = 34.3947, GNorm = 6.0957, lr_0 = 5.2684e-04
Validation rmse = 0.124047
Epoch 16
Loss = 2.6968e-01, PNorm = 34.4118, GNorm = 4.7105, lr_0 = 4.9779e-04
Validation rmse = 0.121098
Epoch 17
Validation rmse = 0.166858
Epoch 18
Loss = 1.9701e-01, PNorm = 34.4332, GNorm = 1.8149, lr_0 = 4.6768e-04
Validation rmse = 0.191903
Epoch 19
Loss = 1.9413e-01, PNorm = 34.4503, GNorm = 1.0993, lr_0 = 4.4190e-04
Validation rmse = 0.182329
Epoch 20
Loss = 1.9452e-01, PNorm = 34.4661, GNorm = 0.8147, lr_0 = 4.1753e-04
Loss = 2.2747e-01, PNorm = 34.4674, GNorm = 1.7600, lr_0 = 4.1517e-04
Validation rmse = 0.205564
Epoch 21
Validation rmse = 0.192478
Epoch 22
Loss = 1.9838e-01, PNorm = 34.4827, GNorm = 1.7831, lr_0 = 3.9228e-04
Validation rmse = 0.161214
Epoch 23
Loss = 1.7942e-01, PNorm = 34.4958, GNorm = 6.2697, lr_0 = 3.7065e-04
Validation rmse = 0.127067
Epoch 24
Loss = 2.0330e-01, PNorm = 34.5133, GNorm = 3.2046, lr_0 = 3.4823e-04
Validation rmse = 0.139303
Epoch 25
Validation rmse = 0.181187
Epoch 26
Loss = 1.4517e-01, PNorm = 34.5277, GNorm = 1.0144, lr_0 = 3.2903e-04
Validation rmse = 0.177720
Epoch 27
Loss = 1.6881e-01, PNorm = 34.5417, GNorm = 1.4800, lr_0 = 3.0913e-04
Validation rmse = 0.162582
Epoch 28
Loss = 1.8304e-01, PNorm = 34.5544, GNorm = 1.3178, lr_0 = 2.9209e-04
Validation rmse = 0.178062
Epoch 29
Validation rmse = 0.179485
Epoch 30
Loss = 1.7135e-01, PNorm = 34.5686, GNorm = 0.8275, lr_0 = 2.7442e-04
Validation rmse = 0.195222
Epoch 31
Loss = 1.5586e-01, PNorm = 34.5800, GNorm = 2.6419, lr_0 = 2.5929e-04
Validation rmse = 0.186101
Epoch 32
Loss = 1.8860e-01, PNorm = 34.5922, GNorm = 2.0012, lr_0 = 2.4500e-04
Validation rmse = 0.187426
Epoch 33
Loss = 1.6754e-01, PNorm = 34.6048, GNorm = 1.5873, lr_0 = 2.3018e-04
Validation rmse = 0.204274
Epoch 34
Validation rmse = 0.190778
Epoch 35
Loss = 1.5795e-01, PNorm = 34.6157, GNorm = 4.1305, lr_0 = 2.1749e-04
Validation rmse = 0.128354
Epoch 36
Loss = 1.7231e-01, PNorm = 34.6265, GNorm = 3.1525, lr_0 = 2.0434e-04
Validation rmse = 0.167668
Epoch 37
Loss = 1.6031e-01, PNorm = 34.6364, GNorm = 1.7337, lr_0 = 1.9307e-04
Validation rmse = 0.180484
Epoch 38
Validation rmse = 0.170883
Epoch 39
Loss = 1.9358e-01, PNorm = 34.6466, GNorm = 5.5375, lr_0 = 1.8139e-04
Validation rmse = 0.147836
Epoch 40
Loss = 1.6981e-01, PNorm = 34.6554, GNorm = 3.1028, lr_0 = 1.7139e-04
Validation rmse = 0.164186
Epoch 41
Loss = 1.5567e-01, PNorm = 34.6644, GNorm = 0.8179, lr_0 = 1.6194e-04
Validation rmse = 0.183539
Epoch 42
Validation rmse = 0.156378
Epoch 43
Loss = 9.6243e-02, PNorm = 34.6732, GNorm = 0.7015, lr_0 = 1.5215e-04
Validation rmse = 0.168291
Epoch 44
Loss = 1.6016e-01, PNorm = 34.6808, GNorm = 1.0675, lr_0 = 1.4376e-04
Validation rmse = 0.176935
Epoch 45
Loss = 1.6377e-01, PNorm = 34.6885, GNorm = 2.5247, lr_0 = 1.3506e-04
Validation rmse = 0.156394
Epoch 46
Loss = 1.5528e-01, PNorm = 34.6960, GNorm = 2.3433, lr_0 = 1.2762e-04
Validation rmse = 0.174548
Epoch 47
Validation rmse = 0.176332
Epoch 48
Loss = 1.4457e-01, PNorm = 34.7030, GNorm = 1.9310, lr_0 = 1.1990e-04
Validation rmse = 0.155653
Epoch 49
Loss = 1.4861e-01, PNorm = 34.7097, GNorm = 0.9191, lr_0 = 1.1329e-04
Validation rmse = 0.163938
Epoch 50
Loss = 1.4594e-01, PNorm = 34.7157, GNorm = 4.0183, lr_0 = 1.0704e-04
Loss = 1.8719e-01, PNorm = 34.7163, GNorm = 1.1208, lr_0 = 1.0644e-04
Validation rmse = 0.157734
Epoch 51
Validation rmse = 0.197499
Epoch 52
Loss = 1.4837e-01, PNorm = 34.7222, GNorm = 3.6870, lr_0 = 1.0057e-04
Validation rmse = 0.145695
Epoch 53
Loss = 1.4634e-01, PNorm = 34.7282, GNorm = 4.2912, lr_0 = 1.0000e-04
Validation rmse = 0.162929
Epoch 54
Loss = 1.4435e-01, PNorm = 34.7336, GNorm = 0.6098, lr_0 = 1.0000e-04
Validation rmse = 0.162294
Epoch 55
Validation rmse = 0.162884
Epoch 56
Loss = 1.0852e-01, PNorm = 34.7399, GNorm = 1.0954, lr_0 = 1.0000e-04
Validation rmse = 0.152447
Epoch 57
Loss = 1.4867e-01, PNorm = 34.7451, GNorm = 0.8300, lr_0 = 1.0000e-04
Validation rmse = 0.179941
Epoch 58
Loss = 1.5219e-01, PNorm = 34.7511, GNorm = 1.9852, lr_0 = 1.0000e-04
Validation rmse = 0.143426
Epoch 59
Validation rmse = 0.172105
Model 0 best validation rmse = 0.121098 on epoch 16
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.144913
Ensemble test rmse = 0.144913
1-fold cross validation
	Seed 0 ==> test rmse = 0.144913
Overall test rmse = 0.144913 +/- 0.000000
Elapsed time = 0:00:16
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 377 | train size = 373 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.203807
Epoch 1
Loss = 6.2040e-01, PNorm = 34.0340, GNorm = 6.9927, lr_0 = 8.7143e-04
Validation rmse = 0.156814
Epoch 2
Loss = 5.0074e-01, PNorm = 34.0933, GNorm = 3.4183, lr_0 = 9.5024e-04
Validation rmse = 0.124410
Epoch 3
Validation rmse = 0.072649
Epoch 4
Loss = 5.1123e-01, PNorm = 34.1414, GNorm = 10.9947, lr_0 = 8.9277e-04
Validation rmse = 0.052047
Epoch 5
Loss = 4.8887e-01, PNorm = 34.1799, GNorm = 4.6684, lr_0 = 8.4355e-04
Validation rmse = 0.091726
Epoch 6
Loss = 3.5915e-01, PNorm = 34.2191, GNorm = 3.7601, lr_0 = 7.9253e-04
Validation rmse = 0.170289
Epoch 7
Validation rmse = 0.165342
Epoch 8
Loss = 2.4285e-01, PNorm = 34.2539, GNorm = 4.7284, lr_0 = 7.4460e-04
Validation rmse = 0.173221
Epoch 9
Loss = 2.0792e-01, PNorm = 34.2833, GNorm = 0.4869, lr_0 = 7.0354e-04
Validation rmse = 0.273164
Epoch 10
Loss = 3.1203e-01, PNorm = 34.3120, GNorm = 6.1401, lr_0 = 6.6099e-04
Validation rmse = 0.208034
Epoch 11
Validation rmse = 0.130112
Epoch 12
Loss = 1.7927e-01, PNorm = 34.3429, GNorm = 0.5303, lr_0 = 6.2102e-04
Validation rmse = 0.127877
Epoch 13
Loss = 2.0717e-01, PNorm = 34.3685, GNorm = 1.4318, lr_0 = 5.8346e-04
Validation rmse = 0.118780
Epoch 14
Loss = 1.9248e-01, PNorm = 34.3900, GNorm = 4.1450, lr_0 = 5.5129e-04
Validation rmse = 0.060895
Epoch 15
Validation rmse = 0.095307
Epoch 16
Loss = 2.1314e-01, PNorm = 34.4083, GNorm = 4.9195, lr_0 = 5.1795e-04
Validation rmse = 0.141282
Epoch 17
Loss = 2.1479e-01, PNorm = 34.4276, GNorm = 3.1088, lr_0 = 4.8662e-04
Validation rmse = 0.173319
Epoch 18
Loss = 1.6682e-01, PNorm = 34.4451, GNorm = 0.6673, lr_0 = 4.5979e-04
Validation rmse = 0.163979
Epoch 19
Validation rmse = 0.188827
Epoch 20
Loss = 1.8210e-01, PNorm = 34.4636, GNorm = 1.4717, lr_0 = 4.3198e-04
Validation rmse = 0.173356
Epoch 21
Loss = 1.8746e-01, PNorm = 34.4798, GNorm = 6.6221, lr_0 = 4.0586e-04
Validation rmse = 0.078119
Epoch 22
Loss = 1.8794e-01, PNorm = 34.4924, GNorm = 6.0480, lr_0 = 3.8348e-04
Validation rmse = 0.121496
Epoch 23
Validation rmse = 0.163118
Epoch 24
Loss = 2.2671e-01, PNorm = 34.5056, GNorm = 3.9220, lr_0 = 3.6029e-04
Validation rmse = 0.139652
Epoch 25
Loss = 1.7024e-01, PNorm = 34.5218, GNorm = 4.0630, lr_0 = 3.3850e-04
Validation rmse = 0.136204
Epoch 26
Loss = 1.6573e-01, PNorm = 34.5345, GNorm = 2.0138, lr_0 = 3.1803e-04
Validation rmse = 0.125725
Epoch 27
Validation rmse = 0.130324
Epoch 28
Loss = 1.7088e-01, PNorm = 34.5482, GNorm = 0.9702, lr_0 = 2.9879e-04
Validation rmse = 0.149131
Epoch 29
Loss = 1.4887e-01, PNorm = 34.5589, GNorm = 0.7922, lr_0 = 2.8232e-04
Validation rmse = 0.159645
Epoch 30
Loss = 1.4339e-01, PNorm = 34.5708, GNorm = 1.5125, lr_0 = 2.6524e-04
Validation rmse = 0.173628
Epoch 31
Validation rmse = 0.142159
Epoch 32
Loss = 1.1504e-01, PNorm = 34.5821, GNorm = 0.9061, lr_0 = 2.4920e-04
Validation rmse = 0.149538
Epoch 33
Loss = 1.4732e-01, PNorm = 34.5925, GNorm = 1.7559, lr_0 = 2.3546e-04
Validation rmse = 0.160449
Epoch 34
Loss = 1.4544e-01, PNorm = 34.6021, GNorm = 1.3645, lr_0 = 2.2122e-04
Validation rmse = 0.180031
Epoch 35
Validation rmse = 0.146766
Epoch 36
Loss = 1.6140e-01, PNorm = 34.6124, GNorm = 1.8680, lr_0 = 2.0784e-04
Validation rmse = 0.168245
Epoch 37
Loss = 1.4936e-01, PNorm = 34.6215, GNorm = 2.9436, lr_0 = 1.9638e-04
Validation rmse = 0.174327
Epoch 38
Loss = 1.3475e-01, PNorm = 34.6305, GNorm = 0.6924, lr_0 = 1.8451e-04
Loss = 1.6994e-01, PNorm = 34.6314, GNorm = 1.8315, lr_0 = 1.8346e-04
Validation rmse = 0.148634
Epoch 39
Validation rmse = 0.172082
Epoch 40
Loss = 9.6836e-02, PNorm = 34.6397, GNorm = 1.3987, lr_0 = 1.7335e-04
Validation rmse = 0.165476
Epoch 41
Loss = 1.3404e-01, PNorm = 34.6480, GNorm = 1.5186, lr_0 = 1.6286e-04
Validation rmse = 0.170170
Epoch 42
Loss = 1.3294e-01, PNorm = 34.6556, GNorm = 0.6604, lr_0 = 1.5388e-04
Loss = 1.2340e-01, PNorm = 34.6563, GNorm = 0.9902, lr_0 = 1.5301e-04
Validation rmse = 0.148278
Epoch 43
Validation rmse = 0.182945
Epoch 44
Loss = 1.3044e-01, PNorm = 34.6631, GNorm = 1.1427, lr_0 = 1.4458e-04
Validation rmse = 0.148255
Epoch 45
Loss = 1.3380e-01, PNorm = 34.6703, GNorm = 0.6402, lr_0 = 1.3583e-04
Validation rmse = 0.167023
Epoch 46
Loss = 1.2479e-01, PNorm = 34.6760, GNorm = 2.5298, lr_0 = 1.2834e-04
Loss = 2.4924e-01, PNorm = 34.6767, GNorm = 2.9664, lr_0 = 1.2762e-04
Validation rmse = 0.166624
Epoch 47
Validation rmse = 0.155844
Epoch 48
Loss = 1.4227e-01, PNorm = 34.6828, GNorm = 3.1470, lr_0 = 1.2058e-04
Validation rmse = 0.173459
Epoch 49
Loss = 1.3403e-01, PNorm = 34.6887, GNorm = 2.6577, lr_0 = 1.1329e-04
Validation rmse = 0.159482
Epoch 50
Loss = 1.2822e-01, PNorm = 34.6943, GNorm = 0.3842, lr_0 = 1.0704e-04
Loss = 7.2486e-02, PNorm = 34.6949, GNorm = 0.7926, lr_0 = 1.0644e-04
Validation rmse = 0.171987
Epoch 51
Validation rmse = 0.165081
Epoch 52
Loss = 1.2619e-01, PNorm = 34.7002, GNorm = 0.4710, lr_0 = 1.0000e-04
Validation rmse = 0.165180
Epoch 53
Loss = 1.3001e-01, PNorm = 34.7051, GNorm = 1.0367, lr_0 = 1.0000e-04
Validation rmse = 0.168707
Epoch 54
Loss = 1.2588e-01, PNorm = 34.7104, GNorm = 2.9409, lr_0 = 1.0000e-04
Validation rmse = 0.160542
Epoch 55
Validation rmse = 0.177785
Epoch 56
Loss = 1.1228e-01, PNorm = 34.7156, GNorm = 3.9553, lr_0 = 1.0000e-04
Validation rmse = 0.159735
Epoch 57
Loss = 1.2530e-01, PNorm = 34.7204, GNorm = 1.3395, lr_0 = 1.0000e-04
Validation rmse = 0.178919
Epoch 58
Loss = 1.1940e-01, PNorm = 34.7253, GNorm = 2.3053, lr_0 = 1.0000e-04
Validation rmse = 0.165362
Epoch 59
Validation rmse = 0.166400
Model 0 best validation rmse = 0.052047 on epoch 4
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.169968
Ensemble test rmse = 0.169968
1-fold cross validation
	Seed 0 ==> test rmse = 0.169968
Overall test rmse = 0.169968 +/- 0.000000
Elapsed time = 0:00:15
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 367 | train size = 363 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.259796
Epoch 1
Loss = 5.9578e-01, PNorm = 34.0347, GNorm = 9.0681, lr_0 = 8.7143e-04
Validation rmse = 0.104885
Epoch 2
Loss = 7.1171e-01, PNorm = 34.0891, GNorm = 14.8570, lr_0 = 9.5024e-04
Validation rmse = 0.240953
Epoch 3
Validation rmse = 0.256062
Epoch 4
Loss = 3.4635e-01, PNorm = 34.1341, GNorm = 1.8225, lr_0 = 8.9277e-04
Validation rmse = 0.248762
Epoch 5
Loss = 3.3332e-01, PNorm = 34.1700, GNorm = 4.1572, lr_0 = 8.3877e-04
Validation rmse = 0.149700
Epoch 6
Loss = 2.6816e-01, PNorm = 34.2084, GNorm = 1.5185, lr_0 = 7.8805e-04
Loss = 1.2942e-01, PNorm = 34.2119, GNorm = 0.7579, lr_0 = 7.8359e-04
Validation rmse = 0.139688
Epoch 7
Validation rmse = 0.107461
Epoch 8
Loss = 2.1337e-01, PNorm = 34.2405, GNorm = 3.7568, lr_0 = 7.4039e-04
Validation rmse = 0.109686
Epoch 9
Loss = 2.0272e-01, PNorm = 34.2629, GNorm = 1.6367, lr_0 = 6.9561e-04
Validation rmse = 0.179671
Epoch 10
Validation rmse = 0.160156
Epoch 11
Loss = 1.9167e-01, PNorm = 34.2861, GNorm = 0.9173, lr_0 = 6.4984e-04
Validation rmse = 0.172598
Epoch 12
Loss = 1.4811e-01, PNorm = 34.3035, GNorm = 0.7257, lr_0 = 6.1401e-04
Validation rmse = 0.151256
Epoch 13
Loss = 1.9303e-01, PNorm = 34.3191, GNorm = 4.8246, lr_0 = 5.7688e-04
Validation rmse = 0.134367
Epoch 14
Validation rmse = 0.155817
Epoch 15
Loss = 1.7892e-01, PNorm = 34.3335, GNorm = 2.2307, lr_0 = 5.3892e-04
Validation rmse = 0.159223
Epoch 16
Loss = 1.8029e-01, PNorm = 34.3460, GNorm = 4.2925, lr_0 = 5.0921e-04
Validation rmse = 0.143861
Epoch 17
Loss = 1.6546e-01, PNorm = 34.3584, GNorm = 2.4333, lr_0 = 4.7841e-04
Loss = 2.5245e-01, PNorm = 34.3599, GNorm = 1.5048, lr_0 = 4.7571e-04
Validation rmse = 0.133174
Epoch 18
Validation rmse = 0.098060
Epoch 19
Loss = 1.5079e-01, PNorm = 34.3736, GNorm = 1.9288, lr_0 = 4.4694e-04
Validation rmse = 0.101547
Epoch 20
Loss = 1.5484e-01, PNorm = 34.3843, GNorm = 0.7778, lr_0 = 4.2229e-04
Validation rmse = 0.139212
Epoch 21
Validation rmse = 0.138833
Epoch 22
Loss = 1.9247e-01, PNorm = 34.3958, GNorm = 0.7620, lr_0 = 3.9451e-04
Validation rmse = 0.107675
Epoch 23
Loss = 1.6718e-01, PNorm = 34.4069, GNorm = 3.3156, lr_0 = 3.7065e-04
Validation rmse = 0.087222
Epoch 24
Loss = 1.5363e-01, PNorm = 34.4166, GNorm = 2.2909, lr_0 = 3.5022e-04
Validation rmse = 0.082528
Epoch 25
Validation rmse = 0.107310
Epoch 26
Loss = 1.5224e-01, PNorm = 34.4288, GNorm = 2.3689, lr_0 = 3.2717e-04
Validation rmse = 0.159303
Epoch 27
Loss = 1.5949e-01, PNorm = 34.4382, GNorm = 4.4651, lr_0 = 3.0913e-04
Validation rmse = 0.171926
Epoch 28
Loss = 1.4876e-01, PNorm = 34.4467, GNorm = 5.7316, lr_0 = 2.9044e-04
Loss = 2.0980e-01, PNorm = 34.4475, GNorm = 5.8090, lr_0 = 2.8880e-04
Validation rmse = 0.140278
Epoch 29
Validation rmse = 0.084313
Epoch 30
Loss = 1.6537e-01, PNorm = 34.4573, GNorm = 4.0251, lr_0 = 2.7133e-04
Validation rmse = 0.091723
Epoch 31
Loss = 1.4246e-01, PNorm = 34.4663, GNorm = 1.5530, lr_0 = 2.5637e-04
Validation rmse = 0.147717
Epoch 32
Validation rmse = 0.133448
Epoch 33
Loss = 1.4576e-01, PNorm = 34.4741, GNorm = 0.7283, lr_0 = 2.3950e-04
Validation rmse = 0.093048
Epoch 34
Loss = 1.3980e-01, PNorm = 34.4819, GNorm = 1.7271, lr_0 = 2.2502e-04
Validation rmse = 0.143005
Epoch 35
Loss = 1.3356e-01, PNorm = 34.4895, GNorm = 3.1997, lr_0 = 2.1261e-04
Validation rmse = 0.150089
Epoch 36
Validation rmse = 0.099963
Epoch 37
Loss = 1.1769e-01, PNorm = 34.4969, GNorm = 1.5186, lr_0 = 1.9862e-04
Validation rmse = 0.102784
Epoch 38
Loss = 1.3566e-01, PNorm = 34.5034, GNorm = 3.4356, lr_0 = 1.8661e-04
Validation rmse = 0.149951
Epoch 39
Loss = 1.4160e-01, PNorm = 34.5091, GNorm = 4.9769, lr_0 = 1.7632e-04
Loss = 9.6081e-02, PNorm = 34.5096, GNorm = 3.1377, lr_0 = 1.7532e-04
Validation rmse = 0.098185
Epoch 40
Validation rmse = 0.106818
Epoch 41
Loss = 1.3157e-01, PNorm = 34.5153, GNorm = 2.5249, lr_0 = 1.6472e-04
Validation rmse = 0.135645
Epoch 42
Loss = 1.3024e-01, PNorm = 34.5202, GNorm = 1.7071, lr_0 = 1.5476e-04
Validation rmse = 0.096163
Epoch 43
Validation rmse = 0.138502
Epoch 44
Loss = 1.6870e-01, PNorm = 34.5258, GNorm = 4.0310, lr_0 = 1.4540e-04
Validation rmse = 0.113410
Epoch 45
Loss = 1.3557e-01, PNorm = 34.5306, GNorm = 2.0375, lr_0 = 1.3661e-04
Validation rmse = 0.109117
Epoch 46
Loss = 1.2555e-01, PNorm = 34.5357, GNorm = 0.8538, lr_0 = 1.2834e-04
Validation rmse = 0.118577
Epoch 47
Validation rmse = 0.123872
Epoch 48
Loss = 1.1626e-01, PNorm = 34.5401, GNorm = 2.6929, lr_0 = 1.2058e-04
Validation rmse = 0.098833
Epoch 49
Loss = 1.2401e-01, PNorm = 34.5445, GNorm = 1.3049, lr_0 = 1.1329e-04
Validation rmse = 0.126611
Epoch 50
Loss = 1.2277e-01, PNorm = 34.5479, GNorm = 0.8520, lr_0 = 1.0704e-04
Loss = 7.0802e-02, PNorm = 34.5482, GNorm = 1.5792, lr_0 = 1.0644e-04
Validation rmse = 0.105592
Epoch 51
Validation rmse = 0.127018
Epoch 52
Loss = 1.2462e-01, PNorm = 34.5524, GNorm = 1.8719, lr_0 = 1.0000e-04
Validation rmse = 0.109498
Epoch 53
Loss = 1.1913e-01, PNorm = 34.5561, GNorm = 0.8143, lr_0 = 1.0000e-04
Validation rmse = 0.124699
Epoch 54
Validation rmse = 0.113518
Epoch 55
Loss = 1.1139e-01, PNorm = 34.5594, GNorm = 0.6907, lr_0 = 1.0000e-04
Validation rmse = 0.111420
Epoch 56
Loss = 1.1036e-01, PNorm = 34.5631, GNorm = 0.5120, lr_0 = 1.0000e-04
Validation rmse = 0.131181
Epoch 57
Loss = 1.1655e-01, PNorm = 34.5668, GNorm = 0.6944, lr_0 = 1.0000e-04
Validation rmse = 0.102163
Epoch 58
Validation rmse = 0.121396
Epoch 59
Loss = 1.1040e-01, PNorm = 34.5714, GNorm = 0.7320, lr_0 = 1.0000e-04
Validation rmse = 0.103903
Model 0 best validation rmse = 0.082528 on epoch 24
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.039871
Ensemble test rmse = 0.039871
1-fold cross validation
	Seed 0 ==> test rmse = 0.039871
Overall test rmse = 0.039871 +/- 0.000000
Elapsed time = 0:00:16
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 357 | train size = 353 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.053042
Epoch 1
Loss = 6.0359e-01, PNorm = 34.0316, GNorm = 2.0837, lr_0 = 8.7143e-04
Validation rmse = 0.116111
Epoch 2
Loss = 4.2998e-01, PNorm = 34.1007, GNorm = 8.4274, lr_0 = 9.5024e-04
Validation rmse = 0.214031
Epoch 3
Validation rmse = 0.174633
Epoch 4
Loss = 2.7716e-01, PNorm = 34.1583, GNorm = 1.2436, lr_0 = 8.8772e-04
Validation rmse = 0.228732
Epoch 5
Loss = 2.3795e-01, PNorm = 34.1996, GNorm = 5.5299, lr_0 = 8.3403e-04
Validation rmse = 0.208952
Epoch 6
Validation rmse = 0.207817
Epoch 7
Loss = 1.7396e-01, PNorm = 34.2325, GNorm = 0.8242, lr_0 = 7.7916e-04
Validation rmse = 0.201470
Epoch 8
Loss = 1.9327e-01, PNorm = 34.2553, GNorm = 1.9683, lr_0 = 7.3204e-04
Validation rmse = 0.199837
Epoch 9
Loss = 1.8771e-01, PNorm = 34.2770, GNorm = 0.9041, lr_0 = 6.8776e-04
Loss = 2.8713e-01, PNorm = 34.2792, GNorm = 11.6705, lr_0 = 6.8387e-04
Validation rmse = 0.177843
Epoch 10
Validation rmse = 0.202774
Epoch 11
Loss = 2.9104e-01, PNorm = 34.2939, GNorm = 2.2684, lr_0 = 6.4251e-04
Validation rmse = 0.169616
Epoch 12
Loss = 2.0875e-01, PNorm = 34.3188, GNorm = 7.9694, lr_0 = 6.0365e-04
Validation rmse = 0.184759
Epoch 13
Validation rmse = 0.238059
Epoch 14
Loss = 1.9264e-01, PNorm = 34.3407, GNorm = 2.6727, lr_0 = 5.6394e-04
Validation rmse = 0.195975
Epoch 15
Loss = 1.5651e-01, PNorm = 34.3493, GNorm = 5.4027, lr_0 = 5.2983e-04
Validation rmse = 0.230694
Epoch 16
Loss = 2.1881e-01, PNorm = 34.3611, GNorm = 3.0726, lr_0 = 4.9779e-04
Validation rmse = 0.131530
Epoch 17
Validation rmse = 0.148777
Epoch 18
Loss = 1.9277e-01, PNorm = 34.3758, GNorm = 2.2872, lr_0 = 4.6768e-04
Validation rmse = 0.175343
Epoch 19
Loss = 1.6091e-01, PNorm = 34.3829, GNorm = 0.6971, lr_0 = 4.3940e-04
Validation rmse = 0.162392
Epoch 20
Validation rmse = 0.208675
Epoch 21
Loss = 1.5249e-01, PNorm = 34.3965, GNorm = 3.2799, lr_0 = 4.1049e-04
Validation rmse = 0.161961
Epoch 22
Loss = 1.3879e-01, PNorm = 34.4066, GNorm = 1.3299, lr_0 = 3.8566e-04
Validation rmse = 0.166537
Epoch 23
Validation rmse = 0.162888
Epoch 24
Loss = 1.2406e-01, PNorm = 34.4156, GNorm = 1.0693, lr_0 = 3.6029e-04
Validation rmse = 0.181691
Epoch 25
Loss = 1.2848e-01, PNorm = 34.4229, GNorm = 1.6506, lr_0 = 3.3850e-04
Validation rmse = 0.171981
Epoch 26
Loss = 1.3769e-01, PNorm = 34.4289, GNorm = 0.8378, lr_0 = 3.1803e-04
Loss = 6.6007e-02, PNorm = 34.4295, GNorm = 3.1647, lr_0 = 3.1623e-04
Validation rmse = 0.148663
Epoch 27
Validation rmse = 0.155786
Epoch 28
Loss = 1.5778e-01, PNorm = 34.4346, GNorm = 5.3294, lr_0 = 2.9710e-04
Validation rmse = 0.176221
Epoch 29
Loss = 1.4075e-01, PNorm = 34.4395, GNorm = 1.6543, lr_0 = 2.7913e-04
Validation rmse = 0.139625
Epoch 30
Validation rmse = 0.171000
Epoch 31
Loss = 1.2215e-01, PNorm = 34.4470, GNorm = 1.0812, lr_0 = 2.6077e-04
Validation rmse = 0.151851
Epoch 32
Loss = 1.2494e-01, PNorm = 34.4516, GNorm = 0.6032, lr_0 = 2.4500e-04
Validation rmse = 0.163341
Epoch 33
Loss = 1.1222e-01, PNorm = 34.4571, GNorm = 5.8208, lr_0 = 2.3018e-04
Validation rmse = 0.166530
Epoch 34
Validation rmse = 0.179608
Epoch 35
Loss = 1.0613e-01, PNorm = 34.4636, GNorm = 0.7615, lr_0 = 2.1626e-04
Validation rmse = 0.163871
Epoch 36
Loss = 1.1422e-01, PNorm = 34.4695, GNorm = 0.6555, lr_0 = 2.0318e-04
Validation rmse = 0.173881
Epoch 37
Validation rmse = 0.148081
Epoch 38
Loss = 9.7568e-02, PNorm = 34.4733, GNorm = 1.4033, lr_0 = 1.8981e-04
Validation rmse = 0.172151
Epoch 39
Loss = 1.3856e-01, PNorm = 34.4773, GNorm = 0.9530, lr_0 = 1.7833e-04
Validation rmse = 0.122962
Epoch 40
Validation rmse = 0.147443
Epoch 41
Loss = 1.3220e-01, PNorm = 34.4825, GNorm = 1.2965, lr_0 = 1.6660e-04
Validation rmse = 0.132980
Epoch 42
Loss = 1.1487e-01, PNorm = 34.4863, GNorm = 2.2943, lr_0 = 1.5652e-04
Validation rmse = 0.140299
Epoch 43
Loss = 1.1061e-01, PNorm = 34.4910, GNorm = 1.1748, lr_0 = 1.4706e-04
Loss = 5.6856e-02, PNorm = 34.4913, GNorm = 4.6661, lr_0 = 1.4623e-04
Validation rmse = 0.154743
Epoch 44
Validation rmse = 0.135666
Epoch 45
Loss = 1.4697e-01, PNorm = 34.4938, GNorm = 3.8155, lr_0 = 1.3738e-04
Validation rmse = 0.162634
Epoch 46
Loss = 1.1547e-01, PNorm = 34.4961, GNorm = 2.3254, lr_0 = 1.2907e-04
Validation rmse = 0.125063
Epoch 47
Validation rmse = 0.164178
Epoch 48
Loss = 1.1586e-01, PNorm = 34.4994, GNorm = 3.7027, lr_0 = 1.2058e-04
Validation rmse = 0.141497
Epoch 49
Loss = 1.2801e-01, PNorm = 34.5031, GNorm = 3.0245, lr_0 = 1.1329e-04
Validation rmse = 0.161317
Epoch 50
Loss = 1.0751e-01, PNorm = 34.5056, GNorm = 0.7113, lr_0 = 1.0704e-04
Loss = 2.5860e-01, PNorm = 34.5059, GNorm = 6.5865, lr_0 = 1.0644e-04
Validation rmse = 0.152936
Epoch 51
Validation rmse = 0.142409
Epoch 52
Loss = 1.1528e-01, PNorm = 34.5083, GNorm = 0.9968, lr_0 = 1.0000e-04
Validation rmse = 0.139876
Epoch 53
Loss = 1.0730e-01, PNorm = 34.5113, GNorm = 1.1041, lr_0 = 1.0000e-04
Validation rmse = 0.149740
Epoch 54
Validation rmse = 0.151735
Epoch 55
Loss = 1.3118e-01, PNorm = 34.5151, GNorm = 1.3553, lr_0 = 1.0000e-04
Validation rmse = 0.142168
Epoch 56
Loss = 1.0241e-01, PNorm = 34.5181, GNorm = 0.7172, lr_0 = 1.0000e-04
Validation rmse = 0.133123
Epoch 57
Validation rmse = 0.132274
Epoch 58
Loss = 1.2077e-01, PNorm = 34.5212, GNorm = 1.7400, lr_0 = 1.0000e-04
Validation rmse = 0.145768
Epoch 59
Loss = 9.6241e-02, PNorm = 34.5239, GNorm = 0.5636, lr_0 = 1.0000e-04
Validation rmse = 0.130420
Model 0 best validation rmse = 0.053042 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.165204
Ensemble test rmse = 0.165204
1-fold cross validation
	Seed 0 ==> test rmse = 0.165204
Overall test rmse = 0.165204 +/- 0.000000
Elapsed time = 0:00:14
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 347 | train size = 343 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.303482
Epoch 1
Loss = 7.5522e-01, PNorm = 34.0333, GNorm = 7.3056, lr_0 = 1.0000e-03
Validation rmse = 0.190721
Epoch 2
Loss = 4.6811e-01, PNorm = 34.0915, GNorm = 5.6707, lr_0 = 9.3598e-04
Validation rmse = 0.119956
Epoch 3
Validation rmse = 0.163612
Epoch 4
Loss = 3.6630e-01, PNorm = 34.1477, GNorm = 8.5894, lr_0 = 8.7605e-04
Validation rmse = 0.097869
Epoch 5
Loss = 2.4615e-01, PNorm = 34.1903, GNorm = 4.8817, lr_0 = 8.1996e-04
Validation rmse = 0.118043
Epoch 6
Validation rmse = 0.151285
Epoch 7
Loss = 2.4673e-01, PNorm = 34.2198, GNorm = 2.3682, lr_0 = 7.6746e-04
Validation rmse = 0.063323
Epoch 8
Loss = 2.1790e-01, PNorm = 34.2494, GNorm = 1.5180, lr_0 = 7.1359e-04
Validation rmse = 0.067454
Epoch 9
Validation rmse = 0.055870
Epoch 10
Loss = 1.7768e-01, PNorm = 34.2748, GNorm = 0.9304, lr_0 = 6.6790e-04
Validation rmse = 0.066602
Epoch 11
Loss = 2.0110e-01, PNorm = 34.2951, GNorm = 1.2048, lr_0 = 6.2514e-04
Validation rmse = 0.063815
Epoch 12
Validation rmse = 0.045580
Epoch 13
Loss = 2.1991e-01, PNorm = 34.3144, GNorm = 4.4678, lr_0 = 5.8512e-04
Validation rmse = 0.075990
Epoch 14
Loss = 1.4656e-01, PNorm = 34.3319, GNorm = 2.2375, lr_0 = 5.4765e-04
Validation rmse = 0.048459
Epoch 15
Validation rmse = 0.054232
Epoch 16
Loss = 1.5302e-01, PNorm = 34.3479, GNorm = 3.0431, lr_0 = 5.0921e-04
Validation rmse = 0.069565
Epoch 17
Loss = 1.8438e-01, PNorm = 34.3624, GNorm = 8.5217, lr_0 = 4.7661e-04
Validation rmse = 0.073321
Epoch 18
Loss = 1.4073e-01, PNorm = 34.3767, GNorm = 1.7123, lr_0 = 4.4609e-04
Validation rmse = 0.048232
Epoch 19
Validation rmse = 0.047193
Epoch 20
Loss = 1.2295e-01, PNorm = 34.3900, GNorm = 0.7226, lr_0 = 4.1753e-04
Validation rmse = 0.043073
Epoch 21
Loss = 1.2628e-01, PNorm = 34.4026, GNorm = 1.0343, lr_0 = 3.9080e-04
Loss = 1.6406e-01, PNorm = 34.4035, GNorm = 1.4100, lr_0 = 3.8822e-04
Validation rmse = 0.036786
Epoch 22
Validation rmse = 0.042992
Epoch 23
Loss = 1.3209e-01, PNorm = 34.4148, GNorm = 0.9217, lr_0 = 3.6337e-04
Validation rmse = 0.035978
Epoch 24
Loss = 1.3331e-01, PNorm = 34.4247, GNorm = 5.1409, lr_0 = 3.4010e-04
Validation rmse = 0.040943
Epoch 25
Validation rmse = 0.049363
Epoch 26
Loss = 1.3668e-01, PNorm = 34.4359, GNorm = 1.8775, lr_0 = 3.1833e-04
Validation rmse = 0.041028
Epoch 27
Loss = 1.0716e-01, PNorm = 34.4453, GNorm = 1.7472, lr_0 = 2.9795e-04
Validation rmse = 0.038568
Epoch 28
Validation rmse = 0.036205
Epoch 29
Loss = 9.9485e-02, PNorm = 34.4556, GNorm = 3.2068, lr_0 = 2.7703e-04
Validation rmse = 0.043371
Epoch 30
Loss = 1.1161e-01, PNorm = 34.4643, GNorm = 1.5671, lr_0 = 2.5929e-04
Validation rmse = 0.039171
Epoch 31
Validation rmse = 0.044875
Epoch 32
Loss = 1.4959e-01, PNorm = 34.4720, GNorm = 4.1349, lr_0 = 2.4269e-04
Validation rmse = 0.038648
Epoch 33
Loss = 1.1095e-01, PNorm = 34.4801, GNorm = 0.4899, lr_0 = 2.2715e-04
Validation rmse = 0.039953
Epoch 34
Loss = 1.0495e-01, PNorm = 34.4868, GNorm = 1.1522, lr_0 = 2.1261e-04
Validation rmse = 0.043630
Epoch 35
Validation rmse = 0.045076
Epoch 36
Loss = 9.7686e-02, PNorm = 34.4946, GNorm = 0.5478, lr_0 = 1.9769e-04
Validation rmse = 0.036774
Epoch 37
Loss = 1.0350e-01, PNorm = 34.5011, GNorm = 0.6644, lr_0 = 1.8503e-04
Validation rmse = 0.038835
Epoch 38
Validation rmse = 0.035729
Epoch 39
Loss = 1.2143e-01, PNorm = 34.5068, GNorm = 2.5474, lr_0 = 1.7318e-04
Validation rmse = 0.036367
Epoch 40
Loss = 1.0525e-01, PNorm = 34.5124, GNorm = 0.6515, lr_0 = 1.6210e-04
Validation rmse = 0.040844
Epoch 41
Validation rmse = 0.038017
Epoch 42
Loss = 1.1834e-01, PNorm = 34.5180, GNorm = 2.6467, lr_0 = 1.5172e-04
Validation rmse = 0.040234
Epoch 43
Loss = 9.6884e-02, PNorm = 34.5239, GNorm = 2.5750, lr_0 = 1.4107e-04
Validation rmse = 0.036541
Epoch 44
Validation rmse = 0.037640
Epoch 45
Loss = 1.0553e-01, PNorm = 34.5284, GNorm = 2.3810, lr_0 = 1.3204e-04
Validation rmse = 0.042058
Epoch 46
Loss = 1.0840e-01, PNorm = 34.5333, GNorm = 1.8728, lr_0 = 1.2358e-04
Validation rmse = 0.036728
Epoch 47
Validation rmse = 0.033976
Epoch 48
Loss = 1.1708e-01, PNorm = 34.5376, GNorm = 2.7383, lr_0 = 1.1567e-04
Validation rmse = 0.037307
Epoch 49
Loss = 9.0883e-02, PNorm = 34.5416, GNorm = 0.5330, lr_0 = 1.0826e-04
Validation rmse = 0.036774
Epoch 50
Validation rmse = 0.039997
Epoch 51
Loss = 1.0087e-01, PNorm = 34.5460, GNorm = 0.8237, lr_0 = 1.0066e-04
Validation rmse = 0.036587
Epoch 52
Loss = 9.7352e-02, PNorm = 34.5495, GNorm = 1.0093, lr_0 = 1.0000e-04
Validation rmse = 0.037107
Epoch 53
Loss = 9.7365e-02, PNorm = 34.5531, GNorm = 3.6015, lr_0 = 1.0000e-04
Validation rmse = 0.037196
Epoch 54
Validation rmse = 0.036728
Epoch 55
Loss = 8.9411e-02, PNorm = 34.5569, GNorm = 2.0001, lr_0 = 1.0000e-04
Validation rmse = 0.037850
Epoch 56
Loss = 9.5344e-02, PNorm = 34.5606, GNorm = 2.4540, lr_0 = 1.0000e-04
Validation rmse = 0.037492
Epoch 57
Validation rmse = 0.038820
Epoch 58
Loss = 8.4343e-02, PNorm = 34.5651, GNorm = 4.4246, lr_0 = 1.0000e-04
Validation rmse = 0.036998
Epoch 59
Loss = 9.5651e-02, PNorm = 34.5686, GNorm = 0.7570, lr_0 = 1.0000e-04
Validation rmse = 0.041339
Model 0 best validation rmse = 0.033976 on epoch 47
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.008285
Ensemble test rmse = 0.008285
1-fold cross validation
	Seed 0 ==> test rmse = 0.008285
Overall test rmse = 0.008285 +/- 0.000000
Elapsed time = 0:00:15
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 337 | train size = 333 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.017713
Epoch 1
Loss = 7.0465e-01, PNorm = 34.0378, GNorm = 2.4527, lr_0 = 1.0000e-03
Validation rmse = 0.097652
Epoch 2
Validation rmse = 0.017158
Epoch 3
Loss = 3.4647e-01, PNorm = 34.1058, GNorm = 7.7446, lr_0 = 9.2980e-04
Validation rmse = 0.038551
Epoch 4
Loss = 2.6133e-01, PNorm = 34.1608, GNorm = 2.1319, lr_0 = 8.7027e-04
Validation rmse = 0.031468
Epoch 5
Validation rmse = 0.069770
Epoch 6
Loss = 2.4100e-01, PNorm = 34.2055, GNorm = 6.4683, lr_0 = 8.0918e-04
Validation rmse = 0.054200
Epoch 7
Loss = 1.7980e-01, PNorm = 34.2333, GNorm = 2.5862, lr_0 = 7.5737e-04
Validation rmse = 0.056025
Epoch 8
Validation rmse = 0.085015
Epoch 9
Loss = 1.2180e-01, PNorm = 34.2656, GNorm = 1.8910, lr_0 = 7.0421e-04
Validation rmse = 0.089257
Epoch 10
Loss = 1.4558e-01, PNorm = 34.2858, GNorm = 5.0961, lr_0 = 6.5912e-04
Validation rmse = 0.064460
Epoch 11
Validation rmse = 0.116836
Epoch 12
Loss = 2.2250e-01, PNorm = 34.3025, GNorm = 9.0357, lr_0 = 6.1285e-04
Validation rmse = 0.120024
Epoch 13
Loss = 1.6562e-01, PNorm = 34.3178, GNorm = 7.0767, lr_0 = 5.7362e-04
Validation rmse = 0.085061
Epoch 14
Validation rmse = 0.094985
Epoch 15
Loss = 1.7484e-01, PNorm = 34.3347, GNorm = 5.8662, lr_0 = 5.3335e-04
Validation rmse = 0.091123
Epoch 16
Loss = 1.4498e-01, PNorm = 34.3491, GNorm = 7.3151, lr_0 = 4.9920e-04
Validation rmse = 0.119332
Epoch 17
Validation rmse = 0.099160
Epoch 18
Loss = 1.1107e-01, PNorm = 34.3633, GNorm = 1.4214, lr_0 = 4.6416e-04
Validation rmse = 0.087836
Epoch 19
Loss = 1.1853e-01, PNorm = 34.3759, GNorm = 2.7006, lr_0 = 4.3444e-04
Validation rmse = 0.099450
Epoch 20
Validation rmse = 0.087372
Epoch 21
Loss = 9.0272e-02, PNorm = 34.3868, GNorm = 3.1885, lr_0 = 4.0394e-04
Validation rmse = 0.106907
Epoch 22
Loss = 1.0074e-01, PNorm = 34.3967, GNorm = 0.6169, lr_0 = 3.7808e-04
Validation rmse = 0.095530
Epoch 23
Validation rmse = 0.093920
Epoch 24
Loss = 6.9848e-02, PNorm = 34.4053, GNorm = 1.6115, lr_0 = 3.5154e-04
Validation rmse = 0.095713
Epoch 25
Loss = 1.0680e-01, PNorm = 34.4131, GNorm = 2.7598, lr_0 = 3.2903e-04
Validation rmse = 0.102909
Epoch 26
Validation rmse = 0.099140
Epoch 27
Loss = 1.1302e-01, PNorm = 34.4218, GNorm = 2.0495, lr_0 = 3.0594e-04
Validation rmse = 0.096116
Epoch 28
Loss = 8.6325e-02, PNorm = 34.4290, GNorm = 0.5873, lr_0 = 2.8635e-04
Validation rmse = 0.096453
Epoch 29
Validation rmse = 0.102503
Epoch 30
Loss = 1.0039e-01, PNorm = 34.4376, GNorm = 0.4979, lr_0 = 2.6625e-04
Validation rmse = 0.105934
Epoch 31
Loss = 9.6095e-02, PNorm = 34.4446, GNorm = 3.1099, lr_0 = 2.4920e-04
Validation rmse = 0.098114
Epoch 32
Validation rmse = 0.104944
Epoch 33
Loss = 1.0963e-01, PNorm = 34.4519, GNorm = 3.1916, lr_0 = 2.3171e-04
Validation rmse = 0.098757
Epoch 34
Loss = 9.2545e-02, PNorm = 34.4588, GNorm = 1.4268, lr_0 = 2.1687e-04
Validation rmse = 0.112483
Epoch 35
Validation rmse = 0.098182
Epoch 36
Loss = 9.2715e-02, PNorm = 34.4651, GNorm = 1.8913, lr_0 = 2.0165e-04
Validation rmse = 0.103682
Epoch 37
Loss = 8.6164e-02, PNorm = 34.4707, GNorm = 0.9829, lr_0 = 1.8874e-04
Validation rmse = 0.107777
Epoch 38
Validation rmse = 0.099451
Epoch 39
Loss = 8.3069e-02, PNorm = 34.4765, GNorm = 2.0054, lr_0 = 1.7549e-04
Validation rmse = 0.109135
Epoch 40
Loss = 9.2942e-02, PNorm = 34.4818, GNorm = 1.6865, lr_0 = 1.6425e-04
Validation rmse = 0.102462
Epoch 41
Validation rmse = 0.110553
Epoch 42
Loss = 6.1780e-02, PNorm = 34.4868, GNorm = 0.9647, lr_0 = 1.5272e-04
Validation rmse = 0.104532
Epoch 43
Loss = 8.9618e-02, PNorm = 34.4912, GNorm = 0.8138, lr_0 = 1.4295e-04
Validation rmse = 0.108544
Epoch 44
Validation rmse = 0.107575
Epoch 45
Loss = 8.9925e-02, PNorm = 34.4961, GNorm = 0.6195, lr_0 = 1.3291e-04
Validation rmse = 0.103763
Epoch 46
Loss = 7.7705e-02, PNorm = 34.5004, GNorm = 1.1653, lr_0 = 1.2440e-04
Validation rmse = 0.106889
Epoch 47
Validation rmse = 0.108432
Epoch 48
Loss = 5.6281e-02, PNorm = 34.5046, GNorm = 2.2422, lr_0 = 1.1567e-04
Validation rmse = 0.112406
Epoch 49
Loss = 8.2610e-02, PNorm = 34.5082, GNorm = 1.2136, lr_0 = 1.0826e-04
Validation rmse = 0.105508
Epoch 50
Validation rmse = 0.108772
Epoch 51
Loss = 7.4170e-02, PNorm = 34.5120, GNorm = 1.1278, lr_0 = 1.0066e-04
Validation rmse = 0.106989
Epoch 52
Loss = 7.5667e-02, PNorm = 34.5157, GNorm = 1.1609, lr_0 = 1.0000e-04
Validation rmse = 0.109158
Epoch 53
Validation rmse = 0.107038
Epoch 54
Loss = 7.4911e-02, PNorm = 34.5193, GNorm = 1.1783, lr_0 = 1.0000e-04
Validation rmse = 0.109521
Epoch 55
Loss = 7.9935e-02, PNorm = 34.5226, GNorm = 0.7311, lr_0 = 1.0000e-04
Validation rmse = 0.109975
Epoch 56
Validation rmse = 0.110281
Epoch 57
Loss = 8.0069e-02, PNorm = 34.5267, GNorm = 2.0320, lr_0 = 1.0000e-04
Validation rmse = 0.107885
Epoch 58
Loss = 7.8912e-02, PNorm = 34.5301, GNorm = 0.8713, lr_0 = 1.0000e-04
Validation rmse = 0.109819
Epoch 59
Validation rmse = 0.110130
Model 0 best validation rmse = 0.017158 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.192185
Ensemble test rmse = 0.192185
1-fold cross validation
	Seed 0 ==> test rmse = 0.192185
Overall test rmse = 0.192185 +/- 0.000000
Elapsed time = 0:00:16
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 327 | train size = 323 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.374389
Epoch 1
Loss = 6.8466e-01, PNorm = 34.0366, GNorm = 4.2087, lr_0 = 1.0000e-03
Validation rmse = 0.289931
Epoch 2
Validation rmse = 0.216256
Epoch 3
Loss = 3.3963e-01, PNorm = 34.1017, GNorm = 4.9315, lr_0 = 9.2980e-04
Validation rmse = 0.178822
Epoch 4
Loss = 2.8243e-01, PNorm = 34.1537, GNorm = 3.0647, lr_0 = 8.6453e-04
Validation rmse = 0.184310
Epoch 5
Validation rmse = 0.201824
Epoch 6
Loss = 2.5402e-01, PNorm = 34.1904, GNorm = 4.1745, lr_0 = 8.0385e-04
Validation rmse = 0.121365
Epoch 7
Loss = 1.6267e-01, PNorm = 34.2205, GNorm = 1.8620, lr_0 = 7.5238e-04
Validation rmse = 0.105789
Epoch 8
Validation rmse = 0.145556
Epoch 9
Loss = 1.7486e-01, PNorm = 34.2476, GNorm = 9.3941, lr_0 = 6.9956e-04
Validation rmse = 0.105031
Epoch 10
Loss = 1.3485e-01, PNorm = 34.2675, GNorm = 1.6993, lr_0 = 6.5046e-04
Validation rmse = 0.098436
Epoch 11
Validation rmse = 0.084816
Epoch 12
Loss = 1.3723e-01, PNorm = 34.2861, GNorm = 4.9788, lr_0 = 6.0480e-04
Validation rmse = 0.101780
Epoch 13
Loss = 1.2293e-01, PNorm = 34.3016, GNorm = 1.5178, lr_0 = 5.6234e-04
Validation rmse = 0.128604
Epoch 14
Validation rmse = 0.085315
Epoch 15
Loss = 1.1966e-01, PNorm = 34.3176, GNorm = 1.4403, lr_0 = 5.2287e-04
Validation rmse = 0.096215
Epoch 16
Validation rmse = 0.145212
Epoch 17
Loss = 1.7998e-01, PNorm = 34.3327, GNorm = 9.0099, lr_0 = 4.8616e-04
Validation rmse = 0.160064
Epoch 18
Loss = 1.6722e-01, PNorm = 34.3440, GNorm = 9.5601, lr_0 = 4.5504e-04
Validation rmse = 0.161377
Epoch 19
Validation rmse = 0.144021
Epoch 20
Loss = 1.4963e-01, PNorm = 34.3559, GNorm = 5.3837, lr_0 = 4.2309e-04
Validation rmse = 0.100788
Epoch 21
Loss = 1.0026e-01, PNorm = 34.3693, GNorm = 1.9554, lr_0 = 3.9339e-04
Validation rmse = 0.082083
Epoch 22
Validation rmse = 0.083899
Epoch 23
Loss = 7.9462e-02, PNorm = 34.3811, GNorm = 0.4641, lr_0 = 3.6578e-04
Validation rmse = 0.108433
Epoch 24
Loss = 1.0003e-01, PNorm = 34.3890, GNorm = 3.9986, lr_0 = 3.4236e-04
Validation rmse = 0.121698
Epoch 25
Validation rmse = 0.097179
Epoch 26
Loss = 8.8779e-02, PNorm = 34.3984, GNorm = 2.2577, lr_0 = 3.1623e-04
Validation rmse = 0.107021
Epoch 27
Loss = 9.2062e-02, PNorm = 34.4074, GNorm = 4.0031, lr_0 = 2.9598e-04
Loss = 9.0121e-02, PNorm = 34.4083, GNorm = 0.9134, lr_0 = 2.9403e-04
Validation rmse = 0.122113
Epoch 28
Validation rmse = 0.103912
Epoch 29
Loss = 1.2084e-01, PNorm = 34.4160, GNorm = 7.3331, lr_0 = 2.7520e-04
Validation rmse = 0.076891
Epoch 30
Loss = 9.2316e-02, PNorm = 34.4241, GNorm = 1.1793, lr_0 = 2.5589e-04
Validation rmse = 0.078978
Epoch 31
Validation rmse = 0.104664
Epoch 32
Loss = 8.4172e-02, PNorm = 34.4325, GNorm = 1.9929, lr_0 = 2.3792e-04
Validation rmse = 0.108537
Epoch 33
Validation rmse = 0.084737
Epoch 34
Loss = 8.7368e-02, PNorm = 34.4396, GNorm = 0.7281, lr_0 = 2.2122e-04
Validation rmse = 0.084503
Epoch 35
Loss = 8.8058e-02, PNorm = 34.4452, GNorm = 1.4018, lr_0 = 2.0706e-04
Validation rmse = 0.097770
Epoch 36
Validation rmse = 0.078441
Epoch 37
Loss = 6.8135e-02, PNorm = 34.4514, GNorm = 0.9468, lr_0 = 1.9252e-04
Validation rmse = 0.116013
Epoch 38
Loss = 8.0030e-02, PNorm = 34.4572, GNorm = 3.0252, lr_0 = 1.7901e-04
Validation rmse = 0.099437
Epoch 39
Validation rmse = 0.096814
Epoch 40
Loss = 7.5900e-02, PNorm = 34.4622, GNorm = 0.6800, lr_0 = 1.6644e-04
Validation rmse = 0.087463
Epoch 41
Loss = 8.2296e-02, PNorm = 34.4674, GNorm = 1.7932, lr_0 = 1.5476e-04
Validation rmse = 0.112126
Epoch 42
Validation rmse = 0.098767
Epoch 43
Loss = 8.0112e-02, PNorm = 34.4720, GNorm = 2.7609, lr_0 = 1.4390e-04
Validation rmse = 0.114157
Epoch 44
Loss = 7.6361e-02, PNorm = 34.4765, GNorm = 0.8352, lr_0 = 1.3468e-04
Loss = 1.0367e-01, PNorm = 34.4769, GNorm = 1.5441, lr_0 = 1.3379e-04
Validation rmse = 0.087589
Epoch 45
Validation rmse = 0.110269
Epoch 46
Loss = 7.2793e-02, PNorm = 34.4808, GNorm = 1.5796, lr_0 = 1.2523e-04
Validation rmse = 0.092475
Epoch 47
Loss = 7.7472e-02, PNorm = 34.4849, GNorm = 3.3212, lr_0 = 1.1644e-04
Validation rmse = 0.111153
Epoch 48
Validation rmse = 0.095650
Epoch 49
Loss = 7.2563e-02, PNorm = 34.4887, GNorm = 0.5400, lr_0 = 1.0826e-04
Validation rmse = 0.102602
Epoch 50
Validation rmse = 0.100360
Epoch 51
Loss = 7.7889e-02, PNorm = 34.4926, GNorm = 1.2405, lr_0 = 1.0066e-04
Validation rmse = 0.085907
Epoch 52
Loss = 7.0800e-02, PNorm = 34.4961, GNorm = 1.2713, lr_0 = 1.0000e-04
Validation rmse = 0.115970
Epoch 53
Validation rmse = 0.077735
Epoch 54
Loss = 7.5056e-02, PNorm = 34.4996, GNorm = 3.8614, lr_0 = 1.0000e-04
Validation rmse = 0.114711
Epoch 55
Loss = 6.9853e-02, PNorm = 34.5027, GNorm = 1.5574, lr_0 = 1.0000e-04
Validation rmse = 0.084513
Epoch 56
Validation rmse = 0.124225
Epoch 57
Loss = 9.1925e-02, PNorm = 34.5061, GNorm = 2.6408, lr_0 = 1.0000e-04
Validation rmse = 0.086845
Epoch 58
Loss = 7.4038e-02, PNorm = 34.5096, GNorm = 1.8627, lr_0 = 1.0000e-04
Validation rmse = 0.114394
Epoch 59
Validation rmse = 0.099664
Model 0 best validation rmse = 0.076891 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.074109
Ensemble test rmse = 0.074109
1-fold cross validation
	Seed 0 ==> test rmse = 0.074109
Overall test rmse = 0.074109 +/- 0.000000
Elapsed time = 0:00:15
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_dmf.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_dmf.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 123 | train size = 121 | val size = 1 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.320495
Epoch 1
Validation rmse = 0.379626
Epoch 2
Validation rmse = 0.351233
Epoch 3
Validation rmse = 0.230574
Epoch 4
Loss = 4.9752e-01, PNorm = 34.0648, GNorm = 8.4902, lr_0 = 8.1996e-04
Validation rmse = 0.427409
Epoch 5
Validation rmse = 0.196931
Epoch 6
Validation rmse = 0.422968
Epoch 7
Validation rmse = 0.246160
Epoch 8
Loss = 5.1728e-01, PNorm = 34.1125, GNorm = 5.0930, lr_0 = 6.4617e-04
Validation rmse = 0.244755
Epoch 9
Validation rmse = 0.380614
Epoch 10
Validation rmse = 0.262081
Epoch 11
Validation rmse = 0.233395
Epoch 12
Loss = 4.2697e-01, PNorm = 34.1484, GNorm = 2.6389, lr_0 = 5.0921e-04
Validation rmse = 0.328275
Epoch 13
Validation rmse = 0.250487
Epoch 14
Validation rmse = 0.216706
Epoch 15
Validation rmse = 0.289862
Epoch 16
Loss = 3.7520e-01, PNorm = 34.1814, GNorm = 6.2133, lr_0 = 3.9339e-04
Validation rmse = 0.244409
Epoch 17
Validation rmse = 0.209401
Epoch 18
Validation rmse = 0.251892
Epoch 19
Validation rmse = 0.195191
Epoch 20
Loss = 2.6555e-01, PNorm = 34.2055, GNorm = 3.7954, lr_0 = 3.1001e-04
Loss = 4.6783e-01, PNorm = 34.2074, GNorm = 3.0512, lr_0 = 3.0392e-04
Validation rmse = 0.182594
Epoch 21
Validation rmse = 0.195597
Epoch 22
Validation rmse = 0.191631
Epoch 23
Validation rmse = 0.171344
Epoch 24
Loss = 2.7554e-01, PNorm = 34.2255, GNorm = 2.3120, lr_0 = 2.4430e-04
Loss = 2.4698e-01, PNorm = 34.2270, GNorm = 1.2325, lr_0 = 2.3950e-04
Validation rmse = 0.154297
Epoch 25
Validation rmse = 0.162199
Epoch 26
Validation rmse = 0.145054
Epoch 27
Validation rmse = 0.174916
Epoch 28
Loss = 2.7290e-01, PNorm = 34.2443, GNorm = 4.1107, lr_0 = 1.8874e-04
Validation rmse = 0.132441
Epoch 29
Validation rmse = 0.105435
Epoch 30
Validation rmse = 0.141899
Epoch 31
Validation rmse = 0.170968
Epoch 32
Validation rmse = 0.108168
Epoch 33
Loss = 2.8465e-01, PNorm = 34.2594, GNorm = 0.4609, lr_0 = 1.4581e-04
Validation rmse = 0.084487
Epoch 34
Validation rmse = 0.128721
Epoch 35
Validation rmse = 0.131969
Epoch 36
Validation rmse = 0.100346
Epoch 37
Loss = 2.0330e-01, PNorm = 34.2703, GNorm = 1.5935, lr_0 = 1.1491e-04
Validation rmse = 0.097327
Epoch 38
Validation rmse = 0.108640
Epoch 39
Validation rmse = 0.118494
Epoch 40
Validation rmse = 0.090508
Epoch 41
Loss = 1.5584e-01, PNorm = 34.2793, GNorm = 3.0018, lr_0 = 1.0000e-04
Validation rmse = 0.084873
Epoch 42
Validation rmse = 0.098794
Epoch 43
Validation rmse = 0.100434
Epoch 44
Validation rmse = 0.072725
Epoch 45
Loss = 2.2796e-01, PNorm = 34.2891, GNorm = 0.6586, lr_0 = 1.0000e-04
Validation rmse = 0.077270
Epoch 46
Validation rmse = 0.106630
Epoch 47
Validation rmse = 0.083823
Epoch 48
Validation rmse = 0.067438
Epoch 49
Loss = 2.1062e-01, PNorm = 34.2980, GNorm = 2.6427, lr_0 = 1.0000e-04
Validation rmse = 0.086171
Epoch 50
Validation rmse = 0.091350
Epoch 51
Validation rmse = 0.059274
Epoch 52
Validation rmse = 0.060474
Epoch 53
Loss = 1.8145e-01, PNorm = 34.3071, GNorm = 0.6704, lr_0 = 1.0000e-04
Loss = 2.1627e-01, PNorm = 34.3078, GNorm = 1.4700, lr_0 = 1.0000e-04
Validation rmse = 0.075642
Epoch 54
Validation rmse = 0.069596
Epoch 55
Validation rmse = 0.043547
Epoch 56
Validation rmse = 0.049505
Epoch 57
Loss = 1.6582e-01, PNorm = 34.3170, GNorm = 1.0131, lr_0 = 1.0000e-04
Validation rmse = 0.057679
Epoch 58
Validation rmse = 0.061795
Epoch 59
Validation rmse = 0.053861
Model 0 best validation rmse = 0.043547 on epoch 55
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.133537
Ensemble test rmse = 0.133537
1-fold cross validation
	Seed 0 ==> test rmse = 0.133537
Overall test rmse = 0.133537 +/- 0.000000
Elapsed time = 0:00:08
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_dmf.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 118 | train size = 116 | val size = 1 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.461662
Epoch 1
Validation rmse = 0.527274
Epoch 2
Validation rmse = 0.381564
Epoch 3
Validation rmse = 0.369907
Epoch 4
Loss = 5.2237e-01, PNorm = 34.0725, GNorm = 2.9632, lr_0 = 8.1996e-04
Validation rmse = 0.416177
Epoch 5
Validation rmse = 0.320034
Epoch 6
Validation rmse = 0.257396
Epoch 7
Validation rmse = 0.291711
Epoch 8
Loss = 3.6075e-01, PNorm = 34.1287, GNorm = 1.2229, lr_0 = 6.3347e-04
Loss = 4.0371e-01, PNorm = 34.1330, GNorm = 8.6778, lr_0 = 6.2102e-04
Validation rmse = 0.251944
Epoch 9
Validation rmse = 0.248463
Epoch 10
Validation rmse = 0.202888
Epoch 11
Validation rmse = 0.218085
Epoch 12
Loss = 2.6539e-01, PNorm = 34.1770, GNorm = 6.1078, lr_0 = 4.8939e-04
Validation rmse = 0.197272
Epoch 13
Validation rmse = 0.176533
Epoch 14
Validation rmse = 0.202290
Epoch 15
Validation rmse = 0.182509
Epoch 16
Validation rmse = 0.200367
Epoch 17
Loss = 1.9528e-01, PNorm = 34.2106, GNorm = 1.2450, lr_0 = 3.7808e-04
Validation rmse = 0.172723
Epoch 18
Validation rmse = 0.179608
Epoch 19
Validation rmse = 0.193373
Epoch 20
Validation rmse = 0.148841
Epoch 21
Loss = 1.7972e-01, PNorm = 34.2340, GNorm = 1.1838, lr_0 = 2.9209e-04
Validation rmse = 0.207202
Epoch 22
Validation rmse = 0.156330
Epoch 23
Validation rmse = 0.180815
Epoch 24
Validation rmse = 0.195513
Epoch 25
Loss = 1.4771e-01, PNorm = 34.2520, GNorm = 0.9803, lr_0 = 2.3018e-04
Loss = 2.1885e-01, PNorm = 34.2535, GNorm = 4.5688, lr_0 = 2.2566e-04
Validation rmse = 0.149121
Epoch 26
Validation rmse = 0.186034
Epoch 27
Validation rmse = 0.165146
Epoch 28
Validation rmse = 0.142027
Epoch 29
Validation rmse = 0.198372
Epoch 30
Loss = 1.6361e-01, PNorm = 34.2702, GNorm = 5.6423, lr_0 = 1.7433e-04
Validation rmse = 0.166771
Epoch 31
Validation rmse = 0.167957
Epoch 32
Validation rmse = 0.190367
Epoch 33
Validation rmse = 0.183326
Epoch 34
Loss = 1.1775e-01, PNorm = 34.2815, GNorm = 0.8805, lr_0 = 1.3468e-04
Validation rmse = 0.151530
Epoch 35
Validation rmse = 0.178487
Epoch 36
Validation rmse = 0.191057
Epoch 37
Validation rmse = 0.166078
Epoch 38
Loss = 1.3307e-01, PNorm = 34.2900, GNorm = 4.9147, lr_0 = 1.0614e-04
Loss = 8.7949e-02, PNorm = 34.2906, GNorm = 2.1184, lr_0 = 1.0405e-04
Validation rmse = 0.157261
Epoch 39
Validation rmse = 0.187779
Epoch 40
Validation rmse = 0.199022
Epoch 41
Validation rmse = 0.174214
Epoch 42
Validation rmse = 0.189774
Epoch 43
Loss = 1.3374e-01, PNorm = 34.2981, GNorm = 3.7229, lr_0 = 1.0000e-04
Validation rmse = 0.195297
Epoch 44
Validation rmse = 0.190348
Epoch 45
Validation rmse = 0.186526
Epoch 46
Validation rmse = 0.176324
Epoch 47
Loss = 1.1150e-01, PNorm = 34.3048, GNorm = 0.8886, lr_0 = 1.0000e-04
Validation rmse = 0.175708
Epoch 48
Validation rmse = 0.188605
Epoch 49
Validation rmse = 0.189283
Epoch 50
Validation rmse = 0.185381
Epoch 51
Loss = 9.7088e-02, PNorm = 34.3118, GNorm = 2.0138, lr_0 = 1.0000e-04
Loss = 1.3019e-01, PNorm = 34.3124, GNorm = 1.2866, lr_0 = 1.0000e-04
Validation rmse = 0.187050
Epoch 52
Validation rmse = 0.191294
Epoch 53
Validation rmse = 0.188803
Epoch 54
Validation rmse = 0.182563
Epoch 55
Validation rmse = 0.193503
Epoch 56
Loss = 9.9132e-02, PNorm = 34.3205, GNorm = 2.2315, lr_0 = 1.0000e-04
Validation rmse = 0.210075
Epoch 57
Validation rmse = 0.187662
Epoch 58
Validation rmse = 0.182279
Epoch 59
Validation rmse = 0.192768
Model 0 best validation rmse = 0.142027 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.072696
Ensemble test rmse = 0.072696
1-fold cross validation
	Seed 0 ==> test rmse = 0.072696
Overall test rmse = 0.072696 +/- 0.000000
Elapsed time = 0:00:08
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_dmf.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 113 | train size = 111 | val size = 1 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.243853
Epoch 1
Validation rmse = 0.275180
Epoch 2
Validation rmse = 0.297096
Epoch 3
Validation rmse = 0.321185
Epoch 4
Loss = 6.2168e-01, PNorm = 34.0619, GNorm = 1.0135, lr_0 = 8.0385e-04
Validation rmse = 0.152561
Epoch 5
Validation rmse = 0.297706
Epoch 6
Validation rmse = 0.189179
Epoch 7
Validation rmse = 0.185053
Epoch 8
Validation rmse = 0.211851
Epoch 9
Loss = 2.7185e-01, PNorm = 34.1319, GNorm = 8.4030, lr_0 = 6.0881e-04
Validation rmse = 0.193749
Epoch 10
Validation rmse = 0.170536
Epoch 11
Validation rmse = 0.092480
Epoch 12
Validation rmse = 0.140991
Epoch 13
Loss = 2.4871e-01, PNorm = 34.1701, GNorm = 2.7845, lr_0 = 4.7034e-04
Validation rmse = 0.128312
Epoch 14
Validation rmse = 0.132897
Epoch 15
Validation rmse = 0.076438
Epoch 16
Validation rmse = 0.126829
Epoch 17
Validation rmse = 0.109461
Epoch 18
Loss = 1.6424e-01, PNorm = 34.1985, GNorm = 0.8679, lr_0 = 3.5622e-04
Validation rmse = 0.149184
Epoch 19
Validation rmse = 0.135353
Epoch 20
Validation rmse = 0.073134
Epoch 21
Validation rmse = 0.154230
Epoch 22
Loss = 1.7779e-01, PNorm = 34.2157, GNorm = 5.1122, lr_0 = 2.7520e-04
Validation rmse = 0.100076
Epoch 23
Validation rmse = 0.090113
Epoch 24
Validation rmse = 0.128112
Epoch 25
Validation rmse = 0.099222
Epoch 26
Validation rmse = 0.088608
Epoch 27
Loss = 1.4309e-01, PNorm = 34.2295, GNorm = 3.8106, lr_0 = 2.0843e-04
Validation rmse = 0.084006
Epoch 28
Validation rmse = 0.093402
Epoch 29
Validation rmse = 0.101432
Epoch 30
Validation rmse = 0.081878
Epoch 31
Loss = 1.2723e-01, PNorm = 34.2389, GNorm = 1.3803, lr_0 = 1.6103e-04
Validation rmse = 0.090109
Epoch 32
Validation rmse = 0.106690
Epoch 33
Validation rmse = 0.087563
Epoch 34
Validation rmse = 0.084879
Epoch 35
Validation rmse = 0.101465
Epoch 36
Loss = 1.2899e-01, PNorm = 34.2484, GNorm = 2.2142, lr_0 = 1.2196e-04
Validation rmse = 0.106461
Epoch 37
Validation rmse = 0.080378
Epoch 38
Validation rmse = 0.094464
Epoch 39
Validation rmse = 0.104416
Epoch 40
Loss = 1.0710e-01, PNorm = 34.2544, GNorm = 0.7703, lr_0 = 1.0000e-04
Validation rmse = 0.076712
Epoch 41
Validation rmse = 0.090351
Epoch 42
Validation rmse = 0.122033
Epoch 43
Validation rmse = 0.100488
Epoch 44
Validation rmse = 0.067346
Epoch 45
Loss = 9.5414e-02, PNorm = 34.2598, GNorm = 3.0187, lr_0 = 1.0000e-04
Validation rmse = 0.090141
Epoch 46
Validation rmse = 0.113949
Epoch 47
Validation rmse = 0.114242
Epoch 48
Validation rmse = 0.083120
Epoch 49
Loss = 9.9996e-02, PNorm = 34.2649, GNorm = 1.2096, lr_0 = 1.0000e-04
Validation rmse = 0.077241
Epoch 50
Validation rmse = 0.102413
Epoch 51
Validation rmse = 0.085307
Epoch 52
Validation rmse = 0.079400
Epoch 53
Validation rmse = 0.107143
Epoch 54
Loss = 9.9053e-02, PNorm = 34.2712, GNorm = 4.3130, lr_0 = 1.0000e-04
Validation rmse = 0.092280
Epoch 55
Validation rmse = 0.105340
Epoch 56
Validation rmse = 0.096110
Epoch 57
Validation rmse = 0.084291
Epoch 58
Loss = 9.1341e-02, PNorm = 34.2764, GNorm = 0.5292, lr_0 = 1.0000e-04
Loss = 1.0100e-01, PNorm = 34.2768, GNorm = 7.5159, lr_0 = 1.0000e-04
Validation rmse = 0.090689
Epoch 59
Validation rmse = 0.082238
Model 0 best validation rmse = 0.067346 on epoch 44
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.115683
Ensemble test rmse = 0.115683
1-fold cross validation
	Seed 0 ==> test rmse = 0.115683
Overall test rmse = 0.115683 +/- 0.000000
Elapsed time = 0:00:07
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_dmf.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 108 | train size = 106 | val size = 1 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.079297
Epoch 1
Validation rmse = 0.098742
Epoch 2
Validation rmse = 0.217817
Epoch 3
Validation rmse = 0.142910
Epoch 4
Loss = 6.3358e-01, PNorm = 34.0620, GNorm = 1.7774, lr_0 = 8.0385e-04
Loss = 4.1549e-01, PNorm = 34.0665, GNorm = 7.4809, lr_0 = 7.8805e-04
Validation rmse = 0.060103
Epoch 5
Validation rmse = 0.089404
Epoch 6
Validation rmse = 0.035672
Epoch 7
Validation rmse = 0.015426
Epoch 8
Validation rmse = 0.004886
Epoch 9
Loss = 3.1436e-01, PNorm = 34.1328, GNorm = 4.3957, lr_0 = 6.0881e-04
Validation rmse = 0.080170
Epoch 10
Validation rmse = 0.094867
Epoch 11
Validation rmse = 0.050115
Epoch 12
Validation rmse = 0.006681
Epoch 13
Validation rmse = 0.004691
Epoch 14
Loss = 2.3589e-01, PNorm = 34.1658, GNorm = 1.7012, lr_0 = 4.5204e-04
Validation rmse = 0.008505
Epoch 15
Validation rmse = 0.013593
Epoch 16
Validation rmse = 0.052165
Epoch 17
Validation rmse = 0.001786
Epoch 18
Loss = 1.9556e-01, PNorm = 34.1894, GNorm = 4.9439, lr_0 = 3.4922e-04
Loss = 5.5743e-02, PNorm = 34.1910, GNorm = 5.4245, lr_0 = 3.4236e-04
Validation rmse = 0.003223
Epoch 19
Validation rmse = 0.072095
Epoch 20
Validation rmse = 0.021788
Epoch 21
Validation rmse = 0.020760
Epoch 22
Validation rmse = 0.108714
Epoch 23
Loss = 2.2654e-01, PNorm = 34.2047, GNorm = 6.8685, lr_0 = 2.5929e-04
Loss = 4.1128e-02, PNorm = 34.2053, GNorm = 1.4628, lr_0 = 2.5420e-04
Validation rmse = 0.016121
Epoch 24
Validation rmse = 0.008723
Epoch 25
Validation rmse = 0.048080
Epoch 26
Validation rmse = 0.073886
Epoch 27
Validation rmse = 0.013027
Epoch 28
Loss = 1.4193e-01, PNorm = 34.2158, GNorm = 2.1603, lr_0 = 1.9638e-04
Validation rmse = 0.001057
Epoch 29
Validation rmse = 0.059681
Epoch 30
Validation rmse = 0.048575
Epoch 31
Validation rmse = 0.008709
Epoch 32
Validation rmse = 0.010487
Epoch 33
Loss = 1.4706e-01, PNorm = 34.2243, GNorm = 1.2230, lr_0 = 1.4581e-04
Validation rmse = 0.027600
Epoch 34
Validation rmse = 0.027226
Epoch 35
Validation rmse = 0.033529
Epoch 36
Validation rmse = 0.051398
Epoch 37
Loss = 1.3639e-01, PNorm = 34.2300, GNorm = 0.6821, lr_0 = 1.1265e-04
Loss = 4.8268e-02, PNorm = 34.2304, GNorm = 3.3733, lr_0 = 1.1043e-04
Validation rmse = 0.023328
Epoch 38
Validation rmse = 0.003656
Epoch 39
Validation rmse = 0.016301
Epoch 40
Validation rmse = 0.047888
Epoch 41
Validation rmse = 0.044300
Epoch 42
Loss = 1.5168e-01, PNorm = 34.2351, GNorm = 4.1515, lr_0 = 1.0000e-04
Validation rmse = 0.018458
Epoch 43
Validation rmse = 0.028733
Epoch 44
Validation rmse = 0.051869
Epoch 45
Validation rmse = 0.062072
Epoch 46
Validation rmse = 0.054861
Epoch 47
Loss = 7.9459e-02, PNorm = 34.2393, GNorm = 0.4568, lr_0 = 1.0000e-04
Validation rmse = 0.017638
Epoch 48
Validation rmse = 0.008462
Epoch 49
Validation rmse = 0.057741
Epoch 50
Validation rmse = 0.082102
Epoch 51
Loss = 1.3348e-01, PNorm = 34.2439, GNorm = 5.2368, lr_0 = 1.0000e-04
Loss = 7.9166e-02, PNorm = 34.2443, GNorm = 1.3850, lr_0 = 1.0000e-04
Validation rmse = 0.043307
Epoch 52
Validation rmse = 0.003835
Epoch 53
Validation rmse = 0.009502
Epoch 54
Validation rmse = 0.056638
Epoch 55
Validation rmse = 0.064437
Epoch 56
Loss = 1.0920e-01, PNorm = 34.2500, GNorm = 2.4278, lr_0 = 1.0000e-04
Loss = 1.0337e-01, PNorm = 34.2504, GNorm = 5.8254, lr_0 = 1.0000e-04
Validation rmse = 0.031375
Epoch 57
Validation rmse = 0.009299
Epoch 58
Validation rmse = 0.034776
Epoch 59
Validation rmse = 0.056712
Model 0 best validation rmse = 0.001057 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.143232
Ensemble test rmse = 0.143232
1-fold cross validation
	Seed 0 ==> test rmse = 0.143232
Overall test rmse = 0.143232 +/- 0.000000
Elapsed time = 0:00:07
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_dmf.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 103 | train size = 101 | val size = 1 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.032165
Epoch 1
Validation rmse = 0.013196
Epoch 2
Validation rmse = 0.139003
Epoch 3
Validation rmse = 0.113334
Epoch 4
Loss = 8.4646e-01, PNorm = 34.0523, GNorm = 2.6313, lr_0 = 8.0385e-04
Loss = 5.2864e-01, PNorm = 34.0562, GNorm = 8.2230, lr_0 = 7.8805e-04
Validation rmse = 0.111903
Epoch 5
Validation rmse = 0.146263
Epoch 6
Validation rmse = 0.154260
Epoch 7
Validation rmse = 0.111104
Epoch 8
Validation rmse = 0.050323
Epoch 9
Loss = 6.7547e-01, PNorm = 34.1107, GNorm = 5.3246, lr_0 = 5.9685e-04
Loss = 7.4635e-01, PNorm = 34.1144, GNorm = 13.8612, lr_0 = 5.8512e-04
Validation rmse = 0.018163
Epoch 10
Validation rmse = 0.108135
Epoch 11
Validation rmse = 0.223596
Epoch 12
Validation rmse = 0.115362
Epoch 13
Validation rmse = 0.052244
Epoch 14
Loss = 7.5675e-01, PNorm = 34.1550, GNorm = 8.5122, lr_0 = 4.4315e-04
Loss = 3.2482e-03, PNorm = 34.1576, GNorm = 0.7861, lr_0 = 4.3444e-04
Validation rmse = 0.076736
Epoch 15
Validation rmse = 0.052506
Epoch 16
Validation rmse = 0.238025
Epoch 17
Validation rmse = 0.230165
Epoch 18
Validation rmse = 0.113526
Epoch 19
Loss = 3.6602e-01, PNorm = 34.1863, GNorm = 2.8339, lr_0 = 3.2903e-04
Loss = 2.2373e-02, PNorm = 34.1877, GNorm = 2.0141, lr_0 = 3.2257e-04
Validation rmse = 0.049018
Epoch 20
Validation rmse = 0.033983
Epoch 21
Validation rmse = 0.086209
Epoch 22
Validation rmse = 0.171492
Epoch 23
Validation rmse = 0.190722
Epoch 24
Loss = 3.9342e-01, PNorm = 34.2067, GNorm = 3.7255, lr_0 = 2.4430e-04
Loss = 1.8135e-03, PNorm = 34.2078, GNorm = 0.8036, lr_0 = 2.3950e-04
Validation rmse = 0.121264
Epoch 25
Validation rmse = 0.066909
Epoch 26
Validation rmse = 0.070278
Epoch 27
Validation rmse = 0.085433
Epoch 28
Validation rmse = 0.086232
Epoch 29
Loss = 2.2969e-01, PNorm = 34.2217, GNorm = 1.3474, lr_0 = 1.8139e-04
Loss = 3.5481e-01, PNorm = 34.2228, GNorm = 14.5563, lr_0 = 1.7783e-04
Validation rmse = 0.120291
Epoch 30
Validation rmse = 0.147445
Epoch 31
Validation rmse = 0.131293
Epoch 32
Validation rmse = 0.113918
Epoch 33
Validation rmse = 0.108996
Epoch 34
Loss = 2.1447e-01, PNorm = 34.2321, GNorm = 3.4962, lr_0 = 1.3468e-04
Loss = 2.9333e-01, PNorm = 34.2325, GNorm = 13.6960, lr_0 = 1.3204e-04
Validation rmse = 0.093967
Epoch 35
Validation rmse = 0.047038
Epoch 36
Validation rmse = 0.010279
Epoch 37
Validation rmse = 0.003203
Epoch 38
Validation rmse = 0.024079
Epoch 39
Loss = 2.0848e-01, PNorm = 34.2378, GNorm = 3.1774, lr_0 = 1.0000e-04
Loss = 1.2865e-01, PNorm = 34.2380, GNorm = 8.0908, lr_0 = 1.0000e-04
Validation rmse = 0.041894
Epoch 40
Validation rmse = 0.054173
Epoch 41
Validation rmse = 0.077340
Epoch 42
Validation rmse = 0.122843
Epoch 43
Validation rmse = 0.160316
Epoch 44
Loss = 2.7325e-01, PNorm = 34.2409, GNorm = 7.3204, lr_0 = 1.0000e-04
Loss = 4.6099e-03, PNorm = 34.2411, GNorm = 1.3820, lr_0 = 1.0000e-04
Validation rmse = 0.164992
Epoch 45
Validation rmse = 0.145287
Epoch 46
Validation rmse = 0.110312
Epoch 47
Validation rmse = 0.040488
Epoch 48
Validation rmse = 0.005419
Epoch 49
Loss = 2.4799e-01, PNorm = 34.2440, GNorm = 5.7733, lr_0 = 1.0000e-04
Validation rmse = 0.013141
Epoch 50
Validation rmse = 0.008881
Epoch 51
Validation rmse = 0.058679
Epoch 52
Validation rmse = 0.106322
Epoch 53
Validation rmse = 0.130789
Epoch 54
Loss = 2.1368e-01, PNorm = 34.2468, GNorm = 4.1702, lr_0 = 1.0000e-04
Validation rmse = 0.122081
Epoch 55
Validation rmse = 0.096303
Epoch 56
Validation rmse = 0.063014
Epoch 57
Validation rmse = 0.052639
Epoch 58
Validation rmse = 0.064641
Epoch 59
Loss = 1.4549e-01, PNorm = 34.2513, GNorm = 1.5192, lr_0 = 1.0000e-04
Validation rmse = 0.082575
Model 0 best validation rmse = 0.003203 on epoch 37
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.097667
Ensemble test rmse = 0.097667
1-fold cross validation
	Seed 0 ==> test rmse = 0.097667
Overall test rmse = 0.097667 +/- 0.000000
Elapsed time = 0:00:07
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 417 | train size = 412 | val size = 2 | test size = 3
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.302486
Model 0 best validation rmse = 0.302486 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.180973
Ensemble test rmse = 0.180973
1-fold cross validation
	Seed 0 ==> test rmse = 0.180973
Overall test rmse = 0.180973 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 409 | train size = 404 | val size = 2 | test size = 3
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.260415
Model 0 best validation rmse = 0.260415 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.107266
Ensemble test rmse = 0.107266
1-fold cross validation
	Seed 0 ==> test rmse = 0.107266
Overall test rmse = 0.107266 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 401 | train size = 396 | val size = 2 | test size = 3
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.259737
Model 0 best validation rmse = 0.259737 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.162067
Ensemble test rmse = 0.162067
1-fold cross validation
	Seed 0 ==> test rmse = 0.162067
Overall test rmse = 0.162067 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 393 | train size = 389 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.278390
Model 0 best validation rmse = 0.278390 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.160769
Ensemble test rmse = 0.160769
1-fold cross validation
	Seed 0 ==> test rmse = 0.160769
Overall test rmse = 0.160769 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 385 | train size = 381 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.316123
Model 0 best validation rmse = 0.316123 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.201011
Ensemble test rmse = 0.201011
1-fold cross validation
	Seed 0 ==> test rmse = 0.201011
Overall test rmse = 0.201011 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 377 | train size = 373 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.329961
Model 0 best validation rmse = 0.329961 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.143176
Ensemble test rmse = 0.143176
1-fold cross validation
	Seed 0 ==> test rmse = 0.143176
Overall test rmse = 0.143176 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 369 | train size = 365 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.196243
Model 0 best validation rmse = 0.196243 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.207230
Ensemble test rmse = 0.207230
1-fold cross validation
	Seed 0 ==> test rmse = 0.207230
Overall test rmse = 0.207230 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 361 | train size = 357 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.281655
Model 0 best validation rmse = 0.281655 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.193807
Ensemble test rmse = 0.193807
1-fold cross validation
	Seed 0 ==> test rmse = 0.193807
Overall test rmse = 0.193807 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 353 | train size = 349 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.177246
Model 0 best validation rmse = 0.177246 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.240417
Ensemble test rmse = 0.240417
1-fold cross validation
	Seed 0 ==> test rmse = 0.240417
Overall test rmse = 0.240417 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 345 | train size = 341 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.290318
Model 0 best validation rmse = 0.290318 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.165346
Ensemble test rmse = 0.165346
1-fold cross validation
	Seed 0 ==> test rmse = 0.165346
Overall test rmse = 0.165346 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 337 | train size = 333 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.161092
Model 0 best validation rmse = 0.161092 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.175921
Ensemble test rmse = 0.175921
1-fold cross validation
	Seed 0 ==> test rmse = 0.175921
Overall test rmse = 0.175921 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 327 | train size = 323 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.265231
Model 0 best validation rmse = 0.265231 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.152751
Ensemble test rmse = 0.152751
1-fold cross validation
	Seed 0 ==> test rmse = 0.152751
Overall test rmse = 0.152751 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 317 | train size = 313 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.293046
Model 0 best validation rmse = 0.293046 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.033541
Ensemble test rmse = 0.033541
1-fold cross validation
	Seed 0 ==> test rmse = 0.033541
Overall test rmse = 0.033541 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 307 | train size = 303 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.227832
Model 0 best validation rmse = 0.227832 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.094229
Ensemble test rmse = 0.094229
1-fold cross validation
	Seed 0 ==> test rmse = 0.094229
Overall test rmse = 0.094229 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 297 | train size = 294 | val size = 1 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.326363
Model 0 best validation rmse = 0.326363 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.192276
Ensemble test rmse = 0.192276
1-fold cross validation
	Seed 0 ==> test rmse = 0.192276
Overall test rmse = 0.192276 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 287 | train size = 284 | val size = 1 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.230920
Model 0 best validation rmse = 0.230920 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.090093
Ensemble test rmse = 0.090093
1-fold cross validation
	Seed 0 ==> test rmse = 0.090093
Overall test rmse = 0.090093 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 277 | train size = 274 | val size = 1 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.292167
Model 0 best validation rmse = 0.292167 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.019908
Ensemble test rmse = 0.019908
1-fold cross validation
	Seed 0 ==> test rmse = 0.019908
Overall test rmse = 0.019908 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 267 | train size = 264 | val size = 1 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.198925
Model 0 best validation rmse = 0.198925 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.102228
Ensemble test rmse = 0.102228
1-fold cross validation
	Seed 0 ==> test rmse = 0.102228
Overall test rmse = 0.102228 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 257 | train size = 254 | val size = 1 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.191398
Model 0 best validation rmse = 0.191398 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.031707
Ensemble test rmse = 0.031707
1-fold cross validation
	Seed 0 ==> test rmse = 0.031707
Overall test rmse = 0.031707 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 247 | train size = 244 | val size = 1 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.009115
Model 0 best validation rmse = 0.009115 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.076780
Ensemble test rmse = 0.076780
1-fold cross validation
	Seed 0 ==> test rmse = 0.076780
Overall test rmse = 0.076780 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 417 | train size = 412 | val size = 2 | test size = 3
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.302486
Model 0 best validation rmse = 0.302486 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.180973
Ensemble test rmse = 0.180973
1-fold cross validation
	Seed 0 ==> test rmse = 0.180973
Overall test rmse = 0.180973 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 407 | train size = 402 | val size = 2 | test size = 3
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.385318
Model 0 best validation rmse = 0.385318 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.179138
Ensemble test rmse = 0.179138
1-fold cross validation
	Seed 0 ==> test rmse = 0.179138
Overall test rmse = 0.179138 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 397 | train size = 393 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.300268
Model 0 best validation rmse = 0.300268 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.208647
Ensemble test rmse = 0.208647
1-fold cross validation
	Seed 0 ==> test rmse = 0.208647
Overall test rmse = 0.208647 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 387 | train size = 383 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.304685
Model 0 best validation rmse = 0.304685 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.239219
Ensemble test rmse = 0.239219
1-fold cross validation
	Seed 0 ==> test rmse = 0.239219
Overall test rmse = 0.239219 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 377 | train size = 373 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.312976
Model 0 best validation rmse = 0.312976 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.166186
Ensemble test rmse = 0.166186
1-fold cross validation
	Seed 0 ==> test rmse = 0.166186
Overall test rmse = 0.166186 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 367 | train size = 363 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.310981
Model 0 best validation rmse = 0.310981 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.171843
Ensemble test rmse = 0.171843
1-fold cross validation
	Seed 0 ==> test rmse = 0.171843
Overall test rmse = 0.171843 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 357 | train size = 353 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.283599
Model 0 best validation rmse = 0.283599 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.161826
Ensemble test rmse = 0.161826
1-fold cross validation
	Seed 0 ==> test rmse = 0.161826
Overall test rmse = 0.161826 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 347 | train size = 343 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.257658
Model 0 best validation rmse = 0.257658 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.130378
Ensemble test rmse = 0.130378
1-fold cross validation
	Seed 0 ==> test rmse = 0.130378
Overall test rmse = 0.130378 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 337 | train size = 333 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.310116
Model 0 best validation rmse = 0.310116 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.190293
Ensemble test rmse = 0.190293
1-fold cross validation
	Seed 0 ==> test rmse = 0.190293
Overall test rmse = 0.190293 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 327 | train size = 323 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.177274
Model 0 best validation rmse = 0.177274 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.185648
Ensemble test rmse = 0.185648
1-fold cross validation
	Seed 0 ==> test rmse = 0.185648
Overall test rmse = 0.185648 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 417 | train size = 331 | val size = 83 | test size = 3
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.225177
Model 0 best validation rmse = 0.225177 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.230065
Ensemble test rmse = 0.230065
1-fold cross validation
	Seed 0 ==> test rmse = 0.230065
Overall test rmse = 0.230065 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 407 | train size = 323 | val size = 81 | test size = 3
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.215824
Model 0 best validation rmse = 0.215824 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.129471
Ensemble test rmse = 0.129471
1-fold cross validation
	Seed 0 ==> test rmse = 0.129471
Overall test rmse = 0.129471 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 397 | train size = 315 | val size = 80 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.211406
Model 0 best validation rmse = 0.211406 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.147555
Ensemble test rmse = 0.147555
1-fold cross validation
	Seed 0 ==> test rmse = 0.147555
Overall test rmse = 0.147555 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 387 | train size = 307 | val size = 78 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.203735
Model 0 best validation rmse = 0.203735 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.066968
Ensemble test rmse = 0.066968
1-fold cross validation
	Seed 0 ==> test rmse = 0.066968
Overall test rmse = 0.066968 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 377 | train size = 299 | val size = 76 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.203081
Model 0 best validation rmse = 0.203081 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.144647
Ensemble test rmse = 0.144647
1-fold cross validation
	Seed 0 ==> test rmse = 0.144647
Overall test rmse = 0.144647 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 367 | train size = 291 | val size = 74 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.198548
Model 0 best validation rmse = 0.198548 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.198404
Ensemble test rmse = 0.198404
1-fold cross validation
	Seed 0 ==> test rmse = 0.198404
Overall test rmse = 0.198404 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 357 | train size = 283 | val size = 72 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.187915
Model 0 best validation rmse = 0.187915 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.160618
Ensemble test rmse = 0.160618
1-fold cross validation
	Seed 0 ==> test rmse = 0.160618
Overall test rmse = 0.160618 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 347 | train size = 275 | val size = 70 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.195625
Model 0 best validation rmse = 0.195625 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.033427
Ensemble test rmse = 0.033427
1-fold cross validation
	Seed 0 ==> test rmse = 0.033427
Overall test rmse = 0.033427 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 337 | train size = 267 | val size = 68 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.227242
Model 0 best validation rmse = 0.227242 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.365644
Ensemble test rmse = 0.365644
1-fold cross validation
	Seed 0 ==> test rmse = 0.365644
Overall test rmse = 0.365644 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 1,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 327 | train size = 259 | val size = 66 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.174814
Model 0 best validation rmse = 0.174814 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.237762
Ensemble test rmse = 0.237762
1-fold cross validation
	Seed 0 ==> test rmse = 0.237762
Overall test rmse = 0.237762 +/- 0.000000
Elapsed time = 0:00:01
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 100,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 417 | train size = 412 | val size = 2 | test size = 3
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.302486
Epoch 1
Loss = 6.9448e-01, PNorm = 34.0263, GNorm = 10.4726, lr_0 = 7.7500e-04
Validation rmse = 0.266817
Epoch 2
Loss = 5.7518e-01, PNorm = 34.0729, GNorm = 4.6021, lr_0 = 9.7965e-04
Validation rmse = 0.472779
Epoch 3
Loss = 6.0127e-01, PNorm = 34.1255, GNorm = 10.7765, lr_0 = 9.4851e-04
Validation rmse = 0.284464
Epoch 4
Loss = 5.1066e-01, PNorm = 34.1717, GNorm = 5.3250, lr_0 = 9.1835e-04
Validation rmse = 0.442800
Epoch 5
Validation rmse = 0.417943
Epoch 6
Loss = 6.0793e-01, PNorm = 34.2079, GNorm = 6.2476, lr_0 = 8.8916e-04
Validation rmse = 0.434683
Epoch 7
Loss = 4.6785e-01, PNorm = 34.2480, GNorm = 4.5529, lr_0 = 8.6089e-04
Validation rmse = 0.441384
Epoch 8
Loss = 4.1829e-01, PNorm = 34.2861, GNorm = 2.6825, lr_0 = 8.3352e-04
Validation rmse = 0.370866
Epoch 9
Loss = 4.7072e-01, PNorm = 34.3157, GNorm = 4.6294, lr_0 = 8.0940e-04
Validation rmse = 0.363828
Epoch 10
Loss = 3.7938e-01, PNorm = 34.3576, GNorm = 1.0019, lr_0 = 7.8367e-04
Loss = 2.6317e-01, PNorm = 34.3598, GNorm = 1.8316, lr_0 = 7.8137e-04
Validation rmse = 0.318339
Epoch 11
Validation rmse = 0.320042
Epoch 12
Loss = 4.5849e-01, PNorm = 34.3894, GNorm = 5.2650, lr_0 = 7.5653e-04
Validation rmse = 0.320161
Epoch 13
Loss = 5.5950e-01, PNorm = 34.4185, GNorm = 9.1152, lr_0 = 7.3463e-04
Validation rmse = 0.362565
Epoch 14
Loss = 4.2226e-01, PNorm = 34.4545, GNorm = 2.3619, lr_0 = 7.1128e-04
Validation rmse = 0.438372
Epoch 15
Loss = 3.6129e-01, PNorm = 34.4909, GNorm = 3.9056, lr_0 = 6.8867e-04
Validation rmse = 0.446777
Epoch 16
Loss = 3.3235e-01, PNorm = 34.5178, GNorm = 2.0124, lr_0 = 6.6678e-04
Validation rmse = 0.465488
Epoch 17
Validation rmse = 0.454224
Epoch 18
Loss = 3.5020e-01, PNorm = 34.5444, GNorm = 1.0837, lr_0 = 6.4558e-04
Validation rmse = 0.399958
Epoch 19
Loss = 3.2498e-01, PNorm = 34.5722, GNorm = 1.3957, lr_0 = 6.2506e-04
Validation rmse = 0.327479
Epoch 20
Loss = 3.7723e-01, PNorm = 34.5975, GNorm = 3.5522, lr_0 = 6.0518e-04
Validation rmse = 0.412471
Epoch 21
Loss = 3.2003e-01, PNorm = 34.6242, GNorm = 4.0519, lr_0 = 5.8767e-04
Validation rmse = 0.393678
Epoch 22
Validation rmse = 0.372027
Epoch 23
Loss = 2.9780e-01, PNorm = 34.6534, GNorm = 2.1511, lr_0 = 5.6732e-04
Validation rmse = 0.435305
Epoch 24
Loss = 3.1531e-01, PNorm = 34.6795, GNorm = 1.7266, lr_0 = 5.4928e-04
Validation rmse = 0.423479
Epoch 25
Loss = 3.0937e-01, PNorm = 34.7034, GNorm = 4.1121, lr_0 = 5.3339e-04
Validation rmse = 0.396106
Epoch 26
Loss = 3.2226e-01, PNorm = 34.7314, GNorm = 1.2319, lr_0 = 5.1643e-04
Validation rmse = 0.479273
Epoch 27
Loss = 3.1539e-01, PNorm = 34.7596, GNorm = 3.3108, lr_0 = 5.0001e-04
Loss = 2.1596e-01, PNorm = 34.7623, GNorm = 1.7431, lr_0 = 4.9854e-04
Validation rmse = 0.465819
Epoch 28
Validation rmse = 0.473057
Epoch 29
Loss = 2.8538e-01, PNorm = 34.7923, GNorm = 4.6762, lr_0 = 4.8270e-04
Validation rmse = 0.360518
Epoch 30
Loss = 2.5650e-01, PNorm = 34.8210, GNorm = 1.5362, lr_0 = 4.6873e-04
Validation rmse = 0.411437
Epoch 31
Loss = 3.3873e-01, PNorm = 34.8511, GNorm = 1.7648, lr_0 = 4.5382e-04
Validation rmse = 0.454197
Epoch 32
Loss = 2.8063e-01, PNorm = 34.8741, GNorm = 1.8320, lr_0 = 4.3940e-04
Validation rmse = 0.509114
Epoch 33
Loss = 3.3674e-01, PNorm = 34.8954, GNorm = 3.1184, lr_0 = 4.2543e-04
Validation rmse = 0.427987
Epoch 34
Validation rmse = 0.380928
Epoch 35
Loss = 2.7576e-01, PNorm = 34.9175, GNorm = 2.8614, lr_0 = 4.1190e-04
Validation rmse = 0.470654
Epoch 36
Loss = 2.1127e-01, PNorm = 34.9391, GNorm = 0.7319, lr_0 = 3.9881e-04
Validation rmse = 0.454673
Epoch 37
Loss = 2.5357e-01, PNorm = 34.9619, GNorm = 1.5252, lr_0 = 3.8613e-04
Validation rmse = 0.454465
Epoch 38
Loss = 2.6707e-01, PNorm = 34.9838, GNorm = 0.7206, lr_0 = 3.7496e-04
Validation rmse = 0.408118
Epoch 39
Validation rmse = 0.431214
Epoch 40
Loss = 2.2117e-01, PNorm = 35.0068, GNorm = 0.7718, lr_0 = 3.6197e-04
Validation rmse = 0.458010
Epoch 41
Loss = 1.9132e-01, PNorm = 35.0283, GNorm = 1.7333, lr_0 = 3.5046e-04
Validation rmse = 0.484580
Epoch 42
Loss = 2.9210e-01, PNorm = 35.0517, GNorm = 1.1579, lr_0 = 3.4032e-04
Validation rmse = 0.441433
Epoch 43
Loss = 2.5847e-01, PNorm = 35.0739, GNorm = 1.5560, lr_0 = 3.2950e-04
Validation rmse = 0.447686
Epoch 44
Loss = 2.4334e-01, PNorm = 35.0961, GNorm = 3.2447, lr_0 = 3.1903e-04
Loss = 3.7170e-01, PNorm = 35.0983, GNorm = 5.2236, lr_0 = 3.1809e-04
Validation rmse = 0.451617
Epoch 45
Validation rmse = 0.342407
Epoch 46
Loss = 2.4841e-01, PNorm = 35.1192, GNorm = 5.3297, lr_0 = 3.0888e-04
Validation rmse = 0.412515
Epoch 47
Loss = 2.3736e-01, PNorm = 35.1425, GNorm = 3.2220, lr_0 = 2.9906e-04
Validation rmse = 0.467297
Epoch 48
Loss = 2.4554e-01, PNorm = 35.1636, GNorm = 2.4906, lr_0 = 2.8956e-04
Validation rmse = 0.457395
Epoch 49
Loss = 2.3622e-01, PNorm = 35.1844, GNorm = 2.4156, lr_0 = 2.8035e-04
Validation rmse = 0.442710
Epoch 50
Loss = 2.3311e-01, PNorm = 35.2017, GNorm = 0.6542, lr_0 = 2.7224e-04
Loss = 5.1350e-02, PNorm = 35.2034, GNorm = 1.8962, lr_0 = 2.7144e-04
Validation rmse = 0.418281
Epoch 51
Validation rmse = 0.439485
Epoch 52
Loss = 2.6338e-01, PNorm = 35.2226, GNorm = 2.3348, lr_0 = 2.6281e-04
Validation rmse = 0.436579
Epoch 53
Loss = 2.5824e-01, PNorm = 35.2416, GNorm = 1.0794, lr_0 = 2.5446e-04
Validation rmse = 0.416138
Epoch 54
Loss = 1.8509e-01, PNorm = 35.2606, GNorm = 1.1535, lr_0 = 2.4637e-04
Validation rmse = 0.413715
Epoch 55
Loss = 2.1963e-01, PNorm = 35.2757, GNorm = 1.0938, lr_0 = 2.3924e-04
Validation rmse = 0.464838
Epoch 56
Validation rmse = 0.426000
Epoch 57
Loss = 2.4852e-01, PNorm = 35.2978, GNorm = 4.4179, lr_0 = 2.3095e-04
Validation rmse = 0.401953
Epoch 58
Loss = 2.0259e-01, PNorm = 35.3170, GNorm = 2.9005, lr_0 = 2.2361e-04
Validation rmse = 0.455462
Epoch 59
Loss = 1.5875e-01, PNorm = 35.3343, GNorm = 1.6097, lr_0 = 2.1714e-04
Validation rmse = 0.448407
Epoch 60
Loss = 2.0945e-01, PNorm = 35.3518, GNorm = 3.0210, lr_0 = 2.1023e-04
Validation rmse = 0.455610
Epoch 61
Loss = 2.0412e-01, PNorm = 35.3688, GNorm = 1.0468, lr_0 = 2.0355e-04
Loss = 2.8914e-01, PNorm = 35.3702, GNorm = 2.1234, lr_0 = 2.0295e-04
Validation rmse = 0.405169
Epoch 62
Validation rmse = 0.452938
Epoch 63
Loss = 1.6803e-01, PNorm = 35.3828, GNorm = 1.8154, lr_0 = 1.9708e-04
Validation rmse = 0.440591
Epoch 64
Loss = 2.0553e-01, PNorm = 35.3975, GNorm = 3.1552, lr_0 = 1.9081e-04
Validation rmse = 0.443571
Epoch 65
Loss = 2.1222e-01, PNorm = 35.4130, GNorm = 2.5814, lr_0 = 1.8475e-04
Validation rmse = 0.435985
Epoch 66
Loss = 2.1164e-01, PNorm = 35.4281, GNorm = 2.7031, lr_0 = 1.7888e-04
Validation rmse = 0.436535
Epoch 67
Loss = 1.9152e-01, PNorm = 35.4399, GNorm = 3.0291, lr_0 = 1.7370e-04
Loss = 1.2769e-01, PNorm = 35.4412, GNorm = 2.4727, lr_0 = 1.7319e-04
Validation rmse = 0.438705
Epoch 68
Validation rmse = 0.442928
Epoch 69
Loss = 1.6479e-01, PNorm = 35.4543, GNorm = 1.4404, lr_0 = 1.6768e-04
Validation rmse = 0.407350
Epoch 70
Loss = 2.0446e-01, PNorm = 35.4676, GNorm = 1.8594, lr_0 = 1.6235e-04
Validation rmse = 0.429357
Epoch 71
Loss = 1.8685e-01, PNorm = 35.4789, GNorm = 2.2634, lr_0 = 1.5765e-04
Validation rmse = 0.446288
Epoch 72
Loss = 1.7835e-01, PNorm = 35.4918, GNorm = 2.2290, lr_0 = 1.5264e-04
Validation rmse = 0.408004
Epoch 73
Validation rmse = 0.456112
Epoch 74
Loss = 3.5857e-01, PNorm = 35.5036, GNorm = 1.4838, lr_0 = 1.4736e-04
Validation rmse = 0.447527
Epoch 75
Loss = 1.6397e-01, PNorm = 35.5141, GNorm = 2.1486, lr_0 = 1.4309e-04
Validation rmse = 0.432253
Epoch 76
Loss = 1.8113e-01, PNorm = 35.5252, GNorm = 0.6983, lr_0 = 1.3854e-04
Validation rmse = 0.439551
Epoch 77
Loss = 1.6767e-01, PNorm = 35.5368, GNorm = 3.5738, lr_0 = 1.3414e-04
Validation rmse = 0.412496
Epoch 78
Loss = 1.8245e-01, PNorm = 35.5472, GNorm = 1.2604, lr_0 = 1.2987e-04
Loss = 7.9963e-02, PNorm = 35.5481, GNorm = 4.4636, lr_0 = 1.2949e-04
Validation rmse = 0.434476
Epoch 79
Validation rmse = 0.453931
Epoch 80
Loss = 1.6495e-01, PNorm = 35.5569, GNorm = 2.2120, lr_0 = 1.2574e-04
Validation rmse = 0.445263
Epoch 81
Loss = 1.9680e-01, PNorm = 35.5672, GNorm = 1.2457, lr_0 = 1.2175e-04
Validation rmse = 0.450434
Epoch 82
Loss = 1.5879e-01, PNorm = 35.5764, GNorm = 1.4706, lr_0 = 1.1788e-04
Validation rmse = 0.448103
Epoch 83
Loss = 1.7221e-01, PNorm = 35.5850, GNorm = 1.7271, lr_0 = 1.1413e-04
Validation rmse = 0.446352
Epoch 84
Loss = 1.6563e-01, PNorm = 35.5925, GNorm = 1.5834, lr_0 = 1.1083e-04
Loss = 2.1238e-01, PNorm = 35.5934, GNorm = 3.7931, lr_0 = 1.1050e-04
Validation rmse = 0.449165
Epoch 85
Validation rmse = 0.438862
Epoch 86
Loss = 1.3144e-01, PNorm = 35.6023, GNorm = 1.5336, lr_0 = 1.0699e-04
Validation rmse = 0.464774
Epoch 87
Loss = 1.7323e-01, PNorm = 35.6106, GNorm = 1.8805, lr_0 = 1.0359e-04
Validation rmse = 0.439345
Epoch 88
Loss = 1.7960e-01, PNorm = 35.6173, GNorm = 0.9766, lr_0 = 1.0059e-04
Validation rmse = 0.441609
Epoch 89
Loss = 1.6461e-01, PNorm = 35.6241, GNorm = 1.1719, lr_0 = 1.0000e-04
Validation rmse = 0.455442
Epoch 90
Validation rmse = 0.466595
Epoch 91
Loss = 9.2749e-02, PNorm = 35.6329, GNorm = 2.4790, lr_0 = 1.0000e-04
Validation rmse = 0.420218
Epoch 92
Loss = 1.3574e-01, PNorm = 35.6404, GNorm = 1.9304, lr_0 = 1.0000e-04
Validation rmse = 0.466102
Epoch 93
Loss = 1.9475e-01, PNorm = 35.6483, GNorm = 4.0562, lr_0 = 1.0000e-04
Validation rmse = 0.443715
Epoch 94
Loss = 1.5930e-01, PNorm = 35.6561, GNorm = 0.9034, lr_0 = 1.0000e-04
Validation rmse = 0.434689
Epoch 95
Loss = 1.5215e-01, PNorm = 35.6629, GNorm = 1.1008, lr_0 = 1.0000e-04
Validation rmse = 0.467322
Epoch 96
Validation rmse = 0.446914
Epoch 97
Loss = 2.2867e-01, PNorm = 35.6705, GNorm = 1.4735, lr_0 = 1.0000e-04
Validation rmse = 0.432811
Epoch 98
Loss = 1.4892e-01, PNorm = 35.6780, GNorm = 1.6370, lr_0 = 1.0000e-04
Validation rmse = 0.454683
Epoch 99
Loss = 1.6571e-01, PNorm = 35.6863, GNorm = 1.2365, lr_0 = 1.0000e-04
Validation rmse = 0.463733
Model 0 best validation rmse = 0.266817 on epoch 1
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.331537
Ensemble test rmse = 0.331537
1-fold cross validation
	Seed 0 ==> test rmse = 0.331537
Overall test rmse = 0.331537 +/- 0.000000
Elapsed time = 0:00:30
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 100,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 409 | train size = 404 | val size = 2 | test size = 3
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.327456
Epoch 1
Loss = 6.5637e-01, PNorm = 34.0246, GNorm = 2.5561, lr_0 = 7.7500e-04
Validation rmse = 0.264206
Epoch 2
Loss = 9.2380e-01, PNorm = 34.0642, GNorm = 9.5172, lr_0 = 9.7965e-04
Validation rmse = 0.180471
Epoch 3
Loss = 5.9702e-01, PNorm = 34.1063, GNorm = 3.0801, lr_0 = 9.4851e-04
Validation rmse = 0.283445
Epoch 4
Loss = 5.1018e-01, PNorm = 34.1522, GNorm = 5.1388, lr_0 = 9.1835e-04
Loss = 3.4088e-01, PNorm = 34.1559, GNorm = 7.3520, lr_0 = 9.1566e-04
Validation rmse = 0.237256
Epoch 5
Validation rmse = 0.273246
Epoch 6
Loss = 3.8818e-01, PNorm = 34.1959, GNorm = 0.8038, lr_0 = 8.8655e-04
Validation rmse = 0.196163
Epoch 7
Loss = 4.5807e-01, PNorm = 34.2309, GNorm = 8.7271, lr_0 = 8.5837e-04
Validation rmse = 0.187109
Epoch 8
Loss = 4.0741e-01, PNorm = 34.2585, GNorm = 3.1245, lr_0 = 8.3108e-04
Validation rmse = 0.155392
Epoch 9
Loss = 4.7727e-01, PNorm = 34.2813, GNorm = 7.7944, lr_0 = 8.0466e-04
Loss = 3.2911e-01, PNorm = 34.2839, GNorm = 6.7748, lr_0 = 8.0230e-04
Validation rmse = 0.303666
Epoch 10
Validation rmse = 0.343569
Epoch 11
Loss = 3.8025e-01, PNorm = 34.3122, GNorm = 4.6498, lr_0 = 7.7679e-04
Validation rmse = 0.298013
Epoch 12
Loss = 3.4691e-01, PNorm = 34.3386, GNorm = 1.8633, lr_0 = 7.5210e-04
Validation rmse = 0.348646
Epoch 13
Loss = 3.9842e-01, PNorm = 34.3637, GNorm = 3.9307, lr_0 = 7.3033e-04
Validation rmse = 0.329561
Epoch 14
Loss = 3.5350e-01, PNorm = 34.3932, GNorm = 4.3375, lr_0 = 7.0711e-04
Validation rmse = 0.345683
Epoch 15
Validation rmse = 0.183878
Epoch 16
Loss = 4.6061e-01, PNorm = 34.4229, GNorm = 5.4182, lr_0 = 6.8263e-04
Validation rmse = 0.231312
Epoch 17
Loss = 3.2405e-01, PNorm = 34.4495, GNorm = 2.9942, lr_0 = 6.6093e-04
Validation rmse = 0.327958
Epoch 18
Loss = 3.3885e-01, PNorm = 34.4790, GNorm = 2.2834, lr_0 = 6.3992e-04
Validation rmse = 0.279730
Epoch 19
Loss = 3.3223e-01, PNorm = 34.5034, GNorm = 0.6841, lr_0 = 6.1957e-04
Validation rmse = 0.232031
Epoch 20
Validation rmse = 0.195843
Epoch 21
Loss = 2.1487e-01, PNorm = 34.5320, GNorm = 3.3670, lr_0 = 5.9812e-04
Validation rmse = 0.306537
Epoch 22
Loss = 3.4755e-01, PNorm = 34.5533, GNorm = 2.6706, lr_0 = 5.7910e-04
Validation rmse = 0.236970
Epoch 23
Loss = 3.2803e-01, PNorm = 34.5810, GNorm = 0.6917, lr_0 = 5.6069e-04
Validation rmse = 0.297039
Epoch 24
Loss = 2.9393e-01, PNorm = 34.6065, GNorm = 0.7811, lr_0 = 5.4287e-04
Validation rmse = 0.266997
Epoch 25
Loss = 3.6856e-01, PNorm = 34.6245, GNorm = 3.3188, lr_0 = 5.2716e-04
Loss = 8.5871e-02, PNorm = 34.6267, GNorm = 3.5726, lr_0 = 5.2561e-04
Validation rmse = 0.126713
Epoch 26
Validation rmse = 0.378972
Epoch 27
Loss = 5.5184e-01, PNorm = 34.6522, GNorm = 3.6721, lr_0 = 5.0890e-04
Validation rmse = 0.212945
Epoch 28
Loss = 3.7235e-01, PNorm = 34.6850, GNorm = 6.7290, lr_0 = 4.9272e-04
Validation rmse = 0.190883
Epoch 29
Loss = 3.1177e-01, PNorm = 34.7126, GNorm = 1.7031, lr_0 = 4.7706e-04
Validation rmse = 0.279130
Epoch 30
Loss = 3.1346e-01, PNorm = 34.7359, GNorm = 1.8099, lr_0 = 4.6189e-04
Loss = 3.4204e-01, PNorm = 34.7383, GNorm = 3.2503, lr_0 = 4.6054e-04
Validation rmse = 0.275306
Epoch 31
Validation rmse = 0.214566
Epoch 32
Loss = 2.9170e-01, PNorm = 34.7643, GNorm = 1.1355, lr_0 = 4.4590e-04
Validation rmse = 0.226808
Epoch 33
Loss = 2.7952e-01, PNorm = 34.7812, GNorm = 2.1005, lr_0 = 4.3172e-04
Validation rmse = 0.285114
Epoch 34
Loss = 2.8177e-01, PNorm = 34.8046, GNorm = 1.4205, lr_0 = 4.1800e-04
Validation rmse = 0.199011
Epoch 35
Loss = 3.0807e-01, PNorm = 34.8275, GNorm = 1.9263, lr_0 = 4.0471e-04
Loss = 1.2422e-01, PNorm = 34.8299, GNorm = 1.9425, lr_0 = 4.0352e-04
Validation rmse = 0.195839
Epoch 36
Validation rmse = 0.277757
Epoch 37
Loss = 3.3718e-01, PNorm = 34.8532, GNorm = 1.3010, lr_0 = 3.9069e-04
Validation rmse = 0.223612
Epoch 38
Loss = 2.9899e-01, PNorm = 34.8704, GNorm = 1.6472, lr_0 = 3.7939e-04
Validation rmse = 0.252899
Epoch 39
Loss = 2.5290e-01, PNorm = 34.8911, GNorm = 3.4177, lr_0 = 3.6733e-04
Validation rmse = 0.216928
Epoch 40
Loss = 2.6084e-01, PNorm = 34.9109, GNorm = 2.3408, lr_0 = 3.5565e-04
Validation rmse = 0.199338
Epoch 41
Validation rmse = 0.258190
Epoch 42
Loss = 1.8735e-01, PNorm = 34.9271, GNorm = 0.9712, lr_0 = 3.4333e-04
Validation rmse = 0.207175
Epoch 43
Loss = 2.1262e-01, PNorm = 34.9441, GNorm = 3.6906, lr_0 = 3.3242e-04
Validation rmse = 0.212836
Epoch 44
Loss = 3.2601e-01, PNorm = 34.9576, GNorm = 4.4411, lr_0 = 3.2185e-04
Validation rmse = 0.226794
Epoch 45
Loss = 2.5614e-01, PNorm = 34.9735, GNorm = 1.7906, lr_0 = 3.1162e-04
Validation rmse = 0.211630
Epoch 46
Validation rmse = 0.208804
Epoch 47
Loss = 4.1462e-01, PNorm = 34.9945, GNorm = 0.9316, lr_0 = 3.0083e-04
Validation rmse = 0.281718
Epoch 48
Loss = 3.2128e-01, PNorm = 35.0127, GNorm = 0.9533, lr_0 = 2.9126e-04
Validation rmse = 0.198349
Epoch 49
Loss = 2.5600e-01, PNorm = 35.0271, GNorm = 1.2606, lr_0 = 2.8200e-04
Validation rmse = 0.217567
Epoch 50
Loss = 2.5473e-01, PNorm = 35.0416, GNorm = 0.9174, lr_0 = 2.7384e-04
Validation rmse = 0.197760
Epoch 51
Loss = 2.3067e-01, PNorm = 35.0571, GNorm = 0.6856, lr_0 = 2.6514e-04
Loss = 9.2583e-01, PNorm = 35.0582, GNorm = 6.9736, lr_0 = 2.6436e-04
Validation rmse = 0.208727
Epoch 52
Validation rmse = 0.213211
Epoch 53
Loss = 2.6787e-01, PNorm = 35.0761, GNorm = 1.2618, lr_0 = 2.5595e-04
Validation rmse = 0.261728
Epoch 54
Loss = 2.4412e-01, PNorm = 35.0943, GNorm = 2.6044, lr_0 = 2.4782e-04
Validation rmse = 0.208951
Epoch 55
Loss = 2.4605e-01, PNorm = 35.1121, GNorm = 1.1569, lr_0 = 2.3994e-04
Validation rmse = 0.226042
Epoch 56
Loss = 2.3272e-01, PNorm = 35.1276, GNorm = 0.9257, lr_0 = 2.3231e-04
Loss = 1.3863e-01, PNorm = 35.1288, GNorm = 4.5877, lr_0 = 2.3163e-04
Validation rmse = 0.202322
Epoch 57
Validation rmse = 0.209185
Epoch 58
Loss = 1.5390e-01, PNorm = 35.1426, GNorm = 0.5981, lr_0 = 2.2427e-04
Validation rmse = 0.194009
Epoch 59
Loss = 2.0544e-01, PNorm = 35.1566, GNorm = 1.6572, lr_0 = 2.1714e-04
Validation rmse = 0.219191
Epoch 60
Loss = 2.2216e-01, PNorm = 35.1694, GNorm = 2.1151, lr_0 = 2.1023e-04
Validation rmse = 0.176703
Epoch 61
Loss = 2.4754e-01, PNorm = 35.1804, GNorm = 1.7638, lr_0 = 2.0355e-04
Loss = 1.3694e-01, PNorm = 35.1813, GNorm = 2.7632, lr_0 = 2.0295e-04
Validation rmse = 0.241052
Epoch 62
Validation rmse = 0.172228
Epoch 63
Loss = 2.7133e-01, PNorm = 35.1918, GNorm = 1.3877, lr_0 = 1.9708e-04
Validation rmse = 0.212433
Epoch 64
Loss = 1.9190e-01, PNorm = 35.2049, GNorm = 0.8945, lr_0 = 1.9081e-04
Validation rmse = 0.210727
Epoch 65
Loss = 2.5090e-01, PNorm = 35.2183, GNorm = 4.3212, lr_0 = 1.8475e-04
Validation rmse = 0.226238
Epoch 66
Loss = 2.2023e-01, PNorm = 35.2304, GNorm = 2.2909, lr_0 = 1.7888e-04
Validation rmse = 0.195942
Epoch 67
Validation rmse = 0.214988
Epoch 68
Loss = 1.3705e-01, PNorm = 35.2434, GNorm = 0.7825, lr_0 = 1.7268e-04
Validation rmse = 0.184648
Epoch 69
Loss = 2.0203e-01, PNorm = 35.2537, GNorm = 0.9530, lr_0 = 1.6719e-04
Validation rmse = 0.211503
Epoch 70
Loss = 2.1511e-01, PNorm = 35.2636, GNorm = 3.0050, lr_0 = 1.6188e-04
Validation rmse = 0.225675
Epoch 71
Loss = 2.2409e-01, PNorm = 35.2732, GNorm = 1.7819, lr_0 = 1.5673e-04
Validation rmse = 0.185105
Epoch 72
Validation rmse = 0.214482
Epoch 73
Loss = 1.4769e-01, PNorm = 35.2836, GNorm = 1.0313, lr_0 = 1.5130e-04
Validation rmse = 0.191543
Epoch 74
Loss = 1.7799e-01, PNorm = 35.2934, GNorm = 2.3887, lr_0 = 1.4649e-04
Validation rmse = 0.212987
Epoch 75
Loss = 2.0049e-01, PNorm = 35.3026, GNorm = 1.2035, lr_0 = 1.4225e-04
Validation rmse = 0.192157
Epoch 76
Loss = 2.0335e-01, PNorm = 35.3137, GNorm = 1.2448, lr_0 = 1.3773e-04
Validation rmse = 0.196697
Epoch 77
Loss = 1.9707e-01, PNorm = 35.3240, GNorm = 1.2775, lr_0 = 1.3335e-04
Loss = 5.7340e-01, PNorm = 35.3251, GNorm = 6.9593, lr_0 = 1.3296e-04
Validation rmse = 0.184901
Epoch 78
Validation rmse = 0.213563
Epoch 79
Loss = 2.1607e-01, PNorm = 35.3354, GNorm = 2.2194, lr_0 = 1.2873e-04
Validation rmse = 0.190151
Epoch 80
Loss = 1.9253e-01, PNorm = 35.3442, GNorm = 0.8241, lr_0 = 1.2464e-04
Validation rmse = 0.207197
Epoch 81
Loss = 1.9495e-01, PNorm = 35.3530, GNorm = 1.2672, lr_0 = 1.2068e-04
Validation rmse = 0.211526
Epoch 82
Loss = 1.9785e-01, PNorm = 35.3620, GNorm = 1.6813, lr_0 = 1.1684e-04
Loss = 1.6232e-02, PNorm = 35.3627, GNorm = 0.9011, lr_0 = 1.1650e-04
Validation rmse = 0.221007
Epoch 83
Validation rmse = 0.185139
Epoch 84
Loss = 1.7182e-01, PNorm = 35.3706, GNorm = 1.4434, lr_0 = 1.1280e-04
Validation rmse = 0.224659
Epoch 85
Loss = 2.3589e-01, PNorm = 35.3768, GNorm = 6.0399, lr_0 = 1.0921e-04
Validation rmse = 0.186403
Epoch 86
Loss = 2.0962e-01, PNorm = 35.3842, GNorm = 2.0894, lr_0 = 1.0574e-04
Validation rmse = 0.202314
Epoch 87
Loss = 1.9056e-01, PNorm = 35.3902, GNorm = 0.9541, lr_0 = 1.0238e-04
Validation rmse = 0.185757
Epoch 88
Validation rmse = 0.191469
Epoch 89
Loss = 2.4106e-01, PNorm = 35.3971, GNorm = 1.3520, lr_0 = 1.0000e-04
Validation rmse = 0.195619
Epoch 90
Loss = 1.8067e-01, PNorm = 35.4036, GNorm = 2.5268, lr_0 = 1.0000e-04
Validation rmse = 0.196707
Epoch 91
Loss = 1.9828e-01, PNorm = 35.4087, GNorm = 3.3758, lr_0 = 1.0000e-04
Validation rmse = 0.183344
Epoch 92
Loss = 2.1508e-01, PNorm = 35.4144, GNorm = 4.3443, lr_0 = 1.0000e-04
Validation rmse = 0.207852
Epoch 93
Validation rmse = 0.191823
Epoch 94
Loss = 1.0816e-01, PNorm = 35.4212, GNorm = 0.5577, lr_0 = 1.0000e-04
Validation rmse = 0.210000
Epoch 95
Loss = 2.3132e-01, PNorm = 35.4271, GNorm = 3.8559, lr_0 = 1.0000e-04
Validation rmse = 0.202485
Epoch 96
Loss = 1.6853e-01, PNorm = 35.4342, GNorm = 1.1475, lr_0 = 1.0000e-04
Validation rmse = 0.184515
Epoch 97
Loss = 1.8003e-01, PNorm = 35.4408, GNorm = 1.5926, lr_0 = 1.0000e-04
Validation rmse = 0.195275
Epoch 98
Validation rmse = 0.187864
Epoch 99
Loss = 1.5928e-01, PNorm = 35.4484, GNorm = 1.5284, lr_0 = 1.0000e-04
Validation rmse = 0.185114
Model 0 best validation rmse = 0.126713 on epoch 25
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.127475
Ensemble test rmse = 0.127475
1-fold cross validation
	Seed 0 ==> test rmse = 0.127475
Overall test rmse = 0.127475 +/- 0.000000
Elapsed time = 0:00:30
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 100,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 401 | train size = 396 | val size = 2 | test size = 3
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.335519
Epoch 1
Loss = 6.5462e-01, PNorm = 34.0314, GNorm = 1.1689, lr_0 = 8.7143e-04
Validation rmse = 0.304127
Epoch 2
Loss = 4.8678e-01, PNorm = 34.0905, GNorm = 10.9498, lr_0 = 9.7351e-04
Validation rmse = 0.293360
Epoch 3
Loss = 4.9645e-01, PNorm = 34.1361, GNorm = 6.1332, lr_0 = 9.4137e-04
Validation rmse = 0.305563
Epoch 4
Validation rmse = 0.287068
Epoch 5
Loss = 4.5719e-01, PNorm = 34.1704, GNorm = 5.0042, lr_0 = 9.1030e-04
Validation rmse = 0.317925
Epoch 6
Loss = 3.9154e-01, PNorm = 34.2030, GNorm = 1.1772, lr_0 = 8.8025e-04
Validation rmse = 0.306030
Epoch 7
Loss = 3.9885e-01, PNorm = 34.2347, GNorm = 8.4099, lr_0 = 8.5120e-04
Validation rmse = 0.323995
Epoch 8
Loss = 3.7835e-01, PNorm = 34.2697, GNorm = 9.3816, lr_0 = 8.2310e-04
Validation rmse = 0.291940
Epoch 9
Validation rmse = 0.303488
Epoch 10
Loss = 3.8038e-01, PNorm = 34.3005, GNorm = 1.4933, lr_0 = 7.9593e-04
Validation rmse = 0.311315
Epoch 11
Loss = 3.4257e-01, PNorm = 34.3303, GNorm = 1.9684, lr_0 = 7.6966e-04
Validation rmse = 0.290228
Epoch 12
Loss = 3.5285e-01, PNorm = 34.3579, GNorm = 2.8825, lr_0 = 7.4425e-04
Validation rmse = 0.317981
Epoch 13
Loss = 3.1165e-01, PNorm = 34.3885, GNorm = 3.3455, lr_0 = 7.1727e-04
Validation rmse = 0.312632
Epoch 14
Validation rmse = 0.312732
Epoch 15
Loss = 3.8976e-01, PNorm = 34.4183, GNorm = 1.7376, lr_0 = 6.9360e-04
Validation rmse = 0.283653
Epoch 16
Loss = 2.6515e-01, PNorm = 34.4478, GNorm = 3.3216, lr_0 = 6.7070e-04
Validation rmse = 0.280561
Epoch 17
Loss = 2.8965e-01, PNorm = 34.4756, GNorm = 4.0446, lr_0 = 6.4856e-04
Validation rmse = 0.284331
Epoch 18
Loss = 2.7804e-01, PNorm = 34.5036, GNorm = 3.1231, lr_0 = 6.2716e-04
Validation rmse = 0.283840
Epoch 19
Validation rmse = 0.285218
Epoch 20
Loss = 2.3448e-01, PNorm = 34.5323, GNorm = 1.3801, lr_0 = 6.0646e-04
Validation rmse = 0.292159
Epoch 21
Loss = 2.6283e-01, PNorm = 34.5605, GNorm = 5.7129, lr_0 = 5.8644e-04
Validation rmse = 0.269446
Epoch 22
Loss = 2.5896e-01, PNorm = 34.5884, GNorm = 4.3823, lr_0 = 5.6708e-04
Validation rmse = 0.282399
Epoch 23
Loss = 2.6347e-01, PNorm = 34.6178, GNorm = 9.7625, lr_0 = 5.4836e-04
Validation rmse = 0.274063
Epoch 24
Validation rmse = 0.287445
Epoch 25
Loss = 2.4695e-01, PNorm = 34.6457, GNorm = 2.2515, lr_0 = 5.3026e-04
Validation rmse = 0.274266
Epoch 26
Loss = 2.0856e-01, PNorm = 34.6776, GNorm = 1.4551, lr_0 = 5.1104e-04
Validation rmse = 0.278065
Epoch 27
Loss = 2.6802e-01, PNorm = 34.7037, GNorm = 5.9268, lr_0 = 4.9417e-04
Validation rmse = 0.269234
Epoch 28
Validation rmse = 0.267850
Epoch 29
Loss = 2.2963e-01, PNorm = 34.7314, GNorm = 0.6619, lr_0 = 4.7786e-04
Validation rmse = 0.274984
Epoch 30
Loss = 2.0876e-01, PNorm = 34.7602, GNorm = 5.0649, lr_0 = 4.6209e-04
Validation rmse = 0.272133
Epoch 31
Loss = 2.0915e-01, PNorm = 34.7863, GNorm = 1.1372, lr_0 = 4.4683e-04
Validation rmse = 0.270266
Epoch 32
Loss = 2.1870e-01, PNorm = 34.8122, GNorm = 3.3524, lr_0 = 4.3208e-04
Validation rmse = 0.288360
Epoch 33
Validation rmse = 0.276252
Epoch 34
Loss = 2.1735e-01, PNorm = 34.8396, GNorm = 4.3999, lr_0 = 4.1782e-04
Validation rmse = 0.273634
Epoch 35
Loss = 2.0631e-01, PNorm = 34.8680, GNorm = 1.1858, lr_0 = 4.0403e-04
Validation rmse = 0.279570
Epoch 36
Loss = 2.0681e-01, PNorm = 34.8938, GNorm = 0.7521, lr_0 = 3.9069e-04
Validation rmse = 0.261382
Epoch 37
Loss = 1.8868e-01, PNorm = 34.9201, GNorm = 0.7321, lr_0 = 3.7780e-04
Loss = 3.2619e-01, PNorm = 34.9227, GNorm = 2.4927, lr_0 = 3.7653e-04
Validation rmse = 0.269987
Epoch 38
Validation rmse = 0.262533
Epoch 39
Loss = 2.0447e-01, PNorm = 34.9482, GNorm = 3.3161, lr_0 = 3.6410e-04
Validation rmse = 0.264059
Epoch 40
Loss = 1.9809e-01, PNorm = 34.9724, GNorm = 1.6091, lr_0 = 3.5208e-04
Validation rmse = 0.274736
Epoch 41
Loss = 2.0868e-01, PNorm = 34.9972, GNorm = 1.6662, lr_0 = 3.4046e-04
Validation rmse = 0.263838
Epoch 42
Loss = 1.9415e-01, PNorm = 35.0206, GNorm = 2.6689, lr_0 = 3.2922e-04
Validation rmse = 0.264497
Epoch 43
Validation rmse = 0.268658
Epoch 44
Loss = 2.1148e-01, PNorm = 35.0441, GNorm = 5.3825, lr_0 = 3.1836e-04
Validation rmse = 0.264016
Epoch 45
Loss = 1.8470e-01, PNorm = 35.0670, GNorm = 0.7710, lr_0 = 3.0785e-04
Validation rmse = 0.260927
Epoch 46
Loss = 1.8735e-01, PNorm = 35.0895, GNorm = 0.9688, lr_0 = 2.9769e-04
Validation rmse = 0.248989
Epoch 47
Loss = 1.7674e-01, PNorm = 35.1107, GNorm = 0.7964, lr_0 = 2.8786e-04
Validation rmse = 0.259378
Epoch 48
Validation rmse = 0.266245
Epoch 49
Loss = 1.4538e-01, PNorm = 35.1302, GNorm = 1.3700, lr_0 = 2.7836e-04
Validation rmse = 0.260074
Epoch 50
Loss = 2.3859e-01, PNorm = 35.1495, GNorm = 5.2333, lr_0 = 2.6917e-04
Validation rmse = 0.268743
Epoch 51
Loss = 1.9191e-01, PNorm = 35.1720, GNorm = 3.7653, lr_0 = 2.5941e-04
Validation rmse = 0.274483
Epoch 52
Validation rmse = 0.257463
Epoch 53
Loss = 1.5570e-01, PNorm = 35.1909, GNorm = 0.7985, lr_0 = 2.5085e-04
Validation rmse = 0.249024
Epoch 54
Loss = 1.6982e-01, PNorm = 35.2082, GNorm = 3.5615, lr_0 = 2.4257e-04
Validation rmse = 0.251551
Epoch 55
Loss = 1.4814e-01, PNorm = 35.2254, GNorm = 0.9494, lr_0 = 2.3456e-04
Validation rmse = 0.249846
Epoch 56
Loss = 1.6134e-01, PNorm = 35.2432, GNorm = 3.4889, lr_0 = 2.2682e-04
Validation rmse = 0.255838
Epoch 57
Validation rmse = 0.257116
Epoch 58
Loss = 1.3058e-01, PNorm = 35.2590, GNorm = 3.4627, lr_0 = 2.1933e-04
Validation rmse = 0.258666
Epoch 59
Loss = 1.7997e-01, PNorm = 35.2762, GNorm = 4.4921, lr_0 = 2.1210e-04
Validation rmse = 0.253349
Epoch 60
Loss = 1.6142e-01, PNorm = 35.2917, GNorm = 2.3171, lr_0 = 2.0509e-04
Validation rmse = 0.244151
Epoch 61
Loss = 1.6859e-01, PNorm = 35.3071, GNorm = 1.0158, lr_0 = 1.9832e-04
Validation rmse = 0.258549
Epoch 62
Validation rmse = 0.252344
Epoch 63
Loss = 1.1712e-01, PNorm = 35.3234, GNorm = 1.7754, lr_0 = 1.9114e-04
Validation rmse = 0.259451
Epoch 64
Loss = 1.5492e-01, PNorm = 35.3374, GNorm = 1.2993, lr_0 = 1.8483e-04
Validation rmse = 0.255031
Epoch 65
Loss = 1.5946e-01, PNorm = 35.3514, GNorm = 0.6514, lr_0 = 1.7873e-04
Validation rmse = 0.261323
Epoch 66
Loss = 1.6061e-01, PNorm = 35.3640, GNorm = 3.3093, lr_0 = 1.7283e-04
Validation rmse = 0.253727
Epoch 67
Validation rmse = 0.252264
Epoch 68
Loss = 1.6788e-01, PNorm = 35.3765, GNorm = 0.6782, lr_0 = 1.6712e-04
Validation rmse = 0.251804
Epoch 69
Loss = 1.7247e-01, PNorm = 35.3885, GNorm = 1.3293, lr_0 = 1.6161e-04
Validation rmse = 0.256603
Epoch 70
Loss = 1.5998e-01, PNorm = 35.4006, GNorm = 0.9637, lr_0 = 1.5627e-04
Validation rmse = 0.250363
Epoch 71
Loss = 1.4885e-01, PNorm = 35.4127, GNorm = 1.4708, lr_0 = 1.5111e-04
Validation rmse = 0.248645
Epoch 72
Validation rmse = 0.250891
Epoch 73
Loss = 1.9437e-01, PNorm = 35.4242, GNorm = 5.0084, lr_0 = 1.4612e-04
Validation rmse = 0.251762
Epoch 74
Loss = 1.7330e-01, PNorm = 35.4353, GNorm = 7.0965, lr_0 = 1.4130e-04
Validation rmse = 0.249374
Epoch 75
Loss = 1.6964e-01, PNorm = 35.4462, GNorm = 2.8040, lr_0 = 1.3664e-04
Validation rmse = 0.246466
Epoch 76
Validation rmse = 0.246508
Epoch 77
Loss = 1.4090e-01, PNorm = 35.4570, GNorm = 0.7903, lr_0 = 1.3168e-04
Validation rmse = 0.247019
Epoch 78
Loss = 1.6078e-01, PNorm = 35.4661, GNorm = 3.8348, lr_0 = 1.2734e-04
Validation rmse = 0.248524
Epoch 79
Loss = 1.5061e-01, PNorm = 35.4752, GNorm = 4.9939, lr_0 = 1.2313e-04
Validation rmse = 0.245104
Epoch 80
Loss = 1.5035e-01, PNorm = 35.4836, GNorm = 2.5418, lr_0 = 1.1907e-04
Validation rmse = 0.250498
Epoch 81
Validation rmse = 0.245730
Epoch 82
Loss = 1.2100e-01, PNorm = 35.4921, GNorm = 0.7981, lr_0 = 1.1514e-04
Validation rmse = 0.247270
Epoch 83
Loss = 9.7461e-02, PNorm = 35.5011, GNorm = 2.2223, lr_0 = 1.1134e-04
Validation rmse = 0.247317
Epoch 84
Loss = 1.3876e-01, PNorm = 35.5093, GNorm = 2.8317, lr_0 = 1.0766e-04
Validation rmse = 0.244114
Epoch 85
Loss = 1.4105e-01, PNorm = 35.5171, GNorm = 1.3629, lr_0 = 1.0411e-04
Validation rmse = 0.244459
Epoch 86
Validation rmse = 0.246559
Epoch 87
Loss = 1.3363e-01, PNorm = 35.5242, GNorm = 1.6203, lr_0 = 1.0067e-04
Validation rmse = 0.245367
Epoch 88
Loss = 1.1735e-01, PNorm = 35.5319, GNorm = 1.2705, lr_0 = 1.0000e-04
Validation rmse = 0.246928
Epoch 89
Loss = 1.4171e-01, PNorm = 35.5393, GNorm = 2.7470, lr_0 = 1.0000e-04
Validation rmse = 0.245085
Epoch 90
Loss = 1.3362e-01, PNorm = 35.5472, GNorm = 0.9448, lr_0 = 1.0000e-04
Validation rmse = 0.243938
Epoch 91
Validation rmse = 0.250209
Epoch 92
Loss = 1.0490e-01, PNorm = 35.5544, GNorm = 1.2956, lr_0 = 1.0000e-04
Validation rmse = 0.245195
Epoch 93
Loss = 1.2532e-01, PNorm = 35.5614, GNorm = 1.9764, lr_0 = 1.0000e-04
Validation rmse = 0.244928
Epoch 94
Loss = 1.3383e-01, PNorm = 35.5696, GNorm = 0.9345, lr_0 = 1.0000e-04
Validation rmse = 0.244377
Epoch 95
Loss = 1.2898e-01, PNorm = 35.5767, GNorm = 1.5516, lr_0 = 1.0000e-04
Validation rmse = 0.244149
Epoch 96
Validation rmse = 0.243778
Epoch 97
Loss = 1.3823e-01, PNorm = 35.5839, GNorm = 5.1092, lr_0 = 1.0000e-04
Validation rmse = 0.244152
Epoch 98
Loss = 1.4566e-01, PNorm = 35.5914, GNorm = 1.7578, lr_0 = 1.0000e-04
Validation rmse = 0.245785
Epoch 99
Loss = 1.2159e-01, PNorm = 35.5995, GNorm = 1.0067, lr_0 = 1.0000e-04
Validation rmse = 0.242732
Model 0 best validation rmse = 0.242732 on epoch 99
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.062089
Ensemble test rmse = 0.062089
1-fold cross validation
	Seed 0 ==> test rmse = 0.062089
Overall test rmse = 0.062089 +/- 0.000000
Elapsed time = 0:00:30
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 100,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 393 | train size = 389 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.133347
Epoch 1
Loss = 8.5312e-01, PNorm = 34.0258, GNorm = 8.5821, lr_0 = 8.7143e-04
Validation rmse = 0.323674
Epoch 2
Loss = 6.1082e-01, PNorm = 34.0798, GNorm = 10.6910, lr_0 = 9.7351e-04
Validation rmse = 0.184972
Epoch 3
Loss = 4.8320e-01, PNorm = 34.1232, GNorm = 3.7471, lr_0 = 9.4137e-04
Validation rmse = 0.231713
Epoch 4
Validation rmse = 0.258660
Epoch 5
Loss = 3.1144e-01, PNorm = 34.1749, GNorm = 0.9830, lr_0 = 9.0725e-04
Validation rmse = 0.204759
Epoch 6
Loss = 3.8232e-01, PNorm = 34.2139, GNorm = 10.9028, lr_0 = 8.7730e-04
Validation rmse = 0.255063
Epoch 7
Loss = 3.3319e-01, PNorm = 34.2496, GNorm = 1.8579, lr_0 = 8.4834e-04
Validation rmse = 0.237705
Epoch 8
Loss = 3.4953e-01, PNorm = 34.2828, GNorm = 3.7617, lr_0 = 8.2034e-04
Validation rmse = 0.260520
Epoch 9
Validation rmse = 0.249259
Epoch 10
Loss = 3.2242e-01, PNorm = 34.3197, GNorm = 2.3598, lr_0 = 7.9060e-04
Validation rmse = 0.242649
Epoch 11
Loss = 2.6262e-01, PNorm = 34.3512, GNorm = 2.2514, lr_0 = 7.6451e-04
Validation rmse = 0.306444
Epoch 12
Loss = 2.7913e-01, PNorm = 34.3816, GNorm = 3.0441, lr_0 = 7.3927e-04
Validation rmse = 0.281038
Epoch 13
Validation rmse = 0.267841
Epoch 14
Loss = 2.9285e-01, PNorm = 34.4124, GNorm = 2.2738, lr_0 = 7.1248e-04
Validation rmse = 0.309682
Epoch 15
Loss = 2.6854e-01, PNorm = 34.4437, GNorm = 6.3001, lr_0 = 6.8896e-04
Validation rmse = 0.307190
Epoch 16
Loss = 2.9935e-01, PNorm = 34.4720, GNorm = 2.4344, lr_0 = 6.6622e-04
Validation rmse = 0.258954
Epoch 17
Loss = 2.3483e-01, PNorm = 34.5017, GNorm = 3.0992, lr_0 = 6.4423e-04
Validation rmse = 0.236520
Epoch 18
Validation rmse = 0.253511
Epoch 19
Loss = 2.3082e-01, PNorm = 34.5358, GNorm = 4.3938, lr_0 = 6.2087e-04
Validation rmse = 0.271716
Epoch 20
Loss = 2.7347e-01, PNorm = 34.5629, GNorm = 5.2465, lr_0 = 6.0038e-04
Validation rmse = 0.256170
Epoch 21
Loss = 2.3335e-01, PNorm = 34.5907, GNorm = 0.6192, lr_0 = 5.8056e-04
Validation rmse = 0.242176
Epoch 22
Validation rmse = 0.249992
Epoch 23
Loss = 1.8741e-01, PNorm = 34.6233, GNorm = 3.8766, lr_0 = 5.5952e-04
Validation rmse = 0.256674
Epoch 24
Loss = 2.0049e-01, PNorm = 34.6489, GNorm = 3.4467, lr_0 = 5.4105e-04
Validation rmse = 0.232554
Epoch 25
Loss = 2.0619e-01, PNorm = 34.6756, GNorm = 2.5296, lr_0 = 5.2319e-04
Validation rmse = 0.216297
Epoch 26
Loss = 2.0636e-01, PNorm = 34.7046, GNorm = 1.1432, lr_0 = 5.0592e-04
Validation rmse = 0.258108
Epoch 27
Validation rmse = 0.222441
Epoch 28
Loss = 1.8314e-01, PNorm = 34.7353, GNorm = 1.4689, lr_0 = 4.8758e-04
Validation rmse = 0.211296
Epoch 29
Loss = 1.9233e-01, PNorm = 34.7596, GNorm = 1.2399, lr_0 = 4.7149e-04
Validation rmse = 0.209841
Epoch 30
Loss = 1.8000e-01, PNorm = 34.7863, GNorm = 1.7988, lr_0 = 4.5592e-04
Validation rmse = 0.180283
Epoch 31
Validation rmse = 0.208548
Epoch 32
Loss = 2.0016e-01, PNorm = 34.8145, GNorm = 1.0722, lr_0 = 4.3940e-04
Validation rmse = 0.196150
Epoch 33
Loss = 1.8667e-01, PNorm = 34.8406, GNorm = 2.5493, lr_0 = 4.2489e-04
Validation rmse = 0.203794
Epoch 34
Loss = 1.6091e-01, PNorm = 34.8648, GNorm = 1.1054, lr_0 = 4.1087e-04
Validation rmse = 0.214540
Epoch 35
Loss = 1.6579e-01, PNorm = 34.8898, GNorm = 1.1952, lr_0 = 3.9731e-04
Validation rmse = 0.195001
Epoch 36
Validation rmse = 0.204999
Epoch 37
Loss = 1.9519e-01, PNorm = 34.9176, GNorm = 3.7620, lr_0 = 3.8290e-04
Validation rmse = 0.208584
Epoch 38
Loss = 1.8194e-01, PNorm = 34.9443, GNorm = 0.9943, lr_0 = 3.7027e-04
Validation rmse = 0.260164
Epoch 39
Loss = 1.5948e-01, PNorm = 34.9692, GNorm = 1.3834, lr_0 = 3.5804e-04
Validation rmse = 0.221881
Epoch 40
Validation rmse = 0.250033
Epoch 41
Loss = 1.5100e-01, PNorm = 34.9960, GNorm = 1.8499, lr_0 = 3.4506e-04
Validation rmse = 0.215375
Epoch 42
Loss = 1.4327e-01, PNorm = 35.0173, GNorm = 1.8293, lr_0 = 3.3367e-04
Validation rmse = 0.244434
Epoch 43
Loss = 1.6242e-01, PNorm = 35.0422, GNorm = 2.3028, lr_0 = 3.2266e-04
Validation rmse = 0.243268
Epoch 44
Loss = 1.4731e-01, PNorm = 35.0637, GNorm = 1.8561, lr_0 = 3.1201e-04
Validation rmse = 0.240720
Epoch 45
Validation rmse = 0.235586
Epoch 46
Loss = 1.5451e-01, PNorm = 35.0892, GNorm = 1.8728, lr_0 = 3.0070e-04
Validation rmse = 0.245085
Epoch 47
Loss = 1.3647e-01, PNorm = 35.1105, GNorm = 0.5062, lr_0 = 2.9077e-04
Validation rmse = 0.214558
Epoch 48
Loss = 1.3726e-01, PNorm = 35.1317, GNorm = 2.3317, lr_0 = 2.8118e-04
Validation rmse = 0.199453
Epoch 49
Validation rmse = 0.225870
Epoch 50
Loss = 9.6494e-02, PNorm = 35.1535, GNorm = 1.4151, lr_0 = 2.7190e-04
Validation rmse = 0.232179
Epoch 51
Loss = 1.6367e-01, PNorm = 35.1740, GNorm = 5.2742, lr_0 = 2.6204e-04
Validation rmse = 0.251961
Epoch 52
Loss = 1.3375e-01, PNorm = 35.1942, GNorm = 0.6863, lr_0 = 2.5339e-04
Validation rmse = 0.270004
Epoch 53
Loss = 1.3695e-01, PNorm = 35.2126, GNorm = 3.1274, lr_0 = 2.4503e-04
Validation rmse = 0.228748
Epoch 54
Validation rmse = 0.217258
Epoch 55
Loss = 1.2635e-01, PNorm = 35.2318, GNorm = 1.0718, lr_0 = 2.3614e-04
Validation rmse = 0.210569
Epoch 56
Loss = 1.1022e-01, PNorm = 35.2486, GNorm = 1.4062, lr_0 = 2.2835e-04
Validation rmse = 0.211396
Epoch 57
Loss = 1.2907e-01, PNorm = 35.2650, GNorm = 2.7842, lr_0 = 2.2081e-04
Validation rmse = 0.218261
Epoch 58
Validation rmse = 0.226301
Epoch 59
Loss = 1.4536e-01, PNorm = 35.2804, GNorm = 1.6253, lr_0 = 2.1352e-04
Validation rmse = 0.262222
Epoch 60
Loss = 1.3681e-01, PNorm = 35.2977, GNorm = 0.9900, lr_0 = 2.0578e-04
Validation rmse = 0.242408
Epoch 61
Loss = 1.3279e-01, PNorm = 35.3119, GNorm = 1.1908, lr_0 = 1.9899e-04
Validation rmse = 0.186111
Epoch 62
Loss = 1.2454e-01, PNorm = 35.3249, GNorm = 2.7520, lr_0 = 1.9242e-04
Validation rmse = 0.241621
Epoch 63
Validation rmse = 0.233186
Epoch 64
Loss = 1.3676e-01, PNorm = 35.3401, GNorm = 1.5271, lr_0 = 1.8545e-04
Validation rmse = 0.226211
Epoch 65
Loss = 1.2029e-01, PNorm = 35.3535, GNorm = 2.4714, lr_0 = 1.7933e-04
Validation rmse = 0.241102
Epoch 66
Loss = 1.0851e-01, PNorm = 35.3657, GNorm = 1.7147, lr_0 = 1.7341e-04
Validation rmse = 0.230628
Epoch 67
Validation rmse = 0.209860
Epoch 68
Loss = 1.1188e-01, PNorm = 35.3779, GNorm = 3.1723, lr_0 = 1.6768e-04
Validation rmse = 0.229200
Epoch 69
Loss = 1.1283e-01, PNorm = 35.3902, GNorm = 0.6031, lr_0 = 1.6161e-04
Validation rmse = 0.251169
Epoch 70
Loss = 1.2005e-01, PNorm = 35.4021, GNorm = 0.9852, lr_0 = 1.5627e-04
Validation rmse = 0.227133
Epoch 71
Loss = 1.0813e-01, PNorm = 35.4128, GNorm = 4.3307, lr_0 = 1.5111e-04
Validation rmse = 0.238043
Epoch 72
Validation rmse = 0.212226
Epoch 73
Loss = 1.1481e-01, PNorm = 35.4245, GNorm = 1.7992, lr_0 = 1.4563e-04
Validation rmse = 0.241857
Epoch 74
Loss = 1.0389e-01, PNorm = 35.4353, GNorm = 3.5268, lr_0 = 1.4083e-04
Validation rmse = 0.245716
Epoch 75
Loss = 1.0493e-01, PNorm = 35.4453, GNorm = 2.7998, lr_0 = 1.3618e-04
Validation rmse = 0.233182
Epoch 76
Validation rmse = 0.229796
Epoch 77
Loss = 1.2256e-01, PNorm = 35.4547, GNorm = 1.1200, lr_0 = 1.3168e-04
Validation rmse = 0.252274
Epoch 78
Loss = 1.0021e-01, PNorm = 35.4655, GNorm = 0.6770, lr_0 = 1.2691e-04
Validation rmse = 0.217695
Epoch 79
Loss = 9.4426e-02, PNorm = 35.4739, GNorm = 1.3707, lr_0 = 1.2272e-04
Validation rmse = 0.262967
Epoch 80
Loss = 1.0647e-01, PNorm = 35.4830, GNorm = 0.6364, lr_0 = 1.1867e-04
Validation rmse = 0.251712
Epoch 81
Validation rmse = 0.216106
Epoch 82
Loss = 1.0107e-01, PNorm = 35.4920, GNorm = 1.1608, lr_0 = 1.1437e-04
Validation rmse = 0.264818
Epoch 83
Loss = 1.1145e-01, PNorm = 35.5002, GNorm = 1.6533, lr_0 = 1.1059e-04
Validation rmse = 0.214547
Epoch 84
Loss = 1.0429e-01, PNorm = 35.5077, GNorm = 2.5188, lr_0 = 1.0694e-04
Validation rmse = 0.231997
Epoch 85
Validation rmse = 0.247025
Epoch 86
Loss = 8.8507e-02, PNorm = 35.5150, GNorm = 1.4600, lr_0 = 1.0341e-04
Validation rmse = 0.221612
Epoch 87
Loss = 1.0710e-01, PNorm = 35.5233, GNorm = 1.0470, lr_0 = 1.0000e-04
Validation rmse = 0.245685
Epoch 88
Loss = 9.5581e-02, PNorm = 35.5299, GNorm = 1.5242, lr_0 = 1.0000e-04
Validation rmse = 0.242381
Epoch 89
Loss = 9.3173e-02, PNorm = 35.5369, GNorm = 1.7200, lr_0 = 1.0000e-04
Validation rmse = 0.242147
Epoch 90
Validation rmse = 0.239328
Epoch 91
Loss = 8.3623e-02, PNorm = 35.5444, GNorm = 1.3355, lr_0 = 1.0000e-04
Validation rmse = 0.228578
Epoch 92
Loss = 8.8855e-02, PNorm = 35.5514, GNorm = 0.7054, lr_0 = 1.0000e-04
Validation rmse = 0.239887
Epoch 93
Loss = 8.9524e-02, PNorm = 35.5584, GNorm = 0.9469, lr_0 = 1.0000e-04
Validation rmse = 0.237801
Epoch 94
Validation rmse = 0.258321
Epoch 95
Loss = 8.1455e-02, PNorm = 35.5659, GNorm = 0.7304, lr_0 = 1.0000e-04
Validation rmse = 0.230997
Epoch 96
Loss = 8.3475e-02, PNorm = 35.5740, GNorm = 0.8341, lr_0 = 1.0000e-04
Validation rmse = 0.240048
Epoch 97
Loss = 8.9070e-02, PNorm = 35.5812, GNorm = 1.9536, lr_0 = 1.0000e-04
Validation rmse = 0.232986
Epoch 98
Loss = 8.9853e-02, PNorm = 35.5882, GNorm = 1.8558, lr_0 = 1.0000e-04
Validation rmse = 0.245008
Epoch 99
Validation rmse = 0.244064
Model 0 best validation rmse = 0.133347 on epoch 0
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.049592
Ensemble test rmse = 0.049592
1-fold cross validation
	Seed 0 ==> test rmse = 0.049592
Overall test rmse = 0.049592 +/- 0.000000
Elapsed time = 0:00:28
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 100,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 385 | train size = 381 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.347081
Epoch 1
Loss = 7.2213e-01, PNorm = 34.0314, GNorm = 6.9093, lr_0 = 8.7143e-04
Validation rmse = 0.325891
Epoch 2
Loss = 5.2021e-01, PNorm = 34.0808, GNorm = 0.9377, lr_0 = 9.7351e-04
Validation rmse = 0.226211
Epoch 3
Loss = 4.8664e-01, PNorm = 34.1399, GNorm = 3.3974, lr_0 = 9.3822e-04
Validation rmse = 0.253802
Epoch 4
Validation rmse = 0.184173
Epoch 5
Loss = 4.7578e-01, PNorm = 34.1828, GNorm = 9.4940, lr_0 = 9.0725e-04
Validation rmse = 0.177985
Epoch 6
Loss = 3.6870e-01, PNorm = 34.2245, GNorm = 8.0630, lr_0 = 8.7436e-04
Validation rmse = 0.157304
Epoch 7
Loss = 3.4985e-01, PNorm = 34.2591, GNorm = 0.7360, lr_0 = 8.4550e-04
Loss = 4.2925e-01, PNorm = 34.2627, GNorm = 1.3952, lr_0 = 8.4267e-04
Validation rmse = 0.163988
Epoch 8
Validation rmse = 0.148595
Epoch 9
Loss = 3.3137e-01, PNorm = 34.2955, GNorm = 0.8069, lr_0 = 8.1485e-04
Validation rmse = 0.153531
Epoch 10
Loss = 3.2412e-01, PNorm = 34.3278, GNorm = 3.5246, lr_0 = 7.8796e-04
Validation rmse = 0.130779
Epoch 11
Loss = 2.8984e-01, PNorm = 34.3618, GNorm = 0.7868, lr_0 = 7.5939e-04
Validation rmse = 0.127946
Epoch 12
Validation rmse = 0.145931
Epoch 13
Loss = 2.4606e-01, PNorm = 34.3933, GNorm = 3.4855, lr_0 = 7.3433e-04
Validation rmse = 0.120175
Epoch 14
Loss = 2.5237e-01, PNorm = 34.4280, GNorm = 1.8526, lr_0 = 7.0771e-04
Validation rmse = 0.155556
Epoch 15
Loss = 2.5960e-01, PNorm = 34.4580, GNorm = 3.9715, lr_0 = 6.8435e-04
Validation rmse = 0.127222
Epoch 16
Validation rmse = 0.097392
Epoch 17
Loss = 1.7674e-01, PNorm = 34.4934, GNorm = 3.3697, lr_0 = 6.5954e-04
Validation rmse = 0.123845
Epoch 18
Loss = 2.5657e-01, PNorm = 34.5255, GNorm = 3.2058, lr_0 = 6.3777e-04
Validation rmse = 0.199441
Epoch 19
Loss = 2.7401e-01, PNorm = 34.5608, GNorm = 3.7742, lr_0 = 6.1465e-04
Validation rmse = 0.156498
Epoch 20
Loss = 2.7005e-01, PNorm = 34.5965, GNorm = 5.8783, lr_0 = 5.9436e-04
Validation rmse = 0.163301
Epoch 21
Validation rmse = 0.152725
Epoch 22
Loss = 2.5445e-01, PNorm = 34.6327, GNorm = 4.2987, lr_0 = 5.7282e-04
Validation rmse = 0.156193
Epoch 23
Loss = 2.3601e-01, PNorm = 34.6655, GNorm = 0.6347, lr_0 = 5.5391e-04
Validation rmse = 0.149633
Epoch 24
Loss = 2.2239e-01, PNorm = 34.7029, GNorm = 1.7611, lr_0 = 5.3383e-04
Validation rmse = 0.132268
Epoch 25
Validation rmse = 0.168840
Epoch 26
Loss = 2.3815e-01, PNorm = 34.7336, GNorm = 4.2008, lr_0 = 5.1621e-04
Validation rmse = 0.166378
Epoch 27
Loss = 2.1810e-01, PNorm = 34.7697, GNorm = 5.2373, lr_0 = 4.9750e-04
Validation rmse = 0.161891
Epoch 28
Loss = 1.9479e-01, PNorm = 34.8015, GNorm = 0.7693, lr_0 = 4.8108e-04
Loss = 2.7336e-01, PNorm = 34.8043, GNorm = 3.7585, lr_0 = 4.7947e-04
Validation rmse = 0.134237
Epoch 29
Validation rmse = 0.147185
Epoch 30
Loss = 2.1196e-01, PNorm = 34.8346, GNorm = 2.5603, lr_0 = 4.6364e-04
Validation rmse = 0.132147
Epoch 31
Loss = 1.8974e-01, PNorm = 34.8652, GNorm = 4.0147, lr_0 = 4.4834e-04
Validation rmse = 0.136340
Epoch 32
Loss = 1.7951e-01, PNorm = 34.8969, GNorm = 1.8271, lr_0 = 4.3208e-04
Validation rmse = 0.102992
Epoch 33
Validation rmse = 0.099847
Epoch 34
Loss = 2.2785e-01, PNorm = 34.9271, GNorm = 6.8564, lr_0 = 4.1782e-04
Validation rmse = 0.124682
Epoch 35
Loss = 1.8264e-01, PNorm = 34.9582, GNorm = 1.3955, lr_0 = 4.0268e-04
Validation rmse = 0.111839
Epoch 36
Loss = 1.7734e-01, PNorm = 34.9882, GNorm = 2.0611, lr_0 = 3.8938e-04
Validation rmse = 0.122649
Epoch 37
Validation rmse = 0.132667
Epoch 38
Loss = 1.4757e-01, PNorm = 35.0187, GNorm = 1.5956, lr_0 = 3.7527e-04
Validation rmse = 0.166547
Epoch 39
Loss = 1.6196e-01, PNorm = 35.0455, GNorm = 3.5175, lr_0 = 3.6288e-04
Validation rmse = 0.159058
Epoch 40
Loss = 1.5401e-01, PNorm = 35.0759, GNorm = 0.9460, lr_0 = 3.4973e-04
Validation rmse = 0.127717
Epoch 41
Loss = 1.5847e-01, PNorm = 35.1010, GNorm = 2.8764, lr_0 = 3.3819e-04
Validation rmse = 0.111396
Epoch 42
Validation rmse = 0.112402
Epoch 43
Loss = 1.5244e-01, PNorm = 35.1274, GNorm = 1.7053, lr_0 = 3.2593e-04
Validation rmse = 0.144380
Epoch 44
Loss = 1.5494e-01, PNorm = 35.1524, GNorm = 2.9936, lr_0 = 3.1517e-04
Validation rmse = 0.127042
Epoch 45
Loss = 1.4705e-01, PNorm = 35.1762, GNorm = 3.2067, lr_0 = 3.0374e-04
Validation rmse = 0.122082
Epoch 46
Validation rmse = 0.133555
Epoch 47
Loss = 1.3244e-01, PNorm = 35.1983, GNorm = 2.3952, lr_0 = 2.9372e-04
Validation rmse = 0.159382
Epoch 48
Loss = 1.3356e-01, PNorm = 35.2226, GNorm = 1.3188, lr_0 = 2.8307e-04
Validation rmse = 0.124493
Epoch 49
Loss = 1.3421e-01, PNorm = 35.2435, GNorm = 1.2063, lr_0 = 2.7373e-04
Validation rmse = 0.121037
Epoch 50
Validation rmse = 0.127836
Epoch 51
Loss = 7.8222e-02, PNorm = 35.2660, GNorm = 1.3138, lr_0 = 2.6380e-04
Validation rmse = 0.116699
Epoch 52
Loss = 1.5055e-01, PNorm = 35.2862, GNorm = 2.1413, lr_0 = 2.5510e-04
Validation rmse = 0.127989
Epoch 53
Loss = 1.2789e-01, PNorm = 35.3081, GNorm = 1.9071, lr_0 = 2.4585e-04
Validation rmse = 0.119943
Epoch 54
Validation rmse = 0.134909
Epoch 55
Loss = 1.0834e-01, PNorm = 35.3264, GNorm = 1.6151, lr_0 = 2.3774e-04
Validation rmse = 0.154196
Epoch 56
Loss = 1.3188e-01, PNorm = 35.3441, GNorm = 3.8549, lr_0 = 2.2912e-04
Validation rmse = 0.121536
Epoch 57
Loss = 1.1667e-01, PNorm = 35.3612, GNorm = 2.7360, lr_0 = 2.2155e-04
Validation rmse = 0.113694
Epoch 58
Validation rmse = 0.145007
Epoch 59
Loss = 1.2420e-01, PNorm = 35.3806, GNorm = 2.1421, lr_0 = 2.1352e-04
Validation rmse = 0.125718
Epoch 60
Loss = 1.2196e-01, PNorm = 35.3954, GNorm = 2.9804, lr_0 = 2.0648e-04
Validation rmse = 0.143919
Epoch 61
Loss = 1.3278e-01, PNorm = 35.4124, GNorm = 2.6985, lr_0 = 1.9899e-04
Validation rmse = 0.127805
Epoch 62
Loss = 1.2730e-01, PNorm = 35.4262, GNorm = 3.1008, lr_0 = 1.9242e-04
Validation rmse = 0.100584
Epoch 63
Validation rmse = 0.119577
Epoch 64
Loss = 1.1770e-01, PNorm = 35.4421, GNorm = 0.7847, lr_0 = 1.8545e-04
Validation rmse = 0.148440
Epoch 65
Loss = 1.2260e-01, PNorm = 35.4542, GNorm = 3.1020, lr_0 = 1.7933e-04
Validation rmse = 0.118186
Epoch 66
Loss = 1.1682e-01, PNorm = 35.4679, GNorm = 3.5488, lr_0 = 1.7283e-04
Validation rmse = 0.137663
Epoch 67
Validation rmse = 0.126424
Epoch 68
Loss = 9.2961e-02, PNorm = 35.4799, GNorm = 0.7899, lr_0 = 1.6712e-04
Validation rmse = 0.119044
Epoch 69
Loss = 1.1192e-01, PNorm = 35.4926, GNorm = 1.1952, lr_0 = 1.6106e-04
Validation rmse = 0.126040
Epoch 70
Loss = 1.0567e-01, PNorm = 35.5042, GNorm = 1.0168, lr_0 = 1.5575e-04
Validation rmse = 0.125658
Epoch 71
Validation rmse = 0.116452
Epoch 72
Loss = 8.9817e-02, PNorm = 35.5158, GNorm = 0.7115, lr_0 = 1.5010e-04
Validation rmse = 0.117078
Epoch 73
Loss = 1.1671e-01, PNorm = 35.5270, GNorm = 1.2708, lr_0 = 1.4515e-04
Validation rmse = 0.107843
Epoch 74
Loss = 1.0722e-01, PNorm = 35.5375, GNorm = 0.9044, lr_0 = 1.3989e-04
Validation rmse = 0.130014
Epoch 75
Validation rmse = 0.102439
Epoch 76
Loss = 1.2318e-01, PNorm = 35.5470, GNorm = 1.3951, lr_0 = 1.3527e-04
Validation rmse = 0.129393
Epoch 77
Loss = 1.1405e-01, PNorm = 35.5574, GNorm = 1.4998, lr_0 = 1.3036e-04
Validation rmse = 0.118708
Epoch 78
Loss = 1.0047e-01, PNorm = 35.5663, GNorm = 2.2484, lr_0 = 1.2606e-04
Validation rmse = 0.112379
Epoch 79
Validation rmse = 0.121988
Epoch 80
Loss = 1.3336e-01, PNorm = 35.5759, GNorm = 1.5142, lr_0 = 1.2149e-04
Validation rmse = 0.127087
Epoch 81
Loss = 1.0761e-01, PNorm = 35.5845, GNorm = 0.8621, lr_0 = 1.1748e-04
Validation rmse = 0.118040
Epoch 82
Loss = 9.1316e-02, PNorm = 35.5936, GNorm = 0.8295, lr_0 = 1.1322e-04
Validation rmse = 0.120049
Epoch 83
Loss = 9.8603e-02, PNorm = 35.6008, GNorm = 1.8914, lr_0 = 1.0949e-04
Validation rmse = 0.116871
Epoch 84
Validation rmse = 0.112744
Epoch 85
Loss = 1.1063e-01, PNorm = 35.6099, GNorm = 0.9902, lr_0 = 1.0552e-04
Validation rmse = 0.113288
Epoch 86
Loss = 9.7582e-02, PNorm = 35.6170, GNorm = 1.9701, lr_0 = 1.0203e-04
Validation rmse = 0.112470
Epoch 87
Loss = 9.6287e-02, PNorm = 35.6254, GNorm = 2.4996, lr_0 = 1.0000e-04
Validation rmse = 0.116639
Epoch 88
Validation rmse = 0.117822
Epoch 89
Loss = 9.1601e-02, PNorm = 35.6326, GNorm = 0.9839, lr_0 = 1.0000e-04
Validation rmse = 0.117713
Epoch 90
Loss = 9.5482e-02, PNorm = 35.6402, GNorm = 0.6278, lr_0 = 1.0000e-04
Validation rmse = 0.120165
Epoch 91
Loss = 9.2825e-02, PNorm = 35.6475, GNorm = 1.0912, lr_0 = 1.0000e-04
Validation rmse = 0.111386
Epoch 92
Validation rmse = 0.119302
Epoch 93
Loss = 8.0851e-02, PNorm = 35.6554, GNorm = 1.1128, lr_0 = 1.0000e-04
Validation rmse = 0.109809
Epoch 94
Loss = 1.0139e-01, PNorm = 35.6623, GNorm = 0.9992, lr_0 = 1.0000e-04
Validation rmse = 0.117512
Epoch 95
Loss = 9.6503e-02, PNorm = 35.6705, GNorm = 1.3415, lr_0 = 1.0000e-04
Validation rmse = 0.113582
Epoch 96
Validation rmse = 0.103168
Epoch 97
Loss = 8.9549e-02, PNorm = 35.6773, GNorm = 2.0101, lr_0 = 1.0000e-04
Validation rmse = 0.122469
Epoch 98
Loss = 8.6692e-02, PNorm = 35.6850, GNorm = 2.2144, lr_0 = 1.0000e-04
Validation rmse = 0.114351
Epoch 99
Loss = 9.2646e-02, PNorm = 35.6922, GNorm = 0.7017, lr_0 = 1.0000e-04
Validation rmse = 0.107742
Model 0 best validation rmse = 0.097392 on epoch 16
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.030749
Ensemble test rmse = 0.030749
1-fold cross validation
	Seed 0 ==> test rmse = 0.030749
Overall test rmse = 0.030749 +/- 0.000000
Elapsed time = 0:00:29
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 100,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 377 | train size = 373 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.209138
Epoch 1
Loss = 7.6184e-01, PNorm = 34.0265, GNorm = 4.6215, lr_0 = 8.7143e-04
Validation rmse = 0.082950
Epoch 2
Loss = 4.8663e-01, PNorm = 34.0893, GNorm = 4.9751, lr_0 = 9.7024e-04
Validation rmse = 0.090563
Epoch 3
Validation rmse = 0.184899
Epoch 4
Loss = 4.6840e-01, PNorm = 34.1511, GNorm = 7.1065, lr_0 = 9.3507e-04
Validation rmse = 0.099614
Epoch 5
Loss = 3.3302e-01, PNorm = 34.1878, GNorm = 4.1782, lr_0 = 9.0421e-04
Validation rmse = 0.083452
Epoch 6
Loss = 3.8333e-01, PNorm = 34.2287, GNorm = 5.8926, lr_0 = 8.7143e-04
Validation rmse = 0.190357
Epoch 7
Validation rmse = 0.170060
Epoch 8
Loss = 3.5906e-01, PNorm = 34.2654, GNorm = 2.5764, lr_0 = 8.3984e-04
Validation rmse = 0.168825
Epoch 9
Loss = 2.4565e-01, PNorm = 34.2941, GNorm = 1.1002, lr_0 = 8.1212e-04
Validation rmse = 0.158418
Epoch 10
Loss = 2.3575e-01, PNorm = 34.3231, GNorm = 3.6979, lr_0 = 7.8268e-04
Validation rmse = 0.141497
Epoch 11
Validation rmse = 0.171554
Epoch 12
Loss = 2.3892e-01, PNorm = 34.3494, GNorm = 2.8192, lr_0 = 7.5431e-04
Validation rmse = 0.161531
Epoch 13
Loss = 2.1780e-01, PNorm = 34.3761, GNorm = 4.5030, lr_0 = 7.2697e-04
Validation rmse = 0.228585
Epoch 14
Loss = 2.2377e-01, PNorm = 34.4013, GNorm = 0.7733, lr_0 = 7.0297e-04
Validation rmse = 0.128759
Epoch 15
Validation rmse = 0.164074
Epoch 16
Loss = 1.8112e-01, PNorm = 34.4273, GNorm = 1.9222, lr_0 = 6.7749e-04
Validation rmse = 0.196540
Epoch 17
Loss = 2.0851e-01, PNorm = 34.4527, GNorm = 1.0264, lr_0 = 6.5293e-04
Validation rmse = 0.125262
Epoch 18
Loss = 1.9334e-01, PNorm = 34.4764, GNorm = 0.8418, lr_0 = 6.3138e-04
Validation rmse = 0.188832
Epoch 19
Validation rmse = 0.149339
Epoch 20
Loss = 2.0927e-01, PNorm = 34.5026, GNorm = 2.9321, lr_0 = 6.0849e-04
Validation rmse = 0.121208
Epoch 21
Loss = 2.0309e-01, PNorm = 34.5278, GNorm = 6.0412, lr_0 = 5.8644e-04
Validation rmse = 0.156839
Epoch 22
Loss = 1.9504e-01, PNorm = 34.5518, GNorm = 4.2142, lr_0 = 5.6708e-04
Validation rmse = 0.192608
Epoch 23
Validation rmse = 0.171717
Epoch 24
Loss = 2.5316e-01, PNorm = 34.5788, GNorm = 5.9601, lr_0 = 5.4652e-04
Validation rmse = 0.149124
Epoch 25
Loss = 1.8830e-01, PNorm = 34.6027, GNorm = 1.4262, lr_0 = 5.2671e-04
Validation rmse = 0.153448
Epoch 26
Loss = 1.7626e-01, PNorm = 34.6253, GNorm = 0.7459, lr_0 = 5.0762e-04
Validation rmse = 0.158849
Epoch 27
Validation rmse = 0.184608
Epoch 28
Loss = 1.7860e-01, PNorm = 34.6494, GNorm = 5.8582, lr_0 = 4.8922e-04
Validation rmse = 0.151588
Epoch 29
Loss = 1.4843e-01, PNorm = 34.6700, GNorm = 2.6463, lr_0 = 4.7307e-04
Validation rmse = 0.196641
Epoch 30
Loss = 1.7225e-01, PNorm = 34.6927, GNorm = 1.0642, lr_0 = 4.5592e-04
Validation rmse = 0.215601
Epoch 31
Validation rmse = 0.185329
Epoch 32
Loss = 1.6092e-01, PNorm = 34.7174, GNorm = 0.8331, lr_0 = 4.3940e-04
Validation rmse = 0.149261
Epoch 33
Loss = 1.2119e-01, PNorm = 34.7399, GNorm = 0.9267, lr_0 = 4.2489e-04
Validation rmse = 0.160869
Epoch 34
Loss = 1.7104e-01, PNorm = 34.7621, GNorm = 4.4195, lr_0 = 4.0949e-04
Validation rmse = 0.148904
Epoch 35
Validation rmse = 0.146513
Epoch 36
Loss = 1.5781e-01, PNorm = 34.7851, GNorm = 2.5702, lr_0 = 3.9465e-04
Validation rmse = 0.159202
Epoch 37
Loss = 1.9953e-01, PNorm = 34.8042, GNorm = 4.9207, lr_0 = 3.8162e-04
Validation rmse = 0.162115
Epoch 38
Loss = 1.4615e-01, PNorm = 34.8256, GNorm = 1.4146, lr_0 = 3.6779e-04
Loss = 1.8970e-01, PNorm = 34.8275, GNorm = 4.5088, lr_0 = 3.6656e-04
Validation rmse = 0.162743
Epoch 39
Validation rmse = 0.162528
Epoch 40
Loss = 1.3455e-01, PNorm = 34.8455, GNorm = 1.6844, lr_0 = 3.5446e-04
Validation rmse = 0.174848
Epoch 41
Loss = 1.4466e-01, PNorm = 34.8663, GNorm = 2.2967, lr_0 = 3.4161e-04
Validation rmse = 0.143464
Epoch 42
Loss = 1.3256e-01, PNorm = 34.8851, GNorm = 0.7971, lr_0 = 3.3033e-04
Loss = 1.3359e-01, PNorm = 34.8869, GNorm = 0.9067, lr_0 = 3.2922e-04
Validation rmse = 0.139429
Epoch 43
Validation rmse = 0.124298
Epoch 44
Loss = 1.3219e-01, PNorm = 34.9054, GNorm = 1.3289, lr_0 = 3.1836e-04
Validation rmse = 0.113778
Epoch 45
Loss = 1.3234e-01, PNorm = 34.9253, GNorm = 2.9425, lr_0 = 3.0682e-04
Validation rmse = 0.100900
Epoch 46
Loss = 1.2416e-01, PNorm = 34.9435, GNorm = 0.8323, lr_0 = 2.9669e-04
Loss = 1.9477e-01, PNorm = 34.9452, GNorm = 1.7504, lr_0 = 2.9570e-04
Validation rmse = 0.128732
Epoch 47
Validation rmse = 0.150653
Epoch 48
Loss = 1.5212e-01, PNorm = 34.9629, GNorm = 3.7678, lr_0 = 2.8594e-04
Validation rmse = 0.124640
Epoch 49
Loss = 1.2863e-01, PNorm = 34.9806, GNorm = 1.7289, lr_0 = 2.7557e-04
Validation rmse = 0.119515
Epoch 50
Loss = 1.2057e-01, PNorm = 34.9976, GNorm = 1.0250, lr_0 = 2.6647e-04
Loss = 8.2765e-02, PNorm = 34.9991, GNorm = 1.8260, lr_0 = 2.6558e-04
Validation rmse = 0.127610
Epoch 51
Validation rmse = 0.150180
Epoch 52
Loss = 1.2324e-01, PNorm = 35.0160, GNorm = 0.8419, lr_0 = 2.5595e-04
Validation rmse = 0.141170
Epoch 53
Loss = 1.1874e-01, PNorm = 35.0321, GNorm = 0.9125, lr_0 = 2.4751e-04
Validation rmse = 0.114798
Epoch 54
Loss = 1.1285e-01, PNorm = 35.0489, GNorm = 1.4636, lr_0 = 2.3853e-04
Validation rmse = 0.112575
Epoch 55
Validation rmse = 0.141490
Epoch 56
Loss = 1.0593e-01, PNorm = 35.0644, GNorm = 3.7672, lr_0 = 2.2989e-04
Validation rmse = 0.115224
Epoch 57
Loss = 1.2252e-01, PNorm = 35.0786, GNorm = 1.5582, lr_0 = 2.2230e-04
Validation rmse = 0.110492
Epoch 58
Loss = 1.1574e-01, PNorm = 35.0931, GNorm = 5.1524, lr_0 = 2.1424e-04
Validation rmse = 0.112565
Epoch 59
Validation rmse = 0.114140
Epoch 60
Loss = 8.2780e-02, PNorm = 35.1081, GNorm = 1.6961, lr_0 = 2.0648e-04
Validation rmse = 0.103525
Epoch 61
Loss = 1.0875e-01, PNorm = 35.1211, GNorm = 1.5965, lr_0 = 1.9966e-04
Validation rmse = 0.128378
Epoch 62
Validation rmse = 0.131546
Epoch 63
Loss = 1.1128e-01, PNorm = 35.1373, GNorm = 2.2445, lr_0 = 1.9178e-04
Validation rmse = 0.123142
Epoch 64
Loss = 7.9585e-02, PNorm = 35.1501, GNorm = 0.8147, lr_0 = 1.8545e-04
Validation rmse = 0.091928
Epoch 65
Loss = 1.0789e-01, PNorm = 35.1637, GNorm = 1.6833, lr_0 = 1.7873e-04
Validation rmse = 0.093446
Epoch 66
Validation rmse = 0.120195
Epoch 67
Loss = 9.9231e-02, PNorm = 35.1766, GNorm = 0.8351, lr_0 = 1.7225e-04
Validation rmse = 0.130356
Epoch 68
Loss = 1.0457e-01, PNorm = 35.1888, GNorm = 0.6659, lr_0 = 1.6656e-04
Validation rmse = 0.103544
Epoch 69
Loss = 1.0310e-01, PNorm = 35.2009, GNorm = 1.2435, lr_0 = 1.6052e-04
Validation rmse = 0.124414
Epoch 70
Validation rmse = 0.139349
Epoch 71
Loss = 1.1108e-01, PNorm = 35.2115, GNorm = 3.0900, lr_0 = 1.5471e-04
Validation rmse = 0.094258
Epoch 72
Loss = 1.0476e-01, PNorm = 35.2218, GNorm = 2.2522, lr_0 = 1.4960e-04
Validation rmse = 0.090434
Epoch 73
Loss = 9.7059e-02, PNorm = 35.2329, GNorm = 0.7043, lr_0 = 1.4418e-04
Validation rmse = 0.130182
Epoch 74
Validation rmse = 0.105376
Epoch 75
Loss = 1.1271e-01, PNorm = 35.2425, GNorm = 1.7848, lr_0 = 1.3895e-04
Validation rmse = 0.066808
Epoch 76
Loss = 1.1264e-01, PNorm = 35.2525, GNorm = 1.2613, lr_0 = 1.3391e-04
Validation rmse = 0.139500
Epoch 77
Loss = 9.8235e-02, PNorm = 35.2612, GNorm = 2.6446, lr_0 = 1.2949e-04
Validation rmse = 0.090937
Epoch 78
Validation rmse = 0.098864
Epoch 79
Loss = 8.2293e-02, PNorm = 35.2707, GNorm = 1.5274, lr_0 = 1.2480e-04
Validation rmse = 0.106295
Epoch 80
Loss = 8.4122e-02, PNorm = 35.2791, GNorm = 1.4526, lr_0 = 1.2027e-04
Validation rmse = 0.086887
Epoch 81
Loss = 9.9108e-02, PNorm = 35.2868, GNorm = 2.8574, lr_0 = 1.1630e-04
Validation rmse = 0.097561
Epoch 82
Validation rmse = 0.110488
Epoch 83
Loss = 6.9113e-02, PNorm = 35.2952, GNorm = 1.1520, lr_0 = 1.1209e-04
Validation rmse = 0.103759
Epoch 84
Loss = 8.9625e-02, PNorm = 35.3028, GNorm = 1.2162, lr_0 = 1.0803e-04
Validation rmse = 0.095717
Epoch 85
Loss = 8.6858e-02, PNorm = 35.3102, GNorm = 2.8417, lr_0 = 1.0446e-04
Validation rmse = 0.115512
Epoch 86
Validation rmse = 0.087506
Epoch 87
Loss = 1.4253e-01, PNorm = 35.3178, GNorm = 1.2032, lr_0 = 1.0067e-04
Validation rmse = 0.100099
Epoch 88
Loss = 7.9123e-02, PNorm = 35.3253, GNorm = 0.9520, lr_0 = 1.0000e-04
Validation rmse = 0.109024
Epoch 89
Loss = 8.0501e-02, PNorm = 35.3325, GNorm = 1.6540, lr_0 = 1.0000e-04
Validation rmse = 0.085383
Epoch 90
Validation rmse = 0.101140
Epoch 91
Loss = 9.6515e-02, PNorm = 35.3397, GNorm = 2.4478, lr_0 = 1.0000e-04
Validation rmse = 0.094614
Epoch 92
Loss = 7.8126e-02, PNorm = 35.3463, GNorm = 1.0007, lr_0 = 1.0000e-04
Validation rmse = 0.086632
Epoch 93
Loss = 8.6649e-02, PNorm = 35.3536, GNorm = 1.0702, lr_0 = 1.0000e-04
Validation rmse = 0.090683
Epoch 94
Validation rmse = 0.103061
Epoch 95
Loss = 7.4894e-02, PNorm = 35.3610, GNorm = 2.3992, lr_0 = 1.0000e-04
Validation rmse = 0.088496
Epoch 96
Loss = 6.7476e-02, PNorm = 35.3678, GNorm = 1.0586, lr_0 = 1.0000e-04
Validation rmse = 0.077461
Epoch 97
Loss = 8.7659e-02, PNorm = 35.3753, GNorm = 3.0585, lr_0 = 1.0000e-04
Validation rmse = 0.100178
Epoch 98
Validation rmse = 0.084359
Epoch 99
Loss = 7.2449e-02, PNorm = 35.3828, GNorm = 1.0053, lr_0 = 1.0000e-04
Validation rmse = 0.079123
Model 0 best validation rmse = 0.066808 on epoch 75
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.030700
Ensemble test rmse = 0.030700
1-fold cross validation
	Seed 0 ==> test rmse = 0.030700
Overall test rmse = 0.030700 +/- 0.000000
Elapsed time = 0:00:28
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 100,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 369 | train size = 365 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.270295
Epoch 1
Loss = 6.9450e-01, PNorm = 34.0264, GNorm = 4.3000, lr_0 = 8.7143e-04
Validation rmse = 0.176130
Epoch 2
Loss = 5.4071e-01, PNorm = 34.0912, GNorm = 7.0126, lr_0 = 9.7024e-04
Validation rmse = 0.146529
Epoch 3
Validation rmse = 0.173389
Epoch 4
Loss = 4.5913e-01, PNorm = 34.1438, GNorm = 9.1046, lr_0 = 9.3507e-04
Validation rmse = 0.175180
Epoch 5
Loss = 3.4719e-01, PNorm = 34.1900, GNorm = 8.6823, lr_0 = 9.0118e-04
Validation rmse = 0.163051
Epoch 6
Loss = 3.2455e-01, PNorm = 34.2324, GNorm = 7.7783, lr_0 = 8.6851e-04
Validation rmse = 0.091421
Epoch 7
Validation rmse = 0.109216
Epoch 8
Loss = 2.1546e-01, PNorm = 34.2706, GNorm = 3.3282, lr_0 = 8.3703e-04
Validation rmse = 0.108248
Epoch 9
Loss = 2.9138e-01, PNorm = 34.2990, GNorm = 4.2427, lr_0 = 8.0669e-04
Validation rmse = 0.129554
Epoch 10
Loss = 2.4096e-01, PNorm = 34.3307, GNorm = 4.2118, lr_0 = 7.8006e-04
Loss = 3.0889e-01, PNorm = 34.3336, GNorm = 7.9413, lr_0 = 7.7745e-04
Validation rmse = 0.134941
Epoch 11
Validation rmse = 0.168024
Epoch 12
Loss = 2.1679e-01, PNorm = 34.3658, GNorm = 3.5806, lr_0 = 7.4927e-04
Validation rmse = 0.217316
Epoch 13
Loss = 2.2555e-01, PNorm = 34.3953, GNorm = 1.1863, lr_0 = 7.2211e-04
Validation rmse = 0.095617
Epoch 14
Validation rmse = 0.085490
Epoch 15
Loss = 2.7446e-01, PNorm = 34.4230, GNorm = 7.4305, lr_0 = 6.9593e-04
Validation rmse = 0.113328
Epoch 16
Loss = 2.5341e-01, PNorm = 34.4493, GNorm = 0.8272, lr_0 = 6.7070e-04
Validation rmse = 0.138965
Epoch 17
Loss = 1.8906e-01, PNorm = 34.4769, GNorm = 4.7342, lr_0 = 6.4856e-04
Validation rmse = 0.112511
Epoch 18
Validation rmse = 0.128008
Epoch 19
Loss = 2.2179e-01, PNorm = 34.5063, GNorm = 4.1255, lr_0 = 6.2296e-04
Validation rmse = 0.151851
Epoch 20
Loss = 1.7738e-01, PNorm = 34.5303, GNorm = 3.1144, lr_0 = 6.0240e-04
Validation rmse = 0.114531
Epoch 21
Loss = 1.7874e-01, PNorm = 34.5562, GNorm = 4.0150, lr_0 = 5.8056e-04
Loss = 1.1147e-01, PNorm = 34.5583, GNorm = 5.3829, lr_0 = 5.7862e-04
Validation rmse = 0.138507
Epoch 22
Validation rmse = 0.104100
Epoch 23
Loss = 2.0898e-01, PNorm = 34.5801, GNorm = 2.3854, lr_0 = 5.5764e-04
Validation rmse = 0.151755
Epoch 24
Loss = 1.6239e-01, PNorm = 34.6034, GNorm = 1.2596, lr_0 = 5.3924e-04
Validation rmse = 0.178561
Epoch 25
Validation rmse = 0.185574
Epoch 26
Loss = 1.5100e-01, PNorm = 34.6295, GNorm = 2.2832, lr_0 = 5.1795e-04
Validation rmse = 0.195888
Epoch 27
Loss = 1.7438e-01, PNorm = 34.6524, GNorm = 4.8533, lr_0 = 5.0085e-04
Validation rmse = 0.198819
Epoch 28
Loss = 1.6840e-01, PNorm = 34.6784, GNorm = 2.9603, lr_0 = 4.8270e-04
Validation rmse = 0.249970
Epoch 29
Validation rmse = 0.186191
Epoch 30
Loss = 1.7802e-01, PNorm = 34.7024, GNorm = 2.8807, lr_0 = 4.6520e-04
Validation rmse = 0.143748
Epoch 31
Loss = 1.4633e-01, PNorm = 34.7266, GNorm = 6.1792, lr_0 = 4.4834e-04
Validation rmse = 0.146096
Epoch 32
Loss = 1.3580e-01, PNorm = 34.7505, GNorm = 1.0802, lr_0 = 4.3208e-04
Loss = 2.8409e-01, PNorm = 34.7525, GNorm = 1.6776, lr_0 = 4.3064e-04
Validation rmse = 0.135563
Epoch 33
Validation rmse = 0.158209
Epoch 34
Loss = 1.7681e-01, PNorm = 34.7741, GNorm = 3.6291, lr_0 = 4.1642e-04
Validation rmse = 0.175606
Epoch 35
Loss = 1.3885e-01, PNorm = 34.7962, GNorm = 2.6785, lr_0 = 4.0133e-04
Validation rmse = 0.186742
Epoch 36
Loss = 1.4436e-01, PNorm = 34.8171, GNorm = 3.2872, lr_0 = 3.8678e-04
Validation rmse = 0.186870
Epoch 37
Validation rmse = 0.187274
Epoch 38
Loss = 1.4173e-01, PNorm = 34.8383, GNorm = 4.8344, lr_0 = 3.7276e-04
Validation rmse = 0.146210
Epoch 39
Loss = 1.3093e-01, PNorm = 34.8609, GNorm = 0.6396, lr_0 = 3.5925e-04
Validation rmse = 0.164763
Epoch 40
Validation rmse = 0.155711
Epoch 41
Loss = 1.4137e-01, PNorm = 34.8819, GNorm = 0.6545, lr_0 = 3.4623e-04
Validation rmse = 0.184880
Epoch 42
Loss = 1.2267e-01, PNorm = 34.9026, GNorm = 0.8462, lr_0 = 3.3367e-04
Validation rmse = 0.196133
Epoch 43
Loss = 1.2302e-01, PNorm = 34.9234, GNorm = 1.2854, lr_0 = 3.2158e-04
Validation rmse = 0.136225
Epoch 44
Validation rmse = 0.183103
Epoch 45
Loss = 9.6163e-02, PNorm = 34.9406, GNorm = 0.7912, lr_0 = 3.0992e-04
Validation rmse = 0.168602
Epoch 46
Loss = 1.0435e-01, PNorm = 34.9594, GNorm = 1.7737, lr_0 = 2.9869e-04
Validation rmse = 0.174520
Epoch 47
Loss = 1.0747e-01, PNorm = 34.9786, GNorm = 2.0285, lr_0 = 2.8883e-04
Loss = 8.7941e-02, PNorm = 34.9804, GNorm = 2.0154, lr_0 = 2.8786e-04
Validation rmse = 0.159475
Epoch 48
Validation rmse = 0.165326
Epoch 49
Loss = 1.2642e-01, PNorm = 34.9982, GNorm = 5.6350, lr_0 = 2.7743e-04
Validation rmse = 0.153587
Epoch 50
Loss = 1.0108e-01, PNorm = 35.0142, GNorm = 5.0203, lr_0 = 2.6827e-04
Validation rmse = 0.133670
Epoch 51
Validation rmse = 0.145875
Epoch 52
Loss = 8.7040e-02, PNorm = 35.0317, GNorm = 0.5190, lr_0 = 2.5768e-04
Validation rmse = 0.160178
Epoch 53
Loss = 8.2467e-02, PNorm = 35.0471, GNorm = 1.4015, lr_0 = 2.4834e-04
Validation rmse = 0.168044
Epoch 54
Loss = 9.4205e-02, PNorm = 35.0605, GNorm = 2.6450, lr_0 = 2.4014e-04
Validation rmse = 0.168484
Epoch 55
Validation rmse = 0.164645
Epoch 56
Loss = 9.9426e-02, PNorm = 35.0775, GNorm = 2.4021, lr_0 = 2.3066e-04
Validation rmse = 0.145758
Epoch 57
Loss = 9.4101e-02, PNorm = 35.0904, GNorm = 1.1044, lr_0 = 2.2305e-04
Validation rmse = 0.182467
Epoch 58
Loss = 9.3240e-02, PNorm = 35.1053, GNorm = 1.0868, lr_0 = 2.1496e-04
Loss = 1.4007e-01, PNorm = 35.1064, GNorm = 1.1618, lr_0 = 2.1424e-04
Validation rmse = 0.159565
Epoch 59
Validation rmse = 0.191353
Epoch 60
Loss = 1.0199e-01, PNorm = 35.1189, GNorm = 4.6586, lr_0 = 2.0717e-04
Validation rmse = 0.197043
Epoch 61
Loss = 1.2860e-01, PNorm = 35.1322, GNorm = 2.2307, lr_0 = 1.9966e-04
Validation rmse = 0.109066
Epoch 62
Validation rmse = 0.129630
Epoch 63
Loss = 1.4842e-01, PNorm = 35.1471, GNorm = 3.0096, lr_0 = 1.9178e-04
Validation rmse = 0.167877
Epoch 64
Loss = 8.4607e-02, PNorm = 35.1590, GNorm = 1.3893, lr_0 = 1.8545e-04
Validation rmse = 0.163043
Epoch 65
Loss = 9.2613e-02, PNorm = 35.1704, GNorm = 0.7845, lr_0 = 1.7873e-04
Validation rmse = 0.124484
Epoch 66
Validation rmse = 0.159360
Epoch 67
Loss = 8.1006e-02, PNorm = 35.1813, GNorm = 0.4763, lr_0 = 1.7225e-04
Validation rmse = 0.160706
Epoch 68
Loss = 1.1682e-01, PNorm = 35.1921, GNorm = 5.3969, lr_0 = 1.6600e-04
Validation rmse = 0.115111
Epoch 69
Loss = 8.9584e-02, PNorm = 35.2040, GNorm = 0.6971, lr_0 = 1.5999e-04
Validation rmse = 0.155754
Epoch 70
Validation rmse = 0.152387
Epoch 71
Loss = 8.6958e-02, PNorm = 35.2142, GNorm = 1.2514, lr_0 = 1.5419e-04
Validation rmse = 0.151582
Epoch 72
Loss = 8.0364e-02, PNorm = 35.2242, GNorm = 2.0667, lr_0 = 1.4860e-04
Validation rmse = 0.127548
Epoch 73
Loss = 8.4481e-02, PNorm = 35.2340, GNorm = 1.3495, lr_0 = 1.4321e-04
Validation rmse = 0.157835
Epoch 74
Validation rmse = 0.151205
Epoch 75
Loss = 9.0265e-02, PNorm = 35.2433, GNorm = 1.6007, lr_0 = 1.3802e-04
Validation rmse = 0.125296
Epoch 76
Loss = 8.4482e-02, PNorm = 35.2521, GNorm = 0.5274, lr_0 = 1.3302e-04
Validation rmse = 0.157134
Epoch 77
Validation rmse = 0.143438
Epoch 78
Loss = 5.3545e-02, PNorm = 35.2604, GNorm = 1.0104, lr_0 = 1.2820e-04
Validation rmse = 0.141834
Epoch 79
Loss = 6.8063e-02, PNorm = 35.2681, GNorm = 1.6726, lr_0 = 1.2355e-04
Validation rmse = 0.158494
Epoch 80
Loss = 7.6596e-02, PNorm = 35.2755, GNorm = 0.6381, lr_0 = 1.1947e-04
Validation rmse = 0.136827
Epoch 81
Validation rmse = 0.171516
Epoch 82
Loss = 7.1173e-02, PNorm = 35.2835, GNorm = 1.1269, lr_0 = 1.1475e-04
Validation rmse = 0.133435
Epoch 83
Loss = 8.1333e-02, PNorm = 35.2917, GNorm = 1.4630, lr_0 = 1.1059e-04
Validation rmse = 0.145855
Epoch 84
Loss = 7.6461e-02, PNorm = 35.2982, GNorm = 1.0717, lr_0 = 1.0694e-04
Loss = 6.3482e-02, PNorm = 35.2989, GNorm = 1.7001, lr_0 = 1.0659e-04
Validation rmse = 0.140490
Epoch 85
Validation rmse = 0.145117
Epoch 86
Loss = 7.2610e-02, PNorm = 35.3053, GNorm = 0.6833, lr_0 = 1.0272e-04
Validation rmse = 0.146403
Epoch 87
Loss = 7.4309e-02, PNorm = 35.3112, GNorm = 0.5703, lr_0 = 1.0000e-04
Validation rmse = 0.138260
Epoch 88
Validation rmse = 0.151800
Epoch 89
Loss = 7.1798e-02, PNorm = 35.3182, GNorm = 0.7762, lr_0 = 1.0000e-04
Validation rmse = 0.122451
Epoch 90
Loss = 8.3387e-02, PNorm = 35.3239, GNorm = 1.7674, lr_0 = 1.0000e-04
Validation rmse = 0.151897
Epoch 91
Loss = 7.5086e-02, PNorm = 35.3303, GNorm = 0.4497, lr_0 = 1.0000e-04
Validation rmse = 0.133348
Epoch 92
Validation rmse = 0.140206
Epoch 93
Loss = 7.8897e-02, PNorm = 35.3376, GNorm = 1.9999, lr_0 = 1.0000e-04
Validation rmse = 0.149552
Epoch 94
Loss = 8.1058e-02, PNorm = 35.3442, GNorm = 0.6280, lr_0 = 1.0000e-04
Validation rmse = 0.144031
Epoch 95
Loss = 7.3369e-02, PNorm = 35.3505, GNorm = 1.1590, lr_0 = 1.0000e-04
Loss = 4.5182e-02, PNorm = 35.3512, GNorm = 1.2070, lr_0 = 1.0000e-04
Validation rmse = 0.137796
Epoch 96
Validation rmse = 0.152344
Epoch 97
Loss = 6.4021e-02, PNorm = 35.3572, GNorm = 0.9616, lr_0 = 1.0000e-04
Validation rmse = 0.134734
Epoch 98
Loss = 6.7763e-02, PNorm = 35.3637, GNorm = 0.5935, lr_0 = 1.0000e-04
Validation rmse = 0.135616
Epoch 99
Loss = 7.2283e-02, PNorm = 35.3702, GNorm = 2.3839, lr_0 = 1.0000e-04
Validation rmse = 0.148596
Model 0 best validation rmse = 0.085490 on epoch 14
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.069428
Ensemble test rmse = 0.069428
1-fold cross validation
	Seed 0 ==> test rmse = 0.069428
Overall test rmse = 0.069428 +/- 0.000000
Elapsed time = 0:00:27
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 100,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 361 | train size = 357 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.139448
Epoch 1
Loss = 6.9019e-01, PNorm = 34.0293, GNorm = 6.4407, lr_0 = 8.7143e-04
Validation rmse = 0.153995
Epoch 2
Loss = 6.2495e-01, PNorm = 34.0825, GNorm = 4.8869, lr_0 = 9.7024e-04
Validation rmse = 0.195343
Epoch 3
Validation rmse = 0.173471
Epoch 4
Loss = 6.3701e-01, PNorm = 34.1444, GNorm = 9.9536, lr_0 = 9.3194e-04
Validation rmse = 0.124165
Epoch 5
Loss = 4.0129e-01, PNorm = 34.2028, GNorm = 6.0333, lr_0 = 8.9816e-04
Validation rmse = 0.120777
Epoch 6
Validation rmse = 0.142126
Epoch 7
Loss = 2.7175e-01, PNorm = 34.2603, GNorm = 1.6511, lr_0 = 8.6270e-04
Validation rmse = 0.154842
Epoch 8
Loss = 2.5741e-01, PNorm = 34.2991, GNorm = 0.7341, lr_0 = 8.3422e-04
Validation rmse = 0.167645
Epoch 9
Loss = 2.7658e-01, PNorm = 34.3350, GNorm = 0.9482, lr_0 = 8.0398e-04
Validation rmse = 0.185456
Epoch 10
Validation rmse = 0.165622
Epoch 11
Loss = 3.0665e-01, PNorm = 34.3685, GNorm = 3.7912, lr_0 = 7.7224e-04
Validation rmse = 0.166374
Epoch 12
Loss = 2.1532e-01, PNorm = 34.3978, GNorm = 3.2917, lr_0 = 7.4425e-04
Validation rmse = 0.170505
Epoch 13
Validation rmse = 0.176366
Epoch 14
Loss = 2.6092e-01, PNorm = 34.4226, GNorm = 5.3526, lr_0 = 7.1487e-04
Validation rmse = 0.191806
Epoch 15
Loss = 2.2319e-01, PNorm = 34.4482, GNorm = 3.7856, lr_0 = 6.9127e-04
Validation rmse = 0.177617
Epoch 16
Loss = 2.0368e-01, PNorm = 34.4755, GNorm = 4.1582, lr_0 = 6.6622e-04
Validation rmse = 0.181484
Epoch 17
Validation rmse = 0.173049
Epoch 18
Loss = 2.0121e-01, PNorm = 34.5083, GNorm = 2.1351, lr_0 = 6.3992e-04
Validation rmse = 0.179863
Epoch 19
Loss = 1.8212e-01, PNorm = 34.5328, GNorm = 1.4905, lr_0 = 6.1672e-04
Validation rmse = 0.173484
Epoch 20
Validation rmse = 0.188962
Epoch 21
Loss = 2.0721e-01, PNorm = 34.5552, GNorm = 1.8543, lr_0 = 5.9237e-04
Validation rmse = 0.192704
Epoch 22
Loss = 1.4548e-01, PNorm = 34.5744, GNorm = 3.0228, lr_0 = 5.7282e-04
Validation rmse = 0.200959
Epoch 23
Loss = 1.5119e-01, PNorm = 34.5951, GNorm = 0.6900, lr_0 = 5.5206e-04
Validation rmse = 0.184075
Epoch 24
Validation rmse = 0.191881
Epoch 25
Loss = 1.8580e-01, PNorm = 34.6169, GNorm = 4.3755, lr_0 = 5.3026e-04
Validation rmse = 0.186537
Epoch 26
Loss = 1.7052e-01, PNorm = 34.6396, GNorm = 5.2931, lr_0 = 5.1104e-04
Validation rmse = 0.178225
Epoch 27
Validation rmse = 0.186671
Epoch 28
Loss = 1.7435e-01, PNorm = 34.6675, GNorm = 1.6759, lr_0 = 4.9087e-04
Validation rmse = 0.190433
Epoch 29
Loss = 1.6113e-01, PNorm = 34.6879, GNorm = 5.1445, lr_0 = 4.7466e-04
Validation rmse = 0.188495
Epoch 30
Loss = 1.4123e-01, PNorm = 34.7065, GNorm = 2.1419, lr_0 = 4.5746e-04
Validation rmse = 0.184399
Epoch 31
Validation rmse = 0.177731
Epoch 32
Loss = 1.1211e-01, PNorm = 34.7281, GNorm = 0.5668, lr_0 = 4.3940e-04
Validation rmse = 0.197258
Epoch 33
Loss = 1.9575e-01, PNorm = 34.7519, GNorm = 7.8939, lr_0 = 4.2347e-04
Validation rmse = 0.192652
Epoch 34
Validation rmse = 0.176756
Epoch 35
Loss = 2.1993e-01, PNorm = 34.7759, GNorm = 6.1204, lr_0 = 4.0675e-04
Validation rmse = 0.174697
Epoch 36
Loss = 1.9091e-01, PNorm = 34.7948, GNorm = 4.4966, lr_0 = 3.9333e-04
Validation rmse = 0.196324
Epoch 37
Loss = 1.5732e-01, PNorm = 34.8159, GNorm = 1.8171, lr_0 = 3.7907e-04
Validation rmse = 0.174049
Epoch 38
Validation rmse = 0.175091
Epoch 39
Loss = 1.0372e-01, PNorm = 34.8363, GNorm = 1.4729, lr_0 = 3.6410e-04
Validation rmse = 0.177232
Epoch 40
Loss = 1.4989e-01, PNorm = 34.8528, GNorm = 2.3607, lr_0 = 3.5090e-04
Validation rmse = 0.169612
Epoch 41
Validation rmse = 0.185181
Epoch 42
Loss = 1.3232e-01, PNorm = 34.8703, GNorm = 1.2324, lr_0 = 3.3705e-04
Validation rmse = 0.174159
Epoch 43
Loss = 1.3852e-01, PNorm = 34.8828, GNorm = 1.9014, lr_0 = 3.2593e-04
Validation rmse = 0.174103
Epoch 44
Loss = 1.2454e-01, PNorm = 34.8973, GNorm = 2.5700, lr_0 = 3.1411e-04
Validation rmse = 0.168892
Epoch 45
Validation rmse = 0.169162
Epoch 46
Loss = 1.4638e-01, PNorm = 34.9112, GNorm = 2.4859, lr_0 = 3.0171e-04
Validation rmse = 0.178782
Epoch 47
Loss = 1.1180e-01, PNorm = 34.9254, GNorm = 0.7766, lr_0 = 2.9077e-04
Validation rmse = 0.172767
Epoch 48
Validation rmse = 0.175498
Epoch 49
Loss = 1.1561e-01, PNorm = 34.9402, GNorm = 1.2374, lr_0 = 2.7930e-04
Validation rmse = 0.176107
Epoch 50
Loss = 1.0479e-01, PNorm = 34.9526, GNorm = 2.6791, lr_0 = 2.7008e-04
Validation rmse = 0.172453
Epoch 51
Loss = 1.1890e-01, PNorm = 34.9675, GNorm = 0.4649, lr_0 = 2.6029e-04
Validation rmse = 0.170838
Epoch 52
Validation rmse = 0.184283
Epoch 53
Loss = 1.1202e-01, PNorm = 34.9822, GNorm = 1.8959, lr_0 = 2.5001e-04
Validation rmse = 0.176514
Epoch 54
Loss = 1.1116e-01, PNorm = 34.9954, GNorm = 5.0121, lr_0 = 2.4095e-04
Validation rmse = 0.169114
Epoch 55
Validation rmse = 0.170930
Epoch 56
Loss = 8.7310e-02, PNorm = 35.0102, GNorm = 2.3298, lr_0 = 2.3144e-04
Validation rmse = 0.177268
Epoch 57
Loss = 1.1307e-01, PNorm = 35.0217, GNorm = 1.6751, lr_0 = 2.2305e-04
Validation rmse = 0.176634
Epoch 58
Loss = 9.8600e-02, PNorm = 35.0318, GNorm = 1.1357, lr_0 = 2.1568e-04
Validation rmse = 0.172118
Epoch 59
Validation rmse = 0.169273
Epoch 60
Loss = 7.9843e-02, PNorm = 35.0417, GNorm = 1.3095, lr_0 = 2.0717e-04
Validation rmse = 0.174466
Epoch 61
Loss = 1.0467e-01, PNorm = 35.0528, GNorm = 1.1691, lr_0 = 1.9966e-04
Validation rmse = 0.173839
Epoch 62
Validation rmse = 0.174406
Epoch 63
Loss = 1.0576e-01, PNorm = 35.0633, GNorm = 2.1692, lr_0 = 1.9178e-04
Validation rmse = 0.181489
Epoch 64
Loss = 9.1347e-02, PNorm = 35.0719, GNorm = 1.8331, lr_0 = 1.8483e-04
Validation rmse = 0.180644
Epoch 65
Loss = 9.0841e-02, PNorm = 35.0799, GNorm = 1.0735, lr_0 = 1.7873e-04
Validation rmse = 0.180102
Epoch 66
Validation rmse = 0.175795
Epoch 67
Loss = 7.5897e-02, PNorm = 35.0906, GNorm = 0.7327, lr_0 = 1.7167e-04
Validation rmse = 0.177841
Epoch 68
Loss = 9.6318e-02, PNorm = 35.1010, GNorm = 0.6899, lr_0 = 1.6545e-04
Validation rmse = 0.175400
Epoch 69
Validation rmse = 0.172307
Epoch 70
Loss = 9.8587e-02, PNorm = 35.1093, GNorm = 2.4398, lr_0 = 1.5892e-04
Validation rmse = 0.168268
Epoch 71
Loss = 1.0438e-01, PNorm = 35.1165, GNorm = 2.4088, lr_0 = 1.5316e-04
Validation rmse = 0.172957
Epoch 72
Loss = 8.8225e-02, PNorm = 35.1227, GNorm = 0.7246, lr_0 = 1.4810e-04
Validation rmse = 0.175287
Epoch 73
Validation rmse = 0.173958
Epoch 74
Loss = 9.8628e-02, PNorm = 35.1306, GNorm = 0.7982, lr_0 = 1.4225e-04
Validation rmse = 0.168119
Epoch 75
Loss = 8.5145e-02, PNorm = 35.1385, GNorm = 1.5596, lr_0 = 1.3710e-04
Validation rmse = 0.168624
Epoch 76
Validation rmse = 0.169714
Epoch 77
Loss = 1.0959e-01, PNorm = 35.1458, GNorm = 2.0272, lr_0 = 1.3168e-04
Validation rmse = 0.166586
Epoch 78
Loss = 8.7666e-02, PNorm = 35.1526, GNorm = 1.5009, lr_0 = 1.2691e-04
Validation rmse = 0.173226
Epoch 79
Loss = 9.8128e-02, PNorm = 35.1593, GNorm = 1.5057, lr_0 = 1.2272e-04
Validation rmse = 0.173060
Epoch 80
Validation rmse = 0.172536
Epoch 81
Loss = 8.7581e-02, PNorm = 35.1654, GNorm = 0.6123, lr_0 = 1.1788e-04
Validation rmse = 0.168371
Epoch 82
Loss = 8.7629e-02, PNorm = 35.1713, GNorm = 0.5880, lr_0 = 1.1360e-04
Validation rmse = 0.168359
Epoch 83
Validation rmse = 0.171261
Epoch 84
Loss = 7.3599e-02, PNorm = 35.1781, GNorm = 0.8792, lr_0 = 1.0912e-04
Validation rmse = 0.171529
Epoch 85
Loss = 8.7343e-02, PNorm = 35.1838, GNorm = 2.1160, lr_0 = 1.0516e-04
Validation rmse = 0.172907
Epoch 86
Loss = 7.9431e-02, PNorm = 35.1888, GNorm = 1.1828, lr_0 = 1.0169e-04
Validation rmse = 0.172729
Epoch 87
Validation rmse = 0.168069
Epoch 88
Loss = 8.3259e-02, PNorm = 35.1942, GNorm = 0.9225, lr_0 = 1.0000e-04
Validation rmse = 0.166706
Epoch 89
Loss = 8.2443e-02, PNorm = 35.1994, GNorm = 1.7072, lr_0 = 1.0000e-04
Validation rmse = 0.170032
Epoch 90
Validation rmse = 0.169657
Epoch 91
Loss = 9.1331e-02, PNorm = 35.2052, GNorm = 0.6716, lr_0 = 1.0000e-04
Validation rmse = 0.170641
Epoch 92
Loss = 8.6245e-02, PNorm = 35.2111, GNorm = 0.5259, lr_0 = 1.0000e-04
Validation rmse = 0.169054
Epoch 93
Loss = 7.8148e-02, PNorm = 35.2161, GNorm = 0.5250, lr_0 = 1.0000e-04
Validation rmse = 0.167519
Epoch 94
Validation rmse = 0.167488
Epoch 95
Loss = 7.9241e-02, PNorm = 35.2229, GNorm = 1.3627, lr_0 = 1.0000e-04
Validation rmse = 0.166339
Epoch 96
Loss = 7.7527e-02, PNorm = 35.2285, GNorm = 0.9051, lr_0 = 1.0000e-04
Validation rmse = 0.164038
Epoch 97
Validation rmse = 0.166990
Epoch 98
Loss = 9.0557e-02, PNorm = 35.2343, GNorm = 1.7140, lr_0 = 1.0000e-04
Validation rmse = 0.166257
Epoch 99
Loss = 7.3762e-02, PNorm = 35.2398, GNorm = 0.6491, lr_0 = 1.0000e-04
Validation rmse = 0.165703
Model 0 best validation rmse = 0.120777 on epoch 5
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.146783
Ensemble test rmse = 0.146783
1-fold cross validation
	Seed 0 ==> test rmse = 0.146783
Overall test rmse = 0.146783 +/- 0.000000
Elapsed time = 0:00:26
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 100,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 353 | train size = 349 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.118832
Epoch 1
Loss = 6.1166e-01, PNorm = 34.0349, GNorm = 1.6237, lr_0 = 1.0000e-03
Validation rmse = 0.173346
Epoch 2
Loss = 4.3180e-01, PNorm = 34.0958, GNorm = 13.6192, lr_0 = 9.6160e-04
Validation rmse = 0.138810
Epoch 3
Validation rmse = 0.188241
Epoch 4
Loss = 2.8216e-01, PNorm = 34.1510, GNorm = 0.9960, lr_0 = 9.2467e-04
Validation rmse = 0.137381
Epoch 5
Loss = 2.5486e-01, PNorm = 34.1968, GNorm = 3.2735, lr_0 = 8.8916e-04
Validation rmse = 0.182902
Epoch 6
Validation rmse = 0.072655
Epoch 7
Loss = 2.6039e-01, PNorm = 34.2287, GNorm = 6.8673, lr_0 = 8.5501e-04
Validation rmse = 0.191452
Epoch 8
Loss = 2.4373e-01, PNorm = 34.2567, GNorm = 7.8290, lr_0 = 8.2218e-04
Validation rmse = 0.204564
Epoch 9
Validation rmse = 0.167222
Epoch 10
Loss = 1.5841e-01, PNorm = 34.2857, GNorm = 5.8544, lr_0 = 7.9060e-04
Validation rmse = 0.130410
Epoch 11
Loss = 1.6772e-01, PNorm = 34.3114, GNorm = 0.8604, lr_0 = 7.6024e-04
Validation rmse = 0.080699
Epoch 12
Loss = 1.5760e-01, PNorm = 34.3345, GNorm = 1.4424, lr_0 = 7.3105e-04
Validation rmse = 0.071987
Epoch 13
Validation rmse = 0.065131
Epoch 14
Loss = 1.2201e-01, PNorm = 34.3566, GNorm = 0.6737, lr_0 = 7.0297e-04
Validation rmse = 0.060232
Epoch 15
Loss = 1.7018e-01, PNorm = 34.3787, GNorm = 6.1431, lr_0 = 6.7598e-04
Validation rmse = 0.030716
Epoch 16
Validation rmse = 0.037649
Epoch 17
Loss = 1.7189e-01, PNorm = 34.3974, GNorm = 1.4998, lr_0 = 6.5002e-04
Validation rmse = 0.042206
Epoch 18
Loss = 1.6558e-01, PNorm = 34.4182, GNorm = 1.0951, lr_0 = 6.2506e-04
Validation rmse = 0.060463
Epoch 19
Validation rmse = 0.087513
Epoch 20
Loss = 1.2546e-01, PNorm = 34.4403, GNorm = 2.1564, lr_0 = 6.0105e-04
Validation rmse = 0.081823
Epoch 21
Loss = 1.2615e-01, PNorm = 34.4586, GNorm = 2.3033, lr_0 = 5.7797e-04
Validation rmse = 0.078754
Epoch 22
Loss = 1.2891e-01, PNorm = 34.4782, GNorm = 1.7551, lr_0 = 5.5577e-04
Validation rmse = 0.091456
Epoch 23
Validation rmse = 0.111944
Epoch 24
Loss = 1.3874e-01, PNorm = 34.4965, GNorm = 2.1514, lr_0 = 5.3443e-04
Validation rmse = 0.106912
Epoch 25
Loss = 1.4037e-01, PNorm = 34.5139, GNorm = 3.9231, lr_0 = 5.1391e-04
Validation rmse = 0.096847
Epoch 26
Validation rmse = 0.065996
Epoch 27
Loss = 1.0734e-01, PNorm = 34.5335, GNorm = 0.9550, lr_0 = 4.9417e-04
Validation rmse = 0.056283
Epoch 28
Loss = 1.2409e-01, PNorm = 34.5526, GNorm = 2.0187, lr_0 = 4.7519e-04
Validation rmse = 0.040807
Epoch 29
Validation rmse = 0.073081
Epoch 30
Loss = 1.3213e-01, PNorm = 34.5692, GNorm = 1.2291, lr_0 = 4.5695e-04
Validation rmse = 0.062927
Epoch 31
Loss = 1.0503e-01, PNorm = 34.5878, GNorm = 2.2823, lr_0 = 4.3940e-04
Validation rmse = 0.068778
Epoch 32
Loss = 1.1820e-01, PNorm = 34.6057, GNorm = 5.3876, lr_0 = 4.2252e-04
Validation rmse = 0.070199
Epoch 33
Validation rmse = 0.087265
Epoch 34
Loss = 1.1360e-01, PNorm = 34.6237, GNorm = 1.3212, lr_0 = 4.0630e-04
Validation rmse = 0.069645
Epoch 35
Loss = 1.0421e-01, PNorm = 34.6405, GNorm = 0.6515, lr_0 = 3.9069e-04
Validation rmse = 0.078028
Epoch 36
Validation rmse = 0.078023
Epoch 37
Loss = 1.1124e-01, PNorm = 34.6573, GNorm = 1.9145, lr_0 = 3.7569e-04
Validation rmse = 0.050916
Epoch 38
Loss = 1.0231e-01, PNorm = 34.6741, GNorm = 1.1649, lr_0 = 3.6126e-04
Validation rmse = 0.048214
Epoch 39
Validation rmse = 0.044589
Epoch 40
Loss = 9.1755e-02, PNorm = 34.6902, GNorm = 1.4196, lr_0 = 3.4739e-04
Validation rmse = 0.056933
Epoch 41
Loss = 1.1029e-01, PNorm = 34.7067, GNorm = 2.4862, lr_0 = 3.3405e-04
Validation rmse = 0.049456
Epoch 42
Loss = 9.7828e-02, PNorm = 34.7233, GNorm = 1.8020, lr_0 = 3.2122e-04
Validation rmse = 0.046704
Epoch 43
Validation rmse = 0.040558
Epoch 44
Loss = 9.6662e-02, PNorm = 34.7384, GNorm = 3.1933, lr_0 = 3.0888e-04
Validation rmse = 0.060008
Epoch 45
Loss = 9.4444e-02, PNorm = 34.7542, GNorm = 1.7251, lr_0 = 2.9702e-04
Validation rmse = 0.055510
Epoch 46
Validation rmse = 0.055191
Epoch 47
Loss = 1.1656e-01, PNorm = 34.7687, GNorm = 3.8428, lr_0 = 2.8562e-04
Validation rmse = 0.035044
Epoch 48
Loss = 9.5927e-02, PNorm = 34.7826, GNorm = 3.1664, lr_0 = 2.7465e-04
Validation rmse = 0.047375
Epoch 49
Validation rmse = 0.037978
Epoch 50
Loss = 7.3362e-02, PNorm = 34.7956, GNorm = 1.8129, lr_0 = 2.6410e-04
Validation rmse = 0.043934
Epoch 51
Loss = 9.7782e-02, PNorm = 34.8099, GNorm = 3.3621, lr_0 = 2.5297e-04
Validation rmse = 0.063100
Epoch 52
Validation rmse = 0.046175
Epoch 53
Loss = 9.8333e-02, PNorm = 34.8214, GNorm = 3.6525, lr_0 = 2.4325e-04
Validation rmse = 0.047898
Epoch 54
Loss = 7.0626e-02, PNorm = 34.8340, GNorm = 2.7973, lr_0 = 2.3391e-04
Validation rmse = 0.038760
Epoch 55
Loss = 9.9551e-02, PNorm = 34.8453, GNorm = 2.4383, lr_0 = 2.2493e-04
Validation rmse = 0.078429
Epoch 56
Validation rmse = 0.072515
Epoch 57
Loss = 8.1570e-02, PNorm = 34.8555, GNorm = 1.9707, lr_0 = 2.1629e-04
Validation rmse = 0.058114
Epoch 58
Loss = 8.9718e-02, PNorm = 34.8669, GNorm = 0.7353, lr_0 = 2.0798e-04
Validation rmse = 0.035930
Epoch 59
Validation rmse = 0.052857
Epoch 60
Loss = 8.2615e-02, PNorm = 34.8765, GNorm = 2.1344, lr_0 = 2.0000e-04
Validation rmse = 0.077794
Epoch 61
Loss = 7.8450e-02, PNorm = 34.8861, GNorm = 2.7689, lr_0 = 1.9232e-04
Validation rmse = 0.073521
Epoch 62
Validation rmse = 0.037815
Epoch 63
Loss = 9.6792e-02, PNorm = 34.8952, GNorm = 3.3335, lr_0 = 1.8493e-04
Validation rmse = 0.053218
Epoch 64
Loss = 7.1294e-02, PNorm = 34.9040, GNorm = 2.9631, lr_0 = 1.7783e-04
Validation rmse = 0.071695
Epoch 65
Loss = 7.9083e-02, PNorm = 34.9127, GNorm = 3.1162, lr_0 = 1.7100e-04
Validation rmse = 0.068997
Epoch 66
Validation rmse = 0.056298
Epoch 67
Loss = 7.1092e-02, PNorm = 34.9217, GNorm = 2.4723, lr_0 = 1.6443e-04
Validation rmse = 0.054841
Epoch 68
Loss = 7.5073e-02, PNorm = 34.9299, GNorm = 2.9642, lr_0 = 1.5812e-04
Validation rmse = 0.056466
Epoch 69
Validation rmse = 0.079108
Epoch 70
Loss = 7.7096e-02, PNorm = 34.9379, GNorm = 2.0692, lr_0 = 1.5205e-04
Validation rmse = 0.065981
Epoch 71
Loss = 8.5888e-02, PNorm = 34.9461, GNorm = 2.3283, lr_0 = 1.4621e-04
Validation rmse = 0.042822
Epoch 72
Validation rmse = 0.081480
Epoch 73
Loss = 9.0110e-02, PNorm = 34.9532, GNorm = 5.9336, lr_0 = 1.4059e-04
Validation rmse = 0.081791
Epoch 74
Loss = 8.2266e-02, PNorm = 34.9605, GNorm = 0.7773, lr_0 = 1.3519e-04
Validation rmse = 0.049792
Epoch 75
Loss = 7.1741e-02, PNorm = 34.9671, GNorm = 0.5264, lr_0 = 1.3000e-04
Validation rmse = 0.080751
Epoch 76
Validation rmse = 0.054077
Epoch 77
Loss = 8.2828e-02, PNorm = 34.9735, GNorm = 1.0751, lr_0 = 1.2501e-04
Validation rmse = 0.048424
Epoch 78
Loss = 7.4179e-02, PNorm = 34.9800, GNorm = 2.5213, lr_0 = 1.2021e-04
Validation rmse = 0.066457
Epoch 79
Validation rmse = 0.062639
Epoch 80
Loss = 6.1554e-02, PNorm = 34.9860, GNorm = 0.8539, lr_0 = 1.1559e-04
Validation rmse = 0.059486
Epoch 81
Loss = 7.3073e-02, PNorm = 34.9921, GNorm = 4.2026, lr_0 = 1.1115e-04
Validation rmse = 0.051230
Epoch 82
Validation rmse = 0.093617
Epoch 83
Loss = 7.7339e-02, PNorm = 34.9976, GNorm = 2.8856, lr_0 = 1.0688e-04
Validation rmse = 0.053282
Epoch 84
Loss = 7.3595e-02, PNorm = 35.0029, GNorm = 1.1068, lr_0 = 1.0278e-04
Validation rmse = 0.064098
Epoch 85
Loss = 6.9818e-02, PNorm = 35.0082, GNorm = 1.2968, lr_0 = 1.0000e-04
Validation rmse = 0.065712
Epoch 86
Validation rmse = 0.055245
Epoch 87
Loss = 7.6886e-02, PNorm = 35.0133, GNorm = 0.7629, lr_0 = 1.0000e-04
Validation rmse = 0.080790
Epoch 88
Loss = 6.8515e-02, PNorm = 35.0182, GNorm = 1.4110, lr_0 = 1.0000e-04
Validation rmse = 0.048619
Epoch 89
Validation rmse = 0.067434
Epoch 90
Loss = 6.6929e-02, PNorm = 35.0235, GNorm = 0.4269, lr_0 = 1.0000e-04
Validation rmse = 0.063171
Epoch 91
Loss = 7.0198e-02, PNorm = 35.0287, GNorm = 0.6236, lr_0 = 1.0000e-04
Validation rmse = 0.059630
Epoch 92
Validation rmse = 0.068977
Epoch 93
Loss = 5.5943e-02, PNorm = 35.0338, GNorm = 0.7904, lr_0 = 1.0000e-04
Validation rmse = 0.060398
Epoch 94
Loss = 6.1944e-02, PNorm = 35.0391, GNorm = 0.5783, lr_0 = 1.0000e-04
Validation rmse = 0.070353
Epoch 95
Loss = 6.6188e-02, PNorm = 35.0443, GNorm = 0.9050, lr_0 = 1.0000e-04
Validation rmse = 0.060834
Epoch 96
Validation rmse = 0.073089
Epoch 97
Loss = 6.4874e-02, PNorm = 35.0494, GNorm = 1.7945, lr_0 = 1.0000e-04
Validation rmse = 0.066883
Epoch 98
Loss = 6.6081e-02, PNorm = 35.0543, GNorm = 1.7008, lr_0 = 1.0000e-04
Validation rmse = 0.058707
Epoch 99
Validation rmse = 0.073259
Model 0 best validation rmse = 0.030716 on epoch 15
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.115073
Ensemble test rmse = 0.115073
1-fold cross validation
	Seed 0 ==> test rmse = 0.115073
Overall test rmse = 0.115073 +/- 0.000000
Elapsed time = 0:00:26
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 100,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 345 | train size = 341 | val size = 2 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.275442
Epoch 1
Loss = 7.0815e-01, PNorm = 34.0357, GNorm = 3.9752, lr_0 = 1.0000e-03
Validation rmse = 0.324496
Epoch 2
Loss = 6.1675e-01, PNorm = 34.0894, GNorm = 8.1427, lr_0 = 9.6160e-04
Validation rmse = 0.296821
Epoch 3
Validation rmse = 0.213104
Epoch 4
Loss = 2.9441e-01, PNorm = 34.1499, GNorm = 2.1541, lr_0 = 9.2467e-04
Validation rmse = 0.170697
Epoch 5
Loss = 2.6183e-01, PNorm = 34.2033, GNorm = 1.6119, lr_0 = 8.8916e-04
Loss = 2.7974e-01, PNorm = 34.2079, GNorm = 3.1282, lr_0 = 8.8568e-04
Validation rmse = 0.131260
Epoch 6
Validation rmse = 0.111902
Epoch 7
Loss = 2.4654e-01, PNorm = 34.2476, GNorm = 0.6417, lr_0 = 8.5167e-04
Validation rmse = 0.128318
Epoch 8
Loss = 1.7821e-01, PNorm = 34.2776, GNorm = 2.7865, lr_0 = 8.1896e-04
Validation rmse = 0.151816
Epoch 9
Validation rmse = 0.192877
Epoch 10
Loss = 2.0715e-01, PNorm = 34.3062, GNorm = 8.1126, lr_0 = 7.8751e-04
Validation rmse = 0.252484
Epoch 11
Loss = 2.3040e-01, PNorm = 34.3344, GNorm = 4.7132, lr_0 = 7.5727e-04
Validation rmse = 0.187086
Epoch 12
Validation rmse = 0.145348
Epoch 13
Loss = 1.8741e-01, PNorm = 34.3633, GNorm = 4.0740, lr_0 = 7.2534e-04
Validation rmse = 0.110594
Epoch 14
Loss = 1.7377e-01, PNorm = 34.3892, GNorm = 1.0892, lr_0 = 6.9749e-04
Validation rmse = 0.111648
Epoch 15
Validation rmse = 0.109368
Epoch 16
Loss = 1.8445e-01, PNorm = 34.4093, GNorm = 4.9816, lr_0 = 6.7070e-04
Validation rmse = 0.131199
Epoch 17
Loss = 1.3354e-01, PNorm = 34.4321, GNorm = 2.4116, lr_0 = 6.4243e-04
Validation rmse = 0.130314
Epoch 18
Validation rmse = 0.115106
Epoch 19
Loss = 1.0593e-01, PNorm = 34.4520, GNorm = 2.9599, lr_0 = 6.1776e-04
Validation rmse = 0.086933
Epoch 20
Loss = 1.4232e-01, PNorm = 34.4697, GNorm = 3.7207, lr_0 = 5.9403e-04
Validation rmse = 0.098728
Epoch 21
Loss = 1.2522e-01, PNorm = 34.4878, GNorm = 0.8569, lr_0 = 5.7122e-04
Validation rmse = 0.099396
Epoch 22
Validation rmse = 0.148903
Epoch 23
Loss = 1.1734e-01, PNorm = 34.5090, GNorm = 1.9154, lr_0 = 5.4714e-04
Validation rmse = 0.123358
Epoch 24
Loss = 1.1206e-01, PNorm = 34.5253, GNorm = 1.0887, lr_0 = 5.2612e-04
Validation rmse = 0.128889
Epoch 25
Validation rmse = 0.146368
Epoch 26
Loss = 1.2017e-01, PNorm = 34.5412, GNorm = 3.7408, lr_0 = 5.0592e-04
Validation rmse = 0.092268
Epoch 27
Loss = 1.2195e-01, PNorm = 34.5592, GNorm = 3.4760, lr_0 = 4.8649e-04
Loss = 1.5145e-01, PNorm = 34.5602, GNorm = 6.1965, lr_0 = 4.8459e-04
Validation rmse = 0.111709
Epoch 28
Validation rmse = 0.111141
Epoch 29
Loss = 1.1543e-01, PNorm = 34.5738, GNorm = 1.3915, lr_0 = 4.6598e-04
Validation rmse = 0.105469
Epoch 30
Loss = 9.7808e-02, PNorm = 34.5898, GNorm = 1.6443, lr_0 = 4.4809e-04
Validation rmse = 0.119367
Epoch 31
Validation rmse = 0.113281
Epoch 32
Loss = 9.0473e-02, PNorm = 34.6052, GNorm = 2.0185, lr_0 = 4.3088e-04
Validation rmse = 0.140381
Epoch 33
Loss = 9.9537e-02, PNorm = 34.6189, GNorm = 0.7589, lr_0 = 4.1433e-04
Validation rmse = 0.100044
Epoch 34
Validation rmse = 0.119913
Epoch 35
Loss = 8.9195e-02, PNorm = 34.6359, GNorm = 0.5462, lr_0 = 3.9686e-04
Validation rmse = 0.129451
Epoch 36
Loss = 9.5149e-02, PNorm = 34.6511, GNorm = 1.9347, lr_0 = 3.8162e-04
Validation rmse = 0.131867
Epoch 37
Validation rmse = 0.094533
Epoch 38
Loss = 1.0714e-01, PNorm = 34.6660, GNorm = 0.6891, lr_0 = 3.6697e-04
Validation rmse = 0.102346
Epoch 39
Loss = 9.2484e-02, PNorm = 34.6821, GNorm = 1.1186, lr_0 = 3.5149e-04
Validation rmse = 0.095890
Epoch 40
Validation rmse = 0.109332
Epoch 41
Loss = 6.5589e-02, PNorm = 34.6943, GNorm = 1.0708, lr_0 = 3.3800e-04
Validation rmse = 0.101998
Epoch 42
Loss = 8.3820e-02, PNorm = 34.7067, GNorm = 0.6904, lr_0 = 3.2502e-04
Validation rmse = 0.084803
Epoch 43
Loss = 8.9504e-02, PNorm = 34.7196, GNorm = 1.1140, lr_0 = 3.1253e-04
Validation rmse = 0.084876
Epoch 44
Validation rmse = 0.089988
Epoch 45
Loss = 8.6142e-02, PNorm = 34.7331, GNorm = 1.2879, lr_0 = 2.9936e-04
Validation rmse = 0.099428
Epoch 46
Loss = 8.7727e-02, PNorm = 34.7443, GNorm = 1.8893, lr_0 = 2.8786e-04
Validation rmse = 0.114397
Epoch 47
Validation rmse = 0.098088
Epoch 48
Loss = 8.8932e-02, PNorm = 34.7573, GNorm = 1.5863, lr_0 = 2.7681e-04
Validation rmse = 0.093795
Epoch 49
Loss = 8.0770e-02, PNorm = 34.7683, GNorm = 0.5026, lr_0 = 2.6618e-04
Validation rmse = 0.091982
Epoch 50
Validation rmse = 0.080199
Epoch 51
Loss = 8.1110e-02, PNorm = 34.7807, GNorm = 2.8365, lr_0 = 2.5495e-04
Validation rmse = 0.083697
Epoch 52
Loss = 7.7789e-02, PNorm = 34.7929, GNorm = 0.9747, lr_0 = 2.4516e-04
Validation rmse = 0.096299
Epoch 53
Validation rmse = 0.096880
Epoch 54
Loss = 6.7443e-02, PNorm = 34.8037, GNorm = 0.6987, lr_0 = 2.3575e-04
Validation rmse = 0.078999
Epoch 55
Loss = 7.7910e-02, PNorm = 34.8138, GNorm = 2.2888, lr_0 = 2.2670e-04
Validation rmse = 0.076817
Epoch 56
Validation rmse = 0.098101
Epoch 57
Loss = 8.6518e-02, PNorm = 34.8256, GNorm = 1.2601, lr_0 = 2.1714e-04
Validation rmse = 0.095944
Epoch 58
Loss = 7.4295e-02, PNorm = 34.8348, GNorm = 0.5851, lr_0 = 2.0880e-04
Validation rmse = 0.078707
Epoch 59
Validation rmse = 0.086361
Epoch 60
Loss = 7.0177e-02, PNorm = 34.8446, GNorm = 1.5329, lr_0 = 2.0078e-04
Validation rmse = 0.089368
Epoch 61
Loss = 7.9446e-02, PNorm = 34.8534, GNorm = 2.5733, lr_0 = 1.9307e-04
Validation rmse = 0.076053
Epoch 62
Validation rmse = 0.085167
Epoch 63
Loss = 9.0677e-02, PNorm = 34.8635, GNorm = 0.7109, lr_0 = 1.8493e-04
Validation rmse = 0.084346
Epoch 64
Loss = 7.7002e-02, PNorm = 34.8720, GNorm = 0.4027, lr_0 = 1.7783e-04
Validation rmse = 0.083981
Epoch 65
Loss = 7.6629e-02, PNorm = 34.8802, GNorm = 2.3966, lr_0 = 1.7100e-04
Validation rmse = 0.094474
Epoch 66
Validation rmse = 0.073170
Epoch 67
Loss = 6.7295e-02, PNorm = 34.8887, GNorm = 1.0152, lr_0 = 1.6379e-04
Validation rmse = 0.078819
Epoch 68
Loss = 7.2179e-02, PNorm = 34.8962, GNorm = 1.7138, lr_0 = 1.5750e-04
Validation rmse = 0.090198
Epoch 69
Validation rmse = 0.080230
Epoch 70
Loss = 6.9756e-02, PNorm = 34.9034, GNorm = 1.2993, lr_0 = 1.5145e-04
Validation rmse = 0.071290
Epoch 71
Loss = 7.1994e-02, PNorm = 34.9102, GNorm = 2.6816, lr_0 = 1.4563e-04
Validation rmse = 0.093023
Epoch 72
Validation rmse = 0.081145
Epoch 73
Loss = 6.3750e-02, PNorm = 34.9176, GNorm = 2.1952, lr_0 = 1.3949e-04
Validation rmse = 0.078190
Epoch 74
Loss = 7.0452e-02, PNorm = 34.9245, GNorm = 1.5250, lr_0 = 1.3414e-04
Validation rmse = 0.084939
Epoch 75
Validation rmse = 0.084731
Epoch 76
Loss = 5.3700e-02, PNorm = 34.9314, GNorm = 1.4238, lr_0 = 1.2899e-04
Validation rmse = 0.075484
Epoch 77
Loss = 6.5017e-02, PNorm = 34.9375, GNorm = 1.5574, lr_0 = 1.2403e-04
Validation rmse = 0.080656
Epoch 78
Validation rmse = 0.081398
Epoch 79
Loss = 7.1787e-02, PNorm = 34.9437, GNorm = 0.7720, lr_0 = 1.1880e-04
Validation rmse = 0.074405
Epoch 80
Loss = 6.9405e-02, PNorm = 34.9494, GNorm = 0.8446, lr_0 = 1.1424e-04
Validation rmse = 0.080590
Epoch 81
Validation rmse = 0.080333
Epoch 82
Loss = 8.1264e-02, PNorm = 34.9546, GNorm = 0.9106, lr_0 = 1.0985e-04
Validation rmse = 0.080334
Epoch 83
Loss = 6.6362e-02, PNorm = 34.9600, GNorm = 1.5079, lr_0 = 1.0564e-04
Validation rmse = 0.076940
Epoch 84
Validation rmse = 0.080027
Epoch 85
Loss = 7.7379e-02, PNorm = 34.9653, GNorm = 1.2122, lr_0 = 1.0118e-04
Validation rmse = 0.078822
Epoch 86
Loss = 6.9737e-02, PNorm = 34.9704, GNorm = 1.5560, lr_0 = 1.0000e-04
Validation rmse = 0.070034
Epoch 87
Loss = 6.3883e-02, PNorm = 34.9752, GNorm = 0.7435, lr_0 = 1.0000e-04
Validation rmse = 0.082952
Epoch 88
Validation rmse = 0.075965
Epoch 89
Loss = 5.6795e-02, PNorm = 34.9806, GNorm = 0.5087, lr_0 = 1.0000e-04
Validation rmse = 0.073783
Epoch 90
Loss = 6.3121e-02, PNorm = 34.9856, GNorm = 0.9542, lr_0 = 1.0000e-04
Validation rmse = 0.077519
Epoch 91
Validation rmse = 0.076289
Epoch 92
Loss = 6.6805e-02, PNorm = 34.9906, GNorm = 0.5106, lr_0 = 1.0000e-04
Validation rmse = 0.072871
Epoch 93
Loss = 6.1184e-02, PNorm = 34.9956, GNorm = 2.0352, lr_0 = 1.0000e-04
Validation rmse = 0.072692
Epoch 94
Validation rmse = 0.071069
Epoch 95
Loss = 5.6377e-02, PNorm = 35.0009, GNorm = 2.1260, lr_0 = 1.0000e-04
Validation rmse = 0.079669
Epoch 96
Loss = 6.3653e-02, PNorm = 35.0062, GNorm = 0.8402, lr_0 = 1.0000e-04
Validation rmse = 0.071432
Epoch 97
Validation rmse = 0.074844
Epoch 98
Loss = 6.6605e-02, PNorm = 35.0111, GNorm = 0.4278, lr_0 = 1.0000e-04
Validation rmse = 0.077390
Epoch 99
Loss = 6.2091e-02, PNorm = 35.0160, GNorm = 0.7864, lr_0 = 1.0000e-04
Validation rmse = 0.069607
Model 0 best validation rmse = 0.069607 on epoch 99
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.104600
Ensemble test rmse = 0.104600
1-fold cross validation
	Seed 0 ==> test rmse = 0.104600
Overall test rmse = 0.104600 +/- 0.000000
Elapsed time = 0:00:26
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_dmf.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 100,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 123 | train size = 121 | val size = 1 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.320495
Epoch 1
Validation rmse = 0.379205
Epoch 2
Validation rmse = 0.353157
Epoch 3
Validation rmse = 0.212636
Epoch 4
Loss = 5.4512e-01, PNorm = 34.0674, GNorm = 10.1821, lr_0 = 8.8916e-04
Validation rmse = 0.420541
Epoch 5
Validation rmse = 0.199872
Epoch 6
Validation rmse = 0.430929
Epoch 7
Validation rmse = 0.191656
Epoch 8
Loss = 6.3768e-01, PNorm = 34.1214, GNorm = 9.8909, lr_0 = 7.7224e-04
Validation rmse = 0.329000
Epoch 9
Validation rmse = 0.300640
Epoch 10
Validation rmse = 0.217997
Epoch 11
Validation rmse = 0.313444
Epoch 12
Loss = 4.5479e-01, PNorm = 34.1705, GNorm = 6.7813, lr_0 = 6.7070e-04
Validation rmse = 0.199482
Epoch 13
Validation rmse = 0.241659
Epoch 14
Validation rmse = 0.225155
Epoch 15
Validation rmse = 0.194420
Epoch 16
Loss = 3.0516e-01, PNorm = 34.2174, GNorm = 4.2342, lr_0 = 5.7571e-04
Validation rmse = 0.223321
Epoch 17
Validation rmse = 0.188756
Epoch 18
Validation rmse = 0.155636
Epoch 19
Validation rmse = 0.145122
Epoch 20
Loss = 2.1074e-01, PNorm = 34.2543, GNorm = 2.3426, lr_0 = 5.0001e-04
Loss = 5.8809e-01, PNorm = 34.2570, GNorm = 11.3616, lr_0 = 4.9417e-04
Validation rmse = 0.143759
Epoch 21
Validation rmse = 0.082624
Epoch 22
Validation rmse = 0.181537
Epoch 23
Validation rmse = 0.065071
Epoch 24
Loss = 2.8234e-01, PNorm = 34.2859, GNorm = 8.0022, lr_0 = 4.3427e-04
Loss = 2.0823e-01, PNorm = 34.2883, GNorm = 3.5264, lr_0 = 4.2919e-04
Validation rmse = 0.125805
Epoch 25
Validation rmse = 0.101597
Epoch 26
Validation rmse = 0.067345
Epoch 27
Validation rmse = 0.167050
Epoch 28
Loss = 2.5102e-01, PNorm = 34.3165, GNorm = 1.3458, lr_0 = 3.7276e-04
Validation rmse = 0.033332
Epoch 29
Validation rmse = 0.072555
Epoch 30
Validation rmse = 0.125832
Epoch 31
Validation rmse = 0.063432
Epoch 32
Validation rmse = 0.054349
Epoch 33
Loss = 2.4476e-01, PNorm = 34.3430, GNorm = 0.8521, lr_0 = 3.1996e-04
Validation rmse = 0.081029
Epoch 34
Validation rmse = 0.048025
Epoch 35
Validation rmse = 0.043958
Epoch 36
Validation rmse = 0.058806
Epoch 37
Loss = 1.5743e-01, PNorm = 34.3659, GNorm = 2.1030, lr_0 = 2.7789e-04
Validation rmse = 0.020005
Epoch 38
Validation rmse = 0.031623
Epoch 39
Validation rmse = 0.039006
Epoch 40
Validation rmse = 0.008331
Epoch 41
Loss = 1.4090e-01, PNorm = 34.3864, GNorm = 5.4599, lr_0 = 2.4135e-04
Validation rmse = 0.042178
Epoch 42
Validation rmse = 0.014633
Epoch 43
Validation rmse = 0.008604
Epoch 44
Validation rmse = 0.014714
Epoch 45
Loss = 1.6485e-01, PNorm = 34.4072, GNorm = 2.9309, lr_0 = 2.0717e-04
Validation rmse = 0.014953
Epoch 46
Validation rmse = 0.000724
Epoch 47
Validation rmse = 0.009348
Epoch 48
Validation rmse = 0.024160
Epoch 49
Loss = 1.6482e-01, PNorm = 34.4228, GNorm = 6.9112, lr_0 = 1.7993e-04
Validation rmse = 0.004028
Epoch 50
Validation rmse = 0.010111
Epoch 51
Validation rmse = 0.008086
Epoch 52
Validation rmse = 0.008505
Epoch 53
Loss = 1.2153e-01, PNorm = 34.4371, GNorm = 0.6743, lr_0 = 1.5627e-04
Loss = 1.7735e-01, PNorm = 34.4382, GNorm = 2.8302, lr_0 = 1.5445e-04
Validation rmse = 0.017919
Epoch 54
Validation rmse = 0.012817
Epoch 55
Validation rmse = 0.028364
Epoch 56
Validation rmse = 0.025612
Epoch 57
Loss = 1.1584e-01, PNorm = 34.4507, GNorm = 0.7434, lr_0 = 1.3414e-04
Validation rmse = 0.015728
Epoch 58
Validation rmse = 0.007335
Epoch 59
Validation rmse = 0.017094
Epoch 60
Validation rmse = 0.018441
Epoch 61
Loss = 1.2301e-01, PNorm = 34.4614, GNorm = 2.0484, lr_0 = 1.1650e-04
Validation rmse = 0.024830
Epoch 62
Validation rmse = 0.022218
Epoch 63
Validation rmse = 0.017163
Epoch 64
Validation rmse = 0.031024
Epoch 65
Validation rmse = 0.020482
Epoch 66
Loss = 1.2356e-01, PNorm = 34.4718, GNorm = 0.4923, lr_0 = 1.0000e-04
Validation rmse = 0.021254
Epoch 67
Validation rmse = 0.041292
Epoch 68
Validation rmse = 0.016089
Epoch 69
Validation rmse = 0.015230
Epoch 70
Loss = 1.3226e-01, PNorm = 34.4800, GNorm = 1.4316, lr_0 = 1.0000e-04
Validation rmse = 0.025893
Epoch 71
Validation rmse = 0.014907
Epoch 72
Validation rmse = 0.020906
Epoch 73
Validation rmse = 0.030341
Epoch 74
Loss = 6.3208e-02, PNorm = 34.4883, GNorm = 2.9989, lr_0 = 1.0000e-04
Validation rmse = 0.029444
Epoch 75
Validation rmse = 0.029921
Epoch 76
Validation rmse = 0.031242
Epoch 77
Validation rmse = 0.012304
Epoch 78
Loss = 1.0706e-01, PNorm = 34.4982, GNorm = 0.7948, lr_0 = 1.0000e-04
Validation rmse = 0.017974
Epoch 79
Validation rmse = 0.032557
Epoch 80
Validation rmse = 0.019891
Epoch 81
Validation rmse = 0.024863
Epoch 82
Loss = 1.0356e-01, PNorm = 34.5067, GNorm = 0.3606, lr_0 = 1.0000e-04
Loss = 1.0899e-01, PNorm = 34.5075, GNorm = 5.4547, lr_0 = 1.0000e-04
Validation rmse = 0.013566
Epoch 83
Validation rmse = 0.017461
Epoch 84
Validation rmse = 0.049119
Epoch 85
Validation rmse = 0.021640
Epoch 86
Loss = 7.9471e-02, PNorm = 34.5155, GNorm = 2.5904, lr_0 = 1.0000e-04
Loss = 2.4777e-01, PNorm = 34.5162, GNorm = 8.8135, lr_0 = 1.0000e-04
Validation rmse = 0.020505
Epoch 87
Validation rmse = 0.048771
Epoch 88
Validation rmse = 0.008044
Epoch 89
Validation rmse = 0.022062
Epoch 90
Loss = 1.2070e-01, PNorm = 34.5245, GNorm = 5.4998, lr_0 = 1.0000e-04
Validation rmse = 0.044450
Epoch 91
Validation rmse = 0.022929
Epoch 92
Validation rmse = 0.006113
Epoch 93
Validation rmse = 0.043264
Epoch 94
Validation rmse = 0.035581
Epoch 95
Loss = 1.0558e-01, PNorm = 34.5334, GNorm = 4.0861, lr_0 = 1.0000e-04
Validation rmse = 0.027296
Epoch 96
Validation rmse = 0.025376
Epoch 97
Validation rmse = 0.022697
Epoch 98
Validation rmse = 0.025678
Epoch 99
Loss = 1.2990e-01, PNorm = 34.5416, GNorm = 2.0221, lr_0 = 1.0000e-04
Validation rmse = 0.038442
Model 0 best validation rmse = 0.000724 on epoch 46
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.093368
Ensemble test rmse = 0.093368
1-fold cross validation
	Seed 0 ==> test rmse = 0.093368
Overall test rmse = 0.093368 +/- 0.000000
Elapsed time = 0:00:12
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_dmf.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 100,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 118 | train size = 116 | val size = 1 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.356392
Epoch 1
Validation rmse = 0.269341
Epoch 2
Validation rmse = 0.167825
Epoch 3
Validation rmse = 0.311356
Epoch 4
Loss = 7.2241e-01, PNorm = 34.0536, GNorm = 3.6381, lr_0 = 8.8916e-04
Validation rmse = 0.226499
Epoch 5
Validation rmse = 0.221658
Epoch 6
Validation rmse = 0.220695
Epoch 7
Validation rmse = 0.097348
Epoch 8
Loss = 4.2914e-01, PNorm = 34.1346, GNorm = 3.3473, lr_0 = 7.6323e-04
Loss = 3.1324e-01, PNorm = 34.1407, GNorm = 1.1732, lr_0 = 7.5431e-04
Validation rmse = 0.086293
Epoch 9
Validation rmse = 0.022809
Epoch 10
Validation rmse = 0.150164
Epoch 11
Validation rmse = 0.018234
Epoch 12
Loss = 3.1629e-01, PNorm = 34.1868, GNorm = 6.9684, lr_0 = 6.5513e-04
Validation rmse = 0.118457
Epoch 13
Validation rmse = 0.007798
Epoch 14
Validation rmse = 0.122924
Epoch 15
Validation rmse = 0.016656
Epoch 16
Validation rmse = 0.043484
Epoch 17
Loss = 2.0617e-01, PNorm = 34.2238, GNorm = 2.1108, lr_0 = 5.6234e-04
Validation rmse = 0.105508
Epoch 18
Validation rmse = 0.018278
Epoch 19
Validation rmse = 0.075169
Epoch 20
Validation rmse = 0.039035
Epoch 21
Loss = 1.8978e-01, PNorm = 34.2598, GNorm = 0.7932, lr_0 = 4.8270e-04
Validation rmse = 0.025999
Epoch 22
Validation rmse = 0.029370
Epoch 23
Validation rmse = 0.063789
Epoch 24
Validation rmse = 0.033530
Epoch 25
Loss = 1.4677e-01, PNorm = 34.2886, GNorm = 2.4841, lr_0 = 4.1923e-04
Loss = 3.1238e-01, PNorm = 34.2906, GNorm = 10.7665, lr_0 = 4.1433e-04
Validation rmse = 0.044261
Epoch 26
Validation rmse = 0.083886
Epoch 27
Validation rmse = 0.015398
Epoch 28
Validation rmse = 0.111421
Epoch 29
Validation rmse = 0.074147
Epoch 30
Loss = 1.3650e-01, PNorm = 34.3175, GNorm = 1.4546, lr_0 = 3.5565e-04
Validation rmse = 0.045411
Epoch 31
Validation rmse = 0.103430
Epoch 32
Validation rmse = 0.044696
Epoch 33
Validation rmse = 0.054834
Epoch 34
Loss = 1.0588e-01, PNorm = 34.3413, GNorm = 1.8596, lr_0 = 3.0528e-04
Validation rmse = 0.091957
Epoch 35
Validation rmse = 0.043866
Epoch 36
Validation rmse = 0.058545
Epoch 37
Validation rmse = 0.078957
Epoch 38
Loss = 1.1347e-01, PNorm = 34.3604, GNorm = 3.1983, lr_0 = 2.6514e-04
Loss = 1.7273e-01, PNorm = 34.3617, GNorm = 7.9324, lr_0 = 2.6204e-04
Validation rmse = 0.051570
Epoch 39
Validation rmse = 0.076716
Epoch 40
Validation rmse = 0.042641
Epoch 41
Validation rmse = 0.079166
Epoch 42
Validation rmse = 0.081713
Epoch 43
Loss = 8.5272e-02, PNorm = 34.3784, GNorm = 4.5300, lr_0 = 2.2493e-04
Validation rmse = 0.036543
Epoch 44
Validation rmse = 0.082546
Epoch 45
Validation rmse = 0.072246
Epoch 46
Validation rmse = 0.015164
Epoch 47
Loss = 1.4697e-01, PNorm = 34.3918, GNorm = 7.4180, lr_0 = 1.9535e-04
Validation rmse = 0.063400
Epoch 48
Validation rmse = 0.063525
Epoch 49
Validation rmse = 0.040828
Epoch 50
Validation rmse = 0.060047
Epoch 51
Loss = 8.4657e-02, PNorm = 34.4038, GNorm = 3.2255, lr_0 = 1.6768e-04
Loss = 7.1413e-02, PNorm = 34.4046, GNorm = 5.3807, lr_0 = 1.6572e-04
Validation rmse = 0.057551
Epoch 52
Validation rmse = 0.036180
Epoch 53
Validation rmse = 0.057436
Epoch 54
Validation rmse = 0.078994
Epoch 55
Validation rmse = 0.053975
Epoch 56
Loss = 8.2339e-02, PNorm = 34.4148, GNorm = 0.9968, lr_0 = 1.4225e-04
Validation rmse = 0.038344
Epoch 57
Validation rmse = 0.066479
Epoch 58
Validation rmse = 0.068395
Epoch 59
Validation rmse = 0.051249
Epoch 60
Loss = 7.6035e-02, PNorm = 34.4229, GNorm = 1.6385, lr_0 = 1.2355e-04
Validation rmse = 0.057470
Epoch 61
Validation rmse = 0.066543
Epoch 62
Validation rmse = 0.073456
Epoch 63
Validation rmse = 0.047028
Epoch 64
Loss = 7.3769e-02, PNorm = 34.4307, GNorm = 2.0367, lr_0 = 1.0605e-04
Loss = 4.6484e-02, PNorm = 34.4313, GNorm = 4.1913, lr_0 = 1.0481e-04
Validation rmse = 0.055313
Epoch 65
Validation rmse = 0.057112
Epoch 66
Validation rmse = 0.055377
Epoch 67
Validation rmse = 0.059391
Epoch 68
Loss = 6.9552e-02, PNorm = 34.4375, GNorm = 6.8915, lr_0 = 1.0000e-04
Validation rmse = 0.063770
Epoch 69
Validation rmse = 0.071914
Epoch 70
Validation rmse = 0.056126
Epoch 71
Validation rmse = 0.050831
Epoch 72
Validation rmse = 0.053119
Epoch 73
Loss = 5.5027e-02, PNorm = 34.4445, GNorm = 1.4531, lr_0 = 1.0000e-04
Validation rmse = 0.046477
Epoch 74
Validation rmse = 0.061092
Epoch 75
Validation rmse = 0.057672
Epoch 76
Validation rmse = 0.051993
Epoch 77
Loss = 5.5857e-02, PNorm = 34.4509, GNorm = 0.4111, lr_0 = 1.0000e-04
Loss = 8.1175e-02, PNorm = 34.4515, GNorm = 3.4808, lr_0 = 1.0000e-04
Validation rmse = 0.064722
Epoch 78
Validation rmse = 0.049960
Epoch 79
Validation rmse = 0.047209
Epoch 80
Validation rmse = 0.070866
Epoch 81
Loss = 5.8680e-02, PNorm = 34.4579, GNorm = 2.7253, lr_0 = 1.0000e-04
Validation rmse = 0.065025
Epoch 82
Validation rmse = 0.039414
Epoch 83
Validation rmse = 0.050796
Epoch 84
Validation rmse = 0.065571
Epoch 85
Validation rmse = 0.063395
Epoch 86
Loss = 6.7777e-02, PNorm = 34.4645, GNorm = 0.6117, lr_0 = 1.0000e-04
Validation rmse = 0.058148
Epoch 87
Validation rmse = 0.057874
Epoch 88
Validation rmse = 0.067820
Epoch 89
Validation rmse = 0.053785
Epoch 90
Loss = 4.8683e-02, PNorm = 34.4708, GNorm = 0.7506, lr_0 = 1.0000e-04
Validation rmse = 0.058328
Epoch 91
Validation rmse = 0.062060
Epoch 92
Validation rmse = 0.044132
Epoch 93
Validation rmse = 0.046221
Epoch 94
Loss = 5.2297e-02, PNorm = 34.4770, GNorm = 0.3894, lr_0 = 1.0000e-04
Loss = 5.2708e-02, PNorm = 34.4775, GNorm = 3.1672, lr_0 = 1.0000e-04
Validation rmse = 0.059686
Epoch 95
Validation rmse = 0.052464
Epoch 96
Validation rmse = 0.056705
Epoch 97
Validation rmse = 0.050770
Epoch 98
Validation rmse = 0.039799
Epoch 99
Loss = 6.5480e-02, PNorm = 34.4838, GNorm = 2.9714, lr_0 = 1.0000e-04
Validation rmse = 0.059899
Model 0 best validation rmse = 0.007798 on epoch 13
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.208299
Ensemble test rmse = 0.208299
1-fold cross validation
	Seed 0 ==> test rmse = 0.208299
Overall test rmse = 0.208299 +/- 0.000000
Elapsed time = 0:00:11
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_dmf.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 100,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 113 | train size = 111 | val size = 1 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.037061
Epoch 1
Validation rmse = 0.281155
Epoch 2
Validation rmse = 0.311189
Epoch 3
Validation rmse = 0.272838
Epoch 4
Loss = 7.6186e-01, PNorm = 34.0571, GNorm = 1.2438, lr_0 = 8.7877e-04
Validation rmse = 0.200726
Epoch 5
Validation rmse = 0.258131
Epoch 6
Validation rmse = 0.186858
Epoch 7
Validation rmse = 0.229325
Epoch 8
Validation rmse = 0.225969
Epoch 9
Loss = 3.2910e-01, PNorm = 34.1488, GNorm = 5.5960, lr_0 = 7.4550e-04
Validation rmse = 0.124446
Epoch 10
Validation rmse = 0.095125
Epoch 11
Validation rmse = 0.208160
Epoch 12
Validation rmse = 0.129807
Epoch 13
Loss = 2.8619e-01, PNorm = 34.1983, GNorm = 7.7201, lr_0 = 6.3992e-04
Validation rmse = 0.126524
Epoch 14
Validation rmse = 0.177323
Epoch 15
Validation rmse = 0.168871
Epoch 16
Validation rmse = 0.108474
Epoch 17
Validation rmse = 0.178509
Epoch 18
Loss = 2.1764e-01, PNorm = 34.2371, GNorm = 6.4262, lr_0 = 5.4287e-04
Validation rmse = 0.129348
Epoch 19
Validation rmse = 0.085709
Epoch 20
Validation rmse = 0.145183
Epoch 21
Validation rmse = 0.109856
Epoch 22
Loss = 1.6862e-01, PNorm = 34.2712, GNorm = 1.2242, lr_0 = 4.6598e-04
Validation rmse = 0.084872
Epoch 23
Validation rmse = 0.133650
Epoch 24
Validation rmse = 0.094841
Epoch 25
Validation rmse = 0.121834
Epoch 26
Validation rmse = 0.089757
Epoch 27
Loss = 1.2086e-01, PNorm = 34.3038, GNorm = 0.4877, lr_0 = 3.9531e-04
Validation rmse = 0.078416
Epoch 28
Validation rmse = 0.040229
Epoch 29
Validation rmse = 0.150154
Epoch 30
Validation rmse = 0.026434
Epoch 31
Loss = 1.5995e-01, PNorm = 34.3316, GNorm = 10.2763, lr_0 = 3.3932e-04
Validation rmse = 0.128926
Epoch 32
Validation rmse = 0.103081
Epoch 33
Validation rmse = 0.049248
Epoch 34
Validation rmse = 0.121889
Epoch 35
Validation rmse = 0.078616
Epoch 36
Loss = 1.0087e-01, PNorm = 34.3525, GNorm = 2.0300, lr_0 = 2.8786e-04
Validation rmse = 0.074137
Epoch 37
Validation rmse = 0.079144
Epoch 38
Validation rmse = 0.072458
Epoch 39
Validation rmse = 0.075089
Epoch 40
Loss = 9.5747e-02, PNorm = 34.3705, GNorm = 3.8540, lr_0 = 2.4709e-04
Validation rmse = 0.070018
Epoch 41
Validation rmse = 0.066417
Epoch 42
Validation rmse = 0.094047
Epoch 43
Validation rmse = 0.050151
Epoch 44
Validation rmse = 0.097374
Epoch 45
Loss = 6.6068e-02, PNorm = 34.3876, GNorm = 3.3696, lr_0 = 2.0962e-04
Validation rmse = 0.062704
Epoch 46
Validation rmse = 0.077372
Epoch 47
Validation rmse = 0.087538
Epoch 48
Validation rmse = 0.052712
Epoch 49
Loss = 8.1539e-02, PNorm = 34.3997, GNorm = 4.2942, lr_0 = 1.7993e-04
Validation rmse = 0.065124
Epoch 50
Validation rmse = 0.083030
Epoch 51
Validation rmse = 0.062141
Epoch 52
Validation rmse = 0.063616
Epoch 53
Validation rmse = 0.075165
Epoch 54
Loss = 6.2742e-02, PNorm = 34.4111, GNorm = 1.8888, lr_0 = 1.5264e-04
Validation rmse = 0.075428
Epoch 55
Validation rmse = 0.067000
Epoch 56
Validation rmse = 0.052037
Epoch 57
Validation rmse = 0.056711
Epoch 58
Loss = 6.2261e-02, PNorm = 34.4210, GNorm = 1.7360, lr_0 = 1.3102e-04
Loss = 5.9658e-02, PNorm = 34.4216, GNorm = 1.2950, lr_0 = 1.2949e-04
Validation rmse = 0.065698
Epoch 59
Validation rmse = 0.069319
Epoch 60
Validation rmse = 0.054479
Epoch 61
Validation rmse = 0.060186
Epoch 62
Validation rmse = 0.074163
Epoch 63
Loss = 6.5229e-02, PNorm = 34.4297, GNorm = 2.2257, lr_0 = 1.1115e-04
Validation rmse = 0.059125
Epoch 64
Validation rmse = 0.063436
Epoch 65
Validation rmse = 0.067721
Epoch 66
Validation rmse = 0.059771
Epoch 67
Loss = 5.6715e-02, PNorm = 34.4369, GNorm = 0.7153, lr_0 = 1.0000e-04
Loss = 2.7527e-02, PNorm = 34.4374, GNorm = 2.7988, lr_0 = 1.0000e-04
Validation rmse = 0.069214
Epoch 68
Validation rmse = 0.065387
Epoch 69
Validation rmse = 0.067309
Epoch 70
Validation rmse = 0.072503
Epoch 71
Validation rmse = 0.073878
Epoch 72
Loss = 3.7364e-02, PNorm = 34.4438, GNorm = 0.9767, lr_0 = 1.0000e-04
Validation rmse = 0.061146
Epoch 73
Validation rmse = 0.067209
Epoch 74
Validation rmse = 0.064102
Epoch 75
Validation rmse = 0.070123
Epoch 76
Loss = 5.3710e-02, PNorm = 34.4501, GNorm = 3.9741, lr_0 = 1.0000e-04
Loss = 3.6267e-02, PNorm = 34.4506, GNorm = 3.2088, lr_0 = 1.0000e-04
Validation rmse = 0.069626
Epoch 77
Validation rmse = 0.058544
Epoch 78
Validation rmse = 0.079557
Epoch 79
Validation rmse = 0.068853
Epoch 80
Validation rmse = 0.049130
Epoch 81
Loss = 7.1767e-02, PNorm = 34.4568, GNorm = 3.8864, lr_0 = 1.0000e-04
Validation rmse = 0.062362
Epoch 82
Validation rmse = 0.057340
Epoch 83
Validation rmse = 0.076645
Epoch 84
Validation rmse = 0.049582
Epoch 85
Loss = 4.5125e-02, PNorm = 34.4627, GNorm = 2.4398, lr_0 = 1.0000e-04
Loss = 1.0457e-01, PNorm = 34.4631, GNorm = 9.0154, lr_0 = 1.0000e-04
Validation rmse = 0.062190
Epoch 86
Validation rmse = 0.090960
Epoch 87
Validation rmse = 0.053120
Epoch 88
Validation rmse = 0.064324
Epoch 89
Validation rmse = 0.072638
Epoch 90
Loss = 4.2096e-02, PNorm = 34.4693, GNorm = 1.6270, lr_0 = 1.0000e-04
Validation rmse = 0.043010
Epoch 91
Validation rmse = 0.063276
Epoch 92
Validation rmse = 0.084955
Epoch 93
Validation rmse = 0.042965
Epoch 94
Loss = 5.0915e-02, PNorm = 34.4753, GNorm = 5.7753, lr_0 = 1.0000e-04
Loss = 9.5048e-02, PNorm = 34.4757, GNorm = 6.7371, lr_0 = 1.0000e-04
Validation rmse = 0.062379
Epoch 95
Validation rmse = 0.102425
Epoch 96
Validation rmse = 0.071148
Epoch 97
Validation rmse = 0.061821
Epoch 98
Validation rmse = 0.078321
Epoch 99
Loss = 4.7004e-02, PNorm = 34.4814, GNorm = 1.5492, lr_0 = 1.0000e-04
Validation rmse = 0.070118
Model 0 best validation rmse = 0.026434 on epoch 30
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.145273
Ensemble test rmse = 0.145273
1-fold cross validation
	Seed 0 ==> test rmse = 0.145273
Overall test rmse = 0.145273 +/- 0.000000
Elapsed time = 0:00:10
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_dmf.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 100,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 108 | train size = 106 | val size = 1 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.025241
Epoch 1
Validation rmse = 0.108277
Epoch 2
Validation rmse = 0.152108
Epoch 3
Validation rmse = 0.133800
Epoch 4
Loss = 5.4241e-01, PNorm = 34.0656, GNorm = 1.0146, lr_0 = 8.7877e-04
Loss = 1.0070e+00, PNorm = 34.0705, GNorm = 12.1308, lr_0 = 8.6851e-04
Validation rmse = 0.076095
Epoch 5
Validation rmse = 0.017692
Epoch 6
Validation rmse = 0.157487
Epoch 7
Validation rmse = 0.009567
Epoch 8
Validation rmse = 0.056792
Epoch 9
Loss = 4.8440e-01, PNorm = 34.1315, GNorm = 2.8399, lr_0 = 7.4550e-04
Validation rmse = 0.071389
Epoch 10
Validation rmse = 0.022152
Epoch 11
Validation rmse = 0.002091
Epoch 12
Validation rmse = 0.034022
Epoch 13
Validation rmse = 0.108046
Epoch 14
Loss = 3.1936e-01, PNorm = 34.1931, GNorm = 5.2521, lr_0 = 6.2506e-04
Validation rmse = 0.004981
Epoch 15
Validation rmse = 0.022901
Epoch 16
Validation rmse = 0.069778
Epoch 17
Validation rmse = 0.017418
Epoch 18
Loss = 2.4231e-01, PNorm = 34.2255, GNorm = 4.7494, lr_0 = 5.3653e-04
Loss = 1.2966e-01, PNorm = 34.2274, GNorm = 2.8327, lr_0 = 5.3026e-04
Validation rmse = 0.048732
Epoch 19
Validation rmse = 0.074777
Epoch 20
Validation rmse = 0.039242
Epoch 21
Validation rmse = 0.042411
Epoch 22
Validation rmse = 0.031603
Epoch 23
Loss = 1.7012e-01, PNorm = 34.2577, GNorm = 3.3263, lr_0 = 4.4984e-04
Loss = 1.7391e-01, PNorm = 34.2593, GNorm = 6.7773, lr_0 = 4.4459e-04
Validation rmse = 0.082015
Epoch 24
Validation rmse = 0.101726
Epoch 25
Validation rmse = 0.013306
Epoch 26
Validation rmse = 0.077885
Epoch 27
Validation rmse = 0.093176
Epoch 28
Loss = 1.2502e-01, PNorm = 34.2800, GNorm = 2.8600, lr_0 = 3.8162e-04
Validation rmse = 0.063674
Epoch 29
Validation rmse = 0.067393
Epoch 30
Validation rmse = 0.079833
Epoch 31
Validation rmse = 0.118706
Epoch 32
Validation rmse = 0.049580
Epoch 33
Loss = 1.1583e-01, PNorm = 34.3021, GNorm = 3.2436, lr_0 = 3.1996e-04
Validation rmse = 0.037157
Epoch 34
Validation rmse = 0.130131
Epoch 35
Validation rmse = 0.055334
Epoch 36
Validation rmse = 0.014631
Epoch 37
Loss = 1.2247e-01, PNorm = 34.3174, GNorm = 0.4292, lr_0 = 2.7465e-04
Loss = 6.2801e-02, PNorm = 34.3185, GNorm = 3.9581, lr_0 = 2.7144e-04
Validation rmse = 0.097096
Epoch 38
Validation rmse = 0.084001
Epoch 39
Validation rmse = 0.053515
Epoch 40
Validation rmse = 0.078868
Epoch 41
Validation rmse = 0.107803
Epoch 42
Loss = 8.5830e-02, PNorm = 34.3317, GNorm = 1.3476, lr_0 = 2.3300e-04
Validation rmse = 0.048630
Epoch 43
Validation rmse = 0.026750
Epoch 44
Validation rmse = 0.071861
Epoch 45
Validation rmse = 0.057180
Epoch 46
Validation rmse = 0.051145
Epoch 47
Loss = 6.6512e-02, PNorm = 34.3425, GNorm = 0.5361, lr_0 = 1.9535e-04
Validation rmse = 0.062143
Epoch 48
Validation rmse = 0.094626
Epoch 49
Validation rmse = 0.088979
Epoch 50
Validation rmse = 0.045104
Epoch 51
Loss = 9.1962e-02, PNorm = 34.3530, GNorm = 2.5661, lr_0 = 1.6768e-04
Loss = 3.7795e-02, PNorm = 34.3538, GNorm = 2.2831, lr_0 = 1.6572e-04
Validation rmse = 0.065094
Epoch 52
Validation rmse = 0.096945
Epoch 53
Validation rmse = 0.091282
Epoch 54
Validation rmse = 0.037027
Epoch 55
Validation rmse = 0.050671
Epoch 56
Loss = 7.2018e-02, PNorm = 34.3626, GNorm = 0.2801, lr_0 = 1.4059e-04
Loss = 3.4786e-02, PNorm = 34.3632, GNorm = 1.9216, lr_0 = 1.3895e-04
Validation rmse = 0.106990
Epoch 57
Validation rmse = 0.098812
Epoch 58
Validation rmse = 0.043691
Epoch 59
Validation rmse = 0.054079
Epoch 60
Validation rmse = 0.086268
Epoch 61
Loss = 7.1657e-02, PNorm = 34.3694, GNorm = 1.8995, lr_0 = 1.1927e-04
Validation rmse = 0.071093
Epoch 62
Validation rmse = 0.056120
Epoch 63
Validation rmse = 0.053003
Epoch 64
Validation rmse = 0.053397
Epoch 65
Validation rmse = 0.054396
Epoch 66
Loss = 6.1222e-02, PNorm = 34.3758, GNorm = 1.2299, lr_0 = 1.0000e-04
Validation rmse = 0.068680
Epoch 67
Validation rmse = 0.080983
Epoch 68
Validation rmse = 0.061741
Epoch 69
Validation rmse = 0.035691
Epoch 70
Loss = 6.9186e-02, PNorm = 34.3803, GNorm = 2.0394, lr_0 = 1.0000e-04
Loss = 2.8668e-02, PNorm = 34.3806, GNorm = 3.3640, lr_0 = 1.0000e-04
Validation rmse = 0.038300
Epoch 71
Validation rmse = 0.062099
Epoch 72
Validation rmse = 0.096321
Epoch 73
Validation rmse = 0.095183
Epoch 74
Validation rmse = 0.084640
Epoch 75
Loss = 5.6591e-02, PNorm = 34.3847, GNorm = 1.1227, lr_0 = 1.0000e-04
Validation rmse = 0.082853
Epoch 76
Validation rmse = 0.074242
Epoch 77
Validation rmse = 0.055811
Epoch 78
Validation rmse = 0.066411
Epoch 79
Validation rmse = 0.083703
Epoch 80
Loss = 5.1595e-02, PNorm = 34.3905, GNorm = 0.8444, lr_0 = 1.0000e-04
Validation rmse = 0.084079
Epoch 81
Validation rmse = 0.056850
Epoch 82
Validation rmse = 0.035040
Epoch 83
Validation rmse = 0.071528
Epoch 84
Loss = 4.8429e-02, PNorm = 34.3957, GNorm = 1.0012, lr_0 = 1.0000e-04
Loss = 1.1659e-01, PNorm = 34.3961, GNorm = 3.3092, lr_0 = 1.0000e-04
Validation rmse = 0.097312
Epoch 85
Validation rmse = 0.068375
Epoch 86
Validation rmse = 0.044913
Epoch 87
Validation rmse = 0.041898
Epoch 88
Validation rmse = 0.036993
Epoch 89
Loss = 5.5894e-02, PNorm = 34.4014, GNorm = 2.8408, lr_0 = 1.0000e-04
Loss = 2.5365e-02, PNorm = 34.4017, GNorm = 2.0987, lr_0 = 1.0000e-04
Validation rmse = 0.054058
Epoch 90
Validation rmse = 0.072099
Epoch 91
Validation rmse = 0.056565
Epoch 92
Validation rmse = 0.055256
Epoch 93
Validation rmse = 0.057601
Epoch 94
Loss = 3.7243e-02, PNorm = 34.4060, GNorm = 0.3490, lr_0 = 1.0000e-04
Validation rmse = 0.054223
Epoch 95
Validation rmse = 0.048673
Epoch 96
Validation rmse = 0.038496
Epoch 97
Validation rmse = 0.050414
Epoch 98
Validation rmse = 0.064979
Epoch 99
Loss = 5.0283e-02, PNorm = 34.4111, GNorm = 1.3381, lr_0 = 1.0000e-04
Validation rmse = 0.067449
Model 0 best validation rmse = 0.002091 on epoch 11
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.098165
Ensemble test rmse = 0.098165
1-fold cross validation
	Seed 0 ==> test rmse = 0.098165
Overall test rmse = 0.098165 +/- 0.000000
Elapsed time = 0:00:11
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_dmf.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 100,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 103 | train size = 101 | val size = 1 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.244891
Epoch 1
Validation rmse = 0.051907
Epoch 2
Validation rmse = 0.173109
Epoch 3
Validation rmse = 0.202376
Epoch 4
Loss = 8.4481e-01, PNorm = 34.0464, GNorm = 1.6124, lr_0 = 8.7877e-04
Loss = 1.0964e+00, PNorm = 34.0501, GNorm = 14.8543, lr_0 = 8.6851e-04
Validation rmse = 0.071143
Epoch 5
Validation rmse = 0.093577
Epoch 6
Validation rmse = 0.065121
Epoch 7
Validation rmse = 0.019910
Epoch 8
Validation rmse = 0.057229
Epoch 9
Loss = 5.3723e-01, PNorm = 34.1071, GNorm = 2.9058, lr_0 = 7.3680e-04
Loss = 7.0171e-01, PNorm = 34.1117, GNorm = 12.2335, lr_0 = 7.2819e-04
Validation rmse = 0.019659
Epoch 10
Validation rmse = 0.075037
Epoch 11
Validation rmse = 0.023986
Epoch 12
Validation rmse = 0.177369
Epoch 13
Validation rmse = 0.036888
Epoch 14
Loss = 3.6918e-01, PNorm = 34.1639, GNorm = 6.4162, lr_0 = 6.1776e-04
Loss = 7.0042e-01, PNorm = 34.1671, GNorm = 20.6518, lr_0 = 6.1054e-04
Validation rmse = 0.046021
Epoch 15
Validation rmse = 0.071483
Epoch 16
Validation rmse = 0.061995
Epoch 17
Validation rmse = 0.050898
Epoch 18
Validation rmse = 0.029375
Epoch 19
Loss = 2.8390e-01, PNorm = 34.1904, GNorm = 1.2269, lr_0 = 5.1795e-04
Loss = 4.8296e-02, PNorm = 34.1917, GNorm = 4.3596, lr_0 = 5.1190e-04
Validation rmse = 0.111498
Epoch 20
Validation rmse = 0.139335
Epoch 21
Validation rmse = 0.091257
Epoch 22
Validation rmse = 0.004175
Epoch 23
Validation rmse = 0.003816
Epoch 24
Loss = 2.2974e-01, PNorm = 34.2109, GNorm = 2.3735, lr_0 = 4.3427e-04
Loss = 4.8581e-02, PNorm = 34.2127, GNorm = 4.0096, lr_0 = 4.2919e-04
Validation rmse = 0.094190
Epoch 25
Validation rmse = 0.036814
Epoch 26
Validation rmse = 0.104541
Epoch 27
Validation rmse = 0.075351
Epoch 28
Validation rmse = 0.009795
Epoch 29
Loss = 2.5759e-01, PNorm = 34.2307, GNorm = 5.1877, lr_0 = 3.6410e-04
Loss = 1.8481e-03, PNorm = 34.2312, GNorm = 0.7944, lr_0 = 3.5985e-04
Validation rmse = 0.001628
Epoch 30
Validation rmse = 0.054240
Epoch 31
Validation rmse = 0.057685
Epoch 32
Validation rmse = 0.036304
Epoch 33
Validation rmse = 0.107840
Epoch 34
Loss = 3.3038e-01, PNorm = 34.2371, GNorm = 7.8970, lr_0 = 3.0528e-04
Loss = 1.8826e-02, PNorm = 34.2375, GNorm = 2.8805, lr_0 = 3.0171e-04
Validation rmse = 0.106682
Epoch 35
Validation rmse = 0.037834
Epoch 36
Validation rmse = 0.010192
Epoch 37
Validation rmse = 0.010550
Epoch 38
Validation rmse = 0.009030
Epoch 39
Loss = 1.7435e-01, PNorm = 34.2458, GNorm = 0.5364, lr_0 = 2.5595e-04
Loss = 4.4060e-01, PNorm = 34.2464, GNorm = 15.1528, lr_0 = 2.5297e-04
Validation rmse = 0.011518
Epoch 40
Validation rmse = 0.075119
Epoch 41
Validation rmse = 0.108829
Epoch 42
Validation rmse = 0.069376
Epoch 43
Validation rmse = 0.012715
Epoch 44
Loss = 1.8460e-01, PNorm = 34.2531, GNorm = 3.2918, lr_0 = 2.1460e-04
Loss = 8.7203e-03, PNorm = 34.2538, GNorm = 1.6466, lr_0 = 2.1210e-04
Validation rmse = 0.030092
Epoch 45
Validation rmse = 0.008183
Epoch 46
Validation rmse = 0.076128
Epoch 47
Validation rmse = 0.075874
Epoch 48
Validation rmse = 0.037120
Epoch 49
Loss = 1.7409e-01, PNorm = 34.2659, GNorm = 2.9694, lr_0 = 1.7993e-04
Validation rmse = 0.011254
Epoch 50
Validation rmse = 0.043672
Epoch 51
Validation rmse = 0.102806
Epoch 52
Validation rmse = 0.099954
Epoch 53
Validation rmse = 0.042281
Epoch 54
Loss = 1.6794e-01, PNorm = 34.2698, GNorm = 1.7215, lr_0 = 1.5264e-04
Validation rmse = 0.004845
Epoch 55
Validation rmse = 0.012791
Epoch 56
Validation rmse = 0.032354
Epoch 57
Validation rmse = 0.015392
Epoch 58
Validation rmse = 0.013752
Epoch 59
Loss = 1.7489e-01, PNorm = 34.2722, GNorm = 0.7518, lr_0 = 1.2798e-04
Validation rmse = 0.031001
Epoch 60
Validation rmse = 0.029046
Epoch 61
Validation rmse = 0.018766
Epoch 62
Validation rmse = 0.011448
Epoch 63
Validation rmse = 0.008007
Epoch 64
Loss = 1.2796e-01, PNorm = 34.2775, GNorm = 2.5561, lr_0 = 1.0730e-04
Validation rmse = 0.013912
Epoch 65
Validation rmse = 0.022948
Epoch 66
Validation rmse = 0.043116
Epoch 67
Validation rmse = 0.064986
Epoch 68
Validation rmse = 0.067467
Epoch 69
Loss = 1.3985e-01, PNorm = 34.2810, GNorm = 1.7473, lr_0 = 1.0000e-04
Validation rmse = 0.044697
Epoch 70
Validation rmse = 0.031267
Epoch 71
Validation rmse = 0.019833
Epoch 72
Validation rmse = 0.014483
Epoch 73
Validation rmse = 0.012741
Epoch 74
Loss = 1.2562e-01, PNorm = 34.2845, GNorm = 0.5908, lr_0 = 1.0000e-04
Validation rmse = 0.008259
Epoch 75
Validation rmse = 0.014843
Epoch 76
Validation rmse = 0.027270
Epoch 77
Validation rmse = 0.042363
Epoch 78
Validation rmse = 0.066617
Epoch 79
Loss = 9.8433e-02, PNorm = 34.2880, GNorm = 1.2784, lr_0 = 1.0000e-04
Validation rmse = 0.072715
Epoch 80
Validation rmse = 0.062058
Epoch 81
Validation rmse = 0.055950
Epoch 82
Validation rmse = 0.058627
Epoch 83
Validation rmse = 0.039602
Epoch 84
Loss = 1.1665e-01, PNorm = 34.2906, GNorm = 1.3823, lr_0 = 1.0000e-04
Validation rmse = 0.017983
Epoch 85
Validation rmse = 0.005586
Epoch 86
Validation rmse = 0.023024
Epoch 87
Validation rmse = 0.079694
Epoch 88
Validation rmse = 0.112617
Epoch 89
Loss = 1.6540e-01, PNorm = 34.2932, GNorm = 3.7653, lr_0 = 1.0000e-04
Validation rmse = 0.122069
Epoch 90
Validation rmse = 0.092688
Epoch 91
Validation rmse = 0.069335
Epoch 92
Validation rmse = 0.052227
Epoch 93
Validation rmse = 0.029367
Epoch 94
Loss = 1.3530e-01, PNorm = 34.2986, GNorm = 3.4660, lr_0 = 1.0000e-04
Validation rmse = 0.039219
Epoch 95
Validation rmse = 0.072748
Epoch 96
Validation rmse = 0.081413
Epoch 97
Validation rmse = 0.061299
Epoch 98
Validation rmse = 0.043685
Epoch 99
Loss = 1.3633e-01, PNorm = 34.3035, GNorm = 1.3218, lr_0 = 1.0000e-04
Validation rmse = 0.054396
Model 0 best validation rmse = 0.001628 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.126998
Ensemble test rmse = 0.126998
1-fold cross validation
	Seed 0 ==> test rmse = 0.126998
Overall test rmse = 0.126998 +/- 0.000000
Elapsed time = 0:00:11
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/FINAL_LIST.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 200,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.99, 0.005, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,032 | train size = 1,021 | val size = 5 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.7244e-01, PNorm = 34.0142, GNorm = 1.4172, lr_0 = 3.4750e-04
Loss = 7.6695e-01, PNorm = 34.0390, GNorm = 11.0635, lr_0 = 5.7250e-04
Loss = 3.7466e-01, PNorm = 34.0414, GNorm = 5.4510, lr_0 = 5.9500e-04
Validation rmse = 0.254232
Epoch 1
Loss = 7.5898e-01, PNorm = 34.0720, GNorm = 8.4115, lr_0 = 8.2000e-04
Loss = 6.5662e-01, PNorm = 34.1285, GNorm = 4.3703, lr_0 = 9.9884e-04
Loss = 7.2617e-01, PNorm = 34.1362, GNorm = 1.4498, lr_0 = 9.9826e-04
Validation rmse = 0.167317
Epoch 2
Loss = 4.9523e-01, PNorm = 34.2051, GNorm = 1.9493, lr_0 = 9.9247e-04
Loss = 3.7850e-01, PNorm = 34.2893, GNorm = 1.9963, lr_0 = 9.8672e-04
Validation rmse = 0.187857
Epoch 3
Loss = 3.5602e-01, PNorm = 34.3670, GNorm = 2.5408, lr_0 = 9.8099e-04
Loss = 2.7902e-01, PNorm = 34.4322, GNorm = 7.0150, lr_0 = 9.7531e-04
Validation rmse = 0.197272
Epoch 4
Loss = 2.5314e-01, PNorm = 34.4924, GNorm = 0.9447, lr_0 = 9.6909e-04
Loss = 2.8000e-01, PNorm = 34.5426, GNorm = 4.0762, lr_0 = 9.6347e-04
Validation rmse = 0.186662
Epoch 5
Loss = 3.3127e-01, PNorm = 34.5925, GNorm = 8.9441, lr_0 = 9.5788e-04
Loss = 2.3147e-01, PNorm = 34.6421, GNorm = 1.7381, lr_0 = 9.5233e-04
Validation rmse = 0.194536
Epoch 6
Loss = 1.9708e-01, PNorm = 34.6957, GNorm = 2.1179, lr_0 = 9.4626e-04
Loss = 1.7203e-01, PNorm = 34.7357, GNorm = 1.0100, lr_0 = 9.4077e-04
Validation rmse = 0.205893
Epoch 7
Loss = 1.3932e-01, PNorm = 34.7799, GNorm = 2.2014, lr_0 = 9.3477e-04
Loss = 1.7632e-01, PNorm = 34.8140, GNorm = 2.1565, lr_0 = 9.2936e-04
Validation rmse = 0.180518
Epoch 8
Loss = 1.2437e-01, PNorm = 34.8421, GNorm = 2.4627, lr_0 = 9.2397e-04
Loss = 1.6088e-01, PNorm = 34.8731, GNorm = 0.7804, lr_0 = 9.1861e-04
Validation rmse = 0.189818
Epoch 9
Loss = 1.3684e-01, PNorm = 34.9037, GNorm = 3.3483, lr_0 = 9.1275e-04
Loss = 1.3747e-01, PNorm = 34.9242, GNorm = 1.7384, lr_0 = 9.0746e-04
Validation rmse = 0.170401
Epoch 10
Loss = 1.6385e-01, PNorm = 34.9589, GNorm = 1.7884, lr_0 = 9.0220e-04
Loss = 1.3268e-01, PNorm = 34.9834, GNorm = 1.2212, lr_0 = 8.9697e-04
Validation rmse = 0.202953
Epoch 11
Loss = 1.4390e-01, PNorm = 35.0130, GNorm = 1.7013, lr_0 = 8.9125e-04
Loss = 1.3641e-01, PNorm = 35.0357, GNorm = 1.1089, lr_0 = 8.8608e-04
Validation rmse = 0.181427
Epoch 12
Loss = 1.3310e-01, PNorm = 35.0565, GNorm = 1.4164, lr_0 = 8.8095e-04
Loss = 1.4170e-01, PNorm = 35.0840, GNorm = 4.8889, lr_0 = 8.7584e-04
Validation rmse = 0.174258
Epoch 13
Loss = 1.2455e-01, PNorm = 35.1042, GNorm = 0.5162, lr_0 = 8.7025e-04
Loss = 1.1557e-01, PNorm = 35.1303, GNorm = 0.4893, lr_0 = 8.6521e-04
Validation rmse = 0.171161
Epoch 14
Loss = 1.2508e-01, PNorm = 35.1574, GNorm = 2.7126, lr_0 = 8.5969e-04
Loss = 1.5427e-01, PNorm = 35.1839, GNorm = 2.6803, lr_0 = 8.5471e-04
Validation rmse = 0.188547
Epoch 15
Loss = 1.0567e-01, PNorm = 35.2053, GNorm = 2.1989, lr_0 = 8.4975e-04
Loss = 1.3947e-01, PNorm = 35.2386, GNorm = 1.2783, lr_0 = 8.4483e-04
Validation rmse = 0.187451
Epoch 16
Loss = 1.4652e-01, PNorm = 35.2657, GNorm = 3.2951, lr_0 = 8.3944e-04
Loss = 1.4105e-01, PNorm = 35.2981, GNorm = 1.0569, lr_0 = 8.3457e-04
Validation rmse = 0.227410
Epoch 17
Loss = 1.4434e-01, PNorm = 35.3262, GNorm = 0.5233, lr_0 = 8.2973e-04
Loss = 1.3224e-01, PNorm = 35.3607, GNorm = 4.1327, lr_0 = 8.2492e-04
Validation rmse = 0.181023
Epoch 18
Loss = 1.2486e-01, PNorm = 35.3934, GNorm = 3.7216, lr_0 = 8.1966e-04
Loss = 1.0480e-01, PNorm = 35.4121, GNorm = 1.4367, lr_0 = 8.1491e-04
Validation rmse = 0.189802
Epoch 19
Loss = 9.6352e-02, PNorm = 35.4450, GNorm = 0.8293, lr_0 = 8.0972e-04
Loss = 1.2443e-01, PNorm = 35.4778, GNorm = 1.4103, lr_0 = 8.0502e-04
Validation rmse = 0.191644
Epoch 20
Loss = 1.6943e-01, PNorm = 35.5002, GNorm = 3.2849, lr_0 = 8.0036e-04
Loss = 1.2232e-01, PNorm = 35.5250, GNorm = 0.9156, lr_0 = 7.9572e-04
Validation rmse = 0.213191
Epoch 21
Loss = 9.9892e-02, PNorm = 35.5531, GNorm = 1.1340, lr_0 = 7.9064e-04
Loss = 1.3870e-01, PNorm = 35.5816, GNorm = 4.0152, lr_0 = 7.8606e-04
Validation rmse = 0.187606
Epoch 22
Loss = 1.4418e-01, PNorm = 35.6103, GNorm = 0.5747, lr_0 = 7.8150e-04
Loss = 1.0465e-01, PNorm = 35.6433, GNorm = 0.9391, lr_0 = 7.7697e-04
Validation rmse = 0.208495
Epoch 23
Loss = 8.8328e-02, PNorm = 35.6729, GNorm = 1.4351, lr_0 = 7.7202e-04
Loss = 9.6798e-02, PNorm = 35.6968, GNorm = 1.0231, lr_0 = 7.6754e-04
Loss = 1.1310e-01, PNorm = 35.7179, GNorm = 2.2286, lr_0 = 7.6309e-04
Validation rmse = 0.196191
Epoch 24
Loss = 1.0670e-01, PNorm = 35.7345, GNorm = 1.8968, lr_0 = 7.5867e-04
Loss = 1.1533e-01, PNorm = 35.7601, GNorm = 1.0949, lr_0 = 7.5427e-04
Loss = 7.6034e-02, PNorm = 35.7628, GNorm = 1.9391, lr_0 = 7.5383e-04
Validation rmse = 0.220703
Epoch 25
Loss = 1.0323e-01, PNorm = 35.7838, GNorm = 1.5928, lr_0 = 7.4946e-04
Loss = 1.1034e-01, PNorm = 35.8007, GNorm = 1.0966, lr_0 = 7.4511e-04
Loss = 1.5819e-01, PNorm = 35.8042, GNorm = 2.5485, lr_0 = 7.4468e-04
Validation rmse = 0.207682
Epoch 26
Loss = 9.9413e-02, PNorm = 35.8352, GNorm = 1.4457, lr_0 = 7.4036e-04
Loss = 1.1343e-01, PNorm = 35.8563, GNorm = 1.0169, lr_0 = 7.3607e-04
Validation rmse = 0.195874
Epoch 27
Loss = 1.0279e-01, PNorm = 35.8780, GNorm = 1.0556, lr_0 = 7.3180e-04
Loss = 9.3113e-02, PNorm = 35.9054, GNorm = 0.5389, lr_0 = 7.2756e-04
Validation rmse = 0.224628
Epoch 28
Loss = 8.8308e-02, PNorm = 35.9256, GNorm = 2.9014, lr_0 = 7.2292e-04
Loss = 1.0923e-01, PNorm = 35.9510, GNorm = 0.8351, lr_0 = 7.1873e-04
Validation rmse = 0.253915
Epoch 29
Loss = 1.1349e-01, PNorm = 35.9749, GNorm = 1.6169, lr_0 = 7.1456e-04
Loss = 8.8019e-02, PNorm = 36.0014, GNorm = 0.7423, lr_0 = 7.1042e-04
Validation rmse = 0.193125
Epoch 30
Loss = 9.3899e-02, PNorm = 36.0215, GNorm = 1.2579, lr_0 = 7.0589e-04
Loss = 1.0033e-01, PNorm = 36.0438, GNorm = 1.6777, lr_0 = 7.0180e-04
Validation rmse = 0.233310
Epoch 31
Loss = 1.0253e-01, PNorm = 36.0740, GNorm = 0.6500, lr_0 = 6.9773e-04
Loss = 8.0540e-02, PNorm = 36.0950, GNorm = 1.1031, lr_0 = 6.9368e-04
Validation rmse = 0.201165
Epoch 32
Loss = 9.9704e-02, PNorm = 36.1206, GNorm = 2.8580, lr_0 = 6.8926e-04
Loss = 8.8926e-02, PNorm = 36.1415, GNorm = 0.4803, lr_0 = 6.8527e-04
Validation rmse = 0.213797
Epoch 33
Loss = 6.8500e-02, PNorm = 36.1667, GNorm = 0.9901, lr_0 = 6.8090e-04
Loss = 9.8047e-02, PNorm = 36.1867, GNorm = 2.5397, lr_0 = 6.7695e-04
Validation rmse = 0.212710
Epoch 34
Loss = 8.1115e-02, PNorm = 36.2068, GNorm = 0.9624, lr_0 = 6.7302e-04
Loss = 7.9841e-02, PNorm = 36.2295, GNorm = 0.7174, lr_0 = 6.6912e-04
Validation rmse = 0.205619
Epoch 35
Loss = 7.9227e-02, PNorm = 36.2505, GNorm = 0.5719, lr_0 = 6.6486e-04
Loss = 8.6174e-02, PNorm = 36.2748, GNorm = 1.2781, lr_0 = 6.6100e-04
Validation rmse = 0.218707
Epoch 36
Loss = 7.8256e-02, PNorm = 36.2917, GNorm = 0.6861, lr_0 = 6.5717e-04
Loss = 8.8425e-02, PNorm = 36.3120, GNorm = 1.3523, lr_0 = 6.5336e-04
Validation rmse = 0.247583
Epoch 37
Loss = 9.4996e-02, PNorm = 36.3361, GNorm = 2.7814, lr_0 = 6.4919e-04
Loss = 8.3809e-02, PNorm = 36.3623, GNorm = 0.7730, lr_0 = 6.4543e-04
Validation rmse = 0.216329
Epoch 38
Loss = 8.0437e-02, PNorm = 36.3855, GNorm = 1.6282, lr_0 = 6.4131e-04
Loss = 8.8531e-02, PNorm = 36.4073, GNorm = 2.3294, lr_0 = 6.3760e-04
Validation rmse = 0.228966
Epoch 39
Loss = 8.9109e-02, PNorm = 36.4307, GNorm = 2.3138, lr_0 = 6.3390e-04
Loss = 8.6038e-02, PNorm = 36.4477, GNorm = 2.1318, lr_0 = 6.3022e-04
Validation rmse = 0.195617
Epoch 40
Loss = 6.1721e-02, PNorm = 36.4759, GNorm = 0.5616, lr_0 = 6.2621e-04
Loss = 8.2368e-02, PNorm = 36.4956, GNorm = 0.5105, lr_0 = 6.2258e-04
Validation rmse = 0.209330
Epoch 41
Loss = 7.0764e-02, PNorm = 36.5161, GNorm = 1.3447, lr_0 = 6.1897e-04
Loss = 6.9327e-02, PNorm = 36.5367, GNorm = 1.2365, lr_0 = 6.1538e-04
Validation rmse = 0.218371
Epoch 42
Loss = 7.6629e-02, PNorm = 36.5610, GNorm = 1.4040, lr_0 = 6.1145e-04
Loss = 7.0495e-02, PNorm = 36.5797, GNorm = 0.9235, lr_0 = 6.0791e-04
Validation rmse = 0.198938
Epoch 43
Loss = 8.0521e-02, PNorm = 36.5976, GNorm = 0.6380, lr_0 = 6.0438e-04
Loss = 6.7696e-02, PNorm = 36.6181, GNorm = 0.6624, lr_0 = 6.0088e-04
Validation rmse = 0.232339
Epoch 44
Loss = 1.0664e-01, PNorm = 36.6426, GNorm = 1.1711, lr_0 = 5.9705e-04
Loss = 7.5438e-02, PNorm = 36.6663, GNorm = 1.2192, lr_0 = 5.9359e-04
Validation rmse = 0.207474
Epoch 45
Loss = 8.1625e-02, PNorm = 36.6892, GNorm = 1.6183, lr_0 = 5.8980e-04
Loss = 7.4945e-02, PNorm = 36.7181, GNorm = 0.8541, lr_0 = 5.8638e-04
Validation rmse = 0.202313
Epoch 46
Loss = 6.9632e-02, PNorm = 36.7352, GNorm = 1.3482, lr_0 = 5.8298e-04
Loss = 7.2434e-02, PNorm = 36.7571, GNorm = 1.6057, lr_0 = 5.7960e-04
Validation rmse = 0.224080
Epoch 47
Loss = 8.2470e-02, PNorm = 36.7793, GNorm = 0.6776, lr_0 = 5.7591e-04
Loss = 7.9246e-02, PNorm = 36.8001, GNorm = 0.5157, lr_0 = 5.7257e-04
Loss = 6.0899e-02, PNorm = 36.8190, GNorm = 1.1183, lr_0 = 5.6925e-04
Validation rmse = 0.218996
Epoch 48
Loss = 6.3631e-02, PNorm = 36.8375, GNorm = 1.4083, lr_0 = 5.6595e-04
Loss = 7.0134e-02, PNorm = 36.8558, GNorm = 0.7512, lr_0 = 5.6267e-04
Loss = 5.3669e-02, PNorm = 36.8579, GNorm = 1.4172, lr_0 = 5.6234e-04
Validation rmse = 0.215010
Epoch 49
Loss = 5.9585e-02, PNorm = 36.8766, GNorm = 0.7080, lr_0 = 5.5908e-04
Loss = 7.3424e-02, PNorm = 36.8937, GNorm = 1.7664, lr_0 = 5.5584e-04
Validation rmse = 0.199035
Epoch 50
Loss = 7.5100e-02, PNorm = 36.9164, GNorm = 1.0338, lr_0 = 5.5262e-04
Loss = 7.7334e-02, PNorm = 36.9357, GNorm = 1.7746, lr_0 = 5.4941e-04
Validation rmse = 0.243507
Epoch 51
Loss = 7.6291e-02, PNorm = 36.9605, GNorm = 0.6359, lr_0 = 5.4591e-04
Loss = 6.0547e-02, PNorm = 36.9797, GNorm = 0.3317, lr_0 = 5.4275e-04
Validation rmse = 0.209146
Epoch 52
Loss = 6.7171e-02, PNorm = 37.0023, GNorm = 1.2069, lr_0 = 5.3928e-04
Loss = 5.9172e-02, PNorm = 37.0214, GNorm = 0.5068, lr_0 = 5.3616e-04
Validation rmse = 0.231304
Epoch 53
Loss = 6.3327e-02, PNorm = 37.0379, GNorm = 0.4810, lr_0 = 5.3305e-04
Loss = 7.1550e-02, PNorm = 37.0557, GNorm = 0.6452, lr_0 = 5.2996e-04
Validation rmse = 0.214031
Epoch 54
Loss = 6.5185e-02, PNorm = 37.0789, GNorm = 0.9864, lr_0 = 5.2658e-04
Loss = 6.5642e-02, PNorm = 37.0978, GNorm = 1.6985, lr_0 = 5.2353e-04
Validation rmse = 0.204738
Epoch 55
Loss = 6.1036e-02, PNorm = 37.1188, GNorm = 0.7181, lr_0 = 5.2049e-04
Loss = 6.3173e-02, PNorm = 37.1371, GNorm = 0.8176, lr_0 = 5.1747e-04
Validation rmse = 0.231199
Epoch 56
Loss = 5.8544e-02, PNorm = 37.1562, GNorm = 1.1247, lr_0 = 5.1418e-04
Loss = 6.6254e-02, PNorm = 37.1731, GNorm = 0.8798, lr_0 = 5.1119e-04
Validation rmse = 0.232858
Epoch 57
Loss = 5.3292e-02, PNorm = 37.1945, GNorm = 0.4292, lr_0 = 5.0793e-04
Loss = 6.5735e-02, PNorm = 37.2146, GNorm = 0.8738, lr_0 = 5.0499e-04
Validation rmse = 0.212287
Epoch 58
Loss = 5.1994e-02, PNorm = 37.2301, GNorm = 0.5013, lr_0 = 5.0206e-04
Loss = 6.6749e-02, PNorm = 37.2450, GNorm = 0.7897, lr_0 = 4.9915e-04
Validation rmse = 0.220176
Epoch 59
Loss = 5.7565e-02, PNorm = 37.2646, GNorm = 0.4863, lr_0 = 4.9597e-04
Loss = 5.5886e-02, PNorm = 37.2820, GNorm = 1.6041, lr_0 = 4.9309e-04
Validation rmse = 0.222377
Epoch 60
Loss = 6.5464e-02, PNorm = 37.2970, GNorm = 0.7455, lr_0 = 4.9023e-04
Loss = 6.4670e-02, PNorm = 37.3119, GNorm = 2.0082, lr_0 = 4.8739e-04
Validation rmse = 0.237350
Epoch 61
Loss = 5.5093e-02, PNorm = 37.3376, GNorm = 1.4483, lr_0 = 4.8428e-04
Loss = 5.8499e-02, PNorm = 37.3549, GNorm = 0.7351, lr_0 = 4.8148e-04
Validation rmse = 0.214695
Epoch 62
Loss = 5.1325e-02, PNorm = 37.3701, GNorm = 0.9122, lr_0 = 4.7869e-04
Loss = 5.6831e-02, PNorm = 37.3844, GNorm = 0.5979, lr_0 = 4.7591e-04
Validation rmse = 0.230653
Epoch 63
Loss = 5.2654e-02, PNorm = 37.4037, GNorm = 1.7148, lr_0 = 4.7288e-04
Loss = 5.8748e-02, PNorm = 37.4202, GNorm = 0.6119, lr_0 = 4.7013e-04
Validation rmse = 0.214474
Epoch 64
Loss = 5.3180e-02, PNorm = 37.4382, GNorm = 0.6314, lr_0 = 4.6714e-04
Loss = 5.5255e-02, PNorm = 37.4543, GNorm = 0.7435, lr_0 = 4.6443e-04
Validation rmse = 0.247727
Epoch 65
Loss = 4.6030e-02, PNorm = 37.4702, GNorm = 0.8903, lr_0 = 4.6174e-04
Loss = 5.5587e-02, PNorm = 37.4849, GNorm = 0.7183, lr_0 = 4.5906e-04
Validation rmse = 0.230333
Epoch 66
Loss = 5.1232e-02, PNorm = 37.5009, GNorm = 0.9591, lr_0 = 4.5613e-04
Loss = 4.6869e-02, PNorm = 37.5174, GNorm = 1.0507, lr_0 = 4.5349e-04
Validation rmse = 0.242769
Epoch 67
Loss = 5.2757e-02, PNorm = 37.5326, GNorm = 1.6499, lr_0 = 4.5086e-04
Loss = 4.7629e-02, PNorm = 37.5491, GNorm = 0.8976, lr_0 = 4.4824e-04
Validation rmse = 0.236131
Epoch 68
Loss = 4.3360e-02, PNorm = 37.5667, GNorm = 1.1562, lr_0 = 4.4539e-04
Loss = 5.4129e-02, PNorm = 37.5840, GNorm = 1.3743, lr_0 = 4.4280e-04
Validation rmse = 0.222832
Epoch 69
Loss = 4.5763e-02, PNorm = 37.5989, GNorm = 0.8974, lr_0 = 4.3998e-04
Loss = 4.9478e-02, PNorm = 37.6131, GNorm = 0.7455, lr_0 = 4.3743e-04
Validation rmse = 0.214684
Epoch 70
Loss = 4.8336e-02, PNorm = 37.6263, GNorm = 0.3690, lr_0 = 4.3489e-04
Loss = 4.6661e-02, PNorm = 37.6392, GNorm = 1.2359, lr_0 = 4.3237e-04
Validation rmse = 0.223120
Epoch 71
Loss = 5.6703e-02, PNorm = 37.6543, GNorm = 0.9290, lr_0 = 4.2962e-04
Loss = 5.2529e-02, PNorm = 37.6723, GNorm = 0.7779, lr_0 = 4.2713e-04
Loss = 5.2633e-02, PNorm = 37.6901, GNorm = 1.1669, lr_0 = 4.2465e-04
Validation rmse = 0.240373
Epoch 72
Loss = 5.3228e-02, PNorm = 37.7021, GNorm = 0.3514, lr_0 = 4.2219e-04
Loss = 4.4998e-02, PNorm = 37.7150, GNorm = 0.5539, lr_0 = 4.1974e-04
Loss = 2.1759e-02, PNorm = 37.7161, GNorm = 0.7101, lr_0 = 4.1950e-04
Validation rmse = 0.206188
Epoch 73
Loss = 4.5655e-02, PNorm = 37.7315, GNorm = 1.3654, lr_0 = 4.1706e-04
Loss = 4.7181e-02, PNorm = 37.7441, GNorm = 0.4494, lr_0 = 4.1465e-04
Validation rmse = 0.222171
Epoch 74
Loss = 3.8020e-02, PNorm = 37.7560, GNorm = 0.4697, lr_0 = 4.1224e-04
Loss = 4.5471e-02, PNorm = 37.7668, GNorm = 0.5308, lr_0 = 4.0985e-04
Validation rmse = 0.205806
Epoch 75
Loss = 3.8617e-02, PNorm = 37.7804, GNorm = 0.4788, lr_0 = 4.0724e-04
Loss = 4.5744e-02, PNorm = 37.7900, GNorm = 1.1640, lr_0 = 4.0488e-04
Validation rmse = 0.213651
Epoch 76
Loss = 4.5975e-02, PNorm = 37.8074, GNorm = 1.3472, lr_0 = 4.0230e-04
Loss = 5.0226e-02, PNorm = 37.8212, GNorm = 0.5040, lr_0 = 3.9996e-04
Validation rmse = 0.239299
Epoch 77
Loss = 4.4325e-02, PNorm = 37.8325, GNorm = 0.9961, lr_0 = 3.9764e-04
Loss = 4.3681e-02, PNorm = 37.8440, GNorm = 1.2656, lr_0 = 3.9534e-04
Validation rmse = 0.201879
Epoch 78
Loss = 4.7700e-02, PNorm = 37.8571, GNorm = 0.8693, lr_0 = 3.9282e-04
Loss = 4.6159e-02, PNorm = 37.8718, GNorm = 0.5902, lr_0 = 3.9054e-04
Validation rmse = 0.227401
Epoch 79
Loss = 5.2670e-02, PNorm = 37.8840, GNorm = 1.9092, lr_0 = 3.8828e-04
Loss = 4.2024e-02, PNorm = 37.8969, GNorm = 0.4680, lr_0 = 3.8603e-04
Validation rmse = 0.234135
Epoch 80
Loss = 4.1199e-02, PNorm = 37.9129, GNorm = 1.1928, lr_0 = 3.8356e-04
Loss = 4.7315e-02, PNorm = 37.9245, GNorm = 1.2727, lr_0 = 3.8134e-04
Validation rmse = 0.202942
Epoch 81
Loss = 3.6742e-02, PNorm = 37.9335, GNorm = 0.9365, lr_0 = 3.7913e-04
Loss = 4.8652e-02, PNorm = 37.9456, GNorm = 0.6074, lr_0 = 3.7693e-04
Validation rmse = 0.242270
Epoch 82
Loss = 3.7511e-02, PNorm = 37.9567, GNorm = 0.6689, lr_0 = 3.7453e-04
Loss = 4.1206e-02, PNorm = 37.9666, GNorm = 0.4484, lr_0 = 3.7236e-04
Validation rmse = 0.241236
Epoch 83
Loss = 3.9183e-02, PNorm = 37.9784, GNorm = 1.1501, lr_0 = 3.6998e-04
Loss = 3.8174e-02, PNorm = 37.9891, GNorm = 0.8199, lr_0 = 3.6784e-04
Validation rmse = 0.219160
Epoch 84
Loss = 3.7727e-02, PNorm = 38.0002, GNorm = 0.6035, lr_0 = 3.6571e-04
Loss = 5.0309e-02, PNorm = 38.0094, GNorm = 0.5883, lr_0 = 3.6359e-04
Validation rmse = 0.200361
Epoch 85
Loss = 5.1612e-02, PNorm = 38.0295, GNorm = 2.0782, lr_0 = 3.6127e-04
Loss = 4.8779e-02, PNorm = 38.0402, GNorm = 1.2019, lr_0 = 3.5917e-04
Validation rmse = 0.213292
Epoch 86
Loss = 2.5439e-02, PNorm = 38.0534, GNorm = 0.3965, lr_0 = 3.5709e-04
Loss = 3.8469e-02, PNorm = 38.0628, GNorm = 1.0576, lr_0 = 3.5502e-04
Validation rmse = 0.245486
Epoch 87
Loss = 3.3075e-02, PNorm = 38.0745, GNorm = 0.4941, lr_0 = 3.5276e-04
Loss = 4.3300e-02, PNorm = 38.0826, GNorm = 0.5967, lr_0 = 3.5071e-04
Validation rmse = 0.227407
Epoch 88
Loss = 4.0278e-02, PNorm = 38.0949, GNorm = 0.6385, lr_0 = 3.4848e-04
Loss = 3.7271e-02, PNorm = 38.1058, GNorm = 0.6725, lr_0 = 3.4645e-04
Validation rmse = 0.228868
Epoch 89
Loss = 3.2260e-02, PNorm = 38.1151, GNorm = 1.1922, lr_0 = 3.4445e-04
Loss = 4.1199e-02, PNorm = 38.1242, GNorm = 1.3707, lr_0 = 3.4245e-04
Validation rmse = 0.233313
Epoch 90
Loss = 4.4302e-02, PNorm = 38.1343, GNorm = 0.7538, lr_0 = 3.4027e-04
Loss = 3.7380e-02, PNorm = 38.1444, GNorm = 0.6894, lr_0 = 3.3829e-04
Validation rmse = 0.222780
Epoch 91
Loss = 3.1854e-02, PNorm = 38.1554, GNorm = 0.9687, lr_0 = 3.3633e-04
Loss = 3.8087e-02, PNorm = 38.1653, GNorm = 1.0830, lr_0 = 3.3438e-04
Validation rmse = 0.230267
Epoch 92
Loss = 2.8109e-02, PNorm = 38.1746, GNorm = 0.7586, lr_0 = 3.3225e-04
Loss = 3.5751e-02, PNorm = 38.1820, GNorm = 0.5313, lr_0 = 3.3032e-04
Validation rmse = 0.245514
Epoch 93
Loss = 2.1576e-02, PNorm = 38.1920, GNorm = 0.4324, lr_0 = 3.2841e-04
Loss = 3.5476e-02, PNorm = 38.1993, GNorm = 1.0331, lr_0 = 3.2650e-04
Validation rmse = 0.235834
Epoch 94
Loss = 3.8292e-02, PNorm = 38.2101, GNorm = 0.9373, lr_0 = 3.2442e-04
Loss = 3.3092e-02, PNorm = 38.2192, GNorm = 0.9278, lr_0 = 3.2254e-04
Validation rmse = 0.215830
Epoch 95
Loss = 3.1051e-02, PNorm = 38.2267, GNorm = 1.1606, lr_0 = 3.2049e-04
Loss = 3.0129e-02, PNorm = 38.2353, GNorm = 0.6819, lr_0 = 3.1863e-04
Loss = 3.8689e-02, PNorm = 38.2443, GNorm = 1.4548, lr_0 = 3.1678e-04
Validation rmse = 0.225972
Epoch 96
Loss = 3.3891e-02, PNorm = 38.2515, GNorm = 0.5645, lr_0 = 3.1494e-04
Loss = 3.5459e-02, PNorm = 38.2581, GNorm = 0.5320, lr_0 = 3.1312e-04
Loss = 3.4514e-02, PNorm = 38.2589, GNorm = 0.7670, lr_0 = 3.1294e-04
Validation rmse = 0.213111
Epoch 97
Loss = 3.2683e-02, PNorm = 38.2677, GNorm = 0.2941, lr_0 = 3.1112e-04
Loss = 3.2974e-02, PNorm = 38.2752, GNorm = 0.4381, lr_0 = 3.0932e-04
Validation rmse = 0.211677
Epoch 98
Loss = 3.3756e-02, PNorm = 38.2841, GNorm = 0.9602, lr_0 = 3.0752e-04
Loss = 3.2337e-02, PNorm = 38.2904, GNorm = 0.8003, lr_0 = 3.0574e-04
Validation rmse = 0.225478
Epoch 99
Loss = 3.1793e-02, PNorm = 38.2984, GNorm = 0.4726, lr_0 = 3.0379e-04
Loss = 3.4592e-02, PNorm = 38.3053, GNorm = 0.7313, lr_0 = 3.0203e-04
Validation rmse = 0.226737
Epoch 100
Loss = 3.6535e-02, PNorm = 38.3140, GNorm = 0.7081, lr_0 = 3.0028e-04
Loss = 3.3332e-02, PNorm = 38.3225, GNorm = 1.3009, lr_0 = 2.9854e-04
Validation rmse = 0.218595
Epoch 101
Loss = 3.4656e-02, PNorm = 38.3313, GNorm = 0.3889, lr_0 = 2.9663e-04
Loss = 3.4410e-02, PNorm = 38.3389, GNorm = 0.7878, lr_0 = 2.9492e-04
Validation rmse = 0.218684
Epoch 102
Loss = 3.2215e-02, PNorm = 38.3460, GNorm = 0.8262, lr_0 = 2.9303e-04
Loss = 3.2927e-02, PNorm = 38.3548, GNorm = 0.3310, lr_0 = 2.9134e-04
Validation rmse = 0.244599
Epoch 103
Loss = 3.5310e-02, PNorm = 38.3604, GNorm = 0.6906, lr_0 = 2.8965e-04
Loss = 3.0353e-02, PNorm = 38.3666, GNorm = 0.3631, lr_0 = 2.8797e-04
Validation rmse = 0.238372
Epoch 104
Loss = 2.8414e-02, PNorm = 38.3747, GNorm = 0.6821, lr_0 = 2.8613e-04
Loss = 3.3026e-02, PNorm = 38.3818, GNorm = 0.5563, lr_0 = 2.8447e-04
Validation rmse = 0.228569
Epoch 105
Loss = 2.3635e-02, PNorm = 38.3907, GNorm = 0.3008, lr_0 = 2.8282e-04
Loss = 3.2256e-02, PNorm = 38.3959, GNorm = 1.6527, lr_0 = 2.8118e-04
Validation rmse = 0.231275
Epoch 106
Loss = 2.7669e-02, PNorm = 38.4044, GNorm = 0.4230, lr_0 = 2.7939e-04
Loss = 3.1570e-02, PNorm = 38.4111, GNorm = 0.7943, lr_0 = 2.7777e-04
Validation rmse = 0.224655
Epoch 107
Loss = 2.7329e-02, PNorm = 38.4209, GNorm = 0.3890, lr_0 = 2.7600e-04
Loss = 3.1203e-02, PNorm = 38.4282, GNorm = 0.8558, lr_0 = 2.7440e-04
Validation rmse = 0.237928
Epoch 108
Loss = 2.9193e-02, PNorm = 38.4347, GNorm = 0.7448, lr_0 = 2.7281e-04
Loss = 2.6856e-02, PNorm = 38.4412, GNorm = 0.8105, lr_0 = 2.7123e-04
Validation rmse = 0.238779
Epoch 109
Loss = 3.6243e-02, PNorm = 38.4488, GNorm = 1.5319, lr_0 = 2.6950e-04
Loss = 3.3779e-02, PNorm = 38.4557, GNorm = 0.5138, lr_0 = 2.6794e-04
Validation rmse = 0.214787
Epoch 110
Loss = 2.7295e-02, PNorm = 38.4637, GNorm = 0.4679, lr_0 = 2.6638e-04
Loss = 3.2468e-02, PNorm = 38.4722, GNorm = 0.2890, lr_0 = 2.6484e-04
Validation rmse = 0.229206
Epoch 111
Loss = 3.4852e-02, PNorm = 38.4786, GNorm = 0.6120, lr_0 = 2.6315e-04
Loss = 2.8273e-02, PNorm = 38.4855, GNorm = 0.3557, lr_0 = 2.6162e-04
Validation rmse = 0.228095
Epoch 112
Loss = 1.9783e-02, PNorm = 38.4908, GNorm = 0.2791, lr_0 = 2.6011e-04
Loss = 2.9280e-02, PNorm = 38.4968, GNorm = 1.0682, lr_0 = 2.5860e-04
Validation rmse = 0.248764
Epoch 113
Loss = 2.7384e-02, PNorm = 38.5038, GNorm = 0.4636, lr_0 = 2.5695e-04
Loss = 2.7341e-02, PNorm = 38.5067, GNorm = 0.3652, lr_0 = 2.5546e-04
Validation rmse = 0.234238
Epoch 114
Loss = 2.7049e-02, PNorm = 38.5151, GNorm = 1.3141, lr_0 = 2.5383e-04
Loss = 2.9078e-02, PNorm = 38.5221, GNorm = 1.2224, lr_0 = 2.5236e-04
Validation rmse = 0.226533
Epoch 115
Loss = 1.8567e-02, PNorm = 38.5289, GNorm = 0.3608, lr_0 = 2.5090e-04
Loss = 3.2578e-02, PNorm = 38.5351, GNorm = 0.5371, lr_0 = 2.4944e-04
Validation rmse = 0.234005
Epoch 116
Loss = 1.9246e-02, PNorm = 38.5435, GNorm = 0.3533, lr_0 = 2.4785e-04
Loss = 2.9027e-02, PNorm = 38.5502, GNorm = 0.7654, lr_0 = 2.4641e-04
Validation rmse = 0.231837
Epoch 117
Loss = 3.7921e-02, PNorm = 38.5560, GNorm = 1.5495, lr_0 = 2.4499e-04
Loss = 2.7265e-02, PNorm = 38.5603, GNorm = 1.4474, lr_0 = 2.4357e-04
Validation rmse = 0.226049
Epoch 118
Loss = 3.1538e-02, PNorm = 38.5662, GNorm = 0.8371, lr_0 = 2.4201e-04
Loss = 3.2458e-02, PNorm = 38.5746, GNorm = 0.6050, lr_0 = 2.4061e-04
Validation rmse = 0.220138
Epoch 119
Loss = 2.1377e-02, PNorm = 38.5810, GNorm = 0.4278, lr_0 = 2.3908e-04
Loss = 2.6071e-02, PNorm = 38.5865, GNorm = 0.3650, lr_0 = 2.3769e-04
Loss = 3.0444e-02, PNorm = 38.5919, GNorm = 0.6002, lr_0 = 2.3631e-04
Validation rmse = 0.244147
Epoch 120
Loss = 2.8677e-02, PNorm = 38.5973, GNorm = 0.7180, lr_0 = 2.3494e-04
Loss = 2.7682e-02, PNorm = 38.6023, GNorm = 0.6818, lr_0 = 2.3358e-04
Loss = 2.1338e-02, PNorm = 38.6027, GNorm = 0.4513, lr_0 = 2.3344e-04
Validation rmse = 0.207112
Epoch 121
Loss = 2.4441e-02, PNorm = 38.6087, GNorm = 0.6126, lr_0 = 2.3209e-04
Loss = 2.9059e-02, PNorm = 38.6154, GNorm = 0.4924, lr_0 = 2.3074e-04
Validation rmse = 0.232954
Epoch 122
Loss = 2.7711e-02, PNorm = 38.6201, GNorm = 0.8716, lr_0 = 2.2941e-04
Loss = 2.6005e-02, PNorm = 38.6256, GNorm = 0.6758, lr_0 = 2.2808e-04
Validation rmse = 0.228937
Epoch 123
Loss = 3.1912e-02, PNorm = 38.6314, GNorm = 0.4978, lr_0 = 2.2662e-04
Loss = 2.7406e-02, PNorm = 38.6376, GNorm = 0.5926, lr_0 = 2.2531e-04
Validation rmse = 0.223989
Epoch 124
Loss = 3.3287e-02, PNorm = 38.6437, GNorm = 1.6409, lr_0 = 2.2400e-04
Loss = 3.1068e-02, PNorm = 38.6516, GNorm = 1.4954, lr_0 = 2.2270e-04
Validation rmse = 0.232061
Epoch 125
Loss = 2.7649e-02, PNorm = 38.6587, GNorm = 0.3965, lr_0 = 2.2128e-04
Loss = 2.6320e-02, PNorm = 38.6639, GNorm = 0.8754, lr_0 = 2.2000e-04
Validation rmse = 0.235093
Epoch 126
Loss = 2.7515e-02, PNorm = 38.6676, GNorm = 1.0787, lr_0 = 2.1860e-04
Loss = 2.8502e-02, PNorm = 38.6723, GNorm = 0.7980, lr_0 = 2.1733e-04
Validation rmse = 0.241517
Epoch 127
Loss = 2.5799e-02, PNorm = 38.6782, GNorm = 0.8863, lr_0 = 2.1607e-04
Loss = 2.9292e-02, PNorm = 38.6836, GNorm = 0.6498, lr_0 = 2.1482e-04
Validation rmse = 0.237556
Epoch 128
Loss = 2.2993e-02, PNorm = 38.6888, GNorm = 0.6385, lr_0 = 2.1345e-04
Loss = 2.5126e-02, PNorm = 38.6944, GNorm = 0.7673, lr_0 = 2.1221e-04
Validation rmse = 0.227691
Epoch 129
Loss = 2.2221e-02, PNorm = 38.6989, GNorm = 0.4732, lr_0 = 2.1098e-04
Loss = 2.5106e-02, PNorm = 38.7050, GNorm = 0.5470, lr_0 = 2.0976e-04
Validation rmse = 0.233213
Epoch 130
Loss = 1.9681e-02, PNorm = 38.7087, GNorm = 0.4042, lr_0 = 2.0842e-04
Loss = 2.6060e-02, PNorm = 38.7131, GNorm = 0.3916, lr_0 = 2.0721e-04
Validation rmse = 0.219923
Epoch 131
Loss = 1.8859e-02, PNorm = 38.7169, GNorm = 0.3268, lr_0 = 2.0601e-04
Loss = 2.7646e-02, PNorm = 38.7220, GNorm = 0.6300, lr_0 = 2.0482e-04
Validation rmse = 0.223602
Epoch 132
Loss = 1.7522e-02, PNorm = 38.7270, GNorm = 0.2732, lr_0 = 2.0351e-04
Loss = 2.4067e-02, PNorm = 38.7312, GNorm = 0.4823, lr_0 = 2.0233e-04
Validation rmse = 0.229811
Epoch 133
Loss = 2.4581e-02, PNorm = 38.7360, GNorm = 0.5513, lr_0 = 2.0104e-04
Loss = 2.3994e-02, PNorm = 38.7409, GNorm = 0.5321, lr_0 = 1.9987e-04
Validation rmse = 0.237131
Epoch 134
Loss = 1.9446e-02, PNorm = 38.7449, GNorm = 0.4461, lr_0 = 1.9872e-04
Loss = 2.5727e-02, PNorm = 38.7487, GNorm = 0.7626, lr_0 = 1.9756e-04
Validation rmse = 0.229728
Epoch 135
Loss = 2.5024e-02, PNorm = 38.7533, GNorm = 0.4476, lr_0 = 1.9630e-04
Loss = 2.2970e-02, PNorm = 38.7565, GNorm = 0.5312, lr_0 = 1.9517e-04
Validation rmse = 0.217289
Epoch 136
Loss = 2.5207e-02, PNorm = 38.7617, GNorm = 0.9138, lr_0 = 1.9403e-04
Loss = 2.3684e-02, PNorm = 38.7654, GNorm = 0.7816, lr_0 = 1.9291e-04
Validation rmse = 0.206484
Epoch 137
Loss = 2.5787e-02, PNorm = 38.7703, GNorm = 0.6695, lr_0 = 1.9168e-04
Loss = 2.3337e-02, PNorm = 38.7747, GNorm = 0.6178, lr_0 = 1.9057e-04
Validation rmse = 0.225056
Epoch 138
Loss = 2.6388e-02, PNorm = 38.7808, GNorm = 1.1254, lr_0 = 1.8935e-04
Loss = 2.2932e-02, PNorm = 38.7867, GNorm = 0.2280, lr_0 = 1.8826e-04
Validation rmse = 0.216400
Epoch 139
Loss = 2.0752e-02, PNorm = 38.7895, GNorm = 0.5827, lr_0 = 1.8716e-04
Loss = 2.3879e-02, PNorm = 38.7927, GNorm = 0.8985, lr_0 = 1.8608e-04
Validation rmse = 0.231154
Epoch 140
Loss = 1.9535e-02, PNorm = 38.7980, GNorm = 0.4181, lr_0 = 1.8489e-04
Loss = 2.0504e-02, PNorm = 38.8023, GNorm = 0.4869, lr_0 = 1.8382e-04
Validation rmse = 0.226692
Epoch 141
Loss = 1.2280e-02, PNorm = 38.8055, GNorm = 0.2738, lr_0 = 1.8275e-04
Loss = 2.2505e-02, PNorm = 38.8087, GNorm = 0.5394, lr_0 = 1.8170e-04
Validation rmse = 0.217078
Epoch 142
Loss = 3.2917e-02, PNorm = 38.8131, GNorm = 1.0543, lr_0 = 1.8054e-04
Loss = 2.4299e-02, PNorm = 38.8165, GNorm = 0.5589, lr_0 = 1.7949e-04
Loss = 2.1611e-02, PNorm = 38.8214, GNorm = 0.3853, lr_0 = 1.7845e-04
Validation rmse = 0.224372
Epoch 143
Loss = 2.3902e-02, PNorm = 38.8262, GNorm = 0.7717, lr_0 = 1.7741e-04
Loss = 2.0949e-02, PNorm = 38.8305, GNorm = 0.6275, lr_0 = 1.7639e-04
Loss = 3.8610e-02, PNorm = 38.8307, GNorm = 1.0190, lr_0 = 1.7628e-04
Validation rmse = 0.232228
Epoch 144
Loss = 2.1900e-02, PNorm = 38.8344, GNorm = 0.3437, lr_0 = 1.7526e-04
Loss = 2.2993e-02, PNorm = 38.8373, GNorm = 0.4986, lr_0 = 1.7425e-04
Loss = 1.5009e-02, PNorm = 38.8377, GNorm = 0.3934, lr_0 = 1.7414e-04
Validation rmse = 0.215796
Epoch 145
Loss = 2.3820e-02, PNorm = 38.8407, GNorm = 1.3937, lr_0 = 1.7313e-04
Loss = 2.2553e-02, PNorm = 38.8453, GNorm = 0.5343, lr_0 = 1.7213e-04
Validation rmse = 0.222986
Epoch 146
Loss = 2.2658e-02, PNorm = 38.8494, GNorm = 0.5770, lr_0 = 1.7113e-04
Loss = 2.9300e-02, PNorm = 38.8531, GNorm = 1.7830, lr_0 = 1.7014e-04
Validation rmse = 0.235527
Epoch 147
Loss = 2.2085e-02, PNorm = 38.8575, GNorm = 0.4694, lr_0 = 1.6906e-04
Loss = 2.5973e-02, PNorm = 38.8622, GNorm = 0.4333, lr_0 = 1.6808e-04
Validation rmse = 0.244608
Epoch 148
Loss = 2.4889e-02, PNorm = 38.8663, GNorm = 0.5774, lr_0 = 1.6710e-04
Loss = 2.1464e-02, PNorm = 38.8704, GNorm = 0.3932, lr_0 = 1.6613e-04
Validation rmse = 0.223210
Epoch 149
Loss = 2.2804e-02, PNorm = 38.8750, GNorm = 0.6173, lr_0 = 1.6507e-04
Loss = 2.2828e-02, PNorm = 38.8794, GNorm = 0.3770, lr_0 = 1.6412e-04
Validation rmse = 0.218313
Epoch 150
Loss = 1.7717e-02, PNorm = 38.8821, GNorm = 0.2853, lr_0 = 1.6316e-04
Loss = 2.1726e-02, PNorm = 38.8853, GNorm = 0.3840, lr_0 = 1.6222e-04
Validation rmse = 0.226424
Epoch 151
Loss = 2.1408e-02, PNorm = 38.8884, GNorm = 0.3873, lr_0 = 1.6118e-04
Loss = 2.1726e-02, PNorm = 38.8914, GNorm = 0.3121, lr_0 = 1.6025e-04
Validation rmse = 0.238508
Epoch 152
Loss = 2.1418e-02, PNorm = 38.8951, GNorm = 0.5246, lr_0 = 1.5923e-04
Loss = 2.1496e-02, PNorm = 38.8986, GNorm = 0.5189, lr_0 = 1.5831e-04
Validation rmse = 0.228446
Epoch 153
Loss = 2.0662e-02, PNorm = 38.9012, GNorm = 0.6091, lr_0 = 1.5739e-04
Loss = 2.1462e-02, PNorm = 38.9044, GNorm = 0.7405, lr_0 = 1.5647e-04
Validation rmse = 0.232300
Epoch 154
Loss = 1.8999e-02, PNorm = 38.9078, GNorm = 0.4599, lr_0 = 1.5548e-04
Loss = 2.0330e-02, PNorm = 38.9114, GNorm = 0.5720, lr_0 = 1.5458e-04
Validation rmse = 0.225956
Epoch 155
Loss = 2.2346e-02, PNorm = 38.9144, GNorm = 0.3858, lr_0 = 1.5368e-04
Loss = 2.1099e-02, PNorm = 38.9177, GNorm = 0.6445, lr_0 = 1.5279e-04
Validation rmse = 0.218651
Epoch 156
Loss = 2.3140e-02, PNorm = 38.9211, GNorm = 0.6085, lr_0 = 1.5181e-04
Loss = 2.1206e-02, PNorm = 38.9245, GNorm = 0.2149, lr_0 = 1.5093e-04
Validation rmse = 0.237067
Epoch 157
Loss = 1.5165e-02, PNorm = 38.9276, GNorm = 0.3621, lr_0 = 1.4997e-04
Loss = 1.9914e-02, PNorm = 38.9300, GNorm = 0.8406, lr_0 = 1.4910e-04
Validation rmse = 0.222190
Epoch 158
Loss = 2.1638e-02, PNorm = 38.9335, GNorm = 0.6534, lr_0 = 1.4824e-04
Loss = 2.1403e-02, PNorm = 38.9370, GNorm = 0.4850, lr_0 = 1.4738e-04
Validation rmse = 0.219560
Epoch 159
Loss = 2.6818e-02, PNorm = 38.9399, GNorm = 0.4342, lr_0 = 1.4644e-04
Loss = 1.8222e-02, PNorm = 38.9425, GNorm = 0.3106, lr_0 = 1.4559e-04
Validation rmse = 0.237381
Epoch 160
Loss = 1.6992e-02, PNorm = 38.9458, GNorm = 0.4539, lr_0 = 1.4475e-04
Loss = 1.7920e-02, PNorm = 38.9482, GNorm = 0.5349, lr_0 = 1.4391e-04
Validation rmse = 0.230830
Epoch 161
Loss = 1.8767e-02, PNorm = 38.9517, GNorm = 0.3446, lr_0 = 1.4299e-04
Loss = 1.8968e-02, PNorm = 38.9560, GNorm = 0.3598, lr_0 = 1.4216e-04
Validation rmse = 0.233971
Epoch 162
Loss = 1.5189e-02, PNorm = 38.9592, GNorm = 0.4623, lr_0 = 1.4134e-04
Loss = 2.3218e-02, PNorm = 38.9618, GNorm = 1.4683, lr_0 = 1.4052e-04
Validation rmse = 0.234620
Epoch 163
Loss = 1.9993e-02, PNorm = 38.9653, GNorm = 0.7172, lr_0 = 1.3962e-04
Loss = 1.7957e-02, PNorm = 38.9677, GNorm = 0.5539, lr_0 = 1.3881e-04
Validation rmse = 0.226356
Epoch 164
Loss = 2.8903e-02, PNorm = 38.9709, GNorm = 1.0555, lr_0 = 1.3793e-04
Loss = 1.9131e-02, PNorm = 38.9743, GNorm = 0.3776, lr_0 = 1.3713e-04
Validation rmse = 0.219840
Epoch 165
Loss = 1.8801e-02, PNorm = 38.9763, GNorm = 0.7530, lr_0 = 1.3633e-04
Loss = 1.9500e-02, PNorm = 38.9786, GNorm = 0.4009, lr_0 = 1.3554e-04
Validation rmse = 0.219043
Epoch 166
Loss = 2.6386e-02, PNorm = 38.9823, GNorm = 0.7956, lr_0 = 1.3468e-04
Loss = 1.9937e-02, PNorm = 38.9849, GNorm = 0.5198, lr_0 = 1.3390e-04
Loss = 2.0141e-02, PNorm = 38.9874, GNorm = 0.9790, lr_0 = 1.3312e-04
Validation rmse = 0.222530
Epoch 167
Loss = 1.9664e-02, PNorm = 38.9900, GNorm = 0.5066, lr_0 = 1.3235e-04
Loss = 2.1114e-02, PNorm = 38.9927, GNorm = 0.3604, lr_0 = 1.3158e-04
Loss = 1.6771e-02, PNorm = 38.9929, GNorm = 1.1670, lr_0 = 1.3150e-04
Validation rmse = 0.231133
Epoch 168
Loss = 2.0366e-02, PNorm = 38.9959, GNorm = 0.2802, lr_0 = 1.3074e-04
Loss = 1.9788e-02, PNorm = 38.9986, GNorm = 0.4080, lr_0 = 1.2998e-04
Loss = 1.7827e-02, PNorm = 38.9989, GNorm = 0.7648, lr_0 = 1.2991e-04
Validation rmse = 0.234849
Epoch 169
Loss = 1.9090e-02, PNorm = 39.0014, GNorm = 0.1938, lr_0 = 1.2915e-04
Loss = 1.9058e-02, PNorm = 39.0038, GNorm = 1.0504, lr_0 = 1.2841e-04
Validation rmse = 0.206082
Epoch 170
Loss = 1.8573e-02, PNorm = 39.0061, GNorm = 0.4390, lr_0 = 1.2766e-04
Loss = 1.9503e-02, PNorm = 39.0085, GNorm = 0.4696, lr_0 = 1.2692e-04
Validation rmse = 0.211010
Epoch 171
Loss = 2.0360e-02, PNorm = 39.0113, GNorm = 0.2658, lr_0 = 1.2611e-04
Loss = 1.8983e-02, PNorm = 39.0140, GNorm = 0.5070, lr_0 = 1.2538e-04
Validation rmse = 0.225127
Epoch 172
Loss = 1.8195e-02, PNorm = 39.0171, GNorm = 0.4069, lr_0 = 1.2465e-04
Loss = 2.0739e-02, PNorm = 39.0200, GNorm = 0.4590, lr_0 = 1.2393e-04
Validation rmse = 0.226305
Epoch 173
Loss = 2.2633e-02, PNorm = 39.0223, GNorm = 0.4846, lr_0 = 1.2314e-04
Loss = 1.6262e-02, PNorm = 39.0245, GNorm = 0.3862, lr_0 = 1.2243e-04
Validation rmse = 0.227819
Epoch 174
Loss = 2.0133e-02, PNorm = 39.0270, GNorm = 0.9202, lr_0 = 1.2172e-04
Loss = 1.8508e-02, PNorm = 39.0294, GNorm = 0.9509, lr_0 = 1.2101e-04
Validation rmse = 0.230409
Epoch 175
Loss = 1.7310e-02, PNorm = 39.0315, GNorm = 0.8672, lr_0 = 1.2024e-04
Loss = 1.8325e-02, PNorm = 39.0345, GNorm = 0.6038, lr_0 = 1.1954e-04
Validation rmse = 0.238322
Epoch 176
Loss = 2.2042e-02, PNorm = 39.0371, GNorm = 0.3901, lr_0 = 1.1878e-04
Loss = 1.8610e-02, PNorm = 39.0395, GNorm = 0.3895, lr_0 = 1.1809e-04
Validation rmse = 0.225218
Epoch 177
Loss = 2.2518e-02, PNorm = 39.0419, GNorm = 0.6396, lr_0 = 1.1741e-04
Loss = 1.8289e-02, PNorm = 39.0441, GNorm = 1.0469, lr_0 = 1.1673e-04
Validation rmse = 0.223398
Epoch 178
Loss = 1.8438e-02, PNorm = 39.0464, GNorm = 0.2958, lr_0 = 1.1598e-04
Loss = 1.8362e-02, PNorm = 39.0486, GNorm = 0.4597, lr_0 = 1.1531e-04
Validation rmse = 0.233048
Epoch 179
Loss = 2.1540e-02, PNorm = 39.0510, GNorm = 0.6336, lr_0 = 1.1464e-04
Loss = 1.6989e-02, PNorm = 39.0533, GNorm = 0.3769, lr_0 = 1.1398e-04
Validation rmse = 0.224125
Epoch 180
Loss = 1.3080e-02, PNorm = 39.0555, GNorm = 0.3020, lr_0 = 1.1325e-04
Loss = 2.0704e-02, PNorm = 39.0574, GNorm = 1.0426, lr_0 = 1.1259e-04
Validation rmse = 0.225616
Epoch 181
Loss = 1.5141e-02, PNorm = 39.0599, GNorm = 0.4696, lr_0 = 1.1194e-04
Loss = 2.0692e-02, PNorm = 39.0620, GNorm = 0.5488, lr_0 = 1.1129e-04
Validation rmse = 0.223276
Epoch 182
Loss = 1.4956e-02, PNorm = 39.0646, GNorm = 0.4741, lr_0 = 1.1058e-04
Loss = 1.6217e-02, PNorm = 39.0664, GNorm = 0.3611, lr_0 = 1.0994e-04
Validation rmse = 0.227475
Epoch 183
Loss = 2.5352e-02, PNorm = 39.0691, GNorm = 0.7351, lr_0 = 1.0924e-04
Loss = 1.7683e-02, PNorm = 39.0712, GNorm = 0.3661, lr_0 = 1.0861e-04
Validation rmse = 0.226656
Epoch 184
Loss = 2.4469e-02, PNorm = 39.0732, GNorm = 0.7624, lr_0 = 1.0798e-04
Loss = 1.6584e-02, PNorm = 39.0762, GNorm = 0.3923, lr_0 = 1.0735e-04
Validation rmse = 0.220259
Epoch 185
Loss = 2.4573e-02, PNorm = 39.0783, GNorm = 0.2468, lr_0 = 1.0667e-04
Loss = 1.5632e-02, PNorm = 39.0800, GNorm = 0.4579, lr_0 = 1.0605e-04
Validation rmse = 0.211791
Epoch 186
Loss = 2.0075e-02, PNorm = 39.0814, GNorm = 0.6293, lr_0 = 1.0543e-04
Loss = 1.5096e-02, PNorm = 39.0840, GNorm = 0.7255, lr_0 = 1.0482e-04
Validation rmse = 0.222395
Epoch 187
Loss = 1.9430e-02, PNorm = 39.0862, GNorm = 0.2762, lr_0 = 1.0415e-04
Loss = 1.8605e-02, PNorm = 39.0882, GNorm = 0.3597, lr_0 = 1.0355e-04
Validation rmse = 0.218207
Epoch 188
Loss = 1.0408e-02, PNorm = 39.0903, GNorm = 0.4815, lr_0 = 1.0289e-04
Loss = 1.7615e-02, PNorm = 39.0922, GNorm = 0.6927, lr_0 = 1.0229e-04
Validation rmse = 0.221747
Epoch 189
Loss = 1.8043e-02, PNorm = 39.0942, GNorm = 0.3653, lr_0 = 1.0170e-04
Loss = 1.7626e-02, PNorm = 39.0963, GNorm = 0.5956, lr_0 = 1.0111e-04
Validation rmse = 0.222634
Epoch 190
Loss = 1.0579e-02, PNorm = 39.0983, GNorm = 0.3561, lr_0 = 1.0047e-04
Loss = 1.6864e-02, PNorm = 39.1006, GNorm = 0.5482, lr_0 = 1.0000e-04
Loss = 1.9168e-02, PNorm = 39.1020, GNorm = 0.4980, lr_0 = 1.0000e-04
Validation rmse = 0.220070
Epoch 191
Loss = 1.6227e-02, PNorm = 39.1043, GNorm = 0.4409, lr_0 = 1.0000e-04
Loss = 1.8098e-02, PNorm = 39.1065, GNorm = 0.9349, lr_0 = 1.0000e-04
Loss = 3.0838e-02, PNorm = 39.1065, GNorm = 1.1877, lr_0 = 1.0000e-04
Validation rmse = 0.218112
Epoch 192
Loss = 1.8588e-02, PNorm = 39.1082, GNorm = 0.7387, lr_0 = 1.0000e-04
Loss = 1.6502e-02, PNorm = 39.1098, GNorm = 0.2442, lr_0 = 1.0000e-04
Validation rmse = 0.219861
Epoch 193
Loss = 1.6929e-02, PNorm = 39.1120, GNorm = 0.5865, lr_0 = 1.0000e-04
Loss = 1.7033e-02, PNorm = 39.1138, GNorm = 0.4245, lr_0 = 1.0000e-04
Validation rmse = 0.227085
Epoch 194
Loss = 1.6291e-02, PNorm = 39.1156, GNorm = 0.3024, lr_0 = 1.0000e-04
Loss = 1.8923e-02, PNorm = 39.1176, GNorm = 0.7579, lr_0 = 1.0000e-04
Validation rmse = 0.231800
Epoch 195
Loss = 1.6050e-02, PNorm = 39.1202, GNorm = 0.7722, lr_0 = 1.0000e-04
Loss = 1.7794e-02, PNorm = 39.1221, GNorm = 0.5000, lr_0 = 1.0000e-04
Validation rmse = 0.218075
Epoch 196
Loss = 1.4406e-02, PNorm = 39.1248, GNorm = 0.4837, lr_0 = 1.0000e-04
Loss = 1.8974e-02, PNorm = 39.1266, GNorm = 0.9228, lr_0 = 1.0000e-04
Validation rmse = 0.220230
Epoch 197
Loss = 1.8853e-02, PNorm = 39.1284, GNorm = 0.6418, lr_0 = 1.0000e-04
Loss = 1.6591e-02, PNorm = 39.1306, GNorm = 0.6433, lr_0 = 1.0000e-04
Validation rmse = 0.224739
Epoch 198
Loss = 1.6088e-02, PNorm = 39.1327, GNorm = 0.3897, lr_0 = 1.0000e-04
Loss = 1.3376e-02, PNorm = 39.1345, GNorm = 0.5945, lr_0 = 1.0000e-04
Validation rmse = 0.223273
Epoch 199
Loss = 1.6287e-02, PNorm = 39.1363, GNorm = 0.3710, lr_0 = 1.0000e-04
Loss = 1.6764e-02, PNorm = 39.1382, GNorm = 0.6468, lr_0 = 1.0000e-04
Validation rmse = 0.214702
Model 0 best validation rmse = 0.167317 on epoch 1
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.155600
Ensemble test rmse = 0.155600
1-fold cross validation
	Seed 0 ==> test rmse = 0.155600
Overall test rmse = 0.155600 +/- 0.000000
Elapsed time = 0:02:25
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-7a157ae9-2130-4c84-9029-4d969b382ab6.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/FINAL_LIST.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 50,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,032 | train size = 820 | val size = 206 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.2405e-01, PNorm = 34.0176, GNorm = 4.0028, lr_0 = 4.0937e-04
Validation rmse = 0.317388
Epoch 1
Loss = 6.9494e-01, PNorm = 34.0466, GNorm = 1.8381, lr_0 = 7.1875e-04
Loss = 6.8079e-01, PNorm = 34.0985, GNorm = 1.5847, lr_0 = 1.0000e-03
Validation rmse = 0.248538
Epoch 2
Loss = 4.6448e-01, PNorm = 34.1834, GNorm = 1.5016, lr_0 = 9.6756e-04
Validation rmse = 0.231020
Epoch 3
Loss = 2.6175e-01, PNorm = 34.2632, GNorm = 4.7283, lr_0 = 9.3898e-04
Loss = 3.1113e-01, PNorm = 34.3350, GNorm = 0.8398, lr_0 = 9.1125e-04
Validation rmse = 0.190674
Epoch 4
Loss = 2.4540e-01, PNorm = 34.4046, GNorm = 4.9003, lr_0 = 8.8168e-04
Loss = 2.8520e-01, PNorm = 34.4611, GNorm = 3.3699, lr_0 = 8.5564e-04
Validation rmse = 0.181284
Epoch 5
Loss = 2.1206e-01, PNorm = 34.5212, GNorm = 1.7438, lr_0 = 8.3037e-04
Validation rmse = 0.162346
Epoch 6
Loss = 2.7044e-01, PNorm = 34.5690, GNorm = 2.5255, lr_0 = 8.0343e-04
Loss = 2.0594e-01, PNorm = 34.6062, GNorm = 1.1733, lr_0 = 7.7970e-04
Validation rmse = 0.157991
Epoch 7
Loss = 1.9314e-01, PNorm = 34.6448, GNorm = 3.1030, lr_0 = 7.5440e-04
Loss = 1.8000e-01, PNorm = 34.6764, GNorm = 1.5144, lr_0 = 7.3212e-04
Validation rmse = 0.156528
Epoch 8
Loss = 1.5374e-01, PNorm = 34.7107, GNorm = 0.6841, lr_0 = 7.1050e-04
Validation rmse = 0.166633
Epoch 9
Loss = 1.7438e-01, PNorm = 34.7440, GNorm = 6.0235, lr_0 = 6.8745e-04
Loss = 1.6179e-01, PNorm = 34.7704, GNorm = 2.0877, lr_0 = 6.6714e-04
Validation rmse = 0.145175
Epoch 10
Loss = 1.5296e-01, PNorm = 34.7927, GNorm = 4.2630, lr_0 = 6.4744e-04
Loss = 1.4777e-01, PNorm = 34.8200, GNorm = 0.9850, lr_0 = 6.2831e-04
Loss = 3.3357e-01, PNorm = 34.8219, GNorm = 6.1000, lr_0 = 6.2643e-04
Validation rmse = 0.153019
Epoch 11
Loss = 1.5090e-01, PNorm = 34.8466, GNorm = 3.6571, lr_0 = 6.0793e-04
Validation rmse = 0.140946
Epoch 12
Loss = 1.3205e-01, PNorm = 34.8687, GNorm = 1.5491, lr_0 = 5.8821e-04
Loss = 1.3159e-01, PNorm = 34.8877, GNorm = 0.6048, lr_0 = 5.7083e-04
Validation rmse = 0.137778
Epoch 13
Loss = 1.2616e-01, PNorm = 34.9004, GNorm = 1.1622, lr_0 = 5.5397e-04
Validation rmse = 0.160796
Epoch 14
Loss = 1.5041e-01, PNorm = 34.9211, GNorm = 2.8202, lr_0 = 5.3600e-04
Loss = 1.2933e-01, PNorm = 34.9371, GNorm = 2.4354, lr_0 = 5.2017e-04
Validation rmse = 0.140911
Epoch 15
Loss = 9.7095e-02, PNorm = 34.9556, GNorm = 1.7238, lr_0 = 5.0481e-04
Loss = 1.2252e-01, PNorm = 34.9735, GNorm = 0.8625, lr_0 = 4.8990e-04
Validation rmse = 0.136321
Epoch 16
Loss = 1.2045e-01, PNorm = 34.9893, GNorm = 1.2577, lr_0 = 4.7400e-04
Validation rmse = 0.140891
Epoch 17
Loss = 1.4395e-01, PNorm = 35.0027, GNorm = 1.2142, lr_0 = 4.5863e-04
Loss = 1.1551e-01, PNorm = 35.0175, GNorm = 1.4645, lr_0 = 4.4508e-04
Validation rmse = 0.137620
Epoch 18
Loss = 1.1775e-01, PNorm = 35.0328, GNorm = 0.7256, lr_0 = 4.3193e-04
Loss = 1.3458e-01, PNorm = 35.0458, GNorm = 1.7469, lr_0 = 4.1918e-04
Validation rmse = 0.140418
Epoch 19
Loss = 1.3280e-01, PNorm = 35.0595, GNorm = 2.2841, lr_0 = 4.0558e-04
Validation rmse = 0.135003
Epoch 20
Loss = 9.0255e-02, PNorm = 35.0717, GNorm = 0.9507, lr_0 = 3.9360e-04
Loss = 1.2167e-01, PNorm = 35.0836, GNorm = 2.1795, lr_0 = 3.8197e-04
Validation rmse = 0.135103
Epoch 21
Loss = 8.8012e-02, PNorm = 35.0964, GNorm = 0.7196, lr_0 = 3.6958e-04
Loss = 1.1380e-01, PNorm = 35.1052, GNorm = 1.5989, lr_0 = 3.5866e-04
Loss = 8.6040e-02, PNorm = 35.1061, GNorm = 1.3434, lr_0 = 3.5759e-04
Validation rmse = 0.131630
Epoch 22
Loss = 1.0917e-01, PNorm = 35.1185, GNorm = 4.2413, lr_0 = 3.4703e-04
Validation rmse = 0.138149
Epoch 23
Loss = 1.1754e-01, PNorm = 35.1300, GNorm = 0.9738, lr_0 = 3.3678e-04
Loss = 9.8786e-02, PNorm = 35.1405, GNorm = 0.8437, lr_0 = 3.2683e-04
Validation rmse = 0.130310
Epoch 24
Loss = 9.2908e-02, PNorm = 35.1500, GNorm = 1.6869, lr_0 = 3.1623e-04
Loss = 1.1123e-01, PNorm = 35.1585, GNorm = 4.4654, lr_0 = 3.0689e-04
Validation rmse = 0.132897
Epoch 25
Loss = 9.8998e-02, PNorm = 35.1669, GNorm = 0.8724, lr_0 = 2.9782e-04
Validation rmse = 0.134222
Epoch 26
Loss = 1.0058e-01, PNorm = 35.1768, GNorm = 0.5879, lr_0 = 2.8816e-04
Loss = 9.3824e-02, PNorm = 35.1835, GNorm = 1.9151, lr_0 = 2.7965e-04
Validation rmse = 0.134712
Epoch 27
Loss = 8.3288e-02, PNorm = 35.1926, GNorm = 1.4795, lr_0 = 2.7058e-04
Validation rmse = 0.132489
Epoch 28
Loss = 6.7835e-02, PNorm = 35.2004, GNorm = 0.9743, lr_0 = 2.6259e-04
Loss = 9.2389e-02, PNorm = 35.2073, GNorm = 1.6931, lr_0 = 2.5483e-04
Validation rmse = 0.131717
Epoch 29
Loss = 8.4005e-02, PNorm = 35.2171, GNorm = 1.0899, lr_0 = 2.4656e-04
Loss = 1.0328e-01, PNorm = 35.2250, GNorm = 1.3345, lr_0 = 2.3928e-04
Validation rmse = 0.131867
Epoch 30
Loss = 8.8889e-02, PNorm = 35.2315, GNorm = 0.3809, lr_0 = 2.3221e-04
Validation rmse = 0.130239
Epoch 31
Loss = 8.1542e-02, PNorm = 35.2390, GNorm = 0.6744, lr_0 = 2.2468e-04
Loss = 9.2643e-02, PNorm = 35.2445, GNorm = 0.3934, lr_0 = 2.1804e-04
Validation rmse = 0.138635
Epoch 32
Loss = 8.3121e-02, PNorm = 35.2520, GNorm = 1.3821, lr_0 = 2.1097e-04
Loss = 9.5883e-02, PNorm = 35.2592, GNorm = 1.0572, lr_0 = 2.0474e-04
Validation rmse = 0.135235
Epoch 33
Loss = 8.4699e-02, PNorm = 35.2642, GNorm = 0.8047, lr_0 = 1.9869e-04
Validation rmse = 0.134741
Epoch 34
Loss = 7.2281e-02, PNorm = 35.2712, GNorm = 1.3431, lr_0 = 1.9224e-04
Loss = 9.5177e-02, PNorm = 35.2762, GNorm = 1.2057, lr_0 = 1.8657e-04
Validation rmse = 0.130230
Epoch 35
Loss = 9.7083e-02, PNorm = 35.2828, GNorm = 1.0076, lr_0 = 1.8106e-04
Loss = 8.5729e-02, PNorm = 35.2886, GNorm = 0.9015, lr_0 = 1.7571e-04
Loss = 2.9164e-02, PNorm = 35.2892, GNorm = 1.7843, lr_0 = 1.7518e-04
Validation rmse = 0.130681
Epoch 36
Loss = 8.9073e-02, PNorm = 35.2948, GNorm = 1.3169, lr_0 = 1.7001e-04
Validation rmse = 0.134042
Epoch 37
Loss = 9.0058e-02, PNorm = 35.2998, GNorm = 1.7424, lr_0 = 1.6449e-04
Loss = 9.2136e-02, PNorm = 35.3043, GNorm = 2.0994, lr_0 = 1.5963e-04
Validation rmse = 0.136492
Epoch 38
Loss = 1.0552e-01, PNorm = 35.3084, GNorm = 1.6070, lr_0 = 1.5492e-04
Validation rmse = 0.135768
Epoch 39
Loss = 4.6366e-02, PNorm = 35.3157, GNorm = 1.9400, lr_0 = 1.4989e-04
Loss = 8.6793e-02, PNorm = 35.3200, GNorm = 0.6980, lr_0 = 1.4547e-04
Validation rmse = 0.133976
Epoch 40
Loss = 9.8110e-02, PNorm = 35.3241, GNorm = 1.4369, lr_0 = 1.4117e-04
Loss = 8.1054e-02, PNorm = 35.3284, GNorm = 1.4660, lr_0 = 1.3700e-04
Validation rmse = 0.129549
Epoch 41
Loss = 8.3097e-02, PNorm = 35.3325, GNorm = 0.5484, lr_0 = 1.3255e-04
Validation rmse = 0.130624
Epoch 42
Loss = 1.1155e-01, PNorm = 35.3372, GNorm = 1.1292, lr_0 = 1.2825e-04
Loss = 8.3791e-02, PNorm = 35.3416, GNorm = 2.4790, lr_0 = 1.2447e-04
Validation rmse = 0.130963
Epoch 43
Loss = 7.9163e-02, PNorm = 35.3446, GNorm = 1.6777, lr_0 = 1.2079e-04
Loss = 8.4571e-02, PNorm = 35.3475, GNorm = 1.7865, lr_0 = 1.1722e-04
Validation rmse = 0.134837
Epoch 44
Loss = 8.8211e-02, PNorm = 35.3511, GNorm = 2.3134, lr_0 = 1.1342e-04
Validation rmse = 0.132095
Epoch 45
Loss = 5.7421e-02, PNorm = 35.3543, GNorm = 0.9187, lr_0 = 1.1007e-04
Loss = 8.6444e-02, PNorm = 35.3575, GNorm = 1.2327, lr_0 = 1.0682e-04
Validation rmse = 0.129409
Epoch 46
Loss = 7.3550e-02, PNorm = 35.3615, GNorm = 1.8655, lr_0 = 1.0335e-04
Loss = 8.7799e-02, PNorm = 35.3640, GNorm = 0.7972, lr_0 = 1.0030e-04
Loss = 1.0740e-01, PNorm = 35.3644, GNorm = 1.3095, lr_0 = 1.0000e-04
Validation rmse = 0.130827
Epoch 47
Loss = 8.1541e-02, PNorm = 35.3681, GNorm = 1.2083, lr_0 = 1.0000e-04
Validation rmse = 0.130717
Epoch 48
Loss = 9.0490e-02, PNorm = 35.3711, GNorm = 2.4119, lr_0 = 1.0000e-04
Loss = 7.6857e-02, PNorm = 35.3747, GNorm = 0.6784, lr_0 = 1.0000e-04
Validation rmse = 0.131073
Epoch 49
Loss = 7.2453e-02, PNorm = 35.3777, GNorm = 1.0169, lr_0 = 1.0000e-04
Loss = 9.0552e-02, PNorm = 35.3803, GNorm = 1.6342, lr_0 = 1.0000e-04
Validation rmse = 0.129352
Model 0 best validation rmse = 0.129352 on epoch 49
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.080128
Ensemble test rmse = 0.080128
1-fold cross validation
	Seed 0 ==> test rmse = 0.080128
Overall test rmse = 0.080128 +/- 0.000000
Elapsed time = 0:00:36
