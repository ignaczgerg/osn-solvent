Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-9aa06278-3f02-46f3-a9f8-3e50b1e24e6f.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_final.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 50,
 'explicit_h': False,
 'extra_metrics': ['mse', 'r2'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'mse', 'r2'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/_final/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.6, 0.2, 0.2],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,041 | train size = 624 | val size = 208 | test size = 209
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.5057e-01, PNorm = 34.0172, GNorm = 3.6498, lr_0 = 5.1250e-04
Validation rmse = 0.318036
Validation mse = 0.101147
Validation r2 = 0.215060
Epoch 1
Loss = 7.1062e-01, PNorm = 34.0561, GNorm = 3.3124, lr_0 = 9.2500e-04
Validation rmse = 0.400948
Validation mse = 0.160760
Validation r2 = -0.247554
Epoch 2
Loss = 8.7573e-01, PNorm = 34.1270, GNorm = 10.6008, lr_0 = 9.6466e-04
Validation rmse = 0.256749
Validation mse = 0.065920
Validation r2 = 0.488436
Epoch 3
Loss = 6.3211e-01, PNorm = 34.1926, GNorm = 4.6479, lr_0 = 9.2686e-04
Validation rmse = 0.248554
Validation mse = 0.061779
Validation r2 = 0.520573
Epoch 4
Loss = 2.9315e-01, PNorm = 34.2680, GNorm = 1.6959, lr_0 = 8.8699e-04
Loss = 4.4536e-01, PNorm = 34.3289, GNorm = 1.3523, lr_0 = 8.5223e-04
Validation rmse = 0.208763
Validation mse = 0.043582
Validation r2 = 0.661786
Epoch 5
Loss = 2.9227e-01, PNorm = 34.3891, GNorm = 3.3047, lr_0 = 8.1883e-04
Validation rmse = 0.227944
Validation mse = 0.051959
Validation r2 = 0.596782
Epoch 6
Loss = 2.8313e-01, PNorm = 34.4429, GNorm = 0.7357, lr_0 = 7.8361e-04
Validation rmse = 0.182729
Validation mse = 0.033390
Validation r2 = 0.740882
Epoch 7
Loss = 2.9804e-01, PNorm = 34.4944, GNorm = 4.6602, lr_0 = 7.5290e-04
Validation rmse = 0.184964
Validation mse = 0.034212
Validation r2 = 0.734504
Epoch 8
Loss = 1.9287e-01, PNorm = 34.5415, GNorm = 2.9778, lr_0 = 7.2051e-04
Loss = 2.4811e-01, PNorm = 34.5809, GNorm = 1.4334, lr_0 = 6.9227e-04
Validation rmse = 0.173152
Validation mse = 0.029982
Validation r2 = 0.767332
Epoch 9
Loss = 2.0428e-01, PNorm = 34.6179, GNorm = 3.6024, lr_0 = 6.6515e-04
Validation rmse = 0.165020
Validation mse = 0.027232
Validation r2 = 0.788673
Epoch 10
Loss = 1.7670e-01, PNorm = 34.6565, GNorm = 2.2900, lr_0 = 6.3653e-04
Validation rmse = 0.151768
Validation mse = 0.023034
Validation r2 = 0.821250
Epoch 11
Loss = 1.7700e-01, PNorm = 34.6866, GNorm = 0.7787, lr_0 = 6.1159e-04
Validation rmse = 0.162597
Validation mse = 0.026438
Validation r2 = 0.794833
Epoch 12
Loss = 1.4463e-01, PNorm = 34.7186, GNorm = 2.3538, lr_0 = 5.8528e-04
Loss = 1.5758e-01, PNorm = 34.7419, GNorm = 3.1308, lr_0 = 5.6234e-04
Validation rmse = 0.151044
Validation mse = 0.022814
Validation r2 = 0.822953
Epoch 13
Loss = 1.4183e-01, PNorm = 34.7614, GNorm = 3.6776, lr_0 = 5.4030e-04
Validation rmse = 0.145457
Validation mse = 0.021158
Validation r2 = 0.835808
Epoch 14
Loss = 1.4492e-01, PNorm = 34.7865, GNorm = 1.5955, lr_0 = 5.1706e-04
Validation rmse = 0.147706
Validation mse = 0.021817
Validation r2 = 0.830691
Epoch 15
Loss = 1.1805e-01, PNorm = 34.8040, GNorm = 2.9859, lr_0 = 4.9680e-04
Validation rmse = 0.143988
Validation mse = 0.020733
Validation r2 = 0.839108
Epoch 16
Loss = 1.1581e-01, PNorm = 34.8248, GNorm = 3.0035, lr_0 = 4.7543e-04
Loss = 1.4659e-01, PNorm = 34.8416, GNorm = 5.7977, lr_0 = 4.5680e-04
Validation rmse = 0.147105
Validation mse = 0.021640
Validation r2 = 0.832067
Epoch 17
Loss = 1.5540e-01, PNorm = 34.8555, GNorm = 1.0202, lr_0 = 4.3890e-04
Validation rmse = 0.143780
Validation mse = 0.020673
Validation r2 = 0.839573
Epoch 18
Loss = 1.0024e-01, PNorm = 34.8746, GNorm = 4.0934, lr_0 = 4.2001e-04
Validation rmse = 0.145257
Validation mse = 0.021099
Validation r2 = 0.836260
Epoch 19
Loss = 1.2946e-01, PNorm = 34.8890, GNorm = 2.2290, lr_0 = 4.0356e-04
Validation rmse = 0.145908
Validation mse = 0.021289
Validation r2 = 0.834788
Epoch 20
Loss = 1.2217e-01, PNorm = 34.9037, GNorm = 3.6954, lr_0 = 3.8619e-04
Loss = 1.2256e-01, PNorm = 34.9176, GNorm = 1.8337, lr_0 = 3.7106e-04
Validation rmse = 0.143275
Validation mse = 0.020528
Validation r2 = 0.840696
Epoch 21
Loss = 1.0842e-01, PNorm = 34.9278, GNorm = 0.7654, lr_0 = 3.5652e-04
Validation rmse = 0.137719
Validation mse = 0.018967
Validation r2 = 0.852813
Epoch 22
Loss = 1.1050e-01, PNorm = 34.9400, GNorm = 1.6565, lr_0 = 3.4118e-04
Validation rmse = 0.144299
Validation mse = 0.020822
Validation r2 = 0.838411
Epoch 23
Loss = 1.2548e-01, PNorm = 34.9488, GNorm = 3.1818, lr_0 = 3.2781e-04
Validation rmse = 0.154888
Validation mse = 0.023990
Validation r2 = 0.813826
Epoch 24
Loss = 1.1789e-01, PNorm = 34.9596, GNorm = 5.7242, lr_0 = 3.1371e-04
Loss = 1.0790e-01, PNorm = 34.9679, GNorm = 2.1373, lr_0 = 3.0142e-04
Validation rmse = 0.139549
Validation mse = 0.019474
Validation r2 = 0.848874
Epoch 25
Loss = 9.7316e-02, PNorm = 34.9777, GNorm = 1.1720, lr_0 = 2.8960e-04
Validation rmse = 0.138455
Validation mse = 0.019170
Validation r2 = 0.851236
Epoch 26
Loss = 1.1737e-01, PNorm = 34.9886, GNorm = 3.2148, lr_0 = 2.7715e-04
Validation rmse = 0.140836
Validation mse = 0.019835
Validation r2 = 0.846075
Epoch 27
Loss = 1.0611e-01, PNorm = 34.9983, GNorm = 1.1173, lr_0 = 2.6522e-04
Validation rmse = 0.137683
Validation mse = 0.018957
Validation r2 = 0.852890
Epoch 28
Loss = 1.0816e-01, PNorm = 35.0072, GNorm = 2.0098, lr_0 = 2.5483e-04
Loss = 1.0894e-01, PNorm = 35.0154, GNorm = 3.9774, lr_0 = 2.4484e-04
Validation rmse = 0.140946
Validation mse = 0.019866
Validation r2 = 0.845833
Epoch 29
Loss = 1.1195e-01, PNorm = 35.0231, GNorm = 2.1607, lr_0 = 2.3431e-04
Validation rmse = 0.146067
Validation mse = 0.021336
Validation r2 = 0.834428
Epoch 30
Loss = 1.0950e-01, PNorm = 35.0305, GNorm = 3.0812, lr_0 = 2.2513e-04
Validation rmse = 0.140979
Validation mse = 0.019875
Validation r2 = 0.845761
Epoch 31
Loss = 1.0167e-01, PNorm = 35.0384, GNorm = 1.1644, lr_0 = 2.1544e-04
Validation rmse = 0.138586
Validation mse = 0.019206
Validation r2 = 0.850953
Epoch 32
Loss = 9.4067e-02, PNorm = 35.0452, GNorm = 0.9466, lr_0 = 2.0700e-04
Loss = 1.0125e-01, PNorm = 35.0508, GNorm = 0.7719, lr_0 = 1.9889e-04
Validation rmse = 0.139658
Validation mse = 0.019504
Validation r2 = 0.848640
Epoch 33
Loss = 1.0399e-01, PNorm = 35.0578, GNorm = 4.3158, lr_0 = 1.9033e-04
Validation rmse = 0.138324
Validation mse = 0.019133
Validation r2 = 0.851517
Epoch 34
Loss = 1.0558e-01, PNorm = 35.0633, GNorm = 3.1765, lr_0 = 1.8287e-04
Validation rmse = 0.147497
Validation mse = 0.021755
Validation r2 = 0.831170
Epoch 35
Loss = 1.1189e-01, PNorm = 35.0685, GNorm = 1.0367, lr_0 = 1.7501e-04
Validation rmse = 0.136910
Validation mse = 0.018744
Validation r2 = 0.854538
Epoch 36
Loss = 5.9269e-02, PNorm = 35.0736, GNorm = 0.8300, lr_0 = 1.6815e-04
Loss = 1.0753e-01, PNorm = 35.0791, GNorm = 2.6067, lr_0 = 1.6156e-04
Validation rmse = 0.143528
Validation mse = 0.020600
Validation r2 = 0.840133
Epoch 37
Loss = 1.0674e-01, PNorm = 35.0839, GNorm = 0.7111, lr_0 = 1.5461e-04
Validation rmse = 0.138238
Validation mse = 0.019110
Validation r2 = 0.851701
Epoch 38
Loss = 9.1538e-02, PNorm = 35.0881, GNorm = 0.6515, lr_0 = 1.4855e-04
Validation rmse = 0.136345
Validation mse = 0.018590
Validation r2 = 0.855736
Epoch 39
Loss = 8.4565e-02, PNorm = 35.0925, GNorm = 1.1420, lr_0 = 1.4216e-04
Validation rmse = 0.137909
Validation mse = 0.019019
Validation r2 = 0.852406
Epoch 40
Loss = 6.4707e-02, PNorm = 35.0969, GNorm = 0.7274, lr_0 = 1.3659e-04
Loss = 9.0566e-02, PNorm = 35.1002, GNorm = 0.6759, lr_0 = 1.3124e-04
Validation rmse = 0.137780
Validation mse = 0.018983
Validation r2 = 0.852682
Epoch 41
Loss = 9.1443e-02, PNorm = 35.1046, GNorm = 0.6764, lr_0 = 1.2559e-04
Validation rmse = 0.137635
Validation mse = 0.018943
Validation r2 = 0.852992
Epoch 42
Loss = 9.1873e-02, PNorm = 35.1093, GNorm = 1.4213, lr_0 = 1.2067e-04
Validation rmse = 0.136841
Validation mse = 0.018725
Validation r2 = 0.854683
Epoch 43
Loss = 9.1462e-02, PNorm = 35.1133, GNorm = 0.6769, lr_0 = 1.1548e-04
Validation rmse = 0.136412
Validation mse = 0.018608
Validation r2 = 0.855593
Epoch 44
Loss = 8.4333e-02, PNorm = 35.1163, GNorm = 1.2359, lr_0 = 1.1095e-04
Loss = 9.0075e-02, PNorm = 35.1194, GNorm = 1.2235, lr_0 = 1.0661e-04
Validation rmse = 0.136870
Validation mse = 0.018733
Validation r2 = 0.854621
Epoch 45
Loss = 8.1135e-02, PNorm = 35.1229, GNorm = 0.7833, lr_0 = 1.0202e-04
Validation rmse = 0.136766
Validation mse = 0.018705
Validation r2 = 0.854842
Epoch 46
Loss = 8.6336e-02, PNorm = 35.1257, GNorm = 1.0220, lr_0 = 1.0000e-04
Validation rmse = 0.140119
Validation mse = 0.019633
Validation r2 = 0.847638
Epoch 47
Loss = 9.4955e-02, PNorm = 35.1293, GNorm = 0.9151, lr_0 = 1.0000e-04
Validation rmse = 0.137741
Validation mse = 0.018973
Validation r2 = 0.852766
Epoch 48
Loss = 7.0122e-02, PNorm = 35.1326, GNorm = 1.0074, lr_0 = 1.0000e-04
Loss = 9.0002e-02, PNorm = 35.1354, GNorm = 2.5585, lr_0 = 1.0000e-04
Validation rmse = 0.136689
Validation mse = 0.018684
Validation r2 = 0.855006
Epoch 49
Loss = 8.2206e-02, PNorm = 35.1394, GNorm = 0.8591, lr_0 = 1.0000e-04
Validation rmse = 0.136148
Validation mse = 0.018536
Validation r2 = 0.856151
Model 0 best validation rmse = 0.136148 on epoch 49
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.119125
Model 0 test mse = 0.014191
Model 0 test r2 = 0.874616
Ensemble test rmse = 0.119125
Ensemble test mse = 0.014191
Ensemble test r2 = 0.874616
Fold 1
Splitting data with seed 1
Total size = 1,041 | train size = 624 | val size = 208 | test size = 209
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.8840e-01, PNorm = 34.0175, GNorm = 4.1991, lr_0 = 5.1250e-04
Validation rmse = 0.368372
Validation mse = 0.135698
Validation r2 = -0.025004
Epoch 1
Loss = 7.8152e-01, PNorm = 34.0573, GNorm = 3.9662, lr_0 = 9.2500e-04
Validation rmse = 0.278332
Validation mse = 0.077469
Validation r2 = 0.414837
Epoch 2
Loss = 6.0716e-01, PNorm = 34.1341, GNorm = 12.6576, lr_0 = 9.6466e-04
Validation rmse = 0.277083
Validation mse = 0.076775
Validation r2 = 0.420075
Epoch 3
Loss = 4.5887e-01, PNorm = 34.1991, GNorm = 1.0574, lr_0 = 9.2686e-04
Validation rmse = 0.255971
Validation mse = 0.065521
Validation r2 = 0.505082
Epoch 4
Loss = 4.4147e-01, PNorm = 34.2803, GNorm = 4.3826, lr_0 = 8.8699e-04
Loss = 3.3465e-01, PNorm = 34.3513, GNorm = 6.3425, lr_0 = 8.5223e-04
Validation rmse = 0.215980
Validation mse = 0.046647
Validation r2 = 0.647648
Epoch 5
Loss = 2.9258e-01, PNorm = 34.4072, GNorm = 1.5309, lr_0 = 8.1883e-04
Validation rmse = 0.191110
Validation mse = 0.036523
Validation r2 = 0.724122
Epoch 6
Loss = 2.5973e-01, PNorm = 34.4701, GNorm = 10.1055, lr_0 = 7.8361e-04
Validation rmse = 0.196404
Validation mse = 0.038575
Validation r2 = 0.708625
Epoch 7
Loss = 2.7066e-01, PNorm = 34.5145, GNorm = 2.1692, lr_0 = 7.5290e-04
Validation rmse = 0.177754
Validation mse = 0.031597
Validation r2 = 0.761333
Epoch 8
Loss = 2.5991e-01, PNorm = 34.5608, GNorm = 1.3239, lr_0 = 7.2051e-04
Loss = 1.8643e-01, PNorm = 34.6000, GNorm = 0.8073, lr_0 = 6.9227e-04
Validation rmse = 0.167390
Validation mse = 0.028019
Validation r2 = 0.788355
Epoch 9
Loss = 1.9683e-01, PNorm = 34.6325, GNorm = 7.8302, lr_0 = 6.6515e-04
Validation rmse = 0.159967
Validation mse = 0.025590
Validation r2 = 0.806708
Epoch 10
Loss = 1.6598e-01, PNorm = 34.6644, GNorm = 1.5159, lr_0 = 6.3653e-04
Validation rmse = 0.165587
Validation mse = 0.027419
Validation r2 = 0.792889
Epoch 11
Loss = 1.5669e-01, PNorm = 34.6921, GNorm = 0.8943, lr_0 = 6.1159e-04
Validation rmse = 0.187431
Validation mse = 0.035130
Validation r2 = 0.734640
Epoch 12
Loss = 2.1298e-01, PNorm = 34.7195, GNorm = 6.9911, lr_0 = 5.8528e-04
Loss = 1.5495e-01, PNorm = 34.7387, GNorm = 5.4453, lr_0 = 5.6234e-04
Validation rmse = 0.169381
Validation mse = 0.028690
Validation r2 = 0.783290
Epoch 13
Loss = 1.3953e-01, PNorm = 34.7605, GNorm = 2.9284, lr_0 = 5.4030e-04
Validation rmse = 0.146575
Validation mse = 0.021484
Validation r2 = 0.837718
Epoch 14
Loss = 1.2054e-01, PNorm = 34.7819, GNorm = 0.6641, lr_0 = 5.1706e-04
Validation rmse = 0.147750
Validation mse = 0.021830
Validation r2 = 0.835105
Epoch 15
Loss = 1.1106e-01, PNorm = 34.8001, GNorm = 0.7895, lr_0 = 4.9680e-04
Validation rmse = 0.148931
Validation mse = 0.022181
Validation r2 = 0.832458
Epoch 16
Loss = 9.6144e-02, PNorm = 34.8181, GNorm = 2.7236, lr_0 = 4.7543e-04
Loss = 1.2197e-01, PNorm = 34.8335, GNorm = 1.6477, lr_0 = 4.5680e-04
Validation rmse = 0.146382
Validation mse = 0.021428
Validation r2 = 0.838144
Epoch 17
Loss = 1.1883e-01, PNorm = 34.8468, GNorm = 1.1658, lr_0 = 4.3890e-04
Validation rmse = 0.147973
Validation mse = 0.021896
Validation r2 = 0.834607
Epoch 18
Loss = 1.1218e-01, PNorm = 34.8622, GNorm = 1.4967, lr_0 = 4.2001e-04
Validation rmse = 0.145769
Validation mse = 0.021249
Validation r2 = 0.839497
Epoch 19
Loss = 1.6037e-01, PNorm = 34.8739, GNorm = 6.6128, lr_0 = 4.0356e-04
Validation rmse = 0.146927
Validation mse = 0.021588
Validation r2 = 0.836937
Epoch 20
Loss = 1.1979e-01, PNorm = 34.8862, GNorm = 3.2650, lr_0 = 3.8619e-04
Loss = 1.1592e-01, PNorm = 34.8986, GNorm = 1.8385, lr_0 = 3.7106e-04
Validation rmse = 0.148643
Validation mse = 0.022095
Validation r2 = 0.833106
Epoch 21
Loss = 1.1371e-01, PNorm = 34.9088, GNorm = 4.4277, lr_0 = 3.5652e-04
Validation rmse = 0.141122
Validation mse = 0.019915
Validation r2 = 0.849568
Epoch 22
Loss = 1.1307e-01, PNorm = 34.9207, GNorm = 1.1373, lr_0 = 3.4118e-04
Validation rmse = 0.149687
Validation mse = 0.022406
Validation r2 = 0.830754
Epoch 23
Loss = 1.2397e-01, PNorm = 34.9298, GNorm = 4.1051, lr_0 = 3.2781e-04
Validation rmse = 0.146926
Validation mse = 0.021587
Validation r2 = 0.836940
Epoch 24
Loss = 1.6359e-01, PNorm = 34.9384, GNorm = 6.5557, lr_0 = 3.1371e-04
Loss = 1.2149e-01, PNorm = 34.9472, GNorm = 3.6048, lr_0 = 3.0142e-04
Validation rmse = 0.156173
Validation mse = 0.024390
Validation r2 = 0.815768
Epoch 25
Loss = 1.0395e-01, PNorm = 34.9575, GNorm = 2.4808, lr_0 = 2.8960e-04
Validation rmse = 0.139478
Validation mse = 0.019454
Validation r2 = 0.853053
Epoch 26
Loss = 9.8222e-02, PNorm = 34.9664, GNorm = 1.8655, lr_0 = 2.7715e-04
Validation rmse = 0.158854
Validation mse = 0.025235
Validation r2 = 0.809389
Epoch 27
Loss = 1.3505e-01, PNorm = 34.9735, GNorm = 3.0184, lr_0 = 2.6522e-04
Validation rmse = 0.137370
Validation mse = 0.018871
Validation r2 = 0.857460
Epoch 28
Loss = 7.8457e-02, PNorm = 34.9809, GNorm = 2.4492, lr_0 = 2.5483e-04
Loss = 1.0456e-01, PNorm = 34.9891, GNorm = 1.3185, lr_0 = 2.4484e-04
Validation rmse = 0.138646
Validation mse = 0.019223
Validation r2 = 0.854800
Epoch 29
Loss = 1.0426e-01, PNorm = 34.9958, GNorm = 0.6134, lr_0 = 2.3431e-04
Validation rmse = 0.146663
Validation mse = 0.021510
Validation r2 = 0.837522
Epoch 30
Loss = 1.1218e-01, PNorm = 35.0016, GNorm = 2.6476, lr_0 = 2.2513e-04
Validation rmse = 0.139847
Validation mse = 0.019557
Validation r2 = 0.852273
Epoch 31
Loss = 8.7527e-02, PNorm = 35.0095, GNorm = 2.1967, lr_0 = 2.1544e-04
Validation rmse = 0.138877
Validation mse = 0.019287
Validation r2 = 0.854316
Epoch 32
Loss = 1.2478e-01, PNorm = 35.0158, GNorm = 3.0704, lr_0 = 2.0700e-04
Loss = 9.7845e-02, PNorm = 35.0207, GNorm = 2.3566, lr_0 = 1.9889e-04
Validation rmse = 0.139137
Validation mse = 0.019359
Validation r2 = 0.853770
Epoch 33
Loss = 9.6658e-02, PNorm = 35.0273, GNorm = 1.3590, lr_0 = 1.9033e-04
Validation rmse = 0.137674
Validation mse = 0.018954
Validation r2 = 0.856830
Epoch 34
Loss = 9.4973e-02, PNorm = 35.0324, GNorm = 1.8794, lr_0 = 1.8287e-04
Validation rmse = 0.136655
Validation mse = 0.018675
Validation r2 = 0.858940
Epoch 35
Loss = 9.6106e-02, PNorm = 35.0377, GNorm = 1.9503, lr_0 = 1.7501e-04
Validation rmse = 0.136601
Validation mse = 0.018660
Validation r2 = 0.859051
Epoch 36
Loss = 1.1394e-01, PNorm = 35.0424, GNorm = 1.0852, lr_0 = 1.6815e-04
Loss = 8.8622e-02, PNorm = 35.0474, GNorm = 2.0060, lr_0 = 1.6156e-04
Validation rmse = 0.135861
Validation mse = 0.018458
Validation r2 = 0.860576
Epoch 37
Loss = 9.7595e-02, PNorm = 35.0513, GNorm = 1.6012, lr_0 = 1.5461e-04
Validation rmse = 0.136509
Validation mse = 0.018635
Validation r2 = 0.859242
Epoch 38
Loss = 9.4613e-02, PNorm = 35.0563, GNorm = 5.1178, lr_0 = 1.4855e-04
Validation rmse = 0.135780
Validation mse = 0.018436
Validation r2 = 0.860740
Epoch 39
Loss = 1.1107e-01, PNorm = 35.0614, GNorm = 4.6575, lr_0 = 1.4216e-04
Validation rmse = 0.136484
Validation mse = 0.018628
Validation r2 = 0.859293
Epoch 40
Loss = 1.2246e-01, PNorm = 35.0642, GNorm = 3.0004, lr_0 = 1.3659e-04
Loss = 8.5462e-02, PNorm = 35.0687, GNorm = 2.1391, lr_0 = 1.3124e-04
Validation rmse = 0.135878
Validation mse = 0.018463
Validation r2 = 0.860541
Epoch 41
Loss = 8.8804e-02, PNorm = 35.0730, GNorm = 1.6330, lr_0 = 1.2559e-04
Validation rmse = 0.135286
Validation mse = 0.018302
Validation r2 = 0.861753
Epoch 42
Loss = 8.0689e-02, PNorm = 35.0761, GNorm = 1.9292, lr_0 = 1.2067e-04
Validation rmse = 0.137426
Validation mse = 0.018886
Validation r2 = 0.857344
Epoch 43
Loss = 8.0618e-02, PNorm = 35.0796, GNorm = 0.3829, lr_0 = 1.1548e-04
Validation rmse = 0.141038
Validation mse = 0.019892
Validation r2 = 0.849747
Epoch 44
Loss = 7.8522e-02, PNorm = 35.0832, GNorm = 1.1014, lr_0 = 1.1095e-04
Loss = 8.9077e-02, PNorm = 35.0864, GNorm = 1.2823, lr_0 = 1.0661e-04
Validation rmse = 0.139921
Validation mse = 0.019578
Validation r2 = 0.852117
Epoch 45
Loss = 8.3660e-02, PNorm = 35.0891, GNorm = 1.6026, lr_0 = 1.0202e-04
Validation rmse = 0.135495
Validation mse = 0.018359
Validation r2 = 0.861326
Epoch 46
Loss = 8.4285e-02, PNorm = 35.0922, GNorm = 2.2464, lr_0 = 1.0000e-04
Validation rmse = 0.138869
Validation mse = 0.019285
Validation r2 = 0.854333
Epoch 47
Loss = 8.6302e-02, PNorm = 35.0956, GNorm = 0.7934, lr_0 = 1.0000e-04
Validation rmse = 0.135782
Validation mse = 0.018437
Validation r2 = 0.860736
Epoch 48
Loss = 1.4009e-01, PNorm = 35.0982, GNorm = 1.1951, lr_0 = 1.0000e-04
Loss = 8.4916e-02, PNorm = 35.1016, GNorm = 0.7197, lr_0 = 1.0000e-04
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-9aa06278-3f02-46f3-a9f8-3e50b1e24e6f.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_final.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['mse', 'r2'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'mse', 'r2'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/_final/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.6, 0.2, 0.2],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,041 | train size = 624 | val size = 208 | test size = 209
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.8662e-01, PNorm = 43.2627, GNorm = 2.9282, lr_0 = 5.1250e-04
Validation rmse = 0.317521
Validation mse = 0.100819
Validation r2 = 0.217604
Epoch 1
Loss = 7.3697e-01, PNorm = 43.2988, GNorm = 2.7664, lr_0 = 9.2500e-04
Validation rmse = 0.355090
Validation mse = 0.126089
Validation r2 = 0.021503
Epoch 2
Loss = 8.4845e-01, PNorm = 43.3701, GNorm = 8.4588, lr_0 = 9.7066e-04
Validation rmse = 0.289505
Validation mse = 0.083813
Validation r2 = 0.349580
Epoch 3
Loss = 6.5582e-01, PNorm = 43.4407, GNorm = 1.5317, lr_0 = 9.3908e-04
Validation rmse = 0.228449
Validation mse = 0.052189
Validation r2 = 0.594995
Epoch 4
Loss = 3.0281e-01, PNorm = 43.5246, GNorm = 1.8703, lr_0 = 9.0552e-04
Loss = 3.9648e-01, PNorm = 43.5982, GNorm = 1.8090, lr_0 = 8.7605e-04
Validation rmse = 0.222411
Validation mse = 0.049467
Validation r2 = 0.616120
Epoch 5
Loss = 3.1519e-01, PNorm = 43.6618, GNorm = 6.0317, lr_0 = 8.4754e-04
Validation rmse = 0.236415
Validation mse = 0.055892
Validation r2 = 0.566257
Epoch 6
Loss = 3.0501e-01, PNorm = 43.7259, GNorm = 1.1752, lr_0 = 8.1725e-04
Validation rmse = 0.190720
Validation mse = 0.036374
Validation r2 = 0.717724
Epoch 7
Loss = 2.6702e-01, PNorm = 43.7774, GNorm = 1.6736, lr_0 = 7.9066e-04
Validation rmse = 0.191244
Validation mse = 0.036574
Validation r2 = 0.716170
Epoch 8
Loss = 2.1040e-01, PNorm = 43.8233, GNorm = 3.4660, lr_0 = 7.6240e-04
Loss = 2.1659e-01, PNorm = 43.8680, GNorm = 2.1407, lr_0 = 7.3759e-04
Validation rmse = 0.164677
Validation mse = 0.027119
Validation r2 = 0.789549
Epoch 9
Loss = 1.7656e-01, PNorm = 43.9026, GNorm = 1.9331, lr_0 = 7.1359e-04
Validation rmse = 0.165227
Validation mse = 0.027300
Validation r2 = 0.788142
Epoch 10
Loss = 1.7261e-01, PNorm = 43.9360, GNorm = 2.8701, lr_0 = 6.8809e-04
Validation rmse = 0.151002
Validation mse = 0.022801
Validation r2 = 0.823052
Epoch 11
Loss = 1.6380e-01, PNorm = 43.9642, GNorm = 0.6979, lr_0 = 6.6570e-04
Validation rmse = 0.167985
Validation mse = 0.028219
Validation r2 = 0.781012
Epoch 12
Loss = 1.5706e-01, PNorm = 43.9925, GNorm = 2.3613, lr_0 = 6.4191e-04
Loss = 1.3935e-01, PNorm = 44.0135, GNorm = 2.6229, lr_0 = 6.2102e-04
Validation rmse = 0.159621
Validation mse = 0.025479
Validation r2 = 0.802274
Epoch 13
Loss = 1.4070e-01, PNorm = 44.0287, GNorm = 2.9063, lr_0 = 6.0081e-04
Validation rmse = 0.150804
Validation mse = 0.022742
Validation r2 = 0.823516
Epoch 14
Loss = 1.4743e-01, PNorm = 44.0496, GNorm = 2.9530, lr_0 = 5.7934e-04
Validation rmse = 0.167209
Validation mse = 0.027959
Validation r2 = 0.783029
Epoch 15
Loss = 1.3144e-01, PNorm = 44.0698, GNorm = 3.2148, lr_0 = 5.6048e-04
Validation rmse = 0.151199
Validation mse = 0.022861
Validation r2 = 0.822590
Epoch 16
Loss = 1.7541e-01, PNorm = 44.0940, GNorm = 4.7959, lr_0 = 5.4045e-04
Loss = 1.5187e-01, PNorm = 44.1142, GNorm = 6.5837, lr_0 = 5.2287e-04
Validation rmse = 0.147796
Validation mse = 0.021844
Validation r2 = 0.830485
Epoch 17
Loss = 1.3109e-01, PNorm = 44.1293, GNorm = 2.4475, lr_0 = 5.0585e-04
Validation rmse = 0.147602
Validation mse = 0.021786
Validation r2 = 0.830931
Epoch 18
Loss = 1.0432e-01, PNorm = 44.1486, GNorm = 3.0631, lr_0 = 4.8777e-04
Validation rmse = 0.144861
Validation mse = 0.020985
Validation r2 = 0.837151
Epoch 19
Loss = 1.1817e-01, PNorm = 44.1613, GNorm = 0.8113, lr_0 = 4.7190e-04
Validation rmse = 0.151019
Validation mse = 0.022807
Validation r2 = 0.823011
Epoch 20
Loss = 1.4352e-01, PNorm = 44.1768, GNorm = 5.0711, lr_0 = 4.5504e-04
Loss = 1.0972e-01, PNorm = 44.1936, GNorm = 1.0947, lr_0 = 4.4023e-04
Validation rmse = 0.144402
Validation mse = 0.020852
Validation r2 = 0.838181
Epoch 21
Loss = 1.0076e-01, PNorm = 44.2016, GNorm = 0.9659, lr_0 = 4.2590e-04
Validation rmse = 0.139780
Validation mse = 0.019538
Validation r2 = 0.848375
Epoch 22
Loss = 9.5471e-02, PNorm = 44.2130, GNorm = 0.8729, lr_0 = 4.1068e-04
Validation rmse = 0.142540
Validation mse = 0.020318
Validation r2 = 0.842328
Epoch 23
Loss = 9.9259e-02, PNorm = 44.2240, GNorm = 2.3966, lr_0 = 3.9732e-04
Validation rmse = 0.153334
Validation mse = 0.023511
Validation r2 = 0.817543
Epoch 24
Loss = 8.6649e-02, PNorm = 44.2367, GNorm = 3.4322, lr_0 = 3.8312e-04
Loss = 1.0030e-01, PNorm = 44.2450, GNorm = 2.0239, lr_0 = 3.7065e-04
Validation rmse = 0.143250
Validation mse = 0.020521
Validation r2 = 0.840753
Epoch 25
Loss = 9.1069e-02, PNorm = 44.2567, GNorm = 1.1672, lr_0 = 3.5859e-04
Validation rmse = 0.141920
Validation mse = 0.020141
Validation r2 = 0.843696
Epoch 26
Loss = 1.0313e-01, PNorm = 44.2684, GNorm = 1.3669, lr_0 = 3.4577e-04
Validation rmse = 0.139719
Validation mse = 0.019521
Validation r2 = 0.848508
Epoch 27
Loss = 8.8784e-02, PNorm = 44.2824, GNorm = 0.9957, lr_0 = 3.3342e-04
Validation rmse = 0.141002
Validation mse = 0.019882
Validation r2 = 0.845711
Epoch 28
Loss = 1.0090e-01, PNorm = 44.2924, GNorm = 1.0013, lr_0 = 3.2257e-04
Loss = 9.7782e-02, PNorm = 44.3023, GNorm = 3.3488, lr_0 = 3.1207e-04
Validation rmse = 0.150832
Validation mse = 0.022750
Validation r2 = 0.823449
Epoch 29
Loss = 1.0961e-01, PNorm = 44.3129, GNorm = 3.3579, lr_0 = 3.0092e-04
Validation rmse = 0.159842
Validation mse = 0.025549
Validation r2 = 0.801727
Epoch 30
Loss = 1.1403e-01, PNorm = 44.3220, GNorm = 2.8404, lr_0 = 2.9113e-04
Validation rmse = 0.151470
Validation mse = 0.022943
Validation r2 = 0.821953
Epoch 31
Loss = 9.8733e-02, PNorm = 44.3354, GNorm = 0.9980, lr_0 = 2.8072e-04
Validation rmse = 0.143184
Validation mse = 0.020502
Validation r2 = 0.840900
Epoch 32
Loss = 8.2107e-02, PNorm = 44.3457, GNorm = 1.0282, lr_0 = 2.7159e-04
Loss = 9.0025e-02, PNorm = 44.3554, GNorm = 0.6338, lr_0 = 2.6275e-04
Validation rmse = 0.142779
Validation mse = 0.020386
Validation r2 = 0.841798
Epoch 33
Loss = 9.0547e-02, PNorm = 44.3655, GNorm = 3.6241, lr_0 = 2.5336e-04
Validation rmse = 0.138607
Validation mse = 0.019212
Validation r2 = 0.850908
Epoch 34
Loss = 8.4574e-02, PNorm = 44.3725, GNorm = 1.9564, lr_0 = 2.4511e-04
Validation rmse = 0.158149
Validation mse = 0.025011
Validation r2 = 0.805904
Epoch 35
Loss = 9.7225e-02, PNorm = 44.3791, GNorm = 1.1125, lr_0 = 2.3635e-04
Validation rmse = 0.143101
Validation mse = 0.020478
Validation r2 = 0.841083
Epoch 36
Loss = 7.2748e-02, PNorm = 44.3875, GNorm = 2.3700, lr_0 = 2.2866e-04
Loss = 9.7097e-02, PNorm = 44.3957, GNorm = 0.7411, lr_0 = 2.2122e-04
Validation rmse = 0.146882
Validation mse = 0.021574
Validation r2 = 0.832576
Epoch 37
Loss = 8.5501e-02, PNorm = 44.4031, GNorm = 1.4723, lr_0 = 2.1332e-04
Validation rmse = 0.140168
Validation mse = 0.019647
Validation r2 = 0.847532
Epoch 38
Loss = 7.8070e-02, PNorm = 44.4105, GNorm = 0.8547, lr_0 = 2.0637e-04
Validation rmse = 0.142106
Validation mse = 0.020194
Validation r2 = 0.843286
Epoch 39
Loss = 7.4876e-02, PNorm = 44.4174, GNorm = 1.2487, lr_0 = 1.9900e-04
Validation rmse = 0.139738
Validation mse = 0.019527
Validation r2 = 0.848465
Epoch 40
Loss = 5.5294e-02, PNorm = 44.4239, GNorm = 1.0758, lr_0 = 1.9252e-04
Loss = 7.2815e-02, PNorm = 44.4291, GNorm = 0.6874, lr_0 = 1.8626e-04
Validation rmse = 0.141783
Validation mse = 0.020102
Validation r2 = 0.843997
Epoch 41
Loss = 7.3674e-02, PNorm = 44.4369, GNorm = 0.6290, lr_0 = 1.7960e-04
Validation rmse = 0.138799
Validation mse = 0.019265
Validation r2 = 0.850495
Epoch 42
Loss = 7.1911e-02, PNorm = 44.4438, GNorm = 0.4630, lr_0 = 1.7376e-04
Validation rmse = 0.139501
Validation mse = 0.019461
Validation r2 = 0.848979
Epoch 43
Loss = 7.0873e-02, PNorm = 44.4495, GNorm = 1.2061, lr_0 = 1.6755e-04
Validation rmse = 0.142924
Validation mse = 0.020427
Validation r2 = 0.841476
Epoch 44
Loss = 7.9727e-02, PNorm = 44.4548, GNorm = 1.0352, lr_0 = 1.6210e-04
Loss = 7.0556e-02, PNorm = 44.4594, GNorm = 0.6915, lr_0 = 1.5682e-04
Validation rmse = 0.139600
Validation mse = 0.019488
Validation r2 = 0.848765
Epoch 45
Loss = 6.7313e-02, PNorm = 44.4656, GNorm = 0.8285, lr_0 = 1.5122e-04
Validation rmse = 0.139086
Validation mse = 0.019345
Validation r2 = 0.849876
Epoch 46
Loss = 6.4971e-02, PNorm = 44.4709, GNorm = 0.7236, lr_0 = 1.4630e-04
Validation rmse = 0.141470
Validation mse = 0.020014
Validation r2 = 0.844686
Epoch 47
Loss = 7.4095e-02, PNorm = 44.4765, GNorm = 1.8325, lr_0 = 1.4107e-04
Validation rmse = 0.139200
Validation mse = 0.019377
Validation r2 = 0.849630
Epoch 48
Loss = 5.7759e-02, PNorm = 44.4810, GNorm = 0.5236, lr_0 = 1.3648e-04
Loss = 7.0140e-02, PNorm = 44.4860, GNorm = 1.7457, lr_0 = 1.3204e-04
Validation rmse = 0.140948
Validation mse = 0.019866
Validation r2 = 0.845829
Epoch 49
Loss = 6.6048e-02, PNorm = 44.4916, GNorm = 0.7551, lr_0 = 1.2732e-04
Validation rmse = 0.138370
Validation mse = 0.019146
Validation r2 = 0.851418
Epoch 50
Loss = 6.3683e-02, PNorm = 44.4965, GNorm = 2.0864, lr_0 = 1.2317e-04
Validation rmse = 0.140017
Validation mse = 0.019605
Validation r2 = 0.847860
Epoch 51
Loss = 6.0046e-02, PNorm = 44.5011, GNorm = 0.8569, lr_0 = 1.1877e-04
Validation rmse = 0.140787
Validation mse = 0.019821
Validation r2 = 0.846182
Epoch 52
Loss = 6.7169e-02, PNorm = 44.5052, GNorm = 0.8926, lr_0 = 1.1453e-04
Loss = 6.2938e-02, PNorm = 44.5093, GNorm = 1.5080, lr_0 = 1.1080e-04
Validation rmse = 0.141773
Validation mse = 0.020100
Validation r2 = 0.844019
Epoch 53
Loss = 6.4163e-02, PNorm = 44.5133, GNorm = 2.5310, lr_0 = 1.0719e-04
Validation rmse = 0.141784
Validation mse = 0.020103
Validation r2 = 0.843995
Epoch 54
Loss = 5.9695e-02, PNorm = 44.5172, GNorm = 0.8149, lr_0 = 1.0336e-04
Validation rmse = 0.140854
Validation mse = 0.019840
Validation r2 = 0.846036
Epoch 55
Loss = 6.6051e-02, PNorm = 44.5211, GNorm = 0.7567, lr_0 = 1.0000e-04
Validation rmse = 0.141074
Validation mse = 0.019902
Validation r2 = 0.845555
Epoch 56
Loss = 4.3739e-02, PNorm = 44.5255, GNorm = 0.5494, lr_0 = 1.0000e-04
Loss = 6.5847e-02, PNorm = 44.5291, GNorm = 1.2800, lr_0 = 1.0000e-04
Validation rmse = 0.140209
Validation mse = 0.019659
Validation r2 = 0.847442
Epoch 57
Loss = 6.4313e-02, PNorm = 44.5325, GNorm = 1.3642, lr_0 = 1.0000e-04
Validation rmse = 0.141076
Validation mse = 0.019902
Validation r2 = 0.845551
Epoch 58
Loss = 5.9633e-02, PNorm = 44.5374, GNorm = 1.2358, lr_0 = 1.0000e-04
Validation rmse = 0.139828
Validation mse = 0.019552
Validation r2 = 0.848271
Epoch 59
Loss = 5.8781e-02, PNorm = 44.5408, GNorm = 0.6283, lr_0 = 1.0000e-04
Validation rmse = 0.141414
Validation mse = 0.019998
Validation r2 = 0.844809
Model 0 best validation rmse = 0.138370 on epoch 49
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.119842
Model 0 test mse = 0.014362
Model 0 test r2 = 0.873101
Ensemble test rmse = 0.119842
Ensemble test mse = 0.014362
Ensemble test r2 = 0.873101
Fold 1
Splitting data with seed 1
Total size = 1,041 | train size = 624 | val size = 208 | test size = 209
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.9974e-01, PNorm = 43.2641, GNorm = 1.6888, lr_0 = 5.1250e-04
Validation rmse = 0.405763
Validation mse = 0.164643
Validation r2 = -0.243642
Epoch 1
Loss = 8.7430e-01, PNorm = 43.2988, GNorm = 5.0770, lr_0 = 9.2500e-04
Validation rmse = 0.302701
Validation mse = 0.091628
Validation r2 = 0.307886
Epoch 2
Loss = 6.3216e-01, PNorm = 43.3758, GNorm = 7.4933, lr_0 = 9.7066e-04
Validation rmse = 0.267329
Validation mse = 0.071465
Validation r2 = 0.460189
Epoch 3
Loss = 4.6586e-01, PNorm = 43.4620, GNorm = 5.1690, lr_0 = 9.3908e-04
Validation rmse = 0.218416
Validation mse = 0.047706
Validation r2 = 0.639654
Epoch 4
Loss = 2.7646e-01, PNorm = 43.5605, GNorm = 1.3708, lr_0 = 9.0552e-04
Loss = 3.9557e-01, PNorm = 43.6311, GNorm = 10.3305, lr_0 = 8.7605e-04
Validation rmse = 0.281487
Validation mse = 0.079235
Validation r2 = 0.401493
Epoch 5
Loss = 3.1752e-01, PNorm = 43.6950, GNorm = 4.9576, lr_0 = 8.4754e-04
Validation rmse = 0.196321
Validation mse = 0.038542
Validation r2 = 0.708872
Epoch 6
Loss = 2.0954e-01, PNorm = 43.7581, GNorm = 5.8978, lr_0 = 8.1725e-04
Validation rmse = 0.183609
Validation mse = 0.033712
Validation r2 = 0.745352
Epoch 7
Loss = 2.3076e-01, PNorm = 43.8081, GNorm = 4.9558, lr_0 = 7.9066e-04
Validation rmse = 0.160675
Validation mse = 0.025817
Validation r2 = 0.804993
Epoch 8
Loss = 2.4211e-01, PNorm = 43.8519, GNorm = 2.1187, lr_0 = 7.6240e-04
Loss = 1.6229e-01, PNorm = 43.8851, GNorm = 0.6172, lr_0 = 7.3759e-04
Validation rmse = 0.156909
Validation mse = 0.024620
Validation r2 = 0.814029
Epoch 9
Loss = 1.6222e-01, PNorm = 43.9164, GNorm = 6.0688, lr_0 = 7.1359e-04
Validation rmse = 0.154836
Validation mse = 0.023974
Validation r2 = 0.818910
Epoch 10
Loss = 1.4347e-01, PNorm = 43.9438, GNorm = 2.0107, lr_0 = 6.8809e-04
Validation rmse = 0.162384
Validation mse = 0.026369
Validation r2 = 0.800823
Epoch 11
Loss = 1.3709e-01, PNorm = 43.9667, GNorm = 1.0564, lr_0 = 6.6570e-04
Validation rmse = 0.176405
Validation mse = 0.031119
Validation r2 = 0.764943
Epoch 12
Loss = 1.8775e-01, PNorm = 43.9888, GNorm = 4.8579, lr_0 = 6.4191e-04
Loss = 1.4515e-01, PNorm = 44.0095, GNorm = 6.1937, lr_0 = 6.2102e-04
Validation rmse = 0.167950
Validation mse = 0.028207
Validation r2 = 0.786937
Epoch 13
Loss = 1.2661e-01, PNorm = 44.0303, GNorm = 2.0064, lr_0 = 6.0081e-04
Validation rmse = 0.142116
Validation mse = 0.020197
Validation r2 = 0.847441
Epoch 14
Loss = 1.1212e-01, PNorm = 44.0528, GNorm = 0.7362, lr_0 = 5.7934e-04
Validation rmse = 0.143685
Validation mse = 0.020645
Validation r2 = 0.844055
Epoch 15
Loss = 9.9123e-02, PNorm = 44.0686, GNorm = 1.1838, lr_0 = 5.6048e-04
Validation rmse = 0.144325
Validation mse = 0.020830
Validation r2 = 0.842661
Epoch 16
Loss = 8.0983e-02, PNorm = 44.0837, GNorm = 2.0218, lr_0 = 5.4045e-04
Loss = 1.1114e-01, PNorm = 44.0999, GNorm = 1.6131, lr_0 = 5.2287e-04
Validation rmse = 0.143559
Validation mse = 0.020609
Validation r2 = 0.844327
Epoch 17
Loss = 1.0965e-01, PNorm = 44.1114, GNorm = 1.0677, lr_0 = 5.0585e-04
Validation rmse = 0.143791
Validation mse = 0.020676
Validation r2 = 0.843825
Epoch 18
Loss = 1.0604e-01, PNorm = 44.1264, GNorm = 0.8577, lr_0 = 4.8777e-04
Validation rmse = 0.138491
Validation mse = 0.019180
Validation r2 = 0.855126
Epoch 19
Loss = 1.2746e-01, PNorm = 44.1407, GNorm = 3.7610, lr_0 = 4.7190e-04
Validation rmse = 0.141587
Validation mse = 0.020047
Validation r2 = 0.848574
Epoch 20
Loss = 9.5928e-02, PNorm = 44.1537, GNorm = 1.2884, lr_0 = 4.5504e-04
Loss = 9.8914e-02, PNorm = 44.1683, GNorm = 0.8714, lr_0 = 4.4023e-04
Validation rmse = 0.140341
Validation mse = 0.019695
Validation r2 = 0.851229
Epoch 21
Loss = 9.2524e-02, PNorm = 44.1774, GNorm = 2.3027, lr_0 = 4.2590e-04
Validation rmse = 0.138736
Validation mse = 0.019248
Validation r2 = 0.854611
Epoch 22
Loss = 9.6739e-02, PNorm = 44.1930, GNorm = 0.9728, lr_0 = 4.1068e-04
Validation rmse = 0.134801
Validation mse = 0.018171
Validation r2 = 0.862741
Epoch 23
Loss = 1.0824e-01, PNorm = 44.2035, GNorm = 2.9698, lr_0 = 3.9732e-04
Validation rmse = 0.142827
Validation mse = 0.020400
Validation r2 = 0.845911
Epoch 24
Loss = 1.1240e-01, PNorm = 44.2178, GNorm = 4.3051, lr_0 = 3.8312e-04
Loss = 1.0617e-01, PNorm = 44.2294, GNorm = 0.8351, lr_0 = 3.7065e-04
Validation rmse = 0.137171
Validation mse = 0.018816
Validation r2 = 0.857873
Epoch 25
Loss = 1.0042e-01, PNorm = 44.2423, GNorm = 3.8295, lr_0 = 3.5859e-04
Validation rmse = 0.148363
Validation mse = 0.022011
Validation r2 = 0.833735
Epoch 26
Loss = 9.0783e-02, PNorm = 44.2544, GNorm = 1.3672, lr_0 = 3.4577e-04
Validation rmse = 0.138849
Validation mse = 0.019279
Validation r2 = 0.854374
Epoch 27
Loss = 1.0171e-01, PNorm = 44.2665, GNorm = 3.6474, lr_0 = 3.3342e-04
Validation rmse = 0.134270
Validation mse = 0.018029
Validation r2 = 0.863820
Epoch 28
Loss = 7.2649e-02, PNorm = 44.2784, GNorm = 2.6370, lr_0 = 3.2257e-04
Loss = 8.7447e-02, PNorm = 44.2890, GNorm = 1.5439, lr_0 = 3.1207e-04
Validation rmse = 0.134546
Validation mse = 0.018103
Validation r2 = 0.863262
Epoch 29
Loss = 8.9471e-02, PNorm = 44.2979, GNorm = 0.6342, lr_0 = 3.0092e-04
Validation rmse = 0.143010
Validation mse = 0.020452
Validation r2 = 0.845515
Epoch 30
Loss = 9.5447e-02, PNorm = 44.3061, GNorm = 2.6159, lr_0 = 2.9113e-04
Validation rmse = 0.133363
Validation mse = 0.017786
Validation r2 = 0.865654
Epoch 31
Loss = 7.8169e-02, PNorm = 44.3182, GNorm = 0.6707, lr_0 = 2.8072e-04
Validation rmse = 0.132233
Validation mse = 0.017485
Validation r2 = 0.867923
Epoch 32
Loss = 8.9761e-02, PNorm = 44.3278, GNorm = 0.9185, lr_0 = 2.7159e-04
Loss = 7.7918e-02, PNorm = 44.3346, GNorm = 1.5126, lr_0 = 2.6275e-04
Validation rmse = 0.137168
Validation mse = 0.018815
Validation r2 = 0.857880
Epoch 33
Loss = 7.9014e-02, PNorm = 44.3448, GNorm = 0.5064, lr_0 = 2.5336e-04
Validation rmse = 0.132767
Validation mse = 0.017627
Validation r2 = 0.866854
Epoch 34
Loss = 7.9434e-02, PNorm = 44.3518, GNorm = 1.6945, lr_0 = 2.4511e-04
Validation rmse = 0.130514
Validation mse = 0.017034
Validation r2 = 0.871333
Epoch 35
Loss = 7.1589e-02, PNorm = 44.3612, GNorm = 1.0613, lr_0 = 2.3635e-04
Validation rmse = 0.131300
Validation mse = 0.017240
Validation r2 = 0.869778
Epoch 36
Loss = 9.5984e-02, PNorm = 44.3687, GNorm = 0.6972, lr_0 = 2.2866e-04
Loss = 7.3701e-02, PNorm = 44.3771, GNorm = 2.0599, lr_0 = 2.2122e-04
Validation rmse = 0.129361
Validation mse = 0.016734
Validation r2 = 0.873596
Epoch 37
Loss = 8.6534e-02, PNorm = 44.3832, GNorm = 0.7395, lr_0 = 2.1332e-04
Validation rmse = 0.130216
Validation mse = 0.016956
Validation r2 = 0.871920
Epoch 38
Loss = 7.5216e-02, PNorm = 44.3915, GNorm = 2.8984, lr_0 = 2.0637e-04
Validation rmse = 0.151288
Validation mse = 0.022888
Validation r2 = 0.827113
Epoch 39
Loss = 1.0650e-01, PNorm = 44.4004, GNorm = 2.1651, lr_0 = 1.9900e-04
Validation rmse = 0.130928
Validation mse = 0.017142
Validation r2 = 0.870516
Epoch 40
Loss = 9.1995e-02, PNorm = 44.4077, GNorm = 2.3278, lr_0 = 1.9252e-04
Loss = 6.9759e-02, PNorm = 44.4156, GNorm = 2.0960, lr_0 = 1.8626e-04
Validation rmse = 0.130988
Validation mse = 0.017158
Validation r2 = 0.870397
Epoch 41
Loss = 7.4553e-02, PNorm = 44.4226, GNorm = 0.8442, lr_0 = 1.7960e-04
Validation rmse = 0.129742
Validation mse = 0.016833
Validation r2 = 0.872852
Epoch 42
Loss = 6.3980e-02, PNorm = 44.4278, GNorm = 2.1556, lr_0 = 1.7376e-04
Validation rmse = 0.130083
Validation mse = 0.016921
Validation r2 = 0.872183
Epoch 43
Loss = 6.7640e-02, PNorm = 44.4343, GNorm = 0.9086, lr_0 = 1.6755e-04
Validation rmse = 0.131534
Validation mse = 0.017301
Validation r2 = 0.869314
Epoch 44
Loss = 5.7547e-02, PNorm = 44.4397, GNorm = 0.6689, lr_0 = 1.6210e-04
Loss = 6.9796e-02, PNorm = 44.4458, GNorm = 0.8692, lr_0 = 1.5682e-04
Validation rmse = 0.130546
Validation mse = 0.017042
Validation r2 = 0.871271
Epoch 45
Loss = 6.3171e-02, PNorm = 44.4512, GNorm = 1.0606, lr_0 = 1.5122e-04
Validation rmse = 0.129735
Validation mse = 0.016831
Validation r2 = 0.872865
Epoch 46
Loss = 6.5491e-02, PNorm = 44.4570, GNorm = 0.9854, lr_0 = 1.4630e-04
Validation rmse = 0.133253
Validation mse = 0.017756
Validation r2 = 0.865876
Epoch 47
Loss = 6.9700e-02, PNorm = 44.4631, GNorm = 1.1138, lr_0 = 1.4107e-04
Validation rmse = 0.129322
Validation mse = 0.016724
Validation r2 = 0.873674
Epoch 48
Loss = 1.1089e-01, PNorm = 44.4685, GNorm = 0.7669, lr_0 = 1.3648e-04
Loss = 6.8054e-02, PNorm = 44.4745, GNorm = 0.5211, lr_0 = 1.3204e-04
Validation rmse = 0.128248
Validation mse = 0.016448
Validation r2 = 0.875762
Epoch 49
Loss = 6.7269e-02, PNorm = 44.4804, GNorm = 0.5101, lr_0 = 1.2732e-04
Validation rmse = 0.128108
Validation mse = 0.016412
Validation r2 = 0.876033
Epoch 50
Loss = 6.1115e-02, PNorm = 44.4854, GNorm = 0.8085, lr_0 = 1.2317e-04
Validation rmse = 0.128270
Validation mse = 0.016453
Validation r2 = 0.875720
Epoch 51
Loss = 5.8027e-02, PNorm = 44.4898, GNorm = 1.2282, lr_0 = 1.1877e-04
Validation rmse = 0.131825
Validation mse = 0.017378
Validation r2 = 0.868736
Epoch 52
Loss = 7.4059e-02, PNorm = 44.4951, GNorm = 2.5157, lr_0 = 1.1453e-04
Loss = 7.0675e-02, PNorm = 44.4994, GNorm = 1.4263, lr_0 = 1.1080e-04
Validation rmse = 0.132102
Validation mse = 0.017451
Validation r2 = 0.868184
Epoch 53
Loss = 5.9861e-02, PNorm = 44.5037, GNorm = 0.8940, lr_0 = 1.0719e-04
Validation rmse = 0.127872
Validation mse = 0.016351
Validation r2 = 0.876490
Epoch 54
Loss = 6.3736e-02, PNorm = 44.5082, GNorm = 0.6339, lr_0 = 1.0336e-04
Validation rmse = 0.129457
Validation mse = 0.016759
Validation r2 = 0.873409
Epoch 55
Loss = 5.5869e-02, PNorm = 44.5119, GNorm = 0.6214, lr_0 = 1.0000e-04
Validation rmse = 0.130621
Validation mse = 0.017062
Validation r2 = 0.871123
Epoch 56
Loss = 7.7178e-02, PNorm = 44.5160, GNorm = 0.8377, lr_0 = 1.0000e-04
Loss = 5.8117e-02, PNorm = 44.5203, GNorm = 1.0918, lr_0 = 1.0000e-04
Validation rmse = 0.131678
Validation mse = 0.017339
Validation r2 = 0.869028
Epoch 57
Loss = 5.8499e-02, PNorm = 44.5248, GNorm = 0.5365, lr_0 = 1.0000e-04
Validation rmse = 0.131998
Validation mse = 0.017424
Validation r2 = 0.868390
Epoch 58
Loss = 5.8726e-02, PNorm = 44.5288, GNorm = 0.8720, lr_0 = 1.0000e-04
Validation rmse = 0.129105
Validation mse = 0.016668
Validation r2 = 0.874096
Epoch 59
Loss = 5.7868e-02, PNorm = 44.5330, GNorm = 1.6837, lr_0 = 1.0000e-04
Validation rmse = 0.128036
Validation mse = 0.016393
Validation r2 = 0.876172
Model 0 best validation rmse = 0.127872 on epoch 53
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.122419
Model 0 test mse = 0.014986
Model 0 test r2 = 0.854128
Ensemble test rmse = 0.122419
Ensemble test mse = 0.014986
Ensemble test r2 = 0.854128
Fold 2
Splitting data with seed 2
Total size = 1,041 | train size = 624 | val size = 208 | test size = 209
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 8.9186e-01, PNorm = 43.2668, GNorm = 2.2246, lr_0 = 5.1250e-04
Validation rmse = 0.302176
Validation mse = 0.091310
Validation r2 = 0.282957
Epoch 1
Loss = 7.9170e-01, PNorm = 43.3031, GNorm = 5.9145, lr_0 = 9.2500e-04
Validation rmse = 0.338871
Validation mse = 0.114833
Validation r2 = 0.098234
Epoch 2
Loss = 6.2389e-01, PNorm = 43.3655, GNorm = 5.4035, lr_0 = 9.7066e-04
Validation rmse = 0.337009
Validation mse = 0.113575
Validation r2 = 0.108113
Epoch 3
Loss = 5.3623e-01, PNorm = 43.4420, GNorm = 2.4554, lr_0 = 9.3908e-04
Validation rmse = 0.239631
Validation mse = 0.057423
Validation r2 = 0.549065
Epoch 4
Loss = 3.5020e-01, PNorm = 43.5304, GNorm = 4.4356, lr_0 = 9.0552e-04
Loss = 3.4394e-01, PNorm = 43.5985, GNorm = 3.0011, lr_0 = 8.7605e-04
Validation rmse = 0.219810
Validation mse = 0.048316
Validation r2 = 0.620579
Epoch 5
Loss = 2.8553e-01, PNorm = 43.6527, GNorm = 0.8144, lr_0 = 8.4754e-04
Validation rmse = 0.194857
Validation mse = 0.037969
Validation r2 = 0.701833
Epoch 6
Loss = 3.2334e-01, PNorm = 43.7065, GNorm = 3.6729, lr_0 = 8.1725e-04
Validation rmse = 0.209021
Validation mse = 0.043690
Validation r2 = 0.656913
Epoch 7
Loss = 2.4018e-01, PNorm = 43.7528, GNorm = 1.6084, lr_0 = 7.9066e-04
Validation rmse = 0.180436
Validation mse = 0.032557
Validation r2 = 0.744334
Epoch 8
Loss = 2.2887e-01, PNorm = 43.7942, GNorm = 4.3029, lr_0 = 7.6240e-04
Loss = 1.9759e-01, PNorm = 43.8381, GNorm = 2.6446, lr_0 = 7.3759e-04
Validation rmse = 0.188975
Validation mse = 0.035712
Validation r2 = 0.719562
Epoch 9
Loss = 2.1021e-01, PNorm = 43.8687, GNorm = 6.3659, lr_0 = 7.1359e-04
Validation rmse = 0.157737
Validation mse = 0.024881
Validation r2 = 0.804614
Epoch 10
Loss = 2.0988e-01, PNorm = 43.9038, GNorm = 6.1393, lr_0 = 6.8809e-04
Validation rmse = 0.193716
Validation mse = 0.037526
Validation r2 = 0.705316
Epoch 11
Loss = 1.6261e-01, PNorm = 43.9359, GNorm = 0.9325, lr_0 = 6.6570e-04
Validation rmse = 0.158574
Validation mse = 0.025146
Validation r2 = 0.802534
Epoch 12
Loss = 1.4197e-01, PNorm = 43.9707, GNorm = 0.8207, lr_0 = 6.4191e-04
Loss = 1.5964e-01, PNorm = 43.9978, GNorm = 1.0209, lr_0 = 6.2102e-04
Validation rmse = 0.149676
Validation mse = 0.022403
Validation r2 = 0.824074
Epoch 13
Loss = 1.4496e-01, PNorm = 44.0206, GNorm = 1.4020, lr_0 = 6.0081e-04
Validation rmse = 0.161996
Validation mse = 0.026243
Validation r2 = 0.793921
Epoch 14
Loss = 1.4282e-01, PNorm = 44.0494, GNorm = 1.4717, lr_0 = 5.7934e-04
Validation rmse = 0.158419
Validation mse = 0.025097
Validation r2 = 0.802921
Epoch 15
Loss = 2.0081e-01, PNorm = 44.0723, GNorm = 5.2704, lr_0 = 5.6048e-04
Validation rmse = 0.163886
Validation mse = 0.026859
Validation r2 = 0.789085
Epoch 16
Loss = 1.2682e-01, PNorm = 44.0987, GNorm = 2.0558, lr_0 = 5.4045e-04
Loss = 1.3304e-01, PNorm = 44.1250, GNorm = 2.7032, lr_0 = 5.2287e-04
Validation rmse = 0.139028
Validation mse = 0.019329
Validation r2 = 0.848214
Epoch 17
Loss = 1.3155e-01, PNorm = 44.1417, GNorm = 3.4995, lr_0 = 5.0585e-04
Validation rmse = 0.144099
Validation mse = 0.020765
Validation r2 = 0.836940
Epoch 18
Loss = 1.1214e-01, PNorm = 44.1665, GNorm = 1.5362, lr_0 = 4.8777e-04
Validation rmse = 0.137533
Validation mse = 0.018915
Validation r2 = 0.851462
Epoch 19
Loss = 1.0066e-01, PNorm = 44.1817, GNorm = 2.0174, lr_0 = 4.7190e-04
Validation rmse = 0.135140
Validation mse = 0.018263
Validation r2 = 0.856586
Epoch 20
Loss = 1.2181e-01, PNorm = 44.1988, GNorm = 1.5638, lr_0 = 4.5504e-04
Loss = 1.1018e-01, PNorm = 44.2152, GNorm = 1.1992, lr_0 = 4.4023e-04
Validation rmse = 0.131808
Validation mse = 0.017373
Validation r2 = 0.863570
Epoch 21
Loss = 9.4203e-02, PNorm = 44.2283, GNorm = 0.7305, lr_0 = 4.2590e-04
Validation rmse = 0.131223
Validation mse = 0.017220
Validation r2 = 0.864778
Epoch 22
Loss = 1.0013e-01, PNorm = 44.2431, GNorm = 0.5107, lr_0 = 4.1068e-04
Validation rmse = 0.135383
Validation mse = 0.018328
Validation r2 = 0.856070
Epoch 23
Loss = 9.8472e-02, PNorm = 44.2579, GNorm = 2.2536, lr_0 = 3.9732e-04
Validation rmse = 0.156751
Validation mse = 0.024571
Validation r2 = 0.807050
Epoch 24
Loss = 8.3584e-02, PNorm = 44.2733, GNorm = 2.6218, lr_0 = 3.8312e-04
Loss = 1.1590e-01, PNorm = 44.2872, GNorm = 1.3199, lr_0 = 3.7065e-04
Validation rmse = 0.135575
Validation mse = 0.018380
Validation r2 = 0.855661
Epoch 25
Loss = 1.0215e-01, PNorm = 44.3005, GNorm = 0.4948, lr_0 = 3.5859e-04
Validation rmse = 0.128809
Validation mse = 0.016592
Validation r2 = 0.869708
Epoch 26
Loss = 9.1870e-02, PNorm = 44.3162, GNorm = 0.7428, lr_0 = 3.4577e-04
Validation rmse = 0.132132
Validation mse = 0.017459
Validation r2 = 0.862898
Epoch 27
Loss = 8.6095e-02, PNorm = 44.3293, GNorm = 1.2076, lr_0 = 3.3342e-04
Validation rmse = 0.126862
Validation mse = 0.016094
Validation r2 = 0.873617
Epoch 28
Loss = 7.8605e-02, PNorm = 44.3385, GNorm = 1.4285, lr_0 = 3.2257e-04
Loss = 8.5267e-02, PNorm = 44.3500, GNorm = 0.5759, lr_0 = 3.1207e-04
Validation rmse = 0.129513
Validation mse = 0.016774
Validation r2 = 0.868280
Epoch 29
Loss = 9.0862e-02, PNorm = 44.3622, GNorm = 1.1945, lr_0 = 3.0092e-04
Validation rmse = 0.127386
Validation mse = 0.016227
Validation r2 = 0.872570
Epoch 30
Loss = 8.4997e-02, PNorm = 44.3728, GNorm = 0.7562, lr_0 = 2.9113e-04
Validation rmse = 0.124925
Validation mse = 0.015606
Validation r2 = 0.877447
Epoch 31
Loss = 7.2405e-02, PNorm = 44.3829, GNorm = 0.4917, lr_0 = 2.8072e-04
Validation rmse = 0.126581
Validation mse = 0.016023
Validation r2 = 0.874176
Epoch 32
Loss = 9.0273e-02, PNorm = 44.3920, GNorm = 0.9591, lr_0 = 2.7159e-04
Loss = 8.2534e-02, PNorm = 44.4020, GNorm = 1.5026, lr_0 = 2.6275e-04
Validation rmse = 0.125970
Validation mse = 0.015869
Validation r2 = 0.875387
Epoch 33
Loss = 8.3078e-02, PNorm = 44.4116, GNorm = 3.6532, lr_0 = 2.5336e-04
Validation rmse = 0.142741
Validation mse = 0.020375
Validation r2 = 0.839999
Epoch 34
Loss = 8.8095e-02, PNorm = 44.4203, GNorm = 2.2014, lr_0 = 2.4511e-04
Validation rmse = 0.126993
Validation mse = 0.016127
Validation r2 = 0.873355
Epoch 35
Loss = 9.0921e-02, PNorm = 44.4305, GNorm = 0.7831, lr_0 = 2.3635e-04
Validation rmse = 0.124928
Validation mse = 0.015607
Validation r2 = 0.877441
Epoch 36
Loss = 7.5314e-02, PNorm = 44.4393, GNorm = 0.5243, lr_0 = 2.2866e-04
Loss = 8.0912e-02, PNorm = 44.4468, GNorm = 1.5243, lr_0 = 2.2122e-04
Validation rmse = 0.128321
Validation mse = 0.016466
Validation r2 = 0.870693
Epoch 37
Loss = 7.5688e-02, PNorm = 44.4570, GNorm = 0.6775, lr_0 = 2.1332e-04
Validation rmse = 0.124727
Validation mse = 0.015557
Validation r2 = 0.877834
Epoch 38
Loss = 7.3706e-02, PNorm = 44.4648, GNorm = 1.7221, lr_0 = 2.0637e-04
Validation rmse = 0.125092
Validation mse = 0.015648
Validation r2 = 0.877120
Epoch 39
Loss = 8.0581e-02, PNorm = 44.4718, GNorm = 0.5875, lr_0 = 1.9900e-04
Validation rmse = 0.127987
Validation mse = 0.016381
Validation r2 = 0.871366
Epoch 40
Loss = 4.7961e-02, PNorm = 44.4786, GNorm = 0.4855, lr_0 = 1.9252e-04
Loss = 7.2029e-02, PNorm = 44.4862, GNorm = 0.7893, lr_0 = 1.8626e-04
Validation rmse = 0.122633
Validation mse = 0.015039
Validation r2 = 0.881903
Epoch 41
Loss = 6.9577e-02, PNorm = 44.4933, GNorm = 0.7364, lr_0 = 1.7960e-04
Validation rmse = 0.125402
Validation mse = 0.015726
Validation r2 = 0.876509
Epoch 42
Loss = 6.9808e-02, PNorm = 44.4996, GNorm = 0.9549, lr_0 = 1.7376e-04
Validation rmse = 0.123732
Validation mse = 0.015310
Validation r2 = 0.879775
Epoch 43
Loss = 7.5925e-02, PNorm = 44.5060, GNorm = 0.7558, lr_0 = 1.6755e-04
Validation rmse = 0.124017
Validation mse = 0.015380
Validation r2 = 0.879222
Epoch 44
Loss = 5.6064e-02, PNorm = 44.5122, GNorm = 0.5218, lr_0 = 1.6210e-04
Loss = 7.3663e-02, PNorm = 44.5191, GNorm = 1.2603, lr_0 = 1.5682e-04
Validation rmse = 0.124048
Validation mse = 0.015388
Validation r2 = 0.879161
Epoch 45
Loss = 6.8381e-02, PNorm = 44.5243, GNorm = 0.7316, lr_0 = 1.5122e-04
Validation rmse = 0.125691
Validation mse = 0.015798
Validation r2 = 0.875939
Epoch 46
Loss = 7.0267e-02, PNorm = 44.5304, GNorm = 0.9259, lr_0 = 1.4630e-04
Validation rmse = 0.126722
Validation mse = 0.016058
Validation r2 = 0.873896
Epoch 47
Loss = 6.3416e-02, PNorm = 44.5365, GNorm = 1.4425, lr_0 = 1.4107e-04
Validation rmse = 0.123750
Validation mse = 0.015314
Validation r2 = 0.879741
Epoch 48
Loss = 6.7336e-02, PNorm = 44.5418, GNorm = 1.9290, lr_0 = 1.3648e-04
Loss = 6.6877e-02, PNorm = 44.5470, GNorm = 1.8083, lr_0 = 1.3204e-04
Validation rmse = 0.123713
Validation mse = 0.015305
Validation r2 = 0.879814
Epoch 49
Loss = 6.6952e-02, PNorm = 44.5524, GNorm = 0.9140, lr_0 = 1.2732e-04
Validation rmse = 0.123364
Validation mse = 0.015219
Validation r2 = 0.880489
Epoch 50
Loss = 6.3425e-02, PNorm = 44.5573, GNorm = 1.4623, lr_0 = 1.2317e-04
Validation rmse = 0.122979
Validation mse = 0.015124
Validation r2 = 0.881234
Epoch 51
Loss = 6.4149e-02, PNorm = 44.5618, GNorm = 0.9450, lr_0 = 1.1877e-04
Validation rmse = 0.124169
Validation mse = 0.015418
Validation r2 = 0.878926
Epoch 52
Loss = 4.3504e-02, PNorm = 44.5671, GNorm = 0.3940, lr_0 = 1.1453e-04
Loss = 6.4783e-02, PNorm = 44.5719, GNorm = 0.5390, lr_0 = 1.1080e-04
Validation rmse = 0.126323
Validation mse = 0.015958
Validation r2 = 0.874688
Epoch 53
Loss = 5.9988e-02, PNorm = 44.5757, GNorm = 1.5458, lr_0 = 1.0719e-04
Validation rmse = 0.125702
Validation mse = 0.015801
Validation r2 = 0.875917
Epoch 54
Loss = 6.3086e-02, PNorm = 44.5804, GNorm = 0.7573, lr_0 = 1.0336e-04
Validation rmse = 0.122754
Validation mse = 0.015068
Validation r2 = 0.881670
Epoch 55
Loss = 6.3526e-02, PNorm = 44.5843, GNorm = 1.0071, lr_0 = 1.0000e-04
Validation rmse = 0.124666
Validation mse = 0.015541
Validation r2 = 0.877955
Epoch 56
Loss = 5.2953e-02, PNorm = 44.5889, GNorm = 0.5354, lr_0 = 1.0000e-04
Loss = 5.9789e-02, PNorm = 44.5933, GNorm = 1.4722, lr_0 = 1.0000e-04
Validation rmse = 0.125866
Validation mse = 0.015842
Validation r2 = 0.875594
Epoch 57
Loss = 6.4115e-02, PNorm = 44.5972, GNorm = 2.4567, lr_0 = 1.0000e-04
Validation rmse = 0.121760
Validation mse = 0.014825
Validation r2 = 0.883579
Epoch 58
Loss = 5.1764e-02, PNorm = 44.6009, GNorm = 1.3777, lr_0 = 1.0000e-04
Validation rmse = 0.123885
Validation mse = 0.015347
Validation r2 = 0.879479
Epoch 59
Loss = 5.0705e-02, PNorm = 44.6049, GNorm = 0.6974, lr_0 = 1.0000e-04
Validation rmse = 0.124036
Validation mse = 0.015385
Validation r2 = 0.879184
Model 0 best validation rmse = 0.121760 on epoch 57
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.136897
Model 0 test mse = 0.018741
Model 0 test r2 = 0.842842
Ensemble test rmse = 0.136897
Ensemble test mse = 0.018741
Ensemble test r2 = 0.842842
Fold 3
Splitting data with seed 3
Total size = 1,041 | train size = 624 | val size = 208 | test size = 209
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.4295e-01, PNorm = 43.2656, GNorm = 1.3053, lr_0 = 5.1250e-04
Validation rmse = 0.331120
Validation mse = 0.109641
Validation r2 = 0.165543
Epoch 1
Loss = 7.7005e-01, PNorm = 43.3074, GNorm = 0.9528, lr_0 = 9.2500e-04
Validation rmse = 0.293617
Validation mse = 0.086211
Validation r2 = 0.343863
Epoch 2
Loss = 7.9507e-01, PNorm = 43.3658, GNorm = 4.2366, lr_0 = 9.7066e-04
Validation rmse = 0.309394
Validation mse = 0.095724
Validation r2 = 0.271458
Epoch 3
Loss = 7.1549e-01, PNorm = 43.4451, GNorm = 4.9321, lr_0 = 9.3908e-04
Validation rmse = 0.255306
Validation mse = 0.065181
Validation r2 = 0.503919
Epoch 4
Loss = 4.6994e-01, PNorm = 43.5299, GNorm = 1.6357, lr_0 = 9.0552e-04
Loss = 4.8617e-01, PNorm = 43.6129, GNorm = 3.3452, lr_0 = 8.7605e-04
Validation rmse = 0.237035
Validation mse = 0.056186
Validation r2 = 0.572381
Epoch 5
Loss = 4.3479e-01, PNorm = 43.6847, GNorm = 3.9906, lr_0 = 8.4754e-04
Validation rmse = 0.213056
Validation mse = 0.045393
Validation r2 = 0.654522
Epoch 6
Loss = 4.0208e-01, PNorm = 43.7515, GNorm = 1.5141, lr_0 = 8.1725e-04
Validation rmse = 0.209374
Validation mse = 0.043837
Validation r2 = 0.666361
Epoch 7
Loss = 2.3417e-01, PNorm = 43.8051, GNorm = 2.6700, lr_0 = 7.9066e-04
Validation rmse = 0.187146
Validation mse = 0.035024
Validation r2 = 0.733441
Epoch 8
Loss = 1.9981e-01, PNorm = 43.8507, GNorm = 1.5488, lr_0 = 7.6240e-04
Loss = 2.4735e-01, PNorm = 43.9008, GNorm = 2.9724, lr_0 = 7.3759e-04
Validation rmse = 0.189486
Validation mse = 0.035905
Validation r2 = 0.726734
Epoch 9
Loss = 2.2691e-01, PNorm = 43.9363, GNorm = 3.5075, lr_0 = 7.1359e-04
Validation rmse = 0.182351
Validation mse = 0.033252
Validation r2 = 0.746925
Epoch 10
Loss = 2.0500e-01, PNorm = 43.9768, GNorm = 5.5324, lr_0 = 6.8809e-04
Validation rmse = 0.177536
Validation mse = 0.031519
Validation r2 = 0.760115
Epoch 11
Loss = 2.2272e-01, PNorm = 44.0075, GNorm = 3.7463, lr_0 = 6.6570e-04
Validation rmse = 0.186946
Validation mse = 0.034949
Validation r2 = 0.734012
Epoch 12
Loss = 2.3443e-01, PNorm = 44.0450, GNorm = 3.1830, lr_0 = 6.4191e-04
Loss = 1.9634e-01, PNorm = 44.0759, GNorm = 1.1919, lr_0 = 6.2102e-04
Validation rmse = 0.177721
Validation mse = 0.031585
Validation r2 = 0.759614
Epoch 13
Loss = 1.9272e-01, PNorm = 44.1041, GNorm = 2.9774, lr_0 = 6.0081e-04
Validation rmse = 0.169072
Validation mse = 0.028585
Validation r2 = 0.782442
Epoch 14
Loss = 1.7895e-01, PNorm = 44.1299, GNorm = 2.9457, lr_0 = 5.7934e-04
Validation rmse = 0.163091
Validation mse = 0.026599
Validation r2 = 0.797562
Epoch 15
Loss = 1.3248e-01, PNorm = 44.1551, GNorm = 1.0104, lr_0 = 5.6048e-04
Validation rmse = 0.150206
Validation mse = 0.022562
Validation r2 = 0.828286
Epoch 16
Loss = 1.7794e-01, PNorm = 44.1808, GNorm = 1.3434, lr_0 = 5.4045e-04
Loss = 1.2309e-01, PNorm = 44.2038, GNorm = 1.1620, lr_0 = 5.2287e-04
Validation rmse = 0.150027
Validation mse = 0.022508
Validation r2 = 0.828695
Epoch 17
Loss = 1.3631e-01, PNorm = 44.2199, GNorm = 2.1077, lr_0 = 5.0585e-04
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-9aa06278-3f02-46f3-a9f8-3e50b1e24e6f.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 32,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_final.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['mse', 'r2'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'mse', 'r2'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/_final/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.6, 0.2, 0.2],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,041 | train size = 624 | val size = 208 | test size = 209
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 1.0629e+00, PNorm = 43.2596, GNorm = 0.9742, lr_0 = 3.6053e-04
Validation rmse = 0.324405
Validation mse = 0.105239
Validation r2 = 0.183309
Epoch 1
Loss = 5.9955e-01, PNorm = 43.2758, GNorm = 1.7329, lr_0 = 6.2105e-04
Loss = 7.9932e-01, PNorm = 43.3063, GNorm = 1.8290, lr_0 = 8.5789e-04
Validation rmse = 0.254927
Validation mse = 0.064988
Validation r2 = 0.495669
Epoch 2
Loss = 4.7450e-01, PNorm = 43.3741, GNorm = 3.2138, lr_0 = 9.9168e-04
Loss = 6.5577e-01, PNorm = 43.4497, GNorm = 4.4418, lr_0 = 9.7117e-04
Validation rmse = 0.228465
Validation mse = 0.052196
Validation r2 = 0.594937
Epoch 3
Loss = 5.5253e-01, PNorm = 43.5306, GNorm = 8.7317, lr_0 = 9.4910e-04
Loss = 4.6316e-01, PNorm = 43.6036, GNorm = 3.2665, lr_0 = 9.2948e-04
Validation rmse = 0.205970
Validation mse = 0.042424
Validation r2 = 0.670777
Epoch 4
Loss = 2.6862e-01, PNorm = 43.6732, GNorm = 1.1867, lr_0 = 9.1026e-04
Loss = 3.0340e-01, PNorm = 43.7460, GNorm = 2.3203, lr_0 = 8.9144e-04
Validation rmse = 0.180825
Validation mse = 0.032698
Validation r2 = 0.746255
Epoch 5
Loss = 2.9904e-01, PNorm = 43.7922, GNorm = 5.9206, lr_0 = 8.7118e-04
Loss = 2.7054e-01, PNorm = 43.8421, GNorm = 1.5903, lr_0 = 8.5317e-04
Validation rmse = 0.170174
Validation mse = 0.028959
Validation r2 = 0.775265
Epoch 6
Loss = 1.4902e-01, PNorm = 43.8855, GNorm = 1.5422, lr_0 = 8.3553e-04
Loss = 1.9309e-01, PNorm = 43.9224, GNorm = 2.0246, lr_0 = 8.1825e-04
Validation rmse = 0.184797
Validation mse = 0.034150
Validation r2 = 0.734984
Epoch 7
Loss = 2.3533e-01, PNorm = 43.9588, GNorm = 2.8929, lr_0 = 7.9966e-04
Loss = 2.4027e-01, PNorm = 43.9889, GNorm = 7.2835, lr_0 = 7.8312e-04
Validation rmse = 0.169154
Validation mse = 0.028613
Validation r2 = 0.777951
Epoch 8
Loss = 1.4152e-01, PNorm = 44.0134, GNorm = 1.0006, lr_0 = 7.6693e-04
Loss = 1.7995e-01, PNorm = 44.0387, GNorm = 2.2969, lr_0 = 7.5107e-04
Validation rmse = 0.169624
Validation mse = 0.028772
Validation r2 = 0.776717
Epoch 9
Loss = 2.0196e-01, PNorm = 44.0663, GNorm = 4.1860, lr_0 = 7.3400e-04
Loss = 1.4848e-01, PNorm = 44.0882, GNorm = 3.1722, lr_0 = 7.1883e-04
Validation rmse = 0.147673
Validation mse = 0.021807
Validation r2 = 0.830767
Epoch 10
Loss = 1.1607e-01, PNorm = 44.1106, GNorm = 0.9611, lr_0 = 7.0396e-04
Loss = 1.3586e-01, PNorm = 44.1315, GNorm = 1.3644, lr_0 = 6.8941e-04
Validation rmse = 0.141206
Validation mse = 0.019939
Validation r2 = 0.845264
Epoch 11
Loss = 1.8559e-01, PNorm = 44.1533, GNorm = 6.4521, lr_0 = 6.7374e-04
Loss = 1.8285e-01, PNorm = 44.1763, GNorm = 1.9164, lr_0 = 6.5981e-04
Validation rmse = 0.167319
Validation mse = 0.027995
Validation r2 = 0.782745
Epoch 12
Loss = 1.3075e-01, PNorm = 44.1975, GNorm = 0.7856, lr_0 = 6.4617e-04
Loss = 1.3030e-01, PNorm = 44.2206, GNorm = 0.9692, lr_0 = 6.3281e-04
Validation rmse = 0.153661
Validation mse = 0.023612
Validation r2 = 0.816764
Epoch 13
Loss = 1.1860e-01, PNorm = 44.2359, GNorm = 2.3909, lr_0 = 6.1843e-04
Loss = 1.4922e-01, PNorm = 44.2538, GNorm = 1.3882, lr_0 = 6.0564e-04
Validation rmse = 0.144367
Validation mse = 0.020842
Validation r2 = 0.838259
Epoch 14
Loss = 1.3066e-01, PNorm = 44.2717, GNorm = 1.3360, lr_0 = 5.9312e-04
Loss = 1.2096e-01, PNorm = 44.2888, GNorm = 1.8245, lr_0 = 5.8085e-04
Validation rmse = 0.147577
Validation mse = 0.021779
Validation r2 = 0.830988
Epoch 15
Loss = 9.6018e-02, PNorm = 44.3026, GNorm = 0.9081, lr_0 = 5.6765e-04
Loss = 1.0640e-01, PNorm = 44.3186, GNorm = 2.9690, lr_0 = 5.5592e-04
Validation rmse = 0.140028
Validation mse = 0.019608
Validation r2 = 0.847836
Epoch 16
Loss = 1.0078e-01, PNorm = 44.3313, GNorm = 2.9056, lr_0 = 5.4442e-04
Loss = 1.0382e-01, PNorm = 44.3443, GNorm = 1.6066, lr_0 = 5.3316e-04
Validation rmse = 0.144151
Validation mse = 0.020779
Validation r2 = 0.838744
Epoch 17
Loss = 1.1826e-01, PNorm = 44.3598, GNorm = 2.6793, lr_0 = 5.2105e-04
Loss = 1.3412e-01, PNorm = 44.3787, GNorm = 2.3426, lr_0 = 5.1027e-04
Validation rmse = 0.152540
Validation mse = 0.023269
Validation r2 = 0.819427
Epoch 18
Loss = 1.0759e-01, PNorm = 44.3928, GNorm = 4.1193, lr_0 = 4.9972e-04
Loss = 1.4039e-01, PNorm = 44.4101, GNorm = 3.2814, lr_0 = 4.8939e-04
Loss = 1.1414e-01, PNorm = 44.4115, GNorm = 3.1250, lr_0 = 4.8837e-04
Validation rmse = 0.138689
Validation mse = 0.019235
Validation r2 = 0.850732
Epoch 19
Loss = 1.0683e-01, PNorm = 44.4289, GNorm = 0.6114, lr_0 = 4.7827e-04
Loss = 9.9459e-02, PNorm = 44.4452, GNorm = 1.4861, lr_0 = 4.6838e-04
Validation rmse = 0.142762
Validation mse = 0.020381
Validation r2 = 0.841836
Epoch 20
Loss = 1.0020e-01, PNorm = 44.4619, GNorm = 2.5995, lr_0 = 4.5870e-04
Validation rmse = 0.141761
Validation mse = 0.020096
Validation r2 = 0.844047
Epoch 21
Loss = 1.2225e-01, PNorm = 44.4764, GNorm = 0.9970, lr_0 = 4.4827e-04
Loss = 8.7811e-02, PNorm = 44.4893, GNorm = 0.5000, lr_0 = 4.3900e-04
Validation rmse = 0.138188
Validation mse = 0.019096
Validation r2 = 0.851809
Epoch 22
Loss = 3.6418e-02, PNorm = 44.5022, GNorm = 0.7137, lr_0 = 4.2993e-04
Loss = 9.6351e-02, PNorm = 44.5158, GNorm = 0.6566, lr_0 = 4.2104e-04
Validation rmse = 0.138892
Validation mse = 0.019291
Validation r2 = 0.850296
Epoch 23
Loss = 9.3158e-02, PNorm = 44.5277, GNorm = 1.1351, lr_0 = 4.1147e-04
Loss = 7.2774e-02, PNorm = 44.5414, GNorm = 2.3407, lr_0 = 4.0296e-04
Validation rmse = 0.140105
Validation mse = 0.019629
Validation r2 = 0.847668
Epoch 24
Loss = 5.5187e-02, PNorm = 44.5493, GNorm = 0.5402, lr_0 = 3.9463e-04
Loss = 9.5361e-02, PNorm = 44.5591, GNorm = 1.9978, lr_0 = 3.8647e-04
Validation rmse = 0.142616
Validation mse = 0.020339
Validation r2 = 0.842160
Epoch 25
Loss = 9.0878e-02, PNorm = 44.5726, GNorm = 1.2322, lr_0 = 3.7769e-04
Loss = 8.0486e-02, PNorm = 44.5827, GNorm = 2.3630, lr_0 = 3.6988e-04
Validation rmse = 0.140748
Validation mse = 0.019810
Validation r2 = 0.846267
Epoch 26
Loss = 8.8459e-02, PNorm = 44.5978, GNorm = 1.8891, lr_0 = 3.6223e-04
Loss = 9.3946e-02, PNorm = 44.6096, GNorm = 2.6336, lr_0 = 3.5474e-04
Validation rmse = 0.140377
Validation mse = 0.019706
Validation r2 = 0.847077
Epoch 27
Loss = 8.5781e-02, PNorm = 44.6212, GNorm = 1.4812, lr_0 = 3.4668e-04
Loss = 7.0954e-02, PNorm = 44.6317, GNorm = 0.6062, lr_0 = 3.3951e-04
Validation rmse = 0.144239
Validation mse = 0.020805
Validation r2 = 0.838545
Epoch 28
Loss = 1.0369e-01, PNorm = 44.6441, GNorm = 1.8836, lr_0 = 3.3249e-04
Loss = 8.3178e-02, PNorm = 44.6549, GNorm = 1.3640, lr_0 = 3.2561e-04
Validation rmse = 0.157668
Validation mse = 0.024859
Validation r2 = 0.807083
Epoch 29
Loss = 1.1421e-01, PNorm = 44.6669, GNorm = 3.1444, lr_0 = 3.1822e-04
Loss = 9.0023e-02, PNorm = 44.6797, GNorm = 0.9452, lr_0 = 3.1164e-04
Validation rmse = 0.147681
Validation mse = 0.021810
Validation r2 = 0.830750
Epoch 30
Loss = 8.2092e-02, PNorm = 44.6889, GNorm = 0.9380, lr_0 = 3.0519e-04
Loss = 7.4703e-02, PNorm = 44.7020, GNorm = 1.4514, lr_0 = 2.9888e-04
Validation rmse = 0.140247
Validation mse = 0.019669
Validation r2 = 0.847360
Epoch 31
Loss = 5.8032e-02, PNorm = 44.7113, GNorm = 2.0302, lr_0 = 2.9209e-04
Loss = 7.2036e-02, PNorm = 44.7207, GNorm = 1.1172, lr_0 = 2.8605e-04
Validation rmse = 0.143519
Validation mse = 0.020598
Validation r2 = 0.840153
Epoch 32
Loss = 5.8580e-02, PNorm = 44.7297, GNorm = 0.3485, lr_0 = 2.8014e-04
Loss = 8.2903e-02, PNorm = 44.7399, GNorm = 1.4748, lr_0 = 2.7434e-04
Validation rmse = 0.144178
Validation mse = 0.020787
Validation r2 = 0.838683
Epoch 33
Loss = 7.5332e-02, PNorm = 44.7507, GNorm = 0.7315, lr_0 = 2.6811e-04
Loss = 6.7462e-02, PNorm = 44.7601, GNorm = 0.7617, lr_0 = 2.6257e-04
Validation rmse = 0.141314
Validation mse = 0.019970
Validation r2 = 0.845028
Epoch 34
Loss = 5.9231e-02, PNorm = 44.7681, GNorm = 0.6959, lr_0 = 2.5714e-04
Loss = 6.4860e-02, PNorm = 44.7761, GNorm = 0.8661, lr_0 = 2.5182e-04
Validation rmse = 0.142794
Validation mse = 0.020390
Validation r2 = 0.841764
Epoch 35
Loss = 6.5965e-02, PNorm = 44.7837, GNorm = 0.6328, lr_0 = 2.4610e-04
Loss = 6.3893e-02, PNorm = 44.7939, GNorm = 1.5475, lr_0 = 2.4101e-04
Validation rmse = 0.140273
Validation mse = 0.019677
Validation r2 = 0.847303
Epoch 36
Loss = 6.4455e-02, PNorm = 44.8024, GNorm = 0.9181, lr_0 = 2.3603e-04
Loss = 6.4085e-02, PNorm = 44.8108, GNorm = 2.3924, lr_0 = 2.3114e-04
Validation rmse = 0.141240
Validation mse = 0.019949
Validation r2 = 0.845191
Epoch 37
Loss = 6.0887e-02, PNorm = 44.8189, GNorm = 0.4421, lr_0 = 2.2589e-04
Loss = 7.5657e-02, PNorm = 44.8278, GNorm = 1.5042, lr_0 = 2.2122e-04
Validation rmse = 0.139472
Validation mse = 0.019453
Validation r2 = 0.849041
Epoch 38
Loss = 5.8835e-02, PNorm = 44.8366, GNorm = 0.6491, lr_0 = 2.1665e-04
Loss = 6.2949e-02, PNorm = 44.8440, GNorm = 0.6246, lr_0 = 2.1217e-04
Loss = 1.1345e-01, PNorm = 44.8449, GNorm = 1.6384, lr_0 = 2.1172e-04
Validation rmse = 0.141240
Validation mse = 0.019949
Validation r2 = 0.845189
Epoch 39
Loss = 6.1739e-02, PNorm = 44.8527, GNorm = 0.7768, lr_0 = 2.0735e-04
Loss = 5.6602e-02, PNorm = 44.8602, GNorm = 0.6901, lr_0 = 2.0306e-04
Validation rmse = 0.142241
Validation mse = 0.020232
Validation r2 = 0.842989
Epoch 40
Loss = 5.9586e-02, PNorm = 44.8660, GNorm = 0.8136, lr_0 = 1.9886e-04
Validation rmse = 0.143849
Validation mse = 0.020692
Validation r2 = 0.839419
Epoch 41
Loss = 5.0581e-02, PNorm = 44.8752, GNorm = 1.0458, lr_0 = 1.9434e-04
Loss = 5.9697e-02, PNorm = 44.8826, GNorm = 0.7685, lr_0 = 1.9032e-04
Validation rmse = 0.141399
Validation mse = 0.019994
Validation r2 = 0.844842
Epoch 42
Loss = 6.8066e-02, PNorm = 44.8895, GNorm = 0.6743, lr_0 = 1.8639e-04
Loss = 4.9437e-02, PNorm = 44.8973, GNorm = 1.4768, lr_0 = 1.8253e-04
Validation rmse = 0.144024
Validation mse = 0.020743
Validation r2 = 0.839027
Epoch 43
Loss = 5.2550e-02, PNorm = 44.9033, GNorm = 2.7524, lr_0 = 1.7839e-04
Loss = 5.9222e-02, PNorm = 44.9108, GNorm = 0.5734, lr_0 = 1.7470e-04
Validation rmse = 0.142933
Validation mse = 0.020430
Validation r2 = 0.841457
Epoch 44
Loss = 6.5786e-02, PNorm = 44.9175, GNorm = 1.9847, lr_0 = 1.7109e-04
Loss = 5.2452e-02, PNorm = 44.9239, GNorm = 1.0253, lr_0 = 1.6755e-04
Validation rmse = 0.140573
Validation mse = 0.019761
Validation r2 = 0.846649
Epoch 45
Loss = 4.3032e-02, PNorm = 44.9312, GNorm = 1.1853, lr_0 = 1.6374e-04
Loss = 5.2402e-02, PNorm = 44.9362, GNorm = 0.8680, lr_0 = 1.6035e-04
Validation rmse = 0.140447
Validation mse = 0.019725
Validation r2 = 0.846924
Epoch 46
Loss = 4.5869e-02, PNorm = 44.9421, GNorm = 1.0126, lr_0 = 1.5704e-04
Loss = 5.2012e-02, PNorm = 44.9480, GNorm = 0.8716, lr_0 = 1.5379e-04
Validation rmse = 0.142747
Validation mse = 0.020377
Validation r2 = 0.841870
Epoch 47
Loss = 5.3598e-02, PNorm = 44.9547, GNorm = 1.0339, lr_0 = 1.5030e-04
Loss = 5.8888e-02, PNorm = 44.9610, GNorm = 1.2546, lr_0 = 1.4719e-04
Validation rmse = 0.141905
Validation mse = 0.020137
Validation r2 = 0.843730
Epoch 48
Loss = 5.3701e-02, PNorm = 44.9671, GNorm = 2.3135, lr_0 = 1.4415e-04
Loss = 4.6338e-02, PNorm = 44.9720, GNorm = 0.7460, lr_0 = 1.4117e-04
Validation rmse = 0.142228
Validation mse = 0.020229
Validation r2 = 0.843017
Epoch 49
Loss = 3.0570e-02, PNorm = 44.9786, GNorm = 0.6443, lr_0 = 1.3796e-04
Loss = 5.2328e-02, PNorm = 44.9833, GNorm = 1.3244, lr_0 = 1.3511e-04
Validation rmse = 0.138653
Validation mse = 0.019225
Validation r2 = 0.850810
Epoch 50
Loss = 4.4965e-02, PNorm = 44.9892, GNorm = 1.8290, lr_0 = 1.3231e-04
Loss = 4.7876e-02, PNorm = 44.9937, GNorm = 0.9951, lr_0 = 1.2958e-04
Validation rmse = 0.140646
Validation mse = 0.019781
Validation r2 = 0.846490
Epoch 51
Loss = 4.0912e-02, PNorm = 44.9990, GNorm = 0.5983, lr_0 = 1.2663e-04
Loss = 5.5659e-02, PNorm = 45.0037, GNorm = 0.8384, lr_0 = 1.2401e-04
Validation rmse = 0.139977
Validation mse = 0.019594
Validation r2 = 0.847946
Epoch 52
Loss = 4.4821e-02, PNorm = 45.0083, GNorm = 0.9841, lr_0 = 1.2145e-04
Loss = 4.2879e-02, PNorm = 45.0126, GNorm = 0.6128, lr_0 = 1.1894e-04
Validation rmse = 0.140278
Validation mse = 0.019678
Validation r2 = 0.847292
Epoch 53
Loss = 3.7039e-02, PNorm = 45.0175, GNorm = 0.5165, lr_0 = 1.1623e-04
Loss = 4.9243e-02, PNorm = 45.0215, GNorm = 0.6398, lr_0 = 1.1383e-04
Validation rmse = 0.139509
Validation mse = 0.019463
Validation r2 = 0.848962
Epoch 54
Loss = 4.2765e-02, PNorm = 45.0254, GNorm = 0.4199, lr_0 = 1.1148e-04
Loss = 4.2669e-02, PNorm = 45.0295, GNorm = 0.7487, lr_0 = 1.0917e-04
Validation rmse = 0.141803
Validation mse = 0.020108
Validation r2 = 0.843953
Epoch 55
Loss = 4.5146e-02, PNorm = 45.0356, GNorm = 1.3554, lr_0 = 1.0669e-04
Loss = 4.4741e-02, PNorm = 45.0408, GNorm = 1.2370, lr_0 = 1.0449e-04
Validation rmse = 0.143471
Validation mse = 0.020584
Validation r2 = 0.840262
Epoch 56
Loss = 3.7719e-02, PNorm = 45.0435, GNorm = 0.9815, lr_0 = 1.0233e-04
Loss = 4.9785e-02, PNorm = 45.0471, GNorm = 0.7021, lr_0 = 1.0021e-04
Validation rmse = 0.143387
Validation mse = 0.020560
Validation r2 = 0.840449
Epoch 57
Loss = 3.8457e-02, PNorm = 45.0512, GNorm = 0.7862, lr_0 = 1.0000e-04
Loss = 4.4879e-02, PNorm = 45.0552, GNorm = 0.6371, lr_0 = 1.0000e-04
Validation rmse = 0.141058
Validation mse = 0.019897
Validation r2 = 0.845589
Epoch 58
Loss = 4.0401e-02, PNorm = 45.0588, GNorm = 0.4423, lr_0 = 1.0000e-04
Loss = 4.0925e-02, PNorm = 45.0622, GNorm = 0.6344, lr_0 = 1.0000e-04
Loss = 4.3342e-02, PNorm = 45.0626, GNorm = 0.9038, lr_0 = 1.0000e-04
Validation rmse = 0.140104
Validation mse = 0.019629
Validation r2 = 0.847671
Epoch 59
Loss = 3.9743e-02, PNorm = 45.0666, GNorm = 1.0313, lr_0 = 1.0000e-04
Loss = 4.2110e-02, PNorm = 45.0709, GNorm = 0.9308, lr_0 = 1.0000e-04
Validation rmse = 0.140841
Validation mse = 0.019836
Validation r2 = 0.846063
Model 0 best validation rmse = 0.138188 on epoch 21
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.117189
Model 0 test mse = 0.013733
Model 0 test r2 = 0.878657
Ensemble test rmse = 0.117189
Ensemble test mse = 0.013733
Ensemble test r2 = 0.878657
Fold 1
Splitting data with seed 1
Total size = 1,041 | train size = 624 | val size = 208 | test size = 209
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 1.1247e+00, PNorm = 43.2593, GNorm = 4.2420, lr_0 = 3.6053e-04
Validation rmse = 0.375695
Validation mse = 0.141146
Validation r2 = -0.066157
Epoch 1
Loss = 1.4363e+00, PNorm = 43.2771, GNorm = 13.0796, lr_0 = 6.2105e-04
Loss = 8.5926e-01, PNorm = 43.3052, GNorm = 7.4536, lr_0 = 8.5789e-04
Validation rmse = 0.287988
Validation mse = 0.082937
Validation r2 = 0.373530
Epoch 2
Loss = 4.8762e-01, PNorm = 43.3640, GNorm = 3.0097, lr_0 = 9.9168e-04
Loss = 6.3852e-01, PNorm = 43.4371, GNorm = 4.9407, lr_0 = 9.7117e-04
Validation rmse = 0.295545
Validation mse = 0.087347
Validation r2 = 0.340221
Epoch 3
Loss = 6.7366e-01, PNorm = 43.5217, GNorm = 4.7468, lr_0 = 9.4910e-04
Loss = 4.0462e-01, PNorm = 43.5990, GNorm = 1.8822, lr_0 = 9.2948e-04
Validation rmse = 0.213538
Validation mse = 0.045598
Validation r2 = 0.655571
Epoch 4
Loss = 3.4696e-01, PNorm = 43.6700, GNorm = 2.3639, lr_0 = 9.1026e-04
Loss = 3.7913e-01, PNorm = 43.7325, GNorm = 6.3280, lr_0 = 8.9144e-04
Validation rmse = 0.282765
Validation mse = 0.079956
Validation r2 = 0.396049
Epoch 5
Loss = 3.0196e-01, PNorm = 43.7816, GNorm = 2.1139, lr_0 = 8.7118e-04
Loss = 3.1528e-01, PNorm = 43.8350, GNorm = 1.3279, lr_0 = 8.5317e-04
Validation rmse = 0.180527
Validation mse = 0.032590
Validation r2 = 0.753829
Epoch 6
Loss = 2.4648e-01, PNorm = 43.8848, GNorm = 2.9936, lr_0 = 8.3553e-04
Loss = 2.6208e-01, PNorm = 43.9298, GNorm = 3.9617, lr_0 = 8.1825e-04
Validation rmse = 0.189385
Validation mse = 0.035867
Validation r2 = 0.729078
Epoch 7
Loss = 2.4675e-01, PNorm = 43.9812, GNorm = 6.6116, lr_0 = 7.9966e-04
Loss = 2.5693e-01, PNorm = 44.0244, GNorm = 4.7022, lr_0 = 7.8312e-04
Validation rmse = 0.160758
Validation mse = 0.025843
Validation r2 = 0.804793
Epoch 8
Loss = 2.3837e-01, PNorm = 44.0595, GNorm = 2.9869, lr_0 = 7.6693e-04
Loss = 1.8418e-01, PNorm = 44.0887, GNorm = 1.1573, lr_0 = 7.5107e-04
Validation rmse = 0.162223
Validation mse = 0.026316
Validation r2 = 0.801220
Epoch 9
Loss = 1.7289e-01, PNorm = 44.1180, GNorm = 1.4472, lr_0 = 7.3400e-04
Loss = 1.5086e-01, PNorm = 44.1433, GNorm = 4.4831, lr_0 = 7.1883e-04
Validation rmse = 0.153290
Validation mse = 0.023498
Validation r2 = 0.822508
Epoch 10
Loss = 1.1864e-01, PNorm = 44.1566, GNorm = 0.5822, lr_0 = 7.0396e-04
Loss = 1.3235e-01, PNorm = 44.1757, GNorm = 1.9521, lr_0 = 6.8941e-04
Validation rmse = 0.156367
Validation mse = 0.024451
Validation r2 = 0.815310
Epoch 11
Loss = 1.1938e-01, PNorm = 44.2004, GNorm = 1.0673, lr_0 = 6.7374e-04
Loss = 1.2842e-01, PNorm = 44.2189, GNorm = 2.4091, lr_0 = 6.5981e-04
Validation rmse = 0.147502
Validation mse = 0.021757
Validation r2 = 0.835658
Epoch 12
Loss = 1.3182e-01, PNorm = 44.2381, GNorm = 1.7323, lr_0 = 6.4617e-04
Loss = 1.5267e-01, PNorm = 44.2586, GNorm = 0.9524, lr_0 = 6.3281e-04
Validation rmse = 0.144992
Validation mse = 0.021023
Validation r2 = 0.841204
Epoch 13
Loss = 1.0066e-01, PNorm = 44.2752, GNorm = 1.4633, lr_0 = 6.1843e-04
Loss = 1.3206e-01, PNorm = 44.2942, GNorm = 1.7529, lr_0 = 6.0564e-04
Validation rmse = 0.141448
Validation mse = 0.020007
Validation r2 = 0.848873
Epoch 14
Loss = 1.1938e-01, PNorm = 44.3091, GNorm = 1.8739, lr_0 = 5.9312e-04
Loss = 1.1835e-01, PNorm = 44.3209, GNorm = 2.2002, lr_0 = 5.8085e-04
Validation rmse = 0.147256
Validation mse = 0.021684
Validation r2 = 0.836206
Epoch 15
Loss = 1.2371e-01, PNorm = 44.3368, GNorm = 2.2310, lr_0 = 5.6765e-04
Loss = 1.2217e-01, PNorm = 44.3466, GNorm = 2.8449, lr_0 = 5.5592e-04
Validation rmse = 0.147160
Validation mse = 0.021656
Validation r2 = 0.836419
Epoch 16
Loss = 1.0374e-01, PNorm = 44.3585, GNorm = 1.4772, lr_0 = 5.4442e-04
Loss = 1.2775e-01, PNorm = 44.3765, GNorm = 2.4465, lr_0 = 5.3316e-04
Validation rmse = 0.142948
Validation mse = 0.020434
Validation r2 = 0.845649
Epoch 17
Loss = 1.0205e-01, PNorm = 44.3880, GNorm = 0.5850, lr_0 = 5.2105e-04
Loss = 1.0312e-01, PNorm = 44.4003, GNorm = 1.1397, lr_0 = 5.1027e-04
Validation rmse = 0.145481
Validation mse = 0.021165
Validation r2 = 0.840131
Epoch 18
Loss = 1.0608e-01, PNorm = 44.4107, GNorm = 4.8261, lr_0 = 4.9972e-04
Loss = 1.2559e-01, PNorm = 44.4240, GNorm = 1.8902, lr_0 = 4.8939e-04
Loss = 8.0980e-02, PNorm = 44.4262, GNorm = 0.7407, lr_0 = 4.8837e-04
Validation rmse = 0.136943
Validation mse = 0.018753
Validation r2 = 0.858346
Epoch 19
Loss = 1.1011e-01, PNorm = 44.4406, GNorm = 1.5496, lr_0 = 4.7827e-04
Loss = 1.2170e-01, PNorm = 44.4515, GNorm = 2.5443, lr_0 = 4.6838e-04
Validation rmse = 0.157290
Validation mse = 0.024740
Validation r2 = 0.813123
Epoch 20
Loss = 1.1008e-01, PNorm = 44.4656, GNorm = 0.8857, lr_0 = 4.5870e-04
Validation rmse = 0.137916
Validation mse = 0.019021
Validation r2 = 0.856325
Epoch 21
Loss = 6.9918e-02, PNorm = 44.4790, GNorm = 1.1118, lr_0 = 4.4827e-04
Loss = 1.0391e-01, PNorm = 44.4885, GNorm = 1.4701, lr_0 = 4.3900e-04
Validation rmse = 0.133476
Validation mse = 0.017816
Validation r2 = 0.865427
Epoch 22
Loss = 8.9603e-02, PNorm = 44.5007, GNorm = 0.9101, lr_0 = 4.2993e-04
Loss = 1.0952e-01, PNorm = 44.5175, GNorm = 1.3625, lr_0 = 4.2104e-04
Validation rmse = 0.138606
Validation mse = 0.019212
Validation r2 = 0.854883
Epoch 23
Loss = 7.4207e-02, PNorm = 44.5250, GNorm = 1.1782, lr_0 = 4.1147e-04
Loss = 1.1494e-01, PNorm = 44.5409, GNorm = 1.5373, lr_0 = 4.0296e-04
Validation rmse = 0.138867
Validation mse = 0.019284
Validation r2 = 0.854336
Epoch 24
Loss = 1.0641e-01, PNorm = 44.5507, GNorm = 2.9920, lr_0 = 3.9463e-04
Loss = 1.0927e-01, PNorm = 44.5620, GNorm = 4.7103, lr_0 = 3.8647e-04
Validation rmse = 0.136659
Validation mse = 0.018676
Validation r2 = 0.858932
Epoch 25
Loss = 9.1069e-02, PNorm = 44.5805, GNorm = 1.5601, lr_0 = 3.7769e-04
Loss = 9.7867e-02, PNorm = 44.5919, GNorm = 1.3062, lr_0 = 3.6988e-04
Validation rmse = 0.140023
Validation mse = 0.019606
Validation r2 = 0.851902
Epoch 26
Loss = 9.0677e-02, PNorm = 44.6051, GNorm = 0.5641, lr_0 = 3.6223e-04
Loss = 1.0258e-01, PNorm = 44.6187, GNorm = 1.8032, lr_0 = 3.5474e-04
Validation rmse = 0.143557
Validation mse = 0.020609
Validation r2 = 0.844332
Epoch 27
Loss = 1.0786e-01, PNorm = 44.6297, GNorm = 1.0830, lr_0 = 3.4668e-04
Loss = 9.2045e-02, PNorm = 44.6393, GNorm = 1.2670, lr_0 = 3.3951e-04
Validation rmse = 0.130719
Validation mse = 0.017087
Validation r2 = 0.870930
Epoch 28
Loss = 7.4852e-02, PNorm = 44.6490, GNorm = 0.6192, lr_0 = 3.3249e-04
Loss = 8.0797e-02, PNorm = 44.6584, GNorm = 0.5793, lr_0 = 3.2561e-04
Validation rmse = 0.134158
Validation mse = 0.017998
Validation r2 = 0.864048
Epoch 29
Loss = 7.2658e-02, PNorm = 44.6673, GNorm = 0.9876, lr_0 = 3.1822e-04
Loss = 1.0301e-01, PNorm = 44.6767, GNorm = 2.9177, lr_0 = 3.1164e-04
Validation rmse = 0.142518
Validation mse = 0.020311
Validation r2 = 0.846576
Epoch 30
Loss = 8.8558e-02, PNorm = 44.6850, GNorm = 1.2376, lr_0 = 3.0519e-04
Loss = 8.8943e-02, PNorm = 44.6962, GNorm = 1.4362, lr_0 = 2.9888e-04
Validation rmse = 0.130319
Validation mse = 0.016983
Validation r2 = 0.871717
Epoch 31
Loss = 7.7394e-02, PNorm = 44.7069, GNorm = 1.4065, lr_0 = 2.9209e-04
Loss = 8.1642e-02, PNorm = 44.7169, GNorm = 1.5716, lr_0 = 2.8605e-04
Validation rmse = 0.135533
Validation mse = 0.018369
Validation r2 = 0.861247
Epoch 32
Loss = 8.9990e-02, PNorm = 44.7245, GNorm = 1.2467, lr_0 = 2.8014e-04
Loss = 6.8874e-02, PNorm = 44.7311, GNorm = 0.7565, lr_0 = 2.7434e-04
Validation rmse = 0.135948
Validation mse = 0.018482
Validation r2 = 0.860396
Epoch 33
Loss = 8.5629e-02, PNorm = 44.7417, GNorm = 0.6595, lr_0 = 2.6811e-04
Loss = 6.5318e-02, PNorm = 44.7500, GNorm = 1.3138, lr_0 = 2.6257e-04
Validation rmse = 0.130234
Validation mse = 0.016961
Validation r2 = 0.871884
Epoch 34
Loss = 8.2442e-02, PNorm = 44.7578, GNorm = 1.4279, lr_0 = 2.5714e-04
Loss = 6.3925e-02, PNorm = 44.7662, GNorm = 0.7063, lr_0 = 2.5182e-04
Validation rmse = 0.129547
Validation mse = 0.016783
Validation r2 = 0.873232
Epoch 35
Loss = 6.5948e-02, PNorm = 44.7739, GNorm = 0.5086, lr_0 = 2.4610e-04
Loss = 7.6627e-02, PNorm = 44.7818, GNorm = 1.4328, lr_0 = 2.4101e-04
Validation rmse = 0.130617
Validation mse = 0.017061
Validation r2 = 0.871130
Epoch 36
Loss = 7.1112e-02, PNorm = 44.7889, GNorm = 0.5552, lr_0 = 2.3603e-04
Loss = 7.2740e-02, PNorm = 44.7971, GNorm = 2.5288, lr_0 = 2.3114e-04
Validation rmse = 0.128616
Validation mse = 0.016542
Validation r2 = 0.875048
Epoch 37
Loss = 7.6920e-02, PNorm = 44.8053, GNorm = 1.7691, lr_0 = 2.2589e-04
Loss = 8.9885e-02, PNorm = 44.8134, GNorm = 0.7298, lr_0 = 2.2122e-04
Validation rmse = 0.132714
Validation mse = 0.017613
Validation r2 = 0.866958
Epoch 38
Loss = 6.7412e-02, PNorm = 44.8217, GNorm = 0.7889, lr_0 = 2.1665e-04
Loss = 6.7245e-02, PNorm = 44.8297, GNorm = 1.7245, lr_0 = 2.1217e-04
Loss = 2.4682e-02, PNorm = 44.8304, GNorm = 0.8667, lr_0 = 2.1172e-04
Validation rmse = 0.141411
Validation mse = 0.019997
Validation r2 = 0.848952
Epoch 39
Loss = 7.9430e-02, PNorm = 44.8355, GNorm = 1.2913, lr_0 = 2.0735e-04
Loss = 6.6996e-02, PNorm = 44.8431, GNorm = 0.7702, lr_0 = 2.0306e-04
Validation rmse = 0.136036
Validation mse = 0.018506
Validation r2 = 0.860216
Epoch 40
Loss = 7.2485e-02, PNorm = 44.8511, GNorm = 0.5547, lr_0 = 1.9886e-04
Validation rmse = 0.126453
Validation mse = 0.015990
Validation r2 = 0.879216
Epoch 41
Loss = 4.6723e-02, PNorm = 44.8582, GNorm = 0.6974, lr_0 = 1.9434e-04
Loss = 6.0820e-02, PNorm = 44.8637, GNorm = 1.4413, lr_0 = 1.9032e-04
Validation rmse = 0.129034
Validation mse = 0.016650
Validation r2 = 0.874235
Epoch 42
Loss = 3.6875e-02, PNorm = 44.8693, GNorm = 1.0996, lr_0 = 1.8639e-04
Loss = 6.7278e-02, PNorm = 44.8743, GNorm = 0.7593, lr_0 = 1.8253e-04
Validation rmse = 0.129808
Validation mse = 0.016850
Validation r2 = 0.872722
Epoch 43
Loss = 5.7815e-02, PNorm = 44.8822, GNorm = 1.8656, lr_0 = 1.7839e-04
Loss = 6.1445e-02, PNorm = 44.8891, GNorm = 0.9466, lr_0 = 1.7470e-04
Validation rmse = 0.127349
Validation mse = 0.016218
Validation r2 = 0.877499
Epoch 44
Loss = 5.5105e-02, PNorm = 44.8945, GNorm = 1.3653, lr_0 = 1.7109e-04
Loss = 6.2789e-02, PNorm = 44.9010, GNorm = 0.9828, lr_0 = 1.6755e-04
Validation rmse = 0.127611
Validation mse = 0.016284
Validation r2 = 0.876994
Epoch 45
Loss = 6.9934e-02, PNorm = 44.9066, GNorm = 0.5626, lr_0 = 1.6374e-04
Loss = 5.3107e-02, PNorm = 44.9119, GNorm = 0.5507, lr_0 = 1.6035e-04
Validation rmse = 0.126841
Validation mse = 0.016089
Validation r2 = 0.878473
Epoch 46
Loss = 4.4222e-02, PNorm = 44.9181, GNorm = 1.7120, lr_0 = 1.5704e-04
Loss = 6.1530e-02, PNorm = 44.9232, GNorm = 0.9830, lr_0 = 1.5379e-04
Validation rmse = 0.127218
Validation mse = 0.016184
Validation r2 = 0.877750
Epoch 47
Loss = 5.1195e-02, PNorm = 44.9296, GNorm = 0.6284, lr_0 = 1.5030e-04
Loss = 6.9697e-02, PNorm = 44.9343, GNorm = 1.1092, lr_0 = 1.4719e-04
Validation rmse = 0.129506
Validation mse = 0.016772
Validation r2 = 0.873313
Epoch 48
Loss = 7.6885e-02, PNorm = 44.9399, GNorm = 0.5782, lr_0 = 1.4415e-04
Loss = 5.9388e-02, PNorm = 44.9455, GNorm = 1.0962, lr_0 = 1.4117e-04
Validation rmse = 0.125963
Validation mse = 0.015867
Validation r2 = 0.880151
Epoch 49
Loss = 5.1407e-02, PNorm = 44.9511, GNorm = 1.2415, lr_0 = 1.3796e-04
Loss = 6.2090e-02, PNorm = 44.9563, GNorm = 1.9705, lr_0 = 1.3511e-04
Validation rmse = 0.126088
Validation mse = 0.015898
Validation r2 = 0.879911
Epoch 50
Loss = 5.5402e-02, PNorm = 44.9608, GNorm = 1.0035, lr_0 = 1.3231e-04
Loss = 6.6919e-02, PNorm = 44.9647, GNorm = 1.3478, lr_0 = 1.2958e-04
Validation rmse = 0.128148
Validation mse = 0.016422
Validation r2 = 0.875956
Epoch 51
Loss = 5.5980e-02, PNorm = 44.9702, GNorm = 0.7351, lr_0 = 1.2663e-04
Loss = 5.6287e-02, PNorm = 44.9757, GNorm = 0.6155, lr_0 = 1.2401e-04
Validation rmse = 0.130901
Validation mse = 0.017135
Validation r2 = 0.870568
Epoch 52
Loss = 6.9158e-02, PNorm = 44.9797, GNorm = 1.0086, lr_0 = 1.2145e-04
Loss = 6.6593e-02, PNorm = 44.9846, GNorm = 1.2754, lr_0 = 1.1894e-04
Validation rmse = 0.125312
Validation mse = 0.015703
Validation r2 = 0.881385
Epoch 53
Loss = 7.0646e-02, PNorm = 44.9883, GNorm = 1.0804, lr_0 = 1.1623e-04
Loss = 4.8784e-02, PNorm = 44.9926, GNorm = 1.1294, lr_0 = 1.1383e-04
Validation rmse = 0.126760
Validation mse = 0.016068
Validation r2 = 0.878628
Epoch 54
Loss = 5.3084e-02, PNorm = 44.9977, GNorm = 0.8361, lr_0 = 1.1148e-04
Loss = 6.0887e-02, PNorm = 45.0024, GNorm = 0.6946, lr_0 = 1.0917e-04
Validation rmse = 0.125975
Validation mse = 0.015870
Validation r2 = 0.880128
Epoch 55
Loss = 5.1252e-02, PNorm = 45.0058, GNorm = 0.5882, lr_0 = 1.0669e-04
Loss = 5.3768e-02, PNorm = 45.0098, GNorm = 1.2253, lr_0 = 1.0449e-04
Validation rmse = 0.128341
Validation mse = 0.016471
Validation r2 = 0.875583
Epoch 56
Loss = 5.9583e-02, PNorm = 45.0137, GNorm = 1.0504, lr_0 = 1.0233e-04
Loss = 4.6941e-02, PNorm = 45.0174, GNorm = 0.5505, lr_0 = 1.0021e-04
Validation rmse = 0.126879
Validation mse = 0.016098
Validation r2 = 0.878401
Epoch 57
Loss = 4.8527e-02, PNorm = 45.0218, GNorm = 0.6663, lr_0 = 1.0000e-04
Loss = 5.6123e-02, PNorm = 45.0251, GNorm = 1.0680, lr_0 = 1.0000e-04
Validation rmse = 0.127470
Validation mse = 0.016249
Validation r2 = 0.877266
Epoch 58
Loss = 4.6461e-02, PNorm = 45.0285, GNorm = 0.9054, lr_0 = 1.0000e-04
Loss = 5.3067e-02, PNorm = 45.0322, GNorm = 1.2482, lr_0 = 1.0000e-04
Loss = 1.0934e-01, PNorm = 45.0325, GNorm = 1.2983, lr_0 = 1.0000e-04
Validation rmse = 0.125865
Validation mse = 0.015842
Validation r2 = 0.880336
Epoch 59
Loss = 4.7508e-02, PNorm = 45.0357, GNorm = 1.0733, lr_0 = 1.0000e-04
Loss = 5.8573e-02, PNorm = 45.0396, GNorm = 2.1057, lr_0 = 1.0000e-04
Validation rmse = 0.126119
Validation mse = 0.015906
Validation r2 = 0.879854
Model 0 best validation rmse = 0.125312 on epoch 52
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.122766
Model 0 test mse = 0.015071
Model 0 test r2 = 0.853301
Ensemble test rmse = 0.122766
Ensemble test mse = 0.015071
Ensemble test r2 = 0.853301
Fold 2
Splitting data with seed 2
Total size = 1,041 | train size = 624 | val size = 208 | test size = 209
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.5287e-01, PNorm = 43.2615, GNorm = 3.2516, lr_0 = 3.6053e-04
Validation rmse = 0.367780
Validation mse = 0.135262
Validation r2 = -0.062190
Epoch 1
Loss = 1.2555e+00, PNorm = 43.2817, GNorm = 15.4448, lr_0 = 6.2105e-04
Loss = 9.3076e-01, PNorm = 43.3132, GNorm = 2.5480, lr_0 = 8.5789e-04
Validation rmse = 0.273214
Validation mse = 0.074646
Validation r2 = 0.413818
Epoch 2
Loss = 4.9225e-01, PNorm = 43.3786, GNorm = 5.2545, lr_0 = 9.9168e-04
Loss = 4.8384e-01, PNorm = 43.4520, GNorm = 7.9163, lr_0 = 9.7117e-04
Validation rmse = 0.232399
Validation mse = 0.054009
Validation r2 = 0.575876
Epoch 3
Loss = 3.2867e-01, PNorm = 43.5467, GNorm = 3.7847, lr_0 = 9.4910e-04
Loss = 3.4239e-01, PNorm = 43.6324, GNorm = 6.7703, lr_0 = 9.2948e-04
Validation rmse = 0.211719
Validation mse = 0.044825
Validation r2 = 0.647996
Epoch 4
Loss = 2.6391e-01, PNorm = 43.6702, GNorm = 1.7883, lr_0 = 9.1026e-04
Loss = 4.0626e-01, PNorm = 43.7239, GNorm = 4.4565, lr_0 = 8.9144e-04
Validation rmse = 0.186845
Validation mse = 0.034911
Validation r2 = 0.725849
Epoch 5
Loss = 2.1120e-01, PNorm = 43.7782, GNorm = 1.0013, lr_0 = 8.7118e-04
Loss = 2.4044e-01, PNorm = 43.8117, GNorm = 0.9872, lr_0 = 8.5317e-04
Validation rmse = 0.189766
Validation mse = 0.036011
Validation r2 = 0.717211
Epoch 6
Loss = 3.2931e-01, PNorm = 43.8474, GNorm = 3.7824, lr_0 = 8.3553e-04
Loss = 2.3186e-01, PNorm = 43.8830, GNorm = 2.8739, lr_0 = 8.1825e-04
Validation rmse = 0.194148
Validation mse = 0.037693
Validation r2 = 0.704001
Epoch 7
Loss = 2.1143e-01, PNorm = 43.9263, GNorm = 1.5238, lr_0 = 7.9966e-04
Loss = 1.8394e-01, PNorm = 43.9604, GNorm = 0.6847, lr_0 = 7.8312e-04
Validation rmse = 0.159436
Validation mse = 0.025420
Validation r2 = 0.800383
Epoch 8
Loss = 1.7790e-01, PNorm = 43.9973, GNorm = 2.5836, lr_0 = 7.6693e-04
Loss = 1.5103e-01, PNorm = 44.0287, GNorm = 1.2829, lr_0 = 7.5107e-04
Validation rmse = 0.150512
Validation mse = 0.022654
Validation r2 = 0.822104
Epoch 9
Loss = 1.8895e-01, PNorm = 44.0536, GNorm = 4.7219, lr_0 = 7.3400e-04
Loss = 1.5880e-01, PNorm = 44.0835, GNorm = 2.7555, lr_0 = 7.1883e-04
Validation rmse = 0.140519
Validation mse = 0.019746
Validation r2 = 0.844941
Epoch 10
Loss = 1.3313e-01, PNorm = 44.1010, GNorm = 2.8776, lr_0 = 7.0396e-04
Loss = 1.5438e-01, PNorm = 44.1192, GNorm = 3.0619, lr_0 = 6.8941e-04
Validation rmse = 0.142377
Validation mse = 0.020271
Validation r2 = 0.840813
Epoch 11
Loss = 1.1833e-01, PNorm = 44.1474, GNorm = 2.3047, lr_0 = 6.7374e-04
Loss = 1.3630e-01, PNorm = 44.1635, GNorm = 1.0361, lr_0 = 6.5981e-04
Validation rmse = 0.211520
Validation mse = 0.044741
Validation r2 = 0.648658
Epoch 12
Loss = 1.4062e-01, PNorm = 44.1888, GNorm = 2.2127, lr_0 = 6.4617e-04
Loss = 1.4257e-01, PNorm = 44.2123, GNorm = 4.1976, lr_0 = 6.3281e-04
Validation rmse = 0.139608
Validation mse = 0.019490
Validation r2 = 0.846946
Epoch 13
Loss = 1.2371e-01, PNorm = 44.2338, GNorm = 2.9446, lr_0 = 6.1843e-04
Loss = 1.3578e-01, PNorm = 44.2569, GNorm = 0.8013, lr_0 = 6.0564e-04
Validation rmse = 0.141503
Validation mse = 0.020023
Validation r2 = 0.842763
Epoch 14
Loss = 1.1297e-01, PNorm = 44.2767, GNorm = 2.2747, lr_0 = 5.9312e-04
Loss = 1.0613e-01, PNorm = 44.2945, GNorm = 1.5372, lr_0 = 5.8085e-04
Validation rmse = 0.145330
Validation mse = 0.021121
Validation r2 = 0.834143
Epoch 15
Loss = 1.0948e-01, PNorm = 44.3109, GNorm = 1.1224, lr_0 = 5.6765e-04
Loss = 1.0696e-01, PNorm = 44.3274, GNorm = 0.9241, lr_0 = 5.5592e-04
Validation rmse = 0.142156
Validation mse = 0.020208
Validation r2 = 0.841307
Epoch 16
Loss = 1.2268e-01, PNorm = 44.3414, GNorm = 1.1041, lr_0 = 5.4442e-04
Loss = 1.1408e-01, PNorm = 44.3585, GNorm = 2.3036, lr_0 = 5.3316e-04
Validation rmse = 0.133693
Validation mse = 0.017874
Validation r2 = 0.859641
Epoch 17
Loss = 1.1074e-01, PNorm = 44.3761, GNorm = 1.3887, lr_0 = 5.2105e-04
Loss = 9.1593e-02, PNorm = 44.3958, GNorm = 1.1700, lr_0 = 5.1027e-04
Validation rmse = 0.130540
Validation mse = 0.017041
Validation r2 = 0.866183
Epoch 18
Loss = 1.0260e-01, PNorm = 44.4096, GNorm = 2.6481, lr_0 = 4.9972e-04
Loss = 1.1235e-01, PNorm = 44.4225, GNorm = 1.0587, lr_0 = 4.8939e-04
Loss = 4.7599e-02, PNorm = 44.4243, GNorm = 1.3952, lr_0 = 4.8837e-04
Validation rmse = 0.125904
Validation mse = 0.015852
Validation r2 = 0.875518
Epoch 19
Loss = 7.9208e-02, PNorm = 44.4383, GNorm = 1.1400, lr_0 = 4.7827e-04
Loss = 1.0878e-01, PNorm = 44.4568, GNorm = 1.9586, lr_0 = 4.6838e-04
Validation rmse = 0.133067
Validation mse = 0.017707
Validation r2 = 0.860952
Epoch 20
Loss = 9.3652e-02, PNorm = 44.4695, GNorm = 3.2741, lr_0 = 4.5870e-04
Validation rmse = 0.127614
Validation mse = 0.016285
Validation r2 = 0.872113
Epoch 21
Loss = 7.0518e-02, PNorm = 44.4867, GNorm = 0.5974, lr_0 = 4.4827e-04
Loss = 9.1949e-02, PNorm = 44.5015, GNorm = 1.0859, lr_0 = 4.3900e-04
Validation rmse = 0.134035
Validation mse = 0.017965
Validation r2 = 0.858921
Epoch 22
Loss = 1.0219e-01, PNorm = 44.5169, GNorm = 2.2979, lr_0 = 4.2993e-04
Loss = 8.7192e-02, PNorm = 44.5310, GNorm = 0.7291, lr_0 = 4.2104e-04
Validation rmse = 0.127012
Validation mse = 0.016132
Validation r2 = 0.873317
Epoch 23
Loss = 6.6298e-02, PNorm = 44.5438, GNorm = 0.9366, lr_0 = 4.1147e-04
Loss = 9.1994e-02, PNorm = 44.5532, GNorm = 1.9963, lr_0 = 4.0296e-04
Validation rmse = 0.124793
Validation mse = 0.015573
Validation r2 = 0.877706
Epoch 24
Loss = 4.8572e-02, PNorm = 44.5649, GNorm = 1.0566, lr_0 = 3.9463e-04
Loss = 7.7879e-02, PNorm = 44.5786, GNorm = 3.0407, lr_0 = 3.8647e-04
Validation rmse = 0.127581
Validation mse = 0.016277
Validation r2 = 0.872179
Epoch 25
Loss = 6.5406e-02, PNorm = 44.5915, GNorm = 0.7891, lr_0 = 3.7769e-04
Loss = 8.7363e-02, PNorm = 44.6045, GNorm = 1.2775, lr_0 = 3.6988e-04
Validation rmse = 0.129993
Validation mse = 0.016898
Validation r2 = 0.867302
Epoch 26
Loss = 9.1410e-02, PNorm = 44.6175, GNorm = 1.9184, lr_0 = 3.6223e-04
Loss = 7.9662e-02, PNorm = 44.6329, GNorm = 1.1706, lr_0 = 3.5474e-04
Validation rmse = 0.131500
Validation mse = 0.017292
Validation r2 = 0.864207
Epoch 27
Loss = 6.9608e-02, PNorm = 44.6441, GNorm = 0.6502, lr_0 = 3.4668e-04
Loss = 7.5997e-02, PNorm = 44.6539, GNorm = 0.5706, lr_0 = 3.3951e-04
Validation rmse = 0.128299
Validation mse = 0.016461
Validation r2 = 0.870737
Epoch 28
Loss = 6.6162e-02, PNorm = 44.6642, GNorm = 1.0957, lr_0 = 3.3249e-04
Loss = 8.7595e-02, PNorm = 44.6777, GNorm = 3.0683, lr_0 = 3.2561e-04
Validation rmse = 0.125476
Validation mse = 0.015744
Validation r2 = 0.876364
Epoch 29
Loss = 1.0122e-01, PNorm = 44.6920, GNorm = 3.1491, lr_0 = 3.1822e-04
Loss = 1.0443e-01, PNorm = 44.7044, GNorm = 3.1391, lr_0 = 3.1164e-04
Validation rmse = 0.128082
Validation mse = 0.016405
Validation r2 = 0.871175
Epoch 30
Loss = 8.1314e-02, PNorm = 44.7167, GNorm = 2.8815, lr_0 = 3.0519e-04
Loss = 7.9760e-02, PNorm = 44.7295, GNorm = 0.8960, lr_0 = 2.9888e-04
Validation rmse = 0.123212
Validation mse = 0.015181
Validation r2 = 0.880785
Epoch 31
Loss = 6.0650e-02, PNorm = 44.7409, GNorm = 1.0590, lr_0 = 2.9209e-04
Loss = 7.9333e-02, PNorm = 44.7501, GNorm = 1.8456, lr_0 = 2.8605e-04
Validation rmse = 0.127811
Validation mse = 0.016336
Validation r2 = 0.871718
Epoch 32
Loss = 7.6223e-02, PNorm = 44.7607, GNorm = 1.2927, lr_0 = 2.8014e-04
Loss = 6.7855e-02, PNorm = 44.7724, GNorm = 0.9010, lr_0 = 2.7434e-04
Validation rmse = 0.127540
Validation mse = 0.016267
Validation r2 = 0.872262
Epoch 33
Loss = 6.9655e-02, PNorm = 44.7815, GNorm = 0.9337, lr_0 = 2.6811e-04
Loss = 6.3020e-02, PNorm = 44.7903, GNorm = 0.9545, lr_0 = 2.6257e-04
Validation rmse = 0.125701
Validation mse = 0.015801
Validation r2 = 0.875919
Epoch 34
Loss = 7.1938e-02, PNorm = 44.7999, GNorm = 0.8060, lr_0 = 2.5714e-04
Loss = 6.6543e-02, PNorm = 44.8083, GNorm = 0.6913, lr_0 = 2.5182e-04
Validation rmse = 0.123517
Validation mse = 0.015256
Validation r2 = 0.880194
Epoch 35
Loss = 6.5577e-02, PNorm = 44.8197, GNorm = 0.8583, lr_0 = 2.4610e-04
Loss = 5.5205e-02, PNorm = 44.8271, GNorm = 0.6952, lr_0 = 2.4101e-04
Validation rmse = 0.124220
Validation mse = 0.015431
Validation r2 = 0.878826
Epoch 36
Loss = 5.8270e-02, PNorm = 44.8339, GNorm = 1.2998, lr_0 = 2.3603e-04
Loss = 6.9179e-02, PNorm = 44.8419, GNorm = 1.0970, lr_0 = 2.3114e-04
Validation rmse = 0.130196
Validation mse = 0.016951
Validation r2 = 0.866887
Epoch 37
Loss = 6.0804e-02, PNorm = 44.8528, GNorm = 0.5843, lr_0 = 2.2589e-04
Loss = 6.5398e-02, PNorm = 44.8609, GNorm = 1.5622, lr_0 = 2.2122e-04
Validation rmse = 0.124812
Validation mse = 0.015578
Validation r2 = 0.877669
Epoch 38
Loss = 6.0523e-02, PNorm = 44.8686, GNorm = 0.6342, lr_0 = 2.1665e-04
Loss = 5.7964e-02, PNorm = 44.8762, GNorm = 0.6750, lr_0 = 2.1217e-04
Loss = 8.6463e-02, PNorm = 44.8769, GNorm = 1.1329, lr_0 = 2.1172e-04
Validation rmse = 0.122962
Validation mse = 0.015120
Validation r2 = 0.881268
Epoch 39
Loss = 6.4853e-02, PNorm = 44.8839, GNorm = 0.6235, lr_0 = 2.0735e-04
Loss = 5.4229e-02, PNorm = 44.8914, GNorm = 1.5499, lr_0 = 2.0306e-04
Validation rmse = 0.125818
Validation mse = 0.015830
Validation r2 = 0.875689
Epoch 40
Loss = 5.5134e-02, PNorm = 44.8989, GNorm = 1.4478, lr_0 = 1.9886e-04
Validation rmse = 0.122451
Validation mse = 0.014994
Validation r2 = 0.882252
Epoch 41
Loss = 3.6160e-02, PNorm = 44.9080, GNorm = 1.0907, lr_0 = 1.9434e-04
Loss = 5.2747e-02, PNorm = 44.9151, GNorm = 0.4833, lr_0 = 1.9032e-04
Validation rmse = 0.123909
Validation mse = 0.015353
Validation r2 = 0.879433
Epoch 42
Loss = 4.2234e-02, PNorm = 44.9211, GNorm = 0.5879, lr_0 = 1.8639e-04
Loss = 5.4354e-02, PNorm = 44.9276, GNorm = 1.6270, lr_0 = 1.8253e-04
Validation rmse = 0.125315
Validation mse = 0.015704
Validation r2 = 0.876680
Epoch 43
Loss = 6.9311e-02, PNorm = 44.9346, GNorm = 0.8954, lr_0 = 1.7839e-04
Loss = 5.4311e-02, PNorm = 44.9424, GNorm = 1.1870, lr_0 = 1.7470e-04
Validation rmse = 0.125600
Validation mse = 0.015775
Validation r2 = 0.876119
Epoch 44
Loss = 5.8381e-02, PNorm = 44.9486, GNorm = 2.1753, lr_0 = 1.7109e-04
Loss = 5.5965e-02, PNorm = 44.9549, GNorm = 0.9772, lr_0 = 1.6755e-04
Validation rmse = 0.124552
Validation mse = 0.015513
Validation r2 = 0.878178
Epoch 45
Loss = 5.5388e-02, PNorm = 44.9604, GNorm = 1.0581, lr_0 = 1.6374e-04
Loss = 5.4651e-02, PNorm = 44.9658, GNorm = 0.8497, lr_0 = 1.6035e-04
Validation rmse = 0.123810
Validation mse = 0.015329
Validation r2 = 0.879624
Epoch 46
Loss = 3.8072e-02, PNorm = 44.9713, GNorm = 0.9468, lr_0 = 1.5704e-04
Loss = 5.5332e-02, PNorm = 44.9775, GNorm = 1.3461, lr_0 = 1.5379e-04
Validation rmse = 0.123609
Validation mse = 0.015279
Validation r2 = 0.880015
Epoch 47
Loss = 4.7270e-02, PNorm = 44.9835, GNorm = 2.3042, lr_0 = 1.5030e-04
Loss = 4.8595e-02, PNorm = 44.9889, GNorm = 1.4031, lr_0 = 1.4719e-04
Validation rmse = 0.125314
Validation mse = 0.015704
Validation r2 = 0.876683
Epoch 48
Loss = 4.7352e-02, PNorm = 44.9943, GNorm = 0.5412, lr_0 = 1.4415e-04
Loss = 5.0479e-02, PNorm = 45.0004, GNorm = 1.8364, lr_0 = 1.4117e-04
Validation rmse = 0.122980
Validation mse = 0.015124
Validation r2 = 0.881234
Epoch 49
Loss = 4.1449e-02, PNorm = 45.0057, GNorm = 1.1902, lr_0 = 1.3796e-04
Loss = 5.3744e-02, PNorm = 45.0114, GNorm = 0.9824, lr_0 = 1.3511e-04
Validation rmse = 0.123358
Validation mse = 0.015217
Validation r2 = 0.880502
Epoch 50
Loss = 4.1679e-02, PNorm = 45.0169, GNorm = 1.4388, lr_0 = 1.3231e-04
Loss = 4.7871e-02, PNorm = 45.0220, GNorm = 1.2808, lr_0 = 1.2958e-04
Validation rmse = 0.121455
Validation mse = 0.014751
Validation r2 = 0.884160
Epoch 51
Loss = 4.8033e-02, PNorm = 45.0269, GNorm = 0.6762, lr_0 = 1.2663e-04
Loss = 4.1405e-02, PNorm = 45.0317, GNorm = 1.0359, lr_0 = 1.2401e-04
Validation rmse = 0.123161
Validation mse = 0.015169
Validation r2 = 0.880883
Epoch 52
Loss = 3.8694e-02, PNorm = 45.0361, GNorm = 0.6738, lr_0 = 1.2145e-04
Loss = 4.6898e-02, PNorm = 45.0411, GNorm = 1.5255, lr_0 = 1.1894e-04
Validation rmse = 0.124477
Validation mse = 0.015494
Validation r2 = 0.878325
Epoch 53
Loss = 4.6379e-02, PNorm = 45.0457, GNorm = 1.2616, lr_0 = 1.1623e-04
Loss = 4.2822e-02, PNorm = 45.0505, GNorm = 1.5095, lr_0 = 1.1383e-04
Validation rmse = 0.123428
Validation mse = 0.015234
Validation r2 = 0.880366
Epoch 54
Loss = 3.8714e-02, PNorm = 45.0543, GNorm = 0.8157, lr_0 = 1.1148e-04
Loss = 4.4583e-02, PNorm = 45.0586, GNorm = 1.4011, lr_0 = 1.0917e-04
Validation rmse = 0.122374
Validation mse = 0.014975
Validation r2 = 0.882400
Epoch 55
Loss = 3.8828e-02, PNorm = 45.0641, GNorm = 1.2511, lr_0 = 1.0669e-04
Loss = 4.6621e-02, PNorm = 45.0679, GNorm = 1.4273, lr_0 = 1.0449e-04
Validation rmse = 0.122356
Validation mse = 0.014971
Validation r2 = 0.882436
Epoch 56
Loss = 3.7315e-02, PNorm = 45.0722, GNorm = 0.7638, lr_0 = 1.0233e-04
Loss = 3.9482e-02, PNorm = 45.0756, GNorm = 0.8804, lr_0 = 1.0021e-04
Validation rmse = 0.123671
Validation mse = 0.015295
Validation r2 = 0.879894
Epoch 57
Loss = 3.6923e-02, PNorm = 45.0797, GNorm = 1.4843, lr_0 = 1.0000e-04
Loss = 4.6607e-02, PNorm = 45.0828, GNorm = 0.9339, lr_0 = 1.0000e-04
Validation rmse = 0.123726
Validation mse = 0.015308
Validation r2 = 0.879787
Epoch 58
Loss = 3.7285e-02, PNorm = 45.0860, GNorm = 1.7416, lr_0 = 1.0000e-04
Loss = 4.2651e-02, PNorm = 45.0897, GNorm = 1.3643, lr_0 = 1.0000e-04
Loss = 6.4348e-02, PNorm = 45.0902, GNorm = 0.8295, lr_0 = 1.0000e-04
Validation rmse = 0.122226
Validation mse = 0.014939
Validation r2 = 0.882685
Epoch 59
Loss = 3.2263e-02, PNorm = 45.0943, GNorm = 0.7973, lr_0 = 1.0000e-04
Loss = 4.4524e-02, PNorm = 45.0984, GNorm = 2.1228, lr_0 = 1.0000e-04
Validation rmse = 0.122378
Validation mse = 0.014976
Validation r2 = 0.882393
Model 0 best validation rmse = 0.121455 on epoch 50
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.137479
Model 0 test mse = 0.018900
Model 0 test r2 = 0.841504
Ensemble test rmse = 0.137479
Ensemble test mse = 0.018900
Ensemble test r2 = 0.841504
Fold 3
Splitting data with seed 3
Total size = 1,041 | train size = 624 | val size = 208 | test size = 209
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 1.0801e+00, PNorm = 43.2598, GNorm = 5.7625, lr_0 = 3.6053e-04
Validation rmse = 0.335747
Validation mse = 0.112726
Validation r2 = 0.142061
Epoch 1
Loss = 9.4122e-01, PNorm = 43.2775, GNorm = 3.2533, lr_0 = 6.2105e-04
Loss = 7.7014e-01, PNorm = 43.3184, GNorm = 13.7538, lr_0 = 8.5789e-04
Validation rmse = 0.255385
Validation mse = 0.065221
Validation r2 = 0.503612
Epoch 2
Loss = 3.1569e-01, PNorm = 43.3804, GNorm = 1.1941, lr_0 = 9.9168e-04
Loss = 5.3243e-01, PNorm = 43.4521, GNorm = 4.5197, lr_0 = 9.7117e-04
Validation rmse = 0.269122
Validation mse = 0.072426
Validation r2 = 0.448775
Epoch 3
Loss = 2.6322e-01, PNorm = 43.5352, GNorm = 1.5627, lr_0 = 9.4910e-04
Loss = 4.4013e-01, PNorm = 43.6055, GNorm = 2.2849, lr_0 = 9.2948e-04
Validation rmse = 0.193660
Validation mse = 0.037504
Validation r2 = 0.714562
Epoch 4
Loss = 2.1623e-01, PNorm = 43.6705, GNorm = 3.6060, lr_0 = 9.1026e-04
Loss = 3.8941e-01, PNorm = 43.7187, GNorm = 3.4894, lr_0 = 8.9144e-04
Validation rmse = 0.193840
Validation mse = 0.037574
Validation r2 = 0.714031
Epoch 5
Loss = 2.9423e-01, PNorm = 43.7705, GNorm = 2.5402, lr_0 = 8.7118e-04
Loss = 2.9480e-01, PNorm = 43.8214, GNorm = 2.4473, lr_0 = 8.5317e-04
Validation rmse = 0.188795
Validation mse = 0.035644
Validation r2 = 0.728723
Epoch 6
Loss = 2.2622e-01, PNorm = 43.8646, GNorm = 1.7363, lr_0 = 8.3553e-04
Loss = 2.2483e-01, PNorm = 43.9028, GNorm = 5.1061, lr_0 = 8.1825e-04
Validation rmse = 0.166702
Validation mse = 0.027790
Validation r2 = 0.788498
Epoch 7
Loss = 1.1092e-01, PNorm = 43.9303, GNorm = 1.8199, lr_0 = 7.9966e-04
Loss = 1.8675e-01, PNorm = 43.9550, GNorm = 3.3157, lr_0 = 7.8312e-04
Validation rmse = 0.159833
Validation mse = 0.025546
Validation r2 = 0.805570
Epoch 8
Loss = 1.8595e-01, PNorm = 43.9897, GNorm = 2.2811, lr_0 = 7.6693e-04
Loss = 1.4515e-01, PNorm = 44.0189, GNorm = 1.5905, lr_0 = 7.5107e-04
Validation rmse = 0.157087
Validation mse = 0.024676
Validation r2 = 0.812193
Epoch 9
Loss = 1.6166e-01, PNorm = 44.0451, GNorm = 1.1025, lr_0 = 7.3400e-04
Loss = 1.9961e-01, PNorm = 44.0710, GNorm = 2.7894, lr_0 = 7.1883e-04
Validation rmse = 0.160234
Validation mse = 0.025675
Validation r2 = 0.804592
Epoch 10
Loss = 1.8898e-01, PNorm = 44.0998, GNorm = 2.7351, lr_0 = 7.0396e-04
Loss = 1.5439e-01, PNorm = 44.1208, GNorm = 1.3243, lr_0 = 6.8941e-04
Validation rmse = 0.161442
Validation mse = 0.026063
Validation r2 = 0.801635
Epoch 11
Loss = 1.5981e-01, PNorm = 44.1459, GNorm = 0.8881, lr_0 = 6.7374e-04
Loss = 1.4147e-01, PNorm = 44.1689, GNorm = 4.1592, lr_0 = 6.5981e-04
Validation rmse = 0.204926
Validation mse = 0.041995
Validation r2 = 0.680387
Epoch 12
Loss = 1.6783e-01, PNorm = 44.1857, GNorm = 4.9077, lr_0 = 6.4617e-04
Loss = 1.7911e-01, PNorm = 44.2155, GNorm = 1.2386, lr_0 = 6.3281e-04
Validation rmse = 0.154987
Validation mse = 0.024021
Validation r2 = 0.817180
Epoch 13
Loss = 1.2989e-01, PNorm = 44.2392, GNorm = 2.8973, lr_0 = 6.1843e-04
Loss = 1.4446e-01, PNorm = 44.2552, GNorm = 1.4102, lr_0 = 6.0564e-04
Validation rmse = 0.162416
Validation mse = 0.026379
Validation r2 = 0.799233
Epoch 14
Loss = 1.5014e-01, PNorm = 44.2763, GNorm = 0.7194, lr_0 = 5.9312e-04
Loss = 1.4229e-01, PNorm = 44.2926, GNorm = 1.2539, lr_0 = 5.8085e-04
Validation rmse = 0.146769
Validation mse = 0.021541
Validation r2 = 0.836055
Epoch 15
Loss = 1.0760e-01, PNorm = 44.3068, GNorm = 3.4472, lr_0 = 5.6765e-04
Loss = 1.6630e-01, PNorm = 44.3285, GNorm = 1.3163, lr_0 = 5.5592e-04
Validation rmse = 0.156454
Validation mse = 0.024478
Validation r2 = 0.813704
Epoch 16
Loss = 1.2790e-01, PNorm = 44.3476, GNorm = 1.8502, lr_0 = 5.4442e-04
Loss = 1.1598e-01, PNorm = 44.3628, GNorm = 0.9394, lr_0 = 5.3316e-04
Validation rmse = 0.147214
Validation mse = 0.021672
Validation r2 = 0.835057
Epoch 17
Loss = 1.2334e-01, PNorm = 44.3807, GNorm = 2.2775, lr_0 = 5.2105e-04
Loss = 1.2150e-01, PNorm = 44.3986, GNorm = 2.0606, lr_0 = 5.1027e-04
Validation rmse = 0.146798
Validation mse = 0.021550
Validation r2 = 0.835989
Epoch 18
Loss = 1.0353e-01, PNorm = 44.4117, GNorm = 1.7852, lr_0 = 4.9972e-04
Loss = 1.1691e-01, PNorm = 44.4241, GNorm = 0.7490, lr_0 = 4.8939e-04
Loss = 9.1814e-02, PNorm = 44.4256, GNorm = 1.2693, lr_0 = 4.8837e-04
Validation rmse = 0.145776
Validation mse = 0.021251
Validation r2 = 0.838265
Epoch 19
Loss = 1.0689e-01, PNorm = 44.4368, GNorm = 0.9172, lr_0 = 4.7827e-04
Loss = 9.3990e-02, PNorm = 44.4538, GNorm = 0.6332, lr_0 = 4.6838e-04
Validation rmse = 0.146079
Validation mse = 0.021339
Validation r2 = 0.837592
Epoch 20
Loss = 1.0521e-01, PNorm = 44.4650, GNorm = 2.1184, lr_0 = 4.5870e-04
Validation rmse = 0.148448
Validation mse = 0.022037
Validation r2 = 0.832282
Epoch 21
Loss = 1.3307e-01, PNorm = 44.4783, GNorm = 1.4526, lr_0 = 4.4827e-04
Loss = 1.0607e-01, PNorm = 44.4913, GNorm = 2.6492, lr_0 = 4.3900e-04
Validation rmse = 0.143063
Validation mse = 0.020467
Validation r2 = 0.844228
Epoch 22
Loss = 1.1857e-01, PNorm = 44.5063, GNorm = 1.1407, lr_0 = 4.2993e-04
Loss = 7.9761e-02, PNorm = 44.5186, GNorm = 0.9851, lr_0 = 4.2104e-04
Validation rmse = 0.142474
Validation mse = 0.020299
Validation r2 = 0.845509
Epoch 23
Loss = 8.7973e-02, PNorm = 44.5309, GNorm = 1.2225, lr_0 = 4.1147e-04
Loss = 9.3570e-02, PNorm = 44.5433, GNorm = 0.8729, lr_0 = 4.0296e-04
Validation rmse = 0.142213
Validation mse = 0.020225
Validation r2 = 0.846074
Epoch 24
Loss = 1.4302e-01, PNorm = 44.5549, GNorm = 1.6883, lr_0 = 3.9463e-04
Loss = 8.3641e-02, PNorm = 44.5662, GNorm = 1.7370, lr_0 = 3.8647e-04
Validation rmse = 0.148843
Validation mse = 0.022154
Validation r2 = 0.831388
Epoch 25
Loss = 1.0644e-01, PNorm = 44.5822, GNorm = 3.0167, lr_0 = 3.7769e-04
Loss = 9.1716e-02, PNorm = 44.5933, GNorm = 1.5424, lr_0 = 3.6988e-04
Validation rmse = 0.142270
Validation mse = 0.020241
Validation r2 = 0.845951
Epoch 26
Loss = 8.3427e-02, PNorm = 44.6057, GNorm = 1.1789, lr_0 = 3.6223e-04
Loss = 8.2569e-02, PNorm = 44.6197, GNorm = 0.6449, lr_0 = 3.5474e-04
Validation rmse = 0.143229
Validation mse = 0.020514
Validation r2 = 0.843868
Epoch 27
Loss = 7.6944e-02, PNorm = 44.6322, GNorm = 1.0571, lr_0 = 3.4668e-04
Loss = 9.4098e-02, PNorm = 44.6443, GNorm = 1.0383, lr_0 = 3.3951e-04
Validation rmse = 0.144859
Validation mse = 0.020984
Validation r2 = 0.840294
Epoch 28
Loss = 8.4037e-02, PNorm = 44.6543, GNorm = 1.1254, lr_0 = 3.3249e-04
Loss = 8.7151e-02, PNorm = 44.6661, GNorm = 1.2792, lr_0 = 3.2561e-04
Validation rmse = 0.144890
Validation mse = 0.020993
Validation r2 = 0.840225
Epoch 29
Loss = 8.1461e-02, PNorm = 44.6780, GNorm = 1.0603, lr_0 = 3.1822e-04
Loss = 8.4021e-02, PNorm = 44.6891, GNorm = 1.0489, lr_0 = 3.1164e-04
Validation rmse = 0.148504
Validation mse = 0.022053
Validation r2 = 0.832155
Epoch 30
Loss = 8.8517e-02, PNorm = 44.7025, GNorm = 2.8234, lr_0 = 3.0519e-04
Loss = 9.3952e-02, PNorm = 44.7122, GNorm = 2.6157, lr_0 = 2.9888e-04
Validation rmse = 0.142236
Validation mse = 0.020231
Validation r2 = 0.846024
Epoch 31
Loss = 8.6367e-02, PNorm = 44.7245, GNorm = 1.2867, lr_0 = 2.9209e-04
Loss = 8.3130e-02, PNorm = 44.7341, GNorm = 3.1115, lr_0 = 2.8605e-04
Validation rmse = 0.145016
Validation mse = 0.021030
Validation r2 = 0.839947
Epoch 32
Loss = 9.3365e-02, PNorm = 44.7461, GNorm = 3.7666, lr_0 = 2.8014e-04
Loss = 8.8018e-02, PNorm = 44.7577, GNorm = 3.7173, lr_0 = 2.7434e-04
Validation rmse = 0.140208
Validation mse = 0.019658
Validation r2 = 0.850384
Epoch 33
Loss = 7.8262e-02, PNorm = 44.7681, GNorm = 1.0055, lr_0 = 2.6811e-04
Loss = 8.1559e-02, PNorm = 44.7756, GNorm = 0.6570, lr_0 = 2.6257e-04
Validation rmse = 0.142018
Validation mse = 0.020169
Validation r2 = 0.846496
Epoch 34
Loss = 6.0692e-02, PNorm = 44.7853, GNorm = 0.9907, lr_0 = 2.5714e-04
Loss = 7.8476e-02, PNorm = 44.7946, GNorm = 1.9577, lr_0 = 2.5182e-04
Validation rmse = 0.145122
Validation mse = 0.021060
Validation r2 = 0.839712
Epoch 35
Loss = 8.3595e-02, PNorm = 44.8032, GNorm = 0.6844, lr_0 = 2.4610e-04
Loss = 6.0300e-02, PNorm = 44.8109, GNorm = 1.9587, lr_0 = 2.4101e-04
Validation rmse = 0.148262
Validation mse = 0.021982
Validation r2 = 0.832701
Epoch 36
Loss = 8.4199e-02, PNorm = 44.8174, GNorm = 2.6147, lr_0 = 2.3603e-04
Loss = 7.5763e-02, PNorm = 44.8262, GNorm = 1.9810, lr_0 = 2.3114e-04
Validation rmse = 0.143840
Validation mse = 0.020690
Validation r2 = 0.842532
Epoch 37
Loss = 6.7173e-02, PNorm = 44.8338, GNorm = 0.8490, lr_0 = 2.2589e-04
Loss = 6.8567e-02, PNorm = 44.8405, GNorm = 1.0912, lr_0 = 2.2122e-04
Validation rmse = 0.146909
Validation mse = 0.021582
Validation r2 = 0.835742
Epoch 38
Loss = 5.6333e-02, PNorm = 44.8483, GNorm = 0.7488, lr_0 = 2.1665e-04
Loss = 7.4947e-02, PNorm = 44.8558, GNorm = 1.6199, lr_0 = 2.1217e-04
Loss = 1.0891e-01, PNorm = 44.8566, GNorm = 1.4261, lr_0 = 2.1172e-04
Validation rmse = 0.140437
Validation mse = 0.019722
Validation r2 = 0.849896
Epoch 39
Loss = 6.6024e-02, PNorm = 44.8631, GNorm = 1.2402, lr_0 = 2.0735e-04
Loss = 6.8672e-02, PNorm = 44.8709, GNorm = 0.2441, lr_0 = 2.0306e-04
Validation rmse = 0.144196
Validation mse = 0.020793
Validation r2 = 0.841752
Epoch 40
Loss = 6.8859e-02, PNorm = 44.8789, GNorm = 2.6871, lr_0 = 1.9886e-04
Validation rmse = 0.141295
Validation mse = 0.019964
Validation r2 = 0.848055
Epoch 41
Loss = 6.9741e-02, PNorm = 44.8856, GNorm = 1.5757, lr_0 = 1.9434e-04
Loss = 5.8521e-02, PNorm = 44.8917, GNorm = 2.0702, lr_0 = 1.9032e-04
Validation rmse = 0.142229
Validation mse = 0.020229
Validation r2 = 0.846040
Epoch 42
Loss = 3.2731e-02, PNorm = 44.8980, GNorm = 0.5400, lr_0 = 1.8639e-04
Loss = 6.8372e-02, PNorm = 44.9035, GNorm = 1.2027, lr_0 = 1.8253e-04
Validation rmse = 0.141355
Validation mse = 0.019981
Validation r2 = 0.847927
Epoch 43
Loss = 5.3246e-02, PNorm = 44.9114, GNorm = 1.5016, lr_0 = 1.7839e-04
Loss = 6.3587e-02, PNorm = 44.9172, GNorm = 1.8343, lr_0 = 1.7470e-04
Validation rmse = 0.142138
Validation mse = 0.020203
Validation r2 = 0.846237
Epoch 44
Loss = 7.2629e-02, PNorm = 44.9240, GNorm = 0.8401, lr_0 = 1.7109e-04
Loss = 5.6579e-02, PNorm = 44.9315, GNorm = 0.8548, lr_0 = 1.6755e-04
Validation rmse = 0.142620
Validation mse = 0.020340
Validation r2 = 0.845193
Epoch 45
Loss = 4.8915e-02, PNorm = 44.9375, GNorm = 1.4349, lr_0 = 1.6374e-04
Loss = 5.5957e-02, PNorm = 44.9438, GNorm = 0.6092, lr_0 = 1.6035e-04
Validation rmse = 0.143989
Validation mse = 0.020733
Validation r2 = 0.842207
Epoch 46
Loss = 4.9332e-02, PNorm = 44.9507, GNorm = 0.7010, lr_0 = 1.5704e-04
Loss = 5.8587e-02, PNorm = 44.9553, GNorm = 0.5802, lr_0 = 1.5379e-04
Validation rmse = 0.142700
Validation mse = 0.020363
Validation r2 = 0.845019
Epoch 47
Loss = 5.1042e-02, PNorm = 44.9619, GNorm = 1.0111, lr_0 = 1.5030e-04
Loss = 6.1205e-02, PNorm = 44.9666, GNorm = 0.9982, lr_0 = 1.4719e-04
Validation rmse = 0.141351
Validation mse = 0.019980
Validation r2 = 0.847935
Epoch 48
Loss = 6.8048e-02, PNorm = 44.9726, GNorm = 0.8444, lr_0 = 1.4415e-04
Loss = 5.1054e-02, PNorm = 44.9773, GNorm = 0.6084, lr_0 = 1.4117e-04
Validation rmse = 0.142396
Validation mse = 0.020276
Validation r2 = 0.845679
Epoch 49
Loss = 4.4885e-02, PNorm = 44.9838, GNorm = 0.6613, lr_0 = 1.3796e-04
Loss = 5.0395e-02, PNorm = 44.9886, GNorm = 0.4854, lr_0 = 1.3511e-04
Validation rmse = 0.141113
Validation mse = 0.019913
Validation r2 = 0.848446
Epoch 50
Loss = 4.9664e-02, PNorm = 44.9941, GNorm = 0.6283, lr_0 = 1.3231e-04
Loss = 5.0641e-02, PNorm = 44.9991, GNorm = 1.8920, lr_0 = 1.2958e-04
Validation rmse = 0.143480
Validation mse = 0.020587
Validation r2 = 0.843319
Epoch 51
Loss = 4.5466e-02, PNorm = 45.0042, GNorm = 0.8673, lr_0 = 1.2663e-04
Loss = 5.8491e-02, PNorm = 45.0089, GNorm = 2.4348, lr_0 = 1.2401e-04
Validation rmse = 0.143836
Validation mse = 0.020689
Validation r2 = 0.842542
Epoch 52
Loss = 5.3955e-02, PNorm = 45.0135, GNorm = 0.5942, lr_0 = 1.2145e-04
Loss = 5.0865e-02, PNorm = 45.0185, GNorm = 1.1751, lr_0 = 1.1894e-04
Validation rmse = 0.143832
Validation mse = 0.020688
Validation r2 = 0.842549
Epoch 53
Loss = 5.0758e-02, PNorm = 45.0233, GNorm = 1.4649, lr_0 = 1.1623e-04
Loss = 4.2632e-02, PNorm = 45.0272, GNorm = 0.7544, lr_0 = 1.1383e-04
Validation rmse = 0.139991
Validation mse = 0.019598
Validation r2 = 0.850846
Epoch 54
Loss = 4.5346e-02, PNorm = 45.0309, GNorm = 2.0315, lr_0 = 1.1148e-04
Loss = 5.2441e-02, PNorm = 45.0358, GNorm = 2.2481, lr_0 = 1.0917e-04
Validation rmse = 0.144304
Validation mse = 0.020824
Validation r2 = 0.841514
Epoch 55
Loss = 4.3006e-02, PNorm = 45.0409, GNorm = 2.0648, lr_0 = 1.0669e-04
Loss = 4.9845e-02, PNorm = 45.0447, GNorm = 1.1367, lr_0 = 1.0449e-04
Validation rmse = 0.143036
Validation mse = 0.020459
Validation r2 = 0.844287
Epoch 56
Loss = 4.3746e-02, PNorm = 45.0487, GNorm = 0.6374, lr_0 = 1.0233e-04
Loss = 4.9969e-02, PNorm = 45.0525, GNorm = 1.0366, lr_0 = 1.0021e-04
Validation rmse = 0.142890
Validation mse = 0.020417
Validation r2 = 0.844606
Epoch 57
Loss = 5.0164e-02, PNorm = 45.0573, GNorm = 0.7991, lr_0 = 1.0000e-04
Loss = 4.3841e-02, PNorm = 45.0610, GNorm = 1.9710, lr_0 = 1.0000e-04
Validation rmse = 0.142327
Validation mse = 0.020257
Validation r2 = 0.845829
Epoch 58
Loss = 4.2113e-02, PNorm = 45.0646, GNorm = 1.5607, lr_0 = 1.0000e-04
Loss = 4.9073e-02, PNorm = 45.0686, GNorm = 1.0043, lr_0 = 1.0000e-04
Loss = 3.1710e-02, PNorm = 45.0689, GNorm = 0.6942, lr_0 = 1.0000e-04
Validation rmse = 0.140035
Validation mse = 0.019610
Validation r2 = 0.850754
Epoch 59
Loss = 3.8960e-02, PNorm = 45.0729, GNorm = 0.7501, lr_0 = 1.0000e-04
Loss = 4.8312e-02, PNorm = 45.0764, GNorm = 0.4737, lr_0 = 1.0000e-04
Validation rmse = 0.142230
Validation mse = 0.020229
Validation r2 = 0.846037
Model 0 best validation rmse = 0.139991 on epoch 53
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.129478
Model 0 test mse = 0.016765
Model 0 test r2 = 0.873194
Ensemble test rmse = 0.129478
Ensemble test mse = 0.016765
Ensemble test r2 = 0.873194
Fold 4
Splitting data with seed 4
Total size = 1,041 | train size = 624 | val size = 208 | test size = 209
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.8945e-01, PNorm = 43.2633, GNorm = 3.6915, lr_0 = 3.6053e-04
Validation rmse = 0.285477
Validation mse = 0.081497
Validation r2 = 0.269171
Epoch 1
Loss = 6.8330e-01, PNorm = 43.2844, GNorm = 3.7748, lr_0 = 6.2105e-04
Loss = 6.8005e-01, PNorm = 43.3239, GNorm = 7.0275, lr_0 = 8.5789e-04
Validation rmse = 0.255868
Validation mse = 0.065468
Validation r2 = 0.412910
Epoch 2
Loss = 3.8529e-01, PNorm = 43.3867, GNorm = 3.7603, lr_0 = 9.9168e-04
Loss = 5.3608e-01, PNorm = 43.4601, GNorm = 1.6555, lr_0 = 9.7117e-04
Validation rmse = 0.259316
Validation mse = 0.067245
Validation r2 = 0.396981
Epoch 3
Loss = 6.8707e-01, PNorm = 43.5407, GNorm = 11.9438, lr_0 = 9.4910e-04
Loss = 5.1733e-01, PNorm = 43.6136, GNorm = 3.2745, lr_0 = 9.2948e-04
Validation rmse = 0.221403
Validation mse = 0.049019
Validation r2 = 0.560416
Epoch 4
Loss = 3.2022e-01, PNorm = 43.6796, GNorm = 1.5032, lr_0 = 9.1026e-04
Loss = 2.7160e-01, PNorm = 43.7445, GNorm = 2.7637, lr_0 = 8.9144e-04
Validation rmse = 0.193736
Validation mse = 0.037534
Validation r2 = 0.663416
Epoch 5
Loss = 2.5637e-01, PNorm = 43.8107, GNorm = 1.6007, lr_0 = 8.7118e-04
Loss = 2.3701e-01, PNorm = 43.8577, GNorm = 0.8758, lr_0 = 8.5317e-04
Validation rmse = 0.170380
Validation mse = 0.029029
Validation r2 = 0.739677
Epoch 6
Loss = 1.6664e-01, PNorm = 43.8918, GNorm = 4.3931, lr_0 = 8.3553e-04
Loss = 2.0947e-01, PNorm = 43.9274, GNorm = 4.1420, lr_0 = 8.1825e-04
Validation rmse = 0.165894
Validation mse = 0.027521
Validation r2 = 0.753207
Epoch 7
Loss = 1.5952e-01, PNorm = 43.9670, GNorm = 3.3829, lr_0 = 7.9966e-04
Loss = 2.1944e-01, PNorm = 43.9925, GNorm = 0.8927, lr_0 = 7.8312e-04
Validation rmse = 0.193831
Validation mse = 0.037570
Validation r2 = 0.663087
Epoch 8
Loss = 1.7479e-01, PNorm = 44.0217, GNorm = 1.0491, lr_0 = 7.6693e-04
Loss = 1.6079e-01, PNorm = 44.0466, GNorm = 1.8833, lr_0 = 7.5107e-04
Validation rmse = 0.160400
Validation mse = 0.025728
Validation r2 = 0.769281
Epoch 9
Loss = 1.4710e-01, PNorm = 44.0689, GNorm = 4.2101, lr_0 = 7.3400e-04
Loss = 1.3533e-01, PNorm = 44.0934, GNorm = 2.0975, lr_0 = 7.1883e-04
Validation rmse = 0.153369
Validation mse = 0.023522
Validation r2 = 0.789066
Epoch 10
Loss = 1.1461e-01, PNorm = 44.1118, GNorm = 1.7165, lr_0 = 7.0396e-04
Loss = 1.3261e-01, PNorm = 44.1294, GNorm = 2.1025, lr_0 = 6.8941e-04
Validation rmse = 0.154893
Validation mse = 0.023992
Validation r2 = 0.784852
Epoch 11
Loss = 1.5509e-01, PNorm = 44.1562, GNorm = 0.9204, lr_0 = 6.7374e-04
Loss = 1.2847e-01, PNorm = 44.1634, GNorm = 1.4435, lr_0 = 6.5981e-04
Validation rmse = 0.158467
Validation mse = 0.025112
Validation r2 = 0.774809
Epoch 12
Loss = 1.2864e-01, PNorm = 44.1835, GNorm = 1.2129, lr_0 = 6.4617e-04
Loss = 1.3955e-01, PNorm = 44.2033, GNorm = 2.1483, lr_0 = 6.3281e-04
Validation rmse = 0.176968
Validation mse = 0.031318
Validation r2 = 0.719159
Epoch 13
Loss = 1.3560e-01, PNorm = 44.2181, GNorm = 1.9059, lr_0 = 6.1843e-04
Loss = 1.2572e-01, PNorm = 44.2322, GNorm = 2.7670, lr_0 = 6.0564e-04
Validation rmse = 0.162218
Validation mse = 0.026315
Validation r2 = 0.764022
Epoch 14
Loss = 1.2054e-01, PNorm = 44.2494, GNorm = 0.5382, lr_0 = 5.9312e-04
Loss = 1.1603e-01, PNorm = 44.2661, GNorm = 4.6099, lr_0 = 5.8085e-04
Validation rmse = 0.170377
Validation mse = 0.029028
Validation r2 = 0.739688
Epoch 15
Loss = 1.0687e-01, PNorm = 44.2795, GNorm = 2.4435, lr_0 = 5.6765e-04
Loss = 1.1515e-01, PNorm = 44.2945, GNorm = 1.4934, lr_0 = 5.5592e-04
Validation rmse = 0.165458
Validation mse = 0.027376
Validation r2 = 0.754501
Epoch 16
Loss = 1.2445e-01, PNorm = 44.3070, GNorm = 2.0961, lr_0 = 5.4442e-04
Loss = 1.2810e-01, PNorm = 44.3286, GNorm = 2.7528, lr_0 = 5.3316e-04
Validation rmse = 0.153544
Validation mse = 0.023576
Validation r2 = 0.788583
Epoch 17
Loss = 1.0669e-01, PNorm = 44.3484, GNorm = 0.8830, lr_0 = 5.2105e-04
Loss = 8.6115e-02, PNorm = 44.3621, GNorm = 1.5717, lr_0 = 5.1027e-04
Validation rmse = 0.150006
Validation mse = 0.022502
Validation r2 = 0.798215
Epoch 18
Loss = 9.1597e-02, PNorm = 44.3688, GNorm = 1.4507, lr_0 = 4.9972e-04
Loss = 9.2556e-02, PNorm = 44.3807, GNorm = 1.3725, lr_0 = 4.8939e-04
Loss = 1.1905e-01, PNorm = 44.3818, GNorm = 3.7419, lr_0 = 4.8837e-04
Validation rmse = 0.149331
Validation mse = 0.022300
Validation r2 = 0.800027
Epoch 19
Loss = 8.9879e-02, PNorm = 44.3894, GNorm = 0.8034, lr_0 = 4.7827e-04
Loss = 8.8043e-02, PNorm = 44.4003, GNorm = 0.5083, lr_0 = 4.6838e-04
Validation rmse = 0.147019
Validation mse = 0.021615
Validation r2 = 0.806170
Epoch 20
Loss = 7.4981e-02, PNorm = 44.4089, GNorm = 1.0461, lr_0 = 4.5870e-04
Validation rmse = 0.144806
Validation mse = 0.020969
Validation r2 = 0.811961
Epoch 21
Loss = 1.0647e-01, PNorm = 44.4207, GNorm = 1.1168, lr_0 = 4.4827e-04
Loss = 8.5114e-02, PNorm = 44.4328, GNorm = 0.9499, lr_0 = 4.3900e-04
Validation rmse = 0.152199
Validation mse = 0.023164
Validation r2 = 0.792272
Epoch 22
Loss = 7.9364e-02, PNorm = 44.4407, GNorm = 1.0960, lr_0 = 4.2993e-04
Loss = 8.5854e-02, PNorm = 44.4496, GNorm = 0.8541, lr_0 = 4.2104e-04
Validation rmse = 0.148222
Validation mse = 0.021970
Validation r2 = 0.802985
Epoch 23
Loss = 6.4472e-02, PNorm = 44.4618, GNorm = 1.3140, lr_0 = 4.1147e-04
Loss = 8.2587e-02, PNorm = 44.4692, GNorm = 1.1347, lr_0 = 4.0296e-04
Validation rmse = 0.156990
Validation mse = 0.024646
Validation r2 = 0.778987
Epoch 24
Loss = 7.2347e-02, PNorm = 44.4796, GNorm = 1.5965, lr_0 = 3.9463e-04
Loss = 8.0981e-02, PNorm = 44.4895, GNorm = 1.8997, lr_0 = 3.8647e-04
Validation rmse = 0.147049
Validation mse = 0.021624
Validation r2 = 0.806090
Epoch 25
Loss = 6.5416e-02, PNorm = 44.5013, GNorm = 1.4141, lr_0 = 3.7769e-04
Loss = 8.9115e-02, PNorm = 44.5140, GNorm = 2.1053, lr_0 = 3.6988e-04
Validation rmse = 0.148122
Validation mse = 0.021940
Validation r2 = 0.803250
Epoch 26
Loss = 6.1149e-02, PNorm = 44.5230, GNorm = 0.7502, lr_0 = 3.6223e-04
Loss = 7.6584e-02, PNorm = 44.5317, GNorm = 0.7814, lr_0 = 3.5474e-04
Validation rmse = 0.143017
Validation mse = 0.020454
Validation r2 = 0.816579
Epoch 27
Loss = 6.4490e-02, PNorm = 44.5421, GNorm = 1.1036, lr_0 = 3.4668e-04
Loss = 7.4165e-02, PNorm = 44.5508, GNorm = 1.1630, lr_0 = 3.3951e-04
Validation rmse = 0.153675
Validation mse = 0.023616
Validation r2 = 0.788224
Epoch 28
Loss = 8.4306e-02, PNorm = 44.5604, GNorm = 1.1599, lr_0 = 3.3249e-04
Loss = 7.2249e-02, PNorm = 44.5691, GNorm = 1.0883, lr_0 = 3.2561e-04
Validation rmse = 0.162293
Validation mse = 0.026339
Validation r2 = 0.763803
Epoch 29
Loss = 7.9227e-02, PNorm = 44.5785, GNorm = 1.5763, lr_0 = 3.1822e-04
Loss = 8.9573e-02, PNorm = 44.5901, GNorm = 0.8897, lr_0 = 3.1164e-04
Validation rmse = 0.143609
Validation mse = 0.020623
Validation r2 = 0.815059
Epoch 30
Loss = 6.8754e-02, PNorm = 44.6011, GNorm = 0.8861, lr_0 = 3.0519e-04
Loss = 6.6867e-02, PNorm = 44.6100, GNorm = 0.8873, lr_0 = 2.9888e-04
Validation rmse = 0.149025
Validation mse = 0.022208
Validation r2 = 0.800845
Epoch 31
Loss = 6.5068e-02, PNorm = 44.6158, GNorm = 1.0359, lr_0 = 2.9209e-04
Loss = 7.6529e-02, PNorm = 44.6234, GNorm = 1.8172, lr_0 = 2.8605e-04
Validation rmse = 0.140660
Validation mse = 0.019785
Validation r2 = 0.822576
Epoch 32
Loss = 7.9413e-02, PNorm = 44.6314, GNorm = 0.7239, lr_0 = 2.8014e-04
Loss = 5.8690e-02, PNorm = 44.6400, GNorm = 0.8291, lr_0 = 2.7434e-04
Validation rmse = 0.143752
Validation mse = 0.020665
Validation r2 = 0.814690
Epoch 33
Loss = 6.7739e-02, PNorm = 44.6474, GNorm = 2.8970, lr_0 = 2.6811e-04
Loss = 6.8605e-02, PNorm = 44.6530, GNorm = 0.9677, lr_0 = 2.6257e-04
Validation rmse = 0.151067
Validation mse = 0.022821
Validation r2 = 0.795350
Epoch 34
Loss = 6.4412e-02, PNorm = 44.6604, GNorm = 0.7753, lr_0 = 2.5714e-04
Loss = 6.9260e-02, PNorm = 44.6686, GNorm = 0.5477, lr_0 = 2.5182e-04
Validation rmse = 0.146541
Validation mse = 0.021474
Validation r2 = 0.807430
Epoch 35
Loss = 6.5810e-02, PNorm = 44.6746, GNorm = 2.0201, lr_0 = 2.4610e-04
Loss = 6.0154e-02, PNorm = 44.6824, GNorm = 0.7169, lr_0 = 2.4101e-04
Validation rmse = 0.144493
Validation mse = 0.020878
Validation r2 = 0.812773
Epoch 36
Loss = 6.6718e-02, PNorm = 44.6881, GNorm = 1.1644, lr_0 = 2.3603e-04
Loss = 5.9794e-02, PNorm = 44.6953, GNorm = 1.2665, lr_0 = 2.3114e-04
Validation rmse = 0.147449
Validation mse = 0.021741
Validation r2 = 0.805035
Epoch 37
Loss = 6.1044e-02, PNorm = 44.7040, GNorm = 1.0586, lr_0 = 2.2589e-04
Loss = 6.3836e-02, PNorm = 44.7098, GNorm = 1.7759, lr_0 = 2.2122e-04
Validation rmse = 0.141379
Validation mse = 0.019988
Validation r2 = 0.820758
Epoch 38
Loss = 6.0517e-02, PNorm = 44.7171, GNorm = 1.3496, lr_0 = 2.1665e-04
Loss = 5.6390e-02, PNorm = 44.7228, GNorm = 0.9608, lr_0 = 2.1217e-04
Loss = 4.7399e-02, PNorm = 44.7233, GNorm = 0.8602, lr_0 = 2.1172e-04
Validation rmse = 0.151678
Validation mse = 0.023006
Validation r2 = 0.793690
Epoch 39
Loss = 5.6043e-02, PNorm = 44.7282, GNorm = 0.7689, lr_0 = 2.0735e-04
Loss = 7.0366e-02, PNorm = 44.7362, GNorm = 1.3866, lr_0 = 2.0306e-04
Validation rmse = 0.146458
Validation mse = 0.021450
Validation r2 = 0.807648
Epoch 40
Loss = 5.7919e-02, PNorm = 44.7407, GNorm = 0.7911, lr_0 = 1.9886e-04
Validation rmse = 0.147347
Validation mse = 0.021711
Validation r2 = 0.805305
Epoch 41
Loss = 4.7619e-02, PNorm = 44.7470, GNorm = 0.8785, lr_0 = 1.9434e-04
Loss = 5.5189e-02, PNorm = 44.7517, GNorm = 0.7370, lr_0 = 1.9032e-04
Validation rmse = 0.145298
Validation mse = 0.021111
Validation r2 = 0.810682
Epoch 42
Loss = 5.6531e-02, PNorm = 44.7579, GNorm = 1.2909, lr_0 = 1.8639e-04
Loss = 5.6275e-02, PNorm = 44.7627, GNorm = 0.8191, lr_0 = 1.8253e-04
Validation rmse = 0.148602
Validation mse = 0.022083
Validation r2 = 0.801973
Epoch 43
Loss = 4.6544e-02, PNorm = 44.7697, GNorm = 0.7998, lr_0 = 1.7839e-04
Loss = 5.0786e-02, PNorm = 44.7747, GNorm = 0.7647, lr_0 = 1.7470e-04
Validation rmse = 0.142573
Validation mse = 0.020327
Validation r2 = 0.817715
Epoch 44
Loss = 6.6651e-02, PNorm = 44.7794, GNorm = 0.5905, lr_0 = 1.7109e-04
Loss = 5.3689e-02, PNorm = 44.7835, GNorm = 1.4361, lr_0 = 1.6755e-04
Validation rmse = 0.144553
Validation mse = 0.020896
Validation r2 = 0.812617
Epoch 45
Loss = 4.8778e-02, PNorm = 44.7893, GNorm = 0.5015, lr_0 = 1.6374e-04
Loss = 5.5902e-02, PNorm = 44.7947, GNorm = 1.8661, lr_0 = 1.6035e-04
Validation rmse = 0.139842
Validation mse = 0.019556
Validation r2 = 0.824632
Epoch 46
Loss = 5.1355e-02, PNorm = 44.7986, GNorm = 0.8357, lr_0 = 1.5704e-04
Loss = 5.5173e-02, PNorm = 44.8029, GNorm = 2.0694, lr_0 = 1.5379e-04
Validation rmse = 0.141744
Validation mse = 0.020091
Validation r2 = 0.819830
Epoch 47
Loss = 4.5142e-02, PNorm = 44.8084, GNorm = 1.3949, lr_0 = 1.5030e-04
Loss = 5.0892e-02, PNorm = 44.8122, GNorm = 0.6172, lr_0 = 1.4719e-04
Validation rmse = 0.151617
Validation mse = 0.022988
Validation r2 = 0.793856
Epoch 48
Loss = 6.1402e-02, PNorm = 44.8172, GNorm = 0.8451, lr_0 = 1.4415e-04
Loss = 4.8459e-02, PNorm = 44.8224, GNorm = 0.6553, lr_0 = 1.4117e-04
Validation rmse = 0.147562
Validation mse = 0.021774
Validation r2 = 0.804737
Epoch 49
Loss = 5.6078e-02, PNorm = 44.8265, GNorm = 0.3273, lr_0 = 1.3796e-04
Loss = 5.7733e-02, PNorm = 44.8323, GNorm = 1.4255, lr_0 = 1.3511e-04
Validation rmse = 0.158888
Validation mse = 0.025245
Validation r2 = 0.773612
Epoch 50
Loss = 5.6185e-02, PNorm = 44.8370, GNorm = 0.4428, lr_0 = 1.3231e-04
Loss = 5.9992e-02, PNorm = 44.8413, GNorm = 1.8605, lr_0 = 1.2958e-04
Validation rmse = 0.142304
Validation mse = 0.020250
Validation r2 = 0.818404
Epoch 51
Loss = 4.1736e-02, PNorm = 44.8475, GNorm = 0.9090, lr_0 = 1.2663e-04
Loss = 4.8404e-02, PNorm = 44.8523, GNorm = 1.1429, lr_0 = 1.2401e-04
Validation rmse = 0.141430
Validation mse = 0.020002
Validation r2 = 0.820627
Epoch 52
Loss = 5.5357e-02, PNorm = 44.8548, GNorm = 1.1613, lr_0 = 1.2145e-04
Loss = 4.7924e-02, PNorm = 44.8577, GNorm = 2.1160, lr_0 = 1.1894e-04
Validation rmse = 0.143431
Validation mse = 0.020573
Validation r2 = 0.815515
Epoch 53
Loss = 4.8774e-02, PNorm = 44.8616, GNorm = 1.5661, lr_0 = 1.1623e-04
Loss = 4.8729e-02, PNorm = 44.8644, GNorm = 0.5510, lr_0 = 1.1383e-04
Validation rmse = 0.141565
Validation mse = 0.020041
Validation r2 = 0.820286
Epoch 54
Loss = 4.2005e-02, PNorm = 44.8678, GNorm = 1.5096, lr_0 = 1.1148e-04
Loss = 4.9687e-02, PNorm = 44.8708, GNorm = 0.8519, lr_0 = 1.0917e-04
Validation rmse = 0.142309
Validation mse = 0.020252
Validation r2 = 0.818391
Epoch 55
Loss = 4.0719e-02, PNorm = 44.8744, GNorm = 1.3953, lr_0 = 1.0669e-04
Loss = 4.8063e-02, PNorm = 44.8773, GNorm = 0.7243, lr_0 = 1.0449e-04
Validation rmse = 0.140879
Validation mse = 0.019847
Validation r2 = 0.822022
Epoch 56
Loss = 4.2439e-02, PNorm = 44.8802, GNorm = 0.4171, lr_0 = 1.0233e-04
Loss = 5.1460e-02, PNorm = 44.8836, GNorm = 0.7042, lr_0 = 1.0021e-04
Validation rmse = 0.143781
Validation mse = 0.020673
Validation r2 = 0.814614
Epoch 57
Loss = 4.2586e-02, PNorm = 44.8865, GNorm = 0.7911, lr_0 = 1.0000e-04
Loss = 4.8024e-02, PNorm = 44.8890, GNorm = 1.2071, lr_0 = 1.0000e-04
Validation rmse = 0.143257
Validation mse = 0.020523
Validation r2 = 0.815962
Epoch 58
Loss = 4.7681e-02, PNorm = 44.8927, GNorm = 1.0344, lr_0 = 1.0000e-04
Loss = 4.9366e-02, PNorm = 44.8961, GNorm = 1.2653, lr_0 = 1.0000e-04
Loss = 4.6469e-02, PNorm = 44.8964, GNorm = 0.6837, lr_0 = 1.0000e-04
Validation rmse = 0.141673
Validation mse = 0.020071
Validation r2 = 0.820010
Epoch 59
Loss = 4.3543e-02, PNorm = 44.9001, GNorm = 0.6407, lr_0 = 1.0000e-04
Loss = 4.2232e-02, PNorm = 44.9021, GNorm = 0.6648, lr_0 = 1.0000e-04
Validation rmse = 0.143216
Validation mse = 0.020511
Validation r2 = 0.816069
Model 0 best validation rmse = 0.139842 on epoch 45
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.129155
Model 0 test mse = 0.016681
Model 0 test r2 = 0.864614
Ensemble test rmse = 0.129155
Ensemble test mse = 0.016681
Ensemble test r2 = 0.864614
Fold 5
Splitting data with seed 5
Total size = 1,041 | train size = 624 | val size = 208 | test size = 209
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 1.0144e+00, PNorm = 43.2615, GNorm = 6.4036, lr_0 = 3.6053e-04
Validation rmse = 0.376420
Validation mse = 0.141692
Validation r2 = -0.259176
Epoch 1
Loss = 8.9941e-01, PNorm = 43.2842, GNorm = 10.4778, lr_0 = 6.2105e-04
Loss = 7.8069e-01, PNorm = 43.3211, GNorm = 2.8802, lr_0 = 8.5789e-04
Validation rmse = 0.331787
Validation mse = 0.110083
Validation r2 = 0.021728
Epoch 2
Loss = 9.8534e-01, PNorm = 43.3862, GNorm = 11.5719, lr_0 = 9.9168e-04
Loss = 7.3025e-01, PNorm = 43.4696, GNorm = 1.6973, lr_0 = 9.7117e-04
Validation rmse = 0.211598
Validation mse = 0.044774
Validation r2 = 0.602107
Epoch 3
Loss = 4.6448e-01, PNorm = 43.5686, GNorm = 1.3537, lr_0 = 9.4910e-04
Loss = 3.5592e-01, PNorm = 43.6577, GNorm = 3.9577, lr_0 = 9.2948e-04
Validation rmse = 0.171088
Validation mse = 0.029271
Validation r2 = 0.739875
Epoch 4
Loss = 4.0496e-01, PNorm = 43.7271, GNorm = 1.9357, lr_0 = 9.1026e-04
Loss = 2.7468e-01, PNorm = 43.7859, GNorm = 3.8350, lr_0 = 8.9144e-04
Validation rmse = 0.171668
Validation mse = 0.029470
Validation r2 = 0.738109
Epoch 5
Loss = 2.1844e-01, PNorm = 43.8330, GNorm = 1.4377, lr_0 = 8.7118e-04
Loss = 2.3351e-01, PNorm = 43.8743, GNorm = 1.3993, lr_0 = 8.5317e-04
Validation rmse = 0.248768
Validation mse = 0.061886
Validation r2 = 0.450040
Epoch 6
Loss = 3.6511e-01, PNorm = 43.9110, GNorm = 2.8551, lr_0 = 8.3553e-04
Loss = 2.5286e-01, PNorm = 43.9517, GNorm = 1.4246, lr_0 = 8.1825e-04
Validation rmse = 0.144469
Validation mse = 0.020871
Validation r2 = 0.814523
Epoch 7
Loss = 2.9046e-01, PNorm = 43.9949, GNorm = 1.0992, lr_0 = 7.9966e-04
Loss = 2.4870e-01, PNorm = 44.0377, GNorm = 1.9518, lr_0 = 7.8312e-04
Validation rmse = 0.130562
Validation mse = 0.017046
Validation r2 = 0.848514
Epoch 8
Loss = 2.3160e-01, PNorm = 44.0781, GNorm = 2.1620, lr_0 = 7.6693e-04
Loss = 2.1980e-01, PNorm = 44.1060, GNorm = 4.6688, lr_0 = 7.5107e-04
Validation rmse = 0.150759
Validation mse = 0.022728
Validation r2 = 0.798022
Epoch 9
Loss = 2.1717e-01, PNorm = 44.1348, GNorm = 2.5951, lr_0 = 7.3400e-04
Loss = 2.0534e-01, PNorm = 44.1653, GNorm = 5.0480, lr_0 = 7.1883e-04
Validation rmse = 0.126515
Validation mse = 0.016006
Validation r2 = 0.857760
Epoch 10
Loss = 1.8145e-01, PNorm = 44.1814, GNorm = 2.7107, lr_0 = 7.0396e-04
Loss = 1.6353e-01, PNorm = 44.2054, GNorm = 1.5519, lr_0 = 6.8941e-04
Validation rmse = 0.151760
Validation mse = 0.023031
Validation r2 = 0.795329
Epoch 11
Loss = 1.5102e-01, PNorm = 44.2303, GNorm = 3.0500, lr_0 = 6.7374e-04
Loss = 1.4744e-01, PNorm = 44.2451, GNorm = 0.8015, lr_0 = 6.5981e-04
Validation rmse = 0.122872
Validation mse = 0.015098
Validation r2 = 0.865832
Epoch 12
Loss = 1.6414e-01, PNorm = 44.2615, GNorm = 5.8989, lr_0 = 6.4617e-04
Loss = 1.7090e-01, PNorm = 44.2855, GNorm = 1.4487, lr_0 = 6.3281e-04
Validation rmse = 0.144350
Validation mse = 0.020837
Validation r2 = 0.814829
Epoch 13
Loss = 1.4916e-01, PNorm = 44.3040, GNorm = 2.1707, lr_0 = 6.1843e-04
Loss = 1.5750e-01, PNorm = 44.3221, GNorm = 0.9435, lr_0 = 6.0564e-04
Validation rmse = 0.123730
Validation mse = 0.015309
Validation r2 = 0.863951
Epoch 14
Loss = 1.3087e-01, PNorm = 44.3421, GNorm = 1.9035, lr_0 = 5.9312e-04
Loss = 1.3055e-01, PNorm = 44.3598, GNorm = 3.1186, lr_0 = 5.8085e-04
Validation rmse = 0.122921
Validation mse = 0.015109
Validation r2 = 0.865726
Epoch 15
Loss = 1.2055e-01, PNorm = 44.3788, GNorm = 0.5886, lr_0 = 5.6765e-04
Loss = 1.3686e-01, PNorm = 44.3980, GNorm = 2.7158, lr_0 = 5.5592e-04
Validation rmse = 0.127495
Validation mse = 0.016255
Validation r2 = 0.855546
Epoch 16
Loss = 1.0503e-01, PNorm = 44.4131, GNorm = 1.2065, lr_0 = 5.4442e-04
Loss = 1.2249e-01, PNorm = 44.4259, GNorm = 1.4751, lr_0 = 5.3316e-04
Validation rmse = 0.123224
Validation mse = 0.015184
Validation r2 = 0.865063
Epoch 17
Loss = 1.0614e-01, PNorm = 44.4447, GNorm = 1.0444, lr_0 = 5.2105e-04
Loss = 1.2526e-01, PNorm = 44.4602, GNorm = 3.6519, lr_0 = 5.1027e-04
Validation rmse = 0.126502
Validation mse = 0.016003
Validation r2 = 0.857787
Epoch 18
Loss = 9.9355e-02, PNorm = 44.4711, GNorm = 0.8147, lr_0 = 4.9972e-04
Loss = 1.1386e-01, PNorm = 44.4868, GNorm = 0.9133, lr_0 = 4.8939e-04
Loss = 1.0012e-01, PNorm = 44.4885, GNorm = 1.3555, lr_0 = 4.8837e-04
Validation rmse = 0.119975
Validation mse = 0.014394
Validation r2 = 0.872084
Epoch 19
Loss = 1.1569e-01, PNorm = 44.5020, GNorm = 1.4657, lr_0 = 4.7827e-04
Loss = 1.1136e-01, PNorm = 44.5130, GNorm = 2.6916, lr_0 = 4.6838e-04
Validation rmse = 0.121109
Validation mse = 0.014668
Validation r2 = 0.869654
Epoch 20
Loss = 1.2114e-01, PNorm = 44.5287, GNorm = 0.7638, lr_0 = 4.5870e-04
Validation rmse = 0.134652
Validation mse = 0.018131
Validation r2 = 0.838873
Epoch 21
Loss = 1.9432e-01, PNorm = 44.5427, GNorm = 4.9609, lr_0 = 4.4827e-04
Loss = 1.4398e-01, PNorm = 44.5605, GNorm = 3.4718, lr_0 = 4.3900e-04
Validation rmse = 0.135543
Validation mse = 0.018372
Validation r2 = 0.836735
Epoch 22
Loss = 2.0994e-01, PNorm = 44.5757, GNorm = 3.3087, lr_0 = 4.2993e-04
Loss = 1.2110e-01, PNorm = 44.5931, GNorm = 1.7265, lr_0 = 4.2104e-04
Validation rmse = 0.113183
Validation mse = 0.012810
Validation r2 = 0.886158
Epoch 23
Loss = 1.1704e-01, PNorm = 44.6123, GNorm = 3.0685, lr_0 = 4.1147e-04
Loss = 1.0571e-01, PNorm = 44.6236, GNorm = 0.9312, lr_0 = 4.0296e-04
Validation rmse = 0.120455
Validation mse = 0.014509
Validation r2 = 0.871059
Epoch 24
Loss = 7.7276e-02, PNorm = 44.6320, GNorm = 0.9424, lr_0 = 3.9463e-04
Loss = 1.0022e-01, PNorm = 44.6426, GNorm = 0.8525, lr_0 = 3.8647e-04
Validation rmse = 0.121148
Validation mse = 0.014677
Validation r2 = 0.869570
Epoch 25
Loss = 8.7851e-02, PNorm = 44.6561, GNorm = 3.3900, lr_0 = 3.7769e-04
Loss = 9.2193e-02, PNorm = 44.6676, GNorm = 1.7030, lr_0 = 3.6988e-04
Validation rmse = 0.121956
Validation mse = 0.014873
Validation r2 = 0.867825
Epoch 26
Loss = 7.3688e-02, PNorm = 44.6782, GNorm = 1.1072, lr_0 = 3.6223e-04
Loss = 1.0060e-01, PNorm = 44.6918, GNorm = 1.9984, lr_0 = 3.5474e-04
Validation rmse = 0.124172
Validation mse = 0.015419
Validation r2 = 0.862979
Epoch 27
Loss = 6.8281e-02, PNorm = 44.7029, GNorm = 0.5796, lr_0 = 3.4668e-04
Loss = 9.9402e-02, PNorm = 44.7131, GNorm = 1.6143, lr_0 = 3.3951e-04
Validation rmse = 0.118384
Validation mse = 0.014015
Validation r2 = 0.875456
Epoch 28
Loss = 8.6983e-02, PNorm = 44.7255, GNorm = 0.4502, lr_0 = 3.3249e-04
Loss = 9.2625e-02, PNorm = 44.7386, GNorm = 1.3408, lr_0 = 3.2561e-04
Validation rmse = 0.123111
Validation mse = 0.015156
Validation r2 = 0.865310
Epoch 29
Loss = 5.9726e-02, PNorm = 44.7515, GNorm = 0.5118, lr_0 = 3.1822e-04
Loss = 9.5471e-02, PNorm = 44.7587, GNorm = 1.5248, lr_0 = 3.1164e-04
Validation rmse = 0.118658
Validation mse = 0.014080
Validation r2 = 0.874879
Epoch 30
Loss = 1.0087e-01, PNorm = 44.7681, GNorm = 0.8165, lr_0 = 3.0519e-04
Loss = 8.0927e-02, PNorm = 44.7795, GNorm = 0.9265, lr_0 = 2.9888e-04
Validation rmse = 0.116712
Validation mse = 0.013622
Validation r2 = 0.878947
Epoch 31
Loss = 7.7741e-02, PNorm = 44.7900, GNorm = 1.9897, lr_0 = 2.9209e-04
Loss = 7.8380e-02, PNorm = 44.8006, GNorm = 1.2690, lr_0 = 2.8605e-04
Validation rmse = 0.132560
Validation mse = 0.017572
Validation r2 = 0.843841
Epoch 32
Loss = 1.0081e-01, PNorm = 44.8099, GNorm = 3.0067, lr_0 = 2.8014e-04
Loss = 7.9241e-02, PNorm = 44.8192, GNorm = 0.6472, lr_0 = 2.7434e-04
Validation rmse = 0.121279
Validation mse = 0.014709
Validation r2 = 0.869289
Epoch 33
Loss = 9.2053e-02, PNorm = 44.8283, GNorm = 1.8342, lr_0 = 2.6811e-04
Loss = 7.3301e-02, PNorm = 44.8392, GNorm = 1.4754, lr_0 = 2.6257e-04
Validation rmse = 0.127830
Validation mse = 0.016341
Validation r2 = 0.854786
Epoch 34
Loss = 7.5249e-02, PNorm = 44.8486, GNorm = 0.7838, lr_0 = 2.5714e-04
Loss = 8.0062e-02, PNorm = 44.8576, GNorm = 1.7561, lr_0 = 2.5182e-04
Validation rmse = 0.117029
Validation mse = 0.013696
Validation r2 = 0.878290
Epoch 35
Loss = 6.9427e-02, PNorm = 44.8652, GNorm = 1.1264, lr_0 = 2.4610e-04
Loss = 7.2397e-02, PNorm = 44.8736, GNorm = 1.7200, lr_0 = 2.4101e-04
Validation rmse = 0.117945
Validation mse = 0.013911
Validation r2 = 0.876376
Epoch 36
Loss = 6.8038e-02, PNorm = 44.8825, GNorm = 0.7462, lr_0 = 2.3603e-04
Loss = 7.0477e-02, PNorm = 44.8908, GNorm = 1.1653, lr_0 = 2.3114e-04
Validation rmse = 0.118579
Validation mse = 0.014061
Validation r2 = 0.875044
Epoch 37
Loss = 7.6111e-02, PNorm = 44.9021, GNorm = 0.8780, lr_0 = 2.2589e-04
Loss = 7.5442e-02, PNorm = 44.9085, GNorm = 1.2927, lr_0 = 2.2122e-04
Validation rmse = 0.117677
Validation mse = 0.013848
Validation r2 = 0.876937
Epoch 38
Loss = 6.5677e-02, PNorm = 44.9170, GNorm = 1.1506, lr_0 = 2.1665e-04
Loss = 7.4974e-02, PNorm = 44.9238, GNorm = 1.8005, lr_0 = 2.1217e-04
Loss = 6.0625e-02, PNorm = 44.9247, GNorm = 0.5030, lr_0 = 2.1172e-04
Validation rmse = 0.120041
Validation mse = 0.014410
Validation r2 = 0.871943
Epoch 39
Loss = 7.3593e-02, PNorm = 44.9325, GNorm = 0.9580, lr_0 = 2.0735e-04
Loss = 6.7775e-02, PNorm = 44.9410, GNorm = 3.3196, lr_0 = 2.0306e-04
Validation rmse = 0.115776
Validation mse = 0.013404
Validation r2 = 0.880883
Epoch 40
Loss = 6.0074e-02, PNorm = 44.9483, GNorm = 0.7569, lr_0 = 1.9886e-04
Validation rmse = 0.116547
Validation mse = 0.013583
Validation r2 = 0.879291
Epoch 41
Loss = 4.7926e-02, PNorm = 44.9555, GNorm = 1.0104, lr_0 = 1.9434e-04
Loss = 6.9047e-02, PNorm = 44.9640, GNorm = 1.4955, lr_0 = 1.9032e-04
Validation rmse = 0.116687
Validation mse = 0.013616
Validation r2 = 0.878999
Epoch 42
Loss = 2.5915e-02, PNorm = 44.9700, GNorm = 0.3541, lr_0 = 1.8639e-04
Loss = 6.9557e-02, PNorm = 44.9768, GNorm = 0.6229, lr_0 = 1.8253e-04
Validation rmse = 0.123307
Validation mse = 0.015205
Validation r2 = 0.864882
Epoch 43
Loss = 8.3548e-02, PNorm = 44.9839, GNorm = 1.1098, lr_0 = 1.7839e-04
Loss = 6.8220e-02, PNorm = 44.9910, GNorm = 1.3364, lr_0 = 1.7470e-04
Validation rmse = 0.118291
Validation mse = 0.013993
Validation r2 = 0.875651
Epoch 44
Loss = 6.0711e-02, PNorm = 44.9970, GNorm = 0.8353, lr_0 = 1.7109e-04
Loss = 6.8813e-02, PNorm = 45.0043, GNorm = 2.5291, lr_0 = 1.6755e-04
Validation rmse = 0.121426
Validation mse = 0.014744
Validation r2 = 0.868972
Epoch 45
Loss = 5.4129e-02, PNorm = 45.0107, GNorm = 0.7218, lr_0 = 1.6374e-04
Loss = 6.1537e-02, PNorm = 45.0165, GNorm = 0.8110, lr_0 = 1.6035e-04
Validation rmse = 0.117378
Validation mse = 0.013778
Validation r2 = 0.877562
Epoch 46
Loss = 7.2790e-02, PNorm = 45.0219, GNorm = 0.9533, lr_0 = 1.5704e-04
Loss = 5.7507e-02, PNorm = 45.0283, GNorm = 1.1706, lr_0 = 1.5379e-04
Validation rmse = 0.117762
Validation mse = 0.013868
Validation r2 = 0.876761
Epoch 47
Loss = 5.6812e-02, PNorm = 45.0337, GNorm = 0.6400, lr_0 = 1.5030e-04
Loss = 5.6891e-02, PNorm = 45.0397, GNorm = 0.8530, lr_0 = 1.4719e-04
Validation rmse = 0.118543
Validation mse = 0.014052
Validation r2 = 0.875121
Epoch 48
Loss = 6.3914e-02, PNorm = 45.0447, GNorm = 1.9972, lr_0 = 1.4415e-04
Loss = 6.3272e-02, PNorm = 45.0494, GNorm = 1.5984, lr_0 = 1.4117e-04
Validation rmse = 0.117135
Validation mse = 0.013721
Validation r2 = 0.878068
Epoch 49
Loss = 6.0711e-02, PNorm = 45.0552, GNorm = 1.4307, lr_0 = 1.3796e-04
Loss = 6.1080e-02, PNorm = 45.0602, GNorm = 0.4548, lr_0 = 1.3511e-04
Validation rmse = 0.118903
Validation mse = 0.014138
Validation r2 = 0.874361
Epoch 50
Loss = 6.0970e-02, PNorm = 45.0645, GNorm = 2.0586, lr_0 = 1.3231e-04
Loss = 5.8858e-02, PNorm = 45.0695, GNorm = 1.5560, lr_0 = 1.2958e-04
Validation rmse = 0.116753
Validation mse = 0.013631
Validation r2 = 0.878862
Epoch 51
Loss = 5.3873e-02, PNorm = 45.0742, GNorm = 1.0711, lr_0 = 1.2663e-04
Loss = 5.3689e-02, PNorm = 45.0789, GNorm = 1.5509, lr_0 = 1.2401e-04
Validation rmse = 0.121160
Validation mse = 0.014680
Validation r2 = 0.869545
Epoch 52
Loss = 5.7310e-02, PNorm = 45.0841, GNorm = 0.6097, lr_0 = 1.2145e-04
Loss = 5.5689e-02, PNorm = 45.0888, GNorm = 0.7516, lr_0 = 1.1894e-04
Validation rmse = 0.119756
Validation mse = 0.014341
Validation r2 = 0.872552
Epoch 53
Loss = 5.1821e-02, PNorm = 45.0935, GNorm = 0.5119, lr_0 = 1.1623e-04
Loss = 6.4526e-02, PNorm = 45.0975, GNorm = 0.9079, lr_0 = 1.1383e-04
Validation rmse = 0.118949
Validation mse = 0.014149
Validation r2 = 0.874263
Epoch 54
Loss = 5.5425e-02, PNorm = 45.1006, GNorm = 0.6108, lr_0 = 1.1148e-04
Loss = 5.8441e-02, PNorm = 45.1042, GNorm = 1.0776, lr_0 = 1.0917e-04
Validation rmse = 0.118314
Validation mse = 0.013998
Validation r2 = 0.875602
Epoch 55
Loss = 5.7380e-02, PNorm = 45.1096, GNorm = 1.4976, lr_0 = 1.0669e-04
Loss = 5.4704e-02, PNorm = 45.1139, GNorm = 1.1255, lr_0 = 1.0449e-04
Validation rmse = 0.119253
Validation mse = 0.014221
Validation r2 = 0.873620
Epoch 56
Loss = 4.1363e-02, PNorm = 45.1183, GNorm = 1.0596, lr_0 = 1.0233e-04
Loss = 6.1884e-02, PNorm = 45.1219, GNorm = 1.6726, lr_0 = 1.0021e-04
Validation rmse = 0.119111
Validation mse = 0.014187
Validation r2 = 0.873920
Epoch 57
Loss = 5.1245e-02, PNorm = 45.1263, GNorm = 1.4136, lr_0 = 1.0000e-04
Loss = 5.3817e-02, PNorm = 45.1300, GNorm = 0.7692, lr_0 = 1.0000e-04
Validation rmse = 0.122255
Validation mse = 0.014946
Validation r2 = 0.867177
Epoch 58
Loss = 5.2583e-02, PNorm = 45.1338, GNorm = 1.2751, lr_0 = 1.0000e-04
Loss = 5.2749e-02, PNorm = 45.1366, GNorm = 2.5336, lr_0 = 1.0000e-04
Loss = 7.9385e-02, PNorm = 45.1370, GNorm = 1.5590, lr_0 = 1.0000e-04
Validation rmse = 0.117769
Validation mse = 0.013870
Validation r2 = 0.876745
Epoch 59
Loss = 5.2860e-02, PNorm = 45.1407, GNorm = 1.0056, lr_0 = 1.0000e-04
Loss = 5.0547e-02, PNorm = 45.1444, GNorm = 1.3169, lr_0 = 1.0000e-04
Validation rmse = 0.117362
Validation mse = 0.013774
Validation r2 = 0.877596
Model 0 best validation rmse = 0.113183 on epoch 22
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.126247
Model 0 test mse = 0.015938
Model 0 test r2 = 0.863583
Ensemble test rmse = 0.126247
Ensemble test mse = 0.015938
Ensemble test r2 = 0.863583
Fold 6
Splitting data with seed 6
Total size = 1,041 | train size = 624 | val size = 208 | test size = 209
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.5704e-01, PNorm = 43.2632, GNorm = 7.3144, lr_0 = 3.6053e-04
Validation rmse = 0.356705
Validation mse = 0.127239
Validation r2 = 0.016092
Epoch 1
Loss = 1.0978e+00, PNorm = 43.2770, GNorm = 7.9375, lr_0 = 6.2105e-04
Loss = 8.4033e-01, PNorm = 43.3111, GNorm = 2.4862, lr_0 = 8.5789e-04
Validation rmse = 0.276809
Validation mse = 0.076623
Validation r2 = 0.407489
Epoch 2
Loss = 6.2749e-01, PNorm = 43.3783, GNorm = 3.8459, lr_0 = 9.9168e-04
Loss = 5.4940e-01, PNorm = 43.4652, GNorm = 4.9508, lr_0 = 9.7117e-04
Validation rmse = 0.238421
Validation mse = 0.056845
Validation r2 = 0.560433
Epoch 3
Loss = 4.5933e-01, PNorm = 43.5361, GNorm = 6.0384, lr_0 = 9.4910e-04
Loss = 4.7188e-01, PNorm = 43.5999, GNorm = 7.2605, lr_0 = 9.2948e-04
Validation rmse = 0.242232
Validation mse = 0.058676
Validation r2 = 0.546270
Epoch 4
Loss = 3.9923e-01, PNorm = 43.6683, GNorm = 9.0403, lr_0 = 9.1026e-04
Loss = 3.9048e-01, PNorm = 43.7129, GNorm = 2.4350, lr_0 = 8.9144e-04
Validation rmse = 0.198381
Validation mse = 0.039355
Validation r2 = 0.695677
Epoch 5
Loss = 2.1454e-01, PNorm = 43.7793, GNorm = 1.0848, lr_0 = 8.7118e-04
Loss = 3.1215e-01, PNorm = 43.8229, GNorm = 5.2723, lr_0 = 8.5317e-04
Validation rmse = 0.173443
Validation mse = 0.030082
Validation r2 = 0.767380
Epoch 6
Loss = 2.0642e-01, PNorm = 43.8595, GNorm = 0.8679, lr_0 = 8.3553e-04
Loss = 2.0613e-01, PNorm = 43.8905, GNorm = 1.2048, lr_0 = 8.1825e-04
Validation rmse = 0.161177
Validation mse = 0.025978
Validation r2 = 0.799117
Epoch 7
Loss = 1.6611e-01, PNorm = 43.9322, GNorm = 0.7851, lr_0 = 7.9966e-04
Loss = 1.8564e-01, PNorm = 43.9533, GNorm = 3.8361, lr_0 = 7.8312e-04
Validation rmse = 0.156844
Validation mse = 0.024600
Validation r2 = 0.809774
Epoch 8
Loss = 1.3082e-01, PNorm = 43.9787, GNorm = 1.7223, lr_0 = 7.6693e-04
Loss = 1.6785e-01, PNorm = 44.0016, GNorm = 1.8614, lr_0 = 7.5107e-04
Validation rmse = 0.186311
Validation mse = 0.034712
Validation r2 = 0.731583
Epoch 9
Loss = 1.5384e-01, PNorm = 44.0291, GNorm = 1.3331, lr_0 = 7.3400e-04
Loss = 1.6363e-01, PNorm = 44.0485, GNorm = 2.2909, lr_0 = 7.1883e-04
Validation rmse = 0.156643
Validation mse = 0.024537
Validation r2 = 0.810261
Epoch 10
Loss = 1.5150e-01, PNorm = 44.0717, GNorm = 1.1597, lr_0 = 7.0396e-04
Loss = 1.5099e-01, PNorm = 44.0967, GNorm = 1.0866, lr_0 = 6.8941e-04
Validation rmse = 0.153313
Validation mse = 0.023505
Validation r2 = 0.818243
Epoch 11
Loss = 2.1119e-01, PNorm = 44.1128, GNorm = 2.3291, lr_0 = 6.7374e-04
Loss = 2.5237e-01, PNorm = 44.1466, GNorm = 8.1799, lr_0 = 6.5981e-04
Validation rmse = 0.174645
Validation mse = 0.030501
Validation r2 = 0.764144
Epoch 12
Loss = 1.9760e-01, PNorm = 44.1748, GNorm = 2.0806, lr_0 = 6.4617e-04
Loss = 1.4811e-01, PNorm = 44.2013, GNorm = 1.2953, lr_0 = 6.3281e-04
Validation rmse = 0.152761
Validation mse = 0.023336
Validation r2 = 0.819549
Epoch 13
Loss = 1.4515e-01, PNorm = 44.2233, GNorm = 1.4409, lr_0 = 6.1843e-04
Loss = 1.6040e-01, PNorm = 44.2397, GNorm = 1.7162, lr_0 = 6.0564e-04
Validation rmse = 0.143219
Validation mse = 0.020512
Validation r2 = 0.841388
Epoch 14
Loss = 1.1367e-01, PNorm = 44.2633, GNorm = 1.5156, lr_0 = 5.9312e-04
Loss = 1.2222e-01, PNorm = 44.2737, GNorm = 0.6022, lr_0 = 5.8085e-04
Validation rmse = 0.145847
Validation mse = 0.021271
Validation r2 = 0.835514
Epoch 15
Loss = 1.0442e-01, PNorm = 44.2860, GNorm = 1.0204, lr_0 = 5.6765e-04
Loss = 1.2772e-01, PNorm = 44.2987, GNorm = 3.2018, lr_0 = 5.5592e-04
Validation rmse = 0.137898
Validation mse = 0.019016
Validation r2 = 0.852954
Epoch 16
Loss = 1.5663e-01, PNorm = 44.3138, GNorm = 4.3033, lr_0 = 5.4442e-04
Loss = 1.2897e-01, PNorm = 44.3260, GNorm = 0.8446, lr_0 = 5.3316e-04
Validation rmse = 0.146473
Validation mse = 0.021454
Validation r2 = 0.834098
Epoch 17
Loss = 1.2104e-01, PNorm = 44.3417, GNorm = 3.1491, lr_0 = 5.2105e-04
Loss = 1.2166e-01, PNorm = 44.3567, GNorm = 0.8417, lr_0 = 5.1027e-04
Validation rmse = 0.138418
Validation mse = 0.019160
Validation r2 = 0.851844
Epoch 18
Loss = 9.6263e-02, PNorm = 44.3683, GNorm = 2.6949, lr_0 = 4.9972e-04
Loss = 1.2717e-01, PNorm = 44.3810, GNorm = 0.9851, lr_0 = 4.8939e-04
Loss = 1.1243e-01, PNorm = 44.3818, GNorm = 2.8083, lr_0 = 4.8837e-04
Validation rmse = 0.154821
Validation mse = 0.023969
Validation r2 = 0.814649
Epoch 19
Loss = 1.0622e-01, PNorm = 44.3904, GNorm = 1.4685, lr_0 = 4.7827e-04
Loss = 1.2113e-01, PNorm = 44.4027, GNorm = 1.5008, lr_0 = 4.6838e-04
Validation rmse = 0.162460
Validation mse = 0.026393
Validation r2 = 0.795908
Epoch 20
Loss = 1.2005e-01, PNorm = 44.4196, GNorm = 1.1215, lr_0 = 4.5870e-04
Validation rmse = 0.165054
Validation mse = 0.027243
Validation r2 = 0.789337
Epoch 21
Loss = 1.6693e-01, PNorm = 44.4329, GNorm = 1.4863, lr_0 = 4.4827e-04
Loss = 1.2061e-01, PNorm = 44.4474, GNorm = 1.8617, lr_0 = 4.3900e-04
Validation rmse = 0.140833
Validation mse = 0.019834
Validation r2 = 0.846629
Epoch 22
Loss = 9.7955e-02, PNorm = 44.4604, GNorm = 0.7915, lr_0 = 4.2993e-04
Loss = 1.0131e-01, PNorm = 44.4721, GNorm = 1.2431, lr_0 = 4.2104e-04
Validation rmse = 0.137749
Validation mse = 0.018975
Validation r2 = 0.853272
Epoch 23
Loss = 6.0552e-02, PNorm = 44.4795, GNorm = 0.9742, lr_0 = 4.1147e-04
Loss = 9.8077e-02, PNorm = 44.4902, GNorm = 0.8512, lr_0 = 4.0296e-04
Validation rmse = 0.139109
Validation mse = 0.019351
Validation r2 = 0.850360
Epoch 24
Loss = 8.4437e-02, PNorm = 44.5024, GNorm = 1.2898, lr_0 = 3.9463e-04
Loss = 9.4687e-02, PNorm = 44.5128, GNorm = 1.1903, lr_0 = 3.8647e-04
Validation rmse = 0.139073
Validation mse = 0.019341
Validation r2 = 0.850438
Epoch 25
Loss = 1.0262e-01, PNorm = 44.5213, GNorm = 2.0437, lr_0 = 3.7769e-04
Loss = 1.0087e-01, PNorm = 44.5308, GNorm = 0.9902, lr_0 = 3.6988e-04
Validation rmse = 0.137530
Validation mse = 0.018915
Validation r2 = 0.853738
Epoch 26
Loss = 8.0962e-02, PNorm = 44.5410, GNorm = 2.8853, lr_0 = 3.6223e-04
Loss = 9.2332e-02, PNorm = 44.5505, GNorm = 1.8300, lr_0 = 3.5474e-04
Validation rmse = 0.146259
Validation mse = 0.021392
Validation r2 = 0.834583
Epoch 27
Loss = 8.3678e-02, PNorm = 44.5618, GNorm = 1.3187, lr_0 = 3.4668e-04
Loss = 7.8266e-02, PNorm = 44.5717, GNorm = 1.3813, lr_0 = 3.3951e-04
Validation rmse = 0.137232
Validation mse = 0.018833
Validation r2 = 0.854372
Epoch 28
Loss = 7.6784e-02, PNorm = 44.5793, GNorm = 0.7993, lr_0 = 3.3249e-04
Loss = 7.6795e-02, PNorm = 44.5889, GNorm = 0.8147, lr_0 = 3.2561e-04
Validation rmse = 0.137881
Validation mse = 0.019011
Validation r2 = 0.852991
Epoch 29
Loss = 9.0342e-02, PNorm = 44.5984, GNorm = 0.7234, lr_0 = 3.1822e-04
Loss = 8.2191e-02, PNorm = 44.6073, GNorm = 2.4979, lr_0 = 3.1164e-04
Validation rmse = 0.140133
Validation mse = 0.019637
Validation r2 = 0.848149
Epoch 30
Loss = 6.4668e-02, PNorm = 44.6165, GNorm = 1.4887, lr_0 = 3.0519e-04
Loss = 8.6885e-02, PNorm = 44.6238, GNorm = 1.3571, lr_0 = 2.9888e-04
Validation rmse = 0.133369
Validation mse = 0.017787
Validation r2 = 0.862455
Epoch 31
Loss = 8.2269e-02, PNorm = 44.6342, GNorm = 0.7768, lr_0 = 2.9209e-04
Loss = 8.7666e-02, PNorm = 44.6422, GNorm = 0.7333, lr_0 = 2.8605e-04
Validation rmse = 0.133407
Validation mse = 0.017797
Validation r2 = 0.862377
Epoch 32
Loss = 7.6385e-02, PNorm = 44.6513, GNorm = 1.1950, lr_0 = 2.8014e-04
Loss = 8.6700e-02, PNorm = 44.6590, GNorm = 0.7922, lr_0 = 2.7434e-04
Validation rmse = 0.136205
Validation mse = 0.018552
Validation r2 = 0.856542
Epoch 33
Loss = 7.0640e-02, PNorm = 44.6677, GNorm = 0.6547, lr_0 = 2.6811e-04
Loss = 8.4370e-02, PNorm = 44.6770, GNorm = 1.0029, lr_0 = 2.6257e-04
Validation rmse = 0.137977
Validation mse = 0.019038
Validation r2 = 0.852786
Epoch 34
Loss = 6.8889e-02, PNorm = 44.6831, GNorm = 0.9542, lr_0 = 2.5714e-04
Loss = 7.5341e-02, PNorm = 44.6890, GNorm = 0.7129, lr_0 = 2.5182e-04
Validation rmse = 0.134640
Validation mse = 0.018128
Validation r2 = 0.859822
Epoch 35
Loss = 8.0564e-02, PNorm = 44.6981, GNorm = 0.9776, lr_0 = 2.4610e-04
Loss = 6.5569e-02, PNorm = 44.7056, GNorm = 0.5986, lr_0 = 2.4101e-04
Validation rmse = 0.135710
Validation mse = 0.018417
Validation r2 = 0.857584
Epoch 36
Loss = 8.1573e-02, PNorm = 44.7134, GNorm = 2.0753, lr_0 = 2.3603e-04
Loss = 8.4598e-02, PNorm = 44.7215, GNorm = 1.0109, lr_0 = 2.3114e-04
Validation rmse = 0.134542
Validation mse = 0.018101
Validation r2 = 0.860026
Epoch 37
Loss = 6.9121e-02, PNorm = 44.7296, GNorm = 0.7227, lr_0 = 2.2589e-04
Loss = 7.0836e-02, PNorm = 44.7367, GNorm = 1.1583, lr_0 = 2.2122e-04
Validation rmse = 0.147619
Validation mse = 0.021791
Validation r2 = 0.831493
Epoch 38
Loss = 6.4904e-02, PNorm = 44.7438, GNorm = 0.9465, lr_0 = 2.1665e-04
Loss = 7.8097e-02, PNorm = 44.7494, GNorm = 0.6259, lr_0 = 2.1217e-04
Loss = 1.0753e-01, PNorm = 44.7504, GNorm = 1.8148, lr_0 = 2.1172e-04
Validation rmse = 0.139776
Validation mse = 0.019537
Validation r2 = 0.848921
Epoch 39
Loss = 6.5214e-02, PNorm = 44.7574, GNorm = 1.0311, lr_0 = 2.0735e-04
Loss = 7.0427e-02, PNorm = 44.7634, GNorm = 0.5040, lr_0 = 2.0306e-04
Validation rmse = 0.136363
Validation mse = 0.018595
Validation r2 = 0.856211
Epoch 40
Loss = 6.2288e-02, PNorm = 44.7688, GNorm = 0.4085, lr_0 = 1.9886e-04
Validation rmse = 0.138605
Validation mse = 0.019211
Validation r2 = 0.851442
Epoch 41
Loss = 8.2657e-02, PNorm = 44.7760, GNorm = 0.8710, lr_0 = 1.9434e-04
Loss = 5.5337e-02, PNorm = 44.7828, GNorm = 1.0093, lr_0 = 1.9032e-04
Validation rmse = 0.134938
Validation mse = 0.018208
Validation r2 = 0.859200
Epoch 42
Loss = 5.0254e-02, PNorm = 44.7890, GNorm = 1.0528, lr_0 = 1.8639e-04
Loss = 7.1671e-02, PNorm = 44.7946, GNorm = 0.8445, lr_0 = 1.8253e-04
Validation rmse = 0.139379
Validation mse = 0.019426
Validation r2 = 0.849780
Epoch 43
Loss = 9.6669e-02, PNorm = 44.8006, GNorm = 0.7685, lr_0 = 1.7839e-04
Loss = 6.4034e-02, PNorm = 44.8061, GNorm = 1.1301, lr_0 = 1.7470e-04
Validation rmse = 0.133030
Validation mse = 0.017697
Validation r2 = 0.863154
Epoch 44
Loss = 7.5166e-02, PNorm = 44.8124, GNorm = 2.0733, lr_0 = 1.7109e-04
Loss = 6.6272e-02, PNorm = 44.8179, GNorm = 0.5551, lr_0 = 1.6755e-04
Validation rmse = 0.135835
Validation mse = 0.018451
Validation r2 = 0.857322
Epoch 45
Loss = 4.3485e-02, PNorm = 44.8237, GNorm = 0.7500, lr_0 = 1.6374e-04
Loss = 7.3507e-02, PNorm = 44.8297, GNorm = 0.8801, lr_0 = 1.6035e-04
Validation rmse = 0.138955
Validation mse = 0.019308
Validation r2 = 0.850693
Epoch 46
Loss = 6.6915e-02, PNorm = 44.8341, GNorm = 0.6737, lr_0 = 1.5704e-04
Loss = 6.4145e-02, PNorm = 44.8399, GNorm = 0.8597, lr_0 = 1.5379e-04
Validation rmse = 0.133883
Validation mse = 0.017925
Validation r2 = 0.861393
Epoch 47
Loss = 7.1979e-02, PNorm = 44.8450, GNorm = 1.8463, lr_0 = 1.5030e-04
Loss = 6.1970e-02, PNorm = 44.8502, GNorm = 0.8159, lr_0 = 1.4719e-04
Validation rmse = 0.135079
Validation mse = 0.018246
Validation r2 = 0.858906
Epoch 48
Loss = 4.7047e-02, PNorm = 44.8549, GNorm = 1.3450, lr_0 = 1.4415e-04
Loss = 7.0104e-02, PNorm = 44.8596, GNorm = 1.0115, lr_0 = 1.4117e-04
Validation rmse = 0.133546
Validation mse = 0.017835
Validation r2 = 0.862089
Epoch 49
Loss = 6.2704e-02, PNorm = 44.8650, GNorm = 0.3095, lr_0 = 1.3796e-04
Loss = 6.5295e-02, PNorm = 44.8698, GNorm = 0.7992, lr_0 = 1.3511e-04
Validation rmse = 0.135502
Validation mse = 0.018361
Validation r2 = 0.858020
Epoch 50
Loss = 5.5129e-02, PNorm = 44.8745, GNorm = 0.5534, lr_0 = 1.3231e-04
Loss = 6.1258e-02, PNorm = 44.8793, GNorm = 1.6193, lr_0 = 1.2958e-04
Validation rmse = 0.133337
Validation mse = 0.017779
Validation r2 = 0.862520
Epoch 51
Loss = 5.6085e-02, PNorm = 44.8834, GNorm = 0.8918, lr_0 = 1.2663e-04
Loss = 5.7888e-02, PNorm = 44.8878, GNorm = 0.7677, lr_0 = 1.2401e-04
Validation rmse = 0.132250
Validation mse = 0.017490
Validation r2 = 0.864754
Epoch 52
Loss = 5.2331e-02, PNorm = 44.8918, GNorm = 0.8803, lr_0 = 1.2145e-04
Loss = 6.2151e-02, PNorm = 44.8962, GNorm = 0.5628, lr_0 = 1.1894e-04
Validation rmse = 0.134487
Validation mse = 0.018087
Validation r2 = 0.860140
Epoch 53
Loss = 4.9889e-02, PNorm = 44.9001, GNorm = 1.4726, lr_0 = 1.1623e-04
Loss = 6.3711e-02, PNorm = 44.9044, GNorm = 1.1472, lr_0 = 1.1383e-04
Validation rmse = 0.135419
Validation mse = 0.018338
Validation r2 = 0.858195
Epoch 54
Loss = 5.8334e-02, PNorm = 44.9095, GNorm = 0.8928, lr_0 = 1.1148e-04
Loss = 5.2874e-02, PNorm = 44.9138, GNorm = 0.7484, lr_0 = 1.0917e-04
Validation rmse = 0.133219
Validation mse = 0.017747
Validation r2 = 0.862765
Epoch 55
Loss = 5.5578e-02, PNorm = 44.9176, GNorm = 0.4489, lr_0 = 1.0669e-04
Loss = 5.4825e-02, PNorm = 44.9216, GNorm = 1.7613, lr_0 = 1.0449e-04
Validation rmse = 0.136194
Validation mse = 0.018549
Validation r2 = 0.856567
Epoch 56
Loss = 6.2556e-02, PNorm = 44.9249, GNorm = 0.5413, lr_0 = 1.0233e-04
Loss = 6.0093e-02, PNorm = 44.9287, GNorm = 1.3571, lr_0 = 1.0021e-04
Validation rmse = 0.142551
Validation mse = 0.020321
Validation r2 = 0.842864
Epoch 57
Loss = 5.5433e-02, PNorm = 44.9328, GNorm = 1.6357, lr_0 = 1.0000e-04
Loss = 5.8228e-02, PNorm = 44.9362, GNorm = 0.4724, lr_0 = 1.0000e-04
Validation rmse = 0.132696
Validation mse = 0.017608
Validation r2 = 0.863839
Epoch 58
Loss = 5.1197e-02, PNorm = 44.9400, GNorm = 0.7641, lr_0 = 1.0000e-04
Loss = 5.6761e-02, PNorm = 44.9435, GNorm = 0.7339, lr_0 = 1.0000e-04
Loss = 6.6741e-02, PNorm = 44.9438, GNorm = 1.3960, lr_0 = 1.0000e-04
Validation rmse = 0.134594
Validation mse = 0.018116
Validation r2 = 0.859916
Epoch 59
Loss = 5.6346e-02, PNorm = 44.9478, GNorm = 1.6924, lr_0 = 1.0000e-04
Loss = 4.6699e-02, PNorm = 44.9512, GNorm = 0.8684, lr_0 = 1.0000e-04
Validation rmse = 0.135565
Validation mse = 0.018378
Validation r2 = 0.857888
Model 0 best validation rmse = 0.132250 on epoch 51
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.118161
Model 0 test mse = 0.013962
Model 0 test r2 = 0.876648
Ensemble test rmse = 0.118161
Ensemble test mse = 0.013962
Ensemble test r2 = 0.876648
Fold 7
Splitting data with seed 7
Total size = 1,041 | train size = 624 | val size = 208 | test size = 209
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.3795e-01, PNorm = 43.2614, GNorm = 5.8680, lr_0 = 3.6053e-04
Validation rmse = 0.296674
Validation mse = 0.088015
Validation r2 = 0.241959
Epoch 1
Loss = 8.7831e-01, PNorm = 43.2902, GNorm = 2.9266, lr_0 = 6.2105e-04
Loss = 6.5242e-01, PNorm = 43.3236, GNorm = 2.8417, lr_0 = 8.5789e-04
Validation rmse = 0.309710
Validation mse = 0.095920
Validation r2 = 0.173877
Epoch 2
Loss = 7.8152e-01, PNorm = 43.3796, GNorm = 11.0872, lr_0 = 9.9168e-04
Loss = 4.6206e-01, PNorm = 43.4513, GNorm = 1.8266, lr_0 = 9.7117e-04
Validation rmse = 0.369214
Validation mse = 0.136319
Validation r2 = -0.174059
Epoch 3
Loss = 7.9235e-01, PNorm = 43.5190, GNorm = 10.2097, lr_0 = 9.4910e-04
Loss = 4.9228e-01, PNorm = 43.5916, GNorm = 1.8323, lr_0 = 9.2948e-04
Validation rmse = 0.238418
Validation mse = 0.056843
Validation r2 = 0.510432
Epoch 4
Loss = 4.8005e-01, PNorm = 43.6570, GNorm = 5.9955, lr_0 = 9.1026e-04
Loss = 3.6255e-01, PNorm = 43.7230, GNorm = 4.6405, lr_0 = 8.9144e-04
Validation rmse = 0.201038
Validation mse = 0.040416
Validation r2 = 0.651910
Epoch 5
Loss = 2.3193e-01, PNorm = 43.7855, GNorm = 4.4105, lr_0 = 8.7118e-04
Loss = 2.1504e-01, PNorm = 43.8251, GNorm = 5.9091, lr_0 = 8.5317e-04
Validation rmse = 0.179847
Validation mse = 0.032345
Validation r2 = 0.721425
Epoch 6
Loss = 2.4225e-01, PNorm = 43.8774, GNorm = 1.0832, lr_0 = 8.3553e-04
Loss = 1.6515e-01, PNorm = 43.9133, GNorm = 2.6150, lr_0 = 8.1825e-04
Validation rmse = 0.162082
Validation mse = 0.026270
Validation r2 = 0.773743
Epoch 7
Loss = 1.6264e-01, PNorm = 43.9483, GNorm = 3.3931, lr_0 = 7.9966e-04
Loss = 1.8802e-01, PNorm = 43.9713, GNorm = 1.3125, lr_0 = 7.8312e-04
Validation rmse = 0.157205
Validation mse = 0.024713
Validation r2 = 0.787154
Epoch 8
Loss = 1.5682e-01, PNorm = 43.9911, GNorm = 2.6501, lr_0 = 7.6693e-04
Loss = 1.3735e-01, PNorm = 44.0140, GNorm = 1.6755, lr_0 = 7.5107e-04
Validation rmse = 0.151224
Validation mse = 0.022869
Validation r2 = 0.803042
Epoch 9
Loss = 1.1764e-01, PNorm = 44.0390, GNorm = 0.9280, lr_0 = 7.3400e-04
Loss = 1.4768e-01, PNorm = 44.0548, GNorm = 1.6487, lr_0 = 7.1883e-04
Validation rmse = 0.144785
Validation mse = 0.020963
Validation r2 = 0.819458
Epoch 10
Loss = 1.3492e-01, PNorm = 44.0684, GNorm = 3.8478, lr_0 = 7.0396e-04
Loss = 1.4256e-01, PNorm = 44.0861, GNorm = 5.6321, lr_0 = 6.8941e-04
Validation rmse = 0.169392
Validation mse = 0.028694
Validation r2 = 0.752873
Epoch 11
Loss = 1.9504e-01, PNorm = 44.1071, GNorm = 2.6849, lr_0 = 6.7374e-04
Loss = 1.4649e-01, PNorm = 44.1306, GNorm = 1.3453, lr_0 = 6.5981e-04
Validation rmse = 0.153790
Validation mse = 0.023651
Validation r2 = 0.796299
Epoch 12
Loss = 1.0009e-01, PNorm = 44.1473, GNorm = 1.4804, lr_0 = 6.4617e-04
Loss = 1.4054e-01, PNorm = 44.1676, GNorm = 3.1306, lr_0 = 6.3281e-04
Validation rmse = 0.145057
Validation mse = 0.021042
Validation r2 = 0.818777
Epoch 13
Loss = 1.4703e-01, PNorm = 44.1823, GNorm = 3.3859, lr_0 = 6.1843e-04
Loss = 1.1397e-01, PNorm = 44.1983, GNorm = 4.6995, lr_0 = 6.0564e-04
Validation rmse = 0.159697
Validation mse = 0.025503
Validation r2 = 0.780352
Epoch 14
Loss = 1.1773e-01, PNorm = 44.2182, GNorm = 0.8463, lr_0 = 5.9312e-04
Loss = 1.0953e-01, PNorm = 44.2318, GNorm = 0.9712, lr_0 = 5.8085e-04
Validation rmse = 0.139324
Validation mse = 0.019411
Validation r2 = 0.832821
Epoch 15
Loss = 1.0018e-01, PNorm = 44.2526, GNorm = 1.0535, lr_0 = 5.6765e-04
Loss = 1.5165e-01, PNorm = 44.2617, GNorm = 0.9782, lr_0 = 5.5592e-04
Validation rmse = 0.144925
Validation mse = 0.021003
Validation r2 = 0.819108
Epoch 16
Loss = 1.1351e-01, PNorm = 44.2720, GNorm = 0.9781, lr_0 = 5.4442e-04
Loss = 1.2452e-01, PNorm = 44.2903, GNorm = 0.7919, lr_0 = 5.3316e-04
Validation rmse = 0.145055
Validation mse = 0.021041
Validation r2 = 0.818783
Epoch 17
Loss = 1.0332e-01, PNorm = 44.3084, GNorm = 0.8708, lr_0 = 5.2105e-04
Loss = 1.0251e-01, PNorm = 44.3196, GNorm = 2.5860, lr_0 = 5.1027e-04
Validation rmse = 0.133306
Validation mse = 0.017771
Validation r2 = 0.846950
Epoch 18
Loss = 9.7702e-02, PNorm = 44.3315, GNorm = 1.1449, lr_0 = 4.9972e-04
Loss = 1.1735e-01, PNorm = 44.3456, GNorm = 1.8530, lr_0 = 4.8939e-04
Loss = 8.9472e-02, PNorm = 44.3471, GNorm = 1.7603, lr_0 = 4.8837e-04
Validation rmse = 0.133940
Validation mse = 0.017940
Validation r2 = 0.845491
Epoch 19
Loss = 1.1299e-01, PNorm = 44.3613, GNorm = 1.0050, lr_0 = 4.7827e-04
Loss = 1.1233e-01, PNorm = 44.3752, GNorm = 0.8827, lr_0 = 4.6838e-04
Validation rmse = 0.139178
Validation mse = 0.019371
Validation r2 = 0.833169
Epoch 20
Loss = 9.2104e-02, PNorm = 44.3853, GNorm = 1.3174, lr_0 = 4.5870e-04
Validation rmse = 0.134816
Validation mse = 0.018175
Validation r2 = 0.843463
Epoch 21
Loss = 1.0552e-01, PNorm = 44.3977, GNorm = 0.9026, lr_0 = 4.4827e-04
Loss = 8.2417e-02, PNorm = 44.4066, GNorm = 1.1612, lr_0 = 4.3900e-04
Validation rmse = 0.134592
Validation mse = 0.018115
Validation r2 = 0.843983
Epoch 22
Loss = 8.6693e-02, PNorm = 44.4188, GNorm = 0.9061, lr_0 = 4.2993e-04
Loss = 9.4675e-02, PNorm = 44.4295, GNorm = 1.2562, lr_0 = 4.2104e-04
Validation rmse = 0.134887
Validation mse = 0.018195
Validation r2 = 0.843298
Epoch 23
Loss = 6.3657e-02, PNorm = 44.4416, GNorm = 0.8612, lr_0 = 4.1147e-04
Loss = 9.2630e-02, PNorm = 44.4526, GNorm = 1.3333, lr_0 = 4.0296e-04
Validation rmse = 0.133178
Validation mse = 0.017736
Validation r2 = 0.847243
Epoch 24
Loss = 6.6858e-02, PNorm = 44.4620, GNorm = 0.6178, lr_0 = 3.9463e-04
Loss = 8.8767e-02, PNorm = 44.4710, GNorm = 2.9245, lr_0 = 3.8647e-04
Validation rmse = 0.135611
Validation mse = 0.018390
Validation r2 = 0.841611
Epoch 25
Loss = 5.7242e-02, PNorm = 44.4837, GNorm = 0.7942, lr_0 = 3.7769e-04
Loss = 7.9274e-02, PNorm = 44.4949, GNorm = 1.3139, lr_0 = 3.6988e-04
Validation rmse = 0.142232
Validation mse = 0.020230
Validation r2 = 0.825769
Epoch 26
Loss = 9.1095e-02, PNorm = 44.5033, GNorm = 1.9379, lr_0 = 3.6223e-04
Loss = 8.5482e-02, PNorm = 44.5146, GNorm = 0.6550, lr_0 = 3.5474e-04
Validation rmse = 0.132058
Validation mse = 0.017439
Validation r2 = 0.849802
Epoch 27
Loss = 8.3143e-02, PNorm = 44.5285, GNorm = 1.0354, lr_0 = 3.4668e-04
Loss = 8.1254e-02, PNorm = 44.5394, GNorm = 2.9042, lr_0 = 3.3951e-04
Validation rmse = 0.137813
Validation mse = 0.018992
Validation r2 = 0.836425
Epoch 28
Loss = 8.8924e-02, PNorm = 44.5485, GNorm = 2.8534, lr_0 = 3.3249e-04
Loss = 7.8423e-02, PNorm = 44.5606, GNorm = 1.9662, lr_0 = 3.2561e-04
Validation rmse = 0.134788
Validation mse = 0.018168
Validation r2 = 0.843528
Epoch 29
Loss = 1.0854e-01, PNorm = 44.5684, GNorm = 0.8584, lr_0 = 3.1822e-04
Loss = 6.5097e-02, PNorm = 44.5800, GNorm = 1.4628, lr_0 = 3.1164e-04
Validation rmse = 0.128316
Validation mse = 0.016465
Validation r2 = 0.858195
Epoch 30
Loss = 6.3809e-02, PNorm = 44.5901, GNorm = 3.9788, lr_0 = 3.0519e-04
Loss = 7.5678e-02, PNorm = 44.5999, GNorm = 1.0793, lr_0 = 2.9888e-04
Validation rmse = 0.133994
Validation mse = 0.017954
Validation r2 = 0.845366
Epoch 31
Loss = 7.0380e-02, PNorm = 44.6097, GNorm = 0.9082, lr_0 = 2.9209e-04
Loss = 7.0925e-02, PNorm = 44.6140, GNorm = 0.9989, lr_0 = 2.8605e-04
Validation rmse = 0.133114
Validation mse = 0.017719
Validation r2 = 0.847392
Epoch 32
Loss = 9.3310e-02, PNorm = 44.6260, GNorm = 1.2535, lr_0 = 2.8014e-04
Loss = 5.8883e-02, PNorm = 44.6342, GNorm = 1.1574, lr_0 = 2.7434e-04
Validation rmse = 0.133007
Validation mse = 0.017691
Validation r2 = 0.847637
Epoch 33
Loss = 6.3565e-02, PNorm = 44.6430, GNorm = 0.8513, lr_0 = 2.6811e-04
Loss = 7.3085e-02, PNorm = 44.6503, GNorm = 0.7274, lr_0 = 2.6257e-04
Validation rmse = 0.126791
Validation mse = 0.016076
Validation r2 = 0.861545
Epoch 34
Loss = 6.4431e-02, PNorm = 44.6582, GNorm = 1.2237, lr_0 = 2.5714e-04
Loss = 6.5316e-02, PNorm = 44.6657, GNorm = 1.4276, lr_0 = 2.5182e-04
Validation rmse = 0.129540
Validation mse = 0.016781
Validation r2 = 0.855476
Epoch 35
Loss = 5.5118e-02, PNorm = 44.6739, GNorm = 0.6973, lr_0 = 2.4610e-04
Loss = 6.6668e-02, PNorm = 44.6822, GNorm = 2.2284, lr_0 = 2.4101e-04
Validation rmse = 0.132007
Validation mse = 0.017426
Validation r2 = 0.849919
Epoch 36
Loss = 6.0790e-02, PNorm = 44.6904, GNorm = 1.9308, lr_0 = 2.3603e-04
Loss = 6.9631e-02, PNorm = 44.6973, GNorm = 1.3109, lr_0 = 2.3114e-04
Validation rmse = 0.131637
Validation mse = 0.017328
Validation r2 = 0.850758
Epoch 37
Loss = 5.8960e-02, PNorm = 44.7071, GNorm = 0.8060, lr_0 = 2.2589e-04
Loss = 6.1872e-02, PNorm = 44.7149, GNorm = 0.7208, lr_0 = 2.2122e-04
Validation rmse = 0.131233
Validation mse = 0.017222
Validation r2 = 0.851672
Epoch 38
Loss = 5.2167e-02, PNorm = 44.7224, GNorm = 1.1705, lr_0 = 2.1665e-04
Loss = 6.6335e-02, PNorm = 44.7278, GNorm = 1.5172, lr_0 = 2.1217e-04
Loss = 5.4428e-02, PNorm = 44.7282, GNorm = 2.6621, lr_0 = 2.1172e-04
Validation rmse = 0.135384
Validation mse = 0.018329
Validation r2 = 0.842141
Epoch 39
Loss = 5.3554e-02, PNorm = 44.7334, GNorm = 0.6551, lr_0 = 2.0735e-04
Loss = 5.7519e-02, PNorm = 44.7393, GNorm = 0.4677, lr_0 = 2.0306e-04
Validation rmse = 0.129459
Validation mse = 0.016760
Validation r2 = 0.855656
Epoch 40
Loss = 5.3769e-02, PNorm = 44.7451, GNorm = 0.9302, lr_0 = 1.9886e-04
Validation rmse = 0.127998
Validation mse = 0.016384
Validation r2 = 0.858895
Epoch 41
Loss = 4.8122e-02, PNorm = 44.7523, GNorm = 1.2779, lr_0 = 1.9434e-04
Loss = 4.9382e-02, PNorm = 44.7589, GNorm = 1.1482, lr_0 = 1.9032e-04
Validation rmse = 0.131928
Validation mse = 0.017405
Validation r2 = 0.850098
Epoch 42
Loss = 5.1252e-02, PNorm = 44.7637, GNorm = 1.2749, lr_0 = 1.8639e-04
Loss = 5.5937e-02, PNorm = 44.7698, GNorm = 0.7595, lr_0 = 1.8253e-04
Validation rmse = 0.128008
Validation mse = 0.016386
Validation r2 = 0.858875
Epoch 43
Loss = 6.7247e-02, PNorm = 44.7763, GNorm = 0.5540, lr_0 = 1.7839e-04
Loss = 4.9308e-02, PNorm = 44.7820, GNorm = 1.0143, lr_0 = 1.7470e-04
Validation rmse = 0.129932
Validation mse = 0.016882
Validation r2 = 0.854600
Epoch 44
Loss = 5.0880e-02, PNorm = 44.7888, GNorm = 0.7345, lr_0 = 1.7109e-04
Loss = 5.9838e-02, PNorm = 44.7941, GNorm = 3.0271, lr_0 = 1.6755e-04
Validation rmse = 0.128765
Validation mse = 0.016580
Validation r2 = 0.857199
Epoch 45
Loss = 4.7628e-02, PNorm = 44.7996, GNorm = 1.2134, lr_0 = 1.6374e-04
Loss = 5.3426e-02, PNorm = 44.8034, GNorm = 1.1026, lr_0 = 1.6035e-04
Validation rmse = 0.130608
Validation mse = 0.017058
Validation r2 = 0.853083
Epoch 46
Loss = 6.5925e-02, PNorm = 44.8101, GNorm = 1.3981, lr_0 = 1.5704e-04
Loss = 4.7323e-02, PNorm = 44.8162, GNorm = 1.2815, lr_0 = 1.5379e-04
Validation rmse = 0.130288
Validation mse = 0.016975
Validation r2 = 0.853802
Epoch 47
Loss = 4.5830e-02, PNorm = 44.8207, GNorm = 0.4986, lr_0 = 1.5030e-04
Loss = 4.9012e-02, PNorm = 44.8256, GNorm = 0.6762, lr_0 = 1.4719e-04
Validation rmse = 0.133372
Validation mse = 0.017788
Validation r2 = 0.846797
Epoch 48
Loss = 4.0583e-02, PNorm = 44.8296, GNorm = 1.1074, lr_0 = 1.4415e-04
Loss = 5.0366e-02, PNorm = 44.8344, GNorm = 1.6197, lr_0 = 1.4117e-04
Validation rmse = 0.128782
Validation mse = 0.016585
Validation r2 = 0.857161
Epoch 49
Loss = 5.5629e-02, PNorm = 44.8391, GNorm = 1.7574, lr_0 = 1.3796e-04
Loss = 4.8019e-02, PNorm = 44.8434, GNorm = 1.2283, lr_0 = 1.3511e-04
Validation rmse = 0.127508
Validation mse = 0.016258
Validation r2 = 0.859974
Epoch 50
Loss = 4.0628e-02, PNorm = 44.8480, GNorm = 0.3939, lr_0 = 1.3231e-04
Loss = 4.8846e-02, PNorm = 44.8531, GNorm = 1.4957, lr_0 = 1.2958e-04
Validation rmse = 0.132395
Validation mse = 0.017528
Validation r2 = 0.849035
Epoch 51
Loss = 3.5924e-02, PNorm = 44.8578, GNorm = 2.1150, lr_0 = 1.2663e-04
Loss = 5.0649e-02, PNorm = 44.8625, GNorm = 0.7092, lr_0 = 1.2401e-04
Validation rmse = 0.133480
Validation mse = 0.017817
Validation r2 = 0.846550
Epoch 52
Loss = 5.4684e-02, PNorm = 44.8659, GNorm = 1.9300, lr_0 = 1.2145e-04
Loss = 4.2510e-02, PNorm = 44.8699, GNorm = 0.8056, lr_0 = 1.1894e-04
Validation rmse = 0.133873
Validation mse = 0.017922
Validation r2 = 0.845646
Epoch 53
Loss = 4.6825e-02, PNorm = 44.8734, GNorm = 1.1600, lr_0 = 1.1623e-04
Loss = 4.3547e-02, PNorm = 44.8779, GNorm = 0.8154, lr_0 = 1.1383e-04
Validation rmse = 0.128000
Validation mse = 0.016384
Validation r2 = 0.858892
Epoch 54
Loss = 4.9168e-02, PNorm = 44.8806, GNorm = 0.7318, lr_0 = 1.1148e-04
Loss = 4.3797e-02, PNorm = 44.8849, GNorm = 0.7112, lr_0 = 1.0917e-04
Validation rmse = 0.131458
Validation mse = 0.017281
Validation r2 = 0.851164
Epoch 55
Loss = 4.9195e-02, PNorm = 44.8887, GNorm = 1.0160, lr_0 = 1.0669e-04
Loss = 4.4364e-02, PNorm = 44.8927, GNorm = 0.8654, lr_0 = 1.0449e-04
Validation rmse = 0.128414
Validation mse = 0.016490
Validation r2 = 0.857978
Epoch 56
Loss = 3.5088e-02, PNorm = 44.8945, GNorm = 0.8290, lr_0 = 1.0233e-04
Loss = 4.7892e-02, PNorm = 44.8968, GNorm = 1.6061, lr_0 = 1.0021e-04
Validation rmse = 0.130785
Validation mse = 0.017105
Validation r2 = 0.852683
Epoch 57
Loss = 3.9448e-02, PNorm = 44.9009, GNorm = 0.8484, lr_0 = 1.0000e-04
Loss = 4.4976e-02, PNorm = 44.9048, GNorm = 1.2024, lr_0 = 1.0000e-04
Validation rmse = 0.130159
Validation mse = 0.016941
Validation r2 = 0.854090
Epoch 58
Loss = 4.5832e-02, PNorm = 44.9080, GNorm = 0.5839, lr_0 = 1.0000e-04
Loss = 3.8374e-02, PNorm = 44.9116, GNorm = 0.7703, lr_0 = 1.0000e-04
Loss = 7.1712e-02, PNorm = 44.9119, GNorm = 1.4497, lr_0 = 1.0000e-04
Validation rmse = 0.128875
Validation mse = 0.016609
Validation r2 = 0.856956
Epoch 59
Loss = 4.4909e-02, PNorm = 44.9149, GNorm = 1.3192, lr_0 = 1.0000e-04
Loss = 3.5643e-02, PNorm = 44.9187, GNorm = 0.8783, lr_0 = 1.0000e-04
Validation rmse = 0.129123
Validation mse = 0.016673
Validation r2 = 0.856404
Model 0 best validation rmse = 0.126791 on epoch 33
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.128956
Model 0 test mse = 0.016630
Model 0 test r2 = 0.865779
Ensemble test rmse = 0.128956
Ensemble test mse = 0.016630
Ensemble test r2 = 0.865779
Fold 8
Splitting data with seed 8
Total size = 1,041 | train size = 624 | val size = 208 | test size = 209
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.3662e-01, PNorm = 43.2624, GNorm = 1.2168, lr_0 = 3.6053e-04
Validation rmse = 0.301398
Validation mse = 0.090841
Validation r2 = 0.222347
Epoch 1
Loss = 6.8988e-01, PNorm = 43.2814, GNorm = 6.0889, lr_0 = 6.2105e-04
Loss = 6.2109e-01, PNorm = 43.3208, GNorm = 3.0503, lr_0 = 8.5789e-04
Validation rmse = 0.306296
Validation mse = 0.093817
Validation r2 = 0.196866
Epoch 2
Loss = 8.3255e-01, PNorm = 43.3786, GNorm = 10.5162, lr_0 = 9.9168e-04
Loss = 6.2094e-01, PNorm = 43.4565, GNorm = 1.8505, lr_0 = 9.7117e-04
Validation rmse = 0.236794
Validation mse = 0.056072
Validation r2 = 0.519992
Epoch 3
Loss = 4.9611e-01, PNorm = 43.5417, GNorm = 2.9852, lr_0 = 9.4910e-04
Loss = 3.7228e-01, PNorm = 43.6173, GNorm = 7.0888, lr_0 = 9.2948e-04
Validation rmse = 0.191119
Validation mse = 0.036526
Validation r2 = 0.687311
Epoch 4
Loss = 3.2527e-01, PNorm = 43.6850, GNorm = 5.4655, lr_0 = 9.1026e-04
Loss = 2.8801e-01, PNorm = 43.7494, GNorm = 3.2829, lr_0 = 8.9144e-04
Validation rmse = 0.182591
Validation mse = 0.033340
Validation r2 = 0.714592
Epoch 5
Loss = 3.2175e-01, PNorm = 43.8146, GNorm = 8.0963, lr_0 = 8.7118e-04
Loss = 2.2630e-01, PNorm = 43.8617, GNorm = 3.7865, lr_0 = 8.5317e-04
Validation rmse = 0.158297
Validation mse = 0.025058
Validation r2 = 0.785488
Epoch 6
Loss = 1.4755e-01, PNorm = 43.8966, GNorm = 1.1148, lr_0 = 8.3553e-04
Loss = 1.8081e-01, PNorm = 43.9235, GNorm = 1.6025, lr_0 = 8.1825e-04
Validation rmse = 0.145409
Validation mse = 0.021144
Validation r2 = 0.818996
Epoch 7
Loss = 1.6494e-01, PNorm = 43.9647, GNorm = 2.1055, lr_0 = 7.9966e-04
Loss = 1.7262e-01, PNorm = 43.9982, GNorm = 3.2803, lr_0 = 7.8312e-04
Validation rmse = 0.171044
Validation mse = 0.029256
Validation r2 = 0.749550
Epoch 8
Loss = 1.0280e-01, PNorm = 44.0176, GNorm = 3.8082, lr_0 = 7.6693e-04
Loss = 1.7730e-01, PNorm = 44.0453, GNorm = 0.6541, lr_0 = 7.5107e-04
Validation rmse = 0.147054
Validation mse = 0.021625
Validation r2 = 0.814877
Epoch 9
Loss = 1.3217e-01, PNorm = 44.0701, GNorm = 1.1345, lr_0 = 7.3400e-04
Loss = 1.5744e-01, PNorm = 44.0955, GNorm = 7.1995, lr_0 = 7.1883e-04
Validation rmse = 0.142101
Validation mse = 0.020193
Validation r2 = 0.827137
Epoch 10
Loss = 1.1113e-01, PNorm = 44.1263, GNorm = 0.9161, lr_0 = 7.0396e-04
Loss = 1.3898e-01, PNorm = 44.1479, GNorm = 1.3086, lr_0 = 6.8941e-04
Validation rmse = 0.145115
Validation mse = 0.021058
Validation r2 = 0.819726
Epoch 11
Loss = 1.4915e-01, PNorm = 44.1695, GNorm = 1.3187, lr_0 = 6.7374e-04
Loss = 1.3039e-01, PNorm = 44.1927, GNorm = 1.0738, lr_0 = 6.5981e-04
Validation rmse = 0.151405
Validation mse = 0.022924
Validation r2 = 0.803760
Epoch 12
Loss = 1.3113e-01, PNorm = 44.2083, GNorm = 2.3159, lr_0 = 6.4617e-04
Loss = 1.5006e-01, PNorm = 44.2248, GNorm = 4.0091, lr_0 = 6.3281e-04
Validation rmse = 0.132218
Validation mse = 0.017482
Validation r2 = 0.850347
Epoch 13
Loss = 1.2471e-01, PNorm = 44.2459, GNorm = 3.9843, lr_0 = 6.1843e-04
Loss = 1.4282e-01, PNorm = 44.2670, GNorm = 0.8250, lr_0 = 6.0564e-04
Validation rmse = 0.131987
Validation mse = 0.017421
Validation r2 = 0.850868
Epoch 14
Loss = 1.1836e-01, PNorm = 44.2862, GNorm = 2.9897, lr_0 = 5.9312e-04
Loss = 1.0926e-01, PNorm = 44.3031, GNorm = 0.9854, lr_0 = 5.8085e-04
Validation rmse = 0.129086
Validation mse = 0.016663
Validation r2 = 0.857352
Epoch 15
Loss = 1.1007e-01, PNorm = 44.3171, GNorm = 2.5875, lr_0 = 5.6765e-04
Loss = 1.1629e-01, PNorm = 44.3323, GNorm = 0.6894, lr_0 = 5.5592e-04
Validation rmse = 0.144057
Validation mse = 0.020752
Validation r2 = 0.822347
Epoch 16
Loss = 9.6444e-02, PNorm = 44.3470, GNorm = 0.8983, lr_0 = 5.4442e-04
Loss = 1.0992e-01, PNorm = 44.3591, GNorm = 4.1588, lr_0 = 5.3316e-04
Validation rmse = 0.134757
Validation mse = 0.018159
Validation r2 = 0.844545
Epoch 17
Loss = 1.0376e-01, PNorm = 44.3731, GNorm = 2.5058, lr_0 = 5.2105e-04
Loss = 1.1132e-01, PNorm = 44.3864, GNorm = 2.4453, lr_0 = 5.1027e-04
Validation rmse = 0.133496
Validation mse = 0.017821
Validation r2 = 0.847440
Epoch 18
Loss = 9.8425e-02, PNorm = 44.3991, GNorm = 0.5254, lr_0 = 4.9972e-04
Loss = 8.9528e-02, PNorm = 44.4138, GNorm = 0.7793, lr_0 = 4.8939e-04
Loss = 1.1833e-01, PNorm = 44.4152, GNorm = 1.5976, lr_0 = 4.8837e-04
Validation rmse = 0.130123
Validation mse = 0.016932
Validation r2 = 0.855050
Epoch 19
Loss = 1.0269e-01, PNorm = 44.4285, GNorm = 1.0563, lr_0 = 4.7827e-04
Loss = 9.3981e-02, PNorm = 44.4378, GNorm = 0.7498, lr_0 = 4.6838e-04
Validation rmse = 0.129599
Validation mse = 0.016796
Validation r2 = 0.856215
Epoch 20
Loss = 8.3097e-02, PNorm = 44.4494, GNorm = 0.8655, lr_0 = 4.5870e-04
Validation rmse = 0.135092
Validation mse = 0.018250
Validation r2 = 0.843770
Epoch 21
Loss = 9.3297e-02, PNorm = 44.4644, GNorm = 2.5144, lr_0 = 4.4827e-04
Loss = 8.8567e-02, PNorm = 44.4791, GNorm = 1.7248, lr_0 = 4.3900e-04
Validation rmse = 0.133479
Validation mse = 0.017817
Validation r2 = 0.847478
Epoch 22
Loss = 5.4948e-02, PNorm = 44.4901, GNorm = 0.6678, lr_0 = 4.2993e-04
Loss = 9.5028e-02, PNorm = 44.5005, GNorm = 2.5271, lr_0 = 4.2104e-04
Validation rmse = 0.128003
Validation mse = 0.016385
Validation r2 = 0.859735
Epoch 23
Loss = 8.7153e-02, PNorm = 44.5143, GNorm = 1.3979, lr_0 = 4.1147e-04
Loss = 7.6644e-02, PNorm = 44.5264, GNorm = 2.0834, lr_0 = 4.0296e-04
Validation rmse = 0.135839
Validation mse = 0.018452
Validation r2 = 0.842036
Epoch 24
Loss = 1.3230e-01, PNorm = 44.5388, GNorm = 3.9322, lr_0 = 3.9463e-04
Loss = 8.4497e-02, PNorm = 44.5521, GNorm = 1.6317, lr_0 = 3.8647e-04
Validation rmse = 0.127746
Validation mse = 0.016319
Validation r2 = 0.860298
Epoch 25
Loss = 9.5355e-02, PNorm = 44.5649, GNorm = 1.6872, lr_0 = 3.7769e-04
Loss = 7.8726e-02, PNorm = 44.5767, GNorm = 0.8688, lr_0 = 3.6988e-04
Validation rmse = 0.128698
Validation mse = 0.016563
Validation r2 = 0.858210
Epoch 26
Loss = 9.4602e-02, PNorm = 44.5865, GNorm = 0.8550, lr_0 = 3.6223e-04
Loss = 8.5003e-02, PNorm = 44.5950, GNorm = 2.0794, lr_0 = 3.5474e-04
Validation rmse = 0.134644
Validation mse = 0.018129
Validation r2 = 0.844804
Epoch 27
Loss = 6.3360e-02, PNorm = 44.6074, GNorm = 1.9892, lr_0 = 3.4668e-04
Loss = 8.3235e-02, PNorm = 44.6200, GNorm = 2.7148, lr_0 = 3.3951e-04
Validation rmse = 0.124473
Validation mse = 0.015494
Validation r2 = 0.867365
Epoch 28
Loss = 7.3048e-02, PNorm = 44.6298, GNorm = 1.1121, lr_0 = 3.3249e-04
Loss = 7.9748e-02, PNorm = 44.6399, GNorm = 2.4700, lr_0 = 3.2561e-04
Validation rmse = 0.125068
Validation mse = 0.015642
Validation r2 = 0.866094
Epoch 29
Loss = 9.1456e-02, PNorm = 44.6505, GNorm = 1.1371, lr_0 = 3.1822e-04
Loss = 8.1530e-02, PNorm = 44.6593, GNorm = 1.0088, lr_0 = 3.1164e-04
Validation rmse = 0.131212
Validation mse = 0.017217
Validation r2 = 0.852616
Epoch 30
Loss = 5.2822e-02, PNorm = 44.6691, GNorm = 0.9156, lr_0 = 3.0519e-04
Loss = 8.2726e-02, PNorm = 44.6769, GNorm = 1.4387, lr_0 = 2.9888e-04
Validation rmse = 0.126576
Validation mse = 0.016021
Validation r2 = 0.862846
Epoch 31
Loss = 8.2524e-02, PNorm = 44.6889, GNorm = 2.2137, lr_0 = 2.9209e-04
Loss = 6.0318e-02, PNorm = 44.6964, GNorm = 0.7948, lr_0 = 2.8605e-04
Validation rmse = 0.128554
Validation mse = 0.016526
Validation r2 = 0.858526
Epoch 32
Loss = 7.5053e-02, PNorm = 44.7031, GNorm = 1.4236, lr_0 = 2.8014e-04
Loss = 6.9696e-02, PNorm = 44.7125, GNorm = 2.1695, lr_0 = 2.7434e-04
Validation rmse = 0.127368
Validation mse = 0.016223
Validation r2 = 0.861125
Epoch 33
Loss = 6.1262e-02, PNorm = 44.7216, GNorm = 0.5486, lr_0 = 2.6811e-04
Loss = 7.2667e-02, PNorm = 44.7328, GNorm = 1.2226, lr_0 = 2.6257e-04
Validation rmse = 0.125746
Validation mse = 0.015812
Validation r2 = 0.864638
Epoch 34
Loss = 6.3448e-02, PNorm = 44.7374, GNorm = 0.8452, lr_0 = 2.5714e-04
Loss = 6.7003e-02, PNorm = 44.7453, GNorm = 0.6150, lr_0 = 2.5182e-04
Validation rmse = 0.124997
Validation mse = 0.015624
Validation r2 = 0.866246
Epoch 35
Loss = 5.6301e-02, PNorm = 44.7547, GNorm = 0.8438, lr_0 = 2.4610e-04
Loss = 7.4045e-02, PNorm = 44.7625, GNorm = 1.9087, lr_0 = 2.4101e-04
Validation rmse = 0.127635
Validation mse = 0.016291
Validation r2 = 0.860541
Epoch 36
Loss = 5.5193e-02, PNorm = 44.7704, GNorm = 0.8552, lr_0 = 2.3603e-04
Loss = 6.2518e-02, PNorm = 44.7799, GNorm = 1.1352, lr_0 = 2.3114e-04
Validation rmse = 0.125275
Validation mse = 0.015694
Validation r2 = 0.865651
Epoch 37
Loss = 5.3696e-02, PNorm = 44.7882, GNorm = 0.6640, lr_0 = 2.2589e-04
Loss = 6.1260e-02, PNorm = 44.7948, GNorm = 0.7700, lr_0 = 2.2122e-04
Validation rmse = 0.133339
Validation mse = 0.017779
Validation r2 = 0.847797
Epoch 38
Loss = 5.9040e-02, PNorm = 44.8018, GNorm = 0.8844, lr_0 = 2.1665e-04
Loss = 6.9334e-02, PNorm = 44.8085, GNorm = 1.3020, lr_0 = 2.1217e-04
Loss = 6.6060e-02, PNorm = 44.8095, GNorm = 1.7190, lr_0 = 2.1172e-04
Validation rmse = 0.128835
Validation mse = 0.016598
Validation r2 = 0.857907
Epoch 39
Loss = 5.3175e-02, PNorm = 44.8184, GNorm = 1.7211, lr_0 = 2.0735e-04
Loss = 6.2349e-02, PNorm = 44.8254, GNorm = 1.1436, lr_0 = 2.0306e-04
Validation rmse = 0.126324
Validation mse = 0.015958
Validation r2 = 0.863391
Epoch 40
Loss = 4.9752e-02, PNorm = 44.8340, GNorm = 1.2702, lr_0 = 1.9886e-04
Validation rmse = 0.128793
Validation mse = 0.016588
Validation r2 = 0.858000
Epoch 41
Loss = 6.8304e-02, PNorm = 44.8409, GNorm = 0.8961, lr_0 = 1.9434e-04
Loss = 6.5870e-02, PNorm = 44.8493, GNorm = 0.7796, lr_0 = 1.9032e-04
Validation rmse = 0.124894
Validation mse = 0.015599
Validation r2 = 0.866466
Epoch 42
Loss = 6.9326e-02, PNorm = 44.8565, GNorm = 1.5747, lr_0 = 1.8639e-04
Loss = 6.1773e-02, PNorm = 44.8623, GNorm = 1.2216, lr_0 = 1.8253e-04
Validation rmse = 0.125458
Validation mse = 0.015740
Validation r2 = 0.865257
Epoch 43
Loss = 5.7331e-02, PNorm = 44.8690, GNorm = 1.0871, lr_0 = 1.7839e-04
Loss = 5.7109e-02, PNorm = 44.8747, GNorm = 0.5713, lr_0 = 1.7470e-04
Validation rmse = 0.125309
Validation mse = 0.015702
Validation r2 = 0.865579
Epoch 44
Loss = 3.4854e-02, PNorm = 44.8810, GNorm = 1.0384, lr_0 = 1.7109e-04
Loss = 4.7860e-02, PNorm = 44.8865, GNorm = 0.9560, lr_0 = 1.6755e-04
Validation rmse = 0.124602
Validation mse = 0.015526
Validation r2 = 0.867090
Epoch 45
Loss = 5.7432e-02, PNorm = 44.8926, GNorm = 2.5335, lr_0 = 1.6374e-04
Loss = 5.4716e-02, PNorm = 44.8992, GNorm = 0.8257, lr_0 = 1.6035e-04
Validation rmse = 0.125009
Validation mse = 0.015627
Validation r2 = 0.866222
Epoch 46
Loss = 3.6628e-02, PNorm = 44.9049, GNorm = 0.5761, lr_0 = 1.5704e-04
Loss = 4.6714e-02, PNorm = 44.9101, GNorm = 1.0426, lr_0 = 1.5379e-04
Validation rmse = 0.125612
Validation mse = 0.015778
Validation r2 = 0.864927
Epoch 47
Loss = 3.4419e-02, PNorm = 44.9157, GNorm = 1.2010, lr_0 = 1.5030e-04
Loss = 5.5072e-02, PNorm = 44.9206, GNorm = 0.8649, lr_0 = 1.4719e-04
Validation rmse = 0.128408
Validation mse = 0.016489
Validation r2 = 0.858847
Epoch 48
Loss = 4.7238e-02, PNorm = 44.9266, GNorm = 1.9878, lr_0 = 1.4415e-04
Loss = 5.1009e-02, PNorm = 44.9313, GNorm = 0.9257, lr_0 = 1.4117e-04
Validation rmse = 0.123220
Validation mse = 0.015183
Validation r2 = 0.870023
Epoch 49
Loss = 5.1819e-02, PNorm = 44.9371, GNorm = 2.3698, lr_0 = 1.3796e-04
Loss = 4.3248e-02, PNorm = 44.9416, GNorm = 0.8199, lr_0 = 1.3511e-04
Validation rmse = 0.128072
Validation mse = 0.016403
Validation r2 = 0.859584
Epoch 50
Loss = 4.5142e-02, PNorm = 44.9466, GNorm = 1.9709, lr_0 = 1.3231e-04
Loss = 4.8461e-02, PNorm = 44.9514, GNorm = 1.2951, lr_0 = 1.2958e-04
Validation rmse = 0.132397
Validation mse = 0.017529
Validation r2 = 0.849940
Epoch 51
Loss = 5.8080e-02, PNorm = 44.9568, GNorm = 1.5601, lr_0 = 1.2663e-04
Loss = 4.4838e-02, PNorm = 44.9621, GNorm = 1.0019, lr_0 = 1.2401e-04
Validation rmse = 0.126782
Validation mse = 0.016074
Validation r2 = 0.862399
Epoch 52
Loss = 5.2321e-02, PNorm = 44.9657, GNorm = 0.7310, lr_0 = 1.2145e-04
Loss = 4.7021e-02, PNorm = 44.9716, GNorm = 1.6797, lr_0 = 1.1894e-04
Validation rmse = 0.125947
Validation mse = 0.015863
Validation r2 = 0.864206
Epoch 53
Loss = 5.1397e-02, PNorm = 44.9763, GNorm = 1.2834, lr_0 = 1.1623e-04
Loss = 3.9315e-02, PNorm = 44.9803, GNorm = 1.4322, lr_0 = 1.1383e-04
Validation rmse = 0.126581
Validation mse = 0.016023
Validation r2 = 0.862836
Epoch 54
Loss = 4.9947e-02, PNorm = 44.9840, GNorm = 0.9448, lr_0 = 1.1148e-04
Loss = 5.0630e-02, PNorm = 44.9878, GNorm = 0.4305, lr_0 = 1.0917e-04
Validation rmse = 0.124407
Validation mse = 0.015477
Validation r2 = 0.867506
Epoch 55
Loss = 4.7522e-02, PNorm = 44.9931, GNorm = 2.7504, lr_0 = 1.0669e-04
Loss = 4.2471e-02, PNorm = 44.9969, GNorm = 0.8908, lr_0 = 1.0449e-04
Validation rmse = 0.123864
Validation mse = 0.015342
Validation r2 = 0.868660
Epoch 56
Loss = 5.2037e-02, PNorm = 45.0002, GNorm = 0.7985, lr_0 = 1.0233e-04
Loss = 4.3265e-02, PNorm = 45.0041, GNorm = 1.1079, lr_0 = 1.0021e-04
Validation rmse = 0.124413
Validation mse = 0.015479
Validation r2 = 0.867493
Epoch 57
Loss = 4.3554e-02, PNorm = 45.0083, GNorm = 1.0756, lr_0 = 1.0000e-04
Loss = 4.1074e-02, PNorm = 45.0117, GNorm = 0.9743, lr_0 = 1.0000e-04
Validation rmse = 0.125075
Validation mse = 0.015644
Validation r2 = 0.866080
Epoch 58
Loss = 3.7549e-02, PNorm = 45.0146, GNorm = 0.2388, lr_0 = 1.0000e-04
Loss = 4.2624e-02, PNorm = 45.0181, GNorm = 0.8807, lr_0 = 1.0000e-04
Loss = 6.0364e-02, PNorm = 45.0185, GNorm = 1.9649, lr_0 = 1.0000e-04
Validation rmse = 0.124182
Validation mse = 0.015421
Validation r2 = 0.867985
Epoch 59
Loss = 3.9708e-02, PNorm = 45.0222, GNorm = 0.7304, lr_0 = 1.0000e-04
Loss = 4.0504e-02, PNorm = 45.0261, GNorm = 1.0144, lr_0 = 1.0000e-04
Validation rmse = 0.123983
Validation mse = 0.015372
Validation r2 = 0.868407
Model 0 best validation rmse = 0.123220 on epoch 48
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.127823
Model 0 test mse = 0.016339
Model 0 test r2 = 0.847585
Ensemble test rmse = 0.127823
Ensemble test mse = 0.016339
Ensemble test r2 = 0.847585
Fold 9
Splitting data with seed 9
Total size = 1,041 | train size = 624 | val size = 208 | test size = 209
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.9320e-01, PNorm = 43.2618, GNorm = 3.5876, lr_0 = 3.6053e-04
Validation rmse = 0.339531
Validation mse = 0.115281
Validation r2 = 0.123367
Epoch 1
Loss = 3.8062e-01, PNorm = 43.2789, GNorm = 1.8700, lr_0 = 6.2105e-04
Loss = 6.7435e-01, PNorm = 43.3206, GNorm = 2.0204, lr_0 = 8.5789e-04
Validation rmse = 0.386894
Validation mse = 0.149687
Validation r2 = -0.138264
Epoch 2
Loss = 8.8293e-01, PNorm = 43.3757, GNorm = 10.7042, lr_0 = 9.9168e-04
Loss = 6.2115e-01, PNorm = 43.4447, GNorm = 5.1284, lr_0 = 9.7117e-04
Validation rmse = 0.270693
Validation mse = 0.073275
Validation r2 = 0.442794
Epoch 3
Loss = 5.1180e-01, PNorm = 43.5298, GNorm = 8.2728, lr_0 = 9.4910e-04
Loss = 4.3526e-01, PNorm = 43.6027, GNorm = 2.9265, lr_0 = 9.2948e-04
Validation rmse = 0.221797
Validation mse = 0.049194
Validation r2 = 0.625913
Epoch 4
Loss = 3.2320e-01, PNorm = 43.6656, GNorm = 1.0266, lr_0 = 9.1026e-04
Loss = 2.9682e-01, PNorm = 43.7163, GNorm = 2.6538, lr_0 = 8.9144e-04
Validation rmse = 0.191536
Validation mse = 0.036686
Validation r2 = 0.721028
Epoch 5
Loss = 2.4936e-01, PNorm = 43.7759, GNorm = 2.1137, lr_0 = 8.7118e-04
Loss = 2.3457e-01, PNorm = 43.8147, GNorm = 2.5863, lr_0 = 8.5317e-04
Validation rmse = 0.188031
Validation mse = 0.035356
Validation r2 = 0.731143
Epoch 6
Loss = 2.7654e-01, PNorm = 43.8490, GNorm = 3.5761, lr_0 = 8.3553e-04
Loss = 1.9545e-01, PNorm = 43.8891, GNorm = 3.2623, lr_0 = 8.1825e-04
Validation rmse = 0.223872
Validation mse = 0.050119
Validation r2 = 0.618882
Epoch 7
Loss = 2.6630e-01, PNorm = 43.9366, GNorm = 6.4609, lr_0 = 7.9966e-04
Loss = 2.8354e-01, PNorm = 43.9777, GNorm = 4.8968, lr_0 = 7.8312e-04
Validation rmse = 0.166935
Validation mse = 0.027867
Validation r2 = 0.788090
Epoch 8
Loss = 2.7500e-01, PNorm = 44.0132, GNorm = 6.2922, lr_0 = 7.6693e-04
Loss = 1.7434e-01, PNorm = 44.0562, GNorm = 0.8794, lr_0 = 7.5107e-04
Validation rmse = 0.169891
Validation mse = 0.028863
Validation r2 = 0.780516
Epoch 9
Loss = 1.5835e-01, PNorm = 44.0803, GNorm = 0.5590, lr_0 = 7.3400e-04
Loss = 1.6305e-01, PNorm = 44.1021, GNorm = 5.8627, lr_0 = 7.1883e-04
Validation rmse = 0.160083
Validation mse = 0.025627
Validation r2 = 0.805127
Epoch 10
Loss = 1.5076e-01, PNorm = 44.1193, GNorm = 3.0569, lr_0 = 7.0396e-04
Loss = 1.3712e-01, PNorm = 44.1417, GNorm = 2.5569, lr_0 = 6.8941e-04
Validation rmse = 0.160159
Validation mse = 0.025651
Validation r2 = 0.804942
Epoch 11
Loss = 1.5715e-01, PNorm = 44.1614, GNorm = 0.9424, lr_0 = 6.7374e-04
Loss = 1.5265e-01, PNorm = 44.1836, GNorm = 1.2254, lr_0 = 6.5981e-04
Validation rmse = 0.170137
Validation mse = 0.028947
Validation r2 = 0.779880
Epoch 12
Loss = 1.5951e-01, PNorm = 44.2011, GNorm = 4.1854, lr_0 = 6.4617e-04
Loss = 1.4379e-01, PNorm = 44.2133, GNorm = 1.9189, lr_0 = 6.3281e-04
Validation rmse = 0.142234
Validation mse = 0.020231
Validation r2 = 0.846160
Epoch 13
Loss = 1.0168e-01, PNorm = 44.2398, GNorm = 1.0395, lr_0 = 6.1843e-04
Loss = 1.5775e-01, PNorm = 44.2509, GNorm = 1.9671, lr_0 = 6.0564e-04
Validation rmse = 0.157407
Validation mse = 0.024777
Validation r2 = 0.811587
Epoch 14
Loss = 1.1687e-01, PNorm = 44.2659, GNorm = 1.1123, lr_0 = 5.9312e-04
Loss = 1.2524e-01, PNorm = 44.2869, GNorm = 2.3032, lr_0 = 5.8085e-04
Validation rmse = 0.143685
Validation mse = 0.020645
Validation r2 = 0.843007
Epoch 15
Loss = 1.2272e-01, PNorm = 44.2966, GNorm = 3.3648, lr_0 = 5.6765e-04
Loss = 1.0468e-01, PNorm = 44.3076, GNorm = 3.6000, lr_0 = 5.5592e-04
Validation rmse = 0.141591
Validation mse = 0.020048
Validation r2 = 0.847549
Epoch 16
Loss = 9.5409e-02, PNorm = 44.3218, GNorm = 1.9861, lr_0 = 5.4442e-04
Loss = 1.0657e-01, PNorm = 44.3368, GNorm = 0.9905, lr_0 = 5.3316e-04
Validation rmse = 0.141483
Validation mse = 0.020017
Validation r2 = 0.847782
Epoch 17
Loss = 1.1232e-01, PNorm = 44.3493, GNorm = 2.5218, lr_0 = 5.2105e-04
Loss = 9.6676e-02, PNorm = 44.3612, GNorm = 0.7166, lr_0 = 5.1027e-04
Validation rmse = 0.141112
Validation mse = 0.019913
Validation r2 = 0.848578
Epoch 18
Loss = 1.0906e-01, PNorm = 44.3753, GNorm = 5.2798, lr_0 = 4.9972e-04
Loss = 1.4643e-01, PNorm = 44.3901, GNorm = 1.8226, lr_0 = 4.8939e-04
Loss = 1.2805e-01, PNorm = 44.3919, GNorm = 2.9360, lr_0 = 4.8837e-04
Validation rmse = 0.157648
Validation mse = 0.024853
Validation r2 = 0.811011
Epoch 19
Loss = 1.3069e-01, PNorm = 44.4101, GNorm = 0.7517, lr_0 = 4.7827e-04
Loss = 1.0355e-01, PNorm = 44.4225, GNorm = 1.7389, lr_0 = 4.6838e-04
Validation rmse = 0.145224
Validation mse = 0.021090
Validation r2 = 0.839624
Epoch 20
Loss = 1.0645e-01, PNorm = 44.4385, GNorm = 2.7438, lr_0 = 4.5870e-04
Validation rmse = 0.136783
Validation mse = 0.018709
Validation r2 = 0.857727
Epoch 21
Loss = 7.3746e-02, PNorm = 44.4520, GNorm = 0.8775, lr_0 = 4.4827e-04
Loss = 9.6999e-02, PNorm = 44.4608, GNorm = 1.0335, lr_0 = 4.3900e-04
Validation rmse = 0.147311
Validation mse = 0.021701
Validation r2 = 0.834981
Epoch 22
Loss = 4.8053e-02, PNorm = 44.4724, GNorm = 1.1767, lr_0 = 4.2993e-04
Loss = 9.0972e-02, PNorm = 44.4811, GNorm = 1.0878, lr_0 = 4.2104e-04
Validation rmse = 0.131545
Validation mse = 0.017304
Validation r2 = 0.868414
Epoch 23
Loss = 8.8873e-02, PNorm = 44.4921, GNorm = 1.7318, lr_0 = 4.1147e-04
Loss = 7.6832e-02, PNorm = 44.5035, GNorm = 1.3944, lr_0 = 4.0296e-04
Validation rmse = 0.130640
Validation mse = 0.017067
Validation r2 = 0.870219
Epoch 24
Loss = 6.1876e-02, PNorm = 44.5126, GNorm = 0.6945, lr_0 = 3.9463e-04
Loss = 8.6402e-02, PNorm = 44.5211, GNorm = 1.6039, lr_0 = 3.8647e-04
Validation rmse = 0.129274
Validation mse = 0.016712
Validation r2 = 0.872919
Epoch 25
Loss = 8.4016e-02, PNorm = 44.5286, GNorm = 1.0101, lr_0 = 3.7769e-04
Loss = 9.1305e-02, PNorm = 44.5393, GNorm = 1.6806, lr_0 = 3.6988e-04
Validation rmse = 0.132762
Validation mse = 0.017626
Validation r2 = 0.865969
Epoch 26
Loss = 6.8118e-02, PNorm = 44.5500, GNorm = 0.6723, lr_0 = 3.6223e-04
Loss = 8.3991e-02, PNorm = 44.5601, GNorm = 0.9005, lr_0 = 3.5474e-04
Validation rmse = 0.130716
Validation mse = 0.017087
Validation r2 = 0.870067
Epoch 27
Loss = 6.7906e-02, PNorm = 44.5710, GNorm = 1.3431, lr_0 = 3.4668e-04
Loss = 8.7549e-02, PNorm = 44.5808, GNorm = 1.8309, lr_0 = 3.3951e-04
Validation rmse = 0.134665
Validation mse = 0.018135
Validation r2 = 0.862098
Epoch 28
Loss = 6.7112e-02, PNorm = 44.5879, GNorm = 0.6412, lr_0 = 3.3249e-04
Loss = 8.3890e-02, PNorm = 44.5958, GNorm = 2.9566, lr_0 = 3.2561e-04
Validation rmse = 0.128193
Validation mse = 0.016433
Validation r2 = 0.875035
Epoch 29
Loss = 6.7983e-02, PNorm = 44.6056, GNorm = 1.9208, lr_0 = 3.1822e-04
Loss = 8.0087e-02, PNorm = 44.6170, GNorm = 1.3899, lr_0 = 3.1164e-04
Validation rmse = 0.135197
Validation mse = 0.018278
Validation r2 = 0.861007
Epoch 30
Loss = 6.9180e-02, PNorm = 44.6258, GNorm = 0.8361, lr_0 = 3.0519e-04
Loss = 7.6876e-02, PNorm = 44.6340, GNorm = 1.1387, lr_0 = 2.9888e-04
Validation rmse = 0.132679
Validation mse = 0.017604
Validation r2 = 0.866136
Epoch 31
Loss = 6.9233e-02, PNorm = 44.6440, GNorm = 1.3999, lr_0 = 2.9209e-04
Loss = 8.5649e-02, PNorm = 44.6525, GNorm = 3.3088, lr_0 = 2.8605e-04
Validation rmse = 0.135953
Validation mse = 0.018483
Validation r2 = 0.859448
Epoch 32
Loss = 7.3977e-02, PNorm = 44.6610, GNorm = 1.4998, lr_0 = 2.8014e-04
Loss = 7.6570e-02, PNorm = 44.6673, GNorm = 1.8344, lr_0 = 2.7434e-04
Validation rmse = 0.131635
Validation mse = 0.017328
Validation r2 = 0.868235
Epoch 33
Loss = 7.7695e-02, PNorm = 44.6788, GNorm = 0.6882, lr_0 = 2.6811e-04
Loss = 7.7409e-02, PNorm = 44.6860, GNorm = 1.8263, lr_0 = 2.6257e-04
Validation rmse = 0.126935
Validation mse = 0.016113
Validation r2 = 0.877475
Epoch 34
Loss = 7.1508e-02, PNorm = 44.6942, GNorm = 0.8602, lr_0 = 2.5714e-04
Loss = 6.5103e-02, PNorm = 44.7020, GNorm = 0.7571, lr_0 = 2.5182e-04
Validation rmse = 0.128158
Validation mse = 0.016424
Validation r2 = 0.875103
Epoch 35
Loss = 6.3963e-02, PNorm = 44.7113, GNorm = 0.4934, lr_0 = 2.4610e-04
Loss = 6.8255e-02, PNorm = 44.7177, GNorm = 0.3936, lr_0 = 2.4101e-04
Validation rmse = 0.131132
Validation mse = 0.017196
Validation r2 = 0.869239
Epoch 36
Loss = 7.3199e-02, PNorm = 44.7235, GNorm = 1.4049, lr_0 = 2.3603e-04
Loss = 6.2581e-02, PNorm = 44.7293, GNorm = 1.0585, lr_0 = 2.3114e-04
Validation rmse = 0.130159
Validation mse = 0.016941
Validation r2 = 0.871173
Epoch 37
Loss = 6.7224e-02, PNorm = 44.7390, GNorm = 0.8421, lr_0 = 2.2589e-04
Loss = 6.1808e-02, PNorm = 44.7449, GNorm = 1.8778, lr_0 = 2.2122e-04
Validation rmse = 0.128225
Validation mse = 0.016442
Validation r2 = 0.874973
Epoch 38
Loss = 6.8669e-02, PNorm = 44.7521, GNorm = 1.8121, lr_0 = 2.1665e-04
Loss = 6.1694e-02, PNorm = 44.7582, GNorm = 1.7417, lr_0 = 2.1217e-04
Loss = 7.6936e-02, PNorm = 44.7586, GNorm = 1.5144, lr_0 = 2.1172e-04
Validation rmse = 0.130319
Validation mse = 0.016983
Validation r2 = 0.870855
Epoch 39
Loss = 6.2977e-02, PNorm = 44.7658, GNorm = 1.4209, lr_0 = 2.0735e-04
Loss = 7.9112e-02, PNorm = 44.7727, GNorm = 2.0529, lr_0 = 2.0306e-04
Validation rmse = 0.126810
Validation mse = 0.016081
Validation r2 = 0.877717
Epoch 40
Loss = 6.0587e-02, PNorm = 44.7798, GNorm = 1.3224, lr_0 = 1.9886e-04
Validation rmse = 0.126723
Validation mse = 0.016059
Validation r2 = 0.877885
Epoch 41
Loss = 8.0068e-02, PNorm = 44.7857, GNorm = 0.4904, lr_0 = 1.9434e-04
Loss = 5.8822e-02, PNorm = 44.7918, GNorm = 0.9434, lr_0 = 1.9032e-04
Validation rmse = 0.129948
Validation mse = 0.016886
Validation r2 = 0.871591
Epoch 42
Loss = 8.1724e-02, PNorm = 44.7986, GNorm = 2.2331, lr_0 = 1.8639e-04
Loss = 5.7902e-02, PNorm = 44.8039, GNorm = 1.5552, lr_0 = 1.8253e-04
Validation rmse = 0.129868
Validation mse = 0.016866
Validation r2 = 0.871747
Epoch 43
Loss = 7.2251e-02, PNorm = 44.8091, GNorm = 1.1309, lr_0 = 1.7839e-04
Loss = 6.4260e-02, PNorm = 44.8164, GNorm = 0.8364, lr_0 = 1.7470e-04
Validation rmse = 0.133104
Validation mse = 0.017717
Validation r2 = 0.865276
Epoch 44
Loss = 6.3759e-02, PNorm = 44.8208, GNorm = 0.8140, lr_0 = 1.7109e-04
Loss = 5.5959e-02, PNorm = 44.8272, GNorm = 1.2347, lr_0 = 1.6755e-04
Validation rmse = 0.130117
Validation mse = 0.016930
Validation r2 = 0.871256
Epoch 45
Loss = 6.0798e-02, PNorm = 44.8325, GNorm = 0.9338, lr_0 = 1.6374e-04
Loss = 5.3552e-02, PNorm = 44.8383, GNorm = 0.9275, lr_0 = 1.6035e-04
Validation rmse = 0.130149
Validation mse = 0.016939
Validation r2 = 0.871192
Epoch 46
Loss = 7.4905e-02, PNorm = 44.8440, GNorm = 1.1076, lr_0 = 1.5704e-04
Loss = 6.1467e-02, PNorm = 44.8491, GNorm = 1.3079, lr_0 = 1.5379e-04
Validation rmse = 0.127701
Validation mse = 0.016308
Validation r2 = 0.875992
Epoch 47
Loss = 5.9229e-02, PNorm = 44.8555, GNorm = 1.3369, lr_0 = 1.5030e-04
Loss = 5.9104e-02, PNorm = 44.8603, GNorm = 0.7667, lr_0 = 1.4719e-04
Validation rmse = 0.129241
Validation mse = 0.016703
Validation r2 = 0.872983
Epoch 48
Loss = 6.1833e-02, PNorm = 44.8659, GNorm = 1.3984, lr_0 = 1.4415e-04
Loss = 5.9040e-02, PNorm = 44.8706, GNorm = 0.5433, lr_0 = 1.4117e-04
Validation rmse = 0.127428
Validation mse = 0.016238
Validation r2 = 0.876523
Epoch 49
Loss = 5.1978e-02, PNorm = 44.8759, GNorm = 0.9076, lr_0 = 1.3796e-04
Loss = 5.7032e-02, PNorm = 44.8802, GNorm = 0.8272, lr_0 = 1.3511e-04
Validation rmse = 0.128800
Validation mse = 0.016590
Validation r2 = 0.873848
Epoch 50
Loss = 4.3661e-02, PNorm = 44.8850, GNorm = 1.5394, lr_0 = 1.3231e-04
Loss = 6.3440e-02, PNorm = 44.8899, GNorm = 0.6038, lr_0 = 1.2958e-04
Validation rmse = 0.127813
Validation mse = 0.016336
Validation r2 = 0.875774
Epoch 51
Loss = 5.3389e-02, PNorm = 44.8942, GNorm = 1.3128, lr_0 = 1.2663e-04
Loss = 5.0408e-02, PNorm = 44.8981, GNorm = 0.5586, lr_0 = 1.2401e-04
Validation rmse = 0.127863
Validation mse = 0.016349
Validation r2 = 0.875677
Epoch 52
Loss = 6.3020e-02, PNorm = 44.9038, GNorm = 0.3577, lr_0 = 1.2145e-04
Loss = 4.8871e-02, PNorm = 44.9079, GNorm = 0.9957, lr_0 = 1.1894e-04
Validation rmse = 0.127776
Validation mse = 0.016327
Validation r2 = 0.875847
Epoch 53
Loss = 4.5860e-02, PNorm = 44.9125, GNorm = 0.6304, lr_0 = 1.1623e-04
Loss = 5.1659e-02, PNorm = 44.9154, GNorm = 1.0655, lr_0 = 1.1383e-04
Validation rmse = 0.127268
Validation mse = 0.016197
Validation r2 = 0.876833
Epoch 54
Loss = 5.4157e-02, PNorm = 44.9193, GNorm = 0.4719, lr_0 = 1.1148e-04
Loss = 4.2372e-02, PNorm = 44.9230, GNorm = 1.8149, lr_0 = 1.0917e-04
Validation rmse = 0.127137
Validation mse = 0.016164
Validation r2 = 0.877085
Epoch 55
Loss = 4.5301e-02, PNorm = 44.9272, GNorm = 0.5721, lr_0 = 1.0669e-04
Loss = 5.0627e-02, PNorm = 44.9308, GNorm = 0.6516, lr_0 = 1.0449e-04
Validation rmse = 0.128262
Validation mse = 0.016451
Validation r2 = 0.874901
Epoch 56
Loss = 4.1013e-02, PNorm = 44.9340, GNorm = 0.8310, lr_0 = 1.0233e-04
Loss = 5.1238e-02, PNorm = 44.9370, GNorm = 1.2569, lr_0 = 1.0021e-04
Validation rmse = 0.127427
Validation mse = 0.016238
Validation r2 = 0.876524
Epoch 57
Loss = 4.3368e-02, PNorm = 44.9407, GNorm = 1.2230, lr_0 = 1.0000e-04
Loss = 5.5821e-02, PNorm = 44.9443, GNorm = 1.0471, lr_0 = 1.0000e-04
Validation rmse = 0.128642
Validation mse = 0.016549
Validation r2 = 0.874158
Epoch 58
Loss = 4.2373e-02, PNorm = 44.9476, GNorm = 1.2618, lr_0 = 1.0000e-04
Loss = 5.3348e-02, PNorm = 44.9513, GNorm = 1.8435, lr_0 = 1.0000e-04
Loss = 4.0367e-02, PNorm = 44.9517, GNorm = 1.0700, lr_0 = 1.0000e-04
Validation rmse = 0.128331
Validation mse = 0.016469
Validation r2 = 0.874766
Epoch 59
Loss = 4.1880e-02, PNorm = 44.9550, GNorm = 0.4398, lr_0 = 1.0000e-04
Loss = 5.2812e-02, PNorm = 44.9587, GNorm = 0.9464, lr_0 = 1.0000e-04
Validation rmse = 0.127944
Validation mse = 0.016370
Validation r2 = 0.875520
Model 0 best validation rmse = 0.126723 on epoch 40
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.137607
Model 0 test mse = 0.018936
Model 0 test r2 = 0.842350
Ensemble test rmse = 0.137607
Ensemble test mse = 0.018936
Ensemble test r2 = 0.842350
10-fold cross validation
	Seed 0 ==> test rmse = 0.117189
	Seed 0 ==> test mse = 0.013733
	Seed 0 ==> test r2 = 0.878657
	Seed 1 ==> test rmse = 0.122766
	Seed 1 ==> test mse = 0.015071
	Seed 1 ==> test r2 = 0.853301
	Seed 2 ==> test rmse = 0.137479
	Seed 2 ==> test mse = 0.018900
	Seed 2 ==> test r2 = 0.841504
	Seed 3 ==> test rmse = 0.129478
	Seed 3 ==> test mse = 0.016765
	Seed 3 ==> test r2 = 0.873194
	Seed 4 ==> test rmse = 0.129155
	Seed 4 ==> test mse = 0.016681
	Seed 4 ==> test r2 = 0.864614
	Seed 5 ==> test rmse = 0.126247
	Seed 5 ==> test mse = 0.015938
	Seed 5 ==> test r2 = 0.863583
	Seed 6 ==> test rmse = 0.118161
	Seed 6 ==> test mse = 0.013962
	Seed 6 ==> test r2 = 0.876648
	Seed 7 ==> test rmse = 0.128956
	Seed 7 ==> test mse = 0.016630
	Seed 7 ==> test r2 = 0.865779
	Seed 8 ==> test rmse = 0.127823
	Seed 8 ==> test mse = 0.016339
	Seed 8 ==> test r2 = 0.847585
	Seed 9 ==> test rmse = 0.137607
	Seed 9 ==> test mse = 0.018936
	Seed 9 ==> test r2 = 0.842350
Overall test rmse = 0.127486 +/- 0.006543
Overall test mse = 0.016296 +/- 0.001670
Overall test r2 = 0.860722 +/- 0.013093
Elapsed time = 0:06:09
