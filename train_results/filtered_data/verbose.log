Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/bin/chemprop_train --data_path ./data/filtered_dm300.csv --dataset_type regression --save_dir ./train_results/filtered_data/ --quiet --smiles_columns full_smiles --target_columns dm300 --epochs 60 --extra_metrics r2
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/filtered_dm300.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './train_results/filtered_data/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 977 | train size = 781 | val size = 98 | test size = 98
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.3437e-01, PNorm = 34.0176, GNorm = 6.0770, lr_0 = 4.3000e-04
Validation rmse = 0.322240
Validation r2 = 0.190204
Epoch 1
Loss = 7.2516e-01, PNorm = 34.0521, GNorm = 5.7574, lr_0 = 7.6000e-04
Loss = 6.1480e-01, PNorm = 34.1157, GNorm = 3.8394, lr_0 = 9.9472e-04
Validation rmse = 0.292340
Validation r2 = 0.333510
Epoch 2
Loss = 5.0602e-01, PNorm = 34.1930, GNorm = 10.0691, lr_0 = 9.6874e-04
Validation rmse = 0.259454
Validation r2 = 0.475027
Epoch 3
Loss = 4.4449e-01, PNorm = 34.2684, GNorm = 1.4933, lr_0 = 9.4094e-04
Loss = 3.7705e-01, PNorm = 34.3268, GNorm = 3.4051, lr_0 = 9.1637e-04
Validation rmse = 0.278540
Validation r2 = 0.394949
Epoch 4
Loss = 3.2852e-01, PNorm = 34.3715, GNorm = 1.2157, lr_0 = 8.9243e-04
Validation rmse = 0.257442
Validation r2 = 0.483138
Epoch 5
Loss = 4.8284e-01, PNorm = 34.4195, GNorm = 7.5122, lr_0 = 8.6912e-04
Loss = 3.1986e-01, PNorm = 34.4589, GNorm = 3.7766, lr_0 = 8.4642e-04
Validation rmse = 0.237423
Validation r2 = 0.560395
Epoch 6
Loss = 2.9595e-01, PNorm = 34.5007, GNorm = 2.1688, lr_0 = 8.2213e-04
Validation rmse = 0.226458
Validation r2 = 0.600061
Epoch 7
Loss = 2.4973e-01, PNorm = 34.5359, GNorm = 3.0204, lr_0 = 8.0066e-04
Loss = 2.9266e-01, PNorm = 34.5784, GNorm = 1.9074, lr_0 = 7.7975e-04
Validation rmse = 0.201037
Validation r2 = 0.684812
Epoch 8
Loss = 2.2367e-01, PNorm = 34.6233, GNorm = 3.7974, lr_0 = 7.5737e-04
Loss = 2.4601e-01, PNorm = 34.6579, GNorm = 2.0101, lr_0 = 7.3759e-04
Validation rmse = 0.191634
Validation r2 = 0.713606
Epoch 9
Loss = 2.1940e-01, PNorm = 34.6931, GNorm = 1.1358, lr_0 = 7.1833e-04
Validation rmse = 0.202102
Validation r2 = 0.681463
Epoch 10
Loss = 2.4443e-01, PNorm = 34.7244, GNorm = 4.7854, lr_0 = 6.9956e-04
Loss = 2.1217e-01, PNorm = 34.7548, GNorm = 1.3004, lr_0 = 6.8129e-04
Validation rmse = 0.190290
Validation r2 = 0.717611
Epoch 11
Loss = 2.0157e-01, PNorm = 34.7795, GNorm = 4.3295, lr_0 = 6.6174e-04
Validation rmse = 0.175588
Validation r2 = 0.759559
Epoch 12
Loss = 2.3784e-01, PNorm = 34.8081, GNorm = 1.6178, lr_0 = 6.4446e-04
Loss = 2.0322e-01, PNorm = 34.8334, GNorm = 5.5766, lr_0 = 6.2763e-04
Validation rmse = 0.189605
Validation r2 = 0.719638
Epoch 13
Loss = 1.8425e-01, PNorm = 34.8574, GNorm = 1.1705, lr_0 = 6.1123e-04
Validation rmse = 0.184725
Validation r2 = 0.733887
Epoch 14
Loss = 1.4706e-01, PNorm = 34.8800, GNorm = 1.2040, lr_0 = 5.9369e-04
Loss = 2.3476e-01, PNorm = 34.9076, GNorm = 3.0521, lr_0 = 5.7819e-04
Validation rmse = 0.183857
Validation r2 = 0.736380
Epoch 15
Loss = 1.9122e-01, PNorm = 34.9298, GNorm = 2.5287, lr_0 = 5.6309e-04
Validation rmse = 0.176757
Validation r2 = 0.756348
Epoch 16
Loss = 3.0726e-01, PNorm = 34.9490, GNorm = 0.9124, lr_0 = 5.4693e-04
Loss = 1.6745e-01, PNorm = 34.9679, GNorm = 1.1905, lr_0 = 5.3264e-04
Validation rmse = 0.170316
Validation r2 = 0.773780
Epoch 17
Loss = 1.9459e-01, PNorm = 34.9912, GNorm = 3.6335, lr_0 = 5.1873e-04
Loss = 1.5968e-01, PNorm = 35.0085, GNorm = 1.2890, lr_0 = 5.0518e-04
Validation rmse = 0.178994
Validation r2 = 0.750143
Epoch 18
Loss = 1.5689e-01, PNorm = 35.0252, GNorm = 1.1081, lr_0 = 4.9199e-04
Validation rmse = 0.174560
Validation r2 = 0.762368
Epoch 19
Loss = 1.3828e-01, PNorm = 35.0436, GNorm = 0.9912, lr_0 = 4.7787e-04
Loss = 1.6653e-01, PNorm = 35.0597, GNorm = 1.4943, lr_0 = 4.6539e-04
Validation rmse = 0.166802
Validation r2 = 0.783019
Epoch 20
Loss = 1.2766e-01, PNorm = 35.0756, GNorm = 1.5738, lr_0 = 4.5323e-04
Validation rmse = 0.182968
Validation r2 = 0.738925
Epoch 21
Loss = 1.3636e-01, PNorm = 35.0888, GNorm = 1.0415, lr_0 = 4.4140e-04
Loss = 1.6454e-01, PNorm = 35.1016, GNorm = 3.6588, lr_0 = 4.2987e-04
Validation rmse = 0.179062
Validation r2 = 0.749951
Epoch 22
Loss = 1.6658e-01, PNorm = 35.1206, GNorm = 4.3792, lr_0 = 4.1753e-04
Validation rmse = 0.196277
Validation r2 = 0.699561
Epoch 23
Loss = 1.4398e-01, PNorm = 35.1353, GNorm = 3.8245, lr_0 = 4.0663e-04
Loss = 1.6501e-01, PNorm = 35.1450, GNorm = 3.4037, lr_0 = 3.9601e-04
Validation rmse = 0.172894
Validation r2 = 0.766880
Epoch 24
Loss = 1.5095e-01, PNorm = 35.1579, GNorm = 2.8804, lr_0 = 3.8464e-04
Loss = 1.3870e-01, PNorm = 35.1720, GNorm = 1.0883, lr_0 = 3.7460e-04
Validation rmse = 0.174186
Validation r2 = 0.763384
Epoch 25
Loss = 1.3322e-01, PNorm = 35.1794, GNorm = 1.9325, lr_0 = 3.6481e-04
Validation rmse = 0.171649
Validation r2 = 0.770227
Epoch 26
Loss = 1.6904e-01, PNorm = 35.1918, GNorm = 1.5375, lr_0 = 3.5528e-04
Loss = 1.2414e-01, PNorm = 35.2041, GNorm = 0.8968, lr_0 = 3.4600e-04
Validation rmse = 0.165939
Validation r2 = 0.785259
Epoch 27
Loss = 1.3567e-01, PNorm = 35.2155, GNorm = 1.6395, lr_0 = 3.3608e-04
Validation rmse = 0.164663
Validation r2 = 0.788549
Epoch 28
Loss = 1.2824e-01, PNorm = 35.2275, GNorm = 1.7110, lr_0 = 3.2730e-04
Loss = 1.4260e-01, PNorm = 35.2374, GNorm = 3.1609, lr_0 = 3.1875e-04
Validation rmse = 0.164507
Validation r2 = 0.788950
Epoch 29
Loss = 1.6495e-01, PNorm = 35.2527, GNorm = 1.0769, lr_0 = 3.0960e-04
Validation rmse = 0.171264
Validation r2 = 0.771256
Epoch 30
Loss = 1.1926e-01, PNorm = 35.2609, GNorm = 0.6109, lr_0 = 3.0152e-04
Loss = 1.3439e-01, PNorm = 35.2684, GNorm = 1.4229, lr_0 = 2.9364e-04
Validation rmse = 0.167811
Validation r2 = 0.780386
Epoch 31
Loss = 1.1003e-01, PNorm = 35.2774, GNorm = 1.3615, lr_0 = 2.8597e-04
Validation rmse = 0.167316
Validation r2 = 0.781682
Epoch 32
Loss = 1.4565e-01, PNorm = 35.2874, GNorm = 1.0633, lr_0 = 2.7777e-04
Loss = 1.3482e-01, PNorm = 35.2967, GNorm = 1.0209, lr_0 = 2.7051e-04
Validation rmse = 0.171978
Validation r2 = 0.769344
Epoch 33
Loss = 1.1436e-01, PNorm = 35.3048, GNorm = 0.7654, lr_0 = 2.6344e-04
Loss = 1.1545e-01, PNorm = 35.3128, GNorm = 2.2254, lr_0 = 2.5656e-04
Validation rmse = 0.168664
Validation r2 = 0.778149
Epoch 34
Loss = 1.4399e-01, PNorm = 35.3206, GNorm = 0.8775, lr_0 = 2.4986e-04
Validation rmse = 0.162789
Validation r2 = 0.793335
Epoch 35
Loss = 9.6772e-02, PNorm = 35.3290, GNorm = 1.1943, lr_0 = 2.4269e-04
Loss = 1.3947e-01, PNorm = 35.3374, GNorm = 1.8730, lr_0 = 2.3635e-04
Validation rmse = 0.163560
Validation r2 = 0.791373
Epoch 36
Loss = 1.3175e-01, PNorm = 35.3446, GNorm = 0.8535, lr_0 = 2.3018e-04
Validation rmse = 0.181002
Validation r2 = 0.744503
Epoch 37
Loss = 1.8603e-01, PNorm = 35.3530, GNorm = 0.4810, lr_0 = 2.2358e-04
Loss = 1.1012e-01, PNorm = 35.3617, GNorm = 1.1868, lr_0 = 2.1774e-04
Validation rmse = 0.163885
Validation r2 = 0.790543
Epoch 38
Loss = 1.3087e-01, PNorm = 35.3689, GNorm = 0.8952, lr_0 = 2.1205e-04
Validation rmse = 0.168431
Validation r2 = 0.778761
Epoch 39
Loss = 1.0541e-01, PNorm = 35.3756, GNorm = 0.5497, lr_0 = 2.0651e-04
Loss = 1.2586e-01, PNorm = 35.3820, GNorm = 1.0082, lr_0 = 2.0112e-04
Validation rmse = 0.163938
Validation r2 = 0.790407
Epoch 40
Loss = 8.5981e-02, PNorm = 35.3899, GNorm = 1.1258, lr_0 = 1.9535e-04
Loss = 1.5231e-01, PNorm = 35.3973, GNorm = 5.5113, lr_0 = 1.9024e-04
Validation rmse = 0.167458
Validation r2 = 0.781311
Epoch 41
Loss = 1.0791e-01, PNorm = 35.4041, GNorm = 1.8409, lr_0 = 1.8527e-04
Validation rmse = 0.167368
Validation r2 = 0.781546
Epoch 42
Loss = 1.4303e-01, PNorm = 35.4118, GNorm = 0.7069, lr_0 = 1.8044e-04
Loss = 1.1140e-01, PNorm = 35.4188, GNorm = 1.3376, lr_0 = 1.7572e-04
Validation rmse = 0.167010
Validation r2 = 0.782479
Epoch 43
Loss = 1.3786e-01, PNorm = 35.4254, GNorm = 0.5856, lr_0 = 1.7068e-04
Validation rmse = 0.162959
Validation r2 = 0.792903
Epoch 44
Loss = 8.0106e-02, PNorm = 35.4291, GNorm = 1.3233, lr_0 = 1.6622e-04
Loss = 1.3389e-01, PNorm = 35.4342, GNorm = 3.2613, lr_0 = 1.6188e-04
Validation rmse = 0.162781
Validation r2 = 0.793354
Epoch 45
Loss = 1.1639e-01, PNorm = 35.4405, GNorm = 1.5161, lr_0 = 1.5724e-04
Validation rmse = 0.165697
Validation r2 = 0.785886
Epoch 46
Loss = 1.0464e-01, PNorm = 35.4469, GNorm = 1.7193, lr_0 = 1.5313e-04
Loss = 1.1446e-01, PNorm = 35.4516, GNorm = 1.0876, lr_0 = 1.4913e-04
Validation rmse = 0.176455
Validation r2 = 0.757180
Epoch 47
Loss = 1.2362e-01, PNorm = 35.4559, GNorm = 2.2616, lr_0 = 1.4523e-04
Validation rmse = 0.160547
Validation r2 = 0.798989
Epoch 48
Loss = 8.9852e-02, PNorm = 35.4627, GNorm = 2.1654, lr_0 = 1.4107e-04
Loss = 1.2342e-01, PNorm = 35.4678, GNorm = 0.7359, lr_0 = 1.3738e-04
Validation rmse = 0.169046
Validation r2 = 0.777144
Epoch 49
Loss = 1.0923e-01, PNorm = 35.4732, GNorm = 3.2161, lr_0 = 1.3379e-04
Loss = 1.1608e-01, PNorm = 35.4775, GNorm = 0.9473, lr_0 = 1.3030e-04
Validation rmse = 0.162873
Validation r2 = 0.793122
Epoch 50
Loss = 1.2840e-01, PNorm = 35.4816, GNorm = 1.0332, lr_0 = 1.2690e-04
Validation rmse = 0.161554
Validation r2 = 0.796459
Epoch 51
Loss = 9.5639e-02, PNorm = 35.4862, GNorm = 0.8906, lr_0 = 1.2326e-04
Loss = 1.0834e-01, PNorm = 35.4900, GNorm = 1.4691, lr_0 = 1.2004e-04
Validation rmse = 0.164845
Validation r2 = 0.788081
Epoch 52
Loss = 1.1268e-01, PNorm = 35.4937, GNorm = 0.8469, lr_0 = 1.1690e-04
Validation rmse = 0.163395
Validation r2 = 0.791793
Epoch 53
Loss = 1.2913e-01, PNorm = 35.4980, GNorm = 2.7224, lr_0 = 1.1355e-04
Loss = 1.0950e-01, PNorm = 35.5026, GNorm = 1.5372, lr_0 = 1.1058e-04
Validation rmse = 0.161796
Validation r2 = 0.795849
Epoch 54
Loss = 1.1207e-01, PNorm = 35.5070, GNorm = 1.7320, lr_0 = 1.0769e-04
Validation rmse = 0.166313
Validation r2 = 0.784291
Epoch 55
Loss = 1.2456e-01, PNorm = 35.5105, GNorm = 1.4525, lr_0 = 1.0488e-04
Loss = 1.1130e-01, PNorm = 35.5140, GNorm = 1.5889, lr_0 = 1.0214e-04
Validation rmse = 0.164625
Validation r2 = 0.788646
Epoch 56
Loss = 1.2197e-01, PNorm = 35.5181, GNorm = 1.2651, lr_0 = 1.0000e-04
Loss = 9.9076e-02, PNorm = 35.5218, GNorm = 1.2132, lr_0 = 1.0000e-04
Validation rmse = 0.162449
Validation r2 = 0.794197
Epoch 57
Loss = 1.0765e-01, PNorm = 35.5254, GNorm = 1.5312, lr_0 = 1.0000e-04
Validation rmse = 0.163626
Validation r2 = 0.791205
Epoch 58
Loss = 1.0374e-01, PNorm = 35.5292, GNorm = 1.0741, lr_0 = 1.0000e-04
Loss = 1.0648e-01, PNorm = 35.5318, GNorm = 1.4982, lr_0 = 1.0000e-04
Validation rmse = 0.163414
Validation r2 = 0.791744
Epoch 59
Loss = 1.2032e-01, PNorm = 35.5363, GNorm = 2.0277, lr_0 = 1.0000e-04
Validation rmse = 0.161995
Validation r2 = 0.795347
Model 0 best validation rmse = 0.160547 on epoch 47
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.156167
Model 0 test r2 = 0.879024
Ensemble test rmse = 0.156167
Ensemble test r2 = 0.879024
1-fold cross validation
	Seed 0 ==> test rmse = 0.156167
	Seed 0 ==> test r2 = 0.879024
Overall test rmse = 0.156167 +/- 0.000000
Overall test r2 = 0.879024 +/- 0.000000
Elapsed time = 0:00:37
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/bin/chemprop_train --data_path ./data/filtered_dm300.csv --dataset_type regression --save_dir ./train_results/filtered_data/ --quiet --smiles_columns full_smiles --target_columns dm300 --epochs 60 --extra_metrics r2 --num_folds 10
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/filtered_dm300.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './train_results/filtered_data/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 977 | train size = 781 | val size = 98 | test size = 98
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.3437e-01, PNorm = 34.0176, GNorm = 6.0770, lr_0 = 4.3000e-04
Validation rmse = 0.322240
Validation r2 = 0.190204
Epoch 1
Loss = 7.2516e-01, PNorm = 34.0521, GNorm = 5.7574, lr_0 = 7.6000e-04
Loss = 6.1480e-01, PNorm = 34.1157, GNorm = 3.8394, lr_0 = 9.9472e-04
Validation rmse = 0.292340
Validation r2 = 0.333510
Epoch 2
Loss = 5.0602e-01, PNorm = 34.1930, GNorm = 10.0695, lr_0 = 9.6874e-04
Validation rmse = 0.259455
Validation r2 = 0.475023
Epoch 3
Loss = 4.4445e-01, PNorm = 34.2684, GNorm = 1.4936, lr_0 = 9.4094e-04
Loss = 3.7701e-01, PNorm = 34.3269, GNorm = 3.3900, lr_0 = 9.1637e-04
Validation rmse = 0.278515
Validation r2 = 0.395059
Epoch 4
Loss = 3.2687e-01, PNorm = 34.3716, GNorm = 1.1387, lr_0 = 8.9243e-04
Validation rmse = 0.257745
Validation r2 = 0.481918
Epoch 5
Loss = 4.8413e-01, PNorm = 34.4192, GNorm = 7.5294, lr_0 = 8.6912e-04
Loss = 3.1983e-01, PNorm = 34.4581, GNorm = 3.7226, lr_0 = 8.4642e-04
Validation rmse = 0.237607
Validation r2 = 0.559712
Epoch 6
Loss = 2.9615e-01, PNorm = 34.4998, GNorm = 2.2739, lr_0 = 8.2213e-04
Validation rmse = 0.226432
Validation r2 = 0.600154
Epoch 7
Loss = 2.4731e-01, PNorm = 34.5347, GNorm = 2.9628, lr_0 = 8.0066e-04
Loss = 2.9429e-01, PNorm = 34.5769, GNorm = 1.9823, lr_0 = 7.7975e-04
Validation rmse = 0.200948
Validation r2 = 0.685092
Epoch 8
Loss = 2.2552e-01, PNorm = 34.6210, GNorm = 3.8133, lr_0 = 7.5737e-04
Loss = 2.4724e-01, PNorm = 34.6547, GNorm = 1.6957, lr_0 = 7.3759e-04
Validation rmse = 0.191933
Validation r2 = 0.712714
Epoch 9
Loss = 2.2105e-01, PNorm = 34.6886, GNorm = 0.6609, lr_0 = 7.1833e-04
Validation rmse = 0.204319
Validation r2 = 0.674436
Epoch 10
Loss = 2.4654e-01, PNorm = 34.7191, GNorm = 5.5557, lr_0 = 6.9956e-04
Loss = 2.1162e-01, PNorm = 34.7500, GNorm = 1.3659, lr_0 = 6.8129e-04
Validation rmse = 0.192429
Validation r2 = 0.711225
Epoch 11
Loss = 1.9995e-01, PNorm = 34.7752, GNorm = 4.0722, lr_0 = 6.6174e-04
Validation rmse = 0.176422
Validation r2 = 0.757272
Epoch 12
Loss = 2.3444e-01, PNorm = 34.8039, GNorm = 1.2458, lr_0 = 6.4446e-04
Loss = 2.0229e-01, PNorm = 34.8291, GNorm = 6.4028, lr_0 = 6.2763e-04
Validation rmse = 0.184858
Validation r2 = 0.733503
Epoch 13
Loss = 1.8102e-01, PNorm = 34.8521, GNorm = 1.2097, lr_0 = 6.1123e-04
Validation rmse = 0.184612
Validation r2 = 0.734210
Epoch 14
Loss = 1.4623e-01, PNorm = 34.8749, GNorm = 1.2363, lr_0 = 5.9369e-04
Loss = 2.3164e-01, PNorm = 34.9024, GNorm = 2.5792, lr_0 = 5.7819e-04
Validation rmse = 0.183139
Validation r2 = 0.738437
Epoch 15
Loss = 1.9267e-01, PNorm = 34.9222, GNorm = 2.6070, lr_0 = 5.6309e-04
Validation rmse = 0.175722
Validation r2 = 0.759194
Epoch 16
Loss = 3.1130e-01, PNorm = 34.9409, GNorm = 1.0042, lr_0 = 5.4693e-04
Loss = 1.7273e-01, PNorm = 34.9592, GNorm = 0.7334, lr_0 = 5.3264e-04
Validation rmse = 0.172743
Validation r2 = 0.767288
Epoch 17
Loss = 2.0015e-01, PNorm = 34.9825, GNorm = 4.2629, lr_0 = 5.1873e-04
Loss = 1.6168e-01, PNorm = 35.0004, GNorm = 1.2527, lr_0 = 5.0518e-04
Validation rmse = 0.180293
Validation r2 = 0.746503
Epoch 18
Loss = 1.5780e-01, PNorm = 35.0165, GNorm = 1.3830, lr_0 = 4.9199e-04
Validation rmse = 0.175214
Validation r2 = 0.760584
Epoch 19
Loss = 1.3874e-01, PNorm = 35.0337, GNorm = 1.0909, lr_0 = 4.7787e-04
Loss = 1.6667e-01, PNorm = 35.0495, GNorm = 1.4564, lr_0 = 4.6539e-04
Validation rmse = 0.166026
Validation r2 = 0.785035
Epoch 20
Loss = 1.2821e-01, PNorm = 35.0658, GNorm = 1.5030, lr_0 = 4.5323e-04
Validation rmse = 0.183966
Validation r2 = 0.736068
Epoch 21
Loss = 1.3618e-01, PNorm = 35.0793, GNorm = 1.1418, lr_0 = 4.4140e-04
Loss = 1.6640e-01, PNorm = 35.0920, GNorm = 3.5512, lr_0 = 4.2987e-04
Validation rmse = 0.179432
Validation r2 = 0.748918
Epoch 22
Loss = 1.6628e-01, PNorm = 35.1111, GNorm = 4.2221, lr_0 = 4.1753e-04
Validation rmse = 0.196098
Validation r2 = 0.700108
Epoch 23
Loss = 1.4452e-01, PNorm = 35.1260, GNorm = 3.9548, lr_0 = 4.0663e-04
Loss = 1.6700e-01, PNorm = 35.1364, GNorm = 3.6095, lr_0 = 3.9601e-04
Validation rmse = 0.170684
Validation r2 = 0.772802
Epoch 24
Loss = 1.5121e-01, PNorm = 35.1491, GNorm = 2.9001, lr_0 = 3.8464e-04
Loss = 1.3759e-01, PNorm = 35.1626, GNorm = 1.0929, lr_0 = 3.7460e-04
Validation rmse = 0.172652
Validation r2 = 0.767534
Epoch 25
Loss = 1.3226e-01, PNorm = 35.1697, GNorm = 1.8075, lr_0 = 3.6481e-04
Validation rmse = 0.170088
Validation r2 = 0.774386
Epoch 26
Loss = 1.6874e-01, PNorm = 35.1820, GNorm = 1.6458, lr_0 = 3.5528e-04
Loss = 1.2310e-01, PNorm = 35.1944, GNorm = 0.8575, lr_0 = 3.4600e-04
Validation rmse = 0.164498
Validation r2 = 0.788972
Epoch 27
Loss = 1.3318e-01, PNorm = 35.2061, GNorm = 1.6144, lr_0 = 3.3608e-04
Validation rmse = 0.163138
Validation r2 = 0.792448
Epoch 28
Loss = 1.2659e-01, PNorm = 35.2179, GNorm = 1.9203, lr_0 = 3.2730e-04
Loss = 1.4263e-01, PNorm = 35.2274, GNorm = 3.1262, lr_0 = 3.1875e-04
Validation rmse = 0.163864
Validation r2 = 0.790596
Epoch 29
Loss = 1.6391e-01, PNorm = 35.2421, GNorm = 1.1600, lr_0 = 3.0960e-04
Validation rmse = 0.170217
Validation r2 = 0.774044
Epoch 30
Loss = 1.1993e-01, PNorm = 35.2498, GNorm = 0.5871, lr_0 = 3.0152e-04
Loss = 1.3327e-01, PNorm = 35.2572, GNorm = 1.1945, lr_0 = 2.9364e-04
Validation rmse = 0.166101
Validation r2 = 0.784840
Epoch 31
Loss = 1.0814e-01, PNorm = 35.2662, GNorm = 1.2552, lr_0 = 2.8597e-04
Validation rmse = 0.165944
Validation r2 = 0.785247
Epoch 32
Loss = 1.4711e-01, PNorm = 35.2760, GNorm = 1.0836, lr_0 = 2.7777e-04
Loss = 1.3329e-01, PNorm = 35.2852, GNorm = 1.0359, lr_0 = 2.7051e-04
Validation rmse = 0.171493
Validation r2 = 0.770643
Epoch 33
Loss = 1.1476e-01, PNorm = 35.2931, GNorm = 0.7558, lr_0 = 2.6344e-04
Loss = 1.1388e-01, PNorm = 35.3007, GNorm = 2.1799, lr_0 = 2.5656e-04
Validation rmse = 0.167326
Validation r2 = 0.781655
Epoch 34
Loss = 1.4247e-01, PNorm = 35.3085, GNorm = 0.9184, lr_0 = 2.4986e-04
Validation rmse = 0.162047
Validation r2 = 0.795215
Epoch 35
Loss = 9.5153e-02, PNorm = 35.3166, GNorm = 1.1349, lr_0 = 2.4269e-04
Loss = 1.3808e-01, PNorm = 35.3248, GNorm = 1.9733, lr_0 = 2.3635e-04
Validation rmse = 0.162375
Validation r2 = 0.794385
Epoch 36
Loss = 1.3070e-01, PNorm = 35.3319, GNorm = 0.7238, lr_0 = 2.3018e-04
Validation rmse = 0.180280
Validation r2 = 0.746538
Epoch 37
Loss = 1.8401e-01, PNorm = 35.3404, GNorm = 0.4775, lr_0 = 2.2358e-04
Loss = 1.0973e-01, PNorm = 35.3487, GNorm = 1.0482, lr_0 = 2.1774e-04
Validation rmse = 0.162569
Validation r2 = 0.793892
Epoch 38
Loss = 1.2914e-01, PNorm = 35.3557, GNorm = 0.9327, lr_0 = 2.1205e-04
Validation rmse = 0.167259
Validation r2 = 0.781831
Epoch 39
Loss = 1.0725e-01, PNorm = 35.3623, GNorm = 0.5467, lr_0 = 2.0651e-04
Loss = 1.2568e-01, PNorm = 35.3682, GNorm = 0.9498, lr_0 = 2.0112e-04
Validation rmse = 0.162536
Validation r2 = 0.793976
Epoch 40
Loss = 8.6387e-02, PNorm = 35.3759, GNorm = 1.1151, lr_0 = 1.9535e-04
Loss = 1.5056e-01, PNorm = 35.3829, GNorm = 5.4875, lr_0 = 1.9024e-04
Validation rmse = 0.166544
Validation r2 = 0.783692
Epoch 41
Loss = 1.0768e-01, PNorm = 35.3896, GNorm = 1.7092, lr_0 = 1.8527e-04
Validation rmse = 0.165890
Validation r2 = 0.785385
Epoch 42
Loss = 1.3992e-01, PNorm = 35.3971, GNorm = 0.6254, lr_0 = 1.8044e-04
Loss = 1.1106e-01, PNorm = 35.4038, GNorm = 1.2108, lr_0 = 1.7572e-04
Validation rmse = 0.165567
Validation r2 = 0.786221
Epoch 43
Loss = 1.3645e-01, PNorm = 35.4101, GNorm = 0.5697, lr_0 = 1.7068e-04
Validation rmse = 0.161249
Validation r2 = 0.797226
Epoch 44
Loss = 7.9679e-02, PNorm = 35.4135, GNorm = 1.4090, lr_0 = 1.6622e-04
Loss = 1.3280e-01, PNorm = 35.4183, GNorm = 3.2105, lr_0 = 1.6188e-04
Validation rmse = 0.161773
Validation r2 = 0.795907
Epoch 45
Loss = 1.1439e-01, PNorm = 35.4246, GNorm = 1.3589, lr_0 = 1.5724e-04
Validation rmse = 0.164040
Validation r2 = 0.790145
Epoch 46
Loss = 1.0267e-01, PNorm = 35.4306, GNorm = 1.8179, lr_0 = 1.5313e-04
Loss = 1.1298e-01, PNorm = 35.4349, GNorm = 0.9096, lr_0 = 1.4913e-04
Validation rmse = 0.173894
Validation r2 = 0.764178
Epoch 47
Loss = 1.2242e-01, PNorm = 35.4389, GNorm = 2.1343, lr_0 = 1.4523e-04
Validation rmse = 0.159449
Validation r2 = 0.801729
Epoch 48
Loss = 9.1461e-02, PNorm = 35.4455, GNorm = 2.2397, lr_0 = 1.4107e-04
Loss = 1.2174e-01, PNorm = 35.4502, GNorm = 0.7537, lr_0 = 1.3738e-04
Validation rmse = 0.167930
Validation r2 = 0.780077
Epoch 49
Loss = 1.0723e-01, PNorm = 35.4553, GNorm = 2.9947, lr_0 = 1.3379e-04
Loss = 1.1562e-01, PNorm = 35.4595, GNorm = 0.9850, lr_0 = 1.3030e-04
Validation rmse = 0.161994
Validation r2 = 0.795349
Epoch 50
Loss = 1.2719e-01, PNorm = 35.4637, GNorm = 0.9713, lr_0 = 1.2690e-04
Validation rmse = 0.160145
Validation r2 = 0.799993
Epoch 51
Loss = 9.5056e-02, PNorm = 35.4683, GNorm = 1.0589, lr_0 = 1.2326e-04
Loss = 1.0815e-01, PNorm = 35.4721, GNorm = 1.4213, lr_0 = 1.2004e-04
Validation rmse = 0.163544
Validation r2 = 0.791414
Epoch 52
Loss = 1.1149e-01, PNorm = 35.4758, GNorm = 0.8205, lr_0 = 1.1690e-04
Validation rmse = 0.162405
Validation r2 = 0.794308
Epoch 53
Loss = 1.2720e-01, PNorm = 35.4800, GNorm = 2.6971, lr_0 = 1.1355e-04
Loss = 1.0913e-01, PNorm = 35.4844, GNorm = 1.5926, lr_0 = 1.1058e-04
Validation rmse = 0.160941
Validation r2 = 0.797999
Epoch 54
Loss = 1.1095e-01, PNorm = 35.4886, GNorm = 1.6270, lr_0 = 1.0769e-04
Validation rmse = 0.165674
Validation r2 = 0.785946
Epoch 55
Loss = 1.2361e-01, PNorm = 35.4922, GNorm = 1.5256, lr_0 = 1.0488e-04
Loss = 1.1046e-01, PNorm = 35.4956, GNorm = 1.5966, lr_0 = 1.0214e-04
Validation rmse = 0.163132
Validation r2 = 0.792464
Epoch 56
Loss = 1.2079e-01, PNorm = 35.4996, GNorm = 1.2394, lr_0 = 1.0000e-04
Loss = 9.8847e-02, PNorm = 35.5033, GNorm = 1.2140, lr_0 = 1.0000e-04
Validation rmse = 0.161325
Validation r2 = 0.797035
Epoch 57
Loss = 1.0642e-01, PNorm = 35.5069, GNorm = 1.6236, lr_0 = 1.0000e-04
Validation rmse = 0.162258
Validation r2 = 0.794681
Epoch 58
Loss = 1.0242e-01, PNorm = 35.5106, GNorm = 1.1706, lr_0 = 1.0000e-04
Loss = 1.0587e-01, PNorm = 35.5133, GNorm = 1.5619, lr_0 = 1.0000e-04
Validation rmse = 0.162376
Validation r2 = 0.794381
Epoch 59
Loss = 1.1989e-01, PNorm = 35.5174, GNorm = 1.9950, lr_0 = 1.0000e-04
Validation rmse = 0.161253
Validation r2 = 0.797215
Model 0 best validation rmse = 0.159449 on epoch 47
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.155780
Model 0 test r2 = 0.879623
Ensemble test rmse = 0.155780
Ensemble test r2 = 0.879623
Fold 1
Splitting data with seed 1
Total size = 977 | train size = 781 | val size = 98 | test size = 98
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 8.2254e-01, PNorm = 34.0161, GNorm = 2.0241, lr_0 = 4.3000e-04
Validation rmse = 0.437185
Validation r2 = 0.171215
Epoch 1
Loss = 8.6225e-01, PNorm = 34.0507, GNorm = 8.0038, lr_0 = 7.6000e-04
Loss = 6.1030e-01, PNorm = 34.1169, GNorm = 5.8521, lr_0 = 9.9472e-04
Validation rmse = 0.375338
Validation r2 = 0.389118
Epoch 2
Loss = 5.0980e-01, PNorm = 34.1942, GNorm = 5.3503, lr_0 = 9.6874e-04
Validation rmse = 0.267989
Validation r2 = 0.688582
Epoch 3
Loss = 3.0472e-01, PNorm = 34.2752, GNorm = 1.2812, lr_0 = 9.4094e-04
Loss = 3.9070e-01, PNorm = 34.3353, GNorm = 2.0581, lr_0 = 9.1637e-04
Validation rmse = 0.260665
Validation r2 = 0.705370
Epoch 4
Loss = 3.9017e-01, PNorm = 34.3869, GNorm = 4.9211, lr_0 = 8.9243e-04
Validation rmse = 0.266685
Validation r2 = 0.691604
Epoch 5
Loss = 2.2420e-01, PNorm = 34.4174, GNorm = 0.5454, lr_0 = 8.6912e-04
Loss = 3.1124e-01, PNorm = 34.4614, GNorm = 2.6864, lr_0 = 8.4642e-04
Validation rmse = 0.211662
Validation r2 = 0.805734
Epoch 6
Loss = 2.4889e-01, PNorm = 34.4996, GNorm = 0.8921, lr_0 = 8.2213e-04
Validation rmse = 0.217382
Validation r2 = 0.795092
Epoch 7
Loss = 1.7061e-01, PNorm = 34.5360, GNorm = 3.4109, lr_0 = 8.0066e-04
Loss = 2.6708e-01, PNorm = 34.5705, GNorm = 0.6966, lr_0 = 7.7975e-04
Validation rmse = 0.212252
Validation r2 = 0.804649
Epoch 8
Loss = 2.2384e-01, PNorm = 34.6048, GNorm = 2.3128, lr_0 = 7.5737e-04
Loss = 2.3018e-01, PNorm = 34.6331, GNorm = 1.1607, lr_0 = 7.3759e-04
Validation rmse = 0.203944
Validation r2 = 0.819642
Epoch 9
Loss = 1.8155e-01, PNorm = 34.6644, GNorm = 3.6504, lr_0 = 7.1833e-04
Validation rmse = 0.208414
Validation r2 = 0.811650
Epoch 10
Loss = 1.7803e-01, PNorm = 34.6883, GNorm = 1.3803, lr_0 = 6.9956e-04
Loss = 1.9974e-01, PNorm = 34.7161, GNorm = 1.8235, lr_0 = 6.8129e-04
Validation rmse = 0.198258
Validation r2 = 0.829559
Epoch 11
Loss = 1.9870e-01, PNorm = 34.7515, GNorm = 2.3410, lr_0 = 6.6174e-04
Validation rmse = 0.216340
Validation r2 = 0.797051
Epoch 12
Loss = 2.1366e-01, PNorm = 34.7718, GNorm = 1.7803, lr_0 = 6.4446e-04
Loss = 2.4512e-01, PNorm = 34.7997, GNorm = 1.4765, lr_0 = 6.2763e-04
Validation rmse = 0.186556
Validation r2 = 0.849086
Epoch 13
Loss = 1.6798e-01, PNorm = 34.8301, GNorm = 1.3172, lr_0 = 6.1123e-04
Validation rmse = 0.180315
Validation r2 = 0.859014
Epoch 14
Loss = 1.2471e-01, PNorm = 34.8594, GNorm = 1.5715, lr_0 = 5.9369e-04
Loss = 2.0195e-01, PNorm = 34.8825, GNorm = 3.8125, lr_0 = 5.7819e-04
Validation rmse = 0.182492
Validation r2 = 0.855590
Epoch 15
Loss = 1.9159e-01, PNorm = 34.9058, GNorm = 5.9122, lr_0 = 5.6309e-04
Validation rmse = 0.195728
Validation r2 = 0.833882
Epoch 16
Loss = 2.4760e-01, PNorm = 34.9265, GNorm = 3.3439, lr_0 = 5.4693e-04
Loss = 1.4646e-01, PNorm = 34.9466, GNorm = 1.2798, lr_0 = 5.3264e-04
Validation rmse = 0.208246
Validation r2 = 0.811953
Epoch 17
Loss = 2.1222e-01, PNorm = 34.9653, GNorm = 4.2358, lr_0 = 5.1873e-04
Loss = 1.8229e-01, PNorm = 34.9894, GNorm = 1.0960, lr_0 = 5.0518e-04
Validation rmse = 0.187701
Validation r2 = 0.847227
Epoch 18
Loss = 2.0934e-01, PNorm = 35.0115, GNorm = 2.4867, lr_0 = 4.9199e-04
Validation rmse = 0.184560
Validation r2 = 0.852298
Epoch 19
Loss = 1.4320e-01, PNorm = 35.0303, GNorm = 1.3640, lr_0 = 4.7787e-04
Loss = 1.7060e-01, PNorm = 35.0509, GNorm = 3.7746, lr_0 = 4.6539e-04
Validation rmse = 0.194397
Validation r2 = 0.836133
Epoch 20
Loss = 1.5951e-01, PNorm = 35.0711, GNorm = 0.9711, lr_0 = 4.5323e-04
Validation rmse = 0.198120
Validation r2 = 0.829796
Epoch 21
Loss = 2.0847e-01, PNorm = 35.0901, GNorm = 2.8780, lr_0 = 4.4140e-04
Loss = 1.6250e-01, PNorm = 35.1102, GNorm = 0.7584, lr_0 = 4.2987e-04
Validation rmse = 0.190004
Validation r2 = 0.843456
Epoch 22
Loss = 1.6745e-01, PNorm = 35.1268, GNorm = 1.5429, lr_0 = 4.1753e-04
Validation rmse = 0.172932
Validation r2 = 0.870323
Epoch 23
Loss = 1.4480e-01, PNorm = 35.1426, GNorm = 1.8119, lr_0 = 4.0663e-04
Loss = 1.4821e-01, PNorm = 35.1580, GNorm = 0.5985, lr_0 = 3.9601e-04
Validation rmse = 0.178320
Validation r2 = 0.862117
Epoch 24
Loss = 1.5664e-01, PNorm = 35.1796, GNorm = 1.8561, lr_0 = 3.8464e-04
Loss = 1.3898e-01, PNorm = 35.1956, GNorm = 2.4820, lr_0 = 3.7460e-04
Validation rmse = 0.175487
Validation r2 = 0.866463
Epoch 25
Loss = 1.4910e-01, PNorm = 35.2063, GNorm = 0.9552, lr_0 = 3.6481e-04
Validation rmse = 0.176976
Validation r2 = 0.864187
Epoch 26
Loss = 1.1788e-01, PNorm = 35.2238, GNorm = 0.4763, lr_0 = 3.5528e-04
Loss = 1.4623e-01, PNorm = 35.2387, GNorm = 1.9087, lr_0 = 3.4600e-04
Validation rmse = 0.177322
Validation r2 = 0.863656
Epoch 27
Loss = 1.4407e-01, PNorm = 35.2542, GNorm = 1.6343, lr_0 = 3.3608e-04
Validation rmse = 0.169643
Validation r2 = 0.875209
Epoch 28
Loss = 1.1978e-01, PNorm = 35.2683, GNorm = 2.9240, lr_0 = 3.2730e-04
Loss = 1.5489e-01, PNorm = 35.2813, GNorm = 2.1795, lr_0 = 3.1875e-04
Validation rmse = 0.180194
Validation r2 = 0.859204
Epoch 29
Loss = 1.2434e-01, PNorm = 35.2935, GNorm = 0.9558, lr_0 = 3.0960e-04
Validation rmse = 0.170098
Validation r2 = 0.874538
Epoch 30
Loss = 7.1829e-02, PNorm = 35.3054, GNorm = 0.6719, lr_0 = 3.0152e-04
Loss = 1.4734e-01, PNorm = 35.3195, GNorm = 1.3388, lr_0 = 2.9364e-04
Validation rmse = 0.170338
Validation r2 = 0.874184
Epoch 31
Loss = 1.1524e-01, PNorm = 35.3319, GNorm = 1.1557, lr_0 = 2.8597e-04
Validation rmse = 0.173865
Validation r2 = 0.868920
Epoch 32
Loss = 2.0837e-01, PNorm = 35.3428, GNorm = 0.8334, lr_0 = 2.7777e-04
Loss = 1.1902e-01, PNorm = 35.3505, GNorm = 0.7471, lr_0 = 2.7051e-04
Validation rmse = 0.168213
Validation r2 = 0.877304
Epoch 33
Loss = 1.9377e-01, PNorm = 35.3641, GNorm = 0.9667, lr_0 = 2.6344e-04
Loss = 1.0743e-01, PNorm = 35.3730, GNorm = 0.8153, lr_0 = 2.5656e-04
Validation rmse = 0.179650
Validation r2 = 0.860052
Epoch 34
Loss = 1.4309e-01, PNorm = 35.3821, GNorm = 3.2048, lr_0 = 2.4986e-04
Validation rmse = 0.174516
Validation r2 = 0.867937
Epoch 35
Loss = 1.6374e-01, PNorm = 35.3931, GNorm = 2.4532, lr_0 = 2.4269e-04
Loss = 1.1013e-01, PNorm = 35.4039, GNorm = 1.3880, lr_0 = 2.3635e-04
Validation rmse = 0.169562
Validation r2 = 0.875328
Epoch 36
Loss = 1.1632e-01, PNorm = 35.4112, GNorm = 1.9863, lr_0 = 2.3018e-04
Validation rmse = 0.173154
Validation r2 = 0.869991
Epoch 37
Loss = 9.7799e-02, PNorm = 35.4212, GNorm = 1.1433, lr_0 = 2.2358e-04
Loss = 1.3521e-01, PNorm = 35.4314, GNorm = 1.0578, lr_0 = 2.1774e-04
Validation rmse = 0.176515
Validation r2 = 0.864894
Epoch 38
Loss = 1.3209e-01, PNorm = 35.4402, GNorm = 1.1219, lr_0 = 2.1205e-04
Validation rmse = 0.166279
Validation r2 = 0.880109
Epoch 39
Loss = 7.8539e-02, PNorm = 35.4498, GNorm = 0.5711, lr_0 = 2.0651e-04
Loss = 1.2781e-01, PNorm = 35.4574, GNorm = 1.0471, lr_0 = 2.0112e-04
Validation rmse = 0.173323
Validation r2 = 0.869737
Epoch 40
Loss = 1.0110e-01, PNorm = 35.4671, GNorm = 1.9392, lr_0 = 1.9535e-04
Loss = 1.2484e-01, PNorm = 35.4758, GNorm = 1.1192, lr_0 = 1.9024e-04
Validation rmse = 0.167517
Validation r2 = 0.878318
Epoch 41
Loss = 1.0402e-01, PNorm = 35.4830, GNorm = 1.3489, lr_0 = 1.8527e-04
Validation rmse = 0.167308
Validation r2 = 0.878621
Epoch 42
Loss = 1.0399e-01, PNorm = 35.4888, GNorm = 1.5564, lr_0 = 1.8044e-04
Loss = 1.2777e-01, PNorm = 35.4965, GNorm = 2.4778, lr_0 = 1.7572e-04
Validation rmse = 0.171237
Validation r2 = 0.872853
Epoch 43
Loss = 9.9061e-02, PNorm = 35.5047, GNorm = 0.5729, lr_0 = 1.7068e-04
Validation rmse = 0.168900
Validation r2 = 0.876300
Epoch 44
Loss = 1.4753e-01, PNorm = 35.5110, GNorm = 2.1459, lr_0 = 1.6622e-04
Loss = 1.0046e-01, PNorm = 35.5172, GNorm = 1.1721, lr_0 = 1.6188e-04
Validation rmse = 0.165792
Validation r2 = 0.880810
Epoch 45
Loss = 9.3858e-02, PNorm = 35.5237, GNorm = 1.5069, lr_0 = 1.5724e-04
Validation rmse = 0.173627
Validation r2 = 0.869278
Epoch 46
Loss = 9.4306e-02, PNorm = 35.5298, GNorm = 0.6228, lr_0 = 1.5313e-04
Loss = 1.1980e-01, PNorm = 35.5366, GNorm = 0.6835, lr_0 = 1.4913e-04
Validation rmse = 0.166526
Validation r2 = 0.879753
Epoch 47
Loss = 1.0051e-01, PNorm = 35.5432, GNorm = 1.2158, lr_0 = 1.4523e-04
Validation rmse = 0.171952
Validation r2 = 0.871790
Epoch 48
Loss = 1.4216e-01, PNorm = 35.5483, GNorm = 1.4886, lr_0 = 1.4107e-04
Loss = 1.1137e-01, PNorm = 35.5548, GNorm = 1.4952, lr_0 = 1.3738e-04
Validation rmse = 0.166534
Validation r2 = 0.879741
Epoch 49
Loss = 9.8617e-02, PNorm = 35.5606, GNorm = 1.6050, lr_0 = 1.3379e-04
Loss = 1.1543e-01, PNorm = 35.5660, GNorm = 0.8735, lr_0 = 1.3030e-04
Validation rmse = 0.167598
Validation r2 = 0.878199
Epoch 50
Loss = 1.0371e-01, PNorm = 35.5720, GNorm = 1.5321, lr_0 = 1.2690e-04
Validation rmse = 0.169837
Validation r2 = 0.874924
Epoch 51
Loss = 1.1097e-01, PNorm = 35.5764, GNorm = 0.7805, lr_0 = 1.2326e-04
Loss = 9.9641e-02, PNorm = 35.5809, GNorm = 2.4649, lr_0 = 1.2004e-04
Validation rmse = 0.167083
Validation r2 = 0.878946
Epoch 52
Loss = 1.2006e-01, PNorm = 35.5874, GNorm = 0.8455, lr_0 = 1.1690e-04
Validation rmse = 0.171411
Validation r2 = 0.872594
Epoch 53
Loss = 9.1839e-02, PNorm = 35.5919, GNorm = 0.9898, lr_0 = 1.1355e-04
Loss = 1.1334e-01, PNorm = 35.5966, GNorm = 1.0400, lr_0 = 1.1058e-04
Validation rmse = 0.166132
Validation r2 = 0.880321
Epoch 54
Loss = 9.5160e-02, PNorm = 35.6011, GNorm = 1.5074, lr_0 = 1.0769e-04
Validation rmse = 0.166095
Validation r2 = 0.880375
Epoch 55
Loss = 8.1248e-02, PNorm = 35.6053, GNorm = 0.8163, lr_0 = 1.0488e-04
Loss = 1.1770e-01, PNorm = 35.6096, GNorm = 1.0990, lr_0 = 1.0214e-04
Validation rmse = 0.167927
Validation r2 = 0.877721
Epoch 56
Loss = 1.1359e-01, PNorm = 35.6141, GNorm = 2.2664, lr_0 = 1.0000e-04
Loss = 1.1580e-01, PNorm = 35.6179, GNorm = 3.6835, lr_0 = 1.0000e-04
Validation rmse = 0.172195
Validation r2 = 0.871426
Epoch 57
Loss = 1.0902e-01, PNorm = 35.6206, GNorm = 1.1911, lr_0 = 1.0000e-04
Validation rmse = 0.167512
Validation r2 = 0.878324
Epoch 58
Loss = 1.1057e-01, PNorm = 35.6261, GNorm = 1.5361, lr_0 = 1.0000e-04
Loss = 1.0211e-01, PNorm = 35.6304, GNorm = 0.7444, lr_0 = 1.0000e-04
Validation rmse = 0.168039
Validation r2 = 0.877558
Epoch 59
Loss = 9.1395e-02, PNorm = 35.6333, GNorm = 2.2338, lr_0 = 1.0000e-04
Validation rmse = 0.169179
Validation r2 = 0.875890
Model 0 best validation rmse = 0.165792 on epoch 44
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.246058
Model 0 test r2 = 0.673945
Ensemble test rmse = 0.246058
Ensemble test r2 = 0.673945
Fold 2
Splitting data with seed 2
Total size = 977 | train size = 781 | val size = 98 | test size = 98
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.0481e+00, PNorm = 34.0157, GNorm = 3.8975, lr_0 = 4.3000e-04
Validation rmse = 0.370651
Validation r2 = 0.114351
Epoch 1
Loss = 8.4057e-01, PNorm = 34.0440, GNorm = 2.9934, lr_0 = 7.6000e-04
Loss = 7.1794e-01, PNorm = 34.0971, GNorm = 8.0056, lr_0 = 9.9472e-04
Validation rmse = 0.278095
Validation r2 = 0.501440
Epoch 2
Loss = 5.7493e-01, PNorm = 34.1833, GNorm = 4.5876, lr_0 = 9.6874e-04
Validation rmse = 0.217706
Validation r2 = 0.694458
Epoch 3
Loss = 3.5005e-01, PNorm = 34.2822, GNorm = 3.5929, lr_0 = 9.4094e-04
Loss = 3.2797e-01, PNorm = 34.3579, GNorm = 1.3510, lr_0 = 9.1637e-04
Validation rmse = 0.223605
Validation r2 = 0.677675
Epoch 4
Loss = 3.9773e-01, PNorm = 34.4220, GNorm = 13.2590, lr_0 = 8.9243e-04
Validation rmse = 0.196083
Validation r2 = 0.752139
Epoch 5
Loss = 3.2435e-01, PNorm = 34.4622, GNorm = 1.8243, lr_0 = 8.6912e-04
Loss = 2.9594e-01, PNorm = 34.5034, GNorm = 1.1674, lr_0 = 8.4642e-04
Validation rmse = 0.207526
Validation r2 = 0.722365
Epoch 6
Loss = 2.6400e-01, PNorm = 34.5362, GNorm = 2.8393, lr_0 = 8.2213e-04
Validation rmse = 0.178689
Validation r2 = 0.794162
Epoch 7
Loss = 2.2646e-01, PNorm = 34.5735, GNorm = 1.8111, lr_0 = 8.0066e-04
Loss = 2.2572e-01, PNorm = 34.6050, GNorm = 2.1089, lr_0 = 7.7975e-04
Validation rmse = 0.178550
Validation r2 = 0.794482
Epoch 8
Loss = 2.5626e-01, PNorm = 34.6449, GNorm = 4.3206, lr_0 = 7.5737e-04
Loss = 2.4097e-01, PNorm = 34.6783, GNorm = 4.6290, lr_0 = 7.3759e-04
Validation rmse = 0.217651
Validation r2 = 0.694614
Epoch 9
Loss = 2.5847e-01, PNorm = 34.7082, GNorm = 6.3308, lr_0 = 7.1833e-04
Validation rmse = 0.190373
Validation r2 = 0.766364
Epoch 10
Loss = 2.2296e-01, PNorm = 34.7371, GNorm = 3.3694, lr_0 = 6.9956e-04
Loss = 2.2410e-01, PNorm = 34.7731, GNorm = 1.3769, lr_0 = 6.8129e-04
Validation rmse = 0.169651
Validation r2 = 0.814457
Epoch 11
Loss = 2.1350e-01, PNorm = 34.8029, GNorm = 2.3920, lr_0 = 6.6174e-04
Validation rmse = 0.165393
Validation r2 = 0.823655
Epoch 12
Loss = 1.8094e-01, PNorm = 34.8296, GNorm = 2.5287, lr_0 = 6.4446e-04
Loss = 2.0945e-01, PNorm = 34.8519, GNorm = 7.6931, lr_0 = 6.2763e-04
Validation rmse = 0.182603
Validation r2 = 0.785045
Epoch 13
Loss = 1.9962e-01, PNorm = 34.8828, GNorm = 2.8057, lr_0 = 6.1123e-04
Validation rmse = 0.158341
Validation r2 = 0.838372
Epoch 14
Loss = 1.4280e-01, PNorm = 34.9120, GNorm = 1.7877, lr_0 = 5.9369e-04
Loss = 1.8458e-01, PNorm = 34.9387, GNorm = 2.3393, lr_0 = 5.7819e-04
Validation rmse = 0.155701
Validation r2 = 0.843717
Epoch 15
Loss = 1.8917e-01, PNorm = 34.9662, GNorm = 1.2906, lr_0 = 5.6309e-04
Validation rmse = 0.159694
Validation r2 = 0.835598
Epoch 16
Loss = 1.5873e-01, PNorm = 34.9903, GNorm = 2.8821, lr_0 = 5.4693e-04
Loss = 2.0073e-01, PNorm = 35.0099, GNorm = 7.8372, lr_0 = 5.3264e-04
Validation rmse = 0.157388
Validation r2 = 0.840312
Epoch 17
Loss = 1.7182e-01, PNorm = 35.0290, GNorm = 1.7435, lr_0 = 5.1873e-04
Loss = 1.8956e-01, PNorm = 35.0527, GNorm = 2.7097, lr_0 = 5.0518e-04
Validation rmse = 0.160133
Validation r2 = 0.834692
Epoch 18
Loss = 1.7248e-01, PNorm = 35.0732, GNorm = 4.7666, lr_0 = 4.9199e-04
Validation rmse = 0.169449
Validation r2 = 0.814898
Epoch 19
Loss = 2.8237e-01, PNorm = 35.0955, GNorm = 5.0607, lr_0 = 4.7787e-04
Loss = 1.4875e-01, PNorm = 35.1127, GNorm = 1.1749, lr_0 = 4.6539e-04
Validation rmse = 0.150294
Validation r2 = 0.854383
Epoch 20
Loss = 1.6924e-01, PNorm = 35.1324, GNorm = 4.3078, lr_0 = 4.5323e-04
Validation rmse = 0.162705
Validation r2 = 0.829340
Epoch 21
Loss = 1.3088e-01, PNorm = 35.1479, GNorm = 1.0412, lr_0 = 4.4140e-04
Loss = 1.5993e-01, PNorm = 35.1646, GNorm = 1.8965, lr_0 = 4.2987e-04
Validation rmse = 0.153086
Validation r2 = 0.848922
Epoch 22
Loss = 1.2950e-01, PNorm = 35.1869, GNorm = 1.2003, lr_0 = 4.1753e-04
Validation rmse = 0.145708
Validation r2 = 0.863133
Epoch 23
Loss = 1.1686e-01, PNorm = 35.2029, GNorm = 0.9316, lr_0 = 4.0663e-04
Loss = 1.4710e-01, PNorm = 35.2158, GNorm = 0.8606, lr_0 = 3.9601e-04
Validation rmse = 0.146293
Validation r2 = 0.862033
Epoch 24
Loss = 1.3065e-01, PNorm = 35.2313, GNorm = 2.0339, lr_0 = 3.8464e-04
Loss = 1.3490e-01, PNorm = 35.2431, GNorm = 2.2668, lr_0 = 3.7460e-04
Validation rmse = 0.150920
Validation r2 = 0.853167
Epoch 25
Loss = 1.4109e-01, PNorm = 35.2569, GNorm = 1.9206, lr_0 = 3.6481e-04
Validation rmse = 0.143197
Validation r2 = 0.867810
Epoch 26
Loss = 1.4860e-01, PNorm = 35.2690, GNorm = 1.7271, lr_0 = 3.5528e-04
Loss = 1.1618e-01, PNorm = 35.2828, GNorm = 1.4893, lr_0 = 3.4600e-04
Validation rmse = 0.144784
Validation r2 = 0.864864
Epoch 27
Loss = 1.3757e-01, PNorm = 35.3001, GNorm = 1.0745, lr_0 = 3.3608e-04
Validation rmse = 0.148241
Validation r2 = 0.858333
Epoch 28
Loss = 1.5183e-01, PNorm = 35.3090, GNorm = 2.3894, lr_0 = 3.2730e-04
Loss = 1.2985e-01, PNorm = 35.3212, GNorm = 1.2727, lr_0 = 3.1875e-04
Validation rmse = 0.146129
Validation r2 = 0.862342
Epoch 29
Loss = 1.1928e-01, PNorm = 35.3321, GNorm = 2.5721, lr_0 = 3.0960e-04
Validation rmse = 0.145269
Validation r2 = 0.863957
Epoch 30
Loss = 1.4828e-01, PNorm = 35.3426, GNorm = 2.7092, lr_0 = 3.0152e-04
Loss = 1.2758e-01, PNorm = 35.3559, GNorm = 1.5232, lr_0 = 2.9364e-04
Validation rmse = 0.152400
Validation r2 = 0.850273
Epoch 31
Loss = 1.5154e-01, PNorm = 35.3663, GNorm = 2.0935, lr_0 = 2.8597e-04
Validation rmse = 0.147616
Validation r2 = 0.859526
Epoch 32
Loss = 1.2491e-01, PNorm = 35.3766, GNorm = 3.1658, lr_0 = 2.7777e-04
Loss = 1.1433e-01, PNorm = 35.3844, GNorm = 1.8754, lr_0 = 2.7051e-04
Validation rmse = 0.143876
Validation r2 = 0.866553
Epoch 33
Loss = 1.2550e-01, PNorm = 35.3947, GNorm = 2.0323, lr_0 = 2.6344e-04
Loss = 1.2141e-01, PNorm = 35.4041, GNorm = 0.8540, lr_0 = 2.5656e-04
Validation rmse = 0.144504
Validation r2 = 0.865386
Epoch 34
Loss = 1.3513e-01, PNorm = 35.4119, GNorm = 4.2197, lr_0 = 2.4986e-04
Validation rmse = 0.149419
Validation r2 = 0.856074
Epoch 35
Loss = 1.2703e-01, PNorm = 35.4237, GNorm = 0.6505, lr_0 = 2.4269e-04
Loss = 1.1767e-01, PNorm = 35.4325, GNorm = 0.8940, lr_0 = 2.3635e-04
Validation rmse = 0.143603
Validation r2 = 0.867059
Epoch 36
Loss = 1.2953e-01, PNorm = 35.4416, GNorm = 2.2777, lr_0 = 2.3018e-04
Validation rmse = 0.143491
Validation r2 = 0.867267
Epoch 37
Loss = 1.1434e-01, PNorm = 35.4507, GNorm = 1.0265, lr_0 = 2.2358e-04
Loss = 1.1071e-01, PNorm = 35.4579, GNorm = 0.7601, lr_0 = 2.1774e-04
Validation rmse = 0.148538
Validation r2 = 0.857766
Epoch 38
Loss = 9.8152e-02, PNorm = 35.4662, GNorm = 2.7986, lr_0 = 2.1205e-04
Validation rmse = 0.141963
Validation r2 = 0.870079
Epoch 39
Loss = 7.6728e-02, PNorm = 35.4733, GNorm = 1.2912, lr_0 = 2.0651e-04
Loss = 1.1540e-01, PNorm = 35.4817, GNorm = 1.6543, lr_0 = 2.0112e-04
Validation rmse = 0.144309
Validation r2 = 0.865750
Epoch 40
Loss = 1.1746e-01, PNorm = 35.4917, GNorm = 0.8417, lr_0 = 1.9535e-04
Loss = 1.0992e-01, PNorm = 35.4993, GNorm = 1.5111, lr_0 = 1.9024e-04
Validation rmse = 0.143647
Validation r2 = 0.866978
Epoch 41
Loss = 9.4786e-02, PNorm = 35.5067, GNorm = 0.9570, lr_0 = 1.8527e-04
Validation rmse = 0.143801
Validation r2 = 0.866692
Epoch 42
Loss = 1.1056e-01, PNorm = 35.5134, GNorm = 0.6013, lr_0 = 1.8044e-04
Loss = 1.1126e-01, PNorm = 35.5197, GNorm = 0.7416, lr_0 = 1.7572e-04
Validation rmse = 0.142329
Validation r2 = 0.869408
Epoch 43
Loss = 1.1522e-01, PNorm = 35.5271, GNorm = 0.5057, lr_0 = 1.7068e-04
Validation rmse = 0.143614
Validation r2 = 0.867039
Epoch 44
Loss = 1.0727e-01, PNorm = 35.5338, GNorm = 0.5974, lr_0 = 1.6622e-04
Loss = 1.1674e-01, PNorm = 35.5400, GNorm = 0.6382, lr_0 = 1.6188e-04
Validation rmse = 0.145993
Validation r2 = 0.862598
Epoch 45
Loss = 1.0255e-01, PNorm = 35.5468, GNorm = 0.7870, lr_0 = 1.5724e-04
Validation rmse = 0.141941
Validation r2 = 0.870118
Epoch 46
Loss = 1.4143e-01, PNorm = 35.5526, GNorm = 1.4878, lr_0 = 1.5313e-04
Loss = 1.0352e-01, PNorm = 35.5592, GNorm = 1.0215, lr_0 = 1.4913e-04
Validation rmse = 0.150881
Validation r2 = 0.853243
Epoch 47
Loss = 1.0958e-01, PNorm = 35.5636, GNorm = 2.3814, lr_0 = 1.4523e-04
Validation rmse = 0.142900
Validation r2 = 0.868358
Epoch 48
Loss = 1.1921e-01, PNorm = 35.5694, GNorm = 1.7571, lr_0 = 1.4107e-04
Loss = 1.1312e-01, PNorm = 35.5744, GNorm = 0.8226, lr_0 = 1.3738e-04
Validation rmse = 0.141468
Validation r2 = 0.870984
Epoch 49
Loss = 8.5712e-02, PNorm = 35.5801, GNorm = 0.8842, lr_0 = 1.3379e-04
Loss = 1.1959e-01, PNorm = 35.5845, GNorm = 1.2750, lr_0 = 1.3030e-04
Validation rmse = 0.144284
Validation r2 = 0.865795
Epoch 50
Loss = 8.9613e-02, PNorm = 35.5899, GNorm = 0.9140, lr_0 = 1.2690e-04
Validation rmse = 0.142724
Validation r2 = 0.868681
Epoch 51
Loss = 1.2181e-01, PNorm = 35.5953, GNorm = 4.2504, lr_0 = 1.2326e-04
Loss = 1.0159e-01, PNorm = 35.5992, GNorm = 0.8909, lr_0 = 1.2004e-04
Validation rmse = 0.140955
Validation r2 = 0.871916
Epoch 52
Loss = 1.0795e-01, PNorm = 35.6047, GNorm = 2.8566, lr_0 = 1.1690e-04
Validation rmse = 0.142570
Validation r2 = 0.868965
Epoch 53
Loss = 1.1252e-01, PNorm = 35.6100, GNorm = 0.9739, lr_0 = 1.1355e-04
Loss = 1.0297e-01, PNorm = 35.6156, GNorm = 0.7071, lr_0 = 1.1058e-04
Validation rmse = 0.142313
Validation r2 = 0.869438
Epoch 54
Loss = 1.2291e-01, PNorm = 35.6191, GNorm = 1.3997, lr_0 = 1.0769e-04
Validation rmse = 0.141285
Validation r2 = 0.871317
Epoch 55
Loss = 9.4852e-02, PNorm = 35.6228, GNorm = 1.1148, lr_0 = 1.0488e-04
Loss = 9.6853e-02, PNorm = 35.6264, GNorm = 0.5152, lr_0 = 1.0214e-04
Validation rmse = 0.141117
Validation r2 = 0.871623
Epoch 56
Loss = 8.3411e-02, PNorm = 35.6303, GNorm = 0.7060, lr_0 = 1.0000e-04
Loss = 1.1357e-01, PNorm = 35.6346, GNorm = 1.9241, lr_0 = 1.0000e-04
Validation rmse = 0.143428
Validation r2 = 0.867384
Epoch 57
Loss = 9.1962e-02, PNorm = 35.6381, GNorm = 1.1762, lr_0 = 1.0000e-04
Validation rmse = 0.142567
Validation r2 = 0.868970
Epoch 58
Loss = 1.1196e-01, PNorm = 35.6424, GNorm = 0.5363, lr_0 = 1.0000e-04
Loss = 9.6702e-02, PNorm = 35.6465, GNorm = 0.9789, lr_0 = 1.0000e-04
Validation rmse = 0.141406
Validation r2 = 0.871097
Epoch 59
Loss = 9.7808e-02, PNorm = 35.6509, GNorm = 1.1628, lr_0 = 1.0000e-04
Validation rmse = 0.143153
Validation r2 = 0.867891
Model 0 best validation rmse = 0.140955 on epoch 51
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.186278
Model 0 test r2 = 0.775048
Ensemble test rmse = 0.186278
Ensemble test r2 = 0.775048
Fold 3
Splitting data with seed 3
Total size = 977 | train size = 781 | val size = 98 | test size = 98
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.6201e-01, PNorm = 34.0169, GNorm = 2.6377, lr_0 = 4.3000e-04
Validation rmse = 0.337051
Validation r2 = 0.114775
Epoch 1
Loss = 7.7680e-01, PNorm = 34.0423, GNorm = 4.7240, lr_0 = 7.6000e-04
Loss = 6.6494e-01, PNorm = 34.1051, GNorm = 3.4172, lr_0 = 9.9472e-04
Validation rmse = 0.240248
Validation r2 = 0.550238
Epoch 2
Loss = 5.1407e-01, PNorm = 34.1942, GNorm = 3.3893, lr_0 = 9.6874e-04
Validation rmse = 0.209696
Validation r2 = 0.657356
Epoch 3
Loss = 3.3136e-01, PNorm = 34.2835, GNorm = 6.0875, lr_0 = 9.4094e-04
Loss = 3.2617e-01, PNorm = 34.3426, GNorm = 2.2315, lr_0 = 9.1637e-04
Validation rmse = 0.192885
Validation r2 = 0.710094
Epoch 4
Loss = 2.8655e-01, PNorm = 34.3796, GNorm = 0.8887, lr_0 = 8.9243e-04
Validation rmse = 0.186314
Validation r2 = 0.729508
Epoch 5
Loss = 3.9822e-01, PNorm = 34.4195, GNorm = 2.4867, lr_0 = 8.6912e-04
Loss = 2.3853e-01, PNorm = 34.4585, GNorm = 4.5489, lr_0 = 8.4642e-04
Validation rmse = 0.209018
Validation r2 = 0.659568
Epoch 6
Loss = 2.3508e-01, PNorm = 34.4782, GNorm = 3.8462, lr_0 = 8.2213e-04
Validation rmse = 0.179000
Validation r2 = 0.750330
Epoch 7
Loss = 2.2349e-01, PNorm = 34.5063, GNorm = 3.5317, lr_0 = 8.0066e-04
Loss = 2.7200e-01, PNorm = 34.5340, GNorm = 1.3616, lr_0 = 7.7975e-04
Validation rmse = 0.168904
Validation r2 = 0.777697
Epoch 8
Loss = 2.5033e-01, PNorm = 34.5584, GNorm = 2.9559, lr_0 = 7.5737e-04
Loss = 2.1671e-01, PNorm = 34.5850, GNorm = 1.4842, lr_0 = 7.3759e-04
Validation rmse = 0.201278
Validation r2 = 0.684314
Epoch 9
Loss = 2.1604e-01, PNorm = 34.6097, GNorm = 3.9691, lr_0 = 7.1833e-04
Validation rmse = 0.185302
Validation r2 = 0.732440
Epoch 10
Loss = 2.0164e-01, PNorm = 34.6345, GNorm = 0.9212, lr_0 = 6.9956e-04
Loss = 2.2144e-01, PNorm = 34.6527, GNorm = 1.8713, lr_0 = 6.8129e-04
Validation rmse = 0.164875
Validation r2 = 0.788178
Epoch 11
Loss = 2.0257e-01, PNorm = 34.6820, GNorm = 3.2112, lr_0 = 6.6174e-04
Validation rmse = 0.154930
Validation r2 = 0.812961
Epoch 12
Loss = 2.1615e-01, PNorm = 34.7049, GNorm = 0.4921, lr_0 = 6.4446e-04
Loss = 1.8297e-01, PNorm = 34.7328, GNorm = 0.7734, lr_0 = 6.2763e-04
Validation rmse = 0.172004
Validation r2 = 0.769462
Epoch 13
Loss = 1.8611e-01, PNorm = 34.7523, GNorm = 2.0468, lr_0 = 6.1123e-04
Validation rmse = 0.168338
Validation r2 = 0.779186
Epoch 14
Loss = 2.2339e-01, PNorm = 34.7785, GNorm = 1.2376, lr_0 = 5.9369e-04
Loss = 1.6913e-01, PNorm = 34.8014, GNorm = 3.0901, lr_0 = 5.7819e-04
Validation rmse = 0.163496
Validation r2 = 0.791706
Epoch 15
Loss = 1.5835e-01, PNorm = 34.8180, GNorm = 0.9606, lr_0 = 5.6309e-04
Validation rmse = 0.149305
Validation r2 = 0.826294
Epoch 16
Loss = 8.8018e-02, PNorm = 34.8428, GNorm = 0.7239, lr_0 = 5.4693e-04
Loss = 1.9486e-01, PNorm = 34.8697, GNorm = 2.0489, lr_0 = 5.3264e-04
Validation rmse = 0.151914
Validation r2 = 0.820172
Epoch 17
Loss = 1.5986e-01, PNorm = 34.8838, GNorm = 1.4446, lr_0 = 5.1873e-04
Loss = 1.6346e-01, PNorm = 34.9046, GNorm = 3.5852, lr_0 = 5.0518e-04
Validation rmse = 0.146870
Validation r2 = 0.831915
Epoch 18
Loss = 1.5205e-01, PNorm = 34.9224, GNorm = 1.9333, lr_0 = 4.9199e-04
Validation rmse = 0.152037
Validation r2 = 0.819880
Epoch 19
Loss = 1.3008e-01, PNorm = 34.9436, GNorm = 2.0065, lr_0 = 4.7787e-04
Loss = 1.5959e-01, PNorm = 34.9612, GNorm = 3.4302, lr_0 = 4.6539e-04
Validation rmse = 0.160313
Validation r2 = 0.799738
Epoch 20
Loss = 1.6242e-01, PNorm = 34.9804, GNorm = 1.5420, lr_0 = 4.5323e-04
Validation rmse = 0.146459
Validation r2 = 0.832855
Epoch 21
Loss = 8.5093e-02, PNorm = 34.9969, GNorm = 0.8175, lr_0 = 4.4140e-04
Loss = 1.6118e-01, PNorm = 35.0137, GNorm = 1.8011, lr_0 = 4.2987e-04
Validation rmse = 0.177569
Validation r2 = 0.754303
Epoch 22
Loss = 1.6753e-01, PNorm = 35.0349, GNorm = 1.8604, lr_0 = 4.1753e-04
Validation rmse = 0.147106
Validation r2 = 0.831373
Epoch 23
Loss = 1.1693e-01, PNorm = 35.0480, GNorm = 1.3822, lr_0 = 4.0663e-04
Loss = 1.3364e-01, PNorm = 35.0644, GNorm = 0.9326, lr_0 = 3.9601e-04
Validation rmse = 0.149731
Validation r2 = 0.825302
Epoch 24
Loss = 1.3597e-01, PNorm = 35.0808, GNorm = 1.9410, lr_0 = 3.8464e-04
Loss = 1.4150e-01, PNorm = 35.0964, GNorm = 1.7553, lr_0 = 3.7460e-04
Validation rmse = 0.153569
Validation r2 = 0.816232
Epoch 25
Loss = 1.3359e-01, PNorm = 35.1075, GNorm = 1.8682, lr_0 = 3.6481e-04
Validation rmse = 0.154488
Validation r2 = 0.814025
Epoch 26
Loss = 1.6167e-01, PNorm = 35.1227, GNorm = 1.1137, lr_0 = 3.5528e-04
Loss = 1.1711e-01, PNorm = 35.1340, GNorm = 2.2505, lr_0 = 3.4600e-04
Validation rmse = 0.150601
Validation r2 = 0.823268
Epoch 27
Loss = 1.1445e-01, PNorm = 35.1453, GNorm = 1.3149, lr_0 = 3.3608e-04
Validation rmse = 0.152371
Validation r2 = 0.819088
Epoch 28
Loss = 1.0337e-01, PNorm = 35.1583, GNorm = 1.9992, lr_0 = 3.2730e-04
Loss = 1.4481e-01, PNorm = 35.1701, GNorm = 1.7472, lr_0 = 3.1875e-04
Validation rmse = 0.157567
Validation r2 = 0.806540
Epoch 29
Loss = 1.3475e-01, PNorm = 35.1839, GNorm = 1.6750, lr_0 = 3.0960e-04
Validation rmse = 0.146566
Validation r2 = 0.832610
Epoch 30
Loss = 9.5771e-02, PNorm = 35.1953, GNorm = 2.3961, lr_0 = 3.0152e-04
Loss = 1.2454e-01, PNorm = 35.2047, GNorm = 1.7430, lr_0 = 2.9364e-04
Validation rmse = 0.147410
Validation r2 = 0.830677
Epoch 31
Loss = 1.3044e-01, PNorm = 35.2185, GNorm = 3.2276, lr_0 = 2.8597e-04
Validation rmse = 0.146165
Validation r2 = 0.833525
Epoch 32
Loss = 6.0752e-02, PNorm = 35.2315, GNorm = 0.5547, lr_0 = 2.7777e-04
Loss = 1.2466e-01, PNorm = 35.2433, GNorm = 1.6205, lr_0 = 2.7051e-04
Validation rmse = 0.144440
Validation r2 = 0.837430
Epoch 33
Loss = 9.9682e-02, PNorm = 35.2534, GNorm = 0.8311, lr_0 = 2.6344e-04
Loss = 1.1971e-01, PNorm = 35.2630, GNorm = 1.5188, lr_0 = 2.5656e-04
Validation rmse = 0.155951
Validation r2 = 0.810487
Epoch 34
Loss = 1.1582e-01, PNorm = 35.2728, GNorm = 0.8403, lr_0 = 2.4986e-04
Validation rmse = 0.146996
Validation r2 = 0.831626
Epoch 35
Loss = 9.9503e-02, PNorm = 35.2832, GNorm = 1.2728, lr_0 = 2.4269e-04
Loss = 1.1316e-01, PNorm = 35.2928, GNorm = 0.9425, lr_0 = 2.3635e-04
Validation rmse = 0.147471
Validation r2 = 0.830537
Epoch 36
Loss = 1.1634e-01, PNorm = 35.3025, GNorm = 1.1299, lr_0 = 2.3018e-04
Validation rmse = 0.152029
Validation r2 = 0.819899
Epoch 37
Loss = 1.2798e-01, PNorm = 35.3135, GNorm = 1.6991, lr_0 = 2.2358e-04
Loss = 1.1026e-01, PNorm = 35.3224, GNorm = 1.1273, lr_0 = 2.1774e-04
Validation rmse = 0.149817
Validation r2 = 0.825103
Epoch 38
Loss = 8.2884e-02, PNorm = 35.3315, GNorm = 1.1791, lr_0 = 2.1205e-04
Validation rmse = 0.146518
Validation r2 = 0.832720
Epoch 39
Loss = 7.2687e-02, PNorm = 35.3406, GNorm = 0.7002, lr_0 = 2.0651e-04
Loss = 1.1902e-01, PNorm = 35.3484, GNorm = 2.0540, lr_0 = 2.0112e-04
Validation rmse = 0.149680
Validation r2 = 0.825421
Epoch 40
Loss = 1.1653e-01, PNorm = 35.3560, GNorm = 0.9197, lr_0 = 1.9535e-04
Loss = 1.0092e-01, PNorm = 35.3649, GNorm = 0.8995, lr_0 = 1.9024e-04
Validation rmse = 0.150600
Validation r2 = 0.823268
Epoch 41
Loss = 1.0664e-01, PNorm = 35.3730, GNorm = 1.0063, lr_0 = 1.8527e-04
Validation rmse = 0.151385
Validation r2 = 0.821421
Epoch 42
Loss = 1.1638e-01, PNorm = 35.3807, GNorm = 0.6616, lr_0 = 1.8044e-04
Loss = 9.6062e-02, PNorm = 35.3876, GNorm = 1.6302, lr_0 = 1.7572e-04
Validation rmse = 0.149535
Validation r2 = 0.825760
Epoch 43
Loss = 1.0185e-01, PNorm = 35.3952, GNorm = 1.6499, lr_0 = 1.7068e-04
Validation rmse = 0.148832
Validation r2 = 0.827393
Epoch 44
Loss = 6.9069e-02, PNorm = 35.4033, GNorm = 1.2612, lr_0 = 1.6622e-04
Loss = 9.9258e-02, PNorm = 35.4095, GNorm = 0.6230, lr_0 = 1.6188e-04
Validation rmse = 0.150947
Validation r2 = 0.822453
Epoch 45
Loss = 1.0090e-01, PNorm = 35.4178, GNorm = 1.5404, lr_0 = 1.5724e-04
Validation rmse = 0.153509
Validation r2 = 0.816376
Epoch 46
Loss = 8.8310e-02, PNorm = 35.4233, GNorm = 2.2734, lr_0 = 1.5313e-04
Loss = 1.1531e-01, PNorm = 35.4309, GNorm = 3.2945, lr_0 = 1.4913e-04
Validation rmse = 0.149982
Validation r2 = 0.824715
Epoch 47
Loss = 1.0236e-01, PNorm = 35.4370, GNorm = 3.1130, lr_0 = 1.4523e-04
Validation rmse = 0.145635
Validation r2 = 0.834730
Epoch 48
Loss = 6.2582e-02, PNorm = 35.4428, GNorm = 0.8296, lr_0 = 1.4107e-04
Loss = 9.8998e-02, PNorm = 35.4489, GNorm = 1.3706, lr_0 = 1.3738e-04
Validation rmse = 0.144403
Validation r2 = 0.837514
Epoch 49
Loss = 8.8986e-02, PNorm = 35.4543, GNorm = 2.5277, lr_0 = 1.3379e-04
Loss = 1.0213e-01, PNorm = 35.4601, GNorm = 0.6763, lr_0 = 1.3030e-04
Validation rmse = 0.145692
Validation r2 = 0.834601
Epoch 50
Loss = 8.9769e-02, PNorm = 35.4645, GNorm = 2.0407, lr_0 = 1.2690e-04
Validation rmse = 0.147206
Validation r2 = 0.831146
Epoch 51
Loss = 9.2089e-02, PNorm = 35.4701, GNorm = 1.5483, lr_0 = 1.2326e-04
Loss = 9.6914e-02, PNorm = 35.4746, GNorm = 1.2555, lr_0 = 1.2004e-04
Validation rmse = 0.146445
Validation r2 = 0.832885
Epoch 52
Loss = 1.0133e-01, PNorm = 35.4800, GNorm = 1.3521, lr_0 = 1.1690e-04
Validation rmse = 0.146455
Validation r2 = 0.832863
Epoch 53
Loss = 9.1700e-02, PNorm = 35.4861, GNorm = 0.8941, lr_0 = 1.1355e-04
Loss = 9.2205e-02, PNorm = 35.4903, GNorm = 1.1409, lr_0 = 1.1058e-04
Validation rmse = 0.144179
Validation r2 = 0.838017
Epoch 54
Loss = 8.8864e-02, PNorm = 35.4956, GNorm = 0.6462, lr_0 = 1.0769e-04
Validation rmse = 0.144797
Validation r2 = 0.836626
Epoch 55
Loss = 9.9788e-02, PNorm = 35.4997, GNorm = 2.4406, lr_0 = 1.0488e-04
Loss = 9.0178e-02, PNorm = 35.5033, GNorm = 0.9476, lr_0 = 1.0214e-04
Validation rmse = 0.144469
Validation r2 = 0.837366
Epoch 56
Loss = 9.1310e-02, PNorm = 35.5080, GNorm = 1.5900, lr_0 = 1.0000e-04
Loss = 9.5980e-02, PNorm = 35.5129, GNorm = 0.7160, lr_0 = 1.0000e-04
Validation rmse = 0.145627
Validation r2 = 0.834748
Epoch 57
Loss = 8.9547e-02, PNorm = 35.5171, GNorm = 1.5047, lr_0 = 1.0000e-04
Validation rmse = 0.144098
Validation r2 = 0.838200
Epoch 58
Loss = 7.5588e-02, PNorm = 35.5209, GNorm = 0.7612, lr_0 = 1.0000e-04
Loss = 1.0063e-01, PNorm = 35.5251, GNorm = 1.2257, lr_0 = 1.0000e-04
Validation rmse = 0.147001
Validation r2 = 0.831615
Epoch 59
Loss = 8.8838e-02, PNorm = 35.5300, GNorm = 0.5793, lr_0 = 1.0000e-04
Validation rmse = 0.147293
Validation r2 = 0.830946
Model 0 best validation rmse = 0.144098 on epoch 57
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.284979
Model 0 test r2 = 0.615975
Ensemble test rmse = 0.284979
Ensemble test r2 = 0.615975
Fold 4
Splitting data with seed 4
Total size = 977 | train size = 781 | val size = 98 | test size = 98
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.0850e+00, PNorm = 34.0142, GNorm = 2.2881, lr_0 = 4.3000e-04
Validation rmse = 0.293887
Validation r2 = 0.210619
Epoch 1
Loss = 6.7236e-01, PNorm = 34.0407, GNorm = 3.3712, lr_0 = 7.6000e-04
Loss = 7.9878e-01, PNorm = 34.0992, GNorm = 3.1307, lr_0 = 9.9472e-04
Validation rmse = 0.260028
Validation r2 = 0.382031
Epoch 2
Loss = 5.6981e-01, PNorm = 34.1674, GNorm = 2.5782, lr_0 = 9.6874e-04
Validation rmse = 0.239525
Validation r2 = 0.475644
Epoch 3
Loss = 4.1215e-01, PNorm = 34.2446, GNorm = 3.6874, lr_0 = 9.4094e-04
Loss = 4.3595e-01, PNorm = 34.3127, GNorm = 1.5399, lr_0 = 9.1637e-04
Validation rmse = 0.208738
Validation r2 = 0.601776
Epoch 4
Loss = 3.9874e-01, PNorm = 34.3732, GNorm = 6.7739, lr_0 = 8.9243e-04
Validation rmse = 0.244661
Validation r2 = 0.452917
Epoch 5
Loss = 2.9897e-01, PNorm = 34.4252, GNorm = 0.8790, lr_0 = 8.6912e-04
Loss = 3.3730e-01, PNorm = 34.4781, GNorm = 3.7607, lr_0 = 8.4642e-04
Validation rmse = 0.197896
Validation r2 = 0.642069
Epoch 6
Loss = 3.2279e-01, PNorm = 34.5213, GNorm = 3.4448, lr_0 = 8.2213e-04
Validation rmse = 0.207252
Validation r2 = 0.607424
Epoch 7
Loss = 3.4158e-01, PNorm = 34.5687, GNorm = 1.6755, lr_0 = 8.0066e-04
Loss = 2.3084e-01, PNorm = 34.6052, GNorm = 1.4344, lr_0 = 7.7975e-04
Validation rmse = 0.196341
Validation r2 = 0.647670
Epoch 8
Loss = 2.1799e-01, PNorm = 34.6485, GNorm = 1.8644, lr_0 = 7.5737e-04
Loss = 2.3843e-01, PNorm = 34.6819, GNorm = 2.8761, lr_0 = 7.3759e-04
Validation rmse = 0.222422
Validation r2 = 0.547854
Epoch 9
Loss = 2.6469e-01, PNorm = 34.7116, GNorm = 4.9758, lr_0 = 7.1833e-04
Validation rmse = 0.191016
Validation r2 = 0.666522
Epoch 10
Loss = 2.7035e-01, PNorm = 34.7426, GNorm = 2.9339, lr_0 = 6.9956e-04
Loss = 1.9675e-01, PNorm = 34.7773, GNorm = 1.0168, lr_0 = 6.8129e-04
Validation rmse = 0.198289
Validation r2 = 0.640644
Epoch 11
Loss = 2.0783e-01, PNorm = 34.8113, GNorm = 3.2772, lr_0 = 6.6174e-04
Validation rmse = 0.200951
Validation r2 = 0.630933
Epoch 12
Loss = 1.7183e-01, PNorm = 34.8401, GNorm = 2.9977, lr_0 = 6.4446e-04
Loss = 1.7698e-01, PNorm = 34.8645, GNorm = 2.2630, lr_0 = 6.2763e-04
Validation rmse = 0.186350
Validation r2 = 0.682615
Epoch 13
Loss = 1.5825e-01, PNorm = 34.8907, GNorm = 1.1687, lr_0 = 6.1123e-04
Validation rmse = 0.196667
Validation r2 = 0.646501
Epoch 14
Loss = 1.9638e-01, PNorm = 34.9194, GNorm = 2.9767, lr_0 = 5.9369e-04
Loss = 1.5242e-01, PNorm = 34.9403, GNorm = 2.6575, lr_0 = 5.7819e-04
Validation rmse = 0.193446
Validation r2 = 0.657984
Epoch 15
Loss = 1.5391e-01, PNorm = 34.9691, GNorm = 4.4988, lr_0 = 5.6309e-04
Validation rmse = 0.205937
Validation r2 = 0.612392
Epoch 16
Loss = 3.2483e-01, PNorm = 34.9963, GNorm = 6.4295, lr_0 = 5.4693e-04
Loss = 1.8110e-01, PNorm = 35.0199, GNorm = 0.7133, lr_0 = 5.3264e-04
Validation rmse = 0.205676
Validation r2 = 0.613374
Epoch 17
Loss = 1.6619e-01, PNorm = 35.0389, GNorm = 3.8767, lr_0 = 5.1873e-04
Loss = 1.8479e-01, PNorm = 35.0595, GNorm = 2.8750, lr_0 = 5.0518e-04
Validation rmse = 0.202860
Validation r2 = 0.623887
Epoch 18
Loss = 1.8521e-01, PNorm = 35.0775, GNorm = 1.0868, lr_0 = 4.9199e-04
Validation rmse = 0.188749
Validation r2 = 0.674394
Epoch 19
Loss = 1.7424e-01, PNorm = 35.0966, GNorm = 0.8917, lr_0 = 4.7787e-04
Loss = 1.8029e-01, PNorm = 35.1137, GNorm = 2.0116, lr_0 = 4.6539e-04
Validation rmse = 0.183743
Validation r2 = 0.691434
Epoch 20
Loss = 1.5272e-01, PNorm = 35.1291, GNorm = 1.7189, lr_0 = 4.5323e-04
Validation rmse = 0.191345
Validation r2 = 0.665374
Epoch 21
Loss = 1.1439e-01, PNorm = 35.1440, GNorm = 3.2949, lr_0 = 4.4140e-04
Loss = 1.4191e-01, PNorm = 35.1594, GNorm = 2.1244, lr_0 = 4.2987e-04
Validation rmse = 0.196403
Validation r2 = 0.647451
Epoch 22
Loss = 1.5780e-01, PNorm = 35.1790, GNorm = 0.9732, lr_0 = 4.1753e-04
Validation rmse = 0.187861
Validation r2 = 0.677448
Epoch 23
Loss = 1.0451e-01, PNorm = 35.1934, GNorm = 0.5629, lr_0 = 4.0663e-04
Loss = 1.5660e-01, PNorm = 35.2079, GNorm = 2.0747, lr_0 = 3.9601e-04
Validation rmse = 0.201998
Validation r2 = 0.627078
Epoch 24
Loss = 1.5004e-01, PNorm = 35.2224, GNorm = 1.6960, lr_0 = 3.8464e-04
Loss = 1.4558e-01, PNorm = 35.2338, GNorm = 0.6251, lr_0 = 3.7460e-04
Validation rmse = 0.181411
Validation r2 = 0.699216
Epoch 25
Loss = 1.4247e-01, PNorm = 35.2480, GNorm = 1.7800, lr_0 = 3.6481e-04
Validation rmse = 0.193512
Validation r2 = 0.657750
Epoch 26
Loss = 1.4565e-01, PNorm = 35.2603, GNorm = 1.4271, lr_0 = 3.5528e-04
Loss = 1.1424e-01, PNorm = 35.2696, GNorm = 2.5312, lr_0 = 3.4600e-04
Validation rmse = 0.184920
Validation r2 = 0.687470
Epoch 27
Loss = 1.4527e-01, PNorm = 35.2837, GNorm = 0.6096, lr_0 = 3.3608e-04
Validation rmse = 0.185367
Validation r2 = 0.685955
Epoch 28
Loss = 1.5234e-01, PNorm = 35.2969, GNorm = 1.6787, lr_0 = 3.2730e-04
Loss = 1.2999e-01, PNorm = 35.3081, GNorm = 1.3795, lr_0 = 3.1875e-04
Validation rmse = 0.186994
Validation r2 = 0.680421
Epoch 29
Loss = 1.1529e-01, PNorm = 35.3229, GNorm = 0.6555, lr_0 = 3.0960e-04
Validation rmse = 0.196100
Validation r2 = 0.648535
Epoch 30
Loss = 1.4235e-01, PNorm = 35.3343, GNorm = 4.5512, lr_0 = 3.0152e-04
Loss = 1.3134e-01, PNorm = 35.3425, GNorm = 1.5462, lr_0 = 2.9364e-04
Validation rmse = 0.177741
Validation r2 = 0.711264
Epoch 31
Loss = 1.5116e-01, PNorm = 35.3513, GNorm = 1.8522, lr_0 = 2.8597e-04
Validation rmse = 0.182083
Validation r2 = 0.696985
Epoch 32
Loss = 1.0567e-01, PNorm = 35.3633, GNorm = 0.4407, lr_0 = 2.7777e-04
Loss = 1.1858e-01, PNorm = 35.3734, GNorm = 1.4292, lr_0 = 2.7051e-04
Validation rmse = 0.187571
Validation r2 = 0.678443
Epoch 33
Loss = 1.1489e-01, PNorm = 35.3822, GNorm = 0.8232, lr_0 = 2.6344e-04
Loss = 1.3458e-01, PNorm = 35.3911, GNorm = 0.7426, lr_0 = 2.5656e-04
Validation rmse = 0.178706
Validation r2 = 0.708120
Epoch 34
Loss = 1.1939e-01, PNorm = 35.3993, GNorm = 0.6028, lr_0 = 2.4986e-04
Validation rmse = 0.181535
Validation r2 = 0.698806
Epoch 35
Loss = 1.3625e-01, PNorm = 35.4107, GNorm = 0.7086, lr_0 = 2.4269e-04
Loss = 1.2333e-01, PNorm = 35.4187, GNorm = 1.3285, lr_0 = 2.3635e-04
Validation rmse = 0.180870
Validation r2 = 0.701009
Epoch 36
Loss = 1.2102e-01, PNorm = 35.4269, GNorm = 1.5311, lr_0 = 2.3018e-04
Validation rmse = 0.180178
Validation r2 = 0.703292
Epoch 37
Loss = 1.0970e-01, PNorm = 35.4353, GNorm = 0.9155, lr_0 = 2.2358e-04
Loss = 1.1780e-01, PNorm = 35.4423, GNorm = 1.3483, lr_0 = 2.1774e-04
Validation rmse = 0.184739
Validation r2 = 0.688079
Epoch 38
Loss = 1.2983e-01, PNorm = 35.4502, GNorm = 1.1217, lr_0 = 2.1205e-04
Validation rmse = 0.178879
Validation r2 = 0.707554
Epoch 39
Loss = 6.6870e-02, PNorm = 35.4574, GNorm = 0.9154, lr_0 = 2.0651e-04
Loss = 1.0493e-01, PNorm = 35.4664, GNorm = 1.3410, lr_0 = 2.0112e-04
Validation rmse = 0.182632
Validation r2 = 0.695155
Epoch 40
Loss = 1.1814e-01, PNorm = 35.4730, GNorm = 0.7949, lr_0 = 1.9535e-04
Loss = 1.1933e-01, PNorm = 35.4779, GNorm = 3.9153, lr_0 = 1.9024e-04
Validation rmse = 0.184550
Validation r2 = 0.688720
Epoch 41
Loss = 1.0986e-01, PNorm = 35.4859, GNorm = 1.0243, lr_0 = 1.8527e-04
Validation rmse = 0.178246
Validation r2 = 0.709622
Epoch 42
Loss = 9.8838e-02, PNorm = 35.4915, GNorm = 0.9837, lr_0 = 1.8044e-04
Loss = 1.1825e-01, PNorm = 35.4972, GNorm = 1.2714, lr_0 = 1.7572e-04
Validation rmse = 0.181884
Validation r2 = 0.697648
Epoch 43
Loss = 1.1410e-01, PNorm = 35.5061, GNorm = 0.7225, lr_0 = 1.7068e-04
Validation rmse = 0.179659
Validation r2 = 0.704998
Epoch 44
Loss = 1.1144e-01, PNorm = 35.5123, GNorm = 2.4538, lr_0 = 1.6622e-04
Loss = 1.2177e-01, PNorm = 35.5179, GNorm = 1.3815, lr_0 = 1.6188e-04
Validation rmse = 0.176826
Validation r2 = 0.714229
Epoch 45
Loss = 1.1658e-01, PNorm = 35.5244, GNorm = 0.4735, lr_0 = 1.5724e-04
Validation rmse = 0.187530
Validation r2 = 0.678585
Epoch 46
Loss = 1.5442e-01, PNorm = 35.5299, GNorm = 1.3243, lr_0 = 1.5313e-04
Loss = 1.1440e-01, PNorm = 35.5358, GNorm = 1.3498, lr_0 = 1.4913e-04
Validation rmse = 0.175559
Validation r2 = 0.718311
Epoch 47
Loss = 9.8876e-02, PNorm = 35.5418, GNorm = 0.6715, lr_0 = 1.4523e-04
Validation rmse = 0.181984
Validation r2 = 0.697315
Epoch 48
Loss = 1.7616e-01, PNorm = 35.5479, GNorm = 1.5379, lr_0 = 1.4107e-04
Loss = 1.1409e-01, PNorm = 35.5534, GNorm = 1.9168, lr_0 = 1.3738e-04
Validation rmse = 0.174027
Validation r2 = 0.723206
Epoch 49
Loss = 9.2481e-02, PNorm = 35.5576, GNorm = 0.4806, lr_0 = 1.3379e-04
Loss = 1.2718e-01, PNorm = 35.5631, GNorm = 1.6519, lr_0 = 1.3030e-04
Validation rmse = 0.177451
Validation r2 = 0.712204
Epoch 50
Loss = 1.0229e-01, PNorm = 35.5668, GNorm = 1.6984, lr_0 = 1.2690e-04
Validation rmse = 0.177760
Validation r2 = 0.711203
Epoch 51
Loss = 1.2556e-01, PNorm = 35.5722, GNorm = 1.2465, lr_0 = 1.2326e-04
Loss = 1.0560e-01, PNorm = 35.5774, GNorm = 1.0440, lr_0 = 1.2004e-04
Validation rmse = 0.178325
Validation r2 = 0.709364
Epoch 52
Loss = 1.1364e-01, PNorm = 35.5814, GNorm = 1.6135, lr_0 = 1.1690e-04
Validation rmse = 0.184271
Validation r2 = 0.689660
Epoch 53
Loss = 1.1117e-01, PNorm = 35.5862, GNorm = 1.6776, lr_0 = 1.1355e-04
Loss = 1.2031e-01, PNorm = 35.5895, GNorm = 1.3405, lr_0 = 1.1058e-04
Validation rmse = 0.179633
Validation r2 = 0.705083
Epoch 54
Loss = 1.0384e-01, PNorm = 35.5939, GNorm = 0.7679, lr_0 = 1.0769e-04
Validation rmse = 0.182609
Validation r2 = 0.695230
Epoch 55
Loss = 1.1475e-01, PNorm = 35.5980, GNorm = 3.0129, lr_0 = 1.0488e-04
Loss = 1.1307e-01, PNorm = 35.6026, GNorm = 1.0896, lr_0 = 1.0214e-04
Validation rmse = 0.178494
Validation r2 = 0.708812
Epoch 56
Loss = 1.1366e-01, PNorm = 35.6069, GNorm = 1.1156, lr_0 = 1.0000e-04
Loss = 1.0366e-01, PNorm = 35.6097, GNorm = 2.8568, lr_0 = 1.0000e-04
Validation rmse = 0.185311
Validation r2 = 0.686147
Epoch 57
Loss = 1.0734e-01, PNorm = 35.6157, GNorm = 2.3161, lr_0 = 1.0000e-04
Validation rmse = 0.179643
Validation r2 = 0.705052
Epoch 58
Loss = 1.0618e-01, PNorm = 35.6191, GNorm = 1.3402, lr_0 = 1.0000e-04
Loss = 1.0885e-01, PNorm = 35.6220, GNorm = 1.0195, lr_0 = 1.0000e-04
Validation rmse = 0.186634
Validation r2 = 0.681648
Epoch 59
Loss = 1.1696e-01, PNorm = 35.6272, GNorm = 2.9632, lr_0 = 1.0000e-04
Validation rmse = 0.180883
Validation r2 = 0.700965
Model 0 best validation rmse = 0.174027 on epoch 48
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.157928
Model 0 test r2 = 0.873713
Ensemble test rmse = 0.157928
Ensemble test r2 = 0.873713
Fold 5
Splitting data with seed 5
Total size = 977 | train size = 781 | val size = 98 | test size = 98
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 8.5768e-01, PNorm = 34.0162, GNorm = 2.1492, lr_0 = 4.3000e-04
Validation rmse = 0.374453
Validation r2 = 0.264985
Epoch 1
Loss = 8.9694e-01, PNorm = 34.0487, GNorm = 8.7290, lr_0 = 7.6000e-04
Loss = 6.1101e-01, PNorm = 34.1039, GNorm = 1.7084, lr_0 = 9.9472e-04
Validation rmse = 0.316524
Validation r2 = 0.474811
Epoch 2
Loss = 4.8751e-01, PNorm = 34.1915, GNorm = 1.8059, lr_0 = 9.6874e-04
Validation rmse = 0.285892
Validation r2 = 0.571543
Epoch 3
Loss = 3.4676e-01, PNorm = 34.2779, GNorm = 2.2586, lr_0 = 9.4094e-04
Loss = 4.1748e-01, PNorm = 34.3369, GNorm = 11.0380, lr_0 = 9.1637e-04
Validation rmse = 0.274380
Validation r2 = 0.605354
Epoch 4
Loss = 3.4832e-01, PNorm = 34.3901, GNorm = 7.8735, lr_0 = 8.9243e-04
Validation rmse = 0.227319
Validation r2 = 0.729122
Epoch 5
Loss = 3.8702e-01, PNorm = 34.4362, GNorm = 2.1446, lr_0 = 8.6912e-04
Loss = 4.0707e-01, PNorm = 34.4864, GNorm = 0.6618, lr_0 = 8.4642e-04
Validation rmse = 0.236214
Validation r2 = 0.707508
Epoch 6
Loss = 2.9334e-01, PNorm = 34.5286, GNorm = 1.4997, lr_0 = 8.2213e-04
Validation rmse = 0.234412
Validation r2 = 0.711954
Epoch 7
Loss = 3.7123e-01, PNorm = 34.5696, GNorm = 6.1440, lr_0 = 8.0066e-04
Loss = 2.4887e-01, PNorm = 34.6058, GNorm = 1.8960, lr_0 = 7.7975e-04
Validation rmse = 0.199123
Validation r2 = 0.792152
Epoch 8
Loss = 2.2490e-01, PNorm = 34.6377, GNorm = 1.6119, lr_0 = 7.5737e-04
Loss = 2.4229e-01, PNorm = 34.6699, GNorm = 2.8904, lr_0 = 7.3759e-04
Validation rmse = 0.192878
Validation r2 = 0.804985
Epoch 9
Loss = 2.1970e-01, PNorm = 34.7031, GNorm = 3.0257, lr_0 = 7.1833e-04
Validation rmse = 0.209838
Validation r2 = 0.769181
Epoch 10
Loss = 2.2492e-01, PNorm = 34.7217, GNorm = 4.1809, lr_0 = 6.9956e-04
Loss = 2.3206e-01, PNorm = 34.7435, GNorm = 5.3153, lr_0 = 6.8129e-04
Validation rmse = 0.227128
Validation r2 = 0.729577
Epoch 11
Loss = 2.7863e-01, PNorm = 34.7803, GNorm = 4.6298, lr_0 = 6.6174e-04
Validation rmse = 0.204472
Validation r2 = 0.780835
Epoch 12
Loss = 2.5319e-01, PNorm = 34.8079, GNorm = 0.9027, lr_0 = 6.4446e-04
Loss = 1.7681e-01, PNorm = 34.8326, GNorm = 2.0772, lr_0 = 6.2763e-04
Validation rmse = 0.187934
Validation r2 = 0.814855
Epoch 13
Loss = 2.1080e-01, PNorm = 34.8588, GNorm = 1.2914, lr_0 = 6.1123e-04
Validation rmse = 0.194127
Validation r2 = 0.802451
Epoch 14
Loss = 2.1022e-01, PNorm = 34.8853, GNorm = 1.9450, lr_0 = 5.9369e-04
Loss = 1.8684e-01, PNorm = 34.9083, GNorm = 3.2925, lr_0 = 5.7819e-04
Validation rmse = 0.180634
Validation r2 = 0.828960
Epoch 15
Loss = 1.8219e-01, PNorm = 34.9329, GNorm = 0.7892, lr_0 = 5.6309e-04
Validation rmse = 0.177418
Validation r2 = 0.834994
Epoch 16
Loss = 7.4102e-02, PNorm = 34.9578, GNorm = 0.8812, lr_0 = 5.4693e-04
Loss = 1.7596e-01, PNorm = 34.9789, GNorm = 3.3497, lr_0 = 5.3264e-04
Validation rmse = 0.183620
Validation r2 = 0.823257
Epoch 17
Loss = 1.4524e-01, PNorm = 35.0030, GNorm = 1.4410, lr_0 = 5.1873e-04
Loss = 1.7280e-01, PNorm = 35.0268, GNorm = 4.9560, lr_0 = 5.0518e-04
Validation rmse = 0.179556
Validation r2 = 0.830995
Epoch 18
Loss = 1.3775e-01, PNorm = 35.0461, GNorm = 4.3685, lr_0 = 4.9199e-04
Validation rmse = 0.171711
Validation r2 = 0.845440
Epoch 19
Loss = 1.7670e-01, PNorm = 35.0666, GNorm = 0.9170, lr_0 = 4.7787e-04
Loss = 1.4669e-01, PNorm = 35.0869, GNorm = 3.1529, lr_0 = 4.6539e-04
Validation rmse = 0.177443
Validation r2 = 0.834949
Epoch 20
Loss = 1.5929e-01, PNorm = 35.1066, GNorm = 0.9728, lr_0 = 4.5323e-04
Validation rmse = 0.173692
Validation r2 = 0.841853
Epoch 21
Loss = 1.2873e-01, PNorm = 35.1233, GNorm = 1.8374, lr_0 = 4.4140e-04
Loss = 1.4838e-01, PNorm = 35.1424, GNorm = 3.4695, lr_0 = 4.2987e-04
Validation rmse = 0.173429
Validation r2 = 0.842331
Epoch 22
Loss = 1.1441e-01, PNorm = 35.1557, GNorm = 0.9775, lr_0 = 4.1753e-04
Validation rmse = 0.180386
Validation r2 = 0.829428
Epoch 23
Loss = 1.4323e-01, PNorm = 35.1708, GNorm = 0.8216, lr_0 = 4.0663e-04
Loss = 1.3858e-01, PNorm = 35.1851, GNorm = 0.9703, lr_0 = 3.9601e-04
Validation rmse = 0.190057
Validation r2 = 0.810648
Epoch 24
Loss = 1.4588e-01, PNorm = 35.2060, GNorm = 2.2205, lr_0 = 3.8464e-04
Loss = 1.4575e-01, PNorm = 35.2190, GNorm = 1.5618, lr_0 = 3.7460e-04
Validation rmse = 0.178900
Validation r2 = 0.832227
Epoch 25
Loss = 1.3235e-01, PNorm = 35.2286, GNorm = 0.6906, lr_0 = 3.6481e-04
Validation rmse = 0.167748
Validation r2 = 0.852491
Epoch 26
Loss = 1.0288e-01, PNorm = 35.2444, GNorm = 0.9309, lr_0 = 3.5528e-04
Loss = 1.4853e-01, PNorm = 35.2582, GNorm = 3.2156, lr_0 = 3.4600e-04
Validation rmse = 0.172436
Validation r2 = 0.844132
Epoch 27
Loss = 1.3356e-01, PNorm = 35.2717, GNorm = 0.6018, lr_0 = 3.3608e-04
Validation rmse = 0.171347
Validation r2 = 0.846094
Epoch 28
Loss = 1.0952e-01, PNorm = 35.2851, GNorm = 0.8660, lr_0 = 3.2730e-04
Loss = 1.3428e-01, PNorm = 35.2932, GNorm = 2.2490, lr_0 = 3.1875e-04
Validation rmse = 0.171240
Validation r2 = 0.846287
Epoch 29
Loss = 1.0577e-01, PNorm = 35.3065, GNorm = 2.2741, lr_0 = 3.0960e-04
Validation rmse = 0.174156
Validation r2 = 0.841008
Epoch 30
Loss = 1.2064e-01, PNorm = 35.3195, GNorm = 2.4131, lr_0 = 3.0152e-04
Loss = 1.3001e-01, PNorm = 35.3306, GNorm = 1.1287, lr_0 = 2.9364e-04
Validation rmse = 0.166564
Validation r2 = 0.854566
Epoch 31
Loss = 9.3803e-02, PNorm = 35.3406, GNorm = 0.9455, lr_0 = 2.8597e-04
Validation rmse = 0.172177
Validation r2 = 0.844600
Epoch 32
Loss = 1.1269e-01, PNorm = 35.3504, GNorm = 2.2104, lr_0 = 2.7777e-04
Loss = 1.2685e-01, PNorm = 35.3587, GNorm = 1.5705, lr_0 = 2.7051e-04
Validation rmse = 0.172252
Validation r2 = 0.844463
Epoch 33
Loss = 1.4266e-01, PNorm = 35.3700, GNorm = 2.4859, lr_0 = 2.6344e-04
Loss = 1.2105e-01, PNorm = 35.3790, GNorm = 2.2014, lr_0 = 2.5656e-04
Validation rmse = 0.172503
Validation r2 = 0.844011
Epoch 34
Loss = 1.2915e-01, PNorm = 35.3875, GNorm = 2.5224, lr_0 = 2.4986e-04
Validation rmse = 0.165996
Validation r2 = 0.855557
Epoch 35
Loss = 1.0116e-01, PNorm = 35.3988, GNorm = 2.0023, lr_0 = 2.4269e-04
Loss = 1.1535e-01, PNorm = 35.4080, GNorm = 2.4638, lr_0 = 2.3635e-04
Validation rmse = 0.171589
Validation r2 = 0.845659
Epoch 36
Loss = 9.2927e-02, PNorm = 35.4141, GNorm = 0.8890, lr_0 = 2.3018e-04
Validation rmse = 0.167195
Validation r2 = 0.853463
Epoch 37
Loss = 1.6449e-01, PNorm = 35.4228, GNorm = 1.3214, lr_0 = 2.2358e-04
Loss = 9.9977e-02, PNorm = 35.4292, GNorm = 3.2250, lr_0 = 2.1774e-04
Validation rmse = 0.169607
Validation r2 = 0.849204
Epoch 38
Loss = 1.2650e-01, PNorm = 35.4369, GNorm = 1.9308, lr_0 = 2.1205e-04
Validation rmse = 0.172646
Validation r2 = 0.843753
Epoch 39
Loss = 8.2482e-02, PNorm = 35.4436, GNorm = 0.7918, lr_0 = 2.0651e-04
Loss = 1.2579e-01, PNorm = 35.4508, GNorm = 1.9373, lr_0 = 2.0112e-04
Validation rmse = 0.173582
Validation r2 = 0.842053
Epoch 40
Loss = 1.0825e-01, PNorm = 35.4561, GNorm = 1.3095, lr_0 = 1.9535e-04
Loss = 1.1793e-01, PNorm = 35.4622, GNorm = 3.5874, lr_0 = 1.9024e-04
Validation rmse = 0.166729
Validation r2 = 0.854278
Epoch 41
Loss = 1.1475e-01, PNorm = 35.4686, GNorm = 1.9502, lr_0 = 1.8527e-04
Validation rmse = 0.171224
Validation r2 = 0.846315
Epoch 42
Loss = 1.1158e-01, PNorm = 35.4748, GNorm = 1.0141, lr_0 = 1.8044e-04
Loss = 1.0997e-01, PNorm = 35.4805, GNorm = 3.3042, lr_0 = 1.7572e-04
Validation rmse = 0.171734
Validation r2 = 0.845398
Epoch 43
Loss = 1.0791e-01, PNorm = 35.4879, GNorm = 1.5238, lr_0 = 1.7068e-04
Validation rmse = 0.166873
Validation r2 = 0.854027
Epoch 44
Loss = 1.0338e-01, PNorm = 35.4938, GNorm = 2.6408, lr_0 = 1.6622e-04
Loss = 1.1218e-01, PNorm = 35.4993, GNorm = 2.0912, lr_0 = 1.6188e-04
Validation rmse = 0.167866
Validation r2 = 0.852284
Epoch 45
Loss = 1.0555e-01, PNorm = 35.5063, GNorm = 3.0856, lr_0 = 1.5724e-04
Validation rmse = 0.178880
Validation r2 = 0.832265
Epoch 46
Loss = 1.2561e-01, PNorm = 35.5107, GNorm = 2.1569, lr_0 = 1.5313e-04
Loss = 1.1184e-01, PNorm = 35.5161, GNorm = 3.2351, lr_0 = 1.4913e-04
Validation rmse = 0.166683
Validation r2 = 0.854359
Epoch 47
Loss = 1.1624e-01, PNorm = 35.5211, GNorm = 2.3511, lr_0 = 1.4523e-04
Validation rmse = 0.171168
Validation r2 = 0.846417
Epoch 48
Loss = 9.7438e-02, PNorm = 35.5274, GNorm = 2.8860, lr_0 = 1.4107e-04
Loss = 1.0255e-01, PNorm = 35.5322, GNorm = 1.4468, lr_0 = 1.3738e-04
Validation rmse = 0.166511
Validation r2 = 0.854659
Epoch 49
Loss = 9.1884e-02, PNorm = 35.5357, GNorm = 1.5372, lr_0 = 1.3379e-04
Loss = 1.2447e-01, PNorm = 35.5394, GNorm = 2.1443, lr_0 = 1.3030e-04
Validation rmse = 0.166598
Validation r2 = 0.854508
Epoch 50
Loss = 1.0037e-01, PNorm = 35.5431, GNorm = 2.9851, lr_0 = 1.2690e-04
Validation rmse = 0.171316
Validation r2 = 0.846149
Epoch 51
Loss = 8.9583e-02, PNorm = 35.5483, GNorm = 1.0184, lr_0 = 1.2326e-04
Loss = 1.2195e-01, PNorm = 35.5526, GNorm = 1.8214, lr_0 = 1.2004e-04
Validation rmse = 0.167758
Validation r2 = 0.852474
Epoch 52
Loss = 9.6538e-02, PNorm = 35.5568, GNorm = 1.3922, lr_0 = 1.1690e-04
Validation rmse = 0.165886
Validation r2 = 0.855749
Epoch 53
Loss = 1.2816e-01, PNorm = 35.5607, GNorm = 1.1393, lr_0 = 1.1355e-04
Loss = 9.8263e-02, PNorm = 35.5651, GNorm = 1.5813, lr_0 = 1.1058e-04
Validation rmse = 0.167968
Validation r2 = 0.852105
Epoch 54
Loss = 8.5544e-02, PNorm = 35.5680, GNorm = 1.8494, lr_0 = 1.0769e-04
Validation rmse = 0.167885
Validation r2 = 0.852251
Epoch 55
Loss = 9.8974e-02, PNorm = 35.5722, GNorm = 1.9867, lr_0 = 1.0488e-04
Loss = 1.2110e-01, PNorm = 35.5752, GNorm = 2.2852, lr_0 = 1.0214e-04
Validation rmse = 0.168967
Validation r2 = 0.850341
Epoch 56
Loss = 8.9520e-02, PNorm = 35.5785, GNorm = 1.8149, lr_0 = 1.0000e-04
Loss = 1.0735e-01, PNorm = 35.5822, GNorm = 2.6000, lr_0 = 1.0000e-04
Validation rmse = 0.165492
Validation r2 = 0.856433
Epoch 57
Loss = 8.9343e-02, PNorm = 35.5864, GNorm = 1.2110, lr_0 = 1.0000e-04
Validation rmse = 0.167035
Validation r2 = 0.853743
Epoch 58
Loss = 9.5632e-02, PNorm = 35.5893, GNorm = 1.2202, lr_0 = 1.0000e-04
Loss = 9.7126e-02, PNorm = 35.5925, GNorm = 2.1048, lr_0 = 1.0000e-04
Validation rmse = 0.165043
Validation r2 = 0.857211
Epoch 59
Loss = 9.3142e-02, PNorm = 35.5957, GNorm = 0.6989, lr_0 = 1.0000e-04
Validation rmse = 0.169179
Validation r2 = 0.849965
Model 0 best validation rmse = 0.165043 on epoch 58
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.167332
Model 0 test r2 = 0.784566
Ensemble test rmse = 0.167332
Ensemble test r2 = 0.784566
Fold 6
Splitting data with seed 6
Total size = 977 | train size = 781 | val size = 98 | test size = 98
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.7614e-01, PNorm = 34.0173, GNorm = 1.5170, lr_0 = 4.3000e-04
Validation rmse = 0.415613
Validation r2 = 0.192210
Epoch 1
Loss = 7.7862e-01, PNorm = 34.0476, GNorm = 1.5208, lr_0 = 7.6000e-04
Loss = 6.9536e-01, PNorm = 34.1092, GNorm = 9.9799, lr_0 = 9.9472e-04
Validation rmse = 0.359701
Validation r2 = 0.394935
Epoch 2
Loss = 6.5564e-01, PNorm = 34.1813, GNorm = 4.4072, lr_0 = 9.6874e-04
Validation rmse = 0.290987
Validation r2 = 0.604026
Epoch 3
Loss = 5.6518e-01, PNorm = 34.2721, GNorm = 3.3300, lr_0 = 9.4094e-04
Loss = 3.2474e-01, PNorm = 34.3472, GNorm = 2.0466, lr_0 = 9.1637e-04
Validation rmse = 0.287410
Validation r2 = 0.613702
Epoch 4
Loss = 3.2702e-01, PNorm = 34.4044, GNorm = 0.5410, lr_0 = 8.9243e-04
Validation rmse = 0.249652
Validation r2 = 0.708533
Epoch 5
Loss = 2.0630e-01, PNorm = 34.4522, GNorm = 3.7158, lr_0 = 8.6912e-04
Loss = 3.6133e-01, PNorm = 34.5002, GNorm = 1.2622, lr_0 = 8.4642e-04
Validation rmse = 0.264351
Validation r2 = 0.673201
Epoch 6
Loss = 2.4555e-01, PNorm = 34.5442, GNorm = 0.7850, lr_0 = 8.2213e-04
Validation rmse = 0.267940
Validation r2 = 0.664266
Epoch 7
Loss = 1.9095e-01, PNorm = 34.5798, GNorm = 3.9246, lr_0 = 8.0066e-04
Loss = 2.4063e-01, PNorm = 34.6162, GNorm = 1.6566, lr_0 = 7.7975e-04
Validation rmse = 0.233970
Validation r2 = 0.744001
Epoch 8
Loss = 2.4876e-01, PNorm = 34.6657, GNorm = 0.9593, lr_0 = 7.5737e-04
Loss = 2.3036e-01, PNorm = 34.6978, GNorm = 3.2938, lr_0 = 7.3759e-04
Validation rmse = 0.226145
Validation r2 = 0.760838
Epoch 9
Loss = 2.0400e-01, PNorm = 34.7294, GNorm = 2.0232, lr_0 = 7.1833e-04
Validation rmse = 0.246173
Validation r2 = 0.716599
Epoch 10
Loss = 1.9842e-01, PNorm = 34.7536, GNorm = 0.9431, lr_0 = 6.9956e-04
Loss = 2.0336e-01, PNorm = 34.7836, GNorm = 2.7027, lr_0 = 6.8129e-04
Validation rmse = 0.228046
Validation r2 = 0.756800
Epoch 11
Loss = 2.1102e-01, PNorm = 34.8083, GNorm = 2.6478, lr_0 = 6.6174e-04
Validation rmse = 0.224459
Validation r2 = 0.764391
Epoch 12
Loss = 1.4267e-01, PNorm = 34.8399, GNorm = 2.2876, lr_0 = 6.4446e-04
Loss = 1.7759e-01, PNorm = 34.8710, GNorm = 1.9042, lr_0 = 6.2763e-04
Validation rmse = 0.231140
Validation r2 = 0.750156
Epoch 13
Loss = 1.9340e-01, PNorm = 34.9025, GNorm = 2.3912, lr_0 = 6.1123e-04
Validation rmse = 0.233648
Validation r2 = 0.744704
Epoch 14
Loss = 1.8261e-01, PNorm = 34.9308, GNorm = 1.4855, lr_0 = 5.9369e-04
Loss = 1.7126e-01, PNorm = 34.9563, GNorm = 2.6058, lr_0 = 5.7819e-04
Validation rmse = 0.226358
Validation r2 = 0.760386
Epoch 15
Loss = 1.5063e-01, PNorm = 34.9771, GNorm = 2.4194, lr_0 = 5.6309e-04
Validation rmse = 0.221993
Validation r2 = 0.769539
Epoch 16
Loss = 2.2433e-01, PNorm = 35.0027, GNorm = 4.2090, lr_0 = 5.4693e-04
Loss = 1.8388e-01, PNorm = 35.0322, GNorm = 3.9315, lr_0 = 5.3264e-04
Validation rmse = 0.220198
Validation r2 = 0.773251
Epoch 17
Loss = 1.3260e-01, PNorm = 35.0469, GNorm = 2.1297, lr_0 = 5.1873e-04
Loss = 1.6185e-01, PNorm = 35.0671, GNorm = 3.0571, lr_0 = 5.0518e-04
Validation rmse = 0.220555
Validation r2 = 0.772514
Epoch 18
Loss = 1.5901e-01, PNorm = 35.0815, GNorm = 1.3502, lr_0 = 4.9199e-04
Validation rmse = 0.221818
Validation r2 = 0.769902
Epoch 19
Loss = 1.5548e-01, PNorm = 35.1023, GNorm = 0.6353, lr_0 = 4.7787e-04
Loss = 1.7403e-01, PNorm = 35.1150, GNorm = 5.0035, lr_0 = 4.6539e-04
Validation rmse = 0.221020
Validation r2 = 0.771555
Epoch 20
Loss = 1.4882e-01, PNorm = 35.1321, GNorm = 1.2738, lr_0 = 4.5323e-04
Validation rmse = 0.223600
Validation r2 = 0.766191
Epoch 21
Loss = 2.1443e-01, PNorm = 35.1480, GNorm = 7.0117, lr_0 = 4.4140e-04
Loss = 1.4648e-01, PNorm = 35.1631, GNorm = 0.8913, lr_0 = 4.2987e-04
Validation rmse = 0.217246
Validation r2 = 0.779290
Epoch 22
Loss = 1.4145e-01, PNorm = 35.1782, GNorm = 1.6517, lr_0 = 4.1753e-04
Validation rmse = 0.217428
Validation r2 = 0.778919
Epoch 23
Loss = 1.5665e-01, PNorm = 35.1950, GNorm = 0.9941, lr_0 = 4.0663e-04
Loss = 1.4354e-01, PNorm = 35.2089, GNorm = 3.5893, lr_0 = 3.9601e-04
Validation rmse = 0.226912
Validation r2 = 0.759212
Epoch 24
Loss = 1.2917e-01, PNorm = 35.2238, GNorm = 0.7873, lr_0 = 3.8464e-04
Loss = 1.5155e-01, PNorm = 35.2331, GNorm = 5.9526, lr_0 = 3.7460e-04
Validation rmse = 0.215614
Validation r2 = 0.782592
Epoch 25
Loss = 1.2635e-01, PNorm = 35.2463, GNorm = 0.8677, lr_0 = 3.6481e-04
Validation rmse = 0.219204
Validation r2 = 0.775293
Epoch 26
Loss = 1.3487e-01, PNorm = 35.2559, GNorm = 2.5864, lr_0 = 3.5528e-04
Loss = 1.1978e-01, PNorm = 35.2671, GNorm = 0.6771, lr_0 = 3.4600e-04
Validation rmse = 0.218447
Validation r2 = 0.776842
Epoch 27
Loss = 1.1381e-01, PNorm = 35.2768, GNorm = 1.4899, lr_0 = 3.3608e-04
Validation rmse = 0.216974
Validation r2 = 0.779842
Epoch 28
Loss = 1.4477e-01, PNorm = 35.2886, GNorm = 1.8548, lr_0 = 3.2730e-04
Loss = 1.2419e-01, PNorm = 35.2991, GNorm = 1.0744, lr_0 = 3.1875e-04
Validation rmse = 0.218335
Validation r2 = 0.777071
Epoch 29
Loss = 1.2564e-01, PNorm = 35.3090, GNorm = 3.1681, lr_0 = 3.0960e-04
Validation rmse = 0.215657
Validation r2 = 0.782506
Epoch 30
Loss = 9.2281e-02, PNorm = 35.3167, GNorm = 0.6440, lr_0 = 3.0152e-04
Loss = 1.3267e-01, PNorm = 35.3259, GNorm = 4.9275, lr_0 = 2.9364e-04
Validation rmse = 0.217989
Validation r2 = 0.777776
Epoch 31
Loss = 1.2424e-01, PNorm = 35.3352, GNorm = 0.9464, lr_0 = 2.8597e-04
Validation rmse = 0.218620
Validation r2 = 0.776489
Epoch 32
Loss = 9.6037e-02, PNorm = 35.3454, GNorm = 1.3378, lr_0 = 2.7777e-04
Loss = 1.1801e-01, PNorm = 35.3519, GNorm = 2.6222, lr_0 = 2.7051e-04
Validation rmse = 0.215157
Validation r2 = 0.783514
Epoch 33
Loss = 1.2267e-01, PNorm = 35.3602, GNorm = 0.8644, lr_0 = 2.6344e-04
Loss = 1.3064e-01, PNorm = 35.3688, GNorm = 1.5377, lr_0 = 2.5656e-04
Validation rmse = 0.217563
Validation r2 = 0.778645
Epoch 34
Loss = 1.1232e-01, PNorm = 35.3766, GNorm = 1.6225, lr_0 = 2.4986e-04
Validation rmse = 0.216867
Validation r2 = 0.780058
Epoch 35
Loss = 9.3856e-02, PNorm = 35.3837, GNorm = 1.2198, lr_0 = 2.4269e-04
Loss = 1.1711e-01, PNorm = 35.3910, GNorm = 1.0979, lr_0 = 2.3635e-04
Validation rmse = 0.216020
Validation r2 = 0.781774
Epoch 36
Loss = 1.1408e-01, PNorm = 35.3989, GNorm = 1.8259, lr_0 = 2.3018e-04
Validation rmse = 0.214483
Validation r2 = 0.784867
Epoch 37
Loss = 8.5588e-02, PNorm = 35.4063, GNorm = 0.6150, lr_0 = 2.2358e-04
Loss = 1.2183e-01, PNorm = 35.4130, GNorm = 4.0850, lr_0 = 2.1774e-04
Validation rmse = 0.222897
Validation r2 = 0.767658
Epoch 38
Loss = 1.0884e-01, PNorm = 35.4205, GNorm = 3.1212, lr_0 = 2.1205e-04
Validation rmse = 0.215207
Validation r2 = 0.783413
Epoch 39
Loss = 1.1786e-01, PNorm = 35.4277, GNorm = 2.2766, lr_0 = 2.0651e-04
Loss = 1.1163e-01, PNorm = 35.4337, GNorm = 2.0605, lr_0 = 2.0112e-04
Validation rmse = 0.216047
Validation r2 = 0.781718
Epoch 40
Loss = 1.0985e-01, PNorm = 35.4405, GNorm = 1.6536, lr_0 = 1.9535e-04
Loss = 1.1040e-01, PNorm = 35.4455, GNorm = 0.4792, lr_0 = 1.9024e-04
Validation rmse = 0.215500
Validation r2 = 0.782823
Epoch 41
Loss = 1.1315e-01, PNorm = 35.4523, GNorm = 1.7429, lr_0 = 1.8527e-04
Validation rmse = 0.219097
Validation r2 = 0.775512
Epoch 42
Loss = 1.0619e-01, PNorm = 35.4563, GNorm = 2.1423, lr_0 = 1.8044e-04
Loss = 1.0955e-01, PNorm = 35.4611, GNorm = 1.0109, lr_0 = 1.7572e-04
Validation rmse = 0.214118
Validation r2 = 0.785599
Epoch 43
Loss = 9.5968e-02, PNorm = 35.4661, GNorm = 0.7390, lr_0 = 1.7068e-04
Validation rmse = 0.216643
Validation r2 = 0.780513
Epoch 44
Loss = 9.7430e-02, PNorm = 35.4721, GNorm = 1.2335, lr_0 = 1.6622e-04
Loss = 1.0269e-01, PNorm = 35.4772, GNorm = 2.6140, lr_0 = 1.6188e-04
Validation rmse = 0.214950
Validation r2 = 0.783930
Epoch 45
Loss = 1.0281e-01, PNorm = 35.4810, GNorm = 0.9358, lr_0 = 1.5724e-04
Validation rmse = 0.214961
Validation r2 = 0.783908
Epoch 46
Loss = 8.5844e-02, PNorm = 35.4860, GNorm = 2.8193, lr_0 = 1.5313e-04
Loss = 1.0643e-01, PNorm = 35.4900, GNorm = 0.9603, lr_0 = 1.4913e-04
Validation rmse = 0.220388
Validation r2 = 0.772858
Epoch 47
Loss = 9.3862e-02, PNorm = 35.4941, GNorm = 1.7633, lr_0 = 1.4523e-04
Validation rmse = 0.215755
Validation r2 = 0.782308
Epoch 48
Loss = 7.9794e-02, PNorm = 35.4982, GNorm = 1.1543, lr_0 = 1.4107e-04
Loss = 9.9410e-02, PNorm = 35.5024, GNorm = 0.6890, lr_0 = 1.3738e-04
Validation rmse = 0.215485
Validation r2 = 0.782854
Epoch 49
Loss = 1.1035e-01, PNorm = 35.5068, GNorm = 1.3475, lr_0 = 1.3379e-04
Loss = 1.0516e-01, PNorm = 35.5103, GNorm = 3.8532, lr_0 = 1.3030e-04
Validation rmse = 0.218501
Validation r2 = 0.776732
Epoch 50
Loss = 1.0275e-01, PNorm = 35.5151, GNorm = 1.4416, lr_0 = 1.2690e-04
Validation rmse = 0.216486
Validation r2 = 0.780832
Epoch 51
Loss = 1.0535e-01, PNorm = 35.5185, GNorm = 0.9938, lr_0 = 1.2326e-04
Loss = 1.0227e-01, PNorm = 35.5221, GNorm = 1.0549, lr_0 = 1.2004e-04
Validation rmse = 0.215452
Validation r2 = 0.782919
Epoch 52
Loss = 9.6747e-02, PNorm = 35.5255, GNorm = 0.9676, lr_0 = 1.1690e-04
Validation rmse = 0.217201
Validation r2 = 0.779382
Epoch 53
Loss = 1.1566e-01, PNorm = 35.5296, GNorm = 0.4958, lr_0 = 1.1355e-04
Loss = 9.7295e-02, PNorm = 35.5334, GNorm = 0.8181, lr_0 = 1.1058e-04
Validation rmse = 0.218381
Validation r2 = 0.776978
Epoch 54
Loss = 1.0193e-01, PNorm = 35.5355, GNorm = 2.8853, lr_0 = 1.0769e-04
Validation rmse = 0.214602
Validation r2 = 0.784628
Epoch 55
Loss = 9.4540e-02, PNorm = 35.5387, GNorm = 0.8255, lr_0 = 1.0488e-04
Loss = 9.5043e-02, PNorm = 35.5425, GNorm = 1.1593, lr_0 = 1.0214e-04
Validation rmse = 0.216341
Validation r2 = 0.781125
Epoch 56
Loss = 8.7585e-02, PNorm = 35.5460, GNorm = 1.1651, lr_0 = 1.0000e-04
Loss = 1.0588e-01, PNorm = 35.5497, GNorm = 1.2139, lr_0 = 1.0000e-04
Validation rmse = 0.214910
Validation r2 = 0.784010
Epoch 57
Loss = 1.0395e-01, PNorm = 35.5522, GNorm = 1.3110, lr_0 = 1.0000e-04
Validation rmse = 0.215586
Validation r2 = 0.782649
Epoch 58
Loss = 7.9137e-02, PNorm = 35.5554, GNorm = 1.9842, lr_0 = 1.0000e-04
Loss = 9.5877e-02, PNorm = 35.5582, GNorm = 1.0514, lr_0 = 1.0000e-04
Validation rmse = 0.216566
Validation r2 = 0.780669
Epoch 59
Loss = 9.8781e-02, PNorm = 35.5609, GNorm = 2.1429, lr_0 = 1.0000e-04
Validation rmse = 0.215925
Validation r2 = 0.781965
Model 0 best validation rmse = 0.214118 on epoch 42
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.151179
Model 0 test r2 = 0.849586
Ensemble test rmse = 0.151179
Ensemble test r2 = 0.849586
Fold 7
Splitting data with seed 7
Total size = 977 | train size = 781 | val size = 98 | test size = 98
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.8055e-01, PNorm = 34.0151, GNorm = 1.7450, lr_0 = 4.3000e-04
Validation rmse = 0.431945
Validation r2 = 0.036413
Epoch 1
Loss = 7.8994e-01, PNorm = 34.0397, GNorm = 9.5509, lr_0 = 7.6000e-04
Loss = 7.5977e-01, PNorm = 34.0994, GNorm = 1.1247, lr_0 = 9.9472e-04
Validation rmse = 0.304592
Validation r2 = 0.520850
Epoch 2
Loss = 5.1520e-01, PNorm = 34.1771, GNorm = 0.8001, lr_0 = 9.6874e-04
Validation rmse = 0.231011
Validation r2 = 0.724386
Epoch 3
Loss = 2.6143e-01, PNorm = 34.2839, GNorm = 1.9281, lr_0 = 9.4094e-04
Loss = 3.9273e-01, PNorm = 34.3378, GNorm = 1.9639, lr_0 = 9.1637e-04
Validation rmse = 0.294944
Validation r2 = 0.550724
Epoch 4
Loss = 4.3410e-01, PNorm = 34.3851, GNorm = 2.9318, lr_0 = 8.9243e-04
Validation rmse = 0.193956
Validation r2 = 0.805715
Epoch 5
Loss = 1.8869e-01, PNorm = 34.4336, GNorm = 2.9647, lr_0 = 8.6912e-04
Loss = 2.9272e-01, PNorm = 34.4774, GNorm = 0.8315, lr_0 = 8.4642e-04
Validation rmse = 0.197535
Validation r2 = 0.798478
Epoch 6
Loss = 2.3292e-01, PNorm = 34.5028, GNorm = 2.8114, lr_0 = 8.2213e-04
Validation rmse = 0.172923
Validation r2 = 0.845567
Epoch 7
Loss = 2.0671e-01, PNorm = 34.5380, GNorm = 2.7397, lr_0 = 8.0066e-04
Loss = 2.2785e-01, PNorm = 34.5710, GNorm = 1.5022, lr_0 = 7.7975e-04
Validation rmse = 0.177187
Validation r2 = 0.837857
Epoch 8
Loss = 2.0026e-01, PNorm = 34.6061, GNorm = 2.7056, lr_0 = 7.5737e-04
Loss = 3.3004e-01, PNorm = 34.6361, GNorm = 7.0550, lr_0 = 7.3759e-04
Validation rmse = 0.165390
Validation r2 = 0.858728
Epoch 9
Loss = 3.2953e-01, PNorm = 34.6650, GNorm = 6.3871, lr_0 = 7.1833e-04
Validation rmse = 0.202209
Validation r2 = 0.788829
Epoch 10
Loss = 2.2797e-01, PNorm = 34.6955, GNorm = 4.6570, lr_0 = 6.9956e-04
Loss = 2.4534e-01, PNorm = 34.7289, GNorm = 0.4676, lr_0 = 6.8129e-04
Validation rmse = 0.194317
Validation r2 = 0.804989
Epoch 11
Loss = 2.5216e-01, PNorm = 34.7645, GNorm = 5.6798, lr_0 = 6.6174e-04
Validation rmse = 0.206541
Validation r2 = 0.779682
Epoch 12
Loss = 2.2120e-01, PNorm = 34.7891, GNorm = 1.6863, lr_0 = 6.4446e-04
Loss = 2.0775e-01, PNorm = 34.8120, GNorm = 4.2692, lr_0 = 6.2763e-04
Validation rmse = 0.169866
Validation r2 = 0.850979
Epoch 13
Loss = 1.8845e-01, PNorm = 34.8304, GNorm = 2.5884, lr_0 = 6.1123e-04
Validation rmse = 0.190739
Validation r2 = 0.812105
Epoch 14
Loss = 2.0835e-01, PNorm = 34.8517, GNorm = 5.5056, lr_0 = 5.9369e-04
Loss = 1.9230e-01, PNorm = 34.8792, GNorm = 0.3781, lr_0 = 5.7819e-04
Validation rmse = 0.183711
Validation r2 = 0.825698
Epoch 15
Loss = 1.7480e-01, PNorm = 34.9015, GNorm = 2.5756, lr_0 = 5.6309e-04
Validation rmse = 0.159768
Validation r2 = 0.868170
Epoch 16
Loss = 1.1679e-01, PNorm = 34.9249, GNorm = 0.5788, lr_0 = 5.4693e-04
Loss = 1.9443e-01, PNorm = 34.9405, GNorm = 2.7130, lr_0 = 5.3264e-04
Validation rmse = 0.185933
Validation r2 = 0.821455
Epoch 17
Loss = 1.7262e-01, PNorm = 34.9578, GNorm = 3.6494, lr_0 = 5.1873e-04
Loss = 1.7062e-01, PNorm = 34.9745, GNorm = 1.5530, lr_0 = 5.0518e-04
Validation rmse = 0.168129
Validation r2 = 0.854011
Epoch 18
Loss = 1.8910e-01, PNorm = 34.9930, GNorm = 3.8034, lr_0 = 4.9199e-04
Validation rmse = 0.152857
Validation r2 = 0.879328
Epoch 19
Loss = 1.2188e-01, PNorm = 35.0121, GNorm = 1.2552, lr_0 = 4.7787e-04
Loss = 1.4986e-01, PNorm = 35.0276, GNorm = 0.9057, lr_0 = 4.6539e-04
Validation rmse = 0.168785
Validation r2 = 0.852869
Epoch 20
Loss = 1.5183e-01, PNorm = 35.0442, GNorm = 6.8402, lr_0 = 4.5323e-04
Validation rmse = 0.188597
Validation r2 = 0.816303
Epoch 21
Loss = 1.6275e-01, PNorm = 35.0604, GNorm = 1.4391, lr_0 = 4.4140e-04
Loss = 1.3153e-01, PNorm = 35.0730, GNorm = 1.3770, lr_0 = 4.2987e-04
Validation rmse = 0.164569
Validation r2 = 0.860128
Epoch 22
Loss = 1.3902e-01, PNorm = 35.0870, GNorm = 0.9742, lr_0 = 4.1753e-04
Validation rmse = 0.162192
Validation r2 = 0.864140
Epoch 23
Loss = 1.8029e-01, PNorm = 35.1017, GNorm = 2.4154, lr_0 = 4.0663e-04
Loss = 1.2584e-01, PNorm = 35.1145, GNorm = 1.0461, lr_0 = 3.9601e-04
Validation rmse = 0.165479
Validation r2 = 0.858577
Epoch 24
Loss = 1.5585e-01, PNorm = 35.1285, GNorm = 2.8692, lr_0 = 3.8464e-04
Loss = 1.3072e-01, PNorm = 35.1418, GNorm = 1.2724, lr_0 = 3.7460e-04
Validation rmse = 0.161922
Validation r2 = 0.864592
Epoch 25
Loss = 1.3098e-01, PNorm = 35.1521, GNorm = 1.2466, lr_0 = 3.6481e-04
Validation rmse = 0.172559
Validation r2 = 0.846217
Epoch 26
Loss = 1.1477e-01, PNorm = 35.1646, GNorm = 0.7362, lr_0 = 3.5528e-04
Loss = 1.4918e-01, PNorm = 35.1779, GNorm = 0.6284, lr_0 = 3.4600e-04
Validation rmse = 0.166471
Validation r2 = 0.856876
Epoch 27
Loss = 1.3992e-01, PNorm = 35.1904, GNorm = 0.9034, lr_0 = 3.3608e-04
Validation rmse = 0.159293
Validation r2 = 0.868952
Epoch 28
Loss = 1.5410e-01, PNorm = 35.2027, GNorm = 1.9244, lr_0 = 3.2730e-04
Loss = 1.2657e-01, PNorm = 35.2159, GNorm = 1.0256, lr_0 = 3.1875e-04
Validation rmse = 0.168933
Validation r2 = 0.852612
Epoch 29
Loss = 1.2515e-01, PNorm = 35.2302, GNorm = 2.5410, lr_0 = 3.0960e-04
Validation rmse = 0.167076
Validation r2 = 0.855833
Epoch 30
Loss = 8.8261e-02, PNorm = 35.2394, GNorm = 0.9821, lr_0 = 3.0152e-04
Loss = 1.3806e-01, PNorm = 35.2480, GNorm = 0.7865, lr_0 = 2.9364e-04
Validation rmse = 0.175037
Validation r2 = 0.841768
Epoch 31
Loss = 1.2923e-01, PNorm = 35.2564, GNorm = 2.3046, lr_0 = 2.8597e-04
Validation rmse = 0.157795
Validation r2 = 0.871405
Epoch 32
Loss = 1.0342e-01, PNorm = 35.2676, GNorm = 0.5117, lr_0 = 2.7777e-04
Loss = 1.2595e-01, PNorm = 35.2754, GNorm = 2.8222, lr_0 = 2.7051e-04
Validation rmse = 0.159766
Validation r2 = 0.868173
Epoch 33
Loss = 8.3398e-02, PNorm = 35.2850, GNorm = 3.2362, lr_0 = 2.6344e-04
Loss = 1.3766e-01, PNorm = 35.2942, GNorm = 1.6092, lr_0 = 2.5656e-04
Validation rmse = 0.160222
Validation r2 = 0.867420
Epoch 34
Loss = 1.1665e-01, PNorm = 35.3037, GNorm = 2.3063, lr_0 = 2.4986e-04
Validation rmse = 0.177325
Validation r2 = 0.837604
Epoch 35
Loss = 1.3571e-01, PNorm = 35.3122, GNorm = 1.7955, lr_0 = 2.4269e-04
Loss = 1.1047e-01, PNorm = 35.3200, GNorm = 0.9956, lr_0 = 2.3635e-04
Validation rmse = 0.158961
Validation r2 = 0.869499
Epoch 36
Loss = 1.3135e-01, PNorm = 35.3290, GNorm = 3.8642, lr_0 = 2.3018e-04
Validation rmse = 0.178556
Validation r2 = 0.835341
Epoch 37
Loss = 1.0511e-01, PNorm = 35.3382, GNorm = 3.4544, lr_0 = 2.2358e-04
Loss = 1.2327e-01, PNorm = 35.3451, GNorm = 2.3129, lr_0 = 2.1774e-04
Validation rmse = 0.167973
Validation r2 = 0.854282
Epoch 38
Loss = 1.1085e-01, PNorm = 35.3522, GNorm = 3.6456, lr_0 = 2.1205e-04
Validation rmse = 0.166439
Validation r2 = 0.856930
Epoch 39
Loss = 1.3882e-01, PNorm = 35.3583, GNorm = 2.8872, lr_0 = 2.0651e-04
Loss = 1.3397e-01, PNorm = 35.3662, GNorm = 0.5994, lr_0 = 2.0112e-04
Validation rmse = 0.176582
Validation r2 = 0.838962
Epoch 40
Loss = 1.4018e-01, PNorm = 35.3751, GNorm = 0.6521, lr_0 = 1.9535e-04
Loss = 9.2102e-02, PNorm = 35.3823, GNorm = 0.6241, lr_0 = 1.9024e-04
Validation rmse = 0.163715
Validation r2 = 0.861577
Epoch 41
Loss = 1.1224e-01, PNorm = 35.3888, GNorm = 1.6751, lr_0 = 1.8527e-04
Validation rmse = 0.168879
Validation r2 = 0.852706
Epoch 42
Loss = 1.1791e-01, PNorm = 35.3955, GNorm = 3.8561, lr_0 = 1.8044e-04
Loss = 1.2727e-01, PNorm = 35.4023, GNorm = 3.6395, lr_0 = 1.7572e-04
Validation rmse = 0.177309
Validation r2 = 0.837634
Epoch 43
Loss = 9.8815e-02, PNorm = 35.4069, GNorm = 2.6546, lr_0 = 1.7068e-04
Validation rmse = 0.161924
Validation r2 = 0.864587
Epoch 44
Loss = 1.1442e-01, PNorm = 35.4135, GNorm = 0.8068, lr_0 = 1.6622e-04
Loss = 1.1215e-01, PNorm = 35.4202, GNorm = 1.8855, lr_0 = 1.6188e-04
Validation rmse = 0.173707
Validation r2 = 0.844164
Epoch 45
Loss = 1.0151e-01, PNorm = 35.4259, GNorm = 0.9803, lr_0 = 1.5724e-04
Validation rmse = 0.164614
Validation r2 = 0.860052
Epoch 46
Loss = 1.1006e-01, PNorm = 35.4312, GNorm = 1.0103, lr_0 = 1.5313e-04
Loss = 1.1512e-01, PNorm = 35.4375, GNorm = 1.3003, lr_0 = 1.4913e-04
Validation rmse = 0.167392
Validation r2 = 0.855287
Epoch 47
Loss = 1.0675e-01, PNorm = 35.4422, GNorm = 1.0101, lr_0 = 1.4523e-04
Validation rmse = 0.164149
Validation r2 = 0.860841
Epoch 48
Loss = 1.3152e-01, PNorm = 35.4473, GNorm = 0.7657, lr_0 = 1.4107e-04
Loss = 9.8763e-02, PNorm = 35.4518, GNorm = 0.6780, lr_0 = 1.3738e-04
Validation rmse = 0.167618
Validation r2 = 0.854897
Epoch 49
Loss = 8.4468e-02, PNorm = 35.4568, GNorm = 1.7802, lr_0 = 1.3379e-04
Loss = 1.1290e-01, PNorm = 35.4616, GNorm = 0.5872, lr_0 = 1.3030e-04
Validation rmse = 0.164963
Validation r2 = 0.859458
Epoch 50
Loss = 1.1025e-01, PNorm = 35.4653, GNorm = 1.0821, lr_0 = 1.2690e-04
Validation rmse = 0.172129
Validation r2 = 0.846983
Epoch 51
Loss = 1.0074e-01, PNorm = 35.4704, GNorm = 3.1494, lr_0 = 1.2326e-04
Loss = 1.1007e-01, PNorm = 35.4750, GNorm = 0.8421, lr_0 = 1.2004e-04
Validation rmse = 0.173372
Validation r2 = 0.844763
Epoch 52
Loss = 9.2654e-02, PNorm = 35.4782, GNorm = 1.2148, lr_0 = 1.1690e-04
Validation rmse = 0.161979
Validation r2 = 0.864496
Epoch 53
Loss = 1.0703e-01, PNorm = 35.4829, GNorm = 1.0001, lr_0 = 1.1355e-04
Loss = 1.0337e-01, PNorm = 35.4867, GNorm = 1.3119, lr_0 = 1.1058e-04
Validation rmse = 0.165496
Validation r2 = 0.858548
Epoch 54
Loss = 8.1430e-02, PNorm = 35.4902, GNorm = 1.0542, lr_0 = 1.0769e-04
Validation rmse = 0.163822
Validation r2 = 0.861395
Epoch 55
Loss = 9.7160e-02, PNorm = 35.4940, GNorm = 1.6446, lr_0 = 1.0488e-04
Loss = 1.0264e-01, PNorm = 35.4987, GNorm = 1.4313, lr_0 = 1.0214e-04
Validation rmse = 0.168946
Validation r2 = 0.852589
Epoch 56
Loss = 9.6203e-02, PNorm = 35.5026, GNorm = 1.3470, lr_0 = 1.0000e-04
Loss = 1.1013e-01, PNorm = 35.5060, GNorm = 2.8877, lr_0 = 1.0000e-04
Validation rmse = 0.162364
Validation r2 = 0.863851
Epoch 57
Loss = 1.0330e-01, PNorm = 35.5100, GNorm = 1.7859, lr_0 = 1.0000e-04
Validation rmse = 0.167359
Validation r2 = 0.855344
Epoch 58
Loss = 8.4793e-02, PNorm = 35.5139, GNorm = 1.0302, lr_0 = 1.0000e-04
Loss = 1.1123e-01, PNorm = 35.5167, GNorm = 2.8595, lr_0 = 1.0000e-04
Validation rmse = 0.165242
Validation r2 = 0.858981
Epoch 59
Loss = 9.9478e-02, PNorm = 35.5208, GNorm = 0.8880, lr_0 = 1.0000e-04
Validation rmse = 0.167172
Validation r2 = 0.855668
Model 0 best validation rmse = 0.152857 on epoch 18
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.190412
Model 0 test r2 = 0.667836
Ensemble test rmse = 0.190412
Ensemble test r2 = 0.667836
Fold 8
Splitting data with seed 8
Total size = 977 | train size = 781 | val size = 98 | test size = 98
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.2145e-01, PNorm = 34.0173, GNorm = 1.8762, lr_0 = 4.3000e-04
Validation rmse = 0.248404
Validation r2 = 0.311927
Epoch 1
Loss = 8.2923e-01, PNorm = 34.0533, GNorm = 1.6832, lr_0 = 7.6000e-04
Loss = 7.5081e-01, PNorm = 34.1094, GNorm = 10.4854, lr_0 = 9.9472e-04
Validation rmse = 0.220192
Validation r2 = 0.459348
Epoch 2
Loss = 5.9926e-01, PNorm = 34.1785, GNorm = 1.4571, lr_0 = 9.6874e-04
Validation rmse = 0.221739
Validation r2 = 0.451724
Epoch 3
Loss = 4.1681e-01, PNorm = 34.2655, GNorm = 4.6157, lr_0 = 9.4094e-04
Loss = 3.6764e-01, PNorm = 34.3383, GNorm = 3.8513, lr_0 = 9.1637e-04
Validation rmse = 0.202695
Validation r2 = 0.541858
Epoch 4
Loss = 4.2164e-01, PNorm = 34.3971, GNorm = 7.6974, lr_0 = 8.9243e-04
Validation rmse = 0.177798
Validation r2 = 0.647490
Epoch 5
Loss = 1.6815e-01, PNorm = 34.4430, GNorm = 2.6642, lr_0 = 8.6912e-04
Loss = 2.9849e-01, PNorm = 34.4774, GNorm = 0.6153, lr_0 = 8.4642e-04
Validation rmse = 0.161385
Validation r2 = 0.709568
Epoch 6
Loss = 2.8122e-01, PNorm = 34.5279, GNorm = 2.3977, lr_0 = 8.2213e-04
Validation rmse = 0.168356
Validation r2 = 0.683938
Epoch 7
Loss = 2.1058e-01, PNorm = 34.5713, GNorm = 3.4500, lr_0 = 8.0066e-04
Loss = 3.0226e-01, PNorm = 34.5988, GNorm = 2.1110, lr_0 = 7.7975e-04
Validation rmse = 0.230936
Validation r2 = 0.405300
Epoch 8
Loss = 3.4444e-01, PNorm = 34.6365, GNorm = 2.5135, lr_0 = 7.5737e-04
Loss = 3.1394e-01, PNorm = 34.6632, GNorm = 3.6810, lr_0 = 7.3759e-04
Validation rmse = 0.182366
Validation r2 = 0.629145
Epoch 9
Loss = 2.9971e-01, PNorm = 34.6997, GNorm = 2.7721, lr_0 = 7.1833e-04
Validation rmse = 0.164463
Validation r2 = 0.698384
Epoch 10
Loss = 2.9087e-01, PNorm = 34.7347, GNorm = 4.7755, lr_0 = 6.9956e-04
Loss = 2.1861e-01, PNorm = 34.7690, GNorm = 1.9158, lr_0 = 6.8129e-04
Validation rmse = 0.156965
Validation r2 = 0.725259
Epoch 11
Loss = 2.3639e-01, PNorm = 34.8062, GNorm = 2.3764, lr_0 = 6.6174e-04
Validation rmse = 0.168953
Validation r2 = 0.681691
Epoch 12
Loss = 2.1454e-01, PNorm = 34.8323, GNorm = 1.9155, lr_0 = 6.4446e-04
Loss = 2.3420e-01, PNorm = 34.8579, GNorm = 6.4960, lr_0 = 6.2763e-04
Validation rmse = 0.159462
Validation r2 = 0.716449
Epoch 13
Loss = 2.2885e-01, PNorm = 34.8944, GNorm = 1.6169, lr_0 = 6.1123e-04
Validation rmse = 0.154381
Validation r2 = 0.734232
Epoch 14
Loss = 2.0166e-01, PNorm = 34.9168, GNorm = 2.1762, lr_0 = 5.9369e-04
Loss = 2.0536e-01, PNorm = 34.9416, GNorm = 5.4342, lr_0 = 5.7819e-04
Validation rmse = 0.168297
Validation r2 = 0.684159
Epoch 15
Loss = 1.7142e-01, PNorm = 34.9660, GNorm = 1.4301, lr_0 = 5.6309e-04
Validation rmse = 0.148640
Validation r2 = 0.753631
Epoch 16
Loss = 9.9340e-02, PNorm = 34.9934, GNorm = 0.7863, lr_0 = 5.4693e-04
Loss = 2.0120e-01, PNorm = 35.0108, GNorm = 3.3914, lr_0 = 5.3264e-04
Validation rmse = 0.140971
Validation r2 = 0.778396
Epoch 17
Loss = 1.5509e-01, PNorm = 35.0331, GNorm = 1.9929, lr_0 = 5.1873e-04
Loss = 1.6807e-01, PNorm = 35.0549, GNorm = 1.3962, lr_0 = 5.0518e-04
Validation rmse = 0.141210
Validation r2 = 0.777644
Epoch 18
Loss = 1.6089e-01, PNorm = 35.0754, GNorm = 2.0096, lr_0 = 4.9199e-04
Validation rmse = 0.164761
Validation r2 = 0.697292
Epoch 19
Loss = 1.5621e-01, PNorm = 35.1005, GNorm = 3.0736, lr_0 = 4.7787e-04
Loss = 1.7578e-01, PNorm = 35.1199, GNorm = 0.8174, lr_0 = 4.6539e-04
Validation rmse = 0.140508
Validation r2 = 0.779849
Epoch 20
Loss = 1.5507e-01, PNorm = 35.1385, GNorm = 1.3354, lr_0 = 4.5323e-04
Validation rmse = 0.153563
Validation r2 = 0.737040
Epoch 21
Loss = 2.4019e-01, PNorm = 35.1566, GNorm = 1.5985, lr_0 = 4.4140e-04
Loss = 1.5417e-01, PNorm = 35.1696, GNorm = 2.7091, lr_0 = 4.2987e-04
Validation rmse = 0.148922
Validation r2 = 0.752693
Epoch 22
Loss = 1.4532e-01, PNorm = 35.1874, GNorm = 4.0284, lr_0 = 4.1753e-04
Validation rmse = 0.138556
Validation r2 = 0.785924
Epoch 23
Loss = 2.3457e-01, PNorm = 35.2040, GNorm = 2.5889, lr_0 = 4.0663e-04
Loss = 1.4327e-01, PNorm = 35.2199, GNorm = 0.9448, lr_0 = 3.9601e-04
Validation rmse = 0.161687
Validation r2 = 0.708481
Epoch 24
Loss = 1.8820e-01, PNorm = 35.2377, GNorm = 1.1772, lr_0 = 3.8464e-04
Loss = 1.5603e-01, PNorm = 35.2544, GNorm = 2.8652, lr_0 = 3.7460e-04
Validation rmse = 0.137261
Validation r2 = 0.789908
Epoch 25
Loss = 1.4379e-01, PNorm = 35.2680, GNorm = 0.6614, lr_0 = 3.6481e-04
Validation rmse = 0.144843
Validation r2 = 0.766056
Epoch 26
Loss = 1.4557e-01, PNorm = 35.2834, GNorm = 2.5022, lr_0 = 3.5528e-04
Loss = 1.3931e-01, PNorm = 35.2970, GNorm = 0.8172, lr_0 = 3.4600e-04
Validation rmse = 0.142883
Validation r2 = 0.772344
Epoch 27
Loss = 1.3248e-01, PNorm = 35.3135, GNorm = 1.2426, lr_0 = 3.3608e-04
Validation rmse = 0.134665
Validation r2 = 0.797780
Epoch 28
Loss = 1.2053e-01, PNorm = 35.3254, GNorm = 3.0501, lr_0 = 3.2730e-04
Loss = 1.5105e-01, PNorm = 35.3384, GNorm = 1.1325, lr_0 = 3.1875e-04
Validation rmse = 0.134481
Validation r2 = 0.798331
Epoch 29
Loss = 1.4241e-01, PNorm = 35.3511, GNorm = 1.8693, lr_0 = 3.0960e-04
Validation rmse = 0.142446
Validation r2 = 0.773734
Epoch 30
Loss = 1.5299e-01, PNorm = 35.3625, GNorm = 2.1582, lr_0 = 3.0152e-04
Loss = 1.2991e-01, PNorm = 35.3743, GNorm = 1.2895, lr_0 = 2.9364e-04
Validation rmse = 0.135793
Validation r2 = 0.794378
Epoch 31
Loss = 1.2681e-01, PNorm = 35.3841, GNorm = 0.7904, lr_0 = 2.8597e-04
Validation rmse = 0.134067
Validation r2 = 0.799571
Epoch 32
Loss = 1.5985e-01, PNorm = 35.3963, GNorm = 1.9049, lr_0 = 2.7777e-04
Loss = 1.2475e-01, PNorm = 35.4065, GNorm = 0.6686, lr_0 = 2.7051e-04
Validation rmse = 0.134547
Validation r2 = 0.798135
Epoch 33
Loss = 1.1514e-01, PNorm = 35.4152, GNorm = 1.0788, lr_0 = 2.6344e-04
Loss = 1.2944e-01, PNorm = 35.4237, GNorm = 0.9767, lr_0 = 2.5656e-04
Validation rmse = 0.134529
Validation r2 = 0.798188
Epoch 34
Loss = 1.0351e-01, PNorm = 35.4324, GNorm = 0.8876, lr_0 = 2.4986e-04
Validation rmse = 0.134625
Validation r2 = 0.797900
Epoch 35
Loss = 1.3801e-01, PNorm = 35.4427, GNorm = 0.9716, lr_0 = 2.4269e-04
Loss = 1.1334e-01, PNorm = 35.4525, GNorm = 2.5212, lr_0 = 2.3635e-04
Validation rmse = 0.133758
Validation r2 = 0.800494
Epoch 36
Loss = 1.3043e-01, PNorm = 35.4616, GNorm = 1.2608, lr_0 = 2.3018e-04
Validation rmse = 0.134668
Validation r2 = 0.797771
Epoch 37
Loss = 1.1568e-01, PNorm = 35.4702, GNorm = 0.9460, lr_0 = 2.2358e-04
Loss = 1.2235e-01, PNorm = 35.4781, GNorm = 0.8560, lr_0 = 2.1774e-04
Validation rmse = 0.137883
Validation r2 = 0.787998
Epoch 38
Loss = 1.3825e-01, PNorm = 35.4861, GNorm = 0.6192, lr_0 = 2.1205e-04
Validation rmse = 0.132631
Validation r2 = 0.803842
Epoch 39
Loss = 8.9276e-02, PNorm = 35.4925, GNorm = 0.7392, lr_0 = 2.0651e-04
Loss = 1.2705e-01, PNorm = 35.4991, GNorm = 0.9594, lr_0 = 2.0112e-04
Validation rmse = 0.136015
Validation r2 = 0.793703
Epoch 40
Loss = 1.0555e-01, PNorm = 35.5077, GNorm = 1.0437, lr_0 = 1.9535e-04
Loss = 1.2956e-01, PNorm = 35.5148, GNorm = 3.5771, lr_0 = 1.9024e-04
Validation rmse = 0.132269
Validation r2 = 0.804912
Epoch 41
Loss = 1.0846e-01, PNorm = 35.5222, GNorm = 1.2139, lr_0 = 1.8527e-04
Validation rmse = 0.133929
Validation r2 = 0.799985
Epoch 42
Loss = 1.1310e-01, PNorm = 35.5286, GNorm = 1.2291, lr_0 = 1.8044e-04
Loss = 1.2240e-01, PNorm = 35.5367, GNorm = 0.6599, lr_0 = 1.7572e-04
Validation rmse = 0.141623
Validation r2 = 0.776341
Epoch 43
Loss = 1.0269e-01, PNorm = 35.5424, GNorm = 1.8064, lr_0 = 1.7068e-04
Validation rmse = 0.133419
Validation r2 = 0.801505
Epoch 44
Loss = 1.6969e-01, PNorm = 35.5473, GNorm = 2.2883, lr_0 = 1.6622e-04
Loss = 1.1747e-01, PNorm = 35.5559, GNorm = 2.6382, lr_0 = 1.6188e-04
Validation rmse = 0.130931
Validation r2 = 0.808838
Epoch 45
Loss = 1.0298e-01, PNorm = 35.5616, GNorm = 0.8160, lr_0 = 1.5724e-04
Validation rmse = 0.131369
Validation r2 = 0.807558
Epoch 46
Loss = 9.1903e-02, PNorm = 35.5663, GNorm = 1.2589, lr_0 = 1.5313e-04
Loss = 1.0436e-01, PNorm = 35.5712, GNorm = 1.3009, lr_0 = 1.4913e-04
Validation rmse = 0.131832
Validation r2 = 0.806199
Epoch 47
Loss = 1.3666e-01, PNorm = 35.5782, GNorm = 1.1756, lr_0 = 1.4523e-04
Validation rmse = 0.130933
Validation r2 = 0.808832
Epoch 48
Loss = 6.5361e-02, PNorm = 35.5840, GNorm = 1.3934, lr_0 = 1.4107e-04
Loss = 1.1712e-01, PNorm = 35.5889, GNorm = 1.8530, lr_0 = 1.3738e-04
Validation rmse = 0.131425
Validation r2 = 0.807392
Epoch 49
Loss = 1.0640e-01, PNorm = 35.5941, GNorm = 0.8300, lr_0 = 1.3379e-04
Loss = 1.1120e-01, PNorm = 35.5988, GNorm = 1.3424, lr_0 = 1.3030e-04
Validation rmse = 0.133342
Validation r2 = 0.801734
Epoch 50
Loss = 1.0759e-01, PNorm = 35.6044, GNorm = 1.8291, lr_0 = 1.2690e-04
Validation rmse = 0.131017
Validation r2 = 0.808586
Epoch 51
Loss = 1.1399e-01, PNorm = 35.6098, GNorm = 1.6763, lr_0 = 1.2326e-04
Loss = 1.0431e-01, PNorm = 35.6130, GNorm = 2.9593, lr_0 = 1.2004e-04
Validation rmse = 0.131190
Validation r2 = 0.808081
Epoch 52
Loss = 1.1584e-01, PNorm = 35.6195, GNorm = 1.7502, lr_0 = 1.1690e-04
Validation rmse = 0.131231
Validation r2 = 0.807962
Epoch 53
Loss = 1.3524e-01, PNorm = 35.6234, GNorm = 1.7796, lr_0 = 1.1355e-04
Loss = 9.6823e-02, PNorm = 35.6284, GNorm = 0.8644, lr_0 = 1.1058e-04
Validation rmse = 0.131068
Validation r2 = 0.808439
Epoch 54
Loss = 9.6248e-02, PNorm = 35.6324, GNorm = 3.4199, lr_0 = 1.0769e-04
Validation rmse = 0.131295
Validation r2 = 0.807774
Epoch 55
Loss = 7.0585e-02, PNorm = 35.6360, GNorm = 0.8363, lr_0 = 1.0488e-04
Loss = 1.0294e-01, PNorm = 35.6393, GNorm = 1.2642, lr_0 = 1.0214e-04
Validation rmse = 0.131954
Validation r2 = 0.805839
Epoch 56
Loss = 1.0806e-01, PNorm = 35.6441, GNorm = 0.6163, lr_0 = 1.0000e-04
Loss = 1.0591e-01, PNorm = 35.6467, GNorm = 2.6255, lr_0 = 1.0000e-04
Validation rmse = 0.141462
Validation r2 = 0.776852
Epoch 57
Loss = 1.1273e-01, PNorm = 35.6524, GNorm = 2.4742, lr_0 = 1.0000e-04
Validation rmse = 0.132890
Validation r2 = 0.803074
Epoch 58
Loss = 8.4476e-02, PNorm = 35.6563, GNorm = 0.7021, lr_0 = 1.0000e-04
Loss = 1.1374e-01, PNorm = 35.6597, GNorm = 1.4910, lr_0 = 1.0000e-04
Validation rmse = 0.130114
Validation r2 = 0.811216
Epoch 59
Loss = 9.7513e-02, PNorm = 35.6641, GNorm = 1.1959, lr_0 = 1.0000e-04
Validation rmse = 0.131244
Validation r2 = 0.807923
Model 0 best validation rmse = 0.130114 on epoch 58
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.172750
Model 0 test r2 = 0.851815
Ensemble test rmse = 0.172750
Ensemble test r2 = 0.851815
Fold 9
Splitting data with seed 9
Total size = 977 | train size = 781 | val size = 98 | test size = 98
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.7191e-01, PNorm = 34.0150, GNorm = 3.4387, lr_0 = 4.3000e-04
Validation rmse = 0.255393
Validation r2 = 0.231504
Epoch 1
Loss = 6.4482e-01, PNorm = 34.0451, GNorm = 3.6586, lr_0 = 7.6000e-04
Loss = 6.4687e-01, PNorm = 34.1098, GNorm = 2.3164, lr_0 = 9.9472e-04
Validation rmse = 0.221404
Validation r2 = 0.422442
Epoch 2
Loss = 4.3535e-01, PNorm = 34.1926, GNorm = 3.3562, lr_0 = 9.6874e-04
Validation rmse = 0.199337
Validation r2 = 0.531835
Epoch 3
Loss = 2.8759e-01, PNorm = 34.2831, GNorm = 4.8419, lr_0 = 9.4094e-04
Loss = 3.8634e-01, PNorm = 34.3392, GNorm = 2.6169, lr_0 = 9.1637e-04
Validation rmse = 0.209415
Validation r2 = 0.483298
Epoch 4
Loss = 3.8269e-01, PNorm = 34.3925, GNorm = 6.1998, lr_0 = 8.9243e-04
Validation rmse = 0.222275
Validation r2 = 0.417890
Epoch 5
Loss = 3.1786e-01, PNorm = 34.4367, GNorm = 2.9906, lr_0 = 8.6912e-04
Loss = 3.1681e-01, PNorm = 34.4734, GNorm = 3.8280, lr_0 = 8.4642e-04
Validation rmse = 0.184735
Validation r2 = 0.597913
Epoch 6
Loss = 2.5217e-01, PNorm = 34.5205, GNorm = 1.0179, lr_0 = 8.2213e-04
Validation rmse = 0.182102
Validation r2 = 0.609292
Epoch 7
Loss = 3.0164e-01, PNorm = 34.5578, GNorm = 4.1809, lr_0 = 8.0066e-04
Loss = 3.2369e-01, PNorm = 34.5913, GNorm = 3.4239, lr_0 = 7.7975e-04
Validation rmse = 0.176436
Validation r2 = 0.633227
Epoch 8
Loss = 2.6475e-01, PNorm = 34.6294, GNorm = 0.8401, lr_0 = 7.5737e-04
Loss = 2.0860e-01, PNorm = 34.6556, GNorm = 1.7882, lr_0 = 7.3759e-04
Validation rmse = 0.186664
Validation r2 = 0.589470
Epoch 9
Loss = 1.7926e-01, PNorm = 34.6849, GNorm = 0.5129, lr_0 = 7.1833e-04
Validation rmse = 0.172229
Validation r2 = 0.650508
Epoch 10
Loss = 1.8273e-01, PNorm = 34.7179, GNorm = 1.1701, lr_0 = 6.9956e-04
Loss = 2.0597e-01, PNorm = 34.7465, GNorm = 6.3892, lr_0 = 6.8129e-04
Validation rmse = 0.196790
Validation r2 = 0.543722
Epoch 11
Loss = 2.1759e-01, PNorm = 34.7810, GNorm = 1.8061, lr_0 = 6.6174e-04
Validation rmse = 0.186590
Validation r2 = 0.589796
Epoch 12
Loss = 2.5379e-01, PNorm = 34.8151, GNorm = 1.9402, lr_0 = 6.4446e-04
Loss = 1.6170e-01, PNorm = 34.8396, GNorm = 2.3767, lr_0 = 6.2763e-04
Validation rmse = 0.181257
Validation r2 = 0.612908
Epoch 13
Loss = 1.6737e-01, PNorm = 34.8674, GNorm = 0.7324, lr_0 = 6.1123e-04
Validation rmse = 0.179827
Validation r2 = 0.618993
Epoch 14
Loss = 1.5865e-01, PNorm = 34.8999, GNorm = 1.9020, lr_0 = 5.9369e-04
Loss = 1.6479e-01, PNorm = 34.9248, GNorm = 1.6566, lr_0 = 5.7819e-04
Validation rmse = 0.178627
Validation r2 = 0.624060
Epoch 15
Loss = 1.5974e-01, PNorm = 34.9476, GNorm = 0.8370, lr_0 = 5.6309e-04
Validation rmse = 0.170044
Validation r2 = 0.659322
Epoch 16
Loss = 1.3615e-01, PNorm = 34.9724, GNorm = 0.8464, lr_0 = 5.4693e-04
Loss = 1.5707e-01, PNorm = 34.9961, GNorm = 0.3170, lr_0 = 5.3264e-04
Validation rmse = 0.172418
Validation r2 = 0.649743
Epoch 17
Loss = 1.1850e-01, PNorm = 35.0196, GNorm = 1.5280, lr_0 = 5.1873e-04
Loss = 1.5293e-01, PNorm = 35.0400, GNorm = 0.9655, lr_0 = 5.0518e-04
Validation rmse = 0.174032
Validation r2 = 0.643154
Epoch 18
Loss = 1.3427e-01, PNorm = 35.0606, GNorm = 3.3546, lr_0 = 4.9199e-04
Validation rmse = 0.188295
Validation r2 = 0.582267
Epoch 19
Loss = 1.9959e-01, PNorm = 35.0834, GNorm = 3.3466, lr_0 = 4.7787e-04
Loss = 1.3879e-01, PNorm = 35.1077, GNorm = 4.4846, lr_0 = 4.6539e-04
Validation rmse = 0.179907
Validation r2 = 0.618654
Epoch 20
Loss = 1.4545e-01, PNorm = 35.1270, GNorm = 0.9674, lr_0 = 4.5323e-04
Validation rmse = 0.182510
Validation r2 = 0.607539
Epoch 21
Loss = 1.6014e-01, PNorm = 35.1491, GNorm = 5.4511, lr_0 = 4.4140e-04
Loss = 1.7671e-01, PNorm = 35.1666, GNorm = 2.1676, lr_0 = 4.2987e-04
Validation rmse = 0.170913
Validation r2 = 0.655830
Epoch 22
Loss = 1.1856e-01, PNorm = 35.1849, GNorm = 0.8383, lr_0 = 4.1753e-04
Validation rmse = 0.167104
Validation r2 = 0.671001
Epoch 23
Loss = 1.4476e-01, PNorm = 35.2023, GNorm = 1.2734, lr_0 = 4.0663e-04
Loss = 1.3698e-01, PNorm = 35.2250, GNorm = 3.5348, lr_0 = 3.9601e-04
Validation rmse = 0.166710
Validation r2 = 0.672550
Epoch 24
Loss = 1.1633e-01, PNorm = 35.2397, GNorm = 1.9036, lr_0 = 3.8464e-04
Loss = 1.2921e-01, PNorm = 35.2547, GNorm = 1.7416, lr_0 = 3.7460e-04
Validation rmse = 0.179587
Validation r2 = 0.620009
Epoch 25
Loss = 1.1643e-01, PNorm = 35.2708, GNorm = 0.8952, lr_0 = 3.6481e-04
Validation rmse = 0.171764
Validation r2 = 0.652395
Epoch 26
Loss = 1.5370e-01, PNorm = 35.2864, GNorm = 3.1989, lr_0 = 3.5528e-04
Loss = 1.1780e-01, PNorm = 35.2991, GNorm = 0.9684, lr_0 = 3.4600e-04
Validation rmse = 0.165537
Validation r2 = 0.677142
Epoch 27
Loss = 1.3084e-01, PNorm = 35.3130, GNorm = 1.5787, lr_0 = 3.3608e-04
Validation rmse = 0.173063
Validation r2 = 0.647115
Epoch 28
Loss = 8.8422e-02, PNorm = 35.3278, GNorm = 0.7145, lr_0 = 3.2730e-04
Loss = 1.2615e-01, PNorm = 35.3399, GNorm = 0.8764, lr_0 = 3.1875e-04
Validation rmse = 0.176535
Validation r2 = 0.632816
Epoch 29
Loss = 1.2554e-01, PNorm = 35.3520, GNorm = 2.4017, lr_0 = 3.0960e-04
Validation rmse = 0.170303
Validation r2 = 0.658281
Epoch 30
Loss = 1.2116e-01, PNorm = 35.3651, GNorm = 2.5115, lr_0 = 3.0152e-04
Loss = 1.1359e-01, PNorm = 35.3774, GNorm = 2.2936, lr_0 = 2.9364e-04
Validation rmse = 0.171331
Validation r2 = 0.654146
Epoch 31
Loss = 1.0136e-01, PNorm = 35.3874, GNorm = 2.7077, lr_0 = 2.8597e-04
Validation rmse = 0.167093
Validation r2 = 0.671043
Epoch 32
Loss = 7.0257e-02, PNorm = 35.3994, GNorm = 0.5003, lr_0 = 2.7777e-04
Loss = 1.1955e-01, PNorm = 35.4123, GNorm = 1.0366, lr_0 = 2.7051e-04
Validation rmse = 0.169330
Validation r2 = 0.662176
Epoch 33
Loss = 8.3349e-02, PNorm = 35.4214, GNorm = 0.7669, lr_0 = 2.6344e-04
Loss = 1.2656e-01, PNorm = 35.4309, GNorm = 0.6337, lr_0 = 2.5656e-04
Validation rmse = 0.170549
Validation r2 = 0.657293
Epoch 34
Loss = 1.0853e-01, PNorm = 35.4426, GNorm = 2.4705, lr_0 = 2.4986e-04
Validation rmse = 0.166541
Validation r2 = 0.673213
Epoch 35
Loss = 1.0793e-01, PNorm = 35.4513, GNorm = 1.1320, lr_0 = 2.4269e-04
Loss = 9.5139e-02, PNorm = 35.4599, GNorm = 3.0414, lr_0 = 2.3635e-04
Validation rmse = 0.177662
Validation r2 = 0.628112
Epoch 36
Loss = 1.0878e-01, PNorm = 35.4678, GNorm = 2.2572, lr_0 = 2.3018e-04
Validation rmse = 0.179793
Validation r2 = 0.619137
Epoch 37
Loss = 8.6503e-02, PNorm = 35.4778, GNorm = 1.4812, lr_0 = 2.2358e-04
Loss = 1.0621e-01, PNorm = 35.4867, GNorm = 0.6948, lr_0 = 2.1774e-04
Validation rmse = 0.174261
Validation r2 = 0.642213
Epoch 38
Loss = 1.0984e-01, PNorm = 35.4955, GNorm = 1.2533, lr_0 = 2.1205e-04
Validation rmse = 0.168393
Validation r2 = 0.665903
Epoch 39
Loss = 1.0621e-01, PNorm = 35.5044, GNorm = 1.6563, lr_0 = 2.0651e-04
Loss = 9.2787e-02, PNorm = 35.5131, GNorm = 0.7322, lr_0 = 2.0112e-04
Validation rmse = 0.168346
Validation r2 = 0.666092
Epoch 40
Loss = 1.0659e-01, PNorm = 35.5202, GNorm = 1.0987, lr_0 = 1.9535e-04
Loss = 9.4143e-02, PNorm = 35.5281, GNorm = 0.9231, lr_0 = 1.9024e-04
Validation rmse = 0.169554
Validation r2 = 0.661282
Epoch 41
Loss = 1.0269e-01, PNorm = 35.5362, GNorm = 1.8155, lr_0 = 1.8527e-04
Validation rmse = 0.167800
Validation r2 = 0.668251
Epoch 42
Loss = 1.1293e-01, PNorm = 35.5432, GNorm = 0.8422, lr_0 = 1.8044e-04
Loss = 9.7358e-02, PNorm = 35.5505, GNorm = 1.1304, lr_0 = 1.7572e-04
Validation rmse = 0.170825
Validation r2 = 0.656185
Epoch 43
Loss = 9.3461e-02, PNorm = 35.5581, GNorm = 1.0709, lr_0 = 1.7068e-04
Validation rmse = 0.167991
Validation r2 = 0.667498
Epoch 44
Loss = 1.1457e-01, PNorm = 35.5644, GNorm = 3.1559, lr_0 = 1.6622e-04
Loss = 9.0962e-02, PNorm = 35.5703, GNorm = 0.4430, lr_0 = 1.6188e-04
Validation rmse = 0.170813
Validation r2 = 0.656234
Epoch 45
Loss = 1.1626e-01, PNorm = 35.5778, GNorm = 1.4837, lr_0 = 1.5724e-04
Validation rmse = 0.172047
Validation r2 = 0.651247
Epoch 46
Loss = 8.7698e-02, PNorm = 35.5844, GNorm = 0.8091, lr_0 = 1.5313e-04
Loss = 9.9637e-02, PNorm = 35.5891, GNorm = 0.4653, lr_0 = 1.4913e-04
Validation rmse = 0.168014
Validation r2 = 0.667407
Epoch 47
Loss = 9.8553e-02, PNorm = 35.5942, GNorm = 1.2737, lr_0 = 1.4523e-04
Validation rmse = 0.171186
Validation r2 = 0.654731
Epoch 48
Loss = 4.4596e-02, PNorm = 35.6006, GNorm = 0.5904, lr_0 = 1.4107e-04
Loss = 1.0296e-01, PNorm = 35.6067, GNorm = 0.8848, lr_0 = 1.3738e-04
Validation rmse = 0.169038
Validation r2 = 0.663340
Epoch 49
Loss = 1.1118e-01, PNorm = 35.6111, GNorm = 1.4414, lr_0 = 1.3379e-04
Loss = 8.2958e-02, PNorm = 35.6162, GNorm = 1.2352, lr_0 = 1.3030e-04
Validation rmse = 0.168505
Validation r2 = 0.665458
Epoch 50
Loss = 9.6204e-02, PNorm = 35.6214, GNorm = 1.2908, lr_0 = 1.2690e-04
Validation rmse = 0.171540
Validation r2 = 0.653298
Epoch 51
Loss = 8.1982e-02, PNorm = 35.6267, GNorm = 0.9672, lr_0 = 1.2326e-04
Loss = 9.5449e-02, PNorm = 35.6294, GNorm = 1.6843, lr_0 = 1.2004e-04
Validation rmse = 0.177873
Validation r2 = 0.627227
Epoch 52
Loss = 1.0566e-01, PNorm = 35.6374, GNorm = 1.4450, lr_0 = 1.1690e-04
Validation rmse = 0.168645
Validation r2 = 0.664904
Epoch 53
Loss = 8.4525e-02, PNorm = 35.6413, GNorm = 0.5686, lr_0 = 1.1355e-04
Loss = 8.6751e-02, PNorm = 35.6452, GNorm = 2.1429, lr_0 = 1.1058e-04
Validation rmse = 0.171368
Validation r2 = 0.653995
Epoch 54
Loss = 9.3253e-02, PNorm = 35.6488, GNorm = 1.4802, lr_0 = 1.0769e-04
Validation rmse = 0.175085
Validation r2 = 0.638823
Epoch 55
Loss = 1.0201e-01, PNorm = 35.6529, GNorm = 2.4676, lr_0 = 1.0488e-04
Loss = 8.9052e-02, PNorm = 35.6573, GNorm = 1.2520, lr_0 = 1.0214e-04
Validation rmse = 0.172294
Validation r2 = 0.650245
Epoch 56
Loss = 1.0218e-01, PNorm = 35.6620, GNorm = 1.7646, lr_0 = 1.0000e-04
Loss = 8.2934e-02, PNorm = 35.6653, GNorm = 1.7057, lr_0 = 1.0000e-04
Validation rmse = 0.169952
Validation r2 = 0.659687
Epoch 57
Loss = 9.3369e-02, PNorm = 35.6705, GNorm = 1.2226, lr_0 = 1.0000e-04
Validation rmse = 0.167810
Validation r2 = 0.668212
Epoch 58
Loss = 9.2037e-02, PNorm = 35.6743, GNorm = 1.2280, lr_0 = 1.0000e-04
Loss = 8.7305e-02, PNorm = 35.6779, GNorm = 0.5146, lr_0 = 1.0000e-04
Validation rmse = 0.171006
Validation r2 = 0.655454
Epoch 59
Loss = 9.2763e-02, PNorm = 35.6823, GNorm = 1.3719, lr_0 = 1.0000e-04
Validation rmse = 0.167154
Validation r2 = 0.670804
Model 0 best validation rmse = 0.165537 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.163030
Model 0 test r2 = 0.748632
Ensemble test rmse = 0.163030
Ensemble test r2 = 0.748632
10-fold cross validation
	Seed 0 ==> test rmse = 0.155780
	Seed 0 ==> test r2 = 0.879623
	Seed 1 ==> test rmse = 0.246058
	Seed 1 ==> test r2 = 0.673945
	Seed 2 ==> test rmse = 0.186278
	Seed 2 ==> test r2 = 0.775048
	Seed 3 ==> test rmse = 0.284979
	Seed 3 ==> test r2 = 0.615975
	Seed 4 ==> test rmse = 0.157928
	Seed 4 ==> test r2 = 0.873713
	Seed 5 ==> test rmse = 0.167332
	Seed 5 ==> test r2 = 0.784566
	Seed 6 ==> test rmse = 0.151179
	Seed 6 ==> test r2 = 0.849586
	Seed 7 ==> test rmse = 0.190412
	Seed 7 ==> test r2 = 0.667836
	Seed 8 ==> test rmse = 0.172750
	Seed 8 ==> test r2 = 0.851815
	Seed 9 ==> test rmse = 0.163030
	Seed 9 ==> test r2 = 0.748632
Overall test rmse = 0.187573 +/- 0.041670
Overall test r2 = 0.772074 +/- 0.089353
Elapsed time = 0:05:44
