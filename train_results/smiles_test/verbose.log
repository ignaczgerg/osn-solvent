Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/bin/chemprop_train --data_path ./data/train_dm300_full.csv --dataset_type regression --save_dir ./train_results/smiles_test/ --quiet --smiles_columns solute_smiles --target_columns dm300
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 30,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './train_results/smiles_test/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['solute_smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,170 | train size = 936 | val size = 117 | test size = 117
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.7187e-01, PNorm = 34.0123, GNorm = 6.9063, lr_0 = 3.7500e-04
Validation rmse = 0.325765
Epoch 1
Loss = 1.0306e+00, PNorm = 34.0206, GNorm = 4.1509, lr_0 = 6.5000e-04
Loss = 8.0608e-01, PNorm = 34.0427, GNorm = 2.6161, lr_0 = 9.0000e-04
Validation rmse = 0.314332
Epoch 2
Loss = 8.6847e-01, PNorm = 34.0838, GNorm = 1.4222, lr_0 = 9.7296e-04
Loss = 7.0210e-01, PNorm = 34.1254, GNorm = 1.1226, lr_0 = 9.2951e-04
Validation rmse = 0.334822
Epoch 3
Loss = 7.6312e-01, PNorm = 34.1519, GNorm = 1.9784, lr_0 = 8.8800e-04
Loss = 7.7069e-01, PNorm = 34.1767, GNorm = 2.5216, lr_0 = 8.4834e-04
Validation rmse = 0.307646
Epoch 4
Loss = 7.7074e-01, PNorm = 34.2103, GNorm = 2.4335, lr_0 = 8.0676e-04
Loss = 6.4471e-01, PNorm = 34.2373, GNorm = 1.8499, lr_0 = 7.7073e-04
Validation rmse = 0.308830
Epoch 5
Loss = 6.5224e-01, PNorm = 34.2606, GNorm = 1.8890, lr_0 = 7.3631e-04
Loss = 6.6721e-01, PNorm = 34.2872, GNorm = 3.0141, lr_0 = 7.0343e-04
Validation rmse = 0.303985
Epoch 6
Loss = 6.1312e-01, PNorm = 34.3131, GNorm = 4.2821, lr_0 = 6.7202e-04
Loss = 7.1709e-01, PNorm = 34.3389, GNorm = 3.6007, lr_0 = 6.4201e-04
Validation rmse = 0.299574
Epoch 7
Loss = 6.6896e-01, PNorm = 34.3610, GNorm = 5.1538, lr_0 = 6.1334e-04
Validation rmse = 0.299354
Epoch 8
Loss = 5.0418e-01, PNorm = 34.3887, GNorm = 7.2465, lr_0 = 5.8327e-04
Loss = 6.5548e-01, PNorm = 34.4153, GNorm = 0.9280, lr_0 = 5.5723e-04
Validation rmse = 0.303982
Epoch 9
Loss = 6.6173e-01, PNorm = 34.4379, GNorm = 1.9032, lr_0 = 5.3234e-04
Loss = 6.3084e-01, PNorm = 34.4583, GNorm = 1.9853, lr_0 = 5.0857e-04
Validation rmse = 0.338393
Epoch 10
Loss = 6.6730e-01, PNorm = 34.4787, GNorm = 4.6376, lr_0 = 4.8586e-04
Loss = 6.0533e-01, PNorm = 34.4969, GNorm = 1.7459, lr_0 = 4.6416e-04
Validation rmse = 0.290365
Epoch 11
Loss = 5.7950e-01, PNorm = 34.5153, GNorm = 5.9427, lr_0 = 4.4141e-04
Loss = 6.2572e-01, PNorm = 34.5388, GNorm = 3.7740, lr_0 = 4.2170e-04
Validation rmse = 0.292671
Epoch 12
Loss = 5.2761e-01, PNorm = 34.5527, GNorm = 4.7743, lr_0 = 4.0286e-04
Loss = 6.9999e-01, PNorm = 34.5682, GNorm = 5.0171, lr_0 = 3.8487e-04
Validation rmse = 0.293918
Epoch 13
Loss = 6.1160e-01, PNorm = 34.5856, GNorm = 2.6570, lr_0 = 3.6769e-04
Loss = 6.2027e-01, PNorm = 34.5966, GNorm = 3.2550, lr_0 = 3.5127e-04
Validation rmse = 0.293758
Epoch 14
Loss = 6.2519e-01, PNorm = 34.6133, GNorm = 2.9941, lr_0 = 3.3558e-04
Loss = 6.1500e-01, PNorm = 34.6313, GNorm = 1.2780, lr_0 = 3.2059e-04
Loss = 4.1241e-01, PNorm = 34.6326, GNorm = 5.8628, lr_0 = 3.1913e-04
Validation rmse = 0.294310
Epoch 15
Loss = 6.0747e-01, PNorm = 34.6401, GNorm = 4.9661, lr_0 = 3.0488e-04
Validation rmse = 0.294129
Epoch 16
Loss = 9.3949e-01, PNorm = 34.6548, GNorm = 3.9982, lr_0 = 2.9126e-04
Loss = 5.5985e-01, PNorm = 34.6694, GNorm = 0.9673, lr_0 = 2.7826e-04
Validation rmse = 0.287573
Epoch 17
Loss = 5.1707e-01, PNorm = 34.6826, GNorm = 3.9548, lr_0 = 2.6583e-04
Loss = 5.9129e-01, PNorm = 34.6908, GNorm = 1.6517, lr_0 = 2.5396e-04
Validation rmse = 0.299559
Epoch 18
Loss = 6.5239e-01, PNorm = 34.7021, GNorm = 4.3804, lr_0 = 2.4151e-04
Loss = 5.6316e-01, PNorm = 34.7146, GNorm = 1.1463, lr_0 = 2.3073e-04
Validation rmse = 0.289490
Epoch 19
Loss = 6.0363e-01, PNorm = 34.7208, GNorm = 2.3014, lr_0 = 2.2042e-04
Loss = 6.0615e-01, PNorm = 34.7312, GNorm = 3.1775, lr_0 = 2.1058e-04
Validation rmse = 0.292674
Epoch 20
Loss = 6.2306e-01, PNorm = 34.7400, GNorm = 2.0871, lr_0 = 2.0117e-04
Loss = 5.3715e-01, PNorm = 34.7478, GNorm = 1.7345, lr_0 = 1.9219e-04
Validation rmse = 0.300419
Epoch 21
Loss = 5.2645e-01, PNorm = 34.7544, GNorm = 3.0028, lr_0 = 1.8361e-04
Loss = 6.3454e-01, PNorm = 34.7634, GNorm = 2.7870, lr_0 = 1.7541e-04
Validation rmse = 0.288003
Epoch 22
Loss = 5.3416e-01, PNorm = 34.7754, GNorm = 1.8790, lr_0 = 1.6681e-04
Loss = 6.0911e-01, PNorm = 34.7795, GNorm = 1.3870, lr_0 = 1.5936e-04
Validation rmse = 0.288441
Epoch 23
Loss = 6.2392e-01, PNorm = 34.7867, GNorm = 2.8783, lr_0 = 1.5224e-04
Validation rmse = 0.288067
Epoch 24
Loss = 5.3008e-01, PNorm = 34.7933, GNorm = 0.9935, lr_0 = 1.4544e-04
Loss = 5.8474e-01, PNorm = 34.8022, GNorm = 1.5633, lr_0 = 1.3895e-04
Validation rmse = 0.289933
Epoch 25
Loss = 4.2075e-01, PNorm = 34.8079, GNorm = 3.2971, lr_0 = 1.3274e-04
Loss = 5.8646e-01, PNorm = 34.8134, GNorm = 3.3598, lr_0 = 1.2682e-04
Validation rmse = 0.289358
Epoch 26
Loss = 5.7147e-01, PNorm = 34.8190, GNorm = 2.5259, lr_0 = 1.2060e-04
Loss = 5.9547e-01, PNorm = 34.8238, GNorm = 2.0228, lr_0 = 1.1521e-04
Validation rmse = 0.289319
Epoch 27
Loss = 5.4273e-01, PNorm = 34.8280, GNorm = 4.4688, lr_0 = 1.1007e-04
Loss = 6.0231e-01, PNorm = 34.8325, GNorm = 1.3815, lr_0 = 1.0515e-04
Validation rmse = 0.286723
Epoch 28
Loss = 5.6914e-01, PNorm = 34.8394, GNorm = 5.4637, lr_0 = 1.0046e-04
Loss = 6.1016e-01, PNorm = 34.8440, GNorm = 2.9955, lr_0 = 1.0000e-04
Validation rmse = 0.287054
Epoch 29
Loss = 5.7555e-01, PNorm = 34.8487, GNorm = 1.0117, lr_0 = 1.0000e-04
Loss = 5.5626e-01, PNorm = 34.8536, GNorm = 3.3557, lr_0 = 1.0000e-04
Validation rmse = 0.289404
Model 0 best validation rmse = 0.286723 on epoch 27
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.254326
Ensemble test rmse = 0.254326
1-fold cross validation
	Seed 0 ==> test rmse = 0.254326
Overall test rmse = 0.254326 +/- 0.000000
Elapsed time = 0:00:17
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/bin/chemprop_train --data_path ./data/train_dm300_reduced_meoh.csv --dataset_type regression --save_dir ./train_results/smiles_test/ --quiet --smiles_columns full_smiles --target_columns dm300 --epochs 60
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/train_dm300_reduced_meoh.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './train_results/smiles_test/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,081 | train size = 864 | val size = 108 | test size = 109
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.0025e+00, PNorm = 34.0165, GNorm = 1.9060, lr_0 = 3.9118e-04
Validation rmse = 0.282909
Epoch 1
Loss = 7.5041e-01, PNorm = 34.0408, GNorm = 7.7764, lr_0 = 6.8235e-04
Loss = 6.4612e-01, PNorm = 34.0871, GNorm = 12.1670, lr_0 = 9.4706e-04
Validation rmse = 0.223949
Epoch 2
Loss = 4.7623e-01, PNorm = 34.1634, GNorm = 0.9150, lr_0 = 9.7920e-04
Loss = 4.5796e-01, PNorm = 34.2322, GNorm = 7.5490, lr_0 = 9.5660e-04
Validation rmse = 0.199466
Epoch 3
Loss = 4.1485e-01, PNorm = 34.3033, GNorm = 5.8427, lr_0 = 9.3234e-04
Validation rmse = 0.163956
Epoch 4
Loss = 3.5407e-01, PNorm = 34.3662, GNorm = 1.3724, lr_0 = 9.1082e-04
Loss = 3.2507e-01, PNorm = 34.4198, GNorm = 4.9996, lr_0 = 8.8980e-04
Validation rmse = 0.155461
Epoch 5
Loss = 2.9312e-01, PNorm = 34.4762, GNorm = 4.1132, lr_0 = 8.6723e-04
Loss = 2.6561e-01, PNorm = 34.5340, GNorm = 6.0176, lr_0 = 8.4721e-04
Validation rmse = 0.167107
Epoch 6
Loss = 2.3203e-01, PNorm = 34.5790, GNorm = 2.4840, lr_0 = 8.2573e-04
Loss = 2.1901e-01, PNorm = 34.6187, GNorm = 2.9893, lr_0 = 8.0667e-04
Loss = 1.8370e-01, PNorm = 34.6214, GNorm = 1.5172, lr_0 = 8.0478e-04
Validation rmse = 0.169860
Epoch 7
Loss = 2.5324e-01, PNorm = 34.6502, GNorm = 1.4051, lr_0 = 7.8621e-04
Validation rmse = 0.177226
Epoch 8
Loss = 1.9210e-01, PNorm = 34.6893, GNorm = 0.9544, lr_0 = 7.6806e-04
Loss = 2.3307e-01, PNorm = 34.7301, GNorm = 6.6667, lr_0 = 7.5033e-04
Validation rmse = 0.142457
Epoch 9
Loss = 2.0881e-01, PNorm = 34.7561, GNorm = 4.9062, lr_0 = 7.3130e-04
Loss = 2.1026e-01, PNorm = 34.7866, GNorm = 1.6363, lr_0 = 7.1442e-04
Validation rmse = 0.170332
Epoch 10
Loss = 1.7046e-01, PNorm = 34.8136, GNorm = 4.0789, lr_0 = 6.9630e-04
Loss = 1.9651e-01, PNorm = 34.8447, GNorm = 2.6645, lr_0 = 6.8023e-04
Validation rmse = 0.150960
Epoch 11
Loss = 1.6912e-01, PNorm = 34.8694, GNorm = 2.0308, lr_0 = 6.6453e-04
Validation rmse = 0.133734
Epoch 12
Loss = 1.7012e-01, PNorm = 34.8966, GNorm = 0.8413, lr_0 = 6.4768e-04
Loss = 1.5053e-01, PNorm = 34.9183, GNorm = 4.5523, lr_0 = 6.3273e-04
Validation rmse = 0.129300
Epoch 13
Loss = 1.4891e-01, PNorm = 34.9373, GNorm = 1.5776, lr_0 = 6.1668e-04
Loss = 1.3872e-01, PNorm = 34.9537, GNorm = 1.6181, lr_0 = 6.0245e-04
Validation rmse = 0.146934
Epoch 14
Loss = 1.3140e-01, PNorm = 34.9665, GNorm = 1.6373, lr_0 = 5.8717e-04
Validation rmse = 0.142497
Epoch 15
Loss = 1.7107e-01, PNorm = 34.9854, GNorm = 1.0398, lr_0 = 5.7362e-04
Loss = 1.3407e-01, PNorm = 35.0045, GNorm = 1.0555, lr_0 = 5.6037e-04
Validation rmse = 0.133987
Epoch 16
Loss = 1.2645e-01, PNorm = 35.0236, GNorm = 1.1134, lr_0 = 5.4616e-04
Loss = 1.5047e-01, PNorm = 35.0426, GNorm = 0.8570, lr_0 = 5.3356e-04
Validation rmse = 0.143857
Epoch 17
Loss = 1.1916e-01, PNorm = 35.0549, GNorm = 1.2474, lr_0 = 5.2003e-04
Loss = 1.5274e-01, PNorm = 35.0695, GNorm = 2.8331, lr_0 = 5.0802e-04
Validation rmse = 0.142891
Epoch 18
Loss = 1.3915e-01, PNorm = 35.0869, GNorm = 4.7971, lr_0 = 4.9630e-04
Validation rmse = 0.134070
Epoch 19
Loss = 1.2038e-01, PNorm = 35.0996, GNorm = 3.0491, lr_0 = 4.8371e-04
Loss = 1.2929e-01, PNorm = 35.1109, GNorm = 1.2342, lr_0 = 4.7254e-04
Validation rmse = 0.136678
Epoch 20
Loss = 1.2442e-01, PNorm = 35.1291, GNorm = 0.8782, lr_0 = 4.6056e-04
Loss = 1.4146e-01, PNorm = 35.1428, GNorm = 2.3909, lr_0 = 4.4993e-04
Validation rmse = 0.141340
Epoch 21
Loss = 1.3617e-01, PNorm = 35.1580, GNorm = 1.2887, lr_0 = 4.3852e-04
Loss = 1.0294e-01, PNorm = 35.1690, GNorm = 1.5194, lr_0 = 4.2840e-04
Validation rmse = 0.134221
Epoch 22
Loss = 1.2030e-01, PNorm = 35.1793, GNorm = 1.8993, lr_0 = 4.1851e-04
Validation rmse = 0.159080
Epoch 23
Loss = 1.4366e-01, PNorm = 35.1932, GNorm = 0.7108, lr_0 = 4.0789e-04
Loss = 1.2891e-01, PNorm = 35.2046, GNorm = 0.8585, lr_0 = 3.9848e-04
Validation rmse = 0.142148
Epoch 24
Loss = 1.1321e-01, PNorm = 35.2140, GNorm = 1.6655, lr_0 = 3.8837e-04
Loss = 1.2754e-01, PNorm = 35.2240, GNorm = 2.8540, lr_0 = 3.7941e-04
Validation rmse = 0.173321
Epoch 25
Loss = 1.2779e-01, PNorm = 35.2369, GNorm = 0.9789, lr_0 = 3.7065e-04
Validation rmse = 0.141673
Epoch 26
Loss = 7.1834e-02, PNorm = 35.2484, GNorm = 1.8219, lr_0 = 3.6125e-04
Loss = 1.2657e-01, PNorm = 35.2608, GNorm = 2.8221, lr_0 = 3.5291e-04
Validation rmse = 0.154864
Epoch 27
Loss = 1.6041e-01, PNorm = 35.2714, GNorm = 4.6510, lr_0 = 3.4396e-04
Loss = 1.5653e-01, PNorm = 35.2856, GNorm = 3.4696, lr_0 = 3.3602e-04
Validation rmse = 0.136948
Epoch 28
Loss = 1.1024e-01, PNorm = 35.2967, GNorm = 1.8160, lr_0 = 3.2750e-04
Loss = 1.3339e-01, PNorm = 35.3078, GNorm = 1.2727, lr_0 = 3.1994e-04
Validation rmse = 0.136909
Epoch 29
Loss = 9.3831e-02, PNorm = 35.3172, GNorm = 0.5698, lr_0 = 3.1256e-04
Validation rmse = 0.133585
Epoch 30
Loss = 5.9927e-02, PNorm = 35.3261, GNorm = 1.1004, lr_0 = 3.0463e-04
Loss = 1.1695e-01, PNorm = 35.3334, GNorm = 1.3754, lr_0 = 2.9760e-04
Validation rmse = 0.151635
Epoch 31
Loss = 1.0251e-01, PNorm = 35.3424, GNorm = 1.1940, lr_0 = 2.9005e-04
Loss = 1.0692e-01, PNorm = 35.3501, GNorm = 3.0768, lr_0 = 2.8336e-04
Validation rmse = 0.159233
Epoch 32
Loss = 1.2697e-01, PNorm = 35.3620, GNorm = 1.9201, lr_0 = 2.7617e-04
Loss = 1.0487e-01, PNorm = 35.3704, GNorm = 2.2862, lr_0 = 2.6980e-04
Validation rmse = 0.131201
Epoch 33
Loss = 1.1089e-01, PNorm = 35.3774, GNorm = 1.3965, lr_0 = 2.6357e-04
Validation rmse = 0.139500
Epoch 34
Loss = 1.2369e-01, PNorm = 35.3848, GNorm = 1.1169, lr_0 = 2.5688e-04
Loss = 1.0279e-01, PNorm = 35.3923, GNorm = 0.7397, lr_0 = 2.5095e-04
Validation rmse = 0.136709
Epoch 35
Loss = 1.1522e-01, PNorm = 35.3985, GNorm = 0.7892, lr_0 = 2.4459e-04
Loss = 9.2626e-02, PNorm = 35.4043, GNorm = 1.0813, lr_0 = 2.3894e-04
Validation rmse = 0.152427
Epoch 36
Loss = 1.3354e-01, PNorm = 35.4122, GNorm = 3.6079, lr_0 = 2.3343e-04
Validation rmse = 0.131375
Epoch 37
Loss = 1.5874e-01, PNorm = 35.4198, GNorm = 2.2973, lr_0 = 2.2751e-04
Loss = 1.1832e-01, PNorm = 35.4289, GNorm = 0.9567, lr_0 = 2.2226e-04
Validation rmse = 0.148497
Epoch 38
Loss = 9.8548e-02, PNorm = 35.4380, GNorm = 2.3566, lr_0 = 2.1662e-04
Loss = 1.1138e-01, PNorm = 35.4425, GNorm = 1.1854, lr_0 = 2.1162e-04
Validation rmse = 0.130512
Epoch 39
Loss = 1.1241e-01, PNorm = 35.4528, GNorm = 1.5552, lr_0 = 2.0625e-04
Loss = 1.0011e-01, PNorm = 35.4580, GNorm = 1.2676, lr_0 = 2.0149e-04
Validation rmse = 0.130798
Epoch 40
Loss = 9.6521e-02, PNorm = 35.4624, GNorm = 1.1743, lr_0 = 1.9684e-04
Validation rmse = 0.144871
Epoch 41
Loss = 9.1897e-02, PNorm = 35.4681, GNorm = 0.7695, lr_0 = 1.9185e-04
Loss = 1.0742e-01, PNorm = 35.4731, GNorm = 1.9380, lr_0 = 1.8742e-04
Validation rmse = 0.136846
Epoch 42
Loss = 8.1758e-02, PNorm = 35.4786, GNorm = 0.8068, lr_0 = 1.8267e-04
Loss = 1.0393e-01, PNorm = 35.4831, GNorm = 0.5897, lr_0 = 1.7845e-04
Validation rmse = 0.139024
Epoch 43
Loss = 9.1405e-02, PNorm = 35.4899, GNorm = 0.7004, lr_0 = 1.7433e-04
Loss = 1.0511e-01, PNorm = 35.4960, GNorm = 1.9289, lr_0 = 1.7031e-04
Loss = 2.4849e-01, PNorm = 35.4970, GNorm = 3.8480, lr_0 = 1.6991e-04
Validation rmse = 0.130085
Epoch 44
Loss = 1.0554e-01, PNorm = 35.5022, GNorm = 1.6832, lr_0 = 1.6599e-04
Validation rmse = 0.138820
Epoch 45
Loss = 1.0582e-01, PNorm = 35.5084, GNorm = 3.3993, lr_0 = 1.6178e-04
Loss = 1.0581e-01, PNorm = 35.5133, GNorm = 3.2034, lr_0 = 1.5805e-04
Validation rmse = 0.144540
Epoch 46
Loss = 1.0575e-01, PNorm = 35.5200, GNorm = 3.3497, lr_0 = 1.5404e-04
Loss = 1.0581e-01, PNorm = 35.5247, GNorm = 1.5562, lr_0 = 1.5048e-04
Validation rmse = 0.135710
Epoch 47
Loss = 1.0657e-01, PNorm = 35.5300, GNorm = 1.3707, lr_0 = 1.4701e-04
Validation rmse = 0.141453
Epoch 48
Loss = 7.6312e-02, PNorm = 35.5358, GNorm = 0.9402, lr_0 = 1.4328e-04
Loss = 1.1061e-01, PNorm = 35.5399, GNorm = 2.7085, lr_0 = 1.3997e-04
Validation rmse = 0.128629
Epoch 49
Loss = 9.8947e-02, PNorm = 35.5441, GNorm = 1.1260, lr_0 = 1.3642e-04
Loss = 1.0739e-01, PNorm = 35.5491, GNorm = 1.3941, lr_0 = 1.3327e-04
Validation rmse = 0.138717
Epoch 50
Loss = 9.5956e-02, PNorm = 35.5522, GNorm = 0.6025, lr_0 = 1.3020e-04
Loss = 1.0043e-01, PNorm = 35.5554, GNorm = 1.1010, lr_0 = 1.2719e-04
Validation rmse = 0.146528
Epoch 51
Loss = 1.1558e-01, PNorm = 35.5607, GNorm = 1.7611, lr_0 = 1.2397e-04
Validation rmse = 0.137873
Epoch 52
Loss = 1.4048e-01, PNorm = 35.5646, GNorm = 1.7869, lr_0 = 1.2082e-04
Loss = 8.5374e-02, PNorm = 35.5683, GNorm = 0.6701, lr_0 = 1.1803e-04
Validation rmse = 0.129386
Epoch 53
Loss = 1.0189e-01, PNorm = 35.5721, GNorm = 0.7360, lr_0 = 1.1504e-04
Loss = 1.0501e-01, PNorm = 35.5773, GNorm = 1.7279, lr_0 = 1.1239e-04
Validation rmse = 0.136991
Epoch 54
Loss = 1.0248e-01, PNorm = 35.5790, GNorm = 1.4864, lr_0 = 1.0979e-04
Loss = 9.1530e-02, PNorm = 35.5822, GNorm = 0.5457, lr_0 = 1.0726e-04
Loss = 6.1278e-02, PNorm = 35.5822, GNorm = 0.9999, lr_0 = 1.0701e-04
Validation rmse = 0.138383
Epoch 55
Loss = 8.9665e-02, PNorm = 35.5856, GNorm = 1.0823, lr_0 = 1.0454e-04
Validation rmse = 0.135510
Epoch 56
Loss = 9.2821e-02, PNorm = 35.5890, GNorm = 1.3960, lr_0 = 1.0189e-04
Loss = 9.5588e-02, PNorm = 35.5922, GNorm = 2.3928, lr_0 = 1.0000e-04
Validation rmse = 0.132814
Epoch 57
Loss = 9.3277e-02, PNorm = 35.5952, GNorm = 1.1101, lr_0 = 1.0000e-04
Loss = 9.4630e-02, PNorm = 35.5980, GNorm = 0.7291, lr_0 = 1.0000e-04
Validation rmse = 0.137362
Epoch 58
Loss = 9.4821e-02, PNorm = 35.6017, GNorm = 0.5619, lr_0 = 1.0000e-04
Validation rmse = 0.138244
Epoch 59
Loss = 8.3265e-02, PNorm = 35.6049, GNorm = 1.1360, lr_0 = 1.0000e-04
Loss = 9.7788e-02, PNorm = 35.6084, GNorm = 1.6220, lr_0 = 1.0000e-04
Validation rmse = 0.133183
Model 0 best validation rmse = 0.128629 on epoch 48
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.133197
Ensemble test rmse = 0.133197
1-fold cross validation
	Seed 0 ==> test rmse = 0.133197
Overall test rmse = 0.133197 +/- 0.000000
Elapsed time = 0:00:39
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/bin/chemprop_train --data_path ./data/train_dm300_reduced_meoh.csv --dataset_type regression --save_dir ./train_results/smiles_test/ --quiet --smiles_columns full_smiles --target_columns dm300 --epochs 60 --separate_test_path ./data/cosn_2.csv
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/train_dm300_reduced_meoh.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './train_results/smiles_test/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/cosn_2.csv',
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/bin/chemprop_train --data_path ./data/train_dm300_reduced_meoh.csv --dataset_type regression --save_dir ./train_results/smiles_test/ --quiet --smiles_columns full_smiles --target_columns dm300 --epochs 60 --separate_test_path ./data/cosn_2.csv
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/train_dm300_reduced_meoh.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './train_results/smiles_test/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/cosn_2.csv',
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,081 | train size = 864 | val size = 217 | test size = 109
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.0025e+00, PNorm = 34.0165, GNorm = 1.9060, lr_0 = 3.9118e-04
Validation rmse = 0.298174
Epoch 1
Loss = 7.5041e-01, PNorm = 34.0408, GNorm = 7.7764, lr_0 = 6.8235e-04
Loss = 6.4612e-01, PNorm = 34.0871, GNorm = 12.1670, lr_0 = 9.4706e-04
Validation rmse = 0.239527
Epoch 2
Loss = 4.7623e-01, PNorm = 34.1634, GNorm = 0.9150, lr_0 = 9.7920e-04
Loss = 4.5796e-01, PNorm = 34.2322, GNorm = 7.5490, lr_0 = 9.5660e-04
Validation rmse = 0.210992
Epoch 3
Loss = 4.1485e-01, PNorm = 34.3033, GNorm = 5.8426, lr_0 = 9.3234e-04
Validation rmse = 0.176943
Epoch 4
Loss = 3.5407e-01, PNorm = 34.3662, GNorm = 1.3710, lr_0 = 9.1082e-04
Loss = 3.2509e-01, PNorm = 34.4199, GNorm = 5.0119, lr_0 = 8.8980e-04
Validation rmse = 0.167849
Epoch 5
Loss = 2.9302e-01, PNorm = 34.4762, GNorm = 4.1223, lr_0 = 8.6723e-04
Loss = 2.6540e-01, PNorm = 34.5342, GNorm = 6.0018, lr_0 = 8.4721e-04
Validation rmse = 0.166115
Epoch 6
Loss = 2.3181e-01, PNorm = 34.5793, GNorm = 2.4323, lr_0 = 8.2573e-04
Loss = 2.2002e-01, PNorm = 34.6185, GNorm = 2.8366, lr_0 = 8.0667e-04
Loss = 1.8285e-01, PNorm = 34.6212, GNorm = 1.5132, lr_0 = 8.0478e-04
Validation rmse = 0.163129
Epoch 7
Loss = 2.5649e-01, PNorm = 34.6495, GNorm = 1.1096, lr_0 = 7.8621e-04
Validation rmse = 0.172930
Epoch 8
Loss = 1.9593e-01, PNorm = 34.6891, GNorm = 1.2551, lr_0 = 7.6806e-04
Loss = 2.3525e-01, PNorm = 34.7318, GNorm = 6.8181, lr_0 = 7.5033e-04
Validation rmse = 0.156885
Epoch 9
Loss = 2.0801e-01, PNorm = 34.7578, GNorm = 4.8143, lr_0 = 7.3130e-04
Loss = 2.0883e-01, PNorm = 34.7884, GNorm = 0.9571, lr_0 = 7.1442e-04
Validation rmse = 0.159895
Epoch 10
Loss = 1.6659e-01, PNorm = 34.8166, GNorm = 3.7684, lr_0 = 6.9630e-04
Loss = 1.9577e-01, PNorm = 34.8474, GNorm = 2.9185, lr_0 = 6.8023e-04
Validation rmse = 0.152429
Epoch 11
Loss = 1.6953e-01, PNorm = 34.8708, GNorm = 1.6056, lr_0 = 6.6453e-04
Validation rmse = 0.135851
Epoch 12
Loss = 1.7041e-01, PNorm = 34.8989, GNorm = 0.7602, lr_0 = 6.4768e-04
Loss = 1.5292e-01, PNorm = 34.9207, GNorm = 4.6741, lr_0 = 6.3273e-04
Validation rmse = 0.134731
Epoch 13
Loss = 1.4987e-01, PNorm = 34.9404, GNorm = 1.5950, lr_0 = 6.1668e-04
Loss = 1.3873e-01, PNorm = 34.9574, GNorm = 1.7088, lr_0 = 6.0245e-04
Validation rmse = 0.140695
Epoch 14
Loss = 1.3137e-01, PNorm = 34.9709, GNorm = 1.7163, lr_0 = 5.8717e-04
Validation rmse = 0.139229
Epoch 15
Loss = 1.6886e-01, PNorm = 34.9893, GNorm = 1.0620, lr_0 = 5.7362e-04
Loss = 1.3454e-01, PNorm = 35.0081, GNorm = 1.1369, lr_0 = 5.6037e-04
Validation rmse = 0.131905
Epoch 16
Loss = 1.2682e-01, PNorm = 35.0277, GNorm = 0.9420, lr_0 = 5.4616e-04
Loss = 1.5099e-01, PNorm = 35.0463, GNorm = 0.9187, lr_0 = 5.3356e-04
Validation rmse = 0.137513
Epoch 17
Loss = 1.1745e-01, PNorm = 35.0597, GNorm = 1.2755, lr_0 = 5.2003e-04
Loss = 1.5208e-01, PNorm = 35.0732, GNorm = 2.5347, lr_0 = 5.0802e-04
Validation rmse = 0.137489
Epoch 18
Loss = 1.3860e-01, PNorm = 35.0896, GNorm = 4.7612, lr_0 = 4.9630e-04
Validation rmse = 0.135371
Epoch 19
Loss = 1.2269e-01, PNorm = 35.1020, GNorm = 3.1798, lr_0 = 4.8371e-04
Loss = 1.3034e-01, PNorm = 35.1136, GNorm = 1.1744, lr_0 = 4.7254e-04
Validation rmse = 0.133117
Epoch 20
Loss = 1.2461e-01, PNorm = 35.1321, GNorm = 0.8271, lr_0 = 4.6056e-04
Loss = 1.4153e-01, PNorm = 35.1458, GNorm = 2.3301, lr_0 = 4.4993e-04
Validation rmse = 0.138372
Epoch 21
Loss = 1.3625e-01, PNorm = 35.1618, GNorm = 1.1505, lr_0 = 4.3852e-04
Loss = 1.0317e-01, PNorm = 35.1736, GNorm = 1.5459, lr_0 = 4.2840e-04
Validation rmse = 0.131411
Epoch 22
Loss = 1.2017e-01, PNorm = 35.1842, GNorm = 1.8450, lr_0 = 4.1851e-04
Validation rmse = 0.151148
Epoch 23
Loss = 1.4378e-01, PNorm = 35.1988, GNorm = 0.6892, lr_0 = 4.0789e-04
Loss = 1.2900e-01, PNorm = 35.2101, GNorm = 0.8347, lr_0 = 3.9848e-04
Validation rmse = 0.139655
Epoch 24
Loss = 1.1486e-01, PNorm = 35.2194, GNorm = 1.5367, lr_0 = 3.8837e-04
Loss = 1.2670e-01, PNorm = 35.2294, GNorm = 2.6961, lr_0 = 3.7941e-04
Validation rmse = 0.164278
Epoch 25
Loss = 1.2654e-01, PNorm = 35.2421, GNorm = 0.9962, lr_0 = 3.7065e-04
Validation rmse = 0.140092
Epoch 26
Loss = 7.3229e-02, PNorm = 35.2535, GNorm = 1.9542, lr_0 = 3.6125e-04
Loss = 1.2623e-01, PNorm = 35.2659, GNorm = 3.0250, lr_0 = 3.5291e-04
Validation rmse = 0.147814
Epoch 27
Loss = 1.6193e-01, PNorm = 35.2769, GNorm = 4.5055, lr_0 = 3.4396e-04
Loss = 1.5748e-01, PNorm = 35.2916, GNorm = 3.2850, lr_0 = 3.3602e-04
Validation rmse = 0.134852
Epoch 28
Loss = 1.1060e-01, PNorm = 35.3036, GNorm = 1.5685, lr_0 = 3.2750e-04
Loss = 1.3370e-01, PNorm = 35.3143, GNorm = 1.2982, lr_0 = 3.1994e-04
Validation rmse = 0.132874
Epoch 29
Loss = 9.3641e-02, PNorm = 35.3239, GNorm = 0.5513, lr_0 = 3.1256e-04
Validation rmse = 0.131204
Epoch 30
Loss = 6.0288e-02, PNorm = 35.3332, GNorm = 1.3064, lr_0 = 3.0463e-04
Loss = 1.1734e-01, PNorm = 35.3407, GNorm = 1.4400, lr_0 = 2.9760e-04
Validation rmse = 0.144770
Epoch 31
Loss = 1.0314e-01, PNorm = 35.3497, GNorm = 1.1504, lr_0 = 2.9005e-04
Loss = 1.0669e-01, PNorm = 35.3569, GNorm = 3.0456, lr_0 = 2.8336e-04
Validation rmse = 0.153012
Epoch 32
Loss = 1.2794e-01, PNorm = 35.3688, GNorm = 1.9988, lr_0 = 2.7617e-04
Loss = 1.0484e-01, PNorm = 35.3771, GNorm = 2.3289, lr_0 = 2.6980e-04
Validation rmse = 0.130821
Epoch 33
Loss = 1.1103e-01, PNorm = 35.3844, GNorm = 1.3117, lr_0 = 2.6357e-04
Validation rmse = 0.136756
Epoch 34
Loss = 1.2408e-01, PNorm = 35.3916, GNorm = 1.1244, lr_0 = 2.5688e-04
Loss = 1.0276e-01, PNorm = 35.3988, GNorm = 0.7207, lr_0 = 2.5095e-04
Validation rmse = 0.133255
Epoch 35
Loss = 1.1443e-01, PNorm = 35.4047, GNorm = 0.7814, lr_0 = 2.4459e-04
Loss = 9.2615e-02, PNorm = 35.4103, GNorm = 1.1843, lr_0 = 2.3894e-04
Validation rmse = 0.146312
Epoch 36
Loss = 1.3534e-01, PNorm = 35.4175, GNorm = 3.7084, lr_0 = 2.3343e-04
Validation rmse = 0.133836
Epoch 37
Loss = 1.6136e-01, PNorm = 35.4246, GNorm = 2.4441, lr_0 = 2.2751e-04
Loss = 1.1882e-01, PNorm = 35.4340, GNorm = 0.9522, lr_0 = 2.2226e-04
Validation rmse = 0.141624
Epoch 38
Loss = 9.7330e-02, PNorm = 35.4432, GNorm = 2.2121, lr_0 = 2.1662e-04
Loss = 1.1222e-01, PNorm = 35.4474, GNorm = 1.2516, lr_0 = 2.1162e-04
Validation rmse = 0.131484
Epoch 39
Loss = 1.1258e-01, PNorm = 35.4572, GNorm = 1.6443, lr_0 = 2.0625e-04
Loss = 1.0013e-01, PNorm = 35.4624, GNorm = 1.2041, lr_0 = 2.0149e-04
Validation rmse = 0.132659
Epoch 40
Loss = 9.6272e-02, PNorm = 35.4669, GNorm = 1.1098, lr_0 = 1.9684e-04
Validation rmse = 0.138814
Epoch 41
Loss = 9.1432e-02, PNorm = 35.4727, GNorm = 0.8154, lr_0 = 1.9185e-04
Loss = 1.0713e-01, PNorm = 35.4774, GNorm = 2.0065, lr_0 = 1.8742e-04
Validation rmse = 0.136638
Epoch 42
Loss = 8.0927e-02, PNorm = 35.4824, GNorm = 0.7443, lr_0 = 1.8267e-04
Loss = 1.0317e-01, PNorm = 35.4864, GNorm = 0.5747, lr_0 = 1.7845e-04
Validation rmse = 0.135049
Epoch 43
Loss = 9.1664e-02, PNorm = 35.4932, GNorm = 0.7129, lr_0 = 1.7433e-04
Loss = 1.0503e-01, PNorm = 35.4991, GNorm = 1.9418, lr_0 = 1.7031e-04
Loss = 2.4683e-01, PNorm = 35.5001, GNorm = 3.6956, lr_0 = 1.6991e-04
Validation rmse = 0.130498
Epoch 44
Loss = 1.0541e-01, PNorm = 35.5048, GNorm = 1.6067, lr_0 = 1.6599e-04
Validation rmse = 0.136164
Epoch 45
Loss = 1.0438e-01, PNorm = 35.5107, GNorm = 3.3758, lr_0 = 1.6178e-04
Loss = 1.0589e-01, PNorm = 35.5156, GNorm = 3.2294, lr_0 = 1.5805e-04
Validation rmse = 0.140149
Epoch 46
Loss = 1.0630e-01, PNorm = 35.5221, GNorm = 3.3216, lr_0 = 1.5404e-04
Loss = 1.0558e-01, PNorm = 35.5266, GNorm = 1.5871, lr_0 = 1.5048e-04
Validation rmse = 0.133975
Epoch 47
Loss = 1.0654e-01, PNorm = 35.5319, GNorm = 1.3805, lr_0 = 1.4701e-04
Validation rmse = 0.136164
Epoch 48
Loss = 7.5426e-02, PNorm = 35.5376, GNorm = 0.9222, lr_0 = 1.4328e-04
Loss = 1.1064e-01, PNorm = 35.5419, GNorm = 2.5934, lr_0 = 1.3997e-04
Validation rmse = 0.131257
Epoch 49
Loss = 9.8271e-02, PNorm = 35.5456, GNorm = 1.0006, lr_0 = 1.3642e-04
Loss = 1.0734e-01, PNorm = 35.5507, GNorm = 1.2816, lr_0 = 1.3327e-04
Validation rmse = 0.133858
Epoch 50
Loss = 9.6017e-02, PNorm = 35.5536, GNorm = 0.6178, lr_0 = 1.3020e-04
Loss = 9.9991e-02, PNorm = 35.5566, GNorm = 1.1750, lr_0 = 1.2719e-04
Validation rmse = 0.141587
Epoch 51
Loss = 1.1541e-01, PNorm = 35.5619, GNorm = 1.6915, lr_0 = 1.2397e-04
Validation rmse = 0.135033
Epoch 52
Loss = 1.4020e-01, PNorm = 35.5657, GNorm = 1.6841, lr_0 = 1.2082e-04
Loss = 8.6014e-02, PNorm = 35.5693, GNorm = 0.6466, lr_0 = 1.1803e-04
Validation rmse = 0.131406
Epoch 53
Loss = 1.0153e-01, PNorm = 35.5729, GNorm = 0.7688, lr_0 = 1.1504e-04
Loss = 1.0487e-01, PNorm = 35.5779, GNorm = 1.6950, lr_0 = 1.1239e-04
Validation rmse = 0.132889
Epoch 54
Loss = 1.0247e-01, PNorm = 35.5796, GNorm = 1.5416, lr_0 = 1.0979e-04
Loss = 9.1942e-02, PNorm = 35.5828, GNorm = 0.5962, lr_0 = 1.0726e-04
Loss = 6.5087e-02, PNorm = 35.5829, GNorm = 1.0171, lr_0 = 1.0701e-04
Validation rmse = 0.135346
Epoch 55
Loss = 8.9219e-02, PNorm = 35.5861, GNorm = 0.9340, lr_0 = 1.0454e-04
Validation rmse = 0.133459
Epoch 56
Loss = 9.1998e-02, PNorm = 35.5892, GNorm = 1.2437, lr_0 = 1.0189e-04
Loss = 9.5166e-02, PNorm = 35.5926, GNorm = 2.2052, lr_0 = 1.0000e-04
Validation rmse = 0.131285
Epoch 57
Loss = 9.3117e-02, PNorm = 35.5954, GNorm = 1.0641, lr_0 = 1.0000e-04
Loss = 9.4373e-02, PNorm = 35.5978, GNorm = 0.6834, lr_0 = 1.0000e-04
Validation rmse = 0.135342
Epoch 58
Loss = 9.4861e-02, PNorm = 35.6014, GNorm = 0.5684, lr_0 = 1.0000e-04
Validation rmse = 0.135015
Epoch 59
Loss = 8.3446e-02, PNorm = 35.6047, GNorm = 1.0708, lr_0 = 1.0000e-04
Loss = 9.7806e-02, PNorm = 35.6080, GNorm = 1.6124, lr_0 = 1.0000e-04
Validation rmse = 0.131727
Model 0 best validation rmse = 0.130498 on epoch 43
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 82.476483
Ensemble test rmse = 82.476483
1-fold cross validation
	Seed 0 ==> test rmse = 82.476483
Overall test rmse = 82.476483 +/- 0.000000
Elapsed time = 0:00:39
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/bin/chemprop_train --data_path ./data/train_dm300_reduced_meoh.csv --dataset_type regression --save_dir ./train_results/smiles_test/ --quiet --smiles_columns full_smiles --target_columns dm300 --epochs 60 --separate_test_path ./data/cosn_2.csv --extra_metrics r2
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/train_dm300_reduced_meoh.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './train_results/smiles_test/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/cosn_2.csv',
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,081 | train size = 864 | val size = 217 | test size = 109
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.0025e+00, PNorm = 34.0165, GNorm = 1.9060, lr_0 = 3.9118e-04
Validation rmse = 0.298174
Validation r2 = 0.287097
Epoch 1
Loss = 7.5041e-01, PNorm = 34.0408, GNorm = 7.7764, lr_0 = 6.8235e-04
Loss = 6.4612e-01, PNorm = 34.0871, GNorm = 12.1670, lr_0 = 9.4706e-04
Validation rmse = 0.239527
Validation r2 = 0.539953
Epoch 2
Loss = 4.7623e-01, PNorm = 34.1634, GNorm = 0.9150, lr_0 = 9.7920e-04
Loss = 4.5796e-01, PNorm = 34.2322, GNorm = 7.5489, lr_0 = 9.5660e-04
Validation rmse = 0.210992
Validation r2 = 0.643036
Epoch 3
Loss = 4.1485e-01, PNorm = 34.3033, GNorm = 5.8427, lr_0 = 9.3234e-04
Validation rmse = 0.176945
Validation r2 = 0.748946
Epoch 4
Loss = 3.5409e-01, PNorm = 34.3662, GNorm = 1.3734, lr_0 = 9.1082e-04
Loss = 3.2520e-01, PNorm = 34.4198, GNorm = 5.0093, lr_0 = 8.8980e-04
Validation rmse = 0.167772
Validation r2 = 0.774300
Epoch 5
Loss = 2.9326e-01, PNorm = 34.4758, GNorm = 4.0986, lr_0 = 8.6723e-04
Loss = 2.6558e-01, PNorm = 34.5336, GNorm = 5.9967, lr_0 = 8.4721e-04
Validation rmse = 0.167385
Validation r2 = 0.775341
Epoch 6
Loss = 2.3284e-01, PNorm = 34.5787, GNorm = 2.5618, lr_0 = 8.2573e-04
Loss = 2.1854e-01, PNorm = 34.6188, GNorm = 2.8786, lr_0 = 8.0667e-04
Loss = 1.8059e-01, PNorm = 34.6215, GNorm = 1.6531, lr_0 = 8.0478e-04
Validation rmse = 0.162189
Validation r2 = 0.789071
Epoch 7
Loss = 2.5496e-01, PNorm = 34.6494, GNorm = 1.2677, lr_0 = 7.8621e-04
Validation rmse = 0.171512
Validation r2 = 0.764127
Epoch 8
Loss = 1.9375e-01, PNorm = 34.6891, GNorm = 1.1372, lr_0 = 7.6806e-04
Loss = 2.3483e-01, PNorm = 34.7311, GNorm = 6.7539, lr_0 = 7.5033e-04
Validation rmse = 0.158623
Validation r2 = 0.798245
Epoch 9
Loss = 2.0835e-01, PNorm = 34.7568, GNorm = 4.7933, lr_0 = 7.3130e-04
Loss = 2.0829e-01, PNorm = 34.7874, GNorm = 1.2248, lr_0 = 7.1442e-04
Validation rmse = 0.162878
Validation r2 = 0.787275
Epoch 10
Loss = 1.6839e-01, PNorm = 34.8146, GNorm = 3.9465, lr_0 = 6.9630e-04
Loss = 1.9810e-01, PNorm = 34.8465, GNorm = 2.9605, lr_0 = 6.8023e-04
Validation rmse = 0.153642
Validation r2 = 0.810716
Epoch 11
Loss = 1.7040e-01, PNorm = 34.8714, GNorm = 1.6311, lr_0 = 6.6453e-04
Validation rmse = 0.135754
Validation r2 = 0.852227
Epoch 12
Loss = 1.7133e-01, PNorm = 34.8996, GNorm = 0.7992, lr_0 = 6.4768e-04
Loss = 1.5272e-01, PNorm = 34.9213, GNorm = 4.6604, lr_0 = 6.3273e-04
Validation rmse = 0.134938
Validation r2 = 0.853998
Epoch 13
Loss = 1.5037e-01, PNorm = 34.9409, GNorm = 1.5186, lr_0 = 6.1668e-04
Loss = 1.3882e-01, PNorm = 34.9581, GNorm = 1.8834, lr_0 = 6.0245e-04
Validation rmse = 0.142445
Validation r2 = 0.837301
Epoch 14
Loss = 1.3152e-01, PNorm = 34.9708, GNorm = 1.5941, lr_0 = 5.8717e-04
Validation rmse = 0.139091
Validation r2 = 0.844872
Epoch 15
Loss = 1.7152e-01, PNorm = 34.9898, GNorm = 1.1262, lr_0 = 5.7362e-04
Loss = 1.3568e-01, PNorm = 35.0088, GNorm = 1.1827, lr_0 = 5.6037e-04
Validation rmse = 0.132064
Validation r2 = 0.860151
Epoch 16
Loss = 1.2646e-01, PNorm = 35.0276, GNorm = 0.8160, lr_0 = 5.4616e-04
Loss = 1.5110e-01, PNorm = 35.0462, GNorm = 0.9377, lr_0 = 5.3356e-04
Validation rmse = 0.137863
Validation r2 = 0.847599
Epoch 17
Loss = 1.1676e-01, PNorm = 35.0591, GNorm = 1.2021, lr_0 = 5.2003e-04
Loss = 1.5192e-01, PNorm = 35.0733, GNorm = 2.5092, lr_0 = 5.0802e-04
Validation rmse = 0.138254
Validation r2 = 0.846734
Epoch 18
Loss = 1.3868e-01, PNorm = 35.0896, GNorm = 4.6727, lr_0 = 4.9630e-04
Validation rmse = 0.135701
Validation r2 = 0.852341
Epoch 19
Loss = 1.2065e-01, PNorm = 35.1027, GNorm = 3.0571, lr_0 = 4.8371e-04
Loss = 1.2900e-01, PNorm = 35.1144, GNorm = 1.0510, lr_0 = 4.7254e-04
Validation rmse = 0.134213
Validation r2 = 0.855561
Epoch 20
Loss = 1.2498e-01, PNorm = 35.1329, GNorm = 0.9135, lr_0 = 4.6056e-04
Loss = 1.4343e-01, PNorm = 35.1465, GNorm = 2.5879, lr_0 = 4.4993e-04
Validation rmse = 0.139308
Validation r2 = 0.844388
Epoch 21
Loss = 1.3648e-01, PNorm = 35.1618, GNorm = 1.1348, lr_0 = 4.3852e-04
Loss = 1.0297e-01, PNorm = 35.1733, GNorm = 1.6563, lr_0 = 4.2840e-04
Validation rmse = 0.131615
Validation r2 = 0.861099
Epoch 22
Loss = 1.1942e-01, PNorm = 35.1846, GNorm = 1.8442, lr_0 = 4.1851e-04
Validation rmse = 0.151904
Validation r2 = 0.814974
Epoch 23
Loss = 1.4554e-01, PNorm = 35.1983, GNorm = 0.6841, lr_0 = 4.0789e-04
Loss = 1.2860e-01, PNorm = 35.2095, GNorm = 0.8584, lr_0 = 3.9848e-04
Validation rmse = 0.139778
Validation r2 = 0.843335
Epoch 24
Loss = 1.1429e-01, PNorm = 35.2186, GNorm = 1.5056, lr_0 = 3.8837e-04
Loss = 1.2697e-01, PNorm = 35.2291, GNorm = 2.5656, lr_0 = 3.7941e-04
Validation rmse = 0.164715
Validation r2 = 0.782452
Epoch 25
Loss = 1.2662e-01, PNorm = 35.2421, GNorm = 0.9984, lr_0 = 3.7065e-04
Validation rmse = 0.139942
Validation r2 = 0.842967
Epoch 26
Loss = 7.3240e-02, PNorm = 35.2535, GNorm = 1.9714, lr_0 = 3.6125e-04
Loss = 1.2672e-01, PNorm = 35.2653, GNorm = 3.0075, lr_0 = 3.5291e-04
Validation rmse = 0.147926
Validation r2 = 0.824540
Epoch 27
Loss = 1.6091e-01, PNorm = 35.2763, GNorm = 4.4304, lr_0 = 3.4396e-04
Loss = 1.5795e-01, PNorm = 35.2899, GNorm = 3.3629, lr_0 = 3.3602e-04
Validation rmse = 0.134818
Validation r2 = 0.854257
Epoch 28
Loss = 1.1073e-01, PNorm = 35.3021, GNorm = 1.6051, lr_0 = 3.2750e-04
Loss = 1.3389e-01, PNorm = 35.3134, GNorm = 1.1963, lr_0 = 3.1994e-04
Validation rmse = 0.132828
Validation r2 = 0.858528
Epoch 29
Loss = 9.3471e-02, PNorm = 35.3231, GNorm = 0.5819, lr_0 = 3.1256e-04
Validation rmse = 0.131148
Validation r2 = 0.862085
Epoch 30
Loss = 6.0207e-02, PNorm = 35.3320, GNorm = 1.2262, lr_0 = 3.0463e-04
Loss = 1.1731e-01, PNorm = 35.3393, GNorm = 1.4267, lr_0 = 2.9760e-04
Validation rmse = 0.144510
Validation r2 = 0.832549
Epoch 31
Loss = 1.0305e-01, PNorm = 35.3478, GNorm = 1.2025, lr_0 = 2.9005e-04
Loss = 1.0656e-01, PNorm = 35.3552, GNorm = 2.9909, lr_0 = 2.8336e-04
Validation rmse = 0.153363
Validation r2 = 0.811404
Epoch 32
Loss = 1.2818e-01, PNorm = 35.3674, GNorm = 2.0066, lr_0 = 2.7617e-04
Loss = 1.0399e-01, PNorm = 35.3760, GNorm = 2.2579, lr_0 = 2.6980e-04
Validation rmse = 0.130713
Validation r2 = 0.862998
Epoch 33
Loss = 1.1112e-01, PNorm = 35.3831, GNorm = 1.2576, lr_0 = 2.6357e-04
Validation rmse = 0.136671
Validation r2 = 0.850222
Epoch 34
Loss = 1.2428e-01, PNorm = 35.3906, GNorm = 1.1367, lr_0 = 2.5688e-04
Loss = 1.0297e-01, PNorm = 35.3980, GNorm = 0.7389, lr_0 = 2.5095e-04
Validation rmse = 0.133293
Validation r2 = 0.857535
Epoch 35
Loss = 1.1484e-01, PNorm = 35.4041, GNorm = 0.7884, lr_0 = 2.4459e-04
Loss = 9.3745e-02, PNorm = 35.4098, GNorm = 1.1190, lr_0 = 2.3894e-04
Validation rmse = 0.146729
Validation r2 = 0.827368
Epoch 36
Loss = 1.3529e-01, PNorm = 35.4177, GNorm = 3.5673, lr_0 = 2.3343e-04
Validation rmse = 0.133603
Validation r2 = 0.856873
Epoch 37
Loss = 1.6010e-01, PNorm = 35.4253, GNorm = 2.4513, lr_0 = 2.2751e-04
Loss = 1.1911e-01, PNorm = 35.4345, GNorm = 0.9033, lr_0 = 2.2226e-04
Validation rmse = 0.140910
Validation r2 = 0.840788
Epoch 38
Loss = 9.7748e-02, PNorm = 35.4434, GNorm = 2.2288, lr_0 = 2.1662e-04
Loss = 1.1179e-01, PNorm = 35.4483, GNorm = 1.2627, lr_0 = 2.1162e-04
Validation rmse = 0.131505
Validation r2 = 0.861331
Epoch 39
Loss = 1.1318e-01, PNorm = 35.4582, GNorm = 1.6845, lr_0 = 2.0625e-04
Loss = 1.0019e-01, PNorm = 35.4637, GNorm = 1.1897, lr_0 = 2.0149e-04
Validation rmse = 0.132365
Validation r2 = 0.859512
Epoch 40
Loss = 9.5911e-02, PNorm = 35.4679, GNorm = 1.1156, lr_0 = 1.9684e-04
Validation rmse = 0.138919
Validation r2 = 0.845256
Epoch 41
Loss = 9.0787e-02, PNorm = 35.4735, GNorm = 0.7994, lr_0 = 1.9185e-04
Loss = 1.0822e-01, PNorm = 35.4782, GNorm = 1.9634, lr_0 = 1.8742e-04
Validation rmse = 0.136539
Validation r2 = 0.850513
Epoch 42
Loss = 8.2479e-02, PNorm = 35.4832, GNorm = 0.7774, lr_0 = 1.8267e-04
Loss = 1.0319e-01, PNorm = 35.4874, GNorm = 0.5591, lr_0 = 1.7845e-04
Validation rmse = 0.134865
Validation r2 = 0.854156
Epoch 43
Loss = 9.2112e-02, PNorm = 35.4945, GNorm = 0.6307, lr_0 = 1.7433e-04
Loss = 1.0508e-01, PNorm = 35.5000, GNorm = 1.9172, lr_0 = 1.7031e-04
Loss = 2.4386e-01, PNorm = 35.5011, GNorm = 3.5915, lr_0 = 1.6991e-04
Validation rmse = 0.130534
Validation r2 = 0.863373
Epoch 44
Loss = 1.0577e-01, PNorm = 35.5059, GNorm = 1.6339, lr_0 = 1.6599e-04
Validation rmse = 0.136536
Validation r2 = 0.850520
Epoch 45
Loss = 1.0640e-01, PNorm = 35.5119, GNorm = 3.3195, lr_0 = 1.6178e-04
Loss = 1.0532e-01, PNorm = 35.5168, GNorm = 3.1823, lr_0 = 1.5805e-04
Validation rmse = 0.139696
Validation r2 = 0.843520
Epoch 46
Loss = 1.0554e-01, PNorm = 35.5236, GNorm = 3.2837, lr_0 = 1.5404e-04
Loss = 1.0608e-01, PNorm = 35.5282, GNorm = 1.5955, lr_0 = 1.5048e-04
Validation rmse = 0.133904
Validation r2 = 0.856227
Epoch 47
Loss = 1.0651e-01, PNorm = 35.5334, GNorm = 1.3939, lr_0 = 1.4701e-04
Validation rmse = 0.135945
Validation r2 = 0.851810
Epoch 48
Loss = 7.6562e-02, PNorm = 35.5391, GNorm = 0.8834, lr_0 = 1.4328e-04
Loss = 1.1054e-01, PNorm = 35.5432, GNorm = 2.6814, lr_0 = 1.3997e-04
Validation rmse = 0.131235
Validation r2 = 0.861901
Epoch 49
Loss = 9.8794e-02, PNorm = 35.5472, GNorm = 1.0759, lr_0 = 1.3642e-04
Loss = 1.0723e-01, PNorm = 35.5522, GNorm = 1.3066, lr_0 = 1.3327e-04
Validation rmse = 0.134099
Validation r2 = 0.855807
Epoch 50
Loss = 9.6115e-02, PNorm = 35.5550, GNorm = 0.6209, lr_0 = 1.3020e-04
Loss = 1.0035e-01, PNorm = 35.5579, GNorm = 1.2069, lr_0 = 1.2719e-04
Validation rmse = 0.141636
Validation r2 = 0.839144
Epoch 51
Loss = 1.1521e-01, PNorm = 35.5632, GNorm = 1.7785, lr_0 = 1.2397e-04
Validation rmse = 0.134854
Validation r2 = 0.854178
Epoch 52
Loss = 1.4038e-01, PNorm = 35.5670, GNorm = 1.7255, lr_0 = 1.2082e-04
Loss = 8.6159e-02, PNorm = 35.5705, GNorm = 0.6443, lr_0 = 1.1803e-04
Validation rmse = 0.131471
Validation r2 = 0.861404
Epoch 53
Loss = 1.0271e-01, PNorm = 35.5742, GNorm = 0.7507, lr_0 = 1.1504e-04
Loss = 1.0522e-01, PNorm = 35.5793, GNorm = 1.8060, lr_0 = 1.1239e-04
Validation rmse = 0.132926
Validation r2 = 0.858320
Epoch 54
Loss = 1.0317e-01, PNorm = 35.5809, GNorm = 1.5967, lr_0 = 1.0979e-04
Loss = 9.1481e-02, PNorm = 35.5840, GNorm = 0.6066, lr_0 = 1.0726e-04
Loss = 6.3916e-02, PNorm = 35.5841, GNorm = 1.1001, lr_0 = 1.0701e-04
Validation rmse = 0.135337
Validation r2 = 0.853132
Epoch 55
Loss = 8.9589e-02, PNorm = 35.5874, GNorm = 1.0583, lr_0 = 1.0454e-04
Validation rmse = 0.133670
Validation r2 = 0.856729
Epoch 56
Loss = 9.1733e-02, PNorm = 35.5906, GNorm = 1.2918, lr_0 = 1.0189e-04
Loss = 9.5248e-02, PNorm = 35.5939, GNorm = 2.2631, lr_0 = 1.0000e-04
Validation rmse = 0.131413
Validation r2 = 0.861526
Epoch 57
Loss = 9.2921e-02, PNorm = 35.5969, GNorm = 1.0215, lr_0 = 1.0000e-04
Loss = 9.4692e-02, PNorm = 35.5996, GNorm = 0.6320, lr_0 = 1.0000e-04
Validation rmse = 0.135143
Validation r2 = 0.853554
Epoch 58
Loss = 9.4166e-02, PNorm = 35.6034, GNorm = 0.5614, lr_0 = 1.0000e-04
Validation rmse = 0.134927
Validation r2 = 0.854021
Epoch 59
Loss = 8.1820e-02, PNorm = 35.6067, GNorm = 1.0069, lr_0 = 1.0000e-04
Loss = 9.8187e-02, PNorm = 35.6104, GNorm = 1.5559, lr_0 = 1.0000e-04
Validation rmse = 0.131941
Validation r2 = 0.860410
Model 0 best validation rmse = 0.130534 on epoch 43
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 82.480742
Model 0 test r2 = -28.683328
Ensemble test rmse = 82.480742
Ensemble test r2 = -28.683328
1-fold cross validation
	Seed 0 ==> test rmse = 82.480742
	Seed 0 ==> test r2 = -28.683328
Overall test rmse = 82.480742 +/- 0.000000
Overall test r2 = -28.683328 +/- 0.000000
Elapsed time = 0:00:38
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/bin/chemprop_train --data_path ./data/train_dm300_reduced_meoh.csv --dataset_type regression --save_dir ./train_results/smiles_test/ --quiet --smiles_columns full_smiles --target_columns dm300 --epochs 60 --separate_test_path ./data/cosn_2.csv --extra_metrics r2
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/train_dm300_reduced_meoh.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './train_results/smiles_test/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/cosn_2.csv',
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,081 | train size = 864 | val size = 217 | test size = 109
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.0025e+00, PNorm = 34.0165, GNorm = 1.9060, lr_0 = 3.9118e-04
Validation rmse = 0.298174
Validation r2 = 0.287097
Epoch 1
Loss = 7.5041e-01, PNorm = 34.0408, GNorm = 7.7764, lr_0 = 6.8235e-04
Loss = 6.4612e-01, PNorm = 34.0871, GNorm = 12.1670, lr_0 = 9.4706e-04
Validation rmse = 0.239527
Validation r2 = 0.539953
Epoch 2
Loss = 4.7623e-01, PNorm = 34.1634, GNorm = 0.9150, lr_0 = 9.7920e-04
Loss = 4.5796e-01, PNorm = 34.2322, GNorm = 7.5490, lr_0 = 9.5660e-04
Validation rmse = 0.210992
Validation r2 = 0.643036
Epoch 3
Loss = 4.1485e-01, PNorm = 34.3033, GNorm = 5.8426, lr_0 = 9.3234e-04
Validation rmse = 0.176944
Validation r2 = 0.748948
Epoch 4
Loss = 3.5407e-01, PNorm = 34.3662, GNorm = 1.3724, lr_0 = 9.1082e-04
Loss = 3.2507e-01, PNorm = 34.4198, GNorm = 4.9995, lr_0 = 8.8980e-04
Validation rmse = 0.167861
Validation r2 = 0.774061
Epoch 5
Loss = 2.9312e-01, PNorm = 34.4762, GNorm = 4.1132, lr_0 = 8.6723e-04
Loss = 2.6561e-01, PNorm = 34.5340, GNorm = 6.0176, lr_0 = 8.4721e-04
Validation rmse = 0.166903
Validation r2 = 0.776632
Epoch 6
Loss = 2.3205e-01, PNorm = 34.5790, GNorm = 2.4897, lr_0 = 8.2573e-04
Loss = 2.1892e-01, PNorm = 34.6188, GNorm = 2.9984, lr_0 = 8.0667e-04
Loss = 1.8315e-01, PNorm = 34.6215, GNorm = 1.4915, lr_0 = 8.0478e-04
Validation rmse = 0.162113
Validation r2 = 0.789270
Epoch 7
Loss = 2.5390e-01, PNorm = 34.6504, GNorm = 1.2694, lr_0 = 7.8621e-04
Validation rmse = 0.170183
Validation r2 = 0.767767
Epoch 8
Loss = 1.9346e-01, PNorm = 34.6898, GNorm = 0.9700, lr_0 = 7.6806e-04
Loss = 2.3343e-01, PNorm = 34.7312, GNorm = 6.7052, lr_0 = 7.5033e-04
Validation rmse = 0.158848
Validation r2 = 0.797673
Epoch 9
Loss = 2.0788e-01, PNorm = 34.7580, GNorm = 4.7522, lr_0 = 7.3130e-04
Loss = 2.0871e-01, PNorm = 34.7899, GNorm = 1.6837, lr_0 = 7.1442e-04
Validation rmse = 0.164990
Validation r2 = 0.781723
Epoch 10
Loss = 1.7156e-01, PNorm = 34.8173, GNorm = 4.3571, lr_0 = 6.9630e-04
Loss = 1.9908e-01, PNorm = 34.8487, GNorm = 2.8120, lr_0 = 6.8023e-04
Validation rmse = 0.153728
Validation r2 = 0.810505
Epoch 11
Loss = 1.7093e-01, PNorm = 34.8732, GNorm = 1.8786, lr_0 = 6.6453e-04
Validation rmse = 0.135424
Validation r2 = 0.852943
Epoch 12
Loss = 1.7106e-01, PNorm = 34.9017, GNorm = 0.7927, lr_0 = 6.4768e-04
Loss = 1.5137e-01, PNorm = 34.9230, GNorm = 4.5779, lr_0 = 6.3273e-04
Validation rmse = 0.134514
Validation r2 = 0.854914
Epoch 13
Loss = 1.4951e-01, PNorm = 34.9417, GNorm = 1.5665, lr_0 = 6.1668e-04
Loss = 1.3854e-01, PNorm = 34.9579, GNorm = 1.7822, lr_0 = 6.0245e-04
Validation rmse = 0.140492
Validation r2 = 0.841731
Epoch 14
Loss = 1.3112e-01, PNorm = 34.9707, GNorm = 1.6107, lr_0 = 5.8717e-04
Validation rmse = 0.140657
Validation r2 = 0.841359
Epoch 15
Loss = 1.6822e-01, PNorm = 34.9887, GNorm = 0.9509, lr_0 = 5.7362e-04
Loss = 1.3439e-01, PNorm = 35.0070, GNorm = 1.0605, lr_0 = 5.6037e-04
Validation rmse = 0.131938
Validation r2 = 0.860417
Epoch 16
Loss = 1.2685e-01, PNorm = 35.0259, GNorm = 1.0395, lr_0 = 5.4616e-04
Loss = 1.5074e-01, PNorm = 35.0448, GNorm = 0.9072, lr_0 = 5.3356e-04
Validation rmse = 0.138268
Validation r2 = 0.846702
Epoch 17
Loss = 1.1770e-01, PNorm = 35.0576, GNorm = 1.2086, lr_0 = 5.2003e-04
Loss = 1.5203e-01, PNorm = 35.0721, GNorm = 2.7987, lr_0 = 5.0802e-04
Validation rmse = 0.137595
Validation r2 = 0.848190
Epoch 18
Loss = 1.3842e-01, PNorm = 35.0891, GNorm = 4.8007, lr_0 = 4.9630e-04
Validation rmse = 0.135774
Validation r2 = 0.852182
Epoch 19
Loss = 1.1832e-01, PNorm = 35.1027, GNorm = 2.9953, lr_0 = 4.8371e-04
Loss = 1.2871e-01, PNorm = 35.1149, GNorm = 1.0010, lr_0 = 4.7254e-04
Validation rmse = 0.134778
Validation r2 = 0.854343
Epoch 20
Loss = 1.2542e-01, PNorm = 35.1338, GNorm = 0.9529, lr_0 = 4.6056e-04
Loss = 1.4311e-01, PNorm = 35.1478, GNorm = 2.5984, lr_0 = 4.4993e-04
Validation rmse = 0.139387
Validation r2 = 0.844211
Epoch 21
Loss = 1.3558e-01, PNorm = 35.1637, GNorm = 1.1589, lr_0 = 4.3852e-04
Loss = 1.0267e-01, PNorm = 35.1754, GNorm = 1.5005, lr_0 = 4.2840e-04
Validation rmse = 0.131973
Validation r2 = 0.860344
Epoch 22
Loss = 1.1996e-01, PNorm = 35.1866, GNorm = 1.9572, lr_0 = 4.1851e-04
Validation rmse = 0.152229
Validation r2 = 0.814183
Epoch 23
Loss = 1.4537e-01, PNorm = 35.2010, GNorm = 0.7330, lr_0 = 4.0789e-04
Loss = 1.2818e-01, PNorm = 35.2125, GNorm = 0.9135, lr_0 = 3.9848e-04
Validation rmse = 0.139944
Validation r2 = 0.842964
Epoch 24
Loss = 1.1369e-01, PNorm = 35.2223, GNorm = 1.7684, lr_0 = 3.8837e-04
Loss = 1.2692e-01, PNorm = 35.2324, GNorm = 2.7744, lr_0 = 3.7941e-04
Validation rmse = 0.165698
Validation r2 = 0.779847
Epoch 25
Loss = 1.2726e-01, PNorm = 35.2459, GNorm = 0.9642, lr_0 = 3.7065e-04
Validation rmse = 0.139129
Validation r2 = 0.844788
Epoch 26
Loss = 7.1187e-02, PNorm = 35.2578, GNorm = 1.8951, lr_0 = 3.6125e-04
Loss = 1.2633e-01, PNorm = 35.2703, GNorm = 3.0986, lr_0 = 3.5291e-04
Validation rmse = 0.148014
Validation r2 = 0.824329
Epoch 27
Loss = 1.6199e-01, PNorm = 35.2807, GNorm = 4.5405, lr_0 = 3.4396e-04
Loss = 1.5690e-01, PNorm = 35.2949, GNorm = 3.3638, lr_0 = 3.3602e-04
Validation rmse = 0.134107
Validation r2 = 0.855791
Epoch 28
Loss = 1.0984e-01, PNorm = 35.3065, GNorm = 1.8197, lr_0 = 3.2750e-04
Loss = 1.3319e-01, PNorm = 35.3181, GNorm = 1.3013, lr_0 = 3.1994e-04
Validation rmse = 0.132841
Validation r2 = 0.858501
Epoch 29
Loss = 9.3333e-02, PNorm = 35.3277, GNorm = 0.5668, lr_0 = 3.1256e-04
Validation rmse = 0.131110
Validation r2 = 0.862164
Epoch 30
Loss = 5.9031e-02, PNorm = 35.3370, GNorm = 1.0628, lr_0 = 3.0463e-04
Loss = 1.1638e-01, PNorm = 35.3441, GNorm = 1.4286, lr_0 = 2.9760e-04
Validation rmse = 0.144730
Validation r2 = 0.832040
Epoch 31
Loss = 1.0213e-01, PNorm = 35.3533, GNorm = 1.0648, lr_0 = 2.9005e-04
Loss = 1.0560e-01, PNorm = 35.3611, GNorm = 2.8537, lr_0 = 2.8336e-04
Validation rmse = 0.151907
Validation r2 = 0.814968
Epoch 32
Loss = 1.2507e-01, PNorm = 35.3728, GNorm = 1.8532, lr_0 = 2.7617e-04
Loss = 1.0465e-01, PNorm = 35.3810, GNorm = 2.2209, lr_0 = 2.6980e-04
Validation rmse = 0.131016
Validation r2 = 0.862361
Epoch 33
Loss = 1.1005e-01, PNorm = 35.3879, GNorm = 1.2926, lr_0 = 2.6357e-04
Validation rmse = 0.137158
Validation r2 = 0.849154
Epoch 34
Loss = 1.2394e-01, PNorm = 35.3957, GNorm = 1.1870, lr_0 = 2.5688e-04
Loss = 1.0245e-01, PNorm = 35.4032, GNorm = 0.8012, lr_0 = 2.5095e-04
Validation rmse = 0.133342
Validation r2 = 0.857430
Epoch 35
Loss = 1.1406e-01, PNorm = 35.4096, GNorm = 0.8031, lr_0 = 2.4459e-04
Loss = 9.2325e-02, PNorm = 35.4151, GNorm = 1.1360, lr_0 = 2.3894e-04
Validation rmse = 0.146300
Validation r2 = 0.828375
Epoch 36
Loss = 1.3296e-01, PNorm = 35.4231, GNorm = 3.5351, lr_0 = 2.3343e-04
Validation rmse = 0.134076
Validation r2 = 0.855857
Epoch 37
Loss = 1.5662e-01, PNorm = 35.4307, GNorm = 2.3081, lr_0 = 2.2751e-04
Loss = 1.1812e-01, PNorm = 35.4398, GNorm = 0.9879, lr_0 = 2.2226e-04
Validation rmse = 0.141480
Validation r2 = 0.839498
Epoch 38
Loss = 9.8461e-02, PNorm = 35.4487, GNorm = 2.2335, lr_0 = 2.1662e-04
Loss = 1.1087e-01, PNorm = 35.4531, GNorm = 1.2666, lr_0 = 2.1162e-04
Validation rmse = 0.131627
Validation r2 = 0.861074
Epoch 39
Loss = 1.1187e-01, PNorm = 35.4636, GNorm = 1.5652, lr_0 = 2.0625e-04
Loss = 9.9702e-02, PNorm = 35.4687, GNorm = 1.3360, lr_0 = 2.0149e-04
Validation rmse = 0.132491
Validation r2 = 0.859246
Epoch 40
Loss = 9.5730e-02, PNorm = 35.4730, GNorm = 1.0169, lr_0 = 1.9684e-04
Validation rmse = 0.138978
Validation r2 = 0.845123
Epoch 41
Loss = 9.1633e-02, PNorm = 35.4787, GNorm = 0.7863, lr_0 = 1.9185e-04
Loss = 1.0658e-01, PNorm = 35.4834, GNorm = 1.9742, lr_0 = 1.8742e-04
Validation rmse = 0.136502
Validation r2 = 0.850593
Epoch 42
Loss = 8.1201e-02, PNorm = 35.4887, GNorm = 0.8148, lr_0 = 1.8267e-04
Loss = 1.0276e-01, PNorm = 35.4927, GNorm = 0.6239, lr_0 = 1.7845e-04
Validation rmse = 0.135135
Validation r2 = 0.853571
Epoch 43
Loss = 9.0903e-02, PNorm = 35.4994, GNorm = 0.6620, lr_0 = 1.7433e-04
Loss = 1.0442e-01, PNorm = 35.5053, GNorm = 1.9515, lr_0 = 1.7031e-04
Loss = 2.4166e-01, PNorm = 35.5063, GNorm = 3.7741, lr_0 = 1.6991e-04
Validation rmse = 0.130648
Validation r2 = 0.863133
Epoch 44
Loss = 1.0517e-01, PNorm = 35.5111, GNorm = 1.6975, lr_0 = 1.6599e-04
Validation rmse = 0.136574
Validation r2 = 0.850435
Epoch 45
Loss = 1.0620e-01, PNorm = 35.5172, GNorm = 3.4983, lr_0 = 1.6178e-04
Loss = 1.0500e-01, PNorm = 35.5220, GNorm = 3.2945, lr_0 = 1.5805e-04
Validation rmse = 0.140270
Validation r2 = 0.842232
Epoch 46
Loss = 1.0546e-01, PNorm = 35.5288, GNorm = 3.4169, lr_0 = 1.5404e-04
Loss = 1.0526e-01, PNorm = 35.5334, GNorm = 1.5468, lr_0 = 1.5048e-04
Validation rmse = 0.133863
Validation r2 = 0.856314
Epoch 47
Loss = 1.0523e-01, PNorm = 35.5389, GNorm = 1.3810, lr_0 = 1.4701e-04
Validation rmse = 0.136189
Validation r2 = 0.851277
Epoch 48
Loss = 7.5777e-02, PNorm = 35.5447, GNorm = 0.9618, lr_0 = 1.4328e-04
Loss = 1.0983e-01, PNorm = 35.5487, GNorm = 2.7328, lr_0 = 1.3997e-04
Validation rmse = 0.131276
Validation r2 = 0.861816
Epoch 49
Loss = 9.8252e-02, PNorm = 35.5527, GNorm = 1.1594, lr_0 = 1.3642e-04
Loss = 1.0616e-01, PNorm = 35.5577, GNorm = 1.3899, lr_0 = 1.3327e-04
Validation rmse = 0.134295
Validation r2 = 0.855386
Epoch 50
Loss = 9.5009e-02, PNorm = 35.5605, GNorm = 0.6189, lr_0 = 1.3020e-04
Loss = 9.9726e-02, PNorm = 35.5635, GNorm = 1.1243, lr_0 = 1.2719e-04
Validation rmse = 0.141668
Validation r2 = 0.839070
Epoch 51
Loss = 1.1434e-01, PNorm = 35.5686, GNorm = 1.7510, lr_0 = 1.2397e-04
Validation rmse = 0.134874
Validation r2 = 0.854136
Epoch 52
Loss = 1.3935e-01, PNorm = 35.5723, GNorm = 1.7975, lr_0 = 1.2082e-04
Loss = 8.4861e-02, PNorm = 35.5757, GNorm = 0.6926, lr_0 = 1.1803e-04
Validation rmse = 0.131614
Validation r2 = 0.861103
Epoch 53
Loss = 1.0154e-01, PNorm = 35.5794, GNorm = 0.7534, lr_0 = 1.1504e-04
Loss = 1.0428e-01, PNorm = 35.5844, GNorm = 1.7663, lr_0 = 1.1239e-04
Validation rmse = 0.133158
Validation r2 = 0.857824
Epoch 54
Loss = 1.0183e-01, PNorm = 35.5856, GNorm = 1.5094, lr_0 = 1.0979e-04
Loss = 9.0420e-02, PNorm = 35.5886, GNorm = 0.5641, lr_0 = 1.0726e-04
Loss = 6.1591e-02, PNorm = 35.5886, GNorm = 1.0099, lr_0 = 1.0701e-04
Validation rmse = 0.135590
Validation r2 = 0.852584
Epoch 55
Loss = 8.8423e-02, PNorm = 35.5918, GNorm = 1.0233, lr_0 = 1.0454e-04
Validation rmse = 0.133437
Validation r2 = 0.857228
Epoch 56
Loss = 9.2388e-02, PNorm = 35.5951, GNorm = 1.4460, lr_0 = 1.0189e-04
Loss = 9.4022e-02, PNorm = 35.5984, GNorm = 2.2546, lr_0 = 1.0000e-04
Validation rmse = 0.131580
Validation r2 = 0.861174
Epoch 57
Loss = 9.1755e-02, PNorm = 35.6013, GNorm = 0.9830, lr_0 = 1.0000e-04
Loss = 9.4114e-02, PNorm = 35.6040, GNorm = 0.7106, lr_0 = 1.0000e-04
Validation rmse = 0.135577
Validation r2 = 0.852612
Epoch 58
Loss = 9.3711e-02, PNorm = 35.6076, GNorm = 0.5664, lr_0 = 1.0000e-04
Validation rmse = 0.135196
Validation r2 = 0.853439
Epoch 59
Loss = 8.0845e-02, PNorm = 35.6106, GNorm = 1.1182, lr_0 = 1.0000e-04
Loss = 9.6991e-02, PNorm = 35.6140, GNorm = 1.5550, lr_0 = 1.0000e-04
Validation rmse = 0.131826
Validation r2 = 0.860654
Model 0 best validation rmse = 0.130648 on epoch 43
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.493950
Model 0 test r2 = -9.645665
Ensemble test rmse = 0.493950
Ensemble test r2 = -9.645665
1-fold cross validation
	Seed 0 ==> test rmse = 0.493950
	Seed 0 ==> test r2 = -9.645665
Overall test rmse = 0.493950 +/- 0.000000
Overall test r2 = -9.645665 +/- 0.000000
Elapsed time = 0:00:39
