Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-b7475d0b-07b0-44d4-8ff7-2d2ab811a23b.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/FINAL_LIST.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 50,
 'explicit_h': False,
 'extra_metrics': ['r2', 'mse'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2', 'mse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/hyperopt/10_fold/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,032 | train size = 825 | val size = 103 | test size = 104
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.1204e-01, PNorm = 43.2653, GNorm = 4.8117, lr_0 = 4.0937e-04
Validation rmse = 0.294476
Validation r2 = 0.172673
Validation mse = 0.086716
Epoch 1
Loss = 7.3724e-01, PNorm = 43.2955, GNorm = 2.4824, lr_0 = 7.1875e-04
Loss = 5.4774e-01, PNorm = 43.3479, GNorm = 15.7985, lr_0 = 1.0000e-03
Validation rmse = 0.255149
Validation r2 = 0.378896
Validation mse = 0.065101
Epoch 2
Loss = 4.7793e-01, PNorm = 43.4095, GNorm = 2.0588, lr_0 = 9.7046e-04
Validation rmse = 0.215930
Validation r2 = 0.555162
Validation mse = 0.046626
Epoch 3
Loss = 2.1269e-01, PNorm = 43.4875, GNorm = 2.5234, lr_0 = 9.3898e-04
Loss = 3.1867e-01, PNorm = 43.5574, GNorm = 6.0389, lr_0 = 9.1125e-04
Validation rmse = 0.194647
Validation r2 = 0.638531
Validation mse = 0.037887
Epoch 4
Loss = 2.6995e-01, PNorm = 43.6147, GNorm = 1.1045, lr_0 = 8.8433e-04
Loss = 2.1566e-01, PNorm = 43.6691, GNorm = 6.2060, lr_0 = 8.5821e-04
Validation rmse = 0.171810
Validation r2 = 0.718373
Validation mse = 0.029519
Epoch 5
Loss = 2.2652e-01, PNorm = 43.7136, GNorm = 5.2348, lr_0 = 8.3037e-04
Validation rmse = 0.168115
Validation r2 = 0.730357
Validation mse = 0.028263
Epoch 6
Loss = 2.4749e-01, PNorm = 43.7502, GNorm = 3.5324, lr_0 = 8.0584e-04
Loss = 2.3187e-01, PNorm = 43.7826, GNorm = 1.3367, lr_0 = 7.8204e-04
Validation rmse = 0.150705
Validation r2 = 0.783315
Validation mse = 0.022712
Epoch 7
Loss = 1.2945e-01, PNorm = 43.8069, GNorm = 1.3080, lr_0 = 7.5667e-04
Loss = 1.8479e-01, PNorm = 43.8360, GNorm = 3.2214, lr_0 = 7.3432e-04
Validation rmse = 0.143879
Validation r2 = 0.802500
Validation mse = 0.020701
Epoch 8
Loss = 1.8873e-01, PNorm = 43.8576, GNorm = 1.6322, lr_0 = 7.1263e-04
Validation rmse = 0.160294
Validation r2 = 0.754863
Validation mse = 0.025694
Epoch 9
Loss = 1.8794e-01, PNorm = 43.8859, GNorm = 2.4801, lr_0 = 6.8951e-04
Loss = 1.8041e-01, PNorm = 43.9143, GNorm = 9.2087, lr_0 = 6.6915e-04
Validation rmse = 0.165648
Validation r2 = 0.738212
Validation mse = 0.027439
Epoch 10
Loss = 1.8125e-01, PNorm = 43.9353, GNorm = 3.3704, lr_0 = 6.4938e-04
Loss = 1.4842e-01, PNorm = 43.9593, GNorm = 1.5643, lr_0 = 6.3020e-04
Validation rmse = 0.136740
Validation r2 = 0.821611
Validation mse = 0.018698
Epoch 11
Loss = 1.2893e-01, PNorm = 43.9850, GNorm = 2.2272, lr_0 = 6.0976e-04
Validation rmse = 0.145037
Validation r2 = 0.799305
Validation mse = 0.021036
Epoch 12
Loss = 1.4902e-01, PNorm = 44.0016, GNorm = 4.0260, lr_0 = 5.9175e-04
Loss = 1.4274e-01, PNorm = 44.0161, GNorm = 1.6424, lr_0 = 5.7427e-04
Validation rmse = 0.137460
Validation r2 = 0.819728
Validation mse = 0.018895
Epoch 13
Loss = 1.2253e-01, PNorm = 44.0385, GNorm = 1.4771, lr_0 = 5.5564e-04
Loss = 1.2952e-01, PNorm = 44.0526, GNorm = 0.6025, lr_0 = 5.3923e-04
Validation rmse = 0.156810
Validation r2 = 0.765401
Validation mse = 0.024590
Epoch 14
Loss = 1.4299e-01, PNorm = 44.0694, GNorm = 1.6980, lr_0 = 5.2330e-04
Validation rmse = 0.137462
Validation r2 = 0.819723
Validation mse = 0.018896
Epoch 15
Loss = 9.3667e-02, PNorm = 44.0894, GNorm = 2.5271, lr_0 = 5.0632e-04
Loss = 1.1408e-01, PNorm = 44.1062, GNorm = 1.0461, lr_0 = 4.9137e-04
Validation rmse = 0.137319
Validation r2 = 0.820097
Validation mse = 0.018857
Epoch 16
Loss = 1.1203e-01, PNorm = 44.1211, GNorm = 3.5720, lr_0 = 4.7685e-04
Loss = 1.0531e-01, PNorm = 44.1346, GNorm = 0.6864, lr_0 = 4.6277e-04
Loss = 5.9699e-02, PNorm = 44.1356, GNorm = 1.2134, lr_0 = 4.6138e-04
Validation rmse = 0.129833
Validation r2 = 0.839178
Validation mse = 0.016857
Epoch 17
Loss = 1.0601e-01, PNorm = 44.1473, GNorm = 1.7619, lr_0 = 4.4776e-04
Validation rmse = 0.130524
Validation r2 = 0.837461
Validation mse = 0.017037
Epoch 18
Loss = 9.3531e-02, PNorm = 44.1591, GNorm = 1.1265, lr_0 = 4.3453e-04
Loss = 9.1624e-02, PNorm = 44.1686, GNorm = 1.3720, lr_0 = 4.2170e-04
Validation rmse = 0.125335
Validation r2 = 0.850127
Validation mse = 0.015709
Epoch 19
Loss = 9.5790e-02, PNorm = 44.1812, GNorm = 1.5341, lr_0 = 4.0802e-04
Loss = 1.0035e-01, PNorm = 44.1901, GNorm = 3.4962, lr_0 = 3.9596e-04
Validation rmse = 0.130691
Validation r2 = 0.837046
Validation mse = 0.017080
Epoch 20
Loss = 9.8447e-02, PNorm = 44.2033, GNorm = 1.1280, lr_0 = 3.8427e-04
Validation rmse = 0.125703
Validation r2 = 0.849246
Validation mse = 0.015801
Epoch 21
Loss = 8.5715e-02, PNorm = 44.2143, GNorm = 1.1021, lr_0 = 3.7180e-04
Loss = 9.4828e-02, PNorm = 44.2228, GNorm = 2.2178, lr_0 = 3.6082e-04
Validation rmse = 0.129132
Validation r2 = 0.840909
Validation mse = 0.016675
Epoch 22
Loss = 8.6777e-02, PNorm = 44.2331, GNorm = 0.5663, lr_0 = 3.5016e-04
Validation rmse = 0.126973
Validation r2 = 0.846185
Validation mse = 0.016122
Epoch 23
Loss = 7.9218e-02, PNorm = 44.2433, GNorm = 0.7258, lr_0 = 3.3880e-04
Loss = 9.6670e-02, PNorm = 44.2531, GNorm = 1.0310, lr_0 = 3.2880e-04
Validation rmse = 0.132898
Validation r2 = 0.831495
Validation mse = 0.017662
Epoch 24
Loss = 8.7924e-02, PNorm = 44.2612, GNorm = 0.5366, lr_0 = 3.1908e-04
Loss = 9.2184e-02, PNorm = 44.2709, GNorm = 0.8896, lr_0 = 3.0966e-04
Validation rmse = 0.130225
Validation r2 = 0.838205
Validation mse = 0.016959
Epoch 25
Loss = 8.9131e-02, PNorm = 44.2808, GNorm = 2.2032, lr_0 = 2.9961e-04
Validation rmse = 0.127744
Validation r2 = 0.844310
Validation mse = 0.016319
Epoch 26
Loss = 4.8307e-02, PNorm = 44.2886, GNorm = 0.6175, lr_0 = 2.9076e-04
Loss = 9.4114e-02, PNorm = 44.2971, GNorm = 1.0394, lr_0 = 2.8218e-04
Validation rmse = 0.126095
Validation r2 = 0.848304
Validation mse = 0.015900
Epoch 27
Loss = 8.6834e-02, PNorm = 44.3050, GNorm = 2.6900, lr_0 = 2.7302e-04
Loss = 9.7807e-02, PNorm = 44.3126, GNorm = 1.2751, lr_0 = 2.6496e-04
Validation rmse = 0.125976
Validation r2 = 0.848592
Validation mse = 0.015870
Epoch 28
Loss = 8.7659e-02, PNorm = 44.3205, GNorm = 0.7100, lr_0 = 2.5713e-04
Validation rmse = 0.124584
Validation r2 = 0.851918
Validation mse = 0.015521
Epoch 29
Loss = 8.0991e-02, PNorm = 44.3276, GNorm = 0.7701, lr_0 = 2.4879e-04
Loss = 7.4638e-02, PNorm = 44.3350, GNorm = 1.4799, lr_0 = 2.4144e-04
Validation rmse = 0.129466
Validation r2 = 0.840085
Validation mse = 0.016761
Epoch 30
Loss = 8.0967e-02, PNorm = 44.3402, GNorm = 1.6626, lr_0 = 2.3431e-04
Loss = 9.0743e-02, PNorm = 44.3472, GNorm = 4.0970, lr_0 = 2.2739e-04
Validation rmse = 0.127326
Validation r2 = 0.845329
Validation mse = 0.016212
Epoch 31
Loss = 7.0006e-02, PNorm = 44.3541, GNorm = 1.2952, lr_0 = 2.2001e-04
Validation rmse = 0.123319
Validation r2 = 0.854910
Validation mse = 0.015208
Epoch 32
Loss = 8.0828e-02, PNorm = 44.3618, GNorm = 0.8763, lr_0 = 2.1351e-04
Loss = 7.6295e-02, PNorm = 44.3683, GNorm = 1.1535, lr_0 = 2.0721e-04
Validation rmse = 0.125499
Validation r2 = 0.849735
Validation mse = 0.015750
Epoch 33
Loss = 7.5511e-02, PNorm = 44.3751, GNorm = 1.5719, lr_0 = 2.0049e-04
Loss = 7.4906e-02, PNorm = 44.3819, GNorm = 0.8182, lr_0 = 1.9456e-04
Validation rmse = 0.123849
Validation r2 = 0.853660
Validation mse = 0.015339
Epoch 34
Loss = 7.2209e-02, PNorm = 44.3865, GNorm = 2.1262, lr_0 = 1.8882e-04
Validation rmse = 0.123774
Validation r2 = 0.853838
Validation mse = 0.015320
Epoch 35
Loss = 8.6939e-02, PNorm = 44.3927, GNorm = 3.7728, lr_0 = 1.8269e-04
Loss = 8.6969e-02, PNorm = 44.3986, GNorm = 1.2794, lr_0 = 1.7730e-04
Validation rmse = 0.125685
Validation r2 = 0.849290
Validation mse = 0.015797
Epoch 36
Loss = 6.5877e-02, PNorm = 44.4042, GNorm = 1.5955, lr_0 = 1.7206e-04
Loss = 7.4034e-02, PNorm = 44.4101, GNorm = 0.9768, lr_0 = 1.6698e-04
Loss = 1.3891e-01, PNorm = 44.4105, GNorm = 4.0132, lr_0 = 1.6648e-04
Validation rmse = 0.122477
Validation r2 = 0.856885
Validation mse = 0.015001
Epoch 37
Loss = 7.0252e-02, PNorm = 44.4155, GNorm = 0.8084, lr_0 = 1.6156e-04
Validation rmse = 0.123009
Validation r2 = 0.855640
Validation mse = 0.015131
Epoch 38
Loss = 9.0050e-02, PNorm = 44.4210, GNorm = 1.0050, lr_0 = 1.5679e-04
Loss = 6.4137e-02, PNorm = 44.4261, GNorm = 0.9538, lr_0 = 1.5216e-04
Validation rmse = 0.122150
Validation r2 = 0.857649
Validation mse = 0.014921
Epoch 39
Loss = 6.6227e-02, PNorm = 44.4312, GNorm = 0.7445, lr_0 = 1.4722e-04
Loss = 7.3848e-02, PNorm = 44.4357, GNorm = 0.8199, lr_0 = 1.4287e-04
Validation rmse = 0.122382
Validation r2 = 0.857106
Validation mse = 0.014977
Epoch 40
Loss = 6.2870e-02, PNorm = 44.4395, GNorm = 1.1977, lr_0 = 1.3865e-04
Validation rmse = 0.123935
Validation r2 = 0.853457
Validation mse = 0.015360
Epoch 41
Loss = 6.6566e-02, PNorm = 44.4438, GNorm = 2.0281, lr_0 = 1.3415e-04
Loss = 7.6071e-02, PNorm = 44.4478, GNorm = 0.8366, lr_0 = 1.3019e-04
Validation rmse = 0.121880
Validation r2 = 0.858277
Validation mse = 0.014855
Epoch 42
Loss = 6.0411e-02, PNorm = 44.4526, GNorm = 0.4550, lr_0 = 1.2635e-04
Validation rmse = 0.124301
Validation r2 = 0.852590
Validation mse = 0.015451
Epoch 43
Loss = 7.5831e-02, PNorm = 44.4569, GNorm = 1.1126, lr_0 = 1.2225e-04
Loss = 6.8417e-02, PNorm = 44.4612, GNorm = 1.0913, lr_0 = 1.1864e-04
Validation rmse = 0.120461
Validation r2 = 0.861559
Validation mse = 0.014511
Epoch 44
Loss = 4.9734e-02, PNorm = 44.4651, GNorm = 1.6759, lr_0 = 1.1513e-04
Loss = 8.1113e-02, PNorm = 44.4692, GNorm = 1.3119, lr_0 = 1.1173e-04
Validation rmse = 0.128673
Validation r2 = 0.842039
Validation mse = 0.016557
Epoch 45
Loss = 6.9869e-02, PNorm = 44.4733, GNorm = 1.6546, lr_0 = 1.0811e-04
Validation rmse = 0.122752
Validation r2 = 0.856242
Validation mse = 0.015068
Epoch 46
Loss = 5.7470e-02, PNorm = 44.4772, GNorm = 1.1890, lr_0 = 1.0491e-04
Loss = 6.3352e-02, PNorm = 44.4805, GNorm = 2.7072, lr_0 = 1.0182e-04
Validation rmse = 0.124878
Validation r2 = 0.851218
Validation mse = 0.015595
Epoch 47
Loss = 6.8197e-02, PNorm = 44.4840, GNorm = 1.3189, lr_0 = 1.0000e-04
Loss = 5.8844e-02, PNorm = 44.4868, GNorm = 0.6025, lr_0 = 1.0000e-04
Validation rmse = 0.121129
Validation r2 = 0.860018
Validation mse = 0.014672
Epoch 48
Loss = 6.1289e-02, PNorm = 44.4900, GNorm = 0.9474, lr_0 = 1.0000e-04
Validation rmse = 0.129590
Validation r2 = 0.839778
Validation mse = 0.016794
Epoch 49
Loss = 8.7607e-02, PNorm = 44.4944, GNorm = 3.4581, lr_0 = 1.0000e-04
Loss = 6.5860e-02, PNorm = 44.4972, GNorm = 0.9842, lr_0 = 1.0000e-04
Validation rmse = 0.121644
Validation r2 = 0.858825
Validation mse = 0.014797
Model 0 best validation rmse = 0.120461 on epoch 43
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.108898
Model 0 test r2 = 0.905568
Model 0 test mse = 0.011859
Ensemble test rmse = 0.108898
Ensemble test r2 = 0.905568
Ensemble test mse = 0.011859
Fold 1
Splitting data with seed 1
Total size = 1,032 | train size = 825 | val size = 103 | test size = 104
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 8.7886e-01, PNorm = 43.2637, GNorm = 1.5915, lr_0 = 4.0937e-04
Validation rmse = 0.267395
Validation r2 = 0.423202
Validation mse = 0.071500
Epoch 1
Loss = 7.6764e-01, PNorm = 43.2947, GNorm = 10.0584, lr_0 = 7.1875e-04
Loss = 8.1547e-01, PNorm = 43.3368, GNorm = 2.2120, lr_0 = 1.0000e-03
Validation rmse = 0.249224
Validation r2 = 0.498931
Validation mse = 0.062112
Epoch 2
Loss = 4.6025e-01, PNorm = 43.4195, GNorm = 5.7916, lr_0 = 9.7046e-04
Validation rmse = 0.270058
Validation r2 = 0.411654
Validation mse = 0.072931
Epoch 3
Loss = 4.1142e-01, PNorm = 43.4989, GNorm = 2.8192, lr_0 = 9.3898e-04
Loss = 4.9620e-01, PNorm = 43.5726, GNorm = 4.7416, lr_0 = 9.1125e-04
Validation rmse = 0.262911
Validation r2 = 0.442382
Validation mse = 0.069122
Epoch 4
Loss = 3.2503e-01, PNorm = 43.6387, GNorm = 3.6444, lr_0 = 8.8433e-04
Loss = 3.6710e-01, PNorm = 43.6984, GNorm = 4.5923, lr_0 = 8.5821e-04
Validation rmse = 0.222079
Validation r2 = 0.602136
Validation mse = 0.049319
Epoch 5
Loss = 2.6474e-01, PNorm = 43.7621, GNorm = 4.9881, lr_0 = 8.3037e-04
Validation rmse = 0.156478
Validation r2 = 0.802474
Validation mse = 0.024485
Epoch 6
Loss = 2.4808e-01, PNorm = 43.7981, GNorm = 2.8892, lr_0 = 8.0584e-04
Loss = 2.3313e-01, PNorm = 43.8402, GNorm = 1.3047, lr_0 = 7.8204e-04
Validation rmse = 0.175273
Validation r2 = 0.752173
Validation mse = 0.030721
Epoch 7
Loss = 2.6838e-01, PNorm = 43.8846, GNorm = 6.2046, lr_0 = 7.5667e-04
Loss = 1.7992e-01, PNorm = 43.9231, GNorm = 3.0285, lr_0 = 7.3432e-04
Validation rmse = 0.153006
Validation r2 = 0.811143
Validation mse = 0.023411
Epoch 8
Loss = 1.7096e-01, PNorm = 43.9521, GNorm = 3.1432, lr_0 = 7.1263e-04
Validation rmse = 0.138718
Validation r2 = 0.844768
Validation mse = 0.019243
Epoch 9
Loss = 1.7661e-01, PNorm = 43.9840, GNorm = 2.0591, lr_0 = 6.8951e-04
Loss = 1.5637e-01, PNorm = 44.0125, GNorm = 0.6560, lr_0 = 6.6915e-04
Validation rmse = 0.134240
Validation r2 = 0.854628
Validation mse = 0.018020
Epoch 10
Loss = 1.4550e-01, PNorm = 44.0418, GNorm = 4.1149, lr_0 = 6.4938e-04
Loss = 1.3796e-01, PNorm = 44.0588, GNorm = 1.7313, lr_0 = 6.3020e-04
Validation rmse = 0.142472
Validation r2 = 0.836252
Validation mse = 0.020298
Epoch 11
Loss = 1.3503e-01, PNorm = 44.0796, GNorm = 1.5002, lr_0 = 6.0976e-04
Validation rmse = 0.132909
Validation r2 = 0.857496
Validation mse = 0.017665
Epoch 12
Loss = 1.0176e-01, PNorm = 44.0982, GNorm = 1.0763, lr_0 = 5.9175e-04
Loss = 1.3894e-01, PNorm = 44.1160, GNorm = 4.4864, lr_0 = 5.7427e-04
Validation rmse = 0.122396
Validation r2 = 0.879149
Validation mse = 0.014981
Epoch 13
Loss = 1.3495e-01, PNorm = 44.1334, GNorm = 2.7338, lr_0 = 5.5564e-04
Loss = 1.2217e-01, PNorm = 44.1501, GNorm = 1.2346, lr_0 = 5.3923e-04
Validation rmse = 0.129861
Validation r2 = 0.863957
Validation mse = 0.016864
Epoch 14
Loss = 1.2301e-01, PNorm = 44.1677, GNorm = 1.2786, lr_0 = 5.2330e-04
Validation rmse = 0.116533
Validation r2 = 0.890450
Validation mse = 0.013580
Epoch 15
Loss = 1.0605e-01, PNorm = 44.1789, GNorm = 1.2696, lr_0 = 5.0632e-04
Loss = 1.2256e-01, PNorm = 44.1937, GNorm = 1.7985, lr_0 = 4.9137e-04
Validation rmse = 0.119207
Validation r2 = 0.885364
Validation mse = 0.014210
Epoch 16
Loss = 1.0905e-01, PNorm = 44.2089, GNorm = 0.6503, lr_0 = 4.7685e-04
Loss = 1.1295e-01, PNorm = 44.2209, GNorm = 2.9974, lr_0 = 4.6277e-04
Loss = 1.8639e-01, PNorm = 44.2217, GNorm = 4.0850, lr_0 = 4.6138e-04
Validation rmse = 0.125059
Validation r2 = 0.873832
Validation mse = 0.015640
Epoch 17
Loss = 1.1395e-01, PNorm = 44.2333, GNorm = 2.0689, lr_0 = 4.4776e-04
Validation rmse = 0.116615
Validation r2 = 0.890294
Validation mse = 0.013599
Epoch 18
Loss = 1.1941e-01, PNorm = 44.2472, GNorm = 0.8431, lr_0 = 4.3453e-04
Loss = 1.1266e-01, PNorm = 44.2590, GNorm = 2.1346, lr_0 = 4.2170e-04
Validation rmse = 0.128389
Validation r2 = 0.867024
Validation mse = 0.016484
Epoch 19
Loss = 1.0914e-01, PNorm = 44.2754, GNorm = 2.2416, lr_0 = 4.0802e-04
Loss = 1.1648e-01, PNorm = 44.2875, GNorm = 4.3138, lr_0 = 3.9596e-04
Validation rmse = 0.112171
Validation r2 = 0.898498
Validation mse = 0.012582
Epoch 20
Loss = 1.3175e-01, PNorm = 44.2989, GNorm = 3.5684, lr_0 = 3.8427e-04
Validation rmse = 0.118255
Validation r2 = 0.887187
Validation mse = 0.013984
Epoch 21
Loss = 1.2617e-01, PNorm = 44.3123, GNorm = 1.9191, lr_0 = 3.7180e-04
Loss = 9.1669e-02, PNorm = 44.3229, GNorm = 1.6559, lr_0 = 3.6082e-04
Validation rmse = 0.116586
Validation r2 = 0.890349
Validation mse = 0.013592
Epoch 22
Loss = 9.7399e-02, PNorm = 44.3354, GNorm = 0.7329, lr_0 = 3.5016e-04
Validation rmse = 0.111209
Validation r2 = 0.900230
Validation mse = 0.012367
Epoch 23
Loss = 7.2857e-02, PNorm = 44.3451, GNorm = 0.7052, lr_0 = 3.3880e-04
Loss = 1.0521e-01, PNorm = 44.3529, GNorm = 0.8465, lr_0 = 3.2880e-04
Validation rmse = 0.123297
Validation r2 = 0.877362
Validation mse = 0.015202
Epoch 24
Loss = 1.1098e-01, PNorm = 44.3613, GNorm = 0.8706, lr_0 = 3.1908e-04
Loss = 8.9257e-02, PNorm = 44.3716, GNorm = 1.2688, lr_0 = 3.0966e-04
Validation rmse = 0.117073
Validation r2 = 0.889432
Validation mse = 0.013706
Epoch 25
Loss = 1.0468e-01, PNorm = 44.3831, GNorm = 2.6915, lr_0 = 2.9961e-04
Validation rmse = 0.122851
Validation r2 = 0.878248
Validation mse = 0.015092
Epoch 26
Loss = 1.1273e-01, PNorm = 44.3913, GNorm = 1.8513, lr_0 = 2.9076e-04
Loss = 9.1921e-02, PNorm = 44.3979, GNorm = 3.6766, lr_0 = 2.8218e-04
Validation rmse = 0.122481
Validation r2 = 0.878980
Validation mse = 0.015002
Epoch 27
Loss = 1.1459e-01, PNorm = 44.4072, GNorm = 0.6919, lr_0 = 2.7302e-04
Loss = 8.5839e-02, PNorm = 44.4154, GNorm = 1.1745, lr_0 = 2.6496e-04
Validation rmse = 0.117377
Validation r2 = 0.888856
Validation mse = 0.013777
Epoch 28
Loss = 9.3235e-02, PNorm = 44.4229, GNorm = 1.2095, lr_0 = 2.5713e-04
Validation rmse = 0.119109
Validation r2 = 0.885552
Validation mse = 0.014187
Epoch 29
Loss = 8.1710e-02, PNorm = 44.4322, GNorm = 1.3779, lr_0 = 2.4879e-04
Loss = 8.7794e-02, PNorm = 44.4389, GNorm = 0.7936, lr_0 = 2.4144e-04
Validation rmse = 0.112236
Validation r2 = 0.898379
Validation mse = 0.012597
Epoch 30
Loss = 7.7391e-02, PNorm = 44.4468, GNorm = 0.9054, lr_0 = 2.3431e-04
Loss = 8.7749e-02, PNorm = 44.4530, GNorm = 0.8139, lr_0 = 2.2739e-04
Validation rmse = 0.110946
Validation r2 = 0.900701
Validation mse = 0.012309
Epoch 31
Loss = 7.1589e-02, PNorm = 44.4604, GNorm = 1.6001, lr_0 = 2.2001e-04
Validation rmse = 0.124907
Validation r2 = 0.874140
Validation mse = 0.015602
Epoch 32
Loss = 7.6194e-02, PNorm = 44.4677, GNorm = 3.0307, lr_0 = 2.1351e-04
Loss = 8.3150e-02, PNorm = 44.4746, GNorm = 1.3912, lr_0 = 2.0721e-04
Validation rmse = 0.111347
Validation r2 = 0.899982
Validation mse = 0.012398
Epoch 33
Loss = 9.8256e-02, PNorm = 44.4824, GNorm = 4.9072, lr_0 = 2.0049e-04
Loss = 9.2009e-02, PNorm = 44.4898, GNorm = 0.6435, lr_0 = 1.9456e-04
Validation rmse = 0.107423
Validation r2 = 0.906908
Validation mse = 0.011540
Epoch 34
Loss = 9.5851e-02, PNorm = 44.4962, GNorm = 2.2286, lr_0 = 1.8882e-04
Validation rmse = 0.116598
Validation r2 = 0.890326
Validation mse = 0.013595
Epoch 35
Loss = 8.0073e-02, PNorm = 44.5040, GNorm = 2.2265, lr_0 = 1.8269e-04
Loss = 7.6092e-02, PNorm = 44.5109, GNorm = 0.8538, lr_0 = 1.7730e-04
Validation rmse = 0.115360
Validation r2 = 0.892644
Validation mse = 0.013308
Epoch 36
Loss = 7.6379e-02, PNorm = 44.5179, GNorm = 1.0990, lr_0 = 1.7206e-04
Loss = 8.2043e-02, PNorm = 44.5239, GNorm = 1.0102, lr_0 = 1.6698e-04
Loss = 1.0109e-01, PNorm = 44.5245, GNorm = 1.6655, lr_0 = 1.6648e-04
Validation rmse = 0.118163
Validation r2 = 0.887363
Validation mse = 0.013962
Epoch 37
Loss = 7.5316e-02, PNorm = 44.5299, GNorm = 1.5369, lr_0 = 1.6156e-04
Validation rmse = 0.115817
Validation r2 = 0.891791
Validation mse = 0.013414
Epoch 38
Loss = 1.0011e-01, PNorm = 44.5369, GNorm = 1.6836, lr_0 = 1.5679e-04
Loss = 7.5761e-02, PNorm = 44.5415, GNorm = 0.8664, lr_0 = 1.5216e-04
Validation rmse = 0.108419
Validation r2 = 0.905174
Validation mse = 0.011755
Epoch 39
Loss = 7.1648e-02, PNorm = 44.5469, GNorm = 0.8524, lr_0 = 1.4722e-04
Loss = 7.7932e-02, PNorm = 44.5511, GNorm = 1.9057, lr_0 = 1.4287e-04
Validation rmse = 0.107213
Validation r2 = 0.907272
Validation mse = 0.011495
Epoch 40
Loss = 7.6770e-02, PNorm = 44.5564, GNorm = 1.0935, lr_0 = 1.3865e-04
Validation rmse = 0.109259
Validation r2 = 0.903699
Validation mse = 0.011937
Epoch 41
Loss = 7.3272e-02, PNorm = 44.5615, GNorm = 1.6302, lr_0 = 1.3415e-04
Loss = 7.2897e-02, PNorm = 44.5667, GNorm = 1.9114, lr_0 = 1.3019e-04
Validation rmse = 0.116103
Validation r2 = 0.891257
Validation mse = 0.013480
Epoch 42
Loss = 6.8645e-02, PNorm = 44.5705, GNorm = 3.2810, lr_0 = 1.2635e-04
Validation rmse = 0.108783
Validation r2 = 0.904537
Validation mse = 0.011834
Epoch 43
Loss = 6.1238e-02, PNorm = 44.5753, GNorm = 0.6866, lr_0 = 1.2225e-04
Loss = 7.4844e-02, PNorm = 44.5802, GNorm = 1.0085, lr_0 = 1.1864e-04
Validation rmse = 0.109996
Validation r2 = 0.902394
Validation mse = 0.012099
Epoch 44
Loss = 5.3577e-02, PNorm = 44.5843, GNorm = 1.5469, lr_0 = 1.1513e-04
Loss = 7.6003e-02, PNorm = 44.5885, GNorm = 1.2263, lr_0 = 1.1173e-04
Validation rmse = 0.109940
Validation r2 = 0.902494
Validation mse = 0.012087
Epoch 45
Loss = 8.1757e-02, PNorm = 44.5932, GNorm = 2.6017, lr_0 = 1.0811e-04
Validation rmse = 0.106654
Validation r2 = 0.908237
Validation mse = 0.011375
Epoch 46
Loss = 8.1317e-02, PNorm = 44.5973, GNorm = 0.5415, lr_0 = 1.0491e-04
Loss = 6.8257e-02, PNorm = 44.6019, GNorm = 0.8556, lr_0 = 1.0182e-04
Validation rmse = 0.105763
Validation r2 = 0.909763
Validation mse = 0.011186
Epoch 47
Loss = 7.0779e-02, PNorm = 44.6055, GNorm = 1.0853, lr_0 = 1.0000e-04
Loss = 7.2215e-02, PNorm = 44.6091, GNorm = 0.6335, lr_0 = 1.0000e-04
Validation rmse = 0.111202
Validation r2 = 0.900243
Validation mse = 0.012366
Epoch 48
Loss = 6.8377e-02, PNorm = 44.6127, GNorm = 1.0331, lr_0 = 1.0000e-04
Validation rmse = 0.106629
Validation r2 = 0.908278
Validation mse = 0.011370
Epoch 49
Loss = 6.0500e-02, PNorm = 44.6165, GNorm = 0.5867, lr_0 = 1.0000e-04
Loss = 7.4109e-02, PNorm = 44.6197, GNorm = 1.4934, lr_0 = 1.0000e-04
Validation rmse = 0.109492
Validation r2 = 0.903288
Validation mse = 0.011988
Model 0 best validation rmse = 0.105763 on epoch 46
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.125604
Model 0 test r2 = 0.850484
Model 0 test mse = 0.015776
Ensemble test rmse = 0.125604
Ensemble test r2 = 0.850484
Ensemble test mse = 0.015776
Fold 2
Splitting data with seed 2
Total size = 1,032 | train size = 825 | val size = 103 | test size = 104
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.9293e-01, PNorm = 43.2620, GNorm = 1.7941, lr_0 = 4.0937e-04
Validation rmse = 0.281746
Validation r2 = 0.356242
Validation mse = 0.079381
Epoch 1
Loss = 6.8249e-01, PNorm = 43.2968, GNorm = 3.0837, lr_0 = 7.1875e-04
Loss = 6.2179e-01, PNorm = 43.3488, GNorm = 3.0535, lr_0 = 1.0000e-03
Validation rmse = 0.252420
Validation r2 = 0.483280
Validation mse = 0.063716
Epoch 2
Loss = 5.3076e-01, PNorm = 43.4178, GNorm = 5.0148, lr_0 = 9.7046e-04
Validation rmse = 0.195283
Validation r2 = 0.690731
Validation mse = 0.038136
Epoch 3
Loss = 3.5266e-01, PNorm = 43.5025, GNorm = 2.7703, lr_0 = 9.3898e-04
Loss = 3.4318e-01, PNorm = 43.5764, GNorm = 7.8059, lr_0 = 9.1125e-04
Validation rmse = 0.175312
Validation r2 = 0.750753
Validation mse = 0.030734
Epoch 4
Loss = 2.5290e-01, PNorm = 43.6364, GNorm = 1.9494, lr_0 = 8.8433e-04
Loss = 2.7565e-01, PNorm = 43.6871, GNorm = 1.0731, lr_0 = 8.5821e-04
Validation rmse = 0.213354
Validation r2 = 0.630847
Validation mse = 0.045520
Epoch 5
Loss = 2.4713e-01, PNorm = 43.7411, GNorm = 3.8019, lr_0 = 8.3037e-04
Validation rmse = 0.158320
Validation r2 = 0.796727
Validation mse = 0.025065
Epoch 6
Loss = 2.0565e-01, PNorm = 43.7809, GNorm = 1.3308, lr_0 = 8.0584e-04
Loss = 1.7782e-01, PNorm = 43.8200, GNorm = 3.0205, lr_0 = 7.8204e-04
Validation rmse = 0.140197
Validation r2 = 0.840602
Validation mse = 0.019655
Epoch 7
Loss = 1.4738e-01, PNorm = 43.8538, GNorm = 2.2996, lr_0 = 7.5667e-04
Loss = 1.5008e-01, PNorm = 43.8781, GNorm = 3.7818, lr_0 = 7.3432e-04
Validation rmse = 0.142519
Validation r2 = 0.835279
Validation mse = 0.020312
Epoch 8
Loss = 2.0824e-01, PNorm = 43.9052, GNorm = 1.4207, lr_0 = 7.1263e-04
Validation rmse = 0.133854
Validation r2 = 0.854700
Validation mse = 0.017917
Epoch 9
Loss = 1.3732e-01, PNorm = 43.9404, GNorm = 1.6409, lr_0 = 6.8951e-04
Loss = 1.3672e-01, PNorm = 43.9633, GNorm = 2.5667, lr_0 = 6.6915e-04
Validation rmse = 0.139382
Validation r2 = 0.842450
Validation mse = 0.019427
Epoch 10
Loss = 1.4486e-01, PNorm = 43.9903, GNorm = 4.1190, lr_0 = 6.4938e-04
Loss = 1.5737e-01, PNorm = 44.0129, GNorm = 3.3941, lr_0 = 6.3020e-04
Validation rmse = 0.131768
Validation r2 = 0.859193
Validation mse = 0.017363
Epoch 11
Loss = 1.2593e-01, PNorm = 44.0365, GNorm = 4.0007, lr_0 = 6.0976e-04
Validation rmse = 0.128062
Validation r2 = 0.867001
Validation mse = 0.016400
Epoch 12
Loss = 1.0957e-01, PNorm = 44.0553, GNorm = 1.5071, lr_0 = 5.9175e-04
Loss = 1.2210e-01, PNorm = 44.0705, GNorm = 2.0554, lr_0 = 5.7427e-04
Validation rmse = 0.128897
Validation r2 = 0.865262
Validation mse = 0.016614
Epoch 13
Loss = 1.1874e-01, PNorm = 44.0840, GNorm = 3.9643, lr_0 = 5.5564e-04
Loss = 1.3624e-01, PNorm = 44.1056, GNorm = 2.1603, lr_0 = 5.3923e-04
Validation rmse = 0.130680
Validation r2 = 0.861509
Validation mse = 0.017077
Epoch 14
Loss = 1.2005e-01, PNorm = 44.1258, GNorm = 2.1909, lr_0 = 5.2330e-04
Validation rmse = 0.126696
Validation r2 = 0.869824
Validation mse = 0.016052
Epoch 15
Loss = 1.1473e-01, PNorm = 44.1413, GNorm = 0.8148, lr_0 = 5.0632e-04
Loss = 1.0953e-01, PNorm = 44.1563, GNorm = 1.8246, lr_0 = 4.9137e-04
Validation rmse = 0.120846
Validation r2 = 0.881569
Validation mse = 0.014604
Epoch 16
Loss = 9.9420e-02, PNorm = 44.1682, GNorm = 2.0622, lr_0 = 4.7685e-04
Loss = 1.1523e-01, PNorm = 44.1807, GNorm = 4.7130, lr_0 = 4.6277e-04
Loss = 1.2939e-01, PNorm = 44.1818, GNorm = 1.4304, lr_0 = 4.6138e-04
Validation rmse = 0.124603
Validation r2 = 0.874090
Validation mse = 0.015526
Epoch 17
Loss = 1.0415e-01, PNorm = 44.1951, GNorm = 1.9756, lr_0 = 4.4776e-04
Validation rmse = 0.137583
Validation r2 = 0.846491
Validation mse = 0.018929
Epoch 18
Loss = 1.0420e-01, PNorm = 44.2077, GNorm = 0.7709, lr_0 = 4.3453e-04
Loss = 9.5584e-02, PNorm = 44.2205, GNorm = 0.5942, lr_0 = 4.2170e-04
Validation rmse = 0.126815
Validation r2 = 0.869579
Validation mse = 0.016082
Epoch 19
Loss = 1.0263e-01, PNorm = 44.2332, GNorm = 1.3647, lr_0 = 4.0802e-04
Loss = 9.7101e-02, PNorm = 44.2452, GNorm = 1.4796, lr_0 = 3.9596e-04
Validation rmse = 0.126086
Validation r2 = 0.871074
Validation mse = 0.015898
Epoch 20
Loss = 8.6098e-02, PNorm = 44.2576, GNorm = 0.8752, lr_0 = 3.8427e-04
Validation rmse = 0.135425
Validation r2 = 0.851268
Validation mse = 0.018340
Epoch 21
Loss = 8.5814e-02, PNorm = 44.2684, GNorm = 2.2217, lr_0 = 3.7180e-04
Loss = 1.1047e-01, PNorm = 44.2776, GNorm = 2.8735, lr_0 = 3.6082e-04
Validation rmse = 0.126090
Validation r2 = 0.871067
Validation mse = 0.015899
Epoch 22
Loss = 9.9122e-02, PNorm = 44.2900, GNorm = 1.2095, lr_0 = 3.5016e-04
Validation rmse = 0.130901
Validation r2 = 0.861040
Validation mse = 0.017135
Epoch 23
Loss = 1.0236e-01, PNorm = 44.2996, GNorm = 2.2264, lr_0 = 3.3880e-04
Loss = 1.0077e-01, PNorm = 44.3094, GNorm = 3.9266, lr_0 = 3.2880e-04
Validation rmse = 0.126323
Validation r2 = 0.870589
Validation mse = 0.015958
Epoch 24
Loss = 9.3552e-02, PNorm = 44.3188, GNorm = 1.6816, lr_0 = 3.1908e-04
Loss = 8.4027e-02, PNorm = 44.3280, GNorm = 2.5787, lr_0 = 3.0966e-04
Validation rmse = 0.124749
Validation r2 = 0.873794
Validation mse = 0.015562
Epoch 25
Loss = 8.8800e-02, PNorm = 44.3399, GNorm = 2.2041, lr_0 = 2.9961e-04
Validation rmse = 0.123102
Validation r2 = 0.877105
Validation mse = 0.015154
Epoch 26
Loss = 7.8580e-02, PNorm = 44.3474, GNorm = 1.5631, lr_0 = 2.9076e-04
Loss = 7.7747e-02, PNorm = 44.3553, GNorm = 0.8821, lr_0 = 2.8218e-04
Validation rmse = 0.123220
Validation r2 = 0.876869
Validation mse = 0.015183
Epoch 27
Loss = 8.0625e-02, PNorm = 44.3647, GNorm = 0.9876, lr_0 = 2.7302e-04
Loss = 7.6682e-02, PNorm = 44.3727, GNorm = 0.7807, lr_0 = 2.6496e-04
Validation rmse = 0.123313
Validation r2 = 0.876683
Validation mse = 0.015206
Epoch 28
Loss = 8.7608e-02, PNorm = 44.3779, GNorm = 0.9692, lr_0 = 2.5713e-04
Validation rmse = 0.127356
Validation r2 = 0.868464
Validation mse = 0.016220
Epoch 29
Loss = 8.0384e-02, PNorm = 44.3867, GNorm = 0.7065, lr_0 = 2.4879e-04
Loss = 7.0873e-02, PNorm = 44.3953, GNorm = 0.9528, lr_0 = 2.4144e-04
Validation rmse = 0.126660
Validation r2 = 0.869897
Validation mse = 0.016043
Epoch 30
Loss = 7.9986e-02, PNorm = 44.4030, GNorm = 2.4756, lr_0 = 2.3431e-04
Loss = 8.0834e-02, PNorm = 44.4094, GNorm = 0.9166, lr_0 = 2.2739e-04
Validation rmse = 0.121455
Validation r2 = 0.880371
Validation mse = 0.014751
Epoch 31
Loss = 6.8103e-02, PNorm = 44.4181, GNorm = 0.9392, lr_0 = 2.2001e-04
Validation rmse = 0.119048
Validation r2 = 0.885066
Validation mse = 0.014172
Epoch 32
Loss = 5.8533e-02, PNorm = 44.4246, GNorm = 0.9944, lr_0 = 2.1351e-04
Loss = 8.3674e-02, PNorm = 44.4314, GNorm = 0.6062, lr_0 = 2.0721e-04
Validation rmse = 0.115535
Validation r2 = 0.891749
Validation mse = 0.013348
Epoch 33
Loss = 7.7765e-02, PNorm = 44.4388, GNorm = 1.0842, lr_0 = 2.0049e-04
Loss = 7.3523e-02, PNorm = 44.4453, GNorm = 1.2697, lr_0 = 1.9456e-04
Validation rmse = 0.128534
Validation r2 = 0.866020
Validation mse = 0.016521
Epoch 34
Loss = 7.5532e-02, PNorm = 44.4507, GNorm = 1.9133, lr_0 = 1.8882e-04
Validation rmse = 0.116950
Validation r2 = 0.889080
Validation mse = 0.013677
Epoch 35
Loss = 6.6758e-02, PNorm = 44.4567, GNorm = 0.4834, lr_0 = 1.8269e-04
Loss = 7.1051e-02, PNorm = 44.4627, GNorm = 1.3117, lr_0 = 1.7730e-04
Validation rmse = 0.123679
Validation r2 = 0.875950
Validation mse = 0.015296
Epoch 36
Loss = 6.5154e-02, PNorm = 44.4693, GNorm = 0.9470, lr_0 = 1.7206e-04
Loss = 7.6195e-02, PNorm = 44.4750, GNorm = 1.2980, lr_0 = 1.6698e-04
Loss = 7.5365e-02, PNorm = 44.4758, GNorm = 1.0058, lr_0 = 1.6648e-04
Validation rmse = 0.115473
Validation r2 = 0.891866
Validation mse = 0.013334
Epoch 37
Loss = 7.2899e-02, PNorm = 44.4816, GNorm = 0.8286, lr_0 = 1.6156e-04
Validation rmse = 0.123397
Validation r2 = 0.876514
Validation mse = 0.015227
Epoch 38
Loss = 5.7459e-02, PNorm = 44.4870, GNorm = 1.2539, lr_0 = 1.5679e-04
Loss = 7.9362e-02, PNorm = 44.4933, GNorm = 3.8711, lr_0 = 1.5216e-04
Validation rmse = 0.127295
Validation r2 = 0.868590
Validation mse = 0.016204
Epoch 39
Loss = 6.7926e-02, PNorm = 44.4981, GNorm = 0.8699, lr_0 = 1.4722e-04
Loss = 7.4513e-02, PNorm = 44.5023, GNorm = 2.5300, lr_0 = 1.4287e-04
Validation rmse = 0.117532
Validation r2 = 0.887974
Validation mse = 0.013814
Epoch 40
Loss = 6.8814e-02, PNorm = 44.5073, GNorm = 2.6458, lr_0 = 1.3865e-04
Validation rmse = 0.134078
Validation r2 = 0.854213
Validation mse = 0.017977
Epoch 41
Loss = 7.3985e-02, PNorm = 44.5133, GNorm = 1.6836, lr_0 = 1.3415e-04
Loss = 8.4866e-02, PNorm = 44.5170, GNorm = 2.7431, lr_0 = 1.3019e-04
Validation rmse = 0.119504
Validation r2 = 0.884183
Validation mse = 0.014281
Epoch 42
Loss = 6.2679e-02, PNorm = 44.5213, GNorm = 3.3328, lr_0 = 1.2635e-04
Validation rmse = 0.123636
Validation r2 = 0.876036
Validation mse = 0.015286
Epoch 43
Loss = 5.6154e-02, PNorm = 44.5258, GNorm = 2.1916, lr_0 = 1.2225e-04
Loss = 6.5946e-02, PNorm = 44.5304, GNorm = 1.1106, lr_0 = 1.1864e-04
Validation rmse = 0.119082
Validation r2 = 0.884999
Validation mse = 0.014181
Epoch 44
Loss = 6.8629e-02, PNorm = 44.5344, GNorm = 2.0698, lr_0 = 1.1513e-04
Loss = 6.0967e-02, PNorm = 44.5387, GNorm = 0.8527, lr_0 = 1.1173e-04
Validation rmse = 0.116184
Validation r2 = 0.890529
Validation mse = 0.013499
Epoch 45
Loss = 6.8657e-02, PNorm = 44.5426, GNorm = 0.7778, lr_0 = 1.0811e-04
Validation rmse = 0.120204
Validation r2 = 0.882822
Validation mse = 0.014449
Epoch 46
Loss = 6.0380e-02, PNorm = 44.5468, GNorm = 1.5835, lr_0 = 1.0491e-04
Loss = 5.8724e-02, PNorm = 44.5502, GNorm = 0.7299, lr_0 = 1.0182e-04
Validation rmse = 0.116509
Validation r2 = 0.889916
Validation mse = 0.013574
Epoch 47
Loss = 5.6301e-02, PNorm = 44.5537, GNorm = 0.5817, lr_0 = 1.0000e-04
Loss = 6.5213e-02, PNorm = 44.5567, GNorm = 1.2959, lr_0 = 1.0000e-04
Validation rmse = 0.117250
Validation r2 = 0.888510
Validation mse = 0.013748
Epoch 48
Loss = 6.6814e-02, PNorm = 44.5607, GNorm = 0.8308, lr_0 = 1.0000e-04
Validation rmse = 0.126341
Validation r2 = 0.870552
Validation mse = 0.015962
Epoch 49
Loss = 6.2067e-02, PNorm = 44.5643, GNorm = 2.5368, lr_0 = 1.0000e-04
Loss = 6.3413e-02, PNorm = 44.5682, GNorm = 1.9320, lr_0 = 1.0000e-04
Validation rmse = 0.117963
Validation r2 = 0.887150
Validation mse = 0.013915
Model 0 best validation rmse = 0.115473 on epoch 36
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.136780
Model 0 test r2 = 0.833273
Model 0 test mse = 0.018709
Ensemble test rmse = 0.136780
Ensemble test r2 = 0.833273
Ensemble test mse = 0.018709
Fold 3
Splitting data with seed 3
Total size = 1,032 | train size = 825 | val size = 103 | test size = 104
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 1.0016e+00, PNorm = 43.2636, GNorm = 2.7533, lr_0 = 4.0937e-04
Validation rmse = 0.303443
Validation r2 = 0.272602
Validation mse = 0.092077
Epoch 1
Loss = 7.2198e-01, PNorm = 43.2882, GNorm = 4.8536, lr_0 = 7.1875e-04
Loss = 6.5943e-01, PNorm = 43.3435, GNorm = 7.8051, lr_0 = 1.0000e-03
Validation rmse = 0.264383
Validation r2 = 0.447814
Validation mse = 0.069898
Epoch 2
Loss = 6.8584e-01, PNorm = 43.4031, GNorm = 1.8594, lr_0 = 9.7046e-04
Validation rmse = 0.257967
Validation r2 = 0.474288
Validation mse = 0.066547
Epoch 3
Loss = 4.5381e-01, PNorm = 43.4953, GNorm = 0.7778, lr_0 = 9.3898e-04
Loss = 4.1620e-01, PNorm = 43.5641, GNorm = 1.0577, lr_0 = 9.1125e-04
Validation rmse = 0.253467
Validation r2 = 0.492469
Validation mse = 0.064246
Epoch 4
Loss = 3.0862e-01, PNorm = 43.6313, GNorm = 3.2963, lr_0 = 8.8433e-04
Loss = 2.8490e-01, PNorm = 43.6907, GNorm = 2.0375, lr_0 = 8.5821e-04
Validation rmse = 0.217651
Validation r2 = 0.625769
Validation mse = 0.047372
Epoch 5
Loss = 2.2238e-01, PNorm = 43.7557, GNorm = 2.2963, lr_0 = 8.3037e-04
Validation rmse = 0.195514
Validation r2 = 0.698021
Validation mse = 0.038226
Epoch 6
Loss = 2.0994e-01, PNorm = 43.8017, GNorm = 3.4640, lr_0 = 8.0584e-04
Loss = 1.9119e-01, PNorm = 43.8366, GNorm = 0.8365, lr_0 = 7.8204e-04
Validation rmse = 0.198416
Validation r2 = 0.688992
Validation mse = 0.039369
Epoch 7
Loss = 1.9942e-01, PNorm = 43.8705, GNorm = 0.7156, lr_0 = 7.5667e-04
Loss = 1.7402e-01, PNorm = 43.9026, GNorm = 3.6218, lr_0 = 7.3432e-04
Validation rmse = 0.198775
Validation r2 = 0.687866
Validation mse = 0.039511
Epoch 8
Loss = 1.6204e-01, PNorm = 43.9302, GNorm = 0.8962, lr_0 = 7.1263e-04
Validation rmse = 0.200181
Validation r2 = 0.683433
Validation mse = 0.040073
Epoch 9
Loss = 2.4550e-01, PNorm = 43.9566, GNorm = 5.4843, lr_0 = 6.8951e-04
Loss = 1.6885e-01, PNorm = 43.9827, GNorm = 2.3654, lr_0 = 6.6915e-04
Validation rmse = 0.194239
Validation r2 = 0.701949
Validation mse = 0.037729
Epoch 10
Loss = 1.2240e-01, PNorm = 44.0016, GNorm = 2.0496, lr_0 = 6.4938e-04
Loss = 1.3798e-01, PNorm = 44.0246, GNorm = 0.7960, lr_0 = 6.3020e-04
Validation rmse = 0.190372
Validation r2 = 0.713699
Validation mse = 0.036241
Epoch 11
Loss = 1.1620e-01, PNorm = 44.0432, GNorm = 1.5683, lr_0 = 6.0976e-04
Validation rmse = 0.174434
Validation r2 = 0.759628
Validation mse = 0.030427
Epoch 12
Loss = 1.1940e-01, PNorm = 44.0588, GNorm = 2.1189, lr_0 = 5.9175e-04
Loss = 1.4271e-01, PNorm = 44.0712, GNorm = 1.2815, lr_0 = 5.7427e-04
Validation rmse = 0.172134
Validation r2 = 0.765928
Validation mse = 0.029630
Epoch 13
Loss = 1.2491e-01, PNorm = 44.0874, GNorm = 1.8639, lr_0 = 5.5564e-04
Loss = 1.1189e-01, PNorm = 44.1044, GNorm = 0.6023, lr_0 = 5.3923e-04
Validation rmse = 0.184313
Validation r2 = 0.731631
Validation mse = 0.033971
Epoch 14
Loss = 1.1525e-01, PNorm = 44.1206, GNorm = 1.7301, lr_0 = 5.2330e-04
Validation rmse = 0.179765
Validation r2 = 0.744713
Validation mse = 0.032315
Epoch 15
Loss = 9.1369e-02, PNorm = 44.1308, GNorm = 1.0488, lr_0 = 5.0632e-04
Loss = 1.1114e-01, PNorm = 44.1414, GNorm = 1.1204, lr_0 = 4.9137e-04
Validation rmse = 0.172436
Validation r2 = 0.765103
Validation mse = 0.029734
Epoch 16
Loss = 1.0274e-01, PNorm = 44.1536, GNorm = 0.7888, lr_0 = 4.7685e-04
Loss = 1.1223e-01, PNorm = 44.1658, GNorm = 0.8267, lr_0 = 4.6277e-04
Loss = 1.9935e-01, PNorm = 44.1671, GNorm = 1.5769, lr_0 = 4.6138e-04
Validation rmse = 0.170156
Validation r2 = 0.771275
Validation mse = 0.028953
Epoch 17
Loss = 1.0670e-01, PNorm = 44.1834, GNorm = 1.3392, lr_0 = 4.4776e-04
Validation rmse = 0.166328
Validation r2 = 0.781451
Validation mse = 0.027665
Epoch 18
Loss = 9.6506e-02, PNorm = 44.1941, GNorm = 1.2320, lr_0 = 4.3453e-04
Loss = 9.9828e-02, PNorm = 44.2051, GNorm = 3.3751, lr_0 = 4.2170e-04
Validation rmse = 0.174066
Validation r2 = 0.760643
Validation mse = 0.030299
Epoch 19
Loss = 1.0499e-01, PNorm = 44.2183, GNorm = 2.2460, lr_0 = 4.0802e-04
Loss = 1.0639e-01, PNorm = 44.2294, GNorm = 1.3836, lr_0 = 3.9596e-04
Validation rmse = 0.170479
Validation r2 = 0.770405
Validation mse = 0.029063
Epoch 20
Loss = 9.2841e-02, PNorm = 44.2424, GNorm = 0.8993, lr_0 = 3.8427e-04
Validation rmse = 0.171022
Validation r2 = 0.768942
Validation mse = 0.029248
Epoch 21
Loss = 9.3614e-02, PNorm = 44.2532, GNorm = 2.2003, lr_0 = 3.7180e-04
Loss = 8.8735e-02, PNorm = 44.2629, GNorm = 1.5294, lr_0 = 3.6082e-04
Validation rmse = 0.171140
Validation r2 = 0.768623
Validation mse = 0.029289
Epoch 22
Loss = 9.5054e-02, PNorm = 44.2758, GNorm = 1.4746, lr_0 = 3.5016e-04
Validation rmse = 0.167237
Validation r2 = 0.779055
Validation mse = 0.027968
Epoch 23
Loss = 5.4239e-02, PNorm = 44.2881, GNorm = 1.4259, lr_0 = 3.3880e-04
Loss = 9.8504e-02, PNorm = 44.2981, GNorm = 0.6870, lr_0 = 3.2880e-04
Validation rmse = 0.172549
Validation r2 = 0.764797
Validation mse = 0.029773
Epoch 24
Loss = 8.5778e-02, PNorm = 44.3089, GNorm = 1.9601, lr_0 = 3.1908e-04
Loss = 9.0526e-02, PNorm = 44.3188, GNorm = 0.9512, lr_0 = 3.0966e-04
Validation rmse = 0.165353
Validation r2 = 0.784004
Validation mse = 0.027342
Epoch 25
Loss = 1.1730e-01, PNorm = 44.3324, GNorm = 1.7147, lr_0 = 2.9961e-04
Validation rmse = 0.173475
Validation r2 = 0.762267
Validation mse = 0.030093
Epoch 26
Loss = 9.1439e-02, PNorm = 44.3447, GNorm = 1.3308, lr_0 = 2.9076e-04
Loss = 9.2278e-02, PNorm = 44.3553, GNorm = 2.4985, lr_0 = 2.8218e-04
Validation rmse = 0.171327
Validation r2 = 0.768115
Validation mse = 0.029353
Epoch 27
Loss = 7.7603e-02, PNorm = 44.3659, GNorm = 1.1726, lr_0 = 2.7302e-04
Loss = 8.3411e-02, PNorm = 44.3738, GNorm = 0.9991, lr_0 = 2.6496e-04
Validation rmse = 0.165237
Validation r2 = 0.784308
Validation mse = 0.027303
Epoch 28
Loss = 8.1541e-02, PNorm = 44.3802, GNorm = 0.9445, lr_0 = 2.5713e-04
Validation rmse = 0.173385
Validation r2 = 0.762513
Validation mse = 0.030062
Epoch 29
Loss = 1.1145e-01, PNorm = 44.3888, GNorm = 3.2279, lr_0 = 2.4879e-04
Loss = 9.5810e-02, PNorm = 44.3992, GNorm = 3.3002, lr_0 = 2.4144e-04
Validation rmse = 0.178310
Validation r2 = 0.748829
Validation mse = 0.031794
Epoch 30
Loss = 9.7285e-02, PNorm = 44.4094, GNorm = 0.9663, lr_0 = 2.3431e-04
Loss = 8.5803e-02, PNorm = 44.4181, GNorm = 1.0008, lr_0 = 2.2739e-04
Validation rmse = 0.171868
Validation r2 = 0.766649
Validation mse = 0.029539
Epoch 31
Loss = 6.9159e-02, PNorm = 44.4251, GNorm = 0.7856, lr_0 = 2.2001e-04
Validation rmse = 0.173683
Validation r2 = 0.761695
Validation mse = 0.030166
Epoch 32
Loss = 9.2573e-02, PNorm = 44.4328, GNorm = 1.2876, lr_0 = 2.1351e-04
Loss = 7.4587e-02, PNorm = 44.4401, GNorm = 1.1409, lr_0 = 2.0721e-04
Validation rmse = 0.168343
Validation r2 = 0.776123
Validation mse = 0.028339
Epoch 33
Loss = 7.8940e-02, PNorm = 44.4471, GNorm = 2.4460, lr_0 = 2.0049e-04
Loss = 6.9283e-02, PNorm = 44.4532, GNorm = 1.4414, lr_0 = 1.9456e-04
Validation rmse = 0.166554
Validation r2 = 0.780856
Validation mse = 0.027740
Epoch 34
Loss = 8.2219e-02, PNorm = 44.4604, GNorm = 2.8189, lr_0 = 1.8882e-04
Validation rmse = 0.162528
Validation r2 = 0.791322
Validation mse = 0.026415
Epoch 35
Loss = 7.3216e-02, PNorm = 44.4690, GNorm = 1.6034, lr_0 = 1.8269e-04
Loss = 7.0668e-02, PNorm = 44.4767, GNorm = 1.4129, lr_0 = 1.7730e-04
Validation rmse = 0.168530
Validation r2 = 0.775625
Validation mse = 0.028402
Epoch 36
Loss = 6.6877e-02, PNorm = 44.4818, GNorm = 1.4366, lr_0 = 1.7206e-04
Loss = 8.1210e-02, PNorm = 44.4885, GNorm = 1.0107, lr_0 = 1.6698e-04
Loss = 7.6631e-02, PNorm = 44.4892, GNorm = 1.0130, lr_0 = 1.6648e-04
Validation rmse = 0.167285
Validation r2 = 0.778928
Validation mse = 0.027984
Epoch 37
Loss = 6.5626e-02, PNorm = 44.4950, GNorm = 0.6195, lr_0 = 1.6156e-04
Validation rmse = 0.162170
Validation r2 = 0.792241
Validation mse = 0.026299
Epoch 38
Loss = 8.5927e-02, PNorm = 44.5007, GNorm = 0.7689, lr_0 = 1.5679e-04
Loss = 6.3891e-02, PNorm = 44.5065, GNorm = 0.6440, lr_0 = 1.5216e-04
Validation rmse = 0.169236
Validation r2 = 0.773743
Validation mse = 0.028641
Epoch 39
Loss = 6.8688e-02, PNorm = 44.5129, GNorm = 2.0508, lr_0 = 1.4722e-04
Loss = 6.7905e-02, PNorm = 44.5175, GNorm = 0.7455, lr_0 = 1.4287e-04
Validation rmse = 0.157025
Validation r2 = 0.805214
Validation mse = 0.024657
Epoch 40
Loss = 6.7003e-02, PNorm = 44.5233, GNorm = 0.8498, lr_0 = 1.3865e-04
Validation rmse = 0.161066
Validation r2 = 0.795061
Validation mse = 0.025942
Epoch 41
Loss = 6.1569e-02, PNorm = 44.5277, GNorm = 2.1724, lr_0 = 1.3415e-04
Loss = 6.4165e-02, PNorm = 44.5330, GNorm = 1.3117, lr_0 = 1.3019e-04
Validation rmse = 0.167633
Validation r2 = 0.778007
Validation mse = 0.028101
Epoch 42
Loss = 6.8739e-02, PNorm = 44.5377, GNorm = 1.2074, lr_0 = 1.2635e-04
Validation rmse = 0.167894
Validation r2 = 0.777316
Validation mse = 0.028188
Epoch 43
Loss = 5.2879e-02, PNorm = 44.5435, GNorm = 0.8974, lr_0 = 1.2225e-04
Loss = 7.0399e-02, PNorm = 44.5479, GNorm = 1.6731, lr_0 = 1.1864e-04
Validation rmse = 0.157718
Validation r2 = 0.803493
Validation mse = 0.024875
Epoch 44
Loss = 5.6391e-02, PNorm = 44.5523, GNorm = 1.0133, lr_0 = 1.1513e-04
Loss = 6.5371e-02, PNorm = 44.5569, GNorm = 0.9203, lr_0 = 1.1173e-04
Validation rmse = 0.165588
Validation r2 = 0.783392
Validation mse = 0.027419
Epoch 45
Loss = 6.1969e-02, PNorm = 44.5609, GNorm = 1.3730, lr_0 = 1.0811e-04
Validation rmse = 0.163041
Validation r2 = 0.790003
Validation mse = 0.026582
Epoch 46
Loss = 8.6954e-02, PNorm = 44.5655, GNorm = 1.3907, lr_0 = 1.0491e-04
Loss = 6.2223e-02, PNorm = 44.5696, GNorm = 2.1622, lr_0 = 1.0182e-04
Validation rmse = 0.161789
Validation r2 = 0.793216
Validation mse = 0.026176
Epoch 47
Loss = 6.9058e-02, PNorm = 44.5746, GNorm = 1.8143, lr_0 = 1.0000e-04
Loss = 6.3872e-02, PNorm = 44.5788, GNorm = 1.2297, lr_0 = 1.0000e-04
Validation rmse = 0.162199
Validation r2 = 0.792168
Validation mse = 0.026308
Epoch 48
Loss = 5.9832e-02, PNorm = 44.5827, GNorm = 1.3038, lr_0 = 1.0000e-04
Validation rmse = 0.165539
Validation r2 = 0.783518
Validation mse = 0.027403
Epoch 49
Loss = 4.2296e-02, PNorm = 44.5873, GNorm = 0.6572, lr_0 = 1.0000e-04
Loss = 5.3449e-02, PNorm = 44.5913, GNorm = 0.8854, lr_0 = 1.0000e-04
Validation rmse = 0.161988
Validation r2 = 0.792707
Validation mse = 0.026240
Model 0 best validation rmse = 0.157025 on epoch 39
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.112737
Model 0 test r2 = 0.860350
Model 0 test mse = 0.012710
Ensemble test rmse = 0.112737
Ensemble test r2 = 0.860350
Ensemble test mse = 0.012710
Fold 4
Splitting data with seed 4
Total size = 1,032 | train size = 825 | val size = 103 | test size = 104
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.2239e-01, PNorm = 43.2655, GNorm = 1.2609, lr_0 = 4.0937e-04
Validation rmse = 0.314716
Validation r2 = 0.285155
Validation mse = 0.099046
Epoch 1
Loss = 6.9405e-01, PNorm = 43.2930, GNorm = 3.3325, lr_0 = 7.1875e-04
Loss = 6.0084e-01, PNorm = 43.3446, GNorm = 10.5177, lr_0 = 1.0000e-03
Validation rmse = 0.265536
Validation r2 = 0.491116
Validation mse = 0.070509
Epoch 2
Loss = 3.9203e-01, PNorm = 43.4251, GNorm = 8.5000, lr_0 = 9.7046e-04
Validation rmse = 0.228346
Validation r2 = 0.623677
Validation mse = 0.052142
Epoch 3
Loss = 3.0747e-01, PNorm = 43.5118, GNorm = 2.8942, lr_0 = 9.3898e-04
Loss = 3.7104e-01, PNorm = 43.5676, GNorm = 4.8984, lr_0 = 9.1125e-04
Validation rmse = 0.232147
Validation r2 = 0.611043
Validation mse = 0.053892
Epoch 4
Loss = 3.5073e-01, PNorm = 43.6224, GNorm = 3.0970, lr_0 = 8.8433e-04
Loss = 2.6988e-01, PNorm = 43.6729, GNorm = 5.1376, lr_0 = 8.5821e-04
Validation rmse = 0.202078
Validation r2 = 0.705278
Validation mse = 0.040836
Epoch 5
Loss = 3.1753e-01, PNorm = 43.7175, GNorm = 2.0679, lr_0 = 8.3037e-04
Validation rmse = 0.220222
Validation r2 = 0.649977
Validation mse = 0.048498
Epoch 6
Loss = 1.2617e-01, PNorm = 43.7537, GNorm = 1.1047, lr_0 = 8.0584e-04
Loss = 2.1376e-01, PNorm = 43.7892, GNorm = 4.7390, lr_0 = 7.8204e-04
Validation rmse = 0.173470
Validation r2 = 0.782818
Validation mse = 0.030092
Epoch 7
Loss = 1.7859e-01, PNorm = 43.8239, GNorm = 4.4331, lr_0 = 7.5667e-04
Loss = 1.8388e-01, PNorm = 43.8561, GNorm = 2.3464, lr_0 = 7.3432e-04
Validation rmse = 0.169345
Validation r2 = 0.793026
Validation mse = 0.028678
Epoch 8
Loss = 1.6833e-01, PNorm = 43.8762, GNorm = 2.8724, lr_0 = 7.1263e-04
Validation rmse = 0.158216
Validation r2 = 0.819334
Validation mse = 0.025032
Epoch 9
Loss = 1.6151e-01, PNorm = 43.8983, GNorm = 2.4204, lr_0 = 6.8951e-04
Loss = 1.7071e-01, PNorm = 43.9216, GNorm = 10.2626, lr_0 = 6.6915e-04
Validation rmse = 0.167451
Validation r2 = 0.797629
Validation mse = 0.028040
Epoch 10
Loss = 1.2406e-01, PNorm = 43.9420, GNorm = 0.5422, lr_0 = 6.4938e-04
Loss = 1.5677e-01, PNorm = 43.9612, GNorm = 1.9944, lr_0 = 6.3020e-04
Validation rmse = 0.149726
Validation r2 = 0.838203
Validation mse = 0.022418
Epoch 11
Loss = 1.2519e-01, PNorm = 43.9873, GNorm = 0.5310, lr_0 = 6.0976e-04
Validation rmse = 0.158080
Validation r2 = 0.819646
Validation mse = 0.024989
Epoch 12
Loss = 1.3435e-01, PNorm = 44.0062, GNorm = 1.9331, lr_0 = 5.9175e-04
Loss = 1.3624e-01, PNorm = 44.0253, GNorm = 2.9121, lr_0 = 5.7427e-04
Validation rmse = 0.141767
Validation r2 = 0.854949
Validation mse = 0.020098
Epoch 13
Loss = 1.5492e-01, PNorm = 44.0483, GNorm = 6.8189, lr_0 = 5.5564e-04
Loss = 1.2027e-01, PNorm = 44.0674, GNorm = 2.0487, lr_0 = 5.3923e-04
Validation rmse = 0.136734
Validation r2 = 0.865065
Validation mse = 0.018696
Epoch 14
Loss = 1.3897e-01, PNorm = 44.0823, GNorm = 5.1534, lr_0 = 5.2330e-04
Validation rmse = 0.141647
Validation r2 = 0.855193
Validation mse = 0.020064
Epoch 15
Loss = 1.1265e-01, PNorm = 44.1010, GNorm = 1.1499, lr_0 = 5.0632e-04
Loss = 1.2718e-01, PNorm = 44.1174, GNorm = 1.3712, lr_0 = 4.9137e-04
Validation rmse = 0.135268
Validation r2 = 0.867943
Validation mse = 0.018297
Epoch 16
Loss = 1.0936e-01, PNorm = 44.1296, GNorm = 1.2006, lr_0 = 4.7685e-04
Loss = 1.0664e-01, PNorm = 44.1449, GNorm = 1.7596, lr_0 = 4.6277e-04
Loss = 1.9446e-01, PNorm = 44.1457, GNorm = 3.1409, lr_0 = 4.6138e-04
Validation rmse = 0.137420
Validation r2 = 0.863707
Validation mse = 0.018884
Epoch 17
Loss = 9.9317e-02, PNorm = 44.1569, GNorm = 2.0802, lr_0 = 4.4776e-04
Validation rmse = 0.155728
Validation r2 = 0.824973
Validation mse = 0.024251
Epoch 18
Loss = 1.4590e-01, PNorm = 44.1681, GNorm = 1.7294, lr_0 = 4.3453e-04
Loss = 1.0970e-01, PNorm = 44.1815, GNorm = 2.2114, lr_0 = 4.2170e-04
Validation rmse = 0.134972
Validation r2 = 0.868519
Validation mse = 0.018218
Epoch 19
Loss = 1.2308e-01, PNorm = 44.1936, GNorm = 1.5847, lr_0 = 4.0802e-04
Loss = 1.0283e-01, PNorm = 44.2070, GNorm = 2.7731, lr_0 = 3.9596e-04
Validation rmse = 0.134472
Validation r2 = 0.869492
Validation mse = 0.018083
Epoch 20
Loss = 9.4678e-02, PNorm = 44.2179, GNorm = 1.0397, lr_0 = 3.8427e-04
Validation rmse = 0.133800
Validation r2 = 0.870793
Validation mse = 0.017902
Epoch 21
Loss = 8.9620e-02, PNorm = 44.2282, GNorm = 0.7976, lr_0 = 3.7180e-04
Loss = 9.9488e-02, PNorm = 44.2359, GNorm = 1.1924, lr_0 = 3.6082e-04
Validation rmse = 0.136677
Validation r2 = 0.865177
Validation mse = 0.018681
Epoch 22
Loss = 1.0983e-01, PNorm = 44.2481, GNorm = 0.5848, lr_0 = 3.5016e-04
Validation rmse = 0.129418
Validation r2 = 0.879118
Validation mse = 0.016749
Epoch 23
Loss = 1.0618e-01, PNorm = 44.2588, GNorm = 1.2582, lr_0 = 3.3880e-04
Loss = 9.6961e-02, PNorm = 44.2671, GNorm = 3.0005, lr_0 = 3.2880e-04
Validation rmse = 0.140463
Validation r2 = 0.857604
Validation mse = 0.019730
Epoch 24
Loss = 9.8295e-02, PNorm = 44.2764, GNorm = 1.5301, lr_0 = 3.1908e-04
Loss = 8.8088e-02, PNorm = 44.2851, GNorm = 0.8727, lr_0 = 3.0966e-04
Validation rmse = 0.128835
Validation r2 = 0.880204
Validation mse = 0.016598
Epoch 25
Loss = 9.3858e-02, PNorm = 44.2940, GNorm = 1.7693, lr_0 = 2.9961e-04
Validation rmse = 0.133185
Validation r2 = 0.871979
Validation mse = 0.017738
Epoch 26
Loss = 1.0035e-01, PNorm = 44.3031, GNorm = 1.3094, lr_0 = 2.9076e-04
Loss = 8.3722e-02, PNorm = 44.3129, GNorm = 0.5439, lr_0 = 2.8218e-04
Validation rmse = 0.132235
Validation r2 = 0.873799
Validation mse = 0.017486
Epoch 27
Loss = 8.1435e-02, PNorm = 44.3219, GNorm = 0.8991, lr_0 = 2.7302e-04
Loss = 9.1625e-02, PNorm = 44.3294, GNorm = 2.5862, lr_0 = 2.6496e-04
Validation rmse = 0.126372
Validation r2 = 0.884740
Validation mse = 0.015970
Epoch 28
Loss = 9.4160e-02, PNorm = 44.3356, GNorm = 2.1795, lr_0 = 2.5713e-04
Validation rmse = 0.130160
Validation r2 = 0.877728
Validation mse = 0.016942
Epoch 29
Loss = 7.9419e-02, PNorm = 44.3450, GNorm = 1.0948, lr_0 = 2.4879e-04
Loss = 8.9032e-02, PNorm = 44.3538, GNorm = 2.6286, lr_0 = 2.4144e-04
Validation rmse = 0.136850
Validation r2 = 0.864835
Validation mse = 0.018728
Epoch 30
Loss = 8.1059e-02, PNorm = 44.3601, GNorm = 1.4581, lr_0 = 2.3431e-04
Loss = 8.6170e-02, PNorm = 44.3674, GNorm = 1.0889, lr_0 = 2.2739e-04
Validation rmse = 0.132143
Validation r2 = 0.873974
Validation mse = 0.017462
Epoch 31
Loss = 7.7077e-02, PNorm = 44.3752, GNorm = 0.4920, lr_0 = 2.2001e-04
Validation rmse = 0.125917
Validation r2 = 0.885569
Validation mse = 0.015855
Epoch 32
Loss = 1.0499e-01, PNorm = 44.3812, GNorm = 3.2457, lr_0 = 2.1351e-04
Loss = 8.3582e-02, PNorm = 44.3871, GNorm = 1.5700, lr_0 = 2.0721e-04
Validation rmse = 0.126766
Validation r2 = 0.884021
Validation mse = 0.016070
Epoch 33
Loss = 8.2308e-02, PNorm = 44.3941, GNorm = 0.8720, lr_0 = 2.0049e-04
Loss = 8.2314e-02, PNorm = 44.4001, GNorm = 0.5109, lr_0 = 1.9456e-04
Validation rmse = 0.135614
Validation r2 = 0.867266
Validation mse = 0.018391
Epoch 34
Loss = 8.6607e-02, PNorm = 44.4073, GNorm = 1.0817, lr_0 = 1.8882e-04
Validation rmse = 0.124223
Validation r2 = 0.888627
Validation mse = 0.015431
Epoch 35
Loss = 8.6077e-02, PNorm = 44.4140, GNorm = 2.1988, lr_0 = 1.8269e-04
Loss = 7.6247e-02, PNorm = 44.4191, GNorm = 0.4441, lr_0 = 1.7730e-04
Validation rmse = 0.125574
Validation r2 = 0.886191
Validation mse = 0.015769
Epoch 36
Loss = 9.0514e-02, PNorm = 44.4254, GNorm = 1.3503, lr_0 = 1.7206e-04
Loss = 7.1187e-02, PNorm = 44.4307, GNorm = 0.6093, lr_0 = 1.6698e-04
Loss = 7.6876e-02, PNorm = 44.4313, GNorm = 1.2242, lr_0 = 1.6648e-04
Validation rmse = 0.131104
Validation r2 = 0.875948
Validation mse = 0.017188
Epoch 37
Loss = 7.9630e-02, PNorm = 44.4358, GNorm = 0.7903, lr_0 = 1.6156e-04
Validation rmse = 0.128630
Validation r2 = 0.880585
Validation mse = 0.016546
Epoch 38
Loss = 6.7821e-02, PNorm = 44.4413, GNorm = 3.1579, lr_0 = 1.5679e-04
Loss = 7.6689e-02, PNorm = 44.4466, GNorm = 1.6016, lr_0 = 1.5216e-04
Validation rmse = 0.124118
Validation r2 = 0.888815
Validation mse = 0.015405
Epoch 39
Loss = 7.8485e-02, PNorm = 44.4529, GNorm = 0.4542, lr_0 = 1.4722e-04
Loss = 7.3310e-02, PNorm = 44.4575, GNorm = 0.9572, lr_0 = 1.4287e-04
Validation rmse = 0.123035
Validation r2 = 0.890747
Validation mse = 0.015138
Epoch 40
Loss = 7.4213e-02, PNorm = 44.4622, GNorm = 1.7337, lr_0 = 1.3865e-04
Validation rmse = 0.128702
Validation r2 = 0.880451
Validation mse = 0.016564
Epoch 41
Loss = 5.2275e-02, PNorm = 44.4667, GNorm = 0.8314, lr_0 = 1.3415e-04
Loss = 8.0349e-02, PNorm = 44.4714, GNorm = 1.5722, lr_0 = 1.3019e-04
Validation rmse = 0.123281
Validation r2 = 0.890310
Validation mse = 0.015198
Epoch 42
Loss = 7.7233e-02, PNorm = 44.4758, GNorm = 1.0676, lr_0 = 1.2635e-04
Validation rmse = 0.123880
Validation r2 = 0.889242
Validation mse = 0.015346
Epoch 43
Loss = 3.9729e-02, PNorm = 44.4805, GNorm = 0.6335, lr_0 = 1.2225e-04
Loss = 7.7675e-02, PNorm = 44.4850, GNorm = 1.5235, lr_0 = 1.1864e-04
Validation rmse = 0.131766
Validation r2 = 0.874692
Validation mse = 0.017362
Epoch 44
Loss = 6.3361e-02, PNorm = 44.4893, GNorm = 0.5800, lr_0 = 1.1513e-04
Loss = 6.7143e-02, PNorm = 44.4934, GNorm = 1.3011, lr_0 = 1.1173e-04
Validation rmse = 0.126169
Validation r2 = 0.885111
Validation mse = 0.015919
Epoch 45
Loss = 7.5657e-02, PNorm = 44.4977, GNorm = 3.1138, lr_0 = 1.0811e-04
Validation rmse = 0.124859
Validation r2 = 0.887484
Validation mse = 0.015590
Epoch 46
Loss = 7.0634e-02, PNorm = 44.5018, GNorm = 1.0658, lr_0 = 1.0491e-04
Loss = 7.0385e-02, PNorm = 44.5056, GNorm = 1.1220, lr_0 = 1.0182e-04
Validation rmse = 0.128173
Validation r2 = 0.881433
Validation mse = 0.016428
Epoch 47
Loss = 6.7356e-02, PNorm = 44.5087, GNorm = 0.6278, lr_0 = 1.0000e-04
Loss = 6.7377e-02, PNorm = 44.5130, GNorm = 1.0049, lr_0 = 1.0000e-04
Validation rmse = 0.124469
Validation r2 = 0.888186
Validation mse = 0.015493
Epoch 48
Loss = 6.4937e-02, PNorm = 44.5165, GNorm = 1.3395, lr_0 = 1.0000e-04
Validation rmse = 0.124439
Validation r2 = 0.888240
Validation mse = 0.015485
Epoch 49
Loss = 8.0171e-02, PNorm = 44.5205, GNorm = 1.8306, lr_0 = 1.0000e-04
Loss = 7.6248e-02, PNorm = 44.5240, GNorm = 0.6197, lr_0 = 1.0000e-04
Validation rmse = 0.122399
Validation r2 = 0.891874
Validation mse = 0.014982
Model 0 best validation rmse = 0.122399 on epoch 49
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.124189
Model 0 test r2 = 0.861288
Model 0 test mse = 0.015423
Ensemble test rmse = 0.124189
Ensemble test r2 = 0.861288
Ensemble test mse = 0.015423
Fold 5
Splitting data with seed 5
Total size = 1,032 | train size = 825 | val size = 103 | test size = 104
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.1347e-01, PNorm = 43.2623, GNorm = 2.0923, lr_0 = 4.0937e-04
Validation rmse = 0.294329
Validation r2 = 0.224072
Validation mse = 0.086630
Epoch 1
Loss = 7.9529e-01, PNorm = 43.2932, GNorm = 13.6237, lr_0 = 7.1875e-04
Loss = 5.5410e-01, PNorm = 43.3467, GNorm = 1.2420, lr_0 = 1.0000e-03
Validation rmse = 0.244878
Validation r2 = 0.462902
Validation mse = 0.059965
Epoch 2
Loss = 4.4079e-01, PNorm = 43.4181, GNorm = 0.9253, lr_0 = 9.7046e-04
Validation rmse = 0.295119
Validation r2 = 0.219902
Validation mse = 0.087095
Epoch 3
Loss = 4.4998e-01, PNorm = 43.4976, GNorm = 9.2672, lr_0 = 9.3898e-04
Loss = 3.6730e-01, PNorm = 43.5690, GNorm = 2.8965, lr_0 = 9.1125e-04
Validation rmse = 0.231540
Validation r2 = 0.519818
Validation mse = 0.053611
Epoch 4
Loss = 4.1617e-01, PNorm = 43.6203, GNorm = 2.4203, lr_0 = 8.8433e-04
Loss = 3.4145e-01, PNorm = 43.6709, GNorm = 7.2854, lr_0 = 8.5821e-04
Validation rmse = 0.255870
Validation r2 = 0.413599
Validation mse = 0.065470
Epoch 5
Loss = 2.7650e-01, PNorm = 43.7248, GNorm = 8.3387, lr_0 = 8.3037e-04
Validation rmse = 0.192114
Validation r2 = 0.669424
Validation mse = 0.036908
Epoch 6
Loss = 3.0232e-01, PNorm = 43.7673, GNorm = 2.5097, lr_0 = 8.0584e-04
Loss = 2.0986e-01, PNorm = 43.8081, GNorm = 6.1136, lr_0 = 7.8204e-04
Validation rmse = 0.176246
Validation r2 = 0.721776
Validation mse = 0.031063
Epoch 7
Loss = 1.9547e-01, PNorm = 43.8391, GNorm = 4.1950, lr_0 = 7.5667e-04
Loss = 1.6939e-01, PNorm = 43.8690, GNorm = 5.5370, lr_0 = 7.3432e-04
Validation rmse = 0.198067
Validation r2 = 0.648619
Validation mse = 0.039230
Epoch 8
Loss = 1.7823e-01, PNorm = 43.8945, GNorm = 1.6056, lr_0 = 7.1263e-04
Validation rmse = 0.157392
Validation r2 = 0.778118
Validation mse = 0.024772
Epoch 9
Loss = 1.7661e-01, PNorm = 43.9213, GNorm = 1.7803, lr_0 = 6.8951e-04
Loss = 1.5489e-01, PNorm = 43.9420, GNorm = 1.1583, lr_0 = 6.6915e-04
Validation rmse = 0.154958
Validation r2 = 0.784929
Validation mse = 0.024012
Epoch 10
Loss = 1.3171e-01, PNorm = 43.9635, GNorm = 1.8686, lr_0 = 6.4938e-04
Loss = 1.5232e-01, PNorm = 43.9854, GNorm = 6.8813, lr_0 = 6.3020e-04
Validation rmse = 0.161603
Validation r2 = 0.766087
Validation mse = 0.026116
Epoch 11
Loss = 1.2717e-01, PNorm = 44.0025, GNorm = 0.8350, lr_0 = 6.0976e-04
Validation rmse = 0.158853
Validation r2 = 0.773981
Validation mse = 0.025234
Epoch 12
Loss = 1.2494e-01, PNorm = 44.0220, GNorm = 5.2530, lr_0 = 5.9175e-04
Loss = 1.2955e-01, PNorm = 44.0385, GNorm = 1.5742, lr_0 = 5.7427e-04
Validation rmse = 0.148132
Validation r2 = 0.803459
Validation mse = 0.021943
Epoch 13
Loss = 1.2523e-01, PNorm = 44.0591, GNorm = 2.7627, lr_0 = 5.5564e-04
Loss = 1.0895e-01, PNorm = 44.0758, GNorm = 3.2854, lr_0 = 5.3923e-04
Validation rmse = 0.156644
Validation r2 = 0.780224
Validation mse = 0.024537
Epoch 14
Loss = 1.0353e-01, PNorm = 44.0935, GNorm = 0.7886, lr_0 = 5.2330e-04
Validation rmse = 0.152096
Validation r2 = 0.792800
Validation mse = 0.023133
Epoch 15
Loss = 9.6560e-02, PNorm = 44.1077, GNorm = 3.0203, lr_0 = 5.0632e-04
Loss = 1.1570e-01, PNorm = 44.1221, GNorm = 4.4270, lr_0 = 4.9137e-04
Validation rmse = 0.150700
Validation r2 = 0.796584
Validation mse = 0.022711
Epoch 16
Loss = 1.2026e-01, PNorm = 44.1340, GNorm = 2.7199, lr_0 = 4.7685e-04
Loss = 1.0288e-01, PNorm = 44.1480, GNorm = 0.8363, lr_0 = 4.6277e-04
Loss = 7.7316e-02, PNorm = 44.1496, GNorm = 1.4502, lr_0 = 4.6138e-04
Validation rmse = 0.150660
Validation r2 = 0.796693
Validation mse = 0.022699
Epoch 17
Loss = 1.0120e-01, PNorm = 44.1660, GNorm = 2.6962, lr_0 = 4.4776e-04
Validation rmse = 0.146775
Validation r2 = 0.807043
Validation mse = 0.021543
Epoch 18
Loss = 8.9437e-02, PNorm = 44.1788, GNorm = 1.5371, lr_0 = 4.3453e-04
Loss = 8.7539e-02, PNorm = 44.1939, GNorm = 0.7679, lr_0 = 4.2170e-04
Validation rmse = 0.146333
Validation r2 = 0.808203
Validation mse = 0.021413
Epoch 19
Loss = 9.5060e-02, PNorm = 44.2056, GNorm = 1.5834, lr_0 = 4.0802e-04
Loss = 1.0016e-01, PNorm = 44.2162, GNorm = 2.2675, lr_0 = 3.9596e-04
Validation rmse = 0.146848
Validation r2 = 0.806852
Validation mse = 0.021564
Epoch 20
Loss = 8.8732e-02, PNorm = 44.2263, GNorm = 1.5399, lr_0 = 3.8427e-04
Validation rmse = 0.151215
Validation r2 = 0.795193
Validation mse = 0.022866
Epoch 21
Loss = 1.2399e-01, PNorm = 44.2374, GNorm = 5.4104, lr_0 = 3.7180e-04
Loss = 1.0952e-01, PNorm = 44.2475, GNorm = 1.1911, lr_0 = 3.6082e-04
Validation rmse = 0.148486
Validation r2 = 0.802519
Validation mse = 0.022048
Epoch 22
Loss = 9.5128e-02, PNorm = 44.2596, GNorm = 3.6938, lr_0 = 3.5016e-04
Validation rmse = 0.143643
Validation r2 = 0.815190
Validation mse = 0.020633
Epoch 23
Loss = 1.0268e-01, PNorm = 44.2710, GNorm = 0.9193, lr_0 = 3.3880e-04
Loss = 7.9382e-02, PNorm = 44.2819, GNorm = 0.7999, lr_0 = 3.2880e-04
Validation rmse = 0.147538
Validation r2 = 0.805032
Validation mse = 0.021767
Epoch 24
Loss = 1.0233e-01, PNorm = 44.2902, GNorm = 0.6533, lr_0 = 3.1908e-04
Loss = 8.6379e-02, PNorm = 44.2999, GNorm = 0.5160, lr_0 = 3.0966e-04
Validation rmse = 0.149380
Validation r2 = 0.800134
Validation mse = 0.022314
Epoch 25
Loss = 9.5247e-02, PNorm = 44.3096, GNorm = 2.5100, lr_0 = 2.9961e-04
Validation rmse = 0.158761
Validation r2 = 0.774243
Validation mse = 0.025205
Epoch 26
Loss = 8.0203e-02, PNorm = 44.3188, GNorm = 2.5620, lr_0 = 2.9076e-04
Loss = 8.8074e-02, PNorm = 44.3271, GNorm = 1.2760, lr_0 = 2.8218e-04
Validation rmse = 0.148154
Validation r2 = 0.803400
Validation mse = 0.021950
Epoch 27
Loss = 6.7786e-02, PNorm = 44.3367, GNorm = 1.5810, lr_0 = 2.7302e-04
Loss = 8.6504e-02, PNorm = 44.3441, GNorm = 1.1456, lr_0 = 2.6496e-04
Validation rmse = 0.151289
Validation r2 = 0.794991
Validation mse = 0.022889
Epoch 28
Loss = 7.7501e-02, PNorm = 44.3519, GNorm = 1.3171, lr_0 = 2.5713e-04
Validation rmse = 0.143221
Validation r2 = 0.816274
Validation mse = 0.020512
Epoch 29
Loss = 7.6756e-02, PNorm = 44.3593, GNorm = 0.6705, lr_0 = 2.4879e-04
Loss = 8.7130e-02, PNorm = 44.3659, GNorm = 2.8591, lr_0 = 2.4144e-04
Validation rmse = 0.144050
Validation r2 = 0.814141
Validation mse = 0.020750
Epoch 30
Loss = 8.2103e-02, PNorm = 44.3740, GNorm = 1.3968, lr_0 = 2.3431e-04
Loss = 8.2395e-02, PNorm = 44.3808, GNorm = 1.7466, lr_0 = 2.2739e-04
Validation rmse = 0.142813
Validation r2 = 0.817320
Validation mse = 0.020396
Epoch 31
Loss = 7.8766e-02, PNorm = 44.3896, GNorm = 1.3400, lr_0 = 2.2001e-04
Validation rmse = 0.142722
Validation r2 = 0.817552
Validation mse = 0.020370
Epoch 32
Loss = 5.8185e-02, PNorm = 44.3961, GNorm = 0.8388, lr_0 = 2.1351e-04
Loss = 7.1634e-02, PNorm = 44.4018, GNorm = 0.8230, lr_0 = 2.0721e-04
Validation rmse = 0.154554
Validation r2 = 0.786049
Validation mse = 0.023887
Epoch 33
Loss = 8.8887e-02, PNorm = 44.4093, GNorm = 4.3316, lr_0 = 2.0049e-04
Loss = 8.0703e-02, PNorm = 44.4171, GNorm = 2.7511, lr_0 = 1.9456e-04
Validation rmse = 0.144302
Validation r2 = 0.813491
Validation mse = 0.020823
Epoch 34
Loss = 7.5429e-02, PNorm = 44.4243, GNorm = 0.9476, lr_0 = 1.8882e-04
Validation rmse = 0.141605
Validation r2 = 0.820398
Validation mse = 0.020052
Epoch 35
Loss = 6.5159e-02, PNorm = 44.4312, GNorm = 0.8580, lr_0 = 1.8269e-04
Loss = 7.5729e-02, PNorm = 44.4367, GNorm = 1.0389, lr_0 = 1.7730e-04
Validation rmse = 0.142984
Validation r2 = 0.816883
Validation mse = 0.020444
Epoch 36
Loss = 7.1458e-02, PNorm = 44.4423, GNorm = 1.6196, lr_0 = 1.7206e-04
Loss = 6.8329e-02, PNorm = 44.4477, GNorm = 0.4461, lr_0 = 1.6698e-04
Loss = 7.6815e-02, PNorm = 44.4484, GNorm = 2.0618, lr_0 = 1.6648e-04
Validation rmse = 0.145499
Validation r2 = 0.810383
Validation mse = 0.021170
Epoch 37
Loss = 6.6036e-02, PNorm = 44.4535, GNorm = 1.2492, lr_0 = 1.6156e-04
Validation rmse = 0.144118
Validation r2 = 0.813965
Validation mse = 0.020770
Epoch 38
Loss = 6.2430e-02, PNorm = 44.4592, GNorm = 1.7652, lr_0 = 1.5679e-04
Loss = 6.4157e-02, PNorm = 44.4638, GNorm = 0.6522, lr_0 = 1.5216e-04
Validation rmse = 0.145239
Validation r2 = 0.811061
Validation mse = 0.021094
Epoch 39
Loss = 6.4333e-02, PNorm = 44.4702, GNorm = 0.7188, lr_0 = 1.4722e-04
Loss = 6.9081e-02, PNorm = 44.4750, GNorm = 0.7307, lr_0 = 1.4287e-04
Validation rmse = 0.142370
Validation r2 = 0.818452
Validation mse = 0.020269
Epoch 40
Loss = 6.0247e-02, PNorm = 44.4800, GNorm = 2.1492, lr_0 = 1.3865e-04
Validation rmse = 0.141950
Validation r2 = 0.819522
Validation mse = 0.020150
Epoch 41
Loss = 6.5794e-02, PNorm = 44.4848, GNorm = 0.9361, lr_0 = 1.3415e-04
Loss = 7.1630e-02, PNorm = 44.4898, GNorm = 0.7662, lr_0 = 1.3019e-04
Validation rmse = 0.142242
Validation r2 = 0.818778
Validation mse = 0.020233
Epoch 42
Loss = 6.4406e-02, PNorm = 44.4946, GNorm = 1.6645, lr_0 = 1.2635e-04
Validation rmse = 0.142543
Validation r2 = 0.818011
Validation mse = 0.020318
Epoch 43
Loss = 3.6793e-02, PNorm = 44.4986, GNorm = 0.5119, lr_0 = 1.2225e-04
Loss = 6.9198e-02, PNorm = 44.5033, GNorm = 0.7601, lr_0 = 1.1864e-04
Validation rmse = 0.141448
Validation r2 = 0.820797
Validation mse = 0.020007
Epoch 44
Loss = 5.3395e-02, PNorm = 44.5065, GNorm = 1.4875, lr_0 = 1.1513e-04
Loss = 6.9518e-02, PNorm = 44.5108, GNorm = 3.7088, lr_0 = 1.1173e-04
Validation rmse = 0.151522
Validation r2 = 0.794361
Validation mse = 0.022959
Epoch 45
Loss = 7.0948e-02, PNorm = 44.5153, GNorm = 1.9137, lr_0 = 1.0811e-04
Validation rmse = 0.141237
Validation r2 = 0.821330
Validation mse = 0.019948
Epoch 46
Loss = 5.8284e-02, PNorm = 44.5197, GNorm = 0.7265, lr_0 = 1.0491e-04
Loss = 6.2558e-02, PNorm = 44.5236, GNorm = 1.9928, lr_0 = 1.0182e-04
Validation rmse = 0.142348
Validation r2 = 0.818507
Validation mse = 0.020263
Epoch 47
Loss = 6.5445e-02, PNorm = 44.5280, GNorm = 2.0684, lr_0 = 1.0000e-04
Loss = 6.4125e-02, PNorm = 44.5317, GNorm = 0.6328, lr_0 = 1.0000e-04
Validation rmse = 0.143561
Validation r2 = 0.815401
Validation mse = 0.020610
Epoch 48
Loss = 5.5157e-02, PNorm = 44.5351, GNorm = 1.6066, lr_0 = 1.0000e-04
Validation rmse = 0.141198
Validation r2 = 0.821429
Validation mse = 0.019937
Epoch 49
Loss = 5.7204e-02, PNorm = 44.5391, GNorm = 1.0763, lr_0 = 1.0000e-04
Loss = 6.3260e-02, PNorm = 44.5428, GNorm = 1.9017, lr_0 = 1.0000e-04
Validation rmse = 0.144031
Validation r2 = 0.814191
Validation mse = 0.020745
Model 0 best validation rmse = 0.141198 on epoch 48
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.116930
Model 0 test r2 = 0.876274
Model 0 test mse = 0.013673
Ensemble test rmse = 0.116930
Ensemble test r2 = 0.876274
Ensemble test mse = 0.013673
Fold 6
Splitting data with seed 6
Total size = 1,032 | train size = 825 | val size = 103 | test size = 104
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.3466e-01, PNorm = 43.2647, GNorm = 1.9941, lr_0 = 4.0937e-04
Validation rmse = 0.246582
Validation r2 = 0.417686
Validation mse = 0.060802
Epoch 1
Loss = 6.9092e-01, PNorm = 43.2983, GNorm = 11.0845, lr_0 = 7.1875e-04
Loss = 5.5590e-01, PNorm = 43.3488, GNorm = 1.5606, lr_0 = 1.0000e-03
Validation rmse = 0.195629
Validation r2 = 0.633478
Validation mse = 0.038271
Epoch 2
Loss = 4.8660e-01, PNorm = 43.4232, GNorm = 8.5882, lr_0 = 9.7046e-04
Validation rmse = 0.156649
Validation r2 = 0.764987
Validation mse = 0.024539
Epoch 3
Loss = 3.4444e-01, PNorm = 43.5068, GNorm = 1.8867, lr_0 = 9.3898e-04
Loss = 3.3248e-01, PNorm = 43.5778, GNorm = 0.7907, lr_0 = 9.1125e-04
Validation rmse = 0.167860
Validation r2 = 0.730144
Validation mse = 0.028177
Epoch 4
Loss = 2.3077e-01, PNorm = 43.6382, GNorm = 1.8083, lr_0 = 8.8433e-04
Loss = 2.6066e-01, PNorm = 43.6883, GNorm = 4.8762, lr_0 = 8.5821e-04
Validation rmse = 0.188808
Validation r2 = 0.658591
Validation mse = 0.035648
Epoch 5
Loss = 2.6880e-01, PNorm = 43.7335, GNorm = 2.7960, lr_0 = 8.3037e-04
Validation rmse = 0.153527
Validation r2 = 0.774261
Validation mse = 0.023571
Epoch 6
Loss = 1.6319e-01, PNorm = 43.7734, GNorm = 2.6892, lr_0 = 8.0584e-04
Loss = 1.9315e-01, PNorm = 43.8108, GNorm = 1.0529, lr_0 = 7.8204e-04
Validation rmse = 0.133196
Validation r2 = 0.830089
Validation mse = 0.017741
Epoch 7
Loss = 1.7105e-01, PNorm = 43.8507, GNorm = 1.1604, lr_0 = 7.5667e-04
Loss = 1.5225e-01, PNorm = 43.8822, GNorm = 2.3949, lr_0 = 7.3432e-04
Validation rmse = 0.169912
Validation r2 = 0.723509
Validation mse = 0.028870
Epoch 8
Loss = 1.6853e-01, PNorm = 43.9037, GNorm = 3.3700, lr_0 = 7.1263e-04
Validation rmse = 0.158357
Validation r2 = 0.759836
Validation mse = 0.025077
Epoch 9
Loss = 1.5314e-01, PNorm = 43.9289, GNorm = 2.3677, lr_0 = 6.8951e-04
Loss = 1.7826e-01, PNorm = 43.9499, GNorm = 5.6867, lr_0 = 6.6915e-04
Validation rmse = 0.140625
Validation r2 = 0.810609
Validation mse = 0.019775
Epoch 10
Loss = 1.4851e-01, PNorm = 43.9733, GNorm = 3.5396, lr_0 = 6.4938e-04
Loss = 1.3976e-01, PNorm = 43.9972, GNorm = 1.3167, lr_0 = 6.3020e-04
Validation rmse = 0.127414
Validation r2 = 0.844522
Validation mse = 0.016234
Epoch 11
Loss = 1.1186e-01, PNorm = 44.0177, GNorm = 0.8978, lr_0 = 6.0976e-04
Validation rmse = 0.115014
Validation r2 = 0.873312
Validation mse = 0.013228
Epoch 12
Loss = 1.1925e-01, PNorm = 44.0328, GNorm = 2.5697, lr_0 = 5.9175e-04
Loss = 1.3396e-01, PNorm = 44.0468, GNorm = 4.1713, lr_0 = 5.7427e-04
Validation rmse = 0.146942
Validation r2 = 0.793211
Validation mse = 0.021592
Epoch 13
Loss = 1.4081e-01, PNorm = 44.0630, GNorm = 3.6551, lr_0 = 5.5564e-04
Loss = 1.4840e-01, PNorm = 44.0803, GNorm = 3.6101, lr_0 = 5.3923e-04
Validation rmse = 0.122501
Validation r2 = 0.856282
Validation mse = 0.015006
Epoch 14
Loss = 1.2563e-01, PNorm = 44.0976, GNorm = 0.7725, lr_0 = 5.2330e-04
Validation rmse = 0.123558
Validation r2 = 0.853790
Validation mse = 0.015267
Epoch 15
Loss = 8.0334e-02, PNorm = 44.1159, GNorm = 0.9881, lr_0 = 5.0632e-04
Loss = 1.0839e-01, PNorm = 44.1312, GNorm = 1.6965, lr_0 = 4.9137e-04
Validation rmse = 0.114387
Validation r2 = 0.874688
Validation mse = 0.013084
Epoch 16
Loss = 9.4105e-02, PNorm = 44.1431, GNorm = 1.8136, lr_0 = 4.7685e-04
Loss = 1.0424e-01, PNorm = 44.1547, GNorm = 1.7896, lr_0 = 4.6277e-04
Loss = 6.7820e-02, PNorm = 44.1555, GNorm = 0.9214, lr_0 = 4.6138e-04
Validation rmse = 0.117112
Validation r2 = 0.868647
Validation mse = 0.013715
Epoch 17
Loss = 9.5309e-02, PNorm = 44.1663, GNorm = 1.4032, lr_0 = 4.4776e-04
Validation rmse = 0.125896
Validation r2 = 0.848204
Validation mse = 0.015850
Epoch 18
Loss = 9.1729e-02, PNorm = 44.1780, GNorm = 1.1519, lr_0 = 4.3453e-04
Loss = 9.4651e-02, PNorm = 44.1897, GNorm = 0.7321, lr_0 = 4.2170e-04
Validation rmse = 0.120735
Validation r2 = 0.860395
Validation mse = 0.014577
Epoch 19
Loss = 9.0802e-02, PNorm = 44.2008, GNorm = 2.7575, lr_0 = 4.0802e-04
Loss = 1.0601e-01, PNorm = 44.2104, GNorm = 1.4106, lr_0 = 3.9596e-04
Validation rmse = 0.116108
Validation r2 = 0.870889
Validation mse = 0.013481
Epoch 20
Loss = 9.3348e-02, PNorm = 44.2208, GNorm = 1.2236, lr_0 = 3.8427e-04
Validation rmse = 0.118816
Validation r2 = 0.864797
Validation mse = 0.014117
Epoch 21
Loss = 1.0227e-01, PNorm = 44.2331, GNorm = 2.7459, lr_0 = 3.7180e-04
Loss = 8.5673e-02, PNorm = 44.2418, GNorm = 0.9707, lr_0 = 3.6082e-04
Validation rmse = 0.118288
Validation r2 = 0.865997
Validation mse = 0.013992
Epoch 22
Loss = 8.3707e-02, PNorm = 44.2499, GNorm = 1.5846, lr_0 = 3.5016e-04
Validation rmse = 0.111272
Validation r2 = 0.881421
Validation mse = 0.012381
Epoch 23
Loss = 6.4561e-02, PNorm = 44.2616, GNorm = 0.8687, lr_0 = 3.3880e-04
Loss = 8.0257e-02, PNorm = 44.2711, GNorm = 0.7783, lr_0 = 3.2880e-04
Validation rmse = 0.116635
Validation r2 = 0.869716
Validation mse = 0.013604
Epoch 24
Loss = 8.6671e-02, PNorm = 44.2805, GNorm = 2.9558, lr_0 = 3.1908e-04
Loss = 8.8740e-02, PNorm = 44.2907, GNorm = 2.0147, lr_0 = 3.0966e-04
Validation rmse = 0.113263
Validation r2 = 0.877139
Validation mse = 0.012829
Epoch 25
Loss = 7.8456e-02, PNorm = 44.3012, GNorm = 0.6487, lr_0 = 2.9961e-04
Validation rmse = 0.112769
Validation r2 = 0.878208
Validation mse = 0.012717
Epoch 26
Loss = 9.1659e-02, PNorm = 44.3088, GNorm = 2.3404, lr_0 = 2.9076e-04
Loss = 7.4720e-02, PNorm = 44.3163, GNorm = 0.8776, lr_0 = 2.8218e-04
Validation rmse = 0.110852
Validation r2 = 0.882315
Validation mse = 0.012288
Epoch 27
Loss = 8.1081e-02, PNorm = 44.3252, GNorm = 1.1194, lr_0 = 2.7302e-04
Loss = 7.6224e-02, PNorm = 44.3329, GNorm = 1.0298, lr_0 = 2.6496e-04
Validation rmse = 0.119595
Validation r2 = 0.863019
Validation mse = 0.014303
Epoch 28
Loss = 8.4138e-02, PNorm = 44.3405, GNorm = 1.1043, lr_0 = 2.5713e-04
Validation rmse = 0.116524
Validation r2 = 0.869964
Validation mse = 0.013578
Epoch 29
Loss = 7.3324e-02, PNorm = 44.3493, GNorm = 2.6453, lr_0 = 2.4879e-04
Loss = 8.3881e-02, PNorm = 44.3578, GNorm = 0.9064, lr_0 = 2.4144e-04
Validation rmse = 0.117541
Validation r2 = 0.867682
Validation mse = 0.013816
Epoch 30
Loss = 8.4236e-02, PNorm = 44.3641, GNorm = 1.8168, lr_0 = 2.3431e-04
Loss = 8.9514e-02, PNorm = 44.3714, GNorm = 2.1023, lr_0 = 2.2739e-04
Validation rmse = 0.115630
Validation r2 = 0.871951
Validation mse = 0.013370
Epoch 31
Loss = 7.7214e-02, PNorm = 44.3789, GNorm = 0.6860, lr_0 = 2.2001e-04
Validation rmse = 0.110238
Validation r2 = 0.883616
Validation mse = 0.012152
Epoch 32
Loss = 8.0980e-02, PNorm = 44.3861, GNorm = 3.2934, lr_0 = 2.1351e-04
Loss = 7.8503e-02, PNorm = 44.3930, GNorm = 1.5084, lr_0 = 2.0721e-04
Validation rmse = 0.112527
Validation r2 = 0.878732
Validation mse = 0.012662
Epoch 33
Loss = 7.2368e-02, PNorm = 44.4005, GNorm = 1.0949, lr_0 = 2.0049e-04
Loss = 7.7981e-02, PNorm = 44.4064, GNorm = 1.7981, lr_0 = 1.9456e-04
Validation rmse = 0.122365
Validation r2 = 0.856601
Validation mse = 0.014973
Epoch 34
Loss = 8.0733e-02, PNorm = 44.4130, GNorm = 1.1201, lr_0 = 1.8882e-04
Validation rmse = 0.110873
Validation r2 = 0.882269
Validation mse = 0.012293
Epoch 35
Loss = 7.5824e-02, PNorm = 44.4194, GNorm = 0.9923, lr_0 = 1.8269e-04
Loss = 6.8829e-02, PNorm = 44.4252, GNorm = 1.6591, lr_0 = 1.7730e-04
Validation rmse = 0.110492
Validation r2 = 0.883079
Validation mse = 0.012208
Epoch 36
Loss = 6.4171e-02, PNorm = 44.4303, GNorm = 0.8838, lr_0 = 1.7206e-04
Loss = 7.0984e-02, PNorm = 44.4359, GNorm = 0.9842, lr_0 = 1.6698e-04
Loss = 1.0558e-01, PNorm = 44.4365, GNorm = 3.4749, lr_0 = 1.6648e-04
Validation rmse = 0.111320
Validation r2 = 0.881318
Validation mse = 0.012392
Epoch 37
Loss = 7.4642e-02, PNorm = 44.4429, GNorm = 2.2012, lr_0 = 1.6156e-04
Validation rmse = 0.110288
Validation r2 = 0.883509
Validation mse = 0.012163
Epoch 38
Loss = 6.2920e-02, PNorm = 44.4472, GNorm = 2.7621, lr_0 = 1.5679e-04
Loss = 7.3903e-02, PNorm = 44.4513, GNorm = 0.8207, lr_0 = 1.5216e-04
Validation rmse = 0.106283
Validation r2 = 0.891815
Validation mse = 0.011296
Epoch 39
Loss = 6.5390e-02, PNorm = 44.4568, GNorm = 0.7448, lr_0 = 1.4722e-04
Loss = 6.9532e-02, PNorm = 44.4612, GNorm = 0.7133, lr_0 = 1.4287e-04
Validation rmse = 0.111593
Validation r2 = 0.880735
Validation mse = 0.012453
Epoch 40
Loss = 6.9949e-02, PNorm = 44.4667, GNorm = 2.4277, lr_0 = 1.3865e-04
Validation rmse = 0.106456
Validation r2 = 0.891464
Validation mse = 0.011333
Epoch 41
Loss = 6.1215e-02, PNorm = 44.4709, GNorm = 1.5634, lr_0 = 1.3415e-04
Loss = 6.8460e-02, PNorm = 44.4756, GNorm = 0.8734, lr_0 = 1.3019e-04
Validation rmse = 0.108124
Validation r2 = 0.888035
Validation mse = 0.011691
Epoch 42
Loss = 6.3935e-02, PNorm = 44.4801, GNorm = 1.9019, lr_0 = 1.2635e-04
Validation rmse = 0.107165
Validation r2 = 0.890013
Validation mse = 0.011484
Epoch 43
Loss = 5.2323e-02, PNorm = 44.4846, GNorm = 0.6088, lr_0 = 1.2225e-04
Loss = 6.7013e-02, PNorm = 44.4889, GNorm = 2.2779, lr_0 = 1.1864e-04
Validation rmse = 0.110741
Validation r2 = 0.882550
Validation mse = 0.012264
Epoch 44
Loss = 5.2833e-02, PNorm = 44.4930, GNorm = 1.6454, lr_0 = 1.1513e-04
Loss = 6.6734e-02, PNorm = 44.4969, GNorm = 1.8178, lr_0 = 1.1173e-04
Validation rmse = 0.108753
Validation r2 = 0.886729
Validation mse = 0.011827
Epoch 45
Loss = 6.4624e-02, PNorm = 44.5006, GNorm = 1.0424, lr_0 = 1.0811e-04
Validation rmse = 0.109298
Validation r2 = 0.885592
Validation mse = 0.011946
Epoch 46
Loss = 5.1511e-02, PNorm = 44.5047, GNorm = 0.8745, lr_0 = 1.0491e-04
Loss = 5.8936e-02, PNorm = 44.5077, GNorm = 1.3196, lr_0 = 1.0182e-04
Validation rmse = 0.106162
Validation r2 = 0.892061
Validation mse = 0.011270
Epoch 47
Loss = 6.3000e-02, PNorm = 44.5117, GNorm = 0.7284, lr_0 = 1.0000e-04
Loss = 6.5902e-02, PNorm = 44.5149, GNorm = 1.0361, lr_0 = 1.0000e-04
Validation rmse = 0.105650
Validation r2 = 0.893100
Validation mse = 0.011162
Epoch 48
Loss = 6.0210e-02, PNorm = 44.5184, GNorm = 0.8401, lr_0 = 1.0000e-04
Validation rmse = 0.109690
Validation r2 = 0.884768
Validation mse = 0.012032
Epoch 49
Loss = 5.5538e-02, PNorm = 44.5227, GNorm = 1.1781, lr_0 = 1.0000e-04
Loss = 6.0204e-02, PNorm = 44.5256, GNorm = 0.7536, lr_0 = 1.0000e-04
Validation rmse = 0.105904
Validation r2 = 0.892585
Validation mse = 0.011216
Model 0 best validation rmse = 0.105650 on epoch 47
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.133528
Model 0 test r2 = 0.839950
Model 0 test mse = 0.017830
Ensemble test rmse = 0.133528
Ensemble test r2 = 0.839950
Ensemble test mse = 0.017830
Fold 7
Splitting data with seed 7
Total size = 1,032 | train size = 825 | val size = 103 | test size = 104
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.6475e-01, PNorm = 43.2657, GNorm = 3.6250, lr_0 = 4.0937e-04
Validation rmse = 0.295416
Validation r2 = 0.278591
Validation mse = 0.087271
Epoch 1
Loss = 6.9398e-01, PNorm = 43.3010, GNorm = 6.3823, lr_0 = 7.1875e-04
Loss = 5.0662e-01, PNorm = 43.3603, GNorm = 6.9742, lr_0 = 1.0000e-03
Validation rmse = 0.242482
Validation r2 = 0.513957
Validation mse = 0.058798
Epoch 2
Loss = 5.4626e-01, PNorm = 43.4344, GNorm = 8.4254, lr_0 = 9.7046e-04
Validation rmse = 0.220949
Validation r2 = 0.596450
Validation mse = 0.048818
Epoch 3
Loss = 5.0325e-01, PNorm = 43.5090, GNorm = 2.8236, lr_0 = 9.3898e-04
Loss = 3.6143e-01, PNorm = 43.5727, GNorm = 5.8383, lr_0 = 9.1125e-04
Validation rmse = 0.220733
Validation r2 = 0.597237
Validation mse = 0.048723
Epoch 4
Loss = 3.3830e-01, PNorm = 43.6356, GNorm = 5.3687, lr_0 = 8.8433e-04
Loss = 3.3044e-01, PNorm = 43.6798, GNorm = 1.2733, lr_0 = 8.5821e-04
Validation rmse = 0.184981
Validation r2 = 0.717142
Validation mse = 0.034218
Epoch 5
Loss = 2.4293e-01, PNorm = 43.7353, GNorm = 6.1055, lr_0 = 8.3037e-04
Validation rmse = 0.171661
Validation r2 = 0.756413
Validation mse = 0.029467
Epoch 6
Loss = 2.0428e-01, PNorm = 43.7746, GNorm = 2.6431, lr_0 = 8.0584e-04
Loss = 2.3073e-01, PNorm = 43.8105, GNorm = 3.4319, lr_0 = 7.8204e-04
Validation rmse = 0.159041
Validation r2 = 0.790911
Validation mse = 0.025294
Epoch 7
Loss = 2.1159e-01, PNorm = 43.8486, GNorm = 0.6115, lr_0 = 7.5667e-04
Loss = 1.7301e-01, PNorm = 43.8820, GNorm = 0.9551, lr_0 = 7.3432e-04
Validation rmse = 0.165524
Validation r2 = 0.773517
Validation mse = 0.027398
Epoch 8
Loss = 1.5806e-01, PNorm = 43.9097, GNorm = 2.8191, lr_0 = 7.1263e-04
Validation rmse = 0.155619
Validation r2 = 0.799812
Validation mse = 0.024217
Epoch 9
Loss = 1.8872e-01, PNorm = 43.9381, GNorm = 7.8609, lr_0 = 6.8951e-04
Loss = 1.8775e-01, PNorm = 43.9608, GNorm = 5.8879, lr_0 = 6.6915e-04
Validation rmse = 0.151363
Validation r2 = 0.810611
Validation mse = 0.022911
Epoch 10
Loss = 1.7969e-01, PNorm = 43.9922, GNorm = 2.0898, lr_0 = 6.4938e-04
Loss = 2.2250e-01, PNorm = 44.0224, GNorm = 4.3644, lr_0 = 6.3020e-04
Validation rmse = 0.166747
Validation r2 = 0.770159
Validation mse = 0.027804
Epoch 11
Loss = 1.6809e-01, PNorm = 44.0534, GNorm = 1.2515, lr_0 = 6.0976e-04
Validation rmse = 0.150741
Validation r2 = 0.812166
Validation mse = 0.022723
Epoch 12
Loss = 1.5212e-01, PNorm = 44.0748, GNorm = 2.4564, lr_0 = 5.9175e-04
Loss = 1.3240e-01, PNorm = 44.0995, GNorm = 1.6675, lr_0 = 5.7427e-04
Validation rmse = 0.143163
Validation r2 = 0.830575
Validation mse = 0.020496
Epoch 13
Loss = 1.2344e-01, PNorm = 44.1177, GNorm = 2.1792, lr_0 = 5.5564e-04
Loss = 1.3580e-01, PNorm = 44.1362, GNorm = 3.6680, lr_0 = 5.3923e-04
Validation rmse = 0.144621
Validation r2 = 0.827107
Validation mse = 0.020915
Epoch 14
Loss = 1.3321e-01, PNorm = 44.1541, GNorm = 1.3197, lr_0 = 5.2330e-04
Validation rmse = 0.137810
Validation r2 = 0.843010
Validation mse = 0.018991
Epoch 15
Loss = 8.3778e-02, PNorm = 44.1717, GNorm = 0.4150, lr_0 = 5.0632e-04
Loss = 1.2339e-01, PNorm = 44.1879, GNorm = 1.7186, lr_0 = 4.9137e-04
Validation rmse = 0.140525
Validation r2 = 0.836761
Validation mse = 0.019747
Epoch 16
Loss = 1.2018e-01, PNorm = 44.2053, GNorm = 2.3320, lr_0 = 4.7685e-04
Loss = 1.1105e-01, PNorm = 44.2203, GNorm = 1.9866, lr_0 = 4.6277e-04
Loss = 9.9516e-02, PNorm = 44.2217, GNorm = 1.2745, lr_0 = 4.6138e-04
Validation rmse = 0.148059
Validation r2 = 0.818790
Validation mse = 0.021921
Epoch 17
Loss = 1.1369e-01, PNorm = 44.2375, GNorm = 1.4095, lr_0 = 4.4776e-04
Validation rmse = 0.136954
Validation r2 = 0.844953
Validation mse = 0.018756
Epoch 18
Loss = 1.2639e-01, PNorm = 44.2523, GNorm = 2.5967, lr_0 = 4.3453e-04
Loss = 1.4157e-01, PNorm = 44.2662, GNorm = 2.8917, lr_0 = 4.2170e-04
Validation rmse = 0.141016
Validation r2 = 0.835620
Validation mse = 0.019885
Epoch 19
Loss = 1.2011e-01, PNorm = 44.2849, GNorm = 1.0667, lr_0 = 4.0802e-04
Loss = 9.2743e-02, PNorm = 44.2972, GNorm = 0.5562, lr_0 = 3.9596e-04
Validation rmse = 0.133016
Validation r2 = 0.853742
Validation mse = 0.017693
Epoch 20
Loss = 9.8587e-02, PNorm = 44.3094, GNorm = 1.0008, lr_0 = 3.8427e-04
Validation rmse = 0.135324
Validation r2 = 0.848622
Validation mse = 0.018313
Epoch 21
Loss = 8.0766e-02, PNorm = 44.3218, GNorm = 1.1884, lr_0 = 3.7180e-04
Loss = 1.1059e-01, PNorm = 44.3320, GNorm = 2.6304, lr_0 = 3.6082e-04
Validation rmse = 0.138654
Validation r2 = 0.841080
Validation mse = 0.019225
Epoch 22
Loss = 9.4508e-02, PNorm = 44.3420, GNorm = 0.9975, lr_0 = 3.5016e-04
Validation rmse = 0.137404
Validation r2 = 0.843933
Validation mse = 0.018880
Epoch 23
Loss = 6.4709e-02, PNorm = 44.3542, GNorm = 0.7275, lr_0 = 3.3880e-04
Loss = 9.0598e-02, PNorm = 44.3639, GNorm = 1.7101, lr_0 = 3.2880e-04
Validation rmse = 0.131771
Validation r2 = 0.856467
Validation mse = 0.017364
Epoch 24
Loss = 7.8360e-02, PNorm = 44.3743, GNorm = 1.0380, lr_0 = 3.1908e-04
Loss = 9.0718e-02, PNorm = 44.3836, GNorm = 0.9900, lr_0 = 3.0966e-04
Validation rmse = 0.133143
Validation r2 = 0.853463
Validation mse = 0.017727
Epoch 25
Loss = 8.9269e-02, PNorm = 44.3967, GNorm = 1.2153, lr_0 = 2.9961e-04
Validation rmse = 0.133305
Validation r2 = 0.853106
Validation mse = 0.017770
Epoch 26
Loss = 1.4038e-01, PNorm = 44.4054, GNorm = 1.7793, lr_0 = 2.9076e-04
Loss = 9.0443e-02, PNorm = 44.4143, GNorm = 3.0272, lr_0 = 2.8218e-04
Validation rmse = 0.156556
Validation r2 = 0.797394
Validation mse = 0.024510
Epoch 27
Loss = 1.0378e-01, PNorm = 44.4247, GNorm = 1.4286, lr_0 = 2.7302e-04
Loss = 9.8030e-02, PNorm = 44.4338, GNorm = 1.8112, lr_0 = 2.6496e-04
Validation rmse = 0.131239
Validation r2 = 0.857623
Validation mse = 0.017224
Epoch 28
Loss = 8.5288e-02, PNorm = 44.4445, GNorm = 0.6026, lr_0 = 2.5713e-04
Validation rmse = 0.133309
Validation r2 = 0.853097
Validation mse = 0.017771
Epoch 29
Loss = 5.2411e-02, PNorm = 44.4545, GNorm = 0.4339, lr_0 = 2.4879e-04
Loss = 9.0576e-02, PNorm = 44.4618, GNorm = 2.3543, lr_0 = 2.4144e-04
Validation rmse = 0.131014
Validation r2 = 0.858111
Validation mse = 0.017165
Epoch 30
Loss = 8.9167e-02, PNorm = 44.4689, GNorm = 0.6566, lr_0 = 2.3431e-04
Loss = 8.5876e-02, PNorm = 44.4770, GNorm = 0.9332, lr_0 = 2.2739e-04
Validation rmse = 0.130255
Validation r2 = 0.859751
Validation mse = 0.016966
Epoch 31
Loss = 9.1788e-02, PNorm = 44.4855, GNorm = 1.6936, lr_0 = 2.2001e-04
Validation rmse = 0.128565
Validation r2 = 0.863365
Validation mse = 0.016529
Epoch 32
Loss = 6.0238e-02, PNorm = 44.4907, GNorm = 1.0776, lr_0 = 2.1351e-04
Loss = 8.7885e-02, PNorm = 44.4974, GNorm = 0.8322, lr_0 = 2.0721e-04
Validation rmse = 0.131303
Validation r2 = 0.857484
Validation mse = 0.017240
Epoch 33
Loss = 7.4319e-02, PNorm = 44.5053, GNorm = 2.0035, lr_0 = 2.0049e-04
Loss = 8.4352e-02, PNorm = 44.5119, GNorm = 0.6182, lr_0 = 1.9456e-04
Validation rmse = 0.130584
Validation r2 = 0.859042
Validation mse = 0.017052
Epoch 34
Loss = 7.4201e-02, PNorm = 44.5177, GNorm = 1.4044, lr_0 = 1.8882e-04
Validation rmse = 0.129129
Validation r2 = 0.862164
Validation mse = 0.016674
Epoch 35
Loss = 5.5270e-02, PNorm = 44.5263, GNorm = 1.3835, lr_0 = 1.8269e-04
Loss = 8.5755e-02, PNorm = 44.5330, GNorm = 1.5191, lr_0 = 1.7730e-04
Validation rmse = 0.130155
Validation r2 = 0.859964
Validation mse = 0.016940
Epoch 36
Loss = 7.5900e-02, PNorm = 44.5379, GNorm = 0.6937, lr_0 = 1.7206e-04
Loss = 7.7213e-02, PNorm = 44.5442, GNorm = 1.9451, lr_0 = 1.6698e-04
Loss = 9.5892e-02, PNorm = 44.5446, GNorm = 1.2174, lr_0 = 1.6648e-04
Validation rmse = 0.130423
Validation r2 = 0.859388
Validation mse = 0.017010
Epoch 37
Loss = 8.1514e-02, PNorm = 44.5515, GNorm = 1.5535, lr_0 = 1.6156e-04
Validation rmse = 0.127936
Validation r2 = 0.864700
Validation mse = 0.016368
Epoch 38
Loss = 6.0907e-02, PNorm = 44.5572, GNorm = 1.0368, lr_0 = 1.5679e-04
Loss = 7.5474e-02, PNorm = 44.5631, GNorm = 1.2436, lr_0 = 1.5216e-04
Validation rmse = 0.129355
Validation r2 = 0.861682
Validation mse = 0.016733
Epoch 39
Loss = 8.0882e-02, PNorm = 44.5688, GNorm = 0.6371, lr_0 = 1.4722e-04
Loss = 7.1074e-02, PNorm = 44.5744, GNorm = 0.9946, lr_0 = 1.4287e-04
Validation rmse = 0.129073
Validation r2 = 0.862284
Validation mse = 0.016660
Epoch 40
Loss = 6.7850e-02, PNorm = 44.5790, GNorm = 1.8335, lr_0 = 1.3865e-04
Validation rmse = 0.129918
Validation r2 = 0.860474
Validation mse = 0.016879
Epoch 41
Loss = 8.2670e-02, PNorm = 44.5846, GNorm = 1.1111, lr_0 = 1.3415e-04
Loss = 7.2761e-02, PNorm = 44.5892, GNorm = 1.6496, lr_0 = 1.3019e-04
Validation rmse = 0.127958
Validation r2 = 0.864652
Validation mse = 0.016373
Epoch 42
Loss = 6.7468e-02, PNorm = 44.5933, GNorm = 0.5141, lr_0 = 1.2635e-04
Validation rmse = 0.127899
Validation r2 = 0.864778
Validation mse = 0.016358
Epoch 43
Loss = 7.1913e-02, PNorm = 44.5980, GNorm = 0.7124, lr_0 = 1.2225e-04
Loss = 6.8292e-02, PNorm = 44.6029, GNorm = 0.9971, lr_0 = 1.1864e-04
Validation rmse = 0.128291
Validation r2 = 0.863948
Validation mse = 0.016459
Epoch 44
Loss = 6.8128e-02, PNorm = 44.6069, GNorm = 0.6326, lr_0 = 1.1513e-04
Loss = 6.8249e-02, PNorm = 44.6120, GNorm = 0.6359, lr_0 = 1.1173e-04
Validation rmse = 0.128746
Validation r2 = 0.862982
Validation mse = 0.016575
Epoch 45
Loss = 6.7277e-02, PNorm = 44.6163, GNorm = 0.6819, lr_0 = 1.0811e-04
Validation rmse = 0.127958
Validation r2 = 0.864654
Validation mse = 0.016373
Epoch 46
Loss = 5.3915e-02, PNorm = 44.6199, GNorm = 0.6501, lr_0 = 1.0491e-04
Loss = 7.1274e-02, PNorm = 44.6242, GNorm = 1.4129, lr_0 = 1.0182e-04
Validation rmse = 0.126828
Validation r2 = 0.867032
Validation mse = 0.016085
Epoch 47
Loss = 7.3780e-02, PNorm = 44.6275, GNorm = 0.5528, lr_0 = 1.0000e-04
Loss = 6.5088e-02, PNorm = 44.6312, GNorm = 0.4871, lr_0 = 1.0000e-04
Validation rmse = 0.126173
Validation r2 = 0.868403
Validation mse = 0.015920
Epoch 48
Loss = 6.4617e-02, PNorm = 44.6343, GNorm = 0.5609, lr_0 = 1.0000e-04
Validation rmse = 0.128098
Validation r2 = 0.864358
Validation mse = 0.016409
Epoch 49
Loss = 5.8086e-02, PNorm = 44.6388, GNorm = 1.7962, lr_0 = 1.0000e-04
Loss = 6.7562e-02, PNorm = 44.6428, GNorm = 0.6923, lr_0 = 1.0000e-04
Validation rmse = 0.126997
Validation r2 = 0.866678
Validation mse = 0.016128
Model 0 best validation rmse = 0.126173 on epoch 47
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.115134
Model 0 test r2 = 0.898066
Model 0 test mse = 0.013256
Ensemble test rmse = 0.115134
Ensemble test r2 = 0.898066
Ensemble test mse = 0.013256
Fold 8
Splitting data with seed 8
Total size = 1,032 | train size = 825 | val size = 103 | test size = 104
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 8.8464e-01, PNorm = 43.2645, GNorm = 3.8149, lr_0 = 4.0937e-04
Validation rmse = 0.276408
Validation r2 = 0.225627
Validation mse = 0.076401
Epoch 1
Loss = 7.1810e-01, PNorm = 43.2973, GNorm = 1.9268, lr_0 = 7.1875e-04
Loss = 5.9355e-01, PNorm = 43.3533, GNorm = 15.1183, lr_0 = 1.0000e-03
Validation rmse = 0.351626
Validation r2 = -0.253175
Validation mse = 0.123641
Epoch 2
Loss = 8.3885e-01, PNorm = 43.4099, GNorm = 6.5400, lr_0 = 9.7046e-04
Validation rmse = 0.202210
Validation r2 = 0.585566
Validation mse = 0.040889
Epoch 3
Loss = 3.6423e-01, PNorm = 43.4910, GNorm = 0.9794, lr_0 = 9.3898e-04
Loss = 3.7001e-01, PNorm = 43.5581, GNorm = 1.1079, lr_0 = 9.1125e-04
Validation rmse = 0.187565
Validation r2 = 0.643422
Validation mse = 0.035181
Epoch 4
Loss = 2.7897e-01, PNorm = 43.6251, GNorm = 2.2439, lr_0 = 8.8433e-04
Loss = 2.9103e-01, PNorm = 43.6845, GNorm = 4.3746, lr_0 = 8.5821e-04
Validation rmse = 0.168072
Validation r2 = 0.713686
Validation mse = 0.028248
Epoch 5
Loss = 2.5411e-01, PNorm = 43.7375, GNorm = 5.3201, lr_0 = 8.3037e-04
Validation rmse = 0.151215
Validation r2 = 0.768241
Validation mse = 0.022866
Epoch 6
Loss = 1.3756e-01, PNorm = 43.7840, GNorm = 3.1796, lr_0 = 8.0584e-04
Loss = 1.9970e-01, PNorm = 43.8263, GNorm = 3.7515, lr_0 = 7.8204e-04
Validation rmse = 0.150017
Validation r2 = 0.771897
Validation mse = 0.022505
Epoch 7
Loss = 1.4971e-01, PNorm = 43.8604, GNorm = 1.1323, lr_0 = 7.5667e-04
Loss = 1.8501e-01, PNorm = 43.8909, GNorm = 1.6384, lr_0 = 7.3432e-04
Validation rmse = 0.148089
Validation r2 = 0.777723
Validation mse = 0.021930
Epoch 8
Loss = 1.5313e-01, PNorm = 43.9254, GNorm = 1.3674, lr_0 = 7.1263e-04
Validation rmse = 0.163701
Validation r2 = 0.728387
Validation mse = 0.026798
Epoch 9
Loss = 2.4645e-01, PNorm = 43.9481, GNorm = 6.9540, lr_0 = 6.8951e-04
Loss = 1.4915e-01, PNorm = 43.9713, GNorm = 4.5899, lr_0 = 6.6915e-04
Validation rmse = 0.146898
Validation r2 = 0.781283
Validation mse = 0.021579
Epoch 10
Loss = 1.4850e-01, PNorm = 43.9937, GNorm = 3.6727, lr_0 = 6.4938e-04
Loss = 1.5119e-01, PNorm = 44.0163, GNorm = 1.3866, lr_0 = 6.3020e-04
Validation rmse = 0.149572
Validation r2 = 0.773248
Validation mse = 0.022372
Epoch 11
Loss = 1.4051e-01, PNorm = 44.0418, GNorm = 1.3299, lr_0 = 6.0976e-04
Validation rmse = 0.125573
Validation r2 = 0.840177
Validation mse = 0.015768
Epoch 12
Loss = 1.0819e-01, PNorm = 44.0591, GNorm = 0.9128, lr_0 = 5.9175e-04
Loss = 1.2562e-01, PNorm = 44.0773, GNorm = 1.4925, lr_0 = 5.7427e-04
Validation rmse = 0.138944
Validation r2 = 0.804328
Validation mse = 0.019305
Epoch 13
Loss = 1.2520e-01, PNorm = 44.0943, GNorm = 0.9525, lr_0 = 5.5564e-04
Loss = 1.1636e-01, PNorm = 44.1108, GNorm = 5.1366, lr_0 = 5.3923e-04
Validation rmse = 0.126148
Validation r2 = 0.838710
Validation mse = 0.015913
Epoch 14
Loss = 1.1545e-01, PNorm = 44.1254, GNorm = 4.7104, lr_0 = 5.2330e-04
Validation rmse = 0.124830
Validation r2 = 0.842061
Validation mse = 0.015583
Epoch 15
Loss = 1.0560e-01, PNorm = 44.1434, GNorm = 4.6827, lr_0 = 5.0632e-04
Loss = 1.3707e-01, PNorm = 44.1594, GNorm = 3.3163, lr_0 = 4.9137e-04
Validation rmse = 0.129585
Validation r2 = 0.829800
Validation mse = 0.016792
Epoch 16
Loss = 8.6984e-02, PNorm = 44.1751, GNorm = 1.0114, lr_0 = 4.7685e-04
Loss = 1.1301e-01, PNorm = 44.1906, GNorm = 1.9705, lr_0 = 4.6277e-04
Loss = 1.0432e-01, PNorm = 44.1923, GNorm = 1.7957, lr_0 = 4.6138e-04
Validation rmse = 0.129362
Validation r2 = 0.830386
Validation mse = 0.016735
Epoch 17
Loss = 1.0797e-01, PNorm = 44.2042, GNorm = 2.8860, lr_0 = 4.4776e-04
Validation rmse = 0.124423
Validation r2 = 0.843090
Validation mse = 0.015481
Epoch 18
Loss = 1.2870e-01, PNorm = 44.2167, GNorm = 5.0684, lr_0 = 4.3453e-04
Loss = 1.2549e-01, PNorm = 44.2285, GNorm = 5.3563, lr_0 = 4.2170e-04
Validation rmse = 0.119673
Validation r2 = 0.854841
Validation mse = 0.014322
Epoch 19
Loss = 1.2345e-01, PNorm = 44.2426, GNorm = 3.9076, lr_0 = 4.0802e-04
Loss = 1.1917e-01, PNorm = 44.2569, GNorm = 2.5839, lr_0 = 3.9596e-04
Validation rmse = 0.130264
Validation r2 = 0.828011
Validation mse = 0.016969
Epoch 20
Loss = 1.2583e-01, PNorm = 44.2681, GNorm = 0.7237, lr_0 = 3.8427e-04
Validation rmse = 0.122290
Validation r2 = 0.848424
Validation mse = 0.014955
Epoch 21
Loss = 9.8113e-02, PNorm = 44.2821, GNorm = 3.6693, lr_0 = 3.7180e-04
Loss = 1.0561e-01, PNorm = 44.2948, GNorm = 1.2344, lr_0 = 3.6082e-04
Validation rmse = 0.128370
Validation r2 = 0.832977
Validation mse = 0.016479
Epoch 22
Loss = 1.0858e-01, PNorm = 44.3060, GNorm = 0.6434, lr_0 = 3.5016e-04
Validation rmse = 0.121736
Validation r2 = 0.849794
Validation mse = 0.014820
Epoch 23
Loss = 6.3283e-02, PNorm = 44.3159, GNorm = 0.5739, lr_0 = 3.3880e-04
Loss = 9.0887e-02, PNorm = 44.3250, GNorm = 0.6565, lr_0 = 3.2880e-04
Validation rmse = 0.133527
Validation r2 = 0.819288
Validation mse = 0.017829
Epoch 24
Loss = 9.7589e-02, PNorm = 44.3337, GNorm = 0.6191, lr_0 = 3.1908e-04
Loss = 8.7923e-02, PNorm = 44.3420, GNorm = 1.9520, lr_0 = 3.0966e-04
Validation rmse = 0.117830
Validation r2 = 0.859277
Validation mse = 0.013884
Epoch 25
Loss = 7.8700e-02, PNorm = 44.3479, GNorm = 1.6841, lr_0 = 2.9961e-04
Validation rmse = 0.139319
Validation r2 = 0.803271
Validation mse = 0.019410
Epoch 26
Loss = 1.0332e-01, PNorm = 44.3555, GNorm = 2.0019, lr_0 = 2.9076e-04
Loss = 8.7352e-02, PNorm = 44.3637, GNorm = 1.9387, lr_0 = 2.8218e-04
Validation rmse = 0.119810
Validation r2 = 0.854508
Validation mse = 0.014355
Epoch 27
Loss = 8.1249e-02, PNorm = 44.3738, GNorm = 0.6631, lr_0 = 2.7302e-04
Loss = 8.1839e-02, PNorm = 44.3812, GNorm = 0.6812, lr_0 = 2.6496e-04
Validation rmse = 0.121489
Validation r2 = 0.850402
Validation mse = 0.014760
Epoch 28
Loss = 8.6287e-02, PNorm = 44.3885, GNorm = 0.6877, lr_0 = 2.5713e-04
Validation rmse = 0.123658
Validation r2 = 0.845013
Validation mse = 0.015291
Epoch 29
Loss = 6.9210e-02, PNorm = 44.3959, GNorm = 0.7701, lr_0 = 2.4879e-04
Loss = 8.2200e-02, PNorm = 44.4020, GNorm = 0.5944, lr_0 = 2.4144e-04
Validation rmse = 0.119246
Validation r2 = 0.855877
Validation mse = 0.014219
Epoch 30
Loss = 9.2298e-02, PNorm = 44.4108, GNorm = 2.6712, lr_0 = 2.3431e-04
Loss = 7.3516e-02, PNorm = 44.4179, GNorm = 1.0790, lr_0 = 2.2739e-04
Validation rmse = 0.120401
Validation r2 = 0.853071
Validation mse = 0.014496
Epoch 31
Loss = 7.6404e-02, PNorm = 44.4252, GNorm = 1.4429, lr_0 = 2.2001e-04
Validation rmse = 0.129574
Validation r2 = 0.829828
Validation mse = 0.016790
Epoch 32
Loss = 8.7508e-02, PNorm = 44.4327, GNorm = 1.3280, lr_0 = 2.1351e-04
Loss = 7.3928e-02, PNorm = 44.4395, GNorm = 0.5612, lr_0 = 2.0721e-04
Validation rmse = 0.126692
Validation r2 = 0.837314
Validation mse = 0.016051
Epoch 33
Loss = 7.1826e-02, PNorm = 44.4461, GNorm = 1.0586, lr_0 = 2.0049e-04
Loss = 7.8057e-02, PNorm = 44.4518, GNorm = 1.3928, lr_0 = 1.9456e-04
Validation rmse = 0.127174
Validation r2 = 0.836074
Validation mse = 0.016173
Epoch 34
Loss = 8.4029e-02, PNorm = 44.4561, GNorm = 0.7632, lr_0 = 1.8882e-04
Validation rmse = 0.121823
Validation r2 = 0.849579
Validation mse = 0.014841
Epoch 35
Loss = 9.5810e-02, PNorm = 44.4627, GNorm = 2.5857, lr_0 = 1.8269e-04
Loss = 6.9913e-02, PNorm = 44.4686, GNorm = 1.0893, lr_0 = 1.7730e-04
Validation rmse = 0.117739
Validation r2 = 0.859496
Validation mse = 0.013862
Epoch 36
Loss = 6.7503e-02, PNorm = 44.4747, GNorm = 0.8644, lr_0 = 1.7206e-04
Loss = 7.8065e-02, PNorm = 44.4812, GNorm = 2.2130, lr_0 = 1.6698e-04
Loss = 8.6382e-02, PNorm = 44.4815, GNorm = 3.7106, lr_0 = 1.6648e-04
Validation rmse = 0.119918
Validation r2 = 0.854247
Validation mse = 0.014380
Epoch 37
Loss = 8.5322e-02, PNorm = 44.4873, GNorm = 3.4604, lr_0 = 1.6156e-04
Validation rmse = 0.116541
Validation r2 = 0.862340
Validation mse = 0.013582
Epoch 38
Loss = 9.2147e-02, PNorm = 44.4927, GNorm = 2.0987, lr_0 = 1.5679e-04
Loss = 6.9203e-02, PNorm = 44.4986, GNorm = 0.9319, lr_0 = 1.5216e-04
Validation rmse = 0.118278
Validation r2 = 0.858206
Validation mse = 0.013990
Epoch 39
Loss = 7.5501e-02, PNorm = 44.5037, GNorm = 0.7997, lr_0 = 1.4722e-04
Loss = 6.2515e-02, PNorm = 44.5080, GNorm = 2.7495, lr_0 = 1.4287e-04
Validation rmse = 0.118553
Validation r2 = 0.857545
Validation mse = 0.014055
Epoch 40
Loss = 6.9184e-02, PNorm = 44.5118, GNorm = 1.1413, lr_0 = 1.3865e-04
Validation rmse = 0.115752
Validation r2 = 0.864198
Validation mse = 0.013399
Epoch 41
Loss = 5.8560e-02, PNorm = 44.5161, GNorm = 0.6408, lr_0 = 1.3415e-04
Loss = 6.6655e-02, PNorm = 44.5200, GNorm = 0.7537, lr_0 = 1.3019e-04
Validation rmse = 0.118706
Validation r2 = 0.857177
Validation mse = 0.014091
Epoch 42
Loss = 6.6774e-02, PNorm = 44.5238, GNorm = 0.9056, lr_0 = 1.2635e-04
Validation rmse = 0.118839
Validation r2 = 0.856858
Validation mse = 0.014123
Epoch 43
Loss = 1.0964e-01, PNorm = 44.5285, GNorm = 1.5518, lr_0 = 1.2225e-04
Loss = 5.5210e-02, PNorm = 44.5323, GNorm = 0.7288, lr_0 = 1.1864e-04
Validation rmse = 0.118424
Validation r2 = 0.857855
Validation mse = 0.014024
Epoch 44
Loss = 5.1697e-02, PNorm = 44.5360, GNorm = 1.2902, lr_0 = 1.1513e-04
Loss = 6.8835e-02, PNorm = 44.5400, GNorm = 0.8934, lr_0 = 1.1173e-04
Validation rmse = 0.118072
Validation r2 = 0.858699
Validation mse = 0.013941
Epoch 45
Loss = 5.6934e-02, PNorm = 44.5440, GNorm = 0.8567, lr_0 = 1.0811e-04
Validation rmse = 0.119558
Validation r2 = 0.855121
Validation mse = 0.014294
Epoch 46
Loss = 5.3569e-02, PNorm = 44.5477, GNorm = 0.6649, lr_0 = 1.0491e-04
Loss = 6.9728e-02, PNorm = 44.5509, GNorm = 2.1058, lr_0 = 1.0182e-04
Validation rmse = 0.123145
Validation r2 = 0.846298
Validation mse = 0.015165
Epoch 47
Loss = 6.0546e-02, PNorm = 44.5550, GNorm = 1.2022, lr_0 = 1.0000e-04
Loss = 6.4771e-02, PNorm = 44.5589, GNorm = 1.4604, lr_0 = 1.0000e-04
Validation rmse = 0.116189
Validation r2 = 0.863169
Validation mse = 0.013500
Epoch 48
Loss = 5.5711e-02, PNorm = 44.5607, GNorm = 0.4733, lr_0 = 1.0000e-04
Validation rmse = 0.128756
Validation r2 = 0.831970
Validation mse = 0.016578
Epoch 49
Loss = 8.6455e-02, PNorm = 44.5650, GNorm = 0.9922, lr_0 = 1.0000e-04
Loss = 7.2423e-02, PNorm = 44.5691, GNorm = 1.0416, lr_0 = 1.0000e-04
Validation rmse = 0.123813
Validation r2 = 0.844624
Validation mse = 0.015330
Model 0 best validation rmse = 0.115752 on epoch 40
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.121463
Model 0 test r2 = 0.867759
Model 0 test mse = 0.014753
Ensemble test rmse = 0.121463
Ensemble test r2 = 0.867759
Ensemble test mse = 0.014753
Fold 9
Splitting data with seed 9
Total size = 1,032 | train size = 825 | val size = 103 | test size = 104
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.2616e-01, PNorm = 43.2640, GNorm = 4.6140, lr_0 = 4.0937e-04
Validation rmse = 0.263123
Validation r2 = 0.416477
Validation mse = 0.069234
Epoch 1
Loss = 6.8219e-01, PNorm = 43.2930, GNorm = 4.7251, lr_0 = 7.1875e-04
Loss = 6.9955e-01, PNorm = 43.3416, GNorm = 2.5869, lr_0 = 1.0000e-03
Validation rmse = 0.222803
Validation r2 = 0.581611
Validation mse = 0.049641
Epoch 2
Loss = 4.9963e-01, PNorm = 43.4173, GNorm = 6.6273, lr_0 = 9.7046e-04
Validation rmse = 0.196752
Validation r2 = 0.673731
Validation mse = 0.038711
Epoch 3
Loss = 3.9596e-01, PNorm = 43.5036, GNorm = 0.9832, lr_0 = 9.3898e-04
Loss = 3.2516e-01, PNorm = 43.5765, GNorm = 2.2588, lr_0 = 9.1125e-04
Validation rmse = 0.160520
Validation r2 = 0.782831
Validation mse = 0.025767
Epoch 4
Loss = 3.8133e-01, PNorm = 43.6474, GNorm = 9.9684, lr_0 = 8.8433e-04
Loss = 3.8882e-01, PNorm = 43.7053, GNorm = 6.5721, lr_0 = 8.5821e-04
Validation rmse = 0.171829
Validation r2 = 0.751151
Validation mse = 0.029525
Epoch 5
Loss = 2.6336e-01, PNorm = 43.7605, GNorm = 2.7607, lr_0 = 8.3037e-04
Validation rmse = 0.152973
Validation r2 = 0.802772
Validation mse = 0.023401
Epoch 6
Loss = 1.3222e-01, PNorm = 43.8075, GNorm = 1.8940, lr_0 = 8.0584e-04
Loss = 3.0262e-01, PNorm = 43.8524, GNorm = 2.2398, lr_0 = 7.8204e-04
Validation rmse = 0.147237
Validation r2 = 0.817285
Validation mse = 0.021679
Epoch 7
Loss = 2.0155e-01, PNorm = 43.8891, GNorm = 1.3085, lr_0 = 7.5667e-04
Loss = 1.6447e-01, PNorm = 43.9247, GNorm = 1.2643, lr_0 = 7.3432e-04
Validation rmse = 0.140023
Validation r2 = 0.834752
Validation mse = 0.019606
Epoch 8
Loss = 1.6324e-01, PNorm = 43.9495, GNorm = 2.4155, lr_0 = 7.1263e-04
Validation rmse = 0.156920
Validation r2 = 0.792461
Validation mse = 0.024624
Epoch 9
Loss = 1.7134e-01, PNorm = 43.9776, GNorm = 4.0893, lr_0 = 6.8951e-04
Loss = 1.6300e-01, PNorm = 44.0023, GNorm = 5.4621, lr_0 = 6.6915e-04
Validation rmse = 0.136050
Validation r2 = 0.843996
Validation mse = 0.018510
Epoch 10
Loss = 1.4439e-01, PNorm = 44.0309, GNorm = 2.4431, lr_0 = 6.4938e-04
Loss = 1.4207e-01, PNorm = 44.0540, GNorm = 3.3971, lr_0 = 6.3020e-04
Validation rmse = 0.129214
Validation r2 = 0.859279
Validation mse = 0.016696
Epoch 11
Loss = 1.3648e-01, PNorm = 44.0801, GNorm = 0.9027, lr_0 = 6.0976e-04
Validation rmse = 0.125139
Validation r2 = 0.868015
Validation mse = 0.015660
Epoch 12
Loss = 1.1278e-01, PNorm = 44.0934, GNorm = 1.0744, lr_0 = 5.9175e-04
Loss = 1.3326e-01, PNorm = 44.1099, GNorm = 2.9096, lr_0 = 5.7427e-04
Validation rmse = 0.176486
Validation r2 = 0.737481
Validation mse = 0.031147
Epoch 13
Loss = 1.7493e-01, PNorm = 44.1348, GNorm = 5.4476, lr_0 = 5.5564e-04
Loss = 1.6241e-01, PNorm = 44.1578, GNorm = 1.1370, lr_0 = 5.3923e-04
Validation rmse = 0.143678
Validation r2 = 0.826013
Validation mse = 0.020643
Epoch 14
Loss = 1.3433e-01, PNorm = 44.1753, GNorm = 2.1901, lr_0 = 5.2330e-04
Validation rmse = 0.122377
Validation r2 = 0.873777
Validation mse = 0.014976
Epoch 15
Loss = 1.1697e-01, PNorm = 44.1965, GNorm = 1.4210, lr_0 = 5.0632e-04
Loss = 1.1671e-01, PNorm = 44.2098, GNorm = 1.0078, lr_0 = 4.9137e-04
Validation rmse = 0.121858
Validation r2 = 0.874845
Validation mse = 0.014849
Epoch 16
Loss = 9.9095e-02, PNorm = 44.2247, GNorm = 0.7970, lr_0 = 4.7685e-04
Loss = 1.4422e-01, PNorm = 44.2390, GNorm = 0.7803, lr_0 = 4.6277e-04
Loss = 1.2801e-01, PNorm = 44.2399, GNorm = 2.0891, lr_0 = 4.6138e-04
Validation rmse = 0.136351
Validation r2 = 0.843305
Validation mse = 0.018592
Epoch 17
Loss = 1.1377e-01, PNorm = 44.2548, GNorm = 0.8553, lr_0 = 4.4776e-04
Validation rmse = 0.126175
Validation r2 = 0.865821
Validation mse = 0.015920
Epoch 18
Loss = 1.1325e-01, PNorm = 44.2684, GNorm = 0.9072, lr_0 = 4.3453e-04
Loss = 9.7751e-02, PNorm = 44.2829, GNorm = 0.8635, lr_0 = 4.2170e-04
Validation rmse = 0.128393
Validation r2 = 0.861061
Validation mse = 0.016485
Epoch 19
Loss = 9.9185e-02, PNorm = 44.2961, GNorm = 1.2087, lr_0 = 4.0802e-04
Loss = 1.0685e-01, PNorm = 44.3077, GNorm = 3.2512, lr_0 = 3.9596e-04
Validation rmse = 0.120604
Validation r2 = 0.877409
Validation mse = 0.014545
Epoch 20
Loss = 9.9588e-02, PNorm = 44.3186, GNorm = 0.9528, lr_0 = 3.8427e-04
Validation rmse = 0.119341
Validation r2 = 0.879962
Validation mse = 0.014242
Epoch 21
Loss = 9.4588e-02, PNorm = 44.3286, GNorm = 1.6873, lr_0 = 3.7180e-04
Loss = 1.0096e-01, PNorm = 44.3381, GNorm = 1.3436, lr_0 = 3.6082e-04
Validation rmse = 0.119442
Validation r2 = 0.879758
Validation mse = 0.014266
Epoch 22
Loss = 8.5790e-02, PNorm = 44.3489, GNorm = 0.8173, lr_0 = 3.5016e-04
Validation rmse = 0.120161
Validation r2 = 0.878307
Validation mse = 0.014439
Epoch 23
Loss = 5.3652e-02, PNorm = 44.3595, GNorm = 0.5497, lr_0 = 3.3880e-04
Loss = 9.2982e-02, PNorm = 44.3696, GNorm = 0.5253, lr_0 = 3.2880e-04
Validation rmse = 0.123522
Validation r2 = 0.871403
Validation mse = 0.015258
Epoch 24
Loss = 8.5992e-02, PNorm = 44.3792, GNorm = 2.8581, lr_0 = 3.1908e-04
Loss = 9.7938e-02, PNorm = 44.3888, GNorm = 2.3083, lr_0 = 3.0966e-04
Validation rmse = 0.120729
Validation r2 = 0.877154
Validation mse = 0.014575
Epoch 25
Loss = 9.3628e-02, PNorm = 44.4007, GNorm = 1.0409, lr_0 = 2.9961e-04
Validation rmse = 0.116813
Validation r2 = 0.884994
Validation mse = 0.013645
Epoch 26
Loss = 8.1763e-02, PNorm = 44.4090, GNorm = 0.9168, lr_0 = 2.9076e-04
Loss = 8.4770e-02, PNorm = 44.4159, GNorm = 1.4392, lr_0 = 2.8218e-04
Validation rmse = 0.116630
Validation r2 = 0.885353
Validation mse = 0.013603
Epoch 27
Loss = 7.7637e-02, PNorm = 44.4271, GNorm = 1.3290, lr_0 = 2.7302e-04
Loss = 9.5364e-02, PNorm = 44.4355, GNorm = 2.2176, lr_0 = 2.6496e-04
Validation rmse = 0.133705
Validation r2 = 0.849327
Validation mse = 0.017877
Epoch 28
Loss = 1.1682e-01, PNorm = 44.4440, GNorm = 1.7017, lr_0 = 2.5713e-04
Validation rmse = 0.119313
Validation r2 = 0.880018
Validation mse = 0.014236
Epoch 29
Loss = 5.7840e-02, PNorm = 44.4553, GNorm = 0.6848, lr_0 = 2.4879e-04
Loss = 8.6140e-02, PNorm = 44.4635, GNorm = 0.7030, lr_0 = 2.4144e-04
Validation rmse = 0.115177
Validation r2 = 0.888193
Validation mse = 0.013266
Epoch 30
Loss = 8.3184e-02, PNorm = 44.4711, GNorm = 1.5639, lr_0 = 2.3431e-04
Loss = 7.9646e-02, PNorm = 44.4789, GNorm = 0.6895, lr_0 = 2.2739e-04
Validation rmse = 0.116178
Validation r2 = 0.886241
Validation mse = 0.013497
Epoch 31
Loss = 7.9447e-02, PNorm = 44.4872, GNorm = 2.1403, lr_0 = 2.2001e-04
Validation rmse = 0.115083
Validation r2 = 0.888374
Validation mse = 0.013244
Epoch 32
Loss = 8.3145e-02, PNorm = 44.4941, GNorm = 0.7958, lr_0 = 2.1351e-04
Loss = 8.5467e-02, PNorm = 44.5012, GNorm = 1.1071, lr_0 = 2.0721e-04
Validation rmse = 0.117773
Validation r2 = 0.883096
Validation mse = 0.013870
Epoch 33
Loss = 8.0384e-02, PNorm = 44.5102, GNorm = 0.4630, lr_0 = 2.0049e-04
Loss = 7.6715e-02, PNorm = 44.5161, GNorm = 1.0742, lr_0 = 1.9456e-04
Validation rmse = 0.115979
Validation r2 = 0.886629
Validation mse = 0.013451
Epoch 34
Loss = 7.6879e-02, PNorm = 44.5227, GNorm = 1.4647, lr_0 = 1.8882e-04
Validation rmse = 0.120628
Validation r2 = 0.877360
Validation mse = 0.014551
Epoch 35
Loss = 6.0965e-02, PNorm = 44.5292, GNorm = 1.0735, lr_0 = 1.8269e-04
Loss = 7.5058e-02, PNorm = 44.5358, GNorm = 1.0746, lr_0 = 1.7730e-04
Validation rmse = 0.118524
Validation r2 = 0.881600
Validation mse = 0.014048
Epoch 36
Loss = 6.7902e-02, PNorm = 44.5418, GNorm = 1.2709, lr_0 = 1.7206e-04
Loss = 7.5044e-02, PNorm = 44.5471, GNorm = 1.8230, lr_0 = 1.6698e-04
Loss = 6.6904e-02, PNorm = 44.5477, GNorm = 0.9594, lr_0 = 1.6648e-04
Validation rmse = 0.115801
Validation r2 = 0.886978
Validation mse = 0.013410
Epoch 37
Loss = 7.2060e-02, PNorm = 44.5537, GNorm = 1.4763, lr_0 = 1.6156e-04
Validation rmse = 0.115115
Validation r2 = 0.888313
Validation mse = 0.013251
Epoch 38
Loss = 6.8243e-02, PNorm = 44.5599, GNorm = 0.7924, lr_0 = 1.5679e-04
Loss = 6.6933e-02, PNorm = 44.5646, GNorm = 1.1266, lr_0 = 1.5216e-04
Validation rmse = 0.114950
Validation r2 = 0.888633
Validation mse = 0.013213
Epoch 39
Loss = 7.5502e-02, PNorm = 44.5718, GNorm = 1.4473, lr_0 = 1.4722e-04
Loss = 6.5917e-02, PNorm = 44.5772, GNorm = 1.2662, lr_0 = 1.4287e-04
Validation rmse = 0.117289
Validation r2 = 0.884054
Validation mse = 0.013757
Epoch 40
Loss = 7.0895e-02, PNorm = 44.5821, GNorm = 1.1379, lr_0 = 1.3865e-04
Validation rmse = 0.116814
Validation r2 = 0.884992
Validation mse = 0.013645
Epoch 41
Loss = 6.7279e-02, PNorm = 44.5881, GNorm = 1.6541, lr_0 = 1.3415e-04
Loss = 7.1128e-02, PNorm = 44.5929, GNorm = 1.4608, lr_0 = 1.3019e-04
Validation rmse = 0.115406
Validation r2 = 0.887748
Validation mse = 0.013318
Epoch 42
Loss = 7.9220e-02, PNorm = 44.5982, GNorm = 0.5446, lr_0 = 1.2635e-04
Validation rmse = 0.115581
Validation r2 = 0.887406
Validation mse = 0.013359
Epoch 43
Loss = 6.6910e-02, PNorm = 44.6029, GNorm = 1.3541, lr_0 = 1.2225e-04
Loss = 6.5406e-02, PNorm = 44.6072, GNorm = 0.4131, lr_0 = 1.1864e-04
Validation rmse = 0.115621
Validation r2 = 0.887329
Validation mse = 0.013368
Epoch 44
Loss = 5.8276e-02, PNorm = 44.6115, GNorm = 0.4841, lr_0 = 1.1513e-04
Loss = 7.0911e-02, PNorm = 44.6153, GNorm = 0.5945, lr_0 = 1.1173e-04
Validation rmse = 0.117080
Validation r2 = 0.884468
Validation mse = 0.013708
Epoch 45
Loss = 6.7801e-02, PNorm = 44.6199, GNorm = 0.9176, lr_0 = 1.0811e-04
Validation rmse = 0.114468
Validation r2 = 0.889564
Validation mse = 0.013103
Epoch 46
Loss = 6.0955e-02, PNorm = 44.6237, GNorm = 1.1190, lr_0 = 1.0491e-04
Loss = 6.0519e-02, PNorm = 44.6279, GNorm = 1.8393, lr_0 = 1.0182e-04
Validation rmse = 0.115655
Validation r2 = 0.887263
Validation mse = 0.013376
Epoch 47
Loss = 6.7025e-02, PNorm = 44.6328, GNorm = 0.7588, lr_0 = 1.0000e-04
Loss = 5.6759e-02, PNorm = 44.6369, GNorm = 0.4682, lr_0 = 1.0000e-04
Validation rmse = 0.115715
Validation r2 = 0.887145
Validation mse = 0.013390
Epoch 48
Loss = 6.0668e-02, PNorm = 44.6404, GNorm = 0.4614, lr_0 = 1.0000e-04
Validation rmse = 0.115029
Validation r2 = 0.888479
Validation mse = 0.013232
Epoch 49
Loss = 9.0067e-02, PNorm = 44.6447, GNorm = 0.9440, lr_0 = 1.0000e-04
Loss = 6.0066e-02, PNorm = 44.6487, GNorm = 0.6520, lr_0 = 1.0000e-04
Validation rmse = 0.114404
Validation r2 = 0.889689
Validation mse = 0.013088
Model 0 best validation rmse = 0.114404 on epoch 49
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.107500
Model 0 test r2 = 0.886214
Model 0 test mse = 0.011556
Ensemble test rmse = 0.107500
Ensemble test r2 = 0.886214
Ensemble test mse = 0.011556
10-fold cross validation
	Seed 0 ==> test rmse = 0.108898
	Seed 0 ==> test r2 = 0.905568
	Seed 0 ==> test mse = 0.011859
	Seed 1 ==> test rmse = 0.125604
	Seed 1 ==> test r2 = 0.850484
	Seed 1 ==> test mse = 0.015776
	Seed 2 ==> test rmse = 0.136780
	Seed 2 ==> test r2 = 0.833273
	Seed 2 ==> test mse = 0.018709
	Seed 3 ==> test rmse = 0.112737
	Seed 3 ==> test r2 = 0.860350
	Seed 3 ==> test mse = 0.012710
	Seed 4 ==> test rmse = 0.124189
	Seed 4 ==> test r2 = 0.861288
	Seed 4 ==> test mse = 0.015423
	Seed 5 ==> test rmse = 0.116930
	Seed 5 ==> test r2 = 0.876274
	Seed 5 ==> test mse = 0.013673
	Seed 6 ==> test rmse = 0.133528
	Seed 6 ==> test r2 = 0.839950
	Seed 6 ==> test mse = 0.017830
	Seed 7 ==> test rmse = 0.115134
	Seed 7 ==> test r2 = 0.898066
	Seed 7 ==> test mse = 0.013256
	Seed 8 ==> test rmse = 0.121463
	Seed 8 ==> test r2 = 0.867759
	Seed 8 ==> test mse = 0.014753
	Seed 9 ==> test rmse = 0.107500
	Seed 9 ==> test r2 = 0.886214
	Seed 9 ==> test mse = 0.011556
Overall test rmse = 0.120276 +/- 0.009382
Overall test r2 = 0.867923 +/- 0.022625
Overall test mse = 0.014554 +/- 0.002289
Elapsed time = 0:05:55
