Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/MeOH_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/MeOH_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/MeOH_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 695 | train size = 556 | val size = 139 | test size = 337
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.0346e-01, PNorm = 34.0212, GNorm = 1.3215, lr_0 = 5.5000e-04
Validation rmse = 0.313022
Epoch 1
Loss = 6.6487e-01, PNorm = 34.0699, GNorm = 1.2499, lr_0 = 1.0000e-03
Validation rmse = 0.253697
Epoch 2
Loss = 5.7739e-01, PNorm = 34.1458, GNorm = 17.5463, lr_0 = 9.6108e-04
Validation rmse = 0.226493
Epoch 3
Loss = 5.2523e-01, PNorm = 34.2068, GNorm = 3.3234, lr_0 = 9.2367e-04
Validation rmse = 0.212533
Epoch 4
Loss = 4.4967e-01, PNorm = 34.2710, GNorm = 5.6494, lr_0 = 8.8772e-04
Validation rmse = 0.222369
Epoch 5
Loss = 3.6427e-01, PNorm = 34.3203, GNorm = 2.2256, lr_0 = 8.5317e-04
Validation rmse = 0.262525
Epoch 6
Loss = 4.2386e-01, PNorm = 34.3683, GNorm = 2.7362, lr_0 = 8.1996e-04
Validation rmse = 0.221213
Epoch 7
Loss = 3.4285e-01, PNorm = 34.4202, GNorm = 1.1943, lr_0 = 7.8805e-04
Validation rmse = 0.203649
Epoch 8
Loss = 2.8321e-01, PNorm = 34.4733, GNorm = 2.7081, lr_0 = 7.5737e-04
Loss = 2.4116e-01, PNorm = 34.5084, GNorm = 2.7992, lr_0 = 7.3053e-04
Validation rmse = 0.175942
Epoch 9
Loss = 2.1958e-01, PNorm = 34.5430, GNorm = 2.8639, lr_0 = 7.0463e-04
Validation rmse = 0.171681
Epoch 10
Loss = 1.8521e-01, PNorm = 34.5839, GNorm = 0.8139, lr_0 = 6.7721e-04
Validation rmse = 0.160329
Epoch 11
Loss = 1.8984e-01, PNorm = 34.6236, GNorm = 4.7267, lr_0 = 6.5085e-04
Validation rmse = 0.156050
Epoch 12
Loss = 1.6278e-01, PNorm = 34.6477, GNorm = 1.4463, lr_0 = 6.2552e-04
Validation rmse = 0.158743
Epoch 13
Loss = 1.7853e-01, PNorm = 34.6816, GNorm = 3.1695, lr_0 = 6.0117e-04
Validation rmse = 0.180528
Epoch 14
Loss = 1.5973e-01, PNorm = 34.7086, GNorm = 3.2435, lr_0 = 5.7777e-04
Validation rmse = 0.146764
Epoch 15
Loss = 1.2881e-01, PNorm = 34.7376, GNorm = 0.5475, lr_0 = 5.5528e-04
Validation rmse = 0.151068
Epoch 16
Loss = 1.6132e-01, PNorm = 34.7593, GNorm = 0.7133, lr_0 = 5.3367e-04
Validation rmse = 0.141373
Epoch 17
Loss = 1.5555e-01, PNorm = 34.7786, GNorm = 1.1634, lr_0 = 5.1475e-04
Loss = 1.2483e-01, PNorm = 34.7956, GNorm = 1.2549, lr_0 = 4.9651e-04
Loss = 1.2681e-01, PNorm = 34.7980, GNorm = 1.9207, lr_0 = 4.9472e-04
Validation rmse = 0.149170
Epoch 18
Loss = 1.2300e-01, PNorm = 34.8171, GNorm = 2.3556, lr_0 = 4.7718e-04
Validation rmse = 0.143150
Epoch 19
Loss = 1.2036e-01, PNorm = 34.8284, GNorm = 1.0743, lr_0 = 4.5861e-04
Validation rmse = 0.138898
Epoch 20
Loss = 1.2206e-01, PNorm = 34.8421, GNorm = 1.1131, lr_0 = 4.4076e-04
Validation rmse = 0.156082
Epoch 21
Loss = 1.2170e-01, PNorm = 34.8585, GNorm = 1.2765, lr_0 = 4.2360e-04
Validation rmse = 0.135398
Epoch 22
Loss = 1.1537e-01, PNorm = 34.8681, GNorm = 2.0109, lr_0 = 4.0712e-04
Validation rmse = 0.139585
Epoch 23
Loss = 1.1790e-01, PNorm = 34.8819, GNorm = 2.8424, lr_0 = 3.9127e-04
Validation rmse = 0.137669
Epoch 24
Loss = 1.1464e-01, PNorm = 34.8938, GNorm = 1.2493, lr_0 = 3.7604e-04
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/MeOH_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/MeOH_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/MeOH_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 695 | train size = 556 | val size = 139 | test size = 337
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.0346e-01, PNorm = 34.0212, GNorm = 1.3215, lr_0 = 5.5000e-04
Validation rmse = 0.313022
Epoch 1
Loss = 6.6487e-01, PNorm = 34.0699, GNorm = 1.2499, lr_0 = 1.0000e-03
Validation rmse = 0.253697
Epoch 2
Loss = 5.7739e-01, PNorm = 34.1458, GNorm = 17.5463, lr_0 = 9.6108e-04
Validation rmse = 0.226493
Epoch 3
Loss = 5.2523e-01, PNorm = 34.2068, GNorm = 3.3234, lr_0 = 9.2367e-04
Validation rmse = 0.212533
Epoch 4
Loss = 4.4967e-01, PNorm = 34.2710, GNorm = 5.6494, lr_0 = 8.8772e-04
Validation rmse = 0.222369
Epoch 5
Loss = 3.6427e-01, PNorm = 34.3203, GNorm = 2.2256, lr_0 = 8.5317e-04
Validation rmse = 0.262525
Epoch 6
Loss = 4.2386e-01, PNorm = 34.3683, GNorm = 2.7362, lr_0 = 8.1996e-04
Validation rmse = 0.221213
Epoch 7
Loss = 3.4285e-01, PNorm = 34.4202, GNorm = 1.1943, lr_0 = 7.8805e-04
Validation rmse = 0.203649
Epoch 8
Loss = 2.8321e-01, PNorm = 34.4733, GNorm = 2.7081, lr_0 = 7.5737e-04
Loss = 2.4116e-01, PNorm = 34.5084, GNorm = 2.7992, lr_0 = 7.3053e-04
Validation rmse = 0.175942
Epoch 9
Loss = 2.1958e-01, PNorm = 34.5430, GNorm = 2.8639, lr_0 = 7.0463e-04
Validation rmse = 0.171681
Epoch 10
Loss = 1.8521e-01, PNorm = 34.5839, GNorm = 0.8139, lr_0 = 6.7721e-04
Validation rmse = 0.160329
Epoch 11
Loss = 1.8984e-01, PNorm = 34.6236, GNorm = 4.7267, lr_0 = 6.5085e-04
Validation rmse = 0.156050
Epoch 12
Loss = 1.6278e-01, PNorm = 34.6477, GNorm = 1.4463, lr_0 = 6.2552e-04
Validation rmse = 0.158743
Epoch 13
Loss = 1.7853e-01, PNorm = 34.6816, GNorm = 3.1695, lr_0 = 6.0117e-04
Validation rmse = 0.180528
Epoch 14
Loss = 1.5973e-01, PNorm = 34.7086, GNorm = 3.2435, lr_0 = 5.7777e-04
Validation rmse = 0.146764
Epoch 15
Loss = 1.2881e-01, PNorm = 34.7376, GNorm = 0.5475, lr_0 = 5.5528e-04
Validation rmse = 0.151068
Epoch 16
Loss = 1.6132e-01, PNorm = 34.7593, GNorm = 0.7133, lr_0 = 5.3367e-04
Validation rmse = 0.141373
Epoch 17
Loss = 1.5555e-01, PNorm = 34.7786, GNorm = 1.1634, lr_0 = 5.1475e-04
Loss = 1.2483e-01, PNorm = 34.7956, GNorm = 1.2549, lr_0 = 4.9651e-04
Loss = 1.2681e-01, PNorm = 34.7980, GNorm = 1.9207, lr_0 = 4.9472e-04
Validation rmse = 0.149170
Epoch 18
Loss = 1.2300e-01, PNorm = 34.8171, GNorm = 2.3556, lr_0 = 4.7718e-04
Validation rmse = 0.143150
Epoch 19
Loss = 1.2036e-01, PNorm = 34.8284, GNorm = 1.0743, lr_0 = 4.5861e-04
Validation rmse = 0.138898
Epoch 20
Loss = 1.2206e-01, PNorm = 34.8421, GNorm = 1.1131, lr_0 = 4.4076e-04
Validation rmse = 0.156082
Epoch 21
Loss = 1.2170e-01, PNorm = 34.8585, GNorm = 1.2765, lr_0 = 4.2360e-04
Validation rmse = 0.135398
Epoch 22
Loss = 1.1537e-01, PNorm = 34.8681, GNorm = 2.0109, lr_0 = 4.0712e-04
Validation rmse = 0.139585
Epoch 23
Loss = 1.1790e-01, PNorm = 34.8819, GNorm = 2.8424, lr_0 = 3.9127e-04
Validation rmse = 0.137669
Epoch 24
Loss = 1.1464e-01, PNorm = 34.8938, GNorm = 1.2493, lr_0 = 3.7604e-04
Validation rmse = 0.140407
Epoch 25
Loss = 1.6211e-01, PNorm = 34.9048, GNorm = 1.5027, lr_0 = 3.6271e-04
Validation rmse = 0.150690
Epoch 26
Loss = 1.5006e-01, PNorm = 34.9158, GNorm = 2.6332, lr_0 = 3.4859e-04
Loss = 1.1387e-01, PNorm = 34.9267, GNorm = 2.5315, lr_0 = 3.3624e-04
Loss = 5.5880e-02, PNorm = 34.9277, GNorm = 1.7257, lr_0 = 3.3503e-04
Validation rmse = 0.135915
Epoch 27
Loss = 9.9765e-02, PNorm = 34.9378, GNorm = 0.6349, lr_0 = 3.2315e-04
Validation rmse = 0.133147
Epoch 28
Loss = 1.0785e-01, PNorm = 34.9472, GNorm = 2.9742, lr_0 = 3.1057e-04
Validation rmse = 0.140610
Epoch 29
Loss = 1.0136e-01, PNorm = 34.9558, GNorm = 2.0827, lr_0 = 2.9848e-04
Validation rmse = 0.133619
Epoch 30
Loss = 1.0156e-01, PNorm = 34.9659, GNorm = 0.5227, lr_0 = 2.8687e-04
Validation rmse = 0.131712
Epoch 31
Loss = 1.0347e-01, PNorm = 34.9754, GNorm = 1.4154, lr_0 = 2.7570e-04
Validation rmse = 0.139425
Epoch 32
Loss = 1.0381e-01, PNorm = 34.9841, GNorm = 2.4474, lr_0 = 2.6497e-04
Validation rmse = 0.170964
Epoch 33
Loss = 1.1740e-01, PNorm = 34.9916, GNorm = 0.6511, lr_0 = 2.5466e-04
Validation rmse = 0.143140
Epoch 34
Loss = 1.0984e-01, PNorm = 34.9978, GNorm = 0.4879, lr_0 = 2.4563e-04
Validation rmse = 0.130844
Epoch 35
Loss = 7.7586e-02, PNorm = 35.0045, GNorm = 1.7331, lr_0 = 2.3607e-04
Loss = 1.0592e-01, PNorm = 35.0115, GNorm = 2.3742, lr_0 = 2.2770e-04
Loss = 2.0466e-01, PNorm = 35.0120, GNorm = 2.9569, lr_0 = 2.2688e-04
Validation rmse = 0.136047
Epoch 36
Loss = 1.0350e-01, PNorm = 35.0180, GNorm = 0.4878, lr_0 = 2.1884e-04
Validation rmse = 0.139936
Epoch 37
Loss = 1.0220e-01, PNorm = 35.0250, GNorm = 1.2552, lr_0 = 2.1032e-04
Validation rmse = 0.134338
Epoch 38
Loss = 9.4091e-02, PNorm = 35.0322, GNorm = 0.6563, lr_0 = 2.0214e-04
Validation rmse = 0.131351
Epoch 39
Loss = 9.2748e-02, PNorm = 35.0393, GNorm = 1.5854, lr_0 = 1.9427e-04
Validation rmse = 0.133116
Epoch 40
Loss = 7.5192e-02, PNorm = 35.0454, GNorm = 1.4644, lr_0 = 1.8671e-04
Validation rmse = 0.132539
Epoch 41
Loss = 9.0916e-02, PNorm = 35.0508, GNorm = 1.0339, lr_0 = 1.7944e-04
Validation rmse = 0.130470
Epoch 42
Loss = 8.9544e-02, PNorm = 35.0560, GNorm = 0.7847, lr_0 = 1.7308e-04
Validation rmse = 0.128210
Epoch 43
Loss = 8.5512e-02, PNorm = 35.0613, GNorm = 0.5838, lr_0 = 1.6634e-04
Validation rmse = 0.128005
Epoch 44
Loss = 4.8912e-02, PNorm = 35.0663, GNorm = 0.8605, lr_0 = 1.5987e-04
Loss = 9.7353e-02, PNorm = 35.0707, GNorm = 0.9422, lr_0 = 1.5420e-04
Loss = 2.3344e-01, PNorm = 35.0712, GNorm = 7.2403, lr_0 = 1.5365e-04
Validation rmse = 0.130668
Epoch 45
Loss = 1.0297e-01, PNorm = 35.0796, GNorm = 2.7838, lr_0 = 1.4820e-04
Validation rmse = 0.137238
Epoch 46
Loss = 8.9487e-02, PNorm = 35.0833, GNorm = 1.0039, lr_0 = 1.4243e-04
Validation rmse = 0.131255
Epoch 47
Loss = 8.9622e-02, PNorm = 35.0879, GNorm = 0.8725, lr_0 = 1.3689e-04
Validation rmse = 0.128300
Epoch 48
Loss = 7.9038e-02, PNorm = 35.0912, GNorm = 1.0943, lr_0 = 1.3156e-04
Validation rmse = 0.126476
Epoch 49
Loss = 9.2447e-02, PNorm = 35.0954, GNorm = 0.7784, lr_0 = 1.2644e-04
Validation rmse = 0.135089
Epoch 50
Loss = 1.0443e-01, PNorm = 35.0999, GNorm = 2.5795, lr_0 = 1.2196e-04
Validation rmse = 0.129492
Epoch 51
Loss = 8.1876e-02, PNorm = 35.1033, GNorm = 1.2193, lr_0 = 1.1721e-04
Validation rmse = 0.127176
Epoch 52
Loss = 1.1761e-01, PNorm = 35.1061, GNorm = 0.9981, lr_0 = 1.1265e-04
Validation rmse = 0.128450
Epoch 53
Loss = 7.3307e-02, PNorm = 35.1101, GNorm = 1.4509, lr_0 = 1.0826e-04
Loss = 8.9812e-02, PNorm = 35.1126, GNorm = 2.4074, lr_0 = 1.0443e-04
Loss = 7.0352e-02, PNorm = 35.1129, GNorm = 1.5360, lr_0 = 1.0405e-04
Validation rmse = 0.127656
Epoch 54
Loss = 8.9324e-02, PNorm = 35.1165, GNorm = 1.2239, lr_0 = 1.0036e-04
Validation rmse = 0.131063
Epoch 55
Loss = 8.7108e-02, PNorm = 35.1193, GNorm = 0.8767, lr_0 = 1.0000e-04
Validation rmse = 0.126346
Epoch 56
Loss = 9.8122e-02, PNorm = 35.1228, GNorm = 0.5316, lr_0 = 1.0000e-04
Validation rmse = 0.130642
Epoch 57
Loss = 1.0374e-01, PNorm = 35.1266, GNorm = 1.1492, lr_0 = 1.0000e-04
Validation rmse = 0.128711
Epoch 58
Loss = 8.6572e-02, PNorm = 35.1297, GNorm = 0.6499, lr_0 = 1.0000e-04
Validation rmse = 0.131091
Epoch 59
Loss = 8.3925e-02, PNorm = 35.1326, GNorm = 1.7997, lr_0 = 1.0000e-04
Validation rmse = 0.128634
Model 0 best validation rmse = 0.126346 on epoch 55
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.172333
Ensemble test rmse = 0.172333
1-fold cross validation
	Seed 0 ==> test rmse = 0.172333
Overall test rmse = 0.172333 +/- 0.000000
Elapsed time = 0:00:31
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/EtOH_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/EtOH_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/EtOH_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 976 | train size = 780 | val size = 196 | test size = 56
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.3943e-01, PNorm = 34.0174, GNorm = 1.5897, lr_0 = 4.3000e-04
Validation rmse = 0.296917
Epoch 1
Loss = 8.4995e-01, PNorm = 34.0481, GNorm = 11.3260, lr_0 = 7.6000e-04
Loss = 6.3914e-01, PNorm = 34.1004, GNorm = 7.6501, lr_0 = 9.9472e-04
Validation rmse = 0.255837
Epoch 2
Loss = 4.9744e-01, PNorm = 34.1807, GNorm = 7.9487, lr_0 = 9.6874e-04
Validation rmse = 0.275308
Epoch 3
Loss = 4.1755e-01, PNorm = 34.2661, GNorm = 4.4715, lr_0 = 9.4094e-04
Loss = 3.0876e-01, PNorm = 34.3339, GNorm = 3.8862, lr_0 = 9.1637e-04
Validation rmse = 0.215384
Epoch 4
Loss = 3.1413e-01, PNorm = 34.3979, GNorm = 6.3542, lr_0 = 8.9243e-04
Validation rmse = 0.229391
Epoch 5
Loss = 3.2039e-01, PNorm = 34.4512, GNorm = 1.4805, lr_0 = 8.6912e-04
Loss = 2.5517e-01, PNorm = 34.4984, GNorm = 4.4571, lr_0 = 8.4642e-04
Validation rmse = 0.193342
Epoch 6
Loss = 2.5364e-01, PNorm = 34.5458, GNorm = 5.4321, lr_0 = 8.2213e-04
Validation rmse = 0.184087
Epoch 7
Loss = 1.3215e-01, PNorm = 34.5921, GNorm = 2.1256, lr_0 = 8.0066e-04
Loss = 1.6861e-01, PNorm = 34.6276, GNorm = 0.7448, lr_0 = 7.7975e-04
Validation rmse = 0.193839
Epoch 8
Loss = 1.6087e-01, PNorm = 34.6700, GNorm = 2.3807, lr_0 = 7.5737e-04
Loss = 1.7980e-01, PNorm = 34.7023, GNorm = 3.0051, lr_0 = 7.3759e-04
Validation rmse = 0.174023
Epoch 9
Loss = 1.5027e-01, PNorm = 34.7340, GNorm = 4.9768, lr_0 = 7.1833e-04
Validation rmse = 0.170160
Epoch 10
Loss = 1.4189e-01, PNorm = 34.7701, GNorm = 1.9746, lr_0 = 6.9956e-04
Loss = 1.5579e-01, PNorm = 34.7968, GNorm = 4.9380, lr_0 = 6.8129e-04
Validation rmse = 0.180012
Epoch 11
Loss = 1.5457e-01, PNorm = 34.8252, GNorm = 1.8010, lr_0 = 6.6174e-04
Validation rmse = 0.168240
Epoch 12
Loss = 1.1562e-01, PNorm = 34.8505, GNorm = 0.6084, lr_0 = 6.4446e-04
Loss = 1.1534e-01, PNorm = 34.8777, GNorm = 0.3950, lr_0 = 6.2763e-04
Validation rmse = 0.163066
Epoch 13
Loss = 1.2106e-01, PNorm = 34.8974, GNorm = 2.4045, lr_0 = 6.0962e-04
Validation rmse = 0.162519
Epoch 14
Loss = 1.1040e-01, PNorm = 34.9150, GNorm = 1.3739, lr_0 = 5.9369e-04
Loss = 1.0759e-01, PNorm = 34.9347, GNorm = 0.6258, lr_0 = 5.7819e-04
Validation rmse = 0.159051
Epoch 15
Loss = 9.7854e-02, PNorm = 34.9513, GNorm = 0.6654, lr_0 = 5.6309e-04
Validation rmse = 0.160421
Epoch 16
Loss = 9.4908e-02, PNorm = 34.9707, GNorm = 1.8795, lr_0 = 5.4693e-04
Loss = 1.1257e-01, PNorm = 34.9877, GNorm = 0.9050, lr_0 = 5.3264e-04
Validation rmse = 0.163931
Epoch 17
Loss = 1.1981e-01, PNorm = 35.0047, GNorm = 0.8598, lr_0 = 5.1873e-04
Loss = 1.0430e-01, PNorm = 35.0212, GNorm = 2.2114, lr_0 = 5.0518e-04
Loss = 1.3673e-01, PNorm = 35.0232, GNorm = 2.7588, lr_0 = 5.0385e-04
Validation rmse = 0.160732
Epoch 18
Loss = 1.0797e-01, PNorm = 35.0400, GNorm = 3.1070, lr_0 = 4.9069e-04
Validation rmse = 0.160719
Epoch 19
Loss = 1.1476e-01, PNorm = 35.0560, GNorm = 1.1240, lr_0 = 4.7787e-04
Loss = 9.8131e-02, PNorm = 35.0725, GNorm = 0.7055, lr_0 = 4.6539e-04
Validation rmse = 0.160687
Epoch 20
Loss = 9.6235e-02, PNorm = 35.0862, GNorm = 0.9948, lr_0 = 4.5323e-04
Validation rmse = 0.154689
Epoch 21
Loss = 1.0697e-01, PNorm = 35.1007, GNorm = 0.6763, lr_0 = 4.4023e-04
Loss = 9.2424e-02, PNorm = 35.1151, GNorm = 1.5841, lr_0 = 4.2873e-04
Validation rmse = 0.166026
Epoch 22
Loss = 9.4104e-02, PNorm = 35.1277, GNorm = 1.0019, lr_0 = 4.1753e-04
Validation rmse = 0.157454
Epoch 23
Loss = 8.2283e-02, PNorm = 35.1426, GNorm = 1.2831, lr_0 = 4.0555e-04
Loss = 1.2247e-01, PNorm = 35.1549, GNorm = 1.7793, lr_0 = 3.9496e-04
Validation rmse = 0.158337
Epoch 24
Loss = 9.9489e-02, PNorm = 35.1695, GNorm = 0.7638, lr_0 = 3.8464e-04
Loss = 9.0107e-02, PNorm = 35.1799, GNorm = 0.9696, lr_0 = 3.7460e-04
Validation rmse = 0.155199
Epoch 25
Loss = 9.0242e-02, PNorm = 35.1930, GNorm = 1.2062, lr_0 = 3.6481e-04
Validation rmse = 0.154565
Epoch 26
Loss = 9.0953e-02, PNorm = 35.2061, GNorm = 0.5206, lr_0 = 3.5434e-04
Loss = 9.5116e-02, PNorm = 35.2206, GNorm = 1.0141, lr_0 = 3.4509e-04
Validation rmse = 0.160000
Epoch 27
Loss = 8.9292e-02, PNorm = 35.2321, GNorm = 1.5085, lr_0 = 3.3608e-04
Validation rmse = 0.160363
Epoch 28
Loss = 8.6458e-02, PNorm = 35.2445, GNorm = 1.2383, lr_0 = 3.2643e-04
Loss = 9.4251e-02, PNorm = 35.2543, GNorm = 0.9528, lr_0 = 3.1791e-04
Validation rmse = 0.156147
Epoch 29
Loss = 7.9188e-02, PNorm = 35.2653, GNorm = 1.8861, lr_0 = 3.0960e-04
Validation rmse = 0.160366
Epoch 30
Loss = 7.8039e-02, PNorm = 35.2752, GNorm = 2.0275, lr_0 = 3.0152e-04
Loss = 9.5804e-02, PNorm = 35.2845, GNorm = 1.6780, lr_0 = 2.9364e-04
Validation rmse = 0.162136
Epoch 31
Loss = 8.4485e-02, PNorm = 35.2954, GNorm = 0.8245, lr_0 = 2.8522e-04
Validation rmse = 0.160144
Epoch 32
Loss = 8.0913e-02, PNorm = 35.3057, GNorm = 1.3563, lr_0 = 2.7777e-04
Loss = 8.6088e-02, PNorm = 35.3148, GNorm = 1.3847, lr_0 = 2.7051e-04
Validation rmse = 0.156880
Epoch 33
Loss = 7.9727e-02, PNorm = 35.3248, GNorm = 2.0164, lr_0 = 2.6275e-04
Loss = 8.9662e-02, PNorm = 35.3331, GNorm = 0.8891, lr_0 = 2.5589e-04
Validation rmse = 0.158015
Epoch 34
Loss = 7.5824e-02, PNorm = 35.3436, GNorm = 0.5485, lr_0 = 2.4920e-04
Validation rmse = 0.155907
Epoch 35
Loss = 8.2533e-02, PNorm = 35.3509, GNorm = 2.1122, lr_0 = 2.4269e-04
Loss = 8.2121e-02, PNorm = 35.3595, GNorm = 1.0809, lr_0 = 2.3635e-04
Validation rmse = 0.154457
Epoch 36
Loss = 7.9511e-02, PNorm = 35.3686, GNorm = 0.5034, lr_0 = 2.2957e-04
Validation rmse = 0.156267
Epoch 37
Loss = 5.3044e-02, PNorm = 35.3751, GNorm = 0.4607, lr_0 = 2.2358e-04
Loss = 8.6018e-02, PNorm = 35.3821, GNorm = 0.9393, lr_0 = 2.1774e-04
Validation rmse = 0.158183
Epoch 38
Loss = 7.0175e-02, PNorm = 35.3893, GNorm = 0.8147, lr_0 = 2.1149e-04
Validation rmse = 0.154858
Epoch 39
Loss = 6.5985e-02, PNorm = 35.3963, GNorm = 0.8017, lr_0 = 2.0596e-04
Loss = 8.1436e-02, PNorm = 35.4027, GNorm = 1.6745, lr_0 = 2.0059e-04
Validation rmse = 0.158965
Epoch 40
Loss = 7.4529e-02, PNorm = 35.4097, GNorm = 1.2902, lr_0 = 1.9535e-04
Validation rmse = 0.155946
Epoch 41
Loss = 8.1541e-02, PNorm = 35.4175, GNorm = 1.1762, lr_0 = 1.8974e-04
Loss = 7.4160e-02, PNorm = 35.4232, GNorm = 1.8484, lr_0 = 1.8478e-04
Validation rmse = 0.154805
Epoch 42
Loss = 7.7391e-02, PNorm = 35.4298, GNorm = 1.3175, lr_0 = 1.7996e-04
Loss = 7.3307e-02, PNorm = 35.4360, GNorm = 2.0823, lr_0 = 1.7526e-04
Loss = 4.9791e-02, PNorm = 35.4363, GNorm = 1.1622, lr_0 = 1.7479e-04
Validation rmse = 0.154574
Epoch 43
Loss = 6.8337e-02, PNorm = 35.4423, GNorm = 0.4816, lr_0 = 1.7023e-04
Validation rmse = 0.154400
Epoch 44
Loss = 7.5009e-02, PNorm = 35.4478, GNorm = 1.8629, lr_0 = 1.6578e-04
Loss = 7.3726e-02, PNorm = 35.4541, GNorm = 0.7047, lr_0 = 1.6145e-04
Validation rmse = 0.157389
Epoch 45
Loss = 7.5326e-02, PNorm = 35.4591, GNorm = 1.3526, lr_0 = 1.5724e-04
Validation rmse = 0.154478
Epoch 46
Loss = 5.6361e-02, PNorm = 35.4652, GNorm = 0.6354, lr_0 = 1.5272e-04
Loss = 7.8204e-02, PNorm = 35.4699, GNorm = 0.5789, lr_0 = 1.4874e-04
Validation rmse = 0.154888
Epoch 47
Loss = 6.5567e-02, PNorm = 35.4745, GNorm = 0.8515, lr_0 = 1.4485e-04
Validation rmse = 0.154768
Epoch 48
Loss = 7.4535e-02, PNorm = 35.4793, GNorm = 0.7333, lr_0 = 1.4069e-04
Loss = 7.1310e-02, PNorm = 35.4838, GNorm = 2.5466, lr_0 = 1.3702e-04
Validation rmse = 0.157952
Epoch 49
Loss = 6.8753e-02, PNorm = 35.4893, GNorm = 1.8225, lr_0 = 1.3344e-04
Loss = 7.3682e-02, PNorm = 35.4943, GNorm = 1.1777, lr_0 = 1.2996e-04
Validation rmse = 0.152962
Epoch 50
Loss = 7.3623e-02, PNorm = 35.4987, GNorm = 1.0420, lr_0 = 1.2656e-04
Validation rmse = 0.154368
Epoch 51
Loss = 6.3136e-02, PNorm = 35.5036, GNorm = 1.1281, lr_0 = 1.2293e-04
Loss = 7.7665e-02, PNorm = 35.5071, GNorm = 2.3824, lr_0 = 1.1972e-04
Validation rmse = 0.155232
Epoch 52
Loss = 7.0755e-02, PNorm = 35.5117, GNorm = 2.1572, lr_0 = 1.1659e-04
Validation rmse = 0.156842
Epoch 53
Loss = 6.9755e-02, PNorm = 35.5168, GNorm = 1.9690, lr_0 = 1.1325e-04
Loss = 6.8586e-02, PNorm = 35.5210, GNorm = 0.5087, lr_0 = 1.1029e-04
Validation rmse = 0.154179
Epoch 54
Loss = 6.4099e-02, PNorm = 35.5248, GNorm = 1.1744, lr_0 = 1.0741e-04
Validation rmse = 0.156151
Epoch 55
Loss = 7.9195e-02, PNorm = 35.5284, GNorm = 0.9720, lr_0 = 1.0460e-04
Loss = 6.8183e-02, PNorm = 35.5324, GNorm = 0.6946, lr_0 = 1.0187e-04
Validation rmse = 0.153270
Epoch 56
Loss = 6.6474e-02, PNorm = 35.5358, GNorm = 0.5328, lr_0 = 1.0000e-04
Validation rmse = 0.153235
Epoch 57
Loss = 7.6565e-02, PNorm = 35.5393, GNorm = 1.5549, lr_0 = 1.0000e-04
Loss = 6.5309e-02, PNorm = 35.5430, GNorm = 1.8125, lr_0 = 1.0000e-04
Validation rmse = 0.156705
Epoch 58
Loss = 6.6345e-02, PNorm = 35.5463, GNorm = 1.1893, lr_0 = 1.0000e-04
Loss = 7.0445e-02, PNorm = 35.5502, GNorm = 1.0967, lr_0 = 1.0000e-04
Validation rmse = 0.154804
Epoch 59
Loss = 7.0983e-02, PNorm = 35.5539, GNorm = 1.2585, lr_0 = 1.0000e-04
Validation rmse = 0.154523
Model 0 best validation rmse = 0.152962 on epoch 49
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.145239
Ensemble test rmse = 0.145239
1-fold cross validation
	Seed 0 ==> test rmse = 0.145239
Overall test rmse = 0.145239 +/- 0.000000
Elapsed time = 0:00:41
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/IPA_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/IPA_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/IPA_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 975 | train size = 780 | val size = 195 | test size = 57
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.4870e-01, PNorm = 34.0153, GNorm = 4.4102, lr_0 = 4.3000e-04
Validation rmse = 0.335690
Epoch 1
Loss = 7.7220e-01, PNorm = 34.0458, GNorm = 2.9579, lr_0 = 7.6000e-04
Loss = 6.0635e-01, PNorm = 34.1069, GNorm = 0.9949, lr_0 = 9.9472e-04
Validation rmse = 0.271043
Epoch 2
Loss = 5.3074e-01, PNorm = 34.1839, GNorm = 5.6635, lr_0 = 9.6874e-04
Validation rmse = 0.253465
Epoch 3
Loss = 3.3604e-01, PNorm = 34.2677, GNorm = 4.0302, lr_0 = 9.4094e-04
Loss = 3.7789e-01, PNorm = 34.3343, GNorm = 6.4801, lr_0 = 9.1637e-04
Validation rmse = 0.233587
Epoch 4
Loss = 3.4454e-01, PNorm = 34.3980, GNorm = 1.5795, lr_0 = 8.9243e-04
Validation rmse = 0.219257
Epoch 5
Loss = 2.8379e-01, PNorm = 34.4547, GNorm = 1.7424, lr_0 = 8.6912e-04
Loss = 2.2336e-01, PNorm = 34.5030, GNorm = 0.6180, lr_0 = 8.4642e-04
Validation rmse = 0.192335
Epoch 6
Loss = 2.2993e-01, PNorm = 34.5497, GNorm = 5.3653, lr_0 = 8.2213e-04
Validation rmse = 0.202992
Epoch 7
Loss = 2.3754e-01, PNorm = 34.5917, GNorm = 6.5195, lr_0 = 8.0066e-04
Loss = 1.8765e-01, PNorm = 34.6261, GNorm = 1.7054, lr_0 = 7.7975e-04
Validation rmse = 0.173137
Epoch 8
Loss = 1.6201e-01, PNorm = 34.6600, GNorm = 2.5902, lr_0 = 7.5737e-04
Loss = 1.3842e-01, PNorm = 34.6935, GNorm = 2.8203, lr_0 = 7.3759e-04
Validation rmse = 0.160531
Epoch 9
Loss = 1.4616e-01, PNorm = 34.7241, GNorm = 3.3790, lr_0 = 7.1833e-04
Validation rmse = 0.153222
Epoch 10
Loss = 1.1661e-01, PNorm = 34.7543, GNorm = 3.3655, lr_0 = 6.9956e-04
Loss = 1.4941e-01, PNorm = 34.7807, GNorm = 2.6288, lr_0 = 6.8129e-04
Validation rmse = 0.152811
Epoch 11
Loss = 1.2668e-01, PNorm = 34.8066, GNorm = 1.1626, lr_0 = 6.6174e-04
Validation rmse = 0.154074
Epoch 12
Loss = 1.1581e-01, PNorm = 34.8309, GNorm = 1.2699, lr_0 = 6.4446e-04
Loss = 1.3794e-01, PNorm = 34.8526, GNorm = 1.9758, lr_0 = 6.2763e-04
Validation rmse = 0.151590
Epoch 13
Loss = 1.2592e-01, PNorm = 34.8746, GNorm = 2.6217, lr_0 = 6.0962e-04
Validation rmse = 0.151029
Epoch 14
Loss = 1.5535e-01, PNorm = 34.8927, GNorm = 4.9650, lr_0 = 5.9369e-04
Loss = 1.1711e-01, PNorm = 34.9119, GNorm = 1.8845, lr_0 = 5.7819e-04
Validation rmse = 0.147546
Epoch 15
Loss = 1.0827e-01, PNorm = 34.9242, GNorm = 3.4816, lr_0 = 5.6309e-04
Validation rmse = 0.156778
Epoch 16
Loss = 1.9974e-01, PNorm = 34.9382, GNorm = 4.0340, lr_0 = 5.4693e-04
Loss = 1.2314e-01, PNorm = 34.9584, GNorm = 3.2476, lr_0 = 5.3264e-04
Validation rmse = 0.152843
Epoch 17
Loss = 1.1565e-01, PNorm = 34.9749, GNorm = 2.1687, lr_0 = 5.1873e-04
Loss = 1.0430e-01, PNorm = 34.9897, GNorm = 2.5473, lr_0 = 5.0518e-04
Loss = 1.8096e-01, PNorm = 34.9910, GNorm = 2.9543, lr_0 = 5.0385e-04
Validation rmse = 0.148412
Epoch 18
Loss = 1.0925e-01, PNorm = 35.0062, GNorm = 1.8936, lr_0 = 4.9069e-04
Validation rmse = 0.142575
Epoch 19
Loss = 1.1068e-01, PNorm = 35.0198, GNorm = 2.4300, lr_0 = 4.7787e-04
Loss = 9.9245e-02, PNorm = 35.0326, GNorm = 2.5750, lr_0 = 4.6539e-04
Validation rmse = 0.152077
Epoch 20
Loss = 1.0920e-01, PNorm = 35.0462, GNorm = 1.2435, lr_0 = 4.5323e-04
Validation rmse = 0.148007
Epoch 21
Loss = 1.2221e-01, PNorm = 35.0630, GNorm = 3.9869, lr_0 = 4.4023e-04
Loss = 1.1988e-01, PNorm = 35.0747, GNorm = 1.1455, lr_0 = 4.2873e-04
Validation rmse = 0.143198
Epoch 22
Loss = 9.9950e-02, PNorm = 35.0898, GNorm = 2.6222, lr_0 = 4.1753e-04
Validation rmse = 0.155581
Epoch 23
Loss = 8.2098e-02, PNorm = 35.1011, GNorm = 1.9470, lr_0 = 4.0555e-04
Loss = 9.7992e-02, PNorm = 35.1109, GNorm = 2.5649, lr_0 = 3.9496e-04
Validation rmse = 0.160547
Epoch 24
Loss = 1.0739e-01, PNorm = 35.1233, GNorm = 4.4916, lr_0 = 3.8464e-04
Loss = 1.0068e-01, PNorm = 35.1352, GNorm = 1.8501, lr_0 = 3.7460e-04
Validation rmse = 0.167728
Epoch 25
Loss = 1.1496e-01, PNorm = 35.1456, GNorm = 3.9755, lr_0 = 3.6481e-04
Validation rmse = 0.150498
Epoch 26
Loss = 1.1900e-01, PNorm = 35.1572, GNorm = 1.3046, lr_0 = 3.5434e-04
Loss = 8.6264e-02, PNorm = 35.1695, GNorm = 0.6302, lr_0 = 3.4509e-04
Validation rmse = 0.144343
Epoch 27
Loss = 8.8726e-02, PNorm = 35.1780, GNorm = 0.8509, lr_0 = 3.3608e-04
Validation rmse = 0.143090
Epoch 28
Loss = 9.4295e-02, PNorm = 35.1916, GNorm = 1.0451, lr_0 = 3.2643e-04
Loss = 8.6979e-02, PNorm = 35.2001, GNorm = 0.4738, lr_0 = 3.1791e-04
Validation rmse = 0.144187
Epoch 29
Loss = 9.2552e-02, PNorm = 35.2093, GNorm = 1.2455, lr_0 = 3.0960e-04
Validation rmse = 0.147799
Epoch 30
Loss = 9.6492e-02, PNorm = 35.2182, GNorm = 1.5294, lr_0 = 3.0152e-04
Loss = 9.4843e-02, PNorm = 35.2250, GNorm = 1.8962, lr_0 = 2.9364e-04
Validation rmse = 0.143148
Epoch 31
Loss = 8.6712e-02, PNorm = 35.2353, GNorm = 0.9047, lr_0 = 2.8522e-04
Validation rmse = 0.144283
Epoch 32
Loss = 7.8120e-02, PNorm = 35.2437, GNorm = 1.5474, lr_0 = 2.7777e-04
Loss = 7.9520e-02, PNorm = 35.2509, GNorm = 2.0126, lr_0 = 2.7051e-04
Validation rmse = 0.142408
Epoch 33
Loss = 8.1777e-02, PNorm = 35.2597, GNorm = 0.8348, lr_0 = 2.6275e-04
Loss = 8.8582e-02, PNorm = 35.2668, GNorm = 0.9106, lr_0 = 2.5589e-04
Validation rmse = 0.149377
Epoch 34
Loss = 7.8872e-02, PNorm = 35.2740, GNorm = 2.8559, lr_0 = 2.4920e-04
Validation rmse = 0.152664
Epoch 35
Loss = 7.2127e-02, PNorm = 35.2823, GNorm = 0.9683, lr_0 = 2.4269e-04
Loss = 8.8501e-02, PNorm = 35.2892, GNorm = 1.0909, lr_0 = 2.3635e-04
Validation rmse = 0.144386
Epoch 36
Loss = 8.3630e-02, PNorm = 35.2986, GNorm = 2.1074, lr_0 = 2.2957e-04
Validation rmse = 0.143799
Epoch 37
Loss = 8.6104e-02, PNorm = 35.3042, GNorm = 2.1053, lr_0 = 2.2358e-04
Loss = 8.7860e-02, PNorm = 35.3117, GNorm = 1.0312, lr_0 = 2.1774e-04
Validation rmse = 0.145228
Epoch 38
Loss = 7.9291e-02, PNorm = 35.3162, GNorm = 2.1099, lr_0 = 2.1149e-04
Validation rmse = 0.143666
Epoch 39
Loss = 8.1767e-02, PNorm = 35.3229, GNorm = 1.5995, lr_0 = 2.0596e-04
Loss = 8.2484e-02, PNorm = 35.3299, GNorm = 1.4769, lr_0 = 2.0059e-04
Validation rmse = 0.146633
Epoch 40
Loss = 7.4909e-02, PNorm = 35.3351, GNorm = 0.6707, lr_0 = 1.9535e-04
Validation rmse = 0.144729
Epoch 41
Loss = 6.8500e-02, PNorm = 35.3405, GNorm = 0.7682, lr_0 = 1.8974e-04
Loss = 7.4218e-02, PNorm = 35.3479, GNorm = 1.8987, lr_0 = 1.8478e-04
Validation rmse = 0.144922
Epoch 42
Loss = 7.2319e-02, PNorm = 35.3529, GNorm = 1.6225, lr_0 = 1.7996e-04
Loss = 7.9478e-02, PNorm = 35.3585, GNorm = 0.5134, lr_0 = 1.7526e-04
Loss = 9.5854e-02, PNorm = 35.3590, GNorm = 1.4355, lr_0 = 1.7479e-04
Validation rmse = 0.145212
Epoch 43
Loss = 8.1781e-02, PNorm = 35.3644, GNorm = 1.1827, lr_0 = 1.7023e-04
Validation rmse = 0.145995
Epoch 44
Loss = 8.8803e-02, PNorm = 35.3700, GNorm = 0.7280, lr_0 = 1.6578e-04
Loss = 7.1976e-02, PNorm = 35.3745, GNorm = 1.5866, lr_0 = 1.6145e-04
Validation rmse = 0.142724
Epoch 45
Loss = 8.2171e-02, PNorm = 35.3794, GNorm = 2.2379, lr_0 = 1.5724e-04
Validation rmse = 0.144539
Epoch 46
Loss = 5.9942e-02, PNorm = 35.3839, GNorm = 0.3850, lr_0 = 1.5272e-04
Loss = 8.1281e-02, PNorm = 35.3889, GNorm = 0.8176, lr_0 = 1.4874e-04
Validation rmse = 0.144505
Epoch 47
Loss = 7.1592e-02, PNorm = 35.3930, GNorm = 1.4927, lr_0 = 1.4485e-04
Validation rmse = 0.146084
Epoch 48
Loss = 7.2460e-02, PNorm = 35.3980, GNorm = 2.4048, lr_0 = 1.4069e-04
Loss = 7.1181e-02, PNorm = 35.4018, GNorm = 0.6158, lr_0 = 1.3702e-04
Validation rmse = 0.143455
Epoch 49
Loss = 7.5317e-02, PNorm = 35.4060, GNorm = 1.1963, lr_0 = 1.3344e-04
Loss = 7.2949e-02, PNorm = 35.4108, GNorm = 2.3976, lr_0 = 1.2996e-04
Validation rmse = 0.147884
Epoch 50
Loss = 7.4828e-02, PNorm = 35.4148, GNorm = 0.4592, lr_0 = 1.2656e-04
Validation rmse = 0.143035
Epoch 51
Loss = 8.1654e-02, PNorm = 35.4179, GNorm = 0.8507, lr_0 = 1.2293e-04
Loss = 6.9220e-02, PNorm = 35.4211, GNorm = 1.2850, lr_0 = 1.1972e-04
Validation rmse = 0.144483
Epoch 52
Loss = 6.8010e-02, PNorm = 35.4257, GNorm = 0.9738, lr_0 = 1.1659e-04
Validation rmse = 0.145531
Epoch 53
Loss = 7.1021e-02, PNorm = 35.4297, GNorm = 0.6161, lr_0 = 1.1325e-04
Loss = 7.2466e-02, PNorm = 35.4331, GNorm = 1.0347, lr_0 = 1.1029e-04
Validation rmse = 0.143720
Epoch 54
Loss = 7.9078e-02, PNorm = 35.4364, GNorm = 0.8187, lr_0 = 1.0741e-04
Validation rmse = 0.146125
Epoch 55
Loss = 6.9643e-02, PNorm = 35.4402, GNorm = 1.7163, lr_0 = 1.0460e-04
Loss = 7.2443e-02, PNorm = 35.4435, GNorm = 0.9847, lr_0 = 1.0187e-04
Validation rmse = 0.144401
Epoch 56
Loss = 7.7351e-02, PNorm = 35.4465, GNorm = 0.8858, lr_0 = 1.0000e-04
Validation rmse = 0.145282
Epoch 57
Loss = 5.0510e-02, PNorm = 35.4497, GNorm = 0.4130, lr_0 = 1.0000e-04
Loss = 6.5424e-02, PNorm = 35.4523, GNorm = 0.8360, lr_0 = 1.0000e-04
Validation rmse = 0.150210
Epoch 58
Loss = 8.0512e-02, PNorm = 35.4552, GNorm = 2.0640, lr_0 = 1.0000e-04
Loss = 6.9311e-02, PNorm = 35.4586, GNorm = 1.4328, lr_0 = 1.0000e-04
Validation rmse = 0.144180
Epoch 59
Loss = 7.4136e-02, PNorm = 35.4620, GNorm = 1.7946, lr_0 = 1.0000e-04
Validation rmse = 0.143205
Model 0 best validation rmse = 0.142408 on epoch 32
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.206417
Ensemble test rmse = 0.206417
1-fold cross validation
	Seed 0 ==> test rmse = 0.206417
Overall test rmse = 0.206417 +/- 0.000000
Elapsed time = 0:00:41
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/Tol_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/Tol_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/Tol_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 984 | train size = 787 | val size = 197 | test size = 48
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.6217e-01, PNorm = 34.0157, GNorm = 4.8902, lr_0 = 4.3000e-04
Validation rmse = 0.289945
Epoch 1
Loss = 6.9185e-01, PNorm = 34.0505, GNorm = 1.8296, lr_0 = 7.6000e-04
Loss = 5.0956e-01, PNorm = 34.1226, GNorm = 15.7675, lr_0 = 9.9472e-04
Validation rmse = 0.260058
Epoch 2
Loss = 4.7692e-01, PNorm = 34.1803, GNorm = 1.6346, lr_0 = 9.6874e-04
Validation rmse = 0.221942
Epoch 3
Loss = 3.0665e-01, PNorm = 34.2420, GNorm = 9.8611, lr_0 = 9.4344e-04
Loss = 3.3777e-01, PNorm = 34.2907, GNorm = 4.4834, lr_0 = 9.1879e-04
Validation rmse = 0.216924
Epoch 4
Loss = 3.0359e-01, PNorm = 34.3427, GNorm = 4.8868, lr_0 = 8.9243e-04
Validation rmse = 0.175861
Epoch 5
Loss = 1.4364e-01, PNorm = 34.3887, GNorm = 0.8503, lr_0 = 8.6912e-04
Loss = 1.8782e-01, PNorm = 34.4298, GNorm = 2.3738, lr_0 = 8.4642e-04
Validation rmse = 0.163239
Epoch 6
Loss = 2.2706e-01, PNorm = 34.4667, GNorm = 2.4623, lr_0 = 8.2431e-04
Loss = 1.5891e-01, PNorm = 34.5007, GNorm = 1.5985, lr_0 = 8.0278e-04
Validation rmse = 0.164575
Epoch 7
Loss = 1.7569e-01, PNorm = 34.5282, GNorm = 2.4778, lr_0 = 7.8181e-04
Validation rmse = 0.166282
Epoch 8
Loss = 1.9166e-01, PNorm = 34.5623, GNorm = 4.4228, lr_0 = 7.5938e-04
Loss = 1.5313e-01, PNorm = 34.5887, GNorm = 3.7475, lr_0 = 7.3955e-04
Validation rmse = 0.161240
Epoch 9
Loss = 1.6052e-01, PNorm = 34.6125, GNorm = 2.3897, lr_0 = 7.2023e-04
Validation rmse = 0.160685
Epoch 10
Loss = 1.3864e-01, PNorm = 34.6424, GNorm = 1.3295, lr_0 = 7.0142e-04
Loss = 1.2724e-01, PNorm = 34.6687, GNorm = 0.8268, lr_0 = 6.8310e-04
Validation rmse = 0.155663
Epoch 11
Loss = 1.1998e-01, PNorm = 34.6928, GNorm = 1.6650, lr_0 = 6.6526e-04
Validation rmse = 0.154742
Epoch 12
Loss = 7.7719e-02, PNorm = 34.7147, GNorm = 1.2684, lr_0 = 6.4617e-04
Loss = 1.5410e-01, PNorm = 34.7358, GNorm = 1.6761, lr_0 = 6.2929e-04
Validation rmse = 0.162511
Epoch 13
Loss = 1.2196e-01, PNorm = 34.7539, GNorm = 1.3975, lr_0 = 6.1285e-04
Loss = 1.2109e-01, PNorm = 34.7776, GNorm = 3.5036, lr_0 = 5.9685e-04
Validation rmse = 0.152629
Epoch 14
Loss = 1.2075e-01, PNorm = 34.7953, GNorm = 2.9564, lr_0 = 5.8126e-04
Validation rmse = 0.151607
Epoch 15
Loss = 1.3541e-01, PNorm = 34.8132, GNorm = 1.1018, lr_0 = 5.6607e-04
Loss = 1.1105e-01, PNorm = 34.8308, GNorm = 1.6835, lr_0 = 5.5129e-04
Validation rmse = 0.154765
Epoch 16
Loss = 1.0210e-01, PNorm = 34.8514, GNorm = 2.1654, lr_0 = 5.3547e-04
Validation rmse = 0.164149
Epoch 17
Loss = 1.0991e-01, PNorm = 34.8687, GNorm = 0.9877, lr_0 = 5.2148e-04
Loss = 1.1444e-01, PNorm = 34.8863, GNorm = 2.2169, lr_0 = 5.0786e-04
Validation rmse = 0.152140
Epoch 18
Loss = 1.0136e-01, PNorm = 34.9046, GNorm = 0.9189, lr_0 = 4.9460e-04
Validation rmse = 0.151031
Epoch 19
Loss = 9.5058e-02, PNorm = 34.9197, GNorm = 2.0071, lr_0 = 4.8168e-04
Loss = 9.0224e-02, PNorm = 34.9338, GNorm = 0.5370, lr_0 = 4.6910e-04
Validation rmse = 0.148675
Epoch 20
Loss = 1.0143e-01, PNorm = 34.9515, GNorm = 3.0281, lr_0 = 4.5564e-04
Loss = 9.6891e-02, PNorm = 34.9640, GNorm = 1.9538, lr_0 = 4.4374e-04
Validation rmse = 0.148328
Epoch 21
Loss = 1.0310e-01, PNorm = 34.9797, GNorm = 1.9706, lr_0 = 4.3215e-04
Validation rmse = 0.148461
Epoch 22
Loss = 8.7330e-02, PNorm = 34.9920, GNorm = 0.7972, lr_0 = 4.2086e-04
Loss = 8.6662e-02, PNorm = 35.0073, GNorm = 1.0139, lr_0 = 4.0987e-04
Validation rmse = 0.148254
Epoch 23
Loss = 1.0687e-01, PNorm = 35.0219, GNorm = 3.5121, lr_0 = 3.9916e-04
Validation rmse = 0.173033
Epoch 24
Loss = 1.1227e-01, PNorm = 35.0358, GNorm = 1.1625, lr_0 = 3.8771e-04
Loss = 1.1333e-01, PNorm = 35.0489, GNorm = 1.5589, lr_0 = 3.7758e-04
Validation rmse = 0.146721
Epoch 25
Loss = 8.7150e-02, PNorm = 35.0613, GNorm = 0.4731, lr_0 = 3.6772e-04
Validation rmse = 0.145238
Epoch 26
Loss = 7.5660e-02, PNorm = 35.0740, GNorm = 0.7762, lr_0 = 3.5812e-04
Loss = 9.8421e-02, PNorm = 35.0855, GNorm = 0.6334, lr_0 = 3.4876e-04
Validation rmse = 0.148520
Epoch 27
Loss = 9.7953e-02, PNorm = 35.0992, GNorm = 1.1120, lr_0 = 3.3875e-04
Loss = 9.3997e-02, PNorm = 35.1115, GNorm = 0.6395, lr_0 = 3.2991e-04
Validation rmse = 0.148286
Epoch 28
Loss = 8.3531e-02, PNorm = 35.1240, GNorm = 0.7227, lr_0 = 3.2129e-04
Validation rmse = 0.154200
Epoch 29
Loss = 9.3185e-02, PNorm = 35.1349, GNorm = 1.1088, lr_0 = 3.1290e-04
Loss = 8.8019e-02, PNorm = 35.1448, GNorm = 0.9334, lr_0 = 3.0472e-04
Validation rmse = 0.149079
Epoch 30
Loss = 8.7546e-02, PNorm = 35.1545, GNorm = 0.5713, lr_0 = 2.9677e-04
Validation rmse = 0.147050
Epoch 31
Loss = 7.5547e-02, PNorm = 35.1652, GNorm = 0.8632, lr_0 = 2.8825e-04
Loss = 8.8658e-02, PNorm = 35.1728, GNorm = 1.2330, lr_0 = 2.8072e-04
Validation rmse = 0.144946
Epoch 32
Loss = 8.2751e-02, PNorm = 35.1838, GNorm = 0.9824, lr_0 = 2.7339e-04
Validation rmse = 0.144663
Epoch 33
Loss = 5.5263e-02, PNorm = 35.1926, GNorm = 2.1430, lr_0 = 2.6625e-04
Loss = 8.0750e-02, PNorm = 35.2019, GNorm = 0.8095, lr_0 = 2.5929e-04
Validation rmse = 0.149770
Epoch 34
Loss = 1.0214e-01, PNorm = 35.2104, GNorm = 1.5052, lr_0 = 2.5252e-04
Loss = 7.0703e-02, PNorm = 35.2201, GNorm = 0.6920, lr_0 = 2.4593e-04
Loss = 7.1099e-02, PNorm = 35.2211, GNorm = 1.4360, lr_0 = 2.4528e-04
Validation rmse = 0.146676
Epoch 35
Loss = 7.2348e-02, PNorm = 35.2281, GNorm = 0.5740, lr_0 = 2.3887e-04
Validation rmse = 0.144820
Epoch 36
Loss = 8.5512e-02, PNorm = 35.2362, GNorm = 1.1215, lr_0 = 2.3263e-04
Loss = 7.6524e-02, PNorm = 35.2444, GNorm = 0.5963, lr_0 = 2.2655e-04
Validation rmse = 0.147766
Epoch 37
Loss = 7.9719e-02, PNorm = 35.2524, GNorm = 0.9848, lr_0 = 2.2064e-04
Validation rmse = 0.144119
Epoch 38
Loss = 7.6926e-02, PNorm = 35.2604, GNorm = 0.5562, lr_0 = 2.1487e-04
Loss = 7.2621e-02, PNorm = 35.2691, GNorm = 0.4189, lr_0 = 2.0926e-04
Validation rmse = 0.145976
Epoch 39
Loss = 7.6381e-02, PNorm = 35.2760, GNorm = 0.4438, lr_0 = 2.0326e-04
Validation rmse = 0.150015
Epoch 40
Loss = 9.4280e-02, PNorm = 35.2834, GNorm = 1.4980, lr_0 = 1.9795e-04
Loss = 7.6528e-02, PNorm = 35.2898, GNorm = 0.7904, lr_0 = 1.9278e-04
Validation rmse = 0.145505
Epoch 41
Loss = 7.2511e-02, PNorm = 35.2967, GNorm = 1.2822, lr_0 = 1.8774e-04
Loss = 7.6268e-02, PNorm = 35.3033, GNorm = 2.2740, lr_0 = 1.8284e-04
Validation rmse = 0.144874
Epoch 42
Loss = 7.7227e-02, PNorm = 35.3109, GNorm = 0.7715, lr_0 = 1.7806e-04
Validation rmse = 0.145479
Epoch 43
Loss = 6.9613e-02, PNorm = 35.3184, GNorm = 0.4580, lr_0 = 1.7295e-04
Loss = 6.9452e-02, PNorm = 35.3239, GNorm = 1.5192, lr_0 = 1.6844e-04
Validation rmse = 0.147229
Epoch 44
Loss = 7.2415e-02, PNorm = 35.3302, GNorm = 1.2996, lr_0 = 1.6404e-04
Validation rmse = 0.145844
Epoch 45
Loss = 8.0238e-02, PNorm = 35.3366, GNorm = 1.1993, lr_0 = 1.5975e-04
Loss = 6.4856e-02, PNorm = 35.3427, GNorm = 1.1716, lr_0 = 1.5558e-04
Validation rmse = 0.144848
Epoch 46
Loss = 6.1816e-02, PNorm = 35.3474, GNorm = 0.5281, lr_0 = 1.5152e-04
Validation rmse = 0.144146
Epoch 47
Loss = 3.1461e-02, PNorm = 35.3537, GNorm = 0.3873, lr_0 = 1.4717e-04
Loss = 6.7921e-02, PNorm = 35.3597, GNorm = 0.8831, lr_0 = 1.4332e-04
Validation rmse = 0.144778
Epoch 48
Loss = 7.9135e-02, PNorm = 35.3649, GNorm = 1.0073, lr_0 = 1.3958e-04
Loss = 6.3534e-02, PNorm = 35.3701, GNorm = 2.0843, lr_0 = 1.3594e-04
Validation rmse = 0.145835
Epoch 49
Loss = 6.9438e-02, PNorm = 35.3749, GNorm = 2.2852, lr_0 = 1.3239e-04
Validation rmse = 0.143535
Epoch 50
Loss = 6.5400e-02, PNorm = 35.3802, GNorm = 0.5211, lr_0 = 1.2893e-04
Loss = 7.1445e-02, PNorm = 35.3850, GNorm = 1.2100, lr_0 = 1.2556e-04
Validation rmse = 0.144382
Epoch 51
Loss = 6.8444e-02, PNorm = 35.3907, GNorm = 0.8379, lr_0 = 1.2196e-04
Validation rmse = 0.144797
Epoch 52
Loss = 4.4976e-02, PNorm = 35.3955, GNorm = 0.4822, lr_0 = 1.1877e-04
Loss = 7.2054e-02, PNorm = 35.4001, GNorm = 1.0596, lr_0 = 1.1567e-04
Validation rmse = 0.145483
Epoch 53
Loss = 7.4417e-02, PNorm = 35.4046, GNorm = 2.0282, lr_0 = 1.1265e-04
Validation rmse = 0.144808
Epoch 54
Loss = 3.8243e-02, PNorm = 35.4093, GNorm = 0.8928, lr_0 = 1.0942e-04
Loss = 6.3950e-02, PNorm = 35.4133, GNorm = 0.8395, lr_0 = 1.0656e-04
Validation rmse = 0.144718
Epoch 55
Loss = 5.0359e-02, PNorm = 35.4174, GNorm = 1.1409, lr_0 = 1.0377e-04
Loss = 7.4010e-02, PNorm = 35.4217, GNorm = 0.8022, lr_0 = 1.0106e-04
Validation rmse = 0.143833
Epoch 56
Loss = 6.1415e-02, PNorm = 35.4255, GNorm = 1.0924, lr_0 = 1.0000e-04
Validation rmse = 0.143708
Epoch 57
Loss = 6.5071e-02, PNorm = 35.4292, GNorm = 1.0796, lr_0 = 1.0000e-04
Loss = 6.5703e-02, PNorm = 35.4333, GNorm = 0.4788, lr_0 = 1.0000e-04
Validation rmse = 0.144151
Epoch 58
Loss = 6.4482e-02, PNorm = 35.4371, GNorm = 0.4927, lr_0 = 1.0000e-04
Validation rmse = 0.144750
Epoch 59
Loss = 7.4154e-02, PNorm = 35.4412, GNorm = 0.9909, lr_0 = 1.0000e-04
Loss = 5.3858e-02, PNorm = 35.4453, GNorm = 0.4957, lr_0 = 1.0000e-04
Validation rmse = 0.143931
Model 0 best validation rmse = 0.143535 on epoch 49
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.546436
Ensemble test rmse = 0.546436
1-fold cross validation
	Seed 0 ==> test rmse = 0.546436
Overall test rmse = 0.546436 +/- 0.000000
Elapsed time = 0:00:41
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/Hept_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/Hept_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/Hept_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 983 | train size = 786 | val size = 197 | test size = 49
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.9228e-01, PNorm = 34.0159, GNorm = 2.3371, lr_0 = 4.3000e-04
Validation rmse = 0.264551
Epoch 1
Loss = 7.7340e-01, PNorm = 34.0538, GNorm = 7.5141, lr_0 = 7.6000e-04
Loss = 5.5996e-01, PNorm = 34.1194, GNorm = 13.8660, lr_0 = 9.9472e-04
Validation rmse = 0.243167
Epoch 2
Loss = 5.1418e-01, PNorm = 34.1906, GNorm = 2.5523, lr_0 = 9.6874e-04
Validation rmse = 0.199709
Epoch 3
Loss = 3.5382e-01, PNorm = 34.2662, GNorm = 3.5426, lr_0 = 9.4344e-04
Loss = 3.6703e-01, PNorm = 34.3309, GNorm = 4.4495, lr_0 = 9.1879e-04
Validation rmse = 0.179516
Epoch 4
Loss = 3.6682e-01, PNorm = 34.3862, GNorm = 1.3021, lr_0 = 8.9243e-04
Validation rmse = 0.189125
Epoch 5
Loss = 3.3349e-01, PNorm = 34.4366, GNorm = 4.0654, lr_0 = 8.6912e-04
Loss = 2.9223e-01, PNorm = 34.4868, GNorm = 2.2698, lr_0 = 8.4642e-04
Validation rmse = 0.161159
Epoch 6
Loss = 2.3047e-01, PNorm = 34.5373, GNorm = 2.9520, lr_0 = 8.2431e-04
Loss = 2.4936e-01, PNorm = 34.5805, GNorm = 3.9727, lr_0 = 8.0278e-04
Validation rmse = 0.152088
Epoch 7
Loss = 2.2906e-01, PNorm = 34.6155, GNorm = 5.2414, lr_0 = 7.8181e-04
Validation rmse = 0.197766
Epoch 8
Loss = 2.7161e-01, PNorm = 34.6445, GNorm = 9.2639, lr_0 = 7.5938e-04
Loss = 2.4150e-01, PNorm = 34.6793, GNorm = 0.8571, lr_0 = 7.3955e-04
Validation rmse = 0.161670
Epoch 9
Loss = 1.8143e-01, PNorm = 34.7037, GNorm = 5.2927, lr_0 = 7.2023e-04
Validation rmse = 0.147650
Epoch 10
Loss = 2.0177e-01, PNorm = 34.7315, GNorm = 1.4027, lr_0 = 7.0142e-04
Loss = 1.7824e-01, PNorm = 34.7525, GNorm = 3.0462, lr_0 = 6.8310e-04
Validation rmse = 0.143054
Epoch 11
Loss = 1.6937e-01, PNorm = 34.7777, GNorm = 0.6985, lr_0 = 6.6350e-04
Validation rmse = 0.137268
Epoch 12
Loss = 1.5532e-01, PNorm = 34.7987, GNorm = 1.2983, lr_0 = 6.4617e-04
Loss = 1.7375e-01, PNorm = 34.8198, GNorm = 1.9060, lr_0 = 6.2929e-04
Validation rmse = 0.148008
Epoch 13
Loss = 1.6125e-01, PNorm = 34.8421, GNorm = 1.9128, lr_0 = 6.1285e-04
Loss = 1.5289e-01, PNorm = 34.8571, GNorm = 0.7757, lr_0 = 5.9685e-04
Validation rmse = 0.140961
Epoch 14
Loss = 1.5680e-01, PNorm = 34.8788, GNorm = 2.4444, lr_0 = 5.8126e-04
Validation rmse = 0.135350
Epoch 15
Loss = 1.6934e-01, PNorm = 34.8977, GNorm = 2.1668, lr_0 = 5.6458e-04
Loss = 1.4292e-01, PNorm = 34.9126, GNorm = 0.7318, lr_0 = 5.4983e-04
Validation rmse = 0.141584
Epoch 16
Loss = 1.4910e-01, PNorm = 34.9307, GNorm = 7.4138, lr_0 = 5.3547e-04
Validation rmse = 0.138433
Epoch 17
Loss = 1.3372e-01, PNorm = 34.9472, GNorm = 1.6167, lr_0 = 5.2148e-04
Loss = 1.2955e-01, PNorm = 34.9637, GNorm = 0.9100, lr_0 = 5.0786e-04
Validation rmse = 0.132012
Epoch 18
Loss = 1.2077e-01, PNorm = 34.9815, GNorm = 1.0891, lr_0 = 4.9329e-04
Validation rmse = 0.131932
Epoch 19
Loss = 1.2109e-01, PNorm = 34.9977, GNorm = 1.6165, lr_0 = 4.8041e-04
Loss = 1.3405e-01, PNorm = 35.0119, GNorm = 2.2798, lr_0 = 4.6786e-04
Validation rmse = 0.133488
Epoch 20
Loss = 1.1475e-01, PNorm = 35.0254, GNorm = 1.0686, lr_0 = 4.5564e-04
Loss = 1.5090e-01, PNorm = 35.0383, GNorm = 2.3155, lr_0 = 4.4374e-04
Validation rmse = 0.132167
Epoch 21
Loss = 1.2609e-01, PNorm = 35.0554, GNorm = 4.2610, lr_0 = 4.3215e-04
Validation rmse = 0.132302
Epoch 22
Loss = 1.3986e-01, PNorm = 35.0671, GNorm = 0.7848, lr_0 = 4.1975e-04
Loss = 1.2575e-01, PNorm = 35.0818, GNorm = 0.6946, lr_0 = 4.0878e-04
Validation rmse = 0.132314
Epoch 23
Loss = 1.2839e-01, PNorm = 35.0945, GNorm = 2.4248, lr_0 = 3.9811e-04
Validation rmse = 0.130935
Epoch 24
Loss = 1.1622e-01, PNorm = 35.1076, GNorm = 0.7836, lr_0 = 3.8771e-04
Loss = 1.2219e-01, PNorm = 35.1182, GNorm = 1.7202, lr_0 = 3.7758e-04
Validation rmse = 0.134120
Epoch 25
Loss = 1.1200e-01, PNorm = 35.1292, GNorm = 0.4726, lr_0 = 3.6772e-04
Validation rmse = 0.128835
Epoch 26
Loss = 1.1814e-01, PNorm = 35.1413, GNorm = 1.7247, lr_0 = 3.5717e-04
Loss = 1.1713e-01, PNorm = 35.1527, GNorm = 0.9365, lr_0 = 3.4784e-04
Validation rmse = 0.130235
Epoch 27
Loss = 1.0445e-01, PNorm = 35.1633, GNorm = 1.0895, lr_0 = 3.3875e-04
Loss = 1.2103e-01, PNorm = 35.1736, GNorm = 2.0211, lr_0 = 3.2991e-04
Validation rmse = 0.131679
Epoch 28
Loss = 1.1023e-01, PNorm = 35.1843, GNorm = 1.4596, lr_0 = 3.2129e-04
Validation rmse = 0.129891
Epoch 29
Loss = 1.0535e-01, PNorm = 35.1937, GNorm = 1.4201, lr_0 = 3.1207e-04
Loss = 1.0781e-01, PNorm = 35.2036, GNorm = 0.8507, lr_0 = 3.0392e-04
Validation rmse = 0.128979
Epoch 30
Loss = 1.1759e-01, PNorm = 35.2144, GNorm = 2.2487, lr_0 = 2.9598e-04
Validation rmse = 0.128661
Epoch 31
Loss = 8.3105e-02, PNorm = 35.2245, GNorm = 1.7828, lr_0 = 2.8825e-04
Loss = 1.2542e-01, PNorm = 35.2335, GNorm = 2.7788, lr_0 = 2.8072e-04
Validation rmse = 0.132021
Epoch 32
Loss = 1.2451e-01, PNorm = 35.2440, GNorm = 2.2104, lr_0 = 2.7339e-04
Validation rmse = 0.129758
Epoch 33
Loss = 1.6283e-01, PNorm = 35.2551, GNorm = 1.8050, lr_0 = 2.6554e-04
Loss = 1.0394e-01, PNorm = 35.2633, GNorm = 3.8992, lr_0 = 2.5861e-04
Validation rmse = 0.132504
Epoch 34
Loss = 1.0195e-01, PNorm = 35.2728, GNorm = 1.9902, lr_0 = 2.5185e-04
Loss = 1.1224e-01, PNorm = 35.2809, GNorm = 2.1688, lr_0 = 2.4528e-04
Validation rmse = 0.127289
Epoch 35
Loss = 1.0198e-01, PNorm = 35.2900, GNorm = 0.9375, lr_0 = 2.3887e-04
Validation rmse = 0.129537
Epoch 36
Loss = 1.0556e-01, PNorm = 35.2975, GNorm = 0.8954, lr_0 = 2.3202e-04
Loss = 9.8847e-02, PNorm = 35.3041, GNorm = 1.0113, lr_0 = 2.2596e-04
Validation rmse = 0.128077
Epoch 37
Loss = 1.1046e-01, PNorm = 35.3141, GNorm = 0.6335, lr_0 = 2.2005e-04
Validation rmse = 0.128501
Epoch 38
Loss = 1.0645e-01, PNorm = 35.3206, GNorm = 1.6740, lr_0 = 2.1431e-04
Loss = 1.0007e-01, PNorm = 35.3274, GNorm = 0.5572, lr_0 = 2.0871e-04
Validation rmse = 0.127325
Epoch 39
Loss = 9.8457e-02, PNorm = 35.3348, GNorm = 1.4761, lr_0 = 2.0326e-04
Validation rmse = 0.128343
Epoch 40
Loss = 1.0187e-01, PNorm = 35.3423, GNorm = 2.0283, lr_0 = 1.9743e-04
Loss = 1.0849e-01, PNorm = 35.3507, GNorm = 1.2012, lr_0 = 1.9227e-04
Validation rmse = 0.127677
Epoch 41
Loss = 9.8309e-02, PNorm = 35.3563, GNorm = 0.7105, lr_0 = 1.8725e-04
Loss = 1.0231e-01, PNorm = 35.3616, GNorm = 2.5908, lr_0 = 1.8236e-04
Validation rmse = 0.128620
Epoch 42
Loss = 8.7407e-02, PNorm = 35.3679, GNorm = 1.2240, lr_0 = 1.7759e-04
Validation rmse = 0.128980
Epoch 43
Loss = 7.4968e-02, PNorm = 35.3742, GNorm = 1.0694, lr_0 = 1.7250e-04
Loss = 1.1214e-01, PNorm = 35.3811, GNorm = 1.1113, lr_0 = 1.6799e-04
Validation rmse = 0.128540
Epoch 44
Loss = 9.3336e-02, PNorm = 35.3857, GNorm = 1.3181, lr_0 = 1.6360e-04
Validation rmse = 0.128516
Epoch 45
Loss = 1.0971e-01, PNorm = 35.3914, GNorm = 1.6952, lr_0 = 1.5933e-04
Loss = 9.5390e-02, PNorm = 35.3981, GNorm = 2.2719, lr_0 = 1.5517e-04
Validation rmse = 0.128018
Epoch 46
Loss = 1.0147e-01, PNorm = 35.4022, GNorm = 2.2875, lr_0 = 1.5112e-04
Validation rmse = 0.131900
Epoch 47
Loss = 6.5007e-02, PNorm = 35.4092, GNorm = 1.3835, lr_0 = 1.4678e-04
Loss = 1.1103e-01, PNorm = 35.4147, GNorm = 0.8290, lr_0 = 1.4295e-04
Validation rmse = 0.130272
Epoch 48
Loss = 9.6634e-02, PNorm = 35.4179, GNorm = 1.2558, lr_0 = 1.3921e-04
Loss = 9.9525e-02, PNorm = 35.4242, GNorm = 1.5684, lr_0 = 1.3558e-04
Validation rmse = 0.128608
Epoch 49
Loss = 8.9241e-02, PNorm = 35.4287, GNorm = 0.8625, lr_0 = 1.3204e-04
Validation rmse = 0.131094
Epoch 50
Loss = 1.0270e-01, PNorm = 35.4332, GNorm = 1.1716, lr_0 = 1.2859e-04
Loss = 1.0023e-01, PNorm = 35.4369, GNorm = 2.3007, lr_0 = 1.2523e-04
Validation rmse = 0.127745
Epoch 51
Loss = 8.0949e-02, PNorm = 35.4418, GNorm = 0.5259, lr_0 = 1.2163e-04
Validation rmse = 0.127949
Epoch 52
Loss = 9.4284e-02, PNorm = 35.4469, GNorm = 0.7287, lr_0 = 1.1846e-04
Loss = 9.1600e-02, PNorm = 35.4508, GNorm = 2.6430, lr_0 = 1.1536e-04
Validation rmse = 0.128360
Epoch 53
Loss = 8.9170e-02, PNorm = 35.4547, GNorm = 0.9903, lr_0 = 1.1235e-04
Validation rmse = 0.127842
Epoch 54
Loss = 1.0757e-01, PNorm = 35.4596, GNorm = 0.6072, lr_0 = 1.0913e-04
Loss = 8.2251e-02, PNorm = 35.4632, GNorm = 1.4123, lr_0 = 1.0628e-04
Validation rmse = 0.128795
Epoch 55
Loss = 9.3727e-02, PNorm = 35.4672, GNorm = 0.4024, lr_0 = 1.0350e-04
Loss = 9.5094e-02, PNorm = 35.4707, GNorm = 0.8319, lr_0 = 1.0080e-04
Validation rmse = 0.126922
Epoch 56
Loss = 9.3383e-02, PNorm = 35.4743, GNorm = 0.5835, lr_0 = 1.0000e-04
Validation rmse = 0.127289
Epoch 57
Loss = 1.1095e-01, PNorm = 35.4782, GNorm = 0.9271, lr_0 = 1.0000e-04
Loss = 8.4057e-02, PNorm = 35.4825, GNorm = 1.1873, lr_0 = 1.0000e-04
Validation rmse = 0.130772
Epoch 58
Loss = 8.3998e-02, PNorm = 35.4859, GNorm = 0.7913, lr_0 = 1.0000e-04
Validation rmse = 0.128546
Epoch 59
Loss = 9.2354e-02, PNorm = 35.4891, GNorm = 2.6726, lr_0 = 1.0000e-04
Loss = 9.1711e-02, PNorm = 35.4933, GNorm = 0.8883, lr_0 = 1.0000e-04
Validation rmse = 0.127298
Model 0 best validation rmse = 0.126922 on epoch 55
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.694082
Ensemble test rmse = 0.694082
1-fold cross validation
	Seed 0 ==> test rmse = 0.694082
Overall test rmse = 0.694082 +/- 0.000000
Elapsed time = 0:00:41
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/Acet_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/Acet_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/Acet_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 936 | train size = 748 | val size = 188 | test size = 96
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1374e-01, PNorm = 34.0194, GNorm = 5.8969, lr_0 = 4.5357e-04
Validation rmse = 0.289632
Epoch 1
Loss = 6.0251e-01, PNorm = 34.0641, GNorm = 10.4085, lr_0 = 8.0714e-04
Validation rmse = 0.305579
Epoch 2
Loss = 5.7720e-01, PNorm = 34.1308, GNorm = 13.9780, lr_0 = 9.8872e-04
Loss = 4.7785e-01, PNorm = 34.1961, GNorm = 4.8383, lr_0 = 9.6108e-04
Validation rmse = 0.254494
Epoch 3
Loss = 4.1067e-01, PNorm = 34.2540, GNorm = 4.9512, lr_0 = 9.3421e-04
Validation rmse = 0.203209
Epoch 4
Loss = 3.7336e-01, PNorm = 34.3138, GNorm = 5.0424, lr_0 = 9.0809e-04
Loss = 2.7892e-01, PNorm = 34.3735, GNorm = 1.2603, lr_0 = 8.8270e-04
Validation rmse = 0.176492
Epoch 5
Loss = 2.5466e-01, PNorm = 34.4240, GNorm = 4.9642, lr_0 = 8.5802e-04
Validation rmse = 0.189792
Epoch 6
Loss = 3.3246e-01, PNorm = 34.4707, GNorm = 4.8934, lr_0 = 8.3403e-04
Loss = 2.4502e-01, PNorm = 34.5190, GNorm = 6.8517, lr_0 = 8.1071e-04
Validation rmse = 0.180957
Epoch 7
Loss = 2.6930e-01, PNorm = 34.5560, GNorm = 5.7980, lr_0 = 7.8805e-04
Validation rmse = 0.151804
Epoch 8
Loss = 1.0431e-01, PNorm = 34.5958, GNorm = 1.6196, lr_0 = 7.6601e-04
Loss = 1.6266e-01, PNorm = 34.6356, GNorm = 2.9807, lr_0 = 7.4460e-04
Validation rmse = 0.148283
Epoch 9
Loss = 1.5737e-01, PNorm = 34.6771, GNorm = 1.1695, lr_0 = 7.2378e-04
Validation rmse = 0.140644
Epoch 10
Loss = 1.7091e-01, PNorm = 34.7169, GNorm = 1.6783, lr_0 = 7.0354e-04
Loss = 1.3926e-01, PNorm = 34.7504, GNorm = 5.4753, lr_0 = 6.8387e-04
Validation rmse = 0.149982
Epoch 11
Loss = 1.3056e-01, PNorm = 34.7823, GNorm = 2.5321, lr_0 = 6.6475e-04
Validation rmse = 0.140002
Epoch 12
Loss = 1.2278e-01, PNorm = 34.8097, GNorm = 0.9957, lr_0 = 6.4617e-04
Loss = 1.3849e-01, PNorm = 34.8380, GNorm = 2.9045, lr_0 = 6.2810e-04
Validation rmse = 0.142901
Epoch 13
Loss = 1.3680e-01, PNorm = 34.8625, GNorm = 1.1106, lr_0 = 6.1054e-04
Validation rmse = 0.133600
Epoch 14
Loss = 8.1132e-02, PNorm = 34.8824, GNorm = 1.9502, lr_0 = 5.9347e-04
Loss = 1.2774e-01, PNorm = 34.9044, GNorm = 4.2544, lr_0 = 5.7688e-04
Validation rmse = 0.133138
Epoch 15
Loss = 1.0144e-01, PNorm = 34.9209, GNorm = 1.8374, lr_0 = 5.6075e-04
Validation rmse = 0.140484
Epoch 16
Loss = 9.4796e-02, PNorm = 34.9415, GNorm = 1.1435, lr_0 = 5.4507e-04
Loss = 1.1259e-01, PNorm = 34.9618, GNorm = 0.8844, lr_0 = 5.2983e-04
Validation rmse = 0.136009
Epoch 17
Loss = 1.0541e-01, PNorm = 34.9762, GNorm = 2.9892, lr_0 = 5.1502e-04
Validation rmse = 0.134792
Epoch 18
Loss = 9.7407e-02, PNorm = 34.9922, GNorm = 1.9331, lr_0 = 5.0062e-04
Loss = 9.9644e-02, PNorm = 35.0074, GNorm = 2.6517, lr_0 = 4.8662e-04
Validation rmse = 0.132678
Epoch 19
Loss = 9.1841e-02, PNorm = 35.0222, GNorm = 1.1188, lr_0 = 4.7302e-04
Validation rmse = 0.131332
Epoch 20
Loss = 1.2315e-01, PNorm = 35.0362, GNorm = 1.2169, lr_0 = 4.5979e-04
Loss = 9.8547e-02, PNorm = 35.0508, GNorm = 0.7521, lr_0 = 4.4694e-04
Validation rmse = 0.132437
Epoch 21
Loss = 1.0749e-01, PNorm = 35.0596, GNorm = 2.8071, lr_0 = 4.3444e-04
Validation rmse = 0.131773
Epoch 22
Loss = 6.1434e-02, PNorm = 35.0759, GNorm = 0.5739, lr_0 = 4.2229e-04
Loss = 9.8505e-02, PNorm = 35.0902, GNorm = 1.2221, lr_0 = 4.1049e-04
Validation rmse = 0.136712
Epoch 23
Loss = 1.0470e-01, PNorm = 35.1044, GNorm = 2.7464, lr_0 = 3.9901e-04
Validation rmse = 0.131653
Epoch 24
Loss = 7.5011e-02, PNorm = 35.1155, GNorm = 1.7804, lr_0 = 3.8786e-04
Loss = 9.2349e-02, PNorm = 35.1286, GNorm = 0.7855, lr_0 = 3.7701e-04
Validation rmse = 0.132701
Epoch 25
Loss = 8.3636e-02, PNorm = 35.1345, GNorm = 0.6499, lr_0 = 3.6647e-04
Validation rmse = 0.131583
Epoch 26
Loss = 1.2081e-01, PNorm = 35.1473, GNorm = 2.3179, lr_0 = 3.5522e-04
Loss = 8.6744e-02, PNorm = 35.1575, GNorm = 2.1634, lr_0 = 3.4528e-04
Validation rmse = 0.131905
Epoch 27
Loss = 9.1743e-02, PNorm = 35.1696, GNorm = 0.8937, lr_0 = 3.3563e-04
Validation rmse = 0.130077
Epoch 28
Loss = 7.3618e-02, PNorm = 35.1794, GNorm = 1.2679, lr_0 = 3.2625e-04
Loss = 8.9384e-02, PNorm = 35.1868, GNorm = 2.2596, lr_0 = 3.1713e-04
Validation rmse = 0.146632
Epoch 29
Loss = 1.1070e-01, PNorm = 35.1973, GNorm = 2.0249, lr_0 = 3.0826e-04
Validation rmse = 0.134073
Epoch 30
Loss = 7.3507e-02, PNorm = 35.2082, GNorm = 0.5839, lr_0 = 2.9964e-04
Loss = 9.9194e-02, PNorm = 35.2154, GNorm = 3.2328, lr_0 = 2.9126e-04
Validation rmse = 0.128677
Epoch 31
Loss = 8.0557e-02, PNorm = 35.2262, GNorm = 2.1174, lr_0 = 2.8312e-04
Validation rmse = 0.131842
Epoch 32
Loss = 6.3933e-02, PNorm = 35.2347, GNorm = 1.6586, lr_0 = 2.7520e-04
Loss = 9.0005e-02, PNorm = 35.2427, GNorm = 2.1889, lr_0 = 2.6751e-04
Validation rmse = 0.130716
Epoch 33
Loss = 7.1480e-02, PNorm = 35.2489, GNorm = 0.3614, lr_0 = 2.6003e-04
Validation rmse = 0.129063
Epoch 34
Loss = 9.0485e-02, PNorm = 35.2558, GNorm = 0.9712, lr_0 = 2.5276e-04
Loss = 7.7118e-02, PNorm = 35.2638, GNorm = 2.8289, lr_0 = 2.4569e-04
Validation rmse = 0.133843
Epoch 35
Loss = 9.4752e-02, PNorm = 35.2708, GNorm = 2.4112, lr_0 = 2.3882e-04
Validation rmse = 0.128800
Epoch 36
Loss = 7.3297e-02, PNorm = 35.2779, GNorm = 0.8542, lr_0 = 2.3215e-04
Loss = 8.7407e-02, PNorm = 35.2854, GNorm = 1.8695, lr_0 = 2.2566e-04
Validation rmse = 0.132470
Epoch 37
Loss = 7.3607e-02, PNorm = 35.2914, GNorm = 2.1509, lr_0 = 2.1935e-04
Validation rmse = 0.134068
Epoch 38
Loss = 7.5189e-02, PNorm = 35.2975, GNorm = 2.7816, lr_0 = 2.1321e-04
Loss = 8.2411e-02, PNorm = 35.3043, GNorm = 3.7138, lr_0 = 2.0725e-04
Validation rmse = 0.131088
Epoch 39
Loss = 7.0425e-02, PNorm = 35.3097, GNorm = 1.4097, lr_0 = 2.0146e-04
Validation rmse = 0.128962
Epoch 40
Loss = 8.8865e-02, PNorm = 35.3158, GNorm = 0.8114, lr_0 = 1.9583e-04
Loss = 7.8247e-02, PNorm = 35.3210, GNorm = 2.8509, lr_0 = 1.9035e-04
Validation rmse = 0.128878
Epoch 41
Loss = 7.6053e-02, PNorm = 35.3260, GNorm = 0.7383, lr_0 = 1.8503e-04
Validation rmse = 0.128471
Epoch 42
Loss = 1.1622e-01, PNorm = 35.3321, GNorm = 1.0429, lr_0 = 1.7986e-04
Loss = 7.3568e-02, PNorm = 35.3376, GNorm = 0.9244, lr_0 = 1.7483e-04
Validation rmse = 0.131074
Epoch 43
Loss = 8.1545e-02, PNorm = 35.3424, GNorm = 2.6211, lr_0 = 1.6994e-04
Validation rmse = 0.127371
Epoch 44
Loss = 8.6179e-02, PNorm = 35.3477, GNorm = 1.0650, lr_0 = 1.6519e-04
Loss = 7.4555e-02, PNorm = 35.3527, GNorm = 0.6024, lr_0 = 1.6057e-04
Validation rmse = 0.128173
Epoch 45
Loss = 7.3606e-02, PNorm = 35.3571, GNorm = 1.4030, lr_0 = 1.5608e-04
Validation rmse = 0.128588
Epoch 46
Loss = 9.6849e-02, PNorm = 35.3617, GNorm = 0.8722, lr_0 = 1.5172e-04
Loss = 7.4592e-02, PNorm = 35.3668, GNorm = 1.6381, lr_0 = 1.4748e-04
Validation rmse = 0.129916
Epoch 47
Loss = 7.9843e-02, PNorm = 35.3712, GNorm = 1.5839, lr_0 = 1.4335e-04
Validation rmse = 0.130020
Epoch 48
Loss = 6.5103e-02, PNorm = 35.3751, GNorm = 0.4571, lr_0 = 1.3934e-04
Loss = 7.6654e-02, PNorm = 35.3791, GNorm = 3.6494, lr_0 = 1.3545e-04
Validation rmse = 0.136863
Epoch 49
Loss = 8.1151e-02, PNorm = 35.3842, GNorm = 2.4494, lr_0 = 1.3166e-04
Validation rmse = 0.129816
Epoch 50
Loss = 6.9569e-02, PNorm = 35.3875, GNorm = 1.7483, lr_0 = 1.2798e-04
Loss = 8.1356e-02, PNorm = 35.3917, GNorm = 1.9096, lr_0 = 1.2440e-04
Validation rmse = 0.130896
Epoch 51
Loss = 7.0322e-02, PNorm = 35.3964, GNorm = 2.4421, lr_0 = 1.2058e-04
Validation rmse = 0.127845
Epoch 52
Loss = 8.2071e-02, PNorm = 35.3996, GNorm = 0.8215, lr_0 = 1.1721e-04
Loss = 6.6843e-02, PNorm = 35.4030, GNorm = 1.8726, lr_0 = 1.1393e-04
Validation rmse = 0.128580
Epoch 53
Loss = 7.4522e-02, PNorm = 35.4068, GNorm = 1.1058, lr_0 = 1.1075e-04
Validation rmse = 0.128007
Epoch 54
Loss = 6.6867e-02, PNorm = 35.4103, GNorm = 0.5782, lr_0 = 1.0765e-04
Loss = 6.2222e-02, PNorm = 35.4137, GNorm = 0.8769, lr_0 = 1.0464e-04
Validation rmse = 0.128001
Epoch 55
Loss = 5.8826e-02, PNorm = 35.4161, GNorm = 1.2254, lr_0 = 1.0172e-04
Validation rmse = 0.127694
Epoch 56
Loss = 8.0226e-02, PNorm = 35.4191, GNorm = 1.3110, lr_0 = 1.0000e-04
Loss = 6.7407e-02, PNorm = 35.4226, GNorm = 0.6313, lr_0 = 1.0000e-04
Validation rmse = 0.128474
Epoch 57
Loss = 7.2067e-02, PNorm = 35.4249, GNorm = 1.0039, lr_0 = 1.0000e-04
Validation rmse = 0.128235
Epoch 58
Loss = 6.0206e-02, PNorm = 35.4286, GNorm = 0.5823, lr_0 = 1.0000e-04
Loss = 6.7594e-02, PNorm = 35.4313, GNorm = 0.8649, lr_0 = 1.0000e-04
Validation rmse = 0.127487
Epoch 59
Loss = 7.2413e-02, PNorm = 35.4350, GNorm = 2.5404, lr_0 = 1.0000e-04
Validation rmse = 0.132476
Model 0 best validation rmse = 0.127371 on epoch 43
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.265629
Ensemble test rmse = 0.265629
1-fold cross validation
	Seed 0 ==> test rmse = 0.265629
Overall test rmse = 0.265629 +/- 0.000000
Elapsed time = 0:00:39
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/MeCN_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/MeCN_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/MeCN_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 916 | train size = 732 | val size = 184 | test size = 116
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1503e-01, PNorm = 34.0187, GNorm = 5.3462, lr_0 = 4.5357e-04
Validation rmse = 0.314898
Epoch 1
Loss = 6.2095e-01, PNorm = 34.0650, GNorm = 14.0791, lr_0 = 8.0714e-04
Validation rmse = 0.335121
Epoch 2
Loss = 7.0381e-01, PNorm = 34.1121, GNorm = 12.3984, lr_0 = 9.8872e-04
Loss = 5.6252e-01, PNorm = 34.1746, GNorm = 0.8192, lr_0 = 9.6108e-04
Validation rmse = 0.242451
Epoch 3
Loss = 4.6118e-01, PNorm = 34.2497, GNorm = 7.9945, lr_0 = 9.3156e-04
Validation rmse = 0.215441
Epoch 4
Loss = 2.7293e-01, PNorm = 34.3147, GNorm = 5.7174, lr_0 = 9.0552e-04
Loss = 3.2098e-01, PNorm = 34.3718, GNorm = 6.0730, lr_0 = 8.8020e-04
Validation rmse = 0.208125
Epoch 5
Loss = 2.1750e-01, PNorm = 34.4303, GNorm = 2.0666, lr_0 = 8.5559e-04
Validation rmse = 0.191003
Epoch 6
Loss = 1.5636e-01, PNorm = 34.4853, GNorm = 2.5834, lr_0 = 8.2931e-04
Loss = 2.7488e-01, PNorm = 34.5321, GNorm = 5.4988, lr_0 = 8.0613e-04
Validation rmse = 0.173325
Epoch 7
Loss = 1.8869e-01, PNorm = 34.5751, GNorm = 3.4938, lr_0 = 7.8359e-04
Validation rmse = 0.212678
Epoch 8
Loss = 2.5118e-01, PNorm = 34.6179, GNorm = 1.5453, lr_0 = 7.6168e-04
Loss = 2.6158e-01, PNorm = 34.6558, GNorm = 5.3934, lr_0 = 7.4039e-04
Validation rmse = 0.181298
Epoch 9
Loss = 1.9084e-01, PNorm = 34.6920, GNorm = 5.3922, lr_0 = 7.1765e-04
Validation rmse = 0.159801
Epoch 10
Loss = 2.0347e-01, PNorm = 34.7217, GNorm = 1.1389, lr_0 = 6.9758e-04
Loss = 1.8857e-01, PNorm = 34.7496, GNorm = 4.0763, lr_0 = 6.7808e-04
Validation rmse = 0.155179
Epoch 11
Loss = 1.5408e-01, PNorm = 34.7789, GNorm = 1.6391, lr_0 = 6.5912e-04
Validation rmse = 0.150890
Epoch 12
Loss = 1.3899e-01, PNorm = 34.8003, GNorm = 3.3196, lr_0 = 6.3888e-04
Loss = 1.5568e-01, PNorm = 34.8191, GNorm = 2.7632, lr_0 = 6.2102e-04
Validation rmse = 0.146196
Epoch 13
Loss = 1.3513e-01, PNorm = 34.8354, GNorm = 2.6143, lr_0 = 6.0365e-04
Validation rmse = 0.144914
Epoch 14
Loss = 1.6682e-01, PNorm = 34.8563, GNorm = 4.7387, lr_0 = 5.8512e-04
Validation rmse = 0.148283
Epoch 15
Loss = 1.6565e-01, PNorm = 34.8733, GNorm = 3.3854, lr_0 = 5.6876e-04
Loss = 1.4434e-01, PNorm = 34.8905, GNorm = 2.9021, lr_0 = 5.5285e-04
Validation rmse = 0.149386
Epoch 16
Loss = 1.5658e-01, PNorm = 34.9031, GNorm = 1.9797, lr_0 = 5.3740e-04
Validation rmse = 0.143859
Epoch 17
Loss = 1.1609e-01, PNorm = 34.9193, GNorm = 1.2371, lr_0 = 5.2089e-04
Loss = 1.3112e-01, PNorm = 34.9343, GNorm = 0.5402, lr_0 = 5.0633e-04
Validation rmse = 0.139346
Epoch 18
Loss = 1.1600e-01, PNorm = 34.9478, GNorm = 2.1349, lr_0 = 4.9217e-04
Validation rmse = 0.142932
Epoch 19
Loss = 1.1970e-01, PNorm = 34.9629, GNorm = 1.1030, lr_0 = 4.7841e-04
Loss = 1.2761e-01, PNorm = 34.9763, GNorm = 1.8498, lr_0 = 4.6504e-04
Validation rmse = 0.135933
Epoch 20
Loss = 1.1613e-01, PNorm = 34.9889, GNorm = 1.9119, lr_0 = 4.5076e-04
Validation rmse = 0.137664
Epoch 21
Loss = 1.0018e-01, PNorm = 35.0007, GNorm = 1.1496, lr_0 = 4.3815e-04
Loss = 1.3161e-01, PNorm = 35.0134, GNorm = 1.5301, lr_0 = 4.2590e-04
Validation rmse = 0.137609
Epoch 22
Loss = 1.2593e-01, PNorm = 35.0260, GNorm = 3.0620, lr_0 = 4.1399e-04
Validation rmse = 0.136614
Epoch 23
Loss = 1.3270e-01, PNorm = 35.0363, GNorm = 3.4654, lr_0 = 4.0128e-04
Loss = 1.2774e-01, PNorm = 35.0475, GNorm = 2.2604, lr_0 = 3.9006e-04
Validation rmse = 0.151630
Epoch 24
Loss = 1.1583e-01, PNorm = 35.0584, GNorm = 1.2683, lr_0 = 3.7916e-04
Validation rmse = 0.134304
Epoch 25
Loss = 1.0399e-01, PNorm = 35.0687, GNorm = 1.1920, lr_0 = 3.6856e-04
Loss = 1.2241e-01, PNorm = 35.0798, GNorm = 1.7505, lr_0 = 3.5825e-04
Loss = 7.2840e-02, PNorm = 35.0806, GNorm = 2.5526, lr_0 = 3.5724e-04
Validation rmse = 0.135607
Epoch 26
Loss = 1.2347e-01, PNorm = 35.0896, GNorm = 1.7963, lr_0 = 3.4725e-04
Validation rmse = 0.136043
Epoch 27
Loss = 1.1631e-01, PNorm = 35.1005, GNorm = 0.3960, lr_0 = 3.3754e-04
Validation rmse = 0.133644
Epoch 28
Loss = 1.1755e-01, PNorm = 35.1122, GNorm = 0.5621, lr_0 = 3.2717e-04
Loss = 1.2021e-01, PNorm = 35.1216, GNorm = 2.3091, lr_0 = 3.1803e-04
Validation rmse = 0.134199
Epoch 29
Loss = 1.1590e-01, PNorm = 35.1304, GNorm = 2.1013, lr_0 = 3.0913e-04
Validation rmse = 0.138173
Epoch 30
Loss = 1.1495e-01, PNorm = 35.1412, GNorm = 3.3968, lr_0 = 3.0049e-04
Loss = 1.0220e-01, PNorm = 35.1497, GNorm = 1.2664, lr_0 = 2.9209e-04
Validation rmse = 0.132808
Epoch 31
Loss = 1.2314e-01, PNorm = 35.1598, GNorm = 2.3463, lr_0 = 2.8312e-04
Validation rmse = 0.135817
Epoch 32
Loss = 1.1925e-01, PNorm = 35.1687, GNorm = 1.3557, lr_0 = 2.7520e-04
Loss = 1.0285e-01, PNorm = 35.1790, GNorm = 0.5292, lr_0 = 2.6751e-04
Validation rmse = 0.132988
Epoch 33
Loss = 1.1707e-01, PNorm = 35.1866, GNorm = 0.4239, lr_0 = 2.6003e-04
Validation rmse = 0.139449
Epoch 34
Loss = 1.1694e-01, PNorm = 35.1952, GNorm = 1.4656, lr_0 = 2.5204e-04
Loss = 1.1519e-01, PNorm = 35.2031, GNorm = 2.4191, lr_0 = 2.4500e-04
Validation rmse = 0.134495
Epoch 35
Loss = 1.0875e-01, PNorm = 35.2105, GNorm = 0.5720, lr_0 = 2.3815e-04
Validation rmse = 0.133374
Epoch 36
Loss = 9.8772e-02, PNorm = 35.2172, GNorm = 0.8631, lr_0 = 2.3149e-04
Loss = 1.0758e-01, PNorm = 35.2226, GNorm = 1.8886, lr_0 = 2.2502e-04
Validation rmse = 0.136716
Epoch 37
Loss = 1.1298e-01, PNorm = 35.2298, GNorm = 0.7632, lr_0 = 2.1811e-04
Validation rmse = 0.131077
Epoch 38
Loss = 9.5536e-02, PNorm = 35.2357, GNorm = 0.4834, lr_0 = 2.1201e-04
Loss = 1.0137e-01, PNorm = 35.2418, GNorm = 2.1673, lr_0 = 2.0608e-04
Loss = 1.1913e-01, PNorm = 35.2425, GNorm = 1.6047, lr_0 = 2.0550e-04
Validation rmse = 0.131412
Epoch 39
Loss = 1.0003e-01, PNorm = 35.2487, GNorm = 1.2029, lr_0 = 1.9975e-04
Validation rmse = 0.131755
Epoch 40
Loss = 1.0110e-01, PNorm = 35.2550, GNorm = 0.6292, lr_0 = 1.9417e-04
Loss = 9.7135e-02, PNorm = 35.2606, GNorm = 2.3463, lr_0 = 1.8874e-04
Validation rmse = 0.130733
Epoch 41
Loss = 9.3869e-02, PNorm = 35.2671, GNorm = 1.2923, lr_0 = 1.8346e-04
Validation rmse = 0.131021
Epoch 42
Loss = 9.0742e-02, PNorm = 35.2730, GNorm = 0.6329, lr_0 = 1.7783e-04
Validation rmse = 0.130950
Epoch 43
Loss = 6.1553e-02, PNorm = 35.2779, GNorm = 1.5689, lr_0 = 1.7286e-04
Loss = 9.9811e-02, PNorm = 35.2841, GNorm = 1.9353, lr_0 = 1.6802e-04
Validation rmse = 0.130034
Epoch 44
Loss = 9.2213e-02, PNorm = 35.2887, GNorm = 0.9234, lr_0 = 1.6333e-04
Validation rmse = 0.132148
Epoch 45
Loss = 9.6664e-02, PNorm = 35.2930, GNorm = 1.3919, lr_0 = 1.5831e-04
Loss = 9.7414e-02, PNorm = 35.2986, GNorm = 0.5422, lr_0 = 1.5388e-04
Validation rmse = 0.134063
Epoch 46
Loss = 1.0693e-01, PNorm = 35.3037, GNorm = 1.7443, lr_0 = 1.4958e-04
Validation rmse = 0.130082
Epoch 47
Loss = 8.6711e-02, PNorm = 35.3091, GNorm = 1.4954, lr_0 = 1.4540e-04
Loss = 9.1509e-02, PNorm = 35.3135, GNorm = 1.1916, lr_0 = 1.4133e-04
Validation rmse = 0.130576
Epoch 48
Loss = 9.5227e-02, PNorm = 35.3172, GNorm = 0.8665, lr_0 = 1.3699e-04
Validation rmse = 0.130657
Epoch 49
Loss = 9.2930e-02, PNorm = 35.3219, GNorm = 1.0265, lr_0 = 1.3316e-04
Loss = 9.8618e-02, PNorm = 35.3270, GNorm = 2.0838, lr_0 = 1.2944e-04
Validation rmse = 0.130277
Epoch 50
Loss = 8.9246e-02, PNorm = 35.3298, GNorm = 0.6309, lr_0 = 1.2582e-04
Validation rmse = 0.129319
Epoch 51
Loss = 1.0047e-01, PNorm = 35.3331, GNorm = 2.8456, lr_0 = 1.2196e-04
Loss = 8.8491e-02, PNorm = 35.3367, GNorm = 1.2032, lr_0 = 1.1855e-04
Validation rmse = 0.130077
Epoch 52
Loss = 9.3438e-02, PNorm = 35.3408, GNorm = 1.3070, lr_0 = 1.1523e-04
Validation rmse = 0.128665
Epoch 53
Loss = 8.5542e-02, PNorm = 35.3451, GNorm = 0.4357, lr_0 = 1.1169e-04
Loss = 9.0689e-02, PNorm = 35.3488, GNorm = 0.5935, lr_0 = 1.0857e-04
Validation rmse = 0.130316
Epoch 54
Loss = 8.8171e-02, PNorm = 35.3513, GNorm = 1.4933, lr_0 = 1.0554e-04
Validation rmse = 0.130468
Epoch 55
Loss = 1.1191e-01, PNorm = 35.3546, GNorm = 1.4512, lr_0 = 1.0258e-04
Validation rmse = 0.129822
Epoch 56
Loss = 7.6085e-02, PNorm = 35.3589, GNorm = 1.2309, lr_0 = 1.0000e-04
Loss = 9.6837e-02, PNorm = 35.3617, GNorm = 0.7166, lr_0 = 1.0000e-04
Validation rmse = 0.130661
Epoch 57
Loss = 7.7367e-02, PNorm = 35.3644, GNorm = 1.1072, lr_0 = 1.0000e-04
Validation rmse = 0.129224
Epoch 58
Loss = 1.1854e-01, PNorm = 35.3676, GNorm = 1.7769, lr_0 = 1.0000e-04
Loss = 9.1507e-02, PNorm = 35.3714, GNorm = 0.8516, lr_0 = 1.0000e-04
Validation rmse = 0.128761
Epoch 59
Loss = 9.6342e-02, PNorm = 35.3747, GNorm = 0.7398, lr_0 = 1.0000e-04
Validation rmse = 0.128425
Model 0 best validation rmse = 0.128425 on epoch 59
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.213239
Ensemble test rmse = 0.213239
1-fold cross validation
	Seed 0 ==> test rmse = 0.213239
Overall test rmse = 0.213239 +/- 0.000000
Elapsed time = 0:00:39
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/MTBE_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/MTBE_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/MTBE_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 981 | train size = 784 | val size = 197 | test size = 51
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.2161e-01, PNorm = 34.0175, GNorm = 5.2459, lr_0 = 4.3000e-04
Validation rmse = 0.275664
Epoch 1
Loss = 6.5400e-01, PNorm = 34.0520, GNorm = 6.2599, lr_0 = 7.6000e-04
Loss = 5.2468e-01, PNorm = 34.1136, GNorm = 2.4984, lr_0 = 9.9472e-04
Validation rmse = 0.259389
Epoch 2
Loss = 5.2553e-01, PNorm = 34.1800, GNorm = 1.1446, lr_0 = 9.6874e-04
Validation rmse = 0.193164
Epoch 3
Loss = 3.5361e-01, PNorm = 34.2441, GNorm = 4.1911, lr_0 = 9.4344e-04
Loss = 4.2290e-01, PNorm = 34.3084, GNorm = 8.8950, lr_0 = 9.1879e-04
Validation rmse = 0.204442
Epoch 4
Loss = 4.2225e-01, PNorm = 34.3633, GNorm = 7.9896, lr_0 = 8.9243e-04
Validation rmse = 0.161463
Epoch 5
Loss = 3.2755e-01, PNorm = 34.4172, GNorm = 2.8671, lr_0 = 8.6912e-04
Loss = 2.6363e-01, PNorm = 34.4686, GNorm = 6.6098, lr_0 = 8.4642e-04
Validation rmse = 0.167207
Epoch 6
Loss = 2.7445e-01, PNorm = 34.5128, GNorm = 3.4056, lr_0 = 8.2431e-04
Validation rmse = 0.141271
Epoch 7
Loss = 1.4624e-01, PNorm = 34.5659, GNorm = 1.3542, lr_0 = 8.0066e-04
Loss = 2.2029e-01, PNorm = 34.6051, GNorm = 1.9639, lr_0 = 7.7975e-04
Validation rmse = 0.139632
Epoch 8
Loss = 2.5010e-01, PNorm = 34.6436, GNorm = 5.3934, lr_0 = 7.5938e-04
Loss = 2.8456e-01, PNorm = 34.6829, GNorm = 1.2194, lr_0 = 7.3955e-04
Validation rmse = 0.138676
Epoch 9
Loss = 1.8534e-01, PNorm = 34.7143, GNorm = 0.9728, lr_0 = 7.2023e-04
Validation rmse = 0.140530
Epoch 10
Loss = 1.4211e-01, PNorm = 34.7517, GNorm = 0.8235, lr_0 = 6.9956e-04
Loss = 1.8956e-01, PNorm = 34.7820, GNorm = 3.2330, lr_0 = 6.8129e-04
Validation rmse = 0.129611
Epoch 11
Loss = 1.6225e-01, PNorm = 34.8097, GNorm = 3.1357, lr_0 = 6.6350e-04
Validation rmse = 0.139121
Epoch 12
Loss = 1.1723e-01, PNorm = 34.8364, GNorm = 3.3097, lr_0 = 6.4617e-04
Loss = 1.7354e-01, PNorm = 34.8644, GNorm = 4.2721, lr_0 = 6.2929e-04
Validation rmse = 0.126242
Epoch 13
Loss = 1.4625e-01, PNorm = 34.8902, GNorm = 3.2678, lr_0 = 6.1123e-04
Validation rmse = 0.125487
Epoch 14
Loss = 1.6920e-01, PNorm = 34.9130, GNorm = 0.8123, lr_0 = 5.9527e-04
Loss = 1.5146e-01, PNorm = 34.9392, GNorm = 4.3582, lr_0 = 5.7972e-04
Validation rmse = 0.127273
Epoch 15
Loss = 1.6804e-01, PNorm = 34.9628, GNorm = 2.4949, lr_0 = 5.6458e-04
Loss = 1.4133e-01, PNorm = 34.9852, GNorm = 3.7850, lr_0 = 5.4983e-04
Loss = 5.5361e-02, PNorm = 34.9874, GNorm = 0.8903, lr_0 = 5.4838e-04
Validation rmse = 0.134562
Epoch 16
Loss = 1.5232e-01, PNorm = 35.0082, GNorm = 1.9826, lr_0 = 5.3406e-04
Validation rmse = 0.123422
Epoch 17
Loss = 1.2970e-01, PNorm = 35.0274, GNorm = 1.1094, lr_0 = 5.2011e-04
Loss = 1.3385e-01, PNorm = 35.0458, GNorm = 2.3585, lr_0 = 5.0652e-04
Validation rmse = 0.133000
Epoch 18
Loss = 1.4341e-01, PNorm = 35.0655, GNorm = 1.8284, lr_0 = 4.9329e-04
Validation rmse = 0.123204
Epoch 19
Loss = 1.2614e-01, PNorm = 35.0900, GNorm = 2.2315, lr_0 = 4.7914e-04
Loss = 1.2508e-01, PNorm = 35.1064, GNorm = 2.2559, lr_0 = 4.6662e-04
Validation rmse = 0.122463
Epoch 20
Loss = 1.1837e-01, PNorm = 35.1232, GNorm = 0.6800, lr_0 = 4.5443e-04
Validation rmse = 0.120805
Epoch 21
Loss = 9.7658e-02, PNorm = 35.1412, GNorm = 0.8348, lr_0 = 4.4256e-04
Loss = 1.0811e-01, PNorm = 35.1599, GNorm = 0.8989, lr_0 = 4.3101e-04
Validation rmse = 0.132183
Epoch 22
Loss = 1.1667e-01, PNorm = 35.1767, GNorm = 0.5164, lr_0 = 4.1864e-04
Loss = 1.2289e-01, PNorm = 35.1922, GNorm = 1.8860, lr_0 = 4.0770e-04
Validation rmse = 0.122173
Epoch 23
Loss = 1.1972e-01, PNorm = 35.2091, GNorm = 1.0855, lr_0 = 3.9705e-04
Validation rmse = 0.120484
Epoch 24
Loss = 1.1176e-01, PNorm = 35.2237, GNorm = 1.2238, lr_0 = 3.8668e-04
Loss = 1.0911e-01, PNorm = 35.2353, GNorm = 1.5206, lr_0 = 3.7658e-04
Validation rmse = 0.127320
Epoch 25
Loss = 1.2475e-01, PNorm = 35.2495, GNorm = 1.3726, lr_0 = 3.6675e-04
Validation rmse = 0.121719
Epoch 26
Loss = 1.2587e-01, PNorm = 35.2654, GNorm = 2.0548, lr_0 = 3.5622e-04
Loss = 1.0505e-01, PNorm = 35.2766, GNorm = 3.7709, lr_0 = 3.4692e-04
Validation rmse = 0.127741
Epoch 27
Loss = 1.2154e-01, PNorm = 35.2896, GNorm = 1.2310, lr_0 = 3.3786e-04
Validation rmse = 0.122900
Epoch 28
Loss = 9.2515e-02, PNorm = 35.3024, GNorm = 0.7502, lr_0 = 3.2903e-04
Loss = 1.0800e-01, PNorm = 35.3135, GNorm = 1.4149, lr_0 = 3.2044e-04
Validation rmse = 0.121317
Epoch 29
Loss = 1.1138e-01, PNorm = 35.3285, GNorm = 0.5991, lr_0 = 3.1125e-04
Loss = 1.0008e-01, PNorm = 35.3408, GNorm = 4.1396, lr_0 = 3.0312e-04
Validation rmse = 0.124790
Epoch 30
Loss = 1.0806e-01, PNorm = 35.3514, GNorm = 0.6679, lr_0 = 2.9520e-04
Validation rmse = 0.126186
Epoch 31
Loss = 1.1918e-01, PNorm = 35.3628, GNorm = 1.5504, lr_0 = 2.8749e-04
Loss = 1.0035e-01, PNorm = 35.3732, GNorm = 2.8359, lr_0 = 2.7998e-04
Validation rmse = 0.121674
Epoch 32
Loss = 9.7147e-02, PNorm = 35.3843, GNorm = 1.7566, lr_0 = 2.7195e-04
Validation rmse = 0.123005
Epoch 33
Loss = 1.0152e-01, PNorm = 35.3954, GNorm = 0.8291, lr_0 = 2.6484e-04
Loss = 9.9260e-02, PNorm = 35.4055, GNorm = 2.6907, lr_0 = 2.5793e-04
Validation rmse = 0.127715
Epoch 34
Loss = 9.7685e-02, PNorm = 35.4154, GNorm = 2.3181, lr_0 = 2.5119e-04
Validation rmse = 0.124554
Epoch 35
Loss = 7.4113e-02, PNorm = 35.4265, GNorm = 0.8615, lr_0 = 2.4398e-04
Loss = 1.0422e-01, PNorm = 35.4332, GNorm = 0.7527, lr_0 = 2.3761e-04
Validation rmse = 0.119907
Epoch 36
Loss = 9.1824e-02, PNorm = 35.4423, GNorm = 2.8699, lr_0 = 2.3140e-04
Loss = 1.0653e-01, PNorm = 35.4516, GNorm = 3.1775, lr_0 = 2.2536e-04
Validation rmse = 0.119804
Epoch 37
Loss = 1.0220e-01, PNorm = 35.4598, GNorm = 0.6311, lr_0 = 2.1947e-04
Validation rmse = 0.119640
Epoch 38
Loss = 1.0898e-01, PNorm = 35.4692, GNorm = 3.0231, lr_0 = 2.1317e-04
Loss = 8.8831e-02, PNorm = 35.4772, GNorm = 0.9681, lr_0 = 2.0761e-04
Validation rmse = 0.119160
Epoch 39
Loss = 8.7213e-02, PNorm = 35.4845, GNorm = 2.1263, lr_0 = 2.0218e-04
Validation rmse = 0.126476
Epoch 40
Loss = 8.7925e-02, PNorm = 35.4913, GNorm = 0.7153, lr_0 = 1.9690e-04
Loss = 9.2067e-02, PNorm = 35.4991, GNorm = 3.6843, lr_0 = 1.9176e-04
Validation rmse = 0.120458
Epoch 41
Loss = 9.7575e-02, PNorm = 35.5066, GNorm = 3.0776, lr_0 = 1.8626e-04
Validation rmse = 0.129534
Epoch 42
Loss = 1.1715e-01, PNorm = 35.5146, GNorm = 2.6771, lr_0 = 1.8139e-04
Loss = 9.7565e-02, PNorm = 35.5212, GNorm = 2.1313, lr_0 = 1.7666e-04
Validation rmse = 0.118554
Epoch 43
Loss = 1.0497e-01, PNorm = 35.5280, GNorm = 2.5860, lr_0 = 1.7204e-04
Validation rmse = 0.117897
Epoch 44
Loss = 7.4689e-02, PNorm = 35.5352, GNorm = 1.0946, lr_0 = 1.6710e-04
Loss = 8.4297e-02, PNorm = 35.5421, GNorm = 0.9642, lr_0 = 1.6274e-04
Validation rmse = 0.118732
Epoch 45
Loss = 7.7479e-02, PNorm = 35.5481, GNorm = 1.3483, lr_0 = 1.5849e-04
Loss = 9.2503e-02, PNorm = 35.5531, GNorm = 0.9883, lr_0 = 1.5435e-04
Validation rmse = 0.119265
Epoch 46
Loss = 9.8412e-02, PNorm = 35.5589, GNorm = 3.2182, lr_0 = 1.5032e-04
Validation rmse = 0.120635
Epoch 47
Loss = 8.8710e-02, PNorm = 35.5648, GNorm = 1.9535, lr_0 = 1.4601e-04
Loss = 8.4739e-02, PNorm = 35.5702, GNorm = 1.2982, lr_0 = 1.4219e-04
Validation rmse = 0.118872
Epoch 48
Loss = 8.6947e-02, PNorm = 35.5762, GNorm = 2.1484, lr_0 = 1.3848e-04
Validation rmse = 0.119019
Epoch 49
Loss = 8.4152e-02, PNorm = 35.5803, GNorm = 1.0753, lr_0 = 1.3486e-04
Loss = 8.8333e-02, PNorm = 35.5864, GNorm = 2.4313, lr_0 = 1.3134e-04
Validation rmse = 0.123246
Epoch 50
Loss = 8.8622e-02, PNorm = 35.5908, GNorm = 0.5127, lr_0 = 1.2791e-04
Validation rmse = 0.119826
Epoch 51
Loss = 7.2727e-02, PNorm = 35.5959, GNorm = 0.7168, lr_0 = 1.2424e-04
Loss = 8.8540e-02, PNorm = 35.5999, GNorm = 0.4696, lr_0 = 1.2099e-04
Validation rmse = 0.119737
Epoch 52
Loss = 8.3951e-02, PNorm = 35.6044, GNorm = 0.8409, lr_0 = 1.1783e-04
Loss = 8.5455e-02, PNorm = 35.6084, GNorm = 0.7904, lr_0 = 1.1475e-04
Validation rmse = 0.121624
Epoch 53
Loss = 8.4723e-02, PNorm = 35.6118, GNorm = 0.9862, lr_0 = 1.1176e-04
Validation rmse = 0.123185
Epoch 54
Loss = 9.6569e-02, PNorm = 35.6168, GNorm = 0.6685, lr_0 = 1.0855e-04
Loss = 8.5119e-02, PNorm = 35.6210, GNorm = 1.9171, lr_0 = 1.0572e-04
Validation rmse = 0.120518
Epoch 55
Loss = 8.3926e-02, PNorm = 35.6241, GNorm = 0.8924, lr_0 = 1.0295e-04
Validation rmse = 0.118784
Epoch 56
Loss = 8.1203e-02, PNorm = 35.6280, GNorm = 1.3413, lr_0 = 1.0027e-04
Loss = 8.6382e-02, PNorm = 35.6318, GNorm = 2.0979, lr_0 = 1.0000e-04
Validation rmse = 0.118665
Epoch 57
Loss = 8.2173e-02, PNorm = 35.6355, GNorm = 1.7975, lr_0 = 1.0000e-04
Validation rmse = 0.123598
Epoch 58
Loss = 8.5756e-02, PNorm = 35.6393, GNorm = 2.2084, lr_0 = 1.0000e-04
Loss = 8.3655e-02, PNorm = 35.6423, GNorm = 2.0490, lr_0 = 1.0000e-04
Validation rmse = 0.118508
Epoch 59
Loss = 8.0228e-02, PNorm = 35.6461, GNorm = 1.3514, lr_0 = 1.0000e-04
Loss = 9.1273e-02, PNorm = 35.6498, GNorm = 2.6484, lr_0 = 1.0000e-04
Loss = 7.2669e-02, PNorm = 35.6503, GNorm = 0.9590, lr_0 = 1.0000e-04
Validation rmse = 0.118193
Model 0 best validation rmse = 0.117897 on epoch 43
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.399113
Ensemble test rmse = 0.399113
1-fold cross validation
	Seed 0 ==> test rmse = 0.399113
Overall test rmse = 0.399113 +/- 0.000000
Elapsed time = 0:00:40
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/MeTHF_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/MeTHF_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/MeTHF_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 973 | train size = 778 | val size = 195 | test size = 59
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.7844e-01, PNorm = 34.0182, GNorm = 5.1238, lr_0 = 4.3000e-04
Validation rmse = 0.308439
Epoch 1
Loss = 6.6470e-01, PNorm = 34.0559, GNorm = 2.1101, lr_0 = 7.6000e-04
Loss = 5.3316e-01, PNorm = 34.1295, GNorm = 4.8212, lr_0 = 9.9472e-04
Validation rmse = 0.258635
Epoch 2
Loss = 4.6233e-01, PNorm = 34.2097, GNorm = 4.1415, lr_0 = 9.6874e-04
Validation rmse = 0.216783
Epoch 3
Loss = 3.1188e-01, PNorm = 34.2791, GNorm = 4.3001, lr_0 = 9.4094e-04
Loss = 3.8690e-01, PNorm = 34.3342, GNorm = 7.2130, lr_0 = 9.1637e-04
Validation rmse = 0.220501
Epoch 4
Loss = 3.7849e-01, PNorm = 34.3865, GNorm = 3.2691, lr_0 = 8.9243e-04
Validation rmse = 0.198205
Epoch 5
Loss = 2.8595e-01, PNorm = 34.4388, GNorm = 5.3263, lr_0 = 8.6682e-04
Loss = 2.9500e-01, PNorm = 34.4891, GNorm = 1.1215, lr_0 = 8.4418e-04
Validation rmse = 0.179412
Epoch 6
Loss = 2.1252e-01, PNorm = 34.5303, GNorm = 2.3354, lr_0 = 8.2213e-04
Validation rmse = 0.173705
Epoch 7
Loss = 1.7951e-01, PNorm = 34.5831, GNorm = 1.2135, lr_0 = 7.9854e-04
Loss = 1.8846e-01, PNorm = 34.6205, GNorm = 1.9771, lr_0 = 7.7769e-04
Validation rmse = 0.151086
Epoch 8
Loss = 1.5249e-01, PNorm = 34.6547, GNorm = 1.0967, lr_0 = 7.5737e-04
Loss = 1.6408e-01, PNorm = 34.6893, GNorm = 0.9926, lr_0 = 7.3759e-04
Validation rmse = 0.187344
Epoch 9
Loss = 1.7998e-01, PNorm = 34.7172, GNorm = 6.5529, lr_0 = 7.1833e-04
Validation rmse = 0.182592
Epoch 10
Loss = 2.1776e-01, PNorm = 34.7576, GNorm = 4.5050, lr_0 = 6.9772e-04
Loss = 1.9077e-01, PNorm = 34.7904, GNorm = 2.1991, lr_0 = 6.7949e-04
Validation rmse = 0.146650
Epoch 11
Loss = 1.2609e-01, PNorm = 34.8197, GNorm = 2.4325, lr_0 = 6.6174e-04
Validation rmse = 0.145406
Epoch 12
Loss = 1.4679e-01, PNorm = 34.8456, GNorm = 2.3930, lr_0 = 6.4276e-04
Loss = 1.4592e-01, PNorm = 34.8677, GNorm = 4.2969, lr_0 = 6.2597e-04
Validation rmse = 0.151305
Epoch 13
Loss = 1.4055e-01, PNorm = 34.8897, GNorm = 1.7279, lr_0 = 6.0962e-04
Validation rmse = 0.143241
Epoch 14
Loss = 1.2071e-01, PNorm = 34.9132, GNorm = 3.4940, lr_0 = 5.9213e-04
Loss = 1.2300e-01, PNorm = 34.9365, GNorm = 1.5686, lr_0 = 5.7666e-04
Validation rmse = 0.144171
Epoch 15
Loss = 1.2741e-01, PNorm = 34.9515, GNorm = 4.3359, lr_0 = 5.6160e-04
Validation rmse = 0.139270
Epoch 16
Loss = 1.3986e-01, PNorm = 34.9717, GNorm = 2.0027, lr_0 = 5.4548e-04
Loss = 1.0384e-01, PNorm = 34.9904, GNorm = 1.8771, lr_0 = 5.3124e-04
Validation rmse = 0.141749
Epoch 17
Loss = 1.2439e-01, PNorm = 35.0034, GNorm = 1.1198, lr_0 = 5.1736e-04
Loss = 1.0130e-01, PNorm = 35.0230, GNorm = 3.0529, lr_0 = 5.0385e-04
Validation rmse = 0.146894
Epoch 18
Loss = 1.0118e-01, PNorm = 35.0362, GNorm = 2.2501, lr_0 = 4.9069e-04
Validation rmse = 0.146593
Epoch 19
Loss = 8.7666e-02, PNorm = 35.0547, GNorm = 0.7139, lr_0 = 4.7661e-04
Loss = 1.0547e-01, PNorm = 35.0693, GNorm = 0.5979, lr_0 = 4.6416e-04
Validation rmse = 0.138907
Epoch 20
Loss = 9.7685e-02, PNorm = 35.0846, GNorm = 1.5870, lr_0 = 4.5204e-04
Validation rmse = 0.141763
Epoch 21
Loss = 1.0057e-01, PNorm = 35.0992, GNorm = 2.1320, lr_0 = 4.3906e-04
Loss = 9.7201e-02, PNorm = 35.1132, GNorm = 3.7669, lr_0 = 4.2760e-04
Validation rmse = 0.151508
Epoch 22
Loss = 1.0716e-01, PNorm = 35.1275, GNorm = 1.6864, lr_0 = 4.1643e-04
Validation rmse = 0.140994
Epoch 23
Loss = 8.0953e-02, PNorm = 35.1423, GNorm = 2.8714, lr_0 = 4.0448e-04
Loss = 1.1554e-01, PNorm = 35.1563, GNorm = 2.7483, lr_0 = 3.9391e-04
Validation rmse = 0.144759
Epoch 24
Loss = 8.5859e-02, PNorm = 35.1676, GNorm = 0.6891, lr_0 = 3.8363e-04
Validation rmse = 0.140953
Epoch 25
Loss = 1.1293e-01, PNorm = 35.1809, GNorm = 1.5121, lr_0 = 3.7361e-04
Loss = 9.1714e-02, PNorm = 35.1938, GNorm = 1.4942, lr_0 = 3.6385e-04
Validation rmse = 0.138782
Epoch 26
Loss = 9.4853e-02, PNorm = 35.2072, GNorm = 0.7018, lr_0 = 3.5341e-04
Loss = 9.1978e-02, PNorm = 35.2202, GNorm = 1.2742, lr_0 = 3.4418e-04
Validation rmse = 0.154087
Epoch 27
Loss = 1.0034e-01, PNorm = 35.2337, GNorm = 0.6972, lr_0 = 3.3519e-04
Validation rmse = 0.139670
Epoch 28
Loss = 9.0752e-02, PNorm = 35.2451, GNorm = 0.4804, lr_0 = 3.2557e-04
Loss = 8.1550e-02, PNorm = 35.2548, GNorm = 1.4145, lr_0 = 3.1707e-04
Validation rmse = 0.141289
Epoch 29
Loss = 9.4451e-02, PNorm = 35.2656, GNorm = 2.2714, lr_0 = 3.0878e-04
Validation rmse = 0.141388
Epoch 30
Loss = 1.0205e-01, PNorm = 35.2773, GNorm = 0.8958, lr_0 = 2.9992e-04
Loss = 8.6541e-02, PNorm = 35.2889, GNorm = 2.4895, lr_0 = 2.9209e-04
Validation rmse = 0.139133
Epoch 31
Loss = 7.3500e-02, PNorm = 35.2984, GNorm = 1.2566, lr_0 = 2.8446e-04
Validation rmse = 0.141254
Epoch 32
Loss = 6.1207e-02, PNorm = 35.3101, GNorm = 0.4373, lr_0 = 2.7630e-04
Loss = 8.4046e-02, PNorm = 35.3190, GNorm = 1.0525, lr_0 = 2.6908e-04
Validation rmse = 0.140221
Epoch 33
Loss = 7.2724e-02, PNorm = 35.3292, GNorm = 1.1540, lr_0 = 2.6205e-04
Validation rmse = 0.140925
Epoch 34
Loss = 5.6940e-02, PNorm = 35.3383, GNorm = 1.5385, lr_0 = 2.5521e-04
Loss = 8.4338e-02, PNorm = 35.3471, GNorm = 0.4997, lr_0 = 2.4854e-04
Validation rmse = 0.139840
Epoch 35
Loss = 7.0454e-02, PNorm = 35.3570, GNorm = 1.9737, lr_0 = 2.4141e-04
Loss = 8.2477e-02, PNorm = 35.3654, GNorm = 1.0067, lr_0 = 2.3511e-04
Validation rmse = 0.137517
Epoch 36
Loss = 7.1124e-02, PNorm = 35.3736, GNorm = 1.5712, lr_0 = 2.2897e-04
Validation rmse = 0.142889
Epoch 37
Loss = 8.1045e-02, PNorm = 35.3828, GNorm = 2.6271, lr_0 = 2.2240e-04
Loss = 7.1217e-02, PNorm = 35.3915, GNorm = 0.5368, lr_0 = 2.1659e-04
Validation rmse = 0.141537
Epoch 38
Loss = 7.6261e-02, PNorm = 35.3992, GNorm = 0.8230, lr_0 = 2.1093e-04
Validation rmse = 0.137281
Epoch 39
Loss = 6.4938e-02, PNorm = 35.4073, GNorm = 1.2796, lr_0 = 2.0488e-04
Loss = 7.6046e-02, PNorm = 35.4146, GNorm = 1.0498, lr_0 = 1.9953e-04
Validation rmse = 0.139474
Epoch 40
Loss = 7.5432e-02, PNorm = 35.4219, GNorm = 0.8945, lr_0 = 1.9431e-04
Validation rmse = 0.140250
Epoch 41
Loss = 7.8345e-02, PNorm = 35.4289, GNorm = 0.5994, lr_0 = 1.8874e-04
Loss = 6.8008e-02, PNorm = 35.4345, GNorm = 0.9481, lr_0 = 1.8381e-04
Validation rmse = 0.139093
Epoch 42
Loss = 7.2619e-02, PNorm = 35.4423, GNorm = 0.6905, lr_0 = 1.7901e-04
Validation rmse = 0.140658
Epoch 43
Loss = 6.2169e-02, PNorm = 35.4490, GNorm = 2.0917, lr_0 = 1.7433e-04
Loss = 6.9339e-02, PNorm = 35.4551, GNorm = 1.0766, lr_0 = 1.6978e-04
Validation rmse = 0.139479
Epoch 44
Loss = 6.7391e-02, PNorm = 35.4617, GNorm = 0.9339, lr_0 = 1.6491e-04
Loss = 7.6578e-02, PNorm = 35.4673, GNorm = 1.6225, lr_0 = 1.6060e-04
Validation rmse = 0.139713
Epoch 45
Loss = 7.7999e-02, PNorm = 35.4726, GNorm = 0.9251, lr_0 = 1.5641e-04
Validation rmse = 0.137804
Epoch 46
Loss = 5.8330e-02, PNorm = 35.4791, GNorm = 0.5989, lr_0 = 1.5192e-04
Loss = 8.1396e-02, PNorm = 35.4845, GNorm = 0.6080, lr_0 = 1.4795e-04
Validation rmse = 0.139644
Epoch 47
Loss = 7.0662e-02, PNorm = 35.4899, GNorm = 1.4530, lr_0 = 1.4409e-04
Validation rmse = 0.140813
Epoch 48
Loss = 5.9037e-02, PNorm = 35.4957, GNorm = 0.8164, lr_0 = 1.3995e-04
Loss = 8.0813e-02, PNorm = 35.5004, GNorm = 1.3426, lr_0 = 1.3630e-04
Validation rmse = 0.138297
Epoch 49
Loss = 7.6472e-02, PNorm = 35.5053, GNorm = 0.5969, lr_0 = 1.3274e-04
Validation rmse = 0.138265
Epoch 50
Loss = 8.0495e-02, PNorm = 35.5102, GNorm = 0.4977, lr_0 = 1.2927e-04
Loss = 6.3926e-02, PNorm = 35.5149, GNorm = 2.1703, lr_0 = 1.2589e-04
Validation rmse = 0.139072
Epoch 51
Loss = 6.3409e-02, PNorm = 35.5198, GNorm = 0.5319, lr_0 = 1.2228e-04
Validation rmse = 0.138513
Epoch 52
Loss = 6.6730e-02, PNorm = 35.5239, GNorm = 0.9087, lr_0 = 1.1909e-04
Loss = 6.9183e-02, PNorm = 35.5283, GNorm = 0.6613, lr_0 = 1.1598e-04
Validation rmse = 0.138490
Epoch 53
Loss = 7.0419e-02, PNorm = 35.5324, GNorm = 0.7827, lr_0 = 1.1265e-04
Loss = 6.7397e-02, PNorm = 35.5361, GNorm = 3.8426, lr_0 = 1.0971e-04
Validation rmse = 0.139637
Epoch 54
Loss = 6.3998e-02, PNorm = 35.5395, GNorm = 0.7818, lr_0 = 1.0684e-04
Validation rmse = 0.139864
Epoch 55
Loss = 5.6223e-02, PNorm = 35.5436, GNorm = 0.7956, lr_0 = 1.0377e-04
Loss = 6.8323e-02, PNorm = 35.5465, GNorm = 1.5263, lr_0 = 1.0106e-04
Validation rmse = 0.137658
Epoch 56
Loss = 5.9476e-02, PNorm = 35.5509, GNorm = 0.8865, lr_0 = 1.0000e-04
Validation rmse = 0.140203
Epoch 57
Loss = 6.6340e-02, PNorm = 35.5547, GNorm = 1.2037, lr_0 = 1.0000e-04
Loss = 6.4772e-02, PNorm = 35.5583, GNorm = 0.7467, lr_0 = 1.0000e-04
Validation rmse = 0.137996
Epoch 58
Loss = 6.3868e-02, PNorm = 35.5620, GNorm = 0.6665, lr_0 = 1.0000e-04
Validation rmse = 0.138007
Epoch 59
Loss = 4.6777e-02, PNorm = 35.5655, GNorm = 2.2740, lr_0 = 1.0000e-04
Loss = 6.4741e-02, PNorm = 35.5688, GNorm = 0.6284, lr_0 = 1.0000e-04
Validation rmse = 0.138862
Model 0 best validation rmse = 0.137281 on epoch 38
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.244236
Ensemble test rmse = 0.244236
1-fold cross validation
	Seed 0 ==> test rmse = 0.244236
Overall test rmse = 0.244236 +/- 0.000000
Elapsed time = 0:00:41
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/DMF_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/DMF_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/DMF_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 934 | train size = 747 | val size = 187 | test size = 98
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1846e-01, PNorm = 34.0169, GNorm = 4.4513, lr_0 = 4.5357e-04
Validation rmse = 0.317788
Epoch 1
Loss = 6.8465e-01, PNorm = 34.0567, GNorm = 3.8671, lr_0 = 8.0714e-04
Validation rmse = 0.286314
Epoch 2
Loss = 7.0183e-01, PNorm = 34.1111, GNorm = 6.8028, lr_0 = 9.8872e-04
Loss = 5.0396e-01, PNorm = 34.1819, GNorm = 8.3375, lr_0 = 9.6108e-04
Validation rmse = 0.240348
Epoch 3
Loss = 3.7533e-01, PNorm = 34.2486, GNorm = 1.4161, lr_0 = 9.3421e-04
Validation rmse = 0.230508
Epoch 4
Loss = 2.8555e-01, PNorm = 34.3174, GNorm = 6.1392, lr_0 = 9.0809e-04
Loss = 3.4793e-01, PNorm = 34.3829, GNorm = 2.3509, lr_0 = 8.8270e-04
Validation rmse = 0.194878
Epoch 5
Loss = 2.6385e-01, PNorm = 34.4484, GNorm = 0.7204, lr_0 = 8.5802e-04
Validation rmse = 0.178318
Epoch 6
Loss = 2.1672e-01, PNorm = 34.5067, GNorm = 2.2115, lr_0 = 8.3403e-04
Loss = 1.9851e-01, PNorm = 34.5590, GNorm = 1.7547, lr_0 = 8.1071e-04
Validation rmse = 0.170791
Epoch 7
Loss = 2.4177e-01, PNorm = 34.6023, GNorm = 8.5956, lr_0 = 7.8805e-04
Validation rmse = 0.198103
Epoch 8
Loss = 2.5356e-01, PNorm = 34.6453, GNorm = 6.1821, lr_0 = 7.6601e-04
Loss = 2.2997e-01, PNorm = 34.6869, GNorm = 2.6910, lr_0 = 7.4460e-04
Validation rmse = 0.161685
Epoch 9
Loss = 1.7937e-01, PNorm = 34.7269, GNorm = 2.2676, lr_0 = 7.2378e-04
Validation rmse = 0.172630
Epoch 10
Loss = 1.1007e-01, PNorm = 34.7609, GNorm = 2.7083, lr_0 = 7.0354e-04
Loss = 1.5824e-01, PNorm = 34.7913, GNorm = 2.6266, lr_0 = 6.8387e-04
Validation rmse = 0.170043
Epoch 11
Loss = 1.5956e-01, PNorm = 34.8145, GNorm = 3.2746, lr_0 = 6.6475e-04
Validation rmse = 0.152640
Epoch 12
Loss = 1.9203e-01, PNorm = 34.8425, GNorm = 1.0187, lr_0 = 6.4617e-04
Loss = 1.2591e-01, PNorm = 34.8593, GNorm = 2.2644, lr_0 = 6.2810e-04
Validation rmse = 0.159020
Epoch 13
Loss = 1.2127e-01, PNorm = 34.8832, GNorm = 1.4151, lr_0 = 6.1054e-04
Validation rmse = 0.168177
Epoch 14
Loss = 1.2643e-01, PNorm = 34.9008, GNorm = 3.9175, lr_0 = 5.9347e-04
Loss = 1.3041e-01, PNorm = 34.9177, GNorm = 1.0918, lr_0 = 5.7688e-04
Validation rmse = 0.166462
Epoch 15
Loss = 1.2494e-01, PNorm = 34.9365, GNorm = 1.1421, lr_0 = 5.6075e-04
Validation rmse = 0.147892
Epoch 16
Loss = 9.0272e-02, PNorm = 34.9586, GNorm = 0.7353, lr_0 = 5.4507e-04
Loss = 1.2209e-01, PNorm = 34.9762, GNorm = 3.5114, lr_0 = 5.2983e-04
Validation rmse = 0.156284
Epoch 17
Loss = 1.0924e-01, PNorm = 34.9923, GNorm = 0.6531, lr_0 = 5.1356e-04
Validation rmse = 0.155422
Epoch 18
Loss = 1.1719e-01, PNorm = 35.0078, GNorm = 0.5885, lr_0 = 4.9920e-04
Loss = 1.1374e-01, PNorm = 35.0256, GNorm = 1.4164, lr_0 = 4.8524e-04
Validation rmse = 0.145608
Epoch 19
Loss = 1.1176e-01, PNorm = 35.0373, GNorm = 2.4118, lr_0 = 4.7168e-04
Validation rmse = 0.146029
Epoch 20
Loss = 8.5279e-02, PNorm = 35.0502, GNorm = 1.4390, lr_0 = 4.5849e-04
Loss = 1.0528e-01, PNorm = 35.0631, GNorm = 0.7011, lr_0 = 4.4567e-04
Validation rmse = 0.148928
Epoch 21
Loss = 9.4062e-02, PNorm = 35.0778, GNorm = 2.0195, lr_0 = 4.3321e-04
Validation rmse = 0.168299
Epoch 22
Loss = 1.2249e-01, PNorm = 35.0922, GNorm = 2.8941, lr_0 = 4.2110e-04
Loss = 9.4087e-02, PNorm = 35.1040, GNorm = 0.8216, lr_0 = 4.0933e-04
Validation rmse = 0.146787
Epoch 23
Loss = 9.3937e-02, PNorm = 35.1161, GNorm = 1.7891, lr_0 = 3.9788e-04
Validation rmse = 0.149419
Epoch 24
Loss = 9.3941e-02, PNorm = 35.1306, GNorm = 1.6919, lr_0 = 3.8676e-04
Loss = 9.5407e-02, PNorm = 35.1407, GNorm = 0.5313, lr_0 = 3.7594e-04
Validation rmse = 0.144991
Epoch 25
Loss = 8.7892e-02, PNorm = 35.1509, GNorm = 1.8528, lr_0 = 3.6543e-04
Validation rmse = 0.149005
Epoch 26
Loss = 1.0087e-01, PNorm = 35.1615, GNorm = 2.5272, lr_0 = 3.5522e-04
Loss = 9.0459e-02, PNorm = 35.1733, GNorm = 0.9745, lr_0 = 3.4528e-04
Validation rmse = 0.147664
Epoch 27
Loss = 8.8373e-02, PNorm = 35.1832, GNorm = 0.9531, lr_0 = 3.3563e-04
Validation rmse = 0.145604
Epoch 28
Loss = 8.2830e-02, PNorm = 35.1923, GNorm = 0.6255, lr_0 = 3.2625e-04
Loss = 8.8840e-02, PNorm = 35.2046, GNorm = 0.9363, lr_0 = 3.1713e-04
Validation rmse = 0.149655
Epoch 29
Loss = 8.8036e-02, PNorm = 35.2132, GNorm = 0.8001, lr_0 = 3.0826e-04
Validation rmse = 0.151594
Epoch 30
Loss = 1.0067e-01, PNorm = 35.2222, GNorm = 0.5565, lr_0 = 2.9964e-04
Loss = 9.7712e-02, PNorm = 35.2321, GNorm = 0.4731, lr_0 = 2.9126e-04
Validation rmse = 0.146097
Epoch 31
Loss = 9.1612e-02, PNorm = 35.2421, GNorm = 1.7518, lr_0 = 2.8312e-04
Validation rmse = 0.154664
Epoch 32
Loss = 1.2152e-01, PNorm = 35.2515, GNorm = 2.0846, lr_0 = 2.7520e-04
Loss = 8.6458e-02, PNorm = 35.2605, GNorm = 1.6745, lr_0 = 2.6751e-04
Validation rmse = 0.147631
Epoch 33
Loss = 9.7629e-02, PNorm = 35.2699, GNorm = 5.1712, lr_0 = 2.6003e-04
Validation rmse = 0.151105
Epoch 34
Loss = 9.0206e-02, PNorm = 35.2801, GNorm = 2.6792, lr_0 = 2.5204e-04
Loss = 9.2031e-02, PNorm = 35.2893, GNorm = 2.2538, lr_0 = 2.4500e-04
Validation rmse = 0.147185
Epoch 35
Loss = 8.2896e-02, PNorm = 35.2953, GNorm = 1.2653, lr_0 = 2.3815e-04
Validation rmse = 0.146996
Epoch 36
Loss = 6.0471e-02, PNorm = 35.3017, GNorm = 0.5857, lr_0 = 2.3149e-04
Loss = 8.8624e-02, PNorm = 35.3102, GNorm = 0.6543, lr_0 = 2.2502e-04
Validation rmse = 0.148073
Epoch 37
Loss = 8.3213e-02, PNorm = 35.3158, GNorm = 1.5500, lr_0 = 2.1873e-04
Validation rmse = 0.147529
Epoch 38
Loss = 8.9069e-02, PNorm = 35.3225, GNorm = 1.5961, lr_0 = 2.1261e-04
Loss = 8.2354e-02, PNorm = 35.3305, GNorm = 1.7484, lr_0 = 2.0667e-04
Validation rmse = 0.151224
Epoch 39
Loss = 7.9016e-02, PNorm = 35.3359, GNorm = 1.8391, lr_0 = 2.0089e-04
Validation rmse = 0.145682
Epoch 40
Loss = 8.1818e-02, PNorm = 35.3425, GNorm = 0.5287, lr_0 = 1.9527e-04
Loss = 8.0383e-02, PNorm = 35.3494, GNorm = 2.1153, lr_0 = 1.8981e-04
Validation rmse = 0.154102
Epoch 41
Loss = 8.8631e-02, PNorm = 35.3553, GNorm = 0.7679, lr_0 = 1.8451e-04
Validation rmse = 0.145766
Epoch 42
Loss = 6.2268e-02, PNorm = 35.3602, GNorm = 2.1194, lr_0 = 1.7935e-04
Loss = 8.1164e-02, PNorm = 35.3653, GNorm = 1.9439, lr_0 = 1.7433e-04
Validation rmse = 0.146967
Epoch 43
Loss = 8.0357e-02, PNorm = 35.3713, GNorm = 0.6811, lr_0 = 1.6946e-04
Validation rmse = 0.148941
Epoch 44
Loss = 8.2313e-02, PNorm = 35.3775, GNorm = 0.8563, lr_0 = 1.6472e-04
Loss = 7.4550e-02, PNorm = 35.3831, GNorm = 2.1641, lr_0 = 1.6012e-04
Validation rmse = 0.146136
Epoch 45
Loss = 7.6727e-02, PNorm = 35.3876, GNorm = 0.9222, lr_0 = 1.5564e-04
Validation rmse = 0.146288
Epoch 46
Loss = 6.1031e-02, PNorm = 35.3920, GNorm = 1.8866, lr_0 = 1.5129e-04
Loss = 8.1900e-02, PNorm = 35.3967, GNorm = 0.5535, lr_0 = 1.4706e-04
Validation rmse = 0.148043
Epoch 47
Loss = 7.5964e-02, PNorm = 35.4017, GNorm = 1.4204, lr_0 = 1.4295e-04
Validation rmse = 0.145509
Epoch 48
Loss = 6.2752e-02, PNorm = 35.4064, GNorm = 0.5436, lr_0 = 1.3895e-04
Loss = 7.7378e-02, PNorm = 35.4100, GNorm = 0.8903, lr_0 = 1.3506e-04
Validation rmse = 0.146317
Epoch 49
Loss = 7.8189e-02, PNorm = 35.4158, GNorm = 1.3452, lr_0 = 1.3129e-04
Validation rmse = 0.146225
Epoch 50
Loss = 7.5598e-02, PNorm = 35.4203, GNorm = 0.8968, lr_0 = 1.2762e-04
Loss = 7.4521e-02, PNorm = 35.4235, GNorm = 0.7948, lr_0 = 1.2405e-04
Validation rmse = 0.145659
Epoch 51
Loss = 7.1610e-02, PNorm = 35.4280, GNorm = 0.7968, lr_0 = 1.2024e-04
Validation rmse = 0.145539
Epoch 52
Loss = 6.8102e-02, PNorm = 35.4321, GNorm = 0.5919, lr_0 = 1.1688e-04
Loss = 7.1743e-02, PNorm = 35.4358, GNorm = 0.5300, lr_0 = 1.1361e-04
Validation rmse = 0.146932
Epoch 53
Loss = 6.4675e-02, PNorm = 35.4397, GNorm = 1.5346, lr_0 = 1.1043e-04
Validation rmse = 0.149121
Epoch 54
Loss = 7.7052e-02, PNorm = 35.4433, GNorm = 0.9158, lr_0 = 1.0735e-04
Loss = 7.0331e-02, PNorm = 35.4477, GNorm = 0.4365, lr_0 = 1.0435e-04
Validation rmse = 0.147499
Epoch 55
Loss = 7.2029e-02, PNorm = 35.4510, GNorm = 1.1243, lr_0 = 1.0143e-04
Validation rmse = 0.148640
Epoch 56
Loss = 7.1445e-02, PNorm = 35.4541, GNorm = 1.4961, lr_0 = 1.0000e-04
Loss = 7.3288e-02, PNorm = 35.4577, GNorm = 1.1584, lr_0 = 1.0000e-04
Validation rmse = 0.153462
Epoch 57
Loss = 7.4103e-02, PNorm = 35.4606, GNorm = 0.8125, lr_0 = 1.0000e-04
Validation rmse = 0.150770
Epoch 58
Loss = 9.1055e-02, PNorm = 35.4639, GNorm = 0.8158, lr_0 = 1.0000e-04
Loss = 6.2428e-02, PNorm = 35.4669, GNorm = 1.5614, lr_0 = 1.0000e-04
Validation rmse = 0.146710
Epoch 59
Loss = 7.3618e-02, PNorm = 35.4706, GNorm = 1.0893, lr_0 = 1.0000e-04
Validation rmse = 0.145879
Model 0 best validation rmse = 0.144991 on epoch 24
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.226962
Ensemble test rmse = 0.226962
1-fold cross validation
	Seed 0 ==> test rmse = 0.226962
Overall test rmse = 0.226962 +/- 0.000000
Elapsed time = 0:00:37
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/EtOAc_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/EtOAc_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/EtOAc_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.8, 0.2, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 967 | train size = 773 | val size = 194 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.9531e-01, PNorm = 34.0204, GNorm = 1.1346, lr_0 = 4.3000e-04
Validation rmse = 0.295603
Epoch 1
Loss = 6.0829e-01, PNorm = 34.0578, GNorm = 1.8101, lr_0 = 7.6000e-04
Loss = 6.5184e-01, PNorm = 34.1278, GNorm = 17.9069, lr_0 = 9.9472e-04
Loss = 7.4671e-01, PNorm = 34.1331, GNorm = 12.1541, lr_0 = 9.9209e-04
Validation rmse = 0.304016
Epoch 2
Loss = 5.0684e-01, PNorm = 34.1995, GNorm = 6.2351, lr_0 = 9.6618e-04
Validation rmse = 0.227574
Epoch 3
Loss = 4.0496e-01, PNorm = 34.2654, GNorm = 6.0075, lr_0 = 9.4094e-04
Loss = 3.6705e-01, PNorm = 34.3231, GNorm = 2.6052, lr_0 = 9.1637e-04
Validation rmse = 0.217909
Epoch 4
Loss = 3.2931e-01, PNorm = 34.3824, GNorm = 5.2687, lr_0 = 8.9007e-04
Validation rmse = 0.200535
Epoch 5
Loss = 2.5703e-01, PNorm = 34.4247, GNorm = 2.2400, lr_0 = 8.6682e-04
Loss = 2.2258e-01, PNorm = 34.4674, GNorm = 3.6833, lr_0 = 8.4418e-04
Validation rmse = 0.183474
Epoch 6
Loss = 2.4784e-01, PNorm = 34.5150, GNorm = 0.9283, lr_0 = 8.1996e-04
Validation rmse = 0.188469
Epoch 7
Loss = 2.4150e-01, PNorm = 34.5536, GNorm = 7.3195, lr_0 = 7.9854e-04
Loss = 1.8856e-01, PNorm = 34.5887, GNorm = 1.3376, lr_0 = 7.7769e-04
Validation rmse = 0.234810
Epoch 8
Loss = 2.3704e-01, PNorm = 34.6283, GNorm = 3.3628, lr_0 = 7.5537e-04
Validation rmse = 0.195766
Epoch 9
Loss = 1.8396e-01, PNorm = 34.6704, GNorm = 2.8114, lr_0 = 7.3564e-04
Loss = 1.7046e-01, PNorm = 34.7077, GNorm = 2.2222, lr_0 = 7.1643e-04
Validation rmse = 0.163484
Epoch 10
Loss = 1.3859e-01, PNorm = 34.7449, GNorm = 0.9435, lr_0 = 6.9587e-04
Loss = 1.5334e-01, PNorm = 34.7751, GNorm = 2.1305, lr_0 = 6.7770e-04
Validation rmse = 0.161754
Epoch 11
Loss = 1.3651e-01, PNorm = 34.8042, GNorm = 0.4431, lr_0 = 6.5999e-04
Validation rmse = 0.150535
Epoch 12
Loss = 1.3987e-01, PNorm = 34.8333, GNorm = 0.8775, lr_0 = 6.4106e-04
Loss = 1.3954e-01, PNorm = 34.8551, GNorm = 0.9462, lr_0 = 6.2431e-04
Loss = 1.1183e-01, PNorm = 34.8577, GNorm = 2.7025, lr_0 = 6.2266e-04
Validation rmse = 0.167656
Epoch 13
Loss = 1.5155e-01, PNorm = 34.8839, GNorm = 0.8346, lr_0 = 6.0640e-04
Validation rmse = 0.161913
Epoch 14
Loss = 1.1977e-01, PNorm = 34.9037, GNorm = 3.6017, lr_0 = 5.9056e-04
Loss = 1.1574e-01, PNorm = 34.9246, GNorm = 0.5883, lr_0 = 5.7514e-04
Validation rmse = 0.156335
Epoch 15
Loss = 1.1067e-01, PNorm = 34.9410, GNorm = 0.9139, lr_0 = 5.5863e-04
Validation rmse = 0.159796
Epoch 16
Loss = 1.1049e-01, PNorm = 34.9597, GNorm = 1.2816, lr_0 = 5.4404e-04
Loss = 1.3388e-01, PNorm = 34.9755, GNorm = 4.0570, lr_0 = 5.2983e-04
Validation rmse = 0.154687
Epoch 17
Loss = 1.3264e-01, PNorm = 34.9920, GNorm = 2.9745, lr_0 = 5.1463e-04
Validation rmse = 0.146182
Epoch 18
Loss = 1.4715e-01, PNorm = 35.0104, GNorm = 2.5816, lr_0 = 5.0119e-04
Loss = 1.0616e-01, PNorm = 35.0282, GNorm = 0.5676, lr_0 = 4.8810e-04
Validation rmse = 0.147752
Epoch 19
Loss = 1.0304e-01, PNorm = 35.0461, GNorm = 2.6397, lr_0 = 4.7409e-04
Validation rmse = 0.145164
Epoch 20
Loss = 1.3354e-01, PNorm = 35.0591, GNorm = 3.2388, lr_0 = 4.6171e-04
Loss = 1.0015e-01, PNorm = 35.0759, GNorm = 1.4329, lr_0 = 4.4965e-04
Validation rmse = 0.146783
Epoch 21
Loss = 1.0337e-01, PNorm = 35.0905, GNorm = 2.2011, lr_0 = 4.3675e-04
Loss = 9.3637e-02, PNorm = 35.1018, GNorm = 2.8251, lr_0 = 4.2534e-04
Validation rmse = 0.146375
Epoch 22
Loss = 8.9692e-02, PNorm = 35.1139, GNorm = 1.7133, lr_0 = 4.1423e-04
Validation rmse = 0.146106
Epoch 23
Loss = 8.6795e-02, PNorm = 35.1271, GNorm = 0.6005, lr_0 = 4.0234e-04
Loss = 9.8585e-02, PNorm = 35.1396, GNorm = 0.6366, lr_0 = 3.9184e-04
Validation rmse = 0.166216
Epoch 24
Loss = 9.1991e-02, PNorm = 35.1506, GNorm = 1.7783, lr_0 = 3.8160e-04
Validation rmse = 0.143199
Epoch 25
Loss = 8.3135e-02, PNorm = 35.1644, GNorm = 1.6198, lr_0 = 3.7065e-04
Loss = 1.0278e-01, PNorm = 35.1751, GNorm = 1.0860, lr_0 = 3.6097e-04
Validation rmse = 0.147242
Epoch 26
Loss = 9.6567e-02, PNorm = 35.1853, GNorm = 2.0043, lr_0 = 3.5061e-04
Validation rmse = 0.146290
Epoch 27
Loss = 1.0240e-01, PNorm = 35.1958, GNorm = 1.0533, lr_0 = 3.4145e-04
Loss = 8.3450e-02, PNorm = 35.2061, GNorm = 0.7484, lr_0 = 3.3254e-04
Validation rmse = 0.146372
Epoch 28
Loss = 8.7577e-02, PNorm = 35.2168, GNorm = 0.8521, lr_0 = 3.2299e-04
Validation rmse = 0.150004
Epoch 29
Loss = 9.5479e-02, PNorm = 35.2269, GNorm = 0.8048, lr_0 = 3.1456e-04
Loss = 8.7199e-02, PNorm = 35.2383, GNorm = 3.7451, lr_0 = 3.0634e-04
Validation rmse = 0.145343
Epoch 30
Loss = 9.5941e-02, PNorm = 35.2468, GNorm = 3.1871, lr_0 = 2.9755e-04
Validation rmse = 0.144973
Epoch 31
Loss = 6.8514e-02, PNorm = 35.2559, GNorm = 3.1416, lr_0 = 2.8978e-04
Loss = 9.3760e-02, PNorm = 35.2648, GNorm = 1.9395, lr_0 = 2.8221e-04
Validation rmse = 0.158706
Epoch 32
Loss = 9.6333e-02, PNorm = 35.2755, GNorm = 1.9515, lr_0 = 2.7411e-04
Loss = 8.7080e-02, PNorm = 35.2832, GNorm = 0.7674, lr_0 = 2.6695e-04
Validation rmse = 0.143554
Epoch 33
Loss = 8.6475e-02, PNorm = 35.2908, GNorm = 1.8021, lr_0 = 2.5998e-04
Validation rmse = 0.146684
Epoch 34
Loss = 7.5098e-02, PNorm = 35.3001, GNorm = 0.4585, lr_0 = 2.5252e-04
Loss = 8.5523e-02, PNorm = 35.3071, GNorm = 1.6314, lr_0 = 2.4593e-04
Validation rmse = 0.143966
Epoch 35
Loss = 8.1966e-02, PNorm = 35.3165, GNorm = 1.7075, lr_0 = 2.3950e-04
Validation rmse = 0.152648
Epoch 36
Loss = 8.9202e-02, PNorm = 35.3239, GNorm = 1.4467, lr_0 = 2.3263e-04
Loss = 8.5218e-02, PNorm = 35.3315, GNorm = 0.6485, lr_0 = 2.2655e-04
Validation rmse = 0.143693
Epoch 37
Loss = 8.3647e-02, PNorm = 35.3377, GNorm = 1.9705, lr_0 = 2.2064e-04
Validation rmse = 0.153873
Epoch 38
Loss = 9.0785e-02, PNorm = 35.3467, GNorm = 2.0391, lr_0 = 2.1431e-04
Loss = 7.6313e-02, PNorm = 35.3527, GNorm = 0.9872, lr_0 = 2.0871e-04
Validation rmse = 0.151766
Epoch 39
Loss = 7.4770e-02, PNorm = 35.3585, GNorm = 1.1128, lr_0 = 2.0272e-04
Validation rmse = 0.145116
Epoch 40
Loss = 4.8949e-02, PNorm = 35.3641, GNorm = 0.6524, lr_0 = 1.9743e-04
Loss = 7.7897e-02, PNorm = 35.3694, GNorm = 0.9610, lr_0 = 1.9227e-04
Validation rmse = 0.142464
Epoch 41
Loss = 7.1675e-02, PNorm = 35.3778, GNorm = 0.6980, lr_0 = 1.8675e-04
Validation rmse = 0.148664
Epoch 42
Loss = 8.0188e-02, PNorm = 35.3829, GNorm = 2.2844, lr_0 = 1.8187e-04
Loss = 8.1079e-02, PNorm = 35.3869, GNorm = 0.4882, lr_0 = 1.7712e-04
Validation rmse = 0.143981
Epoch 43
Loss = 6.4555e-02, PNorm = 35.3927, GNorm = 2.5144, lr_0 = 1.7204e-04
Loss = 8.2375e-02, PNorm = 35.3981, GNorm = 0.5786, lr_0 = 1.6755e-04
Validation rmse = 0.145208
Epoch 44
Loss = 7.2985e-02, PNorm = 35.4034, GNorm = 1.4295, lr_0 = 1.6317e-04
Validation rmse = 0.147266
Epoch 45
Loss = 8.6692e-02, PNorm = 35.4090, GNorm = 0.7114, lr_0 = 1.5849e-04
Loss = 7.1131e-02, PNorm = 35.4147, GNorm = 0.6817, lr_0 = 1.5435e-04
Validation rmse = 0.146393
Epoch 46
Loss = 7.8889e-02, PNorm = 35.4177, GNorm = 2.3542, lr_0 = 1.5032e-04
Validation rmse = 0.143828
Epoch 47
Loss = 8.2615e-02, PNorm = 35.4230, GNorm = 0.6068, lr_0 = 1.4601e-04
Loss = 7.3853e-02, PNorm = 35.4284, GNorm = 1.2959, lr_0 = 1.4219e-04
Validation rmse = 0.146487
Epoch 48
Loss = 6.7695e-02, PNorm = 35.4327, GNorm = 0.8472, lr_0 = 1.3848e-04
Validation rmse = 0.144262
Epoch 49
Loss = 8.1129e-02, PNorm = 35.4369, GNorm = 0.7233, lr_0 = 1.3450e-04
Loss = 7.1211e-02, PNorm = 35.4407, GNorm = 0.8122, lr_0 = 1.3099e-04
Validation rmse = 0.144564
Epoch 50
Loss = 6.9764e-02, PNorm = 35.4444, GNorm = 2.4744, lr_0 = 1.2757e-04
Validation rmse = 0.148386
Epoch 51
Loss = 8.1327e-02, PNorm = 35.4493, GNorm = 2.8419, lr_0 = 1.2391e-04
Loss = 7.1575e-02, PNorm = 35.4537, GNorm = 0.7664, lr_0 = 1.2067e-04
Validation rmse = 0.149543
Epoch 52
Loss = 6.6943e-02, PNorm = 35.4564, GNorm = 0.6284, lr_0 = 1.1721e-04
Validation rmse = 0.145424
Epoch 53
Loss = 7.6710e-02, PNorm = 35.4601, GNorm = 1.1181, lr_0 = 1.1415e-04
Loss = 7.3184e-02, PNorm = 35.4637, GNorm = 1.2679, lr_0 = 1.1117e-04
Validation rmse = 0.145586
Epoch 54
Loss = 7.5150e-02, PNorm = 35.4671, GNorm = 2.5658, lr_0 = 1.0798e-04
Loss = 6.8619e-02, PNorm = 35.4705, GNorm = 0.7399, lr_0 = 1.0516e-04
Validation rmse = 0.146040
Epoch 55
Loss = 7.8070e-02, PNorm = 35.4733, GNorm = 1.6387, lr_0 = 1.0241e-04
Validation rmse = 0.145990
Epoch 56
Loss = 6.9462e-02, PNorm = 35.4768, GNorm = 0.8185, lr_0 = 1.0000e-04
Loss = 7.4809e-02, PNorm = 35.4796, GNorm = 2.6634, lr_0 = 1.0000e-04
Validation rmse = 0.144751
Epoch 57
Loss = 7.2003e-02, PNorm = 35.4844, GNorm = 1.0820, lr_0 = 1.0000e-04
Validation rmse = 0.143910
Epoch 58
Loss = 7.8703e-02, PNorm = 35.4874, GNorm = 0.4895, lr_0 = 1.0000e-04
Loss = 6.7808e-02, PNorm = 35.4901, GNorm = 2.0157, lr_0 = 1.0000e-04
Validation rmse = 0.144089
Epoch 59
Loss = 6.8866e-02, PNorm = 35.4935, GNorm = 1.1447, lr_0 = 1.0000e-04
Validation rmse = 0.143304
Model 0 best validation rmse = 0.142464 on epoch 40
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.227110
Ensemble test rmse = 0.227110
1-fold cross validation
	Seed 0 ==> test rmse = 0.227110
Overall test rmse = 0.227110 +/- 0.000000
Elapsed time = 0:00:39
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/MeOH_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/MeOH_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/MeOH_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 695 | train size = 688 | val size = 7 | test size = 337
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.5179e-01, PNorm = 43.2641, GNorm = 3.7596, lr_0 = 4.8077e-04
Validation rmse = 0.361506
Epoch 1
Loss = 6.9682e-01, PNorm = 43.3076, GNorm = 8.7747, lr_0 = 8.6154e-04
Validation rmse = 0.372762
Epoch 2
Loss = 4.4965e-01, PNorm = 43.3670, GNorm = 2.0051, lr_0 = 9.8184e-04
Loss = 5.5475e-01, PNorm = 43.4429, GNorm = 8.3434, lr_0 = 9.5231e-04
Validation rmse = 0.325042
Epoch 3
Loss = 4.5864e-01, PNorm = 43.5136, GNorm = 2.9301, lr_0 = 9.2367e-04
Validation rmse = 0.320919
Epoch 4
Loss = 2.9871e-01, PNorm = 43.5759, GNorm = 1.3348, lr_0 = 8.9589e-04
Validation rmse = 0.315991
Epoch 5
Loss = 3.2056e-01, PNorm = 43.6435, GNorm = 3.8634, lr_0 = 8.6629e-04
Loss = 2.3510e-01, PNorm = 43.6886, GNorm = 1.1473, lr_0 = 8.4024e-04
Validation rmse = 0.231890
Epoch 6
Loss = 2.8559e-01, PNorm = 43.7352, GNorm = 7.8492, lr_0 = 8.1497e-04
Validation rmse = 0.234591
Epoch 7
Loss = 2.7694e-01, PNorm = 43.7866, GNorm = 1.6954, lr_0 = 7.9046e-04
Loss = 2.0308e-01, PNorm = 43.8285, GNorm = 1.3642, lr_0 = 7.6668e-04
Validation rmse = 0.242063
Epoch 8
Loss = 1.8334e-01, PNorm = 43.8582, GNorm = 1.4121, lr_0 = 7.4362e-04
Validation rmse = 0.260783
Epoch 9
Loss = 2.2530e-01, PNorm = 43.8947, GNorm = 1.2017, lr_0 = 7.1906e-04
Validation rmse = 0.195323
Epoch 10
Loss = 1.6588e-01, PNorm = 43.9321, GNorm = 3.2423, lr_0 = 6.9743e-04
Loss = 1.4024e-01, PNorm = 43.9598, GNorm = 1.1019, lr_0 = 6.7645e-04
Validation rmse = 0.188895
Epoch 11
Loss = 1.4240e-01, PNorm = 43.9828, GNorm = 3.4267, lr_0 = 6.5611e-04
Validation rmse = 0.171600
Epoch 12
Loss = 9.9090e-02, PNorm = 44.0055, GNorm = 2.8240, lr_0 = 6.3638e-04
Validation rmse = 0.188103
Epoch 13
Loss = 1.3694e-01, PNorm = 44.0306, GNorm = 2.0401, lr_0 = 6.1535e-04
Loss = 1.2633e-01, PNorm = 44.0512, GNorm = 0.9714, lr_0 = 5.9685e-04
Validation rmse = 0.172953
Epoch 14
Loss = 1.0048e-01, PNorm = 44.0688, GNorm = 0.8289, lr_0 = 5.7889e-04
Validation rmse = 0.190847
Epoch 15
Loss = 1.4132e-01, PNorm = 44.0841, GNorm = 2.0194, lr_0 = 5.6148e-04
Loss = 1.2992e-01, PNorm = 44.1003, GNorm = 0.8915, lr_0 = 5.4460e-04
Validation rmse = 0.178731
Epoch 16
Loss = 1.0937e-01, PNorm = 44.1207, GNorm = 1.0647, lr_0 = 5.2822e-04
Validation rmse = 0.177168
Epoch 17
Loss = 1.0990e-01, PNorm = 44.1364, GNorm = 2.3177, lr_0 = 5.1077e-04
Validation rmse = 0.161252
Epoch 18
Loss = 9.6877e-02, PNorm = 44.1526, GNorm = 1.3632, lr_0 = 4.9540e-04
Loss = 1.1497e-01, PNorm = 44.1680, GNorm = 0.8518, lr_0 = 4.8050e-04
Validation rmse = 0.176895
Epoch 19
Loss = 1.0189e-01, PNorm = 44.1821, GNorm = 0.8662, lr_0 = 4.6605e-04
Validation rmse = 0.175793
Epoch 20
Loss = 8.8310e-02, PNorm = 44.1946, GNorm = 1.6889, lr_0 = 4.5204e-04
Validation rmse = 0.176115
Epoch 21
Loss = 1.3645e-01, PNorm = 44.2092, GNorm = 1.3655, lr_0 = 4.3710e-04
Loss = 8.7012e-02, PNorm = 44.2228, GNorm = 2.6756, lr_0 = 4.2396e-04
Validation rmse = 0.175856
Epoch 22
Loss = 9.6875e-02, PNorm = 44.2358, GNorm = 2.6090, lr_0 = 4.1120e-04
Validation rmse = 0.162869
Epoch 23
Loss = 9.4403e-02, PNorm = 44.2492, GNorm = 2.6835, lr_0 = 3.9884e-04
Loss = 9.0761e-02, PNorm = 44.2614, GNorm = 1.1297, lr_0 = 3.8684e-04
Validation rmse = 0.177145
Epoch 24
Loss = 9.3693e-02, PNorm = 44.2758, GNorm = 0.5488, lr_0 = 3.7521e-04
Validation rmse = 0.166042
Epoch 25
Loss = 9.6441e-02, PNorm = 44.2874, GNorm = 1.1564, lr_0 = 3.6392e-04
Validation rmse = 0.159792
Epoch 26
Loss = 6.3979e-02, PNorm = 44.3009, GNorm = 1.0861, lr_0 = 3.5190e-04
Loss = 1.0537e-01, PNorm = 44.3143, GNorm = 1.9008, lr_0 = 3.4132e-04
Validation rmse = 0.173493
Epoch 27
Loss = 8.3458e-02, PNorm = 44.3262, GNorm = 2.2225, lr_0 = 3.3105e-04
Validation rmse = 0.168404
Epoch 28
Loss = 8.4946e-02, PNorm = 44.3387, GNorm = 1.5321, lr_0 = 3.2109e-04
Validation rmse = 0.170622
Epoch 29
Loss = 1.1725e-01, PNorm = 44.3502, GNorm = 2.0493, lr_0 = 3.1144e-04
Loss = 8.3376e-02, PNorm = 44.3600, GNorm = 1.1779, lr_0 = 3.0207e-04
Validation rmse = 0.164251
Epoch 30
Loss = 7.7236e-02, PNorm = 44.3732, GNorm = 0.8797, lr_0 = 2.9209e-04
Validation rmse = 0.174653
Epoch 31
Loss = 7.7918e-02, PNorm = 44.3845, GNorm = 1.8259, lr_0 = 2.8331e-04
Loss = 8.4377e-02, PNorm = 44.3951, GNorm = 1.0491, lr_0 = 2.7478e-04
Validation rmse = 0.168526
Epoch 32
Loss = 7.8360e-02, PNorm = 44.4073, GNorm = 1.2289, lr_0 = 2.6652e-04
Validation rmse = 0.167843
Epoch 33
Loss = 8.3330e-02, PNorm = 44.4184, GNorm = 0.7553, lr_0 = 2.5850e-04
Validation rmse = 0.165567
Epoch 34
Loss = 8.7962e-02, PNorm = 44.4299, GNorm = 0.8194, lr_0 = 2.4996e-04
Loss = 7.9109e-02, PNorm = 44.4403, GNorm = 1.2231, lr_0 = 2.4245e-04
Validation rmse = 0.163450
Epoch 35
Loss = 6.9961e-02, PNorm = 44.4502, GNorm = 0.3619, lr_0 = 2.3515e-04
Validation rmse = 0.169925
Epoch 36
Loss = 7.3141e-02, PNorm = 44.4595, GNorm = 1.7616, lr_0 = 2.2808e-04
Validation rmse = 0.165959
Epoch 37
Loss = 9.9283e-02, PNorm = 44.4695, GNorm = 1.1878, lr_0 = 2.2122e-04
Loss = 7.0754e-02, PNorm = 44.4800, GNorm = 1.0882, lr_0 = 2.1457e-04
Validation rmse = 0.162398
Epoch 38
Loss = 6.3373e-02, PNorm = 44.4893, GNorm = 0.8703, lr_0 = 2.0748e-04
Validation rmse = 0.156204
Epoch 39
Loss = 7.2294e-02, PNorm = 44.4973, GNorm = 2.3355, lr_0 = 2.0124e-04
Loss = 7.3810e-02, PNorm = 44.5050, GNorm = 1.3548, lr_0 = 1.9519e-04
Validation rmse = 0.166436
Epoch 40
Loss = 6.8571e-02, PNorm = 44.5139, GNorm = 1.0071, lr_0 = 1.8932e-04
Validation rmse = 0.165774
Epoch 41
Loss = 5.9977e-02, PNorm = 44.5217, GNorm = 1.2947, lr_0 = 1.8362e-04
Validation rmse = 0.159774
Epoch 42
Loss = 4.3896e-02, PNorm = 44.5306, GNorm = 0.7769, lr_0 = 1.7756e-04
Loss = 7.2814e-02, PNorm = 44.5383, GNorm = 0.5870, lr_0 = 1.7222e-04
Validation rmse = 0.161845
Epoch 43
Loss = 5.9769e-02, PNorm = 44.5467, GNorm = 1.0460, lr_0 = 1.6704e-04
Validation rmse = 0.165059
Epoch 44
Loss = 6.6547e-02, PNorm = 44.5534, GNorm = 0.5482, lr_0 = 1.6201e-04
Validation rmse = 0.148442
Epoch 45
Loss = 5.5743e-02, PNorm = 44.5612, GNorm = 1.6400, lr_0 = 1.5714e-04
Loss = 6.4245e-02, PNorm = 44.5676, GNorm = 1.0143, lr_0 = 1.5241e-04
Validation rmse = 0.156557
Epoch 46
Loss = 5.7956e-02, PNorm = 44.5750, GNorm = 0.8761, lr_0 = 1.4738e-04
Validation rmse = 0.149007
Epoch 47
Loss = 6.9257e-02, PNorm = 44.5815, GNorm = 0.4677, lr_0 = 1.4295e-04
Loss = 6.1949e-02, PNorm = 44.5870, GNorm = 2.1955, lr_0 = 1.3865e-04
Validation rmse = 0.162164
Epoch 48
Loss = 6.8603e-02, PNorm = 44.5937, GNorm = 0.8200, lr_0 = 1.3448e-04
Validation rmse = 0.151291
Epoch 49
Loss = 6.3296e-02, PNorm = 44.5999, GNorm = 0.6822, lr_0 = 1.3043e-04
Validation rmse = 0.157861
Epoch 50
Loss = 5.4280e-02, PNorm = 44.6062, GNorm = 1.2499, lr_0 = 1.2651e-04
Loss = 6.1500e-02, PNorm = 44.6120, GNorm = 0.5019, lr_0 = 1.2270e-04
Validation rmse = 0.150369
Epoch 51
Loss = 5.6975e-02, PNorm = 44.6181, GNorm = 0.7442, lr_0 = 1.1865e-04
Validation rmse = 0.153205
Epoch 52
Loss = 4.5944e-02, PNorm = 44.6233, GNorm = 0.8030, lr_0 = 1.1508e-04
Validation rmse = 0.150986
Epoch 53
Loss = 6.6283e-02, PNorm = 44.6284, GNorm = 1.9631, lr_0 = 1.1162e-04
Loss = 5.4227e-02, PNorm = 44.6335, GNorm = 0.6207, lr_0 = 1.0826e-04
Validation rmse = 0.150613
Epoch 54
Loss = 5.3422e-02, PNorm = 44.6388, GNorm = 0.8643, lr_0 = 1.0501e-04
Validation rmse = 0.145433
Epoch 55
Loss = 5.8249e-02, PNorm = 44.6438, GNorm = 0.8530, lr_0 = 1.0154e-04
Loss = 5.3120e-02, PNorm = 44.6486, GNorm = 0.5201, lr_0 = 1.0000e-04
Validation rmse = 0.145792
Epoch 56
Loss = 5.3638e-02, PNorm = 44.6535, GNorm = 1.6077, lr_0 = 1.0000e-04
Validation rmse = 0.153238
Epoch 57
Loss = 5.7541e-02, PNorm = 44.6579, GNorm = 1.3825, lr_0 = 1.0000e-04
Validation rmse = 0.145169
Epoch 58
Loss = 4.1980e-02, PNorm = 44.6626, GNorm = 0.6371, lr_0 = 1.0000e-04
Loss = 5.6548e-02, PNorm = 44.6676, GNorm = 0.6395, lr_0 = 1.0000e-04
Validation rmse = 0.143254
Epoch 59
Loss = 4.9147e-02, PNorm = 44.6726, GNorm = 1.1457, lr_0 = 1.0000e-04
Validation rmse = 0.149737
Model 0 best validation rmse = 0.143254 on epoch 58
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.161248
Ensemble test rmse = 0.161248
1-fold cross validation
	Seed 0 ==> test rmse = 0.161248
Overall test rmse = 0.161248 +/- 0.000000
Elapsed time = 0:00:31
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/EtOH_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/EtOH_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/EtOH_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 976 | train size = 966 | val size = 10 | test size = 56
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.6864e-01, PNorm = 43.2628, GNorm = 6.5036, lr_0 = 3.6053e-04
Validation rmse = 0.244020
Epoch 1
Loss = 6.1296e-01, PNorm = 43.2874, GNorm = 1.2816, lr_0 = 6.2105e-04
Loss = 6.5966e-01, PNorm = 43.3310, GNorm = 0.9923, lr_0 = 8.5789e-04
Validation rmse = 0.331899
Epoch 2
Loss = 7.2063e-01, PNorm = 43.4087, GNorm = 6.5790, lr_0 = 9.8961e-04
Loss = 6.3369e-01, PNorm = 43.4928, GNorm = 5.1945, lr_0 = 9.6914e-04
Validation rmse = 0.227522
Epoch 3
Loss = 2.8827e-01, PNorm = 43.5821, GNorm = 0.7033, lr_0 = 9.4712e-04
Loss = 3.0628e-01, PNorm = 43.6598, GNorm = 1.6234, lr_0 = 9.2754e-04
Validation rmse = 0.243854
Epoch 4
Loss = 2.6430e-01, PNorm = 43.7236, GNorm = 0.7669, lr_0 = 9.0836e-04
Loss = 2.4291e-01, PNorm = 43.7809, GNorm = 4.9215, lr_0 = 8.8958e-04
Validation rmse = 0.202118
Epoch 5
Loss = 1.6938e-01, PNorm = 43.8305, GNorm = 1.3826, lr_0 = 8.6936e-04
Loss = 2.0492e-01, PNorm = 43.8698, GNorm = 5.0357, lr_0 = 8.5139e-04
Validation rmse = 0.220018
Epoch 6
Loss = 1.9631e-01, PNorm = 43.9086, GNorm = 0.6650, lr_0 = 8.3204e-04
Loss = 2.0612e-01, PNorm = 43.9462, GNorm = 2.3684, lr_0 = 8.1484e-04
Validation rmse = 0.221342
Epoch 7
Loss = 1.8700e-01, PNorm = 43.9847, GNorm = 0.8257, lr_0 = 7.9799e-04
Loss = 1.5107e-01, PNorm = 44.0183, GNorm = 2.2897, lr_0 = 7.8149e-04
Validation rmse = 0.203967
Epoch 8
Loss = 1.9319e-01, PNorm = 44.0521, GNorm = 3.6482, lr_0 = 7.6373e-04
Loss = 1.5624e-01, PNorm = 44.0890, GNorm = 1.8682, lr_0 = 7.4794e-04
Validation rmse = 0.181987
Epoch 9
Loss = 1.3265e-01, PNorm = 44.1161, GNorm = 3.5820, lr_0 = 7.3094e-04
Loss = 1.4720e-01, PNorm = 44.1388, GNorm = 2.5729, lr_0 = 7.1583e-04
Validation rmse = 0.176029
Epoch 10
Loss = 1.1433e-01, PNorm = 44.1583, GNorm = 0.6196, lr_0 = 7.0103e-04
Loss = 1.3220e-01, PNorm = 44.1755, GNorm = 1.9666, lr_0 = 6.8653e-04
Validation rmse = 0.167026
Epoch 11
Loss = 1.2451e-01, PNorm = 44.1971, GNorm = 2.6945, lr_0 = 6.7093e-04
Loss = 1.3559e-01, PNorm = 44.2173, GNorm = 3.1331, lr_0 = 6.5706e-04
Validation rmse = 0.162530
Epoch 12
Loss = 1.2389e-01, PNorm = 44.2408, GNorm = 2.1436, lr_0 = 6.4213e-04
Loss = 1.2869e-01, PNorm = 44.2608, GNorm = 0.8079, lr_0 = 6.2885e-04
Validation rmse = 0.168849
Epoch 13
Loss = 1.1726e-01, PNorm = 44.2797, GNorm = 2.4671, lr_0 = 6.1585e-04
Loss = 1.1752e-01, PNorm = 44.2982, GNorm = 0.7067, lr_0 = 6.0311e-04
Loss = 9.9903e-02, PNorm = 44.3005, GNorm = 1.5622, lr_0 = 6.0185e-04
Validation rmse = 0.156850
Epoch 14
Loss = 1.0324e-01, PNorm = 44.3214, GNorm = 0.5565, lr_0 = 5.8941e-04
Validation rmse = 0.159300
Epoch 15
Loss = 1.3584e-01, PNorm = 44.3396, GNorm = 0.9310, lr_0 = 5.7602e-04
Loss = 1.0003e-01, PNorm = 44.3553, GNorm = 0.7218, lr_0 = 5.6411e-04
Validation rmse = 0.153009
Epoch 16
Loss = 1.2834e-01, PNorm = 44.3720, GNorm = 2.5389, lr_0 = 5.5244e-04
Loss = 1.1642e-01, PNorm = 44.3893, GNorm = 3.0683, lr_0 = 5.4102e-04
Validation rmse = 0.183446
Epoch 17
Loss = 9.2824e-02, PNorm = 44.4086, GNorm = 1.0722, lr_0 = 5.2873e-04
Loss = 1.0161e-01, PNorm = 44.4203, GNorm = 0.6043, lr_0 = 5.1779e-04
Validation rmse = 0.157682
Epoch 18
Loss = 7.4078e-02, PNorm = 44.4365, GNorm = 1.6620, lr_0 = 5.0603e-04
Loss = 1.0427e-01, PNorm = 44.4478, GNorm = 1.4205, lr_0 = 4.9556e-04
Validation rmse = 0.156236
Epoch 19
Loss = 9.3348e-02, PNorm = 44.4621, GNorm = 0.8145, lr_0 = 4.8532e-04
Loss = 9.9296e-02, PNorm = 44.4787, GNorm = 0.6292, lr_0 = 4.7528e-04
Validation rmse = 0.162115
Epoch 20
Loss = 9.1130e-02, PNorm = 44.4928, GNorm = 0.7418, lr_0 = 4.6448e-04
Loss = 9.1936e-02, PNorm = 44.5048, GNorm = 1.4602, lr_0 = 4.5488e-04
Validation rmse = 0.164425
Epoch 21
Loss = 8.5194e-02, PNorm = 44.5215, GNorm = 0.7755, lr_0 = 4.4454e-04
Loss = 8.1002e-02, PNorm = 44.5339, GNorm = 0.6691, lr_0 = 4.3535e-04
Validation rmse = 0.172964
Epoch 22
Loss = 9.2793e-02, PNorm = 44.5477, GNorm = 1.1272, lr_0 = 4.2635e-04
Loss = 9.1166e-02, PNorm = 44.5615, GNorm = 2.4878, lr_0 = 4.1753e-04
Validation rmse = 0.166967
Epoch 23
Loss = 8.3831e-02, PNorm = 44.5800, GNorm = 2.6861, lr_0 = 4.0804e-04
Loss = 9.7129e-02, PNorm = 44.5947, GNorm = 0.5734, lr_0 = 3.9961e-04
Validation rmse = 0.167537
Epoch 24
Loss = 8.3569e-02, PNorm = 44.6093, GNorm = 0.5476, lr_0 = 3.9053e-04
Loss = 8.4680e-02, PNorm = 44.6195, GNorm = 1.3736, lr_0 = 3.8245e-04
Validation rmse = 0.179778
Epoch 25
Loss = 7.7740e-02, PNorm = 44.6293, GNorm = 1.0005, lr_0 = 3.7454e-04
Loss = 9.6534e-02, PNorm = 44.6409, GNorm = 2.9586, lr_0 = 3.6680e-04
Validation rmse = 0.155860
Epoch 26
Loss = 8.2503e-02, PNorm = 44.6549, GNorm = 1.2348, lr_0 = 3.5846e-04
Loss = 8.0604e-02, PNorm = 44.6673, GNorm = 0.8069, lr_0 = 3.5105e-04
Validation rmse = 0.168411
Epoch 27
Loss = 9.3708e-02, PNorm = 44.6833, GNorm = 2.4425, lr_0 = 3.4308e-04
Loss = 9.2675e-02, PNorm = 44.6963, GNorm = 2.5843, lr_0 = 3.3598e-04
Loss = 1.0180e-01, PNorm = 44.6972, GNorm = 3.6546, lr_0 = 3.3528e-04
Validation rmse = 0.154821
Epoch 28
Loss = 9.6244e-02, PNorm = 44.7093, GNorm = 3.4162, lr_0 = 3.2835e-04
Loss = 8.6023e-02, PNorm = 44.7227, GNorm = 2.6397, lr_0 = 3.2156e-04
Validation rmse = 0.167802
Epoch 29
Loss = 7.4887e-02, PNorm = 44.7351, GNorm = 1.3098, lr_0 = 3.1491e-04
Validation rmse = 0.149216
Epoch 30
Loss = 7.0450e-02, PNorm = 44.7472, GNorm = 0.5202, lr_0 = 3.0775e-04
Loss = 7.7624e-02, PNorm = 44.7563, GNorm = 0.8575, lr_0 = 3.0139e-04
Validation rmse = 0.156610
Epoch 31
Loss = 5.7771e-02, PNorm = 44.7665, GNorm = 0.7312, lr_0 = 2.9454e-04
Loss = 7.5574e-02, PNorm = 44.7787, GNorm = 0.8899, lr_0 = 2.8845e-04
Validation rmse = 0.151547
Epoch 32
Loss = 8.3738e-02, PNorm = 44.7872, GNorm = 1.5218, lr_0 = 2.8249e-04
Loss = 7.4861e-02, PNorm = 44.7968, GNorm = 0.5275, lr_0 = 2.7665e-04
Validation rmse = 0.153238
Epoch 33
Loss = 7.2283e-02, PNorm = 44.8073, GNorm = 0.5894, lr_0 = 2.7036e-04
Loss = 7.1820e-02, PNorm = 44.8162, GNorm = 1.6969, lr_0 = 2.6477e-04
Validation rmse = 0.170147
Epoch 34
Loss = 7.2389e-02, PNorm = 44.8262, GNorm = 1.1577, lr_0 = 2.5875e-04
Loss = 6.4451e-02, PNorm = 44.8352, GNorm = 0.6793, lr_0 = 2.5340e-04
Validation rmse = 0.158414
Epoch 35
Loss = 6.2391e-02, PNorm = 44.8425, GNorm = 0.7248, lr_0 = 2.4816e-04
Loss = 7.2919e-02, PNorm = 44.8519, GNorm = 0.8522, lr_0 = 2.4303e-04
Validation rmse = 0.157353
Epoch 36
Loss = 6.8519e-02, PNorm = 44.8605, GNorm = 1.8750, lr_0 = 2.3751e-04
Loss = 6.4489e-02, PNorm = 44.8688, GNorm = 0.7160, lr_0 = 2.3260e-04
Validation rmse = 0.163560
Epoch 37
Loss = 6.4371e-02, PNorm = 44.8791, GNorm = 0.6104, lr_0 = 2.2731e-04
Loss = 5.9577e-02, PNorm = 44.8870, GNorm = 0.8419, lr_0 = 2.2261e-04
Validation rmse = 0.160742
Epoch 38
Loss = 5.0789e-02, PNorm = 44.8940, GNorm = 0.9592, lr_0 = 2.1801e-04
Loss = 7.2199e-02, PNorm = 44.9030, GNorm = 1.0684, lr_0 = 2.1350e-04
Validation rmse = 0.150950
Epoch 39
Loss = 5.8725e-02, PNorm = 44.9118, GNorm = 0.7667, lr_0 = 2.0865e-04
Loss = 6.7483e-02, PNorm = 44.9197, GNorm = 1.3760, lr_0 = 2.0434e-04
Validation rmse = 0.159181
Epoch 40
Loss = 5.7627e-02, PNorm = 44.9268, GNorm = 0.8611, lr_0 = 1.9969e-04
Loss = 6.0343e-02, PNorm = 44.9341, GNorm = 0.6639, lr_0 = 1.9556e-04
Validation rmse = 0.178912
Epoch 41
Loss = 6.1320e-02, PNorm = 44.9418, GNorm = 1.1546, lr_0 = 1.9152e-04
Loss = 6.1006e-02, PNorm = 44.9488, GNorm = 0.4658, lr_0 = 1.8756e-04
Validation rmse = 0.160446
Epoch 42
Loss = 6.0547e-02, PNorm = 44.9568, GNorm = 0.9788, lr_0 = 1.8330e-04
Loss = 5.3995e-02, PNorm = 44.9639, GNorm = 0.8932, lr_0 = 1.7951e-04
Loss = 6.8942e-02, PNorm = 44.9647, GNorm = 1.6416, lr_0 = 1.7913e-04
Validation rmse = 0.155583
Epoch 43
Loss = 5.7032e-02, PNorm = 44.9718, GNorm = 1.5690, lr_0 = 1.7543e-04
Loss = 6.2743e-02, PNorm = 44.9798, GNorm = 3.8184, lr_0 = 1.7180e-04
Validation rmse = 0.169285
Epoch 44
Loss = 7.0019e-02, PNorm = 44.9859, GNorm = 1.2411, lr_0 = 1.6825e-04
Validation rmse = 0.164131
Epoch 45
Loss = 5.9090e-02, PNorm = 44.9932, GNorm = 1.0494, lr_0 = 1.6443e-04
Loss = 6.1321e-02, PNorm = 44.9989, GNorm = 1.4177, lr_0 = 1.6103e-04
Validation rmse = 0.158963
Epoch 46
Loss = 6.5478e-02, PNorm = 45.0069, GNorm = 0.8592, lr_0 = 1.5737e-04
Loss = 5.6476e-02, PNorm = 45.0131, GNorm = 0.6624, lr_0 = 1.5411e-04
Validation rmse = 0.157021
Epoch 47
Loss = 7.1916e-02, PNorm = 45.0194, GNorm = 1.0296, lr_0 = 1.5093e-04
Loss = 5.0855e-02, PNorm = 45.0247, GNorm = 0.7531, lr_0 = 1.4781e-04
Validation rmse = 0.150215
Epoch 48
Loss = 4.8866e-02, PNorm = 45.0304, GNorm = 2.3037, lr_0 = 1.4445e-04
Loss = 5.5294e-02, PNorm = 45.0358, GNorm = 0.8808, lr_0 = 1.4146e-04
Validation rmse = 0.154066
Epoch 49
Loss = 7.0334e-02, PNorm = 45.0422, GNorm = 1.4232, lr_0 = 1.3825e-04
Loss = 5.4597e-02, PNorm = 45.0485, GNorm = 1.3526, lr_0 = 1.3539e-04
Validation rmse = 0.166137
Epoch 50
Loss = 4.5591e-02, PNorm = 45.0528, GNorm = 0.5760, lr_0 = 1.3259e-04
Loss = 5.2707e-02, PNorm = 45.0571, GNorm = 1.3051, lr_0 = 1.2985e-04
Validation rmse = 0.157511
Epoch 51
Loss = 4.4201e-02, PNorm = 45.0627, GNorm = 1.0405, lr_0 = 1.2690e-04
Loss = 4.8570e-02, PNorm = 45.0673, GNorm = 0.5530, lr_0 = 1.2427e-04
Validation rmse = 0.158945
Epoch 52
Loss = 4.6750e-02, PNorm = 45.0730, GNorm = 0.8431, lr_0 = 1.2145e-04
Loss = 5.0031e-02, PNorm = 45.0767, GNorm = 0.5292, lr_0 = 1.1894e-04
Validation rmse = 0.156794
Epoch 53
Loss = 4.4355e-02, PNorm = 45.0812, GNorm = 0.8165, lr_0 = 1.1623e-04
Loss = 5.6065e-02, PNorm = 45.0856, GNorm = 0.6325, lr_0 = 1.1383e-04
Validation rmse = 0.158786
Epoch 54
Loss = 4.4490e-02, PNorm = 45.0893, GNorm = 0.3978, lr_0 = 1.1148e-04
Loss = 5.2774e-02, PNorm = 45.0934, GNorm = 0.7211, lr_0 = 1.0917e-04
Validation rmse = 0.155934
Epoch 55
Loss = 5.6519e-02, PNorm = 45.0979, GNorm = 1.4720, lr_0 = 1.0669e-04
Loss = 4.4386e-02, PNorm = 45.1016, GNorm = 0.7457, lr_0 = 1.0449e-04
Validation rmse = 0.165127
Epoch 56
Loss = 4.4063e-02, PNorm = 45.1066, GNorm = 0.8868, lr_0 = 1.0211e-04
Loss = 5.0183e-02, PNorm = 45.1102, GNorm = 0.4707, lr_0 = 1.0000e-04
Validation rmse = 0.163877
Epoch 57
Loss = 3.8821e-02, PNorm = 45.1145, GNorm = 0.6737, lr_0 = 1.0000e-04
Loss = 5.4637e-02, PNorm = 45.1174, GNorm = 1.6793, lr_0 = 1.0000e-04
Loss = 2.3868e-02, PNorm = 45.1177, GNorm = 1.0235, lr_0 = 1.0000e-04
Validation rmse = 0.158022
Epoch 58
Loss = 4.9905e-02, PNorm = 45.1209, GNorm = 0.9638, lr_0 = 1.0000e-04
Validation rmse = 0.167569
Epoch 59
Loss = 4.4484e-02, PNorm = 45.1248, GNorm = 1.1933, lr_0 = 1.0000e-04
Loss = 4.5606e-02, PNorm = 45.1288, GNorm = 0.8166, lr_0 = 1.0000e-04
Validation rmse = 0.159812
Model 0 best validation rmse = 0.149216 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.136423
Ensemble test rmse = 0.136423
1-fold cross validation
	Seed 0 ==> test rmse = 0.136423
Overall test rmse = 0.136423 +/- 0.000000
Elapsed time = 0:00:41
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/IPA_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/IPA_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/IPA_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 975 | train size = 965 | val size = 10 | test size = 57
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.6368e-01, PNorm = 43.2629, GNorm = 4.9637, lr_0 = 3.6053e-04
Validation rmse = 0.334453
Epoch 1
Loss = 1.2995e+00, PNorm = 43.2920, GNorm = 21.3057, lr_0 = 6.2105e-04
Loss = 7.3605e-01, PNorm = 43.3295, GNorm = 1.3073, lr_0 = 8.5789e-04
Validation rmse = 0.307694
Epoch 2
Loss = 4.8707e-01, PNorm = 43.4063, GNorm = 1.8951, lr_0 = 9.8961e-04
Loss = 4.9064e-01, PNorm = 43.4874, GNorm = 4.0665, lr_0 = 9.6914e-04
Validation rmse = 0.231098
Epoch 3
Loss = 3.4282e-01, PNorm = 43.5721, GNorm = 1.7882, lr_0 = 9.4712e-04
Loss = 2.7699e-01, PNorm = 43.6397, GNorm = 2.7351, lr_0 = 9.2754e-04
Validation rmse = 0.202465
Epoch 4
Loss = 2.7930e-01, PNorm = 43.6972, GNorm = 6.0041, lr_0 = 9.0836e-04
Loss = 2.6743e-01, PNorm = 43.7516, GNorm = 1.6869, lr_0 = 8.8958e-04
Validation rmse = 0.173144
Epoch 5
Loss = 2.1444e-01, PNorm = 43.7952, GNorm = 2.4493, lr_0 = 8.6936e-04
Loss = 2.5378e-01, PNorm = 43.8370, GNorm = 6.1862, lr_0 = 8.5139e-04
Validation rmse = 0.176542
Epoch 6
Loss = 1.8202e-01, PNorm = 43.8863, GNorm = 2.9843, lr_0 = 8.3204e-04
Loss = 1.9202e-01, PNorm = 43.9189, GNorm = 3.0660, lr_0 = 8.1484e-04
Validation rmse = 0.210801
Epoch 7
Loss = 2.0445e-01, PNorm = 43.9486, GNorm = 3.0208, lr_0 = 7.9799e-04
Loss = 1.9255e-01, PNorm = 43.9814, GNorm = 1.9117, lr_0 = 7.8149e-04
Validation rmse = 0.185684
Epoch 8
Loss = 1.4476e-01, PNorm = 44.0161, GNorm = 3.2642, lr_0 = 7.6373e-04
Loss = 1.6095e-01, PNorm = 44.0374, GNorm = 2.8583, lr_0 = 7.4794e-04
Validation rmse = 0.169815
Epoch 9
Loss = 1.3798e-01, PNorm = 44.0648, GNorm = 3.3776, lr_0 = 7.3094e-04
Loss = 1.5801e-01, PNorm = 44.0929, GNorm = 0.9039, lr_0 = 7.1583e-04
Validation rmse = 0.195174
Epoch 10
Loss = 1.7689e-01, PNorm = 44.1169, GNorm = 3.2300, lr_0 = 7.0103e-04
Loss = 1.2718e-01, PNorm = 44.1445, GNorm = 3.1631, lr_0 = 6.8653e-04
Validation rmse = 0.156021
Epoch 11
Loss = 1.3354e-01, PNorm = 44.1667, GNorm = 1.7082, lr_0 = 6.7093e-04
Loss = 1.4171e-01, PNorm = 44.1885, GNorm = 1.4160, lr_0 = 6.5706e-04
Validation rmse = 0.171807
Epoch 12
Loss = 1.0971e-01, PNorm = 44.2138, GNorm = 0.7309, lr_0 = 6.4213e-04
Loss = 1.2907e-01, PNorm = 44.2325, GNorm = 0.7451, lr_0 = 6.2885e-04
Loss = 1.1589e-01, PNorm = 44.2338, GNorm = 1.9809, lr_0 = 6.2754e-04
Validation rmse = 0.146271
Epoch 13
Loss = 1.1378e-01, PNorm = 44.2481, GNorm = 1.1603, lr_0 = 6.1456e-04
Loss = 1.2223e-01, PNorm = 44.2658, GNorm = 3.3290, lr_0 = 6.0185e-04
Validation rmse = 0.145962
Epoch 14
Loss = 1.0698e-01, PNorm = 44.2914, GNorm = 2.5008, lr_0 = 5.8941e-04
Validation rmse = 0.173683
Epoch 15
Loss = 1.2722e-01, PNorm = 44.3112, GNorm = 1.2571, lr_0 = 5.7602e-04
Loss = 9.2931e-02, PNorm = 44.3267, GNorm = 2.0074, lr_0 = 5.6411e-04
Validation rmse = 0.157617
Epoch 16
Loss = 7.4372e-02, PNorm = 44.3460, GNorm = 1.1212, lr_0 = 5.5129e-04
Loss = 1.0717e-01, PNorm = 44.3619, GNorm = 1.7582, lr_0 = 5.3989e-04
Validation rmse = 0.157441
Epoch 17
Loss = 8.1688e-02, PNorm = 44.3745, GNorm = 1.2483, lr_0 = 5.2873e-04
Loss = 1.0136e-01, PNorm = 44.3869, GNorm = 0.6044, lr_0 = 5.1779e-04
Validation rmse = 0.171916
Epoch 18
Loss = 8.6657e-02, PNorm = 44.4009, GNorm = 0.9157, lr_0 = 5.0603e-04
Loss = 1.0276e-01, PNorm = 44.4161, GNorm = 1.1737, lr_0 = 4.9556e-04
Validation rmse = 0.159526
Epoch 19
Loss = 9.4126e-02, PNorm = 44.4319, GNorm = 0.4713, lr_0 = 4.8430e-04
Loss = 9.3723e-02, PNorm = 44.4464, GNorm = 1.1494, lr_0 = 4.7429e-04
Validation rmse = 0.157355
Epoch 20
Loss = 8.0213e-02, PNorm = 44.4578, GNorm = 1.1344, lr_0 = 4.6448e-04
Loss = 9.5483e-02, PNorm = 44.4692, GNorm = 1.3515, lr_0 = 4.5488e-04
Validation rmse = 0.142642
Epoch 21
Loss = 1.1656e-01, PNorm = 44.4815, GNorm = 3.4880, lr_0 = 4.4454e-04
Loss = 9.6840e-02, PNorm = 44.4956, GNorm = 0.6506, lr_0 = 4.3535e-04
Validation rmse = 0.174434
Epoch 22
Loss = 1.1007e-01, PNorm = 44.5140, GNorm = 2.7128, lr_0 = 4.2546e-04
Loss = 9.8517e-02, PNorm = 44.5288, GNorm = 1.8215, lr_0 = 4.1666e-04
Validation rmse = 0.153836
Epoch 23
Loss = 8.2342e-02, PNorm = 44.5451, GNorm = 3.1854, lr_0 = 4.0719e-04
Loss = 9.4073e-02, PNorm = 44.5579, GNorm = 2.3548, lr_0 = 3.9877e-04
Validation rmse = 0.164202
Epoch 24
Loss = 1.1018e-01, PNorm = 44.5674, GNorm = 1.6199, lr_0 = 3.9053e-04
Loss = 8.1226e-02, PNorm = 44.5811, GNorm = 1.8890, lr_0 = 3.8245e-04
Validation rmse = 0.156132
Epoch 25
Loss = 8.8458e-02, PNorm = 44.5934, GNorm = 0.6153, lr_0 = 3.7376e-04
Loss = 8.7229e-02, PNorm = 44.6035, GNorm = 1.4938, lr_0 = 3.6603e-04
Validation rmse = 0.155800
Epoch 26
Loss = 7.4079e-02, PNorm = 44.6175, GNorm = 2.2754, lr_0 = 3.5772e-04
Loss = 8.2887e-02, PNorm = 44.6264, GNorm = 0.7000, lr_0 = 3.5032e-04
Validation rmse = 0.155245
Epoch 27
Loss = 7.8303e-02, PNorm = 44.6345, GNorm = 1.0392, lr_0 = 3.4308e-04
Loss = 7.4396e-02, PNorm = 44.6439, GNorm = 0.6895, lr_0 = 3.3598e-04
Loss = 1.4146e-01, PNorm = 44.6450, GNorm = 2.4924, lr_0 = 3.3528e-04
Validation rmse = 0.141229
Epoch 28
Loss = 7.0163e-02, PNorm = 44.6565, GNorm = 1.0848, lr_0 = 3.2835e-04
Validation rmse = 0.155105
Epoch 29
Loss = 8.7046e-02, PNorm = 44.6650, GNorm = 0.7479, lr_0 = 3.2089e-04
Loss = 7.6870e-02, PNorm = 44.6754, GNorm = 1.2313, lr_0 = 3.1425e-04
Validation rmse = 0.139660
Epoch 30
Loss = 5.3968e-02, PNorm = 44.6849, GNorm = 0.5620, lr_0 = 3.0775e-04
Loss = 6.7177e-02, PNorm = 44.6916, GNorm = 0.6422, lr_0 = 3.0139e-04
Validation rmse = 0.141022
Epoch 31
Loss = 5.3942e-02, PNorm = 44.7019, GNorm = 0.8399, lr_0 = 2.9454e-04
Loss = 7.3700e-02, PNorm = 44.7104, GNorm = 0.6208, lr_0 = 2.8845e-04
Validation rmse = 0.157630
Epoch 32
Loss = 8.7247e-02, PNorm = 44.7203, GNorm = 1.0482, lr_0 = 2.8190e-04
Loss = 7.3863e-02, PNorm = 44.7288, GNorm = 0.6901, lr_0 = 2.7607e-04
Validation rmse = 0.159758
Epoch 33
Loss = 6.7364e-02, PNorm = 44.7392, GNorm = 0.8060, lr_0 = 2.6980e-04
Loss = 7.4988e-02, PNorm = 44.7478, GNorm = 1.5056, lr_0 = 2.6422e-04
Validation rmse = 0.142918
Epoch 34
Loss = 5.1750e-02, PNorm = 44.7578, GNorm = 0.6063, lr_0 = 2.5875e-04
Loss = 7.2676e-02, PNorm = 44.7656, GNorm = 1.2359, lr_0 = 2.5340e-04
Validation rmse = 0.148676
Epoch 35
Loss = 7.6210e-02, PNorm = 44.7731, GNorm = 2.4106, lr_0 = 2.4764e-04
Loss = 7.0309e-02, PNorm = 44.7836, GNorm = 1.8517, lr_0 = 2.4252e-04
Validation rmse = 0.135603
Epoch 36
Loss = 7.2061e-02, PNorm = 44.7922, GNorm = 0.7087, lr_0 = 2.3701e-04
Loss = 8.2342e-02, PNorm = 44.8020, GNorm = 2.2002, lr_0 = 2.3211e-04
Validation rmse = 0.144418
Epoch 37
Loss = 7.9024e-02, PNorm = 44.8099, GNorm = 1.4476, lr_0 = 2.2731e-04
Loss = 7.6677e-02, PNorm = 44.8171, GNorm = 1.8497, lr_0 = 2.2261e-04
Validation rmse = 0.128917
Epoch 38
Loss = 7.9087e-02, PNorm = 44.8265, GNorm = 2.1219, lr_0 = 2.1755e-04
Loss = 6.3922e-02, PNorm = 44.8335, GNorm = 1.3494, lr_0 = 2.1306e-04
Validation rmse = 0.134896
Epoch 39
Loss = 6.3108e-02, PNorm = 44.8401, GNorm = 0.7517, lr_0 = 2.0821e-04
Loss = 6.3523e-02, PNorm = 44.8467, GNorm = 1.0135, lr_0 = 2.0391e-04
Validation rmse = 0.142028
Epoch 40
Loss = 5.7605e-02, PNorm = 44.8533, GNorm = 1.1652, lr_0 = 1.9969e-04
Loss = 6.6018e-02, PNorm = 44.8586, GNorm = 0.6023, lr_0 = 1.9556e-04
Validation rmse = 0.143030
Epoch 41
Loss = 6.1012e-02, PNorm = 44.8669, GNorm = 0.8679, lr_0 = 1.9112e-04
Loss = 6.0590e-02, PNorm = 44.8727, GNorm = 1.1782, lr_0 = 1.8717e-04
Loss = 6.3093e-02, PNorm = 44.8734, GNorm = 1.7324, lr_0 = 1.8678e-04
Validation rmse = 0.155412
Epoch 42
Loss = 6.0846e-02, PNorm = 44.8804, GNorm = 0.4880, lr_0 = 1.8292e-04
Validation rmse = 0.139705
Epoch 43
Loss = 5.8398e-02, PNorm = 44.8869, GNorm = 0.7204, lr_0 = 1.7876e-04
Loss = 5.1583e-02, PNorm = 44.8924, GNorm = 0.3225, lr_0 = 1.7506e-04
Validation rmse = 0.139373
Epoch 44
Loss = 5.1506e-02, PNorm = 44.8972, GNorm = 0.7881, lr_0 = 1.7144e-04
Loss = 5.6785e-02, PNorm = 44.9029, GNorm = 0.4853, lr_0 = 1.6790e-04
Validation rmse = 0.126644
Epoch 45
Loss = 5.9026e-02, PNorm = 44.9092, GNorm = 0.9203, lr_0 = 1.6408e-04
Loss = 5.6849e-02, PNorm = 44.9149, GNorm = 0.8594, lr_0 = 1.6069e-04
Validation rmse = 0.148083
Epoch 46
Loss = 7.5055e-02, PNorm = 44.9209, GNorm = 2.3764, lr_0 = 1.5704e-04
Loss = 6.5839e-02, PNorm = 44.9276, GNorm = 1.6398, lr_0 = 1.5379e-04
Validation rmse = 0.131244
Epoch 47
Loss = 6.1661e-02, PNorm = 44.9329, GNorm = 1.0394, lr_0 = 1.5061e-04
Loss = 5.7030e-02, PNorm = 44.9387, GNorm = 0.7570, lr_0 = 1.4750e-04
Validation rmse = 0.129436
Epoch 48
Loss = 4.6254e-02, PNorm = 44.9434, GNorm = 0.7430, lr_0 = 1.4415e-04
Loss = 5.2417e-02, PNorm = 44.9481, GNorm = 0.5981, lr_0 = 1.4117e-04
Validation rmse = 0.132272
Epoch 49
Loss = 5.2820e-02, PNorm = 44.9528, GNorm = 1.0692, lr_0 = 1.3796e-04
Loss = 5.4609e-02, PNorm = 44.9570, GNorm = 0.5711, lr_0 = 1.3511e-04
Validation rmse = 0.116198
Epoch 50
Loss = 5.1868e-02, PNorm = 44.9625, GNorm = 0.7378, lr_0 = 1.3231e-04
Loss = 5.7671e-02, PNorm = 44.9662, GNorm = 0.6254, lr_0 = 1.2958e-04
Validation rmse = 0.128102
Epoch 51
Loss = 6.1809e-02, PNorm = 44.9719, GNorm = 0.8400, lr_0 = 1.2663e-04
Loss = 5.2152e-02, PNorm = 44.9765, GNorm = 0.7969, lr_0 = 1.2401e-04
Validation rmse = 0.114645
Epoch 52
Loss = 4.5247e-02, PNorm = 44.9813, GNorm = 1.5660, lr_0 = 1.2119e-04
Loss = 6.7208e-02, PNorm = 44.9858, GNorm = 1.2209, lr_0 = 1.1869e-04
Validation rmse = 0.124766
Epoch 53
Loss = 5.2225e-02, PNorm = 44.9905, GNorm = 0.5133, lr_0 = 1.1599e-04
Loss = 5.2422e-02, PNorm = 44.9948, GNorm = 0.7154, lr_0 = 1.1359e-04
Validation rmse = 0.123798
Epoch 54
Loss = 5.0068e-02, PNorm = 44.9994, GNorm = 0.4871, lr_0 = 1.1124e-04
Loss = 5.0681e-02, PNorm = 45.0029, GNorm = 0.9565, lr_0 = 1.0894e-04
Validation rmse = 0.121572
Epoch 55
Loss = 4.8241e-02, PNorm = 45.0072, GNorm = 0.5005, lr_0 = 1.0647e-04
Loss = 5.2561e-02, PNorm = 45.0115, GNorm = 0.9487, lr_0 = 1.0427e-04
Loss = 2.6944e-02, PNorm = 45.0119, GNorm = 0.9534, lr_0 = 1.0405e-04
Validation rmse = 0.119447
Epoch 56
Loss = 5.3072e-02, PNorm = 45.0160, GNorm = 0.6146, lr_0 = 1.0190e-04
Loss = 4.5378e-02, PNorm = 45.0203, GNorm = 0.7562, lr_0 = 1.0000e-04
Validation rmse = 0.120322
Epoch 57
Loss = 4.7033e-02, PNorm = 45.0235, GNorm = 0.4817, lr_0 = 1.0000e-04
Validation rmse = 0.122493
Epoch 58
Loss = 3.8412e-02, PNorm = 45.0272, GNorm = 0.6354, lr_0 = 1.0000e-04
Loss = 4.3632e-02, PNorm = 45.0309, GNorm = 0.8926, lr_0 = 1.0000e-04
Validation rmse = 0.129486
Epoch 59
Loss = 6.9411e-02, PNorm = 45.0349, GNorm = 1.7767, lr_0 = 1.0000e-04
Loss = 4.3711e-02, PNorm = 45.0384, GNorm = 0.6023, lr_0 = 1.0000e-04
Validation rmse = 0.114457
Model 0 best validation rmse = 0.114457 on epoch 59
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.161798
Ensemble test rmse = 0.161798
1-fold cross validation
	Seed 0 ==> test rmse = 0.161798
Overall test rmse = 0.161798 +/- 0.000000
Elapsed time = 0:00:43
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/Tol_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/Tol_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/Tol_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 984 | train size = 974 | val size = 10 | test size = 48
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 8.6050e-01, PNorm = 43.2664, GNorm = 1.5742, lr_0 = 3.6053e-04
Validation rmse = 0.265278
Epoch 1
Loss = 6.8094e-01, PNorm = 43.2916, GNorm = 8.7570, lr_0 = 6.2105e-04
Loss = 7.1686e-01, PNorm = 43.3267, GNorm = 5.3634, lr_0 = 8.5789e-04
Validation rmse = 0.255325
Epoch 2
Loss = 5.3669e-01, PNorm = 43.3998, GNorm = 1.7678, lr_0 = 9.8961e-04
Loss = 3.8935e-01, PNorm = 43.4646, GNorm = 2.3614, lr_0 = 9.6914e-04
Validation rmse = 0.221152
Epoch 3
Loss = 2.7739e-01, PNorm = 43.5277, GNorm = 1.5475, lr_0 = 9.4910e-04
Loss = 2.7876e-01, PNorm = 43.5811, GNorm = 2.3156, lr_0 = 9.2948e-04
Validation rmse = 0.156545
Epoch 4
Loss = 3.3260e-01, PNorm = 43.6254, GNorm = 5.3794, lr_0 = 9.0836e-04
Loss = 2.3133e-01, PNorm = 43.6722, GNorm = 1.6928, lr_0 = 8.8958e-04
Validation rmse = 0.157497
Epoch 5
Loss = 2.4472e-01, PNorm = 43.7130, GNorm = 7.2312, lr_0 = 8.7118e-04
Loss = 2.0617e-01, PNorm = 43.7529, GNorm = 3.7870, lr_0 = 8.5317e-04
Validation rmse = 0.149938
Epoch 6
Loss = 1.6305e-01, PNorm = 43.7787, GNorm = 0.7738, lr_0 = 8.3378e-04
Loss = 1.9416e-01, PNorm = 43.8092, GNorm = 2.5754, lr_0 = 8.1654e-04
Validation rmse = 0.142862
Epoch 7
Loss = 1.4317e-01, PNorm = 43.8356, GNorm = 3.1363, lr_0 = 7.9966e-04
Loss = 1.5358e-01, PNorm = 43.8574, GNorm = 1.3063, lr_0 = 7.8312e-04
Validation rmse = 0.128086
Epoch 8
Loss = 1.3422e-01, PNorm = 43.8816, GNorm = 1.4217, lr_0 = 7.6533e-04
Loss = 1.3477e-01, PNorm = 43.9072, GNorm = 4.5695, lr_0 = 7.4950e-04
Validation rmse = 0.214519
Epoch 9
Loss = 1.9042e-01, PNorm = 43.9313, GNorm = 5.7138, lr_0 = 7.3400e-04
Loss = 1.4720e-01, PNorm = 43.9635, GNorm = 5.2239, lr_0 = 7.1883e-04
Validation rmse = 0.143645
Epoch 10
Loss = 1.7697e-01, PNorm = 43.9936, GNorm = 2.1480, lr_0 = 7.0249e-04
Loss = 1.3443e-01, PNorm = 44.0211, GNorm = 2.7344, lr_0 = 6.8797e-04
Validation rmse = 0.139627
Epoch 11
Loss = 1.4842e-01, PNorm = 44.0425, GNorm = 0.8478, lr_0 = 6.7374e-04
Loss = 1.3618e-01, PNorm = 44.0628, GNorm = 2.5562, lr_0 = 6.5981e-04
Validation rmse = 0.117893
Epoch 12
Loss = 9.6698e-02, PNorm = 44.0912, GNorm = 0.9780, lr_0 = 6.4482e-04
Loss = 1.2243e-01, PNorm = 44.1089, GNorm = 2.9578, lr_0 = 6.3148e-04
Validation rmse = 0.111663
Epoch 13
Loss = 1.1502e-01, PNorm = 44.1231, GNorm = 1.6870, lr_0 = 6.1843e-04
Loss = 1.0768e-01, PNorm = 44.1391, GNorm = 2.0280, lr_0 = 6.0564e-04
Validation rmse = 0.122517
Epoch 14
Loss = 1.1226e-01, PNorm = 44.1588, GNorm = 0.7980, lr_0 = 5.9188e-04
Loss = 1.1385e-01, PNorm = 44.1796, GNorm = 1.3947, lr_0 = 5.7964e-04
Validation rmse = 0.144136
Epoch 15
Loss = 1.0652e-01, PNorm = 44.1981, GNorm = 1.2197, lr_0 = 5.6765e-04
Loss = 1.0741e-01, PNorm = 44.2153, GNorm = 1.5860, lr_0 = 5.5592e-04
Validation rmse = 0.107799
Epoch 16
Loss = 9.8630e-02, PNorm = 44.2277, GNorm = 0.8089, lr_0 = 5.4328e-04
Loss = 1.1412e-01, PNorm = 44.2416, GNorm = 0.7896, lr_0 = 5.3205e-04
Validation rmse = 0.113848
Epoch 17
Loss = 1.0451e-01, PNorm = 44.2579, GNorm = 2.4996, lr_0 = 5.2105e-04
Loss = 1.1624e-01, PNorm = 44.2761, GNorm = 2.0598, lr_0 = 5.1027e-04
Loss = 8.3456e-02, PNorm = 44.2780, GNorm = 2.8518, lr_0 = 5.0921e-04
Validation rmse = 0.114494
Epoch 18
Loss = 1.2478e-01, PNorm = 44.2922, GNorm = 3.6438, lr_0 = 4.9868e-04
Loss = 1.4258e-01, PNorm = 44.3070, GNorm = 4.9046, lr_0 = 4.8837e-04
Validation rmse = 0.136183
Epoch 19
Loss = 1.3978e-01, PNorm = 44.3301, GNorm = 1.1131, lr_0 = 4.7827e-04
Validation rmse = 0.129204
Epoch 20
Loss = 1.4704e-01, PNorm = 44.3518, GNorm = 1.3078, lr_0 = 4.6740e-04
Loss = 1.0594e-01, PNorm = 44.3712, GNorm = 0.6459, lr_0 = 4.5774e-04
Validation rmse = 0.125896
Epoch 21
Loss = 1.2753e-01, PNorm = 44.3876, GNorm = 2.9836, lr_0 = 4.4827e-04
Loss = 9.8667e-02, PNorm = 44.4025, GNorm = 0.4409, lr_0 = 4.3900e-04
Validation rmse = 0.110622
Epoch 22
Loss = 9.7586e-02, PNorm = 44.4137, GNorm = 1.1393, lr_0 = 4.2903e-04
Loss = 9.2287e-02, PNorm = 44.4256, GNorm = 1.9224, lr_0 = 4.2016e-04
Validation rmse = 0.110528
Epoch 23
Loss = 1.1036e-01, PNorm = 44.4332, GNorm = 1.1421, lr_0 = 4.1147e-04
Loss = 9.1391e-02, PNorm = 44.4470, GNorm = 2.1019, lr_0 = 4.0296e-04
Validation rmse = 0.109720
Epoch 24
Loss = 9.8487e-02, PNorm = 44.4615, GNorm = 1.7504, lr_0 = 3.9381e-04
Loss = 8.3005e-02, PNorm = 44.4711, GNorm = 0.7729, lr_0 = 3.8566e-04
Validation rmse = 0.097479
Epoch 25
Loss = 8.4688e-02, PNorm = 44.4822, GNorm = 1.5853, lr_0 = 3.7769e-04
Loss = 1.0036e-01, PNorm = 44.4937, GNorm = 0.9047, lr_0 = 3.6988e-04
Validation rmse = 0.105711
Epoch 26
Loss = 7.4636e-02, PNorm = 44.5037, GNorm = 1.4431, lr_0 = 3.6147e-04
Loss = 9.0827e-02, PNorm = 44.5159, GNorm = 0.6055, lr_0 = 3.5400e-04
Validation rmse = 0.117295
Epoch 27
Loss = 1.1365e-01, PNorm = 44.5289, GNorm = 2.1819, lr_0 = 3.4596e-04
Loss = 9.1054e-02, PNorm = 44.5437, GNorm = 0.7349, lr_0 = 3.3880e-04
Validation rmse = 0.099716
Epoch 28
Loss = 8.1083e-02, PNorm = 44.5547, GNorm = 2.2600, lr_0 = 3.3180e-04
Loss = 9.3811e-02, PNorm = 44.5625, GNorm = 1.8357, lr_0 = 3.2494e-04
Validation rmse = 0.111879
Epoch 29
Loss = 8.0105e-02, PNorm = 44.5729, GNorm = 0.6770, lr_0 = 3.1755e-04
Loss = 7.5703e-02, PNorm = 44.5808, GNorm = 0.6728, lr_0 = 3.1099e-04
Validation rmse = 0.097205
Epoch 30
Loss = 8.3851e-02, PNorm = 44.5926, GNorm = 1.6002, lr_0 = 3.0456e-04
Loss = 8.2883e-02, PNorm = 44.6020, GNorm = 1.4377, lr_0 = 2.9826e-04
Validation rmse = 0.095737
Epoch 31
Loss = 7.2375e-02, PNorm = 44.6121, GNorm = 0.7294, lr_0 = 2.9148e-04
Loss = 8.5651e-02, PNorm = 44.6206, GNorm = 0.6234, lr_0 = 2.8545e-04
Validation rmse = 0.095185
Epoch 32
Loss = 7.7732e-02, PNorm = 44.6286, GNorm = 0.5600, lr_0 = 2.7955e-04
Loss = 7.8070e-02, PNorm = 44.6394, GNorm = 0.9435, lr_0 = 2.7377e-04
Validation rmse = 0.099611
Epoch 33
Loss = 7.7438e-02, PNorm = 44.6483, GNorm = 0.9452, lr_0 = 2.6755e-04
Loss = 6.6332e-02, PNorm = 44.6558, GNorm = 0.3633, lr_0 = 2.6202e-04
Validation rmse = 0.090991
Epoch 34
Loss = 8.5157e-02, PNorm = 44.6632, GNorm = 1.1808, lr_0 = 2.5660e-04
Loss = 6.0524e-02, PNorm = 44.6708, GNorm = 0.7946, lr_0 = 2.5129e-04
Validation rmse = 0.099250
Epoch 35
Loss = 6.7798e-02, PNorm = 44.6770, GNorm = 1.5559, lr_0 = 2.4558e-04
Loss = 7.2582e-02, PNorm = 44.6854, GNorm = 0.5763, lr_0 = 2.4051e-04
Validation rmse = 0.096779
Epoch 36
Loss = 6.0925e-02, PNorm = 44.6942, GNorm = 1.3540, lr_0 = 2.3553e-04
Loss = 7.7358e-02, PNorm = 44.7009, GNorm = 0.5278, lr_0 = 2.3066e-04
Loss = 5.1917e-02, PNorm = 44.7018, GNorm = 1.8861, lr_0 = 2.3018e-04
Validation rmse = 0.100903
Epoch 37
Loss = 6.2056e-02, PNorm = 44.7101, GNorm = 0.5768, lr_0 = 2.2542e-04
Loss = 7.4360e-02, PNorm = 44.7171, GNorm = 0.6363, lr_0 = 2.2076e-04
Validation rmse = 0.091468
Epoch 38
Loss = 6.2870e-02, PNorm = 44.7228, GNorm = 1.2667, lr_0 = 2.1620e-04
Validation rmse = 0.094066
Epoch 39
Loss = 6.6089e-02, PNorm = 44.7317, GNorm = 1.7014, lr_0 = 2.1128e-04
Loss = 6.9288e-02, PNorm = 44.7404, GNorm = 0.4227, lr_0 = 2.0691e-04
Validation rmse = 0.093434
Epoch 40
Loss = 7.6973e-02, PNorm = 44.7473, GNorm = 0.9076, lr_0 = 2.0264e-04
Loss = 6.5110e-02, PNorm = 44.7538, GNorm = 0.8725, lr_0 = 1.9845e-04
Validation rmse = 0.095679
Epoch 41
Loss = 8.3140e-02, PNorm = 44.7603, GNorm = 1.7319, lr_0 = 1.9394e-04
Loss = 6.4432e-02, PNorm = 44.7674, GNorm = 2.3431, lr_0 = 1.8993e-04
Validation rmse = 0.103964
Epoch 42
Loss = 5.5905e-02, PNorm = 44.7738, GNorm = 1.1245, lr_0 = 1.8600e-04
Loss = 6.6359e-02, PNorm = 44.7795, GNorm = 1.1445, lr_0 = 1.8215e-04
Validation rmse = 0.096712
Epoch 43
Loss = 5.5785e-02, PNorm = 44.7860, GNorm = 0.4433, lr_0 = 1.7801e-04
Loss = 6.3351e-02, PNorm = 44.7929, GNorm = 0.8174, lr_0 = 1.7433e-04
Validation rmse = 0.095089
Epoch 44
Loss = 5.9883e-02, PNorm = 44.7987, GNorm = 1.2439, lr_0 = 1.7073e-04
Loss = 5.7778e-02, PNorm = 44.8046, GNorm = 1.2213, lr_0 = 1.6720e-04
Validation rmse = 0.090232
Epoch 45
Loss = 5.6334e-02, PNorm = 44.8115, GNorm = 1.0740, lr_0 = 1.6340e-04
Loss = 6.0634e-02, PNorm = 44.8177, GNorm = 0.4809, lr_0 = 1.6002e-04
Validation rmse = 0.092083
Epoch 46
Loss = 5.7357e-02, PNorm = 44.8228, GNorm = 0.6961, lr_0 = 1.5671e-04
Loss = 5.9362e-02, PNorm = 44.8276, GNorm = 1.0139, lr_0 = 1.5347e-04
Validation rmse = 0.090039
Epoch 47
Loss = 5.4582e-02, PNorm = 44.8341, GNorm = 1.6214, lr_0 = 1.4998e-04
Loss = 6.5113e-02, PNorm = 44.8389, GNorm = 0.7148, lr_0 = 1.4688e-04
Validation rmse = 0.089045
Epoch 48
Loss = 6.3330e-02, PNorm = 44.8445, GNorm = 1.3288, lr_0 = 1.4384e-04
Loss = 5.4416e-02, PNorm = 44.8496, GNorm = 0.4789, lr_0 = 1.4087e-04
Validation rmse = 0.089107
Epoch 49
Loss = 5.1370e-02, PNorm = 44.8552, GNorm = 1.0327, lr_0 = 1.3767e-04
Loss = 6.3981e-02, PNorm = 44.8596, GNorm = 1.5359, lr_0 = 1.3482e-04
Validation rmse = 0.093430
Epoch 50
Loss = 4.8003e-02, PNorm = 44.8654, GNorm = 0.7337, lr_0 = 1.3204e-04
Loss = 6.2022e-02, PNorm = 44.8699, GNorm = 0.5000, lr_0 = 1.2930e-04
Validation rmse = 0.088830
Epoch 51
Loss = 5.1151e-02, PNorm = 44.8748, GNorm = 0.9530, lr_0 = 1.2637e-04
Loss = 5.7661e-02, PNorm = 44.8787, GNorm = 1.4177, lr_0 = 1.2375e-04
Validation rmse = 0.091743
Epoch 52
Loss = 5.7473e-02, PNorm = 44.8841, GNorm = 1.3222, lr_0 = 1.2094e-04
Loss = 5.4593e-02, PNorm = 44.8883, GNorm = 0.5273, lr_0 = 1.1844e-04
Validation rmse = 0.097913
Epoch 53
Loss = 5.2515e-02, PNorm = 44.8931, GNorm = 0.6956, lr_0 = 1.1599e-04
Loss = 5.6367e-02, PNorm = 44.8976, GNorm = 0.4317, lr_0 = 1.1359e-04
Validation rmse = 0.091695
Epoch 54
Loss = 4.9945e-02, PNorm = 44.9027, GNorm = 1.9209, lr_0 = 1.1101e-04
Loss = 6.1302e-02, PNorm = 44.9065, GNorm = 1.1195, lr_0 = 1.0872e-04
Validation rmse = 0.092251
Epoch 55
Loss = 5.8090e-02, PNorm = 44.9104, GNorm = 0.7254, lr_0 = 1.0647e-04
Loss = 4.8942e-02, PNorm = 44.9138, GNorm = 0.5866, lr_0 = 1.0427e-04
Loss = 6.7896e-02, PNorm = 44.9142, GNorm = 1.5779, lr_0 = 1.0405e-04
Validation rmse = 0.086723
Epoch 56
Loss = 5.7343e-02, PNorm = 44.9188, GNorm = 1.1831, lr_0 = 1.0190e-04
Loss = 4.5448e-02, PNorm = 44.9221, GNorm = 0.5689, lr_0 = 1.0000e-04
Validation rmse = 0.087022
Epoch 57
Loss = 5.0545e-02, PNorm = 44.9249, GNorm = 0.5018, lr_0 = 1.0000e-04
Validation rmse = 0.083919
Epoch 58
Loss = 4.7930e-02, PNorm = 44.9289, GNorm = 0.8193, lr_0 = 1.0000e-04
Loss = 5.1857e-02, PNorm = 44.9327, GNorm = 0.8328, lr_0 = 1.0000e-04
Validation rmse = 0.087618
Epoch 59
Loss = 5.6203e-02, PNorm = 44.9361, GNorm = 0.9575, lr_0 = 1.0000e-04
Loss = 4.8873e-02, PNorm = 44.9397, GNorm = 0.6795, lr_0 = 1.0000e-04
Validation rmse = 0.086298
Model 0 best validation rmse = 0.083919 on epoch 57
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.612454
Ensemble test rmse = 0.612454
1-fold cross validation
	Seed 0 ==> test rmse = 0.612454
Overall test rmse = 0.612454 +/- 0.000000
Elapsed time = 0:00:44
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/Hept_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/Hept_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/Hept_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 983 | train size = 973 | val size = 10 | test size = 49
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.1038e-01, PNorm = 43.2601, GNorm = 2.4318, lr_0 = 3.6053e-04
Validation rmse = 0.147519
Epoch 1
Loss = 9.5312e-01, PNorm = 43.2902, GNorm = 5.4721, lr_0 = 6.2105e-04
Loss = 8.2921e-01, PNorm = 43.3243, GNorm = 5.9971, lr_0 = 8.5789e-04
Validation rmse = 0.211057
Epoch 2
Loss = 6.3890e-01, PNorm = 43.3845, GNorm = 1.7665, lr_0 = 9.8961e-04
Loss = 5.0384e-01, PNorm = 43.4601, GNorm = 3.5403, lr_0 = 9.6914e-04
Validation rmse = 0.142482
Epoch 3
Loss = 5.8892e-01, PNorm = 43.5406, GNorm = 7.1921, lr_0 = 9.4910e-04
Loss = 3.1565e-01, PNorm = 43.6101, GNorm = 1.3057, lr_0 = 9.2948e-04
Validation rmse = 0.148716
Epoch 4
Loss = 3.2103e-01, PNorm = 43.6716, GNorm = 4.5482, lr_0 = 9.0836e-04
Loss = 2.4195e-01, PNorm = 43.7271, GNorm = 1.0271, lr_0 = 8.8958e-04
Validation rmse = 0.129185
Epoch 5
Loss = 1.8568e-01, PNorm = 43.7674, GNorm = 3.4611, lr_0 = 8.7118e-04
Loss = 2.7209e-01, PNorm = 43.8082, GNorm = 1.5205, lr_0 = 8.5317e-04
Validation rmse = 0.128018
Epoch 6
Loss = 2.2733e-01, PNorm = 43.8519, GNorm = 2.1711, lr_0 = 8.3378e-04
Loss = 2.9451e-01, PNorm = 43.8843, GNorm = 1.9596, lr_0 = 8.1654e-04
Validation rmse = 0.210039
Epoch 7
Loss = 3.2909e-01, PNorm = 43.9368, GNorm = 6.5922, lr_0 = 7.9966e-04
Loss = 2.8839e-01, PNorm = 43.9821, GNorm = 3.9780, lr_0 = 7.8312e-04
Validation rmse = 0.133253
Epoch 8
Loss = 2.5208e-01, PNorm = 44.0229, GNorm = 1.5810, lr_0 = 7.6533e-04
Loss = 2.0794e-01, PNorm = 44.0561, GNorm = 0.6689, lr_0 = 7.4950e-04
Validation rmse = 0.139631
Epoch 9
Loss = 1.5851e-01, PNorm = 44.0854, GNorm = 0.5270, lr_0 = 7.3400e-04
Loss = 1.6540e-01, PNorm = 44.1077, GNorm = 1.3963, lr_0 = 7.1883e-04
Validation rmse = 0.123200
Epoch 10
Loss = 1.6223e-01, PNorm = 44.1320, GNorm = 2.4383, lr_0 = 7.0249e-04
Loss = 1.4839e-01, PNorm = 44.1486, GNorm = 0.6806, lr_0 = 6.8797e-04
Validation rmse = 0.128797
Epoch 11
Loss = 1.4877e-01, PNorm = 44.1726, GNorm = 1.1483, lr_0 = 6.7374e-04
Loss = 1.5965e-01, PNorm = 44.1929, GNorm = 0.7015, lr_0 = 6.5981e-04
Validation rmse = 0.123651
Epoch 12
Loss = 1.3455e-01, PNorm = 44.2127, GNorm = 0.7979, lr_0 = 6.4482e-04
Loss = 1.4221e-01, PNorm = 44.2298, GNorm = 1.8214, lr_0 = 6.3148e-04
Validation rmse = 0.136381
Epoch 13
Loss = 1.1805e-01, PNorm = 44.2545, GNorm = 0.5169, lr_0 = 6.1714e-04
Loss = 1.5843e-01, PNorm = 44.2710, GNorm = 0.7272, lr_0 = 6.0438e-04
Validation rmse = 0.148730
Epoch 14
Loss = 1.4370e-01, PNorm = 44.2890, GNorm = 2.3505, lr_0 = 5.9188e-04
Loss = 1.6459e-01, PNorm = 44.3125, GNorm = 2.2489, lr_0 = 5.7964e-04
Validation rmse = 0.127585
Epoch 15
Loss = 1.5120e-01, PNorm = 44.3404, GNorm = 2.9863, lr_0 = 5.6647e-04
Loss = 1.4975e-01, PNorm = 44.3616, GNorm = 0.7696, lr_0 = 5.5476e-04
Validation rmse = 0.156283
Epoch 16
Loss = 1.2633e-01, PNorm = 44.3749, GNorm = 1.4334, lr_0 = 5.4328e-04
Loss = 1.2699e-01, PNorm = 44.3940, GNorm = 2.9833, lr_0 = 5.3205e-04
Loss = 1.8846e-01, PNorm = 44.3958, GNorm = 2.6394, lr_0 = 5.3094e-04
Validation rmse = 0.150807
Epoch 17
Loss = 1.2861e-01, PNorm = 44.4131, GNorm = 2.4410, lr_0 = 5.1996e-04
Loss = 1.3190e-01, PNorm = 44.4319, GNorm = 0.9332, lr_0 = 5.0921e-04
Validation rmse = 0.120937
Epoch 18
Loss = 1.2218e-01, PNorm = 44.4463, GNorm = 1.5666, lr_0 = 4.9868e-04
Validation rmse = 0.135934
Epoch 19
Loss = 1.2922e-01, PNorm = 44.4641, GNorm = 0.9346, lr_0 = 4.8735e-04
Loss = 1.0848e-01, PNorm = 44.4805, GNorm = 0.8132, lr_0 = 4.7727e-04
Validation rmse = 0.143750
Epoch 20
Loss = 1.4907e-01, PNorm = 44.4955, GNorm = 0.7238, lr_0 = 4.6740e-04
Loss = 1.2326e-01, PNorm = 44.5096, GNorm = 1.8278, lr_0 = 4.5774e-04
Validation rmse = 0.171714
Epoch 21
Loss = 1.1801e-01, PNorm = 44.5258, GNorm = 3.3112, lr_0 = 4.4734e-04
Loss = 1.2515e-01, PNorm = 44.5431, GNorm = 2.0979, lr_0 = 4.3809e-04
Validation rmse = 0.182840
Epoch 22
Loss = 1.2331e-01, PNorm = 44.5611, GNorm = 0.9229, lr_0 = 4.2903e-04
Loss = 1.1592e-01, PNorm = 44.5791, GNorm = 1.4144, lr_0 = 4.2016e-04
Validation rmse = 0.166600
Epoch 23
Loss = 8.7911e-02, PNorm = 44.5922, GNorm = 0.7701, lr_0 = 4.1061e-04
Loss = 1.1397e-01, PNorm = 44.6074, GNorm = 1.0336, lr_0 = 4.0212e-04
Validation rmse = 0.145963
Epoch 24
Loss = 1.1157e-01, PNorm = 44.6219, GNorm = 1.7882, lr_0 = 3.9381e-04
Loss = 1.1002e-01, PNorm = 44.6351, GNorm = 0.7885, lr_0 = 3.8566e-04
Validation rmse = 0.149220
Epoch 25
Loss = 1.1327e-01, PNorm = 44.6530, GNorm = 1.0739, lr_0 = 3.7690e-04
Loss = 1.0386e-01, PNorm = 44.6652, GNorm = 2.1136, lr_0 = 3.6911e-04
Validation rmse = 0.139074
Epoch 26
Loss = 1.0352e-01, PNorm = 44.6797, GNorm = 1.1356, lr_0 = 3.6072e-04
Loss = 9.5481e-02, PNorm = 44.6922, GNorm = 1.4650, lr_0 = 3.5326e-04
Validation rmse = 0.129289
Epoch 27
Loss = 7.0523e-02, PNorm = 44.7036, GNorm = 1.4688, lr_0 = 3.4596e-04
Loss = 1.1265e-01, PNorm = 44.7179, GNorm = 1.0783, lr_0 = 3.3880e-04
Validation rmse = 0.142611
Epoch 28
Loss = 9.4930e-02, PNorm = 44.7318, GNorm = 1.1997, lr_0 = 3.3110e-04
Loss = 1.0236e-01, PNorm = 44.7443, GNorm = 0.6212, lr_0 = 3.2426e-04
Validation rmse = 0.146674
Epoch 29
Loss = 8.9033e-02, PNorm = 44.7571, GNorm = 1.2609, lr_0 = 3.1755e-04
Loss = 9.9828e-02, PNorm = 44.7700, GNorm = 1.9566, lr_0 = 3.1099e-04
Validation rmse = 0.145512
Epoch 30
Loss = 9.5331e-02, PNorm = 44.7827, GNorm = 1.8264, lr_0 = 3.0392e-04
Loss = 8.8870e-02, PNorm = 44.7936, GNorm = 1.0526, lr_0 = 2.9764e-04
Validation rmse = 0.163584
Epoch 31
Loss = 8.8296e-02, PNorm = 44.8057, GNorm = 2.2104, lr_0 = 2.9148e-04
Loss = 9.3536e-02, PNorm = 44.8183, GNorm = 0.8769, lr_0 = 2.8545e-04
Validation rmse = 0.158227
Epoch 32
Loss = 9.2497e-02, PNorm = 44.8291, GNorm = 1.6484, lr_0 = 2.7897e-04
Loss = 8.2799e-02, PNorm = 44.8403, GNorm = 0.4538, lr_0 = 2.7320e-04
Validation rmse = 0.150883
Epoch 33
Loss = 8.0912e-02, PNorm = 44.8523, GNorm = 0.7324, lr_0 = 2.6755e-04
Loss = 8.5759e-02, PNorm = 44.8641, GNorm = 2.8405, lr_0 = 2.6202e-04
Validation rmse = 0.168607
Epoch 34
Loss = 9.1544e-02, PNorm = 44.8752, GNorm = 0.5190, lr_0 = 2.5606e-04
Loss = 8.7826e-02, PNorm = 44.8876, GNorm = 0.7273, lr_0 = 2.5077e-04
Validation rmse = 0.147048
Epoch 35
Loss = 8.1059e-02, PNorm = 44.8970, GNorm = 1.4432, lr_0 = 2.4558e-04
Loss = 8.9214e-02, PNorm = 44.9079, GNorm = 1.3047, lr_0 = 2.4051e-04
Loss = 3.7644e-02, PNorm = 44.9092, GNorm = 1.6813, lr_0 = 2.4000e-04
Validation rmse = 0.146247
Epoch 36
Loss = 7.6457e-02, PNorm = 44.9191, GNorm = 1.3537, lr_0 = 2.3504e-04
Loss = 8.4110e-02, PNorm = 44.9299, GNorm = 0.8113, lr_0 = 2.3018e-04
Validation rmse = 0.151181
Epoch 37
Loss = 7.7785e-02, PNorm = 44.9384, GNorm = 1.0365, lr_0 = 2.2542e-04
Validation rmse = 0.142466
Epoch 38
Loss = 4.2397e-02, PNorm = 44.9486, GNorm = 0.4649, lr_0 = 2.2030e-04
Loss = 6.6205e-02, PNorm = 44.9585, GNorm = 0.5992, lr_0 = 2.1574e-04
Validation rmse = 0.144460
Epoch 39
Loss = 6.9809e-02, PNorm = 44.9685, GNorm = 1.2589, lr_0 = 2.1084e-04
Loss = 7.5253e-02, PNorm = 44.9787, GNorm = 1.7805, lr_0 = 2.0648e-04
Validation rmse = 0.138063
Epoch 40
Loss = 5.5952e-02, PNorm = 44.9879, GNorm = 0.6938, lr_0 = 2.0221e-04
Loss = 7.8968e-02, PNorm = 44.9974, GNorm = 0.7571, lr_0 = 1.9803e-04
Validation rmse = 0.149086
Epoch 41
Loss = 6.7958e-02, PNorm = 45.0071, GNorm = 0.4307, lr_0 = 1.9353e-04
Loss = 6.7601e-02, PNorm = 45.0151, GNorm = 0.4695, lr_0 = 1.8953e-04
Validation rmse = 0.134026
Epoch 42
Loss = 6.2157e-02, PNorm = 45.0236, GNorm = 0.7243, lr_0 = 1.8561e-04
Loss = 7.7638e-02, PNorm = 45.0329, GNorm = 1.2225, lr_0 = 1.8177e-04
Validation rmse = 0.141001
Epoch 43
Loss = 6.7520e-02, PNorm = 45.0417, GNorm = 0.7928, lr_0 = 1.7764e-04
Loss = 6.6387e-02, PNorm = 45.0502, GNorm = 1.2099, lr_0 = 1.7397e-04
Validation rmse = 0.145017
Epoch 44
Loss = 5.5227e-02, PNorm = 45.0580, GNorm = 0.8582, lr_0 = 1.7037e-04
Loss = 7.4101e-02, PNorm = 45.0663, GNorm = 0.8625, lr_0 = 1.6685e-04
Validation rmse = 0.157898
Epoch 45
Loss = 6.0438e-02, PNorm = 45.0744, GNorm = 1.3932, lr_0 = 1.6306e-04
Loss = 7.5390e-02, PNorm = 45.0823, GNorm = 1.2519, lr_0 = 1.5969e-04
Validation rmse = 0.162645
Epoch 46
Loss = 5.7263e-02, PNorm = 45.0898, GNorm = 0.8426, lr_0 = 1.5638e-04
Loss = 7.6024e-02, PNorm = 45.0968, GNorm = 1.5519, lr_0 = 1.5315e-04
Validation rmse = 0.144843
Epoch 47
Loss = 6.1053e-02, PNorm = 45.1043, GNorm = 0.7609, lr_0 = 1.4967e-04
Loss = 6.7995e-02, PNorm = 45.1116, GNorm = 1.2029, lr_0 = 1.4658e-04
Validation rmse = 0.147866
Epoch 48
Loss = 5.6434e-02, PNorm = 45.1181, GNorm = 0.8450, lr_0 = 1.4354e-04
Loss = 6.1853e-02, PNorm = 45.1244, GNorm = 0.6505, lr_0 = 1.4058e-04
Validation rmse = 0.143875
Epoch 49
Loss = 5.9009e-02, PNorm = 45.1316, GNorm = 1.0931, lr_0 = 1.3738e-04
Loss = 6.7426e-02, PNorm = 45.1375, GNorm = 0.6521, lr_0 = 1.3454e-04
Validation rmse = 0.137646
Epoch 50
Loss = 6.0035e-02, PNorm = 45.1436, GNorm = 0.8937, lr_0 = 1.3176e-04
Loss = 6.3819e-02, PNorm = 45.1498, GNorm = 0.7522, lr_0 = 1.2904e-04
Validation rmse = 0.162772
Epoch 51
Loss = 5.9409e-02, PNorm = 45.1568, GNorm = 1.3534, lr_0 = 1.2610e-04
Loss = 6.0538e-02, PNorm = 45.1619, GNorm = 1.7256, lr_0 = 1.2350e-04
Validation rmse = 0.149144
Epoch 52
Loss = 4.8637e-02, PNorm = 45.1677, GNorm = 1.1959, lr_0 = 1.2069e-04
Loss = 6.7250e-02, PNorm = 45.1724, GNorm = 0.7574, lr_0 = 1.1819e-04
Validation rmse = 0.136022
Epoch 53
Loss = 5.8325e-02, PNorm = 45.1782, GNorm = 1.4146, lr_0 = 1.1575e-04
Loss = 5.7904e-02, PNorm = 45.1836, GNorm = 1.2485, lr_0 = 1.1336e-04
Loss = 1.2547e-01, PNorm = 45.1842, GNorm = 2.0992, lr_0 = 1.1312e-04
Validation rmse = 0.158355
Epoch 54
Loss = 6.3889e-02, PNorm = 45.1903, GNorm = 1.2592, lr_0 = 1.1078e-04
Loss = 5.1389e-02, PNorm = 45.1949, GNorm = 1.0463, lr_0 = 1.0849e-04
Validation rmse = 0.144168
Epoch 55
Loss = 5.4355e-02, PNorm = 45.1992, GNorm = 0.5835, lr_0 = 1.0625e-04
Validation rmse = 0.152340
Epoch 56
Loss = 7.8325e-02, PNorm = 45.2048, GNorm = 0.8010, lr_0 = 1.0383e-04
Loss = 5.4561e-02, PNorm = 45.2099, GNorm = 0.6634, lr_0 = 1.0169e-04
Validation rmse = 0.155741
Epoch 57
Loss = 5.2015e-02, PNorm = 45.2147, GNorm = 0.6770, lr_0 = 1.0000e-04
Loss = 5.1221e-02, PNorm = 45.2199, GNorm = 0.7121, lr_0 = 1.0000e-04
Validation rmse = 0.162839
Epoch 58
Loss = 4.3900e-02, PNorm = 45.2246, GNorm = 0.5244, lr_0 = 1.0000e-04
Loss = 5.5371e-02, PNorm = 45.2277, GNorm = 1.3013, lr_0 = 1.0000e-04
Validation rmse = 0.157015
Epoch 59
Loss = 5.0223e-02, PNorm = 45.2330, GNorm = 0.7105, lr_0 = 1.0000e-04
Loss = 5.9783e-02, PNorm = 45.2396, GNorm = 1.2660, lr_0 = 1.0000e-04
Validation rmse = 0.146459
Model 0 best validation rmse = 0.120937 on epoch 17
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.751905
Ensemble test rmse = 0.751905
1-fold cross validation
	Seed 0 ==> test rmse = 0.751905
Overall test rmse = 0.751905 +/- 0.000000
Elapsed time = 0:00:42
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/Acet_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/Acet_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/Acet_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 936 | train size = 926 | val size = 10 | test size = 96
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 8.9511e-01, PNorm = 43.2630, GNorm = 5.5573, lr_0 = 3.7500e-04
Validation rmse = 0.199644
Epoch 1
Loss = 7.3015e-01, PNorm = 43.2846, GNorm = 1.6166, lr_0 = 6.5000e-04
Loss = 6.9942e-01, PNorm = 43.3358, GNorm = 2.3006, lr_0 = 9.0000e-04
Validation rmse = 0.349273
Epoch 2
Loss = 8.0658e-01, PNorm = 43.4139, GNorm = 11.2278, lr_0 = 9.8685e-04
Loss = 4.2698e-01, PNorm = 43.4863, GNorm = 0.8226, lr_0 = 9.6533e-04
Validation rmse = 0.150685
Epoch 3
Loss = 5.2044e-01, PNorm = 43.5565, GNorm = 6.5864, lr_0 = 9.4219e-04
Loss = 3.6397e-01, PNorm = 43.6219, GNorm = 4.3214, lr_0 = 9.2164e-04
Validation rmse = 0.160002
Epoch 4
Loss = 2.7632e-01, PNorm = 43.6780, GNorm = 4.1775, lr_0 = 9.0153e-04
Loss = 2.0603e-01, PNorm = 43.7302, GNorm = 0.7941, lr_0 = 8.8187e-04
Validation rmse = 0.069831
Epoch 5
Loss = 1.8716e-01, PNorm = 43.7809, GNorm = 4.9856, lr_0 = 8.6073e-04
Loss = 2.2350e-01, PNorm = 43.8235, GNorm = 2.2216, lr_0 = 8.4195e-04
Validation rmse = 0.057308
Epoch 6
Loss = 1.8676e-01, PNorm = 43.8559, GNorm = 1.5858, lr_0 = 8.2359e-04
Validation rmse = 0.052384
Epoch 7
Loss = 1.5338e-01, PNorm = 43.9011, GNorm = 3.0441, lr_0 = 8.0385e-04
Loss = 1.7324e-01, PNorm = 43.9412, GNorm = 1.5452, lr_0 = 7.8631e-04
Validation rmse = 0.053327
Epoch 8
Loss = 1.8525e-01, PNorm = 43.9683, GNorm = 1.5347, lr_0 = 7.6916e-04
Loss = 1.4662e-01, PNorm = 43.9946, GNorm = 0.7078, lr_0 = 7.5238e-04
Validation rmse = 0.135000
Epoch 9
Loss = 1.3038e-01, PNorm = 44.0265, GNorm = 1.0501, lr_0 = 7.3435e-04
Loss = 1.3957e-01, PNorm = 44.0478, GNorm = 2.3125, lr_0 = 7.1833e-04
Validation rmse = 0.073772
Epoch 10
Loss = 1.1696e-01, PNorm = 44.0709, GNorm = 1.0707, lr_0 = 7.0266e-04
Loss = 1.4353e-01, PNorm = 44.0958, GNorm = 1.0803, lr_0 = 6.8733e-04
Validation rmse = 0.152407
Epoch 11
Loss = 1.3106e-01, PNorm = 44.1238, GNorm = 2.7921, lr_0 = 6.7085e-04
Loss = 1.2858e-01, PNorm = 44.1453, GNorm = 3.1374, lr_0 = 6.5622e-04
Validation rmse = 0.110420
Epoch 12
Loss = 1.3069e-01, PNorm = 44.1779, GNorm = 2.4742, lr_0 = 6.4191e-04
Loss = 1.2426e-01, PNorm = 44.1975, GNorm = 2.0630, lr_0 = 6.2790e-04
Loss = 1.2658e-01, PNorm = 44.1996, GNorm = 1.2021, lr_0 = 6.2652e-04
Validation rmse = 0.092659
Epoch 13
Loss = 1.0045e-01, PNorm = 44.2220, GNorm = 0.7424, lr_0 = 6.1285e-04
Validation rmse = 0.119045
Epoch 14
Loss = 9.0132e-02, PNorm = 44.2417, GNorm = 2.2614, lr_0 = 5.9948e-04
Loss = 1.0794e-01, PNorm = 44.2613, GNorm = 1.8912, lr_0 = 5.8641e-04
Validation rmse = 0.065840
Epoch 15
Loss = 1.1425e-01, PNorm = 44.2789, GNorm = 1.4694, lr_0 = 5.7235e-04
Loss = 1.1010e-01, PNorm = 44.2960, GNorm = 1.7766, lr_0 = 5.5987e-04
Validation rmse = 0.104192
Epoch 16
Loss = 9.8929e-02, PNorm = 44.3119, GNorm = 0.7633, lr_0 = 5.4765e-04
Loss = 1.0606e-01, PNorm = 44.3278, GNorm = 3.6031, lr_0 = 5.3571e-04
Validation rmse = 0.086344
Epoch 17
Loss = 9.3761e-02, PNorm = 44.3487, GNorm = 0.4640, lr_0 = 5.2287e-04
Loss = 1.0066e-01, PNorm = 44.3645, GNorm = 0.6199, lr_0 = 5.1146e-04
Validation rmse = 0.118424
Epoch 18
Loss = 1.0576e-01, PNorm = 44.3797, GNorm = 1.8257, lr_0 = 5.0030e-04
Loss = 8.2395e-02, PNorm = 44.3927, GNorm = 0.3795, lr_0 = 4.8939e-04
Validation rmse = 0.109493
Epoch 19
Loss = 1.0516e-01, PNorm = 44.4109, GNorm = 2.7488, lr_0 = 4.7766e-04
Loss = 9.5656e-02, PNorm = 44.4251, GNorm = 1.5051, lr_0 = 4.6724e-04
Validation rmse = 0.105891
Epoch 20
Loss = 8.3247e-02, PNorm = 44.4398, GNorm = 0.5248, lr_0 = 4.5705e-04
Validation rmse = 0.092527
Epoch 21
Loss = 5.8204e-02, PNorm = 44.4564, GNorm = 0.7925, lr_0 = 4.4609e-04
Loss = 8.9902e-02, PNorm = 44.4685, GNorm = 0.8625, lr_0 = 4.3636e-04
Validation rmse = 0.113560
Epoch 22
Loss = 8.6947e-02, PNorm = 44.4806, GNorm = 2.2512, lr_0 = 4.2684e-04
Loss = 8.2189e-02, PNorm = 44.4953, GNorm = 0.6371, lr_0 = 4.1753e-04
Validation rmse = 0.082616
Epoch 23
Loss = 9.6666e-02, PNorm = 44.5130, GNorm = 1.6199, lr_0 = 4.0752e-04
Loss = 9.3365e-02, PNorm = 44.5278, GNorm = 2.0477, lr_0 = 3.9863e-04
Validation rmse = 0.106482
Epoch 24
Loss = 8.2707e-02, PNorm = 44.5408, GNorm = 1.9270, lr_0 = 3.8994e-04
Loss = 8.7175e-02, PNorm = 44.5533, GNorm = 0.6993, lr_0 = 3.8143e-04
Validation rmse = 0.101496
Epoch 25
Loss = 7.9548e-02, PNorm = 44.5671, GNorm = 2.8782, lr_0 = 3.7311e-04
Loss = 7.2600e-02, PNorm = 44.5800, GNorm = 0.7106, lr_0 = 3.6497e-04
Validation rmse = 0.094301
Epoch 26
Loss = 7.1592e-02, PNorm = 44.5934, GNorm = 1.0363, lr_0 = 3.5622e-04
Loss = 8.3866e-02, PNorm = 44.6046, GNorm = 1.6916, lr_0 = 3.4845e-04
Validation rmse = 0.125239
Epoch 27
Loss = 9.0760e-02, PNorm = 44.6188, GNorm = 2.5032, lr_0 = 3.4085e-04
Validation rmse = 0.091309
Epoch 28
Loss = 8.5967e-02, PNorm = 44.6294, GNorm = 0.6314, lr_0 = 3.3268e-04
Loss = 7.4683e-02, PNorm = 44.6421, GNorm = 1.0484, lr_0 = 3.2543e-04
Validation rmse = 0.117177
Epoch 29
Loss = 6.7024e-02, PNorm = 44.6519, GNorm = 0.6934, lr_0 = 3.1833e-04
Loss = 7.5093e-02, PNorm = 44.6619, GNorm = 1.0621, lr_0 = 3.1138e-04
Validation rmse = 0.106378
Epoch 30
Loss = 7.4814e-02, PNorm = 44.6735, GNorm = 2.4630, lr_0 = 3.0392e-04
Loss = 6.5012e-02, PNorm = 44.6842, GNorm = 1.1649, lr_0 = 2.9729e-04
Validation rmse = 0.116042
Epoch 31
Loss = 7.7613e-02, PNorm = 44.6937, GNorm = 1.5844, lr_0 = 2.9080e-04
Loss = 7.5456e-02, PNorm = 44.7053, GNorm = 2.0368, lr_0 = 2.8446e-04
Validation rmse = 0.119098
Epoch 32
Loss = 8.7907e-02, PNorm = 44.7173, GNorm = 2.1395, lr_0 = 2.7764e-04
Loss = 7.6429e-02, PNorm = 44.7284, GNorm = 0.6256, lr_0 = 2.7159e-04
Validation rmse = 0.103565
Epoch 33
Loss = 6.6919e-02, PNorm = 44.7390, GNorm = 0.6980, lr_0 = 2.6566e-04
Validation rmse = 0.105265
Epoch 34
Loss = 8.8720e-02, PNorm = 44.7485, GNorm = 1.4840, lr_0 = 2.5929e-04
Loss = 6.9342e-02, PNorm = 44.7585, GNorm = 2.4700, lr_0 = 2.5364e-04
Validation rmse = 0.088885
Epoch 35
Loss = 5.4994e-02, PNorm = 44.7667, GNorm = 0.5200, lr_0 = 2.4811e-04
Loss = 6.7134e-02, PNorm = 44.7762, GNorm = 1.1821, lr_0 = 2.4269e-04
Validation rmse = 0.093876
Epoch 36
Loss = 5.8350e-02, PNorm = 44.7845, GNorm = 0.9612, lr_0 = 2.3688e-04
Loss = 6.2801e-02, PNorm = 44.7918, GNorm = 0.9349, lr_0 = 2.3171e-04
Validation rmse = 0.095485
Epoch 37
Loss = 7.2514e-02, PNorm = 44.7989, GNorm = 0.8401, lr_0 = 2.2665e-04
Loss = 5.4310e-02, PNorm = 44.8066, GNorm = 0.5529, lr_0 = 2.2171e-04
Validation rmse = 0.098387
Epoch 38
Loss = 5.2756e-02, PNorm = 44.8138, GNorm = 1.3108, lr_0 = 2.1640e-04
Loss = 6.9302e-02, PNorm = 44.8229, GNorm = 2.3745, lr_0 = 2.1168e-04
Validation rmse = 0.089802
Epoch 39
Loss = 5.1094e-02, PNorm = 44.8283, GNorm = 1.0978, lr_0 = 2.0706e-04
Loss = 6.1525e-02, PNorm = 44.8353, GNorm = 0.6826, lr_0 = 2.0254e-04
Loss = 7.8925e-02, PNorm = 44.8362, GNorm = 1.8663, lr_0 = 2.0209e-04
Validation rmse = 0.092091
Epoch 40
Loss = 4.9769e-02, PNorm = 44.8423, GNorm = 0.6015, lr_0 = 1.9769e-04
Validation rmse = 0.095148
Epoch 41
Loss = 5.9420e-02, PNorm = 44.8499, GNorm = 1.4437, lr_0 = 1.9337e-04
Loss = 5.5423e-02, PNorm = 44.8566, GNorm = 0.8794, lr_0 = 1.8916e-04
Validation rmse = 0.089833
Epoch 42
Loss = 4.8774e-02, PNorm = 44.8634, GNorm = 1.9400, lr_0 = 1.8462e-04
Loss = 5.6351e-02, PNorm = 44.8696, GNorm = 1.2761, lr_0 = 1.8059e-04
Validation rmse = 0.099810
Epoch 43
Loss = 4.2778e-02, PNorm = 44.8763, GNorm = 0.8655, lr_0 = 1.7666e-04
Loss = 5.6410e-02, PNorm = 44.8817, GNorm = 0.7577, lr_0 = 1.7280e-04
Validation rmse = 0.090887
Epoch 44
Loss = 6.1425e-02, PNorm = 44.8878, GNorm = 2.3653, lr_0 = 1.6866e-04
Loss = 5.7344e-02, PNorm = 44.8936, GNorm = 1.7312, lr_0 = 1.6498e-04
Validation rmse = 0.095035
Epoch 45
Loss = 5.4319e-02, PNorm = 44.8999, GNorm = 1.3702, lr_0 = 1.6138e-04
Loss = 5.5610e-02, PNorm = 44.9056, GNorm = 1.0967, lr_0 = 1.5786e-04
Validation rmse = 0.096724
Epoch 46
Loss = 5.0049e-02, PNorm = 44.9124, GNorm = 1.0977, lr_0 = 1.5408e-04
Loss = 5.0726e-02, PNorm = 44.9168, GNorm = 1.1082, lr_0 = 1.5072e-04
Validation rmse = 0.103449
Epoch 47
Loss = 5.0187e-02, PNorm = 44.9219, GNorm = 1.0962, lr_0 = 1.4743e-04
Validation rmse = 0.097732
Epoch 48
Loss = 3.1923e-02, PNorm = 44.9267, GNorm = 0.8579, lr_0 = 1.4390e-04
Loss = 5.5304e-02, PNorm = 44.9332, GNorm = 0.6817, lr_0 = 1.4076e-04
Validation rmse = 0.097323
Epoch 49
Loss = 5.7471e-02, PNorm = 44.9369, GNorm = 0.6441, lr_0 = 1.3769e-04
Loss = 5.0582e-02, PNorm = 44.9403, GNorm = 1.0661, lr_0 = 1.3468e-04
Validation rmse = 0.090112
Epoch 50
Loss = 5.4176e-02, PNorm = 44.9450, GNorm = 1.2515, lr_0 = 1.3174e-04
Loss = 5.3860e-02, PNorm = 44.9497, GNorm = 1.0065, lr_0 = 1.2887e-04
Validation rmse = 0.107125
Epoch 51
Loss = 5.4236e-02, PNorm = 44.9544, GNorm = 2.4293, lr_0 = 1.2578e-04
Loss = 4.8426e-02, PNorm = 44.9580, GNorm = 0.9951, lr_0 = 1.2304e-04
Validation rmse = 0.096840
Epoch 52
Loss = 4.4107e-02, PNorm = 44.9631, GNorm = 0.8310, lr_0 = 1.2035e-04
Loss = 4.7687e-02, PNorm = 44.9677, GNorm = 1.0172, lr_0 = 1.1773e-04
Validation rmse = 0.100934
Epoch 53
Loss = 4.0257e-02, PNorm = 44.9711, GNorm = 0.6092, lr_0 = 1.1491e-04
Loss = 4.9764e-02, PNorm = 44.9747, GNorm = 0.9123, lr_0 = 1.1240e-04
Validation rmse = 0.094724
Epoch 54
Loss = 4.2063e-02, PNorm = 44.9780, GNorm = 0.6074, lr_0 = 1.0995e-04
Validation rmse = 0.097889
Epoch 55
Loss = 4.2691e-02, PNorm = 44.9818, GNorm = 0.7037, lr_0 = 1.0731e-04
Loss = 4.5769e-02, PNorm = 44.9855, GNorm = 0.4772, lr_0 = 1.0497e-04
Validation rmse = 0.094012
Epoch 56
Loss = 4.7840e-02, PNorm = 44.9890, GNorm = 0.8292, lr_0 = 1.0268e-04
Loss = 4.2789e-02, PNorm = 44.9920, GNorm = 0.9790, lr_0 = 1.0044e-04
Validation rmse = 0.093717
Epoch 57
Loss = 4.6453e-02, PNorm = 44.9949, GNorm = 0.6470, lr_0 = 1.0000e-04
Loss = 4.2476e-02, PNorm = 44.9985, GNorm = 1.2851, lr_0 = 1.0000e-04
Validation rmse = 0.110297
Epoch 58
Loss = 4.3166e-02, PNorm = 45.0022, GNorm = 1.1791, lr_0 = 1.0000e-04
Loss = 5.7333e-02, PNorm = 45.0054, GNorm = 0.8874, lr_0 = 1.0000e-04
Validation rmse = 0.091075
Epoch 59
Loss = 5.3471e-02, PNorm = 45.0084, GNorm = 2.2897, lr_0 = 1.0000e-04
Loss = 4.4985e-02, PNorm = 45.0124, GNorm = 0.9905, lr_0 = 1.0000e-04
Validation rmse = 0.098202
Model 0 best validation rmse = 0.052384 on epoch 6
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.261058
Ensemble test rmse = 0.261058
1-fold cross validation
	Seed 0 ==> test rmse = 0.261058
Overall test rmse = 0.261058 +/- 0.000000
Elapsed time = 0:00:40
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/MeCN_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/MeCN_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/MeCN_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 916 | train size = 906 | val size = 10 | test size = 116
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.1066e-01, PNorm = 43.2648, GNorm = 2.0844, lr_0 = 3.7500e-04
Validation rmse = 0.353156
Epoch 1
Loss = 8.9916e-01, PNorm = 43.2928, GNorm = 9.2525, lr_0 = 6.5000e-04
Loss = 5.9269e-01, PNorm = 43.3377, GNorm = 7.3462, lr_0 = 9.0000e-04
Validation rmse = 0.233684
Epoch 2
Loss = 5.1726e-01, PNorm = 43.4122, GNorm = 2.2691, lr_0 = 9.8468e-04
Loss = 3.9248e-01, PNorm = 43.4932, GNorm = 10.8177, lr_0 = 9.6320e-04
Validation rmse = 0.290787
Epoch 3
Loss = 3.8181e-01, PNorm = 43.5765, GNorm = 1.3302, lr_0 = 9.4011e-04
Loss = 3.7524e-01, PNorm = 43.6484, GNorm = 2.5122, lr_0 = 9.1961e-04
Validation rmse = 0.241476
Epoch 4
Loss = 3.2330e-01, PNorm = 43.7141, GNorm = 0.4965, lr_0 = 8.9756e-04
Loss = 3.2667e-01, PNorm = 43.7685, GNorm = 6.5923, lr_0 = 8.7798e-04
Loss = 3.3464e-01, PNorm = 43.7754, GNorm = 5.7109, lr_0 = 8.7605e-04
Validation rmse = 0.202792
Epoch 5
Loss = 2.3384e-01, PNorm = 43.8293, GNorm = 2.2712, lr_0 = 8.5694e-04
Validation rmse = 0.132110
Epoch 6
Loss = 1.8450e-01, PNorm = 43.8766, GNorm = 1.3392, lr_0 = 8.3640e-04
Loss = 2.0030e-01, PNorm = 43.9210, GNorm = 5.5669, lr_0 = 8.1815e-04
Validation rmse = 0.148075
Epoch 7
Loss = 1.6917e-01, PNorm = 43.9566, GNorm = 4.4457, lr_0 = 7.9854e-04
Loss = 1.8206e-01, PNorm = 43.9879, GNorm = 1.0202, lr_0 = 7.8112e-04
Validation rmse = 0.139039
Epoch 8
Loss = 1.6952e-01, PNorm = 44.0195, GNorm = 1.6454, lr_0 = 7.6240e-04
Loss = 1.3492e-01, PNorm = 44.0431, GNorm = 2.3217, lr_0 = 7.4577e-04
Validation rmse = 0.184313
Epoch 9
Loss = 1.3988e-01, PNorm = 44.0729, GNorm = 0.8017, lr_0 = 7.2950e-04
Loss = 1.4864e-01, PNorm = 44.0938, GNorm = 3.9126, lr_0 = 7.1359e-04
Validation rmse = 0.199952
Epoch 10
Loss = 1.3391e-01, PNorm = 44.1198, GNorm = 3.9684, lr_0 = 6.9649e-04
Validation rmse = 0.155887
Epoch 11
Loss = 1.1341e-01, PNorm = 44.1395, GNorm = 2.0183, lr_0 = 6.7979e-04
Loss = 1.3154e-01, PNorm = 44.1603, GNorm = 1.2542, lr_0 = 6.6496e-04
Validation rmse = 0.153080
Epoch 12
Loss = 1.7912e-01, PNorm = 44.1813, GNorm = 2.4919, lr_0 = 6.4902e-04
Loss = 1.1157e-01, PNorm = 44.2035, GNorm = 2.1455, lr_0 = 6.3487e-04
Validation rmse = 0.183928
Epoch 13
Loss = 1.2342e-01, PNorm = 44.2189, GNorm = 2.8251, lr_0 = 6.1965e-04
Loss = 1.4266e-01, PNorm = 44.2387, GNorm = 3.1562, lr_0 = 6.0613e-04
Validation rmse = 0.176506
Epoch 14
Loss = 1.5608e-01, PNorm = 44.2582, GNorm = 6.6604, lr_0 = 5.9160e-04
Loss = 1.3039e-01, PNorm = 44.2823, GNorm = 0.9667, lr_0 = 5.7870e-04
Validation rmse = 0.165596
Epoch 15
Loss = 1.1419e-01, PNorm = 44.3054, GNorm = 1.3770, lr_0 = 5.6483e-04
Validation rmse = 0.143284
Epoch 16
Loss = 1.4349e-01, PNorm = 44.3230, GNorm = 2.3796, lr_0 = 5.5129e-04
Loss = 9.9225e-02, PNorm = 44.3374, GNorm = 2.1570, lr_0 = 5.3926e-04
Validation rmse = 0.172516
Epoch 17
Loss = 8.7755e-02, PNorm = 44.3528, GNorm = 1.4950, lr_0 = 5.2750e-04
Loss = 1.1455e-01, PNorm = 44.3658, GNorm = 2.0671, lr_0 = 5.1599e-04
Validation rmse = 0.152609
Epoch 18
Loss = 1.2243e-01, PNorm = 44.3858, GNorm = 0.9064, lr_0 = 5.0362e-04
Loss = 9.4957e-02, PNorm = 44.4032, GNorm = 0.7093, lr_0 = 4.9264e-04
Validation rmse = 0.153375
Epoch 19
Loss = 1.0595e-01, PNorm = 44.4175, GNorm = 0.8117, lr_0 = 4.8083e-04
Loss = 1.0398e-01, PNorm = 44.4300, GNorm = 1.5661, lr_0 = 4.7034e-04
Validation rmse = 0.152001
Epoch 20
Loss = 1.0994e-01, PNorm = 44.4431, GNorm = 2.3532, lr_0 = 4.5907e-04
Loss = 1.1327e-01, PNorm = 44.4580, GNorm = 0.9707, lr_0 = 4.4905e-04
Loss = 6.8794e-02, PNorm = 44.4599, GNorm = 1.5344, lr_0 = 4.4806e-04
Validation rmse = 0.148297
Epoch 21
Loss = 9.3640e-02, PNorm = 44.4752, GNorm = 1.0787, lr_0 = 4.3829e-04
Validation rmse = 0.153613
Epoch 22
Loss = 1.1273e-01, PNorm = 44.4895, GNorm = 1.3388, lr_0 = 4.2779e-04
Loss = 1.0897e-01, PNorm = 44.5031, GNorm = 1.9836, lr_0 = 4.1845e-04
Validation rmse = 0.150638
Epoch 23
Loss = 1.1118e-01, PNorm = 44.5178, GNorm = 0.5102, lr_0 = 4.0842e-04
Loss = 1.1051e-01, PNorm = 44.5321, GNorm = 0.5637, lr_0 = 3.9951e-04
Validation rmse = 0.174586
Epoch 24
Loss = 1.6091e-01, PNorm = 44.5484, GNorm = 2.7164, lr_0 = 3.8994e-04
Loss = 1.0846e-01, PNorm = 44.5657, GNorm = 1.6511, lr_0 = 3.8143e-04
Validation rmse = 0.163872
Epoch 25
Loss = 9.6856e-02, PNorm = 44.5783, GNorm = 2.2575, lr_0 = 3.7311e-04
Loss = 1.0454e-01, PNorm = 44.5902, GNorm = 1.9515, lr_0 = 3.6497e-04
Validation rmse = 0.145378
Epoch 26
Loss = 7.7935e-02, PNorm = 44.6039, GNorm = 0.4611, lr_0 = 3.5622e-04
Validation rmse = 0.136803
Epoch 27
Loss = 1.0023e-01, PNorm = 44.6143, GNorm = 1.2007, lr_0 = 3.4769e-04
Loss = 8.5849e-02, PNorm = 44.6227, GNorm = 1.2531, lr_0 = 3.4010e-04
Validation rmse = 0.163717
Epoch 28
Loss = 1.0262e-01, PNorm = 44.6340, GNorm = 2.3820, lr_0 = 3.3195e-04
Loss = 1.1559e-01, PNorm = 44.6445, GNorm = 2.9437, lr_0 = 3.2471e-04
Validation rmse = 0.143104
Epoch 29
Loss = 1.1487e-01, PNorm = 44.6584, GNorm = 0.9515, lr_0 = 3.1693e-04
Loss = 9.8885e-02, PNorm = 44.6705, GNorm = 1.3347, lr_0 = 3.1001e-04
Validation rmse = 0.134139
Epoch 30
Loss = 1.0800e-01, PNorm = 44.6832, GNorm = 1.8801, lr_0 = 3.0258e-04
Loss = 9.0352e-02, PNorm = 44.6935, GNorm = 0.4617, lr_0 = 2.9598e-04
Validation rmse = 0.138956
Epoch 31
Loss = 9.0073e-02, PNorm = 44.7104, GNorm = 0.5525, lr_0 = 2.8889e-04
Validation rmse = 0.129979
Epoch 32
Loss = 7.0311e-02, PNorm = 44.7201, GNorm = 1.4677, lr_0 = 2.8196e-04
Loss = 7.4066e-02, PNorm = 44.7273, GNorm = 0.5978, lr_0 = 2.7581e-04
Validation rmse = 0.145593
Epoch 33
Loss = 7.8882e-02, PNorm = 44.7354, GNorm = 0.6012, lr_0 = 2.6920e-04
Loss = 8.0302e-02, PNorm = 44.7435, GNorm = 1.7448, lr_0 = 2.6333e-04
Validation rmse = 0.130324
Epoch 34
Loss = 6.5656e-02, PNorm = 44.7499, GNorm = 0.8917, lr_0 = 2.5758e-04
Loss = 8.1427e-02, PNorm = 44.7587, GNorm = 0.9823, lr_0 = 2.5197e-04
Validation rmse = 0.141262
Epoch 35
Loss = 6.8930e-02, PNorm = 44.7665, GNorm = 1.8848, lr_0 = 2.4593e-04
Loss = 7.1303e-02, PNorm = 44.7741, GNorm = 0.8717, lr_0 = 2.4056e-04
Validation rmse = 0.132474
Epoch 36
Loss = 6.5792e-02, PNorm = 44.7813, GNorm = 0.9602, lr_0 = 2.3480e-04
Loss = 7.7254e-02, PNorm = 44.7878, GNorm = 0.6121, lr_0 = 2.2967e-04
Loss = 2.5203e-02, PNorm = 44.7885, GNorm = 1.3618, lr_0 = 2.2917e-04
Validation rmse = 0.134046
Epoch 37
Loss = 7.0746e-02, PNorm = 44.7961, GNorm = 0.7578, lr_0 = 2.2417e-04
Validation rmse = 0.146073
Epoch 38
Loss = 4.4493e-02, PNorm = 44.8053, GNorm = 0.6580, lr_0 = 2.1880e-04
Loss = 7.5364e-02, PNorm = 44.8122, GNorm = 1.4958, lr_0 = 2.1402e-04
Validation rmse = 0.137837
Epoch 39
Loss = 6.7446e-02, PNorm = 44.8204, GNorm = 1.3580, lr_0 = 2.0889e-04
Loss = 6.8380e-02, PNorm = 44.8288, GNorm = 1.7436, lr_0 = 2.0434e-04
Validation rmse = 0.126225
Epoch 40
Loss = 6.8781e-02, PNorm = 44.8350, GNorm = 0.5782, lr_0 = 1.9944e-04
Loss = 7.3559e-02, PNorm = 44.8415, GNorm = 0.7331, lr_0 = 1.9509e-04
Validation rmse = 0.139440
Epoch 41
Loss = 7.5155e-02, PNorm = 44.8475, GNorm = 0.6533, lr_0 = 1.9041e-04
Loss = 6.1345e-02, PNorm = 44.8543, GNorm = 0.5981, lr_0 = 1.8626e-04
Validation rmse = 0.140115
Epoch 42
Loss = 6.7441e-02, PNorm = 44.8595, GNorm = 0.7034, lr_0 = 1.8219e-04
Validation rmse = 0.161553
Epoch 43
Loss = 5.3646e-02, PNorm = 44.8667, GNorm = 1.3276, lr_0 = 1.7783e-04
Loss = 6.8800e-02, PNorm = 44.8709, GNorm = 1.0326, lr_0 = 1.7395e-04
Validation rmse = 0.137551
Epoch 44
Loss = 5.7544e-02, PNorm = 44.8784, GNorm = 0.5258, lr_0 = 1.6978e-04
Loss = 6.8252e-02, PNorm = 44.8839, GNorm = 1.6003, lr_0 = 1.6608e-04
Validation rmse = 0.142885
Epoch 45
Loss = 6.2271e-02, PNorm = 44.8895, GNorm = 0.5108, lr_0 = 1.6210e-04
Loss = 6.2566e-02, PNorm = 44.8939, GNorm = 0.6984, lr_0 = 1.5856e-04
Validation rmse = 0.139110
Epoch 46
Loss = 6.6026e-02, PNorm = 44.9013, GNorm = 0.5110, lr_0 = 1.5476e-04
Loss = 5.6027e-02, PNorm = 44.9060, GNorm = 0.4591, lr_0 = 1.5138e-04
Validation rmse = 0.137089
Epoch 47
Loss = 5.7264e-02, PNorm = 44.9115, GNorm = 1.0564, lr_0 = 1.4775e-04
Validation rmse = 0.137338
Epoch 48
Loss = 7.5445e-02, PNorm = 44.9178, GNorm = 0.9365, lr_0 = 1.4421e-04
Loss = 6.3378e-02, PNorm = 44.9228, GNorm = 1.4193, lr_0 = 1.4107e-04
Validation rmse = 0.135112
Epoch 49
Loss = 5.9789e-02, PNorm = 44.9274, GNorm = 1.3038, lr_0 = 1.3769e-04
Loss = 5.5842e-02, PNorm = 44.9342, GNorm = 1.1207, lr_0 = 1.3468e-04
Validation rmse = 0.140112
Epoch 50
Loss = 6.7386e-02, PNorm = 44.9382, GNorm = 1.0767, lr_0 = 1.3174e-04
Loss = 5.4990e-02, PNorm = 44.9420, GNorm = 0.9369, lr_0 = 1.2887e-04
Validation rmse = 0.148890
Epoch 51
Loss = 6.1013e-02, PNorm = 44.9472, GNorm = 0.6561, lr_0 = 1.2578e-04
Loss = 5.7384e-02, PNorm = 44.9524, GNorm = 0.7812, lr_0 = 1.2304e-04
Validation rmse = 0.134728
Epoch 52
Loss = 5.5089e-02, PNorm = 44.9578, GNorm = 1.2124, lr_0 = 1.2009e-04
Loss = 5.8685e-02, PNorm = 44.9623, GNorm = 0.7804, lr_0 = 1.1747e-04
Loss = 2.5119e-01, PNorm = 44.9627, GNorm = 4.6219, lr_0 = 1.1721e-04
Validation rmse = 0.138728
Epoch 53
Loss = 6.0509e-02, PNorm = 44.9693, GNorm = 1.4026, lr_0 = 1.1465e-04
Validation rmse = 0.134207
Epoch 54
Loss = 5.8015e-02, PNorm = 44.9733, GNorm = 0.4566, lr_0 = 1.1191e-04
Loss = 5.4561e-02, PNorm = 44.9782, GNorm = 0.6730, lr_0 = 1.0946e-04
Validation rmse = 0.139505
Epoch 55
Loss = 5.0130e-02, PNorm = 44.9829, GNorm = 0.4523, lr_0 = 1.0684e-04
Loss = 5.7549e-02, PNorm = 44.9865, GNorm = 1.2311, lr_0 = 1.0451e-04
Validation rmse = 0.135350
Epoch 56
Loss = 5.7558e-02, PNorm = 44.9905, GNorm = 0.5331, lr_0 = 1.0200e-04
Loss = 5.1808e-02, PNorm = 44.9945, GNorm = 0.7236, lr_0 = 1.0000e-04
Validation rmse = 0.143466
Epoch 57
Loss = 5.5568e-02, PNorm = 44.9978, GNorm = 1.6162, lr_0 = 1.0000e-04
Loss = 5.4361e-02, PNorm = 45.0016, GNorm = 0.8778, lr_0 = 1.0000e-04
Loss = 5.5874e-03, PNorm = 45.0021, GNorm = 0.4951, lr_0 = 1.0000e-04
Validation rmse = 0.134934
Epoch 58
Loss = 5.3461e-02, PNorm = 45.0062, GNorm = 0.6890, lr_0 = 1.0000e-04
Validation rmse = 0.132482
Epoch 59
Loss = 4.9109e-02, PNorm = 45.0090, GNorm = 0.6199, lr_0 = 1.0000e-04
Loss = 5.8209e-02, PNorm = 45.0131, GNorm = 1.3351, lr_0 = 1.0000e-04
Validation rmse = 0.136200
Model 0 best validation rmse = 0.126225 on epoch 39
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.154540
Ensemble test rmse = 0.154540
1-fold cross validation
	Seed 0 ==> test rmse = 0.154540
Overall test rmse = 0.154540 +/- 0.000000
Elapsed time = 0:00:38
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/MTBE_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/MTBE_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/MTBE_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 981 | train size = 971 | val size = 10 | test size = 51
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.3400e-01, PNorm = 43.2653, GNorm = 3.8370, lr_0 = 3.6053e-04
Validation rmse = 0.236751
Epoch 1
Loss = 4.8839e-01, PNorm = 43.2921, GNorm = 3.5302, lr_0 = 6.2105e-04
Loss = 5.8966e-01, PNorm = 43.3272, GNorm = 8.2424, lr_0 = 8.5789e-04
Validation rmse = 0.180714
Epoch 2
Loss = 5.8761e-01, PNorm = 43.3926, GNorm = 1.6623, lr_0 = 9.8961e-04
Loss = 4.6415e-01, PNorm = 43.4557, GNorm = 4.7523, lr_0 = 9.6914e-04
Validation rmse = 0.250763
Epoch 3
Loss = 4.8436e-01, PNorm = 43.5238, GNorm = 6.4163, lr_0 = 9.4910e-04
Loss = 3.9131e-01, PNorm = 43.5877, GNorm = 2.1108, lr_0 = 9.2948e-04
Validation rmse = 0.173593
Epoch 4
Loss = 3.1123e-01, PNorm = 43.6599, GNorm = 4.0402, lr_0 = 9.0836e-04
Loss = 3.0347e-01, PNorm = 43.7244, GNorm = 5.9228, lr_0 = 8.8958e-04
Validation rmse = 0.194304
Epoch 5
Loss = 3.0164e-01, PNorm = 43.7764, GNorm = 7.8499, lr_0 = 8.7118e-04
Loss = 2.4454e-01, PNorm = 43.8239, GNorm = 4.3689, lr_0 = 8.5317e-04
Validation rmse = 0.174693
Epoch 6
Loss = 1.6956e-01, PNorm = 43.8783, GNorm = 1.5829, lr_0 = 8.3378e-04
Loss = 2.0633e-01, PNorm = 43.9213, GNorm = 3.5030, lr_0 = 8.1654e-04
Validation rmse = 0.109784
Epoch 7
Loss = 1.3900e-01, PNorm = 43.9659, GNorm = 4.3171, lr_0 = 7.9799e-04
Loss = 1.9937e-01, PNorm = 43.9982, GNorm = 1.6800, lr_0 = 7.8149e-04
Validation rmse = 0.133975
Epoch 8
Loss = 1.4450e-01, PNorm = 44.0328, GNorm = 3.1632, lr_0 = 7.6533e-04
Loss = 1.4607e-01, PNorm = 44.0729, GNorm = 0.7027, lr_0 = 7.4950e-04
Validation rmse = 0.175670
Epoch 9
Loss = 1.7112e-01, PNorm = 44.1066, GNorm = 2.3740, lr_0 = 7.3247e-04
Loss = 1.3928e-01, PNorm = 44.1325, GNorm = 2.1417, lr_0 = 7.1733e-04
Validation rmse = 0.188501
Epoch 10
Loss = 1.7283e-01, PNorm = 44.1661, GNorm = 2.7072, lr_0 = 7.0249e-04
Loss = 1.8074e-01, PNorm = 44.1933, GNorm = 3.2387, lr_0 = 6.8797e-04
Validation rmse = 0.116485
Epoch 11
Loss = 1.6482e-01, PNorm = 44.2286, GNorm = 1.6645, lr_0 = 6.7234e-04
Loss = 1.6214e-01, PNorm = 44.2652, GNorm = 6.7007, lr_0 = 6.5843e-04
Validation rmse = 0.101656
Epoch 12
Loss = 1.3674e-01, PNorm = 44.2889, GNorm = 1.7597, lr_0 = 6.4482e-04
Loss = 1.2204e-01, PNorm = 44.3095, GNorm = 2.2974, lr_0 = 6.3148e-04
Validation rmse = 0.118777
Epoch 13
Loss = 1.1314e-01, PNorm = 44.3322, GNorm = 0.9227, lr_0 = 6.1714e-04
Loss = 1.3200e-01, PNorm = 44.3469, GNorm = 1.9681, lr_0 = 6.0438e-04
Validation rmse = 0.099837
Epoch 14
Loss = 1.1223e-01, PNorm = 44.3676, GNorm = 0.6159, lr_0 = 5.9064e-04
Loss = 1.1625e-01, PNorm = 44.3871, GNorm = 1.1385, lr_0 = 5.7843e-04
Validation rmse = 0.114670
Epoch 15
Loss = 1.1841e-01, PNorm = 44.4031, GNorm = 2.1020, lr_0 = 5.6647e-04
Loss = 1.1356e-01, PNorm = 44.4214, GNorm = 2.6193, lr_0 = 5.5476e-04
Loss = 1.2301e-01, PNorm = 44.4222, GNorm = 2.9058, lr_0 = 5.5360e-04
Validation rmse = 0.108441
Epoch 16
Loss = 1.2226e-01, PNorm = 44.4361, GNorm = 1.8664, lr_0 = 5.4215e-04
Loss = 1.1215e-01, PNorm = 44.4505, GNorm = 1.2318, lr_0 = 5.3094e-04
Validation rmse = 0.089218
Epoch 17
Loss = 1.1330e-01, PNorm = 44.4677, GNorm = 1.5758, lr_0 = 5.1996e-04
Validation rmse = 0.096348
Epoch 18
Loss = 7.4988e-02, PNorm = 44.4852, GNorm = 2.5330, lr_0 = 5.0815e-04
Loss = 1.1017e-01, PNorm = 44.4995, GNorm = 1.4645, lr_0 = 4.9764e-04
Validation rmse = 0.081787
Epoch 19
Loss = 1.1408e-01, PNorm = 44.5137, GNorm = 3.2545, lr_0 = 4.8633e-04
Loss = 1.0976e-01, PNorm = 44.5251, GNorm = 4.2378, lr_0 = 4.7628e-04
Validation rmse = 0.133692
Epoch 20
Loss = 1.1540e-01, PNorm = 44.5422, GNorm = 0.9986, lr_0 = 4.6643e-04
Loss = 1.0751e-01, PNorm = 44.5586, GNorm = 3.1366, lr_0 = 4.5678e-04
Validation rmse = 0.094870
Epoch 21
Loss = 9.9525e-02, PNorm = 44.5765, GNorm = 0.9220, lr_0 = 4.4640e-04
Loss = 1.1751e-01, PNorm = 44.5922, GNorm = 2.7102, lr_0 = 4.3717e-04
Validation rmse = 0.096033
Epoch 22
Loss = 7.9987e-02, PNorm = 44.6048, GNorm = 1.7534, lr_0 = 4.2813e-04
Loss = 9.2672e-02, PNorm = 44.6183, GNorm = 1.1636, lr_0 = 4.1928e-04
Validation rmse = 0.082593
Epoch 23
Loss = 9.5284e-02, PNorm = 44.6333, GNorm = 0.5754, lr_0 = 4.0975e-04
Loss = 8.1333e-02, PNorm = 44.6466, GNorm = 2.3419, lr_0 = 4.0128e-04
Validation rmse = 0.088582
Epoch 24
Loss = 9.3001e-02, PNorm = 44.6588, GNorm = 1.1759, lr_0 = 3.9298e-04
Loss = 1.0123e-01, PNorm = 44.6720, GNorm = 1.9856, lr_0 = 3.8486e-04
Validation rmse = 0.089025
Epoch 25
Loss = 8.6197e-02, PNorm = 44.6859, GNorm = 0.6691, lr_0 = 3.7611e-04
Loss = 8.5195e-02, PNorm = 44.6953, GNorm = 1.0131, lr_0 = 3.6834e-04
Validation rmse = 0.104073
Epoch 26
Loss = 7.4096e-02, PNorm = 44.7070, GNorm = 2.4275, lr_0 = 3.5997e-04
Loss = 8.2972e-02, PNorm = 44.7180, GNorm = 0.7499, lr_0 = 3.5252e-04
Validation rmse = 0.096309
Epoch 27
Loss = 8.9737e-02, PNorm = 44.7298, GNorm = 0.9553, lr_0 = 3.4523e-04
Loss = 8.1608e-02, PNorm = 44.7399, GNorm = 1.6219, lr_0 = 3.3809e-04
Validation rmse = 0.089372
Epoch 28
Loss = 8.9140e-02, PNorm = 44.7521, GNorm = 2.6103, lr_0 = 3.3041e-04
Loss = 7.7660e-02, PNorm = 44.7623, GNorm = 2.6514, lr_0 = 3.2358e-04
Validation rmse = 0.105242
Epoch 29
Loss = 8.3911e-02, PNorm = 44.7729, GNorm = 1.9003, lr_0 = 3.1689e-04
Loss = 8.6580e-02, PNorm = 44.7834, GNorm = 0.9757, lr_0 = 3.1034e-04
Validation rmse = 0.102536
Epoch 30
Loss = 7.6297e-02, PNorm = 44.7985, GNorm = 1.3146, lr_0 = 3.0329e-04
Loss = 8.7189e-02, PNorm = 44.8101, GNorm = 1.6930, lr_0 = 2.9701e-04
Validation rmse = 0.110224
Epoch 31
Loss = 8.6826e-02, PNorm = 44.8212, GNorm = 0.8894, lr_0 = 2.9087e-04
Loss = 7.5894e-02, PNorm = 44.8296, GNorm = 1.3420, lr_0 = 2.8486e-04
Validation rmse = 0.113054
Epoch 32
Loss = 8.2066e-02, PNorm = 44.8391, GNorm = 1.1166, lr_0 = 2.7839e-04
Loss = 7.1683e-02, PNorm = 44.8499, GNorm = 1.1110, lr_0 = 2.7263e-04
Loss = 3.4874e-02, PNorm = 44.8506, GNorm = 0.6032, lr_0 = 2.7206e-04
Validation rmse = 0.116296
Epoch 33
Loss = 7.9697e-02, PNorm = 44.8587, GNorm = 1.5915, lr_0 = 2.6643e-04
Loss = 6.1482e-02, PNorm = 44.8664, GNorm = 2.6747, lr_0 = 2.6092e-04
Validation rmse = 0.104025
Epoch 34
Loss = 6.0682e-02, PNorm = 44.8738, GNorm = 1.3343, lr_0 = 2.5553e-04
Validation rmse = 0.097352
Epoch 35
Loss = 6.5706e-02, PNorm = 44.8820, GNorm = 0.6212, lr_0 = 2.4972e-04
Loss = 7.6620e-02, PNorm = 44.8907, GNorm = 1.0335, lr_0 = 2.4456e-04
Validation rmse = 0.081210
Epoch 36
Loss = 5.9010e-02, PNorm = 44.8989, GNorm = 2.0943, lr_0 = 2.3950e-04
Loss = 6.9794e-02, PNorm = 44.9089, GNorm = 0.8678, lr_0 = 2.3455e-04
Validation rmse = 0.115004
Epoch 37
Loss = 5.1630e-02, PNorm = 44.9182, GNorm = 0.3831, lr_0 = 2.2922e-04
Loss = 6.7813e-02, PNorm = 44.9271, GNorm = 1.4707, lr_0 = 2.2448e-04
Validation rmse = 0.116877
Epoch 38
Loss = 5.4244e-02, PNorm = 44.9357, GNorm = 0.4075, lr_0 = 2.1938e-04
Loss = 6.7695e-02, PNorm = 44.9432, GNorm = 1.0547, lr_0 = 2.1484e-04
Validation rmse = 0.077663
Epoch 39
Loss = 7.7594e-02, PNorm = 44.9502, GNorm = 0.8973, lr_0 = 2.1040e-04
Loss = 6.1060e-02, PNorm = 44.9574, GNorm = 2.4027, lr_0 = 2.0605e-04
Validation rmse = 0.097934
Epoch 40
Loss = 7.4885e-02, PNorm = 44.9651, GNorm = 1.0352, lr_0 = 2.0137e-04
Loss = 4.7186e-02, PNorm = 44.9737, GNorm = 0.8183, lr_0 = 1.9721e-04
Validation rmse = 0.111122
Epoch 41
Loss = 6.1430e-02, PNorm = 44.9794, GNorm = 0.8807, lr_0 = 1.9313e-04
Loss = 6.2937e-02, PNorm = 44.9869, GNorm = 1.3921, lr_0 = 1.8913e-04
Validation rmse = 0.120988
Epoch 42
Loss = 6.3847e-02, PNorm = 44.9944, GNorm = 2.2503, lr_0 = 1.8484e-04
Loss = 6.8553e-02, PNorm = 45.0008, GNorm = 1.2768, lr_0 = 1.8101e-04
Validation rmse = 0.102662
Epoch 43
Loss = 4.8948e-02, PNorm = 45.0070, GNorm = 2.2071, lr_0 = 1.7727e-04
Loss = 6.0285e-02, PNorm = 45.0124, GNorm = 1.3604, lr_0 = 1.7361e-04
Validation rmse = 0.093685
Epoch 44
Loss = 5.5524e-02, PNorm = 45.0197, GNorm = 0.7515, lr_0 = 1.6966e-04
Loss = 5.9582e-02, PNorm = 45.0264, GNorm = 0.8363, lr_0 = 1.6615e-04
Validation rmse = 0.101509
Epoch 45
Loss = 5.7156e-02, PNorm = 45.0323, GNorm = 1.8138, lr_0 = 1.6238e-04
Loss = 5.5824e-02, PNorm = 45.0375, GNorm = 0.7863, lr_0 = 1.5902e-04
Validation rmse = 0.116529
Epoch 46
Loss = 4.8225e-02, PNorm = 45.0434, GNorm = 0.8498, lr_0 = 1.5573e-04
Loss = 5.5678e-02, PNorm = 45.0489, GNorm = 1.1704, lr_0 = 1.5251e-04
Validation rmse = 0.079886
Epoch 47
Loss = 5.3757e-02, PNorm = 45.0549, GNorm = 0.6199, lr_0 = 1.4905e-04
Loss = 5.8343e-02, PNorm = 45.0601, GNorm = 1.6368, lr_0 = 1.4596e-04
Validation rmse = 0.094888
Epoch 48
Loss = 5.0586e-02, PNorm = 45.0644, GNorm = 0.5760, lr_0 = 1.4295e-04
Loss = 6.1137e-02, PNorm = 45.0696, GNorm = 0.8830, lr_0 = 1.3999e-04
Validation rmse = 0.117416
Epoch 49
Loss = 5.7779e-02, PNorm = 45.0749, GNorm = 1.6018, lr_0 = 1.3681e-04
Loss = 4.8853e-02, PNorm = 45.0803, GNorm = 1.0720, lr_0 = 1.3398e-04
Validation rmse = 0.081158
Epoch 50
Loss = 5.5115e-02, PNorm = 45.0854, GNorm = 0.6268, lr_0 = 1.3121e-04
Loss = 5.0930e-02, PNorm = 45.0905, GNorm = 1.7251, lr_0 = 1.2850e-04
Loss = 9.4475e-02, PNorm = 45.0909, GNorm = 1.4491, lr_0 = 1.2823e-04
Validation rmse = 0.089487
Epoch 51
Loss = 5.2866e-02, PNorm = 45.0956, GNorm = 1.0671, lr_0 = 1.2558e-04
Validation rmse = 0.121630
Epoch 52
Loss = 5.9710e-02, PNorm = 45.1007, GNorm = 1.4712, lr_0 = 1.2272e-04
Loss = 4.7858e-02, PNorm = 45.1050, GNorm = 0.4384, lr_0 = 1.2019e-04
Validation rmse = 0.101575
Epoch 53
Loss = 7.1666e-02, PNorm = 45.1092, GNorm = 1.1935, lr_0 = 1.1770e-04
Loss = 4.8789e-02, PNorm = 45.1137, GNorm = 0.7162, lr_0 = 1.1527e-04
Validation rmse = 0.091576
Epoch 54
Loss = 5.6025e-02, PNorm = 45.1180, GNorm = 1.8392, lr_0 = 1.1265e-04
Loss = 4.6716e-02, PNorm = 45.1229, GNorm = 1.4731, lr_0 = 1.1032e-04
Validation rmse = 0.102477
Epoch 55
Loss = 4.4411e-02, PNorm = 45.1263, GNorm = 0.5897, lr_0 = 1.0804e-04
Loss = 4.3621e-02, PNorm = 45.1300, GNorm = 0.9909, lr_0 = 1.0580e-04
Validation rmse = 0.091930
Epoch 56
Loss = 5.2255e-02, PNorm = 45.1343, GNorm = 0.8493, lr_0 = 1.0340e-04
Loss = 4.5749e-02, PNorm = 45.1379, GNorm = 1.2828, lr_0 = 1.0126e-04
Validation rmse = 0.134159
Epoch 57
Loss = 4.8692e-02, PNorm = 45.1421, GNorm = 0.6570, lr_0 = 1.0000e-04
Loss = 4.8413e-02, PNorm = 45.1459, GNorm = 0.8050, lr_0 = 1.0000e-04
Validation rmse = 0.081840
Epoch 58
Loss = 4.1219e-02, PNorm = 45.1491, GNorm = 1.5445, lr_0 = 1.0000e-04
Loss = 4.9529e-02, PNorm = 45.1528, GNorm = 1.7339, lr_0 = 1.0000e-04
Validation rmse = 0.111796
Epoch 59
Loss = 5.0858e-02, PNorm = 45.1572, GNorm = 1.5551, lr_0 = 1.0000e-04
Loss = 4.6804e-02, PNorm = 45.1614, GNorm = 1.2346, lr_0 = 1.0000e-04
Validation rmse = 0.096261
Model 0 best validation rmse = 0.077663 on epoch 38
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.458819
Ensemble test rmse = 0.458819
1-fold cross validation
	Seed 0 ==> test rmse = 0.458819
Overall test rmse = 0.458819 +/- 0.000000
Elapsed time = 0:00:43
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/MeTHF_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/MeTHF_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/MeTHF_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 973 | train size = 963 | val size = 10 | test size = 59
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 8.9907e-01, PNorm = 43.2640, GNorm = 8.0752, lr_0 = 3.6053e-04
Validation rmse = 0.279257
Epoch 1
Loss = 6.3402e-01, PNorm = 43.2875, GNorm = 5.9908, lr_0 = 6.2105e-04
Loss = 5.7998e-01, PNorm = 43.3346, GNorm = 0.7649, lr_0 = 8.5789e-04
Validation rmse = 0.300211
Epoch 2
Loss = 6.9444e-01, PNorm = 43.4042, GNorm = 2.7333, lr_0 = 9.8961e-04
Loss = 5.3731e-01, PNorm = 43.4920, GNorm = 4.5787, lr_0 = 9.6914e-04
Validation rmse = 0.268600
Epoch 3
Loss = 5.2166e-01, PNorm = 43.5823, GNorm = 2.8910, lr_0 = 9.4712e-04
Loss = 3.0655e-01, PNorm = 43.6588, GNorm = 2.1465, lr_0 = 9.2754e-04
Validation rmse = 0.147843
Epoch 4
Loss = 4.1254e-01, PNorm = 43.7150, GNorm = 1.0991, lr_0 = 9.0836e-04
Loss = 2.9524e-01, PNorm = 43.7682, GNorm = 1.9273, lr_0 = 8.8958e-04
Validation rmse = 0.121465
Epoch 5
Loss = 2.1827e-01, PNorm = 43.8222, GNorm = 2.5695, lr_0 = 8.6936e-04
Loss = 1.9107e-01, PNorm = 43.8627, GNorm = 2.0022, lr_0 = 8.5139e-04
Validation rmse = 0.129738
Epoch 6
Loss = 1.7396e-01, PNorm = 43.9024, GNorm = 2.0162, lr_0 = 8.3204e-04
Loss = 1.7559e-01, PNorm = 43.9288, GNorm = 3.6386, lr_0 = 8.1484e-04
Validation rmse = 0.145792
Epoch 7
Loss = 1.8745e-01, PNorm = 43.9633, GNorm = 4.2705, lr_0 = 7.9632e-04
Loss = 1.5740e-01, PNorm = 43.9894, GNorm = 3.9409, lr_0 = 7.7986e-04
Validation rmse = 0.133368
Epoch 8
Loss = 1.3765e-01, PNorm = 44.0152, GNorm = 2.4109, lr_0 = 7.6373e-04
Loss = 1.4949e-01, PNorm = 44.0417, GNorm = 2.2603, lr_0 = 7.4794e-04
Validation rmse = 0.144842
Epoch 9
Loss = 1.2510e-01, PNorm = 44.0665, GNorm = 1.3265, lr_0 = 7.3094e-04
Loss = 1.4381e-01, PNorm = 44.0895, GNorm = 2.6507, lr_0 = 7.1583e-04
Validation rmse = 0.133052
Epoch 10
Loss = 1.0714e-01, PNorm = 44.1118, GNorm = 2.2176, lr_0 = 6.9956e-04
Loss = 1.2742e-01, PNorm = 44.1337, GNorm = 1.4757, lr_0 = 6.8510e-04
Validation rmse = 0.123714
Epoch 11
Loss = 1.0660e-01, PNorm = 44.1518, GNorm = 2.4219, lr_0 = 6.6953e-04
Loss = 1.2573e-01, PNorm = 44.1676, GNorm = 4.1852, lr_0 = 6.5569e-04
Validation rmse = 0.129093
Epoch 12
Loss = 1.1668e-01, PNorm = 44.1853, GNorm = 2.9637, lr_0 = 6.4213e-04
Loss = 1.1358e-01, PNorm = 44.2013, GNorm = 1.2711, lr_0 = 6.2885e-04
Loss = 1.2684e-01, PNorm = 44.2042, GNorm = 3.6971, lr_0 = 6.2754e-04
Validation rmse = 0.126440
Epoch 13
Loss = 1.1044e-01, PNorm = 44.2272, GNorm = 1.7103, lr_0 = 6.1456e-04
Validation rmse = 0.124226
Epoch 14
Loss = 1.0082e-01, PNorm = 44.2462, GNorm = 0.9937, lr_0 = 6.0060e-04
Loss = 1.0776e-01, PNorm = 44.2661, GNorm = 3.0160, lr_0 = 5.8818e-04
Validation rmse = 0.122433
Epoch 15
Loss = 9.5209e-02, PNorm = 44.2830, GNorm = 1.8905, lr_0 = 5.7482e-04
Loss = 9.6285e-02, PNorm = 44.2999, GNorm = 0.6800, lr_0 = 5.6293e-04
Validation rmse = 0.156341
Epoch 16
Loss = 2.1022e-01, PNorm = 44.3181, GNorm = 7.3345, lr_0 = 5.5129e-04
Loss = 1.1425e-01, PNorm = 44.3422, GNorm = 2.2601, lr_0 = 5.3989e-04
Validation rmse = 0.137009
Epoch 17
Loss = 1.3817e-01, PNorm = 44.3630, GNorm = 3.3226, lr_0 = 5.2762e-04
Loss = 9.6029e-02, PNorm = 44.3849, GNorm = 0.7229, lr_0 = 5.1671e-04
Validation rmse = 0.152123
Epoch 18
Loss = 8.2173e-02, PNorm = 44.4018, GNorm = 1.2481, lr_0 = 5.0497e-04
Loss = 9.7810e-02, PNorm = 44.4154, GNorm = 2.0566, lr_0 = 4.9453e-04
Validation rmse = 0.117894
Epoch 19
Loss = 9.2777e-02, PNorm = 44.4283, GNorm = 0.8641, lr_0 = 4.8329e-04
Loss = 8.7920e-02, PNorm = 44.4426, GNorm = 2.4619, lr_0 = 4.7330e-04
Validation rmse = 0.132321
Epoch 20
Loss = 7.6848e-02, PNorm = 44.4526, GNorm = 1.3262, lr_0 = 4.6351e-04
Loss = 9.1923e-02, PNorm = 44.4641, GNorm = 1.3131, lr_0 = 4.5393e-04
Validation rmse = 0.117102
Epoch 21
Loss = 9.8803e-02, PNorm = 44.4791, GNorm = 3.6035, lr_0 = 4.4361e-04
Loss = 9.5602e-02, PNorm = 44.4890, GNorm = 1.1623, lr_0 = 4.3444e-04
Validation rmse = 0.129378
Epoch 22
Loss = 7.7321e-02, PNorm = 44.4995, GNorm = 0.8774, lr_0 = 4.2457e-04
Loss = 8.1365e-02, PNorm = 44.5103, GNorm = 0.8406, lr_0 = 4.1579e-04
Validation rmse = 0.119269
Epoch 23
Loss = 8.2564e-02, PNorm = 44.5252, GNorm = 0.7227, lr_0 = 4.0634e-04
Loss = 9.3716e-02, PNorm = 44.5354, GNorm = 0.6044, lr_0 = 3.9794e-04
Validation rmse = 0.143585
Epoch 24
Loss = 8.4257e-02, PNorm = 44.5467, GNorm = 0.9610, lr_0 = 3.8971e-04
Loss = 8.7855e-02, PNorm = 44.5623, GNorm = 2.1695, lr_0 = 3.8165e-04
Validation rmse = 0.143090
Epoch 25
Loss = 8.0801e-02, PNorm = 44.5750, GNorm = 0.8202, lr_0 = 3.7298e-04
Loss = 7.3757e-02, PNorm = 44.5850, GNorm = 0.7979, lr_0 = 3.6527e-04
Loss = 7.5272e-02, PNorm = 44.5860, GNorm = 0.9938, lr_0 = 3.6451e-04
Validation rmse = 0.128706
Epoch 26
Loss = 7.5430e-02, PNorm = 44.5975, GNorm = 2.4254, lr_0 = 3.5697e-04
Loss = 8.2850e-02, PNorm = 44.6069, GNorm = 4.0110, lr_0 = 3.4959e-04
Validation rmse = 0.134137
Epoch 27
Loss = 8.4156e-02, PNorm = 44.6184, GNorm = 0.5050, lr_0 = 3.4236e-04
Validation rmse = 0.133399
Epoch 28
Loss = 6.0831e-02, PNorm = 44.6335, GNorm = 1.5847, lr_0 = 3.3458e-04
Loss = 8.3912e-02, PNorm = 44.6443, GNorm = 0.4893, lr_0 = 3.2766e-04
Validation rmse = 0.126182
Epoch 29
Loss = 4.6628e-02, PNorm = 44.6538, GNorm = 0.8607, lr_0 = 3.2022e-04
Loss = 7.2867e-02, PNorm = 44.6623, GNorm = 1.8694, lr_0 = 3.1360e-04
Validation rmse = 0.126785
Epoch 30
Loss = 6.3885e-02, PNorm = 44.6698, GNorm = 1.6762, lr_0 = 3.0647e-04
Loss = 7.3713e-02, PNorm = 44.6777, GNorm = 0.5366, lr_0 = 3.0013e-04
Validation rmse = 0.136523
Epoch 31
Loss = 1.0180e-01, PNorm = 44.6861, GNorm = 1.0933, lr_0 = 2.9393e-04
Loss = 7.0609e-02, PNorm = 44.6958, GNorm = 0.8382, lr_0 = 2.8785e-04
Validation rmse = 0.136724
Epoch 32
Loss = 7.3955e-02, PNorm = 44.7067, GNorm = 1.7601, lr_0 = 2.8131e-04
Loss = 6.6809e-02, PNorm = 44.7158, GNorm = 0.4802, lr_0 = 2.7549e-04
Validation rmse = 0.134212
Epoch 33
Loss = 6.1722e-02, PNorm = 44.7234, GNorm = 1.2273, lr_0 = 2.6923e-04
Loss = 6.3944e-02, PNorm = 44.7312, GNorm = 0.5353, lr_0 = 2.6367e-04
Validation rmse = 0.136751
Epoch 34
Loss = 7.1482e-02, PNorm = 44.7404, GNorm = 0.5984, lr_0 = 2.5767e-04
Loss = 6.7226e-02, PNorm = 44.7499, GNorm = 1.5775, lr_0 = 2.5235e-04
Validation rmse = 0.134582
Epoch 35
Loss = 6.9977e-02, PNorm = 44.7587, GNorm = 0.6519, lr_0 = 2.4713e-04
Loss = 6.2515e-02, PNorm = 44.7662, GNorm = 0.5060, lr_0 = 2.4202e-04
Validation rmse = 0.128701
Epoch 36
Loss = 5.4626e-02, PNorm = 44.7740, GNorm = 1.3901, lr_0 = 2.3652e-04
Loss = 6.9541e-02, PNorm = 44.7808, GNorm = 1.6192, lr_0 = 2.3163e-04
Validation rmse = 0.128367
Epoch 37
Loss = 5.7204e-02, PNorm = 44.7880, GNorm = 0.4088, lr_0 = 2.2637e-04
Loss = 6.9163e-02, PNorm = 44.7960, GNorm = 1.4187, lr_0 = 2.2168e-04
Validation rmse = 0.129550
Epoch 38
Loss = 6.1368e-02, PNorm = 44.8037, GNorm = 2.1347, lr_0 = 2.1665e-04
Loss = 6.5842e-02, PNorm = 44.8104, GNorm = 2.1675, lr_0 = 2.1217e-04
Validation rmse = 0.135341
Epoch 39
Loss = 6.4863e-02, PNorm = 44.8178, GNorm = 1.6890, lr_0 = 2.0778e-04
Loss = 6.4646e-02, PNorm = 44.8261, GNorm = 0.8886, lr_0 = 2.0348e-04
Loss = 5.7960e-02, PNorm = 44.8267, GNorm = 1.2912, lr_0 = 2.0306e-04
Validation rmse = 0.152870
Epoch 40
Loss = 8.1364e-02, PNorm = 44.8324, GNorm = 1.2473, lr_0 = 1.9886e-04
Validation rmse = 0.131044
Epoch 41
Loss = 4.7644e-02, PNorm = 44.8415, GNorm = 1.3360, lr_0 = 1.9434e-04
Loss = 6.2849e-02, PNorm = 44.8496, GNorm = 1.4136, lr_0 = 1.9032e-04
Validation rmse = 0.141478
Epoch 42
Loss = 5.9442e-02, PNorm = 44.8573, GNorm = 1.1179, lr_0 = 1.8600e-04
Loss = 6.4120e-02, PNorm = 44.8634, GNorm = 0.5529, lr_0 = 1.8215e-04
Validation rmse = 0.124006
Epoch 43
Loss = 4.6735e-02, PNorm = 44.8695, GNorm = 1.1161, lr_0 = 1.7839e-04
Loss = 6.1559e-02, PNorm = 44.8747, GNorm = 0.9239, lr_0 = 1.7470e-04
Validation rmse = 0.132562
Epoch 44
Loss = 5.3249e-02, PNorm = 44.8805, GNorm = 0.4981, lr_0 = 1.7073e-04
Loss = 5.9614e-02, PNorm = 44.8863, GNorm = 1.2901, lr_0 = 1.6720e-04
Validation rmse = 0.135137
Epoch 45
Loss = 5.9827e-02, PNorm = 44.8917, GNorm = 1.1362, lr_0 = 1.6340e-04
Loss = 5.9524e-02, PNorm = 44.8968, GNorm = 1.1103, lr_0 = 1.6002e-04
Validation rmse = 0.127772
Epoch 46
Loss = 5.1521e-02, PNorm = 44.9017, GNorm = 0.4753, lr_0 = 1.5638e-04
Loss = 5.2438e-02, PNorm = 44.9064, GNorm = 0.2616, lr_0 = 1.5315e-04
Validation rmse = 0.129631
Epoch 47
Loss = 5.7599e-02, PNorm = 44.9126, GNorm = 1.0716, lr_0 = 1.4998e-04
Loss = 5.1252e-02, PNorm = 44.9185, GNorm = 0.9075, lr_0 = 1.4688e-04
Validation rmse = 0.121620
Epoch 48
Loss = 5.4132e-02, PNorm = 44.9236, GNorm = 0.5488, lr_0 = 1.4354e-04
Loss = 5.4303e-02, PNorm = 44.9285, GNorm = 1.3580, lr_0 = 1.4058e-04
Validation rmse = 0.123945
Epoch 49
Loss = 5.1515e-02, PNorm = 44.9344, GNorm = 0.6996, lr_0 = 1.3738e-04
Loss = 5.0314e-02, PNorm = 44.9394, GNorm = 0.6419, lr_0 = 1.3454e-04
Validation rmse = 0.124403
Epoch 50
Loss = 4.7367e-02, PNorm = 44.9446, GNorm = 0.9028, lr_0 = 1.3176e-04
Loss = 5.3542e-02, PNorm = 44.9494, GNorm = 1.3054, lr_0 = 1.2904e-04
Validation rmse = 0.126801
Epoch 51
Loss = 4.5597e-02, PNorm = 44.9548, GNorm = 1.0676, lr_0 = 1.2610e-04
Loss = 5.1225e-02, PNorm = 44.9595, GNorm = 0.7443, lr_0 = 1.2350e-04
Validation rmse = 0.125458
Epoch 52
Loss = 4.3776e-02, PNorm = 44.9640, GNorm = 1.0121, lr_0 = 1.2069e-04
Loss = 5.5153e-02, PNorm = 44.9683, GNorm = 1.9536, lr_0 = 1.1819e-04
Loss = 2.9921e-02, PNorm = 44.9689, GNorm = 1.2610, lr_0 = 1.1795e-04
Validation rmse = 0.123218
Epoch 53
Loss = 4.6901e-02, PNorm = 44.9726, GNorm = 1.1158, lr_0 = 1.1551e-04
Loss = 5.2779e-02, PNorm = 44.9769, GNorm = 2.5507, lr_0 = 1.1312e-04
Validation rmse = 0.133544
Epoch 54
Loss = 5.3383e-02, PNorm = 44.9814, GNorm = 1.1785, lr_0 = 1.1078e-04
Validation rmse = 0.123098
Epoch 55
Loss = 5.4187e-02, PNorm = 44.9860, GNorm = 0.8777, lr_0 = 1.0826e-04
Loss = 4.7428e-02, PNorm = 44.9898, GNorm = 1.5533, lr_0 = 1.0603e-04
Validation rmse = 0.125954
Epoch 56
Loss = 4.8738e-02, PNorm = 44.9940, GNorm = 1.0447, lr_0 = 1.0362e-04
Loss = 4.7267e-02, PNorm = 44.9968, GNorm = 0.9336, lr_0 = 1.0147e-04
Validation rmse = 0.123012
Epoch 57
Loss = 4.6053e-02, PNorm = 45.0016, GNorm = 1.5902, lr_0 = 1.0000e-04
Loss = 5.3089e-02, PNorm = 45.0054, GNorm = 1.6525, lr_0 = 1.0000e-04
Validation rmse = 0.124406
Epoch 58
Loss = 3.5971e-02, PNorm = 45.0092, GNorm = 1.2294, lr_0 = 1.0000e-04
Loss = 5.0301e-02, PNorm = 45.0128, GNorm = 3.1194, lr_0 = 1.0000e-04
Validation rmse = 0.125746
Epoch 59
Loss = 4.2643e-02, PNorm = 45.0172, GNorm = 0.9955, lr_0 = 1.0000e-04
Loss = 5.4079e-02, PNorm = 45.0205, GNorm = 0.6067, lr_0 = 1.0000e-04
Validation rmse = 0.125570
Model 0 best validation rmse = 0.117102 on epoch 20
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.192762
Ensemble test rmse = 0.192762
1-fold cross validation
	Seed 0 ==> test rmse = 0.192762
Overall test rmse = 0.192762 +/- 0.000000
Elapsed time = 0:00:43
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/DMF_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/DMF_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/DMF_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 934 | train size = 924 | val size = 10 | test size = 98
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.3813e-01, PNorm = 43.2616, GNorm = 1.4597, lr_0 = 3.7500e-04
Validation rmse = 0.212962
Epoch 1
Loss = 6.3755e-01, PNorm = 43.2882, GNorm = 4.1601, lr_0 = 6.5000e-04
Loss = 6.6683e-01, PNorm = 43.3367, GNorm = 3.2846, lr_0 = 9.0000e-04
Validation rmse = 0.260643
Epoch 2
Loss = 5.9237e-01, PNorm = 43.4098, GNorm = 5.3555, lr_0 = 9.8468e-04
Loss = 5.5275e-01, PNorm = 43.4910, GNorm = 0.7366, lr_0 = 9.6320e-04
Validation rmse = 0.156177
Epoch 3
Loss = 3.8654e-01, PNorm = 43.5750, GNorm = 2.0533, lr_0 = 9.4219e-04
Loss = 3.8008e-01, PNorm = 43.6458, GNorm = 1.8547, lr_0 = 9.2164e-04
Validation rmse = 0.150779
Epoch 4
Loss = 3.6671e-01, PNorm = 43.7243, GNorm = 7.5249, lr_0 = 8.9955e-04
Loss = 3.0388e-01, PNorm = 43.7880, GNorm = 1.8149, lr_0 = 8.7992e-04
Validation rmse = 0.129441
Epoch 5
Loss = 2.4249e-01, PNorm = 43.8361, GNorm = 5.7718, lr_0 = 8.6073e-04
Loss = 2.2637e-01, PNorm = 43.8826, GNorm = 2.2028, lr_0 = 8.4195e-04
Loss = 1.2516e-01, PNorm = 43.8871, GNorm = 2.2042, lr_0 = 8.4010e-04
Validation rmse = 0.105004
Epoch 6
Loss = 1.8444e-01, PNorm = 43.9280, GNorm = 1.4921, lr_0 = 8.2177e-04
Validation rmse = 0.094561
Epoch 7
Loss = 2.2178e-01, PNorm = 43.9641, GNorm = 1.2846, lr_0 = 8.0385e-04
Loss = 1.6488e-01, PNorm = 43.9948, GNorm = 3.7742, lr_0 = 7.8631e-04
Validation rmse = 0.094302
Epoch 8
Loss = 1.0529e-01, PNorm = 44.0203, GNorm = 1.6683, lr_0 = 7.6746e-04
Loss = 1.4727e-01, PNorm = 44.0455, GNorm = 2.4485, lr_0 = 7.5072e-04
Validation rmse = 0.083178
Epoch 9
Loss = 1.6244e-01, PNorm = 44.0723, GNorm = 3.5135, lr_0 = 7.3435e-04
Loss = 1.3135e-01, PNorm = 44.0990, GNorm = 2.6103, lr_0 = 7.1833e-04
Validation rmse = 0.129963
Epoch 10
Loss = 1.4227e-01, PNorm = 44.1206, GNorm = 1.4597, lr_0 = 7.0111e-04
Loss = 1.4919e-01, PNorm = 44.1371, GNorm = 3.3329, lr_0 = 6.8581e-04
Validation rmse = 0.147713
Epoch 11
Loss = 1.2570e-01, PNorm = 44.1615, GNorm = 1.0924, lr_0 = 6.7085e-04
Loss = 1.2321e-01, PNorm = 44.1796, GNorm = 0.9874, lr_0 = 6.5622e-04
Validation rmse = 0.103864
Epoch 12
Loss = 1.2792e-01, PNorm = 44.1998, GNorm = 3.2222, lr_0 = 6.4049e-04
Loss = 1.1103e-01, PNorm = 44.2157, GNorm = 1.7434, lr_0 = 6.2652e-04
Validation rmse = 0.109977
Epoch 13
Loss = 1.1292e-01, PNorm = 44.2383, GNorm = 2.0163, lr_0 = 6.1285e-04
Validation rmse = 0.099869
Epoch 14
Loss = 9.8770e-02, PNorm = 44.2550, GNorm = 0.6265, lr_0 = 5.9816e-04
Loss = 9.7950e-02, PNorm = 44.2708, GNorm = 0.7007, lr_0 = 5.8512e-04
Validation rmse = 0.100034
Epoch 15
Loss = 1.0461e-01, PNorm = 44.2882, GNorm = 1.4828, lr_0 = 5.7235e-04
Loss = 1.1379e-01, PNorm = 44.3001, GNorm = 1.1746, lr_0 = 5.5987e-04
Validation rmse = 0.108414
Epoch 16
Loss = 1.1461e-01, PNorm = 44.3206, GNorm = 1.1962, lr_0 = 5.4645e-04
Loss = 9.6454e-02, PNorm = 44.3407, GNorm = 0.7842, lr_0 = 5.3453e-04
Validation rmse = 0.129374
Epoch 17
Loss = 9.6235e-02, PNorm = 44.3566, GNorm = 1.3439, lr_0 = 5.2287e-04
Loss = 1.2603e-01, PNorm = 44.3744, GNorm = 2.1706, lr_0 = 5.1146e-04
Validation rmse = 0.100860
Epoch 18
Loss = 1.1063e-01, PNorm = 44.3920, GNorm = 1.8192, lr_0 = 4.9920e-04
Loss = 9.3034e-02, PNorm = 44.4075, GNorm = 0.7002, lr_0 = 4.8831e-04
Validation rmse = 0.120578
Epoch 19
Loss = 9.1415e-02, PNorm = 44.4202, GNorm = 1.1243, lr_0 = 4.7766e-04
Validation rmse = 0.108216
Epoch 20
Loss = 6.7265e-02, PNorm = 44.4327, GNorm = 1.2541, lr_0 = 4.6621e-04
Loss = 9.2127e-02, PNorm = 44.4430, GNorm = 0.7222, lr_0 = 4.5604e-04
Validation rmse = 0.112416
Epoch 21
Loss = 5.6751e-02, PNorm = 44.4579, GNorm = 1.3918, lr_0 = 4.4609e-04
Loss = 9.0022e-02, PNorm = 44.4707, GNorm = 2.2348, lr_0 = 4.3636e-04
Validation rmse = 0.112371
Epoch 22
Loss = 7.8426e-02, PNorm = 44.4850, GNorm = 1.2726, lr_0 = 4.2590e-04
Loss = 1.0489e-01, PNorm = 44.4977, GNorm = 1.3129, lr_0 = 4.1661e-04
Validation rmse = 0.120312
Epoch 23
Loss = 9.5131e-02, PNorm = 44.5095, GNorm = 2.2152, lr_0 = 4.0752e-04
Loss = 8.9665e-02, PNorm = 44.5247, GNorm = 1.3887, lr_0 = 3.9863e-04
Validation rmse = 0.100153
Epoch 24
Loss = 8.7477e-02, PNorm = 44.5396, GNorm = 1.6242, lr_0 = 3.8908e-04
Loss = 9.5810e-02, PNorm = 44.5520, GNorm = 1.3907, lr_0 = 3.8059e-04
Validation rmse = 0.105336
Epoch 25
Loss = 1.0024e-01, PNorm = 44.5677, GNorm = 2.2225, lr_0 = 3.7229e-04
Loss = 8.2060e-02, PNorm = 44.5808, GNorm = 0.5698, lr_0 = 3.6417e-04
Loss = 1.2195e-01, PNorm = 44.5819, GNorm = 2.1327, lr_0 = 3.6337e-04
Validation rmse = 0.095022
Epoch 26
Loss = 8.4496e-02, PNorm = 44.5935, GNorm = 0.8853, lr_0 = 3.5544e-04
Validation rmse = 0.108980
Epoch 27
Loss = 8.2152e-02, PNorm = 44.6061, GNorm = 0.7526, lr_0 = 3.4692e-04
Loss = 7.9279e-02, PNorm = 44.6172, GNorm = 0.9653, lr_0 = 3.3935e-04
Validation rmse = 0.102276
Epoch 28
Loss = 5.3009e-02, PNorm = 44.6273, GNorm = 0.8221, lr_0 = 3.3195e-04
Loss = 7.9997e-02, PNorm = 44.6369, GNorm = 0.8275, lr_0 = 3.2471e-04
Validation rmse = 0.114137
Epoch 29
Loss = 8.2379e-02, PNorm = 44.6450, GNorm = 0.4954, lr_0 = 3.1693e-04
Loss = 7.8644e-02, PNorm = 44.6556, GNorm = 0.9286, lr_0 = 3.1001e-04
Validation rmse = 0.110353
Epoch 30
Loss = 7.8615e-02, PNorm = 44.6644, GNorm = 0.8343, lr_0 = 3.0325e-04
Loss = 7.5713e-02, PNorm = 44.6764, GNorm = 0.9570, lr_0 = 2.9663e-04
Validation rmse = 0.103448
Epoch 31
Loss = 6.7279e-02, PNorm = 44.6885, GNorm = 0.6164, lr_0 = 2.8952e-04
Loss = 7.6238e-02, PNorm = 44.6955, GNorm = 1.8055, lr_0 = 2.8321e-04
Validation rmse = 0.100796
Epoch 32
Loss = 7.2375e-02, PNorm = 44.7051, GNorm = 0.7730, lr_0 = 2.7703e-04
Validation rmse = 0.103983
Epoch 33
Loss = 6.3445e-02, PNorm = 44.7145, GNorm = 0.6167, lr_0 = 2.7039e-04
Loss = 7.3214e-02, PNorm = 44.7230, GNorm = 1.2453, lr_0 = 2.6449e-04
Validation rmse = 0.106976
Epoch 34
Loss = 9.0250e-02, PNorm = 44.7316, GNorm = 1.1542, lr_0 = 2.5872e-04
Loss = 7.2102e-02, PNorm = 44.7412, GNorm = 1.0397, lr_0 = 2.5308e-04
Validation rmse = 0.101313
Epoch 35
Loss = 7.1783e-02, PNorm = 44.7509, GNorm = 0.7763, lr_0 = 2.4701e-04
Loss = 6.8116e-02, PNorm = 44.7576, GNorm = 1.4938, lr_0 = 2.4162e-04
Validation rmse = 0.104231
Epoch 36
Loss = 5.3043e-02, PNorm = 44.7665, GNorm = 2.2099, lr_0 = 2.3635e-04
Loss = 7.3017e-02, PNorm = 44.7734, GNorm = 1.1008, lr_0 = 2.3120e-04
Validation rmse = 0.106226
Epoch 37
Loss = 5.9045e-02, PNorm = 44.7860, GNorm = 1.8836, lr_0 = 2.2566e-04
Loss = 7.6054e-02, PNorm = 44.7945, GNorm = 1.7975, lr_0 = 2.2073e-04
Validation rmse = 0.103040
Epoch 38
Loss = 6.3403e-02, PNorm = 44.8010, GNorm = 0.6590, lr_0 = 2.1592e-04
Loss = 6.9599e-02, PNorm = 44.8105, GNorm = 1.3675, lr_0 = 2.1121e-04
Loss = 4.3301e-02, PNorm = 44.8114, GNorm = 0.8675, lr_0 = 2.1074e-04
Validation rmse = 0.100057
Epoch 39
Loss = 5.9898e-02, PNorm = 44.8192, GNorm = 1.2515, lr_0 = 2.0615e-04
Validation rmse = 0.102715
Epoch 40
Loss = 4.6461e-02, PNorm = 44.8252, GNorm = 0.9077, lr_0 = 2.0165e-04
Loss = 6.2809e-02, PNorm = 44.8334, GNorm = 1.6798, lr_0 = 1.9725e-04
Validation rmse = 0.105370
Epoch 41
Loss = 6.5218e-02, PNorm = 44.8411, GNorm = 1.8363, lr_0 = 1.9252e-04
Loss = 6.0019e-02, PNorm = 44.8479, GNorm = 1.0195, lr_0 = 1.8832e-04
Validation rmse = 0.109180
Epoch 42
Loss = 6.5035e-02, PNorm = 44.8547, GNorm = 0.6279, lr_0 = 1.8422e-04
Loss = 6.4912e-02, PNorm = 44.8624, GNorm = 0.5966, lr_0 = 1.8020e-04
Validation rmse = 0.102164
Epoch 43
Loss = 5.3905e-02, PNorm = 44.8693, GNorm = 0.5449, lr_0 = 1.7588e-04
Loss = 5.5134e-02, PNorm = 44.8755, GNorm = 1.1625, lr_0 = 1.7204e-04
Validation rmse = 0.104816
Epoch 44
Loss = 5.6227e-02, PNorm = 44.8816, GNorm = 2.0333, lr_0 = 1.6829e-04
Loss = 6.5884e-02, PNorm = 44.8874, GNorm = 1.9152, lr_0 = 1.6462e-04
Validation rmse = 0.100078
Epoch 45
Loss = 5.7002e-02, PNorm = 44.8947, GNorm = 0.9303, lr_0 = 1.6067e-04
Loss = 6.2085e-02, PNorm = 44.9006, GNorm = 1.6700, lr_0 = 1.5717e-04
Validation rmse = 0.099609
Epoch 46
Loss = 5.7997e-02, PNorm = 44.9080, GNorm = 0.8368, lr_0 = 1.5374e-04
Validation rmse = 0.102806
Epoch 47
Loss = 2.9014e-02, PNorm = 44.9135, GNorm = 0.6176, lr_0 = 1.5005e-04
Loss = 6.0633e-02, PNorm = 44.9190, GNorm = 0.9467, lr_0 = 1.4678e-04
Validation rmse = 0.101098
Epoch 48
Loss = 5.7077e-02, PNorm = 44.9253, GNorm = 0.6898, lr_0 = 1.4358e-04
Loss = 5.9605e-02, PNorm = 44.9306, GNorm = 0.7192, lr_0 = 1.4045e-04
Validation rmse = 0.099569
Epoch 49
Loss = 4.8646e-02, PNorm = 44.9372, GNorm = 1.1453, lr_0 = 1.3708e-04
Loss = 5.8340e-02, PNorm = 44.9433, GNorm = 0.5511, lr_0 = 1.3409e-04
Validation rmse = 0.098376
Epoch 50
Loss = 5.4183e-02, PNorm = 44.9478, GNorm = 0.5193, lr_0 = 1.3116e-04
Loss = 5.6590e-02, PNorm = 44.9526, GNorm = 2.1703, lr_0 = 1.2830e-04
Validation rmse = 0.101836
Epoch 51
Loss = 6.1601e-02, PNorm = 44.9586, GNorm = 0.9298, lr_0 = 1.2523e-04
Loss = 5.1640e-02, PNorm = 44.9649, GNorm = 1.4031, lr_0 = 1.2250e-04
Loss = 2.3147e-02, PNorm = 44.9654, GNorm = 0.6319, lr_0 = 1.2223e-04
Validation rmse = 0.109079
Epoch 52
Loss = 5.4247e-02, PNorm = 44.9705, GNorm = 1.4049, lr_0 = 1.1956e-04
Validation rmse = 0.101211
Epoch 53
Loss = 4.7494e-02, PNorm = 44.9751, GNorm = 1.0995, lr_0 = 1.1695e-04
Loss = 5.0010e-02, PNorm = 44.9805, GNorm = 0.8019, lr_0 = 1.1440e-04
Validation rmse = 0.118685
Epoch 54
Loss = 5.1780e-02, PNorm = 44.9842, GNorm = 0.5278, lr_0 = 1.1166e-04
Loss = 5.1361e-02, PNorm = 44.9895, GNorm = 1.9676, lr_0 = 1.0922e-04
Validation rmse = 0.103854
Epoch 55
Loss = 5.4450e-02, PNorm = 44.9945, GNorm = 1.3319, lr_0 = 1.0684e-04
Loss = 5.4940e-02, PNorm = 44.9984, GNorm = 0.6480, lr_0 = 1.0451e-04
Validation rmse = 0.103488
Epoch 56
Loss = 4.5753e-02, PNorm = 45.0027, GNorm = 0.8083, lr_0 = 1.0200e-04
Loss = 5.1782e-02, PNorm = 45.0068, GNorm = 0.9255, lr_0 = 1.0000e-04
Validation rmse = 0.103461
Epoch 57
Loss = 5.3204e-02, PNorm = 45.0107, GNorm = 0.7798, lr_0 = 1.0000e-04
Loss = 5.1785e-02, PNorm = 45.0147, GNorm = 0.6036, lr_0 = 1.0000e-04
Validation rmse = 0.103449
Epoch 58
Loss = 4.7784e-02, PNorm = 45.0199, GNorm = 1.3443, lr_0 = 1.0000e-04
Loss = 5.1530e-02, PNorm = 45.0235, GNorm = 1.4395, lr_0 = 1.0000e-04
Validation rmse = 0.104694
Epoch 59
Loss = 4.7944e-02, PNorm = 45.0281, GNorm = 1.2414, lr_0 = 1.0000e-04
Validation rmse = 0.097895
Model 0 best validation rmse = 0.083178 on epoch 8
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.183920
Ensemble test rmse = 0.183920
1-fold cross validation
	Seed 0 ==> test rmse = 0.183920
Overall test rmse = 0.183920 +/- 0.000000
Elapsed time = 0:00:42
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-ab3ceec9-8164-4a06-ac09-65b98d4d4da8.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': './data/hyperopt/hyperoptim.json',
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/split/EtOAc_train.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 400,
 'ffn_num_layers': 3,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 400,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/EtOAc_results.csv',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': './data/split/EtOAc_test.csv',
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': (0.99, 0.01, 0.0),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 967 | train size = 957 | val size = 10 | test size = 65
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=400, bias=False)
        (W_h): Linear(in_features=400, out_features=400, bias=False)
        (W_o): Linear(in_features=533, out_features=400, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=400, out_features=400, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=400, out_features=400, bias=True)
    (5): ReLU()
    (6): Dropout(p=0.0, inplace=False)
    (7): Linear(in_features=400, out_features=1, bias=True)
  )
)
Number of parameters = 754,001
Moving model to cuda
Epoch 0
Loss = 9.3621e-01, PNorm = 43.2624, GNorm = 2.2659, lr_0 = 3.6053e-04
Validation rmse = 0.350582
Epoch 1
Loss = 8.8402e-01, PNorm = 43.2824, GNorm = 6.3822, lr_0 = 6.2105e-04
Loss = 9.3630e-01, PNorm = 43.3193, GNorm = 2.7021, lr_0 = 8.5789e-04
Validation rmse = 0.265661
Epoch 2
Loss = 4.0227e-01, PNorm = 43.4029, GNorm = 0.7937, lr_0 = 9.8961e-04
Loss = 5.7630e-01, PNorm = 43.4903, GNorm = 7.1278, lr_0 = 9.6914e-04
Validation rmse = 0.237980
Epoch 3
Loss = 4.5865e-01, PNorm = 43.5684, GNorm = 4.5915, lr_0 = 9.4712e-04
Loss = 3.2021e-01, PNorm = 43.6274, GNorm = 0.5909, lr_0 = 9.2754e-04
Validation rmse = 0.218871
Epoch 4
Loss = 2.4639e-01, PNorm = 43.6773, GNorm = 1.1637, lr_0 = 9.0646e-04
Loss = 2.4892e-01, PNorm = 43.7260, GNorm = 1.1716, lr_0 = 8.8772e-04
Validation rmse = 0.224490
Epoch 5
Loss = 2.4334e-01, PNorm = 43.7724, GNorm = 1.0004, lr_0 = 8.6755e-04
Loss = 2.2275e-01, PNorm = 43.8066, GNorm = 1.8827, lr_0 = 8.4961e-04
Validation rmse = 0.178325
Epoch 6
Loss = 1.8801e-01, PNorm = 43.8568, GNorm = 2.0549, lr_0 = 8.3031e-04
Loss = 2.3105e-01, PNorm = 43.8873, GNorm = 1.1256, lr_0 = 8.1314e-04
Validation rmse = 0.189203
Epoch 7
Loss = 2.0439e-01, PNorm = 43.9167, GNorm = 1.5569, lr_0 = 7.9466e-04
Loss = 1.4455e-01, PNorm = 43.9458, GNorm = 5.1698, lr_0 = 7.7823e-04
Validation rmse = 0.170370
Epoch 8
Loss = 1.6054e-01, PNorm = 43.9779, GNorm = 3.3771, lr_0 = 7.6214e-04
Loss = 1.5417e-01, PNorm = 44.0066, GNorm = 2.9369, lr_0 = 7.4638e-04
Validation rmse = 0.182760
Epoch 9
Loss = 1.2674e-01, PNorm = 44.0264, GNorm = 2.1161, lr_0 = 7.2942e-04
Loss = 1.6596e-01, PNorm = 44.0519, GNorm = 2.8771, lr_0 = 7.1434e-04
Validation rmse = 0.203645
Epoch 10
Loss = 1.8935e-01, PNorm = 44.0789, GNorm = 2.2910, lr_0 = 6.9810e-04
Loss = 1.6867e-01, PNorm = 44.1051, GNorm = 0.8260, lr_0 = 6.8367e-04
Loss = 5.6846e-02, PNorm = 44.1082, GNorm = 1.1389, lr_0 = 6.8224e-04
Validation rmse = 0.186731
Epoch 11
Loss = 1.3556e-01, PNorm = 44.1326, GNorm = 0.6040, lr_0 = 6.6813e-04
Validation rmse = 0.187076
Epoch 12
Loss = 1.5453e-01, PNorm = 44.1519, GNorm = 1.9133, lr_0 = 6.5295e-04
Loss = 1.4065e-01, PNorm = 44.1706, GNorm = 1.4797, lr_0 = 6.3945e-04
Validation rmse = 0.183413
Epoch 13
Loss = 1.0960e-01, PNorm = 44.1895, GNorm = 1.5935, lr_0 = 6.2492e-04
Loss = 1.2886e-01, PNorm = 44.2070, GNorm = 1.4518, lr_0 = 6.1200e-04
Validation rmse = 0.185141
Epoch 14
Loss = 1.3343e-01, PNorm = 44.2242, GNorm = 0.9536, lr_0 = 5.9809e-04
Loss = 1.0323e-01, PNorm = 44.2405, GNorm = 1.0216, lr_0 = 5.8573e-04
Validation rmse = 0.186481
Epoch 15
Loss = 1.1478e-01, PNorm = 44.2539, GNorm = 0.7866, lr_0 = 5.7362e-04
Loss = 1.1097e-01, PNorm = 44.2646, GNorm = 0.7462, lr_0 = 5.6175e-04
Validation rmse = 0.177028
Epoch 16
Loss = 1.1412e-01, PNorm = 44.2790, GNorm = 2.0889, lr_0 = 5.4899e-04
Loss = 1.3237e-01, PNorm = 44.2967, GNorm = 3.0802, lr_0 = 5.3764e-04
Validation rmse = 0.172428
Epoch 17
Loss = 1.1496e-01, PNorm = 44.3126, GNorm = 4.9097, lr_0 = 5.2542e-04
Loss = 1.4573e-01, PNorm = 44.3338, GNorm = 1.4097, lr_0 = 5.1456e-04
Validation rmse = 0.192926
Epoch 18
Loss = 1.0363e-01, PNorm = 44.3562, GNorm = 0.6089, lr_0 = 5.0287e-04
Loss = 1.1017e-01, PNorm = 44.3658, GNorm = 1.4381, lr_0 = 4.9247e-04
Validation rmse = 0.181625
Epoch 19
Loss = 1.2712e-01, PNorm = 44.3815, GNorm = 2.0959, lr_0 = 4.8128e-04
Loss = 1.0086e-01, PNorm = 44.3946, GNorm = 0.4325, lr_0 = 4.7133e-04
Validation rmse = 0.173060
Epoch 20
Loss = 1.0542e-01, PNorm = 44.4103, GNorm = 3.0620, lr_0 = 4.6062e-04
Loss = 1.1778e-01, PNorm = 44.4245, GNorm = 1.1337, lr_0 = 4.5109e-04
Validation rmse = 0.188709
Epoch 21
Loss = 1.1414e-01, PNorm = 44.4383, GNorm = 2.6485, lr_0 = 4.4084e-04
Loss = 9.0157e-02, PNorm = 44.4498, GNorm = 0.8795, lr_0 = 4.3173e-04
Validation rmse = 0.180950
Epoch 22
Loss = 7.8925e-02, PNorm = 44.4572, GNorm = 1.3095, lr_0 = 4.2280e-04
Loss = 1.0609e-01, PNorm = 44.4691, GNorm = 1.6341, lr_0 = 4.1406e-04
Loss = 1.5712e-01, PNorm = 44.4710, GNorm = 3.1347, lr_0 = 4.1319e-04
Validation rmse = 0.182913
Epoch 23
Loss = 9.5253e-02, PNorm = 44.4873, GNorm = 0.8387, lr_0 = 4.0465e-04
Validation rmse = 0.172436
Epoch 24
Loss = 1.0355e-01, PNorm = 44.4963, GNorm = 0.8662, lr_0 = 3.9545e-04
Loss = 9.9224e-02, PNorm = 44.5097, GNorm = 0.6290, lr_0 = 3.8728e-04
Validation rmse = 0.177985
Epoch 25
Loss = 9.8313e-02, PNorm = 44.5223, GNorm = 2.2549, lr_0 = 3.7848e-04
Loss = 8.7319e-02, PNorm = 44.5332, GNorm = 0.6363, lr_0 = 3.7065e-04
Validation rmse = 0.174137
Epoch 26
Loss = 8.3388e-02, PNorm = 44.5431, GNorm = 1.7263, lr_0 = 3.6223e-04
Loss = 9.9596e-02, PNorm = 44.5513, GNorm = 0.8743, lr_0 = 3.5474e-04
Validation rmse = 0.176349
Epoch 27
Loss = 1.0195e-01, PNorm = 44.5640, GNorm = 1.7913, lr_0 = 3.4668e-04
Loss = 1.0416e-01, PNorm = 44.5748, GNorm = 1.0175, lr_0 = 3.3951e-04
Validation rmse = 0.178130
Epoch 28
Loss = 8.8738e-02, PNorm = 44.5855, GNorm = 0.7535, lr_0 = 3.3180e-04
Loss = 8.1467e-02, PNorm = 44.5960, GNorm = 1.6357, lr_0 = 3.2494e-04
Validation rmse = 0.172711
Epoch 29
Loss = 6.2500e-02, PNorm = 44.6034, GNorm = 0.5670, lr_0 = 3.1822e-04
Loss = 9.3422e-02, PNorm = 44.6113, GNorm = 2.7472, lr_0 = 3.1164e-04
Validation rmse = 0.181086
Epoch 30
Loss = 9.9787e-02, PNorm = 44.6217, GNorm = 2.3465, lr_0 = 3.0456e-04
Loss = 9.1318e-02, PNorm = 44.6328, GNorm = 1.5144, lr_0 = 2.9826e-04
Validation rmse = 0.164939
Epoch 31
Loss = 7.2534e-02, PNorm = 44.6437, GNorm = 0.5657, lr_0 = 2.9148e-04
Loss = 8.4089e-02, PNorm = 44.6533, GNorm = 1.0045, lr_0 = 2.8545e-04
Validation rmse = 0.177669
Epoch 32
Loss = 8.6890e-02, PNorm = 44.6615, GNorm = 1.7053, lr_0 = 2.7897e-04
Loss = 7.7879e-02, PNorm = 44.6701, GNorm = 0.5805, lr_0 = 2.7320e-04
Validation rmse = 0.166811
Epoch 33
Loss = 7.7922e-02, PNorm = 44.6806, GNorm = 0.6500, lr_0 = 2.6699e-04
Loss = 7.6385e-02, PNorm = 44.6900, GNorm = 1.4313, lr_0 = 2.6147e-04
Loss = 4.1966e-02, PNorm = 44.6911, GNorm = 2.4861, lr_0 = 2.6092e-04
Validation rmse = 0.167144
Epoch 34
Loss = 7.0463e-02, PNorm = 44.6974, GNorm = 0.6363, lr_0 = 2.5553e-04
Validation rmse = 0.171359
Epoch 35
Loss = 8.4192e-02, PNorm = 44.7057, GNorm = 1.2484, lr_0 = 2.4972e-04
Loss = 6.7404e-02, PNorm = 44.7145, GNorm = 0.3949, lr_0 = 2.4456e-04
Validation rmse = 0.164718
Epoch 36
Loss = 5.8229e-02, PNorm = 44.7219, GNorm = 0.6064, lr_0 = 2.3950e-04
Loss = 7.7146e-02, PNorm = 44.7293, GNorm = 0.9854, lr_0 = 2.3455e-04
Validation rmse = 0.170367
Epoch 37
Loss = 8.0050e-02, PNorm = 44.7392, GNorm = 0.6474, lr_0 = 2.2922e-04
Loss = 7.1905e-02, PNorm = 44.7464, GNorm = 0.9954, lr_0 = 2.2448e-04
Validation rmse = 0.159860
Epoch 38
Loss = 9.1723e-02, PNorm = 44.7532, GNorm = 1.1689, lr_0 = 2.1938e-04
Loss = 5.9041e-02, PNorm = 44.7600, GNorm = 1.4808, lr_0 = 2.1484e-04
Validation rmse = 0.172272
Epoch 39
Loss = 6.7130e-02, PNorm = 44.7685, GNorm = 1.5830, lr_0 = 2.0996e-04
Loss = 7.5191e-02, PNorm = 44.7757, GNorm = 0.8747, lr_0 = 2.0562e-04
Validation rmse = 0.166595
Epoch 40
Loss = 7.6283e-02, PNorm = 44.7836, GNorm = 0.4125, lr_0 = 2.0095e-04
Loss = 6.9534e-02, PNorm = 44.7896, GNorm = 0.8147, lr_0 = 1.9679e-04
Validation rmse = 0.167418
Epoch 41
Loss = 7.4011e-02, PNorm = 44.7994, GNorm = 1.8830, lr_0 = 1.9232e-04
Loss = 6.4700e-02, PNorm = 44.8067, GNorm = 1.7812, lr_0 = 1.8835e-04
Validation rmse = 0.161922
Epoch 42
Loss = 7.2782e-02, PNorm = 44.8111, GNorm = 3.3213, lr_0 = 1.8407e-04
Loss = 8.3972e-02, PNorm = 44.8184, GNorm = 0.6565, lr_0 = 1.8026e-04
Validation rmse = 0.172948
Epoch 43
Loss = 7.5124e-02, PNorm = 44.8254, GNorm = 1.3182, lr_0 = 1.7653e-04
Loss = 6.4586e-02, PNorm = 44.8319, GNorm = 2.0705, lr_0 = 1.7288e-04
Validation rmse = 0.168909
Epoch 44
Loss = 6.3936e-02, PNorm = 44.8380, GNorm = 0.6688, lr_0 = 1.6895e-04
Loss = 7.0731e-02, PNorm = 44.8437, GNorm = 0.6746, lr_0 = 1.6546e-04
Validation rmse = 0.164482
Epoch 45
Loss = 6.4613e-02, PNorm = 44.8495, GNorm = 1.4690, lr_0 = 1.6170e-04
Loss = 6.8299e-02, PNorm = 44.8556, GNorm = 0.7160, lr_0 = 1.5836e-04
Loss = 1.0548e-01, PNorm = 44.8562, GNorm = 3.4351, lr_0 = 1.5803e-04
Validation rmse = 0.169213
Epoch 46
Loss = 6.2933e-02, PNorm = 44.8607, GNorm = 0.6032, lr_0 = 1.5476e-04
Validation rmse = 0.158759
Epoch 47
Loss = 4.6443e-02, PNorm = 44.8667, GNorm = 0.8269, lr_0 = 1.5124e-04
Loss = 6.6471e-02, PNorm = 44.8727, GNorm = 0.6900, lr_0 = 1.4811e-04
Validation rmse = 0.160555
Epoch 48
Loss = 5.6234e-02, PNorm = 44.8793, GNorm = 1.1771, lr_0 = 1.4475e-04
Loss = 6.6289e-02, PNorm = 44.8842, GNorm = 0.4510, lr_0 = 1.4176e-04
Validation rmse = 0.158066
Epoch 49
Loss = 6.2798e-02, PNorm = 44.8903, GNorm = 0.8975, lr_0 = 1.3854e-04
Loss = 6.0310e-02, PNorm = 44.8954, GNorm = 0.6667, lr_0 = 1.3567e-04
Validation rmse = 0.158730
Epoch 50
Loss = 4.4767e-02, PNorm = 44.9000, GNorm = 0.7066, lr_0 = 1.3287e-04
Loss = 6.4027e-02, PNorm = 44.9045, GNorm = 0.8627, lr_0 = 1.3012e-04
Validation rmse = 0.163184
Epoch 51
Loss = 5.5065e-02, PNorm = 44.9098, GNorm = 0.4989, lr_0 = 1.2716e-04
Loss = 5.9192e-02, PNorm = 44.9134, GNorm = 0.7302, lr_0 = 1.2453e-04
Validation rmse = 0.155068
Epoch 52
Loss = 5.7535e-02, PNorm = 44.9188, GNorm = 0.3798, lr_0 = 1.2170e-04
Loss = 6.6828e-02, PNorm = 44.9233, GNorm = 0.8797, lr_0 = 1.1919e-04
Validation rmse = 0.153232
Epoch 53
Loss = 6.8572e-02, PNorm = 44.9283, GNorm = 2.0844, lr_0 = 1.1648e-04
Loss = 6.6254e-02, PNorm = 44.9316, GNorm = 1.1669, lr_0 = 1.1407e-04
Validation rmse = 0.145661
Epoch 54
Loss = 6.3087e-02, PNorm = 44.9363, GNorm = 0.4789, lr_0 = 1.1148e-04
Loss = 5.0190e-02, PNorm = 44.9398, GNorm = 0.9308, lr_0 = 1.0917e-04
Validation rmse = 0.151937
Epoch 55
Loss = 6.4013e-02, PNorm = 44.9442, GNorm = 0.6031, lr_0 = 1.0669e-04
Loss = 5.2827e-02, PNorm = 44.9481, GNorm = 0.5518, lr_0 = 1.0449e-04
Validation rmse = 0.154820
Epoch 56
Loss = 5.5163e-02, PNorm = 44.9519, GNorm = 0.5877, lr_0 = 1.0211e-04
Loss = 5.8497e-02, PNorm = 44.9557, GNorm = 1.5499, lr_0 = 1.0000e-04
Loss = 5.4174e-02, PNorm = 44.9559, GNorm = 1.8734, lr_0 = 1.0000e-04
Validation rmse = 0.154214
Epoch 57
Loss = 6.2557e-02, PNorm = 44.9602, GNorm = 1.2790, lr_0 = 1.0000e-04
Loss = 5.5259e-02, PNorm = 44.9633, GNorm = 2.2363, lr_0 = 1.0000e-04
Validation rmse = 0.151706
Epoch 58
Loss = 5.2598e-02, PNorm = 44.9663, GNorm = 1.1610, lr_0 = 1.0000e-04
Validation rmse = 0.158030
Epoch 59
Loss = 4.7163e-02, PNorm = 44.9701, GNorm = 1.9609, lr_0 = 1.0000e-04
Loss = 5.4295e-02, PNorm = 44.9736, GNorm = 1.2182, lr_0 = 1.0000e-04
Validation rmse = 0.145830
Model 0 best validation rmse = 0.145661 on epoch 53
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Loading pretrained parameter "ffn.7.weight".
Loading pretrained parameter "ffn.7.bias".
Moving model to cuda
Model 0 test rmse = 0.260137
Ensemble test rmse = 0.260137
1-fold cross validation
	Seed 0 ==> test rmse = 0.260137
Overall test rmse = 0.260137 +/- 0.000000
Elapsed time = 0:00:44
