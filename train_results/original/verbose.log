Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/bin/chemprop_train --data_path ./data/train_dm300_full.csv --dataset_type regression --save_dir ./train_results/original/ --quiet --smiles_columns full_smiles --target_columns dm300 --epochs 60 --extra_metrics r2
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './train_results/original/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,170 | train size = 936 | val size = 117 | test size = 117
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.5445e-01, PNorm = 34.0143, GNorm = 6.1226, lr_0 = 3.7500e-04
Validation rmse = 0.335007
Validation r2 = 0.087858
Epoch 1
Loss = 1.0399e+00, PNorm = 34.0300, GNorm = 6.0447, lr_0 = 6.5000e-04
Loss = 7.1397e-01, PNorm = 34.0684, GNorm = 4.0514, lr_0 = 9.0000e-04
Validation rmse = 0.300817
Validation r2 = 0.264537
Epoch 2
Loss = 5.9656e-01, PNorm = 34.1429, GNorm = 5.9443, lr_0 = 9.8685e-04
Loss = 4.8235e-01, PNorm = 34.2151, GNorm = 2.1755, lr_0 = 9.6533e-04
Validation rmse = 0.283735
Validation r2 = 0.345692
Epoch 3
Loss = 4.4046e-01, PNorm = 34.2873, GNorm = 1.0893, lr_0 = 9.4427e-04
Loss = 4.2264e-01, PNorm = 34.3495, GNorm = 2.1475, lr_0 = 9.2367e-04
Validation rmse = 0.262619
Validation r2 = 0.439460
Epoch 4
Loss = 5.1294e-01, PNorm = 34.4209, GNorm = 5.7575, lr_0 = 9.0153e-04
Loss = 3.2537e-01, PNorm = 34.4782, GNorm = 1.8083, lr_0 = 8.8187e-04
Validation rmse = 0.251888
Validation r2 = 0.484330
Epoch 5
Loss = 2.6737e-01, PNorm = 34.5248, GNorm = 2.2842, lr_0 = 8.6263e-04
Loss = 2.9766e-01, PNorm = 34.5760, GNorm = 0.9161, lr_0 = 8.4381e-04
Validation rmse = 0.246856
Validation r2 = 0.504728
Epoch 6
Loss = 2.7581e-01, PNorm = 34.6203, GNorm = 2.8529, lr_0 = 8.2540e-04
Loss = 3.0788e-01, PNorm = 34.6590, GNorm = 2.2886, lr_0 = 8.0740e-04
Validation rmse = 0.261522
Validation r2 = 0.444132
Epoch 7
Loss = 3.2070e-01, PNorm = 34.7006, GNorm = 2.2321, lr_0 = 7.8979e-04
Validation rmse = 0.252098
Validation r2 = 0.483473
Epoch 8
Loss = 1.6717e-01, PNorm = 34.7454, GNorm = 1.0479, lr_0 = 7.7086e-04
Loss = 2.4648e-01, PNorm = 34.7808, GNorm = 1.3782, lr_0 = 7.5404e-04
Validation rmse = 0.222956
Validation r2 = 0.595988
Epoch 9
Loss = 1.7716e-01, PNorm = 34.8094, GNorm = 0.7039, lr_0 = 7.3759e-04
Loss = 2.2597e-01, PNorm = 34.8367, GNorm = 1.1046, lr_0 = 7.2150e-04
Validation rmse = 0.239988
Validation r2 = 0.531904
Epoch 10
Loss = 2.6992e-01, PNorm = 34.8589, GNorm = 0.9051, lr_0 = 7.0576e-04
Loss = 2.1699e-01, PNorm = 34.8777, GNorm = 4.4522, lr_0 = 6.9037e-04
Validation rmse = 0.225105
Validation r2 = 0.588162
Epoch 11
Loss = 1.8500e-01, PNorm = 34.9092, GNorm = 2.5885, lr_0 = 6.7382e-04
Loss = 2.1389e-01, PNorm = 34.9363, GNorm = 3.8143, lr_0 = 6.5912e-04
Validation rmse = 0.225044
Validation r2 = 0.588388
Epoch 12
Loss = 2.0730e-01, PNorm = 34.9559, GNorm = 3.6633, lr_0 = 6.4474e-04
Loss = 2.1346e-01, PNorm = 34.9735, GNorm = 0.8913, lr_0 = 6.3068e-04
Validation rmse = 0.230128
Validation r2 = 0.569578
Epoch 13
Loss = 1.8810e-01, PNorm = 34.9921, GNorm = 0.8508, lr_0 = 6.1692e-04
Loss = 1.8919e-01, PNorm = 35.0112, GNorm = 3.4954, lr_0 = 6.0346e-04
Validation rmse = 0.223767
Validation r2 = 0.593045
Epoch 14
Loss = 1.7949e-01, PNorm = 35.0323, GNorm = 0.9510, lr_0 = 5.9030e-04
Loss = 2.0191e-01, PNorm = 35.0502, GNorm = 1.5680, lr_0 = 5.7742e-04
Loss = 8.7881e-02, PNorm = 35.0509, GNorm = 1.7538, lr_0 = 5.7615e-04
Validation rmse = 0.223372
Validation r2 = 0.594478
Epoch 15
Loss = 1.7234e-01, PNorm = 35.0640, GNorm = 1.0046, lr_0 = 5.6358e-04
Validation rmse = 0.227281
Validation r2 = 0.580161
Epoch 16
Loss = 2.3671e-01, PNorm = 35.0806, GNorm = 3.1165, lr_0 = 5.5129e-04
Loss = 1.6081e-01, PNorm = 35.0938, GNorm = 3.9244, lr_0 = 5.3926e-04
Validation rmse = 0.230168
Validation r2 = 0.569431
Epoch 17
Loss = 1.9836e-01, PNorm = 35.1103, GNorm = 3.1018, lr_0 = 5.2750e-04
Loss = 1.7955e-01, PNorm = 35.1268, GNorm = 1.2286, lr_0 = 5.1599e-04
Validation rmse = 0.228847
Validation r2 = 0.574355
Epoch 18
Loss = 1.6793e-01, PNorm = 35.1443, GNorm = 1.6676, lr_0 = 5.0362e-04
Loss = 1.7365e-01, PNorm = 35.1591, GNorm = 1.2147, lr_0 = 4.9264e-04
Validation rmse = 0.221633
Validation r2 = 0.600769
Epoch 19
Loss = 1.8733e-01, PNorm = 35.1740, GNorm = 2.1815, lr_0 = 4.8189e-04
Loss = 1.6352e-01, PNorm = 35.1875, GNorm = 1.1094, lr_0 = 4.7138e-04
Validation rmse = 0.216614
Validation r2 = 0.618647
Epoch 20
Loss = 1.5212e-01, PNorm = 35.2033, GNorm = 0.9840, lr_0 = 4.6110e-04
Loss = 1.8782e-01, PNorm = 35.2167, GNorm = 6.2241, lr_0 = 4.5104e-04
Validation rmse = 0.228478
Validation r2 = 0.575729
Epoch 21
Loss = 1.7653e-01, PNorm = 35.2283, GNorm = 2.8995, lr_0 = 4.4120e-04
Loss = 1.7132e-01, PNorm = 35.2431, GNorm = 2.1499, lr_0 = 4.3158e-04
Validation rmse = 0.214674
Validation r2 = 0.625445
Epoch 22
Loss = 1.6829e-01, PNorm = 35.2599, GNorm = 0.6227, lr_0 = 4.2123e-04
Loss = 1.5046e-01, PNorm = 35.2724, GNorm = 1.9164, lr_0 = 4.1204e-04
Validation rmse = 0.216425
Validation r2 = 0.619311
Epoch 23
Loss = 1.6219e-01, PNorm = 35.2828, GNorm = 1.4056, lr_0 = 4.0305e-04
Validation rmse = 0.220272
Validation r2 = 0.605657
Epoch 24
Loss = 2.2953e-01, PNorm = 35.2952, GNorm = 2.8198, lr_0 = 3.9426e-04
Loss = 1.4706e-01, PNorm = 35.3093, GNorm = 1.4940, lr_0 = 3.8566e-04
Validation rmse = 0.220202
Validation r2 = 0.605908
Epoch 25
Loss = 1.4249e-01, PNorm = 35.3197, GNorm = 1.0439, lr_0 = 3.7725e-04
Loss = 1.4520e-01, PNorm = 35.3322, GNorm = 1.5844, lr_0 = 3.6902e-04
Validation rmse = 0.214797
Validation r2 = 0.625016
Epoch 26
Loss = 1.4467e-01, PNorm = 35.3433, GNorm = 1.2843, lr_0 = 3.6017e-04
Loss = 1.6779e-01, PNorm = 35.3523, GNorm = 1.3390, lr_0 = 3.5232e-04
Validation rmse = 0.221368
Validation r2 = 0.601723
Epoch 27
Loss = 1.4196e-01, PNorm = 35.3626, GNorm = 2.4184, lr_0 = 3.4463e-04
Loss = 1.5087e-01, PNorm = 35.3725, GNorm = 1.9414, lr_0 = 3.3711e-04
Validation rmse = 0.223232
Validation r2 = 0.594988
Epoch 28
Loss = 1.4967e-01, PNorm = 35.3859, GNorm = 1.7814, lr_0 = 3.2976e-04
Loss = 1.5344e-01, PNorm = 35.3967, GNorm = 0.8225, lr_0 = 3.2257e-04
Validation rmse = 0.218180
Validation r2 = 0.613111
Epoch 29
Loss = 1.3268e-01, PNorm = 35.4059, GNorm = 1.0044, lr_0 = 3.1484e-04
Loss = 1.4775e-01, PNorm = 35.4165, GNorm = 2.7556, lr_0 = 3.0797e-04
Validation rmse = 0.215091
Validation r2 = 0.623990
Epoch 30
Loss = 1.5823e-01, PNorm = 35.4289, GNorm = 0.5897, lr_0 = 3.0125e-04
Loss = 1.2612e-01, PNorm = 35.4373, GNorm = 0.7754, lr_0 = 2.9468e-04
Validation rmse = 0.214695
Validation r2 = 0.625375
Epoch 31
Loss = 1.3868e-01, PNorm = 35.4460, GNorm = 0.8758, lr_0 = 2.8825e-04
Validation rmse = 0.216511
Validation r2 = 0.619009
Epoch 32
Loss = 1.8980e-01, PNorm = 35.4555, GNorm = 2.2084, lr_0 = 2.8196e-04
Loss = 1.4292e-01, PNorm = 35.4665, GNorm = 2.2720, lr_0 = 2.7581e-04
Validation rmse = 0.216741
Validation r2 = 0.618200
Epoch 33
Loss = 1.2544e-01, PNorm = 35.4744, GNorm = 1.3207, lr_0 = 2.6920e-04
Loss = 1.4642e-01, PNorm = 35.4823, GNorm = 1.1269, lr_0 = 2.6333e-04
Validation rmse = 0.214126
Validation r2 = 0.627356
Epoch 34
Loss = 1.2777e-01, PNorm = 35.4901, GNorm = 1.6572, lr_0 = 2.5758e-04
Loss = 1.4819e-01, PNorm = 35.5006, GNorm = 4.2470, lr_0 = 2.5197e-04
Validation rmse = 0.219909
Validation r2 = 0.606955
Epoch 35
Loss = 1.3537e-01, PNorm = 35.5057, GNorm = 1.2547, lr_0 = 2.4647e-04
Loss = 1.3425e-01, PNorm = 35.5152, GNorm = 2.8088, lr_0 = 2.4109e-04
Validation rmse = 0.221160
Validation r2 = 0.602470
Epoch 36
Loss = 1.4513e-01, PNorm = 35.5226, GNorm = 1.1362, lr_0 = 2.3531e-04
Loss = 1.4417e-01, PNorm = 35.5293, GNorm = 1.0467, lr_0 = 2.3018e-04
Validation rmse = 0.218107
Validation r2 = 0.613370
Epoch 37
Loss = 1.3478e-01, PNorm = 35.5365, GNorm = 2.7686, lr_0 = 2.2516e-04
Loss = 1.4198e-01, PNorm = 35.5430, GNorm = 0.8519, lr_0 = 2.2025e-04
Validation rmse = 0.214566
Validation r2 = 0.625825
Epoch 38
Loss = 1.4207e-01, PNorm = 35.5519, GNorm = 4.9366, lr_0 = 2.1544e-04
Loss = 1.5879e-01, PNorm = 35.5603, GNorm = 2.5657, lr_0 = 2.1074e-04
Validation rmse = 0.215751
Validation r2 = 0.621677
Epoch 39
Loss = 1.1635e-01, PNorm = 35.5679, GNorm = 1.7783, lr_0 = 2.0615e-04
Validation rmse = 0.220740
Validation r2 = 0.603980
Epoch 40
Loss = 1.4069e-01, PNorm = 35.5771, GNorm = 2.5035, lr_0 = 2.0121e-04
Loss = 1.4193e-01, PNorm = 35.5819, GNorm = 1.3825, lr_0 = 1.9682e-04
Validation rmse = 0.220871
Validation r2 = 0.603510
Epoch 41
Loss = 1.4627e-01, PNorm = 35.5903, GNorm = 2.1745, lr_0 = 1.9252e-04
Loss = 1.2772e-01, PNorm = 35.5968, GNorm = 1.2306, lr_0 = 1.8832e-04
Validation rmse = 0.216443
Validation r2 = 0.619248
Epoch 42
Loss = 1.3089e-01, PNorm = 35.6028, GNorm = 1.1800, lr_0 = 1.8422e-04
Loss = 1.2938e-01, PNorm = 35.6091, GNorm = 1.9376, lr_0 = 1.8020e-04
Validation rmse = 0.219491
Validation r2 = 0.608449
Epoch 43
Loss = 1.1263e-01, PNorm = 35.6150, GNorm = 1.0776, lr_0 = 1.7588e-04
Loss = 1.3446e-01, PNorm = 35.6206, GNorm = 1.6016, lr_0 = 1.7204e-04
Validation rmse = 0.218002
Validation r2 = 0.613743
Epoch 44
Loss = 1.2520e-01, PNorm = 35.6262, GNorm = 0.7489, lr_0 = 1.6829e-04
Loss = 1.3168e-01, PNorm = 35.6323, GNorm = 0.5859, lr_0 = 1.6462e-04
Validation rmse = 0.219592
Validation r2 = 0.608089
Epoch 45
Loss = 1.3185e-01, PNorm = 35.6369, GNorm = 0.9060, lr_0 = 1.6103e-04
Loss = 1.1985e-01, PNorm = 35.6412, GNorm = 0.7244, lr_0 = 1.5751e-04
Validation rmse = 0.215303
Validation r2 = 0.623249
Epoch 46
Loss = 1.2396e-01, PNorm = 35.6467, GNorm = 0.5321, lr_0 = 1.5408e-04
Validation rmse = 0.214257
Validation r2 = 0.626899
Epoch 47
Loss = 1.0188e-01, PNorm = 35.6525, GNorm = 0.9910, lr_0 = 1.5038e-04
Loss = 1.2748e-01, PNorm = 35.6579, GNorm = 2.4900, lr_0 = 1.4710e-04
Validation rmse = 0.217608
Validation r2 = 0.615138
Epoch 48
Loss = 1.0815e-01, PNorm = 35.6640, GNorm = 2.0690, lr_0 = 1.4390e-04
Loss = 1.4897e-01, PNorm = 35.6683, GNorm = 2.4730, lr_0 = 1.4076e-04
Validation rmse = 0.215415
Validation r2 = 0.622857
Epoch 49
Loss = 1.4080e-01, PNorm = 35.6721, GNorm = 0.6302, lr_0 = 1.3769e-04
Loss = 1.2035e-01, PNorm = 35.6779, GNorm = 1.2632, lr_0 = 1.3468e-04
Validation rmse = 0.219550
Validation r2 = 0.608239
Epoch 50
Loss = 1.4676e-01, PNorm = 35.6824, GNorm = 1.2825, lr_0 = 1.3174e-04
Loss = 1.0886e-01, PNorm = 35.6869, GNorm = 0.6852, lr_0 = 1.2887e-04
Validation rmse = 0.216978
Validation r2 = 0.617362
Epoch 51
Loss = 1.3504e-01, PNorm = 35.6916, GNorm = 1.1533, lr_0 = 1.2578e-04
Loss = 1.1489e-01, PNorm = 35.6958, GNorm = 1.1714, lr_0 = 1.2304e-04
Validation rmse = 0.216447
Validation r2 = 0.619235
Epoch 52
Loss = 1.0732e-01, PNorm = 35.6996, GNorm = 0.7979, lr_0 = 1.2035e-04
Loss = 1.2930e-01, PNorm = 35.7030, GNorm = 1.8259, lr_0 = 1.1773e-04
Validation rmse = 0.215988
Validation r2 = 0.620848
Epoch 53
Loss = 1.3163e-01, PNorm = 35.7075, GNorm = 1.2785, lr_0 = 1.1516e-04
Loss = 1.0844e-01, PNorm = 35.7112, GNorm = 1.4695, lr_0 = 1.1265e-04
Loss = 1.9571e-01, PNorm = 35.7118, GNorm = 3.8162, lr_0 = 1.1240e-04
Validation rmse = 0.218671
Validation r2 = 0.611369
Epoch 54
Loss = 1.1441e-01, PNorm = 35.7151, GNorm = 0.7364, lr_0 = 1.0995e-04
Validation rmse = 0.215954
Validation r2 = 0.620967
Epoch 55
Loss = 1.5339e-01, PNorm = 35.7189, GNorm = 1.4848, lr_0 = 1.0755e-04
Loss = 1.3210e-01, PNorm = 35.7233, GNorm = 0.7355, lr_0 = 1.0520e-04
Validation rmse = 0.217132
Validation r2 = 0.616820
Epoch 56
Loss = 1.2106e-01, PNorm = 35.7265, GNorm = 2.7055, lr_0 = 1.0291e-04
Loss = 1.1969e-01, PNorm = 35.7311, GNorm = 0.5733, lr_0 = 1.0066e-04
Validation rmse = 0.218413
Validation r2 = 0.612287
Epoch 57
Loss = 9.4246e-02, PNorm = 35.7348, GNorm = 1.0903, lr_0 = 1.0000e-04
Loss = 1.3526e-01, PNorm = 35.7372, GNorm = 2.4499, lr_0 = 1.0000e-04
Validation rmse = 0.218811
Validation r2 = 0.610870
Epoch 58
Loss = 1.2837e-01, PNorm = 35.7413, GNorm = 2.5575, lr_0 = 1.0000e-04
Loss = 1.1969e-01, PNorm = 35.7453, GNorm = 1.1642, lr_0 = 1.0000e-04
Validation rmse = 0.214240
Validation r2 = 0.626961
Epoch 59
Loss = 1.0144e-01, PNorm = 35.7492, GNorm = 1.8518, lr_0 = 1.0000e-04
Loss = 1.1508e-01, PNorm = 35.7526, GNorm = 0.8325, lr_0 = 1.0000e-04
Validation rmse = 0.218541
Validation r2 = 0.611833
Model 0 best validation rmse = 0.214126 on epoch 33
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.155268
Model 0 test r2 = 0.781917
Ensemble test rmse = 0.155268
Ensemble test r2 = 0.781917
1-fold cross validation
	Seed 0 ==> test rmse = 0.155268
	Seed 0 ==> test r2 = 0.781917
Overall test rmse = 0.155268 +/- 0.000000
Overall test r2 = 0.781917 +/- 0.000000
Elapsed time = 0:00:41
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/bin/chemprop_train --data_path ./data/train_dm300_full.csv --dataset_type regression --save_dir ./train_results/original/ --quiet --smiles_columns full_smiles --target_columns dm300 --epochs 60 --extra_metrics r2 --num_folds 10
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 10,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './train_results/original/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,170 | train size = 936 | val size = 117 | test size = 117
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.5445e-01, PNorm = 34.0143, GNorm = 6.1226, lr_0 = 3.7500e-04
Validation rmse = 0.335007
Validation r2 = 0.087858
Epoch 1
Loss = 1.0399e+00, PNorm = 34.0300, GNorm = 6.0447, lr_0 = 6.5000e-04
Loss = 7.1397e-01, PNorm = 34.0684, GNorm = 4.0514, lr_0 = 9.0000e-04
Validation rmse = 0.300821
Validation r2 = 0.264522
Epoch 2
Loss = 5.9651e-01, PNorm = 34.1429, GNorm = 5.9406, lr_0 = 9.8685e-04
Loss = 4.8246e-01, PNorm = 34.2150, GNorm = 2.1850, lr_0 = 9.6533e-04
Validation rmse = 0.283800
Validation r2 = 0.345394
Epoch 3
Loss = 4.4177e-01, PNorm = 34.2870, GNorm = 0.8932, lr_0 = 9.4427e-04
Loss = 4.2619e-01, PNorm = 34.3488, GNorm = 2.0718, lr_0 = 9.2367e-04
Validation rmse = 0.263291
Validation r2 = 0.436588
Epoch 4
Loss = 5.1110e-01, PNorm = 34.4206, GNorm = 5.5670, lr_0 = 9.0153e-04
Loss = 3.2590e-01, PNorm = 34.4781, GNorm = 2.0561, lr_0 = 8.8187e-04
Validation rmse = 0.251551
Validation r2 = 0.485713
Epoch 5
Loss = 2.6525e-01, PNorm = 34.5251, GNorm = 2.2229, lr_0 = 8.6263e-04
Loss = 2.9653e-01, PNorm = 34.5759, GNorm = 0.7067, lr_0 = 8.4381e-04
Validation rmse = 0.246586
Validation r2 = 0.505812
Epoch 6
Loss = 2.7336e-01, PNorm = 34.6203, GNorm = 2.3176, lr_0 = 8.2540e-04
Loss = 3.0041e-01, PNorm = 34.6588, GNorm = 1.9811, lr_0 = 8.0740e-04
Validation rmse = 0.263927
Validation r2 = 0.433864
Epoch 7
Loss = 3.2157e-01, PNorm = 34.7010, GNorm = 2.3014, lr_0 = 7.8979e-04
Validation rmse = 0.253959
Validation r2 = 0.475818
Epoch 8
Loss = 1.6610e-01, PNorm = 34.7462, GNorm = 0.8658, lr_0 = 7.7086e-04
Loss = 2.4514e-01, PNorm = 34.7814, GNorm = 1.1173, lr_0 = 7.5404e-04
Validation rmse = 0.222814
Validation r2 = 0.596503
Epoch 9
Loss = 1.7693e-01, PNorm = 34.8110, GNorm = 0.7009, lr_0 = 7.3759e-04
Loss = 2.2685e-01, PNorm = 34.8399, GNorm = 0.7861, lr_0 = 7.2150e-04
Validation rmse = 0.238961
Validation r2 = 0.535904
Epoch 10
Loss = 2.6374e-01, PNorm = 34.8636, GNorm = 0.9605, lr_0 = 7.0576e-04
Loss = 2.1318e-01, PNorm = 34.8831, GNorm = 4.3800, lr_0 = 6.9037e-04
Validation rmse = 0.226777
Validation r2 = 0.582022
Epoch 11
Loss = 1.8421e-01, PNorm = 34.9159, GNorm = 2.8429, lr_0 = 6.7382e-04
Loss = 2.1529e-01, PNorm = 34.9425, GNorm = 4.3957, lr_0 = 6.5912e-04
Validation rmse = 0.224492
Validation r2 = 0.590404
Epoch 12
Loss = 2.0813e-01, PNorm = 34.9620, GNorm = 3.8098, lr_0 = 6.4474e-04
Loss = 2.1365e-01, PNorm = 34.9802, GNorm = 1.0195, lr_0 = 6.3068e-04
Validation rmse = 0.232849
Validation r2 = 0.559341
Epoch 13
Loss = 1.8886e-01, PNorm = 34.9995, GNorm = 0.7515, lr_0 = 6.1692e-04
Loss = 1.8971e-01, PNorm = 35.0184, GNorm = 3.8306, lr_0 = 6.0346e-04
Validation rmse = 0.225875
Validation r2 = 0.585340
Epoch 14
Loss = 1.7861e-01, PNorm = 35.0388, GNorm = 0.8958, lr_0 = 5.9030e-04
Loss = 2.0114e-01, PNorm = 35.0571, GNorm = 1.5368, lr_0 = 5.7742e-04
Loss = 8.8742e-02, PNorm = 35.0578, GNorm = 1.7876, lr_0 = 5.7615e-04
Validation rmse = 0.223085
Validation r2 = 0.595522
Epoch 15
Loss = 1.7211e-01, PNorm = 35.0692, GNorm = 0.9990, lr_0 = 5.6358e-04
Validation rmse = 0.227958
Validation r2 = 0.577656
Epoch 16
Loss = 2.3084e-01, PNorm = 35.0847, GNorm = 2.8195, lr_0 = 5.5129e-04
Loss = 1.5891e-01, PNorm = 35.0970, GNorm = 3.6730, lr_0 = 5.3926e-04
Validation rmse = 0.229921
Validation r2 = 0.570352
Epoch 17
Loss = 1.9337e-01, PNorm = 35.1133, GNorm = 2.8854, lr_0 = 5.2750e-04
Loss = 1.7834e-01, PNorm = 35.1297, GNorm = 1.4094, lr_0 = 5.1599e-04
Validation rmse = 0.229530
Validation r2 = 0.571814
Epoch 18
Loss = 1.6543e-01, PNorm = 35.1462, GNorm = 1.7287, lr_0 = 5.0362e-04
Loss = 1.7384e-01, PNorm = 35.1606, GNorm = 1.1391, lr_0 = 4.9264e-04
Validation rmse = 0.221618
Validation r2 = 0.600823
Epoch 19
Loss = 1.8505e-01, PNorm = 35.1749, GNorm = 2.1436, lr_0 = 4.8189e-04
Loss = 1.6466e-01, PNorm = 35.1881, GNorm = 1.2826, lr_0 = 4.7138e-04
Validation rmse = 0.216871
Validation r2 = 0.617741
Epoch 20
Loss = 1.5169e-01, PNorm = 35.2036, GNorm = 1.0856, lr_0 = 4.6110e-04
Loss = 1.8794e-01, PNorm = 35.2168, GNorm = 6.4148, lr_0 = 4.5104e-04
Validation rmse = 0.227782
Validation r2 = 0.578310
Epoch 21
Loss = 1.7252e-01, PNorm = 35.2284, GNorm = 2.6978, lr_0 = 4.4120e-04
Loss = 1.7117e-01, PNorm = 35.2438, GNorm = 2.0266, lr_0 = 4.3158e-04
Validation rmse = 0.216371
Validation r2 = 0.619502
Epoch 22
Loss = 1.6769e-01, PNorm = 35.2598, GNorm = 0.6030, lr_0 = 4.2123e-04
Loss = 1.4886e-01, PNorm = 35.2719, GNorm = 1.8746, lr_0 = 4.1204e-04
Validation rmse = 0.218143
Validation r2 = 0.613244
Epoch 23
Loss = 1.6231e-01, PNorm = 35.2814, GNorm = 1.4349, lr_0 = 4.0305e-04
Validation rmse = 0.220372
Validation r2 = 0.605300
Epoch 24
Loss = 2.2711e-01, PNorm = 35.2932, GNorm = 2.8237, lr_0 = 3.9426e-04
Loss = 1.4732e-01, PNorm = 35.3062, GNorm = 1.5254, lr_0 = 3.8566e-04
Validation rmse = 0.221200
Validation r2 = 0.602327
Epoch 25
Loss = 1.4244e-01, PNorm = 35.3162, GNorm = 0.9219, lr_0 = 3.7725e-04
Loss = 1.4529e-01, PNorm = 35.3273, GNorm = 1.2883, lr_0 = 3.6902e-04
Validation rmse = 0.215874
Validation r2 = 0.621247
Epoch 26
Loss = 1.4581e-01, PNorm = 35.3377, GNorm = 1.1611, lr_0 = 3.6017e-04
Loss = 1.6875e-01, PNorm = 35.3458, GNorm = 1.2661, lr_0 = 3.5232e-04
Validation rmse = 0.222309
Validation r2 = 0.598330
Epoch 27
Loss = 1.4154e-01, PNorm = 35.3561, GNorm = 2.4918, lr_0 = 3.4463e-04
Loss = 1.5124e-01, PNorm = 35.3663, GNorm = 2.0022, lr_0 = 3.3711e-04
Validation rmse = 0.222885
Validation r2 = 0.596246
Epoch 28
Loss = 1.4821e-01, PNorm = 35.3794, GNorm = 1.8226, lr_0 = 3.2976e-04
Loss = 1.5331e-01, PNorm = 35.3888, GNorm = 0.8036, lr_0 = 3.2257e-04
Validation rmse = 0.218559
Validation r2 = 0.611767
Epoch 29
Loss = 1.3343e-01, PNorm = 35.3969, GNorm = 0.9282, lr_0 = 3.1484e-04
Loss = 1.4818e-01, PNorm = 35.4068, GNorm = 2.6794, lr_0 = 3.0797e-04
Validation rmse = 0.215286
Validation r2 = 0.623307
Epoch 30
Loss = 1.5932e-01, PNorm = 35.4187, GNorm = 0.5792, lr_0 = 3.0125e-04
Loss = 1.2628e-01, PNorm = 35.4267, GNorm = 0.8550, lr_0 = 2.9468e-04
Validation rmse = 0.215492
Validation r2 = 0.622588
Epoch 31
Loss = 1.3990e-01, PNorm = 35.4349, GNorm = 0.8632, lr_0 = 2.8825e-04
Validation rmse = 0.217480
Validation r2 = 0.615592
Epoch 32
Loss = 1.9150e-01, PNorm = 35.4442, GNorm = 2.3558, lr_0 = 2.8196e-04
Loss = 1.4376e-01, PNorm = 35.4546, GNorm = 2.1992, lr_0 = 2.7581e-04
Validation rmse = 0.217347
Validation r2 = 0.616061
Epoch 33
Loss = 1.2483e-01, PNorm = 35.4621, GNorm = 1.2520, lr_0 = 2.6920e-04
Loss = 1.4712e-01, PNorm = 35.4694, GNorm = 1.1739, lr_0 = 2.6333e-04
Validation rmse = 0.215232
Validation r2 = 0.623497
Epoch 34
Loss = 1.2965e-01, PNorm = 35.4773, GNorm = 1.7495, lr_0 = 2.5758e-04
Loss = 1.4797e-01, PNorm = 35.4875, GNorm = 4.1700, lr_0 = 2.5197e-04
Validation rmse = 0.221106
Validation r2 = 0.602666
Epoch 35
Loss = 1.3756e-01, PNorm = 35.4929, GNorm = 1.1243, lr_0 = 2.4647e-04
Loss = 1.3374e-01, PNorm = 35.5021, GNorm = 2.7158, lr_0 = 2.4109e-04
Validation rmse = 0.221827
Validation r2 = 0.600069
Epoch 36
Loss = 1.4502e-01, PNorm = 35.5085, GNorm = 1.0856, lr_0 = 2.3531e-04
Loss = 1.4401e-01, PNorm = 35.5149, GNorm = 1.1215, lr_0 = 2.3018e-04
Validation rmse = 0.218541
Validation r2 = 0.611830
Epoch 37
Loss = 1.3463e-01, PNorm = 35.5220, GNorm = 2.6700, lr_0 = 2.2516e-04
Loss = 1.4402e-01, PNorm = 35.5287, GNorm = 0.8278, lr_0 = 2.2025e-04
Validation rmse = 0.215337
Validation r2 = 0.623131
Epoch 38
Loss = 1.4339e-01, PNorm = 35.5376, GNorm = 4.9563, lr_0 = 2.1544e-04
Loss = 1.5977e-01, PNorm = 35.5453, GNorm = 2.6911, lr_0 = 2.1074e-04
Validation rmse = 0.216834
Validation r2 = 0.617870
Epoch 39
Loss = 1.1720e-01, PNorm = 35.5525, GNorm = 1.6466, lr_0 = 2.0615e-04
Validation rmse = 0.221038
Validation r2 = 0.602911
Epoch 40
Loss = 1.4000e-01, PNorm = 35.5611, GNorm = 2.2074, lr_0 = 2.0121e-04
Loss = 1.4134e-01, PNorm = 35.5652, GNorm = 1.5331, lr_0 = 1.9682e-04
Validation rmse = 0.221078
Validation r2 = 0.602767
Epoch 41
Loss = 1.4771e-01, PNorm = 35.5738, GNorm = 2.2567, lr_0 = 1.9252e-04
Loss = 1.2956e-01, PNorm = 35.5804, GNorm = 1.1371, lr_0 = 1.8832e-04
Validation rmse = 0.217525
Validation r2 = 0.615430
Epoch 42
Loss = 1.3142e-01, PNorm = 35.5864, GNorm = 0.9640, lr_0 = 1.8422e-04
Loss = 1.3028e-01, PNorm = 35.5926, GNorm = 1.9796, lr_0 = 1.8020e-04
Validation rmse = 0.219820
Validation r2 = 0.607274
Epoch 43
Loss = 1.1242e-01, PNorm = 35.5982, GNorm = 1.0015, lr_0 = 1.7588e-04
Loss = 1.3448e-01, PNorm = 35.6034, GNorm = 1.4193, lr_0 = 1.7204e-04
Validation rmse = 0.217500
Validation r2 = 0.615520
Epoch 44
Loss = 1.2547e-01, PNorm = 35.6087, GNorm = 0.6876, lr_0 = 1.6829e-04
Loss = 1.3141e-01, PNorm = 35.6146, GNorm = 0.5963, lr_0 = 1.6462e-04
Validation rmse = 0.220598
Validation r2 = 0.604488
Epoch 45
Loss = 1.3302e-01, PNorm = 35.6191, GNorm = 0.8818, lr_0 = 1.6103e-04
Loss = 1.2015e-01, PNorm = 35.6230, GNorm = 0.6957, lr_0 = 1.5751e-04
Validation rmse = 0.215738
Validation r2 = 0.621726
Epoch 46
Loss = 1.2466e-01, PNorm = 35.6285, GNorm = 0.6918, lr_0 = 1.5408e-04
Validation rmse = 0.214868
Validation r2 = 0.624768
Epoch 47
Loss = 1.0284e-01, PNorm = 35.6345, GNorm = 1.0362, lr_0 = 1.5038e-04
Loss = 1.2790e-01, PNorm = 35.6399, GNorm = 2.4141, lr_0 = 1.4710e-04
Validation rmse = 0.218280
Validation r2 = 0.612756
Epoch 48
Loss = 1.0873e-01, PNorm = 35.6460, GNorm = 2.0590, lr_0 = 1.4390e-04
Loss = 1.4871e-01, PNorm = 35.6502, GNorm = 2.4022, lr_0 = 1.4076e-04
Validation rmse = 0.216820
Validation r2 = 0.617919
Epoch 49
Loss = 1.4524e-01, PNorm = 35.6539, GNorm = 0.6138, lr_0 = 1.3769e-04
Loss = 1.2029e-01, PNorm = 35.6595, GNorm = 1.1980, lr_0 = 1.3468e-04
Validation rmse = 0.220189
Validation r2 = 0.605954
Epoch 50
Loss = 1.4799e-01, PNorm = 35.6641, GNorm = 1.2923, lr_0 = 1.3174e-04
Loss = 1.0940e-01, PNorm = 35.6687, GNorm = 0.7381, lr_0 = 1.2887e-04
Validation rmse = 0.217167
Validation r2 = 0.616698
Epoch 51
Loss = 1.3587e-01, PNorm = 35.6733, GNorm = 1.2253, lr_0 = 1.2578e-04
Loss = 1.1585e-01, PNorm = 35.6774, GNorm = 1.2160, lr_0 = 1.2304e-04
Validation rmse = 0.216995
Validation r2 = 0.617304
Epoch 52
Loss = 1.0796e-01, PNorm = 35.6809, GNorm = 0.7793, lr_0 = 1.2035e-04
Loss = 1.2984e-01, PNorm = 35.6844, GNorm = 1.7976, lr_0 = 1.1773e-04
Validation rmse = 0.216864
Validation r2 = 0.617767
Epoch 53
Loss = 1.3240e-01, PNorm = 35.6888, GNorm = 1.2464, lr_0 = 1.1516e-04
Loss = 1.0963e-01, PNorm = 35.6925, GNorm = 1.4289, lr_0 = 1.1265e-04
Loss = 1.9506e-01, PNorm = 35.6931, GNorm = 3.7097, lr_0 = 1.1240e-04
Validation rmse = 0.219137
Validation r2 = 0.609712
Epoch 54
Loss = 1.1404e-01, PNorm = 35.6966, GNorm = 0.8441, lr_0 = 1.0995e-04
Validation rmse = 0.217035
Validation r2 = 0.617162
Epoch 55
Loss = 1.5396e-01, PNorm = 35.7004, GNorm = 1.3600, lr_0 = 1.0755e-04
Loss = 1.3302e-01, PNorm = 35.7047, GNorm = 0.7847, lr_0 = 1.0520e-04
Validation rmse = 0.216994
Validation r2 = 0.617308
Epoch 56
Loss = 1.2260e-01, PNorm = 35.7079, GNorm = 2.6970, lr_0 = 1.0291e-04
Loss = 1.2120e-01, PNorm = 35.7127, GNorm = 0.5647, lr_0 = 1.0066e-04
Validation rmse = 0.218972
Validation r2 = 0.610298
Epoch 57
Loss = 9.4053e-02, PNorm = 35.7164, GNorm = 0.9983, lr_0 = 1.0000e-04
Loss = 1.3631e-01, PNorm = 35.7187, GNorm = 2.5247, lr_0 = 1.0000e-04
Validation rmse = 0.219773
Validation r2 = 0.607444
Epoch 58
Loss = 1.2775e-01, PNorm = 35.7228, GNorm = 2.3234, lr_0 = 1.0000e-04
Loss = 1.2089e-01, PNorm = 35.7268, GNorm = 1.2635, lr_0 = 1.0000e-04
Validation rmse = 0.214497
Validation r2 = 0.626065
Epoch 59
Loss = 1.0346e-01, PNorm = 35.7308, GNorm = 1.7716, lr_0 = 1.0000e-04
Loss = 1.1531e-01, PNorm = 35.7343, GNorm = 0.7920, lr_0 = 1.0000e-04
Validation rmse = 0.219597
Validation r2 = 0.608071
Model 0 best validation rmse = 0.214497 on epoch 58
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.154185
Model 0 test r2 = 0.784949
Ensemble test rmse = 0.154185
Ensemble test r2 = 0.784949
Fold 1
Splitting data with seed 1
Total size = 1,170 | train size = 936 | val size = 117 | test size = 117
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.0073e+00, PNorm = 34.0151, GNorm = 2.3578, lr_0 = 3.7500e-04
Validation rmse = 0.277993
Validation r2 = 0.304889
Epoch 1
Loss = 1.0277e+00, PNorm = 34.0390, GNorm = 9.9259, lr_0 = 6.5000e-04
Loss = 7.1110e-01, PNorm = 34.0769, GNorm = 1.9217, lr_0 = 9.0000e-04
Validation rmse = 0.247259
Validation r2 = 0.450088
Epoch 2
Loss = 5.3802e-01, PNorm = 34.1493, GNorm = 8.3108, lr_0 = 9.8685e-04
Loss = 5.1271e-01, PNorm = 34.2310, GNorm = 1.6532, lr_0 = 9.6533e-04
Validation rmse = 0.217291
Validation r2 = 0.575310
Epoch 3
Loss = 5.4356e-01, PNorm = 34.3027, GNorm = 5.3107, lr_0 = 9.4427e-04
Loss = 3.8118e-01, PNorm = 34.3686, GNorm = 5.8567, lr_0 = 9.2367e-04
Validation rmse = 0.186718
Validation r2 = 0.686410
Epoch 4
Loss = 3.4832e-01, PNorm = 34.4307, GNorm = 5.2093, lr_0 = 9.0153e-04
Loss = 3.4255e-01, PNorm = 34.4754, GNorm = 3.9970, lr_0 = 8.8187e-04
Validation rmse = 0.182462
Validation r2 = 0.700545
Epoch 5
Loss = 3.3748e-01, PNorm = 34.5210, GNorm = 3.6835, lr_0 = 8.6263e-04
Loss = 3.1903e-01, PNorm = 34.5619, GNorm = 2.6620, lr_0 = 8.4381e-04
Validation rmse = 0.181820
Validation r2 = 0.702649
Epoch 6
Loss = 3.1211e-01, PNorm = 34.6027, GNorm = 7.1030, lr_0 = 8.2540e-04
Loss = 3.7468e-01, PNorm = 34.6383, GNorm = 2.8879, lr_0 = 8.0740e-04
Validation rmse = 0.166991
Validation r2 = 0.749174
Epoch 7
Loss = 3.0608e-01, PNorm = 34.6774, GNorm = 2.3504, lr_0 = 7.8979e-04
Validation rmse = 0.145464
Validation r2 = 0.809673
Epoch 8
Loss = 3.0037e-01, PNorm = 34.7146, GNorm = 2.8266, lr_0 = 7.7086e-04
Loss = 2.2964e-01, PNorm = 34.7454, GNorm = 1.2387, lr_0 = 7.5404e-04
Validation rmse = 0.145527
Validation r2 = 0.809509
Epoch 9
Loss = 2.2541e-01, PNorm = 34.7732, GNorm = 3.4733, lr_0 = 7.3759e-04
Loss = 2.9204e-01, PNorm = 34.8025, GNorm = 2.0086, lr_0 = 7.2150e-04
Validation rmse = 0.142897
Validation r2 = 0.816333
Epoch 10
Loss = 1.6880e-01, PNorm = 34.8248, GNorm = 1.0715, lr_0 = 7.0576e-04
Loss = 2.3126e-01, PNorm = 34.8457, GNorm = 1.3794, lr_0 = 6.9037e-04
Validation rmse = 0.137395
Validation r2 = 0.830203
Epoch 11
Loss = 2.3061e-01, PNorm = 34.8715, GNorm = 5.8675, lr_0 = 6.7382e-04
Loss = 2.5123e-01, PNorm = 34.8909, GNorm = 0.9398, lr_0 = 6.5912e-04
Validation rmse = 0.141577
Validation r2 = 0.819710
Epoch 12
Loss = 1.6715e-01, PNorm = 34.9167, GNorm = 1.8396, lr_0 = 6.4474e-04
Loss = 2.8133e-01, PNorm = 34.9319, GNorm = 4.8429, lr_0 = 6.3068e-04
Validation rmse = 0.151167
Validation r2 = 0.794458
Epoch 13
Loss = 2.3181e-01, PNorm = 34.9537, GNorm = 2.2047, lr_0 = 6.1692e-04
Loss = 2.2600e-01, PNorm = 34.9759, GNorm = 1.8701, lr_0 = 6.0346e-04
Validation rmse = 0.138219
Validation r2 = 0.828160
Epoch 14
Loss = 1.7999e-01, PNorm = 34.9921, GNorm = 1.5877, lr_0 = 5.9030e-04
Loss = 2.2660e-01, PNorm = 35.0114, GNorm = 4.7213, lr_0 = 5.7742e-04
Loss = 3.6923e-01, PNorm = 35.0137, GNorm = 2.8857, lr_0 = 5.7615e-04
Validation rmse = 0.134530
Validation r2 = 0.837210
Epoch 15
Loss = 2.0509e-01, PNorm = 35.0339, GNorm = 5.9224, lr_0 = 5.6358e-04
Validation rmse = 0.134432
Validation r2 = 0.837448
Epoch 16
Loss = 1.7823e-01, PNorm = 35.0514, GNorm = 1.1801, lr_0 = 5.5129e-04
Loss = 1.8244e-01, PNorm = 35.0651, GNorm = 1.1541, lr_0 = 5.3926e-04
Validation rmse = 0.139119
Validation r2 = 0.825916
Epoch 17
Loss = 2.2864e-01, PNorm = 35.0840, GNorm = 2.3705, lr_0 = 5.2750e-04
Loss = 2.1159e-01, PNorm = 35.0996, GNorm = 4.7784, lr_0 = 5.1599e-04
Validation rmse = 0.143586
Validation r2 = 0.814555
Epoch 18
Loss = 2.1732e-01, PNorm = 35.1167, GNorm = 2.3146, lr_0 = 5.0362e-04
Loss = 1.9667e-01, PNorm = 35.1353, GNorm = 2.2671, lr_0 = 4.9264e-04
Validation rmse = 0.142167
Validation r2 = 0.818204
Epoch 19
Loss = 2.1990e-01, PNorm = 35.1430, GNorm = 1.3097, lr_0 = 4.8189e-04
Loss = 1.6912e-01, PNorm = 35.1574, GNorm = 3.6912, lr_0 = 4.7138e-04
Validation rmse = 0.139016
Validation r2 = 0.826174
Epoch 20
Loss = 1.5882e-01, PNorm = 35.1748, GNorm = 1.3638, lr_0 = 4.6110e-04
Loss = 1.9759e-01, PNorm = 35.1885, GNorm = 2.2126, lr_0 = 4.5104e-04
Validation rmse = 0.133356
Validation r2 = 0.840040
Epoch 21
Loss = 2.0984e-01, PNorm = 35.2040, GNorm = 2.5181, lr_0 = 4.4120e-04
Loss = 1.7474e-01, PNorm = 35.2204, GNorm = 2.1184, lr_0 = 4.3158e-04
Validation rmse = 0.133702
Validation r2 = 0.839208
Epoch 22
Loss = 1.7894e-01, PNorm = 35.2340, GNorm = 1.0489, lr_0 = 4.2123e-04
Loss = 1.7989e-01, PNorm = 35.2477, GNorm = 0.5158, lr_0 = 4.1204e-04
Validation rmse = 0.134067
Validation r2 = 0.838328
Epoch 23
Loss = 1.7019e-01, PNorm = 35.2600, GNorm = 1.3078, lr_0 = 4.0305e-04
Validation rmse = 0.131024
Validation r2 = 0.845586
Epoch 24
Loss = 1.5984e-01, PNorm = 35.2742, GNorm = 3.0602, lr_0 = 3.9426e-04
Loss = 1.8282e-01, PNorm = 35.2879, GNorm = 1.8055, lr_0 = 3.8566e-04
Validation rmse = 0.132128
Validation r2 = 0.842973
Epoch 25
Loss = 1.7261e-01, PNorm = 35.3015, GNorm = 0.8820, lr_0 = 3.7725e-04
Loss = 1.7566e-01, PNorm = 35.3135, GNorm = 3.8389, lr_0 = 3.6902e-04
Validation rmse = 0.130655
Validation r2 = 0.846453
Epoch 26
Loss = 1.6878e-01, PNorm = 35.3265, GNorm = 1.1539, lr_0 = 3.6017e-04
Loss = 1.7721e-01, PNorm = 35.3400, GNorm = 1.3725, lr_0 = 3.5232e-04
Validation rmse = 0.131367
Validation r2 = 0.844776
Epoch 27
Loss = 2.0757e-01, PNorm = 35.3505, GNorm = 0.9726, lr_0 = 3.4463e-04
Loss = 1.3887e-01, PNorm = 35.3627, GNorm = 0.5167, lr_0 = 3.3711e-04
Validation rmse = 0.138407
Validation r2 = 0.827692
Epoch 28
Loss = 1.5716e-01, PNorm = 35.3732, GNorm = 1.3609, lr_0 = 3.2976e-04
Loss = 1.7879e-01, PNorm = 35.3859, GNorm = 2.3163, lr_0 = 3.2257e-04
Validation rmse = 0.129739
Validation r2 = 0.848599
Epoch 29
Loss = 1.7152e-01, PNorm = 35.3977, GNorm = 1.4484, lr_0 = 3.1484e-04
Loss = 1.5682e-01, PNorm = 35.4084, GNorm = 1.7311, lr_0 = 3.0797e-04
Validation rmse = 0.131537
Validation r2 = 0.844373
Epoch 30
Loss = 1.7790e-01, PNorm = 35.4189, GNorm = 0.8106, lr_0 = 3.0125e-04
Loss = 1.4880e-01, PNorm = 35.4286, GNorm = 1.3940, lr_0 = 2.9468e-04
Validation rmse = 0.134530
Validation r2 = 0.837211
Epoch 31
Loss = 1.6313e-01, PNorm = 35.4413, GNorm = 0.7573, lr_0 = 2.8825e-04
Validation rmse = 0.131029
Validation r2 = 0.845574
Epoch 32
Loss = 1.2654e-01, PNorm = 35.4516, GNorm = 1.2388, lr_0 = 2.8196e-04
Loss = 1.6647e-01, PNorm = 35.4625, GNorm = 1.3390, lr_0 = 2.7581e-04
Validation rmse = 0.131617
Validation r2 = 0.844184
Epoch 33
Loss = 1.6193e-01, PNorm = 35.4717, GNorm = 0.5105, lr_0 = 2.6920e-04
Loss = 1.5479e-01, PNorm = 35.4805, GNorm = 0.9327, lr_0 = 2.6333e-04
Validation rmse = 0.131877
Validation r2 = 0.843569
Epoch 34
Loss = 1.3537e-01, PNorm = 35.4908, GNorm = 0.9529, lr_0 = 2.5758e-04
Loss = 1.6513e-01, PNorm = 35.4995, GNorm = 1.6645, lr_0 = 2.5197e-04
Validation rmse = 0.132398
Validation r2 = 0.842331
Epoch 35
Loss = 1.3888e-01, PNorm = 35.5073, GNorm = 1.7804, lr_0 = 2.4647e-04
Loss = 1.5803e-01, PNorm = 35.5148, GNorm = 1.4051, lr_0 = 2.4109e-04
Validation rmse = 0.129438
Validation r2 = 0.849301
Epoch 36
Loss = 1.4868e-01, PNorm = 35.5264, GNorm = 1.9658, lr_0 = 2.3531e-04
Loss = 1.6208e-01, PNorm = 35.5339, GNorm = 1.3931, lr_0 = 2.3018e-04
Validation rmse = 0.130322
Validation r2 = 0.847235
Epoch 37
Loss = 1.4522e-01, PNorm = 35.5426, GNorm = 0.9875, lr_0 = 2.2516e-04
Loss = 1.5121e-01, PNorm = 35.5505, GNorm = 0.9424, lr_0 = 2.2025e-04
Validation rmse = 0.132380
Validation r2 = 0.842373
Epoch 38
Loss = 1.4215e-01, PNorm = 35.5561, GNorm = 2.9037, lr_0 = 2.1544e-04
Loss = 1.7734e-01, PNorm = 35.5643, GNorm = 2.2398, lr_0 = 2.1074e-04
Validation rmse = 0.143303
Validation r2 = 0.815288
Epoch 39
Loss = 1.4776e-01, PNorm = 35.5731, GNorm = 0.9005, lr_0 = 2.0615e-04
Validation rmse = 0.139020
Validation r2 = 0.826164
Epoch 40
Loss = 9.1154e-02, PNorm = 35.5825, GNorm = 1.2285, lr_0 = 2.0121e-04
Loss = 1.7914e-01, PNorm = 35.5893, GNorm = 4.5666, lr_0 = 1.9682e-04
Validation rmse = 0.137120
Validation r2 = 0.830882
Epoch 41
Loss = 1.7037e-01, PNorm = 35.5956, GNorm = 4.5819, lr_0 = 1.9252e-04
Loss = 1.5880e-01, PNorm = 35.6034, GNorm = 0.7996, lr_0 = 1.8832e-04
Validation rmse = 0.131700
Validation r2 = 0.843987
Epoch 42
Loss = 1.3669e-01, PNorm = 35.6109, GNorm = 3.8013, lr_0 = 1.8422e-04
Loss = 1.5509e-01, PNorm = 35.6181, GNorm = 2.4789, lr_0 = 1.8020e-04
Validation rmse = 0.131378
Validation r2 = 0.844750
Epoch 43
Loss = 1.1949e-01, PNorm = 35.6254, GNorm = 2.2867, lr_0 = 1.7588e-04
Loss = 1.6951e-01, PNorm = 35.6317, GNorm = 3.3172, lr_0 = 1.7204e-04
Validation rmse = 0.144222
Validation r2 = 0.812910
Epoch 44
Loss = 1.3225e-01, PNorm = 35.6394, GNorm = 0.9169, lr_0 = 1.6829e-04
Loss = 1.5025e-01, PNorm = 35.6452, GNorm = 1.0356, lr_0 = 1.6462e-04
Validation rmse = 0.130623
Validation r2 = 0.846529
Epoch 45
Loss = 1.4160e-01, PNorm = 35.6511, GNorm = 1.1916, lr_0 = 1.6103e-04
Loss = 1.5187e-01, PNorm = 35.6578, GNorm = 1.1412, lr_0 = 1.5751e-04
Validation rmse = 0.132582
Validation r2 = 0.841890
Epoch 46
Loss = 1.5625e-01, PNorm = 35.6638, GNorm = 2.6347, lr_0 = 1.5408e-04
Validation rmse = 0.134060
Validation r2 = 0.838346
Epoch 47
Loss = 1.8753e-01, PNorm = 35.6700, GNorm = 1.2099, lr_0 = 1.5038e-04
Loss = 1.4853e-01, PNorm = 35.6759, GNorm = 1.1922, lr_0 = 1.4710e-04
Validation rmse = 0.134040
Validation r2 = 0.838394
Epoch 48
Loss = 1.3988e-01, PNorm = 35.6817, GNorm = 1.0301, lr_0 = 1.4390e-04
Loss = 1.1983e-01, PNorm = 35.6870, GNorm = 1.8554, lr_0 = 1.4076e-04
Validation rmse = 0.135238
Validation r2 = 0.835494
Epoch 49
Loss = 1.1908e-01, PNorm = 35.6916, GNorm = 1.4889, lr_0 = 1.3769e-04
Loss = 1.3413e-01, PNorm = 35.6967, GNorm = 2.4401, lr_0 = 1.3468e-04
Validation rmse = 0.132154
Validation r2 = 0.842909
Epoch 50
Loss = 1.6204e-01, PNorm = 35.7017, GNorm = 2.1470, lr_0 = 1.3174e-04
Loss = 1.3400e-01, PNorm = 35.7066, GNorm = 1.6411, lr_0 = 1.2887e-04
Validation rmse = 0.133814
Validation r2 = 0.838938
Epoch 51
Loss = 1.1405e-01, PNorm = 35.7118, GNorm = 0.7525, lr_0 = 1.2578e-04
Loss = 1.4602e-01, PNorm = 35.7167, GNorm = 1.9599, lr_0 = 1.2304e-04
Validation rmse = 0.132713
Validation r2 = 0.841579
Epoch 52
Loss = 1.3388e-01, PNorm = 35.7207, GNorm = 0.9910, lr_0 = 1.2035e-04
Loss = 1.3719e-01, PNorm = 35.7259, GNorm = 1.2063, lr_0 = 1.1773e-04
Validation rmse = 0.132500
Validation r2 = 0.842087
Epoch 53
Loss = 1.3601e-01, PNorm = 35.7300, GNorm = 0.8654, lr_0 = 1.1516e-04
Loss = 1.3881e-01, PNorm = 35.7346, GNorm = 0.8458, lr_0 = 1.1265e-04
Loss = 1.4361e-01, PNorm = 35.7350, GNorm = 1.4862, lr_0 = 1.1240e-04
Validation rmse = 0.135324
Validation r2 = 0.835283
Epoch 54
Loss = 1.4071e-01, PNorm = 35.7397, GNorm = 1.0543, lr_0 = 1.0995e-04
Validation rmse = 0.132487
Validation r2 = 0.842118
Epoch 55
Loss = 9.2692e-02, PNorm = 35.7437, GNorm = 1.0628, lr_0 = 1.0755e-04
Loss = 1.2831e-01, PNorm = 35.7478, GNorm = 1.7004, lr_0 = 1.0520e-04
Validation rmse = 0.135206
Validation r2 = 0.835571
Epoch 56
Loss = 1.3226e-01, PNorm = 35.7514, GNorm = 1.8991, lr_0 = 1.0291e-04
Loss = 1.5043e-01, PNorm = 35.7554, GNorm = 2.4288, lr_0 = 1.0066e-04
Validation rmse = 0.133975
Validation r2 = 0.838552
Epoch 57
Loss = 1.0813e-01, PNorm = 35.7598, GNorm = 2.9278, lr_0 = 1.0000e-04
Loss = 1.3606e-01, PNorm = 35.7632, GNorm = 1.3025, lr_0 = 1.0000e-04
Validation rmse = 0.132186
Validation r2 = 0.842835
Epoch 58
Loss = 1.2930e-01, PNorm = 35.7670, GNorm = 1.3287, lr_0 = 1.0000e-04
Loss = 1.4187e-01, PNorm = 35.7711, GNorm = 1.1183, lr_0 = 1.0000e-04
Validation rmse = 0.137176
Validation r2 = 0.830744
Epoch 59
Loss = 1.3891e-01, PNorm = 35.7752, GNorm = 2.7231, lr_0 = 1.0000e-04
Loss = 1.3407e-01, PNorm = 35.7783, GNorm = 1.7334, lr_0 = 1.0000e-04
Validation rmse = 0.133445
Validation r2 = 0.839826
Model 0 best validation rmse = 0.129438 on epoch 35
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.171086
Model 0 test r2 = 0.767306
Ensemble test rmse = 0.171086
Ensemble test r2 = 0.767306
Fold 2
Splitting data with seed 2
Total size = 1,170 | train size = 936 | val size = 117 | test size = 117
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.0168e+00, PNorm = 34.0154, GNorm = 1.7026, lr_0 = 3.7500e-04
Validation rmse = 0.312031
Validation r2 = 0.227167
Epoch 1
Loss = 7.8347e-01, PNorm = 34.0388, GNorm = 3.4481, lr_0 = 6.5000e-04
Loss = 6.4506e-01, PNorm = 34.0932, GNorm = 8.2523, lr_0 = 9.0000e-04
Validation rmse = 0.276371
Validation r2 = 0.393718
Epoch 2
Loss = 6.0354e-01, PNorm = 34.1530, GNorm = 0.8779, lr_0 = 9.8685e-04
Loss = 5.2479e-01, PNorm = 34.2257, GNorm = 3.4427, lr_0 = 9.6533e-04
Validation rmse = 0.233202
Validation r2 = 0.568327
Epoch 3
Loss = 3.7617e-01, PNorm = 34.2941, GNorm = 4.3662, lr_0 = 9.4427e-04
Loss = 4.5460e-01, PNorm = 34.3622, GNorm = 2.7602, lr_0 = 9.2367e-04
Validation rmse = 0.205461
Validation r2 = 0.664920
Epoch 4
Loss = 3.3872e-01, PNorm = 34.4111, GNorm = 9.5633, lr_0 = 9.0153e-04
Loss = 4.2016e-01, PNorm = 34.4622, GNorm = 7.4576, lr_0 = 8.8187e-04
Validation rmse = 0.215699
Validation r2 = 0.630693
Epoch 5
Loss = 2.8319e-01, PNorm = 34.5113, GNorm = 1.4480, lr_0 = 8.6263e-04
Loss = 3.4175e-01, PNorm = 34.5536, GNorm = 5.2425, lr_0 = 8.4381e-04
Validation rmse = 0.198185
Validation r2 = 0.688233
Epoch 6
Loss = 3.6031e-01, PNorm = 34.6039, GNorm = 2.6621, lr_0 = 8.2540e-04
Loss = 2.7700e-01, PNorm = 34.6499, GNorm = 3.7627, lr_0 = 8.0740e-04
Validation rmse = 0.179232
Validation r2 = 0.745012
Epoch 7
Loss = 2.6126e-01, PNorm = 34.6866, GNorm = 2.3770, lr_0 = 7.8979e-04
Validation rmse = 0.181042
Validation r2 = 0.739836
Epoch 8
Loss = 2.6586e-01, PNorm = 34.7277, GNorm = 3.4140, lr_0 = 7.7086e-04
Loss = 2.3860e-01, PNorm = 34.7559, GNorm = 2.1914, lr_0 = 7.5404e-04
Validation rmse = 0.182958
Validation r2 = 0.734299
Epoch 9
Loss = 2.3032e-01, PNorm = 34.7900, GNorm = 3.1376, lr_0 = 7.3759e-04
Loss = 2.1457e-01, PNorm = 34.8223, GNorm = 2.8650, lr_0 = 7.2150e-04
Validation rmse = 0.179679
Validation r2 = 0.743737
Epoch 10
Loss = 2.8093e-01, PNorm = 34.8491, GNorm = 7.9491, lr_0 = 7.0576e-04
Loss = 2.2955e-01, PNorm = 34.8795, GNorm = 3.6483, lr_0 = 6.9037e-04
Validation rmse = 0.177914
Validation r2 = 0.748747
Epoch 11
Loss = 2.0057e-01, PNorm = 34.9087, GNorm = 2.3821, lr_0 = 6.7382e-04
Loss = 2.1052e-01, PNorm = 34.9320, GNorm = 1.5819, lr_0 = 6.5912e-04
Validation rmse = 0.174913
Validation r2 = 0.757153
Epoch 12
Loss = 1.6654e-01, PNorm = 34.9509, GNorm = 4.7321, lr_0 = 6.4474e-04
Loss = 2.3180e-01, PNorm = 34.9762, GNorm = 1.7181, lr_0 = 6.3068e-04
Validation rmse = 0.178039
Validation r2 = 0.748393
Epoch 13
Loss = 1.8212e-01, PNorm = 34.9972, GNorm = 0.5788, lr_0 = 6.1692e-04
Loss = 2.0594e-01, PNorm = 35.0140, GNorm = 2.2250, lr_0 = 6.0346e-04
Validation rmse = 0.184872
Validation r2 = 0.728710
Epoch 14
Loss = 1.9770e-01, PNorm = 35.0335, GNorm = 3.1559, lr_0 = 5.9030e-04
Loss = 2.1030e-01, PNorm = 35.0598, GNorm = 2.0863, lr_0 = 5.7742e-04
Loss = 2.1452e-01, PNorm = 35.0617, GNorm = 2.9186, lr_0 = 5.7615e-04
Validation rmse = 0.173552
Validation r2 = 0.760917
Epoch 15
Loss = 2.0765e-01, PNorm = 35.0811, GNorm = 4.6330, lr_0 = 5.6358e-04
Validation rmse = 0.179317
Validation r2 = 0.744771
Epoch 16
Loss = 1.7787e-01, PNorm = 35.1030, GNorm = 3.1191, lr_0 = 5.5129e-04
Loss = 1.9188e-01, PNorm = 35.1237, GNorm = 1.4032, lr_0 = 5.3926e-04
Validation rmse = 0.182041
Validation r2 = 0.736956
Epoch 17
Loss = 2.3673e-01, PNorm = 35.1419, GNorm = 3.6128, lr_0 = 5.2750e-04
Loss = 1.8123e-01, PNorm = 35.1566, GNorm = 1.7134, lr_0 = 5.1599e-04
Validation rmse = 0.169765
Validation r2 = 0.771237
Epoch 18
Loss = 1.9395e-01, PNorm = 35.1703, GNorm = 2.1376, lr_0 = 5.0362e-04
Loss = 1.8232e-01, PNorm = 35.1903, GNorm = 2.6028, lr_0 = 4.9264e-04
Validation rmse = 0.182283
Validation r2 = 0.736258
Epoch 19
Loss = 2.1753e-01, PNorm = 35.2034, GNorm = 3.6431, lr_0 = 4.8189e-04
Loss = 2.1016e-01, PNorm = 35.2215, GNorm = 4.2654, lr_0 = 4.7138e-04
Validation rmse = 0.203654
Validation r2 = 0.670789
Epoch 20
Loss = 2.2319e-01, PNorm = 35.2393, GNorm = 5.0893, lr_0 = 4.6110e-04
Loss = 1.6727e-01, PNorm = 35.2586, GNorm = 2.4870, lr_0 = 4.5104e-04
Validation rmse = 0.180934
Validation r2 = 0.740146
Epoch 21
Loss = 1.9917e-01, PNorm = 35.2763, GNorm = 0.8055, lr_0 = 4.4120e-04
Loss = 1.4633e-01, PNorm = 35.2921, GNorm = 2.7148, lr_0 = 4.3158e-04
Validation rmse = 0.174323
Validation r2 = 0.758788
Epoch 22
Loss = 1.4934e-01, PNorm = 35.3067, GNorm = 0.9005, lr_0 = 4.2123e-04
Loss = 1.7002e-01, PNorm = 35.3211, GNorm = 2.8748, lr_0 = 4.1204e-04
Validation rmse = 0.175383
Validation r2 = 0.755845
Epoch 23
Loss = 1.4430e-01, PNorm = 35.3348, GNorm = 0.6176, lr_0 = 4.0305e-04
Validation rmse = 0.176231
Validation r2 = 0.753480
Epoch 24
Loss = 1.1321e-01, PNorm = 35.3499, GNorm = 0.9312, lr_0 = 3.9426e-04
Loss = 1.6573e-01, PNorm = 35.3615, GNorm = 1.1178, lr_0 = 3.8566e-04
Validation rmse = 0.169601
Validation r2 = 0.771679
Epoch 25
Loss = 1.1896e-01, PNorm = 35.3764, GNorm = 1.1368, lr_0 = 3.7725e-04
Loss = 1.5619e-01, PNorm = 35.3874, GNorm = 1.1000, lr_0 = 3.6902e-04
Validation rmse = 0.173288
Validation r2 = 0.761645
Epoch 26
Loss = 1.5477e-01, PNorm = 35.4014, GNorm = 3.3742, lr_0 = 3.6017e-04
Loss = 1.4434e-01, PNorm = 35.4132, GNorm = 3.1256, lr_0 = 3.5232e-04
Validation rmse = 0.171141
Validation r2 = 0.767515
Epoch 27
Loss = 1.4970e-01, PNorm = 35.4254, GNorm = 1.8667, lr_0 = 3.4463e-04
Loss = 1.3287e-01, PNorm = 35.4351, GNorm = 1.4287, lr_0 = 3.3711e-04
Validation rmse = 0.177177
Validation r2 = 0.750825
Epoch 28
Loss = 1.2717e-01, PNorm = 35.4467, GNorm = 2.7851, lr_0 = 3.2976e-04
Loss = 1.4667e-01, PNorm = 35.4594, GNorm = 1.3682, lr_0 = 3.2257e-04
Validation rmse = 0.180211
Validation r2 = 0.742218
Epoch 29
Loss = 1.4326e-01, PNorm = 35.4712, GNorm = 1.1457, lr_0 = 3.1484e-04
Loss = 1.5440e-01, PNorm = 35.4826, GNorm = 0.5723, lr_0 = 3.0797e-04
Validation rmse = 0.175429
Validation r2 = 0.755718
Epoch 30
Loss = 1.2983e-01, PNorm = 35.4930, GNorm = 2.7817, lr_0 = 3.0125e-04
Loss = 1.7529e-01, PNorm = 35.5028, GNorm = 1.6222, lr_0 = 2.9468e-04
Validation rmse = 0.171439
Validation r2 = 0.766705
Epoch 31
Loss = 1.6399e-01, PNorm = 35.5157, GNorm = 3.0554, lr_0 = 2.8825e-04
Validation rmse = 0.174538
Validation r2 = 0.758194
Epoch 32
Loss = 9.4727e-02, PNorm = 35.5255, GNorm = 3.0755, lr_0 = 2.8196e-04
Loss = 1.5665e-01, PNorm = 35.5348, GNorm = 2.3542, lr_0 = 2.7581e-04
Validation rmse = 0.172161
Validation r2 = 0.764733
Epoch 33
Loss = 1.5116e-01, PNorm = 35.5463, GNorm = 2.7558, lr_0 = 2.6920e-04
Loss = 1.4172e-01, PNorm = 35.5565, GNorm = 0.8866, lr_0 = 2.6333e-04
Validation rmse = 0.174800
Validation r2 = 0.757466
Epoch 34
Loss = 1.4090e-01, PNorm = 35.5654, GNorm = 1.0917, lr_0 = 2.5758e-04
Loss = 1.4976e-01, PNorm = 35.5740, GNorm = 3.0978, lr_0 = 2.5197e-04
Validation rmse = 0.172575
Validation r2 = 0.763601
Epoch 35
Loss = 1.4437e-01, PNorm = 35.5820, GNorm = 1.7342, lr_0 = 2.4647e-04
Loss = 1.4683e-01, PNorm = 35.5923, GNorm = 1.5834, lr_0 = 2.4109e-04
Validation rmse = 0.176676
Validation r2 = 0.752233
Epoch 36
Loss = 1.2338e-01, PNorm = 35.5998, GNorm = 1.2971, lr_0 = 2.3531e-04
Loss = 1.5041e-01, PNorm = 35.6082, GNorm = 1.1514, lr_0 = 2.3018e-04
Validation rmse = 0.174911
Validation r2 = 0.757159
Epoch 37
Loss = 1.3346e-01, PNorm = 35.6172, GNorm = 2.4402, lr_0 = 2.2516e-04
Loss = 1.3538e-01, PNorm = 35.6263, GNorm = 0.9595, lr_0 = 2.2025e-04
Validation rmse = 0.169161
Validation r2 = 0.772861
Epoch 38
Loss = 1.2453e-01, PNorm = 35.6338, GNorm = 0.8279, lr_0 = 2.1544e-04
Loss = 1.5108e-01, PNorm = 35.6417, GNorm = 1.5553, lr_0 = 2.1074e-04
Validation rmse = 0.175362
Validation r2 = 0.755903
Epoch 39
Loss = 1.4534e-01, PNorm = 35.6515, GNorm = 1.3173, lr_0 = 2.0615e-04
Validation rmse = 0.185973
Validation r2 = 0.725469
Epoch 40
Loss = 1.3086e-01, PNorm = 35.6594, GNorm = 3.7385, lr_0 = 2.0121e-04
Loss = 1.3613e-01, PNorm = 35.6660, GNorm = 0.7498, lr_0 = 1.9682e-04
Validation rmse = 0.174738
Validation r2 = 0.757638
Epoch 41
Loss = 1.1743e-01, PNorm = 35.6737, GNorm = 0.7831, lr_0 = 1.9252e-04
Loss = 1.2780e-01, PNorm = 35.6820, GNorm = 0.7947, lr_0 = 1.8832e-04
Validation rmse = 0.173871
Validation r2 = 0.760037
Epoch 42
Loss = 1.0500e-01, PNorm = 35.6878, GNorm = 1.6748, lr_0 = 1.8422e-04
Loss = 1.2100e-01, PNorm = 35.6937, GNorm = 1.1637, lr_0 = 1.8020e-04
Validation rmse = 0.174045
Validation r2 = 0.759558
Epoch 43
Loss = 1.3515e-01, PNorm = 35.7013, GNorm = 1.0261, lr_0 = 1.7588e-04
Loss = 1.3536e-01, PNorm = 35.7089, GNorm = 2.4162, lr_0 = 1.7204e-04
Validation rmse = 0.175710
Validation r2 = 0.754934
Epoch 44
Loss = 1.2300e-01, PNorm = 35.7150, GNorm = 2.7638, lr_0 = 1.6829e-04
Loss = 1.2109e-01, PNorm = 35.7210, GNorm = 1.1538, lr_0 = 1.6462e-04
Validation rmse = 0.173842
Validation r2 = 0.760118
Epoch 45
Loss = 1.3423e-01, PNorm = 35.7277, GNorm = 4.2309, lr_0 = 1.6103e-04
Loss = 1.3251e-01, PNorm = 35.7338, GNorm = 2.5002, lr_0 = 1.5751e-04
Validation rmse = 0.172660
Validation r2 = 0.763367
Epoch 46
Loss = 1.4279e-01, PNorm = 35.7395, GNorm = 1.3448, lr_0 = 1.5408e-04
Validation rmse = 0.173428
Validation r2 = 0.761259
Epoch 47
Loss = 1.6461e-01, PNorm = 35.7455, GNorm = 2.8812, lr_0 = 1.5038e-04
Loss = 1.3691e-01, PNorm = 35.7518, GNorm = 2.7857, lr_0 = 1.4710e-04
Validation rmse = 0.173599
Validation r2 = 0.760787
Epoch 48
Loss = 1.4364e-01, PNorm = 35.7565, GNorm = 1.0199, lr_0 = 1.4390e-04
Loss = 1.3073e-01, PNorm = 35.7624, GNorm = 1.7588, lr_0 = 1.4076e-04
Validation rmse = 0.173295
Validation r2 = 0.761624
Epoch 49
Loss = 1.1841e-01, PNorm = 35.7678, GNorm = 0.8400, lr_0 = 1.3769e-04
Loss = 1.1731e-01, PNorm = 35.7729, GNorm = 0.8519, lr_0 = 1.3468e-04
Validation rmse = 0.172138
Validation r2 = 0.764797
Epoch 50
Loss = 1.2643e-01, PNorm = 35.7772, GNorm = 1.9188, lr_0 = 1.3174e-04
Loss = 1.2695e-01, PNorm = 35.7820, GNorm = 0.7762, lr_0 = 1.2887e-04
Validation rmse = 0.174195
Validation r2 = 0.759142
Epoch 51
Loss = 1.2603e-01, PNorm = 35.7878, GNorm = 1.5264, lr_0 = 1.2578e-04
Loss = 1.2060e-01, PNorm = 35.7927, GNorm = 0.9813, lr_0 = 1.2304e-04
Validation rmse = 0.172255
Validation r2 = 0.764478
Epoch 52
Loss = 9.5971e-02, PNorm = 35.7973, GNorm = 1.4319, lr_0 = 1.2035e-04
Loss = 1.2806e-01, PNorm = 35.8002, GNorm = 1.4831, lr_0 = 1.1773e-04
Validation rmse = 0.176130
Validation r2 = 0.753762
Epoch 53
Loss = 1.2052e-01, PNorm = 35.8048, GNorm = 3.3820, lr_0 = 1.1516e-04
Loss = 1.2877e-01, PNorm = 35.8097, GNorm = 1.9325, lr_0 = 1.1265e-04
Loss = 8.9303e-02, PNorm = 35.8100, GNorm = 1.1310, lr_0 = 1.1240e-04
Validation rmse = 0.172897
Validation r2 = 0.762718
Epoch 54
Loss = 1.2843e-01, PNorm = 35.8126, GNorm = 1.0893, lr_0 = 1.0995e-04
Validation rmse = 0.175422
Validation r2 = 0.755737
Epoch 55
Loss = 9.7200e-02, PNorm = 35.8175, GNorm = 0.9801, lr_0 = 1.0755e-04
Loss = 1.1407e-01, PNorm = 35.8223, GNorm = 0.8050, lr_0 = 1.0520e-04
Validation rmse = 0.173239
Validation r2 = 0.761777
Epoch 56
Loss = 8.9182e-02, PNorm = 35.8259, GNorm = 0.9801, lr_0 = 1.0291e-04
Loss = 1.0834e-01, PNorm = 35.8303, GNorm = 0.7607, lr_0 = 1.0066e-04
Validation rmse = 0.174909
Validation r2 = 0.757163
Epoch 57
Loss = 8.2112e-02, PNorm = 35.8334, GNorm = 0.9528, lr_0 = 1.0000e-04
Loss = 1.4073e-01, PNorm = 35.8384, GNorm = 1.0637, lr_0 = 1.0000e-04
Validation rmse = 0.172681
Validation r2 = 0.763312
Epoch 58
Loss = 1.1386e-01, PNorm = 35.8422, GNorm = 1.3891, lr_0 = 1.0000e-04
Loss = 1.1734e-01, PNorm = 35.8457, GNorm = 1.4330, lr_0 = 1.0000e-04
Validation rmse = 0.179433
Validation r2 = 0.744438
Epoch 59
Loss = 1.2799e-01, PNorm = 35.8497, GNorm = 1.5900, lr_0 = 1.0000e-04
Loss = 1.2587e-01, PNorm = 35.8537, GNorm = 1.7384, lr_0 = 1.0000e-04
Validation rmse = 0.173813
Validation r2 = 0.760197
Model 0 best validation rmse = 0.169161 on epoch 37
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.197009
Model 0 test r2 = 0.622173
Ensemble test rmse = 0.197009
Ensemble test r2 = 0.622173
Fold 3
Splitting data with seed 3
Total size = 1,170 | train size = 936 | val size = 117 | test size = 117
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.5941e-01, PNorm = 34.0141, GNorm = 1.5561, lr_0 = 3.7500e-04
Validation rmse = 0.283185
Validation r2 = 0.279472
Epoch 1
Loss = 6.4227e-01, PNorm = 34.0414, GNorm = 2.9166, lr_0 = 6.5000e-04
Loss = 7.0862e-01, PNorm = 34.0827, GNorm = 4.5892, lr_0 = 9.0000e-04
Validation rmse = 0.277903
Validation r2 = 0.306100
Epoch 2
Loss = 5.3253e-01, PNorm = 34.1348, GNorm = 3.7005, lr_0 = 9.8685e-04
Loss = 5.3571e-01, PNorm = 34.2067, GNorm = 1.0028, lr_0 = 9.6533e-04
Validation rmse = 0.232435
Validation r2 = 0.514586
Epoch 3
Loss = 4.6351e-01, PNorm = 34.2715, GNorm = 2.3161, lr_0 = 9.4427e-04
Loss = 4.4191e-01, PNorm = 34.3390, GNorm = 5.2040, lr_0 = 9.2367e-04
Validation rmse = 0.207490
Validation r2 = 0.613183
Epoch 4
Loss = 4.0842e-01, PNorm = 34.4031, GNorm = 1.7204, lr_0 = 9.0153e-04
Loss = 3.7388e-01, PNorm = 34.4569, GNorm = 1.5618, lr_0 = 8.8187e-04
Validation rmse = 0.189929
Validation r2 = 0.675890
Epoch 5
Loss = 3.4097e-01, PNorm = 34.5018, GNorm = 6.3200, lr_0 = 8.6263e-04
Loss = 3.4308e-01, PNorm = 34.5517, GNorm = 1.4534, lr_0 = 8.4381e-04
Validation rmse = 0.193512
Validation r2 = 0.663546
Epoch 6
Loss = 3.3844e-01, PNorm = 34.5969, GNorm = 6.1962, lr_0 = 8.2540e-04
Loss = 2.6249e-01, PNorm = 34.6299, GNorm = 2.3713, lr_0 = 8.0740e-04
Validation rmse = 0.184779
Validation r2 = 0.693228
Epoch 7
Loss = 2.4609e-01, PNorm = 34.6731, GNorm = 3.8311, lr_0 = 7.8979e-04
Validation rmse = 0.189195
Validation r2 = 0.678390
Epoch 8
Loss = 3.8686e-01, PNorm = 34.7091, GNorm = 7.5554, lr_0 = 7.7086e-04
Loss = 2.7357e-01, PNorm = 34.7448, GNorm = 3.2254, lr_0 = 7.5404e-04
Validation rmse = 0.165454
Validation r2 = 0.754039
Epoch 9
Loss = 2.3167e-01, PNorm = 34.7762, GNorm = 2.4387, lr_0 = 7.3759e-04
Loss = 2.3736e-01, PNorm = 34.8097, GNorm = 2.3923, lr_0 = 7.2150e-04
Validation rmse = 0.160090
Validation r2 = 0.769730
Epoch 10
Loss = 3.0304e-01, PNorm = 34.8385, GNorm = 1.1679, lr_0 = 7.0576e-04
Loss = 2.1160e-01, PNorm = 34.8648, GNorm = 1.0620, lr_0 = 6.9037e-04
Validation rmse = 0.161662
Validation r2 = 0.765183
Epoch 11
Loss = 2.4712e-01, PNorm = 34.8952, GNorm = 2.7477, lr_0 = 6.7382e-04
Loss = 1.9761e-01, PNorm = 34.9218, GNorm = 6.7121, lr_0 = 6.5912e-04
Validation rmse = 0.157503
Validation r2 = 0.777111
Epoch 12
Loss = 1.7456e-01, PNorm = 34.9440, GNorm = 1.1188, lr_0 = 6.4474e-04
Loss = 2.5314e-01, PNorm = 34.9650, GNorm = 5.6191, lr_0 = 6.3068e-04
Validation rmse = 0.166054
Validation r2 = 0.752253
Epoch 13
Loss = 1.9575e-01, PNorm = 34.9903, GNorm = 1.2378, lr_0 = 6.1692e-04
Loss = 2.2186e-01, PNorm = 35.0165, GNorm = 1.6177, lr_0 = 6.0346e-04
Validation rmse = 0.166326
Validation r2 = 0.751441
Epoch 14
Loss = 1.8640e-01, PNorm = 35.0381, GNorm = 1.9283, lr_0 = 5.9030e-04
Loss = 2.3010e-01, PNorm = 35.0574, GNorm = 3.0755, lr_0 = 5.7742e-04
Loss = 1.7359e-01, PNorm = 35.0580, GNorm = 3.1119, lr_0 = 5.7615e-04
Validation rmse = 0.160280
Validation r2 = 0.769182
Epoch 15
Loss = 1.8947e-01, PNorm = 35.0776, GNorm = 2.5337, lr_0 = 5.6358e-04
Validation rmse = 0.158841
Validation r2 = 0.773309
Epoch 16
Loss = 1.8429e-01, PNorm = 35.0944, GNorm = 3.6344, lr_0 = 5.5129e-04
Loss = 2.1431e-01, PNorm = 35.1136, GNorm = 1.5176, lr_0 = 5.3926e-04
Validation rmse = 0.159367
Validation r2 = 0.771805
Epoch 17
Loss = 2.4258e-01, PNorm = 35.1329, GNorm = 1.9322, lr_0 = 5.2750e-04
Loss = 1.8027e-01, PNorm = 35.1501, GNorm = 0.6240, lr_0 = 5.1599e-04
Validation rmse = 0.175029
Validation r2 = 0.724747
Epoch 18
Loss = 2.2991e-01, PNorm = 35.1659, GNorm = 3.9357, lr_0 = 5.0362e-04
Loss = 2.0547e-01, PNorm = 35.1835, GNorm = 2.2028, lr_0 = 4.9264e-04
Validation rmse = 0.171476
Validation r2 = 0.735809
Epoch 19
Loss = 1.8937e-01, PNorm = 35.2057, GNorm = 2.3616, lr_0 = 4.8189e-04
Loss = 1.9201e-01, PNorm = 35.2244, GNorm = 0.9384, lr_0 = 4.7138e-04
Validation rmse = 0.160453
Validation r2 = 0.768685
Epoch 20
Loss = 1.7282e-01, PNorm = 35.2397, GNorm = 1.6705, lr_0 = 4.6110e-04
Loss = 1.9244e-01, PNorm = 35.2565, GNorm = 3.9679, lr_0 = 4.5104e-04
Validation rmse = 0.162633
Validation r2 = 0.762357
Epoch 21
Loss = 1.7436e-01, PNorm = 35.2702, GNorm = 1.1502, lr_0 = 4.4120e-04
Loss = 1.7705e-01, PNorm = 35.2860, GNorm = 2.6790, lr_0 = 4.3158e-04
Validation rmse = 0.159434
Validation r2 = 0.771611
Epoch 22
Loss = 1.8303e-01, PNorm = 35.3003, GNorm = 2.2068, lr_0 = 4.2123e-04
Loss = 1.7387e-01, PNorm = 35.3169, GNorm = 1.7143, lr_0 = 4.1204e-04
Validation rmse = 0.182245
Validation r2 = 0.701585
Epoch 23
Loss = 1.8080e-01, PNorm = 35.3293, GNorm = 0.9908, lr_0 = 4.0305e-04
Validation rmse = 0.158217
Validation r2 = 0.775087
Epoch 24
Loss = 1.0577e-01, PNorm = 35.3431, GNorm = 0.6089, lr_0 = 3.9426e-04
Loss = 1.8953e-01, PNorm = 35.3599, GNorm = 1.0621, lr_0 = 3.8566e-04
Validation rmse = 0.156350
Validation r2 = 0.780363
Epoch 25
Loss = 1.0972e-01, PNorm = 35.3739, GNorm = 3.2419, lr_0 = 3.7725e-04
Loss = 1.7497e-01, PNorm = 35.3843, GNorm = 6.5048, lr_0 = 3.6902e-04
Validation rmse = 0.164388
Validation r2 = 0.757200
Epoch 26
Loss = 1.5933e-01, PNorm = 35.4005, GNorm = 2.0273, lr_0 = 3.6017e-04
Loss = 1.7251e-01, PNorm = 35.4207, GNorm = 1.3653, lr_0 = 3.5232e-04
Validation rmse = 0.155741
Validation r2 = 0.782069
Epoch 27
Loss = 1.5808e-01, PNorm = 35.4332, GNorm = 1.3789, lr_0 = 3.4463e-04
Loss = 1.7647e-01, PNorm = 35.4444, GNorm = 1.2448, lr_0 = 3.3711e-04
Validation rmse = 0.156112
Validation r2 = 0.781031
Epoch 28
Loss = 1.6424e-01, PNorm = 35.4554, GNorm = 1.3414, lr_0 = 3.2976e-04
Loss = 1.7361e-01, PNorm = 35.4646, GNorm = 1.1461, lr_0 = 3.2257e-04
Validation rmse = 0.158232
Validation r2 = 0.775044
Epoch 29
Loss = 1.8715e-01, PNorm = 35.4770, GNorm = 1.3928, lr_0 = 3.1484e-04
Loss = 1.3109e-01, PNorm = 35.4893, GNorm = 0.6596, lr_0 = 3.0797e-04
Validation rmse = 0.154905
Validation r2 = 0.784404
Epoch 30
Loss = 1.4872e-01, PNorm = 35.4993, GNorm = 0.9065, lr_0 = 3.0125e-04
Loss = 1.6800e-01, PNorm = 35.5098, GNorm = 0.9277, lr_0 = 2.9468e-04
Validation rmse = 0.154645
Validation r2 = 0.785128
Epoch 31
Loss = 1.5207e-01, PNorm = 35.5189, GNorm = 1.5466, lr_0 = 2.8825e-04
Validation rmse = 0.155384
Validation r2 = 0.783067
Epoch 32
Loss = 1.5134e-01, PNorm = 35.5289, GNorm = 0.8972, lr_0 = 2.8196e-04
Loss = 1.5816e-01, PNorm = 35.5392, GNorm = 1.1017, lr_0 = 2.7581e-04
Validation rmse = 0.162424
Validation r2 = 0.762965
Epoch 33
Loss = 2.0515e-01, PNorm = 35.5512, GNorm = 0.7518, lr_0 = 2.6920e-04
Loss = 1.6243e-01, PNorm = 35.5632, GNorm = 0.9121, lr_0 = 2.6333e-04
Validation rmse = 0.154707
Validation r2 = 0.784954
Epoch 34
Loss = 1.7770e-01, PNorm = 35.5721, GNorm = 1.0246, lr_0 = 2.5758e-04
Loss = 1.4702e-01, PNorm = 35.5813, GNorm = 0.8376, lr_0 = 2.5197e-04
Validation rmse = 0.157065
Validation r2 = 0.778349
Epoch 35
Loss = 1.8816e-01, PNorm = 35.5890, GNorm = 4.3237, lr_0 = 2.4647e-04
Loss = 1.4947e-01, PNorm = 35.5978, GNorm = 1.1115, lr_0 = 2.4109e-04
Validation rmse = 0.155698
Validation r2 = 0.782190
Epoch 36
Loss = 1.4968e-01, PNorm = 35.6068, GNorm = 0.6553, lr_0 = 2.3531e-04
Loss = 1.5585e-01, PNorm = 35.6153, GNorm = 1.6109, lr_0 = 2.3018e-04
Validation rmse = 0.156445
Validation r2 = 0.780096
Epoch 37
Loss = 1.5930e-01, PNorm = 35.6233, GNorm = 2.6306, lr_0 = 2.2516e-04
Loss = 1.4798e-01, PNorm = 35.6296, GNorm = 0.9368, lr_0 = 2.2025e-04
Validation rmse = 0.161319
Validation r2 = 0.766181
Epoch 38
Loss = 1.5786e-01, PNorm = 35.6386, GNorm = 0.8929, lr_0 = 2.1544e-04
Loss = 1.6005e-01, PNorm = 35.6466, GNorm = 2.5068, lr_0 = 2.1074e-04
Validation rmse = 0.154891
Validation r2 = 0.784442
Epoch 39
Loss = 1.3159e-01, PNorm = 35.6579, GNorm = 0.6351, lr_0 = 2.0615e-04
Validation rmse = 0.152373
Validation r2 = 0.791393
Epoch 40
Loss = 1.8295e-01, PNorm = 35.6645, GNorm = 1.7119, lr_0 = 2.0121e-04
Loss = 1.3486e-01, PNorm = 35.6720, GNorm = 2.3710, lr_0 = 1.9682e-04
Validation rmse = 0.153798
Validation r2 = 0.787473
Epoch 41
Loss = 1.3113e-01, PNorm = 35.6793, GNorm = 1.4490, lr_0 = 1.9252e-04
Loss = 1.4305e-01, PNorm = 35.6869, GNorm = 1.3347, lr_0 = 1.8832e-04
Validation rmse = 0.153200
Validation r2 = 0.789123
Epoch 42
Loss = 1.3218e-01, PNorm = 35.6950, GNorm = 2.5878, lr_0 = 1.8422e-04
Loss = 1.3319e-01, PNorm = 35.7015, GNorm = 0.8813, lr_0 = 1.8020e-04
Validation rmse = 0.154083
Validation r2 = 0.786685
Epoch 43
Loss = 1.2528e-01, PNorm = 35.7084, GNorm = 2.1678, lr_0 = 1.7588e-04
Loss = 1.5001e-01, PNorm = 35.7149, GNorm = 0.7182, lr_0 = 1.7204e-04
Validation rmse = 0.154356
Validation r2 = 0.785930
Epoch 44
Loss = 1.5453e-01, PNorm = 35.7209, GNorm = 1.4517, lr_0 = 1.6829e-04
Loss = 1.3922e-01, PNorm = 35.7268, GNorm = 2.4012, lr_0 = 1.6462e-04
Validation rmse = 0.155926
Validation r2 = 0.781552
Epoch 45
Loss = 1.5216e-01, PNorm = 35.7330, GNorm = 1.8782, lr_0 = 1.6103e-04
Loss = 1.3865e-01, PNorm = 35.7390, GNorm = 2.2029, lr_0 = 1.5751e-04
Validation rmse = 0.154413
Validation r2 = 0.785772
Epoch 46
Loss = 1.4380e-01, PNorm = 35.7446, GNorm = 0.9653, lr_0 = 1.5408e-04
Validation rmse = 0.154839
Validation r2 = 0.784587
Epoch 47
Loss = 1.4653e-01, PNorm = 35.7517, GNorm = 0.9304, lr_0 = 1.5038e-04
Loss = 1.3957e-01, PNorm = 35.7578, GNorm = 1.7738, lr_0 = 1.4710e-04
Validation rmse = 0.153260
Validation r2 = 0.788958
Epoch 48
Loss = 1.1258e-01, PNorm = 35.7640, GNorm = 1.0716, lr_0 = 1.4390e-04
Loss = 1.4485e-01, PNorm = 35.7694, GNorm = 1.0420, lr_0 = 1.4076e-04
Validation rmse = 0.153615
Validation r2 = 0.787981
Epoch 49
Loss = 1.3230e-01, PNorm = 35.7749, GNorm = 1.0808, lr_0 = 1.3769e-04
Loss = 1.4628e-01, PNorm = 35.7809, GNorm = 0.8766, lr_0 = 1.3468e-04
Validation rmse = 0.154470
Validation r2 = 0.785613
Epoch 50
Loss = 1.3798e-01, PNorm = 35.7865, GNorm = 0.6225, lr_0 = 1.3174e-04
Loss = 1.4675e-01, PNorm = 35.7902, GNorm = 3.0155, lr_0 = 1.2887e-04
Validation rmse = 0.157118
Validation r2 = 0.778200
Epoch 51
Loss = 1.3065e-01, PNorm = 35.7955, GNorm = 0.9033, lr_0 = 1.2578e-04
Loss = 1.5350e-01, PNorm = 35.8005, GNorm = 1.0857, lr_0 = 1.2304e-04
Validation rmse = 0.152732
Validation r2 = 0.790411
Epoch 52
Loss = 1.3726e-01, PNorm = 35.8050, GNorm = 1.5630, lr_0 = 1.2035e-04
Loss = 1.3239e-01, PNorm = 35.8094, GNorm = 0.9268, lr_0 = 1.1773e-04
Validation rmse = 0.153158
Validation r2 = 0.789239
Epoch 53
Loss = 1.1106e-01, PNorm = 35.8145, GNorm = 0.9111, lr_0 = 1.1516e-04
Loss = 1.5919e-01, PNorm = 35.8187, GNorm = 2.9695, lr_0 = 1.1265e-04
Loss = 1.6901e-01, PNorm = 35.8194, GNorm = 1.7191, lr_0 = 1.1240e-04
Validation rmse = 0.154416
Validation r2 = 0.785763
Epoch 54
Loss = 1.3263e-01, PNorm = 35.8235, GNorm = 0.6446, lr_0 = 1.0995e-04
Validation rmse = 0.155411
Validation r2 = 0.782994
Epoch 55
Loss = 7.9741e-02, PNorm = 35.8282, GNorm = 0.5965, lr_0 = 1.0755e-04
Loss = 1.4436e-01, PNorm = 35.8320, GNorm = 1.5609, lr_0 = 1.0520e-04
Validation rmse = 0.153986
Validation r2 = 0.786953
Epoch 56
Loss = 1.2341e-01, PNorm = 35.8359, GNorm = 1.3170, lr_0 = 1.0291e-04
Loss = 1.4060e-01, PNorm = 35.8397, GNorm = 1.2750, lr_0 = 1.0066e-04
Validation rmse = 0.155081
Validation r2 = 0.783913
Epoch 57
Loss = 1.7441e-01, PNorm = 35.8441, GNorm = 2.8884, lr_0 = 1.0000e-04
Loss = 1.2842e-01, PNorm = 35.8483, GNorm = 2.3525, lr_0 = 1.0000e-04
Validation rmse = 0.157464
Validation r2 = 0.777220
Epoch 58
Loss = 1.5051e-01, PNorm = 35.8520, GNorm = 0.4809, lr_0 = 1.0000e-04
Loss = 1.3277e-01, PNorm = 35.8556, GNorm = 0.7909, lr_0 = 1.0000e-04
Validation rmse = 0.153393
Validation r2 = 0.788593
Epoch 59
Loss = 1.3141e-01, PNorm = 35.8602, GNorm = 0.7620, lr_0 = 1.0000e-04
Loss = 1.2839e-01, PNorm = 35.8637, GNorm = 2.2006, lr_0 = 1.0000e-04
Validation rmse = 0.153163
Validation r2 = 0.789225
Model 0 best validation rmse = 0.152373 on epoch 39
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.155670
Model 0 test r2 = 0.779012
Ensemble test rmse = 0.155670
Ensemble test r2 = 0.779012
Fold 4
Splitting data with seed 4
Total size = 1,170 | train size = 936 | val size = 117 | test size = 117
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.7131e-01, PNorm = 34.0143, GNorm = 2.2560, lr_0 = 3.7500e-04
Validation rmse = 0.308393
Validation r2 = 0.291292
Epoch 1
Loss = 7.3362e-01, PNorm = 34.0427, GNorm = 2.7321, lr_0 = 6.5000e-04
Loss = 8.1423e-01, PNorm = 34.0782, GNorm = 4.0908, lr_0 = 9.0000e-04
Validation rmse = 0.276459
Validation r2 = 0.430466
Epoch 2
Loss = 8.1187e-01, PNorm = 34.1258, GNorm = 7.8813, lr_0 = 9.8685e-04
Loss = 6.2111e-01, PNorm = 34.1857, GNorm = 4.7797, lr_0 = 9.6533e-04
Validation rmse = 0.251083
Validation r2 = 0.530220
Epoch 3
Loss = 4.2445e-01, PNorm = 34.2506, GNorm = 5.3795, lr_0 = 9.4427e-04
Loss = 5.1922e-01, PNorm = 34.3210, GNorm = 1.1830, lr_0 = 9.2367e-04
Validation rmse = 0.230717
Validation r2 = 0.603342
Epoch 4
Loss = 4.8837e-01, PNorm = 34.3856, GNorm = 6.7224, lr_0 = 9.0153e-04
Loss = 4.5561e-01, PNorm = 34.4399, GNorm = 7.4572, lr_0 = 8.8187e-04
Validation rmse = 0.221162
Validation r2 = 0.635514
Epoch 5
Loss = 3.3802e-01, PNorm = 34.4803, GNorm = 1.1361, lr_0 = 8.6263e-04
Loss = 3.5172e-01, PNorm = 34.5275, GNorm = 1.9605, lr_0 = 8.4381e-04
Validation rmse = 0.204284
Validation r2 = 0.689025
Epoch 6
Loss = 3.1537e-01, PNorm = 34.5780, GNorm = 1.3048, lr_0 = 8.2540e-04
Loss = 3.0931e-01, PNorm = 34.6274, GNorm = 1.3196, lr_0 = 8.0740e-04
Validation rmse = 0.178300
Validation r2 = 0.763102
Epoch 7
Loss = 2.7937e-01, PNorm = 34.6707, GNorm = 2.3931, lr_0 = 7.8979e-04
Validation rmse = 0.187179
Validation r2 = 0.738920
Epoch 8
Loss = 3.3713e-01, PNorm = 34.7182, GNorm = 5.0084, lr_0 = 7.7086e-04
Loss = 2.4384e-01, PNorm = 34.7495, GNorm = 2.0647, lr_0 = 7.5404e-04
Validation rmse = 0.184253
Validation r2 = 0.747018
Epoch 9
Loss = 3.2373e-01, PNorm = 34.7859, GNorm = 5.8877, lr_0 = 7.3759e-04
Loss = 2.5968e-01, PNorm = 34.8173, GNorm = 2.2835, lr_0 = 7.2150e-04
Validation rmse = 0.172622
Validation r2 = 0.777948
Epoch 10
Loss = 2.1164e-01, PNorm = 34.8470, GNorm = 2.3607, lr_0 = 7.0576e-04
Loss = 2.3664e-01, PNorm = 34.8743, GNorm = 0.5649, lr_0 = 6.9037e-04
Validation rmse = 0.162607
Validation r2 = 0.802969
Epoch 11
Loss = 2.5751e-01, PNorm = 34.9120, GNorm = 2.9207, lr_0 = 6.7382e-04
Loss = 2.3977e-01, PNorm = 34.9385, GNorm = 0.9145, lr_0 = 6.5912e-04
Validation rmse = 0.165452
Validation r2 = 0.796013
Epoch 12
Loss = 2.0680e-01, PNorm = 34.9584, GNorm = 0.9051, lr_0 = 6.4474e-04
Loss = 2.4053e-01, PNorm = 34.9820, GNorm = 2.7433, lr_0 = 6.3068e-04
Validation rmse = 0.163782
Validation r2 = 0.800109
Epoch 13
Loss = 2.0149e-01, PNorm = 35.0084, GNorm = 1.4029, lr_0 = 6.1692e-04
Loss = 2.5211e-01, PNorm = 35.0239, GNorm = 1.6344, lr_0 = 6.0346e-04
Validation rmse = 0.170279
Validation r2 = 0.783936
Epoch 14
Loss = 2.4004e-01, PNorm = 35.0440, GNorm = 2.0634, lr_0 = 5.9030e-04
Loss = 2.1718e-01, PNorm = 35.0645, GNorm = 2.7857, lr_0 = 5.7742e-04
Loss = 1.6541e-01, PNorm = 35.0656, GNorm = 2.7442, lr_0 = 5.7615e-04
Validation rmse = 0.167146
Validation r2 = 0.791814
Epoch 15
Loss = 2.5133e-01, PNorm = 35.0847, GNorm = 5.8354, lr_0 = 5.6358e-04
Validation rmse = 0.159345
Validation r2 = 0.810793
Epoch 16
Loss = 2.5273e-01, PNorm = 35.1075, GNorm = 3.4537, lr_0 = 5.5129e-04
Loss = 2.5063e-01, PNorm = 35.1293, GNorm = 4.9075, lr_0 = 5.3926e-04
Validation rmse = 0.167523
Validation r2 = 0.790874
Epoch 17
Loss = 1.6938e-01, PNorm = 35.1485, GNorm = 1.4964, lr_0 = 5.2750e-04
Loss = 2.1888e-01, PNorm = 35.1715, GNorm = 0.9300, lr_0 = 5.1599e-04
Validation rmse = 0.161065
Validation r2 = 0.806688
Epoch 18
Loss = 2.2151e-01, PNorm = 35.1905, GNorm = 4.8773, lr_0 = 5.0362e-04
Loss = 1.7106e-01, PNorm = 35.2062, GNorm = 2.1289, lr_0 = 4.9264e-04
Validation rmse = 0.158362
Validation r2 = 0.813120
Epoch 19
Loss = 1.5939e-01, PNorm = 35.2215, GNorm = 2.7625, lr_0 = 4.8189e-04
Loss = 2.1913e-01, PNorm = 35.2388, GNorm = 0.6501, lr_0 = 4.7138e-04
Validation rmse = 0.162646
Validation r2 = 0.802873
Epoch 20
Loss = 2.2129e-01, PNorm = 35.2553, GNorm = 4.5796, lr_0 = 4.6110e-04
Loss = 1.8064e-01, PNorm = 35.2713, GNorm = 0.7472, lr_0 = 4.5104e-04
Validation rmse = 0.157712
Validation r2 = 0.814652
Epoch 21
Loss = 1.7878e-01, PNorm = 35.2855, GNorm = 3.7673, lr_0 = 4.4120e-04
Loss = 2.0797e-01, PNorm = 35.3015, GNorm = 3.0264, lr_0 = 4.3158e-04
Validation rmse = 0.161115
Validation r2 = 0.806566
Epoch 22
Loss = 2.0940e-01, PNorm = 35.3170, GNorm = 1.6137, lr_0 = 4.2123e-04
Loss = 1.8924e-01, PNorm = 35.3332, GNorm = 1.6450, lr_0 = 4.1204e-04
Validation rmse = 0.160148
Validation r2 = 0.808882
Epoch 23
Loss = 1.9539e-01, PNorm = 35.3500, GNorm = 4.1739, lr_0 = 4.0305e-04
Validation rmse = 0.162011
Validation r2 = 0.804408
Epoch 24
Loss = 1.3863e-01, PNorm = 35.3645, GNorm = 2.9368, lr_0 = 3.9426e-04
Loss = 1.8146e-01, PNorm = 35.3789, GNorm = 0.8840, lr_0 = 3.8566e-04
Validation rmse = 0.157223
Validation r2 = 0.815798
Epoch 25
Loss = 1.8618e-01, PNorm = 35.3925, GNorm = 0.9128, lr_0 = 3.7725e-04
Loss = 1.6314e-01, PNorm = 35.4045, GNorm = 1.8449, lr_0 = 3.6902e-04
Validation rmse = 0.156451
Validation r2 = 0.817604
Epoch 26
Loss = 1.5847e-01, PNorm = 35.4192, GNorm = 1.0266, lr_0 = 3.6017e-04
Loss = 1.9516e-01, PNorm = 35.4321, GNorm = 1.2187, lr_0 = 3.5232e-04
Validation rmse = 0.154976
Validation r2 = 0.821027
Epoch 27
Loss = 1.6552e-01, PNorm = 35.4450, GNorm = 2.0626, lr_0 = 3.4463e-04
Loss = 1.7715e-01, PNorm = 35.4559, GNorm = 2.3984, lr_0 = 3.3711e-04
Validation rmse = 0.156626
Validation r2 = 0.817195
Epoch 28
Loss = 1.4074e-01, PNorm = 35.4699, GNorm = 0.7195, lr_0 = 3.2976e-04
Loss = 1.7278e-01, PNorm = 35.4819, GNorm = 1.4286, lr_0 = 3.2257e-04
Validation rmse = 0.157864
Validation r2 = 0.814295
Epoch 29
Loss = 1.8150e-01, PNorm = 35.4922, GNorm = 2.3489, lr_0 = 3.1484e-04
Loss = 1.7401e-01, PNorm = 35.5047, GNorm = 0.7807, lr_0 = 3.0797e-04
Validation rmse = 0.155287
Validation r2 = 0.820308
Epoch 30
Loss = 1.6855e-01, PNorm = 35.5117, GNorm = 2.7151, lr_0 = 3.0125e-04
Loss = 1.7241e-01, PNorm = 35.5261, GNorm = 1.8445, lr_0 = 2.9468e-04
Validation rmse = 0.157091
Validation r2 = 0.816109
Epoch 31
Loss = 1.3961e-01, PNorm = 35.5375, GNorm = 2.2373, lr_0 = 2.8825e-04
Validation rmse = 0.157471
Validation r2 = 0.815218
Epoch 32
Loss = 9.6212e-02, PNorm = 35.5488, GNorm = 1.1290, lr_0 = 2.8196e-04
Loss = 1.5373e-01, PNorm = 35.5603, GNorm = 1.0186, lr_0 = 2.7581e-04
Validation rmse = 0.154794
Validation r2 = 0.821448
Epoch 33
Loss = 1.3988e-01, PNorm = 35.5707, GNorm = 3.2507, lr_0 = 2.6920e-04
Loss = 1.7495e-01, PNorm = 35.5797, GNorm = 0.6297, lr_0 = 2.6333e-04
Validation rmse = 0.158971
Validation r2 = 0.811682
Epoch 34
Loss = 1.9026e-01, PNorm = 35.5924, GNorm = 2.2714, lr_0 = 2.5758e-04
Loss = 1.4794e-01, PNorm = 35.6024, GNorm = 0.5284, lr_0 = 2.5197e-04
Validation rmse = 0.156133
Validation r2 = 0.818344
Epoch 35
Loss = 1.5224e-01, PNorm = 35.6113, GNorm = 1.4671, lr_0 = 2.4647e-04
Loss = 1.7045e-01, PNorm = 35.6208, GNorm = 0.9559, lr_0 = 2.4109e-04
Validation rmse = 0.155990
Validation r2 = 0.818678
Epoch 36
Loss = 1.5420e-01, PNorm = 35.6292, GNorm = 2.3064, lr_0 = 2.3531e-04
Loss = 1.6301e-01, PNorm = 35.6388, GNorm = 1.6343, lr_0 = 2.3018e-04
Validation rmse = 0.153619
Validation r2 = 0.824148
Epoch 37
Loss = 1.9915e-01, PNorm = 35.6492, GNorm = 5.1800, lr_0 = 2.2516e-04
Loss = 1.5580e-01, PNorm = 35.6600, GNorm = 3.3890, lr_0 = 2.2025e-04
Validation rmse = 0.152648
Validation r2 = 0.826364
Epoch 38
Loss = 1.5453e-01, PNorm = 35.6679, GNorm = 2.8139, lr_0 = 2.1544e-04
Loss = 1.7098e-01, PNorm = 35.6757, GNorm = 1.1965, lr_0 = 2.1074e-04
Validation rmse = 0.158145
Validation r2 = 0.813633
Epoch 39
Loss = 1.8000e-01, PNorm = 35.6854, GNorm = 3.5800, lr_0 = 2.0615e-04
Validation rmse = 0.155725
Validation r2 = 0.819292
Epoch 40
Loss = 1.4839e-01, PNorm = 35.6946, GNorm = 1.1110, lr_0 = 2.0121e-04
Loss = 1.3997e-01, PNorm = 35.7025, GNorm = 1.0378, lr_0 = 1.9682e-04
Validation rmse = 0.154352
Validation r2 = 0.822465
Epoch 41
Loss = 1.4596e-01, PNorm = 35.7094, GNorm = 0.8625, lr_0 = 1.9252e-04
Loss = 1.5992e-01, PNorm = 35.7149, GNorm = 1.9618, lr_0 = 1.8832e-04
Validation rmse = 0.155128
Validation r2 = 0.820676
Epoch 42
Loss = 1.6656e-01, PNorm = 35.7242, GNorm = 1.4411, lr_0 = 1.8422e-04
Loss = 1.5293e-01, PNorm = 35.7318, GNorm = 0.9932, lr_0 = 1.8020e-04
Validation rmse = 0.152900
Validation r2 = 0.825790
Epoch 43
Loss = 1.6769e-01, PNorm = 35.7393, GNorm = 0.8680, lr_0 = 1.7588e-04
Loss = 1.4509e-01, PNorm = 35.7465, GNorm = 1.7913, lr_0 = 1.7204e-04
Validation rmse = 0.153752
Validation r2 = 0.823843
Epoch 44
Loss = 1.5755e-01, PNorm = 35.7527, GNorm = 1.4872, lr_0 = 1.6829e-04
Loss = 1.4605e-01, PNorm = 35.7590, GNorm = 2.3225, lr_0 = 1.6462e-04
Validation rmse = 0.153662
Validation r2 = 0.824049
Epoch 45
Loss = 1.5356e-01, PNorm = 35.7667, GNorm = 1.3347, lr_0 = 1.6103e-04
Loss = 1.4784e-01, PNorm = 35.7718, GNorm = 2.5854, lr_0 = 1.5751e-04
Validation rmse = 0.154148
Validation r2 = 0.822934
Epoch 46
Loss = 1.3694e-01, PNorm = 35.7785, GNorm = 2.1760, lr_0 = 1.5408e-04
Validation rmse = 0.153550
Validation r2 = 0.824306
Epoch 47
Loss = 7.3325e-02, PNorm = 35.7857, GNorm = 1.3091, lr_0 = 1.5038e-04
Loss = 1.6569e-01, PNorm = 35.7919, GNorm = 3.5011, lr_0 = 1.4710e-04
Validation rmse = 0.154412
Validation r2 = 0.822328
Epoch 48
Loss = 1.2402e-01, PNorm = 35.7975, GNorm = 0.6981, lr_0 = 1.4390e-04
Loss = 1.5099e-01, PNorm = 35.8032, GNorm = 1.1292, lr_0 = 1.4076e-04
Validation rmse = 0.152734
Validation r2 = 0.826169
Epoch 49
Loss = 1.5640e-01, PNorm = 35.8092, GNorm = 2.1394, lr_0 = 1.3769e-04
Loss = 1.4578e-01, PNorm = 35.8134, GNorm = 2.2904, lr_0 = 1.3468e-04
Validation rmse = 0.153047
Validation r2 = 0.825454
Epoch 50
Loss = 1.5686e-01, PNorm = 35.8192, GNorm = 0.8329, lr_0 = 1.3174e-04
Loss = 1.4602e-01, PNorm = 35.8250, GNorm = 2.6446, lr_0 = 1.2887e-04
Validation rmse = 0.153587
Validation r2 = 0.824220
Epoch 51
Loss = 1.3305e-01, PNorm = 35.8303, GNorm = 2.2871, lr_0 = 1.2578e-04
Loss = 1.5040e-01, PNorm = 35.8368, GNorm = 1.0894, lr_0 = 1.2304e-04
Validation rmse = 0.153284
Validation r2 = 0.824913
Epoch 52
Loss = 1.3027e-01, PNorm = 35.8400, GNorm = 0.8091, lr_0 = 1.2035e-04
Loss = 1.3929e-01, PNorm = 35.8434, GNorm = 0.5810, lr_0 = 1.1773e-04
Validation rmse = 0.155341
Validation r2 = 0.820183
Epoch 53
Loss = 1.5371e-01, PNorm = 35.8495, GNorm = 0.9582, lr_0 = 1.1516e-04
Loss = 1.4136e-01, PNorm = 35.8546, GNorm = 1.4497, lr_0 = 1.1265e-04
Loss = 8.6525e-02, PNorm = 35.8552, GNorm = 2.5189, lr_0 = 1.1240e-04
Validation rmse = 0.153637
Validation r2 = 0.824107
Epoch 54
Loss = 1.4593e-01, PNorm = 35.8597, GNorm = 1.1513, lr_0 = 1.0995e-04
Validation rmse = 0.152743
Validation r2 = 0.826147
Epoch 55
Loss = 1.2839e-01, PNorm = 35.8646, GNorm = 0.9476, lr_0 = 1.0755e-04
Loss = 1.4770e-01, PNorm = 35.8692, GNorm = 0.9399, lr_0 = 1.0520e-04
Validation rmse = 0.152766
Validation r2 = 0.826096
Epoch 56
Loss = 1.3780e-01, PNorm = 35.8724, GNorm = 1.4229, lr_0 = 1.0291e-04
Loss = 1.2738e-01, PNorm = 35.8752, GNorm = 2.6661, lr_0 = 1.0066e-04
Validation rmse = 0.153470
Validation r2 = 0.824488
Epoch 57
Loss = 1.4449e-01, PNorm = 35.8798, GNorm = 1.1201, lr_0 = 1.0000e-04
Loss = 1.5027e-01, PNorm = 35.8844, GNorm = 0.5601, lr_0 = 1.0000e-04
Validation rmse = 0.152962
Validation r2 = 0.825649
Epoch 58
Loss = 1.1993e-01, PNorm = 35.8889, GNorm = 1.8078, lr_0 = 1.0000e-04
Loss = 1.5477e-01, PNorm = 35.8929, GNorm = 1.2238, lr_0 = 1.0000e-04
Validation rmse = 0.151552
Validation r2 = 0.828849
Epoch 59
Loss = 1.2649e-01, PNorm = 35.8971, GNorm = 1.2401, lr_0 = 1.0000e-04
Loss = 1.3073e-01, PNorm = 35.9009, GNorm = 1.2693, lr_0 = 1.0000e-04
Validation rmse = 0.151908
Validation r2 = 0.828042
Model 0 best validation rmse = 0.151552 on epoch 58
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.141786
Model 0 test r2 = 0.830039
Ensemble test rmse = 0.141786
Ensemble test r2 = 0.830039
Fold 5
Splitting data with seed 5
Total size = 1,170 | train size = 936 | val size = 117 | test size = 117
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.0362e-01, PNorm = 34.0148, GNorm = 3.5092, lr_0 = 3.7500e-04
Validation rmse = 0.302341
Validation r2 = 0.198883
Epoch 1
Loss = 7.2525e-01, PNorm = 34.0410, GNorm = 4.7069, lr_0 = 6.5000e-04
Loss = 7.1586e-01, PNorm = 34.0783, GNorm = 7.1186, lr_0 = 9.0000e-04
Validation rmse = 0.327565
Validation r2 = 0.059636
Epoch 2
Loss = 7.5809e-01, PNorm = 34.1337, GNorm = 2.4527, lr_0 = 9.8685e-04
Loss = 6.1490e-01, PNorm = 34.2045, GNorm = 1.2953, lr_0 = 9.6533e-04
Validation rmse = 0.226111
Validation r2 = 0.551931
Epoch 3
Loss = 4.9299e-01, PNorm = 34.2723, GNorm = 5.4571, lr_0 = 9.4427e-04
Loss = 4.7852e-01, PNorm = 34.3338, GNorm = 5.2196, lr_0 = 9.2367e-04
Validation rmse = 0.217047
Validation r2 = 0.587136
Epoch 4
Loss = 3.7638e-01, PNorm = 34.3997, GNorm = 4.0331, lr_0 = 9.0153e-04
Loss = 3.2985e-01, PNorm = 34.4561, GNorm = 2.0870, lr_0 = 8.8187e-04
Validation rmse = 0.190729
Validation r2 = 0.681187
Epoch 5
Loss = 3.5729e-01, PNorm = 34.5109, GNorm = 6.5381, lr_0 = 8.6263e-04
Loss = 3.0661e-01, PNorm = 34.5536, GNorm = 3.3591, lr_0 = 8.4381e-04
Validation rmse = 0.194459
Validation r2 = 0.668598
Epoch 6
Loss = 2.7845e-01, PNorm = 34.5953, GNorm = 3.2040, lr_0 = 8.2540e-04
Loss = 2.9789e-01, PNorm = 34.6341, GNorm = 0.6953, lr_0 = 8.0740e-04
Validation rmse = 0.191382
Validation r2 = 0.679001
Epoch 7
Loss = 2.6659e-01, PNorm = 34.6707, GNorm = 4.8339, lr_0 = 7.8979e-04
Validation rmse = 0.185670
Validation r2 = 0.697877
Epoch 8
Loss = 2.9067e-01, PNorm = 34.7072, GNorm = 1.8047, lr_0 = 7.7086e-04
Loss = 2.6158e-01, PNorm = 34.7416, GNorm = 4.4383, lr_0 = 7.5404e-04
Validation rmse = 0.178761
Validation r2 = 0.719944
Epoch 9
Loss = 1.6243e-01, PNorm = 34.7672, GNorm = 1.4015, lr_0 = 7.3759e-04
Loss = 2.9089e-01, PNorm = 34.7979, GNorm = 4.9572, lr_0 = 7.2150e-04
Validation rmse = 0.170297
Validation r2 = 0.745836
Epoch 10
Loss = 2.0355e-01, PNorm = 34.8263, GNorm = 2.8558, lr_0 = 7.0576e-04
Loss = 2.4529e-01, PNorm = 34.8510, GNorm = 5.9014, lr_0 = 6.9037e-04
Validation rmse = 0.172708
Validation r2 = 0.738589
Epoch 11
Loss = 2.1860e-01, PNorm = 34.8836, GNorm = 1.5571, lr_0 = 6.7382e-04
Loss = 2.4728e-01, PNorm = 34.9067, GNorm = 2.2787, lr_0 = 6.5912e-04
Validation rmse = 0.191746
Validation r2 = 0.677779
Epoch 12
Loss = 3.1131e-01, PNorm = 34.9296, GNorm = 3.6501, lr_0 = 6.4474e-04
Loss = 2.1273e-01, PNorm = 34.9507, GNorm = 1.6777, lr_0 = 6.3068e-04
Validation rmse = 0.159512
Validation r2 = 0.777010
Epoch 13
Loss = 1.9536e-01, PNorm = 34.9745, GNorm = 3.3584, lr_0 = 6.1692e-04
Loss = 2.4231e-01, PNorm = 34.9979, GNorm = 2.3210, lr_0 = 6.0346e-04
Validation rmse = 0.170810
Validation r2 = 0.744302
Epoch 14
Loss = 2.0898e-01, PNorm = 35.0162, GNorm = 0.8098, lr_0 = 5.9030e-04
Loss = 2.0482e-01, PNorm = 35.0368, GNorm = 1.4241, lr_0 = 5.7742e-04
Loss = 1.3716e-01, PNorm = 35.0393, GNorm = 1.6965, lr_0 = 5.7615e-04
Validation rmse = 0.155306
Validation r2 = 0.788614
Epoch 15
Loss = 2.0148e-01, PNorm = 35.0572, GNorm = 3.2050, lr_0 = 5.6358e-04
Validation rmse = 0.160577
Validation r2 = 0.774021
Epoch 16
Loss = 1.7027e-01, PNorm = 35.0746, GNorm = 2.5819, lr_0 = 5.5129e-04
Loss = 2.1362e-01, PNorm = 35.0906, GNorm = 2.0343, lr_0 = 5.3926e-04
Validation rmse = 0.158975
Validation r2 = 0.778509
Epoch 17
Loss = 2.4391e-01, PNorm = 35.1074, GNorm = 0.8406, lr_0 = 5.2750e-04
Loss = 1.9177e-01, PNorm = 35.1246, GNorm = 0.8438, lr_0 = 5.1599e-04
Validation rmse = 0.156507
Validation r2 = 0.785331
Epoch 18
Loss = 1.9306e-01, PNorm = 35.1430, GNorm = 2.8770, lr_0 = 5.0362e-04
Loss = 1.8053e-01, PNorm = 35.1597, GNorm = 1.1354, lr_0 = 4.9264e-04
Validation rmse = 0.155526
Validation r2 = 0.788014
Epoch 19
Loss = 1.7472e-01, PNorm = 35.1728, GNorm = 0.6379, lr_0 = 4.8189e-04
Loss = 2.0270e-01, PNorm = 35.1869, GNorm = 2.6921, lr_0 = 4.7138e-04
Validation rmse = 0.165913
Validation r2 = 0.758754
Epoch 20
Loss = 1.8870e-01, PNorm = 35.2017, GNorm = 0.8587, lr_0 = 4.6110e-04
Loss = 1.7391e-01, PNorm = 35.2166, GNorm = 1.2762, lr_0 = 4.5104e-04
Validation rmse = 0.166978
Validation r2 = 0.755647
Epoch 21
Loss = 1.7402e-01, PNorm = 35.2320, GNorm = 1.5075, lr_0 = 4.4120e-04
Loss = 1.9001e-01, PNorm = 35.2481, GNorm = 4.5956, lr_0 = 4.3158e-04
Validation rmse = 0.163143
Validation r2 = 0.766742
Epoch 22
Loss = 2.0072e-01, PNorm = 35.2694, GNorm = 2.5813, lr_0 = 4.2123e-04
Loss = 1.7414e-01, PNorm = 35.2836, GNorm = 2.3664, lr_0 = 4.1204e-04
Validation rmse = 0.166996
Validation r2 = 0.755593
Epoch 23
Loss = 2.0250e-01, PNorm = 35.2987, GNorm = 0.7281, lr_0 = 4.0305e-04
Validation rmse = 0.154660
Validation r2 = 0.790368
Epoch 24
Loss = 7.9782e-02, PNorm = 35.3151, GNorm = 1.4085, lr_0 = 3.9426e-04
Loss = 1.8125e-01, PNorm = 35.3308, GNorm = 2.6082, lr_0 = 3.8566e-04
Validation rmse = 0.155976
Validation r2 = 0.786786
Epoch 25
Loss = 1.2331e-01, PNorm = 35.3453, GNorm = 2.5350, lr_0 = 3.7725e-04
Loss = 1.7866e-01, PNorm = 35.3615, GNorm = 0.9743, lr_0 = 3.6902e-04
Validation rmse = 0.158639
Validation r2 = 0.779442
Epoch 26
Loss = 1.4163e-01, PNorm = 35.3737, GNorm = 1.0546, lr_0 = 3.6017e-04
Loss = 1.6957e-01, PNorm = 35.3867, GNorm = 3.1827, lr_0 = 3.5232e-04
Validation rmse = 0.154766
Validation r2 = 0.790082
Epoch 27
Loss = 1.7654e-01, PNorm = 35.4016, GNorm = 1.3224, lr_0 = 3.4463e-04
Loss = 1.5251e-01, PNorm = 35.4132, GNorm = 1.8961, lr_0 = 3.3711e-04
Validation rmse = 0.161746
Validation r2 = 0.770719
Epoch 28
Loss = 1.6141e-01, PNorm = 35.4280, GNorm = 1.1126, lr_0 = 3.2976e-04
Loss = 1.6265e-01, PNorm = 35.4405, GNorm = 1.9800, lr_0 = 3.2257e-04
Validation rmse = 0.159846
Validation r2 = 0.776074
Epoch 29
Loss = 1.6484e-01, PNorm = 35.4549, GNorm = 0.7779, lr_0 = 3.1484e-04
Loss = 1.5795e-01, PNorm = 35.4685, GNorm = 1.3650, lr_0 = 3.0797e-04
Validation rmse = 0.153748
Validation r2 = 0.792834
Epoch 30
Loss = 1.5149e-01, PNorm = 35.4786, GNorm = 1.4477, lr_0 = 3.0125e-04
Loss = 1.5891e-01, PNorm = 35.4904, GNorm = 1.3262, lr_0 = 2.9468e-04
Validation rmse = 0.156165
Validation r2 = 0.786269
Epoch 31
Loss = 1.3983e-01, PNorm = 35.5004, GNorm = 0.8442, lr_0 = 2.8825e-04
Validation rmse = 0.157225
Validation r2 = 0.783357
Epoch 32
Loss = 1.0785e-01, PNorm = 35.5130, GNorm = 2.1691, lr_0 = 2.8196e-04
Loss = 1.4880e-01, PNorm = 35.5228, GNorm = 1.0471, lr_0 = 2.7581e-04
Validation rmse = 0.158405
Validation r2 = 0.780092
Epoch 33
Loss = 1.5323e-01, PNorm = 35.5350, GNorm = 1.7259, lr_0 = 2.6920e-04
Loss = 1.5184e-01, PNorm = 35.5483, GNorm = 0.8400, lr_0 = 2.6333e-04
Validation rmse = 0.158973
Validation r2 = 0.778513
Epoch 34
Loss = 1.4876e-01, PNorm = 35.5578, GNorm = 0.7312, lr_0 = 2.5758e-04
Loss = 1.5909e-01, PNorm = 35.5668, GNorm = 1.7032, lr_0 = 2.5197e-04
Validation rmse = 0.156778
Validation r2 = 0.784587
Epoch 35
Loss = 1.4097e-01, PNorm = 35.5768, GNorm = 0.6251, lr_0 = 2.4647e-04
Loss = 1.4608e-01, PNorm = 35.5850, GNorm = 1.5544, lr_0 = 2.4109e-04
Validation rmse = 0.157650
Validation r2 = 0.782184
Epoch 36
Loss = 1.3144e-01, PNorm = 35.5971, GNorm = 1.0305, lr_0 = 2.3531e-04
Loss = 1.5720e-01, PNorm = 35.6085, GNorm = 1.3733, lr_0 = 2.3018e-04
Validation rmse = 0.158795
Validation r2 = 0.779010
Epoch 37
Loss = 1.4408e-01, PNorm = 35.6190, GNorm = 4.4717, lr_0 = 2.2516e-04
Loss = 1.6625e-01, PNorm = 35.6266, GNorm = 1.5947, lr_0 = 2.2025e-04
Validation rmse = 0.161506
Validation r2 = 0.771398
Epoch 38
Loss = 1.6140e-01, PNorm = 35.6354, GNorm = 1.3371, lr_0 = 2.1544e-04
Loss = 1.4373e-01, PNorm = 35.6435, GNorm = 4.5401, lr_0 = 2.1074e-04
Validation rmse = 0.157973
Validation r2 = 0.781292
Epoch 39
Loss = 1.5600e-01, PNorm = 35.6518, GNorm = 2.6073, lr_0 = 2.0615e-04
Validation rmse = 0.155339
Validation r2 = 0.788523
Epoch 40
Loss = 1.5440e-01, PNorm = 35.6614, GNorm = 1.0463, lr_0 = 2.0121e-04
Loss = 1.3150e-01, PNorm = 35.6694, GNorm = 1.2130, lr_0 = 1.9682e-04
Validation rmse = 0.158767
Validation r2 = 0.779088
Epoch 41
Loss = 1.5725e-01, PNorm = 35.6754, GNorm = 1.1844, lr_0 = 1.9252e-04
Loss = 1.4169e-01, PNorm = 35.6817, GNorm = 0.9145, lr_0 = 1.8832e-04
Validation rmse = 0.156315
Validation r2 = 0.785858
Epoch 42
Loss = 1.4867e-01, PNorm = 35.6898, GNorm = 1.1645, lr_0 = 1.8422e-04
Loss = 1.3894e-01, PNorm = 35.6965, GNorm = 1.1188, lr_0 = 1.8020e-04
Validation rmse = 0.157017
Validation r2 = 0.783930
Epoch 43
Loss = 1.5054e-01, PNorm = 35.7060, GNorm = 1.6860, lr_0 = 1.7588e-04
Loss = 1.3622e-01, PNorm = 35.7129, GNorm = 1.9963, lr_0 = 1.7204e-04
Validation rmse = 0.160735
Validation r2 = 0.773577
Epoch 44
Loss = 1.5453e-01, PNorm = 35.7189, GNorm = 2.5103, lr_0 = 1.6829e-04
Loss = 1.3956e-01, PNorm = 35.7256, GNorm = 1.8022, lr_0 = 1.6462e-04
Validation rmse = 0.158942
Validation r2 = 0.778599
Epoch 45
Loss = 1.3720e-01, PNorm = 35.7316, GNorm = 0.8313, lr_0 = 1.6103e-04
Loss = 1.2986e-01, PNorm = 35.7382, GNorm = 1.2863, lr_0 = 1.5751e-04
Validation rmse = 0.160213
Validation r2 = 0.775044
Epoch 46
Loss = 1.2567e-01, PNorm = 35.7445, GNorm = 1.7386, lr_0 = 1.5408e-04
Validation rmse = 0.160409
Validation r2 = 0.774495
Epoch 47
Loss = 9.9023e-02, PNorm = 35.7508, GNorm = 0.6053, lr_0 = 1.5038e-04
Loss = 1.3229e-01, PNorm = 35.7575, GNorm = 1.7450, lr_0 = 1.4710e-04
Validation rmse = 0.159865
Validation r2 = 0.776022
Epoch 48
Loss = 1.0812e-01, PNorm = 35.7627, GNorm = 0.8154, lr_0 = 1.4390e-04
Loss = 1.4005e-01, PNorm = 35.7675, GNorm = 2.2670, lr_0 = 1.4076e-04
Validation rmse = 0.160256
Validation r2 = 0.774923
Epoch 49
Loss = 1.2508e-01, PNorm = 35.7736, GNorm = 1.1434, lr_0 = 1.3769e-04
Loss = 1.4743e-01, PNorm = 35.7795, GNorm = 1.2572, lr_0 = 1.3468e-04
Validation rmse = 0.165118
Validation r2 = 0.761060
Epoch 50
Loss = 1.5264e-01, PNorm = 35.7843, GNorm = 1.2597, lr_0 = 1.3174e-04
Loss = 1.3478e-01, PNorm = 35.7900, GNorm = 1.0873, lr_0 = 1.2887e-04
Validation rmse = 0.158385
Validation r2 = 0.780150
Epoch 51
Loss = 1.2440e-01, PNorm = 35.7936, GNorm = 0.9889, lr_0 = 1.2578e-04
Loss = 1.3147e-01, PNorm = 35.7982, GNorm = 1.0918, lr_0 = 1.2304e-04
Validation rmse = 0.155400
Validation r2 = 0.788358
Epoch 52
Loss = 1.2780e-01, PNorm = 35.8029, GNorm = 0.9451, lr_0 = 1.2035e-04
Loss = 1.3649e-01, PNorm = 35.8075, GNorm = 1.4076, lr_0 = 1.1773e-04
Validation rmse = 0.159152
Validation r2 = 0.778015
Epoch 53
Loss = 1.2914e-01, PNorm = 35.8125, GNorm = 1.0961, lr_0 = 1.1516e-04
Loss = 1.3015e-01, PNorm = 35.8166, GNorm = 0.6113, lr_0 = 1.1265e-04
Loss = 1.6530e-01, PNorm = 35.8170, GNorm = 2.5744, lr_0 = 1.1240e-04
Validation rmse = 0.164405
Validation r2 = 0.763119
Epoch 54
Loss = 1.2125e-01, PNorm = 35.8213, GNorm = 0.8614, lr_0 = 1.0995e-04
Validation rmse = 0.156840
Validation r2 = 0.784418
Epoch 55
Loss = 1.0900e-01, PNorm = 35.8265, GNorm = 1.0479, lr_0 = 1.0755e-04
Loss = 1.3116e-01, PNorm = 35.8307, GNorm = 1.4569, lr_0 = 1.0520e-04
Validation rmse = 0.163370
Validation r2 = 0.766091
Epoch 56
Loss = 1.2944e-01, PNorm = 35.8343, GNorm = 1.0859, lr_0 = 1.0291e-04
Loss = 1.3507e-01, PNorm = 35.8388, GNorm = 0.8173, lr_0 = 1.0066e-04
Validation rmse = 0.159205
Validation r2 = 0.777866
Epoch 57
Loss = 1.7622e-01, PNorm = 35.8425, GNorm = 0.6997, lr_0 = 1.0000e-04
Loss = 1.1799e-01, PNorm = 35.8468, GNorm = 1.3328, lr_0 = 1.0000e-04
Validation rmse = 0.157410
Validation r2 = 0.782846
Epoch 58
Loss = 1.5774e-01, PNorm = 35.8502, GNorm = 2.1097, lr_0 = 1.0000e-04
Loss = 1.1831e-01, PNorm = 35.8536, GNorm = 1.1820, lr_0 = 1.0000e-04
Validation rmse = 0.161221
Validation r2 = 0.772204
Epoch 59
Loss = 1.5138e-01, PNorm = 35.8579, GNorm = 0.6482, lr_0 = 1.0000e-04
Loss = 1.1605e-01, PNorm = 35.8617, GNorm = 1.2070, lr_0 = 1.0000e-04
Validation rmse = 0.162805
Validation r2 = 0.767706
Model 0 best validation rmse = 0.153748 on epoch 29
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.175356
Model 0 test r2 = 0.746429
Ensemble test rmse = 0.175356
Ensemble test r2 = 0.746429
Fold 6
Splitting data with seed 6
Total size = 1,170 | train size = 936 | val size = 117 | test size = 117
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.7795e-01, PNorm = 34.0161, GNorm = 3.3196, lr_0 = 3.7500e-04
Validation rmse = 0.321364
Validation r2 = 0.154548
Epoch 1
Loss = 6.7420e-01, PNorm = 34.0351, GNorm = 1.1392, lr_0 = 6.5000e-04
Loss = 7.7320e-01, PNorm = 34.0753, GNorm = 4.3089, lr_0 = 9.0000e-04
Validation rmse = 0.277135
Validation r2 = 0.371250
Epoch 2
Loss = 6.3974e-01, PNorm = 34.1424, GNorm = 2.1196, lr_0 = 9.8685e-04
Loss = 5.0189e-01, PNorm = 34.2173, GNorm = 6.2313, lr_0 = 9.6533e-04
Validation rmse = 0.230893
Validation r2 = 0.563569
Epoch 3
Loss = 4.1913e-01, PNorm = 34.2860, GNorm = 5.2429, lr_0 = 9.4427e-04
Loss = 4.2665e-01, PNorm = 34.3566, GNorm = 1.0819, lr_0 = 9.2367e-04
Validation rmse = 0.241586
Validation r2 = 0.522208
Epoch 4
Loss = 4.7047e-01, PNorm = 34.4172, GNorm = 2.1519, lr_0 = 9.0153e-04
Loss = 4.3101e-01, PNorm = 34.4747, GNorm = 4.2060, lr_0 = 8.8187e-04
Validation rmse = 0.221126
Validation r2 = 0.599712
Epoch 5
Loss = 2.7743e-01, PNorm = 34.5301, GNorm = 1.7867, lr_0 = 8.6263e-04
Loss = 3.5840e-01, PNorm = 34.5807, GNorm = 1.1854, lr_0 = 8.4381e-04
Validation rmse = 0.206297
Validation r2 = 0.651598
Epoch 6
Loss = 3.1963e-01, PNorm = 34.6375, GNorm = 1.4723, lr_0 = 8.2540e-04
Loss = 2.4991e-01, PNorm = 34.6840, GNorm = 2.7769, lr_0 = 8.0740e-04
Validation rmse = 0.195136
Validation r2 = 0.688277
Epoch 7
Loss = 2.7662e-01, PNorm = 34.7230, GNorm = 1.2569, lr_0 = 7.8979e-04
Validation rmse = 0.182438
Validation r2 = 0.727526
Epoch 8
Loss = 1.9416e-01, PNorm = 34.7617, GNorm = 2.5602, lr_0 = 7.7086e-04
Loss = 2.4563e-01, PNorm = 34.7922, GNorm = 2.6805, lr_0 = 7.5404e-04
Validation rmse = 0.189886
Validation r2 = 0.704826
Epoch 9
Loss = 2.5054e-01, PNorm = 34.8254, GNorm = 1.7390, lr_0 = 7.3759e-04
Loss = 2.5257e-01, PNorm = 34.8594, GNorm = 1.8700, lr_0 = 7.2150e-04
Validation rmse = 0.187027
Validation r2 = 0.713646
Epoch 10
Loss = 2.6542e-01, PNorm = 34.8853, GNorm = 2.7646, lr_0 = 7.0576e-04
Loss = 2.4683e-01, PNorm = 34.9149, GNorm = 1.2311, lr_0 = 6.9037e-04
Validation rmse = 0.193237
Validation r2 = 0.694314
Epoch 11
Loss = 2.2918e-01, PNorm = 34.9435, GNorm = 2.5988, lr_0 = 6.7382e-04
Loss = 2.2315e-01, PNorm = 34.9707, GNorm = 1.3833, lr_0 = 6.5912e-04
Validation rmse = 0.166221
Validation r2 = 0.773814
Epoch 12
Loss = 2.2380e-01, PNorm = 34.9949, GNorm = 1.1543, lr_0 = 6.4474e-04
Loss = 2.0941e-01, PNorm = 35.0155, GNorm = 2.6291, lr_0 = 6.3068e-04
Validation rmse = 0.169158
Validation r2 = 0.765750
Epoch 13
Loss = 1.9738e-01, PNorm = 35.0362, GNorm = 1.7553, lr_0 = 6.1692e-04
Loss = 2.1819e-01, PNorm = 35.0568, GNorm = 6.7812, lr_0 = 6.0346e-04
Validation rmse = 0.207827
Validation r2 = 0.646410
Epoch 14
Loss = 3.1587e-01, PNorm = 35.0792, GNorm = 3.9847, lr_0 = 5.9030e-04
Loss = 2.4762e-01, PNorm = 35.1121, GNorm = 4.3024, lr_0 = 5.7742e-04
Loss = 3.6485e-01, PNorm = 35.1149, GNorm = 5.3553, lr_0 = 5.7615e-04
Validation rmse = 0.174388
Validation r2 = 0.751041
Epoch 15
Loss = 2.3225e-01, PNorm = 35.1413, GNorm = 1.8014, lr_0 = 5.6358e-04
Validation rmse = 0.166168
Validation r2 = 0.773960
Epoch 16
Loss = 1.8598e-01, PNorm = 35.1648, GNorm = 1.4734, lr_0 = 5.5129e-04
Loss = 2.2678e-01, PNorm = 35.1869, GNorm = 2.5265, lr_0 = 5.3926e-04
Validation rmse = 0.158253
Validation r2 = 0.794978
Epoch 17
Loss = 2.0024e-01, PNorm = 35.2072, GNorm = 1.5700, lr_0 = 5.2750e-04
Loss = 1.9650e-01, PNorm = 35.2243, GNorm = 0.7413, lr_0 = 5.1599e-04
Validation rmse = 0.160585
Validation r2 = 0.788893
Epoch 18
Loss = 2.0500e-01, PNorm = 35.2461, GNorm = 0.7078, lr_0 = 5.0362e-04
Loss = 1.8816e-01, PNorm = 35.2611, GNorm = 0.9453, lr_0 = 4.9264e-04
Validation rmse = 0.162741
Validation r2 = 0.783187
Epoch 19
Loss = 1.8045e-01, PNorm = 35.2762, GNorm = 1.5598, lr_0 = 4.8189e-04
Loss = 1.8972e-01, PNorm = 35.2988, GNorm = 1.0081, lr_0 = 4.7138e-04
Validation rmse = 0.156459
Validation r2 = 0.799602
Epoch 20
Loss = 1.7160e-01, PNorm = 35.3099, GNorm = 1.6007, lr_0 = 4.6110e-04
Loss = 1.9588e-01, PNorm = 35.3248, GNorm = 2.5456, lr_0 = 4.5104e-04
Validation rmse = 0.153653
Validation r2 = 0.806725
Epoch 21
Loss = 1.7396e-01, PNorm = 35.3427, GNorm = 2.5799, lr_0 = 4.4120e-04
Loss = 2.0441e-01, PNorm = 35.3607, GNorm = 3.6532, lr_0 = 4.3158e-04
Validation rmse = 0.153781
Validation r2 = 0.806403
Epoch 22
Loss = 2.1255e-01, PNorm = 35.3782, GNorm = 0.7010, lr_0 = 4.2123e-04
Loss = 1.7376e-01, PNorm = 35.3949, GNorm = 3.7487, lr_0 = 4.1204e-04
Validation rmse = 0.161465
Validation r2 = 0.786571
Epoch 23
Loss = 1.9814e-01, PNorm = 35.4123, GNorm = 1.6645, lr_0 = 4.0305e-04
Validation rmse = 0.156238
Validation r2 = 0.800167
Epoch 24
Loss = 1.9051e-01, PNorm = 35.4253, GNorm = 2.5104, lr_0 = 3.9426e-04
Loss = 2.0111e-01, PNorm = 35.4410, GNorm = 1.4495, lr_0 = 3.8566e-04
Validation rmse = 0.155838
Validation r2 = 0.801189
Epoch 25
Loss = 1.9780e-01, PNorm = 35.4539, GNorm = 0.8054, lr_0 = 3.7725e-04
Loss = 1.5652e-01, PNorm = 35.4678, GNorm = 1.2188, lr_0 = 3.6902e-04
Validation rmse = 0.153998
Validation r2 = 0.805857
Epoch 26
Loss = 1.6944e-01, PNorm = 35.4833, GNorm = 2.7649, lr_0 = 3.6017e-04
Loss = 1.8411e-01, PNorm = 35.4948, GNorm = 2.5097, lr_0 = 3.5232e-04
Validation rmse = 0.154828
Validation r2 = 0.803758
Epoch 27
Loss = 1.9045e-01, PNorm = 35.5087, GNorm = 2.6895, lr_0 = 3.4463e-04
Loss = 1.8821e-01, PNorm = 35.5254, GNorm = 5.5649, lr_0 = 3.3711e-04
Validation rmse = 0.155062
Validation r2 = 0.803163
Epoch 28
Loss = 1.8985e-01, PNorm = 35.5378, GNorm = 4.0365, lr_0 = 3.2976e-04
Loss = 1.7618e-01, PNorm = 35.5520, GNorm = 1.2945, lr_0 = 3.2257e-04
Validation rmse = 0.152041
Validation r2 = 0.810760
Epoch 29
Loss = 1.6502e-01, PNorm = 35.5660, GNorm = 1.0324, lr_0 = 3.1484e-04
Loss = 1.5095e-01, PNorm = 35.5801, GNorm = 0.7114, lr_0 = 3.0797e-04
Validation rmse = 0.169775
Validation r2 = 0.764039
Epoch 30
Loss = 1.6624e-01, PNorm = 35.5917, GNorm = 0.4100, lr_0 = 3.0125e-04
Loss = 1.8167e-01, PNorm = 35.6036, GNorm = 1.6693, lr_0 = 2.9468e-04
Validation rmse = 0.151626
Validation r2 = 0.811792
Epoch 31
Loss = 1.6219e-01, PNorm = 35.6166, GNorm = 1.6626, lr_0 = 2.8825e-04
Validation rmse = 0.156733
Validation r2 = 0.798900
Epoch 32
Loss = 1.0993e-01, PNorm = 35.6278, GNorm = 1.0736, lr_0 = 2.8196e-04
Loss = 1.5726e-01, PNorm = 35.6391, GNorm = 0.6383, lr_0 = 2.7581e-04
Validation rmse = 0.154325
Validation r2 = 0.805030
Epoch 33
Loss = 1.6917e-01, PNorm = 35.6500, GNorm = 0.9866, lr_0 = 2.6920e-04
Loss = 1.7700e-01, PNorm = 35.6614, GNorm = 1.4313, lr_0 = 2.6333e-04
Validation rmse = 0.153771
Validation r2 = 0.806428
Epoch 34
Loss = 1.6182e-01, PNorm = 35.6716, GNorm = 0.9575, lr_0 = 2.5758e-04
Loss = 1.4612e-01, PNorm = 35.6810, GNorm = 2.2269, lr_0 = 2.5197e-04
Validation rmse = 0.157970
Validation r2 = 0.795713
Epoch 35
Loss = 1.5766e-01, PNorm = 35.6922, GNorm = 1.6397, lr_0 = 2.4647e-04
Loss = 1.4120e-01, PNorm = 35.7022, GNorm = 1.5260, lr_0 = 2.4109e-04
Validation rmse = 0.149373
Validation r2 = 0.817342
Epoch 36
Loss = 1.4416e-01, PNorm = 35.7122, GNorm = 1.9193, lr_0 = 2.3531e-04
Loss = 1.6337e-01, PNorm = 35.7226, GNorm = 2.4487, lr_0 = 2.3018e-04
Validation rmse = 0.158896
Validation r2 = 0.793309
Epoch 37
Loss = 1.3237e-01, PNorm = 35.7332, GNorm = 0.9372, lr_0 = 2.2516e-04
Loss = 1.7369e-01, PNorm = 35.7418, GNorm = 2.4702, lr_0 = 2.2025e-04
Validation rmse = 0.150851
Validation r2 = 0.813709
Epoch 38
Loss = 1.4448e-01, PNorm = 35.7496, GNorm = 1.4421, lr_0 = 2.1544e-04
Loss = 1.6747e-01, PNorm = 35.7580, GNorm = 2.7458, lr_0 = 2.1074e-04
Validation rmse = 0.153272
Validation r2 = 0.807683
Epoch 39
Loss = 1.4464e-01, PNorm = 35.7688, GNorm = 3.7587, lr_0 = 2.0615e-04
Validation rmse = 0.151454
Validation r2 = 0.812217
Epoch 40
Loss = 2.0859e-01, PNorm = 35.7787, GNorm = 2.6018, lr_0 = 2.0121e-04
Loss = 1.3583e-01, PNorm = 35.7895, GNorm = 1.8624, lr_0 = 1.9682e-04
Validation rmse = 0.162930
Validation r2 = 0.782682
Epoch 41
Loss = 1.3957e-01, PNorm = 35.7972, GNorm = 0.8630, lr_0 = 1.9252e-04
Loss = 1.5634e-01, PNorm = 35.8038, GNorm = 1.0527, lr_0 = 1.8832e-04
Validation rmse = 0.151229
Validation r2 = 0.812774
Epoch 42
Loss = 1.4998e-01, PNorm = 35.8119, GNorm = 1.6799, lr_0 = 1.8422e-04
Loss = 1.4895e-01, PNorm = 35.8204, GNorm = 1.3960, lr_0 = 1.8020e-04
Validation rmse = 0.147624
Validation r2 = 0.821594
Epoch 43
Loss = 1.8002e-01, PNorm = 35.8268, GNorm = 3.2069, lr_0 = 1.7588e-04
Loss = 1.3410e-01, PNorm = 35.8344, GNorm = 0.7267, lr_0 = 1.7204e-04
Validation rmse = 0.152078
Validation r2 = 0.810667
Epoch 44
Loss = 1.2680e-01, PNorm = 35.8429, GNorm = 2.3452, lr_0 = 1.6829e-04
Loss = 1.5690e-01, PNorm = 35.8503, GNorm = 2.1699, lr_0 = 1.6462e-04
Validation rmse = 0.151961
Validation r2 = 0.810957
Epoch 45
Loss = 1.3407e-01, PNorm = 35.8565, GNorm = 0.7271, lr_0 = 1.6103e-04
Loss = 1.4455e-01, PNorm = 35.8638, GNorm = 2.6885, lr_0 = 1.5751e-04
Validation rmse = 0.150345
Validation r2 = 0.814956
Epoch 46
Loss = 1.3259e-01, PNorm = 35.8705, GNorm = 1.4867, lr_0 = 1.5408e-04
Validation rmse = 0.158765
Validation r2 = 0.793651
Epoch 47
Loss = 1.0056e-01, PNorm = 35.8781, GNorm = 0.8868, lr_0 = 1.5038e-04
Loss = 1.4589e-01, PNorm = 35.8841, GNorm = 0.7702, lr_0 = 1.4710e-04
Validation rmse = 0.152888
Validation r2 = 0.808645
Epoch 48
Loss = 9.6177e-02, PNorm = 35.8904, GNorm = 2.0012, lr_0 = 1.4390e-04
Loss = 1.3183e-01, PNorm = 35.8970, GNorm = 0.8897, lr_0 = 1.4076e-04
Validation rmse = 0.148615
Validation r2 = 0.819192
Epoch 49
Loss = 1.6364e-01, PNorm = 35.9036, GNorm = 1.5294, lr_0 = 1.3769e-04
Loss = 1.3691e-01, PNorm = 35.9090, GNorm = 0.6169, lr_0 = 1.3468e-04
Validation rmse = 0.151697
Validation r2 = 0.811613
Epoch 50
Loss = 1.0974e-01, PNorm = 35.9160, GNorm = 1.8296, lr_0 = 1.3174e-04
Loss = 1.4330e-01, PNorm = 35.9214, GNorm = 0.5080, lr_0 = 1.2887e-04
Validation rmse = 0.150743
Validation r2 = 0.813977
Epoch 51
Loss = 1.4982e-01, PNorm = 35.9281, GNorm = 2.5448, lr_0 = 1.2578e-04
Loss = 1.3609e-01, PNorm = 35.9340, GNorm = 1.3116, lr_0 = 1.2304e-04
Validation rmse = 0.148926
Validation r2 = 0.818434
Epoch 52
Loss = 1.2604e-01, PNorm = 35.9389, GNorm = 1.3197, lr_0 = 1.2035e-04
Loss = 1.3764e-01, PNorm = 35.9439, GNorm = 1.0123, lr_0 = 1.1773e-04
Validation rmse = 0.148442
Validation r2 = 0.819612
Epoch 53
Loss = 1.5042e-01, PNorm = 35.9497, GNorm = 0.8916, lr_0 = 1.1516e-04
Loss = 1.2008e-01, PNorm = 35.9542, GNorm = 1.1802, lr_0 = 1.1265e-04
Loss = 1.2284e-01, PNorm = 35.9547, GNorm = 1.1736, lr_0 = 1.1240e-04
Validation rmse = 0.154852
Validation r2 = 0.803696
Epoch 54
Loss = 1.3844e-01, PNorm = 35.9589, GNorm = 1.2811, lr_0 = 1.0995e-04
Validation rmse = 0.167741
Validation r2 = 0.769660
Epoch 55
Loss = 2.3950e-01, PNorm = 35.9646, GNorm = 4.7252, lr_0 = 1.0755e-04
Loss = 1.5082e-01, PNorm = 35.9688, GNorm = 0.6941, lr_0 = 1.0520e-04
Validation rmse = 0.151997
Validation r2 = 0.810868
Epoch 56
Loss = 1.0580e-01, PNorm = 35.9734, GNorm = 0.8336, lr_0 = 1.0291e-04
Loss = 1.3728e-01, PNorm = 35.9788, GNorm = 1.5174, lr_0 = 1.0066e-04
Validation rmse = 0.149265
Validation r2 = 0.817607
Epoch 57
Loss = 1.3936e-01, PNorm = 35.9825, GNorm = 0.7127, lr_0 = 1.0000e-04
Loss = 1.3771e-01, PNorm = 35.9861, GNorm = 0.9262, lr_0 = 1.0000e-04
Validation rmse = 0.152482
Validation r2 = 0.809660
Epoch 58
Loss = 1.3926e-01, PNorm = 35.9908, GNorm = 3.0018, lr_0 = 1.0000e-04
Loss = 1.3368e-01, PNorm = 35.9953, GNorm = 0.6883, lr_0 = 1.0000e-04
Validation rmse = 0.147272
Validation r2 = 0.822445
Epoch 59
Loss = 1.1866e-01, PNorm = 35.9999, GNorm = 2.5781, lr_0 = 1.0000e-04
Loss = 1.4320e-01, PNorm = 36.0036, GNorm = 0.7247, lr_0 = 1.0000e-04
Validation rmse = 0.147322
Validation r2 = 0.822324
Model 0 best validation rmse = 0.147272 on epoch 58
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.164194
Model 0 test r2 = 0.778839
Ensemble test rmse = 0.164194
Ensemble test r2 = 0.778839
Fold 7
Splitting data with seed 7
Total size = 1,170 | train size = 936 | val size = 117 | test size = 117
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.0147e+00, PNorm = 34.0132, GNorm = 1.4605, lr_0 = 3.7500e-04
Validation rmse = 0.319353
Validation r2 = 0.056132
Epoch 1
Loss = 8.2853e-01, PNorm = 34.0327, GNorm = 5.0464, lr_0 = 6.5000e-04
Loss = 7.5630e-01, PNorm = 34.0725, GNorm = 9.2941, lr_0 = 9.0000e-04
Validation rmse = 0.249963
Validation r2 = 0.421742
Epoch 2
Loss = 5.5311e-01, PNorm = 34.1382, GNorm = 0.9858, lr_0 = 9.8685e-04
Loss = 5.0168e-01, PNorm = 34.2241, GNorm = 1.5826, lr_0 = 9.6533e-04
Validation rmse = 0.234364
Validation r2 = 0.491664
Epoch 3
Loss = 4.5592e-01, PNorm = 34.2865, GNorm = 4.9743, lr_0 = 9.4427e-04
Loss = 3.8841e-01, PNorm = 34.3458, GNorm = 2.1749, lr_0 = 9.2367e-04
Validation rmse = 0.222532
Validation r2 = 0.541693
Epoch 4
Loss = 3.2560e-01, PNorm = 34.4126, GNorm = 2.0130, lr_0 = 9.0153e-04
Loss = 3.9347e-01, PNorm = 34.4608, GNorm = 6.8853, lr_0 = 8.8187e-04
Validation rmse = 0.208392
Validation r2 = 0.598089
Epoch 5
Loss = 3.2026e-01, PNorm = 34.5099, GNorm = 2.0275, lr_0 = 8.6263e-04
Loss = 3.0864e-01, PNorm = 34.5532, GNorm = 8.1593, lr_0 = 8.4381e-04
Validation rmse = 0.197765
Validation r2 = 0.638034
Epoch 6
Loss = 2.7068e-01, PNorm = 34.5855, GNorm = 3.9821, lr_0 = 8.2540e-04
Loss = 3.0486e-01, PNorm = 34.6189, GNorm = 2.9139, lr_0 = 8.0740e-04
Validation rmse = 0.188100
Validation r2 = 0.672548
Epoch 7
Loss = 2.6407e-01, PNorm = 34.6517, GNorm = 2.5856, lr_0 = 7.8979e-04
Validation rmse = 0.160739
Validation r2 = 0.760882
Epoch 8
Loss = 1.2661e-01, PNorm = 34.6918, GNorm = 1.8665, lr_0 = 7.7086e-04
Loss = 2.7295e-01, PNorm = 34.7227, GNorm = 2.0242, lr_0 = 7.5404e-04
Validation rmse = 0.153674
Validation r2 = 0.781439
Epoch 9
Loss = 2.1781e-01, PNorm = 34.7545, GNorm = 5.0404, lr_0 = 7.3759e-04
Loss = 2.4299e-01, PNorm = 34.7815, GNorm = 1.2529, lr_0 = 7.2150e-04
Validation rmse = 0.164750
Validation r2 = 0.748798
Epoch 10
Loss = 2.0260e-01, PNorm = 34.8139, GNorm = 0.7546, lr_0 = 7.0576e-04
Loss = 2.4491e-01, PNorm = 34.8418, GNorm = 4.8320, lr_0 = 6.9037e-04
Validation rmse = 0.194681
Validation r2 = 0.649235
Epoch 11
Loss = 2.4530e-01, PNorm = 34.8652, GNorm = 1.4493, lr_0 = 6.7382e-04
Loss = 2.4696e-01, PNorm = 34.8927, GNorm = 2.8933, lr_0 = 6.5912e-04
Validation rmse = 0.168014
Validation r2 = 0.738748
Epoch 12
Loss = 2.6527e-01, PNorm = 34.9189, GNorm = 1.4119, lr_0 = 6.4474e-04
Loss = 2.5924e-01, PNorm = 34.9417, GNorm = 6.4720, lr_0 = 6.3068e-04
Validation rmse = 0.202009
Validation r2 = 0.622333
Epoch 13
Loss = 2.6086e-01, PNorm = 34.9670, GNorm = 1.5249, lr_0 = 6.1692e-04
Loss = 2.5116e-01, PNorm = 34.9911, GNorm = 6.2375, lr_0 = 6.0346e-04
Validation rmse = 0.179797
Validation r2 = 0.700819
Epoch 14
Loss = 2.2805e-01, PNorm = 35.0108, GNorm = 3.4493, lr_0 = 5.9030e-04
Loss = 2.4340e-01, PNorm = 35.0339, GNorm = 1.1381, lr_0 = 5.7742e-04
Loss = 1.9045e-01, PNorm = 35.0352, GNorm = 0.8972, lr_0 = 5.7615e-04
Validation rmse = 0.163994
Validation r2 = 0.751098
Epoch 15
Loss = 2.3983e-01, PNorm = 35.0565, GNorm = 1.6637, lr_0 = 5.6358e-04
Validation rmse = 0.169442
Validation r2 = 0.734287
Epoch 16
Loss = 2.1685e-01, PNorm = 35.0777, GNorm = 2.5218, lr_0 = 5.5129e-04
Loss = 2.4174e-01, PNorm = 35.1024, GNorm = 6.3839, lr_0 = 5.3926e-04
Validation rmse = 0.162039
Validation r2 = 0.756999
Epoch 17
Loss = 2.4185e-01, PNorm = 35.1213, GNorm = 1.6215, lr_0 = 5.2750e-04
Loss = 1.7323e-01, PNorm = 35.1411, GNorm = 1.4163, lr_0 = 5.1599e-04
Validation rmse = 0.158050
Validation r2 = 0.768816
Epoch 18
Loss = 1.8044e-01, PNorm = 35.1578, GNorm = 1.7111, lr_0 = 5.0362e-04
Loss = 1.7850e-01, PNorm = 35.1725, GNorm = 2.0760, lr_0 = 4.9264e-04
Validation rmse = 0.159017
Validation r2 = 0.765979
Epoch 19
Loss = 1.8831e-01, PNorm = 35.1868, GNorm = 3.6128, lr_0 = 4.8189e-04
Loss = 1.8707e-01, PNorm = 35.2037, GNorm = 0.9196, lr_0 = 4.7138e-04
Validation rmse = 0.153233
Validation r2 = 0.782692
Epoch 20
Loss = 1.9327e-01, PNorm = 35.2172, GNorm = 1.8704, lr_0 = 4.6110e-04
Loss = 1.8707e-01, PNorm = 35.2307, GNorm = 0.8306, lr_0 = 4.5104e-04
Validation rmse = 0.156601
Validation r2 = 0.773034
Epoch 21
Loss = 1.9176e-01, PNorm = 35.2456, GNorm = 4.3575, lr_0 = 4.4120e-04
Loss = 2.1581e-01, PNorm = 35.2579, GNorm = 1.9063, lr_0 = 4.3158e-04
Validation rmse = 0.171997
Validation r2 = 0.726215
Epoch 22
Loss = 2.1259e-01, PNorm = 35.2783, GNorm = 5.2575, lr_0 = 4.2123e-04
Loss = 1.9300e-01, PNorm = 35.2973, GNorm = 2.8376, lr_0 = 4.1204e-04
Validation rmse = 0.159253
Validation r2 = 0.765283
Epoch 23
Loss = 1.9465e-01, PNorm = 35.3131, GNorm = 1.4398, lr_0 = 4.0305e-04
Validation rmse = 0.168188
Validation r2 = 0.738207
Epoch 24
Loss = 1.7274e-01, PNorm = 35.3278, GNorm = 3.3080, lr_0 = 3.9426e-04
Loss = 1.7930e-01, PNorm = 35.3428, GNorm = 1.2652, lr_0 = 3.8566e-04
Validation rmse = 0.158261
Validation r2 = 0.768197
Epoch 25
Loss = 1.4989e-01, PNorm = 35.3544, GNorm = 2.1388, lr_0 = 3.7725e-04
Loss = 1.9301e-01, PNorm = 35.3680, GNorm = 1.1558, lr_0 = 3.6902e-04
Validation rmse = 0.155361
Validation r2 = 0.776617
Epoch 26
Loss = 1.9104e-01, PNorm = 35.3836, GNorm = 1.8848, lr_0 = 3.6017e-04
Loss = 1.7241e-01, PNorm = 35.3955, GNorm = 0.5946, lr_0 = 3.5232e-04
Validation rmse = 0.159640
Validation r2 = 0.764141
Epoch 27
Loss = 2.0292e-01, PNorm = 35.4073, GNorm = 1.4263, lr_0 = 3.4463e-04
Loss = 1.5980e-01, PNorm = 35.4210, GNorm = 1.2316, lr_0 = 3.3711e-04
Validation rmse = 0.157091
Validation r2 = 0.771612
Epoch 28
Loss = 1.2802e-01, PNorm = 35.4331, GNorm = 0.7085, lr_0 = 3.2976e-04
Loss = 1.8372e-01, PNorm = 35.4466, GNorm = 2.6529, lr_0 = 3.2257e-04
Validation rmse = 0.155800
Validation r2 = 0.775352
Epoch 29
Loss = 1.7881e-01, PNorm = 35.4602, GNorm = 1.2623, lr_0 = 3.1484e-04
Loss = 1.5889e-01, PNorm = 35.4743, GNorm = 1.5167, lr_0 = 3.0797e-04
Validation rmse = 0.153672
Validation r2 = 0.781445
Epoch 30
Loss = 1.4295e-01, PNorm = 35.4842, GNorm = 3.6574, lr_0 = 3.0125e-04
Loss = 1.8835e-01, PNorm = 35.4962, GNorm = 2.1077, lr_0 = 2.9468e-04
Validation rmse = 0.159759
Validation r2 = 0.763788
Epoch 31
Loss = 1.6417e-01, PNorm = 35.5083, GNorm = 1.5010, lr_0 = 2.8825e-04
Validation rmse = 0.151791
Validation r2 = 0.786764
Epoch 32
Loss = 2.1970e-01, PNorm = 35.5202, GNorm = 3.3088, lr_0 = 2.8196e-04
Loss = 1.8314e-01, PNorm = 35.5332, GNorm = 2.1868, lr_0 = 2.7581e-04
Validation rmse = 0.165147
Validation r2 = 0.747586
Epoch 33
Loss = 1.7715e-01, PNorm = 35.5446, GNorm = 1.8220, lr_0 = 2.6920e-04
Loss = 1.7829e-01, PNorm = 35.5559, GNorm = 1.7063, lr_0 = 2.6333e-04
Validation rmse = 0.154716
Validation r2 = 0.778465
Epoch 34
Loss = 1.4349e-01, PNorm = 35.5679, GNorm = 1.2024, lr_0 = 2.5758e-04
Loss = 1.5519e-01, PNorm = 35.5790, GNorm = 0.6413, lr_0 = 2.5197e-04
Validation rmse = 0.153859
Validation r2 = 0.780914
Epoch 35
Loss = 1.7543e-01, PNorm = 35.5892, GNorm = 1.7729, lr_0 = 2.4647e-04
Loss = 1.4679e-01, PNorm = 35.6005, GNorm = 1.3559, lr_0 = 2.4109e-04
Validation rmse = 0.156894
Validation r2 = 0.772186
Epoch 36
Loss = 1.5780e-01, PNorm = 35.6098, GNorm = 0.8644, lr_0 = 2.3531e-04
Loss = 1.7019e-01, PNorm = 35.6192, GNorm = 4.2706, lr_0 = 2.3018e-04
Validation rmse = 0.155371
Validation r2 = 0.776588
Epoch 37
Loss = 1.3969e-01, PNorm = 35.6270, GNorm = 1.0081, lr_0 = 2.2516e-04
Loss = 1.7645e-01, PNorm = 35.6359, GNorm = 3.1908, lr_0 = 2.2025e-04
Validation rmse = 0.157724
Validation r2 = 0.769768
Epoch 38
Loss = 1.4177e-01, PNorm = 35.6462, GNorm = 1.7362, lr_0 = 2.1544e-04
Loss = 1.7341e-01, PNorm = 35.6544, GNorm = 0.8253, lr_0 = 2.1074e-04
Validation rmse = 0.152835
Validation r2 = 0.783819
Epoch 39
Loss = 1.4246e-01, PNorm = 35.6635, GNorm = 1.6998, lr_0 = 2.0615e-04
Validation rmse = 0.157070
Validation r2 = 0.771675
Epoch 40
Loss = 1.3708e-01, PNorm = 35.6729, GNorm = 1.4322, lr_0 = 2.0121e-04
Loss = 1.4542e-01, PNorm = 35.6818, GNorm = 0.7483, lr_0 = 1.9682e-04
Validation rmse = 0.153781
Validation r2 = 0.781135
Epoch 41
Loss = 1.3613e-01, PNorm = 35.6892, GNorm = 1.0157, lr_0 = 1.9252e-04
Loss = 1.5917e-01, PNorm = 35.6974, GNorm = 0.8354, lr_0 = 1.8832e-04
Validation rmse = 0.157426
Validation r2 = 0.770639
Epoch 42
Loss = 1.3805e-01, PNorm = 35.7059, GNorm = 0.7588, lr_0 = 1.8422e-04
Loss = 1.5691e-01, PNorm = 35.7121, GNorm = 1.9065, lr_0 = 1.8020e-04
Validation rmse = 0.156608
Validation r2 = 0.773013
Epoch 43
Loss = 1.3527e-01, PNorm = 35.7203, GNorm = 2.6557, lr_0 = 1.7588e-04
Loss = 1.6015e-01, PNorm = 35.7271, GNorm = 1.6064, lr_0 = 1.7204e-04
Validation rmse = 0.158746
Validation r2 = 0.766774
Epoch 44
Loss = 1.2777e-01, PNorm = 35.7339, GNorm = 2.0992, lr_0 = 1.6829e-04
Loss = 1.4558e-01, PNorm = 35.7413, GNorm = 1.0110, lr_0 = 1.6462e-04
Validation rmse = 0.154891
Validation r2 = 0.777964
Epoch 45
Loss = 1.5262e-01, PNorm = 35.7480, GNorm = 1.2630, lr_0 = 1.6103e-04
Loss = 1.4039e-01, PNorm = 35.7548, GNorm = 0.5747, lr_0 = 1.5751e-04
Validation rmse = 0.153837
Validation r2 = 0.780976
Epoch 46
Loss = 1.4287e-01, PNorm = 35.7610, GNorm = 1.1106, lr_0 = 1.5408e-04
Validation rmse = 0.153452
Validation r2 = 0.782072
Epoch 47
Loss = 9.2900e-02, PNorm = 35.7686, GNorm = 0.6425, lr_0 = 1.5038e-04
Loss = 1.3519e-01, PNorm = 35.7750, GNorm = 2.8847, lr_0 = 1.4710e-04
Validation rmse = 0.153546
Validation r2 = 0.781804
Epoch 48
Loss = 1.7236e-01, PNorm = 35.7805, GNorm = 0.9373, lr_0 = 1.4390e-04
Loss = 1.3233e-01, PNorm = 35.7862, GNorm = 0.9546, lr_0 = 1.4076e-04
Validation rmse = 0.159608
Validation r2 = 0.764237
Epoch 49
Loss = 1.4024e-01, PNorm = 35.7915, GNorm = 0.9261, lr_0 = 1.3769e-04
Loss = 1.4881e-01, PNorm = 35.7968, GNorm = 0.7758, lr_0 = 1.3468e-04
Validation rmse = 0.154450
Validation r2 = 0.779226
Epoch 50
Loss = 1.7729e-01, PNorm = 35.8035, GNorm = 1.0650, lr_0 = 1.3174e-04
Loss = 1.2418e-01, PNorm = 35.8093, GNorm = 0.8782, lr_0 = 1.2887e-04
Validation rmse = 0.156187
Validation r2 = 0.774234
Epoch 51
Loss = 1.4245e-01, PNorm = 35.8150, GNorm = 1.3222, lr_0 = 1.2578e-04
Loss = 1.4206e-01, PNorm = 35.8199, GNorm = 1.0868, lr_0 = 1.2304e-04
Validation rmse = 0.154104
Validation r2 = 0.780216
Epoch 52
Loss = 1.5720e-01, PNorm = 35.8249, GNorm = 1.7023, lr_0 = 1.2035e-04
Loss = 1.3252e-01, PNorm = 35.8299, GNorm = 1.2483, lr_0 = 1.1773e-04
Validation rmse = 0.156511
Validation r2 = 0.773295
Epoch 53
Loss = 1.4746e-01, PNorm = 35.8359, GNorm = 2.4712, lr_0 = 1.1516e-04
Loss = 1.3198e-01, PNorm = 35.8413, GNorm = 0.7083, lr_0 = 1.1265e-04
Loss = 2.4764e-01, PNorm = 35.8419, GNorm = 1.3233, lr_0 = 1.1240e-04
Validation rmse = 0.155889
Validation r2 = 0.775094
Epoch 54
Loss = 1.4197e-01, PNorm = 35.8466, GNorm = 0.7967, lr_0 = 1.0995e-04
Validation rmse = 0.154735
Validation r2 = 0.778412
Epoch 55
Loss = 8.0437e-02, PNorm = 35.8510, GNorm = 0.7366, lr_0 = 1.0755e-04
Loss = 1.4625e-01, PNorm = 35.8552, GNorm = 1.4906, lr_0 = 1.0520e-04
Validation rmse = 0.155447
Validation r2 = 0.776368
Epoch 56
Loss = 1.4857e-01, PNorm = 35.8601, GNorm = 2.2727, lr_0 = 1.0291e-04
Loss = 1.2337e-01, PNorm = 35.8644, GNorm = 1.4189, lr_0 = 1.0066e-04
Validation rmse = 0.154608
Validation r2 = 0.778777
Epoch 57
Loss = 1.2030e-01, PNorm = 35.8681, GNorm = 1.2824, lr_0 = 1.0000e-04
Loss = 1.4080e-01, PNorm = 35.8738, GNorm = 0.9737, lr_0 = 1.0000e-04
Validation rmse = 0.155519
Validation r2 = 0.776160
Epoch 58
Loss = 1.3763e-01, PNorm = 35.8781, GNorm = 2.2273, lr_0 = 1.0000e-04
Loss = 1.3160e-01, PNorm = 35.8817, GNorm = 1.0902, lr_0 = 1.0000e-04
Validation rmse = 0.155527
Validation r2 = 0.776137
Epoch 59
Loss = 1.3381e-01, PNorm = 35.8860, GNorm = 1.1424, lr_0 = 1.0000e-04
Loss = 1.3406e-01, PNorm = 35.8902, GNorm = 1.1311, lr_0 = 1.0000e-04
Validation rmse = 0.156048
Validation r2 = 0.774634
Model 0 best validation rmse = 0.151791 on epoch 31
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.127548
Model 0 test r2 = 0.838400
Ensemble test rmse = 0.127548
Ensemble test r2 = 0.838400
Fold 8
Splitting data with seed 8
Total size = 1,170 | train size = 936 | val size = 117 | test size = 117
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.9560e-01, PNorm = 34.0140, GNorm = 1.5828, lr_0 = 3.7500e-04
Validation rmse = 0.288174
Validation r2 = 0.226984
Epoch 1
Loss = 7.8412e-01, PNorm = 34.0345, GNorm = 1.6021, lr_0 = 6.5000e-04
Loss = 6.7474e-01, PNorm = 34.0845, GNorm = 2.9410, lr_0 = 9.0000e-04
Validation rmse = 0.246207
Validation r2 = 0.435743
Epoch 2
Loss = 6.8186e-01, PNorm = 34.1353, GNorm = 6.3319, lr_0 = 9.8685e-04
Loss = 6.1246e-01, PNorm = 34.2041, GNorm = 1.8347, lr_0 = 9.6533e-04
Validation rmse = 0.220634
Validation r2 = 0.546870
Epoch 3
Loss = 4.8089e-01, PNorm = 34.2715, GNorm = 4.1589, lr_0 = 9.4427e-04
Loss = 4.4779e-01, PNorm = 34.3379, GNorm = 4.1629, lr_0 = 9.2367e-04
Validation rmse = 0.198679
Validation r2 = 0.632562
Epoch 4
Loss = 3.9304e-01, PNorm = 34.4061, GNorm = 3.4206, lr_0 = 9.0153e-04
Loss = 3.7664e-01, PNorm = 34.4655, GNorm = 2.8623, lr_0 = 8.8187e-04
Validation rmse = 0.189550
Validation r2 = 0.665554
Epoch 5
Loss = 3.3424e-01, PNorm = 34.5169, GNorm = 5.3401, lr_0 = 8.6263e-04
Loss = 3.3384e-01, PNorm = 34.5638, GNorm = 4.2285, lr_0 = 8.4381e-04
Validation rmse = 0.172154
Validation r2 = 0.724125
Epoch 6
Loss = 2.6515e-01, PNorm = 34.6077, GNorm = 1.7282, lr_0 = 8.2540e-04
Loss = 2.9492e-01, PNorm = 34.6488, GNorm = 2.8924, lr_0 = 8.0740e-04
Validation rmse = 0.163414
Validation r2 = 0.751425
Epoch 7
Loss = 2.9089e-01, PNorm = 34.6837, GNorm = 3.1184, lr_0 = 7.8979e-04
Validation rmse = 0.180427
Validation r2 = 0.696973
Epoch 8
Loss = 3.2939e-01, PNorm = 34.7181, GNorm = 4.8043, lr_0 = 7.7086e-04
Loss = 2.4020e-01, PNorm = 34.7577, GNorm = 2.3310, lr_0 = 7.5404e-04
Validation rmse = 0.166636
Validation r2 = 0.741527
Epoch 9
Loss = 2.1209e-01, PNorm = 34.7826, GNorm = 2.2611, lr_0 = 7.3759e-04
Loss = 2.5433e-01, PNorm = 34.8058, GNorm = 0.8839, lr_0 = 7.2150e-04
Validation rmse = 0.146413
Validation r2 = 0.800455
Epoch 10
Loss = 2.2389e-01, PNorm = 34.8410, GNorm = 0.8814, lr_0 = 7.0576e-04
Loss = 2.1946e-01, PNorm = 34.8712, GNorm = 1.2887, lr_0 = 6.9037e-04
Validation rmse = 0.148407
Validation r2 = 0.794984
Epoch 11
Loss = 2.3777e-01, PNorm = 34.8955, GNorm = 2.2277, lr_0 = 6.7382e-04
Loss = 1.9995e-01, PNorm = 34.9168, GNorm = 1.0260, lr_0 = 6.5912e-04
Validation rmse = 0.143742
Validation r2 = 0.807670
Epoch 12
Loss = 2.6262e-01, PNorm = 34.9454, GNorm = 3.8228, lr_0 = 6.4474e-04
Loss = 2.0443e-01, PNorm = 34.9690, GNorm = 2.6985, lr_0 = 6.3068e-04
Validation rmse = 0.154380
Validation r2 = 0.778148
Epoch 13
Loss = 2.0482e-01, PNorm = 34.9868, GNorm = 2.4364, lr_0 = 6.1692e-04
Loss = 2.1895e-01, PNorm = 35.0125, GNorm = 0.9361, lr_0 = 6.0346e-04
Validation rmse = 0.144150
Validation r2 = 0.806578
Epoch 14
Loss = 1.7754e-01, PNorm = 35.0314, GNorm = 1.6022, lr_0 = 5.9030e-04
Loss = 2.3507e-01, PNorm = 35.0459, GNorm = 1.8555, lr_0 = 5.7742e-04
Loss = 1.8146e-01, PNorm = 35.0480, GNorm = 1.2551, lr_0 = 5.7615e-04
Validation rmse = 0.140395
Validation r2 = 0.816523
Epoch 15
Loss = 2.0906e-01, PNorm = 35.0687, GNorm = 3.4144, lr_0 = 5.6358e-04
Validation rmse = 0.147885
Validation r2 = 0.796423
Epoch 16
Loss = 1.8787e-01, PNorm = 35.0898, GNorm = 0.9546, lr_0 = 5.5129e-04
Loss = 2.4310e-01, PNorm = 35.1070, GNorm = 5.3339, lr_0 = 5.3926e-04
Validation rmse = 0.170720
Validation r2 = 0.728703
Epoch 17
Loss = 2.3391e-01, PNorm = 35.1279, GNorm = 5.4399, lr_0 = 5.2750e-04
Loss = 2.0020e-01, PNorm = 35.1463, GNorm = 1.0550, lr_0 = 5.1599e-04
Validation rmse = 0.140061
Validation r2 = 0.817395
Epoch 18
Loss = 1.7262e-01, PNorm = 35.1668, GNorm = 3.5599, lr_0 = 5.0362e-04
Loss = 2.0413e-01, PNorm = 35.1881, GNorm = 4.1342, lr_0 = 4.9264e-04
Validation rmse = 0.147446
Validation r2 = 0.797631
Epoch 19
Loss = 2.2420e-01, PNorm = 35.2029, GNorm = 2.1682, lr_0 = 4.8189e-04
Loss = 1.9310e-01, PNorm = 35.2177, GNorm = 2.3477, lr_0 = 4.7138e-04
Validation rmse = 0.139949
Validation r2 = 0.817687
Epoch 20
Loss = 1.9039e-01, PNorm = 35.2325, GNorm = 3.6961, lr_0 = 4.6110e-04
Loss = 1.8237e-01, PNorm = 35.2470, GNorm = 2.2001, lr_0 = 4.5104e-04
Validation rmse = 0.140911
Validation r2 = 0.815173
Epoch 21
Loss = 1.8859e-01, PNorm = 35.2625, GNorm = 3.3717, lr_0 = 4.4120e-04
Loss = 1.9706e-01, PNorm = 35.2777, GNorm = 2.2996, lr_0 = 4.3158e-04
Validation rmse = 0.141152
Validation r2 = 0.814540
Epoch 22
Loss = 1.7527e-01, PNorm = 35.2916, GNorm = 0.9310, lr_0 = 4.2123e-04
Loss = 1.9738e-01, PNorm = 35.3051, GNorm = 1.1750, lr_0 = 4.1204e-04
Validation rmse = 0.136734
Validation r2 = 0.825967
Epoch 23
Loss = 1.6414e-01, PNorm = 35.3181, GNorm = 4.2314, lr_0 = 4.0305e-04
Validation rmse = 0.151190
Validation r2 = 0.787223
Epoch 24
Loss = 2.4031e-01, PNorm = 35.3323, GNorm = 2.9257, lr_0 = 3.9426e-04
Loss = 1.7079e-01, PNorm = 35.3470, GNorm = 1.8138, lr_0 = 3.8566e-04
Validation rmse = 0.141936
Validation r2 = 0.812474
Epoch 25
Loss = 1.9416e-01, PNorm = 35.3626, GNorm = 1.2815, lr_0 = 3.7725e-04
Loss = 1.7118e-01, PNorm = 35.3752, GNorm = 2.4643, lr_0 = 3.6902e-04
Validation rmse = 0.143564
Validation r2 = 0.808146
Epoch 26
Loss = 1.8682e-01, PNorm = 35.3911, GNorm = 2.7077, lr_0 = 3.6017e-04
Loss = 1.9046e-01, PNorm = 35.4064, GNorm = 1.3855, lr_0 = 3.5232e-04
Validation rmse = 0.140921
Validation r2 = 0.815146
Epoch 27
Loss = 1.6094e-01, PNorm = 35.4181, GNorm = 1.5126, lr_0 = 3.4463e-04
Loss = 1.8560e-01, PNorm = 35.4289, GNorm = 4.2313, lr_0 = 3.3711e-04
Validation rmse = 0.136758
Validation r2 = 0.825906
Epoch 28
Loss = 1.7047e-01, PNorm = 35.4429, GNorm = 1.0637, lr_0 = 3.2976e-04
Loss = 1.5734e-01, PNorm = 35.4563, GNorm = 1.3985, lr_0 = 3.2257e-04
Validation rmse = 0.135923
Validation r2 = 0.828026
Epoch 29
Loss = 1.6464e-01, PNorm = 35.4684, GNorm = 2.6320, lr_0 = 3.1484e-04
Loss = 1.6600e-01, PNorm = 35.4796, GNorm = 2.2598, lr_0 = 3.0797e-04
Validation rmse = 0.139913
Validation r2 = 0.817780
Epoch 30
Loss = 1.5630e-01, PNorm = 35.4928, GNorm = 0.8720, lr_0 = 3.0125e-04
Loss = 1.7468e-01, PNorm = 35.5033, GNorm = 2.2679, lr_0 = 2.9468e-04
Validation rmse = 0.139683
Validation r2 = 0.818379
Epoch 31
Loss = 1.5946e-01, PNorm = 35.5132, GNorm = 2.6287, lr_0 = 2.8825e-04
Validation rmse = 0.140704
Validation r2 = 0.815715
Epoch 32
Loss = 1.3786e-01, PNorm = 35.5238, GNorm = 1.9524, lr_0 = 2.8196e-04
Loss = 1.4842e-01, PNorm = 35.5333, GNorm = 0.8250, lr_0 = 2.7581e-04
Validation rmse = 0.137814
Validation r2 = 0.823208
Epoch 33
Loss = 2.1295e-01, PNorm = 35.5444, GNorm = 1.7297, lr_0 = 2.6920e-04
Loss = 1.3778e-01, PNorm = 35.5534, GNorm = 1.6039, lr_0 = 2.6333e-04
Validation rmse = 0.141903
Validation r2 = 0.812561
Epoch 34
Loss = 1.7531e-01, PNorm = 35.5654, GNorm = 3.1320, lr_0 = 2.5758e-04
Loss = 1.7902e-01, PNorm = 35.5758, GNorm = 2.4602, lr_0 = 2.5197e-04
Validation rmse = 0.140451
Validation r2 = 0.816376
Epoch 35
Loss = 1.8198e-01, PNorm = 35.5860, GNorm = 3.9984, lr_0 = 2.4647e-04
Loss = 1.7073e-01, PNorm = 35.5927, GNorm = 2.1503, lr_0 = 2.4109e-04
Validation rmse = 0.142368
Validation r2 = 0.811329
Epoch 36
Loss = 1.7301e-01, PNorm = 35.6052, GNorm = 4.0580, lr_0 = 2.3531e-04
Loss = 1.5134e-01, PNorm = 35.6172, GNorm = 1.7574, lr_0 = 2.3018e-04
Validation rmse = 0.141144
Validation r2 = 0.814561
Epoch 37
Loss = 1.5494e-01, PNorm = 35.6264, GNorm = 2.1435, lr_0 = 2.2516e-04
Loss = 1.6559e-01, PNorm = 35.6364, GNorm = 2.2778, lr_0 = 2.2025e-04
Validation rmse = 0.140625
Validation r2 = 0.815921
Epoch 38
Loss = 1.6837e-01, PNorm = 35.6438, GNorm = 0.9406, lr_0 = 2.1544e-04
Loss = 1.3760e-01, PNorm = 35.6524, GNorm = 2.0337, lr_0 = 2.1074e-04
Validation rmse = 0.138466
Validation r2 = 0.821530
Epoch 39
Loss = 1.4905e-01, PNorm = 35.6611, GNorm = 0.7684, lr_0 = 2.0615e-04
Validation rmse = 0.138231
Validation r2 = 0.822135
Epoch 40
Loss = 1.4996e-01, PNorm = 35.6685, GNorm = 0.5370, lr_0 = 2.0121e-04
Loss = 1.4127e-01, PNorm = 35.6772, GNorm = 2.4062, lr_0 = 1.9682e-04
Validation rmse = 0.140346
Validation r2 = 0.816652
Epoch 41
Loss = 1.4044e-01, PNorm = 35.6853, GNorm = 1.7960, lr_0 = 1.9252e-04
Loss = 1.5230e-01, PNorm = 35.6916, GNorm = 0.8620, lr_0 = 1.8832e-04
Validation rmse = 0.137326
Validation r2 = 0.824456
Epoch 42
Loss = 1.7664e-01, PNorm = 35.6995, GNorm = 3.2647, lr_0 = 1.8422e-04
Loss = 1.2633e-01, PNorm = 35.7070, GNorm = 0.8169, lr_0 = 1.8020e-04
Validation rmse = 0.138525
Validation r2 = 0.821379
Epoch 43
Loss = 1.6328e-01, PNorm = 35.7137, GNorm = 2.7896, lr_0 = 1.7588e-04
Loss = 1.4718e-01, PNorm = 35.7215, GNorm = 0.6585, lr_0 = 1.7204e-04
Validation rmse = 0.138033
Validation r2 = 0.822644
Epoch 44
Loss = 1.4338e-01, PNorm = 35.7280, GNorm = 0.7336, lr_0 = 1.6829e-04
Loss = 1.5037e-01, PNorm = 35.7359, GNorm = 0.7966, lr_0 = 1.6462e-04
Validation rmse = 0.138153
Validation r2 = 0.822337
Epoch 45
Loss = 1.4207e-01, PNorm = 35.7412, GNorm = 1.9406, lr_0 = 1.6103e-04
Loss = 1.4916e-01, PNorm = 35.7469, GNorm = 0.8171, lr_0 = 1.5751e-04
Validation rmse = 0.137935
Validation r2 = 0.822897
Epoch 46
Loss = 1.3054e-01, PNorm = 35.7525, GNorm = 0.7804, lr_0 = 1.5408e-04
Validation rmse = 0.138814
Validation r2 = 0.820631
Epoch 47
Loss = 7.0608e-02, PNorm = 35.7595, GNorm = 0.5501, lr_0 = 1.5038e-04
Loss = 1.5719e-01, PNorm = 35.7667, GNorm = 1.1151, lr_0 = 1.4710e-04
Validation rmse = 0.138603
Validation r2 = 0.821178
Epoch 48
Loss = 1.3751e-01, PNorm = 35.7721, GNorm = 1.3925, lr_0 = 1.4390e-04
Loss = 1.4014e-01, PNorm = 35.7782, GNorm = 1.1919, lr_0 = 1.4076e-04
Validation rmse = 0.137718
Validation r2 = 0.823453
Epoch 49
Loss = 1.2090e-01, PNorm = 35.7831, GNorm = 0.8546, lr_0 = 1.3769e-04
Loss = 1.3467e-01, PNorm = 35.7882, GNorm = 2.2012, lr_0 = 1.3468e-04
Validation rmse = 0.145013
Validation r2 = 0.804256
Epoch 50
Loss = 1.4938e-01, PNorm = 35.7941, GNorm = 1.2002, lr_0 = 1.3174e-04
Loss = 1.4921e-01, PNorm = 35.7994, GNorm = 2.4916, lr_0 = 1.2887e-04
Validation rmse = 0.137989
Validation r2 = 0.822758
Epoch 51
Loss = 1.4760e-01, PNorm = 35.8062, GNorm = 1.0409, lr_0 = 1.2578e-04
Loss = 1.3745e-01, PNorm = 35.8113, GNorm = 2.3108, lr_0 = 1.2304e-04
Validation rmse = 0.140885
Validation r2 = 0.815241
Epoch 52
Loss = 1.2327e-01, PNorm = 35.8159, GNorm = 0.7465, lr_0 = 1.2035e-04
Loss = 1.5587e-01, PNorm = 35.8218, GNorm = 1.8316, lr_0 = 1.1773e-04
Validation rmse = 0.139371
Validation r2 = 0.819189
Epoch 53
Loss = 1.4041e-01, PNorm = 35.8258, GNorm = 1.6770, lr_0 = 1.1516e-04
Loss = 1.3672e-01, PNorm = 35.8301, GNorm = 0.8690, lr_0 = 1.1265e-04
Loss = 1.3855e-01, PNorm = 35.8305, GNorm = 2.3054, lr_0 = 1.1240e-04
Validation rmse = 0.140032
Validation r2 = 0.817470
Epoch 54
Loss = 1.3052e-01, PNorm = 35.8359, GNorm = 2.0959, lr_0 = 1.0995e-04
Validation rmse = 0.139784
Validation r2 = 0.818115
Epoch 55
Loss = 1.1835e-01, PNorm = 35.8405, GNorm = 1.1909, lr_0 = 1.0755e-04
Loss = 1.2422e-01, PNorm = 35.8452, GNorm = 1.0241, lr_0 = 1.0520e-04
Validation rmse = 0.137682
Validation r2 = 0.823545
Epoch 56
Loss = 1.3440e-01, PNorm = 35.8485, GNorm = 0.7015, lr_0 = 1.0291e-04
Loss = 1.3498e-01, PNorm = 35.8535, GNorm = 1.0078, lr_0 = 1.0066e-04
Validation rmse = 0.137862
Validation r2 = 0.823085
Epoch 57
Loss = 1.5315e-01, PNorm = 35.8572, GNorm = 0.8538, lr_0 = 1.0000e-04
Loss = 1.2560e-01, PNorm = 35.8609, GNorm = 0.9483, lr_0 = 1.0000e-04
Validation rmse = 0.138931
Validation r2 = 0.820330
Epoch 58
Loss = 1.3852e-01, PNorm = 35.8653, GNorm = 0.5184, lr_0 = 1.0000e-04
Loss = 1.3352e-01, PNorm = 35.8697, GNorm = 1.6328, lr_0 = 1.0000e-04
Validation rmse = 0.139015
Validation r2 = 0.820112
Epoch 59
Loss = 1.1875e-01, PNorm = 35.8740, GNorm = 0.6473, lr_0 = 1.0000e-04
Loss = 1.4656e-01, PNorm = 35.8780, GNorm = 2.0109, lr_0 = 1.0000e-04
Validation rmse = 0.139044
Validation r2 = 0.820038
Model 0 best validation rmse = 0.135923 on epoch 28
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.160092
Model 0 test r2 = 0.765747
Ensemble test rmse = 0.160092
Ensemble test r2 = 0.765747
Fold 9
Splitting data with seed 9
Total size = 1,170 | train size = 936 | val size = 117 | test size = 117
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.9064e-01, PNorm = 34.0150, GNorm = 8.0518, lr_0 = 3.7500e-04
Validation rmse = 0.274549
Validation r2 = 0.229489
Epoch 1
Loss = 7.0136e-01, PNorm = 34.0393, GNorm = 1.9006, lr_0 = 6.5000e-04
Loss = 6.3860e-01, PNorm = 34.0844, GNorm = 1.1728, lr_0 = 9.0000e-04
Validation rmse = 0.242055
Validation r2 = 0.401082
Epoch 2
Loss = 5.6861e-01, PNorm = 34.1537, GNorm = 6.4719, lr_0 = 9.8685e-04
Loss = 4.7320e-01, PNorm = 34.2247, GNorm = 1.1537, lr_0 = 9.6533e-04
Validation rmse = 0.214684
Validation r2 = 0.528872
Epoch 3
Loss = 4.1428e-01, PNorm = 34.2895, GNorm = 6.1949, lr_0 = 9.4427e-04
Loss = 4.0726e-01, PNorm = 34.3508, GNorm = 3.1739, lr_0 = 9.2367e-04
Validation rmse = 0.197382
Validation r2 = 0.601753
Epoch 4
Loss = 3.0364e-01, PNorm = 34.4096, GNorm = 3.1934, lr_0 = 9.0153e-04
Loss = 3.3633e-01, PNorm = 34.4602, GNorm = 7.2030, lr_0 = 8.8187e-04
Validation rmse = 0.212624
Validation r2 = 0.537869
Epoch 5
Loss = 3.5667e-01, PNorm = 34.5097, GNorm = 4.8037, lr_0 = 8.6263e-04
Loss = 3.2811e-01, PNorm = 34.5488, GNorm = 8.5800, lr_0 = 8.4381e-04
Validation rmse = 0.199482
Validation r2 = 0.593233
Epoch 6
Loss = 3.2423e-01, PNorm = 34.5894, GNorm = 2.8496, lr_0 = 8.2540e-04
Loss = 2.7182e-01, PNorm = 34.6265, GNorm = 2.1216, lr_0 = 8.0740e-04
Validation rmse = 0.171684
Validation r2 = 0.698700
Epoch 7
Loss = 2.8951e-01, PNorm = 34.6607, GNorm = 5.6940, lr_0 = 7.8979e-04
Validation rmse = 0.201219
Validation r2 = 0.586117
Epoch 8
Loss = 3.3548e-01, PNorm = 34.7010, GNorm = 7.0815, lr_0 = 7.7086e-04
Loss = 2.9130e-01, PNorm = 34.7325, GNorm = 3.6028, lr_0 = 7.5404e-04
Validation rmse = 0.172077
Validation r2 = 0.697319
Epoch 9
Loss = 3.2696e-01, PNorm = 34.7659, GNorm = 5.7248, lr_0 = 7.3759e-04
Loss = 2.0335e-01, PNorm = 34.7903, GNorm = 0.7183, lr_0 = 7.2150e-04
Validation rmse = 0.180038
Validation r2 = 0.668665
Epoch 10
Loss = 2.3641e-01, PNorm = 34.8173, GNorm = 1.4320, lr_0 = 7.0576e-04
Loss = 2.3968e-01, PNorm = 34.8416, GNorm = 6.3691, lr_0 = 6.9037e-04
Validation rmse = 0.182965
Validation r2 = 0.657805
Epoch 11
Loss = 2.4666e-01, PNorm = 34.8680, GNorm = 4.5608, lr_0 = 6.7382e-04
Loss = 2.4776e-01, PNorm = 34.8928, GNorm = 1.0988, lr_0 = 6.5912e-04
Validation rmse = 0.167700
Validation r2 = 0.712521
Epoch 12
Loss = 2.2927e-01, PNorm = 34.9194, GNorm = 1.3816, lr_0 = 6.4474e-04
Loss = 2.1358e-01, PNorm = 34.9419, GNorm = 1.2315, lr_0 = 6.3068e-04
Validation rmse = 0.162178
Validation r2 = 0.731143
Epoch 13
Loss = 2.0170e-01, PNorm = 34.9584, GNorm = 0.8305, lr_0 = 6.1692e-04
Loss = 2.3971e-01, PNorm = 34.9765, GNorm = 5.9508, lr_0 = 6.0346e-04
Validation rmse = 0.177914
Validation r2 = 0.676437
Epoch 14
Loss = 2.3985e-01, PNorm = 34.9899, GNorm = 4.0691, lr_0 = 5.9030e-04
Loss = 2.2026e-01, PNorm = 35.0112, GNorm = 6.7815, lr_0 = 5.7742e-04
Loss = 2.5665e-01, PNorm = 35.0139, GNorm = 5.6594, lr_0 = 5.7615e-04
Validation rmse = 0.163070
Validation r2 = 0.728175
Epoch 15
Loss = 2.4722e-01, PNorm = 35.0369, GNorm = 0.9973, lr_0 = 5.6358e-04
Validation rmse = 0.165605
Validation r2 = 0.719661
Epoch 16
Loss = 2.5366e-01, PNorm = 35.0573, GNorm = 0.9551, lr_0 = 5.5129e-04
Loss = 2.2421e-01, PNorm = 35.0721, GNorm = 4.2064, lr_0 = 5.3926e-04
Validation rmse = 0.169985
Validation r2 = 0.704633
Epoch 17
Loss = 2.3104e-01, PNorm = 35.0906, GNorm = 2.9070, lr_0 = 5.2750e-04
Loss = 1.9548e-01, PNorm = 35.1056, GNorm = 2.7759, lr_0 = 5.1599e-04
Validation rmse = 0.156236
Validation r2 = 0.750484
Epoch 18
Loss = 2.1018e-01, PNorm = 35.1233, GNorm = 2.2903, lr_0 = 5.0362e-04
Loss = 1.8354e-01, PNorm = 35.1416, GNorm = 1.5691, lr_0 = 4.9264e-04
Validation rmse = 0.161234
Validation r2 = 0.734262
Epoch 19
Loss = 1.9549e-01, PNorm = 35.1565, GNorm = 1.9526, lr_0 = 4.8189e-04
Loss = 1.7886e-01, PNorm = 35.1737, GNorm = 1.2708, lr_0 = 4.7138e-04
Validation rmse = 0.160651
Validation r2 = 0.736181
Epoch 20
Loss = 1.6982e-01, PNorm = 35.1852, GNorm = 2.3768, lr_0 = 4.6110e-04
Loss = 1.7477e-01, PNorm = 35.1982, GNorm = 1.5874, lr_0 = 4.5104e-04
Validation rmse = 0.160570
Validation r2 = 0.736446
Epoch 21
Loss = 1.5858e-01, PNorm = 35.2108, GNorm = 1.7097, lr_0 = 4.4120e-04
Loss = 1.8743e-01, PNorm = 35.2244, GNorm = 2.3840, lr_0 = 4.3158e-04
Validation rmse = 0.161670
Validation r2 = 0.732824
Epoch 22
Loss = 1.7021e-01, PNorm = 35.2416, GNorm = 2.5520, lr_0 = 4.2123e-04
Loss = 1.7689e-01, PNorm = 35.2561, GNorm = 2.0070, lr_0 = 4.1204e-04
Validation rmse = 0.162206
Validation r2 = 0.731050
Epoch 23
Loss = 1.7520e-01, PNorm = 35.2697, GNorm = 4.1229, lr_0 = 4.0305e-04
Validation rmse = 0.159261
Validation r2 = 0.740727
Epoch 24
Loss = 1.2546e-01, PNorm = 35.2835, GNorm = 2.0839, lr_0 = 3.9426e-04
Loss = 1.7567e-01, PNorm = 35.2957, GNorm = 2.0488, lr_0 = 3.8566e-04
Validation rmse = 0.188291
Validation r2 = 0.637593
Epoch 25
Loss = 2.2037e-01, PNorm = 35.3098, GNorm = 3.9524, lr_0 = 3.7725e-04
Loss = 1.8160e-01, PNorm = 35.3239, GNorm = 3.3470, lr_0 = 3.6902e-04
Validation rmse = 0.159309
Validation r2 = 0.740572
Epoch 26
Loss = 1.5394e-01, PNorm = 35.3378, GNorm = 2.9855, lr_0 = 3.6017e-04
Loss = 1.7145e-01, PNorm = 35.3482, GNorm = 0.8937, lr_0 = 3.5232e-04
Validation rmse = 0.163171
Validation r2 = 0.727840
Epoch 27
Loss = 1.8832e-01, PNorm = 35.3617, GNorm = 1.1572, lr_0 = 3.4463e-04
Loss = 1.6731e-01, PNorm = 35.3746, GNorm = 1.6093, lr_0 = 3.3711e-04
Validation rmse = 0.160050
Validation r2 = 0.738151
Epoch 28
Loss = 1.7051e-01, PNorm = 35.3851, GNorm = 2.7026, lr_0 = 3.2976e-04
Loss = 1.6181e-01, PNorm = 35.3969, GNorm = 1.3448, lr_0 = 3.2257e-04
Validation rmse = 0.164070
Validation r2 = 0.724831
Epoch 29
Loss = 1.7556e-01, PNorm = 35.4109, GNorm = 1.3437, lr_0 = 3.1484e-04
Loss = 1.4544e-01, PNorm = 35.4229, GNorm = 0.5344, lr_0 = 3.0797e-04
Validation rmse = 0.162549
Validation r2 = 0.729909
Epoch 30
Loss = 1.3769e-01, PNorm = 35.4313, GNorm = 2.0949, lr_0 = 3.0125e-04
Loss = 1.7753e-01, PNorm = 35.4423, GNorm = 1.3338, lr_0 = 2.9468e-04
Validation rmse = 0.160979
Validation r2 = 0.735104
Epoch 31
Loss = 1.6923e-01, PNorm = 35.4523, GNorm = 1.8027, lr_0 = 2.8825e-04
Validation rmse = 0.159470
Validation r2 = 0.740047
Epoch 32
Loss = 9.6208e-02, PNorm = 35.4645, GNorm = 2.0097, lr_0 = 2.8196e-04
Loss = 1.5795e-01, PNorm = 35.4752, GNorm = 1.8958, lr_0 = 2.7581e-04
Validation rmse = 0.161271
Validation r2 = 0.734142
Epoch 33
Loss = 1.5286e-01, PNorm = 35.4875, GNorm = 1.6796, lr_0 = 2.6920e-04
Loss = 1.4506e-01, PNorm = 35.4978, GNorm = 1.9882, lr_0 = 2.6333e-04
Validation rmse = 0.162419
Validation r2 = 0.730343
Epoch 34
Loss = 1.6131e-01, PNorm = 35.5075, GNorm = 1.6130, lr_0 = 2.5758e-04
Loss = 1.6257e-01, PNorm = 35.5180, GNorm = 0.8894, lr_0 = 2.5197e-04
Validation rmse = 0.159133
Validation r2 = 0.741142
Epoch 35
Loss = 1.6031e-01, PNorm = 35.5257, GNorm = 2.3284, lr_0 = 2.4647e-04
Loss = 1.4080e-01, PNorm = 35.5337, GNorm = 1.4582, lr_0 = 2.4109e-04
Validation rmse = 0.160526
Validation r2 = 0.736591
Epoch 36
Loss = 1.3534e-01, PNorm = 35.5434, GNorm = 1.2552, lr_0 = 2.3531e-04
Loss = 1.4887e-01, PNorm = 35.5518, GNorm = 1.0258, lr_0 = 2.3018e-04
Validation rmse = 0.161778
Validation r2 = 0.732465
Epoch 37
Loss = 1.4893e-01, PNorm = 35.5611, GNorm = 1.0892, lr_0 = 2.2516e-04
Loss = 1.4317e-01, PNorm = 35.5703, GNorm = 3.6483, lr_0 = 2.2025e-04
Validation rmse = 0.161570
Validation r2 = 0.733156
Epoch 38
Loss = 1.3535e-01, PNorm = 35.5780, GNorm = 1.3763, lr_0 = 2.1544e-04
Loss = 1.6326e-01, PNorm = 35.5863, GNorm = 2.1217, lr_0 = 2.1074e-04
Validation rmse = 0.162319
Validation r2 = 0.730676
Epoch 39
Loss = 1.6853e-01, PNorm = 35.5945, GNorm = 1.0663, lr_0 = 2.0615e-04
Validation rmse = 0.172750
Validation r2 = 0.694947
Epoch 40
Loss = 2.2005e-01, PNorm = 35.6040, GNorm = 2.1345, lr_0 = 2.0121e-04
Loss = 1.2659e-01, PNorm = 35.6111, GNorm = 0.5785, lr_0 = 1.9682e-04
Validation rmse = 0.165078
Validation r2 = 0.721441
Epoch 41
Loss = 1.4748e-01, PNorm = 35.6188, GNorm = 1.6570, lr_0 = 1.9252e-04
Loss = 1.6403e-01, PNorm = 35.6256, GNorm = 1.9203, lr_0 = 1.8832e-04
Validation rmse = 0.176976
Validation r2 = 0.679840
Epoch 42
Loss = 1.3049e-01, PNorm = 35.6333, GNorm = 1.3608, lr_0 = 1.8422e-04
Loss = 1.4671e-01, PNorm = 35.6412, GNorm = 0.8940, lr_0 = 1.8020e-04
Validation rmse = 0.158699
Validation r2 = 0.742554
Epoch 43
Loss = 1.4798e-01, PNorm = 35.6485, GNorm = 1.7895, lr_0 = 1.7588e-04
Loss = 1.3407e-01, PNorm = 35.6562, GNorm = 0.8516, lr_0 = 1.7204e-04
Validation rmse = 0.159817
Validation r2 = 0.738912
Epoch 44
Loss = 1.4529e-01, PNorm = 35.6643, GNorm = 2.0302, lr_0 = 1.6829e-04
Loss = 1.6325e-01, PNorm = 35.6698, GNorm = 1.3417, lr_0 = 1.6462e-04
Validation rmse = 0.165231
Validation r2 = 0.720924
Epoch 45
Loss = 1.2924e-01, PNorm = 35.6759, GNorm = 1.0129, lr_0 = 1.6103e-04
Loss = 1.5575e-01, PNorm = 35.6823, GNorm = 1.0331, lr_0 = 1.5751e-04
Validation rmse = 0.160879
Validation r2 = 0.735431
Epoch 46
Loss = 1.2890e-01, PNorm = 35.6889, GNorm = 0.6725, lr_0 = 1.5408e-04
Validation rmse = 0.160639
Validation r2 = 0.736222
Epoch 47
Loss = 1.2111e-01, PNorm = 35.6963, GNorm = 1.0907, lr_0 = 1.5038e-04
Loss = 1.3378e-01, PNorm = 35.7013, GNorm = 1.6752, lr_0 = 1.4710e-04
Validation rmse = 0.162466
Validation r2 = 0.730186
Epoch 48
Loss = 1.4372e-01, PNorm = 35.7064, GNorm = 0.9874, lr_0 = 1.4390e-04
Loss = 1.4136e-01, PNorm = 35.7116, GNorm = 1.4259, lr_0 = 1.4076e-04
Validation rmse = 0.161290
Validation r2 = 0.734079
Epoch 49
Loss = 1.5806e-01, PNorm = 35.7177, GNorm = 1.9465, lr_0 = 1.3769e-04
Loss = 1.4352e-01, PNorm = 35.7221, GNorm = 0.9702, lr_0 = 1.3468e-04
Validation rmse = 0.161069
Validation r2 = 0.734806
Epoch 50
Loss = 1.1104e-01, PNorm = 35.7270, GNorm = 2.6825, lr_0 = 1.3174e-04
Loss = 1.4575e-01, PNorm = 35.7330, GNorm = 1.5561, lr_0 = 1.2887e-04
Validation rmse = 0.161053
Validation r2 = 0.734858
Epoch 51
Loss = 1.4472e-01, PNorm = 35.7375, GNorm = 0.8812, lr_0 = 1.2578e-04
Loss = 1.3209e-01, PNorm = 35.7429, GNorm = 1.0826, lr_0 = 1.2304e-04
Validation rmse = 0.165161
Validation r2 = 0.721161
Epoch 52
Loss = 1.3409e-01, PNorm = 35.7470, GNorm = 1.3261, lr_0 = 1.2035e-04
Loss = 1.4198e-01, PNorm = 35.7516, GNorm = 0.7477, lr_0 = 1.1773e-04
Validation rmse = 0.159450
Validation r2 = 0.740112
Epoch 53
Loss = 1.4263e-01, PNorm = 35.7562, GNorm = 2.0563, lr_0 = 1.1516e-04
Loss = 1.3320e-01, PNorm = 35.7609, GNorm = 1.8638, lr_0 = 1.1265e-04
Loss = 1.3796e-01, PNorm = 35.7612, GNorm = 2.7702, lr_0 = 1.1240e-04
Validation rmse = 0.168394
Validation r2 = 0.710139
Epoch 54
Loss = 1.5504e-01, PNorm = 35.7649, GNorm = 0.9492, lr_0 = 1.0995e-04
Validation rmse = 0.160838
Validation r2 = 0.735567
Epoch 55
Loss = 1.4807e-01, PNorm = 35.7692, GNorm = 2.7704, lr_0 = 1.0755e-04
Loss = 1.2433e-01, PNorm = 35.7730, GNorm = 1.8763, lr_0 = 1.0520e-04
Validation rmse = 0.161982
Validation r2 = 0.731792
Epoch 56
Loss = 1.3521e-01, PNorm = 35.7775, GNorm = 1.1511, lr_0 = 1.0291e-04
Loss = 1.2370e-01, PNorm = 35.7814, GNorm = 0.9003, lr_0 = 1.0066e-04
Validation rmse = 0.162802
Validation r2 = 0.729070
Epoch 57
Loss = 1.4829e-01, PNorm = 35.7855, GNorm = 1.7865, lr_0 = 1.0000e-04
Loss = 1.2926e-01, PNorm = 35.7893, GNorm = 2.4444, lr_0 = 1.0000e-04
Validation rmse = 0.162091
Validation r2 = 0.731431
Epoch 58
Loss = 1.2138e-01, PNorm = 35.7934, GNorm = 2.8696, lr_0 = 1.0000e-04
Loss = 1.4634e-01, PNorm = 35.7975, GNorm = 0.8081, lr_0 = 1.0000e-04
Validation rmse = 0.163872
Validation r2 = 0.725495
Epoch 59
Loss = 1.7403e-01, PNorm = 35.8002, GNorm = 1.0515, lr_0 = 1.0000e-04
Loss = 1.1231e-01, PNorm = 35.8048, GNorm = 1.8210, lr_0 = 1.0000e-04
Validation rmse = 0.162949
Validation r2 = 0.728578
Model 0 best validation rmse = 0.156236 on epoch 17
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.134184
Model 0 test r2 = 0.806623
Ensemble test rmse = 0.134184
Ensemble test r2 = 0.806623
10-fold cross validation
	Seed 0 ==> test rmse = 0.154185
	Seed 0 ==> test r2 = 0.784949
	Seed 1 ==> test rmse = 0.171086
	Seed 1 ==> test r2 = 0.767306
	Seed 2 ==> test rmse = 0.197009
	Seed 2 ==> test r2 = 0.622173
	Seed 3 ==> test rmse = 0.155670
	Seed 3 ==> test r2 = 0.779012
	Seed 4 ==> test rmse = 0.141786
	Seed 4 ==> test r2 = 0.830039
	Seed 5 ==> test rmse = 0.175356
	Seed 5 ==> test r2 = 0.746429
	Seed 6 ==> test rmse = 0.164194
	Seed 6 ==> test r2 = 0.778839
	Seed 7 ==> test rmse = 0.127548
	Seed 7 ==> test r2 = 0.838400
	Seed 8 ==> test rmse = 0.160092
	Seed 8 ==> test r2 = 0.765747
	Seed 9 ==> test rmse = 0.134184
	Seed 9 ==> test r2 = 0.806623
Overall test rmse = 0.158111 +/- 0.019530
Overall test r2 = 0.771952 +/- 0.056924
Elapsed time = 0:06:52
