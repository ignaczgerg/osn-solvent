Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-fb03ea67-e9f1-456d-bb00-313f16904d4e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 2,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': [''],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300--smiles_column', 'full_smiles'],
 'task_names': ['dm300--smiles_column', 'full_smiles'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-fb03ea67-e9f1-456d-bb00-313f16904d4e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,170 | train size = 930 | val size = 234 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.4346e-01, PNorm = 34.0153, GNorm = 4.0111, lr_0 = 3.7500e-04
Validation rmse = 0.323457
Epoch 1
Loss = 6.8934e-01, PNorm = 34.0439, GNorm = 10.0716, lr_0 = 6.5000e-04
Loss = 6.8462e-01, PNorm = 34.0809, GNorm = 1.5600, lr_0 = 9.0000e-04
Validation rmse = 0.268341
Epoch 2
Loss = 4.8750e-01, PNorm = 34.1318, GNorm = 2.1056, lr_0 = 4.6416e-04
Loss = 4.7035e-01, PNorm = 34.1531, GNorm = 0.9417, lr_0 = 1.2915e-04
Validation rmse = 0.253878
Model 0 best validation rmse = 0.253878 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.265408
Ensemble test rmse = 0.265408
1-fold cross validation
	Seed 0 ==> test rmse = 0.265408
Overall test rmse = 0.265408 +/- 0.000000
Elapsed time = 0:00:03
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-fb03ea67-e9f1-456d-bb00-313f16904d4e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,170 | train size = 930 | val size = 234 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.4346e-01, PNorm = 34.0153, GNorm = 4.0111, lr_0 = 3.7500e-04
Validation rmse = 0.323457
Epoch 1
Loss = 6.8934e-01, PNorm = 34.0439, GNorm = 10.0716, lr_0 = 6.5000e-04
Loss = 6.8462e-01, PNorm = 34.0809, GNorm = 1.5600, lr_0 = 9.0000e-04
Validation rmse = 0.268341
Epoch 2
Loss = 4.8750e-01, PNorm = 34.1318, GNorm = 2.1056, lr_0 = 4.6416e-04
Loss = 4.7035e-01, PNorm = 34.1531, GNorm = 0.9417, lr_0 = 1.2915e-04
Validation rmse = 0.253878
Model 0 best validation rmse = 0.253878 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.265408
Ensemble test rmse = 0.265408
1-fold cross validation
	Seed 0 ==> test rmse = 0.265408
Overall test rmse = 0.265408 +/- 0.000000
Elapsed time = 0:00:02
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-fb03ea67-e9f1-456d-bb00-313f16904d4e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,170 | train size = 930 | val size = 234 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.4346e-01, PNorm = 34.0153, GNorm = 4.0111, lr_0 = 3.7500e-04
Validation rmse = 0.323457
Epoch 1
Loss = 6.8934e-01, PNorm = 34.0439, GNorm = 10.0716, lr_0 = 6.5000e-04
Loss = 6.8462e-01, PNorm = 34.0809, GNorm = 1.5600, lr_0 = 9.0000e-04
Validation rmse = 0.268341
Epoch 2
Loss = 4.8750e-01, PNorm = 34.1318, GNorm = 2.1056, lr_0 = 4.6416e-04
Loss = 4.7035e-01, PNorm = 34.1531, GNorm = 0.9417, lr_0 = 1.2915e-04
Validation rmse = 0.253878
Model 0 best validation rmse = 0.253878 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.265408
Ensemble test rmse = 0.265408
1-fold cross validation
	Seed 0 ==> test rmse = 0.265408
Overall test rmse = 0.265408 +/- 0.000000
Elapsed time = 0:00:02
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-fb03ea67-e9f1-456d-bb00-313f16904d4e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,170 | train size = 930 | val size = 234 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.4346e-01, PNorm = 34.0153, GNorm = 4.0111, lr_0 = 3.7500e-04
Validation rmse = 0.323457
Epoch 1
Loss = 6.8934e-01, PNorm = 34.0439, GNorm = 10.0716, lr_0 = 6.5000e-04
Loss = 6.8462e-01, PNorm = 34.0809, GNorm = 1.5600, lr_0 = 9.0000e-04
Validation rmse = 0.268341
Epoch 2
Loss = 4.8750e-01, PNorm = 34.1318, GNorm = 2.1056, lr_0 = 4.6416e-04
Loss = 4.7035e-01, PNorm = 34.1531, GNorm = 0.9417, lr_0 = 1.2915e-04
Validation rmse = 0.253878
Model 0 best validation rmse = 0.253878 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.265408
Ensemble test rmse = 0.265408
1-fold cross validation
	Seed 0 ==> test rmse = 0.265408
Overall test rmse = 0.265408 +/- 0.000000
Elapsed time = 0:00:02
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-fb03ea67-e9f1-456d-bb00-313f16904d4e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,170 | train size = 930 | val size = 234 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.4346e-01, PNorm = 34.0153, GNorm = 4.0111, lr_0 = 3.7500e-04
Validation rmse = 0.323457
Epoch 1
Loss = 6.8934e-01, PNorm = 34.0439, GNorm = 10.0716, lr_0 = 6.5000e-04
Loss = 6.8462e-01, PNorm = 34.0809, GNorm = 1.5600, lr_0 = 9.0000e-04
Validation rmse = 0.268341
Epoch 2
Loss = 4.8750e-01, PNorm = 34.1318, GNorm = 2.1056, lr_0 = 4.6416e-04
Loss = 4.7035e-01, PNorm = 34.1531, GNorm = 0.9417, lr_0 = 1.2915e-04
Validation rmse = 0.253878
Model 0 best validation rmse = 0.253878 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.265408
Ensemble test rmse = 0.265408
1-fold cross validation
	Seed 0 ==> test rmse = 0.265408
Overall test rmse = 0.265408 +/- 0.000000
Elapsed time = 0:00:02
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-fb03ea67-e9f1-456d-bb00-313f16904d4e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/_train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 2,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': [''],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300--smiles_column', 'full_smiles'],
 'task_names': ['dm300--smiles_column', 'full_smiles'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-fb03ea67-e9f1-456d-bb00-313f16904d4e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/_train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,170 | train size = 930 | val size = 234 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.4346e-01, PNorm = 34.0153, GNorm = 4.0111, lr_0 = 3.7500e-04
Validation rmse = 0.323456
Epoch 1
Loss = 6.8934e-01, PNorm = 34.0439, GNorm = 10.0708, lr_0 = 6.5000e-04
Loss = 6.8461e-01, PNorm = 34.0809, GNorm = 1.5702, lr_0 = 9.0000e-04
Validation rmse = 0.268221
Epoch 2
Loss = 4.8719e-01, PNorm = 34.1317, GNorm = 2.0929, lr_0 = 4.6416e-04
Loss = 4.6972e-01, PNorm = 34.1531, GNorm = 0.9245, lr_0 = 1.2915e-04
Validation rmse = 0.253850
Model 0 best validation rmse = 0.253850 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.265198
Ensemble test rmse = 0.265198
1-fold cross validation
	Seed 0 ==> test rmse = 0.265198
Overall test rmse = 0.265198 +/- 0.000000
Elapsed time = 0:00:02
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-fb03ea67-e9f1-456d-bb00-313f16904d4e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/_train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,160 | train size = 922 | val size = 232 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.4726e-01, PNorm = 34.0149, GNorm = 2.6635, lr_0 = 3.7500e-04
Validation rmse = 0.295110
Epoch 1
Loss = 5.6914e-01, PNorm = 34.0426, GNorm = 2.2884, lr_0 = 6.5000e-04
Loss = 6.3689e-01, PNorm = 34.0887, GNorm = 9.9895, lr_0 = 9.0000e-04
Validation rmse = 0.262618
Epoch 2
Loss = 5.1985e-01, PNorm = 34.1389, GNorm = 5.5237, lr_0 = 4.0842e-04
Loss = 4.4856e-01, PNorm = 34.1561, GNorm = 2.9894, lr_0 = 1.1365e-04
Validation rmse = 0.250922
Model 0 best validation rmse = 0.250922 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.297608
Ensemble test rmse = 0.297608
1-fold cross validation
	Seed 0 ==> test rmse = 0.297608
Overall test rmse = 0.297608 +/- 0.000000
Elapsed time = 0:00:02
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-fb03ea67-e9f1-456d-bb00-313f16904d4e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/_train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,150 | train size = 914 | val size = 230 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 8.9774e-01, PNorm = 34.0164, GNorm = 5.2234, lr_0 = 3.7500e-04
Validation rmse = 0.274313
Epoch 1
Loss = 6.6088e-01, PNorm = 34.0411, GNorm = 4.7976, lr_0 = 6.5000e-04
Loss = 7.4832e-01, PNorm = 34.0808, GNorm = 10.5694, lr_0 = 9.0000e-04
Validation rmse = 0.258450
Epoch 2
Loss = 5.7655e-01, PNorm = 34.1322, GNorm = 3.8644, lr_0 = 4.0842e-04
Loss = 5.1990e-01, PNorm = 34.1495, GNorm = 1.4857, lr_0 = 1.1365e-04
Validation rmse = 0.232187
Model 0 best validation rmse = 0.232187 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.217268
Ensemble test rmse = 0.217268
1-fold cross validation
	Seed 0 ==> test rmse = 0.217268
Overall test rmse = 0.217268 +/- 0.000000
Elapsed time = 0:00:02
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-fb03ea67-e9f1-456d-bb00-313f16904d4e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/_train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,140 | train size = 906 | val size = 228 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.8115e-01, PNorm = 34.0146, GNorm = 0.7173, lr_0 = 3.7500e-04
Validation rmse = 0.308748
Epoch 1
Loss = 9.4004e-01, PNorm = 34.0381, GNorm = 10.1024, lr_0 = 6.5000e-04
Loss = 6.4735e-01, PNorm = 34.0750, GNorm = 1.8009, lr_0 = 9.0000e-04
Validation rmse = 0.246496
Epoch 2
Loss = 4.7153e-01, PNorm = 34.1354, GNorm = 0.9679, lr_0 = 4.0842e-04
Loss = 4.7550e-01, PNorm = 34.1517, GNorm = 1.3526, lr_0 = 1.1365e-04
Validation rmse = 0.234911
Model 0 best validation rmse = 0.234911 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.258458
Ensemble test rmse = 0.258458
1-fold cross validation
	Seed 0 ==> test rmse = 0.258458
Overall test rmse = 0.258458 +/- 0.000000
Elapsed time = 0:00:03
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-fb03ea67-e9f1-456d-bb00-313f16904d4e.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/_train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,130 | train size = 898 | val size = 226 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.0139e+00, PNorm = 34.0137, GNorm = 1.0887, lr_0 = 3.9118e-04
Validation rmse = 0.298810
Epoch 1
Loss = 6.4361e-01, PNorm = 34.0386, GNorm = 3.9413, lr_0 = 6.8235e-04
Loss = 6.7416e-01, PNorm = 34.0866, GNorm = 7.5757, lr_0 = 9.4706e-04
Validation rmse = 0.245063
Epoch 2
Loss = 6.7776e-01, PNorm = 34.1237, GNorm = 7.0833, lr_0 = 3.3839e-04
Loss = 5.6424e-01, PNorm = 34.1341, GNorm = 3.4603, lr_0 = 1.0000e-04
Validation rmse = 0.236971
Model 0 best validation rmse = 0.236971 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.181309
Ensemble test rmse = 0.181309
1-fold cross validation
	Seed 0 ==> test rmse = 0.181309
Overall test rmse = 0.181309 +/- 0.000000
Elapsed time = 0:00:02
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/bin/chemprop_train --data_path ./data/test_train_dm300_full.csv --dataset_type regression --save_dir ./data/train_results/removal --quiet --metric rmse --split_sizes 0.795 0.2 0.005 --smiles_columns full_smiles --target_columns dm300 --epochs 50
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/test_train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 50,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 770 | train size = 612 | val size = 154 | test size = 4
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.7117e-01, PNorm = 34.0148, GNorm = 6.9475, lr_0 = 5.1250e-04
Validation rmse = 0.235896
Epoch 1
Loss = 9.3639e-01, PNorm = 34.0368, GNorm = 5.4105, lr_0 = 9.2500e-04
Validation rmse = 0.228147
Epoch 2
Loss = 7.2103e-01, PNorm = 34.0821, GNorm = 1.6866, lr_0 = 9.6466e-04
Validation rmse = 0.235400
Epoch 3
Loss = 7.7723e-01, PNorm = 34.1264, GNorm = 6.9573, lr_0 = 9.2316e-04
Validation rmse = 0.202813
Epoch 4
Loss = 8.1232e-01, PNorm = 34.1767, GNorm = 10.6384, lr_0 = 8.8345e-04
Loss = 6.1455e-01, PNorm = 34.2259, GNorm = 2.3839, lr_0 = 8.4883e-04
Validation rmse = 0.190614
Epoch 5
Loss = 5.2671e-01, PNorm = 34.2790, GNorm = 1.5930, lr_0 = 8.1556e-04
Validation rmse = 0.189457
Epoch 6
Loss = 5.9731e-01, PNorm = 34.3280, GNorm = 7.4728, lr_0 = 7.8048e-04
Validation rmse = 0.175789
Epoch 7
Loss = 4.6527e-01, PNorm = 34.3753, GNorm = 6.7581, lr_0 = 7.4690e-04
Validation rmse = 0.194810
Epoch 8
Loss = 6.5054e-01, PNorm = 34.4191, GNorm = 6.5577, lr_0 = 7.1477e-04
Loss = 4.0733e-01, PNorm = 34.4640, GNorm = 12.4044, lr_0 = 6.8676e-04
Validation rmse = 0.171017
Epoch 9
Loss = 4.7446e-01, PNorm = 34.4953, GNorm = 6.2714, lr_0 = 6.5985e-04
Validation rmse = 0.177688
Epoch 10
Loss = 4.8403e-01, PNorm = 34.5350, GNorm = 7.1428, lr_0 = 6.3146e-04
Validation rmse = 0.175289
Epoch 11
Loss = 4.7155e-01, PNorm = 34.5699, GNorm = 7.1514, lr_0 = 6.0430e-04
Validation rmse = 0.169953
Epoch 12
Loss = 3.4391e-01, PNorm = 34.6041, GNorm = 3.3749, lr_0 = 5.7830e-04
Validation rmse = 0.151988
Epoch 13
Loss = 4.0004e-01, PNorm = 34.6349, GNorm = 1.5496, lr_0 = 5.5564e-04
Loss = 3.1448e-01, PNorm = 34.6659, GNorm = 4.4116, lr_0 = 5.3386e-04
Validation rmse = 0.151444
Epoch 14
Loss = 2.9565e-01, PNorm = 34.6890, GNorm = 4.0696, lr_0 = 5.1090e-04
Validation rmse = 0.142495
Epoch 15
Loss = 2.9018e-01, PNorm = 34.7187, GNorm = 2.4800, lr_0 = 4.8892e-04
Validation rmse = 0.146459
Epoch 16
Loss = 3.1361e-01, PNorm = 34.7490, GNorm = 5.3914, lr_0 = 4.6788e-04
Validation rmse = 0.135712
Epoch 17
Loss = 4.1113e-01, PNorm = 34.7732, GNorm = 6.4410, lr_0 = 4.4955e-04
Loss = 2.6658e-01, PNorm = 34.7949, GNorm = 3.1052, lr_0 = 4.3193e-04
Loss = 1.0248e-01, PNorm = 34.7975, GNorm = 2.4767, lr_0 = 4.3021e-04
Validation rmse = 0.161165
Epoch 18
Loss = 3.3299e-01, PNorm = 34.8197, GNorm = 7.7566, lr_0 = 4.1335e-04
Validation rmse = 0.148890
Epoch 19
Loss = 2.9635e-01, PNorm = 34.8387, GNorm = 1.6859, lr_0 = 3.9557e-04
Validation rmse = 0.128118
Epoch 20
Loss = 2.1522e-01, PNorm = 34.8598, GNorm = 2.6670, lr_0 = 3.7855e-04
Validation rmse = 0.134416
Epoch 21
Loss = 2.5408e-01, PNorm = 34.8755, GNorm = 5.0919, lr_0 = 3.6372e-04
Validation rmse = 0.134079
Epoch 22
Loss = 3.4676e-01, PNorm = 34.8952, GNorm = 3.9026, lr_0 = 3.4807e-04
Loss = 2.1878e-01, PNorm = 34.9103, GNorm = 1.1440, lr_0 = 3.3443e-04
Validation rmse = 0.129617
Epoch 23
Loss = 2.4180e-01, PNorm = 34.9286, GNorm = 1.1579, lr_0 = 3.2004e-04
Validation rmse = 0.127529
Epoch 24
Loss = 2.2974e-01, PNorm = 34.9430, GNorm = 7.4449, lr_0 = 3.0627e-04
Validation rmse = 0.131542
Epoch 25
Loss = 1.7833e-01, PNorm = 34.9551, GNorm = 1.2416, lr_0 = 2.9427e-04
Validation rmse = 0.128522
Epoch 26
Loss = 2.2119e-01, PNorm = 34.9700, GNorm = 1.7565, lr_0 = 2.8161e-04
Loss = 2.3182e-01, PNorm = 34.9833, GNorm = 2.5820, lr_0 = 2.7058e-04
Loss = 9.7813e-01, PNorm = 34.9843, GNorm = 7.3458, lr_0 = 2.6950e-04
Validation rmse = 0.130583
Epoch 27
Loss = 2.3641e-01, PNorm = 34.9951, GNorm = 1.0583, lr_0 = 2.5894e-04
Validation rmse = 0.126544
Epoch 28
Loss = 2.5424e-01, PNorm = 35.0084, GNorm = 4.7786, lr_0 = 2.4780e-04
Validation rmse = 0.127587
Epoch 29
Loss = 1.8388e-01, PNorm = 35.0208, GNorm = 0.9504, lr_0 = 2.3714e-04
Validation rmse = 0.127030
Epoch 30
Loss = 1.5916e-01, PNorm = 35.0305, GNorm = 0.5274, lr_0 = 2.2784e-04
Validation rmse = 0.128452
Epoch 31
Loss = 1.4803e-01, PNorm = 35.0405, GNorm = 2.3350, lr_0 = 2.1804e-04
Loss = 2.1809e-01, PNorm = 35.0492, GNorm = 0.9226, lr_0 = 2.0950e-04
Validation rmse = 0.126265
Epoch 32
Loss = 2.1467e-01, PNorm = 35.0604, GNorm = 2.6442, lr_0 = 2.0049e-04
Validation rmse = 0.125066
Epoch 33
Loss = 2.2920e-01, PNorm = 35.0706, GNorm = 1.0672, lr_0 = 1.9186e-04
Validation rmse = 0.125876
Epoch 34
Loss = 2.4152e-01, PNorm = 35.0782, GNorm = 5.3310, lr_0 = 1.8434e-04
Validation rmse = 0.125039
Epoch 35
Loss = 1.9512e-01, PNorm = 35.0868, GNorm = 1.0151, lr_0 = 1.7641e-04
Loss = 1.9566e-01, PNorm = 35.0944, GNorm = 1.0651, lr_0 = 1.6950e-04
Loss = 1.4621e-01, PNorm = 35.0954, GNorm = 5.0724, lr_0 = 1.6882e-04
Validation rmse = 0.123261
Epoch 36
Loss = 2.0725e-01, PNorm = 35.1049, GNorm = 3.2213, lr_0 = 1.6221e-04
Validation rmse = 0.129742
Epoch 37
Loss = 1.9953e-01, PNorm = 35.1119, GNorm = 5.2462, lr_0 = 1.5523e-04
Validation rmse = 0.122689
Epoch 38
Loss = 2.0464e-01, PNorm = 35.1184, GNorm = 2.5037, lr_0 = 1.4915e-04
Validation rmse = 0.123362
Epoch 39
Loss = 1.3485e-01, PNorm = 35.1258, GNorm = 4.1674, lr_0 = 1.4273e-04
Validation rmse = 0.126222
Epoch 40
Loss = 1.7974e-01, PNorm = 35.1329, GNorm = 1.5388, lr_0 = 1.3659e-04
Loss = 1.9632e-01, PNorm = 35.1379, GNorm = 3.2602, lr_0 = 1.3124e-04
Validation rmse = 0.122326
Epoch 41
Loss = 2.0761e-01, PNorm = 35.1449, GNorm = 3.4619, lr_0 = 1.2559e-04
Validation rmse = 0.123737
Epoch 42
Loss = 1.7803e-01, PNorm = 35.1500, GNorm = 1.3735, lr_0 = 1.2067e-04
Validation rmse = 0.125828
Epoch 43
Loss = 2.1880e-01, PNorm = 35.1552, GNorm = 1.4307, lr_0 = 1.1548e-04
Validation rmse = 0.126093
Epoch 44
Loss = 1.4975e-01, PNorm = 35.1617, GNorm = 1.1946, lr_0 = 1.1051e-04
Loss = 1.9610e-01, PNorm = 35.1665, GNorm = 3.2602, lr_0 = 1.0618e-04
Loss = 6.1651e-02, PNorm = 35.1669, GNorm = 2.6987, lr_0 = 1.0576e-04
Validation rmse = 0.122354
Epoch 45
Loss = 1.9677e-01, PNorm = 35.1709, GNorm = 2.3648, lr_0 = 1.0161e-04
Validation rmse = 0.126790
Epoch 46
Loss = 1.4248e-01, PNorm = 35.1749, GNorm = 0.7334, lr_0 = 1.0000e-04
Validation rmse = 0.122444
Epoch 47
Loss = 1.8722e-01, PNorm = 35.1793, GNorm = 1.1924, lr_0 = 1.0000e-04
Validation rmse = 0.121842
Epoch 48
Loss = 1.2142e-01, PNorm = 35.1846, GNorm = 1.2424, lr_0 = 1.0000e-04
Validation rmse = 0.121502
Epoch 49
Loss = 2.7030e-01, PNorm = 35.1897, GNorm = 1.8516, lr_0 = 1.0000e-04
Loss = 1.7090e-01, PNorm = 35.1945, GNorm = 1.3394, lr_0 = 1.0000e-04
Validation rmse = 0.122150
Model 0 best validation rmse = 0.121502 on epoch 48
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.042473
Ensemble test rmse = 0.042473
1-fold cross validation
	Seed 0 ==> test rmse = 0.042473
Overall test rmse = 0.042473 +/- 0.000000
Elapsed time = 0:00:24
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/bin/chemprop_train --data_path ./data/test_train_dm300_full.csv --dataset_type regression --save_dir ./data/train_results/removal --quiet --metric rmse --split_sizes 0.795 0.2 0.005 --smiles_columns full_smiles --target_columns dm300 --epochs 80
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/test_train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 80,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 770 | train size = 612 | val size = 154 | test size = 4
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.7117e-01, PNorm = 34.0148, GNorm = 6.9475, lr_0 = 5.1250e-04
Validation rmse = 0.235896
Epoch 1
Loss = 9.3639e-01, PNorm = 34.0368, GNorm = 5.4105, lr_0 = 9.2500e-04
Validation rmse = 0.228147
Epoch 2
Loss = 7.2092e-01, PNorm = 34.0824, GNorm = 1.5568, lr_0 = 9.7810e-04
Validation rmse = 0.235774
Epoch 3
Loss = 7.8110e-01, PNorm = 34.1278, GNorm = 7.4297, lr_0 = 9.5199e-04
Validation rmse = 0.204637
Epoch 4
Loss = 8.2880e-01, PNorm = 34.1803, GNorm = 10.9163, lr_0 = 9.2657e-04
Loss = 6.2241e-01, PNorm = 34.2314, GNorm = 1.8725, lr_0 = 9.0406e-04
Validation rmse = 0.190445
Epoch 5
Loss = 5.2810e-01, PNorm = 34.2868, GNorm = 1.5456, lr_0 = 8.8209e-04
Validation rmse = 0.188856
Epoch 6
Loss = 6.1997e-01, PNorm = 34.3383, GNorm = 9.0736, lr_0 = 8.5854e-04
Validation rmse = 0.178231
Epoch 7
Loss = 4.7011e-01, PNorm = 34.3912, GNorm = 5.6858, lr_0 = 8.3562e-04
Validation rmse = 0.195656
Epoch 8
Loss = 6.5466e-01, PNorm = 34.4402, GNorm = 6.4930, lr_0 = 8.1331e-04
Loss = 4.1495e-01, PNorm = 34.4909, GNorm = 12.5431, lr_0 = 7.9355e-04
Validation rmse = 0.172206
Epoch 9
Loss = 4.8257e-01, PNorm = 34.5280, GNorm = 6.5870, lr_0 = 7.7426e-04
Validation rmse = 0.176933
Epoch 10
Loss = 4.8429e-01, PNorm = 34.5756, GNorm = 7.4210, lr_0 = 7.5359e-04
Validation rmse = 0.170327
Epoch 11
Loss = 4.5066e-01, PNorm = 34.6187, GNorm = 6.0951, lr_0 = 7.3347e-04
Validation rmse = 0.166248
Epoch 12
Loss = 3.3372e-01, PNorm = 34.6601, GNorm = 1.1864, lr_0 = 7.1389e-04
Validation rmse = 0.147196
Epoch 13
Loss = 3.8193e-01, PNorm = 34.6984, GNorm = 0.9486, lr_0 = 6.9654e-04
Loss = 2.9470e-01, PNorm = 34.7356, GNorm = 1.7520, lr_0 = 6.7962e-04
Validation rmse = 0.153284
Epoch 14
Loss = 2.7573e-01, PNorm = 34.7685, GNorm = 0.8544, lr_0 = 6.6147e-04
Validation rmse = 0.136980
Epoch 15
Loss = 2.6896e-01, PNorm = 34.8064, GNorm = 4.1910, lr_0 = 6.4381e-04
Validation rmse = 0.143216
Epoch 16
Loss = 2.8472e-01, PNorm = 34.8452, GNorm = 7.3308, lr_0 = 6.2663e-04
Validation rmse = 0.136265
Epoch 17
Loss = 4.2794e-01, PNorm = 34.8776, GNorm = 11.6866, lr_0 = 6.1140e-04
Loss = 2.5066e-01, PNorm = 34.9107, GNorm = 1.6851, lr_0 = 5.9654e-04
Loss = 1.3477e-01, PNorm = 34.9142, GNorm = 6.8526, lr_0 = 5.9508e-04
Validation rmse = 0.136446
Epoch 18
Loss = 2.5274e-01, PNorm = 34.9457, GNorm = 2.6656, lr_0 = 5.8062e-04
Validation rmse = 0.129743
Epoch 19
Loss = 2.8308e-01, PNorm = 34.9727, GNorm = 5.6909, lr_0 = 5.6511e-04
Validation rmse = 0.124293
Epoch 20
Loss = 2.1942e-01, PNorm = 34.9974, GNorm = 4.0937, lr_0 = 5.5003e-04
Validation rmse = 0.133766
Epoch 21
Loss = 2.8510e-01, PNorm = 35.0184, GNorm = 8.6473, lr_0 = 5.3666e-04
Validation rmse = 0.146254
Epoch 22
Loss = 3.6543e-01, PNorm = 35.0474, GNorm = 6.9071, lr_0 = 5.2233e-04
Loss = 2.1612e-01, PNorm = 35.0711, GNorm = 2.3753, lr_0 = 5.0964e-04
Validation rmse = 0.130306
Epoch 23
Loss = 2.3045e-01, PNorm = 35.0989, GNorm = 0.8043, lr_0 = 4.9604e-04
Validation rmse = 0.125098
Epoch 24
Loss = 2.2476e-01, PNorm = 35.1197, GNorm = 7.0623, lr_0 = 4.8279e-04
Validation rmse = 0.138095
Epoch 25
Loss = 2.1078e-01, PNorm = 35.1386, GNorm = 5.3795, lr_0 = 4.7106e-04
Validation rmse = 0.125522
Epoch 26
Loss = 2.0218e-01, PNorm = 35.1612, GNorm = 2.5548, lr_0 = 4.5848e-04
Loss = 2.0459e-01, PNorm = 35.1845, GNorm = 1.3610, lr_0 = 4.4734e-04
Loss = 9.5135e-01, PNorm = 35.1862, GNorm = 4.7303, lr_0 = 4.4624e-04
Validation rmse = 0.138566
Epoch 27
Loss = 2.2310e-01, PNorm = 35.2049, GNorm = 2.2894, lr_0 = 4.3540e-04
Validation rmse = 0.133990
Epoch 28
Loss = 2.4174e-01, PNorm = 35.2278, GNorm = 2.7340, lr_0 = 4.2378e-04
Validation rmse = 0.141617
Epoch 29
Loss = 2.1556e-01, PNorm = 35.2464, GNorm = 0.9382, lr_0 = 4.1246e-04
Validation rmse = 0.121752
Epoch 30
Loss = 1.5262e-01, PNorm = 35.2649, GNorm = 2.3138, lr_0 = 4.0244e-04
Validation rmse = 0.127131
Epoch 31
Loss = 1.3724e-01, PNorm = 35.2834, GNorm = 2.0489, lr_0 = 3.9170e-04
Loss = 1.9914e-01, PNorm = 35.3002, GNorm = 1.1550, lr_0 = 3.8218e-04
Validation rmse = 0.124820
Epoch 32
Loss = 1.9680e-01, PNorm = 35.3200, GNorm = 1.2917, lr_0 = 3.7197e-04
Validation rmse = 0.120940
Epoch 33
Loss = 2.0478e-01, PNorm = 35.3364, GNorm = 1.1109, lr_0 = 3.6204e-04
Validation rmse = 0.127142
Epoch 34
Loss = 2.1135e-01, PNorm = 35.3520, GNorm = 3.3747, lr_0 = 3.5325e-04
Validation rmse = 0.120871
Epoch 35
Loss = 1.8441e-01, PNorm = 35.3693, GNorm = 3.4505, lr_0 = 3.4381e-04
Loss = 1.8887e-01, PNorm = 35.3825, GNorm = 2.0410, lr_0 = 3.3546e-04
Loss = 1.5484e-01, PNorm = 35.3845, GNorm = 6.2552, lr_0 = 3.3464e-04
Validation rmse = 0.125954
Epoch 36
Loss = 1.8586e-01, PNorm = 35.4022, GNorm = 1.6048, lr_0 = 3.2650e-04
Validation rmse = 0.126168
Epoch 37
Loss = 1.6851e-01, PNorm = 35.4188, GNorm = 1.2636, lr_0 = 3.1779e-04
Validation rmse = 0.129334
Epoch 38
Loss = 1.8444e-01, PNorm = 35.4328, GNorm = 3.1504, lr_0 = 3.1007e-04
Validation rmse = 0.128838
Epoch 39
Loss = 1.3155e-01, PNorm = 35.4474, GNorm = 4.5324, lr_0 = 3.0179e-04
Validation rmse = 0.122866
Epoch 40
Loss = 1.5854e-01, PNorm = 35.4609, GNorm = 1.8472, lr_0 = 2.9373e-04
Loss = 1.7446e-01, PNorm = 35.4728, GNorm = 2.0523, lr_0 = 2.8659e-04
Validation rmse = 0.122684
Epoch 41
Loss = 1.8569e-01, PNorm = 35.4890, GNorm = 3.1737, lr_0 = 2.7894e-04
Validation rmse = 0.120938
Epoch 42
Loss = 1.6299e-01, PNorm = 35.4990, GNorm = 2.5483, lr_0 = 2.7216e-04
Validation rmse = 0.124001
Epoch 43
Loss = 1.8997e-01, PNorm = 35.5105, GNorm = 1.1030, lr_0 = 2.6490e-04
Validation rmse = 0.122047
Epoch 44
Loss = 1.3497e-01, PNorm = 35.5241, GNorm = 1.9740, lr_0 = 2.5782e-04
Loss = 1.7258e-01, PNorm = 35.5328, GNorm = 1.2232, lr_0 = 2.5156e-04
Loss = 4.7177e-02, PNorm = 35.5337, GNorm = 2.4333, lr_0 = 2.5094e-04
Validation rmse = 0.122431
Epoch 45
Loss = 1.7439e-01, PNorm = 35.5450, GNorm = 3.1951, lr_0 = 2.4484e-04
Validation rmse = 0.121147
Epoch 46
Loss = 1.1882e-01, PNorm = 35.5540, GNorm = 1.8168, lr_0 = 2.3889e-04
Validation rmse = 0.121844
Epoch 47
Loss = 1.5857e-01, PNorm = 35.5631, GNorm = 1.6047, lr_0 = 2.3252e-04
Validation rmse = 0.120554
Epoch 48
Loss = 9.5687e-02, PNorm = 35.5764, GNorm = 1.1008, lr_0 = 2.2631e-04
Validation rmse = 0.121024
Epoch 49
Loss = 2.0491e-01, PNorm = 35.5860, GNorm = 2.0312, lr_0 = 2.2027e-04
Loss = 1.5114e-01, PNorm = 35.5965, GNorm = 1.6921, lr_0 = 2.1491e-04
Validation rmse = 0.120631
Epoch 50
Loss = 1.5511e-01, PNorm = 35.6031, GNorm = 1.4160, lr_0 = 2.0969e-04
Validation rmse = 0.124112
Epoch 51
Loss = 1.7505e-01, PNorm = 35.6136, GNorm = 4.4068, lr_0 = 2.0409e-04
Validation rmse = 0.120098
Epoch 52
Loss = 1.9935e-01, PNorm = 35.6236, GNorm = 4.1207, lr_0 = 1.9864e-04
Validation rmse = 0.123128
Epoch 53
Loss = 1.3576e-01, PNorm = 35.6318, GNorm = 1.9170, lr_0 = 1.9334e-04
Loss = 1.5092e-01, PNorm = 35.6409, GNorm = 1.0046, lr_0 = 1.8864e-04
Loss = 8.3867e-02, PNorm = 35.6415, GNorm = 2.9246, lr_0 = 1.8818e-04
Validation rmse = 0.123964
Epoch 54
Loss = 1.5782e-01, PNorm = 35.6485, GNorm = 2.7408, lr_0 = 1.8361e-04
Validation rmse = 0.123502
Epoch 55
Loss = 1.5924e-01, PNorm = 35.6548, GNorm = 2.4475, lr_0 = 1.7915e-04
Validation rmse = 0.121842
Epoch 56
Loss = 1.4626e-01, PNorm = 35.6627, GNorm = 3.0625, lr_0 = 1.7436e-04
Validation rmse = 0.123516
Epoch 57
Loss = 1.4145e-01, PNorm = 35.6712, GNorm = 3.7541, lr_0 = 1.6971e-04
Validation rmse = 0.121327
Epoch 58
Loss = 4.2092e-02, PNorm = 35.6793, GNorm = 1.3271, lr_0 = 1.6518e-04
Loss = 1.6393e-01, PNorm = 35.6858, GNorm = 3.1626, lr_0 = 1.6116e-04
Validation rmse = 0.123553
Epoch 59
Loss = 1.4473e-01, PNorm = 35.6943, GNorm = 1.5604, lr_0 = 1.5725e-04
Validation rmse = 0.122274
Epoch 60
Loss = 1.3909e-01, PNorm = 35.7006, GNorm = 4.9121, lr_0 = 1.5305e-04
Validation rmse = 0.121770
Epoch 61
Loss = 1.5290e-01, PNorm = 35.7081, GNorm = 3.3318, lr_0 = 1.4896e-04
Validation rmse = 0.121481
Epoch 62
Loss = 9.8201e-02, PNorm = 35.7158, GNorm = 5.1940, lr_0 = 1.4499e-04
Loss = 1.5167e-01, PNorm = 35.7210, GNorm = 2.1680, lr_0 = 1.4146e-04
Validation rmse = 0.121333
Epoch 63
Loss = 1.3760e-01, PNorm = 35.7271, GNorm = 4.3521, lr_0 = 1.3802e-04
Validation rmse = 0.120738
Epoch 64
Loss = 1.2273e-01, PNorm = 35.7347, GNorm = 5.4264, lr_0 = 1.3434e-04
Validation rmse = 0.122201
Epoch 65
Loss = 1.3592e-01, PNorm = 35.7406, GNorm = 1.9554, lr_0 = 1.3075e-04
Validation rmse = 0.121920
Epoch 66
Loss = 2.0899e-01, PNorm = 35.7471, GNorm = 1.3198, lr_0 = 1.2726e-04
Loss = 1.3199e-01, PNorm = 35.7526, GNorm = 5.0457, lr_0 = 1.2417e-04
Validation rmse = 0.123617
Epoch 67
Loss = 1.3682e-01, PNorm = 35.7581, GNorm = 0.7740, lr_0 = 1.2115e-04
Validation rmse = 0.121368
Epoch 68
Loss = 1.5430e-01, PNorm = 35.7636, GNorm = 1.1934, lr_0 = 1.1792e-04
Validation rmse = 0.122184
Epoch 69
Loss = 1.3795e-01, PNorm = 35.7675, GNorm = 1.1048, lr_0 = 1.1477e-04
Validation rmse = 0.122227
Epoch 70
Loss = 8.0603e-02, PNorm = 35.7721, GNorm = 0.6059, lr_0 = 1.1171e-04
Validation rmse = 0.124280
Epoch 71
Loss = 1.1329e-01, PNorm = 35.7765, GNorm = 1.2961, lr_0 = 1.0899e-04
Loss = 1.4559e-01, PNorm = 35.7812, GNorm = 1.7033, lr_0 = 1.0634e-04
Validation rmse = 0.123713
Epoch 72
Loss = 1.3101e-01, PNorm = 35.7864, GNorm = 2.9313, lr_0 = 1.0350e-04
Validation rmse = 0.121636
Epoch 73
Loss = 1.6327e-01, PNorm = 35.7897, GNorm = 1.4036, lr_0 = 1.0074e-04
Validation rmse = 0.124177
Epoch 74
Loss = 1.0462e-01, PNorm = 35.7944, GNorm = 0.6832, lr_0 = 1.0000e-04
Validation rmse = 0.126437
Epoch 75
Loss = 1.8879e-01, PNorm = 35.7990, GNorm = 4.9902, lr_0 = 1.0000e-04
Loss = 1.2168e-01, PNorm = 35.8033, GNorm = 2.9966, lr_0 = 1.0000e-04
Loss = 1.9093e-01, PNorm = 35.8037, GNorm = 5.4502, lr_0 = 1.0000e-04
Validation rmse = 0.121900
Epoch 76
Loss = 1.2522e-01, PNorm = 35.8084, GNorm = 2.0170, lr_0 = 1.0000e-04
Validation rmse = 0.121172
Epoch 77
Loss = 1.1584e-01, PNorm = 35.8126, GNorm = 1.5678, lr_0 = 1.0000e-04
Validation rmse = 0.121649
Epoch 78
Loss = 1.0335e-01, PNorm = 35.8175, GNorm = 2.8114, lr_0 = 1.0000e-04
Validation rmse = 0.122454
Epoch 79
Loss = 1.7076e-01, PNorm = 35.8223, GNorm = 1.1064, lr_0 = 1.0000e-04
Validation rmse = 0.123848
Model 0 best validation rmse = 0.120098 on epoch 51
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.055604
Ensemble test rmse = 0.055604
1-fold cross validation
	Seed 0 ==> test rmse = 0.055604
Overall test rmse = 0.055604 +/- 0.000000
Elapsed time = 0:00:38
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/bin/chemprop_train --data_path ./data/test_train_dm300_reduced_meoh.csv --dataset_type regression --save_dir ./data/train_results/removal --quiet --metric rmse --split_sizes 0.795 0.2 0.005 --smiles_columns full_smiles --target_columns dm300 --epochs 60
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/test_train_dm300_reduced_meoh.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/bin/chemprop_train --data_path ./data/train_dm300_reduced_meoh.csv --dataset_type regression --save_dir ./data/train_results/removal --quiet --metric rmse --split_sizes 0.795 0.2 0.005 --smiles_columns full_smiles --target_columns dm300 --epochs 60
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/train_dm300_reduced_meoh.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,081 | train size = 859 | val size = 216 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.9916e-01, PNorm = 34.0144, GNorm = 6.9784, lr_0 = 3.9118e-04
Validation rmse = 0.317480
Epoch 1
Loss = 7.2271e-01, PNorm = 34.0358, GNorm = 1.6679, lr_0 = 6.8235e-04
Loss = 6.8747e-01, PNorm = 34.0826, GNorm = 6.4557, lr_0 = 9.4706e-04
Validation rmse = 0.236733
Epoch 2
Loss = 5.3354e-01, PNorm = 34.1562, GNorm = 2.9616, lr_0 = 9.7920e-04
Loss = 4.2188e-01, PNorm = 34.2322, GNorm = 3.0483, lr_0 = 9.5660e-04
Validation rmse = 0.240986
Epoch 3
Loss = 4.9360e-01, PNorm = 34.3027, GNorm = 4.3406, lr_0 = 9.3234e-04
Validation rmse = 0.276160
Epoch 4
Loss = 6.2007e-01, PNorm = 34.3644, GNorm = 5.9181, lr_0 = 9.0869e-04
Loss = 3.9965e-01, PNorm = 34.4264, GNorm = 0.8458, lr_0 = 8.8772e-04
Validation rmse = 0.183737
Epoch 5
Loss = 3.4368e-01, PNorm = 34.4868, GNorm = 2.3391, lr_0 = 8.6521e-04
Loss = 2.4271e-01, PNorm = 34.5410, GNorm = 2.4112, lr_0 = 8.4524e-04
Validation rmse = 0.180654
Epoch 6
Loss = 2.3557e-01, PNorm = 34.5799, GNorm = 1.1960, lr_0 = 8.2573e-04
Loss = 2.3772e-01, PNorm = 34.6188, GNorm = 1.3084, lr_0 = 8.0667e-04
Loss = 1.6013e-01, PNorm = 34.6219, GNorm = 1.9040, lr_0 = 8.0478e-04
Validation rmse = 0.156153
Epoch 7
Loss = 1.8271e-01, PNorm = 34.6504, GNorm = 0.5707, lr_0 = 7.8621e-04
Validation rmse = 0.184342
Epoch 8
Loss = 2.0675e-01, PNorm = 34.6934, GNorm = 0.5834, lr_0 = 7.6627e-04
Loss = 2.1625e-01, PNorm = 34.7260, GNorm = 5.1104, lr_0 = 7.4858e-04
Validation rmse = 0.154211
Epoch 9
Loss = 2.3014e-01, PNorm = 34.7555, GNorm = 2.4834, lr_0 = 7.2960e-04
Loss = 1.6030e-01, PNorm = 34.7821, GNorm = 1.5868, lr_0 = 7.1276e-04
Validation rmse = 0.158678
Epoch 10
Loss = 1.6373e-01, PNorm = 34.8097, GNorm = 1.7597, lr_0 = 6.9468e-04
Validation rmse = 0.140074
Epoch 11
Loss = 1.4969e-01, PNorm = 34.8360, GNorm = 1.1949, lr_0 = 6.7706e-04
Loss = 1.4893e-01, PNorm = 34.8578, GNorm = 1.5329, lr_0 = 6.6143e-04
Validation rmse = 0.151553
Epoch 12
Loss = 1.5213e-01, PNorm = 34.8882, GNorm = 2.2379, lr_0 = 6.4617e-04
Loss = 1.6373e-01, PNorm = 34.9133, GNorm = 4.0669, lr_0 = 6.3125e-04
Validation rmse = 0.132383
Epoch 13
Loss = 1.8187e-01, PNorm = 34.9333, GNorm = 4.3404, lr_0 = 6.1524e-04
Loss = 1.6372e-01, PNorm = 34.9506, GNorm = 2.2385, lr_0 = 6.0104e-04
Loss = 8.8673e-02, PNorm = 34.9522, GNorm = 1.3152, lr_0 = 5.9964e-04
Validation rmse = 0.134481
Epoch 14
Loss = 1.4850e-01, PNorm = 34.9665, GNorm = 1.4269, lr_0 = 5.8580e-04
Validation rmse = 0.130952
Epoch 15
Loss = 1.4821e-01, PNorm = 34.9887, GNorm = 1.1557, lr_0 = 5.7094e-04
Loss = 1.5528e-01, PNorm = 35.0032, GNorm = 0.5250, lr_0 = 5.5776e-04
Validation rmse = 0.131517
Epoch 16
Loss = 1.3553e-01, PNorm = 35.0206, GNorm = 1.9729, lr_0 = 5.4362e-04
Loss = 1.3502e-01, PNorm = 35.0343, GNorm = 0.6666, lr_0 = 5.3107e-04
Validation rmse = 0.139733
Epoch 17
Loss = 1.2731e-01, PNorm = 35.0424, GNorm = 1.7279, lr_0 = 5.1881e-04
Validation rmse = 0.140962
Epoch 18
Loss = 1.3506e-01, PNorm = 35.0562, GNorm = 3.3374, lr_0 = 5.0565e-04
Loss = 1.4158e-01, PNorm = 35.0664, GNorm = 0.7799, lr_0 = 4.9398e-04
Validation rmse = 0.133557
Epoch 19
Loss = 1.1071e-01, PNorm = 35.0810, GNorm = 3.5065, lr_0 = 4.8146e-04
Loss = 1.3339e-01, PNorm = 35.0932, GNorm = 0.6493, lr_0 = 4.7034e-04
Validation rmse = 0.141844
Epoch 20
Loss = 1.3353e-01, PNorm = 35.1057, GNorm = 3.8598, lr_0 = 4.5841e-04
Loss = 1.3662e-01, PNorm = 35.1148, GNorm = 1.9166, lr_0 = 4.4783e-04
Loss = 1.9149e-01, PNorm = 35.1159, GNorm = 1.8383, lr_0 = 4.4679e-04
Validation rmse = 0.139911
Epoch 21
Loss = 1.4026e-01, PNorm = 35.1312, GNorm = 1.6011, lr_0 = 4.3648e-04
Validation rmse = 0.131865
Epoch 22
Loss = 1.0279e-01, PNorm = 35.1393, GNorm = 0.9059, lr_0 = 4.2541e-04
Loss = 1.3642e-01, PNorm = 35.1473, GNorm = 0.9924, lr_0 = 4.1559e-04
Validation rmse = 0.132710
Epoch 23
Loss = 1.3667e-01, PNorm = 35.1590, GNorm = 2.4175, lr_0 = 4.0599e-04
Loss = 1.3087e-01, PNorm = 35.1692, GNorm = 1.6000, lr_0 = 3.9662e-04
Validation rmse = 0.139626
Epoch 24
Loss = 1.1982e-01, PNorm = 35.1793, GNorm = 1.5828, lr_0 = 3.8656e-04
Validation rmse = 0.152138
Epoch 25
Loss = 1.6226e-01, PNorm = 35.1895, GNorm = 4.3140, lr_0 = 3.7676e-04
Loss = 1.3179e-01, PNorm = 35.2020, GNorm = 0.6931, lr_0 = 3.6806e-04
Validation rmse = 0.157096
Epoch 26
Loss = 1.1200e-01, PNorm = 35.2128, GNorm = 1.1088, lr_0 = 3.5873e-04
Loss = 1.3286e-01, PNorm = 35.2236, GNorm = 0.7964, lr_0 = 3.5045e-04
Validation rmse = 0.142934
Epoch 27
Loss = 1.2874e-01, PNorm = 35.2328, GNorm = 1.8813, lr_0 = 3.4156e-04
Loss = 1.1786e-01, PNorm = 35.2426, GNorm = 2.1464, lr_0 = 3.3368e-04
Validation rmse = 0.133903
Epoch 28
Loss = 1.1265e-01, PNorm = 35.2532, GNorm = 2.0034, lr_0 = 3.2598e-04
Validation rmse = 0.133352
Epoch 29
Loss = 9.5840e-02, PNorm = 35.2641, GNorm = 1.5204, lr_0 = 3.1771e-04
Loss = 1.0610e-01, PNorm = 35.2722, GNorm = 1.6983, lr_0 = 3.1037e-04
Validation rmse = 0.130720
Epoch 30
Loss = 1.1782e-01, PNorm = 35.2815, GNorm = 0.8599, lr_0 = 3.0250e-04
Loss = 1.1810e-01, PNorm = 35.2870, GNorm = 1.0231, lr_0 = 2.9552e-04
Validation rmse = 0.136009
Epoch 31
Loss = 1.1369e-01, PNorm = 35.2943, GNorm = 3.9552, lr_0 = 2.8803e-04
Validation rmse = 0.143646
Epoch 32
Loss = 2.1696e-01, PNorm = 35.3062, GNorm = 1.2876, lr_0 = 2.8072e-04
Loss = 1.0695e-01, PNorm = 35.3158, GNorm = 0.8393, lr_0 = 2.7424e-04
Validation rmse = 0.130497
Epoch 33
Loss = 1.3990e-01, PNorm = 35.3229, GNorm = 0.8503, lr_0 = 2.6729e-04
Loss = 1.0663e-01, PNorm = 35.3294, GNorm = 0.9350, lr_0 = 2.6112e-04
Validation rmse = 0.132877
Epoch 34
Loss = 1.1309e-01, PNorm = 35.3379, GNorm = 1.7946, lr_0 = 2.5509e-04
Loss = 1.1114e-01, PNorm = 35.3458, GNorm = 0.9516, lr_0 = 2.4920e-04
Validation rmse = 0.133829
Epoch 35
Loss = 1.0372e-01, PNorm = 35.3498, GNorm = 0.9039, lr_0 = 2.4288e-04
Validation rmse = 0.139837
Epoch 36
Loss = 1.4665e-01, PNorm = 35.3552, GNorm = 1.2106, lr_0 = 2.3672e-04
Loss = 1.0712e-01, PNorm = 35.3630, GNorm = 1.2892, lr_0 = 2.3126e-04
Validation rmse = 0.134965
Epoch 37
Loss = 1.3826e-01, PNorm = 35.3701, GNorm = 1.0887, lr_0 = 2.2539e-04
Loss = 1.0584e-01, PNorm = 35.3762, GNorm = 0.9181, lr_0 = 2.2019e-04
Validation rmse = 0.134238
Epoch 38
Loss = 9.9754e-02, PNorm = 35.3821, GNorm = 0.9259, lr_0 = 2.1461e-04
Loss = 1.1047e-01, PNorm = 35.3885, GNorm = 1.2581, lr_0 = 2.0965e-04
Validation rmse = 0.131241
Epoch 39
Loss = 1.3048e-01, PNorm = 35.3941, GNorm = 2.4607, lr_0 = 2.0481e-04
Validation rmse = 0.134004
Epoch 40
Loss = 9.1020e-02, PNorm = 35.4012, GNorm = 2.4137, lr_0 = 1.9962e-04
Loss = 9.7370e-02, PNorm = 35.4060, GNorm = 0.6208, lr_0 = 1.9501e-04
Validation rmse = 0.133264
Epoch 41
Loss = 1.1235e-01, PNorm = 35.4107, GNorm = 0.5699, lr_0 = 1.9007e-04
Loss = 1.0346e-01, PNorm = 35.4151, GNorm = 1.3667, lr_0 = 1.8568e-04
Validation rmse = 0.134140
Epoch 42
Loss = 9.0517e-02, PNorm = 35.4224, GNorm = 1.0779, lr_0 = 1.8097e-04
Validation rmse = 0.133929
Epoch 43
Loss = 1.5346e-01, PNorm = 35.4270, GNorm = 2.2569, lr_0 = 1.7638e-04
Loss = 9.7473e-02, PNorm = 35.4316, GNorm = 1.6703, lr_0 = 1.7231e-04
Validation rmse = 0.131928
Epoch 44
Loss = 9.7492e-02, PNorm = 35.4383, GNorm = 1.0188, lr_0 = 1.6794e-04
Loss = 1.0969e-01, PNorm = 35.4432, GNorm = 0.7119, lr_0 = 1.6406e-04
Validation rmse = 0.143097
Epoch 45
Loss = 1.1066e-01, PNorm = 35.4481, GNorm = 1.1021, lr_0 = 1.6028e-04
Loss = 1.0507e-01, PNorm = 35.4531, GNorm = 3.7357, lr_0 = 1.5658e-04
Loss = 7.6385e-02, PNorm = 35.4536, GNorm = 2.3735, lr_0 = 1.5621e-04
Validation rmse = 0.132076
Epoch 46
Loss = 9.2044e-02, PNorm = 35.4575, GNorm = 1.4404, lr_0 = 1.5261e-04
Validation rmse = 0.138499
Epoch 47
Loss = 1.2077e-01, PNorm = 35.4623, GNorm = 2.4931, lr_0 = 1.4874e-04
Loss = 9.9888e-02, PNorm = 35.4657, GNorm = 2.1777, lr_0 = 1.4530e-04
Validation rmse = 0.130237
Epoch 48
Loss = 1.1091e-01, PNorm = 35.4717, GNorm = 0.8566, lr_0 = 1.4162e-04
Loss = 9.5041e-02, PNorm = 35.4759, GNorm = 0.5319, lr_0 = 1.3835e-04
Validation rmse = 0.134879
Epoch 49
Loss = 1.0206e-01, PNorm = 35.4801, GNorm = 1.8636, lr_0 = 1.3484e-04
Validation rmse = 0.130126
Epoch 50
Loss = 6.2675e-02, PNorm = 35.4845, GNorm = 0.7869, lr_0 = 1.3173e-04
Loss = 1.0143e-01, PNorm = 35.4877, GNorm = 1.4117, lr_0 = 1.2869e-04
Validation rmse = 0.133601
Epoch 51
Loss = 1.2020e-01, PNorm = 35.4919, GNorm = 2.7161, lr_0 = 1.2542e-04
Loss = 1.0233e-01, PNorm = 35.4969, GNorm = 2.7219, lr_0 = 1.2253e-04
Validation rmse = 0.133463
Epoch 52
Loss = 9.1053e-02, PNorm = 35.5004, GNorm = 0.5912, lr_0 = 1.1942e-04
Loss = 1.0537e-01, PNorm = 35.5035, GNorm = 2.3648, lr_0 = 1.1666e-04
Loss = 8.3141e-02, PNorm = 35.5038, GNorm = 1.1644, lr_0 = 1.1639e-04
Validation rmse = 0.130468
Epoch 53
Loss = 1.0413e-01, PNorm = 35.5073, GNorm = 1.7173, lr_0 = 1.1371e-04
Validation rmse = 0.131915
Epoch 54
Loss = 1.0832e-01, PNorm = 35.5099, GNorm = 0.9689, lr_0 = 1.1082e-04
Loss = 9.6291e-02, PNorm = 35.5126, GNorm = 1.1933, lr_0 = 1.0826e-04
Validation rmse = 0.136700
Epoch 55
Loss = 1.0247e-01, PNorm = 35.5161, GNorm = 0.7979, lr_0 = 1.0552e-04
Loss = 1.0295e-01, PNorm = 35.5190, GNorm = 1.7817, lr_0 = 1.0308e-04
Validation rmse = 0.132267
Epoch 56
Loss = 1.1024e-01, PNorm = 35.5221, GNorm = 0.8595, lr_0 = 1.0070e-04
Validation rmse = 0.130922
Epoch 57
Loss = 8.7324e-02, PNorm = 35.5247, GNorm = 1.4633, lr_0 = 1.0000e-04
Loss = 9.1575e-02, PNorm = 35.5276, GNorm = 0.8370, lr_0 = 1.0000e-04
Validation rmse = 0.133918
Epoch 58
Loss = 8.3281e-02, PNorm = 35.5303, GNorm = 0.5935, lr_0 = 1.0000e-04
Loss = 1.0789e-01, PNorm = 35.5339, GNorm = 1.1085, lr_0 = 1.0000e-04
Validation rmse = 0.129042
Epoch 59
Loss = 1.1210e-01, PNorm = 35.5362, GNorm = 1.5721, lr_0 = 1.0000e-04
Loss = 8.7142e-02, PNorm = 35.5396, GNorm = 1.1208, lr_0 = 1.0000e-04
Loss = 6.6483e-02, PNorm = 35.5398, GNorm = 1.7929, lr_0 = 1.0000e-04
Validation rmse = 0.129790
Model 0 best validation rmse = 0.129042 on epoch 58
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.142398
Ensemble test rmse = 0.142398
1-fold cross validation
	Seed 0 ==> test rmse = 0.142398
Overall test rmse = 0.142398 +/- 0.000000
Elapsed time = 0:00:42
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/bin/chemprop_train --data_path ./data/train_dm300_reduced_meoh.csv --dataset_type regression --save_dir ./data/train_results/removal/ --quiet --metric rmse --smiles_columns full_smiles --target_columns dm300 --epochs 60 --extra_metrics r2
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/train_dm300_reduced_meoh.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,081 | train size = 864 | val size = 108 | test size = 109
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.0025e+00, PNorm = 34.0165, GNorm = 1.9060, lr_0 = 3.9118e-04
Validation rmse = 0.282909
Validation r2 = 0.298722
Epoch 1
Loss = 7.5041e-01, PNorm = 34.0408, GNorm = 7.7764, lr_0 = 6.8235e-04
Loss = 6.4612e-01, PNorm = 34.0871, GNorm = 12.1670, lr_0 = 9.4706e-04
Validation rmse = 0.223949
Validation r2 = 0.560565
Epoch 2
Loss = 4.7623e-01, PNorm = 34.1634, GNorm = 0.9150, lr_0 = 9.7920e-04
Loss = 4.5796e-01, PNorm = 34.2322, GNorm = 7.5490, lr_0 = 9.5660e-04
Validation rmse = 0.199466
Validation r2 = 0.651395
Epoch 3
Loss = 4.1485e-01, PNorm = 34.3033, GNorm = 5.8426, lr_0 = 9.3234e-04
Validation rmse = 0.163956
Validation r2 = 0.764467
Epoch 4
Loss = 3.5407e-01, PNorm = 34.3662, GNorm = 1.3724, lr_0 = 9.1082e-04
Loss = 3.2507e-01, PNorm = 34.4198, GNorm = 4.9995, lr_0 = 8.8980e-04
Validation rmse = 0.155461
Validation r2 = 0.788241
Epoch 5
Loss = 2.9312e-01, PNorm = 34.4762, GNorm = 4.1132, lr_0 = 8.6723e-04
Loss = 2.6561e-01, PNorm = 34.5340, GNorm = 6.0176, lr_0 = 8.4721e-04
Validation rmse = 0.167107
Validation r2 = 0.755328
Epoch 6
Loss = 2.3205e-01, PNorm = 34.5790, GNorm = 2.4897, lr_0 = 8.2573e-04
Loss = 2.1892e-01, PNorm = 34.6188, GNorm = 2.9984, lr_0 = 8.0667e-04
Loss = 1.8315e-01, PNorm = 34.6215, GNorm = 1.4915, lr_0 = 8.0478e-04
Validation rmse = 0.170313
Validation r2 = 0.745849
Epoch 7
Loss = 2.5390e-01, PNorm = 34.6504, GNorm = 1.2694, lr_0 = 7.8621e-04
Validation rmse = 0.178127
Validation r2 = 0.721992
Epoch 8
Loss = 1.9346e-01, PNorm = 34.6898, GNorm = 0.9699, lr_0 = 7.6806e-04
Loss = 2.3342e-01, PNorm = 34.7312, GNorm = 6.6997, lr_0 = 7.5033e-04
Validation rmse = 0.141763
Validation r2 = 0.823915
Epoch 9
Loss = 2.0804e-01, PNorm = 34.7579, GNorm = 4.7546, lr_0 = 7.3130e-04
Loss = 2.0886e-01, PNorm = 34.7898, GNorm = 1.6854, lr_0 = 7.1442e-04
Validation rmse = 0.172690
Validation r2 = 0.738706
Epoch 10
Loss = 1.7139e-01, PNorm = 34.8171, GNorm = 4.3461, lr_0 = 6.9630e-04
Loss = 1.9923e-01, PNorm = 34.8485, GNorm = 2.7947, lr_0 = 6.8023e-04
Validation rmse = 0.151339
Validation r2 = 0.799323
Epoch 11
Loss = 1.7092e-01, PNorm = 34.8731, GNorm = 1.8644, lr_0 = 6.6453e-04
Validation rmse = 0.133765
Validation r2 = 0.843223
Epoch 12
Loss = 1.7075e-01, PNorm = 34.9019, GNorm = 0.8045, lr_0 = 6.4768e-04
Loss = 1.5247e-01, PNorm = 34.9228, GNorm = 4.6753, lr_0 = 6.3273e-04
Validation rmse = 0.129243
Validation r2 = 0.853644
Epoch 13
Loss = 1.4953e-01, PNorm = 34.9416, GNorm = 1.4799, lr_0 = 6.1668e-04
Loss = 1.3851e-01, PNorm = 34.9580, GNorm = 1.6067, lr_0 = 6.0245e-04
Validation rmse = 0.145972
Validation r2 = 0.813303
Epoch 14
Loss = 1.3147e-01, PNorm = 34.9707, GNorm = 1.5322, lr_0 = 5.8717e-04
Validation rmse = 0.144085
Validation r2 = 0.818099
Epoch 15
Loss = 1.6719e-01, PNorm = 34.9887, GNorm = 0.9082, lr_0 = 5.7362e-04
Loss = 1.3418e-01, PNorm = 35.0077, GNorm = 1.0854, lr_0 = 5.6037e-04
Validation rmse = 0.135108
Validation r2 = 0.840059
Epoch 16
Loss = 1.2666e-01, PNorm = 35.0271, GNorm = 1.0984, lr_0 = 5.4616e-04
Loss = 1.5098e-01, PNorm = 35.0462, GNorm = 0.8781, lr_0 = 5.3356e-04
Validation rmse = 0.144642
Validation r2 = 0.816689
Epoch 17
Loss = 1.1770e-01, PNorm = 35.0586, GNorm = 1.2122, lr_0 = 5.2003e-04
Loss = 1.5307e-01, PNorm = 35.0725, GNorm = 2.8093, lr_0 = 5.0802e-04
Validation rmse = 0.143140
Validation r2 = 0.820478
Epoch 18
Loss = 1.3896e-01, PNorm = 35.0893, GNorm = 4.7057, lr_0 = 4.9630e-04
Validation rmse = 0.133056
Validation r2 = 0.844881
Epoch 19
Loss = 1.2059e-01, PNorm = 35.1024, GNorm = 3.0091, lr_0 = 4.8371e-04
Loss = 1.2950e-01, PNorm = 35.1145, GNorm = 1.1662, lr_0 = 4.7254e-04
Validation rmse = 0.136082
Validation r2 = 0.837746
Epoch 20
Loss = 1.2449e-01, PNorm = 35.1329, GNorm = 0.8488, lr_0 = 4.6056e-04
Loss = 1.4119e-01, PNorm = 35.1467, GNorm = 2.2987, lr_0 = 4.4993e-04
Validation rmse = 0.140751
Validation r2 = 0.826421
Epoch 21
Loss = 1.3616e-01, PNorm = 35.1625, GNorm = 1.3878, lr_0 = 4.3852e-04
Loss = 1.0283e-01, PNorm = 35.1739, GNorm = 1.5461, lr_0 = 4.2840e-04
Validation rmse = 0.133912
Validation r2 = 0.842878
Epoch 22
Loss = 1.2011e-01, PNorm = 35.1850, GNorm = 1.9353, lr_0 = 4.1851e-04
Validation rmse = 0.159430
Validation r2 = 0.777292
Epoch 23
Loss = 1.4476e-01, PNorm = 35.1991, GNorm = 0.7244, lr_0 = 4.0789e-04
Loss = 1.2883e-01, PNorm = 35.2105, GNorm = 0.8915, lr_0 = 3.9848e-04
Validation rmse = 0.142184
Validation r2 = 0.822869
Epoch 24
Loss = 1.1363e-01, PNorm = 35.2206, GNorm = 1.6926, lr_0 = 3.8837e-04
Loss = 1.2749e-01, PNorm = 35.2311, GNorm = 2.8643, lr_0 = 3.7941e-04
Validation rmse = 0.173219
Validation r2 = 0.737102
Epoch 25
Loss = 1.2795e-01, PNorm = 35.2448, GNorm = 0.9480, lr_0 = 3.7065e-04
Validation rmse = 0.140470
Validation r2 = 0.827112
Epoch 26
Loss = 6.9241e-02, PNorm = 35.2568, GNorm = 1.7039, lr_0 = 3.6125e-04
Loss = 1.2697e-01, PNorm = 35.2691, GNorm = 2.8838, lr_0 = 3.5291e-04
Validation rmse = 0.153957
Validation r2 = 0.792320
Epoch 27
Loss = 1.6121e-01, PNorm = 35.2801, GNorm = 4.7202, lr_0 = 3.4396e-04
Loss = 1.5757e-01, PNorm = 35.2947, GNorm = 3.5363, lr_0 = 3.3602e-04
Validation rmse = 0.136610
Validation r2 = 0.836485
Epoch 28
Loss = 1.0993e-01, PNorm = 35.3071, GNorm = 1.8820, lr_0 = 3.2750e-04
Loss = 1.3235e-01, PNorm = 35.3187, GNorm = 1.2689, lr_0 = 3.1994e-04
Validation rmse = 0.137001
Validation r2 = 0.835546
Epoch 29
Loss = 9.3858e-02, PNorm = 35.3282, GNorm = 0.5692, lr_0 = 3.1256e-04
Validation rmse = 0.133349
Validation r2 = 0.844198
Epoch 30
Loss = 5.9315e-02, PNorm = 35.3374, GNorm = 1.1463, lr_0 = 3.0463e-04
Loss = 1.1668e-01, PNorm = 35.3450, GNorm = 1.4223, lr_0 = 2.9760e-04
Validation rmse = 0.151614
Validation r2 = 0.798593
Epoch 31
Loss = 1.0162e-01, PNorm = 35.3548, GNorm = 1.0594, lr_0 = 2.9005e-04
Loss = 1.0614e-01, PNorm = 35.3632, GNorm = 2.9205, lr_0 = 2.8336e-04
Validation rmse = 0.158369
Validation r2 = 0.780246
Epoch 32
Loss = 1.2602e-01, PNorm = 35.3757, GNorm = 1.8853, lr_0 = 2.7617e-04
Loss = 1.0503e-01, PNorm = 35.3843, GNorm = 2.2351, lr_0 = 2.6980e-04
Validation rmse = 0.130756
Validation r2 = 0.850196
Epoch 33
Loss = 1.1020e-01, PNorm = 35.3915, GNorm = 1.3977, lr_0 = 2.6357e-04
Validation rmse = 0.139824
Validation r2 = 0.828699
Epoch 34
Loss = 1.2432e-01, PNorm = 35.3994, GNorm = 1.1778, lr_0 = 2.5688e-04
Loss = 1.0259e-01, PNorm = 35.4069, GNorm = 0.7319, lr_0 = 2.5095e-04
Validation rmse = 0.136640
Validation r2 = 0.836412
Epoch 35
Loss = 1.1400e-01, PNorm = 35.4137, GNorm = 0.7983, lr_0 = 2.4459e-04
Loss = 9.2457e-02, PNorm = 35.4196, GNorm = 1.0986, lr_0 = 2.3894e-04
Validation rmse = 0.153046
Validation r2 = 0.794769
Epoch 36
Loss = 1.3416e-01, PNorm = 35.4276, GNorm = 3.5826, lr_0 = 2.3343e-04
Validation rmse = 0.131942
Validation r2 = 0.847466
Epoch 37
Loss = 1.5714e-01, PNorm = 35.4354, GNorm = 2.3596, lr_0 = 2.2751e-04
Loss = 1.1785e-01, PNorm = 35.4447, GNorm = 0.9753, lr_0 = 2.2226e-04
Validation rmse = 0.148831
Validation r2 = 0.805919
Epoch 38
Loss = 9.8980e-02, PNorm = 35.4539, GNorm = 2.3354, lr_0 = 2.1662e-04
Loss = 1.1183e-01, PNorm = 35.4583, GNorm = 1.2526, lr_0 = 2.1162e-04
Validation rmse = 0.129834
Validation r2 = 0.852303
Epoch 39
Loss = 1.1245e-01, PNorm = 35.4686, GNorm = 1.5769, lr_0 = 2.0625e-04
Loss = 9.9597e-02, PNorm = 35.4741, GNorm = 1.3889, lr_0 = 2.0149e-04
Validation rmse = 0.131074
Validation r2 = 0.849467
Epoch 40
Loss = 9.5837e-02, PNorm = 35.4789, GNorm = 1.0866, lr_0 = 1.9684e-04
Validation rmse = 0.144839
Validation r2 = 0.816190
Epoch 41
Loss = 9.2109e-02, PNorm = 35.4848, GNorm = 0.8238, lr_0 = 1.9185e-04
Loss = 1.0679e-01, PNorm = 35.4897, GNorm = 1.9765, lr_0 = 1.8742e-04
Validation rmse = 0.136693
Validation r2 = 0.836285
Epoch 42
Loss = 8.1705e-02, PNorm = 35.4952, GNorm = 0.7829, lr_0 = 1.8267e-04
Loss = 1.0313e-01, PNorm = 35.4995, GNorm = 0.5863, lr_0 = 1.7845e-04
Validation rmse = 0.138391
Validation r2 = 0.832192
Epoch 43
Loss = 9.1019e-02, PNorm = 35.5064, GNorm = 0.6781, lr_0 = 1.7433e-04
Loss = 1.0491e-01, PNorm = 35.5127, GNorm = 2.0155, lr_0 = 1.7031e-04
Loss = 2.4462e-01, PNorm = 35.5137, GNorm = 3.8392, lr_0 = 1.6991e-04
Validation rmse = 0.129832
Validation r2 = 0.852307
Epoch 44
Loss = 1.0614e-01, PNorm = 35.5189, GNorm = 1.7656, lr_0 = 1.6599e-04
Validation rmse = 0.137742
Validation r2 = 0.833763
Epoch 45
Loss = 1.0555e-01, PNorm = 35.5254, GNorm = 3.4527, lr_0 = 1.6178e-04
Loss = 1.0599e-01, PNorm = 35.5305, GNorm = 3.4067, lr_0 = 1.5805e-04
Validation rmse = 0.145262
Validation r2 = 0.815116
Epoch 46
Loss = 1.0563e-01, PNorm = 35.5376, GNorm = 3.3637, lr_0 = 1.5404e-04
Loss = 1.0547e-01, PNorm = 35.5424, GNorm = 1.3847, lr_0 = 1.5048e-04
Validation rmse = 0.136016
Validation r2 = 0.837902
Epoch 47
Loss = 1.0535e-01, PNorm = 35.5482, GNorm = 1.3666, lr_0 = 1.4701e-04
Validation rmse = 0.141268
Validation r2 = 0.825143
Epoch 48
Loss = 7.6201e-02, PNorm = 35.5543, GNorm = 0.8973, lr_0 = 1.4328e-04
Loss = 1.1006e-01, PNorm = 35.5587, GNorm = 2.7283, lr_0 = 1.3997e-04
Validation rmse = 0.128715
Validation r2 = 0.854837
Epoch 49
Loss = 9.7440e-02, PNorm = 35.5627, GNorm = 1.1728, lr_0 = 1.3642e-04
Loss = 1.0647e-01, PNorm = 35.5676, GNorm = 1.3285, lr_0 = 1.3327e-04
Validation rmse = 0.138640
Validation r2 = 0.831587
Epoch 50
Loss = 9.5655e-02, PNorm = 35.5707, GNorm = 0.5938, lr_0 = 1.3020e-04
Loss = 9.9731e-02, PNorm = 35.5738, GNorm = 1.1270, lr_0 = 1.2719e-04
Validation rmse = 0.145890
Validation r2 = 0.813514
Epoch 51
Loss = 1.1488e-01, PNorm = 35.5791, GNorm = 1.7371, lr_0 = 1.2397e-04
Validation rmse = 0.137901
Validation r2 = 0.833378
Epoch 52
Loss = 1.3953e-01, PNorm = 35.5832, GNorm = 1.8545, lr_0 = 1.2082e-04
Loss = 8.5016e-02, PNorm = 35.5869, GNorm = 0.6980, lr_0 = 1.1803e-04
Validation rmse = 0.129307
Validation r2 = 0.853500
Epoch 53
Loss = 1.0222e-01, PNorm = 35.5908, GNorm = 0.7599, lr_0 = 1.1504e-04
Loss = 1.0419e-01, PNorm = 35.5961, GNorm = 1.7200, lr_0 = 1.1239e-04
Validation rmse = 0.136404
Validation r2 = 0.836976
Epoch 54
Loss = 1.0202e-01, PNorm = 35.5978, GNorm = 1.5604, lr_0 = 1.0979e-04
Loss = 9.0775e-02, PNorm = 35.6010, GNorm = 0.5564, lr_0 = 1.0726e-04
Loss = 6.1930e-02, PNorm = 35.6010, GNorm = 1.0463, lr_0 = 1.0701e-04
Validation rmse = 0.138180
Validation r2 = 0.832704
Epoch 55
Loss = 8.8854e-02, PNorm = 35.6045, GNorm = 0.9374, lr_0 = 1.0454e-04
Validation rmse = 0.135710
Validation r2 = 0.838631
Epoch 56
Loss = 9.2245e-02, PNorm = 35.6079, GNorm = 1.3771, lr_0 = 1.0189e-04
Loss = 9.4373e-02, PNorm = 35.6114, GNorm = 2.3224, lr_0 = 1.0000e-04
Validation rmse = 0.132628
Validation r2 = 0.845877
Epoch 57
Loss = 9.2514e-02, PNorm = 35.6145, GNorm = 1.0501, lr_0 = 1.0000e-04
Loss = 9.3822e-02, PNorm = 35.6173, GNorm = 0.6889, lr_0 = 1.0000e-04
Validation rmse = 0.137367
Validation r2 = 0.834667
Epoch 58
Loss = 9.3873e-02, PNorm = 35.6211, GNorm = 0.5671, lr_0 = 1.0000e-04
Validation rmse = 0.137408
Validation r2 = 0.834568
Epoch 59
Loss = 8.1547e-02, PNorm = 35.6244, GNorm = 1.0759, lr_0 = 1.0000e-04
Loss = 9.6761e-02, PNorm = 35.6281, GNorm = 1.5603, lr_0 = 1.0000e-04
Validation rmse = 0.132587
Validation r2 = 0.845972
Model 0 best validation rmse = 0.128715 on epoch 48
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.133221
Model 0 test r2 = 0.868221
Ensemble test rmse = 0.133221
Ensemble test r2 = 0.868221
1-fold cross validation
	Seed 0 ==> test rmse = 0.133221
	Seed 0 ==> test r2 = 0.868221
Overall test rmse = 0.133221 +/- 0.000000
Overall test r2 = 0.868221 +/- 0.000000
Elapsed time = 0:00:39
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/bin/chemprop_train --data_path ./data/train_dm300_reduced_meoh_z.csv --dataset_type regression --save_dir ./data/train_results/removal/ --quiet --metric rmse --smiles_columns full_smiles --target_columns z_dm300 --epochs 60 --extra_metrics r2
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/train_dm300_reduced_meoh_z.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['z_dm300'],
 'task_names': ['z_dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,081 | train size = 864 | val size = 108 | test size = 109
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.0025e+00, PNorm = 34.0165, GNorm = 1.9060, lr_0 = 3.9118e-04
Validation rmse = 0.793462
Validation r2 = 0.298722
Epoch 1
Loss = 7.5041e-01, PNorm = 34.0408, GNorm = 7.7764, lr_0 = 6.8235e-04
Loss = 6.4612e-01, PNorm = 34.0871, GNorm = 12.1670, lr_0 = 9.4706e-04
Validation rmse = 0.628099
Validation r2 = 0.560565
Epoch 2
Loss = 4.7619e-01, PNorm = 34.1634, GNorm = 0.9118, lr_0 = 9.7920e-04
Loss = 4.5585e-01, PNorm = 34.2325, GNorm = 7.3958, lr_0 = 9.5660e-04
Validation rmse = 0.557818
Validation r2 = 0.653404
Epoch 3
Loss = 4.1655e-01, PNorm = 34.3045, GNorm = 6.1577, lr_0 = 9.3234e-04
Validation rmse = 0.464012
Validation r2 = 0.760173
Epoch 4
Loss = 3.5179e-01, PNorm = 34.3668, GNorm = 1.0128, lr_0 = 9.1082e-04
Loss = 3.4178e-01, PNorm = 34.4197, GNorm = 6.3873, lr_0 = 8.8980e-04
Validation rmse = 0.449063
Validation r2 = 0.775378
Epoch 5
Loss = 3.2700e-01, PNorm = 34.4741, GNorm = 5.8040, lr_0 = 8.6723e-04
Loss = 2.9222e-01, PNorm = 34.5333, GNorm = 2.6914, lr_0 = 8.4721e-04
Validation rmse = 0.522141
Validation r2 = 0.696321
Epoch 6
Loss = 2.5662e-01, PNorm = 34.5768, GNorm = 1.2523, lr_0 = 8.2573e-04
Loss = 2.4949e-01, PNorm = 34.6151, GNorm = 1.9826, lr_0 = 8.0667e-04
Loss = 1.8236e-01, PNorm = 34.6188, GNorm = 0.9081, lr_0 = 8.0478e-04
Validation rmse = 0.419267
Validation r2 = 0.804197
Epoch 7
Loss = 2.5788e-01, PNorm = 34.6495, GNorm = 2.9084, lr_0 = 7.8621e-04
Validation rmse = 0.431043
Validation r2 = 0.793043
Epoch 8
Loss = 1.7684e-01, PNorm = 34.6898, GNorm = 1.1989, lr_0 = 7.6806e-04
Loss = 2.2559e-01, PNorm = 34.7329, GNorm = 4.5329, lr_0 = 7.5033e-04
Validation rmse = 0.365484
Validation r2 = 0.851209
Epoch 9
Loss = 1.8282e-01, PNorm = 34.7621, GNorm = 3.2944, lr_0 = 7.3130e-04
Loss = 1.9910e-01, PNorm = 34.7910, GNorm = 0.8757, lr_0 = 7.1442e-04
Validation rmse = 0.443698
Validation r2 = 0.780713
Epoch 10
Loss = 1.5638e-01, PNorm = 34.8215, GNorm = 3.7780, lr_0 = 6.9630e-04
Loss = 1.9553e-01, PNorm = 34.8526, GNorm = 3.5239, lr_0 = 6.8023e-04
Validation rmse = 0.431197
Validation r2 = 0.792896
Epoch 11
Loss = 1.7162e-01, PNorm = 34.8796, GNorm = 1.2174, lr_0 = 6.6453e-04
Validation rmse = 0.378306
Validation r2 = 0.840587
Epoch 12
Loss = 1.7065e-01, PNorm = 34.9116, GNorm = 0.8200, lr_0 = 6.4768e-04
Loss = 1.5459e-01, PNorm = 34.9346, GNorm = 4.9638, lr_0 = 6.3273e-04
Validation rmse = 0.363069
Validation r2 = 0.853169
Epoch 13
Loss = 1.5153e-01, PNorm = 34.9570, GNorm = 1.6026, lr_0 = 6.1668e-04
Loss = 1.3855e-01, PNorm = 34.9759, GNorm = 1.6460, lr_0 = 6.0245e-04
Validation rmse = 0.412866
Validation r2 = 0.810130
Epoch 14
Loss = 1.3141e-01, PNorm = 34.9905, GNorm = 1.5763, lr_0 = 5.8717e-04
Validation rmse = 0.404978
Validation r2 = 0.817316
Epoch 15
Loss = 1.6979e-01, PNorm = 35.0105, GNorm = 0.9016, lr_0 = 5.7362e-04
Loss = 1.3327e-01, PNorm = 35.0312, GNorm = 1.1183, lr_0 = 5.6037e-04
Validation rmse = 0.377264
Validation r2 = 0.841464
Epoch 16
Loss = 1.2764e-01, PNorm = 35.0526, GNorm = 1.0954, lr_0 = 5.4616e-04
Loss = 1.5066e-01, PNorm = 35.0722, GNorm = 0.8901, lr_0 = 5.3356e-04
Validation rmse = 0.404549
Validation r2 = 0.817703
Epoch 17
Loss = 1.1926e-01, PNorm = 35.0847, GNorm = 1.0455, lr_0 = 5.2003e-04
Loss = 1.5215e-01, PNorm = 35.0998, GNorm = 2.7141, lr_0 = 5.0802e-04
Validation rmse = 0.390687
Validation r2 = 0.829982
Epoch 18
Loss = 1.3716e-01, PNorm = 35.1172, GNorm = 4.4388, lr_0 = 4.9630e-04
Validation rmse = 0.374664
Validation r2 = 0.843641
Epoch 19
Loss = 1.1752e-01, PNorm = 35.1307, GNorm = 2.7858, lr_0 = 4.8371e-04
Loss = 1.2706e-01, PNorm = 35.1432, GNorm = 1.2126, lr_0 = 4.7254e-04
Validation rmse = 0.378685
Validation r2 = 0.840268
Epoch 20
Loss = 1.2266e-01, PNorm = 35.1626, GNorm = 0.8472, lr_0 = 4.6056e-04
Loss = 1.3957e-01, PNorm = 35.1775, GNorm = 2.1375, lr_0 = 4.4993e-04
Validation rmse = 0.391111
Validation r2 = 0.829612
Epoch 21
Loss = 1.3639e-01, PNorm = 35.1943, GNorm = 1.3417, lr_0 = 4.3852e-04
Loss = 1.0273e-01, PNorm = 35.2062, GNorm = 1.6741, lr_0 = 4.2840e-04
Validation rmse = 0.372570
Validation r2 = 0.845384
Epoch 22
Loss = 1.1992e-01, PNorm = 35.2176, GNorm = 1.9237, lr_0 = 4.1851e-04
Validation rmse = 0.445580
Validation r2 = 0.778849
Epoch 23
Loss = 1.4456e-01, PNorm = 35.2330, GNorm = 0.7009, lr_0 = 4.0789e-04
Loss = 1.2905e-01, PNorm = 35.2460, GNorm = 0.8719, lr_0 = 3.9848e-04
Validation rmse = 0.397445
Validation r2 = 0.824049
Epoch 24
Loss = 1.1237e-01, PNorm = 35.2569, GNorm = 1.7484, lr_0 = 3.8837e-04
Loss = 1.2831e-01, PNorm = 35.2679, GNorm = 2.8714, lr_0 = 3.7941e-04
Validation rmse = 0.485486
Validation r2 = 0.737462
Epoch 25
Loss = 1.2892e-01, PNorm = 35.2819, GNorm = 0.9616, lr_0 = 3.7065e-04
Validation rmse = 0.389534
Validation r2 = 0.830983
Epoch 26
Loss = 7.2474e-02, PNorm = 35.2940, GNorm = 1.6734, lr_0 = 3.6125e-04
Loss = 1.2822e-01, PNorm = 35.3070, GNorm = 2.4957, lr_0 = 3.5291e-04
Validation rmse = 0.418814
Validation r2 = 0.804620
Epoch 27
Loss = 1.6162e-01, PNorm = 35.3194, GNorm = 5.0545, lr_0 = 3.4396e-04
Loss = 1.5780e-01, PNorm = 35.3346, GNorm = 3.5462, lr_0 = 3.3602e-04
Validation rmse = 0.383209
Validation r2 = 0.836428
Epoch 28
Loss = 1.1005e-01, PNorm = 35.3479, GNorm = 2.0165, lr_0 = 3.2750e-04
Loss = 1.3038e-01, PNorm = 35.3600, GNorm = 1.1976, lr_0 = 3.1994e-04
Validation rmse = 0.385379
Validation r2 = 0.834570
Epoch 29
Loss = 9.2837e-02, PNorm = 35.3710, GNorm = 0.6162, lr_0 = 3.1256e-04
Validation rmse = 0.372691
Validation r2 = 0.845284
Epoch 30
Loss = 6.0063e-02, PNorm = 35.3809, GNorm = 1.2671, lr_0 = 3.0463e-04
Loss = 1.1663e-01, PNorm = 35.3892, GNorm = 1.4631, lr_0 = 2.9760e-04
Validation rmse = 0.420905
Validation r2 = 0.802664
Epoch 31
Loss = 1.0217e-01, PNorm = 35.3991, GNorm = 1.0415, lr_0 = 2.9005e-04
Loss = 1.0561e-01, PNorm = 35.4073, GNorm = 2.7809, lr_0 = 2.8336e-04
Validation rmse = 0.439512
Validation r2 = 0.784831
Epoch 32
Loss = 1.2562e-01, PNorm = 35.4196, GNorm = 2.0312, lr_0 = 2.7617e-04
Loss = 1.0414e-01, PNorm = 35.4282, GNorm = 2.2438, lr_0 = 2.6980e-04
Validation rmse = 0.364039
Validation r2 = 0.852384
Epoch 33
Loss = 1.1021e-01, PNorm = 35.4363, GNorm = 1.3267, lr_0 = 2.6357e-04
Validation rmse = 0.389716
Validation r2 = 0.830826
Epoch 34
Loss = 1.2273e-01, PNorm = 35.4444, GNorm = 1.1162, lr_0 = 2.5688e-04
Loss = 1.0235e-01, PNorm = 35.4528, GNorm = 0.7867, lr_0 = 2.5095e-04
Validation rmse = 0.381164
Validation r2 = 0.838169
Epoch 35
Loss = 1.1427e-01, PNorm = 35.4593, GNorm = 0.7755, lr_0 = 2.4459e-04
Loss = 9.2246e-02, PNorm = 35.4654, GNorm = 1.0544, lr_0 = 2.3894e-04
Validation rmse = 0.423557
Validation r2 = 0.800170
Epoch 36
Loss = 1.3389e-01, PNorm = 35.4741, GNorm = 3.5567, lr_0 = 2.3343e-04
Validation rmse = 0.365209
Validation r2 = 0.851434
Epoch 37
Loss = 1.5827e-01, PNorm = 35.4824, GNorm = 2.3493, lr_0 = 2.2751e-04
Loss = 1.1741e-01, PNorm = 35.4928, GNorm = 0.8302, lr_0 = 2.2226e-04
Validation rmse = 0.419781
Validation r2 = 0.803717
Epoch 38
Loss = 9.6288e-02, PNorm = 35.5024, GNorm = 2.0041, lr_0 = 2.1662e-04
Loss = 1.1135e-01, PNorm = 35.5075, GNorm = 1.5603, lr_0 = 2.1162e-04
Validation rmse = 0.360055
Validation r2 = 0.855597
Epoch 39
Loss = 1.1347e-01, PNorm = 35.5178, GNorm = 1.7423, lr_0 = 2.0625e-04
Loss = 9.9756e-02, PNorm = 35.5235, GNorm = 1.2545, lr_0 = 2.0149e-04
Validation rmse = 0.365707
Validation r2 = 0.851028
Epoch 40
Loss = 9.5342e-02, PNorm = 35.5283, GNorm = 1.2631, lr_0 = 1.9684e-04
Validation rmse = 0.403688
Validation r2 = 0.818478
Epoch 41
Loss = 8.9963e-02, PNorm = 35.5344, GNorm = 0.7924, lr_0 = 1.9185e-04
Loss = 1.0740e-01, PNorm = 35.5398, GNorm = 1.9514, lr_0 = 1.8742e-04
Validation rmse = 0.383082
Validation r2 = 0.836536
Epoch 42
Loss = 8.1669e-02, PNorm = 35.5457, GNorm = 0.7890, lr_0 = 1.8267e-04
Loss = 1.0217e-01, PNorm = 35.5504, GNorm = 0.5868, lr_0 = 1.7845e-04
Validation rmse = 0.385889
Validation r2 = 0.834132
Epoch 43
Loss = 9.1484e-02, PNorm = 35.5578, GNorm = 0.7463, lr_0 = 1.7433e-04
Loss = 1.0420e-01, PNorm = 35.5644, GNorm = 1.9854, lr_0 = 1.7031e-04
Loss = 2.3974e-01, PNorm = 35.5655, GNorm = 3.7027, lr_0 = 1.6991e-04
Validation rmse = 0.365023
Validation r2 = 0.851584
Epoch 44
Loss = 1.0318e-01, PNorm = 35.5710, GNorm = 1.4827, lr_0 = 1.6599e-04
Validation rmse = 0.381631
Validation r2 = 0.837772
Epoch 45
Loss = 1.0016e-01, PNorm = 35.5776, GNorm = 2.9652, lr_0 = 1.6178e-04
Loss = 1.0365e-01, PNorm = 35.5832, GNorm = 3.4769, lr_0 = 1.5805e-04
Validation rmse = 0.407536
Validation r2 = 0.815001
Epoch 46
Loss = 1.0480e-01, PNorm = 35.5906, GNorm = 3.2459, lr_0 = 1.5404e-04
Loss = 1.0442e-01, PNorm = 35.5958, GNorm = 1.3795, lr_0 = 1.5048e-04
Validation rmse = 0.379413
Validation r2 = 0.839652
Epoch 47
Loss = 1.0440e-01, PNorm = 35.6017, GNorm = 1.3645, lr_0 = 1.4701e-04
Validation rmse = 0.394979
Validation r2 = 0.826225
Epoch 48
Loss = 7.3687e-02, PNorm = 35.6080, GNorm = 0.8537, lr_0 = 1.4328e-04
Loss = 1.0909e-01, PNorm = 35.6128, GNorm = 2.4843, lr_0 = 1.3997e-04
Validation rmse = 0.359545
Validation r2 = 0.856006
Epoch 49
Loss = 9.7221e-02, PNorm = 35.6173, GNorm = 1.0207, lr_0 = 1.3642e-04
Loss = 1.0593e-01, PNorm = 35.6227, GNorm = 1.2153, lr_0 = 1.3327e-04
Validation rmse = 0.387404
Validation r2 = 0.832827
Epoch 50
Loss = 9.5008e-02, PNorm = 35.6261, GNorm = 0.5847, lr_0 = 1.3020e-04
Loss = 9.9909e-02, PNorm = 35.6295, GNorm = 1.1695, lr_0 = 1.2719e-04
Validation rmse = 0.409767
Validation r2 = 0.812970
Epoch 51
Loss = 1.1421e-01, PNorm = 35.6355, GNorm = 1.7466, lr_0 = 1.2397e-04
Validation rmse = 0.387428
Validation r2 = 0.832806
Epoch 52
Loss = 1.3970e-01, PNorm = 35.6396, GNorm = 1.8238, lr_0 = 1.2082e-04
Loss = 8.4315e-02, PNorm = 35.6437, GNorm = 0.6571, lr_0 = 1.1803e-04
Validation rmse = 0.361495
Validation r2 = 0.854440
Epoch 53
Loss = 1.0117e-01, PNorm = 35.6480, GNorm = 0.7743, lr_0 = 1.1504e-04
Loss = 1.0366e-01, PNorm = 35.6536, GNorm = 1.7920, lr_0 = 1.1239e-04
Validation rmse = 0.381350
Validation r2 = 0.838011
Epoch 54
Loss = 1.0193e-01, PNorm = 35.6556, GNorm = 1.5992, lr_0 = 1.0979e-04
Loss = 9.0405e-02, PNorm = 35.6591, GNorm = 0.5637, lr_0 = 1.0726e-04
Loss = 6.3416e-02, PNorm = 35.6591, GNorm = 0.9792, lr_0 = 1.0701e-04
Validation rmse = 0.385678
Validation r2 = 0.834313
Epoch 55
Loss = 8.8097e-02, PNorm = 35.6629, GNorm = 0.9592, lr_0 = 1.0454e-04
Validation rmse = 0.380312
Validation r2 = 0.838892
Epoch 56
Loss = 9.1100e-02, PNorm = 35.6664, GNorm = 1.2189, lr_0 = 1.0189e-04
Loss = 9.4043e-02, PNorm = 35.6700, GNorm = 2.2378, lr_0 = 1.0000e-04
Validation rmse = 0.372010
Validation r2 = 0.845849
Epoch 57
Loss = 9.2077e-02, PNorm = 35.6735, GNorm = 1.0655, lr_0 = 1.0000e-04
Loss = 9.2698e-02, PNorm = 35.6767, GNorm = 0.6560, lr_0 = 1.0000e-04
Validation rmse = 0.382250
Validation r2 = 0.837245
Epoch 58
Loss = 9.3199e-02, PNorm = 35.6808, GNorm = 0.5971, lr_0 = 1.0000e-04
Validation rmse = 0.385635
Validation r2 = 0.834350
Epoch 59
Loss = 8.1780e-02, PNorm = 35.6844, GNorm = 1.1237, lr_0 = 1.0000e-04
Loss = 9.6578e-02, PNorm = 35.6883, GNorm = 1.4958, lr_0 = 1.0000e-04
Validation rmse = 0.370673
Validation r2 = 0.846955
Model 0 best validation rmse = 0.359545 on epoch 48
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.373741
Model 0 test r2 = 0.868149
Ensemble test rmse = 0.373741
Ensemble test r2 = 0.868149
1-fold cross validation
	Seed 0 ==> test rmse = 0.373741
	Seed 0 ==> test r2 = 0.868149
Overall test rmse = 0.373741 +/- 0.000000
Overall test r2 = 0.868149 +/- 0.000000
Elapsed time = 0:00:37
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/bin/chemprop_train --data_path ./data/train_dm300_reduced_meoh.csv --dataset_type regression --save_dir ./data/train_results/removal/ --quiet --metric rmse --smiles_columns full_smiles --target_columns dm300 --epochs 60 --extra_metrics r2
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/train_dm300_reduced_meoh.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': ['r2'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.8, 0.1, 0.1),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,081 | train size = 864 | val size = 108 | test size = 109
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 1.0025e+00, PNorm = 34.0165, GNorm = 1.9060, lr_0 = 3.9118e-04
Validation rmse = 0.282909
Validation r2 = 0.298722
Epoch 1
Loss = 7.5041e-01, PNorm = 34.0408, GNorm = 7.7764, lr_0 = 6.8235e-04
Loss = 6.4612e-01, PNorm = 34.0871, GNorm = 12.1670, lr_0 = 9.4706e-04
Validation rmse = 0.223949
Validation r2 = 0.560565
Epoch 2
Loss = 4.7623e-01, PNorm = 34.1634, GNorm = 0.9150, lr_0 = 9.7920e-04
Loss = 4.5796e-01, PNorm = 34.2322, GNorm = 7.5490, lr_0 = 9.5660e-04
Validation rmse = 0.199466
Validation r2 = 0.651395
Epoch 3
Loss = 4.1485e-01, PNorm = 34.3033, GNorm = 5.8427, lr_0 = 9.3234e-04
Validation rmse = 0.163954
Validation r2 = 0.764472
Epoch 4
Loss = 3.5407e-01, PNorm = 34.3662, GNorm = 1.3710, lr_0 = 9.1082e-04
Loss = 3.2509e-01, PNorm = 34.4199, GNorm = 5.0119, lr_0 = 8.8980e-04
Validation rmse = 0.155457
Validation r2 = 0.788254
Epoch 5
Loss = 2.9302e-01, PNorm = 34.4762, GNorm = 4.1223, lr_0 = 8.6723e-04
Loss = 2.6540e-01, PNorm = 34.5342, GNorm = 6.0018, lr_0 = 8.4721e-04
Validation rmse = 0.166073
Validation r2 = 0.758347
Epoch 6
Loss = 2.3181e-01, PNorm = 34.5793, GNorm = 2.4326, lr_0 = 8.2573e-04
Loss = 2.2003e-01, PNorm = 34.6185, GNorm = 2.8319, lr_0 = 8.0667e-04
Loss = 1.8287e-01, PNorm = 34.6212, GNorm = 1.5123, lr_0 = 8.0478e-04
Validation rmse = 0.171880
Validation r2 = 0.741152
Epoch 7
Loss = 2.5664e-01, PNorm = 34.6493, GNorm = 1.1001, lr_0 = 7.8621e-04
Validation rmse = 0.181250
Validation r2 = 0.712161
Epoch 8
Loss = 1.9587e-01, PNorm = 34.6891, GNorm = 1.2340, lr_0 = 7.6806e-04
Loss = 2.3480e-01, PNorm = 34.7318, GNorm = 6.7171, lr_0 = 7.5033e-04
Validation rmse = 0.140198
Validation r2 = 0.827781
Epoch 9
Loss = 2.0784e-01, PNorm = 34.7575, GNorm = 4.9010, lr_0 = 7.3130e-04
Loss = 2.0897e-01, PNorm = 34.7879, GNorm = 1.1820, lr_0 = 7.1442e-04
Validation rmse = 0.169463
Validation r2 = 0.748380
Epoch 10
Loss = 1.6988e-01, PNorm = 34.8156, GNorm = 3.9387, lr_0 = 6.9630e-04
Loss = 1.9744e-01, PNorm = 34.8466, GNorm = 2.7545, lr_0 = 6.8023e-04
Validation rmse = 0.152133
Validation r2 = 0.797212
Epoch 11
Loss = 1.6948e-01, PNorm = 34.8706, GNorm = 1.7552, lr_0 = 6.6453e-04
Validation rmse = 0.134601
Validation r2 = 0.841258
Epoch 12
Loss = 1.7009e-01, PNorm = 34.8982, GNorm = 0.7989, lr_0 = 6.4768e-04
Loss = 1.5229e-01, PNorm = 34.9196, GNorm = 4.6830, lr_0 = 6.3273e-04
Validation rmse = 0.130437
Validation r2 = 0.850927
Epoch 13
Loss = 1.4936e-01, PNorm = 34.9392, GNorm = 1.4055, lr_0 = 6.1668e-04
Loss = 1.3806e-01, PNorm = 34.9565, GNorm = 1.4229, lr_0 = 6.0245e-04
Validation rmse = 0.146387
Validation r2 = 0.812241
Epoch 14
Loss = 1.3056e-01, PNorm = 34.9705, GNorm = 1.5780, lr_0 = 5.8717e-04
Validation rmse = 0.140660
Validation r2 = 0.826645
Epoch 15
Loss = 1.7087e-01, PNorm = 34.9889, GNorm = 1.2716, lr_0 = 5.7362e-04
Loss = 1.3430e-01, PNorm = 35.0073, GNorm = 1.1464, lr_0 = 5.6037e-04
Validation rmse = 0.134444
Validation r2 = 0.841627
Epoch 16
Loss = 1.2572e-01, PNorm = 35.0269, GNorm = 0.9116, lr_0 = 5.4616e-04
Loss = 1.5008e-01, PNorm = 35.0448, GNorm = 0.8820, lr_0 = 5.3356e-04
Validation rmse = 0.144556
Validation r2 = 0.816908
Epoch 17
Loss = 1.1620e-01, PNorm = 35.0568, GNorm = 1.2946, lr_0 = 5.2003e-04
Loss = 1.5161e-01, PNorm = 35.0701, GNorm = 2.6325, lr_0 = 5.0802e-04
Validation rmse = 0.143680
Validation r2 = 0.819120
Epoch 18
Loss = 1.3909e-01, PNorm = 35.0862, GNorm = 4.9022, lr_0 = 4.9630e-04
Validation rmse = 0.133655
Validation r2 = 0.843481
Epoch 19
Loss = 1.2289e-01, PNorm = 35.0984, GNorm = 3.2255, lr_0 = 4.8371e-04
Loss = 1.2989e-01, PNorm = 35.1106, GNorm = 1.0759, lr_0 = 4.7254e-04
Validation rmse = 0.136040
Validation r2 = 0.837844
Epoch 20
Loss = 1.2571e-01, PNorm = 35.1293, GNorm = 0.8776, lr_0 = 4.6056e-04
Loss = 1.4166e-01, PNorm = 35.1432, GNorm = 2.3507, lr_0 = 4.4993e-04
Validation rmse = 0.140960
Validation r2 = 0.825904
Epoch 21
Loss = 1.3588e-01, PNorm = 35.1589, GNorm = 1.2665, lr_0 = 4.3852e-04
Loss = 1.0279e-01, PNorm = 35.1700, GNorm = 1.6642, lr_0 = 4.2840e-04
Validation rmse = 0.133264
Validation r2 = 0.844397
Epoch 22
Loss = 1.1891e-01, PNorm = 35.1801, GNorm = 1.8122, lr_0 = 4.1851e-04
Validation rmse = 0.158657
Validation r2 = 0.779447
Epoch 23
Loss = 1.4335e-01, PNorm = 35.1940, GNorm = 0.7354, lr_0 = 4.0789e-04
Loss = 1.2868e-01, PNorm = 35.2049, GNorm = 0.8744, lr_0 = 3.9848e-04
Validation rmse = 0.141301
Validation r2 = 0.825062
Epoch 24
Loss = 1.1459e-01, PNorm = 35.2144, GNorm = 1.4150, lr_0 = 3.8837e-04
Loss = 1.2577e-01, PNorm = 35.2240, GNorm = 2.6215, lr_0 = 3.7941e-04
Validation rmse = 0.171185
Validation r2 = 0.743241
Epoch 25
Loss = 1.2567e-01, PNorm = 35.2368, GNorm = 1.0039, lr_0 = 3.7065e-04
Validation rmse = 0.142546
Validation r2 = 0.821964
Epoch 26
Loss = 7.1710e-02, PNorm = 35.2479, GNorm = 1.9089, lr_0 = 3.6125e-04
Loss = 1.2569e-01, PNorm = 35.2604, GNorm = 3.0672, lr_0 = 3.5291e-04
Validation rmse = 0.157974
Validation r2 = 0.781342
Epoch 27
Loss = 1.6134e-01, PNorm = 35.2710, GNorm = 4.3447, lr_0 = 3.4396e-04
Loss = 1.5772e-01, PNorm = 35.2849, GNorm = 3.3142, lr_0 = 3.3602e-04
Validation rmse = 0.136980
Validation r2 = 0.835598
Epoch 28
Loss = 1.1088e-01, PNorm = 35.2960, GNorm = 1.5031, lr_0 = 3.2750e-04
Loss = 1.3575e-01, PNorm = 35.3066, GNorm = 1.3412, lr_0 = 3.1994e-04
Validation rmse = 0.135690
Validation r2 = 0.838678
Epoch 29
Loss = 9.4011e-02, PNorm = 35.3159, GNorm = 0.5627, lr_0 = 3.1256e-04
Validation rmse = 0.133171
Validation r2 = 0.844612
Epoch 30
Loss = 6.0156e-02, PNorm = 35.3244, GNorm = 1.1258, lr_0 = 3.0463e-04
Loss = 1.1677e-01, PNorm = 35.3315, GNorm = 1.3479, lr_0 = 2.9760e-04
Validation rmse = 0.151763
Validation r2 = 0.798197
Epoch 31
Loss = 1.0320e-01, PNorm = 35.3403, GNorm = 1.1485, lr_0 = 2.9005e-04
Loss = 1.0636e-01, PNorm = 35.3475, GNorm = 2.9855, lr_0 = 2.8336e-04
Validation rmse = 0.158020
Validation r2 = 0.781213
Epoch 32
Loss = 1.2669e-01, PNorm = 35.3589, GNorm = 2.0008, lr_0 = 2.7617e-04
Loss = 1.0456e-01, PNorm = 35.3667, GNorm = 2.3333, lr_0 = 2.6980e-04
Validation rmse = 0.130928
Validation r2 = 0.849802
Epoch 33
Loss = 1.0999e-01, PNorm = 35.3736, GNorm = 1.3389, lr_0 = 2.6357e-04
Validation rmse = 0.139248
Validation r2 = 0.830108
Epoch 34
Loss = 1.2288e-01, PNorm = 35.3809, GNorm = 1.1415, lr_0 = 2.5688e-04
Loss = 1.0260e-01, PNorm = 35.3876, GNorm = 0.7401, lr_0 = 2.5095e-04
Validation rmse = 0.136054
Validation r2 = 0.837812
Epoch 35
Loss = 1.1418e-01, PNorm = 35.3933, GNorm = 0.7633, lr_0 = 2.4459e-04
Loss = 9.2097e-02, PNorm = 35.3982, GNorm = 1.1517, lr_0 = 2.3894e-04
Validation rmse = 0.152020
Validation r2 = 0.797513
Epoch 36
Loss = 1.3323e-01, PNorm = 35.4053, GNorm = 3.5898, lr_0 = 2.3343e-04
Validation rmse = 0.131570
Validation r2 = 0.848327
Epoch 37
Loss = 1.5632e-01, PNorm = 35.4125, GNorm = 2.3272, lr_0 = 2.2751e-04
Loss = 1.1808e-01, PNorm = 35.4213, GNorm = 0.9714, lr_0 = 2.2226e-04
Validation rmse = 0.148357
Validation r2 = 0.807152
Epoch 38
Loss = 9.7397e-02, PNorm = 35.4302, GNorm = 2.3774, lr_0 = 2.1662e-04
Loss = 1.1160e-01, PNorm = 35.4344, GNorm = 1.1746, lr_0 = 2.1162e-04
Validation rmse = 0.129714
Validation r2 = 0.852574
Epoch 39
Loss = 1.1176e-01, PNorm = 35.4442, GNorm = 1.6552, lr_0 = 2.0625e-04
Loss = 9.9482e-02, PNorm = 35.4492, GNorm = 1.2020, lr_0 = 2.0149e-04
Validation rmse = 0.130979
Validation r2 = 0.849687
Epoch 40
Loss = 9.5898e-02, PNorm = 35.4534, GNorm = 1.2097, lr_0 = 1.9684e-04
Validation rmse = 0.144354
Validation r2 = 0.817420
Epoch 41
Loss = 9.1136e-02, PNorm = 35.4591, GNorm = 0.8080, lr_0 = 1.9185e-04
Loss = 1.0712e-01, PNorm = 35.4637, GNorm = 1.9428, lr_0 = 1.8742e-04
Validation rmse = 0.137074
Validation r2 = 0.835370
Epoch 42
Loss = 8.1473e-02, PNorm = 35.4688, GNorm = 0.7902, lr_0 = 1.8267e-04
Loss = 1.0357e-01, PNorm = 35.4730, GNorm = 0.5951, lr_0 = 1.7845e-04
Validation rmse = 0.138360
Validation r2 = 0.832266
Epoch 43
Loss = 9.1224e-02, PNorm = 35.4798, GNorm = 0.6787, lr_0 = 1.7433e-04
Loss = 1.0467e-01, PNorm = 35.4856, GNorm = 1.9663, lr_0 = 1.7031e-04
Loss = 2.4822e-01, PNorm = 35.4865, GNorm = 3.7719, lr_0 = 1.6991e-04
Validation rmse = 0.129908
Validation r2 = 0.852134
Epoch 44
Loss = 1.0506e-01, PNorm = 35.4912, GNorm = 1.6586, lr_0 = 1.6599e-04
Validation rmse = 0.138641
Validation r2 = 0.831585
Epoch 45
Loss = 1.0511e-01, PNorm = 35.4970, GNorm = 3.3946, lr_0 = 1.6178e-04
Loss = 1.0526e-01, PNorm = 35.5015, GNorm = 3.2670, lr_0 = 1.5805e-04
Validation rmse = 0.144066
Validation r2 = 0.818149
Epoch 46
Loss = 1.0574e-01, PNorm = 35.5081, GNorm = 3.4047, lr_0 = 1.5404e-04
Loss = 1.0543e-01, PNorm = 35.5126, GNorm = 1.6455, lr_0 = 1.5048e-04
Validation rmse = 0.135793
Validation r2 = 0.838434
Epoch 47
Loss = 1.0617e-01, PNorm = 35.5180, GNorm = 1.3665, lr_0 = 1.4701e-04
Validation rmse = 0.141449
Validation r2 = 0.824694
Epoch 48
Loss = 7.6234e-02, PNorm = 35.5236, GNorm = 0.9529, lr_0 = 1.4328e-04
Loss = 1.1032e-01, PNorm = 35.5275, GNorm = 2.6889, lr_0 = 1.3997e-04
Validation rmse = 0.128569
Validation r2 = 0.855166
Epoch 49
Loss = 9.8086e-02, PNorm = 35.5313, GNorm = 1.0738, lr_0 = 1.3642e-04
Loss = 1.0680e-01, PNorm = 35.5362, GNorm = 1.3195, lr_0 = 1.3327e-04
Validation rmse = 0.138556
Validation r2 = 0.831793
Epoch 50
Loss = 9.5795e-02, PNorm = 35.5390, GNorm = 0.5696, lr_0 = 1.3020e-04
Loss = 1.0001e-01, PNorm = 35.5420, GNorm = 1.1810, lr_0 = 1.2719e-04
Validation rmse = 0.146338
Validation r2 = 0.812367
Epoch 51
Loss = 1.1515e-01, PNorm = 35.5470, GNorm = 1.7383, lr_0 = 1.2397e-04
Validation rmse = 0.138226
Validation r2 = 0.832592
Epoch 52
Loss = 1.3929e-01, PNorm = 35.5507, GNorm = 1.7213, lr_0 = 1.2082e-04
Loss = 8.5525e-02, PNorm = 35.5540, GNorm = 0.6306, lr_0 = 1.1803e-04
Validation rmse = 0.129360
Validation r2 = 0.853380
Epoch 53
Loss = 1.0191e-01, PNorm = 35.5576, GNorm = 0.7776, lr_0 = 1.1504e-04
Loss = 1.0454e-01, PNorm = 35.5626, GNorm = 1.7440, lr_0 = 1.1239e-04
Validation rmse = 0.136819
Validation r2 = 0.835984
Epoch 54
Loss = 1.0209e-01, PNorm = 35.5641, GNorm = 1.4938, lr_0 = 1.0979e-04
Loss = 9.1280e-02, PNorm = 35.5672, GNorm = 0.5767, lr_0 = 1.0726e-04
Loss = 6.2932e-02, PNorm = 35.5672, GNorm = 1.0114, lr_0 = 1.0701e-04
Validation rmse = 0.138736
Validation r2 = 0.831354
Epoch 55
Loss = 8.9168e-02, PNorm = 35.5704, GNorm = 0.8856, lr_0 = 1.0454e-04
Validation rmse = 0.135652
Validation r2 = 0.838768
Epoch 56
Loss = 9.2363e-02, PNorm = 35.5734, GNorm = 1.3883, lr_0 = 1.0189e-04
Loss = 9.4684e-02, PNorm = 35.5767, GNorm = 2.3072, lr_0 = 1.0000e-04
Validation rmse = 0.132800
Validation r2 = 0.845476
Epoch 57
Loss = 9.2666e-02, PNorm = 35.5794, GNorm = 1.0327, lr_0 = 1.0000e-04
Loss = 9.4195e-02, PNorm = 35.5819, GNorm = 0.6186, lr_0 = 1.0000e-04
Validation rmse = 0.137196
Validation r2 = 0.835077
Epoch 58
Loss = 9.4177e-02, PNorm = 35.5854, GNorm = 0.5489, lr_0 = 1.0000e-04
Validation rmse = 0.137939
Validation r2 = 0.833285
Epoch 59
Loss = 8.2812e-02, PNorm = 35.5885, GNorm = 1.0452, lr_0 = 1.0000e-04
Loss = 9.7204e-02, PNorm = 35.5919, GNorm = 1.6170, lr_0 = 1.0000e-04
Validation rmse = 0.133074
Validation r2 = 0.844839
Model 0 best validation rmse = 0.128569 on epoch 48
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.134078
Model 0 test r2 = 0.866519
Ensemble test rmse = 0.134078
Ensemble test r2 = 0.866519
1-fold cross validation
	Seed 0 ==> test rmse = 0.134078
	Seed 0 ==> test r2 = 0.866519
Overall test rmse = 0.134078 +/- 0.000000
Overall test r2 = 0.866519 +/- 0.000000
Elapsed time = 0:00:38
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-af88558e-fd54-4032-8f82-74be2f326bc6.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/_train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,120 | train size = 890 | val size = 224 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.7358e-01, PNorm = 34.0157, GNorm = 9.2237, lr_0 = 3.9118e-04
Validation rmse = 0.280660
Epoch 1
Loss = 6.6180e-01, PNorm = 34.0409, GNorm = 2.4649, lr_0 = 6.8235e-04
Loss = 6.7082e-01, PNorm = 34.0860, GNorm = 6.1692, lr_0 = 9.4706e-04
Validation rmse = 0.250069
Epoch 2
Loss = 5.4151e-01, PNorm = 34.1265, GNorm = 1.0382, lr_0 = 3.3839e-04
Loss = 5.6146e-01, PNorm = 34.1382, GNorm = 6.9395, lr_0 = 1.0000e-04
Validation rmse = 0.233144
Model 0 best validation rmse = 0.233144 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.253343
Ensemble test rmse = 0.253343
1-fold cross validation
	Seed 0 ==> test rmse = 0.253343
Overall test rmse = 0.253343 +/- 0.000000
Elapsed time = 0:00:03
Command line
python /Users/ignaczg/miniforge3_arm64/envs/chemprop/lib/python3.8/site-packages/ipykernel_launcher.py -f /Users/ignaczg/Library/Jupyter/runtime/kernel-af88558e-fd54-4032-8f82-74be2f326bc6.json
Args
{'activation': 'ReLU',
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': False,
 'data_path': './data/_train_dm300_full.csv',
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cpu'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'split_sizes': (0.795, 0.2, 0.005),
 'split_type': 'random',
 'target_columns': ['dm300'],
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,110 | train size = 882 | val size = 222 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 354,901
Epoch 0
Loss = 9.8806e-01, PNorm = 34.0130, GNorm = 6.3456, lr_0 = 3.9118e-04
Validation rmse = 0.302776
Epoch 1
Loss = 8.5303e-01, PNorm = 34.0314, GNorm = 1.7428, lr_0 = 6.8235e-04
Loss = 7.7435e-01, PNorm = 34.0760, GNorm = 6.8068, lr_0 = 9.4706e-04
Validation rmse = 0.266426
Epoch 2
Loss = 5.5242e-01, PNorm = 34.1194, GNorm = 7.4010, lr_0 = 3.3839e-04
Loss = 5.4614e-01, PNorm = 34.1288, GNorm = 2.7691, lr_0 = 1.0000e-04
Validation rmse = 0.237763
Model 0 best validation rmse = 0.237763 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Model 0 test rmse = 0.213104
Ensemble test rmse = 0.213104
1-fold cross validation
	Seed 0 ==> test rmse = 0.213104
Overall test rmse = 0.213104 +/- 0.000000
Elapsed time = 0:00:03
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,100 | train size = 874 | val size = 220 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.7050e-01, PNorm = 34.0150, GNorm = 6.4939, lr_0 = 3.9118e-04
Validation rmse = 0.320249
Epoch 1
Loss = 8.3051e-01, PNorm = 34.0333, GNorm = 3.1762, lr_0 = 6.8235e-04
Loss = 7.4981e-01, PNorm = 34.0680, GNorm = 3.2264, lr_0 = 9.4706e-04
Validation rmse = 0.257294
Epoch 2
Loss = 6.2996e-01, PNorm = 34.1198, GNorm = 1.0107, lr_0 = 2.9552e-04
Loss = 5.0715e-01, PNorm = 34.1336, GNorm = 2.5374, lr_0 = 1.0000e-04
Validation rmse = 0.236068
Model 0 best validation rmse = 0.236068 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.275837
Ensemble test rmse = 0.275837
1-fold cross validation
	Seed 0 ==> test rmse = 0.275837
Overall test rmse = 0.275837 +/- 0.000000
Elapsed time = 0:00:18
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 3,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,090 | train size = 866 | val size = 218 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 1.0085e+00, PNorm = 34.0140, GNorm = 5.8849, lr_0 = 3.9118e-04
Validation rmse = 0.295955
Epoch 1
Loss = 8.9379e-01, PNorm = 34.0317, GNorm = 3.5235, lr_0 = 6.8235e-04
Loss = 7.4978e-01, PNorm = 34.0758, GNorm = 7.0463, lr_0 = 9.4706e-04
Validation rmse = 0.243348
Epoch 2
Loss = 5.1262e-01, PNorm = 34.1181, GNorm = 1.4529, lr_0 = 2.9552e-04
Loss = 5.3575e-01, PNorm = 34.1310, GNorm = 2.0406, lr_0 = 1.0000e-04
Validation rmse = 0.233708
Model 0 best validation rmse = 0.233708 on epoch 2
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.270370
Ensemble test rmse = 0.270370
1-fold cross validation
	Seed 0 ==> test rmse = 0.270370
Overall test rmse = 0.270370 +/- 0.000000
Elapsed time = 0:00:02
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,167 | train size = 927 | val size = 234 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.9265e-01, PNorm = 34.0157, GNorm = 3.5732, lr_0 = 3.7500e-04
Validation rmse = 0.284287
Epoch 1
Loss = 6.9237e-01, PNorm = 34.0439, GNorm = 6.4419, lr_0 = 6.5000e-04
Loss = 7.6370e-01, PNorm = 34.0834, GNorm = 3.2127, lr_0 = 9.0000e-04
Validation rmse = 0.276076
Epoch 2
Loss = 6.7314e-01, PNorm = 34.1345, GNorm = 9.5480, lr_0 = 9.8685e-04
Loss = 6.1951e-01, PNorm = 34.1978, GNorm = 5.0209, lr_0 = 9.6533e-04
Validation rmse = 0.269459
Epoch 3
Loss = 5.1259e-01, PNorm = 34.2688, GNorm = 3.1730, lr_0 = 9.4219e-04
Loss = 4.2713e-01, PNorm = 34.3315, GNorm = 0.9495, lr_0 = 9.2164e-04
Validation rmse = 0.220252
Epoch 4
Loss = 4.3168e-01, PNorm = 34.3854, GNorm = 1.1895, lr_0 = 9.0153e-04
Loss = 3.3432e-01, PNorm = 34.4440, GNorm = 1.4405, lr_0 = 8.8187e-04
Validation rmse = 0.202246
Epoch 5
Loss = 3.1771e-01, PNorm = 34.5043, GNorm = 3.7437, lr_0 = 8.6073e-04
Loss = 2.7348e-01, PNorm = 34.5597, GNorm = 1.2422, lr_0 = 8.4195e-04
Validation rmse = 0.192759
Epoch 6
Loss = 3.0171e-01, PNorm = 34.5974, GNorm = 3.1940, lr_0 = 8.2359e-04
Validation rmse = 0.203950
Epoch 7
Loss = 2.3114e-01, PNorm = 34.6402, GNorm = 3.1854, lr_0 = 8.0385e-04
Loss = 2.9869e-01, PNorm = 34.6764, GNorm = 3.1500, lr_0 = 7.8631e-04
Validation rmse = 0.182153
Epoch 8
Loss = 2.3745e-01, PNorm = 34.7076, GNorm = 3.3473, lr_0 = 7.6916e-04
Loss = 2.3528e-01, PNorm = 34.7387, GNorm = 2.5176, lr_0 = 7.5238e-04
Validation rmse = 0.192723
Epoch 9
Loss = 2.9674e-01, PNorm = 34.7730, GNorm = 2.9750, lr_0 = 7.3435e-04
Loss = 2.0076e-01, PNorm = 34.8018, GNorm = 1.6889, lr_0 = 7.1833e-04
Validation rmse = 0.180295
Epoch 10
Loss = 2.4705e-01, PNorm = 34.8207, GNorm = 6.4111, lr_0 = 7.0266e-04
Loss = 1.9375e-01, PNorm = 34.8405, GNorm = 1.7200, lr_0 = 6.8733e-04
Validation rmse = 0.183608
Epoch 11
Loss = 2.0415e-01, PNorm = 34.8686, GNorm = 2.9754, lr_0 = 6.7085e-04
Loss = 2.1697e-01, PNorm = 34.8848, GNorm = 4.1613, lr_0 = 6.5622e-04
Validation rmse = 0.188509
Epoch 12
Loss = 2.2012e-01, PNorm = 34.8972, GNorm = 3.5552, lr_0 = 6.4191e-04
Loss = 2.2965e-01, PNorm = 34.9173, GNorm = 5.7362, lr_0 = 6.2790e-04
Validation rmse = 0.204483
Epoch 13
Loss = 2.8796e-01, PNorm = 34.9405, GNorm = 5.3188, lr_0 = 6.1421e-04
Validation rmse = 0.179039
Epoch 14
Loss = 1.4279e-01, PNorm = 34.9594, GNorm = 1.0837, lr_0 = 5.9948e-04
Loss = 2.2034e-01, PNorm = 34.9758, GNorm = 2.3080, lr_0 = 5.8641e-04
Validation rmse = 0.180362
Epoch 15
Loss = 2.2067e-01, PNorm = 34.9939, GNorm = 1.2055, lr_0 = 5.7362e-04
Loss = 1.8122e-01, PNorm = 35.0144, GNorm = 0.8529, lr_0 = 5.6110e-04
Validation rmse = 0.177991
Epoch 16
Loss = 2.1465e-01, PNorm = 35.0306, GNorm = 4.5794, lr_0 = 5.4765e-04
Loss = 1.9484e-01, PNorm = 35.0460, GNorm = 2.5516, lr_0 = 5.3571e-04
Validation rmse = 0.171141
Epoch 17
Loss = 1.8998e-01, PNorm = 35.0620, GNorm = 0.5859, lr_0 = 5.2402e-04
Loss = 1.9711e-01, PNorm = 35.0763, GNorm = 1.7564, lr_0 = 5.1259e-04
Validation rmse = 0.176026
Epoch 18
Loss = 2.1431e-01, PNorm = 35.0910, GNorm = 3.5714, lr_0 = 5.0030e-04
Loss = 1.7310e-01, PNorm = 35.1054, GNorm = 1.6203, lr_0 = 4.8939e-04
Validation rmse = 0.171705
Epoch 19
Loss = 1.9624e-01, PNorm = 35.1178, GNorm = 4.4561, lr_0 = 4.7871e-04
Loss = 1.9053e-01, PNorm = 35.1294, GNorm = 2.0023, lr_0 = 4.6827e-04
Loss = 1.5750e-01, PNorm = 35.1304, GNorm = 2.8476, lr_0 = 4.6724e-04
Validation rmse = 0.173443
Epoch 20
Loss = 2.0209e-01, PNorm = 35.1423, GNorm = 3.1221, lr_0 = 4.5705e-04
Validation rmse = 0.169778
Epoch 21
Loss = 1.4874e-01, PNorm = 35.1550, GNorm = 0.6877, lr_0 = 4.4708e-04
Loss = 1.8025e-01, PNorm = 35.1636, GNorm = 0.7994, lr_0 = 4.3733e-04
Validation rmse = 0.174322
Epoch 22
Loss = 2.2085e-01, PNorm = 35.1776, GNorm = 1.6449, lr_0 = 4.2684e-04
Loss = 1.6001e-01, PNorm = 35.1872, GNorm = 2.2993, lr_0 = 4.1753e-04
Validation rmse = 0.170730
Epoch 23
Loss = 1.5614e-01, PNorm = 35.2002, GNorm = 0.6445, lr_0 = 4.0842e-04
Loss = 1.7577e-01, PNorm = 35.2100, GNorm = 0.7523, lr_0 = 3.9951e-04
Validation rmse = 0.174579
Epoch 24
Loss = 1.7265e-01, PNorm = 35.2208, GNorm = 3.0519, lr_0 = 3.8994e-04
Loss = 1.7079e-01, PNorm = 35.2322, GNorm = 1.3363, lr_0 = 3.8143e-04
Validation rmse = 0.173018
Epoch 25
Loss = 2.0087e-01, PNorm = 35.2413, GNorm = 1.5169, lr_0 = 3.7311e-04
Loss = 1.5594e-01, PNorm = 35.2516, GNorm = 2.4765, lr_0 = 3.6497e-04
Validation rmse = 0.172438
Epoch 26
Loss = 2.1108e-01, PNorm = 35.2612, GNorm = 3.6538, lr_0 = 3.5701e-04
Loss = 1.5621e-01, PNorm = 35.2729, GNorm = 2.5607, lr_0 = 3.4922e-04
Loss = 1.3827e-01, PNorm = 35.2740, GNorm = 1.7851, lr_0 = 3.4845e-04
Validation rmse = 0.178137
Epoch 27
Loss = 1.7669e-01, PNorm = 35.2835, GNorm = 2.8596, lr_0 = 3.4085e-04
Validation rmse = 0.172509
Epoch 28
Loss = 1.9055e-01, PNorm = 35.2912, GNorm = 2.0076, lr_0 = 3.3342e-04
Loss = 1.6243e-01, PNorm = 35.2994, GNorm = 3.0402, lr_0 = 3.2614e-04
Validation rmse = 0.181458
Epoch 29
Loss = 1.7778e-01, PNorm = 35.3084, GNorm = 2.0128, lr_0 = 3.1833e-04
Loss = 1.7045e-01, PNorm = 35.3187, GNorm = 2.2724, lr_0 = 3.1138e-04
Validation rmse = 0.176708
Epoch 30
Loss = 1.5501e-01, PNorm = 35.3267, GNorm = 0.8777, lr_0 = 3.0459e-04
Loss = 1.8441e-01, PNorm = 35.3331, GNorm = 1.4591, lr_0 = 2.9795e-04
Validation rmse = 0.173742
Epoch 31
Loss = 1.7680e-01, PNorm = 35.3450, GNorm = 1.7448, lr_0 = 2.9080e-04
Loss = 1.7736e-01, PNorm = 35.3515, GNorm = 1.0848, lr_0 = 2.8446e-04
Validation rmse = 0.174490
Epoch 32
Loss = 1.5466e-01, PNorm = 35.3588, GNorm = 3.3085, lr_0 = 2.7826e-04
Loss = 1.6983e-01, PNorm = 35.3659, GNorm = 0.7833, lr_0 = 2.7219e-04
Validation rmse = 0.172906
Epoch 33
Loss = 1.6824e-01, PNorm = 35.3751, GNorm = 1.6709, lr_0 = 2.6566e-04
Loss = 1.5135e-01, PNorm = 35.3826, GNorm = 0.9338, lr_0 = 2.5987e-04
Validation rmse = 0.170867
Epoch 34
Loss = 1.5530e-01, PNorm = 35.3911, GNorm = 1.3409, lr_0 = 2.5420e-04
Validation rmse = 0.168861
Epoch 35
Loss = 1.4773e-01, PNorm = 35.3971, GNorm = 1.5997, lr_0 = 2.4811e-04
Loss = 1.5992e-01, PNorm = 35.4039, GNorm = 2.4261, lr_0 = 2.4269e-04
Validation rmse = 0.172358
Epoch 36
Loss = 1.6943e-01, PNorm = 35.4105, GNorm = 1.9014, lr_0 = 2.3740e-04
Loss = 1.6160e-01, PNorm = 35.4159, GNorm = 1.5875, lr_0 = 2.3222e-04
Validation rmse = 0.174354
Epoch 37
Loss = 1.8865e-01, PNorm = 35.4240, GNorm = 5.3036, lr_0 = 2.2665e-04
Loss = 1.5386e-01, PNorm = 35.4315, GNorm = 2.3767, lr_0 = 2.2171e-04
Validation rmse = 0.169372
Epoch 38
Loss = 1.2792e-01, PNorm = 35.4372, GNorm = 1.7062, lr_0 = 2.1687e-04
Loss = 1.6392e-01, PNorm = 35.4441, GNorm = 2.2261, lr_0 = 2.1214e-04
Validation rmse = 0.174968
Epoch 39
Loss = 1.7198e-01, PNorm = 35.4510, GNorm = 2.5501, lr_0 = 2.0752e-04
Loss = 1.5923e-01, PNorm = 35.4570, GNorm = 1.0743, lr_0 = 2.0299e-04
Validation rmse = 0.169569
Epoch 40
Loss = 1.4742e-01, PNorm = 35.4630, GNorm = 3.2692, lr_0 = 1.9812e-04
Loss = 1.5372e-01, PNorm = 35.4679, GNorm = 3.5525, lr_0 = 1.9380e-04
Validation rmse = 0.170899
Epoch 41
Loss = 1.6707e-01, PNorm = 35.4722, GNorm = 2.6062, lr_0 = 1.8957e-04
Validation rmse = 0.169836
Epoch 42
Loss = 1.5634e-01, PNorm = 35.4794, GNorm = 1.2778, lr_0 = 1.8503e-04
Loss = 1.2545e-01, PNorm = 35.4843, GNorm = 1.4732, lr_0 = 1.8099e-04
Validation rmse = 0.166297
Epoch 43
Loss = 1.3567e-01, PNorm = 35.4892, GNorm = 1.1782, lr_0 = 1.7705e-04
Loss = 1.6559e-01, PNorm = 35.4961, GNorm = 1.4580, lr_0 = 1.7318e-04
Validation rmse = 0.172241
Epoch 44
Loss = 1.5994e-01, PNorm = 35.5017, GNorm = 1.6174, lr_0 = 1.6903e-04
Loss = 1.5445e-01, PNorm = 35.5065, GNorm = 1.7924, lr_0 = 1.6534e-04
Validation rmse = 0.175350
Epoch 45
Loss = 1.5660e-01, PNorm = 35.5115, GNorm = 2.3700, lr_0 = 1.6174e-04
Loss = 1.4112e-01, PNorm = 35.5158, GNorm = 2.0960, lr_0 = 1.5821e-04
Validation rmse = 0.167962
Epoch 46
Loss = 1.6007e-01, PNorm = 35.5211, GNorm = 1.5302, lr_0 = 1.5442e-04
Loss = 1.3659e-01, PNorm = 35.5256, GNorm = 0.6721, lr_0 = 1.5105e-04
Validation rmse = 0.171344
Epoch 47
Loss = 1.5515e-01, PNorm = 35.5318, GNorm = 0.9561, lr_0 = 1.4775e-04
Validation rmse = 0.167838
Epoch 48
Loss = 1.0019e-01, PNorm = 35.5367, GNorm = 0.7278, lr_0 = 1.4421e-04
Loss = 1.4859e-01, PNorm = 35.5403, GNorm = 0.9347, lr_0 = 1.4107e-04
Validation rmse = 0.167944
Epoch 49
Loss = 1.3019e-01, PNorm = 35.5438, GNorm = 1.5883, lr_0 = 1.3799e-04
Loss = 1.3488e-01, PNorm = 35.5487, GNorm = 1.0810, lr_0 = 1.3498e-04
Validation rmse = 0.169615
Epoch 50
Loss = 1.5492e-01, PNorm = 35.5534, GNorm = 2.0758, lr_0 = 1.3204e-04
Loss = 1.4906e-01, PNorm = 35.5582, GNorm = 1.0572, lr_0 = 1.2915e-04
Validation rmse = 0.165864
Epoch 51
Loss = 1.4663e-01, PNorm = 35.5617, GNorm = 1.7490, lr_0 = 1.2606e-04
Loss = 1.4223e-01, PNorm = 35.5656, GNorm = 0.9205, lr_0 = 1.2331e-04
Validation rmse = 0.167240
Epoch 52
Loss = 1.6000e-01, PNorm = 35.5691, GNorm = 0.9896, lr_0 = 1.2062e-04
Loss = 1.3560e-01, PNorm = 35.5736, GNorm = 2.7695, lr_0 = 1.1799e-04
Validation rmse = 0.168947
Epoch 53
Loss = 1.4720e-01, PNorm = 35.5772, GNorm = 2.0316, lr_0 = 1.1516e-04
Loss = 1.3225e-01, PNorm = 35.5804, GNorm = 1.2727, lr_0 = 1.1265e-04
Validation rmse = 0.167954
Epoch 54
Loss = 1.4720e-01, PNorm = 35.5837, GNorm = 1.3157, lr_0 = 1.1019e-04
Validation rmse = 0.166449
Epoch 55
Loss = 1.3127e-01, PNorm = 35.5877, GNorm = 0.9294, lr_0 = 1.0755e-04
Loss = 1.3478e-01, PNorm = 35.5909, GNorm = 2.0926, lr_0 = 1.0520e-04
Validation rmse = 0.173292
Epoch 56
Loss = 1.2808e-01, PNorm = 35.5936, GNorm = 1.2305, lr_0 = 1.0291e-04
Loss = 1.3947e-01, PNorm = 35.5976, GNorm = 1.5469, lr_0 = 1.0066e-04
Validation rmse = 0.167979
Epoch 57
Loss = 1.2894e-01, PNorm = 35.6017, GNorm = 0.6229, lr_0 = 1.0000e-04
Loss = 1.3667e-01, PNorm = 35.6043, GNorm = 1.1650, lr_0 = 1.0000e-04
Validation rmse = 0.169543
Epoch 58
Loss = 1.2135e-01, PNorm = 35.6075, GNorm = 0.9384, lr_0 = 1.0000e-04
Loss = 1.3376e-01, PNorm = 35.6100, GNorm = 1.6333, lr_0 = 1.0000e-04
Validation rmse = 0.168477
Epoch 59
Loss = 1.3500e-01, PNorm = 35.6145, GNorm = 1.7445, lr_0 = 1.0000e-04
Loss = 1.4596e-01, PNorm = 35.6183, GNorm = 1.4350, lr_0 = 1.0000e-04
Validation rmse = 0.167638
Model 0 best validation rmse = 0.165864 on epoch 50
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.256773
Ensemble test rmse = 0.256773
1-fold cross validation
	Seed 0 ==> test rmse = 0.256773
Overall test rmse = 0.256773 +/- 0.000000
Elapsed time = 0:00:33
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,157 | train size = 919 | val size = 232 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.9364e-01, PNorm = 34.0158, GNorm = 1.2459, lr_0 = 3.7500e-04
Validation rmse = 0.288264
Epoch 1
Loss = 5.5288e-01, PNorm = 34.0420, GNorm = 0.8149, lr_0 = 6.5000e-04
Loss = 7.0876e-01, PNorm = 34.0807, GNorm = 7.9896, lr_0 = 9.0000e-04
Validation rmse = 0.254815
Epoch 2
Loss = 5.8595e-01, PNorm = 34.1503, GNorm = 2.2624, lr_0 = 9.8468e-04
Loss = 5.3312e-01, PNorm = 34.2244, GNorm = 3.4276, lr_0 = 9.6320e-04
Validation rmse = 0.228172
Epoch 3
Loss = 3.6117e-01, PNorm = 34.2923, GNorm = 3.1014, lr_0 = 9.4219e-04
Loss = 4.2199e-01, PNorm = 34.3525, GNorm = 8.2303, lr_0 = 9.2164e-04
Validation rmse = 0.208995
Epoch 4
Loss = 3.8276e-01, PNorm = 34.4132, GNorm = 5.2573, lr_0 = 8.9955e-04
Loss = 3.5933e-01, PNorm = 34.4650, GNorm = 2.1094, lr_0 = 8.7992e-04
Validation rmse = 0.197542
Epoch 5
Loss = 2.8562e-01, PNorm = 34.5194, GNorm = 0.9886, lr_0 = 8.5883e-04
Loss = 2.5864e-01, PNorm = 34.5604, GNorm = 3.8437, lr_0 = 8.4010e-04
Validation rmse = 0.207660
Epoch 6
Loss = 2.9312e-01, PNorm = 34.6020, GNorm = 5.8617, lr_0 = 8.2177e-04
Validation rmse = 0.181435
Epoch 7
Loss = 1.8445e-01, PNorm = 34.6460, GNorm = 2.8683, lr_0 = 8.0207e-04
Loss = 2.4541e-01, PNorm = 34.6862, GNorm = 2.7758, lr_0 = 7.8458e-04
Validation rmse = 0.178203
Epoch 8
Loss = 3.0950e-01, PNorm = 34.7230, GNorm = 1.4859, lr_0 = 7.6746e-04
Loss = 1.9902e-01, PNorm = 34.7527, GNorm = 3.2444, lr_0 = 7.5072e-04
Validation rmse = 0.176693
Epoch 9
Loss = 1.9481e-01, PNorm = 34.7918, GNorm = 0.9399, lr_0 = 7.3273e-04
Loss = 2.1173e-01, PNorm = 34.8277, GNorm = 1.4544, lr_0 = 7.1674e-04
Validation rmse = 0.206214
Epoch 10
Loss = 2.2431e-01, PNorm = 34.8555, GNorm = 0.9935, lr_0 = 6.9956e-04
Loss = 1.9712e-01, PNorm = 34.8799, GNorm = 2.4120, lr_0 = 6.8430e-04
Validation rmse = 0.172154
Epoch 11
Loss = 1.8523e-01, PNorm = 34.9003, GNorm = 2.2193, lr_0 = 6.6938e-04
Loss = 1.8898e-01, PNorm = 34.9233, GNorm = 1.1844, lr_0 = 6.5477e-04
Loss = 2.1974e-01, PNorm = 34.9251, GNorm = 1.8221, lr_0 = 6.5333e-04
Validation rmse = 0.168474
Epoch 12
Loss = 1.7642e-01, PNorm = 34.9455, GNorm = 1.8241, lr_0 = 6.3908e-04
Validation rmse = 0.166337
Epoch 13
Loss = 1.8250e-01, PNorm = 34.9710, GNorm = 4.7004, lr_0 = 6.2376e-04
Loss = 1.9793e-01, PNorm = 34.9940, GNorm = 1.2313, lr_0 = 6.1016e-04
Validation rmse = 0.180150
Epoch 14
Loss = 2.1527e-01, PNorm = 35.0172, GNorm = 2.0708, lr_0 = 5.9685e-04
Loss = 1.8953e-01, PNorm = 35.0361, GNorm = 4.0073, lr_0 = 5.8383e-04
Validation rmse = 0.177865
Epoch 15
Loss = 1.9490e-01, PNorm = 35.0580, GNorm = 3.4128, lr_0 = 5.6983e-04
Loss = 1.8996e-01, PNorm = 35.0798, GNorm = 2.3046, lr_0 = 5.5740e-04
Validation rmse = 0.178678
Epoch 16
Loss = 2.1433e-01, PNorm = 35.1006, GNorm = 5.2346, lr_0 = 5.4524e-04
Loss = 1.7313e-01, PNorm = 35.1204, GNorm = 2.1297, lr_0 = 5.3335e-04
Validation rmse = 0.167502
Epoch 17
Loss = 1.6250e-01, PNorm = 35.1377, GNorm = 1.8642, lr_0 = 5.2057e-04
Loss = 1.8938e-01, PNorm = 35.1539, GNorm = 1.7859, lr_0 = 5.0921e-04
Loss = 1.7989e-01, PNorm = 35.1553, GNorm = 1.1033, lr_0 = 5.0809e-04
Validation rmse = 0.166653
Epoch 18
Loss = 1.5605e-01, PNorm = 35.1699, GNorm = 1.5855, lr_0 = 4.9700e-04
Validation rmse = 0.162890
Epoch 19
Loss = 1.6602e-01, PNorm = 35.1873, GNorm = 2.0944, lr_0 = 4.8616e-04
Loss = 1.5248e-01, PNorm = 35.2014, GNorm = 0.7179, lr_0 = 4.7556e-04
Validation rmse = 0.160018
Epoch 20
Loss = 1.0658e-01, PNorm = 35.2173, GNorm = 1.0231, lr_0 = 4.6416e-04
Loss = 1.7109e-01, PNorm = 35.2289, GNorm = 1.0892, lr_0 = 4.5403e-04
Validation rmse = 0.168445
Epoch 21
Loss = 1.3691e-01, PNorm = 35.2449, GNorm = 2.7875, lr_0 = 4.4315e-04
Loss = 1.5854e-01, PNorm = 35.2601, GNorm = 1.1709, lr_0 = 4.3348e-04
Validation rmse = 0.173296
Epoch 22
Loss = 1.5109e-01, PNorm = 35.2757, GNorm = 2.1225, lr_0 = 4.2403e-04
Loss = 1.7581e-01, PNorm = 35.2898, GNorm = 1.7738, lr_0 = 4.1478e-04
Validation rmse = 0.163529
Epoch 23
Loss = 1.5950e-01, PNorm = 35.3027, GNorm = 2.0735, lr_0 = 4.0484e-04
Loss = 1.4822e-01, PNorm = 35.3180, GNorm = 0.8792, lr_0 = 3.9601e-04
Validation rmse = 0.158593
Epoch 24
Loss = 1.3078e-01, PNorm = 35.3310, GNorm = 0.9313, lr_0 = 3.8737e-04
Validation rmse = 0.161318
Epoch 25
Loss = 1.1872e-01, PNorm = 35.3464, GNorm = 1.2053, lr_0 = 3.7808e-04
Loss = 1.4727e-01, PNorm = 35.3570, GNorm = 0.9547, lr_0 = 3.6983e-04
Validation rmse = 0.157708
Epoch 26
Loss = 1.4664e-01, PNorm = 35.3699, GNorm = 1.0409, lr_0 = 3.6097e-04
Loss = 1.4161e-01, PNorm = 35.3818, GNorm = 1.7774, lr_0 = 3.5310e-04
Validation rmse = 0.160510
Epoch 27
Loss = 1.1022e-01, PNorm = 35.3913, GNorm = 2.1393, lr_0 = 3.4539e-04
Loss = 1.6309e-01, PNorm = 35.4016, GNorm = 0.8095, lr_0 = 3.3786e-04
Validation rmse = 0.157881
Epoch 28
Loss = 1.2503e-01, PNorm = 35.4168, GNorm = 0.9198, lr_0 = 3.2976e-04
Loss = 1.5314e-01, PNorm = 35.4245, GNorm = 4.6763, lr_0 = 3.2257e-04
Validation rmse = 0.157581
Epoch 29
Loss = 1.3825e-01, PNorm = 35.4343, GNorm = 1.6485, lr_0 = 3.1553e-04
Loss = 1.4933e-01, PNorm = 35.4467, GNorm = 1.9164, lr_0 = 3.0865e-04
Validation rmse = 0.158177
Epoch 30
Loss = 1.3689e-01, PNorm = 35.4596, GNorm = 1.3429, lr_0 = 3.0125e-04
Validation rmse = 0.158091
Epoch 31
Loss = 1.1001e-01, PNorm = 35.4693, GNorm = 1.9273, lr_0 = 2.9403e-04
Loss = 1.4525e-01, PNorm = 35.4802, GNorm = 2.3967, lr_0 = 2.8762e-04
Validation rmse = 0.159219
Epoch 32
Loss = 1.2015e-01, PNorm = 35.4883, GNorm = 1.5325, lr_0 = 2.8134e-04
Loss = 1.2423e-01, PNorm = 35.4973, GNorm = 0.7546, lr_0 = 2.7520e-04
Validation rmse = 0.158359
Epoch 33
Loss = 1.3605e-01, PNorm = 35.5088, GNorm = 1.3062, lr_0 = 2.6861e-04
Loss = 1.5222e-01, PNorm = 35.5199, GNorm = 3.8464, lr_0 = 2.6275e-04
Validation rmse = 0.160849
Epoch 34
Loss = 1.4503e-01, PNorm = 35.5280, GNorm = 0.6123, lr_0 = 2.5645e-04
Loss = 1.1821e-01, PNorm = 35.5363, GNorm = 0.9506, lr_0 = 2.5086e-04
Validation rmse = 0.158380
Epoch 35
Loss = 1.2484e-01, PNorm = 35.5443, GNorm = 0.5494, lr_0 = 2.4538e-04
Loss = 1.3335e-01, PNorm = 35.5521, GNorm = 1.3266, lr_0 = 2.4003e-04
Validation rmse = 0.157853
Epoch 36
Loss = 1.2269e-01, PNorm = 35.5620, GNorm = 1.9566, lr_0 = 2.3428e-04
Loss = 1.3718e-01, PNorm = 35.5692, GNorm = 4.1297, lr_0 = 2.2917e-04
Validation rmse = 0.157589
Epoch 37
Loss = 1.1160e-01, PNorm = 35.5791, GNorm = 0.9543, lr_0 = 2.2417e-04
Validation rmse = 0.155999
Epoch 38
Loss = 1.7859e-01, PNorm = 35.5873, GNorm = 3.0243, lr_0 = 2.1880e-04
Loss = 1.2080e-01, PNorm = 35.5940, GNorm = 0.8582, lr_0 = 2.1402e-04
Validation rmse = 0.156485
Epoch 39
Loss = 1.2540e-01, PNorm = 35.6018, GNorm = 1.3740, lr_0 = 2.0889e-04
Loss = 1.1708e-01, PNorm = 35.6094, GNorm = 1.9903, lr_0 = 2.0434e-04
Validation rmse = 0.156534
Epoch 40
Loss = 1.4490e-01, PNorm = 35.6154, GNorm = 0.9852, lr_0 = 1.9988e-04
Loss = 1.2401e-01, PNorm = 35.6223, GNorm = 1.3748, lr_0 = 1.9552e-04
Validation rmse = 0.157777
Epoch 41
Loss = 1.1140e-01, PNorm = 35.6299, GNorm = 0.7866, lr_0 = 1.9083e-04
Loss = 1.3130e-01, PNorm = 35.6359, GNorm = 0.9592, lr_0 = 1.8667e-04
Validation rmse = 0.157172
Epoch 42
Loss = 1.2332e-01, PNorm = 35.6440, GNorm = 0.7807, lr_0 = 1.8219e-04
Loss = 1.1681e-01, PNorm = 35.6498, GNorm = 1.7169, lr_0 = 1.7822e-04
Validation rmse = 0.157873
Epoch 43
Loss = 1.1250e-01, PNorm = 35.6556, GNorm = 0.9826, lr_0 = 1.7433e-04
Validation rmse = 0.155175
Epoch 44
Loss = 1.3516e-01, PNorm = 35.6619, GNorm = 1.3011, lr_0 = 1.7015e-04
Loss = 1.1661e-01, PNorm = 35.6669, GNorm = 0.7735, lr_0 = 1.6644e-04
Validation rmse = 0.155527
Epoch 45
Loss = 1.2390e-01, PNorm = 35.6729, GNorm = 1.0249, lr_0 = 1.6281e-04
Loss = 1.1455e-01, PNorm = 35.6811, GNorm = 1.7029, lr_0 = 1.5926e-04
Validation rmse = 0.156475
Epoch 46
Loss = 9.3610e-02, PNorm = 35.6871, GNorm = 2.4662, lr_0 = 1.5544e-04
Loss = 1.3147e-01, PNorm = 35.6922, GNorm = 2.7810, lr_0 = 1.5205e-04
Validation rmse = 0.157059
Epoch 47
Loss = 1.1943e-01, PNorm = 35.6985, GNorm = 0.7829, lr_0 = 1.4841e-04
Loss = 1.1770e-01, PNorm = 35.7043, GNorm = 2.3974, lr_0 = 1.4517e-04
Validation rmse = 0.155027
Epoch 48
Loss = 1.3598e-01, PNorm = 35.7089, GNorm = 0.7787, lr_0 = 1.4200e-04
Loss = 1.0196e-01, PNorm = 35.7144, GNorm = 0.9992, lr_0 = 1.3891e-04
Loss = 1.0332e-01, PNorm = 35.7148, GNorm = 3.3201, lr_0 = 1.3860e-04
Validation rmse = 0.157658
Epoch 49
Loss = 1.1755e-01, PNorm = 35.7190, GNorm = 1.5061, lr_0 = 1.3558e-04
Validation rmse = 0.157262
Epoch 50
Loss = 7.8968e-02, PNorm = 35.7239, GNorm = 1.1758, lr_0 = 1.3262e-04
Loss = 1.0598e-01, PNorm = 35.7281, GNorm = 1.6635, lr_0 = 1.2973e-04
Validation rmse = 0.155835
Epoch 51
Loss = 1.3332e-01, PNorm = 35.7333, GNorm = 0.7043, lr_0 = 1.2662e-04
Loss = 1.1449e-01, PNorm = 35.7383, GNorm = 0.5812, lr_0 = 1.2385e-04
Validation rmse = 0.155696
Epoch 52
Loss = 9.9001e-02, PNorm = 35.7430, GNorm = 1.3385, lr_0 = 1.2089e-04
Loss = 1.1611e-01, PNorm = 35.7467, GNorm = 1.2230, lr_0 = 1.1825e-04
Validation rmse = 0.155970
Epoch 53
Loss = 1.1497e-01, PNorm = 35.7504, GNorm = 1.6132, lr_0 = 1.1567e-04
Loss = 1.1195e-01, PNorm = 35.7549, GNorm = 1.3801, lr_0 = 1.1315e-04
Validation rmse = 0.156581
Epoch 54
Loss = 1.1007e-01, PNorm = 35.7586, GNorm = 1.1964, lr_0 = 1.1043e-04
Loss = 1.1622e-01, PNorm = 35.7626, GNorm = 2.2594, lr_0 = 1.0803e-04
Loss = 1.6587e-01, PNorm = 35.7630, GNorm = 1.4976, lr_0 = 1.0779e-04
Validation rmse = 0.157801
Epoch 55
Loss = 1.1986e-01, PNorm = 35.7659, GNorm = 2.6542, lr_0 = 1.0544e-04
Validation rmse = 0.155436
Epoch 56
Loss = 1.1193e-01, PNorm = 35.7699, GNorm = 0.8619, lr_0 = 1.0314e-04
Loss = 1.1341e-01, PNorm = 35.7736, GNorm = 2.8223, lr_0 = 1.0089e-04
Validation rmse = 0.156296
Epoch 57
Loss = 9.9110e-02, PNorm = 35.7776, GNorm = 2.1848, lr_0 = 1.0000e-04
Loss = 1.2720e-01, PNorm = 35.7808, GNorm = 3.8270, lr_0 = 1.0000e-04
Validation rmse = 0.163050
Epoch 58
Loss = 1.5793e-01, PNorm = 35.7855, GNorm = 1.3496, lr_0 = 1.0000e-04
Loss = 1.0487e-01, PNorm = 35.7895, GNorm = 2.2137, lr_0 = 1.0000e-04
Validation rmse = 0.155625
Epoch 59
Loss = 9.3747e-02, PNorm = 35.7930, GNorm = 0.7182, lr_0 = 1.0000e-04
Loss = 1.0574e-01, PNorm = 35.7967, GNorm = 1.0073, lr_0 = 1.0000e-04
Validation rmse = 0.158005
Model 0 best validation rmse = 0.155027 on epoch 47
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.129367
Ensemble test rmse = 0.129367
1-fold cross validation
	Seed 0 ==> test rmse = 0.129367
Overall test rmse = 0.129367 +/- 0.000000
Elapsed time = 0:00:33
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,147 | train size = 911 | val size = 230 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.5301e-01, PNorm = 34.0154, GNorm = 1.4281, lr_0 = 3.7500e-04
Validation rmse = 0.282432
Epoch 1
Loss = 6.8752e-01, PNorm = 34.0418, GNorm = 5.5217, lr_0 = 6.5000e-04
Loss = 6.3951e-01, PNorm = 34.0867, GNorm = 3.6125, lr_0 = 9.0000e-04
Validation rmse = 0.302941
Epoch 2
Loss = 5.6761e-01, PNorm = 34.1594, GNorm = 4.5599, lr_0 = 9.8468e-04
Loss = 5.1218e-01, PNorm = 34.2149, GNorm = 7.0096, lr_0 = 9.6320e-04
Validation rmse = 0.221237
Epoch 3
Loss = 4.2846e-01, PNorm = 34.2791, GNorm = 4.7704, lr_0 = 9.4011e-04
Loss = 3.6290e-01, PNorm = 34.3326, GNorm = 5.4214, lr_0 = 9.1961e-04
Validation rmse = 0.276520
Epoch 4
Loss = 4.3743e-01, PNorm = 34.3908, GNorm = 1.2199, lr_0 = 8.9756e-04
Loss = 2.9966e-01, PNorm = 34.4317, GNorm = 5.1662, lr_0 = 8.7798e-04
Validation rmse = 0.204530
Epoch 5
Loss = 2.5323e-01, PNorm = 34.4725, GNorm = 0.8539, lr_0 = 8.5883e-04
Validation rmse = 0.184091
Epoch 6
Loss = 2.0221e-01, PNorm = 34.5131, GNorm = 0.6336, lr_0 = 8.3825e-04
Loss = 2.4690e-01, PNorm = 34.5500, GNorm = 1.3559, lr_0 = 8.1996e-04
Validation rmse = 0.186178
Epoch 7
Loss = 2.2880e-01, PNorm = 34.5919, GNorm = 1.0587, lr_0 = 8.0031e-04
Loss = 2.4266e-01, PNorm = 34.6271, GNorm = 2.1077, lr_0 = 7.8285e-04
Validation rmse = 0.177559
Epoch 8
Loss = 2.2694e-01, PNorm = 34.6584, GNorm = 1.8798, lr_0 = 7.6409e-04
Loss = 1.9498e-01, PNorm = 34.6882, GNorm = 1.1936, lr_0 = 7.4742e-04
Validation rmse = 0.172452
Epoch 9
Loss = 2.3175e-01, PNorm = 34.7236, GNorm = 3.4525, lr_0 = 7.2950e-04
Loss = 2.1119e-01, PNorm = 34.7499, GNorm = 2.1960, lr_0 = 7.1359e-04
Validation rmse = 0.171957
Epoch 10
Loss = 2.1141e-01, PNorm = 34.7737, GNorm = 1.6610, lr_0 = 6.9802e-04
Loss = 1.9676e-01, PNorm = 34.7969, GNorm = 4.1114, lr_0 = 6.8280e-04
Loss = 1.2444e-01, PNorm = 34.7989, GNorm = 2.7331, lr_0 = 6.8129e-04
Validation rmse = 0.165607
Epoch 11
Loss = 1.8592e-01, PNorm = 34.8230, GNorm = 1.6519, lr_0 = 6.6643e-04
Validation rmse = 0.168705
Epoch 12
Loss = 1.5239e-01, PNorm = 34.8447, GNorm = 0.7807, lr_0 = 6.5046e-04
Loss = 1.9866e-01, PNorm = 34.8714, GNorm = 1.1515, lr_0 = 6.3627e-04
Validation rmse = 0.164278
Epoch 13
Loss = 2.0748e-01, PNorm = 34.8920, GNorm = 4.4185, lr_0 = 6.2102e-04
Loss = 1.8341e-01, PNorm = 34.9121, GNorm = 5.3896, lr_0 = 6.0747e-04
Validation rmse = 0.169246
Epoch 14
Loss = 2.2445e-01, PNorm = 34.9345, GNorm = 5.2911, lr_0 = 5.9422e-04
Loss = 2.0717e-01, PNorm = 34.9578, GNorm = 2.7322, lr_0 = 5.8126e-04
Validation rmse = 0.160450
Epoch 15
Loss = 1.8446e-01, PNorm = 34.9802, GNorm = 0.9722, lr_0 = 5.6732e-04
Loss = 1.6003e-01, PNorm = 34.9975, GNorm = 1.5408, lr_0 = 5.5495e-04
Validation rmse = 0.162265
Epoch 16
Loss = 1.6763e-01, PNorm = 35.0187, GNorm = 1.0145, lr_0 = 5.4165e-04
Validation rmse = 0.164608
Epoch 17
Loss = 1.3033e-01, PNorm = 35.0382, GNorm = 2.8831, lr_0 = 5.2866e-04
Loss = 1.6563e-01, PNorm = 35.0564, GNorm = 3.0356, lr_0 = 5.1713e-04
Validation rmse = 0.158725
Epoch 18
Loss = 1.2988e-01, PNorm = 35.0714, GNorm = 1.1141, lr_0 = 5.0474e-04
Loss = 1.6543e-01, PNorm = 35.0842, GNorm = 0.8401, lr_0 = 4.9373e-04
Validation rmse = 0.157239
Epoch 19
Loss = 1.7415e-01, PNorm = 35.0952, GNorm = 4.5122, lr_0 = 4.8296e-04
Loss = 1.7794e-01, PNorm = 35.1088, GNorm = 3.2963, lr_0 = 4.7242e-04
Validation rmse = 0.166220
Epoch 20
Loss = 1.8755e-01, PNorm = 35.1281, GNorm = 0.6460, lr_0 = 4.6110e-04
Loss = 1.6990e-01, PNorm = 35.1456, GNorm = 5.6102, lr_0 = 4.5104e-04
Validation rmse = 0.164614
Epoch 21
Loss = 1.6368e-01, PNorm = 35.1568, GNorm = 1.3063, lr_0 = 4.4023e-04
Loss = 1.8469e-01, PNorm = 35.1707, GNorm = 3.8024, lr_0 = 4.3063e-04
Loss = 1.0793e-01, PNorm = 35.1723, GNorm = 2.7233, lr_0 = 4.2968e-04
Validation rmse = 0.163221
Epoch 22
Loss = 1.5897e-01, PNorm = 35.1839, GNorm = 1.3022, lr_0 = 4.2030e-04
Validation rmse = 0.156507
Epoch 23
Loss = 1.3880e-01, PNorm = 35.1985, GNorm = 0.9382, lr_0 = 4.1114e-04
Loss = 1.7948e-01, PNorm = 35.2096, GNorm = 3.7213, lr_0 = 4.0217e-04
Validation rmse = 0.164961
Epoch 24
Loss = 1.3984e-01, PNorm = 35.2252, GNorm = 2.0251, lr_0 = 3.9253e-04
Loss = 1.6355e-01, PNorm = 35.2387, GNorm = 2.4268, lr_0 = 3.8396e-04
Validation rmse = 0.156769
Epoch 25
Loss = 1.2379e-01, PNorm = 35.2501, GNorm = 0.6379, lr_0 = 3.7476e-04
Loss = 1.6546e-01, PNorm = 35.2613, GNorm = 4.7799, lr_0 = 3.6659e-04
Validation rmse = 0.171561
Epoch 26
Loss = 1.5183e-01, PNorm = 35.2744, GNorm = 5.5671, lr_0 = 3.5780e-04
Loss = 1.6738e-01, PNorm = 35.2837, GNorm = 3.8605, lr_0 = 3.4999e-04
Validation rmse = 0.156175
Epoch 27
Loss = 1.4172e-01, PNorm = 35.2970, GNorm = 3.3978, lr_0 = 3.4161e-04
Loss = 1.3151e-01, PNorm = 35.3065, GNorm = 0.9578, lr_0 = 3.3415e-04
Validation rmse = 0.160126
Epoch 28
Loss = 1.4901e-01, PNorm = 35.3170, GNorm = 2.3546, lr_0 = 3.2686e-04
Validation rmse = 0.162714
Epoch 29
Loss = 1.5158e-01, PNorm = 35.3279, GNorm = 3.3107, lr_0 = 3.1903e-04
Loss = 1.3910e-01, PNorm = 35.3381, GNorm = 2.2438, lr_0 = 3.1207e-04
Validation rmse = 0.159112
Epoch 30
Loss = 1.4226e-01, PNorm = 35.3481, GNorm = 1.1086, lr_0 = 3.0459e-04
Loss = 1.2641e-01, PNorm = 35.3593, GNorm = 0.9945, lr_0 = 2.9795e-04
Validation rmse = 0.173783
Epoch 31
Loss = 1.6508e-01, PNorm = 35.3693, GNorm = 1.6609, lr_0 = 2.9080e-04
Loss = 1.5454e-01, PNorm = 35.3793, GNorm = 4.1451, lr_0 = 2.8446e-04
Validation rmse = 0.161885
Epoch 32
Loss = 1.3095e-01, PNorm = 35.3886, GNorm = 0.9871, lr_0 = 2.7826e-04
Loss = 1.3883e-01, PNorm = 35.3980, GNorm = 1.5446, lr_0 = 2.7219e-04
Validation rmse = 0.158003
Epoch 33
Loss = 1.2301e-01, PNorm = 35.4092, GNorm = 1.9110, lr_0 = 2.6566e-04
Validation rmse = 0.157222
Epoch 34
Loss = 1.0220e-01, PNorm = 35.4179, GNorm = 0.7533, lr_0 = 2.5929e-04
Loss = 1.3905e-01, PNorm = 35.4243, GNorm = 1.1835, lr_0 = 2.5364e-04
Validation rmse = 0.155604
Epoch 35
Loss = 1.2920e-01, PNorm = 35.4355, GNorm = 3.5026, lr_0 = 2.4756e-04
Loss = 1.2870e-01, PNorm = 35.4451, GNorm = 1.8849, lr_0 = 2.4216e-04
Validation rmse = 0.155946
Epoch 36
Loss = 1.2407e-01, PNorm = 35.4533, GNorm = 3.3037, lr_0 = 2.3635e-04
Loss = 1.2196e-01, PNorm = 35.4612, GNorm = 3.0621, lr_0 = 2.3120e-04
Validation rmse = 0.159603
Epoch 37
Loss = 1.3463e-01, PNorm = 35.4694, GNorm = 1.1800, lr_0 = 2.2615e-04
Loss = 1.2129e-01, PNorm = 35.4780, GNorm = 1.1945, lr_0 = 2.2122e-04
Validation rmse = 0.155854
Epoch 38
Loss = 1.1153e-01, PNorm = 35.4854, GNorm = 0.8695, lr_0 = 2.1592e-04
Loss = 1.3374e-01, PNorm = 35.4923, GNorm = 1.8502, lr_0 = 2.1121e-04
Loss = 1.7521e-01, PNorm = 35.4926, GNorm = 2.7788, lr_0 = 2.1074e-04
Validation rmse = 0.156164
Epoch 39
Loss = 1.2981e-01, PNorm = 35.4977, GNorm = 4.6128, lr_0 = 2.0615e-04
Validation rmse = 0.174989
Epoch 40
Loss = 1.7906e-01, PNorm = 35.5059, GNorm = 3.9906, lr_0 = 2.0121e-04
Loss = 1.3389e-01, PNorm = 35.5142, GNorm = 1.7737, lr_0 = 1.9682e-04
Validation rmse = 0.160891
Epoch 41
Loss = 8.3192e-02, PNorm = 35.5196, GNorm = 1.3223, lr_0 = 1.9252e-04
Loss = 1.4691e-01, PNorm = 35.5261, GNorm = 0.6561, lr_0 = 1.8832e-04
Validation rmse = 0.157910
Epoch 42
Loss = 1.2741e-01, PNorm = 35.5331, GNorm = 1.2093, lr_0 = 1.8381e-04
Loss = 1.1701e-01, PNorm = 35.5399, GNorm = 2.6688, lr_0 = 1.7980e-04
Validation rmse = 0.159400
Epoch 43
Loss = 1.2299e-01, PNorm = 35.5473, GNorm = 1.5160, lr_0 = 1.7549e-04
Loss = 1.2565e-01, PNorm = 35.5528, GNorm = 0.6533, lr_0 = 1.7166e-04
Validation rmse = 0.156520
Epoch 44
Loss = 1.1271e-01, PNorm = 35.5585, GNorm = 1.1875, lr_0 = 1.6755e-04
Validation rmse = 0.156904
Epoch 45
Loss = 1.0706e-01, PNorm = 35.5644, GNorm = 0.7981, lr_0 = 1.6353e-04
Loss = 1.1450e-01, PNorm = 35.5707, GNorm = 2.4043, lr_0 = 1.5996e-04
Validation rmse = 0.162301
Epoch 46
Loss = 1.2175e-01, PNorm = 35.5753, GNorm = 2.9945, lr_0 = 1.5647e-04
Loss = 1.1791e-01, PNorm = 35.5800, GNorm = 0.9708, lr_0 = 1.5306e-04
Validation rmse = 0.156584
Epoch 47
Loss = 1.0634e-01, PNorm = 35.5864, GNorm = 0.7474, lr_0 = 1.4939e-04
Loss = 1.1131e-01, PNorm = 35.5909, GNorm = 1.2725, lr_0 = 1.4613e-04
Validation rmse = 0.155487
Epoch 48
Loss = 1.0732e-01, PNorm = 35.5980, GNorm = 0.3837, lr_0 = 1.4263e-04
Loss = 1.2246e-01, PNorm = 35.6035, GNorm = 1.7601, lr_0 = 1.3952e-04
Validation rmse = 0.157477
Epoch 49
Loss = 1.2144e-01, PNorm = 35.6089, GNorm = 0.9480, lr_0 = 1.3618e-04
Loss = 1.1233e-01, PNorm = 35.6143, GNorm = 2.0789, lr_0 = 1.3321e-04
Validation rmse = 0.158294
Epoch 50
Loss = 1.3072e-01, PNorm = 35.6188, GNorm = 2.2606, lr_0 = 1.3030e-04
Validation rmse = 0.159107
Epoch 51
Loss = 7.9328e-02, PNorm = 35.6234, GNorm = 1.1781, lr_0 = 1.2718e-04
Loss = 1.0830e-01, PNorm = 35.6273, GNorm = 1.1613, lr_0 = 1.2440e-04
Validation rmse = 0.160397
Epoch 52
Loss = 1.2862e-01, PNorm = 35.6316, GNorm = 0.6186, lr_0 = 1.2142e-04
Loss = 9.9305e-02, PNorm = 35.6362, GNorm = 1.0089, lr_0 = 1.1877e-04
Validation rmse = 0.156057
Epoch 53
Loss = 1.1806e-01, PNorm = 35.6406, GNorm = 0.5850, lr_0 = 1.1592e-04
Loss = 1.1025e-01, PNorm = 35.6446, GNorm = 0.8334, lr_0 = 1.1340e-04
Validation rmse = 0.157279
Epoch 54
Loss = 1.1711e-01, PNorm = 35.6495, GNorm = 1.2314, lr_0 = 1.1068e-04
Loss = 1.1827e-01, PNorm = 35.6536, GNorm = 2.3254, lr_0 = 1.0826e-04
Validation rmse = 0.157700
Epoch 55
Loss = 1.0551e-01, PNorm = 35.6568, GNorm = 1.4162, lr_0 = 1.0590e-04
Loss = 1.1320e-01, PNorm = 35.6609, GNorm = 1.3275, lr_0 = 1.0359e-04
Loss = 1.4824e-01, PNorm = 35.6611, GNorm = 1.6454, lr_0 = 1.0336e-04
Validation rmse = 0.159594
Epoch 56
Loss = 1.0852e-01, PNorm = 35.6635, GNorm = 1.4268, lr_0 = 1.0111e-04
Validation rmse = 0.157658
Epoch 57
Loss = 1.1869e-01, PNorm = 35.6664, GNorm = 0.7844, lr_0 = 1.0000e-04
Loss = 1.1423e-01, PNorm = 35.6705, GNorm = 1.8058, lr_0 = 1.0000e-04
Validation rmse = 0.157792
Epoch 58
Loss = 1.1584e-01, PNorm = 35.6741, GNorm = 0.5981, lr_0 = 1.0000e-04
Loss = 1.1146e-01, PNorm = 35.6771, GNorm = 0.6913, lr_0 = 1.0000e-04
Validation rmse = 0.156748
Epoch 59
Loss = 1.0827e-01, PNorm = 35.6807, GNorm = 0.7396, lr_0 = 1.0000e-04
Loss = 1.1211e-01, PNorm = 35.6833, GNorm = 0.8464, lr_0 = 1.0000e-04
Validation rmse = 0.156439
Model 0 best validation rmse = 0.155487 on epoch 47
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.129782
Ensemble test rmse = 0.129782
1-fold cross validation
	Seed 0 ==> test rmse = 0.129782
Overall test rmse = 0.129782 +/- 0.000000
Elapsed time = 0:00:32
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,137 | train size = 903 | val size = 228 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.7077e-01, PNorm = 34.0138, GNorm = 2.6245, lr_0 = 3.7500e-04
Validation rmse = 0.297317
Epoch 1
Loss = 8.5199e-01, PNorm = 34.0344, GNorm = 6.2906, lr_0 = 6.5000e-04
Loss = 6.7345e-01, PNorm = 34.0733, GNorm = 2.7503, lr_0 = 9.0000e-04
Validation rmse = 0.276866
Epoch 2
Loss = 7.5963e-01, PNorm = 34.1350, GNorm = 12.8921, lr_0 = 9.8468e-04
Loss = 8.6555e-01, PNorm = 34.1847, GNorm = 3.6103, lr_0 = 9.6320e-04
Validation rmse = 0.266271
Epoch 3
Loss = 5.7322e-01, PNorm = 34.2492, GNorm = 2.9223, lr_0 = 9.4011e-04
Loss = 5.1534e-01, PNorm = 34.3148, GNorm = 3.3107, lr_0 = 9.1961e-04
Validation rmse = 0.234112
Epoch 4
Loss = 4.2163e-01, PNorm = 34.3649, GNorm = 1.9750, lr_0 = 8.9756e-04
Loss = 3.6468e-01, PNorm = 34.4127, GNorm = 2.5415, lr_0 = 8.7798e-04
Loss = 7.8852e-02, PNorm = 34.4186, GNorm = 2.8596, lr_0 = 8.7605e-04
Validation rmse = 0.197590
Epoch 5
Loss = 3.4554e-01, PNorm = 34.4655, GNorm = 4.1494, lr_0 = 8.5694e-04
Validation rmse = 0.230532
Epoch 6
Loss = 4.9173e-01, PNorm = 34.5021, GNorm = 4.3044, lr_0 = 8.3640e-04
Loss = 3.1658e-01, PNorm = 34.5373, GNorm = 1.1323, lr_0 = 8.1815e-04
Validation rmse = 0.188595
Epoch 7
Loss = 2.6093e-01, PNorm = 34.5859, GNorm = 0.6583, lr_0 = 7.9854e-04
Loss = 2.6093e-01, PNorm = 34.6250, GNorm = 2.2837, lr_0 = 7.8112e-04
Validation rmse = 0.172734
Epoch 8
Loss = 2.6437e-01, PNorm = 34.6631, GNorm = 1.0442, lr_0 = 7.6240e-04
Loss = 2.7206e-01, PNorm = 34.7038, GNorm = 4.5456, lr_0 = 7.4577e-04
Validation rmse = 0.181180
Epoch 9
Loss = 2.7389e-01, PNorm = 34.7403, GNorm = 1.5731, lr_0 = 7.2790e-04
Loss = 2.3461e-01, PNorm = 34.7724, GNorm = 3.1784, lr_0 = 7.1202e-04
Loss = 2.1972e-01, PNorm = 34.7764, GNorm = 8.3258, lr_0 = 7.1045e-04
Validation rmse = 0.168386
Epoch 10
Loss = 2.2525e-01, PNorm = 34.8079, GNorm = 0.7881, lr_0 = 6.9495e-04
Validation rmse = 0.175475
Epoch 11
Loss = 2.3186e-01, PNorm = 34.8287, GNorm = 6.7624, lr_0 = 6.7829e-04
Loss = 2.9605e-01, PNorm = 34.8504, GNorm = 5.9030, lr_0 = 6.6350e-04
Validation rmse = 0.177373
Epoch 12
Loss = 2.4171e-01, PNorm = 34.8761, GNorm = 0.8586, lr_0 = 6.4759e-04
Loss = 2.1926e-01, PNorm = 34.9016, GNorm = 1.1457, lr_0 = 6.3347e-04
Validation rmse = 0.184393
Epoch 13
Loss = 2.8443e-01, PNorm = 34.9261, GNorm = 3.2041, lr_0 = 6.1828e-04
Loss = 2.1645e-01, PNorm = 34.9441, GNorm = 1.1009, lr_0 = 6.0480e-04
Validation rmse = 0.170135
Epoch 14
Loss = 2.0741e-01, PNorm = 34.9704, GNorm = 3.8532, lr_0 = 5.9030e-04
Loss = 2.1223e-01, PNorm = 34.9974, GNorm = 3.3479, lr_0 = 5.7742e-04
Loss = 9.2466e-01, PNorm = 34.9989, GNorm = 13.4942, lr_0 = 5.7615e-04
Validation rmse = 0.166733
Epoch 15
Loss = 2.3382e-01, PNorm = 35.0242, GNorm = 4.1037, lr_0 = 5.6358e-04
Validation rmse = 0.168390
Epoch 16
Loss = 2.2192e-01, PNorm = 35.0518, GNorm = 6.4840, lr_0 = 5.5007e-04
Loss = 2.2433e-01, PNorm = 35.0760, GNorm = 1.5842, lr_0 = 5.3808e-04
Validation rmse = 0.167125
Epoch 17
Loss = 2.4919e-01, PNorm = 35.0956, GNorm = 5.0589, lr_0 = 5.2634e-04
Loss = 1.9653e-01, PNorm = 35.1134, GNorm = 3.9205, lr_0 = 5.1486e-04
Validation rmse = 0.168952
Epoch 18
Loss = 1.7375e-01, PNorm = 35.1297, GNorm = 4.3549, lr_0 = 5.0252e-04
Loss = 1.7333e-01, PNorm = 35.1452, GNorm = 1.1213, lr_0 = 4.9155e-04
Validation rmse = 0.158028
Epoch 19
Loss = 1.9166e-01, PNorm = 35.1587, GNorm = 3.6776, lr_0 = 4.7977e-04
Loss = 1.7005e-01, PNorm = 35.1712, GNorm = 2.0353, lr_0 = 4.6931e-04
Validation rmse = 0.157861
Epoch 20
Loss = 1.8460e-01, PNorm = 35.1851, GNorm = 2.5617, lr_0 = 4.5806e-04
Validation rmse = 0.160090
Epoch 21
Loss = 1.5206e-01, PNorm = 35.1965, GNorm = 2.7109, lr_0 = 4.4708e-04
Loss = 1.6455e-01, PNorm = 35.2113, GNorm = 2.6389, lr_0 = 4.3733e-04
Validation rmse = 0.187803
Epoch 22
Loss = 2.8714e-01, PNorm = 35.2222, GNorm = 6.7242, lr_0 = 4.2684e-04
Loss = 2.0384e-01, PNorm = 35.2323, GNorm = 1.7555, lr_0 = 4.1753e-04
Validation rmse = 0.159986
Epoch 23
Loss = 1.8491e-01, PNorm = 35.2539, GNorm = 1.6557, lr_0 = 4.0752e-04
Loss = 1.7130e-01, PNorm = 35.2616, GNorm = 1.4569, lr_0 = 3.9863e-04
Validation rmse = 0.162379
Epoch 24
Loss = 1.6265e-01, PNorm = 35.2717, GNorm = 0.8225, lr_0 = 3.8908e-04
Loss = 1.5419e-01, PNorm = 35.2829, GNorm = 1.0734, lr_0 = 3.8059e-04
Validation rmse = 0.157180
Epoch 25
Loss = 1.7158e-01, PNorm = 35.2965, GNorm = 3.7326, lr_0 = 3.7147e-04
Validation rmse = 0.160402
Epoch 26
Loss = 1.3087e-01, PNorm = 35.3093, GNorm = 2.5577, lr_0 = 3.6257e-04
Loss = 1.5234e-01, PNorm = 35.3215, GNorm = 1.2580, lr_0 = 3.5466e-04
Validation rmse = 0.159878
Epoch 27
Loss = 1.4431e-01, PNorm = 35.3268, GNorm = 0.8127, lr_0 = 3.4616e-04
Loss = 1.5857e-01, PNorm = 35.3360, GNorm = 1.0832, lr_0 = 3.3861e-04
Validation rmse = 0.155832
Epoch 28
Loss = 1.8627e-01, PNorm = 35.3531, GNorm = 3.0713, lr_0 = 3.3049e-04
Loss = 1.5970e-01, PNorm = 35.3651, GNorm = 0.8595, lr_0 = 3.2328e-04
Validation rmse = 0.156427
Epoch 29
Loss = 1.7031e-01, PNorm = 35.3753, GNorm = 0.7049, lr_0 = 3.1553e-04
Loss = 1.3586e-01, PNorm = 35.3859, GNorm = 2.5454, lr_0 = 3.0865e-04
Validation rmse = 0.153842
Epoch 30
Loss = 1.4802e-01, PNorm = 35.3901, GNorm = 1.5548, lr_0 = 3.0125e-04
Validation rmse = 0.153284
Epoch 31
Loss = 1.2899e-01, PNorm = 35.3987, GNorm = 0.6737, lr_0 = 2.9403e-04
Loss = 1.3085e-01, PNorm = 35.4078, GNorm = 0.9585, lr_0 = 2.8762e-04
Validation rmse = 0.153234
Epoch 32
Loss = 1.5613e-01, PNorm = 35.4164, GNorm = 1.9125, lr_0 = 2.8072e-04
Loss = 1.3623e-01, PNorm = 35.4214, GNorm = 0.8609, lr_0 = 2.7460e-04
Validation rmse = 0.153327
Epoch 33
Loss = 1.4892e-01, PNorm = 35.4281, GNorm = 0.6944, lr_0 = 2.6802e-04
Loss = 1.2271e-01, PNorm = 35.4341, GNorm = 1.2436, lr_0 = 2.6217e-04
Validation rmse = 0.164208
Epoch 34
Loss = 1.6097e-01, PNorm = 35.4445, GNorm = 1.5425, lr_0 = 2.5645e-04
Loss = 1.4925e-01, PNorm = 35.4510, GNorm = 0.6220, lr_0 = 2.5086e-04
Validation rmse = 0.153221
Epoch 35
Loss = 1.3132e-01, PNorm = 35.4577, GNorm = 0.7235, lr_0 = 2.4484e-04
Loss = 1.3919e-01, PNorm = 35.4631, GNorm = 1.7812, lr_0 = 2.3950e-04
Loss = 4.8528e-02, PNorm = 35.4636, GNorm = 1.4001, lr_0 = 2.3898e-04
Validation rmse = 0.155207
Epoch 36
Loss = 1.2771e-01, PNorm = 35.4701, GNorm = 0.6095, lr_0 = 2.3376e-04
Validation rmse = 0.153138
Epoch 37
Loss = 9.7866e-02, PNorm = 35.4767, GNorm = 0.6851, lr_0 = 2.2816e-04
Loss = 1.2666e-01, PNorm = 35.4825, GNorm = 0.6711, lr_0 = 2.2318e-04
Validation rmse = 0.155302
Epoch 38
Loss = 1.4118e-01, PNorm = 35.4885, GNorm = 0.6198, lr_0 = 2.1783e-04
Loss = 1.2797e-01, PNorm = 35.4937, GNorm = 1.4766, lr_0 = 2.1308e-04
Validation rmse = 0.154510
Epoch 39
Loss = 1.2019e-01, PNorm = 35.5005, GNorm = 3.0215, lr_0 = 2.0797e-04
Loss = 1.4052e-01, PNorm = 35.5077, GNorm = 1.2735, lr_0 = 2.0344e-04
Validation rmse = 0.156238
Epoch 40
Loss = 1.2391e-01, PNorm = 35.5132, GNorm = 1.0258, lr_0 = 1.9856e-04
Loss = 1.3360e-01, PNorm = 35.5191, GNorm = 1.5438, lr_0 = 1.9423e-04
Loss = 3.3766e-02, PNorm = 35.5195, GNorm = 2.0671, lr_0 = 1.9380e-04
Validation rmse = 0.153042
Epoch 41
Loss = 1.2220e-01, PNorm = 35.5251, GNorm = 1.6578, lr_0 = 1.8957e-04
Validation rmse = 0.153275
Epoch 42
Loss = 1.4166e-01, PNorm = 35.5308, GNorm = 1.4087, lr_0 = 1.8503e-04
Loss = 1.2542e-01, PNorm = 35.5353, GNorm = 2.4230, lr_0 = 1.8099e-04
Validation rmse = 0.153551
Epoch 43
Loss = 1.1106e-01, PNorm = 35.5411, GNorm = 0.7652, lr_0 = 1.7666e-04
Loss = 1.2302e-01, PNorm = 35.5460, GNorm = 1.6086, lr_0 = 1.7280e-04
Validation rmse = 0.152638
Epoch 44
Loss = 1.1600e-01, PNorm = 35.5528, GNorm = 1.1129, lr_0 = 1.6866e-04
Loss = 1.2672e-01, PNorm = 35.5584, GNorm = 1.4412, lr_0 = 1.6498e-04
Validation rmse = 0.154567
Epoch 45
Loss = 1.1493e-01, PNorm = 35.5616, GNorm = 0.8596, lr_0 = 1.6103e-04
Loss = 1.2870e-01, PNorm = 35.5668, GNorm = 1.1590, lr_0 = 1.5751e-04
Loss = 8.2212e-02, PNorm = 35.5670, GNorm = 2.5862, lr_0 = 1.5717e-04
Validation rmse = 0.152448
Epoch 46
Loss = 1.2454e-01, PNorm = 35.5702, GNorm = 1.7949, lr_0 = 1.5374e-04
Validation rmse = 0.154889
Epoch 47
Loss = 1.8202e-01, PNorm = 35.5766, GNorm = 1.0054, lr_0 = 1.5005e-04
Loss = 1.3491e-01, PNorm = 35.5835, GNorm = 1.9667, lr_0 = 1.4678e-04
Validation rmse = 0.155721
Epoch 48
Loss = 1.4377e-01, PNorm = 35.5861, GNorm = 0.7594, lr_0 = 1.4326e-04
Loss = 1.1786e-01, PNorm = 35.5892, GNorm = 0.9251, lr_0 = 1.4014e-04
Validation rmse = 0.155903
Epoch 49
Loss = 1.1469e-01, PNorm = 35.5930, GNorm = 1.8530, lr_0 = 1.3678e-04
Loss = 1.2581e-01, PNorm = 35.5962, GNorm = 0.9006, lr_0 = 1.3379e-04
Validation rmse = 0.153400
Epoch 50
Loss = 1.3330e-01, PNorm = 35.6011, GNorm = 1.1429, lr_0 = 1.3088e-04
Loss = 1.0872e-01, PNorm = 35.6048, GNorm = 0.7752, lr_0 = 1.2802e-04
Validation rmse = 0.153426
Epoch 51
Loss = 1.2430e-01, PNorm = 35.6092, GNorm = 0.8735, lr_0 = 1.2495e-04
Validation rmse = 0.152618
Epoch 52
Loss = 1.3056e-01, PNorm = 35.6134, GNorm = 0.9260, lr_0 = 1.2196e-04
Loss = 1.2094e-01, PNorm = 35.6174, GNorm = 3.9692, lr_0 = 1.1930e-04
Validation rmse = 0.152832
Epoch 53
Loss = 1.3258e-01, PNorm = 35.6207, GNorm = 0.6074, lr_0 = 1.1644e-04
Loss = 1.1239e-01, PNorm = 35.6225, GNorm = 2.2277, lr_0 = 1.1390e-04
Validation rmse = 0.152496
Epoch 54
Loss = 1.0939e-01, PNorm = 35.6289, GNorm = 1.8650, lr_0 = 1.1117e-04
Loss = 1.1823e-01, PNorm = 35.6321, GNorm = 0.6831, lr_0 = 1.0874e-04
Validation rmse = 0.155452
Epoch 55
Loss = 1.2338e-01, PNorm = 35.6332, GNorm = 0.8589, lr_0 = 1.0614e-04
Loss = 1.1321e-01, PNorm = 35.6365, GNorm = 1.0384, lr_0 = 1.0382e-04
Validation rmse = 0.153837
Epoch 56
Loss = 9.5791e-02, PNorm = 35.6405, GNorm = 1.3150, lr_0 = 1.0133e-04
Validation rmse = 0.156541
Epoch 57
Loss = 9.7631e-02, PNorm = 35.6439, GNorm = 2.7572, lr_0 = 1.0000e-04
Loss = 1.2315e-01, PNorm = 35.6495, GNorm = 2.9408, lr_0 = 1.0000e-04
Validation rmse = 0.157193
Epoch 58
Loss = 1.3035e-01, PNorm = 35.6525, GNorm = 1.4551, lr_0 = 1.0000e-04
Loss = 1.1570e-01, PNorm = 35.6546, GNorm = 1.0432, lr_0 = 1.0000e-04
Validation rmse = 0.155123
Epoch 59
Loss = 1.1771e-01, PNorm = 35.6595, GNorm = 0.6167, lr_0 = 1.0000e-04
Loss = 1.1271e-01, PNorm = 35.6628, GNorm = 0.8243, lr_0 = 1.0000e-04
Validation rmse = 0.153190
Model 0 best validation rmse = 0.152448 on epoch 45
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.158327
Ensemble test rmse = 0.158327
1-fold cross validation
	Seed 0 ==> test rmse = 0.158327
Overall test rmse = 0.158327 +/- 0.000000
Elapsed time = 0:00:33
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,127 | train size = 895 | val size = 226 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.4898e-01, PNorm = 34.0159, GNorm = 1.7684, lr_0 = 3.9118e-04
Validation rmse = 0.309219
Epoch 1
Loss = 8.2426e-01, PNorm = 34.0423, GNorm = 12.2293, lr_0 = 6.8235e-04
Loss = 7.3631e-01, PNorm = 34.0863, GNorm = 5.0117, lr_0 = 9.4706e-04
Validation rmse = 0.265106
Epoch 2
Loss = 4.9516e-01, PNorm = 34.1603, GNorm = 8.0311, lr_0 = 9.8149e-04
Loss = 4.2286e-01, PNorm = 34.2326, GNorm = 5.4260, lr_0 = 9.5884e-04
Validation rmse = 0.235342
Epoch 3
Loss = 3.8367e-01, PNorm = 34.2915, GNorm = 1.2062, lr_0 = 9.3670e-04
Loss = 3.6171e-01, PNorm = 34.3428, GNorm = 2.0689, lr_0 = 9.1508e-04
Validation rmse = 0.222816
Epoch 4
Loss = 3.3187e-01, PNorm = 34.4014, GNorm = 5.7166, lr_0 = 8.9396e-04
Validation rmse = 0.206418
Epoch 5
Loss = 2.4775e-01, PNorm = 34.4472, GNorm = 2.2996, lr_0 = 8.7333e-04
Loss = 2.7814e-01, PNorm = 34.4938, GNorm = 0.8678, lr_0 = 8.5317e-04
Validation rmse = 0.201591
Epoch 6
Loss = 2.3292e-01, PNorm = 34.5410, GNorm = 3.4673, lr_0 = 8.3347e-04
Loss = 2.5698e-01, PNorm = 34.5755, GNorm = 0.7018, lr_0 = 8.1424e-04
Validation rmse = 0.176898
Epoch 7
Loss = 1.6966e-01, PNorm = 34.6157, GNorm = 3.3875, lr_0 = 7.9544e-04
Loss = 2.5819e-01, PNorm = 34.6496, GNorm = 5.7711, lr_0 = 7.7708e-04
Validation rmse = 0.185414
Epoch 8
Loss = 2.2079e-01, PNorm = 34.6880, GNorm = 1.7551, lr_0 = 7.5914e-04
Loss = 2.1143e-01, PNorm = 34.7192, GNorm = 4.0840, lr_0 = 7.4162e-04
Validation rmse = 0.175851
Epoch 9
Loss = 2.1235e-01, PNorm = 34.7531, GNorm = 1.9132, lr_0 = 7.2450e-04
Validation rmse = 0.170757
Epoch 10
Loss = 1.5965e-01, PNorm = 34.7780, GNorm = 1.6651, lr_0 = 7.0778e-04
Loss = 2.0067e-01, PNorm = 34.8116, GNorm = 1.3539, lr_0 = 6.9144e-04
Validation rmse = 0.191982
Epoch 11
Loss = 2.1909e-01, PNorm = 34.8390, GNorm = 4.7527, lr_0 = 6.7391e-04
Loss = 2.0939e-01, PNorm = 34.8646, GNorm = 2.4403, lr_0 = 6.5835e-04
Validation rmse = 0.155309
Epoch 12
Loss = 1.4815e-01, PNorm = 34.8917, GNorm = 1.3319, lr_0 = 6.4316e-04
Loss = 1.9151e-01, PNorm = 34.9169, GNorm = 1.3542, lr_0 = 6.2831e-04
Validation rmse = 0.161295
Epoch 13
Loss = 1.4689e-01, PNorm = 34.9366, GNorm = 0.7370, lr_0 = 6.1381e-04
Loss = 1.8921e-01, PNorm = 34.9580, GNorm = 2.9895, lr_0 = 5.9964e-04
Validation rmse = 0.156265
Epoch 14
Loss = 1.6802e-01, PNorm = 34.9763, GNorm = 1.9436, lr_0 = 5.8580e-04
Validation rmse = 0.183428
Epoch 15
Loss = 2.2736e-01, PNorm = 34.9982, GNorm = 5.7957, lr_0 = 5.7228e-04
Loss = 1.8357e-01, PNorm = 35.0202, GNorm = 3.3538, lr_0 = 5.5907e-04
Validation rmse = 0.171869
Epoch 16
Loss = 1.9029e-01, PNorm = 35.0406, GNorm = 0.9151, lr_0 = 5.4616e-04
Loss = 1.5590e-01, PNorm = 35.0635, GNorm = 0.5703, lr_0 = 5.3356e-04
Validation rmse = 0.152545
Epoch 17
Loss = 1.3827e-01, PNorm = 35.0822, GNorm = 1.0223, lr_0 = 5.2124e-04
Loss = 1.4906e-01, PNorm = 35.1021, GNorm = 0.8579, lr_0 = 5.0921e-04
Validation rmse = 0.151913
Epoch 18
Loss = 1.6663e-01, PNorm = 35.1163, GNorm = 2.6642, lr_0 = 4.9746e-04
Loss = 1.4983e-01, PNorm = 35.1335, GNorm = 1.0171, lr_0 = 4.8597e-04
Validation rmse = 0.152232
Epoch 19
Loss = 1.5102e-01, PNorm = 35.1516, GNorm = 3.9545, lr_0 = 4.7476e-04
Validation rmse = 0.152479
Epoch 20
Loss = 1.4922e-01, PNorm = 35.1670, GNorm = 0.9112, lr_0 = 4.6380e-04
Loss = 1.2592e-01, PNorm = 35.1852, GNorm = 1.2941, lr_0 = 4.5309e-04
Validation rmse = 0.148845
Epoch 21
Loss = 1.3954e-01, PNorm = 35.2036, GNorm = 1.0112, lr_0 = 4.4160e-04
Loss = 1.4778e-01, PNorm = 35.2201, GNorm = 2.8292, lr_0 = 4.3141e-04
Validation rmse = 0.150318
Epoch 22
Loss = 1.4131e-01, PNorm = 35.2345, GNorm = 2.2199, lr_0 = 4.2145e-04
Loss = 1.2857e-01, PNorm = 35.2505, GNorm = 1.4392, lr_0 = 4.1172e-04
Validation rmse = 0.152212
Epoch 23
Loss = 1.5484e-01, PNorm = 35.2615, GNorm = 1.1278, lr_0 = 4.0222e-04
Validation rmse = 0.161243
Epoch 24
Loss = 1.0328e-01, PNorm = 35.2744, GNorm = 2.3210, lr_0 = 3.9293e-04
Loss = 1.4268e-01, PNorm = 35.2905, GNorm = 1.5291, lr_0 = 3.8386e-04
Validation rmse = 0.150859
Epoch 25
Loss = 1.1843e-01, PNorm = 35.3043, GNorm = 2.7415, lr_0 = 3.7500e-04
Loss = 1.2460e-01, PNorm = 35.3154, GNorm = 5.0333, lr_0 = 3.6635e-04
Validation rmse = 0.150698
Epoch 26
Loss = 1.1267e-01, PNorm = 35.3294, GNorm = 0.8747, lr_0 = 3.5789e-04
Loss = 1.2609e-01, PNorm = 35.3420, GNorm = 0.9427, lr_0 = 3.4963e-04
Validation rmse = 0.148123
Epoch 27
Loss = 1.3055e-01, PNorm = 35.3514, GNorm = 0.5873, lr_0 = 3.4156e-04
Loss = 1.1557e-01, PNorm = 35.3646, GNorm = 1.9774, lr_0 = 3.3368e-04
Validation rmse = 0.151286
Epoch 28
Loss = 1.3641e-01, PNorm = 35.3744, GNorm = 2.7600, lr_0 = 3.2598e-04
Validation rmse = 0.149362
Epoch 29
Loss = 1.5132e-01, PNorm = 35.3866, GNorm = 2.2980, lr_0 = 3.1845e-04
Loss = 1.1601e-01, PNorm = 35.3983, GNorm = 0.8450, lr_0 = 3.1110e-04
Validation rmse = 0.152254
Epoch 30
Loss = 1.1074e-01, PNorm = 35.4071, GNorm = 2.0212, lr_0 = 3.0392e-04
Loss = 1.1940e-01, PNorm = 35.4154, GNorm = 0.6711, lr_0 = 2.9690e-04
Validation rmse = 0.151098
Epoch 31
Loss = 9.9477e-02, PNorm = 35.4258, GNorm = 2.1856, lr_0 = 2.8937e-04
Loss = 1.3114e-01, PNorm = 35.4370, GNorm = 1.5902, lr_0 = 2.8270e-04
Validation rmse = 0.149692
Epoch 32
Loss = 1.1799e-01, PNorm = 35.4469, GNorm = 1.4366, lr_0 = 2.7617e-04
Loss = 1.1814e-01, PNorm = 35.4553, GNorm = 0.8757, lr_0 = 2.6980e-04
Validation rmse = 0.150746
Epoch 33
Loss = 1.2065e-01, PNorm = 35.4631, GNorm = 3.1732, lr_0 = 2.6357e-04
Validation rmse = 0.149949
Epoch 34
Loss = 8.4662e-02, PNorm = 35.4742, GNorm = 0.7696, lr_0 = 2.5748e-04
Loss = 1.1858e-01, PNorm = 35.4808, GNorm = 2.0535, lr_0 = 2.5154e-04
Validation rmse = 0.149322
Epoch 35
Loss = 9.8124e-02, PNorm = 35.4911, GNorm = 0.9359, lr_0 = 2.4573e-04
Loss = 1.1102e-01, PNorm = 35.4986, GNorm = 1.4034, lr_0 = 2.4006e-04
Validation rmse = 0.149445
Epoch 36
Loss = 1.1034e-01, PNorm = 35.5063, GNorm = 1.8016, lr_0 = 2.3452e-04
Loss = 1.1023e-01, PNorm = 35.5152, GNorm = 0.6526, lr_0 = 2.2911e-04
Validation rmse = 0.153503
Epoch 37
Loss = 1.1497e-01, PNorm = 35.5238, GNorm = 1.6620, lr_0 = 2.2382e-04
Loss = 1.2456e-01, PNorm = 35.5299, GNorm = 0.7787, lr_0 = 2.1865e-04
Validation rmse = 0.149142
Epoch 38
Loss = 1.0402e-01, PNorm = 35.5382, GNorm = 1.1349, lr_0 = 2.1361e-04
Validation rmse = 0.151610
Epoch 39
Loss = 7.8052e-02, PNorm = 35.5459, GNorm = 1.1283, lr_0 = 2.0868e-04
Loss = 1.1236e-01, PNorm = 35.5523, GNorm = 1.6488, lr_0 = 2.0386e-04
Validation rmse = 0.159750
Epoch 40
Loss = 1.0770e-01, PNorm = 35.5596, GNorm = 0.9376, lr_0 = 1.9915e-04
Loss = 1.3070e-01, PNorm = 35.5656, GNorm = 1.5013, lr_0 = 1.9456e-04
Validation rmse = 0.154827
Epoch 41
Loss = 1.1487e-01, PNorm = 35.5729, GNorm = 0.7292, lr_0 = 1.8962e-04
Loss = 1.0600e-01, PNorm = 35.5801, GNorm = 1.3620, lr_0 = 1.8525e-04
Validation rmse = 0.151165
Epoch 42
Loss = 1.1196e-01, PNorm = 35.5851, GNorm = 0.6558, lr_0 = 1.8097e-04
Validation rmse = 0.149619
Epoch 43
Loss = 1.5357e-01, PNorm = 35.5909, GNorm = 0.8249, lr_0 = 1.7679e-04
Loss = 1.0564e-01, PNorm = 35.5967, GNorm = 3.0782, lr_0 = 1.7271e-04
Validation rmse = 0.150620
Epoch 44
Loss = 9.0973e-02, PNorm = 35.6022, GNorm = 1.7138, lr_0 = 1.6873e-04
Loss = 1.0538e-01, PNorm = 35.6089, GNorm = 0.5906, lr_0 = 1.6483e-04
Validation rmse = 0.150797
Epoch 45
Loss = 9.9292e-02, PNorm = 35.6134, GNorm = 0.9772, lr_0 = 1.6103e-04
Loss = 1.0937e-01, PNorm = 35.6178, GNorm = 1.5493, lr_0 = 1.5731e-04
Validation rmse = 0.153355
Epoch 46
Loss = 9.6569e-02, PNorm = 35.6241, GNorm = 1.7523, lr_0 = 1.5368e-04
Loss = 1.0599e-01, PNorm = 35.6293, GNorm = 1.2219, lr_0 = 1.5013e-04
Validation rmse = 0.150438
Epoch 47
Loss = 1.1100e-01, PNorm = 35.6344, GNorm = 3.0462, lr_0 = 1.4667e-04
Validation rmse = 0.150110
Epoch 48
Loss = 1.2882e-01, PNorm = 35.6394, GNorm = 0.7357, lr_0 = 1.4328e-04
Loss = 9.6241e-02, PNorm = 35.6440, GNorm = 1.6557, lr_0 = 1.3997e-04
Validation rmse = 0.153747
Epoch 49
Loss = 1.1662e-01, PNorm = 35.6486, GNorm = 1.0677, lr_0 = 1.3674e-04
Loss = 1.0871e-01, PNorm = 35.6527, GNorm = 3.7029, lr_0 = 1.3359e-04
Validation rmse = 0.151811
Epoch 50
Loss = 1.1498e-01, PNorm = 35.6576, GNorm = 2.0835, lr_0 = 1.3050e-04
Loss = 1.0717e-01, PNorm = 35.6618, GNorm = 3.5252, lr_0 = 1.2749e-04
Validation rmse = 0.154863
Epoch 51
Loss = 1.1752e-01, PNorm = 35.6666, GNorm = 1.2194, lr_0 = 1.2426e-04
Loss = 9.6565e-02, PNorm = 35.6710, GNorm = 1.6008, lr_0 = 1.2139e-04
Validation rmse = 0.151402
Epoch 52
Loss = 9.7693e-02, PNorm = 35.6756, GNorm = 1.0512, lr_0 = 1.1859e-04
Validation rmse = 0.149826
Epoch 53
Loss = 6.9970e-02, PNorm = 35.6793, GNorm = 0.6387, lr_0 = 1.1585e-04
Loss = 1.0389e-01, PNorm = 35.6823, GNorm = 1.0606, lr_0 = 1.1318e-04
Validation rmse = 0.151220
Epoch 54
Loss = 9.1263e-02, PNorm = 35.6860, GNorm = 0.9745, lr_0 = 1.1056e-04
Loss = 1.0504e-01, PNorm = 35.6902, GNorm = 2.6381, lr_0 = 1.0801e-04
Validation rmse = 0.151146
Epoch 55
Loss = 1.0160e-01, PNorm = 35.6932, GNorm = 1.0049, lr_0 = 1.0552e-04
Loss = 9.3434e-02, PNorm = 35.6968, GNorm = 1.9345, lr_0 = 1.0308e-04
Validation rmse = 0.151974
Epoch 56
Loss = 9.0155e-02, PNorm = 35.7010, GNorm = 1.6900, lr_0 = 1.0070e-04
Loss = 1.0590e-01, PNorm = 35.7040, GNorm = 0.8442, lr_0 = 1.0000e-04
Validation rmse = 0.150334
Epoch 57
Loss = 1.0234e-01, PNorm = 35.7070, GNorm = 2.9376, lr_0 = 1.0000e-04
Validation rmse = 0.151000
Epoch 58
Loss = 8.3514e-02, PNorm = 35.7105, GNorm = 0.7086, lr_0 = 1.0000e-04
Loss = 9.7066e-02, PNorm = 35.7143, GNorm = 2.2740, lr_0 = 1.0000e-04
Validation rmse = 0.151482
Epoch 59
Loss = 1.1357e-01, PNorm = 35.7169, GNorm = 0.6844, lr_0 = 1.0000e-04
Loss = 8.7182e-02, PNorm = 35.7201, GNorm = 0.5928, lr_0 = 1.0000e-04
Validation rmse = 0.150727
Model 0 best validation rmse = 0.148123 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.143832
Ensemble test rmse = 0.143832
1-fold cross validation
	Seed 0 ==> test rmse = 0.143832
Overall test rmse = 0.143832 +/- 0.000000
Elapsed time = 0:00:33
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,117 | train size = 888 | val size = 223 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.9362e-01, PNorm = 34.0133, GNorm = 4.2284, lr_0 = 3.9118e-04
Validation rmse = 0.303678
Epoch 1
Loss = 7.9043e-01, PNorm = 34.0405, GNorm = 2.0097, lr_0 = 6.8235e-04
Loss = 6.0678e-01, PNorm = 34.0919, GNorm = 1.1151, lr_0 = 9.4706e-04
Validation rmse = 0.265551
Epoch 2
Loss = 5.1627e-01, PNorm = 34.1496, GNorm = 3.8199, lr_0 = 9.8149e-04
Loss = 4.8519e-01, PNorm = 34.2242, GNorm = 0.9510, lr_0 = 9.5884e-04
Validation rmse = 0.232761
Epoch 3
Loss = 4.3634e-01, PNorm = 34.2815, GNorm = 5.3473, lr_0 = 9.3670e-04
Loss = 4.4456e-01, PNorm = 34.3328, GNorm = 12.0225, lr_0 = 9.1508e-04
Validation rmse = 0.221164
Epoch 4
Loss = 3.6725e-01, PNorm = 34.3836, GNorm = 1.6589, lr_0 = 8.9396e-04
Validation rmse = 0.197308
Epoch 5
Loss = 3.0612e-01, PNorm = 34.4372, GNorm = 4.4382, lr_0 = 8.7129e-04
Loss = 2.6208e-01, PNorm = 34.4891, GNorm = 2.3366, lr_0 = 8.5118e-04
Validation rmse = 0.185932
Epoch 6
Loss = 2.7378e-01, PNorm = 34.5269, GNorm = 1.1163, lr_0 = 8.3153e-04
Loss = 2.5571e-01, PNorm = 34.5733, GNorm = 3.6783, lr_0 = 8.1234e-04
Validation rmse = 0.193778
Epoch 7
Loss = 2.2714e-01, PNorm = 34.6121, GNorm = 3.8844, lr_0 = 7.9359e-04
Loss = 2.3150e-01, PNorm = 34.6514, GNorm = 2.0691, lr_0 = 7.7527e-04
Validation rmse = 0.169777
Epoch 8
Loss = 1.9825e-01, PNorm = 34.6875, GNorm = 0.7171, lr_0 = 7.5737e-04
Validation rmse = 0.170838
Epoch 9
Loss = 2.9782e-01, PNorm = 34.7230, GNorm = 4.9467, lr_0 = 7.3817e-04
Loss = 1.7828e-01, PNorm = 34.7554, GNorm = 2.9063, lr_0 = 7.2113e-04
Validation rmse = 0.160412
Epoch 10
Loss = 1.6535e-01, PNorm = 34.7879, GNorm = 0.5738, lr_0 = 7.0448e-04
Loss = 1.9617e-01, PNorm = 34.8142, GNorm = 3.4620, lr_0 = 6.8822e-04
Validation rmse = 0.158249
Epoch 11
Loss = 2.0349e-01, PNorm = 34.8466, GNorm = 3.4260, lr_0 = 6.7234e-04
Loss = 1.6237e-01, PNorm = 34.8755, GNorm = 0.8270, lr_0 = 6.5682e-04
Validation rmse = 0.159167
Epoch 12
Loss = 1.7266e-01, PNorm = 34.8985, GNorm = 0.9071, lr_0 = 6.4166e-04
Loss = 1.4346e-01, PNorm = 34.9205, GNorm = 0.8474, lr_0 = 6.2685e-04
Loss = 2.7342e-01, PNorm = 34.9223, GNorm = 2.7168, lr_0 = 6.2538e-04
Validation rmse = 0.172902
Epoch 13
Loss = 1.7397e-01, PNorm = 34.9464, GNorm = 0.8968, lr_0 = 6.1095e-04
Validation rmse = 0.156675
Epoch 14
Loss = 1.7075e-01, PNorm = 34.9646, GNorm = 1.4228, lr_0 = 5.9685e-04
Loss = 1.7680e-01, PNorm = 34.9894, GNorm = 2.8021, lr_0 = 5.8307e-04
Validation rmse = 0.158884
Epoch 15
Loss = 1.7315e-01, PNorm = 35.0093, GNorm = 2.6165, lr_0 = 5.6961e-04
Loss = 1.5280e-01, PNorm = 35.0307, GNorm = 2.1263, lr_0 = 5.5646e-04
Validation rmse = 0.152237
Epoch 16
Loss = 1.7697e-01, PNorm = 35.0468, GNorm = 3.2573, lr_0 = 5.4362e-04
Loss = 1.6497e-01, PNorm = 35.0661, GNorm = 6.6679, lr_0 = 5.3107e-04
Validation rmse = 0.177339
Epoch 17
Loss = 1.7806e-01, PNorm = 35.0910, GNorm = 2.8015, lr_0 = 5.1760e-04
Validation rmse = 0.155090
Epoch 18
Loss = 9.9931e-02, PNorm = 35.1111, GNorm = 0.9937, lr_0 = 5.0565e-04
Loss = 1.4893e-01, PNorm = 35.1293, GNorm = 2.7456, lr_0 = 4.9398e-04
Validation rmse = 0.155260
Epoch 19
Loss = 1.5587e-01, PNorm = 35.1422, GNorm = 1.6686, lr_0 = 4.8258e-04
Loss = 1.4173e-01, PNorm = 35.1595, GNorm = 1.9059, lr_0 = 4.7144e-04
Validation rmse = 0.153254
Epoch 20
Loss = 1.2150e-01, PNorm = 35.1767, GNorm = 0.6361, lr_0 = 4.6056e-04
Loss = 1.2512e-01, PNorm = 35.1924, GNorm = 1.1056, lr_0 = 4.4993e-04
Validation rmse = 0.155990
Epoch 21
Loss = 1.3875e-01, PNorm = 35.2069, GNorm = 2.1732, lr_0 = 4.3852e-04
Loss = 1.3567e-01, PNorm = 35.2212, GNorm = 4.7860, lr_0 = 4.2840e-04
Validation rmse = 0.149287
Epoch 22
Loss = 1.3290e-01, PNorm = 35.2346, GNorm = 2.7788, lr_0 = 4.1851e-04
Validation rmse = 0.155163
Epoch 23
Loss = 1.3724e-01, PNorm = 35.2508, GNorm = 4.0278, lr_0 = 4.0885e-04
Loss = 1.2611e-01, PNorm = 35.2656, GNorm = 0.7007, lr_0 = 3.9941e-04
Validation rmse = 0.162315
Epoch 24
Loss = 1.0549e-01, PNorm = 35.2769, GNorm = 3.1010, lr_0 = 3.9019e-04
Loss = 1.3672e-01, PNorm = 35.2859, GNorm = 4.1971, lr_0 = 3.8119e-04
Validation rmse = 0.155914
Epoch 25
Loss = 1.2335e-01, PNorm = 35.2993, GNorm = 1.8551, lr_0 = 3.7239e-04
Loss = 1.2738e-01, PNorm = 35.3114, GNorm = 4.3385, lr_0 = 3.6379e-04
Validation rmse = 0.149719
Epoch 26
Loss = 1.1883e-01, PNorm = 35.3262, GNorm = 0.8059, lr_0 = 3.5456e-04
Validation rmse = 0.152478
Epoch 27
Loss = 8.8094e-02, PNorm = 35.3366, GNorm = 2.1777, lr_0 = 3.4638e-04
Loss = 1.2303e-01, PNorm = 35.3497, GNorm = 0.8043, lr_0 = 3.3839e-04
Validation rmse = 0.152258
Epoch 28
Loss = 1.0471e-01, PNorm = 35.3587, GNorm = 0.8902, lr_0 = 3.3057e-04
Loss = 1.1849e-01, PNorm = 35.3685, GNorm = 1.1932, lr_0 = 3.2294e-04
Validation rmse = 0.155106
Epoch 29
Loss = 1.1639e-01, PNorm = 35.3768, GNorm = 1.6685, lr_0 = 3.1549e-04
Loss = 1.1166e-01, PNorm = 35.3878, GNorm = 1.5183, lr_0 = 3.0821e-04
Validation rmse = 0.162870
Epoch 30
Loss = 1.1182e-01, PNorm = 35.3996, GNorm = 0.8006, lr_0 = 3.0039e-04
Loss = 1.1991e-01, PNorm = 35.4091, GNorm = 0.8077, lr_0 = 2.9346e-04
Validation rmse = 0.150206
Epoch 31
Loss = 1.1851e-01, PNorm = 35.4189, GNorm = 0.7050, lr_0 = 2.8668e-04
Validation rmse = 0.151672
Epoch 32
Loss = 7.0897e-02, PNorm = 35.4296, GNorm = 1.3829, lr_0 = 2.8007e-04
Loss = 9.5718e-02, PNorm = 35.4370, GNorm = 3.0639, lr_0 = 2.7360e-04
Validation rmse = 0.154973
Epoch 33
Loss = 1.0797e-01, PNorm = 35.4461, GNorm = 1.8318, lr_0 = 2.6729e-04
Loss = 1.1172e-01, PNorm = 35.4532, GNorm = 1.3150, lr_0 = 2.6112e-04
Validation rmse = 0.154593
Epoch 34
Loss = 1.1003e-01, PNorm = 35.4642, GNorm = 0.7258, lr_0 = 2.5450e-04
Loss = 1.0995e-01, PNorm = 35.4736, GNorm = 0.5546, lr_0 = 2.4862e-04
Validation rmse = 0.150585
Epoch 35
Loss = 1.1838e-01, PNorm = 35.4793, GNorm = 5.2232, lr_0 = 2.4288e-04
Validation rmse = 0.163331
Epoch 36
Loss = 1.8644e-01, PNorm = 35.4879, GNorm = 3.9015, lr_0 = 2.3728e-04
Loss = 9.3339e-02, PNorm = 35.4975, GNorm = 1.0174, lr_0 = 2.3180e-04
Validation rmse = 0.153451
Epoch 37
Loss = 9.8329e-02, PNorm = 35.5058, GNorm = 0.9282, lr_0 = 2.2645e-04
Loss = 1.0387e-01, PNorm = 35.5137, GNorm = 1.9201, lr_0 = 2.2122e-04
Validation rmse = 0.150790
Epoch 38
Loss = 8.7398e-02, PNorm = 35.5211, GNorm = 1.6138, lr_0 = 2.1561e-04
Loss = 1.1675e-01, PNorm = 35.5277, GNorm = 0.7551, lr_0 = 2.1063e-04
Validation rmse = 0.150078
Epoch 39
Loss = 1.0762e-01, PNorm = 35.5326, GNorm = 1.2010, lr_0 = 2.0577e-04
Loss = 9.9103e-02, PNorm = 35.5392, GNorm = 2.1310, lr_0 = 2.0102e-04
Validation rmse = 0.156130
Epoch 40
Loss = 9.8203e-02, PNorm = 35.5465, GNorm = 1.1699, lr_0 = 1.9638e-04
Validation rmse = 0.153320
Epoch 41
Loss = 7.3908e-02, PNorm = 35.5533, GNorm = 1.5957, lr_0 = 1.9185e-04
Loss = 1.0950e-01, PNorm = 35.5595, GNorm = 3.1058, lr_0 = 1.8742e-04
Validation rmse = 0.155069
Epoch 42
Loss = 1.2049e-01, PNorm = 35.5656, GNorm = 3.0064, lr_0 = 1.8267e-04
Loss = 1.0087e-01, PNorm = 35.5724, GNorm = 0.9422, lr_0 = 1.7845e-04
Validation rmse = 0.150465
Epoch 43
Loss = 1.0525e-01, PNorm = 35.5790, GNorm = 0.5345, lr_0 = 1.7433e-04
Loss = 9.9276e-02, PNorm = 35.5852, GNorm = 1.0243, lr_0 = 1.7031e-04
Validation rmse = 0.152549
Epoch 44
Loss = 9.6636e-02, PNorm = 35.5912, GNorm = 1.4029, lr_0 = 1.6638e-04
Validation rmse = 0.152477
Epoch 45
Loss = 8.2125e-02, PNorm = 35.5950, GNorm = 0.7924, lr_0 = 1.6254e-04
Loss = 1.1440e-01, PNorm = 35.6004, GNorm = 1.3556, lr_0 = 1.5879e-04
Validation rmse = 0.150751
Epoch 46
Loss = 8.7632e-02, PNorm = 35.6063, GNorm = 1.3230, lr_0 = 1.5476e-04
Loss = 1.1224e-01, PNorm = 35.6116, GNorm = 0.8578, lr_0 = 1.5119e-04
Validation rmse = 0.153009
Epoch 47
Loss = 1.0412e-01, PNorm = 35.6165, GNorm = 2.1636, lr_0 = 1.4770e-04
Loss = 9.4674e-02, PNorm = 35.6207, GNorm = 2.3450, lr_0 = 1.4429e-04
Validation rmse = 0.153306
Epoch 48
Loss = 9.8035e-02, PNorm = 35.6254, GNorm = 1.5166, lr_0 = 1.4096e-04
Loss = 9.6785e-02, PNorm = 35.6305, GNorm = 1.0718, lr_0 = 1.3770e-04
Validation rmse = 0.151220
Epoch 49
Loss = 9.7464e-02, PNorm = 35.6335, GNorm = 2.2681, lr_0 = 1.3453e-04
Validation rmse = 0.151865
Epoch 50
Loss = 8.0990e-02, PNorm = 35.6378, GNorm = 0.8065, lr_0 = 1.3142e-04
Loss = 1.0057e-01, PNorm = 35.6421, GNorm = 2.1921, lr_0 = 1.2839e-04
Validation rmse = 0.148947
Epoch 51
Loss = 1.1217e-01, PNorm = 35.6467, GNorm = 3.2256, lr_0 = 1.2513e-04
Loss = 9.2306e-02, PNorm = 35.6507, GNorm = 2.6670, lr_0 = 1.2224e-04
Validation rmse = 0.154123
Epoch 52
Loss = 9.3020e-02, PNorm = 35.6549, GNorm = 1.6593, lr_0 = 1.1942e-04
Loss = 1.0697e-01, PNorm = 35.6578, GNorm = 3.2972, lr_0 = 1.1666e-04
Validation rmse = 0.153338
Epoch 53
Loss = 9.4808e-02, PNorm = 35.6635, GNorm = 1.9918, lr_0 = 1.1397e-04
Validation rmse = 0.151244
Epoch 54
Loss = 6.1994e-02, PNorm = 35.6668, GNorm = 0.8930, lr_0 = 1.1134e-04
Loss = 1.0925e-01, PNorm = 35.6687, GNorm = 2.3686, lr_0 = 1.0877e-04
Validation rmse = 0.149994
Epoch 55
Loss = 1.0666e-01, PNorm = 35.6740, GNorm = 0.8693, lr_0 = 1.0601e-04
Loss = 1.0430e-01, PNorm = 35.6782, GNorm = 1.5943, lr_0 = 1.0356e-04
Validation rmse = 0.152285
Epoch 56
Loss = 9.1733e-02, PNorm = 35.6809, GNorm = 1.8399, lr_0 = 1.0117e-04
Loss = 9.7855e-02, PNorm = 35.6836, GNorm = 2.0754, lr_0 = 1.0000e-04
Validation rmse = 0.150090
Epoch 57
Loss = 9.4440e-02, PNorm = 35.6874, GNorm = 1.5413, lr_0 = 1.0000e-04
Loss = 9.2109e-02, PNorm = 35.6908, GNorm = 1.0958, lr_0 = 1.0000e-04
Validation rmse = 0.151973
Epoch 58
Loss = 9.3971e-02, PNorm = 35.6939, GNorm = 0.8321, lr_0 = 1.0000e-04
Validation rmse = 0.152390
Epoch 59
Loss = 9.5206e-02, PNorm = 35.6971, GNorm = 1.3340, lr_0 = 1.0000e-04
Loss = 9.3491e-02, PNorm = 35.7001, GNorm = 1.2439, lr_0 = 1.0000e-04
Validation rmse = 0.151518
Model 0 best validation rmse = 0.148947 on epoch 50
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.136863
Ensemble test rmse = 0.136863
1-fold cross validation
	Seed 0 ==> test rmse = 0.136863
Overall test rmse = 0.136863 +/- 0.000000
Elapsed time = 0:00:32
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,107 | train size = 880 | val size = 221 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.2543e-01, PNorm = 34.0159, GNorm = 2.2295, lr_0 = 3.9118e-04
Validation rmse = 0.265916
Epoch 1
Loss = 6.8940e-01, PNorm = 34.0436, GNorm = 1.3479, lr_0 = 6.8235e-04
Loss = 6.0633e-01, PNorm = 34.0960, GNorm = 2.7042, lr_0 = 9.4706e-04
Validation rmse = 0.238912
Epoch 2
Loss = 5.2260e-01, PNorm = 34.1750, GNorm = 6.8259, lr_0 = 9.8149e-04
Loss = 4.2273e-01, PNorm = 34.2395, GNorm = 3.9581, lr_0 = 9.5884e-04
Validation rmse = 0.272765
Epoch 3
Loss = 4.6816e-01, PNorm = 34.3019, GNorm = 11.0225, lr_0 = 9.3452e-04
Loss = 4.6700e-01, PNorm = 34.3585, GNorm = 3.8987, lr_0 = 9.1295e-04
Validation rmse = 0.231615
Epoch 4
Loss = 4.6343e-01, PNorm = 34.4052, GNorm = 1.0661, lr_0 = 8.9188e-04
Validation rmse = 0.208178
Epoch 5
Loss = 3.8199e-01, PNorm = 34.4503, GNorm = 1.4075, lr_0 = 8.7129e-04
Loss = 2.8192e-01, PNorm = 34.4958, GNorm = 3.2586, lr_0 = 8.5118e-04
Validation rmse = 0.185845
Epoch 6
Loss = 2.7403e-01, PNorm = 34.5510, GNorm = 4.4375, lr_0 = 8.2959e-04
Loss = 2.5358e-01, PNorm = 34.5907, GNorm = 3.1148, lr_0 = 8.1044e-04
Validation rmse = 0.182052
Epoch 7
Loss = 2.6123e-01, PNorm = 34.6282, GNorm = 1.8860, lr_0 = 7.9174e-04
Loss = 2.1102e-01, PNorm = 34.6650, GNorm = 1.9974, lr_0 = 7.7346e-04
Loss = 9.2833e-02, PNorm = 34.6689, GNorm = 0.7744, lr_0 = 7.7166e-04
Validation rmse = 0.161221
Epoch 8
Loss = 1.8687e-01, PNorm = 34.7068, GNorm = 1.6525, lr_0 = 7.5384e-04
Validation rmse = 0.186960
Epoch 9
Loss = 2.4419e-01, PNorm = 34.7424, GNorm = 5.1149, lr_0 = 7.3644e-04
Loss = 2.1977e-01, PNorm = 34.7764, GNorm = 1.2721, lr_0 = 7.1945e-04
Validation rmse = 0.161670
Epoch 10
Loss = 2.0270e-01, PNorm = 34.8051, GNorm = 2.1907, lr_0 = 7.0284e-04
Loss = 1.9180e-01, PNorm = 34.8317, GNorm = 0.9020, lr_0 = 6.8662e-04
Validation rmse = 0.163297
Epoch 11
Loss = 1.8155e-01, PNorm = 34.8581, GNorm = 1.3246, lr_0 = 6.6920e-04
Loss = 1.8147e-01, PNorm = 34.8850, GNorm = 1.2951, lr_0 = 6.5376e-04
Validation rmse = 0.170223
Epoch 12
Loss = 1.7814e-01, PNorm = 34.9106, GNorm = 2.7025, lr_0 = 6.3867e-04
Validation rmse = 0.155306
Epoch 13
Loss = 1.1789e-01, PNorm = 34.9388, GNorm = 0.5422, lr_0 = 6.2247e-04
Loss = 1.7125e-01, PNorm = 34.9591, GNorm = 3.1446, lr_0 = 6.0810e-04
Validation rmse = 0.155889
Epoch 14
Loss = 1.4780e-01, PNorm = 34.9795, GNorm = 1.0355, lr_0 = 5.9406e-04
Loss = 1.4297e-01, PNorm = 34.9998, GNorm = 0.7072, lr_0 = 5.8035e-04
Validation rmse = 0.158491
Epoch 15
Loss = 1.3580e-01, PNorm = 35.0170, GNorm = 1.1125, lr_0 = 5.6696e-04
Loss = 1.5716e-01, PNorm = 35.0386, GNorm = 2.3187, lr_0 = 5.5387e-04
Validation rmse = 0.172266
Epoch 16
Loss = 1.4783e-01, PNorm = 35.0626, GNorm = 0.6314, lr_0 = 5.3982e-04
Validation rmse = 0.159643
Epoch 17
Loss = 1.6439e-01, PNorm = 35.0782, GNorm = 1.1232, lr_0 = 5.2736e-04
Loss = 1.4000e-01, PNorm = 35.0963, GNorm = 1.1513, lr_0 = 5.1519e-04
Validation rmse = 0.153323
Epoch 18
Loss = 1.5913e-01, PNorm = 35.1201, GNorm = 5.3265, lr_0 = 5.0212e-04
Loss = 1.4131e-01, PNorm = 35.1403, GNorm = 4.5197, lr_0 = 4.9053e-04
Validation rmse = 0.160892
Epoch 19
Loss = 1.2631e-01, PNorm = 35.1625, GNorm = 1.9060, lr_0 = 4.7921e-04
Loss = 1.4605e-01, PNorm = 35.1794, GNorm = 2.5902, lr_0 = 4.6815e-04
Validation rmse = 0.166319
Epoch 20
Loss = 1.5068e-01, PNorm = 35.1984, GNorm = 2.4749, lr_0 = 4.5734e-04
Validation rmse = 0.155606
Epoch 21
Loss = 1.1511e-01, PNorm = 35.2147, GNorm = 2.7207, lr_0 = 4.4575e-04
Loss = 1.2573e-01, PNorm = 35.2282, GNorm = 0.8670, lr_0 = 4.3546e-04
Validation rmse = 0.153043
Epoch 22
Loss = 1.0527e-01, PNorm = 35.2444, GNorm = 1.0140, lr_0 = 4.2541e-04
Loss = 1.1967e-01, PNorm = 35.2604, GNorm = 1.4608, lr_0 = 4.1559e-04
Validation rmse = 0.153795
Epoch 23
Loss = 9.8669e-02, PNorm = 35.2718, GNorm = 0.4587, lr_0 = 4.0505e-04
Loss = 1.2934e-01, PNorm = 35.2847, GNorm = 1.5272, lr_0 = 3.9570e-04
Validation rmse = 0.155347
Epoch 24
Loss = 1.0716e-01, PNorm = 35.3022, GNorm = 1.0373, lr_0 = 3.8656e-04
Loss = 1.1748e-01, PNorm = 35.3150, GNorm = 3.4409, lr_0 = 3.7764e-04
Validation rmse = 0.157430
Epoch 25
Loss = 1.0963e-01, PNorm = 35.3283, GNorm = 1.7437, lr_0 = 3.6892e-04
Validation rmse = 0.165793
Epoch 26
Loss = 1.5001e-01, PNorm = 35.3436, GNorm = 6.6045, lr_0 = 3.5957e-04
Loss = 1.1736e-01, PNorm = 35.3561, GNorm = 2.1407, lr_0 = 3.5127e-04
Validation rmse = 0.157182
Epoch 27
Loss = 1.1212e-01, PNorm = 35.3676, GNorm = 1.8881, lr_0 = 3.4316e-04
Loss = 1.0812e-01, PNorm = 35.3787, GNorm = 1.3356, lr_0 = 3.3524e-04
Validation rmse = 0.158243
Epoch 28
Loss = 1.1513e-01, PNorm = 35.3938, GNorm = 1.0407, lr_0 = 3.2674e-04
Loss = 9.7340e-02, PNorm = 35.4051, GNorm = 0.8939, lr_0 = 3.1920e-04
Validation rmse = 0.157774
Epoch 29
Loss = 1.0100e-01, PNorm = 35.4155, GNorm = 0.5531, lr_0 = 3.1183e-04
Validation rmse = 0.170061
Epoch 30
Loss = 1.2979e-01, PNorm = 35.4260, GNorm = 2.3583, lr_0 = 3.0463e-04
Loss = 1.1136e-01, PNorm = 35.4354, GNorm = 2.0875, lr_0 = 2.9760e-04
Validation rmse = 0.158881
Epoch 31
Loss = 1.0436e-01, PNorm = 35.4494, GNorm = 0.9383, lr_0 = 2.9005e-04
Loss = 1.0032e-01, PNorm = 35.4600, GNorm = 0.8962, lr_0 = 2.8336e-04
Validation rmse = 0.160558
Epoch 32
Loss = 8.5115e-02, PNorm = 35.4699, GNorm = 0.9854, lr_0 = 2.7682e-04
Loss = 1.0688e-01, PNorm = 35.4809, GNorm = 0.7568, lr_0 = 2.7043e-04
Loss = 1.1207e-01, PNorm = 35.4817, GNorm = 1.1214, lr_0 = 2.6980e-04
Validation rmse = 0.163694
Epoch 33
Loss = 9.8489e-02, PNorm = 35.4912, GNorm = 0.7306, lr_0 = 2.6357e-04
Validation rmse = 0.156037
Epoch 34
Loss = 1.2892e-01, PNorm = 35.5001, GNorm = 0.6574, lr_0 = 2.5748e-04
Loss = 8.3948e-02, PNorm = 35.5076, GNorm = 1.0878, lr_0 = 2.5154e-04
Validation rmse = 0.161300
Epoch 35
Loss = 8.8638e-02, PNorm = 35.5156, GNorm = 0.5241, lr_0 = 2.4573e-04
Loss = 9.8268e-02, PNorm = 35.5245, GNorm = 1.2540, lr_0 = 2.4006e-04
Validation rmse = 0.157462
Epoch 36
Loss = 1.1089e-01, PNorm = 35.5323, GNorm = 0.9845, lr_0 = 2.3397e-04
Loss = 9.0350e-02, PNorm = 35.5416, GNorm = 1.1562, lr_0 = 2.2857e-04
Validation rmse = 0.162110
Epoch 37
Loss = 7.8521e-02, PNorm = 35.5470, GNorm = 1.2392, lr_0 = 2.2330e-04
Validation rmse = 0.159413
Epoch 38
Loss = 1.1742e-01, PNorm = 35.5568, GNorm = 0.8703, lr_0 = 2.1763e-04
Loss = 8.7887e-02, PNorm = 35.5636, GNorm = 0.5130, lr_0 = 2.1261e-04
Validation rmse = 0.160080
Epoch 39
Loss = 8.8288e-02, PNorm = 35.5707, GNorm = 0.7624, lr_0 = 2.0770e-04
Loss = 1.0136e-01, PNorm = 35.5767, GNorm = 1.2914, lr_0 = 2.0291e-04
Validation rmse = 0.157264
Epoch 40
Loss = 8.6713e-02, PNorm = 35.5829, GNorm = 0.6589, lr_0 = 1.9823e-04
Loss = 9.0753e-02, PNorm = 35.5891, GNorm = 0.8733, lr_0 = 1.9365e-04
Validation rmse = 0.161313
Epoch 41
Loss = 8.9784e-02, PNorm = 35.5961, GNorm = 0.4296, lr_0 = 1.8874e-04
Validation rmse = 0.157995
Epoch 42
Loss = 9.8635e-02, PNorm = 35.6023, GNorm = 1.2844, lr_0 = 1.8438e-04
Loss = 9.1464e-02, PNorm = 35.6079, GNorm = 1.1742, lr_0 = 1.8013e-04
Validation rmse = 0.158512
Epoch 43
Loss = 8.9730e-02, PNorm = 35.6139, GNorm = 1.1581, lr_0 = 1.7556e-04
Loss = 9.5356e-02, PNorm = 35.6207, GNorm = 1.0050, lr_0 = 1.7151e-04
Validation rmse = 0.159877
Epoch 44
Loss = 8.9368e-02, PNorm = 35.6258, GNorm = 1.8406, lr_0 = 1.6755e-04
Loss = 9.4508e-02, PNorm = 35.6309, GNorm = 0.9402, lr_0 = 1.6368e-04
Validation rmse = 0.156718
Epoch 45
Loss = 9.2747e-02, PNorm = 35.6362, GNorm = 0.7849, lr_0 = 1.5990e-04
Validation rmse = 0.160663
Epoch 46
Loss = 8.5400e-02, PNorm = 35.6436, GNorm = 0.5775, lr_0 = 1.5585e-04
Loss = 9.0863e-02, PNorm = 35.6475, GNorm = 2.3755, lr_0 = 1.5225e-04
Validation rmse = 0.159149
Epoch 47
Loss = 1.0661e-01, PNorm = 35.6533, GNorm = 0.6338, lr_0 = 1.4874e-04
Loss = 7.6537e-02, PNorm = 35.6578, GNorm = 2.3329, lr_0 = 1.4530e-04
Validation rmse = 0.162957
Epoch 48
Loss = 7.9433e-02, PNorm = 35.6627, GNorm = 1.1668, lr_0 = 1.4162e-04
Loss = 9.3102e-02, PNorm = 35.6670, GNorm = 0.6491, lr_0 = 1.3835e-04
Validation rmse = 0.159611
Epoch 49
Loss = 7.9501e-02, PNorm = 35.6713, GNorm = 1.0102, lr_0 = 1.3515e-04
Loss = 8.7858e-02, PNorm = 35.6762, GNorm = 1.5606, lr_0 = 1.3204e-04
Validation rmse = 0.159376
Epoch 50
Loss = 8.8579e-02, PNorm = 35.6800, GNorm = 2.0917, lr_0 = 1.2899e-04
Validation rmse = 0.158184
Epoch 51
Loss = 8.1676e-02, PNorm = 35.6849, GNorm = 1.5269, lr_0 = 1.2572e-04
Loss = 8.0967e-02, PNorm = 35.6888, GNorm = 0.9400, lr_0 = 1.2281e-04
Validation rmse = 0.158812
Epoch 52
Loss = 7.8388e-02, PNorm = 35.6921, GNorm = 0.5156, lr_0 = 1.1998e-04
Loss = 9.0745e-02, PNorm = 35.6959, GNorm = 1.1482, lr_0 = 1.1721e-04
Validation rmse = 0.158728
Epoch 53
Loss = 7.5442e-02, PNorm = 35.7003, GNorm = 0.5408, lr_0 = 1.1424e-04
Loss = 8.7261e-02, PNorm = 35.7039, GNorm = 1.2324, lr_0 = 1.1160e-04
Validation rmse = 0.160911
Epoch 54
Loss = 8.7304e-02, PNorm = 35.7079, GNorm = 2.7632, lr_0 = 1.0902e-04
Validation rmse = 0.160233
Epoch 55
Loss = 7.2849e-02, PNorm = 35.7112, GNorm = 1.9423, lr_0 = 1.0651e-04
Loss = 7.8780e-02, PNorm = 35.7148, GNorm = 1.1156, lr_0 = 1.0405e-04
Validation rmse = 0.158634
Epoch 56
Loss = 8.0552e-02, PNorm = 35.7178, GNorm = 2.0959, lr_0 = 1.0141e-04
Loss = 8.5501e-02, PNorm = 35.7218, GNorm = 0.5799, lr_0 = 1.0000e-04
Validation rmse = 0.160131
Epoch 57
Loss = 7.4738e-02, PNorm = 35.7247, GNorm = 1.2639, lr_0 = 1.0000e-04
Loss = 8.8086e-02, PNorm = 35.7270, GNorm = 0.8538, lr_0 = 1.0000e-04
Loss = 5.6102e-02, PNorm = 35.7272, GNorm = 1.7803, lr_0 = 1.0000e-04
Validation rmse = 0.162109
Epoch 58
Loss = 8.0256e-02, PNorm = 35.7313, GNorm = 1.5211, lr_0 = 1.0000e-04
Validation rmse = 0.162253
Epoch 59
Loss = 7.8174e-02, PNorm = 35.7341, GNorm = 0.7926, lr_0 = 1.0000e-04
Loss = 7.9788e-02, PNorm = 35.7370, GNorm = 2.2541, lr_0 = 1.0000e-04
Validation rmse = 0.159904
Model 0 best validation rmse = 0.153043 on epoch 21
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.179543
Ensemble test rmse = 0.179543
1-fold cross validation
	Seed 0 ==> test rmse = 0.179543
Overall test rmse = 0.179543 +/- 0.000000
Elapsed time = 0:00:31
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,097 | train size = 872 | val size = 219 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.6844e-01, PNorm = 34.0173, GNorm = 3.0120, lr_0 = 3.9118e-04
Validation rmse = 0.304800
Epoch 1
Loss = 8.6977e-01, PNorm = 34.0468, GNorm = 13.7490, lr_0 = 6.8235e-04
Loss = 5.1564e-01, PNorm = 34.0914, GNorm = 1.6828, lr_0 = 9.4706e-04
Validation rmse = 0.369735
Epoch 2
Loss = 8.3260e-01, PNorm = 34.1548, GNorm = 1.2653, lr_0 = 9.7920e-04
Loss = 5.6039e-01, PNorm = 34.2159, GNorm = 1.6575, lr_0 = 9.5660e-04
Validation rmse = 0.243841
Epoch 3
Loss = 4.2509e-01, PNorm = 34.2772, GNorm = 2.3152, lr_0 = 9.3452e-04
Validation rmse = 0.219074
Epoch 4
Loss = 3.9929e-01, PNorm = 34.3380, GNorm = 2.7345, lr_0 = 9.1082e-04
Loss = 3.1631e-01, PNorm = 34.3881, GNorm = 1.1633, lr_0 = 8.8980e-04
Validation rmse = 0.200213
Epoch 5
Loss = 3.3443e-01, PNorm = 34.4332, GNorm = 3.9524, lr_0 = 8.6926e-04
Loss = 2.5274e-01, PNorm = 34.4790, GNorm = 4.3589, lr_0 = 8.4919e-04
Validation rmse = 0.212940
Epoch 6
Loss = 3.0632e-01, PNorm = 34.5243, GNorm = 1.1645, lr_0 = 8.2766e-04
Loss = 2.2175e-01, PNorm = 34.5652, GNorm = 2.3835, lr_0 = 8.0855e-04
Validation rmse = 0.179673
Epoch 7
Loss = 2.5148e-01, PNorm = 34.6058, GNorm = 2.7330, lr_0 = 7.8989e-04
Validation rmse = 0.185808
Epoch 8
Loss = 2.4471e-01, PNorm = 34.6414, GNorm = 3.3509, lr_0 = 7.6986e-04
Loss = 2.0403e-01, PNorm = 34.6789, GNorm = 2.7679, lr_0 = 7.5209e-04
Validation rmse = 0.165323
Epoch 9
Loss = 1.5926e-01, PNorm = 34.7123, GNorm = 1.0601, lr_0 = 7.3301e-04
Loss = 1.7768e-01, PNorm = 34.7457, GNorm = 1.2067, lr_0 = 7.1609e-04
Validation rmse = 0.163216
Epoch 10
Loss = 1.6330e-01, PNorm = 34.7767, GNorm = 1.4648, lr_0 = 6.9956e-04
Loss = 1.6139e-01, PNorm = 34.8043, GNorm = 1.1731, lr_0 = 6.8342e-04
Validation rmse = 0.160736
Epoch 11
Loss = 1.6049e-01, PNorm = 34.8333, GNorm = 1.5142, lr_0 = 6.6608e-04
Validation rmse = 0.168634
Epoch 12
Loss = 2.0261e-01, PNorm = 34.8604, GNorm = 2.8856, lr_0 = 6.5071e-04
Loss = 1.6050e-01, PNorm = 34.8838, GNorm = 1.0518, lr_0 = 6.3569e-04
Validation rmse = 0.158634
Epoch 13
Loss = 1.3045e-01, PNorm = 34.9122, GNorm = 0.8270, lr_0 = 6.1957e-04
Loss = 1.6309e-01, PNorm = 34.9261, GNorm = 3.8906, lr_0 = 6.0527e-04
Validation rmse = 0.159511
Epoch 14
Loss = 1.3100e-01, PNorm = 34.9474, GNorm = 1.6083, lr_0 = 5.9130e-04
Loss = 1.5704e-01, PNorm = 34.9683, GNorm = 4.3181, lr_0 = 5.7765e-04
Validation rmse = 0.161705
Epoch 15
Loss = 1.3215e-01, PNorm = 34.9912, GNorm = 1.6104, lr_0 = 5.6300e-04
Validation rmse = 0.156213
Epoch 16
Loss = 1.5001e-01, PNorm = 35.0047, GNorm = 1.9692, lr_0 = 5.5000e-04
Loss = 1.4058e-01, PNorm = 35.0236, GNorm = 1.4623, lr_0 = 5.3731e-04
Validation rmse = 0.157947
Epoch 17
Loss = 1.2897e-01, PNorm = 35.0424, GNorm = 3.0320, lr_0 = 5.2368e-04
Loss = 1.2141e-01, PNorm = 35.0578, GNorm = 1.0421, lr_0 = 5.1159e-04
Validation rmse = 0.155997
Epoch 18
Loss = 1.3999e-01, PNorm = 35.0818, GNorm = 1.3248, lr_0 = 4.9862e-04
Loss = 1.2386e-01, PNorm = 35.0953, GNorm = 1.3872, lr_0 = 4.8711e-04
Validation rmse = 0.156425
Epoch 19
Loss = 1.3226e-01, PNorm = 35.1118, GNorm = 1.2110, lr_0 = 4.7587e-04
Validation rmse = 0.154680
Epoch 20
Loss = 8.3775e-02, PNorm = 35.1275, GNorm = 2.0719, lr_0 = 4.6380e-04
Loss = 1.3873e-01, PNorm = 35.1415, GNorm = 1.3160, lr_0 = 4.5309e-04
Validation rmse = 0.153803
Epoch 21
Loss = 1.1267e-01, PNorm = 35.1546, GNorm = 0.8304, lr_0 = 4.4263e-04
Loss = 1.1678e-01, PNorm = 35.1673, GNorm = 1.0142, lr_0 = 4.3242e-04
Validation rmse = 0.152361
Epoch 22
Loss = 1.2940e-01, PNorm = 35.1827, GNorm = 0.8897, lr_0 = 4.2145e-04
Loss = 1.0740e-01, PNorm = 35.1948, GNorm = 0.8676, lr_0 = 4.1172e-04
Validation rmse = 0.154985
Epoch 23
Loss = 1.2339e-01, PNorm = 35.2079, GNorm = 2.0917, lr_0 = 4.0222e-04
Validation rmse = 0.156903
Epoch 24
Loss = 1.0483e-01, PNorm = 35.2206, GNorm = 2.1264, lr_0 = 3.9202e-04
Loss = 1.2745e-01, PNorm = 35.2320, GNorm = 2.7946, lr_0 = 3.8297e-04
Validation rmse = 0.153703
Epoch 25
Loss = 9.4882e-02, PNorm = 35.2454, GNorm = 0.7469, lr_0 = 3.7413e-04
Loss = 1.1554e-01, PNorm = 35.2546, GNorm = 2.2461, lr_0 = 3.6549e-04
Validation rmse = 0.151503
Epoch 26
Loss = 1.0362e-01, PNorm = 35.2691, GNorm = 0.8703, lr_0 = 3.5622e-04
Loss = 1.1245e-01, PNorm = 35.2792, GNorm = 2.9823, lr_0 = 3.4800e-04
Loss = 9.8441e-02, PNorm = 35.2800, GNorm = 1.3483, lr_0 = 3.4719e-04
Validation rmse = 0.151114
Epoch 27
Loss = 1.1329e-01, PNorm = 35.2907, GNorm = 0.8454, lr_0 = 3.3918e-04
Validation rmse = 0.151470
Epoch 28
Loss = 9.3481e-02, PNorm = 35.3007, GNorm = 1.1289, lr_0 = 3.3135e-04
Loss = 1.1725e-01, PNorm = 35.3105, GNorm = 0.7754, lr_0 = 3.2370e-04
Validation rmse = 0.152067
Epoch 29
Loss = 1.2213e-01, PNorm = 35.3253, GNorm = 3.2536, lr_0 = 3.1549e-04
Loss = 1.1009e-01, PNorm = 35.3336, GNorm = 1.2645, lr_0 = 3.0821e-04
Validation rmse = 0.150169
Epoch 30
Loss = 1.0804e-01, PNorm = 35.3416, GNorm = 0.5990, lr_0 = 3.0109e-04
Loss = 1.0669e-01, PNorm = 35.3521, GNorm = 2.7232, lr_0 = 2.9414e-04
Loss = 1.2146e-01, PNorm = 35.3526, GNorm = 1.8722, lr_0 = 2.9346e-04
Validation rmse = 0.149636
Epoch 31
Loss = 1.1436e-01, PNorm = 35.3611, GNorm = 0.8941, lr_0 = 2.8668e-04
Validation rmse = 0.149004
Epoch 32
Loss = 6.3733e-02, PNorm = 35.3705, GNorm = 0.7047, lr_0 = 2.8007e-04
Loss = 9.6305e-02, PNorm = 35.3771, GNorm = 0.9240, lr_0 = 2.7360e-04
Validation rmse = 0.151204
Epoch 33
Loss = 1.0568e-01, PNorm = 35.3853, GNorm = 0.6535, lr_0 = 2.6666e-04
Loss = 1.0187e-01, PNorm = 35.3946, GNorm = 2.0318, lr_0 = 2.6051e-04
Validation rmse = 0.151154
Epoch 34
Loss = 1.1948e-01, PNorm = 35.4065, GNorm = 3.2698, lr_0 = 2.5390e-04
Loss = 1.0314e-01, PNorm = 35.4135, GNorm = 1.2864, lr_0 = 2.4804e-04
Validation rmse = 0.152182
Epoch 35
Loss = 9.9511e-02, PNorm = 35.4210, GNorm = 1.6566, lr_0 = 2.4232e-04
Validation rmse = 0.148544
Epoch 36
Loss = 8.9017e-02, PNorm = 35.4289, GNorm = 1.1126, lr_0 = 2.3617e-04
Loss = 1.0515e-01, PNorm = 35.4348, GNorm = 2.0535, lr_0 = 2.3072e-04
Validation rmse = 0.149475
Epoch 37
Loss = 1.1416e-01, PNorm = 35.4416, GNorm = 1.7174, lr_0 = 2.2539e-04
Loss = 9.5027e-02, PNorm = 35.4474, GNorm = 0.8673, lr_0 = 2.2019e-04
Validation rmse = 0.150841
Epoch 38
Loss = 1.1178e-01, PNorm = 35.4565, GNorm = 2.5853, lr_0 = 2.1461e-04
Loss = 1.0366e-01, PNorm = 35.4629, GNorm = 3.1258, lr_0 = 2.0965e-04
Validation rmse = 0.150242
Epoch 39
Loss = 1.0680e-01, PNorm = 35.4696, GNorm = 2.6138, lr_0 = 2.0481e-04
Validation rmse = 0.151280
Epoch 40
Loss = 9.1205e-02, PNorm = 35.4766, GNorm = 0.9175, lr_0 = 1.9962e-04
Loss = 8.8261e-02, PNorm = 35.4835, GNorm = 2.6115, lr_0 = 1.9501e-04
Validation rmse = 0.148097
Epoch 41
Loss = 9.8873e-02, PNorm = 35.4886, GNorm = 2.2069, lr_0 = 1.9051e-04
Loss = 1.0119e-01, PNorm = 35.4931, GNorm = 1.6298, lr_0 = 1.8611e-04
Validation rmse = 0.147828
Epoch 42
Loss = 9.5513e-02, PNorm = 35.4990, GNorm = 1.9982, lr_0 = 1.8139e-04
Validation rmse = 0.148789
Epoch 43
Loss = 7.1191e-02, PNorm = 35.5041, GNorm = 0.5704, lr_0 = 1.7679e-04
Loss = 9.6622e-02, PNorm = 35.5091, GNorm = 2.3704, lr_0 = 1.7271e-04
Validation rmse = 0.148125
Epoch 44
Loss = 1.1454e-01, PNorm = 35.5149, GNorm = 2.1315, lr_0 = 1.6873e-04
Loss = 8.9954e-02, PNorm = 35.5197, GNorm = 0.8302, lr_0 = 1.6483e-04
Validation rmse = 0.149832
Epoch 45
Loss = 9.6778e-02, PNorm = 35.5251, GNorm = 1.0800, lr_0 = 1.6065e-04
Loss = 8.5462e-02, PNorm = 35.5296, GNorm = 1.7719, lr_0 = 1.5694e-04
Validation rmse = 0.149432
Epoch 46
Loss = 9.4532e-02, PNorm = 35.5353, GNorm = 0.7700, lr_0 = 1.5332e-04
Validation rmse = 0.148045
Epoch 47
Loss = 7.5412e-02, PNorm = 35.5398, GNorm = 0.4770, lr_0 = 1.4943e-04
Loss = 9.3825e-02, PNorm = 35.5434, GNorm = 0.8289, lr_0 = 1.4598e-04
Validation rmse = 0.148688
Epoch 48
Loss = 7.3209e-02, PNorm = 35.5482, GNorm = 1.0887, lr_0 = 1.4261e-04
Loss = 9.3303e-02, PNorm = 35.5529, GNorm = 0.7978, lr_0 = 1.3932e-04
Validation rmse = 0.147989
Epoch 49
Loss = 1.0097e-01, PNorm = 35.5566, GNorm = 0.8246, lr_0 = 1.3579e-04
Loss = 8.4173e-02, PNorm = 35.5602, GNorm = 1.9469, lr_0 = 1.3265e-04
Validation rmse = 0.147916
Epoch 50
Loss = 8.8802e-02, PNorm = 35.5642, GNorm = 1.3758, lr_0 = 1.2959e-04
Validation rmse = 0.147898
Epoch 51
Loss = 8.9791e-02, PNorm = 35.5677, GNorm = 0.7816, lr_0 = 1.2630e-04
Loss = 8.4518e-02, PNorm = 35.5701, GNorm = 0.8688, lr_0 = 1.2339e-04
Validation rmse = 0.148923
Epoch 52
Loss = 8.7816e-02, PNorm = 35.5750, GNorm = 0.8739, lr_0 = 1.2026e-04
Loss = 9.3201e-02, PNorm = 35.5784, GNorm = 2.1262, lr_0 = 1.1748e-04
Validation rmse = 0.149314
Epoch 53
Loss = 8.4749e-02, PNorm = 35.5819, GNorm = 0.6748, lr_0 = 1.1477e-04
Loss = 9.2349e-02, PNorm = 35.5850, GNorm = 1.1294, lr_0 = 1.1212e-04
Validation rmse = 0.147628
Epoch 54
Loss = 9.0027e-02, PNorm = 35.5891, GNorm = 0.5781, lr_0 = 1.0928e-04
Validation rmse = 0.148025
Epoch 55
Loss = 1.2805e-01, PNorm = 35.5921, GNorm = 2.0561, lr_0 = 1.0676e-04
Loss = 8.9104e-02, PNorm = 35.5949, GNorm = 0.8932, lr_0 = 1.0429e-04
Validation rmse = 0.149058
Epoch 56
Loss = 9.1255e-02, PNorm = 35.5981, GNorm = 2.7811, lr_0 = 1.0165e-04
Loss = 8.4723e-02, PNorm = 35.6018, GNorm = 1.6654, lr_0 = 1.0000e-04
Validation rmse = 0.147658
Epoch 57
Loss = 8.4829e-02, PNorm = 35.6045, GNorm = 1.3182, lr_0 = 1.0000e-04
Loss = 9.4502e-02, PNorm = 35.6063, GNorm = 1.1297, lr_0 = 1.0000e-04
Validation rmse = 0.147885
Epoch 58
Loss = 8.7006e-02, PNorm = 35.6103, GNorm = 1.1857, lr_0 = 1.0000e-04
Validation rmse = 0.147182
Epoch 59
Loss = 6.7815e-02, PNorm = 35.6136, GNorm = 1.0012, lr_0 = 1.0000e-04
Loss = 8.8954e-02, PNorm = 35.6160, GNorm = 0.7031, lr_0 = 1.0000e-04
Validation rmse = 0.146892
Model 0 best validation rmse = 0.146892 on epoch 59
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.145650
Ensemble test rmse = 0.145650
1-fold cross validation
	Seed 0 ==> test rmse = 0.145650
Overall test rmse = 0.145650 +/- 0.000000
Elapsed time = 0:00:32
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,087 | train size = 864 | val size = 217 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1607e-01, PNorm = 34.0173, GNorm = 2.8974, lr_0 = 3.9118e-04
Validation rmse = 0.289827
Epoch 1
Loss = 6.3723e-01, PNorm = 34.0490, GNorm = 4.5927, lr_0 = 6.8235e-04
Loss = 6.1177e-01, PNorm = 34.0975, GNorm = 4.6972, lr_0 = 9.4706e-04
Validation rmse = 0.257786
Epoch 2
Loss = 4.4997e-01, PNorm = 34.1747, GNorm = 2.0835, lr_0 = 9.7920e-04
Loss = 4.4674e-01, PNorm = 34.2367, GNorm = 3.5376, lr_0 = 9.5660e-04
Validation rmse = 0.247226
Epoch 3
Loss = 4.0422e-01, PNorm = 34.3026, GNorm = 6.3756, lr_0 = 9.3234e-04
Validation rmse = 0.204621
Epoch 4
Loss = 3.8278e-01, PNorm = 34.3575, GNorm = 1.8099, lr_0 = 9.1082e-04
Loss = 3.1167e-01, PNorm = 34.4104, GNorm = 5.2681, lr_0 = 8.8980e-04
Validation rmse = 0.231219
Epoch 5
Loss = 3.1281e-01, PNorm = 34.4585, GNorm = 8.4449, lr_0 = 8.6723e-04
Loss = 3.1174e-01, PNorm = 34.5024, GNorm = 1.1553, lr_0 = 8.4721e-04
Validation rmse = 0.212431
Epoch 6
Loss = 2.9057e-01, PNorm = 34.5534, GNorm = 3.0117, lr_0 = 8.2573e-04
Loss = 2.8688e-01, PNorm = 34.5915, GNorm = 2.2973, lr_0 = 8.0667e-04
Loss = 3.4349e-01, PNorm = 34.5949, GNorm = 7.4291, lr_0 = 8.0478e-04
Validation rmse = 0.197198
Epoch 7
Loss = 2.3406e-01, PNorm = 34.6323, GNorm = 2.8713, lr_0 = 7.8621e-04
Validation rmse = 0.199289
Epoch 8
Loss = 2.6897e-01, PNorm = 34.6695, GNorm = 2.5566, lr_0 = 7.6806e-04
Loss = 1.8657e-01, PNorm = 34.7035, GNorm = 0.7636, lr_0 = 7.5033e-04
Validation rmse = 0.174234
Epoch 9
Loss = 1.9156e-01, PNorm = 34.7368, GNorm = 0.9023, lr_0 = 7.3130e-04
Loss = 1.7347e-01, PNorm = 34.7698, GNorm = 1.4484, lr_0 = 7.1442e-04
Validation rmse = 0.167889
Epoch 10
Loss = 1.5585e-01, PNorm = 34.7979, GNorm = 1.0925, lr_0 = 6.9630e-04
Loss = 1.6286e-01, PNorm = 34.8263, GNorm = 1.2724, lr_0 = 6.8023e-04
Validation rmse = 0.171269
Epoch 11
Loss = 1.6251e-01, PNorm = 34.8516, GNorm = 1.8003, lr_0 = 6.6453e-04
Validation rmse = 0.160147
Epoch 12
Loss = 1.1583e-01, PNorm = 34.8785, GNorm = 2.7164, lr_0 = 6.4768e-04
Loss = 1.6449e-01, PNorm = 34.8951, GNorm = 2.5176, lr_0 = 6.3273e-04
Validation rmse = 0.160605
Epoch 13
Loss = 1.5825e-01, PNorm = 34.9200, GNorm = 2.4410, lr_0 = 6.1668e-04
Loss = 1.3732e-01, PNorm = 34.9447, GNorm = 0.9889, lr_0 = 6.0245e-04
Validation rmse = 0.173090
Epoch 14
Loss = 1.5984e-01, PNorm = 34.9608, GNorm = 0.7833, lr_0 = 5.8717e-04
Validation rmse = 0.162665
Epoch 15
Loss = 1.5539e-01, PNorm = 34.9863, GNorm = 0.9287, lr_0 = 5.7362e-04
Loss = 1.7285e-01, PNorm = 35.0065, GNorm = 1.0870, lr_0 = 5.6037e-04
Validation rmse = 0.163499
Epoch 16
Loss = 1.5410e-01, PNorm = 35.0315, GNorm = 3.5900, lr_0 = 5.4616e-04
Loss = 1.2605e-01, PNorm = 35.0519, GNorm = 1.4775, lr_0 = 5.3356e-04
Validation rmse = 0.159456
Epoch 17
Loss = 1.2778e-01, PNorm = 35.0701, GNorm = 1.4352, lr_0 = 5.2003e-04
Loss = 1.2850e-01, PNorm = 35.0881, GNorm = 2.7070, lr_0 = 5.0802e-04
Validation rmse = 0.152528
Epoch 18
Loss = 1.1050e-01, PNorm = 35.1049, GNorm = 1.8516, lr_0 = 4.9630e-04
Validation rmse = 0.152393
Epoch 19
Loss = 1.2546e-01, PNorm = 35.1234, GNorm = 1.8760, lr_0 = 4.8371e-04
Loss = 1.0951e-01, PNorm = 35.1374, GNorm = 1.4875, lr_0 = 4.7254e-04
Validation rmse = 0.156666
Epoch 20
Loss = 9.3641e-02, PNorm = 35.1530, GNorm = 2.0194, lr_0 = 4.6056e-04
Loss = 1.1955e-01, PNorm = 35.1682, GNorm = 1.6588, lr_0 = 4.4993e-04
Validation rmse = 0.150090
Epoch 21
Loss = 1.3148e-01, PNorm = 35.1854, GNorm = 3.1461, lr_0 = 4.3852e-04
Loss = 1.1396e-01, PNorm = 35.2002, GNorm = 1.9985, lr_0 = 4.2840e-04
Validation rmse = 0.152437
Epoch 22
Loss = 1.0059e-01, PNorm = 35.2131, GNorm = 0.8280, lr_0 = 4.1851e-04
Validation rmse = 0.151561
Epoch 23
Loss = 1.2667e-01, PNorm = 35.2284, GNorm = 2.1603, lr_0 = 4.0789e-04
Loss = 1.1606e-01, PNorm = 35.2425, GNorm = 1.2738, lr_0 = 3.9848e-04
Validation rmse = 0.162025
Epoch 24
Loss = 1.5435e-01, PNorm = 35.2570, GNorm = 5.8957, lr_0 = 3.8837e-04
Loss = 1.1768e-01, PNorm = 35.2733, GNorm = 0.8674, lr_0 = 3.7941e-04
Validation rmse = 0.153167
Epoch 25
Loss = 1.1251e-01, PNorm = 35.2825, GNorm = 1.4617, lr_0 = 3.7065e-04
Validation rmse = 0.146918
Epoch 26
Loss = 9.4150e-02, PNorm = 35.2964, GNorm = 0.7319, lr_0 = 3.6125e-04
Loss = 9.8480e-02, PNorm = 35.3075, GNorm = 3.4221, lr_0 = 3.5291e-04
Validation rmse = 0.148903
Epoch 27
Loss = 1.1831e-01, PNorm = 35.3197, GNorm = 3.8985, lr_0 = 3.4396e-04
Loss = 1.0410e-01, PNorm = 35.3298, GNorm = 1.2615, lr_0 = 3.3602e-04
Validation rmse = 0.148387
Epoch 28
Loss = 1.0354e-01, PNorm = 35.3417, GNorm = 0.6225, lr_0 = 3.2750e-04
Loss = 1.0742e-01, PNorm = 35.3531, GNorm = 2.6294, lr_0 = 3.1994e-04
Validation rmse = 0.146993
Epoch 29
Loss = 1.0517e-01, PNorm = 35.3617, GNorm = 0.6725, lr_0 = 3.1256e-04
Validation rmse = 0.148914
Epoch 30
Loss = 1.0337e-01, PNorm = 35.3735, GNorm = 1.3575, lr_0 = 3.0463e-04
Loss = 9.1890e-02, PNorm = 35.3833, GNorm = 0.9639, lr_0 = 2.9760e-04
Validation rmse = 0.146784
Epoch 31
Loss = 8.2679e-02, PNorm = 35.3934, GNorm = 1.3770, lr_0 = 2.9005e-04
Loss = 9.5878e-02, PNorm = 35.4003, GNorm = 0.7335, lr_0 = 2.8336e-04
Validation rmse = 0.147757
Epoch 32
Loss = 8.3605e-02, PNorm = 35.4138, GNorm = 0.6881, lr_0 = 2.7617e-04
Loss = 1.0866e-01, PNorm = 35.4228, GNorm = 2.6204, lr_0 = 2.6980e-04
Validation rmse = 0.145749
Epoch 33
Loss = 9.3463e-02, PNorm = 35.4318, GNorm = 0.6928, lr_0 = 2.6357e-04
Validation rmse = 0.147135
Epoch 34
Loss = 1.1141e-01, PNorm = 35.4399, GNorm = 2.0526, lr_0 = 2.5688e-04
Loss = 8.3166e-02, PNorm = 35.4471, GNorm = 2.4939, lr_0 = 2.5095e-04
Validation rmse = 0.149400
Epoch 35
Loss = 1.0650e-01, PNorm = 35.4549, GNorm = 2.8795, lr_0 = 2.4459e-04
Loss = 9.7474e-02, PNorm = 35.4644, GNorm = 2.2455, lr_0 = 2.3894e-04
Validation rmse = 0.147508
Epoch 36
Loss = 1.0440e-01, PNorm = 35.4732, GNorm = 2.0358, lr_0 = 2.3343e-04
Validation rmse = 0.145488
Epoch 37
Loss = 9.4130e-02, PNorm = 35.4801, GNorm = 2.5211, lr_0 = 2.2751e-04
Loss = 9.1327e-02, PNorm = 35.4874, GNorm = 1.2282, lr_0 = 2.2226e-04
Validation rmse = 0.145711
Epoch 38
Loss = 8.9476e-02, PNorm = 35.4945, GNorm = 0.7837, lr_0 = 2.1662e-04
Loss = 9.5547e-02, PNorm = 35.5020, GNorm = 0.8502, lr_0 = 2.1162e-04
Validation rmse = 0.147456
Epoch 39
Loss = 8.3669e-02, PNorm = 35.5080, GNorm = 1.2113, lr_0 = 2.0625e-04
Loss = 1.0017e-01, PNorm = 35.5141, GNorm = 0.9307, lr_0 = 2.0149e-04
Validation rmse = 0.146164
Epoch 40
Loss = 9.4940e-02, PNorm = 35.5206, GNorm = 1.4867, lr_0 = 1.9684e-04
Validation rmse = 0.147363
Epoch 41
Loss = 6.8081e-02, PNorm = 35.5288, GNorm = 0.6140, lr_0 = 1.9185e-04
Loss = 9.5604e-02, PNorm = 35.5355, GNorm = 0.7703, lr_0 = 1.8742e-04
Validation rmse = 0.145663
Epoch 42
Loss = 8.7892e-02, PNorm = 35.5412, GNorm = 0.6257, lr_0 = 1.8267e-04
Loss = 8.8959e-02, PNorm = 35.5469, GNorm = 1.2609, lr_0 = 1.7845e-04
Validation rmse = 0.146436
Epoch 43
Loss = 7.4761e-02, PNorm = 35.5516, GNorm = 0.6132, lr_0 = 1.7433e-04
Loss = 9.4611e-02, PNorm = 35.5568, GNorm = 1.6808, lr_0 = 1.7031e-04
Loss = 6.4392e-02, PNorm = 35.5575, GNorm = 1.4978, lr_0 = 1.6991e-04
Validation rmse = 0.146495
Epoch 44
Loss = 8.8829e-02, PNorm = 35.5630, GNorm = 1.8524, lr_0 = 1.6599e-04
Validation rmse = 0.145818
Epoch 45
Loss = 9.1322e-02, PNorm = 35.5683, GNorm = 1.0171, lr_0 = 1.6178e-04
Loss = 7.2998e-02, PNorm = 35.5744, GNorm = 0.4016, lr_0 = 1.5805e-04
Validation rmse = 0.145034
Epoch 46
Loss = 8.7179e-02, PNorm = 35.5788, GNorm = 1.4947, lr_0 = 1.5404e-04
Loss = 8.5290e-02, PNorm = 35.5839, GNorm = 0.9399, lr_0 = 1.5048e-04
Validation rmse = 0.146162
Epoch 47
Loss = 8.4488e-02, PNorm = 35.5883, GNorm = 1.0775, lr_0 = 1.4701e-04
Validation rmse = 0.145648
Epoch 48
Loss = 6.0686e-02, PNorm = 35.5926, GNorm = 0.8867, lr_0 = 1.4328e-04
Loss = 9.4627e-02, PNorm = 35.5984, GNorm = 0.9680, lr_0 = 1.3997e-04
Validation rmse = 0.144369
Epoch 49
Loss = 6.4201e-02, PNorm = 35.6026, GNorm = 1.5868, lr_0 = 1.3642e-04
Loss = 8.4203e-02, PNorm = 35.6063, GNorm = 0.6229, lr_0 = 1.3327e-04
Validation rmse = 0.146769
Epoch 50
Loss = 8.7473e-02, PNorm = 35.6098, GNorm = 2.1312, lr_0 = 1.3020e-04
Loss = 7.7246e-02, PNorm = 35.6132, GNorm = 1.0408, lr_0 = 1.2719e-04
Validation rmse = 0.145922
Epoch 51
Loss = 8.4044e-02, PNorm = 35.6179, GNorm = 0.5970, lr_0 = 1.2397e-04
Validation rmse = 0.148224
Epoch 52
Loss = 8.6731e-02, PNorm = 35.6230, GNorm = 2.1668, lr_0 = 1.2082e-04
Loss = 7.7460e-02, PNorm = 35.6262, GNorm = 1.1866, lr_0 = 1.1803e-04
Validation rmse = 0.147858
Epoch 53
Loss = 8.1567e-02, PNorm = 35.6296, GNorm = 0.9667, lr_0 = 1.1504e-04
Loss = 7.7064e-02, PNorm = 35.6333, GNorm = 1.4453, lr_0 = 1.1239e-04
Validation rmse = 0.144929
Epoch 54
Loss = 7.8207e-02, PNorm = 35.6362, GNorm = 0.9300, lr_0 = 1.0979e-04
Loss = 8.6094e-02, PNorm = 35.6398, GNorm = 1.0030, lr_0 = 1.0726e-04
Loss = 1.2779e-01, PNorm = 35.6399, GNorm = 2.6459, lr_0 = 1.0701e-04
Validation rmse = 0.147202
Epoch 55
Loss = 7.4592e-02, PNorm = 35.6426, GNorm = 1.0905, lr_0 = 1.0454e-04
Validation rmse = 0.145312
Epoch 56
Loss = 7.8250e-02, PNorm = 35.6458, GNorm = 0.7186, lr_0 = 1.0189e-04
Loss = 7.3801e-02, PNorm = 35.6487, GNorm = 2.1018, lr_0 = 1.0000e-04
Validation rmse = 0.145011
Epoch 57
Loss = 8.0225e-02, PNorm = 35.6535, GNorm = 2.2809, lr_0 = 1.0000e-04
Loss = 8.2597e-02, PNorm = 35.6560, GNorm = 0.9494, lr_0 = 1.0000e-04
Validation rmse = 0.145784
Epoch 58
Loss = 8.4679e-02, PNorm = 35.6589, GNorm = 0.5843, lr_0 = 1.0000e-04
Validation rmse = 0.148821
Epoch 59
Loss = 4.7472e-02, PNorm = 35.6628, GNorm = 0.3978, lr_0 = 1.0000e-04
Loss = 8.2044e-02, PNorm = 35.6664, GNorm = 0.6267, lr_0 = 1.0000e-04
Validation rmse = 0.146154
Model 0 best validation rmse = 0.144369 on epoch 48
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.166082
Ensemble test rmse = 0.166082
1-fold cross validation
	Seed 0 ==> test rmse = 0.166082
Overall test rmse = 0.166082 +/- 0.000000
Elapsed time = 0:00:32
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,077 | train size = 856 | val size = 215 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.4341e-01, PNorm = 34.0156, GNorm = 4.4766, lr_0 = 3.9118e-04
Validation rmse = 0.313282
Epoch 1
Loss = 8.3269e-01, PNorm = 34.0392, GNorm = 11.6887, lr_0 = 6.8235e-04
Loss = 6.8802e-01, PNorm = 34.0788, GNorm = 1.2533, lr_0 = 9.4706e-04
Validation rmse = 0.305203
Epoch 2
Loss = 5.5714e-01, PNorm = 34.1527, GNorm = 5.8343, lr_0 = 9.7920e-04
Loss = 4.1446e-01, PNorm = 34.2257, GNorm = 2.4379, lr_0 = 9.5660e-04
Validation rmse = 0.218117
Epoch 3
Loss = 4.3495e-01, PNorm = 34.2989, GNorm = 2.7477, lr_0 = 9.3234e-04
Validation rmse = 0.204426
Epoch 4
Loss = 3.0568e-01, PNorm = 34.3593, GNorm = 2.3004, lr_0 = 9.0869e-04
Loss = 3.1216e-01, PNorm = 34.4083, GNorm = 6.8079, lr_0 = 8.8772e-04
Validation rmse = 0.186432
Epoch 5
Loss = 2.7820e-01, PNorm = 34.4612, GNorm = 1.8039, lr_0 = 8.6521e-04
Loss = 2.7042e-01, PNorm = 34.5144, GNorm = 3.9150, lr_0 = 8.4524e-04
Validation rmse = 0.190538
Epoch 6
Loss = 2.5051e-01, PNorm = 34.5548, GNorm = 5.3934, lr_0 = 8.2380e-04
Validation rmse = 0.168520
Epoch 7
Loss = 1.6477e-01, PNorm = 34.6003, GNorm = 1.3903, lr_0 = 8.0291e-04
Loss = 2.3211e-01, PNorm = 34.6323, GNorm = 0.8822, lr_0 = 7.8437e-04
Validation rmse = 0.178987
Epoch 8
Loss = 2.4372e-01, PNorm = 34.6626, GNorm = 2.8500, lr_0 = 7.6448e-04
Loss = 2.9712e-01, PNorm = 34.7023, GNorm = 5.4049, lr_0 = 7.4684e-04
Validation rmse = 0.172659
Epoch 9
Loss = 2.3889e-01, PNorm = 34.7421, GNorm = 0.7905, lr_0 = 7.2960e-04
Loss = 1.8625e-01, PNorm = 34.7704, GNorm = 2.4992, lr_0 = 7.1276e-04
Validation rmse = 0.172547
Epoch 10
Loss = 1.7224e-01, PNorm = 34.7938, GNorm = 2.3903, lr_0 = 6.9468e-04
Validation rmse = 0.154595
Epoch 11
Loss = 1.2507e-01, PNorm = 34.8259, GNorm = 2.3858, lr_0 = 6.7706e-04
Loss = 1.7414e-01, PNorm = 34.8500, GNorm = 1.1361, lr_0 = 6.6143e-04
Validation rmse = 0.150784
Epoch 12
Loss = 1.9793e-01, PNorm = 34.8763, GNorm = 0.9127, lr_0 = 6.4466e-04
Loss = 1.3605e-01, PNorm = 34.8946, GNorm = 0.7094, lr_0 = 6.2978e-04
Validation rmse = 0.149493
Epoch 13
Loss = 1.4057e-01, PNorm = 34.9119, GNorm = 0.5070, lr_0 = 6.1381e-04
Validation rmse = 0.146958
Epoch 14
Loss = 1.5418e-01, PNorm = 34.9340, GNorm = 3.4332, lr_0 = 5.9824e-04
Loss = 1.4752e-01, PNorm = 34.9542, GNorm = 1.6909, lr_0 = 5.8443e-04
Validation rmse = 0.173502
Epoch 15
Loss = 1.7166e-01, PNorm = 34.9759, GNorm = 1.1338, lr_0 = 5.6961e-04
Loss = 1.5035e-01, PNorm = 34.9940, GNorm = 1.1275, lr_0 = 5.5646e-04
Validation rmse = 0.146551
Epoch 16
Loss = 1.4420e-01, PNorm = 35.0140, GNorm = 1.9339, lr_0 = 5.4235e-04
Loss = 1.3600e-01, PNorm = 35.0304, GNorm = 2.5530, lr_0 = 5.2983e-04
Validation rmse = 0.141944
Epoch 17
Loss = 1.2336e-01, PNorm = 35.0440, GNorm = 2.2566, lr_0 = 5.1760e-04
Validation rmse = 0.141242
Epoch 18
Loss = 1.3044e-01, PNorm = 35.0586, GNorm = 1.5368, lr_0 = 5.0448e-04
Loss = 1.3734e-01, PNorm = 35.0772, GNorm = 2.6713, lr_0 = 4.9283e-04
Validation rmse = 0.141697
Epoch 19
Loss = 1.3727e-01, PNorm = 35.0918, GNorm = 1.2530, lr_0 = 4.8033e-04
Loss = 1.2154e-01, PNorm = 35.1065, GNorm = 1.1940, lr_0 = 4.6924e-04
Validation rmse = 0.143436
Epoch 20
Loss = 1.2660e-01, PNorm = 35.1262, GNorm = 3.4197, lr_0 = 4.5734e-04
Validation rmse = 0.141105
Epoch 21
Loss = 1.4395e-01, PNorm = 35.1385, GNorm = 1.7777, lr_0 = 4.4575e-04
Loss = 1.1859e-01, PNorm = 35.1518, GNorm = 3.1718, lr_0 = 4.3546e-04
Validation rmse = 0.144948
Epoch 22
Loss = 2.4456e-01, PNorm = 35.1660, GNorm = 2.2530, lr_0 = 4.2441e-04
Loss = 1.6545e-01, PNorm = 35.1830, GNorm = 3.2574, lr_0 = 4.1462e-04
Validation rmse = 0.151568
Epoch 23
Loss = 1.3338e-01, PNorm = 35.1952, GNorm = 2.8222, lr_0 = 4.0410e-04
Loss = 1.3420e-01, PNorm = 35.2122, GNorm = 1.6568, lr_0 = 3.9477e-04
Loss = 1.1792e-01, PNorm = 35.2141, GNorm = 4.2317, lr_0 = 3.9385e-04
Validation rmse = 0.141544
Epoch 24
Loss = 1.4350e-01, PNorm = 35.2273, GNorm = 1.6769, lr_0 = 3.8476e-04
Validation rmse = 0.136374
Epoch 25
Loss = 1.7588e-01, PNorm = 35.2403, GNorm = 3.1258, lr_0 = 3.7588e-04
Loss = 1.0880e-01, PNorm = 35.2522, GNorm = 0.5646, lr_0 = 3.6721e-04
Validation rmse = 0.135900
Epoch 26
Loss = 1.1843e-01, PNorm = 35.2651, GNorm = 0.9951, lr_0 = 3.5789e-04
Loss = 1.2086e-01, PNorm = 35.2754, GNorm = 0.9653, lr_0 = 3.4963e-04
Validation rmse = 0.136838
Epoch 27
Loss = 1.0840e-01, PNorm = 35.2849, GNorm = 1.0360, lr_0 = 3.4076e-04
Validation rmse = 0.136084
Epoch 28
Loss = 1.1601e-01, PNorm = 35.2958, GNorm = 0.9104, lr_0 = 3.3212e-04
Loss = 1.0631e-01, PNorm = 35.3057, GNorm = 0.9874, lr_0 = 3.2446e-04
Validation rmse = 0.135448
Epoch 29
Loss = 1.3690e-01, PNorm = 35.3167, GNorm = 1.1362, lr_0 = 3.1623e-04
Loss = 1.0382e-01, PNorm = 35.3253, GNorm = 1.4805, lr_0 = 3.0893e-04
Validation rmse = 0.132136
Epoch 30
Loss = 1.0554e-01, PNorm = 35.3392, GNorm = 0.7043, lr_0 = 3.0109e-04
Loss = 1.1210e-01, PNorm = 35.3506, GNorm = 2.7970, lr_0 = 2.9414e-04
Loss = 2.3254e-02, PNorm = 35.3513, GNorm = 1.5480, lr_0 = 2.9346e-04
Validation rmse = 0.135181
Epoch 31
Loss = 9.3721e-02, PNorm = 35.3595, GNorm = 1.7222, lr_0 = 2.8668e-04
Validation rmse = 0.136971
Epoch 32
Loss = 8.7692e-02, PNorm = 35.3682, GNorm = 0.4954, lr_0 = 2.7941e-04
Loss = 1.1869e-01, PNorm = 35.3805, GNorm = 2.0831, lr_0 = 2.7296e-04
Validation rmse = 0.133077
Epoch 33
Loss = 9.7401e-02, PNorm = 35.3898, GNorm = 3.0430, lr_0 = 2.6604e-04
Loss = 1.2277e-01, PNorm = 35.3987, GNorm = 0.4363, lr_0 = 2.5990e-04
Validation rmse = 0.134066
Epoch 34
Loss = 1.1969e-01, PNorm = 35.4069, GNorm = 2.0310, lr_0 = 2.5390e-04
Validation rmse = 0.148353
Epoch 35
Loss = 5.7569e-02, PNorm = 35.4164, GNorm = 0.8093, lr_0 = 2.4746e-04
Loss = 1.3559e-01, PNorm = 35.4265, GNorm = 1.2304, lr_0 = 2.4175e-04
Validation rmse = 0.138699
Epoch 36
Loss = 1.2607e-01, PNorm = 35.4347, GNorm = 0.6158, lr_0 = 2.3562e-04
Loss = 9.3485e-02, PNorm = 35.4415, GNorm = 2.8112, lr_0 = 2.3018e-04
Validation rmse = 0.133334
Epoch 37
Loss = 1.0224e-01, PNorm = 35.4496, GNorm = 1.1780, lr_0 = 2.2434e-04
Loss = 1.0692e-01, PNorm = 35.4560, GNorm = 1.9230, lr_0 = 2.1916e-04
Loss = 2.3957e-02, PNorm = 35.4568, GNorm = 1.2121, lr_0 = 2.1865e-04
Validation rmse = 0.137701
Epoch 38
Loss = 1.2325e-01, PNorm = 35.4622, GNorm = 3.1026, lr_0 = 2.1361e-04
Validation rmse = 0.133941
Epoch 39
Loss = 1.0326e-01, PNorm = 35.4696, GNorm = 2.9971, lr_0 = 2.0819e-04
Loss = 1.2236e-01, PNorm = 35.4788, GNorm = 1.3206, lr_0 = 2.0338e-04
Validation rmse = 0.134952
Epoch 40
Loss = 8.9511e-02, PNorm = 35.4868, GNorm = 0.9588, lr_0 = 1.9823e-04
Loss = 1.1855e-01, PNorm = 35.4906, GNorm = 1.9761, lr_0 = 1.9365e-04
Validation rmse = 0.133774
Epoch 41
Loss = 1.1154e-01, PNorm = 35.5001, GNorm = 1.7469, lr_0 = 1.8874e-04
Validation rmse = 0.132697
Epoch 42
Loss = 7.5100e-02, PNorm = 35.5053, GNorm = 0.7324, lr_0 = 1.8438e-04
Loss = 9.1873e-02, PNorm = 35.5110, GNorm = 0.8940, lr_0 = 1.8013e-04
Validation rmse = 0.132120
Epoch 43
Loss = 8.8645e-02, PNorm = 35.5169, GNorm = 1.0204, lr_0 = 1.7556e-04
Loss = 1.1139e-01, PNorm = 35.5222, GNorm = 2.1142, lr_0 = 1.7151e-04
Validation rmse = 0.135176
Epoch 44
Loss = 8.7300e-02, PNorm = 35.5267, GNorm = 0.4020, lr_0 = 1.6716e-04
Loss = 1.0056e-01, PNorm = 35.5317, GNorm = 2.3584, lr_0 = 1.6330e-04
Loss = 2.7850e-01, PNorm = 35.5322, GNorm = 5.2966, lr_0 = 1.6292e-04
Validation rmse = 0.132274
Epoch 45
Loss = 8.9807e-02, PNorm = 35.5391, GNorm = 2.9166, lr_0 = 1.5916e-04
Validation rmse = 0.132942
Epoch 46
Loss = 1.1497e-01, PNorm = 35.5440, GNorm = 3.1177, lr_0 = 1.5512e-04
Loss = 1.2248e-01, PNorm = 35.5517, GNorm = 0.8309, lr_0 = 1.5154e-04
Validation rmse = 0.133272
Epoch 47
Loss = 9.0698e-02, PNorm = 35.5592, GNorm = 1.3153, lr_0 = 1.4770e-04
Loss = 8.7120e-02, PNorm = 35.5636, GNorm = 1.1240, lr_0 = 1.4429e-04
Validation rmse = 0.133965
Epoch 48
Loss = 9.4078e-02, PNorm = 35.5675, GNorm = 1.2437, lr_0 = 1.4063e-04
Validation rmse = 0.131113
Epoch 49
Loss = 1.1094e-01, PNorm = 35.5713, GNorm = 1.7091, lr_0 = 1.3706e-04
Loss = 1.0687e-01, PNorm = 35.5755, GNorm = 0.5448, lr_0 = 1.3390e-04
Validation rmse = 0.132855
Epoch 50
Loss = 8.7390e-02, PNorm = 35.5804, GNorm = 2.1984, lr_0 = 1.3081e-04
Loss = 9.5411e-02, PNorm = 35.5853, GNorm = 0.8490, lr_0 = 1.2779e-04
Validation rmse = 0.132354
Epoch 51
Loss = 8.5197e-02, PNorm = 35.5892, GNorm = 0.5366, lr_0 = 1.2455e-04
Loss = 9.9207e-02, PNorm = 35.5914, GNorm = 0.5831, lr_0 = 1.2167e-04
Loss = 4.1408e-02, PNorm = 35.5916, GNorm = 1.4432, lr_0 = 1.2139e-04
Validation rmse = 0.131598
Epoch 52
Loss = 1.0590e-01, PNorm = 35.5953, GNorm = 0.8552, lr_0 = 1.1859e-04
Validation rmse = 0.132190
Epoch 53
Loss = 1.1704e-01, PNorm = 35.5993, GNorm = 1.0341, lr_0 = 1.1558e-04
Loss = 9.1126e-02, PNorm = 35.6027, GNorm = 0.6970, lr_0 = 1.1291e-04
Validation rmse = 0.133845
Epoch 54
Loss = 9.4021e-02, PNorm = 35.6065, GNorm = 1.3204, lr_0 = 1.1005e-04
Loss = 9.9282e-02, PNorm = 35.6112, GNorm = 0.9631, lr_0 = 1.0751e-04
Validation rmse = 0.137242
Epoch 55
Loss = 8.8763e-02, PNorm = 35.6146, GNorm = 2.3784, lr_0 = 1.0478e-04
Validation rmse = 0.132772
Epoch 56
Loss = 9.1041e-02, PNorm = 35.6177, GNorm = 0.8629, lr_0 = 1.0212e-04
Loss = 8.0235e-02, PNorm = 35.6210, GNorm = 0.7335, lr_0 = 1.0000e-04
Validation rmse = 0.131092
Epoch 57
Loss = 7.9448e-02, PNorm = 35.6247, GNorm = 1.0516, lr_0 = 1.0000e-04
Loss = 1.0170e-01, PNorm = 35.6273, GNorm = 0.8059, lr_0 = 1.0000e-04
Validation rmse = 0.131470
Epoch 58
Loss = 9.3208e-02, PNorm = 35.6326, GNorm = 0.8949, lr_0 = 1.0000e-04
Loss = 8.9775e-02, PNorm = 35.6357, GNorm = 4.3513, lr_0 = 1.0000e-04
Validation rmse = 0.131812
Epoch 59
Loss = 9.1292e-02, PNorm = 35.6393, GNorm = 1.0099, lr_0 = 1.0000e-04
Validation rmse = 0.131193
Model 0 best validation rmse = 0.131092 on epoch 56
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.285155
Ensemble test rmse = 0.285155
1-fold cross validation
	Seed 0 ==> test rmse = 0.285155
Overall test rmse = 0.285155 +/- 0.000000
Elapsed time = 0:00:31
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,067 | train size = 848 | val size = 213 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.6307e-01, PNorm = 34.0162, GNorm = 1.5212, lr_0 = 4.0937e-04
Validation rmse = 0.305676
Epoch 1
Loss = 6.6573e-01, PNorm = 34.0519, GNorm = 1.7755, lr_0 = 7.1875e-04
Loss = 5.4887e-01, PNorm = 34.1062, GNorm = 5.2585, lr_0 = 1.0000e-03
Validation rmse = 0.260380
Epoch 2
Loss = 4.0411e-01, PNorm = 34.1789, GNorm = 5.8079, lr_0 = 9.7549e-04
Loss = 5.9368e-01, PNorm = 34.2257, GNorm = 12.1950, lr_0 = 9.5159e-04
Validation rmse = 0.253788
Epoch 3
Loss = 4.7267e-01, PNorm = 34.2769, GNorm = 2.8296, lr_0 = 9.2827e-04
Validation rmse = 0.251765
Epoch 4
Loss = 3.9913e-01, PNorm = 34.3293, GNorm = 1.0812, lr_0 = 9.0552e-04
Loss = 3.4265e-01, PNorm = 34.3762, GNorm = 4.5894, lr_0 = 8.8333e-04
Validation rmse = 0.211513
Epoch 5
Loss = 2.6416e-01, PNorm = 34.4214, GNorm = 1.3348, lr_0 = 8.6168e-04
Loss = 2.5777e-01, PNorm = 34.4682, GNorm = 2.0460, lr_0 = 8.4056e-04
Validation rmse = 0.205616
Epoch 6
Loss = 2.6593e-01, PNorm = 34.5113, GNorm = 7.7930, lr_0 = 8.1996e-04
Validation rmse = 0.218769
Epoch 7
Loss = 1.6644e-01, PNorm = 34.5460, GNorm = 6.5246, lr_0 = 7.9987e-04
Loss = 2.3348e-01, PNorm = 34.5806, GNorm = 4.2172, lr_0 = 7.8026e-04
Validation rmse = 0.180810
Epoch 8
Loss = 1.9451e-01, PNorm = 34.6190, GNorm = 0.6309, lr_0 = 7.6114e-04
Loss = 1.8654e-01, PNorm = 34.6541, GNorm = 1.5664, lr_0 = 7.4249e-04
Validation rmse = 0.169728
Epoch 9
Loss = 1.7819e-01, PNorm = 34.6883, GNorm = 2.8704, lr_0 = 7.2429e-04
Validation rmse = 0.196500
Epoch 10
Loss = 1.1512e-01, PNorm = 34.7213, GNorm = 3.9630, lr_0 = 7.0654e-04
Loss = 2.0164e-01, PNorm = 34.7501, GNorm = 5.5085, lr_0 = 6.8923e-04
Validation rmse = 0.180427
Epoch 11
Loss = 2.0804e-01, PNorm = 34.7834, GNorm = 5.7610, lr_0 = 6.7234e-04
Loss = 2.3508e-01, PNorm = 34.8123, GNorm = 4.7756, lr_0 = 6.5586e-04
Validation rmse = 0.175609
Epoch 12
Loss = 1.7431e-01, PNorm = 34.8393, GNorm = 3.3712, lr_0 = 6.3979e-04
Loss = 1.6486e-01, PNorm = 34.8645, GNorm = 1.4746, lr_0 = 6.2411e-04
Validation rmse = 0.166316
Epoch 13
Loss = 1.5198e-01, PNorm = 34.8895, GNorm = 2.2717, lr_0 = 6.0881e-04
Validation rmse = 0.160567
Epoch 14
Loss = 1.4890e-01, PNorm = 34.9096, GNorm = 1.6872, lr_0 = 5.9389e-04
Loss = 1.5007e-01, PNorm = 34.9323, GNorm = 3.8010, lr_0 = 5.7934e-04
Validation rmse = 0.159415
Epoch 15
Loss = 1.2929e-01, PNorm = 34.9521, GNorm = 1.2198, lr_0 = 5.6514e-04
Loss = 1.4210e-01, PNorm = 34.9691, GNorm = 1.7912, lr_0 = 5.5129e-04
Validation rmse = 0.152138
Epoch 16
Loss = 1.2739e-01, PNorm = 34.9886, GNorm = 2.7955, lr_0 = 5.3778e-04
Validation rmse = 0.155446
Epoch 17
Loss = 1.5804e-01, PNorm = 35.0090, GNorm = 3.3069, lr_0 = 5.2460e-04
Loss = 1.1581e-01, PNorm = 35.0284, GNorm = 0.6572, lr_0 = 5.1174e-04
Validation rmse = 0.151490
Epoch 18
Loss = 1.0804e-01, PNorm = 35.0440, GNorm = 3.3162, lr_0 = 4.9920e-04
Loss = 1.5610e-01, PNorm = 35.0605, GNorm = 2.6073, lr_0 = 4.8697e-04
Validation rmse = 0.182089
Epoch 19
Loss = 1.4676e-01, PNorm = 35.0764, GNorm = 3.6152, lr_0 = 4.7503e-04
Validation rmse = 0.164324
Epoch 20
Loss = 1.4927e-01, PNorm = 35.0911, GNorm = 3.4732, lr_0 = 4.6339e-04
Loss = 1.3490e-01, PNorm = 35.1077, GNorm = 0.8387, lr_0 = 4.5204e-04
Validation rmse = 0.151327
Epoch 21
Loss = 1.1580e-01, PNorm = 35.1231, GNorm = 1.3050, lr_0 = 4.4096e-04
Loss = 1.1921e-01, PNorm = 35.1353, GNorm = 1.0936, lr_0 = 4.3015e-04
Validation rmse = 0.148084
Epoch 22
Loss = 1.1886e-01, PNorm = 35.1487, GNorm = 1.0638, lr_0 = 4.1961e-04
Loss = 1.1246e-01, PNorm = 35.1602, GNorm = 1.6417, lr_0 = 4.0933e-04
Validation rmse = 0.148119
Epoch 23
Loss = 1.1591e-01, PNorm = 35.1766, GNorm = 0.7094, lr_0 = 3.9929e-04
Validation rmse = 0.149107
Epoch 24
Loss = 9.5353e-02, PNorm = 35.1883, GNorm = 1.1318, lr_0 = 3.8951e-04
Loss = 1.2499e-01, PNorm = 35.1996, GNorm = 0.8517, lr_0 = 3.7996e-04
Validation rmse = 0.146995
Epoch 25
Loss = 1.0854e-01, PNorm = 35.2099, GNorm = 1.6092, lr_0 = 3.7065e-04
Loss = 1.2304e-01, PNorm = 35.2224, GNorm = 3.2464, lr_0 = 3.6157e-04
Loss = 1.0430e-01, PNorm = 35.2242, GNorm = 1.8117, lr_0 = 3.6067e-04
Validation rmse = 0.147335
Epoch 26
Loss = 1.1041e-01, PNorm = 35.2354, GNorm = 1.9002, lr_0 = 3.5183e-04
Validation rmse = 0.145398
Epoch 27
Loss = 1.4082e-01, PNorm = 35.2479, GNorm = 0.5090, lr_0 = 3.4321e-04
Loss = 1.0623e-01, PNorm = 35.2609, GNorm = 0.5849, lr_0 = 3.3480e-04
Validation rmse = 0.147958
Epoch 28
Loss = 9.3099e-02, PNorm = 35.2700, GNorm = 1.7527, lr_0 = 3.2659e-04
Loss = 1.2808e-01, PNorm = 35.2791, GNorm = 1.9249, lr_0 = 3.1859e-04
Validation rmse = 0.148110
Epoch 29
Loss = 9.9711e-02, PNorm = 35.2892, GNorm = 1.9107, lr_0 = 3.1078e-04
Validation rmse = 0.148417
Epoch 30
Loss = 1.0405e-01, PNorm = 35.2980, GNorm = 1.2042, lr_0 = 3.0317e-04
Loss = 8.4092e-02, PNorm = 35.3079, GNorm = 1.6264, lr_0 = 2.9574e-04
Validation rmse = 0.144689
Epoch 31
Loss = 7.0218e-02, PNorm = 35.3170, GNorm = 1.2665, lr_0 = 2.8849e-04
Loss = 1.1506e-01, PNorm = 35.3250, GNorm = 1.7766, lr_0 = 2.8142e-04
Validation rmse = 0.145009
Epoch 32
Loss = 9.9679e-02, PNorm = 35.3350, GNorm = 1.0420, lr_0 = 2.7452e-04
Validation rmse = 0.147819
Epoch 33
Loss = 1.4773e-01, PNorm = 35.3439, GNorm = 2.6670, lr_0 = 2.6779e-04
Loss = 9.0598e-02, PNorm = 35.3535, GNorm = 1.3487, lr_0 = 2.6123e-04
Validation rmse = 0.144647
Epoch 34
Loss = 9.1644e-02, PNorm = 35.3611, GNorm = 3.0980, lr_0 = 2.5483e-04
Loss = 9.7057e-02, PNorm = 35.3697, GNorm = 0.8516, lr_0 = 2.4858e-04
Validation rmse = 0.148218
Epoch 35
Loss = 1.0077e-01, PNorm = 35.3775, GNorm = 2.1651, lr_0 = 2.4249e-04
Loss = 9.2594e-02, PNorm = 35.3852, GNorm = 1.0658, lr_0 = 2.3655e-04
Validation rmse = 0.145376
Epoch 36
Loss = 8.4314e-02, PNorm = 35.3933, GNorm = 0.9069, lr_0 = 2.3075e-04
Validation rmse = 0.143432
Epoch 37
Loss = 7.2506e-02, PNorm = 35.3998, GNorm = 2.4269, lr_0 = 2.2510e-04
Loss = 1.0571e-01, PNorm = 35.4071, GNorm = 0.8318, lr_0 = 2.1958e-04
Validation rmse = 0.145303
Epoch 38
Loss = 7.3769e-02, PNorm = 35.4137, GNorm = 1.3038, lr_0 = 2.1420e-04
Loss = 1.1805e-01, PNorm = 35.4205, GNorm = 1.9040, lr_0 = 2.0895e-04
Validation rmse = 0.145850
Epoch 39
Loss = 1.0214e-01, PNorm = 35.4269, GNorm = 2.5634, lr_0 = 2.0383e-04
Validation rmse = 0.143709
Epoch 40
Loss = 8.0398e-02, PNorm = 35.4340, GNorm = 2.6772, lr_0 = 1.9883e-04
Loss = 9.8724e-02, PNorm = 35.4416, GNorm = 2.1430, lr_0 = 1.9396e-04
Validation rmse = 0.150288
Epoch 41
Loss = 8.5285e-02, PNorm = 35.4476, GNorm = 2.0243, lr_0 = 1.8921e-04
Loss = 9.9182e-02, PNorm = 35.4539, GNorm = 1.1451, lr_0 = 1.8457e-04
Validation rmse = 0.144994
Epoch 42
Loss = 8.7714e-02, PNorm = 35.4592, GNorm = 1.4709, lr_0 = 1.8005e-04
Validation rmse = 0.144230
Epoch 43
Loss = 7.8206e-02, PNorm = 35.4645, GNorm = 1.0691, lr_0 = 1.7564e-04
Loss = 9.3321e-02, PNorm = 35.4708, GNorm = 0.8841, lr_0 = 1.7133e-04
Validation rmse = 0.144137
Epoch 44
Loss = 1.0171e-01, PNorm = 35.4761, GNorm = 1.9691, lr_0 = 1.6713e-04
Loss = 8.6309e-02, PNorm = 35.4804, GNorm = 0.9479, lr_0 = 1.6304e-04
Validation rmse = 0.143948
Epoch 45
Loss = 7.1664e-02, PNorm = 35.4869, GNorm = 0.5108, lr_0 = 1.5904e-04
Loss = 1.0111e-01, PNorm = 35.4909, GNorm = 1.5540, lr_0 = 1.5514e-04
Validation rmse = 0.147565
Epoch 46
Loss = 9.1703e-02, PNorm = 35.4948, GNorm = 1.1504, lr_0 = 1.5134e-04
Validation rmse = 0.143294
Epoch 47
Loss = 6.2509e-02, PNorm = 35.5001, GNorm = 0.5537, lr_0 = 1.4763e-04
Loss = 8.9781e-02, PNorm = 35.5044, GNorm = 1.5277, lr_0 = 1.4401e-04
Validation rmse = 0.146464
Epoch 48
Loss = 8.7600e-02, PNorm = 35.5096, GNorm = 1.2854, lr_0 = 1.4048e-04
Loss = 8.9659e-02, PNorm = 35.5145, GNorm = 1.3116, lr_0 = 1.3704e-04
Validation rmse = 0.144320
Epoch 49
Loss = 7.9873e-02, PNorm = 35.5181, GNorm = 1.1109, lr_0 = 1.3368e-04
Validation rmse = 0.146707
Epoch 50
Loss = 1.1687e-01, PNorm = 35.5233, GNorm = 2.3107, lr_0 = 1.3041e-04
Loss = 7.1946e-02, PNorm = 35.5285, GNorm = 0.3955, lr_0 = 1.2721e-04
Validation rmse = 0.144139
Epoch 51
Loss = 8.1929e-02, PNorm = 35.5326, GNorm = 1.7566, lr_0 = 1.2379e-04
Loss = 8.5506e-02, PNorm = 35.5367, GNorm = 0.6690, lr_0 = 1.2075e-04
Validation rmse = 0.144549
Epoch 52
Loss = 8.0597e-02, PNorm = 35.5408, GNorm = 1.7444, lr_0 = 1.1779e-04
Validation rmse = 0.146293
Epoch 53
Loss = 6.3108e-02, PNorm = 35.5448, GNorm = 2.6329, lr_0 = 1.1491e-04
Loss = 9.1409e-02, PNorm = 35.5480, GNorm = 0.5277, lr_0 = 1.1209e-04
Validation rmse = 0.143530
Epoch 54
Loss = 1.0244e-01, PNorm = 35.5514, GNorm = 1.6984, lr_0 = 1.0934e-04
Loss = 7.4791e-02, PNorm = 35.5542, GNorm = 1.6486, lr_0 = 1.0666e-04
Validation rmse = 0.143597
Epoch 55
Loss = 7.9135e-02, PNorm = 35.5576, GNorm = 1.2756, lr_0 = 1.0405e-04
Validation rmse = 0.145920
Epoch 56
Loss = 7.0089e-02, PNorm = 35.5613, GNorm = 0.8177, lr_0 = 1.0150e-04
Loss = 9.0701e-02, PNorm = 35.5641, GNorm = 0.7088, lr_0 = 1.0000e-04
Validation rmse = 0.143416
Epoch 57
Loss = 1.1456e-01, PNorm = 35.5669, GNorm = 1.6318, lr_0 = 1.0000e-04
Loss = 6.7612e-02, PNorm = 35.5707, GNorm = 0.7947, lr_0 = 1.0000e-04
Validation rmse = 0.144418
Epoch 58
Loss = 8.8248e-02, PNorm = 35.5733, GNorm = 1.3848, lr_0 = 1.0000e-04
Loss = 7.7626e-02, PNorm = 35.5775, GNorm = 0.9505, lr_0 = 1.0000e-04
Validation rmse = 0.146442
Epoch 59
Loss = 9.2676e-02, PNorm = 35.5813, GNorm = 0.9104, lr_0 = 1.0000e-04
Validation rmse = 0.143441
Model 0 best validation rmse = 0.143294 on epoch 46
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.237115
Ensemble test rmse = 0.237115
1-fold cross validation
	Seed 0 ==> test rmse = 0.237115
Overall test rmse = 0.237115 +/- 0.000000
Elapsed time = 0:00:31
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,057 | train size = 840 | val size = 211 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.2223e-01, PNorm = 34.0156, GNorm = 2.2008, lr_0 = 4.0937e-04
Validation rmse = 0.299114
Epoch 1
Loss = 6.9617e-01, PNorm = 34.0441, GNorm = 3.4953, lr_0 = 7.1875e-04
Loss = 7.1411e-01, PNorm = 34.0972, GNorm = 19.3607, lr_0 = 1.0000e-03
Validation rmse = 0.306450
Epoch 2
Loss = 6.0272e-01, PNorm = 34.1469, GNorm = 4.0346, lr_0 = 9.7549e-04
Loss = 4.6670e-01, PNorm = 34.2082, GNorm = 4.0736, lr_0 = 9.5159e-04
Validation rmse = 0.220182
Epoch 3
Loss = 4.0285e-01, PNorm = 34.2761, GNorm = 3.9855, lr_0 = 9.2827e-04
Validation rmse = 0.217561
Epoch 4
Loss = 2.8567e-01, PNorm = 34.3378, GNorm = 0.8620, lr_0 = 9.0552e-04
Loss = 3.8411e-01, PNorm = 34.3853, GNorm = 1.2446, lr_0 = 8.8333e-04
Validation rmse = 0.215570
Epoch 5
Loss = 2.6497e-01, PNorm = 34.4366, GNorm = 5.5682, lr_0 = 8.6168e-04
Loss = 2.9455e-01, PNorm = 34.4879, GNorm = 1.0713, lr_0 = 8.4056e-04
Loss = 3.7262e-01, PNorm = 34.4913, GNorm = 4.2998, lr_0 = 8.3848e-04
Validation rmse = 0.179157
Epoch 6
Loss = 2.2393e-01, PNorm = 34.5324, GNorm = 0.8093, lr_0 = 8.1793e-04
Validation rmse = 0.170425
Epoch 7
Loss = 2.2356e-01, PNorm = 34.5733, GNorm = 3.5272, lr_0 = 7.9788e-04
Loss = 2.0557e-01, PNorm = 34.6068, GNorm = 2.0602, lr_0 = 7.7833e-04
Validation rmse = 0.165261
Epoch 8
Loss = 2.2647e-01, PNorm = 34.6444, GNorm = 3.0964, lr_0 = 7.5926e-04
Loss = 1.9963e-01, PNorm = 34.6780, GNorm = 6.0704, lr_0 = 7.4065e-04
Validation rmse = 0.174019
Epoch 9
Loss = 2.2936e-01, PNorm = 34.7105, GNorm = 2.0412, lr_0 = 7.2250e-04
Validation rmse = 0.153008
Epoch 10
Loss = 1.5819e-01, PNorm = 34.7463, GNorm = 2.8546, lr_0 = 7.0479e-04
Loss = 1.9167e-01, PNorm = 34.7743, GNorm = 5.1879, lr_0 = 6.8752e-04
Validation rmse = 0.148024
Epoch 11
Loss = 1.5575e-01, PNorm = 34.8065, GNorm = 2.0523, lr_0 = 6.6901e-04
Loss = 1.8735e-01, PNorm = 34.8293, GNorm = 9.5127, lr_0 = 6.5261e-04
Validation rmse = 0.148677
Epoch 12
Loss = 2.4193e-01, PNorm = 34.8551, GNorm = 0.9370, lr_0 = 6.3662e-04
Validation rmse = 0.146678
Epoch 13
Loss = 1.1789e-01, PNorm = 34.8823, GNorm = 2.2509, lr_0 = 6.2102e-04
Loss = 1.6948e-01, PNorm = 34.9076, GNorm = 1.4932, lr_0 = 6.0580e-04
Validation rmse = 0.142144
Epoch 14
Loss = 1.3214e-01, PNorm = 34.9302, GNorm = 1.7909, lr_0 = 5.9095e-04
Loss = 1.3828e-01, PNorm = 34.9514, GNorm = 1.1692, lr_0 = 5.7647e-04
Validation rmse = 0.137652
Epoch 15
Loss = 1.4895e-01, PNorm = 34.9672, GNorm = 1.6192, lr_0 = 5.6234e-04
Validation rmse = 0.141435
Epoch 16
Loss = 1.6478e-01, PNorm = 34.9892, GNorm = 2.6539, lr_0 = 5.4720e-04
Loss = 1.4193e-01, PNorm = 35.0065, GNorm = 1.9283, lr_0 = 5.3379e-04
Validation rmse = 0.138681
Epoch 17
Loss = 9.6533e-02, PNorm = 35.0223, GNorm = 1.8642, lr_0 = 5.2071e-04
Loss = 1.3877e-01, PNorm = 35.0380, GNorm = 3.6291, lr_0 = 5.0795e-04
Validation rmse = 0.138716
Epoch 18
Loss = 1.2928e-01, PNorm = 35.0541, GNorm = 1.9217, lr_0 = 4.9550e-04
Validation rmse = 0.149510
Epoch 19
Loss = 2.4177e-01, PNorm = 35.0703, GNorm = 4.0137, lr_0 = 4.8336e-04
Loss = 1.2936e-01, PNorm = 35.0844, GNorm = 2.4250, lr_0 = 4.7151e-04
Validation rmse = 0.138866
Epoch 20
Loss = 1.1147e-01, PNorm = 35.0982, GNorm = 1.1670, lr_0 = 4.5996e-04
Loss = 1.1375e-01, PNorm = 35.1107, GNorm = 1.6840, lr_0 = 4.4868e-04
Validation rmse = 0.130363
Epoch 21
Loss = 1.0909e-01, PNorm = 35.1253, GNorm = 0.5418, lr_0 = 4.3660e-04
Validation rmse = 0.132755
Epoch 22
Loss = 8.1429e-02, PNorm = 35.1405, GNorm = 1.6495, lr_0 = 4.2590e-04
Loss = 1.1820e-01, PNorm = 35.1530, GNorm = 1.5638, lr_0 = 4.1547e-04
Validation rmse = 0.131773
Epoch 23
Loss = 1.1566e-01, PNorm = 35.1668, GNorm = 2.2920, lr_0 = 4.0528e-04
Loss = 1.2402e-01, PNorm = 35.1814, GNorm = 1.0966, lr_0 = 3.9535e-04
Validation rmse = 0.135161
Epoch 24
Loss = 1.2509e-01, PNorm = 35.1942, GNorm = 2.2065, lr_0 = 3.8566e-04
Loss = 1.0034e-01, PNorm = 35.2056, GNorm = 0.9760, lr_0 = 3.7621e-04
Validation rmse = 0.129557
Epoch 25
Loss = 1.0768e-01, PNorm = 35.2147, GNorm = 4.5911, lr_0 = 3.6699e-04
Validation rmse = 0.134837
Epoch 26
Loss = 1.0769e-01, PNorm = 35.2277, GNorm = 1.0008, lr_0 = 3.5711e-04
Loss = 1.1810e-01, PNorm = 35.2381, GNorm = 0.7265, lr_0 = 3.4836e-04
Validation rmse = 0.127928
Epoch 27
Loss = 9.7782e-02, PNorm = 35.2513, GNorm = 4.1953, lr_0 = 3.3982e-04
Loss = 1.2000e-01, PNorm = 35.2611, GNorm = 1.3755, lr_0 = 3.3149e-04
Validation rmse = 0.128962
Epoch 28
Loss = 1.0916e-01, PNorm = 35.2714, GNorm = 2.3655, lr_0 = 3.2337e-04
Validation rmse = 0.126910
Epoch 29
Loss = 1.2518e-01, PNorm = 35.2808, GNorm = 4.5454, lr_0 = 3.1544e-04
Loss = 1.1669e-01, PNorm = 35.2907, GNorm = 3.8616, lr_0 = 3.0771e-04
Validation rmse = 0.130931
Epoch 30
Loss = 7.7832e-02, PNorm = 35.2994, GNorm = 0.6310, lr_0 = 3.0017e-04
Loss = 1.2308e-01, PNorm = 35.3086, GNorm = 2.5939, lr_0 = 2.9282e-04
Loss = 8.9531e-02, PNorm = 35.3096, GNorm = 2.8515, lr_0 = 2.9209e-04
Validation rmse = 0.129762
Epoch 31
Loss = 9.1191e-02, PNorm = 35.3209, GNorm = 2.1106, lr_0 = 2.8493e-04
Validation rmse = 0.126552
Epoch 32
Loss = 9.4337e-02, PNorm = 35.3298, GNorm = 1.7794, lr_0 = 2.7795e-04
Loss = 9.3752e-02, PNorm = 35.3381, GNorm = 1.3189, lr_0 = 2.7114e-04
Validation rmse = 0.126615
Epoch 33
Loss = 9.8949e-02, PNorm = 35.3459, GNorm = 1.5101, lr_0 = 2.6449e-04
Loss = 9.5203e-02, PNorm = 35.3542, GNorm = 1.1401, lr_0 = 2.5801e-04
Validation rmse = 0.126904
Epoch 34
Loss = 9.3435e-02, PNorm = 35.3618, GNorm = 1.5349, lr_0 = 2.5169e-04
Validation rmse = 0.128781
Epoch 35
Loss = 9.8431e-02, PNorm = 35.3698, GNorm = 4.5698, lr_0 = 2.4552e-04
Loss = 1.0398e-01, PNorm = 35.3774, GNorm = 0.7491, lr_0 = 2.3950e-04
Validation rmse = 0.126048
Epoch 36
Loss = 9.2525e-02, PNorm = 35.3851, GNorm = 3.7331, lr_0 = 2.3305e-04
Loss = 1.0377e-01, PNorm = 35.3918, GNorm = 3.1818, lr_0 = 2.2734e-04
Validation rmse = 0.124960
Epoch 37
Loss = 9.8923e-02, PNorm = 35.3988, GNorm = 3.3262, lr_0 = 2.2177e-04
Validation rmse = 0.124665
Epoch 38
Loss = 4.2403e-02, PNorm = 35.4062, GNorm = 0.5989, lr_0 = 2.1634e-04
Loss = 8.9417e-02, PNorm = 35.4127, GNorm = 0.8580, lr_0 = 2.1103e-04
Validation rmse = 0.124120
Epoch 39
Loss = 8.5532e-02, PNorm = 35.4195, GNorm = 1.1491, lr_0 = 2.0586e-04
Loss = 8.9760e-02, PNorm = 35.4265, GNorm = 1.2914, lr_0 = 2.0082e-04
Validation rmse = 0.125510
Epoch 40
Loss = 1.0233e-01, PNorm = 35.4312, GNorm = 3.9588, lr_0 = 1.9590e-04
Validation rmse = 0.130881
Epoch 41
Loss = 1.3246e-01, PNorm = 35.4377, GNorm = 3.3662, lr_0 = 1.9062e-04
Loss = 9.1576e-02, PNorm = 35.4433, GNorm = 0.7375, lr_0 = 1.8595e-04
Validation rmse = 0.130052
Epoch 42
Loss = 9.6177e-02, PNorm = 35.4497, GNorm = 0.7594, lr_0 = 1.8139e-04
Loss = 9.0608e-02, PNorm = 35.4549, GNorm = 0.7444, lr_0 = 1.7695e-04
Validation rmse = 0.128508
Epoch 43
Loss = 7.6803e-02, PNorm = 35.4609, GNorm = 1.1741, lr_0 = 1.7261e-04
Validation rmse = 0.123903
Epoch 44
Loss = 8.6590e-02, PNorm = 35.4646, GNorm = 1.8047, lr_0 = 1.6838e-04
Loss = 9.3734e-02, PNorm = 35.4697, GNorm = 0.5547, lr_0 = 1.6425e-04
Validation rmse = 0.124005
Epoch 45
Loss = 1.0448e-01, PNorm = 35.4745, GNorm = 2.3966, lr_0 = 1.6023e-04
Loss = 8.6287e-02, PNorm = 35.4793, GNorm = 3.0214, lr_0 = 1.5630e-04
Validation rmse = 0.123730
Epoch 46
Loss = 6.5402e-02, PNorm = 35.4847, GNorm = 1.5592, lr_0 = 1.5209e-04
Validation rmse = 0.124421
Epoch 47
Loss = 1.2547e-01, PNorm = 35.4884, GNorm = 0.8206, lr_0 = 1.4837e-04
Loss = 8.7864e-02, PNorm = 35.4933, GNorm = 1.3816, lr_0 = 1.4473e-04
Validation rmse = 0.123579
Epoch 48
Loss = 9.9132e-02, PNorm = 35.4974, GNorm = 0.8005, lr_0 = 1.4118e-04
Loss = 8.2666e-02, PNorm = 35.5016, GNorm = 1.1121, lr_0 = 1.3772e-04
Validation rmse = 0.123317
Epoch 49
Loss = 7.5919e-02, PNorm = 35.5052, GNorm = 1.0478, lr_0 = 1.3435e-04
Loss = 9.1936e-02, PNorm = 35.5087, GNorm = 1.9138, lr_0 = 1.3106e-04
Validation rmse = 0.123615
Epoch 50
Loss = 8.6189e-02, PNorm = 35.5122, GNorm = 0.4555, lr_0 = 1.2784e-04
Validation rmse = 0.123696
Epoch 51
Loss = 7.1523e-02, PNorm = 35.5168, GNorm = 0.5957, lr_0 = 1.2440e-04
Loss = 9.7694e-02, PNorm = 35.5209, GNorm = 1.6858, lr_0 = 1.2135e-04
Validation rmse = 0.126580
Epoch 52
Loss = 7.4039e-02, PNorm = 35.5234, GNorm = 0.6630, lr_0 = 1.1838e-04
Loss = 9.4608e-02, PNorm = 35.5273, GNorm = 0.8454, lr_0 = 1.1548e-04
Validation rmse = 0.124530
Epoch 53
Loss = 7.3475e-02, PNorm = 35.5306, GNorm = 2.3552, lr_0 = 1.1265e-04
Validation rmse = 0.122990
Epoch 54
Loss = 8.5745e-02, PNorm = 35.5332, GNorm = 0.9114, lr_0 = 1.0989e-04
Loss = 8.3753e-02, PNorm = 35.5374, GNorm = 0.4427, lr_0 = 1.0719e-04
Validation rmse = 0.122779
Epoch 55
Loss = 8.9157e-02, PNorm = 35.5407, GNorm = 1.6164, lr_0 = 1.0457e-04
Loss = 8.1947e-02, PNorm = 35.5439, GNorm = 0.7603, lr_0 = 1.0200e-04
Loss = 5.6474e-02, PNorm = 35.5442, GNorm = 1.2050, lr_0 = 1.0175e-04
Validation rmse = 0.123988
Epoch 56
Loss = 9.5639e-02, PNorm = 35.5472, GNorm = 2.1718, lr_0 = 1.0000e-04
Validation rmse = 0.125584
Epoch 57
Loss = 1.0632e-01, PNorm = 35.5500, GNorm = 1.1556, lr_0 = 1.0000e-04
Loss = 8.2034e-02, PNorm = 35.5529, GNorm = 1.1681, lr_0 = 1.0000e-04
Validation rmse = 0.124037
Epoch 58
Loss = 1.0056e-01, PNorm = 35.5556, GNorm = 0.8926, lr_0 = 1.0000e-04
Loss = 7.1831e-02, PNorm = 35.5591, GNorm = 0.9101, lr_0 = 1.0000e-04
Validation rmse = 0.123108
Epoch 59
Loss = 7.6697e-02, PNorm = 35.5621, GNorm = 0.6554, lr_0 = 1.0000e-04
Validation rmse = 0.122628
Model 0 best validation rmse = 0.122628 on epoch 59
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.216952
Ensemble test rmse = 0.216952
1-fold cross validation
	Seed 0 ==> test rmse = 0.216952
Overall test rmse = 0.216952 +/- 0.000000
Elapsed time = 0:00:32
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,047 | train size = 832 | val size = 209 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.7891e-01, PNorm = 34.0178, GNorm = 1.0750, lr_0 = 4.0937e-04
Validation rmse = 0.290879
Epoch 1
Loss = 6.5693e-01, PNorm = 34.0562, GNorm = 7.1910, lr_0 = 7.1875e-04
Loss = 5.5548e-01, PNorm = 34.0999, GNorm = 2.9728, lr_0 = 1.0000e-03
Validation rmse = 0.256048
Epoch 2
Loss = 4.5083e-01, PNorm = 34.1650, GNorm = 3.6176, lr_0 = 9.7549e-04
Validation rmse = 0.192792
Epoch 3
Loss = 3.8468e-01, PNorm = 34.2318, GNorm = 3.6020, lr_0 = 9.4923e-04
Loss = 3.7320e-01, PNorm = 34.2946, GNorm = 6.4995, lr_0 = 9.2597e-04
Validation rmse = 0.234235
Epoch 4
Loss = 2.7661e-01, PNorm = 34.3388, GNorm = 6.2687, lr_0 = 9.0327e-04
Loss = 3.0651e-01, PNorm = 34.3924, GNorm = 1.3589, lr_0 = 8.8114e-04
Validation rmse = 0.179645
Epoch 5
Loss = 3.5580e-01, PNorm = 34.4350, GNorm = 11.8261, lr_0 = 8.5954e-04
Validation rmse = 0.205256
Epoch 6
Loss = 3.6915e-01, PNorm = 34.4823, GNorm = 8.5559, lr_0 = 8.3640e-04
Loss = 2.5645e-01, PNorm = 34.5212, GNorm = 6.2005, lr_0 = 8.1590e-04
Validation rmse = 0.161047
Epoch 7
Loss = 1.9764e-01, PNorm = 34.5591, GNorm = 2.9388, lr_0 = 7.9591e-04
Loss = 2.1207e-01, PNorm = 34.5922, GNorm = 3.8430, lr_0 = 7.7640e-04
Validation rmse = 0.148268
Epoch 8
Loss = 1.8955e-01, PNorm = 34.6298, GNorm = 1.8742, lr_0 = 7.5737e-04
Validation rmse = 0.160104
Epoch 9
Loss = 1.3998e-01, PNorm = 34.6698, GNorm = 2.0913, lr_0 = 7.3698e-04
Loss = 1.9992e-01, PNorm = 34.6936, GNorm = 2.8340, lr_0 = 7.1892e-04
Validation rmse = 0.139836
Epoch 10
Loss = 2.2138e-01, PNorm = 34.7281, GNorm = 6.4830, lr_0 = 7.0130e-04
Loss = 1.7839e-01, PNorm = 34.7594, GNorm = 4.4840, lr_0 = 6.8412e-04
Validation rmse = 0.138753
Epoch 11
Loss = 1.6958e-01, PNorm = 34.7870, GNorm = 5.4522, lr_0 = 6.6735e-04
Validation rmse = 0.134984
Epoch 12
Loss = 1.2383e-01, PNorm = 34.8140, GNorm = 1.4414, lr_0 = 6.4938e-04
Loss = 1.5920e-01, PNorm = 34.8376, GNorm = 1.9621, lr_0 = 6.3347e-04
Validation rmse = 0.136683
Epoch 13
Loss = 1.4636e-01, PNorm = 34.8624, GNorm = 1.8400, lr_0 = 6.1794e-04
Loss = 1.4879e-01, PNorm = 34.8856, GNorm = 2.7828, lr_0 = 6.0280e-04
Validation rmse = 0.138234
Epoch 14
Loss = 1.2747e-01, PNorm = 34.9091, GNorm = 2.2469, lr_0 = 5.8657e-04
Validation rmse = 0.130980
Epoch 15
Loss = 1.4160e-01, PNorm = 34.9307, GNorm = 0.9546, lr_0 = 5.7219e-04
Loss = 1.4325e-01, PNorm = 34.9477, GNorm = 3.4482, lr_0 = 5.5817e-04
Validation rmse = 0.156294
Epoch 16
Loss = 1.3952e-01, PNorm = 34.9696, GNorm = 2.4044, lr_0 = 5.4449e-04
Loss = 1.5550e-01, PNorm = 34.9910, GNorm = 4.3346, lr_0 = 5.3115e-04
Validation rmse = 0.150673
Epoch 17
Loss = 1.5116e-01, PNorm = 35.0145, GNorm = 5.0778, lr_0 = 5.1685e-04
Validation rmse = 0.127069
Epoch 18
Loss = 9.4717e-02, PNorm = 35.0341, GNorm = 0.8856, lr_0 = 5.0418e-04
Loss = 1.4331e-01, PNorm = 35.0535, GNorm = 3.4699, lr_0 = 4.9182e-04
Validation rmse = 0.128849
Epoch 19
Loss = 1.7214e-01, PNorm = 35.0720, GNorm = 5.5167, lr_0 = 4.7977e-04
Loss = 1.3623e-01, PNorm = 35.0931, GNorm = 2.7659, lr_0 = 4.6801e-04
Validation rmse = 0.140651
Epoch 20
Loss = 9.7668e-02, PNorm = 35.1081, GNorm = 0.8360, lr_0 = 4.5541e-04
Validation rmse = 0.127353
Epoch 21
Loss = 1.0167e-01, PNorm = 35.1239, GNorm = 1.4247, lr_0 = 4.4425e-04
Loss = 1.2091e-01, PNorm = 35.1386, GNorm = 1.5434, lr_0 = 4.3336e-04
Validation rmse = 0.127689
Epoch 22
Loss = 1.2709e-01, PNorm = 35.1507, GNorm = 0.9699, lr_0 = 4.2274e-04
Loss = 1.1620e-01, PNorm = 35.1630, GNorm = 1.2442, lr_0 = 4.1238e-04
Validation rmse = 0.124202
Epoch 23
Loss = 9.5582e-02, PNorm = 35.1763, GNorm = 0.5307, lr_0 = 4.0128e-04
Validation rmse = 0.130956
Epoch 24
Loss = 1.4158e-01, PNorm = 35.1874, GNorm = 1.3166, lr_0 = 3.9145e-04
Loss = 1.1483e-01, PNorm = 35.1984, GNorm = 1.2351, lr_0 = 3.8185e-04
Validation rmse = 0.124193
Epoch 25
Loss = 1.4657e-01, PNorm = 35.2110, GNorm = 2.5399, lr_0 = 3.7250e-04
Loss = 9.8662e-02, PNorm = 35.2228, GNorm = 0.6121, lr_0 = 3.6337e-04
Validation rmse = 0.127253
Epoch 26
Loss = 1.0887e-01, PNorm = 35.2320, GNorm = 4.1177, lr_0 = 3.5358e-04
Validation rmse = 0.125674
Epoch 27
Loss = 1.0135e-01, PNorm = 35.2435, GNorm = 1.3292, lr_0 = 3.4492e-04
Loss = 1.1247e-01, PNorm = 35.2545, GNorm = 2.7494, lr_0 = 3.3646e-04
Validation rmse = 0.122941
Epoch 28
Loss = 1.3128e-01, PNorm = 35.2652, GNorm = 1.5187, lr_0 = 3.2741e-04
Loss = 9.2583e-02, PNorm = 35.2756, GNorm = 1.0183, lr_0 = 3.1938e-04
Validation rmse = 0.123733
Epoch 29
Loss = 1.0470e-01, PNorm = 35.2855, GNorm = 3.4710, lr_0 = 3.1155e-04
Validation rmse = 0.126861
Epoch 30
Loss = 9.9587e-02, PNorm = 35.2949, GNorm = 1.3115, lr_0 = 3.0392e-04
Loss = 9.8640e-02, PNorm = 35.3035, GNorm = 0.5796, lr_0 = 2.9647e-04
Validation rmse = 0.122879
Epoch 31
Loss = 1.0459e-01, PNorm = 35.3131, GNorm = 2.7174, lr_0 = 2.8849e-04
Loss = 9.9394e-02, PNorm = 35.3226, GNorm = 0.8587, lr_0 = 2.8142e-04
Validation rmse = 0.124101
Epoch 32
Loss = 1.0758e-01, PNorm = 35.3306, GNorm = 1.8704, lr_0 = 2.7452e-04
Validation rmse = 0.121876
Epoch 33
Loss = 1.0376e-01, PNorm = 35.3396, GNorm = 1.4050, lr_0 = 2.6779e-04
Loss = 1.0379e-01, PNorm = 35.3473, GNorm = 0.6853, lr_0 = 2.6123e-04
Validation rmse = 0.121101
Epoch 34
Loss = 1.0802e-01, PNorm = 35.3578, GNorm = 1.8277, lr_0 = 2.5420e-04
Loss = 9.7480e-02, PNorm = 35.3643, GNorm = 1.2011, lr_0 = 2.4797e-04
Validation rmse = 0.120244
Epoch 35
Loss = 8.3533e-02, PNorm = 35.3722, GNorm = 0.8310, lr_0 = 2.4189e-04
Validation rmse = 0.127497
Epoch 36
Loss = 1.0027e-01, PNorm = 35.3807, GNorm = 1.4265, lr_0 = 2.3596e-04
Loss = 9.1429e-02, PNorm = 35.3884, GNorm = 1.7475, lr_0 = 2.3018e-04
Validation rmse = 0.120823
Epoch 37
Loss = 8.6480e-02, PNorm = 35.3959, GNorm = 0.9322, lr_0 = 2.2398e-04
Loss = 8.8318e-02, PNorm = 35.4026, GNorm = 2.3993, lr_0 = 2.1849e-04
Validation rmse = 0.129281
Epoch 38
Loss = 9.8422e-02, PNorm = 35.4097, GNorm = 0.5120, lr_0 = 2.1314e-04
Validation rmse = 0.122995
Epoch 39
Loss = 5.9237e-02, PNorm = 35.4177, GNorm = 1.2748, lr_0 = 2.0740e-04
Loss = 9.7321e-02, PNorm = 35.4243, GNorm = 0.7659, lr_0 = 2.0232e-04
Validation rmse = 0.123804
Epoch 40
Loss = 1.0125e-01, PNorm = 35.4313, GNorm = 0.9244, lr_0 = 1.9736e-04
Loss = 9.1213e-02, PNorm = 35.4372, GNorm = 0.5628, lr_0 = 1.9252e-04
Validation rmse = 0.119983
Epoch 41
Loss = 1.0120e-01, PNorm = 35.4441, GNorm = 0.5387, lr_0 = 1.8780e-04
Validation rmse = 0.127251
Epoch 42
Loss = 1.1184e-01, PNorm = 35.4502, GNorm = 2.8873, lr_0 = 1.8275e-04
Loss = 8.8821e-02, PNorm = 35.4565, GNorm = 1.1144, lr_0 = 1.7827e-04
Validation rmse = 0.121582
Epoch 43
Loss = 7.2730e-02, PNorm = 35.4627, GNorm = 0.4793, lr_0 = 1.7390e-04
Loss = 1.0373e-01, PNorm = 35.4685, GNorm = 2.8929, lr_0 = 1.6964e-04
Validation rmse = 0.119790
Epoch 44
Loss = 1.0136e-01, PNorm = 35.4743, GNorm = 2.6729, lr_0 = 1.6548e-04
Validation rmse = 0.128253
Epoch 45
Loss = 5.8317e-02, PNorm = 35.4806, GNorm = 1.3582, lr_0 = 1.6103e-04
Loss = 8.4287e-02, PNorm = 35.4856, GNorm = 1.0001, lr_0 = 1.5708e-04
Validation rmse = 0.122356
Epoch 46
Loss = 7.7600e-02, PNorm = 35.4906, GNorm = 0.9546, lr_0 = 1.5323e-04
Loss = 9.6663e-02, PNorm = 35.4953, GNorm = 1.7954, lr_0 = 1.4948e-04
Validation rmse = 0.126755
Epoch 47
Loss = 8.8779e-02, PNorm = 35.4998, GNorm = 3.3371, lr_0 = 1.4581e-04
Validation rmse = 0.120794
Epoch 48
Loss = 1.4140e-01, PNorm = 35.5039, GNorm = 1.3913, lr_0 = 1.4189e-04
Loss = 8.2108e-02, PNorm = 35.5102, GNorm = 1.1163, lr_0 = 1.3841e-04
Validation rmse = 0.120528
Epoch 49
Loss = 7.6448e-02, PNorm = 35.5141, GNorm = 0.8821, lr_0 = 1.3502e-04
Loss = 9.4167e-02, PNorm = 35.5178, GNorm = 1.6623, lr_0 = 1.3171e-04
Validation rmse = 0.120938
Epoch 50
Loss = 7.3850e-02, PNorm = 35.5229, GNorm = 2.6948, lr_0 = 1.2848e-04
Validation rmse = 0.119136
Epoch 51
Loss = 5.3032e-02, PNorm = 35.5270, GNorm = 0.6283, lr_0 = 1.2502e-04
Loss = 7.4913e-02, PNorm = 35.5307, GNorm = 0.7303, lr_0 = 1.2196e-04
Validation rmse = 0.120839
Epoch 52
Loss = 7.7756e-02, PNorm = 35.5348, GNorm = 0.6049, lr_0 = 1.1897e-04
Loss = 8.8742e-02, PNorm = 35.5385, GNorm = 2.9606, lr_0 = 1.1605e-04
Validation rmse = 0.120016
Epoch 53
Loss = 7.7868e-02, PNorm = 35.5422, GNorm = 0.5008, lr_0 = 1.1293e-04
Validation rmse = 0.120250
Epoch 54
Loss = 8.4811e-02, PNorm = 35.5455, GNorm = 0.8156, lr_0 = 1.1016e-04
Loss = 8.5818e-02, PNorm = 35.5483, GNorm = 0.8817, lr_0 = 1.0746e-04
Validation rmse = 0.120263
Epoch 55
Loss = 1.0176e-01, PNorm = 35.5525, GNorm = 3.2597, lr_0 = 1.0483e-04
Loss = 7.4532e-02, PNorm = 35.5551, GNorm = 1.3191, lr_0 = 1.0226e-04
Validation rmse = 0.119391
Epoch 56
Loss = 8.9438e-02, PNorm = 35.5588, GNorm = 1.4446, lr_0 = 1.0000e-04
Validation rmse = 0.120143
Epoch 57
Loss = 8.3441e-02, PNorm = 35.5621, GNorm = 1.3489, lr_0 = 1.0000e-04
Loss = 8.1006e-02, PNorm = 35.5654, GNorm = 0.6783, lr_0 = 1.0000e-04
Validation rmse = 0.119351
Epoch 58
Loss = 6.7391e-02, PNorm = 35.5676, GNorm = 1.8341, lr_0 = 1.0000e-04
Loss = 8.6204e-02, PNorm = 35.5713, GNorm = 0.5721, lr_0 = 1.0000e-04
Validation rmse = 0.122266
Epoch 59
Loss = 7.5093e-02, PNorm = 35.5747, GNorm = 0.7997, lr_0 = 1.0000e-04
Validation rmse = 0.120155
Model 0 best validation rmse = 0.119136 on epoch 50
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.140795
Ensemble test rmse = 0.140795
1-fold cross validation
	Seed 0 ==> test rmse = 0.140795
Overall test rmse = 0.140795 +/- 0.000000
Elapsed time = 0:00:30
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,037 | train size = 824 | val size = 207 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.3616e-01, PNorm = 34.0153, GNorm = 1.6407, lr_0 = 4.0937e-04
Validation rmse = 0.310620
Epoch 1
Loss = 7.2742e-01, PNorm = 34.0491, GNorm = 4.3890, lr_0 = 7.1875e-04
Loss = 6.9646e-01, PNorm = 34.0975, GNorm = 16.4053, lr_0 = 1.0000e-03
Validation rmse = 0.284185
Epoch 2
Loss = 7.1902e-01, PNorm = 34.1528, GNorm = 11.0494, lr_0 = 9.7308e-04
Validation rmse = 0.246629
Epoch 3
Loss = 5.5542e-01, PNorm = 34.2152, GNorm = 5.8503, lr_0 = 9.4923e-04
Loss = 4.8254e-01, PNorm = 34.2769, GNorm = 5.0754, lr_0 = 9.2597e-04
Validation rmse = 0.260616
Epoch 4
Loss = 4.8363e-01, PNorm = 34.3354, GNorm = 5.3763, lr_0 = 9.0103e-04
Loss = 4.1359e-01, PNorm = 34.3922, GNorm = 1.8873, lr_0 = 8.7895e-04
Validation rmse = 0.209796
Epoch 5
Loss = 3.6291e-01, PNorm = 34.4533, GNorm = 3.3942, lr_0 = 8.5741e-04
Validation rmse = 0.218248
Epoch 6
Loss = 2.4395e-01, PNorm = 34.5085, GNorm = 0.6907, lr_0 = 8.3433e-04
Loss = 2.8793e-01, PNorm = 34.5474, GNorm = 3.0073, lr_0 = 8.1388e-04
Validation rmse = 0.195372
Epoch 7
Loss = 2.2634e-01, PNorm = 34.5913, GNorm = 0.8495, lr_0 = 7.9393e-04
Loss = 2.3122e-01, PNorm = 34.6341, GNorm = 2.2589, lr_0 = 7.7448e-04
Validation rmse = 0.168987
Epoch 8
Loss = 2.3254e-01, PNorm = 34.6710, GNorm = 3.5863, lr_0 = 7.5362e-04
Validation rmse = 0.159860
Epoch 9
Loss = 1.3382e-01, PNorm = 34.7047, GNorm = 2.6256, lr_0 = 7.3516e-04
Loss = 2.0104e-01, PNorm = 34.7425, GNorm = 4.0203, lr_0 = 7.1714e-04
Validation rmse = 0.159495
Epoch 10
Loss = 1.9183e-01, PNorm = 34.7801, GNorm = 0.5638, lr_0 = 6.9783e-04
Loss = 1.5428e-01, PNorm = 34.8124, GNorm = 2.1201, lr_0 = 6.8073e-04
Validation rmse = 0.172529
Epoch 11
Loss = 1.7062e-01, PNorm = 34.8480, GNorm = 1.0658, lr_0 = 6.6405e-04
Validation rmse = 0.152620
Epoch 12
Loss = 1.7294e-01, PNorm = 34.8788, GNorm = 1.3410, lr_0 = 6.4617e-04
Loss = 1.6870e-01, PNorm = 34.9046, GNorm = 5.3084, lr_0 = 6.3033e-04
Validation rmse = 0.149315
Epoch 13
Loss = 1.2154e-01, PNorm = 34.9270, GNorm = 5.2511, lr_0 = 6.1488e-04
Loss = 1.7993e-01, PNorm = 34.9544, GNorm = 3.4997, lr_0 = 5.9981e-04
Loss = 1.7692e-01, PNorm = 34.9571, GNorm = 3.8088, lr_0 = 5.9833e-04
Validation rmse = 0.147519
Epoch 14
Loss = 1.1840e-01, PNorm = 34.9840, GNorm = 2.5298, lr_0 = 5.8367e-04
Validation rmse = 0.142986
Epoch 15
Loss = 1.1242e-01, PNorm = 35.0055, GNorm = 0.7376, lr_0 = 5.6936e-04
Loss = 1.4645e-01, PNorm = 35.0267, GNorm = 0.6632, lr_0 = 5.5541e-04
Validation rmse = 0.157362
Epoch 16
Loss = 1.2274e-01, PNorm = 35.0516, GNorm = 1.0228, lr_0 = 5.4045e-04
Loss = 1.6301e-01, PNorm = 35.0672, GNorm = 2.1995, lr_0 = 5.2721e-04
Validation rmse = 0.141480
Epoch 17
Loss = 1.4163e-01, PNorm = 35.0838, GNorm = 5.0928, lr_0 = 5.1429e-04
Validation rmse = 0.144103
Epoch 18
Loss = 1.2825e-01, PNorm = 35.1025, GNorm = 3.0809, lr_0 = 5.0044e-04
Loss = 1.2700e-01, PNorm = 35.1213, GNorm = 2.4286, lr_0 = 4.8818e-04
Validation rmse = 0.140371
Epoch 19
Loss = 1.1115e-01, PNorm = 35.1360, GNorm = 1.2993, lr_0 = 4.7621e-04
Validation rmse = 0.139212
Epoch 20
Loss = 1.2311e-01, PNorm = 35.1562, GNorm = 0.5374, lr_0 = 4.6339e-04
Loss = 1.1452e-01, PNorm = 35.1706, GNorm = 1.5747, lr_0 = 4.5204e-04
Validation rmse = 0.139478
Epoch 21
Loss = 1.0330e-01, PNorm = 35.1855, GNorm = 2.5118, lr_0 = 4.4096e-04
Loss = 1.3106e-01, PNorm = 35.1982, GNorm = 2.9776, lr_0 = 4.3015e-04
Validation rmse = 0.136713
Epoch 22
Loss = 1.2716e-01, PNorm = 35.2139, GNorm = 0.9801, lr_0 = 4.1857e-04
Validation rmse = 0.145708
Epoch 23
Loss = 1.5748e-01, PNorm = 35.2272, GNorm = 3.0109, lr_0 = 4.0831e-04
Loss = 1.1241e-01, PNorm = 35.2411, GNorm = 2.1866, lr_0 = 3.9830e-04
Validation rmse = 0.144075
Epoch 24
Loss = 9.6150e-02, PNorm = 35.2533, GNorm = 0.8884, lr_0 = 3.8758e-04
Loss = 1.1595e-01, PNorm = 35.2662, GNorm = 4.3708, lr_0 = 3.7808e-04
Validation rmse = 0.140540
Epoch 25
Loss = 1.1538e-01, PNorm = 35.2751, GNorm = 1.1947, lr_0 = 3.6882e-04
Validation rmse = 0.150044
Epoch 26
Loss = 8.7800e-02, PNorm = 35.2874, GNorm = 3.5945, lr_0 = 3.5889e-04
Loss = 1.1083e-01, PNorm = 35.2956, GNorm = 1.8590, lr_0 = 3.5009e-04
Validation rmse = 0.152685
Epoch 27
Loss = 1.1213e-01, PNorm = 35.3101, GNorm = 1.2483, lr_0 = 3.4067e-04
Loss = 1.2002e-01, PNorm = 35.3199, GNorm = 1.4527, lr_0 = 3.3232e-04
Validation rmse = 0.145412
Epoch 28
Loss = 1.1623e-01, PNorm = 35.3322, GNorm = 4.4830, lr_0 = 3.2417e-04
Validation rmse = 0.155386
Epoch 29
Loss = 8.5405e-02, PNorm = 35.3406, GNorm = 1.0752, lr_0 = 3.1544e-04
Loss = 1.0565e-01, PNorm = 35.3520, GNorm = 1.2617, lr_0 = 3.0771e-04
Validation rmse = 0.139631
Epoch 30
Loss = 9.7757e-02, PNorm = 35.3612, GNorm = 0.3986, lr_0 = 3.0017e-04
Loss = 1.0027e-01, PNorm = 35.3697, GNorm = 1.3059, lr_0 = 2.9282e-04
Loss = 5.0645e-02, PNorm = 35.3701, GNorm = 1.0509, lr_0 = 2.9209e-04
Validation rmse = 0.139329
Epoch 31
Loss = 1.0591e-01, PNorm = 35.3780, GNorm = 1.5136, lr_0 = 2.8493e-04
Validation rmse = 0.144384
Epoch 32
Loss = 8.3224e-02, PNorm = 35.3861, GNorm = 2.3960, lr_0 = 2.7795e-04
Loss = 1.0780e-01, PNorm = 35.3943, GNorm = 4.0280, lr_0 = 2.7114e-04
Validation rmse = 0.137041
Epoch 33
Loss = 1.0399e-01, PNorm = 35.4012, GNorm = 1.2398, lr_0 = 2.6384e-04
Loss = 9.3476e-02, PNorm = 35.4104, GNorm = 1.1514, lr_0 = 2.5737e-04
Validation rmse = 0.144965
Epoch 34
Loss = 9.4436e-02, PNorm = 35.4181, GNorm = 1.6068, lr_0 = 2.5106e-04
Validation rmse = 0.142862
Epoch 35
Loss = 1.0467e-01, PNorm = 35.4262, GNorm = 1.1761, lr_0 = 2.4430e-04
Loss = 9.1300e-02, PNorm = 35.4335, GNorm = 3.3905, lr_0 = 2.3832e-04
Validation rmse = 0.140415
Epoch 36
Loss = 9.2090e-02, PNorm = 35.4412, GNorm = 1.6385, lr_0 = 2.3248e-04
Validation rmse = 0.147975
Epoch 37
Loss = 9.0955e-02, PNorm = 35.4480, GNorm = 2.3365, lr_0 = 2.2622e-04
Loss = 1.0426e-01, PNorm = 35.4541, GNorm = 0.8807, lr_0 = 2.2067e-04
Validation rmse = 0.143356
Epoch 38
Loss = 1.2452e-01, PNorm = 35.4603, GNorm = 0.7363, lr_0 = 2.1527e-04
Loss = 8.1633e-02, PNorm = 35.4659, GNorm = 1.2721, lr_0 = 2.0999e-04
Validation rmse = 0.139527
Epoch 39
Loss = 9.5951e-02, PNorm = 35.4727, GNorm = 3.4652, lr_0 = 2.0434e-04
Validation rmse = 0.149160
Epoch 40
Loss = 8.0682e-02, PNorm = 35.4775, GNorm = 2.4408, lr_0 = 1.9933e-04
Loss = 1.0814e-01, PNorm = 35.4832, GNorm = 4.6551, lr_0 = 1.9444e-04
Validation rmse = 0.138602
Epoch 41
Loss = 8.4412e-02, PNorm = 35.4886, GNorm = 0.6949, lr_0 = 1.8921e-04
Loss = 9.5086e-02, PNorm = 35.4935, GNorm = 2.0742, lr_0 = 1.8457e-04
Validation rmse = 0.137653
Epoch 42
Loss = 8.1780e-02, PNorm = 35.4998, GNorm = 1.9340, lr_0 = 1.8005e-04
Validation rmse = 0.140075
Epoch 43
Loss = 8.4059e-02, PNorm = 35.5069, GNorm = 0.9412, lr_0 = 1.7520e-04
Loss = 8.2733e-02, PNorm = 35.5117, GNorm = 2.3338, lr_0 = 1.7091e-04
Validation rmse = 0.139879
Epoch 44
Loss = 7.6168e-02, PNorm = 35.5162, GNorm = 1.6541, lr_0 = 1.6672e-04
Loss = 9.2915e-02, PNorm = 35.5213, GNorm = 2.0921, lr_0 = 1.6263e-04
Validation rmse = 0.138747
Epoch 45
Loss = 8.7581e-02, PNorm = 35.5260, GNorm = 0.4808, lr_0 = 1.5825e-04
Validation rmse = 0.138915
Epoch 46
Loss = 1.1909e-01, PNorm = 35.5308, GNorm = 2.0112, lr_0 = 1.5438e-04
Loss = 8.3573e-02, PNorm = 35.5347, GNorm = 1.1206, lr_0 = 1.5059e-04
Validation rmse = 0.144860
Epoch 47
Loss = 8.2159e-02, PNorm = 35.5395, GNorm = 1.4339, lr_0 = 1.4654e-04
Loss = 8.6650e-02, PNorm = 35.5440, GNorm = 0.7028, lr_0 = 1.4295e-04
Validation rmse = 0.139874
Epoch 48
Loss = 8.6969e-02, PNorm = 35.5477, GNorm = 1.1232, lr_0 = 1.3944e-04
Validation rmse = 0.137260
Epoch 49
Loss = 8.4955e-02, PNorm = 35.5511, GNorm = 0.6174, lr_0 = 1.3569e-04
Loss = 8.8156e-02, PNorm = 35.5549, GNorm = 1.4523, lr_0 = 1.3236e-04
Validation rmse = 0.139645
Epoch 50
Loss = 8.0101e-02, PNorm = 35.5588, GNorm = 0.4461, lr_0 = 1.2912e-04
Loss = 8.8817e-02, PNorm = 35.5624, GNorm = 0.9944, lr_0 = 1.2596e-04
Loss = 4.8592e-02, PNorm = 35.5627, GNorm = 1.3831, lr_0 = 1.2564e-04
Validation rmse = 0.137865
Epoch 51
Loss = 8.4532e-02, PNorm = 35.5658, GNorm = 1.5631, lr_0 = 1.2256e-04
Validation rmse = 0.142865
Epoch 52
Loss = 8.8976e-02, PNorm = 35.5702, GNorm = 2.0451, lr_0 = 1.1926e-04
Loss = 8.3399e-02, PNorm = 35.5734, GNorm = 1.8142, lr_0 = 1.1634e-04
Validation rmse = 0.141420
Epoch 53
Loss = 9.3890e-02, PNorm = 35.5773, GNorm = 2.4614, lr_0 = 1.1349e-04
Validation rmse = 0.137025
Epoch 54
Loss = 1.6140e-01, PNorm = 35.5816, GNorm = 2.1543, lr_0 = 1.1043e-04
Loss = 7.4638e-02, PNorm = 35.5854, GNorm = 1.1920, lr_0 = 1.0773e-04
Validation rmse = 0.138085
Epoch 55
Loss = 9.9976e-02, PNorm = 35.5878, GNorm = 1.5200, lr_0 = 1.0509e-04
Loss = 7.5333e-02, PNorm = 35.5905, GNorm = 0.9091, lr_0 = 1.0251e-04
Validation rmse = 0.136869
Epoch 56
Loss = 6.9684e-02, PNorm = 35.5936, GNorm = 0.6248, lr_0 = 1.0000e-04
Validation rmse = 0.138528
Epoch 57
Loss = 4.2427e-02, PNorm = 35.5965, GNorm = 0.4642, lr_0 = 1.0000e-04
Loss = 7.6710e-02, PNorm = 35.5992, GNorm = 1.6090, lr_0 = 1.0000e-04
Validation rmse = 0.139206
Epoch 58
Loss = 7.3199e-02, PNorm = 35.6019, GNorm = 1.9230, lr_0 = 1.0000e-04
Loss = 8.8740e-02, PNorm = 35.6047, GNorm = 0.9932, lr_0 = 1.0000e-04
Validation rmse = 0.138230
Epoch 59
Loss = 8.9895e-02, PNorm = 35.6084, GNorm = 0.5147, lr_0 = 1.0000e-04
Validation rmse = 0.136947
Model 0 best validation rmse = 0.136713 on epoch 21
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.116753
Ensemble test rmse = 0.116753
1-fold cross validation
	Seed 0 ==> test rmse = 0.116753
Overall test rmse = 0.116753 +/- 0.000000
Elapsed time = 0:00:30
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,027 | train size = 816 | val size = 205 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.8985e-01, PNorm = 34.0170, GNorm = 4.2939, lr_0 = 4.0937e-04
Validation rmse = 0.286416
Epoch 1
Loss = 7.3724e-01, PNorm = 34.0523, GNorm = 4.0310, lr_0 = 7.1875e-04
Loss = 6.9252e-01, PNorm = 34.0961, GNorm = 12.7387, lr_0 = 1.0000e-03
Validation rmse = 0.266086
Epoch 2
Loss = 5.6058e-01, PNorm = 34.1579, GNorm = 13.2908, lr_0 = 9.7308e-04
Validation rmse = 0.237655
Epoch 3
Loss = 4.0158e-01, PNorm = 34.2168, GNorm = 1.0050, lr_0 = 9.4688e-04
Loss = 4.5670e-01, PNorm = 34.2754, GNorm = 7.1173, lr_0 = 9.2367e-04
Validation rmse = 0.251881
Epoch 4
Loss = 3.8856e-01, PNorm = 34.3271, GNorm = 4.2152, lr_0 = 9.0103e-04
Loss = 3.7764e-01, PNorm = 34.3747, GNorm = 1.8205, lr_0 = 8.7895e-04
Validation rmse = 0.205973
Epoch 5
Loss = 2.4270e-01, PNorm = 34.4226, GNorm = 3.3506, lr_0 = 8.5529e-04
Validation rmse = 0.196580
Epoch 6
Loss = 2.5464e-01, PNorm = 34.4753, GNorm = 1.5511, lr_0 = 8.3226e-04
Loss = 2.1705e-01, PNorm = 34.5192, GNorm = 2.4591, lr_0 = 8.1186e-04
Validation rmse = 0.189491
Epoch 7
Loss = 2.3035e-01, PNorm = 34.5580, GNorm = 4.5120, lr_0 = 7.9197e-04
Loss = 1.8779e-01, PNorm = 34.6009, GNorm = 3.3196, lr_0 = 7.7256e-04
Loss = 2.2705e-01, PNorm = 34.6059, GNorm = 2.3365, lr_0 = 7.7064e-04
Validation rmse = 0.175847
Epoch 8
Loss = 1.8728e-01, PNorm = 34.6435, GNorm = 3.2017, lr_0 = 7.5176e-04
Validation rmse = 0.162677
Epoch 9
Loss = 2.1196e-01, PNorm = 34.6795, GNorm = 3.2218, lr_0 = 7.3152e-04
Loss = 1.8685e-01, PNorm = 34.7144, GNorm = 2.7028, lr_0 = 7.1359e-04
Validation rmse = 0.161401
Epoch 10
Loss = 1.6866e-01, PNorm = 34.7496, GNorm = 3.9176, lr_0 = 6.9610e-04
Validation rmse = 0.162744
Epoch 11
Loss = 9.5737e-02, PNorm = 34.7807, GNorm = 1.1429, lr_0 = 6.7736e-04
Loss = 1.6190e-01, PNorm = 34.8101, GNorm = 5.0530, lr_0 = 6.6076e-04
Validation rmse = 0.156376
Epoch 12
Loss = 1.2757e-01, PNorm = 34.8364, GNorm = 1.3849, lr_0 = 6.4297e-04
Loss = 1.3966e-01, PNorm = 34.8617, GNorm = 1.6478, lr_0 = 6.2721e-04
Validation rmse = 0.149194
Epoch 13
Loss = 1.3244e-01, PNorm = 34.8832, GNorm = 2.2403, lr_0 = 6.1184e-04
Validation rmse = 0.146005
Epoch 14
Loss = 1.2846e-01, PNorm = 34.9105, GNorm = 1.7734, lr_0 = 5.9537e-04
Loss = 1.2138e-01, PNorm = 34.9322, GNorm = 4.0521, lr_0 = 5.8078e-04
Validation rmse = 0.146665
Epoch 15
Loss = 1.2452e-01, PNorm = 34.9542, GNorm = 1.9497, lr_0 = 5.6514e-04
Loss = 1.4047e-01, PNorm = 34.9763, GNorm = 0.8231, lr_0 = 5.5129e-04
Validation rmse = 0.148903
Epoch 16
Loss = 1.2176e-01, PNorm = 34.9978, GNorm = 0.6622, lr_0 = 5.3778e-04
Validation rmse = 0.162000
Epoch 17
Loss = 1.5029e-01, PNorm = 35.0166, GNorm = 1.9842, lr_0 = 5.2330e-04
Loss = 1.3414e-01, PNorm = 35.0333, GNorm = 4.1336, lr_0 = 5.1047e-04
Validation rmse = 0.160195
Epoch 18
Loss = 1.1750e-01, PNorm = 35.0546, GNorm = 0.8347, lr_0 = 4.9673e-04
Loss = 1.2169e-01, PNorm = 35.0700, GNorm = 4.0452, lr_0 = 4.8456e-04
Validation rmse = 0.144254
Epoch 19
Loss = 1.2497e-01, PNorm = 35.0855, GNorm = 1.2741, lr_0 = 4.7268e-04
Validation rmse = 0.141253
Epoch 20
Loss = 8.7960e-02, PNorm = 35.1030, GNorm = 1.1625, lr_0 = 4.5996e-04
Loss = 1.1718e-01, PNorm = 35.1169, GNorm = 1.6211, lr_0 = 4.4868e-04
Validation rmse = 0.139369
Epoch 21
Loss = 1.2385e-01, PNorm = 35.1318, GNorm = 4.1097, lr_0 = 4.3660e-04
Validation rmse = 0.141632
Epoch 22
Loss = 7.1271e-02, PNorm = 35.1454, GNorm = 1.6095, lr_0 = 4.2590e-04
Loss = 9.5222e-02, PNorm = 35.1579, GNorm = 1.2617, lr_0 = 4.1547e-04
Validation rmse = 0.155640
Epoch 23
Loss = 9.8363e-02, PNorm = 35.1740, GNorm = 0.4352, lr_0 = 4.0428e-04
Loss = 1.1295e-01, PNorm = 35.1851, GNorm = 2.1653, lr_0 = 3.9437e-04
Validation rmse = 0.142487
Epoch 24
Loss = 9.4694e-02, PNorm = 35.1975, GNorm = 1.1328, lr_0 = 3.8375e-04
Validation rmse = 0.138579
Epoch 25
Loss = 1.0367e-01, PNorm = 35.2106, GNorm = 1.2138, lr_0 = 3.7435e-04
Loss = 8.5690e-02, PNorm = 35.2239, GNorm = 0.6523, lr_0 = 3.6517e-04
Validation rmse = 0.141664
Epoch 26
Loss = 7.6536e-02, PNorm = 35.2361, GNorm = 1.1870, lr_0 = 3.5534e-04
Loss = 1.1610e-01, PNorm = 35.2448, GNorm = 1.9844, lr_0 = 3.4663e-04
Loss = 1.2690e-01, PNorm = 35.2459, GNorm = 5.2411, lr_0 = 3.4577e-04
Validation rmse = 0.145229
Epoch 27
Loss = 1.0549e-01, PNorm = 35.2561, GNorm = 2.8608, lr_0 = 3.3730e-04
Validation rmse = 0.137983
Epoch 28
Loss = 7.4110e-02, PNorm = 35.2698, GNorm = 1.8944, lr_0 = 3.2822e-04
Loss = 1.1550e-01, PNorm = 35.2801, GNorm = 0.8154, lr_0 = 3.2018e-04
Validation rmse = 0.149539
Epoch 29
Loss = 9.2580e-02, PNorm = 35.2921, GNorm = 0.9509, lr_0 = 3.1233e-04
Validation rmse = 0.137191
Epoch 30
Loss = 8.1707e-02, PNorm = 35.3020, GNorm = 1.0233, lr_0 = 3.0392e-04
Loss = 9.5524e-02, PNorm = 35.3103, GNorm = 2.6528, lr_0 = 2.9647e-04
Validation rmse = 0.143634
Epoch 31
Loss = 1.0288e-01, PNorm = 35.3206, GNorm = 1.4373, lr_0 = 2.8849e-04
Loss = 8.2509e-02, PNorm = 35.3287, GNorm = 1.0912, lr_0 = 2.8142e-04
Validation rmse = 0.142391
Epoch 32
Loss = 9.4812e-02, PNorm = 35.3374, GNorm = 0.8967, lr_0 = 2.7452e-04
Validation rmse = 0.142543
Epoch 33
Loss = 8.7024e-02, PNorm = 35.3452, GNorm = 2.2940, lr_0 = 2.6713e-04
Loss = 8.7075e-02, PNorm = 35.3542, GNorm = 0.8222, lr_0 = 2.6058e-04
Validation rmse = 0.144886
Epoch 34
Loss = 7.7066e-02, PNorm = 35.3623, GNorm = 1.2505, lr_0 = 2.5357e-04
Loss = 9.2060e-02, PNorm = 35.3711, GNorm = 0.4734, lr_0 = 2.4735e-04
Validation rmse = 0.137617
Epoch 35
Loss = 7.2351e-02, PNorm = 35.3772, GNorm = 0.6310, lr_0 = 2.4129e-04
Validation rmse = 0.147071
Epoch 36
Loss = 7.8471e-02, PNorm = 35.3858, GNorm = 1.1353, lr_0 = 2.3480e-04
Loss = 8.7064e-02, PNorm = 35.3932, GNorm = 0.6468, lr_0 = 2.2904e-04
Validation rmse = 0.140665
Epoch 37
Loss = 8.9238e-02, PNorm = 35.3997, GNorm = 0.9085, lr_0 = 2.2287e-04
Loss = 8.1585e-02, PNorm = 35.4075, GNorm = 2.1288, lr_0 = 2.1741e-04
Validation rmse = 0.139369
Epoch 38
Loss = 8.5530e-02, PNorm = 35.4148, GNorm = 0.6578, lr_0 = 2.1208e-04
Validation rmse = 0.145178
Epoch 39
Loss = 8.2173e-02, PNorm = 35.4219, GNorm = 2.0622, lr_0 = 2.0637e-04
Loss = 8.2088e-02, PNorm = 35.4282, GNorm = 0.9433, lr_0 = 2.0132e-04
Validation rmse = 0.137557
Epoch 40
Loss = 7.3446e-02, PNorm = 35.4347, GNorm = 0.8770, lr_0 = 1.9590e-04
Validation rmse = 0.140830
Epoch 41
Loss = 1.6486e-01, PNorm = 35.4401, GNorm = 0.9803, lr_0 = 1.9110e-04
Loss = 7.5368e-02, PNorm = 35.4468, GNorm = 2.3725, lr_0 = 1.8641e-04
Validation rmse = 0.149861
Epoch 42
Loss = 6.4802e-02, PNorm = 35.4529, GNorm = 0.6894, lr_0 = 1.8139e-04
Loss = 8.1673e-02, PNorm = 35.4586, GNorm = 0.8113, lr_0 = 1.7695e-04
Validation rmse = 0.136905
Epoch 43
Loss = 6.2442e-02, PNorm = 35.4638, GNorm = 0.9664, lr_0 = 1.7218e-04
Validation rmse = 0.139264
Epoch 44
Loss = 6.2876e-02, PNorm = 35.4690, GNorm = 0.8034, lr_0 = 1.6796e-04
Loss = 7.6011e-02, PNorm = 35.4734, GNorm = 0.8071, lr_0 = 1.6385e-04
Validation rmse = 0.142133
Epoch 45
Loss = 8.1724e-02, PNorm = 35.4792, GNorm = 0.5993, lr_0 = 1.5944e-04
Loss = 7.5487e-02, PNorm = 35.4850, GNorm = 1.0051, lr_0 = 1.5553e-04
Loss = 1.8321e-02, PNorm = 35.4857, GNorm = 1.4310, lr_0 = 1.5514e-04
Validation rmse = 0.140455
Epoch 46
Loss = 8.1865e-02, PNorm = 35.4902, GNorm = 1.0736, lr_0 = 1.5134e-04
Validation rmse = 0.141308
Epoch 47
Loss = 6.4077e-02, PNorm = 35.4951, GNorm = 1.2867, lr_0 = 1.4763e-04
Loss = 8.0875e-02, PNorm = 35.4994, GNorm = 0.9321, lr_0 = 1.4401e-04
Validation rmse = 0.140094
Epoch 48
Loss = 6.3761e-02, PNorm = 35.5041, GNorm = 0.9282, lr_0 = 1.4014e-04
Validation rmse = 0.142984
Epoch 49
Loss = 1.1520e-01, PNorm = 35.5091, GNorm = 1.6136, lr_0 = 1.3636e-04
Loss = 6.8021e-02, PNorm = 35.5130, GNorm = 0.8290, lr_0 = 1.3302e-04
Validation rmse = 0.141851
Epoch 50
Loss = 5.8148e-02, PNorm = 35.5165, GNorm = 0.8147, lr_0 = 1.2976e-04
Loss = 8.0897e-02, PNorm = 35.5205, GNorm = 0.5735, lr_0 = 1.2658e-04
Validation rmse = 0.141995
Epoch 51
Loss = 8.6220e-02, PNorm = 35.5242, GNorm = 0.6508, lr_0 = 1.2317e-04
Validation rmse = 0.139485
Epoch 52
Loss = 1.0451e-01, PNorm = 35.5286, GNorm = 2.0530, lr_0 = 1.1986e-04
Loss = 7.8709e-02, PNorm = 35.5328, GNorm = 1.9679, lr_0 = 1.1692e-04
Validation rmse = 0.137330
Epoch 53
Loss = 6.6122e-02, PNorm = 35.5371, GNorm = 1.0470, lr_0 = 1.1377e-04
Loss = 8.3767e-02, PNorm = 35.5403, GNorm = 0.4502, lr_0 = 1.1098e-04
Validation rmse = 0.145709
Epoch 54
Loss = 6.9024e-02, PNorm = 35.5428, GNorm = 2.8937, lr_0 = 1.0826e-04
Validation rmse = 0.143296
Epoch 55
Loss = 6.4763e-02, PNorm = 35.5472, GNorm = 1.0590, lr_0 = 1.0535e-04
Loss = 7.3179e-02, PNorm = 35.5507, GNorm = 1.6432, lr_0 = 1.0277e-04
Validation rmse = 0.138120
Epoch 56
Loss = 6.3705e-02, PNorm = 35.5547, GNorm = 0.4359, lr_0 = 1.0000e-04
Loss = 8.9661e-02, PNorm = 35.5570, GNorm = 1.6299, lr_0 = 1.0000e-04
Validation rmse = 0.139072
Epoch 57
Loss = 7.1981e-02, PNorm = 35.5609, GNorm = 2.8876, lr_0 = 1.0000e-04
Validation rmse = 0.138362
Epoch 58
Loss = 8.6495e-02, PNorm = 35.5632, GNorm = 2.3327, lr_0 = 1.0000e-04
Loss = 7.3196e-02, PNorm = 35.5661, GNorm = 2.0998, lr_0 = 1.0000e-04
Validation rmse = 0.145161
Epoch 59
Loss = 7.2702e-02, PNorm = 35.5696, GNorm = 1.1657, lr_0 = 1.0000e-04
Validation rmse = 0.142722
Model 0 best validation rmse = 0.136905 on epoch 42
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.140289
Ensemble test rmse = 0.140289
1-fold cross validation
	Seed 0 ==> test rmse = 0.140289
Overall test rmse = 0.140289 +/- 0.000000
Elapsed time = 0:00:31
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,017 | train size = 808 | val size = 203 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1156e-01, PNorm = 34.0166, GNorm = 1.5031, lr_0 = 4.0937e-04
Validation rmse = 0.300363
Epoch 1
Loss = 6.8667e-01, PNorm = 34.0498, GNorm = 11.6667, lr_0 = 7.1875e-04
Loss = 7.1924e-01, PNorm = 34.0912, GNorm = 4.9472, lr_0 = 1.0000e-03
Validation rmse = 0.316638
Epoch 2
Loss = 5.5368e-01, PNorm = 34.1594, GNorm = 3.5786, lr_0 = 9.7308e-04
Validation rmse = 0.247191
Epoch 3
Loss = 4.1679e-01, PNorm = 34.2313, GNorm = 3.2119, lr_0 = 9.4688e-04
Loss = 3.9426e-01, PNorm = 34.2904, GNorm = 1.1701, lr_0 = 9.2367e-04
Validation rmse = 0.213228
Epoch 4
Loss = 3.4933e-01, PNorm = 34.3587, GNorm = 3.6590, lr_0 = 8.9880e-04
Loss = 2.4858e-01, PNorm = 34.4064, GNorm = 1.6451, lr_0 = 8.7677e-04
Loss = 2.7141e-01, PNorm = 34.4112, GNorm = 9.9032, lr_0 = 8.7460e-04
Validation rmse = 0.257162
Epoch 5
Loss = 3.1118e-01, PNorm = 34.4489, GNorm = 2.1397, lr_0 = 8.5317e-04
Validation rmse = 0.185174
Epoch 6
Loss = 2.7640e-01, PNorm = 34.4884, GNorm = 1.2133, lr_0 = 8.3020e-04
Loss = 2.3922e-01, PNorm = 34.5355, GNorm = 2.6765, lr_0 = 8.0985e-04
Validation rmse = 0.168113
Epoch 7
Loss = 2.3733e-01, PNorm = 34.5724, GNorm = 6.3088, lr_0 = 7.9000e-04
Validation rmse = 0.170177
Epoch 8
Loss = 2.4614e-01, PNorm = 34.6098, GNorm = 3.7996, lr_0 = 7.6873e-04
Loss = 2.2984e-01, PNorm = 34.6400, GNorm = 5.0120, lr_0 = 7.4989e-04
Validation rmse = 0.159082
Epoch 9
Loss = 2.0337e-01, PNorm = 34.6700, GNorm = 1.0318, lr_0 = 7.2970e-04
Loss = 2.3471e-01, PNorm = 34.6992, GNorm = 6.3523, lr_0 = 7.1182e-04
Validation rmse = 0.164846
Epoch 10
Loss = 1.6480e-01, PNorm = 34.7304, GNorm = 3.3070, lr_0 = 6.9266e-04
Validation rmse = 0.162192
Epoch 11
Loss = 1.6260e-01, PNorm = 34.7570, GNorm = 1.8848, lr_0 = 6.7401e-04
Loss = 1.6045e-01, PNorm = 34.7850, GNorm = 0.9043, lr_0 = 6.5749e-04
Validation rmse = 0.150892
Epoch 12
Loss = 1.6201e-01, PNorm = 34.8181, GNorm = 0.9177, lr_0 = 6.3979e-04
Loss = 1.7388e-01, PNorm = 34.8369, GNorm = 6.7835, lr_0 = 6.2411e-04
Validation rmse = 0.153117
Epoch 13
Loss = 1.6598e-01, PNorm = 34.8615, GNorm = 1.0995, lr_0 = 6.0881e-04
Validation rmse = 0.139044
Epoch 14
Loss = 1.3737e-01, PNorm = 34.8808, GNorm = 1.8857, lr_0 = 5.9242e-04
Loss = 1.3873e-01, PNorm = 34.8973, GNorm = 1.6091, lr_0 = 5.7790e-04
Validation rmse = 0.139197
Epoch 15
Loss = 1.1882e-01, PNorm = 34.9162, GNorm = 1.8111, lr_0 = 5.6234e-04
Validation rmse = 0.135288
Epoch 16
Loss = 1.1079e-01, PNorm = 34.9384, GNorm = 1.6243, lr_0 = 5.4720e-04
Loss = 1.2810e-01, PNorm = 34.9594, GNorm = 4.4366, lr_0 = 5.3379e-04
Validation rmse = 0.142013
Epoch 17
Loss = 1.1852e-01, PNorm = 34.9753, GNorm = 2.2318, lr_0 = 5.1942e-04
Loss = 1.3866e-01, PNorm = 34.9908, GNorm = 1.9552, lr_0 = 5.0669e-04
Loss = 6.5677e-02, PNorm = 34.9919, GNorm = 4.3073, lr_0 = 5.0543e-04
Validation rmse = 0.158715
Epoch 18
Loss = 1.3658e-01, PNorm = 35.0023, GNorm = 1.3670, lr_0 = 4.9305e-04
Validation rmse = 0.148508
Epoch 19
Loss = 1.1330e-01, PNorm = 35.0181, GNorm = 1.1892, lr_0 = 4.8096e-04
Loss = 1.2548e-01, PNorm = 35.0320, GNorm = 0.9017, lr_0 = 4.6918e-04
Validation rmse = 0.134381
Epoch 20
Loss = 9.5514e-02, PNorm = 35.0495, GNorm = 2.1565, lr_0 = 4.5654e-04
Validation rmse = 0.135826
Epoch 21
Loss = 6.4846e-02, PNorm = 35.0657, GNorm = 2.9267, lr_0 = 4.4425e-04
Loss = 1.3073e-01, PNorm = 35.0796, GNorm = 1.7465, lr_0 = 4.3336e-04
Validation rmse = 0.144066
Epoch 22
Loss = 1.4527e-01, PNorm = 35.0981, GNorm = 4.1722, lr_0 = 4.2170e-04
Loss = 1.2315e-01, PNorm = 35.1111, GNorm = 1.8463, lr_0 = 4.1136e-04
Validation rmse = 0.142431
Epoch 23
Loss = 1.6432e-01, PNorm = 35.1286, GNorm = 1.4725, lr_0 = 4.0029e-04
Validation rmse = 0.142381
Epoch 24
Loss = 1.0937e-01, PNorm = 35.1432, GNorm = 3.0889, lr_0 = 3.8951e-04
Loss = 1.3293e-01, PNorm = 35.1548, GNorm = 1.2401, lr_0 = 3.7996e-04
Validation rmse = 0.138184
Epoch 25
Loss = 1.1006e-01, PNorm = 35.1688, GNorm = 2.6160, lr_0 = 3.7065e-04
Loss = 1.1765e-01, PNorm = 35.1807, GNorm = 0.8022, lr_0 = 3.6157e-04
Loss = 1.1033e-01, PNorm = 35.1815, GNorm = 2.1569, lr_0 = 3.6067e-04
Validation rmse = 0.139102
Epoch 26
Loss = 1.0406e-01, PNorm = 35.1917, GNorm = 1.5757, lr_0 = 3.5183e-04
Validation rmse = 0.139567
Epoch 27
Loss = 1.2406e-01, PNorm = 35.2042, GNorm = 1.3402, lr_0 = 3.4236e-04
Loss = 1.1059e-01, PNorm = 35.2183, GNorm = 0.9081, lr_0 = 3.3397e-04
Validation rmse = 0.147612
Epoch 28
Loss = 1.2069e-01, PNorm = 35.2279, GNorm = 0.8761, lr_0 = 3.2498e-04
Validation rmse = 0.132204
Epoch 29
Loss = 9.4401e-02, PNorm = 35.2366, GNorm = 0.7946, lr_0 = 3.1623e-04
Loss = 8.3496e-02, PNorm = 35.2434, GNorm = 0.6023, lr_0 = 3.0848e-04
Validation rmse = 0.132258
Epoch 30
Loss = 7.3229e-02, PNorm = 35.2535, GNorm = 1.3716, lr_0 = 3.0017e-04
Loss = 1.1026e-01, PNorm = 35.2635, GNorm = 1.9081, lr_0 = 2.9282e-04
Loss = 1.5076e-01, PNorm = 35.2640, GNorm = 2.8180, lr_0 = 2.9209e-04
Validation rmse = 0.127915
Epoch 31
Loss = 9.1674e-02, PNorm = 35.2715, GNorm = 1.4600, lr_0 = 2.8493e-04
Validation rmse = 0.134351
Epoch 32
Loss = 7.3340e-02, PNorm = 35.2792, GNorm = 1.1759, lr_0 = 2.7795e-04
Loss = 9.7059e-02, PNorm = 35.2864, GNorm = 0.7321, lr_0 = 2.7114e-04
Validation rmse = 0.129522
Epoch 33
Loss = 8.4174e-02, PNorm = 35.2932, GNorm = 1.9392, lr_0 = 2.6384e-04
Validation rmse = 0.135921
Epoch 34
Loss = 1.1294e-01, PNorm = 35.3015, GNorm = 2.0955, lr_0 = 2.5673e-04
Loss = 1.0543e-01, PNorm = 35.3098, GNorm = 1.9297, lr_0 = 2.5044e-04
Validation rmse = 0.131938
Epoch 35
Loss = 1.0873e-01, PNorm = 35.3172, GNorm = 1.2354, lr_0 = 2.4370e-04
Loss = 9.1570e-02, PNorm = 35.3241, GNorm = 0.5312, lr_0 = 2.3773e-04
Validation rmse = 0.130548
Epoch 36
Loss = 8.1999e-02, PNorm = 35.3289, GNorm = 1.5356, lr_0 = 2.3133e-04
Validation rmse = 0.128026
Epoch 37
Loss = 1.0036e-01, PNorm = 35.3371, GNorm = 1.5651, lr_0 = 2.2510e-04
Loss = 1.0229e-01, PNorm = 35.3446, GNorm = 2.3521, lr_0 = 2.1958e-04
Validation rmse = 0.134918
Epoch 38
Loss = 8.4175e-02, PNorm = 35.3500, GNorm = 2.0435, lr_0 = 2.1420e-04
Loss = 9.9666e-02, PNorm = 35.3548, GNorm = 2.6115, lr_0 = 2.0895e-04
Loss = 6.5237e-02, PNorm = 35.3553, GNorm = 2.6499, lr_0 = 2.0843e-04
Validation rmse = 0.137836
Epoch 39
Loss = 1.1049e-01, PNorm = 35.3622, GNorm = 2.3342, lr_0 = 2.0332e-04
Validation rmse = 0.143318
Epoch 40
Loss = 1.3429e-01, PNorm = 35.3696, GNorm = 0.6342, lr_0 = 1.9785e-04
Loss = 8.5989e-02, PNorm = 35.3757, GNorm = 3.6335, lr_0 = 1.9300e-04
Validation rmse = 0.126904
Epoch 41
Loss = 1.0075e-01, PNorm = 35.3836, GNorm = 2.2728, lr_0 = 1.8780e-04
Validation rmse = 0.128254
Epoch 42
Loss = 6.8815e-02, PNorm = 35.3903, GNorm = 0.4288, lr_0 = 1.8275e-04
Loss = 1.0020e-01, PNorm = 35.3937, GNorm = 2.5327, lr_0 = 1.7827e-04
Validation rmse = 0.134987
Epoch 43
Loss = 9.8096e-02, PNorm = 35.3988, GNorm = 2.6723, lr_0 = 1.7347e-04
Loss = 8.6019e-02, PNorm = 35.4038, GNorm = 1.5568, lr_0 = 1.6922e-04
Validation rmse = 0.131851
Epoch 44
Loss = 8.9062e-02, PNorm = 35.4090, GNorm = 0.5254, lr_0 = 1.6507e-04
Validation rmse = 0.136251
Epoch 45
Loss = 6.3720e-02, PNorm = 35.4142, GNorm = 2.4905, lr_0 = 1.6063e-04
Loss = 1.0166e-01, PNorm = 35.4185, GNorm = 0.8329, lr_0 = 1.5669e-04
Validation rmse = 0.132584
Epoch 46
Loss = 9.8506e-02, PNorm = 35.4239, GNorm = 0.6725, lr_0 = 1.5247e-04
Validation rmse = 0.126914
Epoch 47
Loss = 8.6115e-02, PNorm = 35.4281, GNorm = 0.9852, lr_0 = 1.4837e-04
Loss = 8.5002e-02, PNorm = 35.4310, GNorm = 0.4131, lr_0 = 1.4473e-04
Validation rmse = 0.127719
Epoch 48
Loss = 6.1370e-02, PNorm = 35.4359, GNorm = 0.6391, lr_0 = 1.4083e-04
Loss = 1.0273e-01, PNorm = 35.4412, GNorm = 2.2802, lr_0 = 1.3738e-04
Validation rmse = 0.131973
Epoch 49
Loss = 1.0176e-01, PNorm = 35.4456, GNorm = 1.1555, lr_0 = 1.3368e-04
Validation rmse = 0.137733
Epoch 50
Loss = 8.5289e-02, PNorm = 35.4505, GNorm = 2.4673, lr_0 = 1.3041e-04
Loss = 9.2152e-02, PNorm = 35.4542, GNorm = 0.8308, lr_0 = 1.2721e-04
Validation rmse = 0.128960
Epoch 51
Loss = 8.8302e-02, PNorm = 35.4579, GNorm = 1.2938, lr_0 = 1.2379e-04
Loss = 8.5517e-02, PNorm = 35.4617, GNorm = 1.0386, lr_0 = 1.2075e-04
Loss = 4.3418e-02, PNorm = 35.4619, GNorm = 2.1897, lr_0 = 1.2045e-04
Validation rmse = 0.126615
Epoch 52
Loss = 7.0013e-02, PNorm = 35.4649, GNorm = 0.7711, lr_0 = 1.1750e-04
Validation rmse = 0.127431
Epoch 53
Loss = 7.8659e-02, PNorm = 35.4690, GNorm = 0.6415, lr_0 = 1.1434e-04
Loss = 8.9435e-02, PNorm = 35.4728, GNorm = 1.2706, lr_0 = 1.1154e-04
Validation rmse = 0.126976
Epoch 54
Loss = 8.7530e-02, PNorm = 35.4761, GNorm = 0.8871, lr_0 = 1.0853e-04
Validation rmse = 0.131743
Epoch 55
Loss = 4.9931e-02, PNorm = 35.4792, GNorm = 0.7675, lr_0 = 1.0561e-04
Loss = 8.1219e-02, PNorm = 35.4822, GNorm = 1.8047, lr_0 = 1.0302e-04
Validation rmse = 0.127272
Epoch 56
Loss = 5.7299e-02, PNorm = 35.4860, GNorm = 0.4956, lr_0 = 1.0025e-04
Loss = 9.7606e-02, PNorm = 35.4890, GNorm = 1.8157, lr_0 = 1.0000e-04
Validation rmse = 0.130519
Epoch 57
Loss = 6.7667e-02, PNorm = 35.4922, GNorm = 0.9247, lr_0 = 1.0000e-04
Validation rmse = 0.127118
Epoch 58
Loss = 8.2088e-02, PNorm = 35.4950, GNorm = 0.7177, lr_0 = 1.0000e-04
Loss = 8.0639e-02, PNorm = 35.4981, GNorm = 1.0786, lr_0 = 1.0000e-04
Validation rmse = 0.128974
Epoch 59
Loss = 9.1814e-02, PNorm = 35.5010, GNorm = 1.0447, lr_0 = 1.0000e-04
Validation rmse = 0.128354
Model 0 best validation rmse = 0.126615 on epoch 51
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.118841
Ensemble test rmse = 0.118841
1-fold cross validation
	Seed 0 ==> test rmse = 0.118841
Overall test rmse = 0.118841 +/- 0.000000
Elapsed time = 0:00:30
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,007 | train size = 800 | val size = 201 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.9692e-01, PNorm = 34.0156, GNorm = 4.6190, lr_0 = 4.0937e-04
Validation rmse = 0.298614
Epoch 1
Loss = 6.6795e-01, PNorm = 34.0408, GNorm = 6.5556, lr_0 = 6.9063e-04
Loss = 7.1985e-01, PNorm = 34.0790, GNorm = 0.9906, lr_0 = 9.7187e-04
Validation rmse = 0.265619
Epoch 2
Loss = 5.5833e-01, PNorm = 34.1364, GNorm = 3.0162, lr_0 = 9.7792e-04
Validation rmse = 0.275140
Epoch 3
Loss = 5.8019e-01, PNorm = 34.2012, GNorm = 7.9108, lr_0 = 9.5395e-04
Loss = 4.4208e-01, PNorm = 34.2574, GNorm = 4.7305, lr_0 = 9.3057e-04
Validation rmse = 0.240861
Epoch 4
Loss = 4.4851e-01, PNorm = 34.3218, GNorm = 5.1199, lr_0 = 9.0777e-04
Loss = 3.1838e-01, PNorm = 34.3784, GNorm = 1.5371, lr_0 = 8.8552e-04
Validation rmse = 0.195367
Epoch 5
Loss = 2.7492e-01, PNorm = 34.4366, GNorm = 2.5892, lr_0 = 8.6382e-04
Validation rmse = 0.182169
Epoch 6
Loss = 2.3487e-01, PNorm = 34.4855, GNorm = 1.0966, lr_0 = 8.4265e-04
Loss = 2.2256e-01, PNorm = 34.5324, GNorm = 3.3849, lr_0 = 8.2200e-04
Validation rmse = 0.195832
Epoch 7
Loss = 2.1867e-01, PNorm = 34.5743, GNorm = 4.0760, lr_0 = 8.0185e-04
Validation rmse = 0.192301
Epoch 8
Loss = 1.6371e-01, PNorm = 34.6111, GNorm = 0.6612, lr_0 = 7.8220e-04
Loss = 1.9551e-01, PNorm = 34.6489, GNorm = 2.6572, lr_0 = 7.6303e-04
Validation rmse = 0.153769
Epoch 9
Loss = 1.4178e-01, PNorm = 34.6911, GNorm = 1.2167, lr_0 = 7.4433e-04
Loss = 1.9205e-01, PNorm = 34.7237, GNorm = 2.8239, lr_0 = 7.2609e-04
Validation rmse = 0.177191
Epoch 10
Loss = 2.0724e-01, PNorm = 34.7606, GNorm = 2.2750, lr_0 = 7.0830e-04
Validation rmse = 0.162399
Epoch 11
Loss = 2.0835e-01, PNorm = 34.7935, GNorm = 3.8241, lr_0 = 6.9094e-04
Loss = 1.5930e-01, PNorm = 34.8225, GNorm = 0.9724, lr_0 = 6.7401e-04
Validation rmse = 0.146356
Epoch 12
Loss = 1.2142e-01, PNorm = 34.8455, GNorm = 2.1219, lr_0 = 6.5749e-04
Validation rmse = 0.145742
Epoch 13
Loss = 9.7485e-02, PNorm = 34.8701, GNorm = 2.3336, lr_0 = 6.4138e-04
Loss = 1.2473e-01, PNorm = 34.8947, GNorm = 3.7158, lr_0 = 6.2566e-04
Validation rmse = 0.152384
Epoch 14
Loss = 1.2035e-01, PNorm = 34.9171, GNorm = 4.1110, lr_0 = 6.1032e-04
Loss = 1.4229e-01, PNorm = 34.9377, GNorm = 5.8547, lr_0 = 5.9537e-04
Validation rmse = 0.150089
Epoch 15
Loss = 1.2992e-01, PNorm = 34.9573, GNorm = 1.2579, lr_0 = 5.8078e-04
Validation rmse = 0.142305
Epoch 16
Loss = 1.1812e-01, PNorm = 34.9755, GNorm = 0.6613, lr_0 = 5.6654e-04
Loss = 1.2433e-01, PNorm = 34.9938, GNorm = 1.0808, lr_0 = 5.5266e-04
Validation rmse = 0.159845
Epoch 17
Loss = 9.3002e-02, PNorm = 35.0137, GNorm = 1.6097, lr_0 = 5.3911e-04
Validation rmse = 0.141458
Epoch 18
Loss = 8.8257e-02, PNorm = 35.0327, GNorm = 1.7312, lr_0 = 5.2590e-04
Loss = 1.1403e-01, PNorm = 35.0477, GNorm = 0.6863, lr_0 = 5.1301e-04
Validation rmse = 0.150053
Epoch 19
Loss = 1.1299e-01, PNorm = 35.0664, GNorm = 1.7127, lr_0 = 5.0044e-04
Loss = 1.0581e-01, PNorm = 35.0828, GNorm = 2.7528, lr_0 = 4.8818e-04
Validation rmse = 0.140649
Epoch 20
Loss = 1.0062e-01, PNorm = 35.1001, GNorm = 0.9501, lr_0 = 4.7621e-04
Validation rmse = 0.136511
Epoch 21
Loss = 1.2153e-01, PNorm = 35.1134, GNorm = 0.7585, lr_0 = 4.6454e-04
Loss = 1.0024e-01, PNorm = 35.1277, GNorm = 2.4387, lr_0 = 4.5316e-04
Validation rmse = 0.144515
Epoch 22
Loss = 9.4100e-02, PNorm = 35.1449, GNorm = 1.0178, lr_0 = 4.4205e-04
Validation rmse = 0.143250
Epoch 23
Loss = 1.3179e-01, PNorm = 35.1613, GNorm = 1.6726, lr_0 = 4.3122e-04
Loss = 9.4908e-02, PNorm = 35.1737, GNorm = 1.4797, lr_0 = 4.2065e-04
Validation rmse = 0.143488
Epoch 24
Loss = 7.9089e-02, PNorm = 35.1853, GNorm = 1.0761, lr_0 = 4.1034e-04
Loss = 1.1469e-01, PNorm = 35.1981, GNorm = 2.6369, lr_0 = 4.0029e-04
Validation rmse = 0.143867
Epoch 25
Loss = 9.3629e-02, PNorm = 35.2142, GNorm = 1.2609, lr_0 = 3.9048e-04
Validation rmse = 0.134663
Epoch 26
Loss = 8.6285e-02, PNorm = 35.2270, GNorm = 0.7024, lr_0 = 3.8091e-04
Loss = 9.2185e-02, PNorm = 35.2381, GNorm = 0.5949, lr_0 = 3.7157e-04
Validation rmse = 0.135492
Epoch 27
Loss = 1.0838e-01, PNorm = 35.2507, GNorm = 1.7893, lr_0 = 3.6247e-04
Validation rmse = 0.138221
Epoch 28
Loss = 8.0851e-02, PNorm = 35.2610, GNorm = 1.1979, lr_0 = 3.5358e-04
Loss = 9.2505e-02, PNorm = 35.2710, GNorm = 1.4816, lr_0 = 3.4492e-04
Validation rmse = 0.138810
Epoch 29
Loss = 7.8500e-02, PNorm = 35.2822, GNorm = 0.9842, lr_0 = 3.3646e-04
Loss = 9.1110e-02, PNorm = 35.2931, GNorm = 0.6347, lr_0 = 3.2822e-04
Validation rmse = 0.134315
Epoch 30
Loss = 8.9598e-02, PNorm = 35.3032, GNorm = 1.0216, lr_0 = 3.2018e-04
Validation rmse = 0.133422
Epoch 31
Loss = 7.6050e-02, PNorm = 35.3143, GNorm = 1.7921, lr_0 = 3.1233e-04
Loss = 9.4893e-02, PNorm = 35.3246, GNorm = 1.6283, lr_0 = 3.0467e-04
Validation rmse = 0.132746
Epoch 32
Loss = 9.3655e-02, PNorm = 35.3350, GNorm = 1.1627, lr_0 = 2.9721e-04
Validation rmse = 0.139573
Epoch 33
Loss = 7.0554e-02, PNorm = 35.3434, GNorm = 0.6900, lr_0 = 2.8992e-04
Loss = 1.0421e-01, PNorm = 35.3541, GNorm = 1.7090, lr_0 = 2.8282e-04
Validation rmse = 0.140993
Epoch 34
Loss = 8.5992e-02, PNorm = 35.3639, GNorm = 1.4279, lr_0 = 2.7589e-04
Loss = 8.2343e-02, PNorm = 35.3717, GNorm = 0.7772, lr_0 = 2.6913e-04
Validation rmse = 0.135665
Epoch 35
Loss = 8.1813e-02, PNorm = 35.3788, GNorm = 0.9843, lr_0 = 2.6253e-04
Validation rmse = 0.135021
Epoch 36
Loss = 5.5920e-02, PNorm = 35.3868, GNorm = 0.4311, lr_0 = 2.5610e-04
Loss = 9.3530e-02, PNorm = 35.3953, GNorm = 0.9553, lr_0 = 2.4982e-04
Validation rmse = 0.134207
Epoch 37
Loss = 7.1250e-02, PNorm = 35.4035, GNorm = 1.2283, lr_0 = 2.4370e-04
Validation rmse = 0.137278
Epoch 38
Loss = 1.2747e-01, PNorm = 35.4113, GNorm = 2.6509, lr_0 = 2.3773e-04
Loss = 7.5709e-02, PNorm = 35.4200, GNorm = 0.8489, lr_0 = 2.3190e-04
Validation rmse = 0.133896
Epoch 39
Loss = 8.4294e-02, PNorm = 35.4277, GNorm = 0.6974, lr_0 = 2.2622e-04
Loss = 7.3511e-02, PNorm = 35.4352, GNorm = 0.5952, lr_0 = 2.2067e-04
Validation rmse = 0.132952
Epoch 40
Loss = 7.5145e-02, PNorm = 35.4424, GNorm = 1.2581, lr_0 = 2.1527e-04
Validation rmse = 0.135076
Epoch 41
Loss = 1.3105e-01, PNorm = 35.4491, GNorm = 0.6085, lr_0 = 2.0999e-04
Loss = 6.9454e-02, PNorm = 35.4560, GNorm = 0.4090, lr_0 = 2.0484e-04
Validation rmse = 0.146175
Epoch 42
Loss = 7.5534e-02, PNorm = 35.4615, GNorm = 0.7742, lr_0 = 1.9982e-04
Validation rmse = 0.132625
Epoch 43
Loss = 8.4683e-02, PNorm = 35.4683, GNorm = 1.4372, lr_0 = 1.9493e-04
Loss = 7.3258e-02, PNorm = 35.4746, GNorm = 0.9218, lr_0 = 1.9015e-04
Validation rmse = 0.132485
Epoch 44
Loss = 7.5833e-02, PNorm = 35.4808, GNorm = 0.6500, lr_0 = 1.8549e-04
Loss = 7.5490e-02, PNorm = 35.4859, GNorm = 1.8275, lr_0 = 1.8094e-04
Validation rmse = 0.132688
Epoch 45
Loss = 6.8492e-02, PNorm = 35.4916, GNorm = 1.3600, lr_0 = 1.7651e-04
Validation rmse = 0.138568
Epoch 46
Loss = 9.6179e-02, PNorm = 35.4967, GNorm = 1.0254, lr_0 = 1.7218e-04
Loss = 7.3289e-02, PNorm = 35.5016, GNorm = 0.8921, lr_0 = 1.6796e-04
Validation rmse = 0.133173
Epoch 47
Loss = 6.1264e-02, PNorm = 35.5072, GNorm = 0.4808, lr_0 = 1.6385e-04
Validation rmse = 0.134781
Epoch 48
Loss = 7.1047e-02, PNorm = 35.5125, GNorm = 1.0006, lr_0 = 1.5983e-04
Loss = 7.6415e-02, PNorm = 35.5178, GNorm = 0.9774, lr_0 = 1.5592e-04
Validation rmse = 0.133436
Epoch 49
Loss = 7.5218e-02, PNorm = 35.5216, GNorm = 1.0940, lr_0 = 1.5209e-04
Loss = 6.9749e-02, PNorm = 35.5271, GNorm = 0.5597, lr_0 = 1.4837e-04
Validation rmse = 0.134734
Epoch 50
Loss = 5.9897e-02, PNorm = 35.5307, GNorm = 1.4535, lr_0 = 1.4473e-04
Validation rmse = 0.137904
Epoch 51
Loss = 6.7272e-02, PNorm = 35.5358, GNorm = 1.7309, lr_0 = 1.4118e-04
Loss = 6.7995e-02, PNorm = 35.5400, GNorm = 0.5146, lr_0 = 1.3772e-04
Validation rmse = 0.131835
Epoch 52
Loss = 6.9896e-02, PNorm = 35.5440, GNorm = 1.2966, lr_0 = 1.3435e-04
Validation rmse = 0.133542
Epoch 53
Loss = 7.6815e-02, PNorm = 35.5480, GNorm = 0.5359, lr_0 = 1.3106e-04
Loss = 7.1133e-02, PNorm = 35.5515, GNorm = 1.3524, lr_0 = 1.2784e-04
Validation rmse = 0.132071
Epoch 54
Loss = 8.6335e-02, PNorm = 35.5554, GNorm = 1.5076, lr_0 = 1.2471e-04
Loss = 6.1692e-02, PNorm = 35.5597, GNorm = 0.9982, lr_0 = 1.2165e-04
Validation rmse = 0.137814
Epoch 55
Loss = 7.8414e-02, PNorm = 35.5633, GNorm = 2.2341, lr_0 = 1.1867e-04
Validation rmse = 0.135557
Epoch 56
Loss = 5.0418e-02, PNorm = 35.5668, GNorm = 1.6279, lr_0 = 1.1577e-04
Loss = 7.5638e-02, PNorm = 35.5698, GNorm = 1.0416, lr_0 = 1.1293e-04
Validation rmse = 0.138939
Epoch 57
Loss = 7.3301e-02, PNorm = 35.5733, GNorm = 0.4614, lr_0 = 1.1016e-04
Validation rmse = 0.131722
Epoch 58
Loss = 6.5121e-02, PNorm = 35.5761, GNorm = 1.3496, lr_0 = 1.0746e-04
Loss = 8.1463e-02, PNorm = 35.5804, GNorm = 0.5884, lr_0 = 1.0483e-04
Validation rmse = 0.132849
Epoch 59
Loss = 6.3790e-02, PNorm = 35.5842, GNorm = 0.8284, lr_0 = 1.0226e-04
Loss = 7.0743e-02, PNorm = 35.5865, GNorm = 0.7718, lr_0 = 1.0000e-04
Validation rmse = 0.132434
Model 0 best validation rmse = 0.131722 on epoch 57
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.113821
Ensemble test rmse = 0.113821
1-fold cross validation
	Seed 0 ==> test rmse = 0.113821
Overall test rmse = 0.113821 +/- 0.000000
Elapsed time = 0:00:30
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 997 | train size = 792 | val size = 200 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.0976e-01, PNorm = 34.0167, GNorm = 2.1471, lr_0 = 4.3000e-04
Validation rmse = 0.294729
Epoch 1
Loss = 6.7935e-01, PNorm = 34.0464, GNorm = 9.6257, lr_0 = 7.6000e-04
Loss = 7.4934e-01, PNorm = 34.0909, GNorm = 7.7386, lr_0 = 9.9472e-04
Validation rmse = 0.262052
Epoch 2
Loss = 5.2869e-01, PNorm = 34.1588, GNorm = 3.1969, lr_0 = 9.6874e-04
Validation rmse = 0.220439
Epoch 3
Loss = 3.7022e-01, PNorm = 34.2349, GNorm = 2.5743, lr_0 = 9.4344e-04
Loss = 3.6233e-01, PNorm = 34.3054, GNorm = 1.3786, lr_0 = 9.1879e-04
Validation rmse = 0.194527
Epoch 4
Loss = 2.7885e-01, PNorm = 34.3704, GNorm = 3.3538, lr_0 = 8.9480e-04
Validation rmse = 0.177180
Epoch 5
Loss = 2.6418e-01, PNorm = 34.4238, GNorm = 1.1180, lr_0 = 8.7142e-04
Loss = 3.5158e-01, PNorm = 34.4768, GNorm = 4.6677, lr_0 = 8.4866e-04
Validation rmse = 0.172238
Epoch 6
Loss = 2.1451e-01, PNorm = 34.5209, GNorm = 1.3860, lr_0 = 8.2650e-04
Loss = 2.0538e-01, PNorm = 34.5651, GNorm = 1.0407, lr_0 = 8.0491e-04
Loss = 1.0494e-01, PNorm = 34.5697, GNorm = 0.7492, lr_0 = 8.0278e-04
Validation rmse = 0.171159
Epoch 7
Loss = 1.9617e-01, PNorm = 34.6092, GNorm = 2.2305, lr_0 = 7.8181e-04
Validation rmse = 0.156776
Epoch 8
Loss = 1.6784e-01, PNorm = 34.6479, GNorm = 2.9207, lr_0 = 7.6139e-04
Loss = 1.7622e-01, PNorm = 34.6833, GNorm = 5.1685, lr_0 = 7.4151e-04
Validation rmse = 0.171635
Epoch 9
Loss = 1.7776e-01, PNorm = 34.7137, GNorm = 0.8734, lr_0 = 7.2214e-04
Validation rmse = 0.155935
Epoch 10
Loss = 9.6449e-02, PNorm = 34.7459, GNorm = 1.5715, lr_0 = 7.0328e-04
Loss = 1.4446e-01, PNorm = 34.7726, GNorm = 0.8890, lr_0 = 6.8491e-04
Validation rmse = 0.148512
Epoch 11
Loss = 1.3215e-01, PNorm = 34.7945, GNorm = 3.1411, lr_0 = 6.6702e-04
Loss = 1.6375e-01, PNorm = 34.8228, GNorm = 2.5770, lr_0 = 6.4960e-04
Validation rmse = 0.153234
Epoch 12
Loss = 1.4814e-01, PNorm = 34.8495, GNorm = 3.6183, lr_0 = 6.3263e-04
Validation rmse = 0.150789
Epoch 13
Loss = 1.2643e-01, PNorm = 34.8731, GNorm = 2.6154, lr_0 = 6.1448e-04
Loss = 1.2937e-01, PNorm = 34.8964, GNorm = 2.5612, lr_0 = 5.9843e-04
Validation rmse = 0.137847
Epoch 14
Loss = 1.0891e-01, PNorm = 34.9148, GNorm = 0.8989, lr_0 = 5.8280e-04
Validation rmse = 0.134308
Epoch 15
Loss = 1.1532e-01, PNorm = 34.9373, GNorm = 0.3640, lr_0 = 5.6757e-04
Loss = 1.2913e-01, PNorm = 34.9553, GNorm = 0.9276, lr_0 = 5.5275e-04
Validation rmse = 0.154451
Epoch 16
Loss = 1.5343e-01, PNorm = 34.9774, GNorm = 2.9182, lr_0 = 5.3831e-04
Validation rmse = 0.155274
Epoch 17
Loss = 1.2848e-01, PNorm = 34.9994, GNorm = 2.6344, lr_0 = 5.2425e-04
Loss = 1.1539e-01, PNorm = 35.0176, GNorm = 1.4229, lr_0 = 5.1056e-04
Validation rmse = 0.135985
Epoch 18
Loss = 8.8191e-02, PNorm = 35.0348, GNorm = 0.4378, lr_0 = 4.9722e-04
Loss = 1.1838e-01, PNorm = 35.0496, GNorm = 2.1002, lr_0 = 4.8424e-04
Loss = 1.0099e-01, PNorm = 35.0509, GNorm = 2.8292, lr_0 = 4.8296e-04
Validation rmse = 0.142534
Epoch 19
Loss = 9.9088e-02, PNorm = 35.0675, GNorm = 1.3249, lr_0 = 4.7034e-04
Validation rmse = 0.142318
Epoch 20
Loss = 1.4077e-01, PNorm = 35.0821, GNorm = 2.2277, lr_0 = 4.5806e-04
Loss = 1.0493e-01, PNorm = 35.0972, GNorm = 2.0866, lr_0 = 4.4609e-04
Validation rmse = 0.133952
Epoch 21
Loss = 9.8888e-02, PNorm = 35.1127, GNorm = 4.1970, lr_0 = 4.3444e-04
Validation rmse = 0.132935
Epoch 22
Loss = 5.9259e-02, PNorm = 35.1271, GNorm = 0.6898, lr_0 = 4.2309e-04
Loss = 1.0558e-01, PNorm = 35.1420, GNorm = 0.8051, lr_0 = 4.1204e-04
Validation rmse = 0.130883
Epoch 23
Loss = 8.5169e-02, PNorm = 35.1533, GNorm = 0.6307, lr_0 = 4.0128e-04
Loss = 9.2516e-02, PNorm = 35.1660, GNorm = 1.3865, lr_0 = 3.9080e-04
Validation rmse = 0.136538
Epoch 24
Loss = 9.0139e-02, PNorm = 35.1786, GNorm = 1.0155, lr_0 = 3.8059e-04
Validation rmse = 0.134720
Epoch 25
Loss = 1.0755e-01, PNorm = 35.1896, GNorm = 1.2365, lr_0 = 3.7065e-04
Loss = 8.5638e-02, PNorm = 35.1998, GNorm = 4.5233, lr_0 = 3.6097e-04
Validation rmse = 0.131150
Epoch 26
Loss = 8.1457e-02, PNorm = 35.2148, GNorm = 2.3387, lr_0 = 3.5061e-04
Validation rmse = 0.136018
Epoch 27
Loss = 9.2441e-02, PNorm = 35.2264, GNorm = 0.7366, lr_0 = 3.4145e-04
Loss = 8.4668e-02, PNorm = 35.2366, GNorm = 0.6642, lr_0 = 3.3254e-04
Validation rmse = 0.133974
Epoch 28
Loss = 8.4551e-02, PNorm = 35.2472, GNorm = 0.8143, lr_0 = 3.2385e-04
Validation rmse = 0.135478
Epoch 29
Loss = 7.9508e-02, PNorm = 35.2583, GNorm = 3.8213, lr_0 = 3.1539e-04
Loss = 9.2757e-02, PNorm = 35.2695, GNorm = 3.2097, lr_0 = 3.0715e-04
Validation rmse = 0.134016
Epoch 30
Loss = 1.2064e-01, PNorm = 35.2797, GNorm = 3.2981, lr_0 = 2.9913e-04
Loss = 7.8445e-02, PNorm = 35.2902, GNorm = 1.7790, lr_0 = 2.9132e-04
Validation rmse = 0.133312
Epoch 31
Loss = 8.1825e-02, PNorm = 35.3019, GNorm = 2.1251, lr_0 = 2.8371e-04
Validation rmse = 0.129006
Epoch 32
Loss = 7.5645e-02, PNorm = 35.3112, GNorm = 1.2593, lr_0 = 2.7557e-04
Loss = 8.6908e-02, PNorm = 35.3187, GNorm = 0.9762, lr_0 = 2.6837e-04
Validation rmse = 0.130075
Epoch 33
Loss = 7.8570e-02, PNorm = 35.3274, GNorm = 2.1569, lr_0 = 2.6136e-04
Validation rmse = 0.129017
Epoch 34
Loss = 6.2122e-02, PNorm = 35.3373, GNorm = 0.5658, lr_0 = 2.5453e-04
Loss = 9.4588e-02, PNorm = 35.3462, GNorm = 0.8655, lr_0 = 2.4789e-04
Validation rmse = 0.131861
Epoch 35
Loss = 7.7063e-02, PNorm = 35.3552, GNorm = 0.4720, lr_0 = 2.4141e-04
Loss = 9.2407e-02, PNorm = 35.3643, GNorm = 1.4781, lr_0 = 2.3511e-04
Validation rmse = 0.134933
Epoch 36
Loss = 8.4482e-02, PNorm = 35.3728, GNorm = 0.5579, lr_0 = 2.2897e-04
Validation rmse = 0.130390
Epoch 37
Loss = 8.3766e-02, PNorm = 35.3799, GNorm = 0.9562, lr_0 = 2.2299e-04
Loss = 7.1672e-02, PNorm = 35.3875, GNorm = 0.6730, lr_0 = 2.1716e-04
Validation rmse = 0.127541
Epoch 38
Loss = 6.9427e-02, PNorm = 35.3948, GNorm = 0.4064, lr_0 = 2.1093e-04
Validation rmse = 0.135229
Epoch 39
Loss = 5.9899e-02, PNorm = 35.4019, GNorm = 1.2985, lr_0 = 2.0542e-04
Loss = 6.6730e-02, PNorm = 35.4078, GNorm = 0.9696, lr_0 = 2.0006e-04
Validation rmse = 0.131253
Epoch 40
Loss = 9.0963e-02, PNorm = 35.4155, GNorm = 1.6082, lr_0 = 1.9483e-04
Validation rmse = 0.138205
Epoch 41
Loss = 6.8479e-02, PNorm = 35.4220, GNorm = 1.7093, lr_0 = 1.8974e-04
Loss = 7.8658e-02, PNorm = 35.4280, GNorm = 1.5520, lr_0 = 1.8478e-04
Validation rmse = 0.128587
Epoch 42
Loss = 6.2445e-02, PNorm = 35.4335, GNorm = 0.5155, lr_0 = 1.7996e-04
Loss = 8.2825e-02, PNorm = 35.4396, GNorm = 0.7990, lr_0 = 1.7526e-04
Validation rmse = 0.132716
Epoch 43
Loss = 8.3057e-02, PNorm = 35.4447, GNorm = 2.9109, lr_0 = 1.7068e-04
Validation rmse = 0.137111
Epoch 44
Loss = 7.3785e-02, PNorm = 35.4514, GNorm = 1.5358, lr_0 = 1.6578e-04
Loss = 7.9609e-02, PNorm = 35.4567, GNorm = 0.8659, lr_0 = 1.6145e-04
Validation rmse = 0.128430
Epoch 45
Loss = 7.9239e-02, PNorm = 35.4628, GNorm = 0.7996, lr_0 = 1.5724e-04
Validation rmse = 0.132994
Epoch 46
Loss = 6.5313e-02, PNorm = 35.4672, GNorm = 1.3630, lr_0 = 1.5313e-04
Loss = 7.3692e-02, PNorm = 35.4726, GNorm = 0.4189, lr_0 = 1.4913e-04
Validation rmse = 0.128623
Epoch 47
Loss = 7.6284e-02, PNorm = 35.4769, GNorm = 0.8881, lr_0 = 1.4523e-04
Loss = 6.5040e-02, PNorm = 35.4817, GNorm = 1.3417, lr_0 = 1.4144e-04
Validation rmse = 0.133102
Epoch 48
Loss = 5.8674e-02, PNorm = 35.4864, GNorm = 0.6406, lr_0 = 1.3775e-04
Validation rmse = 0.128436
Epoch 49
Loss = 7.0636e-02, PNorm = 35.4913, GNorm = 0.8198, lr_0 = 1.3415e-04
Loss = 7.2980e-02, PNorm = 35.4958, GNorm = 0.7453, lr_0 = 1.3064e-04
Validation rmse = 0.132997
Epoch 50
Loss = 5.7386e-02, PNorm = 35.4997, GNorm = 0.9264, lr_0 = 1.2723e-04
Validation rmse = 0.130861
Epoch 51
Loss = 4.9986e-02, PNorm = 35.5048, GNorm = 1.5767, lr_0 = 1.2358e-04
Loss = 7.6677e-02, PNorm = 35.5088, GNorm = 1.0458, lr_0 = 1.2035e-04
Validation rmse = 0.130987
Epoch 52
Loss = 5.2187e-02, PNorm = 35.5130, GNorm = 0.9008, lr_0 = 1.1721e-04
Validation rmse = 0.132603
Epoch 53
Loss = 7.6876e-02, PNorm = 35.5172, GNorm = 0.5621, lr_0 = 1.1415e-04
Loss = 6.0313e-02, PNorm = 35.5214, GNorm = 2.1357, lr_0 = 1.1117e-04
Validation rmse = 0.127407
Epoch 54
Loss = 7.3159e-02, PNorm = 35.5248, GNorm = 1.8800, lr_0 = 1.0826e-04
Loss = 6.5285e-02, PNorm = 35.5288, GNorm = 0.9567, lr_0 = 1.0544e-04
Validation rmse = 0.129852
Epoch 55
Loss = 6.0447e-02, PNorm = 35.5323, GNorm = 0.5632, lr_0 = 1.0268e-04
Validation rmse = 0.133001
Epoch 56
Loss = 6.8385e-02, PNorm = 35.5361, GNorm = 1.5163, lr_0 = 1.0000e-04
Loss = 6.1674e-02, PNorm = 35.5397, GNorm = 2.0837, lr_0 = 1.0000e-04
Validation rmse = 0.129152
Epoch 57
Loss = 6.1744e-02, PNorm = 35.5429, GNorm = 0.9029, lr_0 = 1.0000e-04
Validation rmse = 0.130676
Epoch 58
Loss = 6.4007e-02, PNorm = 35.5463, GNorm = 0.6230, lr_0 = 1.0000e-04
Loss = 6.3497e-02, PNorm = 35.5500, GNorm = 0.8456, lr_0 = 1.0000e-04
Validation rmse = 0.129567
Epoch 59
Loss = 7.1998e-02, PNorm = 35.5536, GNorm = 1.1662, lr_0 = 1.0000e-04
Loss = 6.5559e-02, PNorm = 35.5574, GNorm = 1.6561, lr_0 = 1.0000e-04
Validation rmse = 0.138438
Model 0 best validation rmse = 0.127407 on epoch 53
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.089424
Ensemble test rmse = 0.089424
1-fold cross validation
	Seed 0 ==> test rmse = 0.089424
Overall test rmse = 0.089424 +/- 0.000000
Elapsed time = 0:00:29
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 987 | train size = 784 | val size = 198 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1688e-01, PNorm = 34.0165, GNorm = 3.7356, lr_0 = 4.3000e-04
Validation rmse = 0.284710
Epoch 1
Loss = 6.6490e-01, PNorm = 34.0562, GNorm = 4.7007, lr_0 = 7.6000e-04
Loss = 6.3432e-01, PNorm = 34.1078, GNorm = 11.7453, lr_0 = 9.9472e-04
Validation rmse = 0.310435
Epoch 2
Loss = 5.5384e-01, PNorm = 34.1621, GNorm = 6.7962, lr_0 = 9.6874e-04
Validation rmse = 0.234037
Epoch 3
Loss = 2.9741e-01, PNorm = 34.2249, GNorm = 2.2078, lr_0 = 9.4344e-04
Loss = 3.2992e-01, PNorm = 34.2848, GNorm = 2.5896, lr_0 = 9.1879e-04
Validation rmse = 0.209167
Epoch 4
Loss = 2.8944e-01, PNorm = 34.3461, GNorm = 3.0010, lr_0 = 8.9243e-04
Validation rmse = 0.201061
Epoch 5
Loss = 3.1523e-01, PNorm = 34.3923, GNorm = 3.6918, lr_0 = 8.6912e-04
Loss = 2.5012e-01, PNorm = 34.4315, GNorm = 0.8852, lr_0 = 8.4642e-04
Validation rmse = 0.180113
Epoch 6
Loss = 2.0554e-01, PNorm = 34.4762, GNorm = 2.2781, lr_0 = 8.2431e-04
Validation rmse = 0.173226
Epoch 7
Loss = 1.7641e-01, PNorm = 34.5179, GNorm = 2.6938, lr_0 = 8.0066e-04
Loss = 2.0181e-01, PNorm = 34.5578, GNorm = 5.3801, lr_0 = 7.7975e-04
Validation rmse = 0.173397
Epoch 8
Loss = 1.4696e-01, PNorm = 34.5926, GNorm = 2.3946, lr_0 = 7.5938e-04
Loss = 1.7060e-01, PNorm = 34.6242, GNorm = 1.9829, lr_0 = 7.3955e-04
Validation rmse = 0.175297
Epoch 9
Loss = 1.5234e-01, PNorm = 34.6567, GNorm = 0.9266, lr_0 = 7.2023e-04
Validation rmse = 0.162226
Epoch 10
Loss = 1.4762e-01, PNorm = 34.6899, GNorm = 3.3772, lr_0 = 6.9956e-04
Loss = 1.4292e-01, PNorm = 34.7141, GNorm = 3.8449, lr_0 = 6.8129e-04
Validation rmse = 0.155080
Epoch 11
Loss = 1.2410e-01, PNorm = 34.7444, GNorm = 1.0662, lr_0 = 6.6350e-04
Validation rmse = 0.156814
Epoch 12
Loss = 1.3395e-01, PNorm = 34.7694, GNorm = 3.3485, lr_0 = 6.4617e-04
Loss = 1.4835e-01, PNorm = 34.7911, GNorm = 1.1840, lr_0 = 6.2929e-04
Validation rmse = 0.146867
Epoch 13
Loss = 1.3296e-01, PNorm = 34.8199, GNorm = 1.0185, lr_0 = 6.1123e-04
Validation rmse = 0.155849
Epoch 14
Loss = 3.0883e-01, PNorm = 34.8419, GNorm = 5.2691, lr_0 = 5.9527e-04
Loss = 1.1440e-01, PNorm = 34.8603, GNorm = 1.0733, lr_0 = 5.7972e-04
Validation rmse = 0.148185
Epoch 15
Loss = 1.4229e-01, PNorm = 34.8793, GNorm = 2.5772, lr_0 = 5.6458e-04
Loss = 9.8293e-02, PNorm = 34.8975, GNorm = 0.5295, lr_0 = 5.4983e-04
Loss = 4.3766e-02, PNorm = 34.8995, GNorm = 0.3358, lr_0 = 5.4838e-04
Validation rmse = 0.160610
Epoch 16
Loss = 1.2972e-01, PNorm = 34.9169, GNorm = 3.4331, lr_0 = 5.3406e-04
Validation rmse = 0.143957
Epoch 17
Loss = 1.1717e-01, PNorm = 34.9337, GNorm = 1.8094, lr_0 = 5.2011e-04
Loss = 1.0652e-01, PNorm = 34.9483, GNorm = 2.1484, lr_0 = 5.0652e-04
Validation rmse = 0.142093
Epoch 18
Loss = 1.0525e-01, PNorm = 34.9638, GNorm = 2.9087, lr_0 = 4.9329e-04
Validation rmse = 0.154017
Epoch 19
Loss = 1.1489e-01, PNorm = 34.9783, GNorm = 1.0157, lr_0 = 4.7914e-04
Loss = 9.1642e-02, PNorm = 34.9920, GNorm = 1.7164, lr_0 = 4.6662e-04
Validation rmse = 0.138668
Epoch 20
Loss = 1.0441e-01, PNorm = 35.0060, GNorm = 0.5419, lr_0 = 4.5443e-04
Validation rmse = 0.134378
Epoch 21
Loss = 6.8808e-02, PNorm = 35.0192, GNorm = 0.5460, lr_0 = 4.4256e-04
Loss = 9.2939e-02, PNorm = 35.0327, GNorm = 2.1677, lr_0 = 4.3101e-04
Validation rmse = 0.137172
Epoch 22
Loss = 9.5227e-02, PNorm = 35.0478, GNorm = 1.2584, lr_0 = 4.1864e-04
Loss = 1.0160e-01, PNorm = 35.0588, GNorm = 2.9724, lr_0 = 4.0770e-04
Validation rmse = 0.134321
Epoch 23
Loss = 9.0578e-02, PNorm = 35.0698, GNorm = 1.2755, lr_0 = 3.9705e-04
Validation rmse = 0.134855
Epoch 24
Loss = 1.2082e-01, PNorm = 35.0815, GNorm = 4.1878, lr_0 = 3.8668e-04
Loss = 8.8169e-02, PNorm = 35.0942, GNorm = 0.8772, lr_0 = 3.7658e-04
Validation rmse = 0.135038
Epoch 25
Loss = 8.2121e-02, PNorm = 35.1036, GNorm = 0.9882, lr_0 = 3.6675e-04
Validation rmse = 0.134817
Epoch 26
Loss = 8.6588e-02, PNorm = 35.1149, GNorm = 2.2236, lr_0 = 3.5622e-04
Loss = 8.7944e-02, PNorm = 35.1257, GNorm = 4.6657, lr_0 = 3.4692e-04
Validation rmse = 0.134137
Epoch 27
Loss = 9.0890e-02, PNorm = 35.1379, GNorm = 3.4609, lr_0 = 3.3786e-04
Validation rmse = 0.133417
Epoch 28
Loss = 7.1886e-02, PNorm = 35.1474, GNorm = 0.6754, lr_0 = 3.2903e-04
Loss = 9.5229e-02, PNorm = 35.1579, GNorm = 0.5279, lr_0 = 3.2044e-04
Validation rmse = 0.131881
Epoch 29
Loss = 8.0315e-02, PNorm = 35.1691, GNorm = 1.8604, lr_0 = 3.1125e-04
Loss = 8.8113e-02, PNorm = 35.1780, GNorm = 0.8761, lr_0 = 3.0312e-04
Validation rmse = 0.132782
Epoch 30
Loss = 8.3899e-02, PNorm = 35.1866, GNorm = 2.2826, lr_0 = 2.9520e-04
Validation rmse = 0.131401
Epoch 31
Loss = 7.5165e-02, PNorm = 35.1945, GNorm = 0.5783, lr_0 = 2.8749e-04
Loss = 9.2611e-02, PNorm = 35.2042, GNorm = 0.7127, lr_0 = 2.7998e-04
Validation rmse = 0.130177
Epoch 32
Loss = 8.2973e-02, PNorm = 35.2124, GNorm = 1.9558, lr_0 = 2.7195e-04
Validation rmse = 0.131149
Epoch 33
Loss = 5.7670e-02, PNorm = 35.2218, GNorm = 1.1384, lr_0 = 2.6484e-04
Loss = 9.2030e-02, PNorm = 35.2307, GNorm = 0.7369, lr_0 = 2.5793e-04
Validation rmse = 0.133174
Epoch 34
Loss = 7.6778e-02, PNorm = 35.2378, GNorm = 1.7891, lr_0 = 2.5119e-04
Validation rmse = 0.129286
Epoch 35
Loss = 6.2316e-02, PNorm = 35.2466, GNorm = 0.5210, lr_0 = 2.4398e-04
Loss = 7.8741e-02, PNorm = 35.2547, GNorm = 0.8995, lr_0 = 2.3761e-04
Validation rmse = 0.130098
Epoch 36
Loss = 1.0054e-01, PNorm = 35.2622, GNorm = 3.2762, lr_0 = 2.3140e-04
Loss = 9.3547e-02, PNorm = 35.2696, GNorm = 4.7106, lr_0 = 2.2536e-04
Validation rmse = 0.136167
Epoch 37
Loss = 9.3935e-02, PNorm = 35.2777, GNorm = 1.4252, lr_0 = 2.1947e-04
Validation rmse = 0.132131
Epoch 38
Loss = 6.3809e-02, PNorm = 35.2857, GNorm = 1.0062, lr_0 = 2.1317e-04
Loss = 8.5254e-02, PNorm = 35.2923, GNorm = 0.8578, lr_0 = 2.0761e-04
Validation rmse = 0.131034
Epoch 39
Loss = 7.3448e-02, PNorm = 35.2986, GNorm = 1.1901, lr_0 = 2.0218e-04
Validation rmse = 0.129045
Epoch 40
Loss = 7.4529e-02, PNorm = 35.3047, GNorm = 0.7947, lr_0 = 1.9690e-04
Loss = 7.4838e-02, PNorm = 35.3103, GNorm = 1.1250, lr_0 = 1.9176e-04
Validation rmse = 0.128032
Epoch 41
Loss = 6.5219e-02, PNorm = 35.3172, GNorm = 0.8747, lr_0 = 1.8626e-04
Validation rmse = 0.129636
Epoch 42
Loss = 7.5898e-02, PNorm = 35.3227, GNorm = 2.2970, lr_0 = 1.8139e-04
Loss = 8.3651e-02, PNorm = 35.3284, GNorm = 1.4260, lr_0 = 1.7666e-04
Validation rmse = 0.131778
Epoch 43
Loss = 9.4336e-02, PNorm = 35.3347, GNorm = 1.2681, lr_0 = 1.7204e-04
Validation rmse = 0.127568
Epoch 44
Loss = 4.9922e-02, PNorm = 35.3407, GNorm = 0.5697, lr_0 = 1.6710e-04
Loss = 7.1886e-02, PNorm = 35.3456, GNorm = 0.8857, lr_0 = 1.6274e-04
Validation rmse = 0.129211
Epoch 45
Loss = 6.3819e-02, PNorm = 35.3502, GNorm = 0.5517, lr_0 = 1.5849e-04
Loss = 7.8852e-02, PNorm = 35.3559, GNorm = 1.7852, lr_0 = 1.5435e-04
Validation rmse = 0.130481
Epoch 46
Loss = 7.2276e-02, PNorm = 35.3600, GNorm = 1.3624, lr_0 = 1.5032e-04
Validation rmse = 0.128894
Epoch 47
Loss = 9.5111e-02, PNorm = 35.3652, GNorm = 0.8602, lr_0 = 1.4601e-04
Loss = 6.6567e-02, PNorm = 35.3707, GNorm = 0.7079, lr_0 = 1.4219e-04
Validation rmse = 0.128238
Epoch 48
Loss = 5.9688e-02, PNorm = 35.3745, GNorm = 1.5430, lr_0 = 1.3848e-04
Validation rmse = 0.128528
Epoch 49
Loss = 5.7150e-02, PNorm = 35.3786, GNorm = 0.6063, lr_0 = 1.3486e-04
Loss = 8.1073e-02, PNorm = 35.3830, GNorm = 1.4850, lr_0 = 1.3134e-04
Validation rmse = 0.126718
Epoch 50
Loss = 5.9210e-02, PNorm = 35.3874, GNorm = 0.8961, lr_0 = 1.2791e-04
Validation rmse = 0.127251
Epoch 51
Loss = 9.9904e-02, PNorm = 35.3917, GNorm = 0.9719, lr_0 = 1.2424e-04
Loss = 7.2508e-02, PNorm = 35.3959, GNorm = 1.1837, lr_0 = 1.2099e-04
Validation rmse = 0.130212
Epoch 52
Loss = 6.0657e-02, PNorm = 35.3994, GNorm = 0.7864, lr_0 = 1.1783e-04
Loss = 7.1876e-02, PNorm = 35.4031, GNorm = 1.0153, lr_0 = 1.1475e-04
Validation rmse = 0.127035
Epoch 53
Loss = 7.1643e-02, PNorm = 35.4068, GNorm = 1.6367, lr_0 = 1.1176e-04
Validation rmse = 0.129129
Epoch 54
Loss = 6.1387e-02, PNorm = 35.4112, GNorm = 0.7665, lr_0 = 1.0855e-04
Loss = 7.6377e-02, PNorm = 35.4150, GNorm = 0.6361, lr_0 = 1.0572e-04
Validation rmse = 0.129110
Epoch 55
Loss = 5.5632e-02, PNorm = 35.4180, GNorm = 0.5563, lr_0 = 1.0295e-04
Validation rmse = 0.127120
Epoch 56
Loss = 7.3141e-02, PNorm = 35.4211, GNorm = 1.5671, lr_0 = 1.0027e-04
Loss = 7.5153e-02, PNorm = 35.4242, GNorm = 2.7415, lr_0 = 1.0000e-04
Validation rmse = 0.131538
Epoch 57
Loss = 6.6846e-02, PNorm = 35.4284, GNorm = 0.5910, lr_0 = 1.0000e-04
Validation rmse = 0.126261
Epoch 58
Loss = 5.8984e-02, PNorm = 35.4319, GNorm = 0.8669, lr_0 = 1.0000e-04
Loss = 8.2057e-02, PNorm = 35.4351, GNorm = 2.4221, lr_0 = 1.0000e-04
Validation rmse = 0.133221
Epoch 59
Loss = 8.9338e-02, PNorm = 35.4382, GNorm = 0.6716, lr_0 = 1.0000e-04
Loss = 6.1866e-02, PNorm = 35.4416, GNorm = 0.5168, lr_0 = 1.0000e-04
Loss = 2.6575e-02, PNorm = 35.4419, GNorm = 0.7620, lr_0 = 1.0000e-04
Validation rmse = 0.125994
Model 0 best validation rmse = 0.125994 on epoch 59
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.140398
Ensemble test rmse = 0.140398
1-fold cross validation
	Seed 0 ==> test rmse = 0.140398
Overall test rmse = 0.140398 +/- 0.000000
Elapsed time = 0:00:30
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 977 | train size = 776 | val size = 196 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.0045e-01, PNorm = 34.0181, GNorm = 6.7826, lr_0 = 4.3000e-04
Validation rmse = 0.296154
Epoch 1
Loss = 5.8240e-01, PNorm = 34.0496, GNorm = 5.4795, lr_0 = 7.6000e-04
Loss = 6.4019e-01, PNorm = 34.1003, GNorm = 12.3637, lr_0 = 9.9472e-04
Validation rmse = 0.272723
Epoch 2
Loss = 5.4666e-01, PNorm = 34.1668, GNorm = 4.2956, lr_0 = 9.6874e-04
Validation rmse = 0.236762
Epoch 3
Loss = 3.7310e-01, PNorm = 34.2366, GNorm = 2.2063, lr_0 = 9.4094e-04
Loss = 5.1096e-01, PNorm = 34.2927, GNorm = 7.0588, lr_0 = 9.1637e-04
Validation rmse = 0.197385
Epoch 4
Loss = 3.6056e-01, PNorm = 34.3560, GNorm = 2.6197, lr_0 = 8.9243e-04
Validation rmse = 0.204331
Epoch 5
Loss = 2.9236e-01, PNorm = 34.4165, GNorm = 0.6952, lr_0 = 8.6682e-04
Loss = 2.7648e-01, PNorm = 34.4747, GNorm = 8.7606, lr_0 = 8.4418e-04
Validation rmse = 0.174273
Epoch 6
Loss = 2.0028e-01, PNorm = 34.5297, GNorm = 0.7828, lr_0 = 8.2213e-04
Validation rmse = 0.162370
Epoch 7
Loss = 1.8805e-01, PNorm = 34.5800, GNorm = 0.8197, lr_0 = 7.9854e-04
Loss = 2.1779e-01, PNorm = 34.6266, GNorm = 4.8386, lr_0 = 7.7769e-04
Validation rmse = 0.150170
Epoch 8
Loss = 1.8632e-01, PNorm = 34.6681, GNorm = 3.4926, lr_0 = 7.5737e-04
Validation rmse = 0.151834
Epoch 9
Loss = 1.7394e-01, PNorm = 34.7113, GNorm = 2.0536, lr_0 = 7.3564e-04
Loss = 1.6798e-01, PNorm = 34.7515, GNorm = 8.8638, lr_0 = 7.1643e-04
Validation rmse = 0.172921
Epoch 10
Loss = 1.5432e-01, PNorm = 34.7815, GNorm = 1.5216, lr_0 = 6.9772e-04
Loss = 1.4432e-01, PNorm = 34.8117, GNorm = 1.5044, lr_0 = 6.7949e-04
Loss = 1.1772e-01, PNorm = 34.8144, GNorm = 2.0727, lr_0 = 6.7770e-04
Validation rmse = 0.148506
Epoch 11
Loss = 1.2644e-01, PNorm = 34.8465, GNorm = 1.6257, lr_0 = 6.5999e-04
Validation rmse = 0.150999
Epoch 12
Loss = 1.3527e-01, PNorm = 34.8718, GNorm = 2.8622, lr_0 = 6.4276e-04
Loss = 1.2141e-01, PNorm = 34.8962, GNorm = 1.4806, lr_0 = 6.2597e-04
Validation rmse = 0.143013
Epoch 13
Loss = 1.1939e-01, PNorm = 34.9210, GNorm = 1.7157, lr_0 = 6.0801e-04
Validation rmse = 0.145019
Epoch 14
Loss = 1.2802e-01, PNorm = 34.9465, GNorm = 1.8327, lr_0 = 5.9213e-04
Loss = 1.0247e-01, PNorm = 34.9671, GNorm = 0.8369, lr_0 = 5.7666e-04
Validation rmse = 0.142176
Epoch 15
Loss = 1.1167e-01, PNorm = 34.9918, GNorm = 0.7157, lr_0 = 5.6011e-04
Validation rmse = 0.138108
Epoch 16
Loss = 8.7191e-02, PNorm = 35.0109, GNorm = 1.0390, lr_0 = 5.4548e-04
Loss = 9.7661e-02, PNorm = 35.0306, GNorm = 0.5165, lr_0 = 5.3124e-04
Validation rmse = 0.141696
Epoch 17
Loss = 9.3778e-02, PNorm = 35.0523, GNorm = 1.5853, lr_0 = 5.1599e-04
Validation rmse = 0.146422
Epoch 18
Loss = 6.5938e-02, PNorm = 35.0696, GNorm = 2.5479, lr_0 = 5.0252e-04
Loss = 1.2796e-01, PNorm = 35.0876, GNorm = 6.2629, lr_0 = 4.8939e-04
Validation rmse = 0.141279
Epoch 19
Loss = 1.0295e-01, PNorm = 35.1078, GNorm = 2.2385, lr_0 = 4.7535e-04
Loss = 9.8521e-02, PNorm = 35.1247, GNorm = 1.9305, lr_0 = 4.6293e-04
Validation rmse = 0.141829
Epoch 20
Loss = 9.0701e-02, PNorm = 35.1377, GNorm = 4.3499, lr_0 = 4.5084e-04
Validation rmse = 0.166116
Epoch 21
Loss = 1.1879e-01, PNorm = 35.1537, GNorm = 5.4306, lr_0 = 4.3790e-04
Loss = 1.0840e-01, PNorm = 35.1709, GNorm = 3.0105, lr_0 = 4.2647e-04
Validation rmse = 0.154140
Epoch 22
Loss = 1.0614e-01, PNorm = 35.1846, GNorm = 2.6435, lr_0 = 4.1533e-04
Validation rmse = 0.138668
Epoch 23
Loss = 1.0547e-01, PNorm = 35.1994, GNorm = 0.9004, lr_0 = 4.0341e-04
Loss = 7.4094e-02, PNorm = 35.2127, GNorm = 1.3805, lr_0 = 3.9287e-04
Validation rmse = 0.142304
Epoch 24
Loss = 8.3355e-02, PNorm = 35.2238, GNorm = 1.1798, lr_0 = 3.8261e-04
Validation rmse = 0.148814
Epoch 25
Loss = 1.1675e-01, PNorm = 35.2343, GNorm = 2.2502, lr_0 = 3.7262e-04
Loss = 8.5294e-02, PNorm = 35.2455, GNorm = 1.1910, lr_0 = 3.6289e-04
Validation rmse = 0.145603
Epoch 26
Loss = 7.4755e-02, PNorm = 35.2581, GNorm = 2.2336, lr_0 = 3.5247e-04
Validation rmse = 0.139946
Epoch 27
Loss = 4.6323e-02, PNorm = 35.2696, GNorm = 2.3410, lr_0 = 3.4327e-04
Loss = 7.9413e-02, PNorm = 35.2789, GNorm = 0.8489, lr_0 = 3.3430e-04
Validation rmse = 0.145135
Epoch 28
Loss = 6.9587e-02, PNorm = 35.2907, GNorm = 1.1414, lr_0 = 3.2471e-04
Loss = 8.7613e-02, PNorm = 35.2989, GNorm = 1.7536, lr_0 = 3.1623e-04
Validation rmse = 0.140665
Epoch 29
Loss = 7.9963e-02, PNorm = 35.3079, GNorm = 3.0075, lr_0 = 3.0797e-04
Validation rmse = 0.145848
Epoch 30
Loss = 9.8635e-02, PNorm = 35.3196, GNorm = 4.5985, lr_0 = 2.9913e-04
Loss = 9.0937e-02, PNorm = 35.3291, GNorm = 1.1989, lr_0 = 2.9132e-04
Validation rmse = 0.143671
Epoch 31
Loss = 7.7400e-02, PNorm = 35.3384, GNorm = 0.8009, lr_0 = 2.8371e-04
Validation rmse = 0.145957
Epoch 32
Loss = 6.6244e-02, PNorm = 35.3479, GNorm = 0.7696, lr_0 = 2.7557e-04
Loss = 7.8128e-02, PNorm = 35.3564, GNorm = 0.7706, lr_0 = 2.6837e-04
Validation rmse = 0.143602
Epoch 33
Loss = 7.0395e-02, PNorm = 35.3642, GNorm = 0.6778, lr_0 = 2.6136e-04
Validation rmse = 0.141365
Epoch 34
Loss = 5.5482e-02, PNorm = 35.3728, GNorm = 2.1628, lr_0 = 2.5386e-04
Loss = 7.6267e-02, PNorm = 35.3807, GNorm = 1.9918, lr_0 = 2.4723e-04
Validation rmse = 0.142006
Epoch 35
Loss = 7.6481e-02, PNorm = 35.3873, GNorm = 3.8343, lr_0 = 2.4077e-04
Validation rmse = 0.145958
Epoch 36
Loss = 5.9126e-02, PNorm = 35.3985, GNorm = 0.6016, lr_0 = 2.3387e-04
Loss = 7.6723e-02, PNorm = 35.4058, GNorm = 1.3075, lr_0 = 2.2776e-04
Validation rmse = 0.142692
Epoch 37
Loss = 6.7065e-02, PNorm = 35.4122, GNorm = 1.3326, lr_0 = 2.2181e-04
Validation rmse = 0.143919
Epoch 38
Loss = 9.7481e-02, PNorm = 35.4201, GNorm = 2.1601, lr_0 = 2.1544e-04
Loss = 6.8384e-02, PNorm = 35.4266, GNorm = 0.7238, lr_0 = 2.0982e-04
Validation rmse = 0.139935
Epoch 39
Loss = 6.2666e-02, PNorm = 35.4329, GNorm = 0.8270, lr_0 = 2.0434e-04
Loss = 6.3680e-02, PNorm = 35.4385, GNorm = 0.7174, lr_0 = 1.9900e-04
Loss = 2.0102e-01, PNorm = 35.4387, GNorm = 5.7282, lr_0 = 1.9847e-04
Validation rmse = 0.140752
Epoch 40
Loss = 7.0639e-02, PNorm = 35.4448, GNorm = 1.8260, lr_0 = 1.9329e-04
Validation rmse = 0.145171
Epoch 41
Loss = 8.8159e-02, PNorm = 35.4504, GNorm = 2.5562, lr_0 = 1.8824e-04
Loss = 7.4504e-02, PNorm = 35.4577, GNorm = 1.9480, lr_0 = 1.8332e-04
Validation rmse = 0.141240
Epoch 42
Loss = 6.5459e-02, PNorm = 35.4644, GNorm = 0.5866, lr_0 = 1.7806e-04
Validation rmse = 0.140518
Epoch 43
Loss = 5.8865e-02, PNorm = 35.4700, GNorm = 1.1649, lr_0 = 1.7341e-04
Loss = 6.4237e-02, PNorm = 35.4740, GNorm = 0.6737, lr_0 = 1.6888e-04
Validation rmse = 0.141430
Epoch 44
Loss = 6.5253e-02, PNorm = 35.4795, GNorm = 0.4021, lr_0 = 1.6404e-04
Validation rmse = 0.142178
Epoch 45
Loss = 5.2590e-02, PNorm = 35.4840, GNorm = 0.7483, lr_0 = 1.5975e-04
Loss = 6.9530e-02, PNorm = 35.4883, GNorm = 1.5820, lr_0 = 1.5558e-04
Validation rmse = 0.141563
Epoch 46
Loss = 7.0718e-02, PNorm = 35.4930, GNorm = 0.7779, lr_0 = 1.5112e-04
Validation rmse = 0.139967
Epoch 47
Loss = 8.1978e-02, PNorm = 35.4982, GNorm = 1.1187, lr_0 = 1.4717e-04
Loss = 6.3908e-02, PNorm = 35.5025, GNorm = 0.9213, lr_0 = 1.4332e-04
Validation rmse = 0.141690
Epoch 48
Loss = 6.7723e-02, PNorm = 35.5066, GNorm = 1.2929, lr_0 = 1.3921e-04
Loss = 6.3395e-02, PNorm = 35.5113, GNorm = 2.2005, lr_0 = 1.3558e-04
Validation rmse = 0.140502
Epoch 49
Loss = 6.3484e-02, PNorm = 35.5152, GNorm = 0.9469, lr_0 = 1.3204e-04
Validation rmse = 0.141623
Epoch 50
Loss = 6.4450e-02, PNorm = 35.5197, GNorm = 1.9525, lr_0 = 1.2859e-04
Loss = 6.1516e-02, PNorm = 35.5240, GNorm = 1.6991, lr_0 = 1.2523e-04
Validation rmse = 0.140891
Epoch 51
Loss = 5.7403e-02, PNorm = 35.5272, GNorm = 0.5754, lr_0 = 1.2163e-04
Validation rmse = 0.140014
Epoch 52
Loss = 6.3430e-02, PNorm = 35.5309, GNorm = 1.7100, lr_0 = 1.1846e-04
Loss = 6.1386e-02, PNorm = 35.5351, GNorm = 1.1628, lr_0 = 1.1536e-04
Validation rmse = 0.142268
Epoch 53
Loss = 6.9208e-02, PNorm = 35.5388, GNorm = 0.7329, lr_0 = 1.1205e-04
Validation rmse = 0.143111
Epoch 54
Loss = 8.5651e-02, PNorm = 35.5416, GNorm = 1.1225, lr_0 = 1.0913e-04
Loss = 6.0112e-02, PNorm = 35.5450, GNorm = 0.4132, lr_0 = 1.0628e-04
Validation rmse = 0.140943
Epoch 55
Loss = 6.4108e-02, PNorm = 35.5484, GNorm = 0.7620, lr_0 = 1.0323e-04
Validation rmse = 0.140943
Epoch 56
Loss = 4.5274e-02, PNorm = 35.5517, GNorm = 2.1919, lr_0 = 1.0053e-04
Loss = 6.3843e-02, PNorm = 35.5545, GNorm = 2.0178, lr_0 = 1.0000e-04
Validation rmse = 0.140632
Epoch 57
Loss = 6.3535e-02, PNorm = 35.5577, GNorm = 0.9617, lr_0 = 1.0000e-04
Loss = 5.6288e-02, PNorm = 35.5609, GNorm = 0.8962, lr_0 = 1.0000e-04
Validation rmse = 0.141341
Epoch 58
Loss = 6.1334e-02, PNorm = 35.5638, GNorm = 1.5856, lr_0 = 1.0000e-04
Validation rmse = 0.140317
Epoch 59
Loss = 7.0310e-02, PNorm = 35.5668, GNorm = 1.2811, lr_0 = 1.0000e-04
Loss = 5.8863e-02, PNorm = 35.5703, GNorm = 1.1336, lr_0 = 1.0000e-04
Validation rmse = 0.143279
Model 0 best validation rmse = 0.138108 on epoch 15
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.106980
Ensemble test rmse = 0.106980
1-fold cross validation
	Seed 0 ==> test rmse = 0.106980
Overall test rmse = 0.106980 +/- 0.000000
Elapsed time = 0:00:28
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 967 | train size = 768 | val size = 194 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.8903e-01, PNorm = 34.0183, GNorm = 4.0449, lr_0 = 4.3000e-04
Validation rmse = 0.312844
Epoch 1
Loss = 6.2549e-01, PNorm = 34.0533, GNorm = 2.1214, lr_0 = 7.6000e-04
Loss = 5.2924e-01, PNorm = 34.1141, GNorm = 1.3450, lr_0 = 9.9472e-04
Loss = 4.5931e-01, PNorm = 34.1202, GNorm = 11.8088, lr_0 = 9.9209e-04
Validation rmse = 0.250134
Epoch 2
Loss = 4.3785e-01, PNorm = 34.1781, GNorm = 8.6607, lr_0 = 9.6618e-04
Validation rmse = 0.227799
Epoch 3
Loss = 4.1601e-01, PNorm = 34.2306, GNorm = 2.5000, lr_0 = 9.4094e-04
Loss = 3.3896e-01, PNorm = 34.2880, GNorm = 1.8433, lr_0 = 9.1637e-04
Validation rmse = 0.206075
Epoch 4
Loss = 3.0705e-01, PNorm = 34.3363, GNorm = 8.1649, lr_0 = 8.9007e-04
Validation rmse = 0.219642
Epoch 5
Loss = 3.1896e-01, PNorm = 34.3876, GNorm = 8.4080, lr_0 = 8.6453e-04
Loss = 2.9229e-01, PNorm = 34.4339, GNorm = 3.6614, lr_0 = 8.4195e-04
Validation rmse = 0.183589
Epoch 6
Loss = 2.5201e-01, PNorm = 34.4743, GNorm = 1.6764, lr_0 = 8.1996e-04
Validation rmse = 0.179949
Epoch 7
Loss = 2.3817e-01, PNorm = 34.5176, GNorm = 2.2621, lr_0 = 7.9643e-04
Loss = 1.8257e-01, PNorm = 34.5584, GNorm = 2.3651, lr_0 = 7.7563e-04
Validation rmse = 0.190744
Epoch 8
Loss = 1.9020e-01, PNorm = 34.5966, GNorm = 0.9589, lr_0 = 7.5338e-04
Validation rmse = 0.173245
Epoch 9
Loss = 2.0680e-01, PNorm = 34.6330, GNorm = 8.2818, lr_0 = 7.3370e-04
Loss = 1.5581e-01, PNorm = 34.6661, GNorm = 4.0372, lr_0 = 7.1453e-04
Validation rmse = 0.160922
Epoch 10
Loss = 1.4508e-01, PNorm = 34.6965, GNorm = 3.8978, lr_0 = 6.9403e-04
Validation rmse = 0.157694
Epoch 11
Loss = 1.2004e-01, PNorm = 34.7242, GNorm = 1.2989, lr_0 = 6.7412e-04
Loss = 1.4323e-01, PNorm = 34.7523, GNorm = 1.1275, lr_0 = 6.5651e-04
Validation rmse = 0.157167
Epoch 12
Loss = 1.3081e-01, PNorm = 34.7782, GNorm = 2.8841, lr_0 = 6.3936e-04
Validation rmse = 0.156331
Epoch 13
Loss = 1.0670e-01, PNorm = 34.8043, GNorm = 2.3616, lr_0 = 6.2102e-04
Loss = 1.2939e-01, PNorm = 34.8336, GNorm = 3.6601, lr_0 = 6.0480e-04
Validation rmse = 0.153367
Epoch 14
Loss = 1.1897e-01, PNorm = 34.8557, GNorm = 2.3882, lr_0 = 5.8900e-04
Loss = 1.0710e-01, PNorm = 34.8749, GNorm = 0.8154, lr_0 = 5.7362e-04
Loss = 1.2971e-01, PNorm = 34.8758, GNorm = 2.2543, lr_0 = 5.7210e-04
Validation rmse = 0.149526
Epoch 15
Loss = 1.2086e-01, PNorm = 34.8950, GNorm = 5.7707, lr_0 = 5.5716e-04
Validation rmse = 0.146686
Epoch 16
Loss = 1.0233e-01, PNorm = 34.9094, GNorm = 1.1673, lr_0 = 5.4117e-04
Loss = 1.2676e-01, PNorm = 34.9273, GNorm = 2.4021, lr_0 = 5.2703e-04
Validation rmse = 0.151138
Epoch 17
Loss = 1.1203e-01, PNorm = 34.9440, GNorm = 2.6273, lr_0 = 5.1327e-04
Validation rmse = 0.149243
Epoch 18
Loss = 1.0214e-01, PNorm = 34.9655, GNorm = 1.2181, lr_0 = 4.9854e-04
Loss = 1.0540e-01, PNorm = 34.9789, GNorm = 3.0012, lr_0 = 4.8552e-04
Validation rmse = 0.146103
Epoch 19
Loss = 9.8986e-02, PNorm = 34.9966, GNorm = 3.2472, lr_0 = 4.7159e-04
Validation rmse = 0.149018
Epoch 20
Loss = 1.2200e-01, PNorm = 35.0096, GNorm = 2.3780, lr_0 = 4.5927e-04
Loss = 1.0001e-01, PNorm = 35.0220, GNorm = 2.6292, lr_0 = 4.4728e-04
Validation rmse = 0.144089
Epoch 21
Loss = 1.1750e-01, PNorm = 35.0343, GNorm = 0.8581, lr_0 = 4.3444e-04
Validation rmse = 0.147037
Epoch 22
Loss = 8.3826e-02, PNorm = 35.0542, GNorm = 1.9886, lr_0 = 4.2198e-04
Loss = 1.0339e-01, PNorm = 35.0665, GNorm = 0.6893, lr_0 = 4.1095e-04
Validation rmse = 0.152647
Epoch 23
Loss = 1.0326e-01, PNorm = 35.0803, GNorm = 2.3011, lr_0 = 4.0022e-04
Validation rmse = 0.170735
Epoch 24
Loss = 1.2782e-01, PNorm = 35.0904, GNorm = 2.5457, lr_0 = 3.8874e-04
Loss = 1.0490e-01, PNorm = 35.1047, GNorm = 1.2884, lr_0 = 3.7858e-04
Validation rmse = 0.159217
Epoch 25
Loss = 9.9638e-02, PNorm = 35.1169, GNorm = 4.6577, lr_0 = 3.6869e-04
Validation rmse = 0.153888
Epoch 26
Loss = 1.0422e-01, PNorm = 35.1312, GNorm = 3.7924, lr_0 = 3.5812e-04
Loss = 8.9513e-02, PNorm = 35.1414, GNorm = 2.1121, lr_0 = 3.4876e-04
Validation rmse = 0.143431
Epoch 27
Loss = 8.6905e-02, PNorm = 35.1518, GNorm = 2.3757, lr_0 = 3.3875e-04
Loss = 8.4770e-02, PNorm = 35.1613, GNorm = 1.7128, lr_0 = 3.2991e-04
Validation rmse = 0.151256
Epoch 28
Loss = 8.9931e-02, PNorm = 35.1711, GNorm = 2.3717, lr_0 = 3.2129e-04
Validation rmse = 0.146853
Epoch 29
Loss = 7.7431e-02, PNorm = 35.1792, GNorm = 3.8619, lr_0 = 3.1207e-04
Loss = 9.4341e-02, PNorm = 35.1892, GNorm = 1.3846, lr_0 = 3.0392e-04
Loss = 2.3208e-01, PNorm = 35.1898, GNorm = 8.0873, lr_0 = 3.0312e-04
Validation rmse = 0.144111
Epoch 30
Loss = 7.5656e-02, PNorm = 35.1983, GNorm = 1.7669, lr_0 = 2.9520e-04
Validation rmse = 0.145174
Epoch 31
Loss = 8.5304e-02, PNorm = 35.2069, GNorm = 2.2021, lr_0 = 2.8749e-04
Loss = 8.7443e-02, PNorm = 35.2153, GNorm = 3.9272, lr_0 = 2.7998e-04
Validation rmse = 0.152734
Epoch 32
Loss = 9.1523e-02, PNorm = 35.2244, GNorm = 3.8892, lr_0 = 2.7195e-04
Validation rmse = 0.141629
Epoch 33
Loss = 8.1357e-02, PNorm = 35.2309, GNorm = 0.6235, lr_0 = 2.6414e-04
Loss = 8.0411e-02, PNorm = 35.2369, GNorm = 2.0892, lr_0 = 2.5724e-04
Validation rmse = 0.148643
Epoch 34
Loss = 7.5565e-02, PNorm = 35.2449, GNorm = 0.7685, lr_0 = 2.5052e-04
Validation rmse = 0.145411
Epoch 35
Loss = 7.5271e-02, PNorm = 35.2511, GNorm = 0.9614, lr_0 = 2.4334e-04
Loss = 7.0435e-02, PNorm = 35.2579, GNorm = 0.7175, lr_0 = 2.3698e-04
Validation rmse = 0.144729
Epoch 36
Loss = 7.9500e-02, PNorm = 35.2646, GNorm = 1.2551, lr_0 = 2.3018e-04
Validation rmse = 0.143323
Epoch 37
Loss = 6.0448e-02, PNorm = 35.2702, GNorm = 0.4671, lr_0 = 2.2417e-04
Loss = 7.7933e-02, PNorm = 35.2773, GNorm = 2.0892, lr_0 = 2.1831e-04
Validation rmse = 0.150718
Epoch 38
Loss = 6.9880e-02, PNorm = 35.2836, GNorm = 1.1743, lr_0 = 2.1205e-04
Validation rmse = 0.143263
Epoch 39
Loss = 8.3715e-02, PNorm = 35.2890, GNorm = 2.7224, lr_0 = 2.0651e-04
Loss = 6.7803e-02, PNorm = 35.2946, GNorm = 0.7168, lr_0 = 2.0112e-04
Validation rmse = 0.145383
Epoch 40
Loss = 6.1816e-02, PNorm = 35.2993, GNorm = 1.0776, lr_0 = 1.9535e-04
Validation rmse = 0.147064
Epoch 41
Loss = 5.2385e-02, PNorm = 35.3044, GNorm = 3.9376, lr_0 = 1.8974e-04
Loss = 7.3036e-02, PNorm = 35.3111, GNorm = 1.2651, lr_0 = 1.8478e-04
Validation rmse = 0.144313
Epoch 42
Loss = 6.4597e-02, PNorm = 35.3154, GNorm = 0.7512, lr_0 = 1.7996e-04
Loss = 7.8177e-02, PNorm = 35.3203, GNorm = 0.5918, lr_0 = 1.7526e-04
Loss = 6.3403e-02, PNorm = 35.3207, GNorm = 3.9185, lr_0 = 1.7479e-04
Validation rmse = 0.145660
Epoch 43
Loss = 7.2191e-02, PNorm = 35.3253, GNorm = 1.9881, lr_0 = 1.7023e-04
Validation rmse = 0.145239
Epoch 44
Loss = 7.1621e-02, PNorm = 35.3297, GNorm = 1.4117, lr_0 = 1.6534e-04
Loss = 6.4788e-02, PNorm = 35.3345, GNorm = 1.2043, lr_0 = 1.6103e-04
Validation rmse = 0.142277
Epoch 45
Loss = 6.0141e-02, PNorm = 35.3381, GNorm = 1.1685, lr_0 = 1.5682e-04
Validation rmse = 0.146836
Epoch 46
Loss = 7.3214e-02, PNorm = 35.3431, GNorm = 3.1627, lr_0 = 1.5232e-04
Loss = 6.7528e-02, PNorm = 35.3468, GNorm = 2.7316, lr_0 = 1.4834e-04
Validation rmse = 0.142559
Epoch 47
Loss = 6.7036e-02, PNorm = 35.3516, GNorm = 0.5319, lr_0 = 1.4409e-04
Validation rmse = 0.142098
Epoch 48
Loss = 8.7076e-02, PNorm = 35.3554, GNorm = 1.7437, lr_0 = 1.4032e-04
Loss = 6.0422e-02, PNorm = 35.3595, GNorm = 1.7008, lr_0 = 1.3666e-04
Validation rmse = 0.146470
Epoch 49
Loss = 6.5053e-02, PNorm = 35.3625, GNorm = 0.6053, lr_0 = 1.3274e-04
Validation rmse = 0.142859
Epoch 50
Loss = 5.8788e-02, PNorm = 35.3656, GNorm = 0.5223, lr_0 = 1.2927e-04
Loss = 6.3775e-02, PNorm = 35.3697, GNorm = 0.8062, lr_0 = 1.2589e-04
Validation rmse = 0.144657
Epoch 51
Loss = 6.2952e-02, PNorm = 35.3735, GNorm = 0.5367, lr_0 = 1.2228e-04
Validation rmse = 0.142083
Epoch 52
Loss = 6.4084e-02, PNorm = 35.3766, GNorm = 0.5919, lr_0 = 1.1877e-04
Loss = 6.5192e-02, PNorm = 35.3799, GNorm = 0.9731, lr_0 = 1.1567e-04
Validation rmse = 0.142432
Epoch 53
Loss = 5.7768e-02, PNorm = 35.3821, GNorm = 0.9485, lr_0 = 1.1265e-04
Validation rmse = 0.143543
Epoch 54
Loss = 4.8886e-02, PNorm = 35.3850, GNorm = 0.7285, lr_0 = 1.0942e-04
Loss = 6.5640e-02, PNorm = 35.3891, GNorm = 0.7692, lr_0 = 1.0656e-04
Validation rmse = 0.141587
Epoch 55
Loss = 5.8181e-02, PNorm = 35.3911, GNorm = 1.6826, lr_0 = 1.0350e-04
Loss = 7.1750e-02, PNorm = 35.3936, GNorm = 1.3907, lr_0 = 1.0080e-04
Validation rmse = 0.143315
Epoch 56
Loss = 6.7202e-02, PNorm = 35.3965, GNorm = 2.3932, lr_0 = 1.0000e-04
Validation rmse = 0.143431
Epoch 57
Loss = 8.5351e-02, PNorm = 35.3984, GNorm = 2.8385, lr_0 = 1.0000e-04
Loss = 5.7452e-02, PNorm = 35.4015, GNorm = 4.0753, lr_0 = 1.0000e-04
Loss = 2.9767e-02, PNorm = 35.4016, GNorm = 0.6907, lr_0 = 1.0000e-04
Validation rmse = 0.141360
Epoch 58
Loss = 6.0903e-02, PNorm = 35.4041, GNorm = 0.9365, lr_0 = 1.0000e-04
Validation rmse = 0.142038
Epoch 59
Loss = 5.1442e-02, PNorm = 35.4064, GNorm = 2.7795, lr_0 = 1.0000e-04
Loss = 6.7163e-02, PNorm = 35.4090, GNorm = 1.4846, lr_0 = 1.0000e-04
Validation rmse = 0.143227
Model 0 best validation rmse = 0.141360 on epoch 57
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.120315
Ensemble test rmse = 0.120315
1-fold cross validation
	Seed 0 ==> test rmse = 0.120315
Overall test rmse = 0.120315 +/- 0.000000
Elapsed time = 0:00:29
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 957 | train size = 760 | val size = 192 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.2182e-01, PNorm = 34.0176, GNorm = 1.1419, lr_0 = 4.3000e-04
Validation rmse = 0.297180
Epoch 1
Loss = 5.8895e-01, PNorm = 34.0552, GNorm = 9.0457, lr_0 = 7.6000e-04
Loss = 8.5993e-01, PNorm = 34.0934, GNorm = 1.5924, lr_0 = 9.9472e-04
Loss = 3.5602e-01, PNorm = 34.0991, GNorm = 2.4871, lr_0 = 9.9209e-04
Validation rmse = 0.419393
Epoch 2
Loss = 9.0524e-01, PNorm = 34.1412, GNorm = 3.7005, lr_0 = 9.6618e-04
Validation rmse = 0.297541
Epoch 3
Loss = 5.7078e-01, PNorm = 34.2081, GNorm = 5.3242, lr_0 = 9.3846e-04
Loss = 5.0264e-01, PNorm = 34.2638, GNorm = 3.6894, lr_0 = 9.1394e-04
Loss = 2.8894e-01, PNorm = 34.2690, GNorm = 2.9653, lr_0 = 9.1153e-04
Validation rmse = 0.234282
Epoch 4
Loss = 3.7471e-01, PNorm = 34.3157, GNorm = 0.9789, lr_0 = 8.8772e-04
Validation rmse = 0.214413
Epoch 5
Loss = 3.5464e-01, PNorm = 34.3609, GNorm = 1.6249, lr_0 = 8.6453e-04
Loss = 3.2390e-01, PNorm = 34.3998, GNorm = 6.5705, lr_0 = 8.4195e-04
Validation rmse = 0.224093
Epoch 6
Loss = 3.3939e-01, PNorm = 34.4438, GNorm = 1.3514, lr_0 = 8.1779e-04
Validation rmse = 0.192214
Epoch 7
Loss = 2.7365e-01, PNorm = 34.4904, GNorm = 4.6717, lr_0 = 7.9433e-04
Loss = 2.5124e-01, PNorm = 34.5303, GNorm = 2.5720, lr_0 = 7.7358e-04
Validation rmse = 0.178133
Epoch 8
Loss = 2.1903e-01, PNorm = 34.5730, GNorm = 2.9993, lr_0 = 7.5138e-04
Validation rmse = 0.171224
Epoch 9
Loss = 2.2138e-01, PNorm = 34.6165, GNorm = 0.7940, lr_0 = 7.2982e-04
Loss = 1.9268e-01, PNorm = 34.6493, GNorm = 2.6116, lr_0 = 7.1076e-04
Validation rmse = 0.165050
Epoch 10
Loss = 1.4861e-01, PNorm = 34.6805, GNorm = 1.2587, lr_0 = 6.9220e-04
Validation rmse = 0.156239
Epoch 11
Loss = 2.0122e-01, PNorm = 34.7162, GNorm = 4.8742, lr_0 = 6.7234e-04
Loss = 1.5206e-01, PNorm = 34.7483, GNorm = 2.1583, lr_0 = 6.5477e-04
Validation rmse = 0.176845
Epoch 12
Loss = 1.9809e-01, PNorm = 34.7852, GNorm = 3.9870, lr_0 = 6.3599e-04
Validation rmse = 0.150342
Epoch 13
Loss = 1.8957e-01, PNorm = 34.8136, GNorm = 2.5369, lr_0 = 6.1774e-04
Loss = 1.5153e-01, PNorm = 34.8407, GNorm = 2.0765, lr_0 = 6.0160e-04
Validation rmse = 0.143143
Epoch 14
Loss = 1.4018e-01, PNorm = 34.8618, GNorm = 2.0030, lr_0 = 5.8434e-04
Validation rmse = 0.140312
Epoch 15
Loss = 1.2488e-01, PNorm = 34.8882, GNorm = 0.9655, lr_0 = 5.6908e-04
Loss = 1.2410e-01, PNorm = 34.9104, GNorm = 1.7625, lr_0 = 5.5421e-04
Validation rmse = 0.146939
Epoch 16
Loss = 1.5267e-01, PNorm = 34.9329, GNorm = 3.2596, lr_0 = 5.3831e-04
Validation rmse = 0.142978
Epoch 17
Loss = 1.0633e-01, PNorm = 34.9580, GNorm = 1.2309, lr_0 = 5.2287e-04
Loss = 1.2166e-01, PNorm = 34.9782, GNorm = 0.7600, lr_0 = 5.0921e-04
Validation rmse = 0.143500
Epoch 18
Loss = 1.2148e-01, PNorm = 34.9909, GNorm = 1.3458, lr_0 = 4.9460e-04
Validation rmse = 0.141996
Epoch 19
Loss = 8.9219e-02, PNorm = 35.0075, GNorm = 2.4176, lr_0 = 4.8041e-04
Loss = 1.2145e-01, PNorm = 35.0255, GNorm = 1.1790, lr_0 = 4.6786e-04
Validation rmse = 0.139323
Epoch 20
Loss = 1.0601e-01, PNorm = 35.0400, GNorm = 1.3067, lr_0 = 4.5564e-04
Validation rmse = 0.152465
Epoch 21
Loss = 1.3885e-01, PNorm = 35.0570, GNorm = 6.9490, lr_0 = 4.4256e-04
Loss = 1.2186e-01, PNorm = 35.0707, GNorm = 1.0424, lr_0 = 4.3101e-04
Validation rmse = 0.161371
Epoch 22
Loss = 1.3634e-01, PNorm = 35.0850, GNorm = 0.9265, lr_0 = 4.1864e-04
Validation rmse = 0.138601
Epoch 23
Loss = 7.6915e-02, PNorm = 35.1004, GNorm = 1.7730, lr_0 = 4.0663e-04
Loss = 1.0118e-01, PNorm = 35.1121, GNorm = 1.5886, lr_0 = 3.9601e-04
Validation rmse = 0.141985
Epoch 24
Loss = 1.0209e-01, PNorm = 35.1264, GNorm = 3.5586, lr_0 = 3.8464e-04
Loss = 9.9139e-02, PNorm = 35.1394, GNorm = 2.6320, lr_0 = 3.7460e-04
Validation rmse = 0.145121
Epoch 25
Loss = 1.1585e-01, PNorm = 35.1511, GNorm = 1.0732, lr_0 = 3.6481e-04
Validation rmse = 0.152809
Epoch 26
Loss = 1.4138e-01, PNorm = 35.1653, GNorm = 4.4119, lr_0 = 3.5434e-04
Loss = 9.1693e-02, PNorm = 35.1783, GNorm = 1.4005, lr_0 = 3.4509e-04
Loss = 3.0592e-02, PNorm = 35.1791, GNorm = 0.9444, lr_0 = 3.4418e-04
Validation rmse = 0.147953
Epoch 27
Loss = 9.2379e-02, PNorm = 35.1868, GNorm = 0.4519, lr_0 = 3.3519e-04
Validation rmse = 0.142716
Epoch 28
Loss = 9.1941e-02, PNorm = 35.1956, GNorm = 0.7896, lr_0 = 3.2557e-04
Loss = 8.9332e-02, PNorm = 35.2052, GNorm = 1.9884, lr_0 = 3.1707e-04
Loss = 8.6917e-02, PNorm = 35.2059, GNorm = 3.6960, lr_0 = 3.1623e-04
Validation rmse = 0.140107
Epoch 29
Loss = 9.2908e-02, PNorm = 35.2152, GNorm = 1.5948, lr_0 = 3.0797e-04
Validation rmse = 0.138773
Epoch 30
Loss = 1.2196e-01, PNorm = 35.2251, GNorm = 2.3883, lr_0 = 2.9992e-04
Loss = 9.3417e-02, PNorm = 35.2340, GNorm = 0.6727, lr_0 = 2.9209e-04
Validation rmse = 0.144203
Epoch 31
Loss = 9.3014e-02, PNorm = 35.2416, GNorm = 0.6525, lr_0 = 2.8371e-04
Validation rmse = 0.142100
Epoch 32
Loss = 6.5297e-02, PNorm = 35.2481, GNorm = 1.0271, lr_0 = 2.7557e-04
Loss = 9.5257e-02, PNorm = 35.2556, GNorm = 2.9095, lr_0 = 2.6837e-04
Validation rmse = 0.143471
Epoch 33
Loss = 9.4402e-02, PNorm = 35.2637, GNorm = 1.1652, lr_0 = 2.6067e-04
Validation rmse = 0.143583
Epoch 34
Loss = 1.0693e-01, PNorm = 35.2710, GNorm = 1.5220, lr_0 = 2.5319e-04
Loss = 7.6180e-02, PNorm = 35.2768, GNorm = 1.6306, lr_0 = 2.4658e-04
Validation rmse = 0.143692
Epoch 35
Loss = 8.2918e-02, PNorm = 35.2854, GNorm = 1.2640, lr_0 = 2.4014e-04
Validation rmse = 0.141731
Epoch 36
Loss = 7.0406e-02, PNorm = 35.2925, GNorm = 1.2534, lr_0 = 2.3325e-04
Loss = 8.5018e-02, PNorm = 35.2970, GNorm = 1.4926, lr_0 = 2.2715e-04
Validation rmse = 0.140233
Epoch 37
Loss = 6.7183e-02, PNorm = 35.3026, GNorm = 1.3873, lr_0 = 2.2064e-04
Validation rmse = 0.143151
Epoch 38
Loss = 6.3982e-02, PNorm = 35.3101, GNorm = 0.9006, lr_0 = 2.1431e-04
Loss = 8.5706e-02, PNorm = 35.3168, GNorm = 3.2000, lr_0 = 2.0871e-04
Validation rmse = 0.142172
Epoch 39
Loss = 7.0265e-02, PNorm = 35.3221, GNorm = 1.2125, lr_0 = 2.0272e-04
Validation rmse = 0.140731
Epoch 40
Loss = 7.2013e-02, PNorm = 35.3271, GNorm = 0.6452, lr_0 = 1.9743e-04
Loss = 8.1538e-02, PNorm = 35.3316, GNorm = 2.2204, lr_0 = 1.9227e-04
Validation rmse = 0.146068
Epoch 41
Loss = 8.2056e-02, PNorm = 35.3371, GNorm = 2.3194, lr_0 = 1.8675e-04
Validation rmse = 0.152126
Epoch 42
Loss = 1.2008e-01, PNorm = 35.3413, GNorm = 4.5284, lr_0 = 1.8139e-04
Loss = 8.3416e-02, PNorm = 35.3465, GNorm = 2.1850, lr_0 = 1.7666e-04
Validation rmse = 0.144306
Epoch 43
Loss = 8.6648e-02, PNorm = 35.3523, GNorm = 2.9642, lr_0 = 1.7159e-04
Validation rmse = 0.144694
Epoch 44
Loss = 9.1379e-02, PNorm = 35.3584, GNorm = 2.9461, lr_0 = 1.6666e-04
Loss = 7.0167e-02, PNorm = 35.3622, GNorm = 1.1861, lr_0 = 1.6231e-04
Validation rmse = 0.144389
Epoch 45
Loss = 6.7170e-02, PNorm = 35.3666, GNorm = 0.6125, lr_0 = 1.5807e-04
Validation rmse = 0.142227
Epoch 46
Loss = 9.0059e-02, PNorm = 35.3706, GNorm = 1.2014, lr_0 = 1.5353e-04
Loss = 8.2647e-02, PNorm = 35.3752, GNorm = 1.4828, lr_0 = 1.4952e-04
Validation rmse = 0.141153
Epoch 47
Loss = 6.0410e-02, PNorm = 35.3787, GNorm = 1.3433, lr_0 = 1.4523e-04
Validation rmse = 0.142222
Epoch 48
Loss = 1.8161e-01, PNorm = 35.3819, GNorm = 1.3536, lr_0 = 1.4107e-04
Loss = 7.0414e-02, PNorm = 35.3873, GNorm = 3.2400, lr_0 = 1.3738e-04
Validation rmse = 0.142170
Epoch 49
Loss = 6.5593e-02, PNorm = 35.3913, GNorm = 0.5467, lr_0 = 1.3344e-04
Loss = 7.9065e-02, PNorm = 35.3942, GNorm = 2.7182, lr_0 = 1.2996e-04
Validation rmse = 0.142907
Epoch 50
Loss = 6.9642e-02, PNorm = 35.3981, GNorm = 0.7791, lr_0 = 1.2656e-04
Validation rmse = 0.141659
Epoch 51
Loss = 8.7383e-02, PNorm = 35.4013, GNorm = 1.8384, lr_0 = 1.2293e-04
Loss = 6.6770e-02, PNorm = 35.4041, GNorm = 0.5055, lr_0 = 1.1972e-04
Loss = 1.7121e-02, PNorm = 35.4044, GNorm = 1.4303, lr_0 = 1.1940e-04
Validation rmse = 0.142342
Epoch 52
Loss = 6.7779e-02, PNorm = 35.4069, GNorm = 0.8815, lr_0 = 1.1628e-04
Validation rmse = 0.141533
Epoch 53
Loss = 7.5645e-02, PNorm = 35.4108, GNorm = 0.5290, lr_0 = 1.1295e-04
Loss = 6.8754e-02, PNorm = 35.4132, GNorm = 1.4703, lr_0 = 1.1000e-04
Loss = 1.3700e-01, PNorm = 35.4134, GNorm = 4.9741, lr_0 = 1.0971e-04
Validation rmse = 0.144936
Epoch 54
Loss = 6.9552e-02, PNorm = 35.4177, GNorm = 2.2431, lr_0 = 1.0684e-04
Validation rmse = 0.144860
Epoch 55
Loss = 6.6335e-02, PNorm = 35.4196, GNorm = 1.5625, lr_0 = 1.0405e-04
Loss = 7.8215e-02, PNorm = 35.4218, GNorm = 0.7364, lr_0 = 1.0133e-04
Validation rmse = 0.141978
Epoch 56
Loss = 7.9246e-02, PNorm = 35.4266, GNorm = 1.9595, lr_0 = 1.0000e-04
Validation rmse = 0.143023
Epoch 57
Loss = 5.5982e-02, PNorm = 35.4295, GNorm = 1.1391, lr_0 = 1.0000e-04
Loss = 8.4649e-02, PNorm = 35.4316, GNorm = 1.0712, lr_0 = 1.0000e-04
Validation rmse = 0.143069
Epoch 58
Loss = 7.5701e-02, PNorm = 35.4343, GNorm = 0.7621, lr_0 = 1.0000e-04
Validation rmse = 0.144212
Epoch 59
Loss = 7.7837e-02, PNorm = 35.4376, GNorm = 2.4717, lr_0 = 1.0000e-04
Loss = 7.9174e-02, PNorm = 35.4403, GNorm = 0.7637, lr_0 = 1.0000e-04
Validation rmse = 0.150010
Model 0 best validation rmse = 0.138601 on epoch 22
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.141959
Ensemble test rmse = 0.141959
1-fold cross validation
	Seed 0 ==> test rmse = 0.141959
Overall test rmse = 0.141959 +/- 0.000000
Elapsed time = 0:00:28
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 947 | train size = 752 | val size = 190 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.4669e-01, PNorm = 34.0168, GNorm = 8.6483, lr_0 = 4.3000e-04
Validation rmse = 0.295471
Epoch 1
Loss = 8.4997e-01, PNorm = 34.0397, GNorm = 4.4815, lr_0 = 7.6000e-04
Loss = 8.0849e-01, PNorm = 34.0835, GNorm = 5.0809, lr_0 = 9.9472e-04
Loss = 2.3131e+00, PNorm = 34.0870, GNorm = 13.2580, lr_0 = 9.9209e-04
Validation rmse = 0.283645
Epoch 2
Loss = 6.5536e-01, PNorm = 34.1467, GNorm = 8.5488, lr_0 = 9.6618e-04
Validation rmse = 0.259797
Epoch 3
Loss = 5.2606e-01, PNorm = 34.2108, GNorm = 1.5004, lr_0 = 9.3846e-04
Loss = 5.6676e-01, PNorm = 34.2635, GNorm = 3.0008, lr_0 = 9.1394e-04
Loss = 1.1525e+00, PNorm = 34.2689, GNorm = 6.7025, lr_0 = 9.1153e-04
Validation rmse = 0.281195
Epoch 4
Loss = 4.6970e-01, PNorm = 34.3184, GNorm = 6.4969, lr_0 = 8.8772e-04
Validation rmse = 0.220858
Epoch 5
Loss = 3.0476e-01, PNorm = 34.3673, GNorm = 1.9496, lr_0 = 8.6225e-04
Loss = 3.5474e-01, PNorm = 34.3955, GNorm = 1.5603, lr_0 = 8.3973e-04
Loss = 3.4083e-01, PNorm = 34.4005, GNorm = 4.3367, lr_0 = 8.3751e-04
Validation rmse = 0.204854
Epoch 6
Loss = 2.6461e-01, PNorm = 34.4431, GNorm = 1.0452, lr_0 = 8.1563e-04
Validation rmse = 0.213397
Epoch 7
Loss = 3.3255e-01, PNorm = 34.4823, GNorm = 1.5702, lr_0 = 7.9223e-04
Loss = 3.5053e-01, PNorm = 34.5152, GNorm = 0.9237, lr_0 = 7.7154e-04
Loss = 1.1893e-01, PNorm = 34.5187, GNorm = 4.5255, lr_0 = 7.6950e-04
Validation rmse = 0.211521
Epoch 8
Loss = 2.6331e-01, PNorm = 34.5562, GNorm = 3.1775, lr_0 = 7.4940e-04
Validation rmse = 0.185579
Epoch 9
Loss = 2.0672e-01, PNorm = 34.5826, GNorm = 1.5563, lr_0 = 7.2790e-04
Loss = 1.9865e-01, PNorm = 34.6111, GNorm = 4.7525, lr_0 = 7.0888e-04
Loss = 3.3922e-02, PNorm = 34.6138, GNorm = 3.8315, lr_0 = 7.0701e-04
Validation rmse = 0.174665
Epoch 10
Loss = 1.5866e-01, PNorm = 34.6449, GNorm = 1.0044, lr_0 = 6.8854e-04
Validation rmse = 0.186168
Epoch 11
Loss = 2.0045e-01, PNorm = 34.6774, GNorm = 4.2840, lr_0 = 6.6879e-04
Loss = 1.8934e-01, PNorm = 34.7066, GNorm = 3.0127, lr_0 = 6.5132e-04
Loss = 2.0160e-01, PNorm = 34.7112, GNorm = 8.3725, lr_0 = 6.4960e-04
Validation rmse = 0.187766
Epoch 12
Loss = 1.9804e-01, PNorm = 34.7389, GNorm = 0.9953, lr_0 = 6.3263e-04
Validation rmse = 0.197773
Epoch 13
Loss = 2.3045e-01, PNorm = 34.7682, GNorm = 3.7121, lr_0 = 6.1448e-04
Loss = 1.6543e-01, PNorm = 34.7939, GNorm = 2.7494, lr_0 = 5.9843e-04
Loss = 1.9850e-02, PNorm = 34.7963, GNorm = 1.8429, lr_0 = 5.9685e-04
Validation rmse = 0.183216
Epoch 14
Loss = 1.4872e-01, PNorm = 34.8182, GNorm = 1.2384, lr_0 = 5.8126e-04
Validation rmse = 0.155111
Epoch 15
Loss = 1.2642e-01, PNorm = 34.8372, GNorm = 1.4438, lr_0 = 5.6458e-04
Loss = 1.1474e-01, PNorm = 34.8544, GNorm = 1.8799, lr_0 = 5.4983e-04
Loss = 1.7231e-01, PNorm = 34.8576, GNorm = 5.7165, lr_0 = 5.4838e-04
Validation rmse = 0.157426
Epoch 16
Loss = 1.3619e-01, PNorm = 34.8804, GNorm = 1.3524, lr_0 = 5.3406e-04
Validation rmse = 0.155695
Epoch 17
Loss = 1.2003e-01, PNorm = 34.8951, GNorm = 0.8462, lr_0 = 5.1873e-04
Loss = 1.1631e-01, PNorm = 34.9123, GNorm = 1.7092, lr_0 = 5.0518e-04
Loss = 3.7095e-01, PNorm = 34.9135, GNorm = 10.9284, lr_0 = 5.0385e-04
Validation rmse = 0.158310
Epoch 18
Loss = 1.3554e-01, PNorm = 34.9353, GNorm = 3.2605, lr_0 = 4.9069e-04
Validation rmse = 0.178803
Epoch 19
Loss = 1.5340e-01, PNorm = 34.9582, GNorm = 1.4502, lr_0 = 4.7661e-04
Loss = 1.0965e-01, PNorm = 34.9768, GNorm = 0.6176, lr_0 = 4.6416e-04
Loss = 1.3635e-01, PNorm = 34.9780, GNorm = 5.1355, lr_0 = 4.6293e-04
Validation rmse = 0.147459
Epoch 20
Loss = 1.0659e-01, PNorm = 34.9901, GNorm = 0.6952, lr_0 = 4.5084e-04
Validation rmse = 0.165275
Epoch 21
Loss = 1.1799e-01, PNorm = 35.0042, GNorm = 1.5586, lr_0 = 4.3790e-04
Loss = 1.0261e-01, PNorm = 35.0159, GNorm = 1.2240, lr_0 = 4.2647e-04
Loss = 3.0884e-02, PNorm = 35.0169, GNorm = 2.9112, lr_0 = 4.2534e-04
Validation rmse = 0.151814
Epoch 22
Loss = 8.6040e-02, PNorm = 35.0255, GNorm = 1.6742, lr_0 = 4.1423e-04
Validation rmse = 0.160173
Epoch 23
Loss = 1.5046e-01, PNorm = 35.0417, GNorm = 0.7609, lr_0 = 4.0234e-04
Loss = 1.3467e-01, PNorm = 35.0577, GNorm = 1.2230, lr_0 = 3.9184e-04
Loss = 7.3820e-02, PNorm = 35.0602, GNorm = 6.7861, lr_0 = 3.9080e-04
Validation rmse = 0.184230
Epoch 24
Loss = 1.5752e-01, PNorm = 35.0694, GNorm = 1.6905, lr_0 = 3.8059e-04
Validation rmse = 0.154464
Epoch 25
Loss = 1.0131e-01, PNorm = 35.0818, GNorm = 2.9541, lr_0 = 3.7065e-04
Loss = 1.0097e-01, PNorm = 35.0937, GNorm = 1.2779, lr_0 = 3.6097e-04
Validation rmse = 0.147927
Epoch 26
Loss = 9.4628e-02, PNorm = 35.1021, GNorm = 1.5742, lr_0 = 3.5061e-04
Validation rmse = 0.153280
Epoch 27
Loss = 8.8615e-02, PNorm = 35.1107, GNorm = 1.4917, lr_0 = 3.4055e-04
Loss = 9.0657e-02, PNorm = 35.1191, GNorm = 1.7459, lr_0 = 3.3166e-04
Validation rmse = 0.147652
Epoch 28
Loss = 8.7992e-02, PNorm = 35.1271, GNorm = 0.4212, lr_0 = 3.2214e-04
Validation rmse = 0.146990
Epoch 29
Loss = 8.9007e-02, PNorm = 35.1340, GNorm = 2.0016, lr_0 = 3.1290e-04
Loss = 9.6786e-02, PNorm = 35.1413, GNorm = 2.2269, lr_0 = 3.0472e-04
Validation rmse = 0.148848
Epoch 30
Loss = 9.7762e-02, PNorm = 35.1485, GNorm = 1.5843, lr_0 = 2.9598e-04
Validation rmse = 0.158795
Epoch 31
Loss = 9.6548e-02, PNorm = 35.1569, GNorm = 0.6705, lr_0 = 2.8749e-04
Loss = 8.3938e-02, PNorm = 35.1663, GNorm = 0.9432, lr_0 = 2.7998e-04
Validation rmse = 0.150943
Epoch 32
Loss = 8.3882e-02, PNorm = 35.1721, GNorm = 0.9122, lr_0 = 2.7195e-04
Validation rmse = 0.156887
Epoch 33
Loss = 9.4656e-02, PNorm = 35.1796, GNorm = 0.4847, lr_0 = 2.6414e-04
Loss = 8.7909e-02, PNorm = 35.1870, GNorm = 2.3013, lr_0 = 2.5724e-04
Validation rmse = 0.154762
Epoch 34
Loss = 8.2362e-02, PNorm = 35.1913, GNorm = 2.3343, lr_0 = 2.4986e-04
Validation rmse = 0.145211
Epoch 35
Loss = 9.5866e-02, PNorm = 35.1987, GNorm = 2.2845, lr_0 = 2.4269e-04
Loss = 9.2933e-02, PNorm = 35.2049, GNorm = 2.8533, lr_0 = 2.3635e-04
Validation rmse = 0.150689
Epoch 36
Loss = 9.3523e-02, PNorm = 35.2100, GNorm = 2.7260, lr_0 = 2.2957e-04
Validation rmse = 0.147721
Epoch 37
Loss = 6.5015e-02, PNorm = 35.2168, GNorm = 1.7137, lr_0 = 2.2299e-04
Loss = 9.0528e-02, PNorm = 35.2228, GNorm = 1.0724, lr_0 = 2.1716e-04
Validation rmse = 0.146676
Epoch 38
Loss = 9.3649e-02, PNorm = 35.2320, GNorm = 0.9486, lr_0 = 2.1093e-04
Validation rmse = 0.151061
Epoch 39
Loss = 7.8448e-02, PNorm = 35.2388, GNorm = 3.0889, lr_0 = 2.0488e-04
Loss = 9.6252e-02, PNorm = 35.2457, GNorm = 1.2896, lr_0 = 1.9953e-04
Validation rmse = 0.149085
Epoch 40
Loss = 7.9479e-02, PNorm = 35.2522, GNorm = 1.0731, lr_0 = 1.9380e-04
Validation rmse = 0.147908
Epoch 41
Loss = 7.0622e-02, PNorm = 35.2564, GNorm = 0.5176, lr_0 = 1.8824e-04
Loss = 8.0314e-02, PNorm = 35.2584, GNorm = 0.5067, lr_0 = 1.8332e-04
Validation rmse = 0.150865
Epoch 42
Loss = 9.0254e-02, PNorm = 35.2623, GNorm = 2.7944, lr_0 = 1.7806e-04
Validation rmse = 0.167509
Epoch 43
Loss = 1.0469e-01, PNorm = 35.2671, GNorm = 1.6145, lr_0 = 1.7295e-04
Loss = 8.2996e-02, PNorm = 35.2710, GNorm = 0.8329, lr_0 = 1.6844e-04
Validation rmse = 0.148658
Epoch 44
Loss = 7.1775e-02, PNorm = 35.2743, GNorm = 1.1454, lr_0 = 1.6360e-04
Validation rmse = 0.143651
Epoch 45
Loss = 6.3900e-02, PNorm = 35.2787, GNorm = 1.6103, lr_0 = 1.5891e-04
Loss = 8.2449e-02, PNorm = 35.2832, GNorm = 1.3784, lr_0 = 1.5476e-04
Validation rmse = 0.144534
Epoch 46
Loss = 8.2264e-02, PNorm = 35.2900, GNorm = 1.3454, lr_0 = 1.5032e-04
Validation rmse = 0.143432
Epoch 47
Loss = 8.5648e-02, PNorm = 35.2929, GNorm = 1.1067, lr_0 = 1.4601e-04
Loss = 8.0610e-02, PNorm = 35.2962, GNorm = 0.7417, lr_0 = 1.4219e-04
Validation rmse = 0.143263
Epoch 48
Loss = 7.3322e-02, PNorm = 35.2992, GNorm = 1.0636, lr_0 = 1.3811e-04
Validation rmse = 0.143090
Epoch 49
Loss = 7.2104e-02, PNorm = 35.3017, GNorm = 0.7589, lr_0 = 1.3415e-04
Loss = 7.1320e-02, PNorm = 35.3042, GNorm = 0.4649, lr_0 = 1.3064e-04
Validation rmse = 0.143439
Epoch 50
Loss = 6.7647e-02, PNorm = 35.3066, GNorm = 0.5556, lr_0 = 1.2723e-04
Validation rmse = 0.144294
Epoch 51
Loss = 7.5785e-02, PNorm = 35.3090, GNorm = 0.7067, lr_0 = 1.2358e-04
Loss = 7.2790e-02, PNorm = 35.3124, GNorm = 0.4058, lr_0 = 1.2035e-04
Validation rmse = 0.147063
Epoch 52
Loss = 7.3175e-02, PNorm = 35.3145, GNorm = 1.5053, lr_0 = 1.1690e-04
Validation rmse = 0.148237
Epoch 53
Loss = 6.3964e-02, PNorm = 35.3170, GNorm = 0.4509, lr_0 = 1.1355e-04
Loss = 7.5121e-02, PNorm = 35.3193, GNorm = 0.7660, lr_0 = 1.1058e-04
Validation rmse = 0.149482
Epoch 54
Loss = 7.4360e-02, PNorm = 35.3223, GNorm = 0.7449, lr_0 = 1.0741e-04
Validation rmse = 0.144119
Epoch 55
Loss = 6.7582e-02, PNorm = 35.3248, GNorm = 0.7348, lr_0 = 1.0433e-04
Loss = 7.1630e-02, PNorm = 35.3285, GNorm = 0.7176, lr_0 = 1.0160e-04
Validation rmse = 0.146738
Epoch 56
Loss = 7.9683e-02, PNorm = 35.3313, GNorm = 0.7648, lr_0 = 1.0000e-04
Validation rmse = 0.148621
Epoch 57
Loss = 5.1499e-02, PNorm = 35.3341, GNorm = 0.7025, lr_0 = 1.0000e-04
Loss = 7.6741e-02, PNorm = 35.3353, GNorm = 2.3247, lr_0 = 1.0000e-04
Validation rmse = 0.144456
Epoch 58
Loss = 6.5656e-02, PNorm = 35.3380, GNorm = 0.7047, lr_0 = 1.0000e-04
Validation rmse = 0.143323
Epoch 59
Loss = 7.5500e-02, PNorm = 35.3408, GNorm = 0.6747, lr_0 = 1.0000e-04
Loss = 7.3331e-02, PNorm = 35.3427, GNorm = 1.0176, lr_0 = 1.0000e-04
Validation rmse = 0.143014
Model 0 best validation rmse = 0.143014 on epoch 59
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.111959
Ensemble test rmse = 0.111959
1-fold cross validation
	Seed 0 ==> test rmse = 0.111959
Overall test rmse = 0.111959 +/- 0.000000
Elapsed time = 0:00:28
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 937 | train size = 744 | val size = 188 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.2721e-01, PNorm = 34.0181, GNorm = 1.3874, lr_0 = 4.5357e-04
Validation rmse = 0.289071
Epoch 1
Loss = 6.0198e-01, PNorm = 34.0573, GNorm = 5.1647, lr_0 = 8.0714e-04
Validation rmse = 0.305932
Epoch 2
Loss = 7.3121e-01, PNorm = 34.1083, GNorm = 12.4195, lr_0 = 9.8872e-04
Loss = 4.7999e-01, PNorm = 34.1714, GNorm = 3.4980, lr_0 = 9.6108e-04
Validation rmse = 0.241232
Epoch 3
Loss = 3.4167e-01, PNorm = 34.2369, GNorm = 1.8042, lr_0 = 9.3421e-04
Validation rmse = 0.214852
Epoch 4
Loss = 3.7234e-01, PNorm = 34.2939, GNorm = 4.0563, lr_0 = 9.0809e-04
Loss = 2.9359e-01, PNorm = 34.3486, GNorm = 5.9002, lr_0 = 8.8270e-04
Validation rmse = 0.209043
Epoch 5
Loss = 2.6221e-01, PNorm = 34.3940, GNorm = 3.6617, lr_0 = 8.5802e-04
Validation rmse = 0.209424
Epoch 6
Loss = 2.2302e-01, PNorm = 34.4317, GNorm = 2.8139, lr_0 = 8.3403e-04
Loss = 2.2985e-01, PNorm = 34.4679, GNorm = 4.0720, lr_0 = 8.1071e-04
Validation rmse = 0.180370
Epoch 7
Loss = 2.0262e-01, PNorm = 34.5044, GNorm = 1.9270, lr_0 = 7.8805e-04
Validation rmse = 0.184010
Epoch 8
Loss = 1.9679e-01, PNorm = 34.5388, GNorm = 3.7688, lr_0 = 7.6601e-04
Loss = 2.1865e-01, PNorm = 34.5702, GNorm = 6.0892, lr_0 = 7.4460e-04
Validation rmse = 0.167991
Epoch 9
Loss = 1.7139e-01, PNorm = 34.6012, GNorm = 0.7775, lr_0 = 7.2173e-04
Validation rmse = 0.167347
Epoch 10
Loss = 2.5168e-01, PNorm = 34.6321, GNorm = 5.3354, lr_0 = 7.0155e-04
Loss = 1.4119e-01, PNorm = 34.6695, GNorm = 1.5319, lr_0 = 6.8194e-04
Validation rmse = 0.157869
Epoch 11
Loss = 1.4484e-01, PNorm = 34.6970, GNorm = 4.0556, lr_0 = 6.6287e-04
Validation rmse = 0.151222
Epoch 12
Loss = 1.7279e-01, PNorm = 34.7216, GNorm = 4.9744, lr_0 = 6.4434e-04
Loss = 1.4451e-01, PNorm = 34.7465, GNorm = 2.1764, lr_0 = 6.2632e-04
Validation rmse = 0.145097
Epoch 13
Loss = 1.2849e-01, PNorm = 34.7670, GNorm = 5.8541, lr_0 = 6.0881e-04
Validation rmse = 0.158266
Epoch 14
Loss = 1.5542e-01, PNorm = 34.7917, GNorm = 3.7664, lr_0 = 5.9179e-04
Loss = 1.4093e-01, PNorm = 34.8119, GNorm = 6.2624, lr_0 = 5.7524e-04
Validation rmse = 0.141028
Epoch 15
Loss = 1.5180e-01, PNorm = 34.8362, GNorm = 5.2739, lr_0 = 5.5916e-04
Validation rmse = 0.143502
Epoch 16
Loss = 1.3913e-01, PNorm = 34.8591, GNorm = 2.4244, lr_0 = 5.4353e-04
Loss = 1.4899e-01, PNorm = 34.8820, GNorm = 4.0761, lr_0 = 5.2833e-04
Validation rmse = 0.155816
Epoch 17
Loss = 1.2435e-01, PNorm = 34.9041, GNorm = 1.4295, lr_0 = 5.1211e-04
Validation rmse = 0.149928
Epoch 18
Loss = 1.0298e-01, PNorm = 34.9241, GNorm = 3.3210, lr_0 = 4.9779e-04
Loss = 1.1100e-01, PNorm = 34.9418, GNorm = 1.1716, lr_0 = 4.8387e-04
Validation rmse = 0.136619
Epoch 19
Loss = 1.1021e-01, PNorm = 34.9570, GNorm = 2.2565, lr_0 = 4.7034e-04
Validation rmse = 0.145737
Epoch 20
Loss = 1.0129e-01, PNorm = 34.9730, GNorm = 1.3138, lr_0 = 4.5719e-04
Loss = 1.0208e-01, PNorm = 34.9886, GNorm = 3.1200, lr_0 = 4.4441e-04
Validation rmse = 0.132297
Epoch 21
Loss = 7.6059e-02, PNorm = 35.0034, GNorm = 0.6309, lr_0 = 4.3198e-04
Validation rmse = 0.132114
Epoch 22
Loss = 6.1968e-02, PNorm = 35.0166, GNorm = 1.1182, lr_0 = 4.1991e-04
Loss = 1.0762e-01, PNorm = 35.0283, GNorm = 2.9823, lr_0 = 4.0817e-04
Validation rmse = 0.134373
Epoch 23
Loss = 8.7698e-02, PNorm = 35.0416, GNorm = 2.1502, lr_0 = 3.9675e-04
Validation rmse = 0.129296
Epoch 24
Loss = 9.7482e-02, PNorm = 35.0535, GNorm = 3.8408, lr_0 = 3.8566e-04
Loss = 9.9847e-02, PNorm = 35.0659, GNorm = 3.6658, lr_0 = 3.7488e-04
Validation rmse = 0.136042
Epoch 25
Loss = 1.0658e-01, PNorm = 35.0775, GNorm = 0.7975, lr_0 = 3.6440e-04
Validation rmse = 0.129274
Epoch 26
Loss = 1.0561e-01, PNorm = 35.0918, GNorm = 2.4542, lr_0 = 3.5321e-04
Loss = 8.4567e-02, PNorm = 35.1025, GNorm = 2.3523, lr_0 = 3.4333e-04
Validation rmse = 0.131995
Epoch 27
Loss = 8.9107e-02, PNorm = 35.1117, GNorm = 1.0516, lr_0 = 3.3373e-04
Validation rmse = 0.127765
Epoch 28
Loss = 9.2383e-02, PNorm = 35.1223, GNorm = 0.8610, lr_0 = 3.2440e-04
Loss = 7.9273e-02, PNorm = 35.1319, GNorm = 0.9665, lr_0 = 3.1533e-04
Validation rmse = 0.125106
Epoch 29
Loss = 7.5853e-02, PNorm = 35.1415, GNorm = 1.3356, lr_0 = 3.0652e-04
Validation rmse = 0.133519
Epoch 30
Loss = 8.9074e-02, PNorm = 35.1502, GNorm = 1.9266, lr_0 = 2.9795e-04
Loss = 8.8364e-02, PNorm = 35.1613, GNorm = 1.5967, lr_0 = 2.8962e-04
Validation rmse = 0.131095
Epoch 31
Loss = 9.4854e-02, PNorm = 35.1700, GNorm = 1.0654, lr_0 = 2.8152e-04
Validation rmse = 0.135659
Epoch 32
Loss = 6.5122e-02, PNorm = 35.1788, GNorm = 2.4004, lr_0 = 2.7365e-04
Loss = 9.5920e-02, PNorm = 35.1862, GNorm = 1.9597, lr_0 = 2.6600e-04
Validation rmse = 0.128404
Epoch 33
Loss = 8.8430e-02, PNorm = 35.1949, GNorm = 0.9630, lr_0 = 2.5856e-04
Validation rmse = 0.127799
Epoch 34
Loss = 7.4002e-02, PNorm = 35.2029, GNorm = 0.8109, lr_0 = 2.5062e-04
Loss = 8.8715e-02, PNorm = 35.2094, GNorm = 3.7979, lr_0 = 2.4361e-04
Validation rmse = 0.129144
Epoch 35
Loss = 9.4030e-02, PNorm = 35.2179, GNorm = 3.2750, lr_0 = 2.3680e-04
Validation rmse = 0.126871
Epoch 36
Loss = 7.3151e-02, PNorm = 35.2245, GNorm = 0.5598, lr_0 = 2.3018e-04
Loss = 7.9690e-02, PNorm = 35.2319, GNorm = 0.6707, lr_0 = 2.2375e-04
Validation rmse = 0.125166
Epoch 37
Loss = 7.0914e-02, PNorm = 35.2386, GNorm = 1.2001, lr_0 = 2.1749e-04
Validation rmse = 0.125291
Epoch 38
Loss = 6.6142e-02, PNorm = 35.2439, GNorm = 1.3583, lr_0 = 2.1141e-04
Loss = 7.6627e-02, PNorm = 35.2493, GNorm = 1.0317, lr_0 = 2.0550e-04
Validation rmse = 0.125557
Epoch 39
Loss = 6.6500e-02, PNorm = 35.2552, GNorm = 0.5787, lr_0 = 1.9975e-04
Validation rmse = 0.126173
Epoch 40
Loss = 6.7602e-02, PNorm = 35.2610, GNorm = 0.8172, lr_0 = 1.9417e-04
Loss = 7.4660e-02, PNorm = 35.2666, GNorm = 0.6150, lr_0 = 1.8874e-04
Validation rmse = 0.125177
Epoch 41
Loss = 7.6729e-02, PNorm = 35.2719, GNorm = 1.6493, lr_0 = 1.8346e-04
Validation rmse = 0.125202
Epoch 42
Loss = 8.2241e-02, PNorm = 35.2784, GNorm = 0.5421, lr_0 = 1.7783e-04
Validation rmse = 0.124576
Epoch 43
Loss = 1.6888e-01, PNorm = 35.2834, GNorm = 0.8996, lr_0 = 1.7286e-04
Loss = 6.5412e-02, PNorm = 35.2890, GNorm = 1.8644, lr_0 = 1.6802e-04
Validation rmse = 0.128878
Epoch 44
Loss = 5.6636e-02, PNorm = 35.2927, GNorm = 2.3854, lr_0 = 1.6333e-04
Validation rmse = 0.125176
Epoch 45
Loss = 1.0328e-01, PNorm = 35.2974, GNorm = 2.1115, lr_0 = 1.5876e-04
Loss = 7.0245e-02, PNorm = 35.3024, GNorm = 1.2533, lr_0 = 1.5432e-04
Validation rmse = 0.126184
Epoch 46
Loss = 5.5446e-02, PNorm = 35.3069, GNorm = 2.8128, lr_0 = 1.5001e-04
Validation rmse = 0.126137
Epoch 47
Loss = 4.0828e-02, PNorm = 35.3119, GNorm = 0.4110, lr_0 = 1.4581e-04
Loss = 6.5880e-02, PNorm = 35.3158, GNorm = 1.0476, lr_0 = 1.4174e-04
Validation rmse = 0.123259
Epoch 48
Loss = 7.6829e-02, PNorm = 35.3204, GNorm = 1.3296, lr_0 = 1.3777e-04
Validation rmse = 0.125218
Epoch 49
Loss = 7.6995e-02, PNorm = 35.3247, GNorm = 0.9041, lr_0 = 1.3392e-04
Loss = 7.0295e-02, PNorm = 35.3290, GNorm = 0.4053, lr_0 = 1.3018e-04
Validation rmse = 0.125908
Epoch 50
Loss = 7.3841e-02, PNorm = 35.3328, GNorm = 1.7184, lr_0 = 1.2654e-04
Validation rmse = 0.122738
Epoch 51
Loss = 6.9655e-02, PNorm = 35.3369, GNorm = 0.5076, lr_0 = 1.2265e-04
Loss = 6.5019e-02, PNorm = 35.3404, GNorm = 0.6380, lr_0 = 1.1922e-04
Validation rmse = 0.124762
Epoch 52
Loss = 8.1255e-02, PNorm = 35.3441, GNorm = 1.5003, lr_0 = 1.1589e-04
Validation rmse = 0.124658
Epoch 53
Loss = 7.7594e-02, PNorm = 35.3469, GNorm = 0.5560, lr_0 = 1.1265e-04
Loss = 6.2149e-02, PNorm = 35.3499, GNorm = 0.5280, lr_0 = 1.0950e-04
Validation rmse = 0.123962
Epoch 54
Loss = 5.8629e-02, PNorm = 35.3530, GNorm = 2.0105, lr_0 = 1.0644e-04
Validation rmse = 0.124167
Epoch 55
Loss = 4.8153e-02, PNorm = 35.3558, GNorm = 0.6630, lr_0 = 1.0346e-04
Loss = 6.4075e-02, PNorm = 35.3591, GNorm = 1.4105, lr_0 = 1.0057e-04
Validation rmse = 0.127074
Epoch 56
Loss = 6.3268e-02, PNorm = 35.3618, GNorm = 0.6480, lr_0 = 1.0000e-04
Validation rmse = 0.125944
Epoch 57
Loss = 3.7309e-02, PNorm = 35.3648, GNorm = 0.9655, lr_0 = 1.0000e-04
Loss = 7.5474e-02, PNorm = 35.3680, GNorm = 0.4444, lr_0 = 1.0000e-04
Validation rmse = 0.125380
Epoch 58
Loss = 7.0613e-02, PNorm = 35.3701, GNorm = 2.1320, lr_0 = 1.0000e-04
Validation rmse = 0.124473
Epoch 59
Loss = 5.3229e-02, PNorm = 35.3737, GNorm = 0.6952, lr_0 = 1.0000e-04
Loss = 6.9769e-02, PNorm = 35.3766, GNorm = 0.6090, lr_0 = 1.0000e-04
Validation rmse = 0.131309
Model 0 best validation rmse = 0.122738 on epoch 50
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.174357
Ensemble test rmse = 0.174357
1-fold cross validation
	Seed 0 ==> test rmse = 0.174357
Overall test rmse = 0.174357 +/- 0.000000
Elapsed time = 0:00:28
Command line
python c:\Users\ignaczg\Anaconda3\envs\cuda-torch\lib\site-packages\ipykernel_launcher.py --ip=127.0.0.1 --stdin=9003 --control=9001 --hb=9000 --Session.signature_scheme="hmac-sha256" --Session.key=b"423dbce5-7a61-490b-8ba3-ec8e76446d9d" --shell=9002 --transport="tcp" --iopub=9004 --f=c:\Users\ignaczg\AppData\Roaming\jupyter\runtime\kernel-v2-1796aytiq9iWUQPM.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 927 | train size = 736 | val size = 186 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.2031e-01, PNorm = 34.0188, GNorm = 2.8685, lr_0 = 4.5357e-04
Validation rmse = 0.301165
Epoch 1
Loss = 6.6717e-01, PNorm = 34.0524, GNorm = 2.0310, lr_0 = 8.0714e-04
Validation rmse = 0.262517
Epoch 2
Loss = 5.9522e-01, PNorm = 34.1148, GNorm = 5.3167, lr_0 = 9.8872e-04
Loss = 4.1427e-01, PNorm = 34.1827, GNorm = 4.3643, lr_0 = 9.6108e-04
Validation rmse = 0.220876
Epoch 3
Loss = 3.4998e-01, PNorm = 34.2453, GNorm = 3.4282, lr_0 = 9.3421e-04
Validation rmse = 0.247979
Epoch 4
Loss = 3.4681e-01, PNorm = 34.3015, GNorm = 2.9137, lr_0 = 9.0552e-04
Loss = 3.6629e-01, PNorm = 34.3473, GNorm = 4.9278, lr_0 = 8.8020e-04
Validation rmse = 0.214273
Epoch 5
Loss = 2.5795e-01, PNorm = 34.4026, GNorm = 2.0723, lr_0 = 8.5559e-04
Validation rmse = 0.179865
Epoch 6
Loss = 1.8169e-01, PNorm = 34.4558, GNorm = 2.5920, lr_0 = 8.3167e-04
Loss = 2.2051e-01, PNorm = 34.4954, GNorm = 0.9693, lr_0 = 8.0842e-04
Validation rmse = 0.172213
Epoch 7
Loss = 2.2314e-01, PNorm = 34.5413, GNorm = 4.9392, lr_0 = 7.8581e-04
Validation rmse = 0.167158
Epoch 8
Loss = 1.5096e-01, PNorm = 34.5844, GNorm = 1.2539, lr_0 = 7.6168e-04
Loss = 1.6059e-01, PNorm = 34.6188, GNorm = 4.0038, lr_0 = 7.4039e-04
Validation rmse = 0.171459
Epoch 9
Loss = 1.6387e-01, PNorm = 34.6580, GNorm = 2.1231, lr_0 = 7.1969e-04
Validation rmse = 0.155652
Epoch 10
Loss = 1.3211e-01, PNorm = 34.6933, GNorm = 0.5882, lr_0 = 6.9956e-04
Loss = 1.2775e-01, PNorm = 34.7247, GNorm = 0.6680, lr_0 = 6.8001e-04
Validation rmse = 0.158404
Epoch 11
Loss = 1.3566e-01, PNorm = 34.7635, GNorm = 3.2804, lr_0 = 6.5912e-04
Validation rmse = 0.153074
Epoch 12
Loss = 1.0894e-01, PNorm = 34.7939, GNorm = 1.2774, lr_0 = 6.4069e-04
Loss = 1.2125e-01, PNorm = 34.8247, GNorm = 1.8041, lr_0 = 6.2278e-04
Validation rmse = 0.149018
Epoch 13
Loss = 9.3918e-02, PNorm = 34.8537, GNorm = 1.4662, lr_0 = 6.0537e-04
Validation rmse = 0.154671
Epoch 14
Loss = 9.8129e-02, PNorm = 34.8716, GNorm = 1.1375, lr_0 = 5.8844e-04
Loss = 1.0838e-01, PNorm = 34.8956, GNorm = 0.7538, lr_0 = 5.7199e-04
Loss = 7.9352e-02, PNorm = 34.8982, GNorm = 1.7992, lr_0 = 5.7037e-04
Validation rmse = 0.166836
Epoch 15
Loss = 1.1582e-01, PNorm = 34.9166, GNorm = 0.7262, lr_0 = 5.5442e-04
Validation rmse = 0.143614
Epoch 16
Loss = 1.0002e-01, PNorm = 34.9376, GNorm = 1.3167, lr_0 = 5.3892e-04
Loss = 9.2793e-02, PNorm = 34.9573, GNorm = 3.7809, lr_0 = 5.2386e-04
Validation rmse = 0.144246
Epoch 17
Loss = 9.4770e-02, PNorm = 34.9777, GNorm = 0.6861, lr_0 = 5.0921e-04
Validation rmse = 0.140116
Epoch 18
Loss = 7.8053e-02, PNorm = 34.9945, GNorm = 1.1063, lr_0 = 4.9357e-04
Validation rmse = 0.140099
Epoch 19
Loss = 5.5783e-02, PNorm = 35.0124, GNorm = 1.1799, lr_0 = 4.7977e-04
Loss = 8.3196e-02, PNorm = 35.0290, GNorm = 0.9505, lr_0 = 4.6636e-04
Validation rmse = 0.140681
Epoch 20
Loss = 8.1362e-02, PNorm = 35.0446, GNorm = 0.5988, lr_0 = 4.5332e-04
Validation rmse = 0.138093
Epoch 21
Loss = 4.9517e-02, PNorm = 35.0588, GNorm = 2.9241, lr_0 = 4.4064e-04
Loss = 7.6480e-02, PNorm = 35.0688, GNorm = 0.8208, lr_0 = 4.2832e-04
Validation rmse = 0.137396
Epoch 22
Loss = 6.4382e-02, PNorm = 35.0877, GNorm = 1.6600, lr_0 = 4.1517e-04
Validation rmse = 0.166768
Epoch 23
Loss = 1.0969e-01, PNorm = 35.1019, GNorm = 5.2744, lr_0 = 4.0356e-04
Loss = 1.0789e-01, PNorm = 35.1129, GNorm = 5.8949, lr_0 = 3.9228e-04
Validation rmse = 0.175700
Epoch 24
Loss = 1.1162e-01, PNorm = 35.1269, GNorm = 1.0647, lr_0 = 3.8131e-04
Validation rmse = 0.137291
Epoch 25
Loss = 7.5946e-02, PNorm = 35.1398, GNorm = 1.6428, lr_0 = 3.7065e-04
Loss = 7.6658e-02, PNorm = 35.1521, GNorm = 1.8493, lr_0 = 3.6029e-04
Validation rmse = 0.138463
Epoch 26
Loss = 6.7002e-02, PNorm = 35.1628, GNorm = 0.9751, lr_0 = 3.4922e-04
Validation rmse = 0.142175
Epoch 27
Loss = 7.3655e-02, PNorm = 35.1736, GNorm = 1.8982, lr_0 = 3.3946e-04
Loss = 7.3871e-02, PNorm = 35.1827, GNorm = 1.8096, lr_0 = 3.2997e-04
Validation rmse = 0.137265
Epoch 28
Loss = 6.6371e-02, PNorm = 35.1942, GNorm = 1.4840, lr_0 = 3.2074e-04
Validation rmse = 0.135688
Epoch 29
Loss = 6.1257e-02, PNorm = 35.2041, GNorm = 0.8704, lr_0 = 3.1089e-04
Loss = 7.1863e-02, PNorm = 35.2136, GNorm = 0.8819, lr_0 = 3.0220e-04
Validation rmse = 0.135790
Epoch 30
Loss = 7.0942e-02, PNorm = 35.2222, GNorm = 2.1807, lr_0 = 2.9375e-04
Validation rmse = 0.134963
Epoch 31
Loss = 7.4510e-02, PNorm = 35.2325, GNorm = 1.9284, lr_0 = 2.8554e-04
Loss = 6.7951e-02, PNorm = 35.2406, GNorm = 0.9633, lr_0 = 2.7756e-04
Validation rmse = 0.142976
Epoch 32
Loss = 7.5174e-02, PNorm = 35.2494, GNorm = 3.0472, lr_0 = 2.6980e-04
Validation rmse = 0.134336
Epoch 33
Loss = 6.1937e-02, PNorm = 35.2578, GNorm = 2.1067, lr_0 = 2.6151e-04
Loss = 6.6402e-02, PNorm = 35.2644, GNorm = 0.6864, lr_0 = 2.5420e-04
Validation rmse = 0.135245
Epoch 34
Loss = 5.9457e-02, PNorm = 35.2717, GNorm = 0.6784, lr_0 = 2.4709e-04
Validation rmse = 0.138012
Epoch 35
Loss = 7.1375e-02, PNorm = 35.2778, GNorm = 1.3435, lr_0 = 2.4018e-04
Validation rmse = 0.134048
Epoch 36
Loss = 4.0068e-02, PNorm = 35.2871, GNorm = 1.2788, lr_0 = 2.3281e-04
Loss = 5.8697e-02, PNorm = 35.2928, GNorm = 0.9115, lr_0 = 2.2630e-04
Validation rmse = 0.134274
Epoch 37
Loss = 6.4838e-02, PNorm = 35.3004, GNorm = 1.1043, lr_0 = 2.1997e-04
Validation rmse = 0.137687
Epoch 38
Loss = 4.8213e-02, PNorm = 35.3070, GNorm = 0.6415, lr_0 = 2.1382e-04
Loss = 6.0927e-02, PNorm = 35.3126, GNorm = 0.5080, lr_0 = 2.0784e-04
Validation rmse = 0.135899
Epoch 39
Loss = 5.6415e-02, PNorm = 35.3188, GNorm = 2.1810, lr_0 = 2.0203e-04
Validation rmse = 0.132518
Epoch 40
Loss = 5.9137e-02, PNorm = 35.3251, GNorm = 1.4208, lr_0 = 1.9583e-04
Loss = 5.8969e-02, PNorm = 35.3309, GNorm = 1.5090, lr_0 = 1.9035e-04
Validation rmse = 0.135315
Epoch 41
Loss = 5.6287e-02, PNorm = 35.3359, GNorm = 0.5926, lr_0 = 1.8503e-04
Validation rmse = 0.132903
Epoch 42
Loss = 5.0657e-02, PNorm = 35.3419, GNorm = 1.3325, lr_0 = 1.7986e-04
Loss = 5.9445e-02, PNorm = 35.3470, GNorm = 0.7483, lr_0 = 1.7483e-04
Validation rmse = 0.134387
Epoch 43
Loss = 5.5574e-02, PNorm = 35.3530, GNorm = 0.7812, lr_0 = 1.6946e-04
Validation rmse = 0.134118
Epoch 44
Loss = 8.6621e-02, PNorm = 35.3585, GNorm = 2.2499, lr_0 = 1.6472e-04
Loss = 5.4105e-02, PNorm = 35.3638, GNorm = 0.6978, lr_0 = 1.6012e-04
Validation rmse = 0.134209
Epoch 45
Loss = 5.2239e-02, PNorm = 35.3671, GNorm = 1.2490, lr_0 = 1.5564e-04
Validation rmse = 0.133936
Epoch 46
Loss = 5.9273e-02, PNorm = 35.3726, GNorm = 1.0409, lr_0 = 1.5129e-04
Loss = 5.8626e-02, PNorm = 35.3764, GNorm = 1.2998, lr_0 = 1.4706e-04
Validation rmse = 0.133168
Epoch 47
Loss = 6.1833e-02, PNorm = 35.3823, GNorm = 1.2112, lr_0 = 1.4254e-04
Validation rmse = 0.137261
Epoch 48
Loss = 5.0263e-02, PNorm = 35.3859, GNorm = 0.6662, lr_0 = 1.3856e-04
Loss = 6.2334e-02, PNorm = 35.3901, GNorm = 3.3645, lr_0 = 1.3468e-04
Validation rmse = 0.134175
Epoch 49
Loss = 5.9848e-02, PNorm = 35.3939, GNorm = 0.7158, lr_0 = 1.3092e-04
Validation rmse = 0.133384
Epoch 50
Loss = 4.7918e-02, PNorm = 35.3980, GNorm = 0.5657, lr_0 = 1.2726e-04
Loss = 5.9145e-02, PNorm = 35.4010, GNorm = 1.1046, lr_0 = 1.2370e-04
Loss = 3.4019e-02, PNorm = 35.4015, GNorm = 1.0875, lr_0 = 1.2335e-04
Validation rmse = 0.133664
Epoch 51
Loss = 5.4540e-02, PNorm = 35.4050, GNorm = 0.9226, lr_0 = 1.1990e-04
Validation rmse = 0.132829
Epoch 52
Loss = 4.4916e-02, PNorm = 35.4081, GNorm = 0.5698, lr_0 = 1.1655e-04
Loss = 5.9118e-02, PNorm = 35.4121, GNorm = 0.7400, lr_0 = 1.1329e-04
Validation rmse = 0.137451
Epoch 53
Loss = 5.6267e-02, PNorm = 35.4150, GNorm = 1.1841, lr_0 = 1.1012e-04
Validation rmse = 0.132890
Epoch 54
Loss = 6.0169e-02, PNorm = 35.4185, GNorm = 1.3242, lr_0 = 1.0674e-04
Validation rmse = 0.134215
Epoch 55
Loss = 5.0771e-02, PNorm = 35.4218, GNorm = 0.5794, lr_0 = 1.0376e-04
Loss = 5.2517e-02, PNorm = 35.4245, GNorm = 1.6219, lr_0 = 1.0085e-04
Validation rmse = 0.133386
Epoch 56
Loss = 4.5739e-02, PNorm = 35.4275, GNorm = 0.7037, lr_0 = 1.0000e-04
Validation rmse = 0.132728
Epoch 57
Loss = 3.7119e-02, PNorm = 35.4303, GNorm = 1.4514, lr_0 = 1.0000e-04
Loss = 5.2225e-02, PNorm = 35.4333, GNorm = 0.7396, lr_0 = 1.0000e-04
Validation rmse = 0.133461
Epoch 58
Loss = 5.0305e-02, PNorm = 35.4365, GNorm = 1.0173, lr_0 = 1.0000e-04
Validation rmse = 0.133449
Epoch 59
Loss = 6.0862e-02, PNorm = 35.4390, GNorm = 1.0062, lr_0 = 1.0000e-04
Loss = 5.3643e-02, PNorm = 35.4417, GNorm = 0.7073, lr_0 = 1.0000e-04
Validation rmse = 0.132331
Model 0 best validation rmse = 0.132331 on epoch 59
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.200385
Ensemble test rmse = 0.200385
1-fold cross validation
	Seed 0 ==> test rmse = 0.200385
Overall test rmse = 0.200385 +/- 0.000000
Elapsed time = 0:00:26
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,167 | train size = 927 | val size = 234 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.9265e-01, PNorm = 34.0157, GNorm = 3.5732, lr_0 = 3.7500e-04
Validation rmse = 0.284287
Epoch 1
Loss = 6.9237e-01, PNorm = 34.0439, GNorm = 6.4419, lr_0 = 6.5000e-04
Loss = 7.6370e-01, PNorm = 34.0834, GNorm = 3.2127, lr_0 = 9.0000e-04
Validation rmse = 0.276076
Epoch 2
Loss = 6.7314e-01, PNorm = 34.1345, GNorm = 9.5480, lr_0 = 9.8685e-04
Loss = 6.1951e-01, PNorm = 34.1978, GNorm = 5.0216, lr_0 = 9.6533e-04
Validation rmse = 0.269354
Epoch 3
Loss = 5.1256e-01, PNorm = 34.2687, GNorm = 3.1734, lr_0 = 9.4219e-04
Loss = 4.2735e-01, PNorm = 34.3313, GNorm = 0.9409, lr_0 = 9.2164e-04
Validation rmse = 0.220364
Epoch 4
Loss = 4.3210e-01, PNorm = 34.3851, GNorm = 1.2037, lr_0 = 9.0153e-04
Loss = 3.3622e-01, PNorm = 34.4427, GNorm = 1.5474, lr_0 = 8.8187e-04
Validation rmse = 0.203020
Epoch 5
Loss = 3.1870e-01, PNorm = 34.5017, GNorm = 3.5992, lr_0 = 8.6073e-04
Loss = 2.7305e-01, PNorm = 34.5562, GNorm = 1.2497, lr_0 = 8.4195e-04
Validation rmse = 0.193515
Epoch 6
Loss = 3.0355e-01, PNorm = 34.5922, GNorm = 3.1700, lr_0 = 8.2359e-04
Validation rmse = 0.206545
Epoch 7
Loss = 2.3960e-01, PNorm = 34.6342, GNorm = 3.4207, lr_0 = 8.0385e-04
Loss = 3.0215e-01, PNorm = 34.6717, GNorm = 4.1366, lr_0 = 7.8631e-04
Validation rmse = 0.182238
Epoch 8
Loss = 2.4078e-01, PNorm = 34.7032, GNorm = 3.7153, lr_0 = 7.6916e-04
Loss = 2.3669e-01, PNorm = 34.7340, GNorm = 2.4958, lr_0 = 7.5238e-04
Validation rmse = 0.191162
Epoch 9
Loss = 2.8968e-01, PNorm = 34.7677, GNorm = 2.7439, lr_0 = 7.3435e-04
Loss = 1.9993e-01, PNorm = 34.7959, GNorm = 1.7579, lr_0 = 7.1833e-04
Validation rmse = 0.180546
Epoch 10
Loss = 2.4687e-01, PNorm = 34.8143, GNorm = 6.3842, lr_0 = 7.0266e-04
Loss = 1.9371e-01, PNorm = 34.8345, GNorm = 1.6602, lr_0 = 6.8733e-04
Validation rmse = 0.183165
Epoch 11
Loss = 2.0455e-01, PNorm = 34.8629, GNorm = 3.0105, lr_0 = 6.7085e-04
Loss = 2.1758e-01, PNorm = 34.8796, GNorm = 4.0281, lr_0 = 6.5622e-04
Validation rmse = 0.186890
Epoch 12
Loss = 2.1724e-01, PNorm = 34.8925, GNorm = 3.4124, lr_0 = 6.4191e-04
Loss = 2.2759e-01, PNorm = 34.9130, GNorm = 5.5231, lr_0 = 6.2790e-04
Validation rmse = 0.203739
Epoch 13
Loss = 2.8424e-01, PNorm = 34.9357, GNorm = 5.4572, lr_0 = 6.1421e-04
Validation rmse = 0.177900
Epoch 14
Loss = 1.4119e-01, PNorm = 34.9542, GNorm = 0.9607, lr_0 = 5.9948e-04
Loss = 2.2155e-01, PNorm = 34.9701, GNorm = 2.7760, lr_0 = 5.8641e-04
Validation rmse = 0.182044
Epoch 15
Loss = 2.2371e-01, PNorm = 34.9882, GNorm = 1.3620, lr_0 = 5.7362e-04
Loss = 1.8238e-01, PNorm = 35.0097, GNorm = 0.8795, lr_0 = 5.6110e-04
Validation rmse = 0.177891
Epoch 16
Loss = 2.1464e-01, PNorm = 35.0259, GNorm = 4.4125, lr_0 = 5.4765e-04
Loss = 1.9529e-01, PNorm = 35.0416, GNorm = 2.5752, lr_0 = 5.3571e-04
Validation rmse = 0.170485
Epoch 17
Loss = 1.8825e-01, PNorm = 35.0576, GNorm = 0.6088, lr_0 = 5.2402e-04
Loss = 1.9695e-01, PNorm = 35.0724, GNorm = 1.7284, lr_0 = 5.1259e-04
Validation rmse = 0.175985
Epoch 18
Loss = 2.1384e-01, PNorm = 35.0874, GNorm = 3.6491, lr_0 = 5.0030e-04
Loss = 1.7374e-01, PNorm = 35.1027, GNorm = 1.4962, lr_0 = 4.8939e-04
Validation rmse = 0.171411
Epoch 19
Loss = 1.9818e-01, PNorm = 35.1154, GNorm = 4.3625, lr_0 = 4.7871e-04
Loss = 1.9132e-01, PNorm = 35.1269, GNorm = 2.0017, lr_0 = 4.6827e-04
Loss = 1.6335e-01, PNorm = 35.1279, GNorm = 3.0666, lr_0 = 4.6724e-04
Validation rmse = 0.173350
Epoch 20
Loss = 2.0294e-01, PNorm = 35.1398, GNorm = 3.0850, lr_0 = 4.5705e-04
Validation rmse = 0.169426
Epoch 21
Loss = 1.4987e-01, PNorm = 35.1527, GNorm = 0.6971, lr_0 = 4.4708e-04
Loss = 1.7988e-01, PNorm = 35.1619, GNorm = 0.8345, lr_0 = 4.3733e-04
Validation rmse = 0.174140
Epoch 22
Loss = 2.2097e-01, PNorm = 35.1764, GNorm = 1.6897, lr_0 = 4.2684e-04
Loss = 1.5986e-01, PNorm = 35.1856, GNorm = 2.2466, lr_0 = 4.1753e-04
Validation rmse = 0.170611
Epoch 23
Loss = 1.5527e-01, PNorm = 35.1991, GNorm = 0.6559, lr_0 = 4.0842e-04
Loss = 1.7499e-01, PNorm = 35.2091, GNorm = 0.6317, lr_0 = 3.9951e-04
Validation rmse = 0.175035
Epoch 24
Loss = 1.7325e-01, PNorm = 35.2203, GNorm = 2.7085, lr_0 = 3.8994e-04
Loss = 1.7153e-01, PNorm = 35.2320, GNorm = 1.2318, lr_0 = 3.8143e-04
Validation rmse = 0.172795
Epoch 25
Loss = 1.9892e-01, PNorm = 35.2421, GNorm = 1.4075, lr_0 = 3.7311e-04
Loss = 1.5469e-01, PNorm = 35.2527, GNorm = 2.4803, lr_0 = 3.6497e-04
Validation rmse = 0.172053
Epoch 26
Loss = 2.1047e-01, PNorm = 35.2622, GNorm = 3.6054, lr_0 = 3.5701e-04
Loss = 1.5560e-01, PNorm = 35.2744, GNorm = 2.5786, lr_0 = 3.4922e-04
Loss = 1.3988e-01, PNorm = 35.2756, GNorm = 1.7978, lr_0 = 3.4845e-04
Validation rmse = 0.178634
Epoch 27
Loss = 1.7607e-01, PNorm = 35.2855, GNorm = 2.9906, lr_0 = 3.4085e-04
Validation rmse = 0.172776
Epoch 28
Loss = 1.8998e-01, PNorm = 35.2935, GNorm = 2.0834, lr_0 = 3.3342e-04
Loss = 1.6332e-01, PNorm = 35.3019, GNorm = 3.0278, lr_0 = 3.2614e-04
Validation rmse = 0.180720
Epoch 29
Loss = 1.7909e-01, PNorm = 35.3110, GNorm = 2.1075, lr_0 = 3.1833e-04
Loss = 1.6987e-01, PNorm = 35.3219, GNorm = 2.3755, lr_0 = 3.1138e-04
Validation rmse = 0.176680
Epoch 30
Loss = 1.5499e-01, PNorm = 35.3306, GNorm = 0.8993, lr_0 = 3.0459e-04
Loss = 1.8435e-01, PNorm = 35.3368, GNorm = 1.6340, lr_0 = 2.9795e-04
Validation rmse = 0.173879
Epoch 31
Loss = 1.7567e-01, PNorm = 35.3495, GNorm = 1.8644, lr_0 = 2.9080e-04
Loss = 1.7797e-01, PNorm = 35.3566, GNorm = 1.1090, lr_0 = 2.8446e-04
Validation rmse = 0.174446
Epoch 32
Loss = 1.5477e-01, PNorm = 35.3643, GNorm = 3.2304, lr_0 = 2.7826e-04
Loss = 1.6955e-01, PNorm = 35.3716, GNorm = 0.7852, lr_0 = 2.7219e-04
Validation rmse = 0.173272
Epoch 33
Loss = 1.6873e-01, PNorm = 35.3808, GNorm = 1.7803, lr_0 = 2.6566e-04
Loss = 1.5100e-01, PNorm = 35.3884, GNorm = 0.8952, lr_0 = 2.5987e-04
Validation rmse = 0.171383
Epoch 34
Loss = 1.5573e-01, PNorm = 35.3968, GNorm = 1.2909, lr_0 = 2.5420e-04
Validation rmse = 0.169236
Epoch 35
Loss = 1.4815e-01, PNorm = 35.4032, GNorm = 1.6272, lr_0 = 2.4811e-04
Loss = 1.5965e-01, PNorm = 35.4105, GNorm = 2.2628, lr_0 = 2.4269e-04
Validation rmse = 0.172553
Epoch 36
Loss = 1.7006e-01, PNorm = 35.4174, GNorm = 1.9020, lr_0 = 2.3740e-04
Loss = 1.6072e-01, PNorm = 35.4230, GNorm = 1.4515, lr_0 = 2.3222e-04
Validation rmse = 0.174826
Epoch 37
Loss = 1.8823e-01, PNorm = 35.4314, GNorm = 5.1783, lr_0 = 2.2665e-04
Loss = 1.5313e-01, PNorm = 35.4391, GNorm = 2.1313, lr_0 = 2.2171e-04
Validation rmse = 0.169612
Epoch 38
Loss = 1.2579e-01, PNorm = 35.4448, GNorm = 1.4407, lr_0 = 2.1687e-04
Loss = 1.6409e-01, PNorm = 35.4514, GNorm = 2.0354, lr_0 = 2.1214e-04
Validation rmse = 0.174531
Epoch 39
Loss = 1.7109e-01, PNorm = 35.4585, GNorm = 2.4764, lr_0 = 2.0752e-04
Loss = 1.5848e-01, PNorm = 35.4649, GNorm = 1.0043, lr_0 = 2.0299e-04
Validation rmse = 0.169893
Epoch 40
Loss = 1.4739e-01, PNorm = 35.4710, GNorm = 3.3244, lr_0 = 1.9812e-04
Loss = 1.5366e-01, PNorm = 35.4762, GNorm = 3.5808, lr_0 = 1.9380e-04
Validation rmse = 0.171062
Epoch 41
Loss = 1.6684e-01, PNorm = 35.4808, GNorm = 2.5237, lr_0 = 1.8957e-04
Validation rmse = 0.170202
Epoch 42
Loss = 1.5650e-01, PNorm = 35.4884, GNorm = 1.3244, lr_0 = 1.8503e-04
Loss = 1.2514e-01, PNorm = 35.4936, GNorm = 1.4644, lr_0 = 1.8099e-04
Validation rmse = 0.166673
Epoch 43
Loss = 1.3587e-01, PNorm = 35.4988, GNorm = 1.2210, lr_0 = 1.7705e-04
Loss = 1.6548e-01, PNorm = 35.5059, GNorm = 1.6450, lr_0 = 1.7318e-04
Validation rmse = 0.171903
Epoch 44
Loss = 1.5771e-01, PNorm = 35.5116, GNorm = 1.4774, lr_0 = 1.6903e-04
Loss = 1.5412e-01, PNorm = 35.5165, GNorm = 1.9860, lr_0 = 1.6534e-04
Validation rmse = 0.175227
Epoch 45
Loss = 1.5600e-01, PNorm = 35.5213, GNorm = 2.3081, lr_0 = 1.6174e-04
Loss = 1.4099e-01, PNorm = 35.5256, GNorm = 2.0332, lr_0 = 1.5821e-04
Validation rmse = 0.168114
Epoch 46
Loss = 1.6001e-01, PNorm = 35.5311, GNorm = 1.5949, lr_0 = 1.5442e-04
Loss = 1.3666e-01, PNorm = 35.5358, GNorm = 0.6570, lr_0 = 1.5105e-04
Validation rmse = 0.171536
Epoch 47
Loss = 1.5533e-01, PNorm = 35.5420, GNorm = 0.9230, lr_0 = 1.4775e-04
Validation rmse = 0.168412
Epoch 48
Loss = 1.0025e-01, PNorm = 35.5471, GNorm = 0.7586, lr_0 = 1.4421e-04
Loss = 1.4819e-01, PNorm = 35.5509, GNorm = 0.9936, lr_0 = 1.4107e-04
Validation rmse = 0.168112
Epoch 49
Loss = 1.3042e-01, PNorm = 35.5544, GNorm = 1.4533, lr_0 = 1.3799e-04
Loss = 1.3450e-01, PNorm = 35.5590, GNorm = 0.9610, lr_0 = 1.3498e-04
Validation rmse = 0.169658
Epoch 50
Loss = 1.5290e-01, PNorm = 35.5637, GNorm = 1.9782, lr_0 = 1.3204e-04
Loss = 1.4919e-01, PNorm = 35.5685, GNorm = 0.9589, lr_0 = 1.2915e-04
Validation rmse = 0.166343
Epoch 51
Loss = 1.4657e-01, PNorm = 35.5721, GNorm = 1.7425, lr_0 = 1.2606e-04
Loss = 1.4245e-01, PNorm = 35.5760, GNorm = 0.9267, lr_0 = 1.2331e-04
Validation rmse = 0.167588
Epoch 52
Loss = 1.5932e-01, PNorm = 35.5795, GNorm = 0.9982, lr_0 = 1.2062e-04
Loss = 1.3571e-01, PNorm = 35.5840, GNorm = 2.7909, lr_0 = 1.1799e-04
Validation rmse = 0.169367
Epoch 53
Loss = 1.4665e-01, PNorm = 35.5880, GNorm = 2.0748, lr_0 = 1.1516e-04
Loss = 1.3260e-01, PNorm = 35.5912, GNorm = 1.3082, lr_0 = 1.1265e-04
Validation rmse = 0.168253
Epoch 54
Loss = 1.4721e-01, PNorm = 35.5945, GNorm = 1.2773, lr_0 = 1.1019e-04
Validation rmse = 0.166900
Epoch 55
Loss = 1.2795e-01, PNorm = 35.5986, GNorm = 0.9504, lr_0 = 1.0755e-04
Loss = 1.3542e-01, PNorm = 35.6017, GNorm = 2.1672, lr_0 = 1.0520e-04
Validation rmse = 0.173300
Epoch 56
Loss = 1.2818e-01, PNorm = 35.6044, GNorm = 1.1656, lr_0 = 1.0291e-04
Loss = 1.4070e-01, PNorm = 35.6083, GNorm = 1.5796, lr_0 = 1.0066e-04
Validation rmse = 0.168427
Epoch 57
Loss = 1.2905e-01, PNorm = 35.6126, GNorm = 0.6530, lr_0 = 1.0000e-04
Loss = 1.3634e-01, PNorm = 35.6154, GNorm = 1.1728, lr_0 = 1.0000e-04
Validation rmse = 0.169790
Epoch 58
Loss = 1.2176e-01, PNorm = 35.6186, GNorm = 0.9124, lr_0 = 1.0000e-04
Loss = 1.3292e-01, PNorm = 35.6212, GNorm = 1.6242, lr_0 = 1.0000e-04
Validation rmse = 0.168781
Epoch 59
Loss = 1.3544e-01, PNorm = 35.6254, GNorm = 1.7121, lr_0 = 1.0000e-04
Loss = 1.4507e-01, PNorm = 35.6292, GNorm = 1.4185, lr_0 = 1.0000e-04
Validation rmse = 0.167931
Model 0 best validation rmse = 0.166343 on epoch 50
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.256371
Ensemble test rmse = 0.256371
1-fold cross validation
	Seed 0 ==> test rmse = 0.256371
Overall test rmse = 0.256371 +/- 0.000000
Elapsed time = 0:00:47
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,157 | train size = 919 | val size = 232 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.0768e-01, PNorm = 34.0154, GNorm = 5.4822, lr_0 = 3.7500e-04
Validation rmse = 0.312220
Epoch 1
Loss = 7.5548e-01, PNorm = 34.0345, GNorm = 1.4126, lr_0 = 6.5000e-04
Loss = 6.9102e-01, PNorm = 34.0691, GNorm = 1.5806, lr_0 = 9.0000e-04
Validation rmse = 0.261002
Epoch 2
Loss = 5.6428e-01, PNorm = 34.1438, GNorm = 1.5207, lr_0 = 9.8468e-04
Loss = 5.3623e-01, PNorm = 34.2121, GNorm = 2.1069, lr_0 = 9.6320e-04
Validation rmse = 0.250141
Epoch 3
Loss = 4.6804e-01, PNorm = 34.2752, GNorm = 4.9584, lr_0 = 9.4219e-04
Loss = 4.6067e-01, PNorm = 34.3279, GNorm = 4.5014, lr_0 = 9.2164e-04
Validation rmse = 0.209556
Epoch 4
Loss = 3.5642e-01, PNorm = 34.3904, GNorm = 1.5527, lr_0 = 8.9955e-04
Loss = 3.5709e-01, PNorm = 34.4416, GNorm = 0.7593, lr_0 = 8.7992e-04
Validation rmse = 0.183596
Epoch 5
Loss = 3.2325e-01, PNorm = 34.5053, GNorm = 4.5062, lr_0 = 8.5883e-04
Loss = 2.8468e-01, PNorm = 34.5493, GNorm = 5.9695, lr_0 = 8.4010e-04
Validation rmse = 0.178034
Epoch 6
Loss = 2.6342e-01, PNorm = 34.5994, GNorm = 2.6989, lr_0 = 8.2177e-04
Validation rmse = 0.174210
Epoch 7
Loss = 2.1226e-01, PNorm = 34.6484, GNorm = 0.8130, lr_0 = 8.0207e-04
Loss = 2.1038e-01, PNorm = 34.6861, GNorm = 3.9629, lr_0 = 7.8458e-04
Validation rmse = 0.161557
Epoch 8
Loss = 2.2571e-01, PNorm = 34.7238, GNorm = 6.4522, lr_0 = 7.6746e-04
Loss = 2.0599e-01, PNorm = 34.7577, GNorm = 0.8096, lr_0 = 7.5072e-04
Validation rmse = 0.160682
Epoch 9
Loss = 2.1588e-01, PNorm = 34.7931, GNorm = 1.1573, lr_0 = 7.3273e-04
Loss = 2.0642e-01, PNorm = 34.8281, GNorm = 4.8842, lr_0 = 7.1674e-04
Validation rmse = 0.171869
Epoch 10
Loss = 2.2106e-01, PNorm = 34.8549, GNorm = 3.1532, lr_0 = 6.9956e-04
Loss = 2.1030e-01, PNorm = 34.8796, GNorm = 3.0689, lr_0 = 6.8430e-04
Validation rmse = 0.163503
Epoch 11
Loss = 2.1189e-01, PNorm = 34.9042, GNorm = 1.4757, lr_0 = 6.6938e-04
Loss = 2.1098e-01, PNorm = 34.9290, GNorm = 1.9694, lr_0 = 6.5477e-04
Loss = 1.1295e-01, PNorm = 34.9314, GNorm = 1.6980, lr_0 = 6.5333e-04
Validation rmse = 0.163398
Epoch 12
Loss = 2.0480e-01, PNorm = 34.9567, GNorm = 2.4670, lr_0 = 6.3908e-04
Validation rmse = 0.158670
Epoch 13
Loss = 1.6090e-01, PNorm = 34.9812, GNorm = 1.6362, lr_0 = 6.2376e-04
Loss = 1.6309e-01, PNorm = 35.0041, GNorm = 1.6705, lr_0 = 6.1016e-04
Validation rmse = 0.162389
Epoch 14
Loss = 2.1833e-01, PNorm = 35.0164, GNorm = 2.5703, lr_0 = 5.9685e-04
Loss = 1.9954e-01, PNorm = 35.0360, GNorm = 1.4889, lr_0 = 5.8383e-04
Validation rmse = 0.157705
Epoch 15
Loss = 1.5373e-01, PNorm = 35.0495, GNorm = 1.1830, lr_0 = 5.6983e-04
Loss = 1.7407e-01, PNorm = 35.0684, GNorm = 3.6277, lr_0 = 5.5740e-04
Validation rmse = 0.160941
Epoch 16
Loss = 1.8895e-01, PNorm = 35.0860, GNorm = 1.7690, lr_0 = 5.4524e-04
Loss = 1.6481e-01, PNorm = 35.1022, GNorm = 2.5677, lr_0 = 5.3335e-04
Validation rmse = 0.156010
Epoch 17
Loss = 1.5969e-01, PNorm = 35.1169, GNorm = 0.9255, lr_0 = 5.2057e-04
Loss = 1.7212e-01, PNorm = 35.1315, GNorm = 2.1431, lr_0 = 5.0921e-04
Loss = 2.0544e-01, PNorm = 35.1332, GNorm = 1.0974, lr_0 = 5.0809e-04
Validation rmse = 0.162206
Epoch 18
Loss = 1.4656e-01, PNorm = 35.1494, GNorm = 0.7182, lr_0 = 4.9700e-04
Validation rmse = 0.157308
Epoch 19
Loss = 1.5303e-01, PNorm = 35.1664, GNorm = 0.6943, lr_0 = 4.8616e-04
Loss = 1.4571e-01, PNorm = 35.1777, GNorm = 0.8286, lr_0 = 4.7556e-04
Validation rmse = 0.159797
Epoch 20
Loss = 1.4841e-01, PNorm = 35.1923, GNorm = 1.7902, lr_0 = 4.6416e-04
Loss = 1.6989e-01, PNorm = 35.2103, GNorm = 1.4417, lr_0 = 4.5403e-04
Validation rmse = 0.170011
Epoch 21
Loss = 1.6420e-01, PNorm = 35.2235, GNorm = 1.1419, lr_0 = 4.4315e-04
Loss = 1.6578e-01, PNorm = 35.2387, GNorm = 1.6993, lr_0 = 4.3348e-04
Validation rmse = 0.164587
Epoch 22
Loss = 1.5547e-01, PNorm = 35.2496, GNorm = 1.3313, lr_0 = 4.2403e-04
Loss = 1.4421e-01, PNorm = 35.2629, GNorm = 0.7860, lr_0 = 4.1478e-04
Validation rmse = 0.173219
Epoch 23
Loss = 1.6935e-01, PNorm = 35.2769, GNorm = 1.8801, lr_0 = 4.0484e-04
Loss = 1.5521e-01, PNorm = 35.2892, GNorm = 1.7459, lr_0 = 3.9601e-04
Validation rmse = 0.168429
Epoch 24
Loss = 1.5960e-01, PNorm = 35.3009, GNorm = 3.5930, lr_0 = 3.8737e-04
Validation rmse = 0.155130
Epoch 25
Loss = 1.4392e-01, PNorm = 35.3145, GNorm = 1.0575, lr_0 = 3.7808e-04
Loss = 1.5869e-01, PNorm = 35.3280, GNorm = 5.6465, lr_0 = 3.6983e-04
Validation rmse = 0.155931
Epoch 26
Loss = 1.3519e-01, PNorm = 35.3397, GNorm = 1.1316, lr_0 = 3.6097e-04
Loss = 1.4356e-01, PNorm = 35.3530, GNorm = 1.4487, lr_0 = 3.5310e-04
Validation rmse = 0.162192
Epoch 27
Loss = 1.1125e-01, PNorm = 35.3643, GNorm = 0.4256, lr_0 = 3.4539e-04
Loss = 1.3722e-01, PNorm = 35.3706, GNorm = 1.7145, lr_0 = 3.3786e-04
Validation rmse = 0.158389
Epoch 28
Loss = 1.3874e-01, PNorm = 35.3839, GNorm = 1.0626, lr_0 = 3.2976e-04
Loss = 1.4568e-01, PNorm = 35.3964, GNorm = 1.9725, lr_0 = 3.2257e-04
Validation rmse = 0.158308
Epoch 29
Loss = 1.5427e-01, PNorm = 35.4061, GNorm = 3.0958, lr_0 = 3.1553e-04
Loss = 1.3572e-01, PNorm = 35.4185, GNorm = 3.8220, lr_0 = 3.0865e-04
Validation rmse = 0.155945
Epoch 30
Loss = 1.1121e-01, PNorm = 35.4270, GNorm = 1.0756, lr_0 = 3.0125e-04
Validation rmse = 0.159445
Epoch 31
Loss = 1.1809e-01, PNorm = 35.4390, GNorm = 2.6236, lr_0 = 2.9403e-04
Loss = 1.3896e-01, PNorm = 35.4461, GNorm = 0.9268, lr_0 = 2.8762e-04
Validation rmse = 0.157810
Epoch 32
Loss = 1.3856e-01, PNorm = 35.4549, GNorm = 2.6042, lr_0 = 2.8134e-04
Loss = 1.5496e-01, PNorm = 35.4655, GNorm = 4.3866, lr_0 = 2.7520e-04
Validation rmse = 0.156849
Epoch 33
Loss = 1.4823e-01, PNorm = 35.4758, GNorm = 4.3917, lr_0 = 2.6861e-04
Loss = 1.3873e-01, PNorm = 35.4848, GNorm = 1.2892, lr_0 = 2.6275e-04
Validation rmse = 0.183299
Epoch 34
Loss = 1.5304e-01, PNorm = 35.4934, GNorm = 2.6496, lr_0 = 2.5645e-04
Loss = 1.3782e-01, PNorm = 35.5030, GNorm = 0.5869, lr_0 = 2.5086e-04
Validation rmse = 0.155614
Epoch 35
Loss = 1.1806e-01, PNorm = 35.5099, GNorm = 0.6573, lr_0 = 2.4538e-04
Loss = 1.3113e-01, PNorm = 35.5173, GNorm = 0.8793, lr_0 = 2.4003e-04
Validation rmse = 0.155904
Epoch 36
Loss = 1.3474e-01, PNorm = 35.5301, GNorm = 4.3032, lr_0 = 2.3428e-04
Loss = 1.2759e-01, PNorm = 35.5378, GNorm = 0.5058, lr_0 = 2.2917e-04
Validation rmse = 0.158556
Epoch 37
Loss = 1.2663e-01, PNorm = 35.5456, GNorm = 0.6350, lr_0 = 2.2417e-04
Validation rmse = 0.158259
Epoch 38
Loss = 1.3757e-01, PNorm = 35.5556, GNorm = 1.9224, lr_0 = 2.1880e-04
Loss = 1.3985e-01, PNorm = 35.5624, GNorm = 0.9907, lr_0 = 2.1402e-04
Validation rmse = 0.161167
Epoch 39
Loss = 1.1846e-01, PNorm = 35.5709, GNorm = 0.7106, lr_0 = 2.0889e-04
Loss = 1.1801e-01, PNorm = 35.5777, GNorm = 1.7005, lr_0 = 2.0434e-04
Validation rmse = 0.168030
Epoch 40
Loss = 1.4103e-01, PNorm = 35.5852, GNorm = 1.0909, lr_0 = 1.9988e-04
Loss = 1.2513e-01, PNorm = 35.5926, GNorm = 1.3157, lr_0 = 1.9552e-04
Validation rmse = 0.154176
Epoch 41
Loss = 1.2050e-01, PNorm = 35.6003, GNorm = 1.3894, lr_0 = 1.9083e-04
Loss = 1.2311e-01, PNorm = 35.6060, GNorm = 1.5472, lr_0 = 1.8667e-04
Validation rmse = 0.156085
Epoch 42
Loss = 1.2973e-01, PNorm = 35.6123, GNorm = 1.1537, lr_0 = 1.8219e-04
Loss = 1.0609e-01, PNorm = 35.6193, GNorm = 1.1563, lr_0 = 1.7822e-04
Validation rmse = 0.160833
Epoch 43
Loss = 1.1239e-01, PNorm = 35.6248, GNorm = 0.8627, lr_0 = 1.7433e-04
Validation rmse = 0.162137
Epoch 44
Loss = 1.4919e-01, PNorm = 35.6308, GNorm = 0.5847, lr_0 = 1.7015e-04
Loss = 1.1819e-01, PNorm = 35.6391, GNorm = 1.7028, lr_0 = 1.6644e-04
Validation rmse = 0.154717
Epoch 45
Loss = 9.7734e-02, PNorm = 35.6439, GNorm = 0.5584, lr_0 = 1.6281e-04
Loss = 1.1003e-01, PNorm = 35.6480, GNorm = 2.6850, lr_0 = 1.5926e-04
Validation rmse = 0.163646
Epoch 46
Loss = 1.0444e-01, PNorm = 35.6539, GNorm = 0.8830, lr_0 = 1.5544e-04
Loss = 1.2358e-01, PNorm = 35.6599, GNorm = 2.5490, lr_0 = 1.5205e-04
Validation rmse = 0.154766
Epoch 47
Loss = 1.1053e-01, PNorm = 35.6653, GNorm = 1.0536, lr_0 = 1.4841e-04
Loss = 1.1609e-01, PNorm = 35.6695, GNorm = 1.0372, lr_0 = 1.4517e-04
Validation rmse = 0.154652
Epoch 48
Loss = 1.1760e-01, PNorm = 35.6760, GNorm = 0.9803, lr_0 = 1.4200e-04
Loss = 1.0956e-01, PNorm = 35.6804, GNorm = 0.6611, lr_0 = 1.3891e-04
Loss = 1.3702e-01, PNorm = 35.6810, GNorm = 2.0874, lr_0 = 1.3860e-04
Validation rmse = 0.157634
Epoch 49
Loss = 1.1646e-01, PNorm = 35.6857, GNorm = 1.5160, lr_0 = 1.3558e-04
Validation rmse = 0.160026
Epoch 50
Loss = 1.1311e-01, PNorm = 35.6906, GNorm = 0.7852, lr_0 = 1.3262e-04
Loss = 1.0529e-01, PNorm = 35.6941, GNorm = 1.0610, lr_0 = 1.2973e-04
Validation rmse = 0.157102
Epoch 51
Loss = 9.4030e-02, PNorm = 35.6997, GNorm = 0.6518, lr_0 = 1.2662e-04
Loss = 1.0671e-01, PNorm = 35.7059, GNorm = 1.5968, lr_0 = 1.2385e-04
Validation rmse = 0.157424
Epoch 52
Loss = 1.1569e-01, PNorm = 35.7094, GNorm = 0.9264, lr_0 = 1.2089e-04
Loss = 1.1076e-01, PNorm = 35.7136, GNorm = 1.0179, lr_0 = 1.1825e-04
Validation rmse = 0.155566
Epoch 53
Loss = 1.2200e-01, PNorm = 35.7185, GNorm = 0.7944, lr_0 = 1.1567e-04
Loss = 9.8163e-02, PNorm = 35.7235, GNorm = 1.1906, lr_0 = 1.1315e-04
Validation rmse = 0.156688
Epoch 54
Loss = 1.1170e-01, PNorm = 35.7261, GNorm = 0.7443, lr_0 = 1.1043e-04
Loss = 1.0871e-01, PNorm = 35.7308, GNorm = 1.6181, lr_0 = 1.0803e-04
Loss = 1.4646e-01, PNorm = 35.7313, GNorm = 2.5524, lr_0 = 1.0779e-04
Validation rmse = 0.157179
Epoch 55
Loss = 1.0634e-01, PNorm = 35.7351, GNorm = 1.2878, lr_0 = 1.0544e-04
Validation rmse = 0.157044
Epoch 56
Loss = 1.4421e-01, PNorm = 35.7387, GNorm = 1.3483, lr_0 = 1.0314e-04
Loss = 1.1194e-01, PNorm = 35.7426, GNorm = 2.1789, lr_0 = 1.0089e-04
Validation rmse = 0.161305
Epoch 57
Loss = 1.2893e-01, PNorm = 35.7465, GNorm = 1.3933, lr_0 = 1.0000e-04
Loss = 1.0991e-01, PNorm = 35.7508, GNorm = 1.0693, lr_0 = 1.0000e-04
Validation rmse = 0.156554
Epoch 58
Loss = 1.1690e-01, PNorm = 35.7545, GNorm = 1.0374, lr_0 = 1.0000e-04
Loss = 1.0286e-01, PNorm = 35.7578, GNorm = 0.9414, lr_0 = 1.0000e-04
Validation rmse = 0.156314
Epoch 59
Loss = 9.1940e-02, PNorm = 35.7614, GNorm = 2.3447, lr_0 = 1.0000e-04
Loss = 1.1204e-01, PNorm = 35.7645, GNorm = 0.8358, lr_0 = 1.0000e-04
Validation rmse = 0.154686
Model 0 best validation rmse = 0.154176 on epoch 40
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.146681
Ensemble test rmse = 0.146681
1-fold cross validation
	Seed 0 ==> test rmse = 0.146681
Overall test rmse = 0.146681 +/- 0.000000
Elapsed time = 0:00:44
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,147 | train size = 911 | val size = 230 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1589e-01, PNorm = 34.0154, GNorm = 2.1870, lr_0 = 3.7500e-04
Validation rmse = 0.287701
Epoch 1
Loss = 5.8001e-01, PNorm = 34.0429, GNorm = 0.8128, lr_0 = 6.5000e-04
Loss = 6.7201e-01, PNorm = 34.0871, GNorm = 2.1713, lr_0 = 9.0000e-04
Validation rmse = 0.234150
Epoch 2
Loss = 5.2647e-01, PNorm = 34.1595, GNorm = 9.4825, lr_0 = 9.8468e-04
Loss = 4.7228e-01, PNorm = 34.2327, GNorm = 3.3047, lr_0 = 9.6320e-04
Validation rmse = 0.232231
Epoch 3
Loss = 4.4274e-01, PNorm = 34.2983, GNorm = 1.3649, lr_0 = 9.4011e-04
Loss = 4.0442e-01, PNorm = 34.3501, GNorm = 5.1955, lr_0 = 9.1961e-04
Validation rmse = 0.211457
Epoch 4
Loss = 3.4413e-01, PNorm = 34.4126, GNorm = 4.1643, lr_0 = 8.9756e-04
Loss = 2.7787e-01, PNorm = 34.4628, GNorm = 2.4555, lr_0 = 8.7798e-04
Validation rmse = 0.187909
Epoch 5
Loss = 2.7076e-01, PNorm = 34.5085, GNorm = 2.5921, lr_0 = 8.5883e-04
Validation rmse = 0.204963
Epoch 6
Loss = 2.5259e-01, PNorm = 34.5500, GNorm = 5.6318, lr_0 = 8.3825e-04
Loss = 2.4279e-01, PNorm = 34.5886, GNorm = 0.8013, lr_0 = 8.1996e-04
Validation rmse = 0.187389
Epoch 7
Loss = 2.0961e-01, PNorm = 34.6279, GNorm = 3.8389, lr_0 = 8.0031e-04
Loss = 2.1672e-01, PNorm = 34.6611, GNorm = 4.4614, lr_0 = 7.8285e-04
Validation rmse = 0.168146
Epoch 8
Loss = 2.1574e-01, PNorm = 34.6984, GNorm = 2.7946, lr_0 = 7.6409e-04
Loss = 1.9510e-01, PNorm = 34.7332, GNorm = 1.9483, lr_0 = 7.4742e-04
Validation rmse = 0.180797
Epoch 9
Loss = 2.4520e-01, PNorm = 34.7663, GNorm = 4.7250, lr_0 = 7.2950e-04
Loss = 2.7101e-01, PNorm = 34.7972, GNorm = 3.7376, lr_0 = 7.1359e-04
Validation rmse = 0.243130
Epoch 10
Loss = 3.2899e-01, PNorm = 34.8324, GNorm = 2.5973, lr_0 = 6.9802e-04
Loss = 2.0397e-01, PNorm = 34.8600, GNorm = 1.0157, lr_0 = 6.8280e-04
Loss = 2.0291e-01, PNorm = 34.8618, GNorm = 1.3696, lr_0 = 6.8129e-04
Validation rmse = 0.170797
Epoch 11
Loss = 1.8750e-01, PNorm = 34.8836, GNorm = 1.8581, lr_0 = 6.6643e-04
Validation rmse = 0.157821
Epoch 12
Loss = 1.5322e-01, PNorm = 34.9088, GNorm = 0.5393, lr_0 = 6.5046e-04
Loss = 1.8112e-01, PNorm = 34.9300, GNorm = 3.9575, lr_0 = 6.3627e-04
Validation rmse = 0.172680
Epoch 13
Loss = 1.4671e-01, PNorm = 34.9531, GNorm = 1.1051, lr_0 = 6.2102e-04
Loss = 1.6556e-01, PNorm = 34.9676, GNorm = 4.3523, lr_0 = 6.0747e-04
Validation rmse = 0.171666
Epoch 14
Loss = 1.7800e-01, PNorm = 34.9904, GNorm = 1.1151, lr_0 = 5.9422e-04
Loss = 1.6263e-01, PNorm = 35.0095, GNorm = 2.4273, lr_0 = 5.8126e-04
Validation rmse = 0.187544
Epoch 15
Loss = 1.9798e-01, PNorm = 35.0274, GNorm = 3.5771, lr_0 = 5.6732e-04
Loss = 1.5772e-01, PNorm = 35.0456, GNorm = 1.1927, lr_0 = 5.5495e-04
Validation rmse = 0.152886
Epoch 16
Loss = 1.5029e-01, PNorm = 35.0623, GNorm = 1.8123, lr_0 = 5.4165e-04
Validation rmse = 0.165920
Epoch 17
Loss = 1.5170e-01, PNorm = 35.0792, GNorm = 0.9600, lr_0 = 5.2866e-04
Loss = 1.6911e-01, PNorm = 35.0895, GNorm = 2.6016, lr_0 = 5.1713e-04
Validation rmse = 0.162207
Epoch 18
Loss = 1.4622e-01, PNorm = 35.1034, GNorm = 0.7687, lr_0 = 5.0474e-04
Loss = 1.5972e-01, PNorm = 35.1214, GNorm = 3.1099, lr_0 = 4.9373e-04
Validation rmse = 0.149507
Epoch 19
Loss = 1.4906e-01, PNorm = 35.1328, GNorm = 0.9368, lr_0 = 4.8296e-04
Loss = 1.3951e-01, PNorm = 35.1526, GNorm = 0.9158, lr_0 = 4.7242e-04
Validation rmse = 0.157117
Epoch 20
Loss = 1.3452e-01, PNorm = 35.1605, GNorm = 1.5412, lr_0 = 4.6110e-04
Loss = 1.4604e-01, PNorm = 35.1711, GNorm = 4.9647, lr_0 = 4.5104e-04
Validation rmse = 0.174750
Epoch 21
Loss = 1.4414e-01, PNorm = 35.1873, GNorm = 0.8105, lr_0 = 4.4023e-04
Loss = 1.3674e-01, PNorm = 35.2008, GNorm = 1.0509, lr_0 = 4.3063e-04
Loss = 1.6260e-01, PNorm = 35.2013, GNorm = 4.6101, lr_0 = 4.2968e-04
Validation rmse = 0.153891
Epoch 22
Loss = 1.4179e-01, PNorm = 35.2109, GNorm = 2.1394, lr_0 = 4.2030e-04
Validation rmse = 0.153284
Epoch 23
Loss = 2.0895e-01, PNorm = 35.2200, GNorm = 3.8500, lr_0 = 4.1114e-04
Loss = 1.4864e-01, PNorm = 35.2300, GNorm = 2.7466, lr_0 = 4.0217e-04
Validation rmse = 0.152001
Epoch 24
Loss = 1.7283e-01, PNorm = 35.2428, GNorm = 4.1395, lr_0 = 3.9253e-04
Loss = 1.4065e-01, PNorm = 35.2546, GNorm = 4.2256, lr_0 = 3.8396e-04
Validation rmse = 0.170575
Epoch 25
Loss = 1.2108e-01, PNorm = 35.2677, GNorm = 1.8244, lr_0 = 3.7476e-04
Loss = 1.5048e-01, PNorm = 35.2769, GNorm = 1.1931, lr_0 = 3.6659e-04
Validation rmse = 0.152832
Epoch 26
Loss = 1.3582e-01, PNorm = 35.2896, GNorm = 0.8242, lr_0 = 3.5780e-04
Loss = 1.4975e-01, PNorm = 35.3001, GNorm = 1.1297, lr_0 = 3.4999e-04
Validation rmse = 0.155282
Epoch 27
Loss = 1.4830e-01, PNorm = 35.3103, GNorm = 2.6274, lr_0 = 3.4161e-04
Loss = 1.1910e-01, PNorm = 35.3218, GNorm = 2.5979, lr_0 = 3.3415e-04
Validation rmse = 0.155756
Epoch 28
Loss = 1.3621e-01, PNorm = 35.3276, GNorm = 0.5902, lr_0 = 3.2686e-04
Validation rmse = 0.155482
Epoch 29
Loss = 1.3931e-01, PNorm = 35.3400, GNorm = 0.8035, lr_0 = 3.1903e-04
Loss = 1.2410e-01, PNorm = 35.3484, GNorm = 1.2655, lr_0 = 3.1207e-04
Validation rmse = 0.151566
Epoch 30
Loss = 1.1544e-01, PNorm = 35.3562, GNorm = 0.6012, lr_0 = 3.0459e-04
Loss = 1.1299e-01, PNorm = 35.3650, GNorm = 0.9096, lr_0 = 2.9795e-04
Validation rmse = 0.163930
Epoch 31
Loss = 1.2266e-01, PNorm = 35.3722, GNorm = 0.6374, lr_0 = 2.9080e-04
Loss = 1.2670e-01, PNorm = 35.3800, GNorm = 3.1930, lr_0 = 2.8446e-04
Validation rmse = 0.151051
Epoch 32
Loss = 1.1872e-01, PNorm = 35.3881, GNorm = 1.2659, lr_0 = 2.7826e-04
Loss = 1.1772e-01, PNorm = 35.3962, GNorm = 0.4586, lr_0 = 2.7219e-04
Validation rmse = 0.156184
Epoch 33
Loss = 1.3227e-01, PNorm = 35.4042, GNorm = 1.9723, lr_0 = 2.6566e-04
Validation rmse = 0.149365
Epoch 34
Loss = 1.1810e-01, PNorm = 35.4136, GNorm = 0.5986, lr_0 = 2.5929e-04
Loss = 1.1418e-01, PNorm = 35.4212, GNorm = 0.7710, lr_0 = 2.5364e-04
Validation rmse = 0.152635
Epoch 35
Loss = 1.1156e-01, PNorm = 35.4297, GNorm = 0.6795, lr_0 = 2.4756e-04
Loss = 1.2236e-01, PNorm = 35.4364, GNorm = 0.7986, lr_0 = 2.4216e-04
Validation rmse = 0.148896
Epoch 36
Loss = 1.2098e-01, PNorm = 35.4427, GNorm = 1.1708, lr_0 = 2.3635e-04
Loss = 1.1661e-01, PNorm = 35.4484, GNorm = 1.1261, lr_0 = 2.3120e-04
Validation rmse = 0.150435
Epoch 37
Loss = 1.0663e-01, PNorm = 35.4545, GNorm = 0.5529, lr_0 = 2.2615e-04
Loss = 1.2444e-01, PNorm = 35.4627, GNorm = 1.1085, lr_0 = 2.2122e-04
Validation rmse = 0.150192
Epoch 38
Loss = 1.0248e-01, PNorm = 35.4676, GNorm = 1.7589, lr_0 = 2.1592e-04
Loss = 1.2998e-01, PNorm = 35.4747, GNorm = 1.6847, lr_0 = 2.1121e-04
Loss = 8.0921e-02, PNorm = 35.4758, GNorm = 2.8504, lr_0 = 2.1074e-04
Validation rmse = 0.151988
Epoch 39
Loss = 1.1558e-01, PNorm = 35.4815, GNorm = 1.8610, lr_0 = 2.0615e-04
Validation rmse = 0.151122
Epoch 40
Loss = 8.6503e-02, PNorm = 35.4887, GNorm = 1.1033, lr_0 = 2.0121e-04
Loss = 1.1792e-01, PNorm = 35.4951, GNorm = 0.5427, lr_0 = 1.9682e-04
Validation rmse = 0.150584
Epoch 41
Loss = 9.7462e-02, PNorm = 35.5009, GNorm = 1.7084, lr_0 = 1.9252e-04
Loss = 1.1877e-01, PNorm = 35.5064, GNorm = 0.8900, lr_0 = 1.8832e-04
Validation rmse = 0.151057
Epoch 42
Loss = 1.1971e-01, PNorm = 35.5130, GNorm = 0.6484, lr_0 = 1.8381e-04
Loss = 1.0040e-01, PNorm = 35.5179, GNorm = 0.6901, lr_0 = 1.7980e-04
Validation rmse = 0.151846
Epoch 43
Loss = 1.1899e-01, PNorm = 35.5241, GNorm = 0.7368, lr_0 = 1.7549e-04
Loss = 1.1436e-01, PNorm = 35.5301, GNorm = 0.7571, lr_0 = 1.7166e-04
Validation rmse = 0.149392
Epoch 44
Loss = 1.0008e-01, PNorm = 35.5353, GNorm = 0.6355, lr_0 = 1.6755e-04
Validation rmse = 0.149899
Epoch 45
Loss = 1.5343e-01, PNorm = 35.5399, GNorm = 1.3675, lr_0 = 1.6353e-04
Loss = 1.0559e-01, PNorm = 35.5439, GNorm = 1.9891, lr_0 = 1.5996e-04
Validation rmse = 0.153441
Epoch 46
Loss = 1.1520e-01, PNorm = 35.5489, GNorm = 1.8355, lr_0 = 1.5647e-04
Loss = 1.1741e-01, PNorm = 35.5540, GNorm = 2.2474, lr_0 = 1.5306e-04
Validation rmse = 0.154725
Epoch 47
Loss = 1.1385e-01, PNorm = 35.5582, GNorm = 0.9359, lr_0 = 1.4939e-04
Loss = 1.0282e-01, PNorm = 35.5616, GNorm = 0.4857, lr_0 = 1.4613e-04
Validation rmse = 0.151057
Epoch 48
Loss = 9.8026e-02, PNorm = 35.5679, GNorm = 0.7851, lr_0 = 1.4263e-04
Loss = 1.1624e-01, PNorm = 35.5720, GNorm = 1.0145, lr_0 = 1.3952e-04
Validation rmse = 0.149611
Epoch 49
Loss = 9.9767e-02, PNorm = 35.5760, GNorm = 1.4921, lr_0 = 1.3618e-04
Loss = 1.1292e-01, PNorm = 35.5811, GNorm = 1.3393, lr_0 = 1.3321e-04
Validation rmse = 0.149986
Epoch 50
Loss = 1.1249e-01, PNorm = 35.5834, GNorm = 0.7170, lr_0 = 1.3030e-04
Validation rmse = 0.148810
Epoch 51
Loss = 8.2901e-02, PNorm = 35.5875, GNorm = 0.7225, lr_0 = 1.2718e-04
Loss = 1.1883e-01, PNorm = 35.5910, GNorm = 1.5291, lr_0 = 1.2440e-04
Validation rmse = 0.150007
Epoch 52
Loss = 1.0630e-01, PNorm = 35.5959, GNorm = 1.1894, lr_0 = 1.2142e-04
Loss = 1.0493e-01, PNorm = 35.5996, GNorm = 1.3871, lr_0 = 1.1877e-04
Validation rmse = 0.150069
Epoch 53
Loss = 9.3271e-02, PNorm = 35.6026, GNorm = 0.6186, lr_0 = 1.1592e-04
Loss = 1.0969e-01, PNorm = 35.6065, GNorm = 1.3562, lr_0 = 1.1340e-04
Validation rmse = 0.148792
Epoch 54
Loss = 1.0433e-01, PNorm = 35.6093, GNorm = 2.3514, lr_0 = 1.1068e-04
Loss = 1.0623e-01, PNorm = 35.6125, GNorm = 0.7950, lr_0 = 1.0826e-04
Validation rmse = 0.153618
Epoch 55
Loss = 9.6307e-02, PNorm = 35.6157, GNorm = 0.9168, lr_0 = 1.0590e-04
Loss = 1.0677e-01, PNorm = 35.6186, GNorm = 1.8558, lr_0 = 1.0359e-04
Loss = 1.7515e-01, PNorm = 35.6189, GNorm = 1.3831, lr_0 = 1.0336e-04
Validation rmse = 0.150763
Epoch 56
Loss = 1.0050e-01, PNorm = 35.6228, GNorm = 0.9712, lr_0 = 1.0111e-04
Validation rmse = 0.152896
Epoch 57
Loss = 1.1432e-01, PNorm = 35.6251, GNorm = 1.8192, lr_0 = 1.0000e-04
Loss = 1.0509e-01, PNorm = 35.6286, GNorm = 1.8098, lr_0 = 1.0000e-04
Validation rmse = 0.148851
Epoch 58
Loss = 9.6949e-02, PNorm = 35.6322, GNorm = 1.1980, lr_0 = 1.0000e-04
Loss = 1.0377e-01, PNorm = 35.6346, GNorm = 1.0001, lr_0 = 1.0000e-04
Validation rmse = 0.148957
Epoch 59
Loss = 1.1701e-01, PNorm = 35.6389, GNorm = 0.8622, lr_0 = 1.0000e-04
Loss = 9.9530e-02, PNorm = 35.6425, GNorm = 1.7618, lr_0 = 1.0000e-04
Validation rmse = 0.150291
Model 0 best validation rmse = 0.148792 on epoch 53
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.125836
Ensemble test rmse = 0.125836
1-fold cross validation
	Seed 0 ==> test rmse = 0.125836
Overall test rmse = 0.125836 +/- 0.000000
Elapsed time = 0:00:43
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,137 | train size = 903 | val size = 228 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.9338e-01, PNorm = 34.0154, GNorm = 1.9119, lr_0 = 3.7500e-04
Validation rmse = 0.301230
Epoch 1
Loss = 6.8999e-01, PNorm = 34.0385, GNorm = 7.4830, lr_0 = 6.5000e-04
Loss = 7.4802e-01, PNorm = 34.0724, GNorm = 3.3466, lr_0 = 9.0000e-04
Validation rmse = 0.284289
Epoch 2
Loss = 6.4388e-01, PNorm = 34.1345, GNorm = 3.7739, lr_0 = 9.8468e-04
Loss = 5.0750e-01, PNorm = 34.2103, GNorm = 4.6202, lr_0 = 9.6320e-04
Validation rmse = 0.261895
Epoch 3
Loss = 4.9841e-01, PNorm = 34.2694, GNorm = 7.8665, lr_0 = 9.4011e-04
Loss = 3.6534e-01, PNorm = 34.3264, GNorm = 1.1929, lr_0 = 9.1961e-04
Validation rmse = 0.212212
Epoch 4
Loss = 3.4662e-01, PNorm = 34.3934, GNorm = 1.2547, lr_0 = 8.9756e-04
Loss = 3.0393e-01, PNorm = 34.4451, GNorm = 2.8031, lr_0 = 8.7798e-04
Loss = 1.0592e-02, PNorm = 34.4502, GNorm = 1.7912, lr_0 = 8.7605e-04
Validation rmse = 0.219362
Epoch 5
Loss = 3.1532e-01, PNorm = 34.4949, GNorm = 1.0626, lr_0 = 8.5694e-04
Validation rmse = 0.186621
Epoch 6
Loss = 2.4749e-01, PNorm = 34.5418, GNorm = 1.5452, lr_0 = 8.3640e-04
Loss = 2.3371e-01, PNorm = 34.5850, GNorm = 6.6021, lr_0 = 8.1815e-04
Validation rmse = 0.191178
Epoch 7
Loss = 2.3130e-01, PNorm = 34.6266, GNorm = 5.4467, lr_0 = 7.9854e-04
Loss = 2.1806e-01, PNorm = 34.6654, GNorm = 1.9042, lr_0 = 7.8112e-04
Validation rmse = 0.163177
Epoch 8
Loss = 2.5090e-01, PNorm = 34.6921, GNorm = 1.5321, lr_0 = 7.6240e-04
Loss = 2.0493e-01, PNorm = 34.7197, GNorm = 0.8355, lr_0 = 7.4577e-04
Validation rmse = 0.164358
Epoch 9
Loss = 1.6984e-01, PNorm = 34.7531, GNorm = 0.8077, lr_0 = 7.2790e-04
Loss = 1.9884e-01, PNorm = 34.7800, GNorm = 2.2362, lr_0 = 7.1202e-04
Loss = 7.1293e-02, PNorm = 34.7830, GNorm = 4.7842, lr_0 = 7.1045e-04
Validation rmse = 0.157497
Epoch 10
Loss = 1.7324e-01, PNorm = 34.8173, GNorm = 3.3711, lr_0 = 6.9495e-04
Validation rmse = 0.175899
Epoch 11
Loss = 2.5300e-01, PNorm = 34.8388, GNorm = 4.7830, lr_0 = 6.7829e-04
Loss = 1.9073e-01, PNorm = 34.8644, GNorm = 3.2557, lr_0 = 6.6350e-04
Validation rmse = 0.159377
Epoch 12
Loss = 1.7102e-01, PNorm = 34.8883, GNorm = 1.4114, lr_0 = 6.4759e-04
Loss = 1.8028e-01, PNorm = 34.9114, GNorm = 0.6314, lr_0 = 6.3347e-04
Validation rmse = 0.153825
Epoch 13
Loss = 1.5628e-01, PNorm = 34.9382, GNorm = 2.8058, lr_0 = 6.1828e-04
Loss = 1.4769e-01, PNorm = 34.9575, GNorm = 1.0327, lr_0 = 6.0480e-04
Validation rmse = 0.183088
Epoch 14
Loss = 2.5511e-01, PNorm = 34.9682, GNorm = 2.4475, lr_0 = 5.9030e-04
Loss = 2.0104e-01, PNorm = 34.9881, GNorm = 2.3897, lr_0 = 5.7742e-04
Loss = 7.8961e-02, PNorm = 34.9905, GNorm = 3.1085, lr_0 = 5.7615e-04
Validation rmse = 0.178638
Epoch 15
Loss = 1.7773e-01, PNorm = 35.0166, GNorm = 2.3796, lr_0 = 5.6358e-04
Validation rmse = 0.149833
Epoch 16
Loss = 1.3059e-01, PNorm = 35.0396, GNorm = 1.7587, lr_0 = 5.5007e-04
Loss = 1.6049e-01, PNorm = 35.0605, GNorm = 2.0310, lr_0 = 5.3808e-04
Validation rmse = 0.157252
Epoch 17
Loss = 1.4848e-01, PNorm = 35.0754, GNorm = 0.5144, lr_0 = 5.2634e-04
Loss = 1.4359e-01, PNorm = 35.0892, GNorm = 1.0763, lr_0 = 5.1486e-04
Validation rmse = 0.143515
Epoch 18
Loss = 1.4565e-01, PNorm = 35.1036, GNorm = 0.8529, lr_0 = 5.0252e-04
Loss = 1.3905e-01, PNorm = 35.1201, GNorm = 0.7992, lr_0 = 4.9155e-04
Validation rmse = 0.163379
Epoch 19
Loss = 1.9070e-01, PNorm = 35.1349, GNorm = 5.1786, lr_0 = 4.7977e-04
Loss = 1.8379e-01, PNorm = 35.1517, GNorm = 2.8217, lr_0 = 4.6931e-04
Validation rmse = 0.142671
Epoch 20
Loss = 1.6673e-01, PNorm = 35.1636, GNorm = 3.8837, lr_0 = 4.5806e-04
Validation rmse = 0.144433
Epoch 21
Loss = 1.7328e-01, PNorm = 35.1792, GNorm = 2.5428, lr_0 = 4.4708e-04
Loss = 1.3348e-01, PNorm = 35.1897, GNorm = 0.7284, lr_0 = 4.3733e-04
Validation rmse = 0.144529
Epoch 22
Loss = 1.0467e-01, PNorm = 35.2065, GNorm = 2.8164, lr_0 = 4.2684e-04
Loss = 1.6320e-01, PNorm = 35.2189, GNorm = 3.3216, lr_0 = 4.1753e-04
Validation rmse = 0.151445
Epoch 23
Loss = 1.1807e-01, PNorm = 35.2312, GNorm = 0.9113, lr_0 = 4.0752e-04
Loss = 1.3384e-01, PNorm = 35.2419, GNorm = 4.3235, lr_0 = 3.9863e-04
Validation rmse = 0.148497
Epoch 24
Loss = 1.3289e-01, PNorm = 35.2506, GNorm = 1.9641, lr_0 = 3.8908e-04
Loss = 1.2446e-01, PNorm = 35.2615, GNorm = 1.5194, lr_0 = 3.8059e-04
Validation rmse = 0.143207
Epoch 25
Loss = 1.3422e-01, PNorm = 35.2735, GNorm = 2.0930, lr_0 = 3.7147e-04
Validation rmse = 0.149231
Epoch 26
Loss = 8.0782e-02, PNorm = 35.2861, GNorm = 0.8693, lr_0 = 3.6257e-04
Loss = 1.1907e-01, PNorm = 35.2931, GNorm = 0.9399, lr_0 = 3.5466e-04
Validation rmse = 0.152987
Epoch 27
Loss = 1.2561e-01, PNorm = 35.3026, GNorm = 2.8763, lr_0 = 3.4616e-04
Loss = 1.2546e-01, PNorm = 35.3150, GNorm = 0.7461, lr_0 = 3.3861e-04
Validation rmse = 0.159118
Epoch 28
Loss = 1.2755e-01, PNorm = 35.3270, GNorm = 1.1788, lr_0 = 3.3049e-04
Loss = 1.2324e-01, PNorm = 35.3387, GNorm = 0.4958, lr_0 = 3.2328e-04
Validation rmse = 0.155541
Epoch 29
Loss = 1.5665e-01, PNorm = 35.3509, GNorm = 4.6716, lr_0 = 3.1553e-04
Loss = 1.1788e-01, PNorm = 35.3592, GNorm = 0.5575, lr_0 = 3.0865e-04
Validation rmse = 0.165603
Epoch 30
Loss = 1.3745e-01, PNorm = 35.3688, GNorm = 2.1306, lr_0 = 3.0125e-04
Validation rmse = 0.143587
Epoch 31
Loss = 8.9798e-02, PNorm = 35.3783, GNorm = 0.7121, lr_0 = 2.9403e-04
Loss = 1.1600e-01, PNorm = 35.3871, GNorm = 1.8490, lr_0 = 2.8762e-04
Validation rmse = 0.146177
Epoch 32
Loss = 1.5629e-01, PNorm = 35.3982, GNorm = 5.2055, lr_0 = 2.8072e-04
Loss = 1.3036e-01, PNorm = 35.4097, GNorm = 1.7543, lr_0 = 2.7460e-04
Validation rmse = 0.156075
Epoch 33
Loss = 1.3735e-01, PNorm = 35.4220, GNorm = 2.0388, lr_0 = 2.6802e-04
Loss = 1.3189e-01, PNorm = 35.4305, GNorm = 1.8122, lr_0 = 2.6217e-04
Validation rmse = 0.147162
Epoch 34
Loss = 1.1365e-01, PNorm = 35.4374, GNorm = 1.1910, lr_0 = 2.5645e-04
Loss = 1.1849e-01, PNorm = 35.4442, GNorm = 0.6490, lr_0 = 2.5086e-04
Validation rmse = 0.145221
Epoch 35
Loss = 1.0836e-01, PNorm = 35.4517, GNorm = 0.6153, lr_0 = 2.4484e-04
Loss = 1.1794e-01, PNorm = 35.4584, GNorm = 0.8627, lr_0 = 2.3950e-04
Loss = 8.3279e-02, PNorm = 35.4593, GNorm = 2.7158, lr_0 = 2.3898e-04
Validation rmse = 0.150772
Epoch 36
Loss = 1.0911e-01, PNorm = 35.4660, GNorm = 0.9821, lr_0 = 2.3376e-04
Validation rmse = 0.146955
Epoch 37
Loss = 1.0322e-01, PNorm = 35.4723, GNorm = 0.7976, lr_0 = 2.2816e-04
Loss = 1.1619e-01, PNorm = 35.4784, GNorm = 0.5965, lr_0 = 2.2318e-04
Validation rmse = 0.145709
Epoch 38
Loss = 9.0838e-02, PNorm = 35.4846, GNorm = 1.2012, lr_0 = 2.1783e-04
Loss = 1.1501e-01, PNorm = 35.4894, GNorm = 1.1258, lr_0 = 2.1308e-04
Validation rmse = 0.143547
Epoch 39
Loss = 1.2527e-01, PNorm = 35.4965, GNorm = 2.0775, lr_0 = 2.0797e-04
Loss = 1.1226e-01, PNorm = 35.5035, GNorm = 1.1765, lr_0 = 2.0344e-04
Validation rmse = 0.146628
Epoch 40
Loss = 1.1939e-01, PNorm = 35.5083, GNorm = 0.7547, lr_0 = 1.9856e-04
Loss = 1.0374e-01, PNorm = 35.5142, GNorm = 1.0297, lr_0 = 1.9423e-04
Loss = 7.9340e-02, PNorm = 35.5147, GNorm = 3.6391, lr_0 = 1.9380e-04
Validation rmse = 0.144791
Epoch 41
Loss = 1.0715e-01, PNorm = 35.5204, GNorm = 1.5391, lr_0 = 1.8957e-04
Validation rmse = 0.142826
Epoch 42
Loss = 1.1155e-01, PNorm = 35.5254, GNorm = 0.9092, lr_0 = 1.8503e-04
Loss = 1.1658e-01, PNorm = 35.5315, GNorm = 2.7743, lr_0 = 1.8099e-04
Validation rmse = 0.142315
Epoch 43
Loss = 1.0891e-01, PNorm = 35.5360, GNorm = 0.7516, lr_0 = 1.7666e-04
Loss = 1.0492e-01, PNorm = 35.5405, GNorm = 0.6273, lr_0 = 1.7280e-04
Validation rmse = 0.144905
Epoch 44
Loss = 9.9343e-02, PNorm = 35.5459, GNorm = 1.0812, lr_0 = 1.6866e-04
Loss = 1.0646e-01, PNorm = 35.5506, GNorm = 1.0459, lr_0 = 1.6498e-04
Validation rmse = 0.143696
Epoch 45
Loss = 1.0242e-01, PNorm = 35.5571, GNorm = 0.5785, lr_0 = 1.6103e-04
Loss = 1.0850e-01, PNorm = 35.5615, GNorm = 0.5911, lr_0 = 1.5751e-04
Loss = 3.2986e-02, PNorm = 35.5620, GNorm = 1.6598, lr_0 = 1.5717e-04
Validation rmse = 0.145974
Epoch 46
Loss = 1.0630e-01, PNorm = 35.5679, GNorm = 0.8018, lr_0 = 1.5374e-04
Validation rmse = 0.143343
Epoch 47
Loss = 8.8247e-02, PNorm = 35.5723, GNorm = 0.5450, lr_0 = 1.5005e-04
Loss = 1.0871e-01, PNorm = 35.5763, GNorm = 1.4161, lr_0 = 1.4678e-04
Validation rmse = 0.144397
Epoch 48
Loss = 1.0386e-01, PNorm = 35.5803, GNorm = 1.5080, lr_0 = 1.4326e-04
Loss = 1.0702e-01, PNorm = 35.5833, GNorm = 1.8481, lr_0 = 1.4014e-04
Validation rmse = 0.143433
Epoch 49
Loss = 1.0666e-01, PNorm = 35.5886, GNorm = 1.2361, lr_0 = 1.3678e-04
Loss = 9.6406e-02, PNorm = 35.5916, GNorm = 1.5251, lr_0 = 1.3379e-04
Validation rmse = 0.146034
Epoch 50
Loss = 1.1739e-01, PNorm = 35.5974, GNorm = 1.1873, lr_0 = 1.3088e-04
Loss = 9.4784e-02, PNorm = 35.6008, GNorm = 0.6118, lr_0 = 1.2802e-04
Validation rmse = 0.144492
Epoch 51
Loss = 1.0431e-01, PNorm = 35.6045, GNorm = 2.3824, lr_0 = 1.2495e-04
Validation rmse = 0.144440
Epoch 52
Loss = 1.0225e-01, PNorm = 35.6101, GNorm = 0.7719, lr_0 = 1.2196e-04
Loss = 1.0401e-01, PNorm = 35.6141, GNorm = 0.9758, lr_0 = 1.1930e-04
Validation rmse = 0.145949
Epoch 53
Loss = 1.1470e-01, PNorm = 35.6176, GNorm = 2.1394, lr_0 = 1.1644e-04
Loss = 9.0703e-02, PNorm = 35.6196, GNorm = 0.5363, lr_0 = 1.1390e-04
Validation rmse = 0.143579
Epoch 54
Loss = 9.8926e-02, PNorm = 35.6245, GNorm = 1.6465, lr_0 = 1.1117e-04
Loss = 8.7739e-02, PNorm = 35.6272, GNorm = 1.2161, lr_0 = 1.0874e-04
Validation rmse = 0.148505
Epoch 55
Loss = 1.0170e-01, PNorm = 35.6290, GNorm = 2.0177, lr_0 = 1.0614e-04
Loss = 1.1427e-01, PNorm = 35.6335, GNorm = 0.6534, lr_0 = 1.0382e-04
Validation rmse = 0.144469
Epoch 56
Loss = 1.0563e-01, PNorm = 35.6372, GNorm = 1.0248, lr_0 = 1.0133e-04
Validation rmse = 0.144509
Epoch 57
Loss = 8.4459e-02, PNorm = 35.6398, GNorm = 1.2623, lr_0 = 1.0000e-04
Loss = 1.0250e-01, PNorm = 35.6426, GNorm = 0.8122, lr_0 = 1.0000e-04
Validation rmse = 0.143393
Epoch 58
Loss = 1.0247e-01, PNorm = 35.6464, GNorm = 1.2629, lr_0 = 1.0000e-04
Loss = 9.3632e-02, PNorm = 35.6501, GNorm = 1.3564, lr_0 = 1.0000e-04
Validation rmse = 0.145069
Epoch 59
Loss = 9.6671e-02, PNorm = 35.6532, GNorm = 0.6163, lr_0 = 1.0000e-04
Loss = 9.4893e-02, PNorm = 35.6559, GNorm = 1.0661, lr_0 = 1.0000e-04
Validation rmse = 0.144680
Model 0 best validation rmse = 0.142315 on epoch 42
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.104105
Ensemble test rmse = 0.104105
1-fold cross validation
	Seed 0 ==> test rmse = 0.104105
Overall test rmse = 0.104105 +/- 0.000000
Elapsed time = 0:00:39
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,127 | train size = 895 | val size = 226 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.3673e-01, PNorm = 34.0158, GNorm = 2.1343, lr_0 = 3.9118e-04
Validation rmse = 0.296777
Epoch 1
Loss = 6.1014e-01, PNorm = 34.0502, GNorm = 4.6801, lr_0 = 6.8235e-04
Loss = 6.8840e-01, PNorm = 34.0877, GNorm = 5.9975, lr_0 = 9.4706e-04
Validation rmse = 0.260027
Epoch 2
Loss = 4.3269e-01, PNorm = 34.1594, GNorm = 2.6688, lr_0 = 9.8149e-04
Loss = 4.3331e-01, PNorm = 34.2311, GNorm = 4.9769, lr_0 = 9.5884e-04
Validation rmse = 0.218209
Epoch 3
Loss = 3.0486e-01, PNorm = 34.3075, GNorm = 1.3942, lr_0 = 9.3670e-04
Loss = 3.6765e-01, PNorm = 34.3677, GNorm = 9.6887, lr_0 = 9.1508e-04
Validation rmse = 0.205074
Epoch 4
Loss = 3.5564e-01, PNorm = 34.4106, GNorm = 5.1666, lr_0 = 8.9396e-04
Validation rmse = 0.214552
Epoch 5
Loss = 5.0586e-01, PNorm = 34.4565, GNorm = 11.2203, lr_0 = 8.7333e-04
Loss = 2.9613e-01, PNorm = 34.4954, GNorm = 5.4227, lr_0 = 8.5317e-04
Validation rmse = 0.192052
Epoch 6
Loss = 2.5028e-01, PNorm = 34.5382, GNorm = 1.3841, lr_0 = 8.3347e-04
Loss = 2.2259e-01, PNorm = 34.5744, GNorm = 1.1169, lr_0 = 8.1424e-04
Validation rmse = 0.171433
Epoch 7
Loss = 2.3786e-01, PNorm = 34.6066, GNorm = 4.4952, lr_0 = 7.9544e-04
Loss = 1.9292e-01, PNorm = 34.6354, GNorm = 4.5683, lr_0 = 7.7708e-04
Validation rmse = 0.168843
Epoch 8
Loss = 1.9193e-01, PNorm = 34.6706, GNorm = 4.6013, lr_0 = 7.5914e-04
Loss = 2.3580e-01, PNorm = 34.6987, GNorm = 2.4789, lr_0 = 7.4162e-04
Validation rmse = 0.189131
Epoch 9
Loss = 2.0424e-01, PNorm = 34.7310, GNorm = 1.0929, lr_0 = 7.2450e-04
Validation rmse = 0.155405
Epoch 10
Loss = 1.5112e-01, PNorm = 34.7642, GNorm = 0.7409, lr_0 = 7.0778e-04
Loss = 1.8553e-01, PNorm = 34.7912, GNorm = 3.2021, lr_0 = 6.9144e-04
Validation rmse = 0.151003
Epoch 11
Loss = 1.6825e-01, PNorm = 34.8228, GNorm = 3.6125, lr_0 = 6.7391e-04
Loss = 1.8466e-01, PNorm = 34.8517, GNorm = 1.8821, lr_0 = 6.5835e-04
Validation rmse = 0.147033
Epoch 12
Loss = 1.6618e-01, PNorm = 34.8776, GNorm = 1.0784, lr_0 = 6.4316e-04
Loss = 1.3395e-01, PNorm = 34.9038, GNorm = 2.0853, lr_0 = 6.2831e-04
Validation rmse = 0.143108
Epoch 13
Loss = 1.3507e-01, PNorm = 34.9263, GNorm = 0.8267, lr_0 = 6.1381e-04
Loss = 1.6185e-01, PNorm = 34.9491, GNorm = 3.2033, lr_0 = 5.9964e-04
Validation rmse = 0.146751
Epoch 14
Loss = 1.5113e-01, PNorm = 34.9693, GNorm = 2.5673, lr_0 = 5.8580e-04
Validation rmse = 0.142530
Epoch 15
Loss = 1.3377e-01, PNorm = 34.9917, GNorm = 1.2276, lr_0 = 5.7228e-04
Loss = 1.2972e-01, PNorm = 35.0099, GNorm = 1.2721, lr_0 = 5.5907e-04
Validation rmse = 0.147162
Epoch 16
Loss = 1.3702e-01, PNorm = 35.0322, GNorm = 1.1557, lr_0 = 5.4616e-04
Loss = 1.3122e-01, PNorm = 35.0497, GNorm = 0.8387, lr_0 = 5.3356e-04
Validation rmse = 0.148035
Epoch 17
Loss = 1.3190e-01, PNorm = 35.0682, GNorm = 1.4874, lr_0 = 5.2124e-04
Loss = 1.4659e-01, PNorm = 35.0850, GNorm = 1.6769, lr_0 = 5.0921e-04
Validation rmse = 0.142804
Epoch 18
Loss = 1.3729e-01, PNorm = 35.1042, GNorm = 1.2830, lr_0 = 4.9746e-04
Loss = 1.3061e-01, PNorm = 35.1182, GNorm = 1.7025, lr_0 = 4.8597e-04
Validation rmse = 0.148384
Epoch 19
Loss = 1.2941e-01, PNorm = 35.1344, GNorm = 1.1383, lr_0 = 4.7476e-04
Validation rmse = 0.142434
Epoch 20
Loss = 1.0617e-01, PNorm = 35.1491, GNorm = 1.4864, lr_0 = 4.6380e-04
Loss = 1.2744e-01, PNorm = 35.1674, GNorm = 3.9076, lr_0 = 4.5309e-04
Validation rmse = 0.143068
Epoch 21
Loss = 1.2437e-01, PNorm = 35.1813, GNorm = 0.9701, lr_0 = 4.4160e-04
Loss = 1.1399e-01, PNorm = 35.1953, GNorm = 0.9384, lr_0 = 4.3141e-04
Validation rmse = 0.137988
Epoch 22
Loss = 1.1497e-01, PNorm = 35.2087, GNorm = 1.5350, lr_0 = 4.2145e-04
Loss = 1.2461e-01, PNorm = 35.2201, GNorm = 1.1347, lr_0 = 4.1172e-04
Validation rmse = 0.148739
Epoch 23
Loss = 1.3815e-01, PNorm = 35.2323, GNorm = 2.5802, lr_0 = 4.0222e-04
Validation rmse = 0.142594
Epoch 24
Loss = 1.2946e-01, PNorm = 35.2470, GNorm = 4.0458, lr_0 = 3.9293e-04
Loss = 1.1827e-01, PNorm = 35.2609, GNorm = 1.2365, lr_0 = 3.8386e-04
Validation rmse = 0.136364
Epoch 25
Loss = 1.1886e-01, PNorm = 35.2737, GNorm = 1.4338, lr_0 = 3.7500e-04
Loss = 1.2107e-01, PNorm = 35.2851, GNorm = 3.0861, lr_0 = 3.6635e-04
Validation rmse = 0.138006
Epoch 26
Loss = 1.3051e-01, PNorm = 35.2994, GNorm = 1.7295, lr_0 = 3.5789e-04
Loss = 1.2681e-01, PNorm = 35.3120, GNorm = 2.0335, lr_0 = 3.4963e-04
Validation rmse = 0.134635
Epoch 27
Loss = 1.0614e-01, PNorm = 35.3238, GNorm = 2.5779, lr_0 = 3.4156e-04
Loss = 1.1409e-01, PNorm = 35.3348, GNorm = 1.5162, lr_0 = 3.3368e-04
Validation rmse = 0.135016
Epoch 28
Loss = 1.2076e-01, PNorm = 35.3449, GNorm = 1.3396, lr_0 = 3.2598e-04
Validation rmse = 0.134817
Epoch 29
Loss = 9.7967e-02, PNorm = 35.3551, GNorm = 0.8459, lr_0 = 3.1845e-04
Loss = 1.1759e-01, PNorm = 35.3657, GNorm = 3.4651, lr_0 = 3.1110e-04
Validation rmse = 0.136197
Epoch 30
Loss = 9.3087e-02, PNorm = 35.3770, GNorm = 1.9914, lr_0 = 3.0392e-04
Loss = 1.2259e-01, PNorm = 35.3867, GNorm = 2.7632, lr_0 = 2.9690e-04
Validation rmse = 0.135602
Epoch 31
Loss = 1.2713e-01, PNorm = 35.4000, GNorm = 4.0923, lr_0 = 2.8937e-04
Loss = 1.2214e-01, PNorm = 35.4089, GNorm = 1.8960, lr_0 = 2.8270e-04
Validation rmse = 0.135289
Epoch 32
Loss = 1.0161e-01, PNorm = 35.4178, GNorm = 1.5271, lr_0 = 2.7617e-04
Loss = 1.1590e-01, PNorm = 35.4246, GNorm = 2.0526, lr_0 = 2.6980e-04
Validation rmse = 0.139962
Epoch 33
Loss = 1.0774e-01, PNorm = 35.4348, GNorm = 0.7258, lr_0 = 2.6357e-04
Validation rmse = 0.133548
Epoch 34
Loss = 8.4725e-02, PNorm = 35.4421, GNorm = 0.7218, lr_0 = 2.5748e-04
Loss = 1.0736e-01, PNorm = 35.4516, GNorm = 2.4505, lr_0 = 2.5154e-04
Validation rmse = 0.132286
Epoch 35
Loss = 1.1350e-01, PNorm = 35.4593, GNorm = 3.1493, lr_0 = 2.4573e-04
Loss = 1.0892e-01, PNorm = 35.4665, GNorm = 1.0229, lr_0 = 2.4006e-04
Validation rmse = 0.136242
Epoch 36
Loss = 9.5959e-02, PNorm = 35.4740, GNorm = 0.8546, lr_0 = 2.3452e-04
Loss = 1.0703e-01, PNorm = 35.4837, GNorm = 1.2661, lr_0 = 2.2911e-04
Validation rmse = 0.132582
Epoch 37
Loss = 9.8464e-02, PNorm = 35.4896, GNorm = 1.8984, lr_0 = 2.2382e-04
Loss = 1.0308e-01, PNorm = 35.4967, GNorm = 0.8885, lr_0 = 2.1865e-04
Validation rmse = 0.132218
Epoch 38
Loss = 1.0054e-01, PNorm = 35.5047, GNorm = 1.2828, lr_0 = 2.1361e-04
Validation rmse = 0.132882
Epoch 39
Loss = 8.9342e-02, PNorm = 35.5106, GNorm = 1.0340, lr_0 = 2.0868e-04
Loss = 1.0638e-01, PNorm = 35.5177, GNorm = 0.5812, lr_0 = 2.0386e-04
Validation rmse = 0.134718
Epoch 40
Loss = 8.8701e-02, PNorm = 35.5251, GNorm = 1.6701, lr_0 = 1.9915e-04
Loss = 1.0397e-01, PNorm = 35.5312, GNorm = 1.4385, lr_0 = 1.9456e-04
Validation rmse = 0.133445
Epoch 41
Loss = 9.8338e-02, PNorm = 35.5392, GNorm = 3.9858, lr_0 = 1.8962e-04
Loss = 1.0197e-01, PNorm = 35.5462, GNorm = 0.5052, lr_0 = 1.8525e-04
Validation rmse = 0.132368
Epoch 42
Loss = 1.0798e-01, PNorm = 35.5508, GNorm = 2.6272, lr_0 = 1.8097e-04
Validation rmse = 0.133773
Epoch 43
Loss = 1.1468e-01, PNorm = 35.5567, GNorm = 2.5049, lr_0 = 1.7679e-04
Loss = 1.0160e-01, PNorm = 35.5619, GNorm = 1.4609, lr_0 = 1.7271e-04
Validation rmse = 0.132658
Epoch 44
Loss = 8.7594e-02, PNorm = 35.5689, GNorm = 0.4839, lr_0 = 1.6873e-04
Loss = 1.0215e-01, PNorm = 35.5746, GNorm = 0.9579, lr_0 = 1.6483e-04
Validation rmse = 0.133360
Epoch 45
Loss = 9.2678e-02, PNorm = 35.5802, GNorm = 1.4965, lr_0 = 1.6103e-04
Loss = 1.0550e-01, PNorm = 35.5855, GNorm = 1.1197, lr_0 = 1.5731e-04
Validation rmse = 0.134433
Epoch 46
Loss = 9.8822e-02, PNorm = 35.5901, GNorm = 0.6822, lr_0 = 1.5368e-04
Loss = 1.0242e-01, PNorm = 35.5954, GNorm = 0.8657, lr_0 = 1.5013e-04
Validation rmse = 0.132978
Epoch 47
Loss = 9.0509e-02, PNorm = 35.6010, GNorm = 2.0709, lr_0 = 1.4667e-04
Validation rmse = 0.130497
Epoch 48
Loss = 1.0197e-01, PNorm = 35.6057, GNorm = 0.7720, lr_0 = 1.4328e-04
Loss = 9.6148e-02, PNorm = 35.6111, GNorm = 0.4957, lr_0 = 1.3997e-04
Validation rmse = 0.131681
Epoch 49
Loss = 1.0343e-01, PNorm = 35.6148, GNorm = 1.3627, lr_0 = 1.3674e-04
Loss = 9.4046e-02, PNorm = 35.6187, GNorm = 2.1082, lr_0 = 1.3359e-04
Validation rmse = 0.130819
Epoch 50
Loss = 8.7685e-02, PNorm = 35.6232, GNorm = 0.8268, lr_0 = 1.3050e-04
Loss = 9.5379e-02, PNorm = 35.6276, GNorm = 1.9192, lr_0 = 1.2749e-04
Validation rmse = 0.131036
Epoch 51
Loss = 9.4833e-02, PNorm = 35.6328, GNorm = 0.8416, lr_0 = 1.2426e-04
Loss = 9.2123e-02, PNorm = 35.6369, GNorm = 1.7511, lr_0 = 1.2139e-04
Validation rmse = 0.131799
Epoch 52
Loss = 9.1346e-02, PNorm = 35.6396, GNorm = 1.6545, lr_0 = 1.1859e-04
Validation rmse = 0.129997
Epoch 53
Loss = 1.0621e-01, PNorm = 35.6439, GNorm = 1.0680, lr_0 = 1.1585e-04
Loss = 9.2369e-02, PNorm = 35.6475, GNorm = 2.9526, lr_0 = 1.1318e-04
Validation rmse = 0.132541
Epoch 54
Loss = 1.0163e-01, PNorm = 35.6518, GNorm = 1.4767, lr_0 = 1.1056e-04
Loss = 8.7692e-02, PNorm = 35.6552, GNorm = 0.7021, lr_0 = 1.0801e-04
Validation rmse = 0.131318
Epoch 55
Loss = 8.7365e-02, PNorm = 35.6586, GNorm = 1.1168, lr_0 = 1.0552e-04
Loss = 9.2415e-02, PNorm = 35.6622, GNorm = 1.3126, lr_0 = 1.0308e-04
Validation rmse = 0.131171
Epoch 56
Loss = 8.4266e-02, PNorm = 35.6656, GNorm = 0.9077, lr_0 = 1.0070e-04
Loss = 9.9165e-02, PNorm = 35.6689, GNorm = 0.8745, lr_0 = 1.0000e-04
Validation rmse = 0.130693
Epoch 57
Loss = 1.0041e-01, PNorm = 35.6722, GNorm = 1.5981, lr_0 = 1.0000e-04
Validation rmse = 0.129757
Epoch 58
Loss = 8.6700e-02, PNorm = 35.6754, GNorm = 0.6184, lr_0 = 1.0000e-04
Loss = 9.4081e-02, PNorm = 35.6783, GNorm = 1.5658, lr_0 = 1.0000e-04
Validation rmse = 0.130776
Epoch 59
Loss = 9.2395e-02, PNorm = 35.6818, GNorm = 1.8898, lr_0 = 1.0000e-04
Loss = 9.0410e-02, PNorm = 35.6853, GNorm = 1.9569, lr_0 = 1.0000e-04
Validation rmse = 0.130225
Model 0 best validation rmse = 0.129757 on epoch 57
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.151490
Ensemble test rmse = 0.151490
1-fold cross validation
	Seed 0 ==> test rmse = 0.151490
Overall test rmse = 0.151490 +/- 0.000000
Elapsed time = 0:00:43
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,117 | train size = 888 | val size = 223 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1830e-01, PNorm = 34.0179, GNorm = 3.8171, lr_0 = 3.9118e-04
Validation rmse = 0.290229
Epoch 1
Loss = 7.0825e-01, PNorm = 34.0437, GNorm = 1.2271, lr_0 = 6.8235e-04
Loss = 5.9562e-01, PNorm = 34.1010, GNorm = 4.1697, lr_0 = 9.4706e-04
Validation rmse = 0.265887
Epoch 2
Loss = 4.5837e-01, PNorm = 34.1715, GNorm = 4.5062, lr_0 = 9.8149e-04
Loss = 4.2990e-01, PNorm = 34.2397, GNorm = 5.1637, lr_0 = 9.5884e-04
Validation rmse = 0.258148
Epoch 3
Loss = 3.7778e-01, PNorm = 34.2988, GNorm = 4.1078, lr_0 = 9.3670e-04
Loss = 3.3638e-01, PNorm = 34.3509, GNorm = 5.6298, lr_0 = 9.1508e-04
Validation rmse = 0.270618
Epoch 4
Loss = 3.6964e-01, PNorm = 34.3935, GNorm = 0.9077, lr_0 = 8.9396e-04
Validation rmse = 0.221763
Epoch 5
Loss = 3.6790e-01, PNorm = 34.4464, GNorm = 6.5374, lr_0 = 8.7129e-04
Loss = 3.8914e-01, PNorm = 34.4911, GNorm = 7.1480, lr_0 = 8.5118e-04
Validation rmse = 0.192496
Epoch 6
Loss = 2.1931e-01, PNorm = 34.5337, GNorm = 0.6621, lr_0 = 8.3153e-04
Loss = 2.2784e-01, PNorm = 34.5733, GNorm = 1.8882, lr_0 = 8.1234e-04
Validation rmse = 0.190927
Epoch 7
Loss = 1.8529e-01, PNorm = 34.6101, GNorm = 1.0406, lr_0 = 7.9359e-04
Loss = 1.9354e-01, PNorm = 34.6402, GNorm = 4.4185, lr_0 = 7.7527e-04
Validation rmse = 0.166894
Epoch 8
Loss = 1.8333e-01, PNorm = 34.6767, GNorm = 2.1217, lr_0 = 7.5737e-04
Validation rmse = 0.158170
Epoch 9
Loss = 1.6014e-01, PNorm = 34.7083, GNorm = 3.5675, lr_0 = 7.3817e-04
Loss = 1.5460e-01, PNorm = 34.7340, GNorm = 1.2249, lr_0 = 7.2113e-04
Validation rmse = 0.154129
Epoch 10
Loss = 1.8753e-01, PNorm = 34.7635, GNorm = 6.3974, lr_0 = 7.0448e-04
Loss = 2.3164e-01, PNorm = 34.7917, GNorm = 2.7672, lr_0 = 6.8822e-04
Validation rmse = 0.211377
Epoch 11
Loss = 2.1561e-01, PNorm = 34.8199, GNorm = 5.2916, lr_0 = 6.7234e-04
Loss = 1.6692e-01, PNorm = 34.8494, GNorm = 0.6111, lr_0 = 6.5682e-04
Validation rmse = 0.157038
Epoch 12
Loss = 1.3527e-01, PNorm = 34.8705, GNorm = 3.2228, lr_0 = 6.4166e-04
Loss = 1.5228e-01, PNorm = 34.8946, GNorm = 2.5882, lr_0 = 6.2685e-04
Loss = 1.6101e-01, PNorm = 34.8974, GNorm = 1.0155, lr_0 = 6.2538e-04
Validation rmse = 0.148781
Epoch 13
Loss = 1.3254e-01, PNorm = 34.9194, GNorm = 0.5404, lr_0 = 6.1095e-04
Validation rmse = 0.157120
Epoch 14
Loss = 1.3302e-01, PNorm = 34.9403, GNorm = 3.3175, lr_0 = 5.9685e-04
Loss = 1.4691e-01, PNorm = 34.9629, GNorm = 0.7595, lr_0 = 5.8307e-04
Validation rmse = 0.142372
Epoch 15
Loss = 1.3289e-01, PNorm = 34.9830, GNorm = 0.8155, lr_0 = 5.6961e-04
Loss = 1.3638e-01, PNorm = 34.9995, GNorm = 0.9818, lr_0 = 5.5646e-04
Validation rmse = 0.148047
Epoch 16
Loss = 1.3836e-01, PNorm = 35.0181, GNorm = 1.5380, lr_0 = 5.4362e-04
Loss = 1.2390e-01, PNorm = 35.0331, GNorm = 0.8698, lr_0 = 5.3107e-04
Validation rmse = 0.141129
Epoch 17
Loss = 1.2183e-01, PNorm = 35.0481, GNorm = 2.4137, lr_0 = 5.1760e-04
Validation rmse = 0.141298
Epoch 18
Loss = 1.4902e-01, PNorm = 35.0646, GNorm = 3.8510, lr_0 = 5.0565e-04
Loss = 1.1768e-01, PNorm = 35.0851, GNorm = 4.0827, lr_0 = 4.9398e-04
Validation rmse = 0.168290
Epoch 19
Loss = 1.1763e-01, PNorm = 35.1014, GNorm = 0.7568, lr_0 = 4.8258e-04
Loss = 1.2480e-01, PNorm = 35.1191, GNorm = 1.8285, lr_0 = 4.7144e-04
Validation rmse = 0.150160
Epoch 20
Loss = 1.1307e-01, PNorm = 35.1355, GNorm = 2.5295, lr_0 = 4.6056e-04
Loss = 1.2263e-01, PNorm = 35.1503, GNorm = 0.6747, lr_0 = 4.4993e-04
Validation rmse = 0.136715
Epoch 21
Loss = 1.2160e-01, PNorm = 35.1684, GNorm = 3.1523, lr_0 = 4.3852e-04
Loss = 1.2961e-01, PNorm = 35.1813, GNorm = 2.7148, lr_0 = 4.2840e-04
Validation rmse = 0.135220
Epoch 22
Loss = 1.0702e-01, PNorm = 35.1961, GNorm = 0.6241, lr_0 = 4.1851e-04
Validation rmse = 0.145467
Epoch 23
Loss = 1.3654e-01, PNorm = 35.2106, GNorm = 2.5296, lr_0 = 4.0885e-04
Loss = 1.1541e-01, PNorm = 35.2274, GNorm = 0.8251, lr_0 = 3.9941e-04
Validation rmse = 0.144318
Epoch 24
Loss = 7.9914e-02, PNorm = 35.2415, GNorm = 1.1509, lr_0 = 3.9019e-04
Loss = 1.2661e-01, PNorm = 35.2565, GNorm = 3.2033, lr_0 = 3.8119e-04
Validation rmse = 0.132774
Epoch 25
Loss = 1.0410e-01, PNorm = 35.2709, GNorm = 1.2715, lr_0 = 3.7239e-04
Loss = 1.2479e-01, PNorm = 35.2846, GNorm = 0.5427, lr_0 = 3.6379e-04
Validation rmse = 0.133275
Epoch 26
Loss = 1.3321e-01, PNorm = 35.3000, GNorm = 4.8492, lr_0 = 3.5456e-04
Validation rmse = 0.137299
Epoch 27
Loss = 1.0239e-01, PNorm = 35.3150, GNorm = 1.4505, lr_0 = 3.4638e-04
Loss = 1.0906e-01, PNorm = 35.3321, GNorm = 0.6302, lr_0 = 3.3839e-04
Validation rmse = 0.136776
Epoch 28
Loss = 1.0005e-01, PNorm = 35.3436, GNorm = 0.9129, lr_0 = 3.3057e-04
Loss = 1.0720e-01, PNorm = 35.3549, GNorm = 2.1053, lr_0 = 3.2294e-04
Validation rmse = 0.144106
Epoch 29
Loss = 1.0860e-01, PNorm = 35.3663, GNorm = 1.9048, lr_0 = 3.1549e-04
Loss = 1.0844e-01, PNorm = 35.3769, GNorm = 0.7242, lr_0 = 3.0821e-04
Validation rmse = 0.134360
Epoch 30
Loss = 1.0391e-01, PNorm = 35.3898, GNorm = 1.7560, lr_0 = 3.0039e-04
Loss = 1.0072e-01, PNorm = 35.3990, GNorm = 1.6031, lr_0 = 2.9346e-04
Validation rmse = 0.133008
Epoch 31
Loss = 1.0680e-01, PNorm = 35.4082, GNorm = 1.3097, lr_0 = 2.8668e-04
Validation rmse = 0.132763
Epoch 32
Loss = 9.8580e-02, PNorm = 35.4191, GNorm = 0.5566, lr_0 = 2.8007e-04
Loss = 9.8202e-02, PNorm = 35.4304, GNorm = 1.1866, lr_0 = 2.7360e-04
Validation rmse = 0.137195
Epoch 33
Loss = 9.8322e-02, PNorm = 35.4420, GNorm = 2.3011, lr_0 = 2.6729e-04
Loss = 9.0866e-02, PNorm = 35.4512, GNorm = 2.0523, lr_0 = 2.6112e-04
Validation rmse = 0.131616
Epoch 34
Loss = 9.4751e-02, PNorm = 35.4622, GNorm = 0.9690, lr_0 = 2.5450e-04
Loss = 8.9103e-02, PNorm = 35.4700, GNorm = 0.5248, lr_0 = 2.4862e-04
Validation rmse = 0.134159
Epoch 35
Loss = 9.5485e-02, PNorm = 35.4791, GNorm = 1.4417, lr_0 = 2.4288e-04
Validation rmse = 0.133910
Epoch 36
Loss = 1.1486e-01, PNorm = 35.4869, GNorm = 1.1634, lr_0 = 2.3728e-04
Loss = 9.2061e-02, PNorm = 35.4975, GNorm = 0.7506, lr_0 = 2.3180e-04
Validation rmse = 0.136463
Epoch 37
Loss = 9.9459e-02, PNorm = 35.5066, GNorm = 0.7716, lr_0 = 2.2645e-04
Loss = 9.4262e-02, PNorm = 35.5166, GNorm = 1.5367, lr_0 = 2.2122e-04
Validation rmse = 0.129734
Epoch 38
Loss = 9.0167e-02, PNorm = 35.5242, GNorm = 0.6912, lr_0 = 2.1561e-04
Loss = 9.3310e-02, PNorm = 35.5327, GNorm = 1.8450, lr_0 = 2.1063e-04
Validation rmse = 0.132063
Epoch 39
Loss = 1.0013e-01, PNorm = 35.5409, GNorm = 1.9078, lr_0 = 2.0577e-04
Loss = 8.3473e-02, PNorm = 35.5493, GNorm = 1.1077, lr_0 = 2.0102e-04
Validation rmse = 0.130963
Epoch 40
Loss = 8.5555e-02, PNorm = 35.5554, GNorm = 1.0642, lr_0 = 1.9638e-04
Validation rmse = 0.131058
Epoch 41
Loss = 7.6589e-02, PNorm = 35.5624, GNorm = 2.1430, lr_0 = 1.9185e-04
Loss = 8.8030e-02, PNorm = 35.5678, GNorm = 1.5544, lr_0 = 1.8742e-04
Validation rmse = 0.131821
Epoch 42
Loss = 9.5860e-02, PNorm = 35.5766, GNorm = 2.3839, lr_0 = 1.8267e-04
Loss = 8.4371e-02, PNorm = 35.5831, GNorm = 0.7327, lr_0 = 1.7845e-04
Validation rmse = 0.129978
Epoch 43
Loss = 9.3361e-02, PNorm = 35.5905, GNorm = 3.0902, lr_0 = 1.7433e-04
Loss = 9.1336e-02, PNorm = 35.5970, GNorm = 2.2509, lr_0 = 1.7031e-04
Validation rmse = 0.132964
Epoch 44
Loss = 8.0508e-02, PNorm = 35.6035, GNorm = 0.7920, lr_0 = 1.6638e-04
Validation rmse = 0.130760
Epoch 45
Loss = 7.5830e-02, PNorm = 35.6089, GNorm = 1.9499, lr_0 = 1.6254e-04
Loss = 9.2370e-02, PNorm = 35.6167, GNorm = 1.6886, lr_0 = 1.5879e-04
Validation rmse = 0.131670
Epoch 46
Loss = 9.2527e-02, PNorm = 35.6231, GNorm = 1.0732, lr_0 = 1.5476e-04
Loss = 8.3226e-02, PNorm = 35.6279, GNorm = 0.9610, lr_0 = 1.5119e-04
Validation rmse = 0.130528
Epoch 47
Loss = 9.0770e-02, PNorm = 35.6341, GNorm = 0.6619, lr_0 = 1.4770e-04
Loss = 8.3397e-02, PNorm = 35.6382, GNorm = 1.5838, lr_0 = 1.4429e-04
Validation rmse = 0.132208
Epoch 48
Loss = 9.3349e-02, PNorm = 35.6433, GNorm = 0.8480, lr_0 = 1.4096e-04
Loss = 7.9541e-02, PNorm = 35.6483, GNorm = 0.7303, lr_0 = 1.3770e-04
Validation rmse = 0.129769
Epoch 49
Loss = 8.2627e-02, PNorm = 35.6537, GNorm = 0.6170, lr_0 = 1.3453e-04
Validation rmse = 0.131382
Epoch 50
Loss = 7.7353e-02, PNorm = 35.6579, GNorm = 1.2791, lr_0 = 1.3142e-04
Loss = 7.7483e-02, PNorm = 35.6624, GNorm = 0.8345, lr_0 = 1.2839e-04
Validation rmse = 0.133382
Epoch 51
Loss = 8.8931e-02, PNorm = 35.6668, GNorm = 1.7576, lr_0 = 1.2513e-04
Loss = 8.6935e-02, PNorm = 35.6719, GNorm = 2.1137, lr_0 = 1.2224e-04
Validation rmse = 0.130542
Epoch 52
Loss = 7.5216e-02, PNorm = 35.6762, GNorm = 0.5667, lr_0 = 1.1942e-04
Loss = 8.8836e-02, PNorm = 35.6799, GNorm = 1.8343, lr_0 = 1.1666e-04
Validation rmse = 0.131840
Epoch 53
Loss = 8.4995e-02, PNorm = 35.6848, GNorm = 0.6336, lr_0 = 1.1397e-04
Validation rmse = 0.129858
Epoch 54
Loss = 8.6726e-02, PNorm = 35.6888, GNorm = 1.1507, lr_0 = 1.1134e-04
Loss = 7.4427e-02, PNorm = 35.6922, GNorm = 0.7262, lr_0 = 1.0877e-04
Validation rmse = 0.131221
Epoch 55
Loss = 8.0059e-02, PNorm = 35.6968, GNorm = 2.3190, lr_0 = 1.0601e-04
Loss = 8.4167e-02, PNorm = 35.6998, GNorm = 2.2627, lr_0 = 1.0356e-04
Validation rmse = 0.131008
Epoch 56
Loss = 8.2655e-02, PNorm = 35.7036, GNorm = 0.5881, lr_0 = 1.0117e-04
Loss = 8.1435e-02, PNorm = 35.7069, GNorm = 2.7840, lr_0 = 1.0000e-04
Validation rmse = 0.130064
Epoch 57
Loss = 7.6396e-02, PNorm = 35.7110, GNorm = 0.7392, lr_0 = 1.0000e-04
Loss = 8.2696e-02, PNorm = 35.7144, GNorm = 1.2808, lr_0 = 1.0000e-04
Validation rmse = 0.130707
Epoch 58
Loss = 8.0452e-02, PNorm = 35.7173, GNorm = 1.0751, lr_0 = 1.0000e-04
Validation rmse = 0.131762
Epoch 59
Loss = 8.0996e-02, PNorm = 35.7216, GNorm = 1.5402, lr_0 = 1.0000e-04
Loss = 8.3809e-02, PNorm = 35.7248, GNorm = 1.3739, lr_0 = 1.0000e-04
Validation rmse = 0.130369
Model 0 best validation rmse = 0.129734 on epoch 37
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.111605
Ensemble test rmse = 0.111605
1-fold cross validation
	Seed 0 ==> test rmse = 0.111605
Overall test rmse = 0.111605 +/- 0.000000
Elapsed time = 0:00:44
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,107 | train size = 880 | val size = 221 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.8175e-01, PNorm = 34.0148, GNorm = 6.2098, lr_0 = 3.9118e-04
Validation rmse = 0.300660
Epoch 1
Loss = 7.4802e-01, PNorm = 34.0393, GNorm = 1.0347, lr_0 = 6.8235e-04
Loss = 7.4887e-01, PNorm = 34.0838, GNorm = 1.9322, lr_0 = 9.4706e-04
Validation rmse = 0.255067
Epoch 2
Loss = 4.9374e-01, PNorm = 34.1526, GNorm = 3.2712, lr_0 = 9.8149e-04
Loss = 4.3806e-01, PNorm = 34.2301, GNorm = 4.8618, lr_0 = 9.5884e-04
Validation rmse = 0.254120
Epoch 3
Loss = 4.4386e-01, PNorm = 34.2938, GNorm = 2.4839, lr_0 = 9.3452e-04
Loss = 3.5908e-01, PNorm = 34.3470, GNorm = 6.5335, lr_0 = 9.1295e-04
Validation rmse = 0.198756
Epoch 4
Loss = 3.4026e-01, PNorm = 34.3917, GNorm = 2.3855, lr_0 = 8.9188e-04
Validation rmse = 0.188370
Epoch 5
Loss = 2.1273e-01, PNorm = 34.4384, GNorm = 1.2576, lr_0 = 8.7129e-04
Loss = 2.5035e-01, PNorm = 34.4916, GNorm = 2.0463, lr_0 = 8.5118e-04
Validation rmse = 0.172893
Epoch 6
Loss = 2.4219e-01, PNorm = 34.5419, GNorm = 4.8354, lr_0 = 8.2959e-04
Loss = 2.1893e-01, PNorm = 34.5812, GNorm = 0.8733, lr_0 = 8.1044e-04
Validation rmse = 0.164454
Epoch 7
Loss = 2.2048e-01, PNorm = 34.6173, GNorm = 0.9367, lr_0 = 7.9174e-04
Loss = 1.8211e-01, PNorm = 34.6523, GNorm = 1.8491, lr_0 = 7.7346e-04
Loss = 1.5243e-01, PNorm = 34.6561, GNorm = 2.8953, lr_0 = 7.7166e-04
Validation rmse = 0.153864
Epoch 8
Loss = 1.6333e-01, PNorm = 34.6894, GNorm = 2.7340, lr_0 = 7.5384e-04
Validation rmse = 0.153583
Epoch 9
Loss = 1.7464e-01, PNorm = 34.7238, GNorm = 7.0433, lr_0 = 7.3644e-04
Loss = 1.8253e-01, PNorm = 34.7530, GNorm = 5.9074, lr_0 = 7.1945e-04
Validation rmse = 0.153959
Epoch 10
Loss = 1.4171e-01, PNorm = 34.7831, GNorm = 4.7444, lr_0 = 7.0284e-04
Loss = 1.5471e-01, PNorm = 34.8062, GNorm = 4.3515, lr_0 = 6.8662e-04
Validation rmse = 0.140631
Epoch 11
Loss = 1.5285e-01, PNorm = 34.8353, GNorm = 1.3123, lr_0 = 6.6920e-04
Loss = 1.3432e-01, PNorm = 34.8609, GNorm = 2.1361, lr_0 = 6.5376e-04
Validation rmse = 0.137931
Epoch 12
Loss = 1.2269e-01, PNorm = 34.8839, GNorm = 1.0408, lr_0 = 6.3867e-04
Validation rmse = 0.136572
Epoch 13
Loss = 1.3161e-01, PNorm = 34.9045, GNorm = 0.5131, lr_0 = 6.2247e-04
Loss = 1.2785e-01, PNorm = 34.9246, GNorm = 1.1887, lr_0 = 6.0810e-04
Validation rmse = 0.133654
Epoch 14
Loss = 1.2852e-01, PNorm = 34.9431, GNorm = 1.8416, lr_0 = 5.9406e-04
Loss = 1.3385e-01, PNorm = 34.9633, GNorm = 4.6788, lr_0 = 5.8035e-04
Validation rmse = 0.136009
Epoch 15
Loss = 1.0133e-01, PNorm = 34.9795, GNorm = 1.1109, lr_0 = 5.6696e-04
Loss = 1.2940e-01, PNorm = 34.9977, GNorm = 1.5169, lr_0 = 5.5387e-04
Validation rmse = 0.135736
Epoch 16
Loss = 1.2750e-01, PNorm = 35.0129, GNorm = 1.4833, lr_0 = 5.3982e-04
Validation rmse = 0.131925
Epoch 17
Loss = 7.0594e-02, PNorm = 35.0319, GNorm = 1.6101, lr_0 = 5.2736e-04
Loss = 1.1525e-01, PNorm = 35.0471, GNorm = 1.2017, lr_0 = 5.1519e-04
Validation rmse = 0.131321
Epoch 18
Loss = 1.1996e-01, PNorm = 35.0646, GNorm = 1.6092, lr_0 = 5.0212e-04
Loss = 1.1134e-01, PNorm = 35.0790, GNorm = 2.6791, lr_0 = 4.9053e-04
Validation rmse = 0.130464
Epoch 19
Loss = 1.2052e-01, PNorm = 35.0947, GNorm = 2.0762, lr_0 = 4.7921e-04
Loss = 1.0987e-01, PNorm = 35.1096, GNorm = 0.9352, lr_0 = 4.6815e-04
Validation rmse = 0.132761
Epoch 20
Loss = 9.8031e-02, PNorm = 35.1248, GNorm = 0.7028, lr_0 = 4.5734e-04
Validation rmse = 0.154861
Epoch 21
Loss = 1.4866e-01, PNorm = 35.1368, GNorm = 6.2407, lr_0 = 4.4575e-04
Loss = 1.4306e-01, PNorm = 35.1529, GNorm = 3.3772, lr_0 = 4.3546e-04
Validation rmse = 0.145432
Epoch 22
Loss = 1.3430e-01, PNorm = 35.1672, GNorm = 2.1962, lr_0 = 4.2541e-04
Loss = 1.3034e-01, PNorm = 35.1823, GNorm = 3.4858, lr_0 = 4.1559e-04
Validation rmse = 0.135695
Epoch 23
Loss = 1.0935e-01, PNorm = 35.1945, GNorm = 1.4687, lr_0 = 4.0505e-04
Loss = 1.0176e-01, PNorm = 35.2076, GNorm = 0.8314, lr_0 = 3.9570e-04
Validation rmse = 0.131757
Epoch 24
Loss = 1.0249e-01, PNorm = 35.2176, GNorm = 2.3749, lr_0 = 3.8656e-04
Loss = 1.0354e-01, PNorm = 35.2304, GNorm = 1.7824, lr_0 = 3.7764e-04
Validation rmse = 0.131349
Epoch 25
Loss = 1.0325e-01, PNorm = 35.2427, GNorm = 2.3968, lr_0 = 3.6892e-04
Validation rmse = 0.130086
Epoch 26
Loss = 8.9063e-02, PNorm = 35.2543, GNorm = 1.5881, lr_0 = 3.5957e-04
Loss = 9.5575e-02, PNorm = 35.2644, GNorm = 0.9580, lr_0 = 3.5127e-04
Validation rmse = 0.129923
Epoch 27
Loss = 9.5010e-02, PNorm = 35.2730, GNorm = 0.7789, lr_0 = 3.4316e-04
Loss = 1.0490e-01, PNorm = 35.2853, GNorm = 1.4246, lr_0 = 3.3524e-04
Validation rmse = 0.129346
Epoch 28
Loss = 9.1443e-02, PNorm = 35.2937, GNorm = 2.4896, lr_0 = 3.2674e-04
Loss = 9.5850e-02, PNorm = 35.3034, GNorm = 1.6910, lr_0 = 3.1920e-04
Validation rmse = 0.129936
Epoch 29
Loss = 9.4971e-02, PNorm = 35.3137, GNorm = 2.3632, lr_0 = 3.1183e-04
Validation rmse = 0.130911
Epoch 30
Loss = 9.8568e-02, PNorm = 35.3231, GNorm = 0.7611, lr_0 = 3.0463e-04
Loss = 1.0152e-01, PNorm = 35.3310, GNorm = 0.6275, lr_0 = 2.9760e-04
Validation rmse = 0.127522
Epoch 31
Loss = 8.7962e-02, PNorm = 35.3399, GNorm = 1.3880, lr_0 = 2.9005e-04
Loss = 8.8422e-02, PNorm = 35.3484, GNorm = 0.9408, lr_0 = 2.8336e-04
Validation rmse = 0.129723
Epoch 32
Loss = 8.5769e-02, PNorm = 35.3556, GNorm = 0.8916, lr_0 = 2.7682e-04
Loss = 9.2531e-02, PNorm = 35.3638, GNorm = 0.8655, lr_0 = 2.7043e-04
Loss = 5.9281e-02, PNorm = 35.3647, GNorm = 0.7147, lr_0 = 2.6980e-04
Validation rmse = 0.136561
Epoch 33
Loss = 9.5497e-02, PNorm = 35.3720, GNorm = 2.5160, lr_0 = 2.6357e-04
Validation rmse = 0.128832
Epoch 34
Loss = 1.1248e-01, PNorm = 35.3805, GNorm = 2.2169, lr_0 = 2.5748e-04
Loss = 8.5053e-02, PNorm = 35.3883, GNorm = 1.2110, lr_0 = 2.5154e-04
Validation rmse = 0.131043
Epoch 35
Loss = 8.4876e-02, PNorm = 35.3949, GNorm = 0.6189, lr_0 = 2.4573e-04
Loss = 9.7013e-02, PNorm = 35.4024, GNorm = 1.9069, lr_0 = 2.4006e-04
Validation rmse = 0.132990
Epoch 36
Loss = 9.0992e-02, PNorm = 35.4105, GNorm = 0.8332, lr_0 = 2.3397e-04
Loss = 8.5839e-02, PNorm = 35.4175, GNorm = 1.5748, lr_0 = 2.2857e-04
Validation rmse = 0.130537
Epoch 37
Loss = 8.5746e-02, PNorm = 35.4246, GNorm = 0.6790, lr_0 = 2.2330e-04
Validation rmse = 0.128827
Epoch 38
Loss = 1.0394e-01, PNorm = 35.4316, GNorm = 0.8562, lr_0 = 2.1763e-04
Loss = 7.9224e-02, PNorm = 35.4383, GNorm = 1.1876, lr_0 = 2.1261e-04
Validation rmse = 0.130421
Epoch 39
Loss = 9.5173e-02, PNorm = 35.4444, GNorm = 1.6458, lr_0 = 2.0770e-04
Loss = 7.9419e-02, PNorm = 35.4513, GNorm = 0.6383, lr_0 = 2.0291e-04
Validation rmse = 0.129876
Epoch 40
Loss = 8.7368e-02, PNorm = 35.4571, GNorm = 2.0423, lr_0 = 1.9823e-04
Loss = 8.0654e-02, PNorm = 35.4629, GNorm = 1.9150, lr_0 = 1.9365e-04
Validation rmse = 0.130872
Epoch 41
Loss = 8.4667e-02, PNorm = 35.4684, GNorm = 1.5126, lr_0 = 1.8874e-04
Validation rmse = 0.128970
Epoch 42
Loss = 6.8869e-02, PNorm = 35.4739, GNorm = 1.2347, lr_0 = 1.8438e-04
Loss = 7.6242e-02, PNorm = 35.4787, GNorm = 0.7768, lr_0 = 1.8013e-04
Validation rmse = 0.128957
Epoch 43
Loss = 7.7205e-02, PNorm = 35.4851, GNorm = 0.8086, lr_0 = 1.7556e-04
Loss = 8.5862e-02, PNorm = 35.4911, GNorm = 0.7958, lr_0 = 1.7151e-04
Validation rmse = 0.129831
Epoch 44
Loss = 7.2161e-02, PNorm = 35.4973, GNorm = 1.7321, lr_0 = 1.6755e-04
Loss = 8.4595e-02, PNorm = 35.5022, GNorm = 0.7030, lr_0 = 1.6368e-04
Validation rmse = 0.130640
Epoch 45
Loss = 8.4349e-02, PNorm = 35.5066, GNorm = 0.7941, lr_0 = 1.5990e-04
Validation rmse = 0.131649
Epoch 46
Loss = 1.0165e-01, PNorm = 35.5122, GNorm = 1.8308, lr_0 = 1.5585e-04
Loss = 7.4923e-02, PNorm = 35.5181, GNorm = 0.8040, lr_0 = 1.5225e-04
Validation rmse = 0.132095
Epoch 47
Loss = 9.0857e-02, PNorm = 35.5228, GNorm = 0.5764, lr_0 = 1.4874e-04
Loss = 7.4674e-02, PNorm = 35.5268, GNorm = 0.7136, lr_0 = 1.4530e-04
Validation rmse = 0.128639
Epoch 48
Loss = 8.3075e-02, PNorm = 35.5316, GNorm = 0.5535, lr_0 = 1.4162e-04
Loss = 7.6477e-02, PNorm = 35.5353, GNorm = 1.8794, lr_0 = 1.3835e-04
Validation rmse = 0.128825
Epoch 49
Loss = 8.0661e-02, PNorm = 35.5389, GNorm = 0.4304, lr_0 = 1.3515e-04
Loss = 7.7382e-02, PNorm = 35.5436, GNorm = 4.8530, lr_0 = 1.3204e-04
Validation rmse = 0.130994
Epoch 50
Loss = 8.5179e-02, PNorm = 35.5472, GNorm = 2.7957, lr_0 = 1.2899e-04
Validation rmse = 0.128575
Epoch 51
Loss = 7.4142e-02, PNorm = 35.5504, GNorm = 2.0716, lr_0 = 1.2572e-04
Loss = 8.2122e-02, PNorm = 35.5555, GNorm = 0.6423, lr_0 = 1.2281e-04
Validation rmse = 0.129456
Epoch 52
Loss = 6.3829e-02, PNorm = 35.5582, GNorm = 1.1472, lr_0 = 1.1998e-04
Loss = 8.2490e-02, PNorm = 35.5625, GNorm = 1.1220, lr_0 = 1.1721e-04
Validation rmse = 0.130845
Epoch 53
Loss = 8.4882e-02, PNorm = 35.5665, GNorm = 1.4874, lr_0 = 1.1424e-04
Loss = 7.8781e-02, PNorm = 35.5689, GNorm = 3.4719, lr_0 = 1.1160e-04
Validation rmse = 0.134794
Epoch 54
Loss = 7.8710e-02, PNorm = 35.5732, GNorm = 0.8462, lr_0 = 1.0902e-04
Validation rmse = 0.128819
Epoch 55
Loss = 9.8544e-02, PNorm = 35.5759, GNorm = 2.3124, lr_0 = 1.0651e-04
Loss = 7.1234e-02, PNorm = 35.5793, GNorm = 0.8619, lr_0 = 1.0405e-04
Validation rmse = 0.130654
Epoch 56
Loss = 6.6591e-02, PNorm = 35.5818, GNorm = 0.5850, lr_0 = 1.0141e-04
Loss = 7.7729e-02, PNorm = 35.5846, GNorm = 1.0744, lr_0 = 1.0000e-04
Validation rmse = 0.129133
Epoch 57
Loss = 7.0463e-02, PNorm = 35.5871, GNorm = 2.0615, lr_0 = 1.0000e-04
Loss = 7.9696e-02, PNorm = 35.5904, GNorm = 0.8890, lr_0 = 1.0000e-04
Loss = 6.6950e-02, PNorm = 35.5907, GNorm = 1.2973, lr_0 = 1.0000e-04
Validation rmse = 0.129207
Epoch 58
Loss = 7.2805e-02, PNorm = 35.5938, GNorm = 0.8617, lr_0 = 1.0000e-04
Validation rmse = 0.128933
Epoch 59
Loss = 6.7768e-02, PNorm = 35.5961, GNorm = 1.6867, lr_0 = 1.0000e-04
Loss = 6.8489e-02, PNorm = 35.5993, GNorm = 0.5324, lr_0 = 1.0000e-04
Validation rmse = 0.132077
Model 0 best validation rmse = 0.127522 on epoch 30
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.106565
Ensemble test rmse = 0.106565
1-fold cross validation
	Seed 0 ==> test rmse = 0.106565
Overall test rmse = 0.106565 +/- 0.000000
Elapsed time = 0:00:44
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,097 | train size = 872 | val size = 219 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.3816e-01, PNorm = 34.0168, GNorm = 1.9132, lr_0 = 3.9118e-04
Validation rmse = 0.276695
Epoch 1
Loss = 6.5726e-01, PNorm = 34.0437, GNorm = 4.4026, lr_0 = 6.8235e-04
Loss = 7.1471e-01, PNorm = 34.0889, GNorm = 10.1958, lr_0 = 9.4706e-04
Validation rmse = 0.233110
Epoch 2
Loss = 5.2159e-01, PNorm = 34.1634, GNorm = 1.2363, lr_0 = 9.7920e-04
Loss = 4.8186e-01, PNorm = 34.2302, GNorm = 1.5778, lr_0 = 9.5660e-04
Validation rmse = 0.196943
Epoch 3
Loss = 3.7361e-01, PNorm = 34.2960, GNorm = 6.3142, lr_0 = 9.3452e-04
Validation rmse = 0.177106
Epoch 4
Loss = 3.1077e-01, PNorm = 34.3610, GNorm = 1.4472, lr_0 = 9.1082e-04
Loss = 2.9829e-01, PNorm = 34.4183, GNorm = 2.9126, lr_0 = 8.8980e-04
Validation rmse = 0.185620
Epoch 5
Loss = 3.0559e-01, PNorm = 34.4658, GNorm = 2.7033, lr_0 = 8.6926e-04
Loss = 2.7273e-01, PNorm = 34.5183, GNorm = 1.2031, lr_0 = 8.4919e-04
Validation rmse = 0.189973
Epoch 6
Loss = 2.3013e-01, PNorm = 34.5712, GNorm = 1.4301, lr_0 = 8.2766e-04
Loss = 2.4004e-01, PNorm = 34.6166, GNorm = 0.5335, lr_0 = 8.0855e-04
Validation rmse = 0.144340
Epoch 7
Loss = 2.1250e-01, PNorm = 34.6587, GNorm = 2.3954, lr_0 = 7.8989e-04
Validation rmse = 0.139367
Epoch 8
Loss = 1.8866e-01, PNorm = 34.7022, GNorm = 3.2612, lr_0 = 7.6986e-04
Loss = 2.1626e-01, PNorm = 34.7381, GNorm = 1.9011, lr_0 = 7.5209e-04
Validation rmse = 0.130869
Epoch 9
Loss = 1.7785e-01, PNorm = 34.7757, GNorm = 1.7533, lr_0 = 7.3301e-04
Loss = 1.5431e-01, PNorm = 34.8067, GNorm = 1.3655, lr_0 = 7.1609e-04
Validation rmse = 0.129112
Epoch 10
Loss = 1.3813e-01, PNorm = 34.8376, GNorm = 2.7320, lr_0 = 6.9956e-04
Loss = 1.5074e-01, PNorm = 34.8658, GNorm = 1.7994, lr_0 = 6.8342e-04
Validation rmse = 0.125934
Epoch 11
Loss = 1.3915e-01, PNorm = 34.8930, GNorm = 0.9958, lr_0 = 6.6608e-04
Validation rmse = 0.148263
Epoch 12
Loss = 1.7825e-01, PNorm = 34.9201, GNorm = 3.7987, lr_0 = 6.5071e-04
Loss = 1.5432e-01, PNorm = 34.9435, GNorm = 1.0833, lr_0 = 6.3569e-04
Validation rmse = 0.143542
Epoch 13
Loss = 1.5691e-01, PNorm = 34.9727, GNorm = 2.4333, lr_0 = 6.1957e-04
Loss = 1.2347e-01, PNorm = 34.9979, GNorm = 1.5374, lr_0 = 6.0527e-04
Validation rmse = 0.123970
Epoch 14
Loss = 1.2550e-01, PNorm = 35.0194, GNorm = 0.9168, lr_0 = 5.9130e-04
Loss = 1.2335e-01, PNorm = 35.0413, GNorm = 1.5391, lr_0 = 5.7765e-04
Validation rmse = 0.120459
Epoch 15
Loss = 1.1084e-01, PNorm = 35.0610, GNorm = 3.3647, lr_0 = 5.6300e-04
Validation rmse = 0.125666
Epoch 16
Loss = 1.1567e-01, PNorm = 35.0798, GNorm = 2.1427, lr_0 = 5.5000e-04
Loss = 1.1940e-01, PNorm = 35.0965, GNorm = 4.6735, lr_0 = 5.3731e-04
Validation rmse = 0.130139
Epoch 17
Loss = 1.2229e-01, PNorm = 35.1135, GNorm = 1.3965, lr_0 = 5.2368e-04
Loss = 1.0451e-01, PNorm = 35.1343, GNorm = 2.4099, lr_0 = 5.1159e-04
Validation rmse = 0.124860
Epoch 18
Loss = 1.3774e-01, PNorm = 35.1544, GNorm = 1.7131, lr_0 = 4.9862e-04
Loss = 1.2887e-01, PNorm = 35.1745, GNorm = 4.7073, lr_0 = 4.8711e-04
Validation rmse = 0.126027
Epoch 19
Loss = 1.2086e-01, PNorm = 35.1938, GNorm = 0.6431, lr_0 = 4.7587e-04
Validation rmse = 0.118886
Epoch 20
Loss = 9.3799e-02, PNorm = 35.2108, GNorm = 0.6926, lr_0 = 4.6380e-04
Loss = 1.1038e-01, PNorm = 35.2259, GNorm = 4.0836, lr_0 = 4.5309e-04
Validation rmse = 0.120276
Epoch 21
Loss = 8.7762e-02, PNorm = 35.2409, GNorm = 0.8466, lr_0 = 4.4263e-04
Loss = 1.1144e-01, PNorm = 35.2528, GNorm = 2.5360, lr_0 = 4.3242e-04
Validation rmse = 0.118345
Epoch 22
Loss = 1.0069e-01, PNorm = 35.2698, GNorm = 1.5328, lr_0 = 4.2145e-04
Loss = 9.4923e-02, PNorm = 35.2850, GNorm = 0.4644, lr_0 = 4.1172e-04
Validation rmse = 0.118289
Epoch 23
Loss = 1.0801e-01, PNorm = 35.2987, GNorm = 1.5950, lr_0 = 4.0222e-04
Validation rmse = 0.118433
Epoch 24
Loss = 1.0467e-01, PNorm = 35.3133, GNorm = 1.1239, lr_0 = 3.9202e-04
Loss = 8.9026e-02, PNorm = 35.3298, GNorm = 1.4319, lr_0 = 3.8297e-04
Validation rmse = 0.117037
Epoch 25
Loss = 9.1921e-02, PNorm = 35.3407, GNorm = 1.0599, lr_0 = 3.7413e-04
Loss = 9.0584e-02, PNorm = 35.3530, GNorm = 0.7654, lr_0 = 3.6549e-04
Validation rmse = 0.116878
Epoch 26
Loss = 8.5303e-02, PNorm = 35.3675, GNorm = 1.2680, lr_0 = 3.5622e-04
Loss = 9.4464e-02, PNorm = 35.3784, GNorm = 0.8066, lr_0 = 3.4800e-04
Loss = 8.9079e-02, PNorm = 35.3797, GNorm = 1.4970, lr_0 = 3.4719e-04
Validation rmse = 0.119065
Epoch 27
Loss = 8.6764e-02, PNorm = 35.3930, GNorm = 3.3095, lr_0 = 3.3918e-04
Validation rmse = 0.120081
Epoch 28
Loss = 9.0192e-02, PNorm = 35.4042, GNorm = 1.0378, lr_0 = 3.3135e-04
Loss = 9.2985e-02, PNorm = 35.4151, GNorm = 2.4476, lr_0 = 3.2370e-04
Validation rmse = 0.117976
Epoch 29
Loss = 7.3522e-02, PNorm = 35.4261, GNorm = 0.6912, lr_0 = 3.1549e-04
Loss = 9.2635e-02, PNorm = 35.4370, GNorm = 1.3447, lr_0 = 3.0821e-04
Validation rmse = 0.121141
Epoch 30
Loss = 9.3685e-02, PNorm = 35.4481, GNorm = 0.6527, lr_0 = 3.0109e-04
Loss = 8.1471e-02, PNorm = 35.4579, GNorm = 1.6387, lr_0 = 2.9414e-04
Loss = 8.4326e-02, PNorm = 35.4592, GNorm = 3.6918, lr_0 = 2.9346e-04
Validation rmse = 0.120930
Epoch 31
Loss = 8.8981e-02, PNorm = 35.4698, GNorm = 0.9960, lr_0 = 2.8668e-04
Validation rmse = 0.120926
Epoch 32
Loss = 5.5665e-02, PNorm = 35.4802, GNorm = 2.6434, lr_0 = 2.8007e-04
Loss = 8.9297e-02, PNorm = 35.4924, GNorm = 2.6045, lr_0 = 2.7360e-04
Validation rmse = 0.117129
Epoch 33
Loss = 8.1612e-02, PNorm = 35.5052, GNorm = 0.6463, lr_0 = 2.6666e-04
Loss = 8.6465e-02, PNorm = 35.5154, GNorm = 1.1234, lr_0 = 2.6051e-04
Validation rmse = 0.117152
Epoch 34
Loss = 8.1293e-02, PNorm = 35.5243, GNorm = 0.6284, lr_0 = 2.5390e-04
Loss = 8.5511e-02, PNorm = 35.5331, GNorm = 1.9145, lr_0 = 2.4804e-04
Validation rmse = 0.116449
Epoch 35
Loss = 8.2417e-02, PNorm = 35.5423, GNorm = 0.5067, lr_0 = 2.4232e-04
Validation rmse = 0.117121
Epoch 36
Loss = 9.4258e-02, PNorm = 35.5507, GNorm = 1.5752, lr_0 = 2.3617e-04
Loss = 7.6654e-02, PNorm = 35.5586, GNorm = 1.0245, lr_0 = 2.3072e-04
Validation rmse = 0.116692
Epoch 37
Loss = 8.4748e-02, PNorm = 35.5667, GNorm = 2.1209, lr_0 = 2.2539e-04
Loss = 7.9902e-02, PNorm = 35.5751, GNorm = 1.2002, lr_0 = 2.2019e-04
Validation rmse = 0.116960
Epoch 38
Loss = 7.5921e-02, PNorm = 35.5833, GNorm = 1.7125, lr_0 = 2.1461e-04
Loss = 7.8942e-02, PNorm = 35.5892, GNorm = 1.2141, lr_0 = 2.0965e-04
Validation rmse = 0.116469
Epoch 39
Loss = 7.9145e-02, PNorm = 35.5976, GNorm = 2.2701, lr_0 = 2.0481e-04
Validation rmse = 0.116866
Epoch 40
Loss = 9.4573e-02, PNorm = 35.6042, GNorm = 0.7958, lr_0 = 1.9962e-04
Loss = 7.2306e-02, PNorm = 35.6102, GNorm = 1.8427, lr_0 = 1.9501e-04
Validation rmse = 0.117643
Epoch 41
Loss = 8.1443e-02, PNorm = 35.6172, GNorm = 1.0269, lr_0 = 1.9051e-04
Loss = 7.5211e-02, PNorm = 35.6251, GNorm = 2.1485, lr_0 = 1.8611e-04
Validation rmse = 0.118249
Epoch 42
Loss = 6.8744e-02, PNorm = 35.6318, GNorm = 1.0553, lr_0 = 1.8139e-04
Validation rmse = 0.117168
Epoch 43
Loss = 8.1571e-02, PNorm = 35.6395, GNorm = 0.5955, lr_0 = 1.7679e-04
Loss = 7.9115e-02, PNorm = 35.6446, GNorm = 0.6362, lr_0 = 1.7271e-04
Validation rmse = 0.118768
Epoch 44
Loss = 7.9745e-02, PNorm = 35.6514, GNorm = 0.5100, lr_0 = 1.6873e-04
Loss = 7.2648e-02, PNorm = 35.6584, GNorm = 0.8315, lr_0 = 1.6483e-04
Validation rmse = 0.117775
Epoch 45
Loss = 7.4231e-02, PNorm = 35.6620, GNorm = 1.1121, lr_0 = 1.6065e-04
Loss = 7.7211e-02, PNorm = 35.6673, GNorm = 0.7027, lr_0 = 1.5694e-04
Validation rmse = 0.116963
Epoch 46
Loss = 8.7014e-02, PNorm = 35.6730, GNorm = 2.7963, lr_0 = 1.5332e-04
Validation rmse = 0.117078
Epoch 47
Loss = 8.5696e-02, PNorm = 35.6790, GNorm = 2.8483, lr_0 = 1.4943e-04
Loss = 7.7670e-02, PNorm = 35.6849, GNorm = 2.2186, lr_0 = 1.4598e-04
Validation rmse = 0.116326
Epoch 48
Loss = 7.8435e-02, PNorm = 35.6901, GNorm = 2.1137, lr_0 = 1.4261e-04
Loss = 7.5314e-02, PNorm = 35.6956, GNorm = 2.7403, lr_0 = 1.3932e-04
Validation rmse = 0.118644
Epoch 49
Loss = 7.3669e-02, PNorm = 35.7003, GNorm = 1.8917, lr_0 = 1.3579e-04
Loss = 7.7912e-02, PNorm = 35.7062, GNorm = 4.6226, lr_0 = 1.3265e-04
Validation rmse = 0.116291
Epoch 50
Loss = 7.2599e-02, PNorm = 35.7101, GNorm = 1.0968, lr_0 = 1.2959e-04
Validation rmse = 0.116834
Epoch 51
Loss = 7.4568e-02, PNorm = 35.7146, GNorm = 0.9038, lr_0 = 1.2630e-04
Loss = 6.7945e-02, PNorm = 35.7191, GNorm = 1.4118, lr_0 = 1.2339e-04
Validation rmse = 0.116691
Epoch 52
Loss = 5.6525e-02, PNorm = 35.7235, GNorm = 1.6897, lr_0 = 1.2026e-04
Loss = 7.4001e-02, PNorm = 35.7283, GNorm = 0.5567, lr_0 = 1.1748e-04
Validation rmse = 0.117404
Epoch 53
Loss = 6.5599e-02, PNorm = 35.7321, GNorm = 1.2397, lr_0 = 1.1477e-04
Loss = 7.6528e-02, PNorm = 35.7364, GNorm = 1.8806, lr_0 = 1.1212e-04
Validation rmse = 0.116231
Epoch 54
Loss = 7.3304e-02, PNorm = 35.7401, GNorm = 1.4158, lr_0 = 1.0928e-04
Validation rmse = 0.117235
Epoch 55
Loss = 6.9432e-02, PNorm = 35.7440, GNorm = 0.8708, lr_0 = 1.0676e-04
Loss = 7.6187e-02, PNorm = 35.7483, GNorm = 1.4427, lr_0 = 1.0429e-04
Validation rmse = 0.116132
Epoch 56
Loss = 6.3941e-02, PNorm = 35.7511, GNorm = 1.2425, lr_0 = 1.0165e-04
Loss = 7.3276e-02, PNorm = 35.7544, GNorm = 0.6293, lr_0 = 1.0000e-04
Validation rmse = 0.119030
Epoch 57
Loss = 7.9612e-02, PNorm = 35.7581, GNorm = 0.6835, lr_0 = 1.0000e-04
Loss = 6.7099e-02, PNorm = 35.7618, GNorm = 1.1375, lr_0 = 1.0000e-04
Validation rmse = 0.117889
Epoch 58
Loss = 6.6763e-02, PNorm = 35.7655, GNorm = 0.8260, lr_0 = 1.0000e-04
Validation rmse = 0.116288
Epoch 59
Loss = 7.0967e-02, PNorm = 35.7685, GNorm = 1.8704, lr_0 = 1.0000e-04
Loss = 6.7098e-02, PNorm = 35.7720, GNorm = 0.7509, lr_0 = 1.0000e-04
Validation rmse = 0.118101
Model 0 best validation rmse = 0.116132 on epoch 55
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.089382
Ensemble test rmse = 0.089382
1-fold cross validation
	Seed 0 ==> test rmse = 0.089382
Overall test rmse = 0.089382 +/- 0.000000
Elapsed time = 0:00:41
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,087 | train size = 864 | val size = 217 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.2650e-01, PNorm = 34.0173, GNorm = 1.3807, lr_0 = 3.9118e-04
Validation rmse = 0.286992
Epoch 1
Loss = 5.7958e-01, PNorm = 34.0507, GNorm = 10.1248, lr_0 = 6.8235e-04
Loss = 6.7228e-01, PNorm = 34.0871, GNorm = 6.3748, lr_0 = 9.4706e-04
Validation rmse = 0.274497
Epoch 2
Loss = 5.4012e-01, PNorm = 34.1596, GNorm = 0.9385, lr_0 = 9.7920e-04
Loss = 4.4942e-01, PNorm = 34.2237, GNorm = 5.1606, lr_0 = 9.5660e-04
Validation rmse = 0.231018
Epoch 3
Loss = 3.7352e-01, PNorm = 34.2872, GNorm = 5.3542, lr_0 = 9.3234e-04
Validation rmse = 0.212766
Epoch 4
Loss = 3.5376e-01, PNorm = 34.3479, GNorm = 4.6438, lr_0 = 9.1082e-04
Loss = 3.0095e-01, PNorm = 34.3948, GNorm = 0.9036, lr_0 = 8.8980e-04
Validation rmse = 0.179801
Epoch 5
Loss = 2.2938e-01, PNorm = 34.4435, GNorm = 2.6434, lr_0 = 8.6723e-04
Loss = 2.4793e-01, PNorm = 34.4871, GNorm = 1.6150, lr_0 = 8.4721e-04
Validation rmse = 0.172315
Epoch 6
Loss = 2.0466e-01, PNorm = 34.5351, GNorm = 3.1308, lr_0 = 8.2573e-04
Loss = 2.3411e-01, PNorm = 34.5764, GNorm = 1.3399, lr_0 = 8.0667e-04
Loss = 1.2075e-01, PNorm = 34.5813, GNorm = 1.6522, lr_0 = 8.0478e-04
Validation rmse = 0.195229
Epoch 7
Loss = 2.2058e-01, PNorm = 34.6215, GNorm = 1.6398, lr_0 = 7.8621e-04
Validation rmse = 0.155345
Epoch 8
Loss = 1.6646e-01, PNorm = 34.6638, GNorm = 2.6793, lr_0 = 7.6806e-04
Loss = 1.6883e-01, PNorm = 34.6999, GNorm = 3.3172, lr_0 = 7.5033e-04
Validation rmse = 0.153695
Epoch 9
Loss = 1.7046e-01, PNorm = 34.7374, GNorm = 0.9730, lr_0 = 7.3130e-04
Loss = 1.4518e-01, PNorm = 34.7714, GNorm = 2.8853, lr_0 = 7.1442e-04
Validation rmse = 0.140654
Epoch 10
Loss = 1.3022e-01, PNorm = 34.8068, GNorm = 0.9284, lr_0 = 6.9630e-04
Loss = 1.4975e-01, PNorm = 34.8378, GNorm = 1.4363, lr_0 = 6.8023e-04
Validation rmse = 0.181003
Epoch 11
Loss = 1.8483e-01, PNorm = 34.8627, GNorm = 0.7851, lr_0 = 6.6453e-04
Validation rmse = 0.133445
Epoch 12
Loss = 1.3764e-01, PNorm = 34.8933, GNorm = 3.5976, lr_0 = 6.4768e-04
Loss = 1.2985e-01, PNorm = 34.9164, GNorm = 2.8289, lr_0 = 6.3273e-04
Validation rmse = 0.130855
Epoch 13
Loss = 1.2503e-01, PNorm = 34.9399, GNorm = 3.3365, lr_0 = 6.1668e-04
Loss = 1.1618e-01, PNorm = 34.9650, GNorm = 1.2271, lr_0 = 6.0245e-04
Validation rmse = 0.130442
Epoch 14
Loss = 1.2089e-01, PNorm = 34.9841, GNorm = 1.6194, lr_0 = 5.8717e-04
Validation rmse = 0.134041
Epoch 15
Loss = 8.4738e-02, PNorm = 35.0015, GNorm = 2.4103, lr_0 = 5.7362e-04
Loss = 1.1398e-01, PNorm = 35.0243, GNorm = 2.8310, lr_0 = 5.6037e-04
Validation rmse = 0.124735
Epoch 16
Loss = 8.7320e-02, PNorm = 35.0440, GNorm = 1.1169, lr_0 = 5.4616e-04
Loss = 1.2019e-01, PNorm = 35.0630, GNorm = 4.8453, lr_0 = 5.3356e-04
Validation rmse = 0.124460
Epoch 17
Loss = 1.0767e-01, PNorm = 35.0827, GNorm = 3.4031, lr_0 = 5.2003e-04
Loss = 1.0715e-01, PNorm = 35.1015, GNorm = 2.3296, lr_0 = 5.0802e-04
Validation rmse = 0.124586
Epoch 18
Loss = 1.0413e-01, PNorm = 35.1170, GNorm = 4.1136, lr_0 = 4.9630e-04
Validation rmse = 0.140724
Epoch 19
Loss = 1.2507e-01, PNorm = 35.1378, GNorm = 2.9529, lr_0 = 4.8371e-04
Loss = 9.9327e-02, PNorm = 35.1550, GNorm = 0.6007, lr_0 = 4.7254e-04
Validation rmse = 0.123619
Epoch 20
Loss = 9.6935e-02, PNorm = 35.1737, GNorm = 0.9358, lr_0 = 4.6056e-04
Loss = 1.0196e-01, PNorm = 35.1891, GNorm = 1.6259, lr_0 = 4.4993e-04
Validation rmse = 0.129485
Epoch 21
Loss = 1.0134e-01, PNorm = 35.2084, GNorm = 0.5756, lr_0 = 4.3852e-04
Loss = 9.4621e-02, PNorm = 35.2215, GNorm = 3.8756, lr_0 = 4.2840e-04
Validation rmse = 0.121684
Epoch 22
Loss = 9.9982e-02, PNorm = 35.2338, GNorm = 3.6218, lr_0 = 4.1851e-04
Validation rmse = 0.134527
Epoch 23
Loss = 1.2176e-01, PNorm = 35.2483, GNorm = 3.0350, lr_0 = 4.0789e-04
Loss = 9.8430e-02, PNorm = 35.2609, GNorm = 1.1517, lr_0 = 3.9848e-04
Validation rmse = 0.129882
Epoch 24
Loss = 9.9491e-02, PNorm = 35.2751, GNorm = 1.7403, lr_0 = 3.8837e-04
Loss = 8.7858e-02, PNorm = 35.2895, GNorm = 2.0919, lr_0 = 3.7941e-04
Validation rmse = 0.136994
Epoch 25
Loss = 9.5342e-02, PNorm = 35.3021, GNorm = 2.0089, lr_0 = 3.7065e-04
Validation rmse = 0.132668
Epoch 26
Loss = 1.1601e-01, PNorm = 35.3156, GNorm = 3.5085, lr_0 = 3.6125e-04
Loss = 1.0299e-01, PNorm = 35.3251, GNorm = 1.1512, lr_0 = 3.5291e-04
Validation rmse = 0.122056
Epoch 27
Loss = 9.6784e-02, PNorm = 35.3393, GNorm = 1.0863, lr_0 = 3.4396e-04
Loss = 7.9584e-02, PNorm = 35.3510, GNorm = 0.7813, lr_0 = 3.3602e-04
Validation rmse = 0.120249
Epoch 28
Loss = 7.4309e-02, PNorm = 35.3622, GNorm = 0.4948, lr_0 = 3.2750e-04
Loss = 8.6988e-02, PNorm = 35.3734, GNorm = 0.8110, lr_0 = 3.1994e-04
Validation rmse = 0.119131
Epoch 29
Loss = 7.4687e-02, PNorm = 35.3822, GNorm = 1.4188, lr_0 = 3.1256e-04
Validation rmse = 0.119766
Epoch 30
Loss = 1.1854e-01, PNorm = 35.3939, GNorm = 3.8546, lr_0 = 3.0463e-04
Loss = 8.3883e-02, PNorm = 35.4045, GNorm = 1.8683, lr_0 = 2.9760e-04
Validation rmse = 0.119186
Epoch 31
Loss = 7.6584e-02, PNorm = 35.4133, GNorm = 0.9855, lr_0 = 2.9005e-04
Loss = 8.6766e-02, PNorm = 35.4221, GNorm = 0.6881, lr_0 = 2.8336e-04
Validation rmse = 0.119140
Epoch 32
Loss = 7.5991e-02, PNorm = 35.4322, GNorm = 2.3623, lr_0 = 2.7617e-04
Loss = 8.3645e-02, PNorm = 35.4412, GNorm = 1.8575, lr_0 = 2.6980e-04
Validation rmse = 0.121882
Epoch 33
Loss = 8.1466e-02, PNorm = 35.4511, GNorm = 0.5308, lr_0 = 2.6357e-04
Validation rmse = 0.118674
Epoch 34
Loss = 7.9864e-02, PNorm = 35.4625, GNorm = 2.2660, lr_0 = 2.5688e-04
Loss = 8.0464e-02, PNorm = 35.4716, GNorm = 2.7334, lr_0 = 2.5095e-04
Validation rmse = 0.118755
Epoch 35
Loss = 7.4316e-02, PNorm = 35.4798, GNorm = 2.0923, lr_0 = 2.4459e-04
Loss = 7.7646e-02, PNorm = 35.4875, GNorm = 1.2929, lr_0 = 2.3894e-04
Validation rmse = 0.117091
Epoch 36
Loss = 6.6123e-02, PNorm = 35.4951, GNorm = 0.9977, lr_0 = 2.3343e-04
Validation rmse = 0.123258
Epoch 37
Loss = 7.6790e-02, PNorm = 35.5031, GNorm = 2.5285, lr_0 = 2.2751e-04
Loss = 7.2389e-02, PNorm = 35.5113, GNorm = 0.6676, lr_0 = 2.2226e-04
Validation rmse = 0.118879
Epoch 38
Loss = 7.4459e-02, PNorm = 35.5209, GNorm = 3.0258, lr_0 = 2.1662e-04
Loss = 7.9303e-02, PNorm = 35.5288, GNorm = 0.8615, lr_0 = 2.1162e-04
Validation rmse = 0.117488
Epoch 39
Loss = 6.6322e-02, PNorm = 35.5363, GNorm = 0.7902, lr_0 = 2.0625e-04
Loss = 7.7715e-02, PNorm = 35.5426, GNorm = 0.9588, lr_0 = 2.0149e-04
Validation rmse = 0.120381
Epoch 40
Loss = 7.7056e-02, PNorm = 35.5493, GNorm = 0.7519, lr_0 = 1.9684e-04
Validation rmse = 0.119881
Epoch 41
Loss = 6.5405e-02, PNorm = 35.5574, GNorm = 2.9214, lr_0 = 1.9185e-04
Loss = 7.6638e-02, PNorm = 35.5634, GNorm = 1.6500, lr_0 = 1.8742e-04
Validation rmse = 0.116552
Epoch 42
Loss = 7.1640e-02, PNorm = 35.5720, GNorm = 1.4715, lr_0 = 1.8267e-04
Loss = 6.9497e-02, PNorm = 35.5784, GNorm = 0.9391, lr_0 = 1.7845e-04
Validation rmse = 0.116430
Epoch 43
Loss = 6.3643e-02, PNorm = 35.5836, GNorm = 2.0618, lr_0 = 1.7433e-04
Loss = 7.6189e-02, PNorm = 35.5881, GNorm = 0.7241, lr_0 = 1.7031e-04
Loss = 6.0224e-02, PNorm = 35.5887, GNorm = 1.1000, lr_0 = 1.6991e-04
Validation rmse = 0.116558
Epoch 44
Loss = 6.9055e-02, PNorm = 35.5958, GNorm = 0.6396, lr_0 = 1.6599e-04
Validation rmse = 0.118271
Epoch 45
Loss = 6.4400e-02, PNorm = 35.6017, GNorm = 0.6450, lr_0 = 1.6178e-04
Loss = 6.4890e-02, PNorm = 35.6064, GNorm = 2.6457, lr_0 = 1.5805e-04
Validation rmse = 0.117781
Epoch 46
Loss = 6.2164e-02, PNorm = 35.6129, GNorm = 1.5391, lr_0 = 1.5404e-04
Loss = 7.2471e-02, PNorm = 35.6183, GNorm = 0.6081, lr_0 = 1.5048e-04
Validation rmse = 0.116290
Epoch 47
Loss = 6.6809e-02, PNorm = 35.6224, GNorm = 0.4635, lr_0 = 1.4701e-04
Validation rmse = 0.116945
Epoch 48
Loss = 4.7521e-02, PNorm = 35.6278, GNorm = 1.0341, lr_0 = 1.4328e-04
Loss = 6.6895e-02, PNorm = 35.6330, GNorm = 1.3767, lr_0 = 1.3997e-04
Validation rmse = 0.117397
Epoch 49
Loss = 6.4791e-02, PNorm = 35.6375, GNorm = 1.8697, lr_0 = 1.3642e-04
Loss = 6.9189e-02, PNorm = 35.6426, GNorm = 1.4173, lr_0 = 1.3327e-04
Validation rmse = 0.116925
Epoch 50
Loss = 6.4079e-02, PNorm = 35.6468, GNorm = 1.4717, lr_0 = 1.3020e-04
Loss = 6.5682e-02, PNorm = 35.6512, GNorm = 0.8874, lr_0 = 1.2719e-04
Validation rmse = 0.119776
Epoch 51
Loss = 6.3238e-02, PNorm = 35.6563, GNorm = 2.0712, lr_0 = 1.2397e-04
Validation rmse = 0.115793
Epoch 52
Loss = 5.0920e-02, PNorm = 35.6600, GNorm = 1.7975, lr_0 = 1.2082e-04
Loss = 6.7104e-02, PNorm = 35.6642, GNorm = 0.6552, lr_0 = 1.1803e-04
Validation rmse = 0.116419
Epoch 53
Loss = 6.2909e-02, PNorm = 35.6671, GNorm = 0.9628, lr_0 = 1.1504e-04
Loss = 6.4374e-02, PNorm = 35.6707, GNorm = 1.1806, lr_0 = 1.1239e-04
Validation rmse = 0.115257
Epoch 54
Loss = 5.5659e-02, PNorm = 35.6740, GNorm = 0.6467, lr_0 = 1.0979e-04
Loss = 6.9237e-02, PNorm = 35.6776, GNorm = 1.5298, lr_0 = 1.0726e-04
Loss = 5.8621e-02, PNorm = 35.6779, GNorm = 1.4405, lr_0 = 1.0701e-04
Validation rmse = 0.116842
Epoch 55
Loss = 6.5211e-02, PNorm = 35.6818, GNorm = 0.9334, lr_0 = 1.0454e-04
Validation rmse = 0.114750
Epoch 56
Loss = 7.4099e-02, PNorm = 35.6849, GNorm = 1.4127, lr_0 = 1.0189e-04
Loss = 6.7580e-02, PNorm = 35.6887, GNorm = 2.8971, lr_0 = 1.0000e-04
Validation rmse = 0.124338
Epoch 57
Loss = 6.9361e-02, PNorm = 35.6930, GNorm = 0.6862, lr_0 = 1.0000e-04
Loss = 6.1129e-02, PNorm = 35.6960, GNorm = 0.7860, lr_0 = 1.0000e-04
Validation rmse = 0.116463
Epoch 58
Loss = 6.0431e-02, PNorm = 35.6993, GNorm = 0.6601, lr_0 = 1.0000e-04
Validation rmse = 0.116101
Epoch 59
Loss = 6.6881e-02, PNorm = 35.7030, GNorm = 0.6238, lr_0 = 1.0000e-04
Loss = 6.4571e-02, PNorm = 35.7061, GNorm = 1.4771, lr_0 = 1.0000e-04
Validation rmse = 0.117190
Model 0 best validation rmse = 0.114750 on epoch 55
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.087609
Ensemble test rmse = 0.087609
1-fold cross validation
	Seed 0 ==> test rmse = 0.087609
Overall test rmse = 0.087609 +/- 0.000000
Elapsed time = 0:00:42
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,077 | train size = 856 | val size = 215 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.4287e-01, PNorm = 34.0173, GNorm = 3.1202, lr_0 = 3.9118e-04
Validation rmse = 0.278351
Epoch 1
Loss = 6.3082e-01, PNorm = 34.0437, GNorm = 4.6582, lr_0 = 6.8235e-04
Loss = 6.4475e-01, PNorm = 34.0858, GNorm = 4.3103, lr_0 = 9.4706e-04
Validation rmse = 0.277130
Epoch 2
Loss = 5.3758e-01, PNorm = 34.1570, GNorm = 3.6215, lr_0 = 9.7920e-04
Loss = 5.5350e-01, PNorm = 34.2241, GNorm = 2.6774, lr_0 = 9.5660e-04
Validation rmse = 0.243442
Epoch 3
Loss = 4.2449e-01, PNorm = 34.3000, GNorm = 2.4173, lr_0 = 9.3234e-04
Validation rmse = 0.205231
Epoch 4
Loss = 3.8785e-01, PNorm = 34.3644, GNorm = 1.7216, lr_0 = 9.0869e-04
Loss = 3.2488e-01, PNorm = 34.4223, GNorm = 4.2300, lr_0 = 8.8772e-04
Validation rmse = 0.187508
Epoch 5
Loss = 3.0950e-01, PNorm = 34.4814, GNorm = 1.8954, lr_0 = 8.6521e-04
Loss = 2.4929e-01, PNorm = 34.5279, GNorm = 2.3070, lr_0 = 8.4524e-04
Validation rmse = 0.167453
Epoch 6
Loss = 2.2784e-01, PNorm = 34.5788, GNorm = 1.1967, lr_0 = 8.2380e-04
Validation rmse = 0.160686
Epoch 7
Loss = 1.9074e-01, PNorm = 34.6252, GNorm = 4.6428, lr_0 = 8.0291e-04
Loss = 2.0703e-01, PNorm = 34.6597, GNorm = 6.6217, lr_0 = 7.8437e-04
Validation rmse = 0.138141
Epoch 8
Loss = 1.6704e-01, PNorm = 34.6988, GNorm = 2.3498, lr_0 = 7.6448e-04
Loss = 1.7778e-01, PNorm = 34.7397, GNorm = 2.0671, lr_0 = 7.4684e-04
Validation rmse = 0.143586
Epoch 9
Loss = 1.7095e-01, PNorm = 34.7643, GNorm = 1.6924, lr_0 = 7.2960e-04
Loss = 1.5539e-01, PNorm = 34.7934, GNorm = 0.6444, lr_0 = 7.1276e-04
Validation rmse = 0.132707
Epoch 10
Loss = 1.4136e-01, PNorm = 34.8283, GNorm = 4.2869, lr_0 = 6.9468e-04
Validation rmse = 0.140839
Epoch 11
Loss = 1.1176e-01, PNorm = 34.8506, GNorm = 3.7103, lr_0 = 6.7706e-04
Loss = 1.5525e-01, PNorm = 34.8695, GNorm = 5.3896, lr_0 = 6.6143e-04
Validation rmse = 0.141703
Epoch 12
Loss = 1.5427e-01, PNorm = 34.8980, GNorm = 3.9851, lr_0 = 6.4466e-04
Loss = 1.2024e-01, PNorm = 34.9223, GNorm = 1.3203, lr_0 = 6.2978e-04
Validation rmse = 0.125288
Epoch 13
Loss = 1.1304e-01, PNorm = 34.9469, GNorm = 1.0468, lr_0 = 6.1381e-04
Validation rmse = 0.122085
Epoch 14
Loss = 7.0232e-02, PNorm = 34.9689, GNorm = 0.8194, lr_0 = 5.9824e-04
Loss = 1.2903e-01, PNorm = 34.9874, GNorm = 1.2448, lr_0 = 5.8443e-04
Validation rmse = 0.142260
Epoch 15
Loss = 1.5907e-01, PNorm = 35.0089, GNorm = 3.0611, lr_0 = 5.6961e-04
Loss = 1.3180e-01, PNorm = 35.0299, GNorm = 2.1622, lr_0 = 5.5646e-04
Validation rmse = 0.129589
Epoch 16
Loss = 1.2321e-01, PNorm = 35.0508, GNorm = 2.5456, lr_0 = 5.4235e-04
Loss = 1.0431e-01, PNorm = 35.0658, GNorm = 2.1017, lr_0 = 5.2983e-04
Validation rmse = 0.135864
Epoch 17
Loss = 1.0899e-01, PNorm = 35.0815, GNorm = 2.3474, lr_0 = 5.1760e-04
Validation rmse = 0.138456
Epoch 18
Loss = 1.6518e-01, PNorm = 35.0988, GNorm = 5.4197, lr_0 = 5.0448e-04
Loss = 1.4257e-01, PNorm = 35.1142, GNorm = 3.0557, lr_0 = 4.9283e-04
Validation rmse = 0.121675
Epoch 19
Loss = 1.1285e-01, PNorm = 35.1322, GNorm = 1.7126, lr_0 = 4.8033e-04
Loss = 1.0220e-01, PNorm = 35.1480, GNorm = 1.5134, lr_0 = 4.6924e-04
Validation rmse = 0.122537
Epoch 20
Loss = 1.1626e-01, PNorm = 35.1683, GNorm = 3.0714, lr_0 = 4.5734e-04
Validation rmse = 0.122375
Epoch 21
Loss = 8.7738e-02, PNorm = 35.1828, GNorm = 0.7197, lr_0 = 4.4575e-04
Loss = 1.1965e-01, PNorm = 35.1960, GNorm = 2.1145, lr_0 = 4.3546e-04
Validation rmse = 0.135044
Epoch 22
Loss = 9.3559e-02, PNorm = 35.2054, GNorm = 1.3797, lr_0 = 4.2441e-04
Loss = 1.0067e-01, PNorm = 35.2191, GNorm = 1.3517, lr_0 = 4.1462e-04
Validation rmse = 0.119900
Epoch 23
Loss = 9.3815e-02, PNorm = 35.2327, GNorm = 2.3701, lr_0 = 4.0410e-04
Loss = 9.1325e-02, PNorm = 35.2446, GNorm = 0.5667, lr_0 = 3.9477e-04
Loss = 9.8966e-02, PNorm = 35.2457, GNorm = 1.4999, lr_0 = 3.9385e-04
Validation rmse = 0.130780
Epoch 24
Loss = 9.3147e-02, PNorm = 35.2559, GNorm = 1.2245, lr_0 = 3.8476e-04
Validation rmse = 0.117124
Epoch 25
Loss = 7.8240e-02, PNorm = 35.2660, GNorm = 0.3784, lr_0 = 3.7588e-04
Loss = 8.8569e-02, PNorm = 35.2748, GNorm = 2.1666, lr_0 = 3.6721e-04
Validation rmse = 0.115561
Epoch 26
Loss = 1.1271e-01, PNorm = 35.2895, GNorm = 1.4712, lr_0 = 3.5789e-04
Loss = 1.0353e-01, PNorm = 35.3005, GNorm = 1.0215, lr_0 = 3.4963e-04
Validation rmse = 0.119938
Epoch 27
Loss = 9.1550e-02, PNorm = 35.3134, GNorm = 1.0669, lr_0 = 3.4076e-04
Validation rmse = 0.119462
Epoch 28
Loss = 7.5884e-02, PNorm = 35.3239, GNorm = 0.6573, lr_0 = 3.3212e-04
Loss = 8.3511e-02, PNorm = 35.3333, GNorm = 1.2272, lr_0 = 3.2446e-04
Validation rmse = 0.118706
Epoch 29
Loss = 8.1268e-02, PNorm = 35.3426, GNorm = 1.0128, lr_0 = 3.1623e-04
Loss = 8.4694e-02, PNorm = 35.3523, GNorm = 0.8042, lr_0 = 3.0893e-04
Validation rmse = 0.116405
Epoch 30
Loss = 7.7572e-02, PNorm = 35.3598, GNorm = 0.9471, lr_0 = 3.0109e-04
Loss = 8.4314e-02, PNorm = 35.3671, GNorm = 0.4296, lr_0 = 2.9414e-04
Loss = 4.9929e-02, PNorm = 35.3680, GNorm = 2.6825, lr_0 = 2.9346e-04
Validation rmse = 0.114825
Epoch 31
Loss = 8.1372e-02, PNorm = 35.3768, GNorm = 0.9306, lr_0 = 2.8668e-04
Validation rmse = 0.122034
Epoch 32
Loss = 7.7359e-02, PNorm = 35.3857, GNorm = 0.7758, lr_0 = 2.7941e-04
Loss = 7.7458e-02, PNorm = 35.3951, GNorm = 1.1411, lr_0 = 2.7296e-04
Validation rmse = 0.114522
Epoch 33
Loss = 7.2966e-02, PNorm = 35.4019, GNorm = 0.6114, lr_0 = 2.6604e-04
Loss = 7.8914e-02, PNorm = 35.4078, GNorm = 0.9877, lr_0 = 2.5990e-04
Validation rmse = 0.115326
Epoch 34
Loss = 7.5678e-02, PNorm = 35.4152, GNorm = 1.1629, lr_0 = 2.5390e-04
Validation rmse = 0.118410
Epoch 35
Loss = 7.5607e-02, PNorm = 35.4231, GNorm = 0.4681, lr_0 = 2.4746e-04
Loss = 8.2058e-02, PNorm = 35.4308, GNorm = 1.2938, lr_0 = 2.4175e-04
Validation rmse = 0.117695
Epoch 36
Loss = 7.8118e-02, PNorm = 35.4380, GNorm = 2.2150, lr_0 = 2.3562e-04
Loss = 8.0228e-02, PNorm = 35.4448, GNorm = 1.4554, lr_0 = 2.3018e-04
Validation rmse = 0.115971
Epoch 37
Loss = 7.2000e-02, PNorm = 35.4520, GNorm = 0.5554, lr_0 = 2.2434e-04
Loss = 7.6917e-02, PNorm = 35.4572, GNorm = 1.0557, lr_0 = 2.1916e-04
Loss = 5.4805e-02, PNorm = 35.4579, GNorm = 1.4537, lr_0 = 2.1865e-04
Validation rmse = 0.117425
Epoch 38
Loss = 6.6774e-02, PNorm = 35.4642, GNorm = 0.7577, lr_0 = 2.1361e-04
Validation rmse = 0.114151
Epoch 39
Loss = 6.3515e-02, PNorm = 35.4716, GNorm = 0.8204, lr_0 = 2.0819e-04
Loss = 7.4742e-02, PNorm = 35.4782, GNorm = 1.2084, lr_0 = 2.0338e-04
Validation rmse = 0.115761
Epoch 40
Loss = 7.7594e-02, PNorm = 35.4840, GNorm = 1.3765, lr_0 = 1.9823e-04
Loss = 7.4108e-02, PNorm = 35.4894, GNorm = 0.9161, lr_0 = 1.9365e-04
Validation rmse = 0.117458
Epoch 41
Loss = 7.0370e-02, PNorm = 35.4947, GNorm = 0.6035, lr_0 = 1.8874e-04
Validation rmse = 0.112775
Epoch 42
Loss = 6.9264e-02, PNorm = 35.5001, GNorm = 1.2664, lr_0 = 1.8438e-04
Loss = 6.9285e-02, PNorm = 35.5045, GNorm = 0.7332, lr_0 = 1.8013e-04
Validation rmse = 0.113704
Epoch 43
Loss = 7.2753e-02, PNorm = 35.5097, GNorm = 0.7446, lr_0 = 1.7556e-04
Loss = 7.0429e-02, PNorm = 35.5150, GNorm = 0.5029, lr_0 = 1.7151e-04
Validation rmse = 0.114752
Epoch 44
Loss = 6.4937e-02, PNorm = 35.5184, GNorm = 0.9480, lr_0 = 1.6716e-04
Loss = 7.6294e-02, PNorm = 35.5237, GNorm = 2.2029, lr_0 = 1.6330e-04
Loss = 2.9163e-02, PNorm = 35.5242, GNorm = 1.0812, lr_0 = 1.6292e-04
Validation rmse = 0.120657
Epoch 45
Loss = 6.6113e-02, PNorm = 35.5290, GNorm = 0.5484, lr_0 = 1.5916e-04
Validation rmse = 0.112884
Epoch 46
Loss = 4.6939e-02, PNorm = 35.5335, GNorm = 0.4693, lr_0 = 1.5512e-04
Loss = 7.1441e-02, PNorm = 35.5377, GNorm = 0.7694, lr_0 = 1.5154e-04
Validation rmse = 0.116944
Epoch 47
Loss = 6.9476e-02, PNorm = 35.5424, GNorm = 1.4818, lr_0 = 1.4770e-04
Loss = 6.9694e-02, PNorm = 35.5468, GNorm = 0.7266, lr_0 = 1.4429e-04
Validation rmse = 0.113713
Epoch 48
Loss = 7.1510e-02, PNorm = 35.5506, GNorm = 2.4836, lr_0 = 1.4063e-04
Validation rmse = 0.112604
Epoch 49
Loss = 5.9182e-02, PNorm = 35.5543, GNorm = 0.7754, lr_0 = 1.3706e-04
Loss = 6.9721e-02, PNorm = 35.5588, GNorm = 1.6761, lr_0 = 1.3390e-04
Validation rmse = 0.112795
Epoch 50
Loss = 6.2381e-02, PNorm = 35.5629, GNorm = 0.8832, lr_0 = 1.3081e-04
Loss = 7.6546e-02, PNorm = 35.5676, GNorm = 1.0978, lr_0 = 1.2779e-04
Validation rmse = 0.112966
Epoch 51
Loss = 7.1474e-02, PNorm = 35.5724, GNorm = 1.8092, lr_0 = 1.2455e-04
Loss = 6.4999e-02, PNorm = 35.5760, GNorm = 0.7256, lr_0 = 1.2167e-04
Loss = 2.6115e-02, PNorm = 35.5763, GNorm = 1.3025, lr_0 = 1.2139e-04
Validation rmse = 0.113382
Epoch 52
Loss = 6.4626e-02, PNorm = 35.5789, GNorm = 1.2129, lr_0 = 1.1859e-04
Validation rmse = 0.113378
Epoch 53
Loss = 5.8673e-02, PNorm = 35.5826, GNorm = 2.0993, lr_0 = 1.1558e-04
Loss = 6.8964e-02, PNorm = 35.5856, GNorm = 1.3895, lr_0 = 1.1291e-04
Validation rmse = 0.114786
Epoch 54
Loss = 6.0851e-02, PNorm = 35.5900, GNorm = 0.5871, lr_0 = 1.1005e-04
Loss = 6.7478e-02, PNorm = 35.5926, GNorm = 1.0352, lr_0 = 1.0751e-04
Validation rmse = 0.113931
Epoch 55
Loss = 6.3475e-02, PNorm = 35.5963, GNorm = 0.5791, lr_0 = 1.0478e-04
Validation rmse = 0.112218
Epoch 56
Loss = 5.3676e-02, PNorm = 35.5993, GNorm = 1.0938, lr_0 = 1.0212e-04
Loss = 6.7805e-02, PNorm = 35.6017, GNorm = 1.0705, lr_0 = 1.0000e-04
Validation rmse = 0.115729
Epoch 57
Loss = 6.9432e-02, PNorm = 35.6051, GNorm = 0.8345, lr_0 = 1.0000e-04
Loss = 5.9777e-02, PNorm = 35.6086, GNorm = 1.3644, lr_0 = 1.0000e-04
Validation rmse = 0.115220
Epoch 58
Loss = 7.2002e-02, PNorm = 35.6122, GNorm = 0.8372, lr_0 = 1.0000e-04
Loss = 5.7841e-02, PNorm = 35.6146, GNorm = 2.0690, lr_0 = 1.0000e-04
Validation rmse = 0.112495
Epoch 59
Loss = 6.6738e-02, PNorm = 35.6178, GNorm = 2.0438, lr_0 = 1.0000e-04
Validation rmse = 0.114304
Model 0 best validation rmse = 0.112218 on epoch 55
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.081319
Ensemble test rmse = 0.081319
1-fold cross validation
	Seed 0 ==> test rmse = 0.081319
Overall test rmse = 0.081319 +/- 0.000000
Elapsed time = 0:00:38
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,067 | train size = 848 | val size = 213 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.2167e-01, PNorm = 34.0184, GNorm = 1.4925, lr_0 = 4.0937e-04
Validation rmse = 0.249726
Epoch 1
Loss = 7.2288e-01, PNorm = 34.0523, GNorm = 1.6514, lr_0 = 7.1875e-04
Loss = 7.0393e-01, PNorm = 34.0986, GNorm = 2.7798, lr_0 = 1.0000e-03
Validation rmse = 0.223586
Epoch 2
Loss = 5.1216e-01, PNorm = 34.1615, GNorm = 3.9994, lr_0 = 9.7549e-04
Loss = 4.0862e-01, PNorm = 34.2301, GNorm = 2.7957, lr_0 = 9.5159e-04
Validation rmse = 0.195673
Epoch 3
Loss = 3.6412e-01, PNorm = 34.2994, GNorm = 1.3397, lr_0 = 9.2827e-04
Validation rmse = 0.170978
Epoch 4
Loss = 2.6126e-01, PNorm = 34.3557, GNorm = 2.0141, lr_0 = 9.0552e-04
Loss = 2.5983e-01, PNorm = 34.4152, GNorm = 7.1073, lr_0 = 8.8333e-04
Validation rmse = 0.158150
Epoch 5
Loss = 2.2195e-01, PNorm = 34.4711, GNorm = 1.2557, lr_0 = 8.6168e-04
Loss = 1.9788e-01, PNorm = 34.5197, GNorm = 3.9560, lr_0 = 8.4056e-04
Validation rmse = 0.150502
Epoch 6
Loss = 2.0709e-01, PNorm = 34.5624, GNorm = 4.1001, lr_0 = 8.1996e-04
Validation rmse = 0.142859
Epoch 7
Loss = 1.6510e-01, PNorm = 34.6046, GNorm = 2.0755, lr_0 = 7.9987e-04
Loss = 1.6527e-01, PNorm = 34.6426, GNorm = 1.0703, lr_0 = 7.8026e-04
Validation rmse = 0.163688
Epoch 8
Loss = 1.7788e-01, PNorm = 34.6740, GNorm = 1.1080, lr_0 = 7.6114e-04
Loss = 1.6638e-01, PNorm = 34.7055, GNorm = 1.4486, lr_0 = 7.4249e-04
Validation rmse = 0.145231
Epoch 9
Loss = 1.4128e-01, PNorm = 34.7376, GNorm = 5.9761, lr_0 = 7.2429e-04
Validation rmse = 0.133706
Epoch 10
Loss = 1.7611e-01, PNorm = 34.7653, GNorm = 3.6217, lr_0 = 7.0654e-04
Loss = 1.3949e-01, PNorm = 34.7974, GNorm = 1.1379, lr_0 = 6.8923e-04
Validation rmse = 0.147944
Epoch 11
Loss = 1.2073e-01, PNorm = 34.8267, GNorm = 2.8323, lr_0 = 6.7234e-04
Loss = 1.0728e-01, PNorm = 34.8475, GNorm = 2.2706, lr_0 = 6.5586e-04
Validation rmse = 0.132985
Epoch 12
Loss = 1.0466e-01, PNorm = 34.8687, GNorm = 2.0910, lr_0 = 6.3979e-04
Loss = 1.2575e-01, PNorm = 34.8897, GNorm = 3.2671, lr_0 = 6.2411e-04
Validation rmse = 0.129846
Epoch 13
Loss = 1.2474e-01, PNorm = 34.9096, GNorm = 1.7508, lr_0 = 6.0881e-04
Validation rmse = 0.128707
Epoch 14
Loss = 1.1393e-01, PNorm = 34.9299, GNorm = 2.0452, lr_0 = 5.9389e-04
Loss = 8.9537e-02, PNorm = 34.9495, GNorm = 0.7508, lr_0 = 5.7934e-04
Validation rmse = 0.122739
Epoch 15
Loss = 1.0156e-01, PNorm = 34.9638, GNorm = 1.4623, lr_0 = 5.6514e-04
Loss = 9.5963e-02, PNorm = 34.9820, GNorm = 0.6392, lr_0 = 5.5129e-04
Validation rmse = 0.123685
Epoch 16
Loss = 9.6565e-02, PNorm = 34.9984, GNorm = 2.9758, lr_0 = 5.3778e-04
Validation rmse = 0.120115
Epoch 17
Loss = 1.0707e-01, PNorm = 35.0127, GNorm = 2.8864, lr_0 = 5.2460e-04
Loss = 8.5712e-02, PNorm = 35.0284, GNorm = 1.3823, lr_0 = 5.1174e-04
Validation rmse = 0.132259
Epoch 18
Loss = 8.6770e-02, PNorm = 35.0429, GNorm = 3.0718, lr_0 = 4.9920e-04
Loss = 9.7189e-02, PNorm = 35.0581, GNorm = 0.8576, lr_0 = 4.8697e-04
Validation rmse = 0.117099
Epoch 19
Loss = 9.0355e-02, PNorm = 35.0772, GNorm = 0.8826, lr_0 = 4.7503e-04
Validation rmse = 0.124032
Epoch 20
Loss = 8.3826e-02, PNorm = 35.0898, GNorm = 1.8981, lr_0 = 4.6339e-04
Loss = 8.4056e-02, PNorm = 35.1033, GNorm = 0.7720, lr_0 = 4.5204e-04
Validation rmse = 0.116855
Epoch 21
Loss = 8.0692e-02, PNorm = 35.1197, GNorm = 1.9079, lr_0 = 4.4096e-04
Loss = 9.4694e-02, PNorm = 35.1338, GNorm = 0.7044, lr_0 = 4.3015e-04
Validation rmse = 0.117190
Epoch 22
Loss = 8.0204e-02, PNorm = 35.1473, GNorm = 0.7274, lr_0 = 4.1961e-04
Loss = 8.2050e-02, PNorm = 35.1615, GNorm = 0.9897, lr_0 = 4.0933e-04
Validation rmse = 0.123468
Epoch 23
Loss = 7.4482e-02, PNorm = 35.1734, GNorm = 0.6811, lr_0 = 3.9929e-04
Validation rmse = 0.119569
Epoch 24
Loss = 7.4992e-02, PNorm = 35.1871, GNorm = 1.0353, lr_0 = 3.8951e-04
Loss = 7.5854e-02, PNorm = 35.2016, GNorm = 2.0734, lr_0 = 3.7996e-04
Validation rmse = 0.122582
Epoch 25
Loss = 7.3390e-02, PNorm = 35.2121, GNorm = 0.7149, lr_0 = 3.7065e-04
Loss = 8.0139e-02, PNorm = 35.2233, GNorm = 0.9761, lr_0 = 3.6157e-04
Loss = 5.8570e-02, PNorm = 35.2249, GNorm = 0.5370, lr_0 = 3.6067e-04
Validation rmse = 0.115341
Epoch 26
Loss = 7.5397e-02, PNorm = 35.2383, GNorm = 1.1046, lr_0 = 3.5183e-04
Validation rmse = 0.121192
Epoch 27
Loss = 8.9889e-02, PNorm = 35.2505, GNorm = 2.6603, lr_0 = 3.4321e-04
Loss = 6.8273e-02, PNorm = 35.2614, GNorm = 0.9334, lr_0 = 3.3480e-04
Validation rmse = 0.120254
Epoch 28
Loss = 7.0462e-02, PNorm = 35.2729, GNorm = 1.0494, lr_0 = 3.2659e-04
Loss = 7.1518e-02, PNorm = 35.2827, GNorm = 0.5180, lr_0 = 3.1859e-04
Validation rmse = 0.117296
Epoch 29
Loss = 6.7015e-02, PNorm = 35.2952, GNorm = 5.3420, lr_0 = 3.1078e-04
Validation rmse = 0.114693
Epoch 30
Loss = 5.3581e-02, PNorm = 35.3041, GNorm = 0.6471, lr_0 = 3.0317e-04
Loss = 7.0259e-02, PNorm = 35.3131, GNorm = 0.7284, lr_0 = 2.9574e-04
Validation rmse = 0.117095
Epoch 31
Loss = 5.8909e-02, PNorm = 35.3242, GNorm = 1.4689, lr_0 = 2.8849e-04
Loss = 7.4117e-02, PNorm = 35.3336, GNorm = 0.7222, lr_0 = 2.8142e-04
Validation rmse = 0.117259
Epoch 32
Loss = 6.1271e-02, PNorm = 35.3429, GNorm = 1.1401, lr_0 = 2.7452e-04
Validation rmse = 0.117388
Epoch 33
Loss = 4.3732e-02, PNorm = 35.3530, GNorm = 1.0544, lr_0 = 2.6779e-04
Loss = 7.1915e-02, PNorm = 35.3618, GNorm = 0.7160, lr_0 = 2.6123e-04
Validation rmse = 0.121997
Epoch 34
Loss = 7.1333e-02, PNorm = 35.3715, GNorm = 0.4347, lr_0 = 2.5483e-04
Loss = 6.4368e-02, PNorm = 35.3803, GNorm = 1.1628, lr_0 = 2.4858e-04
Validation rmse = 0.117275
Epoch 35
Loss = 7.3411e-02, PNorm = 35.3890, GNorm = 1.8361, lr_0 = 2.4249e-04
Loss = 6.5764e-02, PNorm = 35.3967, GNorm = 1.4415, lr_0 = 2.3655e-04
Validation rmse = 0.114397
Epoch 36
Loss = 6.0316e-02, PNorm = 35.4040, GNorm = 0.5587, lr_0 = 2.3075e-04
Validation rmse = 0.115584
Epoch 37
Loss = 5.1723e-02, PNorm = 35.4101, GNorm = 0.4485, lr_0 = 2.2510e-04
Loss = 7.6843e-02, PNorm = 35.4176, GNorm = 2.7287, lr_0 = 2.1958e-04
Validation rmse = 0.121544
Epoch 38
Loss = 5.9387e-02, PNorm = 35.4253, GNorm = 1.9344, lr_0 = 2.1420e-04
Loss = 6.5294e-02, PNorm = 35.4323, GNorm = 0.4368, lr_0 = 2.0895e-04
Validation rmse = 0.116441
Epoch 39
Loss = 6.2469e-02, PNorm = 35.4397, GNorm = 0.6000, lr_0 = 2.0383e-04
Validation rmse = 0.115115
Epoch 40
Loss = 7.5987e-02, PNorm = 35.4464, GNorm = 0.6713, lr_0 = 1.9883e-04
Loss = 6.2628e-02, PNorm = 35.4528, GNorm = 4.1446, lr_0 = 1.9396e-04
Validation rmse = 0.118717
Epoch 41
Loss = 6.2145e-02, PNorm = 35.4590, GNorm = 2.3541, lr_0 = 1.8921e-04
Loss = 7.1096e-02, PNorm = 35.4662, GNorm = 3.4277, lr_0 = 1.8457e-04
Validation rmse = 0.122215
Epoch 42
Loss = 6.3765e-02, PNorm = 35.4723, GNorm = 2.0409, lr_0 = 1.8005e-04
Validation rmse = 0.115769
Epoch 43
Loss = 5.6986e-02, PNorm = 35.4791, GNorm = 0.5599, lr_0 = 1.7564e-04
Loss = 6.0939e-02, PNorm = 35.4850, GNorm = 0.9798, lr_0 = 1.7133e-04
Validation rmse = 0.114478
Epoch 44
Loss = 6.0386e-02, PNorm = 35.4890, GNorm = 1.2152, lr_0 = 1.6713e-04
Loss = 6.1393e-02, PNorm = 35.4939, GNorm = 1.6932, lr_0 = 1.6304e-04
Validation rmse = 0.114578
Epoch 45
Loss = 5.5113e-02, PNorm = 35.4993, GNorm = 0.4700, lr_0 = 1.5904e-04
Loss = 6.3305e-02, PNorm = 35.5039, GNorm = 1.8376, lr_0 = 1.5514e-04
Validation rmse = 0.116168
Epoch 46
Loss = 5.6895e-02, PNorm = 35.5082, GNorm = 2.1433, lr_0 = 1.5134e-04
Validation rmse = 0.115562
Epoch 47
Loss = 5.7889e-02, PNorm = 35.5138, GNorm = 0.5263, lr_0 = 1.4763e-04
Loss = 5.3447e-02, PNorm = 35.5189, GNorm = 0.6519, lr_0 = 1.4401e-04
Validation rmse = 0.118790
Epoch 48
Loss = 5.3922e-02, PNorm = 35.5232, GNorm = 0.7593, lr_0 = 1.4048e-04
Loss = 6.4816e-02, PNorm = 35.5274, GNorm = 0.4863, lr_0 = 1.3704e-04
Validation rmse = 0.114235
Epoch 49
Loss = 5.8485e-02, PNorm = 35.5319, GNorm = 0.9650, lr_0 = 1.3368e-04
Validation rmse = 0.114032
Epoch 50
Loss = 4.8285e-02, PNorm = 35.5359, GNorm = 0.4526, lr_0 = 1.3041e-04
Loss = 5.8321e-02, PNorm = 35.5395, GNorm = 1.6855, lr_0 = 1.2721e-04
Validation rmse = 0.114059
Epoch 51
Loss = 5.6383e-02, PNorm = 35.5447, GNorm = 0.6020, lr_0 = 1.2379e-04
Loss = 5.5177e-02, PNorm = 35.5492, GNorm = 1.0328, lr_0 = 1.2075e-04
Validation rmse = 0.116342
Epoch 52
Loss = 5.8790e-02, PNorm = 35.5522, GNorm = 0.5512, lr_0 = 1.1779e-04
Validation rmse = 0.114703
Epoch 53
Loss = 5.6116e-02, PNorm = 35.5558, GNorm = 0.5998, lr_0 = 1.1491e-04
Loss = 5.6587e-02, PNorm = 35.5589, GNorm = 1.7261, lr_0 = 1.1209e-04
Validation rmse = 0.113035
Epoch 54
Loss = 5.1567e-02, PNorm = 35.5631, GNorm = 1.5458, lr_0 = 1.0934e-04
Loss = 5.7894e-02, PNorm = 35.5666, GNorm = 2.3766, lr_0 = 1.0666e-04
Validation rmse = 0.113741
Epoch 55
Loss = 5.0667e-02, PNorm = 35.5698, GNorm = 0.5785, lr_0 = 1.0405e-04
Validation rmse = 0.116148
Epoch 56
Loss = 4.3288e-02, PNorm = 35.5734, GNorm = 0.4065, lr_0 = 1.0150e-04
Loss = 5.3079e-02, PNorm = 35.5760, GNorm = 0.6731, lr_0 = 1.0000e-04
Validation rmse = 0.113501
Epoch 57
Loss = 5.7469e-02, PNorm = 35.5786, GNorm = 1.5707, lr_0 = 1.0000e-04
Loss = 5.1848e-02, PNorm = 35.5816, GNorm = 1.3839, lr_0 = 1.0000e-04
Validation rmse = 0.118222
Epoch 58
Loss = 4.8043e-02, PNorm = 35.5853, GNorm = 1.0071, lr_0 = 1.0000e-04
Loss = 5.8227e-02, PNorm = 35.5883, GNorm = 2.0198, lr_0 = 1.0000e-04
Validation rmse = 0.113708
Epoch 59
Loss = 5.4703e-02, PNorm = 35.5920, GNorm = 2.4589, lr_0 = 1.0000e-04
Validation rmse = 0.113314
Model 0 best validation rmse = 0.113035 on epoch 53
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.088609
Ensemble test rmse = 0.088609
1-fold cross validation
	Seed 0 ==> test rmse = 0.088609
Overall test rmse = 0.088609 +/- 0.000000
Elapsed time = 0:00:42
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,057 | train size = 840 | val size = 211 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.5600e-01, PNorm = 34.0149, GNorm = 7.0189, lr_0 = 4.0937e-04
Validation rmse = 0.270226
Epoch 1
Loss = 7.4802e-01, PNorm = 34.0385, GNorm = 2.4766, lr_0 = 7.1875e-04
Loss = 6.0550e-01, PNorm = 34.0995, GNorm = 5.0303, lr_0 = 1.0000e-03
Validation rmse = 0.224661
Epoch 2
Loss = 4.3107e-01, PNorm = 34.1681, GNorm = 5.9307, lr_0 = 9.7549e-04
Loss = 4.4781e-01, PNorm = 34.2357, GNorm = 4.7914, lr_0 = 9.5159e-04
Validation rmse = 0.187950
Epoch 3
Loss = 3.7242e-01, PNorm = 34.2944, GNorm = 5.9057, lr_0 = 9.2827e-04
Validation rmse = 0.202326
Epoch 4
Loss = 4.3859e-01, PNorm = 34.3486, GNorm = 2.7624, lr_0 = 9.0552e-04
Loss = 3.1351e-01, PNorm = 34.4002, GNorm = 3.1507, lr_0 = 8.8333e-04
Validation rmse = 0.156209
Epoch 5
Loss = 2.4333e-01, PNorm = 34.4509, GNorm = 7.0724, lr_0 = 8.6168e-04
Loss = 2.0569e-01, PNorm = 34.4997, GNorm = 0.6747, lr_0 = 8.4056e-04
Loss = 1.5036e-01, PNorm = 34.5034, GNorm = 3.7397, lr_0 = 8.3848e-04
Validation rmse = 0.137349
Epoch 6
Loss = 1.8619e-01, PNorm = 34.5481, GNorm = 3.0800, lr_0 = 8.1793e-04
Validation rmse = 0.127087
Epoch 7
Loss = 1.4814e-01, PNorm = 34.5857, GNorm = 1.2101, lr_0 = 7.9788e-04
Loss = 1.7149e-01, PNorm = 34.6300, GNorm = 1.6703, lr_0 = 7.7833e-04
Validation rmse = 0.123751
Epoch 8
Loss = 1.4470e-01, PNorm = 34.6705, GNorm = 1.6920, lr_0 = 7.5926e-04
Loss = 1.4106e-01, PNorm = 34.7061, GNorm = 0.7368, lr_0 = 7.4065e-04
Validation rmse = 0.132690
Epoch 9
Loss = 1.3450e-01, PNorm = 34.7374, GNorm = 2.9595, lr_0 = 7.2250e-04
Validation rmse = 0.124194
Epoch 10
Loss = 1.4044e-01, PNorm = 34.7702, GNorm = 2.8542, lr_0 = 7.0479e-04
Loss = 1.2300e-01, PNorm = 34.7951, GNorm = 4.3425, lr_0 = 6.8752e-04
Validation rmse = 0.130605
Epoch 11
Loss = 1.3184e-01, PNorm = 34.8289, GNorm = 1.8865, lr_0 = 6.6901e-04
Loss = 1.3302e-01, PNorm = 34.8527, GNorm = 0.8914, lr_0 = 6.5261e-04
Validation rmse = 0.133484
Epoch 12
Loss = 1.2444e-01, PNorm = 34.8771, GNorm = 2.7859, lr_0 = 6.3662e-04
Validation rmse = 0.112456
Epoch 13
Loss = 1.1154e-01, PNorm = 34.8968, GNorm = 0.9301, lr_0 = 6.2102e-04
Loss = 9.9878e-02, PNorm = 34.9183, GNorm = 1.0780, lr_0 = 6.0580e-04
Validation rmse = 0.115792
Epoch 14
Loss = 1.0205e-01, PNorm = 34.9376, GNorm = 0.9317, lr_0 = 5.9095e-04
Loss = 1.0839e-01, PNorm = 34.9531, GNorm = 2.2106, lr_0 = 5.7647e-04
Validation rmse = 0.112845
Epoch 15
Loss = 1.0122e-01, PNorm = 34.9725, GNorm = 0.8517, lr_0 = 5.6234e-04
Validation rmse = 0.110155
Epoch 16
Loss = 1.0318e-01, PNorm = 34.9901, GNorm = 1.5545, lr_0 = 5.4720e-04
Loss = 9.3182e-02, PNorm = 35.0054, GNorm = 1.3778, lr_0 = 5.3379e-04
Validation rmse = 0.110708
Epoch 17
Loss = 8.6327e-02, PNorm = 35.0219, GNorm = 1.3719, lr_0 = 5.2071e-04
Loss = 9.0963e-02, PNorm = 35.0372, GNorm = 2.1136, lr_0 = 5.0795e-04
Validation rmse = 0.108136
Epoch 18
Loss = 9.4467e-02, PNorm = 35.0519, GNorm = 2.2791, lr_0 = 4.9550e-04
Validation rmse = 0.109557
Epoch 19
Loss = 9.3508e-02, PNorm = 35.0660, GNorm = 2.9358, lr_0 = 4.8336e-04
Loss = 8.8407e-02, PNorm = 35.0781, GNorm = 0.9099, lr_0 = 4.7151e-04
Validation rmse = 0.109066
Epoch 20
Loss = 8.3582e-02, PNorm = 35.0948, GNorm = 1.3945, lr_0 = 4.5996e-04
Loss = 8.2278e-02, PNorm = 35.1079, GNorm = 1.3390, lr_0 = 4.4868e-04
Validation rmse = 0.107252
Epoch 21
Loss = 9.3071e-02, PNorm = 35.1209, GNorm = 1.9134, lr_0 = 4.3660e-04
Validation rmse = 0.107614
Epoch 22
Loss = 9.8822e-02, PNorm = 35.1355, GNorm = 1.6736, lr_0 = 4.2590e-04
Loss = 7.1169e-02, PNorm = 35.1484, GNorm = 0.9228, lr_0 = 4.1547e-04
Validation rmse = 0.106012
Epoch 23
Loss = 7.1996e-02, PNorm = 35.1609, GNorm = 1.1325, lr_0 = 4.0528e-04
Loss = 8.2372e-02, PNorm = 35.1746, GNorm = 0.7537, lr_0 = 3.9535e-04
Validation rmse = 0.111312
Epoch 24
Loss = 8.0148e-02, PNorm = 35.1860, GNorm = 0.8584, lr_0 = 3.8566e-04
Loss = 8.0513e-02, PNorm = 35.2001, GNorm = 1.7609, lr_0 = 3.7621e-04
Validation rmse = 0.108040
Epoch 25
Loss = 7.7091e-02, PNorm = 35.2137, GNorm = 0.9336, lr_0 = 3.6699e-04
Validation rmse = 0.105066
Epoch 26
Loss = 5.7319e-02, PNorm = 35.2262, GNorm = 1.0129, lr_0 = 3.5711e-04
Loss = 7.5617e-02, PNorm = 35.2377, GNorm = 2.8091, lr_0 = 3.4836e-04
Validation rmse = 0.104284
Epoch 27
Loss = 7.1017e-02, PNorm = 35.2472, GNorm = 2.0009, lr_0 = 3.3982e-04
Loss = 6.8647e-02, PNorm = 35.2587, GNorm = 0.9616, lr_0 = 3.3149e-04
Validation rmse = 0.108739
Epoch 28
Loss = 7.8429e-02, PNorm = 35.2709, GNorm = 0.8539, lr_0 = 3.2337e-04
Validation rmse = 0.104552
Epoch 29
Loss = 6.1869e-02, PNorm = 35.2826, GNorm = 2.3123, lr_0 = 3.1544e-04
Loss = 7.3418e-02, PNorm = 35.2898, GNorm = 0.7445, lr_0 = 3.0771e-04
Validation rmse = 0.108911
Epoch 30
Loss = 6.4695e-02, PNorm = 35.3017, GNorm = 0.6338, lr_0 = 3.0017e-04
Loss = 7.7214e-02, PNorm = 35.3116, GNorm = 3.6773, lr_0 = 2.9282e-04
Loss = 9.0903e-02, PNorm = 35.3127, GNorm = 3.1130, lr_0 = 2.9209e-04
Validation rmse = 0.107906
Epoch 31
Loss = 7.8258e-02, PNorm = 35.3220, GNorm = 1.9025, lr_0 = 2.8493e-04
Validation rmse = 0.109085
Epoch 32
Loss = 7.3061e-02, PNorm = 35.3328, GNorm = 2.6464, lr_0 = 2.7795e-04
Loss = 7.2299e-02, PNorm = 35.3432, GNorm = 0.7284, lr_0 = 2.7114e-04
Validation rmse = 0.102726
Epoch 33
Loss = 5.3905e-02, PNorm = 35.3512, GNorm = 1.1390, lr_0 = 2.6449e-04
Loss = 7.3195e-02, PNorm = 35.3599, GNorm = 2.2518, lr_0 = 2.5801e-04
Validation rmse = 0.103554
Epoch 34
Loss = 6.5650e-02, PNorm = 35.3660, GNorm = 1.9774, lr_0 = 2.5169e-04
Validation rmse = 0.104445
Epoch 35
Loss = 5.8927e-02, PNorm = 35.3748, GNorm = 0.6476, lr_0 = 2.4552e-04
Loss = 6.5221e-02, PNorm = 35.3831, GNorm = 2.4960, lr_0 = 2.3950e-04
Validation rmse = 0.101068
Epoch 36
Loss = 6.9724e-02, PNorm = 35.3922, GNorm = 1.4912, lr_0 = 2.3305e-04
Loss = 5.8412e-02, PNorm = 35.3998, GNorm = 1.4353, lr_0 = 2.2734e-04
Validation rmse = 0.103012
Epoch 37
Loss = 6.1410e-02, PNorm = 35.4068, GNorm = 1.3979, lr_0 = 2.2177e-04
Validation rmse = 0.102868
Epoch 38
Loss = 5.6147e-02, PNorm = 35.4138, GNorm = 1.1258, lr_0 = 2.1634e-04
Loss = 6.4952e-02, PNorm = 35.4203, GNorm = 1.7742, lr_0 = 2.1103e-04
Validation rmse = 0.102948
Epoch 39
Loss = 5.9427e-02, PNorm = 35.4274, GNorm = 1.1991, lr_0 = 2.0586e-04
Loss = 6.1830e-02, PNorm = 35.4336, GNorm = 1.5589, lr_0 = 2.0082e-04
Validation rmse = 0.102979
Epoch 40
Loss = 5.6050e-02, PNorm = 35.4410, GNorm = 1.4811, lr_0 = 1.9590e-04
Validation rmse = 0.101712
Epoch 41
Loss = 5.6214e-02, PNorm = 35.4477, GNorm = 0.6240, lr_0 = 1.9062e-04
Loss = 6.1210e-02, PNorm = 35.4543, GNorm = 0.5563, lr_0 = 1.8595e-04
Validation rmse = 0.103718
Epoch 42
Loss = 5.7151e-02, PNorm = 35.4593, GNorm = 0.6368, lr_0 = 1.8139e-04
Loss = 6.4671e-02, PNorm = 35.4650, GNorm = 2.9751, lr_0 = 1.7695e-04
Validation rmse = 0.103231
Epoch 43
Loss = 5.8730e-02, PNorm = 35.4703, GNorm = 1.3650, lr_0 = 1.7261e-04
Validation rmse = 0.101934
Epoch 44
Loss = 4.4539e-02, PNorm = 35.4757, GNorm = 0.6900, lr_0 = 1.6838e-04
Loss = 5.5784e-02, PNorm = 35.4819, GNorm = 0.9263, lr_0 = 1.6425e-04
Validation rmse = 0.101566
Epoch 45
Loss = 4.9228e-02, PNorm = 35.4863, GNorm = 1.2506, lr_0 = 1.6023e-04
Loss = 6.1533e-02, PNorm = 35.4912, GNorm = 1.5285, lr_0 = 1.5630e-04
Validation rmse = 0.102995
Epoch 46
Loss = 5.9409e-02, PNorm = 35.4957, GNorm = 0.6401, lr_0 = 1.5209e-04
Validation rmse = 0.101243
Epoch 47
Loss = 5.7661e-02, PNorm = 35.5004, GNorm = 1.4934, lr_0 = 1.4837e-04
Loss = 5.4080e-02, PNorm = 35.5055, GNorm = 0.7860, lr_0 = 1.4473e-04
Validation rmse = 0.101812
Epoch 48
Loss = 5.7436e-02, PNorm = 35.5097, GNorm = 1.0458, lr_0 = 1.4118e-04
Loss = 5.5109e-02, PNorm = 35.5142, GNorm = 0.5588, lr_0 = 1.3772e-04
Validation rmse = 0.104106
Epoch 49
Loss = 5.3874e-02, PNorm = 35.5185, GNorm = 0.7529, lr_0 = 1.3435e-04
Loss = 5.9536e-02, PNorm = 35.5225, GNorm = 0.7500, lr_0 = 1.3106e-04
Validation rmse = 0.101888
Epoch 50
Loss = 5.5908e-02, PNorm = 35.5267, GNorm = 1.0098, lr_0 = 1.2784e-04
Validation rmse = 0.101580
Epoch 51
Loss = 5.7389e-02, PNorm = 35.5313, GNorm = 0.7138, lr_0 = 1.2440e-04
Loss = 5.0400e-02, PNorm = 35.5352, GNorm = 1.1894, lr_0 = 1.2135e-04
Validation rmse = 0.103149
Epoch 52
Loss = 5.0637e-02, PNorm = 35.5380, GNorm = 0.8070, lr_0 = 1.1838e-04
Loss = 6.0442e-02, PNorm = 35.5424, GNorm = 2.0795, lr_0 = 1.1548e-04
Validation rmse = 0.103528
Epoch 53
Loss = 5.1763e-02, PNorm = 35.5458, GNorm = 0.8363, lr_0 = 1.1265e-04
Validation rmse = 0.101513
Epoch 54
Loss = 6.1077e-02, PNorm = 35.5496, GNorm = 1.9018, lr_0 = 1.0989e-04
Loss = 5.3814e-02, PNorm = 35.5523, GNorm = 1.2675, lr_0 = 1.0719e-04
Validation rmse = 0.101353
Epoch 55
Loss = 5.5472e-02, PNorm = 35.5559, GNorm = 1.1629, lr_0 = 1.0457e-04
Loss = 5.4210e-02, PNorm = 35.5599, GNorm = 0.7065, lr_0 = 1.0200e-04
Loss = 3.1678e-02, PNorm = 35.5601, GNorm = 1.2405, lr_0 = 1.0175e-04
Validation rmse = 0.101556
Epoch 56
Loss = 4.9270e-02, PNorm = 35.5628, GNorm = 0.3788, lr_0 = 1.0000e-04
Validation rmse = 0.101479
Epoch 57
Loss = 4.3865e-02, PNorm = 35.5659, GNorm = 0.9107, lr_0 = 1.0000e-04
Loss = 5.4269e-02, PNorm = 35.5686, GNorm = 1.4227, lr_0 = 1.0000e-04
Validation rmse = 0.102707
Epoch 58
Loss = 5.1325e-02, PNorm = 35.5723, GNorm = 1.0993, lr_0 = 1.0000e-04
Loss = 5.6618e-02, PNorm = 35.5752, GNorm = 1.4973, lr_0 = 1.0000e-04
Validation rmse = 0.101784
Epoch 59
Loss = 5.3910e-02, PNorm = 35.5784, GNorm = 1.0001, lr_0 = 1.0000e-04
Validation rmse = 0.104198
Model 0 best validation rmse = 0.101068 on epoch 35
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.081817
Ensemble test rmse = 0.081817
1-fold cross validation
	Seed 0 ==> test rmse = 0.081817
Overall test rmse = 0.081817 +/- 0.000000
Elapsed time = 0:00:41
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,047 | train size = 832 | val size = 209 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1431e-01, PNorm = 34.0166, GNorm = 2.2669, lr_0 = 4.0937e-04
Validation rmse = 0.313871
Epoch 1
Loss = 7.2071e-01, PNorm = 34.0463, GNorm = 5.3333, lr_0 = 7.1875e-04
Loss = 6.1166e-01, PNorm = 34.1027, GNorm = 9.0280, lr_0 = 1.0000e-03
Validation rmse = 0.229198
Epoch 2
Loss = 4.7851e-01, PNorm = 34.1774, GNorm = 8.4084, lr_0 = 9.7549e-04
Validation rmse = 0.195931
Epoch 3
Loss = 3.7798e-01, PNorm = 34.2478, GNorm = 6.8499, lr_0 = 9.4923e-04
Loss = 3.7368e-01, PNorm = 34.3068, GNorm = 5.1430, lr_0 = 9.2597e-04
Validation rmse = 0.164775
Epoch 4
Loss = 3.0813e-01, PNorm = 34.3632, GNorm = 2.3049, lr_0 = 9.0327e-04
Loss = 2.9580e-01, PNorm = 34.4135, GNorm = 4.4611, lr_0 = 8.8114e-04
Validation rmse = 0.171213
Epoch 5
Loss = 2.3322e-01, PNorm = 34.4615, GNorm = 7.3857, lr_0 = 8.5954e-04
Validation rmse = 0.149165
Epoch 6
Loss = 2.0545e-01, PNorm = 34.5133, GNorm = 3.4919, lr_0 = 8.3640e-04
Loss = 1.9880e-01, PNorm = 34.5604, GNorm = 2.8890, lr_0 = 8.1590e-04
Validation rmse = 0.134505
Epoch 7
Loss = 1.6570e-01, PNorm = 34.6050, GNorm = 2.9953, lr_0 = 7.9591e-04
Loss = 1.6522e-01, PNorm = 34.6470, GNorm = 3.2689, lr_0 = 7.7640e-04
Validation rmse = 0.122659
Epoch 8
Loss = 1.3541e-01, PNorm = 34.6862, GNorm = 1.0424, lr_0 = 7.5737e-04
Validation rmse = 0.116556
Epoch 9
Loss = 1.0955e-01, PNorm = 34.7238, GNorm = 1.7989, lr_0 = 7.3698e-04
Loss = 1.2180e-01, PNorm = 34.7573, GNorm = 1.7104, lr_0 = 7.1892e-04
Validation rmse = 0.124824
Epoch 10
Loss = 1.2029e-01, PNorm = 34.7871, GNorm = 1.6911, lr_0 = 7.0130e-04
Loss = 1.1944e-01, PNorm = 34.8136, GNorm = 1.7506, lr_0 = 6.8412e-04
Validation rmse = 0.141284
Epoch 11
Loss = 1.3794e-01, PNorm = 34.8358, GNorm = 3.5946, lr_0 = 6.6735e-04
Validation rmse = 0.118944
Epoch 12
Loss = 1.2208e-01, PNorm = 34.8642, GNorm = 2.4625, lr_0 = 6.4938e-04
Loss = 1.2493e-01, PNorm = 34.8920, GNorm = 2.6832, lr_0 = 6.3347e-04
Validation rmse = 0.106369
Epoch 13
Loss = 1.2540e-01, PNorm = 34.9109, GNorm = 3.5279, lr_0 = 6.1794e-04
Loss = 1.1414e-01, PNorm = 34.9323, GNorm = 3.0371, lr_0 = 6.0280e-04
Validation rmse = 0.112581
Epoch 14
Loss = 9.3716e-02, PNorm = 34.9526, GNorm = 0.7897, lr_0 = 5.8657e-04
Validation rmse = 0.104493
Epoch 15
Loss = 1.0588e-01, PNorm = 34.9728, GNorm = 1.4569, lr_0 = 5.7219e-04
Loss = 8.6592e-02, PNorm = 34.9919, GNorm = 0.8129, lr_0 = 5.5817e-04
Validation rmse = 0.105451
Epoch 16
Loss = 7.6499e-02, PNorm = 35.0062, GNorm = 0.5195, lr_0 = 5.4449e-04
Loss = 8.5906e-02, PNorm = 35.0224, GNorm = 2.1086, lr_0 = 5.3115e-04
Validation rmse = 0.123578
Epoch 17
Loss = 1.0002e-01, PNorm = 35.0387, GNorm = 3.7540, lr_0 = 5.1685e-04
Validation rmse = 0.103655
Epoch 18
Loss = 8.2610e-02, PNorm = 35.0563, GNorm = 0.8435, lr_0 = 5.0418e-04
Loss = 8.8745e-02, PNorm = 35.0724, GNorm = 4.0266, lr_0 = 4.9182e-04
Validation rmse = 0.108525
Epoch 19
Loss = 8.6223e-02, PNorm = 35.0876, GNorm = 1.2707, lr_0 = 4.7977e-04
Loss = 7.8243e-02, PNorm = 35.1034, GNorm = 1.8692, lr_0 = 4.6801e-04
Validation rmse = 0.107768
Epoch 20
Loss = 7.4026e-02, PNorm = 35.1167, GNorm = 2.8363, lr_0 = 4.5541e-04
Validation rmse = 0.103137
Epoch 21
Loss = 6.9694e-02, PNorm = 35.1311, GNorm = 1.1443, lr_0 = 4.4425e-04
Loss = 7.2526e-02, PNorm = 35.1467, GNorm = 1.8565, lr_0 = 4.3336e-04
Validation rmse = 0.102071
Epoch 22
Loss = 7.5968e-02, PNorm = 35.1594, GNorm = 0.7473, lr_0 = 4.2274e-04
Loss = 7.4837e-02, PNorm = 35.1736, GNorm = 1.1353, lr_0 = 4.1238e-04
Validation rmse = 0.100107
Epoch 23
Loss = 7.1160e-02, PNorm = 35.1872, GNorm = 1.2277, lr_0 = 4.0128e-04
Validation rmse = 0.099025
Epoch 24
Loss = 8.8283e-02, PNorm = 35.1981, GNorm = 1.0337, lr_0 = 3.9145e-04
Loss = 7.2531e-02, PNorm = 35.2115, GNorm = 0.6722, lr_0 = 3.8185e-04
Validation rmse = 0.106209
Epoch 25
Loss = 7.8600e-02, PNorm = 35.2212, GNorm = 2.4505, lr_0 = 3.7250e-04
Loss = 7.1864e-02, PNorm = 35.2324, GNorm = 3.3319, lr_0 = 3.6337e-04
Validation rmse = 0.100357
Epoch 26
Loss = 8.8763e-02, PNorm = 35.2440, GNorm = 2.9225, lr_0 = 3.5358e-04
Validation rmse = 0.101597
Epoch 27
Loss = 5.2962e-02, PNorm = 35.2547, GNorm = 1.1444, lr_0 = 3.4492e-04
Loss = 8.4192e-02, PNorm = 35.2652, GNorm = 2.9086, lr_0 = 3.3646e-04
Validation rmse = 0.105606
Epoch 28
Loss = 6.8646e-02, PNorm = 35.2787, GNorm = 1.7264, lr_0 = 3.2741e-04
Loss = 6.9352e-02, PNorm = 35.2882, GNorm = 0.8693, lr_0 = 3.1938e-04
Validation rmse = 0.100339
Epoch 29
Loss = 6.5710e-02, PNorm = 35.2983, GNorm = 0.9338, lr_0 = 3.1155e-04
Validation rmse = 0.113187
Epoch 30
Loss = 8.7631e-02, PNorm = 35.3057, GNorm = 3.1914, lr_0 = 3.0392e-04
Loss = 6.7301e-02, PNorm = 35.3158, GNorm = 0.6985, lr_0 = 2.9647e-04
Validation rmse = 0.097366
Epoch 31
Loss = 6.7278e-02, PNorm = 35.3272, GNorm = 1.6560, lr_0 = 2.8849e-04
Loss = 6.6432e-02, PNorm = 35.3353, GNorm = 1.4220, lr_0 = 2.8142e-04
Validation rmse = 0.095923
Epoch 32
Loss = 6.9700e-02, PNorm = 35.3424, GNorm = 2.2429, lr_0 = 2.7452e-04
Validation rmse = 0.097676
Epoch 33
Loss = 6.5480e-02, PNorm = 35.3512, GNorm = 1.3735, lr_0 = 2.6779e-04
Loss = 6.1021e-02, PNorm = 35.3592, GNorm = 1.5599, lr_0 = 2.6123e-04
Validation rmse = 0.098023
Epoch 34
Loss = 6.1949e-02, PNorm = 35.3678, GNorm = 1.7976, lr_0 = 2.5420e-04
Loss = 5.9248e-02, PNorm = 35.3724, GNorm = 1.8926, lr_0 = 2.4797e-04
Validation rmse = 0.096766
Epoch 35
Loss = 5.5267e-02, PNorm = 35.3799, GNorm = 1.0000, lr_0 = 2.4189e-04
Validation rmse = 0.096073
Epoch 36
Loss = 7.8052e-02, PNorm = 35.3866, GNorm = 0.6331, lr_0 = 2.3596e-04
Loss = 5.6976e-02, PNorm = 35.3925, GNorm = 0.8926, lr_0 = 2.3018e-04
Validation rmse = 0.096968
Epoch 37
Loss = 6.2116e-02, PNorm = 35.4010, GNorm = 1.4567, lr_0 = 2.2398e-04
Loss = 5.2817e-02, PNorm = 35.4070, GNorm = 0.9619, lr_0 = 2.1849e-04
Validation rmse = 0.095689
Epoch 38
Loss = 5.4754e-02, PNorm = 35.4130, GNorm = 1.3167, lr_0 = 2.1314e-04
Validation rmse = 0.099275
Epoch 39
Loss = 6.6905e-02, PNorm = 35.4201, GNorm = 2.4749, lr_0 = 2.0740e-04
Loss = 5.8968e-02, PNorm = 35.4269, GNorm = 1.8750, lr_0 = 2.0232e-04
Validation rmse = 0.096093
Epoch 40
Loss = 5.3659e-02, PNorm = 35.4320, GNorm = 2.4202, lr_0 = 1.9736e-04
Loss = 5.7251e-02, PNorm = 35.4381, GNorm = 1.8384, lr_0 = 1.9252e-04
Validation rmse = 0.095861
Epoch 41
Loss = 6.0533e-02, PNorm = 35.4435, GNorm = 1.0933, lr_0 = 1.8780e-04
Validation rmse = 0.096552
Epoch 42
Loss = 4.5626e-02, PNorm = 35.4496, GNorm = 0.4625, lr_0 = 1.8275e-04
Loss = 5.7706e-02, PNorm = 35.4549, GNorm = 2.7252, lr_0 = 1.7827e-04
Validation rmse = 0.097351
Epoch 43
Loss = 5.2338e-02, PNorm = 35.4587, GNorm = 1.3868, lr_0 = 1.7390e-04
Loss = 5.6866e-02, PNorm = 35.4637, GNorm = 1.6908, lr_0 = 1.6964e-04
Validation rmse = 0.097318
Epoch 44
Loss = 5.3110e-02, PNorm = 35.4691, GNorm = 0.6207, lr_0 = 1.6548e-04
Validation rmse = 0.094955
Epoch 45
Loss = 5.2188e-02, PNorm = 35.4731, GNorm = 1.7418, lr_0 = 1.6103e-04
Loss = 5.2410e-02, PNorm = 35.4779, GNorm = 1.2067, lr_0 = 1.5708e-04
Validation rmse = 0.097197
Epoch 46
Loss = 5.1310e-02, PNorm = 35.4818, GNorm = 1.1559, lr_0 = 1.5323e-04
Loss = 5.3781e-02, PNorm = 35.4856, GNorm = 0.8173, lr_0 = 1.4948e-04
Validation rmse = 0.095616
Epoch 47
Loss = 5.0883e-02, PNorm = 35.4898, GNorm = 1.2122, lr_0 = 1.4581e-04
Validation rmse = 0.097011
Epoch 48
Loss = 4.8900e-02, PNorm = 35.4935, GNorm = 0.9738, lr_0 = 1.4189e-04
Loss = 5.4184e-02, PNorm = 35.4983, GNorm = 0.5714, lr_0 = 1.3841e-04
Validation rmse = 0.096227
Epoch 49
Loss = 5.5425e-02, PNorm = 35.5014, GNorm = 1.1201, lr_0 = 1.3502e-04
Loss = 4.9002e-02, PNorm = 35.5050, GNorm = 1.1729, lr_0 = 1.3171e-04
Validation rmse = 0.094951
Epoch 50
Loss = 5.0281e-02, PNorm = 35.5091, GNorm = 0.7164, lr_0 = 1.2848e-04
Validation rmse = 0.096615
Epoch 51
Loss = 4.8210e-02, PNorm = 35.5132, GNorm = 0.8855, lr_0 = 1.2502e-04
Loss = 5.6667e-02, PNorm = 35.5167, GNorm = 3.2594, lr_0 = 1.2196e-04
Validation rmse = 0.095474
Epoch 52
Loss = 5.3323e-02, PNorm = 35.5204, GNorm = 0.8617, lr_0 = 1.1897e-04
Loss = 4.9673e-02, PNorm = 35.5231, GNorm = 1.2188, lr_0 = 1.1605e-04
Validation rmse = 0.095617
Epoch 53
Loss = 5.1859e-02, PNorm = 35.5267, GNorm = 2.4234, lr_0 = 1.1293e-04
Validation rmse = 0.095688
Epoch 54
Loss = 4.0439e-02, PNorm = 35.5303, GNorm = 1.4050, lr_0 = 1.1016e-04
Loss = 5.7857e-02, PNorm = 35.5333, GNorm = 1.9002, lr_0 = 1.0746e-04
Validation rmse = 0.094860
Epoch 55
Loss = 5.3593e-02, PNorm = 35.5364, GNorm = 1.4379, lr_0 = 1.0483e-04
Loss = 5.0942e-02, PNorm = 35.5391, GNorm = 2.0339, lr_0 = 1.0226e-04
Validation rmse = 0.094604
Epoch 56
Loss = 4.9260e-02, PNorm = 35.5416, GNorm = 1.2442, lr_0 = 1.0000e-04
Validation rmse = 0.095160
Epoch 57
Loss = 4.3709e-02, PNorm = 35.5444, GNorm = 0.4315, lr_0 = 1.0000e-04
Loss = 5.1173e-02, PNorm = 35.5470, GNorm = 2.0932, lr_0 = 1.0000e-04
Validation rmse = 0.094698
Epoch 58
Loss = 4.9407e-02, PNorm = 35.5498, GNorm = 2.4940, lr_0 = 1.0000e-04
Loss = 4.9846e-02, PNorm = 35.5525, GNorm = 1.5488, lr_0 = 1.0000e-04
Validation rmse = 0.095444
Epoch 59
Loss = 4.6985e-02, PNorm = 35.5548, GNorm = 1.2669, lr_0 = 1.0000e-04
Validation rmse = 0.094387
Model 0 best validation rmse = 0.094387 on epoch 59
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.094524
Ensemble test rmse = 0.094524
1-fold cross validation
	Seed 0 ==> test rmse = 0.094524
Overall test rmse = 0.094524 +/- 0.000000
Elapsed time = 0:00:38
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,037 | train size = 824 | val size = 207 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.3687e-01, PNorm = 34.0166, GNorm = 3.9230, lr_0 = 4.0937e-04
Validation rmse = 0.295851
Epoch 1
Loss = 7.2661e-01, PNorm = 34.0419, GNorm = 3.5977, lr_0 = 7.1875e-04
Loss = 6.4199e-01, PNorm = 34.0962, GNorm = 5.0086, lr_0 = 1.0000e-03
Validation rmse = 0.262906
Epoch 2
Loss = 6.4380e-01, PNorm = 34.1605, GNorm = 8.2604, lr_0 = 9.7308e-04
Validation rmse = 0.234851
Epoch 3
Loss = 5.2899e-01, PNorm = 34.2329, GNorm = 3.8996, lr_0 = 9.4923e-04
Loss = 3.9183e-01, PNorm = 34.3036, GNorm = 3.0085, lr_0 = 9.2597e-04
Validation rmse = 0.211872
Epoch 4
Loss = 3.0388e-01, PNorm = 34.3696, GNorm = 1.2237, lr_0 = 9.0103e-04
Loss = 2.9272e-01, PNorm = 34.4337, GNorm = 2.6116, lr_0 = 8.7895e-04
Validation rmse = 0.182336
Epoch 5
Loss = 2.5533e-01, PNorm = 34.4921, GNorm = 4.2201, lr_0 = 8.5741e-04
Validation rmse = 0.157834
Epoch 6
Loss = 1.6819e-01, PNorm = 34.5482, GNorm = 2.1158, lr_0 = 8.3433e-04
Loss = 1.9771e-01, PNorm = 34.5923, GNorm = 0.9361, lr_0 = 8.1388e-04
Validation rmse = 0.147357
Epoch 7
Loss = 1.5409e-01, PNorm = 34.6371, GNorm = 1.9532, lr_0 = 7.9393e-04
Loss = 1.5033e-01, PNorm = 34.6778, GNorm = 2.3555, lr_0 = 7.7448e-04
Validation rmse = 0.155283
Epoch 8
Loss = 1.5279e-01, PNorm = 34.7255, GNorm = 1.2593, lr_0 = 7.5362e-04
Validation rmse = 0.130137
Epoch 9
Loss = 1.0541e-01, PNorm = 34.7620, GNorm = 1.0116, lr_0 = 7.3516e-04
Loss = 1.2405e-01, PNorm = 34.7903, GNorm = 1.5711, lr_0 = 7.1714e-04
Validation rmse = 0.122799
Epoch 10
Loss = 1.1514e-01, PNorm = 34.8254, GNorm = 1.6269, lr_0 = 6.9783e-04
Loss = 1.2432e-01, PNorm = 34.8508, GNorm = 1.3832, lr_0 = 6.8073e-04
Validation rmse = 0.138620
Epoch 11
Loss = 1.1538e-01, PNorm = 34.8773, GNorm = 0.6260, lr_0 = 6.6405e-04
Validation rmse = 0.118075
Epoch 12
Loss = 7.8338e-02, PNorm = 34.9030, GNorm = 0.8962, lr_0 = 6.4617e-04
Loss = 1.0327e-01, PNorm = 34.9218, GNorm = 0.8361, lr_0 = 6.3033e-04
Validation rmse = 0.113233
Epoch 13
Loss = 8.8579e-02, PNorm = 34.9410, GNorm = 1.2634, lr_0 = 6.1488e-04
Loss = 8.7516e-02, PNorm = 34.9603, GNorm = 0.6439, lr_0 = 5.9981e-04
Loss = 7.6696e-02, PNorm = 34.9622, GNorm = 1.4709, lr_0 = 5.9833e-04
Validation rmse = 0.114380
Epoch 14
Loss = 7.4464e-02, PNorm = 34.9792, GNorm = 3.3186, lr_0 = 5.8367e-04
Validation rmse = 0.112755
Epoch 15
Loss = 9.2831e-02, PNorm = 34.9985, GNorm = 0.7275, lr_0 = 5.6936e-04
Loss = 8.4635e-02, PNorm = 35.0147, GNorm = 1.1520, lr_0 = 5.5541e-04
Validation rmse = 0.108310
Epoch 16
Loss = 7.7366e-02, PNorm = 35.0330, GNorm = 1.5159, lr_0 = 5.4045e-04
Loss = 8.7805e-02, PNorm = 35.0475, GNorm = 3.8665, lr_0 = 5.2721e-04
Validation rmse = 0.116935
Epoch 17
Loss = 8.3852e-02, PNorm = 35.0613, GNorm = 1.0378, lr_0 = 5.1429e-04
Validation rmse = 0.109277
Epoch 18
Loss = 8.7650e-02, PNorm = 35.0788, GNorm = 1.2674, lr_0 = 5.0044e-04
Loss = 6.8719e-02, PNorm = 35.0956, GNorm = 1.1534, lr_0 = 4.8818e-04
Validation rmse = 0.109732
Epoch 19
Loss = 7.7461e-02, PNorm = 35.1079, GNorm = 1.4048, lr_0 = 4.7621e-04
Validation rmse = 0.110037
Epoch 20
Loss = 7.7812e-02, PNorm = 35.1257, GNorm = 1.9247, lr_0 = 4.6339e-04
Loss = 8.0298e-02, PNorm = 35.1406, GNorm = 2.4013, lr_0 = 4.5204e-04
Validation rmse = 0.106632
Epoch 21
Loss = 6.5345e-02, PNorm = 35.1555, GNorm = 1.3994, lr_0 = 4.4096e-04
Loss = 7.7277e-02, PNorm = 35.1698, GNorm = 1.3432, lr_0 = 4.3015e-04
Validation rmse = 0.107988
Epoch 22
Loss = 7.4420e-02, PNorm = 35.1835, GNorm = 0.7131, lr_0 = 4.1857e-04
Validation rmse = 0.107565
Epoch 23
Loss = 7.9932e-02, PNorm = 35.1958, GNorm = 1.7057, lr_0 = 4.0831e-04
Loss = 6.6226e-02, PNorm = 35.2051, GNorm = 1.4959, lr_0 = 3.9830e-04
Validation rmse = 0.103510
Epoch 24
Loss = 5.9773e-02, PNorm = 35.2184, GNorm = 1.1816, lr_0 = 3.8758e-04
Loss = 7.4370e-02, PNorm = 35.2293, GNorm = 3.4610, lr_0 = 3.7808e-04
Validation rmse = 0.107834
Epoch 25
Loss = 6.8795e-02, PNorm = 35.2423, GNorm = 0.8701, lr_0 = 3.6882e-04
Validation rmse = 0.105718
Epoch 26
Loss = 5.9605e-02, PNorm = 35.2541, GNorm = 0.4177, lr_0 = 3.5889e-04
Loss = 6.6974e-02, PNorm = 35.2647, GNorm = 2.6014, lr_0 = 3.5009e-04
Validation rmse = 0.103339
Epoch 27
Loss = 7.3881e-02, PNorm = 35.2759, GNorm = 0.6354, lr_0 = 3.4067e-04
Loss = 5.7653e-02, PNorm = 35.2862, GNorm = 0.7128, lr_0 = 3.3232e-04
Validation rmse = 0.102738
Epoch 28
Loss = 5.9870e-02, PNorm = 35.2959, GNorm = 1.4143, lr_0 = 3.2417e-04
Validation rmse = 0.104786
Epoch 29
Loss = 6.1650e-02, PNorm = 35.3058, GNorm = 2.7065, lr_0 = 3.1544e-04
Loss = 6.2431e-02, PNorm = 35.3143, GNorm = 1.9375, lr_0 = 3.0771e-04
Validation rmse = 0.103103
Epoch 30
Loss = 7.1808e-02, PNorm = 35.3243, GNorm = 0.4754, lr_0 = 3.0017e-04
Loss = 6.2979e-02, PNorm = 35.3340, GNorm = 2.1399, lr_0 = 2.9282e-04
Loss = 4.6835e-02, PNorm = 35.3350, GNorm = 0.8198, lr_0 = 2.9209e-04
Validation rmse = 0.105267
Epoch 31
Loss = 6.4264e-02, PNorm = 35.3439, GNorm = 0.4582, lr_0 = 2.8493e-04
Validation rmse = 0.105703
Epoch 32
Loss = 5.1538e-02, PNorm = 35.3513, GNorm = 0.6403, lr_0 = 2.7795e-04
Loss = 5.9697e-02, PNorm = 35.3595, GNorm = 0.6430, lr_0 = 2.7114e-04
Validation rmse = 0.102914
Epoch 33
Loss = 5.2436e-02, PNorm = 35.3667, GNorm = 0.9637, lr_0 = 2.6384e-04
Loss = 6.8087e-02, PNorm = 35.3750, GNorm = 1.6433, lr_0 = 2.5737e-04
Validation rmse = 0.106919
Epoch 34
Loss = 5.4254e-02, PNorm = 35.3824, GNorm = 0.8599, lr_0 = 2.5106e-04
Validation rmse = 0.104001
Epoch 35
Loss = 6.5059e-02, PNorm = 35.3903, GNorm = 2.9424, lr_0 = 2.4430e-04
Loss = 6.4204e-02, PNorm = 35.3981, GNorm = 0.6374, lr_0 = 2.3832e-04
Validation rmse = 0.103630
Epoch 36
Loss = 6.1539e-02, PNorm = 35.4058, GNorm = 1.5347, lr_0 = 2.3248e-04
Validation rmse = 0.102760
Epoch 37
Loss = 5.4111e-02, PNorm = 35.4122, GNorm = 0.8147, lr_0 = 2.2622e-04
Loss = 5.5550e-02, PNorm = 35.4189, GNorm = 0.6579, lr_0 = 2.2067e-04
Validation rmse = 0.100734
Epoch 38
Loss = 6.1205e-02, PNorm = 35.4246, GNorm = 0.6494, lr_0 = 2.1527e-04
Loss = 5.5852e-02, PNorm = 35.4308, GNorm = 1.4998, lr_0 = 2.0999e-04
Validation rmse = 0.100943
Epoch 39
Loss = 4.7900e-02, PNorm = 35.4375, GNorm = 0.8313, lr_0 = 2.0434e-04
Validation rmse = 0.100628
Epoch 40
Loss = 4.9057e-02, PNorm = 35.4423, GNorm = 0.6888, lr_0 = 1.9933e-04
Loss = 5.0814e-02, PNorm = 35.4470, GNorm = 0.4937, lr_0 = 1.9444e-04
Validation rmse = 0.102114
Epoch 41
Loss = 5.3872e-02, PNorm = 35.4526, GNorm = 0.5751, lr_0 = 1.8921e-04
Loss = 5.4344e-02, PNorm = 35.4582, GNorm = 0.8494, lr_0 = 1.8457e-04
Validation rmse = 0.099086
Epoch 42
Loss = 5.2798e-02, PNorm = 35.4631, GNorm = 0.8622, lr_0 = 1.8005e-04
Validation rmse = 0.102995
Epoch 43
Loss = 6.4267e-02, PNorm = 35.4686, GNorm = 2.5472, lr_0 = 1.7520e-04
Loss = 5.2844e-02, PNorm = 35.4736, GNorm = 0.6136, lr_0 = 1.7091e-04
Validation rmse = 0.103222
Epoch 44
Loss = 4.2818e-02, PNorm = 35.4778, GNorm = 1.5198, lr_0 = 1.6672e-04
Loss = 6.3774e-02, PNorm = 35.4824, GNorm = 1.4126, lr_0 = 1.6263e-04
Validation rmse = 0.101082
Epoch 45
Loss = 5.8344e-02, PNorm = 35.4890, GNorm = 1.4162, lr_0 = 1.5825e-04
Validation rmse = 0.098892
Epoch 46
Loss = 5.3223e-02, PNorm = 35.4939, GNorm = 0.4595, lr_0 = 1.5438e-04
Loss = 5.2037e-02, PNorm = 35.4981, GNorm = 0.6579, lr_0 = 1.5059e-04
Validation rmse = 0.099112
Epoch 47
Loss = 4.9974e-02, PNorm = 35.5015, GNorm = 2.8626, lr_0 = 1.4654e-04
Loss = 5.2898e-02, PNorm = 35.5063, GNorm = 1.8608, lr_0 = 1.4295e-04
Validation rmse = 0.109077
Epoch 48
Loss = 5.3542e-02, PNorm = 35.5108, GNorm = 2.0525, lr_0 = 1.3944e-04
Validation rmse = 0.099303
Epoch 49
Loss = 5.5035e-02, PNorm = 35.5149, GNorm = 1.2890, lr_0 = 1.3569e-04
Loss = 4.7170e-02, PNorm = 35.5186, GNorm = 0.7334, lr_0 = 1.3236e-04
Validation rmse = 0.098599
Epoch 50
Loss = 4.5716e-02, PNorm = 35.5221, GNorm = 1.4227, lr_0 = 1.2912e-04
Loss = 5.1602e-02, PNorm = 35.5260, GNorm = 1.1535, lr_0 = 1.2596e-04
Loss = 5.6309e-02, PNorm = 35.5262, GNorm = 1.1785, lr_0 = 1.2564e-04
Validation rmse = 0.099989
Epoch 51
Loss = 5.3939e-02, PNorm = 35.5291, GNorm = 1.5249, lr_0 = 1.2256e-04
Validation rmse = 0.099776
Epoch 52
Loss = 5.5463e-02, PNorm = 35.5326, GNorm = 0.9685, lr_0 = 1.1926e-04
Loss = 4.5062e-02, PNorm = 35.5360, GNorm = 1.5106, lr_0 = 1.1634e-04
Validation rmse = 0.099799
Epoch 53
Loss = 4.4963e-02, PNorm = 35.5386, GNorm = 1.4930, lr_0 = 1.1349e-04
Validation rmse = 0.099772
Epoch 54
Loss = 4.6940e-02, PNorm = 35.5423, GNorm = 1.4549, lr_0 = 1.1043e-04
Loss = 4.8287e-02, PNorm = 35.5452, GNorm = 1.0722, lr_0 = 1.0773e-04
Validation rmse = 0.103732
Epoch 55
Loss = 4.5565e-02, PNorm = 35.5477, GNorm = 1.1618, lr_0 = 1.0509e-04
Loss = 5.3753e-02, PNorm = 35.5508, GNorm = 0.5560, lr_0 = 1.0251e-04
Validation rmse = 0.100683
Epoch 56
Loss = 4.7963e-02, PNorm = 35.5536, GNorm = 0.7826, lr_0 = 1.0000e-04
Validation rmse = 0.100878
Epoch 57
Loss = 5.1674e-02, PNorm = 35.5563, GNorm = 1.0055, lr_0 = 1.0000e-04
Loss = 4.5871e-02, PNorm = 35.5597, GNorm = 0.8140, lr_0 = 1.0000e-04
Validation rmse = 0.099346
Epoch 58
Loss = 4.0985e-02, PNorm = 35.5624, GNorm = 0.9153, lr_0 = 1.0000e-04
Loss = 4.8708e-02, PNorm = 35.5655, GNorm = 0.5059, lr_0 = 1.0000e-04
Validation rmse = 0.099840
Epoch 59
Loss = 4.4581e-02, PNorm = 35.5680, GNorm = 0.3770, lr_0 = 1.0000e-04
Validation rmse = 0.100921
Model 0 best validation rmse = 0.098599 on epoch 49
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.084122
Ensemble test rmse = 0.084122
1-fold cross validation
	Seed 0 ==> test rmse = 0.084122
Overall test rmse = 0.084122 +/- 0.000000
Elapsed time = 0:00:41
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,027 | train size = 816 | val size = 205 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1843e-01, PNorm = 34.0169, GNorm = 3.2695, lr_0 = 4.0937e-04
Validation rmse = 0.273976
Epoch 1
Loss = 6.2942e-01, PNorm = 34.0488, GNorm = 3.5747, lr_0 = 7.1875e-04
Loss = 5.4569e-01, PNorm = 34.1059, GNorm = 2.5494, lr_0 = 1.0000e-03
Validation rmse = 0.307272
Epoch 2
Loss = 4.8704e-01, PNorm = 34.1796, GNorm = 1.0448, lr_0 = 9.7308e-04
Validation rmse = 0.198387
Epoch 3
Loss = 3.2455e-01, PNorm = 34.2514, GNorm = 1.3236, lr_0 = 9.4688e-04
Loss = 3.0417e-01, PNorm = 34.3121, GNorm = 2.6217, lr_0 = 9.2367e-04
Validation rmse = 0.170881
Epoch 4
Loss = 2.3657e-01, PNorm = 34.3758, GNorm = 0.9723, lr_0 = 9.0103e-04
Loss = 2.2402e-01, PNorm = 34.4316, GNorm = 2.6431, lr_0 = 8.7895e-04
Validation rmse = 0.213183
Epoch 5
Loss = 3.3915e-01, PNorm = 34.4801, GNorm = 6.2171, lr_0 = 8.5529e-04
Validation rmse = 0.154659
Epoch 6
Loss = 1.9865e-01, PNorm = 34.5271, GNorm = 2.5047, lr_0 = 8.3226e-04
Loss = 1.7523e-01, PNorm = 34.5686, GNorm = 0.8085, lr_0 = 8.1186e-04
Validation rmse = 0.146342
Epoch 7
Loss = 1.8033e-01, PNorm = 34.6040, GNorm = 3.4021, lr_0 = 7.9197e-04
Loss = 1.2995e-01, PNorm = 34.6369, GNorm = 0.7320, lr_0 = 7.7256e-04
Loss = 1.1790e-01, PNorm = 34.6403, GNorm = 6.7713, lr_0 = 7.7064e-04
Validation rmse = 0.134930
Epoch 8
Loss = 1.3630e-01, PNorm = 34.6682, GNorm = 4.4360, lr_0 = 7.5176e-04
Validation rmse = 0.131746
Epoch 9
Loss = 1.2038e-01, PNorm = 34.6968, GNorm = 3.2780, lr_0 = 7.3152e-04
Loss = 1.3089e-01, PNorm = 34.7258, GNorm = 4.4898, lr_0 = 7.1359e-04
Validation rmse = 0.129516
Epoch 10
Loss = 1.3322e-01, PNorm = 34.7540, GNorm = 3.1762, lr_0 = 6.9610e-04
Validation rmse = 0.147223
Epoch 11
Loss = 2.0407e-01, PNorm = 34.7791, GNorm = 5.7887, lr_0 = 6.7736e-04
Loss = 1.1774e-01, PNorm = 34.8006, GNorm = 4.2284, lr_0 = 6.6076e-04
Validation rmse = 0.121241
Epoch 12
Loss = 8.8927e-02, PNorm = 34.8221, GNorm = 0.7354, lr_0 = 6.4297e-04
Loss = 9.7930e-02, PNorm = 34.8415, GNorm = 0.9744, lr_0 = 6.2721e-04
Validation rmse = 0.122029
Epoch 13
Loss = 1.2143e-01, PNorm = 34.8554, GNorm = 2.2737, lr_0 = 6.1184e-04
Validation rmse = 0.119086
Epoch 14
Loss = 1.0533e-01, PNorm = 34.8760, GNorm = 3.0478, lr_0 = 5.9537e-04
Loss = 1.0463e-01, PNorm = 34.8926, GNorm = 4.3389, lr_0 = 5.8078e-04
Validation rmse = 0.117171
Epoch 15
Loss = 8.5043e-02, PNorm = 34.9094, GNorm = 1.3207, lr_0 = 5.6514e-04
Loss = 9.0935e-02, PNorm = 34.9188, GNorm = 1.4973, lr_0 = 5.5129e-04
Validation rmse = 0.142267
Epoch 16
Loss = 1.0455e-01, PNorm = 34.9363, GNorm = 1.3571, lr_0 = 5.3778e-04
Validation rmse = 0.125582
Epoch 17
Loss = 1.1217e-01, PNorm = 34.9524, GNorm = 1.0131, lr_0 = 5.2330e-04
Loss = 8.9110e-02, PNorm = 34.9644, GNorm = 3.0995, lr_0 = 5.1047e-04
Validation rmse = 0.112971
Epoch 18
Loss = 7.7378e-02, PNorm = 34.9799, GNorm = 1.1644, lr_0 = 4.9673e-04
Loss = 7.7038e-02, PNorm = 34.9929, GNorm = 0.7814, lr_0 = 4.8456e-04
Validation rmse = 0.111380
Epoch 19
Loss = 7.9827e-02, PNorm = 35.0057, GNorm = 1.0765, lr_0 = 4.7268e-04
Validation rmse = 0.111522
Epoch 20
Loss = 9.2532e-02, PNorm = 35.0159, GNorm = 2.0153, lr_0 = 4.5996e-04
Loss = 9.3794e-02, PNorm = 35.0242, GNorm = 5.6120, lr_0 = 4.4868e-04
Validation rmse = 0.110180
Epoch 21
Loss = 7.5101e-02, PNorm = 35.0403, GNorm = 0.8556, lr_0 = 4.3660e-04
Validation rmse = 0.108364
Epoch 22
Loss = 8.3347e-02, PNorm = 35.0523, GNorm = 1.9141, lr_0 = 4.2590e-04
Loss = 6.9445e-02, PNorm = 35.0603, GNorm = 1.7616, lr_0 = 4.1547e-04
Validation rmse = 0.108828
Epoch 23
Loss = 8.2166e-02, PNorm = 35.0710, GNorm = 3.7556, lr_0 = 4.0428e-04
Loss = 7.9853e-02, PNorm = 35.0810, GNorm = 1.6669, lr_0 = 3.9437e-04
Validation rmse = 0.106268
Epoch 24
Loss = 6.8634e-02, PNorm = 35.0921, GNorm = 0.7122, lr_0 = 3.8375e-04
Validation rmse = 0.106420
Epoch 25
Loss = 5.5120e-02, PNorm = 35.1036, GNorm = 0.4264, lr_0 = 3.7435e-04
Loss = 7.3574e-02, PNorm = 35.1144, GNorm = 2.2642, lr_0 = 3.6517e-04
Validation rmse = 0.109667
Epoch 26
Loss = 6.7372e-02, PNorm = 35.1217, GNorm = 1.4013, lr_0 = 3.5534e-04
Loss = 7.1207e-02, PNorm = 35.1303, GNorm = 1.4415, lr_0 = 3.4663e-04
Loss = 5.3311e-02, PNorm = 35.1314, GNorm = 1.1120, lr_0 = 3.4577e-04
Validation rmse = 0.110048
Epoch 27
Loss = 7.6058e-02, PNorm = 35.1413, GNorm = 1.1120, lr_0 = 3.3730e-04
Validation rmse = 0.106733
Epoch 28
Loss = 6.7381e-02, PNorm = 35.1507, GNorm = 0.7786, lr_0 = 3.2822e-04
Loss = 6.2948e-02, PNorm = 35.1600, GNorm = 1.4477, lr_0 = 3.2018e-04
Validation rmse = 0.103306
Epoch 29
Loss = 6.4919e-02, PNorm = 35.1675, GNorm = 0.6100, lr_0 = 3.1233e-04
Validation rmse = 0.112655
Epoch 30
Loss = 7.3646e-02, PNorm = 35.1754, GNorm = 3.1239, lr_0 = 3.0392e-04
Loss = 8.3745e-02, PNorm = 35.1843, GNorm = 2.3953, lr_0 = 2.9647e-04
Validation rmse = 0.103923
Epoch 31
Loss = 6.6576e-02, PNorm = 35.1922, GNorm = 0.4927, lr_0 = 2.8849e-04
Loss = 6.0008e-02, PNorm = 35.2005, GNorm = 1.6974, lr_0 = 2.8142e-04
Validation rmse = 0.102337
Epoch 32
Loss = 5.6013e-02, PNorm = 35.2106, GNorm = 1.0490, lr_0 = 2.7452e-04
Validation rmse = 0.111533
Epoch 33
Loss = 9.1123e-02, PNorm = 35.2172, GNorm = 2.7658, lr_0 = 2.6713e-04
Loss = 5.9151e-02, PNorm = 35.2244, GNorm = 2.2598, lr_0 = 2.6058e-04
Validation rmse = 0.104765
Epoch 34
Loss = 6.5319e-02, PNorm = 35.2310, GNorm = 3.7773, lr_0 = 2.5357e-04
Loss = 6.0598e-02, PNorm = 35.2378, GNorm = 1.3815, lr_0 = 2.4735e-04
Validation rmse = 0.103189
Epoch 35
Loss = 6.0069e-02, PNorm = 35.2424, GNorm = 1.2233, lr_0 = 2.4129e-04
Validation rmse = 0.102768
Epoch 36
Loss = 6.2251e-02, PNorm = 35.2495, GNorm = 2.0279, lr_0 = 2.3480e-04
Loss = 5.7927e-02, PNorm = 35.2559, GNorm = 1.6396, lr_0 = 2.2904e-04
Validation rmse = 0.101111
Epoch 37
Loss = 5.5883e-02, PNorm = 35.2635, GNorm = 0.9422, lr_0 = 2.2287e-04
Loss = 6.0560e-02, PNorm = 35.2689, GNorm = 1.5455, lr_0 = 2.1741e-04
Validation rmse = 0.101982
Epoch 38
Loss = 5.6356e-02, PNorm = 35.2744, GNorm = 2.7825, lr_0 = 2.1208e-04
Validation rmse = 0.102769
Epoch 39
Loss = 6.4409e-02, PNorm = 35.2806, GNorm = 0.9544, lr_0 = 2.0637e-04
Loss = 5.9847e-02, PNorm = 35.2849, GNorm = 2.3226, lr_0 = 2.0132e-04
Validation rmse = 0.099342
Epoch 40
Loss = 5.5226e-02, PNorm = 35.2908, GNorm = 1.6461, lr_0 = 1.9590e-04
Validation rmse = 0.099550
Epoch 41
Loss = 4.7947e-02, PNorm = 35.2952, GNorm = 0.6556, lr_0 = 1.9110e-04
Loss = 5.7734e-02, PNorm = 35.2994, GNorm = 0.9820, lr_0 = 1.8641e-04
Validation rmse = 0.099455
Epoch 42
Loss = 5.5274e-02, PNorm = 35.3043, GNorm = 1.5838, lr_0 = 1.8139e-04
Loss = 5.2912e-02, PNorm = 35.3090, GNorm = 0.4467, lr_0 = 1.7695e-04
Validation rmse = 0.101068
Epoch 43
Loss = 5.9709e-02, PNorm = 35.3146, GNorm = 0.8360, lr_0 = 1.7218e-04
Validation rmse = 0.101950
Epoch 44
Loss = 5.4281e-02, PNorm = 35.3194, GNorm = 2.5110, lr_0 = 1.6796e-04
Loss = 5.6029e-02, PNorm = 35.3246, GNorm = 0.6446, lr_0 = 1.6385e-04
Validation rmse = 0.102310
Epoch 45
Loss = 5.3807e-02, PNorm = 35.3291, GNorm = 0.4951, lr_0 = 1.5944e-04
Loss = 5.3824e-02, PNorm = 35.3334, GNorm = 0.8874, lr_0 = 1.5553e-04
Loss = 3.7925e-02, PNorm = 35.3337, GNorm = 0.9349, lr_0 = 1.5514e-04
Validation rmse = 0.098542
Epoch 46
Loss = 5.2941e-02, PNorm = 35.3370, GNorm = 1.2130, lr_0 = 1.5134e-04
Validation rmse = 0.098538
Epoch 47
Loss = 5.1358e-02, PNorm = 35.3408, GNorm = 1.6833, lr_0 = 1.4763e-04
Loss = 5.3135e-02, PNorm = 35.3446, GNorm = 0.7183, lr_0 = 1.4401e-04
Validation rmse = 0.099071
Epoch 48
Loss = 5.5983e-02, PNorm = 35.3486, GNorm = 1.3240, lr_0 = 1.4014e-04
Validation rmse = 0.098337
Epoch 49
Loss = 4.9812e-02, PNorm = 35.3527, GNorm = 0.8505, lr_0 = 1.3636e-04
Loss = 5.1317e-02, PNorm = 35.3562, GNorm = 1.4001, lr_0 = 1.3302e-04
Validation rmse = 0.098522
Epoch 50
Loss = 4.6500e-02, PNorm = 35.3596, GNorm = 0.5476, lr_0 = 1.2976e-04
Loss = 5.7290e-02, PNorm = 35.3623, GNorm = 1.3653, lr_0 = 1.2658e-04
Validation rmse = 0.099230
Epoch 51
Loss = 5.2403e-02, PNorm = 35.3662, GNorm = 0.5584, lr_0 = 1.2317e-04
Validation rmse = 0.097715
Epoch 52
Loss = 5.6331e-02, PNorm = 35.3703, GNorm = 0.7420, lr_0 = 1.1986e-04
Loss = 5.2932e-02, PNorm = 35.3735, GNorm = 0.4695, lr_0 = 1.1692e-04
Validation rmse = 0.097539
Epoch 53
Loss = 5.2287e-02, PNorm = 35.3768, GNorm = 0.5459, lr_0 = 1.1377e-04
Loss = 5.2428e-02, PNorm = 35.3796, GNorm = 0.6551, lr_0 = 1.1098e-04
Validation rmse = 0.097435
Epoch 54
Loss = 5.4405e-02, PNorm = 35.3821, GNorm = 0.7035, lr_0 = 1.0826e-04
Validation rmse = 0.100210
Epoch 55
Loss = 5.9431e-02, PNorm = 35.3856, GNorm = 0.9620, lr_0 = 1.0535e-04
Loss = 4.9343e-02, PNorm = 35.3881, GNorm = 0.9898, lr_0 = 1.0277e-04
Validation rmse = 0.097018
Epoch 56
Loss = 5.2562e-02, PNorm = 35.3910, GNorm = 0.5101, lr_0 = 1.0000e-04
Loss = 4.9033e-02, PNorm = 35.3936, GNorm = 1.1022, lr_0 = 1.0000e-04
Validation rmse = 0.099143
Epoch 57
Loss = 5.0296e-02, PNorm = 35.3957, GNorm = 0.7059, lr_0 = 1.0000e-04
Validation rmse = 0.098601
Epoch 58
Loss = 5.3002e-02, PNorm = 35.3993, GNorm = 1.4708, lr_0 = 1.0000e-04
Loss = 5.2250e-02, PNorm = 35.4020, GNorm = 0.6782, lr_0 = 1.0000e-04
Validation rmse = 0.097577
Epoch 59
Loss = 4.6963e-02, PNorm = 35.4050, GNorm = 0.9490, lr_0 = 1.0000e-04
Validation rmse = 0.096645
Model 0 best validation rmse = 0.096645 on epoch 59
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.060993
Ensemble test rmse = 0.060993
1-fold cross validation
	Seed 0 ==> test rmse = 0.060993
Overall test rmse = 0.060993 +/- 0.000000
Elapsed time = 0:00:40
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,017 | train size = 808 | val size = 203 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.9009e-01, PNorm = 34.0157, GNorm = 1.4942, lr_0 = 4.0937e-04
Validation rmse = 0.256259
Epoch 1
Loss = 5.7133e-01, PNorm = 34.0536, GNorm = 2.0201, lr_0 = 7.1875e-04
Loss = 5.2516e-01, PNorm = 34.1142, GNorm = 3.3064, lr_0 = 1.0000e-03
Validation rmse = 0.222159
Epoch 2
Loss = 4.4119e-01, PNorm = 34.2054, GNorm = 1.7937, lr_0 = 9.7308e-04
Validation rmse = 0.250022
Epoch 3
Loss = 5.1363e-01, PNorm = 34.2718, GNorm = 4.2644, lr_0 = 9.4688e-04
Loss = 3.7141e-01, PNorm = 34.3263, GNorm = 6.6112, lr_0 = 9.2367e-04
Validation rmse = 0.166767
Epoch 4
Loss = 3.0346e-01, PNorm = 34.3821, GNorm = 2.2096, lr_0 = 8.9880e-04
Loss = 2.2725e-01, PNorm = 34.4307, GNorm = 0.7401, lr_0 = 8.7677e-04
Loss = 3.2479e-01, PNorm = 34.4346, GNorm = 7.2019, lr_0 = 8.7460e-04
Validation rmse = 0.152027
Epoch 5
Loss = 2.1607e-01, PNorm = 34.4763, GNorm = 1.9511, lr_0 = 8.5317e-04
Validation rmse = 0.128901
Epoch 6
Loss = 2.0113e-01, PNorm = 34.5186, GNorm = 2.2491, lr_0 = 8.3020e-04
Loss = 1.8141e-01, PNorm = 34.5549, GNorm = 2.3986, lr_0 = 8.0985e-04
Validation rmse = 0.126791
Epoch 7
Loss = 1.7841e-01, PNorm = 34.5936, GNorm = 1.5102, lr_0 = 7.9000e-04
Validation rmse = 0.125031
Epoch 8
Loss = 1.2527e-01, PNorm = 34.6282, GNorm = 2.8417, lr_0 = 7.6873e-04
Loss = 1.5408e-01, PNorm = 34.6606, GNorm = 2.4653, lr_0 = 7.4989e-04
Validation rmse = 0.111312
Epoch 9
Loss = 1.0300e-01, PNorm = 34.6913, GNorm = 1.6381, lr_0 = 7.2970e-04
Loss = 1.4221e-01, PNorm = 34.7166, GNorm = 1.1066, lr_0 = 7.1182e-04
Validation rmse = 0.114192
Epoch 10
Loss = 1.3642e-01, PNorm = 34.7441, GNorm = 3.7663, lr_0 = 6.9266e-04
Validation rmse = 0.107735
Epoch 11
Loss = 1.1573e-01, PNorm = 34.7731, GNorm = 1.7990, lr_0 = 6.7401e-04
Loss = 1.0148e-01, PNorm = 34.7966, GNorm = 2.8793, lr_0 = 6.5749e-04
Validation rmse = 0.117199
Epoch 12
Loss = 1.0228e-01, PNorm = 34.8224, GNorm = 3.2483, lr_0 = 6.3979e-04
Loss = 1.1240e-01, PNorm = 34.8414, GNorm = 3.3624, lr_0 = 6.2411e-04
Validation rmse = 0.107702
Epoch 13
Loss = 9.9970e-02, PNorm = 34.8619, GNorm = 1.2940, lr_0 = 6.0881e-04
Validation rmse = 0.104877
Epoch 14
Loss = 9.9015e-02, PNorm = 34.8791, GNorm = 1.4292, lr_0 = 5.9242e-04
Loss = 1.0216e-01, PNorm = 34.8969, GNorm = 1.2075, lr_0 = 5.7790e-04
Validation rmse = 0.104354
Epoch 15
Loss = 8.8216e-02, PNorm = 34.9127, GNorm = 2.6135, lr_0 = 5.6234e-04
Validation rmse = 0.102866
Epoch 16
Loss = 6.5068e-02, PNorm = 34.9259, GNorm = 0.5712, lr_0 = 5.4720e-04
Loss = 8.4522e-02, PNorm = 34.9370, GNorm = 3.9456, lr_0 = 5.3379e-04
Validation rmse = 0.100384
Epoch 17
Loss = 7.5851e-02, PNorm = 34.9521, GNorm = 0.9947, lr_0 = 5.1942e-04
Loss = 8.2499e-02, PNorm = 34.9667, GNorm = 1.7594, lr_0 = 5.0669e-04
Loss = 6.3010e-02, PNorm = 34.9680, GNorm = 1.9427, lr_0 = 5.0543e-04
Validation rmse = 0.099790
Epoch 18
Loss = 7.6463e-02, PNorm = 34.9819, GNorm = 0.9250, lr_0 = 4.9305e-04
Validation rmse = 0.100328
Epoch 19
Loss = 7.8374e-02, PNorm = 34.9924, GNorm = 1.7734, lr_0 = 4.8096e-04
Loss = 7.1702e-02, PNorm = 35.0022, GNorm = 1.0195, lr_0 = 4.6918e-04
Validation rmse = 0.117834
Epoch 20
Loss = 8.9253e-02, PNorm = 35.0157, GNorm = 1.2815, lr_0 = 4.5654e-04
Validation rmse = 0.099133
Epoch 21
Loss = 4.6017e-02, PNorm = 35.0288, GNorm = 0.5492, lr_0 = 4.4425e-04
Loss = 7.0773e-02, PNorm = 35.0399, GNorm = 0.5880, lr_0 = 4.3336e-04
Validation rmse = 0.100397
Epoch 22
Loss = 6.6493e-02, PNorm = 35.0511, GNorm = 2.4718, lr_0 = 4.2170e-04
Loss = 8.1781e-02, PNorm = 35.0594, GNorm = 2.7004, lr_0 = 4.1136e-04
Validation rmse = 0.105927
Epoch 23
Loss = 7.6160e-02, PNorm = 35.0663, GNorm = 2.3223, lr_0 = 4.0029e-04
Validation rmse = 0.100258
Epoch 24
Loss = 7.9308e-02, PNorm = 35.0767, GNorm = 1.1362, lr_0 = 3.8951e-04
Loss = 7.2354e-02, PNorm = 35.0874, GNorm = 3.6152, lr_0 = 3.7996e-04
Validation rmse = 0.123059
Epoch 25
Loss = 8.1773e-02, PNorm = 35.0967, GNorm = 1.7776, lr_0 = 3.7065e-04
Loss = 8.1079e-02, PNorm = 35.1047, GNorm = 0.6240, lr_0 = 3.6157e-04
Loss = 6.2938e-02, PNorm = 35.1056, GNorm = 4.5449, lr_0 = 3.6067e-04
Validation rmse = 0.122830
Epoch 26
Loss = 7.8166e-02, PNorm = 35.1161, GNorm = 1.8821, lr_0 = 3.5183e-04
Validation rmse = 0.104883
Epoch 27
Loss = 6.3464e-02, PNorm = 35.1284, GNorm = 1.2473, lr_0 = 3.4236e-04
Loss = 6.8404e-02, PNorm = 35.1365, GNorm = 2.5468, lr_0 = 3.3397e-04
Validation rmse = 0.096487
Epoch 28
Loss = 6.7091e-02, PNorm = 35.1434, GNorm = 1.5290, lr_0 = 3.2498e-04
Validation rmse = 0.098470
Epoch 29
Loss = 6.3395e-02, PNorm = 35.1499, GNorm = 0.5272, lr_0 = 3.1623e-04
Loss = 6.2028e-02, PNorm = 35.1568, GNorm = 0.8430, lr_0 = 3.0848e-04
Validation rmse = 0.098538
Epoch 30
Loss = 5.6931e-02, PNorm = 35.1645, GNorm = 1.8323, lr_0 = 3.0017e-04
Loss = 6.3496e-02, PNorm = 35.1713, GNorm = 2.1530, lr_0 = 2.9282e-04
Loss = 2.5551e-02, PNorm = 35.1721, GNorm = 1.6654, lr_0 = 2.9209e-04
Validation rmse = 0.096389
Epoch 31
Loss = 5.8160e-02, PNorm = 35.1778, GNorm = 0.5491, lr_0 = 2.8493e-04
Validation rmse = 0.096767
Epoch 32
Loss = 5.7027e-02, PNorm = 35.1845, GNorm = 1.2240, lr_0 = 2.7795e-04
Loss = 6.0148e-02, PNorm = 35.1908, GNorm = 1.1816, lr_0 = 2.7114e-04
Validation rmse = 0.097474
Epoch 33
Loss = 6.7144e-02, PNorm = 35.1977, GNorm = 1.2359, lr_0 = 2.6384e-04
Validation rmse = 0.093606
Epoch 34
Loss = 5.9635e-02, PNorm = 35.2038, GNorm = 1.2323, lr_0 = 2.5673e-04
Loss = 5.8080e-02, PNorm = 35.2084, GNorm = 0.8553, lr_0 = 2.5044e-04
Validation rmse = 0.096981
Epoch 35
Loss = 5.2686e-02, PNorm = 35.2152, GNorm = 1.9205, lr_0 = 2.4370e-04
Loss = 5.7962e-02, PNorm = 35.2213, GNorm = 1.9429, lr_0 = 2.3773e-04
Validation rmse = 0.101984
Epoch 36
Loss = 5.5770e-02, PNorm = 35.2276, GNorm = 0.9992, lr_0 = 2.3133e-04
Validation rmse = 0.093916
Epoch 37
Loss = 6.1156e-02, PNorm = 35.2334, GNorm = 1.6977, lr_0 = 2.2510e-04
Loss = 5.5061e-02, PNorm = 35.2388, GNorm = 2.7383, lr_0 = 2.1958e-04
Validation rmse = 0.094087
Epoch 38
Loss = 5.4284e-02, PNorm = 35.2435, GNorm = 1.5655, lr_0 = 2.1420e-04
Loss = 5.8181e-02, PNorm = 35.2480, GNorm = 1.1131, lr_0 = 2.0895e-04
Loss = 1.8448e-02, PNorm = 35.2485, GNorm = 0.7025, lr_0 = 2.0843e-04
Validation rmse = 0.094052
Epoch 39
Loss = 5.3322e-02, PNorm = 35.2546, GNorm = 0.4439, lr_0 = 2.0332e-04
Validation rmse = 0.098565
Epoch 40
Loss = 5.7123e-02, PNorm = 35.2591, GNorm = 0.4386, lr_0 = 1.9785e-04
Loss = 5.6354e-02, PNorm = 35.2626, GNorm = 1.5443, lr_0 = 1.9300e-04
Validation rmse = 0.095242
Epoch 41
Loss = 5.7717e-02, PNorm = 35.2679, GNorm = 1.4585, lr_0 = 1.8780e-04
Validation rmse = 0.092236
Epoch 42
Loss = 5.3811e-02, PNorm = 35.2735, GNorm = 0.4883, lr_0 = 1.8275e-04
Loss = 5.2282e-02, PNorm = 35.2777, GNorm = 0.5924, lr_0 = 1.7827e-04
Validation rmse = 0.092352
Epoch 43
Loss = 4.5642e-02, PNorm = 35.2823, GNorm = 0.9885, lr_0 = 1.7347e-04
Loss = 5.8662e-02, PNorm = 35.2873, GNorm = 1.3145, lr_0 = 1.6922e-04
Validation rmse = 0.094399
Epoch 44
Loss = 5.6270e-02, PNorm = 35.2911, GNorm = 0.5975, lr_0 = 1.6507e-04
Validation rmse = 0.094136
Epoch 45
Loss = 4.4532e-02, PNorm = 35.2955, GNorm = 0.5909, lr_0 = 1.6063e-04
Loss = 5.2726e-02, PNorm = 35.2999, GNorm = 0.5940, lr_0 = 1.5669e-04
Validation rmse = 0.091919
Epoch 46
Loss = 5.0470e-02, PNorm = 35.3043, GNorm = 1.4250, lr_0 = 1.5247e-04
Validation rmse = 0.094283
Epoch 47
Loss = 4.8500e-02, PNorm = 35.3078, GNorm = 0.7683, lr_0 = 1.4837e-04
Loss = 5.0876e-02, PNorm = 35.3114, GNorm = 0.5785, lr_0 = 1.4473e-04
Validation rmse = 0.094917
Epoch 48
Loss = 5.0893e-02, PNorm = 35.3147, GNorm = 0.9532, lr_0 = 1.4083e-04
Loss = 5.2464e-02, PNorm = 35.3186, GNorm = 0.5132, lr_0 = 1.3738e-04
Validation rmse = 0.092009
Epoch 49
Loss = 4.9269e-02, PNorm = 35.3218, GNorm = 0.9231, lr_0 = 1.3368e-04
Validation rmse = 0.092861
Epoch 50
Loss = 3.9290e-02, PNorm = 35.3246, GNorm = 1.4029, lr_0 = 1.3041e-04
Loss = 5.2213e-02, PNorm = 35.3274, GNorm = 0.8175, lr_0 = 1.2721e-04
Validation rmse = 0.091996
Epoch 51
Loss = 5.4118e-02, PNorm = 35.3308, GNorm = 1.2066, lr_0 = 1.2379e-04
Loss = 5.5338e-02, PNorm = 35.3340, GNorm = 1.2004, lr_0 = 1.2075e-04
Loss = 3.1866e-02, PNorm = 35.3344, GNorm = 1.3998, lr_0 = 1.2045e-04
Validation rmse = 0.092707
Epoch 52
Loss = 4.7876e-02, PNorm = 35.3373, GNorm = 0.8680, lr_0 = 1.1750e-04
Validation rmse = 0.092555
Epoch 53
Loss = 5.0412e-02, PNorm = 35.3405, GNorm = 1.2200, lr_0 = 1.1434e-04
Loss = 5.0341e-02, PNorm = 35.3437, GNorm = 0.9511, lr_0 = 1.1154e-04
Validation rmse = 0.096824
Epoch 54
Loss = 4.4842e-02, PNorm = 35.3468, GNorm = 0.4004, lr_0 = 1.0853e-04
Validation rmse = 0.091224
Epoch 55
Loss = 5.0581e-02, PNorm = 35.3498, GNorm = 0.9344, lr_0 = 1.0561e-04
Loss = 5.0033e-02, PNorm = 35.3518, GNorm = 1.4694, lr_0 = 1.0302e-04
Validation rmse = 0.091226
Epoch 56
Loss = 5.0327e-02, PNorm = 35.3544, GNorm = 1.3765, lr_0 = 1.0025e-04
Loss = 4.7835e-02, PNorm = 35.3568, GNorm = 0.8894, lr_0 = 1.0000e-04
Validation rmse = 0.091329
Epoch 57
Loss = 4.9422e-02, PNorm = 35.3589, GNorm = 0.5970, lr_0 = 1.0000e-04
Validation rmse = 0.093436
Epoch 58
Loss = 3.9219e-02, PNorm = 35.3613, GNorm = 1.0006, lr_0 = 1.0000e-04
Loss = 5.1749e-02, PNorm = 35.3640, GNorm = 1.9317, lr_0 = 1.0000e-04
Validation rmse = 0.092932
Epoch 59
Loss = 5.0902e-02, PNorm = 35.3661, GNorm = 0.8779, lr_0 = 1.0000e-04
Validation rmse = 0.096823
Model 0 best validation rmse = 0.091224 on epoch 54
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.116264
Ensemble test rmse = 0.116264
1-fold cross validation
	Seed 0 ==> test rmse = 0.116264
Overall test rmse = 0.116264 +/- 0.000000
Elapsed time = 0:00:39
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,007 | train size = 800 | val size = 201 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.8986e-01, PNorm = 34.0144, GNorm = 5.3873, lr_0 = 4.0937e-04
Validation rmse = 0.284528
Epoch 1
Loss = 6.3240e-01, PNorm = 34.0387, GNorm = 3.6083, lr_0 = 6.9063e-04
Loss = 6.1034e-01, PNorm = 34.0969, GNorm = 2.0940, lr_0 = 9.7187e-04
Validation rmse = 0.237042
Epoch 2
Loss = 4.9936e-01, PNorm = 34.1684, GNorm = 3.9262, lr_0 = 9.7792e-04
Validation rmse = 0.188736
Epoch 3
Loss = 3.1845e-01, PNorm = 34.2301, GNorm = 4.9951, lr_0 = 9.5395e-04
Loss = 3.0629e-01, PNorm = 34.2903, GNorm = 1.3819, lr_0 = 9.3057e-04
Validation rmse = 0.199188
Epoch 4
Loss = 3.0152e-01, PNorm = 34.3501, GNorm = 1.6139, lr_0 = 9.0777e-04
Loss = 2.4673e-01, PNorm = 34.4048, GNorm = 5.6925, lr_0 = 8.8552e-04
Validation rmse = 0.161733
Epoch 5
Loss = 2.2220e-01, PNorm = 34.4523, GNorm = 2.1733, lr_0 = 8.6382e-04
Validation rmse = 0.142474
Epoch 6
Loss = 1.5715e-01, PNorm = 34.5011, GNorm = 1.3236, lr_0 = 8.4265e-04
Loss = 1.8174e-01, PNorm = 34.5496, GNorm = 3.0265, lr_0 = 8.2200e-04
Validation rmse = 0.129881
Epoch 7
Loss = 1.4521e-01, PNorm = 34.5930, GNorm = 4.7204, lr_0 = 8.0185e-04
Validation rmse = 0.119728
Epoch 8
Loss = 1.2966e-01, PNorm = 34.6319, GNorm = 2.7223, lr_0 = 7.8220e-04
Loss = 1.1584e-01, PNorm = 34.6699, GNorm = 0.9672, lr_0 = 7.6303e-04
Validation rmse = 0.117567
Epoch 9
Loss = 9.4897e-02, PNorm = 34.6991, GNorm = 1.5743, lr_0 = 7.4433e-04
Loss = 1.0106e-01, PNorm = 34.7326, GNorm = 1.2306, lr_0 = 7.2609e-04
Validation rmse = 0.113525
Epoch 10
Loss = 1.0149e-01, PNorm = 34.7581, GNorm = 3.3100, lr_0 = 7.0830e-04
Validation rmse = 0.108736
Epoch 11
Loss = 1.1322e-01, PNorm = 34.7814, GNorm = 4.4514, lr_0 = 6.9094e-04
Loss = 1.4399e-01, PNorm = 34.8108, GNorm = 5.5967, lr_0 = 6.7401e-04
Validation rmse = 0.156910
Epoch 12
Loss = 1.0916e-01, PNorm = 34.8359, GNorm = 0.9002, lr_0 = 6.5749e-04
Validation rmse = 0.109888
Epoch 13
Loss = 9.3273e-02, PNorm = 34.8607, GNorm = 2.2709, lr_0 = 6.4138e-04
Loss = 7.6556e-02, PNorm = 34.8800, GNorm = 2.0916, lr_0 = 6.2566e-04
Validation rmse = 0.112321
Epoch 14
Loss = 7.1723e-02, PNorm = 34.8987, GNorm = 0.5448, lr_0 = 6.1032e-04
Loss = 8.3085e-02, PNorm = 34.9151, GNorm = 2.6697, lr_0 = 5.9537e-04
Validation rmse = 0.107893
Epoch 15
Loss = 7.8866e-02, PNorm = 34.9316, GNorm = 2.5017, lr_0 = 5.8078e-04
Validation rmse = 0.110198
Epoch 16
Loss = 7.7958e-02, PNorm = 34.9466, GNorm = 1.1473, lr_0 = 5.6654e-04
Loss = 7.8191e-02, PNorm = 34.9625, GNorm = 2.6015, lr_0 = 5.5266e-04
Validation rmse = 0.110516
Epoch 17
Loss = 7.4582e-02, PNorm = 34.9756, GNorm = 1.0124, lr_0 = 5.3911e-04
Validation rmse = 0.107757
Epoch 18
Loss = 6.2177e-02, PNorm = 34.9906, GNorm = 1.9459, lr_0 = 5.2590e-04
Loss = 7.7198e-02, PNorm = 35.0039, GNorm = 1.9324, lr_0 = 5.1301e-04
Validation rmse = 0.103025
Epoch 19
Loss = 7.4035e-02, PNorm = 35.0176, GNorm = 2.5568, lr_0 = 5.0044e-04
Loss = 6.9670e-02, PNorm = 35.0330, GNorm = 1.1002, lr_0 = 4.8818e-04
Validation rmse = 0.103906
Epoch 20
Loss = 8.0105e-02, PNorm = 35.0441, GNorm = 2.5683, lr_0 = 4.7621e-04
Validation rmse = 0.102099
Epoch 21
Loss = 5.5759e-02, PNorm = 35.0564, GNorm = 2.0169, lr_0 = 4.6454e-04
Loss = 6.6840e-02, PNorm = 35.0708, GNorm = 0.6408, lr_0 = 4.5316e-04
Validation rmse = 0.099522
Epoch 22
Loss = 5.7482e-02, PNorm = 35.0794, GNorm = 0.9281, lr_0 = 4.4205e-04
Validation rmse = 0.103744
Epoch 23
Loss = 6.7578e-02, PNorm = 35.0909, GNorm = 1.0766, lr_0 = 4.3122e-04
Loss = 5.6885e-02, PNorm = 35.1005, GNorm = 1.0350, lr_0 = 4.2065e-04
Validation rmse = 0.099176
Epoch 24
Loss = 6.9323e-02, PNorm = 35.1106, GNorm = 1.2982, lr_0 = 4.1034e-04
Loss = 6.7741e-02, PNorm = 35.1225, GNorm = 3.1693, lr_0 = 4.0029e-04
Validation rmse = 0.102092
Epoch 25
Loss = 6.7094e-02, PNorm = 35.1338, GNorm = 2.2731, lr_0 = 3.9048e-04
Validation rmse = 0.104895
Epoch 26
Loss = 5.7143e-02, PNorm = 35.1447, GNorm = 0.5634, lr_0 = 3.8091e-04
Loss = 5.8927e-02, PNorm = 35.1542, GNorm = 2.3093, lr_0 = 3.7157e-04
Validation rmse = 0.102220
Epoch 27
Loss = 5.9567e-02, PNorm = 35.1627, GNorm = 0.7298, lr_0 = 3.6247e-04
Validation rmse = 0.105853
Epoch 28
Loss = 6.5096e-02, PNorm = 35.1716, GNorm = 1.4970, lr_0 = 3.5358e-04
Loss = 5.5628e-02, PNorm = 35.1791, GNorm = 0.6467, lr_0 = 3.4492e-04
Validation rmse = 0.097540
Epoch 29
Loss = 5.5939e-02, PNorm = 35.1884, GNorm = 0.5116, lr_0 = 3.3646e-04
Loss = 5.2060e-02, PNorm = 35.1964, GNorm = 0.9283, lr_0 = 3.2822e-04
Validation rmse = 0.100387
Epoch 30
Loss = 5.5016e-02, PNorm = 35.2027, GNorm = 1.0826, lr_0 = 3.2018e-04
Validation rmse = 0.102768
Epoch 31
Loss = 6.1864e-02, PNorm = 35.2118, GNorm = 3.5829, lr_0 = 3.1233e-04
Loss = 5.6309e-02, PNorm = 35.2180, GNorm = 0.6046, lr_0 = 3.0467e-04
Validation rmse = 0.101955
Epoch 32
Loss = 5.3610e-02, PNorm = 35.2272, GNorm = 1.8516, lr_0 = 2.9721e-04
Validation rmse = 0.104591
Epoch 33
Loss = 5.3428e-02, PNorm = 35.2348, GNorm = 1.8888, lr_0 = 2.8992e-04
Loss = 5.0853e-02, PNorm = 35.2417, GNorm = 2.0930, lr_0 = 2.8282e-04
Validation rmse = 0.098934
Epoch 34
Loss = 5.7813e-02, PNorm = 35.2499, GNorm = 1.2526, lr_0 = 2.7589e-04
Loss = 5.2692e-02, PNorm = 35.2573, GNorm = 2.1293, lr_0 = 2.6913e-04
Validation rmse = 0.098914
Epoch 35
Loss = 5.1633e-02, PNorm = 35.2631, GNorm = 0.4629, lr_0 = 2.6253e-04
Validation rmse = 0.099169
Epoch 36
Loss = 5.3213e-02, PNorm = 35.2703, GNorm = 1.5727, lr_0 = 2.5610e-04
Loss = 5.0726e-02, PNorm = 35.2761, GNorm = 0.9229, lr_0 = 2.4982e-04
Validation rmse = 0.096167
Epoch 37
Loss = 4.5163e-02, PNorm = 35.2829, GNorm = 1.4589, lr_0 = 2.4370e-04
Validation rmse = 0.096544
Epoch 38
Loss = 5.1499e-02, PNorm = 35.2885, GNorm = 0.7513, lr_0 = 2.3773e-04
Loss = 4.9921e-02, PNorm = 35.2946, GNorm = 0.5327, lr_0 = 2.3190e-04
Validation rmse = 0.097589
Epoch 39
Loss = 4.6696e-02, PNorm = 35.2993, GNorm = 0.9712, lr_0 = 2.2622e-04
Loss = 5.0480e-02, PNorm = 35.3046, GNorm = 1.3652, lr_0 = 2.2067e-04
Validation rmse = 0.096516
Epoch 40
Loss = 5.2231e-02, PNorm = 35.3104, GNorm = 0.5281, lr_0 = 2.1527e-04
Validation rmse = 0.096326
Epoch 41
Loss = 3.6941e-02, PNorm = 35.3160, GNorm = 1.2527, lr_0 = 2.0999e-04
Loss = 5.1000e-02, PNorm = 35.3210, GNorm = 0.8011, lr_0 = 2.0484e-04
Validation rmse = 0.097996
Epoch 42
Loss = 4.3399e-02, PNorm = 35.3247, GNorm = 1.4600, lr_0 = 1.9982e-04
Validation rmse = 0.097480
Epoch 43
Loss = 4.5965e-02, PNorm = 35.3294, GNorm = 0.7090, lr_0 = 1.9493e-04
Loss = 4.8060e-02, PNorm = 35.3345, GNorm = 0.9836, lr_0 = 1.9015e-04
Validation rmse = 0.097899
Epoch 44
Loss = 4.3002e-02, PNorm = 35.3400, GNorm = 1.4158, lr_0 = 1.8549e-04
Loss = 5.0863e-02, PNorm = 35.3443, GNorm = 0.4879, lr_0 = 1.8094e-04
Validation rmse = 0.095579
Epoch 45
Loss = 4.5937e-02, PNorm = 35.3482, GNorm = 0.4397, lr_0 = 1.7651e-04
Validation rmse = 0.097874
Epoch 46
Loss = 4.3462e-02, PNorm = 35.3530, GNorm = 1.6344, lr_0 = 1.7218e-04
Loss = 4.8903e-02, PNorm = 35.3564, GNorm = 0.5447, lr_0 = 1.6796e-04
Validation rmse = 0.098224
Epoch 47
Loss = 5.0553e-02, PNorm = 35.3609, GNorm = 1.1824, lr_0 = 1.6385e-04
Validation rmse = 0.096187
Epoch 48
Loss = 3.6596e-02, PNorm = 35.3651, GNorm = 1.0927, lr_0 = 1.5983e-04
Loss = 4.9103e-02, PNorm = 35.3691, GNorm = 1.0874, lr_0 = 1.5592e-04
Validation rmse = 0.096231
Epoch 49
Loss = 4.4385e-02, PNorm = 35.3732, GNorm = 0.4307, lr_0 = 1.5209e-04
Loss = 4.4663e-02, PNorm = 35.3764, GNorm = 0.4731, lr_0 = 1.4837e-04
Validation rmse = 0.098940
Epoch 50
Loss = 4.2304e-02, PNorm = 35.3800, GNorm = 1.5224, lr_0 = 1.4473e-04
Validation rmse = 0.096324
Epoch 51
Loss = 4.7646e-02, PNorm = 35.3835, GNorm = 1.5841, lr_0 = 1.4118e-04
Loss = 4.4976e-02, PNorm = 35.3868, GNorm = 0.7035, lr_0 = 1.3772e-04
Validation rmse = 0.096442
Epoch 52
Loss = 4.0458e-02, PNorm = 35.3894, GNorm = 0.8183, lr_0 = 1.3435e-04
Validation rmse = 0.096688
Epoch 53
Loss = 3.7795e-02, PNorm = 35.3930, GNorm = 0.5879, lr_0 = 1.3106e-04
Loss = 4.3903e-02, PNorm = 35.3962, GNorm = 0.8091, lr_0 = 1.2784e-04
Validation rmse = 0.098257
Epoch 54
Loss = 4.9407e-02, PNorm = 35.3997, GNorm = 1.2466, lr_0 = 1.2471e-04
Loss = 4.5983e-02, PNorm = 35.4023, GNorm = 1.8260, lr_0 = 1.2165e-04
Validation rmse = 0.097989
Epoch 55
Loss = 4.3826e-02, PNorm = 35.4052, GNorm = 1.4896, lr_0 = 1.1867e-04
Validation rmse = 0.097667
Epoch 56
Loss = 4.2821e-02, PNorm = 35.4081, GNorm = 0.4432, lr_0 = 1.1577e-04
Loss = 4.0373e-02, PNorm = 35.4101, GNorm = 0.4482, lr_0 = 1.1293e-04
Validation rmse = 0.095616
Epoch 57
Loss = 4.1084e-02, PNorm = 35.4132, GNorm = 0.3897, lr_0 = 1.1016e-04
Validation rmse = 0.095817
Epoch 58
Loss = 3.9097e-02, PNorm = 35.4156, GNorm = 0.5523, lr_0 = 1.0746e-04
Loss = 4.3507e-02, PNorm = 35.4179, GNorm = 0.4988, lr_0 = 1.0483e-04
Validation rmse = 0.095218
Epoch 59
Loss = 4.0458e-02, PNorm = 35.4206, GNorm = 0.3933, lr_0 = 1.0226e-04
Loss = 4.4662e-02, PNorm = 35.4230, GNorm = 1.9287, lr_0 = 1.0000e-04
Validation rmse = 0.096287
Model 0 best validation rmse = 0.095218 on epoch 58
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.111121
Ensemble test rmse = 0.111121
1-fold cross validation
	Seed 0 ==> test rmse = 0.111121
Overall test rmse = 0.111121 +/- 0.000000
Elapsed time = 0:00:39
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 997 | train size = 792 | val size = 200 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.6958e-01, PNorm = 34.0164, GNorm = 1.3788, lr_0 = 4.3000e-04
Validation rmse = 0.296106
Epoch 1
Loss = 6.9364e-01, PNorm = 34.0503, GNorm = 1.5655, lr_0 = 7.6000e-04
Loss = 5.1065e-01, PNorm = 34.1133, GNorm = 8.7794, lr_0 = 9.9472e-04
Validation rmse = 0.232286
Epoch 2
Loss = 3.9306e-01, PNorm = 34.1860, GNorm = 1.7712, lr_0 = 9.6874e-04
Validation rmse = 0.216905
Epoch 3
Loss = 2.9142e-01, PNorm = 34.2557, GNorm = 6.7224, lr_0 = 9.4344e-04
Loss = 3.0665e-01, PNorm = 34.3135, GNorm = 3.9340, lr_0 = 9.1879e-04
Validation rmse = 0.249639
Epoch 4
Loss = 3.9360e-01, PNorm = 34.3613, GNorm = 3.0703, lr_0 = 8.9480e-04
Validation rmse = 0.215265
Epoch 5
Loss = 3.4156e-01, PNorm = 34.4106, GNorm = 5.9188, lr_0 = 8.7142e-04
Loss = 2.5401e-01, PNorm = 34.4543, GNorm = 3.0973, lr_0 = 8.4866e-04
Validation rmse = 0.171200
Epoch 6
Loss = 2.0914e-01, PNorm = 34.5016, GNorm = 1.4793, lr_0 = 8.2650e-04
Loss = 1.8486e-01, PNorm = 34.5440, GNorm = 0.5412, lr_0 = 8.0491e-04
Loss = 1.4916e-01, PNorm = 34.5478, GNorm = 3.1442, lr_0 = 8.0278e-04
Validation rmse = 0.156980
Epoch 7
Loss = 1.5420e-01, PNorm = 34.5844, GNorm = 4.7475, lr_0 = 7.8181e-04
Validation rmse = 0.175018
Epoch 8
Loss = 1.5106e-01, PNorm = 34.6213, GNorm = 5.4966, lr_0 = 7.6139e-04
Loss = 1.5715e-01, PNorm = 34.6547, GNorm = 3.1437, lr_0 = 7.4151e-04
Validation rmse = 0.122853
Epoch 9
Loss = 1.1616e-01, PNorm = 34.6898, GNorm = 2.5748, lr_0 = 7.2214e-04
Validation rmse = 0.113335
Epoch 10
Loss = 1.2282e-01, PNorm = 34.7174, GNorm = 2.8215, lr_0 = 7.0328e-04
Loss = 1.1765e-01, PNorm = 34.7489, GNorm = 4.2680, lr_0 = 6.8491e-04
Validation rmse = 0.112607
Epoch 11
Loss = 9.0547e-02, PNorm = 34.7728, GNorm = 1.1552, lr_0 = 6.6702e-04
Loss = 9.9758e-02, PNorm = 34.7984, GNorm = 0.7802, lr_0 = 6.4960e-04
Validation rmse = 0.119021
Epoch 12
Loss = 1.0800e-01, PNorm = 34.8173, GNorm = 4.0017, lr_0 = 6.3263e-04
Validation rmse = 0.104582
Epoch 13
Loss = 8.4988e-02, PNorm = 34.8352, GNorm = 0.6311, lr_0 = 6.1448e-04
Loss = 9.4531e-02, PNorm = 34.8551, GNorm = 1.3676, lr_0 = 5.9843e-04
Validation rmse = 0.106337
Epoch 14
Loss = 8.0226e-02, PNorm = 34.8719, GNorm = 2.2776, lr_0 = 5.8280e-04
Validation rmse = 0.101354
Epoch 15
Loss = 1.0536e-01, PNorm = 34.8896, GNorm = 4.9032, lr_0 = 5.6757e-04
Loss = 7.8985e-02, PNorm = 34.9065, GNorm = 3.9180, lr_0 = 5.5275e-04
Validation rmse = 0.116370
Epoch 16
Loss = 8.2398e-02, PNorm = 34.9215, GNorm = 1.0931, lr_0 = 5.3831e-04
Validation rmse = 0.131312
Epoch 17
Loss = 1.4361e-01, PNorm = 34.9369, GNorm = 5.5347, lr_0 = 5.2425e-04
Loss = 8.3656e-02, PNorm = 34.9521, GNorm = 1.8629, lr_0 = 5.1056e-04
Validation rmse = 0.100156
Epoch 18
Loss = 8.2765e-02, PNorm = 34.9667, GNorm = 2.9918, lr_0 = 4.9722e-04
Loss = 6.8189e-02, PNorm = 34.9805, GNorm = 2.3627, lr_0 = 4.8424e-04
Loss = 4.9798e-02, PNorm = 34.9818, GNorm = 1.5222, lr_0 = 4.8296e-04
Validation rmse = 0.092918
Epoch 19
Loss = 7.4275e-02, PNorm = 34.9924, GNorm = 3.8626, lr_0 = 4.7034e-04
Validation rmse = 0.093893
Epoch 20
Loss = 6.2647e-02, PNorm = 35.0034, GNorm = 2.0327, lr_0 = 4.5806e-04
Loss = 6.6907e-02, PNorm = 35.0145, GNorm = 0.7480, lr_0 = 4.4609e-04
Validation rmse = 0.098650
Epoch 21
Loss = 6.8381e-02, PNorm = 35.0262, GNorm = 2.9337, lr_0 = 4.3444e-04
Validation rmse = 0.102725
Epoch 22
Loss = 5.7688e-02, PNorm = 35.0372, GNorm = 2.2109, lr_0 = 4.2309e-04
Loss = 7.3479e-02, PNorm = 35.0502, GNorm = 1.1939, lr_0 = 4.1204e-04
Validation rmse = 0.101911
Epoch 23
Loss = 7.5584e-02, PNorm = 35.0611, GNorm = 2.6127, lr_0 = 4.0128e-04
Loss = 5.5670e-02, PNorm = 35.0694, GNorm = 0.5017, lr_0 = 3.9080e-04
Validation rmse = 0.092691
Epoch 24
Loss = 6.0866e-02, PNorm = 35.0798, GNorm = 1.4616, lr_0 = 3.8059e-04
Validation rmse = 0.090461
Epoch 25
Loss = 5.7715e-02, PNorm = 35.0887, GNorm = 2.8056, lr_0 = 3.7065e-04
Loss = 6.5377e-02, PNorm = 35.0988, GNorm = 0.8171, lr_0 = 3.6097e-04
Validation rmse = 0.100676
Epoch 26
Loss = 6.4228e-02, PNorm = 35.1083, GNorm = 0.5715, lr_0 = 3.5061e-04
Validation rmse = 0.101678
Epoch 27
Loss = 7.6202e-02, PNorm = 35.1182, GNorm = 0.8531, lr_0 = 3.4145e-04
Loss = 5.7724e-02, PNorm = 35.1265, GNorm = 1.5000, lr_0 = 3.3254e-04
Validation rmse = 0.090216
Epoch 28
Loss = 5.5145e-02, PNorm = 35.1346, GNorm = 0.8549, lr_0 = 3.2385e-04
Validation rmse = 0.093125
Epoch 29
Loss = 6.5927e-02, PNorm = 35.1415, GNorm = 0.9422, lr_0 = 3.1539e-04
Loss = 5.6689e-02, PNorm = 35.1514, GNorm = 1.5074, lr_0 = 3.0715e-04
Validation rmse = 0.088517
Epoch 30
Loss = 5.7110e-02, PNorm = 35.1562, GNorm = 1.5726, lr_0 = 2.9913e-04
Loss = 6.5454e-02, PNorm = 35.1645, GNorm = 1.7584, lr_0 = 2.9132e-04
Validation rmse = 0.090524
Epoch 31
Loss = 5.1771e-02, PNorm = 35.1719, GNorm = 0.4318, lr_0 = 2.8371e-04
Validation rmse = 0.089535
Epoch 32
Loss = 4.9533e-02, PNorm = 35.1799, GNorm = 2.5724, lr_0 = 2.7557e-04
Loss = 5.8836e-02, PNorm = 35.1874, GNorm = 1.8369, lr_0 = 2.6837e-04
Validation rmse = 0.091587
Epoch 33
Loss = 5.3572e-02, PNorm = 35.1945, GNorm = 1.3318, lr_0 = 2.6136e-04
Validation rmse = 0.089061
Epoch 34
Loss = 5.3793e-02, PNorm = 35.2017, GNorm = 1.7429, lr_0 = 2.5453e-04
Loss = 5.3922e-02, PNorm = 35.2091, GNorm = 1.1550, lr_0 = 2.4789e-04
Validation rmse = 0.087068
Epoch 35
Loss = 5.3718e-02, PNorm = 35.2148, GNorm = 0.4299, lr_0 = 2.4141e-04
Loss = 4.7664e-02, PNorm = 35.2211, GNorm = 0.6713, lr_0 = 2.3511e-04
Validation rmse = 0.088471
Epoch 36
Loss = 5.1391e-02, PNorm = 35.2255, GNorm = 0.7062, lr_0 = 2.2897e-04
Validation rmse = 0.087314
Epoch 37
Loss = 4.9116e-02, PNorm = 35.2305, GNorm = 1.2191, lr_0 = 2.2299e-04
Loss = 5.3463e-02, PNorm = 35.2362, GNorm = 1.7182, lr_0 = 2.1716e-04
Validation rmse = 0.089267
Epoch 38
Loss = 4.9412e-02, PNorm = 35.2437, GNorm = 2.5477, lr_0 = 2.1093e-04
Validation rmse = 0.089468
Epoch 39
Loss = 4.8369e-02, PNorm = 35.2489, GNorm = 0.8608, lr_0 = 2.0542e-04
Loss = 5.1103e-02, PNorm = 35.2546, GNorm = 1.1501, lr_0 = 2.0006e-04
Validation rmse = 0.086857
Epoch 40
Loss = 5.0082e-02, PNorm = 35.2602, GNorm = 0.7118, lr_0 = 1.9483e-04
Validation rmse = 0.087523
Epoch 41
Loss = 5.3328e-02, PNorm = 35.2659, GNorm = 1.7814, lr_0 = 1.8974e-04
Loss = 4.8213e-02, PNorm = 35.2706, GNorm = 1.2842, lr_0 = 1.8478e-04
Validation rmse = 0.087789
Epoch 42
Loss = 5.2138e-02, PNorm = 35.2749, GNorm = 0.6940, lr_0 = 1.7996e-04
Loss = 4.6134e-02, PNorm = 35.2801, GNorm = 0.5944, lr_0 = 1.7526e-04
Validation rmse = 0.086839
Epoch 43
Loss = 5.1220e-02, PNorm = 35.2845, GNorm = 0.7254, lr_0 = 1.7068e-04
Validation rmse = 0.085579
Epoch 44
Loss = 4.7790e-02, PNorm = 35.2888, GNorm = 1.7904, lr_0 = 1.6578e-04
Loss = 4.8368e-02, PNorm = 35.2930, GNorm = 0.6689, lr_0 = 1.6145e-04
Validation rmse = 0.089269
Epoch 45
Loss = 4.7326e-02, PNorm = 35.2976, GNorm = 0.4766, lr_0 = 1.5724e-04
Validation rmse = 0.086682
Epoch 46
Loss = 4.4284e-02, PNorm = 35.3014, GNorm = 1.6735, lr_0 = 1.5313e-04
Loss = 4.6334e-02, PNorm = 35.3057, GNorm = 0.8578, lr_0 = 1.4913e-04
Validation rmse = 0.090599
Epoch 47
Loss = 4.8205e-02, PNorm = 35.3097, GNorm = 1.0411, lr_0 = 1.4523e-04
Loss = 4.9294e-02, PNorm = 35.3136, GNorm = 1.2026, lr_0 = 1.4144e-04
Validation rmse = 0.086867
Epoch 48
Loss = 4.6223e-02, PNorm = 35.3169, GNorm = 0.4548, lr_0 = 1.3775e-04
Validation rmse = 0.085993
Epoch 49
Loss = 4.1769e-02, PNorm = 35.3207, GNorm = 0.8348, lr_0 = 1.3415e-04
Loss = 4.5163e-02, PNorm = 35.3245, GNorm = 1.8141, lr_0 = 1.3064e-04
Validation rmse = 0.085152
Epoch 50
Loss = 4.6084e-02, PNorm = 35.3279, GNorm = 0.5367, lr_0 = 1.2723e-04
Validation rmse = 0.088680
Epoch 51
Loss = 4.3644e-02, PNorm = 35.3314, GNorm = 0.5134, lr_0 = 1.2358e-04
Loss = 4.3417e-02, PNorm = 35.3352, GNorm = 0.8091, lr_0 = 1.2035e-04
Validation rmse = 0.085819
Epoch 52
Loss = 4.2289e-02, PNorm = 35.3383, GNorm = 0.6413, lr_0 = 1.1721e-04
Validation rmse = 0.086318
Epoch 53
Loss = 4.3679e-02, PNorm = 35.3416, GNorm = 0.4900, lr_0 = 1.1415e-04
Loss = 4.3350e-02, PNorm = 35.3444, GNorm = 0.9681, lr_0 = 1.1117e-04
Validation rmse = 0.085551
Epoch 54
Loss = 4.3261e-02, PNorm = 35.3476, GNorm = 0.4434, lr_0 = 1.0826e-04
Loss = 4.4994e-02, PNorm = 35.3510, GNorm = 1.2001, lr_0 = 1.0544e-04
Validation rmse = 0.084720
Epoch 55
Loss = 4.2597e-02, PNorm = 35.3532, GNorm = 1.0439, lr_0 = 1.0268e-04
Validation rmse = 0.088395
Epoch 56
Loss = 4.2509e-02, PNorm = 35.3559, GNorm = 1.4107, lr_0 = 1.0000e-04
Loss = 4.5476e-02, PNorm = 35.3581, GNorm = 0.8466, lr_0 = 1.0000e-04
Validation rmse = 0.088856
Epoch 57
Loss = 4.7332e-02, PNorm = 35.3618, GNorm = 0.9691, lr_0 = 1.0000e-04
Validation rmse = 0.084624
Epoch 58
Loss = 3.5083e-02, PNorm = 35.3642, GNorm = 0.5513, lr_0 = 1.0000e-04
Loss = 4.3468e-02, PNorm = 35.3671, GNorm = 1.0422, lr_0 = 1.0000e-04
Validation rmse = 0.086186
Epoch 59
Loss = 4.0879e-02, PNorm = 35.3699, GNorm = 1.9412, lr_0 = 1.0000e-04
Loss = 4.4259e-02, PNorm = 35.3725, GNorm = 1.5176, lr_0 = 1.0000e-04
Validation rmse = 0.087118
Model 0 best validation rmse = 0.084624 on epoch 57
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.041529
Ensemble test rmse = 0.041529
1-fold cross validation
	Seed 0 ==> test rmse = 0.041529
Overall test rmse = 0.041529 +/- 0.000000
Elapsed time = 0:00:38
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 987 | train size = 784 | val size = 198 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.4011e-01, PNorm = 34.0151, GNorm = 4.4070, lr_0 = 4.3000e-04
Validation rmse = 0.302575
Epoch 1
Loss = 6.3607e-01, PNorm = 34.0423, GNorm = 1.8222, lr_0 = 7.6000e-04
Loss = 7.0563e-01, PNorm = 34.0935, GNorm = 6.9143, lr_0 = 9.9472e-04
Validation rmse = 0.250057
Epoch 2
Loss = 4.3132e-01, PNorm = 34.1704, GNorm = 1.6368, lr_0 = 9.6874e-04
Validation rmse = 0.198153
Epoch 3
Loss = 3.0883e-01, PNorm = 34.2458, GNorm = 3.4783, lr_0 = 9.4344e-04
Loss = 3.3997e-01, PNorm = 34.3151, GNorm = 4.1690, lr_0 = 9.1879e-04
Validation rmse = 0.173990
Epoch 4
Loss = 2.7090e-01, PNorm = 34.3771, GNorm = 6.8428, lr_0 = 8.9243e-04
Validation rmse = 0.153278
Epoch 5
Loss = 1.6673e-01, PNorm = 34.4309, GNorm = 3.2120, lr_0 = 8.6912e-04
Loss = 2.0693e-01, PNorm = 34.4802, GNorm = 4.1215, lr_0 = 8.4642e-04
Validation rmse = 0.140487
Epoch 6
Loss = 1.5280e-01, PNorm = 34.5217, GNorm = 4.7958, lr_0 = 8.2431e-04
Validation rmse = 0.135376
Epoch 7
Loss = 1.4496e-01, PNorm = 34.5656, GNorm = 2.4646, lr_0 = 8.0066e-04
Loss = 1.1363e-01, PNorm = 34.6038, GNorm = 1.8039, lr_0 = 7.7975e-04
Validation rmse = 0.125854
Epoch 8
Loss = 1.2796e-01, PNorm = 34.6363, GNorm = 1.6132, lr_0 = 7.5938e-04
Loss = 1.3355e-01, PNorm = 34.6662, GNorm = 4.2989, lr_0 = 7.3955e-04
Validation rmse = 0.157302
Epoch 9
Loss = 1.1991e-01, PNorm = 34.6890, GNorm = 4.2202, lr_0 = 7.2023e-04
Validation rmse = 0.111730
Epoch 10
Loss = 8.7336e-02, PNorm = 34.7232, GNorm = 3.2581, lr_0 = 6.9956e-04
Loss = 9.8559e-02, PNorm = 34.7502, GNorm = 3.2986, lr_0 = 6.8129e-04
Validation rmse = 0.117073
Epoch 11
Loss = 9.6135e-02, PNorm = 34.7700, GNorm = 2.7023, lr_0 = 6.6350e-04
Validation rmse = 0.131290
Epoch 12
Loss = 1.1795e-01, PNorm = 34.7893, GNorm = 1.6798, lr_0 = 6.4617e-04
Loss = 1.0639e-01, PNorm = 34.8063, GNorm = 0.8369, lr_0 = 6.2929e-04
Validation rmse = 0.132942
Epoch 13
Loss = 9.8364e-02, PNorm = 34.8310, GNorm = 4.9724, lr_0 = 6.1123e-04
Validation rmse = 0.116704
Epoch 14
Loss = 1.1659e-01, PNorm = 34.8478, GNorm = 5.6982, lr_0 = 5.9527e-04
Loss = 9.7164e-02, PNorm = 34.8662, GNorm = 3.9269, lr_0 = 5.7972e-04
Validation rmse = 0.104410
Epoch 15
Loss = 8.4730e-02, PNorm = 34.8872, GNorm = 2.1379, lr_0 = 5.6458e-04
Loss = 8.4636e-02, PNorm = 34.9033, GNorm = 0.9136, lr_0 = 5.4983e-04
Loss = 8.7709e-02, PNorm = 34.9045, GNorm = 3.3529, lr_0 = 5.4838e-04
Validation rmse = 0.103462
Epoch 16
Loss = 8.7343e-02, PNorm = 34.9171, GNorm = 3.3624, lr_0 = 5.3406e-04
Validation rmse = 0.098371
Epoch 17
Loss = 7.5394e-02, PNorm = 34.9333, GNorm = 0.7909, lr_0 = 5.2011e-04
Loss = 8.0738e-02, PNorm = 34.9480, GNorm = 1.8087, lr_0 = 5.0652e-04
Validation rmse = 0.097910
Epoch 18
Loss = 6.7817e-02, PNorm = 34.9640, GNorm = 3.0740, lr_0 = 4.9329e-04
Validation rmse = 0.097491
Epoch 19
Loss = 6.1029e-02, PNorm = 34.9787, GNorm = 0.6711, lr_0 = 4.7914e-04
Loss = 6.7266e-02, PNorm = 34.9911, GNorm = 1.2193, lr_0 = 4.6662e-04
Validation rmse = 0.099904
Epoch 20
Loss = 6.2190e-02, PNorm = 35.0020, GNorm = 0.6839, lr_0 = 4.5443e-04
Validation rmse = 0.098550
Epoch 21
Loss = 6.2379e-02, PNorm = 35.0109, GNorm = 2.3613, lr_0 = 4.4256e-04
Loss = 6.3246e-02, PNorm = 35.0207, GNorm = 3.8222, lr_0 = 4.3101e-04
Validation rmse = 0.094878
Epoch 22
Loss = 6.8422e-02, PNorm = 35.0330, GNorm = 0.9162, lr_0 = 4.1864e-04
Loss = 6.1751e-02, PNorm = 35.0435, GNorm = 0.8337, lr_0 = 4.0770e-04
Validation rmse = 0.092145
Epoch 23
Loss = 5.6662e-02, PNorm = 35.0552, GNorm = 1.9343, lr_0 = 3.9705e-04
Validation rmse = 0.091199
Epoch 24
Loss = 6.3906e-02, PNorm = 35.0642, GNorm = 2.1257, lr_0 = 3.8668e-04
Loss = 5.5546e-02, PNorm = 35.0737, GNorm = 1.9701, lr_0 = 3.7658e-04
Validation rmse = 0.098265
Epoch 25
Loss = 6.3254e-02, PNorm = 35.0840, GNorm = 1.4351, lr_0 = 3.6675e-04
Validation rmse = 0.092007
Epoch 26
Loss = 6.1800e-02, PNorm = 35.0947, GNorm = 0.5306, lr_0 = 3.5622e-04
Loss = 5.4153e-02, PNorm = 35.1037, GNorm = 0.6902, lr_0 = 3.4692e-04
Validation rmse = 0.091223
Epoch 27
Loss = 4.8501e-02, PNorm = 35.1113, GNorm = 1.2977, lr_0 = 3.3786e-04
Validation rmse = 0.094098
Epoch 28
Loss = 6.4295e-02, PNorm = 35.1199, GNorm = 2.3477, lr_0 = 3.2903e-04
Loss = 5.7245e-02, PNorm = 35.1296, GNorm = 0.8236, lr_0 = 3.2044e-04
Validation rmse = 0.096086
Epoch 29
Loss = 5.6696e-02, PNorm = 35.1376, GNorm = 2.1573, lr_0 = 3.1125e-04
Loss = 5.6632e-02, PNorm = 35.1452, GNorm = 0.7594, lr_0 = 3.0312e-04
Validation rmse = 0.089381
Epoch 30
Loss = 5.0596e-02, PNorm = 35.1521, GNorm = 1.7527, lr_0 = 2.9520e-04
Validation rmse = 0.087964
Epoch 31
Loss = 6.2497e-02, PNorm = 35.1592, GNorm = 2.1310, lr_0 = 2.8749e-04
Loss = 5.2706e-02, PNorm = 35.1674, GNorm = 0.8709, lr_0 = 2.7998e-04
Validation rmse = 0.087833
Epoch 32
Loss = 5.0177e-02, PNorm = 35.1747, GNorm = 1.5063, lr_0 = 2.7195e-04
Validation rmse = 0.089247
Epoch 33
Loss = 4.6158e-02, PNorm = 35.1800, GNorm = 1.4318, lr_0 = 2.6484e-04
Loss = 4.6178e-02, PNorm = 35.1857, GNorm = 0.6326, lr_0 = 2.5793e-04
Validation rmse = 0.089508
Epoch 34
Loss = 4.4350e-02, PNorm = 35.1925, GNorm = 0.7885, lr_0 = 2.5119e-04
Validation rmse = 0.094722
Epoch 35
Loss = 5.8574e-02, PNorm = 35.1998, GNorm = 3.0779, lr_0 = 2.4398e-04
Loss = 5.1264e-02, PNorm = 35.2057, GNorm = 3.4303, lr_0 = 2.3761e-04
Validation rmse = 0.089115
Epoch 36
Loss = 6.3246e-02, PNorm = 35.2127, GNorm = 0.4753, lr_0 = 2.3140e-04
Loss = 5.1786e-02, PNorm = 35.2179, GNorm = 0.7418, lr_0 = 2.2536e-04
Validation rmse = 0.094169
Epoch 37
Loss = 5.2486e-02, PNorm = 35.2226, GNorm = 0.9123, lr_0 = 2.1947e-04
Validation rmse = 0.089956
Epoch 38
Loss = 4.6716e-02, PNorm = 35.2288, GNorm = 1.2558, lr_0 = 2.1317e-04
Loss = 5.0072e-02, PNorm = 35.2344, GNorm = 1.8198, lr_0 = 2.0761e-04
Validation rmse = 0.093348
Epoch 39
Loss = 5.0838e-02, PNorm = 35.2388, GNorm = 0.5804, lr_0 = 2.0218e-04
Validation rmse = 0.090420
Epoch 40
Loss = 6.1034e-02, PNorm = 35.2444, GNorm = 0.9390, lr_0 = 1.9690e-04
Loss = 4.4111e-02, PNorm = 35.2489, GNorm = 1.1351, lr_0 = 1.9176e-04
Validation rmse = 0.087462
Epoch 41
Loss = 4.5424e-02, PNorm = 35.2530, GNorm = 0.9997, lr_0 = 1.8626e-04
Validation rmse = 0.088943
Epoch 42
Loss = 4.0005e-02, PNorm = 35.2570, GNorm = 0.5674, lr_0 = 1.8139e-04
Loss = 4.9574e-02, PNorm = 35.2619, GNorm = 2.2624, lr_0 = 1.7666e-04
Validation rmse = 0.089757
Epoch 43
Loss = 4.6586e-02, PNorm = 35.2657, GNorm = 1.7761, lr_0 = 1.7204e-04
Validation rmse = 0.087127
Epoch 44
Loss = 3.8386e-02, PNorm = 35.2704, GNorm = 0.9240, lr_0 = 1.6710e-04
Loss = 4.3314e-02, PNorm = 35.2734, GNorm = 0.5335, lr_0 = 1.6274e-04
Validation rmse = 0.087270
Epoch 45
Loss = 4.3893e-02, PNorm = 35.2782, GNorm = 0.8994, lr_0 = 1.5849e-04
Loss = 4.4661e-02, PNorm = 35.2823, GNorm = 0.8237, lr_0 = 1.5435e-04
Validation rmse = 0.087536
Epoch 46
Loss = 4.1889e-02, PNorm = 35.2854, GNorm = 1.1562, lr_0 = 1.5032e-04
Validation rmse = 0.087526
Epoch 47
Loss = 3.7669e-02, PNorm = 35.2899, GNorm = 1.1401, lr_0 = 1.4601e-04
Loss = 4.4202e-02, PNorm = 35.2928, GNorm = 0.8909, lr_0 = 1.4219e-04
Validation rmse = 0.086929
Epoch 48
Loss = 4.3731e-02, PNorm = 35.2974, GNorm = 3.2396, lr_0 = 1.3848e-04
Validation rmse = 0.087574
Epoch 49
Loss = 4.4790e-02, PNorm = 35.2997, GNorm = 0.4027, lr_0 = 1.3486e-04
Loss = 4.4905e-02, PNorm = 35.3031, GNorm = 1.9697, lr_0 = 1.3134e-04
Validation rmse = 0.088475
Epoch 50
Loss = 4.0490e-02, PNorm = 35.3061, GNorm = 0.4526, lr_0 = 1.2791e-04
Validation rmse = 0.089209
Epoch 51
Loss = 3.5021e-02, PNorm = 35.3093, GNorm = 0.5137, lr_0 = 1.2424e-04
Loss = 4.5355e-02, PNorm = 35.3123, GNorm = 1.6666, lr_0 = 1.2099e-04
Validation rmse = 0.087090
Epoch 52
Loss = 4.1812e-02, PNorm = 35.3149, GNorm = 0.4065, lr_0 = 1.1783e-04
Loss = 4.3508e-02, PNorm = 35.3179, GNorm = 1.8594, lr_0 = 1.1475e-04
Validation rmse = 0.088222
Epoch 53
Loss = 4.8663e-02, PNorm = 35.3206, GNorm = 1.9624, lr_0 = 1.1176e-04
Validation rmse = 0.087080
Epoch 54
Loss = 4.3278e-02, PNorm = 35.3233, GNorm = 0.4090, lr_0 = 1.0855e-04
Loss = 4.3178e-02, PNorm = 35.3260, GNorm = 0.6972, lr_0 = 1.0572e-04
Validation rmse = 0.087193
Epoch 55
Loss = 4.0214e-02, PNorm = 35.3289, GNorm = 1.1677, lr_0 = 1.0295e-04
Validation rmse = 0.086822
Epoch 56
Loss = 4.6434e-02, PNorm = 35.3314, GNorm = 1.7905, lr_0 = 1.0027e-04
Loss = 4.0357e-02, PNorm = 35.3336, GNorm = 2.0236, lr_0 = 1.0000e-04
Validation rmse = 0.085985
Epoch 57
Loss = 4.3554e-02, PNorm = 35.3365, GNorm = 0.8038, lr_0 = 1.0000e-04
Validation rmse = 0.086735
Epoch 58
Loss = 4.1243e-02, PNorm = 35.3387, GNorm = 1.2578, lr_0 = 1.0000e-04
Loss = 4.3530e-02, PNorm = 35.3417, GNorm = 0.8301, lr_0 = 1.0000e-04
Validation rmse = 0.086729
Epoch 59
Loss = 3.9113e-02, PNorm = 35.3440, GNorm = 0.3489, lr_0 = 1.0000e-04
Loss = 4.3533e-02, PNorm = 35.3466, GNorm = 0.9153, lr_0 = 1.0000e-04
Loss = 3.3925e-02, PNorm = 35.3468, GNorm = 1.0558, lr_0 = 1.0000e-04
Validation rmse = 0.090417
Model 0 best validation rmse = 0.085985 on epoch 56
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.070299
Ensemble test rmse = 0.070299
1-fold cross validation
	Seed 0 ==> test rmse = 0.070299
Overall test rmse = 0.070299 +/- 0.000000
Elapsed time = 0:00:39
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 977 | train size = 776 | val size = 196 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.0452e-01, PNorm = 34.0170, GNorm = 2.8417, lr_0 = 4.3000e-04
Validation rmse = 0.277186
Epoch 1
Loss = 6.5604e-01, PNorm = 34.0485, GNorm = 3.0679, lr_0 = 7.6000e-04
Loss = 5.7320e-01, PNorm = 34.1098, GNorm = 5.8820, lr_0 = 9.9472e-04
Validation rmse = 0.223621
Epoch 2
Loss = 4.2094e-01, PNorm = 34.1827, GNorm = 4.4634, lr_0 = 9.6874e-04
Validation rmse = 0.186984
Epoch 3
Loss = 3.2425e-01, PNorm = 34.2548, GNorm = 1.6503, lr_0 = 9.4094e-04
Loss = 2.9993e-01, PNorm = 34.3206, GNorm = 6.5082, lr_0 = 9.1637e-04
Validation rmse = 0.170781
Epoch 4
Loss = 2.5555e-01, PNorm = 34.3709, GNorm = 4.0286, lr_0 = 8.9243e-04
Validation rmse = 0.217026
Epoch 5
Loss = 2.9600e-01, PNorm = 34.4260, GNorm = 2.0227, lr_0 = 8.6682e-04
Loss = 2.2864e-01, PNorm = 34.4759, GNorm = 1.2337, lr_0 = 8.4418e-04
Validation rmse = 0.139529
Epoch 6
Loss = 1.7570e-01, PNorm = 34.5184, GNorm = 3.4053, lr_0 = 8.2213e-04
Validation rmse = 0.129758
Epoch 7
Loss = 1.3215e-01, PNorm = 34.5634, GNorm = 3.5931, lr_0 = 7.9854e-04
Loss = 1.3483e-01, PNorm = 34.6002, GNorm = 2.0895, lr_0 = 7.7769e-04
Validation rmse = 0.124400
Epoch 8
Loss = 1.0113e-01, PNorm = 34.6345, GNorm = 0.4560, lr_0 = 7.5737e-04
Validation rmse = 0.121081
Epoch 9
Loss = 8.0301e-02, PNorm = 34.6702, GNorm = 1.6566, lr_0 = 7.3564e-04
Loss = 1.0768e-01, PNorm = 34.6976, GNorm = 3.6069, lr_0 = 7.1643e-04
Validation rmse = 0.121103
Epoch 10
Loss = 1.1737e-01, PNorm = 34.7278, GNorm = 3.0771, lr_0 = 6.9772e-04
Loss = 9.4596e-02, PNorm = 34.7529, GNorm = 2.1298, lr_0 = 6.7949e-04
Loss = 1.1150e-01, PNorm = 34.7558, GNorm = 1.8000, lr_0 = 6.7770e-04
Validation rmse = 0.121123
Epoch 11
Loss = 8.6631e-02, PNorm = 34.7779, GNorm = 1.4087, lr_0 = 6.5999e-04
Validation rmse = 0.102326
Epoch 12
Loss = 8.0991e-02, PNorm = 34.8000, GNorm = 1.2758, lr_0 = 6.4276e-04
Loss = 8.0888e-02, PNorm = 34.8199, GNorm = 0.9331, lr_0 = 6.2597e-04
Validation rmse = 0.100767
Epoch 13
Loss = 9.0021e-02, PNorm = 34.8440, GNorm = 1.7400, lr_0 = 6.0801e-04
Validation rmse = 0.094688
Epoch 14
Loss = 5.6976e-02, PNorm = 34.8612, GNorm = 0.5701, lr_0 = 5.9213e-04
Loss = 7.6315e-02, PNorm = 34.8801, GNorm = 1.9237, lr_0 = 5.7666e-04
Validation rmse = 0.093970
Epoch 15
Loss = 6.5889e-02, PNorm = 34.8982, GNorm = 1.0637, lr_0 = 5.6011e-04
Validation rmse = 0.094035
Epoch 16
Loss = 5.9062e-02, PNorm = 34.9157, GNorm = 1.2932, lr_0 = 5.4548e-04
Loss = 7.3771e-02, PNorm = 34.9317, GNorm = 0.4726, lr_0 = 5.3124e-04
Validation rmse = 0.092126
Epoch 17
Loss = 6.3190e-02, PNorm = 34.9473, GNorm = 2.1821, lr_0 = 5.1599e-04
Validation rmse = 0.107710
Epoch 18
Loss = 9.5141e-02, PNorm = 34.9615, GNorm = 4.7697, lr_0 = 5.0252e-04
Loss = 7.0798e-02, PNorm = 34.9776, GNorm = 2.2648, lr_0 = 4.8939e-04
Validation rmse = 0.088819
Epoch 19
Loss = 6.5456e-02, PNorm = 34.9944, GNorm = 2.4847, lr_0 = 4.7535e-04
Loss = 5.6800e-02, PNorm = 35.0065, GNorm = 0.8998, lr_0 = 4.6293e-04
Validation rmse = 0.095561
Epoch 20
Loss = 5.9868e-02, PNorm = 35.0183, GNorm = 1.1713, lr_0 = 4.5084e-04
Validation rmse = 0.087563
Epoch 21
Loss = 5.6018e-02, PNorm = 35.0296, GNorm = 2.5249, lr_0 = 4.3790e-04
Loss = 6.7649e-02, PNorm = 35.0428, GNorm = 3.0826, lr_0 = 4.2647e-04
Validation rmse = 0.098616
Epoch 22
Loss = 5.1498e-02, PNorm = 35.0507, GNorm = 0.5314, lr_0 = 4.1533e-04
Validation rmse = 0.087109
Epoch 23
Loss = 5.2206e-02, PNorm = 35.0629, GNorm = 1.3265, lr_0 = 4.0341e-04
Loss = 5.3578e-02, PNorm = 35.0716, GNorm = 1.0175, lr_0 = 3.9287e-04
Validation rmse = 0.086374
Epoch 24
Loss = 5.2983e-02, PNorm = 35.0797, GNorm = 1.5771, lr_0 = 3.8261e-04
Validation rmse = 0.085282
Epoch 25
Loss = 4.6313e-02, PNorm = 35.0897, GNorm = 1.7802, lr_0 = 3.7262e-04
Loss = 5.1756e-02, PNorm = 35.0988, GNorm = 0.7209, lr_0 = 3.6289e-04
Validation rmse = 0.088145
Epoch 26
Loss = 5.3004e-02, PNorm = 35.1097, GNorm = 2.2248, lr_0 = 3.5247e-04
Validation rmse = 0.084360
Epoch 27
Loss = 4.9772e-02, PNorm = 35.1185, GNorm = 1.6953, lr_0 = 3.4327e-04
Loss = 4.9401e-02, PNorm = 35.1280, GNorm = 0.8361, lr_0 = 3.3430e-04
Validation rmse = 0.083871
Epoch 28
Loss = 4.7433e-02, PNorm = 35.1357, GNorm = 0.3586, lr_0 = 3.2471e-04
Loss = 5.2062e-02, PNorm = 35.1443, GNorm = 1.7594, lr_0 = 3.1623e-04
Validation rmse = 0.084047
Epoch 29
Loss = 4.8647e-02, PNorm = 35.1534, GNorm = 0.7804, lr_0 = 3.0797e-04
Validation rmse = 0.084620
Epoch 30
Loss = 4.3013e-02, PNorm = 35.1617, GNorm = 0.8485, lr_0 = 2.9913e-04
Loss = 4.8183e-02, PNorm = 35.1696, GNorm = 0.6684, lr_0 = 2.9132e-04
Validation rmse = 0.094758
Epoch 31
Loss = 4.6525e-02, PNorm = 35.1772, GNorm = 2.6819, lr_0 = 2.8371e-04
Validation rmse = 0.083992
Epoch 32
Loss = 5.0235e-02, PNorm = 35.1849, GNorm = 1.7068, lr_0 = 2.7557e-04
Loss = 4.7826e-02, PNorm = 35.1926, GNorm = 1.2508, lr_0 = 2.6837e-04
Validation rmse = 0.085114
Epoch 33
Loss = 4.9516e-02, PNorm = 35.1965, GNorm = 0.7359, lr_0 = 2.6136e-04
Validation rmse = 0.087103
Epoch 34
Loss = 3.9772e-02, PNorm = 35.2060, GNorm = 0.9511, lr_0 = 2.5386e-04
Loss = 4.7563e-02, PNorm = 35.2124, GNorm = 0.5916, lr_0 = 2.4723e-04
Validation rmse = 0.084220
Epoch 35
Loss = 4.1262e-02, PNorm = 35.2187, GNorm = 1.0882, lr_0 = 2.4077e-04
Validation rmse = 0.086940
Epoch 36
Loss = 5.5260e-02, PNorm = 35.2240, GNorm = 0.9784, lr_0 = 2.3387e-04
Loss = 4.6670e-02, PNorm = 35.2294, GNorm = 1.6296, lr_0 = 2.2776e-04
Validation rmse = 0.082651
Epoch 37
Loss = 4.8849e-02, PNorm = 35.2348, GNorm = 1.5676, lr_0 = 2.2181e-04
Validation rmse = 0.084111
Epoch 38
Loss = 4.8024e-02, PNorm = 35.2406, GNorm = 0.9161, lr_0 = 2.1544e-04
Loss = 4.0893e-02, PNorm = 35.2471, GNorm = 0.6112, lr_0 = 2.0982e-04
Validation rmse = 0.083992
Epoch 39
Loss = 4.5366e-02, PNorm = 35.2521, GNorm = 2.1330, lr_0 = 2.0434e-04
Loss = 4.5690e-02, PNorm = 35.2572, GNorm = 0.6909, lr_0 = 1.9900e-04
Loss = 1.9240e-02, PNorm = 35.2579, GNorm = 0.5161, lr_0 = 1.9847e-04
Validation rmse = 0.088344
Epoch 40
Loss = 4.3209e-02, PNorm = 35.2624, GNorm = 0.6246, lr_0 = 1.9329e-04
Validation rmse = 0.082960
Epoch 41
Loss = 4.2555e-02, PNorm = 35.2679, GNorm = 1.2099, lr_0 = 1.8824e-04
Loss = 4.5189e-02, PNorm = 35.2710, GNorm = 1.0571, lr_0 = 1.8332e-04
Validation rmse = 0.083910
Epoch 42
Loss = 4.5720e-02, PNorm = 35.2766, GNorm = 0.4902, lr_0 = 1.7806e-04
Validation rmse = 0.082254
Epoch 43
Loss = 3.7839e-02, PNorm = 35.2812, GNorm = 0.4833, lr_0 = 1.7341e-04
Loss = 4.7560e-02, PNorm = 35.2853, GNorm = 2.5451, lr_0 = 1.6888e-04
Validation rmse = 0.093501
Epoch 44
Loss = 4.2809e-02, PNorm = 35.2889, GNorm = 1.0734, lr_0 = 1.6404e-04
Validation rmse = 0.083459
Epoch 45
Loss = 3.6758e-02, PNorm = 35.2936, GNorm = 1.9238, lr_0 = 1.5975e-04
Loss = 3.9266e-02, PNorm = 35.2977, GNorm = 0.4412, lr_0 = 1.5558e-04
Validation rmse = 0.081730
Epoch 46
Loss = 4.1076e-02, PNorm = 35.3009, GNorm = 1.9107, lr_0 = 1.5112e-04
Validation rmse = 0.081278
Epoch 47
Loss = 5.9413e-02, PNorm = 35.3044, GNorm = 0.4931, lr_0 = 1.4717e-04
Loss = 3.5480e-02, PNorm = 35.3077, GNorm = 1.0949, lr_0 = 1.4332e-04
Validation rmse = 0.081507
Epoch 48
Loss = 3.9099e-02, PNorm = 35.3109, GNorm = 0.8466, lr_0 = 1.3921e-04
Loss = 4.3318e-02, PNorm = 35.3146, GNorm = 1.4152, lr_0 = 1.3558e-04
Validation rmse = 0.090030
Epoch 49
Loss = 4.1459e-02, PNorm = 35.3174, GNorm = 1.7279, lr_0 = 1.3204e-04
Validation rmse = 0.081517
Epoch 50
Loss = 4.1725e-02, PNorm = 35.3205, GNorm = 1.7528, lr_0 = 1.2859e-04
Loss = 3.6907e-02, PNorm = 35.3234, GNorm = 0.3992, lr_0 = 1.2523e-04
Validation rmse = 0.081307
Epoch 51
Loss = 3.9615e-02, PNorm = 35.3271, GNorm = 1.0661, lr_0 = 1.2163e-04
Validation rmse = 0.081602
Epoch 52
Loss = 3.0552e-02, PNorm = 35.3297, GNorm = 0.8995, lr_0 = 1.1846e-04
Loss = 4.1116e-02, PNorm = 35.3323, GNorm = 1.8282, lr_0 = 1.1536e-04
Validation rmse = 0.087153
Epoch 53
Loss = 4.4142e-02, PNorm = 35.3349, GNorm = 0.9763, lr_0 = 1.1205e-04
Validation rmse = 0.081301
Epoch 54
Loss = 4.1699e-02, PNorm = 35.3378, GNorm = 0.6192, lr_0 = 1.0913e-04
Loss = 3.6890e-02, PNorm = 35.3398, GNorm = 1.2370, lr_0 = 1.0628e-04
Validation rmse = 0.081667
Epoch 55
Loss = 4.1625e-02, PNorm = 35.3427, GNorm = 0.8831, lr_0 = 1.0323e-04
Validation rmse = 0.085377
Epoch 56
Loss = 4.6489e-02, PNorm = 35.3456, GNorm = 0.5544, lr_0 = 1.0053e-04
Loss = 3.6009e-02, PNorm = 35.3472, GNorm = 0.7207, lr_0 = 1.0000e-04
Validation rmse = 0.082440
Epoch 57
Loss = 3.8158e-02, PNorm = 35.3501, GNorm = 1.8743, lr_0 = 1.0000e-04
Loss = 3.8499e-02, PNorm = 35.3524, GNorm = 1.5495, lr_0 = 1.0000e-04
Validation rmse = 0.081627
Epoch 58
Loss = 3.8742e-02, PNorm = 35.3541, GNorm = 1.8323, lr_0 = 1.0000e-04
Validation rmse = 0.083560
Epoch 59
Loss = 3.8185e-02, PNorm = 35.3570, GNorm = 0.9513, lr_0 = 1.0000e-04
Loss = 3.9153e-02, PNorm = 35.3592, GNorm = 1.6419, lr_0 = 1.0000e-04
Validation rmse = 0.081989
Model 0 best validation rmse = 0.081278 on epoch 46
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.053973
Ensemble test rmse = 0.053973
1-fold cross validation
	Seed 0 ==> test rmse = 0.053973
Overall test rmse = 0.053973 +/- 0.000000
Elapsed time = 0:00:33
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 967 | train size = 768 | val size = 194 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1050e-01, PNorm = 34.0180, GNorm = 5.2337, lr_0 = 4.3000e-04
Validation rmse = 0.294146
Epoch 1
Loss = 6.3082e-01, PNorm = 34.0518, GNorm = 11.8006, lr_0 = 7.6000e-04
Loss = 6.5487e-01, PNorm = 34.0986, GNorm = 3.8297, lr_0 = 9.9472e-04
Loss = 4.1624e-01, PNorm = 34.1045, GNorm = 2.2746, lr_0 = 9.9209e-04
Validation rmse = 0.267957
Epoch 2
Loss = 4.2198e-01, PNorm = 34.1698, GNorm = 3.3799, lr_0 = 9.6618e-04
Validation rmse = 0.231056
Epoch 3
Loss = 3.9100e-01, PNorm = 34.2337, GNorm = 4.0429, lr_0 = 9.4094e-04
Loss = 2.7730e-01, PNorm = 34.3047, GNorm = 1.3629, lr_0 = 9.1637e-04
Validation rmse = 0.177332
Epoch 4
Loss = 2.2282e-01, PNorm = 34.3748, GNorm = 5.8918, lr_0 = 8.9007e-04
Validation rmse = 0.154865
Epoch 5
Loss = 1.6545e-01, PNorm = 34.4391, GNorm = 3.4824, lr_0 = 8.6453e-04
Loss = 1.8677e-01, PNorm = 34.4866, GNorm = 5.4916, lr_0 = 8.4195e-04
Validation rmse = 0.142668
Epoch 6
Loss = 1.5821e-01, PNorm = 34.5269, GNorm = 1.2484, lr_0 = 8.1996e-04
Validation rmse = 0.135427
Epoch 7
Loss = 1.4311e-01, PNorm = 34.5717, GNorm = 1.5703, lr_0 = 7.9643e-04
Loss = 1.2856e-01, PNorm = 34.6076, GNorm = 6.5554, lr_0 = 7.7563e-04
Validation rmse = 0.122300
Epoch 8
Loss = 1.6779e-01, PNorm = 34.6435, GNorm = 8.4595, lr_0 = 7.5338e-04
Validation rmse = 0.146006
Epoch 9
Loss = 1.4433e-01, PNorm = 34.6745, GNorm = 3.2846, lr_0 = 7.3370e-04
Loss = 1.0567e-01, PNorm = 34.7046, GNorm = 3.9922, lr_0 = 7.1453e-04
Validation rmse = 0.112733
Epoch 10
Loss = 9.1246e-02, PNorm = 34.7284, GNorm = 1.8793, lr_0 = 6.9403e-04
Validation rmse = 0.112992
Epoch 11
Loss = 6.7579e-02, PNorm = 34.7558, GNorm = 2.9882, lr_0 = 6.7412e-04
Loss = 1.2744e-01, PNorm = 34.7790, GNorm = 4.4128, lr_0 = 6.5651e-04
Validation rmse = 0.112782
Epoch 12
Loss = 9.1616e-02, PNorm = 34.8029, GNorm = 5.2350, lr_0 = 6.3936e-04
Validation rmse = 0.130704
Epoch 13
Loss = 1.1435e-01, PNorm = 34.8276, GNorm = 4.3691, lr_0 = 6.2102e-04
Loss = 1.0983e-01, PNorm = 34.8486, GNorm = 5.2309, lr_0 = 6.0480e-04
Validation rmse = 0.105147
Epoch 14
Loss = 8.0428e-02, PNorm = 34.8694, GNorm = 0.6935, lr_0 = 5.8900e-04
Loss = 6.8167e-02, PNorm = 34.8837, GNorm = 1.8149, lr_0 = 5.7362e-04
Loss = 8.0888e-02, PNorm = 34.8844, GNorm = 4.6986, lr_0 = 5.7210e-04
Validation rmse = 0.113107
Epoch 15
Loss = 9.6617e-02, PNorm = 34.9003, GNorm = 0.9014, lr_0 = 5.5716e-04
Validation rmse = 0.094737
Epoch 16
Loss = 7.1342e-02, PNorm = 34.9157, GNorm = 2.0577, lr_0 = 5.4117e-04
Loss = 6.6942e-02, PNorm = 34.9306, GNorm = 0.8542, lr_0 = 5.2703e-04
Validation rmse = 0.092896
Epoch 17
Loss = 6.9654e-02, PNorm = 34.9440, GNorm = 2.4553, lr_0 = 5.1327e-04
Validation rmse = 0.091288
Epoch 18
Loss = 5.5128e-02, PNorm = 34.9586, GNorm = 1.4235, lr_0 = 4.9854e-04
Loss = 7.0977e-02, PNorm = 34.9695, GNorm = 1.4633, lr_0 = 4.8552e-04
Validation rmse = 0.094079
Epoch 19
Loss = 5.8652e-02, PNorm = 34.9813, GNorm = 0.9775, lr_0 = 4.7159e-04
Validation rmse = 0.089938
Epoch 20
Loss = 4.6010e-02, PNorm = 34.9937, GNorm = 0.6838, lr_0 = 4.5927e-04
Loss = 6.1312e-02, PNorm = 35.0035, GNorm = 2.5249, lr_0 = 4.4728e-04
Validation rmse = 0.095296
Epoch 21
Loss = 5.9405e-02, PNorm = 35.0139, GNorm = 0.5653, lr_0 = 4.3444e-04
Validation rmse = 0.092218
Epoch 22
Loss = 5.0657e-02, PNorm = 35.0251, GNorm = 0.6393, lr_0 = 4.2198e-04
Loss = 5.9023e-02, PNorm = 35.0347, GNorm = 1.1336, lr_0 = 4.1095e-04
Validation rmse = 0.088936
Epoch 23
Loss = 5.1512e-02, PNorm = 35.0449, GNorm = 1.4267, lr_0 = 4.0022e-04
Validation rmse = 0.090979
Epoch 24
Loss = 6.3812e-02, PNorm = 35.0574, GNorm = 1.7705, lr_0 = 3.8874e-04
Loss = 6.1045e-02, PNorm = 35.0658, GNorm = 0.7737, lr_0 = 3.7858e-04
Validation rmse = 0.095604
Epoch 25
Loss = 6.7795e-02, PNorm = 35.0759, GNorm = 4.0424, lr_0 = 3.6869e-04
Validation rmse = 0.102702
Epoch 26
Loss = 6.0307e-02, PNorm = 35.0861, GNorm = 3.6169, lr_0 = 3.5812e-04
Loss = 5.8355e-02, PNorm = 35.0949, GNorm = 1.2956, lr_0 = 3.4876e-04
Validation rmse = 0.089182
Epoch 27
Loss = 5.6819e-02, PNorm = 35.1036, GNorm = 0.8918, lr_0 = 3.3875e-04
Loss = 5.0430e-02, PNorm = 35.1119, GNorm = 1.5636, lr_0 = 3.2991e-04
Validation rmse = 0.084685
Epoch 28
Loss = 4.7381e-02, PNorm = 35.1206, GNorm = 1.0400, lr_0 = 3.2129e-04
Validation rmse = 0.083617
Epoch 29
Loss = 4.6264e-02, PNorm = 35.1283, GNorm = 1.0884, lr_0 = 3.1207e-04
Loss = 5.5341e-02, PNorm = 35.1361, GNorm = 0.8222, lr_0 = 3.0392e-04
Loss = 3.1639e-02, PNorm = 35.1368, GNorm = 1.0499, lr_0 = 3.0312e-04
Validation rmse = 0.084641
Epoch 30
Loss = 4.5294e-02, PNorm = 35.1445, GNorm = 1.8202, lr_0 = 2.9520e-04
Validation rmse = 0.090608
Epoch 31
Loss = 4.7403e-02, PNorm = 35.1511, GNorm = 0.6073, lr_0 = 2.8749e-04
Loss = 5.2412e-02, PNorm = 35.1583, GNorm = 3.4921, lr_0 = 2.7998e-04
Validation rmse = 0.101220
Epoch 32
Loss = 6.0358e-02, PNorm = 35.1666, GNorm = 0.9382, lr_0 = 2.7195e-04
Validation rmse = 0.085024
Epoch 33
Loss = 5.4531e-02, PNorm = 35.1737, GNorm = 1.3119, lr_0 = 2.6414e-04
Loss = 4.6436e-02, PNorm = 35.1813, GNorm = 0.5819, lr_0 = 2.5724e-04
Validation rmse = 0.087749
Epoch 34
Loss = 4.8943e-02, PNorm = 35.1866, GNorm = 0.9812, lr_0 = 2.5052e-04
Validation rmse = 0.085913
Epoch 35
Loss = 5.3768e-02, PNorm = 35.1934, GNorm = 1.8679, lr_0 = 2.4334e-04
Loss = 4.4907e-02, PNorm = 35.1998, GNorm = 0.8771, lr_0 = 2.3698e-04
Validation rmse = 0.083185
Epoch 36
Loss = 4.8904e-02, PNorm = 35.2056, GNorm = 2.0764, lr_0 = 2.3018e-04
Validation rmse = 0.084041
Epoch 37
Loss = 5.4133e-02, PNorm = 35.2119, GNorm = 0.4355, lr_0 = 2.2417e-04
Loss = 4.1669e-02, PNorm = 35.2173, GNorm = 0.8004, lr_0 = 2.1831e-04
Validation rmse = 0.081370
Epoch 38
Loss = 4.0682e-02, PNorm = 35.2223, GNorm = 1.1259, lr_0 = 2.1205e-04
Validation rmse = 0.082829
Epoch 39
Loss = 3.4626e-02, PNorm = 35.2273, GNorm = 0.5798, lr_0 = 2.0651e-04
Loss = 4.4283e-02, PNorm = 35.2324, GNorm = 0.6428, lr_0 = 2.0112e-04
Validation rmse = 0.085390
Epoch 40
Loss = 4.4526e-02, PNorm = 35.2381, GNorm = 3.2114, lr_0 = 1.9535e-04
Validation rmse = 0.088473
Epoch 41
Loss = 3.3974e-02, PNorm = 35.2433, GNorm = 1.1617, lr_0 = 1.8974e-04
Loss = 4.3649e-02, PNorm = 35.2473, GNorm = 1.7167, lr_0 = 1.8478e-04
Validation rmse = 0.082806
Epoch 42
Loss = 4.1105e-02, PNorm = 35.2511, GNorm = 0.6977, lr_0 = 1.7996e-04
Loss = 4.2733e-02, PNorm = 35.2561, GNorm = 1.1825, lr_0 = 1.7526e-04
Loss = 6.2042e-02, PNorm = 35.2564, GNorm = 1.7559, lr_0 = 1.7479e-04
Validation rmse = 0.080630
Epoch 43
Loss = 4.0664e-02, PNorm = 35.2610, GNorm = 0.9830, lr_0 = 1.7023e-04
Validation rmse = 0.081154
Epoch 44
Loss = 3.6339e-02, PNorm = 35.2648, GNorm = 0.5046, lr_0 = 1.6534e-04
Loss = 4.3632e-02, PNorm = 35.2681, GNorm = 0.4742, lr_0 = 1.6103e-04
Validation rmse = 0.085835
Epoch 45
Loss = 4.0398e-02, PNorm = 35.2719, GNorm = 1.3447, lr_0 = 1.5682e-04
Validation rmse = 0.080760
Epoch 46
Loss = 4.6057e-02, PNorm = 35.2767, GNorm = 0.7829, lr_0 = 1.5232e-04
Loss = 3.9604e-02, PNorm = 35.2811, GNorm = 0.7133, lr_0 = 1.4834e-04
Validation rmse = 0.080248
Epoch 47
Loss = 4.0338e-02, PNorm = 35.2846, GNorm = 0.8799, lr_0 = 1.4409e-04
Validation rmse = 0.080425
Epoch 48
Loss = 3.5191e-02, PNorm = 35.2877, GNorm = 0.3190, lr_0 = 1.4032e-04
Loss = 4.0300e-02, PNorm = 35.2906, GNorm = 1.5428, lr_0 = 1.3666e-04
Validation rmse = 0.080528
Epoch 49
Loss = 4.0585e-02, PNorm = 35.2941, GNorm = 0.5487, lr_0 = 1.3274e-04
Validation rmse = 0.080209
Epoch 50
Loss = 4.5360e-02, PNorm = 35.2975, GNorm = 1.3143, lr_0 = 1.2927e-04
Loss = 3.8946e-02, PNorm = 35.3005, GNorm = 1.4556, lr_0 = 1.2589e-04
Validation rmse = 0.080035
Epoch 51
Loss = 3.8751e-02, PNorm = 35.3043, GNorm = 0.6507, lr_0 = 1.2228e-04
Validation rmse = 0.080840
Epoch 52
Loss = 3.4014e-02, PNorm = 35.3077, GNorm = 1.0048, lr_0 = 1.1877e-04
Loss = 4.4873e-02, PNorm = 35.3106, GNorm = 0.5436, lr_0 = 1.1567e-04
Validation rmse = 0.080888
Epoch 53
Loss = 4.4504e-02, PNorm = 35.3140, GNorm = 3.1717, lr_0 = 1.1265e-04
Validation rmse = 0.079577
Epoch 54
Loss = 4.8030e-02, PNorm = 35.3174, GNorm = 1.8159, lr_0 = 1.0942e-04
Loss = 3.9439e-02, PNorm = 35.3205, GNorm = 1.6411, lr_0 = 1.0656e-04
Validation rmse = 0.080401
Epoch 55
Loss = 3.8588e-02, PNorm = 35.3231, GNorm = 0.6467, lr_0 = 1.0350e-04
Loss = 3.8911e-02, PNorm = 35.3256, GNorm = 1.3340, lr_0 = 1.0080e-04
Validation rmse = 0.079783
Epoch 56
Loss = 4.1525e-02, PNorm = 35.3278, GNorm = 0.9923, lr_0 = 1.0000e-04
Validation rmse = 0.081630
Epoch 57
Loss = 3.4432e-02, PNorm = 35.3303, GNorm = 0.8293, lr_0 = 1.0000e-04
Loss = 3.9923e-02, PNorm = 35.3327, GNorm = 0.9003, lr_0 = 1.0000e-04
Loss = 3.8839e-02, PNorm = 35.3329, GNorm = 0.6526, lr_0 = 1.0000e-04
Validation rmse = 0.079364
Epoch 58
Loss = 3.7700e-02, PNorm = 35.3355, GNorm = 0.6758, lr_0 = 1.0000e-04
Validation rmse = 0.080059
Epoch 59
Loss = 3.4881e-02, PNorm = 35.3375, GNorm = 1.4718, lr_0 = 1.0000e-04
Loss = 3.8681e-02, PNorm = 35.3401, GNorm = 0.5425, lr_0 = 1.0000e-04
Validation rmse = 0.079392
Model 0 best validation rmse = 0.079364 on epoch 57
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.035879
Ensemble test rmse = 0.035879
1-fold cross validation
	Seed 0 ==> test rmse = 0.035879
Overall test rmse = 0.035879 +/- 0.000000
Elapsed time = 0:00:35
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 957 | train size = 760 | val size = 192 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1893e-01, PNorm = 34.0179, GNorm = 3.1060, lr_0 = 4.3000e-04
Validation rmse = 0.285992
Epoch 1
Loss = 6.2427e-01, PNorm = 34.0597, GNorm = 12.9980, lr_0 = 7.6000e-04
Loss = 6.2965e-01, PNorm = 34.1054, GNorm = 3.9256, lr_0 = 9.9472e-04
Loss = 6.2372e-01, PNorm = 34.1104, GNorm = 7.5450, lr_0 = 9.9209e-04
Validation rmse = 0.282186
Epoch 2
Loss = 5.4522e-01, PNorm = 34.1712, GNorm = 8.9782, lr_0 = 9.6618e-04
Validation rmse = 0.223580
Epoch 3
Loss = 3.2594e-01, PNorm = 34.2407, GNorm = 5.7641, lr_0 = 9.3846e-04
Loss = 3.2210e-01, PNorm = 34.3019, GNorm = 2.2758, lr_0 = 9.1394e-04
Loss = 4.5082e-01, PNorm = 34.3087, GNorm = 3.3770, lr_0 = 9.1153e-04
Validation rmse = 0.223585
Epoch 4
Loss = 2.9478e-01, PNorm = 34.3623, GNorm = 1.0263, lr_0 = 8.8772e-04
Validation rmse = 0.183825
Epoch 5
Loss = 2.3988e-01, PNorm = 34.4131, GNorm = 1.3183, lr_0 = 8.6453e-04
Loss = 2.1460e-01, PNorm = 34.4559, GNorm = 0.6512, lr_0 = 8.4195e-04
Validation rmse = 0.167558
Epoch 6
Loss = 1.9354e-01, PNorm = 34.5028, GNorm = 2.1919, lr_0 = 8.1779e-04
Validation rmse = 0.155001
Epoch 7
Loss = 1.5536e-01, PNorm = 34.5450, GNorm = 3.4425, lr_0 = 7.9433e-04
Loss = 1.9018e-01, PNorm = 34.5763, GNorm = 7.3534, lr_0 = 7.7358e-04
Validation rmse = 0.181843
Epoch 8
Loss = 1.8463e-01, PNorm = 34.6160, GNorm = 6.1926, lr_0 = 7.5138e-04
Validation rmse = 0.162101
Epoch 9
Loss = 1.5382e-01, PNorm = 34.6530, GNorm = 0.7198, lr_0 = 7.2982e-04
Loss = 1.2765e-01, PNorm = 34.6883, GNorm = 1.6004, lr_0 = 7.1076e-04
Validation rmse = 0.144632
Epoch 10
Loss = 1.2533e-01, PNorm = 34.7164, GNorm = 2.3990, lr_0 = 6.9220e-04
Validation rmse = 0.119679
Epoch 11
Loss = 8.4909e-02, PNorm = 34.7468, GNorm = 1.5230, lr_0 = 6.7234e-04
Loss = 9.6357e-02, PNorm = 34.7767, GNorm = 1.5311, lr_0 = 6.5477e-04
Validation rmse = 0.113619
Epoch 12
Loss = 1.0575e-01, PNorm = 34.8003, GNorm = 2.2204, lr_0 = 6.3599e-04
Validation rmse = 0.120855
Epoch 13
Loss = 9.9470e-02, PNorm = 34.8260, GNorm = 2.0212, lr_0 = 6.1774e-04
Loss = 9.0861e-02, PNorm = 34.8476, GNorm = 1.2596, lr_0 = 6.0160e-04
Validation rmse = 0.104860
Epoch 14
Loss = 7.0170e-02, PNorm = 34.8729, GNorm = 0.4513, lr_0 = 5.8434e-04
Validation rmse = 0.104935
Epoch 15
Loss = 8.9207e-02, PNorm = 34.8923, GNorm = 2.1245, lr_0 = 5.6908e-04
Loss = 7.1036e-02, PNorm = 34.9087, GNorm = 0.4449, lr_0 = 5.5421e-04
Validation rmse = 0.103091
Epoch 16
Loss = 7.0648e-02, PNorm = 34.9336, GNorm = 1.4235, lr_0 = 5.3831e-04
Validation rmse = 0.095395
Epoch 17
Loss = 7.3847e-02, PNorm = 34.9532, GNorm = 0.7874, lr_0 = 5.2287e-04
Loss = 6.9068e-02, PNorm = 34.9725, GNorm = 1.5488, lr_0 = 5.0921e-04
Validation rmse = 0.094255
Epoch 18
Loss = 5.8338e-02, PNorm = 34.9881, GNorm = 2.3393, lr_0 = 4.9460e-04
Validation rmse = 0.092016
Epoch 19
Loss = 6.0355e-02, PNorm = 35.0044, GNorm = 0.4812, lr_0 = 4.8041e-04
Loss = 6.3014e-02, PNorm = 35.0215, GNorm = 1.5968, lr_0 = 4.6786e-04
Validation rmse = 0.089782
Epoch 20
Loss = 5.7848e-02, PNorm = 35.0347, GNorm = 1.1158, lr_0 = 4.5564e-04
Validation rmse = 0.089866
Epoch 21
Loss = 5.6764e-02, PNorm = 35.0518, GNorm = 0.4676, lr_0 = 4.4256e-04
Loss = 5.6616e-02, PNorm = 35.0667, GNorm = 1.5783, lr_0 = 4.3101e-04
Validation rmse = 0.088091
Epoch 22
Loss = 4.9216e-02, PNorm = 35.0781, GNorm = 0.9888, lr_0 = 4.1864e-04
Validation rmse = 0.090770
Epoch 23
Loss = 6.5857e-02, PNorm = 35.0917, GNorm = 0.8334, lr_0 = 4.0663e-04
Loss = 5.3540e-02, PNorm = 35.1034, GNorm = 0.8076, lr_0 = 3.9601e-04
Validation rmse = 0.085031
Epoch 24
Loss = 5.0774e-02, PNorm = 35.1167, GNorm = 0.9706, lr_0 = 3.8464e-04
Loss = 5.5667e-02, PNorm = 35.1277, GNorm = 1.2950, lr_0 = 3.7460e-04
Validation rmse = 0.088832
Epoch 25
Loss = 5.4097e-02, PNorm = 35.1416, GNorm = 2.5078, lr_0 = 3.6481e-04
Validation rmse = 0.087392
Epoch 26
Loss = 4.8591e-02, PNorm = 35.1526, GNorm = 0.5278, lr_0 = 3.5434e-04
Loss = 4.8039e-02, PNorm = 35.1639, GNorm = 1.1931, lr_0 = 3.4509e-04
Loss = 5.1617e-02, PNorm = 35.1652, GNorm = 1.0700, lr_0 = 3.4418e-04
Validation rmse = 0.088030
Epoch 27
Loss = 4.8128e-02, PNorm = 35.1731, GNorm = 1.0485, lr_0 = 3.3519e-04
Validation rmse = 0.085611
Epoch 28
Loss = 4.5418e-02, PNorm = 35.1857, GNorm = 0.4550, lr_0 = 3.2557e-04
Loss = 5.2840e-02, PNorm = 35.1965, GNorm = 2.9024, lr_0 = 3.1707e-04
Loss = 3.0619e-02, PNorm = 35.1974, GNorm = 1.5651, lr_0 = 3.1623e-04
Validation rmse = 0.087737
Epoch 29
Loss = 4.4593e-02, PNorm = 35.2054, GNorm = 0.6287, lr_0 = 3.0797e-04
Validation rmse = 0.083649
Epoch 30
Loss = 4.6409e-02, PNorm = 35.2153, GNorm = 1.5153, lr_0 = 2.9992e-04
Loss = 4.7302e-02, PNorm = 35.2242, GNorm = 1.1762, lr_0 = 2.9209e-04
Validation rmse = 0.087185
Epoch 31
Loss = 4.7936e-02, PNorm = 35.2329, GNorm = 2.9121, lr_0 = 2.8371e-04
Validation rmse = 0.084668
Epoch 32
Loss = 5.1082e-02, PNorm = 35.2399, GNorm = 2.4060, lr_0 = 2.7557e-04
Loss = 4.5268e-02, PNorm = 35.2483, GNorm = 1.2850, lr_0 = 2.6837e-04
Validation rmse = 0.083191
Epoch 33
Loss = 4.4071e-02, PNorm = 35.2571, GNorm = 1.8334, lr_0 = 2.6067e-04
Validation rmse = 0.086274
Epoch 34
Loss = 4.8934e-02, PNorm = 35.2639, GNorm = 0.7341, lr_0 = 2.5319e-04
Loss = 4.3684e-02, PNorm = 35.2702, GNorm = 1.2755, lr_0 = 2.4658e-04
Validation rmse = 0.087096
Epoch 35
Loss = 4.2450e-02, PNorm = 35.2771, GNorm = 2.6541, lr_0 = 2.4014e-04
Validation rmse = 0.088361
Epoch 36
Loss = 4.2341e-02, PNorm = 35.2852, GNorm = 0.8095, lr_0 = 2.3325e-04
Loss = 4.2124e-02, PNorm = 35.2915, GNorm = 0.7638, lr_0 = 2.2715e-04
Validation rmse = 0.082906
Epoch 37
Loss = 3.9575e-02, PNorm = 35.2983, GNorm = 1.3311, lr_0 = 2.2064e-04
Validation rmse = 0.082055
Epoch 38
Loss = 4.9564e-02, PNorm = 35.3043, GNorm = 1.4898, lr_0 = 2.1431e-04
Loss = 3.6980e-02, PNorm = 35.3102, GNorm = 0.3526, lr_0 = 2.0871e-04
Validation rmse = 0.082696
Epoch 39
Loss = 3.9388e-02, PNorm = 35.3164, GNorm = 0.7260, lr_0 = 2.0272e-04
Validation rmse = 0.085146
Epoch 40
Loss = 4.5153e-02, PNorm = 35.3212, GNorm = 1.7027, lr_0 = 1.9743e-04
Loss = 3.7033e-02, PNorm = 35.3261, GNorm = 0.8583, lr_0 = 1.9227e-04
Validation rmse = 0.082853
Epoch 41
Loss = 4.0710e-02, PNorm = 35.3327, GNorm = 0.8687, lr_0 = 1.8675e-04
Validation rmse = 0.084734
Epoch 42
Loss = 5.4106e-02, PNorm = 35.3386, GNorm = 2.1927, lr_0 = 1.8139e-04
Loss = 4.0040e-02, PNorm = 35.3436, GNorm = 1.6176, lr_0 = 1.7666e-04
Validation rmse = 0.088177
Epoch 43
Loss = 4.8710e-02, PNorm = 35.3481, GNorm = 2.2747, lr_0 = 1.7159e-04
Validation rmse = 0.085392
Epoch 44
Loss = 3.8626e-02, PNorm = 35.3539, GNorm = 1.6973, lr_0 = 1.6666e-04
Loss = 3.9745e-02, PNorm = 35.3587, GNorm = 0.5692, lr_0 = 1.6231e-04
Validation rmse = 0.081188
Epoch 45
Loss = 3.5904e-02, PNorm = 35.3632, GNorm = 1.1621, lr_0 = 1.5807e-04
Validation rmse = 0.080821
Epoch 46
Loss = 2.4875e-02, PNorm = 35.3666, GNorm = 0.8349, lr_0 = 1.5353e-04
Loss = 3.8321e-02, PNorm = 35.3709, GNorm = 1.0452, lr_0 = 1.4952e-04
Validation rmse = 0.080665
Epoch 47
Loss = 3.0341e-02, PNorm = 35.3758, GNorm = 0.8280, lr_0 = 1.4523e-04
Validation rmse = 0.081967
Epoch 48
Loss = 2.1920e-02, PNorm = 35.3805, GNorm = 1.2287, lr_0 = 1.4107e-04
Loss = 3.5329e-02, PNorm = 35.3832, GNorm = 0.3974, lr_0 = 1.3738e-04
Validation rmse = 0.081233
Epoch 49
Loss = 3.3098e-02, PNorm = 35.3869, GNorm = 0.6166, lr_0 = 1.3344e-04
Loss = 3.7482e-02, PNorm = 35.3903, GNorm = 1.2146, lr_0 = 1.2996e-04
Validation rmse = 0.080343
Epoch 50
Loss = 3.7338e-02, PNorm = 35.3932, GNorm = 2.2220, lr_0 = 1.2656e-04
Validation rmse = 0.082876
Epoch 51
Loss = 3.6318e-02, PNorm = 35.3977, GNorm = 1.3520, lr_0 = 1.2293e-04
Loss = 3.7934e-02, PNorm = 35.4005, GNorm = 1.3317, lr_0 = 1.1972e-04
Loss = 3.2312e-02, PNorm = 35.4010, GNorm = 2.3128, lr_0 = 1.1940e-04
Validation rmse = 0.080509
Epoch 52
Loss = 4.0052e-02, PNorm = 35.4045, GNorm = 0.7547, lr_0 = 1.1628e-04
Validation rmse = 0.082533
Epoch 53
Loss = 3.8205e-02, PNorm = 35.4083, GNorm = 0.6149, lr_0 = 1.1295e-04
Loss = 3.6002e-02, PNorm = 35.4115, GNorm = 0.5174, lr_0 = 1.1000e-04
Loss = 8.5025e-03, PNorm = 35.4116, GNorm = 0.8454, lr_0 = 1.0971e-04
Validation rmse = 0.080547
Epoch 54
Loss = 3.5315e-02, PNorm = 35.4144, GNorm = 1.5862, lr_0 = 1.0684e-04
Validation rmse = 0.081728
Epoch 55
Loss = 3.5539e-02, PNorm = 35.4166, GNorm = 1.5365, lr_0 = 1.0405e-04
Loss = 3.4344e-02, PNorm = 35.4188, GNorm = 0.4945, lr_0 = 1.0133e-04
Validation rmse = 0.079892
Epoch 56
Loss = 3.6278e-02, PNorm = 35.4215, GNorm = 0.4747, lr_0 = 1.0000e-04
Validation rmse = 0.082840
Epoch 57
Loss = 3.4588e-02, PNorm = 35.4241, GNorm = 0.7879, lr_0 = 1.0000e-04
Loss = 4.0452e-02, PNorm = 35.4271, GNorm = 1.4820, lr_0 = 1.0000e-04
Validation rmse = 0.082684
Epoch 58
Loss = 3.2718e-02, PNorm = 35.4307, GNorm = 0.3503, lr_0 = 1.0000e-04
Validation rmse = 0.082132
Epoch 59
Loss = 3.5177e-02, PNorm = 35.4328, GNorm = 1.3997, lr_0 = 1.0000e-04
Loss = 3.4692e-02, PNorm = 35.4355, GNorm = 0.9738, lr_0 = 1.0000e-04
Validation rmse = 0.080694
Model 0 best validation rmse = 0.079892 on epoch 55
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.053799
Ensemble test rmse = 0.053799
1-fold cross validation
	Seed 0 ==> test rmse = 0.053799
Overall test rmse = 0.053799 +/- 0.000000
Elapsed time = 0:00:38
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 947 | train size = 752 | val size = 190 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.0164e-01, PNorm = 34.0180, GNorm = 2.3200, lr_0 = 4.3000e-04
Validation rmse = 0.295069
Epoch 1
Loss = 6.8008e-01, PNorm = 34.0486, GNorm = 6.3365, lr_0 = 7.6000e-04
Loss = 5.6892e-01, PNorm = 34.0993, GNorm = 4.9516, lr_0 = 9.9472e-04
Loss = 1.3867e-01, PNorm = 34.1065, GNorm = 7.7721, lr_0 = 9.9209e-04
Validation rmse = 0.288707
Epoch 2
Loss = 4.8727e-01, PNorm = 34.1716, GNorm = 7.1334, lr_0 = 9.6618e-04
Validation rmse = 0.222886
Epoch 3
Loss = 4.4657e-01, PNorm = 34.2376, GNorm = 11.0480, lr_0 = 9.3846e-04
Loss = 4.0372e-01, PNorm = 34.2827, GNorm = 2.9564, lr_0 = 9.1394e-04
Loss = 3.1436e-01, PNorm = 34.2874, GNorm = 3.2314, lr_0 = 9.1153e-04
Validation rmse = 0.201941
Epoch 4
Loss = 2.9628e-01, PNorm = 34.3424, GNorm = 2.1186, lr_0 = 8.8772e-04
Validation rmse = 0.181692
Epoch 5
Loss = 2.4804e-01, PNorm = 34.3879, GNorm = 1.0578, lr_0 = 8.6225e-04
Loss = 1.9219e-01, PNorm = 34.4367, GNorm = 5.3550, lr_0 = 8.3973e-04
Loss = 6.7092e-02, PNorm = 34.4414, GNorm = 6.1733, lr_0 = 8.3751e-04
Validation rmse = 0.166891
Epoch 6
Loss = 1.7851e-01, PNorm = 34.4771, GNorm = 4.5528, lr_0 = 8.1563e-04
Validation rmse = 0.207249
Epoch 7
Loss = 2.5717e-01, PNorm = 34.5152, GNorm = 9.0805, lr_0 = 7.9223e-04
Loss = 1.7605e-01, PNorm = 34.5488, GNorm = 8.0375, lr_0 = 7.7154e-04
Loss = 7.1450e-02, PNorm = 34.5518, GNorm = 3.1019, lr_0 = 7.6950e-04
Validation rmse = 0.151734
Epoch 8
Loss = 1.4189e-01, PNorm = 34.5794, GNorm = 4.1899, lr_0 = 7.4940e-04
Validation rmse = 0.130241
Epoch 9
Loss = 1.2410e-01, PNorm = 34.6118, GNorm = 4.4214, lr_0 = 7.2790e-04
Loss = 1.1622e-01, PNorm = 34.6377, GNorm = 0.6093, lr_0 = 7.0888e-04
Loss = 2.9286e-02, PNorm = 34.6400, GNorm = 1.4377, lr_0 = 7.0701e-04
Validation rmse = 0.127216
Epoch 10
Loss = 1.1388e-01, PNorm = 34.6650, GNorm = 2.8556, lr_0 = 6.8854e-04
Validation rmse = 0.132325
Epoch 11
Loss = 1.0890e-01, PNorm = 34.6898, GNorm = 0.9106, lr_0 = 6.6879e-04
Loss = 1.0307e-01, PNorm = 34.7102, GNorm = 2.0560, lr_0 = 6.5132e-04
Loss = 1.0198e-01, PNorm = 34.7114, GNorm = 6.4686, lr_0 = 6.4960e-04
Validation rmse = 0.133825
Epoch 12
Loss = 1.3251e-01, PNorm = 34.7338, GNorm = 1.3638, lr_0 = 6.3263e-04
Validation rmse = 0.114522
Epoch 13
Loss = 1.0802e-01, PNorm = 34.7552, GNorm = 3.7313, lr_0 = 6.1448e-04
Loss = 9.2315e-02, PNorm = 34.7787, GNorm = 4.9071, lr_0 = 5.9843e-04
Loss = 3.7960e-02, PNorm = 34.7800, GNorm = 3.9856, lr_0 = 5.9685e-04
Validation rmse = 0.116378
Epoch 14
Loss = 1.0313e-01, PNorm = 34.7974, GNorm = 4.4361, lr_0 = 5.8126e-04
Validation rmse = 0.118026
Epoch 15
Loss = 9.5760e-02, PNorm = 34.8164, GNorm = 4.3176, lr_0 = 5.6458e-04
Loss = 9.6502e-02, PNorm = 34.8324, GNorm = 1.4272, lr_0 = 5.4983e-04
Loss = 1.0071e-01, PNorm = 34.8336, GNorm = 4.7940, lr_0 = 5.4838e-04
Validation rmse = 0.131475
Epoch 16
Loss = 1.0658e-01, PNorm = 34.8542, GNorm = 1.8801, lr_0 = 5.3406e-04
Validation rmse = 0.125415
Epoch 17
Loss = 9.9323e-02, PNorm = 34.8742, GNorm = 5.1978, lr_0 = 5.1873e-04
Loss = 1.0294e-01, PNorm = 34.8878, GNorm = 1.4980, lr_0 = 5.0518e-04
Loss = 3.3463e-03, PNorm = 34.8887, GNorm = 0.6750, lr_0 = 5.0385e-04
Validation rmse = 0.122856
Epoch 18
Loss = 9.0744e-02, PNorm = 34.9019, GNorm = 4.4643, lr_0 = 4.9069e-04
Validation rmse = 0.114988
Epoch 19
Loss = 1.1372e-01, PNorm = 34.9244, GNorm = 4.6927, lr_0 = 4.7661e-04
Loss = 8.9107e-02, PNorm = 34.9362, GNorm = 5.4229, lr_0 = 4.6416e-04
Loss = 1.1828e-01, PNorm = 34.9375, GNorm = 4.2786, lr_0 = 4.6293e-04
Validation rmse = 0.123732
Epoch 20
Loss = 9.5782e-02, PNorm = 34.9527, GNorm = 2.0224, lr_0 = 4.5084e-04
Validation rmse = 0.110227
Epoch 21
Loss = 7.0290e-02, PNorm = 34.9650, GNorm = 1.7762, lr_0 = 4.3790e-04
Loss = 6.9960e-02, PNorm = 34.9789, GNorm = 1.1747, lr_0 = 4.2647e-04
Loss = 3.0003e-02, PNorm = 34.9797, GNorm = 2.1789, lr_0 = 4.2534e-04
Validation rmse = 0.102397
Epoch 22
Loss = 6.4904e-02, PNorm = 34.9883, GNorm = 1.8474, lr_0 = 4.1423e-04
Validation rmse = 0.106175
Epoch 23
Loss = 5.8286e-02, PNorm = 34.9998, GNorm = 2.1241, lr_0 = 4.0234e-04
Loss = 6.2703e-02, PNorm = 35.0079, GNorm = 2.5984, lr_0 = 3.9184e-04
Loss = 1.7280e-01, PNorm = 35.0093, GNorm = 9.4345, lr_0 = 3.9080e-04
Validation rmse = 0.102616
Epoch 24
Loss = 1.0133e-01, PNorm = 35.0199, GNorm = 1.1091, lr_0 = 3.8059e-04
Validation rmse = 0.092210
Epoch 25
Loss = 6.8461e-02, PNorm = 35.0307, GNorm = 4.3652, lr_0 = 3.7065e-04
Loss = 6.7454e-02, PNorm = 35.0383, GNorm = 1.3976, lr_0 = 3.6097e-04
Validation rmse = 0.095610
Epoch 26
Loss = 5.8875e-02, PNorm = 35.0503, GNorm = 1.3937, lr_0 = 3.5061e-04
Validation rmse = 0.118398
Epoch 27
Loss = 1.0665e-01, PNorm = 35.0593, GNorm = 2.0006, lr_0 = 3.4055e-04
Loss = 7.6844e-02, PNorm = 35.0682, GNorm = 2.6463, lr_0 = 3.3166e-04
Validation rmse = 0.089115
Epoch 28
Loss = 6.9198e-02, PNorm = 35.0777, GNorm = 2.0123, lr_0 = 3.2214e-04
Validation rmse = 0.087925
Epoch 29
Loss = 4.9910e-02, PNorm = 35.0864, GNorm = 1.4828, lr_0 = 3.1290e-04
Loss = 5.1510e-02, PNorm = 35.0937, GNorm = 2.1305, lr_0 = 3.0472e-04
Validation rmse = 0.090120
Epoch 30
Loss = 4.5777e-02, PNorm = 35.0995, GNorm = 0.7253, lr_0 = 2.9598e-04
Validation rmse = 0.087566
Epoch 31
Loss = 4.5843e-02, PNorm = 35.1042, GNorm = 1.3810, lr_0 = 2.8749e-04
Loss = 5.0824e-02, PNorm = 35.1092, GNorm = 0.5409, lr_0 = 2.7998e-04
Validation rmse = 0.085343
Epoch 32
Loss = 4.6625e-02, PNorm = 35.1144, GNorm = 2.5935, lr_0 = 2.7195e-04
Validation rmse = 0.102035
Epoch 33
Loss = 9.0676e-02, PNorm = 35.1193, GNorm = 2.8707, lr_0 = 2.6414e-04
Loss = 8.3526e-02, PNorm = 35.1278, GNorm = 2.2320, lr_0 = 2.5724e-04
Validation rmse = 0.095560
Epoch 34
Loss = 5.9583e-02, PNorm = 35.1333, GNorm = 1.6369, lr_0 = 2.4986e-04
Validation rmse = 0.086703
Epoch 35
Loss = 5.7959e-02, PNorm = 35.1389, GNorm = 2.6293, lr_0 = 2.4269e-04
Loss = 4.8516e-02, PNorm = 35.1449, GNorm = 1.4590, lr_0 = 2.3635e-04
Validation rmse = 0.088190
Epoch 36
Loss = 6.2241e-02, PNorm = 35.1506, GNorm = 5.0178, lr_0 = 2.2957e-04
Validation rmse = 0.086220
Epoch 37
Loss = 4.5644e-02, PNorm = 35.1554, GNorm = 1.1104, lr_0 = 2.2299e-04
Loss = 4.3738e-02, PNorm = 35.1599, GNorm = 0.6829, lr_0 = 2.1716e-04
Validation rmse = 0.085203
Epoch 38
Loss = 4.1807e-02, PNorm = 35.1658, GNorm = 0.6249, lr_0 = 2.1093e-04
Validation rmse = 0.085985
Epoch 39
Loss = 4.2653e-02, PNorm = 35.1705, GNorm = 0.9209, lr_0 = 2.0488e-04
Loss = 4.9794e-02, PNorm = 35.1740, GNorm = 0.8392, lr_0 = 1.9953e-04
Validation rmse = 0.094505
Epoch 40
Loss = 4.3375e-02, PNorm = 35.1773, GNorm = 0.7718, lr_0 = 1.9380e-04
Validation rmse = 0.083956
Epoch 41
Loss = 4.1169e-02, PNorm = 35.1807, GNorm = 0.9482, lr_0 = 1.8824e-04
Loss = 4.4007e-02, PNorm = 35.1847, GNorm = 1.0431, lr_0 = 1.8332e-04
Validation rmse = 0.082570
Epoch 42
Loss = 4.0062e-02, PNorm = 35.1891, GNorm = 1.7374, lr_0 = 1.7806e-04
Validation rmse = 0.083607
Epoch 43
Loss = 3.6698e-02, PNorm = 35.1934, GNorm = 1.2403, lr_0 = 1.7295e-04
Loss = 4.3364e-02, PNorm = 35.1967, GNorm = 0.2861, lr_0 = 1.6844e-04
Validation rmse = 0.084554
Epoch 44
Loss = 4.5079e-02, PNorm = 35.2004, GNorm = 0.8022, lr_0 = 1.6360e-04
Validation rmse = 0.089579
Epoch 45
Loss = 4.1798e-02, PNorm = 35.2044, GNorm = 1.1240, lr_0 = 1.5891e-04
Loss = 4.1845e-02, PNorm = 35.2074, GNorm = 1.5252, lr_0 = 1.5476e-04
Validation rmse = 0.082619
Epoch 46
Loss = 4.1742e-02, PNorm = 35.2102, GNorm = 1.1715, lr_0 = 1.5032e-04
Validation rmse = 0.082588
Epoch 47
Loss = 3.9334e-02, PNorm = 35.2133, GNorm = 0.4754, lr_0 = 1.4601e-04
Loss = 4.1525e-02, PNorm = 35.2169, GNorm = 1.2356, lr_0 = 1.4219e-04
Validation rmse = 0.083298
Epoch 48
Loss = 4.5237e-02, PNorm = 35.2194, GNorm = 1.5617, lr_0 = 1.3811e-04
Validation rmse = 0.085727
Epoch 49
Loss = 4.2592e-02, PNorm = 35.2227, GNorm = 1.3815, lr_0 = 1.3415e-04
Loss = 3.9128e-02, PNorm = 35.2254, GNorm = 0.4916, lr_0 = 1.3064e-04
Validation rmse = 0.082361
Epoch 50
Loss = 4.1841e-02, PNorm = 35.2283, GNorm = 0.6413, lr_0 = 1.2723e-04
Validation rmse = 0.083654
Epoch 51
Loss = 3.5890e-02, PNorm = 35.2318, GNorm = 1.1485, lr_0 = 1.2358e-04
Loss = 4.5683e-02, PNorm = 35.2332, GNorm = 0.6712, lr_0 = 1.2035e-04
Validation rmse = 0.082902
Epoch 52
Loss = 3.9031e-02, PNorm = 35.2361, GNorm = 0.9083, lr_0 = 1.1690e-04
Validation rmse = 0.081118
Epoch 53
Loss = 3.9629e-02, PNorm = 35.2393, GNorm = 0.3568, lr_0 = 1.1355e-04
Loss = 3.6749e-02, PNorm = 35.2414, GNorm = 0.7348, lr_0 = 1.1058e-04
Validation rmse = 0.081503
Epoch 54
Loss = 3.9229e-02, PNorm = 35.2439, GNorm = 0.5350, lr_0 = 1.0741e-04
Validation rmse = 0.084867
Epoch 55
Loss = 3.8780e-02, PNorm = 35.2463, GNorm = 2.7065, lr_0 = 1.0433e-04
Loss = 3.7512e-02, PNorm = 35.2480, GNorm = 0.5576, lr_0 = 1.0160e-04
Validation rmse = 0.081596
Epoch 56
Loss = 3.6291e-02, PNorm = 35.2509, GNorm = 0.5721, lr_0 = 1.0000e-04
Validation rmse = 0.084314
Epoch 57
Loss = 4.3407e-02, PNorm = 35.2531, GNorm = 2.0701, lr_0 = 1.0000e-04
Loss = 3.9433e-02, PNorm = 35.2558, GNorm = 0.7053, lr_0 = 1.0000e-04
Validation rmse = 0.083791
Epoch 58
Loss = 3.9936e-02, PNorm = 35.2582, GNorm = 1.3244, lr_0 = 1.0000e-04
Validation rmse = 0.082028
Epoch 59
Loss = 4.0440e-02, PNorm = 35.2601, GNorm = 0.5832, lr_0 = 1.0000e-04
Loss = 3.4195e-02, PNorm = 35.2622, GNorm = 0.5999, lr_0 = 1.0000e-04
Validation rmse = 0.082155
Model 0 best validation rmse = 0.081118 on epoch 52
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.033684
Ensemble test rmse = 0.033684
1-fold cross validation
	Seed 0 ==> test rmse = 0.033684
Overall test rmse = 0.033684 +/- 0.000000
Elapsed time = 0:00:37
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 937 | train size = 744 | val size = 188 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.0780e-01, PNorm = 34.0180, GNorm = 1.6743, lr_0 = 4.5357e-04
Validation rmse = 0.284592
Epoch 1
Loss = 7.1940e-01, PNorm = 34.0528, GNorm = 9.2688, lr_0 = 8.0714e-04
Validation rmse = 0.242305
Epoch 2
Loss = 3.5509e-01, PNorm = 34.1039, GNorm = 3.7569, lr_0 = 9.8872e-04
Loss = 4.5803e-01, PNorm = 34.1730, GNorm = 11.7165, lr_0 = 9.6108e-04
Validation rmse = 0.211638
Epoch 3
Loss = 3.8361e-01, PNorm = 34.2340, GNorm = 6.9497, lr_0 = 9.3421e-04
Validation rmse = 0.178582
Epoch 4
Loss = 2.4501e-01, PNorm = 34.2962, GNorm = 1.5841, lr_0 = 9.0809e-04
Loss = 2.3921e-01, PNorm = 34.3579, GNorm = 3.2622, lr_0 = 8.8270e-04
Validation rmse = 0.155141
Epoch 5
Loss = 2.0167e-01, PNorm = 34.4068, GNorm = 3.1445, lr_0 = 8.5802e-04
Validation rmse = 0.160343
Epoch 6
Loss = 2.3505e-01, PNorm = 34.4492, GNorm = 1.4065, lr_0 = 8.3403e-04
Loss = 1.7769e-01, PNorm = 34.4897, GNorm = 2.4875, lr_0 = 8.1071e-04
Validation rmse = 0.152995
Epoch 7
Loss = 1.3956e-01, PNorm = 34.5307, GNorm = 0.6591, lr_0 = 7.8805e-04
Validation rmse = 0.144768
Epoch 8
Loss = 1.6681e-01, PNorm = 34.5689, GNorm = 6.2789, lr_0 = 7.6601e-04
Loss = 1.2468e-01, PNorm = 34.6007, GNorm = 5.1833, lr_0 = 7.4460e-04
Validation rmse = 0.134239
Epoch 9
Loss = 1.3077e-01, PNorm = 34.6357, GNorm = 1.0790, lr_0 = 7.2173e-04
Validation rmse = 0.108520
Epoch 10
Loss = 9.3961e-02, PNorm = 34.6655, GNorm = 5.6189, lr_0 = 7.0155e-04
Loss = 1.1028e-01, PNorm = 34.6982, GNorm = 2.1300, lr_0 = 6.8194e-04
Validation rmse = 0.109885
Epoch 11
Loss = 8.8431e-02, PNorm = 34.7249, GNorm = 2.4867, lr_0 = 6.6287e-04
Validation rmse = 0.107609
Epoch 12
Loss = 6.8400e-02, PNorm = 34.7514, GNorm = 1.8079, lr_0 = 6.4434e-04
Loss = 9.7825e-02, PNorm = 34.7748, GNorm = 4.6587, lr_0 = 6.2632e-04
Validation rmse = 0.096765
Epoch 13
Loss = 9.2061e-02, PNorm = 34.7975, GNorm = 5.1670, lr_0 = 6.0881e-04
Validation rmse = 0.098760
Epoch 14
Loss = 8.5814e-02, PNorm = 34.8156, GNorm = 4.0599, lr_0 = 5.9179e-04
Loss = 8.0420e-02, PNorm = 34.8369, GNorm = 2.4026, lr_0 = 5.7524e-04
Validation rmse = 0.099903
Epoch 15
Loss = 7.3709e-02, PNorm = 34.8544, GNorm = 4.7260, lr_0 = 5.5916e-04
Validation rmse = 0.089886
Epoch 16
Loss = 4.7973e-02, PNorm = 34.8732, GNorm = 2.4002, lr_0 = 5.4353e-04
Loss = 7.0553e-02, PNorm = 34.8863, GNorm = 2.1074, lr_0 = 5.2833e-04
Validation rmse = 0.093755
Epoch 17
Loss = 6.2665e-02, PNorm = 34.9087, GNorm = 1.2189, lr_0 = 5.1211e-04
Validation rmse = 0.091525
Epoch 18
Loss = 6.3548e-02, PNorm = 34.9225, GNorm = 1.1916, lr_0 = 4.9779e-04
Loss = 6.0903e-02, PNorm = 34.9390, GNorm = 1.2581, lr_0 = 4.8387e-04
Validation rmse = 0.089146
Epoch 19
Loss = 5.6652e-02, PNorm = 34.9555, GNorm = 0.4171, lr_0 = 4.7034e-04
Validation rmse = 0.084586
Epoch 20
Loss = 5.0076e-02, PNorm = 34.9698, GNorm = 0.7388, lr_0 = 4.5719e-04
Loss = 5.3047e-02, PNorm = 34.9847, GNorm = 0.8467, lr_0 = 4.4441e-04
Validation rmse = 0.082617
Epoch 21
Loss = 4.9922e-02, PNorm = 34.9978, GNorm = 2.8918, lr_0 = 4.3198e-04
Validation rmse = 0.083587
Epoch 22
Loss = 4.2287e-02, PNorm = 35.0101, GNorm = 0.4455, lr_0 = 4.1991e-04
Loss = 4.9417e-02, PNorm = 35.0204, GNorm = 0.5531, lr_0 = 4.0817e-04
Validation rmse = 0.082615
Epoch 23
Loss = 5.4747e-02, PNorm = 35.0335, GNorm = 1.7426, lr_0 = 3.9675e-04
Validation rmse = 0.082463
Epoch 24
Loss = 5.1179e-02, PNorm = 35.0453, GNorm = 3.4753, lr_0 = 3.8566e-04
Loss = 4.9932e-02, PNorm = 35.0567, GNorm = 0.7829, lr_0 = 3.7488e-04
Validation rmse = 0.081743
Epoch 25
Loss = 4.1981e-02, PNorm = 35.0675, GNorm = 0.6458, lr_0 = 3.6440e-04
Validation rmse = 0.080638
Epoch 26
Loss = 4.6734e-02, PNorm = 35.0793, GNorm = 1.2145, lr_0 = 3.5321e-04
Loss = 4.7210e-02, PNorm = 35.0913, GNorm = 2.3700, lr_0 = 3.4333e-04
Validation rmse = 0.082050
Epoch 27
Loss = 4.5997e-02, PNorm = 35.1005, GNorm = 0.8194, lr_0 = 3.3373e-04
Validation rmse = 0.085674
Epoch 28
Loss = 5.9445e-02, PNorm = 35.1109, GNorm = 0.7918, lr_0 = 3.2440e-04
Loss = 5.1114e-02, PNorm = 35.1202, GNorm = 0.3088, lr_0 = 3.1533e-04
Validation rmse = 0.081841
Epoch 29
Loss = 4.1993e-02, PNorm = 35.1291, GNorm = 0.4013, lr_0 = 3.0652e-04
Validation rmse = 0.082855
Epoch 30
Loss = 4.4159e-02, PNorm = 35.1377, GNorm = 0.5357, lr_0 = 2.9795e-04
Loss = 4.1843e-02, PNorm = 35.1458, GNorm = 1.5760, lr_0 = 2.8962e-04
Validation rmse = 0.079358
Epoch 31
Loss = 4.1247e-02, PNorm = 35.1549, GNorm = 0.6493, lr_0 = 2.8152e-04
Validation rmse = 0.082903
Epoch 32
Loss = 4.2666e-02, PNorm = 35.1630, GNorm = 0.6412, lr_0 = 2.7365e-04
Loss = 3.7058e-02, PNorm = 35.1703, GNorm = 0.8535, lr_0 = 2.6600e-04
Validation rmse = 0.079481
Epoch 33
Loss = 4.0741e-02, PNorm = 35.1758, GNorm = 1.6224, lr_0 = 2.5856e-04
Validation rmse = 0.088405
Epoch 34
Loss = 4.2730e-02, PNorm = 35.1830, GNorm = 1.4891, lr_0 = 2.5062e-04
Loss = 4.1857e-02, PNorm = 35.1905, GNorm = 1.7144, lr_0 = 2.4361e-04
Validation rmse = 0.078045
Epoch 35
Loss = 3.9385e-02, PNorm = 35.1980, GNorm = 0.8457, lr_0 = 2.3680e-04
Validation rmse = 0.079188
Epoch 36
Loss = 3.5059e-02, PNorm = 35.2038, GNorm = 0.7171, lr_0 = 2.3018e-04
Loss = 3.8352e-02, PNorm = 35.2109, GNorm = 1.4678, lr_0 = 2.2375e-04
Validation rmse = 0.079117
Epoch 37
Loss = 3.7766e-02, PNorm = 35.2179, GNorm = 0.4723, lr_0 = 2.1749e-04
Validation rmse = 0.078897
Epoch 38
Loss = 3.4939e-02, PNorm = 35.2238, GNorm = 0.9326, lr_0 = 2.1141e-04
Loss = 3.5816e-02, PNorm = 35.2288, GNorm = 1.9537, lr_0 = 2.0550e-04
Validation rmse = 0.080022
Epoch 39
Loss = 3.6019e-02, PNorm = 35.2343, GNorm = 2.5476, lr_0 = 1.9975e-04
Validation rmse = 0.077726
Epoch 40
Loss = 3.7689e-02, PNorm = 35.2398, GNorm = 0.8738, lr_0 = 1.9417e-04
Loss = 3.5194e-02, PNorm = 35.2450, GNorm = 0.7772, lr_0 = 1.8874e-04
Validation rmse = 0.079941
Epoch 41
Loss = 3.4592e-02, PNorm = 35.2500, GNorm = 0.6857, lr_0 = 1.8346e-04
Validation rmse = 0.079509
Epoch 42
Loss = 3.3614e-02, PNorm = 35.2550, GNorm = 1.5473, lr_0 = 1.7783e-04
Validation rmse = 0.077796
Epoch 43
Loss = 3.3362e-02, PNorm = 35.2602, GNorm = 0.5119, lr_0 = 1.7286e-04
Loss = 3.5404e-02, PNorm = 35.2644, GNorm = 1.6827, lr_0 = 1.6802e-04
Validation rmse = 0.081305
Epoch 44
Loss = 3.7750e-02, PNorm = 35.2694, GNorm = 0.4990, lr_0 = 1.6333e-04
Validation rmse = 0.077536
Epoch 45
Loss = 3.7230e-02, PNorm = 35.2737, GNorm = 0.3358, lr_0 = 1.5876e-04
Loss = 3.0249e-02, PNorm = 35.2779, GNorm = 1.2752, lr_0 = 1.5432e-04
Validation rmse = 0.078017
Epoch 46
Loss = 3.3633e-02, PNorm = 35.2821, GNorm = 0.6306, lr_0 = 1.5001e-04
Validation rmse = 0.077714
Epoch 47
Loss = 3.8836e-02, PNorm = 35.2856, GNorm = 1.0900, lr_0 = 1.4581e-04
Loss = 3.2819e-02, PNorm = 35.2893, GNorm = 1.8499, lr_0 = 1.4174e-04
Validation rmse = 0.077075
Epoch 48
Loss = 3.3511e-02, PNorm = 35.2933, GNorm = 0.7541, lr_0 = 1.3777e-04
Validation rmse = 0.077133
Epoch 49
Loss = 2.9731e-02, PNorm = 35.2967, GNorm = 0.3357, lr_0 = 1.3392e-04
Loss = 3.1786e-02, PNorm = 35.3004, GNorm = 0.9468, lr_0 = 1.3018e-04
Validation rmse = 0.078023
Epoch 50
Loss = 3.1827e-02, PNorm = 35.3044, GNorm = 2.4720, lr_0 = 1.2654e-04
Validation rmse = 0.082199
Epoch 51
Loss = 3.4442e-02, PNorm = 35.3074, GNorm = 1.7528, lr_0 = 1.2265e-04
Loss = 3.2303e-02, PNorm = 35.3114, GNorm = 0.6641, lr_0 = 1.1922e-04
Validation rmse = 0.076973
Epoch 52
Loss = 3.0437e-02, PNorm = 35.3142, GNorm = 0.8032, lr_0 = 1.1589e-04
Validation rmse = 0.078459
Epoch 53
Loss = 2.9386e-02, PNorm = 35.3176, GNorm = 0.5111, lr_0 = 1.1265e-04
Loss = 3.1888e-02, PNorm = 35.3208, GNorm = 0.4577, lr_0 = 1.0950e-04
Validation rmse = 0.077532
Epoch 54
Loss = 3.2189e-02, PNorm = 35.3236, GNorm = 0.4548, lr_0 = 1.0644e-04
Validation rmse = 0.078816
Epoch 55
Loss = 3.1063e-02, PNorm = 35.3266, GNorm = 0.7833, lr_0 = 1.0346e-04
Loss = 3.0904e-02, PNorm = 35.3292, GNorm = 0.8459, lr_0 = 1.0057e-04
Validation rmse = 0.077707
Epoch 56
Loss = 3.2955e-02, PNorm = 35.3320, GNorm = 0.3359, lr_0 = 1.0000e-04
Validation rmse = 0.080015
Epoch 57
Loss = 3.7463e-02, PNorm = 35.3346, GNorm = 1.3679, lr_0 = 1.0000e-04
Loss = 3.2839e-02, PNorm = 35.3370, GNorm = 1.4295, lr_0 = 1.0000e-04
Validation rmse = 0.078900
Epoch 58
Loss = 3.2746e-02, PNorm = 35.3395, GNorm = 0.8228, lr_0 = 1.0000e-04
Validation rmse = 0.078462
Epoch 59
Loss = 2.8428e-02, PNorm = 35.3429, GNorm = 1.3676, lr_0 = 1.0000e-04
Loss = 3.0890e-02, PNorm = 35.3453, GNorm = 0.4658, lr_0 = 1.0000e-04
Validation rmse = 0.076976
Model 0 best validation rmse = 0.076973 on epoch 51
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.023124
Ensemble test rmse = 0.023124
1-fold cross validation
	Seed 0 ==> test rmse = 0.023124
Overall test rmse = 0.023124 +/- 0.000000
Elapsed time = 0:00:35
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 927 | train size = 736 | val size = 186 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1636e-01, PNorm = 34.0184, GNorm = 4.0435, lr_0 = 4.5357e-04
Validation rmse = 0.275667
Epoch 1
Loss = 6.8793e-01, PNorm = 34.0531, GNorm = 10.5918, lr_0 = 8.0714e-04
Validation rmse = 0.216270
Epoch 2
Loss = 4.0544e-01, PNorm = 34.1162, GNorm = 5.1048, lr_0 = 9.8872e-04
Loss = 3.7810e-01, PNorm = 34.1903, GNorm = 5.7073, lr_0 = 9.6108e-04
Validation rmse = 0.163533
Epoch 3
Loss = 2.9861e-01, PNorm = 34.2690, GNorm = 6.7820, lr_0 = 9.3421e-04
Validation rmse = 0.146028
Epoch 4
Loss = 2.1634e-01, PNorm = 34.3357, GNorm = 4.7202, lr_0 = 9.0552e-04
Loss = 2.2704e-01, PNorm = 34.3918, GNorm = 0.8892, lr_0 = 8.8020e-04
Validation rmse = 0.134688
Epoch 5
Loss = 1.8889e-01, PNorm = 34.4366, GNorm = 3.2234, lr_0 = 8.5559e-04
Validation rmse = 0.127856
Epoch 6
Loss = 1.3621e-01, PNorm = 34.4872, GNorm = 3.5825, lr_0 = 8.3167e-04
Loss = 2.0682e-01, PNorm = 34.5255, GNorm = 9.3365, lr_0 = 8.0842e-04
Validation rmse = 0.126305
Epoch 7
Loss = 1.4602e-01, PNorm = 34.5625, GNorm = 5.6630, lr_0 = 7.8581e-04
Validation rmse = 0.129810
Epoch 8
Loss = 1.4425e-01, PNorm = 34.6034, GNorm = 2.0331, lr_0 = 7.6168e-04
Loss = 1.3196e-01, PNorm = 34.6412, GNorm = 3.3860, lr_0 = 7.4039e-04
Validation rmse = 0.124649
Epoch 9
Loss = 1.1839e-01, PNorm = 34.6696, GNorm = 5.0339, lr_0 = 7.1969e-04
Validation rmse = 0.096332
Epoch 10
Loss = 1.0637e-01, PNorm = 34.7013, GNorm = 1.7385, lr_0 = 6.9956e-04
Loss = 7.7815e-02, PNorm = 34.7281, GNorm = 0.9993, lr_0 = 6.8001e-04
Validation rmse = 0.091993
Epoch 11
Loss = 7.6029e-02, PNorm = 34.7562, GNorm = 0.4343, lr_0 = 6.5912e-04
Validation rmse = 0.088715
Epoch 12
Loss = 6.3950e-02, PNorm = 34.7792, GNorm = 1.3478, lr_0 = 6.4069e-04
Loss = 7.2907e-02, PNorm = 34.7985, GNorm = 3.8620, lr_0 = 6.2278e-04
Validation rmse = 0.087854
Epoch 13
Loss = 6.2883e-02, PNorm = 34.8190, GNorm = 0.7568, lr_0 = 6.0537e-04
Validation rmse = 0.086175
Epoch 14
Loss = 5.3017e-02, PNorm = 34.8367, GNorm = 1.2880, lr_0 = 5.8844e-04
Loss = 6.9123e-02, PNorm = 34.8544, GNorm = 2.2099, lr_0 = 5.7199e-04
Loss = 9.3228e-02, PNorm = 34.8556, GNorm = 3.9289, lr_0 = 5.7037e-04
Validation rmse = 0.086567
Epoch 15
Loss = 6.3030e-02, PNorm = 34.8719, GNorm = 1.8243, lr_0 = 5.5442e-04
Validation rmse = 0.093876
Epoch 16
Loss = 6.4365e-02, PNorm = 34.8886, GNorm = 1.6942, lr_0 = 5.3892e-04
Loss = 5.8186e-02, PNorm = 34.9030, GNorm = 1.8300, lr_0 = 5.2386e-04
Validation rmse = 0.084534
Epoch 17
Loss = 5.3130e-02, PNorm = 34.9184, GNorm = 1.3316, lr_0 = 5.0921e-04
Validation rmse = 0.089644
Epoch 18
Loss = 6.2938e-02, PNorm = 34.9329, GNorm = 0.8499, lr_0 = 4.9357e-04
Validation rmse = 0.092424
Epoch 19
Loss = 6.2788e-02, PNorm = 34.9450, GNorm = 2.9315, lr_0 = 4.7977e-04
Loss = 5.4435e-02, PNorm = 34.9607, GNorm = 0.6911, lr_0 = 4.6636e-04
Validation rmse = 0.085907
Epoch 20
Loss = 4.2913e-02, PNorm = 34.9741, GNorm = 0.5079, lr_0 = 4.5332e-04
Validation rmse = 0.083639
Epoch 21
Loss = 5.3222e-02, PNorm = 34.9843, GNorm = 1.7526, lr_0 = 4.4064e-04
Loss = 5.5482e-02, PNorm = 34.9967, GNorm = 2.0767, lr_0 = 4.2832e-04
Validation rmse = 0.081008
Epoch 22
Loss = 4.2585e-02, PNorm = 35.0079, GNorm = 1.1124, lr_0 = 4.1517e-04
Validation rmse = 0.079029
Epoch 23
Loss = 4.5781e-02, PNorm = 35.0192, GNorm = 2.6953, lr_0 = 4.0356e-04
Loss = 5.2107e-02, PNorm = 35.0301, GNorm = 4.0775, lr_0 = 3.9228e-04
Validation rmse = 0.085508
Epoch 24
Loss = 5.3956e-02, PNorm = 35.0403, GNorm = 2.2533, lr_0 = 3.8131e-04
Validation rmse = 0.083918
Epoch 25
Loss = 3.5264e-02, PNorm = 35.0522, GNorm = 0.3866, lr_0 = 3.7065e-04
Loss = 4.6862e-02, PNorm = 35.0631, GNorm = 2.2330, lr_0 = 3.6029e-04
Validation rmse = 0.078335
Epoch 26
Loss = 3.9409e-02, PNorm = 35.0742, GNorm = 2.1162, lr_0 = 3.4922e-04
Validation rmse = 0.079099
Epoch 27
Loss = 4.7366e-02, PNorm = 35.0840, GNorm = 0.9119, lr_0 = 3.3946e-04
Loss = 4.1461e-02, PNorm = 35.0919, GNorm = 2.3463, lr_0 = 3.2997e-04
Validation rmse = 0.079781
Epoch 28
Loss = 4.5315e-02, PNorm = 35.0998, GNorm = 1.0957, lr_0 = 3.2074e-04
Validation rmse = 0.079819
Epoch 29
Loss = 3.6938e-02, PNorm = 35.1085, GNorm = 0.5499, lr_0 = 3.1089e-04
Loss = 3.9181e-02, PNorm = 35.1169, GNorm = 0.3737, lr_0 = 3.0220e-04
Validation rmse = 0.077972
Epoch 30
Loss = 4.0900e-02, PNorm = 35.1245, GNorm = 0.4366, lr_0 = 2.9375e-04
Validation rmse = 0.077125
Epoch 31
Loss = 3.8324e-02, PNorm = 35.1318, GNorm = 0.3181, lr_0 = 2.8554e-04
Loss = 3.4903e-02, PNorm = 35.1397, GNorm = 0.8657, lr_0 = 2.7756e-04
Validation rmse = 0.076850
Epoch 32
Loss = 3.4438e-02, PNorm = 35.1457, GNorm = 0.8553, lr_0 = 2.6980e-04
Validation rmse = 0.077418
Epoch 33
Loss = 3.0856e-02, PNorm = 35.1538, GNorm = 0.4528, lr_0 = 2.6151e-04
Loss = 4.0674e-02, PNorm = 35.1608, GNorm = 0.7454, lr_0 = 2.5420e-04
Validation rmse = 0.076085
Epoch 34
Loss = 3.5730e-02, PNorm = 35.1679, GNorm = 0.9950, lr_0 = 2.4709e-04
Validation rmse = 0.075741
Epoch 35
Loss = 4.0766e-02, PNorm = 35.1743, GNorm = 1.8430, lr_0 = 2.4018e-04
Validation rmse = 0.078066
Epoch 36
Loss = 4.3439e-02, PNorm = 35.1812, GNorm = 1.5617, lr_0 = 2.3281e-04
Loss = 3.8466e-02, PNorm = 35.1881, GNorm = 1.1137, lr_0 = 2.2630e-04
Validation rmse = 0.076116
Epoch 37
Loss = 3.4696e-02, PNorm = 35.1949, GNorm = 1.1999, lr_0 = 2.1997e-04
Validation rmse = 0.080015
Epoch 38
Loss = 4.6161e-02, PNorm = 35.2010, GNorm = 1.6654, lr_0 = 2.1382e-04
Loss = 3.3561e-02, PNorm = 35.2066, GNorm = 1.1541, lr_0 = 2.0784e-04
Validation rmse = 0.078114
Epoch 39
Loss = 3.5717e-02, PNorm = 35.2126, GNorm = 0.6205, lr_0 = 2.0203e-04
Validation rmse = 0.077391
Epoch 40
Loss = 2.9221e-02, PNorm = 35.2184, GNorm = 0.4815, lr_0 = 1.9583e-04
Loss = 3.2855e-02, PNorm = 35.2244, GNorm = 0.4145, lr_0 = 1.9035e-04
Validation rmse = 0.075367
Epoch 41
Loss = 3.4463e-02, PNorm = 35.2284, GNorm = 1.9942, lr_0 = 1.8503e-04
Validation rmse = 0.076946
Epoch 42
Loss = 3.5422e-02, PNorm = 35.2341, GNorm = 1.3049, lr_0 = 1.7986e-04
Loss = 3.7921e-02, PNorm = 35.2385, GNorm = 0.6170, lr_0 = 1.7483e-04
Validation rmse = 0.078249
Epoch 43
Loss = 3.1584e-02, PNorm = 35.2441, GNorm = 0.5172, lr_0 = 1.6946e-04
Validation rmse = 0.075238
Epoch 44
Loss = 3.2333e-02, PNorm = 35.2485, GNorm = 0.5664, lr_0 = 1.6472e-04
Loss = 3.2091e-02, PNorm = 35.2521, GNorm = 1.2858, lr_0 = 1.6012e-04
Validation rmse = 0.074575
Epoch 45
Loss = 3.1474e-02, PNorm = 35.2573, GNorm = 0.5540, lr_0 = 1.5564e-04
Validation rmse = 0.076367
Epoch 46
Loss = 2.6431e-02, PNorm = 35.2610, GNorm = 0.4803, lr_0 = 1.5129e-04
Loss = 3.3626e-02, PNorm = 35.2651, GNorm = 1.4708, lr_0 = 1.4706e-04
Validation rmse = 0.075836
Epoch 47
Loss = 3.0438e-02, PNorm = 35.2687, GNorm = 1.7014, lr_0 = 1.4254e-04
Validation rmse = 0.075327
Epoch 48
Loss = 3.2190e-02, PNorm = 35.2725, GNorm = 0.3650, lr_0 = 1.3856e-04
Loss = 3.1994e-02, PNorm = 35.2765, GNorm = 0.8556, lr_0 = 1.3468e-04
Validation rmse = 0.078582
Epoch 49
Loss = 3.3968e-02, PNorm = 35.2799, GNorm = 1.2832, lr_0 = 1.3092e-04
Validation rmse = 0.075198
Epoch 50
Loss = 3.3680e-02, PNorm = 35.2827, GNorm = 1.4700, lr_0 = 1.2726e-04
Loss = 3.2338e-02, PNorm = 35.2860, GNorm = 0.5137, lr_0 = 1.2370e-04
Loss = 3.1646e-02, PNorm = 35.2862, GNorm = 1.0531, lr_0 = 1.2335e-04
Validation rmse = 0.075266
Epoch 51
Loss = 3.1410e-02, PNorm = 35.2894, GNorm = 0.4165, lr_0 = 1.1990e-04
Validation rmse = 0.075906
Epoch 52
Loss = 3.0763e-02, PNorm = 35.2923, GNorm = 0.6307, lr_0 = 1.1655e-04
Loss = 3.2060e-02, PNorm = 35.2951, GNorm = 0.6672, lr_0 = 1.1329e-04
Validation rmse = 0.075564
Epoch 53
Loss = 3.1012e-02, PNorm = 35.2991, GNorm = 0.5330, lr_0 = 1.1012e-04
Validation rmse = 0.075375
Epoch 54
Loss = 2.9495e-02, PNorm = 35.3017, GNorm = 0.6091, lr_0 = 1.0674e-04
Validation rmse = 0.074782
Epoch 55
Loss = 2.9020e-02, PNorm = 35.3039, GNorm = 0.2980, lr_0 = 1.0376e-04
Loss = 2.9209e-02, PNorm = 35.3068, GNorm = 1.1966, lr_0 = 1.0085e-04
Validation rmse = 0.074503
Epoch 56
Loss = 2.8826e-02, PNorm = 35.3096, GNorm = 0.9633, lr_0 = 1.0000e-04
Validation rmse = 0.075835
Epoch 57
Loss = 2.7669e-02, PNorm = 35.3122, GNorm = 0.3557, lr_0 = 1.0000e-04
Loss = 2.9063e-02, PNorm = 35.3151, GNorm = 0.6955, lr_0 = 1.0000e-04
Validation rmse = 0.074719
Epoch 58
Loss = 2.8655e-02, PNorm = 35.3175, GNorm = 0.7303, lr_0 = 1.0000e-04
Validation rmse = 0.075445
Epoch 59
Loss = 2.6494e-02, PNorm = 35.3199, GNorm = 0.3599, lr_0 = 1.0000e-04
Loss = 3.0791e-02, PNorm = 35.3224, GNorm = 0.7360, lr_0 = 1.0000e-04
Validation rmse = 0.075509
Model 0 best validation rmse = 0.074503 on epoch 55
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.041901
Ensemble test rmse = 0.041901
1-fold cross validation
	Seed 0 ==> test rmse = 0.041901
Overall test rmse = 0.041901 +/- 0.000000
Elapsed time = 0:00:36
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 917 | train size = 729 | val size = 183 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1603e-01, PNorm = 34.0199, GNorm = 0.8802, lr_0 = 4.5357e-04
Validation rmse = 0.261971
Epoch 1
Loss = 5.8489e-01, PNorm = 34.0610, GNorm = 11.5430, lr_0 = 8.0714e-04
Validation rmse = 0.220922
Epoch 2
Loss = 3.0188e-01, PNorm = 34.1239, GNorm = 7.2488, lr_0 = 9.8872e-04
Loss = 4.5396e-01, PNorm = 34.1878, GNorm = 1.7290, lr_0 = 9.6108e-04
Validation rmse = 0.200249
Epoch 3
Loss = 3.3894e-01, PNorm = 34.2602, GNorm = 4.6843, lr_0 = 9.3156e-04
Validation rmse = 0.181389
Epoch 4
Loss = 2.4091e-01, PNorm = 34.3137, GNorm = 1.5251, lr_0 = 9.0552e-04
Loss = 2.8487e-01, PNorm = 34.3655, GNorm = 7.7435, lr_0 = 8.8020e-04
Validation rmse = 0.153997
Epoch 5
Loss = 2.0883e-01, PNorm = 34.4145, GNorm = 6.1857, lr_0 = 8.5317e-04
Validation rmse = 0.135807
Epoch 6
Loss = 2.3868e-01, PNorm = 34.4656, GNorm = 8.8022, lr_0 = 8.2931e-04
Loss = 1.9627e-01, PNorm = 34.5160, GNorm = 3.7684, lr_0 = 8.0613e-04
Validation rmse = 0.126885
Epoch 7
Loss = 1.2999e-01, PNorm = 34.5541, GNorm = 1.0535, lr_0 = 7.8359e-04
Validation rmse = 0.113650
Epoch 8
Loss = 1.0341e-01, PNorm = 34.5921, GNorm = 1.2793, lr_0 = 7.5952e-04
Loss = 1.2262e-01, PNorm = 34.6295, GNorm = 1.0169, lr_0 = 7.3829e-04
Validation rmse = 0.103024
Epoch 9
Loss = 1.0297e-01, PNorm = 34.6665, GNorm = 3.1457, lr_0 = 7.1765e-04
Validation rmse = 0.107974
Epoch 10
Loss = 9.0037e-02, PNorm = 34.7029, GNorm = 1.8771, lr_0 = 6.9561e-04
Loss = 8.7271e-02, PNorm = 34.7313, GNorm = 2.6154, lr_0 = 6.7616e-04
Validation rmse = 0.098935
Epoch 11
Loss = 7.8387e-02, PNorm = 34.7607, GNorm = 1.4406, lr_0 = 6.5726e-04
Validation rmse = 0.088030
Epoch 12
Loss = 6.4951e-02, PNorm = 34.7869, GNorm = 2.6460, lr_0 = 6.3707e-04
Validation rmse = 0.087356
Epoch 13
Loss = 3.5568e-02, PNorm = 34.8086, GNorm = 0.9727, lr_0 = 6.1926e-04
Loss = 7.1168e-02, PNorm = 34.8342, GNorm = 3.3398, lr_0 = 6.0194e-04
Validation rmse = 0.086006
Epoch 14
Loss = 5.8296e-02, PNorm = 34.8521, GNorm = 0.7826, lr_0 = 5.8512e-04
Validation rmse = 0.085140
Epoch 15
Loss = 5.6624e-02, PNorm = 34.8720, GNorm = 1.9419, lr_0 = 5.6715e-04
Loss = 6.5535e-02, PNorm = 34.8905, GNorm = 2.8638, lr_0 = 5.5129e-04
Validation rmse = 0.088513
Epoch 16
Loss = 6.7024e-02, PNorm = 34.9067, GNorm = 0.5748, lr_0 = 5.3588e-04
Validation rmse = 0.090494
Epoch 17
Loss = 6.0729e-02, PNorm = 34.9237, GNorm = 1.2215, lr_0 = 5.1942e-04
Loss = 5.1442e-02, PNorm = 34.9371, GNorm = 1.0135, lr_0 = 5.0490e-04
Validation rmse = 0.079787
Epoch 18
Loss = 4.7490e-02, PNorm = 34.9526, GNorm = 2.3749, lr_0 = 4.9078e-04
Validation rmse = 0.084090
Epoch 19
Loss = 4.5548e-02, PNorm = 34.9661, GNorm = 0.7028, lr_0 = 4.7706e-04
Loss = 5.0618e-02, PNorm = 34.9791, GNorm = 2.2957, lr_0 = 4.6372e-04
Validation rmse = 0.083760
Epoch 20
Loss = 4.9520e-02, PNorm = 34.9951, GNorm = 2.2433, lr_0 = 4.4948e-04
Validation rmse = 0.079851
Epoch 21
Loss = 4.1452e-02, PNorm = 35.0057, GNorm = 1.9748, lr_0 = 4.3691e-04
Loss = 4.4341e-02, PNorm = 35.0177, GNorm = 0.8901, lr_0 = 4.2470e-04
Loss = 4.3235e-02, PNorm = 35.0189, GNorm = 0.9888, lr_0 = 4.2349e-04
Validation rmse = 0.078135
Epoch 22
Loss = 4.7242e-02, PNorm = 35.0313, GNorm = 1.9355, lr_0 = 4.1165e-04
Validation rmse = 0.076158
Epoch 23
Loss = 3.8497e-02, PNorm = 35.0421, GNorm = 0.8442, lr_0 = 4.0014e-04
Validation rmse = 0.079715
Epoch 24
Loss = 4.4469e-02, PNorm = 35.0519, GNorm = 2.6563, lr_0 = 3.8786e-04
Loss = 4.3135e-02, PNorm = 35.0620, GNorm = 0.6088, lr_0 = 3.7701e-04
Validation rmse = 0.075646
Epoch 25
Loss = 4.2156e-02, PNorm = 35.0715, GNorm = 0.9305, lr_0 = 3.6647e-04
Validation rmse = 0.081487
Epoch 26
Loss = 4.6319e-02, PNorm = 35.0821, GNorm = 1.1993, lr_0 = 3.5622e-04
Loss = 3.6869e-02, PNorm = 35.0905, GNorm = 1.6563, lr_0 = 3.4627e-04
Validation rmse = 0.093707
Epoch 27
Loss = 4.7245e-02, PNorm = 35.1011, GNorm = 1.3827, lr_0 = 3.3563e-04
Validation rmse = 0.076147
Epoch 28
Loss = 3.7867e-02, PNorm = 35.1104, GNorm = 1.3704, lr_0 = 3.2625e-04
Loss = 4.0405e-02, PNorm = 35.1197, GNorm = 2.6263, lr_0 = 3.1713e-04
Validation rmse = 0.074314
Epoch 29
Loss = 3.4964e-02, PNorm = 35.1308, GNorm = 3.0475, lr_0 = 3.0739e-04
Validation rmse = 0.076013
Epoch 30
Loss = 3.5748e-02, PNorm = 35.1375, GNorm = 1.6156, lr_0 = 2.9879e-04
Loss = 3.5788e-02, PNorm = 35.1458, GNorm = 0.7346, lr_0 = 2.9044e-04
Validation rmse = 0.075989
Epoch 31
Loss = 3.3292e-02, PNorm = 35.1551, GNorm = 0.3105, lr_0 = 2.8152e-04
Validation rmse = 0.074561
Epoch 32
Loss = 3.2873e-02, PNorm = 35.1614, GNorm = 1.2061, lr_0 = 2.7365e-04
Loss = 3.3314e-02, PNorm = 35.1683, GNorm = 1.1607, lr_0 = 2.6600e-04
Validation rmse = 0.073165
Epoch 33
Loss = 3.3379e-02, PNorm = 35.1743, GNorm = 0.6065, lr_0 = 2.5856e-04
Validation rmse = 0.077313
Epoch 34
Loss = 3.5902e-02, PNorm = 35.1824, GNorm = 0.5693, lr_0 = 2.5062e-04
Loss = 3.4791e-02, PNorm = 35.1872, GNorm = 1.1705, lr_0 = 2.4361e-04
Validation rmse = 0.080469
Epoch 35
Loss = 3.6252e-02, PNorm = 35.1933, GNorm = 0.7001, lr_0 = 2.3680e-04
Validation rmse = 0.076269
Epoch 36
Loss = 3.0148e-02, PNorm = 35.1995, GNorm = 1.1263, lr_0 = 2.2953e-04
Validation rmse = 0.076177
Epoch 37
Loss = 3.2051e-02, PNorm = 35.2056, GNorm = 0.6142, lr_0 = 2.2311e-04
Loss = 3.2914e-02, PNorm = 35.2116, GNorm = 0.5156, lr_0 = 2.1687e-04
Validation rmse = 0.075421
Epoch 38
Loss = 3.2755e-02, PNorm = 35.2177, GNorm = 0.5454, lr_0 = 2.1081e-04
Validation rmse = 0.074091
Epoch 39
Loss = 3.2966e-02, PNorm = 35.2241, GNorm = 0.3614, lr_0 = 2.0434e-04
Loss = 3.2037e-02, PNorm = 35.2282, GNorm = 1.1576, lr_0 = 1.9862e-04
Validation rmse = 0.073926
Epoch 40
Loss = 3.0157e-02, PNorm = 35.2343, GNorm = 0.9088, lr_0 = 1.9307e-04
Validation rmse = 0.073593
Epoch 41
Loss = 3.0816e-02, PNorm = 35.2399, GNorm = 1.3274, lr_0 = 1.8714e-04
Loss = 3.0447e-02, PNorm = 35.2445, GNorm = 1.1449, lr_0 = 1.8191e-04
Validation rmse = 0.075021
Epoch 42
Loss = 3.2074e-02, PNorm = 35.2495, GNorm = 1.5618, lr_0 = 1.7682e-04
Validation rmse = 0.074454
Epoch 43
Loss = 3.2839e-02, PNorm = 35.2546, GNorm = 1.8532, lr_0 = 1.7139e-04
Loss = 2.9187e-02, PNorm = 35.2593, GNorm = 0.8917, lr_0 = 1.6660e-04
Validation rmse = 0.074302
Epoch 44
Loss = 2.8843e-02, PNorm = 35.2638, GNorm = 1.0699, lr_0 = 1.6194e-04
Validation rmse = 0.075985
Epoch 45
Loss = 3.3408e-02, PNorm = 35.2670, GNorm = 0.8284, lr_0 = 1.5741e-04
Loss = 3.0122e-02, PNorm = 35.2711, GNorm = 2.2360, lr_0 = 1.5301e-04
Loss = 5.1455e-02, PNorm = 35.2713, GNorm = 3.3313, lr_0 = 1.5258e-04
Validation rmse = 0.075624
Epoch 46
Loss = 3.2884e-02, PNorm = 35.2744, GNorm = 0.6164, lr_0 = 1.4831e-04
Validation rmse = 0.074115
Epoch 47
Loss = 2.7332e-02, PNorm = 35.2787, GNorm = 1.4470, lr_0 = 1.4417e-04
Validation rmse = 0.075931
Epoch 48
Loss = 2.7933e-02, PNorm = 35.2821, GNorm = 1.4939, lr_0 = 1.3974e-04
Loss = 2.9916e-02, PNorm = 35.2861, GNorm = 1.7219, lr_0 = 1.3583e-04
Validation rmse = 0.074504
Epoch 49
Loss = 3.1417e-02, PNorm = 35.2894, GNorm = 0.4023, lr_0 = 1.3204e-04
Validation rmse = 0.073561
Epoch 50
Loss = 2.0328e-02, PNorm = 35.2926, GNorm = 0.6243, lr_0 = 1.2834e-04
Loss = 3.0834e-02, PNorm = 35.2959, GNorm = 0.7512, lr_0 = 1.2476e-04
Validation rmse = 0.074541
Epoch 51
Loss = 2.9450e-02, PNorm = 35.2988, GNorm = 0.4529, lr_0 = 1.2092e-04
Validation rmse = 0.074659
Epoch 52
Loss = 2.7799e-02, PNorm = 35.3016, GNorm = 0.8389, lr_0 = 1.1754e-04
Loss = 2.6049e-02, PNorm = 35.3045, GNorm = 0.6459, lr_0 = 1.1426e-04
Validation rmse = 0.073700
Epoch 53
Loss = 2.6457e-02, PNorm = 35.3074, GNorm = 0.8943, lr_0 = 1.1075e-04
Validation rmse = 0.073356
Epoch 54
Loss = 2.8361e-02, PNorm = 35.3104, GNorm = 0.7067, lr_0 = 1.0765e-04
Loss = 2.6854e-02, PNorm = 35.3129, GNorm = 1.6739, lr_0 = 1.0464e-04
Validation rmse = 0.075753
Epoch 55
Loss = 2.7016e-02, PNorm = 35.3154, GNorm = 1.7185, lr_0 = 1.0143e-04
Validation rmse = 0.077693
Epoch 56
Loss = 3.0413e-02, PNorm = 35.3181, GNorm = 1.0712, lr_0 = 1.0000e-04
Loss = 2.7608e-02, PNorm = 35.3207, GNorm = 0.3468, lr_0 = 1.0000e-04
Validation rmse = 0.074784
Epoch 57
Loss = 2.5442e-02, PNorm = 35.3231, GNorm = 0.8276, lr_0 = 1.0000e-04
Validation rmse = 0.074460
Epoch 58
Loss = 2.6691e-02, PNorm = 35.3257, GNorm = 0.3282, lr_0 = 1.0000e-04
Loss = 2.5624e-02, PNorm = 35.3284, GNorm = 0.6016, lr_0 = 1.0000e-04
Validation rmse = 0.074919
Epoch 59
Loss = 2.5751e-02, PNorm = 35.3309, GNorm = 0.8034, lr_0 = 1.0000e-04
Validation rmse = 0.073667
Model 0 best validation rmse = 0.073165 on epoch 32
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.039985
Ensemble test rmse = 0.039985
1-fold cross validation
	Seed 0 ==> test rmse = 0.039985
Overall test rmse = 0.039985 +/- 0.000000
Elapsed time = 0:00:36
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 907 | train size = 721 | val size = 181 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.6462e-01, PNorm = 34.0170, GNorm = 12.5504, lr_0 = 4.5357e-04
Validation rmse = 0.309017
Epoch 1
Loss = 6.4748e-01, PNorm = 34.0489, GNorm = 7.0897, lr_0 = 8.0714e-04
Validation rmse = 0.305385
Epoch 2
Loss = 7.3131e-01, PNorm = 34.1153, GNorm = 15.1912, lr_0 = 9.8592e-04
Loss = 4.7407e-01, PNorm = 34.1803, GNorm = 4.3235, lr_0 = 9.5836e-04
Validation rmse = 0.219886
Epoch 3
Loss = 3.4468e-01, PNorm = 34.2475, GNorm = 3.1200, lr_0 = 9.3156e-04
Validation rmse = 0.188419
Epoch 4
Loss = 2.2754e-01, PNorm = 34.3114, GNorm = 1.0263, lr_0 = 9.0295e-04
Loss = 2.1149e-01, PNorm = 34.3666, GNorm = 1.6805, lr_0 = 8.7771e-04
Validation rmse = 0.169805
Epoch 5
Loss = 1.8073e-01, PNorm = 34.4142, GNorm = 1.1774, lr_0 = 8.5317e-04
Validation rmse = 0.158275
Epoch 6
Loss = 1.7015e-01, PNorm = 34.4629, GNorm = 7.5682, lr_0 = 8.2697e-04
Loss = 1.4258e-01, PNorm = 34.5040, GNorm = 2.5338, lr_0 = 8.0385e-04
Loss = 1.7324e-01, PNorm = 34.5083, GNorm = 1.8843, lr_0 = 8.0157e-04
Validation rmse = 0.139596
Epoch 7
Loss = 1.2631e-01, PNorm = 34.5456, GNorm = 4.0036, lr_0 = 7.7916e-04
Validation rmse = 0.121652
Epoch 8
Loss = 8.1871e-02, PNorm = 34.5856, GNorm = 0.7640, lr_0 = 7.5737e-04
Validation rmse = 0.122223
Epoch 9
Loss = 1.2568e-01, PNorm = 34.6231, GNorm = 3.0222, lr_0 = 7.3411e-04
Loss = 9.4033e-02, PNorm = 34.6522, GNorm = 1.2571, lr_0 = 7.1359e-04
Validation rmse = 0.109873
Epoch 10
Loss = 7.8601e-02, PNorm = 34.6799, GNorm = 1.7120, lr_0 = 6.9364e-04
Validation rmse = 0.121330
Epoch 11
Loss = 1.0236e-01, PNorm = 34.7104, GNorm = 0.8205, lr_0 = 6.7234e-04
Loss = 7.7306e-02, PNorm = 34.7362, GNorm = 5.8394, lr_0 = 6.5354e-04
Validation rmse = 0.101563
Epoch 12
Loss = 7.3472e-02, PNorm = 34.7573, GNorm = 3.8172, lr_0 = 6.3527e-04
Validation rmse = 0.093739
Epoch 13
Loss = 5.3321e-02, PNorm = 34.7754, GNorm = 1.7471, lr_0 = 6.1576e-04
Loss = 5.4210e-02, PNorm = 34.7913, GNorm = 1.1005, lr_0 = 5.9854e-04
Validation rmse = 0.093657
Epoch 14
Loss = 5.3979e-02, PNorm = 34.8103, GNorm = 2.2671, lr_0 = 5.8016e-04
Validation rmse = 0.087014
Epoch 15
Loss = 5.5709e-02, PNorm = 34.8258, GNorm = 4.2763, lr_0 = 5.6394e-04
Loss = 5.0790e-02, PNorm = 34.8400, GNorm = 3.1615, lr_0 = 5.4817e-04
Loss = 6.5651e-02, PNorm = 34.8416, GNorm = 1.2610, lr_0 = 5.4662e-04
Validation rmse = 0.103758
Epoch 16
Loss = 5.9547e-02, PNorm = 34.8548, GNorm = 3.5625, lr_0 = 5.3134e-04
Validation rmse = 0.096181
Epoch 17
Loss = 6.2023e-02, PNorm = 34.8700, GNorm = 1.4552, lr_0 = 5.1648e-04
Validation rmse = 0.102513
Epoch 18
Loss = 5.7861e-02, PNorm = 34.8847, GNorm = 2.6849, lr_0 = 5.0062e-04
Loss = 6.1715e-02, PNorm = 34.8958, GNorm = 2.2728, lr_0 = 4.8662e-04
Validation rmse = 0.083402
Epoch 19
Loss = 4.7183e-02, PNorm = 34.9128, GNorm = 0.8640, lr_0 = 4.7168e-04
Validation rmse = 0.083858
Epoch 20
Loss = 4.5440e-02, PNorm = 34.9235, GNorm = 0.3288, lr_0 = 4.5849e-04
Loss = 4.5811e-02, PNorm = 34.9339, GNorm = 0.3273, lr_0 = 4.4567e-04
Validation rmse = 0.083438
Epoch 21
Loss = 5.7535e-02, PNorm = 34.9434, GNorm = 5.4828, lr_0 = 4.3198e-04
Validation rmse = 0.081726
Epoch 22
Loss = 4.9982e-02, PNorm = 34.9535, GNorm = 2.3004, lr_0 = 4.1991e-04
Loss = 5.3246e-02, PNorm = 34.9626, GNorm = 3.7709, lr_0 = 4.0817e-04
Validation rmse = 0.090738
Epoch 23
Loss = 4.5706e-02, PNorm = 34.9728, GNorm = 1.5004, lr_0 = 3.9563e-04
Validation rmse = 0.100850
Epoch 24
Loss = 4.2301e-02, PNorm = 34.9811, GNorm = 2.0943, lr_0 = 3.8457e-04
Loss = 4.8442e-02, PNorm = 34.9897, GNorm = 0.9680, lr_0 = 3.7382e-04
Loss = 5.5415e-02, PNorm = 34.9908, GNorm = 1.7132, lr_0 = 3.7276e-04
Validation rmse = 0.089116
Epoch 25
Loss = 4.4876e-02, PNorm = 34.9985, GNorm = 2.1121, lr_0 = 3.6234e-04
Validation rmse = 0.078921
Epoch 26
Loss = 3.6914e-02, PNorm = 35.0075, GNorm = 0.3549, lr_0 = 3.5121e-04
Validation rmse = 0.078133
Epoch 27
Loss = 3.5902e-02, PNorm = 35.0147, GNorm = 0.6418, lr_0 = 3.4139e-04
Loss = 3.7424e-02, PNorm = 35.0210, GNorm = 0.9043, lr_0 = 3.3185e-04
Validation rmse = 0.076266
Epoch 28
Loss = 3.8238e-02, PNorm = 35.0277, GNorm = 1.3558, lr_0 = 3.2165e-04
Validation rmse = 0.076641
Epoch 29
Loss = 3.2502e-02, PNorm = 35.0330, GNorm = 0.6880, lr_0 = 3.1266e-04
Loss = 4.0720e-02, PNorm = 35.0415, GNorm = 0.4100, lr_0 = 3.0392e-04
Validation rmse = 0.075855
Epoch 30
Loss = 3.6055e-02, PNorm = 35.0472, GNorm = 0.7278, lr_0 = 2.9459e-04
Validation rmse = 0.079961
Epoch 31
Loss = 3.8782e-02, PNorm = 35.0521, GNorm = 0.5545, lr_0 = 2.8635e-04
Loss = 3.7176e-02, PNorm = 35.0579, GNorm = 3.2776, lr_0 = 2.7834e-04
Validation rmse = 0.078739
Epoch 32
Loss = 3.6448e-02, PNorm = 35.0661, GNorm = 0.6036, lr_0 = 2.6980e-04
Validation rmse = 0.073983
Epoch 33
Loss = 3.1110e-02, PNorm = 35.0714, GNorm = 0.5753, lr_0 = 2.6151e-04
Loss = 3.3068e-02, PNorm = 35.0761, GNorm = 0.8605, lr_0 = 2.5420e-04
Validation rmse = 0.075552
Epoch 34
Loss = 3.4306e-02, PNorm = 35.0812, GNorm = 1.7173, lr_0 = 2.4709e-04
Validation rmse = 0.074042
Epoch 35
Loss = 3.3471e-02, PNorm = 35.0850, GNorm = 1.2565, lr_0 = 2.3950e-04
Validation rmse = 0.075406
Epoch 36
Loss = 3.0866e-02, PNorm = 35.0903, GNorm = 0.3706, lr_0 = 2.3281e-04
Loss = 3.2932e-02, PNorm = 35.0954, GNorm = 0.8313, lr_0 = 2.2630e-04
Validation rmse = 0.073574
Epoch 37
Loss = 3.1805e-02, PNorm = 35.1000, GNorm = 1.3668, lr_0 = 2.1935e-04
Validation rmse = 0.078152
Epoch 38
Loss = 3.3737e-02, PNorm = 35.1050, GNorm = 1.1034, lr_0 = 2.1261e-04
Loss = 3.1925e-02, PNorm = 35.1099, GNorm = 0.7506, lr_0 = 2.0667e-04
Validation rmse = 0.072613
Epoch 39
Loss = 3.2092e-02, PNorm = 35.1132, GNorm = 0.4111, lr_0 = 2.0089e-04
Validation rmse = 0.074375
Epoch 40
Loss = 3.2041e-02, PNorm = 35.1181, GNorm = 1.7516, lr_0 = 1.9472e-04
Loss = 3.3574e-02, PNorm = 35.1211, GNorm = 1.8096, lr_0 = 1.8928e-04
Validation rmse = 0.073562
Epoch 41
Loss = 2.8304e-02, PNorm = 35.1248, GNorm = 0.4369, lr_0 = 1.8398e-04
Validation rmse = 0.072919
Epoch 42
Loss = 3.0403e-02, PNorm = 35.1294, GNorm = 1.0956, lr_0 = 1.7833e-04
Loss = 2.8413e-02, PNorm = 35.1335, GNorm = 0.7598, lr_0 = 1.7335e-04
Validation rmse = 0.075632
Epoch 43
Loss = 2.7629e-02, PNorm = 35.1368, GNorm = 0.5203, lr_0 = 1.6850e-04
Validation rmse = 0.072624
Epoch 44
Loss = 3.1994e-02, PNorm = 35.1402, GNorm = 1.1209, lr_0 = 1.6333e-04
Validation rmse = 0.078989
Epoch 45
Loss = 2.3554e-02, PNorm = 35.1436, GNorm = 1.2775, lr_0 = 1.5831e-04
Loss = 2.8481e-02, PNorm = 35.1467, GNorm = 0.6801, lr_0 = 1.5388e-04
Validation rmse = 0.072294
Epoch 46
Loss = 2.7705e-02, PNorm = 35.1503, GNorm = 1.0708, lr_0 = 1.4958e-04
Validation rmse = 0.072963
Epoch 47
Loss = 3.1860e-02, PNorm = 35.1529, GNorm = 1.8092, lr_0 = 1.4499e-04
Loss = 3.1654e-02, PNorm = 35.1560, GNorm = 2.0752, lr_0 = 1.4093e-04
Validation rmse = 0.072188
Epoch 48
Loss = 2.7350e-02, PNorm = 35.1592, GNorm = 0.4331, lr_0 = 1.3699e-04
Validation rmse = 0.074332
Epoch 49
Loss = 3.0297e-02, PNorm = 35.1621, GNorm = 1.1258, lr_0 = 1.3279e-04
Loss = 3.0824e-02, PNorm = 35.1651, GNorm = 0.5218, lr_0 = 1.2907e-04
Validation rmse = 0.072873
Epoch 50
Loss = 2.8780e-02, PNorm = 35.1673, GNorm = 1.8105, lr_0 = 1.2546e-04
Validation rmse = 0.072561
Epoch 51
Loss = 2.7268e-02, PNorm = 35.1704, GNorm = 0.4281, lr_0 = 1.2161e-04
Validation rmse = 0.071309
Epoch 52
Loss = 3.2017e-02, PNorm = 35.1729, GNorm = 0.7727, lr_0 = 1.1788e-04
Loss = 2.7292e-02, PNorm = 35.1754, GNorm = 1.3404, lr_0 = 1.1458e-04
Validation rmse = 0.073745
Epoch 53
Loss = 2.7842e-02, PNorm = 35.1776, GNorm = 1.3898, lr_0 = 1.1138e-04
Validation rmse = 0.071239
Epoch 54
Loss = 2.8672e-02, PNorm = 35.1802, GNorm = 0.5265, lr_0 = 1.0796e-04
Loss = 2.8323e-02, PNorm = 35.1827, GNorm = 2.0616, lr_0 = 1.0494e-04
Validation rmse = 0.071390
Epoch 55
Loss = 2.8950e-02, PNorm = 35.1847, GNorm = 0.9174, lr_0 = 1.0200e-04
Validation rmse = 0.071114
Epoch 56
Loss = 2.4959e-02, PNorm = 35.1872, GNorm = 0.6773, lr_0 = 1.0000e-04
Loss = 2.7827e-02, PNorm = 35.1892, GNorm = 1.2917, lr_0 = 1.0000e-04
Validation rmse = 0.071128
Epoch 57
Loss = 2.5709e-02, PNorm = 35.1913, GNorm = 0.8094, lr_0 = 1.0000e-04
Validation rmse = 0.072886
Epoch 58
Loss = 2.6135e-02, PNorm = 35.1935, GNorm = 0.7605, lr_0 = 1.0000e-04
Loss = 2.7485e-02, PNorm = 35.1957, GNorm = 0.2829, lr_0 = 1.0000e-04
Loss = 2.1188e-02, PNorm = 35.1959, GNorm = 1.1227, lr_0 = 1.0000e-04
Validation rmse = 0.070830
Epoch 59
Loss = 2.7287e-02, PNorm = 35.1977, GNorm = 0.3686, lr_0 = 1.0000e-04
Validation rmse = 0.070949
Model 0 best validation rmse = 0.070830 on epoch 58
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.081139
Ensemble test rmse = 0.081139
1-fold cross validation
	Seed 0 ==> test rmse = 0.081139
Overall test rmse = 0.081139 +/- 0.000000
Elapsed time = 0:00:37
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 897 | train size = 713 | val size = 179 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.7858e-01, PNorm = 34.0160, GNorm = 5.4662, lr_0 = 4.5357e-04
Validation rmse = 0.271660
Epoch 1
Loss = 7.1402e-01, PNorm = 34.0527, GNorm = 0.7961, lr_0 = 8.0714e-04
Validation rmse = 0.369990
Epoch 2
Loss = 7.5274e-01, PNorm = 34.1214, GNorm = 8.3584, lr_0 = 9.8592e-04
Loss = 5.6081e-01, PNorm = 34.1846, GNorm = 5.6963, lr_0 = 9.5836e-04
Validation rmse = 0.201771
Epoch 3
Loss = 3.7708e-01, PNorm = 34.2612, GNorm = 4.2708, lr_0 = 9.2892e-04
Validation rmse = 0.185880
Epoch 4
Loss = 2.9702e-01, PNorm = 34.3273, GNorm = 3.6806, lr_0 = 9.0295e-04
Loss = 2.3335e-01, PNorm = 34.3886, GNorm = 1.2748, lr_0 = 8.7771e-04
Validation rmse = 0.145814
Epoch 5
Loss = 2.2198e-01, PNorm = 34.4502, GNorm = 2.3820, lr_0 = 8.5075e-04
Validation rmse = 0.137913
Epoch 6
Loss = 1.6814e-01, PNorm = 34.4978, GNorm = 1.8845, lr_0 = 8.2462e-04
Validation rmse = 0.143372
Epoch 7
Loss = 2.2407e-01, PNorm = 34.5427, GNorm = 3.8007, lr_0 = 7.9930e-04
Loss = 1.4590e-01, PNorm = 34.5876, GNorm = 2.2921, lr_0 = 7.7695e-04
Validation rmse = 0.119856
Epoch 8
Loss = 1.0793e-01, PNorm = 34.6273, GNorm = 2.4102, lr_0 = 7.5523e-04
Validation rmse = 0.124063
Epoch 9
Loss = 1.2990e-01, PNorm = 34.6644, GNorm = 4.7788, lr_0 = 7.3204e-04
Loss = 1.0089e-01, PNorm = 34.6973, GNorm = 5.0444, lr_0 = 7.1157e-04
Validation rmse = 0.133358
Epoch 10
Loss = 9.9655e-02, PNorm = 34.7282, GNorm = 3.5521, lr_0 = 6.8972e-04
Validation rmse = 0.120229
Epoch 11
Loss = 8.6007e-02, PNorm = 34.7606, GNorm = 2.9223, lr_0 = 6.6853e-04
Loss = 7.2999e-02, PNorm = 34.7850, GNorm = 2.0138, lr_0 = 6.4984e-04
Validation rmse = 0.087054
Epoch 12
Loss = 6.6425e-02, PNorm = 34.8132, GNorm = 1.7727, lr_0 = 6.3167e-04
Validation rmse = 0.102912
Epoch 13
Loss = 7.2013e-02, PNorm = 34.8396, GNorm = 1.8743, lr_0 = 6.1227e-04
Validation rmse = 0.094308
Epoch 14
Loss = 5.7403e-02, PNorm = 34.8604, GNorm = 2.6684, lr_0 = 5.9347e-04
Loss = 5.4064e-02, PNorm = 34.8823, GNorm = 1.0388, lr_0 = 5.7688e-04
Validation rmse = 0.090686
Epoch 15
Loss = 5.4694e-02, PNorm = 34.8972, GNorm = 2.3129, lr_0 = 5.5916e-04
Validation rmse = 0.081274
Epoch 16
Loss = 4.4337e-02, PNorm = 34.9140, GNorm = 0.8112, lr_0 = 5.4353e-04
Loss = 4.8000e-02, PNorm = 34.9286, GNorm = 0.6640, lr_0 = 5.2833e-04
Validation rmse = 0.084846
Epoch 17
Loss = 4.9518e-02, PNorm = 34.9446, GNorm = 1.1713, lr_0 = 5.1211e-04
Validation rmse = 0.079979
Epoch 18
Loss = 3.7044e-02, PNorm = 34.9611, GNorm = 0.4796, lr_0 = 4.9638e-04
Loss = 4.2484e-02, PNorm = 34.9738, GNorm = 0.5495, lr_0 = 4.8250e-04
Loss = 3.1235e-02, PNorm = 34.9747, GNorm = 0.5431, lr_0 = 4.8113e-04
Validation rmse = 0.078453
Epoch 19
Loss = 4.1169e-02, PNorm = 34.9856, GNorm = 0.5212, lr_0 = 4.6768e-04
Validation rmse = 0.080370
Epoch 20
Loss = 4.4188e-02, PNorm = 34.9972, GNorm = 2.9226, lr_0 = 4.5461e-04
Validation rmse = 0.093755
Epoch 21
Loss = 4.9240e-02, PNorm = 35.0094, GNorm = 3.2109, lr_0 = 4.4064e-04
Loss = 5.5262e-02, PNorm = 35.0238, GNorm = 1.0073, lr_0 = 4.2832e-04
Validation rmse = 0.080213
Epoch 22
Loss = 4.0201e-02, PNorm = 35.0346, GNorm = 0.6550, lr_0 = 4.1517e-04
Validation rmse = 0.085000
Epoch 23
Loss = 4.0583e-02, PNorm = 35.0459, GNorm = 1.5104, lr_0 = 4.0242e-04
Loss = 4.0840e-02, PNorm = 35.0542, GNorm = 2.4374, lr_0 = 3.9117e-04
Validation rmse = 0.073881
Epoch 24
Loss = 3.2970e-02, PNorm = 35.0636, GNorm = 0.4699, lr_0 = 3.8023e-04
Validation rmse = 0.080687
Epoch 25
Loss = 3.6867e-02, PNorm = 35.0743, GNorm = 1.6339, lr_0 = 3.6856e-04
Loss = 3.6288e-02, PNorm = 35.0830, GNorm = 0.5619, lr_0 = 3.5825e-04
Loss = 4.6065e-02, PNorm = 35.0836, GNorm = 1.0391, lr_0 = 3.5724e-04
Validation rmse = 0.075375
Epoch 26
Loss = 3.3732e-02, PNorm = 35.0908, GNorm = 0.9954, lr_0 = 3.4725e-04
Validation rmse = 0.076514
Epoch 27
Loss = 2.8949e-02, PNorm = 35.0987, GNorm = 0.7442, lr_0 = 3.3754e-04
Validation rmse = 0.076690
Epoch 28
Loss = 3.6893e-02, PNorm = 35.1052, GNorm = 1.4051, lr_0 = 3.2717e-04
Loss = 3.3350e-02, PNorm = 35.1115, GNorm = 1.6292, lr_0 = 3.1803e-04
Validation rmse = 0.077824
Epoch 29
Loss = 3.2329e-02, PNorm = 35.1191, GNorm = 1.0036, lr_0 = 3.0826e-04
Validation rmse = 0.074084
Epoch 30
Loss = 2.6513e-02, PNorm = 35.1261, GNorm = 0.3349, lr_0 = 2.9879e-04
Loss = 2.9633e-02, PNorm = 35.1327, GNorm = 1.0693, lr_0 = 2.9044e-04
Validation rmse = 0.074333
Epoch 31
Loss = 2.8611e-02, PNorm = 35.1372, GNorm = 1.4598, lr_0 = 2.8232e-04
Validation rmse = 0.076013
Epoch 32
Loss = 2.3736e-02, PNorm = 35.1443, GNorm = 0.4492, lr_0 = 2.7365e-04
Loss = 3.4052e-02, PNorm = 35.1508, GNorm = 1.1850, lr_0 = 2.6600e-04
Loss = 2.2081e-02, PNorm = 35.1513, GNorm = 1.3381, lr_0 = 2.6524e-04
Validation rmse = 0.072899
Epoch 33
Loss = 3.1714e-02, PNorm = 35.1574, GNorm = 0.2278, lr_0 = 2.5783e-04
Validation rmse = 0.073470
Epoch 34
Loss = 3.2596e-02, PNorm = 35.1641, GNorm = 0.7781, lr_0 = 2.4991e-04
Validation rmse = 0.073892
Epoch 35
Loss = 2.9405e-02, PNorm = 35.1699, GNorm = 1.4395, lr_0 = 2.4292e-04
Loss = 2.9667e-02, PNorm = 35.1731, GNorm = 1.5269, lr_0 = 2.3613e-04
Validation rmse = 0.075241
Epoch 36
Loss = 2.6247e-02, PNorm = 35.1785, GNorm = 1.3729, lr_0 = 2.2888e-04
Validation rmse = 0.072515
Epoch 37
Loss = 2.1996e-02, PNorm = 35.1840, GNorm = 0.3301, lr_0 = 2.2185e-04
Loss = 2.8158e-02, PNorm = 35.1888, GNorm = 0.6998, lr_0 = 2.1565e-04
Validation rmse = 0.072653
Epoch 38
Loss = 2.6424e-02, PNorm = 35.1924, GNorm = 0.6387, lr_0 = 2.0902e-04
Validation rmse = 0.071851
Epoch 39
Loss = 2.8932e-02, PNorm = 35.1969, GNorm = 0.7147, lr_0 = 2.0318e-04
Loss = 2.7891e-02, PNorm = 35.2004, GNorm = 0.4927, lr_0 = 1.9750e-04
Loss = 3.5821e-02, PNorm = 35.2007, GNorm = 2.6063, lr_0 = 1.9694e-04
Validation rmse = 0.072839
Epoch 40
Loss = 2.9713e-02, PNorm = 35.2047, GNorm = 2.0759, lr_0 = 1.9143e-04
Validation rmse = 0.073979
Epoch 41
Loss = 2.3730e-02, PNorm = 35.2094, GNorm = 1.5501, lr_0 = 1.8556e-04
Validation rmse = 0.078432
Epoch 42
Loss = 3.1268e-02, PNorm = 35.2135, GNorm = 1.1357, lr_0 = 1.7986e-04
Loss = 2.9993e-02, PNorm = 35.2183, GNorm = 0.8751, lr_0 = 1.7483e-04
Validation rmse = 0.073500
Epoch 43
Loss = 2.5640e-02, PNorm = 35.2209, GNorm = 1.0235, lr_0 = 1.6994e-04
Validation rmse = 0.072284
Epoch 44
Loss = 2.6356e-02, PNorm = 35.2252, GNorm = 1.4944, lr_0 = 1.6472e-04
Loss = 2.8619e-02, PNorm = 35.2279, GNorm = 0.3309, lr_0 = 1.6012e-04
Validation rmse = 0.073052
Epoch 45
Loss = 2.5868e-02, PNorm = 35.2315, GNorm = 2.0016, lr_0 = 1.5520e-04
Validation rmse = 0.071254
Epoch 46
Loss = 2.9149e-02, PNorm = 35.2344, GNorm = 0.6175, lr_0 = 1.5043e-04
Loss = 2.6834e-02, PNorm = 35.2372, GNorm = 0.8641, lr_0 = 1.4623e-04
Validation rmse = 0.073155
Epoch 47
Loss = 2.5116e-02, PNorm = 35.2393, GNorm = 1.8490, lr_0 = 1.4214e-04
Validation rmse = 0.081179
Epoch 48
Loss = 3.1236e-02, PNorm = 35.2417, GNorm = 1.8594, lr_0 = 1.3777e-04
Validation rmse = 0.076750
Epoch 49
Loss = 2.7062e-02, PNorm = 35.2442, GNorm = 2.0025, lr_0 = 1.3354e-04
Loss = 2.8400e-02, PNorm = 35.2463, GNorm = 1.2029, lr_0 = 1.2981e-04
Validation rmse = 0.072738
Epoch 50
Loss = 2.5368e-02, PNorm = 35.2485, GNorm = 1.5665, lr_0 = 1.2618e-04
Validation rmse = 0.073476
Epoch 51
Loss = 2.7307e-02, PNorm = 35.2512, GNorm = 0.4740, lr_0 = 1.2230e-04
Loss = 2.6468e-02, PNorm = 35.2539, GNorm = 0.2629, lr_0 = 1.1888e-04
Validation rmse = 0.072058
Epoch 52
Loss = 2.4351e-02, PNorm = 35.2562, GNorm = 1.0013, lr_0 = 1.1523e-04
Validation rmse = 0.071153
Epoch 53
Loss = 2.2892e-02, PNorm = 35.2588, GNorm = 0.9959, lr_0 = 1.1169e-04
Loss = 2.6901e-02, PNorm = 35.2607, GNorm = 2.1467, lr_0 = 1.0857e-04
Validation rmse = 0.071578
Epoch 54
Loss = 2.5289e-02, PNorm = 35.2623, GNorm = 1.3355, lr_0 = 1.0554e-04
Validation rmse = 0.071096
Epoch 55
Loss = 2.5316e-02, PNorm = 35.2645, GNorm = 1.5306, lr_0 = 1.0229e-04
Validation rmse = 0.076745
Epoch 56
Loss = 2.6919e-02, PNorm = 35.2668, GNorm = 2.1328, lr_0 = 1.0000e-04
Loss = 2.7312e-02, PNorm = 35.2691, GNorm = 1.2028, lr_0 = 1.0000e-04
Validation rmse = 0.071248
Epoch 57
Loss = 2.3911e-02, PNorm = 35.2717, GNorm = 0.6949, lr_0 = 1.0000e-04
Validation rmse = 0.071872
Epoch 58
Loss = 2.2981e-02, PNorm = 35.2737, GNorm = 0.5199, lr_0 = 1.0000e-04
Loss = 2.4859e-02, PNorm = 35.2752, GNorm = 0.9208, lr_0 = 1.0000e-04
Validation rmse = 0.072526
Epoch 59
Loss = 2.4081e-02, PNorm = 35.2777, GNorm = 1.2418, lr_0 = 1.0000e-04
Validation rmse = 0.071659
Model 0 best validation rmse = 0.071096 on epoch 54
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.082619
Ensemble test rmse = 0.082619
1-fold cross validation
	Seed 0 ==> test rmse = 0.082619
Overall test rmse = 0.082619 +/- 0.000000
Elapsed time = 0:00:34
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 887 | train size = 705 | val size = 177 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1159e-01, PNorm = 34.0180, GNorm = 6.6791, lr_0 = 4.5357e-04
Validation rmse = 0.300597
Epoch 1
Loss = 5.2579e-01, PNorm = 34.0560, GNorm = 8.1558, lr_0 = 8.0714e-04
Validation rmse = 0.336842
Epoch 2
Loss = 6.8824e-01, PNorm = 34.1173, GNorm = 1.4903, lr_0 = 9.8592e-04
Loss = 4.0253e-01, PNorm = 34.1731, GNorm = 2.4916, lr_0 = 9.5836e-04
Validation rmse = 0.224229
Epoch 3
Loss = 3.5165e-01, PNorm = 34.2369, GNorm = 5.8013, lr_0 = 9.2892e-04
Validation rmse = 0.226353
Epoch 4
Loss = 3.4394e-01, PNorm = 34.2907, GNorm = 9.1125, lr_0 = 9.0040e-04
Loss = 2.7115e-01, PNorm = 34.3378, GNorm = 6.0911, lr_0 = 8.7522e-04
Loss = 2.0525e-01, PNorm = 34.3433, GNorm = 6.4827, lr_0 = 8.7274e-04
Validation rmse = 0.183678
Epoch 5
Loss = 2.0447e-01, PNorm = 34.3958, GNorm = 0.5813, lr_0 = 8.4834e-04
Validation rmse = 0.176031
Epoch 6
Loss = 1.5738e-01, PNorm = 34.4415, GNorm = 1.9255, lr_0 = 8.2229e-04
Validation rmse = 0.180993
Epoch 7
Loss = 1.4083e-01, PNorm = 34.4865, GNorm = 0.5216, lr_0 = 7.9704e-04
Loss = 1.2758e-01, PNorm = 34.5303, GNorm = 1.8334, lr_0 = 7.7475e-04
Validation rmse = 0.158344
Epoch 8
Loss = 1.5188e-01, PNorm = 34.5744, GNorm = 6.3202, lr_0 = 7.5096e-04
Validation rmse = 0.134700
Epoch 9
Loss = 1.1900e-01, PNorm = 34.6108, GNorm = 6.6293, lr_0 = 7.2790e-04
Loss = 1.1102e-01, PNorm = 34.6395, GNorm = 0.8873, lr_0 = 7.0754e-04
Validation rmse = 0.134229
Epoch 10
Loss = 8.6448e-02, PNorm = 34.6690, GNorm = 2.0009, lr_0 = 6.8776e-04
Validation rmse = 0.121315
Epoch 11
Loss = 7.8908e-02, PNorm = 34.6939, GNorm = 1.6151, lr_0 = 6.6664e-04
Validation rmse = 0.118019
Epoch 12
Loss = 6.4393e-02, PNorm = 34.7173, GNorm = 0.9483, lr_0 = 6.4617e-04
Loss = 7.8637e-02, PNorm = 34.7370, GNorm = 1.6924, lr_0 = 6.2810e-04
Validation rmse = 0.109406
Epoch 13
Loss = 7.3513e-02, PNorm = 34.7600, GNorm = 1.2445, lr_0 = 6.0881e-04
Validation rmse = 0.108280
Epoch 14
Loss = 6.3236e-02, PNorm = 34.7801, GNorm = 1.3923, lr_0 = 5.9011e-04
Loss = 5.7355e-02, PNorm = 34.7984, GNorm = 0.6406, lr_0 = 5.7362e-04
Validation rmse = 0.104656
Epoch 15
Loss = 5.9142e-02, PNorm = 34.8162, GNorm = 1.9148, lr_0 = 5.5600e-04
Validation rmse = 0.093376
Epoch 16
Loss = 5.5426e-02, PNorm = 34.8330, GNorm = 2.6208, lr_0 = 5.3892e-04
Validation rmse = 0.092847
Epoch 17
Loss = 4.1340e-02, PNorm = 34.8504, GNorm = 0.9870, lr_0 = 5.2237e-04
Loss = 5.7522e-02, PNorm = 34.8611, GNorm = 0.5890, lr_0 = 5.0777e-04
Validation rmse = 0.090544
Epoch 18
Loss = 4.9020e-02, PNorm = 34.8741, GNorm = 2.9899, lr_0 = 4.9217e-04
Validation rmse = 0.095448
Epoch 19
Loss = 4.9405e-02, PNorm = 34.8883, GNorm = 1.3948, lr_0 = 4.7706e-04
Loss = 5.4459e-02, PNorm = 34.8993, GNorm = 0.8709, lr_0 = 4.6372e-04
Validation rmse = 0.083964
Epoch 20
Loss = 4.9437e-02, PNorm = 34.9131, GNorm = 2.3210, lr_0 = 4.5076e-04
Validation rmse = 0.082081
Epoch 21
Loss = 3.9509e-02, PNorm = 34.9245, GNorm = 0.5437, lr_0 = 4.3691e-04
Loss = 4.2519e-02, PNorm = 34.9335, GNorm = 1.0217, lr_0 = 4.2470e-04
Loss = 6.7248e-02, PNorm = 34.9343, GNorm = 3.1848, lr_0 = 4.2349e-04
Validation rmse = 0.091877
Epoch 22
Loss = 4.4394e-02, PNorm = 34.9432, GNorm = 0.6980, lr_0 = 4.1165e-04
Validation rmse = 0.081677
Epoch 23
Loss = 3.8591e-02, PNorm = 34.9535, GNorm = 1.2716, lr_0 = 3.9901e-04
Validation rmse = 0.087158
Epoch 24
Loss = 5.2280e-02, PNorm = 34.9624, GNorm = 3.0454, lr_0 = 3.8676e-04
Loss = 4.8489e-02, PNorm = 34.9703, GNorm = 1.7373, lr_0 = 3.7594e-04
Validation rmse = 0.080003
Epoch 25
Loss = 3.8605e-02, PNorm = 34.9795, GNorm = 1.4650, lr_0 = 3.6440e-04
Validation rmse = 0.079187
Epoch 26
Loss = 3.0586e-02, PNorm = 34.9894, GNorm = 0.7372, lr_0 = 3.5321e-04
Loss = 3.8395e-02, PNorm = 34.9964, GNorm = 0.4018, lr_0 = 3.4333e-04
Loss = 2.3965e-02, PNorm = 34.9972, GNorm = 1.5399, lr_0 = 3.4236e-04
Validation rmse = 0.089702
Epoch 27
Loss = 4.2253e-02, PNorm = 35.0028, GNorm = 1.5283, lr_0 = 3.3279e-04
Validation rmse = 0.073483
Epoch 28
Loss = 3.0978e-02, PNorm = 35.0108, GNorm = 1.2271, lr_0 = 3.2257e-04
Validation rmse = 0.085917
Epoch 29
Loss = 4.0522e-02, PNorm = 35.0173, GNorm = 1.4055, lr_0 = 3.1266e-04
Loss = 4.1640e-02, PNorm = 35.0243, GNorm = 1.0389, lr_0 = 3.0392e-04
Validation rmse = 0.077821
Epoch 30
Loss = 4.1079e-02, PNorm = 35.0320, GNorm = 2.7172, lr_0 = 2.9542e-04
Validation rmse = 0.077844
Epoch 31
Loss = 3.8452e-02, PNorm = 35.0375, GNorm = 1.1892, lr_0 = 2.8635e-04
Loss = 3.7860e-02, PNorm = 35.0437, GNorm = 1.0987, lr_0 = 2.7834e-04
Validation rmse = 0.076600
Epoch 32
Loss = 3.3451e-02, PNorm = 35.0500, GNorm = 0.9564, lr_0 = 2.6980e-04
Validation rmse = 0.072470
Epoch 33
Loss = 2.9251e-02, PNorm = 35.0573, GNorm = 0.5766, lr_0 = 2.6151e-04
Validation rmse = 0.083717
Epoch 34
Loss = 4.8597e-02, PNorm = 35.0639, GNorm = 2.7126, lr_0 = 2.5348e-04
Loss = 4.0702e-02, PNorm = 35.0692, GNorm = 1.7749, lr_0 = 2.4639e-04
Validation rmse = 0.081523
Epoch 35
Loss = 4.7440e-02, PNorm = 35.0733, GNorm = 2.6997, lr_0 = 2.3882e-04
Validation rmse = 0.076104
Epoch 36
Loss = 4.3458e-02, PNorm = 35.0813, GNorm = 1.5345, lr_0 = 2.3149e-04
Loss = 3.7075e-02, PNorm = 35.0866, GNorm = 1.1008, lr_0 = 2.2502e-04
Validation rmse = 0.077075
Epoch 37
Loss = 3.5736e-02, PNorm = 35.0916, GNorm = 0.6396, lr_0 = 2.1811e-04
Validation rmse = 0.077004
Epoch 38
Loss = 3.5364e-02, PNorm = 35.0965, GNorm = 1.0040, lr_0 = 2.1141e-04
Validation rmse = 0.080847
Epoch 39
Loss = 3.2649e-02, PNorm = 35.1017, GNorm = 1.9469, lr_0 = 2.0492e-04
Loss = 3.0459e-02, PNorm = 35.1058, GNorm = 0.2175, lr_0 = 1.9919e-04
Validation rmse = 0.072041
Epoch 40
Loss = 3.1626e-02, PNorm = 35.1090, GNorm = 2.2960, lr_0 = 1.9362e-04
Validation rmse = 0.080066
Epoch 41
Loss = 3.9215e-02, PNorm = 35.1129, GNorm = 2.5268, lr_0 = 1.8767e-04
Loss = 3.1896e-02, PNorm = 35.1168, GNorm = 1.2066, lr_0 = 1.8242e-04
Validation rmse = 0.070664
Epoch 42
Loss = 2.9953e-02, PNorm = 35.1201, GNorm = 1.7282, lr_0 = 1.7682e-04
Validation rmse = 0.070466
Epoch 43
Loss = 3.0268e-02, PNorm = 35.1237, GNorm = 0.3571, lr_0 = 1.7139e-04
Loss = 2.9202e-02, PNorm = 35.1262, GNorm = 0.2670, lr_0 = 1.6660e-04
Loss = 4.8948e-02, PNorm = 35.1266, GNorm = 1.1913, lr_0 = 1.6613e-04
Validation rmse = 0.071015
Epoch 44
Loss = 2.9165e-02, PNorm = 35.1315, GNorm = 0.8423, lr_0 = 1.6148e-04
Validation rmse = 0.070168
Epoch 45
Loss = 3.1961e-02, PNorm = 35.1364, GNorm = 0.4522, lr_0 = 1.5652e-04
Validation rmse = 0.071402
Epoch 46
Loss = 2.6766e-02, PNorm = 35.1409, GNorm = 0.4585, lr_0 = 1.5172e-04
Loss = 3.4277e-02, PNorm = 35.1459, GNorm = 0.4863, lr_0 = 1.4748e-04
Validation rmse = 0.069347
Epoch 47
Loss = 2.6557e-02, PNorm = 35.1491, GNorm = 0.5706, lr_0 = 1.4295e-04
Validation rmse = 0.070011
Epoch 48
Loss = 2.9295e-02, PNorm = 35.1519, GNorm = 0.3031, lr_0 = 1.3856e-04
Loss = 2.8428e-02, PNorm = 35.1541, GNorm = 1.1798, lr_0 = 1.3468e-04
Loss = 3.0726e-02, PNorm = 35.1541, GNorm = 2.4467, lr_0 = 1.3430e-04
Validation rmse = 0.071292
Epoch 49
Loss = 2.8618e-02, PNorm = 35.1566, GNorm = 1.1440, lr_0 = 1.3055e-04
Validation rmse = 0.070101
Epoch 50
Loss = 2.9246e-02, PNorm = 35.1585, GNorm = 0.9964, lr_0 = 1.2690e-04
Validation rmse = 0.069166
Epoch 51
Loss = 3.2545e-02, PNorm = 35.1607, GNorm = 0.7006, lr_0 = 1.2300e-04
Loss = 2.8579e-02, PNorm = 35.1632, GNorm = 1.8567, lr_0 = 1.1956e-04
Validation rmse = 0.069477
Epoch 52
Loss = 2.7894e-02, PNorm = 35.1657, GNorm = 1.5169, lr_0 = 1.1589e-04
Validation rmse = 0.069161
Epoch 53
Loss = 2.3611e-02, PNorm = 35.1673, GNorm = 0.3355, lr_0 = 1.1233e-04
Loss = 2.7357e-02, PNorm = 35.1695, GNorm = 0.8315, lr_0 = 1.0919e-04
Validation rmse = 0.068705
Epoch 54
Loss = 2.6759e-02, PNorm = 35.1711, GNorm = 0.5561, lr_0 = 1.0584e-04
Validation rmse = 0.068853
Epoch 55
Loss = 2.7559e-02, PNorm = 35.1738, GNorm = 0.5226, lr_0 = 1.0258e-04
Validation rmse = 0.069673
Epoch 56
Loss = 2.8066e-02, PNorm = 35.1764, GNorm = 1.6972, lr_0 = 1.0000e-04
Loss = 2.8977e-02, PNorm = 35.1793, GNorm = 2.0013, lr_0 = 1.0000e-04
Validation rmse = 0.076087
Epoch 57
Loss = 3.2130e-02, PNorm = 35.1815, GNorm = 1.7813, lr_0 = 1.0000e-04
Validation rmse = 0.072994
Epoch 58
Loss = 3.3334e-02, PNorm = 35.1837, GNorm = 3.4795, lr_0 = 1.0000e-04
Loss = 3.3456e-02, PNorm = 35.1854, GNorm = 0.4367, lr_0 = 1.0000e-04
Validation rmse = 0.076718
Epoch 59
Loss = 2.9989e-02, PNorm = 35.1870, GNorm = 1.1208, lr_0 = 1.0000e-04
Validation rmse = 0.073192
Model 0 best validation rmse = 0.068705 on epoch 53
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.064566
Ensemble test rmse = 0.064566
1-fold cross validation
	Seed 0 ==> test rmse = 0.064566
Overall test rmse = 0.064566 +/- 0.000000
Elapsed time = 0:00:34
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 877 | train size = 697 | val size = 175 | test size = 5
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.3271e-01, PNorm = 34.0174, GNorm = 4.8029, lr_0 = 4.8077e-04
Validation rmse = 0.279715
Epoch 1
Loss = 6.5578e-01, PNorm = 34.0604, GNorm = 4.1521, lr_0 = 8.6154e-04
Validation rmse = 0.232259
Epoch 2
Loss = 4.4096e-01, PNorm = 34.1236, GNorm = 5.3253, lr_0 = 9.8184e-04
Loss = 4.0251e-01, PNorm = 34.1964, GNorm = 2.0549, lr_0 = 9.5231e-04
Validation rmse = 0.172429
Epoch 3
Loss = 3.8364e-01, PNorm = 34.2620, GNorm = 11.0594, lr_0 = 9.2367e-04
Validation rmse = 0.179786
Epoch 4
Loss = 3.4374e-01, PNorm = 34.3209, GNorm = 1.0414, lr_0 = 8.9589e-04
Validation rmse = 0.152161
Epoch 5
Loss = 2.3433e-01, PNorm = 34.3777, GNorm = 4.0913, lr_0 = 8.6894e-04
Loss = 2.1426e-01, PNorm = 34.4367, GNorm = 2.3320, lr_0 = 8.4281e-04
Validation rmse = 0.145478
Epoch 6
Loss = 1.7950e-01, PNorm = 34.4869, GNorm = 1.0223, lr_0 = 8.1746e-04
Validation rmse = 0.132940
Epoch 7
Loss = 1.4391e-01, PNorm = 34.5261, GNorm = 3.1024, lr_0 = 7.9287e-04
Loss = 1.4923e-01, PNorm = 34.5688, GNorm = 4.0953, lr_0 = 7.6903e-04
Validation rmse = 0.110909
Epoch 8
Loss = 1.3575e-01, PNorm = 34.6156, GNorm = 6.2232, lr_0 = 7.4590e-04
Validation rmse = 0.105120
Epoch 9
Loss = 8.4045e-02, PNorm = 34.6570, GNorm = 1.2885, lr_0 = 7.2346e-04
Validation rmse = 0.097476
Epoch 10
Loss = 1.2196e-01, PNorm = 34.6969, GNorm = 4.1406, lr_0 = 7.0170e-04
Loss = 7.5379e-02, PNorm = 34.7348, GNorm = 2.5248, lr_0 = 6.8060e-04
Validation rmse = 0.086055
Epoch 11
Loss = 6.1144e-02, PNorm = 34.7639, GNorm = 2.1605, lr_0 = 6.6013e-04
Validation rmse = 0.091858
Epoch 12
Loss = 5.3034e-02, PNorm = 34.7923, GNorm = 1.5513, lr_0 = 6.4027e-04
Loss = 5.8165e-02, PNorm = 34.8188, GNorm = 1.8444, lr_0 = 6.2102e-04
Validation rmse = 0.077178
Epoch 13
Loss = 4.9760e-02, PNorm = 34.8428, GNorm = 1.2162, lr_0 = 6.0234e-04
Validation rmse = 0.076068
Epoch 14
Loss = 4.8618e-02, PNorm = 34.8650, GNorm = 0.9321, lr_0 = 5.8422e-04
Validation rmse = 0.082539
Epoch 15
Loss = 3.8996e-02, PNorm = 34.8858, GNorm = 1.7277, lr_0 = 5.6665e-04
Loss = 4.4501e-02, PNorm = 34.9026, GNorm = 1.6124, lr_0 = 5.4961e-04
Validation rmse = 0.073337
Epoch 16
Loss = 4.1340e-02, PNorm = 34.9199, GNorm = 2.3046, lr_0 = 5.3308e-04
Validation rmse = 0.082715
Epoch 17
Loss = 4.4563e-02, PNorm = 34.9375, GNorm = 1.4595, lr_0 = 5.1547e-04
Loss = 3.9711e-02, PNorm = 34.9512, GNorm = 1.7332, lr_0 = 4.9996e-04
Validation rmse = 0.070038
Epoch 18
Loss = 4.3071e-02, PNorm = 34.9645, GNorm = 1.5458, lr_0 = 4.8493e-04
Validation rmse = 0.074682
Epoch 19
Loss = 3.9956e-02, PNorm = 34.9783, GNorm = 1.5081, lr_0 = 4.7034e-04
Validation rmse = 0.073817
Epoch 20
Loss = 4.4957e-02, PNorm = 34.9898, GNorm = 2.1645, lr_0 = 4.5620e-04
Loss = 4.0417e-02, PNorm = 35.0013, GNorm = 4.1981, lr_0 = 4.4247e-04
Validation rmse = 0.095162
Epoch 21
Loss = 6.3340e-02, PNorm = 35.0133, GNorm = 5.1081, lr_0 = 4.2917e-04
Validation rmse = 0.077308
Epoch 22
Loss = 4.4635e-02, PNorm = 35.0232, GNorm = 2.2448, lr_0 = 4.1626e-04
Loss = 3.7915e-02, PNorm = 35.0354, GNorm = 1.8114, lr_0 = 4.0374e-04
Validation rmse = 0.071193
Epoch 23
Loss = 3.6387e-02, PNorm = 35.0452, GNorm = 1.7036, lr_0 = 3.9160e-04
Validation rmse = 0.066969
Epoch 24
Loss = 3.3360e-02, PNorm = 35.0535, GNorm = 0.8281, lr_0 = 3.7982e-04
Validation rmse = 0.068984
Epoch 25
Loss = 3.3652e-02, PNorm = 35.0614, GNorm = 1.7298, lr_0 = 3.6839e-04
Loss = 3.3862e-02, PNorm = 35.0692, GNorm = 0.4646, lr_0 = 3.5731e-04
Validation rmse = 0.073095
Epoch 26
Loss = 2.9194e-02, PNorm = 35.0782, GNorm = 1.2783, lr_0 = 3.4657e-04
Validation rmse = 0.069380
Epoch 27
Loss = 3.0506e-02, PNorm = 35.0865, GNorm = 0.4994, lr_0 = 3.3614e-04
Loss = 3.0391e-02, PNorm = 35.0945, GNorm = 0.7111, lr_0 = 3.2603e-04
Validation rmse = 0.065862
Epoch 28
Loss = 2.9464e-02, PNorm = 35.1014, GNorm = 0.5472, lr_0 = 3.1623e-04
Validation rmse = 0.066589
Epoch 29
Loss = 2.7283e-02, PNorm = 35.1077, GNorm = 0.3448, lr_0 = 3.0672e-04
Validation rmse = 0.069335
Epoch 30
Loss = 3.3894e-02, PNorm = 35.1141, GNorm = 2.7129, lr_0 = 2.9749e-04
Loss = 3.4136e-02, PNorm = 35.1205, GNorm = 0.4578, lr_0 = 2.8854e-04
Validation rmse = 0.074203
Epoch 31
Loss = 3.0851e-02, PNorm = 35.1280, GNorm = 2.6778, lr_0 = 2.7987e-04
Validation rmse = 0.075040
Epoch 32
Loss = 3.6531e-02, PNorm = 35.1338, GNorm = 0.7756, lr_0 = 2.7145e-04
Loss = 3.0261e-02, PNorm = 35.1398, GNorm = 0.5290, lr_0 = 2.6328e-04
Validation rmse = 0.071611
Epoch 33
Loss = 3.1662e-02, PNorm = 35.1446, GNorm = 2.5806, lr_0 = 2.5537e-04
Validation rmse = 0.068143
Epoch 34
Loss = 2.6873e-02, PNorm = 35.1511, GNorm = 1.3144, lr_0 = 2.4693e-04
Validation rmse = 0.067191
Epoch 35
Loss = 2.6012e-02, PNorm = 35.1560, GNorm = 0.7878, lr_0 = 2.3950e-04
Loss = 2.8700e-02, PNorm = 35.1607, GNorm = 0.8839, lr_0 = 2.3230e-04
Validation rmse = 0.072751
Epoch 36
Loss = 3.1349e-02, PNorm = 35.1652, GNorm = 1.2114, lr_0 = 2.2531e-04
Validation rmse = 0.075056
Epoch 37
Loss = 3.4187e-02, PNorm = 35.1695, GNorm = 3.9556, lr_0 = 2.1854e-04
Validation rmse = 0.065218
Epoch 38
Loss = 2.6996e-02, PNorm = 35.1746, GNorm = 0.5055, lr_0 = 2.1196e-04
Loss = 2.6918e-02, PNorm = 35.1781, GNorm = 0.4711, lr_0 = 2.0559e-04
Validation rmse = 0.068897
Epoch 39
Loss = 2.6153e-02, PNorm = 35.1828, GNorm = 1.6161, lr_0 = 1.9940e-04
Validation rmse = 0.066141
Epoch 40
Loss = 2.4274e-02, PNorm = 35.1872, GNorm = 0.6739, lr_0 = 1.9341e-04
Loss = 2.6007e-02, PNorm = 35.1907, GNorm = 0.5833, lr_0 = 1.8759e-04
Validation rmse = 0.064907
Epoch 41
Loss = 2.5308e-02, PNorm = 35.1941, GNorm = 0.7706, lr_0 = 1.8195e-04
Validation rmse = 0.067226
Epoch 42
Loss = 2.5486e-02, PNorm = 35.1967, GNorm = 0.5034, lr_0 = 1.7648e-04
Validation rmse = 0.067057
Epoch 43
Loss = 2.0952e-02, PNorm = 35.2007, GNorm = 0.6861, lr_0 = 1.7117e-04
Loss = 2.3548e-02, PNorm = 35.2033, GNorm = 0.9807, lr_0 = 1.6602e-04
Validation rmse = 0.071244
Epoch 44
Loss = 2.7521e-02, PNorm = 35.2065, GNorm = 1.9413, lr_0 = 1.6103e-04
Validation rmse = 0.065104
Epoch 45
Loss = 2.5252e-02, PNorm = 35.2099, GNorm = 0.3247, lr_0 = 1.5618e-04
Loss = 2.4094e-02, PNorm = 35.2128, GNorm = 1.1511, lr_0 = 1.5149e-04
Validation rmse = 0.064610
Epoch 46
Loss = 2.3996e-02, PNorm = 35.2162, GNorm = 0.5276, lr_0 = 1.4693e-04
Validation rmse = 0.067065
Epoch 47
Loss = 2.5103e-02, PNorm = 35.2187, GNorm = 0.7679, lr_0 = 1.4251e-04
Validation rmse = 0.065268
Epoch 48
Loss = 2.4267e-02, PNorm = 35.2208, GNorm = 0.6354, lr_0 = 1.3822e-04
Loss = 2.2876e-02, PNorm = 35.2227, GNorm = 0.8822, lr_0 = 1.3407e-04
Validation rmse = 0.065135
Epoch 49
Loss = 2.2470e-02, PNorm = 35.2259, GNorm = 1.1618, lr_0 = 1.3003e-04
Validation rmse = 0.066203
Epoch 50
Loss = 2.5797e-02, PNorm = 35.2288, GNorm = 2.0057, lr_0 = 1.2612e-04
Loss = 2.5086e-02, PNorm = 35.2308, GNorm = 1.8703, lr_0 = 1.2233e-04
Loss = 3.4449e-02, PNorm = 35.2310, GNorm = 1.0599, lr_0 = 1.2196e-04
Validation rmse = 0.065588
Epoch 51
Loss = 2.3485e-02, PNorm = 35.2334, GNorm = 0.3220, lr_0 = 1.1829e-04
Validation rmse = 0.064836
Epoch 52
Loss = 2.3305e-02, PNorm = 35.2357, GNorm = 0.6701, lr_0 = 1.1473e-04
Validation rmse = 0.064073
Epoch 53
Loss = 2.0319e-02, PNorm = 35.2377, GNorm = 0.2521, lr_0 = 1.1128e-04
Loss = 2.2711e-02, PNorm = 35.2396, GNorm = 0.8112, lr_0 = 1.0793e-04
Validation rmse = 0.064381
Epoch 54
Loss = 2.1921e-02, PNorm = 35.2419, GNorm = 0.4433, lr_0 = 1.0469e-04
Validation rmse = 0.064255
Epoch 55
Loss = 2.5037e-02, PNorm = 35.2437, GNorm = 0.3378, lr_0 = 1.0154e-04
Loss = 2.1962e-02, PNorm = 35.2458, GNorm = 1.0682, lr_0 = 1.0000e-04
Validation rmse = 0.065073
Epoch 56
Loss = 2.3368e-02, PNorm = 35.2474, GNorm = 0.3684, lr_0 = 1.0000e-04
Validation rmse = 0.064182
Epoch 57
Loss = 2.2705e-02, PNorm = 35.2491, GNorm = 0.6158, lr_0 = 1.0000e-04
Validation rmse = 0.064621
Epoch 58
Loss = 2.4083e-02, PNorm = 35.2511, GNorm = 0.5037, lr_0 = 1.0000e-04
Loss = 2.1465e-02, PNorm = 35.2531, GNorm = 0.8784, lr_0 = 1.0000e-04
Validation rmse = 0.065789
Epoch 59
Loss = 2.4628e-02, PNorm = 35.2546, GNorm = 0.8403, lr_0 = 1.0000e-04
Validation rmse = 0.065461
Model 0 best validation rmse = 0.064073 on epoch 52
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.079340
Ensemble test rmse = 0.079340
1-fold cross validation
	Seed 0 ==> test rmse = 0.079340
Overall test rmse = 0.079340 +/- 0.000000
Elapsed time = 0:00:34
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,167 | train size = 927 | val size = 234 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.9265e-01, PNorm = 34.0157, GNorm = 3.5732, lr_0 = 3.7500e-04
Validation rmse = 0.284287
Epoch 1
Loss = 6.9237e-01, PNorm = 34.0439, GNorm = 6.4419, lr_0 = 6.5000e-04
Loss = 7.6370e-01, PNorm = 34.0834, GNorm = 3.2127, lr_0 = 9.0000e-04
Validation rmse = 0.276076
Epoch 2
Loss = 6.7314e-01, PNorm = 34.1345, GNorm = 9.5480, lr_0 = 9.8685e-04
Loss = 6.1951e-01, PNorm = 34.1978, GNorm = 5.0216, lr_0 = 9.6533e-04
Validation rmse = 0.269354
Epoch 3
Loss = 5.1256e-01, PNorm = 34.2687, GNorm = 3.1734, lr_0 = 9.4219e-04
Loss = 4.2735e-01, PNorm = 34.3313, GNorm = 0.9409, lr_0 = 9.2164e-04
Validation rmse = 0.220364
Epoch 4
Loss = 4.3210e-01, PNorm = 34.3851, GNorm = 1.2037, lr_0 = 9.0153e-04
Loss = 3.3622e-01, PNorm = 34.4427, GNorm = 1.5474, lr_0 = 8.8187e-04
Validation rmse = 0.203020
Epoch 5
Loss = 3.1870e-01, PNorm = 34.5017, GNorm = 3.5992, lr_0 = 8.6073e-04
Loss = 2.7305e-01, PNorm = 34.5562, GNorm = 1.2497, lr_0 = 8.4195e-04
Validation rmse = 0.193515
Epoch 6
Loss = 3.0355e-01, PNorm = 34.5922, GNorm = 3.1700, lr_0 = 8.2359e-04
Validation rmse = 0.206545
Epoch 7
Loss = 2.3960e-01, PNorm = 34.6342, GNorm = 3.4207, lr_0 = 8.0385e-04
Loss = 3.0215e-01, PNorm = 34.6717, GNorm = 4.1366, lr_0 = 7.8631e-04
Validation rmse = 0.182238
Epoch 8
Loss = 2.4078e-01, PNorm = 34.7032, GNorm = 3.7153, lr_0 = 7.6916e-04
Loss = 2.3669e-01, PNorm = 34.7340, GNorm = 2.4958, lr_0 = 7.5238e-04
Validation rmse = 0.191162
Epoch 9
Loss = 2.8968e-01, PNorm = 34.7677, GNorm = 2.7439, lr_0 = 7.3435e-04
Loss = 1.9993e-01, PNorm = 34.7959, GNorm = 1.7579, lr_0 = 7.1833e-04
Validation rmse = 0.180546
Epoch 10
Loss = 2.4687e-01, PNorm = 34.8143, GNorm = 6.3842, lr_0 = 7.0266e-04
Loss = 1.9371e-01, PNorm = 34.8345, GNorm = 1.6602, lr_0 = 6.8733e-04
Validation rmse = 0.183165
Epoch 11
Loss = 2.0455e-01, PNorm = 34.8629, GNorm = 3.0105, lr_0 = 6.7085e-04
Loss = 2.1758e-01, PNorm = 34.8796, GNorm = 4.0281, lr_0 = 6.5622e-04
Validation rmse = 0.186890
Epoch 12
Loss = 2.1724e-01, PNorm = 34.8925, GNorm = 3.4124, lr_0 = 6.4191e-04
Loss = 2.2759e-01, PNorm = 34.9130, GNorm = 5.5231, lr_0 = 6.2790e-04
Validation rmse = 0.203739
Epoch 13
Loss = 2.8424e-01, PNorm = 34.9357, GNorm = 5.4572, lr_0 = 6.1421e-04
Validation rmse = 0.177900
Epoch 14
Loss = 1.4119e-01, PNorm = 34.9542, GNorm = 0.9607, lr_0 = 5.9948e-04
Loss = 2.2155e-01, PNorm = 34.9701, GNorm = 2.7760, lr_0 = 5.8641e-04
Validation rmse = 0.182044
Epoch 15
Loss = 2.2371e-01, PNorm = 34.9882, GNorm = 1.3620, lr_0 = 5.7362e-04
Loss = 1.8238e-01, PNorm = 35.0097, GNorm = 0.8795, lr_0 = 5.6110e-04
Validation rmse = 0.177891
Epoch 16
Loss = 2.1464e-01, PNorm = 35.0259, GNorm = 4.4125, lr_0 = 5.4765e-04
Loss = 1.9529e-01, PNorm = 35.0416, GNorm = 2.5752, lr_0 = 5.3571e-04
Validation rmse = 0.170485
Epoch 17
Loss = 1.8825e-01, PNorm = 35.0576, GNorm = 0.6088, lr_0 = 5.2402e-04
Loss = 1.9695e-01, PNorm = 35.0724, GNorm = 1.7284, lr_0 = 5.1259e-04
Validation rmse = 0.175985
Epoch 18
Loss = 2.1384e-01, PNorm = 35.0874, GNorm = 3.6491, lr_0 = 5.0030e-04
Loss = 1.7374e-01, PNorm = 35.1027, GNorm = 1.4962, lr_0 = 4.8939e-04
Validation rmse = 0.171411
Epoch 19
Loss = 1.9818e-01, PNorm = 35.1154, GNorm = 4.3625, lr_0 = 4.7871e-04
Loss = 1.9132e-01, PNorm = 35.1269, GNorm = 2.0017, lr_0 = 4.6827e-04
Loss = 1.6335e-01, PNorm = 35.1279, GNorm = 3.0666, lr_0 = 4.6724e-04
Validation rmse = 0.173350
Epoch 20
Loss = 2.0294e-01, PNorm = 35.1398, GNorm = 3.0850, lr_0 = 4.5705e-04
Validation rmse = 0.169426
Epoch 21
Loss = 1.4987e-01, PNorm = 35.1527, GNorm = 0.6971, lr_0 = 4.4708e-04
Loss = 1.7988e-01, PNorm = 35.1619, GNorm = 0.8345, lr_0 = 4.3733e-04
Validation rmse = 0.174140
Epoch 22
Loss = 2.2097e-01, PNorm = 35.1764, GNorm = 1.6897, lr_0 = 4.2684e-04
Loss = 1.5986e-01, PNorm = 35.1856, GNorm = 2.2466, lr_0 = 4.1753e-04
Validation rmse = 0.170611
Epoch 23
Loss = 1.5527e-01, PNorm = 35.1991, GNorm = 0.6559, lr_0 = 4.0842e-04
Loss = 1.7499e-01, PNorm = 35.2091, GNorm = 0.6317, lr_0 = 3.9951e-04
Validation rmse = 0.175035
Epoch 24
Loss = 1.7325e-01, PNorm = 35.2203, GNorm = 2.7085, lr_0 = 3.8994e-04
Loss = 1.7153e-01, PNorm = 35.2320, GNorm = 1.2318, lr_0 = 3.8143e-04
Validation rmse = 0.172795
Epoch 25
Loss = 1.9892e-01, PNorm = 35.2421, GNorm = 1.4075, lr_0 = 3.7311e-04
Loss = 1.5469e-01, PNorm = 35.2527, GNorm = 2.4803, lr_0 = 3.6497e-04
Validation rmse = 0.172053
Epoch 26
Loss = 2.1047e-01, PNorm = 35.2622, GNorm = 3.6054, lr_0 = 3.5701e-04
Loss = 1.5560e-01, PNorm = 35.2744, GNorm = 2.5786, lr_0 = 3.4922e-04
Loss = 1.3988e-01, PNorm = 35.2756, GNorm = 1.7978, lr_0 = 3.4845e-04
Validation rmse = 0.178634
Epoch 27
Loss = 1.7607e-01, PNorm = 35.2855, GNorm = 2.9906, lr_0 = 3.4085e-04
Validation rmse = 0.172776
Epoch 28
Loss = 1.8998e-01, PNorm = 35.2935, GNorm = 2.0834, lr_0 = 3.3342e-04
Loss = 1.6332e-01, PNorm = 35.3019, GNorm = 3.0278, lr_0 = 3.2614e-04
Validation rmse = 0.180720
Epoch 29
Loss = 1.7909e-01, PNorm = 35.3110, GNorm = 2.1075, lr_0 = 3.1833e-04
Loss = 1.6987e-01, PNorm = 35.3219, GNorm = 2.3755, lr_0 = 3.1138e-04
Validation rmse = 0.176680
Epoch 30
Loss = 1.5499e-01, PNorm = 35.3306, GNorm = 0.8993, lr_0 = 3.0459e-04
Loss = 1.8435e-01, PNorm = 35.3368, GNorm = 1.6340, lr_0 = 2.9795e-04
Validation rmse = 0.173879
Epoch 31
Loss = 1.7567e-01, PNorm = 35.3495, GNorm = 1.8644, lr_0 = 2.9080e-04
Loss = 1.7797e-01, PNorm = 35.3566, GNorm = 1.1090, lr_0 = 2.8446e-04
Validation rmse = 0.174446
Epoch 32
Loss = 1.5477e-01, PNorm = 35.3643, GNorm = 3.2304, lr_0 = 2.7826e-04
Loss = 1.6955e-01, PNorm = 35.3716, GNorm = 0.7852, lr_0 = 2.7219e-04
Validation rmse = 0.173272
Epoch 33
Loss = 1.6873e-01, PNorm = 35.3808, GNorm = 1.7803, lr_0 = 2.6566e-04
Loss = 1.5100e-01, PNorm = 35.3884, GNorm = 0.8952, lr_0 = 2.5987e-04
Validation rmse = 0.171383
Epoch 34
Loss = 1.5573e-01, PNorm = 35.3968, GNorm = 1.2909, lr_0 = 2.5420e-04
Validation rmse = 0.169236
Epoch 35
Loss = 1.4815e-01, PNorm = 35.4032, GNorm = 1.6272, lr_0 = 2.4811e-04
Loss = 1.5965e-01, PNorm = 35.4105, GNorm = 2.2628, lr_0 = 2.4269e-04
Validation rmse = 0.172553
Epoch 36
Loss = 1.7006e-01, PNorm = 35.4174, GNorm = 1.9020, lr_0 = 2.3740e-04
Loss = 1.6072e-01, PNorm = 35.4230, GNorm = 1.4515, lr_0 = 2.3222e-04
Validation rmse = 0.174826
Epoch 37
Loss = 1.8823e-01, PNorm = 35.4314, GNorm = 5.1783, lr_0 = 2.2665e-04
Loss = 1.5313e-01, PNorm = 35.4391, GNorm = 2.1313, lr_0 = 2.2171e-04
Validation rmse = 0.169612
Epoch 38
Loss = 1.2579e-01, PNorm = 35.4448, GNorm = 1.4407, lr_0 = 2.1687e-04
Loss = 1.6409e-01, PNorm = 35.4514, GNorm = 2.0354, lr_0 = 2.1214e-04
Validation rmse = 0.174531
Epoch 39
Loss = 1.7109e-01, PNorm = 35.4585, GNorm = 2.4764, lr_0 = 2.0752e-04
Loss = 1.5848e-01, PNorm = 35.4649, GNorm = 1.0043, lr_0 = 2.0299e-04
Validation rmse = 0.169893
Epoch 40
Loss = 1.4739e-01, PNorm = 35.4710, GNorm = 3.3244, lr_0 = 1.9812e-04
Loss = 1.5366e-01, PNorm = 35.4762, GNorm = 3.5808, lr_0 = 1.9380e-04
Validation rmse = 0.171062
Epoch 41
Loss = 1.6684e-01, PNorm = 35.4808, GNorm = 2.5237, lr_0 = 1.8957e-04
Validation rmse = 0.170202
Epoch 42
Loss = 1.5650e-01, PNorm = 35.4884, GNorm = 1.3244, lr_0 = 1.8503e-04
Loss = 1.2514e-01, PNorm = 35.4936, GNorm = 1.4644, lr_0 = 1.8099e-04
Validation rmse = 0.166673
Epoch 43
Loss = 1.3587e-01, PNorm = 35.4988, GNorm = 1.2210, lr_0 = 1.7705e-04
Loss = 1.6548e-01, PNorm = 35.5059, GNorm = 1.6450, lr_0 = 1.7318e-04
Validation rmse = 0.171903
Epoch 44
Loss = 1.5771e-01, PNorm = 35.5116, GNorm = 1.4774, lr_0 = 1.6903e-04
Loss = 1.5412e-01, PNorm = 35.5165, GNorm = 1.9860, lr_0 = 1.6534e-04
Validation rmse = 0.175227
Epoch 45
Loss = 1.5600e-01, PNorm = 35.5213, GNorm = 2.3081, lr_0 = 1.6174e-04
Loss = 1.4099e-01, PNorm = 35.5256, GNorm = 2.0332, lr_0 = 1.5821e-04
Validation rmse = 0.168114
Epoch 46
Loss = 1.6001e-01, PNorm = 35.5311, GNorm = 1.5949, lr_0 = 1.5442e-04
Loss = 1.3666e-01, PNorm = 35.5358, GNorm = 0.6570, lr_0 = 1.5105e-04
Validation rmse = 0.171536
Epoch 47
Loss = 1.5533e-01, PNorm = 35.5420, GNorm = 0.9230, lr_0 = 1.4775e-04
Validation rmse = 0.168412
Epoch 48
Loss = 1.0025e-01, PNorm = 35.5471, GNorm = 0.7586, lr_0 = 1.4421e-04
Loss = 1.4819e-01, PNorm = 35.5509, GNorm = 0.9936, lr_0 = 1.4107e-04
Validation rmse = 0.168112
Epoch 49
Loss = 1.3042e-01, PNorm = 35.5544, GNorm = 1.4533, lr_0 = 1.3799e-04
Loss = 1.3450e-01, PNorm = 35.5590, GNorm = 0.9610, lr_0 = 1.3498e-04
Validation rmse = 0.169658
Epoch 50
Loss = 1.5290e-01, PNorm = 35.5637, GNorm = 1.9782, lr_0 = 1.3204e-04
Loss = 1.4919e-01, PNorm = 35.5685, GNorm = 0.9589, lr_0 = 1.2915e-04
Validation rmse = 0.166343
Epoch 51
Loss = 1.4657e-01, PNorm = 35.5721, GNorm = 1.7425, lr_0 = 1.2606e-04
Loss = 1.4245e-01, PNorm = 35.5760, GNorm = 0.9267, lr_0 = 1.2331e-04
Validation rmse = 0.167588
Epoch 52
Loss = 1.5932e-01, PNorm = 35.5795, GNorm = 0.9982, lr_0 = 1.2062e-04
Loss = 1.3571e-01, PNorm = 35.5840, GNorm = 2.7909, lr_0 = 1.1799e-04
Validation rmse = 0.169367
Epoch 53
Loss = 1.4665e-01, PNorm = 35.5880, GNorm = 2.0748, lr_0 = 1.1516e-04
Loss = 1.3260e-01, PNorm = 35.5912, GNorm = 1.3082, lr_0 = 1.1265e-04
Validation rmse = 0.168253
Epoch 54
Loss = 1.4721e-01, PNorm = 35.5945, GNorm = 1.2773, lr_0 = 1.1019e-04
Validation rmse = 0.166900
Epoch 55
Loss = 1.2795e-01, PNorm = 35.5986, GNorm = 0.9504, lr_0 = 1.0755e-04
Loss = 1.3542e-01, PNorm = 35.6017, GNorm = 2.1672, lr_0 = 1.0520e-04
Validation rmse = 0.173300
Epoch 56
Loss = 1.2818e-01, PNorm = 35.6044, GNorm = 1.1656, lr_0 = 1.0291e-04
Loss = 1.4070e-01, PNorm = 35.6083, GNorm = 1.5796, lr_0 = 1.0066e-04
Validation rmse = 0.168427
Epoch 57
Loss = 1.2905e-01, PNorm = 35.6126, GNorm = 0.6530, lr_0 = 1.0000e-04
Loss = 1.3634e-01, PNorm = 35.6154, GNorm = 1.1728, lr_0 = 1.0000e-04
Validation rmse = 0.169790
Epoch 58
Loss = 1.2176e-01, PNorm = 35.6186, GNorm = 0.9124, lr_0 = 1.0000e-04
Loss = 1.3292e-01, PNorm = 35.6212, GNorm = 1.6242, lr_0 = 1.0000e-04
Validation rmse = 0.168781
Epoch 59
Loss = 1.3544e-01, PNorm = 35.6254, GNorm = 1.7121, lr_0 = 1.0000e-04
Loss = 1.4507e-01, PNorm = 35.6292, GNorm = 1.4185, lr_0 = 1.0000e-04
Validation rmse = 0.167931
Model 0 best validation rmse = 0.166343 on epoch 50
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.256371
Ensemble test rmse = 0.256371
1-fold cross validation
	Seed 0 ==> test rmse = 0.256371
Overall test rmse = 0.256371 +/- 0.000000
Elapsed time = 0:00:42
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,157 | train size = 919 | val size = 232 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.0768e-01, PNorm = 34.0154, GNorm = 5.4822, lr_0 = 3.7500e-04
Validation rmse = 0.312220
Epoch 1
Loss = 7.5548e-01, PNorm = 34.0345, GNorm = 1.4126, lr_0 = 6.5000e-04
Loss = 6.9102e-01, PNorm = 34.0691, GNorm = 1.5806, lr_0 = 9.0000e-04
Validation rmse = 0.261002
Epoch 2
Loss = 5.6428e-01, PNorm = 34.1438, GNorm = 1.5207, lr_0 = 9.8468e-04
Loss = 5.3623e-01, PNorm = 34.2121, GNorm = 2.1069, lr_0 = 9.6320e-04
Validation rmse = 0.250141
Epoch 3
Loss = 4.6804e-01, PNorm = 34.2752, GNorm = 4.9584, lr_0 = 9.4219e-04
Loss = 4.6067e-01, PNorm = 34.3279, GNorm = 4.5014, lr_0 = 9.2164e-04
Validation rmse = 0.209556
Epoch 4
Loss = 3.5642e-01, PNorm = 34.3904, GNorm = 1.5527, lr_0 = 8.9955e-04
Loss = 3.5709e-01, PNorm = 34.4416, GNorm = 0.7593, lr_0 = 8.7992e-04
Validation rmse = 0.183596
Epoch 5
Loss = 3.2325e-01, PNorm = 34.5053, GNorm = 4.5062, lr_0 = 8.5883e-04
Loss = 2.8468e-01, PNorm = 34.5493, GNorm = 5.9695, lr_0 = 8.4010e-04
Validation rmse = 0.178034
Epoch 6
Loss = 2.6342e-01, PNorm = 34.5994, GNorm = 2.6989, lr_0 = 8.2177e-04
Validation rmse = 0.174210
Epoch 7
Loss = 2.1226e-01, PNorm = 34.6484, GNorm = 0.8130, lr_0 = 8.0207e-04
Loss = 2.1038e-01, PNorm = 34.6861, GNorm = 3.9629, lr_0 = 7.8458e-04
Validation rmse = 0.161557
Epoch 8
Loss = 2.2571e-01, PNorm = 34.7238, GNorm = 6.4522, lr_0 = 7.6746e-04
Loss = 2.0599e-01, PNorm = 34.7577, GNorm = 0.8096, lr_0 = 7.5072e-04
Validation rmse = 0.160682
Epoch 9
Loss = 2.1588e-01, PNorm = 34.7931, GNorm = 1.1573, lr_0 = 7.3273e-04
Loss = 2.0642e-01, PNorm = 34.8281, GNorm = 4.8842, lr_0 = 7.1674e-04
Validation rmse = 0.171869
Epoch 10
Loss = 2.2106e-01, PNorm = 34.8549, GNorm = 3.1532, lr_0 = 6.9956e-04
Loss = 2.1030e-01, PNorm = 34.8796, GNorm = 3.0689, lr_0 = 6.8430e-04
Validation rmse = 0.163503
Epoch 11
Loss = 2.1189e-01, PNorm = 34.9042, GNorm = 1.4757, lr_0 = 6.6938e-04
Loss = 2.1098e-01, PNorm = 34.9290, GNorm = 1.9694, lr_0 = 6.5477e-04
Loss = 1.1295e-01, PNorm = 34.9314, GNorm = 1.6980, lr_0 = 6.5333e-04
Validation rmse = 0.163398
Epoch 12
Loss = 2.0480e-01, PNorm = 34.9567, GNorm = 2.4670, lr_0 = 6.3908e-04
Validation rmse = 0.158670
Epoch 13
Loss = 1.6090e-01, PNorm = 34.9812, GNorm = 1.6362, lr_0 = 6.2376e-04
Loss = 1.6309e-01, PNorm = 35.0041, GNorm = 1.6705, lr_0 = 6.1016e-04
Validation rmse = 0.162389
Epoch 14
Loss = 2.1833e-01, PNorm = 35.0164, GNorm = 2.5703, lr_0 = 5.9685e-04
Loss = 1.9954e-01, PNorm = 35.0360, GNorm = 1.4889, lr_0 = 5.8383e-04
Validation rmse = 0.157705
Epoch 15
Loss = 1.5373e-01, PNorm = 35.0495, GNorm = 1.1830, lr_0 = 5.6983e-04
Loss = 1.7407e-01, PNorm = 35.0684, GNorm = 3.6277, lr_0 = 5.5740e-04
Validation rmse = 0.160941
Epoch 16
Loss = 1.8895e-01, PNorm = 35.0860, GNorm = 1.7690, lr_0 = 5.4524e-04
Loss = 1.6481e-01, PNorm = 35.1022, GNorm = 2.5677, lr_0 = 5.3335e-04
Validation rmse = 0.156010
Epoch 17
Loss = 1.5969e-01, PNorm = 35.1169, GNorm = 0.9255, lr_0 = 5.2057e-04
Loss = 1.7212e-01, PNorm = 35.1315, GNorm = 2.1431, lr_0 = 5.0921e-04
Loss = 2.0544e-01, PNorm = 35.1332, GNorm = 1.0974, lr_0 = 5.0809e-04
Validation rmse = 0.162206
Epoch 18
Loss = 1.4656e-01, PNorm = 35.1494, GNorm = 0.7182, lr_0 = 4.9700e-04
Validation rmse = 0.157308
Epoch 19
Loss = 1.5303e-01, PNorm = 35.1664, GNorm = 0.6943, lr_0 = 4.8616e-04
Loss = 1.4571e-01, PNorm = 35.1777, GNorm = 0.8286, lr_0 = 4.7556e-04
Validation rmse = 0.159797
Epoch 20
Loss = 1.4841e-01, PNorm = 35.1923, GNorm = 1.7902, lr_0 = 4.6416e-04
Loss = 1.6989e-01, PNorm = 35.2103, GNorm = 1.4417, lr_0 = 4.5403e-04
Validation rmse = 0.170011
Epoch 21
Loss = 1.6420e-01, PNorm = 35.2235, GNorm = 1.1419, lr_0 = 4.4315e-04
Loss = 1.6578e-01, PNorm = 35.2387, GNorm = 1.6993, lr_0 = 4.3348e-04
Validation rmse = 0.164587
Epoch 22
Loss = 1.5547e-01, PNorm = 35.2496, GNorm = 1.3313, lr_0 = 4.2403e-04
Loss = 1.4421e-01, PNorm = 35.2629, GNorm = 0.7860, lr_0 = 4.1478e-04
Validation rmse = 0.173219
Epoch 23
Loss = 1.6935e-01, PNorm = 35.2769, GNorm = 1.8801, lr_0 = 4.0484e-04
Loss = 1.5521e-01, PNorm = 35.2892, GNorm = 1.7459, lr_0 = 3.9601e-04
Validation rmse = 0.168429
Epoch 24
Loss = 1.5960e-01, PNorm = 35.3009, GNorm = 3.5930, lr_0 = 3.8737e-04
Validation rmse = 0.155130
Epoch 25
Loss = 1.4392e-01, PNorm = 35.3145, GNorm = 1.0575, lr_0 = 3.7808e-04
Loss = 1.5869e-01, PNorm = 35.3280, GNorm = 5.6465, lr_0 = 3.6983e-04
Validation rmse = 0.155931
Epoch 26
Loss = 1.3519e-01, PNorm = 35.3397, GNorm = 1.1316, lr_0 = 3.6097e-04
Loss = 1.4356e-01, PNorm = 35.3530, GNorm = 1.4487, lr_0 = 3.5310e-04
Validation rmse = 0.162192
Epoch 27
Loss = 1.1125e-01, PNorm = 35.3643, GNorm = 0.4256, lr_0 = 3.4539e-04
Loss = 1.3722e-01, PNorm = 35.3706, GNorm = 1.7145, lr_0 = 3.3786e-04
Validation rmse = 0.158389
Epoch 28
Loss = 1.3874e-01, PNorm = 35.3839, GNorm = 1.0626, lr_0 = 3.2976e-04
Loss = 1.4568e-01, PNorm = 35.3964, GNorm = 1.9725, lr_0 = 3.2257e-04
Validation rmse = 0.158308
Epoch 29
Loss = 1.5427e-01, PNorm = 35.4061, GNorm = 3.0958, lr_0 = 3.1553e-04
Loss = 1.3572e-01, PNorm = 35.4185, GNorm = 3.8220, lr_0 = 3.0865e-04
Validation rmse = 0.155945
Epoch 30
Loss = 1.1121e-01, PNorm = 35.4270, GNorm = 1.0756, lr_0 = 3.0125e-04
Validation rmse = 0.159445
Epoch 31
Loss = 1.1809e-01, PNorm = 35.4390, GNorm = 2.6236, lr_0 = 2.9403e-04
Loss = 1.3896e-01, PNorm = 35.4461, GNorm = 0.9268, lr_0 = 2.8762e-04
Validation rmse = 0.157810
Epoch 32
Loss = 1.3856e-01, PNorm = 35.4549, GNorm = 2.6042, lr_0 = 2.8134e-04
Loss = 1.5496e-01, PNorm = 35.4655, GNorm = 4.3866, lr_0 = 2.7520e-04
Validation rmse = 0.156849
Epoch 33
Loss = 1.4823e-01, PNorm = 35.4758, GNorm = 4.3917, lr_0 = 2.6861e-04
Loss = 1.3873e-01, PNorm = 35.4848, GNorm = 1.2892, lr_0 = 2.6275e-04
Validation rmse = 0.183299
Epoch 34
Loss = 1.5304e-01, PNorm = 35.4934, GNorm = 2.6496, lr_0 = 2.5645e-04
Loss = 1.3782e-01, PNorm = 35.5030, GNorm = 0.5869, lr_0 = 2.5086e-04
Validation rmse = 0.155614
Epoch 35
Loss = 1.1806e-01, PNorm = 35.5099, GNorm = 0.6573, lr_0 = 2.4538e-04
Loss = 1.3113e-01, PNorm = 35.5173, GNorm = 0.8793, lr_0 = 2.4003e-04
Validation rmse = 0.155904
Epoch 36
Loss = 1.3474e-01, PNorm = 35.5301, GNorm = 4.3032, lr_0 = 2.3428e-04
Loss = 1.2759e-01, PNorm = 35.5378, GNorm = 0.5058, lr_0 = 2.2917e-04
Validation rmse = 0.158556
Epoch 37
Loss = 1.2663e-01, PNorm = 35.5456, GNorm = 0.6350, lr_0 = 2.2417e-04
Validation rmse = 0.158259
Epoch 38
Loss = 1.3757e-01, PNorm = 35.5556, GNorm = 1.9224, lr_0 = 2.1880e-04
Loss = 1.3985e-01, PNorm = 35.5624, GNorm = 0.9907, lr_0 = 2.1402e-04
Validation rmse = 0.161167
Epoch 39
Loss = 1.1846e-01, PNorm = 35.5709, GNorm = 0.7106, lr_0 = 2.0889e-04
Loss = 1.1801e-01, PNorm = 35.5777, GNorm = 1.7005, lr_0 = 2.0434e-04
Validation rmse = 0.168030
Epoch 40
Loss = 1.4103e-01, PNorm = 35.5852, GNorm = 1.0909, lr_0 = 1.9988e-04
Loss = 1.2513e-01, PNorm = 35.5926, GNorm = 1.3157, lr_0 = 1.9552e-04
Validation rmse = 0.154176
Epoch 41
Loss = 1.2050e-01, PNorm = 35.6003, GNorm = 1.3894, lr_0 = 1.9083e-04
Loss = 1.2311e-01, PNorm = 35.6060, GNorm = 1.5472, lr_0 = 1.8667e-04
Validation rmse = 0.156085
Epoch 42
Loss = 1.2973e-01, PNorm = 35.6123, GNorm = 1.1537, lr_0 = 1.8219e-04
Loss = 1.0609e-01, PNorm = 35.6193, GNorm = 1.1563, lr_0 = 1.7822e-04
Validation rmse = 0.160833
Epoch 43
Loss = 1.1239e-01, PNorm = 35.6248, GNorm = 0.8627, lr_0 = 1.7433e-04
Validation rmse = 0.162137
Epoch 44
Loss = 1.4919e-01, PNorm = 35.6308, GNorm = 0.5847, lr_0 = 1.7015e-04
Loss = 1.1819e-01, PNorm = 35.6391, GNorm = 1.7028, lr_0 = 1.6644e-04
Validation rmse = 0.154717
Epoch 45
Loss = 9.7734e-02, PNorm = 35.6439, GNorm = 0.5584, lr_0 = 1.6281e-04
Loss = 1.1003e-01, PNorm = 35.6480, GNorm = 2.6850, lr_0 = 1.5926e-04
Validation rmse = 0.163646
Epoch 46
Loss = 1.0444e-01, PNorm = 35.6539, GNorm = 0.8830, lr_0 = 1.5544e-04
Loss = 1.2358e-01, PNorm = 35.6599, GNorm = 2.5490, lr_0 = 1.5205e-04
Validation rmse = 0.154766
Epoch 47
Loss = 1.1053e-01, PNorm = 35.6653, GNorm = 1.0536, lr_0 = 1.4841e-04
Loss = 1.1609e-01, PNorm = 35.6695, GNorm = 1.0372, lr_0 = 1.4517e-04
Validation rmse = 0.154652
Epoch 48
Loss = 1.1760e-01, PNorm = 35.6760, GNorm = 0.9803, lr_0 = 1.4200e-04
Loss = 1.0956e-01, PNorm = 35.6804, GNorm = 0.6611, lr_0 = 1.3891e-04
Loss = 1.3702e-01, PNorm = 35.6810, GNorm = 2.0874, lr_0 = 1.3860e-04
Validation rmse = 0.157634
Epoch 49
Loss = 1.1646e-01, PNorm = 35.6857, GNorm = 1.5160, lr_0 = 1.3558e-04
Validation rmse = 0.160026
Epoch 50
Loss = 1.1311e-01, PNorm = 35.6906, GNorm = 0.7852, lr_0 = 1.3262e-04
Loss = 1.0529e-01, PNorm = 35.6941, GNorm = 1.0610, lr_0 = 1.2973e-04
Validation rmse = 0.157102
Epoch 51
Loss = 9.4030e-02, PNorm = 35.6997, GNorm = 0.6518, lr_0 = 1.2662e-04
Loss = 1.0671e-01, PNorm = 35.7059, GNorm = 1.5968, lr_0 = 1.2385e-04
Validation rmse = 0.157424
Epoch 52
Loss = 1.1569e-01, PNorm = 35.7094, GNorm = 0.9264, lr_0 = 1.2089e-04
Loss = 1.1076e-01, PNorm = 35.7136, GNorm = 1.0179, lr_0 = 1.1825e-04
Validation rmse = 0.155566
Epoch 53
Loss = 1.2200e-01, PNorm = 35.7185, GNorm = 0.7944, lr_0 = 1.1567e-04
Loss = 9.8163e-02, PNorm = 35.7235, GNorm = 1.1906, lr_0 = 1.1315e-04
Validation rmse = 0.156688
Epoch 54
Loss = 1.1170e-01, PNorm = 35.7261, GNorm = 0.7443, lr_0 = 1.1043e-04
Loss = 1.0871e-01, PNorm = 35.7308, GNorm = 1.6181, lr_0 = 1.0803e-04
Loss = 1.4646e-01, PNorm = 35.7313, GNorm = 2.5524, lr_0 = 1.0779e-04
Validation rmse = 0.157179
Epoch 55
Loss = 1.0634e-01, PNorm = 35.7351, GNorm = 1.2878, lr_0 = 1.0544e-04
Validation rmse = 0.157044
Epoch 56
Loss = 1.4421e-01, PNorm = 35.7387, GNorm = 1.3483, lr_0 = 1.0314e-04
Loss = 1.1194e-01, PNorm = 35.7426, GNorm = 2.1789, lr_0 = 1.0089e-04
Validation rmse = 0.161305
Epoch 57
Loss = 1.2893e-01, PNorm = 35.7465, GNorm = 1.3933, lr_0 = 1.0000e-04
Loss = 1.0991e-01, PNorm = 35.7508, GNorm = 1.0693, lr_0 = 1.0000e-04
Validation rmse = 0.156554
Epoch 58
Loss = 1.1690e-01, PNorm = 35.7545, GNorm = 1.0374, lr_0 = 1.0000e-04
Loss = 1.0286e-01, PNorm = 35.7578, GNorm = 0.9414, lr_0 = 1.0000e-04
Validation rmse = 0.156314
Epoch 59
Loss = 9.1940e-02, PNorm = 35.7614, GNorm = 2.3447, lr_0 = 1.0000e-04
Loss = 1.1204e-01, PNorm = 35.7645, GNorm = 0.8358, lr_0 = 1.0000e-04
Validation rmse = 0.154686
Model 0 best validation rmse = 0.154176 on epoch 40
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.146681
Ensemble test rmse = 0.146681
1-fold cross validation
	Seed 0 ==> test rmse = 0.146681
Overall test rmse = 0.146681 +/- 0.000000
Elapsed time = 0:00:43
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,147 | train size = 911 | val size = 230 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1589e-01, PNorm = 34.0154, GNorm = 2.1870, lr_0 = 3.7500e-04
Validation rmse = 0.287701
Epoch 1
Loss = 5.8001e-01, PNorm = 34.0429, GNorm = 0.8128, lr_0 = 6.5000e-04
Loss = 6.7201e-01, PNorm = 34.0871, GNorm = 2.1713, lr_0 = 9.0000e-04
Validation rmse = 0.234150
Epoch 2
Loss = 5.2647e-01, PNorm = 34.1595, GNorm = 9.4825, lr_0 = 9.8468e-04
Loss = 4.7228e-01, PNorm = 34.2327, GNorm = 3.3047, lr_0 = 9.6320e-04
Validation rmse = 0.232231
Epoch 3
Loss = 4.4274e-01, PNorm = 34.2983, GNorm = 1.3649, lr_0 = 9.4011e-04
Loss = 4.0442e-01, PNorm = 34.3501, GNorm = 5.1955, lr_0 = 9.1961e-04
Validation rmse = 0.211457
Epoch 4
Loss = 3.4413e-01, PNorm = 34.4126, GNorm = 4.1643, lr_0 = 8.9756e-04
Loss = 2.7787e-01, PNorm = 34.4628, GNorm = 2.4555, lr_0 = 8.7798e-04
Validation rmse = 0.187909
Epoch 5
Loss = 2.7076e-01, PNorm = 34.5085, GNorm = 2.5921, lr_0 = 8.5883e-04
Validation rmse = 0.204963
Epoch 6
Loss = 2.5259e-01, PNorm = 34.5500, GNorm = 5.6318, lr_0 = 8.3825e-04
Loss = 2.4279e-01, PNorm = 34.5886, GNorm = 0.8013, lr_0 = 8.1996e-04
Validation rmse = 0.187389
Epoch 7
Loss = 2.0961e-01, PNorm = 34.6279, GNorm = 3.8389, lr_0 = 8.0031e-04
Loss = 2.1672e-01, PNorm = 34.6611, GNorm = 4.4614, lr_0 = 7.8285e-04
Validation rmse = 0.168146
Epoch 8
Loss = 2.1574e-01, PNorm = 34.6984, GNorm = 2.7946, lr_0 = 7.6409e-04
Loss = 1.9510e-01, PNorm = 34.7332, GNorm = 1.9483, lr_0 = 7.4742e-04
Validation rmse = 0.180797
Epoch 9
Loss = 2.4520e-01, PNorm = 34.7663, GNorm = 4.7250, lr_0 = 7.2950e-04
Loss = 2.7101e-01, PNorm = 34.7972, GNorm = 3.7376, lr_0 = 7.1359e-04
Validation rmse = 0.243130
Epoch 10
Loss = 3.2899e-01, PNorm = 34.8324, GNorm = 2.5973, lr_0 = 6.9802e-04
Loss = 2.0397e-01, PNorm = 34.8600, GNorm = 1.0157, lr_0 = 6.8280e-04
Loss = 2.0291e-01, PNorm = 34.8618, GNorm = 1.3696, lr_0 = 6.8129e-04
Validation rmse = 0.170797
Epoch 11
Loss = 1.8750e-01, PNorm = 34.8836, GNorm = 1.8581, lr_0 = 6.6643e-04
Validation rmse = 0.157821
Epoch 12
Loss = 1.5322e-01, PNorm = 34.9088, GNorm = 0.5393, lr_0 = 6.5046e-04
Loss = 1.8112e-01, PNorm = 34.9300, GNorm = 3.9575, lr_0 = 6.3627e-04
Validation rmse = 0.172680
Epoch 13
Loss = 1.4671e-01, PNorm = 34.9531, GNorm = 1.1051, lr_0 = 6.2102e-04
Loss = 1.6556e-01, PNorm = 34.9676, GNorm = 4.3523, lr_0 = 6.0747e-04
Validation rmse = 0.171666
Epoch 14
Loss = 1.7800e-01, PNorm = 34.9904, GNorm = 1.1151, lr_0 = 5.9422e-04
Loss = 1.6263e-01, PNorm = 35.0095, GNorm = 2.4273, lr_0 = 5.8126e-04
Validation rmse = 0.187544
Epoch 15
Loss = 1.9798e-01, PNorm = 35.0274, GNorm = 3.5771, lr_0 = 5.6732e-04
Loss = 1.5772e-01, PNorm = 35.0456, GNorm = 1.1927, lr_0 = 5.5495e-04
Validation rmse = 0.152886
Epoch 16
Loss = 1.5029e-01, PNorm = 35.0623, GNorm = 1.8123, lr_0 = 5.4165e-04
Validation rmse = 0.165920
Epoch 17
Loss = 1.5170e-01, PNorm = 35.0792, GNorm = 0.9600, lr_0 = 5.2866e-04
Loss = 1.6911e-01, PNorm = 35.0895, GNorm = 2.6016, lr_0 = 5.1713e-04
Validation rmse = 0.162207
Epoch 18
Loss = 1.4622e-01, PNorm = 35.1034, GNorm = 0.7687, lr_0 = 5.0474e-04
Loss = 1.5972e-01, PNorm = 35.1214, GNorm = 3.1099, lr_0 = 4.9373e-04
Validation rmse = 0.149507
Epoch 19
Loss = 1.4906e-01, PNorm = 35.1328, GNorm = 0.9368, lr_0 = 4.8296e-04
Loss = 1.3951e-01, PNorm = 35.1526, GNorm = 0.9158, lr_0 = 4.7242e-04
Validation rmse = 0.157117
Epoch 20
Loss = 1.3452e-01, PNorm = 35.1605, GNorm = 1.5412, lr_0 = 4.6110e-04
Loss = 1.4604e-01, PNorm = 35.1711, GNorm = 4.9647, lr_0 = 4.5104e-04
Validation rmse = 0.174750
Epoch 21
Loss = 1.4414e-01, PNorm = 35.1873, GNorm = 0.8105, lr_0 = 4.4023e-04
Loss = 1.3674e-01, PNorm = 35.2008, GNorm = 1.0509, lr_0 = 4.3063e-04
Loss = 1.6260e-01, PNorm = 35.2013, GNorm = 4.6101, lr_0 = 4.2968e-04
Validation rmse = 0.153891
Epoch 22
Loss = 1.4179e-01, PNorm = 35.2109, GNorm = 2.1394, lr_0 = 4.2030e-04
Validation rmse = 0.153284
Epoch 23
Loss = 2.0895e-01, PNorm = 35.2200, GNorm = 3.8500, lr_0 = 4.1114e-04
Loss = 1.4864e-01, PNorm = 35.2300, GNorm = 2.7466, lr_0 = 4.0217e-04
Validation rmse = 0.152001
Epoch 24
Loss = 1.7283e-01, PNorm = 35.2428, GNorm = 4.1395, lr_0 = 3.9253e-04
Loss = 1.4065e-01, PNorm = 35.2546, GNorm = 4.2256, lr_0 = 3.8396e-04
Validation rmse = 0.170575
Epoch 25
Loss = 1.2108e-01, PNorm = 35.2677, GNorm = 1.8244, lr_0 = 3.7476e-04
Loss = 1.5048e-01, PNorm = 35.2769, GNorm = 1.1931, lr_0 = 3.6659e-04
Validation rmse = 0.152832
Epoch 26
Loss = 1.3582e-01, PNorm = 35.2896, GNorm = 0.8242, lr_0 = 3.5780e-04
Loss = 1.4975e-01, PNorm = 35.3001, GNorm = 1.1297, lr_0 = 3.4999e-04
Validation rmse = 0.155282
Epoch 27
Loss = 1.4830e-01, PNorm = 35.3103, GNorm = 2.6274, lr_0 = 3.4161e-04
Loss = 1.1910e-01, PNorm = 35.3218, GNorm = 2.5979, lr_0 = 3.3415e-04
Validation rmse = 0.155756
Epoch 28
Loss = 1.3621e-01, PNorm = 35.3276, GNorm = 0.5902, lr_0 = 3.2686e-04
Validation rmse = 0.155482
Epoch 29
Loss = 1.3931e-01, PNorm = 35.3400, GNorm = 0.8035, lr_0 = 3.1903e-04
Loss = 1.2410e-01, PNorm = 35.3484, GNorm = 1.2655, lr_0 = 3.1207e-04
Validation rmse = 0.151566
Epoch 30
Loss = 1.1544e-01, PNorm = 35.3562, GNorm = 0.6012, lr_0 = 3.0459e-04
Loss = 1.1299e-01, PNorm = 35.3650, GNorm = 0.9096, lr_0 = 2.9795e-04
Validation rmse = 0.163930
Epoch 31
Loss = 1.2266e-01, PNorm = 35.3722, GNorm = 0.6374, lr_0 = 2.9080e-04
Loss = 1.2670e-01, PNorm = 35.3800, GNorm = 3.1930, lr_0 = 2.8446e-04
Validation rmse = 0.151051
Epoch 32
Loss = 1.1872e-01, PNorm = 35.3881, GNorm = 1.2659, lr_0 = 2.7826e-04
Loss = 1.1772e-01, PNorm = 35.3962, GNorm = 0.4586, lr_0 = 2.7219e-04
Validation rmse = 0.156184
Epoch 33
Loss = 1.3227e-01, PNorm = 35.4042, GNorm = 1.9723, lr_0 = 2.6566e-04
Validation rmse = 0.149365
Epoch 34
Loss = 1.1810e-01, PNorm = 35.4136, GNorm = 0.5986, lr_0 = 2.5929e-04
Loss = 1.1418e-01, PNorm = 35.4212, GNorm = 0.7710, lr_0 = 2.5364e-04
Validation rmse = 0.152635
Epoch 35
Loss = 1.1156e-01, PNorm = 35.4297, GNorm = 0.6795, lr_0 = 2.4756e-04
Loss = 1.2236e-01, PNorm = 35.4364, GNorm = 0.7986, lr_0 = 2.4216e-04
Validation rmse = 0.148896
Epoch 36
Loss = 1.2098e-01, PNorm = 35.4427, GNorm = 1.1708, lr_0 = 2.3635e-04
Loss = 1.1661e-01, PNorm = 35.4484, GNorm = 1.1261, lr_0 = 2.3120e-04
Validation rmse = 0.150435
Epoch 37
Loss = 1.0663e-01, PNorm = 35.4545, GNorm = 0.5529, lr_0 = 2.2615e-04
Loss = 1.2444e-01, PNorm = 35.4627, GNorm = 1.1085, lr_0 = 2.2122e-04
Validation rmse = 0.150192
Epoch 38
Loss = 1.0248e-01, PNorm = 35.4676, GNorm = 1.7589, lr_0 = 2.1592e-04
Loss = 1.2998e-01, PNorm = 35.4747, GNorm = 1.6847, lr_0 = 2.1121e-04
Loss = 8.0921e-02, PNorm = 35.4758, GNorm = 2.8504, lr_0 = 2.1074e-04
Validation rmse = 0.151988
Epoch 39
Loss = 1.1558e-01, PNorm = 35.4815, GNorm = 1.8610, lr_0 = 2.0615e-04
Validation rmse = 0.151122
Epoch 40
Loss = 8.6503e-02, PNorm = 35.4887, GNorm = 1.1033, lr_0 = 2.0121e-04
Loss = 1.1792e-01, PNorm = 35.4951, GNorm = 0.5427, lr_0 = 1.9682e-04
Validation rmse = 0.150584
Epoch 41
Loss = 9.7462e-02, PNorm = 35.5009, GNorm = 1.7084, lr_0 = 1.9252e-04
Loss = 1.1877e-01, PNorm = 35.5064, GNorm = 0.8900, lr_0 = 1.8832e-04
Validation rmse = 0.151057
Epoch 42
Loss = 1.1971e-01, PNorm = 35.5130, GNorm = 0.6484, lr_0 = 1.8381e-04
Loss = 1.0040e-01, PNorm = 35.5179, GNorm = 0.6901, lr_0 = 1.7980e-04
Validation rmse = 0.151846
Epoch 43
Loss = 1.1899e-01, PNorm = 35.5241, GNorm = 0.7368, lr_0 = 1.7549e-04
Loss = 1.1436e-01, PNorm = 35.5301, GNorm = 0.7571, lr_0 = 1.7166e-04
Validation rmse = 0.149392
Epoch 44
Loss = 1.0008e-01, PNorm = 35.5353, GNorm = 0.6355, lr_0 = 1.6755e-04
Validation rmse = 0.149899
Epoch 45
Loss = 1.5343e-01, PNorm = 35.5399, GNorm = 1.3675, lr_0 = 1.6353e-04
Loss = 1.0559e-01, PNorm = 35.5439, GNorm = 1.9891, lr_0 = 1.5996e-04
Validation rmse = 0.153441
Epoch 46
Loss = 1.1520e-01, PNorm = 35.5489, GNorm = 1.8355, lr_0 = 1.5647e-04
Loss = 1.1741e-01, PNorm = 35.5540, GNorm = 2.2474, lr_0 = 1.5306e-04
Validation rmse = 0.154725
Epoch 47
Loss = 1.1385e-01, PNorm = 35.5582, GNorm = 0.9359, lr_0 = 1.4939e-04
Loss = 1.0282e-01, PNorm = 35.5616, GNorm = 0.4857, lr_0 = 1.4613e-04
Validation rmse = 0.151057
Epoch 48
Loss = 9.8026e-02, PNorm = 35.5679, GNorm = 0.7851, lr_0 = 1.4263e-04
Loss = 1.1624e-01, PNorm = 35.5720, GNorm = 1.0145, lr_0 = 1.3952e-04
Validation rmse = 0.149611
Epoch 49
Loss = 9.9767e-02, PNorm = 35.5760, GNorm = 1.4921, lr_0 = 1.3618e-04
Loss = 1.1292e-01, PNorm = 35.5811, GNorm = 1.3393, lr_0 = 1.3321e-04
Validation rmse = 0.149986
Epoch 50
Loss = 1.1249e-01, PNorm = 35.5834, GNorm = 0.7170, lr_0 = 1.3030e-04
Validation rmse = 0.148810
Epoch 51
Loss = 8.2901e-02, PNorm = 35.5875, GNorm = 0.7225, lr_0 = 1.2718e-04
Loss = 1.1883e-01, PNorm = 35.5910, GNorm = 1.5291, lr_0 = 1.2440e-04
Validation rmse = 0.150007
Epoch 52
Loss = 1.0630e-01, PNorm = 35.5959, GNorm = 1.1894, lr_0 = 1.2142e-04
Loss = 1.0493e-01, PNorm = 35.5996, GNorm = 1.3871, lr_0 = 1.1877e-04
Validation rmse = 0.150069
Epoch 53
Loss = 9.3271e-02, PNorm = 35.6026, GNorm = 0.6186, lr_0 = 1.1592e-04
Loss = 1.0969e-01, PNorm = 35.6065, GNorm = 1.3562, lr_0 = 1.1340e-04
Validation rmse = 0.148792
Epoch 54
Loss = 1.0433e-01, PNorm = 35.6093, GNorm = 2.3514, lr_0 = 1.1068e-04
Loss = 1.0623e-01, PNorm = 35.6125, GNorm = 0.7950, lr_0 = 1.0826e-04
Validation rmse = 0.153618
Epoch 55
Loss = 9.6307e-02, PNorm = 35.6157, GNorm = 0.9168, lr_0 = 1.0590e-04
Loss = 1.0677e-01, PNorm = 35.6186, GNorm = 1.8558, lr_0 = 1.0359e-04
Loss = 1.7515e-01, PNorm = 35.6189, GNorm = 1.3831, lr_0 = 1.0336e-04
Validation rmse = 0.150763
Epoch 56
Loss = 1.0050e-01, PNorm = 35.6228, GNorm = 0.9712, lr_0 = 1.0111e-04
Validation rmse = 0.152896
Epoch 57
Loss = 1.1432e-01, PNorm = 35.6251, GNorm = 1.8192, lr_0 = 1.0000e-04
Loss = 1.0509e-01, PNorm = 35.6286, GNorm = 1.8098, lr_0 = 1.0000e-04
Validation rmse = 0.148851
Epoch 58
Loss = 9.6949e-02, PNorm = 35.6322, GNorm = 1.1980, lr_0 = 1.0000e-04
Loss = 1.0377e-01, PNorm = 35.6346, GNorm = 1.0001, lr_0 = 1.0000e-04
Validation rmse = 0.148957
Epoch 59
Loss = 1.1701e-01, PNorm = 35.6389, GNorm = 0.8622, lr_0 = 1.0000e-04
Loss = 9.9530e-02, PNorm = 35.6425, GNorm = 1.7618, lr_0 = 1.0000e-04
Validation rmse = 0.150291
Model 0 best validation rmse = 0.148792 on epoch 53
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.125836
Ensemble test rmse = 0.125836
1-fold cross validation
	Seed 0 ==> test rmse = 0.125836
Overall test rmse = 0.125836 +/- 0.000000
Elapsed time = 0:00:43
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,137 | train size = 903 | val size = 228 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.9338e-01, PNorm = 34.0154, GNorm = 1.9119, lr_0 = 3.7500e-04
Validation rmse = 0.301230
Epoch 1
Loss = 6.8999e-01, PNorm = 34.0385, GNorm = 7.4830, lr_0 = 6.5000e-04
Loss = 7.4802e-01, PNorm = 34.0724, GNorm = 3.3466, lr_0 = 9.0000e-04
Validation rmse = 0.284289
Epoch 2
Loss = 6.4388e-01, PNorm = 34.1345, GNorm = 3.7739, lr_0 = 9.8468e-04
Loss = 5.0750e-01, PNorm = 34.2103, GNorm = 4.6202, lr_0 = 9.6320e-04
Validation rmse = 0.261895
Epoch 3
Loss = 4.9841e-01, PNorm = 34.2694, GNorm = 7.8665, lr_0 = 9.4011e-04
Loss = 3.6534e-01, PNorm = 34.3264, GNorm = 1.1929, lr_0 = 9.1961e-04
Validation rmse = 0.212212
Epoch 4
Loss = 3.4662e-01, PNorm = 34.3934, GNorm = 1.2547, lr_0 = 8.9756e-04
Loss = 3.0393e-01, PNorm = 34.4451, GNorm = 2.8031, lr_0 = 8.7798e-04
Loss = 1.0592e-02, PNorm = 34.4502, GNorm = 1.7912, lr_0 = 8.7605e-04
Validation rmse = 0.219362
Epoch 5
Loss = 3.1532e-01, PNorm = 34.4949, GNorm = 1.0626, lr_0 = 8.5694e-04
Validation rmse = 0.186621
Epoch 6
Loss = 2.4749e-01, PNorm = 34.5418, GNorm = 1.5452, lr_0 = 8.3640e-04
Loss = 2.3371e-01, PNorm = 34.5850, GNorm = 6.6021, lr_0 = 8.1815e-04
Validation rmse = 0.191178
Epoch 7
Loss = 2.3130e-01, PNorm = 34.6266, GNorm = 5.4467, lr_0 = 7.9854e-04
Loss = 2.1806e-01, PNorm = 34.6654, GNorm = 1.9042, lr_0 = 7.8112e-04
Validation rmse = 0.163177
Epoch 8
Loss = 2.5090e-01, PNorm = 34.6921, GNorm = 1.5321, lr_0 = 7.6240e-04
Loss = 2.0493e-01, PNorm = 34.7197, GNorm = 0.8355, lr_0 = 7.4577e-04
Validation rmse = 0.164358
Epoch 9
Loss = 1.6984e-01, PNorm = 34.7531, GNorm = 0.8077, lr_0 = 7.2790e-04
Loss = 1.9884e-01, PNorm = 34.7800, GNorm = 2.2362, lr_0 = 7.1202e-04
Loss = 7.1293e-02, PNorm = 34.7830, GNorm = 4.7842, lr_0 = 7.1045e-04
Validation rmse = 0.157497
Epoch 10
Loss = 1.7324e-01, PNorm = 34.8173, GNorm = 3.3711, lr_0 = 6.9495e-04
Validation rmse = 0.175899
Epoch 11
Loss = 2.5300e-01, PNorm = 34.8388, GNorm = 4.7830, lr_0 = 6.7829e-04
Loss = 1.9073e-01, PNorm = 34.8644, GNorm = 3.2557, lr_0 = 6.6350e-04
Validation rmse = 0.159377
Epoch 12
Loss = 1.7102e-01, PNorm = 34.8883, GNorm = 1.4114, lr_0 = 6.4759e-04
Loss = 1.8028e-01, PNorm = 34.9114, GNorm = 0.6314, lr_0 = 6.3347e-04
Validation rmse = 0.153825
Epoch 13
Loss = 1.5628e-01, PNorm = 34.9382, GNorm = 2.8058, lr_0 = 6.1828e-04
Loss = 1.4769e-01, PNorm = 34.9575, GNorm = 1.0327, lr_0 = 6.0480e-04
Validation rmse = 0.183088
Epoch 14
Loss = 2.5511e-01, PNorm = 34.9682, GNorm = 2.4475, lr_0 = 5.9030e-04
Loss = 2.0104e-01, PNorm = 34.9881, GNorm = 2.3897, lr_0 = 5.7742e-04
Loss = 7.8961e-02, PNorm = 34.9905, GNorm = 3.1085, lr_0 = 5.7615e-04
Validation rmse = 0.178638
Epoch 15
Loss = 1.7773e-01, PNorm = 35.0166, GNorm = 2.3796, lr_0 = 5.6358e-04
Validation rmse = 0.149833
Epoch 16
Loss = 1.3059e-01, PNorm = 35.0396, GNorm = 1.7587, lr_0 = 5.5007e-04
Loss = 1.6049e-01, PNorm = 35.0605, GNorm = 2.0310, lr_0 = 5.3808e-04
Validation rmse = 0.157252
Epoch 17
Loss = 1.4848e-01, PNorm = 35.0754, GNorm = 0.5144, lr_0 = 5.2634e-04
Loss = 1.4359e-01, PNorm = 35.0892, GNorm = 1.0763, lr_0 = 5.1486e-04
Validation rmse = 0.143515
Epoch 18
Loss = 1.4565e-01, PNorm = 35.1036, GNorm = 0.8529, lr_0 = 5.0252e-04
Loss = 1.3905e-01, PNorm = 35.1201, GNorm = 0.7992, lr_0 = 4.9155e-04
Validation rmse = 0.163379
Epoch 19
Loss = 1.9070e-01, PNorm = 35.1349, GNorm = 5.1786, lr_0 = 4.7977e-04
Loss = 1.8379e-01, PNorm = 35.1517, GNorm = 2.8217, lr_0 = 4.6931e-04
Validation rmse = 0.142671
Epoch 20
Loss = 1.6673e-01, PNorm = 35.1636, GNorm = 3.8837, lr_0 = 4.5806e-04
Validation rmse = 0.144433
Epoch 21
Loss = 1.7328e-01, PNorm = 35.1792, GNorm = 2.5428, lr_0 = 4.4708e-04
Loss = 1.3348e-01, PNorm = 35.1897, GNorm = 0.7284, lr_0 = 4.3733e-04
Validation rmse = 0.144529
Epoch 22
Loss = 1.0467e-01, PNorm = 35.2065, GNorm = 2.8164, lr_0 = 4.2684e-04
Loss = 1.6320e-01, PNorm = 35.2189, GNorm = 3.3216, lr_0 = 4.1753e-04
Validation rmse = 0.151445
Epoch 23
Loss = 1.1807e-01, PNorm = 35.2312, GNorm = 0.9113, lr_0 = 4.0752e-04
Loss = 1.3384e-01, PNorm = 35.2419, GNorm = 4.3235, lr_0 = 3.9863e-04
Validation rmse = 0.148497
Epoch 24
Loss = 1.3289e-01, PNorm = 35.2506, GNorm = 1.9641, lr_0 = 3.8908e-04
Loss = 1.2446e-01, PNorm = 35.2615, GNorm = 1.5194, lr_0 = 3.8059e-04
Validation rmse = 0.143207
Epoch 25
Loss = 1.3422e-01, PNorm = 35.2735, GNorm = 2.0930, lr_0 = 3.7147e-04
Validation rmse = 0.149231
Epoch 26
Loss = 8.0782e-02, PNorm = 35.2861, GNorm = 0.8693, lr_0 = 3.6257e-04
Loss = 1.1907e-01, PNorm = 35.2931, GNorm = 0.9399, lr_0 = 3.5466e-04
Validation rmse = 0.152987
Epoch 27
Loss = 1.2561e-01, PNorm = 35.3026, GNorm = 2.8763, lr_0 = 3.4616e-04
Loss = 1.2546e-01, PNorm = 35.3150, GNorm = 0.7461, lr_0 = 3.3861e-04
Validation rmse = 0.159118
Epoch 28
Loss = 1.2755e-01, PNorm = 35.3270, GNorm = 1.1788, lr_0 = 3.3049e-04
Loss = 1.2324e-01, PNorm = 35.3387, GNorm = 0.4958, lr_0 = 3.2328e-04
Validation rmse = 0.155541
Epoch 29
Loss = 1.5665e-01, PNorm = 35.3509, GNorm = 4.6716, lr_0 = 3.1553e-04
Loss = 1.1788e-01, PNorm = 35.3592, GNorm = 0.5575, lr_0 = 3.0865e-04
Validation rmse = 0.165603
Epoch 30
Loss = 1.3745e-01, PNorm = 35.3688, GNorm = 2.1306, lr_0 = 3.0125e-04
Validation rmse = 0.143587
Epoch 31
Loss = 8.9798e-02, PNorm = 35.3783, GNorm = 0.7121, lr_0 = 2.9403e-04
Loss = 1.1600e-01, PNorm = 35.3871, GNorm = 1.8490, lr_0 = 2.8762e-04
Validation rmse = 0.146177
Epoch 32
Loss = 1.5629e-01, PNorm = 35.3982, GNorm = 5.2055, lr_0 = 2.8072e-04
Loss = 1.3036e-01, PNorm = 35.4097, GNorm = 1.7543, lr_0 = 2.7460e-04
Validation rmse = 0.156075
Epoch 33
Loss = 1.3735e-01, PNorm = 35.4220, GNorm = 2.0388, lr_0 = 2.6802e-04
Loss = 1.3189e-01, PNorm = 35.4305, GNorm = 1.8122, lr_0 = 2.6217e-04
Validation rmse = 0.147162
Epoch 34
Loss = 1.1365e-01, PNorm = 35.4374, GNorm = 1.1910, lr_0 = 2.5645e-04
Loss = 1.1849e-01, PNorm = 35.4442, GNorm = 0.6490, lr_0 = 2.5086e-04
Validation rmse = 0.145221
Epoch 35
Loss = 1.0836e-01, PNorm = 35.4517, GNorm = 0.6153, lr_0 = 2.4484e-04
Loss = 1.1794e-01, PNorm = 35.4584, GNorm = 0.8627, lr_0 = 2.3950e-04
Loss = 8.3279e-02, PNorm = 35.4593, GNorm = 2.7158, lr_0 = 2.3898e-04
Validation rmse = 0.150772
Epoch 36
Loss = 1.0911e-01, PNorm = 35.4660, GNorm = 0.9821, lr_0 = 2.3376e-04
Validation rmse = 0.146955
Epoch 37
Loss = 1.0322e-01, PNorm = 35.4723, GNorm = 0.7976, lr_0 = 2.2816e-04
Loss = 1.1619e-01, PNorm = 35.4784, GNorm = 0.5965, lr_0 = 2.2318e-04
Validation rmse = 0.145709
Epoch 38
Loss = 9.0838e-02, PNorm = 35.4846, GNorm = 1.2012, lr_0 = 2.1783e-04
Loss = 1.1501e-01, PNorm = 35.4894, GNorm = 1.1258, lr_0 = 2.1308e-04
Validation rmse = 0.143547
Epoch 39
Loss = 1.2527e-01, PNorm = 35.4965, GNorm = 2.0775, lr_0 = 2.0797e-04
Loss = 1.1226e-01, PNorm = 35.5035, GNorm = 1.1765, lr_0 = 2.0344e-04
Validation rmse = 0.146628
Epoch 40
Loss = 1.1939e-01, PNorm = 35.5083, GNorm = 0.7547, lr_0 = 1.9856e-04
Loss = 1.0374e-01, PNorm = 35.5142, GNorm = 1.0297, lr_0 = 1.9423e-04
Loss = 7.9340e-02, PNorm = 35.5147, GNorm = 3.6391, lr_0 = 1.9380e-04
Validation rmse = 0.144791
Epoch 41
Loss = 1.0715e-01, PNorm = 35.5204, GNorm = 1.5391, lr_0 = 1.8957e-04
Validation rmse = 0.142826
Epoch 42
Loss = 1.1155e-01, PNorm = 35.5254, GNorm = 0.9092, lr_0 = 1.8503e-04
Loss = 1.1658e-01, PNorm = 35.5315, GNorm = 2.7743, lr_0 = 1.8099e-04
Validation rmse = 0.142315
Epoch 43
Loss = 1.0891e-01, PNorm = 35.5360, GNorm = 0.7516, lr_0 = 1.7666e-04
Loss = 1.0492e-01, PNorm = 35.5405, GNorm = 0.6273, lr_0 = 1.7280e-04
Validation rmse = 0.144905
Epoch 44
Loss = 9.9343e-02, PNorm = 35.5459, GNorm = 1.0812, lr_0 = 1.6866e-04
Loss = 1.0646e-01, PNorm = 35.5506, GNorm = 1.0459, lr_0 = 1.6498e-04
Validation rmse = 0.143696
Epoch 45
Loss = 1.0242e-01, PNorm = 35.5571, GNorm = 0.5785, lr_0 = 1.6103e-04
Loss = 1.0850e-01, PNorm = 35.5615, GNorm = 0.5911, lr_0 = 1.5751e-04
Loss = 3.2986e-02, PNorm = 35.5620, GNorm = 1.6598, lr_0 = 1.5717e-04
Validation rmse = 0.145974
Epoch 46
Loss = 1.0630e-01, PNorm = 35.5679, GNorm = 0.8018, lr_0 = 1.5374e-04
Validation rmse = 0.143343
Epoch 47
Loss = 8.8247e-02, PNorm = 35.5723, GNorm = 0.5450, lr_0 = 1.5005e-04
Loss = 1.0871e-01, PNorm = 35.5763, GNorm = 1.4161, lr_0 = 1.4678e-04
Validation rmse = 0.144397
Epoch 48
Loss = 1.0386e-01, PNorm = 35.5803, GNorm = 1.5080, lr_0 = 1.4326e-04
Loss = 1.0702e-01, PNorm = 35.5833, GNorm = 1.8481, lr_0 = 1.4014e-04
Validation rmse = 0.143433
Epoch 49
Loss = 1.0666e-01, PNorm = 35.5886, GNorm = 1.2361, lr_0 = 1.3678e-04
Loss = 9.6406e-02, PNorm = 35.5916, GNorm = 1.5251, lr_0 = 1.3379e-04
Validation rmse = 0.146034
Epoch 50
Loss = 1.1739e-01, PNorm = 35.5974, GNorm = 1.1873, lr_0 = 1.3088e-04
Loss = 9.4784e-02, PNorm = 35.6008, GNorm = 0.6118, lr_0 = 1.2802e-04
Validation rmse = 0.144492
Epoch 51
Loss = 1.0431e-01, PNorm = 35.6045, GNorm = 2.3824, lr_0 = 1.2495e-04
Validation rmse = 0.144440
Epoch 52
Loss = 1.0225e-01, PNorm = 35.6101, GNorm = 0.7719, lr_0 = 1.2196e-04
Loss = 1.0401e-01, PNorm = 35.6141, GNorm = 0.9758, lr_0 = 1.1930e-04
Validation rmse = 0.145949
Epoch 53
Loss = 1.1470e-01, PNorm = 35.6176, GNorm = 2.1394, lr_0 = 1.1644e-04
Loss = 9.0703e-02, PNorm = 35.6196, GNorm = 0.5363, lr_0 = 1.1390e-04
Validation rmse = 0.143579
Epoch 54
Loss = 9.8926e-02, PNorm = 35.6245, GNorm = 1.6465, lr_0 = 1.1117e-04
Loss = 8.7739e-02, PNorm = 35.6272, GNorm = 1.2161, lr_0 = 1.0874e-04
Validation rmse = 0.148505
Epoch 55
Loss = 1.0170e-01, PNorm = 35.6290, GNorm = 2.0177, lr_0 = 1.0614e-04
Loss = 1.1427e-01, PNorm = 35.6335, GNorm = 0.6534, lr_0 = 1.0382e-04
Validation rmse = 0.144469
Epoch 56
Loss = 1.0563e-01, PNorm = 35.6372, GNorm = 1.0248, lr_0 = 1.0133e-04
Validation rmse = 0.144509
Epoch 57
Loss = 8.4459e-02, PNorm = 35.6398, GNorm = 1.2623, lr_0 = 1.0000e-04
Loss = 1.0250e-01, PNorm = 35.6426, GNorm = 0.8122, lr_0 = 1.0000e-04
Validation rmse = 0.143393
Epoch 58
Loss = 1.0247e-01, PNorm = 35.6464, GNorm = 1.2629, lr_0 = 1.0000e-04
Loss = 9.3632e-02, PNorm = 35.6501, GNorm = 1.3564, lr_0 = 1.0000e-04
Validation rmse = 0.145069
Epoch 59
Loss = 9.6671e-02, PNorm = 35.6532, GNorm = 0.6163, lr_0 = 1.0000e-04
Loss = 9.4893e-02, PNorm = 35.6559, GNorm = 1.0661, lr_0 = 1.0000e-04
Validation rmse = 0.144680
Model 0 best validation rmse = 0.142315 on epoch 42
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.104105
Ensemble test rmse = 0.104105
1-fold cross validation
	Seed 0 ==> test rmse = 0.104105
Overall test rmse = 0.104105 +/- 0.000000
Elapsed time = 0:00:44
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,127 | train size = 895 | val size = 226 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.3673e-01, PNorm = 34.0158, GNorm = 2.1343, lr_0 = 3.9118e-04
Validation rmse = 0.296777
Epoch 1
Loss = 6.1014e-01, PNorm = 34.0502, GNorm = 4.6801, lr_0 = 6.8235e-04
Loss = 6.8840e-01, PNorm = 34.0877, GNorm = 5.9975, lr_0 = 9.4706e-04
Validation rmse = 0.260027
Epoch 2
Loss = 4.3269e-01, PNorm = 34.1594, GNorm = 2.6688, lr_0 = 9.8149e-04
Loss = 4.3331e-01, PNorm = 34.2311, GNorm = 4.9769, lr_0 = 9.5884e-04
Validation rmse = 0.218209
Epoch 3
Loss = 3.0486e-01, PNorm = 34.3075, GNorm = 1.3942, lr_0 = 9.3670e-04
Loss = 3.6765e-01, PNorm = 34.3677, GNorm = 9.6887, lr_0 = 9.1508e-04
Validation rmse = 0.205074
Epoch 4
Loss = 3.5564e-01, PNorm = 34.4106, GNorm = 5.1666, lr_0 = 8.9396e-04
Validation rmse = 0.214552
Epoch 5
Loss = 5.0586e-01, PNorm = 34.4565, GNorm = 11.2203, lr_0 = 8.7333e-04
Loss = 2.9613e-01, PNorm = 34.4954, GNorm = 5.4227, lr_0 = 8.5317e-04
Validation rmse = 0.192052
Epoch 6
Loss = 2.5028e-01, PNorm = 34.5382, GNorm = 1.3841, lr_0 = 8.3347e-04
Loss = 2.2259e-01, PNorm = 34.5744, GNorm = 1.1169, lr_0 = 8.1424e-04
Validation rmse = 0.171433
Epoch 7
Loss = 2.3786e-01, PNorm = 34.6066, GNorm = 4.4952, lr_0 = 7.9544e-04
Loss = 1.9292e-01, PNorm = 34.6354, GNorm = 4.5683, lr_0 = 7.7708e-04
Validation rmse = 0.168843
Epoch 8
Loss = 1.9193e-01, PNorm = 34.6706, GNorm = 4.6013, lr_0 = 7.5914e-04
Loss = 2.3580e-01, PNorm = 34.6987, GNorm = 2.4789, lr_0 = 7.4162e-04
Validation rmse = 0.189131
Epoch 9
Loss = 2.0424e-01, PNorm = 34.7310, GNorm = 1.0929, lr_0 = 7.2450e-04
Validation rmse = 0.155405
Epoch 10
Loss = 1.5112e-01, PNorm = 34.7642, GNorm = 0.7409, lr_0 = 7.0778e-04
Loss = 1.8553e-01, PNorm = 34.7912, GNorm = 3.2021, lr_0 = 6.9144e-04
Validation rmse = 0.151003
Epoch 11
Loss = 1.6825e-01, PNorm = 34.8228, GNorm = 3.6125, lr_0 = 6.7391e-04
Loss = 1.8466e-01, PNorm = 34.8517, GNorm = 1.8821, lr_0 = 6.5835e-04
Validation rmse = 0.147033
Epoch 12
Loss = 1.6618e-01, PNorm = 34.8776, GNorm = 1.0784, lr_0 = 6.4316e-04
Loss = 1.3395e-01, PNorm = 34.9038, GNorm = 2.0853, lr_0 = 6.2831e-04
Validation rmse = 0.143108
Epoch 13
Loss = 1.3507e-01, PNorm = 34.9263, GNorm = 0.8267, lr_0 = 6.1381e-04
Loss = 1.6185e-01, PNorm = 34.9491, GNorm = 3.2033, lr_0 = 5.9964e-04
Validation rmse = 0.146751
Epoch 14
Loss = 1.5113e-01, PNorm = 34.9693, GNorm = 2.5673, lr_0 = 5.8580e-04
Validation rmse = 0.142530
Epoch 15
Loss = 1.3377e-01, PNorm = 34.9917, GNorm = 1.2276, lr_0 = 5.7228e-04
Loss = 1.2972e-01, PNorm = 35.0099, GNorm = 1.2721, lr_0 = 5.5907e-04
Validation rmse = 0.147162
Epoch 16
Loss = 1.3702e-01, PNorm = 35.0322, GNorm = 1.1557, lr_0 = 5.4616e-04
Loss = 1.3122e-01, PNorm = 35.0497, GNorm = 0.8387, lr_0 = 5.3356e-04
Validation rmse = 0.148035
Epoch 17
Loss = 1.3190e-01, PNorm = 35.0682, GNorm = 1.4874, lr_0 = 5.2124e-04
Loss = 1.4659e-01, PNorm = 35.0850, GNorm = 1.6769, lr_0 = 5.0921e-04
Validation rmse = 0.142804
Epoch 18
Loss = 1.3729e-01, PNorm = 35.1042, GNorm = 1.2830, lr_0 = 4.9746e-04
Loss = 1.3061e-01, PNorm = 35.1182, GNorm = 1.7025, lr_0 = 4.8597e-04
Validation rmse = 0.148384
Epoch 19
Loss = 1.2941e-01, PNorm = 35.1344, GNorm = 1.1383, lr_0 = 4.7476e-04
Validation rmse = 0.142434
Epoch 20
Loss = 1.0617e-01, PNorm = 35.1491, GNorm = 1.4864, lr_0 = 4.6380e-04
Loss = 1.2744e-01, PNorm = 35.1674, GNorm = 3.9076, lr_0 = 4.5309e-04
Validation rmse = 0.143068
Epoch 21
Loss = 1.2437e-01, PNorm = 35.1813, GNorm = 0.9701, lr_0 = 4.4160e-04
Loss = 1.1399e-01, PNorm = 35.1953, GNorm = 0.9384, lr_0 = 4.3141e-04
Validation rmse = 0.137988
Epoch 22
Loss = 1.1497e-01, PNorm = 35.2087, GNorm = 1.5350, lr_0 = 4.2145e-04
Loss = 1.2461e-01, PNorm = 35.2201, GNorm = 1.1347, lr_0 = 4.1172e-04
Validation rmse = 0.148739
Epoch 23
Loss = 1.3815e-01, PNorm = 35.2323, GNorm = 2.5802, lr_0 = 4.0222e-04
Validation rmse = 0.142594
Epoch 24
Loss = 1.2946e-01, PNorm = 35.2470, GNorm = 4.0458, lr_0 = 3.9293e-04
Loss = 1.1827e-01, PNorm = 35.2609, GNorm = 1.2365, lr_0 = 3.8386e-04
Validation rmse = 0.136364
Epoch 25
Loss = 1.1886e-01, PNorm = 35.2737, GNorm = 1.4338, lr_0 = 3.7500e-04
Loss = 1.2107e-01, PNorm = 35.2851, GNorm = 3.0861, lr_0 = 3.6635e-04
Validation rmse = 0.138006
Epoch 26
Loss = 1.3051e-01, PNorm = 35.2994, GNorm = 1.7295, lr_0 = 3.5789e-04
Loss = 1.2681e-01, PNorm = 35.3120, GNorm = 2.0335, lr_0 = 3.4963e-04
Validation rmse = 0.134635
Epoch 27
Loss = 1.0614e-01, PNorm = 35.3238, GNorm = 2.5779, lr_0 = 3.4156e-04
Loss = 1.1409e-01, PNorm = 35.3348, GNorm = 1.5162, lr_0 = 3.3368e-04
Validation rmse = 0.135016
Epoch 28
Loss = 1.2076e-01, PNorm = 35.3449, GNorm = 1.3396, lr_0 = 3.2598e-04
Validation rmse = 0.134817
Epoch 29
Loss = 9.7967e-02, PNorm = 35.3551, GNorm = 0.8459, lr_0 = 3.1845e-04
Loss = 1.1759e-01, PNorm = 35.3657, GNorm = 3.4651, lr_0 = 3.1110e-04
Validation rmse = 0.136197
Epoch 30
Loss = 9.3087e-02, PNorm = 35.3770, GNorm = 1.9914, lr_0 = 3.0392e-04
Loss = 1.2259e-01, PNorm = 35.3867, GNorm = 2.7632, lr_0 = 2.9690e-04
Validation rmse = 0.135602
Epoch 31
Loss = 1.2713e-01, PNorm = 35.4000, GNorm = 4.0923, lr_0 = 2.8937e-04
Loss = 1.2214e-01, PNorm = 35.4089, GNorm = 1.8960, lr_0 = 2.8270e-04
Validation rmse = 0.135289
Epoch 32
Loss = 1.0161e-01, PNorm = 35.4178, GNorm = 1.5271, lr_0 = 2.7617e-04
Loss = 1.1590e-01, PNorm = 35.4246, GNorm = 2.0526, lr_0 = 2.6980e-04
Validation rmse = 0.139962
Epoch 33
Loss = 1.0774e-01, PNorm = 35.4348, GNorm = 0.7258, lr_0 = 2.6357e-04
Validation rmse = 0.133548
Epoch 34
Loss = 8.4725e-02, PNorm = 35.4421, GNorm = 0.7218, lr_0 = 2.5748e-04
Loss = 1.0736e-01, PNorm = 35.4516, GNorm = 2.4505, lr_0 = 2.5154e-04
Validation rmse = 0.132286
Epoch 35
Loss = 1.1350e-01, PNorm = 35.4593, GNorm = 3.1493, lr_0 = 2.4573e-04
Loss = 1.0892e-01, PNorm = 35.4665, GNorm = 1.0229, lr_0 = 2.4006e-04
Validation rmse = 0.136242
Epoch 36
Loss = 9.5959e-02, PNorm = 35.4740, GNorm = 0.8546, lr_0 = 2.3452e-04
Loss = 1.0703e-01, PNorm = 35.4837, GNorm = 1.2661, lr_0 = 2.2911e-04
Validation rmse = 0.132582
Epoch 37
Loss = 9.8464e-02, PNorm = 35.4896, GNorm = 1.8984, lr_0 = 2.2382e-04
Loss = 1.0308e-01, PNorm = 35.4967, GNorm = 0.8885, lr_0 = 2.1865e-04
Validation rmse = 0.132218
Epoch 38
Loss = 1.0054e-01, PNorm = 35.5047, GNorm = 1.2828, lr_0 = 2.1361e-04
Validation rmse = 0.132882
Epoch 39
Loss = 8.9342e-02, PNorm = 35.5106, GNorm = 1.0340, lr_0 = 2.0868e-04
Loss = 1.0638e-01, PNorm = 35.5177, GNorm = 0.5812, lr_0 = 2.0386e-04
Validation rmse = 0.134718
Epoch 40
Loss = 8.8701e-02, PNorm = 35.5251, GNorm = 1.6701, lr_0 = 1.9915e-04
Loss = 1.0397e-01, PNorm = 35.5312, GNorm = 1.4385, lr_0 = 1.9456e-04
Validation rmse = 0.133445
Epoch 41
Loss = 9.8338e-02, PNorm = 35.5392, GNorm = 3.9858, lr_0 = 1.8962e-04
Loss = 1.0197e-01, PNorm = 35.5462, GNorm = 0.5052, lr_0 = 1.8525e-04
Validation rmse = 0.132368
Epoch 42
Loss = 1.0798e-01, PNorm = 35.5508, GNorm = 2.6272, lr_0 = 1.8097e-04
Validation rmse = 0.133773
Epoch 43
Loss = 1.1468e-01, PNorm = 35.5567, GNorm = 2.5049, lr_0 = 1.7679e-04
Loss = 1.0160e-01, PNorm = 35.5619, GNorm = 1.4609, lr_0 = 1.7271e-04
Validation rmse = 0.132658
Epoch 44
Loss = 8.7594e-02, PNorm = 35.5689, GNorm = 0.4839, lr_0 = 1.6873e-04
Loss = 1.0215e-01, PNorm = 35.5746, GNorm = 0.9579, lr_0 = 1.6483e-04
Validation rmse = 0.133360
Epoch 45
Loss = 9.2678e-02, PNorm = 35.5802, GNorm = 1.4965, lr_0 = 1.6103e-04
Loss = 1.0550e-01, PNorm = 35.5855, GNorm = 1.1197, lr_0 = 1.5731e-04
Validation rmse = 0.134433
Epoch 46
Loss = 9.8822e-02, PNorm = 35.5901, GNorm = 0.6822, lr_0 = 1.5368e-04
Loss = 1.0242e-01, PNorm = 35.5954, GNorm = 0.8657, lr_0 = 1.5013e-04
Validation rmse = 0.132978
Epoch 47
Loss = 9.0509e-02, PNorm = 35.6010, GNorm = 2.0709, lr_0 = 1.4667e-04
Validation rmse = 0.130497
Epoch 48
Loss = 1.0197e-01, PNorm = 35.6057, GNorm = 0.7720, lr_0 = 1.4328e-04
Loss = 9.6148e-02, PNorm = 35.6111, GNorm = 0.4957, lr_0 = 1.3997e-04
Validation rmse = 0.131681
Epoch 49
Loss = 1.0343e-01, PNorm = 35.6148, GNorm = 1.3627, lr_0 = 1.3674e-04
Loss = 9.4046e-02, PNorm = 35.6187, GNorm = 2.1082, lr_0 = 1.3359e-04
Validation rmse = 0.130819
Epoch 50
Loss = 8.7685e-02, PNorm = 35.6232, GNorm = 0.8268, lr_0 = 1.3050e-04
Loss = 9.5379e-02, PNorm = 35.6276, GNorm = 1.9192, lr_0 = 1.2749e-04
Validation rmse = 0.131036
Epoch 51
Loss = 9.4833e-02, PNorm = 35.6328, GNorm = 0.8416, lr_0 = 1.2426e-04
Loss = 9.2123e-02, PNorm = 35.6369, GNorm = 1.7511, lr_0 = 1.2139e-04
Validation rmse = 0.131799
Epoch 52
Loss = 9.1346e-02, PNorm = 35.6396, GNorm = 1.6545, lr_0 = 1.1859e-04
Validation rmse = 0.129997
Epoch 53
Loss = 1.0621e-01, PNorm = 35.6439, GNorm = 1.0680, lr_0 = 1.1585e-04
Loss = 9.2369e-02, PNorm = 35.6475, GNorm = 2.9526, lr_0 = 1.1318e-04
Validation rmse = 0.132541
Epoch 54
Loss = 1.0163e-01, PNorm = 35.6518, GNorm = 1.4767, lr_0 = 1.1056e-04
Loss = 8.7692e-02, PNorm = 35.6552, GNorm = 0.7021, lr_0 = 1.0801e-04
Validation rmse = 0.131318
Epoch 55
Loss = 8.7365e-02, PNorm = 35.6586, GNorm = 1.1168, lr_0 = 1.0552e-04
Loss = 9.2415e-02, PNorm = 35.6622, GNorm = 1.3126, lr_0 = 1.0308e-04
Validation rmse = 0.131171
Epoch 56
Loss = 8.4266e-02, PNorm = 35.6656, GNorm = 0.9077, lr_0 = 1.0070e-04
Loss = 9.9165e-02, PNorm = 35.6689, GNorm = 0.8745, lr_0 = 1.0000e-04
Validation rmse = 0.130693
Epoch 57
Loss = 1.0041e-01, PNorm = 35.6722, GNorm = 1.5981, lr_0 = 1.0000e-04
Validation rmse = 0.129757
Epoch 58
Loss = 8.6700e-02, PNorm = 35.6754, GNorm = 0.6184, lr_0 = 1.0000e-04
Loss = 9.4081e-02, PNorm = 35.6783, GNorm = 1.5658, lr_0 = 1.0000e-04
Validation rmse = 0.130776
Epoch 59
Loss = 9.2395e-02, PNorm = 35.6818, GNorm = 1.8898, lr_0 = 1.0000e-04
Loss = 9.0410e-02, PNorm = 35.6853, GNorm = 1.9569, lr_0 = 1.0000e-04
Validation rmse = 0.130225
Model 0 best validation rmse = 0.129757 on epoch 57
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.151490
Ensemble test rmse = 0.151490
1-fold cross validation
	Seed 0 ==> test rmse = 0.151490
Overall test rmse = 0.151490 +/- 0.000000
Elapsed time = 0:00:44
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,117 | train size = 888 | val size = 223 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.1830e-01, PNorm = 34.0179, GNorm = 3.8171, lr_0 = 3.9118e-04
Validation rmse = 0.290229
Epoch 1
Loss = 7.0825e-01, PNorm = 34.0437, GNorm = 1.2271, lr_0 = 6.8235e-04
Loss = 5.9562e-01, PNorm = 34.1010, GNorm = 4.1697, lr_0 = 9.4706e-04
Validation rmse = 0.265887
Epoch 2
Loss = 4.5837e-01, PNorm = 34.1715, GNorm = 4.5062, lr_0 = 9.8149e-04
Loss = 4.2990e-01, PNorm = 34.2397, GNorm = 5.1637, lr_0 = 9.5884e-04
Validation rmse = 0.258148
Epoch 3
Loss = 3.7778e-01, PNorm = 34.2988, GNorm = 4.1078, lr_0 = 9.3670e-04
Loss = 3.3638e-01, PNorm = 34.3509, GNorm = 5.6298, lr_0 = 9.1508e-04
Validation rmse = 0.270618
Epoch 4
Loss = 3.6964e-01, PNorm = 34.3935, GNorm = 0.9077, lr_0 = 8.9396e-04
Validation rmse = 0.221763
Epoch 5
Loss = 3.6790e-01, PNorm = 34.4464, GNorm = 6.5374, lr_0 = 8.7129e-04
Loss = 3.8914e-01, PNorm = 34.4911, GNorm = 7.1480, lr_0 = 8.5118e-04
Validation rmse = 0.192496
Epoch 6
Loss = 2.1931e-01, PNorm = 34.5337, GNorm = 0.6621, lr_0 = 8.3153e-04
Loss = 2.2784e-01, PNorm = 34.5733, GNorm = 1.8882, lr_0 = 8.1234e-04
Validation rmse = 0.190927
Epoch 7
Loss = 1.8529e-01, PNorm = 34.6101, GNorm = 1.0406, lr_0 = 7.9359e-04
Loss = 1.9354e-01, PNorm = 34.6402, GNorm = 4.4185, lr_0 = 7.7527e-04
Validation rmse = 0.166894
Epoch 8
Loss = 1.8333e-01, PNorm = 34.6767, GNorm = 2.1217, lr_0 = 7.5737e-04
Validation rmse = 0.158170
Epoch 9
Loss = 1.6014e-01, PNorm = 34.7083, GNorm = 3.5675, lr_0 = 7.3817e-04
Loss = 1.5460e-01, PNorm = 34.7340, GNorm = 1.2249, lr_0 = 7.2113e-04
Validation rmse = 0.154129
Epoch 10
Loss = 1.8753e-01, PNorm = 34.7635, GNorm = 6.3974, lr_0 = 7.0448e-04
Loss = 2.3164e-01, PNorm = 34.7917, GNorm = 2.7672, lr_0 = 6.8822e-04
Validation rmse = 0.211377
Epoch 11
Loss = 2.1561e-01, PNorm = 34.8199, GNorm = 5.2916, lr_0 = 6.7234e-04
Loss = 1.6692e-01, PNorm = 34.8494, GNorm = 0.6111, lr_0 = 6.5682e-04
Validation rmse = 0.157038
Epoch 12
Loss = 1.3527e-01, PNorm = 34.8705, GNorm = 3.2228, lr_0 = 6.4166e-04
Loss = 1.5228e-01, PNorm = 34.8946, GNorm = 2.5882, lr_0 = 6.2685e-04
Loss = 1.6101e-01, PNorm = 34.8974, GNorm = 1.0155, lr_0 = 6.2538e-04
Validation rmse = 0.148781
Epoch 13
Loss = 1.3254e-01, PNorm = 34.9194, GNorm = 0.5404, lr_0 = 6.1095e-04
Validation rmse = 0.157120
Epoch 14
Loss = 1.3302e-01, PNorm = 34.9403, GNorm = 3.3175, lr_0 = 5.9685e-04
Loss = 1.4691e-01, PNorm = 34.9629, GNorm = 0.7595, lr_0 = 5.8307e-04
Validation rmse = 0.142372
Epoch 15
Loss = 1.3289e-01, PNorm = 34.9830, GNorm = 0.8155, lr_0 = 5.6961e-04
Loss = 1.3638e-01, PNorm = 34.9995, GNorm = 0.9818, lr_0 = 5.5646e-04
Validation rmse = 0.148047
Epoch 16
Loss = 1.3836e-01, PNorm = 35.0181, GNorm = 1.5380, lr_0 = 5.4362e-04
Loss = 1.2390e-01, PNorm = 35.0331, GNorm = 0.8698, lr_0 = 5.3107e-04
Validation rmse = 0.141129
Epoch 17
Loss = 1.2183e-01, PNorm = 35.0481, GNorm = 2.4137, lr_0 = 5.1760e-04
Validation rmse = 0.141298
Epoch 18
Loss = 1.4902e-01, PNorm = 35.0646, GNorm = 3.8510, lr_0 = 5.0565e-04
Loss = 1.1768e-01, PNorm = 35.0851, GNorm = 4.0827, lr_0 = 4.9398e-04
Validation rmse = 0.168290
Epoch 19
Loss = 1.1763e-01, PNorm = 35.1014, GNorm = 0.7568, lr_0 = 4.8258e-04
Loss = 1.2480e-01, PNorm = 35.1191, GNorm = 1.8285, lr_0 = 4.7144e-04
Validation rmse = 0.150160
Epoch 20
Loss = 1.1307e-01, PNorm = 35.1355, GNorm = 2.5295, lr_0 = 4.6056e-04
Loss = 1.2263e-01, PNorm = 35.1503, GNorm = 0.6747, lr_0 = 4.4993e-04
Validation rmse = 0.136715
Epoch 21
Loss = 1.2160e-01, PNorm = 35.1684, GNorm = 3.1523, lr_0 = 4.3852e-04
Loss = 1.2961e-01, PNorm = 35.1813, GNorm = 2.7148, lr_0 = 4.2840e-04
Validation rmse = 0.135220
Epoch 22
Loss = 1.0702e-01, PNorm = 35.1961, GNorm = 0.6241, lr_0 = 4.1851e-04
Validation rmse = 0.145467
Epoch 23
Loss = 1.3654e-01, PNorm = 35.2106, GNorm = 2.5296, lr_0 = 4.0885e-04
Loss = 1.1541e-01, PNorm = 35.2274, GNorm = 0.8251, lr_0 = 3.9941e-04
Validation rmse = 0.144318
Epoch 24
Loss = 7.9914e-02, PNorm = 35.2415, GNorm = 1.1509, lr_0 = 3.9019e-04
Loss = 1.2661e-01, PNorm = 35.2565, GNorm = 3.2033, lr_0 = 3.8119e-04
Validation rmse = 0.132774
Epoch 25
Loss = 1.0410e-01, PNorm = 35.2709, GNorm = 1.2715, lr_0 = 3.7239e-04
Loss = 1.2479e-01, PNorm = 35.2846, GNorm = 0.5427, lr_0 = 3.6379e-04
Validation rmse = 0.133275
Epoch 26
Loss = 1.3321e-01, PNorm = 35.3000, GNorm = 4.8492, lr_0 = 3.5456e-04
Validation rmse = 0.137299
Epoch 27
Loss = 1.0239e-01, PNorm = 35.3150, GNorm = 1.4505, lr_0 = 3.4638e-04
Loss = 1.0906e-01, PNorm = 35.3321, GNorm = 0.6302, lr_0 = 3.3839e-04
Validation rmse = 0.136776
Epoch 28
Loss = 1.0005e-01, PNorm = 35.3436, GNorm = 0.9129, lr_0 = 3.3057e-04
Loss = 1.0720e-01, PNorm = 35.3549, GNorm = 2.1053, lr_0 = 3.2294e-04
Validation rmse = 0.144106
Epoch 29
Loss = 1.0860e-01, PNorm = 35.3663, GNorm = 1.9048, lr_0 = 3.1549e-04
Loss = 1.0844e-01, PNorm = 35.3769, GNorm = 0.7242, lr_0 = 3.0821e-04
Validation rmse = 0.134360
Epoch 30
Loss = 1.0391e-01, PNorm = 35.3898, GNorm = 1.7560, lr_0 = 3.0039e-04
Loss = 1.0072e-01, PNorm = 35.3990, GNorm = 1.6031, lr_0 = 2.9346e-04
Validation rmse = 0.133008
Epoch 31
Loss = 1.0680e-01, PNorm = 35.4082, GNorm = 1.3097, lr_0 = 2.8668e-04
Validation rmse = 0.132763
Epoch 32
Loss = 9.8580e-02, PNorm = 35.4191, GNorm = 0.5566, lr_0 = 2.8007e-04
Loss = 9.8202e-02, PNorm = 35.4304, GNorm = 1.1866, lr_0 = 2.7360e-04
Validation rmse = 0.137195
Epoch 33
Loss = 9.8322e-02, PNorm = 35.4420, GNorm = 2.3011, lr_0 = 2.6729e-04
Loss = 9.0866e-02, PNorm = 35.4512, GNorm = 2.0523, lr_0 = 2.6112e-04
Validation rmse = 0.131616
Epoch 34
Loss = 9.4751e-02, PNorm = 35.4622, GNorm = 0.9690, lr_0 = 2.5450e-04
Loss = 8.9103e-02, PNorm = 35.4700, GNorm = 0.5248, lr_0 = 2.4862e-04
Validation rmse = 0.134159
Epoch 35
Loss = 9.5485e-02, PNorm = 35.4791, GNorm = 1.4417, lr_0 = 2.4288e-04
Validation rmse = 0.133910
Epoch 36
Loss = 1.1486e-01, PNorm = 35.4869, GNorm = 1.1634, lr_0 = 2.3728e-04
Loss = 9.2061e-02, PNorm = 35.4975, GNorm = 0.7506, lr_0 = 2.3180e-04
Validation rmse = 0.136463
Epoch 37
Loss = 9.9459e-02, PNorm = 35.5066, GNorm = 0.7716, lr_0 = 2.2645e-04
Loss = 9.4262e-02, PNorm = 35.5166, GNorm = 1.5367, lr_0 = 2.2122e-04
Validation rmse = 0.129734
Epoch 38
Loss = 9.0167e-02, PNorm = 35.5242, GNorm = 0.6912, lr_0 = 2.1561e-04
Loss = 9.3310e-02, PNorm = 35.5327, GNorm = 1.8450, lr_0 = 2.1063e-04
Validation rmse = 0.132063
Epoch 39
Loss = 1.0013e-01, PNorm = 35.5409, GNorm = 1.9078, lr_0 = 2.0577e-04
Loss = 8.3473e-02, PNorm = 35.5493, GNorm = 1.1077, lr_0 = 2.0102e-04
Validation rmse = 0.130963
Epoch 40
Loss = 8.5555e-02, PNorm = 35.5554, GNorm = 1.0642, lr_0 = 1.9638e-04
Validation rmse = 0.131058
Epoch 41
Loss = 7.6589e-02, PNorm = 35.5624, GNorm = 2.1430, lr_0 = 1.9185e-04
Loss = 8.8030e-02, PNorm = 35.5678, GNorm = 1.5544, lr_0 = 1.8742e-04
Validation rmse = 0.131821
Epoch 42
Loss = 9.5860e-02, PNorm = 35.5766, GNorm = 2.3839, lr_0 = 1.8267e-04
Loss = 8.4371e-02, PNorm = 35.5831, GNorm = 0.7327, lr_0 = 1.7845e-04
Validation rmse = 0.129978
Epoch 43
Loss = 9.3361e-02, PNorm = 35.5905, GNorm = 3.0902, lr_0 = 1.7433e-04
Loss = 9.1336e-02, PNorm = 35.5970, GNorm = 2.2509, lr_0 = 1.7031e-04
Validation rmse = 0.132964
Epoch 44
Loss = 8.0508e-02, PNorm = 35.6035, GNorm = 0.7920, lr_0 = 1.6638e-04
Validation rmse = 0.130760
Epoch 45
Loss = 7.5830e-02, PNorm = 35.6089, GNorm = 1.9499, lr_0 = 1.6254e-04
Loss = 9.2370e-02, PNorm = 35.6167, GNorm = 1.6886, lr_0 = 1.5879e-04
Validation rmse = 0.131670
Epoch 46
Loss = 9.2527e-02, PNorm = 35.6231, GNorm = 1.0732, lr_0 = 1.5476e-04
Loss = 8.3226e-02, PNorm = 35.6279, GNorm = 0.9610, lr_0 = 1.5119e-04
Validation rmse = 0.130528
Epoch 47
Loss = 9.0770e-02, PNorm = 35.6341, GNorm = 0.6619, lr_0 = 1.4770e-04
Loss = 8.3397e-02, PNorm = 35.6382, GNorm = 1.5838, lr_0 = 1.4429e-04
Validation rmse = 0.132208
Epoch 48
Loss = 9.3349e-02, PNorm = 35.6433, GNorm = 0.8480, lr_0 = 1.4096e-04
Loss = 7.9541e-02, PNorm = 35.6483, GNorm = 0.7303, lr_0 = 1.3770e-04
Validation rmse = 0.129769
Epoch 49
Loss = 8.2627e-02, PNorm = 35.6537, GNorm = 0.6170, lr_0 = 1.3453e-04
Validation rmse = 0.131382
Epoch 50
Loss = 7.7353e-02, PNorm = 35.6579, GNorm = 1.2791, lr_0 = 1.3142e-04
Loss = 7.7483e-02, PNorm = 35.6624, GNorm = 0.8345, lr_0 = 1.2839e-04
Validation rmse = 0.133382
Epoch 51
Loss = 8.8931e-02, PNorm = 35.6668, GNorm = 1.7576, lr_0 = 1.2513e-04
Loss = 8.6935e-02, PNorm = 35.6719, GNorm = 2.1137, lr_0 = 1.2224e-04
Validation rmse = 0.130542
Epoch 52
Loss = 7.5216e-02, PNorm = 35.6762, GNorm = 0.5667, lr_0 = 1.1942e-04
Loss = 8.8836e-02, PNorm = 35.6799, GNorm = 1.8343, lr_0 = 1.1666e-04
Validation rmse = 0.131840
Epoch 53
Loss = 8.4995e-02, PNorm = 35.6848, GNorm = 0.6336, lr_0 = 1.1397e-04
Validation rmse = 0.129858
Epoch 54
Loss = 8.6726e-02, PNorm = 35.6888, GNorm = 1.1507, lr_0 = 1.1134e-04
Loss = 7.4427e-02, PNorm = 35.6922, GNorm = 0.7262, lr_0 = 1.0877e-04
Validation rmse = 0.131221
Epoch 55
Loss = 8.0059e-02, PNorm = 35.6968, GNorm = 2.3190, lr_0 = 1.0601e-04
Loss = 8.4167e-02, PNorm = 35.6998, GNorm = 2.2627, lr_0 = 1.0356e-04
Validation rmse = 0.131008
Epoch 56
Loss = 8.2655e-02, PNorm = 35.7036, GNorm = 0.5881, lr_0 = 1.0117e-04
Loss = 8.1435e-02, PNorm = 35.7069, GNorm = 2.7840, lr_0 = 1.0000e-04
Validation rmse = 0.130064
Epoch 57
Loss = 7.6396e-02, PNorm = 35.7110, GNorm = 0.7392, lr_0 = 1.0000e-04
Loss = 8.2696e-02, PNorm = 35.7144, GNorm = 1.2808, lr_0 = 1.0000e-04
Validation rmse = 0.130707
Epoch 58
Loss = 8.0452e-02, PNorm = 35.7173, GNorm = 1.0751, lr_0 = 1.0000e-04
Validation rmse = 0.131762
Epoch 59
Loss = 8.0996e-02, PNorm = 35.7216, GNorm = 1.5402, lr_0 = 1.0000e-04
Loss = 8.3809e-02, PNorm = 35.7248, GNorm = 1.3739, lr_0 = 1.0000e-04
Validation rmse = 0.130369
Model 0 best validation rmse = 0.129734 on epoch 37
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.111605
Ensemble test rmse = 0.111605
1-fold cross validation
	Seed 0 ==> test rmse = 0.111605
Overall test rmse = 0.111605 +/- 0.000000
Elapsed time = 0:00:41
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,107 | train size = 880 | val size = 221 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.8175e-01, PNorm = 34.0148, GNorm = 6.2098, lr_0 = 3.9118e-04
Validation rmse = 0.300660
Epoch 1
Loss = 7.4802e-01, PNorm = 34.0393, GNorm = 1.0347, lr_0 = 6.8235e-04
Loss = 7.4887e-01, PNorm = 34.0838, GNorm = 1.9322, lr_0 = 9.4706e-04
Validation rmse = 0.255067
Epoch 2
Loss = 4.9374e-01, PNorm = 34.1526, GNorm = 3.2712, lr_0 = 9.8149e-04
Loss = 4.3806e-01, PNorm = 34.2301, GNorm = 4.8618, lr_0 = 9.5884e-04
Validation rmse = 0.254120
Epoch 3
Loss = 4.4386e-01, PNorm = 34.2938, GNorm = 2.4839, lr_0 = 9.3452e-04
Loss = 3.5908e-01, PNorm = 34.3470, GNorm = 6.5335, lr_0 = 9.1295e-04
Validation rmse = 0.198756
Epoch 4
Loss = 3.4026e-01, PNorm = 34.3917, GNorm = 2.3855, lr_0 = 8.9188e-04
Validation rmse = 0.188370
Epoch 5
Loss = 2.1273e-01, PNorm = 34.4384, GNorm = 1.2576, lr_0 = 8.7129e-04
Loss = 2.5035e-01, PNorm = 34.4916, GNorm = 2.0463, lr_0 = 8.5118e-04
Validation rmse = 0.172893
Epoch 6
Loss = 2.4219e-01, PNorm = 34.5419, GNorm = 4.8354, lr_0 = 8.2959e-04
Loss = 2.1893e-01, PNorm = 34.5812, GNorm = 0.8733, lr_0 = 8.1044e-04
Validation rmse = 0.164454
Epoch 7
Loss = 2.2048e-01, PNorm = 34.6173, GNorm = 0.9367, lr_0 = 7.9174e-04
Loss = 1.8211e-01, PNorm = 34.6523, GNorm = 1.8491, lr_0 = 7.7346e-04
Loss = 1.5243e-01, PNorm = 34.6561, GNorm = 2.8953, lr_0 = 7.7166e-04
Validation rmse = 0.153864
Epoch 8
Loss = 1.6333e-01, PNorm = 34.6894, GNorm = 2.7340, lr_0 = 7.5384e-04
Validation rmse = 0.153583
Epoch 9
Loss = 1.7464e-01, PNorm = 34.7238, GNorm = 7.0433, lr_0 = 7.3644e-04
Loss = 1.8253e-01, PNorm = 34.7530, GNorm = 5.9074, lr_0 = 7.1945e-04
Validation rmse = 0.153959
Epoch 10
Loss = 1.4171e-01, PNorm = 34.7831, GNorm = 4.7444, lr_0 = 7.0284e-04
Loss = 1.5471e-01, PNorm = 34.8062, GNorm = 4.3515, lr_0 = 6.8662e-04
Validation rmse = 0.140631
Epoch 11
Loss = 1.5285e-01, PNorm = 34.8353, GNorm = 1.3123, lr_0 = 6.6920e-04
Loss = 1.3432e-01, PNorm = 34.8609, GNorm = 2.1361, lr_0 = 6.5376e-04
Validation rmse = 0.137931
Epoch 12
Loss = 1.2269e-01, PNorm = 34.8839, GNorm = 1.0408, lr_0 = 6.3867e-04
Validation rmse = 0.136572
Epoch 13
Loss = 1.3161e-01, PNorm = 34.9045, GNorm = 0.5131, lr_0 = 6.2247e-04
Loss = 1.2785e-01, PNorm = 34.9246, GNorm = 1.1887, lr_0 = 6.0810e-04
Validation rmse = 0.133654
Epoch 14
Loss = 1.2852e-01, PNorm = 34.9431, GNorm = 1.8416, lr_0 = 5.9406e-04
Loss = 1.3385e-01, PNorm = 34.9633, GNorm = 4.6788, lr_0 = 5.8035e-04
Validation rmse = 0.136009
Epoch 15
Loss = 1.0133e-01, PNorm = 34.9795, GNorm = 1.1109, lr_0 = 5.6696e-04
Loss = 1.2940e-01, PNorm = 34.9977, GNorm = 1.5169, lr_0 = 5.5387e-04
Validation rmse = 0.135736
Epoch 16
Loss = 1.2750e-01, PNorm = 35.0129, GNorm = 1.4833, lr_0 = 5.3982e-04
Validation rmse = 0.131925
Epoch 17
Loss = 7.0594e-02, PNorm = 35.0319, GNorm = 1.6101, lr_0 = 5.2736e-04
Loss = 1.1525e-01, PNorm = 35.0471, GNorm = 1.2017, lr_0 = 5.1519e-04
Validation rmse = 0.131321
Epoch 18
Loss = 1.1996e-01, PNorm = 35.0646, GNorm = 1.6092, lr_0 = 5.0212e-04
Loss = 1.1134e-01, PNorm = 35.0790, GNorm = 2.6791, lr_0 = 4.9053e-04
Validation rmse = 0.130464
Epoch 19
Loss = 1.2052e-01, PNorm = 35.0947, GNorm = 2.0762, lr_0 = 4.7921e-04
Loss = 1.0987e-01, PNorm = 35.1096, GNorm = 0.9352, lr_0 = 4.6815e-04
Validation rmse = 0.132761
Epoch 20
Loss = 9.8031e-02, PNorm = 35.1248, GNorm = 0.7028, lr_0 = 4.5734e-04
Validation rmse = 0.154861
Epoch 21
Loss = 1.4866e-01, PNorm = 35.1368, GNorm = 6.2407, lr_0 = 4.4575e-04
Loss = 1.4306e-01, PNorm = 35.1529, GNorm = 3.3772, lr_0 = 4.3546e-04
Validation rmse = 0.145432
Epoch 22
Loss = 1.3430e-01, PNorm = 35.1672, GNorm = 2.1962, lr_0 = 4.2541e-04
Loss = 1.3034e-01, PNorm = 35.1823, GNorm = 3.4858, lr_0 = 4.1559e-04
Validation rmse = 0.135695
Epoch 23
Loss = 1.0935e-01, PNorm = 35.1945, GNorm = 1.4687, lr_0 = 4.0505e-04
Loss = 1.0176e-01, PNorm = 35.2076, GNorm = 0.8314, lr_0 = 3.9570e-04
Validation rmse = 0.131757
Epoch 24
Loss = 1.0249e-01, PNorm = 35.2176, GNorm = 2.3749, lr_0 = 3.8656e-04
Loss = 1.0354e-01, PNorm = 35.2304, GNorm = 1.7824, lr_0 = 3.7764e-04
Validation rmse = 0.131349
Epoch 25
Loss = 1.0325e-01, PNorm = 35.2427, GNorm = 2.3968, lr_0 = 3.6892e-04
Validation rmse = 0.130086
Epoch 26
Loss = 8.9063e-02, PNorm = 35.2543, GNorm = 1.5881, lr_0 = 3.5957e-04
Loss = 9.5575e-02, PNorm = 35.2644, GNorm = 0.9580, lr_0 = 3.5127e-04
Validation rmse = 0.129923
Epoch 27
Loss = 9.5010e-02, PNorm = 35.2730, GNorm = 0.7789, lr_0 = 3.4316e-04
Loss = 1.0490e-01, PNorm = 35.2853, GNorm = 1.4246, lr_0 = 3.3524e-04
Validation rmse = 0.129346
Epoch 28
Loss = 9.1443e-02, PNorm = 35.2937, GNorm = 2.4896, lr_0 = 3.2674e-04
Loss = 9.5850e-02, PNorm = 35.3034, GNorm = 1.6910, lr_0 = 3.1920e-04
Validation rmse = 0.129936
Epoch 29
Loss = 9.4971e-02, PNorm = 35.3137, GNorm = 2.3632, lr_0 = 3.1183e-04
Validation rmse = 0.130911
Epoch 30
Loss = 9.8568e-02, PNorm = 35.3231, GNorm = 0.7611, lr_0 = 3.0463e-04
Loss = 1.0152e-01, PNorm = 35.3310, GNorm = 0.6275, lr_0 = 2.9760e-04
Validation rmse = 0.127522
Epoch 31
Loss = 8.7962e-02, PNorm = 35.3399, GNorm = 1.3880, lr_0 = 2.9005e-04
Loss = 8.8422e-02, PNorm = 35.3484, GNorm = 0.9408, lr_0 = 2.8336e-04
Validation rmse = 0.129723
Epoch 32
Loss = 8.5769e-02, PNorm = 35.3556, GNorm = 0.8916, lr_0 = 2.7682e-04
Loss = 9.2531e-02, PNorm = 35.3638, GNorm = 0.8655, lr_0 = 2.7043e-04
Loss = 5.9281e-02, PNorm = 35.3647, GNorm = 0.7147, lr_0 = 2.6980e-04
Validation rmse = 0.136561
Epoch 33
Loss = 9.5497e-02, PNorm = 35.3720, GNorm = 2.5160, lr_0 = 2.6357e-04
Validation rmse = 0.128832
Epoch 34
Loss = 1.1248e-01, PNorm = 35.3805, GNorm = 2.2169, lr_0 = 2.5748e-04
Loss = 8.5053e-02, PNorm = 35.3883, GNorm = 1.2110, lr_0 = 2.5154e-04
Validation rmse = 0.131043
Epoch 35
Loss = 8.4876e-02, PNorm = 35.3949, GNorm = 0.6189, lr_0 = 2.4573e-04
Loss = 9.7013e-02, PNorm = 35.4024, GNorm = 1.9069, lr_0 = 2.4006e-04
Validation rmse = 0.132990
Epoch 36
Loss = 9.0992e-02, PNorm = 35.4105, GNorm = 0.8332, lr_0 = 2.3397e-04
Loss = 8.5839e-02, PNorm = 35.4175, GNorm = 1.5748, lr_0 = 2.2857e-04
Validation rmse = 0.130537
Epoch 37
Loss = 8.5746e-02, PNorm = 35.4246, GNorm = 0.6790, lr_0 = 2.2330e-04
Validation rmse = 0.128827
Epoch 38
Loss = 1.0394e-01, PNorm = 35.4316, GNorm = 0.8562, lr_0 = 2.1763e-04
Loss = 7.9224e-02, PNorm = 35.4383, GNorm = 1.1876, lr_0 = 2.1261e-04
Validation rmse = 0.130421
Epoch 39
Loss = 9.5173e-02, PNorm = 35.4444, GNorm = 1.6458, lr_0 = 2.0770e-04
Loss = 7.9419e-02, PNorm = 35.4513, GNorm = 0.6383, lr_0 = 2.0291e-04
Validation rmse = 0.129876
Epoch 40
Loss = 8.7368e-02, PNorm = 35.4571, GNorm = 2.0423, lr_0 = 1.9823e-04
Loss = 8.0654e-02, PNorm = 35.4629, GNorm = 1.9150, lr_0 = 1.9365e-04
Validation rmse = 0.130872
Epoch 41
Loss = 8.4667e-02, PNorm = 35.4684, GNorm = 1.5126, lr_0 = 1.8874e-04
Validation rmse = 0.128970
Epoch 42
Loss = 6.8869e-02, PNorm = 35.4739, GNorm = 1.2347, lr_0 = 1.8438e-04
Loss = 7.6242e-02, PNorm = 35.4787, GNorm = 0.7768, lr_0 = 1.8013e-04
Validation rmse = 0.128957
Epoch 43
Loss = 7.7205e-02, PNorm = 35.4851, GNorm = 0.8086, lr_0 = 1.7556e-04
Loss = 8.5862e-02, PNorm = 35.4911, GNorm = 0.7958, lr_0 = 1.7151e-04
Validation rmse = 0.129831
Epoch 44
Loss = 7.2161e-02, PNorm = 35.4973, GNorm = 1.7321, lr_0 = 1.6755e-04
Loss = 8.4595e-02, PNorm = 35.5022, GNorm = 0.7030, lr_0 = 1.6368e-04
Validation rmse = 0.130640
Epoch 45
Loss = 8.4349e-02, PNorm = 35.5066, GNorm = 0.7941, lr_0 = 1.5990e-04
Validation rmse = 0.131649
Epoch 46
Loss = 1.0165e-01, PNorm = 35.5122, GNorm = 1.8308, lr_0 = 1.5585e-04
Loss = 7.4923e-02, PNorm = 35.5181, GNorm = 0.8040, lr_0 = 1.5225e-04
Validation rmse = 0.132095
Epoch 47
Loss = 9.0857e-02, PNorm = 35.5228, GNorm = 0.5764, lr_0 = 1.4874e-04
Loss = 7.4674e-02, PNorm = 35.5268, GNorm = 0.7136, lr_0 = 1.4530e-04
Validation rmse = 0.128639
Epoch 48
Loss = 8.3075e-02, PNorm = 35.5316, GNorm = 0.5535, lr_0 = 1.4162e-04
Loss = 7.6477e-02, PNorm = 35.5353, GNorm = 1.8794, lr_0 = 1.3835e-04
Validation rmse = 0.128825
Epoch 49
Loss = 8.0661e-02, PNorm = 35.5389, GNorm = 0.4304, lr_0 = 1.3515e-04
Loss = 7.7382e-02, PNorm = 35.5436, GNorm = 4.8530, lr_0 = 1.3204e-04
Validation rmse = 0.130994
Epoch 50
Loss = 8.5179e-02, PNorm = 35.5472, GNorm = 2.7957, lr_0 = 1.2899e-04
Validation rmse = 0.128575
Epoch 51
Loss = 7.4142e-02, PNorm = 35.5504, GNorm = 2.0716, lr_0 = 1.2572e-04
Loss = 8.2122e-02, PNorm = 35.5555, GNorm = 0.6423, lr_0 = 1.2281e-04
Validation rmse = 0.129456
Epoch 52
Loss = 6.3829e-02, PNorm = 35.5582, GNorm = 1.1472, lr_0 = 1.1998e-04
Loss = 8.2490e-02, PNorm = 35.5625, GNorm = 1.1220, lr_0 = 1.1721e-04
Validation rmse = 0.130845
Epoch 53
Loss = 8.4882e-02, PNorm = 35.5665, GNorm = 1.4874, lr_0 = 1.1424e-04
Loss = 7.8781e-02, PNorm = 35.5689, GNorm = 3.4719, lr_0 = 1.1160e-04
Validation rmse = 0.134794
Epoch 54
Loss = 7.8710e-02, PNorm = 35.5732, GNorm = 0.8462, lr_0 = 1.0902e-04
Validation rmse = 0.128819
Epoch 55
Loss = 9.8544e-02, PNorm = 35.5759, GNorm = 2.3124, lr_0 = 1.0651e-04
Loss = 7.1234e-02, PNorm = 35.5793, GNorm = 0.8619, lr_0 = 1.0405e-04
Validation rmse = 0.130654
Epoch 56
Loss = 6.6591e-02, PNorm = 35.5818, GNorm = 0.5850, lr_0 = 1.0141e-04
Loss = 7.7729e-02, PNorm = 35.5846, GNorm = 1.0744, lr_0 = 1.0000e-04
Validation rmse = 0.129133
Epoch 57
Loss = 7.0463e-02, PNorm = 35.5871, GNorm = 2.0615, lr_0 = 1.0000e-04
Loss = 7.9696e-02, PNorm = 35.5904, GNorm = 0.8890, lr_0 = 1.0000e-04
Loss = 6.6950e-02, PNorm = 35.5907, GNorm = 1.2973, lr_0 = 1.0000e-04
Validation rmse = 0.129207
Epoch 58
Loss = 7.2805e-02, PNorm = 35.5938, GNorm = 0.8617, lr_0 = 1.0000e-04
Validation rmse = 0.128933
Epoch 59
Loss = 6.7768e-02, PNorm = 35.5961, GNorm = 1.6867, lr_0 = 1.0000e-04
Loss = 6.8489e-02, PNorm = 35.5993, GNorm = 0.5324, lr_0 = 1.0000e-04
Validation rmse = 0.132077
Model 0 best validation rmse = 0.127522 on epoch 30
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.106565
Ensemble test rmse = 0.106565
1-fold cross validation
	Seed 0 ==> test rmse = 0.106565
Overall test rmse = 0.106565 +/- 0.000000
Elapsed time = 0:00:40
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,097 | train size = 872 | val size = 219 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.3816e-01, PNorm = 34.0168, GNorm = 1.9132, lr_0 = 3.9118e-04
Validation rmse = 0.276695
Epoch 1
Loss = 6.5726e-01, PNorm = 34.0437, GNorm = 4.4026, lr_0 = 6.8235e-04
Loss = 7.1471e-01, PNorm = 34.0889, GNorm = 10.1958, lr_0 = 9.4706e-04
Validation rmse = 0.233110
Epoch 2
Loss = 5.2159e-01, PNorm = 34.1634, GNorm = 1.2363, lr_0 = 9.7920e-04
Loss = 4.8186e-01, PNorm = 34.2302, GNorm = 1.5778, lr_0 = 9.5660e-04
Validation rmse = 0.196943
Epoch 3
Loss = 3.7361e-01, PNorm = 34.2960, GNorm = 6.3142, lr_0 = 9.3452e-04
Validation rmse = 0.177106
Epoch 4
Loss = 3.1077e-01, PNorm = 34.3610, GNorm = 1.4472, lr_0 = 9.1082e-04
Loss = 2.9829e-01, PNorm = 34.4183, GNorm = 2.9126, lr_0 = 8.8980e-04
Validation rmse = 0.185620
Epoch 5
Loss = 3.0559e-01, PNorm = 34.4658, GNorm = 2.7033, lr_0 = 8.6926e-04
Loss = 2.7273e-01, PNorm = 34.5183, GNorm = 1.2031, lr_0 = 8.4919e-04
Validation rmse = 0.189973
Epoch 6
Loss = 2.3013e-01, PNorm = 34.5712, GNorm = 1.4301, lr_0 = 8.2766e-04
Loss = 2.4004e-01, PNorm = 34.6166, GNorm = 0.5335, lr_0 = 8.0855e-04
Validation rmse = 0.144340
Epoch 7
Loss = 2.1250e-01, PNorm = 34.6587, GNorm = 2.3954, lr_0 = 7.8989e-04
Validation rmse = 0.139367
Epoch 8
Loss = 1.8866e-01, PNorm = 34.7022, GNorm = 3.2612, lr_0 = 7.6986e-04
Loss = 2.1626e-01, PNorm = 34.7381, GNorm = 1.9011, lr_0 = 7.5209e-04
Validation rmse = 0.130869
Epoch 9
Loss = 1.7785e-01, PNorm = 34.7757, GNorm = 1.7533, lr_0 = 7.3301e-04
Loss = 1.5431e-01, PNorm = 34.8067, GNorm = 1.3655, lr_0 = 7.1609e-04
Validation rmse = 0.129112
Epoch 10
Loss = 1.3813e-01, PNorm = 34.8376, GNorm = 2.7320, lr_0 = 6.9956e-04
Loss = 1.5074e-01, PNorm = 34.8658, GNorm = 1.7994, lr_0 = 6.8342e-04
Validation rmse = 0.125934
Epoch 11
Loss = 1.3915e-01, PNorm = 34.8930, GNorm = 0.9958, lr_0 = 6.6608e-04
Validation rmse = 0.148263
Epoch 12
Loss = 1.7825e-01, PNorm = 34.9201, GNorm = 3.7987, lr_0 = 6.5071e-04
Loss = 1.5432e-01, PNorm = 34.9435, GNorm = 1.0833, lr_0 = 6.3569e-04
Validation rmse = 0.143542
Epoch 13
Loss = 1.5691e-01, PNorm = 34.9727, GNorm = 2.4333, lr_0 = 6.1957e-04
Loss = 1.2347e-01, PNorm = 34.9979, GNorm = 1.5374, lr_0 = 6.0527e-04
Validation rmse = 0.123970
Epoch 14
Loss = 1.2550e-01, PNorm = 35.0194, GNorm = 0.9168, lr_0 = 5.9130e-04
Loss = 1.2335e-01, PNorm = 35.0413, GNorm = 1.5391, lr_0 = 5.7765e-04
Validation rmse = 0.120459
Epoch 15
Loss = 1.1084e-01, PNorm = 35.0610, GNorm = 3.3647, lr_0 = 5.6300e-04
Validation rmse = 0.125666
Epoch 16
Loss = 1.1567e-01, PNorm = 35.0798, GNorm = 2.1427, lr_0 = 5.5000e-04
Loss = 1.1940e-01, PNorm = 35.0965, GNorm = 4.6735, lr_0 = 5.3731e-04
Validation rmse = 0.130139
Epoch 17
Loss = 1.2229e-01, PNorm = 35.1135, GNorm = 1.3965, lr_0 = 5.2368e-04
Loss = 1.0451e-01, PNorm = 35.1343, GNorm = 2.4099, lr_0 = 5.1159e-04
Validation rmse = 0.124860
Epoch 18
Loss = 1.3774e-01, PNorm = 35.1544, GNorm = 1.7131, lr_0 = 4.9862e-04
Loss = 1.2887e-01, PNorm = 35.1745, GNorm = 4.7073, lr_0 = 4.8711e-04
Validation rmse = 0.126027
Epoch 19
Loss = 1.2086e-01, PNorm = 35.1938, GNorm = 0.6431, lr_0 = 4.7587e-04
Validation rmse = 0.118886
Epoch 20
Loss = 9.3799e-02, PNorm = 35.2108, GNorm = 0.6926, lr_0 = 4.6380e-04
Loss = 1.1038e-01, PNorm = 35.2259, GNorm = 4.0836, lr_0 = 4.5309e-04
Validation rmse = 0.120276
Epoch 21
Loss = 8.7762e-02, PNorm = 35.2409, GNorm = 0.8466, lr_0 = 4.4263e-04
Loss = 1.1144e-01, PNorm = 35.2528, GNorm = 2.5360, lr_0 = 4.3242e-04
Validation rmse = 0.118345
Epoch 22
Loss = 1.0069e-01, PNorm = 35.2698, GNorm = 1.5328, lr_0 = 4.2145e-04
Loss = 9.4923e-02, PNorm = 35.2850, GNorm = 0.4644, lr_0 = 4.1172e-04
Validation rmse = 0.118289
Epoch 23
Loss = 1.0801e-01, PNorm = 35.2987, GNorm = 1.5950, lr_0 = 4.0222e-04
Validation rmse = 0.118433
Epoch 24
Loss = 1.0467e-01, PNorm = 35.3133, GNorm = 1.1239, lr_0 = 3.9202e-04
Loss = 8.9026e-02, PNorm = 35.3298, GNorm = 1.4319, lr_0 = 3.8297e-04
Validation rmse = 0.117037
Epoch 25
Loss = 9.1921e-02, PNorm = 35.3407, GNorm = 1.0599, lr_0 = 3.7413e-04
Loss = 9.0584e-02, PNorm = 35.3530, GNorm = 0.7654, lr_0 = 3.6549e-04
Validation rmse = 0.116878
Epoch 26
Loss = 8.5303e-02, PNorm = 35.3675, GNorm = 1.2680, lr_0 = 3.5622e-04
Loss = 9.4464e-02, PNorm = 35.3784, GNorm = 0.8066, lr_0 = 3.4800e-04
Loss = 8.9079e-02, PNorm = 35.3797, GNorm = 1.4970, lr_0 = 3.4719e-04
Validation rmse = 0.119065
Epoch 27
Loss = 8.6764e-02, PNorm = 35.3930, GNorm = 3.3095, lr_0 = 3.3918e-04
Validation rmse = 0.120081
Epoch 28
Loss = 9.0192e-02, PNorm = 35.4042, GNorm = 1.0378, lr_0 = 3.3135e-04
Loss = 9.2985e-02, PNorm = 35.4151, GNorm = 2.4476, lr_0 = 3.2370e-04
Validation rmse = 0.117976
Epoch 29
Loss = 7.3522e-02, PNorm = 35.4261, GNorm = 0.6912, lr_0 = 3.1549e-04
Loss = 9.2635e-02, PNorm = 35.4370, GNorm = 1.3447, lr_0 = 3.0821e-04
Validation rmse = 0.121141
Epoch 30
Loss = 9.3685e-02, PNorm = 35.4481, GNorm = 0.6527, lr_0 = 3.0109e-04
Loss = 8.1471e-02, PNorm = 35.4579, GNorm = 1.6387, lr_0 = 2.9414e-04
Loss = 8.4326e-02, PNorm = 35.4592, GNorm = 3.6918, lr_0 = 2.9346e-04
Validation rmse = 0.120930
Epoch 31
Loss = 8.8981e-02, PNorm = 35.4698, GNorm = 0.9960, lr_0 = 2.8668e-04
Validation rmse = 0.120926
Epoch 32
Loss = 5.5665e-02, PNorm = 35.4802, GNorm = 2.6434, lr_0 = 2.8007e-04
Loss = 8.9297e-02, PNorm = 35.4924, GNorm = 2.6045, lr_0 = 2.7360e-04
Validation rmse = 0.117129
Epoch 33
Loss = 8.1612e-02, PNorm = 35.5052, GNorm = 0.6463, lr_0 = 2.6666e-04
Loss = 8.6465e-02, PNorm = 35.5154, GNorm = 1.1234, lr_0 = 2.6051e-04
Validation rmse = 0.117152
Epoch 34
Loss = 8.1293e-02, PNorm = 35.5243, GNorm = 0.6284, lr_0 = 2.5390e-04
Loss = 8.5511e-02, PNorm = 35.5331, GNorm = 1.9145, lr_0 = 2.4804e-04
Validation rmse = 0.116449
Epoch 35
Loss = 8.2417e-02, PNorm = 35.5423, GNorm = 0.5067, lr_0 = 2.4232e-04
Validation rmse = 0.117121
Epoch 36
Loss = 9.4258e-02, PNorm = 35.5507, GNorm = 1.5752, lr_0 = 2.3617e-04
Loss = 7.6654e-02, PNorm = 35.5586, GNorm = 1.0245, lr_0 = 2.3072e-04
Validation rmse = 0.116692
Epoch 37
Loss = 8.4748e-02, PNorm = 35.5667, GNorm = 2.1209, lr_0 = 2.2539e-04
Loss = 7.9902e-02, PNorm = 35.5751, GNorm = 1.2002, lr_0 = 2.2019e-04
Validation rmse = 0.116960
Epoch 38
Loss = 7.5921e-02, PNorm = 35.5833, GNorm = 1.7125, lr_0 = 2.1461e-04
Loss = 7.8942e-02, PNorm = 35.5892, GNorm = 1.2141, lr_0 = 2.0965e-04
Validation rmse = 0.116469
Epoch 39
Loss = 7.9145e-02, PNorm = 35.5976, GNorm = 2.2701, lr_0 = 2.0481e-04
Validation rmse = 0.116866
Epoch 40
Loss = 9.4573e-02, PNorm = 35.6042, GNorm = 0.7958, lr_0 = 1.9962e-04
Loss = 7.2306e-02, PNorm = 35.6102, GNorm = 1.8427, lr_0 = 1.9501e-04
Validation rmse = 0.117643
Epoch 41
Loss = 8.1443e-02, PNorm = 35.6172, GNorm = 1.0269, lr_0 = 1.9051e-04
Loss = 7.5211e-02, PNorm = 35.6251, GNorm = 2.1485, lr_0 = 1.8611e-04
Validation rmse = 0.118249
Epoch 42
Loss = 6.8744e-02, PNorm = 35.6318, GNorm = 1.0553, lr_0 = 1.8139e-04
Validation rmse = 0.117168
Epoch 43
Loss = 8.1571e-02, PNorm = 35.6395, GNorm = 0.5955, lr_0 = 1.7679e-04
Loss = 7.9115e-02, PNorm = 35.6446, GNorm = 0.6362, lr_0 = 1.7271e-04
Validation rmse = 0.118768
Epoch 44
Loss = 7.9745e-02, PNorm = 35.6514, GNorm = 0.5100, lr_0 = 1.6873e-04
Loss = 7.2648e-02, PNorm = 35.6584, GNorm = 0.8315, lr_0 = 1.6483e-04
Validation rmse = 0.117775
Epoch 45
Loss = 7.4231e-02, PNorm = 35.6620, GNorm = 1.1121, lr_0 = 1.6065e-04
Loss = 7.7211e-02, PNorm = 35.6673, GNorm = 0.7027, lr_0 = 1.5694e-04
Validation rmse = 0.116963
Epoch 46
Loss = 8.7014e-02, PNorm = 35.6730, GNorm = 2.7963, lr_0 = 1.5332e-04
Validation rmse = 0.117078
Epoch 47
Loss = 8.5696e-02, PNorm = 35.6790, GNorm = 2.8483, lr_0 = 1.4943e-04
Loss = 7.7670e-02, PNorm = 35.6849, GNorm = 2.2186, lr_0 = 1.4598e-04
Validation rmse = 0.116326
Epoch 48
Loss = 7.8435e-02, PNorm = 35.6901, GNorm = 2.1137, lr_0 = 1.4261e-04
Loss = 7.5314e-02, PNorm = 35.6956, GNorm = 2.7403, lr_0 = 1.3932e-04
Validation rmse = 0.118644
Epoch 49
Loss = 7.3669e-02, PNorm = 35.7003, GNorm = 1.8917, lr_0 = 1.3579e-04
Loss = 7.7912e-02, PNorm = 35.7062, GNorm = 4.6226, lr_0 = 1.3265e-04
Validation rmse = 0.116291
Epoch 50
Loss = 7.2599e-02, PNorm = 35.7101, GNorm = 1.0968, lr_0 = 1.2959e-04
Validation rmse = 0.116834
Epoch 51
Loss = 7.4568e-02, PNorm = 35.7146, GNorm = 0.9038, lr_0 = 1.2630e-04
Loss = 6.7945e-02, PNorm = 35.7191, GNorm = 1.4118, lr_0 = 1.2339e-04
Validation rmse = 0.116691
Epoch 52
Loss = 5.6525e-02, PNorm = 35.7235, GNorm = 1.6897, lr_0 = 1.2026e-04
Loss = 7.4001e-02, PNorm = 35.7283, GNorm = 0.5567, lr_0 = 1.1748e-04
Validation rmse = 0.117404
Epoch 53
Loss = 6.5599e-02, PNorm = 35.7321, GNorm = 1.2397, lr_0 = 1.1477e-04
Loss = 7.6528e-02, PNorm = 35.7364, GNorm = 1.8806, lr_0 = 1.1212e-04
Validation rmse = 0.116231
Epoch 54
Loss = 7.3304e-02, PNorm = 35.7401, GNorm = 1.4158, lr_0 = 1.0928e-04
Validation rmse = 0.117235
Epoch 55
Loss = 6.9432e-02, PNorm = 35.7440, GNorm = 0.8708, lr_0 = 1.0676e-04
Loss = 7.6187e-02, PNorm = 35.7483, GNorm = 1.4427, lr_0 = 1.0429e-04
Validation rmse = 0.116132
Epoch 56
Loss = 6.3941e-02, PNorm = 35.7511, GNorm = 1.2425, lr_0 = 1.0165e-04
Loss = 7.3276e-02, PNorm = 35.7544, GNorm = 0.6293, lr_0 = 1.0000e-04
Validation rmse = 0.119030
Epoch 57
Loss = 7.9612e-02, PNorm = 35.7581, GNorm = 0.6835, lr_0 = 1.0000e-04
Loss = 6.7099e-02, PNorm = 35.7618, GNorm = 1.1375, lr_0 = 1.0000e-04
Validation rmse = 0.117889
Epoch 58
Loss = 6.6763e-02, PNorm = 35.7655, GNorm = 0.8260, lr_0 = 1.0000e-04
Validation rmse = 0.116288
Epoch 59
Loss = 7.0967e-02, PNorm = 35.7685, GNorm = 1.8704, lr_0 = 1.0000e-04
Loss = 6.7098e-02, PNorm = 35.7720, GNorm = 0.7509, lr_0 = 1.0000e-04
Validation rmse = 0.118101
Model 0 best validation rmse = 0.116132 on epoch 55
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.089382
Ensemble test rmse = 0.089382
1-fold cross validation
	Seed 0 ==> test rmse = 0.089382
Overall test rmse = 0.089382 +/- 0.000000
Elapsed time = 0:00:43
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,087 | train size = 864 | val size = 217 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.2650e-01, PNorm = 34.0173, GNorm = 1.3807, lr_0 = 3.9118e-04
Validation rmse = 0.286992
Epoch 1
Loss = 5.7958e-01, PNorm = 34.0507, GNorm = 10.1248, lr_0 = 6.8235e-04
Loss = 6.7228e-01, PNorm = 34.0871, GNorm = 6.3748, lr_0 = 9.4706e-04
Validation rmse = 0.274497
Epoch 2
Loss = 5.4012e-01, PNorm = 34.1596, GNorm = 0.9385, lr_0 = 9.7920e-04
Loss = 4.4942e-01, PNorm = 34.2237, GNorm = 5.1606, lr_0 = 9.5660e-04
Validation rmse = 0.231018
Epoch 3
Loss = 3.7352e-01, PNorm = 34.2872, GNorm = 5.3542, lr_0 = 9.3234e-04
Validation rmse = 0.212766
Epoch 4
Loss = 3.5376e-01, PNorm = 34.3479, GNorm = 4.6438, lr_0 = 9.1082e-04
Loss = 3.0095e-01, PNorm = 34.3948, GNorm = 0.9036, lr_0 = 8.8980e-04
Validation rmse = 0.179801
Epoch 5
Loss = 2.2938e-01, PNorm = 34.4435, GNorm = 2.6434, lr_0 = 8.6723e-04
Loss = 2.4793e-01, PNorm = 34.4871, GNorm = 1.6150, lr_0 = 8.4721e-04
Validation rmse = 0.172315
Epoch 6
Loss = 2.0466e-01, PNorm = 34.5351, GNorm = 3.1308, lr_0 = 8.2573e-04
Loss = 2.3411e-01, PNorm = 34.5764, GNorm = 1.3399, lr_0 = 8.0667e-04
Loss = 1.2075e-01, PNorm = 34.5813, GNorm = 1.6522, lr_0 = 8.0478e-04
Validation rmse = 0.195229
Epoch 7
Loss = 2.2058e-01, PNorm = 34.6215, GNorm = 1.6398, lr_0 = 7.8621e-04
Validation rmse = 0.155345
Epoch 8
Loss = 1.6646e-01, PNorm = 34.6638, GNorm = 2.6793, lr_0 = 7.6806e-04
Loss = 1.6883e-01, PNorm = 34.6999, GNorm = 3.3172, lr_0 = 7.5033e-04
Validation rmse = 0.153695
Epoch 9
Loss = 1.7046e-01, PNorm = 34.7374, GNorm = 0.9730, lr_0 = 7.3130e-04
Loss = 1.4518e-01, PNorm = 34.7714, GNorm = 2.8853, lr_0 = 7.1442e-04
Validation rmse = 0.140654
Epoch 10
Loss = 1.3022e-01, PNorm = 34.8068, GNorm = 0.9284, lr_0 = 6.9630e-04
Loss = 1.4975e-01, PNorm = 34.8378, GNorm = 1.4363, lr_0 = 6.8023e-04
Validation rmse = 0.181003
Epoch 11
Loss = 1.8483e-01, PNorm = 34.8627, GNorm = 0.7851, lr_0 = 6.6453e-04
Validation rmse = 0.133445
Epoch 12
Loss = 1.3764e-01, PNorm = 34.8933, GNorm = 3.5976, lr_0 = 6.4768e-04
Loss = 1.2985e-01, PNorm = 34.9164, GNorm = 2.8289, lr_0 = 6.3273e-04
Validation rmse = 0.130855
Epoch 13
Loss = 1.2503e-01, PNorm = 34.9399, GNorm = 3.3365, lr_0 = 6.1668e-04
Loss = 1.1618e-01, PNorm = 34.9650, GNorm = 1.2271, lr_0 = 6.0245e-04
Validation rmse = 0.130442
Epoch 14
Loss = 1.2089e-01, PNorm = 34.9841, GNorm = 1.6194, lr_0 = 5.8717e-04
Validation rmse = 0.134041
Epoch 15
Loss = 8.4738e-02, PNorm = 35.0015, GNorm = 2.4103, lr_0 = 5.7362e-04
Loss = 1.1398e-01, PNorm = 35.0243, GNorm = 2.8310, lr_0 = 5.6037e-04
Validation rmse = 0.124735
Epoch 16
Loss = 8.7320e-02, PNorm = 35.0440, GNorm = 1.1169, lr_0 = 5.4616e-04
Loss = 1.2019e-01, PNorm = 35.0630, GNorm = 4.8453, lr_0 = 5.3356e-04
Validation rmse = 0.124460
Epoch 17
Loss = 1.0767e-01, PNorm = 35.0827, GNorm = 3.4031, lr_0 = 5.2003e-04
Loss = 1.0715e-01, PNorm = 35.1015, GNorm = 2.3296, lr_0 = 5.0802e-04
Validation rmse = 0.124586
Epoch 18
Loss = 1.0413e-01, PNorm = 35.1170, GNorm = 4.1136, lr_0 = 4.9630e-04
Validation rmse = 0.140724
Epoch 19
Loss = 1.2507e-01, PNorm = 35.1378, GNorm = 2.9529, lr_0 = 4.8371e-04
Loss = 9.9327e-02, PNorm = 35.1550, GNorm = 0.6007, lr_0 = 4.7254e-04
Validation rmse = 0.123619
Epoch 20
Loss = 9.6935e-02, PNorm = 35.1737, GNorm = 0.9358, lr_0 = 4.6056e-04
Loss = 1.0196e-01, PNorm = 35.1891, GNorm = 1.6259, lr_0 = 4.4993e-04
Validation rmse = 0.129485
Epoch 21
Loss = 1.0134e-01, PNorm = 35.2084, GNorm = 0.5756, lr_0 = 4.3852e-04
Loss = 9.4621e-02, PNorm = 35.2215, GNorm = 3.8756, lr_0 = 4.2840e-04
Validation rmse = 0.121684
Epoch 22
Loss = 9.9982e-02, PNorm = 35.2338, GNorm = 3.6218, lr_0 = 4.1851e-04
Validation rmse = 0.134527
Epoch 23
Loss = 1.2176e-01, PNorm = 35.2483, GNorm = 3.0350, lr_0 = 4.0789e-04
Loss = 9.8430e-02, PNorm = 35.2609, GNorm = 1.1517, lr_0 = 3.9848e-04
Validation rmse = 0.129882
Epoch 24
Loss = 9.9491e-02, PNorm = 35.2751, GNorm = 1.7403, lr_0 = 3.8837e-04
Loss = 8.7858e-02, PNorm = 35.2895, GNorm = 2.0919, lr_0 = 3.7941e-04
Validation rmse = 0.136994
Epoch 25
Loss = 9.5342e-02, PNorm = 35.3021, GNorm = 2.0089, lr_0 = 3.7065e-04
Validation rmse = 0.132668
Epoch 26
Loss = 1.1601e-01, PNorm = 35.3156, GNorm = 3.5085, lr_0 = 3.6125e-04
Loss = 1.0299e-01, PNorm = 35.3251, GNorm = 1.1512, lr_0 = 3.5291e-04
Validation rmse = 0.122056
Epoch 27
Loss = 9.6784e-02, PNorm = 35.3393, GNorm = 1.0863, lr_0 = 3.4396e-04
Loss = 7.9584e-02, PNorm = 35.3510, GNorm = 0.7813, lr_0 = 3.3602e-04
Validation rmse = 0.120249
Epoch 28
Loss = 7.4309e-02, PNorm = 35.3622, GNorm = 0.4948, lr_0 = 3.2750e-04
Loss = 8.6988e-02, PNorm = 35.3734, GNorm = 0.8110, lr_0 = 3.1994e-04
Validation rmse = 0.119131
Epoch 29
Loss = 7.4687e-02, PNorm = 35.3822, GNorm = 1.4188, lr_0 = 3.1256e-04
Validation rmse = 0.119766
Epoch 30
Loss = 1.1854e-01, PNorm = 35.3939, GNorm = 3.8546, lr_0 = 3.0463e-04
Loss = 8.3883e-02, PNorm = 35.4045, GNorm = 1.8683, lr_0 = 2.9760e-04
Validation rmse = 0.119186
Epoch 31
Loss = 7.6584e-02, PNorm = 35.4133, GNorm = 0.9855, lr_0 = 2.9005e-04
Loss = 8.6766e-02, PNorm = 35.4221, GNorm = 0.6881, lr_0 = 2.8336e-04
Validation rmse = 0.119140
Epoch 32
Loss = 7.5991e-02, PNorm = 35.4322, GNorm = 2.3623, lr_0 = 2.7617e-04
Loss = 8.3645e-02, PNorm = 35.4412, GNorm = 1.8575, lr_0 = 2.6980e-04
Validation rmse = 0.121882
Epoch 33
Loss = 8.1466e-02, PNorm = 35.4511, GNorm = 0.5308, lr_0 = 2.6357e-04
Validation rmse = 0.118674
Epoch 34
Loss = 7.9864e-02, PNorm = 35.4625, GNorm = 2.2660, lr_0 = 2.5688e-04
Loss = 8.0464e-02, PNorm = 35.4716, GNorm = 2.7334, lr_0 = 2.5095e-04
Validation rmse = 0.118755
Epoch 35
Loss = 7.4316e-02, PNorm = 35.4798, GNorm = 2.0923, lr_0 = 2.4459e-04
Loss = 7.7646e-02, PNorm = 35.4875, GNorm = 1.2929, lr_0 = 2.3894e-04
Validation rmse = 0.117091
Epoch 36
Loss = 6.6123e-02, PNorm = 35.4951, GNorm = 0.9977, lr_0 = 2.3343e-04
Validation rmse = 0.123258
Epoch 37
Loss = 7.6790e-02, PNorm = 35.5031, GNorm = 2.5285, lr_0 = 2.2751e-04
Loss = 7.2389e-02, PNorm = 35.5113, GNorm = 0.6676, lr_0 = 2.2226e-04
Validation rmse = 0.118879
Epoch 38
Loss = 7.4459e-02, PNorm = 35.5209, GNorm = 3.0258, lr_0 = 2.1662e-04
Loss = 7.9303e-02, PNorm = 35.5288, GNorm = 0.8615, lr_0 = 2.1162e-04
Validation rmse = 0.117488
Epoch 39
Loss = 6.6322e-02, PNorm = 35.5363, GNorm = 0.7902, lr_0 = 2.0625e-04
Loss = 7.7715e-02, PNorm = 35.5426, GNorm = 0.9588, lr_0 = 2.0149e-04
Validation rmse = 0.120381
Epoch 40
Loss = 7.7056e-02, PNorm = 35.5493, GNorm = 0.7519, lr_0 = 1.9684e-04
Validation rmse = 0.119881
Epoch 41
Loss = 6.5405e-02, PNorm = 35.5574, GNorm = 2.9214, lr_0 = 1.9185e-04
Loss = 7.6638e-02, PNorm = 35.5634, GNorm = 1.6500, lr_0 = 1.8742e-04
Validation rmse = 0.116552
Epoch 42
Loss = 7.1640e-02, PNorm = 35.5720, GNorm = 1.4715, lr_0 = 1.8267e-04
Loss = 6.9497e-02, PNorm = 35.5784, GNorm = 0.9391, lr_0 = 1.7845e-04
Validation rmse = 0.116430
Epoch 43
Loss = 6.3643e-02, PNorm = 35.5836, GNorm = 2.0618, lr_0 = 1.7433e-04
Loss = 7.6189e-02, PNorm = 35.5881, GNorm = 0.7241, lr_0 = 1.7031e-04
Loss = 6.0224e-02, PNorm = 35.5887, GNorm = 1.1000, lr_0 = 1.6991e-04
Validation rmse = 0.116558
Epoch 44
Loss = 6.9055e-02, PNorm = 35.5958, GNorm = 0.6396, lr_0 = 1.6599e-04
Validation rmse = 0.118271
Epoch 45
Loss = 6.4400e-02, PNorm = 35.6017, GNorm = 0.6450, lr_0 = 1.6178e-04
Loss = 6.4890e-02, PNorm = 35.6064, GNorm = 2.6457, lr_0 = 1.5805e-04
Validation rmse = 0.117781
Epoch 46
Loss = 6.2164e-02, PNorm = 35.6129, GNorm = 1.5391, lr_0 = 1.5404e-04
Loss = 7.2471e-02, PNorm = 35.6183, GNorm = 0.6081, lr_0 = 1.5048e-04
Validation rmse = 0.116290
Epoch 47
Loss = 6.6809e-02, PNorm = 35.6224, GNorm = 0.4635, lr_0 = 1.4701e-04
Validation rmse = 0.116945
Epoch 48
Loss = 4.7521e-02, PNorm = 35.6278, GNorm = 1.0341, lr_0 = 1.4328e-04
Loss = 6.6895e-02, PNorm = 35.6330, GNorm = 1.3767, lr_0 = 1.3997e-04
Validation rmse = 0.117397
Epoch 49
Loss = 6.4791e-02, PNorm = 35.6375, GNorm = 1.8697, lr_0 = 1.3642e-04
Loss = 6.9189e-02, PNorm = 35.6426, GNorm = 1.4173, lr_0 = 1.3327e-04
Validation rmse = 0.116925
Epoch 50
Loss = 6.4079e-02, PNorm = 35.6468, GNorm = 1.4717, lr_0 = 1.3020e-04
Loss = 6.5682e-02, PNorm = 35.6512, GNorm = 0.8874, lr_0 = 1.2719e-04
Validation rmse = 0.119776
Epoch 51
Loss = 6.3238e-02, PNorm = 35.6563, GNorm = 2.0712, lr_0 = 1.2397e-04
Validation rmse = 0.115793
Epoch 52
Loss = 5.0920e-02, PNorm = 35.6600, GNorm = 1.7975, lr_0 = 1.2082e-04
Loss = 6.7104e-02, PNorm = 35.6642, GNorm = 0.6552, lr_0 = 1.1803e-04
Validation rmse = 0.116419
Epoch 53
Loss = 6.2909e-02, PNorm = 35.6671, GNorm = 0.9628, lr_0 = 1.1504e-04
Loss = 6.4374e-02, PNorm = 35.6707, GNorm = 1.1806, lr_0 = 1.1239e-04
Validation rmse = 0.115257
Epoch 54
Loss = 5.5659e-02, PNorm = 35.6740, GNorm = 0.6467, lr_0 = 1.0979e-04
Loss = 6.9237e-02, PNorm = 35.6776, GNorm = 1.5298, lr_0 = 1.0726e-04
Loss = 5.8621e-02, PNorm = 35.6779, GNorm = 1.4405, lr_0 = 1.0701e-04
Validation rmse = 0.116842
Epoch 55
Loss = 6.5211e-02, PNorm = 35.6818, GNorm = 0.9334, lr_0 = 1.0454e-04
Validation rmse = 0.114750
Epoch 56
Loss = 7.4099e-02, PNorm = 35.6849, GNorm = 1.4127, lr_0 = 1.0189e-04
Loss = 6.7580e-02, PNorm = 35.6887, GNorm = 2.8971, lr_0 = 1.0000e-04
Validation rmse = 0.124338
Epoch 57
Loss = 6.9361e-02, PNorm = 35.6930, GNorm = 0.6862, lr_0 = 1.0000e-04
Loss = 6.1129e-02, PNorm = 35.6960, GNorm = 0.7860, lr_0 = 1.0000e-04
Validation rmse = 0.116463
Epoch 58
Loss = 6.0431e-02, PNorm = 35.6993, GNorm = 0.6601, lr_0 = 1.0000e-04
Validation rmse = 0.116101
Epoch 59
Loss = 6.6881e-02, PNorm = 35.7030, GNorm = 0.6238, lr_0 = 1.0000e-04
Loss = 6.4571e-02, PNorm = 35.7061, GNorm = 1.4771, lr_0 = 1.0000e-04
Validation rmse = 0.117190
Model 0 best validation rmse = 0.114750 on epoch 55
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.087609
Ensemble test rmse = 0.087609
1-fold cross validation
	Seed 0 ==> test rmse = 0.087609
Overall test rmse = 0.087609 +/- 0.000000
Elapsed time = 0:00:44
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,077 | train size = 856 | val size = 215 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.4287e-01, PNorm = 34.0173, GNorm = 3.1202, lr_0 = 3.9118e-04
Validation rmse = 0.278351
Epoch 1
Loss = 6.3082e-01, PNorm = 34.0437, GNorm = 4.6582, lr_0 = 6.8235e-04
Loss = 6.4475e-01, PNorm = 34.0858, GNorm = 4.3103, lr_0 = 9.4706e-04
Validation rmse = 0.277130
Epoch 2
Loss = 5.3758e-01, PNorm = 34.1570, GNorm = 3.6215, lr_0 = 9.7920e-04
Loss = 5.5350e-01, PNorm = 34.2241, GNorm = 2.6774, lr_0 = 9.5660e-04
Validation rmse = 0.243442
Epoch 3
Loss = 4.2449e-01, PNorm = 34.3000, GNorm = 2.4173, lr_0 = 9.3234e-04
Validation rmse = 0.205231
Epoch 4
Loss = 3.8785e-01, PNorm = 34.3644, GNorm = 1.7216, lr_0 = 9.0869e-04
Loss = 3.2488e-01, PNorm = 34.4223, GNorm = 4.2300, lr_0 = 8.8772e-04
Validation rmse = 0.187508
Epoch 5
Loss = 3.0950e-01, PNorm = 34.4814, GNorm = 1.8954, lr_0 = 8.6521e-04
Loss = 2.4929e-01, PNorm = 34.5279, GNorm = 2.3070, lr_0 = 8.4524e-04
Validation rmse = 0.167453
Epoch 6
Loss = 2.2784e-01, PNorm = 34.5788, GNorm = 1.1967, lr_0 = 8.2380e-04
Validation rmse = 0.160686
Epoch 7
Loss = 1.9074e-01, PNorm = 34.6252, GNorm = 4.6428, lr_0 = 8.0291e-04
Loss = 2.0703e-01, PNorm = 34.6597, GNorm = 6.6217, lr_0 = 7.8437e-04
Validation rmse = 0.138141
Epoch 8
Loss = 1.6704e-01, PNorm = 34.6988, GNorm = 2.3498, lr_0 = 7.6448e-04
Loss = 1.7778e-01, PNorm = 34.7397, GNorm = 2.0671, lr_0 = 7.4684e-04
Validation rmse = 0.143586
Epoch 9
Loss = 1.7095e-01, PNorm = 34.7643, GNorm = 1.6924, lr_0 = 7.2960e-04
Loss = 1.5539e-01, PNorm = 34.7934, GNorm = 0.6444, lr_0 = 7.1276e-04
Validation rmse = 0.132707
Epoch 10
Loss = 1.4136e-01, PNorm = 34.8283, GNorm = 4.2869, lr_0 = 6.9468e-04
Validation rmse = 0.140839
Epoch 11
Loss = 1.1176e-01, PNorm = 34.8506, GNorm = 3.7103, lr_0 = 6.7706e-04
Loss = 1.5525e-01, PNorm = 34.8695, GNorm = 5.3896, lr_0 = 6.6143e-04
Validation rmse = 0.141703
Epoch 12
Loss = 1.5427e-01, PNorm = 34.8980, GNorm = 3.9851, lr_0 = 6.4466e-04
Loss = 1.2024e-01, PNorm = 34.9223, GNorm = 1.3203, lr_0 = 6.2978e-04
Validation rmse = 0.125288
Epoch 13
Loss = 1.1304e-01, PNorm = 34.9469, GNorm = 1.0468, lr_0 = 6.1381e-04
Validation rmse = 0.122085
Epoch 14
Loss = 7.0232e-02, PNorm = 34.9689, GNorm = 0.8194, lr_0 = 5.9824e-04
Loss = 1.2903e-01, PNorm = 34.9874, GNorm = 1.2448, lr_0 = 5.8443e-04
Validation rmse = 0.142260
Epoch 15
Loss = 1.5907e-01, PNorm = 35.0089, GNorm = 3.0611, lr_0 = 5.6961e-04
Loss = 1.3180e-01, PNorm = 35.0299, GNorm = 2.1622, lr_0 = 5.5646e-04
Validation rmse = 0.129589
Epoch 16
Loss = 1.2321e-01, PNorm = 35.0508, GNorm = 2.5456, lr_0 = 5.4235e-04
Loss = 1.0431e-01, PNorm = 35.0658, GNorm = 2.1017, lr_0 = 5.2983e-04
Validation rmse = 0.135864
Epoch 17
Loss = 1.0899e-01, PNorm = 35.0815, GNorm = 2.3474, lr_0 = 5.1760e-04
Validation rmse = 0.138456
Epoch 18
Loss = 1.6518e-01, PNorm = 35.0988, GNorm = 5.4197, lr_0 = 5.0448e-04
Loss = 1.4257e-01, PNorm = 35.1142, GNorm = 3.0557, lr_0 = 4.9283e-04
Validation rmse = 0.121675
Epoch 19
Loss = 1.1285e-01, PNorm = 35.1322, GNorm = 1.7126, lr_0 = 4.8033e-04
Loss = 1.0220e-01, PNorm = 35.1480, GNorm = 1.5134, lr_0 = 4.6924e-04
Validation rmse = 0.122537
Epoch 20
Loss = 1.1626e-01, PNorm = 35.1683, GNorm = 3.0714, lr_0 = 4.5734e-04
Validation rmse = 0.122375
Epoch 21
Loss = 8.7738e-02, PNorm = 35.1828, GNorm = 0.7197, lr_0 = 4.4575e-04
Loss = 1.1965e-01, PNorm = 35.1960, GNorm = 2.1145, lr_0 = 4.3546e-04
Validation rmse = 0.135044
Epoch 22
Loss = 9.3559e-02, PNorm = 35.2054, GNorm = 1.3797, lr_0 = 4.2441e-04
Loss = 1.0067e-01, PNorm = 35.2191, GNorm = 1.3517, lr_0 = 4.1462e-04
Validation rmse = 0.119900
Epoch 23
Loss = 9.3815e-02, PNorm = 35.2327, GNorm = 2.3701, lr_0 = 4.0410e-04
Loss = 9.1325e-02, PNorm = 35.2446, GNorm = 0.5667, lr_0 = 3.9477e-04
Loss = 9.8966e-02, PNorm = 35.2457, GNorm = 1.4999, lr_0 = 3.9385e-04
Validation rmse = 0.130780
Epoch 24
Loss = 9.3147e-02, PNorm = 35.2559, GNorm = 1.2245, lr_0 = 3.8476e-04
Validation rmse = 0.117124
Epoch 25
Loss = 7.8240e-02, PNorm = 35.2660, GNorm = 0.3784, lr_0 = 3.7588e-04
Loss = 8.8569e-02, PNorm = 35.2748, GNorm = 2.1666, lr_0 = 3.6721e-04
Validation rmse = 0.115561
Epoch 26
Loss = 1.1271e-01, PNorm = 35.2895, GNorm = 1.4712, lr_0 = 3.5789e-04
Loss = 1.0353e-01, PNorm = 35.3005, GNorm = 1.0215, lr_0 = 3.4963e-04
Validation rmse = 0.119938
Epoch 27
Loss = 9.1550e-02, PNorm = 35.3134, GNorm = 1.0669, lr_0 = 3.4076e-04
Validation rmse = 0.119462
Epoch 28
Loss = 7.5884e-02, PNorm = 35.3239, GNorm = 0.6573, lr_0 = 3.3212e-04
Loss = 8.3511e-02, PNorm = 35.3333, GNorm = 1.2272, lr_0 = 3.2446e-04
Validation rmse = 0.118706
Epoch 29
Loss = 8.1268e-02, PNorm = 35.3426, GNorm = 1.0128, lr_0 = 3.1623e-04
Loss = 8.4694e-02, PNorm = 35.3523, GNorm = 0.8042, lr_0 = 3.0893e-04
Validation rmse = 0.116405
Epoch 30
Loss = 7.7572e-02, PNorm = 35.3598, GNorm = 0.9471, lr_0 = 3.0109e-04
Loss = 8.4314e-02, PNorm = 35.3671, GNorm = 0.4296, lr_0 = 2.9414e-04
Loss = 4.9929e-02, PNorm = 35.3680, GNorm = 2.6825, lr_0 = 2.9346e-04
Validation rmse = 0.114825
Epoch 31
Loss = 8.1372e-02, PNorm = 35.3768, GNorm = 0.9306, lr_0 = 2.8668e-04
Validation rmse = 0.122034
Epoch 32
Loss = 7.7359e-02, PNorm = 35.3857, GNorm = 0.7758, lr_0 = 2.7941e-04
Loss = 7.7458e-02, PNorm = 35.3951, GNorm = 1.1411, lr_0 = 2.7296e-04
Validation rmse = 0.114522
Epoch 33
Loss = 7.2966e-02, PNorm = 35.4019, GNorm = 0.6114, lr_0 = 2.6604e-04
Loss = 7.8914e-02, PNorm = 35.4078, GNorm = 0.9877, lr_0 = 2.5990e-04
Validation rmse = 0.115326
Epoch 34
Loss = 7.5678e-02, PNorm = 35.4152, GNorm = 1.1629, lr_0 = 2.5390e-04
Validation rmse = 0.118410
Epoch 35
Loss = 7.5607e-02, PNorm = 35.4231, GNorm = 0.4681, lr_0 = 2.4746e-04
Loss = 8.2058e-02, PNorm = 35.4308, GNorm = 1.2938, lr_0 = 2.4175e-04
Validation rmse = 0.117695
Epoch 36
Loss = 7.8118e-02, PNorm = 35.4380, GNorm = 2.2150, lr_0 = 2.3562e-04
Loss = 8.0228e-02, PNorm = 35.4448, GNorm = 1.4554, lr_0 = 2.3018e-04
Validation rmse = 0.115971
Epoch 37
Loss = 7.2000e-02, PNorm = 35.4520, GNorm = 0.5554, lr_0 = 2.2434e-04
Loss = 7.6917e-02, PNorm = 35.4572, GNorm = 1.0557, lr_0 = 2.1916e-04
Loss = 5.4805e-02, PNorm = 35.4579, GNorm = 1.4537, lr_0 = 2.1865e-04
Validation rmse = 0.117425
Epoch 38
Loss = 6.6774e-02, PNorm = 35.4642, GNorm = 0.7577, lr_0 = 2.1361e-04
Validation rmse = 0.114151
Epoch 39
Loss = 6.3515e-02, PNorm = 35.4716, GNorm = 0.8204, lr_0 = 2.0819e-04
Loss = 7.4742e-02, PNorm = 35.4782, GNorm = 1.2084, lr_0 = 2.0338e-04
Validation rmse = 0.115761
Epoch 40
Loss = 7.7594e-02, PNorm = 35.4840, GNorm = 1.3765, lr_0 = 1.9823e-04
Loss = 7.4108e-02, PNorm = 35.4894, GNorm = 0.9161, lr_0 = 1.9365e-04
Validation rmse = 0.117458
Epoch 41
Loss = 7.0370e-02, PNorm = 35.4947, GNorm = 0.6035, lr_0 = 1.8874e-04
Validation rmse = 0.112775
Epoch 42
Loss = 6.9264e-02, PNorm = 35.5001, GNorm = 1.2664, lr_0 = 1.8438e-04
Loss = 6.9285e-02, PNorm = 35.5045, GNorm = 0.7332, lr_0 = 1.8013e-04
Validation rmse = 0.113704
Epoch 43
Loss = 7.2753e-02, PNorm = 35.5097, GNorm = 0.7446, lr_0 = 1.7556e-04
Loss = 7.0429e-02, PNorm = 35.5150, GNorm = 0.5029, lr_0 = 1.7151e-04
Validation rmse = 0.114752
Epoch 44
Loss = 6.4937e-02, PNorm = 35.5184, GNorm = 0.9480, lr_0 = 1.6716e-04
Loss = 7.6294e-02, PNorm = 35.5237, GNorm = 2.2029, lr_0 = 1.6330e-04
Loss = 2.9163e-02, PNorm = 35.5242, GNorm = 1.0812, lr_0 = 1.6292e-04
Validation rmse = 0.120657
Epoch 45
Loss = 6.6113e-02, PNorm = 35.5290, GNorm = 0.5484, lr_0 = 1.5916e-04
Validation rmse = 0.112884
Epoch 46
Loss = 4.6939e-02, PNorm = 35.5335, GNorm = 0.4693, lr_0 = 1.5512e-04
Loss = 7.1441e-02, PNorm = 35.5377, GNorm = 0.7694, lr_0 = 1.5154e-04
Validation rmse = 0.116944
Epoch 47
Loss = 6.9476e-02, PNorm = 35.5424, GNorm = 1.4818, lr_0 = 1.4770e-04
Loss = 6.9694e-02, PNorm = 35.5468, GNorm = 0.7266, lr_0 = 1.4429e-04
Validation rmse = 0.113713
Epoch 48
Loss = 7.1510e-02, PNorm = 35.5506, GNorm = 2.4836, lr_0 = 1.4063e-04
Validation rmse = 0.112604
Epoch 49
Loss = 5.9182e-02, PNorm = 35.5543, GNorm = 0.7754, lr_0 = 1.3706e-04
Loss = 6.9721e-02, PNorm = 35.5588, GNorm = 1.6761, lr_0 = 1.3390e-04
Validation rmse = 0.112795
Epoch 50
Loss = 6.2381e-02, PNorm = 35.5629, GNorm = 0.8832, lr_0 = 1.3081e-04
Loss = 7.6546e-02, PNorm = 35.5676, GNorm = 1.0978, lr_0 = 1.2779e-04
Validation rmse = 0.112966
Epoch 51
Loss = 7.1474e-02, PNorm = 35.5724, GNorm = 1.8092, lr_0 = 1.2455e-04
Loss = 6.4999e-02, PNorm = 35.5760, GNorm = 0.7256, lr_0 = 1.2167e-04
Loss = 2.6115e-02, PNorm = 35.5763, GNorm = 1.3025, lr_0 = 1.2139e-04
Validation rmse = 0.113382
Epoch 52
Loss = 6.4626e-02, PNorm = 35.5789, GNorm = 1.2129, lr_0 = 1.1859e-04
Validation rmse = 0.113378
Epoch 53
Loss = 5.8673e-02, PNorm = 35.5826, GNorm = 2.0993, lr_0 = 1.1558e-04
Loss = 6.8964e-02, PNorm = 35.5856, GNorm = 1.3895, lr_0 = 1.1291e-04
Validation rmse = 0.114786
Epoch 54
Loss = 6.0851e-02, PNorm = 35.5900, GNorm = 0.5871, lr_0 = 1.1005e-04
Loss = 6.7478e-02, PNorm = 35.5926, GNorm = 1.0352, lr_0 = 1.0751e-04
Validation rmse = 0.113931
Epoch 55
Loss = 6.3475e-02, PNorm = 35.5963, GNorm = 0.5791, lr_0 = 1.0478e-04
Validation rmse = 0.112218
Epoch 56
Loss = 5.3676e-02, PNorm = 35.5993, GNorm = 1.0938, lr_0 = 1.0212e-04
Loss = 6.7805e-02, PNorm = 35.6017, GNorm = 1.0705, lr_0 = 1.0000e-04
Validation rmse = 0.115729
Epoch 57
Loss = 6.9432e-02, PNorm = 35.6051, GNorm = 0.8345, lr_0 = 1.0000e-04
Loss = 5.9777e-02, PNorm = 35.6086, GNorm = 1.3644, lr_0 = 1.0000e-04
Validation rmse = 0.115220
Epoch 58
Loss = 7.2002e-02, PNorm = 35.6122, GNorm = 0.8372, lr_0 = 1.0000e-04
Loss = 5.7841e-02, PNorm = 35.6146, GNorm = 2.0690, lr_0 = 1.0000e-04
Validation rmse = 0.112495
Epoch 59
Loss = 6.6738e-02, PNorm = 35.6178, GNorm = 2.0438, lr_0 = 1.0000e-04
Validation rmse = 0.114304
Model 0 best validation rmse = 0.112218 on epoch 55
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.081319
Ensemble test rmse = 0.081319
1-fold cross validation
	Seed 0 ==> test rmse = 0.081319
Overall test rmse = 0.081319 +/- 0.000000
Elapsed time = 0:00:43
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_train_dm300_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,067 | train size = 848 | val size = 213 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.2167e-01, PNorm = 34.0184, GNorm = 1.4925, lr_0 = 4.0937e-04
Validation rmse = 0.249726
Epoch 1
Loss = 7.2288e-01, PNorm = 34.0523, GNorm = 1.6514, lr_0 = 7.1875e-04
Loss = 7.0393e-01, PNorm = 34.0986, GNorm = 2.7798, lr_0 = 1.0000e-03
Validation rmse = 0.223586
Epoch 2
Loss = 5.1216e-01, PNorm = 34.1615, GNorm = 3.9994, lr_0 = 9.7549e-04
Loss = 4.0862e-01, PNorm = 34.2301, GNorm = 2.7957, lr_0 = 9.5159e-04
Validation rmse = 0.195673
Epoch 3
Loss = 3.6412e-01, PNorm = 34.2994, GNorm = 1.3397, lr_0 = 9.2827e-04
Validation rmse = 0.170978
Epoch 4
Loss = 2.6126e-01, PNorm = 34.3557, GNorm = 2.0141, lr_0 = 9.0552e-04
Loss = 2.5983e-01, PNorm = 34.4152, GNorm = 7.1073, lr_0 = 8.8333e-04
Validation rmse = 0.158150
Epoch 5
Loss = 2.2195e-01, PNorm = 34.4711, GNorm = 1.2557, lr_0 = 8.6168e-04
Loss = 1.9788e-01, PNorm = 34.5197, GNorm = 3.9560, lr_0 = 8.4056e-04
Validation rmse = 0.150502
Epoch 6
Loss = 2.0709e-01, PNorm = 34.5624, GNorm = 4.1001, lr_0 = 8.1996e-04
Validation rmse = 0.142859
Epoch 7
Loss = 1.6510e-01, PNorm = 34.6046, GNorm = 2.0755, lr_0 = 7.9987e-04
Loss = 1.6527e-01, PNorm = 34.6426, GNorm = 1.0703, lr_0 = 7.8026e-04
Validation rmse = 0.163688
Epoch 8
Loss = 1.7788e-01, PNorm = 34.6740, GNorm = 1.1080, lr_0 = 7.6114e-04
Loss = 1.6638e-01, PNorm = 34.7055, GNorm = 1.4486, lr_0 = 7.4249e-04
Validation rmse = 0.145231
Epoch 9
Loss = 1.4128e-01, PNorm = 34.7376, GNorm = 5.9761, lr_0 = 7.2429e-04
Validation rmse = 0.133706
Epoch 10
Loss = 1.7611e-01, PNorm = 34.7653, GNorm = 3.6217, lr_0 = 7.0654e-04
Loss = 1.3949e-01, PNorm = 34.7974, GNorm = 1.1379, lr_0 = 6.8923e-04
Validation rmse = 0.147944
Epoch 11
Loss = 1.2073e-01, PNorm = 34.8267, GNorm = 2.8323, lr_0 = 6.7234e-04
Loss = 1.0728e-01, PNorm = 34.8475, GNorm = 2.2706, lr_0 = 6.5586e-04
Validation rmse = 0.132985
Epoch 12
Loss = 1.0466e-01, PNorm = 34.8687, GNorm = 2.0910, lr_0 = 6.3979e-04
Loss = 1.2575e-01, PNorm = 34.8897, GNorm = 3.2671, lr_0 = 6.2411e-04
Validation rmse = 0.129846
Epoch 13
Loss = 1.2474e-01, PNorm = 34.9096, GNorm = 1.7508, lr_0 = 6.0881e-04
Validation rmse = 0.128707
Epoch 14
Loss = 1.1393e-01, PNorm = 34.9299, GNorm = 2.0452, lr_0 = 5.9389e-04
Loss = 8.9537e-02, PNorm = 34.9495, GNorm = 0.7508, lr_0 = 5.7934e-04
Validation rmse = 0.122739
Epoch 15
Loss = 1.0156e-01, PNorm = 34.9638, GNorm = 1.4623, lr_0 = 5.6514e-04
Loss = 9.5963e-02, PNorm = 34.9820, GNorm = 0.6392, lr_0 = 5.5129e-04
Validation rmse = 0.123685
Epoch 16
Loss = 9.6565e-02, PNorm = 34.9984, GNorm = 2.9758, lr_0 = 5.3778e-04
Validation rmse = 0.120115
Epoch 17
Loss = 1.0707e-01, PNorm = 35.0127, GNorm = 2.8864, lr_0 = 5.2460e-04
Loss = 8.5712e-02, PNorm = 35.0284, GNorm = 1.3823, lr_0 = 5.1174e-04
Validation rmse = 0.132259
Epoch 18
Loss = 8.6770e-02, PNorm = 35.0429, GNorm = 3.0718, lr_0 = 4.9920e-04
Loss = 9.7189e-02, PNorm = 35.0581, GNorm = 0.8576, lr_0 = 4.8697e-04
Validation rmse = 0.117099
Epoch 19
Loss = 9.0355e-02, PNorm = 35.0772, GNorm = 0.8826, lr_0 = 4.7503e-04
Validation rmse = 0.124032
Epoch 20
Loss = 8.3826e-02, PNorm = 35.0898, GNorm = 1.8981, lr_0 = 4.6339e-04
Loss = 8.4056e-02, PNorm = 35.1033, GNorm = 0.7720, lr_0 = 4.5204e-04
Validation rmse = 0.116855
Epoch 21
Loss = 8.0692e-02, PNorm = 35.1197, GNorm = 1.9079, lr_0 = 4.4096e-04
Loss = 9.4694e-02, PNorm = 35.1338, GNorm = 0.7044, lr_0 = 4.3015e-04
Validation rmse = 0.117190
Epoch 22
Loss = 8.0204e-02, PNorm = 35.1473, GNorm = 0.7274, lr_0 = 4.1961e-04
Loss = 8.2050e-02, PNorm = 35.1615, GNorm = 0.9897, lr_0 = 4.0933e-04
Validation rmse = 0.123468
Epoch 23
Loss = 7.4482e-02, PNorm = 35.1734, GNorm = 0.6811, lr_0 = 3.9929e-04
Validation rmse = 0.119569
Epoch 24
Loss = 7.4992e-02, PNorm = 35.1871, GNorm = 1.0353, lr_0 = 3.8951e-04
Loss = 7.5854e-02, PNorm = 35.2016, GNorm = 2.0734, lr_0 = 3.7996e-04
Validation rmse = 0.122582
Epoch 25
Loss = 7.3390e-02, PNorm = 35.2121, GNorm = 0.7149, lr_0 = 3.7065e-04
Loss = 8.0139e-02, PNorm = 35.2233, GNorm = 0.9761, lr_0 = 3.6157e-04
Loss = 5.8570e-02, PNorm = 35.2249, GNorm = 0.5370, lr_0 = 3.6067e-04
Validation rmse = 0.115341
Epoch 26
Loss = 7.5397e-02, PNorm = 35.2383, GNorm = 1.1046, lr_0 = 3.5183e-04
Validation rmse = 0.121192
Epoch 27
Loss = 8.9889e-02, PNorm = 35.2505, GNorm = 2.6603, lr_0 = 3.4321e-04
Loss = 6.8273e-02, PNorm = 35.2614, GNorm = 0.9334, lr_0 = 3.3480e-04
Validation rmse = 0.120254
Epoch 28
Loss = 7.0462e-02, PNorm = 35.2729, GNorm = 1.0494, lr_0 = 3.2659e-04
Loss = 7.1518e-02, PNorm = 35.2827, GNorm = 0.5180, lr_0 = 3.1859e-04
Validation rmse = 0.117296
Epoch 29
Loss = 6.7015e-02, PNorm = 35.2952, GNorm = 5.3420, lr_0 = 3.1078e-04
Validation rmse = 0.114693
Epoch 30
Loss = 5.3581e-02, PNorm = 35.3041, GNorm = 0.6471, lr_0 = 3.0317e-04
Loss = 7.0259e-02, PNorm = 35.3131, GNorm = 0.7284, lr_0 = 2.9574e-04
Validation rmse = 0.117095
Epoch 31
Loss = 5.8909e-02, PNorm = 35.3242, GNorm = 1.4689, lr_0 = 2.8849e-04
Loss = 7.4117e-02, PNorm = 35.3336, GNorm = 0.7222, lr_0 = 2.8142e-04
Validation rmse = 0.117259
Epoch 32
Loss = 6.1271e-02, PNorm = 35.3429, GNorm = 1.1401, lr_0 = 2.7452e-04
Validation rmse = 0.117388
Epoch 33
Loss = 4.3732e-02, PNorm = 35.3530, GNorm = 1.0544, lr_0 = 2.6779e-04
Loss = 7.1915e-02, PNorm = 35.3618, GNorm = 0.7160, lr_0 = 2.6123e-04
Validation rmse = 0.121997
Epoch 34
Loss = 7.1333e-02, PNorm = 35.3715, GNorm = 0.4347, lr_0 = 2.5483e-04
Loss = 6.4368e-02, PNorm = 35.3803, GNorm = 1.1628, lr_0 = 2.4858e-04
Validation rmse = 0.117275
Epoch 35
Loss = 7.3411e-02, PNorm = 35.3890, GNorm = 1.8361, lr_0 = 2.4249e-04
Loss = 6.5764e-02, PNorm = 35.3967, GNorm = 1.4415, lr_0 = 2.3655e-04
Validation rmse = 0.114397
Epoch 36
Loss = 6.0316e-02, PNorm = 35.4040, GNorm = 0.5587, lr_0 = 2.3075e-04
Validation rmse = 0.115584
Epoch 37
Loss = 5.1723e-02, PNorm = 35.4101, GNorm = 0.4485, lr_0 = 2.2510e-04
Loss = 7.6843e-02, PNorm = 35.4176, GNorm = 2.7287, lr_0 = 2.1958e-04
Validation rmse = 0.121544
Epoch 38
Loss = 5.9387e-02, PNorm = 35.4253, GNorm = 1.9344, lr_0 = 2.1420e-04
Loss = 6.5294e-02, PNorm = 35.4323, GNorm = 0.4368, lr_0 = 2.0895e-04
Validation rmse = 0.116441
Epoch 39
Loss = 6.2469e-02, PNorm = 35.4397, GNorm = 0.6000, lr_0 = 2.0383e-04
Validation rmse = 0.115115
Epoch 40
Loss = 7.5987e-02, PNorm = 35.4464, GNorm = 0.6713, lr_0 = 1.9883e-04
Loss = 6.2628e-02, PNorm = 35.4528, GNorm = 4.1446, lr_0 = 1.9396e-04
Validation rmse = 0.118717
Epoch 41
Loss = 6.2145e-02, PNorm = 35.4590, GNorm = 2.3541, lr_0 = 1.8921e-04
Loss = 7.1096e-02, PNorm = 35.4662, GNorm = 3.4277, lr_0 = 1.8457e-04
Validation rmse = 0.122215
Epoch 42
Loss = 6.3765e-02, PNorm = 35.4723, GNorm = 2.0409, lr_0 = 1.8005e-04
Validation rmse = 0.115769
Epoch 43
Loss = 5.6986e-02, PNorm = 35.4791, GNorm = 0.5599, lr_0 = 1.7564e-04
Loss = 6.0939e-02, PNorm = 35.4850, GNorm = 0.9798, lr_0 = 1.7133e-04
Validation rmse = 0.114478
Epoch 44
Loss = 6.0386e-02, PNorm = 35.4890, GNorm = 1.2152, lr_0 = 1.6713e-04
Loss = 6.1393e-02, PNorm = 35.4939, GNorm = 1.6932, lr_0 = 1.6304e-04
Validation rmse = 0.114578
Epoch 45
Loss = 5.5113e-02, PNorm = 35.4993, GNorm = 0.4700, lr_0 = 1.5904e-04
Loss = 6.3305e-02, PNorm = 35.5039, GNorm = 1.8376, lr_0 = 1.5514e-04
Validation rmse = 0.116168
Epoch 46
Loss = 5.6895e-02, PNorm = 35.5082, GNorm = 2.1433, lr_0 = 1.5134e-04
Validation rmse = 0.115562
Epoch 47
Loss = 5.7889e-02, PNorm = 35.5138, GNorm = 0.5263, lr_0 = 1.4763e-04
Loss = 5.3447e-02, PNorm = 35.5189, GNorm = 0.6519, lr_0 = 1.4401e-04
Validation rmse = 0.118790
Epoch 48
Loss = 5.3922e-02, PNorm = 35.5232, GNorm = 0.7593, lr_0 = 1.4048e-04
Loss = 6.4816e-02, PNorm = 35.5274, GNorm = 0.4863, lr_0 = 1.3704e-04
Validation rmse = 0.114235
Epoch 49
Loss = 5.8485e-02, PNorm = 35.5319, GNorm = 0.9650, lr_0 = 1.3368e-04
Validation rmse = 0.114032
Epoch 50
Loss = 4.8285e-02, PNorm = 35.5359, GNorm = 0.4526, lr_0 = 1.3041e-04
Loss = 5.8321e-02, PNorm = 35.5395, GNorm = 1.6855, lr_0 = 1.2721e-04
Validation rmse = 0.114059
Epoch 51
Loss = 5.6383e-02, PNorm = 35.5447, GNorm = 0.6020, lr_0 = 1.2379e-04
Loss = 5.5177e-02, PNorm = 35.5492, GNorm = 1.0328, lr_0 = 1.2075e-04
Validation rmse = 0.116342
Epoch 52
Loss = 5.8790e-02, PNorm = 35.5522, GNorm = 0.5512, lr_0 = 1.1779e-04
Validation rmse = 0.114703
Epoch 53
Loss = 5.6116e-02, PNorm = 35.5558, GNorm = 0.5998, lr_0 = 1.1491e-04
Loss = 5.6587e-02, PNorm = 35.5589, GNorm = 1.7261, lr_0 = 1.1209e-04
Validation rmse = 0.113035
Epoch 54
Loss = 5.1567e-02, PNorm = 35.5631, GNorm = 1.5458, lr_0 = 1.0934e-04
Loss = 5.7894e-02, PNorm = 35.5666, GNorm = 2.3766, lr_0 = 1.0666e-04
Validation rmse = 0.113741
Epoch 55
Loss = 5.0667e-02, PNorm = 35.5698, GNorm = 0.5785, lr_0 = 1.0405e-04
Validation rmse = 0.116148
Epoch 56
Loss = 4.3288e-02, PNorm = 35.5734, GNorm = 0.4065, lr_0 = 1.0150e-04
Loss = 5.3079e-02, PNorm = 35.5760, GNorm = 0.6731, lr_0 = 1.0000e-04
Validation rmse = 0.113501
Epoch 57
Loss = 5.7469e-02, PNorm = 35.5786, GNorm = 1.5707, lr_0 = 1.0000e-04
Loss = 5.1848e-02, PNorm = 35.5816, GNorm = 1.3839, lr_0 = 1.0000e-04
Validation rmse = 0.118222
Epoch 58
Loss = 4.8043e-02, PNorm = 35.5853, GNorm = 1.0071, lr_0 = 1.0000e-04
Loss = 5.8227e-02, PNorm = 35.5883, GNorm = 2.0198, lr_0 = 1.0000e-04
Validation rmse = 0.113708
Epoch 59
Loss = 5.4703e-02, PNorm = 35.5920, GNorm = 2.4589, lr_0 = 1.0000e-04
Validation rmse = 0.113314
Model 0 best validation rmse = 0.113035 on epoch 53
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.088609
Ensemble test rmse = 0.088609
1-fold cross validation
	Seed 0 ==> test rmse = 0.088609
Overall test rmse = 0.088609 +/- 0.000000
Elapsed time = 0:00:41
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 417 | train size = 331 | val size = 83 | test size = 3
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.225177
Epoch 1
Loss = 7.1283e-01, PNorm = 34.0323, GNorm = 3.9569, lr_0 = 1.0000e-03
Validation rmse = 0.193593
Epoch 2
Validation rmse = 0.192768
Epoch 3
Loss = 3.8887e-01, PNorm = 34.0926, GNorm = 1.9872, lr_0 = 9.2980e-04
Validation rmse = 0.187461
Epoch 4
Loss = 4.8661e-01, PNorm = 34.1406, GNorm = 5.4611, lr_0 = 8.7027e-04
Validation rmse = 0.192239
Epoch 5
Validation rmse = 0.191339
Epoch 6
Loss = 7.4824e-01, PNorm = 34.1780, GNorm = 8.4861, lr_0 = 8.0918e-04
Validation rmse = 0.185403
Epoch 7
Loss = 4.8710e-01, PNorm = 34.2092, GNorm = 2.7290, lr_0 = 7.5737e-04
Validation rmse = 0.172754
Epoch 8
Validation rmse = 0.177636
Epoch 9
Loss = 3.8301e-01, PNorm = 34.2431, GNorm = 1.8504, lr_0 = 7.0421e-04
Validation rmse = 0.177635
Epoch 10
Loss = 4.2717e-01, PNorm = 34.2737, GNorm = 2.8508, lr_0 = 6.5912e-04
Validation rmse = 0.178377
Epoch 11
Validation rmse = 0.171080
Epoch 12
Loss = 2.8151e-01, PNorm = 34.3044, GNorm = 1.5062, lr_0 = 6.1285e-04
Validation rmse = 0.173208
Epoch 13
Loss = 3.8685e-01, PNorm = 34.3307, GNorm = 4.0291, lr_0 = 5.7362e-04
Validation rmse = 0.173307
Epoch 14
Validation rmse = 0.172309
Epoch 15
Loss = 2.4268e-01, PNorm = 34.3568, GNorm = 3.8970, lr_0 = 5.3335e-04
Validation rmse = 0.183732
Epoch 16
Loss = 3.5828e-01, PNorm = 34.3832, GNorm = 5.8567, lr_0 = 4.9591e-04
Validation rmse = 0.182425
Epoch 17
Validation rmse = 0.172731
Epoch 18
Loss = 2.8907e-01, PNorm = 34.4056, GNorm = 1.2291, lr_0 = 4.6416e-04
Validation rmse = 0.173263
Epoch 19
Loss = 2.8509e-01, PNorm = 34.4283, GNorm = 1.0488, lr_0 = 4.3158e-04
Validation rmse = 0.186402
Epoch 20
Validation rmse = 0.174684
Epoch 21
Loss = 3.4675e-01, PNorm = 34.4482, GNorm = 1.8775, lr_0 = 4.0394e-04
Validation rmse = 0.173749
Epoch 22
Loss = 2.8710e-01, PNorm = 34.4706, GNorm = 1.0385, lr_0 = 3.7559e-04
Validation rmse = 0.180596
Epoch 23
Validation rmse = 0.174747
Epoch 24
Loss = 2.6825e-01, PNorm = 34.4906, GNorm = 0.7969, lr_0 = 3.4922e-04
Validation rmse = 0.174600
Epoch 25
Loss = 3.0747e-01, PNorm = 34.5086, GNorm = 1.2814, lr_0 = 3.2686e-04
Validation rmse = 0.181540
Epoch 26
Validation rmse = 0.179240
Epoch 27
Loss = 2.7165e-01, PNorm = 34.5280, GNorm = 3.1854, lr_0 = 3.0392e-04
Validation rmse = 0.191394
Epoch 28
Loss = 2.9462e-01, PNorm = 34.5441, GNorm = 2.2559, lr_0 = 2.8446e-04
Validation rmse = 0.176639
Epoch 29
Validation rmse = 0.176292
Epoch 30
Loss = 3.1709e-01, PNorm = 34.5611, GNorm = 2.7013, lr_0 = 2.6449e-04
Validation rmse = 0.188151
Epoch 31
Loss = 2.8294e-01, PNorm = 34.5751, GNorm = 1.6134, lr_0 = 2.4756e-04
Validation rmse = 0.177376
Epoch 32
Validation rmse = 0.186852
Epoch 33
Loss = 2.7780e-01, PNorm = 34.5911, GNorm = 2.7439, lr_0 = 2.3018e-04
Validation rmse = 0.180946
Epoch 34
Loss = 3.0851e-01, PNorm = 34.6044, GNorm = 5.9806, lr_0 = 2.1544e-04
Validation rmse = 0.178049
Epoch 35
Validation rmse = 0.189539
Epoch 36
Loss = 3.0238e-01, PNorm = 34.6175, GNorm = 1.1493, lr_0 = 2.0032e-04
Validation rmse = 0.177037
Epoch 37
Loss = 2.6604e-01, PNorm = 34.6299, GNorm = 3.2256, lr_0 = 1.8626e-04
Validation rmse = 0.185222
Epoch 38
Validation rmse = 0.180663
Epoch 39
Loss = 2.1949e-01, PNorm = 34.6420, GNorm = 1.6955, lr_0 = 1.7433e-04
Validation rmse = 0.184433
Epoch 40
Loss = 2.6945e-01, PNorm = 34.6531, GNorm = 1.9612, lr_0 = 1.6210e-04
Validation rmse = 0.179190
Epoch 41
Validation rmse = 0.188409
Epoch 42
Loss = 3.0139e-01, PNorm = 34.6622, GNorm = 1.3525, lr_0 = 1.5172e-04
Validation rmse = 0.179194
Epoch 43
Loss = 2.4660e-01, PNorm = 34.6719, GNorm = 3.0021, lr_0 = 1.4107e-04
Validation rmse = 0.186042
Epoch 44
Validation rmse = 0.179235
Epoch 45
Loss = 2.5663e-01, PNorm = 34.6817, GNorm = 2.2524, lr_0 = 1.3116e-04
Validation rmse = 0.183598
Epoch 46
Loss = 2.5432e-01, PNorm = 34.6900, GNorm = 3.5552, lr_0 = 1.2277e-04
Validation rmse = 0.180154
Epoch 47
Validation rmse = 0.180318
Epoch 48
Loss = 2.6741e-01, PNorm = 34.6983, GNorm = 4.8823, lr_0 = 1.1415e-04
Validation rmse = 0.183068
Epoch 49
Loss = 2.6648e-01, PNorm = 34.7048, GNorm = 0.6689, lr_0 = 1.0684e-04
Validation rmse = 0.179726
Epoch 50
Validation rmse = 0.182982
Epoch 51
Loss = 1.9143e-01, PNorm = 34.7124, GNorm = 2.4149, lr_0 = 1.0000e-04
Validation rmse = 0.181917
Epoch 52
Loss = 2.4918e-01, PNorm = 34.7192, GNorm = 0.8569, lr_0 = 1.0000e-04
Loss = 1.9436e-01, PNorm = 34.7198, GNorm = 2.3419, lr_0 = 1.0000e-04
Validation rmse = 0.181400
Epoch 53
Validation rmse = 0.183614
Epoch 54
Loss = 1.8825e-01, PNorm = 34.7264, GNorm = 3.5961, lr_0 = 1.0000e-04
Validation rmse = 0.182403
Epoch 55
Loss = 2.4862e-01, PNorm = 34.7332, GNorm = 3.8186, lr_0 = 1.0000e-04
Loss = 1.8639e-01, PNorm = 34.7338, GNorm = 3.4522, lr_0 = 1.0000e-04
Validation rmse = 0.182232
Epoch 56
Validation rmse = 0.183837
Epoch 57
Loss = 2.0787e-01, PNorm = 34.7402, GNorm = 1.6872, lr_0 = 1.0000e-04
Validation rmse = 0.182350
Epoch 58
Loss = 2.4075e-01, PNorm = 34.7477, GNorm = 3.2774, lr_0 = 1.0000e-04
Validation rmse = 0.183161
Epoch 59
Validation rmse = 0.182307
Model 0 best validation rmse = 0.171080 on epoch 11
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.367400
Ensemble test rmse = 0.367400
1-fold cross validation
	Seed 0 ==> test rmse = 0.367400
Overall test rmse = 0.367400 +/- 0.000000
Elapsed time = 0:00:14
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 407 | train size = 323 | val size = 81 | test size = 3
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.242684
Epoch 1
Loss = 6.6469e-01, PNorm = 34.0339, GNorm = 3.9031, lr_0 = 1.0000e-03
Validation rmse = 0.203567
Epoch 2
Validation rmse = 0.230344
Epoch 3
Loss = 6.9036e-01, PNorm = 34.0929, GNorm = 11.3727, lr_0 = 9.2980e-04
Validation rmse = 0.210687
Epoch 4
Loss = 5.0626e-01, PNorm = 34.1330, GNorm = 5.4708, lr_0 = 8.6453e-04
Validation rmse = 0.183910
Epoch 5
Validation rmse = 0.176431
Epoch 6
Loss = 4.3724e-01, PNorm = 34.1716, GNorm = 6.1652, lr_0 = 8.0385e-04
Validation rmse = 0.186783
Epoch 7
Loss = 4.4747e-01, PNorm = 34.2026, GNorm = 8.7279, lr_0 = 7.5238e-04
Validation rmse = 0.167396
Epoch 8
Validation rmse = 0.165153
Epoch 9
Loss = 3.6435e-01, PNorm = 34.2304, GNorm = 0.9605, lr_0 = 6.9956e-04
Validation rmse = 0.162942
Epoch 10
Loss = 3.3152e-01, PNorm = 34.2630, GNorm = 0.6989, lr_0 = 6.5046e-04
Validation rmse = 0.161463
Epoch 11
Validation rmse = 0.169204
Epoch 12
Loss = 2.9965e-01, PNorm = 34.2914, GNorm = 6.6390, lr_0 = 6.0480e-04
Validation rmse = 0.164441
Epoch 13
Loss = 3.0916e-01, PNorm = 34.3170, GNorm = 3.0530, lr_0 = 5.6234e-04
Validation rmse = 0.161983
Epoch 14
Validation rmse = 0.164416
Epoch 15
Loss = 3.1006e-01, PNorm = 34.3438, GNorm = 2.4782, lr_0 = 5.2287e-04
Validation rmse = 0.168293
Epoch 16
Validation rmse = 0.182672
Epoch 17
Loss = 4.0266e-01, PNorm = 34.3647, GNorm = 5.1075, lr_0 = 4.8616e-04
Validation rmse = 0.159411
Epoch 18
Loss = 2.7492e-01, PNorm = 34.3839, GNorm = 0.6526, lr_0 = 4.5504e-04
Validation rmse = 0.156200
Epoch 19
Validation rmse = 0.157559
Epoch 20
Loss = 2.5806e-01, PNorm = 34.4047, GNorm = 1.5326, lr_0 = 4.2309e-04
Validation rmse = 0.168094
Epoch 21
Loss = 2.5830e-01, PNorm = 34.4233, GNorm = 1.0820, lr_0 = 3.9339e-04
Validation rmse = 0.161594
Epoch 22
Validation rmse = 0.160624
Epoch 23
Loss = 2.7600e-01, PNorm = 34.4406, GNorm = 1.3149, lr_0 = 3.6578e-04
Validation rmse = 0.161029
Epoch 24
Loss = 2.8099e-01, PNorm = 34.4553, GNorm = 1.8743, lr_0 = 3.4236e-04
Validation rmse = 0.173873
Epoch 25
Validation rmse = 0.157033
Epoch 26
Loss = 2.5605e-01, PNorm = 34.4731, GNorm = 2.7981, lr_0 = 3.1623e-04
Validation rmse = 0.155925
Epoch 27
Loss = 2.6863e-01, PNorm = 34.4861, GNorm = 2.5047, lr_0 = 2.9598e-04
Loss = 2.1857e-01, PNorm = 34.4875, GNorm = 2.0311, lr_0 = 2.9403e-04
Validation rmse = 0.168599
Epoch 28
Validation rmse = 0.156969
Epoch 29
Loss = 2.7908e-01, PNorm = 34.5011, GNorm = 2.0719, lr_0 = 2.7520e-04
Validation rmse = 0.160614
Epoch 30
Loss = 2.6796e-01, PNorm = 34.5132, GNorm = 1.8696, lr_0 = 2.5589e-04
Validation rmse = 0.185052
Epoch 31
Validation rmse = 0.158237
Epoch 32
Loss = 2.5088e-01, PNorm = 34.5253, GNorm = 3.1194, lr_0 = 2.3792e-04
Validation rmse = 0.157072
Epoch 33
Validation rmse = 0.169318
Epoch 34
Loss = 2.6026e-01, PNorm = 34.5373, GNorm = 3.3679, lr_0 = 2.2122e-04
Validation rmse = 0.158355
Epoch 35
Loss = 2.9413e-01, PNorm = 34.5488, GNorm = 4.4323, lr_0 = 2.0706e-04
Validation rmse = 0.176063
Epoch 36
Validation rmse = 0.158400
Epoch 37
Loss = 2.5622e-01, PNorm = 34.5588, GNorm = 0.9856, lr_0 = 1.9252e-04
Validation rmse = 0.168399
Epoch 38
Loss = 2.5056e-01, PNorm = 34.5693, GNorm = 4.2242, lr_0 = 1.7901e-04
Validation rmse = 0.158912
Epoch 39
Validation rmse = 0.165554
Epoch 40
Loss = 2.4477e-01, PNorm = 34.5783, GNorm = 1.3121, lr_0 = 1.6644e-04
Validation rmse = 0.160428
Epoch 41
Loss = 2.2639e-01, PNorm = 34.5879, GNorm = 2.2172, lr_0 = 1.5476e-04
Validation rmse = 0.165261
Epoch 42
Validation rmse = 0.160831
Epoch 43
Loss = 2.7336e-01, PNorm = 34.5966, GNorm = 4.9169, lr_0 = 1.4390e-04
Validation rmse = 0.168617
Epoch 44
Loss = 2.3013e-01, PNorm = 34.6038, GNorm = 3.9109, lr_0 = 1.3468e-04
Loss = 2.7137e-01, PNorm = 34.6046, GNorm = 5.5321, lr_0 = 1.3379e-04
Validation rmse = 0.160277
Epoch 45
Validation rmse = 0.165512
Epoch 46
Loss = 2.2611e-01, PNorm = 34.6124, GNorm = 2.8120, lr_0 = 1.2523e-04
Validation rmse = 0.162271
Epoch 47
Loss = 2.2459e-01, PNorm = 34.6198, GNorm = 3.8759, lr_0 = 1.1644e-04
Validation rmse = 0.161244
Epoch 48
Validation rmse = 0.164740
Epoch 49
Loss = 2.2800e-01, PNorm = 34.6271, GNorm = 1.3112, lr_0 = 1.0826e-04
Validation rmse = 0.161624
Epoch 50
Validation rmse = 0.163923
Epoch 51
Loss = 2.8384e-01, PNorm = 34.6338, GNorm = 4.2173, lr_0 = 1.0066e-04
Validation rmse = 0.163309
Epoch 52
Loss = 2.1505e-01, PNorm = 34.6398, GNorm = 1.0082, lr_0 = 1.0000e-04
Validation rmse = 0.160959
Epoch 53
Validation rmse = 0.163673
Epoch 54
Loss = 2.6421e-01, PNorm = 34.6466, GNorm = 3.6927, lr_0 = 1.0000e-04
Validation rmse = 0.162698
Epoch 55
Loss = 2.0646e-01, PNorm = 34.6525, GNorm = 1.7462, lr_0 = 1.0000e-04
Validation rmse = 0.165540
Epoch 56
Validation rmse = 0.161195
Epoch 57
Loss = 2.5018e-01, PNorm = 34.6592, GNorm = 4.5071, lr_0 = 1.0000e-04
Validation rmse = 0.163038
Epoch 58
Loss = 2.1649e-01, PNorm = 34.6663, GNorm = 2.4473, lr_0 = 1.0000e-04
Validation rmse = 0.165680
Epoch 59
Validation rmse = 0.163538
Model 0 best validation rmse = 0.155925 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.078939
Ensemble test rmse = 0.078939
1-fold cross validation
	Seed 0 ==> test rmse = 0.078939
Overall test rmse = 0.078939 +/- 0.000000
Elapsed time = 0:00:16
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 397 | train size = 315 | val size = 80 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.257179
Epoch 1
Loss = 8.5573e-01, PNorm = 34.0302, GNorm = 4.1737, lr_0 = 1.0000e-03
Validation rmse = 0.220963
Epoch 2
Validation rmse = 0.202986
Epoch 3
Loss = 5.0536e-01, PNorm = 34.0959, GNorm = 1.2677, lr_0 = 9.2367e-04
Validation rmse = 0.165287
Epoch 4
Loss = 3.9389e-01, PNorm = 34.1504, GNorm = 1.1997, lr_0 = 8.6453e-04
Validation rmse = 0.151818
Epoch 5
Validation rmse = 0.181127
Epoch 6
Loss = 5.2296e-01, PNorm = 34.2010, GNorm = 10.1039, lr_0 = 7.9854e-04
Validation rmse = 0.167363
Epoch 7
Loss = 3.6936e-01, PNorm = 34.2321, GNorm = 1.3512, lr_0 = 7.4742e-04
Loss = 3.3529e-01, PNorm = 34.2355, GNorm = 3.2427, lr_0 = 7.4249e-04
Validation rmse = 0.156465
Epoch 8
Validation rmse = 0.167436
Epoch 9
Loss = 4.0614e-01, PNorm = 34.2656, GNorm = 2.7125, lr_0 = 6.9037e-04
Validation rmse = 0.152148
Epoch 10
Validation rmse = 0.169667
Epoch 11
Loss = 3.8066e-01, PNorm = 34.2950, GNorm = 5.8778, lr_0 = 6.4191e-04
Validation rmse = 0.156422
Epoch 12
Loss = 2.9567e-01, PNorm = 34.3236, GNorm = 2.7052, lr_0 = 5.9685e-04
Validation rmse = 0.148773
Epoch 13
Validation rmse = 0.142840
Epoch 14
Loss = 2.5056e-01, PNorm = 34.3489, GNorm = 1.8527, lr_0 = 5.5495e-04
Validation rmse = 0.143275
Epoch 15
Loss = 2.5844e-01, PNorm = 34.3722, GNorm = 1.5340, lr_0 = 5.1599e-04
Loss = 1.4368e-01, PNorm = 34.3746, GNorm = 2.1628, lr_0 = 5.1259e-04
Validation rmse = 0.142718
Epoch 16
Validation rmse = 0.143609
Epoch 17
Loss = 2.4062e-01, PNorm = 34.3949, GNorm = 1.0954, lr_0 = 4.7977e-04
Validation rmse = 0.144988
Epoch 18
Validation rmse = 0.143471
Epoch 19
Loss = 1.9127e-01, PNorm = 34.4170, GNorm = 0.7536, lr_0 = 4.4315e-04
Validation rmse = 0.140421
Epoch 20
Loss = 2.4534e-01, PNorm = 34.4357, GNorm = 1.2004, lr_0 = 4.1478e-04
Validation rmse = 0.138017
Epoch 21
Validation rmse = 0.142127
Epoch 22
Loss = 1.9485e-01, PNorm = 34.4556, GNorm = 1.3095, lr_0 = 3.8312e-04
Validation rmse = 0.147369
Epoch 23
Loss = 2.2997e-01, PNorm = 34.4718, GNorm = 0.7329, lr_0 = 3.5622e-04
Validation rmse = 0.139786
Epoch 24
Validation rmse = 0.142749
Epoch 25
Loss = 2.0622e-01, PNorm = 34.4892, GNorm = 1.3128, lr_0 = 3.3122e-04
Validation rmse = 0.140036
Epoch 26
Loss = 2.1511e-01, PNorm = 34.5052, GNorm = 1.9771, lr_0 = 3.0797e-04
Validation rmse = 0.140337
Epoch 27
Validation rmse = 0.139025
Epoch 28
Loss = 2.3325e-01, PNorm = 34.5198, GNorm = 1.7546, lr_0 = 2.8635e-04
Validation rmse = 0.139913
Epoch 29
Validation rmse = 0.140544
Epoch 30
Loss = 1.8379e-01, PNorm = 34.5332, GNorm = 1.6059, lr_0 = 2.6625e-04
Validation rmse = 0.143134
Epoch 31
Loss = 1.9138e-01, PNorm = 34.5465, GNorm = 2.1445, lr_0 = 2.4756e-04
Validation rmse = 0.140339
Epoch 32
Validation rmse = 0.145552
Epoch 33
Loss = 2.4132e-01, PNorm = 34.5618, GNorm = 1.2785, lr_0 = 2.2866e-04
Validation rmse = 0.138900
Epoch 34
Loss = 2.0958e-01, PNorm = 34.5735, GNorm = 1.5251, lr_0 = 2.1402e-04
Loss = 6.5877e-02, PNorm = 34.5746, GNorm = 3.8170, lr_0 = 2.1261e-04
Validation rmse = 0.147104
Epoch 35
Validation rmse = 0.141969
Epoch 36
Loss = 1.9600e-01, PNorm = 34.5857, GNorm = 4.7727, lr_0 = 1.9769e-04
Validation rmse = 0.144494
Epoch 37
Validation rmse = 0.146372
Epoch 38
Loss = 1.9422e-01, PNorm = 34.5949, GNorm = 3.9853, lr_0 = 1.8381e-04
Validation rmse = 0.146571
Epoch 39
Loss = 1.9404e-01, PNorm = 34.6045, GNorm = 1.5369, lr_0 = 1.7091e-04
Validation rmse = 0.142210
Epoch 40
Validation rmse = 0.141649
Epoch 41
Loss = 1.9728e-01, PNorm = 34.6144, GNorm = 1.2580, lr_0 = 1.5891e-04
Validation rmse = 0.139178
Epoch 42
Loss = 1.8172e-01, PNorm = 34.6235, GNorm = 1.8518, lr_0 = 1.4775e-04
Loss = 1.7784e-01, PNorm = 34.6243, GNorm = 5.0791, lr_0 = 1.4678e-04
Validation rmse = 0.141225
Epoch 43
Validation rmse = 0.140411
Epoch 44
Loss = 1.9501e-01, PNorm = 34.6319, GNorm = 1.2598, lr_0 = 1.3738e-04
Validation rmse = 0.140373
Epoch 45
Validation rmse = 0.140008
Epoch 46
Loss = 1.7775e-01, PNorm = 34.6402, GNorm = 0.7960, lr_0 = 1.2690e-04
Validation rmse = 0.139505
Epoch 47
Loss = 1.6529e-01, PNorm = 34.6473, GNorm = 4.6488, lr_0 = 1.1877e-04
Validation rmse = 0.139674
Epoch 48
Validation rmse = 0.140098
Epoch 49
Loss = 1.3457e-01, PNorm = 34.6540, GNorm = 2.5666, lr_0 = 1.0971e-04
Validation rmse = 0.138394
Epoch 50
Loss = 1.6965e-01, PNorm = 34.6596, GNorm = 0.5429, lr_0 = 1.0268e-04
Validation rmse = 0.139685
Epoch 51
Validation rmse = 0.140167
Epoch 52
Loss = 1.6332e-01, PNorm = 34.6663, GNorm = 2.0509, lr_0 = 1.0000e-04
Validation rmse = 0.139834
Epoch 53
Loss = 1.6168e-01, PNorm = 34.6722, GNorm = 1.5825, lr_0 = 1.0000e-04
Validation rmse = 0.139782
Epoch 54
Validation rmse = 0.139185
Epoch 55
Loss = 1.6337e-01, PNorm = 34.6775, GNorm = 2.2261, lr_0 = 1.0000e-04
Validation rmse = 0.138172
Epoch 56
Validation rmse = 0.138564
Epoch 57
Loss = 1.6352e-01, PNorm = 34.6828, GNorm = 0.9925, lr_0 = 1.0000e-04
Validation rmse = 0.139400
Epoch 58
Loss = 1.7582e-01, PNorm = 34.6882, GNorm = 2.7570, lr_0 = 1.0000e-04
Validation rmse = 0.139446
Epoch 59
Validation rmse = 0.138914
Model 0 best validation rmse = 0.138017 on epoch 20
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.045089
Ensemble test rmse = 0.045089
1-fold cross validation
	Seed 0 ==> test rmse = 0.045089
Overall test rmse = 0.045089 +/- 0.000000
Elapsed time = 0:00:14
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 387 | train size = 307 | val size = 78 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.241637
Epoch 1
Loss = 6.7466e-01, PNorm = 34.0292, GNorm = 2.2919, lr_0 = 1.0000e-03
Validation rmse = 0.282923
Epoch 2
Validation rmse = 0.234581
Epoch 3
Loss = 6.3121e-01, PNorm = 34.0827, GNorm = 9.1626, lr_0 = 9.2367e-04
Validation rmse = 0.224717
Epoch 4
Loss = 4.5733e-01, PNorm = 34.1330, GNorm = 4.1682, lr_0 = 8.5883e-04
Loss = 3.6657e-01, PNorm = 34.1376, GNorm = 7.3945, lr_0 = 8.5317e-04
Validation rmse = 0.185611
Epoch 5
Validation rmse = 0.221031
Epoch 6
Loss = 4.9936e-01, PNorm = 34.1834, GNorm = 3.8636, lr_0 = 7.9328e-04
Validation rmse = 0.171485
Epoch 7
Validation rmse = 0.177322
Epoch 8
Loss = 3.0617e-01, PNorm = 34.2189, GNorm = 3.6779, lr_0 = 7.3759e-04
Validation rmse = 0.174870
Epoch 9
Loss = 2.9889e-01, PNorm = 34.2521, GNorm = 4.9193, lr_0 = 6.8581e-04
Validation rmse = 0.160057
Epoch 10
Validation rmse = 0.179598
Epoch 11
Loss = 3.3889e-01, PNorm = 34.2850, GNorm = 3.2062, lr_0 = 6.3347e-04
Validation rmse = 0.151728
Epoch 12
Validation rmse = 0.166792
Epoch 13
Loss = 1.2472e-01, PNorm = 34.3155, GNorm = 1.6278, lr_0 = 5.8512e-04
Validation rmse = 0.153986
Epoch 14
Loss = 2.5635e-01, PNorm = 34.3410, GNorm = 5.1079, lr_0 = 5.4404e-04
Validation rmse = 0.149382
Epoch 15
Validation rmse = 0.151655
Epoch 16
Loss = 2.0768e-01, PNorm = 34.3637, GNorm = 0.5925, lr_0 = 5.0585e-04
Validation rmse = 0.153473
Epoch 17
Loss = 2.4562e-01, PNorm = 34.3818, GNorm = 1.1421, lr_0 = 4.7034e-04
Loss = 2.0316e-01, PNorm = 34.3833, GNorm = 3.4558, lr_0 = 4.6724e-04
Validation rmse = 0.151063
Epoch 18
Validation rmse = 0.148622
Epoch 19
Loss = 2.1655e-01, PNorm = 34.4037, GNorm = 2.4934, lr_0 = 4.3444e-04
Validation rmse = 0.144906
Epoch 20
Validation rmse = 0.146999
Epoch 21
Loss = 2.0279e-01, PNorm = 34.4236, GNorm = 1.9656, lr_0 = 4.0128e-04
Validation rmse = 0.142923
Epoch 22
Loss = 1.9916e-01, PNorm = 34.4403, GNorm = 0.7261, lr_0 = 3.7559e-04
Validation rmse = 0.143347
Epoch 23
Validation rmse = 0.145299
Epoch 24
Loss = 2.2604e-01, PNorm = 34.4593, GNorm = 2.2420, lr_0 = 3.4692e-04
Validation rmse = 0.159958
Epoch 25
Validation rmse = 0.144350
Epoch 26
Loss = 2.4659e-01, PNorm = 34.4755, GNorm = 1.4998, lr_0 = 3.2044e-04
Validation rmse = 0.145635
Epoch 27
Loss = 1.8282e-01, PNorm = 34.4892, GNorm = 4.0272, lr_0 = 2.9795e-04
Validation rmse = 0.147030
Epoch 28
Validation rmse = 0.140086
Epoch 29
Loss = 2.0972e-01, PNorm = 34.5010, GNorm = 4.1393, lr_0 = 2.7703e-04
Validation rmse = 0.147907
Epoch 30
Loss = 1.9125e-01, PNorm = 34.5129, GNorm = 1.1211, lr_0 = 2.5758e-04
Loss = 1.2064e-01, PNorm = 34.5141, GNorm = 1.3307, lr_0 = 2.5589e-04
Validation rmse = 0.138204
Epoch 31
Validation rmse = 0.139870
Epoch 32
Loss = 1.8260e-01, PNorm = 34.5260, GNorm = 0.4415, lr_0 = 2.3792e-04
Validation rmse = 0.139339
Epoch 33
Validation rmse = 0.138161
Epoch 34
Loss = 1.6840e-01, PNorm = 34.5396, GNorm = 2.4975, lr_0 = 2.1976e-04
Validation rmse = 0.142411
Epoch 35
Loss = 1.7713e-01, PNorm = 34.5492, GNorm = 1.2828, lr_0 = 2.0434e-04
Validation rmse = 0.136941
Epoch 36
Validation rmse = 0.139964
Epoch 37
Loss = 1.7252e-01, PNorm = 34.5576, GNorm = 0.7103, lr_0 = 1.8999e-04
Validation rmse = 0.136959
Epoch 38
Validation rmse = 0.135823
Epoch 39
Loss = 1.5450e-01, PNorm = 34.5677, GNorm = 2.1347, lr_0 = 1.7549e-04
Validation rmse = 0.136982
Epoch 40
Loss = 1.6908e-01, PNorm = 34.5747, GNorm = 1.5608, lr_0 = 1.6317e-04
Validation rmse = 0.135318
Epoch 41
Validation rmse = 0.138999
Epoch 42
Loss = 1.4924e-01, PNorm = 34.5830, GNorm = 1.6051, lr_0 = 1.5072e-04
Validation rmse = 0.135450
Epoch 43
Loss = 1.5695e-01, PNorm = 34.5889, GNorm = 1.0419, lr_0 = 1.4107e-04
Loss = 1.8423e-01, PNorm = 34.5893, GNorm = 3.0089, lr_0 = 1.4014e-04
Validation rmse = 0.140799
Epoch 44
Validation rmse = 0.140379
Epoch 45
Loss = 1.6673e-01, PNorm = 34.5949, GNorm = 1.0200, lr_0 = 1.3030e-04
Validation rmse = 0.137871
Epoch 46
Validation rmse = 0.136207
Epoch 47
Loss = 1.4812e-01, PNorm = 34.6011, GNorm = 2.2287, lr_0 = 1.2035e-04
Validation rmse = 0.140780
Epoch 48
Loss = 1.7995e-01, PNorm = 34.6059, GNorm = 1.3538, lr_0 = 1.1191e-04
Loss = 1.7358e-01, PNorm = 34.6063, GNorm = 7.1944, lr_0 = 1.1117e-04
Validation rmse = 0.141062
Epoch 49
Validation rmse = 0.136511
Epoch 50
Loss = 1.4117e-01, PNorm = 34.6109, GNorm = 0.7811, lr_0 = 1.0405e-04
Validation rmse = 0.135926
Epoch 51
Validation rmse = 0.137103
Epoch 52
Loss = 1.8941e-01, PNorm = 34.6160, GNorm = 1.0808, lr_0 = 1.0000e-04
Validation rmse = 0.137575
Epoch 53
Loss = 1.5696e-01, PNorm = 34.6206, GNorm = 2.2355, lr_0 = 1.0000e-04
Validation rmse = 0.137442
Epoch 54
Validation rmse = 0.135754
Epoch 55
Loss = 1.5052e-01, PNorm = 34.6258, GNorm = 2.0572, lr_0 = 1.0000e-04
Validation rmse = 0.136859
Epoch 56
Validation rmse = 0.137108
Epoch 57
Loss = 1.7011e-01, PNorm = 34.6313, GNorm = 1.9082, lr_0 = 1.0000e-04
Validation rmse = 0.137980
Epoch 58
Loss = 1.6484e-01, PNorm = 34.6355, GNorm = 1.6987, lr_0 = 1.0000e-04
Validation rmse = 0.135891
Epoch 59
Validation rmse = 0.139736
Model 0 best validation rmse = 0.135318 on epoch 40
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.094304
Ensemble test rmse = 0.094304
1-fold cross validation
	Seed 0 ==> test rmse = 0.094304
Overall test rmse = 0.094304 +/- 0.000000
Elapsed time = 0:00:16
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 377 | train size = 299 | val size = 76 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.209023
Epoch 1
Loss = 6.3632e-01, PNorm = 34.0408, GNorm = 1.2844, lr_0 = 9.8425e-04
Validation rmse = 0.172009
Epoch 2
Validation rmse = 0.147912
Epoch 3
Loss = 3.9015e-01, PNorm = 34.1103, GNorm = 1.1143, lr_0 = 9.0912e-04
Validation rmse = 0.144141
Epoch 4
Validation rmse = 0.167037
Epoch 5
Loss = 4.4972e-01, PNorm = 34.1500, GNorm = 10.6774, lr_0 = 8.3973e-04
Validation rmse = 0.139737
Epoch 6
Loss = 3.1687e-01, PNorm = 34.1832, GNorm = 7.8178, lr_0 = 7.7563e-04
Validation rmse = 0.143085
Epoch 7
Validation rmse = 0.165254
Epoch 8
Loss = 2.7250e-01, PNorm = 34.2109, GNorm = 2.2275, lr_0 = 7.1643e-04
Validation rmse = 0.144931
Epoch 9
Validation rmse = 0.145443
Epoch 10
Loss = 3.4077e-01, PNorm = 34.2374, GNorm = 7.0627, lr_0 = 6.6174e-04
Validation rmse = 0.133219
Epoch 11
Loss = 2.2527e-01, PNorm = 34.2588, GNorm = 5.1536, lr_0 = 6.1123e-04
Validation rmse = 0.134326
Epoch 12
Validation rmse = 0.134938
Epoch 13
Loss = 1.9591e-01, PNorm = 34.2812, GNorm = 4.8851, lr_0 = 5.6458e-04
Validation rmse = 0.141164
Epoch 14
Validation rmse = 0.147959
Epoch 15
Loss = 2.0533e-01, PNorm = 34.3000, GNorm = 3.7276, lr_0 = 5.2148e-04
Validation rmse = 0.136424
Epoch 16
Loss = 1.7445e-01, PNorm = 34.3160, GNorm = 3.1505, lr_0 = 4.8168e-04
Validation rmse = 0.131738
Epoch 17
Validation rmse = 0.131554
Epoch 18
Loss = 1.4744e-01, PNorm = 34.3321, GNorm = 2.3719, lr_0 = 4.4491e-04
Validation rmse = 0.137978
Epoch 19
Validation rmse = 0.143486
Epoch 20
Loss = 1.4238e-01, PNorm = 34.3457, GNorm = 2.4606, lr_0 = 4.1095e-04
Validation rmse = 0.132220
Epoch 21
Loss = 1.5301e-01, PNorm = 34.3599, GNorm = 1.8918, lr_0 = 3.7959e-04
Validation rmse = 0.132628
Epoch 22
Validation rmse = 0.133551
Epoch 23
Loss = 1.2866e-01, PNorm = 34.3718, GNorm = 2.1943, lr_0 = 3.5061e-04
Validation rmse = 0.135832
Epoch 24
Validation rmse = 0.133758
Epoch 25
Loss = 1.0631e-01, PNorm = 34.3841, GNorm = 1.0921, lr_0 = 3.2385e-04
Validation rmse = 0.143764
Epoch 26
Loss = 1.4838e-01, PNorm = 34.3948, GNorm = 8.0048, lr_0 = 2.9913e-04
Validation rmse = 0.142411
Epoch 27
Validation rmse = 0.143008
Epoch 28
Loss = 1.5041e-01, PNorm = 34.4048, GNorm = 2.0127, lr_0 = 2.7630e-04
Validation rmse = 0.142513
Epoch 29
Validation rmse = 0.135335
Epoch 30
Loss = 9.9448e-02, PNorm = 34.4146, GNorm = 1.6764, lr_0 = 2.5521e-04
Validation rmse = 0.132585
Epoch 31
Loss = 1.3097e-01, PNorm = 34.4236, GNorm = 3.7098, lr_0 = 2.3573e-04
Validation rmse = 0.134266
Epoch 32
Validation rmse = 0.134121
Epoch 33
Loss = 1.3849e-01, PNorm = 34.4319, GNorm = 5.1997, lr_0 = 2.1774e-04
Validation rmse = 0.142002
Epoch 34
Validation rmse = 0.133289
Epoch 35
Loss = 8.8916e-02, PNorm = 34.4389, GNorm = 3.3298, lr_0 = 2.0112e-04
Validation rmse = 0.137365
Epoch 36
Loss = 1.2870e-01, PNorm = 34.4457, GNorm = 1.7328, lr_0 = 1.8577e-04
Validation rmse = 0.134129
Epoch 37
Validation rmse = 0.135401
Epoch 38
Loss = 1.2817e-01, PNorm = 34.4519, GNorm = 6.0456, lr_0 = 1.7159e-04
Validation rmse = 0.136045
Epoch 39
Validation rmse = 0.136440
Epoch 40
Loss = 1.2489e-01, PNorm = 34.4584, GNorm = 0.6478, lr_0 = 1.5849e-04
Validation rmse = 0.134961
Epoch 41
Loss = 1.1588e-01, PNorm = 34.4640, GNorm = 5.4191, lr_0 = 1.4639e-04
Validation rmse = 0.138349
Epoch 42
Validation rmse = 0.133964
Epoch 43
Loss = 1.3523e-01, PNorm = 34.4698, GNorm = 3.7819, lr_0 = 1.3522e-04
Validation rmse = 0.141667
Epoch 44
Validation rmse = 0.134426
Epoch 45
Loss = 1.2183e-01, PNorm = 34.4745, GNorm = 0.7695, lr_0 = 1.2490e-04
Validation rmse = 0.139076
Epoch 46
Loss = 1.2590e-01, PNorm = 34.4790, GNorm = 5.7749, lr_0 = 1.1536e-04
Validation rmse = 0.134903
Epoch 47
Validation rmse = 0.137428
Epoch 48
Loss = 1.1118e-01, PNorm = 34.4835, GNorm = 2.1091, lr_0 = 1.0656e-04
Validation rmse = 0.134358
Epoch 49
Validation rmse = 0.136381
Epoch 50
Loss = 6.7560e-02, PNorm = 34.4874, GNorm = 0.7317, lr_0 = 1.0000e-04
Validation rmse = 0.136936
Epoch 51
Loss = 1.1889e-01, PNorm = 34.4918, GNorm = 0.7209, lr_0 = 1.0000e-04
Validation rmse = 0.136495
Epoch 52
Validation rmse = 0.136289
Epoch 53
Loss = 1.1838e-01, PNorm = 34.4956, GNorm = 0.9983, lr_0 = 1.0000e-04
Validation rmse = 0.134923
Epoch 54
Validation rmse = 0.137566
Epoch 55
Loss = 1.1125e-01, PNorm = 34.4998, GNorm = 1.1747, lr_0 = 1.0000e-04
Validation rmse = 0.136696
Epoch 56
Loss = 1.1245e-01, PNorm = 34.5038, GNorm = 0.6076, lr_0 = 1.0000e-04
Validation rmse = 0.136786
Epoch 57
Validation rmse = 0.135493
Epoch 58
Loss = 1.1414e-01, PNorm = 34.5079, GNorm = 1.5942, lr_0 = 1.0000e-04
Validation rmse = 0.137743
Epoch 59
Validation rmse = 0.135865
Model 0 best validation rmse = 0.131554 on epoch 17
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.085288
Ensemble test rmse = 0.085288
1-fold cross validation
	Seed 0 ==> test rmse = 0.085288
Overall test rmse = 0.085288 +/- 0.000000
Elapsed time = 0:00:14
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 367 | train size = 291 | val size = 74 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.236914
Epoch 1
Loss = 7.1686e-01, PNorm = 34.0386, GNorm = 6.3609, lr_0 = 9.8425e-04
Validation rmse = 0.192795
Epoch 2
Validation rmse = 0.174873
Epoch 3
Loss = 3.3162e-01, PNorm = 34.1012, GNorm = 1.2472, lr_0 = 9.0912e-04
Validation rmse = 0.194568
Epoch 4
Validation rmse = 0.156369
Epoch 5
Loss = 3.1546e-01, PNorm = 34.1563, GNorm = 4.5791, lr_0 = 8.3973e-04
Validation rmse = 0.147847
Epoch 6
Loss = 2.7288e-01, PNorm = 34.2013, GNorm = 1.6431, lr_0 = 7.6950e-04
Validation rmse = 0.143810
Epoch 7
Validation rmse = 0.135224
Epoch 8
Loss = 2.1094e-01, PNorm = 34.2366, GNorm = 0.9845, lr_0 = 7.1076e-04
Validation rmse = 0.131936
Epoch 9
Validation rmse = 0.142596
Epoch 10
Loss = 2.0071e-01, PNorm = 34.2622, GNorm = 4.0078, lr_0 = 6.5651e-04
Validation rmse = 0.167614
Epoch 11
Validation rmse = 0.141697
Epoch 12
Loss = 2.3152e-01, PNorm = 34.2856, GNorm = 5.0476, lr_0 = 6.0160e-04
Validation rmse = 0.129478
Epoch 13
Loss = 1.7563e-01, PNorm = 34.3088, GNorm = 2.2814, lr_0 = 5.5568e-04
Validation rmse = 0.125429
Epoch 14
Validation rmse = 0.125591
Epoch 15
Loss = 1.3962e-01, PNorm = 34.3288, GNorm = 1.0661, lr_0 = 5.1327e-04
Validation rmse = 0.123723
Epoch 16
Validation rmse = 0.124933
Epoch 17
Loss = 1.5273e-01, PNorm = 34.3474, GNorm = 2.6501, lr_0 = 4.7034e-04
Validation rmse = 0.121848
Epoch 18
Loss = 1.4553e-01, PNorm = 34.3619, GNorm = 1.9131, lr_0 = 4.3444e-04
Validation rmse = 0.121898
Epoch 19
Validation rmse = 0.125169
Epoch 20
Loss = 1.2511e-01, PNorm = 34.3766, GNorm = 2.8917, lr_0 = 4.0128e-04
Validation rmse = 0.130452
Epoch 21
Validation rmse = 0.127327
Epoch 22
Loss = 1.5463e-01, PNorm = 34.3899, GNorm = 2.9718, lr_0 = 3.7065e-04
Validation rmse = 0.120817
Epoch 23
Validation rmse = 0.121787
Epoch 24
Loss = 1.4290e-01, PNorm = 34.4027, GNorm = 1.0731, lr_0 = 3.3965e-04
Validation rmse = 0.130338
Epoch 25
Loss = 1.3077e-01, PNorm = 34.4138, GNorm = 4.1117, lr_0 = 3.1373e-04
Validation rmse = 0.133898
Epoch 26
Validation rmse = 0.122256
Epoch 27
Loss = 1.1376e-01, PNorm = 34.4243, GNorm = 0.9371, lr_0 = 2.8978e-04
Validation rmse = 0.120267
Epoch 28
Validation rmse = 0.124567
Epoch 29
Loss = 1.0199e-01, PNorm = 34.4351, GNorm = 3.5407, lr_0 = 2.6554e-04
Validation rmse = 0.123861
Epoch 30
Loss = 1.2292e-01, PNorm = 34.4448, GNorm = 1.6723, lr_0 = 2.4528e-04
Validation rmse = 0.120811
Epoch 31
Validation rmse = 0.124464
Epoch 32
Loss = 1.2692e-01, PNorm = 34.4528, GNorm = 3.7084, lr_0 = 2.2655e-04
Validation rmse = 0.122195
Epoch 33
Validation rmse = 0.122423
Epoch 34
Loss = 1.2080e-01, PNorm = 34.4629, GNorm = 0.7826, lr_0 = 2.0761e-04
Validation rmse = 0.119114
Epoch 35
Validation rmse = 0.123897
Epoch 36
Loss = 8.6737e-02, PNorm = 34.4710, GNorm = 2.8855, lr_0 = 1.9176e-04
Validation rmse = 0.118943
Epoch 37
Loss = 1.0861e-01, PNorm = 34.4785, GNorm = 1.7480, lr_0 = 1.7712e-04
Validation rmse = 0.125659
Epoch 38
Validation rmse = 0.120871
Epoch 39
Loss = 1.2409e-01, PNorm = 34.4864, GNorm = 4.7949, lr_0 = 1.6231e-04
Validation rmse = 0.118895
Epoch 40
Validation rmse = 0.130608
Epoch 41
Loss = 1.0993e-01, PNorm = 34.4925, GNorm = 4.4347, lr_0 = 1.4992e-04
Validation rmse = 0.118595
Epoch 42
Loss = 1.0867e-01, PNorm = 34.4985, GNorm = 3.6281, lr_0 = 1.3848e-04
Validation rmse = 0.125302
Epoch 43
Validation rmse = 0.118158
Epoch 44
Loss = 1.0443e-01, PNorm = 34.5044, GNorm = 1.2836, lr_0 = 1.2791e-04
Validation rmse = 0.121388
Epoch 45
Validation rmse = 0.120086
Epoch 46
Loss = 8.7756e-02, PNorm = 34.5099, GNorm = 1.8008, lr_0 = 1.1721e-04
Validation rmse = 0.122652
Epoch 47
Validation rmse = 0.120742
Epoch 48
Loss = 1.3319e-01, PNorm = 34.5151, GNorm = 2.0911, lr_0 = 1.0826e-04
Validation rmse = 0.119905
Epoch 49
Loss = 9.9496e-02, PNorm = 34.5194, GNorm = 0.6624, lr_0 = 1.0000e-04
Validation rmse = 0.120817
Epoch 50
Validation rmse = 0.119017
Epoch 51
Loss = 1.0234e-01, PNorm = 34.5241, GNorm = 0.8082, lr_0 = 1.0000e-04
Validation rmse = 0.122759
Epoch 52
Validation rmse = 0.118141
Epoch 53
Loss = 9.5550e-02, PNorm = 34.5287, GNorm = 1.5440, lr_0 = 1.0000e-04
Validation rmse = 0.122830
Epoch 54
Loss = 1.0495e-01, PNorm = 34.5330, GNorm = 1.2894, lr_0 = 1.0000e-04
Validation rmse = 0.118701
Epoch 55
Validation rmse = 0.121482
Epoch 56
Loss = 9.9617e-02, PNorm = 34.5377, GNorm = 0.9798, lr_0 = 1.0000e-04
Validation rmse = 0.119614
Epoch 57
Validation rmse = 0.119076
Epoch 58
Loss = 1.0912e-01, PNorm = 34.5420, GNorm = 3.9674, lr_0 = 1.0000e-04
Validation rmse = 0.122629
Epoch 59
Validation rmse = 0.119162
Model 0 best validation rmse = 0.118141 on epoch 52
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.053061
Ensemble test rmse = 0.053061
1-fold cross validation
	Seed 0 ==> test rmse = 0.053061
Overall test rmse = 0.053061 +/- 0.000000
Elapsed time = 0:00:16
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 357 | train size = 283 | val size = 72 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.190197
Epoch 1
Loss = 6.6027e-01, PNorm = 34.0415, GNorm = 5.4572, lr_0 = 9.8425e-04
Validation rmse = 0.162899
Epoch 2
Validation rmse = 0.148958
Epoch 3
Loss = 3.6067e-01, PNorm = 34.1007, GNorm = 2.5176, lr_0 = 9.0193e-04
Validation rmse = 0.153480
Epoch 4
Validation rmse = 0.138422
Epoch 5
Loss = 2.5397e-01, PNorm = 34.1570, GNorm = 2.3846, lr_0 = 8.3309e-04
Validation rmse = 0.142123
Epoch 6
Validation rmse = 0.123873
Epoch 7
Loss = 3.0750e-01, PNorm = 34.2014, GNorm = 10.6197, lr_0 = 7.6341e-04
Validation rmse = 0.117808
Epoch 8
Loss = 2.1680e-01, PNorm = 34.2301, GNorm = 10.7450, lr_0 = 7.0514e-04
Loss = 1.3118e-01, PNorm = 34.2324, GNorm = 2.0798, lr_0 = 6.9956e-04
Validation rmse = 0.115382
Epoch 9
Validation rmse = 0.118866
Epoch 10
Loss = 1.7690e-01, PNorm = 34.2595, GNorm = 0.9953, lr_0 = 6.4617e-04
Validation rmse = 0.120146
Epoch 11
Validation rmse = 0.129176
Epoch 12
Loss = 1.5898e-01, PNorm = 34.2852, GNorm = 4.8827, lr_0 = 5.9213e-04
Validation rmse = 0.134452
Epoch 13
Validation rmse = 0.159197
Epoch 14
Loss = 1.3261e-01, PNorm = 34.3051, GNorm = 5.3666, lr_0 = 5.4693e-04
Validation rmse = 0.131396
Epoch 15
Loss = 2.1348e-01, PNorm = 34.3212, GNorm = 10.4569, lr_0 = 5.0119e-04
Validation rmse = 0.109817
Epoch 16
Validation rmse = 0.099506
Epoch 17
Loss = 2.1584e-01, PNorm = 34.3393, GNorm = 5.9572, lr_0 = 4.6293e-04
Validation rmse = 0.154548
Epoch 18
Validation rmse = 0.103824
Epoch 19
Loss = 1.3399e-01, PNorm = 34.3580, GNorm = 3.0464, lr_0 = 4.2422e-04
Validation rmse = 0.130031
Epoch 20
Validation rmse = 0.099062
Epoch 21
Loss = 1.1852e-01, PNorm = 34.3724, GNorm = 0.9723, lr_0 = 3.8874e-04
Validation rmse = 0.102209
Epoch 22
Loss = 1.3302e-01, PNorm = 34.3839, GNorm = 2.3105, lr_0 = 3.5906e-04
Validation rmse = 0.113979
Epoch 23
Validation rmse = 0.097414
Epoch 24
Loss = 1.0921e-01, PNorm = 34.3966, GNorm = 2.1747, lr_0 = 3.2903e-04
Validation rmse = 0.104293
Epoch 25
Validation rmse = 0.101990
Epoch 26
Loss = 1.1980e-01, PNorm = 34.4063, GNorm = 0.8336, lr_0 = 3.0392e-04
Validation rmse = 0.099202
Epoch 27
Validation rmse = 0.105695
Epoch 28
Loss = 1.0090e-01, PNorm = 34.4165, GNorm = 2.1627, lr_0 = 2.7850e-04
Validation rmse = 0.099680
Epoch 29
Validation rmse = 0.104632
Epoch 30
Loss = 1.0419e-01, PNorm = 34.4257, GNorm = 0.6378, lr_0 = 2.5521e-04
Validation rmse = 0.098657
Epoch 31
Loss = 1.0186e-01, PNorm = 34.4339, GNorm = 1.6937, lr_0 = 2.3573e-04
Validation rmse = 0.106834
Epoch 32
Validation rmse = 0.097610
Epoch 33
Loss = 9.9583e-02, PNorm = 34.4423, GNorm = 0.8211, lr_0 = 2.1601e-04
Validation rmse = 0.101424
Epoch 34
Validation rmse = 0.101628
Epoch 35
Loss = 8.1385e-02, PNorm = 34.4498, GNorm = 1.6439, lr_0 = 1.9953e-04
Validation rmse = 0.099801
Epoch 36
Validation rmse = 0.100851
Epoch 37
Loss = 8.2588e-02, PNorm = 34.4576, GNorm = 0.6589, lr_0 = 1.8284e-04
Validation rmse = 0.100886
Epoch 38
Loss = 9.5560e-02, PNorm = 34.4645, GNorm = 0.7894, lr_0 = 1.6888e-04
Loss = 1.0460e-01, PNorm = 34.4651, GNorm = 3.0156, lr_0 = 1.6755e-04
Validation rmse = 0.098210
Epoch 39
Validation rmse = 0.104084
Epoch 40
Loss = 8.6863e-02, PNorm = 34.4715, GNorm = 3.1056, lr_0 = 1.5476e-04
Validation rmse = 0.096377
Epoch 41
Validation rmse = 0.102004
Epoch 42
Loss = 9.6278e-02, PNorm = 34.4783, GNorm = 0.5794, lr_0 = 1.4182e-04
Validation rmse = 0.098844
Epoch 43
Validation rmse = 0.099991
Epoch 44
Loss = 4.7392e-02, PNorm = 34.4842, GNorm = 0.9159, lr_0 = 1.3099e-04
Validation rmse = 0.098279
Epoch 45
Loss = 9.3047e-02, PNorm = 34.4902, GNorm = 0.7071, lr_0 = 1.2004e-04
Validation rmse = 0.102179
Epoch 46
Validation rmse = 0.098400
Epoch 47
Loss = 8.7868e-02, PNorm = 34.4951, GNorm = 2.1449, lr_0 = 1.1087e-04
Validation rmse = 0.102009
Epoch 48
Validation rmse = 0.098216
Epoch 49
Loss = 9.1631e-02, PNorm = 34.4999, GNorm = 3.7164, lr_0 = 1.0160e-04
Validation rmse = 0.100581
Epoch 50
Validation rmse = 0.100766
Epoch 51
Loss = 7.4020e-02, PNorm = 34.5047, GNorm = 1.4203, lr_0 = 1.0000e-04
Validation rmse = 0.097803
Epoch 52
Validation rmse = 0.104999
Epoch 53
Loss = 7.7724e-02, PNorm = 34.5098, GNorm = 0.5646, lr_0 = 1.0000e-04
Validation rmse = 0.095833
Epoch 54
Loss = 8.5526e-02, PNorm = 34.5141, GNorm = 2.2953, lr_0 = 1.0000e-04
Validation rmse = 0.101044
Epoch 55
Validation rmse = 0.099213
Epoch 56
Loss = 7.7692e-02, PNorm = 34.5191, GNorm = 0.7284, lr_0 = 1.0000e-04
Validation rmse = 0.099445
Epoch 57
Validation rmse = 0.099966
Epoch 58
Loss = 8.1703e-02, PNorm = 34.5236, GNorm = 0.4538, lr_0 = 1.0000e-04
Validation rmse = 0.100851
Epoch 59
Validation rmse = 0.097526
Model 0 best validation rmse = 0.095833 on epoch 53
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.042263
Ensemble test rmse = 0.042263
1-fold cross validation
	Seed 0 ==> test rmse = 0.042263
Overall test rmse = 0.042263 +/- 0.000000
Elapsed time = 0:00:13
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 347 | train size = 275 | val size = 70 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.251294
Epoch 1
Loss = 6.0946e-01, PNorm = 34.0446, GNorm = 8.0848, lr_0 = 9.8425e-04
Validation rmse = 0.207999
Epoch 2
Validation rmse = 0.176801
Epoch 3
Loss = 3.4270e-01, PNorm = 34.1121, GNorm = 5.2990, lr_0 = 9.0193e-04
Validation rmse = 0.153293
Epoch 4
Validation rmse = 0.154265
Epoch 5
Loss = 3.0998e-01, PNorm = 34.1612, GNorm = 7.0815, lr_0 = 8.2650e-04
Validation rmse = 0.141707
Epoch 6
Validation rmse = 0.154950
Epoch 7
Loss = 2.5328e-01, PNorm = 34.2007, GNorm = 2.9117, lr_0 = 7.5737e-04
Validation rmse = 0.132548
Epoch 8
Validation rmse = 0.124184
Epoch 9
Loss = 1.9374e-01, PNorm = 34.2362, GNorm = 3.1383, lr_0 = 6.9403e-04
Validation rmse = 0.116983
Epoch 10
Loss = 1.5220e-01, PNorm = 34.2616, GNorm = 1.9518, lr_0 = 6.4106e-04
Loss = 1.3515e-01, PNorm = 34.2638, GNorm = 0.7637, lr_0 = 6.3599e-04
Validation rmse = 0.115469
Epoch 11
Validation rmse = 0.110832
Epoch 12
Loss = 1.3193e-01, PNorm = 34.2852, GNorm = 0.5853, lr_0 = 5.8744e-04
Validation rmse = 0.112749
Epoch 13
Validation rmse = 0.133446
Epoch 14
Loss = 1.3893e-01, PNorm = 34.3065, GNorm = 0.8397, lr_0 = 5.3831e-04
Validation rmse = 0.116889
Epoch 15
Validation rmse = 0.113720
Epoch 16
Loss = 1.1173e-01, PNorm = 34.3236, GNorm = 2.2793, lr_0 = 4.9329e-04
Validation rmse = 0.113842
Epoch 17
Validation rmse = 0.115531
Epoch 18
Loss = 1.4585e-01, PNorm = 34.3414, GNorm = 4.1672, lr_0 = 4.5204e-04
Validation rmse = 0.114557
Epoch 19
Loss = 1.3960e-01, PNorm = 34.3553, GNorm = 6.7434, lr_0 = 4.1423e-04
Validation rmse = 0.124660
Epoch 20
Validation rmse = 0.110175
Epoch 21
Loss = 1.1567e-01, PNorm = 34.3686, GNorm = 0.9142, lr_0 = 3.7959e-04
Validation rmse = 0.109305
Epoch 22
Validation rmse = 0.105160
Epoch 23
Loss = 1.1324e-01, PNorm = 34.3803, GNorm = 4.0909, lr_0 = 3.4784e-04
Validation rmse = 0.106936
Epoch 24
Validation rmse = 0.109572
Epoch 25
Loss = 1.0261e-01, PNorm = 34.3915, GNorm = 2.0887, lr_0 = 3.1875e-04
Validation rmse = 0.104653
Epoch 26
Validation rmse = 0.106310
Epoch 27
Loss = 9.7783e-02, PNorm = 34.4020, GNorm = 4.3896, lr_0 = 2.9209e-04
Validation rmse = 0.104167
Epoch 28
Validation rmse = 0.103645
Epoch 29
Loss = 8.5340e-02, PNorm = 34.4127, GNorm = 0.8270, lr_0 = 2.6766e-04
Validation rmse = 0.107456
Epoch 30
Loss = 9.2828e-02, PNorm = 34.4215, GNorm = 2.1846, lr_0 = 2.4723e-04
Loss = 1.0869e-01, PNorm = 34.4225, GNorm = 4.3026, lr_0 = 2.4528e-04
Validation rmse = 0.102958
Epoch 31
Validation rmse = 0.103891
Epoch 32
Loss = 8.4011e-02, PNorm = 34.4305, GNorm = 1.2282, lr_0 = 2.2655e-04
Validation rmse = 0.110116
Epoch 33
Validation rmse = 0.105372
Epoch 34
Loss = 8.6346e-02, PNorm = 34.4392, GNorm = 2.2933, lr_0 = 2.0761e-04
Validation rmse = 0.102421
Epoch 35
Validation rmse = 0.106034
Epoch 36
Loss = 8.0103e-02, PNorm = 34.4467, GNorm = 4.5074, lr_0 = 1.9024e-04
Validation rmse = 0.103902
Epoch 37
Validation rmse = 0.105077
Epoch 38
Loss = 9.3362e-02, PNorm = 34.4536, GNorm = 3.4379, lr_0 = 1.7433e-04
Validation rmse = 0.103893
Epoch 39
Loss = 8.3959e-02, PNorm = 34.4604, GNorm = 4.0955, lr_0 = 1.5975e-04
Validation rmse = 0.104469
Epoch 40
Validation rmse = 0.103629
Epoch 41
Loss = 7.8994e-02, PNorm = 34.4668, GNorm = 0.7521, lr_0 = 1.4639e-04
Validation rmse = 0.102611
Epoch 42
Validation rmse = 0.102854
Epoch 43
Loss = 7.5093e-02, PNorm = 34.4727, GNorm = 1.4676, lr_0 = 1.3415e-04
Validation rmse = 0.102933
Epoch 44
Validation rmse = 0.102742
Epoch 45
Loss = 7.0710e-02, PNorm = 34.4783, GNorm = 3.0743, lr_0 = 1.2293e-04
Validation rmse = 0.103070
Epoch 46
Validation rmse = 0.102844
Epoch 47
Loss = 6.9263e-02, PNorm = 34.4836, GNorm = 1.2240, lr_0 = 1.1265e-04
Validation rmse = 0.103502
Epoch 48
Validation rmse = 0.104020
Epoch 49
Loss = 6.9984e-02, PNorm = 34.4886, GNorm = 1.5025, lr_0 = 1.0323e-04
Validation rmse = 0.103426
Epoch 50
Loss = 7.5063e-02, PNorm = 34.4926, GNorm = 2.5465, lr_0 = 1.0000e-04
Loss = 7.4506e-02, PNorm = 34.4930, GNorm = 2.3221, lr_0 = 1.0000e-04
Validation rmse = 0.104032
Epoch 51
Validation rmse = 0.104089
Epoch 52
Loss = 7.4237e-02, PNorm = 34.4969, GNorm = 2.0073, lr_0 = 1.0000e-04
Validation rmse = 0.104321
Epoch 53
Validation rmse = 0.104059
Epoch 54
Loss = 7.2789e-02, PNorm = 34.5016, GNorm = 0.4577, lr_0 = 1.0000e-04
Validation rmse = 0.103753
Epoch 55
Validation rmse = 0.103970
Epoch 56
Loss = 6.0127e-02, PNorm = 34.5061, GNorm = 3.5452, lr_0 = 1.0000e-04
Validation rmse = 0.104154
Epoch 57
Validation rmse = 0.104267
Epoch 58
Loss = 6.8707e-02, PNorm = 34.5109, GNorm = 2.6614, lr_0 = 1.0000e-04
Validation rmse = 0.104426
Epoch 59
Loss = 6.9739e-02, PNorm = 34.5157, GNorm = 0.6894, lr_0 = 1.0000e-04
Validation rmse = 0.104501
Model 0 best validation rmse = 0.102421 on epoch 34
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.073834
Ensemble test rmse = 0.073834
1-fold cross validation
	Seed 0 ==> test rmse = 0.073834
Overall test rmse = 0.073834 +/- 0.000000
Elapsed time = 0:00:14
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 337 | train size = 267 | val size = 68 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.240888
Epoch 1
Loss = 7.2978e-01, PNorm = 34.0385, GNorm = 2.5371, lr_0 = 9.8425e-04
Loss = 8.6443e-01, PNorm = 34.0431, GNorm = 13.1278, lr_0 = 9.7646e-04
Validation rmse = 0.192318
Epoch 2
Validation rmse = 0.157563
Epoch 3
Loss = 3.9981e-01, PNorm = 34.1059, GNorm = 5.4896, lr_0 = 9.0193e-04
Validation rmse = 0.124569
Epoch 4
Validation rmse = 0.115481
Epoch 5
Loss = 2.5931e-01, PNorm = 34.1762, GNorm = 5.2334, lr_0 = 8.1996e-04
Validation rmse = 0.113429
Epoch 6
Validation rmse = 0.112979
Epoch 7
Loss = 1.9129e-01, PNorm = 34.2251, GNorm = 4.5451, lr_0 = 7.5138e-04
Validation rmse = 0.141209
Epoch 8
Validation rmse = 0.123562
Epoch 9
Loss = 1.7437e-01, PNorm = 34.2594, GNorm = 2.1076, lr_0 = 6.8854e-04
Validation rmse = 0.114123
Epoch 10
Validation rmse = 0.105421
Epoch 11
Loss = 1.8058e-01, PNorm = 34.2900, GNorm = 4.3491, lr_0 = 6.2597e-04
Validation rmse = 0.122282
Epoch 12
Validation rmse = 0.104525
Epoch 13
Loss = 1.1984e-01, PNorm = 34.3156, GNorm = 0.5767, lr_0 = 5.7362e-04
Validation rmse = 0.112577
Epoch 14
Loss = 1.2592e-01, PNorm = 34.3351, GNorm = 5.2029, lr_0 = 5.2564e-04
Validation rmse = 0.099874
Epoch 15
Validation rmse = 0.102994
Epoch 16
Loss = 1.0209e-01, PNorm = 34.3531, GNorm = 0.4598, lr_0 = 4.8168e-04
Loss = 1.2696e-01, PNorm = 34.3545, GNorm = 1.5364, lr_0 = 4.7787e-04
Validation rmse = 0.103307
Epoch 17
Validation rmse = 0.102614
Epoch 18
Loss = 1.4679e-01, PNorm = 34.3691, GNorm = 5.0053, lr_0 = 4.4140e-04
Validation rmse = 0.097832
Epoch 19
Validation rmse = 0.103106
Epoch 20
Loss = 9.4494e-02, PNorm = 34.3842, GNorm = 3.8386, lr_0 = 4.0128e-04
Validation rmse = 0.098303
Epoch 21
Validation rmse = 0.104217
Epoch 22
Loss = 8.7962e-02, PNorm = 34.3971, GNorm = 5.0540, lr_0 = 3.6772e-04
Validation rmse = 0.104713
Epoch 23
Validation rmse = 0.103744
Epoch 24
Loss = 8.5199e-02, PNorm = 34.4084, GNorm = 0.9283, lr_0 = 3.3697e-04
Validation rmse = 0.099190
Epoch 25
Validation rmse = 0.099287
Epoch 26
Loss = 9.0325e-02, PNorm = 34.4203, GNorm = 1.0884, lr_0 = 3.0634e-04
Validation rmse = 0.107979
Epoch 27
Validation rmse = 0.098552
Epoch 28
Loss = 7.2921e-02, PNorm = 34.4302, GNorm = 3.9505, lr_0 = 2.8072e-04
Validation rmse = 0.098392
Epoch 29
Loss = 9.7213e-02, PNorm = 34.4389, GNorm = 5.7880, lr_0 = 2.5724e-04
Validation rmse = 0.096967
Epoch 30
Validation rmse = 0.116695
Epoch 31
Loss = 9.6460e-02, PNorm = 34.4456, GNorm = 3.0972, lr_0 = 2.3573e-04
Loss = 9.2657e-02, PNorm = 34.4463, GNorm = 1.7856, lr_0 = 2.3387e-04
Validation rmse = 0.095157
Epoch 32
Validation rmse = 0.095252
Epoch 33
Loss = 7.7173e-02, PNorm = 34.4537, GNorm = 2.2028, lr_0 = 2.1601e-04
Validation rmse = 0.107133
Epoch 34
Validation rmse = 0.096375
Epoch 35
Loss = 7.2282e-02, PNorm = 34.4626, GNorm = 2.5513, lr_0 = 1.9638e-04
Validation rmse = 0.096733
Epoch 36
Validation rmse = 0.100489
Epoch 37
Loss = 6.6963e-02, PNorm = 34.4687, GNorm = 0.9001, lr_0 = 1.7996e-04
Validation rmse = 0.096015
Epoch 38
Validation rmse = 0.094984
Epoch 39
Loss = 7.6353e-02, PNorm = 34.4751, GNorm = 3.1883, lr_0 = 1.6491e-04
Validation rmse = 0.104071
Epoch 40
Validation rmse = 0.095130
Epoch 41
Loss = 8.5906e-02, PNorm = 34.4815, GNorm = 4.0372, lr_0 = 1.4992e-04
Validation rmse = 0.107019
Epoch 42
Validation rmse = 0.094819
Epoch 43
Loss = 6.8520e-02, PNorm = 34.4871, GNorm = 3.2100, lr_0 = 1.3738e-04
Validation rmse = 0.109632
Epoch 44
Loss = 7.6321e-02, PNorm = 34.4920, GNorm = 0.8702, lr_0 = 1.2589e-04
Validation rmse = 0.095085
Epoch 45
Validation rmse = 0.103963
Epoch 46
Loss = 7.1088e-02, PNorm = 34.4966, GNorm = 0.9753, lr_0 = 1.1536e-04
Loss = 7.6154e-02, PNorm = 34.4969, GNorm = 2.5350, lr_0 = 1.1445e-04
Validation rmse = 0.094981
Epoch 47
Validation rmse = 0.100774
Epoch 48
Loss = 6.9823e-02, PNorm = 34.5005, GNorm = 0.6683, lr_0 = 1.0572e-04
Validation rmse = 0.096661
Epoch 49
Validation rmse = 0.097783
Epoch 50
Loss = 5.9756e-02, PNorm = 34.5044, GNorm = 0.4617, lr_0 = 1.0000e-04
Validation rmse = 0.098653
Epoch 51
Validation rmse = 0.097885
Epoch 52
Loss = 5.9955e-02, PNorm = 34.5083, GNorm = 1.6139, lr_0 = 1.0000e-04
Validation rmse = 0.096972
Epoch 53
Validation rmse = 0.099090
Epoch 54
Loss = 7.1237e-02, PNorm = 34.5121, GNorm = 2.2215, lr_0 = 1.0000e-04
Validation rmse = 0.097214
Epoch 55
Validation rmse = 0.099738
Epoch 56
Loss = 6.3033e-02, PNorm = 34.5162, GNorm = 1.0622, lr_0 = 1.0000e-04
Validation rmse = 0.098456
Epoch 57
Validation rmse = 0.098130
Epoch 58
Loss = 4.5877e-02, PNorm = 34.5201, GNorm = 0.5188, lr_0 = 1.0000e-04
Validation rmse = 0.098085
Epoch 59
Loss = 5.9648e-02, PNorm = 34.5235, GNorm = 1.6099, lr_0 = 1.0000e-04
Loss = 6.7977e-02, PNorm = 34.5240, GNorm = 1.0862, lr_0 = 1.0000e-04
Validation rmse = 0.097985
Model 0 best validation rmse = 0.094819 on epoch 42
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.054373
Ensemble test rmse = 0.054373
1-fold cross validation
	Seed 0 ==> test rmse = 0.054373
Overall test rmse = 0.054373 +/- 0.000000
Elapsed time = 0:00:14
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 327 | train size = 259 | val size = 66 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.216323
Epoch 1
Loss = 7.6196e-01, PNorm = 34.0368, GNorm = 8.1199, lr_0 = 9.8425e-04
Loss = 1.5607e+00, PNorm = 34.0408, GNorm = 14.6544, lr_0 = 9.7646e-04
Validation rmse = 0.203771
Epoch 2
Validation rmse = 0.173405
Epoch 3
Loss = 3.8469e-01, PNorm = 34.0998, GNorm = 2.8350, lr_0 = 8.9480e-04
Loss = 3.0371e-01, PNorm = 34.1064, GNorm = 2.9880, lr_0 = 8.8772e-04
Validation rmse = 0.146998
Epoch 4
Validation rmse = 0.136555
Epoch 5
Loss = 3.1123e-01, PNorm = 34.1655, GNorm = 1.3447, lr_0 = 8.1348e-04
Validation rmse = 0.139448
Epoch 6
Validation rmse = 0.112611
Epoch 7
Loss = 2.1525e-01, PNorm = 34.2054, GNorm = 6.9398, lr_0 = 7.4544e-04
Validation rmse = 0.120003
Epoch 8
Validation rmse = 0.125003
Epoch 9
Loss = 1.8233e-01, PNorm = 34.2381, GNorm = 7.1292, lr_0 = 6.7770e-04
Validation rmse = 0.106722
Epoch 10
Validation rmse = 0.096205
Epoch 11
Loss = 1.7585e-01, PNorm = 34.2616, GNorm = 2.6207, lr_0 = 6.1611e-04
Validation rmse = 0.130411
Epoch 12
Validation rmse = 0.098243
Epoch 13
Loss = 1.6154e-01, PNorm = 34.2828, GNorm = 2.6805, lr_0 = 5.6458e-04
Validation rmse = 0.090451
Epoch 14
Validation rmse = 0.087631
Epoch 15
Loss = 1.2456e-01, PNorm = 34.3039, GNorm = 0.7771, lr_0 = 5.1327e-04
Validation rmse = 0.093903
Epoch 16
Validation rmse = 0.087964
Epoch 17
Loss = 1.1576e-01, PNorm = 34.3182, GNorm = 0.5934, lr_0 = 4.7034e-04
Validation rmse = 0.085348
Epoch 18
Validation rmse = 0.089651
Epoch 19
Loss = 1.1206e-01, PNorm = 34.3307, GNorm = 1.0502, lr_0 = 4.2760e-04
Validation rmse = 0.093393
Epoch 20
Validation rmse = 0.096702
Epoch 21
Loss = 1.0310e-01, PNorm = 34.3411, GNorm = 0.4551, lr_0 = 3.8874e-04
Validation rmse = 0.096681
Epoch 22
Validation rmse = 0.109771
Epoch 23
Loss = 1.3646e-01, PNorm = 34.3533, GNorm = 5.2958, lr_0 = 3.5622e-04
Validation rmse = 0.098589
Epoch 24
Validation rmse = 0.082293
Epoch 25
Loss = 7.7813e-02, PNorm = 34.3645, GNorm = 0.5517, lr_0 = 3.2385e-04
Validation rmse = 0.086178
Epoch 26
Validation rmse = 0.093499
Epoch 27
Loss = 1.2219e-01, PNorm = 34.3734, GNorm = 2.4052, lr_0 = 2.9442e-04
Validation rmse = 0.094241
Epoch 28
Loss = 9.2185e-02, PNorm = 34.3809, GNorm = 2.8580, lr_0 = 2.7195e-04
Loss = 6.5672e-02, PNorm = 34.3816, GNorm = 3.5047, lr_0 = 2.6980e-04
Validation rmse = 0.087170
Epoch 29
Validation rmse = 0.085285
Epoch 30
Loss = 1.0550e-01, PNorm = 34.3883, GNorm = 5.8542, lr_0 = 2.4723e-04
Loss = 1.4049e-01, PNorm = 34.3891, GNorm = 6.6462, lr_0 = 2.4528e-04
Validation rmse = 0.091361
Epoch 31
Validation rmse = 0.089988
Epoch 32
Loss = 9.4603e-02, PNorm = 34.3961, GNorm = 0.5881, lr_0 = 2.2476e-04
Loss = 6.2264e-02, PNorm = 34.3968, GNorm = 1.9863, lr_0 = 2.2299e-04
Validation rmse = 0.085530
Epoch 33
Validation rmse = 0.085997
Epoch 34
Loss = 7.3654e-02, PNorm = 34.4026, GNorm = 1.1568, lr_0 = 2.0596e-04
Validation rmse = 0.084691
Epoch 35
Validation rmse = 0.083317
Epoch 36
Loss = 7.4280e-02, PNorm = 34.4095, GNorm = 1.3527, lr_0 = 1.8725e-04
Validation rmse = 0.083075
Epoch 37
Validation rmse = 0.084560
Epoch 38
Loss = 7.4970e-02, PNorm = 34.4155, GNorm = 2.9357, lr_0 = 1.7023e-04
Validation rmse = 0.083715
Epoch 39
Validation rmse = 0.083898
Epoch 40
Loss = 9.8183e-02, PNorm = 34.4206, GNorm = 5.6965, lr_0 = 1.5599e-04
Validation rmse = 0.082687
Epoch 41
Validation rmse = 0.082281
Epoch 42
Loss = 7.8357e-02, PNorm = 34.4252, GNorm = 0.8562, lr_0 = 1.4182e-04
Validation rmse = 0.082164
Epoch 43
Validation rmse = 0.081928
Epoch 44
Loss = 7.2172e-02, PNorm = 34.4294, GNorm = 0.8980, lr_0 = 1.2893e-04
Validation rmse = 0.083619
Epoch 45
Validation rmse = 0.082448
Epoch 46
Loss = 6.8786e-02, PNorm = 34.4324, GNorm = 0.6764, lr_0 = 1.1814e-04
Validation rmse = 0.081291
Epoch 47
Validation rmse = 0.081716
Epoch 48
Loss = 6.9670e-02, PNorm = 34.4358, GNorm = 1.0650, lr_0 = 1.0741e-04
Validation rmse = 0.081551
Epoch 49
Validation rmse = 0.081329
Epoch 50
Loss = 4.8567e-02, PNorm = 34.4389, GNorm = 1.9632, lr_0 = 1.0000e-04
Validation rmse = 0.081713
Epoch 51
Validation rmse = 0.082094
Epoch 52
Loss = 6.9116e-02, PNorm = 34.4417, GNorm = 1.8676, lr_0 = 1.0000e-04
Validation rmse = 0.082074
Epoch 53
Validation rmse = 0.082519
Epoch 54
Loss = 5.6922e-02, PNorm = 34.4443, GNorm = 0.3769, lr_0 = 1.0000e-04
Validation rmse = 0.083028
Epoch 55
Loss = 6.2194e-02, PNorm = 34.4467, GNorm = 1.1584, lr_0 = 1.0000e-04
Validation rmse = 0.083540
Epoch 56
Validation rmse = 0.082995
Epoch 57
Loss = 6.3222e-02, PNorm = 34.4497, GNorm = 2.6305, lr_0 = 1.0000e-04
Loss = 1.1416e-01, PNorm = 34.4501, GNorm = 4.9571, lr_0 = 1.0000e-04
Validation rmse = 0.082870
Epoch 58
Validation rmse = 0.081535
Epoch 59
Loss = 6.5962e-02, PNorm = 34.4534, GNorm = 2.2612, lr_0 = 1.0000e-04
Loss = 9.0393e-02, PNorm = 34.4537, GNorm = 3.8310, lr_0 = 1.0000e-04
Validation rmse = 0.081543
Model 0 best validation rmse = 0.081291 on epoch 46
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.073735
Ensemble test rmse = 0.073735
1-fold cross validation
	Seed 0 ==> test rmse = 0.073735
Overall test rmse = 0.073735 +/- 0.000000
Elapsed time = 0:00:13
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 317 | train size = 252 | val size = 63 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.198994
Epoch 1
Loss = 7.1655e-01, PNorm = 34.0306, GNorm = 1.5865, lr_0 = 9.8425e-04
Loss = 1.2721e+00, PNorm = 34.0346, GNorm = 18.8271, lr_0 = 9.7646e-04
Validation rmse = 0.177112
Epoch 2
Validation rmse = 0.167157
Epoch 3
Loss = 5.1472e-01, PNorm = 34.0885, GNorm = 5.0275, lr_0 = 8.9480e-04
Loss = 1.3666e-01, PNorm = 34.0940, GNorm = 5.4507, lr_0 = 8.8772e-04
Validation rmse = 0.147857
Epoch 4
Validation rmse = 0.131308
Epoch 5
Loss = 2.7553e-01, PNorm = 34.1643, GNorm = 2.4047, lr_0 = 8.1348e-04
Loss = 1.1394e-01, PNorm = 34.1699, GNorm = 4.8155, lr_0 = 8.0704e-04
Validation rmse = 0.123510
Epoch 6
Validation rmse = 0.121378
Epoch 7
Loss = 2.3112e-01, PNorm = 34.2145, GNorm = 4.8155, lr_0 = 7.3955e-04
Loss = 2.0723e-01, PNorm = 34.2166, GNorm = 4.7899, lr_0 = 7.3370e-04
Validation rmse = 0.138704
Epoch 8
Validation rmse = 0.108339
Epoch 9
Loss = 1.7729e-01, PNorm = 34.2380, GNorm = 1.9287, lr_0 = 6.7234e-04
Loss = 2.5975e-01, PNorm = 34.2408, GNorm = 11.0361, lr_0 = 6.6702e-04
Validation rmse = 0.145167
Epoch 10
Validation rmse = 0.095137
Epoch 11
Loss = 2.2307e-01, PNorm = 34.2612, GNorm = 0.8288, lr_0 = 6.1123e-04
Loss = 1.3616e-02, PNorm = 34.2624, GNorm = 2.9416, lr_0 = 6.0640e-04
Validation rmse = 0.158688
Epoch 12
Validation rmse = 0.154035
Epoch 13
Loss = 2.3200e-01, PNorm = 34.2759, GNorm = 5.4780, lr_0 = 5.5568e-04
Loss = 3.1511e-01, PNorm = 34.2771, GNorm = 9.7003, lr_0 = 5.5129e-04
Validation rmse = 0.107555
Epoch 14
Validation rmse = 0.097769
Epoch 15
Loss = 1.4440e-01, PNorm = 34.2927, GNorm = 5.1828, lr_0 = 5.0518e-04
Loss = 7.6967e-02, PNorm = 34.2943, GNorm = 6.1178, lr_0 = 5.0119e-04
Validation rmse = 0.091592
Epoch 16
Validation rmse = 0.091241
Epoch 17
Loss = 1.3043e-01, PNorm = 34.3101, GNorm = 0.8519, lr_0 = 4.5927e-04
Loss = 1.3888e-02, PNorm = 34.3113, GNorm = 2.0787, lr_0 = 4.5564e-04
Validation rmse = 0.086933
Epoch 18
Validation rmse = 0.083458
Epoch 19
Loss = 1.2790e-01, PNorm = 34.3244, GNorm = 2.4902, lr_0 = 4.1753e-04
Loss = 1.6868e-01, PNorm = 34.3251, GNorm = 12.4338, lr_0 = 4.1423e-04
Validation rmse = 0.082596
Epoch 20
Validation rmse = 0.080125
Epoch 21
Loss = 9.4411e-02, PNorm = 34.3370, GNorm = 0.4016, lr_0 = 3.7959e-04
Loss = 5.2611e-02, PNorm = 34.3377, GNorm = 6.9817, lr_0 = 3.7658e-04
Validation rmse = 0.078562
Epoch 22
Validation rmse = 0.079639
Epoch 23
Loss = 9.6905e-02, PNorm = 34.3448, GNorm = 1.4825, lr_0 = 3.4509e-04
Loss = 6.3167e-02, PNorm = 34.3454, GNorm = 3.8414, lr_0 = 3.4236e-04
Validation rmse = 0.084941
Epoch 24
Validation rmse = 0.080519
Epoch 25
Loss = 8.2313e-02, PNorm = 34.3516, GNorm = 1.2490, lr_0 = 3.1623e-04
Validation rmse = 0.081865
Epoch 26
Validation rmse = 0.080856
Epoch 27
Loss = 8.5462e-02, PNorm = 34.3602, GNorm = 0.4381, lr_0 = 2.8749e-04
Validation rmse = 0.084367
Epoch 28
Validation rmse = 0.092892
Epoch 29
Loss = 1.1477e-01, PNorm = 34.3664, GNorm = 3.4136, lr_0 = 2.6136e-04
Validation rmse = 0.078822
Epoch 30
Validation rmse = 0.081808
Epoch 31
Loss = 8.5514e-02, PNorm = 34.3707, GNorm = 1.3275, lr_0 = 2.3761e-04
Validation rmse = 0.081828
Epoch 32
Validation rmse = 0.079154
Epoch 33
Loss = 7.0794e-02, PNorm = 34.3749, GNorm = 2.8098, lr_0 = 2.1601e-04
Validation rmse = 0.085844
Epoch 34
Validation rmse = 0.079315
Epoch 35
Loss = 6.9997e-02, PNorm = 34.3812, GNorm = 0.3431, lr_0 = 1.9638e-04
Validation rmse = 0.078246
Epoch 36
Validation rmse = 0.078330
Epoch 37
Loss = 7.4736e-02, PNorm = 34.3856, GNorm = 1.3600, lr_0 = 1.7854e-04
Validation rmse = 0.077623
Epoch 38
Validation rmse = 0.079400
Epoch 39
Loss = 7.1760e-02, PNorm = 34.3898, GNorm = 1.9022, lr_0 = 1.6231e-04
Validation rmse = 0.076216
Epoch 40
Validation rmse = 0.074385
Epoch 41
Loss = 6.6694e-02, PNorm = 34.3928, GNorm = 0.9834, lr_0 = 1.4756e-04
Validation rmse = 0.074205
Epoch 42
Validation rmse = 0.073766
Epoch 43
Loss = 7.7645e-02, PNorm = 34.3947, GNorm = 4.8087, lr_0 = 1.3415e-04
Validation rmse = 0.081391
Epoch 44
Validation rmse = 0.078004
Epoch 45
Loss = 7.7593e-02, PNorm = 34.3969, GNorm = 0.6135, lr_0 = 1.2196e-04
Validation rmse = 0.075923
Epoch 46
Validation rmse = 0.075199
Epoch 47
Loss = 6.7064e-02, PNorm = 34.3996, GNorm = 1.6318, lr_0 = 1.1087e-04
Validation rmse = 0.074863
Epoch 48
Validation rmse = 0.078431
Epoch 49
Loss = 7.3368e-02, PNorm = 34.4027, GNorm = 3.1793, lr_0 = 1.0080e-04
Validation rmse = 0.074546
Epoch 50
Validation rmse = 0.073921
Epoch 51
Loss = 5.4732e-02, PNorm = 34.4052, GNorm = 0.8251, lr_0 = 1.0000e-04
Validation rmse = 0.071576
Epoch 52
Validation rmse = 0.071727
Epoch 53
Loss = 6.3006e-02, PNorm = 34.4078, GNorm = 1.0421, lr_0 = 1.0000e-04
Validation rmse = 0.072952
Epoch 54
Validation rmse = 0.072934
Epoch 55
Loss = 6.4219e-02, PNorm = 34.4099, GNorm = 0.6872, lr_0 = 1.0000e-04
Validation rmse = 0.076256
Epoch 56
Validation rmse = 0.073390
Epoch 57
Loss = 5.8807e-02, PNorm = 34.4119, GNorm = 0.3569, lr_0 = 1.0000e-04
Validation rmse = 0.073591
Epoch 58
Validation rmse = 0.075810
Epoch 59
Loss = 6.2256e-02, PNorm = 34.4152, GNorm = 1.7105, lr_0 = 1.0000e-04
Validation rmse = 0.075726
Model 0 best validation rmse = 0.071576 on epoch 51
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.200451
Ensemble test rmse = 0.200451
1-fold cross validation
	Seed 0 ==> test rmse = 0.200451
Overall test rmse = 0.200451 +/- 0.000000
Elapsed time = 0:00:14
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 307 | train size = 244 | val size = 61 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.209199
Epoch 1
Validation rmse = 0.177580
Epoch 2
Loss = 2.7290e-01, PNorm = 34.0529, GNorm = 2.0667, lr_0 = 9.6108e-04
Validation rmse = 0.164339
Epoch 3
Validation rmse = 0.136945
Epoch 4
Loss = 2.4135e-01, PNorm = 34.1185, GNorm = 3.5687, lr_0 = 8.7027e-04
Validation rmse = 0.138451
Epoch 5
Validation rmse = 0.129931
Epoch 6
Loss = 2.4794e-01, PNorm = 34.1691, GNorm = 8.7278, lr_0 = 7.8805e-04
Validation rmse = 0.109880
Epoch 7
Validation rmse = 0.105026
Epoch 8
Loss = 1.4112e-01, PNorm = 34.2029, GNorm = 3.4142, lr_0 = 7.1359e-04
Validation rmse = 0.104299
Epoch 9
Validation rmse = 0.096423
Epoch 10
Loss = 9.9983e-02, PNorm = 34.2311, GNorm = 3.0512, lr_0 = 6.3979e-04
Validation rmse = 0.089056
Epoch 11
Validation rmse = 0.107419
Epoch 12
Loss = 9.1037e-02, PNorm = 34.2533, GNorm = 0.7958, lr_0 = 5.7934e-04
Validation rmse = 0.083662
Epoch 13
Validation rmse = 0.093196
Epoch 14
Loss = 9.7848e-02, PNorm = 34.2700, GNorm = 0.4577, lr_0 = 5.2460e-04
Validation rmse = 0.079972
Epoch 15
Validation rmse = 0.081435
Epoch 16
Loss = 5.9384e-02, PNorm = 34.2854, GNorm = 2.1073, lr_0 = 4.7503e-04
Validation rmse = 0.080484
Epoch 17
Validation rmse = 0.077678
Epoch 18
Loss = 7.0273e-02, PNorm = 34.3007, GNorm = 4.5208, lr_0 = 4.2590e-04
Validation rmse = 0.077268
Epoch 19
Validation rmse = 0.075874
Epoch 20
Loss = 5.8704e-02, PNorm = 34.3122, GNorm = 0.6171, lr_0 = 3.8566e-04
Validation rmse = 0.083708
Epoch 21
Validation rmse = 0.078020
Epoch 22
Loss = 5.6642e-02, PNorm = 34.3219, GNorm = 1.8519, lr_0 = 3.4922e-04
Validation rmse = 0.075735
Epoch 23
Validation rmse = 0.076061
Epoch 24
Loss = 6.6033e-02, PNorm = 34.3312, GNorm = 4.6683, lr_0 = 3.1623e-04
Validation rmse = 0.083190
Epoch 25
Validation rmse = 0.076157
Epoch 26
Loss = 4.9109e-02, PNorm = 34.3390, GNorm = 2.8600, lr_0 = 2.8352e-04
Validation rmse = 0.076241
Epoch 27
Validation rmse = 0.083152
Epoch 28
Loss = 6.1906e-02, PNorm = 34.3460, GNorm = 5.1878, lr_0 = 2.5673e-04
Validation rmse = 0.081958
Epoch 29
Validation rmse = 0.076600
Epoch 30
Loss = 4.7554e-02, PNorm = 34.3530, GNorm = 1.7255, lr_0 = 2.3248e-04
Validation rmse = 0.077153
Epoch 31
Validation rmse = 0.076583
Epoch 32
Loss = 4.6586e-02, PNorm = 34.3587, GNorm = 1.2671, lr_0 = 2.1051e-04
Validation rmse = 0.075519
Epoch 33
Validation rmse = 0.079852
Epoch 34
Loss = 4.4053e-02, PNorm = 34.3644, GNorm = 0.5816, lr_0 = 1.8874e-04
Validation rmse = 0.076471
Epoch 35
Validation rmse = 0.077326
Epoch 36
Loss = 4.3896e-02, PNorm = 34.3689, GNorm = 1.9815, lr_0 = 1.7091e-04
Validation rmse = 0.075716
Epoch 37
Validation rmse = 0.079190
Epoch 38
Loss = 4.2885e-02, PNorm = 34.3731, GNorm = 0.8998, lr_0 = 1.5476e-04
Validation rmse = 0.075148
Epoch 39
Validation rmse = 0.080513
Epoch 40
Loss = 4.3042e-02, PNorm = 34.3770, GNorm = 0.2519, lr_0 = 1.4014e-04
Validation rmse = 0.075640
Epoch 41
Validation rmse = 0.078294
Epoch 42
Validation rmse = 0.076460
Epoch 43
Loss = 3.0030e-02, PNorm = 34.3809, GNorm = 0.7476, lr_0 = 1.2564e-04
Validation rmse = 0.075794
Epoch 44
Validation rmse = 0.076977
Epoch 45
Loss = 4.8553e-02, PNorm = 34.3841, GNorm = 1.5781, lr_0 = 1.1377e-04
Validation rmse = 0.076794
Epoch 46
Validation rmse = 0.076091
Epoch 47
Loss = 3.8794e-02, PNorm = 34.3870, GNorm = 0.5504, lr_0 = 1.0302e-04
Validation rmse = 0.076264
Epoch 48
Validation rmse = 0.076174
Epoch 49
Loss = 4.2942e-02, PNorm = 34.3898, GNorm = 1.2152, lr_0 = 1.0000e-04
Validation rmse = 0.076624
Epoch 50
Validation rmse = 0.076176
Epoch 51
Loss = 3.9448e-02, PNorm = 34.3928, GNorm = 0.5911, lr_0 = 1.0000e-04
Validation rmse = 0.076715
Epoch 52
Validation rmse = 0.075624
Epoch 53
Loss = 3.9349e-02, PNorm = 34.3955, GNorm = 1.4248, lr_0 = 1.0000e-04
Validation rmse = 0.078407
Epoch 54
Validation rmse = 0.075505
Epoch 55
Loss = 4.1735e-02, PNorm = 34.3983, GNorm = 2.5648, lr_0 = 1.0000e-04
Validation rmse = 0.078347
Epoch 56
Validation rmse = 0.076195
Epoch 57
Loss = 4.2283e-02, PNorm = 34.4010, GNorm = 0.3939, lr_0 = 1.0000e-04
Validation rmse = 0.077651
Epoch 58
Validation rmse = 0.075823
Epoch 59
Loss = 4.2855e-02, PNorm = 34.4043, GNorm = 0.8074, lr_0 = 1.0000e-04
Validation rmse = 0.076102
Model 0 best validation rmse = 0.075148 on epoch 38
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.061167
Ensemble test rmse = 0.061167
1-fold cross validation
	Seed 0 ==> test rmse = 0.061167
Overall test rmse = 0.061167 +/- 0.000000
Elapsed time = 0:00:13
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 297 | train size = 236 | val size = 59 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.202731
Epoch 1
Validation rmse = 0.164325
Epoch 2
Loss = 4.6579e-01, PNorm = 34.0407, GNorm = 1.4951, lr_0 = 9.6108e-04
Validation rmse = 0.161416
Epoch 3
Validation rmse = 0.189858
Epoch 4
Loss = 3.5711e-01, PNorm = 34.1006, GNorm = 1.5702, lr_0 = 8.6168e-04
Validation rmse = 0.148754
Epoch 5
Validation rmse = 0.141919
Epoch 6
Loss = 2.6077e-01, PNorm = 34.1521, GNorm = 5.4494, lr_0 = 7.8026e-04
Validation rmse = 0.174638
Epoch 7
Validation rmse = 0.128105
Epoch 8
Loss = 3.3246e-01, PNorm = 34.1993, GNorm = 4.8583, lr_0 = 6.9956e-04
Validation rmse = 0.129011
Epoch 9
Validation rmse = 0.107563
Epoch 10
Loss = 1.5353e-01, PNorm = 34.2341, GNorm = 3.5624, lr_0 = 6.3347e-04
Validation rmse = 0.110798
Epoch 11
Validation rmse = 0.098605
Epoch 12
Loss = 1.2935e-01, PNorm = 34.2673, GNorm = 0.6044, lr_0 = 5.6795e-04
Validation rmse = 0.101520
Epoch 13
Validation rmse = 0.089387
Epoch 14
Loss = 9.3715e-02, PNorm = 34.2915, GNorm = 1.1594, lr_0 = 5.1429e-04
Loss = 8.1396e-02, PNorm = 34.2938, GNorm = 0.9400, lr_0 = 5.0921e-04
Validation rmse = 0.091290
Epoch 15
Validation rmse = 0.082475
Epoch 16
Loss = 7.5531e-02, PNorm = 34.3157, GNorm = 0.6015, lr_0 = 4.6110e-04
Validation rmse = 0.083481
Epoch 17
Validation rmse = 0.077879
Epoch 18
Validation rmse = 0.078807
Epoch 19
Loss = 6.8021e-02, PNorm = 34.3371, GNorm = 1.0722, lr_0 = 4.1341e-04
Validation rmse = 0.077592
Epoch 20
Validation rmse = 0.073722
Epoch 21
Loss = 6.9364e-02, PNorm = 34.3522, GNorm = 2.4509, lr_0 = 3.7435e-04
Validation rmse = 0.076361
Epoch 22
Validation rmse = 0.076103
Epoch 23
Loss = 6.1620e-02, PNorm = 34.3654, GNorm = 3.7927, lr_0 = 3.3563e-04
Validation rmse = 0.071066
Epoch 24
Validation rmse = 0.075710
Epoch 25
Loss = 5.4136e-02, PNorm = 34.3755, GNorm = 1.5435, lr_0 = 3.0392e-04
Validation rmse = 0.075744
Epoch 26
Validation rmse = 0.069274
Epoch 27
Loss = 5.6686e-02, PNorm = 34.3854, GNorm = 3.5747, lr_0 = 2.7249e-04
Validation rmse = 0.081961
Epoch 28
Validation rmse = 0.070205
Epoch 29
Loss = 5.2023e-02, PNorm = 34.3939, GNorm = 0.9670, lr_0 = 2.4430e-04
Validation rmse = 0.073244
Epoch 30
Validation rmse = 0.068477
Epoch 31
Loss = 4.3585e-02, PNorm = 34.4007, GNorm = 1.1713, lr_0 = 2.2122e-04
Validation rmse = 0.073861
Epoch 32
Validation rmse = 0.067660
Epoch 33
Loss = 4.4569e-02, PNorm = 34.4072, GNorm = 0.4894, lr_0 = 1.9834e-04
Validation rmse = 0.070472
Epoch 34
Validation rmse = 0.069073
Epoch 35
Validation rmse = 0.069099
Epoch 36
Loss = 4.8795e-02, PNorm = 34.4129, GNorm = 1.1627, lr_0 = 1.7783e-04
Validation rmse = 0.068609
Epoch 37
Validation rmse = 0.068896
Epoch 38
Loss = 3.9428e-02, PNorm = 34.4177, GNorm = 0.2217, lr_0 = 1.6103e-04
Validation rmse = 0.070034
Epoch 39
Validation rmse = 0.068683
Epoch 40
Loss = 4.4458e-02, PNorm = 34.4226, GNorm = 3.2296, lr_0 = 1.4437e-04
Validation rmse = 0.070381
Epoch 41
Validation rmse = 0.068909
Epoch 42
Loss = 3.4741e-02, PNorm = 34.4264, GNorm = 0.3384, lr_0 = 1.3073e-04
Validation rmse = 0.070475
Epoch 43
Validation rmse = 0.067670
Epoch 44
Loss = 3.7156e-02, PNorm = 34.4308, GNorm = 0.4616, lr_0 = 1.1721e-04
Validation rmse = 0.069349
Epoch 45
Validation rmse = 0.069026
Epoch 46
Loss = 3.7867e-02, PNorm = 34.4339, GNorm = 0.4391, lr_0 = 1.0614e-04
Validation rmse = 0.069202
Epoch 47
Validation rmse = 0.068370
Epoch 48
Loss = 3.8908e-02, PNorm = 34.4370, GNorm = 0.5615, lr_0 = 1.0000e-04
Validation rmse = 0.068897
Epoch 49
Validation rmse = 0.068500
Epoch 50
Loss = 3.8143e-02, PNorm = 34.4397, GNorm = 0.6748, lr_0 = 1.0000e-04
Loss = 2.8117e-02, PNorm = 34.4400, GNorm = 0.4074, lr_0 = 1.0000e-04
Validation rmse = 0.069655
Epoch 51
Validation rmse = 0.068588
Epoch 52
Loss = 3.7212e-02, PNorm = 34.4428, GNorm = 1.0059, lr_0 = 1.0000e-04
Validation rmse = 0.068433
Epoch 53
Validation rmse = 0.069041
Epoch 54
Validation rmse = 0.068474
Epoch 55
Loss = 4.2965e-02, PNorm = 34.4460, GNorm = 1.5027, lr_0 = 1.0000e-04
Validation rmse = 0.068959
Epoch 56
Validation rmse = 0.068329
Epoch 57
Loss = 3.1649e-02, PNorm = 34.4489, GNorm = 0.8858, lr_0 = 1.0000e-04
Validation rmse = 0.068524
Epoch 58
Validation rmse = 0.069041
Epoch 59
Loss = 3.7954e-02, PNorm = 34.4519, GNorm = 0.2913, lr_0 = 1.0000e-04
Validation rmse = 0.068850
Model 0 best validation rmse = 0.067660 on epoch 32
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.033921
Ensemble test rmse = 0.033921
1-fold cross validation
	Seed 0 ==> test rmse = 0.033921
Overall test rmse = 0.033921 +/- 0.000000
Elapsed time = 0:00:13
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 287 | train size = 228 | val size = 57 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.243971
Epoch 1
Validation rmse = 0.249103
Epoch 2
Loss = 7.0252e-01, PNorm = 34.0465, GNorm = 7.2851, lr_0 = 9.6108e-04
Validation rmse = 0.147178
Epoch 3
Validation rmse = 0.136104
Epoch 4
Loss = 3.2226e-01, PNorm = 34.1177, GNorm = 0.7345, lr_0 = 8.6168e-04
Validation rmse = 0.131463
Epoch 5
Validation rmse = 0.099830
Epoch 6
Loss = 1.7666e-01, PNorm = 34.1895, GNorm = 4.7968, lr_0 = 7.7256e-04
Validation rmse = 0.124782
Epoch 7
Validation rmse = 0.088525
Epoch 8
Loss = 1.3900e-01, PNorm = 34.2285, GNorm = 6.0113, lr_0 = 6.9266e-04
Validation rmse = 0.096284
Epoch 9
Validation rmse = 0.091819
Epoch 10
Loss = 8.3737e-02, PNorm = 34.2570, GNorm = 3.8505, lr_0 = 6.2102e-04
Validation rmse = 0.077182
Epoch 11
Validation rmse = 0.087391
Epoch 12
Validation rmse = 0.072854
Epoch 13
Loss = 6.1043e-02, PNorm = 34.2797, GNorm = 1.9768, lr_0 = 5.5679e-04
Validation rmse = 0.079147
Epoch 14
Validation rmse = 0.075042
Epoch 15
Loss = 4.4631e-02, PNorm = 34.2963, GNorm = 3.4033, lr_0 = 4.9920e-04
Validation rmse = 0.074129
Epoch 16
Validation rmse = 0.077292
Epoch 17
Loss = 5.2149e-02, PNorm = 34.3089, GNorm = 2.7050, lr_0 = 4.4757e-04
Validation rmse = 0.073562
Epoch 18
Validation rmse = 0.086512
Epoch 19
Loss = 5.4328e-02, PNorm = 34.3193, GNorm = 3.4024, lr_0 = 4.0128e-04
Validation rmse = 0.073013
Epoch 20
Validation rmse = 0.069996
Epoch 21
Loss = 4.0337e-02, PNorm = 34.3289, GNorm = 0.5619, lr_0 = 3.5978e-04
Validation rmse = 0.074469
Epoch 22
Validation rmse = 0.071275
Epoch 23
Validation rmse = 0.074020
Epoch 24
Loss = 4.5623e-02, PNorm = 34.3364, GNorm = 1.1306, lr_0 = 3.2257e-04
Validation rmse = 0.069941
Epoch 25
Validation rmse = 0.069488
Epoch 26
Loss = 4.2843e-02, PNorm = 34.3435, GNorm = 2.9289, lr_0 = 2.8921e-04
Validation rmse = 0.073169
Epoch 27
Validation rmse = 0.070365
Epoch 28
Loss = 3.7782e-02, PNorm = 34.3499, GNorm = 2.3869, lr_0 = 2.5929e-04
Validation rmse = 0.070718
Epoch 29
Validation rmse = 0.076152
Epoch 30
Loss = 4.2224e-02, PNorm = 34.3554, GNorm = 3.5452, lr_0 = 2.3248e-04
Validation rmse = 0.069219
Epoch 31
Validation rmse = 0.070080
Epoch 32
Loss = 3.8853e-02, PNorm = 34.3609, GNorm = 1.0381, lr_0 = 2.0843e-04
Validation rmse = 0.074359
Epoch 33
Validation rmse = 0.069721
Epoch 34
Validation rmse = 0.074509
Epoch 35
Loss = 5.0708e-02, PNorm = 34.3658, GNorm = 2.2705, lr_0 = 1.8688e-04
Validation rmse = 0.070031
Epoch 36
Validation rmse = 0.068207
Epoch 37
Loss = 3.0567e-02, PNorm = 34.3692, GNorm = 1.6293, lr_0 = 1.6755e-04
Validation rmse = 0.069963
Epoch 38
Validation rmse = 0.068648
Epoch 39
Loss = 3.6967e-02, PNorm = 34.3728, GNorm = 0.9248, lr_0 = 1.5022e-04
Validation rmse = 0.071067
Epoch 40
Validation rmse = 0.067776
Epoch 41
Loss = 3.3161e-02, PNorm = 34.3759, GNorm = 1.1689, lr_0 = 1.3468e-04
Validation rmse = 0.068234
Epoch 42
Validation rmse = 0.068540
Epoch 43
Loss = 3.1584e-02, PNorm = 34.3787, GNorm = 0.6718, lr_0 = 1.2196e-04
Loss = 3.1187e-02, PNorm = 34.3789, GNorm = 1.7375, lr_0 = 1.2075e-04
Validation rmse = 0.068530
Epoch 44
Validation rmse = 0.068128
Epoch 45
Validation rmse = 0.067570
Epoch 46
Loss = 3.7530e-02, PNorm = 34.3816, GNorm = 0.8210, lr_0 = 1.0826e-04
Validation rmse = 0.068285
Epoch 47
Validation rmse = 0.069085
Epoch 48
Loss = 3.0981e-02, PNorm = 34.3839, GNorm = 0.9348, lr_0 = 1.0000e-04
Validation rmse = 0.067982
Epoch 49
Validation rmse = 0.069156
Epoch 50
Loss = 2.9777e-02, PNorm = 34.3860, GNorm = 1.3768, lr_0 = 1.0000e-04
Validation rmse = 0.067424
Epoch 51
Validation rmse = 0.069426
Epoch 52
Loss = 2.9978e-02, PNorm = 34.3885, GNorm = 0.2809, lr_0 = 1.0000e-04
Validation rmse = 0.067502
Epoch 53
Validation rmse = 0.068952
Epoch 54
Loss = 2.9507e-02, PNorm = 34.3908, GNorm = 1.9672, lr_0 = 1.0000e-04
Loss = 4.0259e-02, PNorm = 34.3910, GNorm = 0.7817, lr_0 = 1.0000e-04
Validation rmse = 0.068872
Epoch 55
Validation rmse = 0.068766
Epoch 56
Validation rmse = 0.068953
Epoch 57
Loss = 3.1078e-02, PNorm = 34.3933, GNorm = 0.2575, lr_0 = 1.0000e-04
Validation rmse = 0.068180
Epoch 58
Validation rmse = 0.070376
Epoch 59
Loss = 2.5094e-02, PNorm = 34.3956, GNorm = 1.3983, lr_0 = 1.0000e-04
Validation rmse = 0.067437
Model 0 best validation rmse = 0.067424 on epoch 50
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.022210
Ensemble test rmse = 0.022210
1-fold cross validation
	Seed 0 ==> test rmse = 0.022210
Overall test rmse = 0.022210 +/- 0.000000
Elapsed time = 0:00:13
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 277 | train size = 220 | val size = 55 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.196053
Epoch 1
Validation rmse = 0.205274
Epoch 2
Loss = 4.4723e-01, PNorm = 34.0609, GNorm = 2.5665, lr_0 = 9.5159e-04
Validation rmse = 0.139828
Epoch 3
Validation rmse = 0.122599
Epoch 4
Loss = 2.2189e-01, PNorm = 34.1277, GNorm = 0.7963, lr_0 = 8.5317e-04
Validation rmse = 0.107908
Epoch 5
Validation rmse = 0.109926
Epoch 6
Loss = 1.6099e-01, PNorm = 34.1806, GNorm = 7.8463, lr_0 = 7.6493e-04
Loss = 9.2487e-02, PNorm = 34.1844, GNorm = 1.3808, lr_0 = 7.5737e-04
Validation rmse = 0.089529
Epoch 7
Validation rmse = 0.113556
Epoch 8
Validation rmse = 0.077825
Epoch 9
Loss = 9.5642e-02, PNorm = 34.2185, GNorm = 3.1922, lr_0 = 6.7904e-04
Validation rmse = 0.072137
Epoch 10
Validation rmse = 0.069589
Epoch 11
Loss = 6.2835e-02, PNorm = 34.2417, GNorm = 3.1474, lr_0 = 6.0881e-04
Validation rmse = 0.069180
Epoch 12
Validation rmse = 0.077744
Epoch 13
Loss = 8.0409e-02, PNorm = 34.2609, GNorm = 5.0708, lr_0 = 5.4584e-04
Validation rmse = 0.072844
Epoch 14
Validation rmse = 0.064502
Epoch 15
Loss = 4.6485e-02, PNorm = 34.2752, GNorm = 1.9413, lr_0 = 4.8939e-04
Loss = 5.9247e-02, PNorm = 34.2765, GNorm = 1.6762, lr_0 = 4.8456e-04
Validation rmse = 0.071040
Epoch 16
Validation rmse = 0.063318
Epoch 17
Validation rmse = 0.064637
Epoch 18
Loss = 3.8041e-02, PNorm = 34.2893, GNorm = 1.1248, lr_0 = 4.3444e-04
Validation rmse = 0.071736
Epoch 19
Validation rmse = 0.062662
Epoch 20
Loss = 4.1379e-02, PNorm = 34.2992, GNorm = 0.6137, lr_0 = 3.8951e-04
Validation rmse = 0.068247
Epoch 21
Validation rmse = 0.060795
Epoch 22
Loss = 4.0138e-02, PNorm = 34.3085, GNorm = 1.9422, lr_0 = 3.4577e-04
Validation rmse = 0.062906
Epoch 23
Validation rmse = 0.063797
Epoch 24
Loss = 3.5707e-02, PNorm = 34.3152, GNorm = 2.4319, lr_0 = 3.1001e-04
Validation rmse = 0.061292
Epoch 25
Validation rmse = 0.060846
Epoch 26
Validation rmse = 0.063135
Epoch 27
Loss = 3.1381e-02, PNorm = 34.3218, GNorm = 0.3249, lr_0 = 2.7520e-04
Validation rmse = 0.059870
Epoch 28
Validation rmse = 0.060718
Epoch 29
Loss = 3.1745e-02, PNorm = 34.3273, GNorm = 0.9892, lr_0 = 2.4674e-04
Validation rmse = 0.061908
Epoch 30
Validation rmse = 0.061599
Epoch 31
Loss = 3.3327e-02, PNorm = 34.3326, GNorm = 2.1198, lr_0 = 2.2122e-04
Loss = 1.7999e-02, PNorm = 34.3331, GNorm = 0.2330, lr_0 = 2.1904e-04
Validation rmse = 0.061433
Epoch 32
Validation rmse = 0.063666
Epoch 33
Validation rmse = 0.067015
Epoch 34
Loss = 3.7333e-02, PNorm = 34.3381, GNorm = 2.8734, lr_0 = 1.9638e-04
Validation rmse = 0.066077
Epoch 35
Validation rmse = 0.062587
Epoch 36
Loss = 3.0223e-02, PNorm = 34.3422, GNorm = 0.3897, lr_0 = 1.7607e-04
Validation rmse = 0.061885
Epoch 37
Validation rmse = 0.060292
Epoch 38
Loss = 3.2259e-02, PNorm = 34.3460, GNorm = 3.2700, lr_0 = 1.5786e-04
Validation rmse = 0.063414
Epoch 39
Validation rmse = 0.059746
Epoch 40
Loss = 3.1378e-02, PNorm = 34.3493, GNorm = 4.3604, lr_0 = 1.4153e-04
Loss = 4.0065e-02, PNorm = 34.3494, GNorm = 2.9035, lr_0 = 1.4014e-04
Validation rmse = 0.059792
Epoch 41
Validation rmse = 0.061515
Epoch 42
Validation rmse = 0.059930
Epoch 43
Loss = 3.5754e-02, PNorm = 34.3515, GNorm = 0.9850, lr_0 = 1.2564e-04
Validation rmse = 0.060594
Epoch 44
Validation rmse = 0.059933
Epoch 45
Loss = 2.8659e-02, PNorm = 34.3537, GNorm = 1.1473, lr_0 = 1.1265e-04
Validation rmse = 0.061199
Epoch 46
Validation rmse = 0.060129
Epoch 47
Loss = 2.8966e-02, PNorm = 34.3564, GNorm = 0.6941, lr_0 = 1.0000e-04
Validation rmse = 0.060069
Epoch 48
Validation rmse = 0.060756
Epoch 49
Loss = 2.6766e-02, PNorm = 34.3584, GNorm = 1.2738, lr_0 = 1.0000e-04
Validation rmse = 0.060315
Epoch 50
Validation rmse = 0.060235
Epoch 51
Validation rmse = 0.059994
Epoch 52
Loss = 2.4182e-02, PNorm = 34.3606, GNorm = 0.4217, lr_0 = 1.0000e-04
Validation rmse = 0.060753
Epoch 53
Validation rmse = 0.060204
Epoch 54
Loss = 2.5499e-02, PNorm = 34.3626, GNorm = 0.8269, lr_0 = 1.0000e-04
Validation rmse = 0.061103
Epoch 55
Validation rmse = 0.060385
Epoch 56
Loss = 2.7065e-02, PNorm = 34.3645, GNorm = 0.4677, lr_0 = 1.0000e-04
Loss = 1.9714e-02, PNorm = 34.3647, GNorm = 0.5410, lr_0 = 1.0000e-04
Validation rmse = 0.060657
Epoch 57
Validation rmse = 0.061454
Epoch 58
Validation rmse = 0.060155
Epoch 59
Loss = 2.4479e-02, PNorm = 34.3670, GNorm = 0.3348, lr_0 = 1.0000e-04
Validation rmse = 0.062014
Model 0 best validation rmse = 0.059746 on epoch 39
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.063546
Ensemble test rmse = 0.063546
1-fold cross validation
	Seed 0 ==> test rmse = 0.063546
Overall test rmse = 0.063546 +/- 0.000000
Elapsed time = 0:00:13
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 267 | train size = 212 | val size = 53 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.199868
Epoch 1
Validation rmse = 0.180707
Epoch 2
Loss = 4.2722e-01, PNorm = 34.0515, GNorm = 3.2602, lr_0 = 9.5159e-04
Validation rmse = 0.159872
Epoch 3
Validation rmse = 0.178026
Epoch 4
Loss = 2.8151e-01, PNorm = 34.1350, GNorm = 4.5149, lr_0 = 8.4474e-04
Validation rmse = 0.131143
Epoch 5
Validation rmse = 0.120112
Epoch 6
Validation rmse = 0.103224
Epoch 7
Loss = 1.5899e-01, PNorm = 34.1883, GNorm = 1.6437, lr_0 = 7.4989e-04
Validation rmse = 0.100646
Epoch 8
Validation rmse = 0.103746
Epoch 9
Loss = 9.6203e-02, PNorm = 34.2288, GNorm = 1.3035, lr_0 = 6.7234e-04
Validation rmse = 0.128722
Epoch 10
Validation rmse = 0.124793
Epoch 11
Loss = 1.0974e-01, PNorm = 34.2549, GNorm = 7.7262, lr_0 = 5.9685e-04
Loss = 4.0036e-02, PNorm = 34.2568, GNorm = 0.8942, lr_0 = 5.9095e-04
Validation rmse = 0.076898
Epoch 12
Validation rmse = 0.077577
Epoch 13
Validation rmse = 0.081030
Epoch 14
Loss = 5.5375e-02, PNorm = 34.2728, GNorm = 2.7232, lr_0 = 5.2983e-04
Validation rmse = 0.078070
Epoch 15
Validation rmse = 0.072071
Epoch 16
Loss = 5.2627e-02, PNorm = 34.2871, GNorm = 2.7394, lr_0 = 4.7034e-04
Validation rmse = 0.071333
Epoch 17
Validation rmse = 0.072866
Epoch 18
Loss = 4.9032e-02, PNorm = 34.2972, GNorm = 3.4893, lr_0 = 4.2170e-04
Loss = 5.9866e-02, PNorm = 34.2983, GNorm = 1.9341, lr_0 = 4.1753e-04
Validation rmse = 0.083066
Epoch 19
Validation rmse = 0.072717
Epoch 20
Validation rmse = 0.065910
Epoch 21
Loss = 4.3572e-02, PNorm = 34.3050, GNorm = 1.5044, lr_0 = 3.7435e-04
Validation rmse = 0.077207
Epoch 22
Validation rmse = 0.068804
Epoch 23
Loss = 4.2719e-02, PNorm = 34.3130, GNorm = 2.3299, lr_0 = 3.3232e-04
Validation rmse = 0.067729
Epoch 24
Validation rmse = 0.061537
Epoch 25
Loss = 3.5131e-02, PNorm = 34.3199, GNorm = 1.4805, lr_0 = 2.9795e-04
Loss = 4.5712e-02, PNorm = 34.3205, GNorm = 3.6890, lr_0 = 2.9500e-04
Validation rmse = 0.068384
Epoch 26
Validation rmse = 0.062386
Epoch 27
Validation rmse = 0.066471
Epoch 28
Loss = 3.4406e-02, PNorm = 34.3265, GNorm = 1.7827, lr_0 = 2.6188e-04
Validation rmse = 0.062161
Epoch 29
Validation rmse = 0.061263
Epoch 30
Loss = 3.3115e-02, PNorm = 34.3303, GNorm = 0.3553, lr_0 = 2.3480e-04
Validation rmse = 0.065510
Epoch 31
Validation rmse = 0.061138
Epoch 32
Validation rmse = 0.064412
Epoch 33
Loss = 3.4283e-02, PNorm = 34.3348, GNorm = 1.4423, lr_0 = 2.0637e-04
Validation rmse = 0.063749
Epoch 34
Validation rmse = 0.067671
Epoch 35
Loss = 3.3414e-02, PNorm = 34.3388, GNorm = 0.7740, lr_0 = 1.8503e-04
Validation rmse = 0.060555
Epoch 36
Validation rmse = 0.063740
Epoch 37
Loss = 2.8281e-02, PNorm = 34.3422, GNorm = 0.6843, lr_0 = 1.6425e-04
Validation rmse = 0.063689
Epoch 38
Validation rmse = 0.063843
Epoch 39
Validation rmse = 0.059800
Epoch 40
Loss = 2.6282e-02, PNorm = 34.3450, GNorm = 0.8824, lr_0 = 1.4581e-04
Validation rmse = 0.063386
Epoch 41
Validation rmse = 0.060549
Epoch 42
Loss = 2.9292e-02, PNorm = 34.3474, GNorm = 0.8047, lr_0 = 1.3073e-04
Validation rmse = 0.062185
Epoch 43
Validation rmse = 0.061679
Epoch 44
Loss = 2.7236e-02, PNorm = 34.3495, GNorm = 0.6602, lr_0 = 1.1605e-04
Loss = 2.3347e-02, PNorm = 34.3498, GNorm = 1.1630, lr_0 = 1.1491e-04
Validation rmse = 0.063496
Epoch 45
Validation rmse = 0.059892
Epoch 46
Validation rmse = 0.059980
Epoch 47
Loss = 2.8975e-02, PNorm = 34.3520, GNorm = 1.2734, lr_0 = 1.0302e-04
Validation rmse = 0.062809
Epoch 48
Validation rmse = 0.062211
Epoch 49
Loss = 2.8671e-02, PNorm = 34.3542, GNorm = 1.0459, lr_0 = 1.0000e-04
Validation rmse = 0.060459
Epoch 50
Validation rmse = 0.060114
Epoch 51
Loss = 2.5794e-02, PNorm = 34.3561, GNorm = 1.0381, lr_0 = 1.0000e-04
Loss = 3.0369e-02, PNorm = 34.3563, GNorm = 0.4848, lr_0 = 1.0000e-04
Validation rmse = 0.061273
Epoch 52
Validation rmse = 0.059999
Epoch 53
Validation rmse = 0.058910
Epoch 54
Loss = 2.7188e-02, PNorm = 34.3584, GNorm = 2.2370, lr_0 = 1.0000e-04
Validation rmse = 0.058679
Epoch 55
Validation rmse = 0.060135
Epoch 56
Loss = 2.5101e-02, PNorm = 34.3604, GNorm = 1.8531, lr_0 = 1.0000e-04
Validation rmse = 0.062125
Epoch 57
Validation rmse = 0.059308
Epoch 58
Loss = 2.5260e-02, PNorm = 34.3629, GNorm = 1.3131, lr_0 = 1.0000e-04
Validation rmse = 0.059401
Epoch 59
Validation rmse = 0.060060
Model 0 best validation rmse = 0.058679 on epoch 54
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.018520
Ensemble test rmse = 0.018520
1-fold cross validation
	Seed 0 ==> test rmse = 0.018520
Overall test rmse = 0.018520 +/- 0.000000
Elapsed time = 0:00:13
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 417 | train size = 331 | val size = 83 | test size = 3
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.225177
Epoch 1
Loss = 7.1283e-01, PNorm = 34.0323, GNorm = 3.9569, lr_0 = 1.0000e-03
Validation rmse = 0.193593
Epoch 2
Validation rmse = 0.192768
Epoch 3
Loss = 3.8887e-01, PNorm = 34.0926, GNorm = 1.9872, lr_0 = 9.2980e-04
Validation rmse = 0.187461
Epoch 4
Loss = 4.8661e-01, PNorm = 34.1406, GNorm = 5.4611, lr_0 = 8.7027e-04
Validation rmse = 0.192239
Epoch 5
Validation rmse = 0.191339
Epoch 6
Loss = 7.4824e-01, PNorm = 34.1780, GNorm = 8.4861, lr_0 = 8.0918e-04
Validation rmse = 0.185403
Epoch 7
Loss = 4.8710e-01, PNorm = 34.2092, GNorm = 2.7290, lr_0 = 7.5737e-04
Validation rmse = 0.172754
Epoch 8
Validation rmse = 0.177636
Epoch 9
Loss = 3.8301e-01, PNorm = 34.2431, GNorm = 1.8504, lr_0 = 7.0421e-04
Validation rmse = 0.177635
Epoch 10
Loss = 4.2717e-01, PNorm = 34.2737, GNorm = 2.8508, lr_0 = 6.5912e-04
Validation rmse = 0.178377
Epoch 11
Validation rmse = 0.171080
Epoch 12
Loss = 2.8151e-01, PNorm = 34.3044, GNorm = 1.5062, lr_0 = 6.1285e-04
Validation rmse = 0.173208
Epoch 13
Loss = 3.8685e-01, PNorm = 34.3307, GNorm = 4.0291, lr_0 = 5.7362e-04
Validation rmse = 0.173307
Epoch 14
Validation rmse = 0.172309
Epoch 15
Loss = 2.4268e-01, PNorm = 34.3568, GNorm = 3.8970, lr_0 = 5.3335e-04
Validation rmse = 0.183732
Epoch 16
Loss = 3.5828e-01, PNorm = 34.3832, GNorm = 5.8567, lr_0 = 4.9591e-04
Validation rmse = 0.182425
Epoch 17
Validation rmse = 0.172731
Epoch 18
Loss = 2.8907e-01, PNorm = 34.4056, GNorm = 1.2291, lr_0 = 4.6416e-04
Validation rmse = 0.173263
Epoch 19
Loss = 2.8509e-01, PNorm = 34.4283, GNorm = 1.0488, lr_0 = 4.3158e-04
Validation rmse = 0.186402
Epoch 20
Validation rmse = 0.174684
Epoch 21
Loss = 3.4675e-01, PNorm = 34.4482, GNorm = 1.8775, lr_0 = 4.0394e-04
Validation rmse = 0.173749
Epoch 22
Loss = 2.8710e-01, PNorm = 34.4706, GNorm = 1.0385, lr_0 = 3.7559e-04
Validation rmse = 0.180596
Epoch 23
Validation rmse = 0.174747
Epoch 24
Loss = 2.6825e-01, PNorm = 34.4906, GNorm = 0.7969, lr_0 = 3.4922e-04
Validation rmse = 0.174600
Epoch 25
Loss = 3.0747e-01, PNorm = 34.5086, GNorm = 1.2814, lr_0 = 3.2686e-04
Validation rmse = 0.181540
Epoch 26
Validation rmse = 0.179240
Epoch 27
Loss = 2.7165e-01, PNorm = 34.5280, GNorm = 3.1854, lr_0 = 3.0392e-04
Validation rmse = 0.191394
Epoch 28
Loss = 2.9462e-01, PNorm = 34.5441, GNorm = 2.2559, lr_0 = 2.8446e-04
Validation rmse = 0.176639
Epoch 29
Validation rmse = 0.176292
Epoch 30
Loss = 3.1709e-01, PNorm = 34.5611, GNorm = 2.7013, lr_0 = 2.6449e-04
Validation rmse = 0.188151
Epoch 31
Loss = 2.8294e-01, PNorm = 34.5751, GNorm = 1.6134, lr_0 = 2.4756e-04
Validation rmse = 0.177376
Epoch 32
Validation rmse = 0.186852
Epoch 33
Loss = 2.7780e-01, PNorm = 34.5911, GNorm = 2.7439, lr_0 = 2.3018e-04
Validation rmse = 0.180946
Epoch 34
Loss = 3.0851e-01, PNorm = 34.6044, GNorm = 5.9806, lr_0 = 2.1544e-04
Validation rmse = 0.178049
Epoch 35
Validation rmse = 0.189539
Epoch 36
Loss = 3.0238e-01, PNorm = 34.6175, GNorm = 1.1493, lr_0 = 2.0032e-04
Validation rmse = 0.177037
Epoch 37
Loss = 2.6604e-01, PNorm = 34.6299, GNorm = 3.2256, lr_0 = 1.8626e-04
Validation rmse = 0.185222
Epoch 38
Validation rmse = 0.180663
Epoch 39
Loss = 2.1949e-01, PNorm = 34.6420, GNorm = 1.6955, lr_0 = 1.7433e-04
Validation rmse = 0.184433
Epoch 40
Loss = 2.6945e-01, PNorm = 34.6531, GNorm = 1.9612, lr_0 = 1.6210e-04
Validation rmse = 0.179190
Epoch 41
Validation rmse = 0.188409
Epoch 42
Loss = 3.0139e-01, PNorm = 34.6622, GNorm = 1.3525, lr_0 = 1.5172e-04
Validation rmse = 0.179194
Epoch 43
Loss = 2.4660e-01, PNorm = 34.6719, GNorm = 3.0021, lr_0 = 1.4107e-04
Validation rmse = 0.186042
Epoch 44
Validation rmse = 0.179235
Epoch 45
Loss = 2.5663e-01, PNorm = 34.6817, GNorm = 2.2524, lr_0 = 1.3116e-04
Validation rmse = 0.183598
Epoch 46
Loss = 2.5432e-01, PNorm = 34.6900, GNorm = 3.5552, lr_0 = 1.2277e-04
Validation rmse = 0.180154
Epoch 47
Validation rmse = 0.180318
Epoch 48
Loss = 2.6741e-01, PNorm = 34.6983, GNorm = 4.8823, lr_0 = 1.1415e-04
Validation rmse = 0.183068
Epoch 49
Loss = 2.6648e-01, PNorm = 34.7048, GNorm = 0.6689, lr_0 = 1.0684e-04
Validation rmse = 0.179726
Epoch 50
Validation rmse = 0.182982
Epoch 51
Loss = 1.9143e-01, PNorm = 34.7124, GNorm = 2.4149, lr_0 = 1.0000e-04
Validation rmse = 0.181917
Epoch 52
Loss = 2.4918e-01, PNorm = 34.7192, GNorm = 0.8569, lr_0 = 1.0000e-04
Loss = 1.9436e-01, PNorm = 34.7198, GNorm = 2.3419, lr_0 = 1.0000e-04
Validation rmse = 0.181400
Epoch 53
Validation rmse = 0.183614
Epoch 54
Loss = 1.8825e-01, PNorm = 34.7264, GNorm = 3.5961, lr_0 = 1.0000e-04
Validation rmse = 0.182403
Epoch 55
Loss = 2.4862e-01, PNorm = 34.7332, GNorm = 3.8186, lr_0 = 1.0000e-04
Loss = 1.8639e-01, PNorm = 34.7338, GNorm = 3.4522, lr_0 = 1.0000e-04
Validation rmse = 0.182232
Epoch 56
Validation rmse = 0.183837
Epoch 57
Loss = 2.0787e-01, PNorm = 34.7402, GNorm = 1.6872, lr_0 = 1.0000e-04
Validation rmse = 0.182350
Epoch 58
Loss = 2.4075e-01, PNorm = 34.7477, GNorm = 3.2774, lr_0 = 1.0000e-04
Validation rmse = 0.183161
Epoch 59
Validation rmse = 0.182307
Model 0 best validation rmse = 0.171080 on epoch 11
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.367400
Ensemble test rmse = 0.367400
1-fold cross validation
	Seed 0 ==> test rmse = 0.367400
Overall test rmse = 0.367400 +/- 0.000000
Elapsed time = 0:00:15
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 407 | train size = 323 | val size = 81 | test size = 3
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.242684
Epoch 1
Loss = 6.6469e-01, PNorm = 34.0339, GNorm = 3.9031, lr_0 = 1.0000e-03
Validation rmse = 0.203567
Epoch 2
Validation rmse = 0.230344
Epoch 3
Loss = 6.9036e-01, PNorm = 34.0929, GNorm = 11.3727, lr_0 = 9.2980e-04
Validation rmse = 0.210687
Epoch 4
Loss = 5.0626e-01, PNorm = 34.1330, GNorm = 5.4708, lr_0 = 8.6453e-04
Validation rmse = 0.183910
Epoch 5
Validation rmse = 0.176431
Epoch 6
Loss = 4.3724e-01, PNorm = 34.1716, GNorm = 6.1652, lr_0 = 8.0385e-04
Validation rmse = 0.186783
Epoch 7
Loss = 4.4747e-01, PNorm = 34.2026, GNorm = 8.7279, lr_0 = 7.5238e-04
Validation rmse = 0.167396
Epoch 8
Validation rmse = 0.165153
Epoch 9
Loss = 3.6435e-01, PNorm = 34.2304, GNorm = 0.9605, lr_0 = 6.9956e-04
Validation rmse = 0.162942
Epoch 10
Loss = 3.3152e-01, PNorm = 34.2630, GNorm = 0.6989, lr_0 = 6.5046e-04
Validation rmse = 0.161463
Epoch 11
Validation rmse = 0.169204
Epoch 12
Loss = 2.9965e-01, PNorm = 34.2914, GNorm = 6.6390, lr_0 = 6.0480e-04
Validation rmse = 0.164441
Epoch 13
Loss = 3.0916e-01, PNorm = 34.3170, GNorm = 3.0530, lr_0 = 5.6234e-04
Validation rmse = 0.161983
Epoch 14
Validation rmse = 0.164416
Epoch 15
Loss = 3.1006e-01, PNorm = 34.3438, GNorm = 2.4782, lr_0 = 5.2287e-04
Validation rmse = 0.168293
Epoch 16
Validation rmse = 0.182672
Epoch 17
Loss = 4.0266e-01, PNorm = 34.3647, GNorm = 5.1075, lr_0 = 4.8616e-04
Validation rmse = 0.159411
Epoch 18
Loss = 2.7492e-01, PNorm = 34.3839, GNorm = 0.6526, lr_0 = 4.5504e-04
Validation rmse = 0.156200
Epoch 19
Validation rmse = 0.157559
Epoch 20
Loss = 2.5806e-01, PNorm = 34.4047, GNorm = 1.5326, lr_0 = 4.2309e-04
Validation rmse = 0.168094
Epoch 21
Loss = 2.5830e-01, PNorm = 34.4233, GNorm = 1.0820, lr_0 = 3.9339e-04
Validation rmse = 0.161594
Epoch 22
Validation rmse = 0.160624
Epoch 23
Loss = 2.7600e-01, PNorm = 34.4406, GNorm = 1.3149, lr_0 = 3.6578e-04
Validation rmse = 0.161029
Epoch 24
Loss = 2.8099e-01, PNorm = 34.4553, GNorm = 1.8743, lr_0 = 3.4236e-04
Validation rmse = 0.173873
Epoch 25
Validation rmse = 0.157033
Epoch 26
Loss = 2.5605e-01, PNorm = 34.4731, GNorm = 2.7981, lr_0 = 3.1623e-04
Validation rmse = 0.155925
Epoch 27
Loss = 2.6863e-01, PNorm = 34.4861, GNorm = 2.5047, lr_0 = 2.9598e-04
Loss = 2.1857e-01, PNorm = 34.4875, GNorm = 2.0311, lr_0 = 2.9403e-04
Validation rmse = 0.168599
Epoch 28
Validation rmse = 0.156969
Epoch 29
Loss = 2.7908e-01, PNorm = 34.5011, GNorm = 2.0719, lr_0 = 2.7520e-04
Validation rmse = 0.160614
Epoch 30
Loss = 2.6796e-01, PNorm = 34.5132, GNorm = 1.8696, lr_0 = 2.5589e-04
Validation rmse = 0.185052
Epoch 31
Validation rmse = 0.158237
Epoch 32
Loss = 2.5088e-01, PNorm = 34.5253, GNorm = 3.1194, lr_0 = 2.3792e-04
Validation rmse = 0.157072
Epoch 33
Validation rmse = 0.169318
Epoch 34
Loss = 2.6026e-01, PNorm = 34.5373, GNorm = 3.3679, lr_0 = 2.2122e-04
Validation rmse = 0.158355
Epoch 35
Loss = 2.9413e-01, PNorm = 34.5488, GNorm = 4.4323, lr_0 = 2.0706e-04
Validation rmse = 0.176063
Epoch 36
Validation rmse = 0.158400
Epoch 37
Loss = 2.5622e-01, PNorm = 34.5588, GNorm = 0.9856, lr_0 = 1.9252e-04
Validation rmse = 0.168399
Epoch 38
Loss = 2.5056e-01, PNorm = 34.5693, GNorm = 4.2242, lr_0 = 1.7901e-04
Validation rmse = 0.158912
Epoch 39
Validation rmse = 0.165554
Epoch 40
Loss = 2.4477e-01, PNorm = 34.5783, GNorm = 1.3121, lr_0 = 1.6644e-04
Validation rmse = 0.160428
Epoch 41
Loss = 2.2639e-01, PNorm = 34.5879, GNorm = 2.2172, lr_0 = 1.5476e-04
Validation rmse = 0.165261
Epoch 42
Validation rmse = 0.160831
Epoch 43
Loss = 2.7336e-01, PNorm = 34.5966, GNorm = 4.9169, lr_0 = 1.4390e-04
Validation rmse = 0.168617
Epoch 44
Loss = 2.3013e-01, PNorm = 34.6038, GNorm = 3.9109, lr_0 = 1.3468e-04
Loss = 2.7137e-01, PNorm = 34.6046, GNorm = 5.5321, lr_0 = 1.3379e-04
Validation rmse = 0.160277
Epoch 45
Validation rmse = 0.165512
Epoch 46
Loss = 2.2611e-01, PNorm = 34.6124, GNorm = 2.8120, lr_0 = 1.2523e-04
Validation rmse = 0.162271
Epoch 47
Loss = 2.2459e-01, PNorm = 34.6198, GNorm = 3.8759, lr_0 = 1.1644e-04
Validation rmse = 0.161244
Epoch 48
Validation rmse = 0.164740
Epoch 49
Loss = 2.2800e-01, PNorm = 34.6271, GNorm = 1.3112, lr_0 = 1.0826e-04
Validation rmse = 0.161624
Epoch 50
Validation rmse = 0.163923
Epoch 51
Loss = 2.8384e-01, PNorm = 34.6338, GNorm = 4.2173, lr_0 = 1.0066e-04
Validation rmse = 0.163309
Epoch 52
Loss = 2.1505e-01, PNorm = 34.6398, GNorm = 1.0082, lr_0 = 1.0000e-04
Validation rmse = 0.160959
Epoch 53
Validation rmse = 0.163673
Epoch 54
Loss = 2.6421e-01, PNorm = 34.6466, GNorm = 3.6927, lr_0 = 1.0000e-04
Validation rmse = 0.162698
Epoch 55
Loss = 2.0646e-01, PNorm = 34.6525, GNorm = 1.7462, lr_0 = 1.0000e-04
Validation rmse = 0.165540
Epoch 56
Validation rmse = 0.161195
Epoch 57
Loss = 2.5018e-01, PNorm = 34.6592, GNorm = 4.5071, lr_0 = 1.0000e-04
Validation rmse = 0.163038
Epoch 58
Loss = 2.1649e-01, PNorm = 34.6663, GNorm = 2.4473, lr_0 = 1.0000e-04
Validation rmse = 0.165680
Epoch 59
Validation rmse = 0.163538
Model 0 best validation rmse = 0.155925 on epoch 26
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.078939
Ensemble test rmse = 0.078939
1-fold cross validation
	Seed 0 ==> test rmse = 0.078939
Overall test rmse = 0.078939 +/- 0.000000
Elapsed time = 0:00:14
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 397 | train size = 315 | val size = 80 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.257179
Epoch 1
Loss = 8.5573e-01, PNorm = 34.0302, GNorm = 4.1737, lr_0 = 1.0000e-03
Validation rmse = 0.220963
Epoch 2
Validation rmse = 0.202986
Epoch 3
Loss = 5.0536e-01, PNorm = 34.0959, GNorm = 1.2677, lr_0 = 9.2367e-04
Validation rmse = 0.165287
Epoch 4
Loss = 3.9389e-01, PNorm = 34.1504, GNorm = 1.1997, lr_0 = 8.6453e-04
Validation rmse = 0.151818
Epoch 5
Validation rmse = 0.181127
Epoch 6
Loss = 5.2296e-01, PNorm = 34.2010, GNorm = 10.1039, lr_0 = 7.9854e-04
Validation rmse = 0.167363
Epoch 7
Loss = 3.6936e-01, PNorm = 34.2321, GNorm = 1.3512, lr_0 = 7.4742e-04
Loss = 3.3529e-01, PNorm = 34.2355, GNorm = 3.2427, lr_0 = 7.4249e-04
Validation rmse = 0.156465
Epoch 8
Validation rmse = 0.167436
Epoch 9
Loss = 4.0614e-01, PNorm = 34.2656, GNorm = 2.7125, lr_0 = 6.9037e-04
Validation rmse = 0.152148
Epoch 10
Validation rmse = 0.169667
Epoch 11
Loss = 3.8066e-01, PNorm = 34.2950, GNorm = 5.8778, lr_0 = 6.4191e-04
Validation rmse = 0.156422
Epoch 12
Loss = 2.9567e-01, PNorm = 34.3236, GNorm = 2.7052, lr_0 = 5.9685e-04
Validation rmse = 0.148773
Epoch 13
Validation rmse = 0.142840
Epoch 14
Loss = 2.5056e-01, PNorm = 34.3489, GNorm = 1.8527, lr_0 = 5.5495e-04
Validation rmse = 0.143275
Epoch 15
Loss = 2.5844e-01, PNorm = 34.3722, GNorm = 1.5340, lr_0 = 5.1599e-04
Loss = 1.4368e-01, PNorm = 34.3746, GNorm = 2.1628, lr_0 = 5.1259e-04
Validation rmse = 0.142718
Epoch 16
Validation rmse = 0.143609
Epoch 17
Loss = 2.4062e-01, PNorm = 34.3949, GNorm = 1.0954, lr_0 = 4.7977e-04
Validation rmse = 0.144988
Epoch 18
Validation rmse = 0.143471
Epoch 19
Loss = 1.9127e-01, PNorm = 34.4170, GNorm = 0.7536, lr_0 = 4.4315e-04
Validation rmse = 0.140421
Epoch 20
Loss = 2.4534e-01, PNorm = 34.4357, GNorm = 1.2004, lr_0 = 4.1478e-04
Validation rmse = 0.138017
Epoch 21
Validation rmse = 0.142127
Epoch 22
Loss = 1.9485e-01, PNorm = 34.4556, GNorm = 1.3095, lr_0 = 3.8312e-04
Validation rmse = 0.147369
Epoch 23
Loss = 2.2997e-01, PNorm = 34.4718, GNorm = 0.7329, lr_0 = 3.5622e-04
Validation rmse = 0.139786
Epoch 24
Validation rmse = 0.142749
Epoch 25
Loss = 2.0622e-01, PNorm = 34.4892, GNorm = 1.3128, lr_0 = 3.3122e-04
Validation rmse = 0.140036
Epoch 26
Loss = 2.1511e-01, PNorm = 34.5052, GNorm = 1.9771, lr_0 = 3.0797e-04
Validation rmse = 0.140337
Epoch 27
Validation rmse = 0.139025
Epoch 28
Loss = 2.3325e-01, PNorm = 34.5198, GNorm = 1.7546, lr_0 = 2.8635e-04
Validation rmse = 0.139913
Epoch 29
Validation rmse = 0.140544
Epoch 30
Loss = 1.8379e-01, PNorm = 34.5332, GNorm = 1.6059, lr_0 = 2.6625e-04
Validation rmse = 0.143134
Epoch 31
Loss = 1.9138e-01, PNorm = 34.5465, GNorm = 2.1445, lr_0 = 2.4756e-04
Validation rmse = 0.140339
Epoch 32
Validation rmse = 0.145552
Epoch 33
Loss = 2.4132e-01, PNorm = 34.5618, GNorm = 1.2785, lr_0 = 2.2866e-04
Validation rmse = 0.138900
Epoch 34
Loss = 2.0958e-01, PNorm = 34.5735, GNorm = 1.5251, lr_0 = 2.1402e-04
Loss = 6.5877e-02, PNorm = 34.5746, GNorm = 3.8170, lr_0 = 2.1261e-04
Validation rmse = 0.147104
Epoch 35
Validation rmse = 0.141969
Epoch 36
Loss = 1.9600e-01, PNorm = 34.5857, GNorm = 4.7727, lr_0 = 1.9769e-04
Validation rmse = 0.144494
Epoch 37
Validation rmse = 0.146372
Epoch 38
Loss = 1.9422e-01, PNorm = 34.5949, GNorm = 3.9853, lr_0 = 1.8381e-04
Validation rmse = 0.146571
Epoch 39
Loss = 1.9404e-01, PNorm = 34.6045, GNorm = 1.5369, lr_0 = 1.7091e-04
Validation rmse = 0.142210
Epoch 40
Validation rmse = 0.141649
Epoch 41
Loss = 1.9728e-01, PNorm = 34.6144, GNorm = 1.2580, lr_0 = 1.5891e-04
Validation rmse = 0.139178
Epoch 42
Loss = 1.8172e-01, PNorm = 34.6235, GNorm = 1.8518, lr_0 = 1.4775e-04
Loss = 1.7784e-01, PNorm = 34.6243, GNorm = 5.0791, lr_0 = 1.4678e-04
Validation rmse = 0.141225
Epoch 43
Validation rmse = 0.140411
Epoch 44
Loss = 1.9501e-01, PNorm = 34.6319, GNorm = 1.2598, lr_0 = 1.3738e-04
Validation rmse = 0.140373
Epoch 45
Validation rmse = 0.140008
Epoch 46
Loss = 1.7775e-01, PNorm = 34.6402, GNorm = 0.7960, lr_0 = 1.2690e-04
Validation rmse = 0.139505
Epoch 47
Loss = 1.6529e-01, PNorm = 34.6473, GNorm = 4.6488, lr_0 = 1.1877e-04
Validation rmse = 0.139674
Epoch 48
Validation rmse = 0.140098
Epoch 49
Loss = 1.3457e-01, PNorm = 34.6540, GNorm = 2.5666, lr_0 = 1.0971e-04
Validation rmse = 0.138394
Epoch 50
Loss = 1.6965e-01, PNorm = 34.6596, GNorm = 0.5429, lr_0 = 1.0268e-04
Validation rmse = 0.139685
Epoch 51
Validation rmse = 0.140167
Epoch 52
Loss = 1.6332e-01, PNorm = 34.6663, GNorm = 2.0509, lr_0 = 1.0000e-04
Validation rmse = 0.139834
Epoch 53
Loss = 1.6168e-01, PNorm = 34.6722, GNorm = 1.5825, lr_0 = 1.0000e-04
Validation rmse = 0.139782
Epoch 54
Validation rmse = 0.139185
Epoch 55
Loss = 1.6337e-01, PNorm = 34.6775, GNorm = 2.2261, lr_0 = 1.0000e-04
Validation rmse = 0.138172
Epoch 56
Validation rmse = 0.138564
Epoch 57
Loss = 1.6352e-01, PNorm = 34.6828, GNorm = 0.9925, lr_0 = 1.0000e-04
Validation rmse = 0.139400
Epoch 58
Loss = 1.7582e-01, PNorm = 34.6882, GNorm = 2.7570, lr_0 = 1.0000e-04
Validation rmse = 0.139446
Epoch 59
Validation rmse = 0.138914
Model 0 best validation rmse = 0.138017 on epoch 20
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.045089
Ensemble test rmse = 0.045089
1-fold cross validation
	Seed 0 ==> test rmse = 0.045089
Overall test rmse = 0.045089 +/- 0.000000
Elapsed time = 0:00:15
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 387 | train size = 307 | val size = 78 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.241637
Epoch 1
Loss = 6.7466e-01, PNorm = 34.0292, GNorm = 2.2919, lr_0 = 1.0000e-03
Validation rmse = 0.282923
Epoch 2
Validation rmse = 0.234581
Epoch 3
Loss = 6.3121e-01, PNorm = 34.0827, GNorm = 9.1626, lr_0 = 9.2367e-04
Validation rmse = 0.224717
Epoch 4
Loss = 4.5733e-01, PNorm = 34.1330, GNorm = 4.1682, lr_0 = 8.5883e-04
Loss = 3.6657e-01, PNorm = 34.1376, GNorm = 7.3945, lr_0 = 8.5317e-04
Validation rmse = 0.185611
Epoch 5
Validation rmse = 0.221031
Epoch 6
Loss = 4.9936e-01, PNorm = 34.1834, GNorm = 3.8636, lr_0 = 7.9328e-04
Validation rmse = 0.171485
Epoch 7
Validation rmse = 0.177322
Epoch 8
Loss = 3.0617e-01, PNorm = 34.2189, GNorm = 3.6779, lr_0 = 7.3759e-04
Validation rmse = 0.174870
Epoch 9
Loss = 2.9889e-01, PNorm = 34.2521, GNorm = 4.9193, lr_0 = 6.8581e-04
Validation rmse = 0.160057
Epoch 10
Validation rmse = 0.179598
Epoch 11
Loss = 3.3889e-01, PNorm = 34.2850, GNorm = 3.2062, lr_0 = 6.3347e-04
Validation rmse = 0.151728
Epoch 12
Validation rmse = 0.166792
Epoch 13
Loss = 1.2472e-01, PNorm = 34.3155, GNorm = 1.6278, lr_0 = 5.8512e-04
Validation rmse = 0.153986
Epoch 14
Loss = 2.5635e-01, PNorm = 34.3410, GNorm = 5.1079, lr_0 = 5.4404e-04
Validation rmse = 0.149382
Epoch 15
Validation rmse = 0.151655
Epoch 16
Loss = 2.0768e-01, PNorm = 34.3637, GNorm = 0.5925, lr_0 = 5.0585e-04
Validation rmse = 0.153473
Epoch 17
Loss = 2.4562e-01, PNorm = 34.3818, GNorm = 1.1421, lr_0 = 4.7034e-04
Loss = 2.0316e-01, PNorm = 34.3833, GNorm = 3.4558, lr_0 = 4.6724e-04
Validation rmse = 0.151063
Epoch 18
Validation rmse = 0.148622
Epoch 19
Loss = 2.1655e-01, PNorm = 34.4037, GNorm = 2.4934, lr_0 = 4.3444e-04
Validation rmse = 0.144906
Epoch 20
Validation rmse = 0.146999
Epoch 21
Loss = 2.0279e-01, PNorm = 34.4236, GNorm = 1.9656, lr_0 = 4.0128e-04
Validation rmse = 0.142923
Epoch 22
Loss = 1.9916e-01, PNorm = 34.4403, GNorm = 0.7261, lr_0 = 3.7559e-04
Validation rmse = 0.143347
Epoch 23
Validation rmse = 0.145299
Epoch 24
Loss = 2.2604e-01, PNorm = 34.4593, GNorm = 2.2420, lr_0 = 3.4692e-04
Validation rmse = 0.159958
Epoch 25
Validation rmse = 0.144350
Epoch 26
Loss = 2.4659e-01, PNorm = 34.4755, GNorm = 1.4998, lr_0 = 3.2044e-04
Validation rmse = 0.145635
Epoch 27
Loss = 1.8282e-01, PNorm = 34.4892, GNorm = 4.0272, lr_0 = 2.9795e-04
Validation rmse = 0.147030
Epoch 28
Validation rmse = 0.140086
Epoch 29
Loss = 2.0972e-01, PNorm = 34.5010, GNorm = 4.1393, lr_0 = 2.7703e-04
Validation rmse = 0.147907
Epoch 30
Loss = 1.9125e-01, PNorm = 34.5129, GNorm = 1.1211, lr_0 = 2.5758e-04
Loss = 1.2064e-01, PNorm = 34.5141, GNorm = 1.3307, lr_0 = 2.5589e-04
Validation rmse = 0.138204
Epoch 31
Validation rmse = 0.139870
Epoch 32
Loss = 1.8260e-01, PNorm = 34.5260, GNorm = 0.4415, lr_0 = 2.3792e-04
Validation rmse = 0.139339
Epoch 33
Validation rmse = 0.138161
Epoch 34
Loss = 1.6840e-01, PNorm = 34.5396, GNorm = 2.4975, lr_0 = 2.1976e-04
Validation rmse = 0.142411
Epoch 35
Loss = 1.7713e-01, PNorm = 34.5492, GNorm = 1.2828, lr_0 = 2.0434e-04
Validation rmse = 0.136941
Epoch 36
Validation rmse = 0.139964
Epoch 37
Loss = 1.7252e-01, PNorm = 34.5576, GNorm = 0.7103, lr_0 = 1.8999e-04
Validation rmse = 0.136959
Epoch 38
Validation rmse = 0.135823
Epoch 39
Loss = 1.5450e-01, PNorm = 34.5677, GNorm = 2.1347, lr_0 = 1.7549e-04
Validation rmse = 0.136982
Epoch 40
Loss = 1.6908e-01, PNorm = 34.5747, GNorm = 1.5608, lr_0 = 1.6317e-04
Validation rmse = 0.135318
Epoch 41
Validation rmse = 0.138999
Epoch 42
Loss = 1.4924e-01, PNorm = 34.5830, GNorm = 1.6051, lr_0 = 1.5072e-04
Validation rmse = 0.135450
Epoch 43
Loss = 1.5695e-01, PNorm = 34.5889, GNorm = 1.0419, lr_0 = 1.4107e-04
Loss = 1.8423e-01, PNorm = 34.5893, GNorm = 3.0089, lr_0 = 1.4014e-04
Validation rmse = 0.140799
Epoch 44
Validation rmse = 0.140379
Epoch 45
Loss = 1.6673e-01, PNorm = 34.5949, GNorm = 1.0200, lr_0 = 1.3030e-04
Validation rmse = 0.137871
Epoch 46
Validation rmse = 0.136207
Epoch 47
Loss = 1.4812e-01, PNorm = 34.6011, GNorm = 2.2287, lr_0 = 1.2035e-04
Validation rmse = 0.140780
Epoch 48
Loss = 1.7995e-01, PNorm = 34.6059, GNorm = 1.3538, lr_0 = 1.1191e-04
Loss = 1.7358e-01, PNorm = 34.6063, GNorm = 7.1944, lr_0 = 1.1117e-04
Validation rmse = 0.141062
Epoch 49
Validation rmse = 0.136511
Epoch 50
Loss = 1.4117e-01, PNorm = 34.6109, GNorm = 0.7811, lr_0 = 1.0405e-04
Validation rmse = 0.135926
Epoch 51
Validation rmse = 0.137103
Epoch 52
Loss = 1.8941e-01, PNorm = 34.6160, GNorm = 1.0808, lr_0 = 1.0000e-04
Validation rmse = 0.137575
Epoch 53
Loss = 1.5696e-01, PNorm = 34.6206, GNorm = 2.2355, lr_0 = 1.0000e-04
Validation rmse = 0.137442
Epoch 54
Validation rmse = 0.135754
Epoch 55
Loss = 1.5052e-01, PNorm = 34.6258, GNorm = 2.0572, lr_0 = 1.0000e-04
Validation rmse = 0.136859
Epoch 56
Validation rmse = 0.137108
Epoch 57
Loss = 1.7011e-01, PNorm = 34.6313, GNorm = 1.9082, lr_0 = 1.0000e-04
Validation rmse = 0.137980
Epoch 58
Loss = 1.6484e-01, PNorm = 34.6355, GNorm = 1.6987, lr_0 = 1.0000e-04
Validation rmse = 0.135891
Epoch 59
Validation rmse = 0.139736
Model 0 best validation rmse = 0.135318 on epoch 40
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.094304
Ensemble test rmse = 0.094304
1-fold cross validation
	Seed 0 ==> test rmse = 0.094304
Overall test rmse = 0.094304 +/- 0.000000
Elapsed time = 0:00:16
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 377 | train size = 299 | val size = 76 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.209023
Epoch 1
Loss = 6.3632e-01, PNorm = 34.0408, GNorm = 1.2844, lr_0 = 9.8425e-04
Validation rmse = 0.172009
Epoch 2
Validation rmse = 0.147912
Epoch 3
Loss = 3.9015e-01, PNorm = 34.1103, GNorm = 1.1143, lr_0 = 9.0912e-04
Validation rmse = 0.144141
Epoch 4
Validation rmse = 0.167037
Epoch 5
Loss = 4.4972e-01, PNorm = 34.1500, GNorm = 10.6774, lr_0 = 8.3973e-04
Validation rmse = 0.139737
Epoch 6
Loss = 3.1687e-01, PNorm = 34.1832, GNorm = 7.8178, lr_0 = 7.7563e-04
Validation rmse = 0.143085
Epoch 7
Validation rmse = 0.165254
Epoch 8
Loss = 2.7250e-01, PNorm = 34.2109, GNorm = 2.2275, lr_0 = 7.1643e-04
Validation rmse = 0.144931
Epoch 9
Validation rmse = 0.145443
Epoch 10
Loss = 3.4077e-01, PNorm = 34.2374, GNorm = 7.0627, lr_0 = 6.6174e-04
Validation rmse = 0.133219
Epoch 11
Loss = 2.2527e-01, PNorm = 34.2588, GNorm = 5.1536, lr_0 = 6.1123e-04
Validation rmse = 0.134326
Epoch 12
Validation rmse = 0.134938
Epoch 13
Loss = 1.9591e-01, PNorm = 34.2812, GNorm = 4.8851, lr_0 = 5.6458e-04
Validation rmse = 0.141164
Epoch 14
Validation rmse = 0.147959
Epoch 15
Loss = 2.0533e-01, PNorm = 34.3000, GNorm = 3.7276, lr_0 = 5.2148e-04
Validation rmse = 0.136424
Epoch 16
Loss = 1.7445e-01, PNorm = 34.3160, GNorm = 3.1505, lr_0 = 4.8168e-04
Validation rmse = 0.131738
Epoch 17
Validation rmse = 0.131554
Epoch 18
Loss = 1.4744e-01, PNorm = 34.3321, GNorm = 2.3719, lr_0 = 4.4491e-04
Validation rmse = 0.137978
Epoch 19
Validation rmse = 0.143486
Epoch 20
Loss = 1.4238e-01, PNorm = 34.3457, GNorm = 2.4606, lr_0 = 4.1095e-04
Validation rmse = 0.132220
Epoch 21
Loss = 1.5301e-01, PNorm = 34.3599, GNorm = 1.8918, lr_0 = 3.7959e-04
Validation rmse = 0.132628
Epoch 22
Validation rmse = 0.133551
Epoch 23
Loss = 1.2866e-01, PNorm = 34.3718, GNorm = 2.1943, lr_0 = 3.5061e-04
Validation rmse = 0.135832
Epoch 24
Validation rmse = 0.133758
Epoch 25
Loss = 1.0631e-01, PNorm = 34.3841, GNorm = 1.0921, lr_0 = 3.2385e-04
Validation rmse = 0.143764
Epoch 26
Loss = 1.4838e-01, PNorm = 34.3948, GNorm = 8.0048, lr_0 = 2.9913e-04
Validation rmse = 0.142411
Epoch 27
Validation rmse = 0.143008
Epoch 28
Loss = 1.5041e-01, PNorm = 34.4048, GNorm = 2.0127, lr_0 = 2.7630e-04
Validation rmse = 0.142513
Epoch 29
Validation rmse = 0.135335
Epoch 30
Loss = 9.9448e-02, PNorm = 34.4146, GNorm = 1.6764, lr_0 = 2.5521e-04
Validation rmse = 0.132585
Epoch 31
Loss = 1.3097e-01, PNorm = 34.4236, GNorm = 3.7098, lr_0 = 2.3573e-04
Validation rmse = 0.134266
Epoch 32
Validation rmse = 0.134121
Epoch 33
Loss = 1.3849e-01, PNorm = 34.4319, GNorm = 5.1997, lr_0 = 2.1774e-04
Validation rmse = 0.142002
Epoch 34
Validation rmse = 0.133289
Epoch 35
Loss = 8.8916e-02, PNorm = 34.4389, GNorm = 3.3298, lr_0 = 2.0112e-04
Validation rmse = 0.137365
Epoch 36
Loss = 1.2870e-01, PNorm = 34.4457, GNorm = 1.7328, lr_0 = 1.8577e-04
Validation rmse = 0.134129
Epoch 37
Validation rmse = 0.135401
Epoch 38
Loss = 1.2817e-01, PNorm = 34.4519, GNorm = 6.0456, lr_0 = 1.7159e-04
Validation rmse = 0.136045
Epoch 39
Validation rmse = 0.136440
Epoch 40
Loss = 1.2489e-01, PNorm = 34.4584, GNorm = 0.6478, lr_0 = 1.5849e-04
Validation rmse = 0.134961
Epoch 41
Loss = 1.1588e-01, PNorm = 34.4640, GNorm = 5.4191, lr_0 = 1.4639e-04
Validation rmse = 0.138349
Epoch 42
Validation rmse = 0.133964
Epoch 43
Loss = 1.3523e-01, PNorm = 34.4698, GNorm = 3.7819, lr_0 = 1.3522e-04
Validation rmse = 0.141667
Epoch 44
Validation rmse = 0.134426
Epoch 45
Loss = 1.2183e-01, PNorm = 34.4745, GNorm = 0.7695, lr_0 = 1.2490e-04
Validation rmse = 0.139076
Epoch 46
Loss = 1.2590e-01, PNorm = 34.4790, GNorm = 5.7749, lr_0 = 1.1536e-04
Validation rmse = 0.134903
Epoch 47
Validation rmse = 0.137428
Epoch 48
Loss = 1.1118e-01, PNorm = 34.4835, GNorm = 2.1091, lr_0 = 1.0656e-04
Validation rmse = 0.134358
Epoch 49
Validation rmse = 0.136381
Epoch 50
Loss = 6.7560e-02, PNorm = 34.4874, GNorm = 0.7317, lr_0 = 1.0000e-04
Validation rmse = 0.136936
Epoch 51
Loss = 1.1889e-01, PNorm = 34.4918, GNorm = 0.7209, lr_0 = 1.0000e-04
Validation rmse = 0.136495
Epoch 52
Validation rmse = 0.136289
Epoch 53
Loss = 1.1838e-01, PNorm = 34.4956, GNorm = 0.9983, lr_0 = 1.0000e-04
Validation rmse = 0.134923
Epoch 54
Validation rmse = 0.137566
Epoch 55
Loss = 1.1125e-01, PNorm = 34.4998, GNorm = 1.1747, lr_0 = 1.0000e-04
Validation rmse = 0.136696
Epoch 56
Loss = 1.1245e-01, PNorm = 34.5038, GNorm = 0.6076, lr_0 = 1.0000e-04
Validation rmse = 0.136786
Epoch 57
Validation rmse = 0.135493
Epoch 58
Loss = 1.1414e-01, PNorm = 34.5079, GNorm = 1.5942, lr_0 = 1.0000e-04
Validation rmse = 0.137743
Epoch 59
Validation rmse = 0.135865
Model 0 best validation rmse = 0.131554 on epoch 17
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.085288
Ensemble test rmse = 0.085288
1-fold cross validation
	Seed 0 ==> test rmse = 0.085288
Overall test rmse = 0.085288 +/- 0.000000
Elapsed time = 0:00:15
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_meoh.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 60,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 367 | train size = 291 | val size = 74 | test size = 2
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.236914
Epoch 1
Loss = 7.1686e-01, PNorm = 34.0386, GNorm = 6.3609, lr_0 = 9.8425e-04
Validation rmse = 0.192795
Epoch 2
Validation rmse = 0.174873
Epoch 3
Loss = 3.3162e-01, PNorm = 34.1012, GNorm = 1.2472, lr_0 = 9.0912e-04
Validation rmse = 0.194568
Epoch 4
Validation rmse = 0.156369
Epoch 5
Loss = 3.1546e-01, PNorm = 34.1563, GNorm = 4.5791, lr_0 = 8.3973e-04
Validation rmse = 0.147847
Epoch 6
Loss = 2.7288e-01, PNorm = 34.2013, GNorm = 1.6431, lr_0 = 7.6950e-04
Validation rmse = 0.143810
Epoch 7
Validation rmse = 0.135224
Epoch 8
Loss = 2.1094e-01, PNorm = 34.2366, GNorm = 0.9845, lr_0 = 7.1076e-04
Validation rmse = 0.131936
Epoch 9
Validation rmse = 0.142596
Epoch 10
Loss = 2.0071e-01, PNorm = 34.2622, GNorm = 4.0078, lr_0 = 6.5651e-04
Validation rmse = 0.167614
Epoch 11
Validation rmse = 0.141697
Epoch 12
Loss = 2.3152e-01, PNorm = 34.2856, GNorm = 5.0476, lr_0 = 6.0160e-04
Validation rmse = 0.129478
Epoch 13
Loss = 1.7563e-01, PNorm = 34.3088, GNorm = 2.2814, lr_0 = 5.5568e-04
Validation rmse = 0.125429
Epoch 14
Validation rmse = 0.125591
Epoch 15
Loss = 1.3962e-01, PNorm = 34.3288, GNorm = 1.0661, lr_0 = 5.1327e-04
Validation rmse = 0.123723
Epoch 16
Validation rmse = 0.124933
Epoch 17
Loss = 1.5273e-01, PNorm = 34.3474, GNorm = 2.6501, lr_0 = 4.7034e-04
Validation rmse = 0.121848
Epoch 18
Loss = 1.4553e-01, PNorm = 34.3619, GNorm = 1.9131, lr_0 = 4.3444e-04
Validation rmse = 0.121898
Epoch 19
Validation rmse = 0.125169
Epoch 20
Loss = 1.2511e-01, PNorm = 34.3766, GNorm = 2.8917, lr_0 = 4.0128e-04
Validation rmse = 0.130452
Epoch 21
Validation rmse = 0.127327
Epoch 22
Loss = 1.5463e-01, PNorm = 34.3899, GNorm = 2.9718, lr_0 = 3.7065e-04
Validation rmse = 0.120817
Epoch 23
Validation rmse = 0.121787
Epoch 24
Loss = 1.4290e-01, PNorm = 34.4027, GNorm = 1.0731, lr_0 = 3.3965e-04
Validation rmse = 0.130338
Epoch 25
Loss = 1.3077e-01, PNorm = 34.4138, GNorm = 4.1117, lr_0 = 3.1373e-04
Validation rmse = 0.133898
Epoch 26
Validation rmse = 0.122256
Epoch 27
Loss = 1.1376e-01, PNorm = 34.4243, GNorm = 0.9371, lr_0 = 2.8978e-04
Validation rmse = 0.120267
Epoch 28
Validation rmse = 0.124567
Epoch 29
Loss = 1.0199e-01, PNorm = 34.4351, GNorm = 3.5407, lr_0 = 2.6554e-04
Validation rmse = 0.123861
Epoch 30
Loss = 1.2292e-01, PNorm = 34.4448, GNorm = 1.6723, lr_0 = 2.4528e-04
Validation rmse = 0.120811
Epoch 31
Validation rmse = 0.124464
Epoch 32
Loss = 1.2692e-01, PNorm = 34.4528, GNorm = 3.7084, lr_0 = 2.2655e-04
Validation rmse = 0.122195
Epoch 33
Validation rmse = 0.122423
Epoch 34
Loss = 1.2080e-01, PNorm = 34.4629, GNorm = 0.7826, lr_0 = 2.0761e-04
Validation rmse = 0.119114
Epoch 35
Validation rmse = 0.123897
Epoch 36
Loss = 8.6737e-02, PNorm = 34.4710, GNorm = 2.8855, lr_0 = 1.9176e-04
Validation rmse = 0.118943
Epoch 37
Loss = 1.0861e-01, PNorm = 34.4785, GNorm = 1.7480, lr_0 = 1.7712e-04
Validation rmse = 0.125659
Epoch 38
Validation rmse = 0.120871
Epoch 39
Loss = 1.2409e-01, PNorm = 34.4864, GNorm = 4.7949, lr_0 = 1.6231e-04
Validation rmse = 0.118895
Epoch 40
Validation rmse = 0.130608
Epoch 41
Loss = 1.0993e-01, PNorm = 34.4925, GNorm = 4.4347, lr_0 = 1.4992e-04
Validation rmse = 0.118595
Epoch 42
Loss = 1.0867e-01, PNorm = 34.4985, GNorm = 3.6281, lr_0 = 1.3848e-04
Validation rmse = 0.125302
Epoch 43
Validation rmse = 0.118158
Epoch 44
Loss = 1.0443e-01, PNorm = 34.5044, GNorm = 1.2836, lr_0 = 1.2791e-04
Validation rmse = 0.121388
Epoch 45
Validation rmse = 0.120086
Epoch 46
Loss = 8.7756e-02, PNorm = 34.5099, GNorm = 1.8008, lr_0 = 1.1721e-04
Validation rmse = 0.122652
Epoch 47
Validation rmse = 0.120742
Epoch 48
Loss = 1.3319e-01, PNorm = 34.5151, GNorm = 2.0911, lr_0 = 1.0826e-04
Validation rmse = 0.119905
Epoch 49
Loss = 9.9496e-02, PNorm = 34.5194, GNorm = 0.6624, lr_0 = 1.0000e-04
Validation rmse = 0.120817
Epoch 50
Validation rmse = 0.119017
Epoch 51
Loss = 1.0234e-01, PNorm = 34.5241, GNorm = 0.8082, lr_0 = 1.0000e-04
Validation rmse = 0.122759
Epoch 52
Validation rmse = 0.118141
Epoch 53
Loss = 9.5550e-02, PNorm = 34.5287, GNorm = 1.5440, lr_0 = 1.0000e-04
Validation rmse = 0.122830
Epoch 54
Loss = 1.0495e-01, PNorm = 34.5330, GNorm = 1.2894, lr_0 = 1.0000e-04
Validation rmse = 0.118701
Epoch 55
Validation rmse = 0.121482
Epoch 56
Loss = 9.9617e-02, PNorm = 34.5377, GNorm = 0.9798, lr_0 = 1.0000e-04
Validation rmse = 0.119614
Epoch 57
Validation rmse = 0.119076
Epoch 58
Loss = 1.0912e-01, PNorm = 34.5420, GNorm = 3.9674, lr_0 = 1.0000e-04
Validation rmse = 0.122629
Epoch 59
Validation rmse = 0.119162
Model 0 best validation rmse = 0.118141 on epoch 52
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.053061
Ensemble test rmse = 0.053061
1-fold cross validation
	Seed 0 ==> test rmse = 0.053061
Overall test rmse = 0.053061 +/- 0.000000
Elapsed time = 0:00:16
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_mecn.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 80,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 146 | train size = 116 | val size = 29 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.208320
Epoch 1
Validation rmse = 0.205570
Epoch 2
Validation rmse = 0.201955
Epoch 3
Validation rmse = 0.180789
Epoch 4
Loss = 4.7665e-01, PNorm = 34.0548, GNorm = 2.0736, lr_0 = 8.6277e-04
Validation rmse = 0.182298
Epoch 5
Validation rmse = 0.169675
Epoch 6
Validation rmse = 0.171160
Epoch 7
Validation rmse = 0.155537
Epoch 8
Loss = 5.0334e-01, PNorm = 34.1140, GNorm = 2.4559, lr_0 = 7.1214e-04
Loss = 2.0529e-01, PNorm = 34.1186, GNorm = 1.0796, lr_0 = 7.0170e-04
Validation rmse = 0.170976
Epoch 9
Validation rmse = 0.143386
Epoch 10
Validation rmse = 0.145893
Epoch 11
Validation rmse = 0.142571
Epoch 12
Loss = 3.7047e-01, PNorm = 34.1678, GNorm = 7.0235, lr_0 = 5.8780e-04
Validation rmse = 0.130012
Epoch 13
Validation rmse = 0.133465
Epoch 14
Validation rmse = 0.125554
Epoch 15
Validation rmse = 0.122983
Epoch 16
Validation rmse = 0.121780
Epoch 17
Loss = 4.5774e-01, PNorm = 34.2117, GNorm = 0.7176, lr_0 = 4.8517e-04
Validation rmse = 0.124281
Epoch 18
Validation rmse = 0.115569
Epoch 19
Validation rmse = 0.149733
Epoch 20
Validation rmse = 0.112943
Epoch 21
Loss = 3.4693e-01, PNorm = 34.2478, GNorm = 11.5044, lr_0 = 4.0046e-04
Validation rmse = 0.113770
Epoch 22
Validation rmse = 0.121003
Epoch 23
Validation rmse = 0.108502
Epoch 24
Validation rmse = 0.118480
Epoch 25
Loss = 2.7455e-01, PNorm = 34.2707, GNorm = 0.8448, lr_0 = 3.3546e-04
Loss = 1.6950e-01, PNorm = 34.2725, GNorm = 1.7719, lr_0 = 3.3055e-04
Validation rmse = 0.108712
Epoch 26
Validation rmse = 0.107288
Epoch 27
Validation rmse = 0.109843
Epoch 28
Validation rmse = 0.112269
Epoch 29
Validation rmse = 0.106770
Epoch 30
Loss = 1.1543e-01, PNorm = 34.2920, GNorm = 2.3565, lr_0 = 2.7283e-04
Validation rmse = 0.105461
Epoch 31
Validation rmse = 0.109746
Epoch 32
Validation rmse = 0.104008
Epoch 33
Validation rmse = 0.103488
Epoch 34
Loss = 2.3420e-01, PNorm = 34.3111, GNorm = 3.2857, lr_0 = 2.2520e-04
Validation rmse = 0.109094
Epoch 35
Validation rmse = 0.103669
Epoch 36
Validation rmse = 0.122733
Epoch 37
Validation rmse = 0.102001
Epoch 38
Loss = 2.4402e-01, PNorm = 34.3227, GNorm = 3.9104, lr_0 = 1.8864e-04
Loss = 1.6081e-01, PNorm = 34.3237, GNorm = 6.7233, lr_0 = 1.8588e-04
Validation rmse = 0.099658
Epoch 39
Validation rmse = 0.120607
Epoch 40
Validation rmse = 0.108634
Epoch 41
Validation rmse = 0.100582
Epoch 42
Validation rmse = 0.105382
Epoch 43
Loss = 1.5138e-01, PNorm = 34.3327, GNorm = 2.4870, lr_0 = 1.5343e-04
Validation rmse = 0.114923
Epoch 44
Validation rmse = 0.099802
Epoch 45
Validation rmse = 0.098273
Epoch 46
Validation rmse = 0.105797
Epoch 47
Loss = 1.1015e-01, PNorm = 34.3403, GNorm = 1.2740, lr_0 = 1.2852e-04
Validation rmse = 0.110997
Epoch 48
Validation rmse = 0.101614
Epoch 49
Validation rmse = 0.098670
Epoch 50
Validation rmse = 0.105537
Epoch 51
Loss = 1.9438e-01, PNorm = 34.3489, GNorm = 1.6721, lr_0 = 1.0608e-04
Loss = 2.7736e-01, PNorm = 34.3494, GNorm = 2.6734, lr_0 = 1.0453e-04
Validation rmse = 0.106474
Epoch 52
Validation rmse = 0.099577
Epoch 53
Validation rmse = 0.100716
Epoch 54
Validation rmse = 0.107120
Epoch 55
Validation rmse = 0.102886
Epoch 56
Loss = 1.7432e-01, PNorm = 34.3563, GNorm = 0.9998, lr_0 = 1.0000e-04
Validation rmse = 0.098949
Epoch 57
Validation rmse = 0.103068
Epoch 58
Validation rmse = 0.104704
Epoch 59
Validation rmse = 0.103246
Epoch 60
Loss = 7.0051e-02, PNorm = 34.3626, GNorm = 0.7094, lr_0 = 1.0000e-04
Validation rmse = 0.100456
Epoch 61
Validation rmse = 0.099565
Epoch 62
Validation rmse = 0.107753
Epoch 63
Validation rmse = 0.100283
Epoch 64
Loss = 1.9896e-01, PNorm = 34.3690, GNorm = 2.1563, lr_0 = 1.0000e-04
Loss = 1.4319e-01, PNorm = 34.3696, GNorm = 1.9392, lr_0 = 1.0000e-04
Validation rmse = 0.097675
Epoch 65
Validation rmse = 0.100282
Epoch 66
Validation rmse = 0.106069
Epoch 67
Validation rmse = 0.101069
Epoch 68
Loss = 1.7242e-01, PNorm = 34.3758, GNorm = 1.9430, lr_0 = 1.0000e-04
Validation rmse = 0.098897
Epoch 69
Validation rmse = 0.100912
Epoch 70
Validation rmse = 0.104338
Epoch 71
Validation rmse = 0.103194
Epoch 72
Validation rmse = 0.099589
Epoch 73
Loss = 2.5646e-01, PNorm = 34.3823, GNorm = 1.0443, lr_0 = 1.0000e-04
Validation rmse = 0.100873
Epoch 74
Validation rmse = 0.101131
Epoch 75
Validation rmse = 0.098740
Epoch 76
Validation rmse = 0.100066
Epoch 77
Loss = 1.8811e-01, PNorm = 34.3902, GNorm = 0.5964, lr_0 = 1.0000e-04
Loss = 1.1546e-01, PNorm = 34.3908, GNorm = 7.8932, lr_0 = 1.0000e-04
Validation rmse = 0.101306
Epoch 78
Validation rmse = 0.108003
Epoch 79
Validation rmse = 0.100609
Model 0 best validation rmse = 0.097675 on epoch 64
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.115837
Ensemble test rmse = 0.115837
1-fold cross validation
	Seed 0 ==> test rmse = 0.115837
Overall test rmse = 0.115837 +/- 0.000000
Elapsed time = 0:00:11
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_mecn.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 80,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 136 | train size = 108 | val size = 27 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.178589
Epoch 1
Validation rmse = 0.230312
Epoch 2
Validation rmse = 0.209681
Epoch 3
Validation rmse = 0.174338
Epoch 4
Loss = 5.8388e-01, PNorm = 34.0556, GNorm = 3.8299, lr_0 = 8.5013e-04
Loss = 5.3130e-01, PNorm = 34.0593, GNorm = 1.8624, lr_0 = 8.3768e-04
Validation rmse = 0.179228
Epoch 5
Validation rmse = 0.178993
Epoch 6
Validation rmse = 0.170365
Epoch 7
Validation rmse = 0.167553
Epoch 8
Validation rmse = 0.169806
Epoch 9
Loss = 3.7510e-01, PNorm = 34.1097, GNorm = 4.0377, lr_0 = 6.9142e-04
Validation rmse = 0.159624
Epoch 10
Validation rmse = 0.163548
Epoch 11
Validation rmse = 0.149373
Epoch 12
Validation rmse = 0.150638
Epoch 13
Loss = 2.6706e-01, PNorm = 34.1541, GNorm = 2.0852, lr_0 = 5.7070e-04
Loss = 4.9289e-01, PNorm = 34.1577, GNorm = 3.2048, lr_0 = 5.6234e-04
Validation rmse = 0.152671
Epoch 14
Validation rmse = 0.139889
Epoch 15
Validation rmse = 0.141086
Epoch 16
Validation rmse = 0.135623
Epoch 17
Validation rmse = 0.135995
Epoch 18
Loss = 2.0929e-01, PNorm = 34.2037, GNorm = 5.2515, lr_0 = 4.5736e-04
Validation rmse = 0.130756
Epoch 19
Validation rmse = 0.129732
Epoch 20
Validation rmse = 0.128539
Epoch 21
Validation rmse = 0.125034
Epoch 22
Validation rmse = 0.120903
Epoch 23
Loss = 1.6112e-01, PNorm = 34.2384, GNorm = 1.3306, lr_0 = 3.7197e-04
Validation rmse = 0.116849
Epoch 24
Validation rmse = 0.116869
Epoch 25
Validation rmse = 0.115870
Epoch 26
Validation rmse = 0.114649
Epoch 27
Loss = 1.2612e-01, PNorm = 34.2632, GNorm = 0.5473, lr_0 = 3.0703e-04
Loss = 1.8983e-01, PNorm = 34.2651, GNorm = 4.0547, lr_0 = 3.0253e-04
Validation rmse = 0.112787
Epoch 28
Validation rmse = 0.110304
Epoch 29
Validation rmse = 0.108677
Epoch 30
Validation rmse = 0.113590
Epoch 31
Validation rmse = 0.111708
Epoch 32
Loss = 1.1703e-01, PNorm = 34.2819, GNorm = 0.7393, lr_0 = 2.4971e-04
Validation rmse = 0.118840
Epoch 33
Validation rmse = 0.118422
Epoch 34
Validation rmse = 0.113501
Epoch 35
Validation rmse = 0.107872
Epoch 36
Validation rmse = 0.106527
Epoch 37
Loss = 9.4520e-02, PNorm = 34.2957, GNorm = 1.1909, lr_0 = 2.0012e-04
Validation rmse = 0.106614
Epoch 38
Validation rmse = 0.108958
Epoch 39
Validation rmse = 0.111733
Epoch 40
Validation rmse = 0.112705
Epoch 41
Loss = 1.0700e-01, PNorm = 34.3076, GNorm = 5.9914, lr_0 = 1.6518e-04
Loss = 5.6482e-02, PNorm = 34.3082, GNorm = 0.8591, lr_0 = 1.6276e-04
Validation rmse = 0.112144
Epoch 42
Validation rmse = 0.108969
Epoch 43
Validation rmse = 0.108560
Epoch 44
Validation rmse = 0.108256
Epoch 45
Validation rmse = 0.108722
Epoch 46
Loss = 9.0605e-02, PNorm = 34.3162, GNorm = 2.5420, lr_0 = 1.3434e-04
Validation rmse = 0.109654
Epoch 47
Validation rmse = 0.109692
Epoch 48
Validation rmse = 0.111247
Epoch 49
Validation rmse = 0.112357
Epoch 50
Loss = 8.4939e-02, PNorm = 34.3235, GNorm = 2.3907, lr_0 = 1.1088e-04
Loss = 1.1900e-01, PNorm = 34.3239, GNorm = 2.0060, lr_0 = 1.0926e-04
Validation rmse = 0.111140
Epoch 51
Validation rmse = 0.110595
Epoch 52
Validation rmse = 0.108290
Epoch 53
Validation rmse = 0.108146
Epoch 54
Validation rmse = 0.107612
Epoch 55
Loss = 8.2662e-02, PNorm = 34.3292, GNorm = 2.3703, lr_0 = 1.0000e-04
Loss = 7.8057e-02, PNorm = 34.3296, GNorm = 1.1808, lr_0 = 1.0000e-04
Validation rmse = 0.107822
Epoch 56
Validation rmse = 0.108187
Epoch 57
Validation rmse = 0.108085
Epoch 58
Validation rmse = 0.107532
Epoch 59
Validation rmse = 0.107522
Epoch 60
Loss = 7.4337e-02, PNorm = 34.3349, GNorm = 0.3508, lr_0 = 1.0000e-04
Validation rmse = 0.108063
Epoch 61
Validation rmse = 0.109076
Epoch 62
Validation rmse = 0.109609
Epoch 63
Validation rmse = 0.110247
Epoch 64
Loss = 7.7726e-02, PNorm = 34.3401, GNorm = 2.7058, lr_0 = 1.0000e-04
Loss = 1.1264e-01, PNorm = 34.3405, GNorm = 5.3196, lr_0 = 1.0000e-04
Validation rmse = 0.110425
Epoch 65
Validation rmse = 0.109672
Epoch 66
Validation rmse = 0.108854
Epoch 67
Validation rmse = 0.109507
Epoch 68
Validation rmse = 0.108417
Epoch 69
Loss = 7.6583e-02, PNorm = 34.3449, GNorm = 0.8146, lr_0 = 1.0000e-04
Validation rmse = 0.113312
Epoch 70
Validation rmse = 0.108916
Epoch 71
Validation rmse = 0.109695
Epoch 72
Validation rmse = 0.108348
Epoch 73
Validation rmse = 0.109635
Epoch 74
Loss = 7.9427e-02, PNorm = 34.3502, GNorm = 1.4241, lr_0 = 1.0000e-04
Validation rmse = 0.110269
Epoch 75
Validation rmse = 0.111085
Epoch 76
Validation rmse = 0.110677
Epoch 77
Validation rmse = 0.109843
Epoch 78
Loss = 7.1269e-02, PNorm = 34.3550, GNorm = 1.9611, lr_0 = 1.0000e-04
Loss = 7.0676e-02, PNorm = 34.3553, GNorm = 4.7572, lr_0 = 1.0000e-04
Validation rmse = 0.109507
Epoch 79
Validation rmse = 0.109908
Model 0 best validation rmse = 0.106527 on epoch 36
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.015925
Ensemble test rmse = 0.015925
1-fold cross validation
	Seed 0 ==> test rmse = 0.015925
Overall test rmse = 0.015925 +/- 0.000000
Elapsed time = 0:00:10
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_mecn.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 80,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 126 | train size = 100 | val size = 25 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.176220
Epoch 1
Validation rmse = 0.131939
Epoch 2
Validation rmse = 0.121578
Epoch 3
Validation rmse = 0.141530
Epoch 4
Loss = 5.5165e-01, PNorm = 34.0506, GNorm = 3.1725, lr_0 = 9.0184e-04
Validation rmse = 0.122423
Epoch 5
Validation rmse = 0.113254
Epoch 6
Validation rmse = 0.120866
Epoch 7
Validation rmse = 0.113763
Epoch 8
Validation rmse = 0.118434
Epoch 9
Loss = 2.4413e-01, PNorm = 34.1220, GNorm = 1.6394, lr_0 = 7.7808e-04
Validation rmse = 0.125898
Epoch 10
Validation rmse = 0.140630
Epoch 11
Validation rmse = 0.128621
Epoch 12
Validation rmse = 0.142224
Epoch 13
Validation rmse = 0.118709
Epoch 14
Loss = 2.3528e-01, PNorm = 34.1706, GNorm = 13.0257, lr_0 = 6.7131e-04
Validation rmse = 0.115676
Epoch 15
Validation rmse = 0.144922
Epoch 16
Validation rmse = 0.109845
Epoch 17
Validation rmse = 0.106749
Epoch 18
Validation rmse = 0.131209
Epoch 19
Loss = 1.5902e-01, PNorm = 34.2025, GNorm = 3.3108, lr_0 = 5.7919e-04
Validation rmse = 0.104529
Epoch 20
Validation rmse = 0.103068
Epoch 21
Validation rmse = 0.122756
Epoch 22
Validation rmse = 0.097418
Epoch 23
Validation rmse = 0.095879
Epoch 24
Loss = 1.1599e-01, PNorm = 34.2278, GNorm = 0.8469, lr_0 = 4.9971e-04
Validation rmse = 0.115443
Epoch 25
Validation rmse = 0.099043
Epoch 26
Validation rmse = 0.095016
Epoch 27
Validation rmse = 0.106970
Epoch 28
Validation rmse = 0.101857
Epoch 29
Loss = 9.5039e-02, PNorm = 34.2496, GNorm = 0.9863, lr_0 = 4.3114e-04
Validation rmse = 0.091318
Epoch 30
Validation rmse = 0.092070
Epoch 31
Validation rmse = 0.104417
Epoch 32
Validation rmse = 0.090190
Epoch 33
Validation rmse = 0.088925
Epoch 34
Loss = 8.7440e-02, PNorm = 34.2683, GNorm = 2.3226, lr_0 = 3.7197e-04
Validation rmse = 0.094627
Epoch 35
Validation rmse = 0.093724
Epoch 36
Validation rmse = 0.086497
Epoch 37
Validation rmse = 0.086743
Epoch 38
Validation rmse = 0.092626
Epoch 39
Loss = 8.1336e-02, PNorm = 34.2838, GNorm = 0.5732, lr_0 = 3.2093e-04
Validation rmse = 0.085019
Epoch 40
Validation rmse = 0.084208
Epoch 41
Validation rmse = 0.086863
Epoch 42
Validation rmse = 0.084928
Epoch 43
Validation rmse = 0.082200
Epoch 44
Loss = 7.2121e-02, PNorm = 34.2976, GNorm = 0.7330, lr_0 = 2.7689e-04
Validation rmse = 0.083129
Epoch 45
Validation rmse = 0.083816
Epoch 46
Validation rmse = 0.080563
Epoch 47
Validation rmse = 0.081548
Epoch 48
Validation rmse = 0.083919
Epoch 49
Loss = 6.8975e-02, PNorm = 34.3100, GNorm = 0.5256, lr_0 = 2.3889e-04
Validation rmse = 0.081135
Epoch 50
Validation rmse = 0.079231
Epoch 51
Validation rmse = 0.078428
Epoch 52
Validation rmse = 0.080637
Epoch 53
Validation rmse = 0.081433
Epoch 54
Loss = 6.6196e-02, PNorm = 34.3209, GNorm = 1.6114, lr_0 = 2.0611e-04
Validation rmse = 0.076669
Epoch 55
Validation rmse = 0.077467
Epoch 56
Validation rmse = 0.081265
Epoch 57
Validation rmse = 0.078132
Epoch 58
Validation rmse = 0.074640
Epoch 59
Loss = 6.4552e-02, PNorm = 34.3305, GNorm = 2.0555, lr_0 = 1.7783e-04
Validation rmse = 0.076053
Epoch 60
Validation rmse = 0.080148
Epoch 61
Validation rmse = 0.077249
Epoch 62
Validation rmse = 0.073297
Epoch 63
Validation rmse = 0.073914
Epoch 64
Loss = 6.0395e-02, PNorm = 34.3386, GNorm = 0.8161, lr_0 = 1.5343e-04
Validation rmse = 0.077638
Epoch 65
Validation rmse = 0.076180
Epoch 66
Validation rmse = 0.074703
Epoch 67
Validation rmse = 0.074273
Epoch 68
Validation rmse = 0.074364
Epoch 69
Loss = 5.7912e-02, PNorm = 34.3457, GNorm = 0.2761, lr_0 = 1.3237e-04
Validation rmse = 0.075696
Epoch 70
Validation rmse = 0.075377
Epoch 71
Validation rmse = 0.073582
Epoch 72
Validation rmse = 0.073603
Epoch 73
Validation rmse = 0.073742
Epoch 74
Loss = 5.6350e-02, PNorm = 34.3520, GNorm = 0.3185, lr_0 = 1.1421e-04
Validation rmse = 0.074042
Epoch 75
Validation rmse = 0.073789
Epoch 76
Validation rmse = 0.073542
Epoch 77
Validation rmse = 0.073401
Epoch 78
Validation rmse = 0.072410
Epoch 79
Loss = 5.5394e-02, PNorm = 34.3575, GNorm = 0.9345, lr_0 = 1.0000e-04
Validation rmse = 0.073361
Model 0 best validation rmse = 0.072410 on epoch 78
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.003555
Ensemble test rmse = 0.003555
1-fold cross validation
	Seed 0 ==> test rmse = 0.003555
Overall test rmse = 0.003555 +/- 0.000000
Elapsed time = 0:00:10
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_dmf.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 80,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 123 | train size = 97 | val size = 25 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.221631
Epoch 1
Validation rmse = 0.267964
Epoch 2
Validation rmse = 0.216312
Epoch 3
Validation rmse = 0.208283
Epoch 4
Validation rmse = 0.213848
Epoch 5
Loss = 6.1724e-01, PNorm = 34.0483, GNorm = 0.8562, lr_0 = 7.4438e-04
Validation rmse = 0.229854
Epoch 6
Validation rmse = 0.208791
Epoch 7
Validation rmse = 0.203919
Epoch 8
Validation rmse = 0.211492
Epoch 9
Validation rmse = 0.192939
Epoch 10
Loss = 5.7993e-01, PNorm = 34.1033, GNorm = 1.7102, lr_0 = 5.5410e-04
Validation rmse = 0.192364
Epoch 11
Validation rmse = 0.177125
Epoch 12
Validation rmse = 0.165269
Epoch 13
Validation rmse = 0.155138
Epoch 14
Validation rmse = 0.166479
Epoch 15
Loss = 3.8534e-01, PNorm = 34.1471, GNorm = 2.5072, lr_0 = 4.1246e-04
Validation rmse = 0.136776
Epoch 16
Validation rmse = 0.136673
Epoch 17
Validation rmse = 0.143111
Epoch 18
Validation rmse = 0.128610
Epoch 19
Validation rmse = 0.137100
Epoch 20
Loss = 3.2445e-01, PNorm = 34.1770, GNorm = 1.4107, lr_0 = 2.9810e-04
Validation rmse = 0.142650
Epoch 21
Validation rmse = 0.130826
Epoch 22
Validation rmse = 0.130277
Epoch 23
Validation rmse = 0.159300
Epoch 24
Validation rmse = 0.138591
Epoch 25
Loss = 2.9044e-01, PNorm = 34.1953, GNorm = 3.6943, lr_0 = 2.2190e-04
Validation rmse = 0.123704
Epoch 26
Validation rmse = 0.141137
Epoch 27
Validation rmse = 0.147732
Epoch 28
Validation rmse = 0.131266
Epoch 29
Validation rmse = 0.134724
Epoch 30
Loss = 2.6055e-01, PNorm = 34.2087, GNorm = 1.3272, lr_0 = 1.6518e-04
Validation rmse = 0.142114
Epoch 31
Validation rmse = 0.144293
Epoch 32
Validation rmse = 0.135831
Epoch 33
Validation rmse = 0.130025
Epoch 34
Validation rmse = 0.143847
Epoch 35
Validation rmse = 0.152380
Epoch 36
Loss = 2.8151e-01, PNorm = 34.2199, GNorm = 0.7828, lr_0 = 1.1938e-04
Validation rmse = 0.145195
Epoch 37
Validation rmse = 0.130118
Epoch 38
Validation rmse = 0.133265
Epoch 39
Validation rmse = 0.141670
Epoch 40
Validation rmse = 0.149882
Epoch 41
Loss = 2.5869e-01, PNorm = 34.2277, GNorm = 0.7045, lr_0 = 1.0000e-04
Validation rmse = 0.146689
Epoch 42
Validation rmse = 0.133210
Epoch 43
Validation rmse = 0.134766
Epoch 44
Validation rmse = 0.150508
Epoch 45
Validation rmse = 0.156234
Epoch 46
Loss = 2.0141e-01, PNorm = 34.2351, GNorm = 1.0575, lr_0 = 1.0000e-04
Validation rmse = 0.141447
Epoch 47
Validation rmse = 0.129146
Epoch 48
Validation rmse = 0.135601
Epoch 49
Validation rmse = 0.158803
Epoch 50
Validation rmse = 0.156669
Epoch 51
Loss = 2.1983e-01, PNorm = 34.2433, GNorm = 4.8868, lr_0 = 1.0000e-04
Validation rmse = 0.135938
Epoch 52
Validation rmse = 0.136576
Epoch 53
Validation rmse = 0.149598
Epoch 54
Validation rmse = 0.145263
Epoch 55
Validation rmse = 0.144495
Epoch 56
Loss = 1.9658e-01, PNorm = 34.2505, GNorm = 1.1367, lr_0 = 1.0000e-04
Validation rmse = 0.146655
Epoch 57
Validation rmse = 0.143619
Epoch 58
Validation rmse = 0.146926
Epoch 59
Validation rmse = 0.144965
Epoch 60
Validation rmse = 0.141686
Epoch 61
Loss = 1.8912e-01, PNorm = 34.2583, GNorm = 1.0834, lr_0 = 1.0000e-04
Validation rmse = 0.146107
Epoch 62
Validation rmse = 0.149910
Epoch 63
Validation rmse = 0.144015
Epoch 64
Validation rmse = 0.148662
Epoch 65
Validation rmse = 0.146386
Epoch 66
Validation rmse = 0.148920
Epoch 67
Loss = 9.9392e-02, PNorm = 34.2669, GNorm = 0.8748, lr_0 = 1.0000e-04
Validation rmse = 0.152038
Epoch 68
Validation rmse = 0.144766
Epoch 69
Validation rmse = 0.144388
Epoch 70
Validation rmse = 0.145316
Epoch 71
Validation rmse = 0.155950
Epoch 72
Loss = 2.3432e-01, PNorm = 34.2750, GNorm = 2.6258, lr_0 = 1.0000e-04
Validation rmse = 0.147358
Epoch 73
Validation rmse = 0.142350
Epoch 74
Validation rmse = 0.151804
Epoch 75
Validation rmse = 0.161820
Epoch 76
Validation rmse = 0.144210
Epoch 77
Loss = 1.6978e-01, PNorm = 34.2832, GNorm = 0.8404, lr_0 = 1.0000e-04
Validation rmse = 0.143772
Epoch 78
Validation rmse = 0.156886
Epoch 79
Validation rmse = 0.154275
Model 0 best validation rmse = 0.123704 on epoch 25
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.127313
Ensemble test rmse = 0.127313
1-fold cross validation
	Seed 0 ==> test rmse = 0.127313
Overall test rmse = 0.127313 +/- 0.000000
Elapsed time = 0:00:10
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_dmf.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 80,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 113 | train size = 89 | val size = 23 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.250241
Epoch 1
Validation rmse = 0.225933
Epoch 2
Validation rmse = 0.205362
Epoch 3
Validation rmse = 0.212696
Epoch 4
Validation rmse = 0.208911
Epoch 5
Loss = 6.8080e-01, PNorm = 34.0588, GNorm = 3.7066, lr_0 = 7.2273e-04
Validation rmse = 0.181175
Epoch 6
Validation rmse = 0.182410
Epoch 7
Validation rmse = 0.178650
Epoch 8
Validation rmse = 0.163884
Epoch 9
Validation rmse = 0.186312
Epoch 10
Validation rmse = 0.164460
Epoch 11
Loss = 2.9505e-01, PNorm = 34.1282, GNorm = 4.8847, lr_0 = 5.2233e-04
Validation rmse = 0.180212
Epoch 12
Validation rmse = 0.169495
Epoch 13
Validation rmse = 0.158738
Epoch 14
Validation rmse = 0.162985
Epoch 15
Validation rmse = 0.147868
Epoch 16
Loss = 2.3228e-01, PNorm = 34.1594, GNorm = 0.7834, lr_0 = 3.7751e-04
Validation rmse = 0.152367
Epoch 17
Validation rmse = 0.148559
Epoch 18
Validation rmse = 0.145244
Epoch 19
Validation rmse = 0.138865
Epoch 20
Validation rmse = 0.138708
Epoch 21
Validation rmse = 0.136515
Epoch 22
Loss = 1.6328e-01, PNorm = 34.1809, GNorm = 2.1016, lr_0 = 2.7283e-04
Loss = 2.2278e-01, PNorm = 34.1825, GNorm = 6.8778, lr_0 = 2.6490e-04
Validation rmse = 0.140338
Epoch 23
Validation rmse = 0.143671
Epoch 24
Validation rmse = 0.130170
Epoch 25
Validation rmse = 0.129217
Epoch 26
Validation rmse = 0.150726
Epoch 27
Validation rmse = 0.133504
Epoch 28
Loss = 1.7464e-01, PNorm = 34.1963, GNorm = 0.8918, lr_0 = 1.9145e-04
Validation rmse = 0.126280
Epoch 29
Validation rmse = 0.126508
Epoch 30
Validation rmse = 0.134068
Epoch 31
Validation rmse = 0.134932
Epoch 32
Validation rmse = 0.125147
Epoch 33
Loss = 1.4926e-01, PNorm = 34.2060, GNorm = 0.5599, lr_0 = 1.3836e-04
Validation rmse = 0.123761
Epoch 34
Validation rmse = 0.125812
Epoch 35
Validation rmse = 0.128873
Epoch 36
Validation rmse = 0.126454
Epoch 37
Validation rmse = 0.122964
Epoch 38
Validation rmse = 0.121074
Epoch 39
Loss = 1.2250e-01, PNorm = 34.2132, GNorm = 1.6651, lr_0 = 1.0000e-04
Validation rmse = 0.123551
Epoch 40
Validation rmse = 0.126544
Epoch 41
Validation rmse = 0.123827
Epoch 42
Validation rmse = 0.120667
Epoch 43
Validation rmse = 0.119637
Epoch 44
Loss = 1.3424e-01, PNorm = 34.2195, GNorm = 4.0017, lr_0 = 1.0000e-04
Validation rmse = 0.120788
Epoch 45
Validation rmse = 0.125102
Epoch 46
Validation rmse = 0.122790
Epoch 47
Validation rmse = 0.117209
Epoch 48
Validation rmse = 0.117705
Epoch 49
Validation rmse = 0.122680
Epoch 50
Loss = 9.4482e-02, PNorm = 34.2261, GNorm = 2.8250, lr_0 = 1.0000e-04
Loss = 1.6280e-01, PNorm = 34.2267, GNorm = 1.3768, lr_0 = 1.0000e-04
Validation rmse = 0.120525
Epoch 51
Validation rmse = 0.118370
Epoch 52
Validation rmse = 0.117662
Epoch 53
Validation rmse = 0.117106
Epoch 54
Validation rmse = 0.117837
Epoch 55
Validation rmse = 0.117116
Epoch 56
Loss = 1.0975e-01, PNorm = 34.2336, GNorm = 1.1085, lr_0 = 1.0000e-04
Validation rmse = 0.116756
Epoch 57
Validation rmse = 0.117363
Epoch 58
Validation rmse = 0.119953
Epoch 59
Validation rmse = 0.114626
Epoch 60
Validation rmse = 0.111581
Epoch 61
Loss = 1.1340e-01, PNorm = 34.2407, GNorm = 0.7619, lr_0 = 1.0000e-04
Validation rmse = 0.113204
Epoch 62
Validation rmse = 0.116860
Epoch 63
Validation rmse = 0.119016
Epoch 64
Validation rmse = 0.109920
Epoch 65
Validation rmse = 0.109668
Epoch 66
Validation rmse = 0.114722
Epoch 67
Loss = 1.1850e-01, PNorm = 34.2480, GNorm = 1.7758, lr_0 = 1.0000e-04
Validation rmse = 0.115238
Epoch 68
Validation rmse = 0.112895
Epoch 69
Validation rmse = 0.112721
Epoch 70
Validation rmse = 0.110560
Epoch 71
Validation rmse = 0.110777
Epoch 72
Validation rmse = 0.111498
Epoch 73
Loss = 9.7248e-02, PNorm = 34.2560, GNorm = 0.6916, lr_0 = 1.0000e-04
Validation rmse = 0.109644
Epoch 74
Validation rmse = 0.109823
Epoch 75
Validation rmse = 0.108567
Epoch 76
Validation rmse = 0.108622
Epoch 77
Validation rmse = 0.111459
Epoch 78
Loss = 9.5581e-02, PNorm = 34.2636, GNorm = 0.5447, lr_0 = 1.0000e-04
Validation rmse = 0.110120
Epoch 79
Validation rmse = 0.107696
Model 0 best validation rmse = 0.107696 on epoch 79
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.091666
Ensemble test rmse = 0.091666
1-fold cross validation
	Seed 0 ==> test rmse = 0.091666
Overall test rmse = 0.091666 +/- 0.000000
Elapsed time = 0:00:10
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_dmf.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 80,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 103 | train size = 81 | val size = 21 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.257594
Epoch 1
Validation rmse = 0.176696
Epoch 2
Validation rmse = 0.185394
Epoch 3
Validation rmse = 0.182002
Epoch 4
Validation rmse = 0.150693
Epoch 5
Validation rmse = 0.178730
Epoch 6
Loss = 3.9957e-01, PNorm = 34.0772, GNorm = 4.1851, lr_0 = 7.0170e-04
Validation rmse = 0.146513
Epoch 7
Validation rmse = 0.165770
Epoch 8
Validation rmse = 0.159320
Epoch 9
Validation rmse = 0.154656
Epoch 10
Validation rmse = 0.191799
Epoch 11
Validation rmse = 0.148187
Epoch 12
Loss = 3.0319e-01, PNorm = 34.1361, GNorm = 5.8225, lr_0 = 4.9239e-04
Validation rmse = 0.149512
Epoch 13
Validation rmse = 0.168324
Epoch 14
Validation rmse = 0.132281
Epoch 15
Validation rmse = 0.127215
Epoch 16
Validation rmse = 0.135162
Epoch 17
Validation rmse = 0.126212
Epoch 18
Loss = 1.7239e-01, PNorm = 34.1641, GNorm = 2.5202, lr_0 = 3.4551e-04
Loss = 1.2710e-01, PNorm = 34.1660, GNorm = 3.3898, lr_0 = 3.3546e-04
Validation rmse = 0.118464
Epoch 19
Validation rmse = 0.121041
Epoch 20
Validation rmse = 0.143512
Epoch 21
Validation rmse = 0.120713
Epoch 22
Validation rmse = 0.115051
Epoch 23
Validation rmse = 0.121316
Epoch 24
Loss = 1.2875e-01, PNorm = 34.1835, GNorm = 2.4370, lr_0 = 2.3539e-04
Validation rmse = 0.125708
Epoch 25
Validation rmse = 0.115914
Epoch 26
Validation rmse = 0.113459
Epoch 27
Validation rmse = 0.117023
Epoch 28
Validation rmse = 0.117813
Epoch 29
Validation rmse = 0.112520
Epoch 30
Loss = 1.1282e-01, PNorm = 34.1964, GNorm = 1.0735, lr_0 = 1.6518e-04
Validation rmse = 0.113386
Epoch 31
Validation rmse = 0.114238
Epoch 32
Validation rmse = 0.114076
Epoch 33
Validation rmse = 0.113060
Epoch 34
Validation rmse = 0.112349
Epoch 35
Validation rmse = 0.112730
Epoch 36
Validation rmse = 0.111738
Epoch 37
Loss = 9.6800e-02, PNorm = 34.2061, GNorm = 0.5160, lr_0 = 1.1253e-04
Validation rmse = 0.111191
Epoch 38
Validation rmse = 0.113103
Epoch 39
Validation rmse = 0.112822
Epoch 40
Validation rmse = 0.112989
Epoch 41
Validation rmse = 0.110908
Epoch 42
Validation rmse = 0.111348
Epoch 43
Loss = 1.1132e-01, PNorm = 34.2130, GNorm = 0.7858, lr_0 = 1.0000e-04
Validation rmse = 0.111776
Epoch 44
Validation rmse = 0.111188
Epoch 45
Validation rmse = 0.110257
Epoch 46
Validation rmse = 0.107747
Epoch 47
Validation rmse = 0.107796
Epoch 48
Validation rmse = 0.109442
Epoch 49
Loss = 8.6167e-02, PNorm = 34.2196, GNorm = 2.1149, lr_0 = 1.0000e-04
Validation rmse = 0.109920
Epoch 50
Validation rmse = 0.110574
Epoch 51
Validation rmse = 0.108703
Epoch 52
Validation rmse = 0.106168
Epoch 53
Validation rmse = 0.105503
Epoch 54
Validation rmse = 0.106616
Epoch 55
Loss = 6.6760e-02, PNorm = 34.2261, GNorm = 1.3844, lr_0 = 1.0000e-04
Loss = 1.1236e-01, PNorm = 34.2267, GNorm = 3.1517, lr_0 = 1.0000e-04
Validation rmse = 0.108318
Epoch 56
Validation rmse = 0.105850
Epoch 57
Validation rmse = 0.103894
Epoch 58
Validation rmse = 0.105122
Epoch 59
Validation rmse = 0.110016
Epoch 60
Validation rmse = 0.106891
Epoch 61
Loss = 7.4463e-02, PNorm = 34.2333, GNorm = 0.7341, lr_0 = 1.0000e-04
Validation rmse = 0.102869
Epoch 62
Validation rmse = 0.102966
Epoch 63
Validation rmse = 0.108010
Epoch 64
Validation rmse = 0.106133
Epoch 65
Validation rmse = 0.102925
Epoch 66
Validation rmse = 0.102130
Epoch 67
Loss = 7.8596e-02, PNorm = 34.2400, GNorm = 2.9872, lr_0 = 1.0000e-04
Validation rmse = 0.103375
Epoch 68
Validation rmse = 0.107336
Epoch 69
Validation rmse = 0.104338
Epoch 70
Validation rmse = 0.102686
Epoch 71
Validation rmse = 0.102181
Epoch 72
Validation rmse = 0.103964
Epoch 73
Validation rmse = 0.104280
Epoch 74
Loss = 7.3318e-02, PNorm = 34.2473, GNorm = 1.5001, lr_0 = 1.0000e-04
Validation rmse = 0.101799
Epoch 75
Validation rmse = 0.100259
Epoch 76
Validation rmse = 0.099653
Epoch 77
Validation rmse = 0.100739
Epoch 78
Validation rmse = 0.102692
Epoch 79
Validation rmse = 0.101292
Model 0 best validation rmse = 0.099653 on epoch 76
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.064726
Ensemble test rmse = 0.064726
1-fold cross validation
	Seed 0 ==> test rmse = 0.064726
Overall test rmse = 0.064726 +/- 0.000000
Elapsed time = 0:00:10
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_dmf.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 200,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 123 | train size = 97 | val size = 25 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.221631
Epoch 1
Validation rmse = 0.268236
Epoch 2
Validation rmse = 0.214970
Epoch 3
Validation rmse = 0.208340
Epoch 4
Validation rmse = 0.217279
Epoch 5
Loss = 6.1884e-01, PNorm = 34.0534, GNorm = 1.1043, lr_0 = 8.9022e-04
Validation rmse = 0.231351
Epoch 6
Validation rmse = 0.205464
Epoch 7
Validation rmse = 0.207996
Epoch 8
Validation rmse = 0.204458
Epoch 9
Validation rmse = 0.184270
Epoch 10
Loss = 5.5312e-01, PNorm = 34.1246, GNorm = 2.7390, lr_0 = 7.9248e-04
Validation rmse = 0.203675
Epoch 11
Validation rmse = 0.161855
Epoch 12
Validation rmse = 0.166359
Epoch 13
Validation rmse = 0.148465
Epoch 14
Validation rmse = 0.146071
Epoch 15
Loss = 3.4704e-01, PNorm = 34.1855, GNorm = 0.5357, lr_0 = 7.0548e-04
Validation rmse = 0.131808
Epoch 16
Validation rmse = 0.126033
Epoch 17
Validation rmse = 0.135347
Epoch 18
Validation rmse = 0.127341
Epoch 19
Validation rmse = 0.139478
Epoch 20
Loss = 2.8290e-01, PNorm = 34.2424, GNorm = 2.7332, lr_0 = 6.2077e-04
Validation rmse = 0.131647
Epoch 21
Validation rmse = 0.131318
Epoch 22
Validation rmse = 0.140973
Epoch 23
Validation rmse = 0.171363
Epoch 24
Validation rmse = 0.121504
Epoch 25
Loss = 2.4430e-01, PNorm = 34.2828, GNorm = 2.6536, lr_0 = 5.5262e-04
Validation rmse = 0.169266
Epoch 26
Validation rmse = 0.138565
Epoch 27
Validation rmse = 0.138685
Epoch 28
Validation rmse = 0.168103
Epoch 29
Validation rmse = 0.133124
Epoch 30
Loss = 2.0904e-01, PNorm = 34.3192, GNorm = 4.7196, lr_0 = 4.9195e-04
Validation rmse = 0.151620
Epoch 31
Validation rmse = 0.155119
Epoch 32
Validation rmse = 0.131929
Epoch 33
Validation rmse = 0.171558
Epoch 34
Validation rmse = 0.147470
Epoch 35
Validation rmse = 0.147975
Epoch 36
Loss = 1.8543e-01, PNorm = 34.3556, GNorm = 2.4692, lr_0 = 4.3288e-04
Validation rmse = 0.155713
Epoch 37
Validation rmse = 0.134348
Epoch 38
Validation rmse = 0.170197
Epoch 39
Validation rmse = 0.137719
Epoch 40
Validation rmse = 0.162167
Epoch 41
Loss = 1.7040e-01, PNorm = 34.3832, GNorm = 0.9232, lr_0 = 3.8535e-04
Validation rmse = 0.152378
Epoch 42
Validation rmse = 0.140220
Epoch 43
Validation rmse = 0.187158
Epoch 44
Validation rmse = 0.146818
Epoch 45
Validation rmse = 0.145848
Epoch 46
Loss = 1.5174e-01, PNorm = 34.4071, GNorm = 4.0850, lr_0 = 3.4305e-04
Validation rmse = 0.162973
Epoch 47
Validation rmse = 0.142738
Epoch 48
Validation rmse = 0.160834
Epoch 49
Validation rmse = 0.166951
Epoch 50
Validation rmse = 0.140910
Epoch 51
Loss = 1.4249e-01, PNorm = 34.4301, GNorm = 7.6931, lr_0 = 3.0185e-04
Validation rmse = 0.162873
Epoch 52
Validation rmse = 0.173477
Epoch 53
Validation rmse = 0.141767
Epoch 54
Validation rmse = 0.150363
Epoch 55
Validation rmse = 0.192288
Epoch 56
Loss = 1.4720e-01, PNorm = 34.4477, GNorm = 3.8067, lr_0 = 2.6872e-04
Validation rmse = 0.146061
Epoch 57
Validation rmse = 0.141195
Epoch 58
Validation rmse = 0.181805
Epoch 59
Validation rmse = 0.155840
Epoch 60
Validation rmse = 0.140983
Epoch 61
Loss = 1.2770e-01, PNorm = 34.4628, GNorm = 2.9537, lr_0 = 2.3921e-04
Validation rmse = 0.160409
Epoch 62
Validation rmse = 0.171421
Epoch 63
Validation rmse = 0.148182
Epoch 64
Validation rmse = 0.152330
Epoch 65
Validation rmse = 0.163853
Epoch 66
Validation rmse = 0.160413
Epoch 67
Loss = 5.0375e-02, PNorm = 34.4780, GNorm = 0.7641, lr_0 = 2.1049e-04
Validation rmse = 0.154335
Epoch 68
Validation rmse = 0.152519
Epoch 69
Validation rmse = 0.158832
Epoch 70
Validation rmse = 0.155913
Epoch 71
Validation rmse = 0.158722
Epoch 72
Loss = 1.4635e-01, PNorm = 34.4908, GNorm = 0.7812, lr_0 = 1.8738e-04
Validation rmse = 0.155881
Epoch 73
Validation rmse = 0.156265
Epoch 74
Validation rmse = 0.160026
Epoch 75
Validation rmse = 0.161850
Epoch 76
Validation rmse = 0.153849
Epoch 77
Loss = 1.1731e-01, PNorm = 34.5026, GNorm = 0.6157, lr_0 = 1.6681e-04
Validation rmse = 0.158382
Epoch 78
Validation rmse = 0.164055
Epoch 79
Validation rmse = 0.157093
Epoch 80
Validation rmse = 0.155919
Epoch 81
Validation rmse = 0.159014
Epoch 82
Loss = 8.2704e-02, PNorm = 34.5133, GNorm = 2.2990, lr_0 = 1.4850e-04
Validation rmse = 0.158956
Epoch 83
Validation rmse = 0.162786
Epoch 84
Validation rmse = 0.158825
Epoch 85
Validation rmse = 0.154377
Epoch 86
Validation rmse = 0.160917
Epoch 87
Loss = 9.5211e-02, PNorm = 34.5240, GNorm = 0.6839, lr_0 = 1.3067e-04
Validation rmse = 0.162241
Epoch 88
Validation rmse = 0.159650
Epoch 89
Validation rmse = 0.155770
Epoch 90
Validation rmse = 0.162068
Epoch 91
Validation rmse = 0.161005
Epoch 92
Loss = 9.5127e-02, PNorm = 34.5328, GNorm = 1.8836, lr_0 = 1.1632e-04
Validation rmse = 0.159715
Epoch 93
Validation rmse = 0.157500
Epoch 94
Validation rmse = 0.157446
Epoch 95
Validation rmse = 0.162794
Epoch 96
Validation rmse = 0.164872
Epoch 97
Loss = 9.2737e-02, PNorm = 34.5408, GNorm = 4.7713, lr_0 = 1.0355e-04
Validation rmse = 0.160594
Epoch 98
Validation rmse = 0.154690
Epoch 99
Validation rmse = 0.155313
Epoch 100
Validation rmse = 0.165173
Epoch 101
Validation rmse = 0.169028
Epoch 102
Validation rmse = 0.159139
Epoch 103
Loss = 7.0341e-02, PNorm = 34.5489, GNorm = 2.3780, lr_0 = 1.0000e-04
Validation rmse = 0.154306
Epoch 104
Validation rmse = 0.163418
Epoch 105
Validation rmse = 0.166223
Epoch 106
Validation rmse = 0.162499
Epoch 107
Validation rmse = 0.160292
Epoch 108
Loss = 4.3828e-02, PNorm = 34.5562, GNorm = 0.5245, lr_0 = 1.0000e-04
Validation rmse = 0.157001
Epoch 109
Validation rmse = 0.160554
Epoch 110
Validation rmse = 0.166267
Epoch 111
Validation rmse = 0.160576
Epoch 112
Validation rmse = 0.155910
Epoch 113
Loss = 1.0654e-01, PNorm = 34.5635, GNorm = 2.2189, lr_0 = 1.0000e-04
Validation rmse = 0.160291
Epoch 114
Validation rmse = 0.165361
Epoch 115
Validation rmse = 0.164938
Epoch 116
Validation rmse = 0.159876
Epoch 117
Validation rmse = 0.160872
Epoch 118
Loss = 8.5352e-02, PNorm = 34.5716, GNorm = 1.3321, lr_0 = 1.0000e-04
Validation rmse = 0.163031
Epoch 119
Validation rmse = 0.164118
Epoch 120
Validation rmse = 0.161931
Epoch 121
Validation rmse = 0.160120
Epoch 122
Validation rmse = 0.160646
Epoch 123
Loss = 8.3451e-02, PNorm = 34.5790, GNorm = 2.5923, lr_0 = 1.0000e-04
Validation rmse = 0.164105
Epoch 124
Validation rmse = 0.161111
Epoch 125
Validation rmse = 0.160928
Epoch 126
Validation rmse = 0.161272
Epoch 127
Validation rmse = 0.161318
Epoch 128
Loss = 8.1523e-02, PNorm = 34.5866, GNorm = 1.1551, lr_0 = 1.0000e-04
Validation rmse = 0.164041
Epoch 129
Validation rmse = 0.165878
Epoch 130
Validation rmse = 0.157935
Epoch 131
Validation rmse = 0.162803
Epoch 132
Validation rmse = 0.167986
Epoch 133
Validation rmse = 0.166010
Epoch 134
Loss = 7.2458e-02, PNorm = 34.5950, GNorm = 0.9312, lr_0 = 1.0000e-04
Validation rmse = 0.159912
Epoch 135
Validation rmse = 0.158893
Epoch 136
Validation rmse = 0.166405
Epoch 137
Validation rmse = 0.166093
Epoch 138
Validation rmse = 0.159599
Epoch 139
Loss = 1.0321e-01, PNorm = 34.6028, GNorm = 3.2064, lr_0 = 1.0000e-04
Validation rmse = 0.160031
Epoch 140
Validation rmse = 0.163607
Epoch 141
Validation rmse = 0.167067
Epoch 142
Validation rmse = 0.163658
Epoch 143
Validation rmse = 0.162431
Epoch 144
Loss = 1.0337e-01, PNorm = 34.6104, GNorm = 1.2490, lr_0 = 1.0000e-04
Validation rmse = 0.161263
Epoch 145
Validation rmse = 0.164347
Epoch 146
Validation rmse = 0.165424
Epoch 147
Validation rmse = 0.161542
Epoch 148
Validation rmse = 0.163986
Epoch 149
Loss = 5.2766e-02, PNorm = 34.6180, GNorm = 2.3800, lr_0 = 1.0000e-04
Validation rmse = 0.163481
Epoch 150
Validation rmse = 0.167787
Epoch 151
Validation rmse = 0.164030
Epoch 152
Validation rmse = 0.160700
Epoch 153
Validation rmse = 0.167719
Epoch 154
Loss = 7.5151e-02, PNorm = 34.6267, GNorm = 1.8924, lr_0 = 1.0000e-04
Validation rmse = 0.168742
Epoch 155
Validation rmse = 0.161803
Epoch 156
Validation rmse = 0.163604
Epoch 157
Validation rmse = 0.165837
Epoch 158
Validation rmse = 0.166057
Epoch 159
Loss = 7.1813e-02, PNorm = 34.6346, GNorm = 1.6584, lr_0 = 1.0000e-04
Validation rmse = 0.166552
Epoch 160
Validation rmse = 0.163592
Epoch 161
Validation rmse = 0.162614
Epoch 162
Validation rmse = 0.171154
Epoch 163
Validation rmse = 0.169010
Epoch 164
Loss = 7.0119e-02, PNorm = 34.6425, GNorm = 0.5578, lr_0 = 1.0000e-04
Validation rmse = 0.163215
Epoch 165
Validation rmse = 0.164077
Epoch 166
Validation rmse = 0.170787
Epoch 167
Validation rmse = 0.165883
Epoch 168
Validation rmse = 0.162300
Epoch 169
Validation rmse = 0.166393
Epoch 170
Loss = 1.0274e-01, PNorm = 34.6513, GNorm = 0.4528, lr_0 = 1.0000e-04
Validation rmse = 0.165542
Epoch 171
Validation rmse = 0.164928
Epoch 172
Validation rmse = 0.166542
Epoch 173
Validation rmse = 0.170343
Epoch 174
Validation rmse = 0.161852
Epoch 175
Loss = 4.2875e-02, PNorm = 34.6593, GNorm = 1.3088, lr_0 = 1.0000e-04
Validation rmse = 0.166642
Epoch 176
Validation rmse = 0.171348
Epoch 177
Validation rmse = 0.165740
Epoch 178
Validation rmse = 0.166201
Epoch 179
Validation rmse = 0.165395
Epoch 180
Loss = 9.0350e-02, PNorm = 34.6673, GNorm = 0.5492, lr_0 = 1.0000e-04
Validation rmse = 0.165816
Epoch 181
Validation rmse = 0.169194
Epoch 182
Validation rmse = 0.166501
Epoch 183
Validation rmse = 0.166493
Epoch 184
Validation rmse = 0.164814
Epoch 185
Loss = 6.6790e-02, PNorm = 34.6760, GNorm = 1.2205, lr_0 = 1.0000e-04
Validation rmse = 0.169361
Epoch 186
Validation rmse = 0.166648
Epoch 187
Validation rmse = 0.166718
Epoch 188
Validation rmse = 0.172614
Epoch 189
Validation rmse = 0.165159
Epoch 190
Loss = 6.9612e-02, PNorm = 34.6841, GNorm = 5.6009, lr_0 = 1.0000e-04
Validation rmse = 0.164485
Epoch 191
Validation rmse = 0.175946
Epoch 192
Validation rmse = 0.166690
Epoch 193
Validation rmse = 0.161581
Epoch 194
Validation rmse = 0.169586
Epoch 195
Loss = 6.5092e-02, PNorm = 34.6920, GNorm = 3.3830, lr_0 = 1.0000e-04
Validation rmse = 0.174337
Epoch 196
Validation rmse = 0.164754
Epoch 197
Validation rmse = 0.163022
Epoch 198
Validation rmse = 0.169648
Epoch 199
Validation rmse = 0.172676
Model 0 best validation rmse = 0.121504 on epoch 24
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.106366
Ensemble test rmse = 0.106366
1-fold cross validation
	Seed 0 ==> test rmse = 0.106366
Overall test rmse = 0.106366 +/- 0.000000
Elapsed time = 0:00:22
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_dmf.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 200,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 56 | train size = 44 | val size = 11 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.7732e-01, PNorm = 34.0103, GNorm = 2.3389, lr_0 = 1.0000e-04
Validation rmse = 0.174927
Epoch 1
Validation rmse = 0.179415
Epoch 2
Validation rmse = 0.180121
Epoch 3
Validation rmse = 0.178485
Epoch 4
Validation rmse = 0.176031
Epoch 5
Validation rmse = 0.173997
Epoch 6
Validation rmse = 0.172898
Epoch 7
Validation rmse = 0.172926
Epoch 8
Validation rmse = 0.173892
Epoch 9
Validation rmse = 0.175540
Epoch 10
Validation rmse = 0.177493
Epoch 11
Loss = 7.0701e-01, PNorm = 34.0143, GNorm = 1.2609, lr_0 = 1.0000e-04
Validation rmse = 0.179444
Epoch 12
Validation rmse = 0.180957
Epoch 13
Validation rmse = 0.181851
Epoch 14
Validation rmse = 0.182407
Epoch 15
Validation rmse = 0.182953
Epoch 16
Validation rmse = 0.183919
Epoch 17
Validation rmse = 0.185480
Epoch 18
Validation rmse = 0.187728
Epoch 19
Validation rmse = 0.190460
Epoch 20
Validation rmse = 0.193469
Epoch 21
Validation rmse = 0.196432
Epoch 22
Loss = 4.8609e-01, PNorm = 34.0249, GNorm = 1.0629, lr_0 = 1.0000e-04
Validation rmse = 0.199254
Epoch 23
Validation rmse = 0.201957
Epoch 24
Validation rmse = 0.204658
Epoch 25
Validation rmse = 0.207542
Epoch 26
Validation rmse = 0.210656
Epoch 27
Validation rmse = 0.213781
Epoch 28
Validation rmse = 0.216578
Epoch 29
Validation rmse = 0.218726
Epoch 30
Validation rmse = 0.220092
Epoch 31
Validation rmse = 0.220710
Epoch 32
Validation rmse = 0.220730
Epoch 33
Validation rmse = 0.220192
Epoch 34
Loss = 3.4770e-01, PNorm = 34.0395, GNorm = 0.7174, lr_0 = 1.0000e-04
Validation rmse = 0.218973
Epoch 35
Validation rmse = 0.217284
Epoch 36
Validation rmse = 0.215301
Epoch 37
Validation rmse = 0.212955
Epoch 38
Validation rmse = 0.210251
Epoch 39
Validation rmse = 0.206702
Epoch 40
Validation rmse = 0.203181
Epoch 41
Validation rmse = 0.200155
Epoch 42
Validation rmse = 0.197886
Epoch 43
Validation rmse = 0.195989
Epoch 44
Validation rmse = 0.194058
Epoch 45
Loss = 2.7346e-01, PNorm = 34.0525, GNorm = 0.6274, lr_0 = 1.0000e-04
Validation rmse = 0.192479
Epoch 46
Validation rmse = 0.191769
Epoch 47
Validation rmse = 0.191823
Epoch 48
Validation rmse = 0.192005
Epoch 49
Validation rmse = 0.191530
Epoch 50
Validation rmse = 0.190615
Epoch 51
Validation rmse = 0.189980
Epoch 52
Validation rmse = 0.189619
Epoch 53
Validation rmse = 0.188683
Epoch 54
Validation rmse = 0.186530
Epoch 55
Validation rmse = 0.184321
Epoch 56
Loss = 2.1070e-01, PNorm = 34.0671, GNorm = 0.4877, lr_0 = 1.0000e-04
Validation rmse = 0.182895
Epoch 57
Validation rmse = 0.181345
Epoch 58
Validation rmse = 0.178727
Epoch 59
Validation rmse = 0.176424
Epoch 60
Validation rmse = 0.175558
Epoch 61
Validation rmse = 0.174727
Epoch 62
Validation rmse = 0.172881
Epoch 63
Validation rmse = 0.171653
Epoch 64
Validation rmse = 0.171228
Epoch 65
Validation rmse = 0.169743
Epoch 66
Validation rmse = 0.167819
Epoch 67
Validation rmse = 0.167113
Epoch 68
Loss = 1.5302e-01, PNorm = 34.0857, GNorm = 0.3943, lr_0 = 1.0000e-04
Validation rmse = 0.166006
Epoch 69
Validation rmse = 0.164195
Epoch 70
Validation rmse = 0.162873
Epoch 71
Validation rmse = 0.161921
Epoch 72
Validation rmse = 0.160230
Epoch 73
Validation rmse = 0.159023
Epoch 74
Validation rmse = 0.157726
Epoch 75
Validation rmse = 0.156199
Epoch 76
Validation rmse = 0.155826
Epoch 77
Validation rmse = 0.155239
Epoch 78
Validation rmse = 0.153817
Epoch 79
Loss = 1.0871e-01, PNorm = 34.1055, GNorm = 0.3802, lr_0 = 1.0000e-04
Validation rmse = 0.154858
Epoch 80
Validation rmse = 0.152196
Epoch 81
Validation rmse = 0.153788
Epoch 82
Validation rmse = 0.151597
Epoch 83
Validation rmse = 0.152345
Epoch 84
Validation rmse = 0.150467
Epoch 85
Validation rmse = 0.150705
Epoch 86
Validation rmse = 0.149072
Epoch 87
Validation rmse = 0.150717
Epoch 88
Validation rmse = 0.145820
Epoch 89
Validation rmse = 0.156542
Epoch 90
Loss = 7.7483e-02, PNorm = 34.1258, GNorm = 2.2110, lr_0 = 1.0000e-04
Validation rmse = 0.137600
Epoch 91
Loss = 7.8515e-02, PNorm = 34.1274, GNorm = 3.6179, lr_0 = 1.0000e-04
Validation rmse = 0.162074
Epoch 92
Validation rmse = 0.144710
Epoch 93
Validation rmse = 0.140818
Epoch 94
Validation rmse = 0.159252
Epoch 95
Validation rmse = 0.145599
Epoch 96
Validation rmse = 0.140448
Epoch 97
Validation rmse = 0.156705
Epoch 98
Validation rmse = 0.149575
Epoch 99
Validation rmse = 0.140926
Epoch 100
Validation rmse = 0.153758
Epoch 101
Validation rmse = 0.153119
Epoch 102
Loss = 5.5989e-02, PNorm = 34.1424, GNorm = 1.1970, lr_0 = 1.0000e-04
Validation rmse = 0.141786
Epoch 103
Validation rmse = 0.150106
Epoch 104
Validation rmse = 0.154275
Epoch 105
Validation rmse = 0.142852
Epoch 106
Validation rmse = 0.147287
Epoch 107
Validation rmse = 0.154283
Epoch 108
Validation rmse = 0.144423
Epoch 109
Validation rmse = 0.146123
Epoch 110
Validation rmse = 0.154117
Epoch 111
Validation rmse = 0.145848
Epoch 112
Validation rmse = 0.145709
Epoch 113
Loss = 4.3299e-02, PNorm = 34.1551, GNorm = 0.7806, lr_0 = 1.0000e-04
Validation rmse = 0.153226
Epoch 114
Validation rmse = 0.146482
Epoch 115
Validation rmse = 0.145864
Epoch 116
Validation rmse = 0.152694
Epoch 117
Validation rmse = 0.146785
Epoch 118
Validation rmse = 0.146023
Epoch 119
Validation rmse = 0.152113
Epoch 120
Validation rmse = 0.146591
Epoch 121
Validation rmse = 0.146936
Epoch 122
Validation rmse = 0.152178
Epoch 123
Validation rmse = 0.146503
Epoch 124
Loss = 3.4113e-02, PNorm = 34.1668, GNorm = 0.6642, lr_0 = 1.0000e-04
Validation rmse = 0.148212
Epoch 125
Loss = 3.3266e-02, PNorm = 34.1678, GNorm = 0.2123, lr_0 = 1.0000e-04
Validation rmse = 0.151618
Epoch 126
Validation rmse = 0.146143
Epoch 127
Validation rmse = 0.149646
Epoch 128
Validation rmse = 0.150149
Epoch 129
Validation rmse = 0.146615
Epoch 130
Validation rmse = 0.151016
Epoch 131
Validation rmse = 0.148697
Epoch 132
Validation rmse = 0.148329
Epoch 133
Validation rmse = 0.151438
Epoch 134
Validation rmse = 0.147370
Epoch 135
Validation rmse = 0.151064
Epoch 136
Loss = 2.6438e-02, PNorm = 34.1784, GNorm = 0.4813, lr_0 = 1.0000e-04
Validation rmse = 0.149260
Epoch 137
Validation rmse = 0.149118
Epoch 138
Validation rmse = 0.151203
Epoch 139
Validation rmse = 0.148332
Epoch 140
Validation rmse = 0.150771
Epoch 141
Validation rmse = 0.149785
Epoch 142
Validation rmse = 0.149653
Epoch 143
Validation rmse = 0.151183
Epoch 144
Validation rmse = 0.149037
Epoch 145
Validation rmse = 0.152054
Epoch 146
Validation rmse = 0.148754
Epoch 147
Loss = 2.1189e-02, PNorm = 34.1884, GNorm = 0.5335, lr_0 = 1.0000e-04
Validation rmse = 0.152217
Epoch 148
Validation rmse = 0.149265
Epoch 149
Validation rmse = 0.151697
Epoch 150
Validation rmse = 0.150366
Epoch 151
Validation rmse = 0.150778
Epoch 152
Validation rmse = 0.151135
Epoch 153
Validation rmse = 0.150608
Epoch 154
Validation rmse = 0.151726
Epoch 155
Validation rmse = 0.149903
Epoch 156
Validation rmse = 0.153098
Epoch 157
Validation rmse = 0.149014
Epoch 158
Validation rmse = 0.154773
Epoch 159
Loss = 1.6874e-02, PNorm = 34.1987, GNorm = 0.9660, lr_0 = 1.0000e-04
Validation rmse = 0.147440
Epoch 160
Validation rmse = 0.157187
Epoch 161
Validation rmse = 0.145030
Epoch 162
Validation rmse = 0.160538
Epoch 163
Validation rmse = 0.143292
Epoch 164
Validation rmse = 0.160729
Epoch 165
Validation rmse = 0.146608
Epoch 166
Validation rmse = 0.154213
Epoch 167
Validation rmse = 0.154300
Epoch 168
Validation rmse = 0.147238
Epoch 169
Validation rmse = 0.159254
Epoch 170
Loss = 1.4574e-02, PNorm = 34.2067, GNorm = 2.0061, lr_0 = 1.0000e-04
Validation rmse = 0.145974
Epoch 171
Validation rmse = 0.157209
Epoch 172
Validation rmse = 0.151033
Epoch 173
Validation rmse = 0.151882
Epoch 174
Validation rmse = 0.156261
Epoch 175
Validation rmse = 0.148874
Epoch 176
Validation rmse = 0.158340
Epoch 177
Validation rmse = 0.149266
Epoch 178
Validation rmse = 0.156542
Epoch 179
Validation rmse = 0.152594
Epoch 180
Validation rmse = 0.153000
Epoch 181
Loss = 1.1118e-02, PNorm = 34.2137, GNorm = 0.2434, lr_0 = 1.0000e-04
Validation rmse = 0.156228
Epoch 182
Validation rmse = 0.150789
Epoch 183
Validation rmse = 0.157966
Epoch 184
Validation rmse = 0.150915
Epoch 185
Validation rmse = 0.157964
Epoch 186
Validation rmse = 0.152676
Epoch 187
Validation rmse = 0.156770
Epoch 188
Validation rmse = 0.154591
Epoch 189
Validation rmse = 0.155364
Epoch 190
Validation rmse = 0.156625
Epoch 191
Validation rmse = 0.153211
Epoch 192
Validation rmse = 0.159298
Epoch 193
Loss = 9.2979e-03, PNorm = 34.2209, GNorm = 1.1078, lr_0 = 1.0000e-04
Validation rmse = 0.151035
Epoch 194
Validation rmse = 0.161819
Epoch 195
Validation rmse = 0.150056
Epoch 196
Validation rmse = 0.162336
Epoch 197
Validation rmse = 0.151779
Epoch 198
Validation rmse = 0.160114
Epoch 199
Validation rmse = 0.155552
Model 0 best validation rmse = 0.137600 on epoch 90
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.006070
Ensemble test rmse = 0.006070
1-fold cross validation
	Seed 0 ==> test rmse = 0.006070
Overall test rmse = 0.006070 +/- 0.000000
Elapsed time = 0:00:13
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_dmf.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 200,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 56 | train size = 44 | val size = 11 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.7732e-01, PNorm = 34.0103, GNorm = 2.3389, lr_0 = 1.0000e-04
Validation rmse = 0.174927
Epoch 1
Validation rmse = 0.179415
Epoch 2
Validation rmse = 0.180121
Epoch 3
Validation rmse = 0.178485
Epoch 4
Validation rmse = 0.176031
Epoch 5
Validation rmse = 0.173997
Epoch 6
Validation rmse = 0.172898
Epoch 7
Validation rmse = 0.172926
Epoch 8
Validation rmse = 0.173892
Epoch 9
Validation rmse = 0.175540
Epoch 10
Validation rmse = 0.177493
Epoch 11
Loss = 7.0701e-01, PNorm = 34.0143, GNorm = 1.2609, lr_0 = 1.0000e-04
Validation rmse = 0.179444
Epoch 12
Validation rmse = 0.180957
Epoch 13
Validation rmse = 0.181851
Epoch 14
Validation rmse = 0.182407
Epoch 15
Validation rmse = 0.182953
Epoch 16
Validation rmse = 0.183919
Epoch 17
Validation rmse = 0.185480
Epoch 18
Validation rmse = 0.187728
Epoch 19
Validation rmse = 0.190460
Epoch 20
Validation rmse = 0.193469
Epoch 21
Validation rmse = 0.196432
Epoch 22
Loss = 4.8609e-01, PNorm = 34.0249, GNorm = 1.0629, lr_0 = 1.0000e-04
Validation rmse = 0.199254
Epoch 23
Validation rmse = 0.201957
Epoch 24
Validation rmse = 0.204658
Epoch 25
Validation rmse = 0.207542
Epoch 26
Validation rmse = 0.210656
Epoch 27
Validation rmse = 0.213781
Epoch 28
Validation rmse = 0.216578
Epoch 29
Validation rmse = 0.218726
Epoch 30
Validation rmse = 0.220092
Epoch 31
Validation rmse = 0.220710
Epoch 32
Validation rmse = 0.220730
Epoch 33
Validation rmse = 0.220192
Epoch 34
Loss = 3.4770e-01, PNorm = 34.0395, GNorm = 0.7174, lr_0 = 1.0000e-04
Validation rmse = 0.218973
Epoch 35
Validation rmse = 0.217284
Epoch 36
Validation rmse = 0.215301
Epoch 37
Validation rmse = 0.212955
Epoch 38
Validation rmse = 0.210251
Epoch 39
Validation rmse = 0.206702
Epoch 40
Validation rmse = 0.203181
Epoch 41
Validation rmse = 0.200155
Epoch 42
Validation rmse = 0.197886
Epoch 43
Validation rmse = 0.195989
Epoch 44
Validation rmse = 0.194058
Epoch 45
Loss = 2.7346e-01, PNorm = 34.0525, GNorm = 0.6274, lr_0 = 1.0000e-04
Validation rmse = 0.192479
Epoch 46
Validation rmse = 0.191769
Epoch 47
Validation rmse = 0.191823
Epoch 48
Validation rmse = 0.192005
Epoch 49
Validation rmse = 0.191530
Epoch 50
Validation rmse = 0.190615
Epoch 51
Validation rmse = 0.189980
Epoch 52
Validation rmse = 0.189619
Epoch 53
Validation rmse = 0.188683
Epoch 54
Validation rmse = 0.186530
Epoch 55
Validation rmse = 0.184321
Epoch 56
Loss = 2.1070e-01, PNorm = 34.0671, GNorm = 0.4877, lr_0 = 1.0000e-04
Validation rmse = 0.182895
Epoch 57
Validation rmse = 0.181345
Epoch 58
Validation rmse = 0.178727
Epoch 59
Validation rmse = 0.176424
Epoch 60
Validation rmse = 0.175558
Epoch 61
Validation rmse = 0.174727
Epoch 62
Validation rmse = 0.172881
Epoch 63
Validation rmse = 0.171653
Epoch 64
Validation rmse = 0.171228
Epoch 65
Validation rmse = 0.169743
Epoch 66
Validation rmse = 0.167819
Epoch 67
Validation rmse = 0.167113
Epoch 68
Loss = 1.5302e-01, PNorm = 34.0857, GNorm = 0.3943, lr_0 = 1.0000e-04
Validation rmse = 0.166006
Epoch 69
Validation rmse = 0.164195
Epoch 70
Validation rmse = 0.162873
Epoch 71
Validation rmse = 0.161921
Epoch 72
Validation rmse = 0.160230
Epoch 73
Validation rmse = 0.159023
Epoch 74
Validation rmse = 0.157726
Epoch 75
Validation rmse = 0.156199
Epoch 76
Validation rmse = 0.155826
Epoch 77
Validation rmse = 0.155239
Epoch 78
Validation rmse = 0.153817
Epoch 79
Loss = 1.0871e-01, PNorm = 34.1055, GNorm = 0.3802, lr_0 = 1.0000e-04
Validation rmse = 0.154858
Epoch 80
Validation rmse = 0.152196
Epoch 81
Validation rmse = 0.153788
Epoch 82
Validation rmse = 0.151597
Epoch 83
Validation rmse = 0.152345
Epoch 84
Validation rmse = 0.150467
Epoch 85
Validation rmse = 0.150705
Epoch 86
Validation rmse = 0.149072
Epoch 87
Validation rmse = 0.150717
Epoch 88
Validation rmse = 0.145820
Epoch 89
Validation rmse = 0.156542
Epoch 90
Loss = 7.7483e-02, PNorm = 34.1258, GNorm = 2.2110, lr_0 = 1.0000e-04
Validation rmse = 0.137600
Epoch 91
Loss = 7.8515e-02, PNorm = 34.1274, GNorm = 3.6179, lr_0 = 1.0000e-04
Validation rmse = 0.162074
Epoch 92
Validation rmse = 0.144710
Epoch 93
Validation rmse = 0.140818
Epoch 94
Validation rmse = 0.159252
Epoch 95
Validation rmse = 0.145599
Epoch 96
Validation rmse = 0.140448
Epoch 97
Validation rmse = 0.156705
Epoch 98
Validation rmse = 0.149575
Epoch 99
Validation rmse = 0.140926
Epoch 100
Validation rmse = 0.153758
Epoch 101
Validation rmse = 0.153119
Epoch 102
Loss = 5.5989e-02, PNorm = 34.1424, GNorm = 1.1970, lr_0 = 1.0000e-04
Validation rmse = 0.141786
Epoch 103
Validation rmse = 0.150106
Epoch 104
Validation rmse = 0.154275
Epoch 105
Validation rmse = 0.142852
Epoch 106
Validation rmse = 0.147287
Epoch 107
Validation rmse = 0.154283
Epoch 108
Validation rmse = 0.144423
Epoch 109
Validation rmse = 0.146123
Epoch 110
Validation rmse = 0.154117
Epoch 111
Validation rmse = 0.145848
Epoch 112
Validation rmse = 0.145709
Epoch 113
Loss = 4.3299e-02, PNorm = 34.1551, GNorm = 0.7806, lr_0 = 1.0000e-04
Validation rmse = 0.153226
Epoch 114
Validation rmse = 0.146482
Epoch 115
Validation rmse = 0.145864
Epoch 116
Validation rmse = 0.152694
Epoch 117
Validation rmse = 0.146785
Epoch 118
Validation rmse = 0.146023
Epoch 119
Validation rmse = 0.152113
Epoch 120
Validation rmse = 0.146591
Epoch 121
Validation rmse = 0.146936
Epoch 122
Validation rmse = 0.152178
Epoch 123
Validation rmse = 0.146503
Epoch 124
Loss = 3.4113e-02, PNorm = 34.1668, GNorm = 0.6642, lr_0 = 1.0000e-04
Validation rmse = 0.148212
Epoch 125
Loss = 3.3266e-02, PNorm = 34.1678, GNorm = 0.2123, lr_0 = 1.0000e-04
Validation rmse = 0.151618
Epoch 126
Validation rmse = 0.146143
Epoch 127
Validation rmse = 0.149646
Epoch 128
Validation rmse = 0.150149
Epoch 129
Validation rmse = 0.146615
Epoch 130
Validation rmse = 0.151016
Epoch 131
Validation rmse = 0.148697
Epoch 132
Validation rmse = 0.148329
Epoch 133
Validation rmse = 0.151438
Epoch 134
Validation rmse = 0.147370
Epoch 135
Validation rmse = 0.151064
Epoch 136
Loss = 2.6438e-02, PNorm = 34.1784, GNorm = 0.4813, lr_0 = 1.0000e-04
Validation rmse = 0.149260
Epoch 137
Validation rmse = 0.149118
Epoch 138
Validation rmse = 0.151203
Epoch 139
Validation rmse = 0.148332
Epoch 140
Validation rmse = 0.150771
Epoch 141
Validation rmse = 0.149785
Epoch 142
Validation rmse = 0.149653
Epoch 143
Validation rmse = 0.151183
Epoch 144
Validation rmse = 0.149037
Epoch 145
Validation rmse = 0.152054
Epoch 146
Validation rmse = 0.148754
Epoch 147
Loss = 2.1189e-02, PNorm = 34.1884, GNorm = 0.5335, lr_0 = 1.0000e-04
Validation rmse = 0.152217
Epoch 148
Validation rmse = 0.149265
Epoch 149
Validation rmse = 0.151697
Epoch 150
Validation rmse = 0.150366
Epoch 151
Validation rmse = 0.150778
Epoch 152
Validation rmse = 0.151135
Epoch 153
Validation rmse = 0.150608
Epoch 154
Validation rmse = 0.151726
Epoch 155
Validation rmse = 0.149903
Epoch 156
Validation rmse = 0.153098
Epoch 157
Validation rmse = 0.149014
Epoch 158
Validation rmse = 0.154773
Epoch 159
Loss = 1.6874e-02, PNorm = 34.1987, GNorm = 0.9660, lr_0 = 1.0000e-04
Validation rmse = 0.147440
Epoch 160
Validation rmse = 0.157187
Epoch 161
Validation rmse = 0.145030
Epoch 162
Validation rmse = 0.160538
Epoch 163
Validation rmse = 0.143292
Epoch 164
Validation rmse = 0.160729
Epoch 165
Validation rmse = 0.146608
Epoch 166
Validation rmse = 0.154213
Epoch 167
Validation rmse = 0.154300
Epoch 168
Validation rmse = 0.147238
Epoch 169
Validation rmse = 0.159254
Epoch 170
Loss = 1.4574e-02, PNorm = 34.2067, GNorm = 2.0061, lr_0 = 1.0000e-04
Validation rmse = 0.145974
Epoch 171
Validation rmse = 0.157209
Epoch 172
Validation rmse = 0.151033
Epoch 173
Validation rmse = 0.151882
Epoch 174
Validation rmse = 0.156261
Epoch 175
Validation rmse = 0.148874
Epoch 176
Validation rmse = 0.158340
Epoch 177
Validation rmse = 0.149266
Epoch 178
Validation rmse = 0.156542
Epoch 179
Validation rmse = 0.152594
Epoch 180
Validation rmse = 0.153000
Epoch 181
Loss = 1.1118e-02, PNorm = 34.2137, GNorm = 0.2434, lr_0 = 1.0000e-04
Validation rmse = 0.156228
Epoch 182
Validation rmse = 0.150789
Epoch 183
Validation rmse = 0.157966
Epoch 184
Validation rmse = 0.150915
Epoch 185
Validation rmse = 0.157964
Epoch 186
Validation rmse = 0.152676
Epoch 187
Validation rmse = 0.156770
Epoch 188
Validation rmse = 0.154591
Epoch 189
Validation rmse = 0.155364
Epoch 190
Validation rmse = 0.156625
Epoch 191
Validation rmse = 0.153211
Epoch 192
Validation rmse = 0.159298
Epoch 193
Loss = 9.2979e-03, PNorm = 34.2209, GNorm = 1.1078, lr_0 = 1.0000e-04
Validation rmse = 0.151035
Epoch 194
Validation rmse = 0.161819
Epoch 195
Validation rmse = 0.150056
Epoch 196
Validation rmse = 0.162336
Epoch 197
Validation rmse = 0.151779
Epoch 198
Validation rmse = 0.160114
Epoch 199
Validation rmse = 0.155552
Model 0 best validation rmse = 0.137600 on epoch 90
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.006070
Ensemble test rmse = 0.006070
1-fold cross validation
	Seed 0 ==> test rmse = 0.006070
Overall test rmse = 0.006070 +/- 0.000000
Elapsed time = 0:00:12
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_dmf.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 80,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 123 | train size = 97 | val size = 25 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.221631
Epoch 1
Validation rmse = 0.267964
Epoch 2
Validation rmse = 0.216312
Epoch 3
Validation rmse = 0.208283
Epoch 4
Validation rmse = 0.213848
Epoch 5
Loss = 6.1724e-01, PNorm = 34.0483, GNorm = 0.8562, lr_0 = 7.4438e-04
Validation rmse = 0.229854
Epoch 6
Validation rmse = 0.208791
Epoch 7
Validation rmse = 0.203919
Epoch 8
Validation rmse = 0.211492
Epoch 9
Validation rmse = 0.192939
Epoch 10
Loss = 5.7993e-01, PNorm = 34.1033, GNorm = 1.7102, lr_0 = 5.5410e-04
Validation rmse = 0.192364
Epoch 11
Validation rmse = 0.177125
Epoch 12
Validation rmse = 0.165269
Epoch 13
Validation rmse = 0.155138
Epoch 14
Validation rmse = 0.166479
Epoch 15
Loss = 3.8534e-01, PNorm = 34.1471, GNorm = 2.5072, lr_0 = 4.1246e-04
Validation rmse = 0.136776
Epoch 16
Validation rmse = 0.136673
Epoch 17
Validation rmse = 0.143111
Epoch 18
Validation rmse = 0.128610
Epoch 19
Validation rmse = 0.137100
Epoch 20
Loss = 3.2445e-01, PNorm = 34.1770, GNorm = 1.4107, lr_0 = 2.9810e-04
Validation rmse = 0.142650
Epoch 21
Validation rmse = 0.130826
Epoch 22
Validation rmse = 0.130277
Epoch 23
Validation rmse = 0.159300
Epoch 24
Validation rmse = 0.138591
Epoch 25
Loss = 2.9044e-01, PNorm = 34.1953, GNorm = 3.6943, lr_0 = 2.2190e-04
Validation rmse = 0.123704
Epoch 26
Validation rmse = 0.141137
Epoch 27
Validation rmse = 0.147732
Epoch 28
Validation rmse = 0.131266
Epoch 29
Validation rmse = 0.134724
Epoch 30
Loss = 2.6055e-01, PNorm = 34.2087, GNorm = 1.3272, lr_0 = 1.6518e-04
Validation rmse = 0.142114
Epoch 31
Validation rmse = 0.144293
Epoch 32
Validation rmse = 0.135831
Epoch 33
Validation rmse = 0.130025
Epoch 34
Validation rmse = 0.143847
Epoch 35
Validation rmse = 0.152380
Epoch 36
Loss = 2.8151e-01, PNorm = 34.2199, GNorm = 0.7828, lr_0 = 1.1938e-04
Validation rmse = 0.145195
Epoch 37
Validation rmse = 0.130118
Epoch 38
Validation rmse = 0.133265
Epoch 39
Validation rmse = 0.141670
Epoch 40
Validation rmse = 0.149882
Epoch 41
Loss = 2.5869e-01, PNorm = 34.2277, GNorm = 0.7045, lr_0 = 1.0000e-04
Validation rmse = 0.146689
Epoch 42
Validation rmse = 0.133210
Epoch 43
Validation rmse = 0.134766
Epoch 44
Validation rmse = 0.150508
Epoch 45
Validation rmse = 0.156234
Epoch 46
Loss = 2.0141e-01, PNorm = 34.2351, GNorm = 1.0575, lr_0 = 1.0000e-04
Validation rmse = 0.141447
Epoch 47
Validation rmse = 0.129146
Epoch 48
Validation rmse = 0.135601
Epoch 49
Validation rmse = 0.158803
Epoch 50
Validation rmse = 0.156669
Epoch 51
Loss = 2.1983e-01, PNorm = 34.2433, GNorm = 4.8868, lr_0 = 1.0000e-04
Validation rmse = 0.135938
Epoch 52
Validation rmse = 0.136576
Epoch 53
Validation rmse = 0.149598
Epoch 54
Validation rmse = 0.145263
Epoch 55
Validation rmse = 0.144495
Epoch 56
Loss = 1.9658e-01, PNorm = 34.2505, GNorm = 1.1367, lr_0 = 1.0000e-04
Validation rmse = 0.146655
Epoch 57
Validation rmse = 0.143619
Epoch 58
Validation rmse = 0.146926
Epoch 59
Validation rmse = 0.144965
Epoch 60
Validation rmse = 0.141686
Epoch 61
Loss = 1.8912e-01, PNorm = 34.2583, GNorm = 1.0834, lr_0 = 1.0000e-04
Validation rmse = 0.146107
Epoch 62
Validation rmse = 0.149910
Epoch 63
Validation rmse = 0.144015
Epoch 64
Validation rmse = 0.148662
Epoch 65
Validation rmse = 0.146386
Epoch 66
Validation rmse = 0.148920
Epoch 67
Loss = 9.9392e-02, PNorm = 34.2669, GNorm = 0.8748, lr_0 = 1.0000e-04
Validation rmse = 0.152038
Epoch 68
Validation rmse = 0.144766
Epoch 69
Validation rmse = 0.144388
Epoch 70
Validation rmse = 0.145316
Epoch 71
Validation rmse = 0.155950
Epoch 72
Loss = 2.3432e-01, PNorm = 34.2750, GNorm = 2.6258, lr_0 = 1.0000e-04
Validation rmse = 0.147358
Epoch 73
Validation rmse = 0.142350
Epoch 74
Validation rmse = 0.151804
Epoch 75
Validation rmse = 0.161820
Epoch 76
Validation rmse = 0.144210
Epoch 77
Loss = 1.6978e-01, PNorm = 34.2832, GNorm = 0.8404, lr_0 = 1.0000e-04
Validation rmse = 0.143772
Epoch 78
Validation rmse = 0.156886
Epoch 79
Validation rmse = 0.154275
Model 0 best validation rmse = 0.123704 on epoch 25
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.127313
Ensemble test rmse = 0.127313
1-fold cross validation
	Seed 0 ==> test rmse = 0.127313
Overall test rmse = 0.127313 +/- 0.000000
Elapsed time = 0:00:09
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_dmf.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 200,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 123 | train size = 97 | val size = 25 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.221631
Epoch 1
Validation rmse = 0.268236
Epoch 2
Validation rmse = 0.214970
Epoch 3
Validation rmse = 0.208340
Epoch 4
Validation rmse = 0.217279
Epoch 5
Loss = 6.1884e-01, PNorm = 34.0534, GNorm = 1.1043, lr_0 = 8.9022e-04
Validation rmse = 0.231351
Epoch 6
Validation rmse = 0.205464
Epoch 7
Validation rmse = 0.207996
Epoch 8
Validation rmse = 0.204458
Epoch 9
Validation rmse = 0.184270
Epoch 10
Loss = 5.5312e-01, PNorm = 34.1246, GNorm = 2.7390, lr_0 = 7.9248e-04
Validation rmse = 0.203675
Epoch 11
Validation rmse = 0.161855
Epoch 12
Validation rmse = 0.166359
Epoch 13
Validation rmse = 0.148465
Epoch 14
Validation rmse = 0.146071
Epoch 15
Loss = 3.4704e-01, PNorm = 34.1855, GNorm = 0.5357, lr_0 = 7.0548e-04
Validation rmse = 0.131808
Epoch 16
Validation rmse = 0.126033
Epoch 17
Validation rmse = 0.135347
Epoch 18
Validation rmse = 0.127341
Epoch 19
Validation rmse = 0.139478
Epoch 20
Loss = 2.8290e-01, PNorm = 34.2424, GNorm = 2.7332, lr_0 = 6.2077e-04
Validation rmse = 0.131647
Epoch 21
Validation rmse = 0.131318
Epoch 22
Validation rmse = 0.140973
Epoch 23
Validation rmse = 0.171363
Epoch 24
Validation rmse = 0.121504
Epoch 25
Loss = 2.4430e-01, PNorm = 34.2828, GNorm = 2.6536, lr_0 = 5.5262e-04
Validation rmse = 0.169266
Epoch 26
Validation rmse = 0.138565
Epoch 27
Validation rmse = 0.138685
Epoch 28
Validation rmse = 0.168103
Epoch 29
Validation rmse = 0.133124
Epoch 30
Loss = 2.0904e-01, PNorm = 34.3192, GNorm = 4.7196, lr_0 = 4.9195e-04
Validation rmse = 0.151620
Epoch 31
Validation rmse = 0.155119
Epoch 32
Validation rmse = 0.131929
Epoch 33
Validation rmse = 0.171558
Epoch 34
Validation rmse = 0.147470
Epoch 35
Validation rmse = 0.147975
Epoch 36
Loss = 1.8543e-01, PNorm = 34.3556, GNorm = 2.4692, lr_0 = 4.3288e-04
Validation rmse = 0.155713
Epoch 37
Validation rmse = 0.134348
Epoch 38
Validation rmse = 0.170197
Epoch 39
Validation rmse = 0.137719
Epoch 40
Validation rmse = 0.162167
Epoch 41
Loss = 1.7040e-01, PNorm = 34.3832, GNorm = 0.9232, lr_0 = 3.8535e-04
Validation rmse = 0.152378
Epoch 42
Validation rmse = 0.140220
Epoch 43
Validation rmse = 0.187158
Epoch 44
Validation rmse = 0.146818
Epoch 45
Validation rmse = 0.145848
Epoch 46
Loss = 1.5174e-01, PNorm = 34.4071, GNorm = 4.0850, lr_0 = 3.4305e-04
Validation rmse = 0.162973
Epoch 47
Validation rmse = 0.142738
Epoch 48
Validation rmse = 0.160834
Epoch 49
Validation rmse = 0.166951
Epoch 50
Validation rmse = 0.140910
Epoch 51
Loss = 1.4249e-01, PNorm = 34.4301, GNorm = 7.6931, lr_0 = 3.0185e-04
Validation rmse = 0.162873
Epoch 52
Validation rmse = 0.173477
Epoch 53
Validation rmse = 0.141767
Epoch 54
Validation rmse = 0.150363
Epoch 55
Validation rmse = 0.192288
Epoch 56
Loss = 1.4720e-01, PNorm = 34.4477, GNorm = 3.8067, lr_0 = 2.6872e-04
Validation rmse = 0.146061
Epoch 57
Validation rmse = 0.141195
Epoch 58
Validation rmse = 0.181805
Epoch 59
Validation rmse = 0.155840
Epoch 60
Validation rmse = 0.140983
Epoch 61
Loss = 1.2770e-01, PNorm = 34.4628, GNorm = 2.9537, lr_0 = 2.3921e-04
Validation rmse = 0.160409
Epoch 62
Validation rmse = 0.171421
Epoch 63
Validation rmse = 0.148182
Epoch 64
Validation rmse = 0.152330
Epoch 65
Validation rmse = 0.163853
Epoch 66
Validation rmse = 0.160413
Epoch 67
Loss = 5.0375e-02, PNorm = 34.4780, GNorm = 0.7641, lr_0 = 2.1049e-04
Validation rmse = 0.154335
Epoch 68
Validation rmse = 0.152519
Epoch 69
Validation rmse = 0.158832
Epoch 70
Validation rmse = 0.155913
Epoch 71
Validation rmse = 0.158722
Epoch 72
Loss = 1.4635e-01, PNorm = 34.4908, GNorm = 0.7812, lr_0 = 1.8738e-04
Validation rmse = 0.155881
Epoch 73
Validation rmse = 0.156265
Epoch 74
Validation rmse = 0.160026
Epoch 75
Validation rmse = 0.161850
Epoch 76
Validation rmse = 0.153849
Epoch 77
Loss = 1.1731e-01, PNorm = 34.5026, GNorm = 0.6157, lr_0 = 1.6681e-04
Validation rmse = 0.158382
Epoch 78
Validation rmse = 0.164055
Epoch 79
Validation rmse = 0.157093
Epoch 80
Validation rmse = 0.155919
Epoch 81
Validation rmse = 0.159014
Epoch 82
Loss = 8.2704e-02, PNorm = 34.5133, GNorm = 2.2990, lr_0 = 1.4850e-04
Validation rmse = 0.158956
Epoch 83
Validation rmse = 0.162786
Epoch 84
Validation rmse = 0.158825
Epoch 85
Validation rmse = 0.154377
Epoch 86
Validation rmse = 0.160917
Epoch 87
Loss = 9.5211e-02, PNorm = 34.5240, GNorm = 0.6839, lr_0 = 1.3067e-04
Validation rmse = 0.162241
Epoch 88
Validation rmse = 0.159650
Epoch 89
Validation rmse = 0.155770
Epoch 90
Validation rmse = 0.162068
Epoch 91
Validation rmse = 0.161005
Epoch 92
Loss = 9.5127e-02, PNorm = 34.5328, GNorm = 1.8836, lr_0 = 1.1632e-04
Validation rmse = 0.159715
Epoch 93
Validation rmse = 0.157500
Epoch 94
Validation rmse = 0.157446
Epoch 95
Validation rmse = 0.162794
Epoch 96
Validation rmse = 0.164872
Epoch 97
Loss = 9.2737e-02, PNorm = 34.5408, GNorm = 4.7713, lr_0 = 1.0355e-04
Validation rmse = 0.160594
Epoch 98
Validation rmse = 0.154690
Epoch 99
Validation rmse = 0.155313
Epoch 100
Validation rmse = 0.165173
Epoch 101
Validation rmse = 0.169028
Epoch 102
Validation rmse = 0.159139
Epoch 103
Loss = 7.0341e-02, PNorm = 34.5489, GNorm = 2.3780, lr_0 = 1.0000e-04
Validation rmse = 0.154306
Epoch 104
Validation rmse = 0.163418
Epoch 105
Validation rmse = 0.166223
Epoch 106
Validation rmse = 0.162499
Epoch 107
Validation rmse = 0.160292
Epoch 108
Loss = 4.3828e-02, PNorm = 34.5562, GNorm = 0.5245, lr_0 = 1.0000e-04
Validation rmse = 0.157001
Epoch 109
Validation rmse = 0.160554
Epoch 110
Validation rmse = 0.166267
Epoch 111
Validation rmse = 0.160576
Epoch 112
Validation rmse = 0.155910
Epoch 113
Loss = 1.0654e-01, PNorm = 34.5635, GNorm = 2.2189, lr_0 = 1.0000e-04
Validation rmse = 0.160291
Epoch 114
Validation rmse = 0.165361
Epoch 115
Validation rmse = 0.164938
Epoch 116
Validation rmse = 0.159876
Epoch 117
Validation rmse = 0.160872
Epoch 118
Loss = 8.5352e-02, PNorm = 34.5716, GNorm = 1.3321, lr_0 = 1.0000e-04
Validation rmse = 0.163031
Epoch 119
Validation rmse = 0.164118
Epoch 120
Validation rmse = 0.161931
Epoch 121
Validation rmse = 0.160120
Epoch 122
Validation rmse = 0.160646
Epoch 123
Loss = 8.3451e-02, PNorm = 34.5790, GNorm = 2.5923, lr_0 = 1.0000e-04
Validation rmse = 0.164105
Epoch 124
Validation rmse = 0.161111
Epoch 125
Validation rmse = 0.160928
Epoch 126
Validation rmse = 0.161272
Epoch 127
Validation rmse = 0.161318
Epoch 128
Loss = 8.1523e-02, PNorm = 34.5866, GNorm = 1.1551, lr_0 = 1.0000e-04
Validation rmse = 0.164041
Epoch 129
Validation rmse = 0.165878
Epoch 130
Validation rmse = 0.157935
Epoch 131
Validation rmse = 0.162803
Epoch 132
Validation rmse = 0.167986
Epoch 133
Validation rmse = 0.166010
Epoch 134
Loss = 7.2458e-02, PNorm = 34.5950, GNorm = 0.9312, lr_0 = 1.0000e-04
Validation rmse = 0.159912
Epoch 135
Validation rmse = 0.158893
Epoch 136
Validation rmse = 0.166405
Epoch 137
Validation rmse = 0.166093
Epoch 138
Validation rmse = 0.159599
Epoch 139
Loss = 1.0321e-01, PNorm = 34.6028, GNorm = 3.2064, lr_0 = 1.0000e-04
Validation rmse = 0.160031
Epoch 140
Validation rmse = 0.163607
Epoch 141
Validation rmse = 0.167067
Epoch 142
Validation rmse = 0.163658
Epoch 143
Validation rmse = 0.162431
Epoch 144
Loss = 1.0337e-01, PNorm = 34.6104, GNorm = 1.2490, lr_0 = 1.0000e-04
Validation rmse = 0.161263
Epoch 145
Validation rmse = 0.164347
Epoch 146
Validation rmse = 0.165424
Epoch 147
Validation rmse = 0.161542
Epoch 148
Validation rmse = 0.163986
Epoch 149
Loss = 5.2766e-02, PNorm = 34.6180, GNorm = 2.3800, lr_0 = 1.0000e-04
Validation rmse = 0.163481
Epoch 150
Validation rmse = 0.167787
Epoch 151
Validation rmse = 0.164030
Epoch 152
Validation rmse = 0.160700
Epoch 153
Validation rmse = 0.167719
Epoch 154
Loss = 7.5151e-02, PNorm = 34.6267, GNorm = 1.8924, lr_0 = 1.0000e-04
Validation rmse = 0.168742
Epoch 155
Validation rmse = 0.161803
Epoch 156
Validation rmse = 0.163604
Epoch 157
Validation rmse = 0.165837
Epoch 158
Validation rmse = 0.166057
Epoch 159
Loss = 7.1813e-02, PNorm = 34.6346, GNorm = 1.6584, lr_0 = 1.0000e-04
Validation rmse = 0.166552
Epoch 160
Validation rmse = 0.163592
Epoch 161
Validation rmse = 0.162614
Epoch 162
Validation rmse = 0.171154
Epoch 163
Validation rmse = 0.169010
Epoch 164
Loss = 7.0119e-02, PNorm = 34.6425, GNorm = 0.5578, lr_0 = 1.0000e-04
Validation rmse = 0.163215
Epoch 165
Validation rmse = 0.164077
Epoch 166
Validation rmse = 0.170787
Epoch 167
Validation rmse = 0.165883
Epoch 168
Validation rmse = 0.162300
Epoch 169
Validation rmse = 0.166393
Epoch 170
Loss = 1.0274e-01, PNorm = 34.6513, GNorm = 0.4528, lr_0 = 1.0000e-04
Validation rmse = 0.165542
Epoch 171
Validation rmse = 0.164928
Epoch 172
Validation rmse = 0.166542
Epoch 173
Validation rmse = 0.170343
Epoch 174
Validation rmse = 0.161852
Epoch 175
Loss = 4.2875e-02, PNorm = 34.6593, GNorm = 1.3088, lr_0 = 1.0000e-04
Validation rmse = 0.166642
Epoch 176
Validation rmse = 0.171348
Epoch 177
Validation rmse = 0.165740
Epoch 178
Validation rmse = 0.166201
Epoch 179
Validation rmse = 0.165395
Epoch 180
Loss = 9.0350e-02, PNorm = 34.6673, GNorm = 0.5492, lr_0 = 1.0000e-04
Validation rmse = 0.165816
Epoch 181
Validation rmse = 0.169194
Epoch 182
Validation rmse = 0.166501
Epoch 183
Validation rmse = 0.166493
Epoch 184
Validation rmse = 0.164814
Epoch 185
Loss = 6.6790e-02, PNorm = 34.6760, GNorm = 1.2205, lr_0 = 1.0000e-04
Validation rmse = 0.169361
Epoch 186
Validation rmse = 0.166648
Epoch 187
Validation rmse = 0.166718
Epoch 188
Validation rmse = 0.172614
Epoch 189
Validation rmse = 0.165159
Epoch 190
Loss = 6.9612e-02, PNorm = 34.6841, GNorm = 5.6009, lr_0 = 1.0000e-04
Validation rmse = 0.164485
Epoch 191
Validation rmse = 0.175946
Epoch 192
Validation rmse = 0.166690
Epoch 193
Validation rmse = 0.161581
Epoch 194
Validation rmse = 0.169586
Epoch 195
Loss = 6.5092e-02, PNorm = 34.6920, GNorm = 3.3830, lr_0 = 1.0000e-04
Validation rmse = 0.174337
Epoch 196
Validation rmse = 0.164754
Epoch 197
Validation rmse = 0.163022
Epoch 198
Validation rmse = 0.169648
Epoch 199
Validation rmse = 0.172676
Model 0 best validation rmse = 0.121504 on epoch 24
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.106366
Ensemble test rmse = 0.106366
1-fold cross validation
	Seed 0 ==> test rmse = 0.106366
Overall test rmse = 0.106366 +/- 0.000000
Elapsed time = 0:00:21
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_dmf.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 200,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 118 | train size = 93 | val size = 24 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.251015
Epoch 1
Validation rmse = 0.235487
Epoch 2
Validation rmse = 0.184606
Epoch 3
Validation rmse = 0.185105
Epoch 4
Validation rmse = 0.181914
Epoch 5
Loss = 5.9705e-01, PNorm = 34.0618, GNorm = 2.0680, lr_0 = 8.9022e-04
Validation rmse = 0.148918
Epoch 6
Validation rmse = 0.143833
Epoch 7
Validation rmse = 0.182480
Epoch 8
Validation rmse = 0.161999
Epoch 9
Validation rmse = 0.213846
Epoch 10
Loss = 4.3857e-01, PNorm = 34.1437, GNorm = 13.1733, lr_0 = 7.8332e-04
Validation rmse = 0.170333
Epoch 11
Validation rmse = 0.160351
Epoch 12
Validation rmse = 0.201758
Epoch 13
Validation rmse = 0.150291
Epoch 14
Validation rmse = 0.149382
Epoch 15
Validation rmse = 0.167230
Epoch 16
Loss = 2.9087e-01, PNorm = 34.1848, GNorm = 6.8381, lr_0 = 6.8926e-04
Validation rmse = 0.146175
Epoch 17
Validation rmse = 0.150427
Epoch 18
Validation rmse = 0.152643
Epoch 19
Validation rmse = 0.150814
Epoch 20
Validation rmse = 0.155894
Epoch 21
Loss = 1.5421e-01, PNorm = 34.2241, GNorm = 0.5520, lr_0 = 6.1359e-04
Loss = 2.1298e-01, PNorm = 34.2280, GNorm = 4.2183, lr_0 = 6.0650e-04
Validation rmse = 0.149093
Epoch 22
Validation rmse = 0.149367
Epoch 23
Validation rmse = 0.150046
Epoch 24
Validation rmse = 0.144891
Epoch 25
Validation rmse = 0.146297
Epoch 26
Loss = 1.4023e-01, PNorm = 34.2662, GNorm = 3.9727, lr_0 = 5.3991e-04
Validation rmse = 0.142611
Epoch 27
Validation rmse = 0.147176
Epoch 28
Validation rmse = 0.134559
Epoch 29
Validation rmse = 0.158881
Epoch 30
Validation rmse = 0.133616
Epoch 31
Validation rmse = 0.147262
Epoch 32
Loss = 1.0097e-01, PNorm = 34.3019, GNorm = 2.4925, lr_0 = 4.7508e-04
Validation rmse = 0.137926
Epoch 33
Validation rmse = 0.128520
Epoch 34
Validation rmse = 0.159541
Epoch 35
Validation rmse = 0.125812
Epoch 36
Validation rmse = 0.140202
Epoch 37
Loss = 9.4137e-02, PNorm = 34.3289, GNorm = 1.8674, lr_0 = 4.1803e-04
Validation rmse = 0.147984
Epoch 38
Validation rmse = 0.127543
Epoch 39
Validation rmse = 0.140686
Epoch 40
Validation rmse = 0.133756
Epoch 41
Validation rmse = 0.127990
Epoch 42
Validation rmse = 0.136657
Epoch 43
Loss = 4.1334e-02, PNorm = 34.3535, GNorm = 1.2779, lr_0 = 3.6784e-04
Validation rmse = 0.131962
Epoch 44
Validation rmse = 0.128616
Epoch 45
Validation rmse = 0.131484
Epoch 46
Validation rmse = 0.128564
Epoch 47
Validation rmse = 0.129049
Epoch 48
Loss = 7.7469e-02, PNorm = 34.3742, GNorm = 1.1466, lr_0 = 3.2745e-04
Validation rmse = 0.127467
Epoch 49
Validation rmse = 0.126112
Epoch 50
Validation rmse = 0.131204
Epoch 51
Validation rmse = 0.127087
Epoch 52
Validation rmse = 0.124631
Epoch 53
Loss = 6.1649e-02, PNorm = 34.3956, GNorm = 0.3244, lr_0 = 2.8813e-04
Validation rmse = 0.126596
Epoch 54
Validation rmse = 0.126410
Epoch 55
Validation rmse = 0.122849
Epoch 56
Validation rmse = 0.121303
Epoch 57
Validation rmse = 0.125282
Epoch 58
Validation rmse = 0.127278
Epoch 59
Loss = 5.9303e-02, PNorm = 34.4149, GNorm = 1.6143, lr_0 = 2.5354e-04
Validation rmse = 0.119025
Epoch 60
Validation rmse = 0.128520
Epoch 61
Validation rmse = 0.124161
Epoch 62
Validation rmse = 0.118229
Epoch 63
Validation rmse = 0.123486
Epoch 64
Loss = 5.9697e-02, PNorm = 34.4307, GNorm = 0.8712, lr_0 = 2.2570e-04
Loss = 3.7380e-02, PNorm = 34.4321, GNorm = 1.7536, lr_0 = 2.2309e-04
Validation rmse = 0.118609
Epoch 65
Validation rmse = 0.120285
Epoch 66
Validation rmse = 0.127850
Epoch 67
Validation rmse = 0.112108
Epoch 68
Validation rmse = 0.122031
Epoch 69
Loss = 4.8748e-02, PNorm = 34.4458, GNorm = 3.9386, lr_0 = 1.9860e-04
Validation rmse = 0.120702
Epoch 70
Validation rmse = 0.111161
Epoch 71
Validation rmse = 0.120790
Epoch 72
Validation rmse = 0.122440
Epoch 73
Validation rmse = 0.109829
Epoch 74
Validation rmse = 0.126585
Epoch 75
Loss = 4.5659e-02, PNorm = 34.4584, GNorm = 3.2198, lr_0 = 1.7475e-04
Validation rmse = 0.114079
Epoch 76
Validation rmse = 0.110233
Epoch 77
Validation rmse = 0.124494
Epoch 78
Validation rmse = 0.111116
Epoch 79
Validation rmse = 0.110503
Epoch 80
Loss = 4.0638e-02, PNorm = 34.4688, GNorm = 2.1130, lr_0 = 1.5377e-04
Validation rmse = 0.126099
Epoch 81
Validation rmse = 0.110129
Epoch 82
Validation rmse = 0.108745
Epoch 83
Validation rmse = 0.120023
Epoch 84
Validation rmse = 0.113534
Epoch 85
Validation rmse = 0.107094
Epoch 86
Loss = 3.0170e-02, PNorm = 34.4776, GNorm = 1.9514, lr_0 = 1.3530e-04
Validation rmse = 0.112608
Epoch 87
Validation rmse = 0.118577
Epoch 88
Validation rmse = 0.111108
Epoch 89
Validation rmse = 0.107503
Epoch 90
Validation rmse = 0.111056
Epoch 91
Loss = 3.7364e-02, PNorm = 34.4845, GNorm = 0.3508, lr_0 = 1.2045e-04
Validation rmse = 0.114868
Epoch 92
Validation rmse = 0.110904
Epoch 93
Validation rmse = 0.106765
Epoch 94
Validation rmse = 0.112749
Epoch 95
Validation rmse = 0.114931
Epoch 96
Loss = 3.4117e-02, PNorm = 34.4912, GNorm = 1.0401, lr_0 = 1.0599e-04
Validation rmse = 0.108284
Epoch 97
Validation rmse = 0.107752
Epoch 98
Validation rmse = 0.112368
Epoch 99
Validation rmse = 0.108492
Epoch 100
Validation rmse = 0.106572
Epoch 101
Validation rmse = 0.112561
Epoch 102
Loss = 1.9812e-02, PNorm = 34.4972, GNorm = 1.4935, lr_0 = 1.0000e-04
Validation rmse = 0.112543
Epoch 103
Validation rmse = 0.108245
Epoch 104
Validation rmse = 0.109110
Epoch 105
Validation rmse = 0.110830
Epoch 106
Validation rmse = 0.107334
Epoch 107
Loss = 4.6861e-02, PNorm = 34.5026, GNorm = 1.6643, lr_0 = 1.0000e-04
Loss = 1.4388e-02, PNorm = 34.5031, GNorm = 0.9914, lr_0 = 1.0000e-04
Validation rmse = 0.107921
Epoch 108
Validation rmse = 0.108648
Epoch 109
Validation rmse = 0.109248
Epoch 110
Validation rmse = 0.107090
Epoch 111
Validation rmse = 0.108252
Epoch 112
Loss = 3.1361e-02, PNorm = 34.5084, GNorm = 2.8902, lr_0 = 1.0000e-04
Validation rmse = 0.109500
Epoch 113
Validation rmse = 0.110708
Epoch 114
Validation rmse = 0.106610
Epoch 115
Validation rmse = 0.105913
Epoch 116
Validation rmse = 0.110380
Epoch 117
Validation rmse = 0.105149
Epoch 118
Loss = 3.2274e-02, PNorm = 34.5142, GNorm = 2.2545, lr_0 = 1.0000e-04
Validation rmse = 0.106460
Epoch 119
Validation rmse = 0.107034
Epoch 120
Validation rmse = 0.106255
Epoch 121
Validation rmse = 0.109326
Epoch 122
Validation rmse = 0.106165
Epoch 123
Loss = 2.8512e-02, PNorm = 34.5200, GNorm = 0.9397, lr_0 = 1.0000e-04
Validation rmse = 0.103020
Epoch 124
Validation rmse = 0.107989
Epoch 125
Validation rmse = 0.110608
Epoch 126
Validation rmse = 0.103961
Epoch 127
Validation rmse = 0.102553
Epoch 128
Validation rmse = 0.110400
Epoch 129
Loss = 3.7547e-02, PNorm = 34.5257, GNorm = 1.6424, lr_0 = 1.0000e-04
Validation rmse = 0.106900
Epoch 130
Validation rmse = 0.101784
Epoch 131
Validation rmse = 0.108249
Epoch 132
Validation rmse = 0.107866
Epoch 133
Validation rmse = 0.102253
Epoch 134
Loss = 2.5914e-02, PNorm = 34.5308, GNorm = 1.2264, lr_0 = 1.0000e-04
Validation rmse = 0.104979
Epoch 135
Validation rmse = 0.106436
Epoch 136
Validation rmse = 0.100914
Epoch 137
Validation rmse = 0.102254
Epoch 138
Validation rmse = 0.107210
Epoch 139
Loss = 2.6543e-02, PNorm = 34.5363, GNorm = 1.1543, lr_0 = 1.0000e-04
Validation rmse = 0.104463
Epoch 140
Validation rmse = 0.103969
Epoch 141
Validation rmse = 0.103139
Epoch 142
Validation rmse = 0.106107
Epoch 143
Validation rmse = 0.104619
Epoch 144
Validation rmse = 0.104215
Epoch 145
Loss = 1.8816e-02, PNorm = 34.5420, GNorm = 0.4831, lr_0 = 1.0000e-04
Validation rmse = 0.101564
Epoch 146
Validation rmse = 0.103724
Epoch 147
Validation rmse = 0.103568
Epoch 148
Validation rmse = 0.102869
Epoch 149
Validation rmse = 0.103642
Epoch 150
Loss = 2.0258e-02, PNorm = 34.5470, GNorm = 1.6317, lr_0 = 1.0000e-04
Loss = 2.9977e-02, PNorm = 34.5475, GNorm = 2.4916, lr_0 = 1.0000e-04
Validation rmse = 0.103543
Epoch 151
Validation rmse = 0.104690
Epoch 152
Validation rmse = 0.100365
Epoch 153
Validation rmse = 0.103184
Epoch 154
Validation rmse = 0.104995
Epoch 155
Loss = 2.4489e-02, PNorm = 34.5525, GNorm = 0.8782, lr_0 = 1.0000e-04
Validation rmse = 0.101430
Epoch 156
Validation rmse = 0.102117
Epoch 157
Validation rmse = 0.103966
Epoch 158
Validation rmse = 0.102758
Epoch 159
Validation rmse = 0.101858
Epoch 160
Validation rmse = 0.104021
Epoch 161
Loss = 2.1716e-02, PNorm = 34.5580, GNorm = 1.1841, lr_0 = 1.0000e-04
Validation rmse = 0.099484
Epoch 162
Validation rmse = 0.098492
Epoch 163
Validation rmse = 0.110464
Epoch 164
Validation rmse = 0.101153
Epoch 165
Validation rmse = 0.096771
Epoch 166
Loss = 2.2744e-02, PNorm = 34.5632, GNorm = 0.6984, lr_0 = 1.0000e-04
Validation rmse = 0.108434
Epoch 167
Validation rmse = 0.101709
Epoch 168
Validation rmse = 0.095212
Epoch 169
Validation rmse = 0.104351
Epoch 170
Validation rmse = 0.100564
Epoch 171
Validation rmse = 0.097288
Epoch 172
Loss = 2.5002e-02, PNorm = 34.5683, GNorm = 1.5036, lr_0 = 1.0000e-04
Validation rmse = 0.103341
Epoch 173
Validation rmse = 0.103271
Epoch 174
Validation rmse = 0.100253
Epoch 175
Validation rmse = 0.102620
Epoch 176
Validation rmse = 0.100848
Epoch 177
Loss = 2.7476e-02, PNorm = 34.5729, GNorm = 0.5346, lr_0 = 1.0000e-04
Validation rmse = 0.099746
Epoch 178
Validation rmse = 0.098232
Epoch 179
Validation rmse = 0.101685
Epoch 180
Validation rmse = 0.102224
Epoch 181
Validation rmse = 0.098799
Epoch 182
Loss = 1.9594e-02, PNorm = 34.5779, GNorm = 0.7562, lr_0 = 1.0000e-04
Validation rmse = 0.096628
Epoch 183
Validation rmse = 0.102247
Epoch 184
Validation rmse = 0.102712
Epoch 185
Validation rmse = 0.095022
Epoch 186
Validation rmse = 0.104371
Epoch 187
Validation rmse = 0.100376
Epoch 188
Loss = 1.7793e-02, PNorm = 34.5827, GNorm = 0.7635, lr_0 = 1.0000e-04
Validation rmse = 0.093473
Epoch 189
Validation rmse = 0.106128
Epoch 190
Validation rmse = 0.102604
Epoch 191
Validation rmse = 0.095513
Epoch 192
Validation rmse = 0.102456
Epoch 193
Loss = 2.0262e-02, PNorm = 34.5872, GNorm = 2.5418, lr_0 = 1.0000e-04
Validation rmse = 0.100914
Epoch 194
Validation rmse = 0.095437
Epoch 195
Validation rmse = 0.103353
Epoch 196
Validation rmse = 0.100749
Epoch 197
Validation rmse = 0.095694
Epoch 198
Loss = 1.9149e-02, PNorm = 34.5911, GNorm = 0.3189, lr_0 = 1.0000e-04
Validation rmse = 0.102920
Epoch 199
Validation rmse = 0.098597
Model 0 best validation rmse = 0.093473 on epoch 188
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.001078
Ensemble test rmse = 0.001078
1-fold cross validation
	Seed 0 ==> test rmse = 0.001078
Overall test rmse = 0.001078 +/- 0.000000
Elapsed time = 0:00:22
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_dmf.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 200,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 113 | train size = 89 | val size = 23 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.360219
Epoch 1
Validation rmse = 0.254514
Epoch 2
Validation rmse = 0.252693
Epoch 3
Validation rmse = 0.256040
Epoch 4
Validation rmse = 0.265973
Epoch 5
Loss = 8.0626e-01, PNorm = 34.0568, GNorm = 2.6101, lr_0 = 8.7992e-04
Validation rmse = 0.245523
Epoch 6
Validation rmse = 0.236977
Epoch 7
Validation rmse = 0.232116
Epoch 8
Validation rmse = 0.230804
Epoch 9
Validation rmse = 0.211988
Epoch 10
Validation rmse = 0.200585
Epoch 11
Loss = 3.8923e-01, PNorm = 34.1422, GNorm = 2.8179, lr_0 = 7.7426e-04
Validation rmse = 0.191360
Epoch 12
Validation rmse = 0.178588
Epoch 13
Validation rmse = 0.173587
Epoch 14
Validation rmse = 0.187425
Epoch 15
Validation rmse = 0.164664
Epoch 16
Loss = 2.5622e-01, PNorm = 34.2065, GNorm = 5.4013, lr_0 = 6.8129e-04
Validation rmse = 0.192444
Epoch 17
Validation rmse = 0.161421
Epoch 18
Validation rmse = 0.165217
Epoch 19
Validation rmse = 0.178210
Epoch 20
Validation rmse = 0.162328
Epoch 21
Validation rmse = 0.174676
Epoch 22
Loss = 1.9393e-01, PNorm = 34.2463, GNorm = 5.7808, lr_0 = 5.9948e-04
Loss = 1.6971e-01, PNorm = 34.2496, GNorm = 1.4630, lr_0 = 5.9255e-04
Validation rmse = 0.163385
Epoch 23
Validation rmse = 0.163310
Epoch 24
Validation rmse = 0.166247
Epoch 25
Validation rmse = 0.161354
Epoch 26
Validation rmse = 0.163717
Epoch 27
Validation rmse = 0.158549
Epoch 28
Loss = 1.5061e-01, PNorm = 34.2858, GNorm = 4.5988, lr_0 = 5.2140e-04
Validation rmse = 0.162027
Epoch 29
Validation rmse = 0.160371
Epoch 30
Validation rmse = 0.165665
Epoch 31
Validation rmse = 0.158668
Epoch 32
Validation rmse = 0.170806
Epoch 33
Loss = 1.0830e-01, PNorm = 34.3162, GNorm = 0.9277, lr_0 = 4.5879e-04
Validation rmse = 0.160553
Epoch 34
Validation rmse = 0.161564
Epoch 35
Validation rmse = 0.160083
Epoch 36
Validation rmse = 0.158803
Epoch 37
Validation rmse = 0.162404
Epoch 38
Validation rmse = 0.155722
Epoch 39
Loss = 6.4231e-02, PNorm = 34.3426, GNorm = 1.1775, lr_0 = 4.0370e-04
Validation rmse = 0.161883
Epoch 40
Validation rmse = 0.152413
Epoch 41
Validation rmse = 0.158284
Epoch 42
Validation rmse = 0.163733
Epoch 43
Validation rmse = 0.150487
Epoch 44
Loss = 7.0864e-02, PNorm = 34.3641, GNorm = 0.3814, lr_0 = 3.5523e-04
Validation rmse = 0.155550
Epoch 45
Validation rmse = 0.151097
Epoch 46
Validation rmse = 0.149688
Epoch 47
Validation rmse = 0.149356
Epoch 48
Validation rmse = 0.151845
Epoch 49
Validation rmse = 0.150656
Epoch 50
Loss = 5.4880e-02, PNorm = 34.3834, GNorm = 2.5106, lr_0 = 3.1257e-04
Loss = 8.9252e-02, PNorm = 34.3850, GNorm = 5.7746, lr_0 = 3.0896e-04
Validation rmse = 0.147175
Epoch 51
Validation rmse = 0.155468
Epoch 52
Validation rmse = 0.145612
Epoch 53
Validation rmse = 0.146878
Epoch 54
Validation rmse = 0.144475
Epoch 55
Validation rmse = 0.143880
Epoch 56
Loss = 6.4738e-02, PNorm = 34.4019, GNorm = 0.3460, lr_0 = 2.7186e-04
Validation rmse = 0.145029
Epoch 57
Validation rmse = 0.145493
Epoch 58
Validation rmse = 0.141915
Epoch 59
Validation rmse = 0.144707
Epoch 60
Validation rmse = 0.140959
Epoch 61
Loss = 5.0355e-02, PNorm = 34.4173, GNorm = 1.8133, lr_0 = 2.3921e-04
Validation rmse = 0.139784
Epoch 62
Validation rmse = 0.143295
Epoch 63
Validation rmse = 0.138221
Epoch 64
Validation rmse = 0.141340
Epoch 65
Validation rmse = 0.139010
Epoch 66
Validation rmse = 0.134756
Epoch 67
Loss = 3.9153e-02, PNorm = 34.4314, GNorm = 1.7276, lr_0 = 2.1049e-04
Validation rmse = 0.140971
Epoch 68
Validation rmse = 0.138006
Epoch 69
Validation rmse = 0.134217
Epoch 70
Validation rmse = 0.137384
Epoch 71
Validation rmse = 0.134660
Epoch 72
Validation rmse = 0.134756
Epoch 73
Loss = 4.8895e-02, PNorm = 34.4447, GNorm = 0.4389, lr_0 = 1.8307e-04
Validation rmse = 0.135987
Epoch 74
Validation rmse = 0.133786
Epoch 75
Validation rmse = 0.132805
Epoch 76
Validation rmse = 0.134474
Epoch 77
Validation rmse = 0.130663
Epoch 78
Loss = 4.0134e-02, PNorm = 34.4553, GNorm = 0.9735, lr_0 = 1.6109e-04
Validation rmse = 0.133852
Epoch 79
Validation rmse = 0.131627
Epoch 80
Validation rmse = 0.131925
Epoch 81
Validation rmse = 0.130025
Epoch 82
Validation rmse = 0.130085
Epoch 83
Validation rmse = 0.132480
Epoch 84
Loss = 4.2854e-02, PNorm = 34.4648, GNorm = 1.5878, lr_0 = 1.4175e-04
Validation rmse = 0.129994
Epoch 85
Validation rmse = 0.130523
Epoch 86
Validation rmse = 0.130951
Epoch 87
Validation rmse = 0.129753
Epoch 88
Validation rmse = 0.128850
Epoch 89
Loss = 3.4656e-02, PNorm = 34.4732, GNorm = 1.7333, lr_0 = 1.2473e-04
Validation rmse = 0.129112
Epoch 90
Validation rmse = 0.127721
Epoch 91
Validation rmse = 0.129663
Epoch 92
Validation rmse = 0.129047
Epoch 93
Validation rmse = 0.127200
Epoch 94
Validation rmse = 0.126300
Epoch 95
Loss = 3.3596e-02, PNorm = 34.4806, GNorm = 1.6855, lr_0 = 1.0975e-04
Loss = 3.5154e-02, PNorm = 34.4812, GNorm = 1.9203, lr_0 = 1.0848e-04
Validation rmse = 0.127476
Epoch 96
Validation rmse = 0.125916
Epoch 97
Validation rmse = 0.124852
Epoch 98
Validation rmse = 0.126193
Epoch 99
Validation rmse = 0.126179
Epoch 100
Validation rmse = 0.124816
Epoch 101
Loss = 3.2903e-02, PNorm = 34.4877, GNorm = 0.6379, lr_0 = 1.0000e-04
Validation rmse = 0.126617
Epoch 102
Validation rmse = 0.125619
Epoch 103
Validation rmse = 0.124969
Epoch 104
Validation rmse = 0.124149
Epoch 105
Validation rmse = 0.125465
Epoch 106
Loss = 3.0282e-02, PNorm = 34.4940, GNorm = 0.3919, lr_0 = 1.0000e-04
Validation rmse = 0.123970
Epoch 107
Validation rmse = 0.124208
Epoch 108
Validation rmse = 0.124772
Epoch 109
Validation rmse = 0.123313
Epoch 110
Validation rmse = 0.123805
Epoch 111
Validation rmse = 0.124011
Epoch 112
Loss = 2.7001e-02, PNorm = 34.5003, GNorm = 0.7177, lr_0 = 1.0000e-04
Validation rmse = 0.122457
Epoch 113
Validation rmse = 0.123230
Epoch 114
Validation rmse = 0.123065
Epoch 115
Validation rmse = 0.121893
Epoch 116
Validation rmse = 0.122251
Epoch 117
Loss = 3.0929e-02, PNorm = 34.5067, GNorm = 2.6366, lr_0 = 1.0000e-04
Validation rmse = 0.125651
Epoch 118
Validation rmse = 0.119821
Epoch 119
Validation rmse = 0.120216
Epoch 120
Validation rmse = 0.123884
Epoch 121
Validation rmse = 0.122661
Epoch 122
Validation rmse = 0.118593
Epoch 123
Loss = 2.8730e-02, PNorm = 34.5136, GNorm = 0.3433, lr_0 = 1.0000e-04
Validation rmse = 0.119566
Epoch 124
Validation rmse = 0.122353
Epoch 125
Validation rmse = 0.121046
Epoch 126
Validation rmse = 0.117598
Epoch 127
Validation rmse = 0.121780
Epoch 128
Validation rmse = 0.121101
Epoch 129
Loss = 3.1039e-02, PNorm = 34.5199, GNorm = 0.3680, lr_0 = 1.0000e-04
Validation rmse = 0.118717
Epoch 130
Validation rmse = 0.118675
Epoch 131
Validation rmse = 0.120990
Epoch 132
Validation rmse = 0.118755
Epoch 133
Validation rmse = 0.119039
Epoch 134
Loss = 2.4965e-02, PNorm = 34.5260, GNorm = 0.1448, lr_0 = 1.0000e-04
Validation rmse = 0.118237
Epoch 135
Validation rmse = 0.118760
Epoch 136
Validation rmse = 0.118524
Epoch 137
Validation rmse = 0.118446
Epoch 138
Validation rmse = 0.117923
Epoch 139
Validation rmse = 0.117326
Epoch 140
Loss = 3.1319e-02, PNorm = 34.5322, GNorm = 0.2239, lr_0 = 1.0000e-04
Loss = 1.6238e-02, PNorm = 34.5327, GNorm = 1.3315, lr_0 = 1.0000e-04
Validation rmse = 0.116768
Epoch 141
Validation rmse = 0.119186
Epoch 142
Validation rmse = 0.117245
Epoch 143
Validation rmse = 0.115011
Epoch 144
Validation rmse = 0.118612
Epoch 145
Validation rmse = 0.117856
Epoch 146
Loss = 2.6022e-02, PNorm = 34.5388, GNorm = 1.7858, lr_0 = 1.0000e-04
Validation rmse = 0.115652
Epoch 147
Validation rmse = 0.118489
Epoch 148
Validation rmse = 0.118558
Epoch 149
Validation rmse = 0.112233
Epoch 150
Validation rmse = 0.115093
Epoch 151
Loss = 2.2715e-02, PNorm = 34.5447, GNorm = 0.7956, lr_0 = 1.0000e-04
Validation rmse = 0.123017
Epoch 152
Validation rmse = 0.113392
Epoch 153
Validation rmse = 0.111821
Epoch 154
Validation rmse = 0.119406
Epoch 155
Validation rmse = 0.117571
Epoch 156
Validation rmse = 0.111143
Epoch 157
Loss = 3.0377e-02, PNorm = 34.5505, GNorm = 2.2612, lr_0 = 1.0000e-04
Validation rmse = 0.118027
Epoch 158
Validation rmse = 0.117773
Epoch 159
Validation rmse = 0.112890
Epoch 160
Validation rmse = 0.114895
Epoch 161
Validation rmse = 0.116767
Epoch 162
Loss = 2.1798e-02, PNorm = 34.5563, GNorm = 2.2358, lr_0 = 1.0000e-04
Validation rmse = 0.113185
Epoch 163
Validation rmse = 0.112017
Epoch 164
Validation rmse = 0.117445
Epoch 165
Validation rmse = 0.112063
Epoch 166
Validation rmse = 0.111350
Epoch 167
Validation rmse = 0.116800
Epoch 168
Loss = 2.2019e-02, PNorm = 34.5619, GNorm = 2.1447, lr_0 = 1.0000e-04
Loss = 2.0293e-02, PNorm = 34.5625, GNorm = 0.3146, lr_0 = 1.0000e-04
Validation rmse = 0.112521
Epoch 169
Validation rmse = 0.112310
Epoch 170
Validation rmse = 0.115523
Epoch 171
Validation rmse = 0.112336
Epoch 172
Validation rmse = 0.112217
Epoch 173
Validation rmse = 0.112311
Epoch 174
Loss = 2.0622e-02, PNorm = 34.5680, GNorm = 0.3883, lr_0 = 1.0000e-04
Validation rmse = 0.113464
Epoch 175
Validation rmse = 0.111011
Epoch 176
Validation rmse = 0.110189
Epoch 177
Validation rmse = 0.114414
Epoch 178
Validation rmse = 0.112212
Epoch 179
Loss = 1.8297e-02, PNorm = 34.5735, GNorm = 0.3658, lr_0 = 1.0000e-04
Validation rmse = 0.110108
Epoch 180
Validation rmse = 0.111501
Epoch 181
Validation rmse = 0.111652
Epoch 182
Validation rmse = 0.111232
Epoch 183
Validation rmse = 0.111775
Epoch 184
Validation rmse = 0.109176
Epoch 185
Loss = 2.0249e-02, PNorm = 34.5790, GNorm = 0.3438, lr_0 = 1.0000e-04
Validation rmse = 0.111666
Epoch 186
Validation rmse = 0.111318
Epoch 187
Validation rmse = 0.108793
Epoch 188
Validation rmse = 0.110600
Epoch 189
Validation rmse = 0.110989
Epoch 190
Validation rmse = 0.107395
Epoch 191
Loss = 1.9276e-02, PNorm = 34.5849, GNorm = 1.1718, lr_0 = 1.0000e-04
Validation rmse = 0.109417
Epoch 192
Validation rmse = 0.112279
Epoch 193
Validation rmse = 0.107243
Epoch 194
Validation rmse = 0.110206
Epoch 195
Validation rmse = 0.109932
Epoch 196
Loss = 1.7143e-02, PNorm = 34.5903, GNorm = 1.1575, lr_0 = 1.0000e-04
Validation rmse = 0.106600
Epoch 197
Validation rmse = 0.110438
Epoch 198
Validation rmse = 0.110066
Epoch 199
Validation rmse = 0.105841
Model 0 best validation rmse = 0.105841 on epoch 199
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.101547
Ensemble test rmse = 0.101547
1-fold cross validation
	Seed 0 ==> test rmse = 0.101547
Overall test rmse = 0.101547 +/- 0.000000
Elapsed time = 0:00:24
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_dmf.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 200,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 108 | train size = 85 | val size = 22 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.274608
Epoch 1
Validation rmse = 0.239622
Epoch 2
Validation rmse = 0.261669
Epoch 3
Validation rmse = 0.233801
Epoch 4
Validation rmse = 0.233911
Epoch 5
Loss = 7.9155e-01, PNorm = 34.0522, GNorm = 2.1292, lr_0 = 8.7992e-04
Validation rmse = 0.221290
Epoch 6
Validation rmse = 0.219118
Epoch 7
Validation rmse = 0.202333
Epoch 8
Validation rmse = 0.195208
Epoch 9
Validation rmse = 0.212463
Epoch 10
Validation rmse = 0.190399
Epoch 11
Loss = 3.5277e-01, PNorm = 34.1366, GNorm = 4.4287, lr_0 = 7.6531e-04
Validation rmse = 0.181434
Epoch 12
Validation rmse = 0.183202
Epoch 13
Validation rmse = 0.199802
Epoch 14
Validation rmse = 0.186677
Epoch 15
Validation rmse = 0.182734
Epoch 16
Validation rmse = 0.182523
Epoch 17
Loss = 2.3083e-01, PNorm = 34.1853, GNorm = 5.0640, lr_0 = 6.6563e-04
Validation rmse = 0.182167
Epoch 18
Validation rmse = 0.185668
Epoch 19
Validation rmse = 0.176584
Epoch 20
Validation rmse = 0.173522
Epoch 21
Validation rmse = 0.181930
Epoch 22
Validation rmse = 0.173839
Epoch 23
Loss = 1.7905e-01, PNorm = 34.2196, GNorm = 0.6938, lr_0 = 5.8570e-04
Loss = 1.2576e-01, PNorm = 34.2226, GNorm = 0.7235, lr_0 = 5.7893e-04
Validation rmse = 0.168735
Epoch 24
Validation rmse = 0.170707
Epoch 25
Validation rmse = 0.172384
Epoch 26
Validation rmse = 0.163373
Epoch 27
Validation rmse = 0.168263
Epoch 28
Validation rmse = 0.163469
Epoch 29
Loss = 1.0886e-01, PNorm = 34.2557, GNorm = 0.9066, lr_0 = 5.0941e-04
Validation rmse = 0.158382
Epoch 30
Validation rmse = 0.160748
Epoch 31
Validation rmse = 0.157406
Epoch 32
Validation rmse = 0.152559
Epoch 33
Validation rmse = 0.153103
Epoch 34
Validation rmse = 0.153087
Epoch 35
Loss = 1.1687e-01, PNorm = 34.2917, GNorm = 0.4285, lr_0 = 4.4306e-04
Validation rmse = 0.151616
Epoch 36
Validation rmse = 0.145921
Epoch 37
Validation rmse = 0.150538
Epoch 38
Validation rmse = 0.154910
Epoch 39
Validation rmse = 0.138871
Epoch 40
Validation rmse = 0.142997
Epoch 41
Loss = 8.2136e-02, PNorm = 34.3245, GNorm = 1.2796, lr_0 = 3.8535e-04
Validation rmse = 0.142561
Epoch 42
Validation rmse = 0.135223
Epoch 43
Validation rmse = 0.141621
Epoch 44
Validation rmse = 0.136328
Epoch 45
Validation rmse = 0.136358
Epoch 46
Validation rmse = 0.133053
Epoch 47
Loss = 8.3738e-02, PNorm = 34.3534, GNorm = 0.6871, lr_0 = 3.3516e-04
Validation rmse = 0.136365
Epoch 48
Validation rmse = 0.131466
Epoch 49
Validation rmse = 0.132621
Epoch 50
Validation rmse = 0.130494
Epoch 51
Validation rmse = 0.127098
Epoch 52
Loss = 5.7976e-02, PNorm = 34.3782, GNorm = 1.7156, lr_0 = 2.9492e-04
Validation rmse = 0.130351
Epoch 53
Validation rmse = 0.129509
Epoch 54
Validation rmse = 0.123720
Epoch 55
Validation rmse = 0.121488
Epoch 56
Validation rmse = 0.129700
Epoch 57
Validation rmse = 0.120464
Epoch 58
Loss = 5.4860e-02, PNorm = 34.4018, GNorm = 4.4832, lr_0 = 2.5650e-04
Validation rmse = 0.118405
Epoch 59
Validation rmse = 0.126924
Epoch 60
Validation rmse = 0.116218
Epoch 61
Validation rmse = 0.117562
Epoch 62
Validation rmse = 0.120562
Epoch 63
Validation rmse = 0.115048
Epoch 64
Loss = 4.1449e-02, PNorm = 34.4218, GNorm = 0.5171, lr_0 = 2.2309e-04
Validation rmse = 0.113570
Epoch 65
Validation rmse = 0.119741
Epoch 66
Validation rmse = 0.117319
Epoch 67
Validation rmse = 0.109303
Epoch 68
Validation rmse = 0.117311
Epoch 69
Validation rmse = 0.113144
Epoch 70
Loss = 4.1261e-02, PNorm = 34.4370, GNorm = 1.2800, lr_0 = 1.9630e-04
Loss = 3.5077e-02, PNorm = 34.4383, GNorm = 1.4336, lr_0 = 1.9403e-04
Validation rmse = 0.108615
Epoch 71
Validation rmse = 0.111360
Epoch 72
Validation rmse = 0.110992
Epoch 73
Validation rmse = 0.106932
Epoch 74
Validation rmse = 0.108754
Epoch 75
Validation rmse = 0.109548
Epoch 76
Loss = 3.0540e-02, PNorm = 34.4514, GNorm = 1.3738, lr_0 = 1.7074e-04
Loss = 3.9402e-02, PNorm = 34.4525, GNorm = 0.4987, lr_0 = 1.6876e-04
Validation rmse = 0.109340
Epoch 77
Validation rmse = 0.106027
Epoch 78
Validation rmse = 0.104951
Epoch 79
Validation rmse = 0.108490
Epoch 80
Validation rmse = 0.104507
Epoch 81
Validation rmse = 0.104470
Epoch 82
Loss = 3.1280e-02, PNorm = 34.4638, GNorm = 0.4103, lr_0 = 1.4850e-04
Validation rmse = 0.104674
Epoch 83
Validation rmse = 0.103651
Epoch 84
Validation rmse = 0.103527
Epoch 85
Validation rmse = 0.102827
Epoch 86
Validation rmse = 0.103463
Epoch 87
Validation rmse = 0.102630
Epoch 88
Loss = 2.6736e-02, PNorm = 34.4745, GNorm = 0.6031, lr_0 = 1.2915e-04
Validation rmse = 0.102941
Epoch 89
Validation rmse = 0.102395
Epoch 90
Validation rmse = 0.100020
Epoch 91
Validation rmse = 0.099419
Epoch 92
Validation rmse = 0.101412
Epoch 93
Validation rmse = 0.100192
Epoch 94
Loss = 2.4425e-02, PNorm = 34.4836, GNorm = 0.7225, lr_0 = 1.1233e-04
Validation rmse = 0.099289
Epoch 95
Validation rmse = 0.099487
Epoch 96
Validation rmse = 0.100727
Epoch 97
Validation rmse = 0.097948
Epoch 98
Validation rmse = 0.097506
Epoch 99
Loss = 2.5798e-02, PNorm = 34.4905, GNorm = 1.0950, lr_0 = 1.0000e-04
Validation rmse = 0.097929
Epoch 100
Validation rmse = 0.098815
Epoch 101
Validation rmse = 0.096475
Epoch 102
Validation rmse = 0.096602
Epoch 103
Validation rmse = 0.098402
Epoch 104
Validation rmse = 0.097116
Epoch 105
Loss = 2.3249e-02, PNorm = 34.4976, GNorm = 0.3438, lr_0 = 1.0000e-04
Validation rmse = 0.097457
Epoch 106
Validation rmse = 0.096070
Epoch 107
Validation rmse = 0.094220
Epoch 108
Validation rmse = 0.097057
Epoch 109
Validation rmse = 0.097577
Epoch 110
Validation rmse = 0.094330
Epoch 111
Loss = 2.2406e-02, PNorm = 34.5044, GNorm = 0.8564, lr_0 = 1.0000e-04
Validation rmse = 0.095095
Epoch 112
Validation rmse = 0.095451
Epoch 113
Validation rmse = 0.094977
Epoch 114
Validation rmse = 0.096264
Epoch 115
Validation rmse = 0.095430
Epoch 116
Validation rmse = 0.094418
Epoch 117
Loss = 2.1027e-02, PNorm = 34.5112, GNorm = 0.4486, lr_0 = 1.0000e-04
Validation rmse = 0.093751
Epoch 118
Validation rmse = 0.093976
Epoch 119
Validation rmse = 0.094763
Epoch 120
Validation rmse = 0.094339
Epoch 121
Validation rmse = 0.092781
Epoch 122
Validation rmse = 0.091814
Epoch 123
Loss = 1.6132e-02, PNorm = 34.5175, GNorm = 0.4504, lr_0 = 1.0000e-04
Loss = 2.5007e-02, PNorm = 34.5181, GNorm = 2.1537, lr_0 = 1.0000e-04
Validation rmse = 0.097568
Epoch 124
Validation rmse = 0.095671
Epoch 125
Validation rmse = 0.090277
Epoch 126
Validation rmse = 0.092367
Epoch 127
Validation rmse = 0.096186
Epoch 128
Validation rmse = 0.091554
Epoch 129
Loss = 1.7601e-02, PNorm = 34.5241, GNorm = 0.2592, lr_0 = 1.0000e-04
Validation rmse = 0.091981
Epoch 130
Validation rmse = 0.095761
Epoch 131
Validation rmse = 0.092263
Epoch 132
Validation rmse = 0.090142
Epoch 133
Validation rmse = 0.092678
Epoch 134
Validation rmse = 0.092684
Epoch 135
Loss = 1.4622e-02, PNorm = 34.5305, GNorm = 0.9409, lr_0 = 1.0000e-04
Validation rmse = 0.091681
Epoch 136
Validation rmse = 0.091164
Epoch 137
Validation rmse = 0.090421
Epoch 138
Validation rmse = 0.091627
Epoch 139
Validation rmse = 0.091967
Epoch 140
Validation rmse = 0.090054
Epoch 141
Loss = 1.7149e-02, PNorm = 34.5369, GNorm = 0.7001, lr_0 = 1.0000e-04
Validation rmse = 0.091088
Epoch 142
Validation rmse = 0.091254
Epoch 143
Validation rmse = 0.089935
Epoch 144
Validation rmse = 0.090035
Epoch 145
Validation rmse = 0.091272
Epoch 146
Validation rmse = 0.090255
Epoch 147
Loss = 1.8281e-02, PNorm = 34.5429, GNorm = 0.7719, lr_0 = 1.0000e-04
Validation rmse = 0.089021
Epoch 148
Validation rmse = 0.092086
Epoch 149
Validation rmse = 0.089481
Epoch 150
Validation rmse = 0.089459
Epoch 151
Validation rmse = 0.090506
Epoch 152
Loss = 1.5397e-02, PNorm = 34.5486, GNorm = 1.0801, lr_0 = 1.0000e-04
Validation rmse = 0.090931
Epoch 153
Validation rmse = 0.088612
Epoch 154
Validation rmse = 0.089903
Epoch 155
Validation rmse = 0.090988
Epoch 156
Validation rmse = 0.089457
Epoch 157
Validation rmse = 0.089145
Epoch 158
Loss = 1.5319e-02, PNorm = 34.5547, GNorm = 0.2580, lr_0 = 1.0000e-04
Validation rmse = 0.088174
Epoch 159
Validation rmse = 0.090354
Epoch 160
Validation rmse = 0.090684
Epoch 161
Validation rmse = 0.087750
Epoch 162
Validation rmse = 0.089243
Epoch 163
Validation rmse = 0.091084
Epoch 164
Loss = 1.5237e-02, PNorm = 34.5608, GNorm = 0.3767, lr_0 = 1.0000e-04
Validation rmse = 0.087084
Epoch 165
Validation rmse = 0.088141
Epoch 166
Validation rmse = 0.090278
Epoch 167
Validation rmse = 0.086019
Epoch 168
Validation rmse = 0.087197
Epoch 169
Validation rmse = 0.092657
Epoch 170
Loss = 1.8094e-02, PNorm = 34.5663, GNorm = 2.3665, lr_0 = 1.0000e-04
Loss = 1.1575e-02, PNorm = 34.5668, GNorm = 0.5646, lr_0 = 1.0000e-04
Validation rmse = 0.085995
Epoch 171
Validation rmse = 0.086730
Epoch 172
Validation rmse = 0.091678
Epoch 173
Validation rmse = 0.088233
Epoch 174
Validation rmse = 0.087282
Epoch 175
Validation rmse = 0.089924
Epoch 176
Loss = 1.0878e-02, PNorm = 34.5718, GNorm = 0.5677, lr_0 = 1.0000e-04
Loss = 1.5862e-02, PNorm = 34.5722, GNorm = 0.6970, lr_0 = 1.0000e-04
Validation rmse = 0.086487
Epoch 177
Validation rmse = 0.087280
Epoch 178
Validation rmse = 0.089624
Epoch 179
Validation rmse = 0.086873
Epoch 180
Validation rmse = 0.086606
Epoch 181
Validation rmse = 0.089735
Epoch 182
Loss = 1.3620e-02, PNorm = 34.5773, GNorm = 0.9367, lr_0 = 1.0000e-04
Validation rmse = 0.086956
Epoch 183
Validation rmse = 0.085788
Epoch 184
Validation rmse = 0.088909
Epoch 185
Validation rmse = 0.088463
Epoch 186
Validation rmse = 0.085331
Epoch 187
Validation rmse = 0.088357
Epoch 188
Loss = 1.4033e-02, PNorm = 34.5826, GNorm = 0.4707, lr_0 = 1.0000e-04
Validation rmse = 0.089415
Epoch 189
Validation rmse = 0.084241
Epoch 190
Validation rmse = 0.086971
Epoch 191
Validation rmse = 0.090996
Epoch 192
Validation rmse = 0.084390
Epoch 193
Validation rmse = 0.085865
Epoch 194
Loss = 1.3667e-02, PNorm = 34.5878, GNorm = 0.2608, lr_0 = 1.0000e-04
Validation rmse = 0.090402
Epoch 195
Validation rmse = 0.084677
Epoch 196
Validation rmse = 0.086214
Epoch 197
Validation rmse = 0.090402
Epoch 198
Validation rmse = 0.083744
Epoch 199
Loss = 1.4208e-02, PNorm = 34.5924, GNorm = 3.7851, lr_0 = 1.0000e-04
Validation rmse = 0.086410
Model 0 best validation rmse = 0.083744 on epoch 198
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.085892
Ensemble test rmse = 0.085892
1-fold cross validation
	Seed 0 ==> test rmse = 0.085892
Overall test rmse = 0.085892 +/- 0.000000
Elapsed time = 0:00:24
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_dmf.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 200,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 103 | train size = 81 | val size = 21 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.277327
Epoch 1
Validation rmse = 0.258315
Epoch 2
Validation rmse = 0.242918
Epoch 3
Validation rmse = 0.236725
Epoch 4
Validation rmse = 0.223604
Epoch 5
Validation rmse = 0.216399
Epoch 6
Loss = 4.5998e-01, PNorm = 34.0858, GNorm = 4.2388, lr_0 = 8.6975e-04
Validation rmse = 0.200435
Epoch 7
Validation rmse = 0.199187
Epoch 8
Validation rmse = 0.178215
Epoch 9
Validation rmse = 0.186263
Epoch 10
Validation rmse = 0.171952
Epoch 11
Validation rmse = 0.179822
Epoch 12
Loss = 2.0503e-01, PNorm = 34.1670, GNorm = 5.3104, lr_0 = 7.5646e-04
Validation rmse = 0.172702
Epoch 13
Validation rmse = 0.176441
Epoch 14
Validation rmse = 0.173029
Epoch 15
Validation rmse = 0.193255
Epoch 16
Validation rmse = 0.180536
Epoch 17
Validation rmse = 0.189723
Epoch 18
Loss = 1.5334e-01, PNorm = 34.2128, GNorm = 7.2021, lr_0 = 6.5793e-04
Loss = 1.7870e-01, PNorm = 34.2160, GNorm = 5.9584, lr_0 = 6.5033e-04
Validation rmse = 0.183614
Epoch 19
Validation rmse = 0.187349
Epoch 20
Validation rmse = 0.162932
Epoch 21
Validation rmse = 0.160538
Epoch 22
Validation rmse = 0.170590
Epoch 23
Validation rmse = 0.158225
Epoch 24
Loss = 1.2574e-01, PNorm = 34.2477, GNorm = 5.4535, lr_0 = 5.6562e-04
Validation rmse = 0.165347
Epoch 25
Validation rmse = 0.155015
Epoch 26
Validation rmse = 0.153705
Epoch 27
Validation rmse = 0.161802
Epoch 28
Validation rmse = 0.151983
Epoch 29
Validation rmse = 0.154218
Epoch 30
Loss = 9.0664e-02, PNorm = 34.2752, GNorm = 4.2504, lr_0 = 4.9195e-04
Validation rmse = 0.152404
Epoch 31
Validation rmse = 0.150437
Epoch 32
Validation rmse = 0.158157
Epoch 33
Validation rmse = 0.149645
Epoch 34
Validation rmse = 0.148866
Epoch 35
Validation rmse = 0.151398
Epoch 36
Validation rmse = 0.147876
Epoch 37
Loss = 6.8511e-02, PNorm = 34.3044, GNorm = 0.8612, lr_0 = 4.2292e-04
Validation rmse = 0.152483
Epoch 38
Validation rmse = 0.149332
Epoch 39
Validation rmse = 0.148808
Epoch 40
Validation rmse = 0.150728
Epoch 41
Validation rmse = 0.146424
Epoch 42
Validation rmse = 0.150849
Epoch 43
Loss = 7.7028e-02, PNorm = 34.3270, GNorm = 4.9926, lr_0 = 3.6784e-04
Validation rmse = 0.146142
Epoch 44
Validation rmse = 0.143144
Epoch 45
Validation rmse = 0.147387
Epoch 46
Validation rmse = 0.143162
Epoch 47
Validation rmse = 0.143195
Epoch 48
Validation rmse = 0.144594
Epoch 49
Loss = 4.9705e-02, PNorm = 34.3464, GNorm = 3.0853, lr_0 = 3.1993e-04
Validation rmse = 0.141714
Epoch 50
Validation rmse = 0.149415
Epoch 51
Validation rmse = 0.141949
Epoch 52
Validation rmse = 0.142659
Epoch 53
Validation rmse = 0.147640
Epoch 54
Validation rmse = 0.141575
Epoch 55
Loss = 4.7585e-02, PNorm = 34.3627, GNorm = 3.5463, lr_0 = 2.7826e-04
Loss = 3.9346e-02, PNorm = 34.3640, GNorm = 2.4627, lr_0 = 2.7504e-04
Validation rmse = 0.142942
Epoch 56
Validation rmse = 0.145529
Epoch 57
Validation rmse = 0.141539
Epoch 58
Validation rmse = 0.142388
Epoch 59
Validation rmse = 0.143384
Epoch 60
Validation rmse = 0.141841
Epoch 61
Loss = 3.7158e-02, PNorm = 34.3773, GNorm = 4.2487, lr_0 = 2.3921e-04
Validation rmse = 0.143765
Epoch 62
Validation rmse = 0.144752
Epoch 63
Validation rmse = 0.140985
Epoch 64
Validation rmse = 0.142456
Epoch 65
Validation rmse = 0.142775
Epoch 66
Validation rmse = 0.140203
Epoch 67
Loss = 3.4274e-02, PNorm = 34.3886, GNorm = 3.5319, lr_0 = 2.0806e-04
Validation rmse = 0.142464
Epoch 68
Validation rmse = 0.142321
Epoch 69
Validation rmse = 0.139552
Epoch 70
Validation rmse = 0.141325
Epoch 71
Validation rmse = 0.141419
Epoch 72
Validation rmse = 0.139720
Epoch 73
Validation rmse = 0.141626
Epoch 74
Loss = 2.8574e-02, PNorm = 34.3990, GNorm = 1.4188, lr_0 = 1.7886e-04
Validation rmse = 0.143969
Epoch 75
Validation rmse = 0.140211
Epoch 76
Validation rmse = 0.140792
Epoch 77
Validation rmse = 0.143627
Epoch 78
Validation rmse = 0.141296
Epoch 79
Validation rmse = 0.140713
Epoch 80
Loss = 2.6025e-02, PNorm = 34.4069, GNorm = 1.1056, lr_0 = 1.5557e-04
Validation rmse = 0.141606
Epoch 81
Validation rmse = 0.140824
Epoch 82
Validation rmse = 0.139768
Epoch 83
Validation rmse = 0.141000
Epoch 84
Validation rmse = 0.141527
Epoch 85
Validation rmse = 0.140058
Epoch 86
Loss = 2.2106e-02, PNorm = 34.4137, GNorm = 0.3622, lr_0 = 1.3530e-04
Loss = 3.2263e-02, PNorm = 34.4142, GNorm = 2.4493, lr_0 = 1.3374e-04
Validation rmse = 0.139289
Epoch 87
Validation rmse = 0.141496
Epoch 88
Validation rmse = 0.141895
Epoch 89
Validation rmse = 0.140445
Epoch 90
Validation rmse = 0.140328
Epoch 91
Validation rmse = 0.141449
Epoch 92
Loss = 2.5266e-02, PNorm = 34.4193, GNorm = 1.3659, lr_0 = 1.1768e-04
Loss = 2.1590e-02, PNorm = 34.4198, GNorm = 1.3164, lr_0 = 1.1632e-04
Validation rmse = 0.141591
Epoch 93
Validation rmse = 0.140990
Epoch 94
Validation rmse = 0.139935
Epoch 95
Validation rmse = 0.140293
Epoch 96
Validation rmse = 0.142404
Epoch 97
Validation rmse = 0.140871
Epoch 98
Loss = 2.6470e-02, PNorm = 34.4248, GNorm = 3.3902, lr_0 = 1.0117e-04
Validation rmse = 0.139878
Epoch 99
Validation rmse = 0.141376
Epoch 100
Validation rmse = 0.141687
Epoch 101
Validation rmse = 0.140029
Epoch 102
Validation rmse = 0.139685
Epoch 103
Validation rmse = 0.141294
Epoch 104
Loss = 2.2926e-02, PNorm = 34.4291, GNorm = 1.6605, lr_0 = 1.0000e-04
Validation rmse = 0.141325
Epoch 105
Validation rmse = 0.139845
Epoch 106
Validation rmse = 0.139921
Epoch 107
Validation rmse = 0.141275
Epoch 108
Validation rmse = 0.141428
Epoch 109
Validation rmse = 0.139965
Epoch 110
Validation rmse = 0.140101
Epoch 111
Loss = 1.7003e-02, PNorm = 34.4337, GNorm = 0.3153, lr_0 = 1.0000e-04
Validation rmse = 0.140742
Epoch 112
Validation rmse = 0.140930
Epoch 113
Validation rmse = 0.139688
Epoch 114
Validation rmse = 0.140295
Epoch 115
Validation rmse = 0.141022
Epoch 116
Validation rmse = 0.139824
Epoch 117
Loss = 2.2640e-02, PNorm = 34.4381, GNorm = 0.2439, lr_0 = 1.0000e-04
Validation rmse = 0.139573
Epoch 118
Validation rmse = 0.141310
Epoch 119
Validation rmse = 0.140650
Epoch 120
Validation rmse = 0.139661
Epoch 121
Validation rmse = 0.140019
Epoch 122
Validation rmse = 0.141434
Epoch 123
Loss = 2.1363e-02, PNorm = 34.4425, GNorm = 2.0471, lr_0 = 1.0000e-04
Loss = 1.9505e-02, PNorm = 34.4429, GNorm = 1.7108, lr_0 = 1.0000e-04
Validation rmse = 0.140089
Epoch 124
Validation rmse = 0.140298
Epoch 125
Validation rmse = 0.140018
Epoch 126
Validation rmse = 0.139522
Epoch 127
Validation rmse = 0.140585
Epoch 128
Validation rmse = 0.140531
Epoch 129
Loss = 1.9775e-02, PNorm = 34.4473, GNorm = 0.4682, lr_0 = 1.0000e-04
Validation rmse = 0.139273
Epoch 130
Validation rmse = 0.139591
Epoch 131
Validation rmse = 0.140553
Epoch 132
Validation rmse = 0.140319
Epoch 133
Validation rmse = 0.139856
Epoch 134
Validation rmse = 0.140678
Epoch 135
Loss = 1.9833e-02, PNorm = 34.4516, GNorm = 2.7825, lr_0 = 1.0000e-04
Validation rmse = 0.140187
Epoch 136
Validation rmse = 0.139131
Epoch 137
Validation rmse = 0.139854
Epoch 138
Validation rmse = 0.141082
Epoch 139
Validation rmse = 0.139184
Epoch 140
Validation rmse = 0.138924
Epoch 141
Loss = 1.8887e-02, PNorm = 34.4557, GNorm = 2.5222, lr_0 = 1.0000e-04
Validation rmse = 0.140659
Epoch 142
Validation rmse = 0.142108
Epoch 143
Validation rmse = 0.139164
Epoch 144
Validation rmse = 0.139254
Epoch 145
Validation rmse = 0.141758
Epoch 146
Validation rmse = 0.140488
Epoch 147
Validation rmse = 0.138902
Epoch 148
Loss = 1.6419e-02, PNorm = 34.4602, GNorm = 2.2351, lr_0 = 1.0000e-04
Validation rmse = 0.139422
Epoch 149
Validation rmse = 0.139881
Epoch 150
Validation rmse = 0.140088
Epoch 151
Validation rmse = 0.139457
Epoch 152
Validation rmse = 0.139521
Epoch 153
Validation rmse = 0.140183
Epoch 154
Loss = 1.5298e-02, PNorm = 34.4643, GNorm = 0.2736, lr_0 = 1.0000e-04
Validation rmse = 0.139694
Epoch 155
Validation rmse = 0.139273
Epoch 156
Validation rmse = 0.140893
Epoch 157
Validation rmse = 0.140292
Epoch 158
Validation rmse = 0.139450
Epoch 159
Validation rmse = 0.140679
Epoch 160
Loss = 1.6684e-02, PNorm = 34.4687, GNorm = 0.2115, lr_0 = 1.0000e-04
Loss = 1.9648e-02, PNorm = 34.4690, GNorm = 3.7307, lr_0 = 1.0000e-04
Validation rmse = 0.141442
Epoch 161
Validation rmse = 0.138966
Epoch 162
Validation rmse = 0.139707
Epoch 163
Validation rmse = 0.143173
Epoch 164
Validation rmse = 0.139752
Epoch 165
Validation rmse = 0.139292
Epoch 166
Loss = 1.5545e-02, PNorm = 34.4733, GNorm = 0.2702, lr_0 = 1.0000e-04
Validation rmse = 0.142119
Epoch 167
Validation rmse = 0.140952
Epoch 168
Validation rmse = 0.139053
Epoch 169
Validation rmse = 0.140742
Epoch 170
Validation rmse = 0.141184
Epoch 171
Validation rmse = 0.139530
Epoch 172
Loss = 1.5034e-02, PNorm = 34.4774, GNorm = 0.2626, lr_0 = 1.0000e-04
Validation rmse = 0.139187
Epoch 173
Validation rmse = 0.140479
Epoch 174
Validation rmse = 0.140947
Epoch 175
Validation rmse = 0.139479
Epoch 176
Validation rmse = 0.139877
Epoch 177
Validation rmse = 0.140257
Epoch 178
Validation rmse = 0.140252
Epoch 179
Loss = 1.4113e-02, PNorm = 34.4816, GNorm = 0.2191, lr_0 = 1.0000e-04
Validation rmse = 0.140409
Epoch 180
Validation rmse = 0.139438
Epoch 181
Validation rmse = 0.139870
Epoch 182
Validation rmse = 0.140827
Epoch 183
Validation rmse = 0.139411
Epoch 184
Validation rmse = 0.139126
Epoch 185
Loss = 1.4418e-02, PNorm = 34.4854, GNorm = 0.6406, lr_0 = 1.0000e-04
Validation rmse = 0.140229
Epoch 186
Validation rmse = 0.140992
Epoch 187
Validation rmse = 0.139939
Epoch 188
Validation rmse = 0.139221
Epoch 189
Validation rmse = 0.139406
Epoch 190
Validation rmse = 0.140356
Epoch 191
Loss = 1.3461e-02, PNorm = 34.4893, GNorm = 0.8664, lr_0 = 1.0000e-04
Validation rmse = 0.139602
Epoch 192
Validation rmse = 0.138978
Epoch 193
Validation rmse = 0.139490
Epoch 194
Validation rmse = 0.139720
Epoch 195
Validation rmse = 0.139300
Epoch 196
Validation rmse = 0.139434
Epoch 197
Loss = 1.3254e-02, PNorm = 34.4931, GNorm = 0.1803, lr_0 = 1.0000e-04
Loss = 1.2196e-02, PNorm = 34.4934, GNorm = 0.2187, lr_0 = 1.0000e-04
Validation rmse = 0.139748
Epoch 198
Validation rmse = 0.139771
Epoch 199
Validation rmse = 0.140168
Model 0 best validation rmse = 0.138902 on epoch 147
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.053336
Ensemble test rmse = 0.053336
1-fold cross validation
	Seed 0 ==> test rmse = 0.053336
Overall test rmse = 0.053336 +/- 0.000000
Elapsed time = 0:00:21
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_dmf.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 200,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 123 | train size = 97 | val size = 25 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.221631
Epoch 1
Validation rmse = 0.268236
Epoch 2
Validation rmse = 0.214970
Epoch 3
Validation rmse = 0.208340
Epoch 4
Validation rmse = 0.217279
Epoch 5
Loss = 6.1884e-01, PNorm = 34.0534, GNorm = 1.1043, lr_0 = 8.9022e-04
Validation rmse = 0.231351
Epoch 6
Validation rmse = 0.205464
Epoch 7
Validation rmse = 0.207996
Epoch 8
Validation rmse = 0.204458
Epoch 9
Validation rmse = 0.184270
Epoch 10
Loss = 5.5312e-01, PNorm = 34.1246, GNorm = 2.7390, lr_0 = 7.9248e-04
Validation rmse = 0.203675
Epoch 11
Validation rmse = 0.161855
Epoch 12
Validation rmse = 0.166359
Epoch 13
Validation rmse = 0.148465
Epoch 14
Validation rmse = 0.146071
Epoch 15
Loss = 3.4704e-01, PNorm = 34.1855, GNorm = 0.5357, lr_0 = 7.0548e-04
Validation rmse = 0.131808
Epoch 16
Validation rmse = 0.126033
Epoch 17
Validation rmse = 0.135347
Epoch 18
Validation rmse = 0.127341
Epoch 19
Validation rmse = 0.139478
Epoch 20
Loss = 2.8290e-01, PNorm = 34.2424, GNorm = 2.7332, lr_0 = 6.2077e-04
Validation rmse = 0.131647
Epoch 21
Validation rmse = 0.131318
Epoch 22
Validation rmse = 0.140973
Epoch 23
Validation rmse = 0.171363
Epoch 24
Validation rmse = 0.121504
Epoch 25
Loss = 2.4430e-01, PNorm = 34.2828, GNorm = 2.6536, lr_0 = 5.5262e-04
Validation rmse = 0.169266
Epoch 26
Validation rmse = 0.138565
Epoch 27
Validation rmse = 0.138685
Epoch 28
Validation rmse = 0.168103
Epoch 29
Validation rmse = 0.133124
Epoch 30
Loss = 2.0904e-01, PNorm = 34.3192, GNorm = 4.7196, lr_0 = 4.9195e-04
Validation rmse = 0.151620
Epoch 31
Validation rmse = 0.155119
Epoch 32
Validation rmse = 0.131929
Epoch 33
Validation rmse = 0.171558
Epoch 34
Validation rmse = 0.147470
Epoch 35
Validation rmse = 0.147975
Epoch 36
Loss = 1.8543e-01, PNorm = 34.3556, GNorm = 2.4692, lr_0 = 4.3288e-04
Validation rmse = 0.155713
Epoch 37
Validation rmse = 0.134348
Epoch 38
Validation rmse = 0.170197
Epoch 39
Validation rmse = 0.137719
Epoch 40
Validation rmse = 0.162167
Epoch 41
Loss = 1.7040e-01, PNorm = 34.3832, GNorm = 0.9232, lr_0 = 3.8535e-04
Validation rmse = 0.152378
Epoch 42
Validation rmse = 0.140220
Epoch 43
Validation rmse = 0.187158
Epoch 44
Validation rmse = 0.146818
Epoch 45
Validation rmse = 0.145848
Epoch 46
Loss = 1.5174e-01, PNorm = 34.4071, GNorm = 4.0850, lr_0 = 3.4305e-04
Validation rmse = 0.162973
Epoch 47
Validation rmse = 0.142738
Epoch 48
Validation rmse = 0.160834
Epoch 49
Validation rmse = 0.166951
Epoch 50
Validation rmse = 0.140910
Epoch 51
Loss = 1.4249e-01, PNorm = 34.4301, GNorm = 7.6931, lr_0 = 3.0185e-04
Validation rmse = 0.162873
Epoch 52
Validation rmse = 0.173477
Epoch 53
Validation rmse = 0.141767
Epoch 54
Validation rmse = 0.150363
Epoch 55
Validation rmse = 0.192288
Epoch 56
Loss = 1.4720e-01, PNorm = 34.4477, GNorm = 3.8067, lr_0 = 2.6872e-04
Validation rmse = 0.146061
Epoch 57
Validation rmse = 0.141195
Epoch 58
Validation rmse = 0.181805
Epoch 59
Validation rmse = 0.155840
Epoch 60
Validation rmse = 0.140983
Epoch 61
Loss = 1.2770e-01, PNorm = 34.4628, GNorm = 2.9537, lr_0 = 2.3921e-04
Validation rmse = 0.160409
Epoch 62
Validation rmse = 0.171421
Epoch 63
Validation rmse = 0.148182
Epoch 64
Validation rmse = 0.152330
Epoch 65
Validation rmse = 0.163853
Epoch 66
Validation rmse = 0.160413
Epoch 67
Loss = 5.0375e-02, PNorm = 34.4780, GNorm = 0.7641, lr_0 = 2.1049e-04
Validation rmse = 0.154335
Epoch 68
Validation rmse = 0.152519
Epoch 69
Validation rmse = 0.158832
Epoch 70
Validation rmse = 0.155913
Epoch 71
Validation rmse = 0.158722
Epoch 72
Loss = 1.4635e-01, PNorm = 34.4908, GNorm = 0.7812, lr_0 = 1.8738e-04
Validation rmse = 0.155881
Epoch 73
Validation rmse = 0.156265
Epoch 74
Validation rmse = 0.160026
Epoch 75
Validation rmse = 0.161850
Epoch 76
Validation rmse = 0.153849
Epoch 77
Loss = 1.1731e-01, PNorm = 34.5026, GNorm = 0.6157, lr_0 = 1.6681e-04
Validation rmse = 0.158382
Epoch 78
Validation rmse = 0.164055
Epoch 79
Validation rmse = 0.157093
Epoch 80
Validation rmse = 0.155919
Epoch 81
Validation rmse = 0.159014
Epoch 82
Loss = 8.2704e-02, PNorm = 34.5133, GNorm = 2.2990, lr_0 = 1.4850e-04
Validation rmse = 0.158956
Epoch 83
Validation rmse = 0.162786
Epoch 84
Validation rmse = 0.158825
Epoch 85
Validation rmse = 0.154377
Epoch 86
Validation rmse = 0.160917
Epoch 87
Loss = 9.5211e-02, PNorm = 34.5240, GNorm = 0.6839, lr_0 = 1.3067e-04
Validation rmse = 0.162241
Epoch 88
Validation rmse = 0.159650
Epoch 89
Validation rmse = 0.155770
Epoch 90
Validation rmse = 0.162068
Epoch 91
Validation rmse = 0.161005
Epoch 92
Loss = 9.5127e-02, PNorm = 34.5328, GNorm = 1.8836, lr_0 = 1.1632e-04
Validation rmse = 0.159715
Epoch 93
Validation rmse = 0.157500
Epoch 94
Validation rmse = 0.157446
Epoch 95
Validation rmse = 0.162794
Epoch 96
Validation rmse = 0.164872
Epoch 97
Loss = 9.2737e-02, PNorm = 34.5408, GNorm = 4.7713, lr_0 = 1.0355e-04
Validation rmse = 0.160594
Epoch 98
Validation rmse = 0.154690
Epoch 99
Validation rmse = 0.155313
Epoch 100
Validation rmse = 0.165173
Epoch 101
Validation rmse = 0.169028
Epoch 102
Validation rmse = 0.159139
Epoch 103
Loss = 7.0341e-02, PNorm = 34.5489, GNorm = 2.3780, lr_0 = 1.0000e-04
Validation rmse = 0.154306
Epoch 104
Validation rmse = 0.163418
Epoch 105
Validation rmse = 0.166223
Epoch 106
Validation rmse = 0.162499
Epoch 107
Validation rmse = 0.160292
Epoch 108
Loss = 4.3828e-02, PNorm = 34.5562, GNorm = 0.5245, lr_0 = 1.0000e-04
Validation rmse = 0.157001
Epoch 109
Validation rmse = 0.160554
Epoch 110
Validation rmse = 0.166267
Epoch 111
Validation rmse = 0.160576
Epoch 112
Validation rmse = 0.155910
Epoch 113
Loss = 1.0654e-01, PNorm = 34.5635, GNorm = 2.2189, lr_0 = 1.0000e-04
Validation rmse = 0.160291
Epoch 114
Validation rmse = 0.165361
Epoch 115
Validation rmse = 0.164938
Epoch 116
Validation rmse = 0.159876
Epoch 117
Validation rmse = 0.160872
Epoch 118
Loss = 8.5352e-02, PNorm = 34.5716, GNorm = 1.3321, lr_0 = 1.0000e-04
Validation rmse = 0.163031
Epoch 119
Validation rmse = 0.164118
Epoch 120
Validation rmse = 0.161931
Epoch 121
Validation rmse = 0.160120
Epoch 122
Validation rmse = 0.160646
Epoch 123
Loss = 8.3451e-02, PNorm = 34.5790, GNorm = 2.5923, lr_0 = 1.0000e-04
Validation rmse = 0.164105
Epoch 124
Validation rmse = 0.161111
Epoch 125
Validation rmse = 0.160928
Epoch 126
Validation rmse = 0.161272
Epoch 127
Validation rmse = 0.161318
Epoch 128
Loss = 8.1523e-02, PNorm = 34.5866, GNorm = 1.1551, lr_0 = 1.0000e-04
Validation rmse = 0.164041
Epoch 129
Validation rmse = 0.165878
Epoch 130
Validation rmse = 0.157935
Epoch 131
Validation rmse = 0.162803
Epoch 132
Validation rmse = 0.167986
Epoch 133
Validation rmse = 0.166010
Epoch 134
Loss = 7.2458e-02, PNorm = 34.5950, GNorm = 0.9312, lr_0 = 1.0000e-04
Validation rmse = 0.159912
Epoch 135
Validation rmse = 0.158893
Epoch 136
Validation rmse = 0.166405
Epoch 137
Validation rmse = 0.166093
Epoch 138
Validation rmse = 0.159599
Epoch 139
Loss = 1.0321e-01, PNorm = 34.6028, GNorm = 3.2064, lr_0 = 1.0000e-04
Validation rmse = 0.160031
Epoch 140
Validation rmse = 0.163607
Epoch 141
Validation rmse = 0.167067
Epoch 142
Validation rmse = 0.163658
Epoch 143
Validation rmse = 0.162431
Epoch 144
Loss = 1.0337e-01, PNorm = 34.6104, GNorm = 1.2490, lr_0 = 1.0000e-04
Validation rmse = 0.161263
Epoch 145
Validation rmse = 0.164347
Epoch 146
Validation rmse = 0.165424
Epoch 147
Validation rmse = 0.161542
Epoch 148
Validation rmse = 0.163986
Epoch 149
Loss = 5.2766e-02, PNorm = 34.6180, GNorm = 2.3800, lr_0 = 1.0000e-04
Validation rmse = 0.163481
Epoch 150
Validation rmse = 0.167787
Epoch 151
Validation rmse = 0.164030
Epoch 152
Validation rmse = 0.160700
Epoch 153
Validation rmse = 0.167719
Epoch 154
Loss = 7.5151e-02, PNorm = 34.6267, GNorm = 1.8924, lr_0 = 1.0000e-04
Validation rmse = 0.168742
Epoch 155
Validation rmse = 0.161803
Epoch 156
Validation rmse = 0.163604
Epoch 157
Validation rmse = 0.165837
Epoch 158
Validation rmse = 0.166057
Epoch 159
Loss = 7.1813e-02, PNorm = 34.6346, GNorm = 1.6584, lr_0 = 1.0000e-04
Validation rmse = 0.166552
Epoch 160
Validation rmse = 0.163592
Epoch 161
Validation rmse = 0.162614
Epoch 162
Validation rmse = 0.171154
Epoch 163
Validation rmse = 0.169010
Epoch 164
Loss = 7.0119e-02, PNorm = 34.6425, GNorm = 0.5578, lr_0 = 1.0000e-04
Validation rmse = 0.163215
Epoch 165
Validation rmse = 0.164077
Epoch 166
Validation rmse = 0.170787
Epoch 167
Validation rmse = 0.165883
Epoch 168
Validation rmse = 0.162300
Epoch 169
Validation rmse = 0.166393
Epoch 170
Loss = 1.0274e-01, PNorm = 34.6513, GNorm = 0.4528, lr_0 = 1.0000e-04
Validation rmse = 0.165542
Epoch 171
Validation rmse = 0.164928
Epoch 172
Validation rmse = 0.166542
Epoch 173
Validation rmse = 0.170343
Epoch 174
Validation rmse = 0.161852
Epoch 175
Loss = 4.2875e-02, PNorm = 34.6593, GNorm = 1.3088, lr_0 = 1.0000e-04
Validation rmse = 0.166642
Epoch 176
Validation rmse = 0.171348
Epoch 177
Validation rmse = 0.165740
Epoch 178
Validation rmse = 0.166201
Epoch 179
Validation rmse = 0.165395
Epoch 180
Loss = 9.0350e-02, PNorm = 34.6673, GNorm = 0.5492, lr_0 = 1.0000e-04
Validation rmse = 0.165816
Epoch 181
Validation rmse = 0.169194
Epoch 182
Validation rmse = 0.166501
Epoch 183
Validation rmse = 0.166493
Epoch 184
Validation rmse = 0.164814
Epoch 185
Loss = 6.6790e-02, PNorm = 34.6760, GNorm = 1.2205, lr_0 = 1.0000e-04
Validation rmse = 0.169361
Epoch 186
Validation rmse = 0.166648
Epoch 187
Validation rmse = 0.166718
Epoch 188
Validation rmse = 0.172614
Epoch 189
Validation rmse = 0.165159
Epoch 190
Loss = 6.9612e-02, PNorm = 34.6841, GNorm = 5.6009, lr_0 = 1.0000e-04
Validation rmse = 0.164485
Epoch 191
Validation rmse = 0.175946
Epoch 192
Validation rmse = 0.166690
Epoch 193
Validation rmse = 0.161581
Epoch 194
Validation rmse = 0.169586
Epoch 195
Loss = 6.5092e-02, PNorm = 34.6920, GNorm = 3.3830, lr_0 = 1.0000e-04
Validation rmse = 0.174337
Epoch 196
Validation rmse = 0.164754
Epoch 197
Validation rmse = 0.163022
Epoch 198
Validation rmse = 0.169648
Epoch 199
Validation rmse = 0.172676
Model 0 best validation rmse = 0.121504 on epoch 24
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.106366
Ensemble test rmse = 0.106366
1-fold cross validation
	Seed 0 ==> test rmse = 0.106366
Overall test rmse = 0.106366 +/- 0.000000
Elapsed time = 0:00:21
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_dmf.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 200,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 118 | train size = 93 | val size = 24 | test size = 1
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Validation rmse = 0.251015
Epoch 1
Validation rmse = 0.235487
Epoch 2
Validation rmse = 0.184606
Epoch 3
Validation rmse = 0.185105
Epoch 4
Validation rmse = 0.181914
Epoch 5
Loss = 5.9705e-01, PNorm = 34.0618, GNorm = 2.0680, lr_0 = 8.9022e-04
Validation rmse = 0.148918
Epoch 6
Validation rmse = 0.143833
Epoch 7
Validation rmse = 0.182480
Epoch 8
Validation rmse = 0.161999
Epoch 9
Validation rmse = 0.213846
Epoch 10
Loss = 4.3857e-01, PNorm = 34.1437, GNorm = 13.1733, lr_0 = 7.8332e-04
Validation rmse = 0.170333
Epoch 11
Validation rmse = 0.160351
Epoch 12
Validation rmse = 0.201758
Epoch 13
Validation rmse = 0.150291
Epoch 14
Validation rmse = 0.149382
Epoch 15
Validation rmse = 0.167230
Epoch 16
Loss = 2.9087e-01, PNorm = 34.1848, GNorm = 6.8381, lr_0 = 6.8926e-04
Validation rmse = 0.146175
Epoch 17
Validation rmse = 0.150427
Epoch 18
Validation rmse = 0.152643
Epoch 19
Validation rmse = 0.150814
Epoch 20
Validation rmse = 0.155894
Epoch 21
Loss = 1.5421e-01, PNorm = 34.2241, GNorm = 0.5520, lr_0 = 6.1359e-04
Loss = 2.1298e-01, PNorm = 34.2280, GNorm = 4.2183, lr_0 = 6.0650e-04
Validation rmse = 0.149093
Epoch 22
Validation rmse = 0.149367
Epoch 23
Validation rmse = 0.150046
Epoch 24
Validation rmse = 0.144891
Epoch 25
Validation rmse = 0.146297
Epoch 26
Loss = 1.4023e-01, PNorm = 34.2662, GNorm = 3.9727, lr_0 = 5.3991e-04
Validation rmse = 0.142611
Epoch 27
Validation rmse = 0.147176
Epoch 28
Validation rmse = 0.134559
Epoch 29
Validation rmse = 0.158881
Epoch 30
Validation rmse = 0.133616
Epoch 31
Validation rmse = 0.147262
Epoch 32
Loss = 1.0097e-01, PNorm = 34.3019, GNorm = 2.4925, lr_0 = 4.7508e-04
Validation rmse = 0.137926
Epoch 33
Validation rmse = 0.128520
Epoch 34
Validation rmse = 0.159541
Epoch 35
Validation rmse = 0.125812
Epoch 36
Validation rmse = 0.140202
Epoch 37
Loss = 9.4137e-02, PNorm = 34.3289, GNorm = 1.8674, lr_0 = 4.1803e-04
Validation rmse = 0.147984
Epoch 38
Validation rmse = 0.127543
Epoch 39
Validation rmse = 0.140686
Epoch 40
Validation rmse = 0.133756
Epoch 41
Validation rmse = 0.127990
Epoch 42
Validation rmse = 0.136657
Epoch 43
Loss = 4.1334e-02, PNorm = 34.3535, GNorm = 1.2779, lr_0 = 3.6784e-04
Validation rmse = 0.131962
Epoch 44
Validation rmse = 0.128616
Epoch 45
Validation rmse = 0.131484
Epoch 46
Validation rmse = 0.128564
Epoch 47
Validation rmse = 0.129049
Epoch 48
Loss = 7.7469e-02, PNorm = 34.3742, GNorm = 1.1466, lr_0 = 3.2745e-04
Validation rmse = 0.127467
Epoch 49
Validation rmse = 0.126112
Epoch 50
Validation rmse = 0.131204
Epoch 51
Validation rmse = 0.127087
Epoch 52
Validation rmse = 0.124631
Epoch 53
Loss = 6.1649e-02, PNorm = 34.3956, GNorm = 0.3244, lr_0 = 2.8813e-04
Validation rmse = 0.126596
Epoch 54
Validation rmse = 0.126410
Epoch 55
Validation rmse = 0.122849
Epoch 56
Validation rmse = 0.121303
Epoch 57
Validation rmse = 0.125282
Epoch 58
Validation rmse = 0.127278
Epoch 59
Loss = 5.9303e-02, PNorm = 34.4149, GNorm = 1.6143, lr_0 = 2.5354e-04
Validation rmse = 0.119025
Epoch 60
Validation rmse = 0.128520
Epoch 61
Validation rmse = 0.124161
Epoch 62
Validation rmse = 0.118229
Epoch 63
Validation rmse = 0.123486
Epoch 64
Loss = 5.9697e-02, PNorm = 34.4307, GNorm = 0.8712, lr_0 = 2.2570e-04
Loss = 3.7380e-02, PNorm = 34.4321, GNorm = 1.7536, lr_0 = 2.2309e-04
Validation rmse = 0.118609
Epoch 65
Validation rmse = 0.120285
Epoch 66
Validation rmse = 0.127850
Epoch 67
Validation rmse = 0.112108
Epoch 68
Validation rmse = 0.122031
Epoch 69
Loss = 4.8748e-02, PNorm = 34.4458, GNorm = 3.9386, lr_0 = 1.9860e-04
Validation rmse = 0.120702
Epoch 70
Validation rmse = 0.111161
Epoch 71
Validation rmse = 0.120790
Epoch 72
Validation rmse = 0.122440
Epoch 73
Validation rmse = 0.109829
Epoch 74
Validation rmse = 0.126585
Epoch 75
Loss = 4.5659e-02, PNorm = 34.4584, GNorm = 3.2198, lr_0 = 1.7475e-04
Validation rmse = 0.114079
Epoch 76
Validation rmse = 0.110233
Epoch 77
Validation rmse = 0.124494
Epoch 78
Validation rmse = 0.111116
Epoch 79
Validation rmse = 0.110503
Epoch 80
Loss = 4.0638e-02, PNorm = 34.4688, GNorm = 2.1130, lr_0 = 1.5377e-04
Validation rmse = 0.126099
Epoch 81
Validation rmse = 0.110129
Epoch 82
Validation rmse = 0.108745
Epoch 83
Validation rmse = 0.120023
Epoch 84
Validation rmse = 0.113534
Epoch 85
Validation rmse = 0.107094
Epoch 86
Loss = 3.0170e-02, PNorm = 34.4776, GNorm = 1.9514, lr_0 = 1.3530e-04
Validation rmse = 0.112608
Epoch 87
Validation rmse = 0.118577
Epoch 88
Validation rmse = 0.111108
Epoch 89
Validation rmse = 0.107503
Epoch 90
Validation rmse = 0.111056
Epoch 91
Loss = 3.7364e-02, PNorm = 34.4845, GNorm = 0.3508, lr_0 = 1.2045e-04
Validation rmse = 0.114868
Epoch 92
Validation rmse = 0.110904
Epoch 93
Validation rmse = 0.106765
Epoch 94
Validation rmse = 0.112749
Epoch 95
Validation rmse = 0.114931
Epoch 96
Loss = 3.4117e-02, PNorm = 34.4912, GNorm = 1.0401, lr_0 = 1.0599e-04
Validation rmse = 0.108284
Epoch 97
Validation rmse = 0.107752
Epoch 98
Validation rmse = 0.112368
Epoch 99
Validation rmse = 0.108492
Epoch 100
Validation rmse = 0.106572
Epoch 101
Validation rmse = 0.112561
Epoch 102
Loss = 1.9812e-02, PNorm = 34.4972, GNorm = 1.4935, lr_0 = 1.0000e-04
Validation rmse = 0.112543
Epoch 103
Validation rmse = 0.108245
Epoch 104
Validation rmse = 0.109110
Epoch 105
Validation rmse = 0.110830
Epoch 106
Validation rmse = 0.107334
Epoch 107
Loss = 4.6861e-02, PNorm = 34.5026, GNorm = 1.6643, lr_0 = 1.0000e-04
Loss = 1.4388e-02, PNorm = 34.5031, GNorm = 0.9914, lr_0 = 1.0000e-04
Validation rmse = 0.107921
Epoch 108
Validation rmse = 0.108648
Epoch 109
Validation rmse = 0.109248
Epoch 110
Validation rmse = 0.107090
Epoch 111
Validation rmse = 0.108252
Epoch 112
Loss = 3.1361e-02, PNorm = 34.5084, GNorm = 2.8902, lr_0 = 1.0000e-04
Validation rmse = 0.109500
Epoch 113
Validation rmse = 0.110708
Epoch 114
Validation rmse = 0.106610
Epoch 115
Validation rmse = 0.105913
Epoch 116
Validation rmse = 0.110380
Epoch 117
Validation rmse = 0.105149
Epoch 118
Loss = 3.2274e-02, PNorm = 34.5142, GNorm = 2.2545, lr_0 = 1.0000e-04
Validation rmse = 0.106460
Epoch 119
Validation rmse = 0.107034
Epoch 120
Validation rmse = 0.106255
Epoch 121
Validation rmse = 0.109326
Epoch 122
Validation rmse = 0.106165
Epoch 123
Loss = 2.8512e-02, PNorm = 34.5200, GNorm = 0.9397, lr_0 = 1.0000e-04
Validation rmse = 0.103020
Epoch 124
Validation rmse = 0.107989
Epoch 125
Validation rmse = 0.110608
Epoch 126
Validation rmse = 0.103961
Epoch 127
Validation rmse = 0.102553
Epoch 128
Validation rmse = 0.110400
Epoch 129
Loss = 3.7547e-02, PNorm = 34.5257, GNorm = 1.6424, lr_0 = 1.0000e-04
Validation rmse = 0.106900
Epoch 130
Validation rmse = 0.101784
Epoch 131
Validation rmse = 0.108249
Epoch 132
Validation rmse = 0.107866
Epoch 133
Validation rmse = 0.102253
Epoch 134
Loss = 2.5914e-02, PNorm = 34.5308, GNorm = 1.2264, lr_0 = 1.0000e-04
Validation rmse = 0.104979
Epoch 135
Validation rmse = 0.106436
Epoch 136
Validation rmse = 0.100914
Epoch 137
Validation rmse = 0.102254
Epoch 138
Validation rmse = 0.107210
Epoch 139
Loss = 2.6543e-02, PNorm = 34.5363, GNorm = 1.1543, lr_0 = 1.0000e-04
Validation rmse = 0.104463
Epoch 140
Validation rmse = 0.103969
Epoch 141
Validation rmse = 0.103139
Epoch 142
Validation rmse = 0.106107
Epoch 143
Validation rmse = 0.104619
Epoch 144
Validation rmse = 0.104215
Epoch 145
Loss = 1.8816e-02, PNorm = 34.5420, GNorm = 0.4831, lr_0 = 1.0000e-04
Validation rmse = 0.101564
Epoch 146
Validation rmse = 0.103724
Epoch 147
Validation rmse = 0.103568
Epoch 148
Validation rmse = 0.102869
Epoch 149
Validation rmse = 0.103642
Epoch 150
Loss = 2.0258e-02, PNorm = 34.5470, GNorm = 1.6317, lr_0 = 1.0000e-04
Loss = 2.9977e-02, PNorm = 34.5475, GNorm = 2.4916, lr_0 = 1.0000e-04
Validation rmse = 0.103543
Epoch 151
Validation rmse = 0.104690
Epoch 152
Validation rmse = 0.100365
Epoch 153
Validation rmse = 0.103184
Epoch 154
Validation rmse = 0.104995
Epoch 155
Loss = 2.4489e-02, PNorm = 34.5525, GNorm = 0.8782, lr_0 = 1.0000e-04
Validation rmse = 0.101430
Epoch 156
Validation rmse = 0.102117
Epoch 157
Validation rmse = 0.103966
Epoch 158
Validation rmse = 0.102758
Epoch 159
Validation rmse = 0.101858
Epoch 160
Validation rmse = 0.104021
Epoch 161
Loss = 2.1716e-02, PNorm = 34.5580, GNorm = 1.1841, lr_0 = 1.0000e-04
Validation rmse = 0.099484
Epoch 162
Validation rmse = 0.098492
Epoch 163
Validation rmse = 0.110464
Epoch 164
Validation rmse = 0.101153
Epoch 165
Validation rmse = 0.096771
Epoch 166
Loss = 2.2744e-02, PNorm = 34.5632, GNorm = 0.6984, lr_0 = 1.0000e-04
Validation rmse = 0.108434
Epoch 167
Validation rmse = 0.101709
Epoch 168
Validation rmse = 0.095212
Epoch 169
Validation rmse = 0.104351
Epoch 170
Validation rmse = 0.100564
Epoch 171
Validation rmse = 0.097288
Epoch 172
Loss = 2.5002e-02, PNorm = 34.5683, GNorm = 1.5036, lr_0 = 1.0000e-04
Validation rmse = 0.103341
Epoch 173
Validation rmse = 0.103271
Epoch 174
Validation rmse = 0.100253
Epoch 175
Validation rmse = 0.102620
Epoch 176
Validation rmse = 0.100848
Epoch 177
Loss = 2.7476e-02, PNorm = 34.5729, GNorm = 0.5346, lr_0 = 1.0000e-04
Validation rmse = 0.099746
Epoch 178
Validation rmse = 0.098232
Epoch 179
Validation rmse = 0.101685
Epoch 180
Validation rmse = 0.102224
Epoch 181
Validation rmse = 0.098799
Epoch 182
Loss = 1.9594e-02, PNorm = 34.5779, GNorm = 0.7562, lr_0 = 1.0000e-04
Validation rmse = 0.096628
Epoch 183
Validation rmse = 0.102247
Epoch 184
Validation rmse = 0.102712
Epoch 185
Validation rmse = 0.095022
Epoch 186
Validation rmse = 0.104371
Epoch 187
Validation rmse = 0.100376
Epoch 188
Loss = 1.7793e-02, PNorm = 34.5827, GNorm = 0.7635, lr_0 = 1.0000e-04
Validation rmse = 0.093473
Epoch 189
Validation rmse = 0.106128
Epoch 190
Validation rmse = 0.102604
Epoch 191
Validation rmse = 0.095513
Epoch 192
Validation rmse = 0.102456
Epoch 193
Loss = 2.0262e-02, PNorm = 34.5872, GNorm = 2.5418, lr_0 = 1.0000e-04
Validation rmse = 0.100914
Epoch 194
Validation rmse = 0.095437
Epoch 195
Validation rmse = 0.103353
Epoch 196
Validation rmse = 0.100749
Epoch 197
Validation rmse = 0.095694
Epoch 198
Loss = 1.9149e-02, PNorm = 34.5911, GNorm = 0.3189, lr_0 = 1.0000e-04
Validation rmse = 0.102920
Epoch 199
Validation rmse = 0.098597
Model 0 best validation rmse = 0.093473 on epoch 188
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.001078
Ensemble test rmse = 0.001078
1-fold cross validation
	Seed 0 ==> test rmse = 0.001078
Overall test rmse = 0.001078 +/- 0.000000
Elapsed time = 0:00:22
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 500,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/_full.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 500,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,167 | train size = 927 | val size = 234 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 8.9265e-01, PNorm = 34.0157, GNorm = 3.5732, lr_0 = 3.7500e-04
Validation rmse = 0.284287
Epoch 1
Loss = 6.9237e-01, PNorm = 34.0439, GNorm = 6.4419, lr_0 = 6.5000e-04
Loss = 7.6370e-01, PNorm = 34.0834, GNorm = 3.2127, lr_0 = 9.0000e-04
Validation rmse = 0.275983
Epoch 2
Loss = 6.7422e-01, PNorm = 34.1347, GNorm = 9.6099, lr_0 = 9.9846e-04
Loss = 6.2108e-01, PNorm = 34.1994, GNorm = 5.0969, lr_0 = 9.9590e-04
Validation rmse = 0.264101
Epoch 3
Loss = 5.0992e-01, PNorm = 34.2743, GNorm = 2.7441, lr_0 = 9.9309e-04
Loss = 4.2504e-01, PNorm = 34.3410, GNorm = 1.4447, lr_0 = 9.9054e-04
Validation rmse = 0.219661
Epoch 4
Loss = 4.4074e-01, PNorm = 34.3993, GNorm = 1.0507, lr_0 = 9.8800e-04
Loss = 3.3773e-01, PNorm = 34.4636, GNorm = 1.6378, lr_0 = 9.8547e-04
Validation rmse = 0.202566
Epoch 5
Loss = 3.1589e-01, PNorm = 34.5303, GNorm = 2.6261, lr_0 = 9.8268e-04
Loss = 2.7373e-01, PNorm = 34.5921, GNorm = 1.4337, lr_0 = 9.8016e-04
Validation rmse = 0.193705
Epoch 6
Loss = 2.9931e-01, PNorm = 34.6372, GNorm = 2.8982, lr_0 = 9.7765e-04
Validation rmse = 0.205109
Epoch 7
Loss = 2.3600e-01, PNorm = 34.6896, GNorm = 3.0650, lr_0 = 9.7489e-04
Loss = 2.9876e-01, PNorm = 34.7355, GNorm = 0.5916, lr_0 = 9.7239e-04
Validation rmse = 0.182730
Epoch 8
Loss = 2.3165e-01, PNorm = 34.7769, GNorm = 1.7872, lr_0 = 9.6989e-04
Loss = 2.4254e-01, PNorm = 34.8165, GNorm = 2.1305, lr_0 = 9.6741e-04
Validation rmse = 0.188409
Epoch 9
Loss = 2.9202e-01, PNorm = 34.8623, GNorm = 1.5001, lr_0 = 9.6468e-04
Loss = 2.0678e-01, PNorm = 34.8996, GNorm = 2.8883, lr_0 = 9.6220e-04
Validation rmse = 0.178762
Epoch 10
Loss = 2.4430e-01, PNorm = 34.9246, GNorm = 5.7038, lr_0 = 9.5973e-04
Loss = 1.9756e-01, PNorm = 34.9518, GNorm = 2.8196, lr_0 = 9.5727e-04
Validation rmse = 0.182272
Epoch 11
Loss = 2.0107e-01, PNorm = 34.9912, GNorm = 1.8989, lr_0 = 9.5457e-04
Loss = 2.1678e-01, PNorm = 35.0133, GNorm = 3.1764, lr_0 = 9.5212e-04
Validation rmse = 0.186350
Epoch 12
Loss = 2.1987e-01, PNorm = 35.0340, GNorm = 1.5958, lr_0 = 9.4968e-04
Loss = 2.6067e-01, PNorm = 35.0679, GNorm = 2.5468, lr_0 = 9.4724e-04
Validation rmse = 0.222653
Epoch 13
Loss = 3.0887e-01, PNorm = 35.1047, GNorm = 5.2081, lr_0 = 9.4481e-04
Validation rmse = 0.180167
Epoch 14
Loss = 1.4346e-01, PNorm = 35.1424, GNorm = 1.1727, lr_0 = 9.4215e-04
Loss = 2.3181e-01, PNorm = 35.1800, GNorm = 3.2900, lr_0 = 9.3973e-04
Validation rmse = 0.179305
Epoch 15
Loss = 2.2104e-01, PNorm = 35.2152, GNorm = 1.1377, lr_0 = 9.3732e-04
Loss = 2.0250e-01, PNorm = 35.2510, GNorm = 2.1875, lr_0 = 9.3491e-04
Validation rmse = 0.186186
Epoch 16
Loss = 2.3365e-01, PNorm = 35.2810, GNorm = 5.0507, lr_0 = 9.3228e-04
Loss = 2.0512e-01, PNorm = 35.3128, GNorm = 2.8065, lr_0 = 9.2989e-04
Validation rmse = 0.175635
Epoch 17
Loss = 2.0581e-01, PNorm = 35.3467, GNorm = 1.2651, lr_0 = 9.2750e-04
Loss = 2.0985e-01, PNorm = 35.3744, GNorm = 1.5486, lr_0 = 9.2512e-04
Validation rmse = 0.177348
Epoch 18
Loss = 2.2919e-01, PNorm = 35.4100, GNorm = 3.8312, lr_0 = 9.2251e-04
Loss = 1.7883e-01, PNorm = 35.4403, GNorm = 2.2739, lr_0 = 9.2014e-04
Validation rmse = 0.170025
Epoch 19
Loss = 2.0792e-01, PNorm = 35.4707, GNorm = 4.9069, lr_0 = 9.1778e-04
Loss = 2.0315e-01, PNorm = 35.4936, GNorm = 1.7162, lr_0 = 9.1543e-04
Loss = 1.6016e-01, PNorm = 35.4960, GNorm = 1.4313, lr_0 = 9.1519e-04
Validation rmse = 0.170385
Epoch 20
Loss = 2.0838e-01, PNorm = 35.5260, GNorm = 2.2970, lr_0 = 9.1285e-04
Validation rmse = 0.170854
Epoch 21
Loss = 1.4876e-01, PNorm = 35.5548, GNorm = 0.6806, lr_0 = 9.1050e-04
Loss = 1.8003e-01, PNorm = 35.5760, GNorm = 0.7376, lr_0 = 9.0817e-04
Validation rmse = 0.182465
Epoch 22
Loss = 2.3755e-01, PNorm = 35.6069, GNorm = 2.5305, lr_0 = 9.0561e-04
Loss = 1.6691e-01, PNorm = 35.6326, GNorm = 2.0398, lr_0 = 9.0328e-04
Validation rmse = 0.175156
Epoch 23
Loss = 1.6027e-01, PNorm = 35.6676, GNorm = 0.7309, lr_0 = 9.0096e-04
Loss = 1.8022e-01, PNorm = 35.6959, GNorm = 0.5898, lr_0 = 8.9865e-04
Validation rmse = 0.173724
Epoch 24
Loss = 1.6915e-01, PNorm = 35.7244, GNorm = 3.6521, lr_0 = 8.9612e-04
Loss = 1.8152e-01, PNorm = 35.7590, GNorm = 1.2019, lr_0 = 8.9382e-04
Validation rmse = 0.175787
Epoch 25
Loss = 2.0192e-01, PNorm = 35.7803, GNorm = 1.7088, lr_0 = 8.9153e-04
Loss = 1.5498e-01, PNorm = 35.8101, GNorm = 1.5973, lr_0 = 8.8924e-04
Validation rmse = 0.169258
Epoch 26
Loss = 1.8847e-01, PNorm = 35.8424, GNorm = 1.7889, lr_0 = 8.8696e-04
Loss = 1.5094e-01, PNorm = 35.8732, GNorm = 1.1545, lr_0 = 8.8468e-04
Loss = 1.5879e-01, PNorm = 35.8752, GNorm = 1.7878, lr_0 = 8.8445e-04
Validation rmse = 0.179656
Epoch 27
Loss = 1.6587e-01, PNorm = 35.9033, GNorm = 1.0649, lr_0 = 8.8219e-04
Validation rmse = 0.170672
Epoch 28
Loss = 1.8353e-01, PNorm = 35.9270, GNorm = 1.3881, lr_0 = 8.7992e-04
Loss = 1.5428e-01, PNorm = 35.9586, GNorm = 1.0888, lr_0 = 8.7767e-04
Validation rmse = 0.175997
Epoch 29
Loss = 1.4788e-01, PNorm = 35.9886, GNorm = 0.4916, lr_0 = 8.7519e-04
Loss = 1.6641e-01, PNorm = 36.0243, GNorm = 1.8520, lr_0 = 8.7294e-04
Validation rmse = 0.175424
Epoch 30
Loss = 1.5146e-01, PNorm = 36.0521, GNorm = 2.1613, lr_0 = 8.7070e-04
Loss = 1.7592e-01, PNorm = 36.0822, GNorm = 3.5359, lr_0 = 8.6847e-04
Validation rmse = 0.175812
Epoch 31
Loss = 1.6551e-01, PNorm = 36.1161, GNorm = 1.0694, lr_0 = 8.6602e-04
Loss = 1.9187e-01, PNorm = 36.1491, GNorm = 2.6058, lr_0 = 8.6380e-04
Validation rmse = 0.178796
Epoch 32
Loss = 1.5140e-01, PNorm = 36.1812, GNorm = 2.0913, lr_0 = 8.6158e-04
Loss = 1.7764e-01, PNorm = 36.2140, GNorm = 1.5129, lr_0 = 8.5937e-04
Validation rmse = 0.183499
Epoch 33
Loss = 1.7191e-01, PNorm = 36.2532, GNorm = 1.3342, lr_0 = 8.5695e-04
Loss = 1.5043e-01, PNorm = 36.2891, GNorm = 1.3646, lr_0 = 8.5475e-04
Validation rmse = 0.175357
Epoch 34
Loss = 1.5843e-01, PNorm = 36.3165, GNorm = 1.1232, lr_0 = 8.5256e-04
Validation rmse = 0.174440
Epoch 35
Loss = 1.5337e-01, PNorm = 36.3484, GNorm = 1.5844, lr_0 = 8.5015e-04
Loss = 1.7117e-01, PNorm = 36.3828, GNorm = 2.2524, lr_0 = 8.4797e-04
Validation rmse = 0.183028
Epoch 36
Loss = 1.8107e-01, PNorm = 36.4142, GNorm = 1.9157, lr_0 = 8.4579e-04
Loss = 1.5942e-01, PNorm = 36.4511, GNorm = 1.9193, lr_0 = 8.4362e-04
Validation rmse = 0.184844
Epoch 37
Loss = 1.9252e-01, PNorm = 36.4925, GNorm = 3.9364, lr_0 = 8.4124e-04
Loss = 1.5340e-01, PNorm = 36.5312, GNorm = 0.8147, lr_0 = 8.3909e-04
Validation rmse = 0.175999
Epoch 38
Loss = 1.1770e-01, PNorm = 36.5611, GNorm = 0.8070, lr_0 = 8.3693e-04
Loss = 1.5816e-01, PNorm = 36.5921, GNorm = 1.2457, lr_0 = 8.3479e-04
Validation rmse = 0.181808
Epoch 39
Loss = 1.5321e-01, PNorm = 36.6295, GNorm = 1.6589, lr_0 = 8.3264e-04
Loss = 1.5152e-01, PNorm = 36.6638, GNorm = 0.5570, lr_0 = 8.3051e-04
Validation rmse = 0.173266
Epoch 40
Loss = 1.3252e-01, PNorm = 36.6974, GNorm = 1.8613, lr_0 = 8.2817e-04
Loss = 1.6886e-01, PNorm = 36.7262, GNorm = 4.6825, lr_0 = 8.2604e-04
Validation rmse = 0.169812
Epoch 41
Loss = 1.5321e-01, PNorm = 36.7602, GNorm = 1.5271, lr_0 = 8.2392e-04
Validation rmse = 0.189520
Epoch 42
Loss = 1.6976e-01, PNorm = 36.8011, GNorm = 2.4819, lr_0 = 8.2160e-04
Loss = 1.2137e-01, PNorm = 36.8345, GNorm = 1.8194, lr_0 = 8.1949e-04
Validation rmse = 0.179486
Epoch 43
Loss = 1.3768e-01, PNorm = 36.8636, GNorm = 0.8722, lr_0 = 8.1739e-04
Loss = 1.4810e-01, PNorm = 36.8992, GNorm = 1.3067, lr_0 = 8.1529e-04
Validation rmse = 0.172762
Epoch 44
Loss = 1.3243e-01, PNorm = 36.9286, GNorm = 1.0390, lr_0 = 8.1299e-04
Loss = 1.3939e-01, PNorm = 36.9589, GNorm = 1.8326, lr_0 = 8.1090e-04
Validation rmse = 0.173265
Epoch 45
Loss = 1.4631e-01, PNorm = 36.9862, GNorm = 0.8860, lr_0 = 8.0882e-04
Loss = 1.3671e-01, PNorm = 37.0184, GNorm = 2.6949, lr_0 = 8.0675e-04
Validation rmse = 0.168947
Epoch 46
Loss = 1.3380e-01, PNorm = 37.0571, GNorm = 1.0297, lr_0 = 8.0447e-04
Loss = 1.2429e-01, PNorm = 37.0854, GNorm = 0.6867, lr_0 = 8.0241e-04
Validation rmse = 0.170861
Epoch 47
Loss = 1.2675e-01, PNorm = 37.1239, GNorm = 0.5175, lr_0 = 8.0035e-04
Validation rmse = 0.173167
Epoch 48
Loss = 1.0106e-01, PNorm = 37.1536, GNorm = 1.5098, lr_0 = 7.9809e-04
Loss = 1.2946e-01, PNorm = 37.1805, GNorm = 0.8562, lr_0 = 7.9604e-04
Validation rmse = 0.176212
Epoch 49
Loss = 1.1841e-01, PNorm = 37.2118, GNorm = 0.6089, lr_0 = 7.9400e-04
Loss = 1.1364e-01, PNorm = 37.2455, GNorm = 0.7515, lr_0 = 7.9196e-04
Validation rmse = 0.176571
Epoch 50
Loss = 1.3527e-01, PNorm = 37.2834, GNorm = 1.5119, lr_0 = 7.8993e-04
Loss = 1.3681e-01, PNorm = 37.3185, GNorm = 0.7194, lr_0 = 7.8791e-04
Validation rmse = 0.172953
Epoch 51
Loss = 1.4003e-01, PNorm = 37.3521, GNorm = 1.4781, lr_0 = 7.8568e-04
Loss = 1.2404e-01, PNorm = 37.3909, GNorm = 1.5055, lr_0 = 7.8367e-04
Validation rmse = 0.174210
Epoch 52
Loss = 1.3170e-01, PNorm = 37.4261, GNorm = 0.4865, lr_0 = 7.8166e-04
Loss = 1.1854e-01, PNorm = 37.4611, GNorm = 1.9938, lr_0 = 7.7965e-04
Validation rmse = 0.172958
Epoch 53
Loss = 1.1831e-01, PNorm = 37.4855, GNorm = 1.6173, lr_0 = 7.7745e-04
Loss = 1.1988e-01, PNorm = 37.5150, GNorm = 2.1307, lr_0 = 7.7546e-04
Validation rmse = 0.168825
Epoch 54
Loss = 1.1693e-01, PNorm = 37.5517, GNorm = 0.7410, lr_0 = 7.7347e-04
Validation rmse = 0.182797
Epoch 55
Loss = 1.2595e-01, PNorm = 37.5823, GNorm = 2.2595, lr_0 = 7.7129e-04
Loss = 1.1575e-01, PNorm = 37.6130, GNorm = 1.3924, lr_0 = 7.6931e-04
Validation rmse = 0.169897
Epoch 56
Loss = 9.3914e-02, PNorm = 37.6483, GNorm = 0.9569, lr_0 = 7.6733e-04
Loss = 1.1030e-01, PNorm = 37.6867, GNorm = 0.3157, lr_0 = 7.6537e-04
Validation rmse = 0.173548
Epoch 57
Loss = 9.7393e-02, PNorm = 37.7221, GNorm = 1.1410, lr_0 = 7.6321e-04
Loss = 1.0686e-01, PNorm = 37.7543, GNorm = 0.7850, lr_0 = 7.6125e-04
Validation rmse = 0.167309
Epoch 58
Loss = 9.7466e-02, PNorm = 37.7810, GNorm = 0.5254, lr_0 = 7.5929e-04
Loss = 1.0088e-01, PNorm = 37.8072, GNorm = 0.9705, lr_0 = 7.5735e-04
Validation rmse = 0.186558
Epoch 59
Loss = 1.3432e-01, PNorm = 37.8530, GNorm = 0.9660, lr_0 = 7.5521e-04
Loss = 1.2070e-01, PNorm = 37.8973, GNorm = 0.6454, lr_0 = 7.5327e-04
Validation rmse = 0.178173
Epoch 60
Loss = 1.0532e-01, PNorm = 37.9293, GNorm = 1.0181, lr_0 = 7.5134e-04
Loss = 1.0950e-01, PNorm = 37.9590, GNorm = 0.6158, lr_0 = 7.4941e-04
Loss = 1.6142e-01, PNorm = 37.9618, GNorm = 1.0068, lr_0 = 7.4922e-04
Validation rmse = 0.169432
Epoch 61
Loss = 1.0259e-01, PNorm = 37.9918, GNorm = 2.1722, lr_0 = 7.4730e-04
Validation rmse = 0.169639
Epoch 62
Loss = 1.1660e-01, PNorm = 38.0168, GNorm = 1.2281, lr_0 = 7.4538e-04
Loss = 9.6586e-02, PNorm = 38.0446, GNorm = 1.1241, lr_0 = 7.4347e-04
Validation rmse = 0.169662
Epoch 63
Loss = 8.2129e-02, PNorm = 38.0757, GNorm = 0.7774, lr_0 = 7.4156e-04
Loss = 9.2169e-02, PNorm = 38.1078, GNorm = 0.4787, lr_0 = 7.3966e-04
Validation rmse = 0.166428
Epoch 64
Loss = 1.0819e-01, PNorm = 38.1392, GNorm = 0.5706, lr_0 = 7.3757e-04
Loss = 9.5959e-02, PNorm = 38.1701, GNorm = 1.4950, lr_0 = 7.3568e-04
Validation rmse = 0.170192
Epoch 65
Loss = 9.1658e-02, PNorm = 38.1927, GNorm = 0.6961, lr_0 = 7.3379e-04
Loss = 1.1812e-01, PNorm = 38.2239, GNorm = 1.5751, lr_0 = 7.3191e-04
Validation rmse = 0.173676
Epoch 66
Loss = 8.9311e-02, PNorm = 38.2592, GNorm = 1.0591, lr_0 = 7.2985e-04
Loss = 1.1702e-01, PNorm = 38.2875, GNorm = 1.1389, lr_0 = 7.2797e-04
Validation rmse = 0.169446
Epoch 67
Loss = 1.2554e-01, PNorm = 38.3262, GNorm = 0.9465, lr_0 = 7.2611e-04
Loss = 1.1140e-01, PNorm = 38.3641, GNorm = 1.6893, lr_0 = 7.2424e-04
Loss = 1.1751e-01, PNorm = 38.3677, GNorm = 1.8140, lr_0 = 7.2406e-04
Validation rmse = 0.171607
Epoch 68
Loss = 8.8861e-02, PNorm = 38.3994, GNorm = 0.5455, lr_0 = 7.2220e-04
Validation rmse = 0.178589
Epoch 69
Loss = 9.4199e-02, PNorm = 38.4250, GNorm = 1.4440, lr_0 = 7.2035e-04
Loss = 8.5937e-02, PNorm = 38.4535, GNorm = 0.9212, lr_0 = 7.1850e-04
Validation rmse = 0.174863
Epoch 70
Loss = 9.4225e-02, PNorm = 38.4843, GNorm = 1.6288, lr_0 = 7.1647e-04
Loss = 9.5467e-02, PNorm = 38.5133, GNorm = 0.5902, lr_0 = 7.1463e-04
Validation rmse = 0.175116
Epoch 71
Loss = 7.0762e-02, PNorm = 38.5477, GNorm = 0.8283, lr_0 = 7.1280e-04
Loss = 8.2370e-02, PNorm = 38.5729, GNorm = 0.5763, lr_0 = 7.1097e-04
Validation rmse = 0.170940
Epoch 72
Loss = 8.6523e-02, PNorm = 38.6036, GNorm = 0.5659, lr_0 = 7.0896e-04
Loss = 8.1263e-02, PNorm = 38.6310, GNorm = 0.4610, lr_0 = 7.0715e-04
Validation rmse = 0.168270
Epoch 73
Loss = 9.3829e-02, PNorm = 38.6596, GNorm = 0.7183, lr_0 = 7.0533e-04
Loss = 7.8785e-02, PNorm = 38.6858, GNorm = 0.5568, lr_0 = 7.0352e-04
Validation rmse = 0.180561
Epoch 74
Loss = 8.2909e-02, PNorm = 38.7197, GNorm = 0.8374, lr_0 = 7.0154e-04
Loss = 8.2740e-02, PNorm = 38.7491, GNorm = 0.7293, lr_0 = 6.9974e-04
Validation rmse = 0.175185
Epoch 75
Loss = 8.6919e-02, PNorm = 38.7714, GNorm = 1.0651, lr_0 = 6.9794e-04
Validation rmse = 0.173541
Epoch 76
Loss = 7.0372e-02, PNorm = 38.7996, GNorm = 0.7991, lr_0 = 6.9615e-04
Loss = 8.9075e-02, PNorm = 38.8287, GNorm = 1.5526, lr_0 = 6.9437e-04
Validation rmse = 0.173714
Epoch 77
Loss = 7.4052e-02, PNorm = 38.8593, GNorm = 0.5992, lr_0 = 6.9241e-04
Loss = 7.3662e-02, PNorm = 38.8855, GNorm = 0.4160, lr_0 = 6.9063e-04
Validation rmse = 0.176964
Epoch 78
Loss = 6.5418e-02, PNorm = 38.9102, GNorm = 0.8486, lr_0 = 6.8886e-04
Loss = 8.5684e-02, PNorm = 38.9329, GNorm = 1.2258, lr_0 = 6.8709e-04
Validation rmse = 0.172816
Epoch 79
Loss = 5.5608e-02, PNorm = 38.9608, GNorm = 0.5916, lr_0 = 6.8515e-04
Loss = 8.7478e-02, PNorm = 38.9803, GNorm = 1.1482, lr_0 = 6.8340e-04
Validation rmse = 0.175084
Epoch 80
Loss = 6.3819e-02, PNorm = 39.0056, GNorm = 0.5907, lr_0 = 6.8164e-04
Loss = 8.3098e-02, PNorm = 39.0337, GNorm = 0.6331, lr_0 = 6.7989e-04
Validation rmse = 0.173708
Epoch 81
Loss = 6.9110e-02, PNorm = 39.0650, GNorm = 1.5246, lr_0 = 6.7798e-04
Loss = 8.3550e-02, PNorm = 39.0906, GNorm = 1.5054, lr_0 = 6.7624e-04
Validation rmse = 0.170578
Epoch 82
Loss = 7.0059e-02, PNorm = 39.1151, GNorm = 0.7258, lr_0 = 6.7450e-04
Validation rmse = 0.184232
Epoch 83
Loss = 1.0312e-01, PNorm = 39.1594, GNorm = 1.4978, lr_0 = 6.7260e-04
Loss = 9.3629e-02, PNorm = 39.1916, GNorm = 1.5806, lr_0 = 6.7087e-04
Validation rmse = 0.174714
Epoch 84
Loss = 7.4267e-02, PNorm = 39.2183, GNorm = 0.9518, lr_0 = 6.6915e-04
Loss = 6.7854e-02, PNorm = 39.2456, GNorm = 0.6144, lr_0 = 6.6743e-04
Validation rmse = 0.174080
Epoch 85
Loss = 7.2099e-02, PNorm = 39.2777, GNorm = 1.2357, lr_0 = 6.6555e-04
Loss = 7.5172e-02, PNorm = 39.3050, GNorm = 0.4340, lr_0 = 6.6384e-04
Validation rmse = 0.174627
Epoch 86
Loss = 7.0264e-02, PNorm = 39.3305, GNorm = 0.4356, lr_0 = 6.6214e-04
Loss = 7.4875e-02, PNorm = 39.3575, GNorm = 1.5544, lr_0 = 6.6044e-04
Validation rmse = 0.183850
Epoch 87
Loss = 7.6726e-02, PNorm = 39.3831, GNorm = 1.2779, lr_0 = 6.5858e-04
Loss = 8.2026e-02, PNorm = 39.4107, GNorm = 1.3014, lr_0 = 6.5689e-04
Validation rmse = 0.175502
Epoch 88
Loss = 7.0864e-02, PNorm = 39.4354, GNorm = 0.7326, lr_0 = 6.5520e-04
Loss = 6.2837e-02, PNorm = 39.4623, GNorm = 1.9011, lr_0 = 6.5352e-04
Validation rmse = 0.176062
Epoch 89
Loss = 6.7610e-02, PNorm = 39.4892, GNorm = 0.3640, lr_0 = 6.5185e-04
Validation rmse = 0.174597
Epoch 90
Loss = 6.4836e-02, PNorm = 39.5143, GNorm = 1.0583, lr_0 = 6.5001e-04
Loss = 6.9351e-02, PNorm = 39.5380, GNorm = 0.6516, lr_0 = 6.4834e-04
Validation rmse = 0.171689
Epoch 91
Loss = 5.5370e-02, PNorm = 39.5543, GNorm = 0.9344, lr_0 = 6.4668e-04
Loss = 7.3323e-02, PNorm = 39.5767, GNorm = 1.4638, lr_0 = 6.4502e-04
Validation rmse = 0.181928
Epoch 92
Loss = 8.2244e-02, PNorm = 39.6042, GNorm = 0.9876, lr_0 = 6.4320e-04
Loss = 6.4979e-02, PNorm = 39.6286, GNorm = 1.4228, lr_0 = 6.4155e-04
Validation rmse = 0.180075
Epoch 93
Loss = 7.0345e-02, PNorm = 39.6568, GNorm = 1.2899, lr_0 = 6.3990e-04
Loss = 6.3313e-02, PNorm = 39.6783, GNorm = 0.6825, lr_0 = 6.3826e-04
Validation rmse = 0.173321
Epoch 94
Loss = 5.5060e-02, PNorm = 39.7003, GNorm = 1.1001, lr_0 = 6.3646e-04
Loss = 6.3877e-02, PNorm = 39.7220, GNorm = 0.8234, lr_0 = 6.3483e-04
Validation rmse = 0.176468
Epoch 95
Loss = 6.0349e-02, PNorm = 39.7422, GNorm = 0.6812, lr_0 = 6.3320e-04
Validation rmse = 0.174225
Epoch 96
Loss = 4.4964e-02, PNorm = 39.7627, GNorm = 0.8952, lr_0 = 6.3141e-04
Loss = 5.6646e-02, PNorm = 39.7821, GNorm = 0.5599, lr_0 = 6.2979e-04
Validation rmse = 0.179047
Epoch 97
Loss = 6.5422e-02, PNorm = 39.8073, GNorm = 0.6820, lr_0 = 6.2818e-04
Loss = 5.5794e-02, PNorm = 39.8250, GNorm = 0.7052, lr_0 = 6.2656e-04
Validation rmse = 0.183816
Epoch 98
Loss = 4.8363e-02, PNorm = 39.8456, GNorm = 0.5300, lr_0 = 6.2480e-04
Loss = 7.1183e-02, PNorm = 39.8666, GNorm = 1.8158, lr_0 = 6.2319e-04
Validation rmse = 0.177606
Epoch 99
Loss = 6.1052e-02, PNorm = 39.8898, GNorm = 0.5533, lr_0 = 6.2159e-04
Loss = 5.2159e-02, PNorm = 39.9111, GNorm = 0.7965, lr_0 = 6.2000e-04
Validation rmse = 0.172498
Epoch 100
Loss = 5.7012e-02, PNorm = 39.9316, GNorm = 0.5909, lr_0 = 6.1841e-04
Loss = 6.0739e-02, PNorm = 39.9487, GNorm = 0.8017, lr_0 = 6.1682e-04
Validation rmse = 0.174460
Epoch 101
Loss = 4.4942e-02, PNorm = 39.9704, GNorm = 0.4597, lr_0 = 6.1508e-04
Loss = 5.3696e-02, PNorm = 39.9853, GNorm = 1.0139, lr_0 = 6.1350e-04
Validation rmse = 0.178615
Epoch 102
Loss = 5.0161e-02, PNorm = 40.0046, GNorm = 0.4734, lr_0 = 6.1193e-04
Validation rmse = 0.180746
Epoch 103
Loss = 3.4295e-02, PNorm = 40.0231, GNorm = 0.5980, lr_0 = 6.1020e-04
Loss = 4.9838e-02, PNorm = 40.0403, GNorm = 0.3823, lr_0 = 6.0864e-04
Validation rmse = 0.184093
Epoch 104
Loss = 4.4214e-02, PNorm = 40.0610, GNorm = 0.7987, lr_0 = 6.0708e-04
Loss = 5.1133e-02, PNorm = 40.0843, GNorm = 0.3876, lr_0 = 6.0552e-04
Validation rmse = 0.178674
Epoch 105
Loss = 4.4270e-02, PNorm = 40.1013, GNorm = 0.4299, lr_0 = 6.0381e-04
Loss = 5.2497e-02, PNorm = 40.1182, GNorm = 0.5627, lr_0 = 6.0226e-04
Validation rmse = 0.180939
Epoch 106
Loss = 5.0970e-02, PNorm = 40.1334, GNorm = 0.5765, lr_0 = 6.0072e-04
Loss = 5.0706e-02, PNorm = 40.1507, GNorm = 0.8061, lr_0 = 5.9918e-04
Validation rmse = 0.181812
Epoch 107
Loss = 5.2864e-02, PNorm = 40.1702, GNorm = 0.7638, lr_0 = 5.9749e-04
Loss = 5.3486e-02, PNorm = 40.1878, GNorm = 1.9396, lr_0 = 5.9595e-04
Validation rmse = 0.181485
Epoch 108
Loss = 5.2901e-02, PNorm = 40.2091, GNorm = 0.7394, lr_0 = 5.9442e-04
Loss = 4.7694e-02, PNorm = 40.2273, GNorm = 0.4715, lr_0 = 5.9290e-04
Loss = 6.1431e-02, PNorm = 40.2297, GNorm = 1.4508, lr_0 = 5.9275e-04
Validation rmse = 0.183754
Epoch 109
Loss = 4.1457e-02, PNorm = 40.2455, GNorm = 1.1126, lr_0 = 5.9123e-04
Validation rmse = 0.180622
Epoch 110
Loss = 3.4712e-02, PNorm = 40.2657, GNorm = 0.6613, lr_0 = 5.8971e-04
Loss = 5.1100e-02, PNorm = 40.2816, GNorm = 1.1345, lr_0 = 5.8820e-04
Validation rmse = 0.181177
Epoch 111
Loss = 5.2169e-02, PNorm = 40.3026, GNorm = 0.8398, lr_0 = 5.8654e-04
Loss = 4.8210e-02, PNorm = 40.3231, GNorm = 1.0665, lr_0 = 5.8503e-04
Validation rmse = 0.179587
Epoch 112
Loss = 6.0897e-02, PNorm = 40.3371, GNorm = 0.4508, lr_0 = 5.8353e-04
Loss = 3.8933e-02, PNorm = 40.3520, GNorm = 0.7731, lr_0 = 5.8203e-04
Validation rmse = 0.180878
Epoch 113
Loss = 3.7660e-02, PNorm = 40.3652, GNorm = 0.5092, lr_0 = 5.8054e-04
Loss = 4.7575e-02, PNorm = 40.3790, GNorm = 0.5238, lr_0 = 5.7905e-04
Validation rmse = 0.178565
Epoch 114
Loss = 3.8121e-02, PNorm = 40.4005, GNorm = 0.5473, lr_0 = 5.7742e-04
Loss = 4.8319e-02, PNorm = 40.4147, GNorm = 0.4687, lr_0 = 5.7594e-04
Validation rmse = 0.181992
Epoch 115
Loss = 4.6405e-02, PNorm = 40.4287, GNorm = 0.5453, lr_0 = 5.7446e-04
Loss = 3.9609e-02, PNorm = 40.4450, GNorm = 0.3155, lr_0 = 5.7299e-04
Loss = 1.3405e-01, PNorm = 40.4463, GNorm = 1.2822, lr_0 = 5.7284e-04
Validation rmse = 0.183183
Epoch 116
Loss = 4.0895e-02, PNorm = 40.4610, GNorm = 0.8358, lr_0 = 5.7137e-04
Validation rmse = 0.187082
Epoch 117
Loss = 2.7357e-02, PNorm = 40.4810, GNorm = 0.4715, lr_0 = 5.6990e-04
Loss = 3.6496e-02, PNorm = 40.4973, GNorm = 0.5697, lr_0 = 5.6844e-04
Validation rmse = 0.182523
Epoch 118
Loss = 3.8651e-02, PNorm = 40.5129, GNorm = 0.4445, lr_0 = 5.6684e-04
Loss = 4.8019e-02, PNorm = 40.5235, GNorm = 0.4342, lr_0 = 5.6538e-04
Validation rmse = 0.182546
Epoch 119
Loss = 3.1384e-02, PNorm = 40.5415, GNorm = 0.4148, lr_0 = 5.6393e-04
Loss = 5.0517e-02, PNorm = 40.5579, GNorm = 0.8337, lr_0 = 5.6249e-04
Validation rmse = 0.182013
Epoch 120
Loss = 3.8492e-02, PNorm = 40.5713, GNorm = 0.6242, lr_0 = 5.6090e-04
Loss = 4.5947e-02, PNorm = 40.5828, GNorm = 0.7535, lr_0 = 5.5946e-04
Validation rmse = 0.183705
Epoch 121
Loss = 4.4524e-02, PNorm = 40.6018, GNorm = 0.9991, lr_0 = 5.5802e-04
Loss = 4.3756e-02, PNorm = 40.6208, GNorm = 0.7334, lr_0 = 5.5659e-04
Validation rmse = 0.181670
Epoch 122
Loss = 4.0441e-02, PNorm = 40.6378, GNorm = 0.5636, lr_0 = 5.5502e-04
Loss = 4.2000e-02, PNorm = 40.6497, GNorm = 0.5768, lr_0 = 5.5360e-04
Validation rmse = 0.183637
Epoch 123
Loss = 3.4639e-02, PNorm = 40.6620, GNorm = 0.5910, lr_0 = 5.5218e-04
Validation rmse = 0.182466
Epoch 124
Loss = 2.5798e-02, PNorm = 40.6769, GNorm = 0.2894, lr_0 = 5.5062e-04
Loss = 3.9192e-02, PNorm = 40.6946, GNorm = 0.5973, lr_0 = 5.4921e-04
Validation rmse = 0.184605
Epoch 125
Loss = 4.2472e-02, PNorm = 40.7082, GNorm = 1.0925, lr_0 = 5.4780e-04
Loss = 3.9735e-02, PNorm = 40.7248, GNorm = 0.4809, lr_0 = 5.4639e-04
Validation rmse = 0.186800
Epoch 126
Loss = 4.2081e-02, PNorm = 40.7398, GNorm = 1.0565, lr_0 = 5.4499e-04
Loss = 4.0066e-02, PNorm = 40.7549, GNorm = 0.3285, lr_0 = 5.4359e-04
Validation rmse = 0.185605
Epoch 127
Loss = 3.2654e-02, PNorm = 40.7728, GNorm = 0.7388, lr_0 = 5.4206e-04
Loss = 4.6033e-02, PNorm = 40.7833, GNorm = 0.4992, lr_0 = 5.4067e-04
Validation rmse = 0.184393
Epoch 128
Loss = 3.2202e-02, PNorm = 40.7960, GNorm = 0.7682, lr_0 = 5.3928e-04
Loss = 3.6217e-02, PNorm = 40.8094, GNorm = 0.4511, lr_0 = 5.3790e-04
Validation rmse = 0.182981
Epoch 129
Loss = 4.0410e-02, PNorm = 40.8228, GNorm = 0.4528, lr_0 = 5.3638e-04
Loss = 3.9035e-02, PNorm = 40.8358, GNorm = 0.4953, lr_0 = 5.3501e-04
Validation rmse = 0.184876
Epoch 130
Loss = 3.3579e-02, PNorm = 40.8485, GNorm = 1.0355, lr_0 = 5.3363e-04
Validation rmse = 0.186794
Epoch 131
Loss = 3.6089e-02, PNorm = 40.8616, GNorm = 0.3657, lr_0 = 5.3213e-04
Loss = 3.8545e-02, PNorm = 40.8719, GNorm = 0.7227, lr_0 = 5.3076e-04
Validation rmse = 0.187563
Epoch 132
Loss = 2.4472e-02, PNorm = 40.8887, GNorm = 0.5175, lr_0 = 5.2940e-04
Loss = 3.8073e-02, PNorm = 40.9022, GNorm = 0.5906, lr_0 = 5.2804e-04
Validation rmse = 0.184354
Epoch 133
Loss = 3.8611e-02, PNorm = 40.9156, GNorm = 0.4261, lr_0 = 5.2655e-04
Loss = 4.2480e-02, PNorm = 40.9285, GNorm = 0.5811, lr_0 = 5.2520e-04
Validation rmse = 0.185342
Epoch 134
Loss = 2.7236e-02, PNorm = 40.9432, GNorm = 0.5625, lr_0 = 5.2385e-04
Loss = 3.5308e-02, PNorm = 40.9519, GNorm = 0.3688, lr_0 = 5.2251e-04
Validation rmse = 0.185078
Epoch 135
Loss = 3.7184e-02, PNorm = 40.9644, GNorm = 0.5570, lr_0 = 5.2104e-04
Loss = 3.8436e-02, PNorm = 40.9758, GNorm = 0.6228, lr_0 = 5.1970e-04
Validation rmse = 0.184719
Epoch 136
Loss = 2.9315e-02, PNorm = 40.9874, GNorm = 0.3676, lr_0 = 5.1837e-04
Validation rmse = 0.189665
Epoch 137
Loss = 2.6617e-02, PNorm = 41.0001, GNorm = 0.4462, lr_0 = 5.1690e-04
Loss = 3.0522e-02, PNorm = 41.0112, GNorm = 0.5138, lr_0 = 5.1558e-04
Validation rmse = 0.187353
Epoch 138
Loss = 3.4114e-02, PNorm = 41.0211, GNorm = 0.6096, lr_0 = 5.1425e-04
Loss = 2.4181e-02, PNorm = 41.0328, GNorm = 0.5542, lr_0 = 5.1294e-04
Validation rmse = 0.189133
Epoch 139
Loss = 3.3453e-02, PNorm = 41.0410, GNorm = 0.4274, lr_0 = 5.1162e-04
Loss = 2.8860e-02, PNorm = 41.0527, GNorm = 0.5330, lr_0 = 5.1031e-04
Validation rmse = 0.187578
Epoch 140
Loss = 3.5289e-02, PNorm = 41.0686, GNorm = 0.3086, lr_0 = 5.0887e-04
Loss = 3.6751e-02, PNorm = 41.0829, GNorm = 0.8534, lr_0 = 5.0756e-04
Validation rmse = 0.190080
Epoch 141
Loss = 3.9177e-02, PNorm = 41.0930, GNorm = 0.8186, lr_0 = 5.0626e-04
Loss = 3.7107e-02, PNorm = 41.1054, GNorm = 0.6331, lr_0 = 5.0496e-04
Validation rmse = 0.186335
Epoch 142
Loss = 3.1435e-02, PNorm = 41.1182, GNorm = 0.6040, lr_0 = 5.0354e-04
Loss = 3.5259e-02, PNorm = 41.1289, GNorm = 0.5793, lr_0 = 5.0224e-04
Validation rmse = 0.186881
Epoch 143
Loss = 2.4553e-02, PNorm = 41.1410, GNorm = 0.2955, lr_0 = 5.0096e-04
Validation rmse = 0.185477
Epoch 144
Loss = 1.6492e-02, PNorm = 41.1516, GNorm = 0.2704, lr_0 = 4.9954e-04
Loss = 3.1281e-02, PNorm = 41.1654, GNorm = 0.3527, lr_0 = 4.9826e-04
Validation rmse = 0.186407
Epoch 145
Loss = 2.4281e-02, PNorm = 41.1738, GNorm = 0.3859, lr_0 = 4.9698e-04
Loss = 3.8421e-02, PNorm = 41.1809, GNorm = 0.7810, lr_0 = 4.9571e-04
Validation rmse = 0.187772
Epoch 146
Loss = 2.0188e-02, PNorm = 41.1948, GNorm = 0.3126, lr_0 = 4.9431e-04
Loss = 3.1256e-02, PNorm = 41.2034, GNorm = 0.3688, lr_0 = 4.9304e-04
Validation rmse = 0.189680
Epoch 147
Loss = 3.5611e-02, PNorm = 41.2129, GNorm = 0.7745, lr_0 = 4.9178e-04
Loss = 4.2903e-02, PNorm = 41.2255, GNorm = 1.1936, lr_0 = 4.9051e-04
Validation rmse = 0.189356
Epoch 148
Loss = 2.4164e-02, PNorm = 41.2388, GNorm = 0.4904, lr_0 = 4.8913e-04
Loss = 4.0470e-02, PNorm = 41.2495, GNorm = 0.5553, lr_0 = 4.8788e-04
Validation rmse = 0.188661
Epoch 149
Loss = 3.1290e-02, PNorm = 41.2589, GNorm = 0.5056, lr_0 = 4.8662e-04
Loss = 2.9593e-02, PNorm = 41.2668, GNorm = 0.4671, lr_0 = 4.8538e-04
Validation rmse = 0.186070
Epoch 150
Loss = 2.7499e-02, PNorm = 41.2808, GNorm = 0.5601, lr_0 = 4.8413e-04
Validation rmse = 0.186122
Epoch 151
Loss = 1.2471e-02, PNorm = 41.2882, GNorm = 0.3296, lr_0 = 4.8276e-04
Loss = 3.2559e-02, PNorm = 41.2969, GNorm = 0.4740, lr_0 = 4.8153e-04
Validation rmse = 0.186230
Epoch 152
Loss = 2.5397e-02, PNorm = 41.3066, GNorm = 0.3252, lr_0 = 4.8029e-04
Loss = 3.3148e-02, PNorm = 41.3189, GNorm = 1.0240, lr_0 = 4.7906e-04
Validation rmse = 0.191525
Epoch 153
Loss = 3.3185e-02, PNorm = 41.3308, GNorm = 0.3322, lr_0 = 4.7771e-04
Loss = 3.4497e-02, PNorm = 41.3422, GNorm = 0.9888, lr_0 = 4.7648e-04
Validation rmse = 0.187248
Epoch 154
Loss = 3.1963e-02, PNorm = 41.3526, GNorm = 0.5678, lr_0 = 4.7526e-04
Loss = 3.1243e-02, PNorm = 41.3647, GNorm = 0.5649, lr_0 = 4.7404e-04
Validation rmse = 0.188120
Epoch 155
Loss = 2.7844e-02, PNorm = 41.3761, GNorm = 1.0061, lr_0 = 4.7270e-04
Loss = 3.2487e-02, PNorm = 41.3834, GNorm = 0.5972, lr_0 = 4.7149e-04
Validation rmse = 0.188433
Epoch 156
Loss = 3.1720e-02, PNorm = 41.3954, GNorm = 0.3293, lr_0 = 4.7028e-04
Loss = 3.4149e-02, PNorm = 41.4060, GNorm = 0.6194, lr_0 = 4.6907e-04
Loss = 5.4946e-02, PNorm = 41.4067, GNorm = 0.8043, lr_0 = 4.6895e-04
Validation rmse = 0.189868
Epoch 157
Loss = 2.7645e-02, PNorm = 41.4161, GNorm = 0.4441, lr_0 = 4.6775e-04
Validation rmse = 0.188819
Epoch 158
Loss = 1.5762e-02, PNorm = 41.4270, GNorm = 0.3802, lr_0 = 4.6655e-04
Loss = 2.9216e-02, PNorm = 41.4348, GNorm = 0.4198, lr_0 = 4.6535e-04
Validation rmse = 0.187365
Epoch 159
Loss = 2.0205e-02, PNorm = 41.4437, GNorm = 0.4301, lr_0 = 4.6404e-04
Loss = 3.3784e-02, PNorm = 41.4526, GNorm = 0.4844, lr_0 = 4.6285e-04
Validation rmse = 0.189847
Epoch 160
Loss = 2.7043e-02, PNorm = 41.4584, GNorm = 0.5346, lr_0 = 4.6166e-04
Loss = 2.5733e-02, PNorm = 41.4644, GNorm = 0.5506, lr_0 = 4.6048e-04
Validation rmse = 0.188263
Epoch 161
Loss = 2.6722e-02, PNorm = 41.4741, GNorm = 0.3554, lr_0 = 4.5918e-04
Loss = 2.8872e-02, PNorm = 41.4817, GNorm = 0.4997, lr_0 = 4.5800e-04
Validation rmse = 0.189895
Epoch 162
Loss = 3.4418e-02, PNorm = 41.4897, GNorm = 0.3705, lr_0 = 4.5683e-04
Loss = 2.4410e-02, PNorm = 41.4979, GNorm = 0.8585, lr_0 = 4.5565e-04
Validation rmse = 0.189896
Epoch 163
Loss = 2.5050e-02, PNorm = 41.5057, GNorm = 0.3525, lr_0 = 4.5448e-04
Loss = 2.9456e-02, PNorm = 41.5098, GNorm = 0.5284, lr_0 = 4.5332e-04
Loss = 7.4583e-03, PNorm = 41.5102, GNorm = 0.2737, lr_0 = 4.5320e-04
Validation rmse = 0.188651
Epoch 164
Loss = 3.1284e-02, PNorm = 41.5162, GNorm = 0.4032, lr_0 = 4.5204e-04
Validation rmse = 0.191855
Epoch 165
Loss = 4.4285e-02, PNorm = 41.5256, GNorm = 0.4541, lr_0 = 4.5088e-04
Loss = 3.0971e-02, PNorm = 41.5335, GNorm = 0.4163, lr_0 = 4.4972e-04
Validation rmse = 0.191595
Epoch 166
Loss = 2.7846e-02, PNorm = 41.5424, GNorm = 0.3433, lr_0 = 4.4845e-04
Loss = 3.0415e-02, PNorm = 41.5494, GNorm = 0.7944, lr_0 = 4.4730e-04
Validation rmse = 0.190649
Epoch 167
Loss = 2.8797e-02, PNorm = 41.5567, GNorm = 0.3417, lr_0 = 4.4616e-04
Loss = 2.9122e-02, PNorm = 41.5666, GNorm = 0.3292, lr_0 = 4.4501e-04
Validation rmse = 0.188626
Epoch 168
Loss = 3.1875e-02, PNorm = 41.5759, GNorm = 0.5609, lr_0 = 4.4376e-04
Loss = 2.5743e-02, PNorm = 41.5841, GNorm = 0.2871, lr_0 = 4.4262e-04
Validation rmse = 0.191382
Epoch 169
Loss = 2.8373e-02, PNorm = 41.5905, GNorm = 0.6714, lr_0 = 4.4148e-04
Loss = 2.9244e-02, PNorm = 41.6012, GNorm = 0.3136, lr_0 = 4.4035e-04
Validation rmse = 0.189143
Epoch 170
Loss = 3.2829e-02, PNorm = 41.6097, GNorm = 0.5508, lr_0 = 4.3911e-04
Loss = 2.6398e-02, PNorm = 41.6165, GNorm = 0.7195, lr_0 = 4.3798e-04
Validation rmse = 0.193165
Epoch 171
Loss = 2.7545e-02, PNorm = 41.6224, GNorm = 0.8174, lr_0 = 4.3686e-04
Validation rmse = 0.189507
Epoch 172
Loss = 1.7840e-02, PNorm = 41.6330, GNorm = 0.5554, lr_0 = 4.3562e-04
Loss = 2.7208e-02, PNorm = 41.6369, GNorm = 0.8835, lr_0 = 4.3451e-04
Validation rmse = 0.189811
Epoch 173
Loss = 2.0568e-02, PNorm = 41.6468, GNorm = 0.4798, lr_0 = 4.3339e-04
Loss = 3.1825e-02, PNorm = 41.6563, GNorm = 0.6293, lr_0 = 4.3228e-04
Validation rmse = 0.189463
Epoch 174
Loss = 2.2722e-02, PNorm = 41.6640, GNorm = 0.5071, lr_0 = 4.3106e-04
Loss = 2.4796e-02, PNorm = 41.6726, GNorm = 0.2933, lr_0 = 4.2995e-04
Validation rmse = 0.191622
Epoch 175
Loss = 2.4108e-02, PNorm = 41.6779, GNorm = 0.4626, lr_0 = 4.2885e-04
Loss = 2.8413e-02, PNorm = 41.6838, GNorm = 0.5073, lr_0 = 4.2775e-04
Validation rmse = 0.195659
Epoch 176
Loss = 3.2108e-02, PNorm = 41.6915, GNorm = 0.3766, lr_0 = 4.2665e-04
Loss = 2.4883e-02, PNorm = 41.6976, GNorm = 0.4978, lr_0 = 4.2556e-04
Validation rmse = 0.189743
Epoch 177
Loss = 3.0237e-02, PNorm = 41.7078, GNorm = 0.3889, lr_0 = 4.2436e-04
Loss = 2.8516e-02, PNorm = 41.7155, GNorm = 0.4793, lr_0 = 4.2327e-04
Validation rmse = 0.191841
Epoch 178
Loss = 2.6458e-02, PNorm = 41.7232, GNorm = 0.2634, lr_0 = 4.2218e-04
Validation rmse = 0.190761
Epoch 179
Loss = 1.4248e-02, PNorm = 41.7314, GNorm = 0.3390, lr_0 = 4.2099e-04
Loss = 1.9297e-02, PNorm = 41.7381, GNorm = 0.3472, lr_0 = 4.1991e-04
Validation rmse = 0.190428
Epoch 180
Loss = 2.3307e-02, PNorm = 41.7436, GNorm = 0.4126, lr_0 = 4.1884e-04
Loss = 2.2981e-02, PNorm = 41.7493, GNorm = 0.4250, lr_0 = 4.1776e-04
Validation rmse = 0.191238
Epoch 181
Loss = 1.9713e-02, PNorm = 41.7580, GNorm = 0.3290, lr_0 = 4.1658e-04
Loss = 2.7447e-02, PNorm = 41.7666, GNorm = 0.3311, lr_0 = 4.1551e-04
Validation rmse = 0.189866
Epoch 182
Loss = 2.8026e-02, PNorm = 41.7713, GNorm = 0.7001, lr_0 = 4.1445e-04
Loss = 2.5431e-02, PNorm = 41.7758, GNorm = 0.8639, lr_0 = 4.1338e-04
Validation rmse = 0.189482
Epoch 183
Loss = 2.4098e-02, PNorm = 41.7818, GNorm = 0.6531, lr_0 = 4.1222e-04
Loss = 2.8081e-02, PNorm = 41.7900, GNorm = 0.4458, lr_0 = 4.1116e-04
Validation rmse = 0.193122
Epoch 184
Loss = 2.6839e-02, PNorm = 41.7973, GNorm = 0.5269, lr_0 = 4.1011e-04
Validation rmse = 0.190345
Epoch 185
Loss = 2.5501e-02, PNorm = 41.8043, GNorm = 0.4265, lr_0 = 4.0895e-04
Loss = 2.4743e-02, PNorm = 41.8122, GNorm = 1.1347, lr_0 = 4.0790e-04
Validation rmse = 0.192122
Epoch 186
Loss = 2.7171e-02, PNorm = 41.8186, GNorm = 0.6031, lr_0 = 4.0685e-04
Loss = 2.7926e-02, PNorm = 41.8245, GNorm = 0.7694, lr_0 = 4.0581e-04
Validation rmse = 0.192681
Epoch 187
Loss = 2.6574e-02, PNorm = 41.8333, GNorm = 0.6477, lr_0 = 4.0466e-04
Loss = 3.1472e-02, PNorm = 41.8411, GNorm = 0.6990, lr_0 = 4.0363e-04
Validation rmse = 0.192655
Epoch 188
Loss = 2.9198e-02, PNorm = 41.8488, GNorm = 0.5903, lr_0 = 4.0259e-04
Loss = 2.1252e-02, PNorm = 41.8574, GNorm = 0.6869, lr_0 = 4.0156e-04
Validation rmse = 0.190193
Epoch 189
Loss = 2.6627e-02, PNorm = 41.8624, GNorm = 0.5846, lr_0 = 4.0053e-04
Loss = 3.0940e-02, PNorm = 41.8701, GNorm = 0.1996, lr_0 = 3.9950e-04
Validation rmse = 0.191613
Epoch 190
Loss = 1.8210e-02, PNorm = 41.8783, GNorm = 0.2240, lr_0 = 3.9837e-04
Loss = 3.2512e-02, PNorm = 41.8845, GNorm = 0.3623, lr_0 = 3.9735e-04
Validation rmse = 0.190234
Epoch 191
Loss = 2.2657e-02, PNorm = 41.8898, GNorm = 0.4514, lr_0 = 3.9633e-04
Validation rmse = 0.193828
Epoch 192
Loss = 3.2167e-02, PNorm = 41.8962, GNorm = 0.3457, lr_0 = 3.9521e-04
Loss = 2.6023e-02, PNorm = 41.9048, GNorm = 0.6852, lr_0 = 3.9420e-04
Validation rmse = 0.193769
Epoch 193
Loss = 1.0594e-02, PNorm = 41.9123, GNorm = 0.2643, lr_0 = 3.9319e-04
Loss = 2.4636e-02, PNorm = 41.9179, GNorm = 0.4356, lr_0 = 3.9218e-04
Validation rmse = 0.192097
Epoch 194
Loss = 1.7725e-02, PNorm = 41.9232, GNorm = 0.4667, lr_0 = 3.9107e-04
Loss = 2.9856e-02, PNorm = 41.9291, GNorm = 1.3953, lr_0 = 3.9007e-04
Validation rmse = 0.193456
Epoch 195
Loss = 2.6471e-02, PNorm = 41.9354, GNorm = 0.5550, lr_0 = 3.8907e-04
Loss = 2.5917e-02, PNorm = 41.9408, GNorm = 0.8445, lr_0 = 3.8807e-04
Validation rmse = 0.192495
Epoch 196
Loss = 2.9132e-02, PNorm = 41.9483, GNorm = 0.3371, lr_0 = 3.8698e-04
Loss = 2.6679e-02, PNorm = 41.9535, GNorm = 0.6387, lr_0 = 3.8598e-04
Validation rmse = 0.193124
Epoch 197
Loss = 2.5200e-02, PNorm = 41.9596, GNorm = 0.5968, lr_0 = 3.8499e-04
Loss = 2.5780e-02, PNorm = 41.9645, GNorm = 0.5235, lr_0 = 3.8401e-04
Loss = 2.1884e-02, PNorm = 41.9651, GNorm = 0.4209, lr_0 = 3.8391e-04
Validation rmse = 0.191326
Epoch 198
Loss = 2.6561e-02, PNorm = 41.9712, GNorm = 0.6475, lr_0 = 3.8292e-04
Validation rmse = 0.192853
Epoch 199
Loss = 3.0641e-02, PNorm = 41.9770, GNorm = 0.4567, lr_0 = 3.8194e-04
Loss = 2.4122e-02, PNorm = 41.9822, GNorm = 0.3337, lr_0 = 3.8096e-04
Validation rmse = 0.192659
Epoch 200
Loss = 4.1268e-02, PNorm = 41.9889, GNorm = 0.6882, lr_0 = 3.7998e-04
Loss = 2.7881e-02, PNorm = 41.9955, GNorm = 0.5145, lr_0 = 3.7901e-04
Validation rmse = 0.191947
Epoch 201
Loss = 2.2498e-02, PNorm = 42.0001, GNorm = 0.4308, lr_0 = 3.7794e-04
Loss = 2.4300e-02, PNorm = 42.0047, GNorm = 0.4120, lr_0 = 3.7697e-04
Validation rmse = 0.191239
Epoch 202
Loss = 1.3588e-02, PNorm = 42.0068, GNorm = 0.4147, lr_0 = 3.7600e-04
Loss = 2.3282e-02, PNorm = 42.0120, GNorm = 0.3669, lr_0 = 3.7504e-04
Validation rmse = 0.190655
Epoch 203
Loss = 1.9541e-02, PNorm = 42.0169, GNorm = 0.5252, lr_0 = 3.7398e-04
Loss = 2.3829e-02, PNorm = 42.0243, GNorm = 0.3652, lr_0 = 3.7302e-04
Validation rmse = 0.192449
Epoch 204
Loss = 2.7623e-02, PNorm = 42.0302, GNorm = 0.3997, lr_0 = 3.7206e-04
Loss = 2.0272e-02, PNorm = 42.0345, GNorm = 0.3186, lr_0 = 3.7111e-04
Loss = 1.8408e-02, PNorm = 42.0347, GNorm = 0.4155, lr_0 = 3.7101e-04
Validation rmse = 0.193024
Epoch 205
Loss = 2.4415e-02, PNorm = 42.0397, GNorm = 0.2264, lr_0 = 3.7006e-04
Validation rmse = 0.192752
Epoch 206
Loss = 4.2336e-03, PNorm = 42.0444, GNorm = 0.1901, lr_0 = 3.6911e-04
Loss = 1.6057e-02, PNorm = 42.0488, GNorm = 0.3481, lr_0 = 3.6816e-04
Validation rmse = 0.191690
Epoch 207
Loss = 4.1368e-02, PNorm = 42.0534, GNorm = 0.4459, lr_0 = 3.6713e-04
Loss = 1.8549e-02, PNorm = 42.0589, GNorm = 0.4982, lr_0 = 3.6618e-04
Validation rmse = 0.194643
Epoch 208
Loss = 3.0188e-02, PNorm = 42.0651, GNorm = 1.0031, lr_0 = 3.6524e-04
Loss = 2.2813e-02, PNorm = 42.0708, GNorm = 0.2562, lr_0 = 3.6431e-04
Validation rmse = 0.193024
Epoch 209
Loss = 3.2574e-02, PNorm = 42.0782, GNorm = 0.8348, lr_0 = 3.6328e-04
Loss = 2.0768e-02, PNorm = 42.0840, GNorm = 0.3643, lr_0 = 3.6235e-04
Validation rmse = 0.193315
Epoch 210
Loss = 2.1852e-02, PNorm = 42.0894, GNorm = 0.2568, lr_0 = 3.6142e-04
Loss = 2.0655e-02, PNorm = 42.0949, GNorm = 0.4102, lr_0 = 3.6049e-04
Validation rmse = 0.194843
Epoch 211
Loss = 2.5761e-02, PNorm = 42.0985, GNorm = 0.2582, lr_0 = 3.5947e-04
Loss = 2.2117e-02, PNorm = 42.1026, GNorm = 0.5261, lr_0 = 3.5855e-04
Validation rmse = 0.192782
Epoch 212
Loss = 2.2356e-02, PNorm = 42.1085, GNorm = 0.7529, lr_0 = 3.5763e-04
Validation rmse = 0.193299
Epoch 213
Loss = 6.8222e-03, PNorm = 42.1143, GNorm = 0.3674, lr_0 = 3.5671e-04
Loss = 2.3360e-02, PNorm = 42.1197, GNorm = 0.3254, lr_0 = 3.5580e-04
Validation rmse = 0.194083
Epoch 214
Loss = 2.1579e-02, PNorm = 42.1250, GNorm = 0.2697, lr_0 = 3.5480e-04
Loss = 2.1784e-02, PNorm = 42.1291, GNorm = 0.3684, lr_0 = 3.5388e-04
Validation rmse = 0.192266
Epoch 215
Loss = 1.3483e-02, PNorm = 42.1346, GNorm = 0.3135, lr_0 = 3.5298e-04
Loss = 2.7552e-02, PNorm = 42.1389, GNorm = 0.8811, lr_0 = 3.5207e-04
Validation rmse = 0.193372
Epoch 216
Loss = 2.6351e-02, PNorm = 42.1451, GNorm = 0.5404, lr_0 = 3.5108e-04
Loss = 2.2911e-02, PNorm = 42.1504, GNorm = 0.3152, lr_0 = 3.5018e-04
Validation rmse = 0.194750
Epoch 217
Loss = 2.5494e-02, PNorm = 42.1551, GNorm = 0.4741, lr_0 = 3.4928e-04
Loss = 2.3739e-02, PNorm = 42.1594, GNorm = 0.5005, lr_0 = 3.4838e-04
Validation rmse = 0.192812
Epoch 218
Loss = 2.8921e-02, PNorm = 42.1625, GNorm = 1.0718, lr_0 = 3.4740e-04
Loss = 1.9871e-02, PNorm = 42.1678, GNorm = 0.5583, lr_0 = 3.4651e-04
Validation rmse = 0.193550
Epoch 219
Loss = 2.5238e-02, PNorm = 42.1730, GNorm = 0.3323, lr_0 = 3.4562e-04
Validation rmse = 0.193873
Epoch 220
Loss = 9.9067e-03, PNorm = 42.1751, GNorm = 0.4068, lr_0 = 3.4464e-04
Loss = 2.5952e-02, PNorm = 42.1793, GNorm = 0.3004, lr_0 = 3.4376e-04
Validation rmse = 0.195358
Epoch 221
Loss = 1.5564e-02, PNorm = 42.1842, GNorm = 0.5045, lr_0 = 3.4288e-04
Loss = 2.4292e-02, PNorm = 42.1907, GNorm = 0.4788, lr_0 = 3.4200e-04
Validation rmse = 0.194290
Epoch 222
Loss = 1.0997e-02, PNorm = 42.1934, GNorm = 0.2970, lr_0 = 3.4103e-04
Loss = 2.9341e-02, PNorm = 42.1956, GNorm = 0.5861, lr_0 = 3.4016e-04
Validation rmse = 0.195752
Epoch 223
Loss = 2.6133e-02, PNorm = 42.2022, GNorm = 0.5590, lr_0 = 3.3929e-04
Loss = 2.1611e-02, PNorm = 42.2093, GNorm = 0.3442, lr_0 = 3.3842e-04
Validation rmse = 0.194790
Epoch 224
Loss = 2.3872e-02, PNorm = 42.2138, GNorm = 0.5856, lr_0 = 3.3746e-04
Loss = 2.3756e-02, PNorm = 42.2200, GNorm = 0.1254, lr_0 = 3.3660e-04
Validation rmse = 0.194184
Epoch 225
Loss = 2.0419e-02, PNorm = 42.2230, GNorm = 0.2748, lr_0 = 3.3573e-04
Loss = 2.3552e-02, PNorm = 42.2265, GNorm = 0.4945, lr_0 = 3.3487e-04
Validation rmse = 0.193233
Epoch 226
Loss = 2.4858e-02, PNorm = 42.2313, GNorm = 0.3719, lr_0 = 3.3401e-04
Validation rmse = 0.194692
Epoch 227
Loss = 1.8065e-02, PNorm = 42.2377, GNorm = 0.4224, lr_0 = 3.3307e-04
Loss = 2.4967e-02, PNorm = 42.2417, GNorm = 0.4285, lr_0 = 3.3221e-04
Validation rmse = 0.194029
Epoch 228
Loss = 1.9310e-02, PNorm = 42.2457, GNorm = 0.8015, lr_0 = 3.3136e-04
Loss = 2.0230e-02, PNorm = 42.2492, GNorm = 0.7750, lr_0 = 3.3051e-04
Validation rmse = 0.193395
Epoch 229
Loss = 1.6344e-02, PNorm = 42.2548, GNorm = 0.3311, lr_0 = 3.2958e-04
Loss = 2.7595e-02, PNorm = 42.2585, GNorm = 0.6367, lr_0 = 3.2873e-04
Validation rmse = 0.195124
Epoch 230
Loss = 1.8576e-02, PNorm = 42.2641, GNorm = 0.5509, lr_0 = 3.2789e-04
Loss = 2.3051e-02, PNorm = 42.2671, GNorm = 0.3445, lr_0 = 3.2705e-04
Validation rmse = 0.194940
Epoch 231
Loss = 2.5830e-02, PNorm = 42.2718, GNorm = 0.3663, lr_0 = 3.2613e-04
Loss = 1.8948e-02, PNorm = 42.2758, GNorm = 0.6370, lr_0 = 3.2529e-04
Validation rmse = 0.193918
Epoch 232
Loss = 1.6347e-02, PNorm = 42.2784, GNorm = 0.3665, lr_0 = 3.2446e-04
Validation rmse = 0.193454
Epoch 233
Loss = 1.2502e-02, PNorm = 42.2819, GNorm = 0.3046, lr_0 = 3.2354e-04
Loss = 2.4400e-02, PNorm = 42.2865, GNorm = 0.6520, lr_0 = 3.2271e-04
Validation rmse = 0.193256
Epoch 234
Loss = 1.3102e-02, PNorm = 42.2905, GNorm = 0.6640, lr_0 = 3.2188e-04
Loss = 2.2342e-02, PNorm = 42.2946, GNorm = 0.3508, lr_0 = 3.2106e-04
Validation rmse = 0.194453
Epoch 235
Loss = 1.1777e-02, PNorm = 42.2973, GNorm = 0.2112, lr_0 = 3.2015e-04
Loss = 2.3645e-02, PNorm = 42.3026, GNorm = 0.5304, lr_0 = 3.1933e-04
Validation rmse = 0.192465
Epoch 236
Loss = 1.6660e-02, PNorm = 42.3064, GNorm = 0.3045, lr_0 = 3.1851e-04
Loss = 2.2045e-02, PNorm = 42.3096, GNorm = 0.2268, lr_0 = 3.1769e-04
Validation rmse = 0.191893
Epoch 237
Loss = 2.2580e-02, PNorm = 42.3137, GNorm = 0.4463, lr_0 = 3.1680e-04
Loss = 2.1655e-02, PNorm = 42.3173, GNorm = 0.4759, lr_0 = 3.1598e-04
Validation rmse = 0.195174
Epoch 238
Loss = 2.1014e-02, PNorm = 42.3219, GNorm = 0.4199, lr_0 = 3.1517e-04
Loss = 2.2681e-02, PNorm = 42.3244, GNorm = 0.2694, lr_0 = 3.1436e-04
Validation rmse = 0.193847
Epoch 239
Loss = 2.3904e-02, PNorm = 42.3297, GNorm = 0.9113, lr_0 = 3.1356e-04
Validation rmse = 0.193485
Epoch 240
Loss = 1.5703e-02, PNorm = 42.3326, GNorm = 0.3442, lr_0 = 3.1267e-04
Loss = 2.1122e-02, PNorm = 42.3350, GNorm = 0.7981, lr_0 = 3.1187e-04
Validation rmse = 0.193109
Epoch 241
Loss = 2.9678e-02, PNorm = 42.3403, GNorm = 0.1535, lr_0 = 3.1107e-04
Loss = 1.8873e-02, PNorm = 42.3467, GNorm = 0.3023, lr_0 = 3.1027e-04
Validation rmse = 0.195087
Epoch 242
Loss = 1.6590e-02, PNorm = 42.3496, GNorm = 0.3159, lr_0 = 3.0940e-04
Loss = 2.3966e-02, PNorm = 42.3512, GNorm = 0.2441, lr_0 = 3.0860e-04
Validation rmse = 0.193880
Epoch 243
Loss = 2.0147e-02, PNorm = 42.3543, GNorm = 0.4237, lr_0 = 3.0781e-04
Loss = 2.3962e-02, PNorm = 42.3586, GNorm = 0.5673, lr_0 = 3.0702e-04
Validation rmse = 0.194161
Epoch 244
Loss = 1.8992e-02, PNorm = 42.3641, GNorm = 0.3731, lr_0 = 3.0616e-04
Loss = 2.4751e-02, PNorm = 42.3681, GNorm = 0.5796, lr_0 = 3.0537e-04
Validation rmse = 0.196765
Epoch 245
Loss = 2.2081e-02, PNorm = 42.3719, GNorm = 0.2033, lr_0 = 3.0459e-04
Loss = 2.1733e-02, PNorm = 42.3762, GNorm = 0.2717, lr_0 = 3.0381e-04
Loss = 4.6839e-02, PNorm = 42.3767, GNorm = 0.5019, lr_0 = 3.0373e-04
Validation rmse = 0.196396
Epoch 246
Loss = 2.0278e-02, PNorm = 42.3802, GNorm = 0.4375, lr_0 = 3.0295e-04
Validation rmse = 0.193832
Epoch 247
Loss = 8.9154e-03, PNorm = 42.3847, GNorm = 0.3812, lr_0 = 3.0217e-04
Loss = 1.9827e-02, PNorm = 42.3885, GNorm = 0.8220, lr_0 = 3.0140e-04
Validation rmse = 0.193870
Epoch 248
Loss = 1.9735e-02, PNorm = 42.3928, GNorm = 0.6744, lr_0 = 3.0055e-04
Loss = 1.8171e-02, PNorm = 42.3974, GNorm = 0.3097, lr_0 = 2.9978e-04
Validation rmse = 0.191867
Epoch 249
Loss = 3.4566e-02, PNorm = 42.4009, GNorm = 0.6067, lr_0 = 2.9901e-04
Loss = 1.6650e-02, PNorm = 42.4045, GNorm = 0.4413, lr_0 = 2.9824e-04
Validation rmse = 0.194681
Epoch 250
Loss = 1.7875e-02, PNorm = 42.4107, GNorm = 0.3601, lr_0 = 2.9747e-04
Loss = 2.5574e-02, PNorm = 42.4152, GNorm = 0.3477, lr_0 = 2.9671e-04
Validation rmse = 0.192886
Epoch 251
Loss = 2.4685e-02, PNorm = 42.4181, GNorm = 0.2957, lr_0 = 2.9587e-04
Loss = 2.1867e-02, PNorm = 42.4213, GNorm = 0.2669, lr_0 = 2.9511e-04
Validation rmse = 0.194996
Epoch 252
Loss = 2.5061e-02, PNorm = 42.4242, GNorm = 0.4985, lr_0 = 2.9436e-04
Loss = 1.7407e-02, PNorm = 42.4272, GNorm = 0.2423, lr_0 = 2.9360e-04
Loss = 1.1159e-02, PNorm = 42.4275, GNorm = 0.3132, lr_0 = 2.9353e-04
Validation rmse = 0.193994
Epoch 253
Loss = 1.2377e-02, PNorm = 42.4300, GNorm = 0.2561, lr_0 = 2.9277e-04
Validation rmse = 0.193757
Epoch 254
Loss = 7.1379e-03, PNorm = 42.4338, GNorm = 0.2746, lr_0 = 2.9202e-04
Loss = 1.7156e-02, PNorm = 42.4388, GNorm = 0.4585, lr_0 = 2.9127e-04
Validation rmse = 0.195873
Epoch 255
Loss = 2.2495e-02, PNorm = 42.4426, GNorm = 0.5188, lr_0 = 2.9045e-04
Loss = 2.0282e-02, PNorm = 42.4448, GNorm = 0.4525, lr_0 = 2.8971e-04
Validation rmse = 0.194484
Epoch 256
Loss = 1.5862e-02, PNorm = 42.4471, GNorm = 0.2951, lr_0 = 2.8896e-04
Loss = 1.9501e-02, PNorm = 42.4506, GNorm = 0.4057, lr_0 = 2.8822e-04
Validation rmse = 0.193203
Epoch 257
Loss = 1.9456e-02, PNorm = 42.4523, GNorm = 0.2873, lr_0 = 2.8741e-04
Loss = 1.8164e-02, PNorm = 42.4557, GNorm = 0.2747, lr_0 = 2.8667e-04
Validation rmse = 0.194438
Epoch 258
Loss = 1.1765e-02, PNorm = 42.4579, GNorm = 0.1483, lr_0 = 2.8594e-04
Loss = 2.6519e-02, PNorm = 42.4615, GNorm = 0.3142, lr_0 = 2.8520e-04
Validation rmse = 0.194507
Epoch 259
Loss = 1.7001e-02, PNorm = 42.4663, GNorm = 0.1896, lr_0 = 2.8440e-04
Loss = 2.2158e-02, PNorm = 42.4680, GNorm = 0.3409, lr_0 = 2.8367e-04
Validation rmse = 0.194874
Epoch 260
Loss = 2.1396e-02, PNorm = 42.4707, GNorm = 0.2566, lr_0 = 2.8294e-04
Validation rmse = 0.195291
Epoch 261
Loss = 9.4517e-03, PNorm = 42.4747, GNorm = 0.8090, lr_0 = 2.8214e-04
Loss = 1.7391e-02, PNorm = 42.4776, GNorm = 0.3869, lr_0 = 2.8142e-04
Validation rmse = 0.194837
Epoch 262
Loss = 1.6371e-02, PNorm = 42.4800, GNorm = 0.5230, lr_0 = 2.8070e-04
Loss = 2.1865e-02, PNorm = 42.4845, GNorm = 0.3455, lr_0 = 2.7998e-04
Validation rmse = 0.194226
Epoch 263
Loss = 1.8540e-02, PNorm = 42.4879, GNorm = 0.5990, lr_0 = 2.7926e-04
Loss = 2.3264e-02, PNorm = 42.4909, GNorm = 0.4765, lr_0 = 2.7854e-04
Validation rmse = 0.193731
Epoch 264
Loss = 1.7875e-02, PNorm = 42.4951, GNorm = 0.3467, lr_0 = 2.7776e-04
Loss = 2.2725e-02, PNorm = 42.4983, GNorm = 0.6189, lr_0 = 2.7704e-04
Validation rmse = 0.193948
Epoch 265
Loss = 3.2427e-02, PNorm = 42.5019, GNorm = 0.5278, lr_0 = 2.7633e-04
Loss = 1.4024e-02, PNorm = 42.5049, GNorm = 0.4178, lr_0 = 2.7562e-04
Validation rmse = 0.193088
Epoch 266
Loss = 1.6436e-02, PNorm = 42.5083, GNorm = 0.2123, lr_0 = 2.7485e-04
Loss = 2.4488e-02, PNorm = 42.5106, GNorm = 0.3389, lr_0 = 2.7414e-04
Validation rmse = 0.193717
Epoch 267
Loss = 1.7934e-02, PNorm = 42.5153, GNorm = 0.3223, lr_0 = 2.7344e-04
Validation rmse = 0.195185
Epoch 268
Loss = 9.8797e-03, PNorm = 42.5199, GNorm = 0.1032, lr_0 = 2.7267e-04
Loss = 2.8352e-02, PNorm = 42.5235, GNorm = 0.6086, lr_0 = 2.7197e-04
Validation rmse = 0.195643
Epoch 269
Loss = 3.2053e-02, PNorm = 42.5267, GNorm = 0.5590, lr_0 = 2.7127e-04
Loss = 1.5967e-02, PNorm = 42.5303, GNorm = 0.3187, lr_0 = 2.7057e-04
Validation rmse = 0.195618
Epoch 270
Loss = 1.5561e-02, PNorm = 42.5344, GNorm = 0.5853, lr_0 = 2.6981e-04
Loss = 1.8690e-02, PNorm = 42.5381, GNorm = 0.4347, lr_0 = 2.6912e-04
Validation rmse = 0.193449
Epoch 271
Loss = 2.2324e-02, PNorm = 42.5402, GNorm = 0.2597, lr_0 = 2.6843e-04
Loss = 2.1040e-02, PNorm = 42.5435, GNorm = 0.4653, lr_0 = 2.6774e-04
Validation rmse = 0.195152
Epoch 272
Loss = 1.9890e-02, PNorm = 42.5473, GNorm = 0.1925, lr_0 = 2.6698e-04
Loss = 2.1284e-02, PNorm = 42.5495, GNorm = 0.5055, lr_0 = 2.6630e-04
Validation rmse = 0.196405
Epoch 273
Loss = 1.3339e-02, PNorm = 42.5521, GNorm = 0.2650, lr_0 = 2.6561e-04
Validation rmse = 0.195920
Epoch 274
Loss = 1.9096e-02, PNorm = 42.5546, GNorm = 0.3200, lr_0 = 2.6487e-04
Loss = 2.4212e-02, PNorm = 42.5566, GNorm = 0.9348, lr_0 = 2.6419e-04
Validation rmse = 0.195075
Epoch 275
Loss = 8.1537e-03, PNorm = 42.5599, GNorm = 0.1750, lr_0 = 2.6351e-04
Loss = 1.7193e-02, PNorm = 42.5615, GNorm = 0.3165, lr_0 = 2.6283e-04
Validation rmse = 0.196121
Epoch 276
Loss = 1.3418e-02, PNorm = 42.5657, GNorm = 0.2160, lr_0 = 2.6216e-04
Loss = 2.5530e-02, PNorm = 42.5703, GNorm = 0.8835, lr_0 = 2.6149e-04
Validation rmse = 0.194217
Epoch 277
Loss = 2.6858e-02, PNorm = 42.5738, GNorm = 0.4839, lr_0 = 2.6075e-04
Loss = 1.6848e-02, PNorm = 42.5764, GNorm = 0.4227, lr_0 = 2.6008e-04
Validation rmse = 0.194281
Epoch 278
Loss = 1.6758e-02, PNorm = 42.5786, GNorm = 0.2281, lr_0 = 2.5941e-04
Loss = 2.3312e-02, PNorm = 42.5806, GNorm = 0.2927, lr_0 = 2.5875e-04
Validation rmse = 0.195811
Epoch 279
Loss = 1.7767e-02, PNorm = 42.5860, GNorm = 0.2016, lr_0 = 2.5802e-04
Loss = 2.2344e-02, PNorm = 42.5886, GNorm = 0.1758, lr_0 = 2.5735e-04
Validation rmse = 0.195180
Epoch 280
Loss = 1.7834e-02, PNorm = 42.5919, GNorm = 0.2642, lr_0 = 2.5669e-04
Validation rmse = 0.195563
Epoch 281
Loss = 5.6020e-02, PNorm = 42.5950, GNorm = 0.6256, lr_0 = 2.5597e-04
Loss = 1.8197e-02, PNorm = 42.5979, GNorm = 0.6721, lr_0 = 2.5531e-04
Validation rmse = 0.196166
Epoch 282
Loss = 2.4270e-02, PNorm = 42.5998, GNorm = 0.4869, lr_0 = 2.5466e-04
Loss = 2.3282e-02, PNorm = 42.6027, GNorm = 0.3610, lr_0 = 2.5400e-04
Validation rmse = 0.196642
Epoch 283
Loss = 1.7633e-02, PNorm = 42.6059, GNorm = 0.3284, lr_0 = 2.5329e-04
Loss = 2.0633e-02, PNorm = 42.6085, GNorm = 0.3396, lr_0 = 2.5264e-04
Validation rmse = 0.194636
Epoch 284
Loss = 2.2270e-02, PNorm = 42.6114, GNorm = 0.3361, lr_0 = 2.5199e-04
Loss = 1.9279e-02, PNorm = 42.6145, GNorm = 0.8951, lr_0 = 2.5134e-04
Validation rmse = 0.195062
Epoch 285
Loss = 2.0374e-02, PNorm = 42.6163, GNorm = 0.6227, lr_0 = 2.5063e-04
Loss = 2.1259e-02, PNorm = 42.6181, GNorm = 0.5142, lr_0 = 2.4999e-04
Validation rmse = 0.195327
Epoch 286
Loss = 1.9387e-02, PNorm = 42.6196, GNorm = 0.4253, lr_0 = 2.4935e-04
Loss = 2.1951e-02, PNorm = 42.6219, GNorm = 0.3375, lr_0 = 2.4871e-04
Loss = 1.1540e-02, PNorm = 42.6224, GNorm = 0.2522, lr_0 = 2.4865e-04
Validation rmse = 0.195047
Epoch 287
Loss = 2.2830e-02, PNorm = 42.6270, GNorm = 0.2916, lr_0 = 2.4801e-04
Validation rmse = 0.197020
Epoch 288
Loss = 4.5860e-02, PNorm = 42.6308, GNorm = 0.5880, lr_0 = 2.4737e-04
Loss = 2.0955e-02, PNorm = 42.6329, GNorm = 0.8065, lr_0 = 2.4674e-04
Validation rmse = 0.196641
Epoch 289
Loss = 9.8462e-03, PNorm = 42.6383, GNorm = 0.2632, lr_0 = 2.4610e-04
Loss = 2.1424e-02, PNorm = 42.6390, GNorm = 0.2423, lr_0 = 2.4547e-04
Validation rmse = 0.195525
Epoch 290
Loss = 3.2113e-02, PNorm = 42.6417, GNorm = 0.2875, lr_0 = 2.4478e-04
Loss = 1.5981e-02, PNorm = 42.6449, GNorm = 0.4502, lr_0 = 2.4415e-04
Validation rmse = 0.194793
Epoch 291
Loss = 1.8780e-02, PNorm = 42.6475, GNorm = 0.3824, lr_0 = 2.4353e-04
Loss = 1.7793e-02, PNorm = 42.6491, GNorm = 0.1763, lr_0 = 2.4290e-04
Validation rmse = 0.196952
Epoch 292
Loss = 1.5327e-02, PNorm = 42.6521, GNorm = 0.3018, lr_0 = 2.4222e-04
Loss = 2.3522e-02, PNorm = 42.6546, GNorm = 0.3430, lr_0 = 2.4159e-04
Validation rmse = 0.195526
Epoch 293
Loss = 1.4456e-02, PNorm = 42.6551, GNorm = 0.2449, lr_0 = 2.4098e-04
Loss = 2.3337e-02, PNorm = 42.6566, GNorm = 0.5770, lr_0 = 2.4036e-04
Loss = 5.5183e-03, PNorm = 42.6571, GNorm = 0.2686, lr_0 = 2.4030e-04
Validation rmse = 0.195287
Epoch 294
Loss = 2.4249e-02, PNorm = 42.6596, GNorm = 0.4549, lr_0 = 2.3968e-04
Validation rmse = 0.195143
Epoch 295
Loss = 2.3347e-02, PNorm = 42.6611, GNorm = 0.5121, lr_0 = 2.3906e-04
Loss = 2.0156e-02, PNorm = 42.6626, GNorm = 0.2517, lr_0 = 2.3845e-04
Validation rmse = 0.195657
Epoch 296
Loss = 1.3214e-02, PNorm = 42.6646, GNorm = 0.3428, lr_0 = 2.3778e-04
Loss = 1.8580e-02, PNorm = 42.6679, GNorm = 0.2888, lr_0 = 2.3717e-04
Validation rmse = 0.196079
Epoch 297
Loss = 1.1884e-02, PNorm = 42.6705, GNorm = 0.3672, lr_0 = 2.3656e-04
Loss = 2.2265e-02, PNorm = 42.6724, GNorm = 0.3805, lr_0 = 2.3595e-04
Validation rmse = 0.197013
Epoch 298
Loss = 2.1340e-02, PNorm = 42.6755, GNorm = 0.2332, lr_0 = 2.3529e-04
Loss = 1.8380e-02, PNorm = 42.6787, GNorm = 0.2845, lr_0 = 2.3468e-04
Validation rmse = 0.196073
Epoch 299
Loss = 1.7184e-02, PNorm = 42.6811, GNorm = 0.3995, lr_0 = 2.3408e-04
Loss = 2.3583e-02, PNorm = 42.6834, GNorm = 0.3434, lr_0 = 2.3348e-04
Validation rmse = 0.196344
Epoch 300
Loss = 1.7436e-02, PNorm = 42.6853, GNorm = 0.1502, lr_0 = 2.3288e-04
Loss = 2.1952e-02, PNorm = 42.6877, GNorm = 0.2285, lr_0 = 2.3228e-04
Loss = 1.7393e-02, PNorm = 42.6879, GNorm = 0.4637, lr_0 = 2.3222e-04
Validation rmse = 0.195931
Epoch 301
Loss = 2.1127e-02, PNorm = 42.6903, GNorm = 0.7938, lr_0 = 2.3163e-04
Validation rmse = 0.196842
Epoch 302
Loss = 2.2225e-02, PNorm = 42.6941, GNorm = 0.3145, lr_0 = 2.3103e-04
Loss = 1.9708e-02, PNorm = 42.6970, GNorm = 0.5849, lr_0 = 2.3044e-04
Validation rmse = 0.197169
Epoch 303
Loss = 1.4274e-02, PNorm = 42.6988, GNorm = 0.4469, lr_0 = 2.2979e-04
Loss = 1.8638e-02, PNorm = 42.7020, GNorm = 0.2209, lr_0 = 2.2920e-04
Validation rmse = 0.195438
Epoch 304
Loss = 1.5482e-02, PNorm = 42.7044, GNorm = 0.2878, lr_0 = 2.2861e-04
Loss = 1.9824e-02, PNorm = 42.7075, GNorm = 0.4002, lr_0 = 2.2803e-04
Validation rmse = 0.194345
Epoch 305
Loss = 2.0656e-02, PNorm = 42.7101, GNorm = 0.4679, lr_0 = 2.2738e-04
Loss = 1.9038e-02, PNorm = 42.7128, GNorm = 0.3098, lr_0 = 2.2680e-04
Validation rmse = 0.195814
Epoch 306
Loss = 1.7395e-02, PNorm = 42.7133, GNorm = 0.3413, lr_0 = 2.2622e-04
Loss = 2.2905e-02, PNorm = 42.7146, GNorm = 0.6554, lr_0 = 2.2564e-04
Validation rmse = 0.194664
Epoch 307
Loss = 2.0986e-02, PNorm = 42.7187, GNorm = 0.3328, lr_0 = 2.2500e-04
Loss = 1.7350e-02, PNorm = 42.7226, GNorm = 0.3580, lr_0 = 2.2442e-04
Validation rmse = 0.197740
Epoch 308
Loss = 2.2391e-02, PNorm = 42.7252, GNorm = 0.4735, lr_0 = 2.2385e-04
Validation rmse = 0.194797
Epoch 309
Loss = 1.7988e-02, PNorm = 42.7275, GNorm = 0.6357, lr_0 = 2.2322e-04
Loss = 1.9973e-02, PNorm = 42.7299, GNorm = 0.4988, lr_0 = 2.2264e-04
Validation rmse = 0.198370
Epoch 310
Loss = 1.6266e-02, PNorm = 42.7332, GNorm = 0.2672, lr_0 = 2.2207e-04
Loss = 2.2599e-02, PNorm = 42.7362, GNorm = 0.3666, lr_0 = 2.2150e-04
Validation rmse = 0.197233
Epoch 311
Loss = 1.8767e-02, PNorm = 42.7385, GNorm = 0.6741, lr_0 = 2.2088e-04
Loss = 1.7711e-02, PNorm = 42.7409, GNorm = 0.2386, lr_0 = 2.2031e-04
Validation rmse = 0.196763
Epoch 312
Loss = 1.6024e-02, PNorm = 42.7419, GNorm = 0.2129, lr_0 = 2.1975e-04
Loss = 1.9971e-02, PNorm = 42.7431, GNorm = 0.2535, lr_0 = 2.1918e-04
Validation rmse = 0.194612
Epoch 313
Loss = 1.9368e-02, PNorm = 42.7453, GNorm = 0.4043, lr_0 = 2.1862e-04
Loss = 1.9001e-02, PNorm = 42.7470, GNorm = 0.3771, lr_0 = 2.1806e-04
Validation rmse = 0.195624
Epoch 314
Loss = 1.4190e-02, PNorm = 42.7518, GNorm = 0.3587, lr_0 = 2.1744e-04
Loss = 2.9871e-02, PNorm = 42.7553, GNorm = 0.7669, lr_0 = 2.1689e-04
Validation rmse = 0.197893
Epoch 315
Loss = 2.3934e-02, PNorm = 42.7583, GNorm = 0.4873, lr_0 = 2.1633e-04
Validation rmse = 0.195753
Epoch 316
Loss = 5.7930e-03, PNorm = 42.7608, GNorm = 0.3010, lr_0 = 2.1572e-04
Loss = 1.7483e-02, PNorm = 42.7617, GNorm = 0.2919, lr_0 = 2.1517e-04
Validation rmse = 0.194870
Epoch 317
Loss = 1.2100e-02, PNorm = 42.7637, GNorm = 0.2411, lr_0 = 2.1461e-04
Loss = 2.3849e-02, PNorm = 42.7669, GNorm = 0.2965, lr_0 = 2.1406e-04
Validation rmse = 0.195202
Epoch 318
Loss = 1.6214e-02, PNorm = 42.7704, GNorm = 0.3969, lr_0 = 2.1346e-04
Loss = 1.8719e-02, PNorm = 42.7723, GNorm = 0.6195, lr_0 = 2.1291e-04
Validation rmse = 0.195758
Epoch 319
Loss = 2.6646e-02, PNorm = 42.7741, GNorm = 0.6114, lr_0 = 2.1237e-04
Loss = 1.6325e-02, PNorm = 42.7767, GNorm = 0.2002, lr_0 = 2.1182e-04
Validation rmse = 0.195316
Epoch 320
Loss = 1.8212e-02, PNorm = 42.7776, GNorm = 0.3247, lr_0 = 2.1122e-04
Loss = 2.0391e-02, PNorm = 42.7795, GNorm = 0.3515, lr_0 = 2.1068e-04
Validation rmse = 0.196305
Epoch 321
Loss = 1.8309e-02, PNorm = 42.7820, GNorm = 0.1533, lr_0 = 2.1014e-04
Validation rmse = 0.194809
Epoch 322
Loss = 5.8900e-02, PNorm = 42.7841, GNorm = 0.3833, lr_0 = 2.0955e-04
Loss = 1.1654e-02, PNorm = 42.7855, GNorm = 0.3160, lr_0 = 2.0901e-04
Validation rmse = 0.195421
Epoch 323
Loss = 1.1621e-02, PNorm = 42.7872, GNorm = 0.4013, lr_0 = 2.0848e-04
Loss = 1.5398e-02, PNorm = 42.7896, GNorm = 0.3237, lr_0 = 2.0794e-04
Validation rmse = 0.196558
Epoch 324
Loss = 1.7144e-02, PNorm = 42.7917, GNorm = 0.2531, lr_0 = 2.0735e-04
Loss = 1.6042e-02, PNorm = 42.7924, GNorm = 0.3063, lr_0 = 2.0682e-04
Validation rmse = 0.195819
Epoch 325
Loss = 8.9881e-03, PNorm = 42.7941, GNorm = 0.3014, lr_0 = 2.0629e-04
Loss = 2.3374e-02, PNorm = 42.7956, GNorm = 0.2783, lr_0 = 2.0576e-04
Validation rmse = 0.195662
Epoch 326
Loss = 1.2975e-02, PNorm = 42.7973, GNorm = 0.3103, lr_0 = 2.0523e-04
Loss = 2.3191e-02, PNorm = 42.7999, GNorm = 0.4371, lr_0 = 2.0471e-04
Validation rmse = 0.195345
Epoch 327
Loss = 1.4542e-02, PNorm = 42.8016, GNorm = 0.3441, lr_0 = 2.0413e-04
Loss = 1.6749e-02, PNorm = 42.8030, GNorm = 0.4854, lr_0 = 2.0361e-04
Validation rmse = 0.194500
Epoch 328
Loss = 2.0379e-02, PNorm = 42.8031, GNorm = 0.2854, lr_0 = 2.0308e-04
Validation rmse = 0.196972
Epoch 329
Loss = 2.5853e-02, PNorm = 42.8063, GNorm = 0.3339, lr_0 = 2.0251e-04
Loss = 1.2212e-02, PNorm = 42.8082, GNorm = 0.2256, lr_0 = 2.0199e-04
Validation rmse = 0.195490
Epoch 330
Loss = 1.2825e-02, PNorm = 42.8107, GNorm = 0.4152, lr_0 = 2.0147e-04
Loss = 1.6472e-02, PNorm = 42.8118, GNorm = 0.3117, lr_0 = 2.0096e-04
Validation rmse = 0.195514
Epoch 331
Loss = 2.1228e-02, PNorm = 42.8151, GNorm = 0.2414, lr_0 = 2.0039e-04
Loss = 2.0996e-02, PNorm = 42.8167, GNorm = 0.5072, lr_0 = 1.9988e-04
Validation rmse = 0.195805
Epoch 332
Loss = 2.0697e-02, PNorm = 42.8186, GNorm = 0.3370, lr_0 = 1.9936e-04
Loss = 1.4624e-02, PNorm = 42.8210, GNorm = 0.4616, lr_0 = 1.9885e-04
Validation rmse = 0.197016
Epoch 333
Loss = 1.5593e-02, PNorm = 42.8219, GNorm = 0.4404, lr_0 = 1.9829e-04
Loss = 2.3124e-02, PNorm = 42.8235, GNorm = 0.6383, lr_0 = 1.9778e-04
Validation rmse = 0.195598
Epoch 334
Loss = 2.2089e-02, PNorm = 42.8253, GNorm = 0.3515, lr_0 = 1.9727e-04
Loss = 1.6707e-02, PNorm = 42.8266, GNorm = 0.3067, lr_0 = 1.9677e-04
Loss = 1.7769e-02, PNorm = 42.8271, GNorm = 0.3740, lr_0 = 1.9672e-04
Validation rmse = 0.196460
Epoch 335
Loss = 2.0815e-02, PNorm = 42.8305, GNorm = 0.5882, lr_0 = 1.9621e-04
Validation rmse = 0.195332
Epoch 336
Loss = 4.8292e-02, PNorm = 42.8324, GNorm = 0.4307, lr_0 = 1.9571e-04
Loss = 1.1553e-02, PNorm = 42.8339, GNorm = 0.1219, lr_0 = 1.9521e-04
Validation rmse = 0.195364
Epoch 337
Loss = 1.2677e-02, PNorm = 42.8358, GNorm = 0.2008, lr_0 = 1.9466e-04
Loss = 2.0130e-02, PNorm = 42.8373, GNorm = 0.2547, lr_0 = 1.9416e-04
Validation rmse = 0.196244
Epoch 338
Loss = 1.3328e-02, PNorm = 42.8387, GNorm = 0.1900, lr_0 = 1.9366e-04
Loss = 2.2432e-02, PNorm = 42.8413, GNorm = 0.2575, lr_0 = 1.9316e-04
Validation rmse = 0.195964
Epoch 339
Loss = 1.3543e-02, PNorm = 42.8434, GNorm = 0.4344, lr_0 = 1.9267e-04
Loss = 1.6031e-02, PNorm = 42.8444, GNorm = 0.3241, lr_0 = 1.9217e-04
Validation rmse = 0.195798
Epoch 340
Loss = 1.3563e-02, PNorm = 42.8446, GNorm = 0.3710, lr_0 = 1.9163e-04
Loss = 1.9203e-02, PNorm = 42.8452, GNorm = 0.3859, lr_0 = 1.9114e-04
Validation rmse = 0.195431
Epoch 341
Loss = 2.2967e-02, PNorm = 42.8478, GNorm = 0.3105, lr_0 = 1.9065e-04
Loss = 1.4703e-02, PNorm = 42.8484, GNorm = 0.6228, lr_0 = 1.9016e-04
Loss = 6.0897e-03, PNorm = 42.8485, GNorm = 0.2335, lr_0 = 1.9011e-04
Validation rmse = 0.195393
Epoch 342
Loss = 2.0762e-02, PNorm = 42.8486, GNorm = 0.3654, lr_0 = 1.8962e-04
Validation rmse = 0.197356
Epoch 343
Loss = 1.5771e-02, PNorm = 42.8507, GNorm = 0.4266, lr_0 = 1.8914e-04
Loss = 1.9313e-02, PNorm = 42.8523, GNorm = 0.5041, lr_0 = 1.8865e-04
Validation rmse = 0.196409
Epoch 344
Loss = 3.2853e-02, PNorm = 42.8536, GNorm = 0.5555, lr_0 = 1.8812e-04
Loss = 1.4808e-02, PNorm = 42.8552, GNorm = 0.3158, lr_0 = 1.8764e-04
Validation rmse = 0.196663
Epoch 345
Loss = 2.8228e-02, PNorm = 42.8576, GNorm = 0.6157, lr_0 = 1.8715e-04
Loss = 1.5249e-02, PNorm = 42.8592, GNorm = 0.3423, lr_0 = 1.8667e-04
Validation rmse = 0.196944
Epoch 346
Loss = 2.3562e-02, PNorm = 42.8623, GNorm = 0.6246, lr_0 = 1.8615e-04
Loss = 1.8860e-02, PNorm = 42.8641, GNorm = 0.2928, lr_0 = 1.8567e-04
Validation rmse = 0.196288
Epoch 347
Loss = 1.6694e-02, PNorm = 42.8658, GNorm = 0.3110, lr_0 = 1.8519e-04
Loss = 1.9427e-02, PNorm = 42.8674, GNorm = 0.3130, lr_0 = 1.8472e-04
Validation rmse = 0.195482
Epoch 348
Loss = 2.2164e-02, PNorm = 42.8698, GNorm = 0.5218, lr_0 = 1.8420e-04
Loss = 1.4231e-02, PNorm = 42.8721, GNorm = 0.6523, lr_0 = 1.8372e-04
Validation rmse = 0.197029
Epoch 349
Loss = 1.6382e-02, PNorm = 42.8731, GNorm = 0.6946, lr_0 = 1.8325e-04
Validation rmse = 0.196405
Epoch 350
Loss = 2.2303e-02, PNorm = 42.8748, GNorm = 0.4173, lr_0 = 1.8278e-04
Loss = 2.1374e-02, PNorm = 42.8769, GNorm = 0.6193, lr_0 = 1.8231e-04
Validation rmse = 0.196327
Epoch 351
Loss = 2.6253e-02, PNorm = 42.8781, GNorm = 0.3100, lr_0 = 1.8180e-04
Loss = 1.2074e-02, PNorm = 42.8792, GNorm = 0.2515, lr_0 = 1.8133e-04
Validation rmse = 0.195711
Epoch 352
Loss = 1.8672e-02, PNorm = 42.8808, GNorm = 0.1688, lr_0 = 1.8087e-04
Loss = 1.6244e-02, PNorm = 42.8833, GNorm = 0.2582, lr_0 = 1.8040e-04
Validation rmse = 0.196835
Epoch 353
Loss = 2.3229e-02, PNorm = 42.8835, GNorm = 0.2227, lr_0 = 1.7990e-04
Loss = 1.4047e-02, PNorm = 42.8851, GNorm = 0.2004, lr_0 = 1.7943e-04
Validation rmse = 0.196851
Epoch 354
Loss = 1.7744e-02, PNorm = 42.8869, GNorm = 0.3008, lr_0 = 1.7897e-04
Loss = 1.4245e-02, PNorm = 42.8889, GNorm = 0.2202, lr_0 = 1.7851e-04
Validation rmse = 0.196910
Epoch 355
Loss = 2.1587e-02, PNorm = 42.8909, GNorm = 0.4245, lr_0 = 1.7801e-04
Loss = 1.6234e-02, PNorm = 42.8931, GNorm = 0.5361, lr_0 = 1.7755e-04
Validation rmse = 0.195770
Epoch 356
Loss = 1.4865e-02, PNorm = 42.8941, GNorm = 0.4687, lr_0 = 1.7710e-04
Validation rmse = 0.195000
Epoch 357
Loss = 1.9732e-02, PNorm = 42.8961, GNorm = 0.5955, lr_0 = 1.7660e-04
Loss = 1.6406e-02, PNorm = 42.8981, GNorm = 0.5298, lr_0 = 1.7615e-04
Validation rmse = 0.196224
Epoch 358
Loss = 1.8039e-02, PNorm = 42.8985, GNorm = 0.7078, lr_0 = 1.7569e-04
Loss = 2.3154e-02, PNorm = 42.9003, GNorm = 0.5975, lr_0 = 1.7524e-04
Validation rmse = 0.196236
Epoch 359
Loss = 1.2814e-02, PNorm = 42.9033, GNorm = 0.3087, lr_0 = 1.7475e-04
Loss = 1.5745e-02, PNorm = 42.9047, GNorm = 0.1852, lr_0 = 1.7430e-04
Validation rmse = 0.197446
Epoch 360
Loss = 2.3768e-02, PNorm = 42.9064, GNorm = 0.6857, lr_0 = 1.7385e-04
Loss = 1.6727e-02, PNorm = 42.9079, GNorm = 0.3819, lr_0 = 1.7341e-04
Validation rmse = 0.194658
Epoch 361
Loss = 2.3776e-02, PNorm = 42.9091, GNorm = 0.3741, lr_0 = 1.7292e-04
Loss = 1.4385e-02, PNorm = 42.9111, GNorm = 0.6329, lr_0 = 1.7247e-04
Validation rmse = 0.194999
Epoch 362
Loss = 1.6040e-02, PNorm = 42.9123, GNorm = 0.4600, lr_0 = 1.7203e-04
Loss = 2.0871e-02, PNorm = 42.9123, GNorm = 0.6501, lr_0 = 1.7159e-04
Validation rmse = 0.195086
Epoch 363
Loss = 1.7515e-02, PNorm = 42.9141, GNorm = 0.3808, lr_0 = 1.7115e-04
Validation rmse = 0.196122
Epoch 364
Loss = 2.4263e-02, PNorm = 42.9161, GNorm = 0.3310, lr_0 = 1.7067e-04
Loss = 1.7138e-02, PNorm = 42.9170, GNorm = 0.1777, lr_0 = 1.7023e-04
Validation rmse = 0.194537
Epoch 365
Loss = 1.3346e-02, PNorm = 42.9186, GNorm = 0.2342, lr_0 = 1.6979e-04
Loss = 1.5503e-02, PNorm = 42.9198, GNorm = 0.2790, lr_0 = 1.6936e-04
Validation rmse = 0.196177
Epoch 366
Loss = 2.9618e-02, PNorm = 42.9209, GNorm = 0.1618, lr_0 = 1.6888e-04
Loss = 1.6808e-02, PNorm = 42.9220, GNorm = 0.2136, lr_0 = 1.6845e-04
Validation rmse = 0.195846
Epoch 367
Loss = 1.3489e-02, PNorm = 42.9239, GNorm = 0.1981, lr_0 = 1.6801e-04
Loss = 1.4814e-02, PNorm = 42.9263, GNorm = 0.2088, lr_0 = 1.6758e-04
Validation rmse = 0.194724
Epoch 368
Loss = 1.6275e-02, PNorm = 42.9273, GNorm = 0.3900, lr_0 = 1.6711e-04
Loss = 2.0159e-02, PNorm = 42.9283, GNorm = 0.2343, lr_0 = 1.6668e-04
Validation rmse = 0.195421
Epoch 369
Loss = 1.5865e-02, PNorm = 42.9306, GNorm = 0.3429, lr_0 = 1.6625e-04
Validation rmse = 0.196312
Epoch 370
Loss = 1.6662e-02, PNorm = 42.9319, GNorm = 0.2548, lr_0 = 1.6578e-04
Loss = 1.7306e-02, PNorm = 42.9327, GNorm = 0.3540, lr_0 = 1.6536e-04
Validation rmse = 0.195205
Epoch 371
Loss = 1.2204e-02, PNorm = 42.9340, GNorm = 0.5003, lr_0 = 1.6494e-04
Loss = 1.6373e-02, PNorm = 42.9362, GNorm = 0.2599, lr_0 = 1.6451e-04
Validation rmse = 0.196697
Epoch 372
Loss = 1.0665e-02, PNorm = 42.9375, GNorm = 0.3108, lr_0 = 1.6405e-04
Loss = 1.8464e-02, PNorm = 42.9386, GNorm = 0.3828, lr_0 = 1.6363e-04
Validation rmse = 0.196585
Epoch 373
Loss = 2.0988e-02, PNorm = 42.9398, GNorm = 0.3628, lr_0 = 1.6321e-04
Loss = 1.5023e-02, PNorm = 42.9415, GNorm = 0.2591, lr_0 = 1.6279e-04
Validation rmse = 0.197281
Epoch 374
Loss = 2.1780e-02, PNorm = 42.9417, GNorm = 0.2043, lr_0 = 1.6233e-04
Loss = 1.3724e-02, PNorm = 42.9432, GNorm = 0.2164, lr_0 = 1.6191e-04
Validation rmse = 0.196438
Epoch 375
Loss = 2.3210e-02, PNorm = 42.9447, GNorm = 0.3697, lr_0 = 1.6150e-04
Loss = 1.6676e-02, PNorm = 42.9474, GNorm = 0.3731, lr_0 = 1.6108e-04
Validation rmse = 0.197019
Epoch 376
Loss = 1.7902e-02, PNorm = 42.9488, GNorm = 0.2770, lr_0 = 1.6067e-04
Validation rmse = 0.198052
Epoch 377
Loss = 4.6784e-03, PNorm = 42.9512, GNorm = 0.1713, lr_0 = 1.6022e-04
Loss = 1.6775e-02, PNorm = 42.9531, GNorm = 0.1975, lr_0 = 1.5981e-04
Validation rmse = 0.195922
Epoch 378
Loss = 1.0669e-02, PNorm = 42.9543, GNorm = 0.2686, lr_0 = 1.5940e-04
Loss = 2.3562e-02, PNorm = 42.9551, GNorm = 0.3801, lr_0 = 1.5899e-04
Validation rmse = 0.195274
Epoch 379
Loss = 1.4680e-02, PNorm = 42.9567, GNorm = 0.3584, lr_0 = 1.5854e-04
Loss = 2.1227e-02, PNorm = 42.9587, GNorm = 0.3775, lr_0 = 1.5813e-04
Validation rmse = 0.197341
Epoch 380
Loss = 2.2153e-02, PNorm = 42.9606, GNorm = 0.3610, lr_0 = 1.5773e-04
Loss = 1.6932e-02, PNorm = 42.9622, GNorm = 0.3099, lr_0 = 1.5732e-04
Validation rmse = 0.194922
Epoch 381
Loss = 1.3622e-02, PNorm = 42.9639, GNorm = 0.3987, lr_0 = 1.5688e-04
Loss = 2.1576e-02, PNorm = 42.9650, GNorm = 0.2787, lr_0 = 1.5647e-04
Validation rmse = 0.197149
Epoch 382
Loss = 2.2335e-02, PNorm = 42.9665, GNorm = 0.3654, lr_0 = 1.5607e-04
Loss = 1.3950e-02, PNorm = 42.9678, GNorm = 0.2381, lr_0 = 1.5567e-04
Loss = 6.4371e-02, PNorm = 42.9679, GNorm = 1.2517, lr_0 = 1.5563e-04
Validation rmse = 0.196559
Epoch 383
Loss = 2.1564e-02, PNorm = 42.9697, GNorm = 0.5448, lr_0 = 1.5523e-04
Validation rmse = 0.194640
Epoch 384
Loss = 3.1889e-02, PNorm = 42.9711, GNorm = 0.5635, lr_0 = 1.5484e-04
Loss = 1.2843e-02, PNorm = 42.9724, GNorm = 0.2930, lr_0 = 1.5444e-04
Validation rmse = 0.196309
Epoch 385
Loss = 9.1231e-03, PNorm = 42.9735, GNorm = 0.2972, lr_0 = 1.5400e-04
Loss = 1.6404e-02, PNorm = 42.9748, GNorm = 0.3533, lr_0 = 1.5361e-04
Validation rmse = 0.196533
Epoch 386
Loss = 1.2280e-02, PNorm = 42.9763, GNorm = 0.1922, lr_0 = 1.5321e-04
Loss = 2.1214e-02, PNorm = 42.9779, GNorm = 0.1632, lr_0 = 1.5282e-04
Validation rmse = 0.196656
Epoch 387
Loss = 1.3047e-02, PNorm = 42.9785, GNorm = 0.2510, lr_0 = 1.5239e-04
Loss = 2.0385e-02, PNorm = 42.9798, GNorm = 0.3025, lr_0 = 1.5200e-04
Validation rmse = 0.196337
Epoch 388
Loss = 1.4155e-02, PNorm = 42.9814, GNorm = 0.2770, lr_0 = 1.5161e-04
Loss = 1.9632e-02, PNorm = 42.9825, GNorm = 0.4861, lr_0 = 1.5122e-04
Validation rmse = 0.197895
Epoch 389
Loss = 1.4314e-02, PNorm = 42.9833, GNorm = 0.3377, lr_0 = 1.5083e-04
Loss = 2.2784e-02, PNorm = 42.9849, GNorm = 0.5900, lr_0 = 1.5044e-04
Loss = 6.7925e-03, PNorm = 42.9850, GNorm = 0.2382, lr_0 = 1.5041e-04
Validation rmse = 0.197919
Epoch 390
Loss = 2.2326e-02, PNorm = 42.9854, GNorm = 0.1720, lr_0 = 1.5002e-04
Validation rmse = 0.195192
Epoch 391
Loss = 1.0203e-02, PNorm = 42.9861, GNorm = 0.3685, lr_0 = 1.4964e-04
Loss = 1.8341e-02, PNorm = 42.9873, GNorm = 0.4843, lr_0 = 1.4925e-04
Validation rmse = 0.197117
Epoch 392
Loss = 1.1456e-02, PNorm = 42.9885, GNorm = 0.5271, lr_0 = 1.4883e-04
Loss = 1.2368e-02, PNorm = 42.9897, GNorm = 0.5755, lr_0 = 1.4845e-04
Validation rmse = 0.196034
Epoch 393
Loss = 2.8648e-02, PNorm = 42.9904, GNorm = 0.2550, lr_0 = 1.4807e-04
Loss = 1.4617e-02, PNorm = 42.9910, GNorm = 0.3881, lr_0 = 1.4769e-04
Validation rmse = 0.196803
Epoch 394
Loss = 8.0248e-03, PNorm = 42.9922, GNorm = 0.2930, lr_0 = 1.4727e-04
Loss = 2.5373e-02, PNorm = 42.9930, GNorm = 0.5483, lr_0 = 1.4689e-04
Validation rmse = 0.197036
Epoch 395
Loss = 1.3421e-02, PNorm = 42.9945, GNorm = 0.2671, lr_0 = 1.4652e-04
Loss = 2.0561e-02, PNorm = 42.9955, GNorm = 0.2909, lr_0 = 1.4614e-04
Validation rmse = 0.197645
Epoch 396
Loss = 2.6627e-02, PNorm = 42.9967, GNorm = 0.4953, lr_0 = 1.4573e-04
Loss = 1.1364e-02, PNorm = 42.9982, GNorm = 0.1821, lr_0 = 1.4535e-04
Validation rmse = 0.196873
Epoch 397
Loss = 1.7653e-02, PNorm = 43.0004, GNorm = 0.4163, lr_0 = 1.4498e-04
Validation rmse = 0.198017
Epoch 398
Loss = 1.2256e-02, PNorm = 43.0022, GNorm = 0.1772, lr_0 = 1.4457e-04
Loss = 2.0616e-02, PNorm = 43.0029, GNorm = 0.3177, lr_0 = 1.4420e-04
Validation rmse = 0.196136
Epoch 399
Loss = 7.0567e-03, PNorm = 43.0035, GNorm = 0.1672, lr_0 = 1.4383e-04
Loss = 2.3013e-02, PNorm = 43.0048, GNorm = 0.2791, lr_0 = 1.4346e-04
Validation rmse = 0.196208
Epoch 400
Loss = 1.1167e-02, PNorm = 43.0058, GNorm = 0.2755, lr_0 = 1.4309e-04
Loss = 1.8791e-02, PNorm = 43.0074, GNorm = 0.2133, lr_0 = 1.4273e-04
Validation rmse = 0.196988
Epoch 401
Loss = 1.9222e-02, PNorm = 43.0073, GNorm = 0.3237, lr_0 = 1.4232e-04
Loss = 1.5746e-02, PNorm = 43.0088, GNorm = 0.2460, lr_0 = 1.4196e-04
Validation rmse = 0.197700
Epoch 402
Loss = 2.0862e-02, PNorm = 43.0085, GNorm = 0.3713, lr_0 = 1.4160e-04
Loss = 1.4303e-02, PNorm = 43.0092, GNorm = 0.2582, lr_0 = 1.4123e-04
Validation rmse = 0.195993
Epoch 403
Loss = 1.4778e-02, PNorm = 43.0101, GNorm = 0.2900, lr_0 = 1.4083e-04
Loss = 2.4507e-02, PNorm = 43.0105, GNorm = 0.7271, lr_0 = 1.4047e-04
Validation rmse = 0.196693
Epoch 404
Loss = 1.6990e-02, PNorm = 43.0114, GNorm = 0.3311, lr_0 = 1.4011e-04
Validation rmse = 0.197170
Epoch 405
Loss = 3.0575e-02, PNorm = 43.0132, GNorm = 0.4894, lr_0 = 1.3972e-04
Loss = 1.6437e-02, PNorm = 43.0145, GNorm = 0.2386, lr_0 = 1.3936e-04
Validation rmse = 0.198138
Epoch 406
Loss = 2.3663e-02, PNorm = 43.0170, GNorm = 0.1281, lr_0 = 1.3900e-04
Loss = 1.3820e-02, PNorm = 43.0182, GNorm = 0.4806, lr_0 = 1.3864e-04
Validation rmse = 0.196826
Epoch 407
Loss = 1.8111e-02, PNorm = 43.0196, GNorm = 0.2884, lr_0 = 1.3825e-04
Loss = 1.8342e-02, PNorm = 43.0206, GNorm = 0.4197, lr_0 = 1.3790e-04
Validation rmse = 0.197052
Epoch 408
Loss = 2.0799e-02, PNorm = 43.0210, GNorm = 0.3649, lr_0 = 1.3754e-04
Loss = 1.4332e-02, PNorm = 43.0219, GNorm = 0.2026, lr_0 = 1.3719e-04
Validation rmse = 0.196825
Epoch 409
Loss = 1.7491e-02, PNorm = 43.0229, GNorm = 0.3235, lr_0 = 1.3680e-04
Loss = 1.8844e-02, PNorm = 43.0243, GNorm = 0.4365, lr_0 = 1.3645e-04
Validation rmse = 0.196464
Epoch 410
Loss = 1.8419e-02, PNorm = 43.0246, GNorm = 0.2657, lr_0 = 1.3610e-04
Validation rmse = 0.197718
Epoch 411
Loss = 6.8742e-03, PNorm = 43.0259, GNorm = 0.2575, lr_0 = 1.3572e-04
Loss = 1.3893e-02, PNorm = 43.0271, GNorm = 0.1806, lr_0 = 1.3537e-04
Validation rmse = 0.196122
Epoch 412
Loss = 1.1350e-02, PNorm = 43.0281, GNorm = 0.1678, lr_0 = 1.3502e-04
Loss = 2.1138e-02, PNorm = 43.0286, GNorm = 0.1656, lr_0 = 1.3468e-04
Validation rmse = 0.196405
Epoch 413
Loss = 2.5550e-02, PNorm = 43.0291, GNorm = 0.4740, lr_0 = 1.3433e-04
Loss = 1.8446e-02, PNorm = 43.0301, GNorm = 0.4228, lr_0 = 1.3399e-04
Validation rmse = 0.197183
Epoch 414
Loss = 2.2863e-02, PNorm = 43.0308, GNorm = 0.3979, lr_0 = 1.3361e-04
Loss = 1.3191e-02, PNorm = 43.0316, GNorm = 0.1958, lr_0 = 1.3327e-04
Validation rmse = 0.197159
Epoch 415
Loss = 2.0507e-02, PNorm = 43.0337, GNorm = 0.3409, lr_0 = 1.3292e-04
Loss = 1.3251e-02, PNorm = 43.0355, GNorm = 0.1958, lr_0 = 1.3258e-04
Validation rmse = 0.196388
Epoch 416
Loss = 1.6148e-02, PNorm = 43.0354, GNorm = 0.1389, lr_0 = 1.3221e-04
Loss = 1.7832e-02, PNorm = 43.0362, GNorm = 0.6176, lr_0 = 1.3187e-04
Validation rmse = 0.197152
Epoch 417
Loss = 2.1558e-02, PNorm = 43.0376, GNorm = 0.4503, lr_0 = 1.3153e-04
Validation rmse = 0.196933
Epoch 418
Loss = 9.9884e-03, PNorm = 43.0388, GNorm = 0.3695, lr_0 = 1.3116e-04
Loss = 1.9351e-02, PNorm = 43.0406, GNorm = 0.3572, lr_0 = 1.3082e-04
Validation rmse = 0.198105
Epoch 419
Loss = 8.9317e-03, PNorm = 43.0421, GNorm = 0.2034, lr_0 = 1.3049e-04
Loss = 2.0375e-02, PNorm = 43.0422, GNorm = 0.2339, lr_0 = 1.3015e-04
Validation rmse = 0.195997
Epoch 420
Loss = 1.1091e-02, PNorm = 43.0430, GNorm = 0.2616, lr_0 = 1.2979e-04
Loss = 1.8677e-02, PNorm = 43.0440, GNorm = 0.2095, lr_0 = 1.2945e-04
Validation rmse = 0.196030
Epoch 421
Loss = 1.2214e-02, PNorm = 43.0447, GNorm = 0.2210, lr_0 = 1.2912e-04
Loss = 1.6680e-02, PNorm = 43.0448, GNorm = 0.2501, lr_0 = 1.2879e-04
Validation rmse = 0.196968
Epoch 422
Loss = 1.9505e-02, PNorm = 43.0466, GNorm = 0.2825, lr_0 = 1.2843e-04
Loss = 1.2377e-02, PNorm = 43.0477, GNorm = 0.1864, lr_0 = 1.2810e-04
Validation rmse = 0.196891
Epoch 423
Loss = 1.3351e-02, PNorm = 43.0486, GNorm = 0.1550, lr_0 = 1.2777e-04
Loss = 2.0213e-02, PNorm = 43.0489, GNorm = 0.2604, lr_0 = 1.2744e-04
Loss = 2.1334e-02, PNorm = 43.0490, GNorm = 0.6157, lr_0 = 1.2741e-04
Validation rmse = 0.196406
Epoch 424
Loss = 9.5779e-03, PNorm = 43.0496, GNorm = 0.2439, lr_0 = 1.2708e-04
Validation rmse = 0.197067
Epoch 425
Loss = 1.2936e-02, PNorm = 43.0505, GNorm = 0.4000, lr_0 = 1.2676e-04
Loss = 1.8767e-02, PNorm = 43.0519, GNorm = 0.3191, lr_0 = 1.2643e-04
Validation rmse = 0.197102
Epoch 426
Loss = 1.1356e-02, PNorm = 43.0524, GNorm = 0.1429, lr_0 = 1.2611e-04
Loss = 1.7693e-02, PNorm = 43.0528, GNorm = 0.5717, lr_0 = 1.2578e-04
Validation rmse = 0.196959
Epoch 427
Loss = 2.0951e-02, PNorm = 43.0532, GNorm = 0.2865, lr_0 = 1.2543e-04
Loss = 1.7094e-02, PNorm = 43.0542, GNorm = 0.3112, lr_0 = 1.2511e-04
Validation rmse = 0.197478
Epoch 428
Loss = 1.9497e-02, PNorm = 43.0555, GNorm = 0.2903, lr_0 = 1.2479e-04
Loss = 1.6161e-02, PNorm = 43.0566, GNorm = 0.2638, lr_0 = 1.2446e-04
Validation rmse = 0.196784
Epoch 429
Loss = 1.4049e-02, PNorm = 43.0574, GNorm = 0.2285, lr_0 = 1.2411e-04
Loss = 2.0497e-02, PNorm = 43.0584, GNorm = 0.3659, lr_0 = 1.2380e-04
Validation rmse = 0.196882
Epoch 430
Loss = 1.3533e-02, PNorm = 43.0596, GNorm = 0.2798, lr_0 = 1.2348e-04
Loss = 2.0617e-02, PNorm = 43.0608, GNorm = 0.3276, lr_0 = 1.2316e-04
Loss = 1.2039e-02, PNorm = 43.0608, GNorm = 0.2736, lr_0 = 1.2313e-04
Validation rmse = 0.196387
Epoch 431
Loss = 1.4036e-02, PNorm = 43.0608, GNorm = 0.4527, lr_0 = 1.2281e-04
Validation rmse = 0.196493
Epoch 432
Loss = 2.4476e-02, PNorm = 43.0609, GNorm = 0.2854, lr_0 = 1.2250e-04
Loss = 1.8520e-02, PNorm = 43.0619, GNorm = 0.2633, lr_0 = 1.2218e-04
Validation rmse = 0.197573
Epoch 433
Loss = 1.6595e-02, PNorm = 43.0630, GNorm = 0.3344, lr_0 = 1.2184e-04
Loss = 1.2900e-02, PNorm = 43.0628, GNorm = 0.1417, lr_0 = 1.2153e-04
Validation rmse = 0.196206
Epoch 434
Loss = 2.3706e-02, PNorm = 43.0636, GNorm = 0.3149, lr_0 = 1.2122e-04
Loss = 1.7903e-02, PNorm = 43.0652, GNorm = 0.4142, lr_0 = 1.2090e-04
Validation rmse = 0.197817
Epoch 435
Loss = 1.1720e-02, PNorm = 43.0662, GNorm = 0.3104, lr_0 = 1.2056e-04
Loss = 1.9810e-02, PNorm = 43.0672, GNorm = 0.3564, lr_0 = 1.2025e-04
Validation rmse = 0.198120
Epoch 436
Loss = 1.3582e-02, PNorm = 43.0675, GNorm = 0.2844, lr_0 = 1.1995e-04
Loss = 1.4617e-02, PNorm = 43.0682, GNorm = 0.1266, lr_0 = 1.1964e-04
Validation rmse = 0.195614
Epoch 437
Loss = 2.4965e-02, PNorm = 43.0695, GNorm = 0.4785, lr_0 = 1.1930e-04
Loss = 9.2485e-03, PNorm = 43.0703, GNorm = 0.1932, lr_0 = 1.1899e-04
Validation rmse = 0.195772
Epoch 438
Loss = 1.4083e-02, PNorm = 43.0715, GNorm = 0.2959, lr_0 = 1.1869e-04
Validation rmse = 0.196040
Epoch 439
Loss = 2.0982e-02, PNorm = 43.0716, GNorm = 0.3631, lr_0 = 1.1838e-04
Loss = 1.5361e-02, PNorm = 43.0728, GNorm = 0.2236, lr_0 = 1.1808e-04
Validation rmse = 0.196617
Epoch 440
Loss = 2.4146e-02, PNorm = 43.0735, GNorm = 0.2930, lr_0 = 1.1775e-04
Loss = 1.6305e-02, PNorm = 43.0738, GNorm = 0.2705, lr_0 = 1.1745e-04
Validation rmse = 0.196363
Epoch 441
Loss = 1.0394e-02, PNorm = 43.0750, GNorm = 0.1845, lr_0 = 1.1714e-04
Loss = 2.2537e-02, PNorm = 43.0758, GNorm = 0.4853, lr_0 = 1.1684e-04
Validation rmse = 0.197484
Epoch 442
Loss = 2.1599e-02, PNorm = 43.0771, GNorm = 0.4506, lr_0 = 1.1651e-04
Loss = 1.0760e-02, PNorm = 43.0778, GNorm = 0.3863, lr_0 = 1.1621e-04
Validation rmse = 0.196765
Epoch 443
Loss = 1.6800e-02, PNorm = 43.0779, GNorm = 0.4538, lr_0 = 1.1592e-04
Loss = 1.7322e-02, PNorm = 43.0788, GNorm = 0.3221, lr_0 = 1.1562e-04
Validation rmse = 0.198858
Epoch 444
Loss = 1.7443e-02, PNorm = 43.0789, GNorm = 0.2072, lr_0 = 1.1529e-04
Loss = 1.6886e-02, PNorm = 43.0800, GNorm = 0.1771, lr_0 = 1.1500e-04
Validation rmse = 0.196852
Epoch 445
Loss = 2.0719e-02, PNorm = 43.0808, GNorm = 0.3485, lr_0 = 1.1470e-04
Validation rmse = 0.197758
Epoch 446
Loss = 1.6454e-02, PNorm = 43.0815, GNorm = 0.4609, lr_0 = 1.1438e-04
Loss = 1.3290e-02, PNorm = 43.0819, GNorm = 0.3022, lr_0 = 1.1409e-04
Validation rmse = 0.195500
Epoch 447
Loss = 1.7334e-02, PNorm = 43.0831, GNorm = 0.4032, lr_0 = 1.1379e-04
Loss = 1.5161e-02, PNorm = 43.0836, GNorm = 0.4862, lr_0 = 1.1350e-04
Validation rmse = 0.196226
Epoch 448
Loss = 1.8387e-02, PNorm = 43.0844, GNorm = 0.4539, lr_0 = 1.1318e-04
Loss = 1.1212e-02, PNorm = 43.0852, GNorm = 0.2814, lr_0 = 1.1289e-04
Validation rmse = 0.196197
Epoch 449
Loss = 1.0261e-02, PNorm = 43.0856, GNorm = 0.1544, lr_0 = 1.1260e-04
Loss = 1.8256e-02, PNorm = 43.0865, GNorm = 0.4974, lr_0 = 1.1231e-04
Validation rmse = 0.196726
Epoch 450
Loss = 8.6151e-03, PNorm = 43.0872, GNorm = 0.2785, lr_0 = 1.1202e-04
Loss = 2.4164e-02, PNorm = 43.0877, GNorm = 0.2531, lr_0 = 1.1174e-04
Validation rmse = 0.195878
Epoch 451
Loss = 1.6021e-02, PNorm = 43.0893, GNorm = 0.4027, lr_0 = 1.1142e-04
Loss = 1.7884e-02, PNorm = 43.0896, GNorm = 0.1055, lr_0 = 1.1113e-04
Validation rmse = 0.196270
Epoch 452
Loss = 1.5843e-02, PNorm = 43.0902, GNorm = 0.2639, lr_0 = 1.1085e-04
Validation rmse = 0.196195
Epoch 453
Loss = 8.8994e-03, PNorm = 43.0908, GNorm = 0.2415, lr_0 = 1.1054e-04
Loss = 1.5855e-02, PNorm = 43.0910, GNorm = 0.5415, lr_0 = 1.1025e-04
Validation rmse = 0.196018
Epoch 454
Loss = 2.5369e-02, PNorm = 43.0918, GNorm = 0.2365, lr_0 = 1.0997e-04
Loss = 1.6516e-02, PNorm = 43.0923, GNorm = 0.2186, lr_0 = 1.0969e-04
Validation rmse = 0.197522
Epoch 455
Loss = 2.3588e-02, PNorm = 43.0934, GNorm = 0.3446, lr_0 = 1.0938e-04
Loss = 1.7169e-02, PNorm = 43.0939, GNorm = 0.2922, lr_0 = 1.0910e-04
Validation rmse = 0.196433
Epoch 456
Loss = 2.4722e-02, PNorm = 43.0940, GNorm = 0.4271, lr_0 = 1.0882e-04
Loss = 1.3645e-02, PNorm = 43.0953, GNorm = 0.4781, lr_0 = 1.0854e-04
Validation rmse = 0.196994
Epoch 457
Loss = 1.2304e-02, PNorm = 43.0957, GNorm = 0.3261, lr_0 = 1.0823e-04
Loss = 1.9823e-02, PNorm = 43.0955, GNorm = 0.5231, lr_0 = 1.0796e-04
Validation rmse = 0.196346
Epoch 458
Loss = 1.7122e-02, PNorm = 43.0964, GNorm = 0.3196, lr_0 = 1.0768e-04
Validation rmse = 0.196724
Epoch 459
Loss = 1.7334e-02, PNorm = 43.0972, GNorm = 0.2836, lr_0 = 1.0737e-04
Loss = 1.9498e-02, PNorm = 43.0981, GNorm = 0.1186, lr_0 = 1.0710e-04
Validation rmse = 0.197442
Epoch 460
Loss = 1.2099e-02, PNorm = 43.0989, GNorm = 0.1633, lr_0 = 1.0682e-04
Loss = 1.3874e-02, PNorm = 43.1000, GNorm = 0.4128, lr_0 = 1.0655e-04
Validation rmse = 0.196698
Epoch 461
Loss = 1.2646e-02, PNorm = 43.1005, GNorm = 0.3034, lr_0 = 1.0625e-04
Loss = 1.5741e-02, PNorm = 43.1005, GNorm = 0.3130, lr_0 = 1.0598e-04
Validation rmse = 0.197158
Epoch 462
Loss = 1.7547e-02, PNorm = 43.1009, GNorm = 0.1564, lr_0 = 1.0571e-04
Loss = 1.2026e-02, PNorm = 43.1016, GNorm = 0.2298, lr_0 = 1.0543e-04
Validation rmse = 0.196032
Epoch 463
Loss = 1.6370e-02, PNorm = 43.1015, GNorm = 0.3715, lr_0 = 1.0516e-04
Loss = 1.7574e-02, PNorm = 43.1025, GNorm = 0.5140, lr_0 = 1.0489e-04
Validation rmse = 0.197244
Epoch 464
Loss = 1.2296e-02, PNorm = 43.1032, GNorm = 0.3098, lr_0 = 1.0460e-04
Loss = 2.0630e-02, PNorm = 43.1035, GNorm = 0.3363, lr_0 = 1.0433e-04
Validation rmse = 0.196251
Epoch 465
Loss = 1.5862e-02, PNorm = 43.1045, GNorm = 0.2762, lr_0 = 1.0406e-04
Validation rmse = 0.197400
Epoch 466
Loss = 5.7341e-03, PNorm = 43.1053, GNorm = 0.2936, lr_0 = 1.0377e-04
Loss = 1.6991e-02, PNorm = 43.1057, GNorm = 0.4291, lr_0 = 1.0350e-04
Validation rmse = 0.196105
Epoch 467
Loss = 5.0963e-02, PNorm = 43.1063, GNorm = 0.4450, lr_0 = 1.0324e-04
Loss = 1.0922e-02, PNorm = 43.1076, GNorm = 0.6509, lr_0 = 1.0297e-04
Validation rmse = 0.196874
Epoch 468
Loss = 1.2298e-02, PNorm = 43.1086, GNorm = 0.3892, lr_0 = 1.0268e-04
Loss = 1.8247e-02, PNorm = 43.1087, GNorm = 0.2945, lr_0 = 1.0242e-04
Validation rmse = 0.196483
Epoch 469
Loss = 1.8815e-02, PNorm = 43.1091, GNorm = 0.2036, lr_0 = 1.0215e-04
Loss = 1.6302e-02, PNorm = 43.1091, GNorm = 0.2084, lr_0 = 1.0189e-04
Validation rmse = 0.197128
Epoch 470
Loss = 1.3912e-02, PNorm = 43.1098, GNorm = 0.2324, lr_0 = 1.0161e-04
Loss = 1.9393e-02, PNorm = 43.1106, GNorm = 0.2318, lr_0 = 1.0134e-04
Validation rmse = 0.196973
Epoch 471
Loss = 1.5756e-02, PNorm = 43.1111, GNorm = 0.2906, lr_0 = 1.0108e-04
Loss = 1.7741e-02, PNorm = 43.1120, GNorm = 0.2571, lr_0 = 1.0083e-04
Loss = 1.0291e-02, PNorm = 43.1120, GNorm = 0.3112, lr_0 = 1.0080e-04
Validation rmse = 0.196678
Epoch 472
Loss = 1.0850e-02, PNorm = 43.1125, GNorm = 0.2087, lr_0 = 1.0054e-04
Validation rmse = 0.196566
Epoch 473
Loss = 1.9802e-02, PNorm = 43.1135, GNorm = 0.2395, lr_0 = 1.0028e-04
Loss = 1.8769e-02, PNorm = 43.1146, GNorm = 0.2875, lr_0 = 1.0003e-04
Validation rmse = 0.196805
Epoch 474
Loss = 7.7269e-03, PNorm = 43.1148, GNorm = 0.2938, lr_0 = 1.0000e-04
Loss = 1.7025e-02, PNorm = 43.1157, GNorm = 0.1297, lr_0 = 1.0000e-04
Validation rmse = 0.195995
Epoch 475
Loss = 1.4392e-02, PNorm = 43.1165, GNorm = 0.4565, lr_0 = 1.0000e-04
Loss = 1.3826e-02, PNorm = 43.1175, GNorm = 0.4831, lr_0 = 1.0000e-04
Validation rmse = 0.196958
Epoch 476
Loss = 1.2173e-02, PNorm = 43.1187, GNorm = 0.1393, lr_0 = 1.0000e-04
Loss = 1.5361e-02, PNorm = 43.1194, GNorm = 0.2307, lr_0 = 1.0000e-04
Validation rmse = 0.197953
Epoch 477
Loss = 2.0628e-02, PNorm = 43.1203, GNorm = 0.3531, lr_0 = 1.0000e-04
Loss = 1.3968e-02, PNorm = 43.1207, GNorm = 0.4300, lr_0 = 1.0000e-04
Validation rmse = 0.197107
Epoch 478
Loss = 1.6838e-02, PNorm = 43.1205, GNorm = 0.3125, lr_0 = 1.0000e-04
Loss = 1.7670e-02, PNorm = 43.1212, GNorm = 0.2115, lr_0 = 1.0000e-04
Loss = 1.1734e-02, PNorm = 43.1213, GNorm = 0.3770, lr_0 = 1.0000e-04
Validation rmse = 0.197006
Epoch 479
Loss = 1.5469e-02, PNorm = 43.1219, GNorm = 0.1921, lr_0 = 1.0000e-04
Validation rmse = 0.196998
Epoch 480
Loss = 1.0795e-02, PNorm = 43.1227, GNorm = 0.2841, lr_0 = 1.0000e-04
Loss = 1.9409e-02, PNorm = 43.1227, GNorm = 0.3048, lr_0 = 1.0000e-04
Validation rmse = 0.198920
Epoch 481
Loss = 2.1381e-02, PNorm = 43.1239, GNorm = 0.1409, lr_0 = 1.0000e-04
Loss = 1.7316e-02, PNorm = 43.1249, GNorm = 0.5631, lr_0 = 1.0000e-04
Validation rmse = 0.197058
Epoch 482
Loss = 5.5630e-03, PNorm = 43.1254, GNorm = 0.2236, lr_0 = 1.0000e-04
Loss = 1.5407e-02, PNorm = 43.1266, GNorm = 0.2496, lr_0 = 1.0000e-04
Validation rmse = 0.197201
Epoch 483
Loss = 1.2223e-02, PNorm = 43.1267, GNorm = 0.2937, lr_0 = 1.0000e-04
Loss = 1.9450e-02, PNorm = 43.1269, GNorm = 0.2186, lr_0 = 1.0000e-04
Validation rmse = 0.196705
Epoch 484
Loss = 1.2387e-02, PNorm = 43.1274, GNorm = 0.1867, lr_0 = 1.0000e-04
Loss = 1.7643e-02, PNorm = 43.1278, GNorm = 0.2184, lr_0 = 1.0000e-04
Validation rmse = 0.196343
Epoch 485
Loss = 1.5580e-02, PNorm = 43.1286, GNorm = 0.3707, lr_0 = 1.0000e-04
Loss = 1.7238e-02, PNorm = 43.1293, GNorm = 0.3062, lr_0 = 1.0000e-04
Validation rmse = 0.196719
Epoch 486
Loss = 1.9742e-02, PNorm = 43.1302, GNorm = 1.0122, lr_0 = 1.0000e-04
Validation rmse = 0.196252
Epoch 487
Loss = 1.8643e-02, PNorm = 43.1304, GNorm = 0.1927, lr_0 = 1.0000e-04
Loss = 1.8195e-02, PNorm = 43.1306, GNorm = 0.4636, lr_0 = 1.0000e-04
Validation rmse = 0.196131
Epoch 488
Loss = 1.6015e-02, PNorm = 43.1312, GNorm = 0.5037, lr_0 = 1.0000e-04
Loss = 1.9013e-02, PNorm = 43.1322, GNorm = 0.3839, lr_0 = 1.0000e-04
Validation rmse = 0.197277
Epoch 489
Loss = 3.2116e-02, PNorm = 43.1334, GNorm = 0.2485, lr_0 = 1.0000e-04
Loss = 1.1662e-02, PNorm = 43.1351, GNorm = 0.1754, lr_0 = 1.0000e-04
Validation rmse = 0.197822
Epoch 490
Loss = 1.9259e-02, PNorm = 43.1352, GNorm = 0.2831, lr_0 = 1.0000e-04
Loss = 1.8117e-02, PNorm = 43.1353, GNorm = 0.5110, lr_0 = 1.0000e-04
Validation rmse = 0.196221
Epoch 491
Loss = 1.7101e-02, PNorm = 43.1355, GNorm = 0.6200, lr_0 = 1.0000e-04
Loss = 1.8655e-02, PNorm = 43.1369, GNorm = 0.3770, lr_0 = 1.0000e-04
Validation rmse = 0.198398
Epoch 492
Loss = 1.0733e-02, PNorm = 43.1376, GNorm = 0.2781, lr_0 = 1.0000e-04
Loss = 2.2047e-02, PNorm = 43.1377, GNorm = 0.2318, lr_0 = 1.0000e-04
Validation rmse = 0.195665
Epoch 493
Loss = 1.7079e-02, PNorm = 43.1391, GNorm = 0.4107, lr_0 = 1.0000e-04
Validation rmse = 0.196619
Epoch 494
Loss = 2.8547e-02, PNorm = 43.1394, GNorm = 0.4514, lr_0 = 1.0000e-04
Loss = 1.4270e-02, PNorm = 43.1410, GNorm = 0.4588, lr_0 = 1.0000e-04
Validation rmse = 0.197307
Epoch 495
Loss = 9.4477e-03, PNorm = 43.1414, GNorm = 0.2022, lr_0 = 1.0000e-04
Loss = 1.7517e-02, PNorm = 43.1422, GNorm = 0.6242, lr_0 = 1.0000e-04
Validation rmse = 0.196646
Epoch 496
Loss = 2.0204e-02, PNorm = 43.1424, GNorm = 0.3271, lr_0 = 1.0000e-04
Loss = 1.4073e-02, PNorm = 43.1433, GNorm = 0.4382, lr_0 = 1.0000e-04
Validation rmse = 0.196383
Epoch 497
Loss = 1.5937e-02, PNorm = 43.1436, GNorm = 0.2388, lr_0 = 1.0000e-04
Loss = 1.6096e-02, PNorm = 43.1437, GNorm = 0.2431, lr_0 = 1.0000e-04
Validation rmse = 0.195642
Epoch 498
Loss = 1.9407e-02, PNorm = 43.1446, GNorm = 0.2568, lr_0 = 1.0000e-04
Loss = 1.5269e-02, PNorm = 43.1450, GNorm = 0.1842, lr_0 = 1.0000e-04
Validation rmse = 0.196657
Epoch 499
Loss = 2.0310e-02, PNorm = 43.1456, GNorm = 0.2736, lr_0 = 1.0000e-04
Loss = 1.3815e-02, PNorm = 43.1464, GNorm = 0.3937, lr_0 = 1.0000e-04
Validation rmse = 0.196912
Model 0 best validation rmse = 0.166428 on epoch 63
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.237994
Ensemble test rmse = 0.237994
1-fold cross validation
	Seed 0 ==> test rmse = 0.237994
Overall test rmse = 0.237994 +/- 0.000000
Elapsed time = 0:06:04
Command line
python /home/ignaczg/anaconda3/envs/rdkit/lib/python3.8/site-packages/ipykernel_launcher.py -f /home/ignaczg/.local/share/jupyter/runtime/kernel-e15368ac-37df-4f1f-a983-65b8ddf9d126.json
Args
{'activation': 'ReLU',
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'alternative_loss_function': None,
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'batch_size': 50,
 'bias': False,
 'bond_feature_scaling': True,
 'bond_features_path': None,
 'bond_features_size': 0,
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': './data/FINAL_LIST.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'device': device(type='cuda'),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 300,
 'explicit_h': False,
 'extra_metrics': [],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': None,
 'grad_clip': None,
 'hidden_size': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'log_frequency': 10,
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_atom_descriptor_scaling': False,
 'no_bond_features_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'num_folds': 1,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 1,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': True,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'resume_experiment': False,
 'save_dir': './data/train_results/removal/',
 'save_preds': False,
 'save_smiles_splits': False,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_features_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_features_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'show_individual_scores': False,
 'smiles_columns': ['full_smiles'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.795, 0.2, 0.005],
 'split_type': 'random',
 'target_columns': ['dm300'],
 'target_weights': None,
 'task_names': ['dm300'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 0
Total size = 1,087 | train size = 864 | val size = 217 | test size = 6
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0): MPNEncoder(
        (dropout_layer): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (ffn): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=300, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 355,201
Moving model to cuda
Epoch 0
Loss = 9.0759e-01, PNorm = 34.0168, GNorm = 0.9869, lr_0 = 3.9118e-04
Validation rmse = 0.299026
Epoch 1
Loss = 6.6904e-01, PNorm = 34.0430, GNorm = 7.2963, lr_0 = 6.8235e-04
Loss = 6.5061e-01, PNorm = 34.0881, GNorm = 6.0143, lr_0 = 9.4706e-04
Validation rmse = 0.258442
Epoch 2
Loss = 4.4960e-01, PNorm = 34.1663, GNorm = 6.9266, lr_0 = 9.9592e-04
Loss = 4.6884e-01, PNorm = 34.2382, GNorm = 4.4733, lr_0 = 9.9140e-04
Validation rmse = 0.224157
Epoch 3
Loss = 3.4431e-01, PNorm = 34.3177, GNorm = 3.0460, lr_0 = 9.8646e-04
Validation rmse = 0.189450
Epoch 4
Loss = 2.8536e-01, PNorm = 34.3825, GNorm = 2.2161, lr_0 = 9.8198e-04
Loss = 3.2945e-01, PNorm = 34.4426, GNorm = 8.5598, lr_0 = 9.7753e-04
Validation rmse = 0.174065
Epoch 5
Loss = 2.0167e-01, PNorm = 34.5117, GNorm = 3.6972, lr_0 = 9.7266e-04
Loss = 2.3073e-01, PNorm = 34.5632, GNorm = 3.9168, lr_0 = 9.6824e-04
Validation rmse = 0.203161
Epoch 6
Loss = 2.5643e-01, PNorm = 34.6214, GNorm = 0.9001, lr_0 = 9.6342e-04
Loss = 1.9719e-01, PNorm = 34.6609, GNorm = 5.9036, lr_0 = 9.5905e-04
Loss = 5.4109e-02, PNorm = 34.6649, GNorm = 2.4805, lr_0 = 9.5861e-04
Validation rmse = 0.153477
Epoch 7
Loss = 1.7236e-01, PNorm = 34.7095, GNorm = 0.9393, lr_0 = 9.5426e-04
Validation rmse = 0.187490
Epoch 8
Loss = 2.2281e-01, PNorm = 34.7430, GNorm = 3.7294, lr_0 = 9.4994e-04
Loss = 1.7099e-01, PNorm = 34.7803, GNorm = 0.8424, lr_0 = 9.4563e-04
Validation rmse = 0.147484
Epoch 9
Loss = 1.5239e-01, PNorm = 34.8229, GNorm = 1.5894, lr_0 = 9.4091e-04
Loss = 1.3600e-01, PNorm = 34.8542, GNorm = 2.6531, lr_0 = 9.3665e-04
Validation rmse = 0.130016
Epoch 10
Loss = 1.2754e-01, PNorm = 34.8821, GNorm = 2.7871, lr_0 = 9.3197e-04
Loss = 1.4380e-01, PNorm = 34.9132, GNorm = 3.2663, lr_0 = 9.2775e-04
Validation rmse = 0.147155
Epoch 11
Loss = 1.1792e-01, PNorm = 34.9346, GNorm = 2.3760, lr_0 = 9.2354e-04
Validation rmse = 0.148950
Epoch 12
Loss = 1.3339e-01, PNorm = 34.9632, GNorm = 0.9376, lr_0 = 9.1893e-04
Loss = 1.3119e-01, PNorm = 34.9882, GNorm = 3.4184, lr_0 = 9.1477e-04
Validation rmse = 0.132215
Epoch 13
Loss = 1.2213e-01, PNorm = 35.0156, GNorm = 2.9571, lr_0 = 9.1021e-04
Loss = 1.4081e-01, PNorm = 35.0461, GNorm = 0.9316, lr_0 = 9.0608e-04
Validation rmse = 0.126169
Epoch 14
Loss = 1.1231e-01, PNorm = 35.0709, GNorm = 1.2700, lr_0 = 9.0156e-04
Validation rmse = 0.143350
Epoch 15
Loss = 1.0244e-01, PNorm = 35.0885, GNorm = 5.1340, lr_0 = 8.9747e-04
Loss = 1.2293e-01, PNorm = 35.1088, GNorm = 4.1143, lr_0 = 8.9340e-04
Validation rmse = 0.136179
Epoch 16
Loss = 9.4072e-02, PNorm = 35.1406, GNorm = 1.9651, lr_0 = 8.8894e-04
Loss = 1.3982e-01, PNorm = 35.1661, GNorm = 2.7215, lr_0 = 8.8491e-04
Validation rmse = 0.133347
Epoch 17
Loss = 1.0107e-01, PNorm = 35.1990, GNorm = 2.1966, lr_0 = 8.8050e-04
Loss = 1.1381e-01, PNorm = 35.2203, GNorm = 2.6710, lr_0 = 8.7651e-04
Validation rmse = 0.136462
Epoch 18
Loss = 1.0482e-01, PNorm = 35.2414, GNorm = 2.9644, lr_0 = 8.7253e-04
Validation rmse = 0.134490
Epoch 19
Loss = 1.1053e-01, PNorm = 35.2646, GNorm = 4.7215, lr_0 = 8.6818e-04
Loss = 1.1288e-01, PNorm = 35.2854, GNorm = 1.1399, lr_0 = 8.6424e-04
Validation rmse = 0.130903
Epoch 20
Loss = 1.1752e-01, PNorm = 35.3136, GNorm = 3.3320, lr_0 = 8.5993e-04
Loss = 1.1980e-01, PNorm = 35.3414, GNorm = 1.2761, lr_0 = 8.5603e-04
Validation rmse = 0.139275
Epoch 21
Loss = 1.2591e-01, PNorm = 35.3690, GNorm = 3.2995, lr_0 = 8.5176e-04
Loss = 1.3335e-01, PNorm = 35.3946, GNorm = 2.8669, lr_0 = 8.4790e-04
Validation rmse = 0.130259
Epoch 22
Loss = 1.1083e-01, PNorm = 35.4203, GNorm = 1.2070, lr_0 = 8.4406e-04
Validation rmse = 0.128795
Epoch 23
Loss = 9.9206e-02, PNorm = 35.4444, GNorm = 0.6130, lr_0 = 8.3985e-04
Loss = 1.0550e-01, PNorm = 35.4664, GNorm = 2.9506, lr_0 = 8.3604e-04
Validation rmse = 0.127811
Epoch 24
Loss = 9.1026e-02, PNorm = 35.4948, GNorm = 0.9324, lr_0 = 8.3187e-04
Loss = 9.0364e-02, PNorm = 35.5147, GNorm = 0.4545, lr_0 = 8.2810e-04
Validation rmse = 0.129628
Epoch 25
Loss = 7.6764e-02, PNorm = 35.5344, GNorm = 1.2225, lr_0 = 8.2434e-04
Validation rmse = 0.124682
Epoch 26
Loss = 5.6106e-02, PNorm = 35.5659, GNorm = 1.1049, lr_0 = 8.2023e-04
Loss = 1.0419e-01, PNorm = 35.5845, GNorm = 1.4533, lr_0 = 8.1651e-04
Validation rmse = 0.143320
Epoch 27
Loss = 1.2720e-01, PNorm = 35.6154, GNorm = 1.2872, lr_0 = 8.1244e-04
Loss = 9.3025e-02, PNorm = 35.6403, GNorm = 3.1200, lr_0 = 8.0875e-04
Validation rmse = 0.129905
Epoch 28
Loss = 8.1875e-02, PNorm = 35.6596, GNorm = 1.5534, lr_0 = 8.0472e-04
Loss = 9.8739e-02, PNorm = 35.6827, GNorm = 0.8411, lr_0 = 8.0107e-04
Validation rmse = 0.127856
Epoch 29
Loss = 8.1072e-02, PNorm = 35.7126, GNorm = 3.0495, lr_0 = 7.9744e-04
Validation rmse = 0.129241
Epoch 30
Loss = 1.1680e-01, PNorm = 35.7302, GNorm = 2.6187, lr_0 = 7.9346e-04
Loss = 7.8376e-02, PNorm = 35.7497, GNorm = 0.5061, lr_0 = 7.8986e-04
Validation rmse = 0.124667
Epoch 31
Loss = 6.7059e-02, PNorm = 35.7791, GNorm = 0.6363, lr_0 = 7.8592e-04
Loss = 8.6800e-02, PNorm = 35.7991, GNorm = 2.3938, lr_0 = 7.8236e-04
Validation rmse = 0.128229
Epoch 32
Loss = 9.5078e-02, PNorm = 35.8235, GNorm = 3.4433, lr_0 = 7.7846e-04
Loss = 1.0309e-01, PNorm = 35.8454, GNorm = 5.5494, lr_0 = 7.7493e-04
Validation rmse = 0.127660
Epoch 33
Loss = 8.4135e-02, PNorm = 35.8688, GNorm = 0.7454, lr_0 = 7.7141e-04
Validation rmse = 0.124721
Epoch 34
Loss = 6.8251e-02, PNorm = 35.8955, GNorm = 2.9296, lr_0 = 7.6757e-04
Loss = 7.9743e-02, PNorm = 35.9160, GNorm = 1.0478, lr_0 = 7.6409e-04
Validation rmse = 0.125226
Epoch 35
Loss = 6.5247e-02, PNorm = 35.9426, GNorm = 0.4653, lr_0 = 7.6028e-04
Loss = 7.7441e-02, PNorm = 35.9636, GNorm = 1.0744, lr_0 = 7.5683e-04
Validation rmse = 0.125794
Epoch 36
Loss = 8.2815e-02, PNorm = 35.9771, GNorm = 0.6464, lr_0 = 7.5340e-04
Validation rmse = 0.134805
Epoch 37
Loss = 5.9880e-02, PNorm = 36.0047, GNorm = 1.1447, lr_0 = 7.4964e-04
Loss = 8.1048e-02, PNorm = 36.0296, GNorm = 2.2938, lr_0 = 7.4624e-04
Validation rmse = 0.129029
Epoch 38
Loss = 9.3244e-02, PNorm = 36.0538, GNorm = 5.0719, lr_0 = 7.4252e-04
Loss = 7.7859e-02, PNorm = 36.0798, GNorm = 1.6800, lr_0 = 7.3915e-04
Validation rmse = 0.132638
Epoch 39
Loss = 7.5982e-02, PNorm = 36.1035, GNorm = 0.9194, lr_0 = 7.3546e-04
Loss = 1.1087e-01, PNorm = 36.1394, GNorm = 3.1756, lr_0 = 7.3213e-04
Validation rmse = 0.126806
Epoch 40
Loss = 7.3584e-02, PNorm = 36.1644, GNorm = 0.7083, lr_0 = 7.2881e-04
Validation rmse = 0.126656
Epoch 41
Loss = 6.1503e-02, PNorm = 36.1927, GNorm = 1.2914, lr_0 = 7.2517e-04
Loss = 8.0068e-02, PNorm = 36.2102, GNorm = 0.9650, lr_0 = 7.2189e-04
Validation rmse = 0.135962
Epoch 42
Loss = 8.1661e-02, PNorm = 36.2339, GNorm = 1.8601, lr_0 = 7.1829e-04
Loss = 7.3316e-02, PNorm = 36.2571, GNorm = 0.4100, lr_0 = 7.1503e-04
Validation rmse = 0.126523
Epoch 43
Loss = 5.7654e-02, PNorm = 36.2743, GNorm = 0.5456, lr_0 = 7.1179e-04
Loss = 7.1175e-02, PNorm = 36.2953, GNorm = 0.7883, lr_0 = 7.0856e-04
Loss = 4.5688e-02, PNorm = 36.2975, GNorm = 0.8064, lr_0 = 7.0824e-04
Validation rmse = 0.126810
Epoch 44
Loss = 6.1111e-02, PNorm = 36.3115, GNorm = 1.8530, lr_0 = 7.0502e-04
Validation rmse = 0.124525
Epoch 45
Loss = 5.5184e-02, PNorm = 36.3371, GNorm = 2.1216, lr_0 = 7.0151e-04
Loss = 6.6873e-02, PNorm = 36.3559, GNorm = 0.9436, lr_0 = 6.9833e-04
Validation rmse = 0.120626
Epoch 46
Loss = 6.1966e-02, PNorm = 36.3776, GNorm = 1.1536, lr_0 = 6.9484e-04
Loss = 6.4553e-02, PNorm = 36.3965, GNorm = 0.4675, lr_0 = 6.9169e-04
Validation rmse = 0.122319
Epoch 47
Loss = 6.7611e-02, PNorm = 36.4233, GNorm = 0.9584, lr_0 = 6.8856e-04
Validation rmse = 0.121437
Epoch 48
Loss = 6.4006e-02, PNorm = 36.4482, GNorm = 1.2419, lr_0 = 6.8512e-04
Loss = 6.1946e-02, PNorm = 36.4714, GNorm = 0.7259, lr_0 = 6.8201e-04
Validation rmse = 0.122376
Epoch 49
Loss = 6.4108e-02, PNorm = 36.4937, GNorm = 0.4487, lr_0 = 6.7861e-04
Loss = 6.7430e-02, PNorm = 36.5170, GNorm = 1.3614, lr_0 = 6.7554e-04
Validation rmse = 0.128964
Epoch 50
Loss = 5.8255e-02, PNorm = 36.5414, GNorm = 1.6870, lr_0 = 6.7247e-04
Loss = 6.1344e-02, PNorm = 36.5623, GNorm = 1.0266, lr_0 = 6.6942e-04
Validation rmse = 0.121153
Epoch 51
Loss = 5.9607e-02, PNorm = 36.5853, GNorm = 2.5264, lr_0 = 6.6608e-04
Validation rmse = 0.128877
Epoch 52
Loss = 6.6981e-02, PNorm = 36.6085, GNorm = 2.6639, lr_0 = 6.6276e-04
Loss = 8.5750e-02, PNorm = 36.6347, GNorm = 0.7962, lr_0 = 6.5976e-04
Validation rmse = 0.127715
Epoch 53
Loss = 7.7435e-02, PNorm = 36.6652, GNorm = 1.2661, lr_0 = 6.5647e-04
Loss = 7.5518e-02, PNorm = 36.6893, GNorm = 1.7700, lr_0 = 6.5349e-04
Validation rmse = 0.125669
Epoch 54
Loss = 6.1347e-02, PNorm = 36.7140, GNorm = 1.2044, lr_0 = 6.5053e-04
Loss = 6.4771e-02, PNorm = 36.7383, GNorm = 0.7711, lr_0 = 6.4758e-04
Loss = 4.5664e-02, PNorm = 36.7403, GNorm = 1.2890, lr_0 = 6.4728e-04
Validation rmse = 0.122606
Epoch 55
Loss = 5.2106e-02, PNorm = 36.7599, GNorm = 0.7304, lr_0 = 6.4435e-04
Validation rmse = 0.123754
Epoch 56
Loss = 4.8887e-02, PNorm = 36.7816, GNorm = 0.7166, lr_0 = 6.4113e-04
Loss = 5.2593e-02, PNorm = 36.8031, GNorm = 0.5959, lr_0 = 6.3823e-04
Validation rmse = 0.120829
Epoch 57
Loss = 5.7725e-02, PNorm = 36.8256, GNorm = 0.6797, lr_0 = 6.3504e-04
Loss = 4.8432e-02, PNorm = 36.8443, GNorm = 0.5771, lr_0 = 6.3216e-04
Validation rmse = 0.124913
Epoch 58
Loss = 5.5457e-02, PNorm = 36.8622, GNorm = 1.3405, lr_0 = 6.2930e-04
Validation rmse = 0.118762
Epoch 59
Loss = 5.2469e-02, PNorm = 36.8822, GNorm = 0.7491, lr_0 = 6.2616e-04
Loss = 4.7396e-02, PNorm = 36.9051, GNorm = 0.8185, lr_0 = 6.2332e-04
Validation rmse = 0.123827
Epoch 60
Loss = 5.9573e-02, PNorm = 36.9242, GNorm = 1.6467, lr_0 = 6.2021e-04
Loss = 4.9421e-02, PNorm = 36.9444, GNorm = 1.0788, lr_0 = 6.1740e-04
Validation rmse = 0.117460
Epoch 61
Loss = 5.9453e-02, PNorm = 36.9630, GNorm = 1.0970, lr_0 = 6.1460e-04
Loss = 4.7826e-02, PNorm = 36.9834, GNorm = 1.8125, lr_0 = 6.1181e-04
Validation rmse = 0.119753
Epoch 62
Loss = 4.8490e-02, PNorm = 37.0061, GNorm = 0.9911, lr_0 = 6.0876e-04
Validation rmse = 0.119549
Epoch 63
Loss = 3.1226e-02, PNorm = 37.0289, GNorm = 0.5102, lr_0 = 6.0572e-04
Loss = 4.4211e-02, PNorm = 37.0440, GNorm = 0.6092, lr_0 = 6.0298e-04
Validation rmse = 0.120938
Epoch 64
Loss = 4.7644e-02, PNorm = 37.0616, GNorm = 0.6470, lr_0 = 5.9997e-04
Loss = 4.5243e-02, PNorm = 37.0819, GNorm = 0.3970, lr_0 = 5.9725e-04
Validation rmse = 0.117517
Epoch 65
Loss = 4.2553e-02, PNorm = 37.1013, GNorm = 1.1033, lr_0 = 5.9454e-04
Loss = 4.5415e-02, PNorm = 37.1171, GNorm = 0.9855, lr_0 = 5.9184e-04
Loss = 8.0983e-02, PNorm = 37.1188, GNorm = 1.0573, lr_0 = 5.9157e-04
Validation rmse = 0.122338
Epoch 66
Loss = 4.2288e-02, PNorm = 37.1392, GNorm = 0.6659, lr_0 = 5.8889e-04
Validation rmse = 0.127211
Epoch 67
Loss = 6.2607e-02, PNorm = 37.1582, GNorm = 1.6787, lr_0 = 5.8595e-04
Loss = 4.9122e-02, PNorm = 37.1758, GNorm = 1.5885, lr_0 = 5.8330e-04
Validation rmse = 0.122597
Epoch 68
Loss = 4.3529e-02, PNorm = 37.1926, GNorm = 0.4956, lr_0 = 5.8065e-04
Loss = 4.2948e-02, PNorm = 37.2108, GNorm = 0.9924, lr_0 = 5.7802e-04
Validation rmse = 0.126872
Epoch 69
Loss = 5.0831e-02, PNorm = 37.2302, GNorm = 1.1827, lr_0 = 5.7514e-04
Validation rmse = 0.126320
Epoch 70
Loss = 2.7684e-02, PNorm = 37.2552, GNorm = 1.5336, lr_0 = 5.7227e-04
Loss = 5.5877e-02, PNorm = 37.2723, GNorm = 1.7599, lr_0 = 5.6967e-04
Validation rmse = 0.121575
Epoch 71
Loss = 3.9337e-02, PNorm = 37.2943, GNorm = 1.1564, lr_0 = 5.6683e-04
Loss = 5.0999e-02, PNorm = 37.3137, GNorm = 2.1726, lr_0 = 5.6426e-04
Validation rmse = 0.120344
Epoch 72
Loss = 4.8161e-02, PNorm = 37.3273, GNorm = 0.9707, lr_0 = 5.6170e-04
Loss = 4.2922e-02, PNorm = 37.3440, GNorm = 0.5204, lr_0 = 5.5916e-04
Validation rmse = 0.127595
Epoch 73
Loss = 5.0640e-02, PNorm = 37.3645, GNorm = 1.1680, lr_0 = 5.5637e-04
Validation rmse = 0.118642
Epoch 74
Loss = 2.8353e-02, PNorm = 37.3836, GNorm = 0.4108, lr_0 = 5.5359e-04
Loss = 3.6194e-02, PNorm = 37.3992, GNorm = 0.5071, lr_0 = 5.5108e-04
Validation rmse = 0.121549
Epoch 75
Loss = 3.6304e-02, PNorm = 37.4130, GNorm = 1.0423, lr_0 = 5.4858e-04
Loss = 3.5009e-02, PNorm = 37.4254, GNorm = 0.6235, lr_0 = 5.4609e-04
Validation rmse = 0.117990
Epoch 76
Loss = 3.8469e-02, PNorm = 37.4449, GNorm = 0.7938, lr_0 = 5.4337e-04
Loss = 4.1976e-02, PNorm = 37.4588, GNorm = 0.3747, lr_0 = 5.4091e-04
Loss = 5.8342e-02, PNorm = 37.4597, GNorm = 1.0667, lr_0 = 5.4066e-04
Validation rmse = 0.124354
Epoch 77
Loss = 4.0751e-02, PNorm = 37.4724, GNorm = 0.5354, lr_0 = 5.3821e-04
Validation rmse = 0.119640
Epoch 78
Loss = 2.8236e-02, PNorm = 37.4881, GNorm = 0.3446, lr_0 = 5.3553e-04
Loss = 3.4259e-02, PNorm = 37.5009, GNorm = 0.6352, lr_0 = 5.3310e-04
Validation rmse = 0.117471
Epoch 79
Loss = 3.8223e-02, PNorm = 37.5133, GNorm = 0.4466, lr_0 = 5.3068e-04
Loss = 3.2275e-02, PNorm = 37.5278, GNorm = 0.7056, lr_0 = 5.2827e-04
Validation rmse = 0.121812
Epoch 80
Loss = 3.8478e-02, PNorm = 37.5408, GNorm = 0.8248, lr_0 = 5.2564e-04
Validation rmse = 0.124259
Epoch 81
Loss = 3.8410e-02, PNorm = 37.5564, GNorm = 1.0943, lr_0 = 5.2302e-04
Loss = 3.3751e-02, PNorm = 37.5702, GNorm = 0.7306, lr_0 = 5.2064e-04
Validation rmse = 0.117852
Epoch 82
Loss = 3.4004e-02, PNorm = 37.5876, GNorm = 0.7511, lr_0 = 5.1805e-04
Loss = 3.5995e-02, PNorm = 37.6032, GNorm = 1.5355, lr_0 = 5.1570e-04
Validation rmse = 0.118553
Epoch 83
Loss = 3.6970e-02, PNorm = 37.6161, GNorm = 0.5773, lr_0 = 5.1336e-04
Loss = 3.3724e-02, PNorm = 37.6319, GNorm = 0.7823, lr_0 = 5.1103e-04
Validation rmse = 0.121250
Epoch 84
Loss = 3.1335e-02, PNorm = 37.6438, GNorm = 0.5088, lr_0 = 5.0848e-04
Validation rmse = 0.118845
Epoch 85
Loss = 4.6258e-02, PNorm = 37.6623, GNorm = 1.7916, lr_0 = 5.0595e-04
Loss = 3.6122e-02, PNorm = 37.6794, GNorm = 0.3090, lr_0 = 5.0365e-04
Validation rmse = 0.117740
Epoch 86
Loss = 2.4331e-02, PNorm = 37.6933, GNorm = 0.4333, lr_0 = 5.0137e-04
Loss = 3.4157e-02, PNorm = 37.7063, GNorm = 0.9779, lr_0 = 4.9910e-04
Validation rmse = 0.120299
Epoch 87
Loss = 3.0737e-02, PNorm = 37.7173, GNorm = 0.6305, lr_0 = 4.9661e-04
Loss = 3.0156e-02, PNorm = 37.7288, GNorm = 0.3924, lr_0 = 4.9435e-04
Loss = 9.1827e-03, PNorm = 37.7301, GNorm = 0.8076, lr_0 = 4.9413e-04
Validation rmse = 0.117767
Epoch 88
Loss = 2.9632e-02, PNorm = 37.7416, GNorm = 0.6794, lr_0 = 4.9189e-04
Validation rmse = 0.120691
Epoch 89
Loss = 2.9024e-02, PNorm = 37.7556, GNorm = 0.7221, lr_0 = 4.8944e-04
Loss = 3.3552e-02, PNorm = 37.7696, GNorm = 1.2670, lr_0 = 4.8722e-04
Validation rmse = 0.121132
Epoch 90
Loss = 3.1434e-02, PNorm = 37.7835, GNorm = 0.6775, lr_0 = 4.8501e-04
Loss = 3.3356e-02, PNorm = 37.7958, GNorm = 0.6004, lr_0 = 4.8281e-04
Validation rmse = 0.121016
Epoch 91
Loss = 3.0957e-02, PNorm = 37.8101, GNorm = 0.3181, lr_0 = 4.8040e-04
Validation rmse = 0.119074
Epoch 92
Loss = 1.7512e-02, PNorm = 37.8264, GNorm = 0.4067, lr_0 = 4.7800e-04
Loss = 2.6398e-02, PNorm = 37.8377, GNorm = 0.6673, lr_0 = 4.7584e-04
Validation rmse = 0.119279
Epoch 93
Loss = 3.0749e-02, PNorm = 37.8508, GNorm = 0.8861, lr_0 = 4.7368e-04
Loss = 2.7000e-02, PNorm = 37.8628, GNorm = 0.6046, lr_0 = 4.7153e-04
Validation rmse = 0.122732
Epoch 94
Loss = 3.2362e-02, PNorm = 37.8764, GNorm = 0.8199, lr_0 = 4.6918e-04
Loss = 2.8394e-02, PNorm = 37.8884, GNorm = 1.0715, lr_0 = 4.6705e-04
Validation rmse = 0.120448
Epoch 95
Loss = 2.5164e-02, PNorm = 37.9009, GNorm = 1.0554, lr_0 = 4.6472e-04
Validation rmse = 0.122224
Epoch 96
Loss = 2.2807e-02, PNorm = 37.9150, GNorm = 0.8100, lr_0 = 4.6240e-04
Loss = 3.0892e-02, PNorm = 37.9243, GNorm = 1.1612, lr_0 = 4.6031e-04
Validation rmse = 0.119753
Epoch 97
Loss = 2.9395e-02, PNorm = 37.9364, GNorm = 0.3129, lr_0 = 4.5822e-04
Loss = 2.5679e-02, PNorm = 37.9473, GNorm = 0.2539, lr_0 = 4.5614e-04
Validation rmse = 0.120926
Epoch 98
Loss = 2.6189e-02, PNorm = 37.9587, GNorm = 0.4908, lr_0 = 4.5387e-04
Loss = 2.4845e-02, PNorm = 37.9720, GNorm = 0.5718, lr_0 = 4.5181e-04
Loss = 7.5061e-02, PNorm = 37.9734, GNorm = 1.6255, lr_0 = 4.5160e-04
Validation rmse = 0.119949
Epoch 99
Loss = 3.1392e-02, PNorm = 37.9869, GNorm = 0.5557, lr_0 = 4.4956e-04
Validation rmse = 0.119645
Epoch 100
Loss = 2.9262e-02, PNorm = 37.9978, GNorm = 0.5778, lr_0 = 4.4752e-04
Loss = 2.6009e-02, PNorm = 38.0101, GNorm = 0.4246, lr_0 = 4.4549e-04
Validation rmse = 0.120218
Epoch 101
Loss = 2.6160e-02, PNorm = 38.0236, GNorm = 0.5985, lr_0 = 4.4327e-04
Loss = 2.4476e-02, PNorm = 38.0354, GNorm = 0.7164, lr_0 = 4.4126e-04
Validation rmse = 0.120409
Epoch 102
Loss = 2.9792e-02, PNorm = 38.0461, GNorm = 0.4670, lr_0 = 4.3905e-04
Validation rmse = 0.120684
Epoch 103
Loss = 2.1440e-02, PNorm = 38.0576, GNorm = 0.3627, lr_0 = 4.3687e-04
Loss = 2.3817e-02, PNorm = 38.0691, GNorm = 0.6164, lr_0 = 4.3488e-04
Validation rmse = 0.121358
Epoch 104
Loss = 2.2137e-02, PNorm = 38.0800, GNorm = 0.6445, lr_0 = 4.3291e-04
Loss = 2.2614e-02, PNorm = 38.0880, GNorm = 0.8518, lr_0 = 4.3095e-04
Validation rmse = 0.126985
Epoch 105
Loss = 3.8683e-02, PNorm = 38.1000, GNorm = 1.3615, lr_0 = 4.2880e-04
Loss = 2.9126e-02, PNorm = 38.1115, GNorm = 0.9622, lr_0 = 4.2685e-04
Validation rmse = 0.119399
Epoch 106
Loss = 2.6049e-02, PNorm = 38.1268, GNorm = 0.3536, lr_0 = 4.2473e-04
Validation rmse = 0.124174
Epoch 107
Loss = 3.4440e-02, PNorm = 38.1440, GNorm = 1.3484, lr_0 = 4.2261e-04
Loss = 2.9736e-02, PNorm = 38.1574, GNorm = 0.5913, lr_0 = 4.2069e-04
Validation rmse = 0.119326
Epoch 108
Loss = 2.4511e-02, PNorm = 38.1679, GNorm = 0.3910, lr_0 = 4.1878e-04
Loss = 2.2582e-02, PNorm = 38.1807, GNorm = 0.5390, lr_0 = 4.1688e-04
Validation rmse = 0.120307
Epoch 109
Loss = 2.5313e-02, PNorm = 38.1889, GNorm = 0.9014, lr_0 = 4.1481e-04
Loss = 2.4265e-02, PNorm = 38.1985, GNorm = 0.9670, lr_0 = 4.1292e-04
Loss = 1.1451e-02, PNorm = 38.1998, GNorm = 0.7061, lr_0 = 4.1274e-04
Validation rmse = 0.120046
Epoch 110
Loss = 2.2451e-02, PNorm = 38.2085, GNorm = 0.3301, lr_0 = 4.1087e-04
Validation rmse = 0.119330
Epoch 111
Loss = 2.0252e-02, PNorm = 38.2194, GNorm = 0.5510, lr_0 = 4.0900e-04
Loss = 2.4016e-02, PNorm = 38.2282, GNorm = 0.6948, lr_0 = 4.0715e-04
Validation rmse = 0.119629
Epoch 112
Loss = 1.8797e-02, PNorm = 38.2392, GNorm = 0.7241, lr_0 = 4.0512e-04
Loss = 2.5304e-02, PNorm = 38.2492, GNorm = 0.5636, lr_0 = 4.0328e-04
Validation rmse = 0.119927
Epoch 113
Loss = 2.2196e-02, PNorm = 38.2562, GNorm = 0.8453, lr_0 = 4.0127e-04
Validation rmse = 0.118902
Epoch 114
Loss = 9.9008e-03, PNorm = 38.2655, GNorm = 0.3831, lr_0 = 3.9927e-04
Loss = 1.9290e-02, PNorm = 38.2761, GNorm = 0.3174, lr_0 = 3.9746e-04
Validation rmse = 0.119264
Epoch 115
Loss = 1.4537e-02, PNorm = 38.2853, GNorm = 0.3314, lr_0 = 3.9565e-04
Loss = 2.3364e-02, PNorm = 38.2944, GNorm = 0.8726, lr_0 = 3.9386e-04
Validation rmse = 0.121876
Epoch 116
Loss = 1.9968e-02, PNorm = 38.3029, GNorm = 0.7016, lr_0 = 3.9190e-04
Loss = 2.2034e-02, PNorm = 38.3111, GNorm = 0.7904, lr_0 = 3.9012e-04
Validation rmse = 0.123324
Epoch 117
Loss = 2.2292e-02, PNorm = 38.3221, GNorm = 0.2783, lr_0 = 3.8817e-04
Validation rmse = 0.123360
Epoch 118
Loss = 3.4644e-02, PNorm = 38.3309, GNorm = 1.0005, lr_0 = 3.8641e-04
Loss = 1.9420e-02, PNorm = 38.3425, GNorm = 0.5483, lr_0 = 3.8466e-04
Validation rmse = 0.120005
Epoch 119
Loss = 2.6889e-02, PNorm = 38.3538, GNorm = 0.7510, lr_0 = 3.8274e-04
Loss = 2.2806e-02, PNorm = 38.3650, GNorm = 0.4407, lr_0 = 3.8101e-04
Validation rmse = 0.118425
Epoch 120
Loss = 2.4487e-02, PNorm = 38.3758, GNorm = 1.3995, lr_0 = 3.7911e-04
Loss = 2.5133e-02, PNorm = 38.3827, GNorm = 0.4514, lr_0 = 3.7739e-04
Loss = 1.3780e-02, PNorm = 38.3837, GNorm = 0.5283, lr_0 = 3.7722e-04
Validation rmse = 0.120780
Epoch 121
Loss = 2.1974e-02, PNorm = 38.3958, GNorm = 0.3980, lr_0 = 3.7550e-04
Validation rmse = 0.119688
Epoch 122
Loss = 1.6840e-02, PNorm = 38.4047, GNorm = 0.2699, lr_0 = 3.7380e-04
Loss = 1.8394e-02, PNorm = 38.4103, GNorm = 0.7179, lr_0 = 3.7211e-04
Validation rmse = 0.121805
Epoch 123
Loss = 1.7473e-02, PNorm = 38.4189, GNorm = 0.4484, lr_0 = 3.7025e-04
Loss = 2.1820e-02, PNorm = 38.4280, GNorm = 0.4814, lr_0 = 3.6857e-04
Validation rmse = 0.120292
Epoch 124
Loss = 2.1002e-02, PNorm = 38.4396, GNorm = 0.6119, lr_0 = 3.6673e-04
Loss = 1.9224e-02, PNorm = 38.4493, GNorm = 0.7627, lr_0 = 3.6507e-04
Validation rmse = 0.119995
Epoch 125
Loss = 2.0564e-02, PNorm = 38.4547, GNorm = 1.0748, lr_0 = 3.6341e-04
Validation rmse = 0.119127
Epoch 126
Loss = 1.5894e-02, PNorm = 38.4633, GNorm = 0.8942, lr_0 = 3.6160e-04
Loss = 2.9501e-02, PNorm = 38.4740, GNorm = 1.6650, lr_0 = 3.5996e-04
Validation rmse = 0.123639
Epoch 127
Loss = 3.0003e-02, PNorm = 38.4859, GNorm = 2.0162, lr_0 = 3.5817e-04
Loss = 2.3658e-02, PNorm = 38.4950, GNorm = 0.8014, lr_0 = 3.5654e-04
Validation rmse = 0.118988
Epoch 128
Loss = 2.5677e-02, PNorm = 38.5068, GNorm = 0.5794, lr_0 = 3.5477e-04
Validation rmse = 0.120228
Epoch 129
Loss = 1.5901e-02, PNorm = 38.5150, GNorm = 0.4609, lr_0 = 3.5316e-04
Loss = 1.6979e-02, PNorm = 38.5236, GNorm = 0.3222, lr_0 = 3.5155e-04
Validation rmse = 0.119274
Epoch 130
Loss = 1.4974e-02, PNorm = 38.5317, GNorm = 0.3966, lr_0 = 3.4980e-04
Loss = 1.7442e-02, PNorm = 38.5390, GNorm = 0.4797, lr_0 = 3.4822e-04
Validation rmse = 0.120880
Epoch 131
Loss = 1.6266e-02, PNorm = 38.5462, GNorm = 0.4680, lr_0 = 3.4648e-04
Loss = 1.7653e-02, PNorm = 38.5526, GNorm = 0.8004, lr_0 = 3.4491e-04
Loss = 8.8826e-03, PNorm = 38.5529, GNorm = 0.4291, lr_0 = 3.4475e-04
Validation rmse = 0.120202
Epoch 132
Loss = 1.4999e-02, PNorm = 38.5581, GNorm = 0.4545, lr_0 = 3.4319e-04
Validation rmse = 0.121363
Epoch 133
Loss = 1.0425e-02, PNorm = 38.5638, GNorm = 0.4315, lr_0 = 3.4163e-04
Loss = 1.6038e-02, PNorm = 38.5709, GNorm = 0.6366, lr_0 = 3.4008e-04
Validation rmse = 0.119791
Epoch 134
Loss = 1.5985e-02, PNorm = 38.5791, GNorm = 0.3333, lr_0 = 3.3839e-04
Loss = 1.9249e-02, PNorm = 38.5868, GNorm = 0.3956, lr_0 = 3.3685e-04
Validation rmse = 0.119290
Epoch 135
Loss = 1.5425e-02, PNorm = 38.5956, GNorm = 0.5075, lr_0 = 3.3517e-04
Loss = 1.7768e-02, PNorm = 38.6016, GNorm = 1.3233, lr_0 = 3.3365e-04
Validation rmse = 0.122671
Epoch 136
Loss = 1.9194e-02, PNorm = 38.6085, GNorm = 0.6724, lr_0 = 3.3214e-04
Validation rmse = 0.120777
Epoch 137
Loss = 1.6769e-02, PNorm = 38.6183, GNorm = 0.2498, lr_0 = 3.3048e-04
Loss = 1.5865e-02, PNorm = 38.6258, GNorm = 0.3399, lr_0 = 3.2898e-04
Validation rmse = 0.121849
Epoch 138
Loss = 1.5001e-02, PNorm = 38.6343, GNorm = 0.2153, lr_0 = 3.2734e-04
Loss = 1.6647e-02, PNorm = 38.6386, GNorm = 0.4697, lr_0 = 3.2586e-04
Validation rmse = 0.120457
Epoch 139
Loss = 1.4624e-02, PNorm = 38.6481, GNorm = 0.4172, lr_0 = 3.2423e-04
Validation rmse = 0.121353
Epoch 140
Loss = 1.1987e-02, PNorm = 38.6542, GNorm = 0.3944, lr_0 = 3.2276e-04
Loss = 1.3831e-02, PNorm = 38.6594, GNorm = 1.0500, lr_0 = 3.2130e-04
Validation rmse = 0.121579
Epoch 141
Loss = 1.2841e-02, PNorm = 38.6672, GNorm = 0.3124, lr_0 = 3.1970e-04
Loss = 1.8516e-02, PNorm = 38.6738, GNorm = 0.5824, lr_0 = 3.1825e-04
Validation rmse = 0.121612
Epoch 142
Loss = 1.5265e-02, PNorm = 38.6826, GNorm = 0.2485, lr_0 = 3.1666e-04
Loss = 1.8231e-02, PNorm = 38.6899, GNorm = 0.3917, lr_0 = 3.1522e-04
Validation rmse = 0.121130
Epoch 143
Loss = 1.5886e-02, PNorm = 38.6954, GNorm = 0.3184, lr_0 = 3.1379e-04
Validation rmse = 0.122205
Epoch 144
Loss = 9.4073e-03, PNorm = 38.7025, GNorm = 0.3677, lr_0 = 3.1223e-04
Loss = 1.5507e-02, PNorm = 38.7099, GNorm = 1.4687, lr_0 = 3.1081e-04
Validation rmse = 0.119958
Epoch 145
Loss = 1.3461e-02, PNorm = 38.7176, GNorm = 0.3707, lr_0 = 3.0926e-04
Loss = 1.4685e-02, PNorm = 38.7237, GNorm = 0.3755, lr_0 = 3.0786e-04
Validation rmse = 0.123173
Epoch 146
Loss = 1.6076e-02, PNorm = 38.7311, GNorm = 0.5865, lr_0 = 3.0632e-04
Loss = 1.9067e-02, PNorm = 38.7368, GNorm = 1.0446, lr_0 = 3.0494e-04
Validation rmse = 0.122651
Epoch 147
Loss = 1.4667e-02, PNorm = 38.7440, GNorm = 0.6391, lr_0 = 3.0355e-04
Validation rmse = 0.121334
Epoch 148
Loss = 1.3499e-02, PNorm = 38.7525, GNorm = 0.5252, lr_0 = 3.0204e-04
Loss = 2.0736e-02, PNorm = 38.7599, GNorm = 1.4570, lr_0 = 3.0067e-04
Validation rmse = 0.123443
Epoch 149
Loss = 2.4354e-02, PNorm = 38.7677, GNorm = 0.8802, lr_0 = 2.9917e-04
Loss = 1.5162e-02, PNorm = 38.7759, GNorm = 0.7729, lr_0 = 2.9781e-04
Validation rmse = 0.123598
Epoch 150
Loss = 1.5967e-02, PNorm = 38.7828, GNorm = 0.2871, lr_0 = 2.9646e-04
Validation rmse = 0.122458
Epoch 151
Loss = 9.7145e-03, PNorm = 38.7901, GNorm = 0.3366, lr_0 = 2.9498e-04
Loss = 1.4019e-02, PNorm = 38.7941, GNorm = 0.4221, lr_0 = 2.9365e-04
Validation rmse = 0.121230
Epoch 152
Loss = 1.5191e-02, PNorm = 38.8002, GNorm = 0.6956, lr_0 = 2.9218e-04
Loss = 1.2864e-02, PNorm = 38.8071, GNorm = 0.3435, lr_0 = 2.9086e-04
Validation rmse = 0.121248
Epoch 153
Loss = 1.2665e-02, PNorm = 38.8131, GNorm = 0.3482, lr_0 = 2.8941e-04
Loss = 1.4050e-02, PNorm = 38.8176, GNorm = 0.6176, lr_0 = 2.8809e-04
Validation rmse = 0.121637
Epoch 154
Loss = 1.1853e-02, PNorm = 38.8232, GNorm = 0.2002, lr_0 = 2.8679e-04
Validation rmse = 0.122738
Epoch 155
Loss = 2.1862e-02, PNorm = 38.8295, GNorm = 0.5524, lr_0 = 2.8536e-04
Loss = 1.3458e-02, PNorm = 38.8348, GNorm = 0.3744, lr_0 = 2.8406e-04
Validation rmse = 0.121831
Epoch 156
Loss = 1.4112e-02, PNorm = 38.8401, GNorm = 0.8816, lr_0 = 2.8265e-04
Loss = 1.4317e-02, PNorm = 38.8457, GNorm = 0.4512, lr_0 = 2.8136e-04
Validation rmse = 0.121556
Epoch 157
Loss = 1.3999e-02, PNorm = 38.8526, GNorm = 0.3672, lr_0 = 2.7996e-04
Loss = 1.2806e-02, PNorm = 38.8582, GNorm = 0.5491, lr_0 = 2.7869e-04
Validation rmse = 0.120511
Epoch 158
Loss = 1.3431e-02, PNorm = 38.8643, GNorm = 0.2596, lr_0 = 2.7743e-04
Validation rmse = 0.122771
Epoch 159
Loss = 1.2136e-02, PNorm = 38.8699, GNorm = 0.7038, lr_0 = 2.7604e-04
Loss = 1.3769e-02, PNorm = 38.8739, GNorm = 0.3322, lr_0 = 2.7479e-04
Validation rmse = 0.121624
Epoch 160
Loss = 1.3448e-02, PNorm = 38.8812, GNorm = 0.7381, lr_0 = 2.7342e-04
Loss = 1.3308e-02, PNorm = 38.8859, GNorm = 0.3529, lr_0 = 2.7218e-04
Validation rmse = 0.122779
Epoch 161
Loss = 1.3496e-02, PNorm = 38.8925, GNorm = 0.2807, lr_0 = 2.7095e-04
Validation rmse = 0.121439
Epoch 162
Loss = 1.2999e-02, PNorm = 38.8991, GNorm = 0.3353, lr_0 = 2.6960e-04
Loss = 1.1962e-02, PNorm = 38.9051, GNorm = 0.4817, lr_0 = 2.6837e-04
Validation rmse = 0.120545
Epoch 163
Loss = 1.4392e-02, PNorm = 38.9124, GNorm = 0.4465, lr_0 = 2.6704e-04
Loss = 1.1617e-02, PNorm = 38.9176, GNorm = 0.5813, lr_0 = 2.6582e-04
Validation rmse = 0.122254
Epoch 164
Loss = 1.2977e-02, PNorm = 38.9222, GNorm = 0.2786, lr_0 = 2.6450e-04
Loss = 1.0867e-02, PNorm = 38.9278, GNorm = 0.1779, lr_0 = 2.6330e-04
Validation rmse = 0.122426
Epoch 165
Loss = 1.2520e-02, PNorm = 38.9320, GNorm = 0.3135, lr_0 = 2.6211e-04
Validation rmse = 0.123172
Epoch 166
Loss = 1.0205e-02, PNorm = 38.9377, GNorm = 0.5459, lr_0 = 2.6080e-04
Loss = 1.5828e-02, PNorm = 38.9437, GNorm = 0.4103, lr_0 = 2.5962e-04
Validation rmse = 0.123625
Epoch 167
Loss = 9.2076e-03, PNorm = 38.9492, GNorm = 0.2732, lr_0 = 2.5832e-04
Loss = 1.1666e-02, PNorm = 38.9549, GNorm = 0.3865, lr_0 = 2.5715e-04
Validation rmse = 0.124067
Epoch 168
Loss = 1.1576e-02, PNorm = 38.9608, GNorm = 0.4625, lr_0 = 2.5598e-04
Loss = 1.4387e-02, PNorm = 38.9663, GNorm = 0.5406, lr_0 = 2.5482e-04
Loss = 6.7120e-03, PNorm = 38.9668, GNorm = 0.3791, lr_0 = 2.5471e-04
Validation rmse = 0.121905
Epoch 169
Loss = 1.2020e-02, PNorm = 38.9727, GNorm = 0.3383, lr_0 = 2.5355e-04
Validation rmse = 0.121936
Epoch 170
Loss = 7.2173e-03, PNorm = 38.9783, GNorm = 0.6896, lr_0 = 2.5229e-04
Loss = 1.3563e-02, PNorm = 38.9845, GNorm = 0.4502, lr_0 = 2.5114e-04
Validation rmse = 0.123265
Epoch 171
Loss = 1.3352e-02, PNorm = 38.9891, GNorm = 0.5526, lr_0 = 2.4989e-04
Loss = 1.0653e-02, PNorm = 38.9931, GNorm = 0.5727, lr_0 = 2.4876e-04
Validation rmse = 0.123203
Epoch 172
Loss = 9.8347e-03, PNorm = 39.0000, GNorm = 0.7024, lr_0 = 2.4763e-04
Validation rmse = 0.124659
Epoch 173
Loss = 1.2803e-02, PNorm = 39.0060, GNorm = 0.9815, lr_0 = 2.4639e-04
Loss = 1.1752e-02, PNorm = 39.0108, GNorm = 0.4186, lr_0 = 2.4528e-04
Validation rmse = 0.122266
Epoch 174
Loss = 7.4604e-03, PNorm = 39.0165, GNorm = 0.2487, lr_0 = 2.4405e-04
Loss = 1.1378e-02, PNorm = 39.0212, GNorm = 0.1645, lr_0 = 2.4295e-04
Validation rmse = 0.121762
Epoch 175
Loss = 1.0985e-02, PNorm = 39.0258, GNorm = 0.5633, lr_0 = 2.4185e-04
Loss = 1.0694e-02, PNorm = 39.0301, GNorm = 0.2949, lr_0 = 2.4075e-04
Validation rmse = 0.122482
Epoch 176
Loss = 9.8704e-03, PNorm = 39.0353, GNorm = 0.2945, lr_0 = 2.3955e-04
Validation rmse = 0.122673
Epoch 177
Loss = 7.5499e-03, PNorm = 39.0397, GNorm = 0.2370, lr_0 = 2.3835e-04
Loss = 1.0890e-02, PNorm = 39.0441, GNorm = 0.7546, lr_0 = 2.3727e-04
Validation rmse = 0.122207
Epoch 178
Loss = 1.0161e-02, PNorm = 39.0488, GNorm = 0.3866, lr_0 = 2.3609e-04
Loss = 1.1396e-02, PNorm = 39.0528, GNorm = 0.8134, lr_0 = 2.3502e-04
Validation rmse = 0.123160
Epoch 179
Loss = 9.5198e-03, PNorm = 39.0579, GNorm = 0.5678, lr_0 = 2.3395e-04
Loss = 1.2391e-02, PNorm = 39.0625, GNorm = 0.5587, lr_0 = 2.3289e-04
Loss = 2.3172e-02, PNorm = 39.0629, GNorm = 2.0839, lr_0 = 2.3279e-04
Validation rmse = 0.123061
Epoch 180
Loss = 1.3260e-02, PNorm = 39.0679, GNorm = 0.5802, lr_0 = 2.3173e-04
Validation rmse = 0.123951
Epoch 181
Loss = 9.2982e-03, PNorm = 39.0746, GNorm = 0.3850, lr_0 = 2.3057e-04
Loss = 9.8715e-03, PNorm = 39.0800, GNorm = 0.3204, lr_0 = 2.2953e-04
Validation rmse = 0.121965
Epoch 182
Loss = 1.0791e-02, PNorm = 39.0849, GNorm = 0.4171, lr_0 = 2.2838e-04
Loss = 9.7405e-03, PNorm = 39.0893, GNorm = 0.6793, lr_0 = 2.2735e-04
Validation rmse = 0.123784
Epoch 183
Loss = 1.1354e-02, PNorm = 39.0931, GNorm = 0.3452, lr_0 = 2.2632e-04
Validation rmse = 0.123189
Epoch 184
Loss = 1.2919e-02, PNorm = 39.0985, GNorm = 0.3768, lr_0 = 2.2519e-04
Loss = 8.4600e-03, PNorm = 39.1013, GNorm = 0.1627, lr_0 = 2.2417e-04
Validation rmse = 0.123397
Epoch 185
Loss = 6.5213e-03, PNorm = 39.1065, GNorm = 0.1924, lr_0 = 2.2305e-04
Loss = 1.0860e-02, PNorm = 39.1106, GNorm = 0.4473, lr_0 = 2.2204e-04
Validation rmse = 0.123782
Epoch 186
Loss = 8.7408e-03, PNorm = 39.1153, GNorm = 0.4722, lr_0 = 2.2103e-04
Loss = 8.1470e-03, PNorm = 39.1194, GNorm = 0.2214, lr_0 = 2.2003e-04
Validation rmse = 0.123042
Epoch 187
Loss = 1.0080e-02, PNorm = 39.1261, GNorm = 0.6199, lr_0 = 2.1893e-04
Validation rmse = 0.122645
Epoch 188
Loss = 1.0728e-02, PNorm = 39.1318, GNorm = 0.3279, lr_0 = 2.1784e-04
Loss = 8.8184e-03, PNorm = 39.1351, GNorm = 0.2974, lr_0 = 2.1685e-04
Validation rmse = 0.124359
Epoch 189
Loss = 8.2954e-03, PNorm = 39.1393, GNorm = 0.3661, lr_0 = 2.1577e-04
Loss = 9.7999e-03, PNorm = 39.1423, GNorm = 0.3796, lr_0 = 2.1479e-04
Validation rmse = 0.123408
Epoch 190
Loss = 9.8160e-03, PNorm = 39.1467, GNorm = 0.6092, lr_0 = 2.1382e-04
Loss = 9.2929e-03, PNorm = 39.1502, GNorm = 0.2372, lr_0 = 2.1285e-04
Loss = 1.0915e-02, PNorm = 39.1507, GNorm = 0.9329, lr_0 = 2.1275e-04
Validation rmse = 0.124416
Epoch 191
Loss = 1.0374e-02, PNorm = 39.1552, GNorm = 0.2395, lr_0 = 2.1179e-04
Validation rmse = 0.122864
Epoch 192
Loss = 7.8313e-03, PNorm = 39.1600, GNorm = 0.2956, lr_0 = 2.1073e-04
Loss = 1.0918e-02, PNorm = 39.1643, GNorm = 0.5263, lr_0 = 2.0977e-04
Validation rmse = 0.125627
Epoch 193
Loss = 9.3859e-03, PNorm = 39.1694, GNorm = 0.7380, lr_0 = 2.0882e-04
Loss = 8.6388e-03, PNorm = 39.1744, GNorm = 0.4660, lr_0 = 2.0788e-04
Validation rmse = 0.125514
Epoch 194
Loss = 1.0579e-02, PNorm = 39.1782, GNorm = 0.1149, lr_0 = 2.0684e-04
Validation rmse = 0.124128
Epoch 195
Loss = 1.2928e-02, PNorm = 39.1823, GNorm = 0.2850, lr_0 = 2.0581e-04
Loss = 7.5865e-03, PNorm = 39.1853, GNorm = 0.4384, lr_0 = 2.0487e-04
Validation rmse = 0.125617
Epoch 196
Loss = 9.5365e-03, PNorm = 39.1893, GNorm = 0.2686, lr_0 = 2.0385e-04
Loss = 9.7733e-03, PNorm = 39.1946, GNorm = 0.2427, lr_0 = 2.0293e-04
Validation rmse = 0.124716
Epoch 197
Loss = 1.0812e-02, PNorm = 39.1985, GNorm = 0.4562, lr_0 = 2.0201e-04
Loss = 8.2759e-03, PNorm = 39.2025, GNorm = 0.2769, lr_0 = 2.0109e-04
Validation rmse = 0.125134
Epoch 198
Loss = 7.8279e-03, PNorm = 39.2069, GNorm = 0.2989, lr_0 = 2.0009e-04
Validation rmse = 0.124790
Epoch 199
Loss = 3.8404e-03, PNorm = 39.2111, GNorm = 0.2035, lr_0 = 1.9909e-04
Loss = 7.4506e-03, PNorm = 39.2143, GNorm = 0.3507, lr_0 = 1.9819e-04
Validation rmse = 0.123321
Epoch 200
Loss = 8.2639e-03, PNorm = 39.2177, GNorm = 0.2956, lr_0 = 1.9729e-04
Loss = 9.0285e-03, PNorm = 39.2220, GNorm = 0.3078, lr_0 = 1.9640e-04
Validation rmse = 0.123349
Epoch 201
Loss = 9.9108e-03, PNorm = 39.2252, GNorm = 0.4570, lr_0 = 1.9542e-04
Loss = 8.4954e-03, PNorm = 39.2281, GNorm = 0.3189, lr_0 = 1.9453e-04
Loss = 8.5743e-03, PNorm = 39.2287, GNorm = 1.0572, lr_0 = 1.9444e-04
Validation rmse = 0.123523
Epoch 202
Loss = 1.0134e-02, PNorm = 39.2339, GNorm = 0.4497, lr_0 = 1.9356e-04
Validation rmse = 0.123865
Epoch 203
Loss = 7.3267e-03, PNorm = 39.2374, GNorm = 0.2977, lr_0 = 1.9259e-04
Loss = 9.7841e-03, PNorm = 39.2404, GNorm = 0.9522, lr_0 = 1.9172e-04
Validation rmse = 0.123645
Epoch 204
Loss = 1.0313e-02, PNorm = 39.2437, GNorm = 0.2725, lr_0 = 1.9085e-04
Loss = 8.4233e-03, PNorm = 39.2473, GNorm = 0.3915, lr_0 = 1.8999e-04
Validation rmse = 0.123218
Epoch 205
Loss = 9.8912e-03, PNorm = 39.2513, GNorm = 0.2775, lr_0 = 1.8904e-04
Validation rmse = 0.124462
Epoch 206
Loss = 6.4258e-03, PNorm = 39.2544, GNorm = 0.3653, lr_0 = 1.8810e-04
Loss = 9.2802e-03, PNorm = 39.2572, GNorm = 0.5273, lr_0 = 1.8724e-04
Validation rmse = 0.124539
Epoch 207
Loss = 1.5250e-02, PNorm = 39.2621, GNorm = 0.9305, lr_0 = 1.8631e-04
Loss = 8.3539e-03, PNorm = 39.2673, GNorm = 0.5524, lr_0 = 1.8546e-04
Validation rmse = 0.125465
Epoch 208
Loss = 7.0055e-03, PNorm = 39.2707, GNorm = 0.3817, lr_0 = 1.8462e-04
Loss = 9.9884e-03, PNorm = 39.2732, GNorm = 0.4108, lr_0 = 1.8379e-04
Validation rmse = 0.124647
Epoch 209
Loss = 8.3801e-03, PNorm = 39.2767, GNorm = 0.1608, lr_0 = 1.8287e-04
Validation rmse = 0.124262
Epoch 210
Loss = 1.5685e-02, PNorm = 39.2797, GNorm = 0.3180, lr_0 = 1.8196e-04
Loss = 6.4673e-03, PNorm = 39.2833, GNorm = 0.1307, lr_0 = 1.8113e-04
Validation rmse = 0.123643
Epoch 211
Loss = 6.7268e-03, PNorm = 39.2857, GNorm = 0.5141, lr_0 = 1.8031e-04
Loss = 7.9929e-03, PNorm = 39.2883, GNorm = 0.3107, lr_0 = 1.7949e-04
Validation rmse = 0.125227
Epoch 212
Loss = 6.2673e-03, PNorm = 39.2911, GNorm = 0.2208, lr_0 = 1.7860e-04
Loss = 8.3480e-03, PNorm = 39.2937, GNorm = 0.1800, lr_0 = 1.7779e-04
Loss = 2.5310e-03, PNorm = 39.2940, GNorm = 0.2861, lr_0 = 1.7771e-04
Validation rmse = 0.124786
Epoch 213
Loss = 6.2352e-03, PNorm = 39.2973, GNorm = 0.2341, lr_0 = 1.7690e-04
Validation rmse = 0.124709
Epoch 214
Loss = 5.6809e-03, PNorm = 39.3007, GNorm = 0.4203, lr_0 = 1.7602e-04
Loss = 6.4373e-03, PNorm = 39.3042, GNorm = 0.1913, lr_0 = 1.7522e-04
Validation rmse = 0.125542
Epoch 215
Loss = 9.4801e-03, PNorm = 39.3080, GNorm = 0.3870, lr_0 = 1.7443e-04
Loss = 6.4682e-03, PNorm = 39.3114, GNorm = 0.3450, lr_0 = 1.7363e-04
Validation rmse = 0.123724
Epoch 216
Loss = 7.2004e-03, PNorm = 39.3148, GNorm = 0.3140, lr_0 = 1.7277e-04
Validation rmse = 0.124583
Epoch 217
Loss = 4.3065e-03, PNorm = 39.3180, GNorm = 0.4317, lr_0 = 1.7191e-04
Loss = 7.1919e-03, PNorm = 39.3206, GNorm = 0.6529, lr_0 = 1.7113e-04
Validation rmse = 0.124337
Epoch 218
Loss = 8.8981e-03, PNorm = 39.3241, GNorm = 0.3151, lr_0 = 1.7035e-04
Loss = 7.4096e-03, PNorm = 39.3269, GNorm = 0.8948, lr_0 = 1.6958e-04
Validation rmse = 0.123910
Epoch 219
Loss = 6.9968e-03, PNorm = 39.3302, GNorm = 0.2757, lr_0 = 1.6873e-04
Loss = 7.6206e-03, PNorm = 39.3331, GNorm = 0.2351, lr_0 = 1.6797e-04
Validation rmse = 0.124737
Epoch 220
Loss = 6.0821e-03, PNorm = 39.3360, GNorm = 0.2123, lr_0 = 1.6713e-04
Validation rmse = 0.125041
Epoch 221
Loss = 4.5476e-03, PNorm = 39.3387, GNorm = 0.2712, lr_0 = 1.6630e-04
Loss = 7.7906e-03, PNorm = 39.3421, GNorm = 0.5884, lr_0 = 1.6554e-04
Validation rmse = 0.125058
Epoch 222
Loss = 1.1369e-02, PNorm = 39.3455, GNorm = 0.5867, lr_0 = 1.6479e-04
Loss = 6.6451e-03, PNorm = 39.3486, GNorm = 0.3568, lr_0 = 1.6404e-04
Validation rmse = 0.124738
Epoch 223
Loss = 7.4748e-03, PNorm = 39.3520, GNorm = 0.3854, lr_0 = 1.6323e-04
Loss = 6.7477e-03, PNorm = 39.3548, GNorm = 0.3389, lr_0 = 1.6249e-04
Loss = 1.5590e-03, PNorm = 39.3551, GNorm = 0.2623, lr_0 = 1.6241e-04
Validation rmse = 0.124854
Epoch 224
Loss = 8.3924e-03, PNorm = 39.3583, GNorm = 0.3060, lr_0 = 1.6168e-04
Validation rmse = 0.125715
Epoch 225
Loss = 8.9447e-03, PNorm = 39.3605, GNorm = 0.4234, lr_0 = 1.6094e-04
Loss = 5.5838e-03, PNorm = 39.3629, GNorm = 0.5464, lr_0 = 1.6021e-04
Validation rmse = 0.124576
Epoch 226
Loss = 5.9236e-03, PNorm = 39.3660, GNorm = 0.1635, lr_0 = 1.5941e-04
Loss = 5.9865e-03, PNorm = 39.3684, GNorm = 0.1569, lr_0 = 1.5869e-04
Validation rmse = 0.124604
Epoch 227
Loss = 7.3838e-03, PNorm = 39.3712, GNorm = 0.3999, lr_0 = 1.5790e-04
Validation rmse = 0.125125
Epoch 228
Loss = 2.2483e-02, PNorm = 39.3741, GNorm = 0.4484, lr_0 = 1.5711e-04
Loss = 5.2032e-03, PNorm = 39.3767, GNorm = 0.1425, lr_0 = 1.5640e-04
Validation rmse = 0.125086
Epoch 229
Loss = 4.4987e-03, PNorm = 39.3786, GNorm = 0.6824, lr_0 = 1.5569e-04
Loss = 9.4477e-03, PNorm = 39.3807, GNorm = 0.6636, lr_0 = 1.5498e-04
Validation rmse = 0.126027
Epoch 230
Loss = 6.1347e-03, PNorm = 39.3844, GNorm = 0.3213, lr_0 = 1.5421e-04
Loss = 6.9400e-03, PNorm = 39.3874, GNorm = 0.4281, lr_0 = 1.5351e-04
Validation rmse = 0.125102
Epoch 231
Loss = 5.1413e-03, PNorm = 39.3900, GNorm = 0.3049, lr_0 = 1.5275e-04
Validation rmse = 0.125401
Epoch 232
Loss = 8.2547e-03, PNorm = 39.3926, GNorm = 0.2365, lr_0 = 1.5198e-04
Loss = 6.5204e-03, PNorm = 39.3952, GNorm = 0.2855, lr_0 = 1.5130e-04
Validation rmse = 0.125960
Epoch 233
Loss = 4.3210e-03, PNorm = 39.3982, GNorm = 0.4048, lr_0 = 1.5061e-04
Loss = 7.0978e-03, PNorm = 39.4004, GNorm = 0.3059, lr_0 = 1.4993e-04
Validation rmse = 0.124812
Epoch 234
Loss = 6.7852e-03, PNorm = 39.4028, GNorm = 0.2128, lr_0 = 1.4918e-04
Loss = 5.6945e-03, PNorm = 39.4053, GNorm = 0.4588, lr_0 = 1.4850e-04
Loss = 1.9154e-03, PNorm = 39.4056, GNorm = 0.2245, lr_0 = 1.4843e-04
Validation rmse = 0.125564
Epoch 235
Loss = 5.5421e-03, PNorm = 39.4077, GNorm = 0.2243, lr_0 = 1.4776e-04
Validation rmse = 0.125652
Epoch 236
Loss = 3.4574e-03, PNorm = 39.4106, GNorm = 0.2699, lr_0 = 1.4709e-04
Loss = 6.0426e-03, PNorm = 39.4136, GNorm = 0.4210, lr_0 = 1.4642e-04
Validation rmse = 0.125526
Epoch 237
Loss = 4.4888e-03, PNorm = 39.4162, GNorm = 0.2228, lr_0 = 1.4569e-04
Loss = 7.4707e-03, PNorm = 39.4188, GNorm = 0.6275, lr_0 = 1.4503e-04
Validation rmse = 0.124432
Epoch 238
Loss = 4.4262e-03, PNorm = 39.4218, GNorm = 0.1989, lr_0 = 1.4431e-04
Validation rmse = 0.125529
Epoch 239
Loss = 6.6712e-03, PNorm = 39.4243, GNorm = 0.4367, lr_0 = 1.4359e-04
Loss = 6.5501e-03, PNorm = 39.4269, GNorm = 0.3231, lr_0 = 1.4294e-04
Validation rmse = 0.125773
Epoch 240
Loss = 5.1915e-03, PNorm = 39.4292, GNorm = 0.2951, lr_0 = 1.4229e-04
Loss = 7.4478e-03, PNorm = 39.4320, GNorm = 0.5270, lr_0 = 1.4165e-04
Validation rmse = 0.125427
Epoch 241
Loss = 8.5890e-03, PNorm = 39.4354, GNorm = 0.4599, lr_0 = 1.4094e-04
Loss = 4.6969e-03, PNorm = 39.4379, GNorm = 0.3356, lr_0 = 1.4030e-04
Validation rmse = 0.125883
Epoch 242
Loss = 6.1113e-03, PNorm = 39.4404, GNorm = 0.2674, lr_0 = 1.3960e-04
Validation rmse = 0.125448
Epoch 243
Loss = 7.8503e-03, PNorm = 39.4420, GNorm = 0.2045, lr_0 = 1.3897e-04
Loss = 6.8085e-03, PNorm = 39.4446, GNorm = 0.2468, lr_0 = 1.3834e-04
Validation rmse = 0.125852
Epoch 244
Loss = 4.9900e-03, PNorm = 39.4473, GNorm = 0.2742, lr_0 = 1.3765e-04
Loss = 5.6884e-03, PNorm = 39.4492, GNorm = 0.2343, lr_0 = 1.3702e-04
Validation rmse = 0.125971
Epoch 245
Loss = 4.8723e-03, PNorm = 39.4519, GNorm = 0.2864, lr_0 = 1.3634e-04
Loss = 6.5658e-03, PNorm = 39.4537, GNorm = 0.2449, lr_0 = 1.3572e-04
Loss = 3.6483e-03, PNorm = 39.4540, GNorm = 0.3038, lr_0 = 1.3566e-04
Validation rmse = 0.125822
Epoch 246
Loss = 4.6006e-03, PNorm = 39.4561, GNorm = 0.2919, lr_0 = 1.3504e-04
Validation rmse = 0.126124
Epoch 247
Loss = 3.7369e-03, PNorm = 39.4579, GNorm = 0.1488, lr_0 = 1.3443e-04
Loss = 4.6660e-03, PNorm = 39.4599, GNorm = 0.1651, lr_0 = 1.3382e-04
Validation rmse = 0.125703
Epoch 248
Loss = 5.4785e-03, PNorm = 39.4620, GNorm = 0.1310, lr_0 = 1.3316e-04
Loss = 6.0377e-03, PNorm = 39.4640, GNorm = 0.5118, lr_0 = 1.3255e-04
Validation rmse = 0.126272
Epoch 249
Loss = 5.9770e-03, PNorm = 39.4670, GNorm = 0.2521, lr_0 = 1.3189e-04
Loss = 6.3210e-03, PNorm = 39.4695, GNorm = 0.7902, lr_0 = 1.3129e-04
Validation rmse = 0.126026
Epoch 250
Loss = 6.2921e-03, PNorm = 39.4721, GNorm = 0.4511, lr_0 = 1.3070e-04
Validation rmse = 0.127143
Epoch 251
Loss = 4.7633e-03, PNorm = 39.4746, GNorm = 0.5599, lr_0 = 1.3005e-04
Loss = 5.9575e-03, PNorm = 39.4769, GNorm = 0.4344, lr_0 = 1.2946e-04
Validation rmse = 0.126104
Epoch 252
Loss = 6.0309e-03, PNorm = 39.4792, GNorm = 0.4256, lr_0 = 1.2881e-04
Loss = 5.0333e-03, PNorm = 39.4820, GNorm = 0.3491, lr_0 = 1.2823e-04
Validation rmse = 0.125553
Epoch 253
Loss = 5.9019e-03, PNorm = 39.4846, GNorm = 0.1865, lr_0 = 1.2759e-04
Validation rmse = 0.126674
Epoch 254
Loss = 4.2211e-03, PNorm = 39.4861, GNorm = 0.4305, lr_0 = 1.2701e-04
Loss = 6.1406e-03, PNorm = 39.4880, GNorm = 0.2858, lr_0 = 1.2643e-04
Validation rmse = 0.126746
Epoch 255
Loss = 6.0740e-03, PNorm = 39.4903, GNorm = 0.4509, lr_0 = 1.2580e-04
Loss = 5.4472e-03, PNorm = 39.4926, GNorm = 0.1638, lr_0 = 1.2523e-04
Validation rmse = 0.126090
Epoch 256
Loss = 4.1322e-03, PNorm = 39.4949, GNorm = 0.2784, lr_0 = 1.2461e-04
Loss = 6.2188e-03, PNorm = 39.4966, GNorm = 0.2978, lr_0 = 1.2404e-04
Loss = 1.1647e-02, PNorm = 39.4969, GNorm = 0.4695, lr_0 = 1.2398e-04
Validation rmse = 0.126897
Epoch 257
Loss = 5.2564e-03, PNorm = 39.4995, GNorm = 0.2369, lr_0 = 1.2342e-04
Validation rmse = 0.127013
Epoch 258
Loss = 3.4120e-03, PNorm = 39.5017, GNorm = 0.1636, lr_0 = 1.2286e-04
Loss = 5.4094e-03, PNorm = 39.5032, GNorm = 0.2071, lr_0 = 1.2231e-04
Validation rmse = 0.126234
Epoch 259
Loss = 3.9002e-03, PNorm = 39.5056, GNorm = 0.1195, lr_0 = 1.2170e-04
Loss = 6.2648e-03, PNorm = 39.5082, GNorm = 0.2862, lr_0 = 1.2114e-04
Validation rmse = 0.126977
Epoch 260
Loss = 5.6244e-03, PNorm = 39.5108, GNorm = 0.3112, lr_0 = 1.2054e-04
Loss = 5.0729e-03, PNorm = 39.5131, GNorm = 0.3481, lr_0 = 1.1999e-04
Validation rmse = 0.126574
Epoch 261
Loss = 5.7227e-03, PNorm = 39.5148, GNorm = 0.2033, lr_0 = 1.1945e-04
Validation rmse = 0.126640
Epoch 262
Loss = 3.2745e-03, PNorm = 39.5163, GNorm = 0.1773, lr_0 = 1.1885e-04
Loss = 4.5964e-03, PNorm = 39.5177, GNorm = 0.2309, lr_0 = 1.1831e-04
Validation rmse = 0.126209
Epoch 263
Loss = 6.2388e-03, PNorm = 39.5204, GNorm = 0.1756, lr_0 = 1.1772e-04
Loss = 5.0292e-03, PNorm = 39.5220, GNorm = 0.3298, lr_0 = 1.1719e-04
Validation rmse = 0.125582
Epoch 264
Loss = 6.0312e-03, PNorm = 39.5245, GNorm = 0.2390, lr_0 = 1.1661e-04
Validation rmse = 0.125903
Epoch 265
Loss = 3.7538e-03, PNorm = 39.5264, GNorm = 0.1759, lr_0 = 1.1608e-04
Loss = 3.8430e-03, PNorm = 39.5279, GNorm = 0.1874, lr_0 = 1.1555e-04
Validation rmse = 0.127365
Epoch 266
Loss = 4.9331e-03, PNorm = 39.5303, GNorm = 0.1903, lr_0 = 1.1497e-04
Loss = 4.9657e-03, PNorm = 39.5327, GNorm = 0.1661, lr_0 = 1.1445e-04
Validation rmse = 0.126639
Epoch 267
Loss = 3.8016e-03, PNorm = 39.5350, GNorm = 0.1343, lr_0 = 1.1388e-04
Loss = 5.9267e-03, PNorm = 39.5366, GNorm = 0.5262, lr_0 = 1.1337e-04
Validation rmse = 0.126657
Epoch 268
Loss = 5.3226e-03, PNorm = 39.5385, GNorm = 0.6287, lr_0 = 1.1285e-04
Validation rmse = 0.126846
Epoch 269
Loss = 2.7794e-03, PNorm = 39.5411, GNorm = 0.2684, lr_0 = 1.1229e-04
Loss = 5.4321e-03, PNorm = 39.5427, GNorm = 0.2566, lr_0 = 1.1178e-04
Validation rmse = 0.127097
Epoch 270
Loss = 3.7460e-03, PNorm = 39.5451, GNorm = 0.3349, lr_0 = 1.1122e-04
Loss = 5.6253e-03, PNorm = 39.5466, GNorm = 0.4982, lr_0 = 1.1072e-04
Validation rmse = 0.127003
Epoch 271
Loss = 4.8587e-03, PNorm = 39.5483, GNorm = 0.2165, lr_0 = 1.1017e-04
Loss = 5.5585e-03, PNorm = 39.5509, GNorm = 0.6439, lr_0 = 1.0967e-04
Validation rmse = 0.126883
Epoch 272
Loss = 4.6673e-03, PNorm = 39.5528, GNorm = 0.5056, lr_0 = 1.0917e-04
Validation rmse = 0.126340
Epoch 273
Loss = 5.1886e-03, PNorm = 39.5545, GNorm = 0.1892, lr_0 = 1.0862e-04
Loss = 5.5106e-03, PNorm = 39.5560, GNorm = 0.6169, lr_0 = 1.0813e-04
Validation rmse = 0.126021
Epoch 274
Loss = 6.9708e-03, PNorm = 39.5582, GNorm = 0.2583, lr_0 = 1.0759e-04
Loss = 4.7638e-03, PNorm = 39.5601, GNorm = 0.5947, lr_0 = 1.0710e-04
Validation rmse = 0.127659
Epoch 275
Loss = 6.6837e-03, PNorm = 39.5609, GNorm = 0.4364, lr_0 = 1.0662e-04
Validation rmse = 0.127146
Epoch 276
Loss = 2.9443e-03, PNorm = 39.5634, GNorm = 0.5522, lr_0 = 1.0609e-04
Loss = 4.0717e-03, PNorm = 39.5656, GNorm = 0.2604, lr_0 = 1.0561e-04
Validation rmse = 0.127591
Epoch 277
Loss = 4.5710e-03, PNorm = 39.5670, GNorm = 0.2642, lr_0 = 1.0508e-04
Loss = 4.9590e-03, PNorm = 39.5689, GNorm = 0.2440, lr_0 = 1.0460e-04
Validation rmse = 0.127258
Epoch 278
Loss = 5.0692e-03, PNorm = 39.5714, GNorm = 0.3049, lr_0 = 1.0408e-04
Loss = 4.5299e-03, PNorm = 39.5732, GNorm = 0.2365, lr_0 = 1.0361e-04
Validation rmse = 0.127005
Epoch 279
Loss = 5.8280e-03, PNorm = 39.5746, GNorm = 0.2988, lr_0 = 1.0314e-04
Validation rmse = 0.126872
Epoch 280
Loss = 3.8394e-03, PNorm = 39.5765, GNorm = 0.2021, lr_0 = 1.0262e-04
Loss = 4.5952e-03, PNorm = 39.5779, GNorm = 0.3687, lr_0 = 1.0216e-04
Validation rmse = 0.126885
Epoch 281
Loss = 4.2993e-03, PNorm = 39.5800, GNorm = 0.2484, lr_0 = 1.0165e-04
Loss = 4.9445e-03, PNorm = 39.5819, GNorm = 0.3396, lr_0 = 1.0119e-04
Validation rmse = 0.127806
Epoch 282
Loss = 4.6061e-03, PNorm = 39.5840, GNorm = 0.4139, lr_0 = 1.0068e-04
Loss = 6.3783e-03, PNorm = 39.5858, GNorm = 0.4350, lr_0 = 1.0023e-04
Validation rmse = 0.127892
Epoch 283
Loss = 4.7442e-03, PNorm = 39.5872, GNorm = 0.1701, lr_0 = 1.0000e-04
Validation rmse = 0.127330
Epoch 284
Loss = 8.9177e-03, PNorm = 39.5892, GNorm = 0.3249, lr_0 = 1.0000e-04
Loss = 3.8055e-03, PNorm = 39.5906, GNorm = 0.1565, lr_0 = 1.0000e-04
Validation rmse = 0.126892
Epoch 285
Loss = 3.5898e-03, PNorm = 39.5919, GNorm = 0.1767, lr_0 = 1.0000e-04
Loss = 4.6623e-03, PNorm = 39.5932, GNorm = 0.1875, lr_0 = 1.0000e-04
Validation rmse = 0.126712
Epoch 286
Loss = 3.5023e-03, PNorm = 39.5953, GNorm = 0.2502, lr_0 = 1.0000e-04
Validation rmse = 0.128116
Epoch 287
Loss = 3.0590e-03, PNorm = 39.5968, GNorm = 0.1840, lr_0 = 1.0000e-04
Loss = 5.2488e-03, PNorm = 39.5984, GNorm = 0.2081, lr_0 = 1.0000e-04
Validation rmse = 0.127492
Epoch 288
Loss = 2.7521e-03, PNorm = 39.6000, GNorm = 0.1742, lr_0 = 1.0000e-04
Loss = 4.9693e-03, PNorm = 39.6012, GNorm = 0.2282, lr_0 = 1.0000e-04
Validation rmse = 0.127804
Epoch 289
Loss = 6.3748e-03, PNorm = 39.6035, GNorm = 0.5467, lr_0 = 1.0000e-04
Loss = 4.4743e-03, PNorm = 39.6052, GNorm = 0.3743, lr_0 = 1.0000e-04
Validation rmse = 0.127630
Epoch 290
Loss = 3.3665e-03, PNorm = 39.6066, GNorm = 0.2095, lr_0 = 1.0000e-04
Validation rmse = 0.127333
Epoch 291
Loss = 4.0171e-03, PNorm = 39.6089, GNorm = 0.1933, lr_0 = 1.0000e-04
Loss = 4.4881e-03, PNorm = 39.6109, GNorm = 0.3606, lr_0 = 1.0000e-04
Validation rmse = 0.127299
Epoch 292
Loss = 2.8355e-03, PNorm = 39.6124, GNorm = 0.1444, lr_0 = 1.0000e-04
Loss = 3.4561e-03, PNorm = 39.6131, GNorm = 0.3034, lr_0 = 1.0000e-04
Validation rmse = 0.127658
Epoch 293
Loss = 7.0233e-03, PNorm = 39.6151, GNorm = 0.4033, lr_0 = 1.0000e-04
Loss = 4.1890e-03, PNorm = 39.6170, GNorm = 0.2952, lr_0 = 1.0000e-04
Loss = 1.6509e-03, PNorm = 39.6171, GNorm = 0.3622, lr_0 = 1.0000e-04
Validation rmse = 0.126833
Epoch 294
Loss = 5.3131e-03, PNorm = 39.6190, GNorm = 0.4168, lr_0 = 1.0000e-04
Validation rmse = 0.128071
Epoch 295
Loss = 5.4276e-03, PNorm = 39.6206, GNorm = 0.2751, lr_0 = 1.0000e-04
Loss = 4.2423e-03, PNorm = 39.6220, GNorm = 0.4064, lr_0 = 1.0000e-04
Validation rmse = 0.128055
Epoch 296
Loss = 4.0091e-03, PNorm = 39.6236, GNorm = 0.1754, lr_0 = 1.0000e-04
Loss = 4.5602e-03, PNorm = 39.6252, GNorm = 0.2097, lr_0 = 1.0000e-04
Validation rmse = 0.127182
Epoch 297
Loss = 4.0948e-03, PNorm = 39.6271, GNorm = 0.5057, lr_0 = 1.0000e-04
Validation rmse = 0.128136
Epoch 298
Loss = 4.7007e-03, PNorm = 39.6286, GNorm = 0.4884, lr_0 = 1.0000e-04
Loss = 4.9515e-03, PNorm = 39.6306, GNorm = 0.5119, lr_0 = 1.0000e-04
Validation rmse = 0.127589
Epoch 299
Loss = 3.9980e-03, PNorm = 39.6326, GNorm = 0.1731, lr_0 = 1.0000e-04
Loss = 4.9057e-03, PNorm = 39.6343, GNorm = 0.1892, lr_0 = 1.0000e-04
Validation rmse = 0.128537
Model 0 best validation rmse = 0.117460 on epoch 60
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "ffn.1.weight".
Loading pretrained parameter "ffn.1.bias".
Loading pretrained parameter "ffn.4.weight".
Loading pretrained parameter "ffn.4.bias".
Moving model to cuda
Model 0 test rmse = 0.165899
Ensemble test rmse = 0.165899
1-fold cross validation
	Seed 0 ==> test rmse = 0.165899
Overall test rmse = 0.165899 +/- 0.000000
Elapsed time = 0:03:29
